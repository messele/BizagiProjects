for(var key in function(e,t){console.log(e);var i=e.React=function(){var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;var n=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;var n=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==n.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(e){o[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}()?Object.assign:function(n,o){for(var r,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(n),l=1;l<arguments.length;l++){for(var d in r=Object(arguments[l]))t.call(r,d)&&(s[d]=r[d]);if(e){a=e(r);for(var c=0;c<a.length;c++)i.call(r,a[c])&&(s[a[c]]=r[a[c]])}}return s},o="function"==typeof Symbol&&Symbol.for,r=o?Symbol.for("react.element"):60103,a=o?Symbol.for("react.portal"):60106,s=o?Symbol.for("react.fragment"):60107,l=o?Symbol.for("react.strict_mode"):60108,d=o?Symbol.for("react.profiler"):60114,c=o?Symbol.for("react.provider"):60109,u=o?Symbol.for("react.context"):60110,p=o?Symbol.for("react.async_mode"):60111,m=o?Symbol.for("react.forward_ref"):60112,h=o?Symbol.for("react.timeout"):60113,f="function"==typeof Symbol&&Symbol.iterator,g="@@iterator";function b(e){if(null==e)return null;var t=f&&e[f]||e[g];return"function"==typeof t?t:null}var v=function(e){};v=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")};var y=function(e,t,i,n,o,r,a,s){if(v(t),!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[i,n,o,r,a,s],c=0;(l=new Error(t.replace(/%s/g,function(){return d[c++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}},x={};Object.freeze(x);var z=x,C=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(!e){for(var i=arguments.length,n=Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];(function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var o=0,r="Warning: "+e.replace(/%s/g,function(){return i[o++]});"undefined"!=typeof console&&console.warn(r);try{throw new Error(r)}catch(e){}}).apply(void 0,[t].concat(n))}};function w(e){return function(){return e}}var E=function(){};E.thatReturns=w,E.thatReturnsFalse=w(!1),E.thatReturnsTrue=w(!0),E.thatReturnsNull=w(null),E.thatReturnsThis=function(){return this},E.thatReturnsArgument=function(e){return e};var P=E,_=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var i=arguments.length,n=Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];(function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var o=0,r="Warning: "+e.replace(/%s/g,function(){return i[o++]});"undefined"!=typeof console&&console.error(r);try{throw new Error(r)}catch(e){}}).apply(void 0,[t].concat(n))}},T={};function S(e,t){var i=e.constructor,n=i&&(i.displayName||i.name)||"ReactClass",o=n+"."+t;T[o]||(_(!1,"Can't call %s on a component that is not yet mounted. This is a no-op, but it might indicate a bug in your application. Instead, assign to `this.state` directly or define a `state = {};` class property with the desired state in the %s component.",t,n),T[o]=!0)}var R={isMounted:function(e){return!1},enqueueForceUpdate:function(e,t,i){S(e,"forceUpdate")},enqueueReplaceState:function(e,t,i,n){S(e,"replaceState")},enqueueSetState:function(e,t,i,n){S(e,"setState")}};function k(e,t,i){this.props=e,this.context=t,this.refs=z,this.updater=i||R}k.prototype.isReactComponent={},k.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&y(!1,"setState(...): takes an object of state variables to update or a function which returns an object of state variables."),this.updater.enqueueSetState(this,e,t,"setState")},k.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};var $={isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."]},I=function(e,t){Object.defineProperty(k.prototype,e,{get:function(){C(!1,"%s(...) is deprecated in plain JavaScript React classes. %s",t[0],t[1])}})};for(var M in $)$.hasOwnProperty(M)&&I(M,$[M]);function F(){}function D(e,t,i){this.props=e,this.context=t,this.refs=z,this.updater=i||R}F.prototype=k.prototype;var N=D.prototype=new F;N.constructor=D,n(N,k.prototype),N.isPureReactComponent=!0;var O={current:null},A=Object.prototype.hasOwnProperty,V={key:!0,ref:!0,__self:!0,__source:!0},B=void 0,L=void 0;function U(e){if(A.call(e,"ref")){var t=Object.getOwnPropertyDescriptor(e,"ref").get;if(t&&t.isReactWarning)return!1}return void 0!==e.ref}function G(e){if(A.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}var q=function(e,t,i,n,o,a,s){var l={$$typeof:r,type:e,key:t,ref:i,props:s,_owner:a,_store:{}};return Object.defineProperty(l._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(l,"_self",{configurable:!1,enumerable:!1,writable:!1,value:n}),Object.defineProperty(l,"_source",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.freeze&&(Object.freeze(l.props),Object.freeze(l)),l};function H(e,t,i){var n=void 0,o={},a=null,s=null,l=null,d=null;if(null!=t)for(n in U(t)&&(s=t.ref),G(t)&&(a=""+t.key),l=void 0===t.__self?null:t.__self,d=void 0===t.__source?null:t.__source,t)A.call(t,n)&&!V.hasOwnProperty(n)&&(o[n]=t[n]);var c,u,p,m,h,f,g=arguments.length-2;if(1===g)o.children=i;else if(g>1){for(var b=Array(g),v=0;v<g;v++)b[v]=arguments[v+2];Object.freeze&&Object.freeze(b),o.children=b}if(e&&e.defaultProps){var y=e.defaultProps;for(n in y)void 0===o[n]&&(o[n]=y[n])}if((a||s)&&(void 0===o.$$typeof||o.$$typeof!==r)){var x="function"==typeof e?e.displayName||e.name||"Unknown":e;a&&(m=o,h=x,(f=function(){B||(B=!0,_(!1,"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://fb.me/react-special-props)",h))}).isReactWarning=!0,Object.defineProperty(m,"key",{get:f,configurable:!0})),s&&(c=o,u=x,(p=function(){L||(L=!0,_(!1,"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://fb.me/react-special-props)",u))}).isReactWarning=!0,Object.defineProperty(c,"ref",{get:p,configurable:!0}))}return q(e,a,s,l,d,O.current,o)}function X(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var j={getCurrentStack:null};j.getStackAddendum=function(){var e=j.getCurrentStack;return e?e():null};var W=".",Y=":";var K=!1,J=/\/+/g;function Z(e){return(""+e).replace(J,"$&/")}var Q=10,ee=[];function te(e,t,i,n){if(ee.length){var o=ee.pop();return o.result=e,o.keyPrefix=t,o.func=i,o.context=n,o.count=0,o}return{result:e,keyPrefix:t,func:i,context:n,count:0}}function ie(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,ee.length<Q&&ee.push(e)}function ne(e,t,i){return null==e?0:function e(t,i,n,o){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case r:case a:l=!0}}if(l)return n(o,t,""===i?W+oe(t,0):i),1;var d=void 0;var c=void 0;var u=0;var p=""===i?W:i+Y;if(Array.isArray(t))for(var m=0;m<t.length;m++)d=t[m],c=p+oe(d,m),u+=e(d,c,n,o);else{var h=b(t);if("function"==typeof h){h===t.entries&&(K||_(!1,"Using Maps as children is unsupported and will likely yield unexpected results. Convert it to a sequence/iterable of keyed ReactElements instead.%s",j.getStackAddendum()),K=!0);for(var f=h.call(t),g=void 0,v=0;!(g=f.next()).done;)d=g.value,c=p+oe(d,v++),u+=e(d,c,n,o)}else if("object"===s){var x="";x=" If you meant to render a collection of children, use an array instead."+j.getStackAddendum();var z=""+t;y(!1,"Objects are not valid as a React child (found: %s).%s","[object Object]"===z?"object with keys {"+Object.keys(t).join(", ")+"}":z,x)}}return u}(e,"",t,i)}function oe(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(i=e.key,n={"=":"=0",":":"=2"},"$"+(""+i).replace(/[=:]/g,function(e){return n[e]})):t.toString(36);var i,n}function re(e,t,i){var n=e.func,o=e.context;n.call(o,t,e.count++)}function ae(e,t,i){var n,o,r=e.result,a=e.keyPrefix,s=e.func,l=e.context,d=s.call(l,t,e.count++);Array.isArray(d)?se(d,r,i,P.thatReturnsArgument):null!=d&&(X(d)&&(n=d,o=a+(!d.key||t&&t.key===d.key?"":Z(d.key)+"/")+i,d=q(n.type,o,n.ref,n._self,n._source,n._owner,n.props)),r.push(d))}function se(e,t,i,n,o){var r="";null!=i&&(r=Z(i)+"/");var a=te(t,r,n,o);ne(e,ae,a),ie(a)}function le(e){var t=e.type;if("function"==typeof t)return t.displayName||t.name;if("string"==typeof t)return t;switch(t){case p:return"AsyncMode";case u:return"Context.Consumer";case s:return"ReactFragment";case a:return"ReactPortal";case d:return"Profiler("+e.pendingProps.id+")";case c:return"Context.Provider";case l:return"StrictMode";case h:return"Timeout"}if("object"==typeof t&&null!==t)switch(t.$$typeof){case m:var i=t.render.displayName||t.render.name||"";return""!==i?"ForwardRef("+i+")":"ForwardRef"}return null}var de=y,ce=_,ue="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",pe={};var me=function(e,t,i,n,o){for(var r in e)if(e.hasOwnProperty(r)){var a;try{de("function"==typeof e[r],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",n||"React class",i,r,typeof e[r]),a=e[r](t,r,n,i,null,ue)}catch(e){a=e}if(ce(!a||a instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",n||"React class",i,r,typeof a),a instanceof Error&&!(a.message in pe)){pe[a.message]=!0;var s=o?o():"";ce(!1,"Failed %s type: %s%s",i,a.message,null!=s?s:"")}}},he=void 0,fe=void 0,ge=function(){},be=function(){};function ve(){if(O.current){var e=le(O.current);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}he=null,fe=!1,ge=function(e){if(null==e)return"#empty";if("string"==typeof e||"number"==typeof e)return"#text";if("string"==typeof e.type)return e.type;var t=e.type;if(t===s)return"React.Fragment";if("object"==typeof t&&null!==t&&t.$$typeof===m){var i=t.render.displayName||t.render.name||"";return""!==i?"ForwardRef("+i+")":"ForwardRef"}return t.displayName||t.name||"Unknown"},be=function(){var e,t,i,n="";if(he){var o=ge(he),r=he._owner;n+=(e=o,t=he._source,i=r&&le(r),"\n    in "+(e||"Unknown")+(t?" (at "+t.fileName.replace(/^.*[\\\/]/,"")+":"+t.lineNumber+")":i?" (created by "+i+")":""))}return n+=j.getStackAddendum()||""};var ye={};function xe(e,t){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;var i=function(e){var t=ve();if(!t){var i="string"==typeof e?e:e.displayName||e.name;i&&(t="\n\nCheck the top-level render call using <"+i+">.")}return t}(t);if(!ye[i]){ye[i]=!0;var n="";e&&e._owner&&e._owner!==O.current&&(n=" It was passed a child from "+le(e._owner)+"."),he=e,_(!1,'Each child in an array or iterator should have a unique "key" prop.%s%s See https://fb.me/react-warning-keys for more information.%s',i,n,be()),he=null}}}function ze(e,t){if("object"==typeof e)if(Array.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];X(n)&&xe(n,t)}else if(X(e))e._store&&(e._store.validated=!0);else if(e){var o=b(e);if("function"==typeof o&&o!==e.entries)for(var r=o.call(e),a=void 0;!(a=r.next()).done;)X(a.value)&&xe(a.value,t)}}function Ce(e){var t=e.type,i=void 0,n=void 0;if("function"==typeof t)i=t.displayName||t.name,n=t.propTypes;else{if("object"!=typeof t||null===t||t.$$typeof!==m)return;var o=t.render.displayName||t.render.name||"";i=""!==o?"ForwardRef("+o+")":"ForwardRef",n=t.propTypes}n?(he=e,me(n,e.props,"prop",i,be),he=null):void 0===t.PropTypes||fe||(fe=!0,_(!1,"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",i||"Unknown")),"function"==typeof t.getDefaultProps&&(t.getDefaultProps.isReactClassApproved||_(!1,"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead."))}function we(e,t,i){var n,o="string"==typeof(n=e)||"function"==typeof n||n===s||n===p||n===d||n===l||n===h||"object"==typeof n&&null!==n&&(n.$$typeof===c||n.$$typeof===u||n.$$typeof===m);if(!o){var r="";(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(r+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var a=function(e){if(null!=e&&void 0!==e.__source){var t=e.__source,i=t.fileName.replace(/^.*[\\\/]/,""),n=t.lineNumber;return"\n\nCheck your code at "+i+":"+n+"."}return""}(t);r+=a||ve(),r+=be()||"";var f=void 0;f=null===e?"null":Array.isArray(e)?"array":typeof e,_(!1,"React.createElement: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",f,r)}var g=H.apply(this,arguments);if(null==g)return g;if(o)for(var b=2;b<arguments.length;b++)ze(arguments[b],e);return e===s?function(e){he=e;for(var t=Object.keys(e.props),i=0;i<t.length;i++){var n=t[i];if("children"!==n&&"key"!==n){_(!1,"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.%s",n,be());break}}null!==e.ref&&_(!1,"Invalid attribute `ref` supplied to `React.Fragment`.%s",be());he=null}(g):Ce(g),g}var Ee={Children:{map:function(e,t,i){if(null==e)return e;var n=[];return se(e,n,null,t,i),n},forEach:function(e,t,i){if(null==e)return e;var n=te(null,null,t,i);ne(e,re,n),ie(n)},count:function(e){return ne(e,P.thatReturnsNull,null)},toArray:function(e){var t=[];return se(e,t,null,P.thatReturnsArgument),t},only:function(e){return X(e)||y(!1,"React.Children.only expected to receive a single React element child."),e}},createRef:function(){var e={current:null};return Object.seal(e),e},Component:k,PureComponent:D,createContext:function(e,t){void 0===t?t=null:null!==t&&"function"!=typeof t&&_(!1,"createContext: Expected the optional second argument to be a function. Instead received: %s",t);var i={$$typeof:u,_calculateChangedBits:t,_defaultValue:e,_currentValue:e,_currentValue2:e,_changedBits:0,_changedBits2:0,Provider:null,Consumer:null};return i.Provider={$$typeof:c,_context:i},i.Consumer=i,i._currentRenderer=null,i._currentRenderer2=null,i},forwardRef:function(e){"function"!=typeof e&&_(!1,"forwardRef requires a render function but was given %s.",null===e?"null":typeof e),null!=e&&(null!=e.defaultProps||null!=e.propTypes)&&_(!1,"forwardRef render functions do not support propTypes or defaultProps. Did you accidentally pass a React component?");return{$$typeof:m,render:e}},Fragment:s,StrictMode:l,unstable_AsyncMode:p,unstable_Profiler:d,createElement:we,cloneElement:function(e,t,i){for(var o=function(e,t,i){null==e&&y(!1,"React.cloneElement(...): The argument must be a React element, but you passed %s.",e);var o=void 0,r=n({},e.props),a=e.key,s=e.ref,l=e._self,d=e._source,c=e._owner;if(null!=t){U(t)&&(s=t.ref,c=O.current),G(t)&&(a=""+t.key);var u=void 0;for(o in e.type&&e.type.defaultProps&&(u=e.type.defaultProps),t)A.call(t,o)&&!V.hasOwnProperty(o)&&(void 0===t[o]&&void 0!==u?r[o]=u[o]:r[o]=t[o])}var p=arguments.length-2;if(1===p)r.children=i;else if(p>1){for(var m=Array(p),h=0;h<p;h++)m[h]=arguments[h+2];r.children=m}return q(e.type,a,s,l,d,c,r)}.apply(this,arguments),r=2;r<arguments.length;r++)ze(arguments[r],o.type);return Ce(o),o},createFactory:function(e){var t=we.bind(null,e);return t.type=e,Object.defineProperty(t,"type",{enumerable:!1,get:function(){return C(!1,"Factory.type is deprecated. Access the class directly before passing it to createFactory."),Object.defineProperty(this,"type",{value:e}),e}}),t},isValidElement:X,version:"16.4.1",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:O,assign:n}};0;n(Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,{ReactDebugCurrentFrame:j,ReactComponentTreeHook:{}});var Pe=Object.freeze({default:Ee}),_e=Pe&&Ee||Pe;return _e.default?_e.default:_e}();["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","use","video","wbr"].forEach(function(t){e[t.toUpperCase()]=i.createElement.bind(i,t)})}(this),function(e,t){e.ReactDOM=function(e){var t=function(e){};t=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")};var i=function(e,i,n,o,r,a,s,l){if(t(i),!e){var d;if(void 0===i)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,o,r,a,s,l],u=0;(d=new Error(i.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw d.framesToPop=1,d}};e||i(!1,"ReactDOM was loaded before React. Make sure you load the React package before loading ReactDOM.");var n=function(e,t,i,n,o,r,a,s,l){this._hasCaughtError=!1,this._caughtError=null;var d=Array.prototype.slice.call(arguments,3);try{t.apply(i,d)}catch(e){this._caughtError=e,this._hasCaughtError=!0}};if("undefined"!=typeof window&&"function"==typeof window.dispatchEvent&&"undefined"!=typeof document&&"function"==typeof document.createEvent){var o=document.createElement("react");n=function(e,t,n,r,a,s,l,d,c){"undefined"==typeof document&&i(!1,"The `document` global was defined when React was initialized, but is not defined anymore. This can happen in a test environment if a component schedules an update from an asynchronous callback, but the test has already finished running. To solve this, you can either unmount the component at the end of your test (and ensure that any asynchronous operations get canceled in `componentWillUnmount`), or you can change the test itself to be asynchronous.");var u=document.createEvent("Event"),p=!0,m=Array.prototype.slice.call(arguments,3);var h=void 0,f=!1,g=!1;function b(e){h=e.error,f=!0,null===h&&0===e.colno&&0===e.lineno&&(g=!0)}var v="react-"+(e||"invokeguardedcallback");window.addEventListener("error",b),o.addEventListener(v,function e(){o.removeEventListener(v,e,!1),t.apply(n,m),p=!1},!1),u.initEvent(v,!1,!1),o.dispatchEvent(u),p?(f?g&&(h=new Error("A cross-origin error was thrown. React doesn't have access to the actual error object in development. See https://fb.me/react-crossorigin-error for more information.")):h=new Error("An error was thrown inside one of your components, but React doesn't know what it was. This is likely due to browser flakiness. React does its best to preserve the \"Pause on exceptions\" behavior of the DevTools, which requires some DEV-mode only tricks. It's possible that these don't work in your browser. Try triggering the error in production mode, or switching to a modern browser. If you suspect that this is actually an issue with React, please file an issue."),this._hasCaughtError=!0,this._caughtError=h):(this._hasCaughtError=!1,this._caughtError=null);window.removeEventListener("error",b)}}var r=n,a={_caughtError:null,_hasCaughtError:!1,_rethrowError:null,_hasRethrowError:!1,invokeGuardedCallback:function(e,t,i,n,o,s,l,d,c){r.apply(a,arguments)},invokeGuardedCallbackAndCatchFirstError:function(e,t,i,n,o,r,s,l,d){if(a.invokeGuardedCallback.apply(this,arguments),a.hasCaughtError()){var c=a.clearCaughtError();a._hasRethrowError||(a._hasRethrowError=!0,a._rethrowError=c)}},rethrowCaughtError:function(){return s.apply(a,arguments)},hasCaughtError:function(){return a._hasCaughtError},clearCaughtError:function(){if(a._hasCaughtError){var e=a._caughtError;return a._caughtError=null,a._hasCaughtError=!1,e}i(!1,"clearCaughtError was called but no error was captured. This error is likely caused by a bug in React. Please file an issue.")}},s=function(){if(a._hasRethrowError){var e=a._rethrowError;throw a._rethrowError=null,a._hasRethrowError=!1,e}},l=null,d={};function c(){if(l)for(var e in d){var t=d[e],n=l.indexOf(e);if(n>-1||i(!1,"EventPluginRegistry: Cannot inject event plugins that do not exist in the plugin ordering, `%s`.",e),!m[n]){t.extractEvents||i(!1,"EventPluginRegistry: Event plugins must implement an `extractEvents` method, but `%s` does not.",e),m[n]=t;var o=t.eventTypes;for(var r in o)u(o[r],t,r)||i(!1,"EventPluginRegistry: Failed to publish event `%s` for plugin `%s`.",r,e)}}}function u(e,t,n){h.hasOwnProperty(n)&&i(!1,"EventPluginHub: More than one plugin attempted to publish the same event name, `%s`.",n),h[n]=e;var o=e.phasedRegistrationNames;if(o){for(var r in o)if(o.hasOwnProperty(r)){var a=o[r];p(a,t,n)}return!0}return!!e.registrationName&&(p(e.registrationName,t,n),!0)}function p(e,t,n){f[e]&&i(!1,"EventPluginHub: More than one plugin attempted to publish the same registration name, `%s`.",e),f[e]=t,g[e]=t.eventTypes[n].dependencies;var o=e.toLowerCase();b[o]=e,"onDoubleClick"===e&&(b.ondblclick=e)}var m=[],h={},f={},g={},b={};function v(e){l&&i(!1,"EventPluginRegistry: Cannot inject event plugin ordering more than once. You are likely trying to load more than one copy of React."),l=Array.prototype.slice.call(e),c()}function y(e){var t=!1;for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];d.hasOwnProperty(n)&&d[n]===o||(d[n]&&i(!1,"EventPluginRegistry: Cannot inject two different event plugins using the same name, `%s`.",n),d[n]=o,t=!0)}t&&c()}var x=Object.freeze({plugins:m,eventNameDispatchConfigs:h,registrationNameModules:f,registrationNameDependencies:g,possibleRegistrationNames:b,injectEventPluginOrder:v,injectEventPluginsByName:y});function z(e){return function(){return e}}var C=function(){};C.thatReturns=z,C.thatReturnsFalse=z(!1),C.thatReturnsTrue=z(!0),C.thatReturnsNull=z(null),C.thatReturnsThis=function(){return this},C.thatReturnsArgument=function(e){return e};var w=C,E=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var i=arguments.length,n=Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];(function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var o=0,r="Warning: "+e.replace(/%s/g,function(){return i[o++]});"undefined"!=typeof console&&console.error(r);try{throw new Error(r)}catch(e){}}).apply(void 0,[t].concat(n))}},P=null,_=null,T=null,S={injectComponentTree:function(e){P=e.getFiberCurrentPropsFromNode,_=e.getInstanceFromNode,(T=e.getNodeFromInstance)&&_||E(!1,"EventPluginUtils.injection.injectComponentTree(...): Injected module is missing getNodeFromInstance or getInstanceFromNode.")}},R=void 0;function k(e,t,i,n){var o=e.type||"unknown-event";e.currentTarget=T(n),a.invokeGuardedCallbackAndCatchFirstError(o,i,void 0,e),e.currentTarget=null}function $(e,t){return null==t&&i(!1,"accumulateInto(...): Accumulated items must not be null or undefined."),null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function I(e,t,i){Array.isArray(e)?e.forEach(t,i):e&&t.call(i,e)}R=function(e){var t=e._dispatchListeners,i=e._dispatchInstances,n=Array.isArray(t),o=n?t.length:t?1:0,r=Array.isArray(i),a=r?i.length:i?1:0;(r!==n||a!==o)&&E(!1,"EventPluginUtils: Invalid `event`.")};var M=null,F=function(e,t){e&&(!function(e,t){var i=e._dispatchListeners,n=e._dispatchInstances;if(R(e),Array.isArray(i))for(var o=0;o<i.length&&!e.isPropagationStopped();o++)k(e,t,i[o],n[o]);else i&&k(e,t,i,n);e._dispatchListeners=null,e._dispatchInstances=null}(e,t),e.isPersistent()||e.constructor.release(e))},D=function(e){return F(e,!0)},N=function(e){return F(e,!1)};var O={injectEventPluginOrder:v,injectEventPluginsByName:y};function A(e,t){var n=void 0,o=e.stateNode;if(!o)return null;var r=P(o);return r?(n=r[t],function(e,t,i){switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":return!(!i.disabled||(n=t,"button"!==n&&"input"!==n&&"select"!==n&&"textarea"!==n));default:return!1}var n}(t,e.type,r)?null:(n&&"function"!=typeof n&&i(!1,"Expected `%s` listener to be a function, instead got a value of `%s` type.",t,typeof n),n)):null}function V(e,t){null!==e&&(M=$(M,e));var n=M;M=null,n&&(I(n,t?D:N),M&&i(!1,"processEventQueue(): Additional events were enqueued while processing an event queue. Support for this has not yet been implemented."),a.rethrowCaughtError())}function B(e,t,i,n){var o=function(e,t,i,n){for(var o=null,r=0;r<m.length;r++){var a=m[r];if(a){var s=a.extractEvents(e,t,i,n);s&&(o=$(o,s))}}return o}(e,t,i,n);V(o,!1)}var L=Object.freeze({injection:O,getListener:A,runEventsInBatch:V,runExtractedEventsInBatch:B}),U=0,G=1,q=2,H=3,X=4,j=5,W=6,Y=10,K=11,J=12,Z=13,Q=14,ee=15,te=16,ie=Math.random().toString(36).slice(2),ne="__reactInternalInstance$"+ie,oe="__reactEventHandlers$"+ie;function re(e,t){t[ne]=e}function ae(e){if(e[ne])return e[ne];for(;!e[ne];){if(!e.parentNode)return null;e=e.parentNode}var t=e[ne];return t.tag===j||t.tag===W?t:null}function se(e){var t=e[ne];return t&&(t.tag===j||t.tag===W)?t:null}function le(e){if(e.tag===j||e.tag===W)return e.stateNode;i(!1,"getNodeFromInstance: Invalid argument.")}function de(e){return e[oe]||null}function ce(e,t){e[oe]=t}var ue=Object.freeze({precacheFiberNode:re,getClosestInstanceFromNode:ae,getInstanceFromNode:se,getNodeFromInstance:le,getFiberCurrentPropsFromNode:de,updateFiberProps:ce});function pe(e){do{e=e.return}while(e&&e.tag!==j);return e||null}function me(e,t,i){for(var n=[];e;)n.push(e),e=pe(e);var o=void 0;for(o=n.length;o-- >0;)t(n[o],"captured",i);for(o=0;o<n.length;o++)t(n[o],"bubbled",i)}function he(e,t,i,n,o){for(var r=e&&t?function(e,t){for(var i=0,n=e;n;n=pe(n))i++;for(var o=0,r=t;r;r=pe(r))o++;for(;i-o>0;)e=pe(e),i--;for(;o-i>0;)t=pe(t),o--;var a=i;for(;a--;){if(e===t||e===t.alternate)return e;e=pe(e),t=pe(t)}return null}(e,t):null,a=[];e&&e!==r;){var s=e.alternate;if(null!==s&&s===r)break;a.push(e),e=pe(e)}for(var l=[];t&&t!==r;){var d=t.alternate;if(null!==d&&d===r)break;l.push(t),t=pe(t)}for(var c=0;c<a.length;c++)i(a[c],"bubbled",n);for(var u=l.length;u-- >0;)i(l[u],"captured",o)}function fe(e,t,i){e||E(!1,"Dispatching inst must not be null");var n,o,r,a=(n=e,o=t,r=i.dispatchConfig.phasedRegistrationNames[o],A(n,r));a&&(i._dispatchListeners=$(i._dispatchListeners,a),i._dispatchInstances=$(i._dispatchInstances,e))}function ge(e){e&&e.dispatchConfig.phasedRegistrationNames&&me(e._targetInst,fe,e)}function be(e){if(e&&e.dispatchConfig.phasedRegistrationNames){var t=e._targetInst,i=t?pe(t):null;me(i,fe,e)}}function ve(e,t,i){if(e&&i&&i.dispatchConfig.registrationName){var n=i.dispatchConfig.registrationName,o=A(e,n);o&&(i._dispatchListeners=$(i._dispatchListeners,o),i._dispatchInstances=$(i._dispatchInstances,e))}}function ye(e){e&&e.dispatchConfig.registrationName&&ve(e._targetInst,null,e)}function xe(e){I(e,ge)}function ze(e,t,i,n){he(i,n,ve,e,t)}var Ce=Object.freeze({accumulateTwoPhaseDispatches:xe,accumulateTwoPhaseDispatchesSkipTarget:function(e){I(e,be)},accumulateEnterLeaveDispatches:ze,accumulateDirectDispatches:function(e){I(e,ye)}}),we=!("undefined"==typeof window||!window.document||!window.document.createElement),Ee={canUseDOM:we,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:we&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:we&&!!window.screen,isInWorker:!we};function Pe(e){return e}function _e(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i["ms"+e]="MS"+t,i["O"+e]="o"+t.toLowerCase(),i}var Te={animationend:_e("Animation","AnimationEnd"),animationiteration:_e("Animation","AnimationIteration"),animationstart:_e("Animation","AnimationStart"),transitionend:_e("Transition","TransitionEnd")},Se={},Re={};Ee.canUseDOM&&(Re=document.createElement("div").style,"AnimationEvent"in window||(delete Te.animationend.animation,delete Te.animationiteration.animation,delete Te.animationstart.animation),"TransitionEvent"in window||delete Te.transitionend.transition);function ke(e){if(Se[e])return Se[e];if(!Te[e])return e;var t=Te[e];for(var i in t)if(t.hasOwnProperty(i)&&i in Re)return Se[e]=t[i];return e}var $e=Pe("abort"),Ie=Pe(ke("animationend")),Me=Pe(ke("animationiteration")),Fe=Pe(ke("animationstart")),De=Pe("blur"),Ne=Pe("canplay"),Oe=Pe("canplaythrough"),Ae=Pe("cancel"),Ve=Pe("change"),Be=Pe("click"),Le=Pe("close"),Ue=Pe("compositionend"),Ge=Pe("compositionstart"),qe=Pe("compositionupdate"),He=Pe("contextmenu"),Xe=Pe("copy"),je=Pe("cut"),We=Pe("dblclick"),Ye=Pe("drag"),Ke=Pe("dragend"),Je=Pe("dragenter"),Ze=Pe("dragexit"),Qe=Pe("dragleave"),et=Pe("dragover"),tt=Pe("dragstart"),it=Pe("drop"),nt=Pe("durationchange"),ot=Pe("emptied"),rt=Pe("encrypted"),at=Pe("ended"),st=Pe("error"),lt=Pe("focus"),dt=Pe("gotpointercapture"),ct=Pe("input"),ut=Pe("invalid"),pt=Pe("keydown"),mt=Pe("keypress"),ht=Pe("keyup"),ft=Pe("load"),gt=Pe("loadstart"),bt=Pe("loadeddata"),vt=Pe("loadedmetadata"),yt=Pe("lostpointercapture"),xt=Pe("mousedown"),zt=Pe("mousemove"),Ct=Pe("mouseout"),wt=Pe("mouseover"),Et=Pe("mouseup"),Pt=Pe("paste"),_t=Pe("pause"),Tt=Pe("play"),St=Pe("playing"),Rt=Pe("pointercancel"),kt=Pe("pointerdown"),$t=Pe("pointermove"),It=Pe("pointerout"),Mt=Pe("pointerover"),Ft=Pe("pointerup"),Dt=Pe("progress"),Nt=Pe("ratechange"),Ot=Pe("reset"),At=Pe("scroll"),Vt=Pe("seeked"),Bt=Pe("seeking"),Lt=Pe("selectionchange"),Ut=Pe("stalled"),Gt=Pe("submit"),qt=Pe("suspend"),Ht=Pe("textInput"),Xt=Pe("timeupdate"),jt=Pe("toggle"),Wt=Pe("touchcancel"),Yt=Pe("touchend"),Kt=Pe("touchmove"),Jt=Pe("touchstart"),Zt=Pe(ke("transitionend")),Qt=Pe("volumechange"),ei=Pe("waiting"),ti=Pe("wheel"),ii=[$e,Ne,Oe,nt,ot,rt,at,st,bt,vt,gt,_t,Tt,St,Dt,Nt,Vt,Bt,Ut,qt,Xt,Qt,ei];function ni(e){return e}var oi=null;function ri(){return!oi&&Ee.canUseDOM&&(oi="textContent"in document.documentElement?"textContent":"innerText"),oi}var ai={_root:null,_startText:null,_fallbackText:null};function si(){if(ai._fallbackText)return ai._fallbackText;var e=void 0,t=ai._startText,i=t.length,n=void 0,o=li(),r=o.length;for(e=0;e<i&&t[e]===o[e];e++);var a=i-e;for(n=1;n<=a&&t[i-n]===o[r-n];n++);var s=n>1?1-n:void 0;return ai._fallbackText=o.slice(e,s),ai._fallbackText}function li(){return"value"in ai._root?ai._root.value:ai._root[ri()]}var di=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.assign,ci=!1,ui=10,pi=["dispatchConfig","_targetInst","nativeEvent","isDefaultPrevented","isPropagationStopped","_dispatchListeners","_dispatchInstances"],mi={type:null,target:null,currentTarget:w.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};function hi(e,t,i,n){delete this.nativeEvent,delete this.preventDefault,delete this.stopPropagation,this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=i;var o=this.constructor.Interface;for(var r in o)if(o.hasOwnProperty(r)){delete this[r];var a=o[r];a?this[r]=a(i):"target"===r?this.target=n:this[r]=i[r]}var s=null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue;return this.isDefaultPrevented=s?w.thatReturnsTrue:w.thatReturnsFalse,this.isPropagationStopped=w.thatReturnsFalse,this}di(hi.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=w.thatReturnsTrue)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=w.thatReturnsTrue)},persist:function(){this.isPersistent=w.thatReturnsTrue},isPersistent:w.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)Object.defineProperty(this,t,fi(t,e[t]));for(var i=0;i<pi.length;i++)this[pi[i]]=null;Object.defineProperty(this,"nativeEvent",fi("nativeEvent",null)),Object.defineProperty(this,"preventDefault",fi("preventDefault",w)),Object.defineProperty(this,"stopPropagation",fi("stopPropagation",w))}}),hi.Interface=mi,hi.extend=function(e){var t=this,i=function(){};i.prototype=t.prototype;var n=new i;function o(){return t.apply(this,arguments)}return di(n,o.prototype),o.prototype=n,o.prototype.constructor=o,o.Interface=di({},t.Interface,e),o.extend=t.extend,vi(o),o},"function"!=typeof Proxy||Object.isSealed(new Proxy({},{}))||(hi=new Proxy(hi,{construct:function(e,t){return this.apply(e,Object.create(e.prototype),t)},apply:function(e,t,i){return new Proxy(e.apply(t,i),{set:function(e,t,i){return"isPersistent"===t||e.constructor.Interface.hasOwnProperty(t)||-1!==pi.indexOf(t)||(ci||e.isPersistent()||E(!1,"This synthetic event is reused for performance reasons. If you're seeing this, you're adding a new property in the synthetic event object. The property is never released. See https://fb.me/react-event-pooling for more information."),ci=!0),e[t]=i,!0}})}}));function fi(e,t){var i="function"==typeof t;return{configurable:!0,set:function(e){return n(i?"setting the method":"setting the property","This is effectively a no-op"),e},get:function(){return n(i?"accessing the method":"accessing the property",i?"This is a no-op function":"This is set to null"),t}};function n(t,i){E(!1,"This synthetic event is reused for performance reasons. If you're seeing this, you're %s `%s` on a released/nullified synthetic event. %s. If you must keep the original synthetic event around, use event.persist(). See https://fb.me/react-event-pooling for more information.",t,e,i)}}function gi(e,t,i,n){if(this.eventPool.length){var o=this.eventPool.pop();return this.call(o,e,t,i,n),o}return new this(e,t,i,n)}function bi(e){e instanceof this||i(!1,"Trying to release an event instance  into a pool of a different type."),e.destructor(),this.eventPool.length<ui&&this.eventPool.push(e)}function vi(e){e.eventPool=[],e.getPooled=gi,e.release=bi}vi(hi);var yi=hi,xi=yi.extend({data:null}),zi=yi.extend({data:null}),Ci=[9,13,27,32],wi=229,Ei=Ee.canUseDOM&&"CompositionEvent"in window,Pi=null;Ee.canUseDOM&&"documentMode"in document&&(Pi=document.documentMode);var _i=Ee.canUseDOM&&"TextEvent"in window&&!Pi,Ti=Ee.canUseDOM&&(!Ei||Pi&&Pi>8&&Pi<=11),Si=32,Ri=String.fromCharCode(Si),ki={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:[Ue,mt,Ht,Pt]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:[De,Ue,pt,mt,ht,xt]},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:[De,Ge,pt,mt,ht,xt]},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:[De,qe,pt,mt,ht,xt]}},$i=!1;function Ii(e,t){switch(e){case ht:return-1!==Ci.indexOf(t.keyCode);case pt:return t.keyCode!==wi;case mt:case xt:case De:return!0;default:return!1}}function Mi(e){var t=e.detail;return"object"==typeof t&&"data"in t?t.data:null}var Fi=!1;function Di(e,t,i,n){var o,r=void 0,a=void 0;if(Ei?r=function(e){switch(e){case Ge:return ki.compositionStart;case Ue:return ki.compositionEnd;case qe:return ki.compositionUpdate}}(e):Fi?Ii(e,i)&&(r=ki.compositionEnd):e===pt&&i.keyCode===wi&&(r=ki.compositionStart),!r)return null;Ti&&(Fi||r!==ki.compositionStart?r===ki.compositionEnd&&Fi&&(a=si()):(o=n,ai._root=o,ai._startText=li(),Fi=!0));var s=xi.getPooled(r,t,i,n);if(a)s.data=a;else{var l=Mi(i);null!==l&&(s.data=l)}return xe(s),s}function Ni(e,t){if(Fi){if(e===Ue||!Ei&&Ii(e,t)){var i=si();return ai._root=null,ai._startText=null,ai._fallbackText=null,Fi=!1,i}return null}switch(e){case Pt:return null;case mt:if(!((n=t).ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(t.char&&t.char.length>1)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case Ue:return Ti?null:t.data;default:return null}var n}function Oi(e,t,i,n){var o=void 0;if(!(o=_i?function(e,t){switch(e){case Ue:return Mi(t);case mt:var i=t.which;return i!==Si?null:($i=!0,Ri);case Ht:var n=t.data;return n===Ri&&$i?null:n;default:return null}}(e,i):Ni(e,i)))return null;var r=zi.getPooled(ki.beforeInput,t,i,n);return r.data=o,xe(r),r}var Ai={eventTypes:ki,extractEvents:function(e,t,i,n){var o=Di(e,t,i,n),r=Oi(e,t,i,n);return null===o?r:null===r?o:[o,r]}},Vi=null,Bi=null,Li=null;function Ui(e){var t=_(e);if(t){Vi&&"function"==typeof Vi.restoreControlledState||i(!1,"Fiber needs to be injected to handle a fiber target for controlled events. This error is likely caused by a bug in React. Please file an issue.");var n=P(t.stateNode);Vi.restoreControlledState(t.stateNode,t.type,n)}}var Gi={injectFiberControlledHostComponent:function(e){Vi=e}};function qi(e){Bi?Li?Li.push(e):Li=[e]:Bi=e}function Hi(){return null!==Bi||null!==Li}function Xi(){if(Bi){var e=Bi,t=Li;if(Bi=null,Li=null,Ui(e),t)for(var i=0;i<t.length;i++)Ui(t[i])}}var ji=Object.freeze({injection:Gi,enqueueStateRestore:qi,needsStateRestore:Hi,restoreStateIfNeeded:Xi}),Wi=function(e,t){return e(t)},Yi=function(e,t,i){return e(t,i)},Ki=function(){},Ji=!1;function Zi(e,t){if(Ji)return e(t);Ji=!0;try{return Wi(e,t)}finally{Ji=!1;var i=Hi();i&&(Ki(),Xi())}}var Qi={injectRenderer:function(e){Wi=e.batchedUpdates,Yi=e.interactiveUpdates,Ki=e.flushInteractiveUpdates}},en={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!en[e.type]:"textarea"===t}var nn=1,on=3,rn=8,an=9,sn=11;function ln(e){var t=e.target||e.srcElement||window;return t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===on?t.parentNode:t}function dn(e,t){if(!Ee.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,n=i in document;if(!n){var o=document.createElement("div");o.setAttribute(i,"return;"),n="function"==typeof o[i]}return n}function cn(e){var t=e.type,i=e.nodeName;return i&&"input"===i.toLowerCase()&&("checkbox"===t||"radio"===t)}function un(e){return e._valueTracker}function pn(e){un(e)||(e._valueTracker=function(e){var t=cn(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(e.hasOwnProperty(t)||void 0===i||"function"!=typeof i.get||"function"!=typeof i.set)return;var o=i.get,r=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){n=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}(e))}function mn(e){if(!e)return!1;var t=un(e);if(!t)return!0;var i=t.getValue(),n=function(e){var t="";if(!e)return t;t=cn(e)?e.checked?"true":"false":e.value;return t}(e);return n!==i&&(t.setValue(n),!0)}var hn=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fn=hn.ReactCurrentOwner,gn=hn.ReactDebugCurrentFrame,bn=function(e,t,i){return"\n    in "+(e||"Unknown")+(t?" (at "+t.fileName.replace(/^.*[\\\/]/,"")+":"+t.lineNumber+")":i?" (created by "+i+")":"")},vn="function"==typeof Symbol&&Symbol.for,yn=vn?Symbol.for("react.element"):60103,xn=vn?Symbol.for("react.portal"):60106,zn=vn?Symbol.for("react.fragment"):60107,Cn=vn?Symbol.for("react.strict_mode"):60108,wn=vn?Symbol.for("react.profiler"):60114,En=vn?Symbol.for("react.provider"):60109,Pn=vn?Symbol.for("react.context"):60110,_n=vn?Symbol.for("react.async_mode"):60111,Tn=vn?Symbol.for("react.forward_ref"):60112,Sn=vn?Symbol.for("react.timeout"):60113,Rn="function"==typeof Symbol&&Symbol.iterator,kn="@@iterator";function $n(e){if(null==e)return null;var t=Rn&&e[Rn]||e[kn];return"function"==typeof t?t:null}function In(e){var t=e.type;if("function"==typeof t)return t.displayName||t.name;if("string"==typeof t)return t;switch(t){case _n:return"AsyncMode";case Pn:return"Context.Consumer";case zn:return"ReactFragment";case xn:return"ReactPortal";case wn:return"Profiler("+e.pendingProps.id+")";case En:return"Context.Provider";case Cn:return"StrictMode";case Sn:return"Timeout"}if("object"==typeof t&&null!==t)switch(t.$$typeof){case Tn:var i=t.render.displayName||t.render.name||"";return""!==i?"ForwardRef("+i+")":"ForwardRef"}return null}function Mn(e){switch(e.tag){case U:case G:case q:case j:var t=e._debugOwner,i=e._debugSource,n=In(e),o=null;return t&&(o=In(t)),bn(n,i,o);default:return""}}function Fn(e){var t="",i=e;do{t+=Mn(i),i=i.return}while(i);return t}function Dn(){var e=Nn.current;return null===e?null:Fn(e)}var Nn={current:null,phase:null,resetCurrentFiber:function(){gn.getCurrentStack=null,Nn.current=null,Nn.phase=null},setCurrentFiber:function(e){gn.getCurrentStack=Dn,Nn.current=e,Nn.phase=null},setCurrentPhase:function(e){Nn.phase=e},getCurrentFiberOwnerName:function(){var e=Nn.current;if(null===e)return null;var t=e._debugOwner;if(null!=t)return In(t);return null},getCurrentFiberStackAddendum:Dn},On=0,An=2,Vn=3,Bn=4,Ln=5,Un=6,Gn=":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",qn=Gn+"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",Hn="data-reactroot",Xn=new RegExp("^["+Gn+"]["+qn+"]*$"),jn={},Wn={};function Yn(e){return!!Wn.hasOwnProperty(e)||!jn.hasOwnProperty(e)&&(Xn.test(e)?(Wn[e]=!0,!0):(jn[e]=!0,E(!1,"Invalid attribute name: `%s`",e),!1))}function Kn(e,t,i){return null!==t?t.type===On:!i&&(e.length>2&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1]))}function Jn(e,t,i,n){if(null!==i&&i.type===On)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":if(n)return!1;if(null!==i)return!i.acceptsBooleans;var o=e.toLowerCase().slice(0,5);return"data-"!==o&&"aria-"!==o;default:return!1}}function Zn(e,t,i,n){if(null==t)return!0;if(Jn(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case Vn:return!t;case Bn:return!1===t;case Ln:return isNaN(t);case Un:return isNaN(t)||t<1}return!1}function Qn(e){return to.hasOwnProperty(e)?to[e]:null}function eo(e,t,i,n,o){this.acceptsBooleans=t===An||t===Vn||t===Bn,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=i,this.propertyName=e,this.type=t}var to={};["children","dangerouslySetInnerHTML","defaultValue","defaultChecked","innerHTML","suppressContentEditableWarning","suppressHydrationWarning","style"].forEach(function(e){to[e]=new eo(e,On,!1,e,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0],i=e[1];to[t]=new eo(t,1,!1,i,null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){to[e]=new eo(e,An,!1,e.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","preserveAlpha"].forEach(function(e){to[e]=new eo(e,An,!1,e,null)}),["allowFullScreen","async","autoFocus","autoPlay","controls","default","defer","disabled","formNoValidate","hidden","loop","noModule","noValidate","open","playsInline","readOnly","required","reversed","scoped","seamless","itemScope"].forEach(function(e){to[e]=new eo(e,Vn,!1,e.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(e){to[e]=new eo(e,Vn,!0,e.toLowerCase(),null)}),["capture","download"].forEach(function(e){to[e]=new eo(e,Bn,!1,e.toLowerCase(),null)}),["cols","rows","size","span"].forEach(function(e){to[e]=new eo(e,Un,!1,e.toLowerCase(),null)}),["rowSpan","start"].forEach(function(e){to[e]=new eo(e,Ln,!1,e.toLowerCase(),null)});var io=/[\-\:]([a-z])/g,no=function(e){return e[1].toUpperCase()};function oo(e,t,i,n){if(n.mustUseProperty){var o=n.propertyName;return e[o]}var r=n.attributeName,a=null;if(n.type===Bn){if(e.hasAttribute(r)){var s=e.getAttribute(r);return""===s||(Zn(t,i,n,!1)?s:s===""+i?i:s)}}else if(e.hasAttribute(r)){if(Zn(t,i,n,!1))return e.getAttribute(r);if(n.type===Vn)return i;a=e.getAttribute(r)}return Zn(t,i,n,!1)?null===a?i:a:a===""+i?i:a}function ro(e,t,i){if(Yn(t)){if(!e.hasAttribute(t))return void 0===i?void 0:null;var n=e.getAttribute(t);return n===""+i?i:n}}function ao(e,t,i,n){var o=Qn(t);if(!Kn(t,o,n))if(Zn(t,i,o,n)&&(i=null),n||null===o){if(Yn(t)){var r=t;null===i?e.removeAttribute(r):e.setAttribute(r,""+i)}}else{var a=o.mustUseProperty;if(a){var s=o.propertyName;if(null===i){var l=o.type;e[s]=l!==Vn&&""}else e[s]=i}else{var d=o.attributeName,c=o.attributeNamespace;if(null===i)e.removeAttribute(d);else{var u=o.type,p=void 0;p=u===Vn||u===Bn&&!0===i?"":""+i,c?e.setAttributeNS(c,d,p):e.setAttribute(d,p)}}}}["accent-height","alignment-baseline","arabic-form","baseline-shift","cap-height","clip-path","clip-rule","color-interpolation","color-interpolation-filters","color-profile","color-rendering","dominant-baseline","enable-background","fill-opacity","fill-rule","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","glyph-name","glyph-orientation-horizontal","glyph-orientation-vertical","horiz-adv-x","horiz-origin-x","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","overline-position","overline-thickness","paint-order","panose-1","pointer-events","rendering-intent","shape-rendering","stop-color","stop-opacity","strikethrough-position","strikethrough-thickness","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-rendering","underline-position","underline-thickness","unicode-bidi","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","vector-effect","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","writing-mode","xmlns:xlink","x-height"].forEach(function(e){var t=e.replace(io,no);to[t]=new eo(t,1,!1,e,null)}),["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type"].forEach(function(e){var t=e.replace(io,no);to[t]=new eo(t,1,!1,e,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(io,no);to[t]=new eo(t,1,!1,e,"http://www.w3.org/XML/1998/namespace")}),to.tabIndex=new eo("tabIndex",1,!1,"tabindex",null);var so=i,lo=E,co="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",uo={};var po=function(e,t,i,n,o){for(var r in e)if(e.hasOwnProperty(r)){var a;try{so("function"==typeof e[r],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",n||"React class",i,r,typeof e[r]),a=e[r](t,r,n,i,null,co)}catch(e){a=e}if(lo(!a||a instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",n||"React class",i,r,typeof a),a instanceof Error&&!(a.message in uo)){uo[a.message]=!0;var s=o?o():"";lo(!1,"Failed %s type: %s%s",i,a.message,null!=s?s:"")}}},mo={checkPropTypes:null},ho={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},fo={value:function(e,t,i){return!e[t]||ho[e.type]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t,i){return!e[t]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")}};mo.checkPropTypes=function(e,t,i){po(fo,t,"prop",e,i)};var go=Nn.getCurrentFiberOwnerName,bo=Nn.getCurrentFiberStackAddendum,vo=!1,yo=!1,xo=!1,zo=!1;function Co(e){var t="checkbox"===e.type||"radio"===e.type;return t?null!=e.checked:null!=e.value}function wo(e,t){var i=e,n=t.checked,o=di({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:i._wrapperState.initialChecked});return o}function Eo(e,t){mo.checkPropTypes("input",t,bo),void 0===t.checked||void 0===t.defaultChecked||yo||(E(!1,"%s contains an input of type %s with both checked and defaultChecked props. Input elements must be either controlled or uncontrolled (specify either the checked prop, or the defaultChecked prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://fb.me/react-controlled-components",go()||"A component",t.type),yo=!0),void 0===t.value||void 0===t.defaultValue||vo||(E(!1,"%s contains an input of type %s with both value and defaultValue props. Input elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://fb.me/react-controlled-components",go()||"A component",t.type),vo=!0);var i=e,n=null==t.defaultValue?"":t.defaultValue;i._wrapperState={initialChecked:null!=t.checked?t.checked:t.defaultChecked,initialValue:ko(null!=t.value?t.value:n),controlled:Co(t)}}function Po(e,t){var i=e,n=t.checked;null!=n&&ao(i,"checked",n,!1)}function _o(e,t){var i=e,n=Co(t);i._wrapperState.controlled||!n||zo||(E(!1,"A component is changing an uncontrolled input of type %s to be controlled. Input elements should not switch from uncontrolled to controlled (or vice versa). Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://fb.me/react-controlled-components%s",t.type,bo()),zo=!0),!i._wrapperState.controlled||n||xo||(E(!1,"A component is changing a controlled input of type %s to be uncontrolled. Input elements should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://fb.me/react-controlled-components%s",t.type,bo()),xo=!0),Po(e,t);var o=ko(t.value);null!=o&&("number"===t.type?(0===o&&""===i.value||i.value!=o)&&(i.value=""+o):i.value!==""+o&&(i.value=""+o)),t.hasOwnProperty("value")?Ro(i,t.type,o):t.hasOwnProperty("defaultValue")&&Ro(i,t.type,ko(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(i.defaultChecked=!!t.defaultChecked)}function To(e,t,i){var n=e;if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=""+n._wrapperState.initialValue,r=n.value;i||o!==r&&(n.value=o),n.defaultValue=o}var a=n.name;""!==a&&(n.name=""),n.defaultChecked=!n.defaultChecked,n.defaultChecked=!n.defaultChecked,""!==a&&(n.name=a)}function So(e,t){var n=e;_o(n,t),function(e,t){var n=t.name;if("radio"===t.type&&null!=n){for(var o=e;o.parentNode;)o=o.parentNode;for(var r=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),a=0;a<r.length;a++){var s=r[a];if(s!==e&&s.form===e.form){var l=de(s);l||i(!1,"ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported."),mn(s),_o(s,l)}}}}(n,t)}function Ro(e,t,i){"number"===t&&e.ownerDocument.activeElement===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}function ko(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}var $o={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:[De,Ve,Be,lt,ct,pt,ht,Lt]}};function Io(e,t,i){var n=yi.getPooled($o.change,e,t,i);return n.type="change",qi(i),xe(n),n}var Mo=null,Fo=null;function Do(e){V(e,!1)}function No(e){var t=le(e);if(mn(t))return e}function Oo(e,t){if(e===Ve)return t}var Ao=!1;Ee.canUseDOM&&(Ao=dn("input")&&(!document.documentMode||document.documentMode>9));function Vo(){Mo&&(Mo.detachEvent("onpropertychange",Bo),Mo=null,Fo=null)}function Bo(e){var t;"value"===e.propertyName&&(No(Fo)&&Zi(Do,Io(Fo,t=e,ln(t))))}function Lo(e,t,i){e===lt?(Vo(),Fo=i,(Mo=t).attachEvent("onpropertychange",Bo)):e===De&&Vo()}function Uo(e,t){if(e===Lt||e===ht||e===pt)return No(Fo)}function Go(e,t){if(e===Be)return No(t)}function qo(e,t){if(e===ct||e===Ve)return No(t)}var Ho={eventTypes:$o,_isInputEventSupported:Ao,extractEvents:function(e,t,i,n){var o,r,a,s,l=t?le(t):window,d=void 0,c=void 0;if("select"===(s=(a=l).nodeName&&a.nodeName.toLowerCase())||"input"===s&&"file"===a.type?d=Oo:tn(l)?Ao?d=qo:(d=Uo,c=Lo):!(r=(o=l).nodeName)||"input"!==r.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type||(d=Go),d){var u=d(e,t);if(u){var p=Io(u,i,n);return p}}c&&c(e,l,t),e===De&&function(e){var t=e._wrapperState;if(!t||!t.controlled||"number"!==e.type)return;Ro(e,"number",e.value)}(l)}},Xo=yi.extend({view:null,detail:null}),jo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wo(e){var t=this.nativeEvent;if(t.getModifierState)return t.getModifierState(e);var i=jo[e];return!!i&&!!t[i]}function Yo(e){return Wo}var Ko=Xo.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Yo,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)}}),Jo=Ko.extend({pointerId:null,width:null,height:null,pressure:null,tiltX:null,tiltY:null,pointerType:null,isPrimary:null}),Zo={mouseEnter:{registrationName:"onMouseEnter",dependencies:[Ct,wt]},mouseLeave:{registrationName:"onMouseLeave",dependencies:[Ct,wt]},pointerEnter:{registrationName:"onPointerEnter",dependencies:[It,Mt]},pointerLeave:{registrationName:"onPointerLeave",dependencies:[It,Mt]}},Qo={eventTypes:Zo,extractEvents:function(e,t,i,n){var o=e===wt||e===Mt,r=e===Ct||e===It;if(o&&(i.relatedTarget||i.fromElement))return null;if(!r&&!o)return null;var a=void 0;if(n.window===n)a=n;else{var s=n.ownerDocument;a=s?s.defaultView||s.parentWindow:window}var l=void 0,d=void 0;if(r){l=t;var c=i.relatedTarget||i.toElement;d=c?ae(c):null}else l=null,d=t;if(l===d)return null;var u=void 0,p=void 0,m=void 0,h=void 0;e===Ct||e===wt?(u=Ko,p=Zo.mouseLeave,m=Zo.mouseEnter,h="mouse"):e!==It&&e!==Mt||(u=Jo,p=Zo.pointerLeave,m=Zo.pointerEnter,h="pointer");var f=null==l?a:le(l),g=null==d?a:le(d),b=u.getPooled(p,l,i,n);b.type=h+"leave",b.target=f,b.relatedTarget=g;var v=u.getPooled(m,d,i,n);return v.type=h+"enter",v.target=g,v.relatedTarget=f,ze(b,v,l,d),[b,v]}};var er=function(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}},tr=Object.prototype.hasOwnProperty;function ir(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}var nr=function(e,t){if(ir(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(var o=0;o<i.length;o++)if(!tr.call(t,i[o])||!ir(e[i[o]],t[i[o]]))return!1;return!0};function or(e){return e._reactInternalFiber}var rr=0,ar=1,sr=2,lr=4,dr=6,cr=8,ur=16,pr=32,mr=64,hr=128,fr=256,gr=511,br=512,vr=1024,yr=1,xr=2,zr=3;function Cr(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if((t.effectTag&sr)!==rr)return yr;for(;t.return;)if(((t=t.return).effectTag&sr)!==rr)return yr}return t.tag===H?xr:zr}function wr(e){return Cr(e)===xr}function Er(e){Cr(e)!==xr&&i(!1,"Unable to find node on an unmounted component.")}function Pr(e){var t=e.alternate;if(!t){var n=Cr(e);return n===zr&&i(!1,"Unable to find node on an unmounted component."),n===yr?null:e}for(var o=e,r=t;;){var a=o.return,s=a?a.alternate:null;if(!a||!s)break;if(a.child===s.child){for(var l=a.child;l;){if(l===o)return Er(a),e;if(l===r)return Er(a),t;l=l.sibling}i(!1,"Unable to find node on an unmounted component.")}if(o.return!==r.return)o=a,r=s;else{for(var d=!1,c=a.child;c;){if(c===o){d=!0,o=a,r=s;break}if(c===r){d=!0,r=a,o=s;break}c=c.sibling}if(!d){for(c=s.child;c;){if(c===o){d=!0,o=s,r=a;break}if(c===r){d=!0,r=s,o=a;break}c=c.sibling}d||i(!1,"Child was not found in either parent set. This indicates a bug in React related to the return pointer. Please file an issue.")}}o.alternate!==r&&i(!1,"Return fibers should always be each others' alternates. This error is likely caused by a bug in React. Please file an issue.")}return o.tag!==H&&i(!1,"Unable to find node on an unmounted component."),o.stateNode.current===o?e:t}function _r(e){var t=Pr(e);if(!t)return null;for(var i=t;;){if(i.tag===j||i.tag===W)return i;if(i.child)i.child.return=i,i=i.child;else{if(i===t)return null;for(;!i.sibling;){if(!i.return||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}}return null}var Tr=yi.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Sr=yi.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rr=Xo.extend({relatedTarget:null});function kr(e){var t=void 0,i=e.keyCode;return"charCode"in e?0===(t=e.charCode)&&13===i&&(t=13):t=i,10===t&&(t=13),t>=32||13===t?t:0}var $r={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ir={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};var Mr=Xo.extend({key:function(e){if(e.key){var t=$r[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var i=kr(e);return 13===i?"Enter":String.fromCharCode(i)}if("keydown"===e.type||"keyup"===e.type)return Ir[e.keyCode]||"Unidentified";return""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Yo,charCode:function(e){return"keypress"===e.type?kr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?kr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Fr=Ko.extend({dataTransfer:null}),Dr=Xo.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Yo}),Nr=yi.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),Or=Ko.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),Ar=[[$e,"abort"],[Ie,"animationEnd"],[Me,"animationIteration"],[Fe,"animationStart"],[Ne,"canPlay"],[Oe,"canPlayThrough"],[Ye,"drag"],[Je,"dragEnter"],[Ze,"dragExit"],[Qe,"dragLeave"],[et,"dragOver"],[nt,"durationChange"],[ot,"emptied"],[rt,"encrypted"],[at,"ended"],[st,"error"],[dt,"gotPointerCapture"],[ft,"load"],[bt,"loadedData"],[vt,"loadedMetadata"],[gt,"loadStart"],[yt,"lostPointerCapture"],[zt,"mouseMove"],[Ct,"mouseOut"],[wt,"mouseOver"],[St,"playing"],[$t,"pointerMove"],[It,"pointerOut"],[Mt,"pointerOver"],[Dt,"progress"],[At,"scroll"],[Bt,"seeking"],[Ut,"stalled"],[qt,"suspend"],[Xt,"timeUpdate"],[jt,"toggle"],[Kt,"touchMove"],[Zt,"transitionEnd"],[ei,"waiting"],[ti,"wheel"]],Vr={},Br={};function Lr(e,t){var i=e[0],n=e[1],o=n[0].toUpperCase()+n.slice(1),r="on"+o,a={phasedRegistrationNames:{bubbled:r,captured:r+"Capture"},dependencies:[i],isInteractive:t};Vr[n]=a,Br[i]=a}[[De,"blur"],[Ae,"cancel"],[Be,"click"],[Le,"close"],[He,"contextMenu"],[Xe,"copy"],[je,"cut"],[We,"doubleClick"],[Ke,"dragEnd"],[tt,"dragStart"],[it,"drop"],[lt,"focus"],[ct,"input"],[ut,"invalid"],[pt,"keyDown"],[mt,"keyPress"],[ht,"keyUp"],[xt,"mouseDown"],[Et,"mouseUp"],[Pt,"paste"],[_t,"pause"],[Tt,"play"],[Rt,"pointerCancel"],[kt,"pointerDown"],[Ft,"pointerUp"],[Nt,"rateChange"],[Ot,"reset"],[Vt,"seeked"],[Gt,"submit"],[Wt,"touchCancel"],[Yt,"touchEnd"],[Jt,"touchStart"],[Qt,"volumeChange"]].forEach(function(e){Lr(e,!0)}),Ar.forEach(function(e){Lr(e,!1)});var Ur=[$e,Ae,Ne,Oe,Le,nt,ot,rt,at,st,ct,ut,ft,bt,vt,gt,_t,Tt,St,Dt,Nt,Ot,Vt,Bt,Ut,Gt,qt,Xt,jt,Qt,ei],Gr={eventTypes:Vr,isInteractiveTopLevelEventType:function(e){var t=Br[e];return void 0!==t&&!0===t.isInteractive},extractEvents:function(e,t,i,n){var o=Br[e];if(!o)return null;var r=void 0;switch(e){case mt:if(0===kr(i))return null;case pt:case ht:r=Mr;break;case De:case lt:r=Rr;break;case Be:if(2===i.button)return null;case We:case xt:case zt:case Et:case Ct:case wt:case He:r=Ko;break;case Ye:case Ke:case Je:case Ze:case Qe:case et:case tt:case it:r=Fr;break;case Wt:case Yt:case Kt:case Jt:r=Dr;break;case Ie:case Me:case Fe:r=Tr;break;case Zt:r=Nr;break;case At:r=Xo;break;case ti:r=Or;break;case Xe:case je:case Pt:r=Sr;break;case dt:case yt:case Rt:case kt:case $t:case It:case Mt:case Ft:r=Jo;break;default:-1===Ur.indexOf(e)&&E(!1,"SimpleEventPlugin: Unhandled event type, `%s`. This warning is likely caused by a bug in React. Please file an issue.",e),r=yi}var a=r.getPooled(o,t,i,n);return xe(a),a}},qr=Gr.isInteractiveTopLevelEventType,Hr=10,Xr=[];function jr(e){for(;e.return;)e=e.return;return e.tag!==H?null:e.stateNode.containerInfo}function Wr(e){var t=e.targetInst,i=t;do{if(!i){e.ancestors.push(i);break}var n=jr(i);if(!n)break;e.ancestors.push(i),i=ae(n)}while(i);for(var o=0;o<e.ancestors.length;o++)t=e.ancestors[o],B(e.topLevelType,t,e.nativeEvent,ln(e.nativeEvent))}var Yr=!0;function Kr(e){Yr=!!e}function Jr(){return Yr}function Zr(e,t){if(!t)return null;var i,n,o,r=qr(e)?ea:ta;i=t,n=ni(e),o=r.bind(null,e),i.addEventListener(n,o,!1)}function Qr(e,t){if(!t)return null;var i,n,o,r=qr(e)?ea:ta;i=t,n=ni(e),o=r.bind(null,e),i.addEventListener(n,o,!0)}function ea(e,t){Yi(ta,e,t)}function ta(e,t){if(Yr){var i=ln(t),n=ae(i);null===n||"number"!=typeof n.tag||wr(n)||(n=null);var o,r=function(e,t,i){if(Xr.length){var n=Xr.pop();return n.topLevelType=e,n.nativeEvent=t,n.targetInst=i,n}return{topLevelType:e,nativeEvent:t,targetInst:i,ancestors:[]}}(e,t,n);try{Zi(Wr,r)}finally{(o=r).topLevelType=null,o.nativeEvent=null,o.targetInst=null,o.ancestors.length=0,Xr.length<Hr&&Xr.push(o)}}}var ia=Object.freeze({get _enabled(){return Yr},setEnabled:Kr,isEnabled:Jr,trapBubbledEvent:Zr,trapCapturedEvent:Qr,dispatchEvent:ta}),na={},oa=0,ra="_reactListenersID"+(""+Math.random()).slice(2);function aa(e){return Object.prototype.hasOwnProperty.call(e,ra)||(e[ra]=oa++,na[e[ra]]={}),na[e[ra]]}var sa=function(e){var t=(e?e.ownerDocument||e:document).defaultView||window;return!(!e||!("function"==typeof t.Node?e instanceof t.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))};var la=function(e){return sa(e)&&3==e.nodeType};var da=function e(t,i){return!(!t||!i)&&(t===i||!la(t)&&(la(i)?e(t,i.parentNode):"contains"in t?t.contains(i):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(i))))};function ca(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ua(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function pa(e,t){for(var i=ca(e),n=0,o=0;i;){if(i.nodeType===on){if(o=n+i.textContent.length,n<=t&&o>=t)return{node:i,offset:t-n};n=o}i=ca(ua(i))}}function ma(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var i=t.anchorNode,n=t.anchorOffset,o=t.focusNode,r=t.focusOffset;try{i.nodeType,o.nodeType}catch(e){return null}return function(e,t,i,n,o){var r=0,a=-1,s=-1,l=0,d=0,c=e,u=null;e:for(;;){for(var p=null;c!==t||0!==i&&c.nodeType!==on||(a=r+i),c!==n||0!==o&&c.nodeType!==on||(s=r+o),c.nodeType===on&&(r+=c.nodeValue.length),null!==(p=c.firstChild);)u=c,c=p;for(;;){if(c===e)break e;if(u===t&&++l===i&&(a=r),u===n&&++d===o&&(s=r),null!==(p=c.nextSibling))break;u=(c=u).parentNode}c=p}if(-1===a||-1===s)return null;return{start:a,end:s}}(e,i,n,o,r)}function ha(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fa(){var e=er();return{focusedElem:e,selectionRange:ha(e)?function(e){var t=void 0;t="selectionStart"in e?{start:e.selectionStart,end:e.selectionEnd}:ma(e);return t||{start:0,end:0}}(e):null}}function ga(e){var t,i=er(),n=e.focusedElem,o=e.selectionRange;if(i!==n&&(t=n,da(document.documentElement,t))){null!==o&&ha(n)&&function(e,t){var i=t.start,n=t.end;void 0===n&&(n=i);"selectionStart"in e?(e.selectionStart=i,e.selectionEnd=Math.min(n,e.value.length)):function(e,t){if(!window.getSelection)return;var i=window.getSelection(),n=e[ri()].length,o=Math.min(t.start,n),r=void 0===t.end?o:Math.min(t.end,n);if(!i.extend&&o>r){var a=r;r=o,o=a}var s=pa(e,o),l=pa(e,r);if(s&&l){if(1===i.rangeCount&&i.anchorNode===s.node&&i.anchorOffset===s.offset&&i.focusNode===l.node&&i.focusOffset===l.offset)return;var d=document.createRange();d.setStart(s.node,s.offset),i.removeAllRanges(),o>r?(i.addRange(d),i.extend(l.node,l.offset)):(d.setEnd(l.node,l.offset),i.addRange(d))}}(e,t)}(n,o);for(var r=[],a=n;a=a.parentNode;)a.nodeType===nn&&r.push({element:a,left:a.scrollLeft,top:a.scrollTop});"function"==typeof n.focus&&n.focus();for(var s=0;s<r.length;s++){var l=r[s];l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}}var ba=Ee.canUseDOM&&"documentMode"in document&&document.documentMode<=11,va={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:[De,He,lt,pt,ht,xt,Et,Lt]}},ya=null,xa=null,za=null,Ca=!1;function wa(e,t){if(Ca||null==ya||ya!==er())return null;var i=function(e){{if("selectionStart"in e&&ha(e))return{start:e.selectionStart,end:e.selectionEnd};if(window.getSelection){var t=window.getSelection();return{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}}}}(ya);if(!za||!nr(za,i)){za=i;var n=yi.getPooled(va.select,xa,e,t);return n.type="select",n.target=ya,xe(n),n}return null}var Ea={eventTypes:va,extractEvents:function(e,t,i,n){var o=n.window===n?n.document:n.nodeType===an?n:n.ownerDocument;if(!o||!function(e,t){for(var i=aa(t),n=g[e],o=0;o<n.length;o++){var r=n[o];if(!i.hasOwnProperty(r)||!i[r])return!1}return!0}("onSelect",o))return null;var r=t?le(t):window;switch(e){case lt:(tn(r)||"true"===r.contentEditable)&&(ya=r,xa=t,za=null);break;case De:ya=null,xa=null,za=null;break;case xt:Ca=!0;break;case He:case Et:return Ca=!1,wa(i,n);case Lt:if(ba)break;case pt:case ht:return wa(i,n)}return null}};O.injectEventPluginOrder(["ResponderEventPlugin","SimpleEventPlugin","TapEventPlugin","EnterLeaveEventPlugin","ChangeEventPlugin","SelectEventPlugin","BeforeInputEventPlugin"]),S.injectComponentTree(ue),O.injectEventPluginsByName({SimpleEventPlugin:Gr,EnterLeaveEventPlugin:Qo,ChangeEventPlugin:Ho,SelectEventPlugin:Ea,BeforeInputEventPlugin:Ai});var Pa={};Object.freeze(Pa);var _a=Pa,Ta="function"==typeof requestAnimationFrame?requestAnimationFrame:void 0,Sa=Date,Ra=setTimeout,ka=clearTimeout,$a="object"==typeof performance&&"function"==typeof performance.now,Ia=void 0;if($a){var Ma=performance;Ia=function(){return Ma.now()}}else Ia=function(){return Sa.now()};var Fa=void 0,Da=void 0;if(Ee.canUseDOM){"function"!=typeof Ta&&E(!1,"React depends on requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills");var Na="function"==typeof Ta?Ta:function(e){i(!1,"React depends on requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")},Oa=null,Aa=null,Va=-1,Ba=!1,La=!1,Ua=0,Ga=33,qa=33,Ha={didTimeout:!1,timeRemaining:function(){var e=Ua-Ia();return e>0?e:0}},Xa=function(e,t){var i=e.scheduledCallback,n=!1;try{i(t),n=!0}finally{Da(e),n||(Ba=!0,window.postMessage(ja,"*"))}},ja="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(e){if(e.source!==window||e.data!==ja)return;if(Ba=!1,null===Oa)return;!function(){if(null===Oa)return;var e=Ia();if(-1===Va||Va>e)return;var t=-1,i=[],n=Oa;for(;null!==n;){var o=n.timeoutTime;-1!==o&&o<=e?i.push(n):-1!==o&&(-1===t||o<t)&&(t=o),n=n.next}if(i.length>0){Ha.didTimeout=!0;for(var r=0,a=i.length;r<a;r++)Xa(i[r],Ha)}Va=t}();var t=Ia();for(;Ua-t>0&&null!==Oa;){var i=Oa;Ha.didTimeout=!1,Xa(i,Ha),t=Ia()}null!==Oa&&(La||(La=!0,Na(Wa)))},!1);var Wa=function(e){La=!1;var t=e-Ua+qa;t<qa&&Ga<qa?(t<8&&(t=8),qa=t<Ga?Ga:t):Ga=t,Ua=e+qa,Ba||(Ba=!0,window.postMessage(ja,"*"))};Fa=function(e,t){var i=-1;null!=t&&"number"==typeof t.timeout&&(i=Ia()+t.timeout),(-1===Va||-1!==i&&i<Va)&&(Va=i);var n={scheduledCallback:e,timeoutTime:i,prev:null,next:null};if(null===Oa)Oa=n,Aa=n;else{n.prev=Aa;var o=Aa;null!==o&&(o.next=n),Aa=n}return La||(La=!0,Na(Wa)),n},Da=function(e){if(null!==e.prev||Oa===e){var t=e.next,i=e.prev;return e.next=null,e.prev=null,null!==t?null!==i?(i.next=t,void(t.prev=i)):(t.prev=null,void(Oa=t)):null!==i?(i.next=null,void(Aa=i)):(Oa=null,void(Aa=null))}}}else{var Ya=new Map;Fa=function(e,t){var i={scheduledCallback:e,timeoutTime:0,next:null,prev:null},n=Ra(function(){e({timeRemaining:function(){return 1/0},didTimeout:!1})});return Ya.set(e,n),i},Da=function(e){var t=e.scheduledCallback,i=Ya.get(t);Ya.delete(e),ka(i)}}var Ka=!1;function Ja(e,t){null==t.selected||Ka||(E(!1,"Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>."),Ka=!0)}function Za(t,i){var n,o,r=di({children:void 0},i),a=(n=i.children,o="",e.Children.forEach(n,function(e){null!=e&&("string"!=typeof e&&"number"!=typeof e||(o+=e))}),o);return a&&(r.children=a),r}var Qa=Nn.getCurrentFiberOwnerName,es=Nn.getCurrentFiberStackAddendum,ts=void 0;function is(){var e=Qa();return e?"\n\nCheck the render method of `"+e+"`.":""}ts=!1;var ns=["value","defaultValue"];function os(e,t,i,n){var o=e.options;if(t){for(var r=i,a={},s=0;s<r.length;s++)a["$"+r[s]]=!0;for(var l=0;l<o.length;l++){var d=a.hasOwnProperty("$"+o[l].value);o[l].selected!==d&&(o[l].selected=d),d&&n&&(o[l].defaultSelected=!0)}}else{for(var c=""+i,u=null,p=0;p<o.length;p++){if(o[p].value===c)return o[p].selected=!0,void(n&&(o[p].defaultSelected=!0));null!==u||o[p].disabled||(u=o[p])}null!==u&&(u.selected=!0)}}function rs(e,t){return di({},t,{value:void 0})}function as(e,t){var i=e;!function(e){mo.checkPropTypes("select",e,es);for(var t=0;t<ns.length;t++){var i=ns[t];if(null!=e[i]){var n=Array.isArray(e[i]);e.multiple&&!n?E(!1,"The `%s` prop supplied to <select> must be an array if `multiple` is true.%s",i,is()):!e.multiple&&n&&E(!1,"The `%s` prop supplied to <select> must be a scalar value if `multiple` is false.%s",i,is())}}}(t);var n=t.value;i._wrapperState={initialValue:null!=n?n:t.defaultValue,wasMultiple:!!t.multiple},void 0===t.value||void 0===t.defaultValue||ts||(E(!1,"Select elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled select element and remove one of these props. More info: https://fb.me/react-controlled-components"),ts=!0)}var ss=Nn.getCurrentFiberStackAddendum,ls=!1;function ds(e,t){var n=e;null!=t.dangerouslySetInnerHTML&&i(!1,"`dangerouslySetInnerHTML` does not make sense on <textarea>.");var o=di({},t,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue});return o}function cs(e,t){var n=e;mo.checkPropTypes("textarea",t,ss),void 0===t.value||void 0===t.defaultValue||ls||(E(!1,"Textarea elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled textarea and remove one of these props. More info: https://fb.me/react-controlled-components"),ls=!0);var o=t.value;if(null==o){var r=t.defaultValue,a=t.children;null!=a&&(E(!1,"Use the `defaultValue` or `value` props instead of setting children on <textarea>."),null!=r&&i(!1,"If you supply `defaultValue` on a <textarea>, do not pass children."),Array.isArray(a)&&(a.length<=1||i(!1,"<textarea> can only have at most one child."),a=a[0]),r=""+a),null==r&&(r=""),o=r}n._wrapperState={initialValue:""+o}}function us(e,t){var i=e,n=t.value;if(null!=n){var o=""+n;o!==i.value&&(i.value=o),null==t.defaultValue&&(i.defaultValue=o)}null!=t.defaultValue&&(i.defaultValue=t.defaultValue)}function ps(e,t){var i=e,n=i.textContent;n===i._wrapperState.initialValue&&(i.value=n)}var ms="http://www.w3.org/1999/xhtml",hs="http://www.w3.org/1998/Math/MathML",fs="http://www.w3.org/2000/svg",gs={html:ms,mathml:hs,svg:fs};function bs(e){switch(e){case"svg":return fs;case"math":return hs;default:return ms}}function vs(e,t){return null==e||e===ms?bs(t):e===fs&&"foreignObject"===t?ms:e}var ys=void 0,xs=(ws=function(e,t){if(e.namespaceURI!==gs.svg||"innerHTML"in e)e.innerHTML=t;else{(ys=ys||document.createElement("div")).innerHTML="<svg>"+t+"</svg>";for(var i=ys.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction(function(){return ws(e,t,i,n)})}:ws),zs=function(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===on)return void(i.nodeValue=t)}e.textContent=t},Cs={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var ws;var Es=["Webkit","ms","Moz","O"];function Ps(e,t,i){var n=null==t||"boolean"==typeof t||""===t;return n?"":i||"number"!=typeof t||0===t||Cs.hasOwnProperty(e)&&Cs[e]?(""+t).trim():t+"px"}Object.keys(Cs).forEach(function(e){Es.forEach(function(t){var i,n;Cs[(i=t,n=e,i+n.charAt(0).toUpperCase()+n.substring(1))]=Cs[e]})});var _s=/([A-Z])/g;var Ts=function(e){return e.replace(_s,"-$1").toLowerCase()},Ss=/^ms-/;var Rs=function(e){return Ts(e).replace(Ss,"-ms-")},ks=/-(.)/g;var $s=function(e){return e.replace(ks,function(e,t){return t.toUpperCase()})},Is=/^-ms-/;var Ms=function(e){return $s(e.replace(Is,"ms-"))},Fs=/^(?:webkit|moz|o)[A-Z]/,Ds=/;\s*$/,Ns={},Os={},As=!1,Vs=!1,Bs=function(e,t,i){e.indexOf("-")>-1?function(e,t){if(Ns.hasOwnProperty(e)&&Ns[e])return;Ns[e]=!0,E(!1,"Unsupported style property %s. Did you mean %s?%s",e,Ms(e),t())}(e,i):Fs.test(e)?function(e,t){if(Ns.hasOwnProperty(e)&&Ns[e])return;Ns[e]=!0,E(!1,"Unsupported vendor-prefixed style property %s. Did you mean %s?%s",e,e.charAt(0).toUpperCase()+e.slice(1),t())}(e,i):Ds.test(t)&&function(e,t,i){if(Os.hasOwnProperty(t)&&Os[t])return;Os[t]=!0,E(!1,'Style property values shouldn\'t contain a semicolon. Try "%s: %s" instead.%s',e,t.replace(Ds,""),i())}(e,t,i),"number"==typeof t&&(isNaN(t)?function(e,t,i){if(As)return;As=!0,E(!1,"`NaN` is an invalid value for the `%s` css style property.%s",e,i())}(e,0,i):isFinite(t)||function(e,t,i){if(Vs)return;Vs=!0,E(!1,"`Infinity` is an invalid value for the `%s` css style property.%s",e,i())}(e,0,i))};function Ls(e){var t="",i="";for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];if(null!=o){var r=0===n.indexOf("--");t+=i+Rs(n)+":",t+=Ps(n,o,r),i=";"}}return t||null}function Us(e,t,i){var n=e.style;for(var o in t)if(t.hasOwnProperty(o)){var r=0===o.indexOf("--");r||Bs(o,t[o],i);var a=Ps(o,t[o],r);"float"===o&&(o="cssFloat"),r?n.setProperty(o,a):n[o]=a}}var Gs=di({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),qs="__html";function Hs(e,t,n){t&&(Gs[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML)&&i(!1,"%s is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.%s",e,n()),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&i(!1,"Can only set one of `children` or `props.dangerouslySetInnerHTML`."),"object"==typeof t.dangerouslySetInnerHTML&&qs in t.dangerouslySetInnerHTML||i(!1,"`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://fb.me/react-invariant-dangerously-set-inner-html for more information.")),!t.suppressContentEditableWarning&&t.contentEditable&&null!=t.children&&E(!1,"A component is `contentEditable` and contains `children` managed by React. It is now your responsibility to guarantee that none of those nodes are unexpectedly modified or duplicated. This is probably not intentional.%s",n()),null!=t.style&&"object"!=typeof t.style&&i(!1,"The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.%s",n()))}function Xs(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var js={accept:"accept",acceptcharset:"acceptCharset","accept-charset":"acceptCharset",accesskey:"accessKey",action:"action",allowfullscreen:"allowFullScreen",alt:"alt",as:"as",async:"async",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",capture:"capture",cellpadding:"cellPadding",cellspacing:"cellSpacing",challenge:"challenge",charset:"charSet",checked:"checked",children:"children",cite:"cite",class:"className",classid:"classID",classname:"className",cols:"cols",colspan:"colSpan",content:"content",contenteditable:"contentEditable",contextmenu:"contextMenu",controls:"controls",controlslist:"controlsList",coords:"coords",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",data:"data",datetime:"dateTime",default:"default",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",defer:"defer",dir:"dir",disabled:"disabled",download:"download",draggable:"draggable",enctype:"encType",for:"htmlFor",form:"form",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",headers:"headers",height:"height",hidden:"hidden",high:"high",href:"href",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",id:"id",innerhtml:"innerHTML",inputmode:"inputMode",integrity:"integrity",is:"is",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParams",keytype:"keyType",kind:"kind",label:"label",lang:"lang",list:"list",loop:"loop",low:"low",manifest:"manifest",marginwidth:"marginWidth",marginheight:"marginHeight",max:"max",maxlength:"maxLength",media:"media",mediagroup:"mediaGroup",method:"method",min:"min",minlength:"minLength",multiple:"multiple",muted:"muted",name:"name",nomodule:"noModule",nonce:"nonce",novalidate:"noValidate",open:"open",optimum:"optimum",pattern:"pattern",placeholder:"placeholder",playsinline:"playsInline",poster:"poster",preload:"preload",profile:"profile",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rel:"rel",required:"required",reversed:"reversed",role:"role",rows:"rows",rowspan:"rowSpan",sandbox:"sandbox",scope:"scope",scoped:"scoped",scrolling:"scrolling",seamless:"seamless",selected:"selected",shape:"shape",size:"size",sizes:"sizes",span:"span",spellcheck:"spellCheck",src:"src",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",start:"start",step:"step",style:"style",summary:"summary",tabindex:"tabIndex",target:"target",title:"title",type:"type",usemap:"useMap",value:"value",width:"width",wmode:"wmode",wrap:"wrap",about:"about",accentheight:"accentHeight","accent-height":"accentHeight",accumulate:"accumulate",additive:"additive",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",alphabetic:"alphabetic",amplitude:"amplitude",arabicform:"arabicForm","arabic-form":"arabicForm",ascent:"ascent",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",azimuth:"azimuth",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",bbox:"bbox",begin:"begin",bias:"bias",by:"by",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clip:"clip",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",color:"color",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",cursor:"cursor",cx:"cx",cy:"cy",d:"d",datatype:"datatype",decelerate:"decelerate",descent:"descent",diffuseconstant:"diffuseConstant",direction:"direction",display:"display",divisor:"divisor",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",dur:"dur",dx:"dx",dy:"dy",edgemode:"edgeMode",elevation:"elevation",enablebackground:"enableBackground","enable-background":"enableBackground",end:"end",exponent:"exponent",externalresourcesrequired:"externalResourcesRequired",fill:"fill",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filter:"filter",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",focusable:"focusable",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",format:"format",from:"from",fx:"fx",fy:"fy",g1:"g1",g2:"g2",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",hanging:"hanging",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",ideographic:"ideographic",imagerendering:"imageRendering","image-rendering":"imageRendering",in2:"in2",in:"in",inlist:"inlist",intercept:"intercept",k1:"k1",k2:"k2",k3:"k3",k4:"k4",k:"k",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",kerning:"kerning",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",local:"local",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",mask:"mask",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",mathematical:"mathematical",mode:"mode",numoctaves:"numOctaves",offset:"offset",opacity:"opacity",operator:"operator",order:"order",orient:"orient",orientation:"orientation",origin:"origin",overflow:"overflow",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder",panose1:"panose1","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",points:"points",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",prefix:"prefix",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",property:"property",r:"r",radius:"radius",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",resource:"resource",restart:"restart",result:"result",results:"results",rotate:"rotate",rx:"rx",ry:"ry",scale:"scale",security:"security",seed:"seed",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",slope:"slope",spacing:"spacing",specularconstant:"specularConstant",specularexponent:"specularExponent",speed:"speed",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stemh:"stemh",stemv:"stemv",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",string:"string",stroke:"stroke",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",to:"to",transform:"transform",typeof:"typeof",u1:"u1",u2:"u2",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicode:"unicode",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",values:"values",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",version:"version",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",visibility:"visibility",vmathematical:"vMathematical","v-mathematical":"vMathematical",vocab:"vocab",widths:"widths",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",x1:"x1",x2:"x2",x:"x",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang",xmlns:"xmlns","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",y1:"y1",y2:"y2",y:"y",ychannelselector:"yChannelSelector",z:"z",zoomandpan:"zoomAndPan"},Ws={"aria-current":0,"aria-details":0,"aria-disabled":0,"aria-hidden":0,"aria-invalid":0,"aria-keyshortcuts":0,"aria-label":0,"aria-roledescription":0,"aria-autocomplete":0,"aria-checked":0,"aria-expanded":0,"aria-haspopup":0,"aria-level":0,"aria-modal":0,"aria-multiline":0,"aria-multiselectable":0,"aria-orientation":0,"aria-placeholder":0,"aria-pressed":0,"aria-readonly":0,"aria-required":0,"aria-selected":0,"aria-sort":0,"aria-valuemax":0,"aria-valuemin":0,"aria-valuenow":0,"aria-valuetext":0,"aria-atomic":0,"aria-busy":0,"aria-live":0,"aria-relevant":0,"aria-dropeffect":0,"aria-grabbed":0,"aria-activedescendant":0,"aria-colcount":0,"aria-colindex":0,"aria-colspan":0,"aria-controls":0,"aria-describedby":0,"aria-errormessage":0,"aria-flowto":0,"aria-labelledby":0,"aria-owns":0,"aria-posinset":0,"aria-rowcount":0,"aria-rowindex":0,"aria-rowspan":0,"aria-setsize":0},Ys={},Ks=new RegExp("^(aria)-["+qn+"]*$"),Js=new RegExp("^(aria)[A-Z]["+qn+"]*$"),Zs=Object.prototype.hasOwnProperty;function Qs(){var e=gn.getStackAddendum();return null!=e?e:""}function el(e,t){if(Zs.call(Ys,t)&&Ys[t])return!0;if(Js.test(t)){var i="aria-"+t.slice(4).toLowerCase(),n=Ws.hasOwnProperty(i)?i:null;if(null==n)return E(!1,"Invalid ARIA attribute `%s`. ARIA attributes follow the pattern aria-* and must be lowercase.%s",t,Qs()),Ys[t]=!0,!0;if(t!==n)return E(!1,"Invalid ARIA attribute `%s`. Did you mean `%s`?%s",t,n,Qs()),Ys[t]=!0,!0}if(Ks.test(t)){var o=t.toLowerCase(),r=Ws.hasOwnProperty(o)?o:null;if(null==r)return Ys[t]=!0,!1;if(t!==r)return E(!1,"Unknown ARIA attribute `%s`. Did you mean `%s`?%s",t,r,Qs()),Ys[t]=!0,!0}return!0}function tl(e,t){Xs(e,t)||function(e,t){var i=[];for(var n in t){var o=el(e,n);o||i.push(n)}var r=i.map(function(e){return"`"+e+"`"}).join(", ");1===i.length?E(!1,"Invalid aria prop %s on <%s> tag. For details, see https://fb.me/invalid-aria-prop%s",r,e,Qs()):i.length>1&&E(!1,"Invalid aria props %s on <%s> tag. For details, see https://fb.me/invalid-aria-prop%s",r,e,Qs())}(e,t)}var il=!1;function nl(){var e=gn.getStackAddendum();return null!=e?e:""}function ol(){var e=gn.getStackAddendum();return null!=e?e:""}var rl=function(){},al={},sl=Object.prototype.hasOwnProperty,ll=/^on./,dl=/^on[^A-Z]/,cl=new RegExp("^(aria)-["+qn+"]*$"),ul=new RegExp("^(aria)[A-Z]["+qn+"]*$");rl=function(e,t,i,n){if(sl.call(al,t)&&al[t])return!0;var o=t.toLowerCase();if("onfocusin"===o||"onfocusout"===o)return E(!1,"React uses onFocus and onBlur instead of onFocusIn and onFocusOut. All React events are normalized to bubble, so onFocusIn and onFocusOut are not needed/supported by React."),al[t]=!0,!0;if(n){if(f.hasOwnProperty(t))return!0;var r=b.hasOwnProperty(o)?b[o]:null;if(null!=r)return E(!1,"Invalid event handler property `%s`. Did you mean `%s`?%s",t,r,ol()),al[t]=!0,!0;if(ll.test(t))return E(!1,"Unknown event handler property `%s`. It will be ignored.%s",t,ol()),al[t]=!0,!0}else if(ll.test(t))return dl.test(t)&&E(!1,"Invalid event handler property `%s`. React events use the camelCase naming convention, for example `onClick`.%s",t,ol()),al[t]=!0,!0;if(cl.test(t)||ul.test(t))return!0;if("innerhtml"===o)return E(!1,"Directly setting property `innerHTML` is not permitted. For more information, lookup documentation on `dangerouslySetInnerHTML`."),al[t]=!0,!0;if("aria"===o)return E(!1,"The `aria` attribute is reserved for future use in React. Pass individual `aria-` attributes instead."),al[t]=!0,!0;if("is"===o&&null!=i&&"string"!=typeof i)return E(!1,"Received a `%s` for a string attribute `is`. If this is expected, cast the value to a string.%s",typeof i,ol()),al[t]=!0,!0;if("number"==typeof i&&isNaN(i))return E(!1,"Received NaN for the `%s` attribute. If this is expected, cast the value to a string.%s",t,ol()),al[t]=!0,!0;var a=Qn(t),s=null!==a&&a.type===On;if(js.hasOwnProperty(o)){var l=js[o];if(l!==t)return E(!1,"Invalid DOM property `%s`. Did you mean `%s`?%s",t,l,ol()),al[t]=!0,!0}else if(!s&&t!==o)return E(!1,"React does not recognize the `%s` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `%s` instead. If you accidentally passed it from a parent component, remove it from the DOM element.%s",t,o,ol()),al[t]=!0,!0;return"boolean"==typeof i&&Jn(t,i,a,!1)?(i?E(!1,'Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.%s',i,t,t,i,t,ol()):E(!1,'Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.%s',i,t,t,i,t,t,t,ol()),al[t]=!0,!0):!!s||(!Jn(t,i,a,!1)||(al[t]=!0,!1))};var pl=function(e,t,i){var n=[];for(var o in t){var r=rl(e,o,t[o],i);r||n.push(o)}var a=n.map(function(e){return"`"+e+"`"}).join(", ");1===n.length?E(!1,"Invalid value for prop %s on <%s> tag. Either remove it from the element, or pass a string or number value to keep it in the DOM. For details, see https://fb.me/react-attribute-behavior%s",a,e,ol()):n.length>1&&E(!1,"Invalid values for props %s on <%s> tag. Either remove them from the element, or pass a string or number value to keep them in the DOM. For details, see https://fb.me/react-attribute-behavior%s",a,e,ol())};var ml=Nn.getCurrentFiberOwnerName,hl=Nn.getCurrentFiberStackAddendum,fl=!1,gl=!1,bl="dangerouslySetInnerHTML",vl="suppressContentEditableWarning",yl="suppressHydrationWarning",xl="autoFocus",zl="children",Cl="style",wl="__html",El=gs.html,Pl=w.thatReturns(""),_l=void 0,Tl=void 0,Sl=void 0,Rl=void 0,kl=void 0,$l=void 0,Il=void 0,Ml=void 0,Fl=void 0;Pl=hl,_l={time:!0,dialog:!0},Sl=function(e,t){tl(e,t),function(e,t){if("input"!==e&&"textarea"!==e&&"select"!==e)return;null==t||null!==t.value||il||(il=!0,"select"===e&&t.multiple?E(!1,"`value` prop on `%s` should not be null. Consider using an empty array when `multiple` is set to `true` to clear the component or `undefined` for uncontrolled components.%s",e,nl()):E(!1,"`value` prop on `%s` should not be null. Consider using an empty string to clear the component or `undefined` for uncontrolled components.%s",e,nl()))}(e,t),function(e,t,i){if(Xs(e,t))return;pl(e,t,i)}(e,t,!0)};var Dl=/\r\n?/g,Nl=/\u0000|\uFFFD/g;function Ol(e,t){var i=e.nodeType===an||e.nodeType===sn,n=i?e:e.ownerDocument;!function(e,t){for(var i=aa(t),n=g[e],o=0;o<n.length;o++){var r=n[o];if(!i.hasOwnProperty(r)||!i[r]){switch(r){case At:Qr(At,t);break;case lt:case De:Qr(lt,t),Qr(De,t),i[De]=!0,i[lt]=!0;break;case Ae:case Le:dn(ni(r),!0)&&Qr(r,t);break;case ut:case Gt:case Ot:break;default:var a=-1!==ii.indexOf(r);a||Zr(r,t)}i[r]=!0}}}(t,n)}function Al(e){return e.nodeType===an?e:e.ownerDocument}function Vl(e){e.onclick=w}function Bl(e,t,i,n){var o=void 0,r=Al(i),a=void 0,s=n;if(s===El&&(s=bs(e)),s===El)if((o=Xs(e,t))||e===e.toLowerCase()||E(!1,"<%s /> is using incorrect casing. Use PascalCase for React components, or lowercase for HTML elements.",e),"script"===e){var l=r.createElement("div");l.innerHTML="<script><\/script>";var d=l.firstChild;a=l.removeChild(d)}else a="string"==typeof t.is?r.createElement(e,{is:t.is}):r.createElement(e);else a=r.createElementNS(s,e);return s===El&&(o||"[object HTMLUnknownElement]"!==Object.prototype.toString.call(a)||Object.prototype.hasOwnProperty.call(_l,e)||(_l[e]=!0,E(!1,"The tag <%s> is unrecognized in this browser. If you meant to render a React component, start its name with an uppercase letter.",e))),a}function Ll(e,t){return Al(t).createTextNode(e)}function Ul(e,t,i,n){var o=Xs(t,i);Sl(t,i),o&&!gl&&e.shadyRoot&&(E(!1,"%s is using shady DOM. Using shady DOM with React can cause things to break subtly.",ml()||"A component"),gl=!0);var r,a,s=void 0;switch(t){case"iframe":case"object":Zr(ft,e),s=i;break;case"video":case"audio":for(var l=0;l<ii.length;l++)Zr(ii[l],e);s=i;break;case"source":Zr(st,e),s=i;break;case"img":case"image":case"link":Zr(st,e),Zr(ft,e),s=i;break;case"form":Zr(Ot,e),Zr(Gt,e),s=i;break;case"details":Zr(jt,e),s=i;break;case"input":Eo(e,i),s=wo(e,i),Zr(ut,e),Ol(n,"onChange");break;case"option":Ja(e,i),s=Za(e,i);break;case"select":as(e,i),s=rs(e,i),Zr(ut,e),Ol(n,"onChange");break;case"textarea":cs(e,i),s=ds(e,i),Zr(ut,e),Ol(n,"onChange");break;default:s=i}switch(Hs(t,s,Pl),function(e,t,i,n,o){for(var r in n)if(n.hasOwnProperty(r)){var a=n[r];if(r===Cl)a&&Object.freeze(a),Us(t,a,Pl);else if(r===bl){var s=a?a[wl]:void 0;null!=s&&xs(t,s)}else if(r===zl)if("string"==typeof a){var l="textarea"!==e||""!==a;l&&zs(t,a)}else"number"==typeof a&&zs(t,""+a);else r===vl||r===yl||r===xl||(f.hasOwnProperty(r)?null!=a&&("function"!=typeof a&&Il(r,a),Ol(i,r)):null!=a&&ao(t,r,a,o))}}(t,e,n,s,o),t){case"input":pn(e),To(e,i,!1);break;case"textarea":pn(e),ps(e,i);break;case"option":r=e,null!=(a=i).value&&r.setAttribute("value",a.value);break;case"select":!function(e,t){var i=e;i.multiple=!!t.multiple;var n=t.value;null!=n?os(i,!!t.multiple,n,!1):null!=t.defaultValue&&os(i,!!t.multiple,t.defaultValue,!0)}(e,i);break;default:"function"==typeof s.onClick&&Vl(e)}}function Gl(e,t,i,n,o){Sl(t,n);var r=null,a=void 0,s=void 0;switch(t){case"input":a=wo(e,i),s=wo(e,n),r=[];break;case"option":a=Za(e,i),s=Za(e,n),r=[];break;case"select":a=rs(e,i),s=rs(e,n),r=[];break;case"textarea":a=ds(e,i),s=ds(e,n),r=[];break;default:s=n,"function"!=typeof(a=i).onClick&&"function"==typeof s.onClick&&Vl(e)}Hs(t,s,Pl);var l=void 0,d=void 0,c=null;for(l in a)if(!s.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if(l===Cl){var u=a[l];for(d in u)u.hasOwnProperty(d)&&(c||(c={}),c[d]="")}else l===bl||l===zl||l===vl||l===yl||l===xl||(f.hasOwnProperty(l)?r||(r=[]):(r=r||[]).push(l,null));for(l in s){var p=s[l],m=null!=a?a[l]:void 0;if(s.hasOwnProperty(l)&&p!==m&&(null!=p||null!=m))if(l===Cl)if(p&&Object.freeze(p),m){for(d in m)!m.hasOwnProperty(d)||p&&p.hasOwnProperty(d)||(c||(c={}),c[d]="");for(d in p)p.hasOwnProperty(d)&&m[d]!==p[d]&&(c||(c={}),c[d]=p[d])}else c||(r||(r=[]),r.push(l,c)),c=p;else if(l===bl){var h=p?p[wl]:void 0,g=m?m[wl]:void 0;null!=h&&g!==h&&(r=r||[]).push(l,""+h)}else l===zl?m===p||"string"!=typeof p&&"number"!=typeof p||(r=r||[]).push(l,""+p):l===vl||l===yl||(f.hasOwnProperty(l)?(null!=p&&("function"!=typeof p&&Il(l,p),Ol(o,l)),r||m===p||(r=[])):(r=r||[]).push(l,p))}return c&&(r=r||[]).push(Cl,c),r}function ql(e,t,i,n,o){"input"===i&&"radio"===o.type&&null!=o.name&&Po(e,o);Xs(i,n);var r=Xs(i,o);switch(function(e,t,i,n){for(var o=0;o<t.length;o+=2){var r=t[o],a=t[o+1];r===Cl?Us(e,a,Pl):r===bl?xs(e,a):r===zl?zs(e,a):ao(e,r,a,n)}}(e,t,0,r),i){case"input":_o(e,o);break;case"textarea":us(e,o);break;case"select":!function(e,t){var i=e;i._wrapperState.initialValue=void 0;var n=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!t.multiple;var o=t.value;null!=o?os(i,!!t.multiple,o,!1):n!==!!t.multiple&&(null!=t.defaultValue?os(i,!!t.multiple,t.defaultValue,!0):os(i,!!t.multiple,t.multiple?[]:"",!1))}(e,o)}}function Hl(e){var t=e.toLowerCase();return js.hasOwnProperty(t)&&js[t]||null}function Xl(e,t,i,n,o){var r=void 0,a=void 0;switch(Tl=!0===i[yl],r=Xs(t,i),Sl(t,i),r&&!gl&&e.shadyRoot&&(E(!1,"%s is using shady DOM. Using shady DOM with React can cause things to break subtly.",ml()||"A component"),gl=!0),t){case"iframe":case"object":Zr(ft,e);break;case"video":case"audio":for(var s=0;s<ii.length;s++)Zr(ii[s],e);break;case"source":Zr(st,e);break;case"img":case"image":case"link":Zr(st,e),Zr(ft,e);break;case"form":Zr(Ot,e),Zr(Gt,e);break;case"details":Zr(jt,e);break;case"input":Eo(e,i),Zr(ut,e),Ol(o,"onChange");break;case"option":Ja(e,i);break;case"select":as(e,i),Zr(ut,e),Ol(o,"onChange");break;case"textarea":cs(e,i),Zr(ut,e),Ol(o,"onChange")}Hs(t,i,Pl),a=new Set;for(var l=e.attributes,d=0;d<l.length;d++){var c=l[d].name.toLowerCase();switch(c){case"data-reactroot":case"value":case"checked":case"selected":break;default:a.add(l[d].name)}}var u=null;for(var p in i)if(i.hasOwnProperty(p)){var m=i[p];if(p===zl)"string"==typeof m?e.textContent!==m&&(Tl||Rl(e.textContent,m),u=[zl,m]):"number"==typeof m&&e.textContent!==""+m&&(Tl||Rl(e.textContent,m),u=[zl,""+m]);else if(f.hasOwnProperty(p))null!=m&&("function"!=typeof m&&Il(p,m),Ol(o,p));else if("boolean"==typeof r){var h=void 0,g=Qn(p);if(Tl);else if(p===vl||p===yl||"value"===p||"checked"===p||"selected"===p);else if(p===bl){var b=m&&m[wl]||"",v=e.innerHTML,y=Fl(e,b);y!==v&&kl(p,v,y)}else if(p===Cl){a.delete(p);var x=Ls(m);h=e.getAttribute("style"),x!==h&&kl(p,h,x)}else if(r)a.delete(p.toLowerCase()),h=ro(e,p,m),m!==h&&kl(p,h,m);else if(!Kn(p,g,r)&&!Zn(p,m,g,r)){var z=!1;if(null!==g)a.delete(g.attributeName),h=oo(e,p,m,g);else{var C=n;if(C===El&&(C=bs(t)),C===El)a.delete(p.toLowerCase());else{var w=Hl(p);null!==w&&w!==p&&(z=!0,a.delete(w)),a.delete(p)}h=ro(e,p,m)}m===h||z||kl(p,h,m)}}}switch(a.size>0&&!Tl&&$l(a),t){case"input":pn(e),To(e,i,!0);break;case"textarea":pn(e),ps(e,i);break;case"select":case"option":break;default:"function"==typeof i.onClick&&Vl(e)}return u}function jl(e,t){var i=e.nodeValue!==t;return i}function Wl(e,t){Rl(e.nodeValue,t)}function Yl(e,t){fl||(fl=!0,E(!1,"Did not expect server HTML to contain a <%s> in <%s>.",t.nodeName.toLowerCase(),e.nodeName.toLowerCase()))}function Kl(e,t){fl||(fl=!0,E(!1,'Did not expect server HTML to contain the text node "%s" in <%s>.',t.nodeValue,e.nodeName.toLowerCase()))}function Jl(e,t,i){fl||(fl=!0,E(!1,"Expected server HTML to contain a matching <%s> in <%s>.",t,e.nodeName.toLowerCase()))}function Zl(e,t){""!==t&&(fl||(fl=!0,E(!1,'Expected server HTML to contain a matching text node for "%s" in <%s>.',t,e.nodeName.toLowerCase())))}Ml=function(e){var t="string"==typeof e?e:""+e;return t.replace(Dl,"\n").replace(Nl,"")},Rl=function(e,t){if(!fl){var i=Ml(t),n=Ml(e);n!==i&&(fl=!0,E(!1,'Text content did not match. Server: "%s" Client: "%s"',n,i))}},kl=function(e,t,i){if(!fl){var n=Ml(i),o=Ml(t);o!==n&&(fl=!0,E(!1,"Prop `%s` did not match. Server: %s Client: %s",e,JSON.stringify(o),JSON.stringify(n)))}},$l=function(e){if(!fl){fl=!0;var t=[];e.forEach(function(e){t.push(e)}),E(!1,"Extra attributes from the server: %s",t)}},Il=function(e,t){!1===t?E(!1,"Expected `%s` listener to be a function, instead got `false`.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.%s",e,e,e,hl()):E(!1,"Expected `%s` listener to be a function, instead got a value of `%s` type.%s",e,typeof t,hl())},Fl=function(e,t){var i=e.namespaceURI===El?e.ownerDocument.createElement(e.tagName):e.ownerDocument.createElementNS(e.namespaceURI,e.tagName);return i.innerHTML=t,i.innerHTML};var Ql=Object.freeze({createElement:Bl,createTextNode:Ll,setInitialProperties:Ul,diffProperties:Gl,updateProperties:ql,diffHydratedProperties:Xl,diffHydratedText:jl,warnForUnmatchedText:Wl,warnForDeletedHydratableElement:Yl,warnForDeletedHydratableText:Kl,warnForInsertedHydratedElement:Jl,warnForInsertedHydratedText:Zl,restoreControlledState:function(e,t,i){switch(t){case"input":return void So(e,i);case"textarea":return void us(e,i);case"select":return o=e,void(null!=(r=(n=i).value)&&os(o,!!n.multiple,r,!1))}var n,o,r}}),ed=Nn.getCurrentFiberStackAddendum,td=w,id=["address","applet","area","article","aside","base","basefont","bgsound","blockquote","body","br","button","caption","center","col","colgroup","dd","details","dir","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","isindex","li","link","listing","main","marquee","menu","menuitem","meta","nav","noembed","noframes","noscript","object","ol","p","param","plaintext","pre","script","section","select","source","style","summary","table","tbody","td","template","textarea","tfoot","th","thead","title","tr","track","ul","wbr","xmp"],nd=["applet","caption","html","table","td","th","marquee","object","template","foreignObject","desc","title"],od=nd.concat(["button"]),rd=["dd","dt","li","option","optgroup","p","rp","rt"],ad={current:null,formTag:null,aTagInScope:null,buttonTagInScope:null,nobrTagInScope:null,pTagInButtonScope:null,listItemTagAutoclosing:null,dlItemTagAutoclosing:null},sd={};(td=function(e,t,i){var n=(i=i||ad).current,o=n&&n.tag;null!=t&&(null!=e&&E(!1,"validateDOMNesting: when childText is passed, childTag should be null"),e="#text");var r=function(e,t){switch(t){case"select":return"option"===e||"optgroup"===e||"#text"===e;case"optgroup":return"option"===e||"#text"===e;case"option":return"#text"===e;case"tr":return"th"===e||"td"===e||"style"===e||"script"===e||"template"===e;case"tbody":case"thead":case"tfoot":return"tr"===e||"style"===e||"script"===e||"template"===e;case"colgroup":return"col"===e||"template"===e;case"table":return"caption"===e||"colgroup"===e||"tbody"===e||"tfoot"===e||"thead"===e||"style"===e||"script"===e||"template"===e;case"head":return"base"===e||"basefont"===e||"bgsound"===e||"link"===e||"meta"===e||"title"===e||"noscript"===e||"noframes"===e||"style"===e||"script"===e||"template"===e;case"html":return"head"===e||"body"===e;case"#document":return"html"===e}switch(e){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return"h1"!==t&&"h2"!==t&&"h3"!==t&&"h4"!==t&&"h5"!==t&&"h6"!==t;case"rp":case"rt":return-1===rd.indexOf(t);case"body":case"caption":case"col":case"colgroup":case"frame":case"head":case"html":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return null==t}return!0}(e,o)?null:n,a=r?null:function(e,t){switch(e){case"address":case"article":case"aside":case"blockquote":case"center":case"details":case"dialog":case"dir":case"div":case"dl":case"fieldset":case"figcaption":case"figure":case"footer":case"header":case"hgroup":case"main":case"menu":case"nav":case"ol":case"p":case"section":case"summary":case"ul":case"pre":case"listing":case"table":case"hr":case"xmp":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return t.pTagInButtonScope;case"form":return t.formTag||t.pTagInButtonScope;case"li":return t.listItemTagAutoclosing;case"dd":case"dt":return t.dlItemTagAutoclosing;case"button":return t.buttonTagInScope;case"a":return t.aTagInScope;case"nobr":return t.nobrTagInScope}return null}(e,i),s=r||a;if(s){var l=s.tag,d=ed(),c=!!r+"|"+e+"|"+l+"|"+d;if(!sd[c]){sd[c]=!0;var u=e,p="";if("#text"===e?/\S/.test(t)?u="Text nodes":(u="Whitespace text nodes",p=" Make sure you don't have any extra whitespace between tags on each line of your source code."):u="<"+e+">",r){var m="";"table"===l&&"tr"===e&&(m+=" Add a <tbody> to your code to match the DOM tree generated by the browser."),E(!1,"validateDOMNesting(...): %s cannot appear as a child of <%s>.%s%s%s",u,l,p,m,d)}else E(!1,"validateDOMNesting(...): %s cannot appear as a descendant of <%s>.%s",u,l,d)}}}).updatedAncestorInfo=function(e,t,i){var n=di({},e||ad),o={tag:t,instance:i};return-1!==nd.indexOf(t)&&(n.aTagInScope=null,n.buttonTagInScope=null,n.nobrTagInScope=null),-1!==od.indexOf(t)&&(n.pTagInButtonScope=null),-1!==id.indexOf(t)&&"address"!==t&&"div"!==t&&"p"!==t&&(n.listItemTagAutoclosing=null,n.dlItemTagAutoclosing=null),n.current=o,"form"===t&&(n.formTag=o),"a"===t&&(n.aTagInScope=o),"button"===t&&(n.buttonTagInScope=o),"nobr"===t&&(n.nobrTagInScope=o),"p"===t&&(n.pTagInButtonScope=o),"li"===t&&(n.listItemTagAutoclosing=o),"dd"!==t&&"dt"!==t||(n.dlItemTagAutoclosing=o),n};var ld=td;function dd(){i(!1,"The current renderer does not support persistence. This error is likely caused by a bug in React. Please file an issue.")}var cd=!1,ud=dd,pd=dd,md=dd,hd=dd,fd=dd,gd=Bl,bd=Ll,vd=Ul,yd=Gl,xd=ql,zd=Xl,Cd=jl,wd=Wl,Ed=Yl,Pd=Kl,_d=Jl,Td=Zl,Sd=ld.updatedAncestorInfo,Rd=re,kd=ce,$d=void 0;$d="suppressHydrationWarning";var Id=null,Md=null;function Fd(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Dd(e){return e}function Nd(e,t,i,n,o){return vd(e,t,i,n),Fd(t,i)}function Od(e,t){return"textarea"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&"string"==typeof t.dangerouslySetInnerHTML.__html}function Ad(e,t){return!!t.hidden}function Vd(e,t,i,n){var o=i;ld(null,e,o.ancestorInfo);var r=bd(e,t);return Rd(n,r),r}var Bd=Ia,Ld=!0,Ud=Fa,Gd=Da,qd=!0;function Hd(e){zs(e,"")}function Xd(e,t){e.nodeType===rn?e.parentNode.insertBefore(t,e):e.appendChild(t)}function jd(e,t,i){e.nodeType===rn?e.parentNode.insertBefore(t,i):e.insertBefore(t,i)}function Wd(e,t){e.nodeType===rn?e.parentNode.removeChild(t):e.removeChild(t)}var Yd=!0;function Kd(e){for(var t=e.nextSibling;t&&t.nodeType!==nn&&t.nodeType!==on;)t=t.nextSibling;return t}function Jd(e){for(var t=e.firstChild;t&&t.nodeType!==nn&&t.nodeType!==on;)t=t.nextSibling;return t}var Zd=!0,Qd=!1,ec=!1,tc=!1,ic=!0,nc=!0,oc=!1,rc=!1,ac=!0,sc="undefined"!=typeof performance&&"function"==typeof performance.mark&&"function"==typeof performance.clearMarks&&"function"==typeof performance.measure&&"function"==typeof performance.clearMeasures,lc=null,dc=null,cc=null,uc=!1,pc=!1,mc=!1,hc=0,fc=0,gc=!1,bc=new Set,vc=function(e){return" "+e},yc=function(e){performance.mark(vc(e))},xc=function(e,t,i){var n,o=vc(t),r=((n=i)?" ":" ")+e+(n?" Warning: "+n:"");try{performance.measure(r,o)}catch(e){}performance.clearMarks(o),performance.clearMeasures(r)},zc=function(e,t){return e+" (#"+t+")"},Cc=function(e,t,i){return null===i?e+" ["+(t?"update":"mount")+"]":e+"."+i},wc=function(e,t){var i=In(e)||"Unknown",n=e._debugID,o=null!==e.alternate,r=Cc(i,o,t);if(uc&&bc.has(r))return!1;bc.add(r);var a=zc(r,n);return yc(a),!0},Ec=function(e,t){var i,n=In(e)||"Unknown",o=e._debugID,r=null!==e.alternate,a=Cc(n,r,t),s=zc(a,o);i=s,performance.clearMarks(vc(i))},Pc=function(e,t,i){var n=In(e)||"Unknown",o=e._debugID,r=null!==e.alternate,a=Cc(n,r,t),s=zc(a,o);xc(a,s,i)},_c=function(e){switch(e.tag){case H:case j:case W:case X:case Y:case Z:case J:case K:return!0;default:return!1}},Tc=function(){null!==dc&&null!==cc&&Ec(cc,dc),cc=null,dc=null,mc=!1},Sc=function(){for(var e=lc;e;)e._debugIsCurrentlyTiming&&Pc(e,null,null),e=e.return},Rc=function(e){null!==e.return&&Rc(e.return),e._debugIsCurrentlyTiming&&wc(e,null)},kc=function(){null!==lc&&Rc(lc)};function $c(){Zd&&fc++}function Ic(e){if(Zd){if(!sc||_c(e))return;e._debugIsCurrentlyTiming=!1,Ec(e,null)}}function Mc(e){if(Zd){if(!sc||_c(e))return;if(lc=e.return,!e._debugIsCurrentlyTiming)return;e._debugIsCurrentlyTiming=!1,Pc(e,null,null)}}function Fc(e){if(Zd){if(!sc||_c(e))return;if(lc=e.return,!e._debugIsCurrentlyTiming)return;e._debugIsCurrentlyTiming=!1;Pc(e,null,"An error was thrown inside this error boundary")}}function Dc(e,t){if(Zd){if(!sc)return;if(Tc(),!wc(e,t))return;cc=e,dc=t}}function Nc(){if(Zd){if(!sc)return;if(null!==dc&&null!==cc){var e=mc?"Scheduled a cascading update":null;Pc(cc,dc,e)}dc=null,cc=null}}function Oc(e,t){if(Zd){if(!sc)return;var i=null;if(null!==e)if(e.tag===H)i="A top-level update interrupted the previous render";else{var n=In(e)||"Unknown";i="An update to "+n+" interrupted the previous render"}else hc>1&&(i="There were cascading updates");hc=0;var o=t?"(React Tree Reconciliation: Completed Root)":"(React Tree Reconciliation: Yielded)";Sc(),xc(o,"(React Tree Reconciliation)",i)}}var Ac=[],Vc=void 0;Vc=[];var Bc=-1;function Lc(e){return{current:e}}function Uc(e,t){Bc<0?E(!1,"Unexpected pop."):(t!==Vc[Bc]&&E(!1,"Unexpected Fiber popped."),e.current=Ac[Bc],Ac[Bc]=null,Vc[Bc]=null,Bc--)}function Gc(e,t,i){Ac[++Bc]=e.current,Vc[Bc]=i,e.current=t}var qc=void 0;qc={};var Hc=Lc(_a),Xc=Lc(!1),jc=_a;function Wc(e){var t=Zc(e);return t?jc:Hc.current}function Yc(e,t,i){var n=e.stateNode;n.__reactInternalMemoizedUnmaskedChildContext=t,n.__reactInternalMemoizedMaskedChildContext=i}function Kc(e,t){var i=e.type,n=i.contextTypes;if(!n)return _a;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var r={};for(var a in n)r[a]=t[a];var s=In(e)||"Unknown";return po(n,r,"context",s,Nn.getCurrentFiberStackAddendum),o&&Yc(e,t,r),r}function Jc(){return Xc.current}function Zc(e){return e.tag===q&&null!=e.type.childContextTypes}function Qc(e){Zc(e)&&(Uc(Xc,e),Uc(Hc,e))}function eu(e){Uc(Xc,e),Uc(Hc,e)}function tu(e,t,n){Hc.current!==_a&&i(!1,"Unexpected context found on stack. This error is likely caused by a bug in React. Please file an issue."),Gc(Hc,t,e),Gc(Xc,n,e)}function iu(e,t){var n=e.stateNode,o=e.type.childContextTypes;if("function"!=typeof n.getChildContext){var r=In(e)||"Unknown";return qc[r]||(qc[r]=!0,E(!1,"%s.childContextTypes is specified but there is no getChildContext() method on the instance. You can either define getChildContext() on %s or remove childContextTypes from it.",r,r)),t}var a=void 0;for(var s in Nn.setCurrentPhase("getChildContext"),Dc(e,"getChildContext"),a=n.getChildContext(),Nc(),Nn.setCurrentPhase(null),a)s in o||i(!1,'%s.getChildContext(): key "%s" is not defined in childContextTypes.',In(e)||"Unknown",s);var l=In(e)||"Unknown";return po(o,a,"child context",l,Nn.getCurrentFiberStackAddendum),di({},t,a)}function nu(e){if(!Zc(e))return!1;var t=e.stateNode,i=t&&t.__reactInternalMemoizedMergedChildContext||_a;return jc=Hc.current,Gc(Hc,i,e),Gc(Xc,Xc.current,e),!0}function ou(e,t){var n=e.stateNode;if(n||i(!1,"Expected to have an instance by this point. This error is likely caused by a bug in React. Please file an issue."),t){var o=iu(e,jc);n.__reactInternalMemoizedMergedChildContext=o,Uc(Xc,e),Uc(Hc,e),Gc(Hc,o,e),Gc(Xc,t,e)}else Uc(Xc,e),Gc(Xc,t,e)}var ru=1073741823,au=0,su=1,lu=ru,du=10,cu=2;function uu(e){return(e/du|0)+cu}function pu(e){return(e-cu)*du}function mu(e,t,i){return cu+(1+((e-cu+t/du)/(n=i/du)|0))*n;var n}var hu=0,fu=1,gu=2,bu=4,vu=void 0;vu=!1;try{var yu=Object.preventExtensions({}),xu=new Map([[yu,null]]),zu=new Set([yu]);xu.set(0,0),zu.add(0)}catch(e){vu=!0}var Cu=void 0;Cu=1;var wu=function(e,t,i,n){return new function(e,t,i,n){this.tag=e,this.key=i,this.type=null,this.stateNode=null,this.return=null,this.child=null,this.sibling=null,this.index=0,this.ref=null,this.pendingProps=t,this.memoizedProps=null,this.updateQueue=null,this.memoizedState=null,this.mode=n,this.effectTag=rr,this.nextEffect=null,this.firstEffect=null,this.lastEffect=null,this.expirationTime=au,this.alternate=null,ac&&(this.actualDuration=0,this.actualStartTime=0,this.selfBaseTime=0,this.treeBaseTime=0);this._debugID=Cu++,this._debugSource=null,this._debugOwner=null,this._debugIsCurrentlyTiming=!1,vu||"function"!=typeof Object.preventExtensions||Object.preventExtensions(this)}(e,t,i,n)};function Eu(e,t,i){var n=e.alternate;return null===n?((n=wu(e.tag,t,e.key,e.mode)).type=e.type,n.stateNode=e.stateNode,n._debugID=e._debugID,n._debugSource=e._debugSource,n._debugOwner=e._debugOwner,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=rr,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null,ac&&(n.actualDuration=0,n.actualStartTime=0)),n.expirationTime=i,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,ac&&(n.selfBaseTime=e.selfBaseTime,n.treeBaseTime=e.treeBaseTime),n}function Pu(e,t,n){var o=null;o=e._owner;var r,a=void 0,s=e.type,l=e.key,d=e.props,c=void 0;if("function"==typeof s)c=(r=s).prototype&&r.prototype.isReactComponent?q:U;else if("string"==typeof s)c=j;else switch(s){case zn:return _u(d.children,t,n,l);case _n:c=K,t|=fu|gu;break;case Cn:c=K,t|=gu;break;case wn:return function(e,t,n,o){"string"==typeof e.id&&"function"==typeof e.onRender||i(!1,'Profiler must specify an "id" string and "onRender" function as props');var r=wu(ee,e,o,t|bu);return r.type=wn,r.expirationTime=n,r}(d,t,n,l);case Sn:c=te,t|=gu;break;default:c=function(e,t){switch("object"==typeof e&&null!==e?e.$$typeof:null){case En:return Z;case Pn:return J;case Tn:return Q;default:var n="";(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(n+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var o=t?In(t):null;o&&(n+="\n\nCheck the render method of `"+o+"`."),i(!1,"Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",null==e?e:typeof e,n)}}(s,o)}return(a=wu(c,d,l,t)).type=s,a.expirationTime=n,a._debugSource=e._source,a._debugOwner=e._owner,a}function _u(e,t,i,n){var o=wu(Y,e,n,t);return o.expirationTime=i,o}function Tu(e,t,i){var n=wu(W,e,null,t);return n.expirationTime=i,n}function Su(e,t,i){var n=null!==e.children?e.children:[],o=wu(X,n,e.key,t);return o.expirationTime=i,o.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},o}function Ru(e,t){return null===e&&(e=wu(U,null,null,hu)),e.tag=t.tag,e.key=t.key,e.type=t.type,e.stateNode=t.stateNode,e.return=t.return,e.child=t.child,e.sibling=t.sibling,e.index=t.index,e.ref=t.ref,e.pendingProps=t.pendingProps,e.memoizedProps=t.memoizedProps,e.updateQueue=t.updateQueue,e.memoizedState=t.memoizedState,e.mode=t.mode,e.effectTag=t.effectTag,e.nextEffect=t.nextEffect,e.firstEffect=t.firstEffect,e.lastEffect=t.lastEffect,e.expirationTime=t.expirationTime,e.alternate=t.alternate,ac&&(e.actualDuration=t.actualDuration,e.actualStartTime=t.actualStartTime,e.selfBaseTime=t.selfBaseTime,e.treeBaseTime=t.treeBaseTime),e._debugID=t._debugID,e._debugSource=t._debugSource,e._debugOwner=t._debugOwner,e._debugIsCurrentlyTiming=t._debugIsCurrentlyTiming,e}function ku(e,t,i){var n=wu(H,null,null,t?fu|gu:hu),o={current:n,containerInfo:e,pendingChildren:null,earliestPendingTime:au,latestPendingTime:au,earliestSuspendedTime:au,latestSuspendedTime:au,latestPingedTime:au,pendingCommitExpirationTime:au,finishedWork:null,context:null,pendingContext:null,hydrate:i,remainingExpirationTime:au,firstBatch:null,nextScheduledRoot:null};return n.stateNode=o,o}var $u=null,Iu=null,Mu=!1;function Fu(e){return function(t){try{return e(t)}catch(e){Mu||(Mu=!0,E(!1,"React DevTools encountered an error: %s",e))}}}function Du(e){"function"==typeof $u&&$u(e)}function Nu(e){"function"==typeof Iu&&Iu(e)}var Ou=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(!e){for(var i=arguments.length,n=Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];(function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var o=0,r="Warning: "+e.replace(/%s/g,function(){return i[o++]});"undefined"!=typeof console&&console.warn(r);try{throw new Error(r)}catch(e){}}).apply(void 0,[t].concat(n))}},Au={discardPendingWarnings:function(){},flushPendingDeprecationWarnings:function(){},flushPendingUnsafeLifecycleWarnings:function(){},recordDeprecationWarnings:function(e,t){},recordUnsafeLifecycleWarnings:function(e,t){},recordLegacyContextWarning:function(e,t){},flushLegacyContextWarning:function(){}},Vu={UNSAFE_componentWillMount:"componentDidMount",UNSAFE_componentWillReceiveProps:"static getDerivedStateFromProps",UNSAFE_componentWillUpdate:"componentDidUpdate"},Bu=[],Lu=[],Uu=[],Gu=new Map,qu=new Map,Hu=new Set,Xu=new Set,ju=new Set,Wu=function(e){var t=[];return e.forEach(function(e){t.push(e)}),t.sort().join(", ")};Au.discardPendingWarnings=function(){Bu=[],Lu=[],Uu=[],Gu=new Map,qu=new Map},Au.flushPendingUnsafeLifecycleWarnings=function(){Gu.forEach(function(e,t){var i=[];if(Object.keys(e).forEach(function(t){var n=e[t];if(n.length>0){var o=new Set;n.forEach(function(e){o.add(In(e)||"Component"),Xu.add(e.type)});var r=t.replace("UNSAFE_",""),a=Vu[t],s=Wu(o);i.push(r+": Please update the following components to use "+a+" instead: "+s)}}),i.length>0){var n=Fn(t);E(!1,"Unsafe lifecycle methods were found within a strict-mode tree:%s\n\n%s\n\nLearn more about this warning here:\nhttps://fb.me/react-strict-mode-warnings",n,i.join("\n\n"))}}),Gu=new Map};var Yu=function(e){for(var t=null,i=e;null!==i;)i.mode&gu&&(t=i),i=i.return;return t};Au.flushPendingDeprecationWarnings=function(){if(Bu.length>0){var e=new Set;Bu.forEach(function(t){e.add(In(t)||"Component"),Hu.add(t.type)});var t=Wu(e);Ou(!1,"componentWillMount is deprecated and will be removed in the next major version. Use componentDidMount instead. As a temporary workaround, you can rename to UNSAFE_componentWillMount.\n\nPlease update the following components: %s\n\nLearn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks",t),Bu=[]}if(Lu.length>0){var i=new Set;Lu.forEach(function(e){i.add(In(e)||"Component"),Hu.add(e.type)});var n=Wu(i);Ou(!1,"componentWillReceiveProps is deprecated and will be removed in the next major version. Use static getDerivedStateFromProps instead.\n\nPlease update the following components: %s\n\nLearn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks",n),Lu=[]}if(Uu.length>0){var o=new Set;Uu.forEach(function(e){o.add(In(e)||"Component"),Hu.add(e.type)});var r=Wu(o);Ou(!1,"componentWillUpdate is deprecated and will be removed in the next major version. Use componentDidUpdate instead. As a temporary workaround, you can rename to UNSAFE_componentWillUpdate.\n\nPlease update the following components: %s\n\nLearn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks",r),Uu=[]}},Au.recordDeprecationWarnings=function(e,t){Hu.has(e.type)||("function"==typeof t.componentWillMount&&!0!==t.componentWillMount.__suppressDeprecationWarning&&Bu.push(e),"function"==typeof t.componentWillReceiveProps&&!0!==t.componentWillReceiveProps.__suppressDeprecationWarning&&Lu.push(e),"function"==typeof t.componentWillUpdate&&!0!==t.componentWillUpdate.__suppressDeprecationWarning&&Uu.push(e))},Au.recordUnsafeLifecycleWarnings=function(e,t){var i=Yu(e);if(null!==i){if(!Xu.has(e.type)){var n=void 0;Gu.has(i)?n=Gu.get(i):(n={UNSAFE_componentWillMount:[],UNSAFE_componentWillReceiveProps:[],UNSAFE_componentWillUpdate:[]},Gu.set(i,n));var o=[];("function"==typeof t.componentWillMount&&!0!==t.componentWillMount.__suppressDeprecationWarning||"function"==typeof t.UNSAFE_componentWillMount)&&o.push("UNSAFE_componentWillMount"),("function"==typeof t.componentWillReceiveProps&&!0!==t.componentWillReceiveProps.__suppressDeprecationWarning||"function"==typeof t.UNSAFE_componentWillReceiveProps)&&o.push("UNSAFE_componentWillReceiveProps"),("function"==typeof t.componentWillUpdate&&!0!==t.componentWillUpdate.__suppressDeprecationWarning||"function"==typeof t.UNSAFE_componentWillUpdate)&&o.push("UNSAFE_componentWillUpdate"),o.length>0&&o.forEach(function(t){n[t].push(e)})}}else E(!1,"Expected to find a StrictMode component in a strict mode tree. This error is likely caused by a bug in React. Please file an issue.")},Au.recordLegacyContextWarning=function(e,t){var i=Yu(e);if(null!==i){if(!ju.has(e.type)){var n=qu.get(i);(null!=e.type.contextTypes||null!=e.type.childContextTypes||null!==t&&"function"==typeof t.getChildContext)&&(void 0===n&&(n=[],qu.set(i,n)),n.push(e))}}else E(!1,"Expected to find a StrictMode component in a strict mode tree. This error is likely caused by a bug in React. Please file an issue.")},Au.flushLegacyContextWarning=function(){qu.forEach(function(e,t){var i=new Set;e.forEach(function(e){i.add(In(e)||"Component"),ju.add(e.type)});var n=Wu(i),o=Fn(t);E(!1,"Legacy context API has been detected within a strict-mode tree: %s\n\nPlease update the following components: %s\n\nLearn more about this warning here:\nhttps://fb.me/react-strict-mode-warnings",o,n)})};var Ku={debugTool:null};function Ju(e,t){if(ec){var i=e.earliestPendingTime;if(i===au)e.earliestPendingTime=e.latestPendingTime=t;else if(i>t)e.earliestPendingTime=t;else{var n=e.latestPendingTime;n<t&&(e.latestPendingTime=t)}}}function Zu(e){if(ec){var t=e.earliestSuspendedTime,i=e.earliestPendingTime;return t===au?i:i!==au?i:e.latestPingedTime}return e.current.expirationTime}var Qu=0,ep=1,tp=2,ip=3,np=!1,op=void 0,rp=void 0,ap=void 0;function sp(e){var t={expirationTime:au,baseState:e,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null};return t}function lp(e){var t={expirationTime:e.expirationTime,baseState:e.baseState,firstUpdate:e.firstUpdate,lastUpdate:e.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null};return t}function dp(e){return{expirationTime:e,tag:Qu,payload:null,callback:null,next:null,nextEffect:null}}function cp(e,t,i){null===e.lastUpdate?e.firstUpdate=e.lastUpdate=t:(e.lastUpdate.next=t,e.lastUpdate=t),(e.expirationTime===au||e.expirationTime>i)&&(e.expirationTime=i)}function up(e,t,i){var n=e.alternate,o=void 0,r=void 0;null===n?(o=e.updateQueue,r=null,null===o&&(o=e.updateQueue=sp(e.memoizedState))):(o=e.updateQueue,r=n.updateQueue,null===o?null===r?(o=e.updateQueue=sp(e.memoizedState),r=n.updateQueue=sp(n.memoizedState)):o=e.updateQueue=lp(r):null===r&&(r=n.updateQueue=lp(o))),null===r||o===r?cp(o,t,i):null===o.lastUpdate||null===r.lastUpdate?(cp(o,t,i),cp(r,t,i)):(cp(o,t,i),r.lastUpdate=t),e.tag!==q||rp!==o&&(null===r||rp!==r)||op||(E(!1,"An update (setState, replaceState, or forceUpdate) was scheduled from inside an update function. Update functions should be pure, with zero side-effects. Consider using componentDidUpdate or a callback."),op=!0)}function pp(e,t,i){var n=e.updateQueue;null===(n=null===n?e.updateQueue=sp(e.memoizedState):mp(e,n)).lastCapturedUpdate?n.firstCapturedUpdate=n.lastCapturedUpdate=t:(n.lastCapturedUpdate.next=t,n.lastCapturedUpdate=t),(n.expirationTime===au||n.expirationTime>i)&&(n.expirationTime=i)}function mp(e,t){var i=e.alternate;return null!==i&&t===i.updateQueue&&(t=e.updateQueue=lp(t)),t}function hp(e,t,i,n,o,r){switch(i.tag){case ep:var a=i.payload;return"function"==typeof a?((tc||ic&&e.mode&gu)&&a.call(r,n,o),a.call(r,n,o)):a;case ip:e.effectTag=e.effectTag&~vr|mr;case Qu:var s=i.payload,l=void 0;return"function"==typeof s?((tc||ic&&e.mode&gu)&&s.call(r,n,o),l=s.call(r,n,o)):l=s,null==l?n:di({},n,l);case tp:return np=!0,n}return n}function fp(e,t,i,n,o){if(np=!1,!(t.expirationTime===au||t.expirationTime>o)){t=mp(e,t),rp=t;for(var r=t.baseState,a=null,s=au,l=t.firstUpdate,d=r;null!==l;){var c=l.expirationTime;if(c>o)null===a&&(a=l,r=d),(s===au||s>c)&&(s=c);else{d=hp(e,t,l,d,i,n);var u=l.callback;null!==u&&(e.effectTag|=pr,l.nextEffect=null,null===t.lastEffect?t.firstEffect=t.lastEffect=l:(t.lastEffect.nextEffect=l,t.lastEffect=l))}l=l.next}var p=null;for(l=t.firstCapturedUpdate;null!==l;){var m=l.expirationTime;if(m>o)null===p&&(p=l,null===a&&(r=d)),(s===au||s>m)&&(s=m);else{d=hp(e,t,l,d,i,n);var h=l.callback;null!==h&&(e.effectTag|=pr,l.nextEffect=null,null===t.lastCapturedEffect?t.firstCapturedEffect=t.lastCapturedEffect=l:(t.lastCapturedEffect.nextEffect=l,t.lastCapturedEffect=l))}l=l.next}null===a&&(t.lastUpdate=null),null===p?t.lastCapturedUpdate=null:e.effectTag|=pr,null===a&&null===p&&(r=d),t.baseState=r,t.firstUpdate=a,t.firstCapturedUpdate=p,t.expirationTime=s,e.memoizedState=d,rp=null}}function gp(e,t){"function"!=typeof e&&i(!1,"Invalid argument passed as callback. Expected a function. Instead received: %s",e),e.call(t)}function bp(){np=!1}function vp(){return np}function yp(e,t,i,n){null!==t.firstCapturedUpdate&&(null!==t.lastUpdate&&(t.lastUpdate.next=t.firstCapturedUpdate,t.lastUpdate=t.lastCapturedUpdate),t.firstCapturedUpdate=t.lastCapturedUpdate=null);var o=t.firstEffect;for(t.firstEffect=t.lastEffect=null;null!==o;){var r=o.callback;null!==r&&(o.callback=null,gp(r,i)),o=o.nextEffect}for(o=t.firstCapturedEffect,t.firstCapturedEffect=t.lastCapturedEffect=null;null!==o;){var a=o.callback;null!==a&&(o.callback=null,gp(a,i)),o=o.nextEffect}}function xp(e,t){return{value:e,source:t,stack:Fn(t)}}op=!1,rp=null,ap=function(){rp=null};var zp=Lc(null),Cp=Lc(null),wp=Lc(0),Ep=void 0;function Pp(e){var t=e.type._context;Ld?(Gc(wp,t._changedBits,e),Gc(Cp,t._currentValue,e),Gc(zp,e,e),t._currentValue=e.pendingProps.value,t._changedBits=e.stateNode,void 0!==t._currentRenderer&&null!==t._currentRenderer&&t._currentRenderer!==Ep&&E(!1,"Detected multiple renderers concurrently rendering the same context provider. This is currently unsupported."),t._currentRenderer=Ep):(Gc(wp,t._changedBits2,e),Gc(Cp,t._currentValue2,e),Gc(zp,e,e),t._currentValue2=e.pendingProps.value,t._changedBits2=e.stateNode,void 0!==t._currentRenderer2&&null!==t._currentRenderer2&&t._currentRenderer2!==Ep&&E(!1,"Detected multiple renderers concurrently rendering the same context provider. This is currently unsupported."),t._currentRenderer2=Ep)}function _p(e){var t=wp.current,i=Cp.current;Uc(zp,e),Uc(Cp,e),Uc(wp,e);var n=e.type._context;Ld?(n._currentValue=i,n._changedBits=t):(n._currentValue2=i,n._changedBits2=t)}Ep={};var Tp={},Sp=Lc(Tp),Rp=Lc(Tp),kp=Lc(Tp);function $p(e){return e===Tp&&i(!1,"Expected host context to exist. This error is likely caused by a bug in React. Please file an issue."),e}function Ip(){var e=$p(kp.current);return e}function Mp(e,t){Gc(kp,t,e),Gc(Rp,e,e),Gc(Sp,Tp,e);var i=function(e){var t=void 0,i=void 0,n=e.nodeType;switch(n){case an:case sn:t=n===an?"#document":"#fragment";var o=e.documentElement;i=o?o.namespaceURI:vs(null,"");break;default:var r=n===rn?e.parentNode:e,a=r.namespaceURI||null;t=r.tagName,i=vs(a,t)}var s=t.toLowerCase(),l=Sd(null,s,null);return{namespace:i,ancestorInfo:l}}(t);Uc(Sp,e),Gc(Sp,i,e)}function Fp(e){Uc(Sp,e),Uc(Rp,e),Uc(kp,e)}function Dp(){var e=$p(Sp.current);return e}function Np(e){$p(kp.current);var t,i,n,o,r,a=$p(Sp.current),s=(t=a,i=e.type,o=vs((n=t).namespace,i),r=Sd(n.ancestorInfo,i,null),{namespace:o,ancestorInfo:r});a!==s&&(Gc(Rp,e,e),Gc(Sp,s,e))}function Op(e){Rp.current===e&&(Uc(Sp,e),Uc(Rp,e))}var Ap=0;var Vp=void 0;Vp=[];var Bp=0,Lp=0;function Up(){ac&&0===Bp&&(Bp=Bd())}function Gp(e){ac&&(e!==Vp.pop()&&E(!1,"Unexpected Fiber (%s) popped.",In(e)),e.actualDuration=Bd()-Lp-e.actualDuration)}function qp(){ac&&Bp>0&&(Lp+=Bd()-Bp,Bp=0)}var Hp=-1;function Xp(){ac&&(Hp=-1)}var jp={},Wp=Array.isArray,Yp=void 0,Kp=void 0,Jp=void 0,Zp=void 0,Qp=void 0,em=void 0,tm=void 0;Yp=new Set,Kp=new Set,Jp=new Set,Zp=new Set,Qp=new Set;var im=new Set;function nm(e,t,i){var n=e.memoizedState;(tc||ic&&e.mode&gu)&&t(i,n);var o=t(i,n);em(e,o);var r=null==o?n:di({},n,o);e.memoizedState=r;var a=e.updateQueue;null!==a&&a.expirationTime===au&&(a.baseState=r)}tm=function(e,t){if(null!==e&&"function"!=typeof e){var i=t+"_"+e;im.has(i)||(im.add(i),E(!1,"%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",t,e))}},em=function(e,t){if(void 0===t){var i=In(e)||"Component";Qp.has(i)||(Qp.add(i),E(!1,"%s.getDerivedStateFromProps(): A valid state object (or null) must be returned. You have returned undefined.",i))}},Object.defineProperty(jp,"_processChildContext",{enumerable:!1,value:function(){i(!1,"_processChildContext is not available in React 16+. This likely means you have multiple copies of React and are attempting to nest a React 15 tree inside a React 16 tree using unstable_renderSubtreeIntoContainer, which isn't supported. Try to make sure you have only one copy of React (and ideally, switch to ReactDOM.createPortal).")}}),Object.freeze(jp);var om={isMounted:function(e){var t=fn.current;if(null!==t&&t.tag===q){var i=t,n=i.stateNode;n._warnedAboutRefsInRender||E(!1,"%s is accessing isMounted inside its render() function. render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",In(i)||"A component"),n._warnedAboutRefsInRender=!0}var o=or(e);if(!o)return!1;return Cr(o)===xr},enqueueSetState:function(e,t,i){var n=or(e),o=Cf(),r=yf(o,n),a=dp(r);a.payload=t,null!=i&&(tm(i,"setState"),a.callback=i),up(n,a,r),zf(n,r)},enqueueReplaceState:function(e,t,i){var n=or(e),o=Cf(),r=yf(o,n),a=dp(r);a.tag=ep,a.payload=t,null!=i&&(tm(i,"replaceState"),a.callback=i),up(n,a,r),zf(n,r)},enqueueForceUpdate:function(e,t){var i=or(e),n=Cf(),o=yf(n,i),r=dp(o);r.tag=tp,null!=t&&(tm(t,"forceUpdate"),r.callback=t),up(i,r,o),zf(i,o)}};function rm(e,t,i,n,o,r){var a=e.stateNode,s=e.type;if("function"==typeof a.shouldComponentUpdate){Dc(e,"shouldComponentUpdate");var l=a.shouldComponentUpdate(i,o,r);return Nc(),void 0===l&&E(!1,"%s.shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false.",In(e)||"Component"),l}return!s.prototype||!s.prototype.isPureReactComponent||(!nr(t,i)||!nr(n,o))}function am(e,t){var i;t.updater=om,e.stateNode=t,i=e,t._reactInternalFiber=i,t._reactInternalInstance=jp}function sm(e,t,i){var n,o=e.type,r=Wc(e),a=(n=e).tag===q&&null!=n.type.contextTypes,s=a?Kc(e,r):_a;(tc||ic&&e.mode&gu)&&new o(t,s);var l=new o(t,s),d=e.memoizedState=null!==l.state&&void 0!==l.state?l.state:null;if(am(e,l),"function"==typeof o.getDerivedStateFromProps&&null===d){var c=In(e)||"Component";Kp.has(c)||(Kp.add(c),E(!1,"%s: Did not properly initialize state during construction. Expected state to be an object, but it was %s.",c,null===l.state?"null":"undefined"))}if("function"==typeof o.getDerivedStateFromProps||"function"==typeof l.getSnapshotBeforeUpdate){var u=null,p=null,m=null;if("function"==typeof l.componentWillMount&&!0!==l.componentWillMount.__suppressDeprecationWarning?u="componentWillMount":"function"==typeof l.UNSAFE_componentWillMount&&(u="UNSAFE_componentWillMount"),"function"==typeof l.componentWillReceiveProps&&!0!==l.componentWillReceiveProps.__suppressDeprecationWarning?p="componentWillReceiveProps":"function"==typeof l.UNSAFE_componentWillReceiveProps&&(p="UNSAFE_componentWillReceiveProps"),"function"==typeof l.componentWillUpdate&&!0!==l.componentWillUpdate.__suppressDeprecationWarning?m="componentWillUpdate":"function"==typeof l.UNSAFE_componentWillUpdate&&(m="UNSAFE_componentWillUpdate"),null!==u||null!==p||null!==m){var h=In(e)||"Component",f="function"==typeof o.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";Zp.has(h)||(Zp.add(h),E(!1,"Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n%s uses %s but also contains the following legacy lifecycles:%s%s%s\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks",h,f,null!==u?"\n  "+u:"",null!==p?"\n  "+p:"",null!==m?"\n  "+m:""))}}return a&&Yc(e,r,s),l}function lm(e,t,i,n){var o=t.state;if(Dc(e,"componentWillReceiveProps"),"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),Nc(),t.state!==o){var r=In(e)||"Component";Yp.has(r)||(Yp.add(r),E(!1,"%s.componentWillReceiveProps(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",r)),om.enqueueReplaceState(t,t.state,null)}}function dm(e,t){var i=e.type;!function(e){var t=e.stateNode,i=e.type,n=In(e)||"Component";t.render||(i.prototype&&"function"==typeof i.prototype.render?E(!1,"%s(...): No `render` method found on the returned component instance: did you accidentally return an object from the constructor?",n):E(!1,"%s(...): No `render` method found on the returned component instance: you may have forgotten to define `render`.",n));!t.getInitialState||t.getInitialState.isReactClassApproved||t.state||E(!1,"getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",n),!(!t.getDefaultProps||t.getDefaultProps.isReactClassApproved)&&E(!1,"getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",n),!!t.propTypes&&E(!1,"propTypes was defined as an instance property on %s. Use a static property to define propTypes instead.",n),!!t.contextTypes&&E(!1,"contextTypes was defined as an instance property on %s. Use a static property to define contextTypes instead.",n),"function"!=typeof t.componentShouldUpdate||E(!1,"%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",n),i.prototype&&i.prototype.isPureReactComponent&&void 0!==t.shouldComponentUpdate&&E(!1,"%s has a method called shouldComponentUpdate(). shouldComponentUpdate should not be used when extending React.PureComponent. Please extend React.Component if shouldComponentUpdate is used.",In(e)||"A pure component");"function"==typeof t.componentDidUnmount&&E(!1,"%s has a method called componentDidUnmount(). But there is no such lifecycle method. Did you mean componentWillUnmount()?",n),!("function"!=typeof t.componentDidReceiveProps)&&E(!1,"%s has a method called componentDidReceiveProps(). But there is no such lifecycle method. If you meant to update the state in response to changing props, use componentWillReceiveProps(). If you meant to fetch data or run side-effects or mutations after React has updated the UI, use componentDidUpdate().",n),!("function"!=typeof t.componentWillRecieveProps)&&E(!1,"%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",n),"function"==typeof t.UNSAFE_componentWillRecieveProps&&E(!1,"%s has a method called UNSAFE_componentWillRecieveProps(). Did you mean UNSAFE_componentWillReceiveProps()?",n);var o=t.props!==e.pendingProps;void 0!==t.props&&o&&E(!1,"%s(...): When calling super() in `%s`, make sure to pass up the same props that your component's constructor was passed.",n,n),!t.defaultProps||E(!1,"Setting defaultProps as an instance property on %s is not supported and will be ignored. Instead, define defaultProps as a static property on %s.",n,n),"function"!=typeof t.getSnapshotBeforeUpdate||"function"==typeof t.componentDidUpdate||Jp.has(i)||(Jp.add(i),E(!1,"%s: getSnapshotBeforeUpdate() should be used with componentDidUpdate(). This component defines getSnapshotBeforeUpdate() only.",In(e)));"function"==typeof t.getDerivedStateFromProps&&E(!1,"%s: getDerivedStateFromProps() is defined as an instance method and will be ignored. Instead, declare it as a static method.",n),!("function"!=typeof t.getDerivedStateFromCatch)&&E(!1,"%s: getDerivedStateFromCatch() is defined as an instance method and will be ignored. Instead, declare it as a static method.",n),"function"==typeof i.getSnapshotBeforeUpdate&&E(!1,"%s: getSnapshotBeforeUpdate() is defined as a static method and will be ignored. Instead, declare it as an instance method.",n);var r=t.state;r&&("object"!=typeof r||Wp(r))&&E(!1,"%s.state: must be set to an object or null",n);"function"==typeof t.getChildContext&&"object"!=typeof i.childContextTypes&&E(!1,"%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",n)}(e);var n=e.stateNode,o=e.pendingProps,r=Wc(e);n.props=o,n.state=e.memoizedState,n.refs=_a,n.context=Kc(e,r),e.mode&gu&&(Au.recordUnsafeLifecycleWarnings(e,n),Au.recordLegacyContextWarning(e,n)),oc&&Au.recordDeprecationWarnings(e,n);var a=e.updateQueue;null!==a&&(fp(e,a,o,n,t),n.state=e.memoizedState);var s=e.type.getDerivedStateFromProps;"function"==typeof s&&(nm(e,s,o),n.state=e.memoizedState),"function"==typeof i.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(!function(e,t){Dc(e,"componentWillMount");var i=t.state;"function"==typeof t.componentWillMount&&t.componentWillMount();"function"==typeof t.UNSAFE_componentWillMount&&t.UNSAFE_componentWillMount();Nc(),i!==t.state&&(E(!1,"%s.componentWillMount(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",In(e)||"Component"),om.enqueueReplaceState(t,t.state,null))}(e,n),null!==(a=e.updateQueue)&&(fp(e,a,o,n,t),n.state=e.memoizedState)),"function"==typeof n.componentDidMount&&(e.effectTag|=lr)}var cm=Nn.getCurrentFiberStackAddendum,um=void 0,pm=void 0,mm=void 0,hm=void 0,fm=function(e){};um=!1,pm={},mm={},hm={},fm=function(e){if(null!==e&&"object"==typeof e&&e._store&&!e._store.validated&&null==e.key){"object"!=typeof e._store&&i(!1,"React Component in warnForMissingKey should have a _store. This error is likely caused by a bug in React. Please file an issue."),e._store.validated=!0;var t='Each child in an array or iterator should have a unique "key" prop. See https://fb.me/react-warning-keys for more information.'+(cm()||"");mm[t]||(mm[t]=!0,E(!1,'Each child in an array or iterator should have a unique "key" prop. See https://fb.me/react-warning-keys for more information.%s',cm()))}};var gm=Array.isArray;function bm(e,t,n){var o=n.ref;if(null!==o&&"function"!=typeof o&&"object"!=typeof o){if(e.mode&gu){var r=In(e)||"Component";pm[r]||(E(!1,'A string ref, "%s", has been found within a strict mode tree. String refs are a source of potential bugs and should be avoided. We recommend using createRef() instead.\n%s\n\nLearn more about using refs safely here:\nhttps://fb.me/react-strict-mode-string-ref',o,Fn(e)),pm[r]=!0)}if(n._owner){var a=n._owner,s=void 0;if(a){var l=a;l.tag!==q&&i(!1,"Stateless function components cannot have refs."),s=l.stateNode}s||i(!1,"Missing owner for string ref %s. This error is likely caused by a bug in React. Please file an issue.",o);var d=""+o;if(null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===d)return t.ref;var c=function(e){var t=s.refs===_a?s.refs={}:s.refs;null===e?delete t[d]:t[d]=e};return c._stringRef=d,c}"string"!=typeof o&&i(!1,"Expected ref to be a function or a string."),n._owner||i(!1,"Element ref was specified as a string (%s) but no owner was set. This could happen for one of the following reasons:\n1. You may be adding a ref to a functional component\n2. You may be adding a ref to a component that was not created inside a component's render method\n3. You have multiple copies of React loaded\nSee https://fb.me/react-refs-must-have-owner for more information.",o)}return o}function vm(e,t){if("textarea"!==e.type){var n="";n=" If you meant to render a collection of children, use an array instead."+(cm()||""),i(!1,"Objects are not valid as a React child (found: %s).%s","[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,n)}}function ym(){var e="Functions are not valid as a React child. This may happen if you return a Component instead of <Component /> from render. Or maybe you meant to call this function rather than return it."+(cm()||"");hm[e]||(hm[e]=!0,E(!1,"Functions are not valid as a React child. This may happen if you return a Component instead of <Component /> from render. Or maybe you meant to call this function rather than return it.%s",cm()||""))}function xm(e){function t(t,i){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i,i.nextEffect=null,i.effectTag=cr}}function n(i,n){if(!e)return null;for(var o=n;null!==o;)t(i,o),o=o.sibling;return null}function o(e,t){for(var i=new Map,n=t;null!==n;)null!==n.key?i.set(n.key,n):i.set(n.index,n),n=n.sibling;return i}function r(e,t,i){var n=Eu(e,t,i);return n.index=0,n.sibling=null,n}function a(t,i,n){if(t.index=n,!e)return i;var o=t.alternate;if(null!==o){var r=o.index;return r<i?(t.effectTag=sr,i):r}return t.effectTag=sr,i}function s(t){return e&&null===t.alternate&&(t.effectTag=sr),t}function l(e,t,i,n){if(null===t||t.tag!==W){var o=Tu(i,e.mode,n);return o.return=e,o}var a=r(t,i,n);return a.return=e,a}function d(e,t,i,n){if(null!==t&&t.type===i.type){var o=r(t,i.props,n);return o.ref=bm(e,t,i),o.return=e,o._debugSource=i._source,o._debugOwner=i._owner,o}var a=Pu(i,e.mode,n);return a.ref=bm(e,t,i),a.return=e,a}function c(e,t,i,n){if(null===t||t.tag!==X||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation){var o=Su(i,e.mode,n);return o.return=e,o}var a=r(t,i.children||[],n);return a.return=e,a}function u(e,t,i,n,o){if(null===t||t.tag!==Y){var a=_u(i,e.mode,n,o);return a.return=e,a}var s=r(t,i,n);return s.return=e,s}function p(e,t,i){if("string"==typeof t||"number"==typeof t){var n=Tu(""+t,e.mode,i);return n.return=e,n}if("object"==typeof t&&null!==t){switch(t.$$typeof){case yn:var o=Pu(t,e.mode,i);return o.ref=bm(e,null,t),o.return=e,o;case xn:var r=Su(t,e.mode,i);return r.return=e,r}if(gm(t)||$n(t)){var a=_u(t,e.mode,i,null);return a.return=e,a}vm(e,t)}return"function"==typeof t&&ym(),null}function m(e,t,i,n){var o=null!==t?t.key:null;if("string"==typeof i||"number"==typeof i)return null!==o?null:l(e,t,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case yn:return i.key===o?i.type===zn?u(e,t,i.props.children,n,o):d(e,t,i,n):null;case xn:return i.key===o?c(e,t,i,n):null}if(gm(i)||$n(i))return null!==o?null:u(e,t,i,n,null);vm(e,i)}return"function"==typeof i&&ym(),null}function h(e,t,i,n,o){if("string"==typeof n||"number"==typeof n){var r=e.get(i)||null;return l(t,r,""+n,o)}if("object"==typeof n&&null!==n){switch(n.$$typeof){case yn:var a=e.get(null===n.key?i:n.key)||null;return n.type===zn?u(t,a,n.props.children,o,n.key):d(t,a,n,o);case xn:var s=e.get(null===n.key?i:n.key)||null;return c(t,s,n,o)}if(gm(n)||$n(n)){var p=e.get(i)||null;return u(t,p,n,o,null)}vm(t,n)}return"function"==typeof n&&ym(),null}function f(e,t){if("object"!=typeof e||null===e)return t;switch(e.$$typeof){case yn:case xn:fm(e);var i=e.key;if("string"!=typeof i)break;if(null===t){(t=new Set).add(i);break}if(!t.has(i)){t.add(i);break}E(!1,"Encountered two children with the same key, `%s`. Keys should be unique so that components maintain their identity across updates. Non-unique keys may cause children to be duplicated and/or omitted  the behavior is unsupported and could change in a future version.%s",i,cm())}return t}return function(l,d,c,u){var g="object"==typeof c&&null!==c&&c.type===zn&&null===c.key;g&&(c=c.props.children);var b="object"==typeof c&&null!==c;if(b)switch(c.$$typeof){case yn:return s(function(e,i,o,a){var s=o.key,l=i;for(;null!==l;){if(l.key===s){if(l.tag===Y?o.type===zn:l.type===o.type){n(e,l.sibling);var d=r(l,o.type===zn?o.props.children:o.props,a);return d.ref=bm(e,l,o),d.return=e,d._debugSource=o._source,d._debugOwner=o._owner,d}n(e,l);break}t(e,l),l=l.sibling}{if(o.type===zn){var c=_u(o.props.children,e.mode,a,o.key);return c.return=e,c}var u=Pu(o,e.mode,a);return u.ref=bm(e,i,o),u.return=e,u}}(l,d,c,u));case xn:return s(function(e,i,o,a){var s=o.key,l=i;for(;null!==l;){if(l.key===s){if(l.tag===X&&l.stateNode.containerInfo===o.containerInfo&&l.stateNode.implementation===o.implementation){n(e,l.sibling);var d=r(l,o.children||[],a);return d.return=e,d}n(e,l);break}t(e,l),l=l.sibling}var c=Su(o,e.mode,a);return c.return=e,c}(l,d,c,u))}if("string"==typeof c||"number"==typeof c)return s(function(e,t,i,o){if(null!==t&&t.tag===W){n(e,t.sibling);var a=r(t,i,o);return a.return=e,a}n(e,t);var s=Tu(i,e.mode,o);return s.return=e,s}(l,d,""+c,u));if(gm(c))return function(i,r,s,l){for(var d=null,c=0;c<s.length;c++){var u=s[c];d=f(u,d)}for(var g=null,b=null,v=r,y=0,x=0,z=null;null!==v&&x<s.length;x++){v.index>x?(z=v,v=null):z=v.sibling;var C=m(i,v,s[x],l);if(null===C){null===v&&(v=z);break}e&&v&&null===C.alternate&&t(i,v),y=a(C,y,x),null===b?g=C:b.sibling=C,b=C,v=z}if(x===s.length)return n(i,v),g;if(null===v){for(;x<s.length;x++){var w=p(i,s[x],l);w&&(y=a(w,y,x),null===b?g=w:b.sibling=w,b=w)}return g}for(var E=o(i,v);x<s.length;x++){var P=h(E,i,x,s[x],l);P&&(e&&null!==P.alternate&&E.delete(null===P.key?x:P.key),y=a(P,y,x),null===b?g=P:b.sibling=P,b=P)}e&&E.forEach(function(e){return t(i,e)});return g}(l,d,c,u);if($n(c))return function(r,s,l,d){var c=$n(l);"function"!=typeof c&&i(!1,"An object is not an iterable. This error is likely caused by a bug in React. Please file an issue."),l.entries===c&&(um||E(!1,"Using Maps as children is unsupported and will likely yield unexpected results. Convert it to a sequence/iterable of keyed ReactElements instead.%s",cm()),um=!0);var u=c.call(l);if(u)for(var g=null,b=u.next();!b.done;b=u.next()){var v=b.value;g=f(v,g)}var y=c.call(l);null==y&&i(!1,"An iterable object provided no iterator.");for(var x=null,z=null,C=s,w=0,P=0,_=null,T=y.next();null!==C&&!T.done;P++,T=y.next()){C.index>P?(_=C,C=null):_=C.sibling;var S=m(r,C,T.value,d);if(null===S){C||(C=_);break}e&&C&&null===S.alternate&&t(r,C),w=a(S,w,P),null===z?x=S:z.sibling=S,z=S,C=_}if(T.done)return n(r,C),x;if(null===C){for(;!T.done;P++,T=y.next()){var R=p(r,T.value,d);null!==R&&(w=a(R,w,P),null===z?x=R:z.sibling=R,z=R)}return x}for(var k=o(r,C);!T.done;P++,T=y.next()){var $=h(k,r,P,T.value,d);null!==$&&(e&&null!==$.alternate&&k.delete(null===$.key?P:$.key),w=a($,w,P),null===z?x=$:z.sibling=$,z=$)}e&&k.forEach(function(e){return t(r,e)});return x}(l,d,c,u);b&&vm(l,c);"function"==typeof c&&ym();if(void 0===c&&!g)switch(l.tag){case q:var v=l.stateNode;if(v.render._isMockFunction)break;case G:var y=l.type;i(!1,"%s(...): Nothing was returned from render. This usually means a return statement is missing. Or, to render nothing, return null.",y.displayName||y.name||"Component")}return n(l,d)}}var zm=xm(!0),Cm=xm(!1);var wm=null,Em=null,Pm=!1;function _m(e,t){switch(e.tag){case H:r=e.stateNode.containerInfo,1===(a=t).nodeType?Ed(r,a):Pd(r,a);break;case j:e.type,i=e.memoizedProps,n=e.stateNode,o=t,!0!==i[$d]&&(1===o.nodeType?Ed(n,o):Pd(n,o))}var i,n,o,r,a,s,l=((s=wu(j,null,null,hu)).type="DELETED",s);l.stateNode=t,l.return=e,l.effectTag=cr,null!==e.lastEffect?(e.lastEffect.nextEffect=l,e.lastEffect=l):e.firstEffect=e.lastEffect=l}function Tm(e,t){switch(t.effectTag|=sr,e.tag){case H:var i=e.stateNode.containerInfo;switch(t.tag){case j:var n=t.type,o=t.pendingProps;_d(i,n,o);break;case W:var r=t.pendingProps;Td(i,r)}break;case j:e.type;var a=e.memoizedProps,s=e.stateNode;switch(t.tag){case j:var l=t.type,d=t.pendingProps;m=s,h=l,f=d,!0!==a[$d]&&_d(m,h,f);break;case W:var c=t.pendingProps;u=s,p=c,!0!==a[$d]&&Td(u,p)}break;default:return}var u,p,m,h,f}function Sm(e,t){switch(e.tag){case j:var i=e.type,n=(e.pendingProps,function(e,t,i){if(e.nodeType!==nn||t.toLowerCase()!==e.nodeName.toLowerCase())return null;return e}(t,i));return null!==n&&(e.stateNode=n,!0);case W:var o=e.pendingProps,r=function(e,t){if(""===t||e.nodeType!==on)return null;return e}(t,o);return null!==r&&(e.stateNode=r,!0);default:return!1}}function Rm(e){if(Pm){var t=Em;if(!t)return Tm(wm,e),Pm=!1,void(wm=e);var i=t;if(!Sm(e,t)){if(!(t=Kd(i))||!Sm(e,t))return Tm(wm,e),Pm=!1,void(wm=e);_m(wm,i)}wm=e,Em=Jd(t)}}function km(e,t,n){Yd||i(!1,"Expected prepareToHydrateHostInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");var o=e.stateNode,r=function(e,t,i,n,o,r){Rd(r,e),kd(e,i);var a=void 0;return a=o.namespace,zd(e,t,i,a,n)}(o,e.type,e.memoizedProps,t,n,e);return e.updateQueue=r,null!==r}function $m(e){Yd||i(!1,"Expected prepareToHydrateHostTextInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");var t,n,o,r,a=e.stateNode,s=e.memoizedProps,l=(n=s,Rd(e,t=a),Cd(t,n));if(l){var d=wm;if(null!==d)switch(d.tag){case H:d.stateNode.containerInfo;wd(a,s);break;case j:d.type;var c=d.memoizedProps;d.stateNode;o=a,r=s,!0!==c[$d]&&wd(o,r)}}return l}function Im(e){for(var t=e.return;null!==t&&t.tag!==j&&t.tag!==H;)t=t.return;wm=t}function Mm(e){if(!Yd)return!1;if(e!==wm)return!1;if(!Pm)return Im(e),Pm=!0,!1;var t=e.type;if(e.tag!==j||"head"!==t&&"body"!==t&&!Od(t,e.memoizedProps))for(var i=Em;i;)_m(e,i),i=Kd(i);return Im(e),Em=wm?Kd(e.stateNode):null,!0}function Fm(){Yd&&(wm=null,Em=null,Pm=!1)}var Dm=Nn.getCurrentFiberStackAddendum,Nm=void 0,Om=void 0,Am=void 0;function Vm(e,t,i){Bm(e,t,i,t.expirationTime)}function Bm(e,t,i,n){t.child=null===e?Cm(t,null,i,n):zm(t,e.child,i,n)}function Lm(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.effectTag|=hr)}function Um(e,t,i){var n=nu(t),o=void 0;return null===e?null===t.stateNode?(sm(t,t.pendingProps,i),dm(t,i),o=!0):o=function(e,t){var i=e.type,n=e.stateNode,o=e.memoizedProps,r=e.pendingProps;n.props=o;var a=n.context,s=Wc(e),l=Kc(e,s),d=i.getDerivedStateFromProps,c="function"==typeof d||"function"==typeof n.getSnapshotBeforeUpdate;c||"function"!=typeof n.UNSAFE_componentWillReceiveProps&&"function"!=typeof n.componentWillReceiveProps||o===r&&a===l||lm(e,n,r,l);bp();var u=e.memoizedState,p=n.state=u,m=e.updateQueue;null!==m&&(fp(e,m,r,n,t),p=e.memoizedState);if(o===r&&u===p&&!Jc()&&!vp())return"function"==typeof n.componentDidMount&&(e.effectTag|=lr),!1;"function"==typeof d&&(nm(e,d,r),p=e.memoizedState);var h=vp()||rm(e,o,r,u,p,l);h?(c||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(Dc(e,"componentWillMount"),"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),Nc()),"function"==typeof n.componentDidMount&&(e.effectTag|=lr)):("function"==typeof n.componentDidMount&&(e.effectTag|=lr),e.memoizedProps=r,e.memoizedState=p);return n.props=r,n.state=p,n.context=l,h}(t,i):o=function(e,t,i){var n=t.type,o=t.stateNode,r=t.memoizedProps,a=t.pendingProps;o.props=r;var s=o.context,l=Wc(t),d=Kc(t,l),c=n.getDerivedStateFromProps,u="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;u||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||r===a&&s===d||lm(t,o,a,d);bp();var p=t.memoizedState,m=o.state=p,h=t.updateQueue;null!==h&&(fp(t,h,a,o,i),m=t.memoizedState);if(r===a&&p===m&&!Jc()&&!vp())return"function"==typeof o.componentDidUpdate&&(r===e.memoizedProps&&p===e.memoizedState||(t.effectTag|=lr)),"function"==typeof o.getSnapshotBeforeUpdate&&(r===e.memoizedProps&&p===e.memoizedState||(t.effectTag|=fr)),!1;"function"==typeof c&&(nm(t,c,a),m=t.memoizedState);var f=vp()||rm(t,r,a,p,m,d);f?(u||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||(Dc(t,"componentWillUpdate"),"function"==typeof o.componentWillUpdate&&o.componentWillUpdate(a,m,d),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(a,m,d),Nc()),"function"==typeof o.componentDidUpdate&&(t.effectTag|=lr),"function"==typeof o.getSnapshotBeforeUpdate&&(t.effectTag|=fr)):("function"==typeof o.componentDidUpdate&&(r===e.memoizedProps&&p===e.memoizedState||(t.effectTag|=lr)),"function"==typeof o.getSnapshotBeforeUpdate&&(r===e.memoizedProps&&p===e.memoizedState||(t.effectTag|=fr)),t.memoizedProps=a,t.memoizedState=m);return o.props=a,o.state=m,o.context=d,f}(e,t,i),Gm(e,t,o,n,i)}function Gm(e,t,i,n,o){Lm(e,t);var r=(t.effectTag&mr)!==rr;if(!i&&!r)return n&&ou(t,!1),Wm(e,t);var a=t.type,s=t.stateNode;fn.current=t;var l,d,c=void 0;return!r||Qd&&"function"==typeof a.getDerivedStateFromCatch?(Nn.setCurrentPhase("render"),c=s.render(),(tc||ic&&t.mode&gu)&&s.render(),Nn.setCurrentPhase(null)):(c=null,ac&&Xp()),t.effectTag|=ar,r&&(Bm(e,t,null,o),t.child=null),Bm(e,t,c,o),l=t,d=s.state,l.memoizedState=d,Ym(t,s.props),n&&ou(t,!0),t.child}function qm(e){var t=e.stateNode;t.pendingContext?tu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tu(e,t.context,!1),Mp(e,t.containerInfo)}function Hm(e,t,i){qm(t);var n=t.updateQueue;if(null!==n){var o=t.pendingProps,r=t.memoizedState,a=null!==r?r.element:null;fp(t,n,o,null,i);var s=t.memoizedState,l=s.element;if(l===a)return Fm(),Wm(e,t);var d=t.stateNode;return(null===e||null===e.child)&&d.hydrate&&function(e){if(!Yd)return!1;var t=e.stateNode.containerInfo;return Em=Jd(t),wm=e,Pm=!0,!0}(t)?(t.effectTag|=sr,t.child=Cm(t,null,l,i)):(Fm(),Vm(e,t,l)),t.child}return Fm(),Wm(e,t)}function Xm(e,t,i,n){var o=e.child;for(null!==o&&(o.return=e);null!==o;){var r=void 0;switch(o.tag){case J:var a=0|o.stateNode;if(o.type===t&&0!=(a&i)){for(var s=o;null!==s;){var l=s.alternate;if(s.expirationTime===au||s.expirationTime>n)s.expirationTime=n,null!==l&&(l.expirationTime===au||l.expirationTime>n)&&(l.expirationTime=n);else{if(null===l||!(l.expirationTime===au||l.expirationTime>n))break;l.expirationTime=n}s=s.return}r=null}else r=o.child;break;case Z:r=o.type===e.type?null:o.child;break;default:r=o.child}if(null!==r)r.return=o;else for(r=o;null!==r;){if(r===e){r=null;break}var d=r.sibling;if(null!==d){d.return=r.return,r=d;break}r=r.return}o=r}}function jm(e,t,i){var n,o,r=t.type,a=t.pendingProps,s=t.memoizedProps,l=(n=r,Ld?n._currentValue:n._currentValue2),d=(o=r,Ld?o._changedBits:o._changedBits2);if(Jc());else if(0===d&&s===a)return Wm(e,t);t.memoizedProps=a;var c=a.unstable_observedBits;if(null==c&&(c=ru),t.stateNode=c,0!=(d&c))Xm(t,r,d,i);else if(s===a)return Wm(e,t);var u=a.children;"function"!=typeof u&&E(!1,"A context consumer was rendered with multiple children, or a child that isn't a function. A context consumer expects a single child that is a function. If you did pass a function, make sure there is no trailing or leading whitespace around it.");var p=void 0;return fn.current=t,Nn.setCurrentPhase("render"),p=u(l),Nn.setCurrentPhase(null),t.effectTag|=ar,Vm(e,t,p),t.child}function Wm(e,t){return Ic(t),ac&&Xp(),function(e,t){if(null!==e&&t.child!==e.child&&i(!1,"Resuming work not yet implemented."),null===t.child)return;var n=t.child,o=Eu(n,n.pendingProps,n.expirationTime);t.child=o,o.return=t;for(;null!==n.sibling;)n=n.sibling,(o=o.sibling=Eu(n,n.pendingProps,n.expirationTime)).return=t;o.sibling=null}(e,t),t.child}function Ym(e,t){e.memoizedProps=t}function Km(e,t,n){if(ac&&t.mode&bu&&function(e){if(!ac)return;Vp.push(e),e.actualDuration=Bd()-e.actualDuration-Lp,e.actualStartTime=Bd()}(t),t.expirationTime===au||t.expirationTime>n)return function(e,t){Ic(t),ac&&Xp();switch(t.tag){case H:qm(t);break;case q:nu(t);break;case X:Mp(t,t.stateNode.containerInfo);break;case Z:Pp(t)}return null}(0,t);switch(t.tag){case U:return function(e,t,n){null!==e&&i(!1,"An indeterminate component should never have mounted. This error is likely caused by a bug in React. Please file an issue.");var o=t.type,r=t.pendingProps,a=Wc(t),s=Kc(t,a),l=void 0;if(o.prototype&&"function"==typeof o.prototype.render){var d=In(t)||"Unknown";Nm[d]||(E(!1,"The <%s /> component appears to have a render method, but doesn't extend React.Component. This is likely to cause errors. Change %s to extend React.Component instead.",d,d),Nm[d]=!0)}t.mode&gu&&Au.recordLegacyContextWarning(t,null);{if(fn.current=t,l=o(r,s),t.effectTag|=ar,"object"==typeof l&&null!==l&&"function"==typeof l.render&&void 0===l.$$typeof){var c=t.type;t.tag=q,t.memoizedState=null!==l.state&&void 0!==l.state?l.state:null;var u=c.getDerivedStateFromProps;"function"==typeof u&&nm(t,u,r);var p=nu(t);return am(t,l),dm(t,n),Gm(e,t,!0,p,n)}t.tag=G;var m=t.type;if(m&&m.childContextTypes&&E(!1,"%s(...): childContextTypes cannot be defined on a functional component.",m.displayName||m.name||"Component"),null!==t.ref){var h="",f=Nn.getCurrentFiberOwnerName();f&&(h+="\n\nCheck the render method of `"+f+"`.");var g=f||t._debugID||"",b=t._debugSource;b&&(g=b.fileName+":"+b.lineNumber),Am[g]||(Am[g]=!0,E(!1,"Stateless function components cannot be given refs. Attempts to access this ref will fail.%s%s",h,Nn.getCurrentFiberStackAddendum()))}if("function"==typeof o.getDerivedStateFromProps){var v=In(t)||"Unknown";Om[v]||(E(!1,"%s: Stateless functional components do not support getDerivedStateFromProps.",v),Om[v]=!0)}return Vm(e,t,l),Ym(t,r),t.child}}(e,t,n);case G:return function(e,t){var i=t.type,n=t.pendingProps;if(Jc());else if(t.memoizedProps===n)return Wm(e,t);var o=Wc(t),r=Kc(t,o),a=void 0;return fn.current=t,Nn.setCurrentPhase("render"),a=i(n,r),Nn.setCurrentPhase(null),t.effectTag|=ar,Vm(e,t,a),Ym(t,n),t.child}(e,t);case q:return Um(e,t,n);case H:return Hm(e,t,n);case j:return function(e,t,i){Np(t),null===e&&Rm(t);var n=t.type,o=t.memoizedProps,r=t.pendingProps,a=null!==e?e.memoizedProps:null;if(Jc());else if(o===r){var s=t.mode&fu&&Ad(n,r);if(s&&(t.expirationTime=lu),!s||i!==lu)return Wm(e,t)}var l=r.children;Od(n,r)?l=null:a&&Od(n,a)&&(t.effectTag|=ur);if(Lm(e,t),i!==lu&&t.mode&fu&&Ad(n,r))return t.expirationTime=lu,t.memoizedProps=r,null;return Vm(e,t,l),Ym(t,r),t.child}(e,t,n);case W:return function(e,t){null===e&&Rm(t);var i=t.pendingProps;return Ym(t,i),null}(e,t);case te:return function(e,t,i){{if(ec){var n=t.pendingProps,o=t.memoizedProps,r=t.memoizedState,a=(t.effectTag&mr)===rr,s=!a;if(Jc());else if(n===o&&s===r)return Wm(e,t);var l=n.children,d=l(s);return t.memoizedProps=n,t.memoizedState=s,Vm(e,t,d),t.child}return null}}(e,t);case X:return function(e,t,i){Mp(t,t.stateNode.containerInfo);var n=t.pendingProps;if(Jc());else if(t.memoizedProps===n)return Wm(e,t);null===e?(t.child=zm(t,null,n,i),Ym(t,n)):(Vm(e,t,n),Ym(t,n));return t.child}(e,t,n);case Q:return function(e,t){var i=t.type.render,n=t.pendingProps,o=t.ref;if(Jc());else if(t.memoizedProps===n){var r=null!==e?e.ref:null;if(o===r)return Wm(e,t)}var a=void 0;return fn.current=t,Nn.setCurrentPhase("render"),a=i(n,o),Nn.setCurrentPhase(null),Vm(e,t,a),Ym(t,n),t.child}(e,t);case Y:return function(e,t){var i=t.pendingProps;if(Jc());else if(t.memoizedProps===i)return Wm(e,t);return Vm(e,t,i),Ym(t,i),t.child}(e,t);case K:return function(e,t){var i=t.pendingProps.children;if(Jc());else if(null===i||t.memoizedProps===i)return Wm(e,t);return Vm(e,t,i),Ym(t,i),t.child}(e,t);case ee:return function(e,t){var i=t.pendingProps;ac&&(t.effectTag|=lr);if(t.memoizedProps===i)return Wm(e,t);var n=i.children;return Vm(e,t,n),Ym(t,i),t.child}(e,t);case Z:return function(e,t,i){var n=t.type._context,o=t.pendingProps,r=t.memoizedProps,a=!0;if(Jc())a=!1;else if(r===o)return t.stateNode=0,Pp(t),Wm(e,t);var s=o.value;t.memoizedProps=o;var l=t.type.propTypes;l&&po(l,o,"prop","Context.Provider",Dm);var d=void 0;if(null===r)d=ru;else if(r.value===o.value){if(r.children===o.children&&a)return t.stateNode=0,Pp(t),Wm(e,t);d=0}else{var c=r.value;if(c===s&&(0!==c||1/c==1/s)||c!=c&&s!=s){if(r.children===o.children&&a)return t.stateNode=0,Pp(t),Wm(e,t);d=0}else if(((d="function"==typeof n._calculateChangedBits?n._calculateChangedBits(c,s):ru)&ru)!==d&&E(!1,"calculateChangedBits: Expected the return value to be a 31-bit integer. Instead received: %s",d),0===(d|=0)){if(r.children===o.children&&a)return t.stateNode=0,Pp(t),Wm(e,t)}else Xm(t,n,d,i)}t.stateNode=d,Pp(t);var u=o.children;return Vm(e,t,u),t.child}(e,t,n);case J:return jm(e,t,n);default:i(!1,"Unknown unit of work tag. This error is likely caused by a bug in React. Please file an issue.")}}function Jm(e){e.effectTag|=lr}function Zm(e){e.effectTag|=hr}function Qm(e,t){for(var i,n,o=t.child;null!==o;){if(o.tag===j||o.tag===W)i=e,n=o.stateNode,i.appendChild(n);else if(o.tag===X);else if(null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)return;for(;null===o.sibling;){if(null===o.return||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}}Nm={},Om={},Am={};var eh=void 0,th=void 0,ih=void 0;if(qd)eh=function(e){},th=function(e,t,i,n,o,r,a,s){t.updateQueue=i,i&&Jm(t)},ih=function(e,t,i,n){i!==n&&Jm(t)};else if(cd){eh=function(e){var t=e.stateNode,i=null===e.firstEffect;if(i);else{var n=t.containerInfo,o=pd(n);!function(e,t){var i=t.child;for(;null!==i;){if(i.tag===j||i.tag===W)md(e,i.stateNode);else if(i.tag===X);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)return;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}(o,e),t.pendingChildren=o,Jm(e),hd(n,o)}},th=function(e,t,i,n,o,r,a,s){var l=null===t.firstEffect,d=e.stateNode;if(l&&null===i)t.stateNode=d;else{var c=t.stateNode,u=ud(d,i,n,o,r,t,l,c);Nd(u,n,r,a,s)&&Jm(t),t.stateNode=u,l?Jm(t):Qm(u,t)}},ih=function(e,t,i,n){if(i!==n){var o=Ip(),r=Dp();t.stateNode=Vd(n,o,r,t),Jm(t)}}}else eh=function(e){},th=function(e,t,i,n,o,r,a,s){},ih=function(e,t,i,n){};function nh(e,t,n){var o=t.pendingProps;switch(ac&&t.mode&bu&&Gp(t),t.tag){case G:return null;case q:return Qc(t),null;case H:Fp(t),eu(t);var r=t.stateNode;return r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Mm(t),t.effectTag&=~sr),eh(t),null;case j:Op(t);var a=Ip(),s=t.type;if(null!==e&&null!=t.stateNode){var l=e.memoizedProps,d=t.stateNode,c=Dp(),u=function(e,t,i,n,o,r){var a=r;if(typeof n.children!=typeof i.children&&("string"==typeof n.children||"number"==typeof n.children)){var s=""+n.children,l=Sd(a.ancestorInfo,t,null);ld(null,s,l)}return yd(e,t,i,n,o)}(d,s,l,o,a,c);th(e,t,u,s,l,o,a,c),e.ref!==t.ref&&Zm(t)}else{if(!o)return null===t.stateNode&&i(!1,"We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue."),null;var p=Dp(),m=Mm(t);if(m)km(t,a,p)&&Jm(t);else{var h=function(e,t,i,n,o){var r=void 0,a=n;if(ld(e,null,a.ancestorInfo),"string"==typeof t.children||"number"==typeof t.children){var s=""+t.children,l=Sd(a.ancestorInfo,e,null);ld(null,s,l)}r=a.namespace;var d=gd(e,t,i,r);return Rd(o,d),kd(d,t),d}(s,o,a,p,t);Qm(h,t),Nd(h,s,o,a,p)&&Jm(t),t.stateNode=h}null!==t.ref&&Zm(t)}return null;case W:var f=o;if(e&&null!=t.stateNode){var g=e.memoizedProps;ih(e,t,g,f)}else{if("string"!=typeof f)return null===t.stateNode&&i(!1,"We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue."),null;var b=Ip(),v=Dp(),y=Mm(t);y?$m(t)&&Jm(t):t.stateNode=Vd(f,b,v,t)}return null;case Q:case te:case Y:case K:case ee:return null;case X:return Fp(t),eh(t),null;case Z:return _p(t),null;case J:return null;case U:i(!1,"An indeterminate component should have become determinate before completing. This error is likely caused by a bug in React. Please file an issue.");default:i(!1,"Unknown unit of work tag. This error is likely caused by a bug in React. Please file an issue.")}}var oh=a.invokeGuardedCallback,rh=a.hasCaughtError,ah=a.clearCaughtError,sh=null;function lh(e,t){var i=t.source,n=t.stack;null===n&&null!==i&&(n=Fn(i));var o={componentName:null!==i?In(i):null,componentStack:null!==n?n:"",error:t.value,errorBoundary:null,errorBoundaryName:null,errorBoundaryFound:!1,willRetry:!1};null!==e&&e.tag===q&&(o.errorBoundary=e.stateNode,o.errorBoundaryName=In(e),o.errorBoundaryFound=!0,o.willRetry=!0);try{!function(e){0;var t=e.error;if(t&&t.suppressReactErrorLogging)return;var i=e.componentName,n=e.componentStack,o=e.errorBoundaryName,r=e.errorBoundaryFound,a=e.willRetry,s=void 0;s=r&&o?a?"React will try to recreate this component tree from scratch using the error boundary you provided, "+o+".":"This error was initially handled by the error boundary "+o+".\nRecreating the tree from scratch failed so React will unmount the tree.":"Consider adding an error boundary to your tree to customize error handling behavior.\nVisit https://fb.me/react-error-boundaries to learn more about error boundaries.";var l=(i?"The above error occurred in the <"+i+"> component:":"The above error occurred in one of your React components:")+n+"\n\n"+s;console.error(l)}(o)}catch(e){var r=e&&e.suppressReactErrorLogging;r||console.error(e)}}sh=new Set;var dh=function(e,t){Dc(e,"componentWillUnmount"),t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount(),Nc()};function ch(e){var t=e.ref;if(null!==t)if("function"==typeof t){if(oh(null,t,null,null),rh()){var i=ah();gf(e,i)}}else t.current=null}function uh(e,t){switch(t.tag){case q:if(t.effectTag&fr&&null!==e){var n=e.memoizedProps,o=e.memoizedState;Dc(t,"getSnapshotBeforeUpdate");var r=t.stateNode;r.props=t.memoizedProps,r.state=t.memoizedState;var a=r.getSnapshotBeforeUpdate(n,o),s=sh;void 0!==a||s.has(t.type)||(s.add(t.type),E(!1,"%s.getSnapshotBeforeUpdate(): A snapshot value (or null) must be returned. You have returned undefined.",In(t))),r.__reactInternalSnapshotBeforeUpdate=a,Nc()}return;case H:case j:case W:case X:return;default:i(!1,"This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}}function ph(e,t,n,o,r){switch(n.tag){case q:var a=n.stateNode;if(n.effectTag&lr)if(null===t)Dc(n,"componentDidMount"),a.props=n.memoizedProps,a.state=n.memoizedState,a.componentDidMount(),Nc();else{var s=t.memoizedProps,l=t.memoizedState;Dc(n,"componentDidUpdate"),a.props=n.memoizedProps,a.state=n.memoizedState,a.componentDidUpdate(s,l,a.__reactInternalSnapshotBeforeUpdate),Nc()}var d=n.updateQueue;return void(null!==d&&(a.props=n.memoizedProps,a.state=n.memoizedState,yp(n,d,a,r)));case H:var c=n.updateQueue;if(null!==c){var u=null;if(null!==n.child)switch(n.child.tag){case j:u=Dd(n.child.stateNode);break;case q:u=n.child.stateNode}yp(n,c,u,r)}return;case j:var p=n.stateNode;if(null===t&&n.effectTag&lr){var m=n.type,h=n.memoizedProps;f=p,Fd(m,h)&&f.focus()}return;case W:case X:case ee:case te:return;default:i(!1,"This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}var f}function mh(e){var t=e.ref;if(null!==t){var i=e.stateNode,n=void 0;switch(e.tag){case j:n=Dd(i);break;default:n=i}"function"==typeof t?t(n):(t.hasOwnProperty("current")||E(!1,"Unexpected ref object provided for %s. Use either a ref-setter function or React.createRef().%s",In(e),Fn(e)),t.current=n)}}function hh(e){var t=e.ref;null!==t&&("function"==typeof t?t(null):t.current=null)}function fh(e){switch(Nu(e),e.tag){case q:ch(e);var t=e.stateNode;return void("function"==typeof t.componentWillUnmount&&function(e,t){if(oh(null,dh,null,e,t),rh()){var i=ah();gf(e,i)}}(e,t));case j:return void ch(e);case X:return void(qd?yh(e):cd&&function(e){if(!cd)return;var t=e.stateNode.containerInfo,i=pd(t);fd(t,i)}(e))}}function gh(e){for(var t=e;;)if(fh(t),null===t.child||qd&&t.tag===X){if(t===e)return;for(;null===t.sibling;){if(null===t.return||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}else t.child.return=t,t=t.child}function bh(e){return e.tag===j||e.tag===H||e.tag===X}function vh(e){if(qd){var t=function(e){var t=e.return;for(;null!==t;){if(bh(t))return t;t=t.return}i(!1,"Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.")}(e),n=void 0,o=void 0;switch(t.tag){case j:n=t.stateNode,o=!1;break;case H:case X:n=t.stateNode.containerInfo,o=!0;break;default:i(!1,"Invalid host parent fiber. This error is likely caused by a bug in React. Please file an issue.")}t.effectTag&ur&&(Hd(n),t.effectTag&=~ur);for(var r,a,s,l,d,c=function(e){var t=e;e:for(;;){for(;null===t.sibling;){if(null===t.return||bh(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==j&&t.tag!==W;){if(t.effectTag&sr)continue e;if(null===t.child||t.tag===X)continue e;t.child.return=t,t=t.child}if(!(t.effectTag&sr))return t.stateNode}}(e),u=e;;){if(u.tag===j||u.tag===W)c?o?jd(n,u.stateNode,c):(s=n,l=u.stateNode,d=c,s.insertBefore(l,d)):o?Xd(n,u.stateNode):(r=n,a=u.stateNode,r.appendChild(a));else if(u.tag===X);else if(null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)return;for(;null===u.sibling;){if(null===u.return||u.return===e)return;u=u.return}u.sibling.return=u.return,u=u.sibling}}}function yh(e){for(var t,n,o=e,r=!1,a=void 0,s=void 0;;){if(!r){var l=o.return;e:for(;;){switch(null===l&&i(!1,"Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue."),l.tag){case j:a=l.stateNode,s=!1;break e;case H:case X:a=l.stateNode.containerInfo,s=!0;break e}l=l.return}r=!0}if(o.tag===j||o.tag===W)gh(o),s?Wd(a,o.stateNode):(t=a,n=o.stateNode,t.removeChild(n));else if(o.tag===X){if(a=o.stateNode.containerInfo,null!==o.child){o.child.return=o,o=o.child;continue}}else if(fh(o),null!==o.child){o.child.return=o,o=o.child;continue}if(o===e)return;for(;null===o.sibling;){if(null===o.return||o.return===e)return;(o=o.return).tag===X&&(r=!1)}o.sibling.return=o.return,o=o.sibling}}function xh(e){var t;qd?yh(e):gh(e),(t=e).return=null,t.child=null,t.alternate&&(t.alternate.child=null,t.alternate.return=null)}function zh(e,t){var n,o,r,a,s,l;if(qd)switch(t.tag){case q:return;case j:var d=t.stateNode;if(null!=d){var c=t.memoizedProps,u=null!==e?e.memoizedProps:c,p=t.type,m=t.updateQueue;t.updateQueue=null,null!==m&&(r=m,a=p,s=u,kd(o=d,l=c),xd(o,r,a,s,l))}return;case W:null===t.stateNode&&i(!1,"This should have a text node initialized. This error is likely caused by a bug in React. Please file an issue.");var h=t.stateNode,f=t.memoizedProps;null!==e&&e.memoizedProps;return n=f,void(h.nodeValue=n);case H:return;case ee:if(ac){var g=t.memoizedProps.onRender;g(t.memoizedProps.id,null===e?"mount":"update",t.actualDuration,t.treeBaseTime,t.actualStartTime,Ap)}return;case te:return;default:i(!1,"This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}else!function(e){if(!cd)return;switch(e.tag){case q:case j:case W:return;case H:case X:var t=e.stateNode,n=t.containerInfo,o=t.pendingChildren;return void fd(n,o);default:i(!1,"This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}}(t)}function Ch(e){qd&&Hd(e.stateNode)}function wh(e,t,i){var n=dp(i);n.tag=ip,n.payload={element:null};var o=t.value;return n.callback=function(){tg(o),lh(e,t)},n}function Eh(e,t,i){var n=dp(i);n.tag=ip;var o=e.type.getDerivedStateFromCatch;if(Qd&&"function"==typeof o){var r=t.value;n.payload=function(){return o(r)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){var i;Qd&&"function"===o||(i=this,null===Jh?Jh=new Set([i]):Jh.add(i));var n=t.value,r=t.stack;lh(e,t),this.componentDidCatch(n,{componentStack:null!==r?r:""})}),n}function Ph(e){var t=Cf(),i=yf(t,e),n=dp(i);up(e,n,i),zf(e,i)}function _h(e,t,i,n,o,r,a){if(i.effectTag|=br,i.firstEffect=i.lastEffect=null,ec&&null!==n&&"object"==typeof n&&"function"==typeof n.then){var s=n,l=pu(r),d=l-5e3,c=a-d;c<0&&(c=0);var u=l-a,p=t,m=-1;e:do{if(p.tag===te){var h=p.alternate;if(null!==h&&!0===h.memoizedState){m=0;break e}var f=p.pendingProps.ms;if("number"==typeof f){if(f<=0){m=0;break e}(-1===m||f<m)&&(m=f)}else-1===m&&(m=u)}p=p.return}while(null!==p);var g=m-c;if(r===lu||g>0){(x=g)>=0&&Xh<x&&(Xh=x);var b=function(){xf(e,r)};return void s.then(b,b)}p=t;do{switch(p.tag){case H:var v=r===su?"A synchronous update was suspended, but no fallback UI was provided.":"An update was suspended for longer than the timeout, but no fallback UI was provided.";n=new Error(v);break;case te:if((p.effectTag&mr)===rr){p.effectTag|=vr;var y=Ph.bind(null,p);return void s.then(y,y)}}p=p.return}while(null!==p)}var x;n=xp(n,i);var z=t;do{switch(z.tag){case H:var C=n;z.effectTag|=vr;var w=wh(z,C,r);return void pp(z,w,r);case q:var E=n,P=z.type,_=z.stateNode;if((z.effectTag&mr)===rr&&("function"==typeof P.getDerivedStateFromCatch&&Qd||null!==_&&"function"==typeof _.componentDidCatch&&!df(_))){z.effectTag|=vr;var T=Eh(z,E,r);return void pp(z,T,r)}}z=z.return}while(null!==z)}function Th(e,t,i){switch(ac&&e.mode&bu&&Gp(e),e.tag){case q:Qc(e);var n=e.effectTag;return n&vr?(e.effectTag=n&~vr|mr,e):null;case H:Fp(e),eu(e);var o=e.effectTag;return o&vr?(e.effectTag=o&~vr|mr,e):null;case j:return Op(e),null;case te:var r=e.effectTag;return r&vr?(e.effectTag=r&~vr|mr,e):null;case X:return Fp(e),null;case Z:return _p(e),null;default:return null}}function Sh(e){switch(ac&&e.mode&bu&&(qp(),Gp(e)),e.tag){case q:Qc(e);break;case H:Fp(e),eu(e);break;case j:Op(e);break;case X:Fp(e);break;case Z:_p(e)}}var Rh=a.invokeGuardedCallback,kh=a.hasCaughtError,$h=a.clearCaughtError,Ih=void 0,Mh=void 0,Fh=void 0,Dh=void 0;Ih=!1,Mh=!1;var Nh={};Fh=function(e){var t=In(e)||"ReactClass";Nh[t]||(E(!1,"Can't call setState (or forceUpdate) on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in the componentWillUnmount method.%s",Fn(e)),Nh[t]=!0)},Dh=function(e){switch(Nn.phase){case"getChildContext":if(Mh)return;E(!1,"setState(...): Cannot call setState() inside getChildContext()"),Mh=!0;break;case"render":if(Ih)return;E(!1,"Cannot update during an existing state transition (such as within `render` or another component's constructor). Render methods should be a pure function of props and state; constructor side-effects are an anti-pattern, but can be moved to `componentWillMount`."),Ih=!0}};var Oh=Bd(),Ah=uu(0),Vh=Oh,Bh=0,Lh=au,Uh=!1,Gh=null,qh=null,Hh=au,Xh=-1,jh=!1,Wh=null,Yh=!1,Kh=!1,Jh=null,Zh=null,Qh=void 0,ef=void 0,tf=void 0,nf=void 0,of=void 0;nc&&(Qh=null,tf=!1,nf=null,ef=function(e,t,i){if(null===t||"object"!=typeof t||"function"!=typeof t.then)if(null!==Qh){switch(Ru(e,Qh),e.tag){case H:Fp(e),eu(e);break;case j:Op(e);break;case q:Qc(e);break;case X:Fp(e);break;case Z:_p(e)}tf=!0,nf=t,Rh(null,hf,null,i),tf=!1,nf=null,kh()?($h(),ac&&(e.mode&bu&&Gp(e),Xp())):Gh=e}else E(!1,"Could not replay rendering after an error. This is likely a bug in React. Please file an issue.")},of=function(){throw nf});function rf(){if(null!==Gh)for(var e=Gh.return;null!==e;)Sh(e),e=e.return;Au.discardPendingWarnings(),-1!==Bc&&E(!1,"Expected an empty stack. Something was not reset properly."),qh=null,Hh=au,Xh=-1,jh=!1,Gh=null,Kh=!1}function af(){for(;null!==Wh;){Nn.setCurrentFiber(Wh),$c();var e=Wh.effectTag;if(e&ur&&Ch(Wh),e&hr){var t=Wh.alternate;null!==t&&hh(t)}var i=e&(sr|lr|cr);switch(i){case sr:vh(Wh),Wh.effectTag&=~sr;break;case dr:vh(Wh),Wh.effectTag&=~sr;var n=Wh.alternate;zh(n,Wh);break;case lr:var o=Wh.alternate;zh(o,Wh);break;case cr:xh(Wh)}Wh=Wh.nextEffect}Nn.resetCurrentFiber()}function sf(){for(;null!==Wh;){var e=Wh.effectTag;if(e&fr){$c();var t=Wh.alternate;uh(t,Wh)}Wh=Wh.nextEffect}}function lf(e,t,i){for(Au.flushPendingUnsafeLifecycleWarnings(),oc&&Au.flushPendingDeprecationWarnings(),rc&&Au.flushLegacyContextWarning();null!==Wh;){var n=Wh.effectTag;if(n&(lr|pr)){$c();var o=Wh.alternate;ph(e,o,Wh,t,i)}n&hr&&($c(),mh(Wh));var r=Wh.nextEffect;Wh.nextEffect=null,Wh=r}}function df(e){return null!==Jh&&Jh.has(e)}function cf(e){Uh=!0,Yh=!0,function(){if(Zd){if(!sc)return;uc=!0,pc=!1,bc.clear(),yc("(Committing Changes)")}}();var t=e.stateNode;t.current===e&&i(!1,"Cannot commit the same tree as before. This is probably a bug related to the return field. This error is likely caused by a bug in React. Please file an issue.");var n=t.pendingCommitExpirationTime;n===au&&i(!1,"Cannot commit an incomplete root. This error is likely caused by a bug in React. Please file an issue."),t.pendingCommitExpirationTime=au;var o=Cf();fn.current=null;var r=void 0;for(e.effectTag>ar?null!==e.lastEffect?(e.lastEffect.nextEffect=e,r=e.firstEffect):r=e:r=e.firstEffect,t.containerInfo,Id=Jr(),Md=fa(),Kr(!1),Wh=r,function(){if(Zd){if(!sc)return;fc=0,yc("(Committing Snapshot Effects)")}}();null!==Wh;){var a=!1,s=void 0;Rh(null,sf,null),kh()&&(a=!0,s=$h()),a&&(null===Wh&&i(!1,"Should have next effect. This error is likely caused by a bug in React. Please file an issue."),gf(Wh,s),null!==Wh&&(Wh=Wh.nextEffect))}for(!function(){if(Zd){if(!sc)return;var e=fc;fc=0,xc("(Committing Snapshot Effects: "+e+" Total)","(Committing Snapshot Effects)",null)}}(),ac&&function(){if(!ac)return;Ap=Bd()}(),Wh=r,function(){if(Zd){if(!sc)return;fc=0,yc("(Committing Host Effects)")}}();null!==Wh;){var l=!1,d=void 0;Rh(null,af,null),kh()&&(l=!0,d=$h()),l&&(null===Wh&&i(!1,"Should have next effect. This error is likely caused by a bug in React. Please file an issue."),gf(Wh,d),null!==Wh&&(Wh=Wh.nextEffect))}for(!function(){if(Zd){if(!sc)return;var e=fc;fc=0,xc("(Committing Host Effects: "+e+" Total)","(Committing Host Effects)",null)}}(),t.containerInfo,ga(Md),Md=null,Kr(Id),Id=null,t.current=e,Wh=r,function(){if(Zd){if(!sc)return;fc=0,yc("(Calling Lifecycle Methods)")}}();null!==Wh;){var c=!1,u=void 0;Rh(null,lf,null,t,o,n),kh()&&(c=!0,u=$h()),c&&(null===Wh&&i(!1,"Should have next effect. This error is likely caused by a bug in React. Please file an issue."),gf(Wh,u),null!==Wh&&(Wh=Wh.nextEffect))}ac&&(function(){if(!ac)return;0!==Vp.length&&E(!1,"Expected an empty stack. Something was not reset properly.")}(),function(){if(!ac)return;Lp=0}()),Yh=!1,Uh=!1,function(){if(Zd){if(!sc)return;var e=fc;fc=0,xc("(Calling Lifecycle Methods: "+e+" Total)","(Calling Lifecycle Methods)",null)}}(),function(){if(Zd){if(!sc)return;var e=null;pc?e="Lifecycle hook scheduled a cascading update":hc>0&&(e="Caused by a cascading update in earlier commit"),pc=!1,hc++,uc=!1,bc.clear(),xc("(Committing Changes)","(Committing Changes)",e)}}(),Du(e.stateNode),Ku.debugTool&&Ku.debugTool.onCommitWork(e),function(e,t,i){if(ec){if(i===au)return e.earliestPendingTime=au,e.latestPendingTime=au,e.earliestSuspendedTime=au,e.latestSuspendedTime=au,void(e.latestPingedTime=au);var n=e.latestPendingTime;if(n!==au)if(n<i)e.earliestPendingTime=e.latestPendingTime=au;else{var o=e.earliestPendingTime;o<i&&(e.earliestPendingTime=e.latestPendingTime)}var r=e.earliestSuspendedTime;if(r===au)return void Ju(e,i);var a=e.latestSuspendedTime;if(i>a)return e.earliestSuspendedTime=au,e.latestSuspendedTime=au,e.latestPingedTime=au,void Ju(e,i);if(i<r)Ju(e,i)}}(t,0,t.current.expirationTime);var p=Zu(t);return p===au&&(Jh=null),p}function uf(e,t){if(t===lu||e.expirationTime!==lu){var i=au;switch(e.tag){case H:case q:var n=e.updateQueue;null!==n&&(i=n.expirationTime)}if(ac&&e.mode&bu){for(var o=e.selfBaseTime,r=e.child;null!==r;)o+=r.treeBaseTime,r.expirationTime!==au&&(i===au||i>r.expirationTime)&&(i=r.expirationTime),r=r.sibling;e.treeBaseTime=o}else for(var a=e.child;null!==a;)a.expirationTime!==au&&(i===au||i>a.expirationTime)&&(i=a.expirationTime),a=a.sibling;e.expirationTime=i}}function pf(e){for(;;){var t=e.alternate;Nn.setCurrentFiber(e);var i=e.return,n=e.sibling;if((e.effectTag&br)===rr){var o=nh(t,e,Hh);if(Mc(e),uf(e,Hh),Nn.resetCurrentFiber(),null!==o)return Mc(e),Ku.debugTool&&Ku.debugTool.onCompleteWork(e),o;if(null!==i&&(i.effectTag&br)===rr){null===i.firstEffect&&(i.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==i.lastEffect&&(i.lastEffect.nextEffect=e.firstEffect),i.lastEffect=e.lastEffect);var r=e.effectTag;r>ar&&(null!==i.lastEffect?i.lastEffect.nextEffect=e:i.firstEffect=e,i.lastEffect=e)}if(Ku.debugTool&&Ku.debugTool.onCompleteWork(e),null!==n)return n;if(null!==i){e=i;continue}return Kh=!0,null}var a=Th(e,jh,Hh);if(e.effectTag&mr?Fc(e):Mc(e),Nn.resetCurrentFiber(),null!==a)return Mc(e),Ku.debugTool&&Ku.debugTool.onCompleteWork(e),a.effectTag&=gr,a;if(null!==i&&(i.firstEffect=i.lastEffect=null,i.effectTag|=br),Ku.debugTool&&Ku.debugTool.onCompleteWork(e),null!==n)return n;if(null===i)return null;e=i}return null}function mf(e){var t=e.alternate;!function(e){if(Zd){if(!sc||_c(e))return;if(lc=e,!wc(e,null))return;e._debugIsCurrentlyTiming=!0}}(e),Nn.setCurrentFiber(e),nc&&(Qh=Ru(Qh,e));var i=void 0;return ac?(e.mode&bu&&function(){if(!ac)return;-1!==Hp&&E(!1,"Cannot start base timer that is already running. This error is likely caused by a bug in React. Please file an issue.");Hp=Bd()}(),i=Km(t,e,Hh),e.mode&bu&&(!function(e){if(!ac)return;-1!==Hp&&(e.selfBaseTime=Bd()-Hp)}(e),Xp())):i=Km(t,e,Hh),Nn.resetCurrentFiber(),tf&&of(),Ku.debugTool&&Ku.debugTool.onBeginWork(e),null===i&&(i=pf(e)),fn.current=null,i}function hf(e){if(e){for(;null!==Gh&&!eg();)Gh=mf(Gh);ac&&Up()}else for(;null!==Gh;)Gh=mf(Gh)}function ff(e,t,n){Uh&&i(!1,"renderRoot was called recursively. This error is likely caused by a bug in React. Please file an issue."),Uh=!0,t===Hh&&e===qh&&null!==Gh||(rf(),Hh=t,Xh=-1,Gh=Eu((qh=e).current,null,Hh),e.pendingCommitExpirationTime=au);var o=!1;for(jh=!n||Hh<=Ah,function(e){if(Zd){if(lc=e,!sc)return;hc=0,yc("(React Tree Reconciliation)"),kc()}}(Gh);;){try{hf(n)}catch(t){if(ac&&Xp(),null===Gh)o=!0,tg(t);else{ap();var r=Gh;nc&&ef(r,t,n),null===Gh&&i(!1,"Failed to replay rendering after an error. This is likely caused by a bug in React. Please file an issue with a reproducing case to help us find it.");var a=Gh,s=a.return;if(null===s){o=!0,tg(t);break}_h(e,s,a,t,jh,Hh,Vh),Gh=pf(a)}}break}var l,d=!1;if(Uh=!1,o)return Oc(Zh,d),Zh=null,Bc=-1,Ac.length=0,Vc.length=0,null;if(null===Gh){if(Kh){Oc(Zh,d=!0),Zh=null,e.pendingCommitExpirationTime=t;var c=e.current.alternate;return c}Oc(Zh,d),Zh=null,jh&&i(!1,"Expired work should have completed. This error is likely caused by a bug in React. Please file an issue."),function(e,t){if(ec){var i=e.earliestPendingTime,n=e.latestPendingTime;i===t?e.earliestPendingTime=n===t?e.latestPendingTime=au:n:n===t&&(e.latestPendingTime=i);var o=e.latestSuspendedTime;o===t&&(e.latestPingedTime=au);var r=e.earliestSuspendedTime;r===au?e.earliestSuspendedTime=e.latestSuspendedTime=t:r>t?e.earliestSuspendedTime=t:o<t&&(e.latestSuspendedTime=t)}}(e,t),Xh>=0&&setTimeout(function(){xf(e,t)},Xh);var u=Zu(e);return l=u,null===kf&&i(!1,"Should be working on a root. This error is likely caused by a bug in React. Please file an issue."),kf.remainingExpirationTime=l,null}return Oc(Zh,d),Zh=null,null}function gf(e,t){return function(e,t,n){Uh&&!Yh&&i(!1,"dispatch: Cannot dispatch during the render phase.");var o=e.return;for(;null!==o;){switch(o.tag){case q:var r=o.type,a=o.stateNode;if("function"==typeof r.getDerivedStateFromCatch||"function"==typeof a.componentDidCatch&&!df(a)){var s=xp(t,e),l=Eh(o,s,n);return up(o,l,n),void zf(o,n)}break;case H:var d=xp(t,e),c=wh(o,d,n);return up(o,c,n),void zf(o,n)}o=o.return}if(e.tag===H){var u=e,p=xp(t,u),m=wh(u,p,n);up(u,m,n),zf(u,n)}}(e,t,su)}function bf(e){return mu(e,5e3,250)}function vf(){var e=Cf(),t=bf(e);return t<=Bh&&(t=Bh+1),Bh=t}function yf(e,t){var i=void 0;return i=Lh!==au?Lh:Uh?Yh?su:Hh:t.mode&fu?Vf?mu(e,500,100):bf(e):su,Vf&&(If===au||i>If)&&(If=i),i}function xf(e,t){!function(e,t){if(ec){var i=e.latestSuspendedTime;if(i!==au&&i<=t){var n=e.latestPingedTime;(n===au||n<t)&&(e.latestPingedTime=t)}}}(e,t);var i,n,o=Zu(e);o!==au&&(n=o,((i=e).remainingExpirationTime===au||i.remainingExpirationTime<n)&&Hf(i,n))}function zf(e,t){if(Zd&&(uc&&(pc=!0),null!==dc&&"componentWillMount"!==dc&&"componentWillReceiveProps"!==dc&&(mc=!0)),e.tag===q){var n=e.stateNode;Dh(n)}for(var o=e;null!==o;){if((o.expirationTime===au||o.expirationTime>t)&&(o.expirationTime=t),null!==o.alternate&&(o.alternate.expirationTime===au||o.alternate.expirationTime>t)&&(o.alternate.expirationTime=t),null===o.return){if(o.tag!==H)return void(e.tag===q&&Fh(e));var r=o.stateNode;!Uh&&Hh!==au&&t<Hh&&(Zh=e,rf()),Ju(r,t);var a=Zu(r);Uh&&!Yh&&qh===r||Hf(r,a),Uf>Lf&&i(!1,"Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.")}o=o.return}}function Cf(){return Vh=Bd()-Oh,Ah=uu(Vh)}function wf(e){var t=Lh,i=Cf();Lh=bf(i);try{return e()}finally{Lh=t}}function Ef(e,t,i,n,o){var r=Lh;Lh=su;try{return e(t,i,n,o)}finally{Lh=r}}var Pf=null,_f=null,Tf=au,Sf=void 0,Rf=!1,kf=null,$f=au,If=au,Mf=!1,Ff=!1,Df=null,Nf=null,Of=!1,Af=!1,Vf=!1,Bf=null,Lf=1e3,Uf=0,Gf=1;function qf(e){if(Tf!==au){if(e>Tf)return;null!==Sf&&Gd(Sf)}else Zd&&sc&&!gc&&(gc=!0,yc("(Waiting for async callback...)"));var t=Bd()-Oh,i=pu(e),n=i-t;Tf=e,Sf=Ud(jf,{timeout:n})}function Hf(e,t){!function(e,t){if(null===e.nextScheduledRoot)e.remainingExpirationTime=t,null===_f?(Pf=_f=e,e.nextScheduledRoot=e):(_f.nextScheduledRoot=e,(_f=e).nextScheduledRoot=Pf);else{var i=e.remainingExpirationTime;(i===au||t<i)&&(e.remainingExpirationTime=t)}}(e,t),Rf||(Of?Af&&(kf=e,$f=su,Zf(e,su,!1)):t===su?Wf():qf(t))}function Xf(){var e=au,t=null;if(null!==_f)for(var n=_f,o=Pf;null!==o;){var r=o.remainingExpirationTime;if(r===au){if((null===n||null===_f)&&i(!1,"Should have a previous and last root. This error is likely caused by a bug in React. Please file an issue."),o===o.nextScheduledRoot){o.nextScheduledRoot=null,Pf=_f=null;break}if(o===Pf){var a=o.nextScheduledRoot;Pf=a,_f.nextScheduledRoot=a,o.nextScheduledRoot=null}else{if(o===_f){(_f=n).nextScheduledRoot=Pf,o.nextScheduledRoot=null;break}n.nextScheduledRoot=o.nextScheduledRoot,o.nextScheduledRoot=null}o=n.nextScheduledRoot}else{if((e===au||r<e)&&(e=r,t=o),o===_f)break;n=o,o=o.nextScheduledRoot}}var s=kf;null!==s&&s===t&&e===su?Uf++:Uf=0,kf=t,$f=e}function jf(e){Yf(au,!0,e)}function Wf(){Yf(su,!1,null)}function Yf(e,t,i){if(Nf=i,Xf(),ac&&qp(),Zd&&null!==Nf){var n=$f<Cf(),o=pu($f);!function(e,t){if(Zd&&sc){gc=!1;var i=e?"React was blocked by main thread":null;xc("(Waiting for async callback... will force flush in "+t+" ms)","(Waiting for async callback...)",i)}}(n,o)}if(t)for(;null!==kf&&$f!==au&&(e===au||e>=$f)&&(!Mf||Cf()>=$f);)Cf(),Zf(kf,$f,!Mf),Xf();else for(;null!==kf&&$f!==au&&(e===au||e>=$f);)Zf(kf,$f,!1),Xf();null!==Nf&&(Tf=au,Sf=null),$f!==au&&qf($f),Nf=null,Mf=!1,Jf()}function Kf(e,t){Rf&&i(!1,"work.commit(): Cannot commit while already rendering. This likely means you attempted to commit from inside a lifecycle method."),kf=e,$f=t,Zf(e,t,!1),Wf(),Jf()}function Jf(){if(Uf=0,null!==Bf){var e=Bf;Bf=null;for(var t=0;t<e.length;t++){var i=e[t];try{i._onComplete()}catch(n){Ff||(Ff=!0,Df=n)}}}if(Ff){var n=Df;throw Df=null,Ff=!1,n}}function Zf(e,t,n){if(Rf&&i(!1,"performWorkOnRoot was called recursively. This error is likely caused by a bug in React. Please file an issue."),Rf=!0,n){var o=e.finishedWork;null!==o?Qf(e,o,t):null!==(o=ff(e,t,!0))&&(eg()?(e.finishedWork=o,ac&&Up()):Qf(e,o,t))}else{var r=e.finishedWork;null!==r?Qf(e,r,t):null!==(r=ff(e,t,!1))&&Qf(e,r,t)}Rf=!1}function Qf(e,t,i){var n=e.firstBatch;if(null!==n&&n._expirationTime<=i&&(null===Bf?Bf=[n]:Bf.push(n),n._defer))return e.finishedWork=t,void(e.remainingExpirationTime=au);e.finishedWork=null,e.remainingExpirationTime=cf(t)}function eg(){return null!==Nf&&(!(Nf.timeRemaining()>Gf)&&(Mf=!0,!0))}function tg(e){null===kf&&i(!1,"Should be working on a root. This error is likely caused by a bug in React. Please file an issue."),kf.remainingExpirationTime=au,Ff||(Ff=!0,Df=e)}function ig(e,t){var i=Of;Of=!0;try{return e(t)}finally{(Of=i)||Rf||Wf()}}function ng(e,t){if(Of&&!Af){Af=!0;try{return e(t)}finally{Af=!1}}return e(t)}function og(e,t){Rf&&i(!1,"flushSync was called from inside a lifecycle method. It cannot be called when React is already rendering.");var n=Of;Of=!0;try{return Ef(e,t)}finally{Of=n,Wf()}}function rg(e,t,i){if(Vf)return e(t,i);Of||Rf||If===au||(Yf(If,!1,null),If=au);var n=Vf,o=Of;Vf=!0,Of=!0;try{return e(t,i)}finally{Vf=n,(Of=o)||Rf||Wf()}}function ag(e){var t=Of;Of=!0;try{Ef(e)}finally{(Of=t)||Rf||Yf(su,!1,null)}}var sg=void 0;function lg(e){if(!e)return _a;var t=or(e),n=function(e){wr(e)&&e.tag===q||i(!1,"Expected subtree parent to be a mounted class component. This error is likely caused by a bug in React. Please file an issue.");var t=e;for(;t.tag!==H;){if(Zc(t))return t.stateNode.__reactInternalMemoizedMergedChildContext;var n=t.return;n||i(!1,"Found unexpected detached subtree parent. This error is likely caused by a bug in React. Please file an issue."),t=n}return t.stateNode.context}(t);return Zc(t)?iu(t,n):n}function dg(e,t,i,n,o){var r=t.current;Ku.debugTool&&(null===r.alternate?Ku.debugTool.onMountContainer(t):null===e?Ku.debugTool.onUnmountContainer(t):Ku.debugTool.onUpdateContainer(t));var a=lg(i);return null===t.context?t.context=a:t.pendingContext=a,function(e,t,i,n){"render"!==Nn.phase||null===Nn.current||sg||(sg=!0,E(!1,"Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.\n\nCheck the render method of %s.",In(Nn.current)||"Unknown"));var o=dp(i);o.payload={element:t},null!==(n=void 0===n?null:n)&&("function"!=typeof n&&E(!1,"render(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",n),o.callback=n);return up(e,o,i),zf(e,i),i}(r,e,n,o)}function cg(e){var t=or(e);void 0===t&&("function"==typeof e.render?i(!1,"Unable to find node on an unmounted component."):i(!1,"Argument appears to not be a ReactComponent. Keys: %s",Object.keys(e)));var n=_r(t);return null===n?null:n.stateNode}function ug(e,t,i){return ku(e,t,i)}function pg(e,t,i,n){var o=t.current,r=Cf(),a=yf(r,o);return dg(e,t,i,a,n)}function mg(e){var t=e.current;if(!t.child)return null;switch(t.child.tag){case j:return Dd(t.child.stateNode);default:return t.child.stateNode}}function hg(e){var t=function(e){var t=Pr(e);if(!t)return null;var i=t;for(;;){if(i.tag===j||i.tag===W)return i;if(i.child&&i.tag!==X)i.child.return=i,i=i.child;else{if(i===t)return null;for(;!i.sibling;){if(!i.return||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}}return null}(e);return null===t?null:t.stateNode}function fg(e){var t=e.findFiberByHostInstance;return function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled)return!0;if(!t.supportsFiber)return E(!1,"The installed version of React DevTools is too old and will not work with the current version of React. Please update React DevTools. https://fb.me/react-devtools"),!0;try{var i=t.inject(e);$u=Fu(function(e){return t.onCommitFiberRoot(i,e)}),Iu=Fu(function(e){return t.onCommitFiberUnmount(i,e)})}catch(e){E(!1,"React DevTools encountered an error: %s.",e)}return!0}(di({},e,{findHostInstanceByFiber:function(e){var t=_r(e);return null===t?null:t.stateNode},findFiberByHostInstance:function(e){return t?t(e):null}}))}sg=!1;var gg=Object.freeze({updateContainerAtExpirationTime:dg,createContainer:ug,updateContainer:pg,flushRoot:Kf,requestWork:Hf,computeUniqueAsyncExpiration:vf,batchedUpdates:ig,unbatchedUpdates:ng,deferredUpdates:wf,syncUpdates:Ef,interactiveUpdates:rg,flushInteractiveUpdates:function(){Rf||If===au||(Yf(If,!1,null),If=au)},flushControlled:ag,flushSync:og,getPublicRootInstance:mg,findHostInstance:cg,findHostInstanceWithNoPortals:hg,injectIntoDevTools:fg});var bg=void 0,vg=void 0,yg=!1;"function"==typeof Map&&null!=Map.prototype&&"function"==typeof Map.prototype.forEach&&"function"==typeof Set&&null!=Set.prototype&&"function"==typeof Set.prototype.clear&&"function"==typeof Set.prototype.forEach||E(!1,"React depends on Map and Set built-in types. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills");function xg(e){var t=vf();this._expirationTime=t,this._root=e,this._next=null,this._callbacks=null,this._didComplete=!1,this._hasChildren=!1,this._children=null,this._defer=!0}function zg(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function Cg(e,t,i){var n=ug(e,t,i);this._internalRoot=n}function wg(e){return!(!e||e.nodeType!==nn&&e.nodeType!==an&&e.nodeType!==sn&&(e.nodeType!==rn||" react-mount-point-unstable "!==e.nodeValue))}function Eg(e){return e?e.nodeType===an?e.documentElement:e.firstChild:null}bg=function(e){if(e._reactRootContainer&&e.nodeType!==rn){var t=hg(e._reactRootContainer._internalRoot.current);t&&t.parentNode!==e&&E(!1,"render(...): It looks like the React-rendered content of this container was removed without using React. This is not supported and will cause errors. Instead, call ReactDOM.unmountComponentAtNode to empty a container.")}var i=!!e._reactRootContainer,n=Eg(e),o=!(!n||!se(n));o&&!i&&E(!1,"render(...): Replacing React-rendered children with a new root component. If you intended to update the children of this node, you should instead have the existing children update their state and render the new components instead of calling ReactDOM.render."),e.nodeType===nn&&e.tagName&&"BODY"===e.tagName.toUpperCase()&&E(!1,"render(): Rendering components directly into document.body is discouraged, since its children are often manipulated by third-party scripts and browser extensions. This may lead to subtle reconciliation issues. Try rendering into a container element created for your app.")},vg=function(e,t){null!==e&&"function"!=typeof e&&E(!1,"%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",t,e)},Gi.injectFiberControlledHostComponent(Ql),xg.prototype.render=function(e){this._defer||i(!1,"batch.render: Cannot render a batch that already committed."),this._hasChildren=!0,this._children=e;var t=this._root._internalRoot,n=this._expirationTime,o=new zg;return dg(e,t,null,n,o._onCommit),o},xg.prototype.then=function(e){if(this._didComplete)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},xg.prototype.commit=function(){var e=this._root._internalRoot,t=e.firstBatch;if(this._defer&&null!==t||i(!1,"batch.commit: Cannot commit a batch multiple times."),!this._hasChildren)return this._next=null,void(this._defer=!1);var n=this._expirationTime;if(t!==this){this._hasChildren&&(n=this._expirationTime=t._expirationTime,this.render(this._children));for(var o=null,r=t;r!==this;)o=r,r=r._next;null===o&&i(!1,"batch.commit: Cannot commit a batch multiple times."),o._next=r._next,this._next=t,t=e.firstBatch=this}this._defer=!1,Kf(e,n);var a=this._next;this._next=null,null!==(t=e.firstBatch=a)&&t._hasChildren&&t.render(t._children)},xg.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++){var i=e[t];i()}}},zg.prototype.then=function(e){if(this._didCommit)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},zg.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++){var n=e[t];"function"!=typeof n&&i(!1,"Invalid argument passed as callback. Expected a function. Instead received: %s",n),n()}}},Cg.prototype.render=function(e,t){var i=this._internalRoot,n=new zg;return vg(t=void 0===t?null:t,"render"),null!==t&&n.then(t),pg(e,i,null,n._onCommit),n},Cg.prototype.unmount=function(e){var t=this._internalRoot,i=new zg;return vg(e=void 0===e?null:e,"render"),null!==e&&i.then(e),pg(null,t,null,i._onCommit),i},Cg.prototype.legacy_renderSubtreeIntoContainer=function(e,t,i){var n=this._internalRoot,o=new zg;return vg(i=void 0===i?null:i,"render"),null!==i&&o.then(i),pg(t,n,e,o._onCommit),o},Cg.prototype.createBatch=function(){var e=new xg(this),t=e._expirationTime,i=this._internalRoot,n=i.firstBatch;if(null===n)i.firstBatch=e,e._next=null;else{for(var o=null,r=n;null!==r&&r._expirationTime<=t;)o=r,r=r._next;e._next=r,null!==o&&(o._next=e)}return e},Qi.injectRenderer(gg);var Pg=!1;function _g(e,t){var i,n=t||!(!(i=Eg(e))||i.nodeType!==nn||!i.hasAttribute(Hn));if(!n)for(var o=!1,r=void 0;r=e.lastChild;)!o&&r.nodeType===nn&&r.hasAttribute(Hn)&&(o=!0,E(!1,"render(): Target node has markup rendered by React, but there are unrelated nodes as well. This is most commonly caused by white-space inserted around server-rendered markup.")),e.removeChild(r);!n||t||Pg||(Pg=!0,Ou(!1,"render(): Calling ReactDOM.render() to hydrate server-rendered markup will stop working in React v17. Replace the ReactDOM.render() call with ReactDOM.hydrate() if you want React to attach to the server HTML."));return new Cg(e,!1,n)}function Tg(e,t,n,o,r){wg(n)||i(!1,"Target container is not a DOM element."),bg(n);var a=n._reactRootContainer;if(a){if("function"==typeof r){var s=r;r=function(){var e=mg(a._internalRoot);s.call(e)}}null!=e?a.legacy_renderSubtreeIntoContainer(e,t,r):a.render(t,r)}else{if(a=n._reactRootContainer=_g(n,o),"function"==typeof r){var l=r;r=function(){var e=mg(a._internalRoot);l.call(e)}}ng(function(){null!=e?a.legacy_renderSubtreeIntoContainer(e,t,r):a.render(t,r)})}return mg(a._internalRoot)}function Sg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return wg(t)||i(!1,"Target container is not a DOM element."),function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:xn,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}(e,t,null,n)}var Rg={createPortal:Sg,findDOMNode:function(e){var t=fn.current;if(null!==t&&null!==t.stateNode){var i=t.stateNode._warnedAboutRefsInRender;i||E(!1,"%s is accessing findDOMNode inside its render(). render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",In(t)||"A component"),t.stateNode._warnedAboutRefsInRender=!0}return null==e?null:e.nodeType===nn?e:cg(e)},hydrate:function(e,t,i){return Tg(null,e,t,!0,i)},render:function(e,t,i){return Tg(null,e,t,!1,i)},unstable_renderSubtreeIntoContainer:function(e,t,n,o){return(null==e||void 0===e._reactInternalFiber)&&i(!1,"parentComponent must be a valid React Component"),Tg(e,t,n,!1,o)},unmountComponentAtNode:function(e){if(wg(e)||i(!1,"unmountComponentAtNode(...): Target container is not a DOM element."),e._reactRootContainer){var t=Eg(e),n=t&&!se(t);return n&&E(!1,"unmountComponentAtNode(): The node you're attempting to unmount was rendered by another copy of React."),ng(function(){Tg(null,null,e,!1,function(){e._reactRootContainer=null})}),!0}var o=Eg(e),r=!(!o||!se(o)),a=1===e.nodeType&&wg(e.parentNode)&&!!e.parentNode._reactRootContainer;return r&&E(!1,"unmountComponentAtNode(): The node you're attempting to unmount was rendered by React and is not a top-level container. %s",a?"You may have accidentally passed in a React root node instead of its container.":"Instead, have the parent component update its state and rerender in order to remove this component."),!1},unstable_createPortal:function(){return yg||(yg=!0,Ou(!1,'The ReactDOM.unstable_createPortal() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactDOM.createPortal() instead. It has the exact same API, but without the "unstable_" prefix.')),Sg.apply(void 0,arguments)},unstable_batchedUpdates:ig,unstable_deferredUpdates:wf,unstable_interactiveUpdates:rg,flushSync:og,unstable_flushControlled:ag,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{EventPluginHub:L,EventPluginRegistry:x,EventPropagators:Ce,ReactControlledComponent:ji,ReactDOMComponentTree:ue,ReactDOMEventListener:ia}};if(Rg.unstable_createRoot=function(e,t){return new Cg(e,!0,null!=t&&!0===t.hydrate)},!fg({findFiberByHostInstance:ae,bundleType:1,version:"16.4.1",rendererPackageName:"react-dom"})&&Ee.canUseDOM&&window.top===window.self&&(navigator.userAgent.indexOf("Chrome")>-1&&-1===navigator.userAgent.indexOf("Edge")||navigator.userAgent.indexOf("Firefox")>-1)){var kg=window.location.protocol;/^(https?|file):$/.test(kg)&&console.info("%cDownload the React DevTools for a better development experience: https://fb.me/react-devtools"+("file:"===kg?"\nYou might need to use a local HTTP server (instead of file://): https://fb.me/react-devtools-faq":""),"font-weight:bold")}var $g=Object.freeze({default:Rg}),Ig=$g&&Rg||$g;return Ig.default?Ig.default:Ig}(e.React)}(this),function(e,t){e.createReactClass=t(e.React)}(this,function(e){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t,i){var n,o=i(7),r=i(4),a=i(5),s=i(6),l="mixins";n={prop:"prop",context:"context",childContext:"child context"},e.exports=function(e,t,i){var d=[],c={mixins:"DEFINE_MANY",statics:"DEFINE_MANY",propTypes:"DEFINE_MANY",contextTypes:"DEFINE_MANY",childContextTypes:"DEFINE_MANY",getDefaultProps:"DEFINE_MANY_MERGED",getInitialState:"DEFINE_MANY_MERGED",getChildContext:"DEFINE_MANY_MERGED",render:"DEFINE_ONCE",componentWillMount:"DEFINE_MANY",componentDidMount:"DEFINE_MANY",componentWillReceiveProps:"DEFINE_MANY",shouldComponentUpdate:"DEFINE_ONCE",componentWillUpdate:"DEFINE_MANY",componentDidUpdate:"DEFINE_MANY",componentWillUnmount:"DEFINE_MANY",updateComponent:"OVERRIDE_BASE"},u={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var i=0;i<t.length;i++)m(e,t[i])},childContextTypes:function(e,t){p(e,t,"childContext"),e.childContextTypes=o({},e.childContextTypes,t)},contextTypes:function(e,t){p(e,t,"context"),e.contextTypes=o({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=f(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){p(e,t,"prop"),e.propTypes=o({},e.propTypes,t)},statics:function(e,t){!function(e,t){if(t)for(var i in t){var n=t[i];if(t.hasOwnProperty(i)){var o=i in u;a(!o,'ReactClass: You are attempting to define a reserved property, `%s`, that shouldn\'t be on the "statics" key. Define it as an instance property instead; it will still be accessible on the constructor.',i);var r=i in e;a(!r,"ReactClass: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",i),e[i]=n}}}(e,t)},autobind:function(){}};function p(e,t,i){for(var o in t)t.hasOwnProperty(o)&&s("function"==typeof t[o],"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",e.displayName||"ReactClass",n[i],o)}function m(e,i){if(i){a("function"!=typeof i,"ReactClass: You're attempting to use a component class or function as a mixin. Instead, just use a regular object."),a(!t(i),"ReactClass: You're attempting to use a component as a mixin. Instead, just use a regular object.");var n,o,r,d=e.prototype,p=d.__reactAutoBindPairs;for(var m in i.hasOwnProperty(l)&&u.mixins(e,i.mixins),i)if(i.hasOwnProperty(m)&&m!==l){var h=i[m],b=d.hasOwnProperty(m);if(n=b,o=m,r=c.hasOwnProperty(o)?c[o]:null,x.hasOwnProperty(o)&&a("OVERRIDE_BASE"===r,"ReactClassInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",o),n&&a("DEFINE_MANY"===r||"DEFINE_MANY_MERGED"===r,"ReactClassInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",o),u.hasOwnProperty(m))u[m](e,h);else{var v=c.hasOwnProperty(m);if("function"!=typeof h||v||b||!1===i.autobind)if(b){var y=c[m];a(v&&("DEFINE_MANY_MERGED"===y||"DEFINE_MANY"===y),"ReactClass: Unexpected spec policy %s for key %s when mixing in component specs.",y,m),"DEFINE_MANY_MERGED"===y?d[m]=f(d[m],h):"DEFINE_MANY"===y&&(d[m]=g(d[m],h))}else d[m]=h,"function"==typeof h&&i.displayName&&(d[m].displayName=i.displayName+"_"+m);else p.push(m,h),d[m]=h}}}else{var z=typeof i;s("object"===z&&null!==i,"%s: You're attempting to include a mixin that is either null or not an object. Check the mixins included by the component, as well as any mixins they include themselves. Expected object but got %s.",e.displayName||"ReactClass",null===i?null:z)}}function h(e,t){for(var i in a(e&&t&&"object"==typeof e&&"object"==typeof t,"mergeIntoWithNoDuplicateKeys(): Cannot merge non-objects."),t)t.hasOwnProperty(i)&&(a(void 0===e[i],"mergeIntoWithNoDuplicateKeys(): Tried to merge two objects with the same key: `%s`. This conflict may be due to a mixin; in particular, this may be caused by two getInitialState() or getDefaultProps() methods returning objects with clashing keys.",i),e[i]=t[i]);return e}function f(e,t){return function(){var i=e.apply(this,arguments),n=t.apply(this,arguments);if(null==i)return n;if(null==n)return i;var o={};return h(o,i),h(o,n),o}}function g(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function b(e,t){var i=t.bind(e);i.__reactBoundContext=e,i.__reactBoundMethod=t,i.__reactBoundArguments=null;var n=e.constructor.displayName,o=i.bind;return i.bind=function(r){for(var a=arguments.length,l=Array(a>1?a-1:0),d=1;d<a;d++)l[d-1]=arguments[d];if(r!==e&&null!==r)s(!1,"bind(): React component methods may only be bound to the component instance. See %s",n);else if(!l.length)return s(!1,"bind(): You are binding a component method to the component. React does this for you automatically in a high-performance way, so you can safely remove this call. See %s",n),i;var c=o.apply(i,arguments);return c.__reactBoundContext=e,c.__reactBoundMethod=t,c.__reactBoundArguments=l,c},i}var v={componentDidMount:function(){this.__isMounted=!0}},y={componentWillUnmount:function(){this.__isMounted=!1}},x={replaceState:function(e,t){this.updater.enqueueReplaceState(this,e,t)},isMounted:function(){return s(this.__didWarnIsMounted,"%s: isMounted is deprecated. Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks.",this.constructor&&this.constructor.displayName||this.name||"Component"),this.__didWarnIsMounted=!0,!!this.__isMounted}},z=function(){};return o(z.prototype,e.prototype,x),function(e){var t=function(e,n,o){s(this instanceof t,"Something is calling a React component directly. Use a factory or JSX instead. See: https://fb.me/react-legacyfactory"),this.__reactAutoBindPairs.length&&function(e){for(var t=e.__reactAutoBindPairs,i=0;i<t.length;i+=2){var n=t[i],o=t[i+1];e[n]=b(e,o)}}(this),this.props=e,this.context=n,this.refs=r,this.updater=o||i,this.state=null;var l=this.getInitialState?this.getInitialState():null;void 0===l&&this.getInitialState._isMockFunction&&(l=null),a("object"==typeof l&&!Array.isArray(l),"%s.getInitialState(): must return an object or null",t.displayName||"ReactCompositeComponent"),this.state=l};for(var n in t.prototype=new z,t.prototype.constructor=t,t.prototype.__reactAutoBindPairs=[],d.forEach(m.bind(null,t)),m(t,v),m(t,e),m(t,y),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),t.getDefaultProps&&(t.getDefaultProps.isReactClassApproved={}),t.prototype.getInitialState&&(t.prototype.getInitialState.isReactClassApproved={}),a(t.prototype.render,"createClass(...): Class specification must implement a `render` method."),s(!t.prototype.componentShouldUpdate,"%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",e.displayName||"A component"),s(!t.prototype.componentWillRecieveProps,"%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",e.displayName||"A component"),c)t.prototype[n]||(t.prototype[n]=null);return t}}},function(t,i){t.exports=e},function(e,t,i){var n=i(1),o=i(0);if(void 0===n)throw Error("create-react-class could not find the React object. If you are using script tags, make sure that React is being loaded before create-react-class.");var r=(new n.Component).updater;e.exports=o(n.Component,n.isValidElement,r)},function(e,t,i){function n(e){return function(){return e}}var o=function(){};o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e,t,i){var n={};Object.freeze(n),e.exports=n},function(e,t,i){var n=function(e){};n=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")},e.exports=function(e,t,i,o,r,a,s,l){if(n(t),!e){var d;if(void 0===t)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[i,o,r,a,s,l],u=0;(d=new Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw d.framesToPop=1,d}}},function(e,t,i){var n=i(3);n=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var i=arguments.length,n=Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];(function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var o=0,r="Warning: "+e.replace(/%s/g,function(){return i[o++]});"undefined"!=typeof console&&console.error(r);try{throw new Error(r)}catch(e){}}).apply(void 0,[t].concat(n))}},e.exports=n},function(e,t,i){var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var d in i=Object(arguments[l]))o.call(i,d)&&(s[d]=i[d]);if(n){a=n(i);for(var c=0;c<a.length;c++)r.call(i,a[c])&&(s[a[c]]=i[a[c]])}}return s}}])}),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).less=e()}(function(){return function e(t,i,n){function o(a,s){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var c=i[a]={exports:{}};t[a][0].call(c.exports,function(e){var i=t[a][1][e];return o(i||e)},c,c.exports,e,t,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,i){var n=e("./utils").addDataAttr,o=e("./browser");t.exports=function(e,t){n(t,o.currentScript(e)),void 0===t.isFileProtocol&&(t.isFileProtocol=/^(file|(chrome|safari)(-extension)?|resource|qrc|app):/.test(e.location.protocol)),t.async=t.async||!1,t.fileAsync=t.fileAsync||!1,t.poll=t.poll||(t.isFileProtocol?1e3:1500),t.env=t.env||("127.0.0.1"==e.location.hostname||"0.0.0.0"==e.location.hostname||"localhost"==e.location.hostname||e.location.port&&e.location.port.length>0||t.isFileProtocol?"development":"production");var i=/!dumpLineNumbers:(comments|mediaquery|all)/.exec(e.location.hash);i&&(t.dumpLineNumbers=i[1]),void 0===t.useFileCache&&(t.useFileCache=!0),void 0===t.onReady&&(t.onReady=!0),t.javascriptEnabled=!(!t.javascriptEnabled&&!t.inlineJavaScript)}},{"./browser":3,"./utils":11}],2:[function(e,t,i){e("promise/polyfill");var n=window.less||{};e("./add-default-options")(window,n);var o,r,a,s=t.exports=e("./index")(window,n);function l(e){e.filename&&console.warn(e),n.async||r.removeChild(a)}window.less=s,n.onReady&&(/!watch/.test(window.location.hash)&&s.watch(),n.async||(o="body { display: none !important }",r=document.head||document.getElementsByTagName("head")[0],(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=o:a.appendChild(document.createTextNode(o)),r.appendChild(a)),s.registerStylesheetsImmediately(),s.pageLoadFinished=s.refresh("development"===s.env).then(l,l))},{"./add-default-options":1,"./index":8,"promise/polyfill":101}],3:[function(e,t,i){var n=e("./utils");t.exports={createCSS:function(e,t,i){var o=i.href||"",r="less:"+(i.title||n.extractId(o)),a=e.getElementById(r),s=!1,l=e.createElement("style");l.setAttribute("type","text/css"),i.media&&l.setAttribute("media",i.media),l.id=r,l.styleSheet||(l.appendChild(e.createTextNode(t)),s=null!==a&&a.childNodes.length>0&&l.childNodes.length>0&&a.firstChild.nodeValue===l.firstChild.nodeValue);var d=e.getElementsByTagName("head")[0];if(null===a||!1===s){var c=i&&i.nextSibling||null;c?c.parentNode.insertBefore(l,c):d.appendChild(l)}if(a&&!1===s&&a.parentNode.removeChild(a),l.styleSheet)try{l.styleSheet.cssText=t}catch(e){throw new Error("Couldn't reassign styleSheet.cssText.")}},currentScript:function(e){var t,i=e.document;return i.currentScript||(t=i.getElementsByTagName("script"))[t.length-1]}}},{"./utils":11}],4:[function(e,t,i){t.exports=function(e,t,i){var n=null;if("development"!==t.env)try{n=void 0===e.localStorage?null:e.localStorage}catch(e){}return{setCSS:function(e,t,o,r){if(n){i.info("saving "+e+" to cache.");try{n.setItem(e,r),n.setItem(e+":timestamp",t),o&&n.setItem(e+":vars",JSON.stringify(o))}catch(t){i.error('failed to save "'+e+'" to local storage for caching.')}}},getCSS:function(e,t,i){var o=n&&n.getItem(e),r=n&&n.getItem(e+":timestamp"),a=n&&n.getItem(e+":vars");if(i=i||{},r&&t.lastModified&&new Date(t.lastModified).valueOf()===new Date(r).valueOf()&&(!i&&!a||JSON.stringify(i)===a))return o}}}},{}],5:[function(e,t,i){var n=e("./utils"),o=e("./browser");t.exports=function(e,t,i){return{add:function(r,a){var s,l,d,c,u,p;i.errorReporting&&"html"!==i.errorReporting?"console"===i.errorReporting?(l=a,d=(s=r).filename||l,c=[],u=(s.type||"Syntax")+"Error: "+(s.message||"There is an error in your .less file")+" in "+d+" ",p=function(e,t,i){void 0!==e.extract[t]&&c.push("{line} {content}".replace(/\{line\}/,(parseInt(e.line,10)||0)+(t-1)).replace(/\{class\}/,i).replace(/\{content\}/,e.extract[t]))},s.extract&&(p(s,0,""),p(s,1,"line"),p(s,2,""),u+="on line "+s.line+", column "+(s.column+1)+":\n"+c.join("\n")),s.stack&&(s.extract||i.logLevel>=4)&&(u+="\nStack Trace\n"+s.stack),t.logger.error(u)):"function"==typeof i.errorReporting&&i.errorReporting("add",r,a):function(t,r){var a,s,l="less-error-message:"+n.extractId(r||""),d=e.document.createElement("div"),c=[],u=t.filename||r,p=u.match(/([^\/]+(\?.*)?)$/)[1];d.id=l,d.className="less-error-message",s="<h3>"+(t.type||"Syntax")+"Error: "+(t.message||"There is an error in your .less file")+'</h3><p>in <a href="'+u+'">'+p+"</a> ";var m=function(e,t,i){void 0!==e.extract[t]&&c.push('<li><label>{line}</label><pre class="{class}">{content}</pre></li>'.replace(/\{line\}/,(parseInt(e.line,10)||0)+(t-1)).replace(/\{class\}/,i).replace(/\{content\}/,e.extract[t]))};t.extract&&(m(t,0,""),m(t,1,"line"),m(t,2,""),s+="on line "+t.line+", column "+(t.column+1)+":</p><ul>"+c.join("")+"</ul>"),t.stack&&(t.extract||i.logLevel>=4)&&(s+="<br/>Stack Trace</br />"+t.stack.split("\n").slice(1).join("<br/>")),d.innerHTML=s,o.createCSS(e.document,[".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #dd6666;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.line {","color: #ff0000;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"}),d.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";"),"development"===i.env&&(a=setInterval(function(){var t=e.document,i=t.body;i&&(t.getElementById(l)?i.replaceChild(d,t.getElementById(l)):i.insertBefore(d,i.firstChild),clearInterval(a))},10))}(r,a)},remove:function(t){var o,r;i.errorReporting&&"html"!==i.errorReporting?"console"===i.errorReporting||"function"==typeof i.errorReporting&&i.errorReporting("remove",t):(o=t,(r=e.document.getElementById("less-error-message:"+n.extractId(o)))&&r.parentNode.removeChild(r))}}}},{"./browser":3,"./utils":11}],6:[function(e,t,i){t.exports=function(t,i){var n=e("../less/environment/abstract-file-manager.js"),o={},r=function(){};return(r.prototype=new n).alwaysMakePathsAbsolute=function(){return!0},r.prototype.join=function(e,t){return e?this.extractUrlParts(t,e).path:t},r.prototype.doXHR=function(e,n,o,r){var a=new XMLHttpRequest,s=!t.isFileProtocol||t.fileAsync;function l(t,i,n){t.status>=200&&t.status<300?i(t.responseText,t.getResponseHeader("Last-Modified")):"function"==typeof n&&n(t.status,e)}"function"==typeof a.overrideMimeType&&a.overrideMimeType("text/css"),i.debug("XHR: Getting '"+e+"'"),a.open("GET",e,s),a.setRequestHeader("Accept",n||"text/x-less, text/css; q=0.9, */*; q=0.5"),a.send(null),t.isFileProtocol&&!t.fileAsync?0===a.status||a.status>=200&&a.status<300?o(a.responseText):r(a.status,e):s?a.onreadystatechange=function(){4==a.readyState&&l(a,o,r)}:l(a,o,r)},r.prototype.supports=function(e,t,i,n){return!0},r.prototype.clearFileCache=function(){o={}},r.prototype.loadFile=function(e,t,i,n,r){t&&!this.isPathAbsolute(e)&&(e=t+e),i=i||{};var a=this.extractUrlParts(e,window.location.href).url;if(i.useFileCache&&o[a])try{var s=o[a];r(null,{contents:s,filename:a,webInfo:{lastModified:new Date}})}catch(e){r({filename:a,message:"Error loading file "+a+" error was "+e.message})}else this.doXHR(a,i.mime,function(e,t){o[a]=e,r(null,{contents:e,filename:a,webInfo:{lastModified:t}})},function(e,t){r({type:"File",message:"'"+t+"' wasn't found ("+e+")",href:a})})},r}},{"../less/environment/abstract-file-manager.js":16}],7:[function(e,t,i){t.exports=function(){function t(){throw{type:"Runtime",message:"Image size functions are not supported in browser version of less"}}var i={"image-size":function(e){return t(),-1},"image-width":function(e){return t(),-1},"image-height":function(e){return t(),-1}};e("./../less/functions/function-registry").addMultiple(i)}},{"./../less/functions/function-registry":24}],8:[function(e,t,i){var n=e("./utils").addDataAttr,o=e("./browser");t.exports=function(t,i){var r=t.document,a=e("../less")();a.options=i;var s=a.environment,l=e("./file-manager")(i,a.logger),d=new l;s.addFileManager(d),a.FileManager=l,a.PluginLoader=e("./plugin-loader"),e("./log-listener")(a,i);var c=e("./error-reporting")(t,a,i),u=a.cache=i.cache||e("./cache")(t,i,a.logger);e("./image-size")(a.environment),i.functions&&a.functions.functionRegistry.addMultiple(i.functions);var p=/^text\/(x-)?less$/;function m(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function h(e,t){var i=Array.prototype.slice.call(arguments,2);return function(){var n=i.concat(Array.prototype.slice.call(arguments,0));return e.apply(t,n)}}function f(e){for(var t,n=r.getElementsByTagName("style"),o=0;o<n.length;o++)if((t=n[o]).type.match(p)){var s=m(i);s.modifyVars=e;var l=t.innerHTML||"";s.filename=r.location.href.replace(/#.*$/,""),a.render(l,s,h(function(e,t,i){t?c.add(t,"inline"):(e.type="text/css",e.styleSheet?e.styleSheet.cssText=i.css:e.innerHTML=i.css)},null,t))}}function g(e,t,o,r,l){var p=m(i);n(p,e),p.mime=e.type,l&&(p.modifyVars=l),d.loadFile(e.href,null,p,s,function(i,n){i?t(i):function(i){var n=i.contents,s=i.filename,l=i.webInfo,m={currentDirectory:d.getPath(s),filename:s,rootFilename:s,relativeUrls:p.relativeUrls};if(m.entryPath=m.currentDirectory,m.rootpath=p.rootpath||m.currentDirectory,l){l.remaining=r;var h=u.getCSS(s,l,p.modifyVars);if(!o&&h)return l.local=!0,void t(null,h,n,e,l,s)}c.remove(s),p.rootFileInfo=m,a.render(n,p,function(i,o){i?(i.href=s,t(i)):(u.setCSS(e.href,l.lastModified,p.modifyVars,o.css),t(null,o.css,n,e,l,s))})}(n)})}function b(e,t,i){for(var n=0;n<a.sheets.length;n++)g(a.sheets[n],e,t,a.sheets.length-(n+1),i)}return a.watch=function(){return a.watchMode||(a.env="development","development"===a.env&&(a.watchTimer=setInterval(function(){a.watchMode&&(d.clearFileCache(),b(function(e,i,n,r,a){e?c.add(e,e.href||r.href):i&&o.createCSS(t.document,i,r)}))},i.poll))),this.watchMode=!0,!0},a.unwatch=function(){return clearInterval(a.watchTimer),this.watchMode=!1,!1},a.registerStylesheetsImmediately=function(){var e=r.getElementsByTagName("link");a.sheets=[];for(var t=0;t<e.length;t++)("stylesheet/less"===e[t].rel||e[t].rel.match(/stylesheet/)&&e[t].type.match(p))&&a.sheets.push(e[t])},a.registerStylesheets=function(){return new Promise(function(e,t){a.registerStylesheetsImmediately(),e()})},a.modifyVars=function(e){return a.refresh(!0,e,!1)},a.refresh=function(e,i,n){return(e||n)&&!1!==n&&d.clearFileCache(),new Promise(function(n,r){var s,l,d,u;s=l=new Date,0===(u=a.sheets.length)?(l=new Date,d=l-s,a.logger.info("Less has finished and no sheets were loaded."),n({startTime:s,endTime:l,totalMilliseconds:d,sheets:a.sheets.length})):b(function(e,i,p,m,h){if(e)return c.add(e,e.href||m.href),void r(e);h.local?a.logger.info("Loading "+m.href+" from cache."):a.logger.info("Rendered "+m.href+" successfully."),o.createCSS(t.document,i,m),a.logger.info("CSS for "+m.href+" generated in "+(new Date-l)+"ms"),0===--u&&(d=new Date-s,a.logger.info("Less has finished. CSS generated in "+d+"ms"),n({startTime:s,endTime:l,totalMilliseconds:d,sheets:a.sheets.length})),l=new Date},e,i),f(i)})},a.refreshStyles=f,a}},{"../less":33,"./browser":3,"./cache":4,"./error-reporting":5,"./file-manager":6,"./image-size":7,"./log-listener":9,"./plugin-loader":10,"./utils":11}],9:[function(e,t,i){t.exports=function(e,t){t.logLevel=void 0!==t.logLevel?t.logLevel:"development"===t.env?3:1,t.loggers||(t.loggers=[{debug:function(e){t.logLevel>=4&&console.log(e)},info:function(e){t.logLevel>=3&&console.log(e)},warn:function(e){t.logLevel>=2&&console.warn(e)},error:function(e){t.logLevel>=1&&console.error(e)}}]);for(var i=0;i<t.loggers.length;i++)e.logger.addListener(t.loggers[i])}},{}],10:[function(e,t,i){var n=e("../less/environment/abstract-plugin-loader.js"),o=function(t){this.less=t,this.require=e};(o.prototype=new n).tryLoadPlugin=function(e,t,i){var n=this,o=e.slice(0,1),r="."===o||"/"===o||".js"===e.slice(-3).toLowerCase();this.tryLoadFromEnvironment(e,t,r,function(o,a){r?i(o,a):o?n.tryLoadFromEnvironment("less-plugin-"+e,t,r,function(e,t){i(o,t)}):i(null,a)})},o.prototype.tryLoadFromEnvironment=function(e,t,i,n){var o=new this.less.FileManager;if(t&&(e=o.extractUrlParts(e,t).url),e){e=o.tryAppendExtension(e,".js");o.loadFile(e,null,null,null,function(e,t){e?n(e):n(null,t)})}else n({message:"Plugin could not be found."})},t.exports=o},{"../less/environment/abstract-plugin-loader.js":17}],11:[function(e,t,i){t.exports={extractId:function(e){return e.replace(/^[a-z-]+:\/+?[^\/]+/,"").replace(/[\?\&]livereload=\w+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")},addDataAttr:function(e,t){for(var i in t.dataset)if(t.dataset.hasOwnProperty(i))if("env"===i||"dumpLineNumbers"===i||"rootpath"===i||"errorReporting"===i)e[i]=t.dataset[i];else try{e[i]=JSON.parse(t.dataset[i])}catch(e){}}}},{}],12:[function(e,t,i){var n={};t.exports=n;var o=function(e,t,i){if(e)for(var n=0;n<i.length;n++)e.hasOwnProperty(i[n])&&(t[i[n]]=e[i[n]])},r=["paths","relativeUrls","rootpath","strictImports","insecure","dumpLineNumbers","compress","syncImport","chunkInput","mime","useFileCache","processImports","pluginManager"];n.Parse=function(e){o(e,this,r),"string"==typeof this.paths&&(this.paths=[this.paths])};var a=["paths","compress","ieCompat","strictMath","strictUnits","sourceMap","importMultiple","urlArgs","javascriptEnabled","pluginManager","importantScope"];n.Eval=function(e,t){o(e,this,a),"string"==typeof this.paths&&(this.paths=[this.paths]),this.frames=t||[],this.importantScope=this.importantScope||[]},n.Eval.prototype.inParenthesis=function(){this.parensStack||(this.parensStack=[]),this.parensStack.push(!0)},n.Eval.prototype.outOfParenthesis=function(){this.parensStack.pop()},n.Eval.prototype.isMathOn=function(){return!this.strictMath||this.parensStack&&this.parensStack.length},n.Eval.prototype.isPathRelative=function(e){return!/^(?:[a-z-]+:|\/|#)/i.test(e)},n.Eval.prototype.normalizePath=function(e){var t,i=e.split("/").reverse();for(e=[];0!==i.length;)switch(t=i.pop()){case".":break;case"..":0===e.length||".."===e[e.length-1]?e.push(t):e.pop();break;default:e.push(t)}return e.join("/")}},{}],13:[function(e,t,i){t.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],14:[function(e,t,i){t.exports={colors:e("./colors"),unitConversions:e("./unit-conversions")}},{"./colors":13,"./unit-conversions":15}],15:[function(e,t,i){t.exports={length:{m:1,cm:.01,mm:.001,in:.0254,px:.0254/96,pt:.0254/72,pc:.0254/72*12},duration:{s:1,ms:.001},angle:{rad:1/(2*Math.PI),deg:1/360,grad:.0025,turn:1}}},{}],16:[function(e,t,i){var n=function(){};n.prototype.getPath=function(e){var t=e.lastIndexOf("?");return t>0&&(e=e.slice(0,t)),(t=e.lastIndexOf("/"))<0&&(t=e.lastIndexOf("\\")),t<0?"":e.slice(0,t+1)},n.prototype.tryAppendExtension=function(e,t){return/(\.[a-z]*$)|([\?;].*)$/.test(e)?e:e+t},n.prototype.tryAppendLessExtension=function(e){return this.tryAppendExtension(e,".less")},n.prototype.supportsSync=function(){return!1},n.prototype.alwaysMakePathsAbsolute=function(){return!1},n.prototype.isPathAbsolute=function(e){return/^(?:[a-z-]+:|\/|\\|#)/i.test(e)},n.prototype.join=function(e,t){return e?e+t:t},n.prototype.pathDiff=function(e,t){var i,n,o,r,a=this.extractUrlParts(e),s=this.extractUrlParts(t),l="";if(a.hostPart!==s.hostPart)return"";for(n=Math.max(s.directories.length,a.directories.length),i=0;i<n&&s.directories[i]===a.directories[i];i++);for(r=s.directories.slice(i),o=a.directories.slice(i),i=0;i<r.length-1;i++)l+="../";for(i=0;i<o.length-1;i++)l+=o[i]+"/";return l},n.prototype.extractUrlParts=function(e,t){var i,n,o=/^((?:[a-z-]+:)?\/{2}(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/i,r=e.match(o),a={},s=[];if(!r)throw new Error("Could not parse sheet href - '"+e+"'");if(t&&(!r[1]||r[2])){if(!(n=t.match(o)))throw new Error("Could not parse page url - '"+t+"'");r[1]=r[1]||n[1]||"",r[2]||(r[3]=n[3]+r[3])}if(r[3]){for(s=r[3].replace(/\\/g,"/").split("/"),i=0;i<s.length;i++)"."===s[i]&&(s.splice(i,1),i-=1);for(i=0;i<s.length;i++)".."===s[i]&&i>0&&(s.splice(i-1,2),i-=2)}return a.hostPart=r[1],a.directories=s,a.path=(r[1]||"")+s.join("/"),a.filename=r[4],a.fileUrl=a.path+(r[4]||""),a.url=a.fileUrl+(r[5]||""),a},t.exports=n},{}],17:[function(e,t,i){var n=e("../functions/function-registry"),o=e("../less-error"),r=function(){};function a(e,t){throw new o({type:t||"Syntax",message:e})}r.prototype.evalPlugin=function(e,t,i,o){var r,a,s,l,d;l=t.pluginManager,o&&(d="string"==typeof o?o:o.filename);var c=(new this.less.FileManager).extractUrlParts(d).filename;if(d&&(a=l.get(d)))return this.trySetOptions(a,d,c,i),a.use&&a.use.call(this.context,a),a;s={exports:{},pluginManager:l,fileInfo:o},r=n.create();try{if((a=new Function("module","require","functions","tree","fileInfo",e)(s,this.require,r,this.less.tree,o))||(a=s.exports),!(a=this.validatePlugin(a,d,c)))return new this.less.LessError({message:"Not a valid plugin"});l.addPlugin(a,o.filename,r),a.functions=r.getLocalFunctions(),this.trySetOptions(a,d,c,i),a.use&&a.use.call(this.context,a)}catch(e){return console.log(e.stack),new this.less.LessError({message:"Plugin evaluation error: '"+e.name+": "+e.message.replace(/["]/g,"'")+"'",filename:d,line:this.line,col:this.column})}return a},r.prototype.trySetOptions=function(e,t,i,n){if(n){if(!e.setOptions)return a("Options have been provided but the plugin "+i+" does not support any options."),null;try{e.setOptions(n)}catch(e){return a("Error setting options on plugin "+i+"\n"+e.message),null}}},r.prototype.validatePlugin=function(e,t,i){return e?("function"==typeof e&&(e=new e),e.minVersion&&this.compareVersion(e.minVersion,this.less.version)<0?(a("Plugin "+i+" requires version "+this.versionToString(e.minVersion)),null):e):null},r.prototype.compareVersion=function(e,t){"string"==typeof e&&(e=e.match(/^(\d+)\.?(\d+)?\.?(\d+)?/)).shift();for(var i=0;i<e.length;i++)if(e[i]!==t[i])return parseInt(e[i])>parseInt(t[i])?-1:1;return 0},r.prototype.versionToString=function(e){for(var t="",i=0;i<e.length;i++)t+=(t?".":"")+e[i];return t},r.prototype.printUsage=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.printUsage&&i.printUsage()}},t.exports=r},{"../functions/function-registry":24,"../less-error":34}],18:[function(e,t,i){var n=e("../logger"),o=function(e,t){this.fileManagers=t||[],e=e||{};for(var i=[],n=i.concat(["encodeBase64","mimeLookup","charsetLookup","getSourceMapGenerator"]),o=0;o<n.length;o++){var r=n[o],a=e[r];a?this[r]=a.bind(e):o<i.length&&this.warn("missing required function in environment - "+r)}};o.prototype.getFileManager=function(e,t,i,o,r){e||n.warn("getFileManager called with no filename.. Please report this issue. continuing."),null==t&&n.warn("getFileManager called with null directory.. Please report this issue. continuing.");var a=this.fileManagers;i.pluginManager&&(a=[].concat(a).concat(i.pluginManager.getFileManagers()));for(var s=a.length-1;s>=0;s--){var l=a[s];if(l[r?"supportsSync":"supports"](e,t,i,o))return l}return null},o.prototype.addFileManager=function(e){this.fileManagers.push(e)},o.prototype.clearFileManagers=function(){this.fileManagers=[]},t.exports=o},{"../logger":35}],19:[function(e,t,i){var n=e("../tree/color"),o=e("./function-registry");function r(e,t,i){var o,r,a,s,l=t.alpha,d=i.alpha,c=[];a=d+l*(1-d);for(var u=0;u<3;u++)s=e(o=t.rgb[u]/255,r=i.rgb[u]/255),a&&(s=(d*r+l*(o-d*(o+r-s)))/a),c[u]=255*s;return new n(c,a)}var a={multiply:function(e,t){return e*t},screen:function(e,t){return e+t-e*t},overlay:function(e,t){return(e*=2)<=1?a.multiply(e,t):a.screen(e-1,t)},softlight:function(e,t){var i=1,n=e;return t>.5&&(n=1,i=e>.25?Math.sqrt(e):((16*e-12)*e+4)*e),e-(1-2*t)*n*(i-e)},hardlight:function(e,t){return a.overlay(t,e)},difference:function(e,t){return Math.abs(e-t)},exclusion:function(e,t){return e+t-2*e*t},average:function(e,t){return(e+t)/2},negation:function(e,t){return 1-Math.abs(e+t-1)}};for(var s in a)a.hasOwnProperty(s)&&(r[s]=r.bind(null,a[s]));o.addMultiple(r)},{"../tree/color":52,"./function-registry":24}],20:[function(e,t,i){var n,o=e("../tree/dimension"),r=e("../tree/color"),a=e("../tree/quoted"),s=e("../tree/anonymous"),l=e("./function-registry");function d(e){return Math.min(1,Math.max(0,e))}function c(e){return n.hsla(e.h,e.s,e.l,e.a)}function u(e){if(e instanceof o)return parseFloat(e.unit.is("%")?e.value/100:e.value);if("number"==typeof e)return e;throw{type:"Argument",message:"color functions take numbers as parameters"}}n={rgb:function(e,t,i){return n.rgba(e,t,i,1)},rgba:function(e,t,i,n){var a=[e,t,i].map(function(e){return i=255,(t=e)instanceof o&&t.unit.is("%")?parseFloat(t.value*i/100):u(t);var t,i});return n=u(n),new r(a,n)},hsl:function(e,t,i){return n.hsla(e,t,i,1)},hsla:function(e,t,i,o){var r,a;function s(e){return 6*(e=e<0?e+1:e>1?e-1:e)<1?r+(a-r)*e*6:2*e<1?a:3*e<2?r+(a-r)*(2/3-e)*6:r}return e=u(e)%360/360,t=d(u(t)),i=d(u(i)),o=d(u(o)),r=2*i-(a=i<=.5?i*(t+1):i+t-i*t),n.rgba(255*s(e+1/3),255*s(e),255*s(e-1/3),o)},hsv:function(e,t,i){return n.hsva(e,t,i,1)},hsva:function(e,t,i,o){var r,a;e=u(e)%360/360*360,t=u(t),i=u(i),o=u(o);var s=[i,i*(1-t),i*(1-(a=e/60-(r=Math.floor(e/60%6)))*t),i*(1-(1-a)*t)],l=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return n.rgba(255*s[l[r][0]],255*s[l[r][1]],255*s[l[r][2]],o)},hue:function(e){return new o(e.toHSL().h)},saturation:function(e){return new o(100*e.toHSL().s,"%")},lightness:function(e){return new o(100*e.toHSL().l,"%")},hsvhue:function(e){return new o(e.toHSV().h)},hsvsaturation:function(e){return new o(100*e.toHSV().s,"%")},hsvvalue:function(e){return new o(100*e.toHSV().v,"%")},red:function(e){return new o(e.rgb[0])},green:function(e){return new o(e.rgb[1])},blue:function(e){return new o(e.rgb[2])},alpha:function(e){return new o(e.toHSL().a)},luma:function(e){return new o(e.luma()*e.alpha*100,"%")},luminance:function(e){var t=.2126*e.rgb[0]/255+.7152*e.rgb[1]/255+.0722*e.rgb[2]/255;return new o(t*e.alpha*100,"%")},saturate:function(e,t,i){if(!e.rgb)return null;var n=e.toHSL();return void 0!==i&&"relative"===i.value?n.s+=n.s*t.value/100:n.s+=t.value/100,n.s=d(n.s),c(n)},desaturate:function(e,t,i){var n=e.toHSL();return void 0!==i&&"relative"===i.value?n.s-=n.s*t.value/100:n.s-=t.value/100,n.s=d(n.s),c(n)},lighten:function(e,t,i){var n=e.toHSL();return void 0!==i&&"relative"===i.value?n.l+=n.l*t.value/100:n.l+=t.value/100,n.l=d(n.l),c(n)},darken:function(e,t,i){var n=e.toHSL();return void 0!==i&&"relative"===i.value?n.l-=n.l*t.value/100:n.l-=t.value/100,n.l=d(n.l),c(n)},fadein:function(e,t,i){var n=e.toHSL();return void 0!==i&&"relative"===i.value?n.a+=n.a*t.value/100:n.a+=t.value/100,n.a=d(n.a),c(n)},fadeout:function(e,t,i){var n=e.toHSL();return void 0!==i&&"relative"===i.value?n.a-=n.a*t.value/100:n.a-=t.value/100,n.a=d(n.a),c(n)},fade:function(e,t){var i=e.toHSL();return i.a=t.value/100,i.a=d(i.a),c(i)},spin:function(e,t){var i=e.toHSL(),n=(i.h+t.value)%360;return i.h=n<0?360+n:n,c(i)},mix:function(e,t,i){e.toHSL&&t.toHSL||(console.log(t.type),console.dir(t)),i||(i=new o(50));var n=i.value/100,a=2*n-1,s=e.toHSL().a-t.toHSL().a,l=((a*s==-1?a:(a+s)/(1+a*s))+1)/2,d=1-l,c=[e.rgb[0]*l+t.rgb[0]*d,e.rgb[1]*l+t.rgb[1]*d,e.rgb[2]*l+t.rgb[2]*d],u=e.alpha*n+t.alpha*(1-n);return new r(c,u)},greyscale:function(e){return n.desaturate(e,new o(100))},contrast:function(e,t,i,o){if(!e.rgb)return null;void 0===t&&(t=n.rgba(0,0,0,1)),void 0===i&&(i=n.rgba(255,255,255,1));var r=e.luma(),a=t.luma(),s=i.luma();return(r>a?(r+.05)/(a+.05):(a+.05)/(r+.05))>(r>s?(r+.05)/(s+.05):(s+.05)/(r+.05))?t:i},argb:function(e){return new s(e.toARGB())},color:function(e){if(e instanceof a&&/^#([a-f0-9]{6}|[a-f0-9]{3})$/i.test(e.value))return new r(e.value.slice(1));if(e instanceof r||(e=r.fromKeyword(e.value)))return e.value=void 0,e;throw{type:"Argument",message:"argument must be a color keyword or 3/6 digit hex e.g. #FFF"}},tint:function(e,t){return n.mix(n.rgb(255,255,255),e,t)},shade:function(e,t){return n.mix(n.rgb(0,0,0),e,t)}},l.addMultiple(n)},{"../tree/anonymous":47,"../tree/color":52,"../tree/dimension":59,"../tree/quoted":77,"./function-registry":24}],21:[function(e,t,i){t.exports=function(t){var i=e("../tree/quoted"),n=e("../tree/url"),o=e("./function-registry"),r=function(e,t){return new n(t,e.index,e.currentFileInfo).eval(e.context)},a=e("../logger");o.add("data-uri",function(e,o){o||(o=e,e=null);var s=e&&e.value,l=o.value,d=this.currentFileInfo,c=d.relativeUrls?d.currentDirectory:d.entryPath,u=l.indexOf("#"),p="";-1!==u&&(p=l.slice(u),l=l.slice(0,u));var m=t.getFileManager(l,c,this.context,t,!0);if(!m)return r(this,o);var h=!1;if(e)h=/;base64$/.test(s);else{if("image/svg+xml"===(s=t.mimeLookup(l)))h=!1;else{var f=t.charsetLookup(s);h=["US-ASCII","UTF-8"].indexOf(f)<0}h&&(s+=";base64")}var g=m.loadFileSync(l,c,this.context,t);if(!g.contents)return a.warn("Skipped data-uri embedding of "+l+" because file not found"),r(this,o||e);var b=g.contents;if(h&&!t.encodeBase64)return r(this,o);var v="data:"+s+","+(b=h?t.encodeBase64(b):encodeURIComponent(b))+p;return v.length>=32768&&!1!==this.context.ieCompat?(a.warn("Skipped data-uri embedding of "+l+" because its size ("+v.length+" characters) exceeds IE8-safe 32768 characters!"),r(this,o||e)):new n(new i('"'+v+'"',v,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../logger":35,"../tree/quoted":77,"../tree/url":84,"./function-registry":24}],22:[function(e,t,i){var n=e("../tree/keyword"),o={eval:function(){var e=this.value_,t=this.error_;if(t)throw t;if(null!=e)return e?n.True:n.False},value:function(e){this.value_=e},error:function(e){this.error_=e},reset:function(){this.value_=this.error_=null}};e("./function-registry").add("default",o.eval.bind(o)),t.exports=o},{"../tree/keyword":68,"./function-registry":24}],23:[function(e,t,i){var n=e("../tree/expression"),o=function(e,t,i,n){this.name=e.toLowerCase(),this.index=i,this.context=t,this.currentFileInfo=n,this.func=t.frames[0].functionRegistry.get(this.name)};o.prototype.isValid=function(){return Boolean(this.func)},o.prototype.call=function(e){return Array.isArray(e)&&(e=e.filter(function(e){return"Comment"!==e.type}).map(function(e){if("Expression"===e.type){var t=e.value.filter(function(e){return"Comment"!==e.type});return 1===t.length?t[0]:new n(t)}return e})),this.func.apply(this,e)},t.exports=o},{"../tree/expression":62}],24:[function(e,t,i){t.exports=function e(t){return{_data:{},add:function(e,t){e=e.toLowerCase(),this._data.hasOwnProperty(e),this._data[e]=t},addMultiple:function(e){Object.keys(e).forEach(function(t){this.add(t,e[t])}.bind(this))},get:function(e){return this._data[e]||t&&t.get(e)},getLocalFunctions:function(){return this._data},inherit:function(){return e(this)},create:function(t){return e(t)}}}(null)},{}],25:[function(e,t,i){t.exports=function(t){var i={functionRegistry:e("./function-registry"),functionCaller:e("./function-caller")};return e("./default"),e("./color"),e("./color-blending"),e("./data-uri")(t),e("./math"),e("./number"),e("./string"),e("./svg")(t),e("./types"),i}},{"./color":20,"./color-blending":19,"./data-uri":21,"./default":22,"./function-caller":23,"./function-registry":24,"./math":27,"./number":28,"./string":29,"./svg":30,"./types":31}],26:[function(e,t,i){var n=e("../tree/dimension"),o=function(){};o._math=function(e,t,i){if(!(i instanceof n))throw{type:"Argument",message:"argument must be a number"};return null==t?t=i.unit:i=i.unify(),new n(e(parseFloat(i.value)),t)},t.exports=o},{"../tree/dimension":59}],27:[function(e,t,i){var n=e("./function-registry"),o=e("./math-helper.js"),r={ceil:null,floor:null,sqrt:null,abs:null,tan:"",sin:"",cos:"",atan:"rad",asin:"rad",acos:"rad"};for(var a in r)r.hasOwnProperty(a)&&(r[a]=o._math.bind(null,Math[a],r[a]));r.round=function(e,t){var i=void 0===t?0:t.value;return o._math(function(e){return e.toFixed(i)},null,e)},n.addMultiple(r)},{"./function-registry":24,"./math-helper.js":26}],28:[function(e,t,i){var n=e("../tree/dimension"),o=e("../tree/anonymous"),r=e("./function-registry"),a=e("./math-helper.js"),s=function(e,t){switch((t=Array.prototype.slice.call(t)).length){case 0:throw{type:"Argument",message:"one or more arguments required"}}var i,r,a,s,l,d,c,u,p=[],m={};for(i=0;i<t.length;i++)if((a=t[i])instanceof n)if(c=""!==(d=""===(s=""===a.unit.toString()&&void 0!==u?new n(a.value,u).unify():a.unify()).unit.toString()&&void 0!==c?c:s.unit.toString())&&void 0===c||""!==d&&""===p[0].unify().unit.toString()?d:c,u=""!==d&&void 0===u?a.unit.toString():u,void 0!==(r=void 0!==m[""]&&""!==d&&d===c?m[""]:m[d]))l=""===p[r].unit.toString()&&void 0!==u?new n(p[r].value,u).unify():p[r].unify(),(e&&s.value<l.value||!e&&s.value>l.value)&&(p[r]=a);else{if(void 0!==c&&d!==c)throw{type:"Argument",message:"incompatible types"};m[d]=p.length,p.push(a)}else Array.isArray(t[i].value)&&Array.prototype.push.apply(t,Array.prototype.slice.call(t[i].value));return 1==p.length?p[0]:(t=p.map(function(e){return e.toCSS(this.context)}).join(this.context.compress?",":", "),new o((e?"min":"max")+"("+t+")"))};r.addMultiple({min:function(){return s(!0,arguments)},max:function(){return s(!1,arguments)},convert:function(e,t){return e.convertTo(t.value)},pi:function(){return new n(Math.PI)},mod:function(e,t){return new n(e.value%t.value,e.unit)},pow:function(e,t){if("number"==typeof e&&"number"==typeof t)e=new n(e),t=new n(t);else if(!(e instanceof n&&t instanceof n))throw{type:"Argument",message:"arguments must be numbers"};return new n(Math.pow(e.value,t.value),e.unit)},percentage:function(e){return a._math(function(e){return 100*e},"%",e)}})},{"../tree/anonymous":47,"../tree/dimension":59,"./function-registry":24,"./math-helper.js":26}],29:[function(e,t,i){var n=e("../tree/quoted"),o=e("../tree/anonymous"),r=e("../tree/javascript");e("./function-registry").addMultiple({e:function(e){return new o(e instanceof r?e.evaluated:e.value)},escape:function(e){return new o(encodeURI(e.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},replace:function(e,t,i,o){var r=e.value;return i="Quoted"===i.type?i.value:i.toCSS(),r=r.replace(new RegExp(t.value,o?o.value:""),i),new n(e.quote||"",r,e.escaped)},"%":function(e){for(var t=Array.prototype.slice.call(arguments,1),i=e.value,o=0;o<t.length;o++)i=i.replace(/%[sda]/i,function(e){var i="Quoted"===t[o].type&&e.match(/s/i)?t[o].value:t[o].toCSS();return e.match(/[A-Z]$/)?encodeURIComponent(i):i});return i=i.replace(/%%/g,"%"),new n(e.quote||"",i,e.escaped)}})},{"../tree/anonymous":47,"../tree/javascript":66,"../tree/quoted":77,"./function-registry":24}],30:[function(e,t,i){t.exports=function(t){var i=e("../tree/dimension"),n=e("../tree/color"),o=e("../tree/expression"),r=e("../tree/quoted"),a=e("../tree/url");e("./function-registry").add("svg-gradient",function(e){var t,s,l,d,c,u,p,m,h="linear",f='x="0" y="0" width="1" height="1"',g={compress:!1},b=e.toCSS(g);function v(){throw{type:"Argument",message:"svg-gradient expects direction, start_color [start_position], [color position,]..., end_color [end_position] or direction, color list"}}switch(2==arguments.length?(arguments[1].value.length<2&&v(),t=arguments[1].value):arguments.length<3?v():t=Array.prototype.slice.call(arguments,1),b){case"to bottom":s='x1="0%" y1="0%" x2="0%" y2="100%"';break;case"to right":s='x1="0%" y1="0%" x2="100%" y2="0%"';break;case"to bottom right":s='x1="0%" y1="0%" x2="100%" y2="100%"';break;case"to top right":s='x1="0%" y1="100%" x2="100%" y2="0%"';break;case"ellipse":case"ellipse at center":h="radial",s='cx="50%" cy="50%" r="75%"',f='x="-50" y="-50" width="101" height="101"';break;default:throw{type:"Argument",message:"svg-gradient direction must be 'to bottom', 'to right', 'to bottom right', 'to top right' or 'ellipse at center'"}}for(l='<?xml version="1.0" ?><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><'+h+'Gradient id="gradient" gradientUnits="userSpaceOnUse" '+s+">",d=0;d<t.length;d+=1)t[d]instanceof o?(c=t[d].value[0],u=t[d].value[1]):(c=t[d],u=void 0),c instanceof n&&((0===d||d+1===t.length)&&void 0===u||u instanceof i)||v(),p=u?u.toCSS(g):0===d?"0%":"100%",m=c.alpha,l+='<stop offset="'+p+'" stop-color="'+c.toRGB()+'"'+(m<1?' stop-opacity="'+m+'"':"")+"/>";return l+="</"+h+"Gradient><rect "+f+' fill="url(#gradient)" /></svg>',l=encodeURIComponent(l),new a(new r("'"+(l="data:image/svg+xml,"+l)+"'",l,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../tree/color":52,"../tree/dimension":59,"../tree/expression":62,"../tree/quoted":77,"../tree/url":84,"./function-registry":24}],31:[function(e,t,i){var n=e("../tree/keyword"),o=e("../tree/detached-ruleset"),r=e("../tree/dimension"),a=e("../tree/color"),s=e("../tree/quoted"),l=e("../tree/anonymous"),d=e("../tree/url"),c=e("../tree/operation"),u=e("./function-registry"),p=function(e,t){return e instanceof t?n.True:n.False},m=function(e,t){if(void 0===t)throw{type:"Argument",message:"missing the required second argument to isunit."};if("string"!=typeof(t="string"==typeof t.value?t.value:t))throw{type:"Argument",message:"Second argument to isunit should be a unit or a string."};return e instanceof r&&e.unit.is(t)?n.True:n.False},h=function(e){return Array.isArray(e.value)?e.value:Array(e)};u.addMultiple({isruleset:function(e){return p(e,o)},iscolor:function(e){return p(e,a)},isnumber:function(e){return p(e,r)},isstring:function(e){return p(e,s)},iskeyword:function(e){return p(e,n)},isurl:function(e){return p(e,d)},ispixel:function(e){return m(e,"px")},ispercentage:function(e){return m(e,"%")},isem:function(e){return m(e,"em")},isunit:m,unit:function(e,t){if(!(e instanceof r))throw{type:"Argument",message:"the first argument to unit must be a number"+(e instanceof c?". Have you forgotten parenthesis?":"")};return t=t?t instanceof n?t.value:t.toCSS():"",new r(e.value,t)},"get-unit":function(e){return new l(e.unit)},extract:function(e,t){return t=t.value-1,h(e)[t]},length:function(e){return new r(h(e).length)}})},{"../tree/anonymous":47,"../tree/color":52,"../tree/detached-ruleset":58,"../tree/dimension":59,"../tree/keyword":68,"../tree/operation":74,"../tree/quoted":77,"../tree/url":84,"./function-registry":24}],32:[function(e,t,i){var n=e("./contexts"),o=e("./parser/parser"),r=e("./less-error");t.exports=function(e){var t=function(e,t,i){this.less=e,this.rootFilename=i.filename,this.paths=t.paths||[],this.contents={},this.contentsIgnoredChars={},this.mime=t.mime,this.error=null,this.context=t,this.queue=[],this.files={}};return t.prototype.push=function(t,i,a,s,l){var d=this,c=this.context.pluginManager.Loader;this.queue.push(t);var u=function(e,i,n){d.queue.splice(d.queue.indexOf(t),1);var o=n===d.rootFilename;s.optional&&e?l(null,{rules:[]},!1,null):(d.files[n]=i,e&&!d.error&&(d.error=e),l(e,i,o,n))},p={relativeUrls:this.context.relativeUrls,entryPath:a.entryPath,rootpath:a.rootpath,rootFilename:a.rootFilename},m=e.getFileManager(t,a.currentDirectory,this.context,e);if(m){i&&(t=s.isPlugin?t:m.tryAppendExtension(t,".less"));var h,f=function(e){var t,i=e.filename,l=e.contents.replace(/^\uFEFF/,"");p.currentDirectory=m.getPath(i),p.relativeUrls&&(p.rootpath=m.join(d.context.rootpath||"",m.pathDiff(p.currentDirectory,p.entryPath)),!m.isPathAbsolute(p.rootpath)&&m.alwaysMakePathsAbsolute()&&(p.rootpath=m.join(p.entryPath,p.rootpath))),p.filename=i;var h=new n.Parse(d.context);h.processImports=!1,d.contents[i]=l,(a.reference||s.reference)&&(p.reference=!0),s.isPlugin?(t=c.evalPlugin(l,h,s.pluginArgs,p))instanceof r?u(t,null,i):u(null,t,i):s.inline?u(null,l,i):new o(h,d,p).parse(l,function(e,t){u(e,t,i)})},g=function(e,t){e?u(e):f(t)};if(s.isPlugin)try{c.tryLoadPlugin(t,a.currentDirectory,g)}catch(e){l(e)}else(h=m.loadFile(t,a.currentDirectory,this.context,e,g))&&h.then(f,u)}else u({message:"Could not find a file-manager for "+t})},t}},{"./contexts":12,"./less-error":34,"./parser/parser":40}],33:[function(e,t,i){t.exports=function(t,i){var n,o,r,a,s;return{version:[3,0,0],data:e("./data"),tree:e("./tree"),Environment:s=e("./environment/environment"),AbstractFileManager:e("./environment/abstract-file-manager"),AbstractPluginLoader:e("./environment/abstract-plugin-loader"),environment:t=new s(t,i),visitors:e("./visitors"),Parser:e("./parser/parser"),functions:e("./functions")(t),contexts:e("./contexts"),SourceMapOutput:n=e("./source-map-output")(t),SourceMapBuilder:o=e("./source-map-builder")(n,t),ParseTree:r=e("./parse-tree")(o),ImportManager:a=e("./import-manager")(t),render:e("./render")(t,r,a),parse:e("./parse")(t,r,a),LessError:e("./less-error"),transformTree:e("./transform-tree"),utils:e("./utils"),PluginManager:e("./plugin-manager"),logger:e("./logger")}}},{"./contexts":12,"./data":14,"./environment/abstract-file-manager":16,"./environment/abstract-plugin-loader":17,"./environment/environment":18,"./functions":25,"./import-manager":32,"./less-error":34,"./logger":35,"./parse":37,"./parse-tree":36,"./parser/parser":40,"./plugin-manager":41,"./render":42,"./source-map-builder":43,"./source-map-output":44,"./transform-tree":45,"./tree":65,"./utils":87,"./visitors":91}],34:[function(e,t,i){var n=e("./utils"),o=t.exports=function(e,t,i){Error.call(this);var o=e.filename||i;if(t&&o){var r=t.contents[o],a=n.getLocation(e.index,r),s=a.line,l=a.column,d=e.call&&n.getLocation(e.call,r).line,c=r.split("\n");this.type=e.type||"Syntax",this.filename=o,this.index=e.index,this.line="number"==typeof s?s+1:null,this.callLine=d+1,this.callExtract=c[d],this.column=l,this.extract=[c[s-1],c[s],c[s+1]]}this.message=e.message,this.stack=e.stack};if(void 0===Object.create){var r=function(){};r.prototype=Error.prototype,o.prototype=new r}else o.prototype=Object.create(Error.prototype);o.prototype.constructor=o},{"./utils":87}],35:[function(e,t,i){t.exports={error:function(e){this._fireEvent("error",e)},warn:function(e){this._fireEvent("warn",e)},info:function(e){this._fireEvent("info",e)},debug:function(e){this._fireEvent("debug",e)},addListener:function(e){this._listeners.push(e)},removeListener:function(e){for(var t=0;t<this._listeners.length;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)},_fireEvent:function(e,t){for(var i=0;i<this._listeners.length;i++){var n=this._listeners[i][e];n&&n(t)}},_listeners:[]}},{}],36:[function(e,t,i){var n=e("./less-error"),o=e("./transform-tree"),r=e("./logger");t.exports=function(e){var t=function(e,t){this.root=e,this.imports=t};return t.prototype.toCSS=function(t){var i,a,s={};try{i=o(this.root,t)}catch(e){throw new n(e,this.imports)}try{var l=Boolean(t.compress);l&&r.warn("The compress option has been deprecated. We recommend you use a dedicated css minifier, for instance see less-plugin-clean-css.");var d={compress:l,dumpLineNumbers:t.dumpLineNumbers,strictUnits:Boolean(t.strictUnits),numPrecision:8};t.sourceMap?(a=new e(t.sourceMap),s.css=a.toCSS(i,d,this.imports)):s.css=i.toCSS(d)}catch(e){throw new n(e,this.imports)}if(t.pluginManager)for(var c=t.pluginManager.getPostProcessors(),u=0;u<c.length;u++)s.css=c[u].process(s.css,{sourceMap:a,options:t,imports:this.imports});for(var p in t.sourceMap&&(s.map=a.getExternalSourceMap()),s.imports=[],this.imports.files)this.imports.files.hasOwnProperty(p)&&p!==this.imports.rootFilename&&s.imports.push(p);return s},t}},{"./less-error":34,"./logger":35,"./transform-tree":45}],37:[function(e,t,i){var n,o=e("./contexts"),r=e("./parser/parser"),a=e("./plugin-manager"),s=e("./less-error");t.exports=function(t,i,l){var d=function(t,i,c){if("function"==typeof(i=i||{})&&(c=i,i={}),!c){n||(n="undefined"==typeof Promise?e("promise"):Promise);var u=this;return new n(function(e,n){d.call(u,t,i,function(t,i){t?n(t):e(i)})})}var p,m,h=new a(this,!0);if(i.pluginManager=h,p=new o.Parse(i),i.rootFileInfo)m=i.rootFileInfo;else{var f=i.filename||"input",g=f.replace(/[^\/\\]*$/,"");(m={filename:f,relativeUrls:p.relativeUrls,rootpath:p.rootpath||"",currentDirectory:g,entryPath:g,rootFilename:f}).rootpath&&"/"!==m.rootpath.slice(-1)&&(m.rootpath+="/")}var b=new l(this,p,m);this.importManager=b,i.plugins&&i.plugins.forEach(function(e){var t,i;if(e.fileContent){if(i=e.fileContent.replace(/^\uFEFF/,""),(t=h.Loader.evalPlugin(i,p,e.options,e.filename))instanceof s)return c(t)}else h.addPlugin(e)}),new r(p,b,m).parse(t,function(e,t){if(e)return c(e);c(null,t,b,i)},i)};return d}},{"./contexts":12,"./less-error":34,"./parser/parser":40,"./plugin-manager":41,promise:void 0}],38:[function(e,t,i){t.exports=function(e,t){var i,n,o,r,a,s,l,d,c,u=e.length,p=0,m=0,h=[],f=0;function g(t){var i=a-f;i<512&&!t||!i||(h.push(e.slice(f,a+1)),f=a+1)}for(a=0;a<u;a++)if(!((l=e.charCodeAt(a))>=97&&l<=122||l<34))switch(l){case 40:m++,n=a;continue;case 41:if(--m<0)return t("missing opening `(`",a);continue;case 59:m||g();continue;case 123:p++,i=a;continue;case 125:if(--p<0)return t("missing opening `{`",a);p||m||g();continue;case 92:if(a<u-1){a++;continue}return t("unescaped `\\`",a);case 34:case 39:case 96:for(c=0,s=a,a+=1;a<u;a++)if(!((d=e.charCodeAt(a))>96)){if(d==l){c=1;break}if(92==d){if(a==u-1)return t("unescaped `\\`",a);a++}}if(c)continue;return t("unmatched `"+String.fromCharCode(l)+"`",s);case 47:if(m||a==u-1)continue;if(47==(d=e.charCodeAt(a+1)))for(a+=2;a<u&&(!((d=e.charCodeAt(a))<=13)||10!=d&&13!=d);a++);else if(42==d){for(o=s=a,a+=2;a<u-1&&(125==(d=e.charCodeAt(a))&&(r=a),42!=d||47!=e.charCodeAt(a+1));a++);if(a==u-1)return t("missing closing `*/`",s);a++}continue;case 42:if(a<u-1&&47==e.charCodeAt(a+1))return t("unmatched `/*`",a);continue}return 0!==p?t(o>i&&r>o?"missing closing `}` or `*/`":"missing closing `}`",i):0!==m?t("missing closing `)`",n):(g(!0),h)}},{}],39:[function(e,t,i){var n=e("./chunker");t.exports=function(){var e,t,i,o,r,a,s,l=[],d={},c=32,u=9,p=10,m=13,h=47;function f(i){for(var n,o,l,g=d.i,b=t,v=d.i-s,y=d.i+a.length-v,x=d.i+=i,z=e;d.i<y;d.i++){if(n=z.charCodeAt(d.i),d.autoCommentAbsorb&&n===h){if("/"===(o=z.charAt(d.i+1))){l={index:d.i,isLineComment:!0};var C=z.indexOf("\n",d.i+2);C<0&&(C=y),d.i=C,l.text=z.substr(l.index,d.i-l.index),d.commentStore.push(l);continue}if("*"===o){var w=z.indexOf("*/",d.i+2);if(w>=0){l={index:d.i,text:z.substr(d.i,w+2-d.i),isLineComment:!1},d.i+=l.text.length-1,d.commentStore.push(l);continue}}break}if(n!==c&&n!==p&&n!==u&&n!==m)break}if(a=a.slice(i+d.i-x+v),s=d.i,!a.length){if(t<r.length-1)return a=r[++t],f(0),!0;d.finished=!0}return g!==d.i||b!==t}return d.save=function(){s=d.i,l.push({current:a,i:d.i,j:t})},d.restore=function(e){(d.i>i||d.i===i&&e&&!o)&&(i=d.i,o=e);var n=l.pop();a=n.current,s=d.i=n.i,t=n.j},d.forget=function(){l.pop()},d.isWhitespace=function(t){var i=d.i+(t||0),n=e.charCodeAt(i);return n===c||n===m||n===u||n===p},d.$re=function(e){d.i>s&&(a=a.slice(d.i-s),s=d.i);var t=e.exec(a);return t?(f(t[0].length),"string"==typeof t?t:1===t.length?t[0]:t):null},d.$char=function(t){return e.charAt(d.i)!==t?null:(f(1),t)},d.$str=function(t){for(var i=t.length,n=0;n<i;n++)if(e.charAt(d.i+n)!==t.charAt(n))return null;return f(i),t},d.$quoted=function(){var t=e.charAt(d.i);if("'"===t||'"'===t){for(var i=e.length,n=d.i,o=1;o+n<i;o++){switch(e.charAt(o+n)){case"\\":o++;continue;case"\r":case"\n":break;case t:var r=e.substr(n,o+1);return f(o+1),r}}return null}},d.autoCommentAbsorb=!0,d.commentStore=[],d.finished=!1,d.peek=function(t){if("string"==typeof t){for(var i=0;i<t.length;i++)if(e.charAt(d.i+i)!==t.charAt(i))return!1;return!0}return t.test(a)},d.peekChar=function(t){return e.charAt(d.i)===t},d.currentChar=function(){return e.charAt(d.i)},d.getInput=function(){return e},d.peekNotNumeric=function(){var t=e.charCodeAt(d.i);return t>57||t<43||t===h||44===t},d.start=function(o,l,c){e=o,d.i=t=s=i=0,r=l?n(o,c):[o],a=r[0],f(0)},d.end=function(){var t,n=d.i>=e.length;return d.i<i&&(t=o,d.i=i),{isFinished:n,furthest:d.i,furthestPossibleErrorMessage:t,furthestReachedEnd:d.i>=e.length-1,furthestChar:e[d.i]}},d}},{"./chunker":38}],40:[function(e,t,i){var n=e("../less-error"),o=e("../tree"),r=e("../visitors"),a=e("./parser-input"),s=e("../utils"),l=function e(t,i,l){var d,c=a();function u(e,t){throw new n({index:c.i,filename:l.filename,type:t||"Syntax",message:e},i)}function p(e,t,i){var n=e instanceof Function?e.call(d):c.$re(e);if(n)return n;u(t||("string"==typeof e?"expected '"+e+"' got '"+c.currentChar()+"'":"unexpected token"))}function m(e,t){if(c.$char(e))return e;u(t||"expected '"+e+"' got '"+c.currentChar()+"'")}function h(e){var t=l.filename;return{lineNumber:s.getLocation(e,c.getInput()).line+1,fileName:t}}return{parserInput:c,imports:i,fileInfo:l,parse:function(a,s,d){var u,p,m,h,f=null,g="";if(p=d&&d.globalVars?e.serializeVars(d.globalVars)+"\n":"",m=d&&d.modifyVars?"\n"+e.serializeVars(d.modifyVars):"",t.pluginManager)for(var b=t.pluginManager.getPreProcessors(),v=0;v<b.length;v++)a=b[v].process(a,{context:t,imports:i,fileInfo:l});(p||d&&d.banner)&&(g=(d&&d.banner?d.banner:"")+p,(h=i.contentsIgnoredChars)[l.filename]=h[l.filename]||0,h[l.filename]+=g.length),a=g+(a=a.replace(/\r\n?/g,"\n")).replace(/^\uFEFF/,"")+m,i.contents[l.filename]=a;try{c.start(a,t.chunkInput,function(e,t){throw new n({index:t,type:"Parse",message:e,filename:l.filename},i)}),o.Node.prototype.parse=this,(u=new o.Ruleset(null,this.parsers.primary())).root=!0,u.firstRoot=!0}catch(e){return s(new n(e,i,l.filename))}var y=c.end();if(!y.isFinished){var x=y.furthestPossibleErrorMessage;x||(x="Unrecognised input","}"===y.furthestChar?x+=". Possibly missing opening '{'":")"===y.furthestChar?x+=". Possibly missing opening '('":y.furthestReachedEnd&&(x+=". Possibly missing something")),f=new n({type:"Parse",message:x,index:y.furthest,filename:l.filename},i)}var z=function(e){return(e=f||e||i.error)?(e instanceof n||(e=new n(e,i,l.filename)),s(e)):s(null,u)};if(!1===t.processImports)return z();new r.ImportVisitor(i,z).run(u)},parsers:d={primary:function(){for(var e,t=this.mixin,i=[];;){for(;e=this.comment();)i.push(e);if(c.finished)break;if(c.peek("}"))break;if(e=this.extendRule())i=i.concat(e);else if(e=t.definition()||this.declaration()||this.ruleset()||t.call()||this.rulesetCall()||this.entities.call()||this.atrule())i.push(e);else{for(var n=!1;c.$char(";");)n=!0;if(!n)break}}return i},comment:function(){if(c.commentStore.length){var e=c.commentStore.shift();return new o.Comment(e.text,e.isLineComment,e.index,l)}},entities:{quoted:function(){var e,t=c.i,i=!1;if(c.save(),c.$char("~")&&(i=!0),e=c.$quoted())return c.forget(),new o.Quoted(e.charAt(0),e.substr(1,e.length-2),i,t,l);c.restore()},keyword:function(){var e=c.$char("%")||c.$re(/^[_A-Za-z-][_A-Za-z0-9-]*/);if(e)return o.Color.fromKeyword(e)||new o.Keyword(e)},call:function(){var e,t,i,n=c.i;if(!c.peek(/^url\(/i))if(c.save(),e=c.$re(/^([\w-]+|%|progid:[\w\.]+)\(/)){if("alpha"===(e=e[1]).toLowerCase()&&(i=d.alpha()))return c.forget(),i;if(t=this.arguments(),c.$char(")"))return c.forget(),new o.Call(e,t,n,l);c.restore("Could not parse call arguments or missing ')'")}else c.forget()},arguments:function(){var e,t,i,n=[],r=[],a=[];for(c.save();i=d.detachedRuleset()||this.assignment()||d.expression();)t=i,i.value&&1==i.value.length&&(t=i.value[0]),t&&a.push(t),r.push(t),c.$char(",")||(c.$char(";")||e)&&(e=!0,a.length>1&&(t=new o.Value(a)),n.push(t),a=[]);return c.forget(),e?n:r},literal:function(){return this.dimension()||this.color()||this.quoted()||this.unicodeDescriptor()},assignment:function(){var e,t;if(c.save(),e=c.$re(/^\w+(?=\s?=)/i))if(c.$char("=")){if(t=d.entity())return c.forget(),new o.Assignment(e,t);c.restore()}else c.restore();else c.restore()},url:function(){var e,t=c.i;if(c.autoCommentAbsorb=!1,c.$str("url("))return e=this.quoted()||this.variable()||this.property()||c.$re(/^(?:(?:\\[\(\)'"])|[^\(\)'"])+/)||"",c.autoCommentAbsorb=!0,m(")"),new o.URL(null!=e.value||e instanceof o.Variable||e instanceof o.Property?e:new o.Anonymous(e,t),t,l);c.autoCommentAbsorb=!0},variable:function(){var e,t=c.i;if("@"===c.currentChar()&&(e=c.$re(/^@@?[\w-]+/)))return new o.Variable(e,t,l)},variableCurly:function(){var e,t=c.i;if("@"===c.currentChar()&&(e=c.$re(/^@\{([\w-]+)\}/)))return new o.Variable("@"+e[1],t,l)},property:function(){var e,t=c.i;if("$"===c.currentChar()&&(e=c.$re(/^\$[\w-]+/)))return new o.Property(e,t,l)},propertyCurly:function(){var e,t=c.i;if("$"===c.currentChar()&&(e=c.$re(/^\$\{([\w-]+)\}/)))return new o.Property("$"+e[1],t,l)},color:function(){var e;if("#"===c.currentChar()&&(e=c.$re(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/))){var t=e.input.match(/^#([\w]+).*/);return(t=t[1]).match(/^[A-Fa-f0-9]+$/)||u("Invalid HEX color code"),new o.Color(e[1],void 0,"#"+t)}},colorKeyword:function(){c.save();var e=c.autoCommentAbsorb;c.autoCommentAbsorb=!1;var t=c.$re(/^[_A-Za-z-][_A-Za-z0-9-]+/);if(c.autoCommentAbsorb=e,t){c.restore();var i=o.Color.fromKeyword(t);return i?(c.$str(t),i):void 0}c.forget()},dimension:function(){if(!c.peekNotNumeric()){var e=c.$re(/^([+-]?\d*\.?\d+)(%|[a-z_]+)?/i);return e?new o.Dimension(e[1],e[2]):void 0}},unicodeDescriptor:function(){var e;if(e=c.$re(/^U\+[0-9a-fA-F?]+(\-[0-9a-fA-F?]+)?/))return new o.UnicodeDescriptor(e[0])},javascript:function(){var e,t=c.i;c.save();var i=c.$char("~");if(c.$char("`")){if(e=c.$re(/^[^`]*`/))return c.forget(),new o.JavaScript(e.substr(0,e.length-1),Boolean(i),t,l);c.restore("invalid javascript definition")}else c.restore()}},variable:function(){var e;if("@"===c.currentChar()&&(e=c.$re(/^(@[\w-]+)\s*:/)))return e[1]},rulesetCall:function(){var e;if("@"===c.currentChar()&&(e=c.$re(/^(@[\w-]+)\(\s*\)\s*;/)))return new o.RulesetCall(e[1])},extend:function(e){var t,i,n,r,a,s=c.i;if(c.$str(e?"&:extend(":":extend(")){do{for(n=null,t=null;!(n=c.$re(/^(all)(?=\s*(\)|,))/))&&(i=this.element());)t?t.push(i):t=[i];n=n&&n[1],t||u("Missing target selector for :extend()."),a=new o.Extend(new o.Selector(t),n,s,l),r?r.push(a):r=[a]}while(c.$char(","));return p(/^\)/),e&&p(/^;/),r}},extendRule:function(){return this.extend(!0)},mixin:{call:function(){var e,t,i,n,r,a,s=c.currentChar(),u=!1,p=c.i;if("."===s||"#"===s){for(c.save();e=c.i,n=c.$re(/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/);)i=new o.Element(r,n,e,l),t?t.push(i):t=[i],r=c.$char(">");if(t&&(c.$char("(")&&(a=this.args(!0).args,m(")")),d.important()&&(u=!0),d.end()))return c.forget(),new o.mixin.Call(t,a,p,l,u);c.restore()}},args:function(e){var t,i,n,r,a,s,l,p=d.entities,m={args:null,variadic:!1},h=[],f=[],g=[];for(c.save();;){if(e)s=d.detachedRuleset()||d.expression();else{if(c.commentStore.length=0,c.$str("...")){m.variadic=!0,c.$char(";")&&!t&&(t=!0),(t?f:g).push({variadic:!0});break}s=p.variable()||p.property()||p.literal()||p.keyword()}if(!s)break;r=null,s.throwAwayComments&&s.throwAwayComments(),a=s;var b=null;if(e?s.value&&1==s.value.length&&(b=s.value[0]):b=s,b&&(b instanceof o.Variable||b instanceof o.Property))if(c.$char(":")){if(h.length>0&&(t&&u("Cannot mix ; and , as delimiter types"),i=!0),!(a=d.detachedRuleset()||d.expression())){if(!e)return c.restore(),m.args=[],m;u("could not understand value for named argument")}r=n=b.name}else if(c.$str("...")){if(!e){m.variadic=!0,c.$char(";")&&!t&&(t=!0),(t?f:g).push({name:s.name,variadic:!0});break}l=!0}else e||(n=r=b.name,a=null);a&&h.push(a),g.push({name:r,value:a,expand:l}),c.$char(",")||(c.$char(";")||t)&&(i&&u("Cannot mix ; and , as delimiter types"),t=!0,h.length>1&&(a=new o.Value(h)),f.push({name:n,value:a,expand:l}),n=null,h=[],i=!1)}return c.forget(),m.args=t?f:g,m},definition:function(){var e,t,i,n,r=[],a=!1;if(!("."!==c.currentChar()&&"#"!==c.currentChar()||c.peek(/^[^{]*\}/)))if(c.save(),t=c.$re(/^([#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\s*\(/)){e=t[1];var s=this.args(!1);if(r=s.args,a=s.variadic,!c.$char(")"))return void c.restore("Missing closing ')'");if(c.commentStore.length=0,c.$str("when")&&(n=p(d.conditions,"expected condition")),i=d.block())return c.forget(),new o.mixin.Definition(e,r,i,n,a);c.restore()}else c.forget()}},entity:function(){var e=this.entities;return this.comment()||e.literal()||e.variable()||e.url()||e.property()||e.call()||e.keyword()||e.javascript()},end:function(){return c.$char(";")||c.peek("}")},alpha:function(){var e;if(c.$re(/^opacity=/i))return(e=c.$re(/^\d+/))||(e=p(this.entities.variable,"Could not parse alpha")),m(")"),new o.Alpha(e)},element:function(){var e,t,i,n=c.i;if(t=this.combinator(),(e=c.$re(/^(?:\d+\.\d+|\d+)%/)||c.$re(/^(?:[.#]?|:*)(?:[\w-]|[^\x00-\x9f]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)||c.$char("*")||c.$char("&")||this.attribute()||c.$re(/^\([^&()@]+\)/)||c.$re(/^[\.#:](?=@)/)||this.entities.variableCurly())||(c.save(),c.$char("(")?(i=this.selector())&&c.$char(")")?(e=new o.Paren(i),c.forget()):c.restore("Missing closing ')'"):c.forget()),e)return new o.Element(t,e,n,l)},combinator:function(){var e=c.currentChar();if("/"===e){c.save();var t=c.$re(/^\/[a-z]+\//i);if(t)return c.forget(),new o.Combinator(t);c.restore()}if(">"===e||"+"===e||"~"===e||"|"===e||"^"===e){for(c.i++,"^"===e&&"^"===c.currentChar()&&(e="^^",c.i++);c.isWhitespace();)c.i++;return new o.Combinator(e)}return c.isWhitespace(-1)?new o.Combinator(" "):new o.Combinator(null)},lessSelector:function(){return this.selector(!0)},selector:function(e){for(var t,i,n,r,a,s,d,m=c.i;(e&&(i=this.extend())||e&&(s=c.$str("when"))||(r=this.element()))&&(s?d=p(this.conditions,"expected condition"):d?u("CSS guard can only be used at the end of selector"):i?a=a?a.concat(i):i:(a&&u("Extend can only be used at the end of selector"),n=c.currentChar(),t?t.push(r):t=[r],r=null),"{"!==n&&"}"!==n&&";"!==n&&","!==n&&")"!==n););if(t)return new o.Selector(t,a,d,m,l);a&&u("Extend must be used to extend a selector, it cannot be used on its own")},attribute:function(){if(c.$char("[")){var e,t,i,n=this.entities;return(e=n.variableCurly())||(e=p(/^(?:[_A-Za-z0-9-\*]*\|)?(?:[_A-Za-z0-9-]|\\.)+/)),(i=c.$re(/^[|~*$^]?=/))&&(t=n.quoted()||c.$re(/^[0-9]+%/)||c.$re(/^[\w-]+/)||n.variableCurly()),m("]"),new o.Attribute(e,i,t)}},block:function(){var e;if(c.$char("{")&&(e=this.primary())&&c.$char("}"))return e},blockRuleset:function(){var e=this.block();return e&&(e=new o.Ruleset(null,e)),e},detachedRuleset:function(){var e=this.blockRuleset();if(e)return new o.DetachedRuleset(e)},ruleset:function(){var e,i,n,r;for(c.save(),t.dumpLineNumbers&&(r=h(c.i));(i=this.lessSelector())&&(e?e.push(i):e=[i],c.commentStore.length=0,i.condition&&e.length>1&&u("Guards are only currently allowed on a single selector."),c.$char(","));)i.condition&&u("Guards are only currently allowed on a single selector."),c.commentStore.length=0;if(e&&(n=this.block())){c.forget();var a=new o.Ruleset(e,n,t.strictImports);return t.dumpLineNumbers&&(a.debugInfo=r),a}c.restore()},declaration:function(){var e,t,i,n,r,a=c.i,s=c.currentChar();if("."!==s&&"#"!==s&&"&"!==s&&":"!==s)if(c.save(),e=this.variable()||this.ruleProperty()){if((r="string"==typeof e)&&(t=this.detachedRuleset()),c.commentStore.length=0,!t){if(n=!r&&e.length>1&&e.pop().value,t=this.anonymousValue())return c.forget(),new o.Declaration(e,t,!1,n,a,l);t||(t=this.value()),i=this.important()}if(t&&this.end())return c.forget(),new o.Declaration(e,t,i,n,a,l);c.restore()}else c.restore()},anonymousValue:function(){var e=c.i,t=c.$re(/^([^@\$+\/'"*`(;{}-]*);/);if(t)return new o.Anonymous(t[1],e)},import:function(){var e,t,i=c.i,n=c.$re(/^@import?\s+/);if(n){var r=(n?this.importOptions():null)||{};if(e=this.entities.quoted()||this.entities.url())return t=this.mediaFeatures(),c.$char(";")||(c.i=i,u("missing semi-colon or unrecognised media features on import")),t=t&&new o.Value(t),new o.Import(e,t,r,i,l);c.i=i,u("malformed import statement")}},importOptions:function(){var e,t,i,n={};if(!c.$char("("))return null;do{if(e=this.importOption()){switch(i=!0,t=e){case"css":t="less",i=!1;break;case"once":t="multiple",i=!1}if(n[t]=i,!c.$char(","))break}}while(e);return m(")"),n},importOption:function(){var e=c.$re(/^(less|css|multiple|once|inline|reference|optional)/);if(e)return e[1]},mediaFeature:function(){var e,t,i=this.entities,n=[];c.save();do{(e=i.keyword()||i.variable())?n.push(e):c.$char("(")&&(t=this.property(),e=this.value(),c.$char(")")?t&&e?n.push(new o.Paren(new o.Declaration(t,e,null,null,c.i,l,!0))):e?n.push(new o.Paren(e)):u("badly formed media feature definition"):u("Missing closing ')'","Parse"))}while(e);if(c.forget(),n.length>0)return new o.Expression(n)},mediaFeatures:function(){var e,t=this.entities,i=[];do{if(e=this.mediaFeature()){if(i.push(e),!c.$char(","))break}else if((e=t.variable())&&(i.push(e),!c.$char(",")))break}while(e);return i.length>0?i:null},media:function(){var e,i,n,r,a=c.i;if(t.dumpLineNumbers&&(r=h(a)),c.save(),c.$str("@media"))return e=this.mediaFeatures(),(i=this.block())||u("media definitions require block statements after any features"),c.forget(),n=new o.Media(i,e,a,l),t.dumpLineNumbers&&(n.debugInfo=r),n;c.restore()},plugin:function(){var e,t,i,n=c.i;if(c.$re(/^@plugin?\s+/)){if(i=(t=this.pluginArgs())?{pluginArgs:t,isPlugin:!0}:{isPlugin:!0},e=this.entities.quoted()||this.entities.url())return c.$char(";")||(c.i=n,u("missing semi-colon on @plugin")),new o.Import(e,null,i,n,l);c.i=n,u("malformed @plugin statement")}},pluginArgs:function(){if(c.save(),!c.$char("("))return c.restore(),null;var e=c.$re(/^\s*([^\);]+)\)\s*/);return e[1]?(c.forget(),e[1].trim()):(c.restore(),null)},atrule:function(){var e,i,n,r,a,s,d,p=c.i,m=!0,f=!0;if("@"===c.currentChar()){if(i=this.import()||this.plugin()||this.media())return i;if(c.save(),e=c.$re(/^@[a-z-]+/)){switch(r=e,"-"==e.charAt(1)&&e.indexOf("-",2)>0&&(r="@"+e.slice(e.indexOf("-",2)+1)),r){case"@charset":a=!0,m=!1;break;case"@namespace":s=!0,m=!1;break;case"@keyframes":case"@counter-style":a=!0;break;case"@document":case"@supports":d=!0,f=!1;break;default:d=!0}if(c.commentStore.length=0,a?(i=this.entity())||u("expected "+e+" identifier"):s?(i=this.expression())||u("expected "+e+" expression"):d&&(i=(c.$re(/^[^{;]+/)||"").trim(),m="{"==c.currentChar(),i&&(i=new o.Anonymous(i))),m&&(n=this.blockRuleset()),n||!m&&i&&c.$char(";"))return c.forget(),new o.AtRule(e,i,n,p,l,t.dumpLineNumbers?h(p):null,f);c.restore("at-rule options not recognised")}}},value:function(){var e,t=[],i=c.i;do{if((e=this.expression())&&(t.push(e),!c.$char(",")))break}while(e);if(t.length>0)return new o.Value(t,i)},important:function(){if("!"===c.currentChar())return c.$re(/^! *important/)},sub:function(){var e,t;if(c.save(),c.$char("("))return(e=this.addition())&&c.$char(")")?(c.forget(),(t=new o.Expression([e])).parens=!0,t):void c.restore("Expected ')'");c.restore()},multiplication:function(){var e,t,i,n,r;if(e=this.operand()){for(r=c.isWhitespace(-1);!c.peek(/^\/[*\/]/);){if(c.save(),!(i=c.$char("/")||c.$char("*"))){c.forget();break}if(!(t=this.operand())){c.restore();break}c.forget(),e.parensInOp=!0,t.parensInOp=!0,n=new o.Operation(i,[n||e,t],r),r=c.isWhitespace(-1)}return n||e}},addition:function(){var e,t,i,n,r;if(e=this.multiplication()){for(r=c.isWhitespace(-1);(i=c.$re(/^[-+]\s+/)||!r&&(c.$char("+")||c.$char("-")))&&(t=this.multiplication());)e.parensInOp=!0,t.parensInOp=!0,n=new o.Operation(i,[n||e,t],r),r=c.isWhitespace(-1);return n||e}},conditions:function(){var e,t,i,n=c.i;if(e=this.condition()){for(;c.peek(/^,\s*(not\s*)?\(/)&&c.$char(",")&&(t=this.condition());)i=new o.Condition("or",i||e,t,n);return i||e}},condition:function(){var e,t,i;if(e=this.conditionAnd(this)){if(t=c.$str("or")){if(!(i=this.condition()))return;e=new o.Condition(t,e,i)}return e}},conditionAnd:function(){var e,t,i,n;if(e=(n=this).negatedCondition()||n.parenthesisCondition()){if(t=c.$str("and")){if(!(i=this.conditionAnd()))return;e=new o.Condition(t,e,i)}return e}},negatedCondition:function(){if(c.$str("not")){var e=this.parenthesisCondition();return e&&(e.negate=!e.negate),e}},parenthesisCondition:function(){var e;if(c.save(),c.$str("(")){if(e=function(e){var t;if(c.save(),t=e.condition()){if(c.$char(")"))return c.forget(),t;c.restore()}else c.restore()}(this))return c.forget(),e;if(e=this.atomicCondition()){if(c.$char(")"))return c.forget(),e;c.restore("expected ')' got '"+c.currentChar()+"'")}else c.restore()}else c.restore()},atomicCondition:function(){var e,t,i,n,r=this.entities,a=c.i;if(e=this.addition()||r.keyword()||r.quoted())return c.$char(">")?n=c.$char("=")?">=":">":c.$char("<")?n=c.$char("=")?"<=":"<":c.$char("=")&&(n=c.$char(">")?"=>":c.$char("<")?"=<":"="),n?(t=this.addition()||r.keyword()||r.quoted())?i=new o.Condition(n,e,t,a,!1):u("expected expression"):i=new o.Condition("=",e,new o.Keyword("true"),a,!1),i},operand:function(){var e,t=this.entities;c.peek(/^-[@\$\(]/)&&(e=c.$char("-"));var i=this.sub()||t.dimension()||t.color()||t.variable()||t.property()||t.call()||t.colorKeyword();return e&&(i.parensInOp=!0,i=new o.Negative(i)),i},expression:function(){var e,t,i=[],n=c.i;do{(e=this.comment())?i.push(e):(e=this.addition()||this.entity())&&(i.push(e),c.peek(/^\/[\/*]/)||(t=c.$char("/"))&&i.push(new o.Anonymous(t,n)))}while(e);if(i.length>0)return new o.Expression(i)},property:function(){var e=c.$re(/^(\*?-?[_a-zA-Z0-9-]+)\s*:/);if(e)return e[1]},ruleProperty:function(){var e,t,i=[],n=[];c.save();var r=c.$re(/^([_a-zA-Z0-9-]+)\s*:/);if(r)return i=[new o.Keyword(r[1])],c.forget(),i;function a(e){var t=c.i,o=c.$re(e);if(o)return n.push(t),i.push(o[1])}for(a(/^(\*?)/);a(/^((?:[\w-]+)|(?:[@\$]\{[\w-]+\}))/););if(i.length>1&&a(/^((?:\+_|\+)?)\s*:/)){for(c.forget(),""===i[0]&&(i.shift(),n.shift()),t=0;t<i.length;t++)e=i[t],i[t]="@"!==e.charAt(0)&&"$"!==e.charAt(0)?new o.Keyword(e):"@"===e.charAt(0)?new o.Variable("@"+e.slice(2,-1),n[t],l):new o.Property("$"+e.slice(2,-1),n[t],l);return i}c.restore()}}}};l.serializeVars=function(e){var t="";for(var i in e)if(Object.hasOwnProperty.call(e,i)){var n=e[i];t+=("@"===i[0]?"":"@")+i+": "+n+(";"===String(n).slice(-1)?"":";")}return t},t.exports=l},{"../less-error":34,"../tree":65,"../utils":87,"../visitors":91,"./parser-input":39}],41:[function(e,t,i){var n,o=function(e){this.less=e,this.visitors=[],this.preProcessors=[],this.postProcessors=[],this.installedPlugins=[],this.fileManagers=[],this.iterator=-1,this.pluginCache={},this.Loader=new e.PluginLoader(e)};function r(e,t,i){e["visit"+t]&&!e["visit"+i]&&(e["visit"+i]=e["visit"+t]),e["visit"+t+"Out"]&&!e["visit"+i+"Out"]&&(e["visit"+i+"Out"]=e["visit"+t+"Out"])}o.prototype.addPlugins=function(e){if(e)for(var t=0;t<e.length;t++)this.addPlugin(e[t])},o.prototype.addPlugin=function(e,t,i){this.installedPlugins.push(e),t&&(this.pluginCache[t]=e),e.install&&e.install(this.less,this,i||this.less.functions.functionRegistry)},o.prototype.get=function(e){return this.pluginCache[e]},Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.constructor?e.constructor.prototype:void 0}),o.prototype.addVisitor=function(e){var t;try{r(t=Object.getPrototypeOf(e),"Directive","AtRule"),r(t,"Rule","Declaration")}catch(e){}this.visitors.push(e)},o.prototype.addPreProcessor=function(e,t){var i;for(i=0;i<this.preProcessors.length&&!(this.preProcessors[i].priority>=t);i++);this.preProcessors.splice(i,0,{preProcessor:e,priority:t})},o.prototype.addPostProcessor=function(e,t){var i;for(i=0;i<this.postProcessors.length&&!(this.postProcessors[i].priority>=t);i++);this.postProcessors.splice(i,0,{postProcessor:e,priority:t})},o.prototype.addFileManager=function(e){this.fileManagers.push(e)},o.prototype.getPreProcessors=function(){for(var e=[],t=0;t<this.preProcessors.length;t++)e.push(this.preProcessors[t].preProcessor);return e},o.prototype.getPostProcessors=function(){for(var e=[],t=0;t<this.postProcessors.length;t++)e.push(this.postProcessors[t].postProcessor);return e},o.prototype.getVisitors=function(){return this.visitors},o.prototype.visitor=function(){var e=this;return{first:function(){return e.iterator=-1,e.visitors[e.iterator]},get:function(){return e.iterator+=1,e.visitors[e.iterator]}}},o.prototype.getFileManagers=function(){return this.fileManagers},t.exports=function(e,t){return!t&&n||(n=new o(e)),n}},{}],42:[function(e,t,i){var n;t.exports=function(t,i,o){var r=function(t,o,a){if("function"==typeof o&&(a=o,o={}),!a){n||(n="undefined"==typeof Promise?e("promise"):Promise);var s=this;return new n(function(e,i){r.call(s,t,o,function(t,n){t?i(t):e(n)})})}this.parse(t,o,function(e,t,n,o){if(e)return a(e);var r;try{r=new i(t,n).toCSS(o)}catch(e){return a(e)}a(null,r)})};return r}},{promise:void 0}],43:[function(e,t,i){t.exports=function(e,t){var i=function(e){this.options=e};return i.prototype.toCSS=function(t,i,n){var o=new e({contentsIgnoredCharsMap:n.contentsIgnoredChars,rootNode:t,contentsMap:n.contents,sourceMapFilename:this.options.sourceMapFilename,sourceMapURL:this.options.sourceMapURL,outputFilename:this.options.sourceMapOutputFilename,sourceMapBasepath:this.options.sourceMapBasepath,sourceMapRootpath:this.options.sourceMapRootpath,outputSourceFiles:this.options.outputSourceFiles,sourceMapGenerator:this.options.sourceMapGenerator,sourceMapFileInline:this.options.sourceMapFileInline}),r=o.toCSS(i);return this.sourceMap=o.sourceMap,this.sourceMapURL=o.sourceMapURL,this.options.sourceMapInputFilename&&(this.sourceMapInputFilename=o.normalizeFilename(this.options.sourceMapInputFilename)),r+this.getCSSAppendage()},i.prototype.getCSSAppendage=function(){var e=this.sourceMapURL;if(this.options.sourceMapFileInline){if(void 0===this.sourceMap)return"";e="data:application/json;base64,"+t.encodeBase64(this.sourceMap)}return e?"/*# sourceMappingURL="+e+" */":""},i.prototype.getExternalSourceMap=function(){return this.sourceMap},i.prototype.setExternalSourceMap=function(e){this.sourceMap=e},i.prototype.isInline=function(){return this.options.sourceMapFileInline},i.prototype.getSourceMapURL=function(){return this.sourceMapURL},i.prototype.getOutputFilename=function(){return this.options.sourceMapOutputFilename},i.prototype.getInputFilename=function(){return this.sourceMapInputFilename},i}},{}],44:[function(e,t,i){t.exports=function(e){var t=function(t){this._css=[],this._rootNode=t.rootNode,this._contentsMap=t.contentsMap,this._contentsIgnoredCharsMap=t.contentsIgnoredCharsMap,t.sourceMapFilename&&(this._sourceMapFilename=t.sourceMapFilename.replace(/\\/g,"/")),this._outputFilename=t.outputFilename,this.sourceMapURL=t.sourceMapURL,t.sourceMapBasepath&&(this._sourceMapBasepath=t.sourceMapBasepath.replace(/\\/g,"/")),t.sourceMapRootpath?(this._sourceMapRootpath=t.sourceMapRootpath.replace(/\\/g,"/"),"/"!==this._sourceMapRootpath.charAt(this._sourceMapRootpath.length-1)&&(this._sourceMapRootpath+="/")):this._sourceMapRootpath="",this._outputSourceFiles=t.outputSourceFiles,this._sourceMapGeneratorConstructor=e.getSourceMapGenerator(),this._lineNumber=0,this._column=0};return t.prototype.normalizeFilename=function(e){return e=e.replace(/\\/g,"/"),this._sourceMapBasepath&&0===e.indexOf(this._sourceMapBasepath)&&("\\"!==(e=e.substring(this._sourceMapBasepath.length)).charAt(0)&&"/"!==e.charAt(0)||(e=e.substring(1))),(this._sourceMapRootpath||"")+e},t.prototype.add=function(e,t,i,n){if(e){var o,r,a,s,l;if(t){var d=this._contentsMap[t.filename];this._contentsIgnoredCharsMap[t.filename]&&((i-=this._contentsIgnoredCharsMap[t.filename])<0&&(i=0),d=d.slice(this._contentsIgnoredCharsMap[t.filename])),s=(r=(d=d.substring(0,i)).split("\n"))[r.length-1]}if(a=(o=e.split("\n"))[o.length-1],t)if(n)for(l=0;l<o.length;l++)this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+l+1,column:0===l?this._column:0},original:{line:r.length+l,column:0===l?s.length:0},source:this.normalizeFilename(t.filename)});else this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+1,column:this._column},original:{line:r.length,column:s.length},source:this.normalizeFilename(t.filename)});1===o.length?this._column+=a.length:(this._lineNumber+=o.length-1,this._column=a.length),this._css.push(e)}},t.prototype.isEmpty=function(){return 0===this._css.length},t.prototype.toCSS=function(e){if(this._sourceMapGenerator=new this._sourceMapGeneratorConstructor({file:this._outputFilename,sourceRoot:null}),this._outputSourceFiles)for(var t in this._contentsMap)if(this._contentsMap.hasOwnProperty(t)){var i=this._contentsMap[t];this._contentsIgnoredCharsMap[t]&&(i=i.slice(this._contentsIgnoredCharsMap[t])),this._sourceMapGenerator.setSourceContent(this.normalizeFilename(t),i)}if(this._rootNode.genCSS(e,this),this._css.length>0){var n,o=JSON.stringify(this._sourceMapGenerator.toJSON());this.sourceMapURL?n=this.sourceMapURL:this._sourceMapFilename&&(n=this._sourceMapFilename),this.sourceMapURL=n,this.sourceMap=o}return this._css.join("")},t}},{}],45:[function(e,t,i){var n=e("./contexts"),o=e("./visitors"),r=e("./tree");t.exports=function(e,t){var i,a=(t=t||{}).variables,s=new n.Eval(t);"object"!=typeof a||Array.isArray(a)||(a=Object.keys(a).map(function(e){var t=a[e];return t instanceof r.Value||(t instanceof r.Expression||(t=new r.Expression([t])),t=new r.Value([t])),new r.Declaration("@"+e,t,!1,null,0)}),s.frames=[new r.Ruleset(null,a)]);var l,d,c=[new o.JoinSelectorVisitor,new o.MarkVisibleSelectorsVisitor(!0),new o.ExtendVisitor,new o.ToCSSVisitor({compress:Boolean(t.compress)})];if(t.pluginManager)for((d=t.pluginManager.visitor()).first();l=d.get();)l.isPreEvalVisitor&&l.run(e);i=e.eval(s);for(var u=0;u<c.length;u++)c[u].run(i);if(t.pluginManager)for(d.first();l=d.get();)l.isPreEvalVisitor||l.run(i);return i}},{"./contexts":12,"./tree":65,"./visitors":91}],46:[function(e,t,i){var n=e("./node"),o=function(e){this.value=e};(o.prototype=new n).type="Alpha",o.prototype.accept=function(e){this.value=e.visit(this.value)},o.prototype.eval=function(e){return this.value.eval?new o(this.value.eval(e)):this},o.prototype.genCSS=function(e,t){t.add("alpha(opacity="),this.value.genCSS?this.value.genCSS(e,t):t.add(this.value),t.add(")")},t.exports=o},{"./node":73}],47:[function(e,t,i){var n=e("./node"),o=function(e,t,i,n,o,r){this.value=e,this._index=t,this._fileInfo=i,this.mapLines=n,this.rulesetLike=void 0!==o&&o,this.allowRoot=!0,this.copyVisibilityInfo(r)};(o.prototype=new n).type="Anonymous",o.prototype.eval=function(){return new o(this.value,this._index,this._fileInfo,this.mapLines,this.rulesetLike,this.visibilityInfo())},o.prototype.compare=function(e){return e.toCSS&&this.toCSS()===e.toCSS()?0:void 0},o.prototype.isRulesetLike=function(){return this.rulesetLike},o.prototype.genCSS=function(e,t){this.nodeVisible=Boolean(this.value),this.nodeVisible&&t.add(this.value,this._fileInfo,this._index,this.mapLines)},t.exports=o},{"./node":73}],48:[function(e,t,i){var n=e("./node"),o=function(e,t){this.key=e,this.value=t};(o.prototype=new n).type="Assignment",o.prototype.accept=function(e){this.value=e.visit(this.value)},o.prototype.eval=function(e){return this.value.eval?new o(this.key,this.value.eval(e)):this},o.prototype.genCSS=function(e,t){t.add(this.key+"="),this.value.genCSS?this.value.genCSS(e,t):t.add(this.value)},t.exports=o},{"./node":73}],49:[function(e,t,i){var n=e("./node"),o=e("./selector"),r=e("./ruleset"),a=function(e,t,i,n,r,a,s,l){var d;if(this.name=e,this.value=t,i){for(Array.isArray(i)?this.rules=i:(this.rules=[i],this.rules[0].selectors=new o([],null,null,n,r).createEmptySelectors()),d=0;d<this.rules.length;d++)this.rules[d].allowImports=!0;this.setParent(this.rules,this)}this._index=n,this._fileInfo=r,this.debugInfo=a,this.isRooted=s||!1,this.copyVisibilityInfo(l),this.allowRoot=!0};(a.prototype=new n).type="AtRule",a.prototype.accept=function(e){var t=this.value,i=this.rules;i&&(this.rules=e.visitArray(i)),t&&(this.value=e.visit(t))},a.prototype.isRulesetLike=function(){return this.rules||!this.isCharset()},a.prototype.isCharset=function(){return"@charset"===this.name},a.prototype.genCSS=function(e,t){var i=this.value,n=this.rules;t.add(this.name,this.fileInfo(),this.getIndex()),i&&(t.add(" "),i.genCSS(e,t)),n?this.outputRuleset(e,t,n):t.add(";")},a.prototype.eval=function(e){var t,i,n=this.value,o=this.rules;return t=e.mediaPath,i=e.mediaBlocks,e.mediaPath=[],e.mediaBlocks=[],n&&(n=n.eval(e)),o&&((o=[o[0].eval(e)])[0].root=!0),e.mediaPath=t,e.mediaBlocks=i,new a(this.name,n,o,this.getIndex(),this.fileInfo(),this.debugInfo,this.isRooted,this.visibilityInfo())},a.prototype.variable=function(e){if(this.rules)return r.prototype.variable.call(this.rules[0],e)},a.prototype.find=function(){if(this.rules)return r.prototype.find.apply(this.rules[0],arguments)},a.prototype.rulesets=function(){if(this.rules)return r.prototype.rulesets.apply(this.rules[0])},a.prototype.outputRuleset=function(e,t,i){var n,o=i.length;if(e.tabLevel=1+(0|e.tabLevel),e.compress){for(t.add("{"),n=0;n<o;n++)i[n].genCSS(e,t);return t.add("}"),void e.tabLevel--}var r="\n"+Array(e.tabLevel).join("  "),a=r+"  ";if(o){for(t.add(" {"+a),i[0].genCSS(e,t),n=1;n<o;n++)t.add(a),i[n].genCSS(e,t);t.add(r+"}")}else t.add(" {"+r+"}");e.tabLevel--},t.exports=a},{"./node":73,"./ruleset":80,"./selector":81}],50:[function(e,t,i){var n=e("./node"),o=function(e,t,i){this.key=e,this.op=t,this.value=i};(o.prototype=new n).type="Attribute",o.prototype.eval=function(e){return new o(this.key.eval?this.key.eval(e):this.key,this.op,this.value&&this.value.eval?this.value.eval(e):this.value)},o.prototype.genCSS=function(e,t){t.add(this.toCSS(e))},o.prototype.toCSS=function(e){var t=this.key.toCSS?this.key.toCSS(e):this.key;return this.op&&(t+=this.op,t+=this.value.toCSS?this.value.toCSS(e):this.value),"["+t+"]"},t.exports=o},{"./node":73}],51:[function(e,t,i){var n=e("./node"),o=e("./anonymous"),r=e("../functions/function-caller"),a=function(e,t,i,n){this.name=e,this.args=t,this._index=i,this._fileInfo=n};(a.prototype=new n).type="Call",a.prototype.accept=function(e){this.args&&(this.args=e.visitArray(this.args))},a.prototype.eval=function(e){var t,i=this.args.map(function(t){return t.eval(e)}),s=new r(this.name,e,this.getIndex(),this.fileInfo());if(s.isValid()){try{t=s.call(i)}catch(e){throw{type:e.type||"Runtime",message:"error evaluating function `"+this.name+"`"+(e.message?": "+e.message:""),index:this.getIndex(),filename:this.fileInfo().filename,line:e.lineNumber,column:e.columnNumber}}if(null!=t)return t instanceof n||(t=new o(null)),t._index=this._index,t._fileInfo=this._fileInfo,t}return new a(this.name,i,this.getIndex(),this.fileInfo())},a.prototype.genCSS=function(e,t){t.add(this.name+"(",this.fileInfo(),this.getIndex());for(var i=0;i<this.args.length;i++)this.args[i].genCSS(e,t),i+1<this.args.length&&t.add(", ");t.add(")")},t.exports=a},{"../functions/function-caller":23,"./anonymous":47,"./node":73}],52:[function(e,t,i){var n=e("./node"),o=e("../data/colors"),r=function(e,t,i){Array.isArray(e)?this.rgb=e:6==e.length?this.rgb=e.match(/.{2}/g).map(function(e){return parseInt(e,16)}):this.rgb=e.split("").map(function(e){return parseInt(e+e,16)}),this.alpha="number"==typeof t?t:1,void 0!==i&&(this.value=i)};function a(e,t){return Math.min(Math.max(e,0),t)}function s(e){return"#"+e.map(function(e){return((e=a(Math.round(e),255))<16?"0":"")+e.toString(16)}).join("")}(r.prototype=new n).type="Color",r.prototype.luma=function(){var e=this.rgb[0]/255,t=this.rgb[1]/255,i=this.rgb[2]/255;return.2126*(e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(i=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))},r.prototype.genCSS=function(e,t){t.add(this.toCSS(e))},r.prototype.toCSS=function(e,t){var i,n,o=e&&e.compress&&!t;if(this.value)return this.value;if((n=this.fround(e,this.alpha))<1)return"rgba("+this.rgb.map(function(e){return a(Math.round(e),255)}).concat(a(n,1)).join(","+(o?"":" "))+")";if(i=this.toRGB(),o){var r=i.split("");r[1]===r[2]&&r[3]===r[4]&&r[5]===r[6]&&(i="#"+r[1]+r[3]+r[5])}return i},r.prototype.operate=function(e,t,i){for(var n=new Array(3),o=this.alpha*(1-i.alpha)+i.alpha,a=0;a<3;a++)n[a]=this._operate(e,t,this.rgb[a],i.rgb[a]);return new r(n,o)},r.prototype.toRGB=function(){return s(this.rgb)},r.prototype.toHSL=function(){var e,t,i=this.rgb[0]/255,n=this.rgb[1]/255,o=this.rgb[2]/255,r=this.alpha,a=Math.max(i,n,o),s=Math.min(i,n,o),l=(a+s)/2,d=a-s;if(a===s)e=t=0;else{switch(t=l>.5?d/(2-a-s):d/(a+s),a){case i:e=(n-o)/d+(n<o?6:0);break;case n:e=(o-i)/d+2;break;case o:e=(i-n)/d+4}e/=6}return{h:360*e,s:t,l:l,a:r}},r.prototype.toHSV=function(){var e,t,i=this.rgb[0]/255,n=this.rgb[1]/255,o=this.rgb[2]/255,r=this.alpha,a=Math.max(i,n,o),s=Math.min(i,n,o),l=a,d=a-s;if(t=0===a?0:d/a,a===s)e=0;else{switch(a){case i:e=(n-o)/d+(n<o?6:0);break;case n:e=(o-i)/d+2;break;case o:e=(i-n)/d+4}e/=6}return{h:360*e,s:t,v:l,a:r}},r.prototype.toARGB=function(){return s([255*this.alpha].concat(this.rgb))},r.prototype.compare=function(e){return e.rgb&&e.rgb[0]===this.rgb[0]&&e.rgb[1]===this.rgb[1]&&e.rgb[2]===this.rgb[2]&&e.alpha===this.alpha?0:void 0},r.fromKeyword=function(e){var t,i=e.toLowerCase();if(o.hasOwnProperty(i)?t=new r(o[i].slice(1)):"transparent"===i&&(t=new r([0,0,0],0)),t)return t.value=e,t},t.exports=r},{"../data/colors":13,"./node":73}],53:[function(e,t,i){var n=e("./node"),o=function(e){" "===e?(this.value=" ",this.emptyOrWhitespace=!0):(this.value=e?e.trim():"",this.emptyOrWhitespace=""===this.value)};(o.prototype=new n).type="Combinator";var r={"":!0," ":!0,"|":!0};o.prototype.genCSS=function(e,t){var i=e.compress||r[this.value]?"":" ";t.add(i+this.value+i)},t.exports=o},{"./node":73}],54:[function(e,t,i){var n=e("./node"),o=e("./debug-info"),r=function(e,t,i,n){this.value=e,this.isLineComment=t,this._index=i,this._fileInfo=n,this.allowRoot=!0};(r.prototype=new n).type="Comment",r.prototype.genCSS=function(e,t){this.debugInfo&&t.add(o(e,this),this.fileInfo(),this.getIndex()),t.add(this.value)},r.prototype.isSilent=function(e){var t=e.compress&&"!"!==this.value[2];return this.isLineComment||t},t.exports=r},{"./debug-info":56,"./node":73}],55:[function(e,t,i){var n=e("./node"),o=function(e,t,i,n,o){this.op=e.trim(),this.lvalue=t,this.rvalue=i,this._index=n,this.negate=o};(o.prototype=new n).type="Condition",o.prototype.accept=function(e){this.lvalue=e.visit(this.lvalue),this.rvalue=e.visit(this.rvalue)},o.prototype.eval=function(e){var t=function(e,t,i){switch(e){case"and":return t&&i;case"or":return t||i;default:switch(n.compare(t,i)){case-1:return"<"===e||"=<"===e||"<="===e;case 0:return"="===e||">="===e||"=<"===e||"<="===e;case 1:return">"===e||">="===e;default:return!1}}}(this.op,this.lvalue.eval(e),this.rvalue.eval(e));return this.negate?!t:t},t.exports=o},{"./node":73}],56:[function(e,t,i){var n=function(e,t,i){var o="";if(e.dumpLineNumbers&&!e.compress)switch(e.dumpLineNumbers){case"comments":o=n.asComment(t);break;case"mediaquery":o=n.asMediaQuery(t);break;case"all":o=n.asComment(t)+(i||"")+n.asMediaQuery(t)}return o};n.asComment=function(e){return"/* line "+e.debugInfo.lineNumber+", "+e.debugInfo.fileName+" */\n"},n.asMediaQuery=function(e){var t=e.debugInfo.fileName;return/^[a-z]+:\/\//i.test(t)||(t="file://"+t),"@media -sass-debug-info{filename{font-family:"+t.replace(/([.:\/\\])/g,function(e){return"\\"==e&&(e="/"),"\\"+e})+"}line{font-family:\\00003"+e.debugInfo.lineNumber+"}}\n"},t.exports=n},{}],57:[function(e,t,i){var n=e("./node"),o=e("./value"),r=e("./keyword"),a=function(e,t,i,r,a,s,l,d){this.name=e,this.value=t instanceof n?t:new o([t]),this.important=i?" "+i.trim():"",this.merge=r,this._index=a,this._fileInfo=s,this.inline=l||!1,this.variable=void 0!==d?d:e.charAt&&"@"===e.charAt(0),this.allowRoot=!0,this.setParent(this.value,this)};(a.prototype=new n).type="Declaration",a.prototype.genCSS=function(e,t){t.add(this.name+(e.compress?":":": "),this.fileInfo(),this.getIndex());try{this.value.genCSS(e,t)}catch(e){throw e.index=this._index,e.filename=this._fileInfo.filename,e}t.add(this.important+(this.inline||e.lastRule&&e.compress?"":";"),this._fileInfo,this._index)},a.prototype.eval=function(e){var t,i=!1,n=this.name,o=this.variable;"string"!=typeof n&&(n=1===n.length&&n[0]instanceof r?n[0].value:function(e,t){var i,n="",o=t.length,r={add:function(e){n+=e}};for(i=0;i<o;i++)t[i].eval(e).genCSS(e,r);return n}(e,n),o=!1),"font"!==n||e.strictMath||(i=!0,e.strictMath=!0);try{if(e.importantScope.push({}),t=this.value.eval(e),!this.variable&&"DetachedRuleset"===t.type)throw{message:"Rulesets cannot be evaluated on a property.",index:this.getIndex(),filename:this.fileInfo().filename};var s=this.important,l=e.importantScope.pop();return!s&&l.important&&(s=l.important),new a(n,t,s,this.merge,this.getIndex(),this.fileInfo(),this.inline,o)}catch(e){throw"number"!=typeof e.index&&(e.index=this.getIndex(),e.filename=this.fileInfo().filename),e}finally{i&&(e.strictMath=!1)}},a.prototype.makeImportant=function(){return new a(this.name,this.value,"!important",this.merge,this.getIndex(),this.fileInfo(),this.inline)},t.exports=a},{"./keyword":68,"./node":73,"./value":85}],58:[function(e,t,i){var n=e("./node"),o=e("../contexts"),r=e("../utils"),a=function(e,t){this.ruleset=e,this.frames=t,this.setParent(this.ruleset,this)};(a.prototype=new n).type="DetachedRuleset",a.prototype.evalFirst=!0,a.prototype.accept=function(e){this.ruleset=e.visit(this.ruleset)},a.prototype.eval=function(e){var t=this.frames||r.copyArray(e.frames);return new a(this.ruleset,t)},a.prototype.callEval=function(e){return this.ruleset.eval(this.frames?new o.Eval(e,this.frames.concat(e.frames)):e)},t.exports=a},{"../contexts":12,"../utils":87,"./node":73}],59:[function(e,t,i){var n=e("./node"),o=e("../data/unit-conversions"),r=e("./unit"),a=e("./color"),s=function(e,t){this.value=parseFloat(e),this.unit=t&&t instanceof r?t:new r(t?[t]:void 0),this.setParent(this.unit,this)};(s.prototype=new n).type="Dimension",s.prototype.accept=function(e){this.unit=e.visit(this.unit)},s.prototype.eval=function(e){return this},s.prototype.toColor=function(){return new a([this.value,this.value,this.value])},s.prototype.genCSS=function(e,t){if(e&&e.strictUnits&&!this.unit.isSingular())throw new Error("Multiple units in dimension. Correct the units or use the unit function. Bad unit: "+this.unit.toString());var i=this.fround(e,this.value),n=String(i);if(0!==i&&i<1e-6&&i>-1e-6&&(n=i.toFixed(20).replace(/0+$/,"")),e&&e.compress){if(0===i&&this.unit.isLength())return void t.add(n);i>0&&i<1&&(n=n.substr(1))}t.add(n),this.unit.genCSS(e,t)},s.prototype.operate=function(e,t,i){var n=this._operate(e,t,this.value,i.value),o=this.unit.clone();if("+"===t||"-"===t)if(0===o.numerator.length&&0===o.denominator.length)o=i.unit.clone(),this.unit.backupUnit&&(o.backupUnit=this.unit.backupUnit);else if(0===i.unit.numerator.length&&0===o.denominator.length);else{if(i=i.convertTo(this.unit.usedUnits()),e.strictUnits&&i.unit.toString()!==o.toString())throw new Error("Incompatible units. Change the units or use the unit function. Bad units: '"+o.toString()+"' and '"+i.unit.toString()+"'.");n=this._operate(e,t,this.value,i.value)}else"*"===t?(o.numerator=o.numerator.concat(i.unit.numerator).sort(),o.denominator=o.denominator.concat(i.unit.denominator).sort(),o.cancel()):"/"===t&&(o.numerator=o.numerator.concat(i.unit.denominator).sort(),o.denominator=o.denominator.concat(i.unit.numerator).sort(),o.cancel());return new s(n,o)},s.prototype.compare=function(e){var t,i;if(e instanceof s){if(this.unit.isEmpty()||e.unit.isEmpty())t=this,i=e;else if(t=this.unify(),i=e.unify(),0!==t.unit.compare(i.unit))return;return n.numericCompare(t.value,i.value)}},s.prototype.unify=function(){return this.convertTo({length:"px",duration:"s",angle:"rad"})},s.prototype.convertTo=function(e){var t,i,n,r,a,l=this.value,d=this.unit.clone(),c={};if("string"==typeof e){for(t in o)o[t].hasOwnProperty(e)&&((c={})[t]=e);e=c}for(i in a=function(e,t){return n.hasOwnProperty(e)?(t?l/=n[e]/n[r]:l*=n[e]/n[r],r):e},e)e.hasOwnProperty(i)&&(r=e[i],n=o[i],d.map(a));return d.cancel(),new s(l,d)},t.exports=s},{"../data/unit-conversions":15,"./color":52,"./node":73,"./unit":83}],60:[function(e,t,i){var n=e("./atrule"),o=function(){var e=Array.prototype.slice.call(arguments);n.apply(this,e)};(o.prototype=Object.create(n.prototype)).constructor=o,t.exports=o},{"./atrule":49}],61:[function(e,t,i){var n=e("./node"),o=e("./paren"),r=e("./combinator"),a=function(e,t,i,n,o){this.combinator=e instanceof r?e:new r(e),this.value="string"==typeof t?t.trim():t||"",this._index=i,this._fileInfo=n,this.copyVisibilityInfo(o),this.setParent(this.combinator,this)};(a.prototype=new n).type="Element",a.prototype.accept=function(e){var t=this.value;this.combinator=e.visit(this.combinator),"object"==typeof t&&(this.value=e.visit(t))},a.prototype.eval=function(e){return new a(this.combinator,this.value.eval?this.value.eval(e):this.value,this.getIndex(),this.fileInfo(),this.visibilityInfo())},a.prototype.clone=function(){return new a(this.combinator,this.value,this.getIndex(),this.fileInfo(),this.visibilityInfo())},a.prototype.genCSS=function(e,t){t.add(this.toCSS(e),this.fileInfo(),this.getIndex())},a.prototype.toCSS=function(e){e=e||{};var t=this.value,i=e.firstSelector;return t instanceof o&&(e.firstSelector=!0),t=t.toCSS?t.toCSS(e):t,e.firstSelector=i,""===t&&"&"===this.combinator.value.charAt(0)?"":this.combinator.toCSS(e)+t},t.exports=a},{"./combinator":53,"./node":73,"./paren":75}],62:[function(e,t,i){var n=e("./node"),o=e("./paren"),r=e("./comment"),a=function(e){if(this.value=e,!e)throw new Error("Expression requires an array parameter")};(a.prototype=new n).type="Expression",a.prototype.accept=function(e){this.value=e.visitArray(this.value)},a.prototype.eval=function(e){var t,i=this.parens&&!this.parensInOp,n=!1;return i&&e.inParenthesis(),this.value.length>1?t=new a(this.value.map(function(t){return t.eval(e)})):1===this.value.length?(this.value[0].parens&&!this.value[0].parensInOp&&(n=!0),t=this.value[0].eval(e)):t=this,i&&e.outOfParenthesis(),this.parens&&this.parensInOp&&!e.isMathOn()&&!n&&(t=new o(t)),t},a.prototype.genCSS=function(e,t){for(var i=0;i<this.value.length;i++)this.value[i].genCSS(e,t),i+1<this.value.length&&t.add(" ")},a.prototype.throwAwayComments=function(){this.value=this.value.filter(function(e){return!(e instanceof r)})},t.exports=a},{"./comment":54,"./node":73,"./paren":75}],63:[function(e,t,i){var n=e("./node"),o=e("./selector"),r=function e(t,i,n,o,r){switch(this.selector=t,this.option=i,this.object_id=e.next_id++,this.parent_ids=[this.object_id],this._index=n,this._fileInfo=o,this.copyVisibilityInfo(r),this.allowRoot=!0,i){case"all":this.allowBefore=!0,this.allowAfter=!0;break;default:this.allowBefore=!1,this.allowAfter=!1}this.setParent(this.selector,this)};r.next_id=0,(r.prototype=new n).type="Extend",r.prototype.accept=function(e){this.selector=e.visit(this.selector)},r.prototype.eval=function(e){return new r(this.selector.eval(e),this.option,this.getIndex(),this.fileInfo(),this.visibilityInfo())},r.prototype.clone=function(e){return new r(this.selector,this.option,this.getIndex(),this.fileInfo(),this.visibilityInfo())},r.prototype.findSelfSelectors=function(e){var t,i,n=[];for(t=0;t<e.length;t++)i=e[t].elements,t>0&&i.length&&""===i[0].combinator.value&&(i[0].combinator.value=" "),n=n.concat(e[t].elements);this.selfSelectors=[new o(n)],this.selfSelectors[0].copyVisibilityInfo(this.visibilityInfo())},t.exports=r},{"./node":73,"./selector":81}],64:[function(e,t,i){var n=e("./node"),o=e("./media"),r=e("./url"),a=e("./quoted"),s=e("./ruleset"),l=e("./anonymous"),d=e("../utils"),c=function(e,t,i,n,o,r){if(this.options=i,this._index=n,this._fileInfo=o,this.path=e,this.features=t,this.allowRoot=!0,void 0!==this.options.less||this.options.inline)this.css=!this.options.less||this.options.inline;else{var a=this.getPath();a&&/[#\.\&\?\/]css([\?;].*)?$/.test(a)&&(this.css=!0)}this.copyVisibilityInfo(r),this.setParent(this.features,this),this.setParent(this.path,this)};(c.prototype=new n).type="Import",c.prototype.accept=function(e){this.features&&(this.features=e.visit(this.features)),this.path=e.visit(this.path),this.options.isPlugin||this.options.inline||!this.root||(this.root=e.visit(this.root))},c.prototype.genCSS=function(e,t){this.css&&void 0===this.path._fileInfo.reference&&(t.add("@import ",this._fileInfo,this._index),this.path.genCSS(e,t),this.features&&(t.add(" "),this.features.genCSS(e,t)),t.add(";"))},c.prototype.getPath=function(){return this.path instanceof r?this.path.value.value:this.path.value},c.prototype.isVariableImport=function(){var e=this.path;return e instanceof r&&(e=e.value),!(e instanceof a)||e.containsVariables()},c.prototype.evalForImport=function(e){var t=this.path;return t instanceof r&&(t=t.value),new c(t.eval(e),this.features,this.options,this._index,this._fileInfo,this.visibilityInfo())},c.prototype.evalPath=function(e){var t=this.path.eval(e),i=this._fileInfo&&this._fileInfo.rootpath;if(!(t instanceof r)){if(i){var n=t.value;n&&e.isPathRelative(n)&&(t.value=i+n)}t.value=e.normalizePath(t.value)}return t},c.prototype.eval=function(e){var t=this.doEval(e);return(this.options.reference||this.blocksVisibility())&&(t.length||0===t.length?t.forEach(function(e){e.addVisibilityBlock()}):t.addVisibilityBlock()),t},c.prototype.doEval=function(e){var t,i,n=this.features&&this.features.eval(e);if(this.options.isPlugin)return this.root&&this.root.eval&&this.root.eval(e),(i=e.frames[0]&&e.frames[0].functionRegistry)&&this.root&&this.root.functions&&i.addMultiple(this.root.functions),[];if(this.skip&&("function"==typeof this.skip&&(this.skip=this.skip()),this.skip))return[];if(this.options.inline){var r=new l(this.root,0,{filename:this.importedFilename,reference:this.path._fileInfo&&this.path._fileInfo.reference},!0,!0);return this.features?new o([r],this.features.value):[r]}if(this.css){var a=new c(this.evalPath(e),n,this.options,this._index);if(!a.css&&this.error)throw this.error;return a}return(t=new s(null,d.copyArray(this.root.rules))).evalImports(e),this.features?new o(t.rules,this.features.value):t.rules},t.exports=c},{"../utils":87,"./anonymous":47,"./media":69,"./node":73,"./quoted":77,"./ruleset":80,"./url":84}],65:[function(e,t,i){var n={};n.Node=e("./node"),n.Alpha=e("./alpha"),n.Color=e("./color"),n.AtRule=e("./atrule"),n.Directive=e("./directive"),n.DetachedRuleset=e("./detached-ruleset"),n.Operation=e("./operation"),n.Dimension=e("./dimension"),n.Unit=e("./unit"),n.Keyword=e("./keyword"),n.Variable=e("./variable"),n.Property=e("./property"),n.Ruleset=e("./ruleset"),n.Element=e("./element"),n.Attribute=e("./attribute"),n.Combinator=e("./combinator"),n.Selector=e("./selector"),n.Quoted=e("./quoted"),n.Expression=e("./expression"),n.Declaration=e("./declaration"),n.Rule=e("./rule"),n.Call=e("./call"),n.URL=e("./url"),n.Import=e("./import"),n.mixin={Call:e("./mixin-call"),Definition:e("./mixin-definition")},n.Comment=e("./comment"),n.Anonymous=e("./anonymous"),n.Value=e("./value"),n.JavaScript=e("./javascript"),n.Assignment=e("./assignment"),n.Condition=e("./condition"),n.Paren=e("./paren"),n.Media=e("./media"),n.UnicodeDescriptor=e("./unicode-descriptor"),n.Negative=e("./negative"),n.Extend=e("./extend"),n.RulesetCall=e("./ruleset-call"),t.exports=n},{"./alpha":46,"./anonymous":47,"./assignment":48,"./atrule":49,"./attribute":50,"./call":51,"./color":52,"./combinator":53,"./comment":54,"./condition":55,"./declaration":57,"./detached-ruleset":58,"./dimension":59,"./directive":60,"./element":61,"./expression":62,"./extend":63,"./import":64,"./javascript":66,"./keyword":68,"./media":69,"./mixin-call":70,"./mixin-definition":71,"./negative":72,"./node":73,"./operation":74,"./paren":75,"./property":76,"./quoted":77,"./rule":78,"./ruleset":80,"./ruleset-call":79,"./selector":81,"./unicode-descriptor":82,"./unit":83,"./url":84,"./value":85,"./variable":86}],66:[function(e,t,i){var n=e("./js-eval-node"),o=e("./dimension"),r=e("./quoted"),a=e("./anonymous"),s=function(e,t,i,n){this.escaped=t,this.expression=e,this._index=i,this._fileInfo=n};(s.prototype=new n).type="JavaScript",s.prototype.eval=function(e){var t=this.evaluateJavaScript(this.expression,e);return"number"==typeof t?new o(t):"string"==typeof t?new r('"'+t+'"',t,this.escaped,this._index):Array.isArray(t)?new a(t.join(", ")):new a(t)},t.exports=s},{"./anonymous":47,"./dimension":59,"./js-eval-node":67,"./quoted":77}],67:[function(e,t,i){var n=e("./node"),o=e("./variable"),r=function(){};(r.prototype=new n).evaluateJavaScript=function(e,t){var i,n=this,r={};if(!t.javascriptEnabled)throw{message:"Inline JavaScript is not enabled. Is it set in your options?",filename:this.fileInfo().filename,index:this.getIndex()};e=e.replace(/@\{([\w-]+)\}/g,function(e,i){return n.jsify(new o("@"+i,n.getIndex(),n.fileInfo()).eval(t))});try{e=new Function("return ("+e+")")}catch(t){throw{message:"JavaScript evaluation error: "+t.message+" from `"+e+"`",filename:this.fileInfo().filename,index:this.getIndex()}}var a=t.frames[0].variables();for(var s in a)a.hasOwnProperty(s)&&(r[s.slice(1)]={value:a[s].value,toJS:function(){return this.value.eval(t).toCSS()}});try{i=e.call(r)}catch(e){throw{message:"JavaScript evaluation error: '"+e.name+": "+e.message.replace(/["]/g,"'")+"'",filename:this.fileInfo().filename,index:this.getIndex()}}return i},r.prototype.jsify=function(e){return Array.isArray(e.value)&&e.value.length>1?"["+e.value.map(function(e){return e.toCSS()}).join(", ")+"]":e.toCSS()},t.exports=r},{"./node":73,"./variable":86}],68:[function(e,t,i){var n=e("./node"),o=function(e){this.value=e};(o.prototype=new n).type="Keyword",o.prototype.genCSS=function(e,t){if("%"===this.value)throw{type:"Syntax",message:"Invalid % without number"};t.add(this.value)},o.True=new o("true"),o.False=new o("false"),t.exports=o},{"./node":73}],69:[function(e,t,i){var n=e("./ruleset"),o=e("./value"),r=e("./selector"),a=e("./anonymous"),s=e("./expression"),l=e("./atrule"),d=e("../utils"),c=function(e,t,i,a,s){this._index=i,this._fileInfo=a;var l=new r([],null,null,this._index,this._fileInfo).createEmptySelectors();this.features=new o(t),this.rules=[new n(l,e)],this.rules[0].allowImports=!0,this.copyVisibilityInfo(s),this.allowRoot=!0,this.setParent(l,this),this.setParent(this.features,this),this.setParent(this.rules,this)};(c.prototype=new l).type="Media",c.prototype.isRulesetLike=function(){return!0},c.prototype.accept=function(e){this.features&&(this.features=e.visit(this.features)),this.rules&&(this.rules=e.visitArray(this.rules))},c.prototype.genCSS=function(e,t){t.add("@media ",this._fileInfo,this._index),this.features.genCSS(e,t),this.outputRuleset(e,t,this.rules)},c.prototype.eval=function(e){e.mediaBlocks||(e.mediaBlocks=[],e.mediaPath=[]);var t=new c(null,[],this._index,this._fileInfo,this.visibilityInfo());this.debugInfo&&(this.rules[0].debugInfo=this.debugInfo,t.debugInfo=this.debugInfo);var i=!1;e.strictMath||(i=!0,e.strictMath=!0);try{t.features=this.features.eval(e)}finally{i&&(e.strictMath=!1)}return e.mediaPath.push(t),e.mediaBlocks.push(t),this.rules[0].functionRegistry=e.frames[0].functionRegistry.inherit(),e.frames.unshift(this.rules[0]),t.rules=[this.rules[0].eval(e)],e.frames.shift(),e.mediaPath.pop(),0===e.mediaPath.length?t.evalTop(e):t.evalNested(e)},c.prototype.evalTop=function(e){var t=this;if(e.mediaBlocks.length>1){var i=new r([],null,null,this.getIndex(),this.fileInfo()).createEmptySelectors();(t=new n(i,e.mediaBlocks)).multiMedia=!0,t.copyVisibilityInfo(this.visibilityInfo()),this.setParent(t,this)}return delete e.mediaBlocks,delete e.mediaPath,t},c.prototype.evalNested=function(e){var t,i,r=e.mediaPath.concat([this]);for(t=0;t<r.length;t++)i=r[t].features instanceof o?r[t].features.value:r[t].features,r[t]=Array.isArray(i)?i:[i];return this.features=new o(this.permute(r).map(function(e){for(e=e.map(function(e){return e.toCSS?e:new a(e)}),t=e.length-1;t>0;t--)e.splice(t,0,new a("and"));return new s(e)})),this.setParent(this.features,this),new n([],[])},c.prototype.permute=function(e){if(0===e.length)return[];if(1===e.length)return e[0];for(var t=[],i=this.permute(e.slice(1)),n=0;n<i.length;n++)for(var o=0;o<e[0].length;o++)t.push([e[0][o]].concat(i[n]));return t},c.prototype.bubbleSelectors=function(e){e&&(this.rules=[new n(d.copyArray(e),[this.rules[0]])],this.setParent(this.rules,this))},t.exports=c},{"../utils":87,"./anonymous":47,"./atrule":49,"./expression":62,"./ruleset":80,"./selector":81,"./value":85}],70:[function(e,t,i){var n=e("./node"),o=e("./selector"),r=e("./mixin-definition"),a=e("../functions/default"),s=function(e,t,i,n,r){this.selector=new o(e),this.arguments=t||[],this._index=i,this._fileInfo=n,this.important=r,this.allowRoot=!0,this.setParent(this.selector,this)};(s.prototype=new n).type="MixinCall",s.prototype.accept=function(e){this.selector&&(this.selector=e.visit(this.selector)),this.arguments.length&&(this.arguments=e.visitArray(this.arguments))},s.prototype.eval=function(e){var t,i,n,o,s,l,d,c,u,p,m,h,f,g,b,v=[],y=[],x=!1,z=[],C=[],w=-1,E=0,P=1,_=2;function T(t,i){var n,o,r;for(n=0;n<2;n++){for(C[n]=!0,a.value(n),o=0;o<i.length&&C[n];o++)(r=i[o]).matchCondition&&(C[n]=C[n]&&r.matchCondition(null,e));t.matchCondition&&(C[n]=C[n]&&t.matchCondition(v,e))}return C[0]||C[1]?C[0]!=C[1]?C[1]?P:_:E:w}for(l=0;l<this.arguments.length;l++)if(s=(o=this.arguments[l]).value.eval(e),o.expand&&Array.isArray(s.value))for(s=s.value,d=0;d<s.length;d++)v.push({value:s[d]});else v.push({name:o.name,value:s});for(b=function(t){return t.matchArgs(null,e)},l=0;l<e.frames.length;l++)if((t=e.frames[l].find(this.selector,null,b)).length>0){for(p=!0,d=0;d<t.length;d++){for(i=t[d].rule,n=t[d].path,u=!1,c=0;c<e.frames.length;c++)if(!(i instanceof r)&&i===(e.frames[c].originalRuleset||e.frames[c])){u=!0;break}u||i.matchArgs(v,e)&&((m={mixin:i,group:T(i,n)}).group!==w&&z.push(m),x=!0)}for(a.reset(),f=[0,0,0],d=0;d<z.length;d++)f[z[d].group]++;if(f[E]>0)h=_;else if(h=P,f[P]+f[_]>1)throw{type:"Runtime",message:"Ambiguous use of `default()` found when matching for `"+this.format(v)+"`",index:this.getIndex(),filename:this.fileInfo().filename};for(d=0;d<z.length;d++)if((m=z[d].group)===E||m===h)try{(i=z[d].mixin)instanceof r||(g=i.originalRuleset||i,(i=new r("",[],i.rules,null,!1,null,g.visibilityInfo())).originalRuleset=g);var S=i.evalCall(e,v,this.important).rules;this._setVisibilityToReplacement(S),Array.prototype.push.apply(y,S)}catch(e){throw{message:e.message,index:this.getIndex(),filename:this.fileInfo().filename,stack:e.stack}}if(x)return y}throw p?{type:"Runtime",message:"No matching definition was found for `"+this.format(v)+"`",index:this.getIndex(),filename:this.fileInfo().filename}:{type:"Name",message:this.selector.toCSS().trim()+" is undefined",index:this.getIndex(),filename:this.fileInfo().filename}},s.prototype._setVisibilityToReplacement=function(e){var t;if(this.blocksVisibility())for(t=0;t<e.length;t++)e[t].addVisibilityBlock()},s.prototype.format=function(e){return this.selector.toCSS().trim()+"("+(e?e.map(function(e){var t="";return e.name&&(t+=e.name+":"),e.value.toCSS?t+=e.value.toCSS():t+="???",t}).join(", "):"")+")"},t.exports=s},{"../functions/default":22,"./mixin-definition":71,"./node":73,"./selector":81}],71:[function(e,t,i){var n=e("./selector"),o=e("./element"),r=e("./ruleset"),a=e("./declaration"),s=e("./expression"),l=e("../contexts"),d=e("../utils"),c=function(e,t,i,r,a,s,l){this.name=e,this.selectors=[new n([new o(null,e,this._index,this._fileInfo)])],this.params=t,this.condition=r,this.variadic=a,this.arity=t.length,this.rules=i,this._lookups={};var d=[];this.required=t.reduce(function(e,t){return!t.name||t.name&&!t.value?e+1:(d.push(t.name),e)},0),this.optionalParameters=d,this.frames=s,this.copyVisibilityInfo(l),this.allowRoot=!0};(c.prototype=new r).type="MixinDefinition",c.prototype.evalFirst=!0,c.prototype.accept=function(e){this.params&&this.params.length&&(this.params=e.visitArray(this.params)),this.rules=e.visitArray(this.rules),this.condition&&(this.condition=e.visit(this.condition))},c.prototype.evalParams=function(e,t,i,n){var o,c,u,p,m,h,f,g,b=new r(null,null),v=d.copyArray(this.params),y=0;if(t.frames&&t.frames[0]&&t.frames[0].functionRegistry&&(b.functionRegistry=t.frames[0].functionRegistry.inherit()),t=new l.Eval(t,[b].concat(t.frames)),i)for(y=(i=d.copyArray(i)).length,u=0;u<y;u++)if(h=(c=i[u])&&c.name){for(f=!1,p=0;p<v.length;p++)if(!n[p]&&h===v[p].name){n[p]=c.value.eval(e),b.prependRule(new a(h,c.value.eval(e))),f=!0;break}if(f){i.splice(u,1),u--;continue}throw{type:"Runtime",message:"Named argument for "+this.name+" "+i[u].name+" not found"}}for(g=0,u=0;u<v.length;u++)if(!n[u]){if(c=i&&i[g],h=v[u].name)if(v[u].variadic){for(o=[],p=g;p<y;p++)o.push(i[p].value.eval(e));b.prependRule(new a(h,new s(o).eval(e)))}else{if(m=c&&c.value)m=m.eval(e);else{if(!v[u].value)throw{type:"Runtime",message:"wrong number of arguments for "+this.name+" ("+y+" for "+this.arity+")"};m=v[u].value.eval(t),b.resetCache()}b.prependRule(new a(h,m)),n[u]=m}if(v[u].variadic&&i)for(p=g;p<y;p++)n[p]=i[p].value.eval(e);g++}return b},c.prototype.makeImportant=function(){var e=this.rules?this.rules.map(function(e){return e.makeImportant?e.makeImportant(!0):e}):this.rules;return new c(this.name,this.params,e,this.condition,this.variadic,this.frames)},c.prototype.eval=function(e){return new c(this.name,this.params,this.rules,this.condition,this.variadic,this.frames||d.copyArray(e.frames))},c.prototype.evalCall=function(e,t,i){var n,o,c=[],u=this.frames?this.frames.concat(e.frames):e.frames,p=this.evalParams(e,new l.Eval(e,u),t,c);return p.prependRule(new a("@arguments",new s(c).eval(e))),n=d.copyArray(this.rules),(o=new r(null,n)).originalRuleset=this,o=o.eval(new l.Eval(e,[this,p].concat(u))),i&&(o=o.makeImportant()),o},c.prototype.matchCondition=function(e,t){return!(this.condition&&!this.condition.eval(new l.Eval(t,[this.evalParams(t,new l.Eval(t,this.frames?this.frames.concat(t.frames):t.frames),e,[])].concat(this.frames||[]).concat(t.frames))))},c.prototype.matchArgs=function(e,t){var i,n=e&&e.length||0,o=this.optionalParameters,r=e?e.reduce(function(e,t){return o.indexOf(t.name)<0?e+1:e},0):0;if(this.variadic){if(r<this.required-1)return!1}else{if(r<this.required)return!1;if(n>this.params.length)return!1}i=Math.min(r,this.arity);for(var a=0;a<i;a++)if(!this.params[a].name&&!this.params[a].variadic&&e[a].value.eval(t).toCSS()!=this.params[a].value.eval(t).toCSS())return!1;return!0},t.exports=c},{"../contexts":12,"../utils":87,"./declaration":57,"./element":61,"./expression":62,"./ruleset":80,"./selector":81}],72:[function(e,t,i){var n=e("./node"),o=e("./operation"),r=e("./dimension"),a=function(e){this.value=e};(a.prototype=new n).type="Negative",a.prototype.genCSS=function(e,t){t.add("-"),this.value.genCSS(e,t)},a.prototype.eval=function(e){return e.isMathOn()?new o("*",[new r(-1),this.value]).eval(e):new a(this.value.eval(e))},t.exports=a},{"./dimension":59,"./node":73,"./operation":74}],73:[function(e,t,i){var n=function(){this.parent=null,this.visibilityBlocks=void 0,this.nodeVisible=void 0,this.rootNode=null,this.parsed=null;var e=this;Object.defineProperty(this,"currentFileInfo",{get:function(){return e.fileInfo()}}),Object.defineProperty(this,"index",{get:function(){return e.getIndex()}})};n.prototype.setParent=function(e,t){function i(e){e&&e instanceof n&&(e.parent=t)}Array.isArray(e)?e.forEach(i):i(e)},n.prototype.getIndex=function(){return this._index||this.parent&&this.parent.getIndex()||0},n.prototype.fileInfo=function(){return this._fileInfo||this.parent&&this.parent.fileInfo()||{}},n.prototype.isRulesetLike=function(){return!1},n.prototype.toCSS=function(e){var t=[];return this.genCSS(e,{add:function(e,i,n){t.push(e)},isEmpty:function(){return 0===t.length}}),t.join("")},n.prototype.genCSS=function(e,t){t.add(this.value)},n.prototype.accept=function(e){this.value=e.visit(this.value)},n.prototype.eval=function(){return this},n.prototype._operate=function(e,t,i,n){switch(t){case"+":return i+n;case"-":return i-n;case"*":return i*n;case"/":return i/n}},n.prototype.fround=function(e,t){var i=e&&e.numPrecision;return null==i?t:Number((t+2e-16).toFixed(i))},n.compare=function(e,t){if(e.compare&&"Quoted"!==t.type&&"Anonymous"!==t.type)return e.compare(t);if(t.compare)return-t.compare(e);if(e.type===t.type){if(e=e.value,t=t.value,!Array.isArray(e))return e===t?0:void 0;if(e.length===t.length){for(var i=0;i<e.length;i++)if(0!==n.compare(e[i],t[i]))return;return 0}}},n.numericCompare=function(e,t){return e<t?-1:e===t?0:e>t?1:void 0},n.prototype.blocksVisibility=function(){return null==this.visibilityBlocks&&(this.visibilityBlocks=0),0!==this.visibilityBlocks},n.prototype.addVisibilityBlock=function(){null==this.visibilityBlocks&&(this.visibilityBlocks=0),this.visibilityBlocks=this.visibilityBlocks+1},n.prototype.removeVisibilityBlock=function(){null==this.visibilityBlocks&&(this.visibilityBlocks=0),this.visibilityBlocks=this.visibilityBlocks-1},n.prototype.ensureVisibility=function(){this.nodeVisible=!0},n.prototype.ensureInvisibility=function(){this.nodeVisible=!1},n.prototype.isVisible=function(){return this.nodeVisible},n.prototype.visibilityInfo=function(){return{visibilityBlocks:this.visibilityBlocks,nodeVisible:this.nodeVisible}},n.prototype.copyVisibilityInfo=function(e){e&&(this.visibilityBlocks=e.visibilityBlocks,this.nodeVisible=e.nodeVisible)},t.exports=n},{}],74:[function(e,t,i){var n=e("./node"),o=e("./color"),r=e("./dimension"),a=function(e,t,i){this.op=e.trim(),this.operands=t,this.isSpaced=i};(a.prototype=new n).type="Operation",a.prototype.accept=function(e){this.operands=e.visit(this.operands)},a.prototype.eval=function(e){var t=this.operands[0].eval(e),i=this.operands[1].eval(e);if(e.isMathOn()){if(t instanceof r&&i instanceof o&&(t=t.toColor()),i instanceof r&&t instanceof o&&(i=i.toColor()),!t.operate)throw{type:"Operation",message:"Operation on an invalid type"};return t.operate(e,this.op,i)}return new a(this.op,[t,i],this.isSpaced)},a.prototype.genCSS=function(e,t){this.operands[0].genCSS(e,t),this.isSpaced&&t.add(" "),t.add(this.op),this.isSpaced&&t.add(" "),this.operands[1].genCSS(e,t)},t.exports=a},{"./color":52,"./dimension":59,"./node":73}],75:[function(e,t,i){var n=e("./node"),o=function(e){this.value=e};(o.prototype=new n).type="Paren",o.prototype.genCSS=function(e,t){t.add("("),this.value.genCSS(e,t),t.add(")")},o.prototype.eval=function(e){return new o(this.value.eval(e))},t.exports=o},{"./node":73}],76:[function(e,t,i){var n=e("./node"),o=e("./declaration"),r=function(e,t,i){this.name=e,this._index=t,this._fileInfo=i};(r.prototype=new n).type="Property",r.prototype.eval=function(e){var t,i=this.name,n=e.pluginManager.less.visitors.ToCSSVisitor.prototype._mergeRules;if(this.evaluating)throw{type:"Name",message:"Recursive property reference for "+i,filename:this.fileInfo().filename,index:this.getIndex()};if(this.evaluating=!0,t=this.find(e.frames,function(t){var r,a=t.property(i);if(a){for(var s=0;s<a.length;s++)r=a[s],a[s]=new o(r.name,r.value,r.important,r.merge,r.index,r.currentFileInfo,r.inline,r.variable);if(n(a),(r=a[a.length-1]).important)e.importantScope[e.importantScope.length-1].important=r.important;return r=r.value.eval(e)}}))return this.evaluating=!1,t;throw{type:"Name",message:"Property '"+i+"' is undefined",filename:this.currentFileInfo.filename,index:this.index}},r.prototype.find=function(e,t){for(var i,n=0;n<e.length;n++)if(i=t.call(e,e[n]))return i;return null},t.exports=r},{"./declaration":57,"./node":73}],77:[function(e,t,i){var n=e("./node"),o=e("./js-eval-node"),r=e("./variable"),a=e("./property"),s=function(e,t,i,n,o){this.escaped=null==i||i,this.value=t||"",this.quote=e.charAt(0),this._index=n,this._fileInfo=o};(s.prototype=new o).type="Quoted",s.prototype.genCSS=function(e,t){this.escaped||t.add(this.quote,this.fileInfo(),this.getIndex()),t.add(this.value),this.escaped||t.add(this.quote)},s.prototype.containsVariables=function(){return this.value.match(/(`([^`]+)`)|@\{([\w-]+)\}/)},s.prototype.eval=function(e){var t=this,i=this.value;function n(e,t,i){var n=e;do{n=(e=n).replace(t,i)}while(e!==n);return n}return i=n(i=n(i=n(i,/`([^`]+)`/g,function(i,n){return String(t.evaluateJavaScript(n,e))}),/@\{([\w-]+)\}/g,function(i,n){var o=new r("@"+n,t.getIndex(),t.fileInfo()).eval(e,!0);return o instanceof s?o.value:o.toCSS()}),/\$\{([\w-]+)\}/g,function(i,n){var o=new a("$"+n,t.getIndex(),t.fileInfo()).eval(e,!0);return o instanceof s?o.value:o.toCSS()}),new s(this.quote+i+this.quote,i,this.escaped,this.getIndex(),this.fileInfo())},s.prototype.compare=function(e){return"Quoted"!==e.type||this.escaped||e.escaped?e.toCSS&&this.toCSS()===e.toCSS()?0:void 0:n.numericCompare(this.value,e.value)},t.exports=s},{"./js-eval-node":67,"./node":73,"./property":76,"./variable":86}],78:[function(e,t,i){var n=e("./declaration"),o=function(){var e=Array.prototype.slice.call(arguments);n.apply(this,e)};(o.prototype=Object.create(n.prototype)).constructor=o,t.exports=o},{"./declaration":57}],79:[function(e,t,i){var n=e("./node"),o=e("./variable"),r=function(e){this.variable=e,this.allowRoot=!0};(r.prototype=new n).type="RulesetCall",r.prototype.eval=function(e){return new o(this.variable).eval(e).callEval(e)},t.exports=r},{"./node":73,"./variable":86}],80:[function(e,t,i){var n=e("./node"),o=e("./declaration"),r=e("./keyword"),a=e("./comment"),s=e("./paren"),l=e("./selector"),d=e("./element"),c=e("./anonymous"),u=e("../contexts"),p=e("../functions/function-registry"),m=e("../functions/default"),h=e("./debug-info"),f=e("../less-error"),g=e("../utils"),b=function(e,t,i,n){this.selectors=e,this.rules=t,this._lookups={},this._variables=null,this._properties=null,this.strictImports=i,this.copyVisibilityInfo(n),this.allowRoot=!0,this.setParent(this.selectors,this),this.setParent(this.rules,this)};(b.prototype=new n).type="Ruleset",b.prototype.isRuleset=!0,b.prototype.isRulesetLike=function(){return!0},b.prototype.accept=function(e){this.paths?this.paths=e.visitArray(this.paths,!0):this.selectors&&(this.selectors=e.visitArray(this.selectors)),this.rules&&this.rules.length&&(this.rules=e.visitArray(this.rules))},b.prototype.eval=function(e){var t,i,r,a,s=this.selectors,l=!1;if(s&&(i=s.length)){for(t=new Array(i),m.error({type:"Syntax",message:"it is currently only allowed in parametric mixin guards,"}),a=0;a<i;a++)r=s[a].eval(e),t[a]=r,r.evaldCondition&&(l=!0);m.reset()}else l=!0;var d,c,u=this.rules?g.copyArray(this.rules):null,h=new b(t,u,this.strictImports,this.visibilityInfo());h.originalRuleset=this,h.root=this.root,h.firstRoot=this.firstRoot,h.allowImports=this.allowImports,this.debugInfo&&(h.debugInfo=this.debugInfo),l||(u.length=0),h.functionRegistry=function(e){for(var t,i=0,n=e.length;i!==n;++i)if(t=e[i].functionRegistry)return t;return p}(e.frames).inherit();var f=e.frames;f.unshift(h);var v=e.selectors;v||(e.selectors=v=[]),v.unshift(this.selectors),(h.root||h.allowImports||!h.strictImports)&&h.evalImports(e);var y=h.rules;for(a=0;d=y[a];a++)d.evalFirst&&(y[a]=d.eval(e));var x=e.mediaBlocks&&e.mediaBlocks.length||0;for(a=0;d=y[a];a++)"MixinCall"===d.type?(u=d.eval(e).filter(function(e){return!(e instanceof o&&e.variable)||!h.variable(e.name)}),y.splice.apply(y,[a,1].concat(u)),a+=u.length-1,h.resetCache()):"RulesetCall"===d.type&&(u=d.eval(e).rules.filter(function(e){return!(e instanceof o&&e.variable)}),y.splice.apply(y,[a,1].concat(u)),a+=u.length-1,h.resetCache());for(a=0;d=y[a];a++)d.evalFirst||(y[a]=d=d.eval?d.eval(e):d);for(a=0;d=y[a];a++)if(d instanceof b&&d.selectors&&1===d.selectors.length&&d.selectors[0].isJustParentSelector()){y.splice(a--,1);for(var z=0;c=d.rules[z];z++)c instanceof n&&(c.copyVisibilityInfo(d.visibilityInfo()),c instanceof o&&c.variable||y.splice(++a,0,c))}if(f.shift(),v.shift(),e.mediaBlocks)for(a=x;a<e.mediaBlocks.length;a++)e.mediaBlocks[a].bubbleSelectors(t);return h},b.prototype.evalImports=function(e){var t,i,n=this.rules;if(n)for(t=0;t<n.length;t++)"Import"===n[t].type&&((i=n[t].eval(e))&&(i.length||0===i.length)?(n.splice.apply(n,[t,1].concat(i)),t+=i.length-1):n.splice(t,1,i),this.resetCache())},b.prototype.makeImportant=function(){return new b(this.selectors,this.rules.map(function(e){return e.makeImportant?e.makeImportant():e}),this.strictImports,this.visibilityInfo())},b.prototype.matchArgs=function(e){return!e||0===e.length},b.prototype.matchCondition=function(e,t){var i=this.selectors[this.selectors.length-1];return!!i.evaldCondition&&!(i.condition&&!i.condition.eval(new u.Eval(t,t.frames)))},b.prototype.resetCache=function(){this._rulesets=null,this._variables=null,this._properties=null,this._lookups={}},b.prototype.variables=function(){return this._variables||(this._variables=this.rules?this.rules.reduce(function(e,t){if(t instanceof o&&!0===t.variable&&(e[t.name]=t),"Import"===t.type&&t.root&&t.root.variables){var i=t.root.variables();for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}return e},{}):{}),this._variables},b.prototype.properties=function(){return this._properties||(this._properties=this.rules?this.rules.reduce(function(e,t){if(t instanceof o&&!0!==t.variable){var i=1===t.name.length&&t.name[0]instanceof r?t.name[0].value:t.name;e["$"+i]?e["$"+i].push(t):e["$"+i]=[t]}return e},{}):{}),this._properties},b.prototype.variable=function(e){var t=this.variables()[e];if(t)return this.parseValue(t)},b.prototype.property=function(e){var t=this.properties()[e];if(t)return this.parseValue(t)},b.prototype.parseValue=function(e){var t=this;function i(e){if(e.value instanceof c&&!e.parsed){try{this.parse.parserInput.start(e.value.value,!1,function(t,i){return e.parsed=!0,e});var t=this.parse.parsers.value(),i=this.parse.parsers.important();this.parse.parserInput.end().isFinished&&(e.value=t,e.imporant=i,e.parsed=!0)}catch(t){throw new f({index:t.index+e.value.getIndex(),message:t.message},this.parse.imports,e.fileInfo().filename)}return e}return e}if(Array.isArray(e)){var n=[];return e.forEach(function(e){n.push(i.call(t,e))}),n}return i.call(t,e)},b.prototype.rulesets=function(){if(!this.rules)return[];var e,t,i=[],n=this.rules;for(e=0;t=n[e];e++)t.isRuleset&&i.push(t);return i},b.prototype.prependRule=function(e){var t=this.rules;t?t.unshift(e):this.rules=[e],this.setParent(e,this)},b.prototype.find=function(e,t,i){t=t||this;var n,o,r=[],a=e.toCSS();return a in this._lookups?this._lookups[a]:(this.rulesets().forEach(function(a){if(a!==t)for(var s=0;s<a.selectors.length;s++)if(n=e.match(a.selectors[s])){if(e.elements.length>n){if(!i||i(a)){o=a.find(new l(e.elements.slice(n)),t,i);for(var d=0;d<o.length;++d)o[d].path.push(a);Array.prototype.push.apply(r,o)}}else r.push({rule:a,path:[]});break}}),this._lookups[a]=r,r)},b.prototype.genCSS=function(e,t){var i,n,o,r,s,l=[];e.tabLevel=e.tabLevel||0,this.root||e.tabLevel++;var d,c=e.compress?"":Array(e.tabLevel+1).join("  "),u=e.compress?"":Array(e.tabLevel).join("  "),p=0,m=0;for(i=0;r=this.rules[i];i++)r instanceof a?(m===i&&m++,l.push(r)):r.isCharset&&r.isCharset()?(l.splice(p,0,r),p++,m++):"Import"===r.type?(l.splice(m,0,r),m++):l.push(r);if(l=[].concat(l),!this.root){(o=h(e,this,u))&&(t.add(o),t.add(u));var f,g=this.paths,b=g.length;for(d=e.compress?",":",\n"+u,i=0;i<b;i++)if(f=(s=g[i]).length)for(i>0&&t.add(d),e.firstSelector=!0,s[0].genCSS(e,t),e.firstSelector=!1,n=1;n<f;n++)s[n].genCSS(e,t);t.add((e.compress?"{":" {\n")+c)}for(i=0;r=l[i];i++){i+1===l.length&&(e.lastRule=!0);var v=e.lastRule;r.isRulesetLike(r)&&(e.lastRule=!1),r.genCSS?r.genCSS(e,t):r.value&&t.add(r.value.toString()),e.lastRule=v,!e.lastRule&&r.isVisible()?t.add(e.compress?"":"\n"+c):e.lastRule=!1}this.root||(t.add(e.compress?"}":"\n"+u+"}"),e.tabLevel--),t.isEmpty()||e.compress||!this.firstRoot||t.add("\n")},b.prototype.joinSelectors=function(e,t,i){for(var n=0;n<i.length;n++)this.joinSelector(e,t,i[n])},b.prototype.joinSelector=function(e,t,i){function n(e,t){var i,n;if(0===e.length)i=new s(e[0]);else{var o=new Array(e.length);for(n=0;n<e.length;n++)o[n]=new d(null,e[n],t._index,t._fileInfo);i=new s(new l(o))}return i}function o(e,t,i,n){var o,r,a;if(o=[],e.length>0?(r=(o=g.copyArray(e)).pop(),a=n.createDerived(g.copyArray(r.elements))):a=n.createDerived([]),t.length>0){var s=i.combinator,l=t[0].elements[0];s.emptyOrWhitespace&&!l.combinator.emptyOrWhitespace&&(s=l.combinator),a.elements.push(new d(s,l.value,i._index,i._fileInfo)),a.elements=a.elements.concat(t[0].elements.slice(1))}if(0!==a.elements.length&&o.push(a),t.length>1){var c=t.slice(1);c=c.map(function(e){return e.createDerived(e.elements,[])}),o=o.concat(c)}return o}function r(e,t,i,n,r){var a;for(a=0;a<e.length;a++){var s=o(e[a],t,i,n);r.push(s)}return r}function a(e,t){var i,n;if(0!==e.length)if(0!==t.length)for(i=0;n=t[i];i++)n.length>0?n[n.length-1]=n[n.length-1].createDerived(n[n.length-1].elements.concat(e)):n.push(new l(e));else t.push([new l(e)])}function c(e,t){var i=t.createDerived(t.elements,t.extendList,t.evaldCondition);return i.copyVisibilityInfo(e),i}var u,p;if(!function e(t,i,c){var u,p,m,h,f,g,b,v,y,x,z,C,w,E,P,_=!1;for(h=[],f=[[]],u=0;v=c.elements[u];u++)if("&"!==v.value){var T=(P=void 0,(E=v).value instanceof s&&(P=E.value.value)instanceof l?P:null);if(null!=T){a(h,f);var S,R=[],k=[];for(S=e(R,i,T),_=_||S,m=0;m<R.length;m++)r(f,[(z=n(R[m],v),w=void 0,w=new d(null,z,(C=v)._index,C._fileInfo),new l([w]))],v,c,k);f=k,h=[]}else h.push(v)}else{for(_=!0,g=[],a(h,f),p=0;p<f.length;p++)if(b=f[p],0===i.length)b.length>0&&b[0].elements.push(new d(v.combinator,"",v._index,v._fileInfo)),g.push(b);else for(m=0;m<i.length;m++){var $=o(b,i[m],v,c);g.push($)}f=g,h=[]}for(a(h,f),u=0;u<f.length;u++)(y=f[u].length)>0&&(t.push(f[u]),x=f[u][y-1],f[u][y-1]=x.createDerived(x.elements,c.extendList));return _}(p=[],t,i))if(t.length>0)for(p=[],u=0;u<t.length;u++){var m=t[u].map(c.bind(this,i.visibilityInfo()));m.push(i),p.push(m)}else p=[[i]];for(u=0;u<p.length;u++)e.push(p[u])},t.exports=b},{"../contexts":12,"../functions/default":22,"../functions/function-registry":24,"../less-error":34,"../utils":87,"./anonymous":47,"./comment":54,"./debug-info":56,"./declaration":57,"./element":61,"./keyword":68,"./node":73,"./paren":75,"./selector":81}],81:[function(e,t,i){var n=e("./node"),o=e("./element"),r=function(e,t,i,n,o,r){this.elements=e,this.extendList=t,this.condition=i,this._index=n,this._fileInfo=o,i||(this.evaldCondition=!0),this.copyVisibilityInfo(r),this.setParent(this.elements,this)};(r.prototype=new n).type="Selector",r.prototype.accept=function(e){this.elements&&(this.elements=e.visitArray(this.elements)),this.extendList&&(this.extendList=e.visitArray(this.extendList)),this.condition&&(this.condition=e.visit(this.condition))},r.prototype.createDerived=function(e,t,i){var n=this.visibilityInfo();i=null!=i?i:this.evaldCondition;var o=new r(e,t||this.extendList,null,this.getIndex(),this.fileInfo(),n);return o.evaldCondition=i,o.mediaEmpty=this.mediaEmpty,o},r.prototype.createEmptySelectors=function(){var e=new o("","&",this._index,this._fileInfo),t=[new r([e],null,null,this._index,this._fileInfo)];return t[0].mediaEmpty=!0,t},r.prototype.match=function(e){var t,i,n=this.elements,o=n.length;if(e.CacheElements(),0===(t=e._elements.length)||o<t)return 0;for(i=0;i<t;i++)if(n[i].value!==e._elements[i])return 0;return t},r.prototype.CacheElements=function(){if(!this._elements){var e=this.elements.map(function(e){return e.combinator.value+(e.value.value||e.value)}).join("").match(/[,&#\*\.\w-]([\w-]|(\\.))*/g);e?"&"===e[0]&&e.shift():e=[],this._elements=e}},r.prototype.isJustParentSelector=function(){return!this.mediaEmpty&&1===this.elements.length&&"&"===this.elements[0].value&&(" "===this.elements[0].combinator.value||""===this.elements[0].combinator.value)},r.prototype.eval=function(e){var t=this.condition&&this.condition.eval(e),i=this.elements,n=this.extendList;return i=i&&i.map(function(t){return t.eval(e)}),n=n&&n.map(function(t){return t.eval(e)}),this.createDerived(i,n,t)},r.prototype.genCSS=function(e,t){var i;if(e&&e.firstSelector||""!==this.elements[0].combinator.value||t.add(" ",this.fileInfo(),this.getIndex()),!this._css)for(i=0;i<this.elements.length;i++)this.elements[i].genCSS(e,t)},r.prototype.getIsOutput=function(){return this.evaldCondition},t.exports=r},{"./element":61,"./node":73}],82:[function(e,t,i){var n=e("./node"),o=function(e){this.value=e};(o.prototype=new n).type="UnicodeDescriptor",t.exports=o},{"./node":73}],83:[function(e,t,i){var n=e("./node"),o=e("../data/unit-conversions"),r=e("../utils"),a=function(e,t,i){this.numerator=e?r.copyArray(e).sort():[],this.denominator=t?r.copyArray(t).sort():[],i?this.backupUnit=i:e&&e.length&&(this.backupUnit=e[0])};(a.prototype=new n).type="Unit",a.prototype.clone=function(){return new a(r.copyArray(this.numerator),r.copyArray(this.denominator),this.backupUnit)},a.prototype.genCSS=function(e,t){var i=e&&e.strictUnits;1===this.numerator.length?t.add(this.numerator[0]):!i&&this.backupUnit?t.add(this.backupUnit):!i&&this.denominator.length&&t.add(this.denominator[0])},a.prototype.toString=function(){var e,t=this.numerator.join("*");for(e=0;e<this.denominator.length;e++)t+="/"+this.denominator[e];return t},a.prototype.compare=function(e){return this.is(e.toString())?0:void 0},a.prototype.is=function(e){return this.toString().toUpperCase()===e.toUpperCase()},a.prototype.isLength=function(){return Boolean(this.toCSS().match(/px|em|%|in|cm|mm|pc|pt|ex/))},a.prototype.isEmpty=function(){return 0===this.numerator.length&&0===this.denominator.length},a.prototype.isSingular=function(){return this.numerator.length<=1&&0===this.denominator.length},a.prototype.map=function(e){var t;for(t=0;t<this.numerator.length;t++)this.numerator[t]=e(this.numerator[t],!1);for(t=0;t<this.denominator.length;t++)this.denominator[t]=e(this.denominator[t],!0)},a.prototype.usedUnits=function(){var e,t,i,n={};for(i in t=function(t){return e.hasOwnProperty(t)&&!n[i]&&(n[i]=t),t},o)o.hasOwnProperty(i)&&(e=o[i],this.map(t));return n},a.prototype.cancel=function(){var e,t,i={};for(t=0;t<this.numerator.length;t++)i[e=this.numerator[t]]=(i[e]||0)+1;for(t=0;t<this.denominator.length;t++)i[e=this.denominator[t]]=(i[e]||0)-1;for(e in this.numerator=[],this.denominator=[],i)if(i.hasOwnProperty(e)){var n=i[e];if(n>0)for(t=0;t<n;t++)this.numerator.push(e);else if(n<0)for(t=0;t<-n;t++)this.denominator.push(e)}this.numerator.sort(),this.denominator.sort()},t.exports=a},{"../data/unit-conversions":15,"../utils":87,"./node":73}],84:[function(e,t,i){var n=e("./node"),o=function(e,t,i,n){this.value=e,this._index=t,this._fileInfo=i,this.isEvald=n};(o.prototype=new n).type="Url",o.prototype.accept=function(e){this.value=e.visit(this.value)},o.prototype.genCSS=function(e,t){t.add("url("),this.value.genCSS(e,t),t.add(")")},o.prototype.eval=function(e){var t,i=this.value.eval(e);if(!this.isEvald&&((t=this.fileInfo()&&this.fileInfo().rootpath)&&"string"==typeof i.value&&e.isPathRelative(i.value)&&(i.quote||(t=t.replace(/[\(\)'"\s]/g,function(e){return"\\"+e})),i.value=t+i.value),i.value=e.normalizePath(i.value),e.urlArgs&&!i.value.match(/^\s*data:/))){var n=(-1===i.value.indexOf("?")?"?":"&")+e.urlArgs;-1!==i.value.indexOf("#")?i.value=i.value.replace("#",n+"#"):i.value+=n}return new o(i,this.getIndex(),this.fileInfo(),!0)},t.exports=o},{"./node":73}],85:[function(e,t,i){var n=e("./node"),o=function(e){if(this.value=e,!e)throw new Error("Value requires an array argument")};(o.prototype=new n).type="Value",o.prototype.accept=function(e){this.value&&(this.value=e.visitArray(this.value))},o.prototype.eval=function(e){return 1===this.value.length?this.value[0].eval(e):new o(this.value.map(function(t){return t.eval(e)}))},o.prototype.genCSS=function(e,t){var i;for(i=0;i<this.value.length;i++)this.value[i].genCSS(e,t),i+1<this.value.length&&t.add(e&&e.compress?",":", ")},t.exports=o},{"./node":73}],86:[function(e,t,i){var n=e("./node"),o=function(e,t,i){this.name=e,this._index=t,this._fileInfo=i};(o.prototype=new n).type="Variable",o.prototype.eval=function(e){var t,i=this.name;if(0===i.indexOf("@@")&&(i="@"+new o(i.slice(1),this.getIndex(),this.fileInfo()).eval(e).value),this.evaluating)throw{type:"Name",message:"Recursive variable definition for "+i,filename:this.fileInfo().filename,index:this.getIndex()};if(this.evaluating=!0,t=this.find(e.frames,function(t){var n=t.variable(i);if(n){if(n.important)e.importantScope[e.importantScope.length-1].important=n.important;return n.value.eval(e)}}))return this.evaluating=!1,t;throw{type:"Name",message:"variable "+i+" is undefined",filename:this.fileInfo().filename,index:this.getIndex()}},o.prototype.find=function(e,t){for(var i,n=0;n<e.length;n++)if(i=t.call(e,e[n]))return i;return null},t.exports=o},{"./node":73}],87:[function(e,t,i){t.exports={getLocation:function(e,t){for(var i=e+1,n=null,o=-1;--i>=0&&"\n"!==t.charAt(i);)o++;return"number"==typeof e&&(n=(t.slice(0,e).match(/\n/g)||"").length),{line:n,column:o}},copyArray:function(e){var t,i=e.length,n=new Array(i);for(t=0;t<i;t++)n[t]=e[t];return n}}},{}],88:[function(e,t,i){var n=e("../tree"),o=e("./visitor"),r=e("../logger"),a=e("../utils"),s=function(){this._visitor=new o(this),this.contexts=[],this.allExtendsStack=[[]]};s.prototype={run:function(e){return(e=this._visitor.visit(e)).allExtends=this.allExtendsStack[0],e},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){if(!e.root){var i,o,r,s,l=[],d=e.rules,c=d?d.length:0;for(i=0;i<c;i++)e.rules[i]instanceof n.Extend&&(l.push(d[i]),e.extendOnEveryPath=!0);var u=e.paths;for(i=0;i<u.length;i++){var p=u[i],m=p[p.length-1].extendList;for((s=m?a.copyArray(m).concat(l):l)&&(s=s.map(function(e){return e.clone()})),o=0;o<s.length;o++)this.foundExtends=!0,(r=s[o]).findSelfSelectors(p),r.ruleset=e,0===o&&(r.firstExtendOnThisSelectorPath=!0),this.allExtendsStack[this.allExtendsStack.length-1].push(r)}this.contexts.push(e.selectors)}},visitRulesetOut:function(e){e.root||(this.contexts.length=this.contexts.length-1)},visitMedia:function(e,t){e.allExtends=[],this.allExtendsStack.push(e.allExtends)},visitMediaOut:function(e){this.allExtendsStack.length=this.allExtendsStack.length-1},visitAtRule:function(e,t){e.allExtends=[],this.allExtendsStack.push(e.allExtends)},visitAtRuleOut:function(e){this.allExtendsStack.length=this.allExtendsStack.length-1}};var l=function(){this._visitor=new o(this)};l.prototype={run:function(e){var t=new s;if(this.extendIndices={},t.run(e),!t.foundExtends)return e;e.allExtends=e.allExtends.concat(this.doExtendChaining(e.allExtends,e.allExtends)),this.allExtendsStack=[e.allExtends];var i=this._visitor.visit(e);return this.checkExtendsForNonMatched(e.allExtends),i},checkExtendsForNonMatched:function(e){var t=this.extendIndices;e.filter(function(e){return!e.hasFoundMatches&&1==e.parent_ids.length}).forEach(function(e){var i="_unknown_";try{i=e.selector.toCSS({})}catch(e){}t[e.index+" "+i]||(t[e.index+" "+i]=!0,r.warn("extend '"+i+"' has no matches"))})},doExtendChaining:function(e,t,i){var o,r,a,s,l,d,c,u,p=[],m=this;for(i=i||0,o=0;o<e.length;o++)for(r=0;r<t.length;r++)d=e[o],c=t[r],d.parent_ids.indexOf(c.object_id)>=0||(l=[c.selfSelectors[0]],(a=m.findMatch(d,l)).length&&(d.hasFoundMatches=!0,d.selfSelectors.forEach(function(e){var t=c.visibilityInfo();s=m.extendSelector(a,l,e,d.isVisible()),(u=new n.Extend(c.selector,c.option,0,c.fileInfo(),t)).selfSelectors=s,s[s.length-1].extendList=[u],p.push(u),u.ruleset=c.ruleset,u.parent_ids=u.parent_ids.concat(c.parent_ids,d.parent_ids),c.firstExtendOnThisSelectorPath&&(u.firstExtendOnThisSelectorPath=!0,c.ruleset.paths.push(s))})));if(p.length){if(this.extendChainCount++,i>100){var h="{unable to calculate}",f="{unable to calculate}";try{h=p[0].selfSelectors[0].toCSS(),f=p[0].selector.toCSS()}catch(e){}throw{message:"extend circular reference detected. One of the circular extends is currently:"+h+":extend("+f+")"}}return p.concat(m.doExtendChaining(p,t,i+1))}return p},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitSelector:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){if(!e.root){var i,n,o,r,a=this.allExtendsStack[this.allExtendsStack.length-1],s=[],l=this;for(o=0;o<a.length;o++)for(n=0;n<e.paths.length;n++)if(r=e.paths[n],!e.extendOnEveryPath){var d=r[r.length-1].extendList;d&&d.length||(i=this.findMatch(a[o],r)).length&&(a[o].hasFoundMatches=!0,a[o].selfSelectors.forEach(function(e){var t;t=l.extendSelector(i,r,e,a[o].isVisible()),s.push(t)}))}e.paths=e.paths.concat(s)}},findMatch:function(e,t){var i,n,o,r,a,s,l,d=e.selector.elements,c=[],u=[];for(i=0;i<t.length;i++)for(n=t[i],o=0;o<n.elements.length;o++)for(r=n.elements[o],(e.allowBefore||0===i&&0===o)&&c.push({pathIndex:i,index:o,matched:0,initialCombinator:r.combinator}),s=0;s<c.length;s++)l=c[s],""===(a=r.combinator.value)&&0===o&&(a=" "),!this.isElementValuesEqual(d[l.matched].value,r.value)||l.matched>0&&d[l.matched].combinator.value!==a?l=null:l.matched++,l&&(l.finished=l.matched===d.length,l.finished&&!e.allowAfter&&(o+1<n.elements.length||i+1<t.length)&&(l=null)),l?l.finished&&(l.length=d.length,l.endPathIndex=i,l.endPathElementIndex=o+1,c.length=0,u.push(l)):(c.splice(s,1),s--);return u},isElementValuesEqual:function(e,t){if("string"==typeof e||"string"==typeof t)return e===t;if(e instanceof n.Attribute)return e.op===t.op&&e.key===t.key&&(e.value&&t.value?(e=e.value.value||e.value)===(t=t.value.value||t.value):!e.value&&!t.value);if(e=e.value,t=t.value,e instanceof n.Selector){if(!(t instanceof n.Selector)||e.elements.length!==t.elements.length)return!1;for(var i=0;i<e.elements.length;i++){if(e.elements[i].combinator.value!==t.elements[i].combinator.value&&(0!==i||(e.elements[i].combinator.value||" ")!==(t.elements[i].combinator.value||" ")))return!1;if(!this.isElementValuesEqual(e.elements[i].value,t.elements[i].value))return!1}return!0}return!1},extendSelector:function(e,t,i,o){var r,a,s,l,d,c=0,u=0,p=[];for(r=0;r<e.length;r++)a=t[(l=e[r]).pathIndex],s=new n.Element(l.initialCombinator,i.elements[0].value,i.elements[0].getIndex(),i.elements[0].fileInfo()),l.pathIndex>c&&u>0&&(p[p.length-1].elements=p[p.length-1].elements.concat(t[c].elements.slice(u)),u=0,c++),d=a.elements.slice(u,l.index).concat([s]).concat(i.elements.slice(1)),c===l.pathIndex&&r>0?p[p.length-1].elements=p[p.length-1].elements.concat(d):(p=p.concat(t.slice(c,l.pathIndex))).push(new n.Selector(d)),c=l.endPathIndex,(u=l.endPathElementIndex)>=t[c].elements.length&&(u=0,c++);return c<t.length&&u>0&&(p[p.length-1].elements=p[p.length-1].elements.concat(t[c].elements.slice(u)),c++),p=(p=p.concat(t.slice(c,t.length))).map(function(e){var t=e.createDerived(e.elements);return o?t.ensureVisibility():t.ensureInvisibility(),t})},visitMedia:function(e,t){var i=e.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);i=i.concat(this.doExtendChaining(i,e.allExtends)),this.allExtendsStack.push(i)},visitMediaOut:function(e){var t=this.allExtendsStack.length-1;this.allExtendsStack.length=t},visitAtRule:function(e,t){var i=e.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);i=i.concat(this.doExtendChaining(i,e.allExtends)),this.allExtendsStack.push(i)},visitAtRuleOut:function(e){var t=this.allExtendsStack.length-1;this.allExtendsStack.length=t}},t.exports=l},{"../logger":35,"../tree":65,"../utils":87,"./visitor":95}],89:[function(e,t,i){function n(e){this.imports=[],this.variableImports=[],this._onSequencerEmpty=e,this._currentDepth=0}n.prototype.addImport=function(e){var t=this,i={callback:e,args:null,isReady:!1};return this.imports.push(i),function(){i.args=Array.prototype.slice.call(arguments,0),i.isReady=!0,t.tryRun()}},n.prototype.addVariableImport=function(e){this.variableImports.push(e)},n.prototype.tryRun=function(){this._currentDepth++;try{for(;;){for(;this.imports.length>0;){var e=this.imports[0];if(!e.isReady)return;this.imports=this.imports.slice(1),e.callback.apply(null,e.args)}if(0===this.variableImports.length)break;var t=this.variableImports[0];this.variableImports=this.variableImports.slice(1),t()}}finally{this._currentDepth--}0===this._currentDepth&&this._onSequencerEmpty&&this._onSequencerEmpty()},t.exports=n},{}],90:[function(e,t,i){var n=e("../contexts"),o=e("./visitor"),r=e("./import-sequencer"),a=e("../utils"),s=function(e,t){this._visitor=new o(this),this._importer=e,this._finish=t,this.context=new n.Eval,this.importCount=0,this.onceFileDetectionMap={},this.recursionDetector={},this._sequencer=new r(this._onSequencerEmpty.bind(this))};s.prototype={isReplacing:!1,run:function(e){try{this._visitor.visit(e)}catch(e){this.error=e}this.isFinished=!0,this._sequencer.tryRun()},_onSequencerEmpty:function(){this.isFinished&&this._finish(this.error)},visitImport:function(e,t){var i=e.options.inline;if(!e.css||i){var o=new n.Eval(this.context,a.copyArray(this.context.frames)),r=o.frames[0];this.importCount++,e.isVariableImport()?this._sequencer.addVariableImport(this.processImportNode.bind(this,e,o,r)):this.processImportNode(e,o,r)}t.visitDeeper=!1},processImportNode:function(e,t,i){var n,o=e.options.inline;try{n=e.evalForImport(t)}catch(t){t.filename||(t.index=e.getIndex(),t.filename=e.fileInfo().filename),e.css=!0,e.error=t}if(!n||n.css&&!o)this.importCount--,this.isFinished&&this._sequencer.tryRun();else{n.options.multiple&&(t.importMultiple=!0);for(var r=void 0===n.css,a=0;a<i.rules.length;a++)if(i.rules[a]===e){i.rules[a]=n;break}var s=this.onImported.bind(this,n,t),l=this._sequencer.addImport(s);this._importer.push(n.getPath(),r,n.fileInfo(),n.options,l)}},onImported:function(e,t,i,n,o,r){i&&(i.filename||(i.index=e.getIndex(),i.filename=e.fileInfo().filename),this.error=i);var a=this,s=e.options.inline,l=e.options.isPlugin,d=e.options.optional,c=o||r in a.recursionDetector;if(t.importMultiple||(e.skip=!!c||function(){return r in a.onceFileDetectionMap||(a.onceFileDetectionMap[r]=!0,!1)}),!r&&d&&(e.skip=!0),n&&(e.root=n,e.importedFilename=r,!s&&!l&&(t.importMultiple||!c))){a.recursionDetector[r]=!0;var u=this.context;this.context=t;try{this._visitor.visit(n)}catch(i){this.error=i}this.context=u}a.importCount--,a.isFinished&&a._sequencer.tryRun()},visitDeclaration:function(e,t){"DetachedRuleset"===e.value.type?this.context.frames.unshift(e):t.visitDeeper=!1},visitDeclarationOut:function(e){"DetachedRuleset"===e.value.type&&this.context.frames.shift()},visitAtRule:function(e,t){this.context.frames.unshift(e)},visitAtRuleOut:function(e){this.context.frames.shift()},visitMixinDefinition:function(e,t){this.context.frames.unshift(e)},visitMixinDefinitionOut:function(e){this.context.frames.shift()},visitRuleset:function(e,t){this.context.frames.unshift(e)},visitRulesetOut:function(e){this.context.frames.shift()},visitMedia:function(e,t){this.context.frames.unshift(e.rules[0])},visitMediaOut:function(e){this.context.frames.shift()}},t.exports=s},{"../contexts":12,"../utils":87,"./import-sequencer":89,"./visitor":95}],91:[function(e,t,i){var n={Visitor:e("./visitor"),ImportVisitor:e("./import-visitor"),MarkVisibleSelectorsVisitor:e("./set-tree-visibility-visitor"),ExtendVisitor:e("./extend-visitor"),JoinSelectorVisitor:e("./join-selector-visitor"),ToCSSVisitor:e("./to-css-visitor")};t.exports=n},{"./extend-visitor":88,"./import-visitor":90,"./join-selector-visitor":92,"./set-tree-visibility-visitor":93,"./to-css-visitor":94,"./visitor":95}],92:[function(e,t,i){var n=e("./visitor"),o=function(){this.contexts=[[]],this._visitor=new n(this)};o.prototype={run:function(e){return this._visitor.visit(e)},visitDeclaration:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitRuleset:function(e,t){var i,n=this.contexts[this.contexts.length-1],o=[];this.contexts.push(o),e.root||((i=e.selectors)&&(i=i.filter(function(e){return e.getIsOutput()}),e.selectors=i.length?i:i=null,i&&e.joinSelectors(o,n,i)),i||(e.rules=null),e.paths=o)},visitRulesetOut:function(e){this.contexts.length=this.contexts.length-1},visitMedia:function(e,t){var i=this.contexts[this.contexts.length-1];e.rules[0].root=0===i.length||i[0].multiMedia},visitAtRule:function(e,t){var i=this.contexts[this.contexts.length-1];e.rules&&e.rules.length&&(e.rules[0].root=e.isRooted||0===i.length||null)}},t.exports=o},{"./visitor":95}],93:[function(e,t,i){var n=function(e){this.visible=e};n.prototype.run=function(e){this.visit(e)},n.prototype.visitArray=function(e){if(!e)return e;var t,i=e.length;for(t=0;t<i;t++)this.visit(e[t]);return e},n.prototype.visit=function(e){return e?e.constructor===Array?this.visitArray(e):!e.blocksVisibility||e.blocksVisibility()?e:(this.visible?e.ensureVisibility():e.ensureInvisibility(),e.accept(this),e):e},t.exports=n},{}],94:[function(e,t,i){var n=e("../tree"),o=e("./visitor"),r=function(e){this._visitor=new o(this),this._context=e};r.prototype={containsSilentNonBlockedChild:function(e){var t;if(null==e)return!1;for(var i=0;i<e.length;i++)if((t=e[i]).isSilent&&t.isSilent(this._context)&&!t.blocksVisibility())return!0;return!1},keepOnlyVisibleChilds:function(e){null!=e&&null!=e.rules&&(e.rules=e.rules.filter(function(e){return e.isVisible()}))},isEmpty:function(e){return null==e||null==e.rules||0===e.rules.length},hasVisibleSelector:function(e){return null!=e&&null!=e.paths&&e.paths.length>0},resolveVisibility:function(e,t){if(!e.blocksVisibility()){if(this.isEmpty(e)&&!this.containsSilentNonBlockedChild(t))return;return e}var i=e.rules[0];if(this.keepOnlyVisibleChilds(i),!this.isEmpty(i))return e.ensureVisibility(),e.removeVisibilityBlock(),e},isVisibleRuleset:function(e){return!!e.firstRoot||!this.isEmpty(e)&&!(!e.root&&!this.hasVisibleSelector(e))}};var a=function(e){this._visitor=new o(this),this._context=e,this.utils=new r(e)};a.prototype={isReplacing:!0,run:function(e){return this._visitor.visit(e)},visitDeclaration:function(e,t){if(!e.blocksVisibility()&&!e.variable)return e},visitMixinDefinition:function(e,t){e.frames=[]},visitExtend:function(e,t){},visitComment:function(e,t){if(!e.blocksVisibility()&&!e.isSilent(this._context))return e},visitMedia:function(e,t){var i=e.rules[0].rules;return e.accept(this._visitor),t.visitDeeper=!1,this.utils.resolveVisibility(e,i)},visitImport:function(e,t){if(!e.blocksVisibility())return e},visitAtRule:function(e,t){return e.rules&&e.rules.length?this.visitAtRuleWithBody(e,t):this.visitAtRuleWithoutBody(e,t)},visitAtRuleWithBody:function(e,t){var i,n,o,r=(o=(i=e).rules,1!==(n=i.rules).length||n[0].paths&&0!==n[0].paths.length?o:o[0].rules);return e.accept(this._visitor),t.visitDeeper=!1,this.utils.isEmpty(e)||this._mergeRules(e.rules[0].rules),this.utils.resolveVisibility(e,r)},visitAtRuleWithoutBody:function(e,t){if(!e.blocksVisibility()){if("@charset"===e.name){if(this.charset){if(e.debugInfo){var i=new n.Comment("/* "+e.toCSS(this._context).replace(/\n/g,"")+" */\n");return i.debugInfo=e.debugInfo,this._visitor.visit(i)}return}this.charset=!0}return e}},checkValidNodes:function(e,t){if(e)for(var i=0;i<e.length;i++){var o=e[i];if(t&&o instanceof n.Declaration&&!o.variable)throw{message:"Properties must be inside selector blocks. They cannot be in the root",index:o.getIndex(),filename:o.fileInfo()&&o.fileInfo().filename};if(o instanceof n.Call)throw{message:"Function '"+o.name+"' is undefined",index:o.getIndex(),filename:o.fileInfo()&&o.fileInfo().filename};if(o.type&&!o.allowRoot)throw{message:o.type+" node returned by a function is not valid here",index:o.getIndex(),filename:o.fileInfo()&&o.fileInfo().filename}}},visitRuleset:function(e,t){var i,n=[];if(this.checkValidNodes(e.rules,e.firstRoot),e.root)e.accept(this._visitor),t.visitDeeper=!1;else{this._compileRulesetPaths(e);for(var o=e.rules,r=o?o.length:0,a=0;a<r;)(i=o[a])&&i.rules?(n.push(this._visitor.visit(i)),o.splice(a,1),r--):a++;r>0?e.accept(this._visitor):e.rules=null,t.visitDeeper=!1}return e.rules&&(this._mergeRules(e.rules),this._removeDuplicateRules(e.rules)),this.utils.isVisibleRuleset(e)&&(e.ensureVisibility(),n.splice(0,0,e)),1===n.length?n[0]:n},_compileRulesetPaths:function(e){e.paths&&(e.paths=e.paths.filter(function(e){var t;for(" "===e[0].elements[0].combinator.value&&(e[0].elements[0].combinator=new n.Combinator("")),t=0;t<e.length;t++)if(e[t].isVisible()&&e[t].getIsOutput())return!0;return!1}))},_removeDuplicateRules:function(e){if(e){var t,i,o,r={};for(o=e.length-1;o>=0;o--)if((i=e[o])instanceof n.Declaration)if(r[i.name]){(t=r[i.name])instanceof n.Declaration&&(t=r[i.name]=[r[i.name].toCSS(this._context)]);var a=i.toCSS(this._context);-1!==t.indexOf(a)?e.splice(o,1):t.push(a)}else r[i.name]=i}},_mergeRules:function(e){if(e){for(var t,i,o,r={},a=0;a<e.length;a++)(i=e[a])instanceof n.Declaration&&i.merge&&(o=[i.name,i.important?"!":""].join(","),r[o]?e.splice(a--,1):r[o]=[],r[o].push(i));Object.keys(r).map(function(e){function o(e){return new n.Expression(e.map(function(e){return e.value}))}if((t=r[e]).length>1){i=t[0];var a=[],s=[];t.map(function(e){"+"===e.merge&&(s.length>0&&a.push(o(s)),s=[]),s.push(e)}),a.push(o(s)),i.value=(l=a,new n.Value(l.map(function(e){return e})))}var l})}},visitAnonymous:function(e,t){if(!e.blocksVisibility())return e.accept(this._visitor),e}},t.exports=a},{"../tree":65,"./visitor":95}],95:[function(e,t,i){var n=e("../tree"),o={visitDeeper:!0},r=!1;function a(e){return e}var s=function(e){this._implementation=e,this._visitFnCache=[],r||(!function e(t,i){var n,o;for(n in t)if(t.hasOwnProperty(n))switch(typeof(o=t[n])){case"function":o.prototype&&o.prototype.type&&(o.prototype.typeIndex=i++);break;case"object":i=e(o,i)}return i}(n,1),r=!0)};s.prototype={visit:function(e){if(!e)return e;var t=e.typeIndex;if(!t)return e;var i,n=this._visitFnCache,r=this._implementation,s=t<<1,l=1|s,d=n[s],c=n[l],u=o;if(u.visitDeeper=!0,d||(d=r[i="visit"+e.type]||a,c=r[i+"Out"]||a,n[s]=d,n[l]=c),d!==a){var p=d.call(r,e,u);r.isReplacing&&(e=p)}return u.visitDeeper&&e&&e.accept&&e.accept(this),c!=a&&c.call(r,e),e},visitArray:function(e,t){if(!e)return e;var i,n=e.length;if(t||!this._implementation.isReplacing){for(i=0;i<n;i++)this.visit(e[i]);return e}var o=[];for(i=0;i<n;i++){var r=this.visit(e[i]);void 0!==r&&(r.splice?r.length&&this.flatten(r,o):o.push(r))}return o},flatten:function(e,t){var i,n,o,r,a,s;for(t||(t=[]),n=0,i=e.length;n<i;n++)if(void 0!==(o=e[n]))if(o.splice)for(a=0,r=o.length;a<r;a++)void 0!==(s=o[a])&&(s.splice?s.length&&this.flatten(s,t):t.push(s));else t.push(o);return t}},t.exports=s},{"../tree":65}],96:[function(e,t,i){"use strict";var n=e("./raw"),o=[],r=[],a=n.makeRequestCallFromTimer(function(){if(r.length)throw r.shift()});function s(e){var t;(t=o.length?o.pop():new l).task=e,n(t)}function l(){this.task=null}t.exports=s,l.prototype.call=function(){try{this.task.call()}catch(e){s.onerror?s.onerror(e):(r.push(e),a())}finally{this.task=null,o[o.length]=this}}},{"./raw":97}],97:[function(e,t,i){(function(e){"use strict";function i(e){o.length||(n(),!0),o[o.length]=e}t.exports=i;var n,o=[],r=0,a=1024;function s(){for(;r<o.length;){var e=r;if(r+=1,o[e].call(),r>a){for(var t=0,i=o.length-r;t<i;t++)o[t]=o[t+r];o.length-=r,r=0}}o.length=0,r=0,!1}var l,d,c,u=e.MutationObserver||e.WebKitMutationObserver;function p(e){return function(){var t=setTimeout(n,0),i=setInterval(n,50);function n(){clearTimeout(t),clearInterval(i),e()}}}"function"==typeof u?(l=1,d=new u(s),c=document.createTextNode(""),d.observe(c,{characterData:!0}),n=function(){l=-l,c.data=l}):n=p(s),i.requestFlush=n,i.makeRequestCallFromTimer=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],98:[function(e,t,i){"use strict";var n=e("asap/raw");function o(){}var r=null,a={};function s(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._45=0,this._81=0,this._65=null,this._54=null,e!==o&&m(e,this)}function l(e,t){for(;3===e._81;)e=e._65;if(s._10&&s._10(e),0===e._81)return 0===e._45?(e._45=1,void(e._54=t)):1===e._45?(e._45=2,void(e._54=[e._54,t])):void e._54.push(t);var i,o;i=e,o=t,n(function(){var e=1===i._81?o.onFulfilled:o.onRejected;if(null!==e){var t=function(e,t){try{return e(t)}catch(e){return r=e,a}}(e,i._65);t===a?c(o.promise,r):d(o.promise,t)}else 1===i._81?d(o.promise,i._65):c(o.promise,i._65)})}function d(e,t){if(t===e)return c(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var i=function(e){try{return e.then}catch(e){return r=e,a}}(t);if(i===a)return c(e,r);if(i===e.then&&t instanceof s)return e._81=3,e._65=t,void u(e);if("function"==typeof i)return void m(i.bind(t),e)}e._81=1,e._65=t,u(e)}function c(e,t){e._81=2,e._65=t,s._97&&s._97(e,t),u(e)}function u(e){if(1===e._45&&(l(e,e._54),e._54=null),2===e._45){for(var t=0;t<e._54.length;t++)l(e,e._54[t]);e._54=null}}function p(e,t,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=i}function m(e,t){var i=!1,n=function(e,t,i){try{e(t,i)}catch(e){return r=e,a}}(e,function(e){i||(i=!0,d(t,e))},function(e){i||(i=!0,c(t,e))});i||n!==a||(i=!0,c(t,r))}t.exports=s,s._10=null,s._97=null,s._61=o,s.prototype.then=function(e,t){if(this.constructor!==s)return n=e,r=t,new(i=this).constructor(function(e,t){var a=new s(o);a.then(e,t),l(i,new p(n,r,a))});var i,n,r,a=new s(o);return l(this,new p(e,t,a)),a}},{"asap/raw":97}],99:[function(e,t,i){"use strict";var n=e("./core.js");t.exports=n;var o=c(!0),r=c(!1),a=c(null),s=c(void 0),l=c(0),d=c("");function c(e){var t=new n(n._61);return t._81=1,t._65=e,t}n.resolve=function(e){if(e instanceof n)return e;if(null===e)return a;if(void 0===e)return s;if(!0===e)return o;if(!1===e)return r;if(0===e)return l;if(""===e)return d;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new n(t.bind(e))}catch(e){return new n(function(t,i){i(e)})}return c(e)},n.all=function(e){var t=Array.prototype.slice.call(e);return new n(function(e,i){if(0===t.length)return e([]);var o=t.length;function r(a,s){if(s&&("object"==typeof s||"function"==typeof s)){if(s instanceof n&&s.then===n.prototype.then){for(;3===s._81;)s=s._65;return 1===s._81?r(a,s._65):(2===s._81&&i(s._65),void s.then(function(e){r(a,e)},i))}var l=s.then;if("function"==typeof l)return void new n(l.bind(s)).then(function(e){r(a,e)},i)}t[a]=s,0==--o&&e(t)}for(var a=0;a<t.length;a++)r(a,t[a])})},n.reject=function(e){return new n(function(t,i){i(e)})},n.race=function(e){return new n(function(t,i){e.forEach(function(e){n.resolve(e).then(t,i)})})},n.prototype.catch=function(e){return this.then(null,e)}},{"./core.js":98}],100:[function(e,t,i){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(e,t){(arguments.length?this.then.apply(this,arguments):this).then(null,function(e){setTimeout(function(){throw e},0)})})},{}],101:[function(e,t,i){e("asap");"undefined"==typeof Promise&&(Promise=e("./lib/core.js"),e("./lib/es6-extensions.js")),e("./polyfill-done.js")},{"./lib/core.js":98,"./lib/es6-extensions.js":99,"./polyfill-done.js":100,asap:96}]},{},[2])(2)}),$.extend($.ui.tabs.prototype,{paging:function(e){var t={tabsPerPage:0,nextButton:"&#187;",prevButton:"&#171;",follow:!1,cycle:!1,selectOnAdd:!1,followOnSelect:!1};t=$.extend(t,e);var n,o,r,a,s,l,d,c=this,u=!1,p=null,m=$(window).height(),h=$(window).width();function f(){z(),a=0,n=0,l=0,o=0,d=new Array,s=new Array,selectedTabWidths=new Array,r=c.element.width();var e=0;if(c.lis.each(function(t){t==c.options.selected?(selectedTabWidths[t]=$(this).outerWidth({margin:!0}),s[t]=c.lis.eq(t).removeClass("ui-tabs-selected").outerWidth({margin:!0}),c.lis.eq(t).addClass("ui-tabs-selected"),e=Math.min(e,Math.abs(selectedTabWidths[t]-s[t])),a+=s[t]):(s[t]=$(this).outerWidth({margin:!0}),selectedTabWidths[t]=c.lis.eq(t).addClass("ui-tabs-selected").outerWidth({margin:!0}),c.lis.eq(t).removeClass("ui-tabs-selected"),e=Math.max(e,Math.abs(selectedTabWidths[t]-s[t])),a+=s[t])}),(a+=e+($.browser.msie?4:0)+9)>r){li=$("<li></li>").addClass("ui-state-default ui-tabs-paging-next").append($('<a href="#"></a>').click(function(){return g("next"),!1}).html(t.nextButton)),c.lis.eq(c.length()-1).after(li),o=li.outerWidth({margin:!0}),li=$("<li></li>").addClass("ui-state-default ui-tabs-paging-prev").append($('<a href="#"></a>').click(function(){return g("prev"),!1}).html(t.prevButton)),c.lis.eq(0).before(li),o+=li.outerWidth({margin:!0}),o+=19;for(var i=0,p=0,m=0,h=0;h<s.length;h++)(0==p||selectedTabWidths[h]-s[h]>m)&&(m=selectedTabWidths[h]-s[h]),null==d[i]?d[i]={start:h}:(h>0&&h%t.tabsPerPage==0||s[h]+p+o+12>r)&&(p+m>l&&(l=p+m),d[++i]={start:h},p=0),d[i].end=h+1,p+=s[h],h==c.options.selected&&(n=i);p+m>l&&(l=p+m),c.lis.hide().slice(d[n].start,d[n].end).show(),n!=d.length-1||t.cycle||b("next"),0!=n||t.cycle||b("prev"),buttonPadding=r-l-o,buttonPadding>0&&$(".ui-tabs-paging-next",c.element).css({paddingRight:buttonPadding+"px"}),u=!0}else z();$(window).bind("resize",y)}function g(e){n+="prev"==e?-1:1,"prev"==e&&n<0&&t.cycle||"next"==e&&n>=d.length&&!t.cycle?n=d.length-1:("prev"==e&&n<0||"next"==e&&n>=d.length&&t.cycle)&&(n=0);var i=d[n].start,o=d[n].end;c.lis.hide().slice(i,o).show(),"prev"==e?(v("next"),t.follow&&(c.options.selected<i||c.options.selected>o-1)&&c.select(o-1),!t.cycle&&i<=0&&b("prev")):(v("prev"),t.follow&&(c.options.selected<i||c.options.selected>o-1)&&c.select(i),!t.cycle&&o>=c.length()&&b("next"))}function b(e){$(".ui-tabs-paging-"+e,c.element).addClass("ui-tabs-paging-disabled")}function v(e){$(".ui-tabs-paging-"+e,c.element).removeClass("ui-tabs-paging-disabled")}function y(){p&&clearTimeout(p),m==$(window).height()&&h==$(window).width()||(p=setTimeout(x,100))}function x(){m=$(window).height(),h=$(window).width(),f()}function z(){$(".ui-tabs-paging-next",c.element).remove(),$(".ui-tabs-paging-prev",c.element).remove(),c.lis.show(),u=!1,$(window).unbind("resize",y)}var C=c.add;c.add=function(e,i,n){u&&z(),C.apply(this,[e,i,n]),t.selectOnAdd&&(null==n&&(n=this.lis.length-1),this.select(n)),f()};var w=c.remove;c.remove=function(e){u&&z(),w.apply(this,[e]),f()};var E=c.select;c.select=function(e){if(E.apply(this,[e]),u&&t.followOnSelect)for(i in d){var o=d[i].start,r=d[i].end;if(e>=o&&e<r){i!=n&&(c.lis.hide().slice(o,r).show(),0==(n=parseInt(i))?(v("next"),!t.cycle&&o<=0&&b("prev")):(v("prev"),!t.cycle&&r>=c.length()&&b("next")));break}}},$.extend($.ui.tabs.prototype,{pagingDestroy:function(){z()}}),f()}}),function(e){e.timeago=function(n){return t.settings={refreshMillis:6e4,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:bizagi.localization.getResource("bizagi-editor-form-timeago-ago"),suffixFromNow:bizagi.localization.getResource("bizagi-editor-form-timeago-from-now"),seconds:bizagi.localization.getResource("bizagi-editor-form-timeago-seconds"),minute:bizagi.localization.getResource("bizagi-editor-form-timeago-minute"),minutes:bizagi.localization.getResource("bizagi-editor-form-timeago-minutes"),hour:bizagi.localization.getResource("bizagi-editor-form-timeago-hour"),hours:bizagi.localization.getResource("bizagi-editor-form-timeago-hours"),day:bizagi.localization.getResource("bizagi-editor-form-timeago-day"),days:bizagi.localization.getResource("bizagi-editor-form-timeago-days"),month:bizagi.localization.getResource("bizagi-editor-form-timeago-month"),months:bizagi.localization.getResource("bizagi-editor-form-timeago-months"),year:bizagi.localization.getResource("bizagi-editor-form-timeago-year"),years:bizagi.localization.getResource("bizagi-editor-form-timeago-years"),wordSeparator:" ",numbers:[]}},n instanceof Date?i(n):i("string"==typeof n?e.timeago.parse(n):"number"==typeof n?new Date(n):e.timeago.datetime(n))};var t=e.timeago;function i(e){return t.inWords((i=e,(new Date).getTime()-i.getTime()));var i}e.extend(e.timeago,{inWords:function(t){var i=this.settings.strings,n=i.prefixAgo,o=i.suffixAgo;this.settings.allowFuture&&t<0&&(n=i.prefixFromNow,o=i.suffixFromNow);var r=Math.abs(t)/1e3,a=r/60,s=a/60,l=s/24,d=l/365;function c(n,o){var r=e.isFunction(n)?n(o,t):n,a=i.numbers&&i.numbers[o]||o;return r.replace(/%d/i,a)}var u=r<45&&c(i.seconds,Math.round(r))||r<90&&c(i.minute,1)||a<45&&c(i.minutes,Math.round(a))||a<90&&c(i.hour,1)||s<24&&c(i.hours,Math.round(s))||s<42&&c(i.day,1)||l<30&&c(i.days,Math.round(l))||l<45&&c(i.month,1)||l<365&&c(i.months,Math.round(l/30))||d<1.5&&c(i.year,1)||c(i.years,Math.round(d)),p=i.wordSeparator||"";return void 0===i.wordSeparator&&(p=" "),e.trim([n,u,o].join(p))},parse:function(t){var i=e.trim(t);return i=(i=(i=(i=(i=i.replace(/\.\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2")).replace(/([\+\-]\d\d)$/," $100"),new Date(i)},datetime:function(i){var n=t.isTime(i)?e(i).attr("datetime"):e(i).attr("title");return t.parse(n)},isTime:function(t){return"time"===e(t).get(0).tagName.toLowerCase()}})}(jQuery),function(e){e.fn.toogleBoolean=function(t){t=t||{};var i=this,n=this.children();afterActivated=t.afterActivated||e.noop,this.bind("click",function(e){i.css("background-color","#f2f2f2");var t=i.hasClass("active"),o=t?"-=15":"+=15";e.preventDefault(),n.animate({left:o},600,function(){i.toggleClass("active"),t?(i.css("background-color",""),afterActivated.call(null,!1)):(i.css("background-color","rgb(116, 202, 116)"),afterActivated.call(null,!0))})})}}(jQuery),function($){function Timepicker(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",ampm:!1,amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"hh:mm tt",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone"},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showMillisec:!1,showTimezone:!1,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,showTimepicker:!0,timezoneIso8609:!1,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null},$.extend(this._defaults,this.regional[""])}function extendRemove(e,t){for(var i in $.extend(e,t),t)null!==t[i]&&void 0!==t[i]||(e[i]=t[i]);return e}$.ui.timepicker=$.ui.timepicker||{},$.ui.timepicker.version||($.extend($.ui,{timepicker:{version:"1.0.0"}}),$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={};for(var attrName in this._defaults){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(e){inlineSettings[attrName]=attrValue}}if(tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(e,t){if($.isFunction(o.beforeShow))return o.beforeShow(e,t,tp_inst)},onChangeMonthYear:function(e,t,i){tp_inst._updateDateTime(i),$.isFunction(o.onChangeMonthYear)&&o.onChangeMonthYear.call($input[0],e,t,i,tp_inst)},onClose:function(e,t){!0===tp_inst.timeDefined&&""!=$input.val()&&tp_inst._updateDateTime(t),$.isFunction(o.onClose)&&o.onClose.call($input[0],e,t,tp_inst)},timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(e){return e.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(e){return e.toUpperCase()}),null===tp_inst._defaults.timezoneList){for(var timezoneList=[],i=-11;i<=12;i++)timezoneList.push((i>=0?"+":"-")+("0"+Math.abs(i).toString()).slice(-2)+"00");tp_inst._defaults.timezoneIso8609&&(timezoneList=$.map(timezoneList,function(e){return"+0000"==e?"Z":e.substring(0,3)+":"+e.substring(3)})),tp_inst._defaults.timezoneList=timezoneList}return tp_inst.hour=tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})),0!=tp_inst._defaults.minDate&&0!=tp_inst._defaults.minDateTime||(tp_inst._defaults.minDate=new Date),0!=tp_inst._defaults.maxDate&&0!=tp_inst._defaults.maxDateTime||(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst},_addTimePicker:function(e){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t),this._limitMinMaxDateTime(e,!1),this._injectTimePicker()},_parseTime:function(e,t){var i,n=this._defaults.timeFormat.toString().replace(/h{1,2}/gi,"(\\d?\\d)").replace(/m{1,2}/gi,"(\\d?\\d)").replace(/s{1,2}/gi,"(\\d?\\d)").replace(/l{1}/gi,"(\\d?\\d?\\d)").replace(/t{1,2}/gi,this._getPatternAmpm()).replace(/z{1}/gi,"(z|[-+]\\d\\d:?\\d\\d)?").replace(/\s/g,"\\s?")+this._defaults.timeSuffix+"$",o=this._getFormatPositions(),r="";if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),t||!this._defaults.timeOnly){var a=$.datepicker._get(this.inst,"dateFormat"),s=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");n="^.{"+a.length+",}?"+this._defaults.separator.replace(s,"\\$&")+n}if(i=e.match(new RegExp(n,"i"))){if(-1!==o.t&&(void 0===i[o.t]||0===i[o.t].length?(r="",this.ampm=""):(r=-1!==$.inArray(i[o.t].toUpperCase(),this.amNames)?"AM":"PM",this.ampm=this._defaults["AM"==r?"amNames":"pmNames"][0])),-1!==o.h&&("AM"==r&&"12"==i[o.h]?this.hour=0:"PM"==r&&"12"!=i[o.h]?this.hour=(parseFloat(i[o.h])+12).toFixed(0):this.hour=Number(i[o.h])),-1!==o.m&&(this.minute=Number(i[o.m])),-1!==o.s&&(this.second=Number(i[o.s])),-1!==o.l&&(this.millisec=Number(i[o.l])),-1!==o.z&&void 0!==i[o.z]){var l=i[o.z].toUpperCase();switch(l.length){case 1:l=this._defaults.timezoneIso8609?"Z":"+0000";break;case 5:this._defaults.timezoneIso8609&&(l="0000"==l.substring(1)?"Z":l.substring(0,3)+":"+l.substring(3));break;case 6:this._defaults.timezoneIso8609?"00:00"==l.substring(1)&&(l="Z"):l="Z"==l||"00:00"==l.substring(1)?"+0000":l.replace(/:/,"")}this.timezone=l}return!0}return!1},_getPatternAmpm:function(){var e=[],t=this._defaults;return t.amNames&&$.merge(e,t.amNames),t.pmNames&&$.merge(e,t.pmNames),"("+(e=$.map(e,function(e){return e.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")})).join("|")+")?"},_getFormatPositions:function(){var e=this._defaults.timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z)/g),t={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(e)for(var i=0;i<e.length;i++)-1==t[e[i].toString().charAt(0)]&&(t[e[i].toString().charAt(0)]=i+1);return t},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this._defaults,i=this,n=parseInt(t.hourMax-(t.hourMax-t.hourMin)%t.stepHour,10),o=parseInt(t.minuteMax-(t.minuteMax-t.minuteMin)%t.stepMinute,10),r=parseInt(t.secondMax-(t.secondMax-t.secondMin)%t.stepSecond,10),a=parseInt(t.millisecMax-(t.millisecMax-t.millisecMin)%t.stepMillisec,10),s=this.inst.id.toString().replace(/([^A-Za-z0-9_])/g,"");if(0===e.find("div#ui-timepicker-div-"+s).length&&t.showTimepicker){var l=' style="display:none;"',d='<div class="ui-timepicker-div" id="ui-timepicker-div-'+s+'"><dl><dt class="ui_tpicker_time_label" id="ui_tpicker_time_label_'+s+'"'+(t.showTime?"":l)+">"+t.timeText+'</dt><dd class="ui_tpicker_time" id="ui_tpicker_time_'+s+'"'+(t.showTime?"":l)+'></dd><dt class="ui_tpicker_hour_label" id="ui_tpicker_hour_label_'+s+'"'+(t.showHour?"":l)+">"+t.hourText+"</dt>",c=0,u=0,p=0,m=0,h=null;if(d+='<dd class="ui_tpicker_hour"><div id="ui_tpicker_hour_'+s+'"'+(t.showHour?"":l)+"></div>",t.showHour&&t.hourGrid>0){d+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var f=t.hourMin;f<=n;f+=parseInt(t.hourGrid,10)){c++;var g=t.ampm&&f>12?f-12:f;g<10&&(g="0"+g),t.ampm&&(0==f?g="12a":g+=f<12?"a":"p"),d+="<td>"+g+"</td>"}d+="</tr></table></div>"}if(d+="</dd>",d+='<dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+s+'"'+(t.showMinute?"":l)+">"+t.minuteText+'</dt><dd class="ui_tpicker_minute"><div id="ui_tpicker_minute_'+s+'"'+(t.showMinute?"":l)+"></div>",t.showMinute&&t.minuteGrid>0){d+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var b=t.minuteMin;b<=o;b+=parseInt(t.minuteGrid,10))u++,d+="<td>"+(b<10?"0":"")+b+"</td>";d+="</tr></table></div>"}if(d+="</dd>",d+='<dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+s+'"'+(t.showSecond?"":l)+">"+t.secondText+'</dt><dd class="ui_tpicker_second"><div id="ui_tpicker_second_'+s+'"'+(t.showSecond?"":l)+"></div>",t.showSecond&&t.secondGrid>0){d+='<div style="padding-left: 1px"><table><tr>';for(var v=t.secondMin;v<=r;v+=parseInt(t.secondGrid,10))p++,d+="<td>"+(v<10?"0":"")+v+"</td>";d+="</tr></table></div>"}if(d+="</dd>",d+='<dt class="ui_tpicker_millisec_label" id="ui_tpicker_millisec_label_'+s+'"'+(t.showMillisec?"":l)+">"+t.millisecText+'</dt><dd class="ui_tpicker_millisec"><div id="ui_tpicker_millisec_'+s+'"'+(t.showMillisec?"":l)+"></div>",t.showMillisec&&t.millisecGrid>0){d+='<div style="padding-left: 1px"><table><tr>';for(var y=t.millisecMin;y<=a;y+=parseInt(t.millisecGrid,10))m++,d+="<td>"+(y<10?"0":"")+y+"</td>";d+="</tr></table></div>"}d+="</dd>",d+='<dt class="ui_tpicker_timezone_label" id="ui_tpicker_timezone_label_'+s+'"'+(t.showTimezone?"":l)+">"+t.timezoneText+"</dt>",d+='<dd class="ui_tpicker_timezone" id="ui_tpicker_timezone_'+s+'"'+(t.showTimezone?"":l)+"></dd>",d+="</dl></div>",$tp=$(d),!0===t.timeOnly&&($tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div></div>"),e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),this.hour_slider=$tp.find("#ui_tpicker_hour_"+s).slider({orientation:"horizontal",value:this.hour,min:t.hourMin,max:n,step:t.stepHour,slide:function(e,t){i.hour_slider.slider("option","value",t.value),i._onTimeChange()}}),this.minute_slider=$tp.find("#ui_tpicker_minute_"+s).slider({orientation:"horizontal",value:this.minute,min:t.minuteMin,max:o,step:t.stepMinute,slide:function(e,t){i.minute_slider.slider("option","value",t.value),i._onTimeChange()}}),this.second_slider=$tp.find("#ui_tpicker_second_"+s).slider({orientation:"horizontal",value:this.second,min:t.secondMin,max:r,step:t.stepSecond,slide:function(e,t){i.second_slider.slider("option","value",t.value),i._onTimeChange()}}),this.millisec_slider=$tp.find("#ui_tpicker_millisec_"+s).slider({orientation:"horizontal",value:this.millisec,min:t.millisecMin,max:a,step:t.stepMillisec,slide:function(e,t){i.millisec_slider.slider("option","value",t.value),i._onTimeChange()}}),this.timezone_select=$tp.find("#ui_tpicker_timezone_"+s).append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,function(e,t){return $("<option />").val("object"==typeof e?e.value:e).text("object"==typeof e?e.label:e)})),this.timezone_select.val(void 0!==this.timezone&&null!=this.timezone&&""!=this.timezone?this.timezone:t.timezone),this.timezone_select.change(function(){i._onTimeChange()}),t.showHour&&t.hourGrid>0&&(h=100*c*t.hourGrid/(n-t.hourMin),$tp.find(".ui_tpicker_hour table").css({width:h+"%",marginLeft:h/(-2*c)+"%",borderCollapse:"collapse"}).find("td").each(function(e){$(this).click(function(){var e=$(this).html();if(t.ampm){var n=e.substring(2).toLowerCase(),o=parseInt(e.substring(0,2),10);e="a"==n?12==o?0:o:12==o?12:o+12}i.hour_slider.slider("option","value",e),i._onTimeChange(),i._onSelectHandler()}).css({cursor:"pointer",width:100/c+"%",textAlign:"center",overflow:"hidden"})})),t.showMinute&&t.minuteGrid>0&&(h=100*u*t.minuteGrid/(o-t.minuteMin),$tp.find(".ui_tpicker_minute table").css({width:h+"%",marginLeft:h/(-2*u)+"%",borderCollapse:"collapse"}).find("td").each(function(e){$(this).click(function(){i.minute_slider.slider("option","value",$(this).html()),i._onTimeChange(),i._onSelectHandler()}).css({cursor:"pointer",width:100/u+"%",textAlign:"center",overflow:"hidden"})})),t.showSecond&&t.secondGrid>0&&$tp.find(".ui_tpicker_second table").css({width:h+"%",marginLeft:h/(-2*p)+"%",borderCollapse:"collapse"}).find("td").each(function(e){$(this).click(function(){i.second_slider.slider("option","value",$(this).html()),i._onTimeChange(),i._onSelectHandler()}).css({cursor:"pointer",width:100/p+"%",textAlign:"center",overflow:"hidden"})}),t.showMillisec&&t.millisecGrid>0&&$tp.find(".ui_tpicker_millisec table").css({width:h+"%",marginLeft:h/(-2*m)+"%",borderCollapse:"collapse"}).find("td").each(function(e){$(this).click(function(){i.millisec_slider.slider("option","value",$(this).html()),i._onTimeChange(),i._onSelectHandler()}).css({cursor:"pointer",width:100/m+"%",textAlign:"center",overflow:"hidden"})});var x=e.find(".ui-datepicker-buttonpane");if(x.length?x.before($tp):e.append($tp),this.$timeObj=$tp.find("#ui_tpicker_time_"+s),null!==this.inst){var z=this.timeDefined;this._onTimeChange(),this.timeDefined=z}var C=function(){i._onSelectHandler()};if(this.hour_slider.bind("slidestop",C),this.minute_slider.bind("slidestop",C),this.second_slider.bind("slidestop",C),this.millisec_slider.bind("slidestop",C),this._defaults.addSliderAccess){var w=this._defaults.sliderAccessArgs;setTimeout(function(){if(0==$tp.find(".ui-slider-access").length){$tp.find(".ui-slider:visible").sliderAccess(w);var e=$tp.find(".ui-slider-access:eq(0)").outerWidth(!0);e&&$tp.find("table:visible").each(function(){var t=$(this),i=t.outerWidth(),n=t.css("marginLeft").toString().replace("%",""),o=i-e,r=n*o/i+"%";t.css({width:o,marginLeft:r})})}},0)}}},_limitMinMaxDateTime:function(e,t){var i=this._defaults,n=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(e,"minDateTime")&&void 0!==$.datepicker._get(e,"minDateTime")&&n){var o=$.datepicker._get(e,"minDateTime"),r=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0);null!==this.hourMinOriginal&&null!==this.minuteMinOriginal&&null!==this.secondMinOriginal&&null!==this.millisecMinOriginal||(this.hourMinOriginal=i.hourMin,this.minuteMinOriginal=i.minuteMin,this.secondMinOriginal=i.secondMin,this.millisecMinOriginal=i.millisecMin),e.settings.timeOnly||r.getTime()==n.getTime()?(this._defaults.hourMin=o.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=o.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=o.getSeconds()):this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=o.getMilliseconds()):(this.millisec<this._defaults.millisecMin&&(this.millisec=this._defaults.millisecMin),this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)}if(null!==$.datepicker._get(e,"maxDateTime")&&void 0!==$.datepicker._get(e,"maxDateTime")&&n){var a=$.datepicker._get(e,"maxDateTime"),s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);null!==this.hourMaxOriginal&&null!==this.minuteMaxOriginal&&null!==this.secondMaxOriginal||(this.hourMaxOriginal=i.hourMax,this.minuteMaxOriginal=i.minuteMax,this.secondMaxOriginal=i.secondMax,this.millisecMaxOriginal=i.millisecMax),e.settings.timeOnly||s.getTime()==n.getTime()?(this._defaults.hourMax=a.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=a.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=a.getSeconds()):this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=a.getMilliseconds()):(this.millisec>this._defaults.millisecMax&&(this.millisec=this._defaults.millisecMax),this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)}if(void 0!==t&&!0===t){var l=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),d=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),c=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),u=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);this.hour_slider&&this.hour_slider.slider("option",{min:this._defaults.hourMin,max:l}).slider("value",this.hour),this.minute_slider&&this.minute_slider.slider("option",{min:this._defaults.minuteMin,max:d}).slider("value",this.minute),this.second_slider&&this.second_slider.slider("option",{min:this._defaults.secondMin,max:c}).slider("value",this.second),this.millisec_slider&&this.millisec_slider.slider("option",{min:this._defaults.millisecMin,max:u}).slider("value",this.millisec)}}},_onTimeChange:function(){var e=!!this.hour_slider&&this.hour_slider.slider("value"),t=!!this.minute_slider&&this.minute_slider.slider("value"),i=!!this.second_slider&&this.second_slider.slider("value"),n=!!this.millisec_slider&&this.millisec_slider.slider("value"),o=!!this.timezone_select&&this.timezone_select.val(),r=this._defaults;"object"==typeof e&&(e=!1),"object"==typeof t&&(t=!1),"object"==typeof i&&(i=!1),"object"==typeof n&&(n=!1),"object"==typeof o&&(o=!1),!1!==e&&(e=parseInt(e,10)),!1!==t&&(t=parseInt(t,10)),!1!==i&&(i=parseInt(i,10)),!1!==n&&(n=parseInt(n,10));var a=r[e<12?"amNames":"pmNames"][0],s=e!=this.hour||t!=this.minute||i!=this.second||n!=this.millisec||this.ampm.length>0&&e<12!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||o!=this.timezone;s&&(!1!==e&&(this.hour=e),!1!==t&&(this.minute=t),!1!==i&&(this.second=i),!1!==n&&(this.millisec=n),!1!==o&&(this.timezone=o),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),r.ampm&&(this.ampm=a),this.formattedTime=$.datepicker.formatTime(this._defaults.timeFormat,this,this._defaults),this.$timeObj&&this.$timeObj.text(this.formattedTime+r.timeSuffix),this.timeDefined=!0,s&&this._updateDateTime()},_onSelectHandler:function(){var e=this._defaults.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_formatTime:function(e,t){e=e||{hour:this.hour,minute:this.minute,second:this.second,millisec:this.millisec,ampm:this.ampm,timezone:this.timezone};var i=(t||this._defaults.timeFormat).toString();if(i=$.datepicker.formatTime(i,e,this._defaults),arguments.length)return i;this.formattedTime=i},_updateDateTime:function(e){e=this.inst||e;var t=$.datepicker._daylightSavingAdjust(new Date(e.selectedYear,e.selectedMonth,e.selectedDay)),i=$.datepicker._get(e,"dateFormat"),n=$.datepicker._getFormatConfig(e),o=null!==t&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(i,null===t?new Date:t,n);var r=this.formattedDate;void 0!==e.lastVal&&e.lastVal.length>0&&0===this.$input.val().length||(!0===this._defaults.timeOnly?r=this.formattedTime:!0!==this._defaults.timeOnly&&(this._defaults.alwaysSetTime||o)&&(r+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=r,this._defaults.showTimepicker?this.$altInput&&!0===this._defaults.altFieldTimeOnly?(this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate)):this.$altInput?(this.$altInput.val(r),this.$input.val(r)):this.$input.val(r):this.$input.val(this.formattedDate),this.$input.trigger("change"))}}),$.fn.extend({timepicker:function(e){var t=arguments;return"object"==typeof(e=e||{})&&(t[0]=$.extend(e,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(e){return e=e||{},tmp_args=arguments,"string"==typeof e?"getDate"==e?$.fn.datepicker.apply($(this[0]),tmp_args):this.each(function(){var e=$(this);e.datepicker.apply(e,tmp_args)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)})}}),$.datepicker.formatTime=function(e,t,i){i=i||{},i=$.extend($.timepicker._defaults,i),t=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:"+0000"},t);var n=e,o=i.amNames[0],r=parseInt(t.hour,10);return i.ampm&&(r>11&&(o=i.pmNames[0],r>12&&(r%=12)),0===r&&(r=12)),n=n.replace(/(?:hh?|HH?|mm?|ss?|[tT]{1,2}|[lz])/g,function(e){switch(e.toLowerCase()){case"hh":return("0"+r).slice(-2);case"h":return r;case"mm":return("0"+t.minute).slice(-2);case"m":return t.minute;case"ss":return("0"+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"z":return t.timezone;case"t":case"tt":return i.ampm?(1==e.length&&(o=o.charAt(0)),"T"==e.charAt(0)?o.toUpperCase():o.toLowerCase()):""}}),n=$.trim(n)},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(e,t){var i=this._getInst($(e)[0]),n=this._get(i,"timepicker");n?(n._limitMinMaxDateTime(i,!0),i.inline=i.stay_open=!0,this._base_selectDate(e,t),i.inline=i.stay_open=!1,this._notifyChange(i),this._updateDatepicker(i)):this._base_selectDate(e,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){var t=e.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!=e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=t||"boolean"==typeof e.stay_open&&!1!==e.stay_open)){this._base_updateDatepicker(e);var i=this._get(e,"timepicker");i&&i._addTimePicker(e)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&$.datepicker._get(t,"constrainInput")){var n=i._defaults.ampm,o=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,n?"APM":"").replace(/Tt/g,n?"AaPpMm":"").replace(/tT/g,n?"AaPpMm":"").replace(/T/g,n?"AP":"").replace(/tt/g,n?"apm":"").replace(/t/g,n?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(i._defaults.showTimezone?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+o,a=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||a<" "||!o||r.indexOf(a)>-1}return $.datepicker._base_doKeyPress(e)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&i._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(e){$.datepicker.log(e)}return $.datepicker._base_doKeyUp(e)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]),i=t.dpDiv;this._base_gotoToday(e);var n=new Date,o=this._get(t,"timepicker");if(o&&o._defaults.showTimezone&&o.timezone_select){var r=n.getTimezoneOffset(),a=r>0?"-":"+",s=(r=Math.abs(r))%60;r=a+("0"+(r-s)/60).slice(-2)+("0"+s).slice(-2),o._defaults.timezoneIso8609&&(r=r.substring(0,3)+":"+r.substring(3)),o.timezone_select.val(r)}this._setTime(t,n),$(".ui-datepicker-today",i).click()},$.datepicker._disableTimepickerDatepicker=function(e,t,i){var n=this._getInst(e),o=this._get(n,"timepicker");$(e).datepicker("getDate"),o&&(o._defaults.showTimepicker=!1,o._updateDateTime(n))},$.datepicker._enableTimepickerDatepicker=function(e,t,i){var n=this._getInst(e),o=this._get(n,"timepicker");$(e).datepicker("getDate"),o&&(o._defaults.showTimepicker=!0,o._addTimePicker(n),o._updateDateTime(n))},$.datepicker._setTime=function(e,t){var i=this._get(e,"timepicker");if(i){var n=i._defaults,o=t?t.getHours():n.hour,r=t?t.getMinutes():n.minute,a=t?t.getSeconds():n.second,s=t?t.getMilliseconds():n.millisec;(o<n.hourMin||o>n.hourMax||r<n.minuteMin||r>n.minuteMax||a<n.secondMin||a>n.secondMax||s<n.millisecMin||s>n.millisecMax)&&(o=n.hourMin,r=n.minuteMin,a=n.secondMin,s=n.millisecMin),i.hour=o,i.minute=r,i.second=a,i.millisec=s,i.hour_slider&&i.hour_slider.slider("value",o),i.minute_slider&&i.minute_slider.slider("value",r),i.second_slider&&i.second_slider.slider("value",a),i.millisec_slider&&i.millisec_slider.slider("value",s),i._onTimeChange(),i._updateDateTime(e)}},$.datepicker._setTimeDatepicker=function(e,t,i){var n,o=this._getInst(e),r=this._get(o,"timepicker");r&&(this._setDateFromField(o),t&&("string"==typeof t?(r._parseTime(t,i),(n=new Date).setHours(r.hour,r.minute,r.second,r.millisec)):n=new Date(t.getTime()),"Invalid Date"==n.toString()&&(n=void 0),this._setTime(o,n)))},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(e,t){var i=this._getInst(e),n=t instanceof Date?new Date(t.getTime()):t;this._updateDatepicker(i),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(e,n,!0)},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(e,t){var i=this._getInst(e),n=this._get(i,"timepicker");if(n){this._setDateFromField(i,t);var o=this._getDate(i);return o&&n._parseTime($(e).val(),n.timeOnly)&&o.setHours(n.hour,n.minute,n.second,n.millisec),o}return this._base_getDateDatepicker(e,t)},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,i){var n;try{n=this._base_parseDate(e,t,i)}catch(o){if(!(o.indexOf(":")>=0))throw o;n=this._base_parseDate(e,t.substring(0,t.length-(o.length-o.indexOf(":")-2)),i)}return n},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(e,t,i,n){var o=this._get(e,"timepicker");return o?(o._updateDateTime(e),o.$input.val()):this._base_formatDate(e)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(e,t,i){var n=this._getInst(e),o=this._get(n,"timepicker");if(o){var r=null,a=null,s=null;"string"==typeof t?"minDate"===t||"minDateTime"===t?r=i:"maxDate"===t||"maxDateTime"===t?a=i:"onSelect"===t&&(s=i):"object"==typeof t&&(t.minDate?r=t.minDate:t.minDateTime?r=t.minDateTime:t.maxDate?a=t.maxDate:t.maxDateTime&&(a=t.maxDateTime)),r?(r=0==r?new Date:new Date(r),o._defaults.minDate=r,o._defaults.minDateTime=r):a?(a=0==a?new Date:new Date(a),o._defaults.maxDate=a,o._defaults.maxDateTime=a):s&&(o._defaults.onSelect=s)}return void 0===i?this._base_optionDatepicker(e,t):this._base_optionDatepicker(e,t,i)},$.timepicker=new Timepicker,$.timepicker.version="1.0.0")}(jQuery),function(e,t,i){var n={beforeShow:c,move:c,change:c,show:c,hide:c,color:!1,flat:!1,showInput:!1,showButtons:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",preferredFormat:!1,className:"",theme:"sp-light",palette:["fff","000"],selectionPalette:[]},o=[],r=t.browser.msie,a=["<div class='sp-replacer'>","<div class='sp-preview'></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),s=function(){var e="";if(r)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf  biz-actions-bar'>","<a class='sp-cancel biz-btn biz-action-btn' href='#'></a>","<a class='sp-choose biz-btn biz-action-btn' href='#'></a>","</div>","</div>","</div>"].join("")}(),l=function(e,t,i){for(var n=[],o=0;o<e.length;o++){var r=tinycolor(e[o]),a="";tinycolor.equals(t,e[o])&&(a+="sp-thumb-active ");var s="";"transparent"===e[o]?(s=r.toRgbString(),nTitle=e[o],a+="sp-thumb-transparent sp-thumb-light "):(s=nTitle=r.toHexString(),a+=r.toHsl().l<.5?"sp-thumb-dark ":"sp-thumb-light "),n.push('<span title="'+nTitle+'" data-color="'+s+'" style="background-color:'+r.toRgbString()+';" class="'+a+'"></span>')}return"<div class='sp-cf "+i+"'>"+n.join("")+"</div>"};function d(i,d){var c,h,f,g,b,v,y,x=(b=d,v=i,(y=t.extend({},n,b)).callbacks={move:p(y.move,v),change:p(y.change,v),show:p(y.show,v),hide:p(y.hide,v),beforeShow:p(y.beforeShow,v)},y),z=x.flat,C=x.showPaletteOnly,w=x.showPalette||C,E=x.showInitial&&!z,P=x.showInput,_=x.showSelectionPalette,T=x.localStorageKey,S=x.theme,R=x.callbacks,k=(c=Re,h=10,function(){var e=this,t=arguments;f&&clearTimeout(g),!f&&g||(g=setTimeout(function(){g=null,c.apply(e,t)},h))}),$=!1,I=0,M=0,F=0,D=0,N=0,O=0,A=0,V=0,B=0,L=x.palette.slice(0),U=t.isArray(L[0])?L:[L],G=x.selectionPalette.slice(0),q="sp-dragging",H=!!x.cancelResponse&&x.cancelResponse,X=i.ownerDocument,j=X.body,W=t(i),Y=t(s,X).addClass(S),K=Y.find(".sp-color"),J=Y.find(".sp-dragger"),Z=Y.find(".sp-hue"),Q=Y.find(".sp-slider"),ee=Y.find(".sp-input"),te=Y.find(".sp-palette"),ie=Y.find(".sp-initial"),ne=Y.find(".sp-cancel"),oe=Y.find(".sp-choose"),re=W.is("input"),ae=re&&!z,se=ae?t(a).addClass(S):t([]),le=ae?se:W,de=se.find(".sp-preview"),ce=x.color||re&&W.val(),ue=!1,pe=x.preferredFormat,me=pe,he=!x.showButtons;function fe(t){_&&(G.push(tinycolor(t).toHexString()),T&&e.localStorage&&(e.localStorage[T]=G.join(",")))}function ge(){var e=Ee(),i=t.map(U,function(t,i){return l(t,e,"sp-palette-row sp-palette-row-"+i)});G&&i.push(l(function(){var e=[],t=G,i={};if(w){for(var n=0;n<U.length;n++)for(var o=0;o<U[n].length;o++)i[r=tinycolor(U[n][o]).toHexString()]=!0;for(n=0;n<t.length;n++){var r=tinycolor(t[n]).toHexString();i.hasOwnProperty(r)||(e.push(t[n]),i[r]=!0)}}return e.reverse().slice(0,x.maxSelectionSize)}(),e,"sp-palette-row sp-palette-row-selection")),te.html(i.join(""))}function be(){if(E){var e=ue,t=Ee();ie.html(l([e,t],t,"sp-palette-row-initial"))}}function ve(){0!==M&&0!==I&&0!==D||Re(),Y.addClass(q)}function ye(){Y.removeClass(q)}function xe(){var e=tinycolor(ee.val());e.ok?we(e):ee.addClass("sp-validation-error")}function ze(){$?Re():!1!==R.beforeShow(Ee())&&(!function(){for(var e=0;e<o.length;e++)o[e]&&o[e].hide()}(),$=!0,t(X).bind("click.spectrum",Ce),t(e).bind("resize.spectrum",k),se.addClass("sp-active"),Y.show(),w&&ge(),Re(),_e(),ue=Ee(),be(),R.show(ue))}function Ce(){$&&!z&&($=!1,t(X).unbind("click.spectrum",Ce),t(e).unbind("resize.spectrum",k),se.removeClass("sp-active"),Y.hide(),!tinycolor.equals(Ee(),ue)&&(he?Se(!0):we(ue,!0)),R.hide(Ee()))}function we(e,i){if(t(".sp-thumb-active").removeClass("sp-thumb-active"),!tinycolor.equals(e,Ee())){var n=tinycolor(e),o=n.toHsv();O=o.h,A=o.s,V=o.v,B=o.a,_e(),i||(me=pe||n.format)}}function Ee(){return tinycolor.fromRatio({h:O,s:A,v:V,a:B})}function Pe(){_e(),R.move(Ee())}function _e(){ee.removeClass("sp-validation-error"),Te();var e=tinycolor({h:O,s:"1.0",v:"1.0",a:B});K.css("background-color",e.toHexString());var t=Ee(),i=0!==B?t.toHexString():"transparent";de.css("background-color",i),P&&ee.val(t.toString(me)),w&&ge(),be()}function Te(){var e=A*I,t=M-V*M;e=Math.max(-F,Math.min(I-F,e-F)),t=Math.max(-F,Math.min(M-F,t-F)),J.css({top:t,left:e});var i=O*D;Q.css({top:i-N})}function Se(e){var t=Ee();re&&W.val(t.toString(me)).change();var i=!tinycolor.equals(t,ue);ue=t,fe(t),e&&i&&R.change(t)}function Re(){var e,i,n,o,r,a,s,l,d,c;I=K.width(),M=K.height(),F=J.height(),Z.width(),D=Z.height(),N=Q.height(),z||Y.offset((i=le,n=(e=Y).outerWidth(),o=e.outerHeight(),i.outerWidth(),r=i.outerHeight(),a=e[0].ownerDocument,s=a.documentElement,l=s.clientWidth+t(a).scrollLeft(),d=s.clientHeight+t(a).scrollTop(),(c=i.offset()).top+=r,c.left-=Math.min(c.left,c.left+n>l&&l>n?Math.abs(c.left+n-l):0),c.top-=Math.min(c.top,c.top+o>d&&d>o?Math.abs(o+r-0):0),c)),Te()}function ke(){W.show(),le.unbind("click.spectrum touchstart.spectrum"),Y.remove(),se.remove(),o[$e.id]=null}oe.text(x.chooseText),ne.text(x.cancelText),function(){if(r&&Y.find("*:not(input)").attr("unselectable","on"),Y.toggleClass("sp-flat",z),Y.toggleClass("sp-input-disabled",!P),Y.toggleClass("sp-buttons-disabled",!x.showButtons),Y.toggleClass("sp-palette-disabled",!w),Y.toggleClass("sp-palette-only",C),Y.toggleClass("sp-initial-disabled",!E),Y.addClass(x.className),ae&&W.hide().after(se),z?W.after(Y).hide():t(j).append(Y.hide()),T&&e.localStorage)try{G=e.localStorage[T].split(",")}catch(e){}function i(e){return e.data&&e.data.ignore?(we(t(this).data("color")),Pe()):(we(t(this).data("color")),Se(!0),Pe(),Ce()),!1}le.bind("click.spectrum touchstart.spectrum",function(e){$?Ce():ze(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),Y.click(u),ee.change(xe),ee.bind("paste",function(){setTimeout(xe,1)}),ee.keydown(function(e){13==e.keyCode&&xe()}),ne.bind("click",function(e){e.stopPropagation(),e.preventDefault(),H?(z=!1,H.apply(this,[{instance:this,destroy:ke,hide:Ce}])):Ce()}),oe.bind("click",function(e){e.stopPropagation(),e.preventDefault(),ee.hasClass("sp-validation-error")||(Se(!0),Ce()),ne.trigger("click")}),m(Z,function(e,t){O=t/D,Pe()},ve,ye),m(K,function(e,t){A=e/I,V=(M-t)/M,Pe()},ve,ye),ce?(we(ce),_e(),me=pe||tinycolor(ce).format,fe(ce)):_e(),z&&ze();var n=r?"mousedown.spectrum":"click.spectrum touchstart.spectrum";te.delegate("span",n,i),ie.delegate("span::nth-child(1)",n,{ignore:!0},i)}();var $e={show:ze,hide:Ce,set:function(e){we(e),Se()},get:Ee,destroy:ke,container:Y};return $e.id=o.push($e)-1,$e}function c(){}function u(e){e.stopPropagation()}function p(e,t){var i=Array.prototype.slice,n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}function m(i,n,o,r){n=n||function(){},o=o||function(){},r=r||function(){};var a=i.ownerDocument||document,s=!1,l={},d=0,c=0,u=t.browser.msie,p="ontouchstart"in e,m={};function h(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function f(e){if(s){if(u&&!(document.documentMode>=9)&&!e.button)return g();var t=e.originalEvent.touches,o=t?t[0].pageX:e.pageX,r=t?t[0].pageY:e.pageY,a=Math.max(0,Math.min(o-l.left,c)),m=Math.max(0,Math.min(r-l.top,d));p&&h(e),n.apply(i,[a,m])}}function g(){s&&(t(a).unbind(m),t(a.body).removeClass("sp-dragging"),r.apply(i,arguments)),s=!1}m.selectstart=h,m.dragstart=h,m[p?"touchmove":"mousemove"]=f,m[p?"touchend":"mouseup"]=g,t(i).bind(p?"touchstart":"mousedown",function(e){var n=e.which?3==e.which:2==e.button;e.originalEvent.touches,n||s||!1!==o.apply(i,arguments)&&(s=!0,d=t(i).height(),c=t(i).width(),l=t(i).offset(),t(a).bind(m),t(a.body).addClass("sp-dragging"),p||f(e),h(e))})}var h="spectrum.id";t.fn.spectrum=function(e,i){return"string"==typeof e?"get"==e?o[this.eq(0).data(h)].get():"container"==e?o[t(this).data(h)].container:this.each(function(){var n=o[t(this).data(h)];n&&("show"==e&&n.show(),"hide"==e&&n.hide(),"set"==e&&n.set(i),"destroy"==e&&(n.destroy(),t(this).removeData(h)))}):this.spectrum("destroy").each(function(){var i=d(this,e);t(this).data(h,i.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=m,t.fn.spectrum.processNativeColorInputs=function(){"color"===t("<input type='color' />")[0].type||t("input[type=color]").spectrum({preferredFormat:"hex6"})},t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})}(this,jQuery),function(e){var t=/^[\s,#]+/,i=/\s+$/,n=0,o=Math,r=o.round,a=o.min,s=o.max,l=o.random,d=e.parseFloat;function c(e,l){if("object"==typeof e&&e.hasOwnProperty("_tc_id"))return e;var c=function(e){var n={r:0,g:0,b:0},l=1,d=!1,c=!1;"string"==typeof e&&(e=function(e){e=e.replace(t,"").replace(i,"").toLowerCase();var n,o=!1;if(h[e])e=h[e],o=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0};if(n=C.rgb.exec(e))return{r:n[1],g:n[2],b:n[3]};if(n=C.rgba.exec(e))return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=C.hsl.exec(e))return{h:n[1],s:n[2],l:n[3]};if(n=C.hsla.exec(e))return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=C.hsv.exec(e))return{h:n[1],s:n[2],v:n[3]};if(n=C.hex6.exec(e))return{r:v(n[1]),g:v(n[2]),b:v(n[3]),format:o?"name":"hex"};if(n=C.hex3.exec(e))return{r:v(n[1]+""+n[1]),g:v(n[2]+""+n[2]),b:v(n[3]+""+n[3]),format:o?"name":"hex"};return!1}(e));if("object"==typeof e){if(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b"))u=e.r,p=e.g,m=e.b,n={r:255*g(u,255),g:255*g(p,255),b:255*g(m,255)},d=!0,c="rgb";else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v"))n=function(e,t,i){e=6*g(e,360),t=g(t,100),i=g(i,100);var n=o.floor(e),r=e-n,a=i*(1-t),s=i*(1-r*t),l=i*(1-(1-r)*t),d=n%6;return{r:255*[i,s,a,a,l,i][d],g:255*[l,i,i,s,a,a][d],b:255*[a,a,l,i,i,s][d]}}(e.h,e.s,e.v),d=!0,c="hsv";else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")){var n=function(e,t,i){var n,o,r;function a(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}if(e=g(e,360),t=g(t,100),i=g(i,100),0==t)n=o=r=i;else{var s=i<.5?i*(1+t):i+t-i*t,l=2*i-s;n=a(l,s,e+1/3),o=a(l,s,e),r=a(l,s,e-1/3)}return{r:255*n,g:255*o,b:255*r}}(e.h,e.s,e.l);d=!0,c="hsl"}e.hasOwnProperty("a")&&(l=e.a)}var u,p,m;n.r=a(255,s(n.r,0)),n.g=a(255,s(n.g,0)),n.b=a(255,s(n.b,0)),n.r<1&&(n.r=r(n.r));n.g<1&&(n.g=r(n.g));n.b<1&&(n.b=r(n.b));return{ok:d,format:e&&e.format||c,r:n.r,g:n.g,b:n.b,a:l}}(e),b=c.r,y=c.g,x=c.b,z=d(c.a),w=c.format;return{ok:c.ok,format:w,_tc_id:n++,alpha:z,toHsv:function(){var e=p(b,y,x);return{h:e.h,s:e.s,v:e.v,a:z}},toHsvString:function(){var e=p(b,y,x),t=r(360*e.h),i=r(100*e.s),n=r(100*e.v);return 1==z?"hsv("+t+", "+i+"%, "+n+"%)":"hsva("+t+", "+i+"%, "+n+"%, "+z+")"},toHsl:function(){var e=u(b,y,x);return{h:e.h,s:e.s,l:e.l,a:z}},toHslString:function(){var e=u(b,y,x),t=r(360*e.h),i=r(100*e.s),n=r(100*e.l);return 1==z?"hsl("+t+", "+i+"%, "+n+"%)":"hsla("+t+", "+i+"%, "+n+"%, "+z+")"},toHex:function(){return m(b,y,x)},toHexString:function(e){return"#"+m(b,y,x,e)},toRgb:function(){return{r:r(b),g:r(y),b:r(x),a:z}},toRgbString:function(){return 1==z?"rgb("+r(b)+", "+r(y)+", "+r(x)+")":"rgba("+r(b)+", "+r(y)+", "+r(x)+", "+z+")"},toName:function(){return f[m(b,y,x)]||!1},toFilter:function(){var e=m(b,y,x),t=Math.round(255*d(z)).toString(16);return"progid:DXImageTransform.Microsoft.gradient(startColorstr=#"+t+e+",endColorstr=#"+t+e+")"},toString:function(e){var t=!1;return"rgb"===(e=e||this.format)&&(t=this.toRgbString()),"hex"===e&&(t=this.toHexString()),"hex6"===e&&(t=this.toHexString(!0)),"name"===e&&(t=this.toName()),"hsl"===e&&(t=this.toHslString()),"hsv"===e&&(t=this.toHsvString()),t||this.toHexString()}}}function u(e,t,i){e=g(e,255),t=g(t,255),i=g(i,255);var n,o,r=s(e,t,i),l=a(e,t,i),d=(r+l)/2;if(r==l)n=o=0;else{var c=r-l;switch(o=d>.5?c/(2-r-l):c/(r+l),r){case e:n=(t-i)/c+(t<i?6:0);break;case t:n=(i-e)/c+2;break;case i:n=(e-t)/c+4}n/=6}return{h:n,s:o,l:d}}function p(e,t,i){e=g(e,255),t=g(t,255),i=g(i,255);var n,o,r=s(e,t,i),l=a(e,t,i),d=r,c=r-l;if(o=0==r?0:c/r,r==l)n=0;else{switch(r){case e:n=(t-i)/c+(t<i?6:0);break;case t:n=(i-e)/c+2;break;case i:n=(e-t)/c+4}n/=6}return{h:n,s:o,v:d}}function m(e,t,i,n){function o(e){return 1==e.length?"0"+e:""+e}var a=[o(r(e).toString(16)),o(r(t).toString(16)),o(r(i).toString(16))];return n||a[0].charAt(0)!=a[0].charAt(1)||a[1].charAt(0)!=a[1].charAt(1)||a[2].charAt(0)!=a[2].charAt(1)?a.join(""):a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)}c.fromRatio=function(e){if("object"==typeof e)for(var t in e)1===e[t]&&(e[t]="1.0");return c(e)},c.equals=function(e,t){return!(!e||!t)&&(c.validateTransparentColor(e,t)?c(e).toRgbString()===c(t).toRgbString():c(e).toHex()==c(t).toHex())},c.random=function(){return c.fromRatio({r:l(),g:l(),b:l()})},c.validateTransparentColor=function(e,t){return"transparent"===e||"transparent"===t||0===e.alpha||0===t.alpha||"rgba(0, 0, 0, 0)"===e||"rgba(0, 0, 0, 0)"===t},c.desaturate=function(e,t){var i=c(e).toHsl();return i.s-=(t||10)/100,i.s=b(i.s),c(i)},c.saturate=function(e,t){var i=c(e).toHsl();return i.s+=(t||10)/100,i.s=b(i.s),c(i)},c.greyscale=function(e){return c.desaturate(e,100)},c.lighten=function(e,t){var i=c(e).toHsl();return i.l+=(t||10)/100,i.l=b(i.l),c(i)},c.darken=function(e,t){var i=c(e).toHsl();return i.l-=(t||10)/100,i.l=b(i.l),c(i)},c.complement=function(e){var t=c(e).toHsl();return t.h=(t.h+.5)%1,c(t)},c.triad=function(e){var t=c(e).toHsl(),i=360*t.h;return[c(e),c({h:(i+120)%360,s:t.s,l:t.l}),c({h:(i+240)%360,s:t.s,l:t.l})]},c.tetrad=function(e){var t=c(e).toHsl(),i=360*t.h;return[c(e),c({h:(i+90)%360,s:t.s,l:t.l}),c({h:(i+180)%360,s:t.s,l:t.l}),c({h:(i+270)%360,s:t.s,l:t.l})]},c.splitcomplement=function(e){var t=c(e).toHsl(),i=360*t.h;return[c(e),c({h:(i+72)%360,s:t.s,l:t.l}),c({h:(i+216)%360,s:t.s,l:t.l})]},c.analogous=function(e,t,i){t=t||6,i=i||30;var n=c(e).toHsl(),o=360/i,r=[c(e)];for(n.h*=360,n.h=(n.h-(o*t>>1)+720)%360;--t;)n.h=(n.h+o)%360,r.push(c(n));return r},c.monochromatic=function(e,t){t=t||6;for(var i=c(e).toHsv(),n=i.h,o=i.s,r=i.v,a=[],s=1/t;t--;)a.push(c({h:n,s:o,v:r})),r=(r+s)%1;return a},c.readable=function(e,t){var i=c(e).toRgb(),n=c(t).toRgb();return(n.r-i.r)*(n.r-i.r)+(n.g-i.g)*(n.g-i.g)+(n.b-i.b)*(n.b-i.b)>10404};var h=c.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},f=c.hexNames=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t}(h);function g(e,t){var i;"string"==typeof(i=e)&&-1!=i.indexOf(".")&&1===d(i)&&(e="100%");var n,r="string"==typeof(n=e)&&-1!=n.indexOf("%");return e=a(t,s(0,d(e))),r&&(e*=t/100),o.abs(e-t)<1e-6?1:e>=1?e%t/d(t):e}function b(e){return a(1,s(0,e))}function v(e){return parseInt(e,16)}var y,x,z,C=(x="[\\s|\\(]+("+(y="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+y+")[,|\\s]+("+y+")\\s*\\)?",z="[\\s|\\(]+("+y+")[,|\\s]+("+y+")[,|\\s]+("+y+")[,|\\s]+("+y+")\\s*\\)?",{rgb:new RegExp("rgb"+x),rgba:new RegExp("rgba"+z),hsl:new RegExp("hsl"+x),hsla:new RegExp("hsla"+z),hsv:new RegExp("hsv"+x),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});e.tinycolor=c}(this),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";var t=e.scrollTo=function(t,i,n){return e(window).scrollTo(t,i,n)};function i(t){return!t.nodeName||-1!==e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])}function n(t){return e.isFunction(t)||e.isPlainObject(t)?t:{top:t,left:t}}return t.defaults={axis:"xy",duration:0,limit:!0},e.fn.scrollTo=function(o,r,a){"object"==typeof r&&(a=r,r=0),"function"==typeof a&&(a={onAfter:a}),"max"===o&&(o=9e9),a=e.extend({},t.defaults,a),r=r||a.duration;var s=a.queue&&a.axis.length>1;return s&&(r/=2),a.offset=n(a.offset),a.over=n(a.over),this.each(function(){if(null!==o){var l,d=i(this),c=d?this.contentWindow||window:this,u=e(c),p=o,m={};switch(typeof p){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(p)){p=n(p);break}p=d?e(p):e(p,c);case"object":if(0===p.length)return;(p.is||p.style)&&(l=(p=e(p)).offset())}var h=e.isFunction(a.offset)&&a.offset(c,p)||a.offset;e.each(a.axis.split(""),function(e,i){var n="x"===i?"Left":"Top",o=n.toLowerCase(),r="scroll"+n,g=u[r](),b=t.max(c,i);if(l)m[r]=l[o]+(d?0:g-u.offset()[o]),a.margin&&(m[r]-=parseInt(p.css("margin"+n),10)||0,m[r]-=parseInt(p.css("border"+n+"Width"),10)||0),m[r]+=h[o]||0,a.over[o]&&(m[r]+=p["x"===i?"width":"height"]()*a.over[o]);else{var v=p[o];m[r]=v.slice&&"%"===v.slice(-1)?parseFloat(v)/100*b:v}a.limit&&/^\d+$/.test(m[r])&&(m[r]=m[r]<=0?0:Math.min(m[r],b)),!e&&a.axis.length>1&&(g===m[r]?m={}:s&&(f(a.onAfterFirst),m={}))}),f(a.onAfter)}function f(t){var i=e.extend({},a,{queue:!0,duration:r,complete:t&&function(){t.call(c,p,a)}});u.animate(m,i)}})},t.max=function(t,n){var o="x"===n?"Width":"Height",r="scroll"+o;if(!i(t))return t[r]-e(t)[o.toLowerCase()]();var a="client"+o,s=t.ownerDocument||t.document,l=s.documentElement,d=s.body;return Math.max(l[r],d[r])-Math.min(l[a],d[a])},e.Tween.propHooks.scrollLeft=e.Tween.propHooks.scrollTop={get:function(t){return e(t.elem)[t.prop]()},set:function(t){var i=this.get(t);if(t.options.interrupt&&t._last&&t._last!==i)return e(t.elem).stop();var n=Math.round(t.now);i!==n&&(e(t.elem)[t.prop](n),t._last=this.get(t))}},t}),function(e){function t(t,i,n){var o;this.element=e(t),this.options=e.extend({pickerClass:"wpd",days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayShort:2,monthShort:3,startDay:0,timePicker:!1,timePickerOnly:!1,yearPicker:!0,militaryTime:!1,yearsPerPage:20,format:"d-m-Y",allowEmpty:!1,inputOutputFormat:"U",animationDuration:400,useFadeInOut:!e.browser.msie,startView:"month",positionOffset:{x:0,y:0},minDate:null,maxDate:null,debug:!1,toggleElements:null,onShow:e.noop,onClose:e.noop,onSelect:e.noop},n),null!=this.options.toggleElements&&this.options.toggleElements.jquery&&(this.toggler=this.options.toggleElements.eq(i),document.keydown(e.proxy(function(e){9==e.which&&this.close(null,!0)},this))),this.formatMinMaxDates(),e(document).mousedown(e.proxy(this.close,this)),this.options.timePickerOnly&&(this.options.timePicker=!0,this.options.startView="time"),(o=this.element.val())?o=this.format(new Date(this.unformat(o,this.options.inputOutputFormat)),this.options.format):this.options.allowEmpty?o="":(o=this.format(new Date,this.options.format),this.element.val(this.format(new Date,this.options.inputOutputFormat))),this.display=this.element.css("display"),this.clone=this.element.css("display",this.options.debug?this.display:"none").data("will_pickdate",!0).clone(!0).data("will_pickdate",!0).removeAttr("name").attr("id",this.element.attr("id")+"_display").css("display",this.display).val(o),this.element.before(this.clone),this.toggler?(this.toggler.css("cursor","pointer").click(e.proxy(function(e){this.onFocus(this.element,this.clone)},this)),this.clone.blur(e.proxy(function(){this.element.val(this.clone.val())},this))):this.clone.bind({keydown:e.proxy(function(t){!this.options.allowEmpty||46!=t.which&&8!=t.which?9==t.which||27==t.which?this.close(null,!0):t.preventDefault():(this.element.val(""),e(t.target).val(""),this.close(null,!0))},this),focus:e.proxy(function(e){this.onFocus(this.element,this.clone)},this)})}e.fn.will_pickdate=function(i){return this.each(function(n){e.data(this,"will_pickdate")||new t(this,n,i)})},t.prototype={onFocus:function(e,t){var i;(i=e.val())?i=this.unformat(i,this.options.inputOutputFormat).valueOf():(i=new Date,this.options.maxDate&&i.valueOf()>this.options.maxDate.valueOf()&&(i=new Date(this.options.maxDate.valueOf())),this.options.minDate&&i.valueOf()<this.options.minDate.valueOf()&&(i=new Date(this.options.minDate.valueOf()))),this.input=e,this.visual=t,this.show(i)},dateToObject:function(e){return{year:e.getFullYear(),month:e.getMonth(),day:e.getDate(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}},dateFromObject:function(t){var i,n=new Date;return n.setDate(1),e.each(["year","month","day","hours","minutes","seconds"],e.proxy(function(e,o){if((i=t[o])||0===i)switch(o){case"day":n.setDate(i);break;case"month":n.setMonth(i);break;case"year":n.setFullYear(i);break;case"hours":n.setHours(i);break;case"minutes":n.setMinutes(i);break;case"seconds":n.setSeconds(i)}},this)),n},pickerPosition:function(){var t={left:this.visual.offset().left+this.options.positionOffset.x,top:this.visual.offset().top+this.options.positionOffset.y},i=e(window).height(),n=e(window).scrollTop(),o=this.picker.outerHeight(),r=Math.abs(i-t.top+this.visual.outerHeight())>o;return t.top+n>o||r?r?t.top+=this.visual.outerHeight():t.top-=o:(t.top=i/2-o/2,i+n<o&&console.warn("will_pickdate: Not enough room to display date picker.")),t},show:function(t){this.formatMinMaxDates(),this.working_date=t?new Date(t):new Date,this.today=new Date,this.choice=this.dateToObject(this.working_date),this.mode="time"!=this.options.startView||this.options.timePicker?this.options.startView:"month",this.render(),this.picker.css(this.pickerPosition()),e.isFunction(this.options.onShow)&&this.options.onShow()},render:function(e){if(this.picker){var t=this.oldContents;this.oldContents=this.newContents,this.newContents=t,this.newContents.empty()}else this.constructPicker();var i=new Date(this.working_date.getTime());switch(this.limit={right:!1,left:!1},this.mode){case"decades":this.renderDecades();break;case"year":this.renderYear();break;case"time":this.renderTime(),this.limit={right:!0,left:!0};break;default:this.renderMonth()}this.picker.find(".previous").toggleClass("disabled",this.limit.left),this.picker.find(".next").toggleClass("disabled",this.limit.right),this.picker.find(".title").css("cursor",this.allowZoomOut()?"pointer":"default"),this.working_date=i,this.options.useFadeInOut&&this.picker.fadeIn(this.options.animationDuration),e&&this.fx(e)},fx:function(e){"right"==e?(this.oldContents.css("left",0).show(),this.newContents.css("left",this.bodyWidth).show(),this.slider.css("left",0).animate({left:-this.bodyWidth})):"left"==e?(this.oldContents.css("left",this.bodyWidth).show(),this.newContents.css("left",0).show(),this.slider.css("left",-this.bodyWidth).animate({left:0})):"fade"==e&&(this.slider.css("left",0),this.oldContents.css("left",0).fadeOut(this.options.animationDuration>>1),this.newContents.css("left",0).hide().fadeIn(this.options.animationDuration))},constructPicker:function(){var t,i,n;e(document.body).append(this.picker=e('<div class="'+this.options.pickerClass+'" />')),this.options.useFadeInOut&&this.picker.hide(),this.picker.append(t=e('<div class="header"/>')),t.append(i=e('<div class="title"/>').click(e.proxy(this.zoomOut,this))),t.append(e('<div class="previous">&larr;</div>').click(e.proxy(this.previous,this))),t.append(e('<div class="next">&rarr;</div>').click(e.proxy(this.next,this))),t.append(e('<div class="closeButton">x</div>').click(e.proxy(this.close,this))),i.append(e('<span class="titleText"/>')),this.picker.append(n=e('<div class="body"/>')),this.bodyHeight=n.outerHeight(),this.bodyWidth=n.outerWidth(),n.append(this.slider=e('<div style="position:absolute;top:0;left:0;width:'+2*this.bodyWidth+"px;height:"+2*this.bodyHeight+'px" />')),this.slider.append(this.oldContents=e('<div style="position:absolute;top:0;left:'+this.bodyWidth+"px;width:"+this.bodyWidth+"px;height:"+this.bodyHeight+'px" />')),this.slider.append(this.newContents=e('<div style="position:absolute;top:0;left:0;width:'+this.bodyWidth+"px;height:"+this.bodyHeight+'px" />'))},renderDecades:function(){for(;this.working_date.getFullYear()%this.options.yearsPerPage>0;)this.working_date.setFullYear(this.working_date.getFullYear()-1);this.renderTitle(this.working_date.getFullYear()+"-"+(this.working_date.getFullYear()+this.options.yearsPerPage-1));var t,i,n,o,r=!1;for(this.newContents.append(o=e('<div class="years"/>')),this.options.minDate&&this.working_date.getFullYear()<=this.options.minDate.getFullYear()&&(this.limit.left=!0),t=0;t<this.options.yearsPerPage;t++)i=this.working_date.getFullYear(),o.append(n=e('<div class="year year'+t+(i==this.today.getFullYear()?" today":"")+(i==this.choice.year?" selected":"")+'">'+i+"</>")),this.limited("year")?(n.addClass("unavailable"),r?this.limit.right=!0:this.limit.left=!0):(r=!0,n.click({year:i},e.proxy(function(e){this.working_date.setFullYear(e.data.year),this.mode="year",this.render("fade")},this))),this.working_date.setFullYear(this.working_date.getFullYear()+1);(!r||this.options.maxDate&&this.working_date.getFullYear()>=this.options.maxDate.getFullYear())&&(this.limit.right=!0)},renderYear:function(){var t,i,n,o=this.today.getMonth(),r=this.working_date.getFullYear()==this.today.getFullYear(),a=this.working_date.getFullYear()==this.choice.year,s=!1;for(this.renderTitle(this.working_date.getFullYear()),this.working_date.setMonth(0),this.newContents.append(t=e('<div class="months"/>')),i=0;i<=11;i++)t.append(n=e('<div class="month month'+(i+1)+(i==o&&r?" today":"")+(i==this.choice.month&&a?" selected":"")+'">'+(this.options.monthShort?this.options.months[i].substring(0,this.options.monthShort):this.options.months[i])+"</div>")),this.limited("month")?(n.addClass("unavailable"),s?this.limit.right=!0:this.limit.left=!0):(s=!0,n.click({month:i},e.proxy(function(e){this.working_date.setDate(1),this.working_date.setMonth(e.data.month),this.mode="month",this.render("fade")},this))),this.working_date.setMonth(i);s||(this.limit.right=!0)},renderTime:function(){var t;this.newContents.append(t=e('<div class="time"/>')),this.options.timePickerOnly?this.renderTitle("Select a time"):this.renderTitle(this.format(this.working_date,"j M, Y")),t.append(e('<input type="text" class="hour"'+(this.options.militaryTime?' style="left:30px"':"")+' maxlength="2" value="'+this.leadZero(this.options.militaryTime?this.working_date.getHours():this.working_date.getHours()>12?this.working_date.getHours()-12:this.working_date.getHours())+'"/>').mousewheel(e.proxy(function(t,i,n,o){t.preventDefault(),t.stopPropagation();var r=e(t.target),a=parseInt(r.val(),10);if(r.focus(),this.options.militaryTime)o>0?a=a<23?a+1:0:o<0&&(a=a>0?a-1:23);else{var s=this.picker.find(".ampm");o>0?11==a?(a=12,s.val("AM"==s.val()?"PM":"AM")):a<12?a++:a=1:o<0&&(12==a?(a=11,s.val("AM"==s.val()?"PM":"AM")):a>1?a--:a=12)}r.val(this.leadZero(a))},this))),t.append(e('<input type="text" class="minutes"'+(this.options.militaryTime?' style="left:110px"':"")+' maxlength="2" value="'+this.leadZero(this.working_date.getMinutes())+'"/>').mousewheel(e.proxy(function(t,i,n,o){t.preventDefault(),t.stopPropagation();var r=e(t.target),a=parseInt(r.val(),10);r.focus(),o>0?a=a<59?a+1:0:o<0&&(a=a>0?a-1:59),r.val(this.leadZero(a))},this))),t.append(e('<div class="separator"'+(this.options.militaryTime?' style="left:91px"':"")+">:</div>")),this.options.militaryTime||t.append(e('<input type="text" class="ampm" maxlength="2" value="'+(this.working_date.getHours()>=12?"PM":"AM")+'"/>').mousewheel(e.proxy(function(t,i,n,o){t.preventDefault(),t.stopPropagation();var r=e(t.target);r.focus(),(o>0||o<0)&&r.val("AM"==r.val()?"PM":"AM")}))),t.append(e('<input type="submit" value="OK" class="ok"/>').click(e.proxy(function(t){t.stopPropagation();var i=parseInt(this.picker.find(".hour").val(),10);this.options.militaryTime||(i=12===i?0:i),this.select(e.extend(this.dateToObject(this.working_date),{hours:i+(this.options.militaryTime||"PM"!=this.picker.find(".ampm").val()?0:12),minutes:parseInt(this.picker.find(".minutes").val(),10)}))},this)))},renderMonth:function(){var t,i,n,o,r,a=this.working_date.getMonth(),s=e('<div class="days"/>'),l=e('<div class="titles"/>'),d=!1,c=this.today.toDateString(),u=this.dateFromObject(this.choice).toDateString();for(this.renderTitle(this.options.months[a]+" "+this.working_date.getFullYear()),this.working_date.setDate(1);this.working_date.getDay()!=this.options.startDay;)this.working_date.setDate(this.working_date.getDate()-1);for(this.newContents.append(s.append(l)),t=this.options.startDay;t<this.options.startDay+7;t++)l.append(e('<div class="title day day'+t%7+'">'+this.options.days[t%7].substring(0,this.options.dayShort)+"</div>"));for(i=0;i<42;i++)n=["day","day"+this.working_date.getDay()],this.working_date.toDateString()==c&&n.push("today"),this.working_date.toDateString()==u&&n.push("selected"),this.working_date.getMonth()!=a&&n.push("otherMonth"),i%7==0&&s.append(r=e('<div class="week week'+Math.floor(i/7)+'"/>')),r.append(o=e('<div class="'+n.join(" ")+'">'+this.working_date.getDate()+"</div>")),this.limited("date")?(o.addClass("unavailable"),d?this.limit.right=!0:this.working_date.getMonth()==a&&(this.limit.left=!0)):(d=!0,o.click({day:this.working_date.getDate(),month:this.working_date.getMonth(),year:this.working_date.getFullYear()},e.proxy(function(e){this.options.timePicker?(this.working_date.setDate(e.data.day),this.working_date.setMonth(e.data.month),this.mode="time",this.render("fade")):this.select(e.data)},this))),this.working_date.setDate(this.working_date.getDate()+1);d||(this.limit.right=!0)},renderTitle:function(e){this.allowZoomOut()?this.picker.find(".title").removeClass("disabled"):this.picker.find(".title").addClass("disabled"),this.picker.find(".titleText").text(e)},limited:function(e){var t=!!this.options.minDate,i=!!this.options.maxDate;if(!t&&!i)return!1;switch(e){case"year":return t&&this.working_date.getFullYear()<this.options.minDate.getFullYear()||i&&this.working_date.getFullYear()>this.options.maxDate.getFullYear();case"month":var n=parseInt(""+this.working_date.getFullYear()+this.leadZero(this.working_date.getMonth()),10);return t&&n<parseInt(""+this.options.minDate.getFullYear()+this.leadZero(this.options.minDate.getMonth()),10)||i&&n>parseInt(""+this.options.maxDate.getFullYear()+this.leadZero(this.options.maxDate.getMonth()),10);case"date":return t&&this.working_date<this.options.minDate||i&&this.working_date>this.options.maxDate}},allowZoomOut:function(){return("time"!=this.mode||!this.options.timePickerOnly)&&("decades"!=this.mode&&!("year"==this.mode&&!this.options.yearPicker))},zoomOut:function(){if(this.allowZoomOut()){switch(this.mode){case"year":this.mode="decades";break;case"time":this.mode="month";break;default:this.mode="year"}this.render("fade")}},previous:function(){switch(this.mode){case"decades":this.working_date.setFullYear(this.working_date.getFullYear()-this.options.yearsPerPage);break;case"year":this.working_date.setFullYear(this.working_date.getFullYear()-1);break;case"month":this.working_date.setMonth(this.working_date.getMonth()-1)}"time"!=this.mode&&this.render("left")},next:function(){switch(this.mode){case"decades":this.working_date.setFullYear(this.working_date.getFullYear()+this.options.yearsPerPage);break;case"year":this.working_date.setFullYear(this.working_date.getFullYear()+1);break;case"month":this.working_date.setMonth(this.working_date.getMonth()+1)}"time"!=this.mode&&this.render("right")},close:function(t,i){this.picker&&!this.closing&&(i||t&&t.target!=this.picker&&0==this.picker.has(t.target).size()&&t.target!=this.visual)&&(this.element.blur(),this.options.useFadeInOut?(this.closing=!0,this.picker.fadeOut(this.options.animationDuration>>1,e.proxy(this.destroy,this))):this.destroy())},destroy:function(){this.picker.remove(),this.picker=null,this.closing=!1,e.isFunction(this.options.onClose)&&this.options.onClose()},select:function(t){this.working_date=this.dateFromObject(e.extend(this.choice,t)),this.input.val(this.format(this.working_date,this.options.inputOutputFormat)).change(),this.visual.val(this.format(this.working_date,this.options.format)),e.isFunction(this.options.onSelect)&&this.options.onSelect(this.working_date),this.close(null,!0)},formatMinMaxDates:function(){this.options.minDate&&this.options.minDate.format&&(this.options.minDate=this.unformat(this.options.minDate.date,this.options.minDate.format)),this.options.maxDate&&this.options.maxDate.format&&(this.options.maxDate=this.unformat(this.options.maxDate.date,this.options.maxDate.format),this.options.maxDate.setHours(23),this.options.maxDate.setMinutes(59),this.options.maxDate.setSeconds(59))},leadZero:function(e){return e<10?"0"+e:e},format:function(e,t){for(var i="",n=e.getHours(),o=e.getMonth(),r=0;r<t.length;r++)switch(t.charAt(r)){case"\\":r++,i+=t.charAt(r);break;case"y":i+=(100+e.getYear()+"").substring(1);break;case"Y":i+=e.getFullYear();break;case"m":i+=this.leadZero(o+1);break;case"n":i+=o+1;break;case"M":i+=this.options.months[o].substring(0,this.options.monthShort);break;case"F":i+=this.options.months[o];break;case"d":i+=this.leadZero(e.getDate());break;case"j":i+=e.getDate();break;case"D":i+=this.options.days[e.getDay()].substring(0,this.options.dayShort);break;case"l":i+=this.options.days[e.getDay()];break;case"G":i+=n;break;case"H":i+=this.leadZero(n);break;case"g":i+=n%12?n%12:12;break;case"h":i+=this.leadZero(n%12?n%12:12);break;case"a":i+=n>11?"pm":"am";break;case"A":i+=n>11?"PM":"AM";break;case"i":i+=this.leadZero(e.getMinutes());break;case"s":i+=this.leadZero(e.getSeconds());break;case"U":i+=Math.floor(e.valueOf()/1e3);break;default:i+=t.charAt(r)}return i},unformat:function(e,t){var i,n,o,a=new Date,s={};e=e.toString();for(var l=0;l<t.length;l++){switch(i=t.charAt(l)){case"\\":r=null,l++;break;case"y":r="[0-9]{2}";break;case"Y":r="[0-9]{4}";break;case"m":r="0[1-9]|1[012]";break;case"n":r="[1-9]|1[012]";break;case"M":r="[A-Za-z]{"+this.options.monthShort+"}";break;case"F":r="[A-Za-z]+";break;case"d":r="0[1-9]|[12][0-9]|3[01]";break;case"j":r="[1-9]|[12][0-9]|3[01]";break;case"D":r="[A-Za-z]{"+this.options.dayShort+"}";break;case"l":r="[A-Za-z]+";break;case"G":case"H":case"g":case"h":r="[0-9]{1,2}";break;case"a":r="(am|pm)";break;case"A":r="(AM|PM)";break;case"i":case"s":r="[012345][0-9]";break;case"U":r="-?[0-9]+$";break;default:r=null}if(r){if(!(n=e.match("^"+r)))return this.options.debug&&alert("Fatal Error in will_pickdate\n\nUnexpected format at: '"+e+"' expected format character '"+i+"' (pattern '"+r+"')"),a;s[i]=n[0],e=e.substring(s[i].length)}else e=e.substring(1)}for(i in s)switch(o=s[i],i){case"y":a.setFullYear(o<30?2e3+parseInt(o,10):1900+parseInt(o,10));break;case"Y":a.setFullYear(o);break;case"m":case"n":a.setMonth(o-1);break;case"M":o=this.options.months.filter(function(e){return this.substring(0,this.options.monthShort)==o})[0];case"F":a.setMonth(options.months.indexOf(o));break;case"d":case"j":a.setDate(o);break;case"G":case"H":a.setHours(o);break;case"g":case"h":"pm"==s.a||"PM"==s.A?a.setHours(12==o?0:parseInt(o,10)+12):a.setHours(o);break;case"i":a.setMinutes(o);break;case"s":a.setSeconds(o);break;case"U":a=new Date(1e3*parseInt(o,10))}return a}}}(jQuery),function(e){var t=e.makeArray,i=e.isArray,n=e.isFunction,o=e.extend,r=e.String,a=e.each,s="prototype",l="constructor",d=Array[s].slice,c=function(t,i,o,r){return r?(p=r,m=i,h=o,(f=(u=t).delegate&&u.undelegate?u:e(n(u)?[u]:u)).delegate(p,m,h),function(){f.undelegate(p,m,h),f=u=m=h=p=null}):(s=i,l=o,c=(a=t).bind&&a.unbind?a:e(n(a)?[a]:a),0===s.indexOf(">")&&(s=s.substr(1),d=function(e){e.target===a&&l.apply(this,arguments)}),c.bind(s,d||l),function(){c.unbind(s,d||l),a=s=l=d=null});var a,s,l,d,c,u,p,m,h,f},u=function(t,i){var n="string"==typeof i?t[i]:i;return function(){return t.called=i,n.apply(t,[this.nodeName?e(this):this].concat(d.call(arguments,0)))}},p=/\./g,m=/_?controllers?/gi,h=function(e){return r.underscore(e.replace("jQuery.","").replace(p,"_").replace(m,""))},f=/[^\w]/,g=/\{([^\}]+)\}/g,b=/^(?:(.*?)\s)?([\w\.\:>]+)$/,v=function(t,i){return e.data(t,"controllers",i)};e.Class("jQuery.Controller",{setup:function(){if(this._super.apply(this,arguments),this.shortName&&"jQuery.Controller"!=this.fullName){this._fullName=h(this.fullName),this._shortName=h(this.shortName);var i,o=this,r=this.pluginName||this._fullName;for(i in e.fn[r]||(e.fn[r]=function(e){var i=t(arguments),a="string"==typeof e&&n(o[s][e]),l=i[0];return this.each(function(){var e=v(this),t=e&&e[r];t?a?t[l].apply(t,i.slice(1)):t.update.apply(t,i):o.newInstance.apply(o,[this].concat(i))})}),this.actions={},this[s])"constructor"!=i&&n(this[s][i])&&this._isAction(i)&&(this.actions[i]=this._action(i))}},hookup:function(e){return new this(e)},_isAction:function(t){return!!f.test(t)||(e.inArray(t,this.listensTo)>-1||e.event.special[t]||y[t])},_action:function(e,t){if(g.lastIndex=0,!t&&g.test(e))return null;var n=t?r.sub(e,[t,window]):e,o=i(n),a=(o?n[1]:n).match(b),s=a[2];return{processor:y[s]||x,parts:a,delegate:o?n[0]:void 0}},processors:{},listensTo:[],defaults:{}},{setup:function(t,i){var n=this[l];t=t.jquery?t[0]:t;var r=n.pluginName||n._fullName;return this.element=e(t).addClass(r),(v(t)||v(t,{}))[r]=this,this.options=o(o(!0,{},n.defaults),i),this.called="init",this.bind(),this.element},bind:function(t,i,n){if(void 0===t){this._bindings=[];var o=this[l],r=this._bindings,a=o.actions,s=this.element;for(funcName in a)a.hasOwnProperty(funcName)&&(ready=a[funcName]||o._action(funcName,this.options),r.push(ready.processor(ready.delegate||s,ready.parts[2],ready.parts[1],funcName,this)));var d=u(this,"destroy");return s.bind("destroyed",d),r.push(function(t){e(t).unbind("destroyed",d)}),r.length}return"string"==typeof t&&(n=i,i=t,t=this.element),this._binder(t,i,n)},_binder:function(e,t,i,n){return"string"==typeof i&&(i=u(this,i)),this._bindings.push(c(e,t,i,n)),this._bindings.length},_unbind:function(){var e=this.element[0];a(this._bindings,function(t,i){i(e)}),this._bindings=[]},delegate:function(e,t,i,n){return"string"==typeof e&&(n=i,i=t,t=e,e=this.element),this._binder(e,i,n,t)},update:function(e){o(this.options,e),this._unbind(),this.bind()},destroy:function(){if(this._destroyed)throw this[l].shortName+" controller already deleted";var t=this[l].pluginName||this[l]._fullName;this._destroyed=!0,this.element.removeClass(t),this._unbind(),delete this._actions,delete this.element.data("controllers")[t],e(this).triggerHandler("destroyed"),this.element=null},find:function(e){return this.element.find(e)},_set_called:!0});var y=e.Controller.processors,x=function(e,t,i,n,o){return c(e,t,u(o,n),i)};a("change click contextmenu dblclick keydown keyup keypress mousedown mousemove mouseout mouseover mouseup reset resize scroll select submit focusin focusout mouseenter mouseleave".split(" "),function(e,t){y[t]=x});var z,C=function(e,t){for(z=0;z<t.length;z++)if("string"==typeof t[z]?e[l]._shortName==t[z]:e instanceof t[z])return!0;return!1};e.fn.extend({controllers:function(){var i,n,o,r=t(arguments),a=[];return this.each(function(){for(o in i=e.data(this,"controllers"))i.hasOwnProperty(o)&&(n=i[o],r.length&&!C(n,r)||a.push(n))}),a},controller:function(e){return this.controllers.apply(this,arguments)[0]}})}(jQuery),String.prototype.hashCode=function(){var e,t,i=0;if(0===this.length)return i;for(e=0,t=this.length;e<t;e++)i=(i<<5)-i+this.charCodeAt(e),i|=0;return i},Array.prototype.move=function(e,t){var i,n;if((e=parseInt(e,10))!==(t=parseInt(t,10))&&0<=e&&e<=this.length&&0<=t&&t<=this.length){if(n=this[e],e<t)for(i=e;i<t;i++)this[i]=this[i+1];else for(i=e;i>t;i--)this[i]=this[i-1];this[t]=n}},$.Class.extend("bizagi.editor.utilities",{resolveResource:function(e){var t=bizagi.localization.getResource(e);return t===e&&(t=void 0),t},buildComplexReference:function(e,t){var i={},n={};return"string"==typeof e?(n.ref=e,i.baref=n,t&&(i.displayName=t),i):e},resolveComplexReference:function(e){return bizagi.editor.utilities.isObject(e)?e.baref.ref:e},buildComplexXpath:function(e,t,i,n){var o={},r={};return"object"==typeof e&&e.xpath&&e.xpath.baxpath?e:"string"==typeof e&&e.length>0?(r.xpath=e,bizagi.editor.utilities.isGuidEmpty(t)||("true"===i?r.scopedefinition=t:r.contextentity=t),o.baxpath=r,n=void 0!==n&&"00000000-0000-0000-0000-000000000000"!=n?n:void 0,{xpath:o,relatedentity:bizagi.editor.utilities.buildComplexReference(n)}):void 0},resolveComplexXpath:function(e){return bizagi.editor.utilities.isObject(e)?e.xpath.baxpath.xpath:e},resolveContextEntityFromXpath:function(e){if(bizagi.editor.utilities.isObject(e))return e.xpath.baxpath.contextentity},resolveScopeContextFromXpath:function(e){if(bizagi.editor.utilities.isObject(e))return e.xpath.baxpath.scopedefinition},resolveRelatedEntityFromXpath:function(e){return bizagi.editor.utilities.isObject(e)&&e.relatedentity?e.relatedentity.baref.ref:null},getXpathObject:function(e){if(!e)return e;if(bizagi.editor.utilities.isObject(e))return e.xpath;if("string"==typeof e&&e.indexOf("<design")>-1)return null;throw"xpath parameter must be a complex xpath object"},buildComplexFilter:function(e,t){var i={filter:e};return"true"===t.isScopeAttribute?(i.scopedefinition=t.contextScope,i.contextentity=t.guidRelatedEntity):i.contextentity=t.guidRelatedEntity,i.globalcontextentity=t.contextScope,{bafilter:i}},resolvefilterExpression:function(e){if(bizagi.editor.utilities.isObject(e)){if(e.rule&&e.rule.displayName)return e.rule.displayName;if(e.rule)return e.rule.baref.ref;if(e.bafilter)return e.bafilter.filter}return e},resolveProperty:function(e,t){for(var i=t.split("."),n=e,o=0;o<i.length;o++)if(void 0===(n=n[i[o]]))return;return n},assignProperty:function(e,t,i,n){var o=t.split("."),r=e,a=o[0];if(!n||(r[a]=void 0,void 0!==i)){if(o.length>1)for(var s=0;s<o.length-1;s++)bizagi.util.isEmpty(r[a])&&(r[a]={}),r=r[a],a=o[s+1];r[a]=i}},objectEquals:function(e,t){if(typeof e!=typeof t)return!1;if("function"==typeof e)return e.toString()===t.toString();if(e instanceof Object&&t instanceof Object){if(bizagi.editor.utilities.countProps(e)!==bizagi.editor.utilities.countProps(t))return!1;for(k in e)if(!bizagi.editor.utilities.objectEquals(e[k],t[k]))return!1;return!0}return e===t},countProps:function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&t++;return t},buildComplexLocalizable:function(e,t,i){var n={},o={};return"string"==typeof e?(o.languages={},o.default=e,o.uri=t+":"+i,n.i18n=o,n):e},resolveComplexLocalizable:function(e){return"object"==typeof e?e.i18n.default:e},resolveInternalResource:function(e){if(!e)return"";if("string"==typeof e)return e;var t=bizagi.language.split("-").shift();return function(e){var i=!1;if($.isArray(e)&&e.length>0&&t.length>0)for(var n=0,o=e.length;n<o;n+=1)if(e[n][t]){i=e[n][t];break}return i}(e.languages)||e.default},resolvei18n:function(e){var t=bizagi.editorLanguage.key;if("string"==typeof e)return e;if(t&&"default"!=t){var i=e.i18n.languages&&e.i18n.languages[t];if(i)return i}return e.i18n.default},isObject:function(e){return null!=e&&"object"==typeof e},isBoolean:function(e){return null!=e&&(!0===e||"true"===e.toString().toLowerCase()||(!1===e||"false"===e.toString().toLowerCase()))},isGuidEmpty:function(e){return!e||"00000000-0000-0000-0000-000000000000"===e},getGuidEmpty:function(){return"00000000-0000-0000-0000-000000000000"},getXPathByDisplayName:function(e){return e.replace(/[\W^_]/gi,"")},normalizeString:function(e){return e.replace(/[^a-zA-Z]/g,"")},camelCase:function(e){return e.toLowerCase().replace(/\s+(.)/g,function(e,t){return t.toUpperCase()})}},{}),$.Class.extend("bizagi.editor.observableClass",{},{init:function(){this.observableElement=$({})},subscribe:function(){this.observableElement.bind.apply(this.observableElement,arguments)},unsubscribe:function(){this.observableElement.unbind.apply(this.observableElement,arguments)},publish:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)}}),$.Controller.extend("bizagi.editor.observableController",{},{init:function(){this.observableElement=$({})},subscribe:function(){this.observableElement.bind.apply(this.observableElement,arguments)},unsubscribe:function(){this.observableElement.unbind.apply(this.observableElement,arguments)},publish:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)}}),$.Controller("bizagi.editor.component.controller",{init:function(){this.observableElement=$({}),this.tmpl={}},subscribe:function(){this.observableElement.bind.apply(this.observableElement,arguments)},unsubscribe:function(){this.observableElement.unbind.apply(this.observableElement,arguments)},publish:function(){this.observableElement.triggerHandler.apply(this.observableElement,arguments)},loadTemplate:function(e,t){var i=this,n=new $.Deferred;return i.tmpl[e]?(n.resolve(),n.promise()):bizagi.templateService.getTemplate(t).done(function(t){i.tmpl[e]=t})},loadTemplates:function(e){var t=this,i=new $.Deferred,n=[];return $.each(e,function(e,i){var o=t.loadTemplate(e,i);n.push(o)}),$.when.apply($,n).done(function(){i.resolve()}),i.promise()},getTemplate:function(e){return this.tmpl[e]?this.tmpl[e]:null}}),bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.elementValidations={validRequiredProperties:function(){var e=this,t=!0;return e.formValidations=[],e.messageValidation="",e.isVisible()?(e.requiredProperties&&$.each(e.requiredProperties,function(i,n){if(e.requiredProperties[i]&&!e.propertyValueIsValid(i)){var o=bizagi.localization.getResource("formmodeler-editor-contextmenu-caption-property-required").replace("{0}",e.propertyModel.getCaption(i));e.messageValidation+=o+"</br>",e.formValidations.push({name:i,message:[o]}),t=!1}}),t):t},validRequiredDependentProperties:function(){var e=this,t=!0;return e.formValidations=e.formValidations||[],e.messageValidation=e.messageValidation||"",e.isVisible()?(e.requiredDependentProperties&&$.each(e.requiredDependentProperties,function(i,n){if(e.matchValue(n)&&(void 0===e.resolveProperty(i)||null===e.resolveProperty(i))){var o=bizagi.localization.getResource("formmodeler-editor-contextmenu-caption-property-required").replace("{0}",e.propertyModel.getCaption(i));e.messageValidation+=o+"</br>",e.formValidations.push({name:i,message:[o]}),t=!1}}),t):t},validSameXpath:function(e){var t=bizagi.localization.getResource("bizagi-editor-form-validation-samexpath");t="string"==typeof t?t.replace("{0}",e):"",this.messageValidation=this.messageValidation||"",this.messageValidation+=t+"</br>"},validSameXpathAdhoc:function(e){var t=bizagi.localization.getResource("bizagi-editor-form-validation-samexpath-adhoc");t="string"==typeof t?t.replace("{0}",e):"",this.messageValidation=this.messageValidation||"",this.messageValidation+=t+"</br>"},validSameXpathDatasourceAdhoc:function(e){var t=bizagi.localization.getResource("bizagi-editor-form-validation-samexpath-adhoc-datasource");t="string"==typeof t?t.replace("{0}",e):"",this.messageValidation=this.messageValidation||"",this.messageValidation+=t+"</br>"},validAttributesAdministrables:function(e){var t=!0;if(this.isEditable()&&this.isParametricAttribute(e)){if(["searchlist","multiselect"].includes(this.type))return!0;var i="parameter"==this.triggerGlobalHandler("getContextEntityType")?bizagi.localization.getResource("bizagi-editor-form-validation-parameter-attribute-parameter-entity"):bizagi.localization.getResource("bizagi-editor-form-validation-parameter-attribute-entity");this.messageValidation=this.messageValidation||"",this.messageValidation+=i+"</br>",t=!1}return t},validLayoutPlaceholder:function(e){var t=!0;return this.isVisible()?("layoutPlaceholder"==this.type&&-1==$.inArray(this.guid,e)&&(this.messageValidation=this.messageValidation||"",this.messageValidation+=bizagi.localization.getResource("bizagi-editor-form-validation-layoutplaceholder")+"</br>",t=!1),t):t},validAttributesNoEditables:function(){return!0},validEntitiesNoEditables:function(){var e=this,t=new $.Deferred;return result=!0,e.isFormLink()&&e.isEditable()?$.when(e.isParameterEntity()).done(function(i){if(i){var n=bizagi.localization.getResource("bizagi-editor-form-validation-parameter-entity");e.messageValidation=e.messageValidation||"",e.messageValidation+=n+"</br>",t.resolve(!1)}else t.resolve(!0)}):t.resolve(!0),t.promise()},propertyValueIsValid:function(e){var t=this.resolveProperty(e);switch(e){case"xpathAdhoc":return!!t.xpath;case"displayName":return t&&(bizagi.editor.utilities.resolvei18n(t)||"").length>0;default:return!!t}},matchValue:function(e){var t=e.property,i=this.resolveProperty(t);return"adhoccombo"!==this.type&&"adhocsuggest"!==this.type&&"adhoccolumncombo"!==this.type||"datasource"!=t?!(!i||"anyValue"!=e.value)||null!=i&&i.toString()==e.value.toString():this.properties.data&&this.properties.data.datasource&&"bizagi"===this.properties.data.datasource.type}},bizagi.editor.observableClass.extend("bizagi.editor.base.element",{exclusiveProperty:/[^.]*/},$.extend({},bizagi.editor.base.elementValidations,{init:function(e,t,i){var n=this;this.elementFactory=t,this._super(),this.resourcesLoaded=new $.Deferred,this.properties=e&&e.properties?JSON.parse(JSON.encode(e.properties)):{},this.originalLoadedProperties=bizagi.clone(this.properties),this.channel=bizagi.editor.communicationprotocol.factory,this.cloneService=bizagi.editor.base.cloneService,this.catalogServices=bizagi.editor.base.catalogServices,this.utilities=bizagi.editor.utilities,this.pathCommonServices=BIZAGI_URL_REST_SERVICES+"api/common/",e&&e.guid?i?(this.oldGuid=e.guid,this.guid=Math.guid()):this.guid=e.guid:this.guid=Math.guid(),i=i||!1,setTimeout(function(){n.updateLocalizableProperties(i),n.resourcesLoaded.resolve()},0),n.propertyModel={},n.decoratorModel={},n.contextMenuModel={},n.convertToModel=[],n["widget-guid"]=null,n.messageValidation="",n.defaultDisplayName={},n.channel=bizagi.editor.communicationprotocol.factory},ready:function(){return this.resourcesLoaded.promise()},setParent:function(e){this.parent=e,this.subscribe("refresh",function(){e.publish("refresh")})},getParent:function(){return this.parent},getProperties:function(){return this.properties},getOriginalLoadedProperties:function(){return this.originalLoadedProperties},getPreviewOfflineRenderingModel:function(){var e=this,t=$.Deferred(),i=["nestedform","startform","horizontal","panel","smartphonehorizontal","tablethorizontal","smartphonepanel","tabletpanel"];return $.when(e.ready()).pipe(function(){return e.getRenderingProperties()}).done(function(n){var o="offline"+e.type;i.includes(e.type)||e.elementFactory.canMapToOffline(o)?(n=n||{},t.resolve({properties:bizagi.clone(n)})):t.resolve(!1)}),t.promise()},getMissingOfflineControls:function(e){var t=this,i=$.Deferred(),n=["nestedform","startform"];return $.when(t.ready()).pipe(function(){return t.getRenderingProperties()}).done(function(o){o=o||{};var r="offline"+t.type;if(t.elementFactory.canMapToOffline(r)||n.includes(t.type))i.resolve(!1);else{var a=t.display||o.type;e.push(o.displayName||a),i.resolve(!0)}}),i.promise()},getRenderingModel:function(){var e=this,t=$.Deferred();return $.when(e.ready()).pipe(function(){return e.getRenderingProperties()}).done(function(e){e=e||{},t.resolve({properties:bizagi.clone(e)})}),t.promise()},getRibbonProperties:function(){return[]},getRenderingProperties:function(){var e={};return e.guid=this.guid,e.id=this.guid,e.messageValidation=this.messageValidation,e},getPropertiesModel:function(){return this.propertyModel?this.propertyModel.process(this):{}},getIndexedProperties:function(){return this.propertyModel&&this.propertyModel.indexedProperties||{}},getPropertiesExternal:function(){return this.propertyModel&&this.propertyModel.externalProperties?this.propertyModel.externalProperties:{}},getPersistenceModel:function(){var e={type:this.type,guid:this.guid,properties:this.removeLocalization(this.filterDefaultValues(this.properties))};return this["widget-guid"]&&(e["widget-guid"]=bizagi.editor.utilities.buildComplexReference(this["widget-guid"])),e},updateSubmitVersionProperty:function(){this.isSearch()&&this.assignProperty("submitversion",2)},getContentResourceObject:function(e,t){var i,n=[];for(i in e.languages)n.push({code:i,value:e.languages[i]});return{category:"bizagiObjects.form",uri:e.uri,field:t,languages:n,defaultValue:e.default}},getChangesetResourceObject:function(e,t,i){var n=this.triggerGlobalHandler("getResourceByUri",e),o="object"==typeof n&&null!==n?n.id:Math.guid(),r=this.getContentResourceObject(e,t);return{action:"merge",deployOnParent:!0,id:o,name:"Resources_"+o,type:"Resource",parentId:i,content:JSON.stringify(r),modifiedByUser:BIZAGI_USER}},getPropertiesLocalizables:function(){var e=this.propertyModel.indexedProperties,t=[];for(var i in e)this.isLocalizableProperty(i)&&t.push(i);return(e=this.getLocalizableProperties()||[]).forEach(function(e){t.indexOf(e)<0&&t.push(e)}),t},getLocalizablePropertiesModel:function(e){var t=this,i=[];return t.getPropertiesLocalizables().forEach(function(n){var o=t.resolveProperty(n);if(o&&"object"==typeof o){var r=o.i18n;"object"==typeof r&&i.push(t.getChangesetResourceObject(r,n,e))}}),i},getGridColumnModel:function(){var e=this,t=$.Deferred(),i=e.getPersistenceModel();return $.when(e.resolveDisplayNameProperty()).done(function(n){e.resolveProperty("displayName")?i.properties.displayName=e.resolveProperty("displayName"):i.properties.displayName=n,t.resolve(i)}),t.promise()},getContextMenuModel:function(){var e=this.contextMenuModel,t=e.getProperties();for(var i in t)e.assignProperty(i,this.resolveProperty(i));return e},getConvertToModel:function(){return bizagi.clone(this.convertToModel)},resolveType:function(e){return this.Class.renderTypeMapping[e]?this.Class.renderTypeMapping[e]:e},getDecoratorModel:function(){return this.decoratorModel},getExclusiveProperty:function(e){if(e)return this.Class.exclusiveProperty.exec(e)[0]},removeLocalization:function(e){var t=this;return t.getPropertiesLocalizables().forEach(function(i){var n=bizagi.editor.utilities.resolveProperty(e,i);if(n&&n.i18n&&n.i18n.uri){var o={i18n:{uri:n.i18n.uri}};t.isForm()&&"displayName"==i&&(o.i18n.default=n.i18n.default),bizagi.editor.utilities.assignProperty(e,i,o)}else bizagi.editor.utilities.assignProperty(e,i,void 0)}),e},filterDefaultValues:function(){var e=this,t=bizagi.clone(e.properties);return e.defaultValues&&$.each(e.defaultValues,function(i,n){var o=e.resolveProperty(i);bizagi.editor.utilities.isBoolean(o)&&(o=bizagi.util.parseBoolean(o),n=bizagi.util.parseBoolean(n)),bizagi.editor.utilities.objectEquals(o,n)&&bizagi.editor.utilities.assignProperty(t,i,void 0)}),t},getControlType:function(){},getGuid:function(){return this.guid},getXpath:function(){var e=this.properties;return e&&e.xpath?bizagi.editor.utilities.resolveComplexXpath(e.xpath):null},getXpathAdhoc:function(){var e=this.properties;return e&&e.xpathAdhoc?e.xpathAdhoc.xpath:null},getFilter:function(){return bizagi.editor.utilities.resolvefilterExpression(this.resolveProperty("data.filter"))||""},getDisplayName:function(){var e=this.properties;return bizagi.editor.utilities.resolvei18n(e.displayName)},assignDefaultProperty:function(e,t){void 0!==this.resolveProperty(e)&&null!==this.resolveProperty(e)||this.assignProperty(e,t)},assignProperty:function(e,t,i){bizagi.editor.utilities.assignProperty(this.properties,e,t,i),"xpath"===e&&(t||this.removeDefaultDisplayName(),this.xpathProperties.length>0&&this.cleanXpathProperties())},propertiesOverrides:function(e){$.extend(this.properties,e)},requiredPropertiesOverrides:function(e){var t=this.getIndexedProperties();for(var i in $.extend(this.requiredProperties,e),e){if(e.hasOwnProperty(i))(t[i]||{}).required=e[i]}},setProperty:function(e,t){this.assignProperty(e,t)},resolveProperty:function(e){return bizagi.editor.utilities.resolveProperty(this.properties,e)},resolveDisplayNameProperty:function(){var e=this,t=new $.Deferred;return e.asyncProperties=e.asyncProperties||[],e.resolveProperty("displayName")?e.resolveI18nProperty("displayName"):e.defaultDisplayName&&e.defaultDisplayName[bizagi.editorLanguage.key]?e.defaultDisplayName[bizagi.editorLanguage.key]:(e.asyncProperties.push($.when(e.triggerGlobalHandler("getDefaultDisplayName",{element:e})).pipe(function(i){i?"string"==typeof i?(e.defaultDisplayName=e.defaultDisplayName||{},e.defaultDisplayName.default=i,t.resolve(i)):(e.defaultDisplayName=e.defaultDisplayName||{},e.defaultDisplayName=i,t.resolve(i.displayName)):t.resolve("")})),t.promise())},getProperty:function(e){return this.resolveProperty(e)},getFormatProperties:function(){var e,t,i=[],n=["displaytype","labelalign","valuealign","layout.labelwidth","layout.layouttype","orientation","format","formatvalue","layout.valuewidth"];for(e=0;e<n.length;e++)t={property:n[e],value:this.resolveProperty(n[e])},i.push(t);return i},resolveFixedValueProperty:function(e){var t=this.resolveProperty(e);return void 0===t||void 0===t.fixedvalue||t.fixedvalue},resolveI18nProperty:function(e){var t=this.resolveProperty(e),i=t;return t&&t.i18n&&(i="default"===bizagi.editorLanguage.key?t.i18n.default:t.i18n.languages&&t.i18n.languages[bizagi.editorLanguage.key]||t.i18n.default),i},resolveIsRightToLeftProperty:function(){return this.isDefaultValueinHierarchicalChain(this,"orientation")||(bizagi.editorLanguage&&bizagi.util.parseBoolean(bizagi.editorLanguage.IsRightToLeft)?"rtl":"ltr")},isDefaultValueinHierarchicalChain:function(e,t){var i=!1;return e&&"function"==typeof e.getDefaultValueProperty?i=e.getDefaultValueProperty(t)===e.getProperty(t)?this.isDefaultValueinHierarchicalChain(e.getParent(),t):e.getProperty(t):i},getDefaultValueProperty:function(e){var t=this.properties.xpath;return t?(t=bizagi.editor.utilities.resolveComplexXpath(t),this.defaultValues[e]||this.triggerGlobalHandler("getNodeInfo",{property:e,xpath:t,callback:function(t){return"maxlength"===e?t.getMaxLength():null}})):this.defaultValues[e]},getDefaultLocalizableProperty:function(e){return"displayName"===e?this.defaultDisplayName.default:""},hasDesignValue:function(e){return this.designValueProperties[e]||!1},isVisualProperty:function(e){return("label"!=this.normalizeType(this.type)||"xpath"!=e)&&(this.propertyModel.indexedProperties&&this.propertyModel.indexedProperties[e]||!1)},isLocalizableProperty:function(e){var t=this.propertyModel.indexedProperties[e];return!(!t||!t["bas-type"])&&("localizable-string"===t["bas-type"]||"localizablestring"===t["bas-type"])},isInternal:function(){return!1},isRequiredProperty:function(e){if(!this.requiredProperties)return!1;for(var t=e.split("."),i=t[0],n=0;n<t.length;n++){if(this.requiredProperties[i])return!0;t[n+1]&&(i=i+"."+t[n+1])}return!1},isDependentProperty:function(e){if(!this.requiredDependentProperties)return!1;for(var t in this.requiredDependentProperties)if(this.requiredDependentProperties[t].property===e||t===e)return!0;return!1},isEditable:function(){var e=this;function t(){return!1!==e.resolveProperty("editable.fixedvalue")&&"false"!==e.resolveProperty("editable.fixedvalue")}return null!=e.parent?e.parent.isEditable()&&t():t()},isParametricAttribute:function(e){e=e||"",e+=bizagi.editor.utilities.resolveComplexXpath(this.properties.xpath);var t=this.triggerGlobalHandler("getNodeInfo",{xpath:e});return!!t&&(t.parentIsParametricEntity()&&-1==$.inArray(t.renderType,["cascadingcombo","combo","suggest"]))},isParameterEntity:function(){var e=new $.Deferred,t=this.resolveProperty("xpath");if(bizagi.editor.utilities.isObject(t)){var i=bizagi.editor.utilities.resolveRelatedEntityFromXpath(t);if("string"==typeof i){var n=this.channel.createProtocol({protocol:"getentitytype",entityGuid:i});$.when(n.processRequest()).done(function(t){var i="Parameter"===t.entityType||"Enum"===t.entityType;e.resolve(i)})}else e.resolve(!1)}else e.resolve(!1);return e.promise()},isText:function(){return"text"===this.type||"columntext"===this.type||"offlinetext"===this.type||"smartphonetext"===this.type||"smartphonecolumntext"===this.type||"tablettext"===this.type||"tabletcolumntext"===this.type},isHidden:function(){return"hidden"===this.type||"columnhidden"===this.type||"offlinehidden"===this.type||"smartphonehidden"===this.type||"smartphonecolumnhidden"===this.type||"tablethidden"===this.type||"tabletcolumnhidden"===this.type},isGrid:function(){return"grid"===this.type||"adhocgrid"===this.type||"groupedgrid"===this.type||"offlinegrid"===this.type||"smartphonegrid"===this.type||"tabletgrid"===this.type},isFormLink:function(){return"formlink"===this.type||"columnformlink"===this.type},isSearch:function(){return"search"==this.type||"columnsearch"==this.type||"smartphonesearch"==this.type||"smartphonecolumnsearch"==this.type||"tabletsearch"==this.type||"tabletcolumnsearch"==this.type},isForm:function(){return"form"===this.type||"queryform"===this.type||"searchform"===this.type||"offlineform"===this.type||"startform"===this.type||"template"===this.type},restoreDefaultDisplayName:function(){this.properties.displayName&&"string"==typeof this.properties.displayName&&this.assignProperty("displayName",void 0)},removeDefaultDisplayName:function(){this.defaultDisplayName={}},getFormValidations:function(){return this.formValidations},getFormParent:function(){return this.parent.getFormParent()},getValidations:function(){return this.validations},removeValidations:function(){this.messageValidation="",this.propertyModel.model.validations=void 0},triggerGlobalHandler:function(e,t){return this.parent?this.parent.triggerGlobalHandler(e,t):null},cleanXpathProperties:function(){var e=this,t=e.defaultValues||{};$.each(e.xpathProperties,function(i,n){bizagi.editor.utilities.assignProperty(e.properties,n,t[n])})},isContainedInNestedForm:function(){return!!this.parent&&("nestedform"===this.parent.type?this.parent.getXpath()||!0:this.parent.isContainedInNestedForm())},getXpathNestedForm:function(){return!!this.parent&&("nestedform"===this.parent.type?this.parent.properties.xpath:this.parent.getXpathNestedForm())},getNestedFormContainer:function(){return!!this.parent&&("nestedform"===this.parent.type?this.parent:this.parent.getNestedFormContainer())},getHierarchicalXpathNestedForm:function(e){var t;return e=e||"",this.parent?("nestedform"===this.parent.type&&(t=this.parent.getXpath()||"").length>0&&(e=e.length>0?t+"."+e:t),this.parent.getHierarchicalXpathNestedForm(e)):e},updateLocalizableProperties:function(e){var t=this;t.getPropertiesLocalizables().forEach(function(i){var n=t.resolveProperty(i);if("object"==typeof n&&"object"==typeof n.i18n){var o=n.i18n;if(t.isContainedInNestedForm())o=t.getNestedFormContainer().getLocalizationObject(o);else o=t.triggerGlobalHandler("getLocalizationObject",{i18n:o,newUri:t.guid+":"+i,regenerateGuid:e});t.assignProperty(i,{i18n:o})}})},isVisible:function(){return!0},isSaved:function(){var e=this.triggerGlobalHandler("getOriginalModel");this.triggerGlobalHandler("getModel");if(e.changeSet&&e.changeSet.length>0&&e.changeSet[0].content){var t=JSON.parse(e.changeSet[0].content);if(t.elements)return t.elements.map(function(e){return e.guid}).indexOf(this.guid)>-1}return!0},updateRelatedFormProperty:function(){},normalizeType:function(e){return e.replace(/smartphone/,"").replace(/tablet/,"").replace(/offline/,"")},getPropertiesRelatedWithForms:function(e,t,i){var n=this,o=this.getPropertiesTypeForm().map(function(e){return{property:e,context:"form"}}),r=this.getPropertiesTypeSearchForm().map(function(e){return{property:e,context:"searchform"}});(o=o.concat(r)).length>0&&o.forEach(function(o){var r=n.resolveProperty(o.property),a=Array.isArray(r);if(r=a&&r.length>0?r[0]:r){var s,l=n.utilities.resolveComplexReference(r),d=t.isOffline?t:$.extend({},t,{context:o.context}),c=l+t.deviceType;if(i[c])i[c].then(function(e){a?n.assignProperty(o.property,[n.utilities.buildComplexReference(e)]):n.assignProperty(o.property,n.utilities.buildComplexReference(e)),n.updateRelatedFormProperty(e,l)});else{var u=n.catalogServices.getShallowById(l).then(function(e){return s=e&&e[0],n.catalogServices.getShallowById(s.parentId)}).then(function(e){var t=e&&e[0];return t="FormClass"==t.type?s.id:s.parentId,n.cloneService.clone(n.elementFactory,l,d,t)});u.then(function(e){a?n.assignProperty(o.property,[n.utilities.buildComplexReference(e)]):n.assignProperty(o.property,n.utilities.buildComplexReference(e)),n.updateRelatedFormProperty(e,l)}),e.push(u)}}})}})),bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.renderBehaviour={findPositionOfElementInFormById:function(e,t){var i={position:t,found:!1};return this.guid===e&&(i={position:t,found:!0}),i}},bizagi.editor.base.element.extend("bizagi.editor.base.render",{},$.extend({},bizagi.editor.base.renderBehaviour,{init:function(e,t,i){this.elementType="render",this._super(e,t,i)},getRenderingModel:function(e){return e=e||"render",$.when(this._super()).pipe(function(t){var i={};return i[e]=t,i})},getPreviewOfflineRenderingModel:function(e){return e=e||"render",$.when(this._super()).pipe(function(t){var i={};return i[e]=t,!!Boolean(t)&&i})},getControlType:function(){return this.controlType||this.properties.renderType},getControlAttributes:function(){var e=$.Deferred();return $.when(this.triggerGlobalHandler("findXpathAttributes",{element:this,xpath:this.properties.xpath})).done(function(){e.resolve()}),e.promise()},getInherentValidations:function(e){var t=this.properties;return e=e||[],t.required&&1==t.required.fixedvalue&&e.push({guid:Math.guid(),conditions:{operator:"and",expressions:[{simple:{operator:"is-empty",xpath:this.getXpath(t.xpath)}}]},validationCommand:{message:"The field "+this.resolveDisplayNameProperty()+" cannot be empty"},inherent:!0}),t.minValue&&e.push({guid:Math.guid(),conditions:{operator:"and",expressions:[{simple:{operator:"is-less-than",xpath:this.getXpath(t.xpath),argument:t.minValue,argumentType:"const"}}]},validationCommand:{message:"The field "+this.resolveDisplayNameProperty()+" cannot be less than "+t.minValue},inherent:!0}),t.maxValue&&e.push({guid:Math.guid(),conditions:{operator:"and",expressions:[{simple:{operator:"is-greater-than",xpath:this.getXpath(t.xpath),argument:t.maxValue,argumentType:"const"}}]},validationCommand:{message:"The field "+this.resolveDisplayNameProperty()+" cannot be less than "+t.maxValue},inherent:!0}),e}})),bizagi.editor.base.render.extend("bizagi.editor.render.generic",{},{init:function(e,t){this.type="label",this._super(e,t)},getRenderingProperties:function(){var e=this.properties,t=this._super();return t.type="label",e.displayName&&(t.displayName="string"==typeof e.displayName?e.displayName:e.displayName.i18n.default),t}}),bizagi.editor.base.render.extend("bizagi.editor.column.generic",{},{init:function(e,t){this.type="columnReadonly",this._super(e,t)},getRenderingProperties:function(){var e=this.properties,t=this._super();return t.type="columnReadonly",e.displayName&&(t.displayName="string"==typeof e.displayName?e.displayName:e.displayName.i18n.default),t}}),bizagi.editor.base.render.extend("bizagi.editor.base.actionlauncher",{},{getPersistenceModel:function(){var e=this._super();return e.properties.customxpath="@KeyValue.Action_"+this.guid,e}}),bizagi.editor.base.render.extend("bizagi.editor.base.polymorphiclauncher",{},{getPersistenceModel:function(){var e=this._super();return e.properties.customxpath="@KeyValue.Constructor_"+this.guid,e}}),bizagi.editor.base.render.extend("bizagi.editor.base.entitytemplate",{},{getPersistenceModel:function(){var e=this._super();return e.properties.customxpath="@KeyValue.Action_"+this.guid,e}}),bizagi.editor.base.element.extend("bizagi.editor.base.renderLayout",{},{init:function(e,t,i){this.elementType="render",this._super(e,t,i)},getRenderingModel:function(e){var t=this;e=e||"render";return $.when(t._super()).pipe(function(i){i.properties.value=t.getValue();var n={};return n[e]=i,n})},getPersistenceModel:function(){return{type:this.type,guid:this.guid,properties:this.removeLocalization(this.filterDefaultValues(this.properties))}},getValue:function(){var e=this.properties,t=e.link||e.xpath,i=e.displayName;if(t)return this.getDesignValue(t);if(null!=i)return bizagi.editor.utilities.resolvei18n(i);if(e.type){var n=e.type.replace(/[:\s]*/g,"").toLowerCase();return"label"!=n&&"value"!=n||(n="drophere"),bizagi.localization.getResource("bizagi-editor-templates-labels-controls-"+n)}},hasValue:function(){var e=this.properties;return!(!e.link&&!e.xpath)||null!=e.displayName},getControlType:function(){return this.controlType},getDesignValue:function(e){this.type;var t=e.xpath.baxpath.xpath.split(".");return t.length>1?t[t.length-1]:bizagi.editor.utilities.resolveComplexXpath(e)},isVisible:function(){return!this.resolveProperty("hide")}}),bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.containerValidations={validRequiredProperties:function(){var e=this._super();return $.each(this.elements,function(t,i){e&=i.validRequiredProperties()}),e},validRequiredDependentProperties:function(){var e=this._super();return $.each(this.elements,function(t,i){e&=i.validRequiredDependentProperties()}),e},validElementsInContainer:function(){var e=!0;if(this.isEditable()){if(this.isContainerToValidate()&&!(e=this.elements.length>0)){var t="grid"===this.type?bizagi.localization.getResource("bizagi-editor-form-validation-elementsingrid"):bizagi.localization.getResource("bizagi-editor-form-validation-elementsincontainer");"string"!=typeof t&&(t=""),this.messageValidation=this.messageValidation||"",this.messageValidation+=t+"</br>"}$.each(this.elements,function(t,i){"function"==typeof i.validElementsInContainer&&(e&=i.validElementsInContainer())})}return e},validAttributesAdministrables:function(){var e=!0;if(this.isEditable())for(var t=0,i=this.elements.length;t<i;t++)e&=this.elements[t].validAttributesAdministrables();return e},isContainerToValidate:function(){var e=this.normalizeType(this.type);return this.isGrid()||"group"===e||"tabitem"===e||"contentpanel"===e},validLayoutPlaceholder:function(e){for(var t=!0,i=0,n=this.elements.length;i<n;i++)t&=this.elements[i].validLayoutPlaceholder(e);return t},validAttributesNoEditables:function(){var e=$.Deferred();return this.elements.length>0?$.when.apply($,$.map(this.elements,function(e){return e.validAttributesNoEditables()})).done(function(){var t=$.makeArray(arguments).filter(function(e){return!e}).length>0;e.resolve(!t)}):e.resolve(!0),e.promise()},validEntitiesNoEditables:function(){var e=$.Deferred();return this.elements.length>0?$.when.apply($,$.map(this.elements,function(e){return e.validEntitiesNoEditables()})).done(function(){var t=$.makeArray(arguments).filter(function(e){return!e}).length>0;e.resolve(!t)}):e.resolve(!0),e.promise()},removeValidations:function(){this._super(),$.each(this.elements,function(e,t){t.removeValidations()})}},bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.containerBehaviour={addElement:function(e,t){var i=t?this.getElement(t):this;return e.position=i.elements.length,i.elements.push(e),e.setParent(i),e},removeLastElement:function(e){return(e?this.getElement(e):this).elements.pop()},getElement:function(e){if(this.guid==e)return this.position=0,this;for(var t=0,i=this.elements.length;t<i;t+=1){var n=this.elements[t];if(n.guid==e)return n.position=this.elements.indexOf(n),n;if(n.elements){var o=n.getElement(e);if(o)return o}}return null},getElementByOldGuid:function(e){if(this.oldGuid==e)return this.position=0,this;for(var t=0,i=this.elements.length;t<i;t+=1){var n=this.elements[t];if(n.oldGuid==e)return n.position=this.elements.indexOf(n),n;if(n.elements){var o=n.getElementByOldGuid(e);if(o)return o}}return null},moveElement:function(e,t,i,n){var o=this.getElement(i);return null==o?null:(o.elements.move(e,t),o)},removeElement:function(e,t){var i=t?this.getElement(t):this;return null==i?null:(i.elements.splice(e,1),i)},removeElementById:function(e){var t=this.getElement(e);if(null==t)return null;var i=this.getElement(t.parent.guid);return null==i?null:(i.elements.splice(t.position,1),t)},findElementByPosition:function(e,t){var i=this.getElement(t);return null==i?null:i.elements[e]},insertElement:function(e,t,i){var n=this.getElement(t);return null==n?null:(n.elements.splice(e,0,i),i.setParent(n),i)},changeProperty:function(e,t,i){var n;return null==(n=this.getElement(e))?null:(n.assignProperty(t,i),n)},updateElementByPosition:function(e,t,i){var n=this.getElement(t);if(null==n)return null;var o=n.elements.splice(e,1);return n.elements.splice(e,0,i),o},findPositionOfElementInFormById:function(e,t){var i={position:t,found:!1};if(this.guid===e)return!0;for(var n=0;n<this.elements.length&&(t+=1,!(i=this.elements[n].findPositionOfElementInFormById(e,t)).found);n++)t=i.position;return i},replaceElement:function(e,t){var i=this.removeElementById(e),n=i.parent;this.insertElement(i.position,n.guid,t)}},bizagi.editor.base.element.extend("bizagi.editor.base.container",{},$.extend({},bizagi.editor.base.containerBehaviour,bizagi.editor.base.containerValidations,{init:function(e,t,i){this.elements=[],this.elementType="container",this._super(e,t,i),this.initialize(e,i)},initialize:function(e,t){var i=this,n=i.elements;e&&e.elements&&$.each(e.elements,function(e,o){var r=i.elementFactory.createElement(o.type,o,t);r.setParent(i),n.push(r)})},ready:function(){var e=$.Deferred(),t=this._super();return $.when.apply($,$.map(this.elements,function(e){return e.ready()})).done(function(){$.when(t).done(function(){e.resolve(!0)})}),e.promise()},getPreviewOfflineRenderingModel:function(){var e=$.Deferred(),t=this._super();return $.when.apply($,this.elements.map(function(e){return e.getPreviewOfflineRenderingModel()})).done(function(){var i=$.makeArray(arguments).filter(Boolean);$.when(t).done(function(t){t?(t.elements=i,e.resolve({container:t})):e.resolve(!1)})}),e.promise()},getMissingOfflineControls:function(e){var t=$.Deferred();return $.when.apply($,this.elements.map(function(t){return t.getMissingOfflineControls(e)})).done(function(){t.resolve(e)}),t.promise()},getRenderingModel:function(){var e=$.Deferred(),t=this._super();return $.when.apply($,$.map(this.elements,function(e){return e.getRenderingModel()})).done(function(){var i=$.makeArray(arguments);$.when(t).done(function(t){t.elements=i,e.resolve({container:t})})}),e.promise()},getPersistenceModel:function(){var e=this._super();return e.elements=[],$.each(this.elements,function(t,i){e.elements.push(i.getPersistenceModel())}),e},getPersitenceValidationsModel:function(){return bizagi.clone(this.validations).map(function(e){var t={i18n:{uri:e.validationCommand.message.i18n.uri}};return e.validationCommand.message=t,e})},getPersistenceButtosModel:function(){return this.buttons.map(function(e){return e.getPersistenceModel()})},getRenderingValidationsModel:function(){var e=this;return e.validations.map(function(t){var i=t.validationCommand.message.i18n;return i=e.triggerGlobalHandler("getLocalizationObject",{i18n:i,regenerateGuid:!1,newUri:i.uri}),t.validationCommand.message.i18n=i,t})},getLocalizableValidationMessagesModel:function(){return[]},getLocalizablePropertiesModel:function(e){var t=this._super(e);return $.each(this.elements,function(i,n){t=t.concat(n.getLocalizablePropertiesModel(e))}),t},getPropertiesRelatedWithForms:function(e,t,i){this._super(e,t,i),this.elements.forEach(function(n){return n.getPropertiesRelatedWithForms(e,t,i)})},getControlType:function(){return this.controlType},getFormParent:function(){return this.parent.getFormParent()},getChildren:function(){return this.elements},getInherentValidations:function(e){return e=e||[],$.each(this.elements,function(t,i){i.getInherentValidations(e)}),e},scopeDefinitionCanBeAdded:function(e){var t=!1;return"string"==typeof e?t=!bizagi.editor.utilities.isGuidEmpty(e):bizagi.editor.utilities.isObject(e)&&(t=!bizagi.editor.utilities.isGuidEmpty(bizagi.editor.utilities.resolveComplexReference(e))),t},updateSubmitVersionProperty:function(){(this.elements||[]).forEach(function(e){e.updateSubmitVersionProperty()})}})),bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.formBehaviour={isButtonElement:function(e){return!(!e||!e.type)&&"formbutton"==e.type},addButton:function(e){return e.position=this.buttons.length,this.buttons.push(e),e.setParent(this),e},removeButtons:function(){this.buttons=[]},moveElement:function(e,t,i,n){return"button"!=n?this._super(e,t,i):(this.buttons.move(e,t),this)},getElement:function(e){var t=this._super(e);if(!t&&this.buttons)for(var i=0;i<this.buttons.length;i++){var n=this.buttons[i];if(n.guid==e)return n.position=this.buttons.indexOf(n),n}return t},removeElementById:function(e){var t=this.getElement(e);return null==t?null:this.isButtonElement(t)?(this.buttons.splice(t.position,1),t):this._super(e)},removeElement:function(e,t,i){return this.isButtonElement(i)?(this.buttons.splice(e,1),i):this._super(e,t)}},bizagi.editor.base.container.extend("bizagi.editor.base.form",{},$.extend({},bizagi.editor.base.formBehaviour,{init:function(e,t,i){var n=this;e=e||{},n.type="form",this._super(e,t,i),n.elementFactory=t,this.validationsResourcesLoaded=new $.Deferred,n.actions=e.actions?e.actions:[],n.actions=i?n.regenerateGuidsActions():n.actions,n.validations=e.validations?e.validations:[],n.validations=i?n.regenerateGuidsValidations():n.validations,n.buttons=e&&e.buttons||[],n.buttons.length>0&&(n.loadButtons(),n.properties.usecustombuttons=void 0===n.properties.usecustombuttons||n.properties.usecustombuttons),setTimeout(function(){n.validations=n.getRenderingValidationsModel(),n.validationsResourcesLoaded.resolve()},0),n.contextentity=e.contextentity,n.scopedefinition=e.scopedefinition,n.isActivityForm=null==e.isActivityForm?e.isActivityForm:!!e.buttons,n.version=e.version},loadButtons:function(){var e=this;e.buttons=e.buttons.map(function(t){var i=e.elementFactory.createElement(t.type,t);return i.setParent(e),i})},getFormParent:function(){return this},getPreviewOfflineRenderingModel:function(){var e=this,t=$.Deferred(),i=e._super();return $.when(i).done(function(i){i.container.properties.isReadOnly=e.triggerGlobalHandler("isReadOnlyForm"),t.resolve({form:i.container})}),t.promise()},getRenderingModel:function(){var e=this,t=$.Deferred(),i=e._super();return $.when(i,e.getButtonRenderingModel()).done(function(i,n){i.container.properties.isReadOnly=e.triggerGlobalHandler("isReadOnlyForm"),t.resolve({form:i.container})}),t.promise()},getPersistenceModel:function(e){var t=this,i=this._super();return i.buttons=t.hasCustomButtons()?t.getPersistenceButtosModel():[],i.actions=t.actions,i.validations=t.getPersitenceValidationsModel(),t.hasCustomButtons()&&(i.buttons=t.getPersistenceButtonsModel()),i.contextentity="string"==typeof t.contextentity?bizagi.editor.utilities.buildComplexReference(t.contextentity):t.contextentity,t.scopeDefinitionCanBeAdded()&&(i.scopedefinition="string"==typeof t.scopedefinition?bizagi.editor.utilities.buildComplexReference(t.scopedefinition):t.scopedefinition),i.version=t.version,null!=(e=e||t.triggerGlobalHandler("getDeviceInfo")||{}).deviceType&&(i.deviceType=e.deviceType,i.deviceId=e.deviceId,e.isSpecific&&(i.isDefault=e.isDefault)),e.isSpecific||null==e.supportOffline||(i.supportOffline=e.supportOffline),i},getPersistenceButtonsModel:function(){return this.buttons.reduce(function(e,t){return e.push(t.getPersistenceModel()),e},[])},getLocalizableValidationMessagesModel:function(e){var t=this;return t.validations.map(function(i){var n=i.validationCommand.message.i18n,o=t.triggerGlobalHandler("getResourceByUri",n),r="object"==typeof o?o.id:Math.guid(),a=function(e,t){var i,n=[];for(i in e.languages)n.push({code:i,value:e.languages[i]});return{category:"bizagiObjects.form",uri:e.uri,field:t,languages:n,defaultValue:e.default}}(n,"message");return{action:"merge",deployOnParent:!0,id:r,name:"Resources_"+r,type:"Resource",parentId:e,content:JSON.stringify(a),modifiedByUser:BIZAGI_USER}})},getLocalizablePropertiesModel:function(e){var t=this._super(e);return this.hasCustomButtons()&&this.buttons.forEach(function(i){t=t.concat(i.getLocalizablePropertiesModel(e))}),t},scopeDefinitionCanBeAdded:function(){return"string"==typeof this.scopedefinition?!bizagi.editor.utilities.isGuidEmpty(this.scopedefinition):!!bizagi.editor.utilities.isObject(this.scopedefinition)&&!bizagi.editor.utilities.isGuidEmpty(bizagi.editor.utilities.resolveComplexReference(this.scopedefinition))},hasCustomButtons:function(){return void 0!==this.properties.usecustombuttons&&this.properties.usecustombuttons},getSearchResultRenderingModel:function(){},getButtonRenderingModel:function(){return $.when.apply($,$.map(this.buttons,function(e){return $.when(e.ready()).pipe(function(){return e.getRenderingModel("button")})})).pipe(function(){return $.makeArray(arguments)})},getCommandsModel:function(){var e=this,t=$.Deferred(),i={},n=[],o=e.getCommandsControls(e,i,n);return n.length>0?$.when(e.getCommandsSpecialControls(n,i)).done(function(){t.resolve({actions:e.getActions(),validations:e.getValidations(),controls:o,enableReverse:e.verifyFormHasReverse()})}):t.resolve({actions:e.getActions(),validations:e.getValidations(),controls:o,enableReverse:e.verifyFormHasReverse()}),t.promise()},ready:function(){var e=this,t=$.Deferred(),i=e._super();return $.when(e.validationsResourcesLoaded,i).done(function(){$.when.apply($,$.map(e.buttons,function(e){return e.ready()})).done(function(){t.resolve()})}),t.promise()},getValidations:function(){var e=bizagi.clone(this.validations);return $.merge(e,this.getInherentValidations()),e},getActions:function(){return $.each(this.actions,function(e,t){for(var i=$.grep(t.commands,function(e){return"execute-rule"===e.command||"execute-gridrule"===e.command}),n=0,o=i.length;n<o;n++){var r=i[n].argument;bizagi.editor.utilities.isObject(r)||(r={rule:r,label:"Rule"}),r.guid&&(r.rule=bizagi.editor.utilities.buildComplexReference(r.guid),delete r.guid),function(e,t,i){var n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getruledisplayname",rule:e});$.when(n.processRequest()).done(function(e){t.label=e?e.displayName:t.label,i.argument=t})}(r.rule,r,i[n])}}),this.actions},getActionValidationsModel:function(){return{actions:this.actions,validations:this.validations,mapXpaths:this.getMapControls(this,{})}},setCommandsModel:function(e){this.actions=e.actions||[],this.validations=e.validations?$.grep(e.validations,function(e){return!e.inherent}):[]},getCommandsControls:function(e,t,i){var n=["actionlauncher"];t=t||{},i=i||[];for(var o=0;o<e.elements.length;o++){var r=e.elements[o];if("container"==r.elementType&&"nestedform"!==r.type&&this.getCommandsControls(r,t,i),!(n.includes(r.type)||"boolean"===r.controlType&&"check"===r.properties.display&&bizagi.util.parseBoolean(r.properties.isexclusive))){var a=r.getControlType(),s=r.isVisualProperty("xpath");if(!r.isHidden()||a||bizagi.util.isEmpty(r.properties.xpath)){if("offlinegrid"!=r.type){if(a&&!bizagi.util.isEmpty(r.properties.xpath)&&"container"!==r.elementType){var l,d=r.isContainedInNestedForm(),c=d?d+"."+r.getXpath():r.getXpath();if(c=e.isGrid()?e.getXpath()+"[]."+r.getXpath():c,e.isGrid()||d)if("object"==typeof e.properties.xpath)l=this.buildCompositeXpath({originalXpath:e.properties.xpath,resolved:c});else{var u=r.getXpathNestedForm();l=this.buildCompositeXpath({originalXpath:u,resolved:c})}else l=r.properties.xpath;var p=bizagi.editor.utilities.resolveRelatedEntityFromXpath(r.properties.xpath);t[c]={label:e.isGrid()?(bizagi.util.trim(e.resolveDisplayNameProperty())||e.getXpath())+"."+e.elements[o].resolveDisplayNameProperty():e.elements[o].resolveDisplayNameProperty(),type:r.getControlType(r),render:"render"==r.elementType||null,container:"container"==r.elementType||null,baxpath:l,xpathContainer:e.isGrid()?e.getXpath():null,controlType:r.type,style:r.style,relatedEntity:p}}else if(a&&"container"===r.elementType){t[m=r.guid]={label:r.resolveDisplayNameProperty()||a+" "+m,type:r.getControlType(r),render:!1,container:!0,containerId:m,propertyToUpdate:"container",controlType:r.type,style:r.style}}else!s&&a&&"container"!==r.elementType&&(t[m=e.isGrid()?e.getXpath()+"[]."+r.guid:r.guid]={label:e.isGrid()?(e.resolveDisplayNameProperty()||e.getXpath())+"."+r.resolveDisplayNameProperty()||a+" "+m:r.resolveDisplayNameProperty()||a+" "+m,type:a,render:"render"==r.elementType||null,container:"container"==r.elementType||null,renderId:m,propertyToUpdate:"renderId",xpathContainer:e.isGrid()?e.getXpath():null,controlType:r.type,style:r.style});r.isGrid()&&!bizagi.util.isEmpty(r.properties.xpath)&&this.getCommandsControls(r,t,i)}}else i.push(r)}}if(this.properties.usecustombuttons)for(o=0;o<this.getFormParent().buttons.length;o++){var m,h=this.getFormParent().buttons[o];t[m=h.guid]={label:h.properties.caption.i18n.default,type:"activityFlowButton",render:"render"==h.elementType||null,container:null,renderId:h.guid,propertyToUpdate:"renderId",xpathContainer:null,controlType:"activityFlowButton"}}return t},getCommandsSpecialControls:function(e,t){var i=this,n=new $.Deferred;return $.when.apply($,$.map(e,function(e){return e.getControlAttributes()})).done(function(){i.getCommandsControls({elements:e,isGrid:function(){return!1}},t),n.resolve()}),n.promise()},getMapControls:function(e,t){t=t||{};for(var i=0;i<e.elements.length;i++){var n=e.elements[i];if(("container"==n.elementType||n.isGrid())&&this.getMapControls(n,t),"nestedform"!=e.elements[i].type&&"formlink"!=e.elements[i].type&&"hidden"!=e.elements[i].type&&"offlinehidden"!=e.elements[i].type&&!bizagi.util.isEmpty(e.elements[i].properties.xpath)){var o=e.elements[i].isContainedInNestedForm(),r=o?o+"."+e.elements[i].getXpath()+e.elements[i].getFilter():e.elements[i].getXpath()+e.elements[i].getFilter();t[r=e.isGrid()?e.getXpath()+e.getFilter()+"."+r:r]||(t[r]={elements:[]}),t[r].elements.push({guid:e.elements[i].guid}),o&&(t[r].elements[t[r].elements.length-1].nestedForm=!0)}}return t},getMapXpath:function(e,t){t=t||{};for(var i=0;i<e.elements.length;i++){var n=e.elements[i];if(("container"==n.elementType||n.isGrid())&&e.elements[i].isEditable()&&this.getMapXpath(n,t),"nestedform"!=e.elements[i].type&&"formlink"!=e.elements[i].type&&"hidden"!=e.elements[i].type&&"offlinehidden"!=e.elements[i].type&&!bizagi.util.isEmpty(e.elements[i].properties.xpath)){var o=e.elements[i].isContainedInNestedForm(),r=o?o+"."+e.elements[i].getXpath()+e.elements[i].getFilter():e.elements[i].getXpath()+e.elements[i].getFilter();t[r=e.isGrid()?e.getXpath()+e.getFilter()+"."+r:r]||(t[r]={editables:0,elements:[]});var a=bizagi.editor.utilities.resolveProperty(e.elements[i].properties,"editable.fixedvalue")||!0;t[r].editables=bizagi.util.parseBoolean(a)?t[r].editables+1:t[r].editables,t[r].elements.push({editable:!a||bizagi.util.parseBoolean(a),guid:e.elements[i].guid}),o&&(t[r].elements[t[r].elements.length-1].nestedForm=!0)}}return t},getMapXpathAdhoc:function(e,t){t=t||{};for(var i=0;i<e.elements.length;i++){var n=e.elements[i];if(("container"==n.elementType||n.isGrid())&&this.getMapXpathAdhoc(n,t),"nestedform"!=e.elements[i].type&&"formlink"!=e.elements[i].type&&"hidden"!=e.elements[i].type&&"offlinehidden"!=e.elements[i].type){var o=e.elements[i].properties,r=o&&o.xpathAdhoc&&o.xpathAdhoc.xpath;if(r){t[r=e.isGrid()?e.getXpathAdhoc()+"."+r:r]||(t[r]={editables:0,elements:[]});var a=bizagi.editor.utilities.resolveProperty(e.elements[i].properties,"editable.fixedvalue")||!0;t[r].editables=bizagi.util.parseBoolean(a)?t[r].editables+1:t[r].editables,t[r].elements.push({editable:!a||bizagi.util.parseBoolean(a),guid:e.elements[i].guid})}}}return t},getMapDisplayNameAdhoc:function(e,t){t=t||{};for(var i=0;i<e.elements.length;i++){var n=e.elements[i];if(("container"==n.elementType||n.isGrid())&&this.getMapDisplayNameAdhoc(n,t),"nestedform"!=e.elements[i].type&&"formlink"!=e.elements[i].type&&"hidden"!=e.elements[i].type&&"offlinehidden"!=e.elements[i].type){var o=e.elements[i].properties,r=o&&o.xpathAdhoc&&o.xpathAdhoc.xpath;r&&(t[r]=!0)}}return t},getMapXpathDatasourceAdhoc:function(e,t){t=t||{};for(var i=0;i<e.elements.length;i++){var n=e.elements[i];if(n.properties.data&&n.properties.data.datasource&&n.properties.data.datasource.type&&!["adhoccombo","adhocsuggest","adhoccolumnsuggest","adhoccolumncombo"].includes(n.type)&&"bizagi"===n.properties.data.datasource.type){var o=n.properties.data.datasource.guid;if(o){t[o]||(t[o]={editables:0,elements:[]});var r=bizagi.editor.utilities.resolveProperty(n.properties,"editable.fixedvalue")||!0;t[o].editables=bizagi.util.parseBoolean(r)?t[o].editables+1:t[o].editables,t[o].elements.push({editable:!r||bizagi.util.parseBoolean(r),guid:n.guid})}}}return t},buildxpathColumn:function(e){return buildCompositeXpath(e)},buildCompositeXpath:function(e){if("object"==typeof e.originalXpath){var t=bizagi.clone(e.originalXpath);return t.xpath.baxpath.xpath=e.resolved,t}},addAction:function(e){this.actions.push(e)},deleteAction:function(e){for(var t=-1,i=0;i<this.actions.length;i++)if(this.actions[i].guid==e){t=i;break}t>=0&&this.actions.splice(t,1)},addValidation:function(e){this.validations.push(e)},deleteValidation:function(e){for(var t=-1,i=0;i<this.validations.length;i++)if(this.validations[i].guid==e){t=i;break}t>=0&&this.validations.splice(t,1)},triggerGlobalHandler:function(e,t){return this.publish(e,t)},verifyFormHasReverse:function(){for(var e=this.actions,t=!1,i=0;i<e.length;i++)if(e[i].elseAction&&"automatic"==e[i].elseAction){t=!0;break}return t},regenerateGuidsActions:function(){for(var e=this,t=0,i=e.actions.length;t<i;t++){var n=e.actions[t],o=[];e.getExpressions(n.conditions.expressions,o);for(var r=0,a=o.length;r<a;r++){var s=o[r];if(s.renderId)if(e.isGridContext(s.renderId)){var l=e.processGridContext(s.renderId),d=e.getElementByOldGuid(l.guidControl),c=d?d.guid:l.guidControl,u=l.gridXpath+"[]."+c;s.renderId=u}else d=e.getElementByOldGuid(s.renderId),s.renderId=d?d.guid:s.renderId}if(n.commands)for(r=0,a=n.commands.length;r<a;r++){var p=n.commands[r];(p.renderId||p.container)&&(d=e.getElementByOldGuid(p.renderId||p.container),p.renderId?p.renderId=d?d.guid:p.renderId:p.container=d?d.guid:p.container)}if(n.elseCommands)for(r=0,a=n.elseCommands.length;r<a;r++){var m=n.elseCommands[r];(m.renderId||m.container)&&(d=e.getElementByOldGuid(m.renderId||m.container),m.renderId?m.renderId=d?d.guid:m.renderId:m.container=d?d.guid:m.container)}if(n.dependencies)for(r=0,a=n.dependencies.length;r<a;r++){var h=n.dependencies[r];"string"==typeof h&&(e.isGridContext(h)?(l=e.processGridContext(h),c=(d=e.getElementByOldGuid(l.guidControl))?d.guid:l.guidControl,u=l.gridXpath+"[]."+c,n.dependencies[r]=u):(d=e.getElementByOldGuid(h),n.dependencies[r]=d?d.guid:h))}}return e.actions},getExpressions:function(e,t){for(var i=0,n=e.length;i<n;i++){var o=e[i];o.complex?this.getExpressions(o.complex.conditions.expressions,t):o.simple&&t.push(o.simple)}},regenerateGuidsValidations:function(){for(var e=0,t=this.validations.length;e<t;e++){var i=this.validations[e],n=[];this.getExpressions(i.conditions.expressions,n);for(var o=0,r=n.length;o<r;o++){var a=n[o];if(a.renderId)if(this.isGridContext(a.renderId)){var s=this.processGridContext(a.renderId),l=this.getElementByOldGuid(s.guidControl),d=l?l.guid:s.guidControl,c=s.gridXpath+"[]."+d;a.renderId=c}else l=this.getElementByOldGuid(a.renderId),a.renderId=l?l.guid:a.renderId}}return this.validations},isGridContext:function(e){return!!(e&&e.indexOf("[]")>0)},processGridContext:function(e){var t,i,n=new RegExp(/([\w\.]*)\[\]\.([\w\.|\w-\.]*)/g).exec(e);return n?(i=n[1],t=n[2]):(t="",i=""),{guidControl:t,gridXpath:i}},createDefaultButtons:function(e){this.buttons=[];var t=Math.guid(),i=this.elementFactory.createElement("formbutton",{guid:t,properties:{caption:bizagi.editor.utilities.buildComplexLocalizable(bizagi.localization.getResource("render-form-button-save"),t,"caption"),actions:["submitData","refresh"]}});i.setParent(this);var n=Math.guid(),o=this.elementFactory.createElement("formbutton",{guid:n,properties:{caption:bizagi.editor.utilities.buildComplexLocalizable(bizagi.localization.getResource("render-form-button-next"),n,"caption"),actions:["validate","submitData","next"]}});o.setParent(this),this.buttons.push(i),this.buttons.push(o)},resolveRelatedForms:function(e){var t=this;return new Promise(function(i){var n=[];t.getPropertiesRelatedWithForms(n,t.publish("getDeviceInfo"),e),n.length>0?Promise.all(n).then(function(){t.unsubscribeEvents(),i()}):(t.unsubscribeEvents(),i())})}})),bizagi.editor.base.form.extend("bizagi.editor.base.startform",{},$.extend({},bizagi.editor.base.formBehaviour,{init:function(e,t){this._super(e,t),this.type="startform"},getPersistenceModel:function(e){if(this.triggerGlobalHandler("getControllerInfo",{type:"isNewForm"})){var t="displayName";if(!this.resolveProperty(t)){var i=bizagi.editor.utilities.resolveResource("bizagi-editor-startform-display-name"),n=bizagi.editor.utilities.buildComplexLocalizable(i,this.guid,t);this.assignProperty(t,n)}}return this._super(e)},createDefaultButtons:function(){this.buttons=[];var e=Math.guid(),t=this.elementFactory.createElement("formbutton",{guid:e,properties:{caption:bizagi.editor.utilities.buildComplexLocalizable(bizagi.localization.getResource("render-form-button-create"),e,"caption"),actions:["validate","createnewcase"]}});t.setParent(this),this.buttons.push(t)},hasCustomButtons:function(){return!0}})),bizagi.editor.base.form.extend("bizagi.editor.base.adhocform",{},$.extend({},bizagi.editor.base.formBehaviour,{init:function(e,t){this._super(e,t),this.type="adhocform"}})),bizagi.editor.base.form.extend("bizagi.editor.base.template",{},{init:function(e,t,i){this._super(e,t,i),this.type="template"},getFormParent:function(){return this},getLayout:function(){return this.elements[0]}}),bizagi.editor.base.container.extend("bizagi.editor.base.layout",{},{init:function(e,t,i){this.type="layout",this.repeaters={},this._super(e,t,i)},initialize:function(e){for(var t=this,i=t.properties,n=t.elements,o=/\{\{(placeholder(\:\w*)?)\}\}/g,r=/{{(repeater( {"id":"([\w-]+)"})?)}}\s*({{repeater:item}}([\w\W]+){{\/repeater:item}})/g,a=/{{repeater:item}}(<\w{2,10}\s*(class="[a-z]*")?([\sa-z0-9-="]*style="display: none;")>[\w\W]+){{\/repeater:item}}/,s=i.html.split("{{/repeater}}"),l=0,d=s.length;l<d;l++){var c=s[l];c=(c=c.replace(r,function(){var e=null!=arguments[3]?arguments[3]:Math.guid(),i=arguments[5],n=arguments[4],o={},r=arguments[0];if(null!=arguments[3]){var s=a.exec(n);i=s[1],i.replace(/({{placeholder(:\w*)?)(\s*\{"id":"([\w-]+)"\})?/gm,function(){var e=arguments[4];return e&&(o[e]=!0),arguments[1]}),n=s[0].replace(s[3],"")}else r=r.replace(i,$(i).attr("id",Math.guid())[0].outerHTML);return t.repeaters[e]={content:i,item:n,elements:o},(r=null!=arguments[3]?r:r.replace("{{repeater}}","{{repeater "+JSON.stringify({id:e})+"}}"))+"{{/repeater}}"})).replace(o,function(e,i,o,r,a){var s=Math.guid(),l="layoutPlaceholder";":image"==o&&(l="layoutImage");var d=t.elementFactory.createElement(l,{guid:s,properties:{type:o||"Value"}},!1);return d.setParent(t),n.push(d),"{{placeholder "+JSON.stringify({id:s})+"}}"}),s[l]=c}return i.html=s.join(""),t._super(e)},getRenderingModel:function(){for(var e=this,t=e.properties,i=e.elements,n=/({{placeholder(:\w*)?(\s*\{"id":"([\w-]+)"\})?)/g,o=/\{\{repeater \{"id":"([a-zA-Z0-9-]+)"\}\}\}\s*\{\{repeater:item\}\}[\w\W]+/g,r=t.html.split("{{/repeater}}"),a=0,s=r.length;a<s;a++){var l=r[a];l=l.replace(o,function(t,o,r,a){var s=o,l=e.repeaters[s];if(l&&e.addAditionalItem(l)){t=(t=t.replace('noshow="true"',"")).replace('style="display: none;"',""),l.elements={};var d=$(e.repeaters[s].content).css({display:"none"}).attr("noShow",!0).attr("id",Math.guid());return t+(d=(d="{{separator}}{{repeater:item}}"+(d=d[0].outerHTML)+"{{/repeater:item}}").replace(n,function(t,n,o,r,a){var s=Math.guid(),d=e.elementFactory.createElement("layoutPlaceholder",{guid:s,properties:{type:o||"Value",repeaterId:s}},!1);return l.elements[s]=!0,d.setParent(e),i.push(d),null!=arguments[3]?t.replace(arguments[3],JSON.stringify({id:s})):t+" "+JSON.stringify({id:s})}))+"{{/repeater}}"}return t+"{{/repeater}}"}),r[a]=l}return t.html=r.join(""),e._super()},addAditionalItem:function(e){if($.isEmptyObject(e.elements))return!0;for(var t in e.elements){var i=this.getElement(t);if(!i)return!0;if(i.hasValue())return!0}return!1}}),bizagi.editor.base.container.extend("bizagi.editor.base.tab",{map:{tab:"tabitem",offlinetab:"offlinetabitem",smartphonetab:"smartphonetabitem",tablettab:"tablettabitem",adhoctab:"adhoctabitem",offlinesmartphonetab:"offlinesmartphonetabitem",offlinetablettab:"offlinetablettabitem"}},{init:function(e,t,i){this._super(e,t,i)},initialize:function(e,t){if(this._super(e,t),0==this.elements.length){var i=Math.guid(),n="adhoctab"==this.type?"Tab 1":this.utilities.buildComplexLocalizable("Tab 1",i,"displayName"),o=this.Class.map[this.type],r=this.elementFactory.createElement(o,{properties:{type:o,displayName:n},guid:i});r.setParent(this),this.elements.push(r),this.activeTab=i}},assignActiveTab:function(e){this.activeTab=e},getRenderingModel:function(){var e=this,t=$.Deferred(),i=e._super();return $.when(i).done(function(i){i.container.properties.activeTab=e.activeTab,t.resolve(i)}),t.promise()}}),bizagi.editor.base.render.extend("bizagi.editor.base.formbutton",{},{init:function(e,t,i){this._super(e,t,i),this.fixProperties()},fixProperties:function(){var e=this.properties;e.buttonrule&&this.fixButtonRuleProperty(e.buttonrule)},fixButtonRuleProperty:function(e){e.baref&&(e={rule:e},this.assignProperty("buttonrule",e))}}),bizagi.editor.base.form.extend("bizagi.editor.base.offlineform",{},$.extend({},bizagi.editor.base.formBehaviour,{init:function(e,t){this._super(e,t),this.type="offlineform"}})),bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.searchFormBehaviour={isResultElement:function(e){return e.type.indexOf("columnResult")>=0},addElement:function(e,t){return this.isResultElement(e)?(e.position=this.result.length,this.result.push(e),e.setParent(this),e):this._super(e,t)},insertElement:function(e,t,i){return this.isResultElement(i)?(this.result.splice(e,0,i),i.setParent(this),i):this._super(e,t,i)},getElement:function(e){var t=this._super(e);if(!t)for(var i=0;i<this.result.length;i++){var n=this.result[i];if(n.guid==e)return n.position=this.result.indexOf(n),n}return t},moveElement:function(e,t,i,n){return"searchresult"!=n?this._super(e,t,i):(this.result.move(e,t),this)},removeElementById:function(e){var t=this.getElement(e);return null==t?null:this.isResultElement(t)?(this.result.splice(t.position,1),t):this._super(e)}},bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.queryFormBehaviour={isResultElement:function(e){return e.type.indexOf("columnResult")>=0},addElement:function(e,t){return this.isResultElement(e)?(e.position=this.result.length,this.result.push(e),e.setParent(this),e):this._super(e,t)},insertElement:function(e,t,i){return this.isResultElement(i)?(this.result.splice(e,0,i),i.setParent(this),i):this._super(e,t,i)},getElement:function(e){return this._super(e)},moveElement:function(e,t,i,n){return"searchresult"!=n?this._super(e,t,i):(this.result.move(e,t),this)},removeElementById:function(e){var t=this.getElement(e);return null==t?null:this.isResultElement(t)?(this.result.splice(t.position,1),t):this._super(e)}},bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.searchFormValidations={validRequiredProperties:function(){return this._super()},validRequiredDependentProperties:function(){return!0},validAttributesAdministrables:function(){return!0},validElementsInContainer:function(){var e;if(this.resultValidations="",!(e=this.result.length>0)){var t=bizagi.localization.getResource("bizagi-editor-form-validation-elementsincontainer");"string"!=typeof t&&(t=""),this.resultValidations=t}return e},removeValidations:function(){this._super(),this.resultValidations=null}},bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.queryFormValidations={validRequiredProperties:function(){return this._super()},validRequiredDependentProperties:function(){return!0},validAttributesAdministrables:function(){return!0},validElementsInContainer:function(){return this._super()},removeValidations:function(){this._super(),this.resultValidations=null}},bizagi.editor.base.container.extend("bizagi.editor.base.searchform",{},$.extend({},bizagi.editor.base.searchFormBehaviour,bizagi.editor.base.searchFormValidations,{init:function(e,t,i){var n=this;n.type="searchform",this._super(e,t,i),n.contextentity=e.contextentity,n.scopedefinition=e.scopedefinition,n.version=e.version,n.result=[],e.result&&$.each(e.result,function(e,t){var i=n.elementFactory.createElement(t.type,t);i.setParent(n),n.result.push(i)})},getFormParent:function(){return this},getRenderingModel:function(){var e=$.Deferred(),t=this._super();return $.when(t).done(function(t){t.container&&t.container.properties&&(t.container.properties.type="form"),e.resolve({form:t.container})}),e.promise()},getPersistenceModel:function(){var e=this,t=this._super();(t=$.extend(t,{result:e.getSearchResultPersistenceModel(),resultValidations:e.resultValidations})).contextentity="string"==typeof e.contextentity?bizagi.editor.utilities.buildComplexReference(e.contextentity):e.contextentity,e.scopeDefinitionCanBeAdded(e.scopedefinition)&&(t.scopedefinition="string"==typeof e.scopedefinition?bizagi.editor.utilities.buildComplexReference(e.scopedefinition):e.scopedefinition),t.version=e.version;var i=e.triggerGlobalHandler("getDeviceInfo")||{};return null!=i.deviceType&&(t.deviceType=i.deviceType,t.deviceId=i.deviceId),t},getSearchResultPersistenceModel:function(){var e=[];return $.each(this.result,function(t,i){e.push(i.getPersistenceModel())}),e},getLocalizablePropertiesModel:function(e){var t=this._super(e);return $.each(this.result,function(i,n){t=t.concat(n.getLocalizablePropertiesModel(e))}),t},getSearchResultRenderingModel:function(){var e=this,t=$.Deferred();return $.when.apply($,$.map(e.result,function(e){return e.getGridColumnModel()})).done(function(){t.resolve({result:$.makeArray(arguments),resultValidations:e.resultValidations})}),t.promise()},resolveDisplayNameProperty:function(){return this.resolveProperty("displayName")?this.resolveI18nProperty("displayName"):void 0},getMapXpath:function(e,t){},getMapControls:function(e,t){},triggerGlobalHandler:function(e,t){return this.publish(e,t)},resolveRelatedForms:function(){return new Promise(function(e){e()})}})),bizagi.editor.base.container.extend("bizagi.editor.base.queryform",{},$.extend({},bizagi.editor.base.queryFormValidations,{init:function(e,t,i){var n=this;n.type="queryform",this._super(e,t,i),n.actions=e&&e.actions?e.actions:[],n.actions=i?n.regenerateGuidsActions():n.actions,n.validations=e&&e.validations?e.validations:[],n.validations=i?n.regenerateGuidsValidations():n.validations,n.contextentity=e.contextentity,n.scopedefinition=e.scopedefinition,n.version=e.version},getFormParent:function(){return this},getRenderingModel:function(){var e=$.Deferred(),t=this._super();return $.when(t).done(function(t){e.resolve({form:t.container})}),e.promise()},getPersistenceModel:function(){var e=this,t=this._super(),i=e.triggerGlobalHandler("getContextEntityType");return t.actions=e.actions,t.validations=e.validations,t.properties.onlynested=t.properties.onlynested||!1,t.contextentity="string"==typeof e.contextentity?bizagi.editor.utilities.buildComplexReference(e.contextentity):e.contextentity,e.scopeDefinitionCanBeAdded(e.scopedefinition)&&(t.scopedefinition="string"==typeof e.scopedefinition?bizagi.editor.utilities.buildComplexReference(e.scopedefinition):e.scopedefinition),t.version=e.version,t.queryType="application"==i?"application":"entity",t},resolveDisplayNameProperty:function(){return this.resolveProperty("displayName")?this.resolveI18nProperty("displayName"):void 0},getCommandsModel:function(){var e=this,t=$.Deferred(),i={},n=[],o=e.getCommandsControls(e,i,n);return n.length>0?$.when(e.getCommandsSpecialControls(n,i)).done(function(){t.resolve({actions:e.getActions(),validations:e.getValidations(),controls:o,enableReverse:e.verifyFormHasReverse()})}):t.resolve({actions:e.getActions(),validations:e.getValidations(),controls:o,enableReverse:e.verifyFormHasReverse()}),t.promise()},getValidations:function(){var e=bizagi.clone(this.validations);return $.merge(e,this.getInherentValidations()),e},getActions:function(){return $.each(this.actions,function(e,t){for(var i=$.grep(t.commands,function(e){return"execute-rule"===e.command||"execute-gridrule"===e.command}),n=0,o=i.length;n<o;n++){var r=i[n].argument;bizagi.editor.utilities.isObject(r)||(r={rule:r,label:"Rule"}),r.guid&&(r.rule=bizagi.editor.utilities.buildComplexReference(r.guid),delete r.guid),function(e,t,i){var n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getruledisplayname",rule:e});$.when(n.processRequest()).done(function(e){t.label=e?e.displayName:t.label,i.argument=t})}(r.rule,r,i[n])}}),this.actions},getActionValidationsModel:function(){return{actions:this.actions,validations:this.validations,mapXpaths:this.getMapControls(this,{})}},setCommandsModel:function(e){this.actions=e.actions||[],this.validations=e.validations?$.grep(e.validations,function(e){return!e.inherent}):[]},getCommandsControls:function(e,t,i){t=t||{},i=i||[];for(var n=0;n<e.elements.length;n++){"container"==e.elements[n].elementType&&"nestedform"!==e.elements[n].type&&this.getCommandsControls(e.elements[n],t,i);var o=e.elements[n].getControlType(),r=e.elements[n].isVisualProperty("xpath");if(!e.elements[n].isHidden()||o||bizagi.util.isEmpty(e.elements[n].properties.xpath)){if(!e.elements[n].isInternal())if(o&&!bizagi.util.isEmpty(e.elements[n].properties.xpath)&&"container"!==e.elements[n].elementType){var a=e.isGrid()?e.getXpath()+"[]."+e.elements[n].getXpath():e.elements[n].getXpath();t[a]={label:e.isGrid()?(bizagi.util.trim(e.resolveDisplayNameProperty())||e.getXpath())+"."+e.elements[n].resolveDisplayNameProperty():e.elements[n].resolveDisplayNameProperty(),type:e.elements[n].getControlType(e.elements[n]),render:"render"==e.elements[n].elementType||null,container:"container"==e.elements[n].elementType||null,baxpath:e.isGrid()?this.buildxpathColumn({originalXpath:e.properties.xpath,resolved:a}):e.elements[n].properties.xpath,xpathContainer:e.isGrid()?e.getXpath():null,controlType:e.elements[n].type,style:e.elements[n].style}}else if(o&&"container"===e.elements[n].elementType){var s=e.elements[n].guid;t[s]={label:e.elements[n].resolveDisplayNameProperty()||o+" "+s,type:e.elements[n].getControlType(e.elements[n]),render:!1,container:!0,containerId:s,propertyToUpdate:"container",controlType:e.elements[n].type,style:e.elements[n].style}}else!r&&o&&"container"!==e.elements[n].elementType&&(t[s=e.isGrid()?e.getXpath()+"[]."+e.elements[n].guid:e.elements[n].guid]={label:e.isGrid()?(e.resolveDisplayNameProperty()||e.getXpath())+"."+e.elements[n].resolveDisplayNameProperty()||o+" "+s:e.elements[n].resolveDisplayNameProperty()||o+" "+s,type:o,render:"render"==e.elements[n].elementType||null,container:"container"==e.elements[n].elementType||null,renderId:s,propertyToUpdate:"renderId",xpathContainer:e.isGrid()?e.getXpath():null,controlType:e.elements[n].type,style:e.elements[n].style})}else i.push(e.elements[n])}return t},getCommandsSpecialControls:function(e,t){var i=this,n=new $.Deferred;return $.when.apply($,$.map(e,function(e){return e.getControlAttributes()})).done(function(){i.getCommandsControls({elements:e,isGrid:function(){return!1}},t),n.resolve()}),n.promise()},verifyFormHasReverse:function(){for(var e=this.actions,t=!1,i=0;i<e.length;i++)if(e[i].elseAction&&"automatic"==e[i].elseAction){t=!0;break}return t},getMapXpath:function(){},getMapControls:function(){},triggerGlobalHandler:function(e,t){return this.publish(e,t)}})),$.Class.extend("bizagi.editor.base.elementFactory",{designValueRegex:/<\w+:([\w:]+)>/},{init:function(e){this.classes={};this.controls=e.controls;this.registerDefinitions(e.definitions)},registerDefinitions:function(e){var t=this;$.each(e.controls,function(e,i){var n=t.controls.getControlsToConvert(i.name),o=t.createClassForControl(i,n);t.classes[i.name]=o})},createClassForControl:function(control,controlsToConvert){var self=this,type=control.type||"render",extendingClass="container"==type||"offlinecontainer"==type||"adhoccontainer"==type?"bizagi.editor.base.container":"bizagi.editor.base.render";"queryInternal"==type?extendingClass="bizagi.editor.base.internal":"grid"===control.name||"groupedgrid"===control.name||"offlinegrid"===control.name||"adhocgrid"===control.name||"smartphonegrid"===control.name||"tabletgrid"===control.name||"offlinetabletgrid"===control.name||"offlinesmartphonegrid"===control.name?extendingClass="bizagi.editor.base.grid":"panel"===control.name||"horizontal"===control.name||"smartphonepanel"===control.name||"smartphonehorizontal"===control.name||"tabletpanel"===control.name||"tablethorizontal"===control.name?extendingClass="bizagi.editor.base.container":"nestedform"===control.name||"querynestedform"===control.name?extendingClass="bizagi.editor.base.nestedform":"tab"===control.name||"offlinetab"===control.name||"offlinesmartphonetab"===control.name||"offlinetablettab"===control.name||"smartphonetab"===control.name||"tablettab"===control.name||"adhoctab"===control.name?extendingClass="bizagi.editor.base.tab":"form"===control.name?extendingClass="bizagi.editor.base.form":"template"===control.name?extendingClass="bizagi.editor.base.template":"layout"===control.name?extendingClass="bizagi.editor.base.layout":"offlineform"===control.name?extendingClass="bizagi.editor.base.offlineform":"adhocform"===control.name?extendingClass="bizagi.editor.base.adhocform":"searchform"===control.name||"smartphonesearchform"===control.name?extendingClass="bizagi.editor.base.searchform":"queryform"===control.name?extendingClass="bizagi.editor.base.queryform":"startform"==control.name?extendingClass="bizagi.editor.base.startform":"formbutton"===control.name?extendingClass="bizagi.editor.base.formbutton":"collectionnavigator"===control.name?extendingClass="bizagi.editor.base.collectionnavigator":"actionlauncher"===control.name||"smartphoneactionlauncher"===control.name?extendingClass="bizagi.editor.base.actionlauncher":"polymorphiclauncher"===control.name||"smartphonepolymorphiclauncher"===control.name?extendingClass="bizagi.editor.base.polymorphiclauncher":"entitytemplate"===control.name||"smartphoneentitytemplate"===control.name?extendingClass="bizagi.editor.base.entitytemplate":"template"===type&&(extendingClass="bizagi.editor.base.renderLayout");var className="bizagi.editor."+control.name,code=extendingClass+'.extend("'+className+'" , {}, {\ninit: function ( data, elementFactory, regenerateGuid ) {\nvar self = this;\nself.type = "'+control.name+'";\nself.style = "'+control.style+'";\nthis._super(data, elementFactory, regenerateGuid);\nthis.propertyModel = this.Class.propertyModel;\nthis.decoratorModel = this.Class.decoratorModel;\nthis.contextMenuModel = this.Class.contextMenuModel;\nthis.convertToModel = this.Class.convertToModel;\nthis["widget-guid"] = this.Class["widget-guid"];\nthis.context = this.Class.decoratorModel;\nthis.defaultValues = {};\nthis.asyncProperties = [];\nthis.requiredProperties = {};\nthis.xpathProperties = [];\nthis.requiredDependentProperties = {};\nthis.designValueProperties = {};\nthis.display = '+(control.display&&control.display.default?'"'+control.display.default+'"':"null")+";\nthis.controlType = "+(control["data-type"]?'"'+control["data-type"]+'"':"null")+";\n"+self.buildCodeForDefaultProperties(control.design.properties)+self.buildCodeForDesignValueProperties(control)+self.buildCodeForRequiredProperties(control.design.properties)+self.buildCodeForRequiredDependentProperties(control.design.properties)+"}, \n\ngetRenderingProperties: function ( ) {\nvar self = this;\nvar defer = $.Deferred();\nvar result = this._super();\n"+self.buildCodeForRenderingModel(control)+"$.when.apply($, self.asyncProperties).done(function(){ defer.resolve(result);}) \nreturn defer.promise();\n},\n\ngetRibbonProperties: function ( ) {\nvar self = this;\nvar result = [];\n"+self.buildCodeForRibbonProperties(control)+"return result;\n},\n\ngetLocalizableProperties: function ( ) {\nvar self = this;\nvar result = [];\n"+self.buildCodeForLocalizableProperties(control)+"return result;\n},\n\ngetPropertiesTypeForm: function ( ) {\nvar self = this;\nvar result = [];\n"+self.buildCodeForFormProperties(control.design.properties)+"return result;\n},\n\ngetPropertiesTypeSearchForm: function ( ) {\nvar self = this;\nvar result = [];\n"+self.buildCodeForSearchFormProperties(control.design.properties)+"return result;\n},\n\n})\n";try{eval(code),eval(className).propertyModel=new bizagi.editor.component.properties.model(control),eval(className).decoratorModel=bizagi.editor.component.decorator.model.getSpecificModel(control),eval(className).contextMenuModel=new bizagi.editor.component.contextmenu.model(control.design.visual["context-menu"],controlsToConvert),eval(className).convertToModel=controlsToConvert,eval(className)["widget-guid"]="userfield"===control.rendertype?control.guid:null}catch(e){return console.warn(e),"bizagi.editor.label"}return className},addWidgetsControls:function(e){var t=this;$.each(e,function(e,i){var n=t.createClassForControl(i,[]);t.classes[i.name]=n})},buildCodeForRenderingModel:function(e){var t="";for(var i in e.runtime.properties){var n=e.runtime.properties[i];if(n.designvalue){var o=n.designvalue,r=this.Class.designValueRegex.exec(o);if(r){var a=r[1].replace(/:/g,".");this.isLocalizableProperty(e,a)?t+=this.resolvePropertyLocalizable(e,n.name,a):this.isOrientationProperty(e,n.name)?t+=this.resolveOrientationProperty(e,n.name,a):t+='result["'+n.name+'"] = self.resolveProperty("'+a+'");\n'}else"object"==typeof n.designvalue?t+='result["'+n.name+"\"] = JSON.parse('"+JSON.encode(n.designvalue)+"');\n":"string"==typeof n.designvalue&&-1!==n.designvalue.indexOf('"')?t+='result["'+n.name+'"] = '+JSON.encode(n.designvalue)+";\n":t+='result["'+n.name+'"] = "'+n.designvalue+'";\n'}}return t},buildCodeForRibbonProperties:function(e){var t="";return $.each(["visible","editable","required"],function(i,n){e.design.properties[n]&&(t+='result.push("'+n+'");\n')}),t},buildCodeForLocalizableProperties:function(e){var t="";for(var i in e.design.properties){var n=e.design.properties[i];"localizable-string"!==n["bas-type"]&&"localizablestring"!==n["bas-type"]&&"displayName"!==n["bas-type"]||(t+='result.push("'+i+'");\n')}return t},buildCodeForFormProperties:function(e,t){var i="";for(var n in t=t||"",e){var o=e[n];"form"===o["bas-type"]?i+='result.push("'+t+n+'");\n':o.subproperties&&(i+=this.buildCodeForFormProperties(o.subproperties,n+"."))}return i},buildCodeForSearchFormProperties:function(e,t){var i="";for(var n in t=t||"",e){var o=e[n];"searchform"===o["bas-type"]?i+='result.push("'+t+n+'");\n':o.subproperties&&(i+=this.buildCodeForSearchFormProperties(o.subproperties,n+"."))}return i},buildCodeForDesignValueProperties:function(e){var t="",i={};for(var n in e.runtime.properties){var o=e.runtime.properties[n].designvalue;if(o){var r=this.Class.designValueRegex.exec(o);if(r){var a=r[1].split(":")[0];i[a]||(t+='self.designValueProperties["'+a+'"] = true;\n',i[a]=!0)}}}return t},isLocalizableProperty:function(e,t){var i;return void 0!==(i=e.design.properties[t])&&("localizable-string"===i["bas-type"]||"localizablestring"===i["bas-type"]||"displayName"===i["bas-type"])},isOrientationProperty:function(e,t){var i;return void 0!==(i=e.design.properties[t])&&"orientation"===i["bas-type"]},resolvePropertyLocalizable:function(e,t,i){return"displayName"===t?'$.when(self.resolveDisplayNameProperty("'+i+'")).done(function(value){result["'+t+'"] = value;}); \n':'result["'+t+'"] = self.resolveI18nProperty("'+i+'"); \n'},resolveOrientationProperty:function(e,t,i){return'result["'+t+'"] = self.resolveIsRightToLeftProperty("'+i+'"); \n'},buildCodeForDefaultProperties:function(e,t){var i="";for(var n in e){var o=e[n],r=t?t+"."+n:n;o.default&&("object"==typeof o.default?i+='self.defaultValues["'+r+"\"] =  JSON.parse('"+this.getDefaultValueProperty(o.default)+"');\n":i+='self.defaultValues["'+r+"\"] = '"+o.default+"';\n",i+='self.assignDefaultProperty("'+r+'",  self.defaultValues["'+r+'"]);\n'),o.subproperties&&(i+=this.buildCodeForDefaultProperties(o.subproperties,r))}return i},buildCodeForRequiredProperties:function(e,t){var i="";for(var n in e){var o=e[n];o.required&&(i+='self.requiredProperties["'+(n=t?t+"."+n:n)+"\"] = '"+o.required+"';\n"),o.subproperties&&(i+=this.buildCodeForRequiredProperties(o.subproperties,n))}return i},buildCodeForRequiredDependentProperties:function(e,t){var i="";for(var n in e){var o=e[n];if(o.dependencies&&this.isRequiredDependentProperty(o)&&(i+='self.requiredDependentProperties["'+(n=t?t+"."+n:n)+"\"] = JSON.parse('"+JSON.encode(o.dependencies.conditions)+"');\n"),o["editor-parameters"]){var r=o["editor-parameters"];for(var a in r){var s=r[a];r.hasOwnProperty(a)&&("string"==typeof s&&s.indexOf("<design:xpath")>-1&&(i+=t?'self.xpathProperties.push("'+t+"."+n+'");\n':'self.xpathProperties.push("'+n+'");\n'))}}o.subproperties&&(i+=this.buildCodeForRequiredDependentProperties(o.subproperties,n))}return i},getDefaultValueProperty:function(e){return"object"==typeof e?JSON.encode(e):e},createElement:function(name,data,regenerateGuid){var self=this;if(!self.classes[name])return console.warn("No control definition found for type: "+name),new bizagi.editor.render.generic(data,this);var fn=eval("var bafn = function(data, elementFactory, regenerateGuid) {  var element = new "+self.classes[name]+"(data, elementFactory, regenerateGuid); return element;};bafn");return fn(data,this,regenerateGuid)},canMapToOffline:function(e){return Boolean(this.classes[e])},createColumnElement:function(e,t,i){return this.classes[e]?this.createElement(e,t,i):(console.warn("No control definition found for column type: "+e),new bizagi.editor.column.generic(t,this,i))},isRequiredDependentProperty:function(e){var t=!1,i=e.dependencies;return i&&i.actions&&i.actions.required&&(t=!0),t}}),bizagi.editor.base.render.extend("bizagi.editor.base.grid",{relatedEntityType:{entityType:void 0}},$.extend({},bizagi.editor.base.containerBehaviour,bizagi.editor.base.containerValidations,{init:function(e,t,i){var n=this,o=n.elements=[];this._super(e,t,i),e&&e.elements&&$.each(e.elements,function(e,t){var r=n.elementFactory.createColumnElement(t.type,t,i);r.setParent(n),o.push(r)})},getRenderingModel:function(){var e=$.Deferred(),t=this._super();return $.when.apply($,$.map(this.elements,function(e){return e.getRenderingModel()})).done(function(){var i=$.makeArray(arguments);$.when(t).done(function(t){t.render.elements=i,e.resolve(t)})}),e.promise()},getPreviewOfflineRenderingModel:function(){var e=$.Deferred(),t=this._super();return $.when.apply($,$.map(this.elements,function(e){return e.getPreviewOfflineRenderingModel()})).done(function(){var i=$.makeArray(arguments).filter(Boolean);$.when(t).done(function(t){t&&(t.render.properties=Object.assign({},t.render.properties,{allowDetail:!1}),t.render.elements=i),e.resolve(t)})}),e.promise()},getMissingOfflineControls:function(e){var t=$.Deferred();return this._super(e),$.when.apply($,$.map(this.elements,function(t){return t.getMissingOfflineControls(e)})).done(function(){t.resolve(e)}),t.promise()},ready:function(){return $.when.apply($,$.map(this.elements,function(e){return e.ready()}).concat(this._super()))},getPersistenceModel:function(){var e=this._super();return e.elements=[],$.each(this.elements,function(t,i){e.elements.push(i.getPersistenceModel())}),e},getGridColumnModel:function(){var e,t=$.Deferred(),i=this._super();return $.when.apply($,$.map(this.elements,function(e){return e.getGridColumnModel()})).done(function(){e=arguments,$.when(i).done(function(i){i.elements=$.makeArray(e),t.resolve(i)})}),t.promise()},removeLocalization:function(e){var t=(e=this._super(e)).gridvalidations;if("object"==typeof t){var i=t.validations;i=i.map(function(e){return e.message={i18n:{uri:e.message.i18n.uri}},e}),t.validations=i,e.gridvalidations=t}return e},getLocalizablePropertiesModel:function(e){var t=this,i=this._super(e),n=t.resolveProperty("gridvalidations");n&&"object"==typeof n&&(bizagi.clone(n.validations)||[]).forEach(function(n){var o=n.message.i18n;"object"==typeof o&&i.push(t.getChangesetResourceObject(o,"message",e))});return $.each(t.elements,function(t,n){i=i.concat(n.getLocalizablePropertiesModel(e))}),i},updateLocalizableProperties:function(e){var t=this;t._super(e);t.properties;var i="gridvalidations",n=t.resolveProperty(i);if("object"==typeof n){var o=n.validations||[];o=o.map(function(n){var o=n.message&&n.message.i18n;return"object"==typeof o&&(o=t.triggerGlobalHandler("getLocalizationObject",{i18n:o,newUri:t.guid+":"+i,regenerateGuid:e}),n.message.i18n=o),n}),n.validations=o,t.assignProperty(i,n)}},restoreDefaultDisplayName:function(){this._super(),$.each(this.elements,function(e,t){t.restoreDefaultDisplayName()})},deleteColumns:function(){this.elements=[]},validAttributesAdministrables:function(e){var t=!0;if(this.isEditable())if(this.isParametricAttribute(e)){var i="parameter"==this.triggerGlobalHandler("getContextEntityType")?bizagi.localization.getResource("bizagi-editor-form-validation-parameter-attribute-parameter-entity"):bizagi.localization.getResource("bizagi-editor-form-validation-parameter-attribute-entity");this.messageValidation=this.messageValidation||"",this.messageValidation+=i+"</br>",t=!1}else{e=bizagi.editor.utilities.resolveComplexXpath(this.properties.xpath)+".";for(var n=0,o=this.elements.length;n<o;n++)t&=this.elements[n].validAttributesAdministrables(e)}return t},validAttributesNoEditables:function(){var e=this,t=new $.Deferred;if("adhocgrid"==e.type)return t.resolve(!0),t.promise();var i,n=e.resolveProperty("xpath");if(e.isEditable()){var o="system"==e.triggerGlobalHandler("getContextEntityType"),r=e.triggerGlobalHandler("getNodeInfo",{root:!0})||{};if(o&&"WFUSER"==r.xpath){var a=bizagi.localization.getResource("bizagi-editor-form-validation-attribute-no-administrable");e.messageValidation=e.messageValidation||"",e.messageValidation+=a+"</br>",t.resolve(!1)}else if(n){$.when((i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getentitytype",entityGuid:bizagi.editor.utilities.resolveRelatedEntityFromXpath(n)}),null!=e.Class.relatedEntityType.entityType?e.Class.relatedEntityType:i.processRequest())).done(function(i){e.Class.relatedEntityType.entityType=i.entityType;var n="Parameter"===i.entityType||"Enum"===i.entityType;if(n){var o=bizagi.localization.getResource("bizagi-editor-form-validation-attribute-no-editable");e.messageValidation=e.messageValidation||"",e.messageValidation+=o+"</br>"}t.resolve(!n)})}else t.resolve(!0)}else t.resolve(!0);return t.promise()},updateSubmitVersionProperty:function(){(this.elements||[]).forEach(function(e){e.updateSubmitVersionProperty()})}})),bizagi.editor.base.render.extend("bizagi.editor.base.internal",{},{init:function(e,t,i){this._super(e,t,i)},getRenderingProperties:function(){var e=this._super();return e.isInternal=!0,e},isInternal:function(){return!0}}),bizagi.editor.base.container.extend("bizagi.editor.base.nestedform",{},{init:function(e,t,i){this._super(e,t,i),this.mappingService=bizagi.editor.base.mappingform,this.elementFactory=t,this.initilizeData()},initilizeData:function(){this.loadDeferred=new $.Deferred,this.refreshDeferred=new $.Deferred,this.loading=!0,this.message="loading...",this.elements=[],this.formdisplayName=this.properties.displayName,setTimeout(this.loadNestedFormElements.bind(this),10)},loadNestedFormElements:function(){var e=this.properties.form;this.loadForm(e)},loadForm:function(e){var t,i=this;i.hashResources={},i.catalogServices.getByIdWithChildren("Resource",i.utilities.resolveComplexReference(e)).then(function(e){return t=e[0],i.catalogServices.processContentForm(t.content)}).then(function(e){(t.children||[]).forEach(function(e){var t=e.content;i.hashResources[t.uri]={id:e.id,content:t}});var n=i.triggerGlobalHandler("getDeviceInfo",{});return n&&n.isSpecific&&e.deviceType!=n.deviceType?n.isOffline?n.isSpecific?i.cloneService.buildOfflineForm({form:e}).then(function(e){return i.mappingService.mappingForm(e.form,n.deviceType)}):i.cloneService.buildOfflineForm({form:e}).then(function(e){return e.form}):i.mappingService.mappingForm(e,n.deviceType):e}).then(function(e){i.formdisplayName=i.getDisplayNameForm(e),i.processNestedFormElements(e)})},processForm:function(e){return new Promise(function(t){var i={actiontype:"ProcessFormContent",parameters:[{key:"formContent",value:JSON.stringify(e.content)}]};$.when(bizagi.editor.base.services.resourcesServices.getResource(i)).done(function(i){e.content=JSON.parse(i.result.parameters[0].value),t(e)})})},getDisplayNameForm:function(e){var t=e.properties.displayName,i="Form_"+e.guid;if(t&&t.i18n&&t.i18n.uri){var n=this.hashResources[t.i18n.uri],o=n&&n.content;i=o&&o.defaultValue||i}return i},getLocalizablePropertiesModel:function(){return[]},processNestedFormElements:function(e){var t=this;e&&e.elements&&$.each(e.elements,function(e,i){var n=t.elementFactory.createElement(i.type,i);n.setParent(t),t.elements.push(n)}),$.when(t.loadDeferred).done(function(){t.loading=!1;var e=t.getNestedFormContainer();e?$.when(e.loaded()).done(function(){t.refreshForm()}):t.refreshForm()}),setTimeout(function(){t.loadDeferred.resolve()},100)},refreshForm:function(){var e=this;$.when(e.getRenderingModel()).done(function(t){setTimeout(function(){$.when(e.triggerGlobalHandler("formIsLoaded",null)).done(function(){e.triggerGlobalHandler("refreshElement",t),e.refreshDeferred.resolve()})},100)})},getResourceByUri:function(e){return self.hashResources[e.uri]},getLocalizationObject:function(e){var t=this.hashResources[e.uri];if(!t)return e;var i=t.content,n={};return(i.languages||[]).forEach(function(e){n[e.Code]=e.Value}),{uri:i.uri,default:i.defaultValue.replace(/\\\\/g,"\\").replace(/\\\"/g,'"'),languages:n}},loaded:function(){return this.refreshDeferred.promise()},ready:function(){var e=this._super();return $.when(e,this.loadDeferred)},getRenderingModel:function(){var e=this,t=$.Deferred();return $.when(this._super()).done(function(i){i.container.properties.loading=e.loading,i.container.properties.message=e.message,t.resolve(i)}),t.promise()},getPersistenceModel:function(){return{elements:[],type:this.type,guid:this.guid,properties:this.filterDefaultValues(this.properties)}},getRenderingProperties:function(){var e=this._super();return e.formDisplayName=this.formdisplayName,e},resolveDisplayNameProperty:function(){return"Nested form : "+this.formdisplayName},validAttributesAdministrables:function(){var e=!0;if(this.isEditable())for(var t=bizagi.editor.utilities.resolveComplexXpath(this.properties.xpath)+".",i=0,n=this.elements.length;i<n;i++)e&=this.elements[i].validAttributesAdministrables(t);return e},updateRelatedFormProperty:function(e,t){var i=this;$.when(this.loaded()).done(function(){i.initilizeData()})}}),bizagi.editor.base.render.extend("bizagi.editor.base.collectionnavigator",{},{init:function(e,t,i){this.validateData(e),this._super(e,t,i),this.elementFactory=t,this.form=null,this.defer=new $.Deferred,this.properties.navigationform&&this.loadForm()},loadForm:function(){var e,t=this;e=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"loadform",form:t.properties.navigationform}),$.when(e.processRequest()).done(function(e){t.hashResources={},e.resources.forEach(function(e){t.hashResources[e.uri]={id:e.Id,content:e}}),t.form=t.elementFactory.createElement("form",e.form),t.form.subscribe("getDefaultDisplayName",function(e,i){return t.triggerGlobalHandler("getDefaultDisplayName",i)}),t.form.subscribe("getLocalizationObject",function(e,i){return t.getLocalizationObject(i)}),t.defer.resolve()})},getLocalizationObject:function(e){var t=e.i18n,i=this.hashResources[t.uri];if(!i)return t;var n=i.content,o={};return(n.languages||[]).forEach(function(e){o[e.code]=e.value}),{uri:i.uri,default:n.DefaultValue,languages:o}},refreshControl:function(e){var t=this,i=e.canvas;$.when(t.form.getRenderingModel()).done(function(e){t.addRenderingModelProperties(e);var n=t.getRenderingFacade();$.when(n.execute({mode:"design",canvas:i,data:e})).done(function(){t.triggerGlobalHandler("resizeHeigthCanvas")})})},getRenderingModel:function(){var e=this,t=$.Deferred();return $.when(this._super()).done(function(i){i.render.properties.navigationform=e.properties.navigationform,t.resolve(i)}),t.promise()},getPersistenceModel:function(){return{elements:[],type:this.type,guid:this.guid,properties:this.filterDefaultValues(this.properties)}},getRenderingFacade:function(){return this.rendering=this.rendering||new bizagi.rendering.facade,this.rendering},addRenderingModelProperties:function(e){return e.form.properties.isNavigationForm=!0,e},validateData:function(e){e.elements&&delete e.elements}}),bizagi.editor.observableClass.extend("bizagi.editor.base.protocol.base",{},{init:function(e){this._super(),this.args=e,this.context=e.context,this.parameters=[],this.answerParameters=[],this._ResourcesServices=bizagi.editor.base.services.resourcesServices,this._editorInfo=bizagi.editor.base.info},processRequest:function(){var e,t=this,i=new $.Deferred;t.buildRequest(),t.parameters.push(t.createParameterItem("guidContext",BIZAGI_IDENTIFIER_MODEL)),t.parameters.push(t.createParameterItem("user",BIZAGI_USER)),e=t.requestForBAS();var n=t.callRestService(e)||bizagi.editor.base.HostFacade.executeBasActions(e);return $.when(n).done(function(e){i.resolve(t.processBasAnswer(e))}).fail(function(e){bizagi.showMessageBox(bizagi.localization.getResource("confirmation-savebox-message-error")),i.reject()}),i.promise()},processBasAnswer:function(e){return e},createParameterItem:function(e,t){var i={};return i.key=e,i.value=t,i},requestForBAS:function(){var e={};return e.actiontype=this.actiontype,e.parameters=this.parameters,e},buildRequest:function(){this.parameters=[]},callRestService:function(e){return"adhocform"==this.context?this._ResourcesServices.getResource(e):!this._editorInfo.isCloud()&&this._ResourcesServices.getResource(e)},findKeyInParameters:function(e){for(var t=null,i=0,n=this.answerParameters.length;i<n;i+=1)this.answerParameters[i].key===e&&(t=this.answerParameters[i]);return t}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.ruleexpression",{},{init:function(e){this._super(e),this.rule=this.args.data.rule||this.args.data,this.actiontype="LoadExpression"},buildRequest:function(){var e=this;e.parameters=[],e.parameters.push(e.createParameterItem("categorytype",e.args.categorytype)),e.isNewExpression()||e.parameters.push(e.createParameterItem("id",e.rule.baref.ref)),e.args.idcontextentity&&e.parameters.push(e.createParameterItem("idcontextentity",e.args.idcontextentity))},isNewExpression:function(){return"expression"===this.rule.baref.ref},processBasAnswer:function(e){var t,i=this.args,n=e.result;if(n.success){if(this.answerParameters=n.parameters,t=this.findKeyInParameters("id"),bizagi.util.isEmpty(t.value))return{isEmpty:!0};var o=this.findKeyInParameters("displayname")&&this.findKeyInParameters("displayname").value||null;return"rule"==i.editor?bizagi.editor.utilities.buildComplexReference(t.value,o):this.buildRuleDefinition(t.value,o)}},buildRuleDefinition:function(e,t){var i={rule:{baref:{ref:e}}};return t&&(i.rule.displayName=t),i}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.localizableresources",{},{init:function(e){this._super(e),this.actiontype="GetLocalizationProperties"},buildRequest:function(){var e=this.args;this.parameters=[],this.parameters.push(this.createParameterItem("id",e.id)),this.parameters.push(this.createParameterItem("isSpecific",e.isSpecific))},processBasAnswer:function(e){var t,i=e.result;return i.success?(this.answerParameters=i.parameters,t=this.findKeyInParameters("resources"),JSON.parse(t.value)):i.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.loadinterface",{},{init:function(e){this._super(e),this.interface=this.args.data.interface||this.args.data,this.actiontype="LoadInterface"},buildRequest:function(){var e=this;e.parameters=[],e.isNewExpression()||e.parameters.push(e.createParameterItem("id",e.interface.baref.ref)),e.args.idcontextentity&&e.parameters.push(e.createParameterItem("idcontextentity",e.args.idcontextentity)),e.args.idscopedefinition&&e.parameters.push(e.createParameterItem("idscopedefinition",e.args.idscopedefinition)),e.parameters.push(e.createParameterItem("targetForm",e.args.idForm))},isNewExpression:function(){return"expression"===this.interface.baref.ref},processBasAnswer:function(e){var t,i=e.result;if(i.success){if(this.answerParameters=i.parameters,t=this.findKeyInParameters("id"),bizagi.util.isEmpty(t.value))return{isEmpty:!0};var n=this.findKeyInParameters("displayname")&&this.findKeyInParameters("displayname").value||null;return this.args.type.indexOf("rule")>=0?bizagi.editor.utilities.buildComplexReference(t.value,n):this.buildRuleDefinition(t.value,n)}},buildInterfaceDefinition:function(e,t){var i={baref:{ref:e}};return t&&(i.displayName=t),i}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.loadtemplate",{},{init:function(e){this._super(e),this.template=this.args.template,this.actiontype="LoadTemplate"},buildRequest:function(){this.parameters=[],this.isNewTemplate()||this.parameters.push(this.createParameterItem("id",this.template.baref.ref))},isNewTemplate:function(){return"template"===this.template.baref.ref},processBasAnswer:function(e){var t,i=e.result;return i.success?(this.answerParameters=i.parameters,t=this.findKeyInParameters("id"),bizagi.util.isEmpty(t.value)?{isEmpty:!0}:bizagi.editor.utilities.buildComplexReference(t.value)):i.sucess}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.loadsapinterface",{},{init:function(e){this._super(e),this.interface=this.args.data.interface||this.args.data,this.actiontype="LoadSapInterface"},buildRequest:function(){var e=this;e.parameters=[],e.isNewExpression()||e.parameters.push(e.createParameterItem("id",e.interface.baref.ref)),e.args.idcontextentity&&e.parameters.push(e.createParameterItem("idcontextentity",e.args.idcontextentity)),e.args.idscopedefinition&&e.parameters.push(e.createParameterItem("idscopedefinition",e.args.idscopedefinition))},isNewExpression:function(){return"expression"===this.interface.baref.ref},processBasAnswer:function(e){var t,i=e.result;if(i.success){if(this.answerParameters=i.parameters,t=this.findKeyInParameters("id"),bizagi.util.isEmpty(t.value))return{isEmpty:!0};var n=this.findKeyInParameters("displayname")&&this.findKeyInParameters("displayname").value||null;return this.args.type.indexOf("rule")>=0?bizagi.editor.utilities.buildComplexReference(t.value,n):this.buildRuleDefinition(t.value,n)}},buildInterfaceDefinition:function(e,t){var i={baref:{ref:e}};return t&&(i.displayName=t),i}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.loadconnectorinterface",{},{init:function(e){this._super(e),this.connector=this.args.data.connector||this.args.data,this.actiontype="LoadConnectorInterface"},buildRequest:function(){var e=this;e.parameters=[],e.isNewExpression()||e.parameters.push(e.createParameterItem("id",e.connector.baref.ref)),e.args.idcontextentity&&e.parameters.push(e.createParameterItem("idcontextentity",e.args.idcontextentity)),e.parameters.push(e.createParameterItem("targetForm",e.args.idForm))},isNewExpression:function(){return"expression"===this.connector.baref.ref},processBasAnswer:function(e){var t,i=e.result;if(i.success){if(this.answerParameters=i.parameters,t=this.findKeyInParameters("id"),bizagi.util.isEmpty(t.value))return{isEmpty:!0};var n=this.findKeyInParameters("displayname")&&this.findKeyInParameters("displayname").value||null;return this.args.type.indexOf("rule")>=0?bizagi.editor.utilities.buildComplexReference(t.value,n):this.buildRuleDefinition(t.value,n)}},buildInterfaceDefinition:function(e,t){var i={baref:{ref:e}};return t&&(i.displayName=t),i}}),bizagi.editor.base.protocol.loadconnectorinterface.extend("bizagi.editor.base.protocol.loadexcelbotinterface",{},{init:function(e){this._super(e),this.connector=this.args.data.connector||this.args.data,this.actiontype="LoadExcelBot"}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.loadfilter",{},{init:function(e){this._super(e),this.actiontype="LoadFilterEditor",this.bafilter=this.args.data.bafilter,this.xpathNode=this.args.xpathNode},buildRequest:function(){var e,t,i=this;i.parameters=[],i.isNewExpression()||(e=i.createParameterItem("filter",bizagi.util.unicode2htmlencode(i.bafilter.filter)),i.parameters.push(e)),i.args.idcontextentity&&i.parameters.push(i.createParameterItem("idcontextentity",i.args.idcontextentity)),t=i.createParameterItem("idrelatedentity",i.xpathNode.guidRelatedEntity),i.parameters.push(t)},isNewExpression:function(){return"filter"===this.bafilter.filter},processBasAnswer:function(e){var t,i=e.result;return i.success?(this.answerParameters=i.parameters,t=this.findKeyInParameters("filter"),bizagi.util.isEmpty(t.value)?{isEmpty:!0}:t.value):i.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.loadform",{},{init:function(e){this._super(e),this.actiontype="LoadForm",this.params=e},buildRequest:function(){var e=this,t=e.params,i=e.createParameterItem("id",bizagi.editor.utilities.resolveComplexReference(t.form));e.parameters=[],e.parameters.push(i),t.loadByParent&&e.parameters.push(e.createParameterItem("loadByParent",t.loadByParent)),t.adhocProcessId&&t.isAdhocSummaryForm&&(e.parameters.push(e.createParameterItem("adhocProcessId",t.adhocProcessId)),e.parameters.push(e.createParameterItem("isAdhocSummaryForm",t.isAdhocSummaryForm)))},processBasAnswer:function(e){var t=e.result;if(t.success){this.answerParameters=t.parameters;var i=this.findKeyInParameters("resources");return i=i&&JSON.parse(i.value),{form:JSON.parse(this.findKeyInParameters("form").value),resources:i||{}}}return!1}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.gettags",{},{init:function(e){this._super(e),this.actiontype="GetTags"},buildRequest:function(){this.parameters=this.args.parameters||[]},processBasAnswer:function(e){var t=e.result;return t.success?t.parameters:t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getmetadata",{context:/\.(\w+)$/},{init:function(e){this._super(e),this.actiontype="GetMetadata"},buildRequest:function(){this.parameters=[];var e=this.Class.context.exec(this.args.xpath),t=e?e[1]:"";this.parameters.push(this.createParameterItem("context",t))},processBasAnswer:function(e){var t,i=e.result;return i?i.success?(this.answerParameters=i.parameters,t=this.findKeyInParameters("data"),JSON.parse(t.value)):i.success:e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.opennestedform",{},{init:function(e){this._super(e),this.actiontype="OpenNestedForm"},buildRequest:function(){var e=this,t=e.args;e.parameters=[],e.parameters.push(e.createParameterItem("id",t.refForm.baref.ref)),e.parameters.push(e.createParameterItem("guidRender",t.idForm)),void 0!==t.deviceId&&e.parameters.push(e.createParameterItem("deviceId",t.deviceId)),void 0!==t.device&&e.parameters.push(e.createParameterItem("device",t.device)),void 0!==t.deviceType&&e.parameters.push(e.createParameterItem("deviceType",t.deviceType))}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.relatedentity",{},{init:function(e){this._super(e),this.actiontype="LoadEntityValues",this.xpath=bizagi.editor.utilities.resolveComplexXpath(e.xpath)},buildRequest:function(){var e;this.parameters=[],e=this.createParameterItem("xpath",this.replaceFilterCollectionInXpath()),this.parameters.push(e)},processBasAnswer:function(e){var t;if(!e)return{};var i=e.result;return i.success?(this.answerParameters=i.parameters,(t=this.findKeyInParameters("values"))?this.transformResult(JSON.parse(t.value)):{}):i.success},replaceFilterCollectionInXpath:function(){return this.args.xpath.replace("[]","")},transformResult:function(e){for(var t={},i=0,n=e.length;i<n;i+=1)t[e[i].id]=e[i].displayName;return t}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.createform",{},{init:function(e){this._super(e),this.actiontype="CreateForm"},buildRequest:function(){var e=this;e.parameters=[],e.args.xpath&&e.parameters.push(e.createParameterItem("xpath",e.args.xpath)),e.args.relatedEntity&&e.parameters.push(e.createParameterItem("relatedEntity",e.args.relatedEntity)),e.args.isScopeAttribute&&e.parameters.push(e.createParameterItem("isScopeAttribute",e.args.isScopeAttribute)),e.args.showForm&&e.parameters.push(e.createParameterItem("showForm",e.args.showForm)),e.parameters.push(e.createParameterItem("guidRender",e.args.guid)),e.parameters.push(e.createParameterItem("propertyName",e.args.propertyName)),e.parameters.push(e.createParameterItem("context",e.args.context)),e.parameters.push(e.createParameterItem("deviceId",e.args.deviceId))}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.multilanguage",{},{init:function(e){this._super(e),this.actiontype="LoadLocalizationForm"},buildRequest:function(){var e;this.parameters=[],e=this.createParameterItem("values",bizagi.util.unicode2htmlencode(JSON.stringify(this.args.i18n))),this.parameters.push(e)},processBasAnswer:function(e){var t,i=e.result;return i.success?(this.answerParameters=i.parameters,t=this.findKeyInParameters("localization"),JSON.parse(t.value)):i.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.relatedforms",{},{init:function(e){this._super(e),this.actiontype="GetReleatedEntityForms"},buildRequest:function(){var e=this;e.parameters=[],e.args.xpath&&e.parameters.push(e.createParameterItem("xpath",e.args.xpath)),e.args.relatedEntity&&e.parameters.push(e.createParameterItem("relatedEntity",e.args.relatedEntity)),e.args.isScopeAttribute&&e.parameters.push(e.createParameterItem("isScopeAttribute",e.args.isScopeAttribute)),e.parameters.push(e.createParameterItem("context",e.args.context))},processBasAnswer:function(e){var t,i=e.result;return i?i.success?(this.answerParameters=i.parameters,t=this.findKeyInParameters("forms"),JSON.parse(t.value)):i.success:e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.gridvalidations",{},{init:function(e){this._super(e),this.actiontype="LoadGridValidations"},buildRequest:function(){var e=this;e.parameters=[],e.parameters.push(e.createParameterItem("xpath",e.args.xpath)),e.parameters.push(e.createParameterItem("guidRender",e.args.guidRender)),bizagi.editor.utilities.isObject(e.args.gridValidations)&&e.args.gridValidations.validations&&e.parameters.push(e.createParameterItem("validations",bizagi.util.unicode2htmlencode(JSON.stringify(e.args.gridValidations))))},processBasAnswer:function(e){var t=e.result;if(!t)return e;if(t.success){this.answerParameters=t.parameters;var i=this.findKeyInParameters("validations");return JSON.parse(i.value)}return t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getcontrolsdefinitions",{},{init:function(e){this._super(e),this.actiontype="GetControlDefinitions"},buildRequest:function(){var e=bizagi.editor.base.constants.DEVICES,t=this.args;this.parameters=[];var i="Desktop";if(t.deviceType)switch(t.deviceType){case e.DESKTOP:i="Desktop";break;case e.SMARTPHONE:i="Smartphone";break;case e.TABLET:i="Tablet";break;case e.OFFLINE:i="Offline";break;case e.OFFLINE_TABLET:i="Offline_Tablet";break;case e.OFFLINE_SMARTPHONE:i="Offline_Smartphone"}t.isSpecific&&this.parameters.push(this.createParameterItem("viewType",i))},processBasAnswer:function(e){var t=e.result;if(t.success){this.answerParameters=t.parameters;var i=JSON.parse(this.findKeyInParameters("definitions").value);if("startform"===this.context){var n=["actionlauncher","polymorphiclauncher"];i.controls=i.controls.filter(function(e){return!n.includes(e.name)})}return i}return t.success},processRequest:function(){var e=new $.Deferred;return $.when(bizagi.editor.base.protocol.base.prototype.processRequest.apply(this,arguments)).done(function(t){e.resolve(t)}),e.promise()}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getlayoutsdefinitions",{},{init:function(e){this._super(e),this.actiontype="GetLayoutDefinitions"},processBasAnswer:function(e){var t=e.result;return t.success?(this.answerParameters=t.parameters,JSON.parse(this.findKeyInParameters("layouts").value)):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getentitytype",{},{init:function(e){this._super(e),this.actiontype="GetEntityType"},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("EntityGuid",this.args.entityGuid))},processBasAnswer:function(e){var t=e.result;return t?t.success?(this.answerParameters=t.parameters,{entityType:this.findKeyInParameters("entityType").value}):t.success:e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.entityvaluepicker",{},{init:function(e){this._super(e),this.actiontype="EntityValuePicker",this.contextEntityId=e.contextEntityId,this.xpath=e.xpath},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("contextentityid",this.args.contextEntityId)),this.parameters.push(this.createParameterItem("xpath",this.replaceFilterCollectionInXpath()))},replaceFilterCollectionInXpath:function(){return this.args.xpath.replace("[]","")},processBasAnswer:function(e){var t={};if(e&&e.result&&e.result.parameters.length)if(t.success=e.result.success,this.answerParameters=e.result.parameters,e.result.success){var i=$.parseJSON(this.findKeyInParameters("selectedValue").value);t.key="selectedValue",t.businessKeyValues=i.businesskeyvalues,t.label=i.displaytext,t.contextEntity=i.contextentity,t.surrogateKeyGuid=i.surrogateKeyGuid}else t.key="noParameter",t.value=this.findKeyInParameters("noParameter").value;else t.key="cancel";return t}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getdependency",{},{init:function(e){this._super(e),this.actiontype="GetDependency"},processBasAnswer:function(e){var t=e.result;return t?t.success?(this.answerParameters=t.parameters,bizagi.util.parseBoolean(this.findKeyInParameters("canBeChanged").value)):t.success:e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getfirstload",{},{init:function(e){this._super(e),this.actiontype="XpathNavigatorFirstLoad"},buildRequest:function(){this.parameters=[],this.args.adhocProcessId&&this.parameters.push(this.createParameterItem("adhocProcessId",this.args.adhocProcessId))},processBasAnswer:function(e){var t=e.result;return t.success?(this.answerParameters=t.parameters,JSON.parse(this.findKeyInParameters("root").value)):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getchildrennodes",{},{init:function(e){this._super(e),this.actiontype="XpathNavigatorExpandLoad"},buildRequest:function(){var e=this,t=e.args.node,i=t.xpath;t.isRootNode&&(i=""),e.parameters=[],e.parameters.push(e.createParameterItem("contextScope",t.contextScope)),e.parameters.push(e.createParameterItem("guid",t.guidRelatedEntity)),e.parameters.push(e.createParameterItem("xpath",i)),e.parameters.push(e.createParameterItem("style",t.style)),e.parameters.push(e.createParameterItem("isScopeAttribute",t.isScopeAttribute)),t.entityContext&&e.parameters.push(e.createParameterItem("entityContext",t.entityContext)),t.xpathAdhoc&&e.parameters.push(e.createParameterItem("xpathAdhoc",t.xpathAdhoc))},processBasAnswer:function(e){var t=e.result;return t.success?(this.answerParameters=t.parameters,JSON.parse(this.findKeyInParameters("children").value)):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.selectprocess",{},{init:function(e){this._super(e),this.actiontype="SelectProcess"},buildRequest:function(){},processBasAnswer:function(e){}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.editentity",{},{init:function(e){this._super(e),this.actiontype="LoadEditEntity"},buildRequest:function(){var e;this.parameters=[],e=this.createParameterItem("id",this.args.id),this.parameters.push(e)},processBasAnswer:function(e){if(e&&e.result)return e.result.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.openform",{},{init:function(e){this._super(e),this.actiontype="OpenForm"},buildRequest:function(){var e=this,t=e.args;e.parameters=[],e.parameters.push(e.createParameterItem("id",t.idform)),void 0!==t.deviceId&&e.parameters.push(e.createParameterItem("deviceId",t.deviceId)),void 0!==t.device&&e.parameters.push(e.createParameterItem("device",t.device)),void 0!==t.isSpecific&&e.parameters.push(e.createParameterItem("isSpecific",t.isSpecific)),void 0!==t.deviceType&&e.parameters.push(e.createParameterItem("deviceType",t.deviceType)),null!=t.renderId&&e.parameters.push(e.createParameterItem("renderId",t.renderId)),null!=t.propertyName&&e.parameters.push(e.createParameterItem("propertyName",t.propertyName)),null!=t.context&&e.parameters.push(e.createParameterItem("context",t.context))}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.saveform",{},{init:function(e){this._super(e),this.actiontype="SaveForm"},buildRequest:function(){var e=this,t=e.args;e.parameters=[],e.args.jsonForm&&e.parameters.push(e.createParameterItem("json",bizagi.util.unicode2htmlencode(JSON.stringify(e.args.jsonForm)))),e.parameters.push(e.createParameterItem("changeset",JSON.stringify(e.args.changeset))),e.parameters.push(e.createParameterItem("idForm",e.args.idForm)),t.isNewForm&&e.parameters.push(e.createParameterItem("isNewForm",t.isNewForm)),t.isSpecific&&(e.parameters.push(e.createParameterItem("isSpecific",t.isSpecific)),e.parameters.push(e.createParameterItem("parentId",t.parentId))),(e.args.adhocTaskId||e.args.isAdhocSummaryForm)&&(e.parameters.push(e.createParameterItem("adhocTaskId",e.args.adhocTaskId)),e.parameters.push(e.createParameterItem("adhocProcessId",e.args.adhocProcessId)),e.parameters.push(e.createParameterItem("isAdhocSummaryForm",e.args.isAdhocSummaryForm)))},processBasAnswer:function(e){var t=e.result;if(!t)return e;if(t.success){this.answerParameters=t.parameters;var i=this.findKeyInParameters("resources"),n=this.findKeyInParameters("canBeSaved"),o=this.findKeyInParameters("userInfo"),r=this.findKeyInParameters("isInCheckout");return n=!n,{resources:i=i&&JSON.parse(i.value),canBeSaved:n,userInfo:o=o?JSON.parse(o.value):o,isInCheckout:r=!!r&&bizagi.util.parseBoolean(r.value)}}return t.success}}),bizagi.editor=bizagi.editor||{},bizagi.editor.communicationprotocol=bizagi.editor.communicationprotocol||{},bizagi.editor.communicationprotocol.factory=function(){return{setContext:function(e){this.context=e},createProtocol:function(args){if(void 0===args.protocol)throw"The argument must contain a protocol to create the protocol instance";try{var fn=eval("var bafn = function(args) {  return new bizagi.editor.base.protocol."+args.protocol+"(args);};bafn");args=args.context?args:$.extend(args,{context:this.context});var command=fn(args);return command}catch(e){throw"Can't create a protocol for "+args.protocol}}}}(),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.copyform",{},{init:function(e){this._super(e),this.actiontype="LoadCopyForm"},buildRequest:function(){var e=this.args;this.parameters=[],e.idForm&&this.parameters.push(this.createParameterItem("idForm",e.idForm))},processBasAnswer:function(e){this.args;if(result=e.result,result.success){this.answerParameters=result.parameters;var t=JSON.parse(this.findKeyInParameters("form").value),i=JSON.parse(this.findKeyInParameters("resources").value)||[];return{form:t,resources:i=i.map(function(e){var t=JSON.parse(e.Content);return t.languages&&"string"==typeof t.languages&&(t.languages=JSON.parse(t.languages)),t.Id=e.Id,t})}}return result.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.editentityvalues",{},{init:function(e){this._super(e),this.actiontype="LoadEditEntityValues"},buildRequest:function(){var e;this.parameters=[],e=this.createParameterItem("id",this.args.id),this.parameters.push(e)},processBasAnswer:function(e){if(e&&e.result)return e.result.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.newform",{},{init:function(e){this._super(e),this.actiontype="CreateFormFromXpath"},buildRequest:function(){var e=this,t=e.args.node;e.parameters=[],e.parameters.push(e.createParameterItem("context",t.contextScope)),e.parameters.push(e.createParameterItem("isScopeAttribute",t.isScopeAttribute)),e.parameters.push(e.createParameterItem("idContextEntity",t.guidRelatedEntity)),e.parameters.push(e.createParameterItem("guidForm",t.id)),e.parameters.push(e.createParameterItem("deviceId",e.args.deviceId))}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.documenttemplates",{},{init:function(e){this._super(e),this.actiontype="LoadDocumentTemplates"},buildRequest:function(){var e=this;e.parameters=[],e.parameters.push(e.createParameterItem("append",e.args.append)),e.parameters.push(e.createParameterItem("xpath",e.args.xpath)),e.parameters.push(e.createParameterItem("targetForm",e.args.idForm)),e.args.idContextEntity&&e.parameters.push(e.createParameterItem("idContextEntity",e.args.idContextEntity)),e.args.groupmapping&&e.parameters.push(e.createParameterItem("groupmapping",bizagi.editor.utilities.resolveComplexReference(e.args.groupmapping)))},processBasAnswer:function(e){var t=e.result;return t.success?(this.answerParameters=t.parameters,this.findKeyInParameters("id").value):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.availablelanguages",{},{init:function(e){this._super(e),this.actiontype="GetAvailableLanguages"},processBasAnswer:function(e){var t=e.result;return t.success?t.parameters:t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.installwidget",{},{init:function(e){this._super(e),this.actiontype="InstallWidget"},processBasAnswer:function(e){return e.result.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.openwidgetstore",{},{init:function(e){this._super(e),this.actiontype="OpenWidgetstore"},processBasAnswer:function(e){return e.result.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getwidgets",{},{init:function(e){this._super(e),this.actiontype="GetWidgets"},buildRequest:function(){this.parameters=[]},processBasAnswer:function(e){var t=e.result;return t.success?(this.answerParameters=t.parameters,!!this.findKeyInParameters("widgets")&&JSON.parse(this.findKeyInParameters("widgets").value)):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.closeform",{},{init:function(e){this._super(e),this.actiontype="CloseForm"},buildRequest:function(){var e=this.args;this.parameters=[],e.idForm&&this.parameters.push(this.createParameterItem("forms",JSON.stringify([e.idForm])))}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getmultiplerelationship",{},{init:function(e){this._super(e),this.actiontype="GetMultipleRelationship"},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("leftEntityId",this.args.leftEntityId)),this.args.rightEntityId&&this.parameters.push(this.createParameterItem("rightEntityId",this.args.rightEntityId))},processBasAnswer:function(e){var t=e.result;if(t.success){this.answerParameters=t.parameters;var i=[];this.findKeyInParameters("leftfact")&&(i=this.findKeyInParameters("leftfact").value,i=JSON.parse(i));var n=[];return this.findKeyInParameters("rightfact")&&(n=this.findKeyInParameters("rightfact").value,n=JSON.parse(n)),{leftfact:i,rightfact:n}}return t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getparententities",{},{init:function(e){this._super(e),this.actiontype="GetParentEntities"},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("id",this.args.id)),this.parameters.push(this.createParameterItem("xpath",this.args.xpath))},processBasAnswer:function(e){var t;if(!e)return{};var i=e.result;return i.success?(this.answerParameters=i.parameters,t=this.findKeyInParameters("values"),bizagi.util.isEmpty(t.value)?{isEmpty:!0}:JSON.parse(t.value)):i.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getattributedisplayname",{},{init:function(e){this._super(e),this.actiontype="GetAttributeDisplayName"},buildRequest:function(){var e=this;e.parameters=[],e.parameters.push(e.createParameterItem("xpathattribute",bizagi.editor.utilities.resolveComplexXpath(e.args.xpath))),e.parameters.push(e.createParameterItem("guidentity",e.geGuidEntity()));var t=e.isScope();e.parameters.push(e.createParameterItem("isscope",t)),"default"!==bizagi.editorLanguage.key&&e.parameters.push(e.createParameterItem("language",bizagi.editorLanguage.displayname)),t&&e.parameters.push(e.createParameterItem("scopeDefinition",bizagi.editor.utilities.resolveScopeContextFromXpath(e.args.xpath)))},processBasAnswer:function(e){var t=e.result;return t?t.success?(this.answerParameters=t.parameters,{displayName:this.findKeyInParameters("displayname").value,defaultValue:this.findKeyInParameters("default").value}):t.success:e},geGuidEntity:function(){return bizagi.editor.utilities.resolveContextEntityFromXpath(this.args.xpath)||bizagi.editor.utilities.resolveScopeContextFromXpath(this.args.xpath)},isScope:function(){return!!bizagi.editor.utilities.resolveScopeContextFromXpath(this.args.xpath)}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getmetadataattributedisplayname",{},{init:function(e){this._super(e),this.actiontype="GetMetadataAttributeDisplayName"},buildRequest:function(){this.parameters=[];var e=bizagi.editor.utilities.resolveComplexXpath(this.args.xpath);e=e.replace(/\./g,"_").replace("@",""),this.parameters.push(this.createParameterItem("xpathattribute",e)),"default"!==bizagi.editorLanguage.key&&this.parameters.push(this.createParameterItem("language",bizagi.editorLanguage.displayname))},processBasAnswer:function(e){var t=e.result;return t?t.success?(this.answerParameters=t.parameters,{displayName:this.findKeyInParameters("displayname").value,defaultValue:this.findKeyInParameters("default").value}):t.success:e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getruledisplayname",{},{init:function(e){this._super(e),this.actiontype="GetRuleDisplayName"},buildRequest:function(){this.parameters=[];var e=this.args.rule?bizagi.editor.utilities.resolveComplexReference(this.args.rule):this.args.guid;this.parameters.push(this.createParameterItem("guidRule",e))},processBasAnswer:function(e){var t=e.result;return t?t.success?(this.answerParameters=t.parameters,{displayName:this.findKeyInParameters("displayname").value}):t.success:e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getformdisplayname",{},{init:function(e){this._super(e),this.actiontype="GetFormDisplayName"},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("guidForm",this.args.guid))},processBasAnswer:function(e){var t=e.result;return t?t.success?(this.answerParameters=t.parameters,{displayName:this.findKeyInParameters("displayname").value}):t.success:e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.checkflags",{},{init:function(e){this._super(e),this.actiontype="CheckFlags"},buildRequest:function(){this.parameters=[];var e=this.args.flags;if(e)for(var t in e)this.parameters.push(this.createParameterItem(t,!0))},processBasAnswer:function(e){var t=e.result;if(t.success){for(var i={},n=0,o=t.parameters.length;n<o;n++)i[t.parameters[n].key]=bizagi.util.parseBoolean(t.parameters[n].value);return this.processFlags(i)}return t.success},processFlags:function(e){return void 0!==e.EnableLetters&&(e.letter=e.columnletter=!e.EnableLetters),e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.checkoutform",{},{init:function(e){this._super(e),this.actiontype="CheckoutForm"},buildRequest:function(){var e=this.args;this.parameters=[],e.idForm&&this.parameters.push(this.createParameterItem("idForm",e.idForm)),e.loadForm&&this.parameters.push(this.createParameterItem("loadForm",!0)),e.forceCheckin&&this.parameters.push(this.createParameterItem("forceCheckin",!0))},processBasAnswer:function(e){var t=e.result;if(t.success){this.answerParameters=t.parameters;var i=!!this.findKeyInParameters("userInfo")&&bizagi.util.parseBoolean(this.findKeyInParameters("isInCheckout").value),n=null;this.findKeyInParameters("userInfo")&&(n=this.findKeyInParameters("userInfo").value,n=JSON.parse(n));var o=null;return this.findKeyInParameters("form")&&(o=this.findKeyInParameters("form").value,o=JSON.parse(o)),{isInCheckout:i,userInfo:n,form:o}}return t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getstatusform",{},{init:function(e){this._super(e),this.actiontype="GetStatusForm"},processBasAnswer:function(e){var t=e.result;return t.success?(this.answerParameters=t.parameters,{isInCheckout:bizagi.util.parseBoolean(this.findKeyInParameters("isInCheckout").value)}):t.success},processFlags:function(e){return void 0!==e.EnableGroupedGridControl&&(e.groupedgrid=!e.EnableGroupedGridControl),void 0!==e.EnableCollectionNavigatorControl&&(e.collectionnavigator=!e.EnableCollectionNavigatorControl),e}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getstakeholders",{},{init:function(e){this._super(e),this.actiontype="GetStakeHolders"},processBasAnswer:function(e){var t=e.result;return t.success?(this.answerParameters=t.parameters,itemParameter=this.findKeyInParameters("stakeholders"),JSON.parse(itemParameter.value)):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.gettemplates",{},{init:function(e){this._super(e),this.actiontype="GetTemplatesByEntity"},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("entityGuid",this.args.entityGuid))},processBasAnswer:function(e){var t=e.result;return t.success?(this.answerParameters=t.parameters,itemParameter=this.findKeyInParameters("templates"),JSON.parse(itemParameter.value).filter(function(e){return e.ShowInProcesses&&e.Enable})):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.switchform",{init:function(e){this._super(e),this.actiontype="SwitchForm"},buildRequest:function(){},processBasAnswer:function(e){}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.setuseoffline",{init:function(e){this._super(e),this.actiontype="SetUseOffline"},buildRequest:function(){var e;this.parameters=[],e=this.createParameterItem("value",this.args.value),this.parameters.push(e)},processBasAnswer:function(e){return e.result}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.showwizardtemplates",{},{init:function(e){this._super(e),this.actiontype="OpenWizardTemplates"},buildRequest:function(){var e=this,t=e.args;e.parameters=[],t.xpath&&e.parameters.push(e.createParameterItem("xpath",t.xpath)),t.relatedEntity&&e.parameters.push(e.createParameterItem("relatedEntity",t.relatedEntity)),t.isScopeAttribute&&e.parameters.push(e.createParameterItem("isScopeAttribute",t.isScopeAttribute)),t.guidControl&&e.parameters.push(e.createParameterItem("guidControl",t.guidControl)),t.propertyName&&e.parameters.push(e.createParameterItem("propertyName",t.propertyName))}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getadhocdataschema",{},{init:function(e){this._super(e),this.actiontype="GetAdhocDataSchema"},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("adhocProcessId",this.args.adhocProcessId))},processBasAnswer:function(e){var t=e.result;return t.success&&t.parameters.length>0?(this.answerParameters=t.parameters,itemParameter=this.findKeyInParameters("dataSchema"),JSON.parse(itemParameter.value)):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getadhocdatasources",{},{init:function(e){this._super(e),this.actiontype="GetAdhocDataSources"},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("adhocProcessId",this.args.adhocProcessId))},processBasAnswer:function(e){var t=e.result;return t.success&&t.parameters.length>0?(this.answerParameters=t.parameters,itemParameter=this.findKeyInParameters("dataSources"),JSON.parse(itemParameter.value)):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getadhocentityattribs",{},{init:function(e){this._super(e),this.actiontype="GetAdhocEntityAttribs"},buildRequest:function(){this.parameters=this.args.parameters||[]},processBasAnswer:function(e){var t=e.result;return t.success&&t.parameters.length>0?(this.answerParameters=t.parameters,itemParameter=this.findKeyInParameters("attributes"),JSON.parse(itemParameter.value)):t.success}}),bizagi.editor.base.protocol.base.extend("bizagi.editor.base.protocol.getpredefinedvalues",{},{init:function(e){this._super(e),this.actiontype="GetPredefinedValues"},buildRequest:function(){this.parameters=[],this.parameters.push(this.createParameterItem("adhocProcessId",this.args.adhocProcessId)),this.parameters.push(this.createParameterItem("property",this.args.property))},processBasAnswer:function(e){var t=e.result;return t.success&&t.parameters.length>0?(this.answerParameters=t.parameters,itemParameter=this.findKeyInParameters("predefinedValues"),itemParameter.value):t.success}}),bizagi.editor.component.controller("bizagi.editor.component.layout",{init:function(e,t){t=t||{},this._super(e),this.model=t.model,this.canvas=e,this.presenter=t.presenter,this.context=t.context,this.isActivityForm=t.isActivityForm},loadTemplates:function(){var e={frames:bizagi.getTemplate("bizagi.editor.component.layout").concat("#layout-frames"),tabs:bizagi.getTemplate("bizagi.editor.component.layout").concat("#layout-left-tabs")};return this._super(e)},refresh:function(){this.render()},render:function(){var e=this;return $.when(e.loadTemplates()).done(function(){e.renderFrames(e.element),e.leftPanel=e.element.find(".left-panel"),setTimeout(function(){e.applyThemeToLayout()},100),window.myResize=e.applyThemeToLayout,$(window).bind("resize.windowPanel",function(){return e.applyThemeToLayout()}),e.renderTabs(e.leftPanel)})},applyThemeToLayout:function(){},renderFrames:function(e){$.tmpl(this.getTemplate("frames"),{context:this.context,isActivityForm:this.isActivityForm}).appendTo(e),e.find("ul.wrapper-orientation").on("click","li",{main:e,self:this},this.handlerClickOrientation)},renderTabs:function(e){$.tmpl(this.getTemplate("tabs")).appendTo(e)},handlerClickOrientation:function(e){var t=$(this),i=t.parent(),n=t.data("orientation"),o=$(e.data.main[0]),r=e.data.self,a=o.find("#wrapper-main-container");["orientation__landscape","orientation__portrait"].forEach(function(e){a.removeClass(e)}),a.addClass("orientation__"+n),i.children().removeClass("orientation__active"),t.addClass("orientation__active"),r.presenter.publish("onChangeRotation",{orientation:n})}}),bizagi.editor.observableClass.extend("bizagi.editor.component.layout.presenter",{},{init:function(e){this._super(),e=e||{},this.layout=new bizagi.editor.component.layout(e.canvas,{model:e.model,presenter:this,context:e.context,isActivityForm:e.isActivityForm})},render:function(e){return this.layout.render(e)},refresh:function(){this.layout.applyThemeToLayout()}}),bizagi.editor.component.controller("bizagi.editor.component.smartphone.layout",{init:function(e,t){t=t||{},this._super(e),this.model=t.model,this.canvas=e,this.presenter=t.presenter,this.context=t.context,this.isActivityForm=t.isActivityForm},loadTemplates:function(){var e={"smartphone-frames":bizagi.getTemplate("bizagi.editor.component.smartphone.layout").concat("#smartphone-layout-frames"),"smartphone-tabs":bizagi.getTemplate("bizagi.editor.component.smartphone.layout").concat("#smartphone-layout-left-tabs")};return this._super(e)},refresh:function(){this.render()},render:function(){var e=this;return $.when(e.loadTemplates()).done(function(){e.renderFrames(e.element),e.leftPanel=e.element.find(".left-panel"),setTimeout(function(){e.applyThemeToLayout()},100),window.myResize=e.applyThemeToLayout,$(window).bind("resize.windowPanel",function(){return e.applyThemeToLayout()}),e.renderTabs(e.leftPanel)})},applyThemeToLayout:function(){},renderFrames:function(e){$.tmpl(this.getTemplate("smartphone-frames"),{context:this.context,isActivityForm:this.isActivityForm}).appendTo(e)},renderTabs:function(e){$.tmpl(this.getTemplate("smartphone-tabs")).appendTo(e)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.smartphone.layout.presenter",{},{init:function(e){this._super(),e=e||{},this.layout=new bizagi.editor.component.smartphone.layout(e.canvas,{model:e.model,presenter:this,context:e.context,isActivityForm:e.isActivityForm})},render:function(e){return this.layout.render(e)},refresh:function(){this.layout.applyThemeToLayout()}}),bizagi.editor.component.controller("bizagi.editor.component.tablet.layout",{init:function(e,t){t=t||{},this._super(e),this.model=t.model,this.canvas=e,this.presenter=t.presenter,this.context=t.context,this.isActivityForm=t.isActivityForm},loadTemplates:function(){var e={"tablet-frames":bizagi.getTemplate("bizagi.editor.component.tablet.layout").concat("#tablet-layout-frames"),"tablet-tabs":bizagi.getTemplate("bizagi.editor.component.tablet.layout").concat("#tablet-layout-left-tabs")};return this._super(e)},refresh:function(){this.render()},render:function(){var e=this;return $.when(e.loadTemplates()).done(function(){e.renderFrames(e.element),e.leftPanel=e.element.find(".left-panel"),setTimeout(function(){e.applyThemeToLayout()},100),window.myResize=e.applyThemeToLayout,$(window).bind("resize.windowPanel",function(){return e.applyThemeToLayout()}),e.renderTabs(e.leftPanel)})},applyThemeToLayout:function(){},renderFrames:function(e){$.tmpl(this.getTemplate("tablet-frames"),{context:this.context,isActivityForm:this.isActivityForm}).appendTo(e),e.find("ul.wrapper-orientation").on("click","li",{main:e,self:this},this.handlerClickOrientation)},renderTabs:function(e){$.tmpl(this.getTemplate("tablet-tabs")).appendTo(e)},handlerClickOrientation:function(e){var t=$(this),i=t.parent(),n=t.data("orientation"),o=$(e.data.main[0]),r=e.data.self,a=o.find("#wrapper-tablet-main-container");["orientation__landscape","orientation__portrait"].forEach(function(e){a.removeClass(e)}),a.addClass("orientation__"+n),i.children().removeClass("orientation__active"),t.addClass("orientation__active"),r.presenter.publish("onChangeRotation",{orientation:n})}}),bizagi.editor.observableClass.extend("bizagi.editor.component.tablet.layout.presenter",{},{init:function(e){this._super(),e=e||{},this.layout=new bizagi.editor.component.tablet.layout(e.canvas,{model:e.model,presenter:this,context:e.context,isActivityForm:e.isActivityForm})},render:function(e){return this.layout.render(e)},refresh:function(){this.layout.applyThemeToLayout()}}),bizagi.editor.component.controller("bizagi.editor.component.dialog",{},{init:function(e,t){this._super(),t=t||{},this.canvas=e,this.model=t.model,this.presenter=t.presenter},loadTemplates:function(){var e={"content-dialog":bizagi.getTemplate("bizagi.editor.component.dialog").concat("#dialog-container")};return this._super(e)},render:function(){var e=this,t=e.element;t.empty(),$.when(e.loadTemplates()).done(function(){var i=e.dialogTemplate=e.getTemplate("content-dialog"),n=$.tmpl(i,e.model.getModel());n.on("click","li",function(t){var i=t.target.dataset.key;"save"==i?e.presenter.publish("onSaveForm"):"cancel"==i?e.presenter.publish("onCancel"):"discard"==i&&e.presenter.publish("onDiscard"),e.destroy()}).on("click","a.view__errors",function(){e.presenter.publish("onViewErrors"),e.destroy()}),n.appendTo(t)})},destroy:function(e){this.element.detach(),this.publish("close",e)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.dialog.model",{},{init:function(e){this._super(),this.events={},this.processData(e)},processData:function(e){var t=this;t.model=e,e.buttons&&$.each(e.buttons,function(e,i){i.icon=i.text?i.text.toLowerCase():"",i.style=i.style?i.style:"","function"==typeof i.click&&(t.events[i.text]=i.click)})},getModel:function(){return this.model},getName:function(){return this.model.name},getTitle:function(){return this.model.title},getStyle:function(){return this.model.style},getClickEvent:function(e){return this.events[e]}}),bizagi.editor.observableClass.extend("bizagi.editor.component.dialog.presenter",{},{init:function(){this._super()},show:function(e){var t=this,i=new $.Deferred,n=new bizagi.editor.component.dialog.model(e.data),o=$("#root");0===o.length&&(o=t.publish("getMainContainer"));var r=t.popup=bizagi.createPopup({name:n.getName(),container:o,title:n.getTitle(),onClose:function(e){i.resolve(e)}});return t.dialog=new bizagi.editor.component.dialog(r.content,{model:n,presenter:t}),t.dialog.subscribe("close",function(e,i){t.onClose(i)}),t.dialog.render(),i.promise()},onClose:function(e){this.popup.close(e)}}),bizagi.editor.component.controller("bizagi.editor.component.blockedformsdialog",{},{init:function(e,t){this._super(),t=t||{},this.canvas=e,this.model=t.model,this.presenter=t.presenter},loadTemplates:function(){var e={"content-blockedformsdialog":bizagi.getTemplate("bizagi.editor.component.blockedformsdialog").concat("#blockedformsdialog-container")};return this._super(e)},render:function(){var e=this,t=e.element;t.empty(),$.when(e.loadTemplates()).done(function(){var i=e.dialogTemplate=e.getTemplate("content-blockedformsdialog");$.tmpl(i,e.model.getModel()).appendTo(t)})},destroy:function(e){this.element.detach(),this.publish("close",e)},"button.btn-forceCheckout   click":function(e){this.presenter.publish("unlockformevent"),this.destroy()},"button.btn-cancel click":function(e){this.destroy()}}),bizagi.editor.observableClass.extend("bizagi.editor.component.blockedformsdialog.model",{},{init:function(e){this._super(),this.events={},this.processData(e)},processData:function(e){var t=this;t.model=e,e.buttons&&$.each(e.buttons,function(e,i){i.icon=i.text?i.text.toLowerCase():"",i.style=i.style?i.style:"","function"==typeof i.click&&(t.events[i.text]=i.click)})},getModel:function(){return this.model},getName:function(){return this.model.name},getTitle:function(){return this.model.title},getStyle:function(){return this.model.style},getClickEvent:function(e){return this.events[e]}}),bizagi.editor.observableClass.extend("bizagi.editor.component.blockedformsdialog.presenter",{},{init:function(){this._super()},show:function(e){var t=this,i=new $.Deferred,n=new bizagi.editor.component.blockedformsdialog.model(e.data),o=$("#root");0===o.length&&(o=t.publish("getMainContainer"));var r=t.popup=bizagi.createPopup({name:n.getName(),container:o,title:n.getTitle(),additionalClass:"someClass",onClose:function(e){i.resolve(e)}});return t.dialog=new bizagi.editor.component.blockedformsdialog(r.content,{model:n,presenter:t}),t.dialog.subscribe("close",function(e,i){t.onClose(i)}),t.dialog.render(),i.promise()},onClose:function(e){this.popup.close(e)}}),bizagi.editor.component.controller("bizagi.editor.component.controlsnavigator",{init:function(e,t){this._super(),t=t||{},this.model=t.model,this.canvas=e,this.presenter=t.presenter,this.tmpl={}},render:function(e){var t=this;e=e||{},t.isReadOnly="undefined"!=e.isReadOnly&&bizagi.util.parseBoolean(e.isReadOnly),t.isAdhocFormContext=e.isAdhocFormContext,t.element.empty(),$.when(t.loadTemplates()).done(function(){t.renderGroups(t.element,t.model.groups),t.isReadOnly||setTimeout(function(){t.setDraggableItems()},1e3),t.element.data().hasOwnProperty("ui-accordion")&&t.element.accordion("destroy"),t.isAdhocFormContext?t.element.accordion({header:"> .mtool-group > .mtool-group-header",heightStyle:"content",collapsible:!0}):t.element.accordion({header:"> .mtool-group > .mtool-group-header",heightStyle:"content",collapsible:!0,active:!1})})},renderGroups:function(e,t){var i=this;$.each(t,function(t,n){var o=$.tmpl(i.getTemplate("group"),n);i.renderItems(o.find(".mtool-group-items"),n.items),o.appendTo(e)})},renderItems:function(e,t){var i=this;$.each(t,function(t,n){n.name=n.name.replace("column",""),$.when(n.icon).done(function(t){n.icon=t;var o=$.tmpl(i.getTemplate("item"),n);o.data("render",{name:n.id,type:n.type,icon:t,displayName:n.name,style:n.style}),o.appendTo(e)})})},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("group",bizagi.getTemplate("bizagi.editor.component.controlsnavigator").concat("#mtool-group")),this.loadTemplate("item",bizagi.getTemplate("bizagi.editor.component.controlsnavigator").concat("#mtool-item")),this.loadTemplate("helper",bizagi.getTemplate("bizagi.editor.component.controlsnavigator").concat("#mtool-helper"))).done(function(){e.resolve()}),e.promise()},setDraggableItems:function(){var e=this,t=e.presenter.publish("getMainPanel"),i=e.presenter.publish("getMainContainer");$(".mtool-item",i).data("self",e),$(".mtool-item",i).draggable({helper:function(t,i){return e.draggableHelper(t,i)},connectToSortable:".ui-bizagi-container-connectedSortable",distance:15,start:function(n,o){var r,a,s,l,d;r=$(n.currentTarget),t.addClass("bz-main-dashed-grid"),r.addClass("ui-dragging"),a=$(".wrapper-main-panel",i),s=$(".wrapper-main-scroll",a),t.addClass("ui-start-drag"),e.presenter.publish("controlRefreshCanvas",{}),t.hasClass("biz-auto-height")&&(l=a.position().top+parseFloat(a.css("padding-top"))+parseFloat(a.css("margin-top"))+50,d=s.outerHeight(),bizagi.util.autoScroll(s,l,d,"controlsnavigator"))},stop:function(e,i){var n,o;n=$(e.currentTarget),o=$(this).data("self"),t.removeClass("bz-main-dashed-grid").removeClass("ui-start-drag"),n.removeClass("ui-dragging"),bizagi.util.removeAutoScroll("autoscroll","controlsnavigator"),o.presenter.publish("controlRefreshCanvas",{})},cursorAt:{top:-3,left:0},containment:"document"})},draggableHelper:function(e,t){var i,n,o,r,a=$(e.currentTarget),s=this.presenter.publish("getMainContainer");return a.addClass("ui-dragging"),n=a.data("id"),o=a.data("caption"),icon=a.data("render")&&a.data("render").icon,style=a.data("render")&&a.data("render").style,i=a.data("self"),(r=$.tmpl(i.getTemplate("helper"),{id:n,caption:o,icon:icon,style:style})).appendTo(s).css({zIndex:900}),widthLabel=parseFloat(a.find(".mtool-item-name").width()||100),widthIcon=parseFloat($(".biz-ico",r).eq(0).width()),widthTotal=widthLabel+widthIcon+40+"px",r.css("width",widthTotal),r},updateModel:function(e){this.model=e},".mtool-item dblclick":function(e){var t,i;if(!this.isReadOnly){var n=e.data("render");this.presenter.publish("controlDoubleClick",{name:n.name,type:n.type,displayName:n.displayName}),i=(t=$(".wrapper-main-scroll",this.presenter.publish("getMainContainer")))[0].scrollHeight,t.scrollTop(i),elementLast=$(".ui-bizagi-container-form > div:last",t),bizagi.util.highLightElement(elementLast)}}}),bizagi.editor.observableClass.extend("bizagi.editor.component.controlsnavigator.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas,this.model=e.model,this.controlsNavigator=new bizagi.editor.component.controlsnavigator(this.canvas,$.extend(e,{presenter:this}))},render:function(e){return e=e||{},this.model=e.model||this.model,this.controlsNavigator.updateModel(this.model),this.controlsNavigator.render(e)}}),bizagi.editor.component.controller("bizagi.editor.component.banner",{init:function(e,t){t=t||{},this._super(e),this.canvas=e,this.presenter=t.presenter,this.model=t.model,this.data=t.data,this.tmpl={}},updateModel:function(e){this.model=e,this.update()},render:function(){var e=this;$.when(e.loadTemplates()).done(function(){e.element.show(),e.element.empty(),e.renderbanner(e.element,e.model)})},renderbanner:function(e,t){var i,n=t.banner.displayname,o=t.banner.icon,r=t.banner.cite;this.bannerModel=t,t.banner.on&&(i=$.tmpl(this.getTemplate("banner"),{caption:n,icon:o,cite:r}),e.css("position","relative"),e.append(i),$(".ui-tabs-panel",this.data.element).addClass("ui-wbanner-space-show"),(this.visibility="hide")&&this.hide())},remove:function(){this.element.hide(),this.element.empty()},hide:function(){this.visibility="hide",$(".ui-tabs-panel",this.data.element).removeClass("ui-wbanner-space-show").addClass("ui-wbanner-space-hide"),this.element.hide()},show:function(){this.visibility="show",$(".ui-tabs-panel",this.data.element).removeClass("ui-wbanner-space-hide").addClass("ui-wbanner-space-show"),this.element.show("slow"),this.element.css("overflow","visible")},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("banner",bizagi.getTemplate("bizagi.editor.component.banner").concat("#banner-component"))).done(function(){e.resolve()}),e.promise()},destroy:function(){this.element.detach()},".bizagi-editor-banner-container click":function(e,t){t.stopPropagation(),this.presenter.publish("onBannerClick",{model:this.bannerModel,reference:this})}}),bizagi.editor.observableClass.extend("bizagi.editor.component.banner.presenter",{},{init:function(e){e=e||{},this._super(),this.canvas=e.canvas,this.model=e.model,this.bannerElement=e.data.element,this.banner=new bizagi.editor.component.banner(this.canvas,$.extend(e,{presenter:this}))},destroy:function(){this.banner.destroy()},remove:function(){this.banner.remove()},getBannerElement:function(){return this.bannerElement},render:function(e){return e=e||{},this.model=e.model||this.setModel(),this.banner.updateModel(this.model),this.banner.render(e)},hide:function(){this.banner.hide()},show:function(){this.banner.show()},setModel:function(){var e=(new bizagi.editor.component.banner.model).getBannerModel();return this.banner.updateModel(e),e}}),bizagi.editor.component.controller("bizagi.editor.component.editableLabel",{init:function(e,t){this._super(e),this.canvas=e,this.params=t,this.presenter=t.presenter},loadTemplates:function(){var e={editableLabel:bizagi.getTemplate("bizagi.editor.component.editablelabel")};return this._super(e)},render:function(){var e=this,t=e.params;$.when(e.loadTemplates()).done(function(){var i=e.editablelabel=$.tmpl(e.getTemplate("editableLabel"),{value:t.value});i.width(t.label.width()),t.label.hide(),t.label.after(i);var n=i.find("input"),o=t.value,r=i.width()-50;n.width(r),n.keyup(function(t){e.onInputKeyUp(n,t)}),n.click(function(e){e.stopPropagation()}),n.keydown(function(e){e.stopPropagation()}),n.blur(function(t){t.stopPropagation(),t.stopimmediatepropagation&&"function"==typeof t&&t.stopimmediatepropagation(),e.onInputBlur(n,t)}),$(".ui-bizagi-input-icon",i).mousedown(function(t){e.onIconClicked(n,t)}),n.focus(),n.val(""),n.val(o)})},destroy:function(){this.params.label.show(),this.editablelabel.detach(),this.element.detach()},onInputKeyUp:function(e,t){var i=e.val();if(13===t.keyCode)return this.params.value===i?(this.presenter.publish("keyup",{value:i,keyCode:t.keyCode}),void this.presenter.destroy()):void this.presenter.publish("change",{value:i});this.presenter.publish("keyup",{value:i,keyCode:t.keyCode})},onIconClicked:function(e,t){var i=e.val();$(".ui-bizagi-input-icon").data("iconClicked",!0),$(t.target).hasClass("ui-bizagi-input-icon-ok")&&this.params.value!==i?this.presenter.publish("change",{value:i}):this.presenter.publish("finish"),this.presenter.destroy()},onInputBlur:function(e,t){if(1!=$(".ui-bizagi-input-icon").data("iconClicked")){var i=e.val();this.presenter.publish("change",{value:i})}}}),bizagi.editor.observableClass.extend("bizagi.editor.component.editableLabel.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas||$("<div />"),this.editableLabel=new bizagi.editor.component.editableLabel(this.canvas,$.extend(e,{presenter:this}))},render:function(){return this.editableLabel.render()},destroy:function(){this.editableLabel&&(this.editableLabel.destroy(),this.editableLabel=null)}}),bizagi.editor.component.controller("bizagi.editor.component.properties",{listensTo:["outEditor"],events:{PROPERTIES_CHANGE_PROPERTY:"PropertyChange",PROPERTIES_CHANGE_LAYOUT:"PropertyChangeLayout",PROPERTIES_SELECT_EXPRESSION:"ShowRuleSelector",PROPERTIES_SHOW_LOCALIZATION:"ShowLocalization",PROPERTIES_CHANGE_MULTIPLE_PROPERTIES:"ChangeMultipleProperties",PROPERTIES_SELECT_EDITOR_DATALIST:"ShowFilterEditor",PROPERTIES_RULE_EDITOR_DEFAULTVALUE:"ShowRuleEditorForDefaultValue",PROPERTIES_SHOW_XPATH_GENERAL:"ShowXPathEditor",PROPERTIES_SHOW_INTERFACE:"ShowInterfaceEditor",PROPERTIES_SELECT_XPATH_FROM_ENTITY:"SelectXpathFromEntity",PROPERTIES_SHOW_GRID_VALIDATIONS:"ShowGridValidationsEditor",PROPERTIES_SELECT_XPATH_TO_SIMPLE:"SelectXpathToSimple",PROPERTIES_SELECT_XPATH_TO_ENTITY:"SelectXpathToEntity",PROPERTIES_SELECT_XPATH_TO_COLLECTION:"SelectXpathToCollection",PROPERTIES_SELECT_XPATH_MULTIPLE:"SelectMultiXpath",PROPERTIES_SELECT_XPATH:"SelectXpath",PROPERTIES_SELECT_FORM_OPTION:"SelectFormOption",PROPERTIES_SELECT_FORM_BUTTON:"SelectFormButton",PROPERTIES_SELECT_FORM_NEW:"SelectFormNew",PROPERTIES_SELECT_FORM_NONE:"SelectFormNone",PROPERTIES_SELECT_TEMPLATE_NONE:"SelectTemplateNone",PROPERTIES_SELECT_TEMPLATE_DEFAULT:"SelectTemplateDefault",PROPERTIES_SELECT_SEARCHFORM_OPTION:"SelectSearchformOption",PROPERTIES_SELECT_SEARCHFORM_BUTTON:"SelectSearchformButton",PROPERTIES_SELECT_SEARCHFORM_NEW:"SelectSearchformNew",PROPERTIES_SELECT_SEARCHFORM_NONE:"SelectSearchformNone",PROPERTIES_SHOW_DOCUMENT_TEMPLATES:"ShowDocumentTemplatesEditor",PROPERTIES_SHOW_ASSOCIATION_EDITOR:"ShowAssociationEditor",PROPERTIES_SHOW_WIZARD_TEMPLATES:"ShowWizardTemplates",PROPERTIES_SELECT_PROCESS:"SelectProcess",PROPERTIES_LOAD_METADATA:"LoadMetadata"}},{init:function(e,t){var i=this;i._super(),t=t||{},i.canvas=e,i.model=t.model,i.presenter=t.presenter,t.adhocProcessId&&(i.adhocProcessId=t.adhocProcessId),void 0!==i.presenter&&(i.presenter.subscribe("propertyEditorChanged",function(e,t){return i.onPropertyEditorChanged(t)}),i.presenter.subscribe("getMainContainer",function(){return t.mainContainer}))},loadTemplates:function(){var e={close:bizagi.getTemplate("bizagi.editor.component.properties").concat("#prop-close"),"frame-header":bizagi.getTemplate("bizagi.editor.component.properties").concat("#properties-frame-header"),"frame-header-name":bizagi.getTemplate("bizagi.editor.component.properties").concat("#properties-frame-header-name"),"content-frame":bizagi.getTemplate("bizagi.editor.component.properties").concat("#properties-content-frame"),"frame-property":bizagi.getTemplate("bizagi.editor.component.properties").concat("#properties-frame-property"),"frame-group":bizagi.getTemplate("bizagi.editor.component.properties").concat("#properties-frame-group"),"frame-group-exclusive":bizagi.getTemplate("bizagi.editor.component.properties").concat("#properties-frame-group-exclusive"),"frame-category-simple":bizagi.getTemplate("bizagi.editor.component.properties").concat("#properties-frame-category-simple"),"frame-caption":bizagi.getTemplate("bizagi.editor.component.properties").concat("#properties-caption")};return this._super(e)},render:function(e){var t,i=this,n=i.element;e=e||{},i.editorResponses=[],i.refProperties={},i.redraw=!!e.redraw&&e.redraw,i.groupsReferences={},e.model&&i.update(e.model);var o=i.model=e.model||i.model;n.show(),n.empty(),n.data("id",o.idRender),i.propertySelected=void 0!==e.propertySelected?e.propertySelected:null,$.when(i.loadTemplates()).done(function(){i.renderCaption(n,o),i.renderClose(n),i.renderFrame(n,o),i.renderContent(n,o),t=i.getLastActiveTabForRender(e.model.idRender),i.idRender=e.model.idRender,i.scrollPanel=0,n.hasClass("ui-tabs")&&n.tabs("destroy"),n.tabs(),t&&(n.tabs({select:function(e,t){i.scrollPanelDiv=$(t.panel)}}),n.tabs("option","active",t.index)),$(".ui-tabs-panel",n).bind("mousedown.panelselected",function(){var e=$(this).scrollTop();i.scrollPanel=e}),n.tabs({select:function(e,t){i.setLastActiveTabForRender(i.idRender,t.index,i.scrollPanel)}});var r=i.Class.fullName.replace(/\./gi,"_");n.attr("id",r),i.addThemeStyle(),i.configureAutoCloseHandler(),$.when.apply($,i.editorResponses).done(function(){bizagi.form.modeler.params.reviewMode&&($(n).find(".bz-modeldata_16x16_standard").remove(),$(n).find(".bz-undo_16x16_standard").remove(),$(n).find(".ui-editor").css("pointer-events","none").css("-moz-user-select","none").css("-webkit-user-select","none")),bizagi.util.highLightElement(i.element),i.selectOnProperty(),void 0!==o.validations&&o.validations.length>0&&i.highLightOnProperties(o.validations),i.deselectTabLeftPanel(),t.scrollRender>0&&i.scrollPanelDiv&&i.scrollPanelDiv.scrollTop(t.scrollRender),i.postRender()})})},postRender:function(){var e,t;for(e in this.refProperties)void 0!==(t=this.refProperties[e]).postRender&&t.postRender()},highLightOnProperties:function(e){var t,i;for(t=0;t<e.length;t++)i=e[t],this.refProperties[i.name]?this.refProperties[i.name].highLightProperty(i.message):console.error(i.name+" is not a register property")},getLastActiveTabForRender:function(e){var t={index:0,scrollRender:0},i=this.presenter.publish("getRenderElement",{id:e});return(i=i?i.element||i.container:$("[data-id = "+e+"]").length>0?$("[data-id = "+e+"]"):$("[data-container-id = "+e+"]"))&&(t=i.data("last-tab")||t),t},setLastActiveTabForRender:function(e,t,i){var n=this.presenter.publish("getRenderElement",{id:e});(n=n?n.element||n.container:$("[data-id = "+e+"]").length>0?$("[data-id = "+e+"]"):$("[data-container-id = "+e+"]"))&&n.data("last-tab",{index:t,scrollRender:i})},selectOnProperty:function(){null!==this.propertySelected&&void 0!==this.propertyManager&&void 0!==this.propertyManager.selectEditor&&this.propertyManager.selectEditor()},deselectTabLeftPanel:function(){this.lastTabActive&&this.lastTabActive.removeClass("ui-tabs-selected ui-state-active")},selectTabLeftPanel:function(){this.lastTabActive&&this.lastTabActive.addClass("ui-tabs-selected ui-state-active")},configureAutoCloseHandler:function(){this.lastTabActive=$(".left-panel ul.ui-tabs-nav li.ui-tabs-active"),$(document).bind("mousedown.properties",function(e){var t={pickdate:function(e){return!$(".wpd").is(":visible")&&0===e.closest(".wpd").length},colorPicker:function(){return!$(".sp-container").is(":visible")},xpathNavigator:function(){return!$(".bizagi_editor_xpathnavigator_overlay").is(":visible")},properties:function(e){return 0===e.closest(".bizagi_editor_component_properties").length},tooltipProp:function(e){return 0===e.closest(".ui-propertybox-tooltip").length},warningsButton:function(e){return!($(".ribbon-ico-validate",e).length>0)&&!e.hasClass("ribbon-ico-validate")},saveButton:function(e){return!e.hasClass("ribbon-ico-save")},richText:function(e){return 0===e.closest(".bz-fm-localizablestring-richtext-overlay").length},richTextColor:function(e){return 0===e.closest(".mce-container").length}};return function(i){var n=!0,o=$(i.target);for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];if("function"==typeof a&&(n&=a.call(t,o)),!n)break}n&&(e.lastTabActive&&e.selectTabLeftPanel(),e.destroy(),$(document).unbind("mousedown.properties"),$(window).unbind("resize.panel"))}}(this))},renderClose:function(e){$.tmpl(this.getTemplate("close")).appendTo(e)},renderFrame:function(e,t){var i,n,o,r;for(o=null!==(r=this.filterTabs(t.elements[0].tabs||null))?r.length:-1,i=$.tmpl(this.getTemplate("frame-header"),{}),n=0;n<o;n++)this.performValidationToShowTabOnLiveProcesses(r[n])&&(r[n].machineName=bizagi.editor.utilities.normalizeString(bizagi.editor.utilities.camelCase(r[n].caption))||n,$.tmpl(this.getTemplate("frame-header-name"),r[n]).appendTo(i));i.appendTo(e)},renderCaption:function(e,t){$.tmpl(this.getTemplate("frame-caption"),{caption:t.renderCaption,ico:t.element.type,style:t.element.style}).appendTo(e)},machineName:function(e){return e.toLowerCase().replace(/-/g,"")},filterTabs:function(e){return Array.isArray(e)?e.filter(function(e){return e.elements.length>0}):e},renderContent:function(e,t){var i,n,o,r;for(o=null!==(n=this.filterTabs(t.elements[0].tabs||null))?n.length:-1,i=0;i<o;i++)this.performValidationToShowTabOnLiveProcesses(n[i])&&(n[i].machineName=bizagi.editor.utilities.normalizeString(bizagi.editor.utilities.camelCase(n[i].caption))||i,r=$.tmpl(this.getTemplate("content-frame"),n[i]),this.renderElement(r,n[i].elements),r.appendTo(e))},renderElement:function(e,t){var i;for(i=0;i<t.length;i++)switch(Object.keys(t[i])[0]){case"property":if(void 0!==t[i].property.notShow)break;if(t[i].property.disable){delete t[i].property.disable;break}this.renderProperty(e,t[i].property);break;case"category":this.renderCategory(e,t[i].category);break;case"group":this.renderGroup(e,t[i].group)}this.setAsCollapsible(e)},renderProperty:function(e,t){var i,n,o,r,a,s,l;if(i=$.tmpl(this.getTemplate("frame-property"),{}),t.caption=t.caption?t.caption:"&raquo; "+t.name,this.adhocProcessId&&(t.adhocProcessId=this.adhocProcessId),t["bas-type"]=this.machineName(t["bas-type"]),void 0===t.subproperties)"xpathmultiple"===t["bas-type"]?(o=new bizagi.editor.component.editor[t["bas-type"]](i,t,this.presenter),i.appendTo(e)):/^.*xpath.*$/gi.test(t["bas-type"])?(o=new bizagi.editor.component.editor.xpath(i,t,this.presenter),i.appendTo(e)):(o=new bizagi.editor.component.editor[t["bas-type"]](i,t,this.presenter),i.appendTo(e),null!==this.propertySelected&&this.propertySelected==t.name&&(this.propertyManager=o)),l=o.render(),this.editorResponses.push(l),this.registerProperty(o);else if(/^.*xpath.*$/gi.test(t["bas-type"]))o=new bizagi.editor.component.editor.xpath(i,t,this.presenter),i.appendTo(e),l=o.render(),this.editorResponses.push(l),this.registerProperty(o);else if(void 0===bizagi.editor.component.editor[t["bas-type"]]){for(n=$.tmpl(this.getTemplate("frame-category-simple"),t),s=$(".ui-content",n),r=t.subproperties.length,a=0;a<r;a++)o=t.subproperties[a].property,this.renderProperty(s,o);n.appendTo(e)}else o=new bizagi.editor.component.editor[t["bas-type"]](i,t,this.presenter,{refProperties:this.refProperties}),i.appendTo(e),l=o.render(),this.editorResponses.push(l),this.registerProperty(o)},renderGroup:function(e,t){var i,n,o,r;if(n=t.elements.length,void 0!==t.exclusive){if(2!=t.elements.length)throw"There are more than two exclusives groups";var a=bizagi.clone(t);if(void 0===a.guid){var s=Math.guid();$.extend(a,{guid:s}),this.groupsReferences[s]={data:a}}void 0!==a.visibility&&$.extend(a,{hidden:" properties-group-hidden"});var l=void 0!==a.index,d={};for(l?0===a.index?(d.check1="properties-group-radio-check",d.check2="properties-group-radio-uncheck biz-action-btn"):(d.check1="properties-group-radio-uncheck biz-action-btn",d.check2="properties-group-radio-check"):(d.check1="properties-group-radio-uncheck biz-action-btn",d.check2="properties-group-radio-uncheck biz-action-btn"),$.extend(a,d),i=$.tmpl(this.getTemplate("frame-group-exclusive"),a),r=$(".ui-content-group",i),o=0;o<n;o++)switch(Object.keys(a.elements[o])[0]){case"property":if(void 0!==a.elements[o].property.notShow)break;l?a.index==o&&this.renderProperty(r[o],a.elements[o].property):this.renderProperty(r[o],a.elements[o].property);break;case"group":l?a.index==o&&this.renderGroup(r[o],a.elements[o].group):this.renderGroup(r[o],a.elements[o].group)}i.appendTo(e)}else{for(i=$.tmpl(this.getTemplate("frame-group"),t),r=$(".ui-content",i),o=0;o<n;o++)switch(Object.keys(t.elements[o])[0]){case"property":if(void 0!==t.elements[o].property.notShow)break;this.renderProperty(r,t.elements[o].property);break;case"group":this.renderGroup(r,t.elements[o].group)}$(i).find(".ui-content").children().length>0&&i.appendTo(e)}},renderCategory:function(e,t){var i,n,o,r,a;for(n=t.elements.length,i=$.tmpl(this.getTemplate("frame-category-simple"),t),a=$(".ui-content",i),o=0;o<n;o++)r=t.elements[o].property,this.renderProperty(a,r);i.appendTo(e)},registerProperty:function(e){this.refProperties[e.options.name]=e},setAsCollapsible:function(e){$("h3.ui-legend",e).unbind("click"),$("h3.ui-legend",e).bind("click",function(e){e.stopPropagation();var t=$(this).next();t.is(":visible")?t.slideUp():t.slideDown()})},addThemeStyle:function(){var e=this.element;e.addClass("biz-work-panel"),e.addClass("biz-border-all"),e.addClass("biz-shadow-modal"),e.addClass("biz-border-color"),e.addClass("biz-modal"),e.addClass("ui-corner-bottom"),e.removeClass("ui-corner-all"),$("ul.ui-widget-header",e).addClass("biz-gradient-v")},resizePanel:function(){var e,t;e=this.element,t=.95*$(".left-panel").height(),parseFloat($("> ul",e).height()),e.css({height:t})},destroy:function(){var e=this.element;if(e.hasClass("ui-tabs")){var t=e.tabs("option","active");this.setLastActiveTabForRender(this.idRender,t,this.scrollPanel),this.selectTabLeftPanel(),$(".sp-container").remove(),this.element.tabs("destroy")}this.element.hide()},onPropertyEditorChanged:function(e){return e.typeEvent=e.typeEvent||bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,this.presenter.publish("propertyChanged",e)},performValidationToShowTabOnLiveProcesses:function(e){if(!this.adhocProcessId)return!0;var t=!1;e.elements&&e.elements.length>0&&(t=e.elements.filter(function(e){return e.group||e.property.show}).length>0);return t},".ui-properties-close .ui-close-btn click":function(){this.destroy()},".bizagi_editor_component_editor click":function(e){$(".bizagi_editor_component_editor",this.element).removeClass("editor-selected"),e.addClass("editor-selected"),e.trigger("outEditor",[e])},outEditor:function(e,t,i){$(".bizagi_editor_component_editor_booleanrule > div > span",e).removeClass("editor-arrow-down-enabled").addClass("editor-arrow-down-disabled"),i.find("> div > span").removeClass("editor-arrow-down-disabled").addClass("editor-arrow-down-enabled"),$(".bizagi_editor_component_editor_booleanrule .editor-options").removeClass("editor-options-enabled").addClass("editor-options-disabled")},".bizagi_editor_component_editor input focus":function(e){$(".bizagi_editor_component_editor",this.element).removeClass("editor-selected"),e.closest(".bizagi_editor_component_editor").addClass("editor-selected")},".properties-category > span click":function(e){var t=e.next();e.toggleClass("close").toggleClass("open"),t.slideToggle()},click:function(e,t){return t.stopPropagation(),!1},".properties-group-exclusive-header click":function(e){var t,i=e.closest(".properties-group-exclusive",e),n=i.parent(),o=$(".properties-group-exclusive-header",n),r=i.attr("data-guid"),a=o.index(e);i.remove(),t=this.groupsReferences[r].data,$.extend(t,{index:a}),this.renderGroup(n,t)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.properties.presenter",{},{init:function(e){this._super(),(e=e||{}).mainContainer?this.canvas=$("<div />").appendTo(e.mainContainer):this.canvas=e.canvas||$("<div />").appendTo("form-modeler"),this.propertyBox=new bizagi.editor.component.properties(this.canvas,$.extend(e,{presenter:this}))},destroy:function(){this.propertyBox&&this.propertyBox.destroy(),this.canvas&&this.canvas.remove(),this.propertyBox=null,this.canvas=null},render:function(e){this.propertyBox&&this.propertyBox.render(e)}}),bizagi.editor.component.properties.parser=function(e,t){},bizagi.editor.component.properties.processrules=function(e,t,i){var n,o,r={},a=function(e){var n,o,a,l,d="";for(n=e.split(","),o=0;o<n.length;o++)0===o?(l=i[n[o]],a=t.elements[0].tabs[l.tab].elements[l.index].property):o===n.length-1?(d=a[n[o]],r[e]=a):a=s(a,n[o]);return d},s=function(e,t){if(/^.+\[.+\]\(.+\)$/.test(t)){var i=t.replace(/^(.+)\[(.+)\]\((.+)\)$/,"$1:$2:$3").split(":");return e[i[0]][parseInt(i[1])].property}return e[t]};if($.isArray(e)&&e.length>0)for(n=0;n<e.length;n++)o=a(e[n]),e[n],function(e){var t;if(/^<.+:+.+$/.test(e)){var i=e.substring(1,e.length-1).split(":");for(t=0;t<i.length;t++)if(0===t)switch(i[t]){case"design":break;default:return}}}(o)},bizagi.editor.component.properties.hasRule=function(e){var t=void 0,i=-1,n=/^<.*:+.*>$/,o=function(e,n,o){if(void 0===t)(t=[])[++i]=e;else if(void 0===n)t[++i]=e;else if(void 0===o)t[i]=e+","+t[i];else for(var r=0;r<=i;r++)t[r]=e+","+t[r]},r=function(e,t,i){for(var a,s,l=0;l<e.length;l++)if(void 0===(a=e[l]).more)void 0!==t[a.name]&&n.test(t[a.name])&&(o(a.name),i.paint=!0);else if(void 0!==t[a.name])if($.isArray(t[a.name]))for(var d=0;d<t[a.name].length;d++)s={},r(a.more,t[a.name][d].property,s),void 0!==s.paint&&(o(a.name+"["+d+"]("+t[a.name][d].property.name+")",!0),i.paint=!0);else s={},r(a.more,t[a.name],s),void 0!==s.paint&&(o(a.name,!0),i.paint=!0)},a={};return r([{name:"subproperties",more:[{name:"editor-parameters",more:[{name:"entity"}]}]},{name:"editor-parameters",more:[{name:"entity"}]},{name:"subproperties",more:[{name:"default"}]},{name:"subproperties",more:[{name:"editor-parameters",more:[{name:"context"}]}]},{name:"editor-parameters",more:[{name:"showtime",more:[{name:"rule"}]}]},{name:"editor-parameters",more:[{name:"allowdecimals",more:[{name:"rule"}]}]}],e,a),void 0!==a.paint&&o(e.name,!0,!0),t},bizagi.editor=bizagi.editor||{},bizagi.editor.component=bizagi.editor.component||{},bizagi.editor.component.properties=bizagi.editor.component.properties||{},bizagi.editor.component.properties.commands=bizagi.editor.component.properties.commands||{},bizagi.editor.component.properties.commands.factory=function(){var createRuleCommand=function(e){return new bizagi.editor.component.properties.commands.rule(e)},createCommand=function(args){if(void 0!==args.command)try{args.command=args.command.replace("-","");var fn=eval("var bafn = function(args) {  return new bizagi.editor.component.properties.commands."+args.command+"(args);};bafn"),command=fn(args);return command}catch(e){return null}return null};return{createCommand:createCommand,createRuleCommand:createRuleCommand}}(),bizagi.editor.observableClass.extend("bizagi.editor.component.properties.commands.base",{},{init:function(e){e=e||{},this._super(),this.args=e,this.element=e.element,this.properties=e.element.properties,this.key=e.key,this.indexedProperty=e.indexedProperty,this.communicationProtocol=bizagi.editor.communicationprotocol.factory},execute:function(){}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.rule",{rulePropertiesCache:{}},{execute:function(){var e=bizagi.editor.utilities.resolveProperty(this.properties,this.key);return bizagi.editor.utilities.isObject(e)&&bizagi.editor.utilities.isObject(e.baref)?this.updateRuleDisplayName(e):e},updateRuleDisplayName:function(e){var t=this,i=bizagi.editor.utilities.resolveComplexReference(e);if(t.Class.rulePropertiesCache[i])return e=t.Class.rulePropertiesCache[i],t.element.assignProperty(t.key,e,!1),e;var n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getruledisplayname",guid:i});return $.when(n.processRequest()).done(function(n){e.displayName=n?n.displayName:rule.displayName,t.element.assignProperty(t.key,e,!1),t.Class.rulePropertiesCache[i]=e}),e}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.groupby",{},{execute:function(){this.parentIsGrid()&&(this.indexedProperty.notShow=!0)},parentIsGrid:function(){return"grid"==this.element.parent.type}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.showcolumn",{},{execute:function(){this.parentIsGrid()&&(this.indexedProperty.notShow=!0)},parentIsGrid:function(){return"grid"==this.element.parent.type}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.userconfirmation.userconfirmationmessage",{execute:function(){var e=bizagi.util.parseBoolean(this.element.resolveProperty("userconfirmation.needsuserconfirmation"));this.indexedProperty.show=!!e}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.displaytype",{},{execute:function(){this.parentIsGrid()&&(this.indexedProperty.notShow=!0)},parentIsGrid:function(){return"grid"==this.element.parent.type}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.isadministrable",{},{execute:function(){"parameter"!=this.element.triggerGlobalHandler("getContextEntityType")&&(this.indexedProperty.notShow=!0)}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.selectProcess",{},{execute:function(){"application"!=this.element.triggerGlobalHandler("getContextEntityType")?this.indexedProperty.notShow=!0:this.indexedProperty.allowClick=this.element.triggerGlobalHandler("getControllerInfo",{type:"isNewForm"})}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.allowdecimals",{},{execute:function(){var e,t=this.element.triggerGlobalHandler("getControllerInfo",{type:"isGridContext"})?this.element.triggerGlobalHandler("getControllerInfo",{type:"getXpathNavigatorModelGrid"}):this.element.triggerGlobalHandler("getControllerInfo",{type:"getXpathNavigatorModel"});if(this.properties.xpath){var i=bizagi.editor.utilities.resolveComplexXpath(this.properties.xpath);node=t.getNodeByXpath(i);var n=node&&node.getDataType();("OracleNumber"==(e=n)||"BigInt"==e||"Int"==e||"SmallInt"==e||"TinyInt"==e)&&(this.indexedProperty.notShow=!0,this.properties.allowdecimals=!1)}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.buttonrule",{},{execute:function(){"formbutton"==this.element.type&&(this.element.triggerGlobalHandler("getControllerInfo",{type:"isStartFormContext"})&&(this.indexedProperty.notShow=!0))}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.visible",{},{execute:function(){"formbutton"==this.element.type&&(this.element.triggerGlobalHandler("getControllerInfo",{type:"isStartFormContext"})&&(this.indexedProperty.notShow=!0))}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.defaultinclude",{},{execute:function(){!this.parentIsGrid()&&this.properties.selectable||(this.indexedProperty.notShow=!0)},parentIsGrid:function(){return"grid"==this.element.parent.type}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.numberrange",{},{execute:function(){var e=this.element.triggerGlobalHandler("getControllerInfo",{type:"isGridContext"})?this.element.triggerGlobalHandler("getControllerInfo",{type:"getXpathNavigatorModelGrid"}):this.element.triggerGlobalHandler("getControllerInfo",{type:"getXpathNavigatorModel"});if(this.properties.xpath){var t=bizagi.editor.utilities.resolveComplexXpath(this.properties.xpath);node=e.getNodeByXpath(t),node&&"oracleNumber"==node.getRenderType()&&(this.properties.allowdecimals=!1,this.indexedProperty.notShow=!0)}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.defaultvalue",{},{execute:function(){var e=this.element.triggerGlobalHandler("getControllerInfo",{type:"isGridContext"})?this.element.triggerGlobalHandler("getControllerInfo",{type:"getXpathNavigatorModelGrid"}):this.element.triggerGlobalHandler("getControllerInfo",{type:"getXpathNavigatorModel"});if(this.properties.xpath){var t=bizagi.editor.utilities.resolveComplexXpath(this.properties.xpath);node=e.getNodeByXpath(t),node&&"oracleNumber"==node.getRenderType()&&(this.indexedProperty.notShow=!0)}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.actions",{},{execute:function(){"formbutton"==this.element.type&&(this.element.triggerGlobalHandler("getControllerInfo",{type:"isStartFormContext"})&&(this.indexedProperty.notShow=!0))}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.maxlines",{},{execute:function(){0==this.element.properties.isextended||"false"==this.element.properties.isextended?this.indexedProperty.show=!1:this.indexedProperty.show=!0}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.formatvalue",{},{execute:function(){"label"==this.element.properties.displaytype?this.indexedProperty.show=!1:this.indexedProperty.show=!0}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.format",{},{execute:function(){"value"==this.element.properties.displaytype?this.indexedProperty.show=!1:this.indexedProperty.show=!0}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.xpath",{},{execute:function(){this.element.properties.typedinamic&&("databind"===this.element.properties.typedinamic&&this.properties.allowdinamiclabel?this.indexedProperty.show=!0:this.indexedProperty.show=!1),this.indexedProperty.value}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.xpathAdhoc",{},{execute:function(){var e=this;function t(){var t="";if(!e.element.properties.xpathAdhoc){if(0===(t=e.element.properties.displayName instanceof Object?bizagi.editor.utilities.getXPathByDisplayName(e.element.properties.displayName.i18n.default):bizagi.editor.utilities.getXPathByDisplayName(e.element.properties.displayName)).length){t=e.element.type.replace("adhoc","")+"_"+function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<5;i++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}()}t=t.substr(0,1).toLowerCase()+t.substr(1),e.element.properties.xpathAdhoc={xpath:t,relatedEntity:null}}}e.element.properties.draggedProperty||e.element.isSaved()?(e.element.properties.xpathAdhoc=e.element.properties.xpathAdhoc||e.element.originalLoadedProperties.xpathAdhoc,void 0===e.element.properties.xpathAdhoc&&t()):t()}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.tagslist",{tagsCache:{}},{execute:function(){if(this.indexedProperty.show=!0,this.element.properties.xpath){var e=this.Class.tagsCache,t=bizagi.editor.utilities.resolveRelatedEntityFromXpath(this.element.properties.xpath);if(e[t])this.indexedProperty["editor-parameters"].tags=e[t];else{var i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"gettags",parameters:[{key:"id",value:t}]});this.indexedProperty["editor-parameters"].tags=i.processRequest(),$.when(i.processRequest()).done(function(i){e[t]=i||[]})}}else this.indexedProperty.show=!1}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.data.filter",{},{execute:function(){this.element.properties.typedinamic&&("databind"===this.element.properties.typedinamic&&this.properties.allowdinamiclabel?this.indexedProperty.show=!0:this.indexedProperty.show=!1)}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.data.datasource",{},{execute:function(){"adhocsuggest"==this.element.properties.type?(this.indexedProperty.showAdhocEntitiesControl=!this.element.propertyModel.designProperties.data.subproperties.datasource.ignoreAdhocEntities,this.indexedProperty.showPredefinedValuesControl=!1,this.indexedProperty.isAdhocSuggestControl=!0):(this.indexedProperty.showPredefinedValuesControl=!0,this.indexedProperty.showAdhocEntitiesControl=!0)}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.data.displayattrib",{},{execute:function(){this.element.properties.typedinamic&&("databind"===this.element.properties.typedinamic&&this.properties.allowdinamiclabel?this.indexedProperty.show=!0:this.indexedProperty.show=!1)}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.data.sortattribute",{},{execute:function(){}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.data.adhocdisplayattrib",{metadataCache:{}},{execute:function(){var e=this,t=[],i=new $.Deferred;if(e.element.properties.data.datasource&&"adhoc"===e.element.properties.data.datasource.type){var n=e.Class.metadataCache,o=e.element.properties.data.datasource.guid;if(n[o])t=n[o],i.resolve(t);else{var r=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getadhocentityattribs",parameters:[{key:"guid",value:o}]});$.when(r.processRequest()).done(function(e){n[o]=e,t=e,i.resolve(t)})}e.indexedProperty.show=!0}else e.element.properties.data.datasource&&"bizagi"===e.element.properties.data.datasource.type&&(e.element.properties.data.adhocdisplayattrib=null),e.indexedProperty.show=!1;e.indexedProperty["editor-parameters"].attribs=i.promise()}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.datarule",{},{execute:function(){"ruleexpression"===this.element.properties.typedinamic&&this.properties.allowdinamiclabel?this.indexedProperty.show=!0:this.indexedProperty.show=!1}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.typedinamic",{},{execute:function(){var e=this;e.properties.allowdinamiclabel?e.indexedProperty.show=!0:(e.indexedProperty.show=!1,e.element.requiredPropertiesOverrides({xpath:!1,"data.displayattrib":!1,"data.filter":!1,datarule:!1})),"databind"===e.element.properties.typedinamic&&e.properties.allowdinamiclabel?(e.element.requiredPropertiesOverrides({xpath:!0,"data.displayattrib":!0,"data.filter":!0,datarule:!1}),e.element.setProperty("datarule",void 0)):"ruleexpression"===e.element.properties.typedinamic&&e.properties.allowdinamiclabel&&(e.element.requiredPropertiesOverrides({xpath:!1,"data.displayattrib":!1,"data.filter":!1,datarule:!0}),e.element.setProperty("xpath",void 0),e.element.setProperty("data.displayattrib",void 0),e.element.setProperty("data.filter","")),e.element.validRequiredProperties(),e.element.validRequiredDependentProperties()}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.displayName",{},{execute:function(){this.properties.allowdinamiclabel?this.indexedProperty.show=!1:this.indexedProperty.show=!0}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.isexclusive",{},{execute:function(){var e=this,t=e.element.triggerGlobalHandler("getControllerInfo",{type:"isGridContext"});if("option"==e.properties.display&&t?(e.indexedProperty.show=!1,e.properties.isexclusive=!1):e.indexedProperty.show=!0,"check"===e.properties.display&&e.properties.isexclusive){var i=e.element.triggerGlobalHandler("getControllerInfo",{type:"searchDependencies",guids:[e.args.element.guid],message:bizagi.localization.getResource("formmodeler-command-searchdependencies-error-column-check")});$.when(i).done(function(t){t.result||(e.properties.isexclusive=!1)})}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.required",{},{execute:function(){"check"===this.properties.display&&this.properties.isexclusive?this.indexedProperty.show=!1:this.indexedProperty.show=!0}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.totalize",{},{execute:function(){"check"===this.properties.display&&this.properties.isexclusive?this.indexedProperty.show=!1:this.indexedProperty.show=!0}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.submitonchange",{},{execute:function(){"check"===this.properties.display&&this.properties.isexclusive?this.indexedProperty.show=!1:this.indexedProperty.show=!0}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.thousands",{},{execute:function(){var e=this.element.triggerGlobalHandler("getControllerInfo",{type:"isGridContext"})?this.element.triggerGlobalHandler("getControllerInfo",{type:"getXpathNavigatorModelGrid"}):this.element.triggerGlobalHandler("getControllerInfo",{type:"getXpathNavigatorModel"});if(this.properties.xpath){var t=bizagi.editor.utilities.resolveComplexXpath(this.properties.xpath);node=e.getNodeByXpath(t),"TinyInt"==node.getDataType()&&(this.indexedProperty.notShow=!0,this.properties.allowdecimals=!1)}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.enabledby.stakeholders",{stakeholdersPromise:{resolve:!1}},{execute:function(){var e=this,t=e.Class.stakeholdersPromise;if(t.resolve)e.indexedProperty["editor-parameters"].stakeholders=t.resolve;else{var i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getstakeholders"});e.indexedProperty["editor-parameters"].stakeholders=i.processRequest(),$.when(i.processRequest()).done(function(t){e.Class.stakeholdersPromise.resolve=t})}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.selecttemplate",{templatesPromise:{},regexParameter:/<\w+:([\w:]+)>/},{execute:function(){var e=this.Class.templatesPromise;this.indexedProperty["editor-parameters"].templates=null,this.indexedProperty.show=!1;var t=this.getRelatedEntity();if(t){e[t]=e[t]||{},this.indexedProperty.show=!0;var i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"gettemplates",entityGuid:t});this.indexedProperty["editor-parameters"].templates=i.processRequest(),this.indexedProperty["editor-parameters"].templatetype=this.getTemplateType()}},getRelatedEntity:function(){if(editorParameters=this.indexedProperty["editor-parameters"]||{},entity=editorParameters.entity,!entity)return!1;var e=/<\w+:([\w:]+)>/.exec(entity)[1].replace(/:/g,"."),t=this.element.resolveProperty(e);return!!t&&bizagi.editor.utilities.resolveComplexReference(t)},getTemplateType:function(){var e=this.Class.regexParameter,t=(this.indexedProperty["editor-parameters"]||{}).type;if(t){var i=e.exec(t)[1].replace(/:/g,".");return this.element.resolveProperty(i)||!1}return!1}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.newrecords",{},{execute:function(){var e=this;if(e.properties.newrecords){if("search"==e.element.type||"columnsearch"==e.element.type){var t=e.element.triggerGlobalHandler("getNodeInfo",{xpath:bizagi.editor.utilities.resolveComplexXpath(e.properties.xpath)});t&&"entity-parametric"==t.nodeSubtype&&(e.indexedProperty.notShow=!0)}bizagi.util.parseBoolean(e.properties.newrecords.allownew)?e.element.requiredPropertiesOverrides({"newrecords.allownewform":!0}):bizagi.util.parseBoolean(e.properties.newrecords.allownew)||e.element.requiredPropertiesOverrides({"newrecords.allownewform":!1})}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.multipleselection",{},{execute:function(){"actionlauncher"==this.element.type&&(bizagi.util.parseBoolean(this.element.resolveProperty("multipleselection"))&&this.element.assignProperty("required",{fixedvalue:"false"},!1))}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.required",{},{execute:function(){if("actionlauncher"==this.element.type){var e=bizagi.util.parseBoolean(this.element.resolveProperty("multipleselection"));this.indexedProperty.show=!e}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.maxitems",{},{execute:function(){"entitytemplate"==this.element.type&&(value=bizagi.util.parseBoolean(this.element.resolveProperty("allowactions")),value?this.indexedProperty.show=!0:this.indexedProperty.show=!1)}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.allowactions",{},{execute:function(){if("entitytemplate"==this.element.type){var e=this.element.triggerGlobalHandler("getControllerInfo",{type:"isStartFormContext"});this.indexedProperty.show=!e}}}),bizagi.editor.component.properties.commands.base.extend("bizagi.editor.component.properties.commands.relatedforms",{relatedFormsCache:{}},{execute:function(){var e=this,t=e.element.resolveProperty("xpath");if(e.properties&&bizagi.editor.utilities.isObject(t)||!e.element.isRequiredProperty("xpath")){var i=bizagi.editor.utilities.resolveRelatedEntityFromXpath(t),n=(t=bizagi.editor.utilities.resolveComplexXpath(t),i+"_"+e.indexedProperty["bas-type"]);if(e.Class.relatedFormsCache[n])e.indexedProperty.relatedForms=e.Class.relatedFormsCache[n];else{var o=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"relatedforms",xpath:e.element.triggerGlobalHandler("getContextXpath",{xpath:t}),relatedEntity:i,context:e.indexedProperty["bas-type"],isScopeAttribute:e.element.triggerGlobalHandler("getNodeInfo",{xpath:t,callback:function(e){return e.isScopeAttribute}})});e.indexedProperty.relatedForms=e.Class.relatedFormsCache[n]=o.processRequest(),$.when(e.indexedProperty.relatedForms).done(function(t){e.Class.relatedFormsCache[n]=t||[]})}}else e.indexedProperty.relatedForms=[]}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.navigationform",{},{execute:function(){return this._super()}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.form",{},{execute:function(){return this._super()}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.addform",{},{execute:function(){return this._super()}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.editform",{},{execute:function(){return this._super()}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.detail.detailform",{},{execute:function(){return this._super()}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.add.addform",{},{execute:function(){return this._super()}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.edit.editform",{},{execute:function(){return this._super()}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.newrecords.allownewform",{},{execute:function(){return this._super()}}),bizagi.editor.component.properties.commands.relatedforms.extend("bizagi.editor.component.properties.commands.searchforms",{},{execute:function(){this._super(),this.element.properties.xpath||(this.indexedProperty.notShow=!0)}}),bizagi.editor.component.controller("bizagi.editor.component.decorator",{init:function(e,t){t=t||{},this._super(e),this.canvas=e,this.presenter=t.presenter,this.model=t.model,this.data=t.data,this.tmpl={}},updateModel:function(e){this.model=e,this.update()},render:function(){var e=this;$(".ui-decorator-tooltip").remove(),null!=e.targetElement&&e.targetElement.removeClass("container-decorator"),void 0!==e.data.element&&(e.targetElement=e.data.element,e.targetElement.addClass("container-decorator")),$.when(e.loadTemplates()).done(function(){e.element.appendTo(e.targetElement),e.element.addClass("ui-control-decorator"),e.element.show(),e.element.empty(),e.renderDecorator(e.element)})},renderDecorator:function(e){var t=$.tmpl(this.getTemplate("decoratorFrame"),this.model),i=$(".biz-decorator-specific-options",t).clone().addClass("ui-clone");e.parent().outerHeight(!0)>470&&i.appendTo(e),t.appendTo(e),this.setDecoratorPosition(t,e),$(".biz-ico.decorator-image",this.element).tooltip({tooltipClass:"ui-widget-content ui-decorator-tooltip",position:{my:"left top",at:"left bottom",offset:"0 10"}})},setDecoratorPosition:function(e,t){var i=t.parent().closest(".ui-col"),n=$(".biz-decorator-standard-options",e);i.length>0&&(i[0].scrollWidth>i.outerWidth()&&e.addClass("ui-decorator-left"),i.outerWidth()<n.outerWidth()&&e.addClass("ui-decorator-vertical"))},remove:function(){void 0!==this.targetElement&&this.targetElement.removeClass("container-decorator"),$(".ui-decorator-tooltip").remove(),this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("decoratorFrame",bizagi.getTemplate("bizagi.editor.component.decorator").concat("#decorator-frame"))).done(function(){e.resolve()}),e.promise()},destroy:function(){$(".ui-decorator-tooltip").remove(),this.element.detach()},".decorator-gear click":function(e,t){t.stopPropagation(),this.presenter.publish("showProperties",this.data)},".decorator-bind click":function(e,t){t.stopPropagation(),this.presenter.publish("showXpathNavigator",this.data)},".decorator-delete click":function(e,t){t.stopPropagation(),this.presenter.publish("deleteElement",this.data.guid)},".decorator-edit click":function(e,t){t.stopPropagation(),this.presenter.publish("openNestedForm",this.data.guid)},".editor-ui-button-actions click":function(e,t){t.stopPropagation();var i=e.data("id");this.presenter.publish("buttonClicked",{button:i,guid:this.data.guid})}}),bizagi.editor.observableClass.extend("bizagi.editor.component.decorator.presenter",{},{init:function(e){e=e||{},this._super(),this.canvas=e.canvas,this.model=e.model,this.decoratedElement=e.data.element,this.decorator=new bizagi.editor.component.decorator(this.canvas,$.extend(e,{presenter:this}))},destroy:function(){this.decorator.destroy()},remove:function(){this.decorator.remove()},getDecoratedElement:function(){return this.decoratedElement},render:function(e){return e=e||{},this.model=e.model||this.model,this.decorator.updateModel(this.model),this.decorator.render(e)}}),$.Class.extend("bizagi.editor.component.decorator.model",{getSpecificModel:function(e){var t=e.type||e.name;if(this.models={grid:{specificOptions:[{id:"ConfigGrid",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editcolumns"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},offlinegrid:{specificOptions:[{id:"ConfigGrid",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editcolumns"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},offlinesmartphonegrid:{specificOptions:[{id:"ConfigGrid",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editcolumns"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},offlinetabletgrid:{specificOptions:[{id:"ConfigGrid",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editcolumns"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},smartphonegrid:{specificOptions:[{id:"ConfigGrid",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editcolumns"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},tabletgrid:{specificOptions:[{id:"ConfigGrid",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editcolumns"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},adhocgrid:{specificOptions:[{id:"ConfigGrid",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editcolumns"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}],standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]},groupedgrid:{specificOptions:[{id:"ConfigGrid",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editcolumns"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},nestedform:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}],specificOptions:[{id:"EditNestedForm",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editform"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},querynestedform:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}],specificOptions:[{id:"EditNestedForm",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-editform"),css:"bz-studio bz-extended-table-edit-record_16x16_standard"}]},horizontal:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]},container:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]},formbutton:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]},query:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]},adhoc:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]},adhoccolumn:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]},adhoccontainer:{standardOptions:[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]}},this.standardOptions=[{allowProperties:!0,id:"gear",displayName:bizagi.localization.getResource("bizagi-editor-properties-caption"),css:"bz-studio bz-settings_16x16_standard"},{allowXpath:!0,id:"bind",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-bind"),css:"bz-studio bz-boolean-xpath_16x16_standard"},{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}],bizagi.form.modeler.currentView===bizagi.form.modeler.viewType.Smartphone&&(this.standardOptions=[{allowDelete:!0,id:"delete",displayName:bizagi.localization.getResource("bizagi-editor-decorator-model-allowdelete"),css:"bz-studio bz-delete_16x16_standard"}]),"queryInternal"==t||"query"==t)var i=this.models.query||{standardOptions:this.standardOptions};else if("template"==t)i={standardOptions:[]};else i=this.models[e.name]||this.models[t]||{standardOptions:this.standardOptions};return i.standardOptions||(i.standardOptions=this.standardOptions),i}},{}),bizagi.editor.component.controller("bizagi.editor.component.readonlyeditor",{},{init:function(e,t){this._super(),t=t||{},this.canvas=e,this.model=t.model,this.presenter=t.presenter},loadTemplates:function(){var e={"readonlyeditor-container":bizagi.getTemplate("bizagi.editor.component.readonlyeditor").concat("#readonlyeditor-container")};return this._super(e)},render:function(){var e=this,t=e.element;t.empty(),$.when(e.loadTemplates()).done(function(){var i=e.readOnlyEditorTemplate=e.getTemplate("readonlyeditor-container");$.tmpl(i,e.model).appendTo(t)})},destroy:function(e){this.element.detach()},".biz-readonlyeditor-container span.bz-user-name click":function(e){this.presenter.publish("showUserInformation",{})}}),bizagi.editor.observableClass.extend("bizagi.editor.component.readonlyeditor.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas||$("<div />"),this.model=e.model||{},this.readonlyeditor=new bizagi.editor.component.readonlyeditor(this.canvas,{presenter:this,model:this.model})},render:function(){return this.readonlyeditor.render()},destroy:function(){this.readonlyeditor&&(this.readonlyeditor.destroy(),this.readonlyeditor=null)}}),bizagi.editor.component.controller("bizagi.editor.component.ribbon",{init:function(e,t){this._super(),t=t||{},this.canvas=e,this.model=t.model,this.presenter=t.presenter,this.communicationProtocol=bizagi.editor.communicationprotocol.factory,this.constants=bizagi.editor.base.constants,this.viewId=t.viewId,this.loadAvailableLanguages()},loadTemplates:function(){var e={layout:bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-layout",tab:bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-tab",group:bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-group","group-caption":bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-group-caption",button:bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-button","button-horizontal":bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-button-horizontal","button-horizontal-item":bizagi.getTemplate("bizagi.editor.component.ribbon")+"#contextmenu-button-horizontal-item","button-vertical":bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-button-vertical","button-with-items":bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-button-with-items","button-subitem":bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-button-subitem","button-offline":bizagi.getTemplate("bizagi.editor.component.ribbon")+"#ribbon-button-offline"};return this._super(e)},render:function(e){var t=this;e=e||{},t.model=e.model||t.model,t.itemsPerRow=3,$.when(t.loadTemplates()).done(function(){t.element.empty();var e=t.model.getViewModel(),i=t.model.customOptions;$.when(t.renderGroups(t.element,e.elements,i)).done(function(){$(".ribbon-group-col .ui-cells > [title].biz-btn-horizontal",t.element).tooltip({tooltipClass:"ui-widget-content ui-ribbon-tooltip ui-ribbon-horizontal-tooltip",position:{my:"left top+10",at:"left bottom"}}),$(".ribbon-group-col > [title].biz-btn-vertical",t.element).tooltip({tooltipClass:"ui-widget-content ui-ribbon-tooltip ui-ribbon-vertical-tooltip",position:{my:"left top+10",at:"left bottom"}})})})},updateModel:function(e){this.model=e},renderLayout:function(e){var t=$.tmpl(this.getTemplate("layout"),{});$.tmpl(this.getTemplate("tab"),{}).appendTo(t),t.appendTo(e)},renderGroups:function(e,t,i){for(var n,o,r=0;r<t.length;r++)n=$.tmpl(this.getTemplate("group"),{}),o=t[r],this.renderElements(n,o),this.renderGroupCaption(n,o),n.appendTo(e);this.renderCustomOptions(e,i)},renderCustomOptions:function(e,t){var i=this;t.forEach(function(t){switch(t.name){case i.constants.SUPPORT_OFFLINE:var n=$.tmpl(i.getTemplate("button-offline"),{checked:t.value,viewId:"offline__state_"+i.viewId,readOnly:t.readOnly});n.find(".button__offline--state").on("change",function(e){i.presenter.publish("onItemClicked",{property:"offlineIsEnabled",value:e.target.checked,action:"enableOffline"})}),n.appendTo(e)}})},renderGroupCaption:function(e,t){$.tmpl(this.getTemplate("group-caption"),t).appendTo(e)},renderElementSubItem:function(e,t){$.tmpl(this.getTemplate("button-subitem"),t).appendTo(e)},renderElement:function(e,t){var i=t.align?t.align.toLowerCase():"horizontal";("value"in t?$.tmpl(this.getTemplate("button-horizontal-item"),t):$.tmpl(this.getTemplate("button-"+i),t)).appendTo(e)},renderElements:function(e,t){var i,n,o,r,a,s=0,l=t.elements.length,d=$.tmpl(this.getTemplate("button"));for(d.appendTo(e),i=0;i<l;i++)i%this.itemsPerRow==0&&(a=$("<div class='ui-cells ui-pos-"+s+"'></div>").appendTo(d),s++),r=(n=t.elements[i]).align?n.align.toLowerCase():"horizontal",n.elements?"horizontal"===r?this.renderElementWithItems(a,n):((o=$.tmpl(this.getTemplate("button"),n)).appendTo(e),this.renderElementWithItems(o,n)):"horizontal"===r?this.renderElement(a,n):((o=$.tmpl(this.getTemplate("button"),n)).appendTo(e),this.renderElement(o,n))},renderElementWithItems:function(e,t){var i,n,o,r=t.elements.length;if(t.disabled)(i=$.tmpl(this.getTemplate("button-horizontal"),t)).appendTo(e);else{(i=$.tmpl(this.getTemplate("button-with-items"),t)).appendTo(e),o=i.find("ul:lt(1)");for(var a=0;a<r;a++)n=t.elements[a],this.renderElement(o,n);this.fixElementsPosition()}},fixElementsPosition:function(){var e=this;setTimeout(function(){$(".biz-dropdown",e.element).each(function(){var e=$(this),t=0;e.children()&&e.children().length>0&&e.children().each(function(){var e=$(this);e.text().trim().length>25&&t<e.width()&&(t=e.width())}),t>0&&e.css("width",t+20+"px")})},500)},remove:function(){this.element.hide(),this.element.empty()},loadAvailableLanguages:function(){var e=this,t=e.communicationProtocol.createProtocol({protocol:"availablelanguages"});$.when(t.processRequest()).done(function(t){if($.isArray(t)){var i=t.map(function(e){var t=JSON.parse(e.value);return{caption:t.displayname,style:t.displayname,property:"language",action:"Language",value:t}}),n=e.model.groups.languages;if("object"==typeof n&&null!==n&&$.isArray(n.elements)){var o=e.model.items[n.elements[0].guid];e.model.addChildren(i,o),e.render()}}})},"div.biz-btn click":function(e){var t=this,i=e.data("guid"),n=t.model.getElement(i);n.items||n.disabled||("save"===n.action&&(t.model.disableAction("save"),t.render()),setTimeout(function(){t.presenter.publish("onItemClicked",{property:n.property,value:n.value,action:n.action})},500))}}),bizagi.editor.observableClass.extend("bizagi.editor.component.ribbon.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas,this.model=e.model,this.ribbon=new bizagi.editor.component.ribbon(this.canvas,$.extend(e,{presenter:this}))},getGuid:function(){return this.guid},render:function(e){return e=e||{},this.guid=e.guid||null,this.ribbon.render(e)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.ribbon.model",{},{init:function(e){this.model=e,this._super(),this.items={},this.properties={},this.actions={},this.groups={},this.customOptions=e.customOptions||[],e.elements&&this.processElements(e.elements,!0)},getViewModel:function(){for(var e={elements:[]},t=0,i=this.model.elements.length;t<i;t++){var n=this.model.elements[t];n.hide||e.elements.push(n)}return e},addChildren:function(e,t){(e=e||[]).forEach(function(e){return t.elements.push(e)}),this.processElements(e)},processElements:function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.guid=n.guid||Math.guid(),n.caption=bizagi.localization.getResource(n.caption)||"",n.tooltip=n.tooltip?bizagi.localization.getResource(n.tooltip):n.caption,t&&(this.groups[n.name]=n),this.items[n.guid]=n,n.property&&!n.value&&(this.properties[n.property]=n),n.action&&(this.actions[n.action]=n),n.property&&n.value){var o=this.properties[n.property];o.values=o.values||{},o.values[JSON.encode(n.value)]=n}n.disabled=1==n.disabled||"disabled"==n.disabled,n.originalDisabled=n.disabled,n.elements&&this.processElements(n.elements)}},getCustomOptions:function(){return this.customOptions},getElementByAction:function(e){return this.actions[e]},processElementsForConvertTo:function(e){this.processElements(e)},getElement:function(e){return this.items[e]},reset:function(){$.each(this.properties,function(e,t){t.disabled=t.originalDisabled}),$.each(this.actions,function(e,t){t.disabled=t.originalDisabled})},enableProperty:function(e,t){var i=this.properties[e];if(i){for(var n in i.disabled=!1,i.values)i.values[n].selected=!1;(t="undefined"!==t&&"boolean"==typeof t?t.toString():t)&&(i.values[JSON.encode(t)]?i.values[JSON.encode(t)].selected=!0:"object"==typeof t.rule&&(i.values[JSON.encode("expression")].selected=!0))}},disableProperty:function(e){var t=this.properties[e];t&&(t.disabled=!0)},enableAction:function(e){var t=this.actions[e];t&&(t.disabled=!1)},disableAction:function(e){var t=this.actions[e];t&&(t.disabled=!0)},checkAction:function(e){var t=this.actions[e];t&&(t.checked=!0)},uncheckAction:function(e){var t=this.actions[e];t&&(t.checked=!1)},showGroup:function(e){var t=this.groups[e];t&&(t.hide=!1)},hideGroup:function(e){var t=this.groups[e];t&&(t.hide=!0)},setCaption:function(e,t){var i,n=this.properties[e];n&&$.isArray(n.elements)&&n.elements.length>0&&(i=$.grep(n.elements,function(e,i){return!(!e.value||!e.value.key)&&e.value.key===t})),i&&i[0]&&i[0].caption&&(n.caption=i[0].caption)}}),bizagi.editor.component.controller("bizagi.editor.component.statusbar",{},{init:function(e,t){this._super(),t=t||{},this.canvas=e,this.presenter=t.presenter,this.model=t.model||{},this.$mainContainer=t.mainContainer},loadTemplates:function(){var e={statusbar:bizagi.getTemplate("bizagi.editor.component.statusbar")+"#statusbar-container",statusbar_offline:bizagi.getTemplate("bizagi.editor.component.statusbar")+"#statusbar-container-offline",statusbar_online:bizagi.getTemplate("bizagi.editor.component.statusbar")+"#statusbar-container-online",statusbar_entity_offline:bizagi.getTemplate("bizagi.editor.component.statusbar")+"#statusbar-container-entity-offline",missing_controls:bizagi.getTemplate("bizagi.editor.component.statusbar")+"#missing-controls-container"};return this._super(e)},render:function(){var e=this,t=new $.Deferred,i=e.element;return i.empty(),e.$mainContainer.find(".missing--controls__container").remove(),$.when(e.loadTemplates()).done(function(){(e.model.isOfflineForm&&e.model.isEntityForm?e.renderEntityOffline():e.model.isOfflineForm?e.renderOffline():e.model.hasOffline?e.renderOnline():e.renderOfflineWithPreview()).appendTo(i),t.resolve()}),t.promise()},renderEntityOffline:function(){var e=this.getTemplate("statusbar_entity_offline");return $.tmpl(e,{})},renderOfflineWithPreview:function(){var e=this,t=e.getTemplate("statusbar"),i=$.tmpl(t,e.model);return i.find(">li:first").on("click","span, svg",function(){e.presenter.publish("onEditOfflineForm")}),i.find(">li:nth-child(2)").on("click","div",function(t){switch($(this).data("key")){case"online":e.presenter.publish("onViewOnline");break;case"preview":e.presenter.publish("onViewPreviewOffline"),setTimeout(function(){$.when(e.presenter.publish("getMissingOfflineControls")).done(function(t){if(t.length>0){var i=$.tmpl(e.getTemplate("missing_controls"),{controls:t});i.find(".missing--controls__close").on("click",function(t){t.stopPropagation(),e.$mainContainer.find(".missing--controls__container").remove()}),i.find(".help--bizagi").on("click",function(t){t.stopPropagation(),e.presenter.publish("onOpenBizagiHelp")}),i.appendTo(e.$mainContainer)}})},100)}}),i},renderOffline:function(){var e=this,t=e.getTemplate("statusbar_offline"),i=$.tmpl(t,e.model);return i.find(">li:first").on("click","span, svg",function(){e.presenter.publish("onRestoreOfflineForm")}),i.find(">li:nth-child(2)").on("click","div",function(t){switch($(this).data("key")){case"online":e.presenter.publish("onViewOnlineForm")}}),i},renderOnline:function(){var e=this,t=e.getTemplate("statusbar_online"),i=$.tmpl(t,e.model);return i.find(">li:nth-child(2)").on("click","div",function(t){switch($(this).data("key")){case"offline":e.presenter.publish("onViewOfflineForm")}}),i},refresh:function(e){this.model=e,this.render()}}),bizagi.editor.observableClass.extend("bizagi.editor.component.statusbar.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas||$("<div />"),this.statusbar=new bizagi.editor.component.statusbar(this.canvas,{presenter:this,model:e.model,mainContainer:e.mainContainer})},render:function(){this.statusbar.render()},refresh:function(e){this.statusbar.refresh(e)}}),bizagi.editor.component.controller("bizagi.editor.component.contextmenu",{init:function(e,t){this._super(e),t=t||{},this.canvas=e,this.model=t.model,this.presenter=t.presenter,this.mWidthDropDown=100,this.mainContainer=t.mainContainer},loadTemplates:function(){var e={"context-menu-container":bizagi.getTemplate("bizagi.editor.component.contextmenu")+"#contextmenu-container",button:bizagi.getTemplate("bizagi.editor.component.contextmenu")+"#contextmenu-button","button-separator":bizagi.getTemplate("bizagi.editor.component.contextmenu")+"#contextmenu-button-separator"};return this._super(e)},refresh:function(e){this.render(e)},render:function(e){var t=this;t.model=e.model||t.model,t.model.items&&(t.element.empty(),$.when(t.loadTemplates()).done(function(){var i=$.tmpl(t.getTemplate("context-menu-container"));t.renderItems($(".contextmenu-group",i),t.model.getViewModel()),i.appendTo(t.canvas),t.setDropdownWidth(),e.position&&t.updateContextMenuPosition(e.position),t.configureCloseHandler(),t.fixElementsPosition()}))},fixElementsPosition:function(){var e=this;setTimeout(function(){$(".biz-dropdown",e.element).each(function(){var e=$(this),t=e.outerWidth();t>180&&e.css("right",String(-160-(t-180))+"px")})},500)},setDropdownWidth:function(){var e=this;$(".biz-dropdown",e.element).each(function(){var t=$(this),i=e.mWidthDropDown;$(".contextmenu-group-row",t).each(function(){var e=$(this),t=$(".biz-ico",e).length,n=$(".biz-ico",e).outerWidth(!0)*t+10,o=$(".contextmenu-caption",e).outerWidth(!0)+n;o>i&&(i=o)}),t.width(i)})},configureCloseHandler:function(){$(document).bind("mouseup.contextmenu",function(e){if(0==e.button){var t=$(".contextmenu-container").parent();0===t.has(e.target).length&&(t.hide(),$(document).unbind("mouseup.contextmenu"))}})},updateContextMenuPosition:function(e){var t,i,n,o,r,a,s,l,d;n=this.element,t=e.x,i=e.y,o=this.mainContainer.width(),r=this.mainContainer.height(),a=n.width()+10,s=n.height()+10,l=Math.abs(t+a-o),d=Math.abs(i+s-r),t+a+135>o?(t=t-a-l+a,n.css("left",t),n.addClass("rightToLeft")):(n.css("left",e.x),n.removeClass("rightToLeft")),i+s+120>r?(i=i-s-d+s,n.css("top",i),n.addClass("bottomToTop")):(n.css("top",e.y),n.removeClass("bottomToTop")),n.show()},renderItems:function(e,t){if(t.items)for(var i=0;i<t.items.length;i++){var n=t.items[i];n.separator?this.renderSeparator(e,n):this.renderItem(e,n)}},renderItem:function(e,t){var i=$.tmpl(this.getTemplate("button"),$.extend(t,{hasItems:t.items&&t.items.length>0}));if(t.items){var n=i.find("ul:lt(1)");this.renderItems(n,t)}i.appendTo(e)},renderSeparator:function(e){$.tmpl(this.getTemplate("button-separator")).appendTo(e)},destroy:function(){this.element.detach()},"div.biz-btn click":function(e){var t=e.data("guid"),i=this.model.getItem(t);i.items||(this.presenter.publish("onItemClicked",{property:i.property,value:i.value,action:i.action}),this.destroy())}}),bizagi.editor.observableClass.extend("bizagi.editor.component.contextmenu.presenter",{},{init:function(e){this._super();var t=(e=e||{}).mainContainer||"form-modeler";this.guid=e.guid,this.canvas=e.canvas||$("<div />").appendTo(t),this.contextmenu=new bizagi.editor.component.contextmenu(this.canvas,$.extend(e,{presenter:this,mainContainer:t}))},getGuid:function(){return this.guid},destroy:function(){this.contextmenu.destroy()},render:function(e){return(e=e||{}).position=e.position,this.contextmenu.render(e)}}),$.Class.extend("bizagi.editor.component.contextmenu.model",{},{init:function(e){this.model=e,e&&e.items&&(this.items={},this.actionItems={},this.properties={},this.processItems(e.items))},getViewModel:function(){return this.model},processItems:function(e){for(var t=0;t<e.length;t++)this.processItem(e[t])},processItem:function(e){if(e.guid=Math.guid(),this.items[e.guid]=e,e.caption&&(e.caption=bizagi.localization.getResource(e.caption)),e.action&&(this.actionItems[e.action]=e),e.property&&e.value){var t=this.properties[e.property]=this.properties[e.property]||{values:{}};t.values=t.values||{},e.default=e.value,t.values[JSON.encode(e.value)]=e}e.items&&this.processItems(e.items)},getItem:function(e){return this.items[e]},getItemByAction:function(e){return this.actionItems[e]},getProperties:function(){return this.properties},assignProperty:function(e,t){var i=this.properties[e];if(i){for(var n in i.values)i.values[n].selected=!1,i.values[n].value=i.values[n].default;(t="undefined"!==t&&"boolean"==typeof t?t.toString():t)&&(i.values[JSON.encode(t)]?i.values[JSON.encode(t)].selected=!0:"object"==typeof t.rule&&(i.values[JSON.encode("expression")].selected=!0,i.values[JSON.encode("expression")].value=t))}},addConverToItem:function(e){if(this.removeConvertToItem(),$.isArray(e)&&e.length>0){for(var t={caption:"formmodeler-component-contextmenu-caption-convertto",style:"convertTo",items:[],css:"bz-studio bz-convert-to_16x16_standard"},i=0,n=e.length;i<n;i+=1){var o=e[i];t.items.push({caption:o.caption,style:o.controlName,action:"convertTo",value:o.controlName,css:o.style})}this.model.items.push(t),this.currentConvertToModel=t,this.processItem(t)}},removeConvertToItem:function(){this.currentConvertToModel&&this.model.items.splice($.inArray(this.currentConvertToModel,this.model.items),1)}}),$.Controller("bizagi.editor.component.editor",{init:function(e,t,i){this.canvas=e,this.model=t,this.controller=i,this.tmpl={},this.parameters=this.getParams()},render:function(){var e=this,t=new $.Deferred;return e.element.empty(),e.inline=!1,e.callbacks=[],e.element.addClass("ui-editor"),$.isEmptyObject(e.tmpl)?$.when(e.loadInitTemplates(),e.loadTemplates()).done(function(){e.options.show&&(e.renderEditor(e.element,e.options),e.addTooltipEditor()),t.resolve()}):(e.renderEditor(e.element,e.options),e.addTooltipEditor(),t.resolve()),t.promise()},registerCallback:function(e){this.callbacks.push(e)},postRender:function(){var e;for(e=0;e<this.callbacks.length;e++)this.callbacks[e]()},addTooltipEditor:function(){$("i[title]",this.element).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip"}),$("div[title]",this.element).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip"})},addRequired:function(e,t){var i=this.options.required;if(t&&(i=t.required),bizagi.util.parseBoolean(i)&&e.length>0)for(var n=$(' <span class="biz-ico ui-bizagi-render-required bz-studio bz-required_16x16_standard"/>'),o=0;o<e.length;o++)$(e[o]).hasClass("ui-required")||($(e[o]).addClass("ui-required"),$(e[o]).append(n))},loadTemplate:function(e,t){var i=this,n=new $.Deferred;return i.tmpl.hasOwnProperty(e)?(n.resolve(i.tmpl[e]),n.promise()):bizagi.templateService.getTemplate(t).done(function(t){i.tmpl[e]=t})},loadInitTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("error",bizagi.getTemplate("bizagi.editor.component.editor").concat("#validator-editor")),this.loadTemplate("multiple-error",bizagi.getTemplate("bizagi.editor.component.editor").concat("#validator-multiple-editor")),this.loadTemplate("multiple-error-item",bizagi.getTemplate("bizagi.editor.component.editor").concat("#validator-multiple-editor-item")),this.loadTemplate("modal",bizagi.getTemplate("bizagi.editor.component.editor").concat("#modal-editor")),this.loadTemplate("modal-actions",bizagi.getTemplate("bizagi.editor.component.editor").concat("#modal-actions-editor"))).done(function(){e.resolve()}),e.promise()},getTemplate:function(e){return this.tmpl.hasOwnProperty(e)?this.tmpl[e]:null},hideEditors:function(){var e=this;e.element.addClass("ui-control-select-editor-up"),$(".bizagi_editor_component_properties").append('<div id="blockerProperties" class="blocker-properties ui-block-properties" style="display:none;"></div>'),$("#blockerProperties").fadeIn(),$("#blockerProperties").bind("click",function(){e.hideDialog(),$(this).fadeOut(function(){$(this).remove()})})},showEditors:function(){this.element.removeClass("ui-control-select-editor-up"),$("#blockerProperties").fadeOut(function(){$(this).remove()})},getParams:function(){var e,t={},i=this.model["editor-parameters"];if(!$.isEmptyObject(i))for(e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t},createDialog:function(e,t){var i,n,o,r=this;return r.idDialogEditor=r.options.name+"_DialogModal_"+Math.floor(1e7*Math.random()),o=r.options.name,r.elPopUp=i=$.tmpl(r.getTemplate("modal"),{caption:r.options.caption,id:r.idDialogEditor,style:o}),n=$.tmpl(r.getTemplate("modal-actions")),i.addClass("ui-modal-as-dialog"),i.append(n),r.element.addClass("editor_with_modal"),i.find(".content-modal").append(e),i.find(".modal-editor-buttons").append(t),i.hide(),$(".ui-close-btn",i).click(function(){r.hideDialog()}),i},showDialog:function(e,t){var i,n,o=$.Deferred(),r=this.controller.publish("getMainContainer");return n=r?r.find("#bizagi_editor_component_properties"):$("#bizagi_editor_component_properties"),$("#"+this.idDialogEditor,n).length<=0&&n.append(this.elPopUp),i=$("#"+this.idDialogEditor,n),this.dialogReference=i,this.dialogPosition={clientY:t.clientY,offsetY:t.offsetY,top:e.position().top},this.hideEditors(),$.when(this.updateDialogPosition("init")).done(function(){i.show("slide",{direction:"left"},function(){$(this).removeClass("ui-modal-close").addClass("ui-modal-open"),o.resolve()})}),o.promise()},updateDialogPosition:function(e){var t,i,n,o,r,a,s,l,d;o=this.element.parent().parent(),i=$("#"+this.idDialogEditor,o),r=$("body").height(),t=this.dialogPosition.clientY+this.dialogPosition.offsetY-i.height()/2-o.position().top,n=2*parseFloat(this.element.parent().width())+"px",(s=t+i.height()+o.position().top)>r?(a=t-(s-r)-20,i.find("[class*='ui-modal-arrow-']").css("top","83%")):(i.find("[class*='ui-modal-arrow-']").css("top","43%"),a=t-20),"init"!==e?(l={minWidth:n},i.css(l),d={top:a},e?i.animate(l):i.css(d)):(l={top:a,left:"100%",minWidth:n},i.css(l))},hideDialog:function(e){var t,i,n=this,o=this.controller.publish("getMainContainer");i=o?o.find("#bizagi_editor_component_properties"):$("#bizagi_editor_component_properties"),(t=$("#"+n.idDialogEditor,i)).hasClass("ui-modal-closing")||(t.addClass("ui-modal-closing"),t.hide("slide",{direction:"left"},1e3,function(){$(this).addClass("ui-modal-close").removeClass("ui-modal-open").removeClass("ui-modal-closing"),n.showEditors(),e&&(n.elPopUp.remove(),e())}))},createValidateMessage:function(e,t,i){var n,o,r,a=[];if($.isArray(i)){n=$.tmpl(this.getTemplate("multiple-error"),{typeMessage:"error",style:"bz-studio bz-warning-red_16x16_standard"}),o=$(".editor-validator-message-error",n);for(var s=0;s<i.length;s++)n.attr("id","bizagi_editor_validator_container-"+s),r=$.tmpl(this.getTemplate("multiple-error-item"),{typeMessage:"error",message:i[s],style:"bz-studio bz-warning-red_16x16_standard"}),o.append(r),a.push("bizagi_editor_validator_container-"+s);e.data("error-msg",a),n.addClass("ui-inline-error"),n.insertAfter(e),n.fadeIn()}else{(n=$.tmpl(this.getTemplate("error"),{typeMessage:"error",message:i,style:"bz-studio bz-warning-red_16x16_standard"})).css({left:t.left,top:t.top});var l=n.attr("id")+"-"+this.options.name;n.attr("id",l),e.data("error-msg",n.attr("id")),$(e.parent()).append(n),n.fadeIn()}},showError:function(e,t){var i,n,o;i={left:"0px",top:e.position().top+this.getRealHeight(e)+2+"px"},(n=this.getValidateId(e))&&"object"!=typeof t?(o=$("#"+n),$(".editor-validator-message-error",o).html(t),o.css(i).fadeIn()):this.createValidateMessage(e,i,t)},hideError:function(e){var t;t=this.getValidateId(this.element),$(document.getElementById(t)).fadeOut(function(){$(this).remove()})},getValidateId:function(e){var t,i,n=!1;return i=e.closest(".ui-editor"),(t=$(".bizagi_editor_validator_container",i)).length>0&&(n=t.attr("id")),n},getRealHeight:function(e){var t,i,n=0;t=["padding-top","padding-bottom","margin-top","margin-bottom","border-top-width","border-bottom-width"],i=$(e).height();for(var o=0;o<t.length;o++)n+=parseFloat($(e).css(t[o]));return n+i},highLightProperty:function(e){this.element.addClass("ui-editor-highlight"),this.showError(this.element,e)},uiControls:{comboBox:function(e){var t=this;return t.settings={uiPlaceHolderText:"",uiValues:[{label:"true",value:"true"},{label:"false",value:"false"}],uiInline:!1,onChange:function(){}},$.extend(t.settings,arguments[0]),t.editor=t.settings.uiEditor,t.update=function(e){this.methods.update(e)},t.getValue=function(){return this.value},t.getLabel=function(){return this.label},t.methods={instance:this,init:function(){var e=this;e.container=e.settings.uiContainer,$.when(e.methods.loadTemplates.apply(e)).done(function(){e.methods.renderControl.apply(e)})},loadTemplates:function(){var e=new $.Deferred;return $.when(this.editor.loadTemplate("comboSelector",bizagi.getTemplate("bizagi.editor.component.editor").concat("#comboBox-selector")),this.editor.loadTemplate("comboValues",bizagi.getTemplate("bizagi.editor.component.editor").concat("#comboBox-values")),this.editor.loadTemplate("comboOptions",bizagi.getTemplate("bizagi.editor.component.editor").concat("#comboBox-options"))).done(function(){e.resolve()}),e.promise()},renderControl:function(){try{var e,t,i,n=this;if(e=n.settings,i=(t=n.container).hasClass("ui-control-editor")?t:$(".ui-control-editor",t),e.hasOwnProperty("uiInitValue")?n.value=n.editor.uiControls.utils.validateValue(n.settings.uiInitValue):n.value=n.editor.uiControls.utils.validateValue(n.editor.options.value),e.uiPlaceHolderText.length>0){var o={label:e.uiPlaceHolderText,value:"select"};e.uiValues.unshift(o)}n.options=n.editor.uiControls.utils.selectValueOption(n.value,e.uiValues),n.methods.asignValues.apply(n,[{uiContainer:i}])}catch(e){bizagi.log(e.message,e,"error")}},asignValues:function(e){var t,i,n,o,r,a,s,l=this;for(var d in a=$('<div class="ui-bizagi-editor-uiControls-comboBox ui-control-input" tabindex="0"/>'),i=$.tmpl(l.editor.getTemplate("comboValues"),{}),l.options)r=l.options[d].value,(s=l.options[d]).hasOwnProperty("value")&&(s.hasOwnProperty("icon")||(s.icon=s.value),n=$.tmpl(l.editor.getTemplate("comboOptions"),s),$('[class*="-check"]',n).toggleClass("ui-comboBox-image-small-check ui-comboBox-image-small-uncheck"),$('[class*="-check"]',n).addClass("bz-black"),$('[class*="-check"]',n).toggleClass("bz-point_16x16_standard bz-point_16x16_black"),$(".ui-comboBox-value",n).data("value",r),"string"==typeof r&&$(".ui-comboBox-value",n).attr("data-value",r),n.bind("click",function(e){l.methods.changeDropDown.apply(l,[{ui:this,e:e}])}),s.hasOwnProperty("tmpl")&&$(".ui-comboBox-value",n).append(s.tmpl),i.append(n),s.hasOwnProperty("selected")&&($('[class*="-uncheck"]',n).toggleClass("ui-comboBox-image-small-uncheck ui-comboBox-image-small-check"),$('[class*="-uncheck"]',n).removeClass("bz-black"),$('[class*="-uncheck"]',n).toggleClass("bz-point_16x16_black bz-point_16x16_standard"),t=$.tmpl(l.editor.getTemplate("comboSelector"),s),$(".ui-comboBox-value",t).data("value",s.value),$(".ui-comboBox-value",t).data("label",s.label),l.value=s.value,l.label=s.label,s.hasOwnProperty("tmpl")&&t.append(s.tmpl)));void 0===t&&(n=$(".ui-bizagi-editor-comboBox-option",i).eq(0),$('[class*="-uncheck"]',n).toggleClass("ui-comboBox-image-small-uncheck ui-comboBox-image-small-check"),$('[class*="-uncheck"]',n).removeClass("bz-black"),$('[class*="-uncheck"]',n).toggleClass("bz-point_16x16_black bz-point_16x16_standard"),t=$.tmpl(l.editor.getTemplate("comboSelector"),l.options[0]),$(".ui-comboBox-value",t).data("value",l.options[0].value),$(".ui-comboBox-value",t).data("label",l.options[0].label),l.value=l.options[0].value,l.label=l.options[0].label,l.options[0].hasOwnProperty("tmpl")&&$(".ui-comboBox-selector-text",t).append(l.options[0].tmpl)),l.settings.uiInitLabel&&$(".ui-comboBox-value",t).text(l.settings.uiInitLabel),t.bind("click",function(e){l.methods.changeDropDown.apply(l,[{ui:this,e:e}])}),i.addClass("ui-comboBox-close"),a.append(i),a.prepend(t),e.uiContainer.append(a),l.settings.hasOwnProperty("uiWidthIcon")&&(o=l.settings.uiWidthIcon,$('[class*="ui-comboBox-image-large-"]',e.uiContainer).toggleClass("biz-ico biz-ico-"+o))},update:function(e){var t=this.instance,i=t.settings;t.settings.uiValues=[],t.settings.uiValues=e,t.options=e,this.changeDataCombo.apply(t,[i])},changeDataCombo:function(e){var t,i,n=this;if((t=n.settings).uiPlaceHolderText.length>0){var o={label:t.uiPlaceHolderText,value:"select"};e.uiValues.unshift(o)}$.extend(t,e),t.hasOwnProperty("uiInitValue")?n.value=n.editor.uiControls.utils.validateValue(n.settings.uiInitValue):n.value=n.editor.uiControls.utils.validateValue(n.editor.options.value),n.options=n.editor.uiControls.utils.selectValueOption(n.value,t.uiValues),(i=n.container.hasClass("ui-control-editor")?n.container:$(".ui-control-editor",n.container)).empty(),n.methods.asignValues.apply(n,[{uiContainer:i}])},changeDropDown:function(e){var t={};$.extend(t,e);var i,n,o,r=$(t.ui);i=r.hasClass("ui-bizagi-editor-comboBox-option")?r.parent().parent():r.parent(),o=$(".ui-bizagi-editor-comboBox-selector",i),n=$(".ui-bizagi-editor-comboBox-dropDown",i),t.uiSelector=o,t.uiDropDown=n,n.hasClass("ui-comboBox-close")?n.slideDown(function(){$(this).addClass("ui-comboBox-open").removeClass("ui-comboBox-close"),$(".ui-comboBox-arrow-close",o).addClass("ui-comboBox-arrow-open").removeClass("ui-comboBox-arrow-close"),$(document).bind("mouseup",function(){0===n.has(e.ui).length&&n.slideUp(function(){$(this).addClass("ui-comboBox-close").removeClass("ui-comboBox-open"),$(".ui-comboBox-arrow-open",o).addClass("ui-comboBox-arrow-close").removeClass("ui-comboBox-arrow-open")})})}):n.slideUp(function(){$(this).addClass("ui-comboBox-close").removeClass("ui-comboBox-open"),$(".ui-comboBox-arrow-open",o).addClass("ui-comboBox-arrow-close").removeClass("ui-comboBox-arrow-open")}),r.hasClass("ui-bizagi-editor-comboBox-selector")||this.methods.setValue.apply(this,[t])},setValue:function(e){var t,i,n,o,r,a,s=$(e.ui);i=$('[class*="ui-comboBox-image-large-"]',s),t=$(".ui-comboBox-value",s).data("value"),n=$(".ui-comboBox-value",s).text(),o=$(".ui-comboBox-value",e.uiSelector),r=$('[class*="ui-comboBox-image-large-"]',e.uiSelector),$('[class*="-check"]',e.uiDropDown).toggleClass("ui-comboBox-image-small-check ui-comboBox-image-small-uncheck"),$('[class*="-uncheck"]',e.uiDropDown).addClass("bz-black"),a=$('[data-value="'+t+'"]',e.uiDropDown),$('[class*="-uncheck"]',a.parent()).toggleClass("ui-comboBox-image-small-uncheck ui-comboBox-image-small-check"),$('[class*="-check"]',a.parent()).removeClass("bz-black"),o.data("value",t),o.data("label",n),o.text(n),r.attr("class",i.attr("class")),this.value=t,this.label=n,this.settings.onChange(t,e.e)}},t.methods[e]?t.methods[e].apply(t,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e&&"string"!=typeof e?void $.error("Method "+method+" does not exist on bizagi.editor.component.editor.uiControls.comboBox"):t.methods.init.apply(t,arguments)},booleanSwitch:function(e){var t=this;return t.settings={uiValues:[{label:"true",value:"true"},{label:"false",value:"false"}],uiInline:!1,onChange:function(){}},$.extend(t.settings,arguments[0]),t.editor=t.settings.uiEditor,t.update=function(e){t.methods.update(e)},t.getValue=function(){return this.value},t.methods={instance:this,init:function(){var e=this;$.when(e.methods.loadTemplates.apply(e)).done(function(){return e.methods.renderControl.apply(e)})},loadTemplates:function(){var e=new $.Deferred;return $.when(this.editor.loadTemplate("booleanSwitchSelector",bizagi.getTemplate("bizagi.editor.component.editor").concat("#booleanSwitch-selector")),this.editor.loadTemplate("booleanSwitchValues",bizagi.getTemplate("bizagi.editor.component.editor").concat("#booleanSwitch-values")),this.editor.loadTemplate("booleanSwitchOptions",bizagi.getTemplate("bizagi.editor.component.editor").concat("#booleanSwitch-options"))).done(function(){e.resolve()}),e.promise()},renderControl:function(){var e,t,i,n,o,r,a,s,l=this;for(var d in e=l.settings,o=l.container=l.settings.uiContainer,t=$.tmpl(l.editor.getTemplate("booleanSwitchSelector"),{}),r=o.hasClass("ui-control-editor")&&$(".ui-bizagi-editor-uiControls-booleanSwitch",o).length>0?$(".ui-bizagi-editor-uiControls-booleanSwitch",o):o,a=$('<div class="ui-bizagi-editor-uiControls-booleanSwitch ui-control-input biz-btn-horizontal" tabindex="0"/>'),i=$.tmpl(l.editor.getTemplate("booleanSwitchValues"),{}),s=$(".ui-bizagi-editor-booleanSwitch-content",i),e.hasOwnProperty("uiInitValue")?l.value=l.editor.uiControls.utils.validateValue(l.settings.uiInitValue):l.value=l.editor.uiControls.utils.validateValue(l.editor.options.value),l.options=l.editor.uiControls.utils.selectValueOption(l.value,e.uiValues),l.options)l.options[d].hasOwnProperty("value")&&(n=$.tmpl(l.editor.getTemplate("booleanSwitchOptions"),l.options[d]),l.options[d].hasOwnProperty("selected")?n.addClass("ui-booleanSwitch-selected"):n.addClass("ui-booleanSwitch-unselected"),s.append(n));return a.append(i),a.append(t),r.append(a),e.uiContainer=$(".ui-bizagi-editor-booleanSwitch-content",r),e.uiSelector=$(".ui-bizagi-editor-booleanSwitch-selector",r),r.bind("click",function(e){var t=l.settings;$.extend(t,{ui:this,e:e}),l.methods.changeSwitch.apply(l,[t])}),l.editor.inline&&r.addClass("ui-control-editor-inline"),$.extend(e,{ui:null,e:null}),l.methods.changeSwitch.apply(l,[e]),l},update:function(e){var t=this.instance,i=t.settings;t.value=e,$.extend(i,{ui:null,e:null}),this.changeSwitch.apply(t,[i])},changeSwitch:function(e){var t,i,n,o=e;t=parseFloat($(o.uiContainer).width()),i=parseFloat($(o.uiSelector).width()),n=this.editor.inline?"38":t-i,null!=e.ui&&(this.value=!this.value),this.value?o.animation={selector:{left:n-1+"px",timer:300},container:{left:"0%",timer:300}}:o.animation={selector:{left:"0px",timer:300},container:{left:"-100%",timer:300}},null!=e.ui?this.methods.animateChange.apply(this,[o]):(o.uiSelector.css({left:o.animation.selector.left}),o.uiContainer.css({left:o.animation.container.left}))},animateChange:function(e){var t=this;$(e.uiSelector).stop().animate({left:e.animation.selector.left},e.animation.selector.timer),$(e.uiContainer).stop().animate({left:e.animation.container.left},e.animation.selector.timer,function(){var i=$('[class*="selected"]',e.uiContainer);i.removeClass("ui-booleanSwitch-selected").removeClass("ui-booleanSwitch-unselected"),i.each(function(){$(this).data("value")==t.value?$(this).addClass("ui-booleanSwitch-selected"):$(this).addClass("ui-booleanSwitch-unselected")}),t.methods.setValue.apply(t,[e])})},setValue:function(e){var t;$(e.ui);t=$(".ui-booleanSwitch-selected",e.ui).data("value"),this.value=t,this.settings.onChange(t,e.e)}},t.methods[e]?t.methods[e].apply(t,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e&&"string"!=typeof e?void $.error("Method "+method+" does not exist on bizagi.editor.component.editor.uiControls.booleanSwitch"):t.methods.init.apply(t,arguments)},iconMenu:{},groupUIControls:{},utils:{validateValue:function(e){var t=e;switch(e){case"true":case!0:t=!0;break;case"false":case!1:case null:t=!1;break;default:t=e}return t},selectValueOption:function(e,t){for(var i=0;i<t.length;i++){e!==this.validateValue(t[i].value)||null==e&&null==e||(t[i].selected=!0)}return t},hasHScrollBar:function(e){return e.get(0).scrollWidth>e.width()}}}}),bizagi.editor.component.editor("bizagi.editor.component.editor.string",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r=this;r.inputValue=t.value,r.defaultValue=t.default,r.charLimit=1e3,r.localization=!!t.showLocalization,r.placeholder=!!t["editor-parameters"].placeholder,r.placeholderText=r.placeholder?" "+t["editor-parameters"].placeholder:" ",r.isRegularExpression=t["editor-parameters"].isRegularExpression||!1,r.isReadOnly=void 0!==t["editor-parameters"].readOnly&&bizagi.util.parseBoolean(t["editor-parameters"].readOnly),r.isAdhocProcess=r.controller.propertyBox&&r.controller.propertyBox.adhocProcessId,$.extend(t,{placeholder:r.placeholder,placeholderText:r.placeholderText,isReadOnly:r.isReadOnly}),i=$.tmpl(r.getTemplate("frame"),t),r.isReadOnly||(n=$.tmpl(r.getTemplate("default")),o=$.tmpl(r.getTemplate("localization")),r.localization&&$(".editor-string-input",i).append(o),r.isAdhocProcess||$(".editor-string-input",i).append(n)),i.appendTo(e)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.string").concat("#string-frame")),this.loadTemplate("default",bizagi.getTemplate("bizagi.editor.component.editor.string").concat("#string-default-value")),this.loadTemplate("localization",bizagi.getTemplate("bizagi.editor.component.editor.string").concat("#string-localization"))).done(function(){e.resolve()}),e.promise()},renderError:function(e){var t=e;t.hasClass("error")||t.addClass("error"),this.showError(e,this.Error),e.select()},validate:function(e){var t,i,n=!0;return i=(t=$(e)).val(),t.removeClass("error"),this.hideError(e),!this.isLength(e)&&i.length?(n=!1,this.renderError(e)):this.isRegularExpression&&!this.regularExpressionIsValid(e)&&this.renderError(e),n},regularExpressionIsValid:function(e){var t=this,i=$(e).val();try{return new RegExp(i),!0}catch(e){return t.Error=e.message,!1}},isLength:function(e){return this.Error=bizagi.localization.getResource("bizagi-editor-numberrange-error-lenght").replace("$number",this.charLimit),e.val().length<=this.charLimit},"label click":function(e,t){e.next().focus()},"input keydown":function(e,t){if(13==t.keyCode&&this.validate(e)&&this.inputValue!=e.val()){var i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:e.val(),type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};this.options.hasOwnProperty("exclusive")&&(i=$.extend({},i,{exclusive:this.options.exclusive})),this.controller.publish("propertyEditorChanged",i),this.inputValue=e.val()}},"input blur":function(e,t){var i=this,n=i.element.find('input[type="text"]').parent();if(i.validate(e)&&this.inputValue!=e.val()){var o={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:i.inputValue,newValue:e.val(),type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.options.hasOwnProperty("exclusive")&&(o=$.extend({},o,{exclusive:i.options.exclusive})),i.controller.publish("propertyEditorChanged",o),i.inputValue=e.val()}i.element.find(".editor-string-icon-localization").removeClass("editor_string_fadeIn"),n.toggleClass("editor-string-focus")},"input focus":function(e,t){var i;i=this.element.find(".editor-string-icon-localization"),inputParent=this.element.find('input[type="text"]').parent(),i.addClass("editor_string_fadeIn"),inputParent.toggleClass("editor-string-focus")},"span.editor-string-icon-localization click":function(e,t){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SHOW_LOCALIZATION,id:this.element.closest(".bizagi_editor_component_properties").data("id")})},".editor-string-icon-default-value click":function(e,t){var i,n=this.defaultValue;i=this.element.find('input[type="text"]'),n&&(i.val(n),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:n,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}))},".editor-string-icon-localization mouseenter":function(e,t){e.addClass("editor_string_fadeIn")},".editor-string-icon-localization mouseleave":function(e,t){e.removeClass("editor_string_fadeIn")}}),bizagi.editor.component.editor("bizagi.editor.component.editor.localizablestring",{init:function(e,t,i){this._super(e,t,i),this.focus=null},renderEditor:function(e,t){var i,n,o,r,a=this,s={};t.value||(a.defaultAttributeSelected=!0,t.value=""),r=a.parameters,a.inputValue=t.value,a.defaultValue=t.default?t.default:"",a.localization=!0,$.isEmptyObject(r)||(bizagi.util.parseBoolean(r["show-attribute-default"])&&(a.defaultBindCaption=!0),bizagi.util.parseBoolean(r["show-richtext-editor"])&&(/<\s*\w+[\S\s]*>/im.test(t.value)&&($.extend(s,{value:"HTML",html:!0}),a.isHTML=!0),a.showRichtextEditor=!0)),i=$.tmpl(a.getTemplate("frame"),$.extend({},t,s)),n=$.tmpl(a.getTemplate("localization"));var l=$.tmpl(a.getTemplate("defaultBindCaption"));a.showRichtextEditor&&$(".editor-localizablestring-input",i).append($.tmpl(a.getTemplate("richtext"))),a.localization&&$(".editor-localizablestring-input",i).append(n),a.defaultBindCaption&&($(".editor-localizablestring-input",i).append(l),a.defaultAttributeSelected&&($(".editor-localizablestring-default-bind",i).addClass("bz-studio"),$(".editor-localizablestring-default-bind",i).addClass("bz-checked_16x16_standard"))),i.appendTo(e),o=$("label",i),a.addRequired(o)},selectEditor:function(){$("input",this.element).select()},loadTemplates:function(){var e;return e=new $.Deferred,$.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.localizablestring").concat("#localizablestring-frame")),this.loadTemplate("localization",bizagi.getTemplate("bizagi.editor.component.editor.localizablestring").concat("#localizablestring-localization")),this.loadTemplate("richtext",bizagi.getTemplate("bizagi.editor.component.editor.localizablestring").concat("#localizablestring-richtext")),this.loadTemplate("richtext-editor",bizagi.getTemplate("bizagi.editor.component.editor.localizablestring").concat("#localizablestring-richtext-editor")),this.loadTemplate("defaultBindCaption",bizagi.getTemplate("bizagi.editor.component.editor.localizablestring").concat("#localizablestring-default-bind"))).done(function(){e.resolve()}),e.promise()},remove:function(){this.element.hide(),this.element.empty()},publishValue:function(e){this.options.value=e;var t={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:e,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};this.options.hasOwnProperty("exclusive")&&(t=$.extend({},t,{exclusive:this.options.exclusive})),this.controller.publish("propertyEditorChanged",t),this.inputValue=e},"input keyup":function(e,t){var i=e.val()||"";e.hasClass("isHtml")&&"HTML"!==i&&e.removeClass("isHtml"),13==t.keyCode&&i!==this.inputValue&&this.publishValue(i)},"input blur":function(e){var t,i;i=this.element.find('input[type="text"]').parent(),this.showRichtextEditor&&this.element.find(".editor-localizablestring-richtext").removeClass("ui-control-fadeIn"),this.element.find(".editor-localizablestring-localization").removeClass("ui-control-fadeIn"),i.toggleClass("ui-control-focus"),(t=e.val()||"")!==this.inputValue&&"HTML"!==t&&this.publishValue(t)},"input focus":function(){var e,t;this.showRichtextEditor&&this.element.find(".editor-localizablestring-richtext").addClass("ui-control-fadeIn"),e=this.element.find(".editor-localizablestring-localization"),t=this.element.find('input[type="text"]').parent(),e.addClass("ui-control-fadeIn"),t.toggleClass("ui-control-focus")},".editor-localizablestring-richtext click":function(){var e,t,i=this,n=$("#root");if(0===n.length&&(n=i.publish("getMainContainer")),i.showRichtextEditor){(e=i.popup=bizagi.createPopup({name:"bz-fm-localizablestring-richtext",container:n,center:!0,title:bizagi.localization.getResource("formmodeler-component-editor-localizablestring-richtext-title")})).content.append($.tmpl(i.getTemplate("richtext-editor")));var o=$(".bz-fm-localizablestring-richtext-content",e.content);t=$(".bz-fm-localizablestring-richtext-buttons",o);var r=o.height()-t.height();o.height(r),$(".bz-fm-localizablestring-richtext-ok",t).click(function(){var t=tinymce.activeEditor.getContent();(t=bizagi.util.trim(t))&&(t="<span>"+t+"</span>",i.publishValue(t)),e.overlay.remove()}),$(".bz-fm-localizablestring-richtext-cancel",t).click(function(){e.overlay.remove()}),tinymce.remove(),tinymce.init({selector:"textarea#richtext-editor",menubar:!1,resize:!1,forced_root_block:!1,plugins:["textcolor autoresize"],toolbar1:"bold italic underline strikethrough | forecolor"}),i.isHTML&&tinymce.activeEditor.setContent(i.inputValue),setTimeout(function(){var e=$(".mce-edit-area.mce-container",o);e.height(r),e.css("overflow-y","auto")},10)}},".editor-localizablestring-localization mouseup":function(){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SHOW_LOCALIZATION,value:this.inputValue,oldValue:this.options.value,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})},".editor-localizablestring-localization mouseenter":function(e,t){e.addClass("editor_localizablestring_fadeIn")},".editor-localizablestring-localization mouseleave":function(e,t){e.removeClass("editor_localizablestring_fadeIn")},".editor-localizablestring-default-bind click":function(e,t){e.hasClass("bz-checked_16x16_standard")?(e.removeClass("bz-checked_16x16_standard"),e.addClass("bz-check_16x16_standard")):(e.removeClass("bz-check_16x16_standard"),e.addClass("bz-checked_16x16_standard"),this.publishValue()),console.log("clicked")}}),bizagi.editor.component.editor("bizagi.editor.component.editor.thumbnail",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i=this;i.inputValue=t.value,i.minLimit=32,i.maxLimit=128,i.firstSubproperty=i.options.subproperties[0],i.secondSubproperty=i.options.subproperties[1];var n,o=$.tmpl(i.getTemplate("frame"),t),r=$.tmpl(i.getTemplate("check"),t);for(var a in i.mapSizes=i.mapForSizes(t),i.actualValue=i.retrieveValueObject(t),i.element.addClass("without-dropdown"),i.mapSizes)n=$.tmpl(i.getTemplate("option"),{name:i.mapSizes[a].name,option:i.mapSizes[a].label,value:{firstSubproperty:i.mapSizes[a].value[i.firstSubproperty.property.name],secondSubproperty:i.mapSizes[a].value[i.secondSubproperty.property.name]}}),r=$.tmpl(i.getTemplate("check"),{}),n.append(r),$(".thumbnail-group-container",o).append(n),"auto"===a&&($(".thumbnail-dimension",n).remove(),$(".thumbnail-value",n).css("margin-top","5px"));o.appendTo(e);var s=$("label",o);i.addRequired(s);var l=$(".thumbnail-image-small-"+i.actualValue.name,i.element).closest(".biz-btn-vertical");l.addClass("biz-btn-checked"),l.find(".thumbnail-image-icon-uncheck").toggleClass("thumbnail-image-icon-uncheck thumbnail-image-icon-check")},retrieveValueObject:function(e){var t={},i=this.mapSizes;switch(parseInt(e.value.width)){case-1:t=i.auto;break;case 32:t=i.small;break;case 64:t=i.medium;break;case 128:t=i.large}return t},mapForSizes:function(e){var t,i=this,n={small:{label:bizagi.localization.getResource("formmodeler-component-editor-thumbnail-small"),value:{},name:"Small"},medium:{label:bizagi.localization.getResource("formmodeler-component-editor-thumbnail-medium"),value:{},name:"Medium"},large:{label:bizagi.localization.getResource("formmodeler-component-editor-thumbnail-large"),value:{},name:"Large"},auto:{label:bizagi.localization.getResource("formmodeler-component-editor-thumbnail-auto"),value:{},name:"Auto"}};switch(n.large.value[i.firstSubproperty.property.name]="128",n.large.value[i.secondSubproperty.property.name]="128",n.medium.value[i.firstSubproperty.property.name]="64",n.medium.value[i.secondSubproperty.property.name]="64",n.small.value[i.firstSubproperty.property.name]="32",n.small.value[i.secondSubproperty.property.name]="32",n.auto.value[i.firstSubproperty.property.name]="-1",n.auto.value[i.secondSubproperty.property.name]="-1",parseInt(e.value.width)){case-1:t="auto";break;case 32:t="small";break;case 64:t="medium";break;case 128:t="large";break;default:return n}return n[t].selected=!0,n[t].value[i.firstSubproperty.property.name]=e.value[i.firstSubproperty.property.name]?e.value[i.firstSubproperty.property.name]:n[t].value[i.firstSubproperty.property.name],n[t].value[i.secondSubproperty.property.name]=e.value[i.secondSubproperty.property.name]?e.value[i.secondSubproperty.property.name]:n[t].value[i.firstSubproperty.property.name],n},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.thumbnail").concat("#thumbnail-frame")),this.loadTemplate("option",bizagi.getTemplate("bizagi.editor.component.editor.thumbnail").concat("#thumbnail-frame-option")),this.loadTemplate("values",bizagi.getTemplate("bizagi.editor.component.editor.thumbnail").concat("#thumbnail-frame-values")),this.loadTemplate("check",bizagi.getTemplate("bizagi.editor.component.editor.thumbnail").concat("#thumbnail-frame-check"))).done(function(){e.resolve()}),e.promise()},selectOption:function(e,t){var i,n;$(".thumbnail-group",this.element).removeClass("biz-btn-checked"),this.element.hasClass("without-dropdown")?(e.addClass("biz-btn-checked"),$(".thumbnail-image-icon-check",this.element).removeClass("thumbnail-image-icon-check").addClass("thumbnail-image-icon-uncheck"),$(".thumbnail-image-icon-uncheck",e).toggleClass("thumbnail-image-icon-uncheck thumbnail-image-icon-check"),i=e.data("firstsubproperty"),n=e.data("secondsubproperty")):(e.parent().find(".thumbnail-group > i[class^=thumbnail-icon-small-]").removeClass("thumbnail-image-icon-check").addClass("thumbnail-image-icon-uncheck"),$("i:eq(2)",e).toggleClass("thumbnail-image-small-uncheck thumbnail-image-small-check"),i=e.data("firstsubproperty"),n=e.data("secondsubproperty"),$(".thumbnail-container > .thumbnail-group-container .thumbnail-group > i:eq(0)",this.element).removeClass().addClass("thumbnail-icon-small-"+value.toLowerCase()),$(".thumbnail-container > .thumbnail-group-container .thumbnail-group > i:eq(1)",this.element).text(newValue),$(".thumbnail-values",this.element).removeClass("thumbnail-open").addClass("thumbnail-close"));var o=[];o.push({property:this.firstSubproperty.property.name,value:i}),o.push({property:this.secondSubproperty.property.name,value:n}),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_MULTIPLE_PROPERTIES,properties:o,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputValue={width:i,height:n}},".thumbnail-container > .thumbnail-group-container mouseenter":function(e,t){$(".thumbnail-image-normal-expand",this.element).removeClass("thumbnail-hidden").addClass("thumbnail-show"),e.removeClass("thumbnail-collapsed").addClass("thumbnail-expanded")},".thumbnail-container > .thumbnail-group-container mouseleave":function(e,t){$(".thumbnail-image-normal-expand",this.element).removeClass("thumbnail-show").addClass("thumbnail-hidden"),e.removeClass("thumbnail-expanded").addClass("thumbnail-collapsed")},".ui-editor:not(.without-dropdown) > .thumbnail-group-container click":function(e,t){$(".thumbnail-values",this.element).slideDown(function(){$(this).removeClass("thumbnail-close").addClass("thumbnail-open"),$(document).bind("mouseup",function(){var e=$(".thumbnail-values");0===e.has(t.target).length&&e.slideUp()})})},".thumbnail-group-container .thumbnail-group click":function(e,t){this.selectOption(e,t)},".thumbnail-values > .thumbnail-group click":function(e,t){this.selectOption(e,t)},".thumbnail-values mouseenter":function(e,t){$(".thumbnail-container > .thumbnail-group-container .thumbnail-image-normal-expand",this.element).removeClass("thumbnail-hidden").addClass("thumbnail-show"),$(".thumbnail-container > .thumbnail-group-container .thumbnail-group",this.element).removeClass("thumbnail-collapsed").addClass("thumbnail-expanded")},".thumbnail-values mouseleave":function(e,t){$(".thumbnail-container > .thumbnail-group-container .thumbnail-image-normal-expand").removeClass("thumbnail-show").addClass("thumbnail-hidden"),$(".thumbnail-container > .thumbnail-group-container .thumbnail-group").removeClass("thumbnail-expanded").addClass("thumbnail-collapsed"),e.removeClass("thumbnail-open").addClass("thumbnail-close")}}),bizagi.editor.component.editor("bizagi.editor.component.editor.boolean",{init:function(e,t,i){this._super(e,t,i),this.focus=null},renderEditor:function(e,t){var i,n,o,r,a=this,s=!1,l={};a.isAdhocProcess=a.controller.propertyBox&&a.controller.propertyBox.adhocProcessId,void 0===t.value?t.value=!1:null===t.value||!1===t.value||"false"==t.value?t.value=!1:!0!==t.value&&"true"!=t.value||(t.value=!0),a.inputValue=!!t.value,void 0===t.default?a.defaultValue=!1:null===t.default||!1===t.default||"false"==t.default?a.defaultValue=!1:!0!==t.default&&"true"!=t.default||(a.defaultValue=!0),(r=t["editor-parameters"])&&(s=!!r.tooltip&&bizagi.localization.getResource(r.tooltip),r.labels&&(l.true=bizagi.localization.getResource(r.labels.true.caption),l.false=bizagi.localization.getResource(r.labels.false.caption))),a.inline=!0,$.extend(t,{uiValues:[{label:r.labels?l.true:bizagi.localization.getResource("formmodeler-component-editor-boolean-true"),value:"true"},{label:r.labels?l.false:bizagi.localization.getResource("formmodeler-component-editor-boolean-false"),value:"false"}],tooltip:s}),n=$.tmpl(this.getTemplate("frame"),t),i=$.tmpl(this.getTemplate("default")),a.inline&&n.addClass("bizagi-editor-boolean-inline"),a.isAdhocProcess||n.append(i),n.appendTo(e),o=$("label",n),a.addRequired(o);new a.uiControls.booleanSwitch({uiEditor:a,uiContainer:$(".ui-control-editor",n),uiValues:t.uiValues,uiInline:a.inline,onChange:function(e,t){a.responseChangeSwitch(e,t,a)}});$(".boolean-container.ui-control-container[title]",a.element).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip ui-boolean-editor-tooltip",position:{my:"left top+10",at:"left bottom"}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.boolean").concat("#boolean-frame")),this.loadTemplate("default",bizagi.getTemplate("bizagi.editor.component.editor.boolean").concat("#boolean-default-action"))).done(function(){e.resolve()}),e.promise()},responseChangeSwitch:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o},".editor-boolean-icon-default-value click":function(e){var t,i;t=this.inputValue,i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:t,newValue:this.defaultValue,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.controller.publish("propertyEditorChanged",i),this.inputValue=this.defaultValue}}),bizagi.editor.component.editor("bizagi.editor.component.editor.ruleexpression",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n;this.inline=!0,this.data=t,i=this.createDataSource(),this.inputValue=t.value,n=$.tmpl(this.getTemplate("frame"),t),this.inline&&n.addClass("bizagi-editor-ruleexpression-inline"),n.appendTo(e),this.setInitValue(t.value),this.createUIControls(n,i)},createDataSource:function(){var e=this.data["editor-parameters"],t=null,i=null;return this.data.value&&(i=this.data.value.rule||this.data.value.rule90?{label:bizagi.localization.getResource("formmodeler-component-editor-ruleexpression-option-expression"),value:this.data.value,icon:"expression",style:"bz-studio bz-expresion-ex_16x16_standard"}:{label:bizagi.localization.getResource("formmodeler-component-editor-ruleexpression-option-expression"),value:{rule:{baref:{ref:"expression"}}},icon:"expression",style:"bz-studio bz-expresion-ex_16x16_standard"}),$.isEmptyObject(e)||e.type?($.extend(this.data,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-ruleexpression-option-true"),value:{fixedvalue:"true"},icon:"true",style:"bz-studio bz-yes-no_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-ruleexpression-option-false"),value:{fixedvalue:"false"},icon:"false",style:"bz-studio bz-false_16x16_standard"},i],valueCheck:!1}),t=!1):void 0!==e.allowboolean&&("false"!=e.allowboolean&&0!=e.allowboolean||($.extend(this.data,{uiValues:[i],valueCheck:!1}),t=!0)),t},createUIControls:function(e,t){var i=this;i.myCombo=t?new i.uiControls.comboBox({uiEditor:i,uiPlaceHolderText:"-----",uiContainer:$(".ui-control-editor",e),uiValues:i.data.uiValues,uiInline:i.inline,onChange:function(e,t){i.responseChangeCombo(e,t,i)}}):new i.uiControls.comboBox({uiEditor:i,uiContainer:$(".ui-control-editor",e),uiValues:i.data.uiValues,uiInline:i.inline,onChange:function(e,t){i.responseChangeCombo(e,t,i)}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.ruleexpression").concat("#ruleexpression-frame")),this.loadTemplate("option",bizagi.getTemplate("bizagi.editor.component.editor.ruleexpression").concat("#ruleexpression-frame-option")),this.loadTemplate("edit",bizagi.getTemplate("bizagi.editor.component.editor.ruleexpression").concat("#ruleexpression-frame-edit"))).done(function(){e.resolve()}),e.promise()},setInitValue:function(val){for(var valBoolean,self=this,uiValues=self.data.uiValues,i=0;i<uiValues.length;i++)delete uiValues[i].selected,val.rule&&uiValues[i].value.rule?(uiValues[i].selected="selected",val.rule.displayName&&(uiValues[i].label=val.rule.displayName)):val.rule90&&uiValues[i].value.rule90?(uiValues[i].selected="selected",val.rule90.displayName&&(uiValues[i].label=val.rule90.displayName)):(valBoolean=eval(uiValues[i].value.fixedvalue),eval(val.fixedvalue)===valBoolean&&(uiValues[i].selected="selected"))},responseChangeCombo:function(e,t,i){var n,o,r;n=i.inputValue,o=e,r=bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,(o.rule||o.rule90)&&(r=bizagi.editor.component.properties.events.PROPERTIES_SELECT_EXPRESSION,i.options.name=i.options.name),i.options.value=e,i.setInitValue(o),i.myCombo.update(i.data.uiValues),bizagi.log("PROPERTIES_SELECT_EXPRESSION",o),i.controller.publish("propertyEditorChanged",{typeEvent:r,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id"),categorytype:"Boolean"}),i.inputValue=o}}),bizagi.editor.component.editor("bizagi.editor.component.editor.booleandisplay",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o=this;o.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-booleandisplay-option-check"),value:"check",style:"bz-studio bz-yes-no_16x16_standard",icon:"nothing"},{label:bizagi.localization.getResource("formmodeler-component-editor-booleandisplay-option-radio"),value:"option",style:"bz-studio  bz-radio_16x16_standard",icon:"nothing"}],valueCheck:!1}),t.value=t.value?t.value:"expression",o.inputValue=t.value,i=$.tmpl(o.getTemplate("frame"),t),elEditAction=$.tmpl(o.getTemplate("edit"),{}),o.inline&&i.addClass("bizagi-editor-booleandisplay-inline"),i.appendTo(e),n=$("label",i),o.addRequired(n);new o.uiControls.comboBox({uiEditor:o,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:o.inline,onChange:function(e,t){o.responseChangeCombo(e,t,o)}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.booleandisplay").concat("#booleandisplay-frame")),this.loadTemplate("edit",bizagi.getTemplate("bizagi.editor.component.editor.booleandisplay").concat("#booleandisplay-frame-edit"))).done(function(){e.resolve()}),e.promise()},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o}}),bizagi.editor.component.editor("bizagi.editor.component.editor.typedinamic",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o=this;o.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-typedinamic-option-databinding"),value:"databind",icon:"select-box"},{label:bizagi.localization.getResource("formmodeler-component-editor-typedinamic-option-rule"),value:"ruleexpression"}],valueCheck:!1}),t.value=t.value?t.value:"expression",o.inputValue=t.value,i=$.tmpl(o.getTemplate("frame"),t),elEditAction=$.tmpl(o.getTemplate("edit"),{}),o.inline&&i.addClass("bizagi-editor-typedinamic-inline"),i.appendTo(e),n=$("label",i),o.addRequired(n);new o.uiControls.comboBox({uiEditor:o,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:o.inline,onChange:function(e,t){o.responseChangeCombo(e,t,o)}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.typedinamic").concat("#typedinamic-frame")),this.loadTemplate("edit",bizagi.getTemplate("bizagi.editor.component.editor.typedinamic").concat("#typedinamic-frame-edit"))).done(function(){e.resolve()}),e.promise()},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o}}),bizagi.editor.component.editor("bizagi.editor.component.editor.linktarget",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-linktarget-option-newtab"),value:"newtab"},{label:bizagi.localization.getResource("formmodeler-component-editor-linktarget-option-newwindow"),value:"newwindow"}],valueCheck:!1}),n.inputValue=t.value,(i=$.tmpl(n.getTemplate("frame"),t)).appendTo(e);new n.uiControls.comboBox({uiWidthIcon:0,uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.linktarget").concat("#linktarget-frame"))).done(function(){e.resolve()}),e.promise()},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,options={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",options),i.inputValue=o}}),bizagi.editor.component.editor("bizagi.editor.component.editor.horizontalalign",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r,a,s,l,d,c,u,p,m,h,f,g,b=this;b.inDropDown=!1,b.default=t.default,b.inputValue=t.value,"columntitlealign"==t.name?(m=bizagi.localization.getResource("formmodeler-component-editor-columntitlealign-align-right"),h=bizagi.localization.getResource("formmodeler-component-editor-columntitlealign-align-left"),f=bizagi.localization.getResource("formmodeler-component-editor-columntitlealign-align-center"),g=bizagi.localization.getResource("formmodeler-component-editor-columntitlealign-align-justify")):"columnalign"==t.name?(m=bizagi.localization.getResource("formmodeler-component-editor-columnalign-align-right"),h=bizagi.localization.getResource("formmodeler-component-editor-columnalign-align-left"),f=bizagi.localization.getResource("formmodeler-component-editor-columnalign-align-center"),g=bizagi.localization.getResource("formmodeler-component-editor-columnalign-align-justify")):(m=bizagi.localization.getResource("formmodeler-component-editor-horizontalalign-align-right"),h=bizagi.localization.getResource("formmodeler-component-editor-horizontalalign-align-left"),f=bizagi.localization.getResource("formmodeler-component-editor-horizontalalign-align-center"),g=bizagi.localization.getResource("formmodeler-component-editor-horizontalalign-align-justify")),$.extend(t,{labelValues:{optionRight:m,optionLeft:h,optionCenter:f,optionJustify:g},iconValues:["right","left","center","justify"],iconsNew:["bz-studio bz-text-align-right_16x16_standard","bz-studio bz-text-align-left_16x16_standard","bz-studio bz-text-align-center_16x16_standard","bz-studio bz-text-align-justify_16x16_standard"]}),i=$.tmpl(b.getTemplate("frame"),t);var v=$.tmpl(b.getTemplate("default")),y=$.tmpl(b.getTemplate("values"),t),x=$.tmpl(b.getTemplate("check"),t);if(b.inDropDown){for(a in y.insertAfter($(".horizontalalign-group-container",i)),c=0,t.labelValues){if(t.value===t.labelValues[a]){u=t.iconValues[c];break}c++}(o=$.tmpl(b.getTemplate("option"),{option:t.value,icon:u})).append(x),$(".horizontalalign-group-container",i).append(o)}else b.element.addClass("without-dropdown");for(a in c=0,t.labelValues)d=t.labelValues[a].toLowerCase(),u=t.iconValues[c],p=t.iconsNew[c],l=bizagi.localization.getResource(t.labelValues[a]),r=$.tmpl(b.getTemplate("option"),{option:d,title:l,icon:u,newIcon:p}),x=$.tmpl(b.getTemplate("check"),{}),r.append(x),b.inDropDown?(r.append(x),$(".horizontalalign-values",i).append(r)):$(".horizontalalign-group-container",i).append(r),c++;i.appendTo(e),i.append(v),s=$("label",i),b.addRequired(s),b.inDropDown?$(".horizontalalign-values",i).append(r):((n=$(".horizontalalign-image-small-"+t.value.toLowerCase(),b.element).parent()).addClass("biz-btn-checked"),n.find(".horizontalalign-image-icon-uncheck").toggleClass("horizontalalign-image-icon-uncheck horizontalalign-image-icon-check")),$(".horizontalalign-group",i).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip ui-horizontalalign-tooltip",position:{my:"left top+10",at:"left bottom"}}),v.click(function(){$(".horizontalalign-group",b.element).removeClass("biz-btn-checked"),$(".horizontalalign-image-icon-check",b.element).removeClass("horizontalalign-image-icon-check").addClass("horizontalalign-image-icon-uncheck");var e=b.default||"default";b.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:b.inputValue,newValue:e,data:e,type:b.options.name,id:b.element.closest(".bizagi_editor_component_properties").data("id")}),b.inputValue=e})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.horizontalalign").concat("#horizontalalign-frame")),this.loadTemplate("option",bizagi.getTemplate("bizagi.editor.component.editor.horizontalalign").concat("#horizontalalign-frame-option")),this.loadTemplate("values",bizagi.getTemplate("bizagi.editor.component.editor.horizontalalign").concat("#horizontalalign-frame-values")),this.loadTemplate("check",bizagi.getTemplate("bizagi.editor.component.editor.horizontalalign").concat("#horizontalalign-frame-check")),this.loadTemplate("default",bizagi.getTemplate("bizagi.editor.component.editor.horizontalalign").concat("#horizontalalign-default-action"))).done(function(){e.resolve()}),e.promise()},selectOption:function(e,t){var i,n=this;$(".horizontalalign-group",n.element).removeClass("biz-btn-checked"),n.element.hasClass("without-dropdown")?(e.addClass("biz-btn-checked"),$(".horizontalalign-image-icon-check",n.element).removeClass("horizontalalign-image-icon-check").addClass("horizontalalign-image-icon-uncheck"),$(".horizontalalign-image-icon-uncheck",e).toggleClass("horizontalalign-image-icon-uncheck horizontalalign-image-icon-check"),i=e.find("i:eq(1)").data("value")):(e.parent().find(".horizontalalign-group > i[class^=horizontalalign-icon-small-]").removeClass("horizontalalign-image-icon-check").addClass("horizontalalign-image-icon-uncheck"),$("i:eq(2)",e).toggleClass("horizontalalign-image-small-uncheck horizontalalign-image-small-check"),i=e.find("i:eq(1)").data("value"),$(".horizontalalign-container > .horizontalalign-group-container .horizontalalign-group > i:eq(0)",n.element).removeClass().addClass("horizontalalign-icon-small-"+value.toLowerCase()),$(".horizontalalign-container > .horizontalalign-group-container .horizontalalign-group > i:eq(1)",n.element).text(i),$(".horizontalalign-values",this.element).removeClass("horizontalalign-open").addClass("horizontalalign-close")),n.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:i.toLowerCase(),data:i.toLowerCase(),type:n.options.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")}),n.inputValue=i.toLowerCase()},".horizontalalign-group click":function(e,t){this.selectOption(e,t)},".horizontalalign-values > .horizontalalign-group click":function(e,t){this.selectOption(e,t)},".horizontalalign-values mouseenter":function(e,t){$(".horizontalalign-container > .horizontalalign-group-container .horizontalalign-image-normal-expand",this.element).removeClass("horizontalalign-hidden").addClass("horizontalalign-show"),$(".horizontalalign-container > .horizontalalign-group-container .horizontalalign-group",this.element).removeClass("horizontalalign-collapsed").addClass("horizontalalign-expanded")},".horizontalalign-values mouseleave":function(e,t){$(".horizontalalign-container > .horizontalalign-group-container .horizontalalign-image-normal-expand").removeClass("horizontalalign-show").addClass("horizontalalign-hidden"),$(".horizontalalign-container > .horizontalalign-group-container .horizontalalign-group").removeClass("horizontalalign-expanded").addClass("horizontalalign-collapsed"),e.removeClass("horizontalalign-open").addClass("horizontalalign-close")}}),bizagi.editor.component.editor("bizagi.editor.component.editor.rendertype",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.clicks=0,n.inputValue=n.options.value,i=$.tmpl(this.getTemplate("frame"),t),$.each(t.data,function(e,t){n.renderOptions(i.find("select"),t)}),i.appendTo(e)},renderOptions:function(e,t){var i="";t.hasOwnProperty("selected")&1==t.selected&&(i=" selected=selected"),$.extend(t,{selected:i}),$.tmpl(this.getTemplate("option"),t).appendTo(e)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.rendertype").concat("#rendertype-frame")),this.loadTemplate("option",bizagi.getTemplate("bizagi.editor.component.editor.rendertype").concat("#rendertype-option"))).done(function(){e.resolve()}),e.promise()},"span focus":function(e,t){e.removeClass("editor-text-rendertype-enabled").addClass("editor-text-rendertype-disabled"),e.next().removeClass("editor-options-disabled").addClass("editor-options-enabled").focus()},"select blur":function(e,t){e.removeClass("editor-options-enabled").addClass("editor-options-disabled"),e.prev().removeClass("editor-text-rendertype-disabled").addClass("editor-text-rendertype-enabled")},"label click":function(e,t){var i=this;i.clicks++,1==i.clicks&&setTimeout(function(){1==i.clicks&&e.next().focus(),i.clicks=0},200)},"label dblclick":function(e,t){var i,n=e.closest(".bizagi_editor_component_editor_rendertype").find("select"),o=n.children().length,r=n.find("option:selected");o-1==n.find("option").index(r)?(n.find("option:first").attr("selected","selected"),i=n.find("option:first").text(),e.next().text(i),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:i,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputValue=i):(r.next().attr("selected","selected"),i=r.next().text(),e.next().text(i),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:i,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputValue=i)},"select change":function(e,t){e.prev().text(e.find("option:selected").text()),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:e.val(),type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputValue=e.val()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.controlreference",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o=this;o.inline=!0,o.retrieveData(t),t.value=t.value?t.value:"isEmpty",o.inputValue=t.value,(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),n=$("label",i),o.addRequired(n),o.myCombo=new o.uiControls.comboBox({uiEditor:o,uiPlaceHolderText:bizagi.localization.getResource("formmodeler-component-editor-all-select-one"),uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:o.inline,onChange:function(e,t){o.responseChangeCombo(e,t,o)}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.controlreference").concat("#controlreference-frame"))).done(function(){e.resolve()}),e.promise()},retrieveData:function(e){var t,i,n,o;if(e["editor-parameters"].hasOwnProperty("elements")){i=e["editor-parameters"].elements.length,o=[];for(var r=0;r<i;r++)(n={}).label=e["editor-parameters"].elements[r].displayname,n.value=e["editor-parameters"].elements[r].guid,t="controlreference-icon-"+e["editor-parameters"].elements[r].displayname.i18n.default.replace(/ /gi,"").toLowerCase(),n.icon="column "+t,o.push(n);$.extend(e,{uiValues:o})}return e},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o}}),bizagi.editor.component.editor("bizagi.editor.component.editor.displayname",{init:function(e,t,i){this._super(e,t,i),this.focus=null},renderEditor:function(e,t){var i,n;this.inputValue=this.options.value,this.defaultValue=t.default?t.default:"",this.localization=(t.showLocalization,!0),i=$.tmpl(this.getTemplate("frame"),t),elLocalization=$.tmpl(this.getTemplate("localization")),this.localization&&$(".ui-control-input",i).append(elLocalization),i.appendTo(e),n=$("label",i),this.addRequired(n)},loadTemplates:function(){var e;return e=new $.Deferred,$.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.displayname").concat("#displayname-frame")),this.loadTemplate("localization",bizagi.getTemplate("bizagi.editor.component.editor.displayname").concat("#displayname-localization"))).done(function(){e.resolve()}),e.promise()},remove:function(){this.element.hide(),this.element.empty()},"input keyup":function(e,t){var i=e.val();13==t.keyCode&&i!==this.inputValue&&(this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:i,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputValue=i)},"input blur":function(e,t){var i=this.element.find('input[type="text"]').parent(),n=e.val();this.element.find(".editor-displayname-localization").removeClass("ui-control-fadeIn"),i.toggleClass("ui-control-focus"),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:n,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputValue=n},"input focus":function(e,t){var i,n;i=this.element.find(".editor-displayname-localization"),inputParent=this.element.find('input[type="text"]').parent(),i.addClass("ui-control-fadeIn"),inputParent.toggleClass("ui-control-focus"),(n=e.val())!==this.inputValue&&(this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:n,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputValue=n)},"span.editor-displayname-localization click":function(e,t){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SHOW_LOCALIZATION,id:this.element.closest(".bizagi_editor_component_properties").data("id")})},"span.editor-displayname-localization mouseenter":function(e,t){e.addClass("ui-control-fadeIn")},"span.editor-displayname-localization mouseleave":function(e,t){e.removeClass("ui-control-fadeIn")}}),bizagi.editor.component.editor("bizagi.editor.component.editor.int",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o=this,r="";void 0===t.value?t.value="":null===t.value&&(t.value=""),o.inputValue=t.value,o.defaultValue=void 0!==t.default&&null!==t.default?t.default:"",o.suffix="",t["editor-parameters"].hasOwnProperty("suffix")&&""!=t["editor-parameters"].suffix&&(o.suffix=t["editor-parameters"].suffix,r=o.suffix+" "),i=$.tmpl(this.getTemplate("frame"),$.extend({},t,{templateSuffix:r}));var a=$.tmpl(this.getTemplate("default"));if(i.append(a),i.appendTo(e),t["editor-parameters"].hasOwnProperty("placeholder-type")){var s=t["editor-parameters"]["placeholder-type"];o.setPlaceholder(i),"default"==s&&""!=o.defaultValue&&(o.options["editor-parameters"].max=parseInt(o.defaultValue))}n=$("label",i),o.addRequired(n)},setPlaceholder:function(e){var t=this,i=parseInt(t.defaultValue),n=parseInt(t.options.value),o=e.find("input");isNaN(n)?isNaN(i)||o.attr("placeholder",i):-1!=i&&n>i&&t.registerCallback(function(){t.Error=bizagi.localization.getResource("formmodeler-component-editor-int-error-default")+i,t.showError(o,t.Error),o.select()})},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.int").concat("#int-frame")),this.loadTemplate("default",bizagi.getTemplate("bizagi.editor.component.editor.int").concat("#int-default-action"))).done(function(){e.resolve()}),e.promise()},remove:function(){this.element.hide(),this.element.empty()},validate:function(e){var t,i,n=!1;return i=(t=$(e)).val(),isNaN(parseInt(i))?(n=!1,""!=i&&(t.hasClass("error")||t.addClass("error"),this.Error=bizagi.localization.getResource("formmodeler-component-editor-int-error-integer"),this.showError(e,this.Error),t.select())):this.isInt(i)&&this.isInRange(i)&&!isNaN(parseInt(i))?(t.removeClass("error"),this.hideError(e),n=!0):(t.hasClass("error")||t.addClass("error"),this.showError(e,this.Error),t.select()),n},isInRange:function(e){var t=!0,i=this.options["editor-parameters"].min,n=this.options["editor-parameters"].max,o=parseInt(e);return null!=i&&""!==i&&(isNaN(parseInt(i))||o<parseInt(i)&&(this.Error=bizagi.localization.getResource("formmodeler-component-editor-int-error-rangemin").replace("$0",i),t=!1)),null!=n&&""!==n&&(isNaN(parseInt(n))||-1!=parseInt(n)&&o>parseInt(n)&&(this.Error=bizagi.localization.getResource("formmodeler-component-editor-int-error-rangemax").replace("$0",n),t=!1)),t},isInt:function(e){var t;return t=RegExp("^[-+]?[0-9]+"+this.suffix+"$"),this.Error=bizagi.localization.getResource("formmodeler-component-editor-int-error-integer"),t.test(e)||""==e},"input[type='text'] blur":function(e,t){var i,n;(e.val($.trim(e.val())),n=e.val(),""!=this.suffix)&&(RegExp("^[-+]?[0-9]+"+this.suffix+"$").test(n)||/^[-+]?[0-9]+$/.test(n)&&e.val(n+this.suffix));(this.validate(e)||""==n)&&(i=parseInt(n),isNaN(i)&&(i=void 0),this.controller.publish("propertyEditorChanged",{oldValue:this.inputValue,newValue:i,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}))},"input[type='text'] keydown":function(e,t){var i,n;if(n=e.val(),13==t.keyCode){if(e.val($.trim(e.val())),""!=this.suffix)RegExp("^[-+]?[0-9]+"+this.suffix+"$").test(n)||/^[-+]?[0-9]+$/.test(n)&&e.val(n+this.suffix);(this.validate(e)||""==n)&&(i=parseInt(n),isNaN(i)&&(i=void 0),this.controller.publish("propertyEditorChanged",{oldValue:this.inputValue,newValue:i,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}))}},".biz-ico.biz-ico-default click":function(e,t){var i,n;(n=this.element.find("input")).val(""),n.hasClass("error")&&(n.removeClass("error"),this.hideError(n)),i={oldValue:this.inputValue,newValue:void 0,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.controller.publish("propertyEditorChanged",i)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.renderlayout",{listensTo:["innerPropertyChange"]},{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r,a,s=this;s.properties=[],n=t.subproperties.length;var l=t.subproperties[2]?t.subproperties[2].property.value:null,d=t.subproperties[2]?t.subproperties[2].property.default:null;s.layoutType=l||d,r=s.calculateValues(t.subproperties).replace(/\%/gi,""),this.values=s.retrieveValues(r),a=s.retrieveNames(t.subproperties),t.caption=t.caption||"Layout",$.extend(t,{calculatedValues:r},this.values,a),(i=$.tmpl(s.getTemplate("frame"),t)).find(".renderlayout-group").hide().addClass("renderlayout-close");for(var c=0;c<n;c++)o=t.subproperties[c].property,s.renderSubproperty(i.find(".renderlayout-group"),o);i.appendTo(e),s.inputValue=[],"pixels"==s.layoutType?(s.defaultLabelValue=t.subproperties[0].property.default,s.defaultControlValue=t.subproperties[1].property.default,s.defaultPixelValue=s.properties[0].options.value):(s.defaultLabelValue=s.properties[0].options.value,s.defaultControlValue=s.properties[1].options.value,s.defaultPixelValue=""),s.subpropertiesReset=t.subproperties,s.inputValue.push(s.defaultLabelValue),s.inputValue.push(s.defaultControlValue),s.createDialogEditor(t)},createDialogEditor:function(e){var t,i,n,o,r,a,s=this;s.elPopUpContent=t=$.tmpl(s.getTemplate("content-popup"),e),i=$.tmpl(s.getTemplate("actions-popup"),e),$(".renderlayout-box1",t).text(s.defaultLabelValue+"%").attr("data-value",s.defaultLabelValue+"%"),$(".renderlayout-box2",t).text(s.defaultControlValue+"%").attr("data-value",s.defaultControlValue+"%"),$("#renderlayout-px-label",t).val(s.defaultPixelValue),(r=$(".biz-action-btn",i).eq(1)).click(function(e){s.responseOkButton.apply(s,[r,e])}),(o=$(".biz-action-btn",i).eq(2)).click(function(e){s.responseCancelButton.apply(s,[o,e])}),(a=$(".biz-action-btn",i).eq(0)).click(function(e){s.responseApplyButton.apply(s,[a,e])}),$(".renderlayout-split",t).mousemove(function(){s.setBoxesValue($(this).val())}),s.createEditorUIControls(e,t),s.modalReference=s.createDialog(t,i),(n=$(".biz-btn-close",s.modalReference).eq(0)).click(function(e){s.responseCloseButton.apply(s,[n,e])})},setBoxesValue:function(e){var t=e,i=100-t;$(".renderlayout-box1",self.elPopUpContent).text(t+"%").attr("data-value",t),$(".renderlayout-box2",self.elPopUpContent).text(i+"%").attr("data-value",i)},renderSubproperty:function(e,t){var i,n;i=$.tmpl(this.getTemplate("frame-property"),t),t.value=parseFloat(t.value),$.extend(t,{"editor-parameters":{suffix:"%",range:{min:0,max:100}}}),n=new bizagi.editor.component.editor.int(i,t,this.controller),this.properties.push(n),i.appendTo(e),n.render()},calculateValues:function(e){var t,i,n="",o=[50,50];for(t="pixels"==this.layoutType?e.length-2:e.length-1,n+="",i=0;i<t;i++)e[i].property.hasOwnProperty("value")&null!=e[i].property.value?n+=e[i].property.value:e[i].property.hasOwnProperty("default")&null!=e[i].property.default?n+=e[i].property.default:(n+=o[i],e[i].property.value=o[i]),n+=i==t-1?"":", ";return n+=""},retrieveValues:function(e){var t=e.replace(/\[|\]|,/g,"").trim().split(" ");return{per1:t[0],per2:t[1]}},retrieveNames:function(e){var t,i=[],n=e.length;for(t=0;t<n;t++)i[t]=e[t].property.caption;return{caption1:i[0],caption2:i[1]}},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.renderlayout").concat("#renderlayout-frame")),this.loadTemplate("frame-property",bizagi.getTemplate("bizagi.editor.component.editor.renderlayout").concat("#renderlayout-frame-property")),this.loadTemplate("content-popup",bizagi.getTemplate("bizagi.editor.component.editor.renderlayout").concat("#renderlayout-frame-popup")),this.loadTemplate("actions-popup",bizagi.getTemplate("bizagi.editor.component.editor.renderlayout").concat("#renderlayout-frame-popup-actions"))).done(function(){e.resolve()}),e.promise()},responseCloseDialog:function(){this.element.empty(),this.renderEditor(this.element,this.options)},".renderlayout-value click":function(e,t){this.showDialogBox(e,t)},".renderlayout-data > .biz-ico.ui-control-modal click":function(e,t){this.showDialogBox(e,t)},showDialogBox:function(e,t){var i=this;i.showDialog(e,t).done(function(){var e=$(".renderlayout-split",i.modalReference),t=i.inputValue[0];e.val(t)}),i.responseChangeDefaultFormat(i.layoutType,i.elPopUpContent),$("#renderlayout-px-label",i.modalReference).bind("keypress",function(e){var t=e.charCode?e.charCode:e.keyCode;if(8!=t&&(t<48||t>57))return!1})},responseCloseButton:function(){this.responseCloseDialog(),this.resetDataLayout()},responseOkButton:function(){var e=this,t=$("#renderlayout-px-label",e.modalReference).val(),i=bizagi.localization.getResource("bizagi-editor-px-value-empty");if("pixels"!=e.myCombo.value||""!=t&&"NaN"!=t){e.saveDataLayout({btnClicked:"ok"}),e.hideDialog(function(){e.responseCloseDialog()})}else bizagi.showMessageBox(i,"Bizagi","error")},responseApplyButton:function(){var e=$("#renderlayout-px-label",this.modalReference).val(),t=bizagi.localization.getResource("bizagi-editor-px-value-empty");if("pixels"!=this.myCombo.value||""!=e&&"NaN"!=e){this.saveDataLayout({btnClicked:"apply"})}else bizagi.showMessageBox(t,"Bizagi","error")},saveDataLayout:function(e){var t,i,n,o=this,r=(e=e||{},o.options.subproperties);void 0!==e.subproperties&&(r=e.subproperties),t=r[0],i=r[1],n=r[2],o.layoutType=o.myCombo.value,"pixels"==o.layoutType?(t.property.value=$("#renderlayout-px-label",o.modalReference).val(),i.property.value="1"):(t.property.value=$(".renderlayout-box1",o.modalReference).attr("data-value"),i.property.value=$(".renderlayout-box2",o.modalReference).attr("data-value"));var a=[];a.push({property:t.property.name,value:t.property.value.replace(/\%/gi,"")}),a.push({property:i.property.name,value:i.property.value.replace(/\%/gi,"")}),n&&n.property&&(n.property.value=o.layoutType,a.push({property:n.property.name,value:n.property.value})),o.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_MULTIPLE_PROPERTIES,properties:a,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),void 0!==e.btnClicked&&("ok"!=e.btnClicked&&"apply"!=e.btnClicked||(o.subpropertiesReset=r))},resetDataLayout:function(){var e={subproperties:this.subpropertiesReset};this.saveDataLayout(e)},responseCancelButton:function(){var e=this;e.hideDialog(function(){e.responseCloseDialog()}),e.resetDataLayout()},responseChangeDefaultFormat:function(e,t){var i=$(".renderlayout-names[data-id='percentageData']",this.modalReference),n=$(".renderlayout-names[data-id='pixelData']",this.modalReference),o=$(".ui-bizagi-editor-comboBox-option",t),r=$(".biz-btn",o[0]),a=$(".biz-btn",o[1]),s=$(".biz-ico",r),l=$(".biz-ico",a),d=$(".ui-control-text-box, .ui-comboBox-selector-text",t),c=$("i",d),u=$("span",d),p=this.values.per1;p>100&&(this.values.per1=50);var m=100-p;s.removeClass(),l.removeClass(),"pixels"==e?($(".renderlayout-separator",t).hide(),c.removeClass("ui-comboBox-image-large-percentage biz-ico-0"),c.addClass("ui-comboBox-image-large-pixels biz-ico-0"),u.text(bizagi.localization.getResource("formmodeler-component-editor-renderLayout-pixels-format")),i.addClass("renderlayout-px-active"),n.removeClass("renderlayout-px-active"),s.addClass("biz-ico ui-comboBox-image-small-uncheck"),l.addClass("biz-ico ui-comboBox-image-small-check")):($(".renderlayout-separator",t).show(),c.removeClass("ui-comboBox-image-large-pixels biz-ico-0"),c.addClass("ui-comboBox-image-large-percentage biz-ico-0"),u.text(bizagi.localization.getResource("formmodeler-component-editor-renderLayout-percentage-format")),i.removeClass("renderlayout-px-active"),""!=p&&(this.values.per2=m,$(".renderlayout-box2",t).text(m+"%").attr("data-value",m)),n.addClass("renderlayout-px-active"),s.addClass("biz-ico ui-comboBox-image-small-check"),l.addClass("biz-ico ui-comboBox-image-small-uncheck"))},createEditorUIControls:function(e,t){var i=this;$.extend(e,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-renderLayout-percentage-format"),value:"percentage"},{label:bizagi.localization.getResource("formmodeler-component-editor-renderLayout-pixels-format"),value:"pixels"}]}),i.myCombo=new i.uiControls.comboBox({uiWidthIcon:0,uiEditor:i,uiInitValue:i.layoutType,uiContainer:$(".renderLayout-modal-default-format",t),uiValues:e.uiValues,uiInline:i.inline,onChange:function(e,n){i.responseChangeDefaultFormat(e,t)}})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.displaytype",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o=this;o.inline=!0,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-displaytype-option-both"),value:"both",style:" bz-studio bz-display-both_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-displaytype-option-label"),value:"label",style:"bz-studio bz-text-label_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-displaytype-option-value"),value:"value",style:"bz-studio bz-display-value_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-displaytype-option-reversed"),value:"reversed",style:"bz-studio bz-display-reversed_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-displaytype-option-vertical"),value:"vertical",style:"bz-studio bz-display-vertical_16x16_standard"}]}),o.removeItems(t),t.value=t.value?t.value:"expression";for(var r=0;r<t.uiValues.length;r++)t.value===t.uiValues[r].value&&(t.uiValues[r].selected=!0);o.inputValue=t.value,(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),n=$("label",i),o.addRequired(n);new o.uiControls.comboBox({uiWidthIcon:32,uiEditor:o,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:o.inline,onChange:function(e,t){o.responseChangeCombo(e,t,o)}})},removeItems:function(e){var t=e["editor-parameters"],i=t&&t.hide,n=e.uiValues;if($.isArray(i)&&i.length>0){n=[];for(var o=0,r=e.uiValues.length;o<r;o++){var a=e.uiValues[o].value;-1==$.inArray(a,i)&&n.push(e.uiValues[o])}}e.uiValues=n},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.displaytype").concat("#displaytype-frame"))).done(function(){e.resolve()}),e.promise()},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o}}),bizagi.editor.component.editor("bizagi.editor.component.editor.currencysymbol",{init:function(e,t,i){this._super(e,t,i),this.focus=null},responseChangeCombo:function(e,t,i){var n,o,r;n=i.inputValue,o=e,r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",r),i.inputValue=o;var a=$(".ui-comboBox-value",i.element).html();$(".ui-bizagi-editor-comboBox-selector",i.element).attr("title",a)},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.currencysymbol").concat("#currencysymbol-frame"))).done(function(){e.resolve()}),e.promise()},renderEditor:function(e,t){var i,n=this;$.extend(t,{uiCurrencySymbolValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-separator-main"),value:"-1",unselectable:!0},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-DEF"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-USD"),value:"US$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-EUR"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GBP"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-INR"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-AUD"),value:"AUD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CAD"),value:"CAD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SGD"),value:"SGD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-separator-all"),value:"-1",unselectable:!0},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-AED"),value:"AED$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-AFN"),value:"AFN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ALL"),value:"ALL$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-AMD"),value:"AMD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ANG"),value:"ANG$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-AOA"),value:"AOA$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ARS"),value:"ARS$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-AUD"),value:"AUD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-AWG"),value:"AWG$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-AZN"),value:"AZN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BAM"),value:"BAM$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BBD"),value:"BBD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BDT"),value:"BDT$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BGN"),value:"BGN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BHD"),value:"BHD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BIF"),value:"BIF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BMD"),value:"BMD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BND"),value:"BND$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BOB"),value:"BOB$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BRL"),value:"R$"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BSD"),value:"BSD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BTN"),value:"BTN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BWP"),value:"BWP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BYR"),value:"BYR$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-BZD"),value:"BZD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CAD"),value:"CAD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CDF"),value:"CDF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CHF"),value:"CHF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CLP"),value:"CLP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CNY"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-COP"),value:"COP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CRC"),value:"CRC$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CUC"),value:"CUC$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CUP"),value:"CUP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CVE"),value:"CVE$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-CZK"),value:"K"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-DJF"),value:"DJF "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-DKK"),value:"kr"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-DOP"),value:"DOP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-DZD"),value:"DZD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-EGP"),value:"EGP "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ERN"),value:"ERN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ETB"),value:"ETB$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-EUR"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-FJD"),value:"FJD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-FKP"),value:"FKP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GBP"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GEL"),value:"GEL$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GGP"),value:"GGP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GHS"),value:"GHS$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GIP"),value:"GIP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GMD"),value:"GMD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GNF"),value:"GNF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GTQ"),value:"GTQ$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-GYD"),value:"GYD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-HKD"),value:"HKD "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-HNL"),value:"HNL$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-HRK"),value:"HRK$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-HTG"),value:"HTG$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-HUF"),value:"Ft"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-IDR"),value:"Rp"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ILS"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-IMP"),value:"IMP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-INR"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-IQD"),value:"IQD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-IRR"),value:"IRR$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ISK"),value:"ISKkr "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-JEP"),value:"JEP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-JMD"),value:"J$"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-JOD"),value:"JOD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-JPY"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KES"),value:"KES$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KGS"),value:"KGS$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KHR"),value:"KHR$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KMF"),value:"KMF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KPW"),value:"KPW$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KRW"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KWD"),value:"KWD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KYD"),value:"KYD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-KZT"),value:"KZT$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-LAK"),value:"LAK$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-LBP"),value:"LBP "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-LKR"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-LRD"),value:"LRD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-LSL"),value:"LSL$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-LYD"),value:"LYD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MAD"),value:"MAD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MDL"),value:"MDL$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MGA"),value:"MGA$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MKD"),value:"MKD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MMK"),value:"MMK$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MNT"),value:"MNT$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MOP"),value:"MOP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MRO"),value:"MRO$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MUR"),value:"MUR$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MVR"),value:"MVR$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MWK"),value:"MWK$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MXN"),value:"MXN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-MZN"),value:"MZN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-NAD"),value:"NAD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-NGN"),value:"NGN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-NIO"),value:"NIO$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-NOK"),value:"NOKkr "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-NPR"),value:"NPR "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-NZD"),value:"NZD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-OMR"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-PAB"),value:"B/."},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-PEN"),value:"PEN$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-PGK"),value:"PGK$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-PHP"),value:"Ph"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-PKR"),value:"PKR "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-PLN"),value:"z"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-PYG"),value:"PYG "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-QAR"),value:"QAR "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-RON"),value:"le"},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-RSD"),value:"RSD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-RUB"),value:"RUB "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-RWF"),value:"RWF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SAR"),value:"SAR "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SBD"),value:"SBD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SCR"),value:"SCR$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SDG"),value:"SDG$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SEK"),value:"SEKkr "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SGD"),value:"SGD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SHP"),value:"SHP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SLL"),value:"SLL$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SOS"),value:"SOS$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SPL"),value:"SPL$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SRD"),value:"SRD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-STD"),value:"STD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SVC"),value:"SVC$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SYP"),value:"SYP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-SZL"),value:"SZL$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-THB"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TJS"),value:"TJS$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TMT"),value:"TMT$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TND"),value:"TND$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TOP"),value:"TOP$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TRY"),value:"YTL "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TTD"),value:"TTD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TVD"),value:"TVD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TWD"),value:"TWD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-TZS"),value:"TZS$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-UAH"),value:"UAH$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-UGX"),value:"UGX$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-USD"),value:"US$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-UYU"),value:"UYU$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-UZS"),value:"UZS$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-VEF"),value:"VEFBs "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-VND"),value:"VND$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-VUV"),value:"VUV$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-WST"),value:"WST$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XAF"),value:"XAF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XAG"),value:"XAG$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XAU"),value:"XAU$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XBT"),value:"XBT$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XCD"),value:"XCD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XDR"),value:"XDR$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XOF"),value:"XOF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XPD"),value:"XPD$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XPF"),value:"XPF$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-XPT"),value:"XPT$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-YER"),value:"YER$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ZAR"),value:"ZAR$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ZMW"),value:"ZMW$ "},{label:bizagi.localization.getResource("formmodeler-component-editor-currency-symbol-ZWD"),value:"ZWD$ "}]}),t.uiCurrencySymbolValues.forEach(function(e){$.extend(e,{tooltip:e.label})}),void 0!==typeof t.value&&null!==t.value||(t.value="$"),n.inputValue=t.value,(i=$.tmpl(n.getTemplate("frame"),t)).appendTo(e),void 0===n.options.value&&(t.uiCurrencySymbolValues[1].selected="selected");new n.uiControls.comboBox({uiWidthIcon:32,uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiCurrencySymbolValues,onChange:function(e,t){-1!=e&&n.responseChangeCombo(e,t,n)}})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.totalize",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o=this;o.inline=!0,t["editor-parameters"].type&&"number"==t["editor-parameters"].type?$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-totalize-option-none"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-totalize-option-sum"),value:"sum"},{label:bizagi.localization.getResource("formmodeler-component-editor-totalize-option-max"),value:"max"},{label:bizagi.localization.getResource("formmodeler-component-editor-totalize-option-min"),value:"min"},{label:bizagi.localization.getResource("formmodeler-component-editor-totalize-option-avg"),value:"avg"},{label:bizagi.localization.getResource("formmodeler-component-editor-totalize-option-count"),value:"count"}]}):$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-totalize-option-none"),value:""},{label:bizagi.localization.getResource("formmodeler-component-editor-totalize-option-count"),value:"count"}]}),t.value=t.value?t.value:"expression";for(var r=0;r<t.uiValues.length;r++)t.value===t.uiValues[r].value&&(t.uiValues[r].selected=!0);o.inputValue=t.value,(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),n=$("label",i),o.addRequired(n);new o.uiControls.comboBox({uiWidthIcon:32,uiEditor:o,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:o.inline,onChange:function(e,t){o.responseChangeCombo(e,t,o)}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.totalize").concat("#totalize-frame"))).done(function(){e.resolve()}),e.promise()},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o}}),bizagi.editor.component.editor("bizagi.editor.component.editor.daterange",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;t.caption=t.caption||bizagi.localization.getResource("formmodeler-component-editor-daterange-caption"),n.data=t,n.container=e,n.value=t.value?bizagi.clone(t.value):{},n.setEditorParameters(t),t.value=t.value||{},(i=$.tmpl(n.getTemplate("frame"),t)).appendTo(e),n.inputValue=t.value,n.mapSubproperties=n.generateMapSubProperties(t),n.renderMinValue(i),n.renderMaxValue(i)},setEditorParameters:function(e){this.showTime=!0===e["editor-parameters"].showtime.value?"daterange-show-time":"daterange-not-show-time",this.showtime=e["editor-parameters"].showtime.value,this.isOffline=e["editor-parameters"].isOffline||!1,this.isAdhocProcess=e["editor-parameters"].isAdhocProcess||!1},renderMinValue:function(e){var t,i,n=this;for(var o in n.data.min={value:null,caption:bizagi.localization.getResource("formmodeler-component-editor-daterange-min-caption"),style:"min-value"},n.mapSubproperties)if(-1!==n.mapSubproperties[o].name.indexOf("min")&&n.mapSubproperties[o].value){t=n.mapSubproperties[o].value,i="date"===n.mapSubproperties[o]["bas-type"]?"min":n.mapSubproperties[o].name.split(".")[1],$.extend(n.data.min,{value:t,type:i});break}null===n.data.min.value&&$.extend(n.data.min,{value:null,type:"min"}),n.data.min.style="daterange-min-value",n.renderTypeEditor(e,n.data.min)},renderMaxValue:function(e){var t,i,n=this;for(var o in n.data.max={value:null,caption:bizagi.localization.getResource("formmodeler-component-editor-daterange-max-caption"),style:"max-value"},n.mapSubproperties)if(-1!==n.mapSubproperties[o].name.indexOf("max")&&n.mapSubproperties[o].value){t=n.mapSubproperties[o].value,i="date"===n.mapSubproperties[o]["bas-type"]?"max":n.mapSubproperties[o].name.split(".")[1],$.extend(n.data.max,{value:t,type:i});break}null===n.data.max.value&&$.extend(n.data.max,{value:null,type:"max"}),n.data.max.style="daterange-max-value",n.renderTypeEditor(e,n.data.max)},generateMapSubProperties:function(e){for(var t,i=e.subproperties,n={},o=0;o<i.length;o++)n[t=i[o].property.name]=i[o].property,n[t].value&&("date"===n[t]["bas-type"]?n[t].value||(n[t].value=null):n[t].value.baref.ref||(n[t].value=null));return n},renderTypeEditor:function(e,t){var i,n,o,r,a=this,s=a.isOffline||!1,l=a.isAdhocProcess||!1;switch(i=t.type,o=t.value,$.extend(t,{isOffline:s,isAdhocProcess:l}),i){case"max":case"min":var d=a.showtime?" daterange-show-time":" daterange-not-show-time",c=t.style.concat(d),u=o||a.value[i];$.extend(t,{style:c,fixedvalue:u}),n=a.renderDefaultDate(e,t),a.showtime?$(".daterange-date-container .daterange-date-value",n).will_pickdate({timePicker:!0,allowEmpty:!0,militaryTime:!0,inputOutputFormat:"m/d/Y H:i:s",format:"m/d/Y H:i",onSelect:function(e){e=$.datepicker.formatDate("mm/dd/yy",e)+" "+a.retrieveHumanTime(e),t.value=e,r=$(".daterange-date-container .daterange-date-value",n),a.validateAndPublishFixedSubproperties(t,t.value,r)}}):$(".daterange-date-container .daterange-date-value",n).will_pickdate({allowEmpty:!0,militaryTime:!0,inputOutputFormat:"m/d/Y",format:"m/d/Y",onSelect:function(e){e=$.datepicker.formatDate("mm/dd/yy",e),t.value=e,r=$(".daterange-date-container .daterange-date-value",n),a.validateAndPublishFixedSubproperties(t,t.value,r)}});break;case"maxrule":case"maxrule90":case"minrule":case"minrule90":$.extend(t,{showTime:a.showTime}),t.rule=o||a.value[i].rule,a.renderDefaultRule(e,t)}},redrawRenderEditor:function(e,t,i){for(var n=this.data.subproperties,o=0;o<n.length;o++)if(n[o].property.name===t){n[o].property.value=i,this.options.value[t.split(".")[1]]=i;break}this.renderEditor(e,this.data)},renderDefaultDate:function(e,t){var i,n;return(i=$.tmpl(this.getTemplate("frame-date-fixed"),t)).appendTo(e),t.required=!0===this.mapSubproperties["daterange."+t.type].required,n=$("label",i),this.addRequired(n,t),i},renderDefaultRule:function(e,t){var i,n;return void 0!==t.value.displayName&&""!=t.value.displayName?$.extend(t,{nameRule:t.value.displayName}):$.extend(t,{nameRule:bizagi.localization.getResource("formmodeler-component-editor-daterange-rule")}),(i=$.tmpl(this.getTemplate("frame-rule"),t)).appendTo(e),t.required=!0===this.mapSubproperties["daterange."+t.type].required,n=$("label",i),this.addRequired(n,t),i},retrieveExculsiveSubProperty:function(e){var t=null;switch(e){case"maxrule":t="max";break;case"minrule":t="min";break;case"min":t="minrule";break;case"max":t="maxrule"}return t},validateAndPublishFixedSubproperties:function(e,t,i){this.isValidRange(t,e.type)?(this.hideError(i),this.mapSubproperties["daterange."+e.type].value=t,this.publishFixedSubproperties(e,t)):this.showError(i,this.error)},isValidRange:function(e,t){var i=!1,n=this.mapSubproperties["daterange.min"].value?this.mapSubproperties["daterange.min"].value:null,o=this.mapSubproperties["daterange.max"].value?this.mapSubproperties["daterange.max"].value:null;return"min"==t?null===o||""==o?i=!0:this.compareDate(o,e)>=0&&(i=!0):null===n||""==n?i=!0:this.compareDate(e,n)>=0&&(i=!0),!1===i&&(this.error=bizagi.localization.getResource("formmodeler-component-editor-daterange-error-range")),i},compareDate:function(e,t){var i=new Date(e),n=new Date(t);return i.valueOf()==n.valueOf()?0:i.valueOf()>n.valueOf()?1:-1},publishFixedSubproperties:function(e,t){var i,n;n="daterange."+e.type;var o=this.retrieveOldValue(e.type);this.value?this.value[n]||(this.value[n]={}):this.value={},this.value[n]=t,i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:o,newValue:void 0===t?void 0:t,data:void 0===t?void 0:t,type:n,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.controller.publish("propertyEditorChanged",i)},publishRuleSubproperties:function(e,t){var i,n,o=this;n="daterange."+e;var r=o.isRule90(e)?"rule90":"rule",a=o.retrieveOldValue(e);if(o.value?o.value[n]||(o.value[n]={}):o.value={},void 0===t)i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:a,newValue:t,data:t,type:n,id:o.element.closest(".bizagi_editor_component_properties").data("id")};else{o.value[n].rule={baref:{ref:t}};var s={};s[r]=o.value[n].rule,i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_EXPRESSION,oldValue:a,data:s,type:n,id:this.element.closest(".bizagi_editor_component_properties").data("id"),categorytype:"Scripting",editor:"rule"}}o.controller.publish("propertyEditorChanged",i),o.removeFixedExclusiveProperty(e),void 0===t&&(o.element.empty(),o.redrawRenderEditor(o.container,n,t))},removeFixedExclusiveProperty:function(e){var t;t=this.retrieveExculsiveSubProperty(e),this.publishFixedSubproperties({type:t},void 0)},removeRuleExclusiveProperty:function(e){var t;t=this.retrieveExculsiveSubProperty(e),this.publishRuleSubproperties(t,void 0)},retrieveOldValue:function(e){return this.value[e]?""!=this.value[e]?this.value[e]:"expression"!=this.value[e].rule.baref.ref?{rule:this.value[e].rule}:"":""},retrieveHumanTime:function(e){var t=e.getHours(),i=e.getMinutes();return(t=t<10?"0"+t:t)+":"+(i=i<10?"0"+i:i)+":00"},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.daterange").concat("#daterange-frame")),this.loadTemplate("frame-date-fixed",bizagi.getTemplate("bizagi.editor.component.editor.daterange").concat("#daterange-frame-date-fixed")),this.loadTemplate("frame-rule",bizagi.getTemplate("bizagi.editor.component.editor.daterange").concat("#daterange-frame-rule"))).done(function(){e.resolve()}),e.promise()},getMinRuleName:function(){var e=this.options.min;return e&&e.rule?e.type:"minrule"},getMaxRuleName:function(){var e=this.options.max;return e&&e.rule?e.type:"maxrule"},isRule90:function(e){return e.indexOf("90")>=0},"i.daterange-rule-external click":function(e,t){var i;i=e.closest(".ui-control-input").hasClass("daterange-min-value")?this.getMinRuleName():this.getMaxRuleName(),void 0!==this.options.value[i]&&null!==this.options.value[i]?this.publishRuleSubproperties(i,this.options.value[i].baref.ref):this.publishRuleSubproperties(i,"expression")},".daterange-date-container .daterange-image-rule-delete click":function(e,t){var i;i=e.closest(".ui-control-input").hasClass("daterange-min-value")?this.getMinRuleName():this.getMaxRuleName(),this.publishRuleSubproperties(i,void 0)},".daterange-date-container .daterange-image-fixed-delete click":function(e,t){var i,n=e.closest(".ui-control-input");i=n.hasClass("daterange-min-value")?"min":"max",$(".daterange-date-value",n).val(""),this.publishFixedSubproperties({type:i},void 0)},".biz-ico.daterange-image-rule-edit click":function(e,t){var i;i=e.closest(".ui-control-input").hasClass("daterange-min-value")?this.getMinRuleName():this.getMaxRuleName(),void 0!==this.options.value[i]&&null!==this.options.value[i]?this.publishRuleSubproperties(i,this.options.value[i].baref.ref):this.publishRuleSubproperties(i,"expression")},".biz-ico.daterange-image-fixed-edit click":function(e,t){var i=e.closest(".ui-control-input");$(".daterange-date-value",i).focus()},".biz-complex-btn.daterange-button-value click":function(e,t){var i=e.closest(".ui-control-input");$(".daterange-date-value",i).focus()},".daterange-rule-value .daterange-button-value click":function(e,t){var i;i=e.closest(".ui-control-input").hasClass("daterange-min-value")?this.getMinRuleName():this.getMaxRuleName(),void 0!==this.options.value[i]&&null!==this.options.value[i]?this.publishRuleSubproperties(i,this.options.value[i].baref.ref):this.publishRuleSubproperties(i,"expression")}}),bizagi.editor.component.editor("bizagi.editor.component.editor.numberrange",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i;t.caption=t.caption||bizagi.localization.getResource("formmodeler-component-editor-numberrange-caption"),this.data=t,this.container=e,this.setEditorParameters(t),t.value=t.value||{},(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),this.inputValue=t.value,this.mapSubproperties=this.generateMapSubProperties(t),this.renderMinValue(i),this.renderMaxValue(i)},setEditorParameters:function(e){this.allowdecimals=e["editor-parameters"].allowdecimals.value,this.isOffline=e["editor-parameters"].isOffline||!1},renderMinValue:function(e){var t,i,n=this;for(var o in n.data.min={value:null,caption:bizagi.localization.getResource("formmodeler-component-editor-numberrange-min-caption"),style:"min-value"},n.mapSubproperties)if(-1!==n.mapSubproperties[o].name.indexOf("min")&&n.mapSubproperties[o].value){t=n.mapSubproperties[o].value,i="number"===n.mapSubproperties[o]["bas-type"]?"min":n.mapSubproperties[o].name.split(".")[1],$.extend(n.data.min,{value:t,type:i});break}null===n.data.min.value&&$.extend(n.data.min,{value:null,type:"min"}),n.data.min.style="numberrange-min-value",n.renderTypeEditor(e,n.data.min)},renderMaxValue:function(e){var t,i,n=this;for(var o in n.data.max={value:null,caption:bizagi.localization.getResource("formmodeler-component-editor-numberrange-max-caption"),style:"max-value"},n.mapSubproperties)if(-1!==n.mapSubproperties[o].name.indexOf("max")&&n.mapSubproperties[o].value){t=n.mapSubproperties[o].value,i="number"===n.mapSubproperties[o]["bas-type"]?"max":n.mapSubproperties[o].name.split(".")[1],$.extend(n.data.max,{value:t,type:i});break}null===n.data.max.value&&$.extend(n.data.max,{value:null,type:"max"}),n.data.max.style="numberrange-max-value",n.renderTypeEditor(e,n.data.max)},generateMapSubProperties:function(e){for(var t,i=e.subproperties,n={},o=0;o<i.length;o++)n[t=i[o].property.name]=i[o].property,n[t].value&&("number"===n[t]["bas-type"]?n[t].value||(n[t].value=null):n[t].value.baref.ref||(n[t].value=null));return n},renderTypeEditor:function(e,t){var i,n,o,r=this;switch(i=t.type,o=t.value,$.extend(t,{isOffline:r.isOffline}),i){case"max":case"min":var a=r.allowdecimals?" numberrange-show-time":" numberrange-not-show-time",s=t.style.concat(a),l=o||r.data.value[i];$.extend(t,{style:s,fixedvalue:l}),n=r.renderDefaultNumber(e,t),$(".numberrange-"+i+"-value .numberrange-number-value",n).bind("blur",function(){var e=$(this),n=e.val();t.value=r.mapSubproperties["numberrange."+i].value=n,r.validateAndPublish(t,e)}),$(".numberrange-"+i+"-value .numberrange-number-value",n).bind("keyup",function(e){if(13==e.keyCode){var n=$(this),o=n.val();t.value=r.mapSubproperties["numberrange."+i].value=o,r.validateAndPublish(t,n)}});break;case"maxrule":case"maxrule90":case"minrule":case"minrule90":$.extend(t,{allowdecimals:r.allowdecimals}),t.rule=o||r.data.value[i].rule,r.renderDefaultRule(e,t)}},redrawRenderEditor:function(e,t,i){for(var n=this.data.subproperties,o=0;o<n.length;o++)if(n[o].property.name===t){n[o].property.value=i,this.options.value[t.split(".")[1]]=i;break}this.renderEditor(e,this.data)},renderDefaultNumber:function(e,t){var i;return(i=$.tmpl(this.getTemplate("frame-number-fixed"),t)).appendTo(e),i},renderDefaultRule:function(e,t){var i;return void 0!==t.value.displayName&&""!=t.value.displayName?$.extend(t,{nameRule:t.value.displayName}):$.extend(t,{nameRule:bizagi.localization.getResource("formmodeler-component-editor-numberrange-rule")}),(i=$.tmpl(this.getTemplate("frame-rule"),t)).appendTo(e),i},retrieveExculsiveSubProperty:function(e){var t=null;switch(e){case"maxrule":t="max";break;case"minrule":t="min";break;case"min":t="minrule";break;case"max":t="maxrule"}return t},publishFixedSubproperties:function(e,t){var i,n,o;n="numberrange."+e.type,o=this.retrieveOldValue(e.type),this.data.value?this.data.value[n]||(this.data.value[n]={}):this.data.value={},this.data.value[n]=t,i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:o,newValue:void 0===t?void 0:t,data:void 0===t?void 0:t,type:n,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.controller.publish("propertyEditorChanged",i)},publishRuleSubproperties:function(e,t){var i,n,o,r=this;n="numberrange."+e;var a=r.isRule90(e)?"rule90":"rule";if(o=r.retrieveOldValue(e),r.data.value?r.data.value[n]||(r.data.value[n]={}):r.data.value={},r.data.value[n].rule={baref:{ref:t}},void 0===t)i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:o,newValue:t,data:t,type:n,id:r.element.closest(".bizagi_editor_component_properties").data("id")};else{var s={};s[a]=r.data.value[n].rule,i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_EXPRESSION,oldValue:o,data:s,type:n,id:this.element.closest(".bizagi_editor_component_properties").data("id"),categorytype:"Scripting",editor:"rule"}}r.controller.publish("propertyEditorChanged",i),r.removeFixedExclusiveProperty(e),void 0===t&&(r.element.empty(),r.redrawRenderEditor(r.container,n,t))},removeFixedExclusiveProperty:function(e){var t;t=this.retrieveExculsiveSubProperty(e),this.publishFixedSubproperties({type:t},void 0)},removeRuleExclusiveProperty:function(e){var t;t=this.retrieveExculsiveSubProperty(e),this.publishRuleSubproperties(t,void 0)},retrieveOldValue:function(e){var t="";return this.data.value[e]?""!=this.data.value[e]?t=this.data.value[e]:this.data.value[e].rule?"expression"!=this.data.value[e].rule.baref.ref&&(t={rule:this.data.value[e].rule}):t="":t="",t},retrieveHumanTime:function(e){var t=e.getHours(),i=e.getMinutes();return(t=t<10?"0"+t:t)+":"+(i=i<10?"0"+i:i)+":00"},isValidRange:function(e,t){var i=!1,n=this.mapSubproperties["numberrange.max"].value?this.mapSubproperties["numberrange.max"].value:null,o=this.mapSubproperties["numberrange.min"].value?this.mapSubproperties["numberrange.min"].value:null;if("min"==t)if(null===n||""===n)i=!0;else if(""===e)o=null,i=!0;else if(this.allowdecimals)(parseFloat(e)<=n||""===n)&&(i=!0);else{var r=n;""===r||void 0===r?i=!0:parseInt(e)<=parseInt(r)&&(i=!0)}else if(null===o||""===o)i=!0;else if(""===e)n=null,i=!0;else if(this.allowdecimals)(parseFloat(e)>=o||""===o)&&(i=!0);else{var a=o;""===a||void 0===a?i=!0:parseInt(e)>=parseInt(a)&&(i=!0)}return!1===i&&(this.error=bizagi.localization.getResource("formmodeler-component-editor-numberrange-error-range")),i},validateAndPublish:function(e,t){var i,n=e.value,o=e.type;!0===this.allowdecimals?(i=/(^$)|(^-?(0|[1-9][0-9]*)(\.[0-9]+)?$)/,this.error=bizagi.localization.getResource("formmodeler-component-editor-numberrange-error-number")):(i=/(^$)|(^-?(0|[1-9][0-9]*)$)/,this.error=bizagi.localization.getResource("formmodeler-component-editor-numberrange-error-int")),i.test(n)&&this.isValidRange(n,o)?(this.hideError(t),this.publishFixedSubproperties(e,e.value)):(this.showError(t,this.error),t.select())},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.numberrange").concat("#numberrange-frame")),this.loadTemplate("frame-number-fixed",bizagi.getTemplate("bizagi.editor.component.editor.numberrange").concat("#numberrange-frame-number-fixed")),this.loadTemplate("frame-rule",bizagi.getTemplate("bizagi.editor.component.editor.numberrange").concat("#numberrange-frame-rule"))).done(function(){e.resolve()}),e.promise()},getMinRuleName:function(){var e=this.options.min;return e&&e.rule?e.type:"minrule"},getMaxRuleName:function(){var e=this.options.max;return e&&e.rule?e.type:"maxrule"},isRule90:function(e){return e.indexOf("90")>=0},"i.numberrange-rule-external click":function(e,t){var i;i=e.closest(".ui-control-input").hasClass("numberrange-min-value")?this.getMinRuleName():this.getMaxRuleName(),void 0!==this.options.value[i]&&null!==this.options.value[i]?this.publishRuleSubproperties(i,this.options.value[i].baref.ref):this.publishRuleSubproperties(i,"expression")},".numberrange-number-container .numberrange-image-rule-delete click":function(e,t){var i;i=e.closest(".ui-control-input").hasClass("numberrange-min-value")?this.getMinRuleName():this.getMaxRuleName(),this.publishRuleSubproperties(i,void 0)},".numberrange-number-container .numberrange-image-fixed-delete click":function(e,t){var i,n=e.closest(".ui-control-input");i=n.hasClass("numberrange-min-value")?"min":"max",$(".numberrange-number-value",n).val(""),this.publishFixedSubproperties({type:i},void 0)},".biz-ico.numberrange-image-rule-edit click":function(e,t){var i;i=e.closest(".ui-control-input").hasClass("numberrange-min-value")?this.getMinRuleName():this.getMaxRuleName(),void 0!==this.options.value[i]&&null!==this.options.value[i]?this.publishRuleSubproperties(i,this.options.value[i].baref.ref):this.publishRuleSubproperties(i,"expression")},".biz-ico.numberrange-image-fixed-edit click":function(e,t){var i=e.closest(".ui-control-input");$(".numberrange-number-value",i).focus()},".numberrange-rule-value .numberrange-button-value click":function(e,t){var i;i=e.closest(".ui-control-input").hasClass("numberrange-min-value")?this.getMinRuleName():this.getMaxRuleName(),void 0!==this.options.value[i]&&null!==this.options.value[i]?this.publishRuleSubproperties(i,this.options.value[i].baref.ref):this.publishRuleSubproperties(i,"expression")}}),bizagi.editor.component.editor("bizagi.editor.component.editor.dateformat",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r,a,s,l,d,c,u=this;u.showTime=t["editor-parameters"].showtime.value,s=!0===t["editor-parameters"].showtime.value?"dateformat-show-time":"dateformat-not-show-time",l=u.retrieveValues(t.value),$.extend(t,l,{showTime:s}),(i=$.tmpl(u.getTemplate("frame"),t)).appendTo(e),c=$("label",i),u.addRequired(c),u.data=t,u.inputValue=t.value,u.inline=!0,u.elPopUpContent=n=$.tmpl(u.getTemplate("modal-content"),t),u.elPopUpActions=o=$.tmpl(u.getTemplate("modal-actions-editor"),{}),t.initValueDateFormat=t.initValueShortDate=!1,l.valueDate===bizagi.localization.getResource("formmodeler-component-editor-dateformat-default-format")&&(t.initValueDateFormat=!0),$(".dateformat-options-default-format-false",n).hide(),$(".dateformat-options-short-date-false",n).hide(),u.showTime?($(".dateformat-format .dateformat-modal-item",n).removeClass("dateformat-col1").addClass("dateformat-col2"),$(".dateformat-modal-time-format",n).parent().show()):($(".dateformat-format .dateformat-modal-item",n).removeClass("dateformat-col2").addClass("dateformat-col1"),$(".dateformat-modal-time-format",n).parent().hide()),u.createEditorDataSources(t),d=u.isShortDate(t),u.createEditorUIControls(t,n),u.showTime?u.populate(u.showTime,{dateFormatSelected:l.valueDate,timeFormatSelected:l.valueTime}):u.populate(u.showTime,{dateFormatSelected:t.value}),u.showTime?$(".dateformat-modal-time",u.elPopUpContent).show():$(".dateformat-modal-time",u.elPopUpContent).hide(),r=$(".biz-action-btn",o).eq(0),a=$(".biz-action-btn",o).eq(1),r.click(function(e){u.responseOkButton.apply(u,[r,e])}),a.click(function(e){u.responseCancelButton.apply(u,[a,e])}),u.dialogReference=u.createDialog(u.elPopUpContent,u.elPopUpActions),d&&$(".dateformat-options-short-date-false",u.dialogReference).show()},isShortDate:function(e){var t={value:!1,index:0},i=e.uiSelect.shortDateSeparator.uiValues,n=e.value;if(n)for(var o=0;o<i.length;o++){if(-1!=n.indexOf(i[o].value)){t={value:!0,index:o};break}}return $.extend(e,{shortDate:t}),t.value},createEditorUIControls:function(e,t){var i=this;i.shortDateComboBox=new i.uiControls.comboBox({uiEditor:i,uiContainer:$(".ui-control-editor.dateformat-short-date",t),uiInitValue:e.uiSelect.shortDateSeparator.uiValues[e.shortDate.index].value,uiValues:e.uiSelect.shortDateSeparator.uiValues,uiInline:i.inline,onChange:function(e,t){i.responseShortDateComboChange(e,t)}}),i.dateFormatComboBox=new i.uiControls.comboBox({uiEditor:i,uiContainer:$(".ui-control-editor.date-format",t),uiInitValue:e.value,uiValues:e.uiSelect.normalDateFormat.uiValues,uiInline:i.inline,onChange:function(e,t){i.responseDateFormatComboChange(e,t)}}),i.timeFormatComboBox=new i.uiControls.comboBox({uiEditor:i,uiContainer:$(".ui-control-editor.time-format",t),uiValues:e.uiSelect.timesDateFormat.uiValues,uiInline:i.inline,onChange:function(e,t){i.responseTimeFormatComboChange(e,t)}}),i.mySwitchDefaultFormat=new i.uiControls.booleanSwitch({uiEditor:i,uiInitValue:e.initValueDateFormat,uiContainer:$(".dateformat-modal-default-format",t),uiValues:e.dateFormatUIValues.uiValues,uiInline:i.inline,onChange:function(e,t){i.responseChangeDefaultFormat(e,t,i)}}),i.mySwitchShortDate=new i.uiControls.booleanSwitch({uiEditor:i,uiInitValue:e.shortDate.value,uiContainer:$(".dateformat-modal-short-date",t),uiValues:e.shortDateUIValues.uiValues,uiInline:i.inline,onChange:function(e,t){i.responseChangeShortDate(e,t,i)}})},createEditorDataSources:function(e){return $.extend(e,{uiSelect:{shortDateSeparator:{uiValues:[{label:"/",value:"/",icon:"separator"},{label:".",value:".",icon:"separator"},{label:"-",value:"-",icon:"separator"}]},shortDateFormat:{uiValues:[{label:"M*d*yyyy",value:"m*d*yy",icon:"date"},{label:"M*d*yy",value:"m*d*y",icon:"date"},{label:"MM*dd*yy",value:"mm*dd*y",icon:"date"},{label:"MM*dd*yyyy",value:"mm*dd*yy",icon:"date"},{label:"yy*MM*dd",value:"y*mm*dd",icon:"date"},{label:"yyyy*MM*dd",value:"yy*mm*dd",icon:"date"},{label:"dd*MM*yyyy",value:"dd*mm*yy",icon:"date"},{label:"dd*MMM*yy",value:"dd*M*y",icon:"date"},{label:"dd*MM*yy",value:"dd*mm*y",icon:"date"}]},normalDateFormat:{uiValues:[{label:"dddd, MMMM dd, yyyy",value:"DD, MM dd, yy",icon:"date"},{label:"MMMM dd, yyyy",value:"MM dd, yy",icon:"date"},{label:"dddd, dd MMMM, yyyy",value:"DD, dd MM, yy",icon:"date"},{label:"dd MMMM, yyyy",value:"dd MM, yy",icon:"date"}]},timesDateFormat:{uiValues:[{label:"hh:mm:ss tt",value:{format:"hh:mm:ss tt",ampm:!0},icon:"hour"},{label:"h:mm:ss tt",value:{format:"h:mm:ss tt",ampm:!0},icon:"hour"},{label:"H:mm:ss",value:{format:"H:mm:ss",ampm:!1},icon:"hour"},{label:"HH:mm:ss",value:{format:"HH:mm:ss",ampm:!1},icon:"hour"}]}}}),$.extend(e,{dateFormatUIValues:{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-dateformat-true"),value:"true"},{label:bizagi.localization.getResource("formmodeler-component-editor-dateformat-false"),value:"false"}]},shortDateUIValues:{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-dateformat-true"),value:"true"},{label:bizagi.localization.getResource("formmodeler-component-editor-dateformat-false"),value:"false"}]}}),e},responseShortDateComboChange:function(e){var t,i;i=this.dateFormatComboBox.label,e&&(i=i.replace(/[/.-]/g,e)),this.showTime?(t=this.timeFormatComboBox.value.format,this.populate(this.showTime,{dateFormatSelected:i,timeFormatSelected:t})):this.populate(this.showTime,{dateFormatSelected:i})},responseDateFormatComboChange:function(){var e,t;e=this.dateFormatComboBox.label,this.showTime?(t=this.timeFormatComboBox.value.format,this.populate(this.showTime,{dateFormatSelected:e,timeFormatSelected:t})):this.populate(this.showTime,{dateFormatSelected:e})},responseTimeFormatComboChange:function(){var e,t;t=this.timeFormatComboBox.value.format,e=this.dateFormatComboBox.label,this.populate(this.showTime,{dateFormatSelected:e,timeFormatSelected:t})},changeItems:function(e,t,i,n){var o,r,a,s,l=this;for((s=$('[class*="ui-modal-arrow"]',l.element).position())&&$('[class*="ui-modal-arrow"]',l.element).css("top",s.top),"disabled"==e?(r="dateformat-enabled",a="dateformat-disabled"):(r="dateformat-disabled",a="dateformat-enabled"),n=n||".empty","disabled"==e&&$(n).slideUp({step:function(){l.updateDialogPosition(!1)}}),o=0;o<t.length;o++)(i||"dateformat-modal-short-date-separator"!==t[o])&&$(".dateformat-modal ."+t[o]).parent().removeClass(r).addClass(a);"enabled"===e&&$(n).slideDown({step:function(){l.updateDialogPosition(!1)},complete:function(){$(this).css("overflow","visible")}}),l.createSampleInputText()},populate:function(e,t){var i,n,o,r,a,s,l,d,c=this;if(o=c.mySwitchShortDate.getValue(),s=t.hasOwnProperty("dateFormatSelected"),l=[],o){for(i=c.shortDateComboBox.getValue(),n=0;n<c.data.uiSelect.shortDateFormat.uiValues.length;n++)s&(r={label:c.data.uiSelect.shortDateFormat.uiValues[n].label.replace(/\*/g,i),value:c.data.uiSelect.shortDateFormat.uiValues[n].value.replace(/\*/g,i),icon:"date"}).label===t.dateFormatSelected&&(r.selected="selected"),l.push(r);c.dateFormatComboBox.update(l)}else{for(n=0;n<c.data.uiSelect.normalDateFormat.uiValues.length;n++)s&(r={label:c.data.uiSelect.normalDateFormat.uiValues[n].label,value:c.data.uiSelect.normalDateFormat.uiValues[n].value,icon:"date"}).label===t.dateFormatSelected&&(r.selected="selected"),l.push(r);c.dateFormatComboBox.update(l)}if(c.showTime){for(d=[],n=0;n<c.data.uiSelect.timesDateFormat.uiValues.length;n++)(a={label:c.data.uiSelect.timesDateFormat.uiValues[n].label,value:c.data.uiSelect.timesDateFormat.uiValues[n].value,icon:"date"}).value.format===t.timeFormatSelected&&(a.selected="selected"),d.push(a);c.timeFormatComboBox.update(d)}c.createSampleInputText()},createSampleInputText:function(){var e,t,i,n;n=$(".dateformat-modal-date-sample",this.dialogReference),this.showTime?(t={hour:(e=new Date).getHours(),minute:e.getMinutes(),second:e.getSeconds()},i=this.timeFormatComboBox.getValue(),n.text($.datepicker.formatDate(this.dateFormatComboBox.getValue(),e)+" "+$.datepicker.formatTime(i.format,t,{ampm:i.ampm}))):(e=new Date,n.text($.datepicker.formatDate(this.dateFormatComboBox.getValue(),e)))},retrieveValues:function(e){var t,i,n;return null==e||""===e?(t=bizagi.localization.getResource("formmodeler-component-editor-dateformat-default-format"),i=""):-1==(n=e.search(/h|H/))?(t=bizagi.util.trim(e.slice(0)),i=""):(t=bizagi.util.trim(e.slice(0,n)),i=e.slice(n)),{valueDate:t,valueTime:i}},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.dateformat").concat("#dateformat-frame")),this.loadTemplate("frame-options",bizagi.getTemplate("bizagi.editor.component.editor.dateformat").concat("#dateformat-frame-options")),this.loadTemplate("modal-content",bizagi.getTemplate("bizagi.editor.component.editor.dateformat").concat("#dateformat-modal")),this.loadTemplate("modal-actions-editor",bizagi.getTemplate("bizagi.editor.component.editor.dateformat").concat("#dateformat-modal-actions"))).done(function(){e.resolve()}),e.promise()},responseChangeDefaultFormat:function(e,t,i){var n,o,r;o=e,r=!!e,n=i.showTime?["dateformat-modal-short-date","dateformat-modal-date-format","dateformat-modal-time-format","dateformat-modal-date-sample"]:["dateformat-modal-short-date","dateformat-modal-date-format","dateformat-modal-date-sample"],o&&n.push("dateformat-modal-short-date-separator"),r?i.changeItems("disabled",n,i.showTime,".dateformat-options-default-format-false"):i.changeItems("enabled",n,i.showTime,".dateformat-options-default-format-false")},responseChangeShortDate:function(e,t,i){if(e?i.changeItems("enabled",["dateformat-modal-short-date-separator"],i.showTime,".dateformat-options-short-date-false"):i.changeItems("disabled",["dateformat-modal-short-date-separator"],i.showTime,".dateformat-options-short-date-false"),e){var n=i.dateFormatComboBox.getLabel();if(i.showTime){var o=i.timeFormatComboBox.value.format;i.populate(i.showTime,{dateFormatSelected:n,timeFormatSelected:o})}else i.populate(i.showTime,{dateFormatSelected:n})}else i.dateFormatComboBox.update(i.data.uiSelect.normalDateFormat.uiValues)},".dateformat-fields > input click":function(e,t){this.openDialog(e,t)},".dateformat-fields > i:eq(1) click":function(e,t){this.openDialog(e,t)},openDialog:function(e,t){var i;this.showDialog(e,t),i=this.retrieveValues(this.options.value).valueDate===bizagi.localization.getResource("formmodeler-component-editor-dateformat-default-format"),this.mySwitchDefaultFormat.update(i),this.responseChangeDefaultFormat(i,null,this)},responseOkButton:function(e,t){var i,n,o,r,a,s=this;i=$(".dateformat-fields .dateformat-field-date",s.element),n=$(".dateformat-fields .dateformat-field-time",s.element),i.val(""),n.val(""),a=s.mySwitchDefaultFormat.getValue(),this.hideDialog(function(){var e;a?(i.val("Default Format"),s.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:s.inputValue,newValue:"",data:"",type:s.options.name,id:s.element.closest(".bizagi_editor_component_properties").data("id")}),s.inputValue=""):(o=s.dateFormatComboBox.getLabel(),s.showTime?(r=s.timeFormatComboBox.getValue(),i.val(o),n.val(r.format),s.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:s.inputValue,newValue:o+" "+r.format,data:o+" "+r.format,type:s.options.name,id:s.element.closest(".bizagi_editor_component_properties").data("id")}),s.inputValue=o+" "+r.format):(i.val(o),e={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:s.inputValue,newValue:o,data:o,type:s.options.name,id:s.element.closest(".bizagi_editor_component_properties").data("id")},s.controller.publish("propertyEditorChanged",e),s.inputValue=o))})},responseCancelButton:function(e,t){this.hideDialog()},".editor-modal .header span:eq(0) click":function(e,t){this.hideDialog()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.gridvalidations",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n;(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),n=$("label",i),this.addRequired(n)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.gridvalidations").concat("#gridvalidations-frame"))).done(function(){e.resolve()}),e.promise()},".biz-action-validate click":function(e,t){t.stopPropagation(),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SHOW_GRID_VALIDATIONS,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.selectprocess",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i=this.getEditorParameters(t);t.showLabel="undefined"==i.showLabel||i.showLabel,t.disabled=t.allowClick||!1,$.tmpl(this.getTemplate("frame"),t).appendTo(e)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.selectprocess").concat("#selectprocess-frame"))).done(function(){e.resolve()}),e.promise()},getEditorParameters:function(e){return e["editor-parameters"]||{}},".biz-action-select-process click":function(e,t){t.stopPropagation(),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_PROCESS,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.retype",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;if(n.paramsRetype=t["editor-parameters"],n.paramsHide=n.paramsRetype&&t["editor-parameters"].hide?t["editor-parameters"].hide:void 0,n.inline=!1,n.inline&&n.element.addClass("retype-inline"),$.extend(t,{uiValues:[{value:"duplicate",style:"bz-studio bz-duplicate-retype_16x16_standard",label:bizagi.localization.getResource("formmodeler-component-editor-retype-duplicate")},{value:"double",style:"bz-studio bz-double-retype_16x16_standard",label:bizagi.localization.getResource("formmodeler-component-editor-retype-double")},{value:"none",style:"bz-studio bz-none-retype_16x16_standard",label:bizagi.localization.getResource("formmodeler-component-editor-retype-none")}]}),"duplicate"!=t.value&&"double"!=t.value&&"none"!=t.value&&(t.value="none"),null!=n.paramsHide)for(var o=0;o<n.paramsHide.length;o++)"duplicate"===n.paramsHide[o]&&(t.uiValues=t.uiValues.slice(1,3));for(o=0;o<t.uiValues.length;o++)t.value===t.uiValues[o].value&&(t.uiValues[o].selected=!0);(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),this.inputValue=t.value;new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:n.inline,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.retype").concat("#retype-frame"))).done(function(){e.resolve()}),e.promise()},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o}}),bizagi.editor.component.editor("bizagi.editor.component.editor.datalist",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o=t.subproperties.length;for(i=$.tmpl(this.getTemplate("frame"),t),this.inputValues={},n=0;n<o;n++)this.inputValues[t.subproperties[n].property.name]=t.subproperties[n].property.value,"filter"==t.subproperties[n].property["bas-type"]||"xpath-from-entity"==t.subproperties[n].property["bas-type"]||"xpathfromentity"==t.subproperties[n].property["bas-type"]?this.renderExternal(i.find(".datalist-group"),t.subproperties[n].property):this.renderSubproperty(i.find(".datalist-group"),t.subproperties[n].property);i.appendTo(e),this.setAsCollapsible(i)},renderExternal:function(container,dataProperty){var elExternal,property;if("true"==dataProperty["user-editable"]){if(elExternal=$.tmpl(this.getTemplate("external"),{}),dataProperty["bas-type"]=this.machineName(dataProperty["bas-type"]),void 0===bizagi.editor.component.editor[dataProperty["bas-type"]])property=/^.*xpath.*$/gi.test(dataProperty["bas-type"])?new bizagi.editor.component.editor.xpath(elExternal,dataProperty,this.controller):new bizagi.editor.component.editor.lstring(elExternal,dataProperty,this.controller);else{var fn=eval("var bafn = function(elExternal, dataProperty, controller) {  return new bizagi.editor.component.editor."+dataProperty["bas-type"]+"(elExternal, dataProperty, controller);};bafn");property=fn(elExternal,dataProperty,this.controller)}elExternal.appendTo(container),property.render()}},machineName:function(e){return e.toLowerCase().replace(/-/g,"")},setAsCollapsible:function(e){var t=$(".ui-content",e);$("h3",e).bind("click",function(){t.slideToggle()})},renderSubproperty:function(e,t){var i,n;"true"==t["user-editable"]&&((i=$.tmpl(this.getTemplate("subproperty"),t)).appendTo(e),n=$("label",i),self.addRequired(n))},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.datalist").concat("#datalist-frame")),this.loadTemplate("subproperty",bizagi.getTemplate("bizagi.editor.component.editor.datalist").concat("#datalist-subproperty")),this.loadTemplate("external",bizagi.getTemplate("bizagi.editor.component.editor.datalist").concat("#datalist-frame-external"))).done(function(){e.resolve()}),e.promise()},".datalist-group .datalist-subproperty-value keydown":function(e,t){t.stopPropagation(),13==t.keyCode&&(this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValues[e.data("name")],newValue:e.val(),data:e.val(),type:e.data("name"),id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputValues[e.data("name")]=e.val())},".datalist-group .datalist-subproperty-external click":function(e,t){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_EDITOR_DATALIST,oldValue:this.inputValues[e.parent().find(".datalist-subproperty-value").data("name")],type:e.parent().find(".datalist-subproperty-value").data("name"),id:this.element.closest(".bizagi_editor_component_properties").data("id")})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.multiple",{init:function(e,t,i,n){t=new bizagi.editor.component.editor.multiple.model(t),this._super(e,t,i),void 0!==n.refProperties&&(this.refProperties=n.refProperties)},renderEditor:function(e,t){var i=this;if(i.value=[],i.model.isExclusive()){var n=$.tmpl(i.getTemplate("frame-exclusive"),i.model.getModel());i.renderExclusiveSubproperties(n.find(".multiple-category-group"))}else n=$.tmpl(i.getTemplate("frame"),t),$.each(i.model.getProperties(),function(e,t){i.renderSubproperty(n.find(".multiple-category-group"),t)});n.appendTo(e),i.setAsCollapsible(n),i.hideSubproperties()},renderProperties:function(e,t){for(var i=this.model.getProperties(),n=0,o=i.length;n<o;n++)this.renderSubproperty(e,i[n],t)},renderExclusiveSubproperties:function(e){for(var t=this.model.getSelectedProperty(),i=0,n=t.length;i<n;i++)this.renderSubproperty(e,t[i],!0)},renderSubproperty:function(e,t,i){var n,o;if(void 0===t.notShow)if(n=$.tmpl(this.getTemplate("frame-property"),{}),t["bas-type"]=this.machineName(t["bas-type"]),/^.*xpath.*$/gi.test(t["bas-type"]))o=void 0===i?new bizagi.editor.component.editor.xpath(n,t,this.controller):new bizagi.editor.component.editor.xpath(n,$.extend({},t,{exclusive:!0}),this.controller),n.appendTo(e),o.render(),this.registerSubproperty(o);else{if(void 0===bizagi.editor.component.editor[t["bas-type"]])throw"Editor "+t["bas-type"]+" doesn't exists.";o=void 0===i?new bizagi.editor.component.editor[t["bas-type"]](n,t,this.controller):new bizagi.editor.component.editor[t["bas-type"]](n,$.extend({},t,{exclusive:!0}),this.controller),n.appendTo(e),o.render(),this.registerSubproperty(o)}},registerSubproperty:function(e){this.refProperties[e.options.name]=e},machineName:function(e){return e.toLowerCase().replace(/-/g,"")},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.multiple").concat("#multiple-frame")),this.loadTemplate("frame-property",bizagi.getTemplate("bizagi.editor.component.editor.multiple").concat("#multiple-frame-property")),this.loadTemplate("frame-exclusive",bizagi.getTemplate("bizagi.editor.component.editor.multiple").concat("#multiple-frame-exclusive"))).done(function(){e.resolve()}),e.promise()},setAsCollapsible:function(e){var t=$(".ui-content",e);$("h3",e).bind("click",function(){t.slideToggle(function(){$(this).css("overflow","visible")})})},hideSubproperties:function(){this.model.isExclusive()&&!this.model.hasValue()&&this.element.find(".multiple-category-group").empty()},updatePropertyToNone:function(){this.model.hasValue()&&this.controller.publish("propertyEditorChanged",{newValue:void 0,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})},".multiple-name click":function(e,t){var i,n;if(i=$(".multiple-name",this.element).index(e),!e.hasClass("selected")){e.hasClass("selected")?($(".multiple-name",this.element).removeClass("selected"),$(".biz-ico",this.element).addClass("multiple-ico-radio-uncheck").removeClass("multiple-ico-radio-check"),$(".biz-ico",e).addClass("multiple-ico-radio-check").removeClass("multiple-ico-radio-uncheck"),$(".biz-ico",this.element).addClass("bz-studio"),$(".biz-ico",this.element).addClass("bz-radio-unselected_16x16_standard").removeClass("bz-radio_16x16_standard"),$(".biz-ico",e).addClass("bz-radio_16x16_standard").removeClass("bz-radio-unselected_16x16_standard"),n=!1):($(".multiple-name",this.element).removeClass("selected"),$(".biz-ico",this.element).addClass("multiple-ico-radio-uncheck").removeClass("multiple-ico-radio-check"),$(".biz-ico",this.element).addClass("bz-studio"),$(".biz-ico",this.element).addClass("bz-radio-unselected_16x16_standard").removeClass("bz-radio_16x16_standard"),e.addClass("selected"),$(".biz-ico",e).addClass("multiple-ico-radio-check").removeClass("multiple-ico-radio-uncheck"),$(".biz-ico",e).addClass("bz-radio_16x16_standard").removeClass("bz-radio-unselected_16x16_standard"),n=!0),this.element.find(".multiple-category-group").empty();var o=this.model.isExclusive(),r=this.element.find(".multiple-category-group");if(n){var a=this.model.getPropertyByIndex(i);a&&this.renderSubproperty(r,a,o)}else this.renderProperties(r,o);e.hasClass("multiple-none-option")&&this.updatePropertyToNone()}}}),$.Class.extend("bizagi.editor.component.editor.multiple.model",{subpropertyRegex:/[^.]*$/},{init:function(e){this.data=e,this.properties={},this.parameters=e&&e["editor-parameters"],this.processData(e)},processData:function(e){if(e.subproperties)for(var t=0,i=e.subproperties.length;t<i;t++){var n=e.subproperties[t];(n=n.property).propertyName=this.Class.subpropertyRegex.exec(n.name)[0],n.selected=this.isMatchValue(n.propertyName),n.selectedcss=n.selected?" selected":"",this.properties[n.name]=n}},getModel:function(){return{caption:this.getCaption(),properties:this.getProperties(),isExclusive:this.isExclusive(),isEmpty:!this.hasValue(),noneCaption:this.getNodeCaption()}},getValue:function(){return this.data.value},isExclusive:function(){return!!this.parameters&&!!bizagi.util.parseBoolean(this.parameters.exclusive)},isOnlyForUpdate:function(e){var t=e["editor-parameters"];return!!t&&!!bizagi.util.parseBoolean(t.onlyforupdate)},isMatchValue:function(e){var t=this.data.value;return!!t&&!!t[e]},hasValue:function(){return!bizagi.util.isEmpty(this.data.value)},getProperties:function(){var e=[];for(var t in this.properties)if(this.properties.hasOwnProperty(t)){var i=this.properties[t];this.isOnlyForUpdate(i)?i.selected&&e.push(i):e.push(i)}return e},getSelectedProperty:function(){var e=this.getProperties();return this.getValue()?$.grep(e,function(e,t){return e.selected}):e},getPropertyByIndex:function(e){return this.getProperties()[e]},getCaption:function(){return this.data.caption||"Multiple"},getNodeCaption:function(){var e=this.data["editor-parameters"]||{};return e.noneCaption?bizagi.editor.utilities.resolveInternalResource(e.noneCaption):bizagi.localization.getResource("formmodeler-component-editor-multiple-none")}}),bizagi.editor.component.editor("bizagi.editor.component.editor.defaultvalue",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i=this;i.Error="",i.setEditorParameters(t),t.value||(t.value=i.getIntialValue()),void 0!==t.value.fixedvalue&&""!==t.value.fixedvalue?i.state=!0:i.isEmptyRule(t.value)?(t.value=i.getIntialValue(),i.state=!0):i.state=!1,i.state=i.state||i.isOffline;var n=$.tmpl(i.getTemplate("frame"),t);n.appendTo(e),i.inputValue=t.value,i.type&&i.renderTypeEditor(n,t)},setEditorParameters:function(e){this.exclusive=void 0!==e["editor-parameters"].exclusive,this.isOffline=e["editor-parameters"].isOffline||!1,this.type=e["editor-parameters"].type,e.isOffline=this.isOffline},getIntialValue:function(){var e={fixedvalue:"",rule:{baref:{ref:"expression"}}};return e},retrieveHumanTime:function(e){var t=e.getHours(),i=e.getMinutes();return(t=t<10?"0"+t:t)+":"+(i=i<10?"0"+i:i)+":00"},renderTypeEditor:function(e,t){var i,n=this;switch(n.type){case"date":var o=!0===t["editor-parameters"].showtime.value?"defaultvalue-show-time":"defaultvalue-not-show-time";$.extend(t,{showTime:o}),n.renderDefaultDate(e,t),!0===t["editor-parameters"].showtime.value?$(".defaultvalue-date-container .defaultvalue-date-value",n.element).will_pickdate({timePicker:!0,allowEmpty:!0,militaryTime:!0,inputOutputFormat:"m/d/Y H:i:s",format:"m/d/Y H:i",onSelect:function(e){e=$.datepicker.formatDate("mm/dd/yy",e)+" "+n.retrieveHumanTime(e),i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:{fixedvalue:e},data:{fixedvalue:e},type:t.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},n.exclusive&&$.extend(i,{exclusive:!0}),n.controller.publish("propertyEditorChanged",i),n.inputValue={fixedvalue:e}}}):$(".defaultvalue-date-container .defaultvalue-date-value",n.element).will_pickdate({allowEmpty:!0,militaryTime:!0,inputOutputFormat:"m/d/Y",format:"m/d/Y",onSelect:function(e){e=$.datepicker.formatDate("mm/dd/yy",e),i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:{fixedvalue:e},data:{fixedvalue:e},type:t.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},n.exclusive&&$.extend(i,{exclusive:!0}),n.controller.publish("propertyEditorChanged",i),n.inputValue={fixedvalue:e}}});break;case"number":var r,a=!0===t["editor-parameters"].allowdecimals.value?"defaultvalue-allowdecimals":"defaultvalue-not-allowdecimals";$.extend(t,{allowDecimals:a}),this.renderDefaultNumber(e,t),!0===t["editor-parameters"].allowdecimals.value?(r=/(^$)|(^-?(0|[1-9][0-9]*)\.[0-9]+$)/,n.Error+=bizagi.localization.getResource("formmodeler-component-editor-int-error-decimal")):(r=/(^$)|(^-?(0|[1-9][0-9]*)$)/,n.Error+=bizagi.localization.getResource("formmodeler-component-editor-int-error-integer")),$(".defaultvalue-number-container .defaultvalue-number-value",n.element).keydown(function(e){13==e.keyCode&&(r.test($(this).val())?(n.hideError($(this)),i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:{fixedvalue:$(this).val()},data:{fixedvalue:$(this).val()},type:t.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},n.exclusive&&$.extend(i,{exclusive:!0}),n.controller.publish("propertyEditorChanged",i),n.inputValue={fixedvalue:$(this).val()}):(n.showError($(this),n.Error),$(this).select()))}),$(".defaultvalue-number-container .defaultvalue-number-value",n.element).blur(function(e){r.test($(this).val())?(n.hideError($(this)),i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:{fixedvalue:$(this).val()},data:{fixedvalue:$(this).val()},type:t.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},n.exclusive&&$.extend(i,{exclusive:!0}),n.controller.publish("propertyEditorChanged",i),n.inputValue={fixedvalue:$(this).val()}):(n.showError($(this),n.Error),$(this).select())});break;case"string":this.renderDefaultString(e,t),$(".defaultvalue-string-value",n.element).keydown(function(e){13==e.keyCode&&(i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:{fixedvalue:$(this).val()},data:{fixedvalue:$(this).val()},type:t.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},n.exclusive&&$.extend(i,{exclusive:!0}),n.controller.publish("propertyEditorChanged",i),n.inputValue={fixedvalue:$(this).val()})}),$(".defaultvalue-string-value",n.element).blur(function(e){i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:{fixedvalue:$(this).val()},data:{fixedvalue:$(this).val()},type:t.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},n.exclusive&&$.extend(i,{exclusive:!0}),n.controller.publish("propertyEditorChanged",i),n.inputValue={fixedvalue:$(this).val()}});break;case"boolean":void 0!==t.value.fixedvalue&&null!==t.value.fixedvalue||(t.value.fixedvalue="");var s,l="",d="";""===t.value.fixedvalue?s="none":(s=t.value,!0===t.value.fixedvalue||"true"==t.value.fixedvalue?l=" selected":d=" selected"),this.renderDefaultBoolean(e,$.extend(t,{booleanState:s.fixedvalue,selectedYes:l,selectedNo:d})),""!==t.value.fixedvalue&&e.find(".defaultvalue-boolean-value").addClass("active"),$(".defaultvalue-boolean-value > .defaultvalue-boolean-button",n.element).click(function(){i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,type:t.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},$(".defaultvalue-boolean-value > .defaultvalue-boolean-button",n.element).removeClass("selected"),$(this).addClass("selected"),$(this).hasClass("defaultvalue-boolean-button-yes")?($.extend(i,{newValue:{fixedvalue:!0},data:{fixedvalue:!0}}),n.inputValue={fixedvalue:!0}):($.extend(i,{newValue:{fixedvalue:!1},data:{fixedvalue:!1}}),n.inputValue={fixedvalue:!1}),n.exclusive&&$.extend(i,{exclusive:!0}),n.controller.publish("propertyEditorChanged",i)});break;case"rule":this.renderDefaultRule(e,t)}},renderDefaultDate:function(e,t){(this.state?$.tmpl(this.getTemplate("frame-date-fixed"),t):this.renderRule(t)).appendTo(e)},renderDefaultNumber:function(e,t){(this.state?$.tmpl(this.getTemplate("frame-number-fixed"),t):this.renderRule(t)).appendTo(e)},renderDefaultString:function(e,t){(this.state?$.tmpl(this.getTemplate("frame-string-fixed"),t):this.renderRule(t)).appendTo(e)},renderDefaultBoolean:function(e,t){(this.state?$.tmpl(this.getTemplate("frame-boolean-fixed"),t):this.renderRule(t)).appendTo(e)},renderDefaultRule:function(e,t){(this.state?$.tmpl(this.getTemplate("frame-onlyrule"),t):this.renderRule(t)).appendTo(e)},renderRule:function(e){var t=this.getRuleValue(e.value);return void 0!==t.displayName&&""!=t.displayName?$.extend(e,{nameRule:t.displayName}):$.extend(e,{nameRule:bizagi.localization.getResource("formmodeler-component-editor-defaultvalue-rule")}),$.tmpl(this.getTemplate("frame-rule"),e)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.defaultvalue").concat("#defaultvalue-frame")),this.loadTemplate("frame-date-fixed",bizagi.getTemplate("bizagi.editor.component.editor.defaultvalue").concat("#defaultvalue-frame-date-fixed")),this.loadTemplate("frame-number-fixed",bizagi.getTemplate("bizagi.editor.component.editor.defaultvalue").concat("#defaultvalue-frame-number-fixed")),this.loadTemplate("frame-string-fixed",bizagi.getTemplate("bizagi.editor.component.editor.defaultvalue").concat("#defaultvalue-frame-string-fixed")),this.loadTemplate("frame-boolean-fixed",bizagi.getTemplate("bizagi.editor.component.editor.defaultvalue").concat("#defaultvalue-frame-boolean-fixed")),this.loadTemplate("frame-rule",bizagi.getTemplate("bizagi.editor.component.editor.defaultvalue").concat("#defaultvalue-frame-rule")),this.loadTemplate("frame-onlyrule",bizagi.getTemplate("bizagi.editor.component.editor.defaultvalue").concat("#defaultvalue-frame-onlyrule"))).done(function(){e.resolve()}),e.promise()},editCreateRule:function(e,t){var i,n,o=this;i=""!=o.options.value.fixedvalue?{fixedvalue:o.options.value.fixedvalue}:o.isEmptyRule(o.options.value)?{fixedvalue:""}:o.options.value,(void 0===o.options.value||null===o.options.value||o.options.value.fixedvalue)&&(o.options.value={rule:{baref:{ref:"expression"}}}),n={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_EXPRESSION,oldValue:i,type:o.options.name,data:o.options.value,id:o.element.closest(".bizagi_editor_component_properties").data("id"),categorytype:"Scripting"},o.exclusive&&$.extend(n,{exclusive:!0}),o.controller.publish("propertyEditorChanged",n),o.inputValue=o.options.value},isEmptyRule:function(e){var t=this.getRuleValue(e);return!t||"expression"===t.baref.ref},getRuleValue:function(e){return e.rule||e.rule90},"i.defaultvalue-rule-external click":function(e,t){this.editCreateRule(e,t)},".defaultvalue-rule-value .defaultvalue-image-rule-delete click":function(e,t){var i,n=this;i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:void 0,data:void 0,type:n.options.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},n.exclusive&&$.extend(i,{exclusive:!0}),n.controller.publish("propertyEditorChanged",i),n.element.find(".defaultvalue-container div").empty(),n.options.value={fixedvalue:"",rule:{baref:{ref:"expression"}}},n.state=!0,n.renderTypeEditor(n.element.find(".defaultvalue-container"),n.options)},".defaultvalue-image-fixed-delete click":function(e,t){var i;this.element.find("input").length>0?this.element.find("input").val(""):this.element.find(".defaultvalue-boolean-value").removeClass("active"),i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:void 0,data:void 0,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.exclusive&&$.extend(i,{exclusive:!0}),this.controller.publish("propertyEditorChanged",i)},".biz-complex-btn.defaultvalue-button-value click":function(e,t){var i=$(".defaultvalue-"+this.type+"-value",this.element);i.length>0?(i.addClass("active"),i.focus()):this.editCreateRule(e,t)},".biz-ico.defaultvalue-image-edit click":function(e,t){var i;(i="rule"===this.type?[]:$(".defaultvalue-"+this.type+"-value",this.element)).length>0?(i.addClass("active"),i.focus()):this.editCreateRule(e,t)},".defaultvalue-rule-value .defaultvalue-button-value click":function(e,t){"rule"===this.type&&this.editCreateRule(e,t)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.filterexpression",{defaultRule:{rule:{baref:{ref:"expression"}}},defaultFilter:{bafilter:{filter:"filter"}}},{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){this.properties={},this.findSubproperties(t),this.inputValue=t.value;var i=this.getCurrentType(t.value),n={caption:t.caption,currentType:i.replace(/\ /g,"&nbsp;")};$.extend(n,this.properties),$.tmpl(this.getTemplate("frame"),n).appendTo(e)},isRule:function(){return!!this.inputValue&&!!this.inputValue.rule},isFilter:function(){return!!this.inputValue&&!!this.inputValue.bafilter},getCurrentType:function(e){var t=bizagi.localization.getResource("formmodeler-component-filterexpression-empty");return this.isRule()?t=null!=e.rule&&e.rule.displayName?e.rule.displayName:bizagi.localization.getResource("formmodeler-component-filterexpression-rule"):this.isFilter()&&(t=bizagi.localization.getResource("formmodeler-component-filterexpression-filter")),t},findSubproperties:function(e){if(e.subproperties&&$.isArray(e.subproperties))for(var t=0,i=e.subproperties.length;t<i;t++){var n=e.subproperties[t].property;this.properties[n["bas-type"]]=!0}},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.filterexpression").concat("#filterexpression-frame"))).done(function(){e.resolve()}),e.promise()},editCreateRule:function(){var e=this.Class.defaultRule;this.isRule()&&(e=this.inputValue);var t={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_EXPRESSION,type:this.options.name,data:e,context:"rule",id:this.element.closest(".bizagi_editor_component_properties").data("id"),categorytype:"Scripting"};this.controller.publish("propertyEditorChanged",t)},editCreateFilter:function(){var e=this.Class.defaultFilter;this.isFilter()&&(e=this.inputValue);var t={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_EDITOR_DATALIST,data:e,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};this.controller.publish("propertyEditorChanged",t)},deleteValue:function(){if(this.inputValue){var e={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:void 0,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};this.controller.publish("propertyEditorChanged",e)}},"i.filterexpression-rule-external click":function(){this.editCreateRule()},"i.filterexpression-filter-external click":function(){this.editCreateFilter()},"i.filterexpression-delete-filter click":function(){this.deleteValue()},"input.filterexpression-string-value click":function(){this.inputValue&&(this.isRule()?this.editCreateRule():this.isFilter()&&this.editCreateFilter())}}),bizagi.editor.component.editor("bizagi.editor.component.editor.textformat",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r=this,a=t.subproperties.length;for(r.values={},r.palette=[["transparent"],["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646"],["f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada"],["d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5"],["bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f"],["a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09"],["7f7f7f","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806"],["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"]],i=$.tmpl(r.getTemplate("frame"),t),n=0;n<a;n++)r.values[t.subproperties[n].property.name]=t.subproperties[n].property.value,r.renderSubproperty(i,t.subproperties[n].property);if(r.initialValues=bizagi.clone(r.values),i.appendTo(e),r.setFontSize(t.subproperties),o=r.retrieveValueFontSize(t.subproperties),bizagi.util.isEmpty(o))r.refFontSize=parseInt($(".textformat-preview",this.element).css("font-size"));else{if(!/^(\+[1-9][0-9]*|0|-[1-9][0-9]*)$/.test(o))throw"FontSize value error.";r.refFontSize=r.calculateFontSize(o)}},closeSp:function(e,t){var i=$(t.target),n=$(".sp-container",$("body"));0===i.closest(n).length&&(e.spectrum("hide"),$(document).unbind("mousedown.closesp"))},setFontSize:function(e){var t,i,n,o;for(t=0;t<e.length;t++){if("size"==e[t].property.name.split(".").pop()){null==(i=e[t].property.value)?i="0":/^(\+[1-9][0-9]*|0|-[1-9][0-9]*)$/.test(i)&&(n=$(".textformat-preview",this.element),"0"!=i&&(o=parseInt(i.toString().substr(1)),this.registerCallback(function(){/^\+.*$/.test(i)?n.css({"font-size":parseInt(n.css("font-size"))+o+"px"}):n.css({"font-size":parseInt(n.css("font-size"))-o+"px"})}))),$(".textformat-size-value",this.element).text(i);break}}},calculateFontSize:function(e){var t,i,n=parseInt($(".textformat-preview",this.element).css("font-size"));return"0"==e?t=n:(i=parseInt(e.toString().substr(1)),t=/^\+.*$/.test(e)?n-i:n+i),t},retrieveValueFontSize:function(e){var t,i=null;for(t=0;t<e.length;t++){if("size"==e[t].property.name.split(".").pop()){i=e[t].property.value;break}}return i},renderSubproperty:function(e,t){var i,n=this,o=$(".textformat-preview",e);switch(t.name.split(".").pop()){case"bold":""==(i=null===t.value?"":!0===t.value||"true"==t.value?" selected":"")?o.removeClass("bold"):o.addClass("bold"),$.tmpl(this.getTemplate("bold"),{selected:i,property:this.options.name}).appendTo(e.find(".textformat-actions"));break;case"italic":""==(i=null===t.value?"":!0===t.value||"true"==t.value?" selected":"")?o.removeClass("italic"):o.addClass("italic"),$.tmpl(this.getTemplate("italic"),{selected:i,property:this.options.name}).appendTo(e.find(".textformat-actions"));break;case"underline":""==(i=null===t.value?"":!0===t.value||"true"==t.value?" selected":"")?o.removeClass("underline"):o.addClass("underline"),$.tmpl(this.getTemplate("underline"),{selected:i,property:this.options.name}).appendTo(e.find(".textformat-actions"));break;case"strikethru":""==(i=null===t.value?"":!0===t.value||"true"==t.value?" selected":"")?o.removeClass("strikeout"):o.addClass("strikeout"),$.tmpl(this.getTemplate("strikeout"),{selected:i,property:this.options.name}).appendTo(e.find(".textformat-actions"));break;case"color":$.tmpl(this.getTemplate("font"),{property:this.options.name}).appendTo(e.find(".textformat-actions")),t.value&&(t.value=t.value.toLowerCase(),o.css({color:t.value})),$("input.textformat-image-font",e).spectrum({color:t.value,showPaletteOnly:!0,palette:n.palette,change:function(i){var o;o="rgba(0, 0, 0, 0)"===i.toRgbString()?"":i.toHexString(),$(".textformat-preview",e).css({color:o}),n.changeProperty(t.name,o)},beforeShow:function(t){return $(document).bind("mousedown.closesp",function(t){n.closeSp($("input.textformat-image-font",e),t)}),!0}}),$(".sp-preview",e).addClass("biz-ico bz-studio bz-format-text-letter-a_16x16_standard"),$(".sp-replacer",e).find(".sp-dd").remove();break;case"background":$.tmpl(this.getTemplate("background"),{property:this.options.name}).appendTo(e.find(".textformat-actions")),t.value?(t.value=t.value.toLowerCase(),o.css({"background-color":t.value})):(t.value="transparent",o.css({"background-color":"transparent"})),$("input.textformat-image-background",e).spectrum({color:t.value,showPaletteOnly:!0,preferredFormat:"rgb",palette:n.palette,change:function(i){var o;o="rgba(0, 0, 0, 0)"===i.toRgbString()?"":i.toHexString(),$(".textformat-preview",e).css({"background-color":o}),n.changeProperty(t.name,o)},beforeShow:function(t){return $(document).bind("mousedown.closesp",function(t){n.closeSp($("input.textformat-image-background",e),t)}),!0}}),$(".sp-preview",e).addClass("biz-ico bz-studio bz-format-text-color-background_16x16_standard"),$(".sp-replacer",e).find(".sp-dd").remove();break;case"size":$.tmpl(this.getTemplate("size"),{property:this.options.name}).appendTo(e.find(".textformat-actions"))}},resetSubproperty:function(e){var t=$(".textformat-preview",this.element);switch(e.split(".").pop()){case"bold":$(".textformat-actions .textformat-image-bold").removeClass("selected"),t.removeClass("bold");break;case"italic":$(".textformat-actions .textformat-image-italic").removeClass("selected"),t.removeClass("italic");break;case"underline":$(".textformat-actions .textformat-image-underline").removeClass("selected"),t.removeClass("underline");break;case"strikethru":$(".textformat-actions .textformat-image-strikeout").removeClass("selected"),t.removeClass("strikeout");break;case"color":$("input.textformat-image-font",this.element).spectrum("set","black"),t.css("color","black");break;case"background":$("input.textformat-image-background",this.element).spectrum("set",""),t.css("background-color","");break;case"size":t.css("font-size",this.refFontSize+"px"),$(".textformat-size-value",this.element).text("0")}},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.textformat").concat("#textformat-frame")),this.loadTemplate("bold",bizagi.getTemplate("bizagi.editor.component.editor.textformat").concat("#textformat-frame-bold")),this.loadTemplate("italic",bizagi.getTemplate("bizagi.editor.component.editor.textformat").concat("#textformat-frame-italic")),this.loadTemplate("underline",bizagi.getTemplate("bizagi.editor.component.editor.textformat").concat("#textformat-frame-underline")),this.loadTemplate("strikeout",bizagi.getTemplate("bizagi.editor.component.editor.textformat").concat("#textformat-frame-strikeout")),this.loadTemplate("font",bizagi.getTemplate("bizagi.editor.component.editor.textformat").concat("#textformat-frame-font")),this.loadTemplate("background",bizagi.getTemplate("bizagi.editor.component.editor.textformat").concat("#textformat-frame-background")),this.loadTemplate("size",bizagi.getTemplate("bizagi.editor.component.editor.textformat").concat("#textformat-frame-size"))).done(function(){e.resolve()}),e.promise()},changeProperty:function(e,t){var i;this.values[e]=t,i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.initialValues[e],newValue:t,type:e,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.controller.publish("propertyEditorChanged",i)},publishReset:function(){var e,t=$(".textformat-preview",this.element);$(".textformat-actions .textformat-image-bold").removeClass("selected"),t.removeClass("bold"),$(".textformat-actions .textformat-image-italic").removeClass("selected"),t.removeClass("italic"),$(".textformat-actions .textformat-image-strikeout").removeClass("selected"),t.removeClass("strikeout"),$(".textformat-actions .textformat-image-underline").removeClass("selected"),t.removeClass("underline"),$("input.textformat-image-background",this.element).spectrum("set",""),t.css("background-color",""),$("input.textformat-image-font",this.element).spectrum("set","black"),t.css("color","black"),t.css("font-size","17px"),$(".textformat-size-value",this.element).text("0"),e={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.initialValues,newValue:this.initialValues,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.controller.publish("propertyEditorChanged",e)},".textformat-actions i.textformat-primary-control click":function(e){var t=e.data("preview-style"),i=e.data("property");e.toggleClass("selected"),$(".textformat-preview",this.element).toggleClass(t),this.changeProperty(i,!this.values[i])},".textformat-actions i.textformat-tertiary-control click":function(e){var t,i=$(".textformat-preview",this.element),n=$(".textformat-size-value",this.element),o=e.data("property"),r=!0;e.hasClass("textformat-image-size-plus")?(t=parseInt(n.text()),++t<=20?(i.css({"font-size":parseInt(i.css("font-size"))+1+"px"}),n.text(t>0?"+"+t:t)):r=!1):(t=parseInt(n.text()),--t>=-9?(i.css({"font-size":parseInt(i.css("font-size"))-1+"px"}),n.text(t>0?"+"+t:t)):r=!1),r&&this.changeProperty(o,t>0?"+"+t:t)},".textformat-image-reset click":function(){this.publishReset()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.xpath",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r=this;switch(r.map=r.retrieveMapSubproperties(t.subproperties),r.xpathValue=n=bizagi.editor.utilities.getXpathObject(t.value),r.propertiesNames=r.getSubpropertiesNames(t.subproperties,r.map),t.readonly=r.options["editor-parameters"].readonly||!1,t.value=void 0===n?{baxpath:{xpath:""}}:null===n?{baxpath:{xpath:""}}:n,r.inputValue=t.value,t["bas-type"]){case"xpathfromentity":typeof t.subproperties[0].property.value!=typeof t.value&&(t.value.baxpath.xpath=""),r.renderXpathFromEntity(e,t);break;case"xpathtosimple":r.renderXpathToSimple(e,t);break;case"xpathtoentity":r.renderXpathToEntity(e,t);break;case"xpathtocollection":case"xpathtoentitytemplate":r.renderXpathToCollection(e,t);break;case"xpath":r.renderXpath(e,t);break;default:(i=$.tmpl(r.getTemplate("frame"),t)).appendTo(e),o=$("label",i),r.addRequired(o)}""==t.value.baxpath.xpath&&(t.value.baxpath.xpath="xpath")},getSubpropertiesNames:function(e,t){var i,n={};if(!e)return n;for(var o=0;o<e.length;o++)n[(i=e[o].property).name.split(".")[1]]=i.name;return n},retrieveMapSubproperties:function(e){var t,i={};if(!e)return i;for(t=0;t<e.length;t++)i[e[t].property.name]=t;return i},renderXpath:function(e,t){var i,n;(i=$.tmpl(this.getTemplate("xpath"),t)).appendTo(e),n=$("label",i),this.addRequired(n)},renderXpathToCollection:function(e,t){var i,n;(i=$.tmpl(this.getTemplate("xpathtocollection"),t)).appendTo(e),n=$("label",i),this.addRequired(n)},renderXpathToEntity:function(e,t){var i,n;(i=$.tmpl(this.getTemplate("xpathtoentity"),t)).appendTo(e),n=$("label",i),this.addRequired(n)},renderXpathToSimple:function(e,t){var i,n;(i=$.tmpl(this.getTemplate("xpathtosimple"),t)).appendTo(e),n=$("label",i),this.addRequired(n)},renderXpathFromEntity:function(e,t){var i,n;(i=$.tmpl(this.getTemplate("xpathfromentity"),t)).appendTo(e),n=$("label",i),this.addRequired(n)},remove:function(){this.element.hide(),this.element.empty()},positionXpathDialog:function(e){var t=e.offset();return{top:t.top+e.outerHeight(!0),left:t.left}},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.xpath").concat("#xpath-frame")),this.loadTemplate("xpathfromentity",bizagi.getTemplate("bizagi.editor.component.editor.xpath").concat("#xpath-xpathfromentity")),this.loadTemplate("xpathtosimple",bizagi.getTemplate("bizagi.editor.component.editor.xpath").concat("#xpath-xpathtosimple")),this.loadTemplate("xpathtoentity",bizagi.getTemplate("bizagi.editor.component.editor.xpath").concat("#xpath-xpathtoentity")),this.loadTemplate("xpathtocollection",bizagi.getTemplate("bizagi.editor.component.editor.xpath").concat("#xpath-xpathtocollection")),this.loadTemplate("xpath",bizagi.getTemplate("bizagi.editor.component.editor.xpath").concat("#xpath"))).done(function(){e.resolve()}),e.promise()},".xpath.xpath-image-world click":function(e,t){var i=this,n=i.element.find(".xpath-value"),o=i.positionXpathDialog(n),r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_XPATH,oldValue:i.inputValue,position:o,type:i.options.name,subproperties:i.propertiesNames,xpathValue:i.options.value,editor:i,editorParameters:i.options["editor-parameters"],id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.controller.publish("propertyEditorChanged",r)},".xpath-from-entity.xpath-image-world click":function(e,t){var i=this,n=i.element.find(".xpath-value"),o=i.positionXpathDialog(n),r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_XPATH_FROM_ENTITY,oldValue:i.inputValue,position:o,type:i.options.name,subproperties:i.propertiesNames,xpathValue:i.options.value,typeEditor:i.options["bas-type"],editor:i,editorParameters:i.options["editor-parameters"],id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.controller.publish("propertyEditorChanged",r)},".xpath-to-simple.xpath-image-world click":function(e,t){var i=this,n=i.element.find(".xpath-value"),o=i.positionXpathDialog(n),r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_XPATH_TO_SIMPLE,oldValue:i.inputValue,position:o,type:i.options.name,subproperties:i.propertiesNames,xpathValue:i.options.value,typeEditor:i.options["bas-type"],editorParameters:i.options["editor-parameters"],id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.options.hasOwnProperty("exclusive")&&(r=$.extend({},r,{exclusive:i.options.exclusive})),i.controller.publish("propertyEditorChanged",r)},".xpath-to-entity.xpath-image-world click":function(e,t){var i=this.element.find(".xpath-value"),n=this.positionXpathDialog(i),o=this.element.closest(".bizagi_editor_component_properties").data("id");this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_XPATH_TO_ENTITY,oldValue:this.inputValue,position:n,type:this.options.name,subproperties:this.propertiesNames,xpathValue:this.options.value,typeEditor:this.options["bas-type"],id:o})},".xpath-to-collection.xpath-image-world click":function(e,t){var i=this,n=i.element.find(".xpath-value"),o=i.positionXpathDialog(n);i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_XPATH_TO_COLLECTION,oldValue:i.inputValue,position:o,type:i.options.name,subproperties:i.propertiesNames,xpathValue:i.options.value,typeEditor:i.options["bas-type"],context:i.model["editor-parameters"]&&null!=i.model["editor-parameters"].context?i.model["editor-parameters"].context:null,id:i.element.closest(".bizagi_editor_component_properties").data("id")})},".biz-ico-default click":function(e,t){var i=this,n=i.element.find(".xpath-value"),o=(i.positionXpathDialog(n),!1),r={xpath:{},relatedentity:{}};if(i.options.subproperties)for(var a=0;a<i.model.subproperties.length;a++){if(i.options.subproperties[a].property)if(o=i.options.subproperties[a].property.default)"xpath"==i.options.subproperties[a].property.name.replace("xpath.","")?r.xpath=o:r.relatedentity=o}o||(r=void 0);var s={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:r,data:r,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};i.controller.publish("propertyEditorChanged",s),i.element.empty(),i.options.value=r,i.renderEditor(this.element,i.options)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.editor.xpath.presenter",{},{init:function(e,t){this._super(),this.canvas=e,this.model=t,this.create()},create:function(){this.xpathEditorNavigator=new bizagi.editor.component.xpathnavigator(this.canvas,this.model,this)},render:function(e,t){this.model=void 0!==e?e:this.model,this.xpathEditorNavigator.updateModel(this.model),this.xpathEditorNavigator.render(t)},showXpath:function(e){return this.xpathEditorNavigator.showXpath(e)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.xpathmultiple",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r=this;r.map=r.retrieveMapSubproperties(t.subproperties),r.xpathValue=n=t.value||[],r.propertiesNames=r.getSubpropertiesNames(t.subproperties,r.map),t.hasXpaths=!!(t.value&&t.value.length>0),t.readonly=r.options["editor-parameters"].readonly||!1,r.inputValue=t.value,0==n.length&&(t.value={baxpath:{xpath:""}}),(i=$.tmpl(r.getTemplate("xpathframe"),t)).appendTo(e),o=$("label",i),r.addRequired(o)},getSubpropertiesNames:function(e,t){var i,n={};if(!e)return n;for(var o=0;o<e.length;o++)n[(i=e[o].property).name.split(".")[1]]=i.name;return n},retrieveMapSubproperties:function(e){var t,i={};if(!e)return i;for(t=0;t<e.length;t++)i[e[t].property.name]=t;return i},remove:function(){this.element.hide(),this.element.empty()},positionXpathDialog:function(e){var t=e.offset();return{top:t.top+e.outerHeight(!0),left:t.left}},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("xpathframe",bizagi.getTemplate("bizagi.editor.component.editor.xpathmultiple").concat("#xpathmultiple-xpathframe"))).done(function(){e.resolve()}),e.promise()},".xpath-select click":function(e,t){var i=this,n=i.element.find(".fileprint-item-container"),o=i.positionXpathDialog(n),r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_XPATH_MULTIPLE,oldValue:i.inputValue,position:o,type:i.options.name,subproperties:i.propertiesNames,xpathValue:i.options.value,typeEditor:i.options["bas-type"],editorParameters:i.options["editor-parameters"],id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.options.hasOwnProperty("exclusive")&&(r=$.extend({},r,{exclusive:i.options.exclusive})),i.controller.publish("propertyEditorChanged",r)},".biz-ico-default click":function(e,t){var i=this,n=i.element.find(".fileprint-item-container"),o=(i.positionXpathDialog(n),!1),r={xpath:{},relatedentity:{}};if(i.options.subproperties)for(var a=0;a<i.model.subproperties.length;a++){if(i.options.subproperties[a].property)if(o=i.options.subproperties[a].property.default)"xpath"==i.options.subproperties[a].property.name.replace("xpath.","")?r.xpath=o:r.relatedentity=o}o||(r=void 0);var s={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:r,data:r,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};i.controller.publish("propertyEditorChanged",s),i.element.empty(),i.options.value=r,i.renderEditor(this.element,i.options)},".interface-image-rule-delete click":function(e,t){var i=this.inputValue,n=e[0].id;n=Number(n.substring(7,8)),i.splice(n,1),0==i.length&&(i=void 0);var o=this.element.find(".fileprint-item-container"),r=(this.positionXpathDialog(o),{xpath:{},relatedentity:{}});r=void 0;var a={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:i,data:r,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};this.controller.publish("propertyEditorChanged",a),this.element.empty(),this.options.value=i,this.renderEditor(this.element,this.options)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.tags",{init:function(e,t,i){this._super(e,t,i)},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("tagsFrame",bizagi.getTemplate("bizagi.editor.component.editor.tags").concat("#tags-tagsframe"))).done(function(){e.resolve()}),e.promise()},renderEditor:function(e,t){var i=this,n=t["editor-parameters"]||{};$.when(n.tags).done(function(n){(n=n||[],i.value=t.value?t.value:[],t.hasValue=i.value.length>0,t.arethereTags=n.length>0,t.hasValue||t.arethereTags)&&(i.container=e,t.tagsSelected=i.value.map(function(e){return{key:e,value:e}}),t.tags=n,$.tmpl(i.getTemplate("tagsFrame"),t).appendTo(e))})},isNewValue:function(e){var t=!0,i=this.value.length;if(0==i)return t;for(var n=0;n<i;n++){var o=this.value[n];if((o.id||o)==e){t=!1;break}}return t},getTagsSelected:function(e){var t=this.value.length,i=[];if(0==t)return i;for(var n=0;n<t;n++)for(var o=this.value[n].id||this.value[n],r=0,a=e.length;r<a;r++){var s=e[r];s.key==o&&i.push(s)}return i},updateProperty:function(){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:this.value,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})},showValues:function(e,t){var i=this;$(document).bind("mouseup.tags",function(n){1==n.which&&(0===i.element.has(n.target).length&&(i.hideValues(e,t),$(document).unbind("mouseup.tags")))}),t.slideDown(function(){$(this).addClass("tags-values-open")}),e.addClass("tags-values-open")},refresh:function(e){var t=this.element.find("#tag-values");this.hideValues(e,t),this.container.empty(),this.renderEditor(this.container,this.options)},hideValues:function(e,t){t.slideUp(function(){$(this).removeClass("tags-values-open")}),e.removeClass("tags-values-open")},".tag-select click":function(e,t){var i=this.element.find("#tag-values");t.stopPropagation(),e.hasClass("tags-values-open")?this.hideValues(e,i):this.showValues(e,i)},".tag-item.tag-value click":function(e,t){var i=e.data("key");this.isNewValue(i)&&(this.value.push(e.data("key")),this.options.value=this.value,this.updateProperty()),this.refresh(e)},".item-image-delete-tag click":function(e){var t=e.data("id");this.value.splice(t,1),this.updateProperty(),this.refresh(e)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.stakeholders",{init:function(e,t,i){this._super(e,t,i)},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("stakeholdersFrame",bizagi.getTemplate("bizagi.editor.component.editor.stakeholders").concat("#stakeholders-stakeholdersframe"))).done(function(){e.resolve()}),e.promise()},renderEditor:function(e,t){var i=this,n=(t["editor-parameters"]||{}).stakeholders;$.when(n).done(function(n){i.value=t.value?t.value:[],t.hasValue=i.value.length>0,i.container=e,i.updateProperty(),t.stakeholdersSelected=i.getStakeholdersSelected(n),t.stakeholders=n,$.tmpl(i.getTemplate("stakeholdersFrame"),t).appendTo(e)})},isNewValue:function(e){var t=!0;if(l=this.value.length,0==l)return t;for(var i=0;i<l;i++){if(this.value[i]===e){t=!1;break}}return t},getStakeholdersSelected:function(e){var t=this;return(e=e||[]).reduce(function(e,i){return t.value.includes(i.guid)&&e.push(i),e},[])},refresh:function(e){var t=this.element.find("#stakeholder-values");this.hideValues(e,t),this.container.empty(),this.renderEditor(this.container,this.options)},updateProperty:function(){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:this.value,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})},showValues:function(e,t){var i=this;$(document).bind("mouseup.stakeholders",function(n){1==n.which&&(0===i.element.has(n.target).length&&(i.hideValues(e,t),$(document).unbind("mouseup.stakeholders")))}),t.slideDown(function(){$(this).addClass("stakeholders-values-open")}),e.addClass("stakeholders-values-open")},hideValues:function(e,t){t.slideUp(function(){$(this).removeClass("stakeholders-values-open")}),e.removeClass("stakeholders-values-open")},".stakeholder-select click":function(e,t){t.stopPropagation();var i=this.element.find("#stakeholder-values");e.hasClass("stakeholders-values-open")?this.hideValues(e,i):this.showValues(e,i)},".stakeholder-item.stakeholder-value click":function(e,t){var i=e.data("guid");this.isNewValue(i)&&(this.value.push(e.data("guid")),this.options.value=this.value,this.updateProperty()),this.refresh(e)},".item-image-delete-stakeholder click":function(e){var t=e.data("id");this.value.splice(t,1),this.updateProperty(),this.refresh(e)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.resizer",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o="auto",r=this.model.value,a=t["editor-parameters"];this.editorParameters=a,(i=$.tmpl(this.getTemplate("horizontalResize"),t)).appendTo(e),"auto"!=r&&(n=parseInt(r).toString(),o=r.substring(n.length,r.length),i.find("#resizeWidth").val(r)),a.isWidthColumnEditable||(i.find("#resizeWidth").attr("readonly",!0),this.Error=bizagi.localization.getResource("formmodeler-component-editor-resizer-error-editable"),this.showErrorMessage(i.find("#resizeWidth"),this.Error),setTimeout(function(){$("#bizagi_editor_validator_container-columnwidth").css("top",25)},100)),this.widthValue=n,this.measureType=o},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("horizontalResize",bizagi.getTemplate("bizagi.editor.component.editor.resizer").concat("#resizer-horizontal"))).done(function(){e.resolve()}),e.promise()},changeSize:function(e){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:e,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})},validateSize:function(e,t){var i=this,n=parseInt(t).toString();if("auto"==t||""==t)return!0;if(isNaN(n))return i.Error=bizagi.localization.getResource("formmodeler-component-editor-resizer-error-format"),i.showErrorMessage(e,i.Error),!1;var o=t.substring(n.length,t.length);return"px"!=o&&"%"!=o?(i.Error=bizagi.localization.getResource("formmodeler-component-editor-resizer-error-format"),i.showErrorMessage(e,i.Error),!1):Number(n)<1&&"px"==o?(i.Error=bizagi.localization.getResource("formmodeler-component-editor-resizer-error-minimum"),i.showErrorMessage(e,i.Error),!1):Number(n)>100&&"%"==o?(i.Error=bizagi.localization.getResource("formmodeler-component-editor-resizer-error-percent"),i.showErrorMessage(e,i.Error),!1):!("%"==o&&Number(n)>i.editorParameters.percentMaxWidth)||(i.Error=bizagi.localization.getResource("formmodeler-component-editor-resizer-error-percent-available"),"string"==typeof i.Error?i.Error=i.Error.replace("{0}",i.editorParameters.percentMaxWidth):caption="",i.showErrorMessage(e,i.Error),!1)},showErrorMessage:function(e,t){var i=$(e);i.hasClass("error")||i.addClass("error"),this.showError(e,t),i.select()},applyColumnWidth:function(e,t){var i=$(e).val(),n=(this.model.value.width,""==i?"auto":i);this.validateSize(e,i)?this.changeSize(n):i="",$("#resizeWidth").val(i)},"input blur":function(e,t){this.applyColumnWidth(e,t)},"input keydown":function(e,t){13==event.keyCode&&this.applyColumnWidth(e,t)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.filter",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n;t.value?t.value.hasOwnProperty("bafilter")||(t.value={bafilter:{filter:bizagi.localization.getResource("formmodeler-component-editor-all-metadata-error"),contextentity:"",scopedefinition:""}}):t.value={bafilter:{filter:""}},this.inputValue=t.value,(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),""==t.value.bafilter.filter&&(t.value.bafilter.filter="filter"),n=$("label",i),this.addRequired(n)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.filter").concat("#filter-frame"))).done(function(){e.resolve()}),e.promise()},".biz-ico-filter-value click":function(e,t){var i;i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_EDITOR_DATALIST,data:this.inputValue,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.controller.publish("propertyEditorChanged",i)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.interface",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n;void 0===t.value?t.value={baref:{ref:bizagi.localization.getResource("formmodeler-component-editor-interface-expression")}}:null===t.value&&(t.value={baref:{ref:bizagi.localization.getResource("formmodeler-component-editor-interface-expression")}}),this.inputValue=t.value,n=t.name.replace(/\./gi,"-"),t.title=bizagi.localization.getResource("formmodeler-component-editor-rule-validation-"+n),t.title==="formmodeler-component-editor-rule-validation-"+n&&(t.title=""),t.value.baref.ref==bizagi.localization.getResource("formmodeler-component-editor-interface-expression")?i=$.tmpl(this.getTemplate("frame-empty"),t):(void 0!==t.value.displayName&&""!=t.value.displayName?$.extend(t,{nameRule:t.value.displayName}):$.extend(t,{nameRule:bizagi.localization.getResource("formmodeler-component-editor-interface-rule")}),i=$.tmpl(this.getTemplate("frame-rule"),t)),i.appendTo(e),$("input.interface-rule-value[title]",i).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip ui-rule-editor-tooltip",position:{my:"left top+10",at:"left bottom"}}),$(".interface-rule-value > .defaultvalue-button-value[title]",i).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip ui-rule-editor-tooltip",position:{my:"left top+10",at:"left bottom"}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame-empty",bizagi.getTemplate("bizagi.editor.component.editor.interface").concat("#interface-frame-empty")),this.loadTemplate("frame-rule",bizagi.getTemplate("bizagi.editor.component.editor.interface").concat("#interface-frame-rule"))).done(function(){e.resolve()}),e.promise()},createEditRule:function(e,t){var i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SHOW_INTERFACE,oldValue:this.inputValue,data:this.options.value,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};this.options.hasOwnProperty("exclusive")&&(i=$.extend({},i,{exclusive:this.options.exclusive})),this.controller.publish("propertyEditorChanged",i)},".interface-rule-value .interface-image-rule-delete click":function(e,t){var i;this.element.find(".interface-container").empty(),this.options.value={baref:{ref:bizagi.localization.getResource("formmodeler-component-editor-interface-expression")}},i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:void 0,data:void 0,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.options.hasOwnProperty("exclusive")&&$.extend(i,{exclusive:this.options.exclusive}),this.controller.publish("propertyEditorChanged",i),this.renderEditor(this.element.find(".interface-container"),this.options)},".interface-rule-value .interface-image-rule-edit click":function(e,t){this.createEditRule(e,t)},".defaultvalue-button-value click":function(e,t){this.createEditRule(e,t)},".biz-ico.interface-image-external click":function(e,t){this.createEditRule(e,t)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.formbase",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r,a,s,l,d,c=this;r=void 0===t.allowNewForm||t.allowNewForm,a=void 0===t.allowNone||t.allowNone,void 0!==t.value&&null!==t.value||(t.value={baref:{ref:""}}),c.getResolvedData(t).then(function(t){c.inputValue=t.value,c.editorParameters=t["editor-parameters"]||{},$.when(t.relatedForms).done(function(u){o=u||[],d=t.name.replace(/\./g,"-").toLowerCase(),t.icon=d,""!=t.value.baref.ref&&(n=c.updateCaption(t.value,o),t.captionForm=n.caption,n.version&&(t.version=n.version)),i=$.tmpl(c.getTemplate("frame"),t);var p=$("label",i);c.addRequired(p),a&&(l=$.tmpl(c.getTemplate("none"),{}),i.find(".form-menu").prepend(l)),r&&(s=$.tmpl(c.getTemplate("newform"),{}),i.find(".form-menu").prepend(s)),o.length>0&&$.each(o,function(e,t){c.renderParents(i.find(".form-submenu"),t)}),i.appendTo(e),$(".form-button-caption[title]",i).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip ui-rule-editor-tooltip",position:{my:"left top+10",at:"left bottom"}})})})},getResolvedData:function(e){var t=this,i=bizagi.editor.base.catalogServices,n=bizagi.editor.utilities.resolveComplexReference(e.value);return new Promise(function(o){""===n?o(e):t.controller.publish("getDeviceInfo").isSpecific?i.getShallowById(n).then(function(t){if(Array.isArray(t)&&t.length>0){var i=t[0];o($.extend({},e,{value:bizagi.editor.utilities.buildComplexReference(i.parentId)}))}else o(e)}):o(e)})},updateCaption:function(e,t){var i,n,o=e.baref.ref,r="",a="",s=!1;for(i=0;i<t.length;i++){if(o==t[i].guid){r=t[i].displayname,a=t[i].version;break}if(t[i].children)for(n=0;n<t[i].children.length;n++)if(o==t[i].children[n].guid){r=t[i].children[n].displayname,a=t[i].children[n].version,s=!0;break}if(s)break}return{caption:r,version:a}},renderParents:function(e,t){var i,n=this;n.parentHasChildren(t)?((i=t.guid==n.inputValue.baref.ref?$.tmpl(n.getTemplate("item-parent-children-checked"),t):$.tmpl(n.getTemplate("item-parent-children-unchecked"),t)).data("info",t),$.each(t.children,function(e,t){n.renderChild(i.find("ul"),t)})):(i=t.guid==n.inputValue.baref.ref?$.tmpl(n.getTemplate("item-parent-no-children-checked"),t):$.tmpl(n.getTemplate("item-parent-no-children-unchecked"),t)).data("info",t),i.appendTo(e)},renderChild:function(e,t){var i;t.icon=this.options.icon,(i=t.guid==this.inputValue.baref.ref?$.tmpl(this.getTemplate("item-child-checked"),t):$.tmpl(this.getTemplate("item-child-unchecked"),t)).data("info",t),i.appendTo(e)},parentHasChildren:function(e){var t=!0;return void 0===e.children?t=!1:null===e.children?t=!1:e.children.length<=0&&(t=!1),t},getDataForms:function(){return[{guid:"GUID-FORM-1",displayname:"Group Form 1",version:"1.0",children:[{guid:"GUID-FORM-1-1",displayname:"Form 1, G1",version:"1.0"},{guid:"GUID-FORM-1-2",displayname:"Form 2, G1",version:"1.5",selected:!0}]},{guid:"GUID-GUID",displayname:"Group Form A",version:"3.141592",children:null},{guid:"GUID-FORM-2",displayname:"Group Form 2",version:"1.0",children:[{guid:"GUID-FORM-2-1",displayname:"Form 1, G2",version:"1.0"}]},{guid:"GUID-FORM-3",displayname:"Group Form 3",version:"1.0",children:[{guid:"GUID-FORM-3-1",displayname:"Form 1, G3",version:"2.0"},{guid:"GUID-FORM-3-2",displayname:"Form 2, G3",version:"1.0"}]}]},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-frame")),this.loadTemplate("newform",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-newform")),this.loadTemplate("none",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-none")),this.loadTemplate("item-unchecked",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-item-unchecked")),this.loadTemplate("item-checked",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-item-checked")),this.loadTemplate("item-parent-no-children-checked",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-item-parent-no-children-checked")),this.loadTemplate("item-parent-no-children-unchecked",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-item-parent-no-children-unchecked")),this.loadTemplate("item-child-unchecked",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-item-child-unchecked")),this.loadTemplate("item-child-checked",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-item-child-checked")),this.loadTemplate("item-parent-children-checked",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-item-parent-children-checked")),this.loadTemplate("item-parent-children-unchecked",bizagi.getTemplate("bizagi.editor.component.editor.form").concat("#form-item-parent-children-unchecked"))).done(function(){e.resolve()}),e.promise()},closeMenu:function(e,t){t.slideUp(function(){$(this).removeClass("form-open")}),e.removeClass("form-open")},openMenu:function(e,t){var i=this;$(document).bind("mouseup.formbase",function(n){1==n.which&&(0===i.element.has(n.target).length&&(i.closeMenu(e,t),$(document).unbind("mouseup.formbase")))}),t.slideDown(function(){$(this).addClass("form-open")}),e.addClass("form-open")},toggleForm:function(e){var t=e.closest(".form-item-expandable").find("ul");t.is(":visible")?(e.addClass("form-image-plus").removeClass("form-image-minus"),t.hide()):(e.addClass("form-image-minus").removeClass("form-image-plus"),t.show())},".form-button-dropdown click":function(e,t){var i=$(".form-menu",this.element);e.hasClass("form-open")?this.closeMenu(e,i):this.openMenu(e,i),t.stopPropagation()},".form-image-minus click":function(e,t){this.toggleForm(e),t.stopPropagation()},".form-image-plus click":function(e,t){this.toggleForm(e),t.stopPropagation()}}),bizagi.editor.component.editor.formbase("bizagi.editor.component.editor.form",{init:function(e,t,i){this._super(e,t,i)},".form-button-caption click":function(e,t){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_BUTTON,value:this.inputValue,propertyName:this.model.name,context:"form",id:this.element.closest(".bizagi_editor_component_properties").data("id")}),$(".form-button-dropdown",this.element).hasClass("form-open")&&$(".form-button-dropdown",this.element).removeClass("form-open"),$(".form-menu",this.element).hasClass("form-open")&&$(".form-menu",this.element).removeClass("form-open"),t.stopPropagation()},".form-newform click":function(e,t){var i,n;this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_NEW,propertyName:this.model.name,context:"form",id:this.element.closest(".bizagi_editor_component_properties").data("id"),showForm:this.editorParameters.showForm}),i=$(".form-button-dropdown",this.element),n=$(".form-menu",this.element),this.closeMenu(i,n),t.stopPropagation()},".form-none click":function(e,t){var i,n;this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_NONE,propertyName:this.model.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),$(".form-button-dropdown",this.element).removeClass("form-open"),i=$(".form-button-dropdown",this.element),n=$(".form-menu",this.element),this.closeMenu(i,n),t.stopPropagation()},".form-submenu li.form-item-selectable click":function(e,t){var i,n,o,r=e.data("info");o={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_OPTION,propertyName:this.model.name,form:r.guid,value:this.inputValue,id:this.element.closest(".bizagi_editor_component_properties").data("id"),showForm:this.editorParameters.showForm},this.controller.publish("propertyEditorChanged",o),this.inputValue={baref:{ref:r.guid}},i=$(".form-button-dropdown",this.element),n=$(".form-menu",this.element),this.closeMenu(i,n),t.stopPropagation()}}),bizagi.editor.observableClass.extend("bizagi.editor.component.editor.form.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas||$("<div />"),this.model=e.model||{},this.formEditor=new bizagi.editor.component.editor.form(this.canvas,this.model,this)},getGuid:function(){return this.model.getGuid()},refresh:function(e){this.gridcolumneditor.refresh(e)},render:function(){this.formEditor.render()},destroy:function(){self.gridcolumneditor.destroy()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.searchformbase",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n,o,r,a,s,l,d,c=this;o=void 0===t.allowNewForm||t.allowNewForm,r=void 0===t.allowNone||t.allowNone,c.values=[],void 0!==t.value&&null!==t.value||(t.value=[]),c.getResolvedData(t).then(function(t){c.values=c.retrieveSelectedValues(t.value),c.inputValue=t.value,$.when(t.relatedForms).done(function(u){n=u||[],"searchforms"==t.name&&(t.icon="searchform-image-form");var p=[];if(0!==t.value.length)for(p=c.retrieveCaptions(c.values,n),i=$.tmpl(c.getTemplate("frame-empty"),t),l=p.length-1;l>=0;l--)d=$.tmpl(c.getTemplate("caption"),{caption:p[l],version:c.versions[l],icon:"searchforms"==t.name?"searchform-image-form":t.icon}),i.find(".searchform-captions").prepend(d);else i=$.tmpl(c.getTemplate("frame"),t);r&&(s=$.tmpl(c.getTemplate("none"),{}),i.find(".searchform-menu").prepend(s)),o&&(a=$.tmpl(c.getTemplate("newform"),{}),i.find(".searchform-menu").prepend(a)),n.length>0&&$.each(n,function(e,t){c.renderParents(i.find(".searchform-submenu"),t)}),i.appendTo(e)})})},getResolvedData:function(e){var t=this,i=bizagi.editor.base.catalogServices,n=t.retrieveSelectedValues(e.value);return new Promise(function(o){if(0==n.length)o(e);else if(""===n[0])o(e);else{var r=n[0];t.controller.publish("getDeviceInfo").isSpecific?i.getShallowById(r).then(function(t){if(Array.isArray(t)&&t.length>0){var i=t[0];o($.extend({},e,{value:[bizagi.editor.utilities.buildComplexReference(i.parentId)]}))}else o(e)}):o(e)}})},retrieveVersion:function(e,t){return null},retrieveSelectedValues:function(e){return e.map(function(e){return bizagi.editor.utilities.resolveComplexReference(e)})},retrieveCaptions:function(e,t){var i,n,o=[];for(this.versions=[],i=0;i<t.length;i++)if(-1!==$.inArray(t[i].guid,e)&&(o.push(t[i].displayname),this.versions.push(t[i].version)),t[i].hasOwnProperty("children")&&null!==t[i].children)for(n=0;n<t[i].children.length;n++)-1!==$.inArray(t[i].children[n].guid,e)&&(o.push(t[i].children[n].displayname),this.versions.push(t[i].children[n].version));return o},renderParents:function(e,t){var i,n=this;n.parentHasChildren(t)?((i=-1!==$.inArray(t.guid,n.values)?$.tmpl(n.getTemplate("item-parent-children-checked"),t):$.tmpl(n.getTemplate("item-parent-children-unchecked"),t)).data("info",t),$.each(t.children,function(e,t){n.renderChild(i.find("ul"),t)})):(i=-1!==$.inArray(t.guid,n.values)?$.tmpl(n.getTemplate("item-parent-no-children-checked"),t):$.tmpl(n.getTemplate("item-parent-no-children-unchecked"),t)).data("info",t),i.appendTo(e)},renderChild:function(e,t){var i;(i=-1!==$.inArray(t.guid,this.values)?$.tmpl(this.getTemplate("item-child-checked"),t):$.tmpl(this.getTemplate("item-child-unchecked"),t)).data("info",t),i.appendTo(e)},parentHasChildren:function(e){var t=!0;return void 0===e.children?t=!1:null===e.children?t=!1:e.children.length<=0&&(t=!1),t},getDataForms:function(){return[{guid:"GUID-FORM-1",displayname:"Group Form 1",version:"1.0",children:[{guid:"GUID-FORM-1-1",displayname:"Form 1, G1",version:"1.0"},{guid:"GUID-FORM-1-2",displayname:"Form 2, G1",version:"1.5"}]},{guid:"GUID-GUID",displayname:"Group Form A",version:"3.141592",children:null},{guid:"GUID-FORM-2",displayname:"Group Form 2",version:"1.0",children:[{guid:"GUID-FORM-2-1",displayname:"Form 1, G2",version:"1.0"}]},{guid:"GUID-FORM-3",displayname:"Group Form 3",version:"1.0",children:[{guid:"GUID-FORM-3-1",displayname:"Form 1, G3",version:"2.0"},{guid:"GUID-FORM-3-2",displayname:"Form 2, G3",version:"1.0"}]}]},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-frame")),this.loadTemplate("frame-empty",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-frame-empty")),this.loadTemplate("caption",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-caption")),this.loadTemplate("newform",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-newform")),this.loadTemplate("none",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-none")),this.loadTemplate("item-parent-no-children-checked",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-item-parent-no-children-checked")),this.loadTemplate("item-parent-no-children-unchecked",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-item-parent-no-children-unchecked")),this.loadTemplate("item-parent-children-checked",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-item-parent-children-checked")),this.loadTemplate("item-parent-children-unchecked",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-item-parent-children-unchecked")),this.loadTemplate("item-child-unchecked",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-item-child-unchecked")),this.loadTemplate("item-child-checked",bizagi.getTemplate("bizagi.editor.component.editor.searchform").concat("#searchform-item-child-checked"))).done(function(){e.resolve()}),e.promise()},closeMenu:function(e,t){t.slideUp(function(){$(this).removeClass("searchform-open")}),e.removeClass("searchform-open")},openMenu:function(e,t){var i=this;$(document).bind("mouseup.searchformbase",function(n){1==n.which&&(0===i.element.has(n.target).length&&(i.closeMenu(e,t),$(document).unbind("mouseup.searchformbase")))}),t.slideDown(function(){$(this).addClass("searchform-open")}),e.addClass("searchform-open")},toggleForm:function(e){var t=e.closest(".searchform-item-expandable").find("ul");t.is(":visible")?(e.addClass("searchform-image-plus").removeClass("searchform-image-minus"),t.hide()):(e.addClass("searchform-image-minus").removeClass("searchform-image-plus"),t.show())},".searchform-button-dropdown click":function(e,t){var i=$(".searchform-menu",this.element);e.hasClass("searchform-open")?this.closeMenu(e,i):this.openMenu(e,i),t.stopPropagation()},".searchform-image-minus click":function(e,t){this.toggleForm(e),t.stopPropagation()},".searchform-image-plus click":function(e,t){this.toggleForm(e),t.stopPropagation()}}),bizagi.editor.component.editor.searchformbase("bizagi.editor.component.editor.searchform",{init:function(e,t,i){this._super(e,t,i)},".searchform-button-caption click":function(e,t){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_BUTTON,value:this.inputValue,propertyName:this.model.name,context:"searchform",id:this.element.closest(".bizagi_editor_component_properties").data("id")}),$(".searchform-button-dropdown",this.element).hasClass("searchform-open")&&$(".searchform-button-dropdown",this.element).removeClass("searchform-open"),$(".searchform-menu",this.element).hasClass("searchform-open")&&$(".searchform-menu",this.element).removeClass("searchform-open"),t.stopPropagation()},".searchform-newform click":function(e,t){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_NEW,propertyName:this.model.name,context:"searchform",id:this.element.closest(".bizagi_editor_component_properties").data("id")}),$(".searchform-button-dropdown",this.element).removeClass("searchform-open"),$(".searchform-menu",this.element).removeClass("searchform-open"),t.stopPropagation()},".searchform-none click":function(e,t){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_NONE,propertyName:this.model.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),$(".searchform-button-dropdown",this.element).removeClass("searchform-open"),$(".searchform-menu",this.element).removeClass("searchform-open"),t.stopPropagation()},".searchform-submenu li.searchform-item-selectable click":function(e,t){var i,n=e.data("info");i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_OPTION,propertyName:this.model.name,form:n.guid,value:this.inputValue,context:"searchform",id:this.element.closest(".bizagi_editor_component_properties").data("id")},this.controller.publish("propertyEditorChanged",i);var o=$(".searchform-button-dropdown",this.element),r=$(".searchform-menu",this.element);this.closeMenu(o,r),t.stopPropagation()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.selecttemplate",{types:{NONE:"none",DEFAULT:"default",TEMPLATE:"template"}},{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this,o=n.editorParameters=t["editor-parameters"]||{};$.when(o.templates).done(function(r){var a=n.templates=r||[];n.value=t.value,t.selectedValue=n.getSelectedValue(t.value),i=$.tmpl(n.getTemplate("frame"),$.extend(t,{templates:a}));var s=$.tmpl(n.getTemplate("options"),{disableNoneOption:bizagi.util.parseBoolean(o.disableNoneOption)});i.find(".selecttemplate-menu").prepend(s),i.appendTo(e)})},remove:function(){this.element.hide(),this.element.empty()},getSelectedValue:function(e){var t={};if(!e){var i=this.editorParameters.templatetype||"";return i=i.toUpperCase(),this.Class.types[i]&&(t.displayName=bizagi.localization.getResource("formmodeler-component-editor-selecttemplate-"+this.Class.types[i])),t}if(0==this.templates.length)return t;for(var n=bizagi.editor.utilities.resolveComplexReference(e),o=0,r=this.templates.length;o<r;o++){var a=this.templates[o];if(a.guid==n){t=a;break}}return t},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.selecttemplate").concat("#selecttemplate-frame")),this.loadTemplate("options",bizagi.getTemplate("bizagi.editor.component.editor.selecttemplate").concat("#selecttemplate-options")),this.loadTemplate("default",bizagi.getTemplate("bizagi.editor.component.editor.selecttemplate").concat("#selecttemplate-default"))).done(function(){e.resolve()}),e.promise()},getEditorParameters:function(e){return e["editor-parameters"]||{}},closeMenu:function(e,t){t.slideUp(function(){$(this).removeClass("selecttemplate-open")}),e.removeClass("selecttemplate-open")},isSameItem:function(e){return!!this.value&&bizagi.editor.utilities.resolveComplexReference(this.value)==e},openMenu:function(e,t){var i=this;$(document).bind("mouseup.selecttemplate",function(n){1==n.which&&(0===i.element.has(n.target).length&&(i.closeMenu(e,t),$(document).unbind("mouseup.selecttemplate")))}),t.slideDown(function(){$(this).addClass("selecttemplate-open")}),e.addClass("selecttemplate-open")},setTemplatetype:function(e){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:e,type:"templatetype",id:this.element.closest(".bizagi_editor_component_properties").data("id")})},".selecttemplate-none click":function(e,t){this.setTemplatetype(this.Class.types.NONE),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_TEMPLATE_NONE,propertyName:this.model.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),$(".selecttemplate-button-dropdown",this.element).removeClass("selecttemplate-open"),$(".selecttemplate-menu",this.element).removeClass("selecttemplate-open"),t.stopPropagation()},".selecttemplate-default click":function(e,t){this.setTemplatetype(this.Class.types.DEFAULT),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_NONE,propertyName:this.model.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),$(".selecttemplate-button-container selecttemplate-button-caption").text(bizagi.localization.getResource("formmodeler-component-editor-selecttemplate-default")),$(".selecttemplate-button-dropdown",this.element).removeClass("selecttemplate-open"),$(".selecttemplate-menu",this.element).removeClass("selecttemplate-open"),t.stopPropagation()},".selecttemplate-button-dropdown click":function(e,t){var i=$(".selecttemplate-menu",this.element);e.hasClass("selecttemplate-open")?this.closeMenu(e,i):this.openMenu(e,i),t.stopPropagation()},".selecttemplate-item click":function(e,t){var i=e.data("guid");this.isSameItem(i)||(this.setTemplatetype(this.Class.types.TEMPLATE),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:bizagi.editor.utilities.buildComplexReference(i),type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}))},".selecttemplate-button-caption click":function(e,t){this.value&&this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_FORM_BUTTON,value:this.value,id:this.element.closest(".bizagi_editor_component_properties").data("id"),formType:"template"})},".selecttemplate-newtemplate click":function(e,t){this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SHOW_WIZARD_TEMPLATES,propertyName:this.model.name,context:"template",id:this.element.closest(".bizagi_editor_component_properties").data("id")})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.rule",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){void 0===t.value?t.value={baref:{ref:"expression"}}:null===t.value&&(t.value={baref:{ref:"expression"}}),this.subproperties=t.subproperties,this.inputValue=t.value;var i=t.name.replace(/\./gi,"-");t.title=bizagi.localization.getResource("formmodeler-component-editor-rule-validation-"+i),t.title==="formmodeler-component-editor-rule-validation-"+i&&(t.title=""),this.renderRuleEditor(e,t)},renderRuleEditor:function(e,t){var i,n=this.getRuleValue(t.value);"expression"==(n?n.baref:t.value.baref).ref?i=$.tmpl(this.getTemplate("frame-empty"),t):($.extend(t,{nameRule:"",title:""}),t.value.rule&&void 0!==t.value.rule.displayName?""!=t.value.rule.displayName?$.extend(t,{nameRule:t.value.rule.displayName}):$.extend(t,{nameRule:bizagi.localization.getResource("formmodeler-component-editor-rule-expression")}):void 0!==t.value.displayName&&""!=t.value.displayName?$.extend(t,{nameRule:t.value.displayName}):$.extend(t,{nameRule:bizagi.localization.getResource("formmodeler-component-editor-rule-expression")}),i=$.tmpl(this.getTemplate("frame-rule"),t)),i.appendTo(e),$("input.rule-value[title]",i).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip ui-rule-editor-tooltip",position:{my:"left top+10",at:"left bottom"}}),$(".rule-internal-container > .defaultvalue-button-value[title]",i).tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip ui-rule-editor-tooltip",position:{my:"left top+10",at:"left bottom"}})},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame-empty",bizagi.getTemplate("bizagi.editor.component.editor.rule").concat("#rule-frame-empty")),this.loadTemplate("frame-rule",bizagi.getTemplate("bizagi.editor.component.editor.rule").concat("#rule-frame-rule"))).done(function(){e.resolve()}),e.promise()},createEditRule:function(e,t){var i=this,n=i.isRule90()?"rule90":"rule",o={};o[n]=i.options.value,o[n].rule&&(o[n]=o[n].rule);var r=i.model["editor-parameters"]?i.model["editor-parameters"].type:"Scripting",a={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_EXPRESSION,oldValue:i.inputValue,type:i.options.name,data:o,newValue:i.options.value,id:i.element.closest(".bizagi_editor_component_properties").data("id"),categorytype:r||"Scripting",context:i.model["editor-parameters"]?i.model["editor-parameters"].context:void 0,editor:i.hasRuleSubproperty()?"":"rule"};i.options.hasOwnProperty("exclusive")&&(a=$.extend({},a,{exclusive:i.options.exclusive})),i.controller.publish("propertyEditorChanged",a),i.inputValue=i.options.value},getRuleValue:function(e){return e.rule||e.rule90},isRule90:function(){return this.options.name.indexOf("90")>=0},hasRuleSubproperty:function(){if(this.subproperties&&$.isArray(this.subproperties)){var e=this.subproperties[0].property||{};return!!e["bas-type"]&&"rule"==e["bas-type"]}return!1},"i.rule-external click":function(e,t){this.createEditRule(e,t)},".biz-complex-btn.defaultvalue-button-value click":function(e,t){this.createEditRule(e,t)},".rule-internal-container .rule-image-edit click":function(e,t){this.createEditRule(e,t)},".rule-internal-container .rule-image-delete click":function(e,t){var i,n=this;n.element.find(".rule-container").empty(),i={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n.inputValue,newValue:void 0,data:void 0,type:n.options.name,id:n.element.closest(".bizagi_editor_component_properties").data("id")},n.options.hasOwnProperty("exclusive")&&$.extend(i,{exclusive:n.options.exclusive}),n.controller.publish("propertyEditorChanged",i),n.options.value={baref:{ref:"expression"}},n.renderRuleEditor(n.element.find(".rule-container"),n.options)}}),bizagi.editor.component.editor("bizagi.editor.component.editor.orientation",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-orientation-ltr"),style:"bz-studio bz-orientation-left-to-right_16x16_standard",value:"ltr"},{label:bizagi.localization.getResource("formmodeler-component-editor-orientation-rtl"),style:"bz-studio bz-orientation-right-to-left_16x16_standard",value:"rtl"},{label:bizagi.localization.getResource("formmodeler-component-editor-orientation-inherited"),style:"bz-studio bz-orientation-inherited_16x16_standard",value:"inherited"}],valueCheck:!1}),void 0===t.value?t.value="ltr":null===t.value&&(t.value="ltr"),n.inputValue=t.value,i=$.tmpl(n.getTemplate("frame"),t),n.inline&&i.addClass("bizagi-editor-orientation-inline"),i.appendTo(e);new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:n.inline,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},responseChangeCombo:function(e,t,i){var n,o,r;n=i.inputValue,o=e,r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",r),i.inputValue=o},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.orientation").concat("#orientation-frame"))).done(function(){e.resolve()}),e.promise()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.queryinternalsdefaultvalues",{cache:{application:[],processVersion:[],task:[],position:[],processClass:[]}},{init:function(e,t,i){this._super(e,t,i),this.focus=null},renderEditor:function(e,t){t.value&&t.value.fixedvalue||(t.value=this.getIntialValue()),t.loadingMessage=bizagi.localization.getResource("webpart-render-loading"),$.tmpl(this.getTemplate("frame"),t).appendTo(e),this.inputValue=t.value,this.loadData(t,e)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.queryinternalsdefaultvalues").concat("#queryinternals-defaultvalue-frame"))).done(function(){e.resolve()}),e.promise()},getIntialValue:function(){return{fixedvalue:-1,name:""}},loadData:function(e,t){var i=this;$(".ui-control-input",t).click(function(){t.find(".queryinternals-defaultvalue-value").toggleClass("active"),t.find(".queryinternals-defaultvalue-action-btn").toggleClass("active"),""===e.value.name&&$("i[name=expanded].queryinternals-biz-wp-tree-icon").removeClass("bz-tree-less_16x16_standard").addClass("bz-tree-show-more_16x16_standard"),setTimeout(function(){var n=e["editor-parameters"].type,o=$(".queryinternals-defaultvalue-value-loading");if(0==i.Class.cache[n].length){var r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_LOAD_METADATA,id:i.element.closest(".bizagi_editor_component_properties").data("id")};o.startLoading({delay:0,overlay:!0}),$.when(i.controller.publish("propertyEditorChanged",r)).done(function(o){o?(i.renderEditorCanvas(o,t),i.renderEditorListHandlers(t,e),i.expandTree(e,t),i.Class.cache[n]=o):(t.find(".queryinternals-defaultvalue-value").toggleClass("active"),t.find(".queryinternals-defaultvalue-action-btn").toggleClass("active"))}).fail(function(e){bizagi.log(e)}).done(function(){o.endLoading()})}else{0==$(".queryinternals-defaultvalue-value").has("ul").length&&(i.renderEditorCanvas(i.Class.cache[n],t),i.renderEditorListHandlers(t,e),i.expandTree(e,t))}},70)}),$("#queryinternals-defaultvalue-action-btn",t).click(function(){var n=$("#data-queryinternals-defaultvalue-frame span",t);n.text(""),i.updateValue(n,e,t,!0),t.find(".queryinternals-defaultvalue-value").removeClass("active"),t.find(".queryinternals-defaultvalue-action-btn").removeClass("active"),i.expandTree(e,t)})},renderEditorCanvas:function(e,t){var i,n=$("<div>");(i=this.renderEditorCanvasChildrens(e,"<i name='expanded' class='queryinternals-biz-wp-tree-icon biz-ico queryinternals-biz-wp-tree-expand-icon bz-studio bz-tree-show-more_16x16_standard'></i>","<i class='queryinternals-biz-wp-tree-icon queryinternals-biz-wp-tree-image-")).attr("id","queryinternals-defaultvalue-mainList"),i.appendTo(n);var o=$.tmpl(n,{});$(".queryinternals-defaultvalue-value",t).html(o)},renderEditorCanvasChildrens:function(e,t,i){var n,o,r,a,s,l,d=this,c=$("<ul>"),u={application:{style:"bz-studio bz-application_16x16_standard"},process:{style:"bz-studio bz-processes_16x16_standard"},processClass:{style:"bz-studio bz-processes_16x16_standard"},task:{style:"bz-studio bz-m-task_16x16_standard"},position:{style:"bz-studio bz-object-position_16x16_standard"},processVersion:{style:"bz-studio bz-new-version_16x16_standard"},organization:{style:"bz-studio bz-organization_16x16_standard"},loading:{style:"bz-studio bz-m-custom-artifact_16x16_standard"}};return $.each(e,function(e,p){o=d.convertTypeString(p.Type),p.IdObject,r=p.DisplayName,l=p.Id,a=o?u[o].style:"",s=i+o+" "+a+"'></i>",null!=p.Children&&p.Children.length>0?(n=$("<li  data-id="+o+" data-guid="+l+" id = "+l+">"+t+s+bizagi.util.encodeHtml(r)+"</li>").appendTo(c),d.renderEditorCanvasChildrens(p.Children,t,i).appendTo(n)):n=$("<li  data-id= "+o+" data-guid="+l+" id = "+l+">"+s+bizagi.util.encodeHtml(r)+"</li>").appendTo(c)}),c},renderEditorListHandlers:function(e,t){var i=this;$("#queryinternals-defaultvalue-mainList li",e).click(function(){if(this.getElementsByTagName("ul").length>0){var n=this.getElementsByClassName("queryinternals-biz-wp-tree-expand-icon")[0];return $(n).toggleClass("queryinternals-biz-wp-tree-collapse-icon"),$(n).toggleClass("bz-tree-show-more_16x16_standard bz-tree-less_16x16_standard"),$(this).children("ul").toggle("medium"),!1}var o=t["editor-parameters"].type;if(this.getAttribute("data-id")==o)return i.updateValue(this,t,e),e.find(".queryinternals-defaultvalue-value").toggleClass("active"),e.find(".queryinternals-defaultvalue-action-btn").toggleClass("active"),i.expandTree(t,e),$("#data-queryinternals-defaultvalue-frame span",e).text($(this).text()),!1;var r=bizagi.localization.getResource("formmodeler-component-editor-validation-xpath-title"),a=bizagi.localization.getResource("formmodeler-component-editor-queryinternalsdefaultvalues-message-"+o);bizagi.showMessageBox(a,r,"warning",!1)})},updateValue:function(e,t,i,n){var o;$("#queryinternals-defaultvalue-mainList li",i).removeClass("queryinternals-defaultvalue-mainItem"),o=void 0===$(e).attr("id")?-1:$(e).attr("id"),this.inputValue=t.value={fixedvalue:o,name:$(e).text()};var r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:n?void 0:this.buildValue(e),data:n?void 0:this.buildValue(e),type:t.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};this.controller.publish("propertyEditorChanged",r)},expandTree:function(e,t){if(e.value&&e.value.fixedvalue){var i=e["editor-parameters"].type,n=$('#queryinternals-defaultvalue-mainList li[data-id="'+i+'"]').filter(function(t){return $(this).attr("id")===e.value.fixedvalue});$(n,t).addClass("queryinternals-defaultvalue-mainItem")}$("#queryinternals-defaultvalue-mainList ul").hide(),$(".queryinternals-biz-wp-tree-expand-icon").removeClass("queryinternals-biz-wp-tree-collapse-icon");var o=$(".queryinternals-defaultvalue-mainItem").parentsUntil("#queryinternals-defaultvalue-mainList").find("ul:has(.queryinternals-defaultvalue-mainItem)");o.show(),o.siblings().show(),o.siblings().toggleClass("queryinternals-biz-wp-tree-collapse-icon"),$("i[name=expanded].queryinternals-biz-wp-tree-collapse-icon").hasClass("bz-tree-show-more_16x16_standard")&&$("i[name=expanded].queryinternals-biz-wp-tree-collapse-icon").removeClass("bz-tree-show-more_16x16_standard").addClass("bz-tree-less_16x16_standard")},convertTypeString:function(e){var t;return 1==e?t="application":20==e?t="processClass":100==e?t="task":11==e?t="position":16==e?t="processVersion":10==e&&(t="organization"),t},buildValue:function(e){return{fixedvalue:$(e).attr("id"),name:$(e).text()}}}),bizagi.editor.component.editor("bizagi.editor.component.editor.rangequery",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-rangequery-from"),value:"from",style:"bz-studio bz-range-query-from_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-rangequery-to"),value:"to",style:"bz-studio bz-range-query-to_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-rangequery-none"),value:"none",style:" bz-studio bz-number-range_16x16_standard"}],valueCheck:!1}),void 0===t.value?t.value="none":null===t.value&&(t.value="none"),n.inputValue=t.value,i=$.tmpl(n.getTemplate("frame"),t),n.inline&&i.addClass("bizagi-editor-rangequery-inline"),i.appendTo(e);new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:n.inline,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},responseChangeCombo:function(e,t,i){var n,o,r;n=i.inputValue,o=e,r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",r),i.inputValue=o},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.rangequery").concat("#rangequery-frame"))).done(function(){e.resolve()}),e.promise()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.userstoinclude",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-userstoinclude-current"),value:"1"},{label:bizagi.localization.getResource("formmodeler-component-editor-userstoinclude-all"),value:"0"}],valueCheck:!1}),void 0===t.value?t.value="current":null===t.value&&(t.value="current"),n.inputValue=t.value,i=$.tmpl(n.getTemplate("frame"),t),n.inline&&i.addClass("bizagi-editor-userstoinclude-inline"),i.appendTo(e);new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:n.inline,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},responseChangeCombo:function(e,t,i){var n,o,r;n=i.inputValue,o=e,r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",r),i.inputValue=o},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.userstoinclude").concat("#userstoinclude-frame"))).done(function(){e.resolve()}),e.promise()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.typesearch",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-typesearch-approximate"),value:"approx"},{label:bizagi.localization.getResource("formmodeler-component-editor-typesearch-exact"),value:"exact"}],valueCheck:!1}),void 0===t.value?t.value="approximate":null===t.value&&(t.value="approximate"),n.inputValue=t.value,i=$.tmpl(n.getTemplate("frame"),t),n.inline&&i.addClass("bizagi-editor-typesearch-inline"),i.appendTo(e);new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:n.inline,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},responseChangeCombo:function(e,t,i){var n,o,r;n=i.inputValue,o=e,r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",r),i.inputValue=o},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.typesearch").concat("#typesearch-frame"))).done(function(){e.resolve()}),e.promise()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.casestatedefaultvalue",{map:{0:"casestate-all",5:"casestate-closed",2:"casestate-pending",4:"casestate-aborted"}},{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-casestatedefaultvalue-all"),value:"casestate-all",style:"bz-studio bz-state-blue_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-casestatedefaultvalue-closed"),value:"casestate-closed",style:"bz-studio bz-state-red_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-casestatedefaultvalue-pending"),value:"casestate-pending",style:"bz-studio bz-state-yellow_16x16_standard"},{label:bizagi.localization.getResource("formmodeler-component-editor-casestatedefaultvalue-aborted"),value:"casestate-aborted",style:"bz-studio bz-remove-cross_16x16_standard"}],valueCheck:!1}),void 0===t.value?t.value=0:null===t.value&&(t.value=0),"object"==typeof t.value&&(t.value=t.value.fixedvalue?t.value.fixedvalue:0),t.value=n.Class.map[t.value],n.inputValue=t.value,i=$.tmpl(n.getTemplate("frame"),t),n.inline&&i.addClass("bizagi-editor-casestatedefaultvalue-inline"),i.appendTo(e);new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:n.inline,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},responseChangeCombo:function(e,t,i){var n,o;n=i.buildValue(e),o={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:n,data:n,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",o),i.inputValue=e},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.casestatedefaultvalue").concat("#casestatedefaultvalue-frame"))).done(function(){e.resolve()}),e.promise()},buildValue:function(e){var t=0;for(var i in this.Class.map){if(this.Class.map[i]==e){t=i;break}}return{fixedvalue:t}}}),bizagi.editor.component.editor("bizagi.editor.component.editor.taskstatedefaultvalue",{map:{0:"taskstate-all",1:"taskstate-expired",2:"taskstate-expires-today",7:"taskstate-expires-future"}},{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!1,$.extend(t,{uiValues:[{label:bizagi.localization.getResource("formmodeler-component-editor-taskstatedefaultvalue-all"),value:"taskstate-all"},{label:bizagi.localization.getResource("formmodeler-component-editor-taskstatedefaultvalue-expired"),value:"taskstate-expired"},{label:bizagi.localization.getResource("formmodeler-component-editor-taskstatedefaultvalue-expiresinthefuture"),value:"taskstate-expires-future"},{label:bizagi.localization.getResource("formmodeler-component-editor-taskstatedefaultvalue-expirestoday"),value:"taskstate-expires-today"}],valueCheck:!1}),void 0!==t.value&&null!==t.value||(t.value=0),"object"==typeof t.value&&(t.value=t.value.fixedvalue?t.value.fixedvalue:0),t.value=n.Class.map[t.value],n.inputValue=t.value,i=$.tmpl(n.getTemplate("frame"),t),n.inline&&i.addClass("bizagi-editor-taskstatedefaultvalue-inline"),i.appendTo(e);new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:n.inline,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},responseChangeCombo:function(e,t,i){var n,o;n=i.buildValue(e),o={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,newValue:n,data:n,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",o),i.inputValue=n},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.taskstatedefaultvalue").concat("#taskstatedefaultvalue-frame"))).done(function(){e.resolve()}),e.promise()},buildValue:function(e){var t=0;for(var i in this.Class.map){if(this.Class.map[i]==e){t=i;break}}return{fixedvalue:t}}}),bizagi.editor.component.editor("bizagi.editor.component.editor.activecontainer",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!1;var o=t["editor-parameters"].values||[];$.extend(t,{uiValues:o,valueCheck:!1}),t.value=t.value||0,n.inputValue=t.value,i=$.tmpl(n.getTemplate("frame"),t),n.inline&&i.addClass("bizagi-editor-activecontainer-inline"),i.appendTo(e);new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:t.uiValues,uiInline:n.inline,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})},responseChangeCombo:function(e,t,i){var n,o,r;n=i.inputValue,o=e,r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")},i.controller.publish("propertyEditorChanged",r),i.inputValue=o},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.activecontainer").concat("#activecontainer-frame"))).done(function(){e.resolve()}),e.promise()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.changelayout",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i;this.data=t,this.boxes=[],this.values=[],this.total=0,this.fixedWidth=0,i=$.tmpl(this.getTemplate("frame"),t),this.renderColumnsWidths(i.find(".changelayout-fields"),t.value.elements),i.appendTo(e),this.createDialogEditor(t)},renderColumnsWidths:function(e,t){var i,n;for(n="",i=0;i<t.length;i++)n+=t[i].width,t.length>1&&i!=t.length-1&&(n+=", ");$.tmpl(this.getTemplate("columns"),{width:n}).appendTo(e)},renderFieldsWidths:function(e,t){var i;for(i=0;i<t.length;i++)$.tmpl(this.getTemplate("field"),t[i]).appendTo(e)},refreshColumnsWidths:function(e){$(".changelayout-concat-value",this.element).text(e)},createDialogEditor:function(e){var t,i,n,o,r=this;for(t=$.tmpl(r.getTemplate("popup-content"),{}),elPopupContentWrapper=$(".changelayout-wrapper-container",t),elPopupContentSlider=$(".changelayout-slider-container",t),n=e.value.elements,c=0;c<n.length;c++)$.tmpl(r.getTemplate("popup-wrapper"),n[c]).appendTo(elPopupContentWrapper);(o=$.tmpl(r.getTemplate("popup-slider"),n[0])).css("width",void 0+"%"),o.appendTo(elPopupContentSlider),i=$.tmpl(r.getTemplate("popup-actions"),{}),$($("span",i).get(0)).click(function(){var e=$(".changelayout-box",t),i=$(".changelayout-field-value",r.element),n=[];$.each(e,function(e,t){t=$(t).parent(),n.push({index:e,width:parseInt(t.attr("data-value"))+"%"}),$(i[e]).text(parseInt(t.attr("data-value"))+"%")});var o={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_LAYOUT,values:n,id:r.element.closest(".bizagi_editor_component_properties").data("id")};r.controller.publish("propertyEditorChanged",o),r.hideDialog();for(var a="",s=0;s<r.boxes.length;s++)a+=parseInt($(r.boxes[s]).attr("data-value"))+"%",r.data.value.elements[s].width=parseInt($(r.boxes[s]).attr("data-value"))+"%",r.boxes.length>1&&s!=r.boxes.length-1&&(a+=", ");r.refreshColumnsWidths(a)}).text(bizagi.localization.getResource("formmodeler-component-editor-changelayout-ok")),$($("span",i).get(1)).click(function(){r.hideDialog()}).text(bizagi.localization.getResource("formmodeler-component-editor-changelayout-cancel")),r.modalReference=r.createDialog(t,i);var a=$(".changelayout-slider",t),s={slide:function(e,t){var i=$(".ui-slider-handle"),n=$(t.handle).siblings("a").andSelf().index(t.handle),o=$(this).slider("value");if(i.length>1&&(o=$(this).slider("values")),r.redrawWidthBoxes(n,o),i.length>1)return(0==n||t.value>o[n-1])&&(n==o.length-1||t.value<o[n+1])}},l=$(".changelayout-box",t);if(l.length>2){for(var d=[],c=0;c<l.length;c++){var u=parseFloat(d[c-1])?parseFloat(d[c-1]):0,p=parseFloat($(l[c]).parent().attr("data-value"))+u;p<100&&p>0&&d.push(p)}$.extend(s,{min:0,max:100,values:d})}else $.extend(s,{value:$(l[0]).parent().attr("data-value")});a.slider(s)},redrawWidthBoxes:function(e,t){var i,n,o,r,a,s;i=t[e-1]?parseInt(t[e-1]):0,n=t[e]?parseFloat(t[e])-i:parseFloat(t)-i,r=$(this.boxes[e]),a=$(this.boxes[e+1]),s=parseFloat(r.attr("data-value"))+parseFloat(a.attr("data-value")),r.css("width",n+"%"),$(".changelayout-value",r).text(n+"%"),r.attr("data-value",n),"number"!=typeof t?(o=parseInt(s-parseInt(t[e]-i)),a.css("width",o+"%"),$(".changelayout-value",a).text(o+"%"),a.attr("data-value",o)):(o=s-t,a.css("width",o+"%"),$(".changelayout-value",a).text(o+"%"),a.attr("data-value",o))},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.changelayout").concat("#changelayout-frame")),this.loadTemplate("field",bizagi.getTemplate("bizagi.editor.component.editor.changelayout").concat("#changelayout-field")),this.loadTemplate("columns",bizagi.getTemplate("bizagi.editor.component.editor.changelayout").concat("#changelayout-columns")),this.loadTemplate("popup-content",bizagi.getTemplate("bizagi.editor.component.editor.changelayout").concat("#changelayout-popupcontent")),this.loadTemplate("popup-wrapper",bizagi.getTemplate("bizagi.editor.component.editor.changelayout").concat("#changelayout-wrapper")),this.loadTemplate("popup-slider",bizagi.getTemplate("bizagi.editor.component.editor.changelayout").concat("#changelayout-slider")),this.loadTemplate("popup-actions",bizagi.getTemplate("bizagi.editor.component.editor.changelayout").concat("#changelayout-popupactions"))).done(function(){e.resolve()}),e.promise()},".biz-ico.changelayout-image-small-popup click":function(e,t){var i,n=this;n.showDialog(e,t).done(function(){var e=$(".changelayout-box-wrapper",n.modalReference);for(n.boxes=[],$.each(e,function(e,t){t=$(t),n.boxes.push(t),n.values.push(parseInt(n.boxes[e].attr("data-value"))),n.total+=n.values[e]}),i=0;i<n.boxes.length;i++)n.boxes[i].css("width",n.boxes[i].attr("data-value")+"%")})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.cssclass",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){void 0===t.value?t.value="":null===t.value&&(t.value=""),this.inputValue=t.value,$.tmpl(this.getTemplate("frame"),t).appendTo(e)},validateAndPublish:function(e,t){var i;/^([a-zA-Z]([a-zA-Z0-9_-])*|\s)*$/.test(t)?(this.hideError(e),this.publishValue(t)):(i=bizagi.localization.getResource("formmodeler-component-editor-cssclass-error-class"),this.showError(e,i),e.select())},publishValue:function(e){var t={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputValue,newValue:e,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")};this.controller.publish("propertyEditorChanged",t),this.inputValue=e},loadTemplates:function(){var e;return e=$.Deferred(),$.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.cssclass").concat("#cssclass-frame"))).done(function(){e.resolve()}),e.promise()},"input keyup":function(e,t){var i=e.val();13==t.keyCode&&i!=this.inputValue&&this.validateAndPublish(e,i)},"input blur":function(e){var t=e.val();t!=this.inputValue&&this.validateAndPublish(e,t)}}),$.Controller("bizagi.editor.component.editor.lstring",{init:function(e,t,i){this.canvas=e,this.model=t,this.controller=i},render:function(){var e=$("<label></label>").html(this.options.caption),t=$("<input />").attr("type","text").val(this.options.hasOwnProperty("value")?this.options.value:this.options.default);t.addClass("ui-control-input").css("width","95%"),this.inputVal=this.options.value,e.appendTo(this.element),t.appendTo(this.element)},"input keydown":function(e,t){t.stopPropagation(),13==t.keyCode&&this.inputVal!=e.val()&&(this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.inputVal,newValue:e.val(),type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),this.inputVal=e.val())}}),bizagi.editor.component.editor("bizagi.editor.component.editor.buttonactions",{init:function(e,t,i){this._super(e,t,i),this.actions={submitData:{tooltip:"formmodeler-component-editor-buttonactions-submitdata-tooltip",label:"formmodeler-component-editor-buttonactions-submitdata",value:!1,show:!0},refresh:{tooltip:"formmodeler-component-editor-buttonactions-refresh",label:"formmodeler-component-editor-buttonactions-refresh",value:!1,show:!1},validate:{tooltip:"formmodeler-component-editor-buttonactions-validate-tooltip",label:"formmodeler-component-editor-buttonactions-validate",value:!1,show:!0},next:{tooltip:"formmodeler-component-editor-buttonactions-next-tooltip",label:"formmodeler-component-editor-buttonactions-next",value:!1,show:!0},nextWithoutValidations:{tooltip:"formmodeler-component-editor-buttonactions-next-without-validations-tooltip",label:"formmodeler-component-editor-buttonactions-next-without-validations",value:!1,show:!0},back:{tooltip:"formmodeler-component-editor-buttonactions-back",label:"formmodeler-component-editor-buttonactions-back",value:!1,show:!1}}},renderEditor:function(e,t){var i=this;i.originalValue=t.value,t.value=i.executeInternalValidationRules(t.value,!0),t.value&&$.each(t.value,function(e,t){i.actions[t]&&i.actions[t].show&&(i.actions[t].value=!0)});var n=$.tmpl(i.getTemplate("control"));n.appendTo(e);var o=i.getComboValues();i.createUIControls(n,o),e.tooltip({position:{my:"left+15 center",at:"right center"},tooltipClass:"ui-widget-content ui-propertybox-tooltip"})},getComboValues:function(){var e=[];return $.each(this.actions,function(t,i){i.show&&(i.value?e.push({tooltip:i.tooltip,icon:null,label:i.label,value:t,selected:"selected"}):e.push({tooltip:i.tooltip,icon:null,label:i.label,value:t}))}),e},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.buttonactions").concat("#buttonactions-frame")),this.loadTemplate("control",bizagi.getTemplate("bizagi.editor.component.editor.buttonactions").concat("#buttonactions-control"))).done(function(){e.resolve()}),e.promise()},responseChangeCombo:function(e,t){var i=this.executeInternalValidationRules(e,!1);return this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:this.originalValue,newValue:i,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")}),!0},executeInternalValidationRules:function(e,t){var i=[];if(t)$.isArray(e)&&e.indexOf("next")>=0?i.push(this.resolveAction("next",e)):i=e;else switch(e){case"next":i=["next","submitData","validate"];break;case"nextWithoutValidations":i=["nextWithoutValidations","submitData"];break;case"submitData":i=["submitData","refresh"];break;default:i=[e]}return i},resolveAction:function(e,t){return"next"==e?t.indexOf("validate")>=0?e:"nextWithoutValidations":e},createUIControls:function(e,t){var i=this;i.myCombo=new i.uiControls.comboBox({uiEditor:i,uiPlaceHolderText:" ---------- ",uiContainer:$(".ui-control-editor",e),uiValues:t,uiInline:!1,onChange:function(e,t){i.responseChangeCombo(e,t,i)}})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.adhocsuggest",{init:function(e,t,i){this._super(e,t,i);this.adhocProcessId=t.adhocProcessId},renderEditor:function(e,t){var i,n,o=this;o.inputValue=t.value,o.charLimit=300,o.placeholder=!!t["editor-parameters"].placeholder,o.placeholderText=o.placeholder?" "+t["editor-parameters"].placeholder:" ",o.isReadOnly=void 0!==t["editor-parameters"].readOnly&&bizagi.util.parseBoolean(t["editor-parameters"].readOnly),$.extend(t,{placeholder:o.placeholder,placeholderText:o.placeholderText,isReadOnly:o.isReadOnly}),(i=$.tmpl(o.getTemplate("frame"),t)).appendTo(e),o.adhocXpathInput=$("#adhocsuggest-input",i),t.value&&o.adhocXpathInput.val(t.value.xpath),o.adhocXpathInput.on("focusin",function(){o.createAutoComplete(i)}),n=$("label",i),o.addRequired(n)},createAutoComplete:function(e){var t=this;t.autoCompleteCreated||(t.adhocXpathvalues?t.initializeAutoComplete(t.adhocXpathInput,t.adhocXpathvalues):$.when(t.getDataSource()).done(function(e){t.adhocXpathvalues=e,t.initializeAutoComplete(t.adhocXpathInput,e)}),t.autoCompleteCreated=!0)},destroyAutoComplete:function(e){if(this.autoCompleteCreated){var t=$("#adhocsuggest-input",e);t.hasClass("ui-autocomplete-input")&&t.autocomplete("destroy")}},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.adhocsuggest").concat("#adhocsuggest-frame"))).done(function(){e.resolve()}),e.promise()},validate:function(e){var t,i,n=!1;return i=(t=$(e)).val(),!this.isLength(e)&&i.length?(t.hasClass("error")||t.addClass("error"),this.showError(e,this.Error),t.select()):(t.removeClass("error"),this.hideError(e),n=!0),n},isLength:function(e){return this.Error=bizagi.localization.getResource("bizagi-editor-numberrange-error-lenght").replace("$number",this.charLimit),e.val().length<=this.charLimit},"label click":function(e,t){e.next().focus()},initializeAutoComplete:function(e,t){var i=this;e.autocomplete({minLength:2,source:t,appendTo:".bizagi_editor_component_properties",select:function(t,n){var o=n.item.label.indexOf(".")>-1?n.item.label.split(".")[1]:n.item.label;e.val(o);var r=i.inputValue?i.inputValue.relatedEntity:null,a={xpath:e.val(),relatedEntity:r},s={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:i.inputValue,newValue:a,type:i.options.name,refreshProperties:!0,removeDefaultDisplayName:!0,id:i.element.closest(".bizagi_editor_component_properties").data("id")};return i.inputValue=a,i.controller.publish("propertyEditorChanged",s),!1},focus:function(){return!1},change:function(t,n){if(null===n.item){e.val(t.currentTarget.value);var o=i.inputValue?i.inputValue.relatedEntity:null,r=e.val().length>0?{xpath:bizagi.editor.utilities.getXPathByDisplayName(e.val()),relatedEntity:o}:void 0,a={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:i.inputValue,newValue:r,type:i.options.name,refreshProperties:!0,removeDefaultDisplayName:!0,id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.inputValue=r,i.controller.publish("propertyEditorChanged",a)}return!1}})},getDataSource:function(){var e=new $.Deferred,t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getadhocdataschema",adhocProcessId:this.adhocProcessId});return $.when(t.processRequest()).done(function(t){var i=[];t.properties&&$.each(t.properties,function(e,t){i.push({label:t.name,value:t.name})}),e.resolve(i)}),e.promise()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.adhocdatasource",{init:function(e,t,i){this._super(e,t,i);this.controller=i,this.canvas=e,this.adhocProcessId=t.adhocProcessId,this.adhocXpathValue={},this.dialogBox={},this.entitiesAreLoading=!1},renderEditor:function(e,t){var i,n,o=this;t.readonly=o.options["editor-parameters"].readonly||!1,(i=$.tmpl(o.getTemplate("frame"),t)).appendTo(e),n=$("label",i),o.addRequired(n),o.adhocXpathInput=$(".adhoc-xpath-value",i);var r=$(i).closest(".bizagi_editor_component_editor_adhocdatasource").find("i"),a=$(i).closest(".bizagi_editor_component_editor_adhocdatasource").find(".mini-loading");r.hide(),a.css("display","inline-block"),o.showPredefinedValuesControl=t.showPredefinedValuesControl,o.isAdhocSuggestControl=t.isAdhocSuggestControl,o.showTextModifyPredefinedValuesControl=!1,o.showAdhocEntitiesControl=t.showAdhocEntitiesControl,o.entitiesAreLoading=!0,o.adhocXpathInput.val(bizagi.localization.getResource("formmodeler-component-wait-message-loading-form")),$.when(o.getDataSources()).done(function(e){if(o.adhocXpathInput.val(""),o.bizagiEntitiesValues=e.bizagiEntities,o.adhocEntitiesValues=e.adhocEntities,t.value&&null!=t.value){if(t.value.guid){var i=o.bizagiEntitiesValues.filter(function(e){return e.value===t.value.guid})[0];null==i&&(i=o.adhocEntitiesValues.filter(function(e){return e.value===t.value.guid})[0])}if(o.adhocXpathValue=t.value,o.adhocXpathInput.val("Predefined"),null==i){var n=new $.Deferred;t.value.values?(o.adhocXpathValue=t.value,n.resolve()):$.when(o.getPredefinedValues(t.adhocProcessId,t.value.property)).done(function(e){t.value.values=e,o.adhocXpathValue=t.value,n.resolve()}),n.promise().then(function(){if(bizagi.util.isEmpty(o.adhocXpathValue)||"string"!=typeof o.adhocXpathValue.values){var e={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:void 0,newValue:void 0,type:o.options.name,refreshProperties:!0,removeDefaultDisplayName:!0,id:o.element.closest(".bizagi_editor_component_properties").data("id")};o.controller.publish("propertyEditorChanged",e)}}),o.adhocXpathInput.val("Predefined"),o.showTextModifyPredefinedValuesControl=!0}else o.adhocXpathValue=i,o.adhocXpathInput.val(i.label)}o.entitiesAreLoading=!1,a.hide(),r.css("display","inline-block")})},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.adhocdatasource").concat("#adhocdatasource-frame")),this.loadTemplate("close-popup",bizagi.getTemplate("bizagi.editor.component.editor.adhocdatasource").concat("#adhocdatasource-popup-close")),this.loadTemplate("popup-container",bizagi.getTemplate("bizagi.editor.component.editor.adhocdatasource").concat("#adhocdatasource-popup-container")),this.loadTemplate("predefined-values-popup",bizagi.getTemplate("bizagi.editor.component.editor.adhocdatasource").concat("#adhocdatasource-predefined-values-popup")),this.loadTemplate("predefined-values-items",bizagi.getTemplate("bizagi.editor.component.editor.adhocdatasource").concat("#adhocdatasource-predefined-values-items"))).done(function(){e.resolve()}),e.promise()},initializeAutoComplete:function(e,t){var i=this;e.autocomplete({minLength:0,source:t,select:function(t,n){i.selectApplied=!0,setTimeout(function(){i.selectApplied=!1},300);var o=n.item.label;if(e.val(o),i.adhocXpathInput.val()!==o){var r={guid:n.item.value,type:"bizagi",values:null};"adhoc-entity-input"==e[0].id&&(r.type="adhoc");var a={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:i.adhocXpathValue,newValue:r,type:i.options.name,refreshProperties:!0,removeDefaultDisplayName:!0,id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.controller.publish("propertyEditorChanged",a),i.adhocXpathInput.val(e.val()),i.adhocXpathValue=r}return i.closePopup(),!1},focus:function(){return!1},change:function(t,n){if(null===n.item&&!0!==i.selectApplied){e.val(t.currentTarget.value);var o={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:i.adhocXpathValue,newValue:void 0,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.controller.publish("propertyEditorChanged",o),i.adhocXpathInput.val(""),i.adhocXpathValue=null,i.closePopup()}return!1}}).focus(function(){$(e).autocomplete("search","")})},getDataSource:function(){var e=new $.Deferred,t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getadhocdataschema",adhocProcessId:this.adhocProcessId});return $.when(t.processRequest()).done(function(t){var i=[];t.properties&&$.each(t.properties,function(e,t){i.push({label:t.name,value:t.name})}),e.resolve(i)}),e.promise()},createXpathNavigatorCanvas:function(){var e=this,t=e.overlay=$("<div />").addClass("bizagi_editor_xpathnavigator_overlay"),i=e.xpathNavigatorElement=$("<div />").addClass("bizagi_editor_component_xpathnavigator biz-work-panel biz-border-all biz-shadow-modal biz-border-color ui-corner-all"),n=$.tmpl(this.getTemplate("close-popup"));$(".bizagi_editor_xpathnavigator_container-close-image",n).on("click",function(){e.closePopup()}),n.appendTo(e.xpathNavigatorElement),t.appendTo("form-modeler"),i.appendTo(t),setTimeout(function(){i.click(function(e){e.stopPropagation()}),$(t).one("click",function(){e.closePopup()})},100)},calculateFloatingPosition:function(e,t){var i=this.xpathNavigatorElement.outerHeight();return e.top-=i/2,e},getDialogPosition:function(e){var t=e.offset();return{top:t.top,left:t.left+e.outerWidth()}},closePopup:function(){var e=this;e.xpathNavigatorElement.hide(),e.controller.publish("close"),e.adhocEntityInput&&e.adhocEntityInput.data("ui-autocomplete")&&e.adhocEntityInput.autocomplete("destroy"),e.bizagiEntityInput&&e.bizagiEntityInput.data("ui-autocomplete")&&e.bizagiEntityInput.autocomplete("destroy"),setTimeout(function(){e.overlay.detach()},200)},getDataSources:function(){var e=new $.Deferred,t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getadhocdatasources",adhocProcessId:this.adhocProcessId});return $.when(t.processRequest()).done(function(t){var i={},n=[],o=[];$.each(t,function(e,t){"bizagi"===t.type?n.push({label:t.entName,value:t.entId}):o.push({label:t.entName,value:t.entId})}),i.bizagiEntities=n,i.adhocEntities=o,e.resolve(i)}),e.promise()},getPredefinedValues:function(e,t){var i=new $.Deferred,n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getpredefinedvalues",adhocProcessId:e,property:t});return $.when(n.processRequest()).done(function(e){i.resolve(e)}),i.promise()},".xpath-image-world click":function(e,t){var i=this;if(!i.entitiesAreLoading){var n=i.getDialogPosition(i.adhocXpathInput);i.createXpathNavigatorCanvas(),i.xpathNavigatorElement.css(i.calculateFloatingPosition(n,i.xpathNavigatorElement)),i.xpathNavigatorElement.css("height","auto"),i.xpathNavigatorElement.show(),i.xpathNavigatorElement.resizable({helper:"ui-resizable-helper",minWidth:250,start:function(e,t){$(".ui-resizable-helper").css({"z-index":1001})},stop:function(e,t){}});var o=i.bizagiEntitiesValues.length>0,r=i.adhocEntitiesValues.length>0,a=$.tmpl(i.getTemplate("popup-container"),{hasBizagiEntities:o,hasAdhocEntities:r,showPredefinedValuesControl:i.showPredefinedValuesControl,showTextModifyPredefinedValuesControl:i.showTextModifyPredefinedValuesControl,showAdhocEntitiesControl:i.showAdhocEntitiesControl,isAdhocSuggestControl:i.isAdhocSuggestControl});if(i.xpathNavigatorElement.append(a),o){i.bizagiEntityInput=$("#bizagi-entity-input",a);var s=i.bizagiEntitiesValues.filter(function(e){return e.label===i.adhocXpathInput.val()})[0];i.bizagiEntityInput.val(s?s.label:""),i.bizagiEntityInput.mousedown(function(e){$(e.target).focus()}),i.initializeAutoComplete(i.bizagiEntityInput,i.bizagiEntitiesValues)}if(r){i.adhocEntityInput=$("#adhoc-entity-input",a);s=i.adhocEntitiesValues.filter(function(e){return e.label===i.adhocXpathInput.val()})[0];i.adhocEntityInput.val(s?s.label:""),i.adhocEntityInput.mousedown(function(e){$(e.target).focus()}),i.initializeAutoComplete(i.adhocEntityInput,i.adhocEntitiesValues)}$("#predefinedValuesLink",a).click(function(){i.showPredefinedValuesPopup()})}},showPredefinedValuesPopup:function(){var e=this,t=e.getTemplate("predefined-values-popup");e.dialogBox.formContent=$.tmpl(t),e.dialogBox.elements={buttonAdd:$("#js-link-add-new-item",e.dialogBox.formContent),buttonSave:$("#button-accept-predefined-values-form",e.dialogBox.formContent),buttonCancel:$("#button-cancel-predefined-values-form",e.dialogBox.formContent)},e.dialogBox.elements.buttonAdd.on("click",$.proxy(e.onAddNewItem,e)),e.dialogBox.elements.buttonSave.on("click",$.proxy(e.onSavePredefinedValues,e)),e.dialogBox.elements.buttonCancel.on("click",$.proxy(e.closeDialogBox,e));var i=[];e.adhocXpathValue&&e.adhocXpathValue.values?i=JSON.parse(e.adhocXpathValue.values):e.dialogBox.data=[],e.initializeItems(i),$(".container-items",e.dialogBox.formContent).addClass("is-editing"),$(".list-items",e.dialogBox.formContent).on("keyup",".inputtext",$.proxy(e.onKeyPressInputItem,e)),$(".list-items",e.dialogBox.formContent).on("focusout",".inputtext",$.proxy(e.onFocusOutInputItem,e)),$(".list-items",e.dialogBox.formContent).on("focus",".inputtext",$.proxy(e.onFocusInputItem,e)),$(".list-items",e.dialogBox.formContent).on("click",".item-button.delete",$.proxy(e.onClickDeleteItem,e)),$(".list-items",e.dialogBox.formContent).on("mouseleave",".item",$.proxy(e.onMouseLeaveItem,e)),e.addNewItem(Math.guid,""),e.dialogBox.formContent.dialog({resizable:!1,draggable:!1,height:"auto",width:"500px",modal:!0,title:bizagi.localization.getResource("Predefined Values"),maximize:!1,closeOnEscape:!1,close:function(){e.dialogBox.formContent.dialog("destroy"),e.dialogBox.formContent.detach()}})},initializeItems:function(e){var t=this.dialogBox.formContent,i=this.getTemplate("predefined-values-items"),n={};n.items=e;var o=$.tmpl(i,n),r=$(".list-items",t);r.empty().append(o),$(".inputtext",r).on("change",$.proxy(this.onChangeItems,this)),this.validateSaveButton(!0)},onChangeItems:function(){},onKeyPressInputItem:function(e){var t=this.dialogBox.formContent;setTimeout(function(){$(e.target).siblings(".showtext").text($(e.target).val()),$(e.target).prop("title",$(e.target).val())},51);var i=e.keyCode||e.which;function n(){setTimeout(function(){$(".list-items .item.edit",t).find(".inputtext").focus();var e=$(".list-items .item.edit",t).find(".inputtext").val();$(".list-items .item.edit",t).find(".inputtext").val(e)},51)}function o(e){$(e.target).closest(".item").removeClass("edit"),$(e.target).closest(".item").next().addClass("edit"),n()}function r(e){$(e.target).closest(".item").removeClass("edit"),$(e.target).closest(".item").prev().addClass("edit"),n()}switch($(".container-items").removeClass("editing-mouse"),this.validateSaveButton(),1===$(".list-items",t).children().length&&(0==$(".inputtext").val().length?$("#button-accept-predefined-values-form",t).prop("disabled",!0):$("#button-accept-predefined-values-form",t).prop("disabled",!1)),i.toString()){case"13":if(""!==$(e.target).val()){$(e.target).closest(".item").removeClass("edit");var a=$(e.target).closest(".item").index();this.addNewItem(Math.guid(),"",a)}break;case"27":return 0!==$(e.target).closest(".item").prev().length?r(e):0!==$(e.target).closest(".item").next().length&&o(e),$(e.target).closest(".item").remove(),this.onChangeItems(e),!1;case"38":0!==$(e.target).closest(".item").prev().length&&r(e);break;case"40":0!==$(e.target).closest(".item").next().length&&o(e)}},onFocusInputItem:function(e){$(e.target).closest(".item").addClass("edit").siblings().removeClass("edit")},onFocusOutInputItem:function(e){if(""===$.trim($(e.target).val())){var t=$(e.target).closest(".item");$(t).css("display","block").empty().css("background","#E7BA99").animate({backgroundColor:"#FFF",height:"0px"},300,"linear",function(){$(this).remove()})}else $(e.target).closest(".item").removeClass("edit")},onMouseLeaveItem:function(){var e=this.dialogBox.formContent;$(".container-items",e).addClass("editing-mouse")},onClickDeleteItem:function(e){$(e.target).closest(".item").off("keyup",".inputtext",$.proxy(this.onKeyPressInputItem,this)),$(e.target).closest(".item").off("click",".item-button.delete",$.proxy(this.onClickDeleteItem,this)),$(e.target).closest(".item").remove(),this.onChangeItems(e),this.validateSaveButton()},validateSaveButton:function(){var e=this.dialogBox.formContent;$("#button-accept-predefined-values-form",e).prop("disabled",!1),(0==$(".list-items",e).children().length||1==$(".list-items",e).children().length&&0==$(".inputtext",e).length||1==$(".inputtext",e).length&&0==$(".inputtext",e).val().length)&&$("#button-accept-predefined-values-form",e).prop("disabled",!0)},addNewItem:function(e,t,i){var n=this.dialogBox.formContent;void 0===i&&-1===(i=$(".list-items .item",n).length-1)&&(i=0);var o=this.getTemplate("predefined-values-items"),r={};r.items=[{key:e,value:t}];var a=$.tmpl(o,r);$(a).addClass("edit"),0===$(".list-items",n).children().length?$(".list-items",n).append(a):$(".list-items",n).children().eq(i).after(a),$(".inputtext",a).on("change",$.proxy(this.onChangeItems,this)),setTimeout(function(){$(".list-items .item.edit",n).find(".inputtext").focus()},51)},getValueItems:function(){var e=[];return $(".list-items .inputtext",this.dialogBox.formContent).each(function(){""!==$(this).val().trim()&&e.push({key:$(this).prop("id"),value:$(this).val()})}),e},onAddNewItem:function(){$("container-items").animate({scrollTop:9999},"slow"),this.addNewItem(Math.guid(),"")},onSavePredefinedValues:function(e){e.preventDefault();var t=this,i={guid:t.adhocXpathValue&&t.adhocXpathValue.guid?t.adhocXpathValue.guid:Math.guid(),processguid:t.adhocProcessId,type:"predefined",values:JSON.stringify(t.getValueItems())},n={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:t.adhocXpathValue,newValue:i,type:t.options.name,refreshProperties:!0,removeDefaultDisplayName:!0,id:t.element.closest(".bizagi_editor_component_properties").data("id")};t.controller.publish("propertyEditorChanged",n),t.adhocXpathInput.val("Predefined"),t.adhocXpathValue=i,t.closeDialogBox(),t.closePopup()},closeDialogBox:function(){var e=this;$(".list-items",e.dialogBox.formContent).off("keyup",".inputtext",$.proxy(e.onKeyPressInputItem,e)),$(".list-items",e.dialogBox.formContent).off("focusout",".inputtext",$.proxy(e.onFocusOutInputItem,e)),$(".list-items",e.dialogBox.formContent).off("focus",".inputtext",$.proxy(e.onFocusInputItem,e)),$(".list-items",e.dialogBox.formContent).off("click",".item-button.delete",$.proxy(e.onClickDeleteItem,e)),$(".list-items",e.dialogBox.formContent).off("mouseleave",".item",$.proxy(e.onMouseLeaveItem,e)),e.dialogBox.elements.buttonAdd.off("click",$.proxy(e.onAddNewItem,e)),e.dialogBox.elements.buttonSave.off("click",$.proxy(e.onSavePredefinedValues,e)),e.dialogBox.elements.buttonCancel.off("click",$.proxy(e.closeDialogBox,e)),e.dialogBox.formContent.dialog("destroy"),e.dialogBox.formContent.detach()}}),bizagi.editor.component.editor("bizagi.editor.component.editor.adhocattribute",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n=this;n.inline=!0,t.readonly=n.options["editor-parameters"].readonly||!1,(i=$.tmpl(n.getTemplate("frame"),t)).appendTo(e),n.inputValue=t.value,$.when(t["editor-parameters"].attribs).done(function(e){n.attributesMetadata=e;new n.uiControls.comboBox({uiEditor:n,uiContainer:$(".ui-control-editor",i),uiValues:n.getDataForCombo(t.value),uiInline:n.inline,uiInitValue:-1,onChange:function(e,t){n.responseChangeCombo(e,t,n)}})})},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.adhocattribute").concat("#adhocattribute-frame"))).done(function(){e.resolve()}),e.promise()},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o},".xpath-from-adhoc-entity.xpath-image-world click":function(e,t){var i=this,n=i.element.find(".xpath-value"),o=i.positionXpathDialog(n),r={typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SELECT_XPATH_FROM_ENTITY,oldValue:i.inputValue,position:o,type:i.options.name,subproperties:i.propertiesNames,xpathValue:i.options.value,typeEditor:i.options["bas-type"],editor:i,editorParameters:i.options["editor-parameters"],id:i.element.closest(".bizagi_editor_component_properties").data("id")};i.controller.publish("propertyEditorChanged",r)},getDisplayAttribute:function(e){return this.attributesMetadata.filter(function(t){return t.attribGuid===e})[0].displayName},getDataForCombo:function(e){for(var t=[],i=0;i<this.attributesMetadata.length;i++){var n={label:this.attributesMetadata[i].displayName,value:this.attributesMetadata[i].attribGuid};switch(this.attributesMetadata[i].attribType.type){case 15:n.style="ui-bizagi-type-attribute-string";break;case 7:n.style="ui-bizagi-type-attribute-number";break;case 8:n.style="ui-bizagi-type-attribute-currency";break;case 5:n.style="ui-bizagi-type-attribute-boolean";break;case 12:n.style="ui-bizagi-type-attribute-date";break;default:n.style="ui-bizagi-type-attribute"}n.value===e&&(n.selected=!0),t.push(n)}return e||(t[0].selected=!0,this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:"",newValue:t[0].value,data:t[0].value,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})),t},responseChangeCombo:function(e,t,i){var n,o;n=i.inputValue,o=e,i.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_CHANGE_PROPERTY,oldValue:n,newValue:o,data:o,type:i.options.name,id:i.element.closest(".bizagi_editor_component_properties").data("id")}),i.inputValue=o}}),bizagi.editor.observableClass.extend("bizagi.editor.component.controlsnavigator.group.model",{},{init:function(e){this._super(),this.items=[],e&&this.processData(e)},processData:function(e){var t,i;if(e.design.visual["controls-navigator"]){switch(typeof(i=e.design.visual["controls-navigator"].group)){case"string":t=i;break;case"object":t=bizagi.editor.utilities.resolveInternalResource(i)}this.id=t,this.name=t}else this.id="default",this.name="default";this.addItem(e)},addItem:function(e){var t={id:e.name,name:bizagi.editor.utilities.resolveInternalResource(e.display),type:e.type,icon:e.icon,style:e.style};this.items.push(t)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.controlsnavigator.model",{},{init:function(){this._super(),this.controls={},this.context={form:{groups:[],hash:{}},startform:{groups:[],hash:{}},grid:{groups:[],hash:{}},offlinegrid:{groups:[],hash:{}},mobilegrid:{groups:[],hash:{}},adhocgrid:{groups:[],hash:{}},searchform:{groups:[],hash:{}},queryform:{groups:[],hash:{}},offlineform:{groups:[],hash:{}},template:{groups:[],hash:{}},layout:{groups:[],hash:{}},notVisible:{groups:[],hash:{}},adhocform:{groups:[],hash:{}},mobileform:{groups:[],hash:{}}}},processData:function(e){var t=this;$.each(e.controls,function(e,i){if(!t.controls[i.name]){var n=t.resolveGroupforControlNavigator(i.design.visual["controls-navigator"]);if(n){var o=t.getControlContext(i);o&&(o.hash[n]?(o.hash[n].addItem(i),t.controls[i.name]=o.hash[n].items[o.hash[n].items.length-1]):t.createAndAddGroupInModel(o,n,i))}}}),t.sortGroups()},resolveGroupforControlNavigator:function(e){var t="default";if(e){if("none"==e||"none"==e.group)return null;switch(typeof e.group){case"string":t=e.group;break;case"object":t=bizagi.editor.utilities.resolveInternalResource(e.group)}}return t},createAndAddGroupInModel:function(e,t,i){var n=new bizagi.editor.component.controlsnavigator.group.model(i);e.groups.push(n),e.hash[t]=n,this.controls[i.name]=n.items[0]},getControlContext:function(e){var t=this,i=e.type,n=t.publish("getContext");return"mobileColumn"===i?t.context.mobilegrid:"column"===i?t.context.grid:"offlinecolumn"===i?t.context.offlinegrid:"adhoccolumn"===i?t.context.adhocgrid:"search"===i?t.context.searchform:"query"===i?t.context.queryform:"queryInternal"===i?t.publish("isContextEntityApplication")?t.context.queryform:null:"offline"===i||"offlinecontainer"===i?t.context.offlineform:"adhoc"===i||"adhoccontainer"===i?t.context.adhocform:"layout"===i?t.context.layout:"nestedform"===i||"booleandisabled"===i?t.context.notVisible:"mobile"===i?t.context.mobileform:"container"==i?"queryform"!=n||t.isGridControl(e)?"startform"==n?t.context.startform:"mobileform"==n?t.context.mobileform:t.context.form:t.context.queryform:"startform"==n?t.context.startform:t.context.form},sortGroups:function(){var e=this;for(var t in e.context){var i=e.sortInnerGroups(e.context[t].groups);i.forEach(function(t){t.items.sort(e.sortFunction)}),e.context[t].groups=i}},sortInnerGroups:function(e){var t=[];if(0===(e=e||[]).length)return t;var i=e.find(function(e){return"Bizagi controls"===e.name}),n=e.find(function(e){return"Query controls"===e.name}),o=e.find(function(e){return"Containers"===e.name}),r=e.filter(function(e){return!["Bizagi controls","Query controls","Containers"].includes(e.name)});return i&&t.push(i),n&&t.push(n),o&&t.push(o),r&&(t=t.concat(r)),t},sortFunction:function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return i<n?-1:i>n?1:0},getControlDisplayName:function(e){return this.controls[e]?this.controls[e].name:e},isGridControl:function(e){return e.name.indexOf("grid")>=0}}),$.Class.extend("bizagi.editor.component.banner.model",{getBannerModel:function(){return this.model={banner:{displayname:bizagi.localization.getResource("formmodeler-component-banner-store-legend"),cite:bizagi.localization.getResource("formmodeler-component-banner-store-cite"),icon:"mtool-item-more-controls",on:!0}}}}),bizagi.editor.component.controller("bizagi.editor.component.xpathnavigator",{init:function(e,t){t=t||{},this._super(e),this.model=t.model,this.canvas=e,this.presenter=t.presenter,this.scope=t.scope||"form",this.MIN_HEIGHT_FLOATING_POPUP=200},loadTemplates:function(){var e={node:bizagi.getTemplate("bizagi.editor.component.xpathnavigator")+"#node","node-version":bizagi.getTemplate("bizagi.editor.component.xpathnavigator")+"#xpathnavigator-node-version",close:bizagi.getTemplate("bizagi.editor.component.xpathnavigator")+"#xpathnavigator-close",helper:bizagi.getTemplate("bizagi.editor.component.xpathnavigator")+"#xpathnavigator-helper","node-container":bizagi.getTemplate("bizagi.editor.component.xpathnavigator")+"#xpathnavigator-node-container"};return this._super(e)},updateModel:function(e){this.model=e},createFloatingCanvas:function(){var e=this,t=e.overlay=$("<div />").addClass("bizagi_editor_xpathnavigator_overlay");e.element.addClass("biz-work-panel biz-border-all biz-shadow-modal biz-border-color ui-corner-all");var i=e.presenter.publish("getMainContainer");t.appendTo(i),e.element.appendTo(t),setTimeout(function(){e.element.click(function(e){e.stopPropagation()}),$(t).one("click",function(){e.close()})},100)},render:function(e){var t,i,n,o=new $.Deferred,r=this;return t=(e=e||{}).expand||!1,r.isReadOnly="undefined"!=e.isReadOnly&&bizagi.util.parseBoolean(e.isReadOnly),r.context=e.context||"fixed",r.scope=e.scope||"form",r.filter=e.filter,r.allowDrag=void 0===e.allowDrag||e.allowDrag,r.allowDrag=!r.isReadOnly&&r.allowDrag,r.allowCollection=e.allowCollection||!1,r.isFloatingContext()&&r.createFloatingCanvas(),r.element.empty(),$.isEmptyObject(r.model)?null:($.when(r.loadTemplates()).done(function(){if(r.isFloatingContext()){r.renderCloseButton();var a=r.calculateFloatingPosition(e.position);r.element.css(a),r.element.show(),r.element.resizable({helper:"ui-resizable-helper",minHeight:r.MIN_HEIGHT_FLOATING_POPUP,minWidth:250,start:function(e,t){$(".ui-resizable-helper").css({"z-index":1001})},stop:function(e,t){}})}i=$.tmpl(r.getTemplate("node-container"),{}),r.element.append(i),n=r.element.find(".xpathnavigator-node-container"),r.renderNodes(n,r.model.rootNodes,t),$(document).ready(function(){r.togglePlusMinusIcon(r.element.find(".bizagi_editor_xpathnavigator_node").first(),!1)}),e.xpath&&r.showXpath(e.xpath),o.resolve()}),o.promise())},calculateFloatingPosition:function(e){var t=this.overlay.height(),i=this.canvas.height();return i=i<this.MIN_HEIGHT_FLOATING_POPUP?this.MIN_HEIGHT_FLOATING_POPUP:i,e.top+i>t&&(e.top-=i),e},renderCloseButton:function(){var e=$.tmpl(this.getTemplate("close"));0===this.canvas.has($(".xpathnavigator-close")).length&&e.prependTo(this.canvas)},renderNodes:function(e,t,i){var n=this,o=n.filter;$.each(t,function(t,r){"grid"===n.context?"form"!==r.nodeType&&"collection"!==r.nodeType&&n.renderNodeAndSubnodes(e,r,i):void 0===o?n.renderNodeAndSubnodes(e,r,i):n.isValidNode(r,o)&&n.renderNodeAndSubnodes(e,r,i)})},renderNodeAndSubnodes:function(e,t,i){var n,o;n=this.renderNode(e,t),t.nodes&&(o=$(n).find(".bizagi_editor_xpathnavigator_node-childs"),this.renderNodes(o,t.nodes),t.nodes.length>0&&!i&&$(n).find(".bizagi_editor_xpathnavigator_node-childs").hide())},isValidNode:function(e,t){var i=!1,n=e.nodeType,o=e.nodeSubtype;return"form"!=n&&("entity-application"==n?i=!0:e.hasRelatedEntity?("collection"!=n||"xpathtocollection"==t.typeFilter||"xpathtoentitytemplate"==t.typeFilter||this.allowCollection)&&(i=!0):this.isValidFilter(n,o,t)&&(i=!0)),i},isValidFilter:function(e,t,i){var n=i.typeFilter,o=i.types,r=!1;switch(n){case"xpathfromentity":case"xpathtosimple":for(a=0;a<o.length;a++)try{if(-1!=$.inArray(t,bizagi.editor.component.xpathnavigator.equiv.rule.xpathtosimple[o[a]])){r=!0;break}}catch(e){bizagi.logError("Equiv Error","nodeType: "+t+", types: "+o.toString())}break;case"xpathmultiple":var a;for(a=0;a<o.length;a++)try{if(-1!=$.inArray(t,bizagi.editor.component.xpathnavigator.equiv.rule.xpathmultiple[o[a]])){r=!0;break}}catch(e){bizagi.logError("Equiv Error","nodeType: "+t+", types: "+o.toString())}}return r},isFloatingContext:function(){return"floating"===this.context},renderNode:function(e,t){var i,n=$.tmpl(this.getTemplate("node"),t);return n.appendTo(e),t.formVersion&&(i=$.tmpl(this.getTemplate("node-version"),{version:t.formVersion}),$(i).insertBefore($("label",n))),this.allowDrag&&this.setDraggableNode(n,t),t.displayName.length>20&&$(n).tooltip({tooltipClass:"ui-widget-content",position:{my:"left top",at:"right+5 top-5"}}),n},setDraggableNode:function(e,t){var i=this,n=i.presenter.publish("getMainPanel");this.isFloatingContext()?i.removeDraggableOptions(e):t.enableDrag(i.scope)&&($(e).find(".bizagi_editor_xpathnavigator_data").first().data(t),$(e).find(".bizagi_editor_xpathnavigator_data").first().draggable({helper:function(e){return i.draggableHelper(e)},connectToSortable:".ui-bizagi-container-connectedSortable",distance:15,start:function(){n.addClass("bz-main-dashed-grid").addClass("ui-start-drag"),i.presenter.publish("controlRefreshCanvas",{})},stop:function(){n.removeClass("bz-main-dashed-grid").removeClass("ui-start-drag"),bizagi.util.removeAutoScroll("autoscroll","xpathnavigator"),i.presenter.publish("controlRefreshCanvas",{})},containment:"document",cursorAt:{top:-3,left:0}}))},removeDraggableOptions:function(e){$(".ui-bizagi-draggable-item",e).removeClass("ui-bizagi-draggable-item"),$(".ui-bizagi-itemfordrag ",e).removeClass("ui-bizagi-itemfordrag ")},draggableHelper:function(e){var t,i,n,o,r,a,s,l,d,c=$(e.currentTarget),u=this.presenter.publish("getMainContainer"),p=this.presenter.publish("getMainPanel");return n=c.data(),r=parseFloat($("label",c).width())+(o=parseFloat($(".biz-ico",c).eq(0).width()))+40+"px","template"==this.scope&&(r=o+5,r+="px"),(t=$.tmpl(this.getTemplate("helper"),$.extend(n,{context:this.scope}))).css("width",r),t.css("max-width",r),i=t.appendTo(u).css({zIndex:900}),l=$(".wrapper-main-panel",u),d=$(".wrapper-main-scroll",l),p.hasClass("biz-auto-height")&&(a=l.position().top+parseFloat(l.css("padding-top"))+parseFloat(l.css("margin-top"))+50,s=d.outerHeight(),bizagi.util.autoScroll(d,a,s,"xpathnavigator")),i},expandCollapse:function(e,t){var i=this,n=new $.Deferred;if(!i.actionInProgress){if(i.hasChildren(e[0]))return i.togglePlusMinusIcon(e,t),null;i.actionInProgress=!0;var o=e.data("id");return $.when(i.model.getChildren(o)).done(function(t){var o=$(e).find(".bizagi_editor_xpathnavigator_node-childs");i.renderNodes(o,t),i.togglePlusMinusIcon(e,!0),i.actionInProgress=!1,n.resolve(t)}),n.promise()}},findNode:function(e,t){return e.find("#"+t.id)},hide:function(){this.element.hide()},togglePlusMinusIcon:function(e,t){$(e).find("ul").first().is(":visible")&&!t?($(e).children("div").find(".biz-btn").children(".xpathnavigator_collapse_icon").removeClass("bz-tree-less_16x16_standard").addClass("bz-tree-show-more_16x16_standard"),$(e).children("div").find(".biz-btn").children(".xpathnavigator_collapse_icon").removeClass("xpathnavigator_collapse_icon").addClass("xpathnavigator_expand_icon"),$(e).find("ul").first().hide()):($(e).children("div").find(".biz-btn").children(".xpathnavigator_expand_icon").removeClass("bz-tree-show-more_16x16_standard").addClass("bz-tree-less_16x16_standard"),$(e).children("div").find(".biz-btn").children(".xpathnavigator_expand_icon").removeClass("xpathnavigator_expand_icon").addClass("xpathnavigator_collapse_icon"),$(e).find("ul").first().show())},findAndShowForm:function(e,t,i,n){var o,r,a,s=this,l=i.baref.ref;if(null===(void 0!==n?n.xpath.baxpath.xpath:null))if(r=t[t.length-1],null===t[t.length-1].nodes)o=$("#"+r.id,e),s.expandCollapse(o,!0).done(function(){s.showXpathByGuid(i,n)});else{if(0==r.nodes.length)throw"Query is not sending right data.";for(a=0;a<r.nodes.length;a++)if(r.nodes[a].guid==l){o=$("#"+r.nodes[a].id,e),$(".ui-state-active",s.element).removeClass("ui-state-active"),$(o).find(".bizagi_editor_xpathnavigator_data").first().addClass("ui-state-highlight"),s.element.scrollTo(".ui-state-highlight",200);break}}else if(null===t.nodes)o=$("#"+t.id),s.expandCollapse(o,!0).done(function(){s.findAndShowForm(e,t,i,n)});else if(null===(r=t.nodes[t.nodes.length-1]).nodes)o=0==(o=$("#"+r.id)).length?$("#"+t.id):o,s.expandCollapse(o,!0).done(function(){s.findAndShowForm(e,t,i,n)});else{if(0==r.nodes.length)throw"Query is not sending right data.";for(a=0;a<r.nodes.length;a++)if(r.nodes[a].guid==l){o=$("#"+r.nodes[a].id,e),$(".ui-state-active",s.element).removeClass("ui-state-active"),$(o).find(".bizagi_editor_xpathnavigator_data").first().addClass("ui-state-highlight"),s.element.scrollTo(".ui-state-highlight",200);break}}},showXpathByGuid:function(e,t){var i=void 0!==t?t.xpath.baxpath.xpath:null;$(".bizagi_editor_xpathnavigator_data").removeClass("ui-state-highlight"),null===i?this.findAndShowForm(this.element,this.model.rootNodes,e,t):this.findAndShowXpath(this.element,this.model.rootNodes,t,e)},showMetadataXpath:function(e){if($(".bizagi_editor_xpathnavigator_data").removeClass("ui-state-highlight"),"undefined"!=e){var t=[{nodes:this.model.rootNodes}];this.findAndShowXpath(this.element,t,e)}},showXpath:function(e){var t=this,i=new $.Deferred;if($(".bizagi_editor_xpathnavigator_data").removeClass("ui-state-highlight"),void 0!==e)return $.when(t.findAndShowXpath(t.element,t.model.rootNodes,e)).done(function(){t.isFloatingContext()&&t.renderCloseButton(),i.resolve()}),i.promise()},findAndShowXpath:function(e,t,i,n){var o,r,a=this,s=0,l="grid"===a.scope?t:t[0].nodes||t,d=e,c=bizagi.editor.utilities.resolveComplexXpath(i),u=c?c.split("."):[],p=new $.Deferred;for(r=u[0];;){if(!(o=a.findNodeForXpath(d,l,r))){p.resolve();break}if(s===u.length-1){p.resolve();break}if(r=r+"."+u[++s],!o.node.nodes||0===o.node.nodes.length){$.when(a.expandCollapse(o.element,!0)).done(function(e){e&&e.length?$.when(a.showXpath(i)).done(function(){p.resolve()}):p.resolve()}),o=void 0;break}l=o.node.nodes,d=$(o.element).find(".bizagi_editor_xpathnavigator_node-childs"),"true"===o.node.canHaveChildren?a.expandCollapse(o.element,!0):p.resolve()}return o&&(void 0!==n?a.findAndShowForm(o.element,o.node,n,i):a.highlightNode(o.element)),p.promise()},findNodeForXpath:function(e,t,i){var n,o,r=this;return $.each(t,function(t,a){if(n=r.findNode(e,a),a.xpath===i)return o={element:n,node:a},!1}),o},highlightNode:function(e){this.presenter.publish("getMainContainer");$(".ui-state-active",this.element).removeClass("ui-state-active"),$(e).find(".bizagi_editor_xpathnavigator_data").first().addClass("ui-state-highlight"),this.element.hasOwnProperty("scrollTo")&&this.element.scrollTo(".ui-state-highlight",200)},hasChildren:function(e){return $(e).find("ul").first().children().length>0},close:function(){this.hide(),this.publish("close"),this.isFloatingContext()&&this.overlay.detach()},onNodeRightClick:function(e,t){var i=this,n=i.model.getNode(e),o=bizagi.util.parseBoolean(n.canHaveChildren);if("floating"!=i.context&&(i.contextmenu&&i.contextmenu.destroy(),!n.parentIsGrid())){var r=$("#"+e),a=!!o&&i.expandCollapse(r,!0);$.when(a).done(function(){i.showContextMenu(n,{x:t.clientX,y:t.clientY})})}},showContextMenu:function(e,t){var i=this,n=e.getContextMenuModel(i.scope),o=i.presenter.publish("getMainContainer");return i.contextmenu=new bizagi.editor.component.contextmenu.presenter({model:n,guid:e.id,mainContainer:o}),i.contextmenu.subscribe("onItemClicked",function(t,n){i.onContextMenuItemClicked(e,n)}),i.contextmenu.render({position:t})},onContextMenuItemClicked:function(e,t){this.presenter.publish("contextMenuItemClick",{node:e,action:t.action})},".xpathnavigator-close > .bizagi_editor_xpathnavigator_container-close-image click":function(){this.close()},".bizagi_editor_xpathnavigator_data mousedown":function(e,t){var i=e.parent().data("id");if(0==t.button||1==t.button){var n=this.model.getNode(i);this.presenter.publish("nodeClick",n)}else 2==t.button&&(this.isReadOnly||this.scope&&"adhocform"===this.scope||this.onNodeRightClick(i,t))},".xpathnavigator_expand_icon, .xpathnavigator_collapse_icon click":function(e,t){t.stopImmediatePropagation();var i=e.closest(".bizagi_editor_xpathnavigator_node");this.expandCollapse(i)},".bizagi_editor_xpathnavigator_data dblclick":function(e,t){var i,n;if(!this.isReadOnly&&!$(t.target).hasClass("xpathnavigator_expand_icon")&&!$(t.target).hasClass("xpathnavigator_collapse_icon")){var o=e.closest(".bizagi_editor_xpathnavigator_node").data("id"),r=this.model.getNode(o);(r.renderType&&r.enableDrag(this.scope)||!this.model.isRootNode(r)&&this.allowCollection)&&(this.presenter.publish("nodeDoubleClick",r),$(".ui-tooltip").remove(),i=$(".wrapper-main-scroll",this.presenter.publish("getMainContainer")),bizagi.util.autoScrollBottom(i),n=$(".ui-bizagi-container-form > div:last",i),bizagi.util.highLightElement(n),e.removeClass("ui-state-active"))}}}),bizagi.editor.observableClass.extend("bizagi.editor.component.xpathnavigator.model",{view:{onlyProcessEntity:"PROCESSENTITY",allView:"All"}},{init:function(e,t){var i=this;if(i._super(),i.rootNodes=null,i.nodes=null,i.nodeHash={},i.xpathNodeHash={},i.scopeAttributesNodes={},i.xpathPromises={},i.processEntityNodes={},this.readyDefer=new $.Deferred,i.communicationProtocol=bizagi.editor.communicationprotocol.factory,e)i.initialize(e,t);else{var n=i.communicationProtocol.createProtocol({protocol:"getfirstload"});$.when(n.processRequest()).done(function(e){i.initialize(e,t)})}},initialize:function(e,t){var i=this;if(i.processEntityId=e.nodes&&e.nodes[0]&&e.nodes[0].processEntityId,i.isProcessEntity=!!i.processEntityId,i.isEmptyRootNode=t||!1,e){if(i.isProcessEntity)for(var n=0,o=e.nodes[0].nodes.length;n<o;n++){var r=e.nodes[0].nodes[n];r.guidRelatedEntity==i.processEntityId&&(i.processEntityNodes[r.guid]=r)}i.rootNodes=i.processData(e),i.nodes=i.rootNodes.length>0&&i.rootNodes[0].nodes?i.rootNodes[0].nodes.slice(0):i.nodes,e.context&&(i.context=e.context)}i.readyDefer.resolve(i)},processData:function(e){var t=this,i=[];return e.nodes&&$.each(e.nodes,function(e,n){var o=new bizagi.editor.component.xpathnavigator.node(n);if(t.canAddNode(o)&&(t.nodeHash[o.id]=o,t.processEntityNodes[o.guid]&&(t.processEntityNodes[o.guid]=o),bizagi.util.parseBoolean(o.isScopeAttribute)&&(t.scopeAttributesNodes[o.guid]=o),o.isForm()||(t.xpathNodeHash[o.xpath]=o),i.push(o),o.canHaveChildren&&0==n.nodes.length&&(n.nodes=null),n.nodes)){var r=t.processData({nodes:n.nodes});o.setChildren(r),$.each(r,function(e,t){t.setParent(o)})}}),i},ready:function(){return this.readyDefer.promise()},registerNewNodes:function(e,t){var i=this,n=(t=t||[],e&&e.getChildren()||[]);t.length>n.length||t.forEach(function(t){if(0==n.filter(function(e){return e.guid==t.guid}).length){t.nodes=t.nodes||[],t.xpath=e.xpath+"."+t.xpath;var o=i.processData({nodes:[t]})[0];o.setParent(e),e.addChild(o)}})},addChildren:function(e,t){var i=this.getNode(e),n=this.processData(t);this.isRootNode(i)&&(this.nodes=n),i.setChildren(n),$.each(n,function(e,t){t.setParent(i)})},getChildren:function(e,t){var i=this,n=i.getNode(e);if(!n)return[];var o=n.getChildren();if(o&&!t)return o;var r=new $.Deferred;n.isRootNode=this.isRootNode(n);var a=i.communicationProtocol.createProtocol({protocol:"getchildrennodes",node:n});return $.when(a.processRequest()).done(function(t){i.addChildren(e,t),r.resolve(n.getChildren())}),r.promise()},invalidateScopeAttributes:function(){for(var e in this.scopeAttributesNodes){this.scopeAttributesNodes[e].setChildren(void 0)}},searchNodeByXpath:function(e){var t=this.xpathNodeHash[e];return this.xpathPromises[e]||(this.xpathPromises[e]=this.getChildren(t.id)),this.xpathPromises[e]},getNodeByXpath:function(e){return this.xpathNodeHash[e]},getNode:function(e){return this.nodeHash[e]},getAllModel:function(){this.rootNodes.length>0&&(this.rootNodes[0].nodes=this.nodes&&this.nodes.slice(0))},getProcessEntityModel:function(){var e=[];if(this.isProcessEntity){for(var t in this.processEntityNodes)this.processEntityNodes.hasOwnProperty(t)&&e.push(this.processEntityNodes[t]);this.rootNodes[0].nodes=e}else this.getAllModel()},getProcessEntityId:function(){return this.processEntityId?this.processEntityId:null},processEntityRelated:function(e){var t=this.getNodeByXpath(e);return t&&t.parentIsProcessEntity(this.processEntityId)},getRootNode:function(){return this.rootNodes[0]},isRootNode:function(e){if(this.isEmptyRootNode)return!1;var t=this.getRootNode();return!(!t||t.guid!==e.guid||t.xpath!==e.xpath)},canAddNode:function(e){return!0},getSubModel:function(e){if("none"===e)return{ready:function(){return(new $.Deferred).resolve({})}};var t=bizagi.editor.utilities.resolveComplexXpath(e);if(null==t)return this;if(0==t.length)return this;var i=this.getNodeByXpath(t);if(i){var n=new $.Deferred,o=this.communicationProtocol.createProtocol({protocol:"getchildrennodes",node:{contextScope:i.contextScope,guidRelatedEntity:i.guidRelatedEntity,xpath:"",isRootNode:!0,style:i.style,isScopeAttribute:i.isScopeAttribute}});return $.when(o.processRequest(),i,this).done(function(e,t,i){var o=new bizagi.editor.component.xpathnavigator.model(e,!0);$.isArray(t.getChildren())&&i.registerNewNodes(t,e.nodes),n.resolve(o)}),n.promise()}return null},getSubModelByEntity:function(e,t){var i=new $.Deferred,n=this.communicationProtocol.createProtocol({protocol:"getchildrennodes",node:{contextScope:null,guidRelatedEntity:e,xpath:"",isRootNode:!0,style:null,isScopeAttribute:!1,entityContext:t}});return $.when(n.processRequest()).done(function(e){var t=new bizagi.editor.component.xpathnavigator.model(e,!0);i.resolve(t)}),i.promise()}}),bizagi.editor.observableClass.extend("bizagi.editor.component.xpathnavigator.node",{icons:{entity:"bz-studio bz-entity_16x16_standard","entity-application":"bz-studio bz-application_16x16_standard","entity-master":"bz-studio bz-master_16x16_standard","entity-stakeholder":"bz-studio bz-stakeholderentity_16x16_standard","entity-parametric":"bz-studio bz-Parametersentity_16x16_standard","entity-system":"bz-studio bz-entity_16x16_standard",number:"bz-studio bz-number_16x16_standard",form:"bz-studio bz-reusable-forms_16x16_standard",string:"bz-studio bz-textbox_16x16_standard",text:"bz-studio bz-textbox_16x16_standard",date:"bz-studio bz-date_16x16_standard",boolean:"bz-studio bz-boolean_16x16_standard",currency:"bz-studio bz-money_16x16_standard",image:"bz-studio bz-image_16x16_standard",attachment:"bz-studio bz-file-uploads_16x16_standard",float:"bz-studio bz-number_16x16_standard",uploadecm:"bz-studio bz-file-uploads-ecm_16x16_standard",collection:"bz-studio bz-direct-collections_16x16_standard","metadata-metadata":"bz-studio bz-process-filters_16x16_standard","metadata-applications":"bz-studio bz-process-filters-application_16x16_standard","metadata-process":"bz-studio bz-process-filters-process_16x16_standard","metadata-task":"bz-studio bz-process-task_16x16_standard","metadata-task-current":"bz-studio bz-process-current-task_16x16_standard","metadata-task-previous":"bz-studio bz-process-previous-task_16x16_standard","metadata-task-entry-date":"bz-studio bz-process-task-entry-date_16x16_standard","metadata-task-expiry-date":"bz-studio bz-process-task-expiry-date_16x16_standard","metadata-task-state":"bz-studio bz-process-task-state_16x16_standard","metadata-cases":"bz-studio bz-process-case_16x16_standard","metadata-case-creation-date":"bz-studio bz-case-creation-date_16x16_standard","metadata-case-creator":"bz-studio bz-case-creator_16x16_standard","metadata-case-id":"bz-studio bz-case-id_16x16_standard","metadata-case-number":"bz-studio bz-case-number_16x16_standard","metadata-case-solution-date":"bz-studio bz-case-solution-date_16x16_standard","metadata-case-state":"bz-studio bz-case-state_16x16_standard","metadata-users":"bz-studio bz-users_16x16_standard","metadata-users-creator":"bz-studio bz-users-creator_16x16_standard","metadata-users-creator-fullname":"bz-studio bz-users-creator-fullname_16x16_standard","metadata-users-creator-username":"bz-studio bz-users-creator-name_16x16_standard","metadata-users-creator-position":"bz-studio bz-users-creator-position_16x16_standard","metadata-users-currentuser":"bz-studio bz-users-current_16x16_standard","metadata-users-currentuser-fullname":"bz-studio bz-users-current-fullname_16x16_standard","metadata-users-currentuser-username":"bz-studio bz-users-current-name_16x16_standard","metadata-users-currentuser-position":"bz-studio bz-users-current-position_16x16_standard","metadata-users-previoususer":"bz-studio bz-users-previous_16x16_standard","metadata-users-previoususer-fullname":"bz-studio bz-users-previous-fullname_16x16_standard","metadata-users-previoususer-username":"bz-studio bz-users-previous-name_16x16_standard","metadata-users-previoususer-position":" bz-studio bz-users-previous-position_16x16_standard"}},{init:function(e){this._super(),this.nodes=null,this.data=e,e&&this.processData(e)},processData:function(e){var t=this;t.id=Math.guid(),t.canHaveChildren=void 0!==e.canHasChildren&&e.canHasChildren,t.displayName=e.displayName,t.guid=e.guid,t.isDraggable=void 0===e.isDragabble||e.isDragabble,t.style=e.style,t.renderType=e.renderType,t.DataType=e.DataType,t.xpath=e.xpath,t.isScopeAttribute=void 0!==e.isScopeAttribute&&e.isScopeAttribute,t.guidRelatedEntity=e.guidRelatedEntity,t.hasRelatedEntity=!(!t.guidRelatedEntity||"00000000-0000-0000-0000-000000000000"==t.guidRelatedEntity),t.contextScope=e.contextScope,t.formVersion=e.formVersion,t.maxLength=e.maxLength;var i={};i.default=e.displayName,i.displayName=e.displayName,(e.Languages||[]).forEach(function(e){i[e.code]=e.value}),t.languages=i,t.contextEntityType=e.contextEntityType,e.entityContext&&(t.entityContext=e.entityContext),e.predefinedValues&&(t.predefinedValues=e.predefinedValues),!0===t.isScopeAttribute||"true"==t.isScopeAttribute?(t.nodeType=e.style.replace("ui-bizagi-type-scope-","").replace(/(attribute)(-\w+)/g,"$1"),t.nodeSubtype=e.style.replace("ui-bizagi-type-scope-","").replace(/(attribute)(-)(\w+)/g,"$3")):(t.nodeType=e.style.replace("ui-bizagi-type-","").replace(/(attribute)(-\w+)/g,"$1"),t.nodeSubtype=e.style.replace("ui-bizagi-type-","").replace(/(attribute)(-)(\w+)/g,"$3")),t.icon=t.Class.icons[t.nodeSubtype],"true"===t.isDraggable&&(t.dragabbleClass="ui-bizagi-draggable-item ui-bizagi-itemfordrag")},getOriginalData:function(){var e=this.data;return e.nodes=[],e},setChildren:function(e){this.nodes=e},getChildren:function(){return this.nodes},addChild:function(e){this.nodes.push(e)},setParent:function(e){this.parent=e},getParent:function(){return this.parent},getDisplayName:function(){return this.displayName},getContextMenuModel:function(e){var t=this.nodeTypeContextMenuMappings[this.nodeType];var i=function(t){var i=t;if("template"==e){for(var n=[],o=0,r=t.items.length;o<r;o++)"addelement"!=t.items[o].action&&"addchildelements"!=t.items[o].action&&null==t.items[o].separator&&n.push(t.items[o]);i.items=n}return i}(this.contextMenuModels[t]);return new bizagi.editor.component.contextmenu.model(i)},setCaptionViewContextMenu:function(){var e=this.getContextMenuModel().getItemByAction("viewall");e&&(e.caption=e.caption==bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-viewall")?bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-onlycontextentity"):bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-viewall"))},enableDrag:function(e){return"grid"===e||"queryform"===e?bizagi.util.parseBoolean(this.isDraggable):!this.parentIsGrid()&&bizagi.util.parseBoolean(this.isDraggable)},parentIsGrid:function(){var e=!1;return this.parent&&(e="grid"===this.parent.renderType||this.parent.parentIsGrid()),e},parentIsProcessEntity:function(e){return!!e&&e===this.guidRelatedEntity},getMaxLength:function(){return this.maxLength},getRenderType:function(){return this.nodeSubtype},getDataType:function(){return this.DataType},setScopeAttribute:function(e){this.isScopeAttribute=e},parentIsParametricEntity:function(){var e=!1;return this.parent&&(e="ui-bizagi-type-entity-parametric"==this.parent.style||this.parent.parentIsParametricEntity()),e},isForm:function(){return this.nodeType&&"form"===this.nodeType}}),bizagi.editor.component.xpathnavigator.node.extend("bizagi.editor.component.xpathnavigator.node",{},{init:function(e){this.contextMenuModels={applicationEntity:{items:[{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-editentity"),style:"editentity",action:"editentity",icon:"bz-studio bz-edit-entity_16x16_standard"},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-viewall"),style:"viewall",action:"viewall",icon:"bz-studio view-all_16x16_standard"},{separator:!0},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-refresh"),style:"refresh",action:"refresh",icon:"bz-studio bz-refresh_16x16_standard"}]},masterEntity:{items:[{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-addelement"),style:"addelement",action:"addelement",icon:"bz-studio bz-add-element_16x16_standard"},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-addchildelements"),style:"addchildelements",action:"addchildelements",icon:"bz-studio bz-add-elements_16x16_standard"},{separator:!0},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-editentity"),style:"editentity",action:"editentity",icon:"bz-studio bz-edit-entity_16x16_standard"},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-refresh"),style:"refresh",action:"refresh",icon:"bz-studio bz-refresh_16x16_standard"}]},entity:{items:[{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-addelement"),style:"addelement",action:"addelement",icon:"bz-studio bz-add-element_16x16_standard"},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-addchildelements"),style:"addchildelements",action:"addchildelements",icon:"bz-studio bz-add-elements_16x16_standard"},{separator:!0},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-editentity"),style:"editentity",action:"editentity",icon:"bz-studio bz-edit-entity_16x16_standard"},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-editvalues"),style:"editvalues",action:"editvalues",icon:" bz-studio bz-edit-entity-values_16x16_standard"},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-refresh"),style:"refresh",action:"refresh",icon:"bz-studio bz-refresh_16x16_standard"}]},entitySystem:{items:[{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-addelement"),style:"addelement",action:"addelement",icon:"bz-studio bz-add-element_16x16_standard"},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-addchildelements"),style:"addchildelements",action:"addchildelements",icon:"bz-studio bz-add-elements_16x16_standard"},{separator:!0},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-refresh"),style:"refresh",action:"refresh",icon:"bz-studio bz-refresh_16x16_standard"}]},attribute:{items:[{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-addelement"),style:"addelement",action:"addelement",icon:"bz-studio bz-add-element_16x16_standard"}]},form:{items:[{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-newform"),style:"newform",action:"newForm",icon:"bz-studio bz-new-form_16x16_standard"}]},collection:{items:[{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-addelement"),style:"addelement",action:"addelement",icon:"bz-studio bz-add-element_16x16_standard"},{separator:!0},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-editentity"),style:"editentity",action:"editentity",icon:"bz-studio bz-edit-entity_16x16_standard"},{caption:bizagi.localization.getResource("formmodeler-component-xpathnavigator-context-menu-refresh"),style:"refresh",action:"refresh",icon:"bz-studio bz-refresh_16x16_standard"}]}},this.nodeTypeContextMenuMappings={"entity-application":"applicationEntity","entity-master":"masterEntity","entity-parametric":"entity","entity-system":"entitySystem","entity-stakeholder":"entity",attribute:"attribute",form:"form"},this._super(e)}}),$.Class.extend("bizagi.editor.component.xpathnavigator.equiv",{rule:{xpathtosimple:{boolean:["boolean"],number:["currency","number","float","oracleNumber"],date:["date"],string:["string","text"],upload:["upload","attachment"],letter:["letter"],image:["image"],uploadecm:["uploadecm"]},xpathtocollection:{xpathtocollection:["collection"]},xpathmultiple:{entity:["entity-parametric","entity-master","entity-stakeholder","entity-system"],upload:["upload","attachment"],image:["image"],uploadecm:["uploadecm"]}}},{}),bizagi.editor.observableClass.extend("bizagi.editor.component.xpathnavigator.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas||$("<div />"),this.model=e.model,this.xpathNavigator=new bizagi.editor.component.xpathnavigator(this.canvas,$.extend(e,{presenter:this}))},render:function(e){return e=e||{},this.model=e.model||this.model,this.xpathNavigator.updateModel(this.model),this.xpathNavigator.render(e)},renderPopup:function(e){var t;return e=e||{},this.model=e.model||this.model,this.xpathNavigator.updateModel(this.model),this.xpathNavigator.subscribe("close",function(){e.onClose&&e.onClose()}),t=$.extend(e,{context:"floating"}),this.xpathNavigator.render(t)},closePopup:function(){this.xpathNavigator.close()},showXpath:function(e){return this.xpathNavigator.showXpath(e)},showXpathByGuid:function(e,t){this.xpathNavigator.showXpathByGuid(e,t)},showMetadataXpath:function(e){this.xpathNavigator.showMetadataXpath(e)}}),bizagi.editor.component.controller("bizagi.editor.component.layoutnavigator",{init:function(e,t){this._super(),t=t||{},this.canvas=e,this.model=t.model,this.presenter=t.presenter},render:function(e){var t,i,n,o,r=this;e=e||{},r.isReadOnly="undefined"!=e.isReadOnly&&bizagi.util.parseBoolean(e.isReadOnly),r.element.empty(),r.showPercent=!0,$.when(r.loadTemplates()).done(function(){t=r.model,i=$.tmpl(r.getTemplate("layoutContainer"),{});for(var e=0;e<t.layouts.length;e++){if(n=$.tmpl(r.getTemplate("layoutItem"),t.layouts[e]),o=$(".bz-fm-layout-width",n),r.showPercent)for(var a=t.layouts[e].children,s=0;s<a.length;s++)layoutWidth=$.tmpl(r.getTemplate("layoutWidth"),{value:a[s].properties.width}),o.append(layoutWidth);else o.remove();i.append(n)}r.element.append(i),r.isReadOnly||r.setDraggableItems()})},updateModel:function(e){this.model=e},loadTemplates:function(){var e={layoutContainer:bizagi.getTemplate("bizagi.editor.component.layoutnavigator")+"#layout-container",layoutItem:bizagi.getTemplate("bizagi.editor.component.layoutnavigator")+"#layout-item",layoutWidth:bizagi.getTemplate("bizagi.editor.component.layoutnavigator")+"#layout-width",layoutHelper:bizagi.getTemplate("bizagi.editor.component.layoutnavigator")+"#layout-helper"};return this._super(e)},setDraggableItems:function(){var e=this,t=this.presenter.publish("getMainContainer"),i=this.presenter.publish("getMainPanel");$(".bz-fm-layout-navigator-item",t).data("self",e),$(".bz-fm-layout-navigator-item",t).draggable({helper:function(t){return e.setDraggableHelper(t)},connectToSortable:".ui-bizagi-container-connectedSortable",distance:15,start:function(){i.addClass("bz-main-dashed-grid").addClass("ui-start-drag"),e.presenter.publish("controlRefreshCanvas",{})},stop:function(){i.removeClass("bz-main-dashed-grid").removeClass("ui-start-drag"),bizagi.util.removeAutoScroll("autoscroll","layoutnavigator"),e.presenter.publish("controlRefreshCanvas",{})},containment:"document"})},setDraggableHelper:function(e){var t,i,n,o,r,a=$(e.currentTarget),s=this.presenter.publish("getMainContainer"),l=this.presenter.publish("getMainPanel");a.addClass("ui-dragging"),i=a.data("id"),n=a.data("caption"),t=a.data("self"),r=a.data("style"),a.data("type",i),a.data("display",n),o=$.tmpl(t.getTemplate("layoutHelper"),{id:i,caption:n,style:r}).appendTo(s).css({zIndex:900});var d=parseFloat($("label",o).width())+parseFloat($(".bz-fm-layout-image",o).eq(0).width())+90+"px";o.css("width",d);var c=$(".wrapper-main-panel",s),u=$(".wrapper-main-scroll",c);if(l.hasClass("biz-auto-height")){var p=c.position().top+parseFloat(c.css("padding-top"))+parseFloat(c.css("margin-top"))+50,m=u.outerHeight();bizagi.util.autoScroll(u,p,m,"layoutnavigator")}return o},".bz-fm-layout-navigator-item dblclick":function(e){var t,i,n;this.isReadOnly||(this.presenter.publish("layoutDoubleClick",{id:e.data("id")}),i=(t=$(".wrapper-main-scroll",this.presenter.publish("getMainContainer")))[0].scrollHeight,t.scrollTop(i),n=$(".ui-bizagi-container-form > div:last",t),bizagi.util.highLightElement(n))}}),bizagi.editor.observableClass.extend("bizagi.editor.component.layoutnavigator.model",{},{init:function(e){this._super(),this.layouts=[],this.processData(this.getLayoutDefinitions())},processData:function(e){var t=this;$.each(e.layouts,function(e,i){i.caption.resource&&(i.caption=bizagi.localization.getResource(i.caption.resource)),t.layouts.push(i)})},findControlById:function(e){for(var t=!1,i=0,n=this.layouts.length;i<n;i+=1)if(this.layouts[i].id===e){t=this.layouts[i];break}return t},getLayoutDefinitions:function(){return{layouts:[{caption:{resource:"formmodeler-component-editor-layoutnavigator-fulllayout"},children:[{properties:{width:"100%"},type:"panel"}],id:"full-layout",style:"bz-studio bz-layout-full_32x32_standard"},{caption:"70% - 30%",children:[{properties:{width:"70%"},type:"panel"},{properties:{width:"30%"},type:"panel"}],id:"70-30",style:"bz-studio bz-layout-70-30_32x32_standard"},{caption:"33% - 34% - 33%",children:[{properties:{width:"33%"},type:"panel"},{properties:{width:"34%"},type:"panel"},{properties:{width:"33%"},type:"panel"}],id:"33-33-33",style:"bz-studio bz-layout-33-33-33_32x32_standard"},{caption:"30% - 70%",children:[{properties:{width:"30%"},type:"panel"},{properties:{width:"70%"},type:"panel"}],id:"30-70",style:"bz-studio bz-layout-30-70_32x32_standard"},{caption:"50% - 50%",children:[{properties:{width:"50%"},type:"panel"},{properties:{width:"50%"},type:"panel"}],id:"50-50",style:"bz-studio bz-layout-50-50_32x32_standard"}]}}}),bizagi.editor.observableClass.extend("bizagi.editor.component.layoutnavigator.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas||$("<div />").addClass("bizagi_editor_layoutnavigator_container"),this.model=e.model,this.layoutNavigator=new bizagi.editor.component.layoutnavigator(this.canvas,$.extend(e,{presenter:this}))},render:function(e){return e=e||{},this.model=e.model||this.model,this.layoutNavigator.updateModel(this.model),this.layoutNavigator.render(e)}}),bizagi.editor.component.controller("bizagi.editor.component.main",{devices:{Smartphone:"smartphone_ios",Tablet:"tablet_ios",Desktop:"desktop"}},{init:function(e,t){var i=this;i._super(),t=t||{},this.canvas=e,this.presenter=t.presenter,this.model=t.model,this.params=t.params||{},this.data=this.params.data||{},this.views={},this.baseForm=null,this.channel=bizagi.editor.communicationprotocol.factory,setTimeout(function(){var e=$("#tabulator-container").height()+5;$(window).resize(function(){i.setMainHeight(e)}),i.setMainHeight(e)},10)},loadTemplates:function(){var e={mainLayout:bizagi.getTemplate("bizagi.editor.component.main")+"#main-layout",navigatorLayout:bizagi.getTemplate("bizagi.editor.component.main")+"#navigation-layout",viewContainer:bizagi.getTemplate("bizagi.editor.component.main")+"#view-container"};return this._super(e)},renderNavigator:function(e,t){var i=this;t=t||0;var n,o=$(".navigator__container");o.empty(),$.tmpl(i.getTemplate("navigatorLayout"),{data:e}).appendTo(o),t>0&&$.tmpl(i.getTemplate("viewContainer"),e[t]).appendTo($("main"));var r=o.find("li");$.each(r,function(e,o){var r=$(o);e===t&&(n=r,i.loadInstanceForm(n))}),r.bind("click",function(e){var t=$(this);if(t.hasClass("bz-fm-active-view"))return!1;e.preventDefault(),i.hideContentPanel(n),n=t,i.loadInstanceForm(n)})},render:function(){var e=this,t=e.formList=e.model.getFormList();$.when(e.loadTemplates()).done(function(){var i=$.tmpl(e.getTemplate("mainLayout"),{data:t});e.element.append(i),e.renderNavigator(t)})},tabPanel:function(e){var t=e.attr("device");return $(t)},loadInstanceForm:function(e){var t=this.tabPanel(e),i=e.index();e.addClass("bz-fm-active-view"),t.show(),this.setCurrentView(i),this.renderView(i,t)},setCurrentView:function(e){switch(this.formList[e].deviceType){case"Desktop":bizagi.form.modeler.currentView=bizagi.form.modeler.viewType.Desktop;break;case"Tablet":bizagi.form.modeler.currentView=bizagi.form.modeler.viewType.Tablet;break;case"Smartphone":bizagi.form.modeler.currentView=bizagi.form.modeler.viewType.Smartphone}},processBaseForm:function(e,t){var i=this.baseForm||new bizagi.editor.modelerView($.extend(this.params,{canvas:e,device:t}));this.baseForm=i,$.when(this.baseForm.ready(),i.loadSubModule(this.Class.devices[t])).done(function(){setTimeout(function(){var n=i.getMainContainer(),o=i.getMainPanel();switch(o.empty(),o.removeClass("view__smartphone__selector"),o.removeClass("view__tablet__selector"),t){case"Smartphone":o.addClass("view__smartphone__selector");break;case"Tablet":o.addClass("view__tablet__selector")}i.setDevice(t),i.refresh(),0===e.children().length&&e.append(n)},10)})},renderView:function(e,t){var i=this,n=i.formList[e],o=i.params,r=n.id;if(i.views[r])i.views[r].refresh();else{var a=n.deviceType,s=n.device,l=n.name,d=n.isNewForm;switch(a){case"Smartphone":i.views[r]=new bizagi.editor.modelerSmartphoneView($.extend({},i.params,{canvas:t,data:!d&&i.channel.createProtocol({protocol:"loadform",form:r}).processRequest(),idForm:r,idParentForm:o.idForm,isVersionable:!1,mustRegenerateGuids:!1,deviceName:l,device:a}));break;case"Tablet":i.views[r]=new bizagi.editor.modelerTabletView($.extend({},i.params,{canvas:t,data:!d&&i.channel.createProtocol({protocol:"loadform",form:r}).processRequest(),idForm:r,idParentForm:o.idForm,isVersionable:!1,mustRegenerateGuids:!1,deviceName:l,device:a}));break;case"Desktop":i.views[r]=new bizagi.editor.modelerView($.extend({},i.params,{canvas:t,data:!d&&i.channel.createProtocol({protocol:"loadform",form:r}).processRequest(),idForm:r,idParentForm:o.idForm,isVersionable:!1,mustRegenerateGuids:!1,deviceName:l,device:a}));break;case"Base":i.processBaseForm(t,s);break;default:return null}}},setMainHeight:function(e){var t=$(window).height()-e;$("main").height(t)},hideContentPanel:function(e){e.removeClass("bz-fm-active-view"),this.tabPanel(e).hide()},performSave:function(){this.baseForm&&this.baseForm.performSave(!0)},updateForm:function(e){this.baseForm&&this.baseForm.updateForm(e)},validateData:function(e){return!!e&&(!!e.device&&!!e.name)},".fd__addview click":function(e,t){var i=this,n=new bizagi.editor.wizard.generic.presenter;$.when(n.show(i.model.getModelView())).done(function(e){if(i.validateData(e)){i.model.addSpecificForm({deviceType:"Base",name:e.name,device:e.device,id:"6B3C37DE-7DF5-4C99-BCD2-4426B7AB242F",guid:Math.guid()});i.formList=i.model.getFormList(),i.renderNavigator(i.formList,i.formList.length-1)}})}}),bizagi.editor.observableClass.extend("bizagi.editor.component.main.presenter",{},{init:function(e){this._super(),e=e||{},this.model=new bizagi.editor.component.main.model(e),this.main=new bizagi.editor.component.main($("#root"),{presenter:this,params:e,model:this.model})},render:function(e){e=e||{},this.main.render()},performSave:function(){this.main.performSave()},updateForm:function(e){this.main.updateForm(e)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.main.model",{Desktop:["Desktop 1024 x 768","Desktop HD 1440 x 1024","Desktop 1920 x 1080"],Tablet:["Apple Ipad Mini","Apple Ipad Air","Microsoft Surface Pro","Samsung Galaxy Tab A"],Smartphone:["Apple iPhone 6","Apple iPhone X","Samsung Galaxy"]},{init:function(e){e=e||{},this.defaultBase=e.defaultBase||"89E30FD9-EC29-4F11-8F7F-6298774DC859",this.specficForms=e.specificForms&&JSON.parse(e.specificForms)||[]},getBaseForms:function(){return[{deviceType:"Base",name:"Desktop 1920 x 1080",device:"Desktop",guid:"89E30FD9-EC29-4F11-8F7F-6298774DC859",id:"6B3C37DE-7DF5-4C99-BCD2-4426B7AB242F"},{deviceType:"Base",name:"Apple Tablet Pro",device:"Tablet",guid:"706D6107-368B-48BB-BD52-9352CA3B3B2E",id:"6B3C37DE-7DF5-4C99-BCD2-4426B7AB242F"},{deviceType:"Base",name:"Apple Iphone 8",device:"Smartphone",guid:"94C67721-BC62-4816-A14C-22CEDDFD3B53",id:"6B3C37DE-7DF5-4C99-BCD2-4426B7AB242F"}]},getDefaultBase:function(){var e=this;return e.getBaseForms().filter(function(t){return t.guid===e.defaultBase})},getBaseList:function(){var e=this;return e.getBaseForms().filter(function(t){return t.guid!==e.defaultBase})},setDefaultBase:function(e){this.defaultBase=e},getFormList:function(){return this.getBaseForms().concat(this.specficForms.map(function(e){return e.isNewForm=!1,e}))},addSpecificForm:function(e){return this.specficForms.push(e)},getForms:function(e,t){return!!this.getFormList().find(function(i){return i.device===e&&i.name===t})},getModelView:function(){var e=this,t={desktop:e.Class.Desktop.filter(function(t){return!e.getForms("Desktop",t)}),tablet:e.Class.Tablet.filter(function(t){return!e.getForms("Tablet",t)}),smartphone:e.Class.Smartphone.filter(function(t){return!e.getForms("Smartphone",t)}),hasDesktop:function(){return t.desktop.length>0},hasTablet:function(){return t.tablet.length>0},hasSmartphone:function(){return t.smartphone.length>0},hasForms:function(){return t.hasDesktop()||t.hasSmartphone()||t.hasTablet()}};return t}}),$.Controller("bizagi.editor.component.commandseditor",{init:function(e,t,i){this.canvas=e,this.model=t,this.controller=i,this.tmpl={}},refresh:function(){var e=this.element;this.currentTab=$("#bz-fm-commandseditor-tabs",e).tabs("option","selected");var t=0==this.currentTab?$(".bz-fm-commandseditor-actions").parent():$(".bz-fm-commandseditor-validations").parent();this.scrollPosition=t.scrollTop(),this.render()},render:function(){var e=this,t=e.element;t.empty(),$.when(e.loadTemplates()).done(function(){var i=e.getTemplate("container");($.tmpl(i,e.model.getReadOnlyModel()).appendTo(t),$("#bz-fm-commandseditor-tabs",t).tabs({selected:e.currentTab}),e.scrollPosition)&&(0==e.currentTab?$(".bz-fm-commandseditor-actions").parent():$(".bz-fm-commandseditor-validations").parent()).scrollTop(e.scrollPosition);e.changeEnabledView(),t.disableSelection()})},changeEnabledView:function(){var e,t,i,n=this,o=n.element,r=n.model.actions;$.each(r,function(r,a){0==a.enabled&&(e="li[data-guid='"+a.guid+"']",t=o.find(e),i=$(".ui-comboBox-image-small-check",t),n.disableActionsView(t,i))});var a=n.model.validations;$.each(a,function(r,a){0==a.enabled&&(e="li[data-guid='"+a.guid+"']",t=o.find(e),i=$(".ui-comboBox-image-small-check",t),n.disableActionsView(t,i))}),n.updateEnabledAllChecked(),n.initActionSearch(),n.initValidationSearch(),n.actionPositionHandlers(),n.validationPositionHandlers(),n.initTooltips()},disableActionsView:function(e,t){var i,n=bizagi.localization.getResource("formmodeler-component-enable"),o=bizagi.localization.getResource("formmodeler-component-disable");return t.toggleClass("ui-comboBox-image-small-uncheck"),t.addClass("bz-point_16x16_standard"),e.toggleClass("bz-fm-commandseditor-component-disable"),t.hasClass("ui-comboBox-image-small-uncheck")?(t.prop("title",n),i=!1,t.removeClass("bz-point_16x16_standard"),t.addClass("bz-black"),t.addClass("bz-point_16x16_black")):(t.prop("title",o),i=!0,t.removeClass("bz-black"),t.removeClass("bz-point_16x16_black"),t.addClass("bz-point_16x16_standard")),i},initTooltips:function(){var e=this.element,t=e.find(".bz-fm-commandseditor-icons-edit"),i=e.find(".bz-fm-commandseditor-icons-delete"),n=e.find(".bz-fm-commandseditor-icons-toogle"),o=e.find(".bz-fm-commandseditor-icons-action-move-up"),r=e.find(".bz-fm-commandseditor-icons-action-move-down");t.tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip",position:{my:"left+15 center",at:"right center"}}),i.tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip",position:{my:"left+15 center",at:"right center"}}),n.tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip",position:{my:"left+15 center",at:"right center"}}),r.tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip",position:{my:"left+15 center",at:"right center"}}),o.tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip",position:{my:"left+15 center",at:"right center"}})},updateEnabledAllChecked:function(){var e=this.element,t=e.find(".bz-fm-commandseditor-action .ui-comboBox-image-small-check").length,i=e.find(".bz-fm-commandseditor-action .ui-comboBox-image-small-uncheck").length,n=$("#bz-fm-commandseditor-actions-enable-all"),o=e.find(".bz-fm-commandseditor-validation .ui-comboBox-image-small-check").length,r=e.find(".bz-fm-commandseditor-validation .ui-comboBox-image-small-uncheck").length,a=$("#bz-fm-commandseditor-validations-enable-all");t==i?n.prop("checked",!1):n.prop("checked",!0),o==r?a.prop("checked",!1):a.prop("checked",!0)},disableAllActionsView:function(e,t,i){var n=bizagi.localization.getResource("formmodeler-component-enable"),o=bizagi.localization.getResource("formmodeler-component-disable");i?(t.removeClass("bz-black"),t.removeClass("bz-point_16x16_black"),t.addClass("bz-point_16x16_standard"),e.removeClass("bz-fm-commandseditor-component-disable"),t.removeClass("ui-comboBox-image-small-uncheck"),t.prop("title",o)):(t.removeClass("bz-point_16x16_standard"),t.addClass("bz-black"),t.addClass("bz-point_16x16_black"),e.addClass("bz-fm-commandseditor-component-disable"),t.addClass("ui-comboBox-image-small-uncheck"),t.prop("title",n))},".bz-fm-commandseditor-action, .bz-fm-commandseditor-validation click":function(e){var t=this.element;$(".bz-fm-commandseditor-action, .bz-fm-commandseditor-validation",t).removeClass("bz-state-selected").removeClass("ui-state-active"),e.addClass("bz-state-selected").addClass("ui-state-active")},".bz-fm-commandseditor-action .bz-fm-commandseditor-icons-edit click":function(e){var t=e.closest(".bz-fm-commandseditor-action").data("guid");this.controller.editAction(this.model,t)},".bz-fm-commandseditor-validation .bz-fm-commandseditor-icons-edit click":function(e){var t=e.closest(".bz-fm-commandseditor-validation").data("guid");this.controller.editValidation(this.model,t)},"#bz-fm-commandseditor-actions-editor .ui-widget-actions button click":function(){this.controller.createAction(this.model)},"#bz-fm-commandseditor-validations-editor .ui-widget-actions button click":function(){this.controller.createValidation(this.model)},".bz-fm-commandseditor-action .bz-fm-commandseditor-icons-delete click":function(e){var t=this;$.when(bizagi.showConfirmationBox(bizagi.localization.getResource("formmodeler-component-delete-action-message"),"Bizagi","warning")).done(function(){var i=e.closest(".bz-fm-commandseditor-action").data("guid");t.model.deleteAction(i),t.refresh()})},".bz-fm-commandseditor-action .ui-comboBox-image-small-check click":function(e){var t=this.disableActionsView(e.parents("li").first(),e);this.updateEnabledAllChecked();var i=e.closest(".bz-fm-commandseditor-action").data("guid");this.model.changeActionStateEnabled(i,t)},"#bz-fm-commandseditor-actions-enable-all click":function(e){var t=this.element,i=t.find(".bz-fm-commandseditor-action"),n=t.find(".bz-fm-commandseditor-action .ui-comboBox-image-small-check"),o=e.is(":checked");this.disableAllActionsView(i,n,o),this.model.changeAllActionStateEnabled(o)},".bz-fm-commandseditor-validation .bz-fm-commandseditor-icons-delete click":function(e){var t=this;$.when(bizagi.showConfirmationBox(bizagi.localization.getResource("formmodeler-component-delete-validation-message"),"Bizagi","warning")).done(function(){var i=e.closest(".bz-fm-commandseditor-validation").data("guid");t.model.deleteValidation(i),t.refresh(),$("#bz-fm-commandseditor-tabs",t.element).tabs("option","active",1)})},".bz-fm-commandseditor-validation .ui-comboBox-image-small-check click":function(e){var t=this.disableActionsView(e.parents("li").first(),e);this.updateEnabledAllChecked();var i=e.closest(".bz-fm-commandseditor-validation").data("guid");this.model.changeValidationStateEnabled(i,t)},"#bz-fm-commandseditor-validations-enable-all change":function(e){var t=this.element,i=t.find(".bz-fm-commandseditor-validation"),n=t.find(".bz-fm-commandseditor-validation .ui-comboBox-image-small-check"),o=e.is(":checked");this.disableAllActionsView(i,n,o),this.model.changeAllValidationStateEnabled(o)},loadTemplates:function(){var e=new $.Deferred;return $.when(this.loadTemplate("container",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-container"))).done(function(){e.resolve()}),e.promise()},loadTemplate:function(e,t){var i=this,n=new $.Deferred;return i.tmpl[e]?(n.resolve(i.tmpl[e]),n.promise()):bizagi.templateService.getTemplate(t).done(function(t){i.tmpl[e]=t})},getTemplate:function(e){return this.tmpl[e]?this.tmpl[e]:null},actionPositionHandlers:function(){var e=this,t=e.element,i=t.find(".bz-fm-commandseditor-icons-action-move-up"),n=t.find(".bz-fm-commandseditor-icons-action-move-down");i.click(function(){var t=$(this).closest(".bz-fm-commandseditor-action"),i=$(t).prev(),n=$(t).data("guid");e.model.moveActionUp(n),$(t).insertBefore(i)}),n.click(function(){var t=$(this).closest(".bz-fm-commandseditor-action"),i=$(t).next(),n=$(t).data("guid");e.model.moveActionDown(n),$(t).insertAfter(i)})},validationPositionHandlers:function(){var e=this,t=e.element,i=t.find(".bz-fm-commandseditor-icons-validation-move-up"),n=t.find(".bz-fm-commandseditor-icons-validation-move-down");n.tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip"}),i.tooltip({tooltipClass:"ui-widget-content ui-propertybox-tooltip"}),i.click(function(){var t=$(this).closest(".bz-fm-commandseditor-validation"),i=$(t).prev(),n=$(t).data("guid");e.model.moveValidationUp(n),$(t).insertBefore(i)}),n.click(function(){var t=$(this).closest(".bz-fm-commandseditor-validation"),i=$(t).next(),n=$(t).data("guid");e.model.moveValidationDown(n),$(t).insertAfter(i)})},initActionSearch:function(){var e=this,t=e.element,i=t.find("#bz-fm-commandseditor-actions-text-to-search"),n=t.find(".bz-fm-commandseditor-action"),o=t.find("#bz-fm-commandseditor-condition"),r=t.find("#bz-fm-commandseditor-statement"),a=t.find("#bz-fm-commandseditor-elsestatement");i.change(function(){e.showActionsFound(n,i)}),o.change(function(){e.showActionsFound(n,i)}),r.change(function(){e.showActionsFound(n,i)}),a.change(function(){e.showActionsFound(n,i)})},initValidationSearch:function(){var e=this,t=e.element,i=t.find("#bz-fm-commandseditor-validations-text-to-search"),n=t.find(".bz-fm-commandseditor-validation");i.change(function(){e.showValidationsFound(n,i)})},showActionsFound:function(e,t){var i=this.element,n=i.find("#bz-fm-commandseditor-condition").is(":checked")||!1,o=i.find("#bz-fm-commandseditor-statement").is(":checked")||!1,r=i.find("#bz-fm-commandseditor-elsestatement").is(":checked")||!1,a=t.val();if(a.length>2){e.hide(),a=a.toUpperCase();for(var s=0;s<e.length;s++){var l=$(e[s]).find("span.bz-fm-commandseditor-condition-xpath.biz-highlight-1-color"),d=$(e[s]).find("[data-section='then']").find("span.bz-fm-commandseditor-statement-xpath.biz-highlight-1-color"),c=$(e[s]).find("[data-section='else']").find("span.bz-fm-commandseditor-statement-xpath.biz-highlight-1-color");if(n)for(var u=0;u<l.length;u++)if($(l[u]).html().toUpperCase().indexOf(a)>-1){$(e[s]).show();break}if(o)for(var p=0;p<d.length;p++)if($(d[p]).html().toUpperCase().indexOf(a)>-1){$(e[s]).show();break}if(r)for(var m=0;m<c.length;m++)if($(c[m]).html().toUpperCase().indexOf(a)>-1){$(e[s]).show();break}}}else""===a&&e.show()},showValidationsFound:function(e,t){this.element;var i=t.val();if(i.length>2){e.hide(),i=i.toUpperCase();for(var n=0;n<e.length;n++)for(var o=$(e[n]).find("span.bz-fm-commandseditor-condition-xpath.biz-highlight-1-color"),r=0;r<o.length;r++)if($(o[r]).html().toUpperCase().indexOf(i)>-1){$(e[n]).show();break}}else""===i&&e.show()}}),bizagi.editor.component.controller("bizagi.editor.component.baseeditor",{init:function(e,t,i,n){this._super(),this.canvas=e,this.model=t,this.controller=i,this.mainContainer=n,this.tmpl={}},refresh:function(){var e=$(".bz-fm-actionvalidationeditor",this.element);this.scrollPosition=e.scrollTop(),this.render()},render:function(){var e=this,t=e.element;t.empty(),$.when(e.loadTemplates()).done(function(){var i=e.getTemplate("container");($.tmpl(i,e.model.getViewModel()).appendTo(t),e.configureSortablePlugin(),e.scrollPosition)&&$(".bz-fm-actionvalidationeditor",e.element).scrollTop(e.scrollPosition)})},".bz-fm-commandseditor-condition-logicOperator click":function(e){var t=e.data("parent-expression");this.displayLogicOperators(e,t)},".bz-fm-commandseditor-condition-xpath click":function(e){var t=e.closest(".bz-fm-commandseditor-condition").data("guid");this.displayExpressionControls(e,t)},".bz-fm-commandseditor-condition-operator click":function(e){var t=e.closest(".bz-fm-commandseditor-condition").data("guid");this.displayOperators(e,t)},".bz-fm-commandseditor-condition-argument click":function(e){var t=e.closest(".bz-fm-commandseditor-condition").data("guid");this.displayExpressionArgument(e,t)},".bz-fm-commandseditor-condition-new click":function(e){var t=e.closest(".bz-fm-commandseditor-button-bar").data("complex-guid");this.model.addExpression(t),this.refresh()},".bz-fm-commandseditor-btn-complex click":function(e){var t=e.closest(".bz-fm-commandseditor-button-bar").data("complex-guid");return this.model.addComplexExpression(t),this.refresh(),!1},".bz-fm-commandseditor-condition .bz-fm-commandseditor-icons-delete click":function(e){var t=e.closest(".bz-fm-commandseditor-complex").closest(".bz-fm-commandseditor-condition").data("guid"),i=e.closest(".bz-fm-commandseditor-condition").data("guid");this.model.removeExpression(i,t),this.refresh()},".bz-fm-commandseditor-button-ok click":function(){var e=this.model.validate();if(e.isValid)this.publish("save",{model:this.model.getData()});else{this.refresh();var t=e.message?e.message:bizagi.localization.getResource("formmodeler-component-commandseditor-validate-requiredfields");bizagi.showMessageBox(t,"Bizagi","error",!1)}},".bz-fm-commandseditor-button-cancel click":function(){this.publish("cancel",{model:this.model})},displayExpressionControls:function(e,t){var i=this,n=i.model.getControls({appliesToRender:!0,exclude:["undefined","activityFlowButton","image"],checkContext:!0}),o=i.model.fullModel.resolveCommand(i.model.getExpression(t)),r=i.displayList(n,o,!0);r.position({my:"left top",at:"left bottom",of:e,collision:"fit flip"}),r.find("li").click(function(){var e=$(this).data("value"),n=i.model.getPropertyToUpdate(e);i.model.updateExpression(t,n,e,"xpath"!=n),i.refresh(),r.detach()})},displayOperators:function(e,t){var i=this,n=i.model.getOperators(t),o=i.model.getExpression(t).operator,r=i.displayList(n,o);r.position({my:"left top",at:"left bottom",of:e,collision:"fit flip"}),r.find("li").click(function(){var e=$(this).data("value");i.model.updateExpression(t,"operator",e),i.refresh(),r.detach()})},displayLogicOperators:function(e,t){var i=this,n=i.model.getLogicOperators(),o=i.model.getLogicOperator(t),r=i.displayList(n,o);r.position({my:"left top",at:"left bottom",of:e,collision:"none"}),r.find("li").click(function(){var e=$(this).data("value");i.model.updateLogicOperator(t,e),i.refresh(),r.detach()})},displayExpressionArgument:function(e,t){var i,n=this,o=n.model.getExpression(t).argument,r=n.model.getExpressionType(t),a=n.model.getExpression(t).xpath;(i=n.getConstantEditor(e,o,a,r,t))&&(i.render(),i.subscribe("valuechanged",function(e,o){n.model.updateExpression(t,"argument",o.value),n.model.updateExpression(t,"argumentType",o.argumentType),i.close(),n.refresh()}))},getConstantEditor:function(e,t,i,n,o){var r={templates:this.tmpl,element:e,xpath:i,value:t,mainEditor:this,mainContainer:this.mainContainer,id:o,idForm:this.model.fullModel.getIdForm()};return"boolean"==n?new bizagi.editor.component.constantargument.boolean(r):"string"==n?new bizagi.editor.component.constantargument.string(r):"date"==n?new bizagi.editor.component.constantargument.date(r):"number"==n?new bizagi.editor.component.constantargument.number(r):"entity"==n?new bizagi.editor.component.constantargument.valuepicker(r):"color"==n?new bizagi.editor.component.constantargument.color(r):"rule"==n?new bizagi.editor.component.constantargument.rule(r):"interface"==n?new bizagi.editor.component.constantargument.interface(r):"sap"==n?new bizagi.editor.component.constantargument.sap(r):"connector"==n?new bizagi.editor.component.constantargument.connector(r):"excelBot"==n?new bizagi.editor.component.constantargument.excelbot(r):null},displayList:function(e,t,i){var n=i?this.getTemplate("controlslist"):this.getTemplate("list"),o=$.tmpl(n,{list:e,currentValue:t});return o.appendTo($(document.body)),setTimeout(function(){o.click(function(e){e.stopPropagation()}),$(document).one("click",function(){o.detach()})},100),o},configureSortablePlugin:function(){},loadTemplates:function(){}}),bizagi.editor.observableClass.extend("bizagi.editor.component.constantargument.editor",{},{init:function(e){this._super(),this.templates=e.templates,this.element=e.element,this.xpath=e.xpath,this.value=e.value,this.mainEditor=e.mainEditor,this.model=e.mainEditor.model,this.displayXpathControls=!0,this.mainContainer=e.mainContainer,this.id=e.id,this.idForm=e.idForm},render:function(){var e=this,t=e.templates.argument,i=e.editor=$.tmpl(t);i.appendTo($(document.body));var n=$(".bz-fm-commandseditor-argument-editor",i);$.when(e.internalRender(n)).done(function(t){e.control=t}),e.displayXpathControls?i.find(".bz-fm-commandseditor-argument-xpath").click(function(){e.displayControls($(this))}):i.find(".bz-fm-commandseditor-argument-xpath").hide()},displayControls:function(e){var t=this,i=t.model.getControl(t.xpath),n=t.model.getControl(t.value),o=[];i&&o.push(i.type);var r={appliesToRender:!0,filterBy:o};i.relatedEntity&&$.extend(r,{filterByRelatedEntity:!0,relatedEntity:i.relatedEntity});var a=t.model.getControls(r),s=t.controlsList=t.mainEditor.displayList(a,n?n.xpath:null,!0);s.position({my:"right top",at:"right bottom",offset:"4 0",of:e,collision:"none"}),s.find("li").click(function(){var e=$(this).data("value");t.changeValue(e,"xpath")}),setTimeout(function(){s.click(function(e){e.stopPropagation()}),$(document).one("click",function(){s.detach()})},100)},floatElement:function(){var e=this,t=e.editor;t.position({my:"left top",at:"left top",of:e.element,offset:" 0 -6"}),setTimeout(function(){t.click(function(e){e.stopPropagation()}),$(document).one("click",function(){e.close()})},100),e.element.hide()},changeValue:function(e,t){t=t||"const",this.publish("valuechanged",{value:e,argumentType:t})},localizableEditor:function(e){this.publish("launchLocalizableEditor",{value:e})},close:function(){$(document).unbind("click"),this.editor&&this.editor.detach(),this.controlsList&&this.controlsList.detach(),this.element.show()}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.boolean",{},{internalRender:function(e){var t=this,i=t.templates.boolean,n=$.tmpl(i,{value:t.value});return n.appendTo(e),t.floatElement(),n.find("span").click(function(){var e=bizagi.util.parseBoolean($(this).data("value"));t.changeValue(e)}),n}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.string",{},{internalRender:function(e){var t=this,i=t.templates.string,n=$.tmpl(i,{value:t.value});n.appendTo(e),t.floatElement();var o=n.find("input");return o.focus(),o.change(function(){o.unbind("change");var e=$(this).val();0==e.length&&(e=null),t.changeValue(e)}),o.keyup(function(e){if(13==e.which){var i=$(this).val();0==i.length&&(i=null),t.changeValue(i)}}),n}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.textarea",{},{init:function(e){this._super(e),this.displayXpathControls=!1},internalRender:function(e){var t=this,i=t.templates.textarea,n=$.tmpl(i,{value:t.value});n.appendTo(e),t.floatElement();var o=n.find("textarea");o.focus(),o.keyup(function(e){if(13==e.which){var i=$(this).val();0==i.length&&(i=null),t.changeValue(i)}}),t.bindChangeEventElement(o);var r=n.find("i");return r.bind("click",function(e){t.localizableEditor(o.val())}),r.bind("mouseenter",function(){o.unbind("change")}),r.bind("mouseleave",function(){t.bindChangeEventElement(o)}),n},bindChangeEventElement:function(e){var t=this;e.bind("change",function(e){var i=$(this).val();0==i.length&&(i=null),t.changeValue(i)})}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.date",{},{internalRender:function(e){var t,i=this,n=i.templates.date,o=i.dateControl=$.tmpl(n,{value:i.value});o.appendTo(e),i.floatElement();try{t=bizagi.util.dateFormatter.getDateFromInvariant(i.value,!1)}catch(e){t=null}return o.find("div").datepicker({defaultDate:t,onSelect:function(e,t){var n=e;0==n.length&&(n=null),i.changeValue(n)}}),o},displayControls:function(e){this._super(e),this.dateControl&&this.dateControl.css("opacity",.2)}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.number",{},{internalRender:function(e){var t=this,i=t.templates.number,n=t.formatValue(t.value),o=$.tmpl(i,{value:n});o.appendTo(e),t.floatElement();var r=o.find("input");return r.numeric("."),r.focus(),r.change(function(){r.unbind("change");var e=$(this).val();0==e.length&&(e=null),t.changeValue(e)}),r.keyup(function(e){if(13==e.which){var i=$(this).val();0==i.length&&(i=null),t.changeValue(i)}}),o},formatValue:function(){return $("<label/>").html(this.value||0).asNumber()}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.entity",{},{internalRender:function(e){var t=new $.Deferred;$(".bz-fm-commandseditor-argument-editor-name",e.parent()).remove();var i=this.templates.message,n=this.model.getControl(this.xpath),o=bizagi.localization.getResource("formmodeler-component-commandseditor-argumenttype-message").replace("{0}","").split(","),r=this.message=$.tmpl(i,{preValue:o[0],entity:n.label,postValue:o[1]});return r.appendTo(e),this.floatElement(),t.resolve(r),t.promise()},displayControls:function(e){this._super(e),this.entityList&&this.entityList.css("opacity",.2)}}),bizagi.editor.component.constantargument.entity.extend("bizagi.editor.component.constantargument.valuepicker",{},{internalRender:function(e){var t=this,i=(new $.Deferred,t._super.bind(t)),n={message:bizagi.localization.getResource("formmodeler-component-wait-message-loading-form")},o=new bizagi.editor.component.wait.presenter({model:n,renderArea:$("body")}),r=bizagi.editor.utilities.resolveContextEntityFromXpath(t.xpath)||bizagi.editor.utilities.resolveScopeContextFromXpath(t.xpath),a=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"entityvaluepicker",contextEntityId:r,xpath:bizagi.editor.utilities.resolveComplexXpath(t.xpath)}),s=bizagi.editor.utilities.buildComplexReference;$.when(o.render(),a.processRequest()).done(function(n,r){if(o.destroy(),r.success){if("selectedValue"===r.key){var a={isBusinessKey:!0,businessKeyValues:r.businessKeyValues.map(function(e){return{columnId:s(e.id),columnName:e.columnName,value:e.value}}),contextEntity:s(r.contextEntity),entityValueGuid:r.surrogateKeyGuid,label:r.label};t.changeValue(a,"entity")}}else if("noParameter"===r.key)return i(e)})}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.color",{},{init:function(e){this._super(e),this.displayXpathControls=!1},internalRender:function(e){var t=this,i=t.templates.color,n=$.tmpl(i,{value:t.value});return n.appendTo(e),n.find("input").spectrum({flat:!0,color:t.value,preferredFormat:"hex",showInput:!0,cancelResponse:function(e){e.flat=!1,n.find("input").spectrum("destroy"),n.closest(".bz-fm-commandseditor-argument").remove(),t.element.show()},showPalette:!0,palette:[["black","white","red","orange"],["yellow","green","blue","purple"]],chooseText:bizagi.localization.getResource("formmodeler-component-commandseditor-ok"),cancelText:bizagi.localization.getResource("formmodeler-component-commandseditor-cancel"),change:function(e){var i=e.toName()||"#"+e.toHex();t.changeValue(i)}}),t.floatElement(),n}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.rule",{},{render:function(){var e=this,t=e.model,i={rule:{baref:{ref:"expression"}}};bizagi.editor.utilities.isObject(e.value)&&(bizagi.editor.utilities.isObject(e.value.rule)?i={rule:e.value.rule}:e.value.guid&&(i={rule:{baref:{ref:e.value.guid}}}));var n=null;if(t.isGridContext()){var o=t.getContextAction().value;n=t.getControl(o).baxpath}var r=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"ruleexpression",categorytype:"Scripting",type:"executerule",idcontextentity:n?bizagi.editor.utilities.resolveRelatedEntityFromXpath(n):null,data:i,editor:"rule"});$.when(r.processRequest()).done(function(t){if(t){var i=t.displayName;delete t.displayName,e.changeValue({rule:t,label:i})}})}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.interface",{},{render:function(){var e=this,t=e.model,i={interface:{baref:{ref:"expression"}}};bizagi.editor.utilities.isObject(e.value)&&(bizagi.editor.utilities.isObject(e.value.interface)?i={interface:e.value.interface}:e.value.guid&&(i={interface:{baref:{ref:e.value.guid}}}));var n=null;if(t.isGridContext()){var o=t.getContextAction().value;n=t.getControl(o).baxpath}var r=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"loadinterface",type:"executerule",idcontextentity:n?bizagi.editor.utilities.resolveRelatedEntityFromXpath(n):null,idscopedefinition:n?bizagi.editor.utilities.resolveContextEntityFromXpath(n):null,data:i,idForm:e.idForm});$.when(r.processRequest()).done(function(t){if(t){var i=t.displayName||"Interface";delete t.displayName,e.changeValue({interface:t,label:i})}})}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.sap",{},{render:function(){var e=this,t=e.model,i={interface:{baref:{ref:"expression"}}};bizagi.editor.utilities.isObject(e.value)&&(bizagi.editor.utilities.isObject(e.value.interface)?i={interface:e.value.interface}:e.value.guid&&(i={interface:{baref:{ref:e.value.guid}}}));var n=null;if(t.isGridContext()){var o=t.getContextAction().value;n=t.getControl(o).baxpath}var r=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"loadsapinterface",type:"rule",idcontextentity:n?bizagi.editor.utilities.resolveRelatedEntityFromXpath(n):null,idscopedefinition:n?bizagi.editor.utilities.resolveContextEntityFromXpath(n):null,data:i});$.when(r.processRequest()).done(function(t){if(t){var i=t.displayName||"sap interface";delete t.displayName,e.changeValue({interface:t,label:i})}})}}),bizagi.editor.component.constantargument.editor.extend("bizagi.editor.component.constantargument.connector",{},{render:function(e){var t=this,i=t.model,n={connector:{baref:{ref:"expression"}}};e=e||"loadconnectorinterface",bizagi.editor.utilities.isObject(t.value)&&(bizagi.editor.utilities.isObject(t.value.connector)?n={connector:t.value.connector}:t.value.guid&&(n={connector:{baref:{ref:t.value.guid}}}));var o=null;if(i.isGridContext()){var r=i.getContextAction().value;o=i.getControl(r).baxpath}e=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:e,type:"rule",idcontextentity:o?bizagi.editor.utilities.resolveRelatedEntityFromXpath(o):null,idscopedefinition:o?bizagi.editor.utilities.resolveContextEntityFromXpath(o):null,data:n,idForm:t.idForm});$.when(e.processRequest()).done(function(e){if(e){var i=e.displayName||"connector interface";delete e.displayName,t.changeValue({connector:e,label:i})}})}}),bizagi.editor.component.constantargument.connector.extend("bizagi.editor.component.constantargument.excelbot",{},{render:function(){this._super("loadexcelbotinterface")}}),bizagi.editor.observableClass.extend("bizagi.editor.component.baseeditor.model",{argumentTypes:{const:"formmodeler-component-commandseditor-argumenttype-constant",xpath:"formmodeler-component-commandseditor-argumenttype-xpath"}},{init:function(e,t){this.logicOperators=bizagi.editor.component.commandseditor.model.logicOperators,this.data=e,this.fullModel=t,this.expressions={}},resolveXpath:function(e){return this.fullModel.resolveXpath(e)},resolveCommand:function(e){return this.fullModel.resolveCommand(e)},getPropertyToUpdate:function(e){var t="xpath",i=this.fullModel.data.controls[e];return i&&i.propertyToUpdate&&(t=i.propertyToUpdate),t},getData:function(){return this.data},getControl:function(e){return e?(e=bizagi.editor.utilities.resolveComplexXpath(e),this.fullModel.getControls()[e]):null},getControls:function(e){var t=this.fullModel.getControls(),i={},n=(e=e||{}).appliesToRender||!1,o=e.appliesToContainer||!1,r=e.filterBy||null,a=e.exclude||null,s=e.checkContext||!1,l=e.filterByRelatedEntity||!1,d=null;for(var c in l&&(d=e.relatedEntity),e.checkGridContainer&&this.areThereGridAttributes(),t){var u=t[c],p=u.render,m=u.container,h=u.type,f=u.xpathContainer,g=!1;if(n&&p&&(g=!0),o&&m&&(g=!0),r){g=!1;for(var b=0;b<r.length;b++)if(r[b]==h){g=!0;break}}if(g&&a)for(b=0;b<a.length;b++)if(a[b]==h){g=!1;break}if(g&&s&&this.isGridContext())f!==this.getContextAction().value&&(g=!1);g&&(l?d===u.relatedEntity&&(i[c]={label:t[c].label,type:t[c].controlType,style:t[c].style}):i[c]={label:t[c].label,type:t[c].controlType,style:t[c].style})}return i},getOperators:function(e){var t={},i=this.getExpressionType(e);for(var n in this.operators){for(var o=!1,r=this.operators[n],a=0;a<r.appliesTo.length;a++)if(r.appliesTo[a]==i){o=!0;break}o&&(t[n]=bizagi.localization.getResource(r.label))}return t},getLogicOperators:function(){var e={};for(var t in this.logicOperators){var i=this.logicOperators[t];e[t]=bizagi.localization.getResource(i)}return e},getLogicOperator:function(e){var t=this.data;return e?this.expressions[e].complex.conditions.operator:t.conditions.operator},getExpression:function(e){return this.expressions[e].simple},getExpressionType:function(e){var t=this.expressions[e];return this.fullModel.getXpath(this.resolveXpath(this.getXpathExpression(t.simple))).type},getViewModel:function(){for(var e=this.data,t={hasErrors:!this.validate(),guid:e.guid,conditions:{expressions:[]}},i=0;i<e.conditions.expressions.length;i++){var n=i>0?this.fullModel.getLogicOperatorName(e.conditions.operator):null;t.conditions.expressions.push(this.getViewExpression(e.conditions.expressions[i],null,n))}return t},getViewExpression:function(e,t,i){var n=this;e.guid=e.guid||Math.guid(),n.expressions[e.guid]=e;var o={simple:e.simple?{xpath:{label:n.fullModel.getXpathName(n.resolveXpath(n.getXpathExpression(e.simple))),value:n.resolveXpath(e.simple.xpath)},operator:{label:n.getOperatorName(e.simple.operator),value:e.simple.operator,isUnary:n.isUnaryOperator(e.simple.operator)},argument:{label:n.fullModel.getArgumentName(e.simple.argument,e.simple.argumentType),value:e.simple.argument&&e.simple.argument.value?e.simple.argument.value:e.simple.argument},argumentType:e.simple.argumentType}:null,complex:e.complex?{conditions:{expressions:[]}}:null,logicOperator:i,parentGuid:t,guid:e.guid};if(e.complex)for(var r=0;r<e.complex.conditions.expressions.length;r++){var a=r>0?n.fullModel.getLogicOperatorName(e.complex.conditions.operator):null;o.complex.conditions.expressions.push(n.getViewExpression(e.complex.conditions.expressions[r],e.guid,a))}return o},getXpathExpression:function(e){return this.fullModel.getXpathExpression(e)},getOperatorName:function(e){return bizagi.localization.getResource(this.fullModel.getOperatorName(e,"action"))},getXpathContainer:function(){return this.xpathContainer||null},isUnaryOperator:function(e){return this.fullModel.isUnaryOperator(e,"action")},isGridContext:function(){return!1},areThereGridAttributes:function(){return!1},updateExpression:function(e,t,i,n){var o=this.expressions[e];if("xpath"==t){var r=this.getControl(i);o.simple[t]=r.baxpath,o.simple.xpathContainer=r.xpathContainer,delete o.simple.operator,delete o.simple.argument,o.simple.propertyToUpdate&&(delete o.simple[o.simple.propertyToUpdate],delete o.simple.propertyToUpdate)}else n?(r=this.getControl(i),o.simple[t]=r[t],o.simple.propertyToUpdate=t,delete o.simple.operator,delete o.simple.argument,delete o.simple.xpath):o.simple[t]=i},updateLogicOperator:function(e,t){var i=this.data;(e?this.expressions[e].complex.conditions:i.conditions).operator=t},addExpression:function(e){var t=this.data,i=e?this.expressions[e].complex.conditions.expressions:t.conditions.expressions,n=Math.guid(),o={simple:{operator:null,xpath:null,argument:null,argumentType:"const",guid:n}};i.push(o),this.expressions[n]=o},addComplexExpression:function(e){var t=this.data,i=e?this.expressions[e].complex.conditions.expressions:t.conditions.expressions,n=Math.guid(),o={complex:{conditions:{operator:"and",expressions:[{simple:{operator:null,xpath:null,argument:null,argumentType:"const",guid:n}}]}}};i.push(o),this.expressions[n]=o},removeExpression:function(e,t){var i=this.data,n=t?this.expressions[t].complex.conditions.expressions:i.conditions.expressions;delete this.expressions[e];for(var o=-1,r=0;r<n.length;r++)if(n[r].guid==e){o=r;break}o>=0&&n.splice(o,1)},setXpathContainer:function(e){this.xpathContainer=e},validate:function(e){var t=this.data,i={isValid:!0};if(this.setXpathContainer(null),0==t.conditions.expressions.length)return!1;for(var n=0;n<t.conditions.expressions.length;n++)if(!(i=this.validateExpression(t.conditions.expressions[n],e)).isValid)return i;return i},validateExpression:function(e,t){var i=this.getXpathContainer(),n={isValid:!0};if(e.simple){var o=this.getXpathExpression(e.simple);if(null==o||0==o.length)return{isValid:!1};if(null==e.simple.operator||0==e.simple.operator.length)return{isValid:!1};if(!this.fullModel.isUnaryOperator(e.simple.operator,t)&&(null==e.simple.argument||0==e.simple.argument.length))return{isValid:!1};if(null!=(i=null==i?e.simple.xpathContainer||null:i)&&null!=e.simple.xpathContainer&&i!==e.simple.xpathContainer)return{isValid:!1,message:bizagi.localization.getResource("formmodeler-component-commandseditor-validate-invalidcondition")};this.setXpathContainer(i)}else{if(0==e.complex.conditions.expressions.length)return{isValid:!1};for(var r=0;r<e.complex.conditions.expressions.length;r++)if(!(n=this.validateExpression(e.complex.conditions.expressions[r],t)).isValid)return{isValid:!1}}return n}}),bizagi.editor.component.baseeditor("bizagi.editor.component.actioneditor",{init:function(e,t,i,n){this._super(e,t,i,n)},".bz-fm-commandseditor-statement-command click":function(e){var t=e.closest(".bz-fm-commandseditor-statement").data("guid");this.displayCommands(e,t)},".bz-fm-commandseditor-statement-xpath click":function(e){var t=e.closest(".bz-fm-commandseditor-statement").data("guid");this.displayStatementControls(e,t)},".bz-fm-commandseditor-statement-argument click":function(e){var t=this,i=e.closest(".bz-fm-commandseditor-statement").data("guid");(void 0===t.model.isOpen||t.model.isOpen)&&t.displayStatementArgument(e,i),t.model.isOpen=!1,setTimeout(function(){t.model.isOpen=!0},1e3)},".bz-fm-commandseditor-statement-new click":function(e){var t=e.closest(".bz-fm-commandseditor-statements").data("section");this.model.addStatement(t),this.refresh()},".bz-fm-commandseditor-statement .bz-fm-commandseditor-icons-delete click":function(e){var t=e.closest(".bz-fm-commandseditor-statements").data("section"),i=e.closest(".bz-fm-commandseditor-statement").data("guid");this.model.removeStatement(i,t),this.refresh()},".bz-fm-commandseditor-statements-else-action click":function(e){this.displayElseActions(e)},".bz-fm-commandseditor-context-control click":function(e){this.displayContextControls(e)},displayContextControls:function(e){var t=this,i=t.model.getControls({appliesToRender:!0,filterBy:["collection"]});i.Form={label:"Form",type:"form",style:"bz-studio bz-forms_16x16_standard"};var n=t.displayList(i,t.model.getContextAction().value,!0);n.position({my:"left top",at:"left bottom",of:e,collision:"fit flip"}),n.find("li").click(function(){var e=$(this).data("value");t.model.updateContext(e),t.refresh(),n.detach()})},displayStatementControls:function(e,t){var i=this,n=i.model.fullModel.resolveCommand(i.model.getStatement(t)),o=i.model.getStatementCommand(t);if(null!=o){var r=i.model.getControls(o),a=i.displayList(r,n,!0);a.position({my:"left top",at:"left bottom",of:e,collision:"fit flip"}),a.find("li").click(function(){var e=$(this).data("value"),n=i.model.getPropertyToUpdate(e);i.model.updateStatement(t,n,e,"xpath"!==n),i.model.updateButtonsStatement(t,e),i.refresh(),a.detach()})}},displayStatementArgument:function(e,t){var i,n=this,o=n.model.getStatement(t).argument,r=n.model.getStatementType(t),a=n.model.getStatement(t).xpath;(i=n.getConstantEditor(e,o,a,r,t))&&(i.subscribe("valuechanged",function(e,o){n.model.updateStatement(t,"argument",o.value),n.model.updateStatement(t,"argumentType",o.argumentType),i.close(),n.refresh()}),i.render())},displayCommands:function(e,t){var i=this,n=i.model.getCommands(t),o=i.model.getStatement(t).command,r=i.displayList(n,o);r.position({my:"left top",at:"left bottom",of:e,collision:"fit flip"}),r.find("li").click(function(){var n=$(this).data("value");i.model.updateStatement(t,"command",n);var o=bizagi.editor.component.commandseditor.actioncommands.factory.createCommand({command:n,guid:t,model:i.model,controller:i,section:e.closest(".bz-fm-commandseditor-statements").data("section")});o&&o.execute(),i.refresh(),r.detach()})},displayElseActions:function(e){var t=this,i=t.model.getElseActions(),n=t.model.getElseAction(),o=t.displayList(i,n);o.position({my:"left top",at:"left bottom",of:e,collision:"none"}),o.find("li").click(function(){var e=$(this).data("value");t.model.updateElseAction(e),t.refresh(),o.detach()})},configureSortablePlugin:function(){var e=this,t=$(".bz-fm-commandseditor-statements",e.element);t.bind("sortstart",function(t,i){e.onSortStart(i)}),t.bind("sortstop",function(t,i){e.onSortFinish(i)}),t.sortable({items:".bz-fm-commandseditor-item",revert:!1,distance:10,cursorAt:{top:-3,left:0},placeholder:"ui-bizagi-placeholder",delay:150}).disableSelection()},onSortStart:function(e){var t=$(e.item).parent().children(".bz-fm-commandseditor-item").index(e.item);e.item.data("start-position",t)},onSortFinish:function(e){var t=$(e.item).parent().children(".bz-fm-commandseditor-item").not(".ui-sortable-placeholder").index(e.item),i=e.item.data("start-position"),n=e.item.closest(".bz-fm-commandseditor-statements").data("section");this.model.sortCommands({finalPosition:t,initialPosition:i,section:n})},loadTemplates:function(){var e=this,t=new $.Deferred;return $.when(e.loadTemplate("container",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-action")),e.loadTemplate("list",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-list")),e.loadTemplate("controlslist",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-controls-list")),e.loadTemplate("argument",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument")),e.loadTemplate("boolean",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-boolean")),e.loadTemplate("string",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-string")),e.loadTemplate("textarea",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-textarea")),e.loadTemplate("date",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-date")),e.loadTemplate("number",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-number")),e.loadTemplate("color",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-color")),e.loadTemplate("rule",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-rule")),e.loadTemplate("interface",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-interface")),e.loadTemplate("message",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-message"))).done(function(){t.resolve()}),t.promise()}}),bizagi.editor.component.baseeditor.model.extend("bizagi.editor.component.actioneditor.model",{action:"action"},{init:function(e,t){this._super(e,t),this.operators=bizagi.editor.component.commandseditor.model.operators.action,this.actionCommands=bizagi.editor.component.commandseditor.model.actionCommands,this.elseActions=bizagi.editor.component.commandseditor.model.elseActions,this.statements={},this.context=null},getData:function(){var e=this.data,t=[];if(0==e.conditions.expressions.length)return!1;for(var i=0;i<e.conditions.expressions.length;i++)this.findDependencies(e.conditions.expressions[i],t);return e.dependencies=t,e.context=this.context,e},getSelectedCommands:function(){return this.data.commands},getCommands:function(){var e={};for(var t in this.actionCommands)this.actionCommands[t].hidden||(e[t]=bizagi.localization.getResource(this.actionCommands[t].label));return e},getStatement:function(e){return this.statements[e]},getStatementType:function(e){var t=this.statements[e];if(bizagi.util.isEmpty(t.command))return null;var i=this.actionCommands[t.command].type;if("argument"==i){if(bizagi.util.isEmpty(this.resolveXpath(t.xpath)))return null;i=this.fullModel.getXpath(this.resolveXpath(t.xpath)).type}return i},getStatementCommand:function(e){for(var t=this.statements[e],i=this.actionCommands[t.command],n={label:i?i.label:"",filterBy:i.filterBy,exclude:i.exclude,checkContext:!0,checkGridContainer:!0},o=0;o<i.appliesTo.length;o++)"render"==i.appliesTo[o]&&(n.appliesToRender=!0),"container"==i.appliesTo[o]&&(n.appliesToContainer=!0);return n},getStatementProperty:function(e){var t=this.statements[e];return t&&t.propertyToUpdate?t.propertyToUpdate:"xpath"},haveAllCommandsReverse:function(){var e=this.getSelectedCommands();for(i=0;i<e.length;i++){var t=e[i].command;if(null!=t&&!this.actionCommands[t].hasReverse)return!1}return!0},verifyFormHasReverse:function(){return this.fullModel.data.flags.EnableShowAlwaysReverseAction||this.fullModel.data.enableReverse},getElseActions:function(){var e={};for(var t in this.elseActions)e[t]=bizagi.localization.getResource(this.elseActions[t]);return(!this.verifyFormHasReverse()||this.verifyFormHasReverse()&&!this.haveAllCommandsReverse())&&delete e.automatic,e},getElseAction:function(){return this.fullModel.getElseActionType(this.data)},getXpathName:function(e){return this.fullModel.getXpathName(e)},getContextAction:function(){this.context=this.context||this.data.context;var e=this.context;return e?{label:this.getXpathName(e)||e,value:e}:{label:"Form",value:"Form"}},getViewModel:function(){for(var e=this.data,t=this.getElseAction(),i=$.extend(this._super(),{commands:[],elseCommands:e.elseCommands?[]:void 0,elseAction:{label:bizagi.localization.getResource(this.elseActions[t]),value:t},context:this.getContextAction()}),n=0;n<e.commands.length;n++)i.commands.push(this.getViewCommand(e.commands[n]));if(i.elseCommands)for(var o=0;o<e.elseCommands.length;o++)i.elseCommands.push(this.getViewCommand(e.elseCommands[o]));return i},getViewCommand:function(e){var t=this;return e.guid=e.guid||Math.guid(),t.statements[e.guid]=e,{xpath:{label:t.fullModel.getXpathName(t.resolveCommand(e)),value:t.resolveCommand(e)},command:{label:bizagi.localization.getResource(t.fullModel.getCommandName(e.command)),value:e.command,isUnary:t.fullModel.isUnaryCommand(e.command),isOnlyCommand:t.fullModel.isOnlyCommand(e.command),isOnlyArgument:t.fullModel.isOnlyArgument(e.command),hidden:t.fullModel.isHiddenCommand(e.command)},argument:{label:t.fullModel.getArgumentName(e.argument,e.argumentType),value:e.argument&&e.argument.value?e.argument.value:e.argument},guid:e.guid}},updateStatement:function(e,t,i,n){var o=this.statements[e];if(this.removeAttributesStatement(o,t,n),"xpath"==t){var r=this.getControl(i);o[t]=r.baxpath,o.xpathContainer=r.xpathContainer}else o[t]=i,n&&(o.propertyToUpdate=t)},updateButtonsStatement:function(e,t){var i=this.statements[e],n=this.fullModel.data.controls[t];"activityFlowButton"===n.controlType&&(i.controlType=n.controlType)},addStatement:function(e){var t=this.data,i="then"==e?t.commands:t.elseCommands,n=Math.guid(),o={xpath:null,command:null,argument:null,argumentType:"const",guid:n};i.push(o),this.statements[n]=o},removeStatement:function(e,t){var i=this.data,n="then"==t?i.commands:i.elseCommands,o=this.statementhasDependencies(this.statements[e]);delete this.statements[e];var r=this.findCommandPosition(e,t);r>=0&&n.splice(r,1),o&&this.removeSubmitDataStatement(n,t)},statementhasDependencies:function(e){return"execute-rule"==e.command||"refresh"==e.command||"execute-interface"==e.command||"execute-connector"==e.command||"execute-excel-bot"==e.command},removeSubmitDataStatement:function(e,t){var i=-1;if(0===$.grep(e,function(e,t){return"execute-rule"==e.command||"refresh"==e.command||"execute-interface"==e.command||"execute-connector"==e.command||"execute-excel-bot"==e.command}).length){for(var n=0;n<e.length;n++)if("submit-data"==e[n].command){i=n;break}i>=0&&this.removeStatement(e[i].guid,t)}},removeAttributesStatement:function(e,t,i){"command"==t&&(delete e.argument,delete e.xpath,delete e.xpathContainer),i&&delete e.xpath,("command"==t||"xpath"==t||i)&&e.propertyToUpdate&&(delete e[e.propertyToUpdate],delete e.propertyToUpdate)},updateElseAction:function(e){var t=this.data;this.getElseAction()!=e&&(t.elseAction=e,t.elseCommands="automatic"==e?void 0:[])},isGridContext:function(){return"string"==typeof this.context&&"Form"!=this.context},areThereGridAttributes:function(){var e=!1;if(bizagi.editor.utilities.isObject(this.data.conditions)&&$.isArray(this.data.conditions.expressions))for(var t=this.data.conditions.expressions,i=0,n=t.length;i<n;i++){var o=this.findGridContainer(t[i]);if("string"==typeof o){this.gridContainer=o,e=!0;break}}return e},findGridContainer:function(e){var t=null;if(e.simple)t=e.simple.xpathContainer;else if(e.complex&&e.complex.conditions.expressions.length>0)for(var i=0;i<e.complex.conditions.expressions.length&&"string"!=typeof(t=this.findGridContainer(e.complex.conditions.expressions[i]));i++);return t},getGridContainer:function(){return this.gridContainer||null},validate:function(){var e=this.data,t=this._super(this.Class.action);if(!t.isValid)return t;0==e.commands.length&&(t.isValid=!1);for(var i=0;i<e.commands.length;i++)if(!(t=this.validateCommand(e.commands[i])).isValid)return t;if(e.elseCommands)for(var n=0;n<e.elseCommands.length;n++)if(!(t=this.validateCommand(e.elseCommands[n])).isValid)return t;return t},updateContext:function(e){this.context!=e&&(this.context=e,this.cleanModel())},cleanModel:function(){this.data.commands=[],this.data.elseCommands=[],this.data.conditions.expressions=[],this.data.conditions.operator="and",this.statements={}},validateCommand:function(e){var t=this.getStatementProperty(e.guid);return this.fullModel.isOnlyCommand(e)?{isValid:!0}:(this.fullModel.isOnlyArgument(e)||null!=e[t]&&0!=e[t].length)&&(this.fullModel.isUnaryCommand(e)||null!=e.argument&&0!=e.argument.length)?{isValid:!0}:{isValid:!1}},findDependencies:function(e,t){if(e.simple){if(e.simple.xpath&&t.push(e.simple.xpath),e.simple.propertyToUpdate&&t.push(e.simple[e.simple.propertyToUpdate]),e.simple.argument&&"xpath"==e.simple.argumentType){var i=this.getControl(e.simple.argument);i&&i.baxpath&&t.push(i.baxpath)}}else if(e.complex.conditions.expressions.length>0)for(var n=0;n<e.complex.conditions.expressions.length;n++)this.findDependencies(e.complex.conditions.expressions[n],t)},findCommandPosition:function(e,t){for(var i=this.data,n="then"==t?i.commands:i.elseCommands,o=-1,r=0,a=n.length;r<a;r++)if(n[r].guid==e){o=r;break}return o},sortCommands:function(e){var t=this.data,i="then"==e.section?t.commands:t.elseCommands;i.move(e.initialPosition,e.finalPosition),this.statementhasDependencies(i[e.finalPosition])&&this.moveSubmitDataStatement(i,e.finalPosition)},moveSubmitDataStatement:function(e,t){for(var i=-1,n=0,o=e.length;n<o;n++)if("submit-data"==e[n].command){i=n;break}i>t&&e.move(i,t)}}),bizagi.editor.component.actioneditor.model.extend("bizagi.editor.component.actioneditor.offline.model",{},{init:function(e,t){this._super(e,t),this.actionCommands=bizagi.editor.component.commandseditor.offline.model.actionCommands}}),bizagi.editor.observableClass.extend("bizagi.editor.component.commandseditor.actioncommands.base",{},{init:function(e){e=e||{},this._super(),this.args=e,this.model=e.model,this.data=this.model.data,this.controller=e.controller},execute:function(){}}),bizagi.editor.component.commandseditor.actioncommands.base.extend("bizagi.editor.component.commandseditor.actioncommands.executerule",{},{execute:function(){return!!this.existSubmitDataCommand()||(this.addSubmitDataCommand(),this.controller.refresh(),!0)},addSubmitDataCommand:function(){var e="then"==this.args.section?this.data.commands:this.data.elseCommands;this.model.addStatement(this.args.section);var t=e.pop();t.command="submit-data",e.splice(this.getPositionStatement(),0,t)},getPositionStatement:function(){for(var e=0,t="then"==this.args.section?this.data.commands:this.data.elseCommands,i=0,n=t.length;i<n;i++)if(t[i].guid===this.args.guid){e=i;break}return e},existSubmitDataCommand:function(){var e="then"==this.args.section?this.data.commands:this.data.elseCommands;return e=e.slice(0,this.getPositionStatement()),(e=$.grep(e,function(e){return"submit-data"===e.command})).length>0}}),bizagi.editor.component.commandseditor.actioncommands.executerule.extend("bizagi.editor.component.commandseditor.actioncommands.executeinterface",{},{execute:function(){return this._super()}}),bizagi.editor.component.commandseditor.actioncommands.executerule.extend("bizagi.editor.component.commandseditor.actioncommands.executesap",{},{execute:function(){return this._super()}}),bizagi.editor.component.commandseditor.actioncommands.executerule.extend("bizagi.editor.component.commandseditor.actioncommands.executeconnector",{},{execute:function(){return this._super()}}),bizagi.editor.component.commandseditor.actioncommands.executerule.extend("bizagi.editor.component.commandseditor.actioncommands.executeexcelbot",{},{execute:function(){return this._super()}}),bizagi.editor.component.commandseditor.actioncommands.executerule.extend("bizagi.editor.component.commandseditor.actioncommands.refresh",{},{execute:function(){return this._super()}}),bizagi.editor=bizagi.editor||{},bizagi.editor.component=bizagi.editor.component||{},bizagi.editor.component.commandseditor=bizagi.editor.component.commandseditor||{},bizagi.editor.component.commandseditor.actioncommands=bizagi.editor.component.commandseditor.actioncommands||{},bizagi.editor.component.commandseditor.actioncommands.factory=function(){return{createCommand:function(args){if(void 0!==args.command)try{args.command=args.command.replace(/-/g,"");var fn=eval("var bafn = function(args) {  return new bizagi.editor.component.commandseditor.actioncommands."+args.command+"(args);};bafn"),command=fn(args);return command}catch(e){return null}return null}}}(),bizagi.editor.component.baseeditor("bizagi.editor.component.validationeditor",{init:function(e,t,i,n){this._super(e,t,i,n)},".bz-fm-commandseditor-message-argument click":function(e){this.displayMessageControl(e)},displayMessageControl:function(e){var t=this,i=t.model.getMessage(),n=new bizagi.editor.component.constantargument.textarea({templates:t.tmpl,element:e,value:i,mainEditor:this,mainContainer:t.mainContainer});n.render(),n.subscribe("valuechanged",function(e,i){var o=i.value;t.model.updateMessage(o),n.close(),t.refresh()}),n.subscribe("launchLocalizableEditor",function(e,i){var o=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"multilanguage",i18n:t.model.getMessage()});$.when(o.processRequest()).done(function(e){e.i18n.default=i.value,t.model.updateMessage(e),n.close(),t.refresh()})})},loadTemplates:function(){var e=this,t=new $.Deferred;return $.when(e.loadTemplate("container",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-validation")),e.loadTemplate("list",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-list")),e.loadTemplate("controlslist",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-controls-list")),e.loadTemplate("argument",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument")),e.loadTemplate("boolean",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-boolean")),e.loadTemplate("string",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-string")),e.loadTemplate("textarea",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-textarea")),e.loadTemplate("date",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-date")),e.loadTemplate("number",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-number")),e.loadTemplate("color",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-color")),e.loadTemplate("message",bizagi.getTemplate("bizagi.editor.component.commandseditor").concat("#commands-editor-argument-message"))).done(function(){t.resolve()}),t.promise()}}),bizagi.editor.component.baseeditor.model.extend("bizagi.editor.component.validationeditor.model",{action:"validation"},{init:function(e,t){this._super(e,t),this.operators=bizagi.editor.component.commandseditor.model.operators.validation},getViewModel:function(){var e=this.data;return $.extend(this._super(),{message:bizagi.editor.utilities.resolveComplexLocalizable(e.validationCommand.message)})},getMessage:function(){return this.data.validationCommand.message},updateMessage:function(e){var t=this.data;"object"==typeof e&&e.i18n?t.validationCommand.message=e:t.validationCommand.message.i18n.default=e},getOperatorName:function(e){return this.fullModel.getOperatorName(e,"validation")},isUnaryOperator:function(e){return this.fullModel.isUnaryOperator(e,"validation")},validate:function(){var e=this.data,t=this._super(this.Class.action);if(!t.isValid)return t;var i=bizagi.editor.utilities.resolveComplexLocalizable(e.validationCommand.message);return null!=i&&0!=i.length||(t.isValid=!1),t}}),bizagi.editor.observableClass.extend("bizagi.editor.component.commandseditor.model",{operators:{action:{equals:{label:"formmodeler-component-commandseditor-operators-action-changes-to",appliesTo:["string","date","number","boolean","entity"]},"not-equals":{label:"formmodeler-component-commandseditor-operators-action-different-to",appliesTo:["string","date","number","boolean","entity"]},"less-than":{label:"formmodeler-component-commandseditor-operators-action-less-than",appliesTo:["date","number"]},"less-equals-than":{label:"formmodeler-component-commandseditor-operators-action-less-or-equal-than",appliesTo:["date","number"]},"greater-than":{label:"formmodeler-component-commandseditor-operators-action-greater-than",appliesTo:["date","number"]},"greater-equals-than":{label:"formmodeler-component-commandseditor-operators-action-greater-or-equal-than",appliesTo:["date","number"]},like:{label:"formmodeler-component-commandseditor-operators-action-like",appliesTo:["string"]},"is-empty":{label:"formmodeler-component-commandseditor-operators-action-is-empty",appliesTo:["string","date","number","boolean","entity"],isUnary:!0},"is-not-empty":{label:"formmodeler-component-commandseditor-operators-action-is-not-empty",appliesTo:["string","date","number","boolean","entity"],isUnary:!0},"is-true":{label:"formmodeler-component-commandseditor-operators-action-is-true",appliesTo:["boolean"],isUnary:!0},"is-false":{label:"formmodeler-component-commandseditor-operators-action-is-false",appliesTo:["boolean"],isUnary:!0},"does-not-contain":{label:"formmodeler-component-commandseditor-operators-action-does-not-contain",appliesTo:["string"]},contains:{label:"formmodeler-component-commandseditor-operators-action-contain",appliesTo:["string"]},"begins-with":{label:"formmodeler-component-commandseditor-operators-action-begins-with",appliesTo:["string"]},"does-not-begins-with":{label:"formmodeler-component-commandseditor-operators-action-does-not-begin-with",appliesTo:["string"]},"file-uploaded":{label:"formmodeler-component-commandseditor-operators-action-has-a-file-uploaded",appliesTo:["upload"],isUnary:!0},"file-not-uploaded":{label:"formmodeler-component-commandseditor-operators-action-has-no-file-uploaded",appliesTo:["upload"],isUnary:!0},"is-invalid-email":{label:"formmodeler-component-commandseditor-operators-action-is-an-invalid-email",appliesTo:["string"],isUnary:!0},"letter-edited":{label:"formmodeler-component-commandseditor-operators-action-has-been-edited",appliesTo:["letter"],isUnary:!0},"letter-not-edited":{label:"formmodeler-component-commandseditor-operators-action-has-not-been-edited",appliesTo:["letter"],isUnary:!0},changes:{label:"formmodeler-component-commandseditor-operators-action-has-changed",appliesTo:["string","date","number","boolean","entity","letter","upload"],isUnary:!0},"on-press":{label:"formmodeler-component-commandseditor-operators-action-on-click",appliesTo:["button"],isUnary:!0},"on-deleted-row":{label:"formmodeler-component-commandseditor-operators-action-on-deleted-row",appliesTo:["collection"],isUnary:!0}},validation:{equals:{label:"formmodeler-component-commandseditor-operators-validation-is-equal-to",appliesTo:["string","date","number","boolean","entity"]},"not-equals":{label:"formmodeler-component-commandseditor-operators-validation-is-not-equal-to",appliesTo:["string","date","number","boolean","entity"]},"less-than":{label:"formmodeler-component-commandseditor-operators-validation-less-than",appliesTo:["date","number"]},"less-equals-than":{label:"formmodeler-component-commandseditor-operators-validation-less-or-equal-than",appliesTo:["date","number"]},"greater-than":{label:"formmodeler-component-commandseditor-operators-validation-greater-than",appliesTo:["date","number"]},"greater-equals-than":{label:"formmodeler-component-commandseditor-operators-validation-greater-or-equal-than",appliesTo:["date","number"]},like:{label:"formmodeler-component-commandseditor-operators-validation-like",appliesTo:["string"]},"is-empty":{label:"formmodeler-component-commandseditor-operators-validation-is-empty",appliesTo:["string","date","number","boolean","entity"],isUnary:!0},"is-not-empty":{label:"formmodeler-component-commandseditor-operators-validation-is-not-empty",appliesTo:["string","date","number","boolean","entity"],isUnary:!0},"is-true":{label:"formmodeler-component-commandseditor-operators-validation-is-true",appliesTo:["boolean"],isUnary:!0},"is-false":{label:"formmodeler-component-commandseditor-operators-validation-is-false",appliesTo:["boolean"],isUnary:!0},"begins-with":{label:"formmodeler-component-commandseditor-operators-validation-begins-with",appliesTo:["string"]},"does-not-contain":{label:"formmodeler-component-commandseditor-operators-validation-does-not-contain",appliesTo:["string"]},contains:{label:"formmodeler-component-commandseditor-operators-validation-contain",appliesTo:["string"]},"does-not-begins-with":{label:"formmodeler-component-commandseditor-operators-validation-does-not-begins-with",appliesTo:["string"]},"file-uploaded":{label:"formmodeler-component-commandseditor-operators-validation-has-a-file-uploaded",appliesTo:["upload"],isUnary:!0},"file-not-uploaded":{label:"formmodeler-component-commandseditor-operators-validation-has-no-files-uploaded",appliesTo:["upload"],isUnary:!0},"is-invalid-email":{label:"formmodeler-component-commandseditor-operators-validation-invalid-email",appliesTo:["string"],isUnary:!0},"letter-edited":{label:"formmodeler-component-commandseditor-operators-validation-has-been-edited",appliesTo:["letter"],isUnary:!0},"letter-not-edited":{label:"formmodeler-component-commandseditor-operators-validation-has-not-been-edited",appliesTo:["letter"],isUnary:!0},changes:{label:"formmodeler-component-commandseditor-operators-action-has-changed",appliesTo:["string","date","number","boolean","entity","letter","upload"],isUnary:!0},"on-press":{label:"formmodeler-component-commandseditor-operators-action-on-click",appliesTo:["button"],isUnary:!0},"on-deleted-row":{label:"formmodeler-component-commandseditor-operators-action-on-deleted-row",appliesTo:["collection"],isUnary:!0}}},logicOperators:{and:"formmodeler-component-commandseditor-logicoperators-and",or:"formmodeler-component-commandseditor-logicoperators-or"},actionCommands:{"background-color":{label:"formmodeler-component-commandseditor-actioncommands-set-background-color",appliesTo:["render","container"],exclude:["nestedform"],type:"color",hasReverse:!0},forecolor:{label:"formmodeler-component-commandseditor-actioncommands-set-forecolor-color",appliesTo:["render"],exclude:["collection"],type:"color",hasReverse:!0},visible:{label:"formmodeler-component-commandseditor-actioncommands-changes-visibility-for",appliesTo:["render","container"],type:"boolean",hasReverse:!0},readonly:{label:"formmodeler-component-commandseditor-actioncommands-changes-editability-for",appliesTo:["render","container"],exclude:["undefined","button"],type:"boolean",hasReverse:!0},required:{label:"formmodeler-component-commandseditor-actioncommands-set-required-for",appliesTo:["render"],exclude:["collection","undefined","button","activityFlowButton"],type:"boolean",hasReverse:!0},"set-value":{label:"formmodeler-component-commandseditor-actioncommands-set-value-for",appliesTo:["render"],exclude:["collection","undefined","button","activityFlowButton"],type:"argument",hasReverse:!1},"set-min":{label:"formmodeler-component-commandseditor-actioncommands-set-minimum-value-for",appliesTo:["render"],filterBy:["number","date"],type:"argument",hasReverse:!1},"set-max":{label:"formmodeler-component-commandseditor-actioncommands-set-maximum-value-for",appliesTo:["render"],filterBy:["number","date"],type:"argument",hasReverse:!1},collapse:{label:"formmodeler-component-commandseditor-actioncommands-collapse",appliesTo:["container"],filterBy:["group"],type:"boolean",hasReverse:!0},"set-active":{label:"formmodeler-component-commandseditor-actioncommands-set-as-active",appliesTo:["container"],filterBy:["tabItem"],isUnary:!0,hasReverse:!1},refresh:{label:"formmodeler-component-commandseditor-actioncommands-refresh",appliesTo:["render","container"],exclude:["activityFlowButton"],isUnary:!0,hasReverse:!1},"execute-rule":{label:"formmodeler-component-commandseditor-actioncommands-execute-rule",appliesTo:["render","container"],isOnlyArgument:!0,type:"rule",hasReverse:!1},"execute-interface":{label:"formmodeler-component-commandseditor-actioncommands-execute-interface",appliesTo:["render","container"],isOnlyArgument:!0,type:"interface",hasReverse:!1},"execute-sap":{label:"formmodeler-component-commandseditor-actioncommands-execute-sap",appliesTo:["render","container"],isOnlyArgument:!0,type:"sap",hasReverse:!1},"execute-connector":{label:"formmodeler-component-commandseditor-actioncommands-execute-connector",appliesTo:["render","container"],isOnlyArgument:!0,type:"connector",hasReverse:!1},"execute-excel-bot":{label:"formmodeler-component-commandseditor-actioncommands-execute-excel-bot",appliesTo:["render","container"],isOnlyArgument:!0,type:"excelBot",hasReverse:!1},"submit-data":{label:"formmodeler-component-commandseditor-actioncommands-submit-data",appliesTo:["render","container"],isOnlyCommand:!0,hasReverse:!1,hidden:!0},"clean-data":{label:"formmodeler-component-commandseditor-actioncommands-clean-data",appliesTo:["render"],exclude:["collection","undefined","button","activityFlowButton"],isUnary:!0,hasReverse:!1},"trigger-click":{label:"formmodeler-component-commandseditor-actioncommands-trigger-click",appliesTo:["render"],filterBy:["activityFlowButton"],isUnary:!0,hasReverse:!0}},elseActions:{actions:"formmodeler-component-commandseditor-elseactions-actions",none:"formmodeler-component-commandseditor-elseactions-none",automatic:"formmodeler-component-commandseditor-elseactions-automatic"}},{init:function(e){this._super(),this.actions={},this.validations={},this.data=e,this.processData(e),this.operators=this.Class.operators,this.logicOperators=this.Class.logicOperators,this.actionCommands=this.Class.actionCommands,this.isReadOnly="undefined"!=e.isReadOnly&&bizagi.util.parseBoolean(e.isReadOnly)},processData:function(e){for(var t,i=0;i<e.actions.length;i++){var n=e.actions[i];n.guid?t=n.guid:n.guid=t=Math.guid(),this.actions[t]=n}for(var o=0;o<e.validations.length;o++){var r=e.validations[o];r.guid?t=r.guid:r.guid=t=Math.guid(),this.validations[t]=r}},getDataModel:function(){return this.data},getAction:function(e){return this.actions[e]},getElseActionType:function(e){return e.elseAction?e.elseAction:e.elseCommands?e.elseCommands.length>0?"actions":"none":"automatic"},getValidation:function(e){return this.validations[e]},getControls:function(){return this.data.controls},getReadOnlyModel:function(){for(var e,t=this.data,i={actions:[],validations:[],isReadOnly:this.isReadOnly},n=0;n<t.actions.length;n++)i.actions.push(this.getReadOnlyAction(t.actions[n]));for(e=0;e<t.validations.length;e++)t.validations[e].inherent||i.validations.push(this.getReadOnlyValidation(t.validations[e]));for(e=0;e<t.validations.length;e++)t.validations[e].inherent&&i.validations.push(this.getReadOnlyValidation(t.validations[e]));return i},getReadOnlyAction:function(e){var t=this.getElseActionType(e);e.isValid=!0;for(var i={guid:e.guid,conditions:{expressions:[]},commands:[],elseAction:{label:bizagi.localization.getResource(this.Class.elseActions[t]),value:t},elseCommands:e.elseCommands?[]:void 0,isReadOnly:this.isReadOnly},n=0;n<e.conditions.expressions.length;n++){var o=n>0?this.getLogicOperatorName(e.conditions.operator):null,r=this.getReadOnlyExpression(e.conditions.expressions[n],o,"action");e.isValid=e.isValid&&r.isValid,i.conditions.expressions.push(r)}for(var a=0;a<e.commands.length;a++){var s=this.getReadOnlyCommand(e.commands[a]);e.isValid=e.isValid&&s.isValid,i.commands.push(s)}if(e.elseCommands)for(var l=0;l<e.elseCommands.length;l++)s=this.getReadOnlyCommand(e.elseCommands[l]),e.isValid=e.isValid&&s.isValid,i.elseCommands.push(s);return i},getReadOnlyValidation:function(e){e.isValid=!0;for(var t={guid:e.guid,conditions:{expressions:[]},validationCommand:{message:bizagi.editor.utilities.resolveComplexLocalizable(e.validationCommand.message)},inherent:e.inherent||!1,isReadOnly:this.isReadOnly},i=0;i<e.conditions.expressions.length;i++){var n=i>0?this.getLogicOperatorName(e.conditions.operator):null,o=this.getReadOnlyExpression(e.conditions.expressions[i],n,"validation");e.isValid=e.isValid&&o.isValid,t.conditions.expressions.push(o)}return t},getReadOnlyExpression:function(e,t,i){var n=this,o={simple:e.simple?{xpath:n.getXpathName(n.resolveXpath(n.getXpathExpression(e.simple))),operator:n.getOperatorName(e.simple.operator,i),argument:n.isUnaryOperator(e.simple.operator,i)?null:n.getArgumentName(e.simple.argument,e.simple.argumentType)}:null,complex:e.complex?{conditions:{expressions:[]}}:null,logicOperator:t,isValid:!0};if(e.simple&&(o.isValid="object"==typeof n.getControls()[n.resolveXpath(e.simple.xpath)]),e.complex)for(var r=0;r<e.complex.conditions.expressions.length;r++){var a=r>0?n.getLogicOperatorName(e.complex.conditions.operator):null,s=n.getReadOnlyExpression(e.complex.conditions.expressions[r],a,i);o.complex.conditions.expressions.push(s),o.isValid=o.isValid&&s.isValid}return o},getReadOnlyCommand:function(e){var t=this;return{xpath:t.getXpathName(t.resolveCommand(e)),command:t.getCommandName(e.command),argument:t.getArgumentName(e.argument,e.argumentType),isValid:"object"==typeof t.getControls()[t.resolveXpath(e.xpath)],isUnary:t.isUnaryCommand(e.command),isOnlyArgument:t.isOnlyArgument(e.command),isOnlyCommand:t.isOnlyCommand(e.command),hidden:t.isHiddenCommand(e.command)}},getLogicOperatorName:function(e){return bizagi.util.isEmpty(e)?"":bizagi.localization.getResource(this.logicOperators[e])},getOperatorName:function(e,t){return void 0===e||bizagi.util.isEmpty(e)||!this.operators[t][e]?"":bizagi.localization.getResource(this.operators[t][e].label)},getIdForm:function(){return this.data.idForm},isUnaryOperator:function(e,t){return!bizagi.util.isEmpty(e)&&(this.operators[t][e]&&(this.operators[t][e].isUnary||!1))},isUnaryCommand:function(e){return null!=e&&("string"==typeof e&&e?this.actionCommands[e].isUnary||!1:"object"==typeof e&&e.command&&this.actionCommands[e.command].isUnary||!1)},isOnlyCommand:function(e){return null!=e&&("string"==typeof e&&e?this.actionCommands[e].isOnlyCommand||!1:"object"==typeof e&&e.command&&this.actionCommands[e.command].isOnlyCommand||!1)},isOnlyArgument:function(e){return null!=e&&("string"==typeof e&&e?this.actionCommands[e].isOnlyArgument||!1:"object"==typeof e&&e.command&&this.actionCommands[e.command].isOnlyArgument||!1)},isHiddenCommand:function(e){return null!=e&&("string"==typeof e&&e?this.actionCommands[e].hidden||!1:"object"==typeof e&&e.command&&this.actionCommands[e.command].hidden||!1)},resolveXpath:function(e){return e?bizagi.editor.utilities.resolveComplexXpath(e):null},resolveCommand:function(e){return e.xpath?this.resolveXpath(e.xpath):e.propertyToUpdate?e[e.propertyToUpdate]:void 0},getXpathName:function(e){return bizagi.util.isEmpty(e)?"":this.data.controls[e]?this.data.controls[e].label:""},getXpathExpression:function(e){return e.propertyToUpdate?e[e.propertyToUpdate]:e.xpath},getXpath:function(e){return bizagi.util.isEmpty(e)?"":this.data.controls[e]},getArgumentName:function(e,t){return void 0===e||null==e?null:"const"!=t&&"entity"!=t||void 0===e?this.getXpathName(this.resolveXpath(e)):e.label?e.label:e},getCommandName:function(e){return bizagi.util.isEmpty(e)||!this.actionCommands[e]?"":bizagi.localization.getResource(this.actionCommands[e].label)},createEmptyAction:function(){return{guid:Math.guid(),conditions:{operator:"and",expressions:[]},commands:[],elseCommands:[]}},addAction:function(e,t){this.data.actions.push(t),this.actions[e]=t},updateAction:function(e,t){for(var i=this.data,n=0;n<i.actions.length;n++)i.actions[n].guid==e&&(i.actions[n]=t);this.actions[e]=t},createEmptyValidation:function(){var e=Math.guid();return{guid:e,conditions:{operator:"and",expressions:[]},validationCommand:{message:bizagi.editor.utilities.buildComplexLocalizable("",e,"message")}}},changeActionStateEnabled:function(e,t){for(var i=this.data,n=-1,o=0;o<i.actions.length;o++)if(i.actions[o].guid==e){n=o;break}n>=0&&(i.actions[n].enabled=t)},changeAllActionStateEnabled:function(e){for(var t=this.data,i=0;i<t.actions.length;i++)t.actions[i].enabled=e},changeValidationStateEnabled:function(e,t){for(var i=this.data,n=-1,o=0;o<i.validations.length;o++)if(i.validations[o].guid==e){n=o;break}n>=0&&(i.validations[n].enabled=t)},changeAllValidationStateEnabled:function(e){for(var t=this.data,i=0;i<t.validations.length;i++)t.validations[i].enabled=e},addValidation:function(e,t){this.data.validations.push(t),this.validations[e]=t},updateValidation:function(e,t){for(var i=this.data,n=0;n<i.validations.length;n++)i.validations[n].guid==e&&(i.validations[n]=t);this.validations[e]=t},deleteAction:function(e){var t=this.data;delete this.actions[e];for(var i=-1,n=0;n<t.actions.length;n++)if(t.actions[n].guid==e){i=n;break}i>=0&&t.actions.splice(i,1)},deleteValidation:function(e){var t=this.data;delete this.validations[e];for(var i=-1,n=0;n<t.validations.length;n++)if(t.validations[n].guid==e){i=n;break}i>=0&&t.validations.splice(i,1)},getInvalidElements:function(){return this.getReadOnlyModel(),{actions:$.grep(this.data.actions,function(e,t){return!e.isValid}),validations:$.grep(this.data.validations,function(e,t){return!e.isValid})}},moveActionUp:function(e){for(var t=this.data,i=-1,n=0;n<t.actions.length;n++)if(t.actions[n].guid==e){i=n;break}if(i>=0){var o=t.actions[i];t.actions.splice(i,1),t.actions.splice(i-1,0,o)}},moveActionDown:function(e){for(var t=this.data,i=-1,n=0;n<t.actions.length;n++)if(t.actions[n].guid==e){i=n;break}if(i>=0){var o=t.actions[i];t.actions.splice(i,1),t.actions.splice(i+1,0,o)}},moveValidationUp:function(e){for(var t=this.data,i=-1,n=0;n<t.validations.length;n++)if(t.validations[n].guid==e){i=n;break}if(i>=0){var o=t.validations[i];t.validations.splice(i,1),t.validations.splice(i-1,0,o)}},moveValidationDown:function(e){for(var t=this.data,i=-1,n=0;n<t.validations.length;n++)if(t.validations[n].guid==e){i=n;break}if(i>=0){var o=t.validations[i];t.validations.splice(i,1),t.validations.splice(i+1,0,o)}}}),bizagi.editor.component.commandseditor.model.extend("bizagi.editor.component.commandseditor.offline.model",{actionCommands:{"background-color":{label:"formmodeler-component-commandseditor-actioncommands-set-background-color",appliesTo:["render","container"],exclude:["nestedform"],type:"color",hasReverse:!0},forecolor:{label:"formmodeler-component-commandseditor-actioncommands-set-forecolor-color",appliesTo:["render"],exclude:["collection"],type:"color",hasReverse:!0},visible:{label:"formmodeler-component-commandseditor-actioncommands-changes-visibility-for",appliesTo:["render","container"],type:"boolean",hasReverse:!0},readonly:{label:"formmodeler-component-commandseditor-actioncommands-changes-editability-for",appliesTo:["render","container"],exclude:["undefined"],type:"boolean",hasReverse:!0},required:{label:"formmodeler-component-commandseditor-actioncommands-set-required-for",appliesTo:["render"],exclude:["collection","undefined","button"],type:"boolean",hasReverse:!0},"set-value":{label:"formmodeler-component-commandseditor-actioncommands-set-value-for",appliesTo:["render"],exclude:["collection","undefined","button"],type:"argument",hasReverse:!1},"set-min":{label:"formmodeler-component-commandseditor-actioncommands-set-minimum-value-for",appliesTo:["render"],filterBy:["number","date"],type:"argument",hasReverse:!1},"set-max":{label:"formmodeler-component-commandseditor-actioncommands-set-maximum-value-for",appliesTo:["render"],filterBy:["number","date"],type:"argument",hasReverse:!1},collapse:{label:"formmodeler-component-commandseditor-actioncommands-collapse",appliesTo:["container"],filterBy:["group"],type:"boolean",hasReverse:!0},"set-active":{label:"formmodeler-component-commandseditor-actioncommands-set-as-active",appliesTo:["container"],filterBy:["tabItem"],isUnary:!0,hasReverse:!1},"clean-data":{label:"formmodeler-component-commandseditor-actioncommands-clean-data",appliesTo:["render"],filterBy:["entity"],isUnary:!0,hasReverse:!1}}},{init:function(e){this._super(e),this.actionCommands=this.Class.actionCommands}}),bizagi.editor.observableClass.extend("bizagi.editor.component.commandseditor.presenter",{},{init:function(){this._super()},show:function(e){var t=new $.Deferred,i=this.createModelFactory(e),n=this.publish("getMainContainer"),o=this.popup=bizagi.createPopup({name:"bz-fm-commandseditor",container:n,title:bizagi.localization.getResource("formmodeler-component-commandseditor-displayname"),center:!0,onClose:function(){t.resolve(i.getDataModel())}});return this.configureDraggablePlugin(o.fullPopup,n),this.commandsEditor=new bizagi.editor.component.commandseditor(o.content,i,this),this.commandsEditor.render(),t.promise()},createModelFactory:function(e){var t=this.publish("getContext");return"form"===t?new bizagi.editor.component.commandseditor.model(e):"offlineform"===t?new bizagi.editor.component.commandseditor.offline.model(e):"queryform"===t?new bizagi.editor.component.commandseditor.offline.model(e):"startform"==t?new bizagi.editor.component.commandseditor.model(e):void 0},createAction:function(e){var t=this;t.hidePopup();var i=t.publish("getMainContainer"),n=bizagi.localization.getResource("formmodeler-component-commandseditor-action-editor-title"),o=bizagi.createPopup({name:"bz-fm-actionvalidationeditor",container:i,title:n,center:!0,onClose:function(){t.showPopup()}});t.configureDraggablePlugin(o.fullPopup,i);var r=e.createEmptyAction(),a=t.createActionModelFactory(r,e),s=new bizagi.editor.component.actioneditor(o.content,a,t,i);s.render(),s.subscribe("cancel",function(){t.showPopup(),o.close()}),s.subscribe("save",function(i,n){e.addAction(n.model.guid,n.model),t.showPopup(),o.close(),t.commandsEditor.refresh()})},editAction:function(e,t){var i=this;i.hidePopup();var n=i.publish("getMainContainer"),o=bizagi.createPopup({name:"bz-fm-actionvalidationeditor",container:n,title:"Edit action",center:!0,onClose:function(){i.showPopup()}});i.configureDraggablePlugin(o.fullPopup,n);var r=bizagi.clone(e.getAction(t)),a=i.createActionModelFactory(r,e),s=new bizagi.editor.component.actioneditor(o.content,a,i,n);s.render(),s.subscribe("cancel",function(){i.showPopup(),o.close()}),s.subscribe("save",function(n,r){e.updateAction(t,r.model),i.showPopup(),o.close(),i.commandsEditor.refresh()})},createActionModelFactory:function(e,t){var i=this.publish("getContext");return"form"==i?new bizagi.editor.component.actioneditor.model(e,t):"offlineform"==i?new bizagi.editor.component.actioneditor.offline.model(e,t):"queryform"==i?new bizagi.editor.component.actioneditor.offline.model(e,t):"startform"==i?new bizagi.editor.component.actioneditor.model(e,t):void 0},createValidation:function(e){var t=this;t.hidePopup();var i=t.publish("getMainContainer"),n=bizagi.localization.getResource("formmodeler-component-commandseditor-validation-editor-title"),o=bizagi.createPopup({name:"bz-fm-actionvalidationeditor",container:i,title:n,center:!0,onClose:function(){t.showPopup()}});t.configureDraggablePlugin(o.fullPopup,i);var r=e.createEmptyValidation(),a=new bizagi.editor.component.validationeditor.model(r,e),s=new bizagi.editor.component.validationeditor(o.content,a,t,i);s.render(),s.subscribe("cancel",function(){t.showPopup(),o.close()}),s.subscribe("save",function(i,n){e.addValidation(n.model.guid,n.model),t.showPopup(),o.close(),t.commandsEditor.refresh(),$("#bz-fm-commandseditor-tabs",t.commandsEditor.element).tabs("option","active",1)})},editValidation:function(e,t){var i=this;i.hidePopup();var n=i.publish("getMainContainer"),o=bizagi.createPopup({name:"bz-fm-actionvalidationeditor",container:n,title:"Edit validation",center:!0,onClose:function(){i.showPopup()}});i.configureDraggablePlugin(o.fullPopup,n);var r=bizagi.clone(e.getValidation(t)),a=new bizagi.editor.component.validationeditor.model(r,e),s=new bizagi.editor.component.validationeditor(o.content,a,i,n);s.render(),s.subscribe("cancel",function(){i.showPopup(),o.close()}),s.subscribe("save",function(n,r){e.updateValidation(t,r.model),i.showPopup(),o.close(),i.commandsEditor.refresh(),$("#bz-fm-commandseditor-tabs",i.commandsEditor.element).tabs("option","active",1)})},hidePopup:function(){this.popup.fullPopup.hide()},showPopup:function(){this.popup.fullPopup.show()},configureDraggablePlugin:function(e,t){e.draggable({containment:t,delay:100,distance:5,handle:".ui-popup-header"})}}),bizagi.editor.observableClass.extend("bizagi.editor.component.properties.model",{rulePropertiesHash:["defaultvalue.rule","defaultvalue.rule90","daterange.maxrule","daterange.maxrule90","daterange.minrule","daterange.minrule90","buttonrule","buttonrule.rule","buttonrule.rule90","data.filter.rule","editable.rule","editable.rule90","visible.rule","visible.rule90","required.rule","required.rule90"]},{init:function(e){this._super(),e&&(this.disableProperties=e.disableProperties,this.initModel(e)),this.communicationProtocol=bizagi.editor.communicationprotocol.factory},initModel:function(e){var t=this,i=t.model={idRender:"",elements:[]};t.externalProperties=t.populateExternalProperties(e),t.indexedProperties={},t.designProperties=e.design.properties;var n=e.design.visual["property-box"];if(n.tabs){var o=[];$.each(n.tabs,function(e,i){var n={id:i.id,caption:bizagi.editor.utilities.resolveInternalResource(i.caption)};n.elements=t.initElements({elements:i.elements}),o.push(n)}),i.elements.push({tabs:o})}else i.elements=t.initElements({elements:n.elements})},initElements:function(e){var t=this,i=e.elements||[],n=e.prefix,o=e.applyIndexing||!0,r=[];return o=void 0===o||o,$.each(i,function(e,a){var s=a.type||i[e].type,l=null;if("property"==s){if(t.propertyIsEnabled(a.value)){var d=t.getDesignProperty(a.value);if($.isEmptyObject(d))throw"The visual property ("+a.value+") doesn't exist. External properties: "+JSON.stringify(t.externalProperties);var c=a.value||a.name;l={"bas-type":d["bas-type"]||a["bas-type"],name:n?n+"."+c:c,required:d.required||{},caption:bizagi.editor.utilities.resolveInternalResource(d.caption)||a.caption,"user-editable":d["user-editable"]||a["user-editable"],value:a.dataValue||null,"editor-parameters":d["editor-parameters"]?t.processEditorParameters(d):a["editor-parameters"]||{},default:d.default,deprecated:d.deprecated||!1},o&&(t.indexedProperties[l.name]=l),d.subproperties&&t.processSubproperties(l.name,d,l)}}else l={id:a.id,caption:bizagi.editor.utilities.resolveInternalResource(a.caption)},void 0!==a.exclusive&&$.extend(l,{exclusive:!0}),void 0!==a.visibility&&$.extend(l,{visibility:a.visibility});if(l){a.elements&&(l.elements=t.initElements({elements:a.elements}));var u={};u[s]=l,r.push(u)}}),r},getDesignProperty:function(e){if(-1===e.indexOf("."))return this.designProperties[e]||{};var t=e.split(".");return t.length>1?this.designProperties[t[0]].subproperties[t[1]]:{}},processEditorParameters:function(e){var t,i,n=!1;for(t in e["editor-parameters"]){if(e["editor-parameters"][t].rule){n=!0;break}}if(n)for(t in i={},e["editor-parameters"])if(e["editor-parameters"][t].rule){var o=e["editor-parameters"][t].rule;if(-1!=o.search(/^<.*>$/)){var r=(o=o.substring(1,o.length-1)).split(":");if(r.length>1&&"design"==r[0]){var a=r[1];if(void 0===r[2]){var s=this.designProperties[a];i[t]={value:void 0!==s.value|null!=s.value?s.value:"true"===s.default,rule:e["editor-parameters"][t].rule}}}}}else i[t]=e["editor-parameters"][t];else i=e["editor-parameters"];return i},processSubproperties:function(e,t,i){var n,o,r,a=[];for(n in t.subproperties)o=t.subproperties[n],r={value:n,type:"property"},this.designProperties[n]=o,a.push(r);i.subproperties=this.initElements({elements:a,applyIndexing:!1,prefix:e})},process:function(e){var t=this;for(var i in t.model.idRender=e.guid,t.model.element=e,t.indexedProperties){var n=t.indexedProperties[i];n.value=null,t.isLayoutContainer(n)&&t.updateLayoutProperty(e,i),e.isText()&&t.isSpecialProperty(n.name)&&t.updateDefaultValueProperty(e,n,i),t.isActiveContainerProperty(n)&&t.updateActiveContainerProperty(e,n),t.updatePropertyModel(e,n,i)}return t.model},isForm:function(e){return"form"===e["bas-type"]||"searchform"===e["bas-type"]},isLayoutContainer:function(e){return"change-layout"===e["bas-type"]||"changelayout"===e["bas-type"]},isLocalizableProperty:function(e){return"localizable-string"===e["bas-type"]||"localizablestring"===e["bas-type"]},isActiveContainerProperty:function(e){return"active-container"===e["bas-type"]||"activecontainer"===e["bas-type"]},updateLayoutProperty:function(e,t){var i={elements:[]};e.elements&&$.each(e.elements,function(e,t){var n=t.properties.width||"0%";i.elements.push({index:e,width:n})}),e.properties[t]=i},updatePropertyModel:function(e,t,i){var n=bizagi.editor.component.properties.commands.factory;(t.show=!0,t.notShow=void 0,this.isRuleProperty(i))&&n.createRuleCommand({command:i,element:e,key:i}).execute();var o=n.createCommand({command:i,element:e,key:i,indexedProperty:t});o&&o.execute();var r=bizagi.editor.utilities.resolveProperty(e.properties,i);bizagi.editor.utilities.isObject(r)&&(r=bizagi.clone(r),r=this.resolveObjectProperty(t,r)),t.value=r,!t.value&&t.deprecated&&bizagi.override.enableDeprecatedProperties&&(t.show=!1)},updateDefaultValueProperty:function(e,t,i){t.default=e.getDefaultValueProperty(i)},updateActiveContainerProperty:function(e,t){var i=e.getChildren();t["editor-parameters"]=t["editor-parameters"]||{},t["editor-parameters"].values=i.length>0?$.map(i,function(e,t){return{label:e.resolveDisplayNameProperty(),value:e.guid,icon:"tab"}}):[]},resolveObjectProperty:function(e,t){return this.isLocalizableProperty(e)&&(t=this.resolveResource(t.i18n,bizagi.editorLanguage.key)),t},resolveResource:function(e,t){if(!e)return"";if("string"==typeof e)return e;if(t=t||bizagi.language,!e.languages)return e.default;for(;null==e.languages[t]&&t.length>0;){var i=t.split("-");i.pop(),t=i.join("-")}return 0==t.length||null==e.languages[t]?e.default:e.languages[t]},isSpecialProperty:function(e){return"maxlength"===e},populateExternalProperties:function(e){return{renderCaption:bizagi.editor.utilities.resolveInternalResource(e.display)}},getCaption:function(e){return this.indexedProperties[e]&&this.indexedProperties[e].caption?this.indexedProperties[e].caption:e},isRuleProperty:function(e){return this.Class.rulePropertiesHash.indexOf(e)>=0},propertyIsEnabled:function(e){return $.inArray(e,this.disableProperties)<0}}),bizagi.editor.component.controller("bizagi.editor.component.gridcolumneditor",{init:function(e,t){t=t||{},this._super(e),this.model=t.model,this.canvas=e,this.renderArea=t.renderArea,this.presenter=t.presenter,this.options=t.options,this.element=t.element},loadTemplates:function(){var e={gridcolumneditor:bizagi.getTemplate("bizagi.editor.component.gridcolumneditor")+"#gridcolumneditor-container",helper:bizagi.getTemplate("bizagi.editor.component.gridcolumneditor")+"#column-helper"};return this._super(e)},refresh:function(e){this.render(e)},render:function(e){var t=this;e=e||{},t.options=$.extend(t.options,e.options),e.gridModel&&t.model.update(e.gridModel),t.createOverlay(),$.when(t.loadTemplates()).done(function(){var i=t.element.find("#bz-fm-grid-columneditor");i.length&&i.remove();var n=t.renderGrid();t.canAdjustColumnWidth()&&t.renderGridWidths(e.gridModel),t.activeState(e,n)})},destroy:function(){this.overlay.detach(),this.renderArea.removeClass("bz-edit-mode"),this.presenter.publish("close"),$(window).unbind("resize.grid");var e=this.element.find("#bz-fm-grid-columneditor");e.length&&e.remove()},createOverlay:function(){if(this.overlay)return this.overlay;var e=this.overlay=$("<div />");return e.height(this.renderArea.get(0).scrollHeight),e.addClass("bz-grid-columneditor-container-main"),this.renderArea.addClass("bz-edit-mode"),e.appendTo(this.renderArea),this.canvas.appendTo(e),e},renderGrid:function(){var e,t;return t=this.model.getViewModel(),(e=this.grid=$.tmpl(this.getTemplate("gridcolumneditor"),t)).appendTo(this.element),0===t.columns.length?e.addClass("ui-drop-here-layout"):e.removeClass("ui-double-drop-here-layout"),e.find(".ui-icon").css("background-image","url('')"),bizagi.form.modeler.params.reviewMode||this.addGridSortBehaviour(e.find(".bz-fm-grid-table")),this.bindEvents(e),e},canAdjustColumnWidth:function(){return"Smartphone"!==this.presenter.getDevice()},renderGridWidths:function(){var e=this.model.model;$.each($(".bz-grid-column",this.grid),function(t,i){var n=e.columns[t];if(n.columnwidth){var o=n.columnwidth,r=parseInt(o).toString(),a=o.substring(r.length,o.length);$(i).css({width:r+a,"flex-grow":"initial"})}})},addGridSortBehaviour:function(e){var t=this;e.sortable({items:".ui-bizagi-draggable-item",revert:!0,connectWith:".ui-bizagi-container-connectedSortable",cursorAt:{top:-3,left:0},placeholder:"bz-fm-grid-columneditor-placeholder-custom",delay:0,helper:t.onDraggableHelper.bind(t)}),e.disableSelection(),e.bind("sortstart",function(e,i){t.onSortStart(e,i)}),e.bind("sortactivate",function(e,i){t.onSortActivate(e,i)}),e.bind("sortstop",function(e,i){t.onSortStop(e,i)})},activeState:function(e,t){var i=e.guidSelected;if($.isArray(i)&&i.length>0){for(var n=0,o=i.length;n<o;n++)$('div[data-id="'+i[n]+'"]',t).addClass("ui-state-active");this.presenter.publish("processSelectedColumns",{refresh:!0})}},onDraggableHelper:function(e,t){var i=this.model.getDisplayNameByColumnId(t.data("id"));e.stopPropagation();var n=$.tmpl(this.getTemplate("helper"),{caption:i});n.appendTo(document.body).css({zIndex:2900});var o=parseFloat(n.find("label").width()+40||100);return n.css({width:o}),n},onSortStart:function(e,t){e.stopPropagation();var i=$(t.item).parent().children(".ui-bizagi-itemfordrag").index(t.item);this.initialPosition=i},onSortActivate:function(e,t){e.stopPropagation(),$(t.item).hasClass("mtool-item")?(this.sourceData=$(t.item).data("render"),this.source="controlsNavigator"):$(t.item).hasClass("bizagi_editor_xpathnavigator_data")?(this.sourceData=$(t.item).data(),this.source="xpathNavigator"):this.source="gridColumnEditor"},onSortStop:function(e,t){var i=this,n=i.initialPosition,o=i.source,r=i.sourceData;e.stopPropagation();var a=$(t.item).parent().children(".ui-bizagi-itemfordrag").not(".ui-sortable-placeholder").index(t.item);i.finalPosition=a,"gridColumnEditor"==o?(i.model.moveColumn(n,a),i.presenter.publish("moveColumn",{guid:i.model.getGuid(),data:r,initialPosition:n,finalPosition:a})):"controlsNavigator"==o?(i.model.insertControlColumn(a,r),i.presenter.publish("insertControl",{guid:i.model.getGuid(),data:r,position:a})):"xpathNavigator"==o&&(i.model.insertXpathColumn(a,r),i.presenter.publish("insertXpath",{guid:i.model.getGuid(),data:r,position:a})),i.refresh()},selectColumn:function(e,t){var i=e.offset(),n={position:{top:i.top,left:i.left,width:e.outerWidth(),height:e.outerHeight()},element:e,guid:e.data("id"),type:"column",grid:this.model.guid};void 0!==t&&$.extend(n,{ctrlIsPressed:!0}),this.presenter.publish("updateDesignAttributesColumn",{guid:e.data("id"),property:"columnwidth",attributes:{isWidthColumnEditable:this.model.isWidthColumnEditable(e.data("id")),percentMaxWidth:this.model.getPercentMaxWidth(e.data("id"))}}),this.presenter.publish("selectColumn",n)},unselectColumn:function(e){this.presenter.publish("unselectColumn",e)},showContextMenu:function(e,t){var i={position:t,guid:e,type:"column",grid:this.model.guid};this.presenter.publish("showContextMenu",i)},bindEvents:function(e){e.find(".biz-action-btn.biz-btn-cancel").click(this.onCancel.bind(this)),e.find(".biz-action-btn.biz-btn-ok").click(this.onOk.bind(this)),e.find(".bz-grid-column").click(this.onColumnClicked.bind(this)),e.find(".bz-grid-column").on("mousedown",this.onColumnMouseDown.bind(this))},onCancel:function(e){e.stopPropagation(),this.presenter.publish("cancelChangesInModel",{gridModel:this.model.originalModel}),this.destroy()},onOk:function(e){e.stopPropagation(),this.presenter.publish("performValidationsInModel",{originalGridModel:this.model.originalModel,model:this.model.getViewModel()})},onColumnClicked:function(e){var t=$(e.currentTarget);e.stopPropagation(),this.presenter.publish("checkCtrlKey",{})?(t.toggleClass("ui-state-active"),t.hasClass("ui-state-active")?this.selectColumn(t,!0):this.unselectColumn({guid:t.data("id"),ctrlIsPressed:!0})):($("#bz-fm-grid-columneditor .bz-grid-column").not(t).removeClass("ui-state-active"),t.toggleClass("ui-state-active"),t.hasClass("ui-state-active")?this.selectColumn(t):this.unselectColumn())},onColumnMouseDown:function(e){if(2==e.button){var t=$(e.currentTarget);return this.showContextMenu(t.data("id"),{x:e.clientX,y:e.clientY}),e.preventDefault(),e.stopPropagation(),!1}return!0}}),bizagi.editor.observableClass.extend("bizagi.editor.component.gridcolumneditor.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas||$("<div />"),this.element=e.element,this.device=e.device,this.model=new bizagi.editor.component.gridcolumneditor.model(e.gridModel),this.gridcolumneditor=new bizagi.editor.component.gridcolumneditor(this.canvas,{model:this.model,presenter:this,renderArea:e.renderArea,element:this.element})},getDevice:function(){return this.device},getGuid:function(){return this.model.getGuid()},refresh:function(e){this.gridcolumneditor.refresh(e)},render:function(e){this.gridcolumneditor.render(e)},destroy:function(){this.gridcolumneditor.destroy()}}),bizagi.editor.observableClass.extend("bizagi.editor.component.gridcolumneditor.model",{},{init:function(e){this.model={columns:[]},this.guid=e.guid,this.originalModel=bizagi.clone(e),this.model.columns=this.processModel(e)},getGuid:function(){return this.guid},getDisplayNameByColumnId:function(e){var t=this.model.columns.find(function(t){return t.guid===e});return t?t.displayName:""},update:function(e){this.model.columns=this.processModel(e)},processModel:function(e){var t=[];if(!e)return t;if(e.elements.length>0)for(var i=0;i<e.elements.length;i++){var n=e.elements[i];t.push({guid:n.guid,displayName:bizagi.editor.utilities.resolvei18n(n.properties.displayName),xpath:n.properties.xpath,type:n.type,columnwidth:n.properties.columnwidth})}return t},getViewModel:function(){return this.model},insertControlColumn:function(e,t){var i={guid:Math.guid(),displayName:t.caption,type:t.type};return this.model.columns.splice(e,0,i),i},insertXpathColumn:function(e,t){var i={guid:Math.guid(),displayName:t.displayName,xpath:bizagi.editor.utilities.buildComplexXpath(t.xpath,t.contextScope,t.isScopeAttribute,t.guidRelatedEntity)};return this.model.columns.splice(e,0,i),i},moveColumn:function(e,t){this.model.columns.move(e,t)},deleteColumn:function(e){for(var t=0,i=this.model.columns.length;t<i;t+=1)if(this.model.columns[t].guid===e){this.model.columns.splice(t,1);break}},isWidthColumnEditable:function(e){if(1==$.grep(this.model.columns,function(e,t){return null==e.columnwidth||"auto"==e.columnwidth}).length){for(var t=0,i=this.model.columns.length;t<i;t+=1){var n=this.model.columns[t].columnwidth;if("auto"==n||null==n&&e==this.model.columns[t].guid)return!1}return!0}return!0},getPercentMaxWidth:function(e){for(var t=100,i=0,n=this.model.columns.length;i<n;i+=1){var o=this.model.columns[i].columnwidth;o&&o.indexOf("%")>=0&&e!=this.model.columns[i].guid&&(t-=parseInt(o))}return t}}),bizagi.editor.component.controller("bizagi.editor.component.wait",{},{init:function(e,t){this._super(),t=t||{},this.canvas=e,this.model=t.model,this.presenter=t.presenter,this.renderArea=t.renderArea},loadTemplates:function(){var e={wait:bizagi.getTemplate("bizagi.editor.component.wait")+"#wait-container"};return this._super(e)},render:function(){var e=this,t=new $.Deferred;bizagi.log("self.createOverlay();"),e.createOverlay();var i=e.element;return i.empty(),$.when(e.loadTemplates()).done(function(){var n=e.getTemplate("wait");$.tmpl(n,e.model.getModel()).appendTo(i),t.resolve()}),t.promise()},createOverlay:function(){if(this.overlay)return this.overlay;var e=this.overlay=$("<div />");e.addClass("bz-grid-wait-container-main"),this.renderArea.addClass("bz-edit-mode"),e.appendTo(this.renderArea),this.canvas.appendTo(e)},destroy:function(){this.overlay.detach(),this.renderArea.removeClass("bz-edit-mode")}}),bizagi.editor.observableClass.extend("bizagi.editor.component.wait.presenter",{},{init:function(e){this._super(),e=e||{},this.canvas=e.canvas||$("<div />"),this.model=new bizagi.editor.component.wait.model(e.model),this.waitEditor=new bizagi.editor.component.wait(this.canvas,{model:this.model,presenter:this,renderArea:e.renderArea})},render:function(e){this.waitEditor.render(e)},destroy:function(){this.waitEditor.destroy()}}),bizagi.editor.observableClass.extend("bizagi.editor.component.wait.model",{},{init:function(e){e=e||{},this.message=e.message||""},getModel:function(){return{message:this.message}}}),bizagi.editor.component.controller("bizagi.editor.component.searchresulteditor",{init:function(e,t){t=t||{},this._super(e),this.model=t.model,this.canvas=e,this.presenter=t.presenter,this.options=t.options},loadTemplates:function(){var e={searchresulteditor:bizagi.getTemplate("bizagi.editor.component.searchresulteditor")+"#searchresulteditor-container",helper:bizagi.getTemplate("bizagi.editor.component.searchresulteditor")+"#searchcolumn-helper"};return this._super(e)},refresh:function(e){this.render(e)},render:function(e){var t=this;e=e||{},t.options=$.extend(t.options,e.options),e.searchResultModel&&t.model.update(e.searchResultModel,e.device),t.canvas.empty(),$.when(t.loadTemplates()).done(function(){var i=t.renderGrid();0===i.children().length&&i.addClass("children"),i.appendTo(t.canvas),e.currentSelectElement&&t.selectColumnByGuid(e.currentSelectElement)})},renderGrid:function(){var e;return e=this.grid=$.tmpl(this.getTemplate("searchresulteditor"),this.model.getViewModel()),$("[title]",e).tooltip(),e.appendTo(this.canvas),this.addGridSortBehaviour(e),e},addGridSortBehaviour:function(e){var t=this;e.sortable({items:".ui-bizagi-draggable-item",revert:!0,connectWith:".ui-bizagi-container-connectedSortable",distance:10,cursorAt:{top:-3,left:0},placeholder:"bz-fm-searchresult-placeholder",delay:150,helper:t.onDraggableHelper.bind(t)}),e.disableSelection(),e.bind("sortstart",function(e,i){t.onSortStart(i)}),e.bind("sortactivate",function(e,i){t.onSortActivate(i)}),e.bind("sortstop",function(e,i){t.onSortStop(i)})},onDraggableHelper:function(e,t){var i=this.model.getDisplayNameByColumnId(t.data("id"));e.stopPropagation();var n=$.tmpl(this.getTemplate("helper"),{caption:i});n.appendTo(document.body).css({zIndex:2900});var o=parseFloat(n.find("label").width()+40||100);return n.css({width:o}),n},onSortStart:function(e){var t=$(e.item).parent().children(".ui-bizagi-itemfordrag").index(e.item);this.initialPosition=t},onSortActivate:function(e){$(e.item).hasClass("bizagi_editor_xpathnavigator_data")?(this.sourceData=$(e.item).data(),this.source="xpathNavigator"):this.source="searchResultEditor"},onSortStop:function(e){var t=this.initialPosition,i=this.source,n=this.sourceData,o=$(e.item).parent().children(".ui-bizagi-itemfordrag").not(".ui-sortable-placeholder").index(e.item);this.finalPosition=o,"searchResultEditor"==i?this.presenter.publish("moveColumn",{data:n,initialPosition:t,finalPosition:o}):"xpathNavigator"==i&&this.presenter.publish("insertXpath",{data:n,position:o})},selectColumn:function(e){var t=e.offset();this.presenter.publish("selectColumn",{position:{top:t.top,left:t.left,width:e.outerWidth(),height:e.outerHeight()},element:e,guid:e.data("id")})},unSelectColumn:function(){this.presenter.publish("unSelectColumn",{})},selectColumnByGuid:function(e){var t=$('.bz-searchresult-column[data-id = "'+e+'"]',this.canvas);if(t.length>0){var i=$(t[0]);i.toggleClass("ui-state-active"),this.selectColumn(i)}},".bz-searchresult-column click":function(e){$("#bz-fm-searchresult-editor > .bz-searchresult-column").not(e).removeClass("ui-state-active"),e.toggleClass("ui-state-active"),e.hasClass("ui-state-active")?this.selectColumn(e):this.unSelectColumn(e)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.searchresulteditor.presenter",{},{init:function(e){this._super(),e=e||{},this.model=new bizagi.editor.component.searchresulteditor.model(e.searchResultModel,e.device),this.searchresulteditor=new bizagi.editor.component.searchresulteditor(e.canvas,{model:this.model,presenter:this,device:e.device})},refresh:function(e){this.searchresulteditor.refresh(e)},render:function(e){this.searchresulteditor.render($.extend(e))}}),bizagi.editor.observableClass.extend("bizagi.editor.component.searchresulteditor.model",{},{init:function(e,t){this.dummyRows=5,this.model=this.processModel(e,t)},update:function(e,t){this.model=this.processModel(e,t)},processModel:function(e,t){var i={columns:[],rows:[],resultValidations:e.resultValidations};if(!e)return i;var n=e.model;if(n.length>0)for(var o=0;o<n.length;o++){var r=n[o],a=[];if("Smartphone"!==t)for(var s=0;s<this.dummyRows;s++)a.push({value:"value"});i.columns.push({guid:r.guid,displayName:bizagi.editor.utilities.resolvei18n(r.properties.displayName),xpath:r.properties.xpath,type:r.type,values:a})}return i},getDisplayNameByColumnId:function(e){var t=(this.model&&this.model.columns||[]).find(function(t){return t.guid===e});return t?t.displayName:"undefined"},getViewModel:function(){return this.model}}),bizagi.editor.component.controller("bizagi.editor.component.buttoneditor",{init:function(e,t){t=t||{},this._super(e),this.model=t.model,this.canvas=e,this.presenter=t.presenter,this.options=t.options,this.rendering=new bizagi.rendering.facade},loadTemplates:function(){var e={buttoneditor:bizagi.getTemplate("bizagi.editor.component.buttoneditor")+"#buttoneditor-container"};return this._super(e)},refresh:function(e){this.render(e)},render:function(e){var t=this;e=e||{},t.isReadOnly="undefined"!=e.isReadOnly&&bizagi.util.parseBoolean(e.isReadOnly),t.allowAddButtons="undefined"!=e.allowAddButtons&&bizagi.util.parseBoolean(e.allowAddButtons),t.lastActionExecuted=e.lastActionExecuted,t.options=$.extend(t.options,e.options),e.buttonModel&&t.model.update(e.buttonModel),$.when(t.loadTemplates()).done(function(){t.buttonEditor||(t.canvas.empty(),(t.buttonEditor=$.tmpl(t.getTemplate("buttoneditor"))).appendTo(t.canvas));var e=$("#bz-fm-buttoneditor-rendering",t.buttonEditor);t.renderButtons(e)})},renderButtons:function(e){if(null==bizagi.renderButtonsTimeout)switch(bizagi.renderButtonsTimeout=setTimeout(function(){bizagi.renderButtonsTimeout=null},200),this.getDevice()){case"Desktop":this.renderDesktopButtons(e);break;case"Smartphone":case"Tablet":this.renderSmartphoneButtons(e)}},renderSmartphoneButtons:function(e){var t=this,i=this.model.getViewModel();e.parents("#button-editor-panel").addClass("bz-buttons-container--border"),e.bz_navigation_buttons({buttons:i,isDesign:!0,lastActionExecuted:t.lastActionExecuted,allowAddButtons:t.allowAddButtons}).on("onAddButton",function(){t.presenter.publish("addButton")}).on("onSelectButton",function(e,i){var n=i.$element,o=i.button;if(!t.isReadOnly){$(".bz-form-old-item").not(n).removeClass("ui-state-active"),$(".ui-bizagi-grid-cell").not(n).removeClass("ui-state-active"),$(".bz-container").removeClass("ui-bizagi-container-selected"),n.toggleClass("bz-state-active");var r=n.hasClass("bz-state-active");$(".bz-button--container").not(n).removeClass("bz-state-active"),r?t.selectButton(n,o.properties.id):t.unselectButton()}})},renderTabletButtons:function(){},renderDesktopButtons:function(e){var t=this;return t.rendering.update({mode:"design",canvas:e,allowButtons:!0,data:{properties:{},buttons:t.model.getViewModel()}}),$.when(t.rendering.ready()).done(function(){var i=$(".ui-bizagi-button-container",e),n=$(".ui-bizagi-button",i);if(i.unwrap(),n.wrap("<span></span>"),$(".bz-fm-buttoneditor-add",i).button(),$(".bz-fm-buttoneditor-add .ui-button-text",i).addClass("bz-fm-buttoneditor-add-icon"),!t.isReadOnly&&t.allowAddButtons){$(".bz-fm-buttoneditor-add",i).button(),$(".bz-fm-buttoneditor-add .ui-button-text",i).addClass("bz-fm-buttoneditor-add-icon");var o=$(i.children()[0]);if(o.sortable({items:o.children().not(".bz-fm-avoid-sort"),cancel:"textarea,select,option",distance:10,axis:"x",cursorAt:{top:-3,left:0},placeholder:"ui-bizagi-button-placeholder bz-fm-avoid-sort",delay:150,start:function(e,i){t.sortStart(e,i)},tolerance:"pointer",stop:function(e,i){t.sortFinish(e,i)}}),t.options.element){var r=t.options.element.guid,a=$('input[data-guid="'+r+'"]',i);a.length>0&&(a.toggleClass("bz-state-active"),a=a.parent(),t.selectButton(a,r))}}else $(".bz-fm-avoid-sort",i).hide()}),e},sortStart:function(e,t){var i=$(t.item).parent().children().not(".bz-fm-avoid-sort").index(t.item);return t.item.data("start-position",i),this.initialPosition=i,!0},sortFinish:function(e,t){var i=$(t.item).parent().children().not(".bz-fm-avoid-sort").index(t.item);return this.presenter.publish("moveButton",{initialPosition:t.item.data("start-position")||this.initialPosition,finalPosition:i}),!0},selectButton:function(e,t){var i=e.offset();this.presenter.publish("selectButton",{position:{top:i.top,left:i.left,width:e.outerWidth(),height:e.outerHeight()},element:e,guid:t,type:"button"})},unselectButton:function(){this.presenter.publish("unselectButton")},getDevice:function(){return this.presenter.publish("getDevice",{})},".ui-bizagi-button click":function(e){if(!this.isReadOnly){$(".ui-bizagi-render").not(e).removeClass("ui-state-active"),$(".ui-bizagi-grid-cell").not(e).removeClass("ui-state-active"),$(".ui-bizagi-container").removeClass("ui-bizagi-container-selected"),e.toggleClass("bz-state-active");var t=e.hasClass("bz-state-active");$(".ui-bizagi-button",this.canvas).not(e).removeClass("bz-state-active"),t?this.selectButton(e.parent(),e.data("guid")):this.unselectButton()}},".bz-fm-buttoneditor-add click":function(e){this.presenter.publish("addButton")}}),bizagi.editor.observableClass.extend("bizagi.editor.component.buttoneditor.presenter",{},{init:function(e){this._super(),e=e||{},this.model=new bizagi.editor.component.buttoneditor.model(e.buttonModel),this.buttoneditor=new bizagi.editor.component.buttoneditor(e.canvas,{model:this.model,presenter:this,isReadOnly:e.isReadOnly})},refresh:function(e){this.buttoneditor.refresh(e)},render:function(e){this.buttoneditor.render(e)}}),bizagi.editor.observableClass.extend("bizagi.editor.component.buttoneditor.model",{},{init:function(e){this.model=this.processModel(e)},update:function(e){this.model=this.processModel(e)},processModel:function(e){return e},getViewModel:function(){return this.model}}),bizagi.editor.observableClass.extend("bizagi.editor.command",{},{init:function(e){e=e||{},this._super(),this.arguments=e.arguments,this.controller=e.controller,this.model=e.model,this.constants=bizagi.editor.base.constants,this.arguments.canUndo=void 0!==this.arguments.canUndo?this.arguments.canUndo:this.canUndo(),this.arguments.refresh=this.needRefresh(),this.arguments.canValidate=!1,this.validateArguments()},needRefresh:function(){return!1},execute:function(){},canUndo:function(){return!0},undo:function(){return!1},redo:function(){return this.execute()},validateArguments:function(){if(void 0===this.arguments)throw"Argument is not defined"},createElement:function(e,t){var i={properties:e,guid:e.guid,elements:t};return this.model.createElement(e.type,i)},isSpecialElement:function(e,t){var i="tabitem";if("offlinetab"===e)i="offlinetabitem";else if("adhoctab"===e)i="adhoctabitem";else{if("tab"!==e)return;i="tabitem"}var n=this.createElement({type:i,displayName:"Tab 1"});this.controller.isAdhocFormContext()||(n.properties.displayName=bizagi.editor.utilities.buildComplexLocalizable("Tab 1",n.guid,"displayName")),t.addElement(n)},normalizeControlType:function(e){return e.replace(/smartphone/,"").replace(/tablet/,"").replace(/offline/,"")},resolveResult:function(e){return"object"==typeof e&&e.done&&"resolved"==e.state()?bizagi.resolveResult(e):e},setXpathAdhoc:function(e){e.properties.displayName instanceof Object?xpath=bizagi.editor.utilities.getXPathByDisplayName(e.properties.displayName.i18n.default):xpath=bizagi.editor.utilities.getXPathByDisplayName(e.properties.displayName),xpath=xpath.substr(0,1).toLowerCase()+xpath.substr(1),e.properties.xpathAdhoc={xpath:xpath,relatedEntity:null}}}),bizagi.editor.command.extend("bizagi.editor.notUndoableCommand",{},{canUndo:function(){return!1}}),bizagi.editor.command.extend("bizagi.editor.refreshableCommand",{},{needRefresh:function(){return!0}}),bizagi.editor.observableClass.extend("bizagi.editor.commandfactory",{},{init:function(e){this._super(),this.controller=e},create:function(args){if(void 0===args.command)throw"The argument must contain a command to perform";try{var fn=eval("var bafn = function(args, controller, model) { \n return new bizagi.editor."+args.command+"Command({arguments: args, controller: controller, model: model }); \n};\nbafn"),command=fn(args,this.controller,this.controller.getModel());return command}catch(e){throw"Can't create a comand for "+args.command}}}),bizagi.editor.observableClass.extend("bizagi.editor.base.controller",{patterns:{isCssFile:/\.css$/g,isJsFile:/\.js$/g,isDesktop:/^desktop/g,isTablet:/^tablet/g,isSmartphone:/^smartphone/g}},{init:function(e){var t=this;this._super(),e=e||{},this.readyDefer=new $.Deferred,this._ResourcesServices=bizagi.editor.base.services.resourcesServices,t.commandfactory=new bizagi.editor.commandfactory(this),t.undoCommandStack=[],t.redoCommandStack=[],t.copyFormatStack=[],t.selectedElements={},t.device=e.device,t.widgetDefinitions={},t.isSpecific=e.isSpecific,t.hashJsFiles={},t.communicationProtocol=bizagi.editor.communicationprotocol.factory,t.communicationProtocol.setContext(e.context),t._catalogServices=bizagi.editor.base.catalogServices,t.ctrlPressed=!1,t.newForm=null==e.data,t.context=e.context||"form",t.originalContext=bizagi.clone(t.context),t.contextInfo={xpath:{xpath:{baxpath:{xpath:"",contextentity:e.contextentity,scopedefinition:e.scopedefinition}}},guid:null},t.idForm=bizagi.editor.utilities.isGuidEmpty(e.idForm)?Math.guid():e.idForm,t.idParentForm=e.idParentForm,t.baseContextInfo=bizagi.clone(t.contextInfo),t.contextEntityType="enum"==e.contextentitytype?"parameter":e.contextentitytype,t.xpathNavigatorView=bizagi.editor.component.xpathnavigator.model.view.onlyProcessEntity,t.deviceType=e.deviceType,setTimeout(function(){t.initModels(e)},200)},initModels:function(e){var t,i,n,o,r,a=this,s=a.communicationProtocol.createProtocol({protocol:"getcontrolsdefinitions",device:a.device,isSpecific:a.isSpecific,isOffline:Boolean(e.isOffline),deviceType:e.deviceType}),l=a.communicationProtocol.createProtocol({protocol:"getfirstload"}),d=a.communicationProtocol.createProtocol({protocol:"checkflags",flags:{EnableCssClassProperty:!0,EnableShowAlwaysReverseAction:!0,EnableNextWithoutValidations:!0,EnableLetters:!0,UseOfflineForms:!0}}),c=!1;$.when(s.processRequest()).pipe(function(e){return t=e,l.processRequest()}).pipe(function(e){return i=e,d.processRequest()}).pipe(function(e){"startform"==a.context&&(e=Object.assign(e,{document:!0,smartphonedocument:!0,tabletdocument:!0})),n=e;var t=$.Deferred();return a._catalogServices.getByIdWithChildren("Resource",a.idForm).then(function(e){if(e&&e.length){var i=e[0],n=i.content;if($.isEmptyObject(n))return void t.resolve([]);var r=i.content.version;"number"==typeof r&&(i.content.version=r+".0");var s={actiontype:"ProcessFormContent",parameters:[{key:"formContent",value:JSON.stringify(n)}]};a.newForm=!1,c=a.communicationProtocol.createProtocol({protocol:"checkoutform",idForm:a.idForm}),$.when(bizagi.editor.base.services.resourcesServices.getResource(s)).done(function(e){o=JSON.parse(e.result.parameters[0].value),t.resolve(i.children||[])})}else a.newForm=!0,t.resolve([])}),t.promise()}).pipe(function(e){return r=e,c&&c.processRequest()}).done(function(s){$.when(bizagi.localization.ready()).done(function(){var l=a.componentModels={},d=l.controls=new bizagi.editor.controls(t,n);bizagi=bizagi||{},bizagi.editor=bizagi.editor||{},bizagi.editor.flags=n,s=s||{},a.isInCheckout=s.isInCheckout,a.publish("onReadOnlyForm",{isReadOnly:a.isInCheckout}),a.userInfo=s.userInfo,n.EnableCssClassProperty||d.disableControlProperties("EnableCssClassProperty"),e.isActivityForm=!!(a.isFormContext()||a.isStartFormContext()||a.isOfflineFormContext())&&bizagi.util.parseBoolean(e.isActivityForm),a.model=new bizagi.editor.model({definitions:t,controls:d,context:e.context,contextentity:e.contextentity,scopedefinition:e.scopedefinition,isActivityForm:e.isActivityForm,version:e.version,flags:n,idParentForm:a.idParentForm,isVersionable:e.isVersionable,deployOnParent:e.deployOnParent,isNewForm:a.newForm,resources:r,isSpecificForm:e.isSpecific,isNew:e.isNew,formData:o,isDefault:e.isDefault,deviceType:e.deviceType,supportOffline:e.supportOffline,canWorkOffline:e.canWorkOffline}),a.model.subscribe("refresh",function(){a.publish("refresh")}),a.model.subscribe("getDefaultDisplayName",function(e,t){return a.publish("getDefaultDisplayName",t)}),a.model.subscribe("getNodeInfo",function(e,t){return a.publish("getNodeInfo",t)}),a.model.subscribe("getContextXpath",function(e,t){return a.getContextXpath(t)}),a.model.subscribe("findXpathAttributes",function(e,t){return a.publish("findXpathAttributes",t)}),a.model.subscribe("resizeHeigthCanvas",function(e,t){return a.publish("resizeHeigthCanvas",t)}),a.model.subscribe("isReadOnlyForm",function(){return a.isReadOnlyForm()}),a.model.subscribe("getContextEntityType",function(){return a.getContextEntityType()}),a.model.subscribe("getControllerInfo",function(e,t){if(t.type&&"function"==typeof a[t.type])return a[t.type](t)}),a.model.subscribe("refreshElement",function(e,t){return a.publish("refreshElement",t)}),a.model.subscribe("formIsLoaded",function(e,t){return a.publish("formIsLoaded",t)}),a.model.subscribe("getIdForm",function(){return a.idForm}),a.model.subscribe("getOriginalModel",function(){return a.originalModel}),a.model.subscribe("getModel",function(){return a.getChangesetModel()}),a.model.subscribe("isNewForm",function(e,t){return a.isNewForm()}),a.model.subscribe("getIdParentForm",function(e,t){return a.idParentForm}),a.model.subscribe("setIdParentForm",function(e,t){a.setIdParentForm(t.idParentForm)}),a.model.subscribe("getDeviceInfo",function(e,t){return a.publish("getDeviceInfo",t)});var c=[];Boolean(e.isOffline)||!a.isFormContext()&&!a.isStartFormContext()||$.each(d.controls,function(e,t){!t.type||"userfield"!=t.type&&"userfield"!=t.rendertype||(c.push(a.loadUserfield(t)),a.loadIconUserField(t))}),l.xpathNavigator=new bizagi.editor.component.xpathnavigator.model(i),l.controlsNavigator=new bizagi.editor.component.controlsnavigator.model,l.controlsNavigator.subscribe("isContextEntityApplication",function(){return a.isContextEntityApplication()}),l.controlsNavigator.subscribe("getContext",function(){return a.getContext()}),l.controlsNavigator.processData(d),l.layoutNavigator=new bizagi.editor.component.layoutnavigator.model,l.ribbon=new bizagi.editor.component.ribbon.model(a.model.getRibbonModelData()),a.processEntityId=l.xpathNavigator.getProcessEntityId(),Boolean(e.isOffline)?a.readyDefer.resolve():$.when.apply($,c).pipe(function(){return a.loadWidgetDefinitions(a.device)}).done(function(){a.readyDefer.resolve()})})})},loadUserfield:function(e){var t=this,i=$.Deferred(),n={actiontype:"GetUserfieldDependencies",parameters:[{key:"userfieldId",value:e.guid}]};return $.when(bizagi.editor.base.services.resourcesServices.getResource(n)).done(function(i){try{var n=i.result.parameters[0].value;try{t.widgetDefinitions[e.guid]=JSON.parse(n)}catch(t){bizagi.log("Could not parse result userfield "+e.name,t.message)}}catch(t){bizagi.log("Could not parse result userfield "+e.name,t.message)}}).pipe(function(){i.resolve()}),i.promise()},loadWidgetDefinitions:function(e){var t=this,i=$.Deferred(),n="";return t.getWidgetDefinitionsByDevice(e).forEach(function(i){var o=i.type;if(content=i.content,e=e.toLowerCase(),"css"===o)n=".".concat(e," { "),content=n.concat(content," }"),less.render(content).then(function(e){bizagi.util.loadStyle(e.css,Math.guid())}).catch(function(e){console.log("ERROR PARSE CSS",e)});else if("js"===o){n="bizagi.rendering.".concat(e.toLowerCase()),content=content.replace(/bizagi.rendering/g,n);try{var r=!0;if(!content.includes("bizagi.rendering")){var a=content.hashCode();t.hashJsFiles[a]?r=!1:t.hashJsFiles[a]=!0}r&&window.eval(content)}catch(e){bizagi.log("Cannot parse the js content in the widget")}}}),setTimeout(function(){i.resolve()},10),i.promise()},getWidgetDefinitionsByDevice:function(e){var t=this;var i=function(){switch(e){case"Desktop":return t.Class.patterns.isDesktop;case"Tablet":return t.Class.patterns.isTablet;case"Smartphone":return t.Class.patterns.isSmartphone}}(),n=[];for(var o in t.widgetDefinitions){var r=t.widgetDefinitions[o];for(var a in r)a.match(i)&&n.push(JSON.parse(r[a]))}return n},loadIconUserField:function(e){var t=$.Deferred();e.icon=t.promise();var i={actiontype:"GetUserfieldIconDependencies",parameters:[{key:"userfieldId",value:e.guid},{key:"density",value:"HDPI"},{key:"size",value:"SMALL"}]};$.when(bizagi.editor.base.services.resourcesServices.getResource(i)).done(function(i){var n=i.result.parameters[0].value;bizagi.util.loadIconStyle(n,e.name),e.icon=t.resolve(n)})},ready:function(){return this.readyDefer.promise()},executeCommand:function(e){var t,i=this;if(t=this.commandfactory.create(e))return $.when(t.execute()).pipe(function(n){return n&&!e.error?(e.success=!0,i.onCommandExecuted(e),(void 0===e.canUndo||e.canUndo)&&"getElementDesignProperty"!==t.arguments.command&&(i.undoCommandStack.push(t),i.redoCommandStack.length>0&&i.redoCommandStack.splice(0,i.redoCommandStack.splice.length))):(e.success=!1,e.result={error:!0,message:e.error}),e.result})},onCommandExecuted:function(e){this.publish("commandExecuted",e)},hasUndo:function(){return this.undoCommandStack.length>0},undo:function(){var e,t;return!!(e=this.undoCommandStack.pop())&&((t=e.undo())?this.redoCommandStack.push(e):this.undoCommandStack.push(e),t)},hasRedo:function(){return this.redoCommandStack.length>0},redo:function(){var e,t,i;return!!(e=this.redoCommandStack.pop())&&(t=e.redo(),i=$.extend({},e.arguments,{redoed:!0}),this.onCommandExecuted(i),this.undoCommandStack.push(e),t)},getCurrentDevice:function(){return this.device},setCurrentDevice:function(e){this.device=e},getControlsModel:function(){return this.componentModels.controls},isContextEntityApplication:function(){return"application"==this.contextEntityType},getControlsNavigatorModel:function(){var e=this.context;return this.componentModels.controlsNavigator.context[e]},getControlDisplayName:function(e){return this.componentModels.controlsNavigator.getControlDisplayName(e)},getXpathNavigatorModel:function(e){var t=(e=e||{}).context,i=this.componentModels.xpathNavigator;if(null!=t)return""==t?i:i.getSubModel(t);var n=this.contextInfo;return i.getSubModel(n.xpath)},getXpathNavigatorModelGrid:function(e){var t=(e=e||{}).context;return null!=t?""==t?this.xpathNavigatorModelGrid:this.xpathNavigatorModelGrid.getSubModel(t):this.xpathNavigatorModelGrid},getLayoutNavigatorModel:function(){return this.componentModels.layoutNavigator},getRibbonModel:function(){return this.componentModels.ribbon},getRenderingModel:function(){return this.model.getRenderingModel()},getPreviewOfflineFlag:function(){return this.model.getPreviewOfflineFlag()},setPreviewOfflineFlag:function(e){this.model.setPreviewOfflineFlag(e)},getPreviewOfflineRenderingModel:function(){return this.model.getPreviewOfflineRenderingModel()},getPersistenceModel:function(){return this.model.getPersistenceModel()},getChangesetModel:function(){return this.model.getChangeset()},setResources:function(e){"object"==typeof e&&this.model.setResources(e)},getModel:function(){return this.model},getMissingOfflineControls:function(){var e=new $.Deferred;return $.when(this.model.getMissingOfflineControls([])).done(function(t){e.resolve(t)}),e.promise()},getCommandsModel:function(){var e=this,t=new $.Deferred;return $.when(e.model.getCommandsModel()).done(function(i){e.commandsModel=bizagi.clone($.extend(i,{flags:e.model.getFlags(),isReadOnly:e.isReadOnlyForm()})),t.resolve(e.commandsModel)}),t.promise()},getFlags:function(){return this.model.getFlags()},getCommandsEditorModel:function(){var e=new $.Deferred;return $.when(this.getCommandsModel()).done(function(t){e.resolve(new bizagi.editor.component.commandseditor.model(t))}),e.promise()},copyFormatHasElement:function(){return this.copyFormatStack.length>0},getCopyFormatElement:function(){return this.copyFormatStack[0]},pushCopyFormat:function(e){this.copyFormatStack.push(e)},popCopyFormat:function(){return this.copyFormatStack.pop()},setCommandsModel:function(e){return this.model.setCommandsModel(e)},setOriginalModel:function(e){var t=this;$.when(t.model.ready()).done(function(){t.originalModel=e||t.getChangesetModel(),t.publish("refreshRibbon",{})})},setXpathNavigatorModelGrid:function(e){this.xpathNavigatorModelGrid=e},setUserInfo:function(e){this.userInfo=e},getContext:function(){return this.context},getOriginalContext:function(){return this.originalContext},getContextInfo:function(){return{xpath:this.contextInfo.xpath,guid:this.contextInfo.guid||this.model.getGuid()}},getContextXpath:function(e){var t=e.xpath;if(this.isGridContext()){var i=bizagi.editor.utilities.resolveComplexXpath(this.contextInfo.xpath);return t?i+"."+t:i}return t},getUserInfo:function(){return this.userInfo},changeContext:function(e){this.context=e.context,"adhocgrid"===e.context?this.contextInfo.xpathAdhoc=e.xpathAdhoc||this.baseContextInfo.xpathAdhoc:this.contextInfo.xpath=e.xpath||this.baseContextInfo.xpath,this.contextInfo.guid=e.guid||this.baseContextInfo.guid},isFormContext:function(){return"form"===this.context},isTemplateContext:function(){return"template"===this.context},isStartFormContext:function(){return"startform"===this.context},isAdhocFormContext:function(){return"adhocform"===this.context||"adhocgrid"===this.context},isOfflineContext:function(){return"offlineform"===this.context||"offlinegrid"===this.context},isOfflineFormContext:function(){return"offlineform"===this.context},isGridContext:function(){return"grid"===this.context||"offlinegrid"===this.context||"adhocgrid"===this.context},searchDependencies:function(e){return this.executeCommand({command:"searchDependencies",guids:e.guids,message:e.message})},isSearchFormContext:function(){return"searchform"===this.context},isQueryFormContext:function(){return"queryform"===this.context},isActivityForm:function(){return this.model.checkActivityForm()},isReadOnlyForm:function(){return this.isInCheckout||"Desktop"!=this.device&&this.getPreviewOfflineFlag()},getIsInCheckout:function(){return this.isInCheckout},setReadOnlyFlag:function(e){this.isInCheckout=e},thereAreChangesInForm:function(){var e=this;return $.when(e.model.ready()).pipe(function(){var t=!bizagi.editor.utilities.objectEquals(e.originalModel,e.getChangesetModel());return e.publish("onChangeForm",{change:t}),t})},toogleXPathNavigatorView:function(){this.xpathNavigatorView=this.xpathNavigatorView===bizagi.editor.component.xpathnavigator.model.view.onlyProcessEntity?bizagi.editor.component.xpathnavigator.model.view.allView:bizagi.editor.component.xpathnavigator.model.view.onlyProcessEntity},getXpathNavigatorView:function(){return this.xpathNavigatorView},getProcessEntityId:function(){return this.processEntityId},getDeviceType:function(){return this.deviceType},addSelectedElement:function(e,t){this.selectedElements[e]=t},removeSelectedElement:function(e){e?this.selectedElements[e]&&delete this.selectedElements[e]:this.selectedElements={}},getSelectedElements:function(e){return e?this.selectedElements[e]:this.selectedElements},getGuidsSelected:function(){var e=[];for(var t in this.selectedElements)e.push(t);return e},getContextEntityType:function(){return this.contextEntityType},thereAreMultiselection:function(){var e=0;for(var t in this.selectedElements)e++;return e>1},setNewForm:function(e){this.newForm=e},setIdParentForm:function(e){this.idParentForm=e},setCtrlKey:function(e){this.ctrlPressed=e},isCtrlKeyPressed:function(e){return this.ctrlPressed},isNewForm:function(){return this.newForm},hasEnableCommandsEditor:function(){return"searchform"!==this.context&&"queryform"!==this.context},setLastInsertedElement:function(e){this.lastInsertedElement=e},getLastInsertedElement:function(){return this.lastInsertedElement},getIdForm:function(){return this.idForm},isSpecificForm:function(){return this.isSpecific},getSupportOffline:function(){return this.publish("onGetSupportOffline")}}),bizagi.editor.base.controller.extend("bizagi.editor.adhoc.controller",{},{initModels:function(e){var t,i,n,o,r=this;r.adhocProcessId=e.adhocProcessId;var a=r.communicationProtocol.createProtocol({protocol:"availablelanguages"}),s=r.communicationProtocol.createProtocol({protocol:"getcontrolsdefinitions"}),l=r.getCommunicationProtocolForXpathNavigator(),d=r.communicationProtocol.createProtocol({protocol:"getlayoutsdefinitions"});$.when(s.processRequest()).pipe(function(e){return t=e,l.processRequest()}).pipe(function(e){return(i=e).context="adhocform",d.processRequest()}).pipe(function(e){return n=e,a.processRequest()}).done(function(a){o=a,$.when(bizagi.localization.ready()).done(function(){var a=r.componentModels={},s=a.controls=new bizagi.editor.controls(t);bizagi=bizagi||{},bizagi.editor=bizagi.editor||{},bizagi.editor.flags={},r.model=new bizagi.editor.model({definitions:t,controls:s,context:e.context,contextentity:null,scopedefinition:null,isActivityForm:!1,version:"1.0",languages:o,flags:[],idParentForm:r.idParentForm,resources:[]}),r.model.subscribe("refresh",function(){r.publish("refresh")}),r.model.subscribe("getDefaultDisplayName",function(e,t){return r.publish("getDefaultDisplayName",t)}),r.model.subscribe("getNodeInfo",function(e,t){return r.publish("getNodeInfo",t)}),r.model.subscribe("getContextXpath",function(e,t){return r.getContextXpath(t)}),r.model.subscribe("findXpathAttributes",function(e,t){return r.publish("findXpathAttributes",t)}),r.model.subscribe("resizeHeigthCanvas",function(e,t){return r.publish("resizeHeigthCanvas",t)}),r.model.subscribe("isReadOnlyForm",function(){return r.isReadOnlyForm()}),r.model.subscribe("getContextEntityType",function(){return r.getContextEntityType()}),r.model.subscribe("getControllerInfo",function(e,t){if(t.type&&"function"==typeof r[t.type])return r[t.type](t)}),r.model.subscribe("getIdForm",function(){return r.idForm}),r.model.subscribe("getOriginalModel",function(){return r.originalModel}),r.model.subscribe("getModel",function(){return r.getChangesetModel()}),a.xpathNavigator=new bizagi.editor.component.xpathnavigator.model(i),a.controlsNavigator=new bizagi.editor.component.controlsnavigator.model,a.controlsNavigator.subscribe("isContextEntityApplication",function(){return r.isContextEntityApplication()}),a.controlsNavigator.subscribe("getContext",function(){return r.getContext()}),a.controlsNavigator.processData(s),a.layoutNavigator=new bizagi.editor.component.layoutnavigator.model(n),a.ribbon=new bizagi.editor.component.ribbon.model(r.model.getRibbonModelData()),r.readyDefer.resolve()})})},getCommunicationProtocolForXpathNavigator:function(){return this.communicationProtocol.createProtocol({protocol:"getfirstload",adhocProcessId:this.adhocProcessId})},getAdhocXpathNavigatorModelGrid:function(){var e=new $.Deferred,t=this.communicationProtocol.createProtocol({protocol:"getchildrennodes",node:{entityContext:"adhocgrid",guidRelatedEntity:this.adhocProcessId,xpathAdhoc:this.contextInfo.xpathAdhoc}});return $.when(t.processRequest()).done(function(t){var i=new bizagi.editor.component.xpathnavigator.model(t);e.resolve(i)}),e.promise()},getXpathNavigatorFromServer:function(){var e=this,t=$.Deferred(),i=e.getCommunicationProtocolForXpathNavigator();return $.when(i.processRequest()).done(function(i){i.context="adhocform",e.componentModels.xpathNavigator=new bizagi.editor.component.xpathnavigator.model(i),t.resolve()}),t.promise()}}),$.Widget.prototype.destroy=function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},$.fn.bz__fd__wizard=function(e){var t=(e=e||{}).onFinish||$.noop;this.attr("class","bz__fd__wizard"),$.each(this,function(e,i){var n,o,r=-1,a=$(i),s=a.find("> ul > li"),l=s.length-1,d=function(){r!==l?(r+=1,s.hide(),$(s[r]).show(),r===l&&$("span",$(this)).text("Done")):t()},c=function(){0!==r&&(r===l&&$("span",n).text("Next"),r-=1,s.hide(),$(s[r]).show())};o=$('<div class="wizard-buttons"><button class="button__back">Back</button><button class="button__next">Next</button></div>'),$("button.button__back",o).click(c).button(),n=$("button.button__next",o).click(d).button(),o.appendTo(a),d()})},$.fn.bz__fd__selector=function(e){var t=(e=e||{}).onSelect||$.noop;return $.each(this,function(e,i){var n,o=function(e){return $(e.attr("ref"))},r=function(e){n&&(n.removeClass("active"),o(n).hide()),n=e.addClass("active"),t(e),o(e).show()},a=$(i).children();r($(i).find("li:first")),$.each(a,function(e,t){0===e?r($([t])):o($([t])).hide()}),a.bind("click",function(e){r($([this])),e.preventDefault()})})},bizagi.editor.observableClass.extend("bizagi.editor.view",{},{init:function(e){var t=this;this._super(),t.viewID=Math.guid(),t.deviceType=e.deviceType,t.deviceId=e.deviceId,t.isDefault=e.isDefault,t.idParentForm=e.idParentForm,t.idForm=e.idForm,t.supportOffline=e.supportOffline,t.isOffline=e.isOffline,t.channel=bizagi.editor.communicationprotocol.factory,t.cloneService=bizagi.editor.base.cloneService,t._catalogServices=bizagi.editor.base.catalogServices,t._utilities=bizagi.editor.utilities,t.appState=bizagi.editor.base.appState,t.loadFormDeferred=new $.Deferred,t.params=e,t.orientation="portrait","adhocform"!=e.context?(this.controller=new bizagi.editor.base.controller($.extend(e,{device:t.currentDevice,isSpecific:t.isSpecific})),t.controller.subscribe("getNodeInfo",function(e,i){return t.getNodeInfo(i)}),t.controller.subscribe("findXpathAttributes",function(e,i){return t.findXpathAttributes(i)})):this.controller=new bizagi.editor.adhoc.controller(e),t.controller.subscribe("commandExecuted",function(e,i){t.commandExecuted(i)}),t.controller.subscribe("refresh",function(e,i){t.refresh()}),t.controller.subscribe("showControlWizard",function(e,i){return t.showControlWizard(i)}),t.controller.subscribe("getExternalData",function(e,i){return t.getExternalData(i)}),t.controller.subscribe("getDefaultDisplayName",function(e,i){return t.getDefaultDisplayName(i)}),t.controller.subscribe("resizeHeigthCanvas",function(e,i){return t.refreshCanvas(i)}),t.controller.subscribe("refreshElement",function(e,i){return t.refreshElement(i)}),t.controller.subscribe("formIsLoaded",function(e,i){return t.formIsLoaded()}),t.controller.subscribe("getMainPanel",function(e,i){return t.getMainPanel()}),t.controller.subscribe("refreshRibbon",function(e,i){t.refreshRibbon()}),t.controller.subscribe("getLocalizableResources",function(e,i){return t.getLocalizableResources(i)}),t.controller.subscribe("getDeviceInfo",function(e){return t.getDeviceInfo(e)}),t.controller.subscribe("processAddEntityForm",function(e,i){return t.processAddEntityForm(i)}),t.controller.subscribe("processAddEntitySearchForm",function(e,i){return t.processAddEntitySearchForm(i)}),t.controller.subscribe("onChangeForm",function(e,i){t.publish("onChangeForm",i)}),t.controller.subscribe("onReadOnlyForm",function(e,i){t.publish("onReadOnlyForm",i)}),t.controller.subscribe("onGetSupportOffline",function(){return t.publish("onGetSupportOffline")})},ready:function(){return this.controller.ready()},refresh:function(e){var t=this;e=e||{},$.when(t.preRender(e)).pipe(function(){t.render(e),t.postRender()})},executeCommand:function(e){var t=this;t.publish("onExecuteCommand",{args:e}),e.command&&(e.gridGuid="changeContext"===e.command?t.guid:null);var i=$.when(t.controller.executeCommand(e)).pipe(function(i){return e.success&&e.refresh&&t.refresh(e),i});return"object"==typeof i&&i.done&&"resolved"==i.state()?bizagi.resolveResult(i):i},undo:function(){this.controller.undo()&&this.refresh()},redo:function(){this.controller.redo()&&this.refresh()},render:function(){},showControlWizard:function(){},getExternalData:function(){},commandExecuted:function(e){var t=this;"function"==typeof t[e.command+"Executed"]&&$.when(e.result).done(function(i){t[e.command+"Executed"](i,e)})},getDeviceInfo:function(){return{deviceType:this.deviceType,deviceId:this.deviceId,isSpecific:this.isSpecific,context:this.controller.getContext(),idParentForm:this.idParentForm,isDefault:this.isDefault,idForm:this.idForm,supportOffline:this.supportOffline,isOffline:this.isOffline}},getLocalizableResources:function(e){var t=this.params,i=(e=e||{}).isSpecific||!1;return bizagi.editor.utilities.isGuidEmpty(t.idForm)?{}:this.channel.createProtocol({protocol:"localizableresources",id:t.idForm,isSpecific:i}).processRequest()},getPersistenceModel:function(){return this.controller.getPersistenceModel()},getRenderingModel:function(){return this.controller.getRenderingModel()},thereAreChangesInForm:function(){return this.controller.thereAreChangesInForm()},loadSubModule:function(e){var t=$.Deferred(),i=bizagi.loader;return i.isModuleLoaded("formModeler",e)?t.resolve():(i.internalLoadModule("formModeler",e).then(function(){i.whenModuleLoaded("formModeler",function(){t.resolve()},e)}),t.promise())},loadWidgetDefinitions:function(){return this.controller.loadWidgetDefinitions(this.currentDevice)},setDevice:function(e){this.currentDevice=e,this.controller.setCurrentDevice(e)},setOrientation:function(e){this.orientation=e},getOrientation:function(){return this.orientation},getRenderingFacade:function(){var e=this;switch(e.currentDevice||"Desktop"){case"Desktop":return e.desktopRenderingFacade||(e.desktopRenderingFacade=new bizagi.rendering.facade,e.subscribeGlobalHandlers(e.desktopRenderingFacade)),e.desktopRenderingFacade;case"Tablet":return e.tabletRenderingFacade||(e.tabletRenderingFacade=new bizagi.rendering.facade({device:"tablet_ios"}),e.subscribeGlobalHandlers(e.tabletRenderingFacade)),e.tabletRenderingFacade;case"Smartphone":return e.smartphoneRenderingFacade||(e.smartphoneRenderingFacade=new bizagi.rendering.facade({device:"smartphone_ios"}),e.subscribeGlobalHandlers(e.smartphoneRenderingFacade)),e.smartphoneRenderingFacade}},setAsDefault:function(){var e=this;this.isDefault=!0;var t="DeviceType = '"+e.deviceType+"' AND IsDefault = 'true'";return Promise.all([e._catalogServices.getShallowById(e.idParentForm).then(function(i){var n=Array.isArray(i)&&i.length>0?i[0].type:"Form";return e._catalogServices.getByParentIdAndTag(n,e.idParentForm,t)}).then(e.processSetAsDefault.bind(e,!1)),e._catalogServices.getById(e.idForm).then(e.processSetAsDefault.bind(e,!0)),e._catalogServices.clearFormsCache([e.idForm]).then(function(){})])},setAsDefaultOfflineForm:function(e,t){var i=this;if(e){var n="DeviceType = '"+t+"' AND IsDefault = 'true'";return Promise.all([i._catalogServices.getShallowById(i.idParentForm).then(function(e){var t=Array.isArray(e)&&e.length>0?e[0].type:"Form";return i._catalogServices.getByParentIdAndTag(t,i.idParentForm,n)}).then(i.processSetAsDefault.bind(i,!1)),i._catalogServices.getById(e).then(i.processSetAsDefault.bind(i,!0)),i._catalogServices.clearFormsCache([e]).then(function(){})])}},setSupportOffline:function(e){this.isSpecific||(this.supportOffline=e),this.publish("onSetOffline",{value:e})},restoreToDefault:function(e){var t=this,i="DeviceId = '"+e+"'";t._catalogServices.getShallowById(t.idParentForm).then(function(e){var n=Array.isArray(e)&&e.length>0?e[0].type:"Form";return t._catalogServices.getByParentIdAndTag(n,t.idParentForm,i)}).then(t.processSetAsDefault.bind(t,!0))},processSetAsDefault:function(e,t){if(t&&t.length>0){var i=t[0];i.content.isDefault=e,this._catalogServices.saveChangeset({changeSet:[{action:"merge",deployOnParent:i.deployOnParent,id:i.id,name:i.name,type:i.type,parentId:i.parentId,modifiedByUser:BIZAGI_USER,content:JSON.stringify(i.content)}]})}},subscribeGlobalHandlers:function(e){var t=this;e.subscribe("sortstart",function(){t.onRenderingViewSortStart()}),e.subscribe("sortfinish",function(e,i){t.onRenderingViewSortFinish(i)}),e.subscribe("unselectelement",function(e,i){t.onRenderingViewElementUnselected(i)}),e.subscribe("selectelement",function(e,i){return t.onRenderingViewElementSelected(i)}),e.subscribe("canChangeLabel",function(){return!0}),e.subscribe("startlabeledition",function(){t.onRenderingViewStartLabelEdition()}),e.subscribe("finishlabeledition",function(){t.onRenderingViewFinishLabelEdition()}),e.subscribe("changelabel",function(e,i){t.onRenderingViewElementChangeLabel(i)}),bizagi.form.modeler.params.reviewMode||e.subscribe("elementrightclick",function(e,i){t.onRenderingViewElementRightClick(i)}),e.subscribe("getMainPanel",function(e,i){return t.getMainPanel(i)}),e.subscribe("getMainContainer",function(e,i){return t.getMainContainer(i)}),e.subscribe("getDeviceInfo",function(e,i){return t.getDeviceInfo(i)}),e.subscribe("getViewID",function(){return t.viewID}),e.subscribe("addtab",function(e,i){t.onRenderingViewTabAdd(i)}),e.subscribe("deletetab",function(e,i){t.onRenderingViewTabDelete(i)}),e.subscribe("activatetab",function(e,i){t.onRenderingViewTabActivate(i)}),e.subscribe("showsearchform",function(e,i){t.onRenderingShowSearchForm(i)}),e.subscribe("showProperties",function(e,i){t.onRenderingShowProperties(i)}),e.subscribe("showPropertiesForm",function(e,i){t.onRenderingShowPropertiesForm(i)}),e.subscribe("controlRefreshCanvas",function(e,i){t.refreshCanvas(i)}),e.subscribe("selectcontainerform",function(e,i){t.onRenderingSelectForm(i)}),e.subscribe("checkCtrlKey",function(e,i){return t.onCheckCtrlKey(i)}),e.subscribe("resizeImage",function(e,i){return t.onResizeImage(i)}),e.subscribe("refreshControl",function(e,i){return t.onRefreshControl(i)}),e.subscribe("getparentid",function(e,i){return t.onGetParentId(i)}),e.subscribe("getLastInsertedElement",function(){return t.onGetLastInsertedElement()}),e.subscribe("getControlIcon",function(e,i){return t.onGetControlIcon(i)}),e.subscribe("setLastInsertedElement",function(e,i){t.onSetLastInsertedElement(i)}),e.subscribe("addButton",function(e,i){t.onAddButton()}),e.subscribe("unsubscribeAll",function(e,i){t.unsubscribeAll(i)})},attachHandlersComponents:function(){var e=this;e.controller.isActivityForm()&&(e.attachHandlersButtonEditor(),e.refreshButtonEditor()),e.controller.isTemplateContext()||(e.attachHandlersControlsNavigator(),e.refreshControlsNavigator(),e.attachHandlersLayoutNavigator(),e.refreshLayoutNavigator()),e.attachHandlersXpathNavigator(),e.refreshXpathNavigator()}}),bizagi.editor.view.extend("bizagi.editor.modelerView",{},{init:function(e){var t=this;e=e||{},t.renderingMode="design",t.currentDevice=e.device||"Desktop",t.isSpecific=e.isSpecific||!1,t.validateForm=!1,t.loadDeferred=new $.Deferred,t._super(e),t.currentTabIndex=0,bizagi.editorLanguage={displayname:"default",IsRightToLeft:!1,key:"default"};var i=$("body"),n={message:bizagi.localization.getResource("formmodeler-component-wait-message-loading-form")},o=new bizagi.editor.component.wait.presenter({model:n,renderArea:i});$.when(o.render(),this.controller.ready()).done(function(){$.when(t.processLayout(e)).done(function(){e.isOffline&&e.isNew?$.when(t.executeCommand({command:"cloneEntityForms",sourceIdForm:e.idSourceForm,deviceInfo:t.getDeviceInfo()})).done(function(){o.destroy(),t.loadDeferred.resolve(),t.setOriginalModel(),t.refresh()}):(o.destroy(),t.loadDeferred.resolve(),e.autoGenerate&&t.autoGenerate(),e.isNew||t.setOriginalModel())})})},load:function(e,t){var i=this;$.when(this.controller.ready()).pipe(function(){return i.executeCommand({command:"loadModel",dataModel:e,canUndo:!1,mustRegenerateGuids:t})}).done(function(){if(t){var e=i.controller.getModel();$.when(e.ready()).pipe(function(){return i.executeCommand({command:"duplicateDisplayNameForm",canUndo:!1})}).done(function(){var t=Math.guid(),n=bizagi.editor.communicationprotocol.factory,o=i.controller.getChangesetModel().changeSet;e.isVersionable&&(o.push({action:"merge",deployOnParent:e.mustSetDeployOnParent(),id:t,name:"FormClass_"+t,type:"FormClass",parentId:i.controller.idParentForm,modifiedByUser:BIZAGI_USER,content:JSON.stringify({})}),o[0].parentId=t,i.controller.setIdParentForm(t));var r=n.createProtocol({protocol:"saveform",changeset:{changeSet:o},idForm:i.controller.getIdForm()});$.when(r.processRequest()).pipe(function(){return i.formIsLoaded()}).done(function(){setTimeout(function(){i.controller.setOriginalModel(),i.refreshRibbon()},100)})})}})},autoGenerate:function(){var e=this;$.when(this.controller.ready()).done(function(){$.when(e.controller.getXpathNavigatorModel()).pipe(function(e){return e.ready()}).done(function(t){var i;if(t.getProcessEntityId()){t.getProcessEntityModel();var n=t.getRootNode()||{};$.isArray(n.nodes)&&(i=n.nodes[0])&&$.when(t.getChildren(i.id)).done(function(){e.executeCommand({command:"addEntityChildren",node:i,canUndo:!1})})}else i=t.getRootNode(),e.executeCommand({command:"addEntityChildren",node:i,canUndo:!1})})})},save:function(){var e={command:"saveModel",dataModel:{},canUndo:!1};return this.executeCommand(e),e.dataModel},validateAndSaveForm:function(){this.performSave(!0)},ready:function(){return this.loadDeferred},updateForm:function(e){var t;t={command:"updateModel",data:e,canUndo:!1},this.executeCommand(t)},setOriginalModel:function(){var e=this;$.when(this.controller.ready()).done(function(){e.controller.setOriginalModel()})},processLayout:function(e){var t=this,i=new $.Deferred;t.configureHtmlPage(e);var n=$(e.canvas||"body");n.empty(),t.mainContainer=$('<form-modeler id="'+t.viewID+'" />').appendTo(n),t.mainContainer.addClass("container-layout");var o=t.layoutComponent=new bizagi.editor.component.layout.presenter({canvas:t.mainContainer,context:e.context,isActivityForm:e.isActivityForm});return o.subscribe("onChangeRotation",function(e,i){t.setOrientation(i.orientation),t.publish("onChangeRotation")}),$.when(o.render()).done(function(){bizagi.form.modeler.params.reviewMode&&(t.mainContainer.find(".left-panel li").eq(1).remove(),t.mainContainer.find(".left-panel li").eq(1).remove()),setTimeout(function(){t.configureLeftPane(),t.drawRibbon(),t.controller.isSearchFormContext()&&t.drawSearchResultEditor(),(t.controller.isActivityForm()||t.controller.isOfflineFormContext())&&t.drawStatusBar(),t.controller.isActivityForm()&&setTimeout(function(){t.drawButtonEditor()},100),t.configureKeyHandlers(),$.when(t.configureRenderingView()).done(function(){i.resolve()})},100)}),i.promise()},configureHtmlPage:function(){$("html").addClass("biz-work-area"),$("body").addClass("biz-font").addClass("biz-normal-font").addClass("biz-text-color"),$("body").attr("oncontextmenu","return false")},configureLeftPane:function(){var e=this;$.when(e.drawControlsNavigator(),e.drawXpathNavigator(),e.drawLayoutNavigator(),e.drawBanner()).done(function(){e.mainContainer.find(".left-panel").tabs({beforeActivate:function(t,i){var n=$("a",i.newTab).data("rendering-mode");e.hidePropertyBox(),e.needsRedrawAfterTabChange(i.newTab.index())&&(e.currentSelectedElement=null,e.controller.removeSelectedElement(),e.renderingMode=n,e.render(n)),e.currentTabIndex=i.newTab.index(),e.setBannerVisibility(i)}}),e.setBannerVisibility()})},configureKeyHandlers:function(){var e=this;$(document).keydown(function(e){}).keyup(function(t){46===t.keyCode&&($(document.activeElement).is("input, textarea")||bizagi.form.modeler.params.reviewMode||e.deleteElement())}),$(document).on("keydown",function(t){17==t.keyCode&&e.controller.setCtrlKey(!0)}),$(document).on("keyup",function(t){e.controller.isCtrlKeyPressed()&&e.controller.setCtrlKey(!1)})},needsRedrawAfterTabChange:function(e){return this.currentTabIndex<2&&2===e||2===this.currentTabIndex&&e<2},setBannerVisibility:function(e){"show"===(e?$("a",e.newTab).attr("data-banner"):"hide")?this.showBanner():this.hideBanner()},preRender:function(e){var t=new $.Deferred;return this.validateForm&&e.canValidate?this.processValidations({canRefresh:!1}):t.resolve()},render:function(e,t){var i=this.controller.getContext();"form"==i?this.renderForm(e,t):"mobileform"==i?this.renderForm(e,t):"searchform"==i?this.renderSearchForm(t):"grid"==i||"offlinegrid"==i||"adhocgrid"==i?this.renderGridColumnEditor():"offlineform"==i?this.renderForm(e,t):"queryform"==i?this.renderForm(e,t):"startform"==i?this.renderForm(e,t):"adhocform"==i&&this.renderForm(e,t)},postRender:function(){var e=null;this.controller.thereAreMultiselection()&&(e=bizagi.editor.utilities.getGuidEmpty()),this.refreshRibbon(e)},refreshCanvas:function(){},renderForm:function(e,t){var i=this,n=i.getMainPanel();i.refreshRenderingView(e,t),i.controller.isActivityForm()&&(i.refreshButtonEditor(),i.refreshStatusBar(),"design"==i.renderingMode&&n.on("widgetComplete",function(){i.refreshCanvas()}),i.refreshCanvas(),setTimeout(function(){i.refreshCanvas()},500))},renderSearchForm:function(e){this.refreshRenderingView(e),this.refreshSearchFormResult()},renderGridColumnEditor:function(){this.refreshGridColumnEditor()},enableLayoutTab:function(){this.mainContainer.find(".left-panel").tabs("option","disabled",[])},disableLayoutTab:function(){this.mainContainer.find(".left-panel").tabs("option","disabled",[2])},removeFormEvents:function(){this.unsubscribeAll()},getMainPanel:function(){return this.mainContainer.find("#main-panel")},getMainWrapper:function(){return this.mainContainer.find("#wrapper-main-container")},getMainWrapperScroll:function(){return this.mainContainer.find(".wrapper-main-scroll")},getWrapperScroll:function(){return this.mainContainer.find(".wrapper-scroll")},getMainContainer:function(){return this.mainContainer}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawXpathNavigator:function(){var e=this,t=$("<div />").addClass("bizagi_editor_xpathnavigator_container").appendTo(e.getMainContainer().find("#left-tab-data-bind"));$.when(e.executeCommand({command:"getXpathNavigatorModel"}),e.controller.getContext()).pipe(function(i,n){e.xpathNavigatorModel=i;var o=e.xpathNavigator=new bizagi.editor.component.xpathnavigator.presenter({canvas:t,model:i,scope:n});return e.controller.isGridContext()&&e.controller.setXpathNavigatorModelGrid(i),o.subscribe("getMainContainer",function(t,i){return e.getMainContainer(i)}),o.subscribe("getMainPanel",function(t,i){return e.getMainPanel(i)}),e.attachHandlersXpathNavigator(),o.render({isReadOnly:e.controller.isReadOnlyForm(),scope:e.controller.getContext()})})},attachHandlersXpathNavigator:function(){var e=this,t=e.xpathNavigator;e.controller.isReadOnlyForm()||(t.subscribe("nodeDoubleClick",function(t,i){e.onNodeDoubleClick(i)}),t.subscribe("contextMenuItemClick",function(t,i){e.onContextMenuItemClick(i)}),t.subscribe("controlRefreshCanvas",function(t,i){e.refreshCanvas(i)}))},showElementXpath:function(e){return e&&this.changeXpathNavigatorView(bizagi.clone(e)),this.xpathNavigator.showXpath(e)},showElementGuid:function(e,t){return t&&this.changeXpathNavigatorView(bizagi.clone(t)),this.xpathNavigator.showXpathByGuid(e,t)},showMetadataXpath:function(e){return this.xpathNavigator.showMetadataXpath(e)},changeXpathNavigatorView:function(e){return!this.controller.isGridContext()&&("template"!=this.controller.getContext()&&(!(!(e=bizagi.editor.utilities.resolveComplexXpath(e))||(e=e.split(".")[0],this.xpathNavigatorModel.processEntityRelated(e)||this.controller.getXpathNavigatorView()!==bizagi.editor.component.xpathnavigator.model.view.onlyProcessEntity))&&(this.performViewAll(this.xpathNavigatorModel.getRootNode()),!0)))},refreshXpathNavigator:function(e){var t=this;$.when(t.executeCommand({command:"getXpathNavigatorModel"})).done(function(i){t.controller.isGridContext()&&t.controller.setXpathNavigatorModelGrid(i);var n={model:e&&e.model||i,context:e?e.context:void 0,scope:t.controller.getContext(),isReadOnly:t.controller.isReadOnlyForm()};t.xpathNavigator.render(n)})},reloadXpathNode:function(e){var t=this;e&&$.when(t.controller.getXpathNavigatorModel()).done(function(i){i&&$.when(i.getChildren(e.id,!0),i.invalidateScopeAttributes()).done(function(){t.refreshXpathNavigator()})})},insertXpathElement:function(e){var t=this,i=e.renderType,n={renderType:i,nodeSubtype:e.nodeSubtype,name:e.displayName,xpath:bizagi.editor.utilities.buildComplexXpath(e.xpath,e.contextScope,e.isScopeAttribute,e.guidRelatedEntity),guid:e.guid};if(-1!==i.indexOf("adhoc")&&(n.context=-1!==i.indexOf("adhoccolumn")?"adhocgrid":"adhocform",n.displayName=e.displayName,e.parent&&(n.parent={guidRelatedEntity:e.parent.guidRelatedEntity}),e.guidRelatedEntity&&(n.guidRelatedEntity=e.guidRelatedEntity),n.entityContext=e.entityContext,e.predefinedValues&&(n.predefinedValues=e.predefinedValues)),"nestedform"!==e.renderType)return t.executeInsertFromXpathCommand(n);t.processAddEntityForm(n).then(function(e){return t.executeInsertFromXpathCommand(e)})},executeInsertFromXpathCommand:function(e){return this.executeCommand({command:"insertElementFromXpathNavigator",data:e})},onNodeDoubleClick:function(e){this.controller.isTemplateContext()||this.insertXpathElement(e)},onContextMenuItemClick:function(e){var t=e.action;"editentity"==t&&this.performEditEntity(e.node),"viewall"==t&&this.performViewAll(e.node),"refresh"==t&&this.performRefresh(e.node),"addelement"==t&&this.performAddElement(e.node),"addchildelements"==t&&this.performAddChildElements(e.node),"editvalues"==t&&this.performEditValues(e.node),"newForm"==t&&this.performNewForm(e.node)},performEditEntity:function(e){var t=this,i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"editentity",id:e.guidRelatedEntity});$.when(i.processRequest()).done(function(){t.reloadXpathNode(e)})},performViewAll:function(e){var t=this;e.setCaptionViewContextMenu(),$.when(t.executeCommand({command:"getXpathNavigatorModel",toogleView:!0})).done(function(e){t.xpathNavigator.render({model:e,scope:t.controller.getContext()})})},performRefresh:function(e){this.reloadXpathNode(e)},performAddElement:function(e){this.insertXpathElement(e)},performAddChildElements:function(e){this.executeCommand({command:"addEntityChildren",node:e})},performEditValues:function(e){var t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"editentityvalues",id:e.guidRelatedEntity});$.when(t.processRequest()).done(function(){})},performNewForm:function(e){var t=this.publish("getViewSelected"),i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"newform",node:e,deviceId:t.relatedView});$.when(i.processRequest()).done(function(){})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawDecorator:function(e){var t=this,i=e.element;t.removeDecorator();var n=$("<div />").appendTo(i),o=t.executeCommand({command:"getDecoratorModel",guid:e.guid}),r=t.decorator=new bizagi.editor.component.decorator.presenter({canvas:n,data:e,model:o});r.subscribe("showProperties",function(e,i){t.onShowProperties(i)}),r.subscribe("showXpathNavigator",function(e,i){t.onShowXpathNavigator(i)}),r.subscribe("deleteElement",function(e,i){t.onDeleteElement(i)}),r.subscribe("openNestedForm",function(e,i){t.onOpenNestedForm(i)}),r.subscribe("buttonClicked",function(e,i){t.onButtonClicked(i)}),r.subscribe("close",function(){n.detach()}),$.when(r.render()).done(function(){e.IsOnClickEvent&&t.drawPropertyBox({guid:e.guid})})},destroyDecorator:function(){this.decorator&&this.decorator.destroy()},removeDecorator:function(){$(".bizagi_editor_component_decorator").length>0&&$(".bizagi_editor_component_decorator").detach()},onShowProperties:function(e){this.drawPropertyBox({guid:e.guid})},onShowXpathNavigator:function(e){var t=this,i=t.executeCommand({command:"getElementProperties",guid:e.guid}),n=(t.controller.model.getElement(e.guid).propertyModel.indexedProperties||{}).xpath||{},o={};o.typeFilter=n["bas-type"];var r=n["editor-parameters"]||{};if(r.types){o.types=r.types;var a={typeEditor:o.typeFilter,editorParameters:r};t.editorValidations[e.guid]=a}"object"==typeof i.xpath&&t.changeXpathNavigatorView(i.xpath),$.when(t.controller.getXpathNavigatorModel()).done(function(n){var r=new bizagi.editor.component.xpathnavigator.presenter({model:n}),a=i.xpath;r.subscribe("nodeDoubleClick",function(i,n){t.changeXpathPropertyForElement(e.guid,"xpath",n),r.closePopup()}),r.subscribe("getMainContainer",function(){return t.getMainContainer()}),r.renderPopup({position:{left:e.position.left,top:e.position.top+e.position.height},xpath:a,filter:o})})},changeXpathForElement:function(e,t){var i={command:"changeProperty",guid:e,property:"xpath",value:bizagi.editor.utilities.buildComplexXpath(t.xpath,t.contextScope,t.isScopeAttribute,t.guidRelatedEntity)};this.executeCommand(i)},onDeleteElement:function(e){this.hidePropertyBox(),this.executeCommand({command:"removeElementById",guid:e})},onButtonClicked:function(e){var t=this.decorator.getDecoratedElement();"ConfigGrid"===e.button?(this.drawGridColumnEditor({guid:e.guid,element:t}),this.hidePropertyBox(),this.executeCommand({command:"changeContext",guid:e.guid,context:this.getGridContext()})):"EditNestedForm"===e.button?this.openNestedForm(e):"AddForm"===e.button?this.drawSelectFormEditor({guid:e.guid,element:t,property:"add.form",caption:"Add Form"}):"EditForm"===e.button&&this.drawSelectFormEditor({guid:e.guid,element:t,property:"edit.form",caption:"Edit Form"})},getGridContext:function(){return this.controller.isOfflineFormContext()?"offlinegrid":this.controller.isAdhocFormContext()?"adhocgrid":"grid"},openNestedForm:function(e){var t=this.executeCommand({command:"getElementProperties",guid:e.guid}),i=this.publish("getViewSelected")||{};this.channel.createProtocol({protocol:"opennestedform",refForm:t.form,idForm:e.guid,deviceId:i.relatedView,device:i.device,isSpecific:i.device===i.type,deviceType:this.deviceType}).processRequest()}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{changeContextExecuted:function(e,t){this.refreshControlsNavigator(),this.refreshXpathNavigator({context:t.context}),"grid"!=t.context&&"offlinegrid"!=t.context&&"adhocgrid"!=t.context||(this.formContainer.disableSortablePlugin(),this.disableLayoutTab()),"form"!=t.context&&"startform"!=t.context&&"offlineform"!=t.context&&"adhocform"!=t.context||this.enableLayoutTab()},updateModelExecuted:function(e){"CreateForm"===e.action?(this.validateForm&&this.processValidations({canRefresh:!1}),this.drawPropertyBox({guid:e.guid})):"OpenForm"===e.action?(this.validateForm&&this.processValidations({canRefresh:!1}),this.drawPropertyBox({guid:e.guid})):"CreateFormFromXpath"===e.action?this.reloadXpathNode({id:e.idNode}):"OpenWizardTemplates"===e.action&&this.drawPropertyBox({guid:e.guid})},changePropertyExecuted:function(e,t){var i=this,n=t.guid;if("xpath"==t.property){var o=i.controller.model.getElement(n);i.isGrid(o.type)&&(o.deleteColumns&&o.deleteColumns(),i.render())}if("showinprocesses"==t.property&&0==t.value){var r=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getdependency"});$.when(r.processRequest()).done(function(e){if(!e){var n=bizagi.localization.getResource("templatedesigner-dependency");$.when(bizagi.showMessageBox(n),i.controller.executeCommand({command:"changeProperty",guid:t.guids[0],property:t.property,value:!0})).done(function(){i.drawPropertyBox({guid:t.guids[0],redraw:!0})})}})}if(t.refreshProperties){var a=t.guid;$.isArray(t.guids)&&(a=t.guids[0]),i.drawPropertyBox({guid:a,redraw:!0})}},changeMultiplePropertiesExecuted:function(e,t){t.refreshProperties&&this.drawPropertyBox({guid:t.guid,redraw:!0})},loadWidgetsExecuted:function(){this.refreshControlsNavigator()},formValidationsExecuted:function(e){$.isEmptyObject(e)||(this.validateForm=!0)},isGrid:function(e){return"grid"==e||"groupedgrid"===e}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawControlsNavigator:function(){var e=this,t=$("<div />").appendTo(e.getMainContainer().find("#left-tab-minitoolbar"));$.when(e.controller.getControlsNavigatorModel()).pipe(function(i){var n=e.controlsNavigator=new bizagi.editor.component.controlsnavigator.presenter({canvas:t,model:i});return n.subscribe("getMainPanel",function(t,i){return e.getMainPanel()}),n.subscribe("getMainContainer",function(t,i){return e.getMainContainer()}),e.attachHandlersControlsNavigator(),n.render({isReadOnly:e.controller.isReadOnlyForm(),isAdhocFormContext:e.controller.isAdhocFormContext()})})},attachHandlersControlsNavigator:function(){var e=this,t=e.controlsNavigator;e.controller.isReadOnlyForm()||(t.subscribe("controlDoubleClick",function(t,i){e.onControlDoubleClick(i)}),t.subscribe("controlRefreshCanvas",function(t,i){e.refreshCanvas(i)}))},onControlDoubleClick:function(e){this.executeCommand({command:"insertElementFromControlsNavigator",data:e})},refreshControlsNavigator:function(){var e=this;$.when(e.controller.getControlsNavigatorModel()).done(function(t){e.controlsNavigator&&e.controlsNavigator.render({model:t,isReadOnly:e.controller.isReadOnlyForm()})})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawBanner:function(e){var t=this,i=t.getMainContainer(),n=$("<div />").appendTo(i.find(".left-panel")),o={element:i.find(".left-panel")},r=t.banner=new bizagi.editor.component.banner.presenter({canvas:n,data:o});return r.subscribe("onBannerClick",function(e,i){t.onBannerClick(i)}),r.subscribe("onBannerOptionClick",function(e,i){t.onBannerOptionClick(i)}),r.render()},hideBanner:function(){this.banner.hide()},showBanner:function(){(this.controller.isFormContext()||this.controller.isStartFormContext())&&this.banner.show()},destroy:function(){},onBannerClick:function(e){this.performstore()},onBannerOptionClick:function(e){"function"==typeof this["perform"+e.key]&&this["perform"+e.key]()},performstore:function(){var e=this,t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"openwidgetstore"});$.when(t.processRequest()).done(function(t){if(t){var i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getwidgets"});$.when(i.processRequest()).done(function(t){t&&e.executeCommand({command:"loadWidgets",controls:t}),e.destroy()})}})},performupload:function(){var e=this,t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"installwidget"});$.when(t.processRequest()).done(function(){e.destroy()})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawStatusBar:function(e){var t=this,i=t.getMainContainer(),n=t.controller.getCurrentDevice();t.controller.getModel().enableOffline&&"Desktop"!=n?i.addClass("offline__enabled"):!t.controller.isActivityForm()&&t.controller.isOfflineFormContext()&&i.addClass("offline__enabled");var o=$("<div />").appendTo(i.find(".bar__status")),r=t.publish("getViewSelected"),a=t.statusBar=new bizagi.editor.component.statusbar.presenter({canvas:o,model:{hasOffline:Boolean(r.idOfflineForm),isOfflineForm:t.controller.isOfflineFormContext(),enablePreview:!1,isEntityForm:!t.controller.isActivityForm()},mainContainer:i});return a.subscribe("onViewPreviewOffline",function(e,n){i.addClass("offline__preview"),t.controller.setPreviewOfflineFlag(!0),t.refreshComponents()}),a.subscribe("onViewOnline",function(e,n){t.controller.setPreviewOfflineFlag(!1),i.removeClass("offline__preview"),t.refreshComponents()}),a.subscribe("onEditOfflineForm",function(e,i){t.publish("onEditOfflineForm")}),a.subscribe("onViewOnlineForm",function(){t.publish("onViewOnlineForm")}),a.subscribe("onViewOfflineForm",function(){t.publish("onViewOfflineForm")}),a.subscribe("onRestoreOfflineForm",function(){t.publish("onRestoreOfflineForm")}),a.subscribe("getMissingOfflineControls",function(){return t.controller.getMissingOfflineControls()}),a.subscribe("onOpenBizagiHelp",function(){t._catalogServices.openBizagiHelp()}),a.render()},refreshComponents:function(){this.refreshControlsNavigator(),this.refreshXpathNavigator(),this.canRefreshLayoutNavigator()&&this.refreshLayoutNavigator(),this.refresh()},refreshStatusBar:function(){var e=this.getMainContainer(),t=this.controller.getCurrentDevice();this.controller.getSupportOffline()&&"Desktop"!=t?e.addClass("offline__enabled"):e.removeClass("offline__enabled");var i=this.publish("getViewSelected");return this.statusBar.refresh({enablePreview:this.controller.getPreviewOfflineFlag(),hasOffline:Boolean(i.idOfflineForm),isOfflineForm:this.controller.isOfflineFormContext(),isEntityForm:!this.controller.isActivityForm()})},canRefreshLayoutNavigator:function(){return!this.controller.isSpecificForm()||!["Smartphone","Tablet"].includes(this.controller.getCurrentDevice())},resetStatusBar:function(){var e=this.getMainContainer();this.controller.setPreviewOfflineFlag(!1),e.removeClass("offline__preview"),this.refreshComponents()}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{mappingContext:{grid:"form",offlinegrid:"offlineform"}},{drawGridColumnEditor:function(e){var t=this,i=e.element,n=t.getMainPanel();t.controller.removeSelectedElement(),$.when(t.executeCommand({command:"getGridColumnModel",guid:e.guid})).done(function(o){var r=t.gridcolumneditor=new bizagi.editor.component.gridcolumneditor.presenter({gridModel:o,guid:e.guid,renderArea:n,element:i,device:t.controller.getCurrentDevice()});i.offset();r.render({guidSelected:t.controller.getGuidsSelected()}),r.subscribe("moveColumn",function(e,i){t.onMoveGridColumn(i)}),r.subscribe("insertControl",function(e,i){t.onInsertControlColumn(i)}),r.subscribe("insertXpath",function(e,i){t.onInsertXpathColumn(i)}),r.subscribe("selectColumn",function(e,i){t.onSelectGridColumn(i)}),r.subscribe("unselectColumn",function(e,i){t.onUnselectGridColumn(i)}),r.subscribe("showContextMenu",function(e,i){t.onShowGridColumnContextMenu(i)}),r.subscribe("performChangesInModel",function(e,i){t.onPerformChangesInModel(i)}),r.subscribe("performValidationsInModel",function(e,i){t.onPerformValidationsInModel(i)}),r.subscribe("cancelChangesInModel",function(e,i){t.onCancelChangesInModel(i)}),r.subscribe("checkCtrlKey",function(e,i){return t.controller.isCtrlKeyPressed()}),r.subscribe("processSelectedColumns",function(e,i){t.onProcessSelectedColumns(i)}),r.subscribe("updateDesignAttributesColumn",function(e,i){t.onUpdateDesignAttributesColumn(i)})})},refreshGridColumnEditor:function(){var e=this.gridcolumneditor,t=this.controller.getGuidsSelected();e&&$.when(this.executeCommand({command:"getGridColumnModel",guid:e.getGuid()})).done(function(i){e.refresh({gridModel:i,guidSelected:t})})},onInsertXpathColumn:function(e){var t=e.data,i={command:"insertElementFromXpathNavigator",data:{context:t.context,renderType:t.renderType,nodeSubtype:t.nodeSubtype,name:t.displayName,xpath:bizagi.editor.utilities.buildComplexXpath(t.xpath,t.contextScope,t.isScopeAttribute,t.guidRelatedEntity)},position:e.position,parent:e.guid};-1!==t.renderType.indexOf("adhoccolumn")&&(i.data.context="adhocgrid",i.data.displayName=t.displayName,t.parent&&(i.data.parent={guidRelatedEntity:t.parent.guidRelatedEntity}),t.guidRelatedEntity&&(i.data.guidRelatedEntity=t.guidRelatedEntity,i.data.entityContext=t.entityContext),t.predefinedValues&&(i.data.predefinedValues=t.predefinedValues)),this.executeCommand(i)},onInsertControlColumn:function(e){var t=e.data,i={command:"insertElementFromControlsNavigator",data:{renderType:t.name,name:t.name,displayName:t.displayName&&t.displayName.length>0?t.displayName:t.name},position:e.position,parent:e.guid};this.executeCommand(i)},onMoveGridColumn:function(e){var t={command:"moveElement",initialPosition:e.initialPosition,finalPosition:e.finalPosition,parent:e.guid};this.executeCommand(t)},onSelectGridColumn:function(e){var t=this,i=t.executeCommand({command:"getElementProperties",guid:e.guid});t.currentSelectedElement=e.guid,void 0===e.ctrlIsPressed&&t.controller.removeSelectedElement(),t.controller.addSelectedElement(e.guid,e),$.when(t.showElementXpath(i.xpath)).done(function(){t.onDrawComponents(e)})},onShowGridColumnContextMenu:function(e){var t=this;if(!t.controller.thereAreMultiselection()||!t.controller.getSelectedElements(e.guid)){var i=t.executeCommand({command:"getElementProperties",guid:e.guid});t.contextmenu&&t.contextmenu.destroy(),$.when(t.showElementXpath(i.xpath)).done(function(){t.drawContextMenu({guid:e.guid,position:e.position})})}},onCancelChangesInModel:function(e){this.executeCommand({command:"updateGridColumnModel",gridModel:e.gridModel,canUndo:!1}),this.executeCommand({command:"changeContext",context:this.getContext()}),this.currentSelectedElement=null,this.controller.removeSelectedElement()},onPerformChangesInModel:function(){this.executeCommand({command:"changeContext",context:this.getContext()}),this.currentSelectedElement=null,this.controller.removeSelectedElement()},onPerformValidationsInModel:function(){this.currentSelectedElement=null,this.hidePropertyBox(),this.onPerformChangesInModel(),this.gridcolumneditor.destroy()},onUnselectGridColumn:function(e){this.currentSelectedElement=null,e&&void 0!==e.ctrlIsPressed?this.controller.removeSelectedElement(e.guid):this.controller.removeSelectedElement(),this.hidePropertyBox(),this.refreshRibbon(),this.destroyDecorator(),this.onProcessSelectedColumns(e)},onDrawComponents:function(e){this.controller.thereAreMultiselection()?(this.removeDecorator(),this.drawPropertyBox({guid:this.controller.getGuidsSelected()})):(this.hidePropertyBox(),this.refreshRibbon(e.guid),this.drawDecorator($.extend(e,{IsOnClickEvent:!0})))},onProcessSelectedColumns:function(e){e=e||{};var t=this.controller.getGuidsSelected();if(1===t.length){var i=this.controller.getSelectedElements(t[0]);this.controller.removeSelectedElement(),this.onSelectGridColumn($.extend({IsOnClickEvent:!0},i))}else t.length>1&&this.onDrawComponents(e)},onUpdateDesignAttributesColumn:function(e){e.command="changeDesignAttributes",this.executeCommand(e)},getContext:function(){return this.controller.getOriginalContext()}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawSearchResultEditor:function(){var e=this;$.when(e.executeCommand({command:"getSearchResultModel"})).done(function(t){var i=e.createSearchResultCanvas(),n=e.controller.getCurrentDevice(),o=e.searchresulteditor=new bizagi.editor.component.searchresulteditor.presenter({searchResultModel:t,canvas:i,device:n});o.render(),o.subscribe("moveColumn",function(t,i){e.onMoveColumn(i)}),o.subscribe("insertXpath",function(t,i){e.onInsertXpath(i)}),o.subscribe("selectColumn",function(t,i){e.onSelectColumn(i)}),o.subscribe("unSelectColumn",function(t,i){e.onUnSelectColumn(i)})})},createSearchResultCanvas:function(){return $("#search-result-panel .bz-fm-searchresult-content",this.getMainContainer())},refreshSearchFormResult:function(){var e=this,t=e.searchresulteditor;t&&$.when(e.executeCommand({command:"getSearchResultModel"})).done(function(i){t.refresh({searchResultModel:i,currentSelectElement:e.currentSelectedElement,device:e.controller.getCurrentDevice()})})},onInsertXpath:function(e){var t=e.data,i={command:"insertElementFromXpathNavigator",data:{renderType:t.renderType,name:t.displayName,displayName:t.displayName,xpath:bizagi.editor.utilities.buildComplexXpath(t.xpath,t.contextScope,t.isScopeAttribute,t.guidRelatedEntity)},position:e.position,searchformresult:!0};this.executeCommand(i)},onMoveColumn:function(e){var t={command:"moveElement",initialPosition:e.initialPosition,finalPosition:e.finalPosition,elementType:"searchresult"};this.executeCommand(t)},onSelectColumn:function(e){var t=this.executeCommand({command:"getElementProperties",guid:e.guid});this.hidePropertyBox(),this.refreshRibbon(e.guid),this.currentSelectedElement=e.guid,this.drawDecorator($.extend(e,{IsOnClickEvent:!0}),!0),this.showElementXpath(t.xpath)},onUnSelectColumn:function(){this.currentSelectedElement=null,this.hidePropertyBox(),this.removeDecorator()}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawButtonEditor:function(){var e=this,t=e.createButtonEditorCanvas(),i=e.buttoneditor=new bizagi.editor.component.buttoneditor.presenter({canvas:t});i.subscribe("getRenderingFacade",function(t,i){return e.getRenderingFacade()}),i.subscribe("getDevice",function(t,i){return e.controller.getCurrentDevice()}),e.attachHandlersButtonEditor(),e.refreshButtonEditor()},attachHandlersButtonEditor:function(){var e=this,t=e.buttoneditor;e.controller.isReadOnlyForm()||(t.subscribe("selectButton",function(t,i){e.lastActionExecuted="selectButton",e.onSelectButton(i)}),t.subscribe("unselectButton",function(t,i){e.lastActionExecuted="unselectButton",e.onUnselectButton(i)}),t.subscribe("addButton",function(t,i){e.lastActionExecuted="addButton",e.onAddButton(i)}),t.subscribe("moveButton",function(t,i){e.lastActionExecuted="moveButton",e.onMoveButton(i)}))},refreshButtonEditor:function(){var e=this,t=e.buttoneditor,i=e.controller.getContextInfo().guid,n=e.executeCommand({command:"getElementProperty",guid:i,property:"usecustombuttons"});(n=n||e.controller.isStartFormContext())?(e.showButtonEditor(),t&&$.when(e.executeCommand({command:"getButtonModel"})).done(function(i){var n=e.controller.getGuidsSelected()[0]?e.controller.getSelectedElements(e.controller.getGuidsSelected()[0]):null;t.refresh({buttonModel:i,options:{element:n},isReadOnly:e.controller.isReadOnlyForm(),allowAddButtons:e.controller.isFormContext(),lastActionExecuted:e.lastActionExecuted})})):e.hideButtonEditor()},showButtonEditor:function(){$(".wrapper-main-panel",this.getMainContainer()).addClass("bz-form-buttons-enabled")},hideButtonEditor:function(){$(".wrapper-main-panel",this.getMainContainer()).removeClass("bz-form-buttons-enabled")},createButtonEditorCanvas:function(){return $("#button-editor-panel",this.getMainContainer())},onSelectButton:function(e){this.currentSelectedElement=e.guid,this.controller.removeSelectedElement(),this.controller.addSelectedElement(e.guid,e),this.hidePropertyBox(),this.refreshRibbon(e.guid),this.controller.isFormContext()?this.drawDecorator($.extend(e,{IsOnClickEvent:!0})):this.drawPropertyBox({guid:e.guid}),this.applyCopyFormat(e.guid)},onUnselectButton:function(){this.currentSelectedElement=null,this.hidePropertyBox(),this.refreshRibbon(),this.removeDecorator()},onAddButton:function(){this.hidePropertyBox(),this.removeDecorator(),this.executeCommand({command:"insertButton"})},onMoveButton:function(e){var t={command:"moveElement",initialPosition:e.initialPosition,finalPosition:e.finalPosition,elementType:"button"};this.executeCommand(t)}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{configureRenderingView:function(){var e=this,t=e.controller.getModel().getForm(),i=new $.Deferred;return e.loadFormDeferred=new $.Deferred,e.renderingView=e.getRenderingFacade(),$.when(t.ready()).pipe(function(){var t={data:e.controller.getRenderingModel(),canvas:e.getMainPanel(),mode:e.renderingMode};return e.renderingView.execute(t)}).done(function(t){e.formContainer=t,e.controller.getIsInCheckout()&&e.drawReadOnlyEditor(t.container),e.loadFormDeferred.resolve(),i.resolve(),setTimeout(function(){e.applyThemeToRendering()},100),$(document).ready(function(){e.applyThemeToRendering()}),$(window).bind("resize.rendering",function(){e.applyThemeToRendering()})}),i.promise()},applyThemeToRendering:function(){var e,t=this.getMainPanel(),i=this.getMainContainer();$(".wrapper-main-scroll",i),e=$("> .ui-bizagi-container-form",t),"layout"===this.renderingMode?t.addClass("bz-main-layout-mode"):"design"===this.renderingMode&&t.removeClass("bz-main-layout-mode"),0===e.children().length&&e.append('<div class="children"></div>'),e.addClass("biz-form").addClass("biz-draft-border"),this.renderingView.publish("controlRefreshCanvas"),$(".ui-bizagi-container-form > .children",i).attr("drophere",bizagi.localization.getResource("formmodeler-component-editor-layout-drophere-containers"));$(".ui-bizagi-container-panel, :not(.bz-form), .ui-bizagi-container-group, .ui-bizagi-container-nestedform, .ui-bizagi-container-horizontal, .ui-col > .children, .bz-layout-col > .children,  .ui-bizagi-container-tab, .ui-bizagi-render:last, .ui-bizagi-render:first, .bz-form-old-item:last, .bz-form-old-item:first",i).attr("drophere",bizagi.localization.getResource("formmodeler-component-editor-layout-drophere")),$(".ui-drop-here-layout",i).attr("drophere",bizagi.localization.getResource("formmodeler-component-editor-layout-drophere"));var n=$('<style id="drophere"></style>');if(0===$("#drophere",i).length){var o=$("head");o.append(n),$("#drophere",o).append('.ui-bizagi-placeholder:before,  #bz-fm-grid-columneditor[class*="drop-here"]:before {content:"'+bizagi.localization.getResource("formmodeler-component-editor-layout-drophere")+'"}')}},createMsgValidationTooltip:function(){var e=this.getMainPanel();$(".ui-bizagi-render-icon-editor-msg-validation[title], .ui-bizagi-container-icon-editor-msg-validation-templates[title]",e).tooltip({tooltipClass:"ui-widget-content ui-msg-validation-tooltip",content:function(){var e=$(this);if(e[0]&&e[0].attributes["data-title"])return e[0].attributes["data-title"].value;if(e[0]&&e[0].title){var t=e[0].title;return e[0].title="",t}}})},formIsLoaded:function(){return this.loadFormDeferred.promise()},removeMsgValidationTooltip:function(){var e=this.getMainPanel();$(".ui-msg-validation-tooltip",e).remove()},refreshRenderingView:function(e,t){void 0!==this.renderingView&&(t=t||this.renderingMode,this.renderingMode=t,this.showRenderingModel())},showRenderingModel:function(){var e=this,t="Desktop"==e.controller.getCurrentDevice(),i=!t&&e.controller.getPreviewOfflineFlag();t&&e.controller.getPreviewOfflineFlag()&&(e.refreshControlsNavigator(),e.refreshXpathNavigator(),e.refreshLayoutNavigator());var n=i?e.controller.getPreviewOfflineRenderingModel():e.controller.getRenderingModel(),o=e.getRenderingFacade();$.when(n).done(function(t){var i=e.getMainPanel(),n={data:t,mode:e.renderingMode,canvas:i,focus:e.currentFocus},r=i[0].scrollTop;$.when(o.update(n)).done(function(t){e.formContainer=t,i[0].scrollTop=r,"resolved"!==e.loadFormDeferred.state()&&e.loadFormDeferred.resolve(),"design"===e.renderingMode&&t.selectElementByGuid(e.controller.getGuidsSelected()),e.controller.getIsInCheckout()&&e.drawReadOnlyEditor(t.container),e.controller.isTemplateContext()?e.applyThemeToTemplates():e.applyThemeToRendering(),e.validateForm&&(e.removeMsgValidationTooltip(),e.createMsgValidationTooltip())})})},setCurrentFocus:function(e){this.currentFocus=e},isLayoutMode:function(){return"layout"===this.renderingMode},processSelectedElements:function(e){var t=this.controller.getGuidsSelected();1===t.length?(e=this.controller.getSelectedElements(t[0]),this.controller.removeSelectedElement(),this.onRenderingViewElementSelected($.extend({IsOnClickEvent:!0},e))):t.length>1&&this.drawComponents()},drawComponents:function(e){var t=(e=e||{}).args;this.controller.thereAreMultiselection()?(this.removeDecorator(),t&&!t.IsOnClickEvent||this.drawPropertyBox({guid:this.controller.getGuidsSelected()}),this.refreshRibbon()):(this.drawDecorator(t),this.refreshRibbon(t.guid),this.applyCopyFormat(t.guid))},deleteElement:function(){var e=this.controller.getGuidsSelected();e&&(this.hidePropertyBox(),this.executeCommand({command:"removeElementById",guids:e}),this.currentSelectedElement=null)},onRenderingViewSortStart:function(){this.hidePropertyBox(),this.getMainPanel().addClass("bz-main-dashed-grid")},onRenderingViewSortFinish:function(e){var t=this,i=t.getMainPanel(),n=e.source.data;i.removeClass("bz-main-dashed-grid"),e.source&&e.source.toolbar?t.executeCommand({command:"insertElementFromControlsNavigator",position:e.finalPosition,parent:e.targetContainer,data:e.source.data}):e.source&&e.source.xpathNavigator?(e.source.data.xpath=bizagi.editor.utilities.buildComplexXpath(e.source.data.xpath,e.source.data.contextScope,e.source.data.isScopeAttribute,e.source.data.guidRelatedEntity),"nestedform"===n.renderType?t.processAddEntityForm(n).then(function(i){t.executeCommand({command:"insertElementFromXpathNavigator",position:e.finalPosition,parent:e.targetContainer,data:i})}):t.executeCommand({command:"insertElementFromXpathNavigator",position:e.finalPosition,parent:e.targetContainer,data:e.source.data})):e.source&&e.source.layout?t.executeCommand({command:"createAndInsertControlLayoutInModel",position:e.finalPosition,parent:e.targetContainer,id:e.source.data}):e.sourceContainer===e.targetContainer?e.initialPosition!==e.finalPosition&&t.executeCommand({command:"moveElement",initialPosition:e.initialPosition,finalPosition:e.finalPosition,parent:e.targetContainer}):t.executeCommand({command:"moveElementContainer",posIni:e.initialPosition,posEnd:e.finalPosition,parentSource:e.sourceContainer,parentTarget:e.targetContainer})},processAddEntityForm:function(e){var t=this;return new Promise(function(i,n){var o=t.getDeviceInfo();if(o.isSpecific){var r=t.controller.getModel();t.cloneService.clone(r.getElementFactory(),e.guid,o,e.guid).then(function(t){i($.extend({},e,{guid:t}))})}else i(e)})},processAddEntitySearchForm:function(e){var t=this;return new Promise(function(i,n){var o=t.getDeviceInfo();if(o.isSpecific){var r=t.controller.getModel();t.cloneService.clone(r.getElementFactory(),e.guid,$.extend(o,{context:"searchform"}),e.guid).then(function(t){i($.extend({},e,{guid:t}))})}else i(e)})},onRenderingViewElementUnselected:function(e){this.currentSelectedElement=null,e&&void 0!==e.ctrlIsPressed?this.controller.removeSelectedElement(e.guid):this.controller.removeSelectedElement(),this.hidePropertyBox(),this.removeDecorator(),this.refreshRibbon(),this.processSelectedElements(e)},onRenderingSelectForm:function(e){this.drawPropertyBox({formProperties:!0})},onRenderingViewElementSelected:function(e){var t=this,i=t.executeCommand({command:"getElementProperties",guid:e.guid}),n=$.Deferred(),o={args:e,decorator:!0,ribbon:!0,copyFormat:!0};return e.IsOnClickEvent?(t.currentSelectedElement=e.guid,void 0===e.ctrlIsPressed&&t.controller.removeSelectedElement(),t.controller.addSelectedElement(e.guid,e),"nestedForm"==e.type?$.when(t.showElementGuid(i.form,i.xpath)).done(function(){t.drawComponents(o),n.resolve(!0)}):e.isInternal?$.when(t.showMetadataXpath(i.xpath)).done(function(){t.drawComponents(o),n.resolve(!0)}):$.when(t.showElementXpath(i.xpath)).done(function(){t.drawComponents(o),n.resolve(!0)})):(t.drawComponents(o),n.resolve(!0)),n.promise()},applyCopyFormat:function(e){var t;if(this.controller.copyFormatHasElement()){var i=this.controller.getCopyFormatElement();i.guid!==e&&(i=this.controller.popCopyFormat(),t={command:"changeMultipleProperties",guid:e,properties:bizagi.clone(i.properties)},this.executeCommand(t))}},onRenderingViewStartLabelEdition:function(){var e=this;setTimeout(function(){e.formContainer.disableSortablePlugin()},150),e.hidePropertyBox()},onRenderingViewFinishLabelEdition:function(){var e=this;setTimeout(function(){e.refresh()},100)},onRenderingViewElementChangeLabel:function(e){this.executeCommand({command:"changeProperty",guid:e.guid,property:"displayName",value:e.value})},onRenderingViewElementRightClick:function(e){var t=this;if(!t.controller.thereAreMultiselection()||!t.controller.getSelectedElements(e.guid)){var i=t.executeCommand({command:"getElementProperties",guid:e.guid});t.contextmenu&&t.contextmenu.destroy(),$.when(t.showElementXpath(i.xpath)).done(function(){t.drawContextMenu({guid:e.guid,position:e.position})})}},onRenderingViewTabAdd:function(e){this.executeCommand({command:"insertTabItem",tab:e.guid})},onRenderingViewTabDelete:function(e){var t=e.guid,i=this.controller.getModel().getElement(t).parent;i.activeTab==e.guid&&i.assignActiveTab(void 0),this.executeCommand({command:"removeElementById",guid:e.guid})},onRenderingViewTabActivate:function(e){var t=this,i=e.guid;t.controller.getModel().getElement(i).parent.assignActiveTab(i),t.setCurrentFocus(e.guid),t.currentSelectedElement=null,setTimeout(function(){t.refreshCanvas()},10)},onRenderingShowSearchForm:function(e){var t=this.executeCommand({command:"getElementProperties",guid:e.guid});t&&t.searchforms&&$.isArray(t.searchforms)&&this.performSelectFormButton({value:t.searchforms})},onRenderingShowPropertiesForm:function(){this.performShowFormProperties()},onRenderingShowProperties:function(e){this.drawPropertyBox(e)},onCheckCtrlKey:function(){return!(this.isLayoutMode()||!this.controller.isCtrlKeyPressed())},onResizeImage:function(e){this.executeCommand({command:"changeMultipleProperties",guid:e.guid,properties:e.properties,refreshProperties:!0})},onGetRenderElement:function(e){return this.formContainer?this.formContainer.getRenderById(e.id):null},refreshElement:function(e){var t;if(this.formContainer&&e.container){t=e.container.properties.id;var i=this.formContainer.getRenderById(t);i&&(i.refreshDesignContainer(e),this.refreshCanvas())}},onRefreshControl:function(e){this.executeCommand({command:"refreshControl",guid:e.guid,canvas:e.canvas})},onGetParentId:function(e){return this.controller.model.getElement(e.guid).parent.guid},onSetLastInsertedElement:function(e){this.controller.setLastInsertedElement(e)},onGetLastInsertedElement:function(){return this.controller.getLastInsertedElement()},onGetControlIcon:function(e){return(this.controller.model.getElement(e.id)||{style:"bz-studio bz-layout-full_16x16_standard"}).style},unsubscribeAll:function(){var e=this;e.renderingView.unsubscribe("sortstart"),e.renderingView.unsubscribe("sortfinish"),e.renderingView.unsubscribe("unselectelement"),e.renderingView.unsubscribe("selectelement"),e.renderingView.unsubscribe("canChangeLabel"),e.renderingView.unsubscribe("startlabeledition"),e.renderingView.unsubscribe("finishlabeledition"),e.renderingView.unsubscribe("changelabel"),e.renderingView.unsubscribe("elementrightclick"),e.renderingView.unsubscribe("addtab"),e.renderingView.unsubscribe("deletetab"),e.renderingView.unsubscribe("activatetab"),e.renderingView.unsubscribe("showsearchform"),e.renderingView.unsubscribe("showProperties"),e.renderingView.unsubscribe("showPropertiesForm"),e.renderingView.unsubscribe("controlRefreshCanvas"),e.renderingView.unsubscribe("selectcontainerform"),e.renderingView.unsubscribe("checkCtrlKey"),e.renderingView.unsubscribe("resizeImage"),e.renderingView.unsubscribe("refreshControl"),e.renderingView.unsubscribe("getparentid"),e.renderingView.unsubscribe("getLastInsertedElement"),e.renderingView.unsubscribe("getControlIcon"),e.renderingView.unsubscribe("setLastInsertedElement"),e.renderingView.unsubscribe("unsubscribeAll"),e.renderingView.unsubscribe("getMainPanel"),e.renderingView.unsubscribe("getMainContainer")}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{configureTemplateView:function(){var e=this,t=e.controller.getRenderingModel(),i={data:t,canvas:e.getMainPanel(),mode:e.renderingMode};e.renderingView=e.desktopRenderingFacade=new bizagi.rendering.facade,bizagi.log("Rendering with ...",t),e.renderingView.subscribe("dropfinish",function(t,i){i.sourceGuid?e.onRenderingReplaceAndRestoreElement(i):e.onRenderingViewUpdateElement(i)}),e.renderingView.subscribe("changelabel",function(t,i){i.value?($.extend(i,{property:"displayName",renderType:"label"}),i.value=bizagi.editor.utilities.buildComplexLocalizable(i.value,i.guid,"displayName"),e.onRenderingViewUpdateElement(i)):e.refresh()}),e.renderingView.subscribe("deleteRepeaterItem",function(t,i){e.onDeleteRepeaterItem(i)}),e.renderingView.subscribe("unselectelement",function(t,i){e.onRenderingViewElementUnselected(i)}),e.renderingView.subscribe("selectelement",function(t,i){e.onRenderingViewElementSelected(i)}),e.renderingView.subscribe("selectcontainerform",function(t,i){e.onRenderingSelectForm(i)}),e.renderingView.subscribe("canChangeLabel",function(t,i){return e.onTemplateChangeLabel(i)}),e.renderingView.subscribe("restoreItem",function(t,i){e.onRestoreItem(i)}),e.renderingView.subscribe("isDeleteOptionAllowed",function(t,i){return e.onIsDeleteOptionAllowed(i)}),e.renderingView.subscribe("controlRefreshCanvas",function(t,i){setTimeout(function(){e.refreshCanvas(i)},0)}),e.renderingView.subscribe("hideElement",function(t,i){e.onHideElement(i)}),$.when(e.renderingView.execute(i)).done(function(t){e.formContainer=t,e.controller.isReadOnlyForm()&&e.drawReadOnlyEditor(t.container),e.applyThemeToTemplates(),$(document).ready(function(){e.applyThemeToTemplates()}),$(window).resize(function(){e.applyThemeToTemplates()})})},applyThemeToTemplates:function(){var e,t=this.getMainPanel(),i=this.getMainContainer();$(".wrapper-main-scroll",i),e=$("> .bz-design-template",t),"layout"===this.renderingMode?t.addClass("bz-main-layout-mode"):"design"===this.renderingMode&&t.removeClass("bz-main-layout-mode"),0===e.children().length&&e.append('<div class="children"></div>'),e.addClass("biz-form").addClass("biz-draft-border"),this.renderingView.publish("controlRefreshCanvas")},onRenderingReplaceAndRestoreElement:function(e){this.executeCommand($.extend({command:"replaceAndRestoreElement"},e))},onRenderingViewUpdateElement:function(e){"layoutLabel"===this.controller.model.getElement(e.guid).type?this.executeCommand({command:"changeProperty",guid:e.guid,property:"displayName",value:e.value}):this.executeCommand($.extend({command:"updateElement"},e))},onDeleteRepeaterItem:function(e){this.executeCommand($.extend({command:"deleteRepeaterItem"},e))},onTemplateChangeLabel:function(e){return":image"!=this.executeCommand({command:"getElementProperties",guid:e.guid}).type},onRestoreItem:function(e){this.executeCommand({command:"updateElement",guid:e.guid,renderType:"layoutPlaceholder",toInitialState:!0})},onIsDeleteOptionAllowed:function(e){var t=this.controller.getModel().getElement(e.guid);return!!t&&("layoutPlaceholder"!=t.type&&!(t.properties.type&&t.properties.type.search(/image/gi)>=0))},onHideElement:function(e){this.executeCommand({command:"changeProperty",guid:e.guid,property:"hide",value:!0})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawSelectFormEditor:function(e){this.decorator.canvas.find(".bizagi_editor_component_editor_form").detach();var t=this.decorator.canvas.find(".editor-ui-actions-container"),i=$("<div />").appendTo(t),n=$.extend(this.executeCommand({command:"getSelectFormModel",guid:e.guid,property:e.property}),{caption:e.caption});this.getRelatedForms(n),(this.formSelector=new bizagi.editor.component.editor.form.presenter({canvas:i,model:n})).render()},getRelatedForms:function(e){if("object"==typeof e.xpath){var t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"relatedforms",xpath:bizagi.editor.utilities.resolveComplexXpath(e.xpath),context:e.context});$.when(t.processRequest()).done(function(t){t&&(e.relatedForms=t)})}}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawLayoutNavigator:function(){var e=this,t=$("<div />").addClass("bizagi_editor_layoutnavigator_container").appendTo(e.getMainContainer().find("#left-tab-layout"));$.when(e.controller.getLayoutNavigatorModel()).pipe(function(i){var n=e.layoutNavigator=new bizagi.editor.component.layoutnavigator.presenter({canvas:t,model:i});return n.subscribe("getMainContainer",function(t,i){return e.getMainContainer(i)}),n.subscribe("getMainPanel",function(t,i){return e.getMainPanel(i)}),e.attachHandlersLayoutNavigator(),n.render({isReadOnly:e.controller.isReadOnlyForm()})})},attachHandlersLayoutNavigator:function(){var e=this,t=e.layoutNavigator;!e.controller.isReadOnlyForm()&&t&&(t.subscribe("layoutDoubleClick",function(t,i){e.onLayoutDoubleClick(i)}),t.subscribe("controlRefreshCanvas",function(t,i){e.refreshCanvas(i)}))},onLayoutDoubleClick:function(e){var t={command:"addControlLayoutInModel",id:e.id};this.executeCommand(t)},refreshLayoutNavigator:function(){var e=this;$.when(e.controller.getLayoutNavigatorModel()).done(function(t){e.layoutNavigator.render({model:t,isReadOnly:e.controller.isReadOnlyForm()})})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawRibbon:function(){var e=this,t=$("<div />").appendTo(e.getMainContainer().find(".ribbon-panel")),i=e.publish("getViewSelected")||{};return $.when(e.executeCommand({command:"getRibbonModel",validFormChecked:e.validateForm})).pipe(function(n){var o=e.ribbon=new bizagi.editor.component.ribbon.presenter({canvas:t,viewId:(i.relatedView||"")+"_"+e.controller.getContext(),model:Object.assign(n,{supportOffline:e.controller.isActivityForm()})});return o.subscribe("onItemClicked",function(t,i){e.onItemRibbonClick($.extend(i,{guid:o.getGuid()}))}),o.subscribe("getMainContainer",function(t,i){return e.getMainContainer()}),o.render()})},refreshRibbon:function(e){var t=this;t.controller.thereAreMultiselection()&&(e=bizagi.editor.utilities.getGuidEmpty()),e=e||t.currentSelectedElement,$.when(t.executeCommand({command:"getConvertToModel",guid:e})).pipe(function(i){return t.executeCommand({command:"getRibbonModel",guid:e,convertToModel:i,validFormChecked:t.validateForm})}).done(function(i){t.ribbon&&t.ribbon.render({model:i,guid:e})})},onItemRibbonClick:function(e){var t=this,i=e.action;e.property&&e.value&&!e.action&&("expression"!=e.value?t.executeCommand({command:"changeProperty",guid:e.guid,property:e.property,value:e.value}):t.showExpressionSelector(e.property,e.guid)),"undo"==i&&t.performUndo(),"redo"==i&&t.performRedo(),"save"==i&&t.performSave().then(function(){t.publish("onFormSaved")}),"copy-from"==i&&t.performCopyFrom(),"copy-format"==i&&t.performCopyFormat(e),"actionsvalidations"==i&&t.performShowActionsValidations(),"formproperties"==i&&t.performShowFormProperties(),"delete"==i&&t.performDelete(e.guid),"rename"==i&&t.performRename(e.guid),"validate"==i&&t.performValidate(),"Language"==i&&t.performChangeEditorLanguage(e),"useCustomButtons"==i&&t.enableOrDisableCustomButtons(e),"checkout"==i&&t.performCheckout(e),"useOfflineForm"==i&&t.enableOrDisableOfflineFormOption(e),"emailTemplate"==i&&t.performEmailTemplate(e),"createSpecific"===i&&t.performCreateSpeficicForm(e),"backToGeneric"===i&&t.performBackToGenericForm(e),"enableOffline"==i&&t.performEnableOffline(e.value),"convert"==i&&t.performConvertTo(e)},performConvertTo:function(e){this.executeCommand({command:"convertTo",guid:e.guid,convertTo:e.property})},performUndo:function(){this.undo()},performRedo:function(){this.redo()},performCreateSpeficicForm:function(){this.publish("createSpecificForm",{})},performBackToGenericForm:function(){this.publish("backToGenericForm",{})},performCloseDesigner:function(e){var t=this;return new Promise(function(i,n){t.dialog?i():$.when(t.processValidations({canRefresh:!0}),t.controller.thereAreChangesInForm()).done(function(o,r){if(r||!t.controller.isReadOnlyForm()&&o.showMessage){t.dialog=new bizagi.editor.component.dialog.presenter,t.dialog.subscribe("getMainContainer",function(){return t.getMainContainer()}),t.dialog.subscribe("onSaveForm",function(){$.when(t.saveForm()).done(function(){i()})}),t.dialog.subscribe("onDiscard",function(){i()}),t.dialog.subscribe("onCancel",function(){n()}),t.dialog.subscribe("onViewErrors",function(){n()});var a='"'+e.displayName+'"',s=bizagi.localization.getResource("bizagi-editor-form-dialog-close"),l="";o.showMessage?l=bizagi.localization.getResource("bizagi-editor-form-save-warning-message").replace("{0}",a):r&&(l=bizagi.localization.getResource("bizagi-editor-close-form-save-message").replace("{0}",a));l="";o.showMessage?l=bizagi.localization.getResource("bizagi-editor-form-save-warning-message").replace("{0}",a):r&&(l=bizagi.localization.getResource("bizagi-editor-close-form-save-message").replace("{0}",a));var d={name:"bz-dialog-perfomsave",title:s,isTemplate:t.controller.isTemplateContext(),hasErrors:o.showMessage,hasChanges:r,closeForm:!0,message:l};$.when(t.dialog.show({data:d})).done(function(){t.dialog=null})}})})},performSave:function(e){var t=this,i=t.publish("getViewSelected")||{displayName:""};return new Promise(function(n,o){t.dialog?n():$.when(t.processValidations({canRefresh:!0}),t.controller.thereAreChangesInForm()).done(function(o,r){if(r||!t.controller.isReadOnlyForm()&&o.showMessage)if(o.showMessage||e){t.dialog=new bizagi.editor.component.dialog.presenter,t.dialog.subscribe("getMainContainer",function(){return t.getMainContainer()}),t.dialog.subscribe("onSaveForm",function(){$.when(t.saveForm()).done(function(i){e&&i&&t.closeForm(),n()})}),t.dialog.subscribe("onCancel",function(){n()}),t.dialog.subscribe("onDiscard",function(){e&&t.closeForm(),n()}),t.dialog.subscribe("onViewErrors",function(){n()});var a=t.controller.isTemplateContext(),s=a?bizagi.localization.getResource("bizagi-editor-template-dialog-save"):bizagi.localization.getResource("bizagi-editor-form-dialog-save");e&&(s=a?bizagi.localization.getResource("bizagi-editor-template-dialog-close"):bizagi.localization.getResource("bizagi-editor-form-dialog-close"));var l="";i.displayName&&(l='"'+i.displayName+'"');var d="";o.showMessage?d=bizagi.localization.getResource("bizagi-editor-form-save-warning-message").replace("{0}",l):r&&(d=bizagi.localization.getResource("bizagi-editor-close-form-save-message").replace("{0}",l));var c={name:"bz-dialog-perfomsave",title:s,isTemplate:t.controller.isTemplateContext(),hasErrors:o.showMessage,hasChanges:r,closeForm:e,message:d};$.when(t.dialog.show({data:c})).done(function(){t.dialog=null})}else r&&(t.saveForm(),n());else e&&(t.closeForm(),n())})})},performCopyFrom:function(){var e=this,t=bizagi.editor.base.services.resourcesServices;if(!e.loadingCopyForm){e.loadingCopyForm=!0;var i=$("body"),n=new bizagi.editor.component.wait.presenter({model:{message:"Copy form"},renderArea:i}),o={actiontype:"LoadCopyForm",parameters:[{key:"guidContext",value:BIZAGI_IDENTIFIER_MODEL},{key:"user",value:BIZAGI_USER}]};$.when(t.getResource(o),n.render()).done(function(t){var i=(t=Array.isArray(t)?t[0]:t).result;if(i.success){var n=e.controller.getModel(),o=i.parameters[0].value,a=e.getDeviceInfo();e.cloneService.copyForm(n.getElementFactory(),o,a).then(function(t){var i=Object.assign(t,{command:"insertElements"});e.executeCommand(i),r()})}else r()})}function r(){setTimeout(function(){n.destroy(),e.loadingCopyForm=!1},100)}},performCopyFormat:function(e){this.executeCommand({command:"copyFormat",guid:e.guid})},performShowActionsValidations:function(){this.drawCommandsEditor()},performShowFormProperties:function(){this.drawPropertyBox({formProperties:!0})},performDelete:function(e){this.hidePropertyBox(),this.executeCommand({command:"removeElementById",guid:e})},performRename:function(e){var t;(t=$('[guid="'+e+'"]')).find(".ui-bizagi-container-input-editable > input.ui-bizagi-input-editable").length>0||$("label",t).trigger("dblclick")},performEnableOffline:function(e){var t=this;this.publish("onChangeOfflineMode",{offlineState:e}).then(function(i){if(i){t.executeCommand({command:"enableOffline",value:e}),e||t.controller.setPreviewOfflineFlag(e),t.setSupportOffline(e);var n=t.controller.getCurrentDevice(),o=t.getMainContainer();e&&"Desktop"!=n?o.addClass("offline__enabled"):o.removeClass("offline__enabled")}t.refreshComponents()})},performValidate:function(){this.validateForm=!this.validateForm,this.validateForm?this.controller.isTemplateContext()?this.processTemplateValidations({canRefresh:!0}):this.processValidations({canRefresh:!0}):this.removeValidations({canRefresh:!0})},performChangeEditorLanguage:function(e){e.canValidate=!0,bizagi.editorLanguage=e.value,this.refresh(e)},enableOrDisableOfflineFormOption:function(){var e=this.controller.getContextInfo().guid,t=this.executeCommand({command:"getElementProperty",guid:e,property:"useofflineform"});t=t||!1,this.executeCommand({command:"changeProperty",guid:e,property:"useofflineform",value:!t})},performEmailTemplate:function(){var e=this,t=e.controller.getContextInfo().guid,i=e.executeCommand({command:"getElementProperty",guid:t,property:"emailintegration"});bizagi.log("VALUE "+i);var n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"loadtemplate",template:i||{baref:{ref:"template"}}});$.when(n.processRequest()).done(function(i){i&&!i.isEmpty&&e.executeCommand({command:"changeProperty",guid:t,property:"emailintegration",value:i})})},enableOrDisableCustomButtons:function(){var e=this,t=e.controller.getContextInfo().guid,i=e.executeCommand({command:"getElementProperty",guid:t,property:"usecustombuttons"}),n=e.controller.getRibbonModel();if(1==i){var o=bizagi.localization.getResource("formmodeler-component-ribbon-useCustomButtons-validation");$.when(bizagi.showConfirmationBox(o,"Bizagi","warning")).done(function(){i=i||!1,n.hideGroup("email"),e.executeCommand({command:"changeProperty",guid:t,property:"usecustombuttons",value:!i})})}else i=i||!1,n.showGroup("email"),e.executeCommand({command:"changeProperty",guid:t,property:"usecustombuttons",value:!i})},performCheckout:function(e){var t=this;$.when(t.checkStatusForm()).done(function(e){e.isInCheckout?t.showUserInformation():t.checkoutForm()})},saveForm:function(){var e=this,t=$.Deferred(),i=$("#root");return 0===i.length&&(i=e.getMainContainer()),$.when(e.executeCommand({command:"saveModel"})).done(function(n){var o={message:bizagi.localization.getResource("formmodeler-component-wait-message-save")},r=new bizagi.editor.component.wait.presenter({model:o,renderArea:i});$.when(r.render()).done(function(){var i=e.channel.createProtocol({protocol:"saveform",jsonForm:n.dataModel,changeset:n.changeset,idForm:n.idForm,isNewForm:e.controller.isNewForm(),isSpecific:e.isSpecific,parentId:n.parentId}),o=n.deployOnParent;setTimeout(function(){$.when(i.processRequest()).done(function(i){if((i=i||{}).canBeSaved)e.controller.setNewForm(!1),e.controller.getModel().setDeployOnParent(o),e._catalogServices.getShallowByIdWithChildren("Resource",e.controller.getIdForm()).then(function(t){t.length&&e.controller.setResources(t[0].children),e.controller.setOriginalModel(),e.refreshPropertyBox()});else{var n=i.userInfo||{},a=i.isInCheckout?bizagi.localization.getResource("bizagi-editor-force-checkout-message").replace("{0}",n.userFullName):bizagi.localization.getResource("bizagi-editor-force-checkout-reopen-message");$.when(bizagi.showMessageBox(a,"Bizagi")).done(function(){})}r.destroy(),t.resolve(i.canBeSaved)})},200)})}),t.promise()},closeForm:function(){this.channel.createProtocol({protocol:"closeform",idForm:this.controller.getIdForm()}).processRequest()},checkStatusForm:function(){var e=new $.Deferred,t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getstatusform"});return $.when(t.processRequest()).done(function(t){t=t||{},e.resolve(t)}),e.promise()},showUserInformation:function(){var e=this,t=e.controller.getUserInfo(),i=new bizagi.editor.component.blockedformsdialog.presenter,n={name:"bz-dialog-perfomsave",title:bizagi.localization.getResource("bizagi-editor-form-dialog-userinfo-title"),date:e.getDateInfo(),blockerUser:t.userFullName};i.subscribe("getMainContainer",function(){return e.getMainContainer()}),i.subscribe("unlockformevent",function(){var i=bizagi.localization.getResource("formmodeler-component-unlock-form-confirmation").replace("{0}",t.userFullName);$.when(bizagi.showConfirmationBox(i,"Unlock form","warning",null,{dialogClass:"someClass"})).done(function(){e.checkoutForm()})}),$.when(i.show({data:n})).done(function(t){setTimeout(function(){"function"==typeof t&&t.call(e),e.dialog=null},0)})},getUserInfo:function(){var e=this.controller.getUserInfo(),t=bizagi.localization.getResource("bizagi-editor-form-dialog-userinfo-message");return t=t.replace("{0}",e.userFullName).replace("{1}",this.getDateInfo())},getDateInfo:function(){var e=this.controller.getUserInfo();return $.timeago(e.CheckOutDate)},checkoutForm:function(){var e=this,t=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"checkoutform",idForm:e.controller.getIdForm(),forceCheckin:!0});$.when(t.processRequest()).done(function(t){(t=t||{}).userInfo&&(e.controller.setReadOnlyFlag(t.isInCheckout),e.controller.setUserInfo(t.userInfo)),e.attachHandlersComponents(),e.refresh(),e.publish("onReadOnlyForm",{isReadOnly:!1})})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawContextMenu:function(e){var t=this;$.when(t.executeCommand({command:"getConvertToModel",guid:e.guid})).done(function(i){t.destroy();var n=t.executeCommand({command:"getContextMenuModel",guid:e.guid,convertToModel:i}),o=t.getMainContainer(),r=t.contextmenu=new bizagi.editor.component.contextmenu.presenter({model:n,guid:e.guid,mainContainer:o});return r.subscribe("onItemClicked",function(e,i){t.onContextMenuItemClicked(r,i)}),t.controller.isAdhocFormContext()&&(e.position.y=e.position.y-$(".l-wrapper-breadcrumb").height()||0),r.render({position:e.position})})},onContextMenuItemClicked:function(e,t){var i=this;i.hidePropertyBox(),t.property&&t.value&&(i.controller.isOfflineContext()?i.executeCommand({command:"changeProperty",guid:e.guid,property:t.property,value:t.value}):i.controller.isAdhocFormContext()?i.executeCommand({command:"changeProperty",guid:e.guid,property:t.property,value:t.value}):"object"==typeof t.value&&t.value.fixedvalue?i.executeCommand({command:"changeProperty",guid:e.guid,property:t.property,value:t.value}):(t.value=bizagi.editor.utilities.buildComplexReference(t.value),i.performShowRuleSelector({type:t.property,id:e.guid,newValue:t.value,categorytype:"Boolean",data:t.value}))),t.action&&("delete"==t.action&&i.executeCommand({command:"removeElementById",guid:e.guid}),"rename"==t.action&&i.showElementLabelEditor(e.guid),"convertTo"==t.action&&i.executeCommand({command:"convertTo",guid:e.guid,convertTo:t.value}),"properties"==t.action&&i.showPropertyBox(e.guid))},showExpressionSelector:function(e,t){var i=this.controller.getModel().getElement(t).getProperty(e)||{},n={};n.data=i.rule||{rule:{baref:{ref:"expression"}}},n.type=e,n.categorytype="Boolean",this.performShowRuleSelector(n)},showElementLabelEditor:function(e){var t=this.formContainer.getRenderById(e);t&&t.showElementLabelEditor&&t.showElementLabelEditor()},showPropertyBox:function(e){$('[guid="'+e+'"]');this.drawPropertyBox({guid:e})},destroy:function(){this.contextmenu&&this.contextmenu.destroy()}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{map:{columnsearchlist:"searchlist",multiselect:"searchlist"}},{drawPropertyBox:function(e){var t=this;t.propertyBox&&t.hidePropertyBox(),t.redrawPropertyBox=!!e.redraw&&e.redraw;var i=t.getMainContainer();t.propertyBox=new bizagi.editor.component.properties.presenter({mainContainer:i}),t.propertyBox.subscribe("propertyChanged",function(e,i){return t.onPropertiesChanged(i)}),t.propertyBox.subscribe("getRenderElement",function(e,i){return t.onGetRenderElement(i)}),t.propertyBox.subscribe("getDeviceInfo",function(){return t.getDeviceInfo()}),t.propertyBox.subscribe("destroy",function(e,i){t.hidePropertyBox(i)}),t.propertyBox.subscribe("getMainContainer",function(){return t.getMainContainer()}),t.editorValidations={},t.guid=e.guid||t.currentSelectedElement,t.formProperties=!(!e||!e.formProperties),t.refreshPropertyBox()},refreshPropertyBox:function(){var e,t=this;if(t.validElement()){if(t.formProperties)e=t.executeCommand({command:"getFormPropertiesModel",showValidations:t.validateForm});else{if(!t.guid)return void(t.propertyBox&&t.propertyBox.propertyBox&&t.propertyBox.propertyBox.element&&t.propertyBox.propertyBox.element.hide());t.controller.thereAreMultiselection()?e=t.executeCommand({command:"getMultiselectionProperties",showValidations:t.validateForm}):(t.executeCommand({command:"applyOverridesElement",guid:t.guid,overrides:{requiredProperties:!0}}),e=t.executeCommand({command:"getPropertiesModel",guid:t.guid,showValidations:t.validateForm}))}t.propertyBox.render({model:e,position:{left:10,top:135},redraw:t.redrawPropertyBox})}},validElement:function(){return!!this.propertyBox&&(!!this.formProperties||(!!$.isArray(this.guid)||!!this.executeCommand({command:"getElementProperties",guid:this.guid})))},onPropertiesChanged:function(e){if("function"==typeof this["perform"+e.typeEvent])return this["perform"+e.typeEvent](e)},hidePropertyBox:function(){this.propertyBox&&this.propertyBox.destroy(),this.propertyBox=null},showXpathEditor:function(e){var t=this,i=t.executeCommand({command:"getElementProperties",guid:e.guid});"object"==typeof i.xpath&&t.changeXpathNavigatorView(i.xpath);var n=e.model||t.controller.getXpathNavigatorModel({context:e.context});$.when(n).done(function(n){$.extend(n,{context:t.controller.getContext()});var o=new bizagi.editor.component.xpathnavigator.presenter({model:n}),r=bizagi.editor.utilities.resolveProperty(i,e.property);/^.*:+.*$/.test(r)&&(r=void 0),o.subscribe("nodeDoubleClick",function(i,n){t.changeXpathPropertyForElement(e.guid,e.property,n),o.closePopup()}),o.subscribe("getMainContainer",function(){return t.getMainContainer()}),o.renderPopup({position:e.position,xpath:r,filter:e.filter})})},showMultiXpathEditor:function(e){var t=this,i=t.executeCommand({command:"getElementProperties",guid:e.guid}),n=e.model||t.controller.getXpathNavigatorModel({context:e.context});$.when(n).done(function(n){$.extend(n,{context:t.controller.getContext()});var o=new bizagi.editor.component.xpathnavigator.presenter({model:n}),r=bizagi.editor.utilities.resolveProperty(i,e.property);/^.*:+.*$/.test(r)&&(r=void 0),o.subscribe("nodeDoubleClick",function(i,n){t.changeXpathMultiplePropertyForElement(e.guid,e.property,n),o.closePopup()}),o.subscribe("getMainContainer",function(){return t.getMainContainer()}),o.renderPopup({position:e.position,filter:e.filter,allowCollection:null==e.filter.allowCollections||bizagi.util.parseBoolean(e.filter.allowCollections)})})},changeXpathPropertyForElement:function(e,t,i){if(void 0!==this.editorValidations[e]&&!this.validateXpathChange(e,t,i))return;var n={command:"changeProperty",guid:e,property:t,value:bizagi.editor.utilities.buildComplexXpath(i.xpath,i.contextScope,i.isScopeAttribute,i.guidRelatedEntity),refreshProperties:!0,removeDefaultDisplayName:!0,renderTypeProperty:i.nodeSubtype,validateForm:this.validateForm};this.editorValidations[e]&&void 0!==this.editorValidations[e].exclusive&&(n=$.extend({},n,{exclusive:this.editorValidations[e].exclusive})),this.executeCommand(n)},changeXpathMultiplePropertyForElement:function(e,t,i){if(void 0!==this.editorValidations[e]&&!this.validateXpathMultipleChange(e,t,i))return;var n=this.executeCommand({command:"getElementProperty",guid:e,property:t})||[],o=bizagi.editor.utilities.buildComplexXpath(i.xpath,i.contextScope,i.isScopeAttribute,i.guidRelatedEntity);if(!(0!=$.grep(n,function(e){return o.xpath.baxpath.xpath==e.xpath.baxpath.xpath}).length)){n.push(o);var r={command:"changeProperty",guid:e,property:t,value:n,refreshProperties:!0,removeDefaultDisplayName:!0,renderTypeProperty:i.nodeSubtype,validateForm:this.validateForm};this.executeCommand(r)}},performPropertyChange:function(e,t){var i=[e.id],n=t||e.refreshProperties;bizagi.editor.utilities.isGuidEmpty(e.id)&&(i=this.controller.getGuidsSelected()),this.executeCommand({command:"changeProperty",guids:i,property:e.type,value:e.newValue,exclusive:e.exclusive,refreshProperties:n,validateForm:this.validateForm})},performPropertyChangeLayout:function(e){this.executeCommand({command:"changeLayout",guid:e.id,values:e.values})},performShowRuleSelector:function(e){var t=this;if(!t.requestInProgress){t.requestInProgress=!0;var i=e.data;if(i&&t.isRule90(i)){var n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getruledisplayname",rule:i.rule90});$.when(n.processRequest()).done(function(e){var t=bizagi.localization.getResource("formmodeler-message-rule90").replace("{0}",e.displayName);bizagi.showMessageBox(t)})}var o=t.executeCommand({command:"getElementProperties",guid:e.id,getContext:e.context});if(o&&o.context)var r=o.context;var a=bizagi.editor.communicationprotocol.factory.createProtocol($.extend(e,{protocol:"ruleexpression",idcontextentity:r}));$.when(a.processRequest()).done(function(i){i&&(e.newValue=i.isEmpty?void 0:i,t.performPropertyChange(e,!0))}).always(function(){setTimeout(function(){t.requestInProgress=!1},100)})}},performShowLocalization:function(e){var t=this,i=t.controller.getModel().getElement(e.id),n=i.resolveProperty(e.type);if("object"!=typeof n&&(n="string"==typeof n?bizagi.editor.utilities.buildComplexLocalizable(n,e.id,e.type):bizagi.editor.utilities.buildComplexLocalizable(i.getDefaultLocalizableProperty(e.type),e.id,e.type)),n.i18n){var o=n.i18n;o.languages=o.languages||{}}var r=n.i18n.default;n.i18n.default=$("<div/>").html(n.i18n.default).text();var a=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"multilanguage",i18n:n});$.when(a.processRequest()).done(function(i){n.i18n.default=r,i&&(i.i18n.default=r,e.newValue=i,t.performPropertyChange(e,!0))})},performChangeMultipleProperties:function(e){var t=[e.id];bizagi.editor.utilities.isGuidEmpty(e.id)&&(t=this.controller.getGuidsSelected()),this.executeCommand({command:"changeMultipleProperties",properties:e.properties,guids:t})},performShowFilterEditor:function(e){var t=this;if("data.filter"===e.type){e.xpathNode=t.executeCommand({command:"getXpathDataForElement",guid:e.id});var i=t.executeCommand({command:"getElementProperties",guid:e.id}),n=bizagi.editor.communicationprotocol.factory.createProtocol($.extend(e,{protocol:"loadfilter",idcontextentity:i.context}));$.when(n.processRequest()).done(function(i){i&&(e.newValue=i.isEmpty?void 0:bizagi.editor.utilities.buildComplexFilter(i,e.xpathNode),t.performPropertyChange(e,!0))})}},performShowRuleEditorForDefaultValue:function(e){},performShowXPathEditor:function(e){this.showXpathEditor({guid:e.id,property:e.type,position:e.position})},performShowInterfaceEditor:function(e){var t=this,i=bizagi.editor.communicationprotocol.factory.createProtocol($.extend(e,{protocol:"loadinterface",idForm:t.idForm}));t.requestInProgress||(t.requestInProgress=!0,$.when(i.processRequest()).done(function(i){i&&(e.newValue=i,t.performPropertyChange(e,!0))}).always(function(){setTimeout(function(){t.requestInProgress=!1},100)}))},performSelectXpathFromEntity:function(e){var t=this,i={typeEditor:e.typeEditor,editorParameters:e.editorParameters};void 0!==e.editorParameters.types&&(t.editorValidations[e.id]=i),$.when(t.executeCommand({command:"getXpathEditorModel",guid:e.id,editorParameters:e.editorParameters})).done(function(i){$.when(i).done(function(i){var n={guid:e.id,property:e.type,position:e.position,model:i};void 0!==e.editorParameters.types&&$.isArray(e.editorParameters.types)&&$.extend(n,{filter:{typeFilter:e.typeEditor,types:e.editorParameters.types}}),t.showXpathEditor(n)})})},performSelectXpathToSimple:function(e){var t={typeEditor:e.typeEditor,editorParameters:e.editorParameters};void 0!==e.exclusive&&(t=$.extend({},t,{exclusive:e.exclusive})),this.editorValidations[e.id]=t,this.showXpathEditor({guid:e.id,property:e.type,position:e.position,context:e.context,filter:{typeFilter:e.typeEditor,types:e.editorParameters.types}})},performSelectXpathToEntity:function(e){if("nestedform"==this.executeCommand({command:"getElementProperties",guid:e.id}).type){var t=bizagi.localization.getResource("formmodeler-component-editor-validation-xpath-title"),i=bizagi.localization.getResource("formmodeler-component-editor-validation-xpath-message");bizagi.showMessageBox(i,t,"warning",!1)}else this.editorValidations[e.id]={typeEditor:e.typeEditor},this.showXpathEditor({guid:e.id,property:e.type,position:e.position,context:e.context,filter:{typeFilter:e.typeEditor}})},performSelectXpathToCollection:function(e){this.editorValidations[e.id]={typeEditor:e.typeEditor},this.showXpathEditor({guid:e.id,property:e.type,position:e.position,context:e.context,filter:{typeFilter:e.typeEditor}})},performSelectMultiXpath:function(e){var t={typeEditor:e.typeEditor,editorParameters:e.editorParameters};void 0!==e.exclusive&&(t=$.extend({},t,{exclusive:e.exclusive})),this.editorValidations[e.id]=t,this.showMultiXpathEditor({guid:e.id,property:e.type,position:e.position,context:e.context,filter:{typeFilter:e.typeEditor,types:e.editorParameters.types,allowCollections:e.editorParameters.allowCollections}})},performSelectXpath:function(e){this.showXpathEditor({guid:e.id,property:e.type,position:e.position,context:e.context})},performShowGridValidationsEditor:function(e){var t=this,i=t.executeCommand({command:"getElementProperties",guid:e.id});if("object"==typeof i.xpath){var n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"gridvalidations",guidRender:e.id,xpath:bizagi.editor.utilities.resolveComplexXpath(i.xpath),gridValidations:i.gridvalidations});$.when(n.processRequest()).done(function(i){i&&(e.newValue=i,t.performPropertyChange(e,!0))})}},performSelectProcess:function(e){var t=this,i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"selectprocess",guidRender:e.id});$.when(i.processRequest()).done(function(i){i&&(e.newValue=i,t.performPropertyChange(e,!0))})},performSelectFormOption:function(e){var t=this,i=[],n=e.context&&"searchform"===e.context;(n?t.processAddEntitySearchForm.bind(t):t.processAddEntityForm.bind(t))({guid:e.form}).then(function(o){var r=bizagi.editor.utilities.buildComplexReference(o.guid);e.newValue=r,n&&(i.push(r),e.newValue=i);var a=$.extend(e,{type:e.propertyName,form:o.guid});t.performPropertyChange(a,!0),e.showForm&&t.executeCommand({command:"updateModel",data:{actiontype:"ShowForm",guidrender:a.id,form:o.guid}})})},performSelectFormButton:function(e){var t=e.value,i=e.formType||"form",n=this.executeCommand({command:"getElementProperties",guid:e.id,canUndo:!1}),o=bizagi.editor.utilities.resolveRelatedEntityFromXpath(n.xpath);if($.isArray(t)&&(t=t[0]),this._utilities.isObject(t)){var r=this._utilities.resolveComplexReference(t);if(r.length>0){var a=this.publish("getViewSelected")||{},s={protocol:"openform",idform:r,renderId:e.id,propertyName:e.propertyName,context:e.context},l=a.relatedView!=this.appState.GENERIC_VIEW_ID;"form"===i&&(s=$.extend(s,{deviceId:a.relatedView,device:a.device,isSpecific:l,deviceType:this.deviceType})),this.channel.createProtocol(s).processRequest(),delete bizagi.editor.component.properties.commands.relatedforms.relatedFormsCache[o+"_"+e.context]}}},performShowWizardTemplates:function(e){var t=this.executeCommand({command:"getElementProperties",guid:e.id,canUndo:!1}),i=this.controller.getModel();if(t.xpath&&(bizagi.editor.utilities.isObject(t.xpath),1)){var n=bizagi.editor.utilities.resolveComplexXpath(t.xpath),o=bizagi.editor.utilities.resolveRelatedEntityFromXpath(t.xpath),r=(i=this.controller.getModel(),bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"showwizardtemplates",xpath:n,relatedEntity:o,guidControl:e.id,propertyName:e.propertyName,isScopeAttribute:i.publish("getNodeInfo",{xpath:n,callback:function(e){return e.isScopeAttribute}})}));$.when(r.processRequest()).done(function(){delete bizagi.editor.component.properties.commands.selecttemplate.templatesPromise[o]})}},performSelectFormNew:function(e){var t=this.executeCommand({command:"getElementProperties",guid:e.id,canUndo:!1}),i=this.executeCommand({command:"propertyIsRequired",guid:e.id,property:"xpath"}),n=this.controller.getModel();if(t.xpath&&"object"==typeof t.xpath||!i){var o=bizagi.editor.utilities.resolveComplexXpath(t.xpath),r=bizagi.editor.utilities.resolveRelatedEntityFromXpath(t.xpath),a=this.publish("getViewSelected");bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"createform",xpath:this.controller.getContextXpath({xpath:o}),guid:e.id,propertyName:e.propertyName,context:e.context,relatedEntity:r,isScopeAttribute:n.publish("getNodeInfo",{xpath:o,callback:function(e){return e.isScopeAttribute}}),showForm:e.showForm,deviceId:a.relatedView}).processRequest(),delete bizagi.editor.component.properties.commands.relatedforms.relatedFormsCache[r+"_"+e.context]}},performSelectFormNone:function(e){e.newValue=void 0,this.performPropertyChange($.extend(e,{type:e.propertyName}),!0)},performSelectTemplateNone:function(e){e.newValue=void 0,this.performPropertyChange($.extend(e,{type:e.propertyName}),!0)},performSelectTemplateDefault:function(e){e.newValue=e.value,this.performPropertyChange($.extend(e,{type:e.propertyName}),!0)},performShowDocumentTemplatesEditor:function(e){var t=this,i=t.executeCommand({command:"getElementProperties",guid:e.id});if(i.xpath&&"object"==typeof i.xpath){var n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"documenttemplates",groupmapping:i.groupmapping,append:i.append,xpath:bizagi.editor.utilities.resolveComplexXpath(i.xpath),idContextEntity:i.context,idForm:t.idForm});$.when(n.processRequest()).done(function(i){i&&t.performPropertyChange({id:e.id,type:"groupmapping",newValue:bizagi.editor.utilities.buildComplexReference(i)})})}},performShowAssociationEditor:function(e){var t=this,i=t.executeCommand({command:"getElementProperties",guid:e.id}),n=i.type;$.when(t.showControlWizard({model:i,control:t.Class.map[n]||n})).done(function(i){i.success&&t.executeCommand({command:"updateAssociationModel",model:i.model,guid:e.id,control:n}),t.refreshPropertyBox()})},performLoadMetadata:function(e){var t=this.executeCommand({command:"getElementProperties",guid:e.id});return bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getmetadata",xpath:bizagi.editor.utilities.resolveComplexXpath(t.xpath)}).processRequest()},validateXpathChange:function(e,t,i){var n,o=i.nodeType,r=i.nodeSubtype,a=!1,s=this.editorValidations[e],l="N/A",d=bizagi.localization.getResource("bizagi-editor-validation-xpath-title-message-entity");switch(s.typeEditor){case"xpathfromentity":case"xpathtosimple":var c;for(n=s.editorParameters.types,l=n.toString(),a=!0,c=0;c<n.length;c++)try{if(-1!=$.inArray(r,bizagi.editor.component.xpathnavigator.equiv.rule.xpathtosimple[n[c]])){a=!1;break}}catch(e){bizagi.logError("Equiv Error","renderType: "+o+", types: "+l)}break;case"xpathtocollection":l="collection",-1==$.inArray(o,bizagi.editor.component.xpathnavigator.equiv.rule.xpathtocollection.xpathtocollection)&&(d=bizagi.localization.getResource("bizagi-editor-validation-xpath-title-message-collection"),a=!0);break;case"xpathtoentity":i.hasRelatedEntity&&"00000000-0000-0000-0000-000000000000"!=i.guidRelatedEntity&&"collection"!=o||(a=!0)}if(a){var u=bizagi.localization.getResource("bizagi-editor-validation-xpath-title"),p=printf(d,l);bizagi.showMessageBox(p,u,"warning",!1)}return!a},validateXpathMultipleChange:function(e,t,i){var n,o,r,a=i.nodeType,s=i.nodeSubtype,l=!1,d=this.editorValidations[e];for(o=d.editorParameters.types,n=o.toString(),l=!0,r=0;r<o.length;r++)try{if(-1!=$.inArray(s,bizagi.editor.component.xpathnavigator.equiv.rule.xpathmultiple[o[r]])){l=!1;break}}catch(e){bizagi.logError("Equiv Error","renderType: "+a+", types: "+n)}if(l){var c=bizagi.localization.getResource("bizagi-editor-validation-xpath-title"),u=printf(bizagi.localization.getResource("bizagi-editor-validation-xpath-title-message"),d.typeEditor,n,a);bizagi.showMessageBox(u,c,"warning",!1)}return!l},isRule90:function(e){return e.rule90}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawReadOnlyEditor:function(e){var t=this,i=$("<div />").addClass("bizagi_editor_readonlyeditor_container");e.prepend(i);var n=t.controller.getUserInfo(),o=t.readOnlyEditor=new bizagi.editor.component.readonlyeditor.presenter({canvas:i,model:n});return o.subscribe("showUserInformation",function(e,i){t.showUserInformation()}),o.render({isReadOnly:t.controller.isReadOnlyForm()})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{processValidations:function(e){var t=this,i=new $.Deferred;if(t.controller.isTemplateContext())return t.processTemplateValidations(e);if(t.controller.isAdhocFormContext())return t.processAdhocValidations(e);var n=t.executeCommand({command:"formValidations",validations:["RequiredProperties","RequiredDependentProperties","SameXpath","ElementsInContainers","AttributesAdministrables","AttributesNoEditables","EntitiesNoEditables"],canRefresh:e.canRefresh});return $.when(n).done(function(e){var n=!$.isEmptyObject(e);n&&(t.validateForm=!0,t.refreshRibbon(),$.extend(e,{showMessage:n})),t.publish("onShowFormErrors",{withError:n}),i.resolve(e)}),i.promise()},processTemplateValidations:function(e){var t=this.executeCommand({command:"formValidations",validations:[],canRefresh:e.canRefresh});return $.isEmptyObject(t)||(this.validateForm=!0,this.refreshRibbon(),$.extend(t,{showMessage:!0})),t},processAdhocValidations:function(e){var t=this,i=new $.Deferred,n=t.executeCommand({command:"formValidations",validations:["RequiredProperties","RequiredDependentProperties","SameXpath","ElementsInContainers","AttributesAdministrables","AttributesNoEditables","SameXpathAdhoc","SameXpathAdhocDataSource"],canRefresh:e.canRefresh});return $.when(n).done(function(e){$.isEmptyObject(e)||(t.validateForm=!0,t.refreshRibbon(),$.extend(e,{showMessage:!0})),i.resolve(e)}),i.promise()},removeValidations:function(e){this.validateForm=!1,this.executeCommand({command:"removeValidationsInModel",canRefresh:e.canRefresh})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{showControlWizard:function(e){var t=this.wizardPresenter=new bizagi.editor.wizard.presenter;return this.prepareWizardParams(e),e.isGridContext=this.controller.isGridContext(),e.isGridContext&&(e.gridContextXpath=this.controller.getContextXpath({})),t.show(e)},prepareWizardParams:function(e){var t=this;"cascadingcombo"==e.control?e.xpathModel=t.controller.getXpathNavigatorModel():"association"==e.control?(t.wizardPresenter.subscribe("showXPathNavigatorEditor",function(e,i){return t.onShowXpathNavigatorEditor(i)}),t.wizardPresenter.subscribe("getMultipleRelationship",function(e,i){return t.onGetMultipleRelationship(i)}),t.wizardPresenter.subscribe("getXpathData",function(e,i){return t.onGetXpathData(i)}),t.wizardPresenter.subscribe("setLocalization",function(e,i){return t.onSetLocalization(i)})):["searchlist","multiselect"].includes(e.control)&&(t.wizardPresenter.subscribe("showXPathNavigatorEditor",function(e,i){return t.onShowXpathNavigatorEditor(i)}),t.wizardPresenter.subscribe("getMultipleRelationship",function(e,i){return t.onGetSimpleRelationship(i)}),t.wizardPresenter.subscribe("getXpathData",function(e,i){return t.onGetXpathData(i)}),t.wizardPresenter.subscribe("setLocalization",function(e,i){return t.onSetLocalization(i)}),t.wizardPresenter.subscribe("changelabel",function(e,i){t.onElementChangeLabel(i)})),t.wizardPresenter.subscribe("getMainContainer",function(e,i){return t.getMainContainer(i)}),t.wizardPresenter.subscribe("getMainPanel",function(e,i){return t.getMainPanel(i)})},onShowXpathNavigatorEditor:function(e){var t,i=this,n=new $.Deferred;i.editorValidations=i.editorValidations||{};var o=e.filter&&e.filter.types;return o=o||[],i.editorValidations[e.xpathProperty]={typeEditor:e.typeEditor,editorParameters:{types:o}},t=i.controller.isGridContext()?i.controller.getXpathNavigatorModelGrid({context:e.entity}):i.controller.getXpathNavigatorModel({context:e.entity}),$.when(t).done(function(t){var o=new bizagi.editor.component.xpathnavigator.presenter({model:t});o.subscribe("nodeDoubleClick",function(t,r){i.validateXpathChange(e.xpathProperty,e.xpathProperty,r)&&(o.closePopup(),n.resolve(r))}),o.subscribe("getMainContainer",function(){return i.getMainContainer()}),o.renderPopup({position:e.position,filter:e.filter,xpath:e.xpath,allowCollection:e.allowCollection})}),n.promise()},onGetMultipleRelationship:function(e){var t=bizagi.editor.utilities.resolveRelatedEntityFromXpath(e.leftEntity),i=bizagi.editor.utilities.resolveRelatedEntityFromXpath(e.rightEntity);return bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getmultiplerelationship",leftEntityId:t,rightEntityId:i}).processRequest()},onGetSimpleRelationship:function(e){var t=bizagi.editor.utilities.resolveRelatedEntityFromXpath(e.leftEntity);return bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getmultiplerelationship",leftEntityId:t}).processRequest()},onGetXpathData:function(e){var t=e.xpath;return this.controller.getXpathNavigatorModel().getNodeByXpath(t)},onSetLocalization:function(e){var t=new $.Deferred,i=e.propertyValue;i=i||bizagi.editor.utilities.buildComplexLocalizable("",e.elementGuid,e.propertyName);var n=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"multilanguage",i18n:i});return $.when(n.processRequest()).done(function(e){e&&t.resolve(e)}),t.promise()},onElementChangeLabel:function(e){this.executeCommand({command:"changeProperty",guid:e.guid,property:"displayName",value:e.value})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{getExternalData:function(e){if(bizagi.log("sucede getExternalData",e),"function"==typeof this["getDataFor"+e.control])return this["getDataFor"+e.control](e)},getDataForcascadingcombo:function(e){var t=bizagi.editor.utilities.resolveComplexXpath(e.xpath),i=bizagi.editor.utilities.resolveRelatedEntityFromXpath(e.xpath);return bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getparententities",id:i,xpath:t}).processRequest()},getDataForquerycascadingcombo:function(e){return this.getDataForcascadingcombo(e)},getDefaultDisplayName:function(e){var t=this,i=e.element,n=i.properties,o=n.xpath,r=$.Deferred(),a=function(e,i){var n=e.split("."),o=n.slice(0,i).join("."),d=(l=t.controller.getXpathNavigatorModel({context:""})).searchNodeByXpath(o);"object"==typeof d&&d.done&&"resolved"==d.state()&&(d=bizagi.resolveResult(d)),$.when(d).done(function(){if(i<n.length-1)a(e,i+1);else{var t=l.getNodeByXpath(e);r.resolve(s(t))}})},s=function(e){return e.languages};if(n&&"object"==typeof o){if(i.isInternal())return bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getmetadataattributedisplayname",xpath:n.xpath,guidControl:t.controller.getControlsModel().getGuidControl(i.type)}).processRequest();o=i.getXpath();var l=t.controller.isGridContext()?t.controller.getXpathNavigatorModelGrid():t.controller.getXpathNavigatorModel();$.when(l).done(function(e){if((l=e||l).getNodeByXpath(o)){var t=l.getNodeByXpath(o);r.resolve(s(t))}else{i.parent.isGrid()&&(o=i.parent.getXpath()+"."+o);var n=i.getHierarchicalXpathNestedForm();a(o=n?n+"."+o:o,1)}})}else t.controller.isTemplateContext()?r.resolve(""):r.resolve(t.controller.getControlDisplayName(i.type));return r.promise()},getNodeInfo:function(e){e=e||{};var t=this.controller.isGridContext()?this.controller.getXpathNavigatorModelGrid():this.controller.getXpathNavigatorModel(),i=e.root?t.getRootNode():t.getNodeByXpath(e.xpath);return i&&"function"==typeof e.callback?e.callback.call(this,i):i},findXpathAttributes:function(e){var t=this;return t.showElementXpath(e.xpath).pipe(function(){return t.executeCommand({command:"applyOverridesElement",element:e.element})})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerView",{},{drawCommandsEditor:function(){var e=this,t=new bizagi.editor.component.commandseditor.presenter;$.when(e.controller.getCommandsModel()).done(function(i){var n=Object.assign(i,{idForm:e.idForm});t.subscribe("getContext",function(t,i){return e.onGetContext(i)}),t.subscribe("getMainContainer",function(t,i){return e.getMainContainer(i)}),$.when(t.show(n)).done(function(t){e.controller.setCommandsModel(t),e.refreshRibbon()})})},onGetContext:function(){return this.controller.getContext()}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerSmartphoneView",{},{init:function(e){var t=this;e=e||{},t.renderingMode="design",t.currentDevice="Smartphone",t.isSpecific=!0,t.loadDeferred=new $.Deferred,t.deviceName=e.deviceName,t.validateForm=!1,bizagi.editor.view.prototype.init.apply(this,[e]),t.currentTabIndex=0,bizagi.editorLanguage={displayname:"default",IsRightToLeft:!1,key:"default"};var i=$("body"),n=e.isNew?"formmodeler-component-wait-message-customized-form":"formmodeler-component-wait-message-loading-form",o={message:bizagi.localization.getResource(n)},r=new bizagi.editor.component.wait.presenter({model:o,renderArea:i});$.when(r.render(),this.controller.ready(),t.loadViewModules()).done(function(){$.when(t.processLayout(e)).done(function(){e.isNew&&!e.isEmpty?$.when(t.executeCommand({command:"cloneEntityForms",sourceIdForm:e.idSourceForm,deviceInfo:t.getDeviceInfo()})).done(function(){r.destroy(),t.loadDeferred.resolve(),t.setOriginalModel(),t.refresh()}):(r.destroy(),t.loadDeferred.resolve(),e.isEmpty||t.setOriginalModel())})})},loadViewModules:function(){var e=$.Deferred(),t=bizagi.loader;return t.internalLoadModule("formModeler","smartphone_ios").then(function(){t.whenModuleLoaded("formModeler",function(){e.resolve()},"smartphone_ios")}),e.promise()},autoGenerate:function(){var e=this;$.when(this.controller.ready()).done(function(){$.when(e.controller.getXpathNavigatorModel()).done(function(t){var i;if(t.getProcessEntityId()){t.getProcessEntityModel();var n=t.getRootNode()||{};$.isArray(n.nodes)&&(i=n.nodes[0])&&$.when(t.getChildren(i.id)).done(function(){e.executeCommand({command:"addEntityChildren",node:i,canUndo:!1})})}else i=t.getRootNode(),e.executeCommand({command:"addEntityChildren",node:i,canUndo:!1})})})},getRenderingFacade:function(){return this.smartphoneRenderingFacade||(this.smartphoneRenderingFacade=new bizagi.rendering.facade({device:"smartphone_ios"}),this.subscribeGlobalHandlers(this.smartphoneRenderingFacade)),this.smartphoneRenderingFacade},save:function(){var e={command:"saveModel",dataModel:{},canUndo:!1};return this.executeCommand(e),e.dataModel},validateAndSaveForm:function(){this.performSave(!0)},updateForm:function(e){var t;t={command:"updateModel",data:e,canUndo:!1},this.executeCommand(t)},setOriginalModel:function(){var e=this;$.when(this.controller.ready()).done(function(){e.controller.setOriginalModel()})},processLayout:function(e){var t=this,i=new $.Deferred;t.configureHtmlPage(e);var n=$(e.canvas||"body");n.empty(),t.smartPhoneMainContainer=$('<form-modeler id="'+t.viewID+'"/>').appendTo(n),t.smartPhoneMainContainer.addClass("container-layout");var o=t.layoutComponent=new bizagi.editor.component.smartphone.layout.presenter({canvas:t.smartPhoneMainContainer,context:e.context,isActivityForm:e.isActivityForm});return $.when(o.render()).done(function(){setTimeout(function(){t.configureLeftPane(),t.drawRibbon(),t.controller.isSearchFormContext()&&t.drawSearchResultEditor(),(t.controller.isActivityForm()||t.controller.isOfflineFormContext())&&t.drawStatusBar(),t.controller.isActivityForm()&&setTimeout(function(){t.drawButtonEditor()},100),t.configureKeyHandlers(),$.when(t.configureRenderingView()).done(function(){i.resolve()})},100)}),i.promise()},configureHtmlPage:function(){$("html").addClass("biz-work-area"),$("body").addClass("biz-font").addClass("biz-normal-font").addClass("biz-text-color"),$("body").attr("oncontextmenu","return false")},configureLeftPane:function(){var e=this;$.when(e.drawControlsNavigator(),e.drawXpathNavigator(),e.drawBanner()).done(function(){e.smartPhoneMainContainer.find(".left-panel").tabs({beforeActivate:function(t,i){var n=$("a",i.newTab).data("rendering-mode");e.hidePropertyBox(),e.needsRedrawAfterTabChange(i.newTab.index())&&(e.currentSelectedElement=null,e.controller.removeSelectedElement(),e.renderingMode=n,e.render(n)),e.currentTabIndex=i.newTab.index(),e.setBannerVisibility(i)}}),e.setBannerVisibility()})},configureKeyHandlers:function(){var e=this;$(document).keydown(function(e){}).keyup(function(t){46===t.keyCode&&($(document.activeElement).is("input, textarea")||bizagi.form.modeler.params.reviewMode||e.deleteElement())}),$(document).on("keydown",function(t){17==t.keyCode&&e.controller.setCtrlKey(!0)}),$(document).on("keyup",function(t){e.controller.isCtrlKeyPressed()&&e.controller.setCtrlKey(!1)})},needsRedrawAfterTabChange:function(e){return this.currentTabIndex<2&&2===e||2===this.currentTabIndex&&e<2},setBannerVisibility:function(e){"show"===(e?$("a",e.newTab).attr("data-banner"):"hide")?this.showBanner():this.hideBanner()},preRender:function(e){var t=new $.Deferred;return this.validateForm&&e.canValidate?this.processValidations({canRefresh:!1}):t.resolve()},render:function(e,t){var i=this.controller.getContext();"form"==i?this.renderForm(e,t):"mobileform"==i?this.renderForm(e,t):"searchform"==i?this.renderSearchForm(t):"grid"==i||"offlinegrid"==i||"adhocgrid"==i?this.renderGridColumnEditor():"offlineform"==i?this.renderForm(e,t):"queryform"==i?this.renderForm(e,t):"startform"==i?this.renderForm(e,t):"adhocform"==i&&this.renderForm(e,t)},postRender:function(){var e=null;this.controller.thereAreMultiselection()&&(e=bizagi.editor.utilities.getGuidEmpty()),this.refreshRibbon(e)},refreshCanvas:function(){},renderForm:function(e,t){var i=this,n=$("#smartphone-main-panel");i.refreshRenderingView(e,t),i.controller.isActivityForm()&&(i.refreshButtonEditor(),i.refreshStatusBar(),"design"==i.renderingMode&&n.on("widgetComplete",function(){i.refreshCanvas()}),i.refreshCanvas(),setTimeout(function(){i.refreshCanvas()},500))},renderSearchForm:function(e){this.refreshRenderingView(e),this.refreshSearchFormResult()},renderGridColumnEditor:function(){this.refreshGridColumnEditor()},enableLayoutTab:function(){this.smartPhoneMainContainer.find(".left-panel").tabs("option","disabled",[])},disableLayoutTab:function(){this.smartPhoneMainContainer.find(".left-panel").tabs("option","disabled",[2])},removeFormEvents:function(){this.unsubscribeAll()},ready:function(){return this.loadDeferred},getMainPanel:function(){return this.smartPhoneMainContainer.find("#smartphone-main-panel")},getMainWrapper:function(){return this.smartPhoneMainContainer.find("#wrapper-smartphone-main-container")},getMainWrapperScroll:function(){return this.smartPhoneMainContainer.find(".wrapper-smartphone-scroll")},getWrapperScroll:function(){return this.smartPhoneMainContainer.find(".wrapper-scroll")},getMainContainer:function(){return this.smartPhoneMainContainer},getRenderingModel:function(){return this.publish("onGetRenderingModel",{})},getLocalizableResources:function(){return this._super(!0)},attachHandlersComponents:function(){this.controller.isActivityForm()&&(this.attachHandlersButtonEditor(),this.refreshButtonEditor()),this.attachHandlersControlsNavigator(),this.refreshControlsNavigator(),this.attachHandlersXpathNavigator(),this.refreshXpathNavigator()}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerDesktopView",{},{init:function(e){var t=this;e=e||{},t.renderingMode="design",t.currentDevice="Desktop",t.isSpecific=!0,t.loadDeferred=new $.Deferred,t.deviceName=e.deviceName,t.validateForm=!1,bizagi.editor.view.prototype.init.apply(this,[e]),t.currentTabIndex=0,bizagi.editorLanguage={displayname:"default",IsRightToLeft:!1,key:"default"};var i=$("body"),n=e.isNew?"formmodeler-component-wait-message-customized-form":"formmodeler-component-wait-message-loading-form",o={message:bizagi.localization.getResource(n)},r=new bizagi.editor.component.wait.presenter({model:o,renderArea:i});$.when(r.render(),this.controller.ready()).done(function(){$.when(t.processLayout(e)).done(function(){if(e.isNew&&!e.isEmpty)$.when(t.executeCommand({command:"cloneEntityForms",sourceIdForm:e.idSourceForm,deviceInfo:t.getDeviceInfo()})).done(function(){r.destroy(),t.loadDeferred.resolve(),t.setOriginalModel(),t.refresh()});else{var i=t.channel.createProtocol({protocol:"loadform",form:e.idForm});$.when(i.processRequest()).done(function(i){i?(t.executeCommand({command:"loadModel",dataModel:i.form,canUndo:!1}),t.refresh(),$.when(t.formIsLoaded()).done(function(){r.destroy(),t.loadDeferred.resolve()})):(r.destroy(),t.loadDeferred.resolve()),e.isEmpty||t.setOriginalModel()})}})})}}),bizagi.editor.modelerView.extend("bizagi.editor.modelerTabletView",{},{init:function(e){var t=this;e=e||{},t.renderingMode="design",t.currentDevice="Tablet",t.isSpecific=!0,t.loadDeferred=new $.Deferred,t.validateForm=!1,bizagi.editor.view.prototype.init.apply(this,[e]),t.currentTabIndex=0,bizagi.editorLanguage={displayname:"default",IsRightToLeft:!1,key:"default"};var i=$("body"),n=e.isNew?"formmodeler-component-wait-message-customized-form":"formmodeler-component-wait-message-loading-form",o={message:bizagi.localization.getResource(n)},r=new bizagi.editor.component.wait.presenter({model:o,renderArea:i});$.when(r.render(),this.controller.ready(),t.loadViewModules()).done(function(){$.when(t.processLayout(e)).done(function(){e.isNew&&!e.isEmpty?$.when(t.executeCommand({command:"cloneEntityForms",sourceIdForm:e.idSourceForm,deviceInfo:t.getDeviceInfo()})).done(function(){r.destroy(),t.setOriginalModel(),t.refresh(),t.loadDeferred.resolve()}):(r.destroy(),t.loadDeferred.resolve(),e.isEmpty||t.setOriginalModel())})})},loadViewModules:function(){var e=$.Deferred(),t=bizagi.loader;return t.internalLoadModule("formModeler","tablet_ios").then(function(){t.whenModuleLoaded("formModeler",function(){e.resolve()},"tablet_ios")}),e.promise()},autoGenerate:function(){var e=this;$.when(this.controller.ready()).done(function(){$.when(e.controller.getXpathNavigatorModel()).done(function(t){var i;if(t.getProcessEntityId()){t.getProcessEntityModel();var n=t.getRootNode()||{};$.isArray(n.nodes)&&(i=n.nodes[0])&&$.when(t.getChildren(i.id)).done(function(){e.executeCommand({command:"addEntityChildren",node:i,canUndo:!1})})}else i=t.getRootNode(),e.executeCommand({command:"addEntityChildren",node:i,canUndo:!1})})})},getRenderingFacade:function(){return this.tabletRenderingFacade||(this.tabletRenderingFacade=new bizagi.rendering.facade({device:"tablet_ios"}),this.subscribeGlobalHandlers(this.tabletRenderingFacade)),this.tabletRenderingFacade},save:function(){var e={command:"saveModel",dataModel:{},canUndo:!1};return this.executeCommand(e),e.dataModel},ready:function(){return this.loadDeferred},validateAndSaveForm:function(){this.performSave(!0)},updateForm:function(e){var t;t={command:"updateModel",data:e,canUndo:!1},this.executeCommand(t)},setOriginalModel:function(){var e=this;$.when(this.controller.ready()).done(function(){e.controller.setOriginalModel()})},processLayout:function(e){var t=this,i=new $.Deferred;t.configureHtmlPage(e);var n=$(e.canvas||"body");n.empty(),t.tabletMainContainer=$('<form-modeler id="'+t.viewID+'"/>').appendTo(n),t.tabletMainContainer.addClass("container-layout");var o=t.layoutComponent=new bizagi.editor.component.tablet.layout.presenter({canvas:t.tabletMainContainer,context:e.context,isActivityForm:e.isActivityForm});return o.subscribe("onChangeRotation",function(e,i){t.setOrientation(i.orientation),t.publish("onChangeRotation")}),$.when(o.render()).done(function(){setTimeout(function(){t.configureLeftPane(),t.drawRibbon(),t.controller.isSearchFormContext()&&t.drawSearchResultEditor(),(t.controller.isActivityForm()||t.controller.isOfflineFormContext())&&t.drawStatusBar(),t.controller.isActivityForm()&&setTimeout(function(){t.drawButtonEditor()},100),t.configureKeyHandlers(),$.when(t.configureRenderingView()).done(function(){i.resolve()})},100)}),i.promise()},configureHtmlPage:function(){$("html").addClass("biz-work-area"),$("body").addClass("biz-font").addClass("biz-normal-font").addClass("biz-text-color"),$("body").attr("oncontextmenu","return false")},configureLeftPane:function(){var e=this;$.when(e.drawControlsNavigator(),e.drawXpathNavigator(),e.drawBanner()).done(function(){e.tabletMainContainer.find(".left-panel").tabs({beforeActivate:function(t,i){var n=$("a",i.newTab).data("rendering-mode");e.hidePropertyBox(),e.needsRedrawAfterTabChange(i.newTab.index())&&(e.currentSelectedElement=null,e.controller.removeSelectedElement(),e.renderingMode=n,e.render(n)),e.currentTabIndex=i.newTab.index(),e.setBannerVisibility(i)}}),e.setBannerVisibility()})},configureKeyHandlers:function(){var e=this;$(document).keydown(function(e){}).keyup(function(t){46===t.keyCode&&($(document.activeElement).is("input, textarea")||bizagi.form.modeler.params.reviewMode||e.deleteElement())}),$(document).on("keydown",function(t){17==t.keyCode&&e.controller.setCtrlKey(!0)}),$(document).on("keyup",function(t){e.controller.isCtrlKeyPressed()&&e.controller.setCtrlKey(!1)})},needsRedrawAfterTabChange:function(e){return this.currentTabIndex<2&&2===e||2===this.currentTabIndex&&e<2},setBannerVisibility:function(e){"show"===(e?$("a",e.newTab).attr("data-banner"):"hide")?this.showBanner():this.hideBanner()},preRender:function(e){var t=new $.Deferred;return this.validateForm&&e.canValidate?this.processValidations({canRefresh:!1}):t.resolve()},render:function(e,t){var i=this.controller.getContext();"form"==i?this.renderForm(e,t):"mobileform"==i?this.renderForm(e,t):"searchform"==i?this.renderSearchForm(t):"grid"==i||"offlinegrid"==i||"adhocgrid"==i?this.renderGridColumnEditor():"offlineform"==i?this.renderForm(e,t):"queryform"==i?this.renderForm(e,t):"startform"==i?this.renderForm(e,t):"adhocform"==i&&this.renderForm(e,t)},postRender:function(){var e=null;this.controller.thereAreMultiselection()&&(e=bizagi.editor.utilities.getGuidEmpty()),this.refreshRibbon(e)},refreshCanvas:function(){},renderForm:function(e,t){var i=this,n=i.getMainPanel();i.refreshRenderingView(e,t),i.controller.isActivityForm()&&(i.refreshStatusBar(),i.refreshButtonEditor(),"design"==i.renderingMode&&n.on("widgetComplete",function(){i.refreshCanvas()}),i.refreshCanvas(),setTimeout(function(){i.refreshCanvas()},500))},renderSearchForm:function(e){this.refreshRenderingView(e),this.refreshSearchFormResult()},renderGridColumnEditor:function(){this.refreshGridColumnEditor()},enableLayoutTab:function(){this.tabletMainContainer.find(".left-panel").tabs("option","disabled",[])},disableLayoutTab:function(){this.tabletMainContainer.find(".left-panel").tabs("option","disabled",[2])},removeFormEvents:function(){this.unsubscribeAll()},getMainPanel:function(){return this.tabletMainContainer.find("#tablet-main-panel")},getMainWrapper:function(){return this.tabletMainContainer.find("#wrapper-tablet-main-container")},getMainWrapperScroll:function(){return this.tabletMainContainer.find(".wrapper-tablet-scroll")},getWrapperScroll:function(){return this.tabletMainContainer.find(".wrapper-scroll")},getMainContainer:function(){return this.tabletMainContainer},getRenderingModel:function(){return this.publish("onGetRenderingModel",{})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.groupmapping",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n;t.ButtonName=bizagi.localization.getResource("formmodeler-component-editor-groupmapping-buttonname"),t.caption=bizagi.util.trim(t.caption).length>0?t.caption:" ",(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),n=$("div",i),this.addRequired(n)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.groupmapping").concat("#groupmapping-frame"))).done(function(){e.resolve()}),e.promise()},".biz-action-validate click":function(e,t){t.stopPropagation(),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SHOW_DOCUMENT_TEMPLATES,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})}}),bizagi.editor.component.editor("bizagi.editor.component.editor.associationconfig",{init:function(e,t,i){this._super(e,t,i)},renderEditor:function(e,t){var i,n;t.ButtonName=bizagi.localization.getResource("formmodeler-component-editor-associationconfig-buttonname"),t.caption=bizagi.util.trim(t.caption).length>0?t.caption:" ",(i=$.tmpl(this.getTemplate("frame"),t)).appendTo(e),n=$("div",i),this.addRequired(n)},remove:function(){this.element.hide(),this.element.empty()},loadTemplates:function(){var e=$.Deferred();return $.when(this.loadTemplate("frame",bizagi.getTemplate("bizagi.editor.component.editor.associationconfig").concat("#associationconfig-frame"))).done(function(){e.resolve()}),e.promise()},".biz-action-validate click":function(e,t){t.stopPropagation(),this.controller.publish("propertyEditorChanged",{typeEvent:bizagi.editor.component.properties.events.PROPERTIES_SHOW_ASSOCIATION_EDITOR,type:this.options.name,id:this.element.closest(".bizagi_editor_component_properties").data("id")})}}),bizagi.editor.observableClass.extend("bizagi.editor.model",{},{init:function(e){var t=this,i=e&&e.definitions?e.definitions:{};t.context=e.context,t.isActivityForm=e.isActivityForm,t.idParentForm=e.idParentForm,t.isVersionable=bizagi.util.parseBoolean(e.isVersionable),t.deployOnParent=bizagi.util.parseBoolean(e.deployOnParent)||!1,t.isNewForm=e.isNewForm,t.idFormClass=Math.guid(),t.isSpecificForm=e.isSpecificForm,t.isNew=e.isNew,t.isDefault=e.isDefault,t.deviceType=e.deviceType,t.enableOffline=Boolean(e.supportOffline),t.previewOfflineIsEnable=!1,t.setResources(e.resources),t.createRibbonModel(),t.flags=e.flags,t.catalogServices=bizagi.editor.base.catalogServices,t.constants=bizagi.editor.base.constants,this._super(),t.elementFactory=new bizagi.editor.base.elementFactory({definitions:i,controls:e.controls});var n={contextentity:e.contextentity,scopedefinition:e.scopedefinition,isActivityForm:e.isActivityForm,version:e.version};t.form=t.createFormElement(e.context,e.formData||n),!e.isActivityForm||"form"!=t.context&&"startform"!=t.context||(t.addCustomButtonsSwitchToRibbon(),t.addEmailOptionsToRibbonModel()),e.canWorkOffline&&t.flags.offlineFeatureEnabled&&t.addOfflineButtonToRibbonModel()},isInitForm:function(){return"startform"==this.context},checkActivityForm:function(){return 1==bizagi.util.parseBoolean(this.isActivityForm)},createFormElement:function(e,t){e=e||"form";var i=this.createElement(e,t);return this.isActivityForm&&0===i.buttons.length&&"offlineform"!=e&&i.createDefaultButtons(),this.subscribeFormEvents(i),i},subscribeFormEvents:function(e){var t=this;e.subscribe("refresh",function(e,i){t.publish("refresh",i)}),e.subscribe("getDefaultDisplayName",function(e,i){return t.publish("getDefaultDisplayName",i)}),e.subscribe("getContextXpath",function(e,i){return t.publish("getContextXpath",i)}),e.subscribe("getNodeInfo",function(e,i){return t.publish("getNodeInfo",i)}),e.subscribe("findXpathAttributes",function(e,i){return t.publish("findXpathAttributes",i)}),e.subscribe("resizeHeigthCanvas",function(e,i){t.publish("resizeHeigthCanvas",i)}),e.subscribe("isReadOnlyForm",function(e,i){return t.publish("isReadOnlyForm",i)}),e.subscribe("getContextEntityType",function(e,i){return t.publish("getContextEntityType",i)}),e.subscribe("getControllerInfo",function(e,i){return t.publish("getControllerInfo",i)}),e.subscribe("refreshElement",function(e,i){return t.publish("refreshElement",i)}),e.subscribe("formIsLoaded",function(e,i){return t.publish("formIsLoaded",i)}),e.subscribe("getIdForm",function(){return t.publish("getIdForm")}),e.subscribe("getOriginalModel",function(){return t.publish("getOriginalModel")}),e.subscribe("getModel",function(){return t.publish("getModel")}),e.subscribe("getLocalizationObject",function(e,i){return t.getLocalizationObject(i)}),e.subscribe("getResourceByUri",function(e,i){return t.hashResources[i.uri]}),e.subscribe("getDeviceInfo",function(e,i){return t.publish("getDeviceInfo",i)}),e.subscribe("mustCloneRelatedForm",function(){return t.isSpecificForm&&t.isNew}),e.subscribe("cloneform",function(e,i){return t.cloneRelatedForm(i.idForm)})},createRibbonModel:function(){switch(this.context){case"template":this.templateRibbonModel=bizagi.clone(this.Class.ribbonModelTemplateData);break;case"adhocform":this.adhocRibbonModel=bizagi.form.modeler.params.reviewMode?{elements:[]}:bizagi.clone(this.Class.ribbonModelAdhoc);break;default:this.ribbonModel=bizagi.clone(this.Class.ribbonModelData)}},createDefaultButtons:function(e){var t=[],i=Math.guid(),n=this.createElement("formbutton",{guid:i,properties:{caption:bizagi.editor.utilities.buildComplexLocalizable(bizagi.localization.getResource("render-form-button-save"),i,"caption"),actions:["submitData","refresh"]}});n.setParent(e);var o=Math.guid(),r=this.createElement("formbutton",{guid:o,properties:{caption:bizagi.editor.utilities.buildComplexLocalizable(bizagi.localization.getResource("render-form-button-next"),o,"caption"),actions:["validate","submitData","next"]}});return r.setParent(e),t.push(n),t.push(r),t},getForm:function(){return this.form},createLayoutElement:function(e){var t=this,i=t.createElement(t.unnormalizeType("horizontal"),{properties:{layoutType:e.id}});return e.children.forEach(function(e){i.addElement(t.createChildElement(e))}),i},createChildElement:function(e){var t=$.extend(e.properties,{type:e.type});return this.createElement(this.unnormalizeType(e.type),{properties:t})},unnormalizeType:function(e){var t=this.constants.DEVICES;if(!this.deviceType)return e;switch(this.deviceType){case t.OFFLINE_SMARTPHONE:case t.SMARTPHONE:return"smartphone"+e;case t.OFFLINE_TABLET:case t.TABLET:return"tablet"+e;default:return e}},getPreviewOfflineFlag:function(){return this.previewOfflineIsEnable},setPreviewOfflineFlag:function(e){this.previewOfflineIsEnable=e},loadModel:function(e,t,i){i=void 0!==i&&bizagi.util.parseBoolean(i);var n=this.form=this.createElement(e,t,i);return this.isActivityForm&&0===n.buttons.length&&this.form.createDefaultButtons(),this.subscribeFormEvents(n),n},updateModel:function(e){this.form=e.form,this.hashResources=e.resources,this.isActivityForm&&0===this.form.buttons.length&&"offlineform"!=this.context&&this.form.createDefaultButtons(),this.subscribeFormEvents(this.form)},saveModel:function(){return this.form.getPersistenceModel()},getChangeset:function(){var e=this,t=e.publish("getIdForm"),i=e.publish("isNewForm"),n=e.publish("getIdParentForm"),o=[{action:"merge",deployOnParent:i?!e.isVersionable:e.deployOnParent,id:t,name:"form_"+t,type:e.getFormType(),parentId:n,modifiedByUser:BIZAGI_USER,content:JSON.stringify(e.form.getPersistenceModel())}];if(i&&e.isVersionable){var r=e.idFormClass;o.push({action:"merge",deployOnParent:!1,id:r,name:"FormClass_"+r,type:"FormClass",parentId:e.idParentForm,modifiedByUser:BIZAGI_USER,content:JSON.stringify({})}),o[0].parentId=r,e.publish("setIdParentForm",{idParentForm:r})}var a=this.form.getLocalizablePropertiesModel(t).concat(this.form.getLocalizableValidationMessagesModel(t));return{changeSet:o.concat(a).concat(e.getPropertiesDeleted(a))}},mustSetDeployOnParent:function(){var e=this.publish("getContextEntityType");return this.isVersionable&&"application"!=e&&this.isQueryForm()},getPropertiesDeleted:function(e){var t=this.resources||[],i=[],n={action:"delete"};return t.forEach(function(t){var n;n=t,e.filter(function(e){return e.id===n.id}).length>0||i.push(t.id)}),n.ids=i,n},getLocalizationObject:function(e){var t=e.i18n,i=this.hashResources[t.uri];if(e.regenerateGuid&&i&&(delete this.hashResources[t.uri],i.uri=e.newUri,this.hashResources[e.newUri]=i),!i)return t;var n=i.content,o={};return(n.languages||[]).forEach(function(e){o[e.code]=e.value}),{uri:n.uri,default:n.defaultValue.replace(/\\\\/g,"\\").replace(/\\\"/g,'"'),languages:o}},setResources:function(e){var t=this;t.hashResources={},t.resources=e,e.forEach(function(e){var i=e.content;t.hashResources[i.uri]={id:e.id,content:i}})},setDeployOnParent:function(e){this.deployOnParent=e},setOffline:function(e){this.enableOffline=e},isQueryForm:function(){return"queryform"==this.context},getFormType:function(){return"searchform"==this.context?"SearchForm":"offlineform"==this.context?"Form":"queryform"==this.context?"Query":"startform"==this.context?"StartForm":"template"==this.context?"Template":"Form"},createElement:function(e,t,i){return this.elementFactory.createElement(e,t,i)},getRibbonModelData:function(){return"template"==this.context?this.templateRibbonModel:"adhocform"==this.context?this.adhocRibbonModel:this.ribbonModel},addWidgets:function(e){this.elementFactory.addWidgetsControls(e)},getFlags:function(){return this.flags},getElementFactory:function(){return this.elementFactory},addCreateSpecificOptionToRibbon:function(){this.getRibbonModelData().elements.push({caption:"Devices",name:"Specific",elements:[{caption:"Customize",style:"Customize",action:"createSpecific",align:"vertical",css:"bz-studio bz-device-customize_32x32_standard"}]})},addBackToGenericToRibbon:function(){this.getRibbonModelData().elements.push({caption:"Devices",name:"BackToGeneric",elements:[{caption:"formmodeler-component-ribbon-caption-revertgeneric",style:"backGeneric",action:"backToGeneric",align:"vertical",css:"bz-studio bz-device-back-default_32x32_standard"}]})},addEmailOptionsToRibbonModel:function(){this.getRibbonModelData().elements.push({caption:"formmodeler-component-ribbon-caption-email",css:"bz-studio bz-newSystemConfiguration_32x32_standard",hide:!0,name:"email",elements:[{caption:"formmodeler-component-ribbon-caption-emailtemplate",style:"email-template",action:"emailTemplate",align:"vertical",disabled:"disabled",css:"bz-studio bz-newSystemConfiguration_32x32_standard"}]})},addCustomButtonsSwitchToRibbon:function(){for(var e=this.getRibbonModelData(),t={caption:"formmodeler-component-ribbon-caption-useCustomButtons",style:"validate",action:"useCustomButtons",disabled:"disabled",css:"bz-studio bz-form-buttons_16x16_standard",checked:!1,name:"customButtons"},i=0;i<e.elements.length;i++)"formmodeler-component-ribbon-caption-show"==e.elements[i].caption&&e.elements[i].elements.push(t)},addOfflineButtonToRibbonModel:function(){var e=this.getRibbonModelData();e.customOptions=e.customOptions||[],e.customOptions.push({name:this.constants.SUPPORT_OFFLINE,value:this.enableOffline})}}),bizagi.editor.base.form.prototype)"init"!=key&&"constructor"!=key&&"Class"!=key&&"subscribe"!=key&&"unsubscribe"!=key&&"publish"!=key&&(bizagi.editor.model.prototype[key]=eval("var tmp = function(){ \nif (this.getForm()){ \nreturn this.getForm()."+key+".apply(this.getForm(), arguments); \n} \nreturn null;};\ntmp \n"));bizagi.editor.model.extend("bizagi.editor.model",{ribbonModelData:{elements:[{caption:"formmodeler-component-ribbon-caption-form",name:"form",css:"bz-sprite-img bz-save_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-undo",style:"undo",action:"undo",disabled:"disabled",css:"bz-studio bz-undo_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-redo",style:"redo",action:"redo",disabled:"disabled",css:"bz-studio bz-redo_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-save",style:"save",action:"save",align:"vertical",disabled:"disabled",css:"bz-studio bz-save_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-copyfrom",style:"copy-from",action:"copy-from",align:"vertical",disabled:"disabled",css:"bz-studio bz-copy-form_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-copyformat",style:"copy-format",action:"copy-format",align:"vertical",disabled:"disabled",css:"bz-studio bz-copy-format_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-properties",style:"form-properties",action:"formproperties",align:"vertical",disabled:"disabled",css:"bz-studio bz-form-properties_32x32_standard"}]},{caption:"formmodeler-component-ribbon-caption-show",name:"show",css:"bz-studio bz-warning_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-validations",style:"validate",action:"validate",checked:!1,css:"bz-studio bz-warning_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-validation",name:"validation",elements:[{caption:"formmodeler-component-ribbon-caption-actionsvalidations",style:"actions-validations",action:"actionsvalidations",align:"vertical",disabled:"disabled",css:"bz-studio bz-actions-and-validations_32x32_standard"}]},{caption:"formmodeler-component-ribbon-caption-element",name:"element",css:"bz-studio bz-save_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-convertto",style:"convert-to",action:"convertto",disabled:"disabled",css:"bz-studio bz-convert-to_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-delete",style:"delete",action:"delete",disabled:"disabled",css:"bz-studio bz-delete_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-rename",style:"rename",action:"rename",disabled:"disabled",css:"bz-studio bz-rename_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-visible",style:"visible",property:"visible",disabled:"disabled",css:"bz-studio bz-visible_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"visible",value:{fixedvalue:"true"},css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"visible",value:{fixedvalue:"false"},css:"bz-studio bz-boolean-remove_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-expression",style:"expression",property:"visible",value:"expression",css:"bz-studio bz-expresion-ex_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-editable",style:"editable",property:"editable",disabled:"disabled",css:"bz-studio bz-editable_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"editable",value:{fixedvalue:"true"},css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"editable",value:{fixedvalue:"false"},css:"bz-studio bz-boolean-remove_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-expression",style:"expression",property:"editable",value:"expression",css:"bz-studio bz-expresion-ex_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-required",style:"required",property:"required",disabled:"disabled",css:"bz-studio bz-required_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"required",value:{fixedvalue:"true"},css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"required",value:{fixedvalue:"false"},css:"bz-studio bz-boolean-remove_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-expression",style:"expression",property:"required",value:"expression",css:"bz-studio bz-expresion-ex_16x16_standard"}]}]},{caption:"formmodeler-component-ribbon-caption-languages",name:"languages",css:"bz-studio bz-world_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-language",style:"language",property:"language",css:"bz-studio bz-world_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-default",style:"language",property:"language",css:"bz-studio bz-world_16x16_standard",action:"Language",value:{displayname:"default",IsRightToLeft:!1,key:"default"}}]}]}]},ribbonModelTemplateData:{elements:[{caption:"formmodeler-component-ribbon-caption-form",name:"form",elements:[{caption:"formmodeler-component-ribbon-caption-undo",style:"undo",action:"undo",disabled:"disabled",css:"bz-studio bz-undo_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-redo",style:"redo",action:"redo",disabled:"disabled",css:"bz-studio bz-redo_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-save",style:"save",action:"save",align:"vertical",disabled:"disabled",css:"bz-studio bz-save_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-copyformat",style:"copy-format",action:"copy-format",align:"vertical",disabled:"disabled",css:"bz-studio bz-copy-format_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-properties",style:"form-properties",action:"formproperties",align:"vertical",disabled:"disabled",css:"bz-studio bz-form-properties_32x32_standard"}]},{caption:"formmodeler-component-ribbon-caption-show",name:"show",css:"bz-studio bz-warning_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-validations",style:"validate",action:"validate",checked:!1,css:"bz-studio bz-studio bz-warning_16x16_standard"}]}]},ribbonModelDataOffline:{elements:[{caption:"formmodeler-component-ribbon-caption-form",name:"form",elements:[{caption:"formmodeler-component-ribbon-caption-undo",style:"undo",action:"undo",disabled:"disabled",css:"bz-studio bz-undo_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-redo",style:"redo",action:"redo",disabled:"disabled",css:"bz-studio bz-undo_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-save",style:"save",action:"save",align:"vertical",disabled:"disabled",css:"bz-studio bz-save_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-copyformat",style:"copy-format",action:"copy-format",align:"vertical",disabled:"disabled",css:"bz-studio bz-copy-format_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-properties",style:"form-properties",action:"formproperties",align:"vertical",disabled:"disabled",css:"bz-studio bz-form-properties_32x32_standard"}]},{caption:"formmodeler-component-ribbon-caption-show",name:"show",css:"bz-studio bz-warning_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-validations",style:"validate",action:"validate",checked:!1,css:"bz-studio bz-studio bz-warning_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-validation",name:"validation",elements:[{caption:"formmodeler-component-ribbon-caption-actionsvalidations",style:"actions-validations",action:"actionsvalidations",align:"vertical",disabled:"disabled",css:"bz-studio bz-actions-and-validations_32x32_standard"}]},{caption:"formmodeler-component-ribbon-caption-element",name:"element",css:"bz-studio bz-undo_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-convertto",style:"convert-to",action:"convertto",disabled:"disabled",css:"bz-studio bz-convert-to_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-delete",style:"delete",action:"delete",disabled:"disabled",css:"bz-studio bz-delete_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-rename",style:"rename",action:"rename",disabled:"disabled",css:"bz-studio bz-rename_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-visible",style:"visible",property:"visible",disabled:"disabled",css:"bz-studio bz-visible_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"visible",value:"true",css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"visible",value:"false",css:"bz-studio bz-boolean-remove_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-editable",style:"editable",property:"editable",disabled:"disabled",css:"bz-studio bz-editable_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"editable",value:"true",css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"editable",value:"false",css:"bz-studio bz-boolean-remove_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-required",style:"required",property:"required",disabled:"disabled",css:"bz-studio bz-required_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"required",value:"true",css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"required",value:"false",css:"bz-studio bz-boolean-remove_16x16_standard"}]}]},{caption:"formmodeler-component-ribbon-caption-languages",name:"languages",css:"bz-studio bz-world_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-language",style:"language",property:"language",css:"bz-studio bz-world_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-default",style:"language",property:"language",css:"bz-studio bz-world_16x16_standard",action:"Language",value:{displayname:"default",IsRightToLeft:!1,key:"default"}}]}]}]},ribbonModelAdhoc:{elements:[{caption:"formmodeler-component-ribbon-caption-form",name:"form",elements:[{caption:"formmodeler-component-ribbon-caption-undo",style:"undo",action:"undo",disabled:"disabled",css:"bz-studio bz-undo_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-redo",style:"redo",action:"redo",disabled:"disabled",css:"bz-studio bz-redo_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-save",style:"save",action:"save",align:"vertical",disabled:"disabled",css:"bz-studio bz-save_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-copyformat",style:"copy-format",action:"copy-format",align:"vertical",disabled:"disabled",css:"bz-studio bz-copy-format_32x32_standard"},{caption:"formmodeler-component-ribbon-caption-properties",style:"form-properties",action:"formproperties",align:"vertical",disabled:"disabled",css:"bz-studio bz-form-properties_32x32_standard"}]},{caption:"formmodeler-component-ribbon-caption-show",name:"show",css:"bz-studio bz-warning_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-validations",style:"validate",action:"validate",checked:!1,css:"bz-studio bz-studio bz-warning_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-element",name:"element",css:"bz-studio bz-undo_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-delete",style:"delete",action:"delete",disabled:"disabled",css:"bz-studio bz-delete_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-rename",style:"rename",action:"rename",disabled:"disabled",css:"bz-studio bz-rename_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-visible",style:"visible",property:"visible",disabled:"disabled",css:"bz-studio bz-visible_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"visible",value:"true",css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"visible",value:"false",css:"bz-studio bz-boolean-remove_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-editable",style:"editable",property:"editable",disabled:"disabled",css:"bz-studio bz-editable_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"editable",value:"true",css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"editable",value:"false",css:"bz-studio bz-boolean-remove_16x16_standard"}]},{caption:"formmodeler-component-ribbon-caption-required",style:"required",property:"required",disabled:"disabled",css:"bz-studio bz-required_16x16_standard",elements:[{caption:"formmodeler-component-ribbon-caption-true",style:"true",property:"required",value:"true",css:"bz-studio bz-yes-no_16x16_standard"},{caption:"formmodeler-component-ribbon-caption-false",style:"false",property:"required",value:"false",css:"bz-studio bz-boolean-remove_16x16_standard"}]}]}]}},{}),bizagi.editor.observableClass.extend("bizagi.editor.controls",{},{init:function(e,t){this._super(),this.controls={},this.convertToMap={},this.controlsToConvert={},t=t||{},void 0!==e&&this.processData(e,t)},processData:function(e,t){var i=this;$.each(e.controls,function(e,n){t[n.name]||(i.isConvertible(n.name)&&i.addControlInConvertToMap(n),i.controls[n.name]=n)})},findControl:function(e){var t=this.controls[e];if(null==t)throw"there aren't a control with name "+e;return t},disabledControls:function(e){for(var t in e)this.controls[t]&&e[t]&&delete this.controls[t]},getDesignProperties:function(e){var t=this.findControl(e);return t.design&&t.design.properties?t.design.properties:{}},getGuidControl:function(e){return this.findControl(e).jquery},isConvertible:function(e){return"association"!=e&&("userpassword"!=e&&("comboselected"!=e&&("getuser"!=e&&"stakeholder"!=e)))},addControlInConvertToMap:function(e){var t=e.type||"render",i=e.design?e.design.properties:null;if(i){var n=i.xpath;if(n&&n["bas-type"]){var o=this.getConvertToMap(t);o[n["bas-type"]]||(o[n["bas-type"]]=[]);var r={controlName:e.name,filterBy:n["editor-parameters"]?n["editor-parameters"].types:null,caption:bizagi.editor.utilities.resolveInternalResource(e.display),style:e.style};o[n["bas-type"]].push(r),this.controlsToConvert[e.name]={siblings:o[n["bas-type"]],definition:r}}}},getConvertToMap:function(e){return this.convertToMap[e]||(this.convertToMap[e]={}),this.convertToMap[e]},getControlsToConvert:function(e){var t=this;if(!t.controlsToConvert[e])return[];var i=t.controlsToConvert[e];return $.grep(i.siblings,function(e,n){return e.controlName!==i.definition.controlName&&t.filterBy(i,e.filterBy)})},filterBy:function(e,t){if(e.definition.filterBy&&$.isArray(e.definition.filterBy)&&t&&$.isArray(t)){for(var i=0,n=e.definition.filterBy.length;i<n;i+=1){var o=e.definition.filterBy[i];if(t.indexOf(o)>=0)return!0}return!1}return!0},disableControlProperties:function(e){for(var t in bizagi.editor.overrides[e]){var i=bizagi.editor.overrides[e][t],n=this.controls[t];if(null!=n&&bizagi.editor.utilities.isObject(i)){var o=i.properties&&i.properties.disable||[];n.disableProperties=n.disableProperties?n.disableProperties:[];for(var r=0;r<=o.length;r++)n.disableProperties.push(o[r])}}}}),bizagi.editor.base.HostFacade=function(){var e={},t=function(){return!bizagi.editor.base.info.isCloud()&&"undefined"!=typeof sharedObject},i=function(e,t){var i=new $.Deferred;bizagi.log("Invoking host method "+e,t);var n=sharedObject.call(e,JSON.encode(t));bizagi.log("Result from invoking host method "+e,n);try{n=JSON.parse(n)}catch(t){bizagi.log("Could not parse result for call "+e,t.message)}return i.resolve(n),i.promise()};return{getControlsMetadata:function(){var n,o=new $.Deferred;return e.getControlsMetadata?e.getControlsMetadata:(n=t()?i("GetControlDefinitions"):$.ajax({url:"jquery/editor/base/mocks/stub.controls.definition.json.txt",dataType:"json",async:!0}),$.when(n).done(function(t){bizagi.log("Current working control definitions: ",t),e.getControlsMetadata=t,o.resolve(t)}),o.promise())},getXpathNavigatorFirstLoad:function(){return t()?i("XpathNavigatorFirstLoad"):$.ajax({url:"jquery/editor/component/xpathNavigator/mocks/stub.xpathnavigator.firstLoad.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},getUserfieldDependencies:function(e){return t()?i("GetUserfieldDependencies",{name:e}):$.ajax({url:"jquery/editor/component/xpathNavigator/mocks/stub.xpathnavigator.firstLoad.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},GetUserfieldIconDependencies:function(e,n,o){return t()?i("GetUserfieldIconDependencies",{name:e,density:n,size:o}):$.ajax({url:"jquery/editor/base/mocks/stub.loadUserFieldIcon.json.txt",dataType:"text",async:!0}).pipe(function(e){return e})},getXpathNavigatorExpandLoad:function(e){var n;return t()?(params={contextScope:e.contextScope,guid:e.guidRelatedEntity,xpath:e.xpath,style:e.style,isScopeAttribute:e.isScopeAttribute},n=i("XpathNavigatorExpandLoad",params)):n=$.ajax({url:"jquery/editor/component/xpathNavigator/mocks/stub.xpathnavigator.forexpand.json.txt",dataType:"json",async:!0}).pipe(function(e){return e}),n},getLayoutNavigatorModel:function(){return t()?i("GetLayoutDefinitions"):$.ajax({url:"jquery/editor/component/layoutnavigator/mocks/stub.layoutnavigator.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},executeBasActions:function(e){var n;new $.Deferred;if(t())n=i("ExecuteBasActions",e);else{var o=e.actiontype.toLowerCase();n=$.ajax({url:"jquery/editor/base/mocks/stub."+o+".json.txt",dataType:"json",async:!0}).pipe(function(e){return e})}return n},LoadForm:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadform.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},GetReleatedEntityForms:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadrelatedforms.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},LoadExpression:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadexpression.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},LoadInterface:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadinterface.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},LoadLocalizationForm:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.multilenguages.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},LoadCopyForm:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadcopyform.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},LoadFilterEditor:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadfilter.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},LoadDocumentTemplates:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loaddocumentemplates.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},LoadEntityValues:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadentityvalues.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},GetAvailableLanguages:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.getavailablelanguages.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},GetAttributeDisplayName:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.atributtedisplayname.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},OpenWidgetstore:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadwigdetstore.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},InstallWidget:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.installwidget.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},GetWidgets:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.loadwigdets.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},VerifyLetters:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.verifyletters.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},GetParentEntities:function(){return $.ajax({url:"jquery/editor/base/mocks/stub.getparententities.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},CreateForm:function(e){var t=e.parameters,i=this.findKeyInParameters(t,"guidRender"),n=this.findKeyInParameters(t,"propertyName"),o=this.findKeyInParameters(t,"context");setTimeout(function(){bizagi.form.modeler.updateForm({actiontype:"CreateForm",guidrender:i,propertyname:n,context:o,idform:Math.guid()})},100)},findKeyInParameters:function(e,t){for(var i=0,n=e.length;i<n;i+=1)if(e[i].key===t)return e[i].value},getRibbonBaseModel:function(){return $.ajax({url:"jquery/editor/component/ribbon/mocks/stub.base.ribbon.json.txt",dataType:"json",async:!0}).pipe(function(e){return e})},loadRuleExpressions:function(e){var n=!1;t()&&(n=i("LoadBooleanExpression")),n&&(n=JSON.parse(n))}}}(),bizagi.editor.base.info=function(){function e(){}return e.prototype.isCloud=function(){return!(BIZAGI_URL_REST_SERVICES.indexOf("localhost")>=0)},new e}(),bizagi.editor.refreshableCommand.extend("bizagi.editor.moveElementCommand",{},{execute:function(){var e=this.arguments,t=this.controller.getContextInfo();return e.elementType=e.elementType||"render",this.parent||(this.parent=this.arguments.parent||t.guid),this.model.moveElement(e.initialPosition,e.finalPosition,this.parent,e.elementType),!0},undo:function(){var e=this.arguments;return this.model.moveElement(e.finalPosition,e.initialPosition,this.parent,e.searchformresult),!0}}),bizagi.rendering.element.original=$.extend(!0,{},bizagi.rendering.element.prototype),$.extend(bizagi.rendering.element.prototype,{isContainedInNestedForm:function(){return!!this.parent&&("nestedForm"===this.parent.properties.type||("collectionnavigator"===this.parent.properties.type||this.parent.isContainedInNestedForm()))},isContainedInCollectionNavigator:function(){return this.getFormContainer().properties.isNavigationForm||!1},isContainedInGrid:function(){return null!=this.column},isReadOnlyForm:function(){return!!((this.getFormContainer()||{}).properties||{}).isReadOnly},findElement:function(e){return e&&this.properties.guid===e?this:null},selectElement:function(){},unselectElement:function(){}}),bizagi.rendering.desktop.render.original=$.extend(!0,{},bizagi.rendering.desktop.render.prototype),$.extend(bizagi.rendering.desktop.render.prototype,{postRenderElement:function(e){var t=this,i=t.properties;if(bizagi.rendering.desktop.render.original.postRenderElement.apply(this,arguments),t.isReadOnlyForm())return e;if(setTimeout(function(){"label"===i.type&&t.triggerGlobalHandler("validateFormIsActive",{})&&0===bizagi.editor.utilities.resolvei18n(i.displayName).length&&e.addClass("displayName__required")},10),e.attr("guid",t.properties.guid),"template"==t.getFormType())return t.configureLayoutElement(e);if(!t.isContainedInNestedForm()&&!t.isContainedInCollectionNavigator()){t.setMouseDownEvent(e),t.isContainedInGrid()||(e.addClass("ui-bizagi-draggable-item"),e.addClass("ui-bizagi-itemfordrag"));var n,o=$(".ui-bizagi-render-search",e);if(o.length>0&&o.parent().addClass("ui-bizagi-display-as-search"),t.isClickEventAllowed())n="design"==t.getMode()&&"grid"==t.properties.type?t.getLabelGrid():t.getLabel(),e.click(function(i){t.onRenderClick(i,e)}),bizagi.form.modeler.params.reviewMode||n.dblclick(function(){t.onLabelDoubleClick(n)}),t.properties.messageValidation}return e.data({guid:t.properties.guid,display:t.properties.displayName,type:t.properties.type}),t.resetStyle(e)},configureLayoutElement:function(e){var t=this;return t.configureDroppablePlugin(e),t.configureDraggablePlugin(e),e.click(function(i){t.onRenderClick(i,e)}),e.dblclick(function(){t.onLabelDoubleClick(e)}),e.find(".biz-template-editor-render-hide-control").click(function(i){t.onRemoveElement(i,e)}),t.setDeleteLayoutItem(e),e},setDeleteLayoutItem:function(e){var t=this,i=(t.properties.type,$("<span class='biz-icon biz-tmpl-delete pull-right bz-studio bz-delete_16x16_standard'></span>")),n=$("<span class='biz-icon biz-tmpl-delete pull-right bz-studio bz-undo_16x16_black'></span>"),o=e.closest("[id]");setTimeout(function(){if(0==o.length&&t.triggerGlobalHandler("isDeleteOptionAllowed",{guid:t.properties.guid}))e.addClass("hover-applied"),e.hover(function(){$(this).append(n)},function(){$(this).find("span.biz-tmpl-delete").detach()}),n.click(function(){t.triggerGlobalHandler("restoreItem",{guid:t.properties.guid})});else{if(null==o.attr("id"))return;if(o.hasClass("hover-applied"))return;o.addClass("hover-applied"),o.hover(function(){$(this).append(i)},function(){$(this).find("span.biz-tmpl-delete").detach()}),r=o,i.click(function(){t.triggerGlobalHandler("deleteRepeaterItem",{guid:r.attr("id")})})}var r},10)},configureDraggablePlugin:function(e){e.draggable({helper:"clone",zIndex:9999,opacity:.75,cursorAt:{left:5},containment:"document",cancel:".biz-template-editor-render-placeholder",start:function(e,t){$(t.helper).data("isLayoutElement",!0)}})},configureDroppablePlugin:function(e){var t=this;e.droppable({hoverClass:"ui-state-highlight",tolerance:"pointer",activeClass:"ui-editor-highlight",greedy:!0,drop:function(e,t){$(this).addClass("ui-state-highlight")},activate:function(){t.getFormContainer().container.find("[noShow='true']").show()},deactivate:function(){t.getFormContainer().container.find("[noShow='true']").hide()}}),e.on("drop",function(e,i){t.onDrop(i)})},getLabelGrid:function(){return $(".bz-rn-grid-header-title",this.element)},resetStyle:function(e){var t=e,i=t.css("color"),n=t.css("background-color");return"black"==i&&t.css("color",""),"white"==n&&t.css("background-color",""),t},selectElement:function(e){var t,i=this,n=i.properties;if(!i.actionInProgress&&i.element){i.actionInProgress=!0,i.element.addClass("ui-state-active");var o=i.element.offset();$.extend(o,{width:i.element.outerWidth(),height:i.element.outerHeight()}),t=$.extend(e,{position:o,guid:i.properties.guid,element:i.element,type:i.properties.type,isInternal:n.isInternal}),$.when(i.triggerGlobalHandler("selectelement",t)).always(function(){i.actionInProgress=!1})}},unselectElement:function(e){this.element.removeClass("ui-state-active"),e&&$.extend(e,{guid:this.properties.guid}),this.triggerGlobalHandler("unselectelement",e)},isClickEventAllowed:function(){return"design"===this.getMode()&&!this.column&&!this.isColumn},setMouseDownEvent:function(e){var t=this;t.isClickEventAllowed()&&e.bind("mousedown.contextmenu",function(e){return 2!=e.button||(t.triggerGlobalHandler("elementrightclick",{guid:t.properties.guid,position:{x:e.clientX,y:e.clientY}}),e.preventDefault(),e.stopPropagation(),!1)})},changeVisibility:function(e){var t=this.properties;1==bizagi.util.parseBoolean(e)?$(this.element).removeClass("ui-state-disabled"):$(this.element).addClass("ui-state-disabled"),t.visible=e},showValidationMessage:function(e){(e=e.split("</br>")[0])&&this.setValidationMessage(e)},onRenderClick:function(e,t){e.stopPropagation(),e.preventDefault(),this.triggerGlobalHandler("checkCtrlKey",{})?t&&t.hasClass("ui-state-active")?this.unselectElement({ctrlIsPressed:!0}):($(document.activeElement).is("input")&&$(document.activeElement).closest(".bizagi_editor_component_properties").length>0&&($(document.activeElement).trigger("blur"),$(".bizagi_editor_component_properties").hide()),this.selectElement({IsOnClickEvent:!0,ctrlIsPressed:!0})):(0!=e.button&&1!=e.button||($(".ui-bizagi-render").not(t).removeClass("ui-state-active"),$(".bz-form-old-item").not(t).removeClass("ui-state-active"),$(".ui-bizagi-grid-cell").not(t).removeClass("ui-state-active"),$(".ui-bizagi-button").not(t).removeClass("bz-state-active"),$(".ui-bizagi-container").removeClass("ui-bizagi-container-selected"),$(".ui-bizagi-render-layout").not(t).removeClass("ui-state-active")),t&&t.hasClass("ui-state-active")?this.unselectElement():($(document.activeElement).is("input")&&$(document.activeElement).closest(".bizagi_editor_component_properties").length>0&&($(document.activeElement).trigger("blur"),$(".bizagi_editor_component_properties").hide()),this.selectElement({IsOnClickEvent:!0})))},onLabelDoubleClick:function(e){var t=this;if("label"===t.properties.type&&t.unselectElement({}),t.triggerGlobalHandler("canChangeLabel",{guid:t.properties.guid})){t.triggerGlobalHandler("startlabeledition");var i=new bizagi.editor.component.editableLabel.presenter({label:e,value:t.properties.displayName});i.subscribe("change",function(e,i){t.triggerGlobalHandler("changelabel",{guid:t.properties.guid,value:i.value})}),i.subscribe("finish",function(){t.triggerGlobalHandler("finishlabeledition")}),i.render()}},onRemoveElement:function(e,t){this.triggerGlobalHandler("hideElement",{guid:this.properties.guid})},showElementLabelEditor:function(){this.element.find(".ui-bizagi-container-input-editable > input.ui-bizagi-input-editable").length>0||$("label",this.element).trigger("dblclick")},onDrop:function(e){var t=$(e.draggable),i=$(e.helper),n=t.data(),o=i.data(),r=bizagi.editor.utilities.buildComplexXpath(n.xpath,n.contextScope,n.isScopeAttribute,n.guidRelatedEntity);this.triggerGlobalHandler("dropfinish",{guid:this.properties.guid,property:"xpath",value:r,renderType:n.nodeSubtype,sourceGuid:!(!o||!o.isLayoutElement)&&i.attr("guid")})}}),bizagi.rendering.desktop.container.original=$.extend(!0,{},bizagi.rendering.desktop.container.prototype),$.extend(bizagi.rendering.desktop.container.prototype,{postRenderContainer:function(e){var t=this;return bizagi.rendering.desktop.container.original.postRenderContainer.apply(this,arguments),e.hasClass("ui-sortable")&&e.sortable("destroy"),e.addClass("ui-bizagi-itemfordrag"),t.addDraggableClassToContainer(),t.isReadOnlyForm()?e:"template"==t.getFormType()?("template"==t.properties.type&&e.click(function(e){t.onClickCanvas(e)}),e):(t.isContainerSortable()&&(e.data({guid:t.properties.guid,display:t.properties.displayName,type:t.properties.type}),bizagi.form.modeler.params.reviewMode||setTimeout(function(){t.configureSortablePlugin(e)},100)),t.isClickEventAllowed()&&(void 0!==t.properties.type&&"searchForm"!==t.properties.type&&"form"!==t.properties.type&&"queryForm"!==t.properties.type?(e.mousedown(function(e){t.onMouseDown(e)}),e.click(function(e){t.onClick(e)})):e.click(function(e){t.onClickCanvas(e)})),t.changeVisibility(t.properties.visible),e)},selectElementByGuid:function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t],o=this.findElement(n);o&&o.selectElement({IsOnClickEvent:!1})}},findElement:function(e){if(!e)return null;if(this.properties.guid===e)return this;for(var t=0;t<this.children.length;t++){var i=this.children[t].findElement(e);if(i)return i}return null},disableSortablePlugin:function(){this.container&&this.container.hasClass("ui-sortable")&&this.container.data()["ui-sortable"]&&this.container.sortable("destroy");for(var e=0,t=this.children.length;e<t;e+=1)this.children[e].container&&this.children[e].disableSortablePlugin()},selectElement:function(e){var t=this.container;t.addClass("ui-bizagi-container-selected");var i=t.offset();$.extend(i,{width:t.outerWidth(),height:t.outerHeight()}),this.triggerGlobalHandler("selectelement",$.extend(e,{position:i,guid:this.properties.guid,element:t,type:this.properties.type}))},unselectElement:function(e){this.container.removeClass("ui-bizagi-container-selected"),e&&$.extend(e,{guid:this.properties.guid}),this.triggerGlobalHandler("unselectelement",e)},configureSortablePlugin:function(e){var t=this,i=t.triggerGlobalHandler("getMainPanel",{}),n='form-modeler[id="'+t.triggerGlobalHandler("getViewID")+'"]';e.addClass("ui-bizagi-container-connectedSortable"),e.bind("sortstart",function(e,i){t.onSortStart(i)}),e.bind("sortstop",function(e,i){t.onSortFinish(i)}),e.bind("sort",function(e){t.onScrollingForm(i,e)}),e.bind("sortactivate",function(e,i){t.currentDragSource=t.getDragSource(i.item)});e.sortable({items:"> .ui-bizagi-draggable-item",revert:!1,connectWith:n+" .ui-bizagi-container-connectedSortable:not(.ui-sortable-helper)",distance:10,cursorAt:{top:0,left:0},placeholder:"ui-bizagi-placeholder",delay:150,cancel:"layout"===t.getMode()?".ui-bizagi-render, .ui-bizagi-input-editable":".ui-bizagi-input-editable, .ui-bizagi-grid-cell",containment:i,helper:function(e,i){return t.sortableHelper(i)},start:function(){i&&i.addClass("ui-start-drag")},stop:function(){i&&i.removeClass("ui-start-drag")},beforeStop:function(){window.x3=$("#mtool-container-helper")}}).disableSelection(),t.loadHelperTemplate()},setConnectWith:function(e,t){var i;void 0!==e&&(i=(i=".ui-bizagi-container-connectedSortable")+"[id!= "+t+"]",e.container&&e.container.hasClass("ui-sortable")&&e.container.data()["ui-sortable"]&&e.container.sortable("option","connectWith",i),this.setConnectWith(e.parent,t))},addDraggableClassToContainer:function(){var e=this;if(e.isContainerDraggable()){if(e.container.addClass("ui-bizagi-draggable-item"),e.container.addClass("ui-dashed-layout"),"horizontal"===e.properties.type&&e.container.addClass("ui-table"),0===$(".ui-widget-content",e.container).children().length)$(".ui-widget-content",e.container).append('<div class="children"></div>');else if(e.container.hasClass("ui-bizagi-container-tab"))for(var t=$(".ui-bizagi-container-tabItem",e.container),i=0;i<t.length;i++){var n=$(t[i]);0===n.children().length&&n.append('<div class="children"></div>')}if(!e.container.hasClass("ui-bizagi-container-nestedform")&&!e.container.hasClass("ui-bizagi-container-collectionnavigator")){var o=$("> .ui-bizagi-container-panel",e.container);for(o.addClass("ui-col"),i=0;i<o.length;i++){var r=$(o[i]);0===r.children().length&&r.append('<div class="children"></div>')}}e.container.hasClass("ui-dashed-layout")&&(e.container.data("display","Layout"),e.container.data("type","layout")),$("> .ui-bizagi-container-panel",e.container).mouseenter(function(){$(this).addClass("ui-col-hover")}).mouseleave(function(){$(this).removeClass("ui-col-hover")})}},isContainerDraggable:function(){if(this.isContainedInNestedForm()||this.isContainedInCollectionNavigator())return!1;var e=this.properties.type||"form";return"group"==e||"nestedForm"==e||"tab"==e||"horizontal"==e||"contentPanel"==e||"collectionnavigator"==e},isContainerSortable:function(){if(this.isContainedInNestedForm()||this.isContainedInCollectionNavigator())return!1;var e=this.properties.type||"form";return"form"==e||"group"==e||"panel"==e||"tabItem"==e||"queryForm"==e||"searchForm"==e||"contentPanel"==e||"offlineForm"==e||"adhocForm"==e},isElementSortAllowed:function(e){var t=this.getMode();if("design"===t){if(e.hasClass("ui-bizagi-container-horizontal"))return!1}else if("layout"===t&&e.hasClass("ui-bizagi-render"))return!1;return!0},isClickEventAllowed:function(){var e=this.getMode();if(this.isContainedInNestedForm()||this.isContainedInCollectionNavigator())return!1;var t=this.properties.type||"form";if("design"==e){if("panel"==t)return!1}else if("layout"==e&&["form","group","panel","tab","tabItem","contentPanel"].includes(t))return!1;return!0},sortableHelper:function(e){if(!this.helperTemplate)return null;e.addClass("ui-dragging");var t=e.data(),i=t.type?t.type.toLowerCase():"render",n=t.guid,o=t.display,r=this.triggerGlobalHandler("getControlIcon",{type:i,id:n}),a=this.triggerGlobalHandler("getMainContainer",{});o&&""!==o||(o=i);var s=$.tmpl(this.helperTemplate,{id:i,caption:o,icon:r}),l=$(".wrapper-main-scroll",a),d=s.appendTo(l).css({zIndex:900}),c=parseFloat($("label",d).width())+parseFloat($(".biz-ico",d).eq(0).width())+40+"px";return d.css("width",c),d},loadHelperTemplate:function(){var e=this;return $.when(bizagi.templateService.getTemplate(bizagi.getTemplate("bizagi.editor.component.renderingview").concat("#bizagi-render-drag-helper"))).pipe(function(t){return e.helperTemplate=t,e.helperTemplate})},getDragSource:function(e){var t={container:!1,toolbar:!1,xpathNavigator:!1,layout:!1,data:null};return $(e).hasClass("ui-bizagi-render")||$(e).hasClass("ui-bizagi-container")?(t.container=!0,t.data={guid:$(e).parents(".ui-bizagi-container").first().data("guid")}):$(e).hasClass("mtool-item")?(t.toolbar=!0,t.data=$(e).data("render")):$(e).hasClass("bizagi_editor_xpathnavigator_data")?(t.xpathNavigator=!0,t.data=$(e).data()):$(e).hasClass("bz-fm-layout-navigator-item")&&(t.layout=!0,t.data=$(e).data("id")),t},changeVisibility:function(e){var t=this.properties;t.visible=bizagi.util.parseBoolean(e),t.visible?$(this.container).removeClass("ui-state-disabled"):$(this.container).addClass("ui-state-disabled")},getSortableContainer:function(){return this.container},onScrollingForm:function(e,t){},onSortStart:function(e){var t=$(e.item).parent().children(".ui-bizagi-itemfordrag").index(e.item);e.item.data("start-position",t);var i=$(e.item).parents(".ui-bizagi-container").first().data("guid")||this.triggerGlobalHandler("getparentid",{guid:$(e.item).data("guid")});e.item.data("sourceContainer",i),t>=0&&this.triggerGlobalHandler("sortstart")},onSortFinish:function(e){if(null==bizagi.sortContainerTimeout){bizagi.sortContainerTimeout=setTimeout(function(){bizagi.sortContainerTimeout=null},100);var t=$(e.item).parent().children(".ui-bizagi-itemfordrag").not(".ui-sortable-placeholder").index(e.item),i=$(e.item).parents(".ui-bizagi-container").first().data("guid")||this.triggerGlobalHandler("getparentid",{guid:$(e.item).data("guid")}),n=e.item.data("start-position"),o=e.item.data("sourceContainer");return 0==this.isElementSortAllowed($(e.item))?(this.getSortableContainer().sortable("cancel"),!1):(t>=0&&this.triggerGlobalHandler("sortfinish",{source:this.currentDragSource,initialPosition:n,finalPosition:t,sourceContainer:o,targetContainer:i}),!0)}},onClickCanvas:function(e){e.stopImmediatePropagation(),$(".ui-bizagi-render").removeClass("ui-state-active"),$(".bz-form-old-item").removeClass("ui-state-active"),$(".ui-bizagi-grid-cell").removeClass("ui-state-active"),$(".ui-bizagi-container").removeClass("ui-bizagi-container-selected"),this.unselectElement(),0!=e.button&&1!=e.button||this.triggerGlobalHandler("selectcontainerform",{})},onClick:function(e){var t=this.container;e.stopImmediatePropagation(),this.triggerGlobalHandler("checkCtrlKey",{})?t.hasClass("ui-bizagi-container-selected")?this.unselectElement({ctrlIsPressed:!0}):this.selectElement({IsOnClickEvent:!0,ctrlIsPressed:!0}):0!=e.button&&1!=e.button||($(".ui-bizagi-render").removeClass("ui-state-active"),$(".ui-bizagi-container").not(t).removeClass("ui-bizagi-container-selected"),t.hasClass("ui-bizagi-container-selected")?this.unselectElement():this.selectElement({IsOnClickEvent:!0}))},onMouseDown:function(e){if(0==e.button||1==e.button)this.setConnectWith(this.parent,this.container.data("guid"));else if(2==e.button)return this.triggerGlobalHandler("elementrightclick",{guid:this.properties.guid,position:{x:e.clientX,y:e.clientY}}),e.preventDefault(),e.stopPropagation(),!1}}),bizagi.rendering.desktop.form.original=$.extend(!0,{},bizagi.rendering.desktop.form.prototype),$.extend(bizagi.rendering.desktop.form.prototype,{postRenderContainer:function(e){if(bizagi.rendering.desktop.form.original.postRenderContainer.apply(this,arguments),void 0!==typeof this.params.allowButtons&&this.params.allowButtons||$(".ui-bizagi-button-container",e).remove(),this.properties.messageValidation&&this.properties.messageValidation.length>0){var t=this.createMessageValidationElement(this.properties.messageValidation);t.tooltip(),e.prepend(t)}return e},createMessageValidationElement:function(e){var t=this;e=e.replace("</br>","");var i=bizagi.localization.getResource("formmodeler-validations-form"),n=$('<div class="ui-message-validation"/>');return $("<span>"+i+'<i class="biz-ico bz-studio bz-warning-red_16x16_standard" title="'+e+'"></i></span>').appendTo(n),$(n,"div").click(function(){t.triggerGlobalHandler("showPropertiesForm")}),n},configureFormButtons:function(e){var t=this,i=e.find(".ui-bizagi-button-container"),n=$(".ui-bizagi-button",i);n.wrap("<span></span>");var o=$(".bz-fm-buttoneditor-add",i);o.button(),$(".ui-button-text",o).addClass("bz-fm-buttoneditor-add-icon");void 0!==typeof t.params.allowButtons&&t.params.allowButtons;n.click(t.clickButton.bind(t)),o.click(t.clickAddButton.bind(t)),$(".bz-fm-buttoneditor-add",i).button(),$(".bz-fm-buttoneditor-add .ui-button-text",i).addClass("bz-fm-buttoneditor-add-icon");var r=$(i.children()[0]);r.sortable({items:r.children().not(".bz-fm-avoid-sort"),cancel:"textarea,select,option",distance:10,axis:"x",cursorAt:{top:-3,left:0},placeholder:"ui-bizagi-button-placeholder bz-fm-avoid-sort",delay:150,start:function(e,i){t.sortStart(e,i)},tolerance:"pointer",stop:function(e,i){t.sortFinish(e,i)}})},clickButton:function(){console.log("Click button")},clickAddButton:function(){this.triggerGlobalHandler("addButton"),console.log("Add new button")},onScrollingForm:function(e,t){var i=e[0],n=i.getBoundingClientRect(),o=n.top,r=n.bottom;function a(){return Math.abs(t.clientY-o)<=40}(a()||Math.abs(r-t.clientY)<=50)&&setTimeout(function(){var t=a()?-1:1,n=e.scrollTop();if(!(1===t&&n>i.scrollHeight-i.offsetHeight)){var o=n+40*t;e.scrollTop(o)}},100)}}),bizagi.rendering.desktop.group.original=$.extend(!0,{},bizagi.rendering.desktop.group.prototype),$.extend(bizagi.rendering.desktop.group.prototype,{postRenderContainer:function(e){var t=this;if(bizagi.rendering.desktop.group.original.postRenderContainer.apply(this,arguments),!t.isReadOnlyForm()){var i=e.find(".ui-bizagi-container-group-header:first a");t.isInNestedform()||i.dblclick(function(){t.triggerGlobalHandler("startlabeledition");var e=new bizagi.editor.component.editableLabel.presenter({label:i,value:t.properties.displayName});e.subscribe("change",function(e,i){t.triggerGlobalHandler("changelabel",{guid:t.properties.guid,value:i.value})}),e.subscribe("finish",function(){t.triggerGlobalHandler("finishlabeledition")}),e.render()});var n=t.properties.guid;setTimeout(function(){var e=t.triggerGlobalHandler("getLastInsertedElement");n==e&&(t.showElementLabelEditor(),t.triggerGlobalHandler("setLastInsertedElement",null))},0)}},disableSortablePlugin:function(){var e=this.container.find(".ui-bizagi-container-group-wrapper");e&&e.hasClass("ui-sortable")&&e.data()["ui-sortable"]&&e.sortable("destroy");for(var t=0,i=this.children.length;t<i;t+=1)this.children[t].container&&this.children[t].disableSortablePlugin()},configureSortablePlugin:function(e){return e=e.find(".ui-bizagi-container-group-wrapper"),bizagi.rendering.desktop.group.original.configureSortablePlugin.apply(this,arguments)},getSortableContainer:function(){return this.container.find(".ui-bizagi-container-group-wrapper")},isInNestedform:function(){var e=this.parent,t=this.properties,i=!1;do{if("nestedForm"==t.type||"collectionnavigator"==t.type){i=!0;break}t=e.properties,e=e.parent}while(void 0!==e);return i},showElementLabelEditor:function(){this.container.find(".ui-bizagi-container-input-editable > input.ui-bizagi-input-editable").length>0||this.container.find("a:first").trigger("dblclick")}}),bizagi.rendering.desktop.contentPanel.original=$.extend(!0,{},bizagi.rendering.desktop.contentPanel.prototype),$.extend(bizagi.rendering.desktop.contentPanel.prototype,{postRenderContainer:function(e){var t=this;bizagi.rendering.desktop.contentPanel.original.postRenderContainer.apply(this,arguments),e.addClass("ui-bizagi-container-contentpanel-formmodeler");var i=e.find(".ui-bizagi-container-contentpanel-header");i.dblclick(function(){i.hide(),t.triggerGlobalHandler("startlabeledition");var e=new bizagi.editor.component.editableLabel.presenter({label:i,value:t.properties.displayName});e.subscribe("change",function(e,i){t.triggerGlobalHandler("changelabel",{guid:t.properties.guid,value:i.value})}),e.subscribe("finish",function(){t.triggerGlobalHandler("finishlabeledition")}),$.when(e.render()).done(function(){0==t.getElement().find(".ui-bizagi-container-input-editable").length?setTimeout(function(){i.hide(),t.adjustEditLabel()},100):t.adjustEditLabel()})})},configureSortablePlugin:function(e){return e=e.find(".ui-bizagi-container-contentpanel-wrapper"),bizagi.rendering.desktop.contentPanel.original.configureSortablePlugin.apply(this,arguments)},getSortableContainer:function(){return this.container.find(".ui-bizagi-container-contentpanel-wrapper")},disableSortablePlugin:function(){var e=this.container.find(".ui-bizagi-container-contentpanel-wrapper");e&&e.hasClass("ui-sortable")&&e.data()["ui-sortable"]&&e.sortable("destroy");for(var t=0,i=this.children.length;t<i;t++)this.children[t].container&&this.children[t].disableSortablePlugin()},adjustEditLabel:function(){this.getElement().find(".ui-bizagi-container-input-editable").css({width:"95%","background-color":"orange",top:"-18px","border-radius":"10px"}),this.getElement().find(".ui-bizagi-container-input-editable input").css({"margin-left":"5px",width:"90%"}),this.getElement().find(".ui-bizagi-render-confirmation").css({right:"10px",top:"5px"})},showElementLabelEditor:function(){this.container.find(".ui-bizagi-container-input-editable > input.ui-bizagi-input-editable").length>0||this.container.find("span:first").trigger("dblclick")}}),bizagi.rendering.desktop.tab.original=$.extend(!0,{},bizagi.rendering.desktop.tab.prototype),$.extend(bizagi.rendering.desktop.tab.prototype,{postRenderContainer:function(e){var t=this,i=t.properties;if(bizagi.rendering.desktop.tab.original.postRenderContainer.apply(this,arguments),!t.isReadOnlyForm()){if(!t.isContainedInNestedForm()&&!t.isContainedInCollectionNavigator())$(".bz-render-tab-add",e).click(function(e){return e.stopImmediatePropagation(),t.triggerGlobalHandler("addtab",{guid:i.guid}),!1}),$.each(t.children,function(t,i){var n=$("li[data-tab-guid="+i.properties.guid+"]",e);i.setTabHeader(n)}),$(".ui-tabs-nav",e).sortable({items:"li[data-tab-guid]",revert:!0,distance:10,axis:"x",cursorAt:{top:-3,left:0},placeholder:"ui-bizagi-tab-placeholder",delay:150,start:function(e,i){t.sortStart(e,i)},tolerance:"pointer",stop:function(e,i){t.sortFinish(e,i)}}),$(".ui-tabs-nav li",e).unbind("keydown");e.data({guid:t.properties.guid,display:t.properties.displayName,type:t.properties.type}),e.on("tabsload",function(e,i){t.triggerGlobalHandler("controlRefreshCanvas",{})}).on("tabsactivate",function(e,i){t.triggerGlobalHandler("controlRefreshCanvas",{})})}},sortStart:function(e,t){var i=$(t.item).parent().children("li[data-tab-guid]").not(".ui-bizagi-tab-placeholder").index(t.item);return t.item.data("start-position",i),this.initialPosition=i,!0},sortFinish:function(e,t){var i=$(t.item).parent().children("li[data-tab-guid]").not(".ui-bizagi-tab-placeholder").index(t.item);return this.triggerGlobalHandler("sortfinish",{source:{},initialPosition:t.item.data("start-position")||this.initialPosition,finalPosition:i,sourceContainer:this.properties.guid,targetContainer:this.properties.guid}),!0}}),bizagi.rendering.desktop.tabItem.original=$.extend(!0,{},bizagi.rendering.desktop.tabItem.prototype),$.extend(bizagi.rendering.desktop.tabItem.prototype,{setTabHeader:function(e){var t=this,i=t.properties;t.isContainedInNestedForm()||t.isContainedInCollectionNavigator()||($(".bz-render-tab-delete",e).click(function(){return t.triggerGlobalHandler("deletetab",{guid:i.guid}),!1}),$(".bz-render-tab-edit",e).click(function(){t.isEditableLabelActive()||t.editDisplayName(e)}),e.dblclick(function(){t.isEditableLabelActive()||t.editDisplayName(e)}).click(function(e){e.stopImmediatePropagation(),t.isEditableLabelActive()||t.triggerGlobalHandler("showProperties",{guid:t.properties.guid,redraw:!0})}).mousedown(function(e){2===e.button&&(e.stopImmediatePropagation(),t.isEditableLabelActive()||t.triggerGlobalHandler("elementrightclick",{guid:t.properties.guid,position:{x:e.clientX,y:e.clientY}}))}),e.droppable({accept:".ui-bizagi-draggable-item",hoverClass:"ui-bizagi-tab-drop-hover",tolerance:"pointer",drop:function(e,i){t.dropRender(e,i)},activate:function(e,i){t.currentDragSource=t.getDragSource(i.draggable)}}))},activate:function(){bizagi.rendering.desktop.tabItem.original.activate.apply(this,arguments),this.triggerGlobalHandler("activatetab",{guid:this.properties.guid})},editDisplayName:function(e){var t=this,i=$("a",e);t.triggerGlobalHandler("startlabeledition");var n=t.editableLabelPresenter=new bizagi.editor.component.editableLabel.presenter({label:i,value:t.properties.displayName});n.subscribe("change",function(e,i){t.triggerGlobalHandler("changelabel",{guid:t.properties.guid,value:i.value})}),n.subscribe("finish",function(){t.triggerGlobalHandler("finishlabeledition")}),n.render()},isEditableLabelActive:function(){return!(!this.editableLabelPresenter||!this.editableLabelPresenter.editableLabel)},dropRender:function(e,t){if("mouseup"===e.originalEvent.type){var i=this.children.length,n=this.properties.guid,o=t.draggable?t.draggable.data("start-position"):null,r=t.draggable?t.draggable.data("sourceContainer"):null,a=this.currentDragSource;if(bizagi.editor.utilities.isObject(a)){if(null!=bizagi.sortContainerTimeout)return;bizagi.sortContainerTimeout=setTimeout(function(){bizagi.sortContainerTimeout=null},100),this.triggerGlobalHandler("sortfinish",{source:a,initialPosition:o,finalPosition:i,sourceContainer:r,targetContainer:n})}}}}),bizagi.rendering.desktop.search.original=$.extend(!0,{},bizagi.rendering.desktop.search.prototype),$.extend(bizagi.rendering.desktop.search.prototype,{postRender:function(){var e=this;bizagi.rendering.desktop.search.original.postRender.apply(this,arguments),e.isReadOnlyForm()||e.advancedSearch&&!e.isContainedInNestedForm()&&e.advancedSearch.click(function(t){t.stopPropagation(),e.triggerGlobalHandler("showsearchform",{guid:e.properties.guid})})}}),bizagi.rendering.desktop.image.original=$.extend(!0,{},bizagi.rendering.desktop.image.prototype),$.extend(bizagi.rendering.desktop.image.prototype,{postRender:function(){var e=this,t=e.getControl(),i=e.properties.width,n=e.parent.properties.type;bizagi.rendering.desktop.image.original.postRender.apply(this,arguments),setTimeout(function(){if(-1===i){var o=$(".resizable_img",t),r=t.width(),a=t.height(),s=0,l=0;if("grid"==n)s=$(".resizable_img",t).closest("td").height();else if(e.parent.properties.id==e.getFormContainer().properties.id)s=50;else{var d=e.parent.getChildreCount(),c=e.parent.getChildrenSumHeight("image");s=(s=$(".resizable_img",t).closest(".ui-bizagi-container").height()-17)<50?50:s,l=e.parent.countByRenderTypeWithParams("image",-1),d>1&&(s-=c)}o.width(r),l>1?null!=s&&s>0?$(".resizable_img",e.parent.container).height(s/l+"px"):$(".resizable_img",t).height(a+"px"):null!=s&&s>0?o.height(s+"px"):o.height(a+"px")}e.triggerGlobalHandler("controlRefreshCanvas")},160)},changeImageSize:function(e,t){var i=this.getControl();this.executeTriggerHandler(i,e,t,"string")},executeTriggerHandler:function(e,t,i,n){var o="",r="";"string"==n?(o=t.slice(0,-2),r=i.slice(0,-2)):(o=t,r=i),this.triggerGlobalHandler("resizeImage",{guid:this.properties.guid,properties:[{property:"thumbnail.width",value:o},{property:"thumbnail.height",value:r}]})}}),bizagi.rendering.desktop.basicUserField.extend("bizagi.rendering.desktop.designUserField",{},{getEditableControl:function(){var e=this.getControl(),t='<div class="bz-input-icon bz-widget--fake"><input class="bz-input-icon__input bz-space--inline-s" placeholder="'+(this.properties.control+" Custom control")+'"/><svg class="bz-icn bz-space--inline-s" width="32px" height="32px"><use xlink:href="#gear" /></svg></div>';e.addClass("bz-widget__control--fake"),this.input=$(t).appendTo(e)},collectData:function(e){},getDisplayValue:function(){return"Userfield in design mode: "+this.properties.control},getReadonlyControl:function(){var e=this.getControl(),t='<div class="bz-input-icon bz-widget--fake"><input class="bz-input-icon__input bz-space--inline-s" placeholder="'+(this.properties.control+" Custom control")+'/><svg class="bz-icn bz-space--inline-s" width="32px" height="32px"><use xlink:href="#gear" /></svg></div>';return e.addClass("bz-widget__control--fake"),$(t).appendTo(e)}}),bizagi.rendering.desktop.collectionnavigator.original=$.extend(!0,{},bizagi.rendering.desktop.collectionnavigator.prototype),$.extend(bizagi.rendering.desktop.collectionnavigator.prototype,{postRender:function(){var e=this;bizagi.rendering.desktop.collectionnavigator.original.postRender.apply(this,arguments),$.when(e.isRendered()).done(function(){var t=e.properties,i=e.getControl().find(".bz-collectionnavigator-navigationform");t.navigationform&&setTimeout(function(){e.triggerGlobalHandler("refreshControl",{guid:t.guid,canvas:i})},0)})}}),bizagi.rendering.desktop.date.original=$.extend(!0,{},bizagi.rendering.desktop.date.prototype),$.extend(bizagi.rendering.desktop.date.prototype,{setDisplayValue:function(e){bizagi.rendering.desktop.date.original.setDisplayValue.apply(this,arguments);var t=this.properties,i=this.getDateControl().parent(),n=$(".ui-bizagi-render-date",i);if(t.valueFormat.color&&t.valueFormat.color.length>0){var o="bz-"+t.valueFormat.color.replace("#","")+"-placeholder",r="."+o+"::-webkit-input-placeholder{color:"+t.valueFormat.color+"}";bizagi.util.loadStyle(r,o),n.addClass(o)}t.valueFormat.strikethru&&t.valueFormat.underline?n.addClass("biz-modify-placeholder-through-underline"):(n.removeClass("biz-modify-placeholder-through-underline"),t.valueFormat.strikethru?n.addClass("biz-modify-placeholder-through"):n.removeClass("biz-modify-placeholder-through"),t.valueFormat.underline?n.addClass("biz-modify-placeholder-underline"):n.removeClass("biz-modify-placeholder-underline"))}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.moveElementContainerCommand",{},{execute:function(){var e=this.arguments;return this.element||(this.element=this.model.findElementByPosition(e.posIni,e.parentSource)),this.controller.executeCommand({command:"removeElement",position:e.posIni,parent:e.parentSource,canUndo:!1}),this.controller.executeCommand({command:"insertElement",position:e.posEnd,parent:e.parentTarget,element:this.element,canUndo:!1}),!0},undo:function(){var e=this.arguments;return this.controller.executeCommand({command:"removeElement",position:e.posEnd,parent:e.parentTarget,canUndo:!1}),this.controller.executeCommand({command:"insertElement",position:e.posIni,parent:e.parentSource,element:this.element,canUndo:!1}),!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.removeElementCommand",{},{execute:function(){var e=this.arguments,t=this.controller.getContextInfo(),i=this.arguments.parent||t.guid;return e.canValidate=!0,void 0!==this.arguments.position?this.model.removeElement(e.position,i,e.element):this.model.removeLastElement(i),!0},undo:function(){return!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.insertElementCommand",{},{execute:function(){var e=this,t=e.arguments,i=e.controller.getContextInfo(),n=t.parent||i.guid;if(!e.validateModel(n))return!1;t.canValidate=!0;var o=e.model.getElement(n);if("panel"==o.properties.type){var r=o.getParent();if("Row"===r.properties.layoutType&&o.elements.length>0){var a=r.getParent().elements.findIndex(function(e){return e.guid===r.guid});a=(a+=0===t.position?-1:1)<0?0:a;var s=r.elements.findIndex(function(e){return e.guid===o.guid}),l=e.controller.getLayoutNavigatorModel().findControlById("Row"),d=e.model.createLayoutElement(l);e.layoutPosition=a;var c=e.layoutParent=r.getParent().guid;return e.model.insertElement(a,c,d),e.model.insertElement(0,d.elements[s].guid,t.element),!0}}if(void 0!==t.position)e.model.insertElement(t.position,n,t.element);else{var u=e.model.addElement(t.element,n);t.position=u}return e.controller.executeCommand({command:"applyOverridesElement",overrides:{properties:!0,requiredProperties:!0},guid:t.element.guid,canUndo:!1}),!0},undo:function(){var e=this.controller.getContextInfo(),t=this.arguments.parent||e.guid;return this.layoutPosition?this.model.removeElement(this.layoutPosition,this.layoutParent):this.model.removeElement(this.arguments.position,t),!0},validateModel:function(e){var t=!0;if("offlinegrid"==this.controller.getContext()){var i=this.model.getElement(e);i&&$.isArray(i.elements)&&(t=i.elements.length<=3),t||bizagi.showMessageBox(bizagi.localization.getResource("formmodeler-component-gridcolumneditor-offline-max-columns"),"","warning",!1)}return t}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.insertButtonCommand",{},{execute:function(){var e=this.controller.getContextInfo(),t=(this.arguments.parent||e.guid,Math.guid()),i=this.createElement({guid:t,type:"formbutton",caption:bizagi.editor.utilities.buildComplexLocalizable(bizagi.localization.getResource("formmodeler-component-editor-newbutton"),t,"caption")});return this.model.addButton(i),this.arguments.guid=i.guid,!0},undo:function(){return this.model.removeElementById(this.arguments.guid),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getElementPropertiesCommand",{},{execute:function(){var e=this.arguments;return bizagi.editor.utilities.isGuidEmpty(e.guid)?this.processMultiselect():this.getElementProperties(e.guid),!0},searchContext:function(e,t){return this.controller.isGridContext()?bizagi.editor.utilities.resolveContextEntityFromXpath(e):t?bizagi.editor.utilities.resolveRelatedEntityFromXpath(e):void 0},getElementProperties:function(e){var t=this.arguments,i=this.model.getElement(e);if(i)if(t.result=bizagi.clone(i.properties),i.properties.xpath)$.extend(t.result,{context:this.searchContext(i.properties.xpath,t.getContext)});else if(this.controller.isGridContext()){var n=this.controller.getContextInfo();t.result=Object.assign(t.result,{context:bizagi.editor.utilities.resolveRelatedEntityFromXpath(n.xpath)})}},processMultiselect:function(){if(this.controller.isGridContext()){var e=this.controller.getGuidsSelected();this.getElementProperties(e[0])}else this.arguments.result=null}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getFormPropertiesModelCommand",{},{execute:function(){var e=this.arguments,t=this.model.getPropertiesModel();if(e.showValidations){var i=this.model.getFormValidations();i&&(t.validations=bizagi.clone(i))}return this.arguments.result=t,!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getPropertiesModelCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(e.guid),i=this.getPropertiesModel(t);if(e.showValidations){var n=t.getFormValidations();n&&(i.validations=bizagi.clone(n))}return this.arguments.result=i,!0},getPropertiesModel:function(e){var t,i;return t=e.getPropertiesModel(),t=this.resolveDependencies(t),i=e.getPropertiesExternal(),$.extend(t,i),t},resolveDependencies:function(e){var t;if(e.elements.length>1)throw"No code for this case";return t=e.elements[0].tabs,this.map={},this.generateElementMap(t,""),this.resolveAllDependencies(e),this.resolveSpecificDependencies(e),e},generateElementMap:function(e,t){var i,n,o,r,a,s,l;for(l=this.map,s=0;s<e.length;s++)r="",void 0!==e[s].property?r=void 0!==(i=e[s].property).subproperties?"(property.subproperties)":"(property)":void 0!==e[s].group?(i=e[s].group,r="(group.elements)"):void 0!==e[s].category?(i=e[s].category,r="(category)"):(i=e[s],r="(elements)"),o=t+""+s+r,void 0!==i.name&&void 0!==i["bas-type"]&&(void 0!==i.subproperties?(a=t+""+s+"(property)",l[i.name]=a):l[i.name]=o),void 0!==(n=void 0!==i.elements?i.elements:void 0!==i.subproperties?i.subproperties:void 0)&&$.isArray(n)&&n.length>0&&this.generateElementMap(n,o)},resolveAllDependencies:function(e){var t,i,n,o,r,a,s;for(o=(t=e.elements[0].tabs).length,a=0;a<o;a++)for(r=(i=t[a]).elements.length,s=0;s<r;s++)void 0!==(n=i.elements[s].property)&&this.resolveEditorParametersRule(n,e)},resolveEditorParametersRule:function(e,t){var i,n,o,r,a;if(void 0!==e["editor-parameters"])for(i in n=e["editor-parameters"])n[i]&&void 0!==n[i].rule&&-1!=(o=n[i].rule).search(/^<.*>$/)&&(r=(o=o.substring(1,o.length-1)).split(":")).length>1&&"design"==r[0]&&(a=r[1],void 0===r[2]&&this.updateDependency(e.name,a,"editorParameters",t))},processRules:function(e,t){bizagi.editor.component.properties.processrules(e,t,this.map)},updateDependency:function(e,t,i,n){var o=this.getMapAttribute(t,"value",n);if(void 0!==o)if(!1===o||"false"==o)o=!1;else{if(!0!==o&&"true"!=o)throw"value is "+o;o=!0}this.setMapAttributeEditorParameter(e,t,o,n)},surfModel:function(e,t,i){var n,o=void 0;if((n=e.split(".")).length>1)switch(n[0]){case"group":"elements"==n[1]&&(o=i[t][n[0]][n[1]]);break;case"property":"subproperties"==n[1]&&(o=i[t][n[0]][n[1]])}else switch(e){case"elements":o=i.elements[0].tabs[t][e];break;case"property":o=i[t][e]}return o},setMapAttributeWithChangeProperty:function(e,t,i,n){this.setMapAttribute(e,t,i,n),this.controller.executeCommand({command:"changeProperty",guid:n.idRender,property:e,value:i,canUndo:!1})},setMapAttribute:function(e,t,i,n){var o;if(!(o=this.getPropertyFromMap(e,n)))throw"Error with the reference (set)";o[t]=i},getMapAttribute:function(e,t,i){var n;if(!(n=this.getPropertyFromMap(e,i)))throw"Error with the reference (get)";return n[t]},getPropertyFromMap:function(e,t){var i,n,o=this.map[e],r=o.match(/\d+/g),a=o.match(/\(([a-z]+|\.)+\)/g),s=t;for(i=0;i<r.length&&i<a.length;i++)n=a[i].substring(1,a[i].length-1),s=this.surfModel(n,r[i],s);return s},setMapAttributeEditorParameter:function(e,t,i,n){var o;if(!(o=this.getPropertyFromMap(e,n)))throw"Error with the reference for editor parameter (set)";o["editor-parameters"][t].value=i},resolveSpecificDependencies:function(e){var t=this;t.resolveDatalistSubproperties(e),t.resolveDependenciesFromXpathForCombos(e),t.resolveDependenciesFromXpathForSearch(e),t.resolveDependenciesFromXpathForGrid(e);var i=t.getRenderType(e);"grid"!==i&&"smartphonegrid"!==i&&"tabletgrid"!==i||t.updateFormsProperties(e),"groupedgrid"===i&&t.updateGroupedGridProperties(e),"offlinegrid"===i&&t.updateOfflineGridProperties(e),"collectionnavigator"===i&&t.updateCollectionNavigatorProperties(e),"text"!==i&&"columntext"!==i&&"adhoctext"!==i&&"smartphonetext"!==i&&"smartphonecolumntext"!==i&&"tablettext"!==i&&"tabletcolumntext"!==i||t.updateText(e),"actionlauncher"!==i&&"smartphoneactionlauncher"!==i&&"tabletactionlauncher"!==i||t.updateActionLauncher(e),"entitytemplate"!==i&&"smartphoneentitytemplate"!==i&&"tabletentitytemplate"!==i||t.updateEntityTemplate(e),t.updateDecimalsForNumbers(e),t.updateMultipleSearch(e),t.resolveDocumentTemplatesButtonsVisibilityByAllowgenerate(e),t.resolveBindingButtonVisibility(e),t.resolveGroupProperties(e)},resolveDatalistSubproperties:function(e){var t,i,n,o,r=this.map;if(void 0!==r.xpath&&void 0!==r.data)if(null!==(t=this.getMapAttribute("xpath","value",e))&&"object"==typeof t)for(this.hasMapProperty("data","notShow",e)&&this.deleteMarkNotShow("data",e),i=this.getMapAttribute("data","subproperties",e),o=0;o<i.length;o++)n=i[o].property,this.resolveDatalistSubpropertiesRule(n,t,e);else this.insertMarkNotShow("data",e)},resolveDependenciesFromXpathForCombos:function(e){var t,i=this;i.areThesePropertiesInMap(["xpath","data.displayattrib","data.additionalattrib","data.sortattribute","data.filter"])&&(null!==(t=i.getMapAttribute("xpath","value",e))&&"object"==typeof t?(i.deleteMarkNotShow("data.displayattrib",e),i.deleteMarkNotShow("data.additionalattrib",e),i.deleteMarkNotShow("data.sortattribute",e),i.deleteMarkNotShow("data.filter",e)):(i.insertMarkNotShow("data.displayattrib",e),i.insertMarkNotShow("data.additionalattrib",e),i.insertMarkNotShow("data.sortattribute",e),i.insertMarkNotShow("data.filter",e)))},resolveDependenciesFromXpathForSearch:function(e){var t;this.areThesePropertiesInMap(["xpath","searchforms","data.displayattrib","data.filter"])&&(null!==(t=this.getMapAttribute("xpath","value",e))&&"object"==typeof t?(this.deleteMarkNotShow("data.displayattrib",e),this.deleteMarkNotShow("data.filter",e)):(this.insertMarkNotShow("data.displayattrib",e),this.insertMarkNotShow("data.filter",e)))},resolveDependenciesFromXpathForGrid:function(e){var t,i=this;if(i.areThesePropertiesInMap(["xpath","gridvalidations","data.sortattribute","data.filter"]))if(null!==(t=i.getMapAttribute("xpath","value",e))&&"object"==typeof t){if(i.deleteMarkNotShow("data.sortattribute",e),i.deleteMarkNotShow("data.filter",e),i.areThesePropertiesInMap(["data.sortattribute","data.sortorder"])){var n=i.getMapAttribute("data.sortattribute","value",e);null!==n&&"object"==typeof n?i.deleteMarkNotShow("data.sortorder",e):i.insertMarkNotShow("data.sortorder",e)}}else i.insertMarkNotShow("data.sortattribute",e),i.insertMarkNotShow("data.filter",e),i.areThesePropertiesInMap(["data.sortattribute","data.sortorder"])&&i.insertMarkNotShow("data.sortorder",e)},resolveDocumentTemplatesButtonsVisibilityByAllowgenerate:function(e){if(this.areThesePropertiesInMap(["validate","allowgenerate"])){var t=this.getMapAttribute("allowgenerate","value",e);t&&this.hasMapProperty("validate","notShow",e)?this.deleteMarkNotShow("validate",e):t||(this.insertMarkNotShow("validate",e),this.setMapAttributeWithChangeProperty("validate","value",!1,e))}},resolveBindingButtonVisibility:function(e){var t;this.map;this.areThesePropertiesInMap(["xpath","groupmapping"])&&(null!==(t=this.getMapAttribute("xpath","value",e))&&"object"==typeof t?this.hasMapProperty("groupmapping","notShow",e)&&this.deleteMarkNotShow("groupmapping",e):this.insertMarkNotShow("groupmapping",e))},deleteMarkNotShow:function(e,t){this.setMapAttribute(e,"notShow",void 0,t)},insertMarkNotShow:function(e,t){this.setMapAttribute(e,"notShow",!0,t)},resolveDatalistSubpropertiesRule:function(e,t,i){var n;"true"==e["user-editable"]&&null!==e.value&&"string"==typeof e.value&&-1!=e.value.search(/^<.*>$/)&&"design"==(n=e.value.substring(1,e.value.length-1).split(":"))[0]&&"xpath"==n[1]&&"relatedentity"==n[2]&&this.updateValueMapForSubproperty(e.name,t,i)},hasMapProperty:function(e,t,i){return void 0!==this.getPropertyFromMap(e,i)[t]},updateValueMapForSubproperty:function(e,t,i){this.setMapAttribute(e,"value",t,i)},updateMultipleSearch:function(e,t){var i;this.areThesePropertiesInMap(["newrecords"])&&(i=this.getMapAttribute("newrecords","value",e),this.isFalsifiable(i.allownew)?this.insertMarkNotShow("newrecords.allownewform",e):this.deleteMarkNotShow("newrecords.allownewform",e))},isFalsifiable:function(e){var t=!1;return null==e||!1===e||"false"==e?t=!0:!0!==e&&"true"!=e||(t=!1),t},updateDecimalsForNumbers:function(e){var t;this.areThesePropertiesInMap(["allowdecimals","numdecimals"])&&(t=this.getMapAttribute("allowdecimals","value",e),this.isFalsifiable(t)?this.insertMarkNotShow("numdecimals",e):this.deleteMarkNotShow("numdecimals",e))},setMapAttributesWithChangeMultipleProperties:function(e,t){var i;for(i=0;i<e.length;i++)this.setMapAttribute(e[i].property,"value",e[i].value,t);this.controller.executeCommand({command:"changeMultipleProperties",properties:e,guid:t.idRender})},updateInlineaddAndWithform:function(e){var t=this;void 0===t.controller.mem?(t.controller.mem={},t.controller.mem[e.idRender]={},t.controller.mem[e.idRender].inlineadd=!t.isFalsifiable(t.getMapAttribute("inlineadd","value",e)),t.controller.mem[e.idRender]["add.withform"]=!t.isFalsifiable(t.getMapAttribute("add.withform","value",e))):void 0===t.controller.mem[e.idRender]&&(t.controller.mem[e.idRender]={},t.controller.mem[e.idRender].inlineadd=!t.isFalsifiable(t.getMapAttribute("inlineadd","value",e)),t.controller.mem[e.idRender]["add.withform"]=!t.isFalsifiable(t.getMapAttribute("add.withform","value",e))),void 0!==t.controller.mem[e.idRender]&&(t.isFalsifiable(t.getMapAttribute("inlineadd","value",e))!=t.isFalsifiable(t.controller.mem[e.idRender].inlineadd)?t.isFalsifiable(t.getMapAttribute("inlineadd","value",e))?(t.setMapAttributesWithChangeMultipleProperties([{property:"inlineadd",value:!1},{property:"add.withform",value:!0}],e),t.controller.mem[e.idRender].inlineadd=!1,t.controller.mem[e.idRender]["add.withform"]=!0):(t.setMapAttributesWithChangeMultipleProperties([{property:"inlineadd",value:!0},{property:"add.withform",value:!1}],e),t.controller.mem[e.idRender].inlineadd=!0,t.controller.mem[e.idRender]["add.withform"]=!1):t.isFalsifiable(t.getMapAttribute("add.withform","value",e))?(t.setMapAttributesWithChangeMultipleProperties([{property:"inlineadd",value:!0},{property:"add.withform",value:!1}],e),t.controller.mem[e.idRender].inlineadd=!0,t.controller.mem[e.idRender]["add.withform"]=!1):(t.setMapAttributesWithChangeMultipleProperties([{property:"inlineadd",value:!1},{property:"add.withform",value:!0}],e),t.controller.mem[e.idRender].inlineadd=!1,t.controller.mem[e.idRender]["add.withform"]=!0))},updateFormsProperties:function(e){var t,i=this;if(i.areThesePropertiesInMap(["allowadd","add.addlabel","inlineadd","add.withform","add.addform"])&&(t=i.getMapAttribute("allowadd","value",e),i.isFalsifiable(t)?(i.insertMarkNotShow("add.addlabel",e),i.insertMarkNotShow("inlineadd",e),i.insertMarkNotShow("add.withform",e),i.insertMarkNotShow("add.addform",e),i.insertMarkNotShow("add.validationrule",e),i.setMapAttribute("add.withform","value",!1,e)):(i.deleteMarkNotShow("add.addlabel",e),i.deleteMarkNotShow("inlineadd",e),i.insertMarkNotShow("add.withform",e),i.deleteMarkNotShow("add.addform",e),i.deleteMarkNotShow("add.validationrule",e)),i.updateInlineaddAndWithform(e),i.areThesePropertiesInMap(["add.withform","add.addform"])&&(t=i.getMapAttribute("add.withform","value",e),i.isFalsifiable(t)?(i.insertMarkNotShow("add.addform",e),i.insertMarkNotShow("add.validationrule",e)):i.isFalsifiable(i.getMapAttribute("allowadd","value",e))||(i.deleteMarkNotShow("add.addform",e),i.deleteMarkNotShow("add.validationrule",e)))),i.areThesePropertiesInMap(["delete.allowdelete","delete.deletelabel","delete.validationrule"])&&(t=i.getMapAttribute("delete.allowdelete","value",e),i.isFalsifiable(t)?(i.insertMarkNotShow("delete.deletelabel",e),i.insertMarkNotShow("delete.validationrule",e)):(i.deleteMarkNotShow("delete.deletelabel",e),i.deleteMarkNotShow("delete.validationrule",e))),i.areThesePropertiesInMap(["allowedit","edit.editlabel","edit.editform","edit.validationrule","edit.inlineedit"]))if(t=i.getMapAttribute("allowedit","value",e),i.isFalsifiable(t))i.insertMarkNotShow("edit.editlabel",e),i.insertMarkNotShow("edit.inlineedit",e),i.insertMarkNotShow("edit.withform",e),i.insertMarkNotShow("edit.editform",e),i.insertMarkNotShow("edit.validationrule",e),i.setMapAttributeWithChangeProperty("edit.withform","value","false",e);else{i.deleteMarkNotShow("edit.editlabel",e),i.deleteMarkNotShow("edit.inlineedit",e),i.insertMarkNotShow("edit.withform",e),i.deleteMarkNotShow("edit.editform",e),i.deleteMarkNotShow("edit.validationrule",e);var n=i.getMapAttribute("edit.editform","value",e);i.isFalsifiable(n)||$.isEmptyObject(n)?i.setMapAttributeWithChangeProperty("edit.withform","value","false",e):i.setMapAttributeWithChangeProperty("edit.withform","value","true",e)}i.areThesePropertiesInMap(["allowdetail","detail.detaillabel","detail.detailform"])&&(t=i.getMapAttribute("allowdetail","value",e),i.isFalsifiable(t)?(i.insertMarkNotShow("detail.detaillabel",e),i.insertMarkNotShow("detail.detailform",e)):(i.deleteMarkNotShow("detail.detaillabel",e),i.deleteMarkNotShow("detail.detailform",e))),i.areThesePropertiesInMap(["totalize.operation"])&&(t=i.getMapAttribute("totalize.operation","value",e),bizagi.util.isEmpty(t)?i.insertMarkNotShow("totalize.format",e):i.deleteMarkNotShow("totalize.format",e))},updateOfflineGridProperties:function(e){var t=this;if(t.areThesePropertiesInMap(["add.allowadd","add.addlabel"])){var i=t.getMapAttribute("add.allowadd","value",e);t.isFalsifiable(i)?t.insertMarkNotShow("add.addlabel",e):t.deleteMarkNotShow("add.addlabel",e)}t.areThesePropertiesInMap(["delete.allowdelete","delete.deletelabel"])&&(i=t.getMapAttribute("delete.allowdelete","value",e),t.isFalsifiable(i)?t.insertMarkNotShow("delete.deletelabel",e):t.deleteMarkNotShow("delete.deletelabel",e))},updateCollectionNavigatorProperties:function(e){var t,i=this;if(i.areThesePropertiesInMap(["allowadd","add.inlineadd","add.addform","add.validationrule"])&&(t=i.getMapAttribute("allowadd","value",e),i.isFalsifiable(t)?(i.insertMarkNotShow("add.inlineadd",e),i.insertMarkNotShow("add.addform",e),i.insertMarkNotShow("add.validationrule",e)):(i.deleteMarkNotShow("add.inlineadd",e),i.deleteMarkNotShow("add.addform",e),i.deleteMarkNotShow("add.validationrule",e)),i.isFalsifiable(t)||(t=i.getMapAttribute("add.addform","value",e),i.isFalsifiable(t)?i.insertMarkNotShow("add.validationrule",e):i.deleteMarkNotShow("add.validationrule",e))),i.areThesePropertiesInMap(["allowedit","edit.editform","edit.inlineedit","edit.validationrule"])&&(t=i.getMapAttribute("allowedit","value",e),i.isFalsifiable(t)?(i.insertMarkNotShow("edit.inlineedit",e),i.insertMarkNotShow("edit.editform",e),i.insertMarkNotShow("edit.validationrule",e)):(i.deleteMarkNotShow("edit.inlineedit",e),i.deleteMarkNotShow("edit.editform",e),i.deleteMarkNotShow("edit.validationrule",e)),i.isFalsifiable(t)||(t=i.getMapAttribute("edit.editform","value",e),i.isFalsifiable(t)?i.insertMarkNotShow("edit.validationrule",e):i.deleteMarkNotShow("edit.validationrule",e))),i.areThesePropertiesInMap(["delete.allowdelete","delete.validationrule"])&&(t=i.getMapAttribute("delete.allowdelete","value",e),i.isFalsifiable(t)?i.insertMarkNotShow("delete.validationrule",e):i.deleteMarkNotShow("delete.validationrule",e)),i.areThesePropertiesInMap(["allowdetail","detail.detailform"])&&(t=i.getMapAttribute("allowdetail","value",e),i.isFalsifiable(t)?i.insertMarkNotShow("detail.detailform",e):i.deleteMarkNotShow("detail.detailform",e)),i.areThesePropertiesInMap(["xpath","data.sortattribute","data.filter","data.sortorder"])){var n=i.getMapAttribute("xpath","value",e);null!==n&&"object"==typeof n?(i.deleteMarkNotShow("data.sortattribute",e),i.deleteMarkNotShow("data.filter",e),null!==(t=i.getMapAttribute("data.sortattribute","value",e))&&"object"==typeof t?i.deleteMarkNotShow("data.sortorder",e):i.insertMarkNotShow("data.sortorder",e)):(i.insertMarkNotShow("data.sortattribute",e),i.insertMarkNotShow("data.filter",e),i.insertMarkNotShow("data.sortorder",e))}},updateGroupedGridProperties:function(e){var t,i=this;i.areThesePropertiesInMap(["allowadd","add.addform","add.addlabel","add.validationrule"])&&(t=i.getMapAttribute("allowadd","value",e),i.isFalsifiable(t)?(i.insertMarkNotShow("add.addform",e),i.insertMarkNotShow("add.addlabel",e),i.insertMarkNotShow("add.validationrule",e)):(i.deleteMarkNotShow("add.addform",e),i.deleteMarkNotShow("add.addlabel",e),i.deleteMarkNotShow("add.validationrule",e)),i.isFalsifiable(t)||(t=i.getMapAttribute("add.addform","value",e),i.isFalsifiable(t)?i.insertMarkNotShow("add.validationrule",e):i.deleteMarkNotShow("add.validationrule",e))),i.areThesePropertiesInMap(["allowedit","edit.editform","edit.editlabel","edit.validationrule"])&&(t=i.getMapAttribute("allowedit","value",e),i.isFalsifiable(t)?(i.insertMarkNotShow("edit.editlabel",e),i.insertMarkNotShow("edit.editform",e),i.insertMarkNotShow("edit.validationrule",e)):(i.deleteMarkNotShow("edit.editlabel",e),i.deleteMarkNotShow("edit.editform",e),i.deleteMarkNotShow("edit.validationrule",e)),i.isFalsifiable(t)||(t=i.getMapAttribute("edit.editform","value",e),i.isFalsifiable(t)?i.insertMarkNotShow("edit.validationrule",e):i.deleteMarkNotShow("edit.validationrule",e)))},updateText:function(e){var t;this.areThesePropertiesInMap(["isextended","autoextend"])&&(t=this.getMapAttribute("isextended","value",e),this.isFalsifiable(t)?this.hideProperties(["autoextend"],e):this.showProperties(["autoextend"],e))},updateActionLauncher:function(e){this.areThesePropertiesInMap(["ishorizontal","allowsearch","selecttemplate"])&&(fvalue=this.getMapAttribute("ishorizontal","value",e),fvalue?(this.hideProperties(["allowsearch"],e),this.showProperties(["selecttemplate"],e)):(this.showProperties(["allowsearch"],e),this.hideProperties(["selecttemplate"],e)))},updateEntityTemplate:function(e){var t=this;t.areThesePropertiesInMap(["allowactions","xpathmultiple","filter","maxitems","orientation"])&&(fvalue=t.getMapAttribute("allowactions","value",e),fvalue?(t.showProperties(["xpathmultiple"],e),t.showProperties(["filter"],e),t.showProperties(["maxitems"],e),t.showProperties(["orientation"],e),t.showProperties(["format"],e)):(t.hideProperties(["xpathmultiple"],e),t.hideProperties(["filter"],e),t.hideProperties(["maxitems"],e),t.hideProperties(["orientation"],e),t.hideProperties(["format"],e))),t.areThesePropertiesInMap(["allowactions","xpathmultiple"])&&(!0===t.getMapAttribute("allowactions","value",e)?t.showProperties(["xpathmultiple"],e):t.hideProperties(["xpathmultiple"],e))},resolveGroupProperties:function(e){if(this.areThesePropertiesInMap(["groupby","showcolumn","displaytype"])){var t=this.getMapAttribute("groupby","value",e);this.isFalsifiable(t)?(this.hideProperties(["showcolumn"],e),this.hideProperties(["displaytype"],e)):(this.showProperties(["showcolumn"],e),this.showProperties(["displaytype"],e))}},hideProperties:function(e,t){for(var i=0,n=e.length;i<n;)this.insertMarkNotShow(e[i++],t)},showProperties:function(e,t){for(var i=0,n=e.length;i<n;)this.deleteMarkNotShow(e[i++],t)},areThesePropertiesInMap:function(e){var t,i=this.map,n=!0;for(t=0;t<e.length;t++)if(void 0===i[e[t]]){n=!1;break}return n},getRenderType:function(e){return e.element.type}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.deleteRepeaterItemCommand",{},{execute:function(){var e=this.arguments.guid;if(!e)return!1;var t=this.model.getForm().getLayout();return this.deleteItem(t,e),!0},deleteItem:function(e,t){var i,n=e.properties.html,o=!0,a=n.split("{{/repeater}}"),s=/{{placeholder(:\w*)?(\s*\{"id":"([\w-]+)"\})?/g;for(this.originalHtml=n,this.originalElements={},j=0,r=a.length;j<r;j++){for(var l=a[j].split("{{separator}}"),d=0,c=l.length;d<c;d++){var u=l[d];if(u.indexOf(t)>=0){for(var p=/{{repeater:item}}[\w\W]+{{\/repeater:item}}/g.exec(u)[0];null!==(i=s.exec(p));){var m=i[3];this.originalElements[m]=e.removeElementById(m)}e.properties.html=n.replace(p+"{{separator}}",""),o=!1;break}}if(!o)break}},undo:function(){var e=this.model.getForm().getLayout();for(id in e.properties.html=this.originalHtml,this.originalElements)e.addElement(this.originalElements[id]);return!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.changePropertyCommand",{},{execute:function(){var e=this,t=e.arguments;if($.isArray(t.guids)||"string"!=typeof t.guid||(t.guids=[t.guid]),"template"!==e.controller.getContext()&&!e.checksDependenciesInAV())return!1;e.originalValue||(e.originalValue={});for(var i=0,n=t.guids.length;i<n;i++){var o=t.guids[i],r=e.model.getElement(o);e.originalValue[o]||(e.originalValue=e.originalValue||{},e.property=t.exclusive?r.getExclusiveProperty(t.property):t.property,e.originalValue[o]=r.getProperty(e.property),t.canValidate=!0,r.isLocalizableProperty(t.property)&&(t.value="string"==typeof t.value?e.processLocalizableProperty(r,e.originalValue[o]):e.verifyFormat(t.value,r))),r.assignProperty(t.property,t.value,t.exclusive),e.controller.isAdhocFormContext()&&"displayName"===t.property&&!r.isSaved()&&e.controller.executeCommand({command:"changeProperty",guids:t.guids,property:"xpathAdhoc",value:t.newValue}),"xpath"===t.property&&(e.controller.executeCommand({command:"applyOverridesElement",element:r}),t.refreshProperties=t.refreshProperties||"number"==r.properties.type),t.removeDefaultDisplayName&&r.removeDefaultDisplayName(),r.hasDesignValue(e.arguments.property)&&(e.arguments.refresh=!0)}return e.hasDependencies(t.property)&&(t.refreshProperties=!0),t.validateForm&&(r.isRequiredProperty(t.property)||r.isDependentProperty(t.property))&&(e.controller.executeCommand({command:"formValidations",validations:["RequiredProperties","RequiredDependentProperties","SameXpath","ElementsInContainers"],canRefresh:!1}),t.refreshProperties=!0),!0},undo:function(){for(var e=this.arguments,t=0,i=e.guids.length;t<i;t++){var n=e.guids[t],o=this.model.getElement(n);o.assignProperty(this.property,this.originalValue[n],e.exclusive),"xpath"===e.property&&this.controller.executeCommand({command:"applyOverridesElement",element:o})}return!0},hasDependencies:function(e){return"typedinamic"==e||"allowdinamiclabel"==e||"multipleselection"==e||"allowactions"==e||"selecttemplate"==e||"ishorizontal"==e||"showtime"==e||"dateformat"==e||"rule"==e||"interface"==e||"allowadd"==e||"displayName"==e||"helptext"==e||"allowedit"==e||"allowdecimals"==e||"advancedsearch.advancedsearch"==e||"newrecords.allownew"==e||"userconfirmation.needsuserconfirmation"==e||"format"==e||"allowgenerate"==e||"delete.allowdelete"==e||"add.withform"==e||"allowdetail"==e||"buttonrule.rule"==e||"buttonrule.rule90"==e||"buttonrule.interface"==e||"data.filter"==e||"buttonrule"==e||"add.allowadd"==e||"navigationform"==e||"add.addform"==e||"xpathActions"==e||"inlineadd"==e||"add.withform"==e||"detail.withform"==e||"isextended"==e||"totalize.operation"==e||"edit.editform"==e||"data.sortattribute"==e},processLocalizableProperty:function(e,t){var i,n=this.arguments,o=bizagi.editorLanguage.key;return i="string"==typeof t?bizagi.editor.utilities.buildComplexLocalizable(t,e.guid,n.property):t?$.extend({},this.verifyFormat(t,e)):{i18n:{default:e.getDefaultLocalizableProperty(n.property),languages:{},uri:e.guid.toString()+":"+n.property}},"default"===o?i.i18n.default=n.value:i.i18n.languages[o]=n.value,i},verifyFormat:function(e,t){var i=this.arguments;if(e&&e.i18n&&((!e.i18n.uri||e.i18n.uri.indexOf("undefined")>=0)&&(e.i18n.uri=i.guid+":"+i.property),e.i18n.default&&0!==e.i18n.default.length||(e.i18n.default=t.getDefaultLocalizableProperty(i.property)),e.i18n.languages)){var n={};for(var o in e.i18n.languages)e.i18n.languages[o]&&(n[o]=e.i18n.languages[o]);e.i18n.languages=n}return e},checksDependenciesInAV:function(){var e=this.arguments;if(this.controller.hasEnableCommandsEditor()&&"xpath"===e.property&&!this.resolveResult(this.controller.executeCommand({command:"searchDependencies",guids:e.guids})).result)return!1;return!0}}),bizagi.editor.changePropertyCommand.extend("bizagi.editor.changePropertyCommand",{},{execute:function(){var e=this.arguments,t=e.value,i=e.property;if(this.controller.isTemplateContext()){var n=e.guid||e.guids[0],o=this.element=this.model.getElement(n);if(!o||"hide"==i)return this._super();var r=(o.properties||{}).type||"";if("layoutPlaceholder"==o.type)return this.processLayoutControl(n);if("xpath"==i&&null==t)return r.search(/:image/gi)>=0?this._super():this.processLayoutControl(n)}return this._super()},processLayoutControl:function(e){var t=this.arguments,i=t.property;if(t.refreshProperties=!0,"displayName"==i)this.controller.executeCommand({command:"updateElement",renderType:"label",property:i,value:bizagi.editor.utilities.buildComplexLocalizable(t.value,e,"displayName"),guid:e,canUndo:!1});else if("xpath"==i||"link"==i){var n=this.controller.getXpathNavigatorModel().getNodeByXpath(bizagi.editor.utilities.resolveComplexXpath(t.value)),o=n?n.getRenderType():"layoutPlaceholder";this.controller.executeCommand({command:"updateElement",renderType:o,property:"xpath",value:t.value,guid:e,canUndo:!1})}return!0},undo:function(){var e=this,t=e.arguments,i=t.property,n=t.value;if(e.controller.isTemplateContext()){var o=(e.element.properties||{}).type||"";if("hide"==i)return e._super();if("layoutPlaceholder"==e.element.type&&e.model.replaceElement(e.element.guid,e.element),"xpath"==i&&null==n){if(o.search(/:image/gi)>=0)return e._super();e.model.replaceElement(e.element.guid,e.element)}return!0}return e._super()}}),bizagi.editor.changePropertyCommand.extend("bizagi.editor.changePropertyCommand",{},{execute:function(){var e=this,t=e.arguments,i=t.value,n=t.property,o=t.guid||t.guids[0],r=e.element=e.model.getElement(o);if(!e.controller.isAdhocFormContext())return e._super();if(!e.hasListValues(r.type))return e._super();if(!{displayName:!0,xpathAdhoc:!0}[n])return e._super();if("displayName"===n&&(r.isSaved()||r.properties.draggedProperty))return e._super();"displayName"===n&&(i=(i=bizagi.editor.utilities.getXPathByDisplayName(i)).substr(0,1).toLowerCase()+i.substr(1));var a="xpathAdhoc"===n&&bizagi.editor.utilities.isObject(i)?i.xpath:i;if("string"!=typeof a)return e._super();r.assignProperty("data.datasource",void 0);var s=e.controller.getXpathNavigatorModel().getNodeByXpath(a);return s&&s.renderType===r.type&&(e.datasource=r.resolveProperty("data.datasource"),r.assignProperty("data.datasource",{type:s.entityContext,guid:s.guidRelatedEntity,values:s.predefinedValues})),e._super()},hasListValues:function(e){return"adhoccombo"===e||"adhocsuggest"===e||"adhoccolumncombo"===e},undo:function(){var e=this.arguments;e.property,e.value;return this.element.assignProperty("data.datasource",this.datasource),this._super()}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.changeDesignAttributesCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(e.guid).getIndexedProperties()[e.property];if(t)for(var i in e.attributes)t["editor-parameters"]=t["editor-parameters"]||{},t["editor-parameters"][i]=e.attributes[i]}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.changePropertyElementsCommand",{},{execute:function(){var e=this.arguments,t=e.elements;this.originalValue||(this.originalValue={});for(var i=0,n=t.length;i<n;i++){var o=t[i].guid,r=t[i].property,a=t[i].value,s=this.model.getElement(o);this.originalValue[o]||(this.originalValue[o]={property:r,value:s.getProperty(r)},e.canValidate=!0),s.assignProperty(r,a)}return!0},undo:function(){for(var e in this.originalValue){var t=this.originalValue[e].property,i=this.originalValue[e].value;this.model.getElement(e).assignProperty(t,i)}return!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.insertElementFromControlsNavigatorCommand",{map:{querycascadingcombo:"cascadingcombo",columnsearchlist:"searchlist",multiselect:"searchlist"}},{validateArguments:function(){return void 0!==this.arguments.data&&void 0!==this.arguments.data.name},execute:function(){var e=this,t=e.arguments,i=t.data.name,n=e.normalizeControlType(t.data.name);if(!e.validateArguments())return!1;var o=!1;return e.needsWizard(n)&&(o=!0,e.precondition||(e.precondition=e.controller.publish("showControlWizard",{control:e.Class.map[n]||n,title:bizagi.localization.getResource("bizagi-editor-wizard-title-"+n)}))),$.when(e.precondition).pipe(function(n){return o?void 0===n.success||0==n.success||e.processWizardResult(i,n):(e.insertElement(t,i),!0)})},insertElement:function(e,t){var i=this;e.element||(e.element=i.createElement({type:t}),e.element.isVisualProperty("xpath")&&!i.needsDisplayName(t)||(e.element.properties.displayName=bizagi.editor.utilities.buildComplexLocalizable(e.data.displayName,e.element.guid,"displayName"),"adhocform"==i.model.context&&(e.element.properties.displayName=e.element.properties.displayName.i18n.default)),e.element.properties.displayName=i.validateSameDisplayNameOfElements(e.element.properties.displayName),"adhocform"!=i.model.context&&"adhocgrid"!=i.model.context||i.setXpathAdhoc(e.element),e.canValidate=!0,i.parent=e.parent||i.controller.getContextInfo().guid),i.controller.executeCommand({command:"insertElement",position:e.position,parent:i.parent,element:e.element,canUndo:!1}),i.controller.setLastInsertedElement(e.element.guid)},needsDisplayName:function(e){return"link"===e||"formlink"===e||"columnformlink"===e||"columnlink"===e||""===e},undo:function(){var e=this.arguments,t=this.controller.executeCommand({command:"removeElementById",position:e.position,parent:this.parent,element:e.element,guid:e.element.guid,searchformresult:e.searchformresult,canUndo:!1});return!(t=this.resolveResult(t)).error},needsWizard:function(e){return"cascadingcombo"==e||("association"===e||("querycascadingcombo"===e||("searchlist"===e||("columnsearchlist"===e||"multiselect"===e))))},processWizardResult:function(e,t){var i=this.normalizeControlType(e);return"cascadingcombo"==i?this.processCascadingCombo(e,t):"querycascadingcombo"==i?this.processCascadingCombo(e,t):"association"==i?this.processMultipleRelation(e,t):"searchlist"==i?this.processMultipleRelation(e,t):"columnsearchlist"==i?this.processMultipleRelation(e,t):"multiselect"===i?this.processMultipleRelation(e,t):void 0},processCascadingCombo:function(e,t){var i=this,n=i.arguments,o=n.parent||i.controller.getContextInfo().guid,r=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"getparententities",id:t.guidRelatedEntity,xpath:t.xpath});return $.when(r.processRequest()).pipe(function(r){if(r.length<2){var a=bizagi.localization.getResource("bizagi-editor-form-validation-cascadingcombo");return bizagi.showMessageBox(a,"Bizagi","error",!1),!0}var s,l;return i.cascadingComboElement={},$.each(r,function(r,a){i.cascadingComboElement[r]?n.element=i.cascadingComboElement[r]:(n.element=i.createElement({type:e,xpath:bizagi.editor.utilities.buildComplexXpath(a.xpath,t.contextEntity,!1,a.guid),parentcombo:s,parentrelation:a.parentRelation?bizagi.editor.utilities.buildComplexXpath(a.parentRelation,a.id,!1,a.parentEntity):void 0}),i.cascadingComboElement[r]=n.element),i.controller.executeCommand({command:"insertElement",parent:o,element:n.element,position:n.position+r,canUndo:!1}),null!=l&&l.setProperty("childcombo",n.element.guid),s=n.element.guid,l=i.model.getElement(s)}),!0})},processMultipleRelation:function(e,t){var i=this,n=i.arguments,o=t.model,r=n.parent||i.controller.getContextInfo().guid,a=o.leftxpath,s=bizagi.clone(a),l=s.xpath.baxpath;return l.xpath=l.xpath+"."+o.factxpath,o.xpath=s,o.type=e,$.when(i.getFactNames(o)).pipe(function(){return n.element=i.createElement(o),["searchlist","multiselect"].includes(e)&&(n.element.properties.displayName=bizagi.editor.utilities.buildComplexLocalizable(o.factxpath,n.element.guid,"displayName")),i.controller.executeCommand({command:"insertElement",parent:r,element:n.element,position:n.position,canUndo:!1}),!0})},getFactNames:function(e){var t=e.leftxpath,i=e.leftfactname,n=e.rightxpath,o=e.rightfactname,r=new $.Deferred;return $.when(this.controller.getXpathNavigatorModel({context:t}),this.controller.getXpathNavigatorModel({context:n})).done(function(t,n){var a=t.getNodeByXpath(i);if(e.leftfactname=bizagi.editor.utilities.buildComplexXpath(a.xpath,a.contextScope,a.isScopeAttribute,a.guidRelatedEntity),o){var s=n.getNodeByXpath(o);e.rightfactname=bizagi.editor.utilities.buildComplexXpath(s.xpath,s.contextScope,s.isScopeAttribute,s.guidRelatedEntity)}r.resolve()}),r.promise()},validateSameDisplayNameOfElements:function(e){var t=e,i=this.controller.getContext(),n={};if("adhocform"==i||"adhocgrid"==i){this.model.getMapDisplayNameAdhoc(this.model.form,n);var o=this.controller.getXpathNavigatorModel();$.isArray(o.nodes)&&o.nodes.forEach(function(e){n[bizagi.editor.utilities.getXPathByDisplayName(e.displayName)]=e}),t=this.getDisplayNameAutonumeric(n,e)}return t},convertToLowerPropertiesHash:function(e){for(var t,i=Object.keys(e),n=i.length,o={};n--;)o[(t=i[n]).toLowerCase()]=e[t];return o},getDisplayNameAutonumeric:function(e,t){var i=bizagi.clone(t);if(i=bizagi.editor.utilities.getXPathByDisplayName(i),void 0!==(n=this.convertToLowerPropertiesHash(e))[i.toLowerCase()]){var n=this.getAllHashByDisplayName(n,i);t=t+" "+this.getNextNumberByHash(n).toString()}return t},getAllHashByDisplayName:function(e,t){var i={},n=new RegExp("^("+t.toLowerCase()+")+\\d*$");for(var o in e)n.test(o)&&(i[o]="");return i},getNextNumberByHash:function(e){var t=this.getAllNumbersOfHashes(e);return t=this.sortNumbersAndCombine(t),this.getNextNumberByArrayNumbers(t)},getAllNumbersOfHashes:function(e){var t=[],i=new RegExp("\\d*$");for(var n in e){var o=i.exec(n),r=0;o&&""!==o[0]&&(r=o[0]),t.push(parseInt(r,10))}return t},sortNumbersAndCombine:function(e){var t=e.sort();return t.filter(function(e,i){return t.indexOf(e)==i})},getNextNumberByArrayNumbers:function(e){for(var t=0,i=e.length;t<i;t+=1)if(t!==e[t])return t;return e.length}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.removeElementByIdCommand",{},{execute:function(){var e=this,t=e.arguments;if((e.data=[],e.tabBackup=[],$.isArray(t.guids)||"string"!=typeof t.guid||(t.guids=[t.guid]),"convertTo"!==t.action&&"nestedForm"!==e.type&&e.controller.hasEnableCommandsEditor())&&!e.resolveResult(e.controller.executeCommand({command:"searchDependencies",guids:t.guids})).result)return!1;for(var i=0;i<t.guids.length;i++){var n=e.model.getElement(t.guids[i]);if(n){e.type=e.normalizeControlType(n.type);var o=e.controller.getContextInfo(),r=n.parent?e.model.getElement(n.parent.guid):e.model.getElement(o.guid);t.canValidate=!0,"cascadingcombo"==e.type||"querycascadingcombo"==e.type?e.data.push(e.removeCascadingCombo(n)):e.data.push(e.model.removeElementById(t.guids[i])),"tab"==e.normalizeControlType(r.type)&&0==r.elements.length&&(e.tabBackup.push({parent:r.parent.guid,data:r,guid:r.guid,position:r.position}),e.model.removeElementById(r.guid)),e.removeElementSelected()}}return t.result=e.data,!0},undo:function(){var e=this;if(e.tabBackup.length>0)for(var t=e.tabBackup.length-1;t>=0;t--){e.model.insertElement(e.tabBackup[t].position,e.tabBackup[t].parent,e.tabBackup[t].data);for(var i=e.data.length-1;i>=0;i--)e.model.insertElement(e.data[i].position,e.data[i].parent.guid,e.data[i])}else if($.isArray(e.data))for(t=e.data.length-1;t>=0;t--)e.data[t].entities?e.insertCascadingCombo(t):"formbutton"==e.data[t].type?e.model.addButton(e.data[t]):e.model.insertElement(e.data[t].position,e.data[t].parent.guid,e.data[t]);else"cascadingcombo"==e.type||"querycascadingcombo"==e.type?e.insertCascadingCombo():e.model.insertElement(e.data.position,e.data.parent.guid,e.data);return!0},removeCascadingCombo:function(e){for(var t=e,i=[],n=[],o=0,r={};null!=t.getProperty("parentcombo");){var a=t.getProperty("parentcombo");t=this.model.getElement(a)}for(i.push(t);null!=t.getProperty("childcombo");){var s=t.getProperty("childcombo");t=this.model.getElement(s),i.push(t)}for(var l=0;l<i.length;l++)n.push(this.model.removeElementById(i[l].guid)),0===l?(o=n[l].position,r=n[l].parent):n[l].position<o&&(o=n[l].position);return{position:o,parent:r,entities:n}},insertCascadingCombo:function(e){var t=this;void 0===e?$.each(t.data.entities,function(e,i){t.model.insertElement(t.data.position+e,i.parent.guid,i)}):$.each(t.data[e].entities,function(i,n){t.model.insertElement(t.data[e].position+i,n.parent.guid,n)})},removeElementSelected:function(){this.controller.removeSelectedElement()}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.insertElementFromXpathNavigatorCommand",{columnRenderMapping:{boolean:"columnboolean",button:"columnbutton",text:"columntext",number:"columnnumber",money:"columnmoney",date:"columndate",document:"columnDocument",combo:"columncombo",cascadingCombo:"columncombo",list:"columnlist",search:"columnsearch",formlink:"columnformlink",hidden:"columnhidden",label:"columnlabel",link:"columnlink",radio:"columnradio",upload:"columnupload",image:"columnimage",uploadecm:"columnuploadecm",letter:"columnletter"},offlineColumnRenderMapping:{boolean:"offlinecolumnboolean",text:"offlinecolumntext",number:"offlinecolumnnumber",money:"offlinecolumnmoney",date:"offlinecolumndate",combo:"offlinecolumncombo",radio:"offlinecolumnradio",search:"offlinecolumnsuggest"},offlineSmartphoneColumnRenderMapping:{boolean:"offlinesmartphonecolumnboolean",text:"offlinesmartphonecolumntext",number:"offlinesmartphonecolumnnumber",money:"offlinesmartphonecolumnmoney",date:"offlinesmartphonecolumndate",combo:"offlinesmartphonecolumncombo",radio:"offlinesmartphonecolumnradio",search:"offlinesmartphonecolumnsuggest"},offlineTabletColumnRenderMapping:{boolean:"offlinetabletcolumnboolean",text:"offlinetabletcolumntext",number:"offlinetabletcolumnnumber",money:"offlinetabletcolumnmoney",date:"offlinetabletcolumndate",combo:"offlinetabletcolumncombo",radio:"offlinetabletcolumnradio",search:"offlinetabletcolumnsuggest"},offlineFormRenderMapping:{boolean:"offlineboolean",text:"offlinetext",number:"offlinenumber",money:"offlinemoney",date:"offlinedate",combo:"offlinecombo",cascadingCombo:"offlinecombo",list:"offlinecombo",radio:"offlinecombo",search:"offlinesuggest",grid:"offlinegrid",image:"offlineimage",upload:"offlineupload",nestedform:"nestedform"},offlineSmartphoneFormRenderMapping:{boolean:"offlinesmartphoneboolean",text:"offlinesmartphonetext",number:"offlinesmartphonenumber",money:"offlinesmartphonemoney",date:"offlinesmartphonedate",combo:"offlinesmartphonecombo",cascadingCombo:"offlinesmartphonecombo",list:"offlinesmartphonecombo",radio:"offlinesmartphonecombo",search:"offlinesmartphonesuggest",grid:"offlinesmartphonegrid",image:"offlinesmartphoneimage",upload:"offlinesmartphoneupload",nestedform:"nestedform"},offlineTabletFormRenderMapping:{boolean:"offlinetabletboolean",text:"offlinetablettext",number:"offlinetabletnumber",money:"offlinetabletmoney",date:"offlinetabletdate",combo:"offlinetabletcombo",cascadingCombo:"offlinetabletcombo",list:"offlinetabletcombo",radio:"offlinetabletcombo",search:"offlinetabletsuggest",grid:"offlinetabletgrid",image:"offlinetabletimage",upload:"offlinetabletupload",nestedform:"nestedform"},searchFormRenderMapping:{boolean:"searchboolean",text:"searchtext",number:"searchnumber",money:"searchmoney",date:"searchdate",combo:"searchcombo",cascadingCombo:"searchcombo",list:"searchcombo",radio:"searchcombo",search:"searchsuggest"},searchFormResultRenderMapping:{boolean:"columnResultBoolean",text:"columnResultText",number:"columnResultNumber",money:"columnResultMoney",date:"columnResultDate",combo:"columnResultText",cascadingCombo:"columnResultText",list:"columnResultText",radio:"columnResultText",search:"columnResultText"},queryFormRenderMapping:{boolean:"queryboolean",text:"querytext",number:"querynumber",money:"querymoney",date:"querydate",combo:"querycombo",list:"querylist",cascadingCombo:"querycascadingcombo",radio:"queryradio",search:"querycombo",application:"queryapplication",process:"queryprocess",creatorfullname:"querycreatorfullname",creatorposition:"querycreatorposition",creatorusername:"querycreatorusername",currentuser:"queryusercurrentuser",currentuserfullname:"queryuserfullname",currentuserusername:"queryuserusername",currentuserposition:"queryuserposition",previoususer:"queryuserprevioususer",previoususerfullname:"queryprevioususerfullname",previoususerusername:"queryprevioususerusername",previoususerposition:"queryprevioususerposition",currenttask:"querytaskcurrenttask",previoustask:"querytaskprevioustask",taskentrydate:"querytaskentrydate",taskexpirydate:"querytaskexpirydate",taskstate:"querytaskstate",casecreationdate:"querycasecreationdate",casecreator:"querycasecreator",caseid:"querycaseid",casenumber:"querycasenumber",casesolutiondate:"querycasesolutiondate",casestate:"querycasestate",nestedform:"nestedform"},propertiesOverrides:{float:{allowdecimals:"true"}}},{execute:function(){var e=this;e.arguments;if(void 0===e.element){var t=e.createElementData();if(!t.type)return e.arguments.canUndo=!1,!0;e.arguments.canValidate=!0;var i=e.createElement(t);e.element=i,e.parent=e.arguments.parent||e.controller.getContextInfo().guid}return e.controller.executeCommand({command:"insertElement",position:e.arguments.position,parent:e.parent,element:e.element,searchformresult:e.arguments.searchformresult,canUndo:!1}),!0},undo:function(){var e=this.controller.executeCommand({command:"removeElementById",position:this.arguments.position,parent:this.parent,element:this.element,guid:this.element.guid,searchformresult:this.arguments.searchformresult,canUndo:!1});return!(e=this.resolveResult(e)).error},createElementData:function(){var e=this,t=e.arguments,i={},n=bizagi.editor.base.constants.DEVICES;return i.type=e[function(){if(e.controller.isSpecificForm()){if(e.controller.isOfflineContext())switch(e.controller.getDeviceType()){case n.OFFLINE:return"resolveOfflineType";case n.OFFLINE_SMARTPHONE:return"resolveOfflineSmartphoneType";case n.OFFLINE_TABLET:return"resolveOfflineTabletType"}return"resolve"+e.controller.getCurrentDevice()+"Type"}return"resolveDesktopType"}()](),"adhocform"==t.data.context||"adhocgrid"==t.data.context?(i.xpathAdhoc={xpath:t.data.xpath.xpath.baxpath.xpath,relatedEntity:t.data.parent?t.data.parent.guidRelatedEntity:null},i.draggedProperty=!0,i.displayName=t.data.displayName?t.data.displayName:t.data.name,t.data.guidRelatedEntity?i.data={datasource:{guid:t.data.guidRelatedEntity,type:t.data.entityContext}}:i.data={datasource:{type:t.data.entityContext}},t.data.predefinedValues&&(i.data.datasource.values=t.data.predefinedValues)):i.xpath=t.data.xpath,i.renderType=t.data.nodeSubtype,e.controller.isQueryFormContext()&&e.isColumn()&&(i.selectable=!1),"nestedform"===t.data.renderType&&(i.form=bizagi.editor.utilities.buildComplexReference(t.data.guid),i.displayName=t.data.displayName),i.renderType&&e.Class.propertiesOverrides[i.renderType]&&(i=$.extend(i,e.Class.propertiesOverrides[i.renderType])),i},isColumn:function(){var e=this.arguments,t=this.controller.getXpathNavigatorModel(),i=bizagi.editor.utilities.resolveComplexXpath(e.data.xpath),n=t.getNodeByXpath(i);return!!n&&n.parentIsGrid()},resolveOfflineType:function(){var e=this.arguments,t=this.controller.getContext(),i=e.data.renderType;if(i="offlinegrid"==t?this.Class.offlineColumnRenderMapping[i]:this.Class.offlineFormRenderMapping[i])switch(i){case"nestedform":return"nestedform";default:return i}},resolveOfflineSmartphoneType:function(){var e=this.arguments,t=this.controller.getContext(),i=e.data.renderType;if(i="offlinegrid"==t?this.Class.offlineSmartphoneColumnRenderMapping[i]:this.Class.offlineSmartphoneFormRenderMapping[i])switch(i){case"nestedform":return"nestedform";default:return i}},resolveOfflineTabletType:function(){var e=this.arguments,t=this.controller.getContext(),i=e.data.renderType;if(i="offlinegrid"==t?this.Class.offlineTabletColumnRenderMapping[i]:this.Class.offlineTabletFormRenderMapping[i])switch(i){case"nestedform":return"nestedform";default:return i}},resolveDesktopType:function(){var e=this,t=e.controller.getContext();return"form"==t||"startform"==t?"form"===e.arguments.data.renderType?"nestedform":e.arguments.data.renderType:"grid"==t?this.Class.columnRenderMapping[e.arguments.data.renderType]:"offlinegrid"==t?this.Class.offlineColumnRenderMapping[e.arguments.data.renderType]:"searchform"==t?e.arguments.searchformresult?this.Class.searchFormResultRenderMapping[e.arguments.data.renderType]:this.Class.searchFormRenderMapping[e.arguments.data.renderType]:"offlineform"==t?this.Class.offlineFormRenderMapping[e.arguments.data.renderType]:"queryform"==t?this.Class.queryFormRenderMapping[e.arguments.data.renderType]:"adhocform"==t||"adhocgrid"==t?e.arguments.data.renderType:null},resolveSmartphoneType:function(){var e=this.arguments,t=this.arguments.data.renderType,i=this.controller.getContext();if("grid"===i)t=this.Class.columnRenderMapping[t];else if("searchform"==i)t=e.searchformresult?this.Class.searchFormResultRenderMapping[t]:this.Class.searchFormRenderMapping[t];else if("offlineform"==i&&(t=this.Class.offlineFormRenderMapping[this.arguments.data.renderType]))switch(t){case"nestedform":return"nestedform";default:return"offline"+t}if(t)switch(t){case"nestedform":return"nestedform";default:return"smartphone"+t}},resolveTabletType:function(){var e=this.arguments,t=this.arguments.data.renderType,i=this.controller.getContext();if("grid"===i?t=this.Class.columnRenderMapping[t]:"searchform"==i&&(t=e.searchformresult?this.Class.searchFormResultRenderMapping[t]:this.Class.searchFormRenderMapping[t]),t)switch(t){case"nestedform":return"nestedform";default:return"tablet"+t}}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.loadModelCommand",{},{execute:function(){var e=this.arguments,t=e.dataModel;return e.resources&&(e.refresh=!0,this.model.setResources({Resources:e.resources})),this.model.loadModel(this.controller.getContext(),t,e.mustRegenerateGuids),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.saveModelCommand",{},{execute:function(){var e=this.arguments;e.dataModel;this.model.updateSubmitVersionProperty(),e.dataModel=this.model.saveModel(),e.changeset=this.model.getChangeset(),e.idForm=e.changeset.changeSet[0].id,e.parentId=e.changeset.changeSet[0].parentId;var t=e.changeset.changeSet[0].deployOnParent,i={dataModel:e.dataModel,changeset:e.changeset,idForm:e.idForm,deployOnParent:t,parentId:e.parentId};return i=this.controller.isAdhocFormContext()?e.dataModel:i,e.result=i,!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.createAndInsertControlLayoutInModelCommand",{},{execute:function(){var e=this.arguments;if(void 0===this.layout){var t=this.controller.getLayoutNavigatorModel().findControlById(e.id);"object"==typeof t&&(this.layout=this.model.createLayoutElement(t))}return this.controller.executeCommand({command:"insertElement",position:this.arguments.position,parent:this.arguments.parent,element:this.layout,canUndo:!1}),!0},undo:function(){return this.controller.executeCommand({command:"removeElement",position:this.arguments.position,parent:this.arguments.parent,element:this.layout,canUndo:!1}),!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.changeMultiplePropertiesCommand",{},{execute:function(){var e=this.arguments,t=!1;e.canValidate=!0,$.isArray(e.guids)||"string"!=typeof e.guid||(e.guids=[e.guid]),this.originalValues||(this.originalValues={});for(var i=0,n=e.guids.length;i<n;i++){var o=e.guids[i],r=this.model.getElement(o);if(!this.originalValues[o]){this.originalValues[o]=[];for(var a=0,s=e.properties.length;a<s;a+=1){var l=e.properties[a].property;this.originalValues[o].push({property:l,value:r.getProperty(l)})}}for(a=0,s=e.properties.length;a<s;a+=1){l=e.properties[a].property;var d=e.properties[a].value;r.assignProperty(l,d,e.exclusive),t=r.hasDesignValue(l)||t}}return t&&(this.arguments.refresh=!0),!0},undo:function(){for(var e=this.arguments,t=0,i=e.guids.length;t<i;t++){var n=e.guids[t],o=this.model.getElement(n);for(var r in this.originalValues)for(var a=0,s=this.originalValues[r].length;a<s;a++){var l=this.originalValues[r][a].property,d=this.originalValues[r][a].value;o.assignProperty(l,d,e.exclusive)}}return!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.changeContextCommand",{},{canUndo:function(){return!1},execute:function(){var e=this.arguments,t=e.guid?this.model.getElement(e.guid):null,i=t&&t.properties.xpath?t.properties.xpath:/grid/.test(e.context)?"none":null,n={context:e.context,guid:e.guid};return"adhocgrid"===e.context?n.xpathAdhoc=t.properties.xpathAdhoc.xpath:n.xpath=i,this.controller.changeContext(n),!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.addControlLayoutInModelCommand",{},{execute:function(){var e=this.arguments;if(void 0===this.layout){var t=this.controller.getLayoutNavigatorModel().findControlById(e.id);"object"==typeof t&&(this.layout=this.model.createLayoutElement(t))}return this.model.addElement(this.layout),!0},undo:function(){return this.model.removeLastElement(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getGridColumnModelCommand",{},{execute:function(){var e=$.Deferred(),t=this.model.getElement(this.arguments.guid);return $.when(t.getGridColumnModel()).done(function(t){e.resolve(t)}),this.arguments.result=e.promise(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getSearchResultModelCommand",{},{execute:function(){var e=$.Deferred();if(!this.controller.isSearchFormContext())throw"bizagi.editor.getSearchResultModelCommand - To use this command you must be in the searchform context";return $.when(this.model.getSearchResultRenderingModel()).done(function(t){e.resolve({model:bizagi.clone(t.result),resultValidations:t.resultValidations})}),this.arguments.result=e.promise(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getButtonModelCommand",{},{execute:function(){$.Deferred();if(!this.controller.isActivityForm())throw"bizagi.editor.getButtonModelCommand - To use this command you must use an activity form";return this.arguments.result=$.when(this.model.getButtonRenderingModel()),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getXpathEditorModelCommand",{},{execute:function(){var e=this,t=e.arguments,i=this.model.getElement(this.arguments.guid),n=new $.Deferred,o=e.controller.isGridContext()?e.controller.getXpathNavigatorModelGrid():e.controller.getXpathNavigatorModel();return $.when(o).done(function(r){if("adhocform"!=o.context&&"adhocgrid"!=e.controller.context){var a=i.properties.xpath,s=r.getNodeByXpath(bizagi.editor.utilities.resolveComplexXpath(a));if(s&&bizagi.util.parseBoolean(s.isScopeAttribute)){s.setScopeAttribute("false");var l=r.getSubModel(a);s.setScopeAttribute("true")}else l=r.getSubModel(a)}else{var d=e.resolveEditorParameter(t.editorParameters.entity,i);if(t.editorParameters.entityContext){var c=e.resolveEditorParameter(t.editorParameters.entityContext,i);l=r.getSubModelByEntity(d,c)}else l=r.getSubModelByEntity(d)}n.resolve(l)}),t.result=n.promise(),!0},resolveEditorParameter:function(parameter,element){var t=element;return parameter=parameter.substring(1,parameter.length-1),parts=parameter.split(":"),parts.shift(),eval("t.properties."+parts.join("."))}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.insertTabItemCommand",{},{execute:function(){var e=this,t=e.arguments,i=e.model.getElement(e.arguments.tab);e.arguments.position=i.elements.length;var n=bizagi.editor.base.constants.DEVICES;e.arguments.canValidate=!0;var o="tabitem";if(e.controller.isAdhocFormContext())o="adhoctabitem";else if(e.controller.isOfflineFormContext())switch(e.controller.getDeviceType()){case n.OFFLINE:o="offlinetabitem";break;case n.OFFLINE_SMARTPHONE:o="offlinesmartphonetabitem";break;case n.OFFLINE_TABLET:o="offlinetablettabitem"}else if(e.controller.isSpecificForm())switch(e.controller.getCurrentDevice()){case"Smartphone":o="smartphonetabitem";break;case"Tablet":o="tablettabitem"}var r="Tab "+(i.elements.length+1),a=e.createElement({type:o,displayName:r});return e.controller.isAdhocFormContext()||(a.properties.displayName=bizagi.editor.utilities.buildComplexLocalizable(r,a.guid,"displayName")),i.addElement(a),t.result=a,!0},undo:function(){return this.model.removeElement(this.arguments.position,this.arguments.tab),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.updateModelCommand",{},{execute:function(){var e=this.arguments,t=new $.Deferred;return"OpenNestedForm"===e.data.actiontype?t.resolve(this.processNestedFormAction()):"CreateForm"===e.data.actiontype?this.processCreateFormAction().then(function(e){t.resolve(e)}):"CreateFormFromXpath"===e.data.actiontype?t.resolve(this.processCreateFormFromXpathAction()):"ShowForm"===e.data.actiontype?t.resolve(this.processShowForm()):"OpenWizardTemplates"===e.data.actiontype?t.resolve(this.processWizardTemplates()):"OpenForm"===e.data.actiontype&&t.resolve(this.processOpenForm()),e.result=t.promise(),!0},processNestedFormAction:function(){var e=this.arguments,t=(e.data.json,e.data.guidrender);t&&this.model.getElement(t).initilizeData();return{action:e.data.actiontype}},findElementInModel:function(e){return this.model.getElement(e)},processData:function(e,t){var i=this,n=[];return e.elements&&$.each(e.elements,function(e,o){var r=i.model.createElement(o.type,o);r.setParent(t),n.push(r)}),n},processWizardTemplates:function(){var e=this.arguments.data,t=e.propertyName,i=e.guidControl,n=bizagi.editor.utilities.buildComplexReference(e.guidTemplate);return this.model.changeProperty(i,t,n),this.model.changeProperty(i,"templatetype","template"),{action:e.actiontype,guid:i}},processOpenForm:function(){var e=this.arguments.data||{},t="searchform"===e.context,i=bizagi.editor.utilities.buildComplexReference(e.idform);return i=t?[i]:i,this.model.changeProperty(e.renderId,e.propertyname,i),{action:e.actiontype,guid:e.renderId}},processCreateFormAction:function(){var e=this,t=e.arguments.data||{};return new Promise(function(i,n){var o="searchform"===t.context,r=o?"processAddEntitySearchForm":"processAddEntityForm";e.controller.publish(r,{guid:t.idform}).then(function(n){var r=n.guid,a=t.propertyname,s=t.guidrender;r=bizagi.editor.utilities.buildComplexReference(r),r=o?[r]:r,e.model.changeProperty(s,a,r),bizagi.util.parseBoolean(t.showForm)&&e.processShowForm(),i({action:t.actiontype,guid:t.guidrender})})})},processCreateFormFromXpathAction:function(){var e=this.arguments;return{action:e.data.actiontype,idNode:e.data.guidForm}},processShowForm:function(){var e=this.arguments,t=e.data,i=this.model.getElement(t.guidrender);return e.refresh=!0,i.loadForm(),{action:t.actiontype}}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.updateElementCommand",{renderLayout:{string:"layoutText",collection:"layoutLink",label:"layoutLabel",number:"layoutNumber",float:"layoutNumber",currency:"layoutMoney",date:"layoutDateTime",image:"layoutImage",collection:"layoutLink","entity-parametric":"layoutLink","entity-master":"layoutLink","entity-system":"layoutLink","entity-stakeholder":"layoutLink",boolean:"layoutBoolean",layoutPlaceholder:"layoutPlaceholder",attachment:"layoutUpload"}},{execute:function(){var e=this,t=e.arguments,i=(t.renderType,t.guid),n=e.model.getForm().getLayout(),o=e.createLayoutElement(),r=e.element=e.model.getElement(i);return e.originalHtml||(e.originalHtml=n.properties.html,e.repeaters=bizagi.clone(n.repeaters)),!!e.canReplaceElement(r)&&(e.setProperties(o,r),e.model.replaceElement(i,o),!0)},createLayoutElement:function(){var e=this.arguments,t=(e.property,e.renderType),i=e.guid,n=this.Class.renderLayout[t],o={guid:i,properties:{rendertype:t}};return o.properties[e.property]=e.value,this.model.createElement(n,o)},canReplaceElement:function(e){var t=this.arguments,i=t.toInitialState,n=t.renderType;return!e||(!!i||(":image"!=e.properties.type||"image"==n))},setProperties:function(e,t){var i=this.arguments,n=i.toInitialState;i.guid;if(!n){var o=e.designValueProperties;for(property in o)property!=i.property&&t.designValueProperties[property]&&e.assignProperty(property,t.getProperty(property))}t.properties.type&&e.assignProperty("type",t.getProperty("type")),e.assignProperty("hide",!1)},undo:function(){var e=this.arguments.guid,t=this.model.getForm().getLayout(),i=t.repeaters;for(var n in t.properties.html=this.originalHtml,this.model.replaceElement(e,this.element),i)if(!bizagi.editor.utilities.objectEquals(i[n].elements,this.repeaters[n].elements)){for(var o in i[n].elements)this.model.removeElementById(o);i[n].elements=this.repeaters[n].elements}return!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.replaceAndRestoreElementCommand",{},{execute:function(){var e=this,t=e.arguments,i=t.sourceGuid;e.originalSourceElement=e.model.getElement(i),e.originalTargetElement=e.model.getElement(t.guid);var n=e.originalSourceElement.properties||{},o=e.originalTargetElement.properties||{};return!(e.isImageControl(o.type)&&!e.isImageControl(n.type))&&("layoutPlaceholder"!=e.originalSourceElement.type&&(e.restoreSourceElement(i),e.replaceTargetElement(),!0))},restoreSourceElement:function(e){var t=this.originalSourceElement.properties;if(!(t.type.search(/image/gi)>=0)){var i={guid:e,properties:{rendertype:"layoutPlaceholder",type:t.type}},n=this.model.createElement("layoutPlaceholder",i);this.model.replaceElement(e,n)}},replaceTargetElement:function(){var e=this.arguments,t=bizagi.clone(this.originalSourceElement.properties),i=(t.type,this.originalTargetElement.properties.type,e.guid),n={guid:i,properties:$.extend(t,{type:this.originalTargetElement.properties.type})},o=this.model.createElement(this.originalSourceElement.type,n);this.model.replaceElement(i,o)},isImageControl:function(e){return(e=e||"").search(/image/gi)>=0},undo:function(){var e=this.arguments,t=this.originalSourceElement.properties,i=e.sourceGuid,n=e.guid;return-1==t.type.search(/image/gi)&&this.model.replaceElement(i,this.originalSourceElement),this.model.replaceElement(n,this.originalTargetElement),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.updateGridColumnModelCommand",{},{execute:function(){var e=this.arguments,t=e.gridModel.guid,i=this.model.createElement(e.gridModel.type,e.gridModel);return"adhocgrid"!=i.type&&i.restoreDefaultDisplayName(),this.model.replaceElement(t,i),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.updateAssociationModelCommand",{},{execute:function(){var e=["leftxpath","leftdisplayattrib","leftadditionalattrib","leftfilter","leftcaption","rightxpath","rightdisplayattrib","rightfilter","rightadditionalattrib","rightcaption","factxpath"],t=this.arguments,i=t.model,n=t.guid;this.changes={};for(var o=this.model.getElement(n),r=o.properties,a=0,s=e.length;a<s;a++){var l=e[a];bizagi.editor.utilities.objectEquals(i[l],r[l])||(t.refresh=!0,this.changes[l]=r[l],o.assignProperty(l,i[l]))}return this.calculateXpathControl(),!0},calculateXpathControl:function(){var e=this.arguments,t=e.model,i=e.guid,n=this.model.getElement(i),o=e.control;if(this.changes.factxpath){var r=t.leftxpath,a=bizagi.clone(r),s=a.xpath.baxpath;s.xpath=s.xpath+"."+t.factxpath,n.assignProperty("xpath",a),"searchlist"==o&&n.assignProperty("displayName",bizagi.editor.utilities.buildComplexLocalizable(t.factxpath,i,"displayName")),$.when(this.getFactNames(t)).done(function(){n.assignProperty("leftfactname",t.leftfactname),n.assignProperty("rightfactname",t.rightfactname)})}},getFactNames:function(e){var t=e.leftxpath,i=e.leftfactname,n=e.rightxpath,o=e.rightfactname,r=new $.Deferred;return $.when(this.controller.getXpathNavigatorModel({context:t}),this.controller.getXpathNavigatorModel({context:n})).done(function(t,n){var a=t.getNodeByXpath(i);if(e.leftfactname=bizagi.editor.utilities.buildComplexXpath(a.xpath,a.contextScope,a.isScopeAttribute,a.guidRelatedEntity),o){var s=n.getNodeByXpath(o);e.rightfactname=bizagi.editor.utilities.buildComplexXpath(s.xpath,s.contextScope,s.isScopeAttribute,s.guidRelatedEntity)}r.resolve()}),r.promise()}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getDecoratorModelCommand",{},{execute:function(){var e=this.arguments.guid,t=this.model.getElement(e);return this.arguments.result=t.getDecoratorModel(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getContextMenuModelCommand",{},{execute:function(){var e=this.arguments,t=e.guid,i=e.convertToModel,n=this.model.getElement(t).getContextMenuModel();return n.addConverToItem(i),this.arguments.result=n,!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getXpathDataForElementCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(this.arguments.guid),i=bizagi.editor.utilities.resolveComplexXpath(t.properties.xpath),n=this.controller.isGridContext()?this.controller.getXpathNavigatorModelGrid():this.controller.getXpathNavigatorModel();return e.result=n.getNodeByXpath(i),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getElementPropertyCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(e.guid);return this.arguments.result=t.getProperty(e.property),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getElementDesignPropertyCommand",{},{execute:function(){var e=this.arguments;return this.arguments.result=void 0!==e.guids&&this.model.getElement(e.guids[0]).getRenderingModel(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getRibbonModelCommand",{},{execute:function(){var e=this,t=new $.Deferred,i=e.arguments,n=e.controller.getRibbonModel(),o=e.model.getElement(i.guid),r=i.convertToModel;if(n.reset(),o){for(var a=o.getRibbonProperties(),s=0;s<a.length;s++)n.enableProperty(a[s],o.resolveProperty(a[s]));n.enableAction("copy-format"),r.length>0&&(n.enableAction("convertto"),e.appendConvertToModel(n,r)),n.enableAction("rename"),("nestedform"==o.type||/grid/.test(o.type))&&n.disableAction("rename"),n.enableAction("delete"),e.isControlEditable(o)||n.disableProperty("editable")}else n.disableAction("convertto"),e.appendConvertToModel(n,[]);(Array.isArray(n.customOptions)&&n.customOptions.forEach(function(t){switch(t.name){case e.constants.SUPPORT_OFFLINE:t.value=e.controller.getSupportOffline(),t.readOnly=e.controller.getIsInCheckout()}}),e.controller.hasUndo()?n.enableAction("undo"):n.disableAction("undo"),n.enableAction("checkout"),e.controller.hasRedo()?n.enableAction("redo"):n.disableAction("redo"),e.controller.isReadOnlyForm())?n.disableAction("actionsvalidations"):e.controller.isFormContext()?(n.enableAction("copy-from"),n.enableAction("actionsvalidations"),n.enableAction("useCustomButtons"),e.controller.getModel().getProperty("usecustombuttons")?(n.checkAction("useCustomButtons"),n.showGroup("email"),n.checkAction("enableEmail"),n.enableAction("emailTemplate")):(n.uncheckAction("useCustomButtons"),n.uncheckAction("enableEmail"),n.disableAction("emailTemplate"))):e.controller.isQueryFormContext()?n.enableAction("actionsvalidations"):e.controller.isStartFormContext()?(n.enableAction("actionsvalidations"),n.enableAction("copy-from")):e.controller.isOfflineFormContext()&&(n.enableAction("actionsvalidations"),n.enableAction("copy-from"));return i.validFormChecked?n.checkAction("validate"):n.uncheckAction("validate"),e.controller.isReadOnlyForm()?(n.disableProperty("language"),n.disableAction("validate")):(n.enableAction("formproperties"),n.enableProperty("language",bizagi.editorLanguage),n.setCaption("language",bizagi.editorLanguage.key)),$.when(e.controller.thereAreChangesInForm()).done(function(e){e?n.enableAction("save"):n.disableAction("save"),t.resolve(n)}),i.result=t.promise(),!0},appendConvertToModel:function(e,t){var i=e.getElementByAction("convertto");if(i){i.elements=[];for(var n=0;n<t.length;n++)i.elements.push({caption:t[n].caption,action:"convert",style:t[n].controlName,property:t[n].controlName,css:t[n].style});e.processElementsForConvertTo(i.elements)}},isControlEditable:function(e){return null!=e.properties.editable}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.insertElementsCommand",{},{execute:function(){var e=this.arguments;new $.Deferred;return this.form=e.form,this.addElements(),this.addActions(),this.addValidations(),this.canAddButtons()&&this.addButtons(),!0},addElements:function(){var e=this;(e.form.elements||[]).forEach(function(t){e.model.addElement(t)})},deleteElements:function(){var e=this;(e.form.elements||[]).forEach(function(t){e.model.removeElementById(t.guid)})},addActions:function(){var e=this;(e.form.actions||[]).forEach(function(t){e.model.addAction(t)})},deleteActions:function(){var e=this;(e.form.actions||[]).forEach(function(t){e.model.deleteAction(t.guid)})},addValidations:function(){var e=this;(e.form.validations||[]).forEach(function(t){e.model.addValidation(t)})},deleteValidations:function(){var e=this;(e.form.validations||[]).forEach(function(t){e.model.deleteValidation(t.guid)})},addButtons:function(){var e=this,t=e.form.buttons||[];0!=t.length&&(e.model.getProperty("usecustombuttons")||(e.model.removeButtons(),e.model.assignProperty("usecustombuttons",!0),e.toggleCustomButtons=!0),t.forEach(function(t){var i=e.model.createElement(t.type,t);e.model.addButton(i)}))},deleteButtons:function(){var e=this,t=e.form.buttons||[];e.toggleCustomButtons&&(e.model.assignProperty("usecustombuttons",!1),e.toggleCustomButtons=!1,e.model.createDefaultButtons()),t.forEach(function(t){e.model.removeElementById(t.guid)})},canAddButtons:function(){return"StartForm"!=this.arguments.formType&&!this.controller.isStartFormContext()},undo:function(){return this.deleteElements(),this.deleteActions(),this.deleteValidations(),this.canAddButtons()&&this.deleteButtons(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.validateGridColumnModelCommand",{},{execute:function(){var e=this.arguments,t=this.controller.getContextInfo(),i=this.model.getElement(t.guid);return e.result=!0,this.validateGroupBy(i)||(e.result=!1),!0},validateGroupBy:function(e){var t=!0;e&&e.elements&&(t=$.grep(e.elements,function(e,t){if(e.properties&&e.properties.groupby)return!0===e.properties.groupby}).length<=1);return t}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.formValidationsCommand",{},{execute:function(){var e=new $.Deferred,t=this.arguments;t.result={},t.refresh=t.canRefresh,t.canValidate=!0;var i=[];if($.isArray(t.validations)&&t.validations.length>0)for(var n=0,o=t.validations.length;n<o;n+=1)$.isFunction(this["validate"+t.validations[n]])&&i.push(this["validate"+t.validations[n]]());return $.when.apply($,i).done(function(){e.resolve(!0)}),e.promise()},validateRequiredProperties:function(){var e=this.arguments;return this.model.validRequiredProperties()||$.extend(e.result,{requiredProperties:!0}),!0},validateRequiredDependentProperties:function(){var e=this.arguments;return this.model.validRequiredDependentProperties()||$.extend(e.result,{requiredDependentProperties:!0}),!0},validateSameXpath:function(){var e=this,t={},i={},n=e.arguments;if(e.model.getMapXpath(e.model.form,t),$.each(t,function(e,t){t.elements.length>1&&t.editables>1&&(i[e]=t)}),!$.isEmptyObject(i)){for(var o in i){var r=i[o];$.each(r.elements,function(t,i){(i=e.model.getElement(i.guid))&&i.validSameXpath&&i.validSameXpath(o)})}$.extend(n.result,{sameXpath:!0})}return!0},validateSameXpathAdhoc:function(){var e=this,t={},i={},n=e.arguments;if(e.model.getMapXpathAdhoc(e.model.form,t),$.each(t,function(e,t){t.elements.length>1&&t.editables>1&&(i[e]=t)}),!$.isEmptyObject(i)){for(var o in i){var r=i[o];$.each(r.elements,function(t,i){(i=e.model.getElement(i.guid))&&i.validSameXpathAdhoc&&i.validSameXpathAdhoc(o)})}$.extend(n.result,{sameXpath:!0})}return!0},validateSameXpathAdhocDataSource:function(){var e=this,t={},i={},n=e.arguments;if(e.model.getMapXpathDatasourceAdhoc(e.model.form,t),$.each(t,function(e,t){t.elements.length>1&&t.editables>1&&(i[e]=t)}),!$.isEmptyObject(i)){for(var o in i){var r=i[o];$.each(r.elements,function(t,i){(i=e.model.getElement(i.guid))&&i.validSameXpathDatasourceAdhoc&&i.validSameXpathDatasourceAdhoc(o)})}$.extend(n.result,{sameXpath:!0})}return!0},validateElementsInContainers:function(){var e=this.arguments;return this.model.validElementsInContainer()||$.extend(e.result,{elementInContainers:!0}),!0},validateAttributesAdministrables:function(){var e=this.arguments,t=this.model.getForm(),i=t.getProperty("isadministrable");return!("parameter"!=t.triggerGlobalHandler("getContextEntityType")||!i)||(this.model.validAttributesAdministrables()||$.extend(e.result,{attributesAdministrables:!0}),!0)},validateLayoutPlaceholder:function(){var e=this.arguments,t=this.model.getForm().getLayout().repeaters,i=[];for(var n in t){var o=t[n];for(id in o.elements)i.push(id)}return this.model.validLayoutPlaceholder(i)||$.extend(e.result,{layoutPlaceholder:!0}),!0},validateAttributesNoEditables:function(){var e=$.Deferred(),t=this.arguments;return $.when(this.model.validAttributesNoEditables()).then(function(i){i||$.extend(t.result,{attributesNoEditables:!0}),e.resolve(!0)}),e.promise()},validateEntitiesNoEditables:function(){var e=$.Deferred(),t=this.arguments;return $.when(this.model.validEntitiesNoEditables()).then(function(i){i||$.extend(t.result,{entitiesNoEditables:!0}),e.resolve(!0)}),e.promise()}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.validateActionsValidationsModelCommand",{},{execute:function(){var e=this;e.controller.isFormContext()&&$.when(e.controller.getCommandsEditorModel()).done(function(t){var i=t.getInvalidElements();i.actions&&e.removeActions(i.actions),i.validations&&e.removeValidations(i.validations)})},removeActions:function(e){for(var t=0,i=e.length;t<i;t++)this.model.deleteAction(e[t].guid)},removeValidations:function(e){for(var t=0,i=e.length;t<i;t++)this.model.deleteValidation(e[t].guid)}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getSelectFormModelCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(e.guid),i={};return i.value=t.getProperty(e.property),i.xpath=t.getProperty("xpath"),i.name=e.propertyName,i.relatedForms=[],i.context=this.controller.getContext(),this.arguments.result=i,!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.removeValidationsInModelCommand",{},{execute:function(){var e=this.arguments;return e.refresh=e.canRefresh,this.model.removeValidations(),!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.convertToCommand",{},{execute:function(){var e=this,t=e.arguments,i=e.model.getElement(t.guid),n=!1;if(e.needsExternalData(t.convertTo)){if(!e.validateElement(i,t.convertTo))return t.canUndo=!1,!1;n=!0,e.precondition||(e.precondition=e.controller.publish("getExternalData",{control:e.normalizeControlType(t.convertTo),xpath:i.resolveProperty("xpath")}))}return $.when(e.precondition).pipe(function(i){n?e.processControl({control:t.convertTo,data:i}):e.converToElement()}).pipe(function(){return!0})},converToElement:function(){var e=this,t=e.arguments,i=$.Deferred();if(!e.data){var n=e.getCommonProperties({exclude:{}}),o=e.getElements();e.convertToElement=e.createElement($.extend(n,{type:t.convertTo}),o),e.controller.executeCommand({command:"applyOverridesElement",element:e.convertToElement})}return $.when(e.controller.executeCommand({command:"removeElementById",guid:t.guid,canUndo:!1,action:"convertTo"})).done(function(n){n=e.resolveData(n),e.controller.removeSelectedElement(t.guid),e.model.insertElement(n.position,n.parent.guid,e.convertToElement),e.data=n,e.controller.executeCommand({command:"applyOverridesElement",element:e.data}),i.resolve()}),i.promise()},undo:function(){var e=this.convertToElement.guid;return this.controller.executeCommand({command:"removeElementById",guid:e,action:"convertTo",canUndo:!1}),$.isArray(this.data.entities)?this.insertCascadingCombo():this.model.insertElement(this.data.position,this.data.parent.guid,this.data),!0},getCommonProperties:function(e){var t=this.arguments,i=e.exclude||{},n=this.controller.getControlsModel(),o=this.model.getElement(t.guid),r=n.getDesignProperties(o.type)||{},a=n.getDesignProperties(t.convertTo)||{},s={renderType:!0};for(var l in r)if(!i[l]){var d=r[l],c=a[l];d&&c&&this.identicalProperties(d,c)&&(s[l]=!0)}return this.setValueConvertToProperties(o,s)},getElements:function(){var e=this.arguments,t=this.model.getElement(e.guid);if(t&&t.elements)return this.isContainer(t.type)||this.isCollection(t.type)?t.elements:void 0},isContainer:function(e){return/group/.test(e)||/panel/.test(e)||/tab/.test(e)},isCollection:function(e){return/grid/.test(e)},identicalProperties:function(e,t){return!(!e["bas-type"]||!t["bas-type"])&&(!(e.subproperties^t.subproperties)&&(e.subproperties?this.identicalSubproperties(e.subproperties,t.subproperties):e["bas-type"]===t["bas-type"]))},identicalSubproperties:function(e,t){return bizagi.util.identicalObjects(e,t)},setValueConvertToProperties:function(e,t){var i=e.properties,n={};for(var o in t)null!=i[o]&&(n[o]=bizagi.clone(i[o]));return n},needsExternalData:function(e){return/cascadingcombo/.test(e)},processControl:function(e){if(/cascadingcombo/.test(e.control))return this.processCascadingCombo(e.data)},processCascadingCombo:function(e){var t=this,i=t.arguments,n=$.Deferred();if(e.length<2){var o=bizagi.localization.getResource("bizagi-editor-form-validation-convertto-cascadingcombo");return bizagi.showMessageBox(o,"Bizagi","error",!1),void n.resolve()}var r=t.getCommonProperties({exclude:{displayName:1,xpath:1,data:1}});$.when(t.controller.executeCommand({command:"removeElementById",guid:i.guid,canUndo:!1,action:"convertTo"})).done(function(o){o=t.resolveData(o),t.data=o;var a,s,l=o.parent.guid||t.controller.getContextInfo().guid,d=o.position;t.cascadingComboElements||(t.cascadingComboElements={}),$.each(e,function(e,n){t.cascadingComboElements[e]?t.convertToElement=t.cascadingComboElements[e]:(t.convertToElement=t.createElement($.extend(r,{type:i.convertTo,xpath:bizagi.editor.utilities.buildComplexXpath(n.xpath,i.contextEntity,!1,n.id),parentcombo:a,parentrelation:n.parentRelation?bizagi.editor.utilities.buildComplexXpath(n.parentRelation,n.id,!1,n.parentEntity):void 0})),t.cascadingComboElements[e]=t.convertToElement),t.controller.executeCommand({command:"insertElement",parent:l,element:t.convertToElement,position:d+e,canUndo:!1}),null!=s&&s.setProperty("childcombo",t.convertToElement.guid),a=t.convertToElement.guid,s=t.model.getElement(a)}),n.resolve()}),n.promise()},validateElement:function(e,t){var i=this.arguments;if(/cascadingcombo/.test(t)){var n=e&&e.resolveProperty("xpath");if("object"!=typeof n)return bizagi.showMessageBox(bizagi.localization.getResource("bizagi-editor-wizard-cascadingcombo-invaliddatasource"),"Bizagi","error",!1),!1;i.contextEntity=bizagi.editor.utilities.resolveContextEntityFromXpath(n)}return!0},insertCascadingCombo:function(){var e=this;$.each(e.data.entities,function(t,i){e.model.insertElement(e.data.position+t,i.parent.guid,i)})},resolveData:function(e){return $.isArray(e)?e[0]:e}}),bizagi.editor.command.extend("bizagi.editor.enableOfflineCommand",{},{execute:function(){var e=this.arguments;this.model.setOffline(e.value)},undo:function(){this.model.setOffline(!Boolean(args.value))},needRefresh:function(){return!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.loadWidgetsCommand",{},{execute:function(){var e=this,t=e.arguments,i=new $.Deferred;e.model.addWidgets(t.controls.widgets);var n=e.controller.componentModels.controlsNavigator,o=e.controller.getControlsModel(),r=e.controller.widgetDefinitions,a=t.controls.widgets;if(Array.isArray(a)){var s=a.reduce(function(t,i){return Boolean(r[i.guid])||(t.push(e.controller.loadUserfield(i)),e.controller.loadIconUserField(i)),t},[]);$.when.apply($,s).done(function(){e.controller.loadWidgetDefinitions(e.controller.device),i.resolve()}),n.processData({controls:a}),o.processData({controls:a},[])}else i.resolve();return t.result=i.promise(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.copyFormatCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(e.guid).getFormatProperties();return this.controller.pushCopyFormat({guid:e.guid,properties:t}),!0}}),bizagi.editor.refreshableCommand.extend("bizagi.editor.changeLayoutCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(e.guid);this.originalValue||(this.originalValue=bizagi.clone(t.getProperty("layout"))),t.assignProperty("layout",{elements:e.values});for(var i=0,n=e.values.length;i<n;i+=1){t.elements[i].assignProperty("width",e.values[i].width)}return!0},undo:function(){var e=this.arguments,t=this.model.getElement(e.guid);t.assignProperty("layout",this.originalValue);for(var i=0,n=this.originalValue.elements.length;i<n;i+=1){t.elements[i].assignProperty("width",this.originalValue.elements[i].width)}return!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.propertyIsRequiredCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(e.guid);return e.result=t.isRequiredProperty(e.property),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getXpathNavigatorModelCommand",{},{execute:function(){var e=this,t=e.arguments,i=new $.Deferred;return t.toogleView&&e.controller.toogleXPathNavigatorView(),$.when(e.controller.getXpathNavigatorModel()).done(function(t){$.when(t.ready()).done(function(t){if($.isPlainObject(t))i.resolve(t);else if(e.controller.isGridContext())i.resolve(t);else{e.controller.getXpathNavigatorView()===bizagi.editor.component.xpathnavigator.model.view.onlyProcessEntity?t.getProcessEntityModel():t.getAllModel(),i.resolve(t)}})}),t.result=i.promise(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getAdhocXpathNavigatorModelCommand",{},{execute:function(){var e=this.arguments,t=new $.Deferred;return e.toogleView&&this.controller.toogleXPathNavigatorView(),$.when(this.controller.getAdhocXpathNavigatorModelGrid()).done(function(e){t.resolve(e)}),e.result=t.promise(),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getConvertToModelCommand",{renderTypeMapping:{text:"string",currency:"number",float:"number",attachment:"upload","entity-master":["combo","formlink","list","search","radio","suggest","searchsuggest","searchcombo","entitytemplate","actionlauncher"],"entity-stakeholder":["combo","formlink","list","search","radio","suggest","searchsuggest","searchcombo","entitytemplate","actionlauncher"],"entity-system":["combo","formlink","list","search","radio","suggest","searchsuggest","searchcombo","entitytemplate","actionlauncher"],"entity-parametric":["cascadingcombo","combo","formlink","list","search","radio","suggest","searchsuggest","searchcombo","entitytemplate","actionlauncher"]},renderTypeOfflineMapping:{4:{currency:"offlinenumber",float:"offlinenumber",attachment:"offlineupload","entity-master":["offlinecombo","offlineradio","offlinesuggest","offlinelist"],"entity-stakeholder":["offlinecombo","offlineradio","offlinesuggest","offlinelist"],"entity-parametric":["offlinecombo","offlineradio","offlinesuggest","offlinelist"]},6:{currency:"offlinesmartphonenumber",float:"offlinesmartphonenumber",attachment:"offlinesmartphoneupload","entity-master":["offlinesmartphonecombo","offlinesmartphoneradio","offlinesmartphonesuggest","offlinesmartphonelist"],"entity-stakeholder":["offlinesmartphonecombo","offlinesmartphoneradio","offlinesmartphonesuggest","offlinesmartphonelist"],"entity-parametric":["offlinesmartphonecombo","offlinesmartphoneradio","offlinesmartphonesuggest","offlinesmartphonelist"]},7:{currency:"offlinetabletnumber",float:"offlinetabletnumber",attachment:"offlinetabletupload","entity-master":["offlinetabletcombo","offlinetabletradio","offlinetabletsuggest","offlinetabletlist"],"entity-stakeholder":["offlinetabletcombo","offlinetabletradio","offlinetabletsuggest","offlinetabletlist"],"entity-parametric":["offlinetabletcombo","offlinetabletradio","offlinetabletsuggest","offlinetabletlist"]}},renderTypeColumnOfflineMapping:{4:{currency:"offlinecolumnnumber",float:"offlinecolumnnumber",attachment:"offlinecolumnupload","entity-master":["offlinecolumncombo","offlinecolumnradio","offlinecolumnsuggest","offlinecolumnlist"],"entity-stakeholder":["offlinecolumncombo","offlinecolumnradio","offlinecolumnsuggest","offlinecolumnlist"],"entity-parametric":["offlinecolumncombo","offlinecolumnradio","offlinecolumnsuggest","offlinecolumnlist"]},6:{currency:"offlinesmartphonecolumnnumber",float:"offlinesmartphonecolumnnumber",attachment:"offlinesmartphonecolumnupload","entity-master":["offlinesmartphonecolumncombo","offlinesmartphonecolumnradio","offlinesmartphonecolumnsuggest","offlinesmartphonecolumnlist"],"entity-stakeholder":["offlinesmartphonecolumncombo","offlinesmartphonecolumnradio","offlinesmartphonecolumnsuggest","offlinesmartphonecolumnlist"],"entity-parametric":["offlinesmartphonecolumncombo","offlinesmartphonecolumnradio","offlinesmartphonecolumnsuggest","offlinesmartphonecolumnlist"]},7:{currency:"offlinetabletcolumnnumber",float:"offlinetabletcolumnnumber",attachment:"offlinetabletcolumnupload","entity-master":["offlinetabletcolumncombo","offlinetabletcolumnradio","offlinetabletcolumnsuggest","offlinetabletcolumnlist"],"entity-stakeholder":["offlinetabletcolumncombo","offlinetabletcolumnradio","offlinetabletcolumnsuggest","offlinetabletcolumnlist"],"entity-parametric":["offlinetabletcolumncombo","offlinetabletcolumnradio","offlinetabletcolumnsuggest","offlinetabletcolumnlist"]}},renderTypeQueryMapping:{currency:"querynumber",float:"querynumber","entity-master":["querycombo","queryradio","querysuggest","querylist"],"entity-stakeholder":["querycombo","queryradio","querysuggest","querylist"],"entity-parametric":["querycascadingcombo","querycombo","queryradio","querysuggest","querylist"]}},{execute:function(){var e=this,t=e.arguments,i=new $.Deferred,n=e.model.getElement(t.guid);if(n){var o,r=n.properties.xpath;if(e.model=n.getConvertToModel(),t.result=e.model,r)o=/groupedgrid/.test(n.type)?e.controller.getXpathNavigatorModel():e.controller.isGridContext()?e.controller.getXpathNavigatorModelGrid():e.controller.getXpathNavigatorModel(),$.when(o).done(function(n){var o=n.getNodeByXpath(bizagi.editor.utilities.resolveComplexXpath(r));if(o){var a=o.getRenderType();t.result=e.getModel(a)}i.resolve(!0)});else i.resolve(!0)}else t.result=[],i.resolve(!0);return i.promise()},getModel:function(e){var t=this.model;return e=this.controller.isOfflineContext()?this.resolveOfflineType(e):this.resolveType(e),$.isArray(e)?$.grep(t,function(t,i){return $.inArray(t.controlName,e)>=0}):$.grep(t,function(t,i){return t.controlName===e||$.inArray(e,t.filterBy)>=0})},resolveType:function(e){var t=this.controller.isQueryFormContext()?this.Class.renderTypeQueryMapping:this.Class.renderTypeMapping;if(t[e]){var i=t[e];if(Array.isArray(i)){var n=this.controller.isSpecific,o=this.controller.getCurrentDevice(),r=this.controller.isGridContext();i=i.map(function(e){var t=e;if(r&&(t="column"+t),n)switch(o){case"Smartphone":t="smartphone"+t;break;case"Tablet":t="tablet"+t}return t})}return i}return e},resolveOfflineType:function(e){var t=this.controller.getDeviceType();return(this.controller.isGridContext()?this.Class.renderTypeColumnOfflineMapping[t]:this.Class.renderTypeOfflineMapping[t])[e]||e}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.applyOverridesElementCommand",{propertiesOverrides:{currency:{allowdecimals:"true",thousands:"true"},float:{allowdecimals:"true",thousands:"true"},number:{allowdecimals:"false",thousands:"false"}},requiredPropertiesOverrides:{combo:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},columncombo:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},querycombo:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},querymultiselect:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},searchcombo:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},list:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},columnlist:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},querylist:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},radio:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},columnradio:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}},queryradio:{"entity-parametric":{"data.displayattrib":!1},"entity-master":{"data.displayattrib":!0},"entity-stakeholder":{"data.displayattrib":!0},"entity-system":{"data.displayattrib":!0}}}},{execute:function(){var e=this,t=e.arguments;return e.element=t.element||e.model.getElement(t.guid),!bizagi.editor.utilities.isObject(e.element.properties.xpath)||(e.xpathModel=e.controller.isGridContext()?e.controller.getXpathNavigatorModelGrid():e.controller.getXpathNavigatorModel(),t.overrides=t.overrides||{properties:!0,requiredProperties:!0},t.overrides.properties&&e.propertiesOverrides(),t.overrides.requiredProperties&&e.requiredPropertiesOverrides(),e.updateControlType(),!0)},propertiesOverrides:function(){var e=this.getRenderType();e&&this.Class.propertiesOverrides[e]&&this.element.propertiesOverrides(this.Class.propertiesOverrides[e])},requiredPropertiesOverrides:function(){var e=this.element.properties,t=this.normalizeControlType(e.type),i=this.getRenderType(),n=this.Class.requiredPropertiesOverrides[t];n&&n[i]&&this.element.requiredPropertiesOverrides(n[i])},getRenderType:function(){var e=this.element.properties.xpath,t=this.xpathModel.getNodeByXpath(bizagi.editor.utilities.resolveComplexXpath(e));return!!t&&t.getRenderType()},updateControlType:function(){(/hidden/.test(this.element.type)||"layoutPlaceholder"==this.element.type)&&(this.element.controlType=this.getRenderType())}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.getMultiselectionPropertiesCommand",{properties:{visible:!1,editable:!1,required:!1,format:!1,layout:!1},defaultValueProperties:{visible:{fixedvalue:"true"},editable:{fixedvalue:"true"},required:{fixedvalue:"false"},format:{size:void 0,bold:void 0,italic:void 0,underline:void 0,strikethru:void 0,color:void 0,background:void 0},layout:{labelwidth:50,valuewidth:50}}},{execute:function(){var e=this,t=e.arguments||{};return e.mergeModel=bizagi.clone(e.Class.properties),e.selectedElements=e.controller.getGuidsSelected(),e.getPropertiesModel(e.selectedElements),e.findCommonProperties(),t.result=e.buildModel(),e.resetProperties(),!0},getPropertiesModel:function(e){this.propertiesModel={};for(var t=0,i=e.length;t<i;t++){var n=e[t],o=this.model.getElement(n);this.propertiesModel[n]=$.extend(!0,{},o.getPropertiesModel())}},resetProperties:function(){for(var e in this.Class.properties)this.Class.properties[e]=!1},findCommonProperties:function(){for(var e in this.commonProperties={},this.propertiesModel){this.resetProperties(),this.commonProperties[e]={};var t=this.propertiesModel[e].elements[0].tabs;this.findPropertiesInTabs(e,t)||this.removePropertiesInMergeModel()}},findPropertiesInTabs:function(e,t){for(var i=0,n=t.length;i<n;i++)for(var o=t[i],r=0,a=o.elements.length;r<a;r++){var s=o.elements[r];if(s.property&&this.propertyIsValid(s.property.name)&&("boolean"==typeof this.mergeModel[s.property.name]?this.mergeModel[s.property.name]={element:s,tab:o}:this.resolvePropertyValue(s),this.findAllProperties()))return!0}return!1},resolvePropertyValue:function(e){if(this.mergeModel[e.property.name]){var t=this.mergeModel[e.property.name].element;if(!bizagi.editor.utilities.objectEquals(e.property.value,t.property.value)&&(t.property.value=this.Class.defaultValueProperties[e.property.name],t.property.subproperties))for(var i=t.property.subproperties,n=0,o=i.length;n<o;n++){var r=i[n].property;r&&(r.value=this.Class.defaultValueProperties[r.name])}}},propertyIsValid:function(e){for(var t in this.Class.properties){if(!this.Class.properties.hasOwnProperty(t))break;if(t===e)return this.Class.properties[t]=!0,!0}return!1},findAllProperties:function(){var e=!0;for(var t in this.Class.properties)if(!(e&=this.Class.properties[t]))return e;return e},removePropertiesInMergeModel:function(){for(var e in this.Class.properties)this.Class.properties[e]||delete this.mergeModel[e]},buildModel:function(){var e={},t=this.selectedElements.length;e.renderCaption=t+" "+bizagi.localization.getResource("bizagi-editor-properties-multiple-controls-caption"),e.idRender="00000000-0000-0000-0000-000000000000",e.element={type:"multiselect"},e.elements=[];var i={tabs:[]},n=this.mergeTabs();for(var o in n)i.tabs.push(n[o]);return e.elements.push(i),e},mergeTabs:function(){var e={};for(var t in this.mergeModel){var i=this.mergeModel[t].tab;e[i.caption]?e[i.caption].elements.push(this.mergeModel[t].element):(e[i.caption]={elements:[],caption:i.caption,id:i.id},e[i.caption].elements.push(this.mergeModel[t].element))}return e}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.searchDependenciesCommand",{},{execute:function(){var e=this.arguments,t=this.model.getActionValidationsModel(),i=this.controller.isGridContext()?bizagi.editor.utilities.resolveComplexXpath(this.controller.getContextInfo().xpath)+"[].":"";this.actions=t.actions,this.validations=t.validations,this.mapXpath=t.mapXpaths,$.isArray(e.guids)||"string"!=typeof e.guid||(e.guids=[e.guid]);for(var n=0;n<e.guids.length;n++){var o=this.model.getElement(e.guids[n]);if(this.processElement(o,i))return!0}return e.result={result:!0},!0},processElement:function(e,t){var i=this,n=i.arguments,o=!1;if(t=t||"",!e)return o;var r=e.properties,a=i.xpath=t+(bizagi.editor.utilities.resolveComplexXpath(r.xpath)||e.guid);if(i.isUniqueXpath(a)){i.idElement=e.guid;var s=e.resolveDisplayNameProperty();if(i.processActions()||(i.showMessage(s),n.result={result:!1,fail:"Actions"},o=!0),i.processValidations()||(i.showMessage(s),n.result={result:!1,fail:"Validations"},o=!0),Array.isArray(e.elements)){var l=e.isGrid();e.elements.forEach(function(e){var t=l?a+"[].":t;o=o||i.processElement(e,t)})}}return o},processActions:function(){for(var e=0,t=this.actions.length;e<t;e++){var i=this.actions[e];if(this.seachInDependencies(i.dependencies))return!1;if(this.searchInCommands(i.commands))return!1;if(this.searchInCommands(i.elseCommands))return!1}return!0},isUniqueXpath:function(e){if(!e)return!0;if(!this.mapXpath[e])return!0;var t=this.mapXpath[e].elements;if(1==t.length)return!0;for(var i=0,n=t.length,o={form:0,nestedForm:0};i<n;)t[i++].nestedForm?o.nestedForm++:o.form++;return 1===o.form},processValidations:function(){for(var e=0,t=this.validations.length;e<t;e++){var i=this.validations[e];if(this.searchInConditions(i.conditions))return!1}return!0},seachInDependencies:function(e){var t=this,i=!1;return e&&$.each(e,function(e,n){return t.xpath===bizagi.editor.utilities.resolveComplexXpath(n)?(i=!0,!1):t.idElement===bizagi.editor.utilities.resolveComplexXpath(n)?(i=!0,!1):void 0}),i},searchInCommands:function(e){var t=this,i=!1;return e&&$.each(e,function(e,n){return n.xpath&&t.xpath===bizagi.editor.utilities.resolveComplexXpath(n.xpath)?(i=!0,!1):n.container&&n.container===t.idElement?(i=!0,!1):n.renderId&&n.renderId===t.idElement?(i=!0,!1):void 0}),i},searchInConditions:function(e){var t=this,i=!1,n=e.expressions;return $.each(n,function(e,n){if(n.simple){if(t.xpath===(bizagi.editor.utilities.resolveComplexXpath(n.simple.xpath)||n.simple.renderId))return i=!0,!1}else if(n.complex)return t.searchInConditions(n.complex.conditions)}),i},showMessage:function(e){var t=this.arguments.message,i=bizagi.localization.getResource("formmodeler-command-searchdependencies-error").replace("{0}",e);t&&(i=t.replace("{0}",e)),bizagi.showMessageBox(i,"info","info",!1)}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.refreshControlCommand",{},{execute:function(){var e=this.arguments,t=this.model.getElement(e.guid);return t&&t.refreshControl&&t.refreshControl(e),!0}}),bizagi.editor.insertElementFromXpathNavigatorCommand.extend("bizagi.editor.addEntityChildrenCommand",{},{execute:function(){var e=this,t=e.arguments,i=new $.Deferred,n=t.node,o=e.controller.getContextInfo().guid;return null==e.elements?(e.elements=[],e.parent=o,e.addElementToRender(n.getChildren(),o)):e.elements.forEach(function(t){return e.model.addElement(t,e.parent)}),t.refresh=!0,i.resolve(!0),t.result=i.promise(),!0},addElementToRender:function(e,t){var i=this;(e=e||[]).forEach(function(e){var n={renderType:e.renderType,nodeSubtype:e.nodeSubtype,name:e.displayName,xpath:bizagi.editor.utilities.buildComplexXpath(e.xpath,e.contextScope,e.isScopeAttribute,e.guidRelatedEntity),guid:e.guid};i.arguments={data:n},(n=i.createElementData())&&n.type&&"form"!=e.nodeType&&(element=i.createElement(n),i.elements.push(element),i.model.addElement(element,t),i.controller.executeCommand({command:"applyOverridesElement",overrides:{properties:!0,requiredProperties:!0},guid:element.guid,canUndo:!1}))})},resolveType:function(e){var t=this.controller.getContext();return"form"==t||"startform"==t?"form"===e?"nestedform":e:"grid"==t?this.Class.columnRenderMapping[e]:"offlinegrid"==t?this.Class.offlineColumnRenderMapping[e]:"searchform"==t?this.Class.searchFormRenderMapping[e]:"offlineform"==t?this.Class.offlineFormRenderMapping[e]:"queryform"==t?this.Class.queryFormRenderMapping[e]:null},undo:function(){var e=this;return e.elements.forEach(function(t){e.model.removeElementById(t.guid)}),!0}}),bizagi.editor.notUndoableCommand.extend("bizagi.editor.duplicateDisplayNameFormCommand",{},{execute:function(){var e=this.model.getGuid(),t=this.model.resolveProperty("displayName")&&this.model.resolveDisplayNameProperty();if(!t)return!1;var i="copy_"+t;return this.controller.executeCommand({command:"changeProperty",guid:e,property:"displayName",value:i,canUndo:!1}),!0}}),bizagi.editor.component.controller("bizagi.editor.wizard.base",{init:function(e,t){this._super(e),this.params=t},render:function(){var e=this,t=new $.Deferred;return $.when(e.loadTemplates()).done(function(){e.renderWizard(),e.renderButtons().appendTo(e.element),t.resolve()}),t.promise()},loadTemplates:function(e){e=e||{};e=$.extend(e,{"wizard-buttons":bizagi.getTemplate("bizagi.editor.wizard.base")+"#wizard-buttons"});return this._super(e)},getButtons:function(){return[{button:"cancel",caption:bizagi.localization.getResource("bizagi-editor-wizard-buttons-cancel")},{button:"finish",caption:bizagi.localization.getResource("bizagi-editor-wizard-buttons-finish")}]},renderWizard:function(){},renderButtons:function(){var e=this,t=e.getButtons(),i=$.tmpl(e.getTemplate("wizard-buttons"),{buttons:t});return $("button",i).button(),$("button",i).click(function(){var t=$(this).attr("data-button");e.processButton(t)}),i},processButton:function(e){"cancel"==e&&this.presenter.closePopup({success:!1}),"finish"==e&&this.processFinishButton()},processFinishButton:function(){this.presenter.closePopup({success:!0})}}),bizagi.editor.observableClass.extend("bizagi.editor.wizard.presenter",{},{createWizard:function(canvas,params){try{var control=params.control,fn=eval("var bafn = function(canvas, params) {  return new bizagi.editor.wizard."+control+"(canvas, params);};bafn"),wizard=fn(canvas,params);return wizard}catch(e){throw"Can't create a wizard for "+control}},show:function(e){var t=this.popupDeferred=new $.Deferred,i=this.popup=bizagi.createPopup({name:"bz-fm-wizard",container:document.getElementById("root"),additionalClass:"bz-fm-wizard-popup-"+e.control,title:e.title,center:!0,onClose:function(e){t.resolve(e)}});return this.wizard=this.createWizard(i.content,$.extend(e,{presenter:this,popup:i})),this.wizard.render(),t.promise()},closePopup:function(e){this.popup.close(e)}}),bizagi.editor.component.controller("bizagi.editor.wizard.generic",{init:function(e,t){this._super(e),this.params=t,this.presenter=t.presenter,this.model=t.model||{},this.state={device:"",name:""}},loadTemplates:function(e){e=e||{};e=$.extend(e,{"wizard-generic":bizagi.getTemplate("bizagi.editor.wizard.generic")+"#wizard-generic"});return this._super(e)},render:function(){var e=this,t=e.element,i=new $.Deferred;return $.when(e.loadTemplates()).done(function(){$.tmpl(e.getTemplate("wizard-generic"),e.model).appendTo(t),t.bz__fd__wizard({onFinish:function(){e.presenter.closePopup(e.getState()),i.resolve()}}),$(".devices__list",t).bz__fd__selector({onSelect:function(t){e.setState("device",t.find("span").text());var i=$("option:selected",$(t.attr("ref")));e.setState("name",i.val()),$("li",t.parent()).removeClass("device__selected"),t.addClass("device__selected")}})}),i.promise()},getState:function(){return this.state},setState:function(e,t){this.state[e]=t},".addform__select-device select change":function(e,t){this.setState("name",e.val())}}),bizagi.editor.observableClass.extend("bizagi.editor.wizard.generic.presenter",{},{show:function(e){var t=this.popupDeferred=new $.Deferred,i=this.popup=bizagi.createPopup({name:"bz-fm-wizard",container:$("body"),additionalClass:"bz-fm-wizard-popup-add-form",title:"Add New Form",center:!0,onClose:function(e){t.resolve(e)}});return this.wizard=new bizagi.editor.wizard.generic(i.content,{presenter:this,popup:i,model:e}),this.wizard.render(),t.promise()},closePopup:function(e){this.popup.close(e)}}),bizagi.editor.wizard.base("bizagi.editor.wizard.cascadingcombo",{init:function(e,t){t=t||{},this._super(e,t),this.canvas=e,this.presenter=t.presenter},loadTemplates:function(){var e={"wizard-container":bizagi.getTemplate("bizagi.editor.wizard.cascadingcombo")+"#wizard-container"};return this._super(e)},renderWizard:function(){var e=$.tmpl(this.getTemplate("wizard-container"),{});this.drawXpathNavigator(e),e.appendTo(this.canvas)},drawXpathNavigator:function(e){var t=this,i=$(".bz-fm-wizard-cascadingcombo-xpath span",e);$.when(t.params.xpathModel).done(function(e){var n=new bizagi.editor.component.xpathnavigator.presenter({canvas:i,model:e});n.subscribe("nodeClick",function(e,i){t.onNodeClick(i)}),n.subscribe("nodeDoubleClick",function(e,i){t.onNodeDoubleClick(i)}),n.subscribe("getMainContainer",function(){return t.getMainContainer()}),n.render({allowDrag:!1,filter:{typeFilter:"xpathtoentity"}})})},processFinishButton:function(){null!=this.selectedNode?"entity-application"!=this.selectedNode.nodeType?this.presenter.closePopup({success:!0,xpath:this.selectedNode.xpath,displayName:this.selectedNode.displayName,contextEntity:this.selectedNode.contextScope,guidRelatedEntity:this.selectedNode.guidRelatedEntity}):bizagi.showMessageBox(bizagi.localization.getResource("bizagi-editor-wizard-cascadingcombo-invaliddatasource"),"Bizagi","error",!1):bizagi.showMessageBox(bizagi.localization.getResource("bizagi-editor-wizard-cascadingcombo-nodatasource"),"Bizagi","error",!1)},onNodeClick:function(e){this.selectedNode=e},onNodeDoubleClick:function(e){this.selectedNode=e,this.processFinishButton()}}),bizagi.editor.wizard.base("bizagi.editor.wizard.association",{init:function(e,t){t=t||{},this._super(e,t),this.canvas=e,this.presenter=t.presenter,this.model=new bizagi.editor.wizard.association.model(t.model)},loadTemplates:function(){var e={"wizard-container":bizagi.getTemplate("bizagi.editor.wizard.association")+"#wizard-container-association"};return this._super(e)},renderWizard:function(){var e=this,t=e.element;t.empty(),$.when(e.loadTemplates()).done(function(){var i=e.getTemplate("wizard-container");$.tmpl(i,e.model.getViewModel()).appendTo(t)})},refresh:function(){this.render()},updateProperty:function(e,t,i){return this.model.updateProperty(e,t,i)},getFilterProperty:function(e){return this.model.getFilter(e)},getFilterTypes:function(e){return this.model.getFilterTypes(e)},getRelatedEntity:function(e){return this.model.getRelatedEntity(e)},getPropertyValue:function(e){return this.model.getPropertyValue(e)},processFinishButton:function(){var e=this;e.model.isValid()?$.when(e.relationshipIsValid()).done(function(t){t.isValid?e.presenter.closePopup({success:!0,model:e.model.getPersistenceModel(t)}):bizagi.showMessageBox(bizagi.localization.getResource("bizagi-editor-wizard-association-invalidrelationship"),"Bizagi","error",!1)}):bizagi.showMessageBox(bizagi.localization.getResource("bizagi-editor-wizard-association-invalidmodel"),"Bizagi","error",!1)},getOffsetElement:function(e){var t=e.offset();return{top:t.top+e.outerHeight(!0),left:t.left}},buildComplexXpath:function(e){return bizagi.editor.utilities.buildComplexXpath(e.xpath,e.contextScope,e.isScopeAttribute,e.guidRelatedEntity)},resolveComplexXpath:function(e){return bizagi.editor.utilities.resolveComplexXpath(e)},getMultipleRelationship:function(e){var t=new $.Deferred;return $.when(this.presenter.publish("getMultipleRelationship",e)).done(function(e){t.resolve()}),t.promise()},relationshipIsValid:function(){var e=new $.Deferred,t=bizagi.editor.utilities.resolveRelatedEntityFromXpath(this.getPropertyValue("leftxpath")),i=bizagi.editor.utilities.resolveRelatedEntityFromXpath(this.getPropertyValue("rightxpath"));return $.when(this.presenter.publish("getMultipleRelationship",{leftEntity:this.getPropertyValue("leftxpath"),rightEntity:this.getPropertyValue("rightxpath")})).done(function(n){if(n)for(var o=n.leftfact,r=n.rightfact,a=0,s=o.length;a<s;a++){var l=o[a];if(l.ParentId==t&&l.RightEntity==i){e.resolve({isValid:!0,factxpath:l.CatalogName,leftfactname:l.CatalogName,rightfactname:r[0]&&r[0].CatalogName});break}}else e.resolve(!1);e.resolve(!1)}),e.promise()},".bizagi_editor_component_editor_xpath .bz-wizard-association-editor-xpath click":function(e){var t=this,i=e.prev("input"),n=e.data("property"),o={};o.position=t.getOffsetElement(i,o);var r=void 0;t.getFilterProperty(n)&&((r={}).typeFilter=t.getFilterProperty(n),o.typeEditor=r.typeFilter,t.getFilterTypes(n)&&(r.types=t.getFilterTypes(n))),o.filter=r,o.entity=t.resolveComplexXpath(t.getRelatedEntity(n)),o.xpath=t.resolveComplexXpath(t.getPropertyValue(n)),o.xpathProperty=n,$.when(t.presenter.publish("showXPathNavigatorEditor",o)).done(function(e){var i=t.buildComplexXpath(e);t.updateProperty(i,t.resolveComplexXpath(i),n),t.refresh()})},".biz-ico-filter-value click":function(e){var t=this,i=e.data("property"),n=t.getPropertyValue(i),o={};o.data=n||{bafilter:{filter:"filter"}},o.entity=t.resolveComplexXpath(t.getRelatedEntity(i)),o.xpathNode=t.presenter.publish("getXpathData",{xpath:o.entity}),o.protocol="loadfilter";var r=bizagi.editor.communicationprotocol.factory.createProtocol(o);$.when(r.processRequest()).done(function(e){if(e){var n=e.isEmpty?void 0:bizagi.editor.utilities.buildComplexFilter(e,o.xpathNode);t.updateProperty(n,e,i),t.refresh()}})},".editor-localizablestring-input input blur":function(e){var t=e.val(),i=e.data("property"),n=this.getPropertyValue(i),o=e.next(".editor-localizablestring-localization"),r=e.parent();if(o.removeClass("ui-control-fadeIn"),r.toggleClass("ui-control-focus"),t.length>0){if(bizagi.editor.utilities.isObject(n)){var a=bizagi.editorLanguage.key;"default"===a?n.i18n.default=t:n.i18n.languages[a]=t,t=n}else t=bizagi.editor.utilities.buildComplexLocalizable(t,this.model.getElementGuid(),i);this.updateProperty(t,bizagi.editor.utilities.resolvei18n(t),i),this.refresh()}},".editor-localizablestring-input input focus":function(e){var t=e.next(".editor-localizablestring-localization"),i=e.prev('input[type="text"]').parent();t.addClass("ui-control-fadeIn"),i.toggleClass("ui-control-focus")},".editor-localizablestring-input .editor-localizablestring-localization mouseenter":function(e){e.addClass("editor_localizablestring_fadeIn")},".editor-localizablestring-input .editor-localizablestring-localization mouseleave":function(e){e.removeClass("editor_localizablestring_fadeIn")},".editor-localizablestring-localization click":function(e){var t=this,i=e.prev("input").data("property"),n=t.getPropertyValue(i),o=t.model.getElementGuid();$.when(t.presenter.publish("setLocalization",{propertyName:i,propertyValue:n,elementGuid:o})).done(function(e){t.updateProperty(e,bizagi.editor.utilities.resolvei18n(e),i),t.refresh()})}}),bizagi.editor.observableClass.extend("bizagi.editor.wizard.association.model",{},{init:function(e){e=e||{},this.elementGuid=e.guid||Math.guid(),this.data=e,this.leftProperties={},this.rightProperties={},this.properties={},this.xpathProperty=null,this.processData(e)},processData:function(e){for(var t=this.getLeftPropertiesModel(),i=this.getRightPropertiesModel(),n=0,o=t.length;n<o;n++){var r=t[n];r.value=e[r.property],r.displayValue=this.getDisplayValue(r),this.leftProperties[r.property]=r,this.properties[r.property]=r}for(n=0,o=i.length;n<o;n++){var a=i[n];a.value=e[a.property],a.displayValue=this.getDisplayValue(a),this.rightProperties[a.property]=a,this.properties[a.property]=a}},getDisplayValue:function(e){if(e.value){if("xpatheditor"==e.editor)return bizagi.editor.utilities.resolveComplexXpath(e.value);if("filter"==e.editor)return bizagi.editor.utilities.resolvefilterExpression(e.value);if("localizable"==e.editor)return bizagi.editor.utilities.resolvei18n(e.value)}},updateProperty:function(e,t,i){var n=this.properties[i];n&&(n.value=e,n.displayValue=t,this.cleanProperties(i))},cleanProperties:function(e){if("leftxpath"==e)for(var t=this.getLeftPropertiesModel(),i=1,n=t.length;i<n;i++){var o=t[i];this.leftProperties[o.property].value=null,this.leftProperties[o.property].displayValue=null}else if("rightxpath"==e){var r=this.getRightPropertiesModel();for(i=1,n=r.length;i<n;i++){var a=r[i];this.rightProperties[a.property].value=null,this.rightProperties[a.property].displayValue=null}}},update:function(e){this.processModel(e)},getFilter:function(e){var t=this.properties[e];return t?t.filterBy:""},getFilterTypes:function(e){var t=this.properties[e];return t?t.types:null},getRelatedEntity:function(e){var t=this.properties[e];return t?this.getPropertyValue(t.entity):null},getEntity:function(e){var t=this.properties[e];return t?t.entity:null},getPropertyValue:function(e){var t=this.properties[e];return t?t.value:null},getProperty:function(e){return this.properties[e]},getElementGuid:function(){return this.elementGuid},updateDependencies:function(){var e=bizagi.util.isEmpty(this.getPropertyValue("leftxpath"));for(var t in this.leftProperties)"leftxpath"!=t&&(this.leftProperties[t].readonly=e);var i=bizagi.util.isEmpty(this.getPropertyValue("rightxpath"));for(var n in this.rightProperties)"rightxpath"!=n&&(this.rightProperties[n].readonly=i)},isValid:function(){for(var e in this.properties)if(this.properties[e].required&&!this.properties[e].value)return!1;return!0},getViewModel:function(){return this.updateDependencies(),{leftProperties:this.getViewLeftPropertiesModel(),rightProperties:this.getViewRightPropertiesModel()}},getViewLeftPropertiesModel:function(){var e=[];for(var t in this.leftProperties)e.push(this.leftProperties[t]);return e},getViewRightPropertiesModel:function(){var e=[];for(var t in this.rightProperties)e.push(this.rightProperties[t]);return e},getLeftPropertiesModel:function(){var e=[];return e.push({property:"leftxpath",value:null,editor:"xpatheditor",filterBy:"xpathtocollection",readonly:!1,displayValue:null,required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-leftxpath")}),e.push({property:"leftdisplayattrib",value:null,editor:"xpatheditor",filterBy:"xpathfromentity",types:["string","number","date","boolean"],readonly:!0,displayValue:null,entity:"leftxpath",required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-leftdisplayattrib")}),e.push({property:"leftadditionalattrib",value:null,editor:"xpatheditor",filterBy:"xpathfromentity",types:["string","number","date","boolean"],readonly:!0,displayValue:null,entity:"leftxpath",title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-leftadditionalattrib")}),e.push({property:"leftfilter",value:null,editor:"filter",readonly:!0,displayValue:null,entity:"leftxpath",title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-leftfilter")}),e.push({property:"leftcaption",value:"",editor:"localizable",readonly:!0,displayValue:null,required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-leftcaption")}),e},getRightPropertiesModel:function(){var e=[];return e.push({property:"rightxpath",value:null,readonly:!1,editor:"xpatheditor",filterBy:"xpathtocollection",displayValue:null,required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-rightxpath")}),e.push({property:"rightdisplayattrib",value:null,editor:"xpatheditor",filterBy:"xpathfromentity",types:["string","number","date","boolean"],readonly:!0,displayValue:null,entity:"rightxpath",required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-rightdisplayattrib")}),e.push({property:"rightadditionalattrib",value:null,editor:"xpatheditor",filterBy:"xpathfromentity",types:["string","number","date","boolean"],readonly:!0,displayValue:null,entity:"rightxpath",title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-rightadditionalattrib")}),e.push({property:"rightfilter",value:null,editor:"filter",readonly:!0,displayValue:null,entity:"rightxpath",title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-rightfilter")}),e.push({property:"rightcaption",value:"",editor:"localizable",readonly:!0,displayValue:null,required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-association-editor-rightcaption")}),e},getPersistenceModel:function(e){var t={};for(var i in this.properties)this.properties[i].value&&(t[i]=this.properties[i].value);return t.factxpath=e.factxpath,t.guid=this.getElementGuid(),t.leftfactname=e.leftfactname,t.rightfactname=e.rightfactname,t}}),bizagi.editor.base.services=bizagi.editor.base.services||{},bizagi.editor.base.services.EndPoint=function(){function e(e,t,i,n,o){this._name=e,this._url=t,this._method=i,this._arguments=n,this._isArray=o}return e.prototype.getName=function(){return this._name},e.prototype.setName=function(e){this._name=e},e.prototype.getUrl=function(){return this._url},e.prototype.setUrl=function(e){this._url=e},e.prototype.getIsArray=function(){return this._isArray},e.prototype.setisArray=function(e){this._isArray=e},e.prototype.getMethod=function(){return this._method},e.prototype.setMethod=function(e){this._method=e},e.prototype.getArguments=function(){return this._arguments},e.prototype.setArguments=function(e){this._arguments=e},e.prototype.setHeaders=function(e){this._headers=e},e}(),bizagi.editor.base.services.EndPointArgument=function(){function e(e,t){this._name=e,this._type=t}return e.prototype.getName=function(){return this._name},e.prototype.setName=function(e){this._name=e},e.prototype.getType=function(){return this._type},e.prototype.setType=function(e){this._type=e},e}();var EndPointArgument=bizagi.editor.base.services.EndPointArgument,EndPointArgumentType,EndPointMethod;bizagi.editor.base.services.EndPointArgumentBuilder=function(){function e(){}return e.prototype.setName=function(e){return this._name=e,this},e.prototype.setType=function(e){return this._type=e,this},e.prototype.create=function(){if(null==this._name)throw"Name is null";if(null==this._type)throw"Type is null";return new EndPointArgument(this._name,this._type)},e}(),function(e){e[e.UrlPath=0]="UrlPath",e[e.QueryString=1]="QueryString",e[e.Body=2]="Body",e[e.Form=3]="Form"}(EndPointArgumentType||(EndPointArgumentType={})),bizagi.editor.base.services.EndPointBuilder=function(){function e(){this._name=null,this._url=null,this._method=null,this._arguments=null,this._headers=null,this._isArray=!1,this.EndPoint=bizagi.editor.base.services.EndPoint}return e.prototype.setName=function(e){return this._name=e,this},e.prototype.setUrl=function(e){return this._url=e,this},e.prototype.setMethod=function(e){return this._method=e,this},e.prototype.setArguments=function(e){return this._arguments=e,this},e.prototype.setIsArray=function(e){return this._isArray=e,this},e.prototype.create=function(){if(null==this._name)throw"Name is null";if(null==this._url)throw"Url is null";if(null==this._method)throw"Method is null";if(null==this._arguments)throw"Arguments is null";if(null==this._isArray)throw"isArray is null";return new this.EndPoint(this._name,this._url,this._method,this._arguments,this._isArray)},e}(),bizagi.editor.base.services.EndPointHeader=function(){function e(e,t){this._name=e,this._value=t}return e.prototype.getName=function(){return this._name},e.prototype.setName=function(e){this._name=e},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(e){this._value=e},e}(),function(e){e[e.GET=0]="GET",e[e.POST=1]="POST",e[e.PUT=2]="PUT",e[e.DELETE=3]="DELETE"}(EndPointMethod||(EndPointMethod={}));var EndPointBuilder=bizagi.editor.base.services.EndPointBuilder;bizagi.editor.base.services.EndPointsHelper=function(){function e(){}return e.prototype.getResource=function(){return(new EndPointBuilder).setName("getResource").setUrl(BIZAGI_URL_REST_SERVICES+"api/forms-designer/resources").setMethod(EndPointMethod[EndPointMethod.POST]).setArguments([]).create()},e.prototype.getMultiResources=function(){return(new EndPointBuilder).setName("getMultiResources").setUrl(BIZAGI_URL_REST_SERVICES+"api/forms-designer/multiresources").setMethod(EndPointMethod[EndPointMethod.POST]).setArguments([]).create()},new e}(),bizagi.editor.base.services.Manager=function(){function e(){}return e.prototype.requestRestService=function(e,t){if("undefined"!=typeof BIZAGI_EDITOR_TEST){var i=e.actiontype.toLowerCase();return promise=$.ajax({url:"jquery/editor/base/mocks/stub."+i+".json.txt",dataType:"json",async:!0}).pipe(function(e){return e}),promise}return $.ajax({url:t.getUrl(),data:JSON.stringify(e),type:t.getMethod(),contentType:"application/json; charset=utf-8",dataType:"json"})},new e}(),bizagi.editor.base.services.resourcesServices=function(){function e(){this._managerServices=bizagi.editor.base.services.Manager,this._endPointHelper=bizagi.editor.base.services.EndPointsHelper,this.batch={},this.batchTimer=50}return e.prototype.getResource=function(e){return this._managerServices.requestRestService(e,this._endPointHelper.getResource()).done(function(e){return $.isArray(e)?e[0]:e})},e.prototype.getMultiResources=function(e){return this.addResource(e)},e.prototype.addResource=function(e){var t=this,i=new $.Deferred;clearTimeout(t.batchTimeout);var n=e.tag=Math.guid(),o={request:e,deferred:i};return t.batch[n]=o,t.batchTimeout=setTimeout(function(){t.fire()},t.batchTimer),i.promise()},e.prototype.fire=function(){var e={},t=new $.Deferred,i=[];return $.each(this.batch,function(t,n){i.push(n),e[t]=n}),this.batch={},this._managerServices.requestRestService(i,this._endPointHelper.getMultiResources()).done(function(t){$.each(t,function(t,i){var n=i.response,o=n.tag;n.error?e[o].deferred.reject(n.error):e[o].deferred.resolve(n),delete e[o]})}),t.promise()},new e}(),bizagi.editor.base.constants=function(){var e={};e[e.DESKTOP=0]="DESKTOP",e[e.SMARTPHONE=1]="SMARTPHONE",e[e.TABLET=2]="TABLET",e[e.GENERIC=3]="GENERIC",e[e.OFFLINE=4]="OFFLINE",e[e.OFFLINE_DESKTOP=5]="OFFLINE_DESKTOP",e[e.OFFLINE_SMARTPHONE=6]="OFFLINE_SMARTPHONE",e[e.OFFLINE_TABLET=7]="OFFLINE_TABLET";return{DEVICES:e,SUPPORT_OFFLINE:"SUPPORT_OFFLINE"}}(),bizagi.editor.base.catalogServices=function(){var e=BIZAGI_URL_REST_SERVICES+"api/common/query",t=BIZAGI_URL_REST_SERVICES+"api/common/changeset",i=BIZAGI_URL_REST_SERVICES+"api/open-external-url/help",n={getAll:function(e){return o('{"select":[{"type":"#OBJTYPE#","data":"*"}]}'.replace("#OBJTYPE#",e))},getById:function(e){return o('{"select":[{"data":"*","where":{"id":["#GUIDLIST#"]}}]}'.replace("#GUIDLIST#",e))},getByIdWithChildren:function(e,t){return o('{"select":[{"data":"*","children":[{"type":"#CHILDRENTYPE#", "data":"*"}],"where":{"id":["#GUID#"]}}]}'.replace("#CHILDRENTYPE#",e).replace("#GUID#",t))},getShallowByIdWithChildren:function(e,t){return o('{"select":[{"children":[{"type":"#CHILDRENTYPE#", "data":"*"}],"where":{"id":["#GUID#"]}}]}'.replace("#CHILDRENTYPE#",e).replace("#GUID#",t))},getByIdWithoutObjectType:function(e){return o('{"select":[{"data":"*","where":{"id":["#GUIDLIST#"]}}]}'.replace("#GUIDLIST#",e))},getByName:function(e,t){return o('{"select":[{"type":"#OBJTYPE#","where":{"name":"#OBJNAME#"}}]}'.replace("#OBJTYPE#",e).replace("#OBJNAME#",t))},getByParentId:function(e,t){return o('{"select":[{"type":"#OBJTYPE#","data":"*","where":{"parentId":["#GUID#"]}}]}'.replace("#OBJTYPE#",e).replace("#GUID#",t))},getByParentIdAndTag:function(e,t,i){return o('{"select":[{"type":"#OBJTYPE#","data":"*","where":{"parentId":["#GUID#"],"tags":"#TAGSFILTER#"}}]}'.replace("#OBJTYPE#",e).replace("#GUID#",t).replace("#TAGSFILTER#",i))},getByTag:function(e,t){return o('{"select":[{"type":"#OBJTYPE#","data":"*","where":{"tags":"#TAGSFILTER#"}}]}'.replace("#OBJTYPE#",e).replace("#TAGSFILTER#",t))},getShallow:function(e){return o('{"select":[{"type":"#OBJTYPE#"}]}'.replace("#OBJTYPE#",e))},getShallowByParentId:function(e,t,i){return o('{"select":[{"type":"#OBJTYPE#","data":"#DATA#", "where":{"parentId":["#GUID#"]}}]}'.replace("#OBJTYPE#",e).replace("#GUID#",t).replace("#DATA#",i))},getShallowById:function(e){return o('{"select":[{"where":{"id":["#GUIDLIST#"]}}]}'.replace("#GUIDLIST#",e))},getShallowWithTag:function(e,t){return o('{"select":[{"type":"#OBJTYPE#","data":"#TAGS#"}]}'.replace("#OBJTYPE#",e).replace("#TAGS#",t))}};function o(t){return fetch(e,{method:"PUT",body:t,headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if("failed"===e.status)throw e.errorReason;return JSON.parse(e.result)})}return{getById:n.getById,getByParentId:n.getByParentId,getShallowByParentId:n.getShallowByParentId,getShallowById:n.getShallowById,getByParentIdAndTag:n.getByParentIdAndTag,saveChangeset:function(e){return fetch(t,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})},getWorkspaceId:function(){return new Promise(function(e){n.getAll("Workspace").then(function(t){e(t[0].id)})})},getByIdWithChildren:n.getByIdWithChildren,getShallowByIdWithChildren:n.getShallowByIdWithChildren,processContentForm:function(e){return new Promise(function(t){var i={actiontype:"ProcessFormContent",parameters:[{key:"formContent",value:JSON.stringify(e)}]};$.when(bizagi.editor.base.services.resourcesServices.getResource(i)).done(function(e){t(JSON.parse(e.result.parameters[0].value))})})},closeForm:function(e){return new Promise(function(t){var i={actiontype:"CloseForm",parameters:[{key:"forms",value:JSON.stringify(e)},{key:"guidContext",value:BIZAGI_IDENTIFIER_MODEL},{key:"user",value:BIZAGI_USER}]};$.when(bizagi.editor.base.services.resourcesServices.getResource(i)).done(function(e){t()})})},getFormType:function(e){return"searchform"==e?"SearchForm":"offlineform"==e?"Form":"queryform"==e?"Query":"startform"==e?"StartForm":"template"==e?"Template":"Form"},clearFormsCache:function(e){return new Promise(function(t){var i={actiontype:"CleanCacheForm",parameters:[{key:"idForms",value:JSON.stringify(e)},{key:"guidContext",value:BIZAGI_IDENTIFIER_MODEL},{key:"user",value:BIZAGI_USER}]};$.when(bizagi.editor.base.services.resourcesServices.getResource(i)).done(function(e){t()})})},getDevices:function(){return new Promise(function(e){$.when(bizagi.editor.base.services.resourcesServices.getResource({actiontype:"GetDevices",parameters:[]})).done(function(t){var i=JSON.parse(t.result.parameters[0].value);e(i)})})},openBizagiHelp:function(){return fetch(i)}}}(),bizagi.editor.base.asyncUtils=function(){return{each:function(e){var t=0,i=e.length;return function n(o){return o().then(function(){return i>++t?n(e[t]):Promise.resolve(!0)}).catch(function(){return Promise.reject(!1)})}(e[t])}}}(),bizagi.editor.base.appState=function(){var e,t,i,n,o,r,a,s,l,d=bizagi.editor.base.catalogServices,c=bizagi.editor.base.constants.DEVICES,u="71252A11-ED93-4444-8840-560C3A9BF093",p=Math.guid(),m=!1,h=!1;function f(e){var t=e.isActive;return s[e.id.toUpperCase()]&&e.type!=e.device&&(t=!1),{isActive:t,id:e.id,type:e.type,device:e.device,order:e.order,idForm:e.idForm,relatedView:e.relatedView,isPrincipal:e.isPrincipal,idOfflineForm:e.idOfflineForm}}function g(e){var i={viewSelected:f(e.viewSelected),model:e.model.map(f)};return{changeSet:[{action:"merge",deployOnParent:!1,id:p,name:"ActiveForm_"+p,type:"ActiveForm",parentId:t,modifiedByUser:BIZAGI_USER,content:JSON.stringify(i)}]}}return{init:function(f){var g;return e=f.isActivityForm,t=f.idForm,i=f.idParentForm,n=bizagi.util.parseBoolean(f.isSpecific),o=f.device,g=f.context,r="searchform"==g?"SearchForm":"offlineform"==g?"Form":"queryform"==g?"Query":"startform"==g?"StartForm":"template"==g?"Template":"Form",a=f.deviceId,m=Boolean(f.supportOffline),l=f.specificDeviceType,new Promise(function(m,f){d.getDevices().then(function(f){s=f.reduce(function(e,t){return t.IsActive&&(e[t.Id.toUpperCase()]=!0),e},{});var g,b,v,y=f.map(function(e){return{id:e.Id.toUpperCase(),displayName:e.DisplayName,isActive:e.IsActive,order:0,type:c.GENERIC,device:e.DeviceType,withChanges:!1,withError:!1,isPrincipal:!1,relatedView:u,portrait:e.Portrait,landscape:e.Landscape,offlineType:c.OFFLINE}}).sort(function(e,t){return e.device>t.device}),x=y.filter(function(e){return e.isActive}).sort(function(e,t){return e.device>t.device}),z=x[0];g=a,b=y,!e&&g&&g!=u&&(b=(b=b.filter(function(e){return e.id===g})).map(function(e){return e.isActive=!0,e})),y=b,e?d.getById(i).then(function(e){return Array.isArray(e)&&e.length>0&&(e=e[0].content,h="ComplexGateway"!=e.elementType),d.getByParentId("ActiveForm",t)}).then(function(e){if(e.length>0){var t=e[0];p=t.id;var i=t.content,n=i.viewSelected;z=f.find(function(e){return e.Id.toUpperCase()==n.id.toUpperCase()}),z=Object.assign({displayName:z.DisplayName,hasChanges:!1,withError:!1,portrait:z.Portrait,landscape:z.Landscape},n),y=i.model.map(function(e){var t=f.find(function(t){return e.id.toUpperCase()==t.Id.toUpperCase()});return t=t||{},Object.assign(e,{displayName:t.DisplayName,hasChanges:!1,withError:!1,portrait:t.Portrait,landscape:t.Landscape,isActive:e.isActive||t.IsActive})}),m({viewSelected:z,model:y})}else m({viewSelected:z,model:y})}):n||-1===(v=o,v=parseInt(v),Number.isNaN(v)?-1:v)?d.getShallowByParentId(r,t,"DeviceId,DeviceType").then(function(e){if(Array.isArray(e)&&e.length>0){l&&(e=e.filter(function(e){var t=e.tags.find(function(e){return"DeviceType"==e.name});return(t=t&&t.value)==l}));var t=!1,i=null,n=e.reduce(function(e,n){var o=n.tags.find(function(e){return"DeviceId"==e.name}),r=n.tags.find(function(e){return"DeviceType"==e.name});return o=o&&o.value,r=r&&r.value,e.map(function(e){if(e.id==o){var a=parseInt(r);if(a>=4){if(l){switch(a){case 4:e.type=c.GENERIC;break;case 6:e.type=c.SMARTPHONE;break;case 7:e.type=c.TABLET}t=!0}e.idOfflineForm=n.id,i=e.id}else e.idForm=n.id,e.type=a,e.relatedView=e.id;e.isActive=!0}return e})},y);t&&(n=n.filter(function(e){return e.id==i}));var o=(x=n.filter(function(e){return e.isActive}).sort(function(e,t){return e.device>t.device}))[0];m({viewSelected:o,model:n,isOffline:t})}else x=y.filter(function(e){return e.isActive}).sort(function(e,t){return e.device>t.device}),m({viewSelected:x[0],model:y})}):(x=y.filter(function(e){return e.isActive}).sort(function(e,t){return e.device>t.device}),m({viewSelected:x[0],model:y}))})})},save:function(i){e&&("StartForm"==r?d.getShallowById(t).then(function(e){Array.isArray(e)&&e.length>0&&d.saveChangeset(g(i))}):d.saveChangeset(g(i)))},setOffline:function(e){m=e,Promise.all([d.getById(t).then(function(t){if(t&&t.length>0){var i=t[0];i.content.supportOffline=e,d.saveChangeset({changeSet:[{action:"merge",deployOnParent:i.deployOnParent,id:i.id,name:i.name,type:i.type,parentId:i.parentId,modifiedByUser:BIZAGI_USER,content:JSON.stringify(i.content)}]})}}),d.clearFormsCache([t])])},getSupportOffline:function(){return m},getCanWorkOffline:function(){return h},GENERIC_VIEW_ID:u}}(),bizagi.editor=bizagi.editor||{},bizagi.editor.base=bizagi.editor.base||{},bizagi.editor.base.mappingform=function(){var e=bizagi.editor.base.constants.DEVICES,t={nestedform:"nestedform",form:"form"},i={nestedform:"nestedform",form:"form"},n={nestedform:"nestedform",offlineform:"offlineform",horizontal:"tablethorizontal",panel:"tabletpanel"},o={nestedform:"nestedform",offlineform:"offlineform",horizontal:"smartphonehorizontal",panel:"smartphonepanel"};function r(r,a){var s=r.type,l=function(r){if(r==e.SMARTPHONE)return t;if(r==e.TABLET)return i;if(r==e.OFFLINE_TABLET)return n;if(r==e.OFFLINE_SMARTPHONE)return o}(a)||{};switch(a){case e.DESKTOP:case e.OFFLINE:return s;case e.OFFLINE_SMARTPHONE:return s.includes("offlinesmartphone")?s:l[s]||s.replace("offline","offlinesmartphone");case e.OFFLINE_TABLET:return s.includes("offlinetablet")?s:l[s]||s.replace("offline","offlinetablet")}return r["widget-guid"]?s:l[s]||e[a].toLowerCase()+s}return{mappingForm:function(e,t){return e.elements=e.elements.map(function(e){return e.type=r(e,t),e.properties=$.extend(e.properties,{type:e.type}),Array.isArray(e.elements)&&(e=function e(t,i){return t.elements=t.elements.map(function(t){return t.type=r(t,i),t.properties=$.extend(t.properties,{type:t.type}),Array.isArray(t.elements)&&(t=e(t,i)),t}),t}(e,t)),e}),Array.isArray(e.result)&&(e.result=e.result.map(function(e){return e.type=r(e,t),e.properties=$.extend(e.properties,{type:e.type}),e})),e},mappingOfflineForm:function e(t,i){var n=["nestedform","startform","horizontal","panel","smartphonehorizontal","tablethorizontal","smartphonepanel","tabletpanel"];return t.elements=t.elements.map(function(t){var o=t.type;return t=n.includes(o)?t:factory.createElement("offline"+o,t),Array.isArray(t.elements)&&t.elements.length>0&&((t=e(t,i,factory)).elements=t.elements.filter(Boolean)),t}),t.element=t.elements.filter(Boolean),t}}}(),bizagi.editor.base.cloneService=function(){var e={},t={},i=bizagi.editor.base.catalogServices,n=bizagi.editor.base.services.resourcesServices,o=bizagi.editor.base.mappingform;function r(e,t,n){return new Promise(function(o){var r=[{action:"merge",deployOnParent:!0,id:e,name:"form_"+e,type:n,parentId:t,modifiedByUser:BIZAGI_USER,content:JSON.stringify({})}];i.saveChangeset({changeSet:r}).then(function(){setTimeout(function(){o()},1e3)})})}function a(e,t,n,o,r){var a=[{action:"merge",deployOnParent:!0,id:t,name:"form_"+t,type:r||s(e.type),parentId:n,modifiedByUser:BIZAGI_USER,content:JSON.stringify(e.getPersistenceModel(o))}],l=e.getLocalizablePropertiesModel(t).concat(e.getLocalizableValidationMessagesModel(t));return i.saveChangeset({changeSet:a.concat(l)})}function s(e){return"searchform"==e?"SearchForm":"offlineform"==e?"Form":"queryform"==e?"Query":"startform"==e?"StartForm":"template"==e?"Template":"Form"}function l(e,t,i){return new Promise(function(i,n){var r;r=t,e.form.deviceType==r.deviceType?i(e):(e.form=o.mappingForm(e.form,t.deviceType),i(e))})}function d(e){return new Promise(function(t,i){var o={actiontype:"CreateOfflineForm",parameters:[{key:"form",value:JSON.stringify(e.form)}]};$.when(n.getResource(o)).done(function(n){var o=n.result;if(o.success){var r=o.parameters[0].value;e.form=JSON.parse(r),t(e)}else i("The create offline form service failed")})})}function c(e,t){return new Promise(function(i,o){var r={actiontype:"CloneForm",parameters:[{key:"idForm",value:e},{key:"targetForm",value:t},{key:"guidContext",value:BIZAGI_IDENTIFIER_MODEL},{key:"user",value:BIZAGI_USER}]};$.when(n.getResource(r)).done(function(e){var t=e.result;if(t.success){var n=t.parameters.reduce(function(e,t){return e[t.key]=JSON.parse(t.value),e},{});i(n)}else o("The cloned service failed")})})}function u(e,t,n){var o="DeviceType = '"+(t.deviceType||"")+"' AND DeviceId = '"+(t.deviceId||"")+"'",r=t.context;return n=n||s(r),i.getByParentIdAndTag(n,e,o)}function p(t,i,n){e={},i.resources.forEach(function(t){var i=JSON.parse(t.Content);e[i.uri]={id:t.Id,content:i}});var o=n.context||"form",r=t.createElement(o,i.form,!0);return r.subscribe("getLocalizationObject",function(t,i){return function(t){var i=t.i18n,n=e[i.uri];if(n&&(delete e[i.uri],n.uri=t.newUri,e[t.newUri]=n),!n)return i;var o=n.content,r={};return(o.languages||[]).forEach(function(e){r[e.code]=e.value}),{uri:n.uri,default:o.defaultValue.replace(/\\\\/g,"\\").replace(/\\\"/g,'"'),languages:r}}(i)}),r.subscribe("getDeviceInfo",function(){return n}),r.subscribe("getResourceByUri",function(t,i){return e[i.uri]}),r.unsubscribeEvents=function(){r.unsubscribe("getLocalizationObject"),r.unsubscribe("getDeviceInfo"),r.unsubscribe("getResourceByUri")},function e(t,i){i.forEach(function(i){"container"==i.elementType&&e(t,i.elements),"cascadingcombo"==i.type.replace(/smartphone/,"").replace(/tablet/,"").replace(/offline/,"")&&function(e,t){var i=t.resolveProperty("parentcombo"),n=t.resolveProperty("childcombo");if(i){var o=e.getElementByOldGuid(i);t.assignProperty("parentcombo",o.guid)}if(n){var r=e.getElementByOldGuid(n);t.assignProperty("childcombo",r.guid)}}(t,i)})}(r,r.elements),r}return{processForm:p,copyForm:function(e,n,o){var r;return new Promise(function(a,s){i.getShallowById(n).then(function(e){return r=Array.isArray(e)&&e.length>0?e[0].type:void 0,u(n,o,r)}).then(function(i){c(i.length>0?i[0].id:n,o.idForm).then(function(e){return o.isOffline?"offlineform"==e.form.type?l(e,o):d(e).then(function(e){return l(e,o)}):l(e,o)}).then(function(i){var n=p(e,i,o);$.when(n.ready()).done(function(){o.isSpecific?n.resolveRelatedForms(t).then(function(){a({form:n,formType:r})}):a({form:n,formType:r})})})}).catch(function(e){s(e)})})},clone:function(e,n,o,s){var m=new Promise(function(m,h){var f;s=s||n,i.getShallowById(s).then(function(e){return f=e[0].type,u(s,o,f)}).then(function(i){if(i.length>0)m(i[0].id);else{var u=Math.guid();r(u,s,f).then(function(){c(n,u).then(function(e){return o.isOffline?o.isSpecific?d(e).then(function(e){return l(e,o)}):d(e):l(e,o)}).then(function(i){var n=p(e,i,o);$.when(n.ready()).done(function(){n.resolveRelatedForms(t).then(function(){a(n,u,s,o,f).then(function(){m(u)}).catch(function(e){h(e)})})})})}).catch(function(e){h(e)})}}).catch(function(e){h(e)})}),h=n+o.deviceType;return t[h]=m,m},processEntityForms:function(i,n,o){return t={},new Promise(function(u,m){r(o.idForm,o.idParentForm,s(o.context)).then(function(){c(n,o.idForm).then(function(e){return o.isOffline?d(e):l(e,o)}).then(function(n){var r=p(i,n,o);$.when(r.ready()).done(function(){var i=bizagi.clone(e);r.resolveRelatedForms(t).then(function(){a(r,o.idForm,o.idParentForm,o).then(function(){u({form:r,resources:i})}).catch(function(e){m(e)})})})})}).catch(function(e){m(e)})})},loadClonedForm:function(e,t){return new Promise(function(i,n){r(t.idForm,t.idParentForm,s(t.context)).then(function(){c(e,t.idForm).then(function(e){return l(e,t)}).then(function(e){p(factory,e,t)})}).catch(function(e){n(e)})})},buildOfflineForm:d}}(),bizagi.editor.notUndoableCommand.extend("bizagi.editor.cloneEntityFormsCommand",{},{execute:function(){var e=this,t=e.arguments,i=new $.Deferred;return bizagi.editor.base.cloneService.processEntityForms(e.model.elementFactory,t.sourceIdForm,t.deviceInfo).then(function(t){e.model.updateModel(t),i.resolve()}).catch(function(){console.log("ERROR Creating entity forms")}),t.result=i.promise(),!0}}),bizagi.editor.wizard.base("bizagi.editor.wizard.searchlist",{init:function(e,t){t=t||{},this._super(e,t),this.canvas=e,this.presenter=t.presenter,this.model=new bizagi.editor.wizard.searchlist.model(t.model,t.gridContextXpath)},loadTemplates:function(){var e={"wizard-container":bizagi.getTemplate("bizagi.editor.wizard.searchlist")+"#wizard-container-searchlist"};return this._super(e)},renderWizard:function(){var e=this,t=e.element;t.empty(),$.when(e.loadTemplates()).done(function(){var i=e.getTemplate("wizard-container");$.tmpl(i,e.model.getViewModel()).appendTo(t)})},refresh:function(){this.render()},updateProperty:function(e,t,i){return this.model.updateProperty(e,t,i)},getFilterProperty:function(e){return this.model.getFilter(e)},getFilterTypes:function(e){return this.model.getFilterTypes(e)},getRelatedEntity:function(e){return this.model.getRelatedEntity(e)},getPropertyValue:function(e){return this.model.getPropertyValue(e)},processFinishButton:function(){var e=this;e.model.isValid()?$.when(e.relationshipIsValid()).done(function(t){t.isValid?e.presenter.closePopup({success:!0,model:e.model.getPersistenceModel(t)}):bizagi.showMessageBox(bizagi.localization.getResource("bizagi-editor-wizard-searchlist-invalidrelationship"),"Bizagi","error",!1)}):bizagi.showMessageBox(bizagi.localization.getResource("bizagi-editor-wizard-searchlist-invalidmodel"),"Bizagi","error",!1)},getOffsetElement:function(e){var t=e.offset();return{top:t.top+e.outerHeight(!0),left:t.left}},buildComplexXpath:function(e){return bizagi.editor.utilities.buildComplexXpath(e.xpath,e.contextScope,e.isScopeAttribute,e.guidRelatedEntity)},resolveComplexXpath:function(e){return bizagi.editor.utilities.resolveComplexXpath(e)},clearPropertyValue:function(e){var t=e.data("property");this.updateProperty(void 0,"",t),this.refresh()},getMultipleRelationship:function(e){var t=new $.Deferred;return $.when(this.presenter.publish("getMultipleRelationship",e)).done(function(e){t.resolve()}),t.promise()},relationshipIsValid:function(){var e=new $.Deferred,t=(bizagi.editor.utilities.resolveRelatedEntityFromXpath(this.getPropertyValue("leftxpath")),bizagi.editor.utilities.resolveRelatedEntityFromXpath(this.getPropertyValue("rightxpath")));return $.when(this.presenter.publish("getMultipleRelationship",{leftEntity:this.getPropertyValue("leftxpath"),rightEntity:this.getPropertyValue("rightxpath")})).done(function(i){if(i)for(var n=i.leftfact,o=0,r=n.length;o<r;o++){var a=n[o];if(a.RightEntity==t){e.resolve({isValid:!0,factxpath:a.CatalogName,leftfactname:a.CatalogName});break}}else e.resolve(!1);e.resolve(!1)}),e.promise()},".bizagi_editor_component_editor_xpath .bz-wizard-searchlist-editor-xpath click":function(e){var t=this,i=e.prev("input"),n=e.data("property"),o={};o.position=t.getOffsetElement(i,o);var r=void 0;t.getFilterProperty(n)&&((r={}).typeFilter=t.getFilterProperty(n),o.typeEditor=r.typeFilter,t.getFilterTypes(n)&&(r.types=t.getFilterTypes(n))),o.filter=r,o.entity=t.resolveComplexXpath(t.getRelatedEntity(n)),o.xpath=t.resolveComplexXpath(t.getPropertyValue(n)),o.xpathProperty=n,o.allowCollection=!0,$.when(t.presenter.publish("showXPathNavigatorEditor",o)).done(function(e){var i=t.buildComplexXpath(e);t.updateProperty(i,t.resolveComplexXpath(i),n),t.refresh()})},".filter-searchList-mainDiv-value click":function(e){var t=this,i=e.data("property"),n=t.getPropertyValue(i),o={};o.data=n&&n.bafilter?n:{bafilter:{filter:"filter"}},o.entity=t.resolveComplexXpath(t.getRelatedEntity(i)),o.xpathNode=t.presenter.publish("getXpathData",{xpath:o.entity}),o.protocol="loadfilter";var r=bizagi.editor.communicationprotocol.factory.createProtocol(o);$.when(r.processRequest()).done(function(e){if(e){var n=e.isEmpty?void 0:bizagi.editor.utilities.buildComplexFilter(e,o.xpathNode);t.updateProperty(n,e,i),t.refresh()}})},".filter-searchList-mainDiv-rule click":function(e){var t=this,i=e.data("property"),n=t.getPropertyValue(i),o={};o.data=n&&n.rule?n:{rule:{baref:{ref:"expression"}}},o.categorytype="scripting",o.protocol="ruleexpression";var r=bizagi.editor.communicationprotocol.factory.createProtocol(o);$.when(r.processRequest()).done(function(e){e&&(t.updateProperty(e,e.rule.displayName,i),t.refresh())})},".filter-searchList-mainDiv-delete click":function(e){this.clearPropertyValue(e)},".biz-ico-default click":function(e){this.clearPropertyValue(e)},".editor-localizablestring-input input blur":function(e){var t=e.val(),i=e.data("property"),n=this.getPropertyValue(i),o=e.next(".editor-localizablestring-localization"),r=e.parent();if(o.removeClass("ui-control-fadeIn"),r.toggleClass("ui-control-focus"),t.length>0){if(bizagi.editor.utilities.isObject(n)){var a=bizagi.editorLanguage.key;"default"===a?n.i18n.default=t:n.i18n.languages[a]=t,t=n}else t=bizagi.editor.utilities.buildComplexLocalizable(t,this.model.getElementGuid(),i);this.updateProperty(t,bizagi.editor.utilities.resolvei18n(t),i),this.refresh()}},".editor-localizablestring-input input focus":function(e){var t=e.next(".editor-localizablestring-localization"),i=e.prev('input[type="text"]').parent();t.addClass("ui-control-fadeIn"),i.toggleClass("ui-control-focus")},".editor-localizablestring-input .editor-localizablestring-localization mouseenter":function(e){e.addClass("editor_localizablestring_fadeIn")},".editor-localizablestring-input .editor-localizablestring-localization mouseleave":function(e){e.removeClass("editor_localizablestring_fadeIn")},".editor-localizablestring-localization click":function(e){var t=this,i=e.prev("input").data("property"),n=t.getPropertyValue(i),o=t.model.getElementGuid();$.when(t.presenter.publish("setLocalization",{propertyName:i,propertyValue:n,elementGuid:o})).done(function(e){t.updateProperty(e,bizagi.editor.utilities.resolvei18n(e),i),t.refresh()})}}),bizagi.editor.observableClass.extend("bizagi.editor.wizard.searchlist.model",{},{init:function(e,t){e=e||{},this.elementGuid=e.guid||Math.guid(),this.data=e,this.leftProperties={},this.rightProperties={},this.properties={},this.xpathProperty=null,this.gridContextXpath=t,this.processData(e)},processData:function(e){for(var t=this.getLeftPropertiesModel(),i=this.getRightPropertiesModel(),n=0,o=t.length;n<o;n++){var r=t[n],a=r.value,s=r.displayValue;r.value=a||e[r.property],r.displayValue=s||this.getDisplayValue(r),this.leftProperties[r.property]=r,this.properties[r.property]=r}for(n=0,o=i.length;n<o;n++){var l=i[n];l.value=e[l.property],l.displayValue=this.getDisplayValue(l),this.rightProperties[l.property]=l,this.properties[l.property]=l}},getDisplayValue:function(e){if(e.value){if("xpatheditor"==e.editor)return bizagi.editor.utilities.resolveComplexXpath(e.value);if("filter"==e.editor)return bizagi.editor.utilities.resolvefilterExpression(e.value);if("localizable"==e.editor)return bizagi.editor.utilities.resolvei18n(e.value)}},updateProperty:function(e,t,i){var n=this.properties[i];n&&(n.value=e,n.displayValue=t,this.cleanProperties(i))},cleanProperties:function(e){if("leftxpath"==e)for(var t=this.getLeftPropertiesModel(),i=1,n=t.length;i<n;i++){var o=t[i];this.leftProperties[o.property].value=null,this.leftProperties[o.property].displayValue=null}else if("rightxpath"==e){var r=this.getRightPropertiesModel();for(i=1,n=r.length;i<n;i++){var a=r[i];this.rightProperties[a.property].value=null,this.rightProperties[a.property].displayValue=null}}},update:function(e){this.processModel(e)},getFilter:function(e){var t=this.properties[e];return t?t.filterBy:""},getFilterTypes:function(e){var t=this.properties[e];return t?t.types:null},getRelatedEntity:function(e){var t=this.properties[e];return t?this.getPropertyValue(t.entity):null},getEntity:function(e){var t=this.properties[e];return t?t.entity:null},getPropertyValue:function(e){var t=this.properties[e];return t?t.value:null},getProperty:function(e){return this.properties[e]},getElementGuid:function(){return this.elementGuid},updateDependencies:function(){var e=bizagi.util.isEmpty(this.getPropertyValue("leftxpath"));for(var t in this.leftProperties)"leftxpath"!=t&&(this.leftProperties[t].readonly=e);var i=bizagi.util.isEmpty(this.getPropertyValue("rightxpath"));for(var n in this.rightProperties)"rightxpath"!=n&&(this.rightProperties[n].readonly=i)},isValid:function(){for(var e in this.properties)if(this.properties[e].required&&!this.properties[e].value)return!1;return!0},getViewModel:function(){return this.updateDependencies(),{leftProperties:this.getViewLeftPropertiesModel(),rightProperties:this.getViewRightPropertiesModel()}},getViewLeftPropertiesModel:function(){var e=[];for(var t in this.leftProperties)e.push(this.leftProperties[t]);return e},getViewRightPropertiesModel:function(){var e=[];for(var t in this.rightProperties)e.push(this.rightProperties[t]);return e},getLeftPropertiesModel:function(){var e=[];return e.push({property:"leftxpath",value:null,editor:"xpatheditor",filterBy:"xpathtoentity",readonly:!1,displayValue:null,required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-searchlist-editor-leftxpath")}),e},getRightPropertiesModel:function(){var e=[];return e.push({property:"rightxpath",value:null,readonly:!1,editor:"xpatheditor",filterBy:"xpathtocollection",displayValue:null,required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-searchlist-editor-rightxpath")}),e.push({property:"rightdisplayattrib",value:null,editor:"xpatheditor",filterBy:"xpathfromentity",types:["string","number","date","boolean"],readonly:!0,displayValue:null,entity:"rightxpath",required:!0,title:bizagi.localization.getResource("bizagi-editor-wizard-searchlist-editor-rightdisplayattrib")}),e.push({property:"rightadditionalattrib",value:null,editor:"xpatheditor",filterBy:"xpathfromentity",types:["string","number","date","boolean"],readonly:!0,displayValue:null,entity:"rightxpath",title:bizagi.localization.getResource("bizagi-editor-wizard-searchlist-editor-rightadditionalattrib")}),e.push({property:"rightfilter",value:null,editor:"filter",readonly:!0,displayValue:null,entity:"rightxpath",title:bizagi.localization.getResource("bizagi-editor-wizard-searchlist-editor-rightfilter")}),e},getPersistenceModel:function(e){var t={};for(var i in this.properties)this.properties[i].value&&(t[i]=this.properties[i].value);return t.factxpath=e.factxpath,t.guid=this.getElementGuid(),t.leftfactname=e.leftfactname,t.rightfactname=e.rightfactname,t}}),bizagi.editor=bizagi.editor||{},bizagi.editor.overrides={EnableCssClassProperty:{group:{properties:{disable:["cssclass"]}},tab:{properties:{disable:["cssclass"]}},columncombo:{properties:{disable:["cssclass"]}},columndate:{properties:{disable:["cssclass"]}},columnboolean:{properties:{disable:["cssclass"]}},columnbutton:{properties:{disable:["cssclass"]}},columndocument:{properties:{disable:["cssclass"]}},columnformlink:{properties:{disable:["cssclass"]}},columnimage:{properties:{disable:["cssclass"]}},columnlabel:{properties:{disable:["cssclass"]}},columnletter:{properties:{disable:["cssclass"]}},columnlink:{properties:{disable:["cssclass"]}},columnlist:{properties:{disable:["cssclass"]}},columnmoney:{properties:{disable:["cssclass"]}},columnnumber:{properties:{disable:["cssclass"]}},columnradio:{properties:{disable:["cssclass"]}},columnsearch:{properties:{disable:["cssclass"]}},columnsuggest:{properties:{disable:["cssclass"]}},columntext:{properties:{disable:["cssclass"]}},columnupload:{properties:{disable:["cssclass"]}},columnuploadecm:{properties:{disable:["cssclass"]}},association:{properties:{disable:["cssclass"]}},boolean:{properties:{disable:["cssclass"]}},cascadingcombo:{properties:{disable:["cssclass"]}},combo:{properties:{disable:["cssclass"]}},contentpanel:{properties:{disable:["cssclass"]}},date:{properties:{disable:["cssclass"]}},document:{properties:{disable:["cssclass"]}},fileprint:{properties:{disable:["cssclass"]}},formlink:{properties:{disable:["cssclass"]}},grid:{properties:{disable:["cssclass"]}},groupedgrid:{properties:{disable:["cssclass"]}},image:{properties:{disable:["cssclass"]}},label:{properties:{disable:["cssclass"]}},letter:{properties:{disable:["cssclass"]}},link:{properties:{disable:["cssclass"]}},list:{properties:{disable:["cssclass"]}},money:{properties:{disable:["cssclass"]}},nestedform:{properties:{disable:["cssclass"]}},number:{properties:{disable:["cssclass"]}},panel:{properties:{disable:["cssclass"]}},radio:{properties:{disable:["cssclass"]}},search:{properties:{disable:["cssclass"]}},suggest:{properties:{disable:["cssclass"]}},tabitem:{properties:{disable:["cssclass"]}},text:{properties:{disable:["cssclass"]}},upload:{properties:{disable:["cssclass"]}},uploadecm:{properties:{disable:["cssclass"]}}}},bizagi.editor.modelerView.extend("bizagi.editor.templateView",{},{init:function(e){this._super(e)},load:function(e){var t=this;$.when(this.controller.ready()).done(function(){t.executeCommand({command:"loadModel",dataModel:e,canUndo:!1})})},save:function(){var e={command:"saveModel",dataModel:{},canUndo:!1};return this.executeCommand(e),e.dataModel},validateAndSaveForm:function(){this.performSave(!0)},updateForm:function(e){var t;t={command:"updateModel",data:e,canUndo:!1},this.executeCommand(t)},setOriginalModel:function(){var e=this;$.when(this.controller.ready()).done(function(){e.controller.setOriginalModel()})},processLayout:function(e){var t=this,i=new $.Deferred;t.mainContainer=$("<form-modeler />").addClass("container-layout"),t.mainContainer.appendTo(e.canvas||"body"),t.configureHtmlPage();var n=new bizagi.editor.component.layout.presenter({canvas:t.mainContainer,context:e.context,isActivityForm:e.isActivityForm});return $.when(n.render()).done(function(){setTimeout(function(){t.configureLeftPane(),t.drawRibbon(),t.configureTemplateView(),i.resolve()},100)}),i.promise()},configureHtmlPage:function(){this.mainContainer.addClass("biz-template-editor"),this.mainContainer.addClass("biz-text-color"),$("body").attr("oncontextmenu","return false")},configureLeftPane:function(){var e=this;$.when(e.drawXpathNavigator()).done(function(){e.mainContainer.find(".left-panel").tabs({}),e.mainContainer.find(".left-panel li[tabindex]:gt(0)").remove()})},configureKeyHandlers:function(){var e=this;$(document).keydown(function(e){}).keyup(function(t){46===t.keyCode&&($(document.activeElement).is("input, textarea")||e.deleteElement())}),$(document).on("keydown",function(t){17==t.keyCode&&e.controller.setCtrlKey(!0)}),$(document).on("keyup",function(t){e.controller.isCtrlKeyPressed()&&e.controller.setCtrlKey(!1)})},needsRedrawAfterTabChange:function(e){return this.currentTabIndex<2&&2===e||2===this.currentTabIndex&&e<2},setBannerVisibility:function(e){"show"===(e?$("a",e.newTab).attr("data-banner"):"hide")?this.showBanner():this.hideBanner()},preRender:function(e){this.validateForm&&e.canValidate&&this.processTemplateValidations({canRefresh:!1})},render:function(e,t){this.renderTemplate(e,t)},postRender:function(){var e=null;this.controller.thereAreMultiselection()&&(e=bizagi.editor.utilities.getGuidEmpty()),this.refreshRibbon(e)},refreshCanvas:function(){var e,t,i,n,o;e=$("#main-panel"),t=$(".wrapper-main-scroll"),i=$("> .bz-design-template",e),n=$(".top-scroll-grad",t),o=$(".bottom-scroll-grad",t);var r=parseFloat(e.css("padding-top"))+parseFloat(e.css("padding-bottom")),a=Math.floor(1*t.height()-r),s=t.position().top,l=t.position().top+t.outerHeight(!0)-o.height();i.prop("scrollHeight")>a?(e.addClass("biz-auto-height"),o.css("top",l).css("width",t.width()),o.show(),n.css("top",s).css("width",t.width()),n.show()):(o.hide(),n.hide(),e.removeClass("biz-auto-height")),e.hasClass("biz-auto-height")&&($(".top-scroll-grad",t).mouseover(function(){bizagi.util.autoScrollInterval.init||bizagi.util.autoScrollTopInterval(t,"panelOver","scrollGrad")}).mouseleave(function(){bizagi.util.autoScrollInterval.init||bizagi.util.removeAutoScroll("panelOver","scrollGrad")}),$(".bottom-scroll-grad",t).mouseover(function(){bizagi.util.autoScrollInterval.init||bizagi.util.autoScrollBottomInterval(t,"panelOver","scrollGrad")}).mouseleave(function(){bizagi.util.autoScrollInterval.init||bizagi.util.removeAutoScroll("panelOver","scrollGrad")}))},renderTemplate:function(e,t){this.showRenderingModel()},renderForm:function(e,t){var i=this,n=$("#main-panel");i.refreshRenderingView(e,t),i.controller.isActivityForm()&&(i.refreshButtonEditor(),"design"==i.renderingMode&&n.on("widgetComplete",function(){i.refreshCanvas()}),i.refreshCanvas())},renderSearchForm:function(e){this.refreshRenderingView(e),this.refreshSearchFormResult()},renderGridColumnEditor:function(){this.refreshGridColumnEditor()},enableLayoutTab:function(){this.mainContainer.find(".left-panel").tabs("option","disabled",[])},disableLayoutTab:function(){this.mainContainer.find(".left-panel").tabs("option","disabled",[2])}}),bizagi.editor.modelerView.extend("bizagi.editor.adhocModelerView",{},{init:function(e){var t=this;t.initializeForm(e),t.formModelerParams=e,e=e||{},t.renderingMode="design",t.validateForm=!1,bizagi.editor.view.prototype.init.apply(this,[e]),t.currentTabIndex=0,bizagi.editorLanguage={displayname:"default",IsRightToLeft:!1,key:"default"},e.data?$.when(t.load(e.data),this.controller.ready()).done(function(){t.processLayout(e)}):$.when(this.controller.ready()).done(function(){t.processLayout(e)}),e.autoGenerate&&t.autoGenerate(),t.setOriginalModel(),t.applyCustomOverrides()},configureLeftPane:function(){bizagi.form.modeler.params.reviewMode?this.showTabPropertiesInModeReadOnly():this.showAllTabs()},showTabPropertiesInModeReadOnly:function(){var e=this;$.when(e.drawXpathNavigator()).done(function(){e.mainContainer.find(".left-panel").tabs({beforeActivate:function(t,i){var n=$("a",i.newTab).data("rendering-mode");e.hidePropertyBox(),e.needsRedrawAfterTabChange(i.newTab.index())&&(e.currentSelectedElement=null,e.controller.removeSelectedElement(),e.renderingMode=n,e.render(n)),e.currentTabIndex=i.newTab.index(),e.setBannerVisibility(i),e.mainContainer.find(".bizagi_editor_xpathnavigator_container").css("pointer-events","none")}})})},showAllTabs:function(){var e=this;$.when(e.drawControlsNavigator(),e.drawXpathNavigator(),e.drawLayoutNavigator(),e.drawBanner()).done(function(){e.mainContainer.find(".left-panel").tabs({beforeActivate:function(t,i){var n=$("a",i.newTab).data("rendering-mode");e.hidePropertyBox(),e.needsRedrawAfterTabChange(i.newTab.index())&&(e.currentSelectedElement=null,e.controller.removeSelectedElement(),e.renderingMode=n,e.render(n)),e.currentTabIndex=i.newTab.index(),e.setBannerVisibility(i)}}),!e.controller.isAdhocFormContext()||!e.formModelerParams.data||e.formModelerParams.data.elements&&0!==e.formModelerParams.data.elements.length||e.selectControlsTab(),e.setBannerVisibility()})},configureHtmlPage:function(e){(this.adhocCanvas=e.canvas).addClass("biz-work-area"),$("body").attr("oncontextmenu","return false")},drawPropertyBox:function(e){var t=this;t.propertyBox&&t.hidePropertyBox(),t.redrawPropertyBox=!!e.redraw&&e.redraw,t.formModelerParams?t.propertyBox=new bizagi.editor.component.properties.presenter({adhocProcessId:t.formModelerParams.adhocProcessId}):t.propertyBox=new bizagi.editor.component.properties.presenter,t.propertyBox.subscribe("propertyChanged",function(e,i){return t.onPropertiesChanged(i)}),t.propertyBox.subscribe("getRenderElement",function(e,i){return t.onGetRenderElement(i)}),t.propertyBox.subscribe("destroy",function(e,i){t.hidePropertyBox(i)}),t.editorValidations={},t.guid=e.guid||t.currentSelectedElement,t.formProperties=!(!e||!e.formProperties),t.refreshPropertyBox()},showElementXpath:function(e){},selectControlsTab:function(){$('.ui-tabs-nav[role="tablist"] a[href="#left-tab-minitoolbar"]').trigger("click")},saveForm:function(){var e=this,t=$.Deferred(),i=e.getMainContainer();return $.when(e.executeCommand({command:"saveModel"})).done(function(n){var o={message:bizagi.localization.getResource("formmodeler-component-wait-message-save")},r=new bizagi.editor.component.wait.presenter({model:o,renderArea:i});$.when(r.render()).done(function(){var i=bizagi.editor.communicationprotocol.factory.createProtocol({protocol:"saveform",jsonForm:n,adhocTaskId:e.formModelerParams.adhocTaskId,adhocProcessId:e.formModelerParams.adhocProcessId,isAdhocSummaryForm:!!e.formModelerParams.isAdhocSummaryForm});setTimeout(function(){$.when(i.processRequest()).done(function(){e.controller.setNewForm(!1),e.controller.setOriginalModel(),e.refreshRibbon(),e.refreshPropertyBox(),$.when(e.controller.getXpathNavigatorFromServer()).done(function(){e.refreshXpathNavigator()}),t.resolve()}).fail(function(){t.reject()}).always(function(){r.destroy()})},200)})}),t.promise()},load:function(e){var t=this;return $.when(this.controller.ready()).done(function(){t.executeCommand({command:"loadModel",dataModel:e,canUndo:!1,refresh:!0})})},applyCustomOverrides:function(){bizagi.editor.component.properties.commands.allowdecimals.prototype.execute=function(){},bizagi.editor.component.properties.commands.numberrange.prototype.execute=function(){this.indexedProperty.notShow=!1},bizagi.editor.component.properties.commands.thousands.prototype.execute=function(){},bizagi.editor.component.properties.commands.defaultvalue.prototype.execute=function(){this.indexedProperty.notShow=!1},bizagi.editor.component.properties.commands.data.displayattrib.prototype.execute=function(){var e=this;e.element.properties.data.datasource&&"bizagi"===e.element.properties.data.datasource.type?(e.properties.data.displayattrib&&e.properties.data.displayattrib.xpath&&e.properties.data.displayattrib.xpath.baxpath&&e.properties.data.datasource.guid!==e.properties.data.displayattrib.xpath.baxpath.contextentity&&(e.element.properties.data.displayattrib=void 0),e.indexedProperty.show=!0):(e.element.properties.data.displayattrib=void 0,e.indexedProperty.show=!1)},bizagi.editor.component.properties.commands.data.sortattribute.prototype.execute=function(){var e=this;e.element.properties.data.datasource&&"bizagi"===e.element.properties.data.datasource.type?(e.properties.data.sortattribute&&e.properties.data.sortattribute.xpath&&e.properties.data.sortattribute.xpath.baxpath&&e.properties.data.datasource.guid!==e.properties.data.sortattribute.xpath.baxpath.contextentity&&(e.element.properties.data.sortattribute=void 0),e.indexedProperty.show=!0):(e.element.properties.data.sortattribute=void 0,e.indexedProperty.show=!1)}},changeXpathPropertyForElement:function(e,t,i){if(void 0!==this.editorValidations[e]&&!this.validateXpathChange(e,t,i))return;var n={command:"changeProperty",guid:e,property:t,value:"adhoc"==i.data.entityContext?i.guid:bizagi.editor.utilities.buildComplexXpath(i.xpath,i.contextScope,i.isScopeAttribute,i.guidRelatedEntity),refreshProperties:!0,removeDefaultDisplayName:!0,renderTypeProperty:i.nodeSubtype,validateForm:this.validateForm};this.editorValidations[e]&&void 0!==this.editorValidations[e].exclusive&&(n=$.extend({},n,{exclusive:this.editorValidations[e].exclusive})),this.executeCommand(n)},initializeForm:function(e){e.data||(e.data={properties:{displayName:"AdhocForm_"+Math.guid()}})},refreshXpathNavigator:function(e){var t=this;t.controller.isGridContext()?$.when(t.executeCommand({command:"getAdhocXpathNavigatorModel"})).done(function(i){t.controller.setXpathNavigatorModelGrid(i);var n={model:e&&e.model||i,context:e?e.context:void 0,scope:t.controller.getContext(),isReadOnly:t.controller.isReadOnlyForm()};t.xpathNavigator.render(n)}):t._super(e)}}),bizagi.editor=bizagi.editor||{},bizagi.editor.app=function(){var e=bizagi.editor.base.appState,t=bizagi.editor.base.constants.DEVICES,i=[{id:"E942C7F0-8382-460E-8847-C4257810DA1F",icon:"bz-desktop-32x32_black",errorIcon:"icon-desktop-warning",displayName:bizagi.localization.getResource("bizagi-editor-modal-deviceselector-desktop"),type:t.DESKTOP,color:"#33691E"},{id:"828269F1-642A-4146-A50B-711CA0705861",icon:"tablet-24x_1_",errorIcon:"icon-tablet-warning",displayName:bizagi.localization.getResource("bizagi-editor-modal-deviceselector-tablet"),type:t.TABLET,color:"#4274A7"},{id:"5E21E16C-7B33-430C-8841-B144A68A717B",icon:"phone-24x_1_",errorIcon:"icon-phone-warning",displayName:bizagi.localization.getResource("bizagi-editor-modal-deviceselector-smartphone"),type:t.SMARTPHONE,color:"#8BC34A"}],n={0:{module:"desktop",device:"Desktop"},1:{module:"smartphone_ios",device:"Smartphone"},2:{module:"tablet_ios",device:"Tablet"}};return createReactClass({getInitialState:function(){return this.mainRef=React.createRef(),this.params=this.props.params,this.idForm=this.params.idForm,this.idParentForm=this.params.idParentForm,this.isActivityForm=bizagi.util.parseBoolean(this.params.isActivityForm),this.getResource=bizagi.localization.getResource.bind(bizagi.localization),this._catalogServices=bizagi.editor.base.catalogServices,{model:[],viewSelected:void 0,isOpenOnboardingModal:!1,isOpenOfflineChangeModal:!1,openSaveFormModal:!1,openBackToDefault:!1,editOfflineFormModal:!1,restoreOfflineFormModal:!1}},componentDidMount:function(){var t=this;this.formInstances={},this.widgetsHash={},this.async=bizagi.editor.base.asyncUtils,this.resolveOfflineChange=null,e.init(t.params).then(function(e){t.setState(function(){return e},function(){t.state.isOffline?t.handleCreateOfflineForm(t.state.viewSelected,null,!1):t.handleChangeView(t.state.viewSelected)}),setTimeout(function(){var e=$("#tabulator-container").height()+1;$(window).resize(function(){t.setMainHeight(e)}),t.setMainHeight(e)},10)})},setMainHeight:function(e){var t=$(window).height()-e;$("main").height(t)},createGenericView:function(t){var i=this,o=e.GENERIC_VIEW_ID,r=new bizagi.editor.modelerView($.extend(this.params,{canvas:document.getElementById(o+"_online"),device:n[t.device].device,isNew:null==i.params.data,canWorkOffline:e.getCanWorkOffline()}));return r.subscribe("getViewSelected",function(){return i.handleGetViewSelected()}),r.subscribe("onChangeRotation",function(){i.handleChangeView(i.state.viewSelected)}),r.subscribe("onChangeForm",function(e,n){i.handleChangeForm(n.change,t)}),r.subscribe("onShowFormErrors",function(e,n){i.handleShowFormErrors(n.withError,t)}),r.subscribe("onFormSaved",function(){e.save(i.state)}),r.subscribe("onReadOnlyForm",function(e,t){i.handleReadOnlyForm(t.isReadOnly)}),r.subscribe("onSetOffline",function(t,i){e.setOffline(i.value)}),r.subscribe("onGetSupportOffline",function(){return e.getSupportOffline()}),r.subscribe("onEditOfflineForm",function(){i.handleValidationsToCreateAnSpecificOfflineForm(i.state.viewSelected)}),r.subscribe("onViewOfflineForm",function(){var e=i.state.viewSelected;i.formInstances[e.relatedView].offlineActive=!0;var t=i.formInstances[e.relatedView].offline;t.instance?(i.handleChangeForm(t.withChanges,e),i.handleShowFormErrors(t.withError,e),i.handleChangeView(e)):i.handleCreateSpecificOfflineForm()}),r.subscribe("onChangeOfflineMode",function(e,t){return i.handleOfflineChange(t.offlineState)}),r.subscribe("onDisableCustomButtons",function(){return i.handleDisableCustomButtons()}),r},createSpecificForm:function(i){var n,o=this,r=i.viewSelected,a=i.device,s=i.idForm,l=i.isNewForm,d=i.isEmpty;switch(a){case t.SMARTPHONE:n=new bizagi.editor.modelerSmartphoneView(this.getViewParams(r,t.SMARTPHONE,s,l,d));break;case t.TABLET:n=new bizagi.editor.modelerTabletView(this.getViewParams(r,t.TABLET,s,l,d));break;case t.DESKTOP:n=new bizagi.editor.modelerDesktopView(this.getViewParams(r,t.DESKTOP,s,l,d))}return n.subscribe("getViewSelected",function(){return o.handleGetViewSelected()}),n.subscribe("onChangeRotation",function(){o.handleChangeView(o.state.viewSelected)}),n.subscribe("onChangeForm",function(e,t){o.handleChangeForm(t.change,r)}),n.subscribe("onShowFormErrors",function(e,t){o.handleShowFormErrors(t.withError,r)}),n.subscribe("onFormSaved",function(){e.save(o.state)}),n.subscribe("onReadOnlyForm",function(e,t){o.handleReadOnlyForm(t.isReadOnly)}),n.subscribe("onSetOffline",function(t,i){e.setOffline(i.value)}),n.subscribe("onGetSupportOffline",function(){return e.getSupportOffline()}),n.subscribe("onEditOfflineForm",function(){o.handleValidationsToCreateAnSpecificOfflineForm(o.state.viewSelected)}),n.subscribe("onViewOfflineForm",function(){var e=o.state.viewSelected;o.formInstances[e.relatedView].offlineActive=!0;var t=o.formInstances[e.relatedView].offline;t.instance?(o.handleChangeForm(t.withChanges,e),o.handleShowFormErrors(t.withError,e),o.handleChangeView(e)):o.handleCreateSpecificOfflineForm()}),n.subscribe("onChangeOfflineMode",function(e,t){return o.handleOfflineChange(t.offlineState)}),n.subscribe("onDisableCustomButtons",function(){return o.handleDisableCustomButtons()}),n},getActiveInstance:function(){var e=this.formInstances[this.state.viewSelected.relatedView];return e.offlineActive?e.offline.instance:e.online.instance},getOfflineViewParams:function(t,i,o,r,a,s,l){var d=this.params,c=l?e.GENERIC_VIEW_ID:t.relatedView;return{context:"offlineform",contextentity:d.contextentity,contextentitytype:d.contextentitytype,supportOffline:e.getSupportOffline(),canWorkOffline:e.getCanWorkOffline(),deployOnParent:!0,canvas:document.getElementById(c+"_offline"),deviceType:i,deviceId:t.id,isSpecific:!0,idForm:o,idParentForm:this.idForm,isNew:r,isActivityForm:this.isActivityForm,isVersionable:!1,scopedefinition:d.scopedefinition,idSourceForm:s,isEmpty:a||!1,isDefault:t.isPrincipal,isOffline:!0,isSpecific:!0,device:n[t.device].device,isDefault:t.isPrincipal}},getViewParams:function(t,i,n,o,r){var a=this.params,s=t.relatedView+"_online";return{context:a.context,contextentity:a.contextentity,contextentitytype:a.contextentitytype,supportOffline:e.getSupportOffline(),canWorkOffline:e.getCanWorkOffline(),deployOnParent:!0,canvas:document.getElementById(s),deviceType:i,deviceId:t.id,isSpecific:!0,idForm:n,idParentForm:this.idForm,isNew:o,isActivityForm:this.isActivityForm,isVersionable:!1,scopedefinition:a.scopedefinition,idSourceForm:this.state.customizeFrom,isEmpty:r||!1,isDefault:t.isPrincipal}},loadSubModule:function(e){return new Promise(function(t){var i=bizagi.loader;if(i.isModuleLoaded("formModeler",e))return t();i.internalLoadModule("formModeler",e).then(function(){i.whenModuleLoaded("formModeler",function(){t()},e)})})},restoreCase:function(e){e.css({"border-image-source":"",height:"",width:"","border-image-slice":"","border-width":""})},setCase:function(e,t){null==t.Image?e.css({height:t.Height,width:t.Width}):e.css({"border-image-source":"url('data:image;base64,"+t.Image.replace(/(\r\n|\n|\r)/gm,"")+"')",height:t.Height,width:t.Width,"border-image-slice":t.BorderImageSlice,"border-width":t.BorderImageSlice.replace(/(\d)+/g,function(){return arguments[0]+"px"})})},handleReadOnlyForm:function(e){e=Boolean(e);var t=this.state.viewSelected;this.formInstances[t.relatedView]&&(this.formInstances[t.relatedView].online.isReadOnly=e);var i=this.state.model.map(function(i){return t.relatedView==i.relatedView&&(i.isReadOnly=e),i}),n=i.find(function(e){return e.id==t.id});this.setState({model:i,viewSelected:n})},handleShowFormErrors:function(e,t){var i=this,n=i.formInstances[t.relatedView];n.offlineActive?n.offline.withError=e:n.online.withError=e;var o=i.state.model.map(function(i){return i.relatedView==t.relatedView&&(i.withError=e),i}),r=o.find(function(e){return e.id==i.state.viewSelected.id});i.setState({model:o,viewSelected:r})},handleChangeForm:function(e,t){var i=this,n=i.formInstances[t.relatedView];n.offlineActive?n.offline.withChanges=e:n.online.withChanges=e;var o=i.state.model.map(function(i){return i.relatedView==t.relatedView&&(i.withChanges=e),i}),r=o.find(function(e){return e.id==i.state.viewSelected.id});i.setState({model:o,viewSelected:r})},handleChangeView:function(e,i,o){var r,a=this,s=(e=i?e:a.getRelatedView(e)).id,l=n[e.device],d=e.idForm||Math.guid();switch(e.type){case t.GENERIC:Promise.resolve(this.loadSubModule(l.module)).then(function(){var n=!Boolean(i),o=e.relatedView;if(Boolean(a.formInstances[o])){var s=a.formInstances[o];e.device==t.DESKTOP&&(s.offlineActive=!1),r=s.offlineActive?s.offline.instance:s.online.instance}else{var d;if(Boolean(e.relatedViewInfo)){var c=e.relatedViewInfo;d=a.createSpecificForm({viewSelected:c,device:c.device,idForm:c.idForm,isNewForm:!1,isEmpty:!1})}else d=a.createGenericView(e);a.formInstances[o]={online:{instance:d,withChanges:!1,withError:!1},offline:{},offlineActive:!1},r=d}r.setDevice(l.device);var u=!a.widgetsHash[l.device]&&r.loadWidgetDefinitions();$.when(r.ready(),u).done(function(){var i=r.getMainContainer(),o=r.getMainWrapper();if(r.getWrapperScroll().addClass("biz__mode--dsf"),a.restoreCase(o),["view__smartphone","view__tablet"].forEach(function(e){o.removeClass(e)}),i.removeClass("view__tablet"),e.device==t.SMARTPHONE)o.addClass("view__smartphone"),a.setCase(o,e.landscape||e.portrait);else if(e.device==t.TABLET){o.addClass("view__tablet"),i.addClass("view__tablet");var s=e[r.getOrientation()||"portrait"];a.setCase(o,s)}else a.setCase(o,e.landscape||e.portrait);a.widgetsHash[l.device]=!0,n&&r.refresh()})});break;case t.SMARTPHONE:if(Boolean(a.formInstances[s])){var c=a.formInstances[s];r=c.offlineActive?c.offline.instance:c.online.instance}else a.formInstances[s]={online:{instance:a.createSpecificForm({viewSelected:e,device:t.SMARTPHONE,idForm:d,isNewForm:i,isEmpty:o}),withChanges:!1,withError:!1},offline:{},offlineActive:!1},r=a.formInstances[s].online.instance;$.when(r.ready()).done(function(){var t=r.getMainWrapper();r.getWrapperScroll().addClass("biz__mode--dsf"),a.restoreCase(t),t.addClass("view__smartphone"),a.setCase(t,e.landscape||e.portrait),r.refresh()});break;case t.TABLET:if(Boolean(a.formInstances[s])){c=a.formInstances[s];r=c.offlineActive?c.offline.instance:c.online.instance}else a.formInstances[s]={online:{instance:a.createSpecificForm({viewSelected:e,device:t.TABLET,idForm:d,isNewForm:i,isEmpty:o}),withChanges:!1,withError:!1},offline:{},offlineActive:!1},r=a.formInstances[s].online.instance;$.when(r.ready()).done(function(){var t=r.getMainContainer(),i=r.getMainWrapper();r.getWrapperScroll().addClass("biz__mode--dsf"),a.restoreCase(i),i.addClass("view__tablet"),t.addClass("view__tablet");var n=e[r.getOrientation()||"portrait"];a.setCase(i,n),r.refresh()});break;case t.DESKTOP:Boolean(a.formInstances[s])?r=a.formInstances[s].online.instance:(a.formInstances[s]={online:{instance:a.createSpecificForm({viewSelected:e,device:t.DESKTOP,idForm:d,isNewForm:i,isEmpty:o}),withChanges:!1,withError:!1},offline:{},offlineActive:!1},r=a.formInstances[s].online.instance),$.when(r.ready()).done(function(){var t=r.getMainWrapper();r.getWrapperScroll().addClass("biz__mode--dsf"),a.restoreCase(t),a.setCase(t,e.landscape||e.portrait),r.refresh()})}},handleViewWillChange:function(e){this.setState(function(){return{viewSelected:e,viewToShow:e.relatedView}},function(){this.handleChangeView(e)})},handleUpdateDevice:function(e){var t=this,i=this.state.viewSelected;!!e.find(function(e){return e.id===i.id&&e.isActive})||(i=e.find(function(e){return e.isActive})),this.setState(function(t){return{model:e,viewSelected:i}},function(){t.handleChangeView(i)})},handleRestoreOfflineForm:function(){var t=this,i=this.state.viewSelected,n=i.idOfflineForm;t.formInstances[i.relatedView].offlineActive=!1;var o=this.state.model.map(function(e){return i.relatedView==e.relatedView&&delete e.idOfflineForm,e}),r=o.find(function(e){return e.id==i.id});this.setState(function(e){return{model:o,viewSelected:r}},function(){Promise.all([t._catalogServices.saveChangeset({changeSet:[{action:"delete",ids:[n]}]}),t._catalogServices.clearFormsCache([n])]).then(function(){t.formInstances[i.relatedView].offline={instance:null,withChanges:!1,withError:!1},t.formInstances[i.relatedView].online.instance.refresh(),e.save(t.state)})})},handleRestoreToDefaultForm:function(){var i,n,o=this,r=this.state.viewSelected,a=[],s=this.state.model.find(function(e){return e.device==r.device&&e.isPrincipal}),l=s&&s.id!=r.id&&s.id,d=this.state.model.map(function(s){return s.id==r.id?(s.type=t.GENERIC,s.isPrincipal=!1,i=s.idForm,a.push(i),(n=s.idOfflineForm)&&a.push(n),delete s.idForm,delete s.idOfflineForm,Boolean(l)?(s.relatedView=l,o.formInstances[l]&&(s.isReadOnly=o.formInstances[l].online.isReadOnly)):(s.relatedView=e.GENERIC_VIEW_ID,o.formInstances[e.GENERIC_VIEW_ID]&&(s.isReadOnly=o.formInstances[e.GENERIC_VIEW_ID].online.isReadOnly))):s.relatedView==r.id&&(l?(s.relatedView=l,o.formInstances[l]&&(s.isReadOnly=o.formInstances[l].online.isReadOnly)):(s.relatedView=e.GENERIC_VIEW_ID,o.formInstances[e.GENERIC_VIEW_ID]&&(s.isReadOnly=o.formInstances[e.GENERIC_VIEW_ID].online.isReadOnly)),delete s.idOfflineForm),s}),c=d.find(function(e){return e.id==r.id});this.setState(function(e){return{model:d,viewSelected:c}},function(){Promise.all([o._catalogServices.saveChangeset({changeSet:[{action:"delete",ids:a}]}),o._catalogServices.clearFormsCache(a)]).then(function(){delete o.formInstances[r.id],o.handleChangeView(c)})})},handleCloseForm:function(i){var n=this,o=[],r=[];for(var a in n.formInstances){var s=n.formInstances[a];["online","offline"].forEach(function(e){var t=s[e]||{},i=t.instance;t.withChanges&&r.push({form:i,device:a,isOffline:"offline"==e}),i&&o.push(i.controller.getIdForm())})}if(r.length>0&&!Boolean(i)){var l=[];r.forEach(function(e){var i,o,r,a,s=n.state.model.find(function(i){return e.isOffline?i.isActive&&i.device!=t.DESKTOP&&i.relatedView==e.device:i.isActive&&i.relatedView==e.device});l.push((i=s,o=e.form,r=e.device,a=e.isOffline,function(){return new Promise(function(e,t){n.setState({viewSelected:i},function(){n.formInstances[r].offlineActive=Boolean(a),n.handleChangeView(i),o.performCloseDesigner(i).then(function(){e()}).catch(function(){t()})})})}))}),n.async.each(l).then(function(){e.save(n.state),n._catalogServices.closeForm(o)}).catch(function(){console.log("the close event was canceled")})}else e.save(n.state),n._catalogServices.closeForm(o)},handleOfflineChange:function(e){var t=this;return new Promise(function(i,n){t.setState({isOpenOfflineChangeModal:!0,offlineNewStateEnabled:e}),t.resolveOfflineChange=i})},helperCreateOfflineForm:function(){var e=this.state.viewSelected,t=this.getRelatedForm(e),i=e.idOfflineForm||Math.guid(),n=this.state.model.map(function(t){return t.relatedView==e.relatedView&&(t.idOfflineForm=i),t});return{model:n,viewSelected:n.find(function(t){return t.id===e.id}),customizeFrom:t}},helperCreateForm:function(){var e=this.state.viewSelected,t=this.getRelatedForm(e),i=Math.guid(),n=this.state.model.map(function(t){return t.id==e.id&&(t.type=t.device,t.idForm=i,t.relatedView=e.id,t.idOfflineForm=void 0),t});return{model:n,viewSelected:n.find(function(t){return t.id===e.id}),customizeFrom:t}},handleCreateEmptySpecificForm:function(){var e=this;this.setState(this.helperCreateForm,function(){e.handleChangeView(e.state.viewSelected,!0,!0)})},handleCreateSpecificForm:function(){var e=this;this.setState(this.helperCreateForm,function(){e.handleChangeView(e.state.viewSelected,!0)})},handleCreateEmptySpecificOfflineForm:function(){var e=this,t=e.state.viewSelected,i=!Boolean(t.idOfflineForm);e.formInstances[t.relatedView]&&(e.formInstances[t.relatedView].offlineActive=!0),this.setState(this.helperCreateOfflineForm,function(){e.handleCreateOfflineForm(e.state.viewSelected,e.state.customizeFrom,i)})},handleCreateSpecificOfflineForm:function(){var e=this,t=e.state.viewSelected,i=!Boolean(t.idOfflineForm);e.formInstances[t.relatedView]&&(e.formInstances[t.relatedView].offlineActive=!0),this.setState(this.helperCreateOfflineForm,function(){e.handleCreateOfflineForm(e.state.viewSelected,e.state.customizeFrom,i)})},handleGetViewSelected:function(){return this.state.viewSelected},createOfflineForm:function(i,n,o,r,a){var s,l=this;switch(i.type){case t.GENERIC:s=new bizagi.editor.modelerView(l.getOfflineViewParams(i,t.OFFLINE,n,o,r,a,!0));break;case t.SMARTPHONE:s=new bizagi.editor.modelerSmartphoneView(this.getOfflineViewParams(i,t.OFFLINE_SMARTPHONE,n,o,r,a));break;case t.TABLET:s=new bizagi.editor.modelerTabletView(this.getOfflineViewParams(i,t.OFFLINE_TABLET,n,o,r,a))}return s.subscribe("getViewSelected",function(){return l.handleGetViewSelected()}),s.subscribe("onChangeRotation",function(){l.handleChangeView(l.state.viewSelected)}),s.subscribe("onChangeForm",function(e,t){l.handleChangeForm(t.change,i)}),s.subscribe("onShowFormErrors",function(e,t){l.handleShowFormErrors(t.withError,i)}),s.subscribe("onSetOffline",function(t,i){e.setOffline(i.value)}),s.subscribe("onGetSupportOffline",function(){return e.getSupportOffline()}),s.subscribe("onViewOnlineForm",function(){var e=l.state.viewSelected;l.formInstances[e.relatedView].offlineActive=!1;var t=l.formInstances[e.relatedView].online;l.handleChangeForm(t.withChanges,e),l.handleShowFormErrors(t.withError,e),t.instance.resetStatusBar(),l.handleChangeView(e)}),s.subscribe("onRestoreOfflineForm",function(){l.toggleRestoreOfflineForm()}),s.subscribe("onChangeOfflineMode",function(e,t){return l.handleOfflineChange(t.offlineState)}),l.formInstances[i.relatedView]?(l.formInstances[i.relatedView].offline={instance:s,withError:!1,withChanges:!1},l.formInstances[i.relatedView].offlineActive=!0):l.formInstances[i.relatedView]={offline:{instance:s,withError:!1,withChanges:!1},online:{},offlineActive:!0},s},handleCreateOfflineForm:function(e,i,o){var r,a=this,s=(e=o?e:a.getOfflineRelatedView(e)).type,l=n[e.device],d=e.idOfflineForm||Math.guid();switch(s){case t.GENERIC:Promise.resolve(this.loadSubModule(l.module)).then(function(){if(Boolean(a.formInstances[e.id])||o)r=a.createOfflineForm(e,d,o,!1,i);else{var n=e.relatedViewInfo||e;r=a.createOfflineForm(n,d,o,!1,i)}$.when(r.ready()).done(function(){var i=r.getMainContainer(),n=r.getMainWrapper();if(r.getWrapperScroll().addClass("biz__mode--dsf"),a.restoreCase(n),["view__smartphone","view__tablet"].forEach(function(e){n.removeClass(e)}),i.removeClass("view__tablet"),e.device==t.SMARTPHONE)n.addClass("view__smartphone"),a.setCase(n,e.landscape||e.portrait);else if(e.device==t.TABLET){n.addClass("view__tablet"),i.addClass("view__tablet");var o=e[r.getOrientation()||"portrait"];a.setCase(n,o)}else a.setCase(n,e.landscape||e.portrait)})});break;case t.SMARTPHONE:r=a.createOfflineForm(e,d,o,!1,i),$.when(r.ready()).done(function(){var t=r.getMainWrapper();r.getWrapperScroll().addClass("biz__mode--dsf"),a.restoreCase(t),t.addClass("view__smartphone"),a.setCase(t,e.landscape||e.portrait),r.refresh()});break;case t.TABLET:r=a.createOfflineForm(e,d,o,!1,i),$.when(r.ready()).done(function(){var t=r.getMainContainer(),i=r.getMainWrapper();r.getWrapperScroll().addClass("biz__mode--dsf"),a.restoreCase(i),i.addClass("view__tablet"),t.addClass("view__tablet");var n=e[r.getOrientation()||"portrait"];a.setCase(i,n),r.refresh()})}return r},handleValidationsToCreateAnSpecificForm:function(e){var t=this,i=t.formInstances[e.relatedView].online.instance;$.when(i.thereAreChangesInForm()).done(function(e){e?t.toggleSaveFormModal():t.toggleOnboardingModal()})},handleValidationsToCreateAnSpecificOfflineForm:function(e){var t=this,i=t.formInstances[e.relatedView].online.instance;$.when(i.thereAreChangesInForm()).done(function(e){e?t.toggleSaveFormModal():t.toggleEditOfflineForm()})},getOfflineType:function(e){switch(e){case t.GENERIC:return t.OFFLINE;case t.SMARTPHONE:return t.OFFLINE_SMARTPHONE;case t.TABLET:return t.OFFLINE_TABLET;default:return t.OFFLINE}},handleSetAsMaster:function(e){var t=this,i=this.state.model.find(function(t){return t.device==e.device&&t.isPrincipal}),n=this.state.model.map(function(t){return t.device==e.device&&(t.isPrincipal=t.id==e.id,t.type!=t.device&&(t.relatedView=e.id)),t}),o=n.find(function(e){return e.id==t.state.viewSelected.id}),r=t.formInstances[o.id],a=r.online.instance;Promise.all([a.setAsDefault(),a.setAsDefaultOfflineForm(e.idOfflineForm,t.getOfflineType(e.type))]).then(function(){t.setState(function(){return{model:n,viewSelected:o}},function(){i&&(r=t.formInstances[i.id]&&t.formInstances[i.id].online)&&(r.instance.isDefault=!1)})}).catch(function(){console.log("ERROR SETTING THIS FORM HOW AS DEFAULT")})},buildOnboardingModal:function(){var e=this.getResource("bizagi-editor-modal-onboarding-button-create-inherited"),t=this.getResource("bizagi-editor-modal-onboarding-button-create-empty"),i=this.getResource("bizagi-editor-modal-onboarding-title");return DIV({key:4},React.createElement(bizagi.editor.app.modal,{show:this.state.isOpenOnboardingModal,onClose:this.toggleOnboardingModal,title:i,width:500,height:350,buttons:[{displayName:t,handler:this.handleCreateEmptySpecificForm},{displayName:e,handler:this.handleCreateSpecificForm,style:{border:"none",color:"white",backgroundColor:"#91AD1F"}}]},React.createElement(bizagi.editor.app.specificFormsOnboarding)))},buildOfflineChangeModal:function(){var e=this.getResource("bizagi-editor-modal-offline-change-title"),t=this.state.offlineNewStateEnabled?this.getResource("bizagi-editor-modal-offline-change-message-enable"):this.getResource("bizagi-editor-modal-offline-change-message-disable"),i=this.getResource("bizagi-editor-modal-offline-change-message-bold"),n=this.getResource("bizagi-editor-modal-offline-change-note"),o=this.getResource("bizagi-editor-modal-offline-change-confirm"),r=this.getResource("bizagi-editor-modal-offline-change-cancel");return DIV({key:10,className:"modal__offline"},React.createElement(bizagi.editor.app.modal,{show:this.state.isOpenOfflineChangeModal,onClose:this.toggleOfflineChangeModal,cancel:this.cancelOfflineWork,title:e,buttons:[{displayName:r,handler:this.cancelOfflineWork},{displayName:o,handler:this.confirmOfflineWork,style:{border:"none",color:"white",backgroundColor:"#5D801D"}}]},DIV({className:"modal__container"},P({className:"modal__text"},t),P({className:"modal__question"},i),P({className:"modal__note",style:{marginBottom:0}},n))))},buildSaveFormModal:function(){var e=this.getResource("bizagi-editor-modal-save-message"),t=this.getResource("bizagi-editor-modal-save-title");return DIV({key:5},React.createElement(bizagi.editor.app.modal,{show:this.state.openSaveFormModal,onClose:this.toggleSaveFormModal,title:t,width:400,height:350,buttons:[{displayName:"Ok",style:{border:"none",color:"white",backgroundColor:"#F82B60"}}]},DIV({className:"app__modal-container"},P({},e))))},builEditOfflineFormModal:function(){var e=this.getResource("bizagi-editor-modal-offline-title"),t=this.getResource("bizagi-editor-modal-offline-question"),i=this.getResource("bizagi-editor-modal-offline-message"),n=this.getResource("bizagi-editor-modal-offline-note"),o=this.getResource("bizagi-editor-modal-offline-appove"),r=this.getResource("bizagi-editor-modal-offline-reject");return DIV({key:8},React.createElement(bizagi.editor.app.modal,{show:this.state.editOfflineFormModal,onClose:this.toggleEditOfflineForm,width:400,height:350,title:e,buttons:[{displayName:r},{displayName:o,handler:this.handleCreateSpecificOfflineForm,style:{border:"none",color:"white",backgroundColor:"#657915"}}]},DIV({className:"app__modal-container"},SPAN({className:"modal__offline-question"},t),P({className:"modal__back-message",style:{marginBottom:0}},i),P({className:"modal__offline-note",style:{marginBottom:0}},n))))},builRestoreOfflinePreviewModal:function(){var e=this.getResource("bizagi-editor-modal-offline-restore-title"),t=this.getResource("bizagi-editor-modal-offline-restore-question"),i=this.getResource("bizagi-editor-modal-offline-restore-message"),n=this.getResource("bizagi-editor-modal-offline-restore-appove"),o=this.getResource("bizagi-editor-modal-offline-restore-reject");return DIV({key:9},React.createElement(bizagi.editor.app.modal,{show:this.state.restoreOfflineFormModal,onClose:this.toggleRestoreOfflineForm,width:400,height:350,title:e,buttons:[{displayName:o},{displayName:n,handler:this.handleRestoreOfflineForm,style:{border:"none",color:"white",backgroundColor:"#DA3B3B"}}]},DIV({className:"app__modal-container"},SPAN({className:"modal__offline-question"},t),P({className:"modal__back-message",style:{marginBottom:0}},i))))},buildRestoreToDefaultFormModal:function(){var e=this.getResource("bizagi-editor-modal-backtogeneric-title"),t=this.getResource("bizagi-editor-modal-backtogeneric-question"),i=this.getResource("bizagi-editor-modal-backtogeneric-message"),n=this.getResource("bizagi-editor-modal-backtogeneric-ok"),o=this.getResource("bizagi-editor-modal-backtogeneric-cancel");return DIV({key:6},React.createElement(bizagi.editor.app.modal,{show:this.state.openBackToDefault,onClose:this.toggleRestoreToDefaultFormModal,width:400,height:350,title:e,buttons:[{displayName:o},{displayName:n,handler:this.handleRestoreToDefaultForm,style:{border:"none",color:"white",backgroundColor:"#F82B60"}}]},DIV({className:"app__modal-container"},P({className:"modal__back-message"},i),SPAN({className:"modal__back-question"},t))))},toggleRestoreOfflineForm:function(){this.setState(function(e){return{restoreOfflineFormModal:!e.restoreOfflineFormModal}})},toggleEditOfflineForm:function(){this.setState(function(e){return{editOfflineFormModal:!e.editOfflineFormModal}})},toggleSaveFormModal:function(){this.setState(function(e){return{openSaveFormModal:!e.openSaveFormModal}})},toggleRestoreToDefaultFormModal:function(){this.setState(function(e){return{openBackToDefault:!e.openBackToDefault}})},toggleOnboardingModal:function(){this.setState(function(e){return{isOpenOnboardingModal:!e.isOpenOnboardingModal}})},toggleOfflineChangeModal:function(){this.setState(function(e){return{isOpenOfflineChangeModal:!e.isOpenOfflineChangeModal}})},getRelatedView:function(e){if(!Boolean(this.formInstances[e.relatedView])){var t=this.state.model.find(function(t){return t.id==e.relatedView});e.relatedViewInfo=t}return e},getOfflineRelatedView:function(e){if(!Boolean(this.formInstances[e.id])){var t=this.state.model.find(function(t){return t.id==e.relatedView});e.relatedViewInfo=t}return e},getRelatedForm:function(e){var t=this.idForm;if(e.relatedView){var i=this.state.model.find(function(t){return t.id==e.relatedView});t=i&&i.idForm||this.idForm}return t},confirmOfflineWork:function(){this.resolveOfflineChange(!0)},cancelOfflineWork:function(){this.resolveOfflineChange(!1),this.resolveOfflineChange=null},render:function(){if(null==this.state.viewSelected)return null;var t=this.state.model.map(function(e){return e.id}).concat(e.GENERIC_VIEW_ID),n=this.state.viewSelected.relatedView,o=!!this.formInstances[n]&&Boolean(this.formInstances[n].offlineActive);return[React.createElement(bizagi.editor.app.main,{key:2,views:t,viewToShow:n,offlineActive:o,viewIsEnable:!0,ref:this.mainRef}),React.createElement(bizagi.editor.app.tabulator,{key:3,viewSelected:this.state.viewSelected,model:this.state.model,deviceDefinitions:i,viewWillChange:this.handleViewWillChange,onUpdateDevice:this.handleUpdateDevice,onCreateForm:this.handleCreateSpecificForm,onToggleSaveForm:this.toggleSaveFormModal,onValidationsToCreateAnSpecificForm:this.handleValidationsToCreateAnSpecificForm,onToggleRestoreToDefaultFormModal:this.toggleRestoreToDefaultFormModal,onSetAsMaster:this.handleSetAsMaster,isActivityForm:this.isActivityForm}),this.buildOnboardingModal(),this.buildSaveFormModal(),this.buildOfflineChangeModal(),this.buildRestoreToDefaultFormModal(),this.builEditOfflineFormModal(),this.builRestoreOfflinePreviewModal()]}})}(),function(e){var t=createReactClass({getInitialState:function(){return{isOpen:!1,showWizard:!1,devices:this.props.devices}},componentWillReceiveProps:function(e){this.setState({isOpen:!1,showWizard:!1,devices:e.devices})},buildDefinitions:function(e){var t=this,i=e.type===this.props.active?"form__active":"";return LI({key:e.id,className:i},DIV({onClick:function(){t.props.onChangeActiveView(e.type)}},SVG({},USE({xlinkHref:"#"+e.icon})),STRONG({},e.displayName),I({},"Linked")))},toggleModal:function(){var e=this;setTimeout(function(){e.setState({isOpen:!e.state.isOpen})},0)},toggleWizard:function(){var e=this;setTimeout(function(){e.setState({showWizard:!e.state.showWizard})},0)},getModalView:function(){var e=this;return React.createElement(bizagi.editor.app.modal,{show:this.state.isOpen,onClose:function(){e.toggleModal()},width:500,height:350,buttons:[{displayName:"Ok",handler:function(){e.toggleWizard()}},{displayName:"Cancel"}]},React.createElement(bizagi.editor.app.specificFormsOnboarding))},buildWizard:function(){var e=this;return this.state.showWizard?React.createElement(bizagi.editor.app.sidebar.Wizard,{show:this.state.showWizard,getTypesAvailables:function(){return e.props.getTypesAvailables()},getDevicesByType:function(t){return e.props.getDevicesByType(t)},onCreateForm:function(t,i){return e.props.onCreateForm(t,i)},onClose:function(){return e.toggleWizard()}}):null},canAddForms:function(){return this.props.getTypesAvailables().length>0},render:function(){var e=this.props.onGetDefinitions();return DIV({id:"forms__specific",key:1},UL({},e.map(this.buildDefinitions)),this.getModalView(),this.buildWizard())}});e.sidebar=t}(bizagi.editor.app),function(e){var t=createReactClass({getHeader:function(){var e=this,t=this.props.title||"Bizagi";return DIV({style:{paddingRight:16,paddingLeft:16,paddingTop:8,paddingBottom:8,position:"relative",borderBottom:"2px solid #aeaeae",backgroundColor:"#fff"}},SPAN({style:{fontWeight:700,fontSize:"1.5rem"}},t),SVG({onClick:function(){e.props.cancel&&e.props.cancel(),e.props.onClose()},style:{width:"1.5rem",height:"1.5rem",position:"absolute",right:10,cursor:"pointer",transform:"rotate(45deg)"}},USE({xlinkHref:"#icon-plus"})))},getButtons:function(){var e=this,t=this.props.buttons,i={display:"flex",justifyContent:"space-between"},n={border:"1px solid #c5c5c5",padding:"7px",cursor:"pointer"};return t?(1===t.length&&(i=$.extend(i,{flexDirection:"row-reverse"})),UL({style:i},t.map(function(t,i){var o=t.style||{},r=$.extend({},n,o);return LI({key:i,style:r,onClick:function(){e.props.onClose(),t.handler&&t.handler()}},t.displayName)}))):UL({style:i},LI({style:n,onClick:function(){e.props.onClose()}},"Ok"))},render:function(){if(!this.props.show)return null;var e=document.body.clientHeight,t=this.props.height||400,i={backgroundColor:"#e5e5e5",borderRadius:5,width:this.props.width||500,maxHeight:t,margin:"0 auto",position:"relative",top:parseInt((e-(t+30))/2)};return DIV({className:"backdrop",style:{position:"fixed",top:0,bottom:0,left:0,right:0,backgroundColor:"rgba(0,0,0,0.3)",zIndex:1e3}},DIV({className:"modal",style:i},this.getHeader(),this.props.children,FOOTER({style:{backgroundColor:"#fff",borderTop:"2px solid #aeaeae",padding:"1rem"}},this.getButtons())))}}),i=createReactClass({render:function(){var e=bizagi.localization.getResource("bizagi-editor-modal-onboarding-message"),t=bizagi.localization.getResource("bizagi-editor-modal-onboarding-question"),i=bizagi.localization.getResource("bizagi-editor-modal-onboarding-note"),n=bizagi.localization.getResource("bizagi-editor-modal-onboarding-note-body");return DIV({className:"specific__form__onboarding"},SVG({},USE({xlinkHref:"#icon-base-to-specific"})),P({className:"onboarding__message"},e),P({className:"onboarding__question"},t),P({className:"onboarding__note"},SPAN({},i),n))}});e.specificFormsOnboarding=i,e.modal=t}(bizagi.editor.app),function(e){var t=bizagi.editor.base.constants.DEVICES,i=createReactClass({getInitialState:function(){this.originalModel=this.props.model;var e=this.props.model.map(function(e){return Object.assign({},e)});return this.getResource=bizagi.localization.getResource.bind(bizagi.localization),{devices:this.buildModel([t.DESKTOP,t.SMARTPHONE,t.TABLET],e),model:e,filter:""}},handleChangeCheck:function(e){var i=this,n=Math.max.apply(null,this.state.model.map(function(e){return e.order})),o=0,r=this.state.model.map(function(t){return t.id===e&&(t.isActive=!t.isActive,t.order=t.isActive?n+1:0),t.isActive&&o++,t});0!==o&&this.setState(function(){return{devices:this.buildModel([t.DESKTOP,t.SMARTPHONE,t.TABLET],r),model:r}},function(){i.props.onUpdateDevice(r)})},handleInputSearchChange:function(e){e.persist(),this.setState(function(){return{filter:e.target.value}})},buildModel:function(e,t){var i=this.props.definitions;return e.map(function(e){var n=i.find(function(t){return t.type===e});return{id:n.id,displayName:n.displayName,icon:n.icon,items:t.filter(function(t){return t.device===e})}})},buildItem:function(e){var t=this,i="fd__checkbox",n=this.originalModel.find(function(t){return t.id===e.id}).isActive;return n?i+=" fd__checkbox--disable":e.isActive&&(i+=" fd__checkbox--active"),LI({key:e.id},DIV({className:i,onClick:function(i){i.preventDefault(),n||t.handleChangeCheck(e.id)}},INPUT({type:"checkbox",checked:e.isActive,id:e.id}),LABEL({htmlFor:e.id},e.displayName)))},buildDevice:function(e){var t=this,i=this.state.filter;return i=i.trim(),DIV({key:e.id,className:"device__container"},SPAN({className:"device__container--header"},e.displayName),UL({className:"device__items"},e.items.sort(function(e,t){return(e=e.displayName.toUpperCase())<(t=t.displayName.toUpperCase())?-1:e>t?1:0}).map(function(e){return i.length>0?e.displayName.toLowerCase().includes(i.toLowerCase())?t.buildItem(e):null:t.buildItem(e)})))},render:function(){var e=this.state.devices.filter(function(e){return e.items&&e.items.length}).map(this.buildDevice),t=this.getResource("bizagi-editor-modal-deviceselector-placeholder");return DIV({id:"deviceSelector"},INPUT({placeholder:t,style:{height:"30px",border:"1px solid #C9C9C9",borderRadius:"2px",width:"100%",backgroundColor:"#FFFFFF",marginBottom:"1.2rem",paddingLeft:5},onChange:this.handleInputSearchChange}),DIV({className:"devices__container"},e))}});e.deviceSelector=i}(bizagi.editor.app),bizagi.editor=bizagi.editor||{},bizagi.editor.app=bizagi.editor.app||{},bizagi.editor.app.tabulator=function(){var e=createReactClass({getInitialState:function(){var e=this.props.viewSelected;return this.tabulatorRef=React.createRef(),this.getResource=bizagi.localization.getResource.bind(bizagi.localization),this.DEVICES=bizagi.editor.base.constants.DEVICES,this.appState=bizagi.editor.base.appState,this.isActivityForm=this.props.isActivityForm,{showDeviceSelector:!1,showContextMenu:!1,active:e.id,model:this.props.model,originalModel:this.props.model,scrollWidth:0,scrollLeft:0,tabClicked:null}},componentWillReceiveProps:function(e){var t=this;this.setState(function(){return{showDeviceSelector:!1,active:e.viewSelected.id,model:e.model,originalModel:e.model}}),setTimeout(function(){t.handleScrolling()},100)},componentDidMount:function(){var e=this;setTimeout(function(){$(window).resize(function(){e.handleScrolling()}),e.handleScrolling()},10)},handleUpdateDevice:function(e){this.setState({model:e})},handleCloseView:function(e){var t=this.state.model.map(function(t){return t.id===e.id&&(t.isActive=!t.isActive),t});this.props.onUpdateDevice(t)},handleScrolling:function(){if(this.state.model.length>1){var e=this.tabulatorRef.current;if(e){var t=e.scrollWidth,i=e.clientWidth;this.setState(function(){return{scrollWidth:t-i,scrollLeft:e.scrollLeft}})}}},toggleContextMenu:function(){this.setState(function(e){return{showContextMenu:!e.showContextMenu}})},toggleDeviceSelectorModal:function(){this.setState(function(e){return{showDeviceSelector:!e.showDeviceSelector}})},canDeleteView:function(){return this.getActiveViews().length>1},buildNavigationButtons:function(){var e=this,t=this.tabulatorRef.current;if(null===t)return null;var i=t.scrollWidth-t.clientWidth,n=t.scrollWidth>0&&t.scrollLeft>0?"ico_16x16":"ico_16x16 icon-disabled",o=t.scrollWidth>0&&t.scrollLeft<i?"ico_16x16":"ico_16x16 icon-disabled";return UL({className:"navigator__buttons"},LI({},SVG({className:n,onClick:function(){t.scrollLeft-=50,e.handleScrolling()}},USE({xlinkHref:"#icon-arrow-left"}))),LI({},SVG({className:o,onClick:function(){t.scrollLeft+=50,e.handleScrolling()}},USE({xlinkHref:"#icon-arrow-rigth"}))))},getElementWidth:function(e){var t=window.getComputedStyle(e);return e.offsetWidth+["padding-left","padding-right","margin-left","margin-right"].reduce(function(e,i){return e+=parseInt(t[i])},0)},setOffsetScroll:function(e){var t=this,i=this.tabulatorRef.current;if(i){var n=i.scrollWidth,o=i.clientWidth,r=n-o,a=Array.from(i.children).slice(0,e+1),s=a.reduce(function(e,i){return e+t.getElementWidth(i)},0);if(r>0){var l=t.getElementWidth(a[e]);s-i.scrollLeft>o?i.scrollLeft=s-o+30:i.scrollLeft>0&&s-i.scrollLeft<l&&(i.scrollLeft=i.scrollLeft-l)}}},getDisplayName:function(e){var t=this,i=this.appState,n=this.DEVICES;function o(){var i=t.getResource("bizagi-editor-tabulator-display-master");switch(e.device){case n.SMARTPHONE:return e.displayName+" ("+i+" Smartphone )";case n.TABLET:return e.displayName+" ("+i+" Tablet )";case n.DESKTOP:return e.displayName+" ("+i+" Desktop )"}}return e.type!=e.device?e.relatedView!=i.GENERIC_VIEW_ID?o():e.displayName+" ("+this.getResource("bizagi-editor-tabulator-display-default")+")":e.isPrincipal||e.id!=e.relatedView?o():e.displayName+" ("+this.getResource("bizagi-editor-tabulator-display-specific")+")"},buildActiveViews:function(){var e=this,t=this.canAddViews()?this.buildPlusAction():null,i=this.getActiveViews();return NAV({},UL({className:"fd__navigation",ref:this.tabulatorRef},i.map(function(t,i){var n=t.id,o=n===e.state.active,r="";t.device==e.DEVICES.DESKTOP?r="view__desktop":t.device==e.DEVICES.TABLET?r="view__tablet":t.device==e.DEVICES.SMARTPHONE&&(r="view__smartphone"),r+=o?" bz-fm-active-view":"",r+=t.type!=t.device||t.isPrincipal?"":" view__specific--noPrincipal",r+=t.isPrincipal?" view__principal ":"";var a=e.getStyleView(t,o),s=SPAN({className:t.withChanges?"":"changes__visible",style:{marginLeft:"2px",fontSize:"large"}},"*"),l=o&&e.state.showContextMenu?"tab__device--options tab__device--contextmenu":"tab__device--options",d=SVG({className:l,onClick:function(t){if(o){var n=e.tabulatorRef.current;if(n){var r=Array.from(n.children).slice(0);e.setState({tabClicked:r[i],showContextMenu:!0})}}}},USE({xlinkHref:"#arrow-down-designer"}));return LI({key:n,className:r,style:a,onClick:function(){e.setOffsetScroll(i),e.setState(function(){return{active:n}},function(){e.props.viewWillChange(t)})}},SVG({className:"ico_16x16"},USE({xlinkHref:e.getIconDefinition(t)})),SPAN({},e.getDisplayName(t)),s,d)})),t)},buildDeviceSelectorModal:function(){var e=this;return React.createElement(bizagi.editor.app.modal,{show:this.state.showDeviceSelector,title:this.getResource("bizagi-editor-modal-deviceselector-title"),onClose:this.toggleDeviceSelectorModal,width:350,height:600,buttons:[{displayName:this.getResource("bizagi-editor-modal-deviceselector-cancel"),handler:function(){}},{displayName:this.getResource("bizagi-editor-modal-deviceselector-add"),handler:function(){e.props.onUpdateDevice(e.state.model)},style:{border:"none",color:"white",backgroundColor:"#91AD1F"}}]},React.createElement(bizagi.editor.app.deviceSelector,{model:this.props.model,definitions:this.props.deviceDefinitions,onUpdateDevice:this.handleUpdateDevice,simple:!1}))},buildContextMenu:function(){var e=this;if(!this.state.showContextMenu)return null;var i=e.getActiveViews().find(function(t){return t.id==e.state.active});return React.createElement(t,{tabClicked:this.state.tabClicked,onClose:this.toggleContextMenu,viewSelected:i,enableCloseDevice:this.getActiveViews().length>1,onSetAsMaster:e.props.onSetAsMaster,onValidationsToCreateAnSpecificForm:function(){e.props.onValidationsToCreateAnSpecificForm(i)},onCloseDevice:function(){i.withChanges?e.props.onToggleSaveForm():e.handleCloseView(i)},onToggleRestoreToDefaultFormModal:e.props.onToggleRestoreToDefaultFormModal,isActivityForm:this.isActivityForm,isReadOnly:i.isReadOnly})},buildPlusAction:function(){return DIV({className:"addview__container"},DIV({onClick:this.toggleDeviceSelectorModal},SVG({className:"ico_16x16 fd__addview"},USE({xlinkHref:"#icon-plus"}))))},getIconDefinition:function(e){var t=this.props.deviceDefinitions.find(function(t){return t.type===e.device});return"#"+(e.withError?t.errorIcon:t.icon)},getStyleView:function(e,t){var i={},n=this.props.deviceDefinitions.find(function(t){return t.type===e.device}).color;return e.type!=e.device||e.isPrincipal?((e.type==e.device&&e.isPrincipal||e.relatedView!=this.appState.GENERIC_VIEW_ID&&!e.isPrincipal)&&(i.borderBottom="4px solid "+n,t&&(i.color=n,i.fill=n)),i):(t&&(i.color=n,i.fill=n),i)},getActiveViews:function(){return this.state.originalModel.filter(function(e){return e.isActive}).sort(function(e,t){return e.order-t.order})},canAddViews:function(){return this.state.model.length>1},render:function(){return DIV({id:"tabulator-container",key:3},this.buildNavigationButtons(),DIV({className:"navigator__container"},this.buildActiveViews()),this.buildDeviceSelectorModal(),this.buildContextMenu())}}),t=createReactClass({getInitialState:function(){var e=this.props.tabClicked;return this.getResource=bizagi.localization.getResource.bind(bizagi.localization),this.clientRect=e.getBoundingClientRect(),this.DEVICES=bizagi.editor.base.constants.DEVICES,{close:!1}},getDeviceName:function(e){var t=this.DEVICES;switch(e.device){case t.SMARTPHONE:return"smartphone";case t.TABLET:return"tablet";case t.DESKTOP:return"desktop"}},getOptions:function(){var e=this,t=this.props.viewSelected,i=[];if(t.device==t.type){if(e.props.isActivityForm){var n=this.getResource("bizagi-editor-tabulator-option-set-as-default")+e.getDeviceName(t)+"s";t.isPrincipal||i.push(LI({key:1,onClick:function(i){i.stopPropagation(),e.props.onClose(),e.props.onSetAsMaster(t)}},n));var o=this.getResource("bizagi-editor-tabulator-option-restore-to-default");i.push(LI({key:2,onClick:function(t){t.stopPropagation(),e.props.onClose(),e.props.onToggleRestoreToDefaultFormModal()}},o))}}else i.push(LI({key:2,onClick:function(t){t.stopPropagation(),e.props.onClose(),e.props.onValidationsToCreateAnSpecificForm()}},this.getResource("bizagi-editor-tabulator-option-customize")));if(e.props.enableCloseDevice){var r=t.isPrincipal?"option__close--principal":"";i.push(LI({key:3,className:r,onClick:function(i){t.isPrincipal||(i.stopPropagation(),e.props.onClose(),e.props.onCloseDevice())}},this.getResource("bizagi-editor-tabulator-option-close")))}return i},render:function(){var e=this,t=this.clientRect.left,i=this.clientRect.width,n="view__contextmenu";return n+=e.props.isReadOnly?" contextmenu__readonly":"",DIV({className:"overlay__dom",onClick:function(){e.props.onClose()}},UL({className:n,style:{left:t,bottom:42,minWidth:i}},e.getOptions()))}});return e}(),function(e,t){var i=createReactClass({getInitialState:function(){return{active:this.props.active()}},handlerChangeView:function(e){this.setState({active:e}),this.props.onChangeDevice(e)},render:function(){var e=this;return DIV({className:"device__types"},SPAN({},"Choose device type"),UL({className:"devices__list"},this.props.getTypesAvailables().map(function(t){var i=e.state.active,n=i&&i.id===t.id?"device__selected":"";return LI({key:t.id,className:n},DIV({onClick:function(){e.handlerChangeView(t)}},SVG({},USE({xlinkHref:"#"+t.icon}))),SPAN({},t.displayName))})))}}),n={};n[n.ChooseDevice=0]="ChooseDevice",n[n.CopyFrom=1]="CopyFrom",n[n.Preview=2]="Preview",n[n.Finish=3]="Finish",n[n.SelectView=4]="SelectView";var o={};o[n.ChooseDevice]=createReactClass({getInitialState:function(){return{activeOption:"59BD9F5C-30BB-4704-A3FE-D1DE4E54B974",errorMessage:""}},getOptions:function(){return[{text:"Start from scratch from a blank canvas",id:"59BD9F5C-30BB-4704-A3FE-D1DE4E54B974",next:n.SelectView},{text:"Start based on the controls already included",id:"2F611D4D-B585-46FE-AEF1-13B15C4D19D0",next:n.CopyFrom}]},handleChangeOption:function(e){this.setState({activeOption:e})},buildOption:function(e){var t=this,i=e.id===this.state.activeOption?"option_selected":"";return LI({key:e.id,onClick:function(){t.handleChangeOption(e.id)},className:i},e.text)},validate:function(){var e=this,t=this.getOptions().find(function(t){return t.id===e.state.activeOption});t?this.props.next(t.next):this.setState({errorMessage:"Please choose an option"})},showErrors:function(){return this.state.errorMessage?SPAN({},this.state.errorMessage):null},render:function(){var e=this;return DIV({className:"choose__Device--step1"},React.createElement(i,{onChangeDevice:function(t){e.props.onChangeDevice(t)},getTypesAvailables:function(){return e.props.getTypesAvailables()},active:function(){var t=e.props.getTypesAvailables();if(1===t.length){var i=t[0];return e.props.onChangeDevice(i),i}return null}}),DIV({className:"device__start",style:{padding:"0 20px"}},SPAN({},"How do you want to start?"),UL({},this.getOptions().map(this.buildOption))),this.showErrors(),FOOTER({},SPAN({},"Step 1 of 2"),DIV({onClick:function(){e.validate()}},"Next")))}}),o[n.SelectView]=createReactClass({getInitialState:function(){return{deviceModel:this.props.deviceModel}},validate:function(){this.props.next(n.Finish)},handleChange:function(e){var t=e.target.value,i=this.state.deviceModel;i.items=i.items.map(function(e){return e.isActive=e.id===t,e}),this.props.onUpdateDeviceModel(i)},render:function(){var e=this,t=this.state.deviceModel.items,i=t.find(function(e){return e.isActive});return i=i||t[0],DIV({className:"select__Device--step2"},DIV({},SELECT({value:i.id,onChange:this.handleChange},t.map(function(e){return OPTION({value:e.id,key:e.id},e.displayName)}))),FOOTER({},SPAN({},"Step 2 of 2"),DIV({onClick:function(){e.validate()}},"Create Form")))}}),o[n.Preview]=createReactClass({getInitialState:function(){return{deviceModel:this.props.deviceModel}},validate:function(){this.props.next(n.Finish)},render:function(){var e=this;return DIV({className:"preview__Device--step2"},React.createElement(t,{devices:this.props.deviceModel,onUpdateDevice:function(t){return e.props.onUpdateDeviceModel(t)},simple:!0}),FOOTER({},SPAN({},"Step 2 of 2"),DIV({onClick:function(){e.validate()}},"Create Form")))}});var r=createReactClass({getInitialState:function(){return{currentState:n.ChooseDevice,device:null,option:"",deviceModel:null}},componentWillReceiveProps:function(){this.setState({currentState:n.ChooseDevice,device:null,option:"",deviceModel:null})},handleChangeDevice:function(e){this.setState({device:e}),this.device=e},handleChangeOption:function(e){this.setState({option:e})},handleUpdateDeviceModel:function(e){this.props.onUpdateModel&&this.props.onUpdateModel(e),this.setState(function(){return{deviceModel:e}})},getDeviceModel:function(){return this.state.deviceModel||this.props.getDevicesByType(this.device.type)},getTitle:function(){switch(this.state.currentState){case n.Preview:return"Add Visualization Device";default:return"Add new specific device"}},getHeader:function(){var e=this,t=this.getTitle();return DIV({style:{padding:10,position:"relative",border:"1px solid #dadada",backgroundColor:"#fff"}},SPAN({style:{fontWeight:700,fontSize:"1.5rem"}},t),SVG({onClick:function(){e.props.onClose()},style:{width:"1.5rem",height:"1.5rem",position:"absolute",right:10,cursor:"pointer",transform:"rotate(45deg)"}},USE({xlinkHref:"#icon-plus"})))},next:function(e){this.setState({currentState:e})},getCurrentStep:function(){var e=this;switch(this.state.currentState){case n.ChooseDevice:return React.createElement(o[n.ChooseDevice],{next:function(t){e.next(t)},onChangeDevice:function(t){return e.handleChangeDevice(t)},onChangeOption:function(t){return e.handleChangeOption(t)},getTypesAvailables:function(){return e.props.getTypesAvailables()}});case n.Preview:return React.createElement(o[n.Preview],{next:function(t){e.next(t)},deviceModel:this.getDeviceModel(),onUpdateDeviceModel:function(t){e.handleUpdateDeviceModel(t)}});case n.SelectView:return React.createElement(o[n.SelectView],{next:function(t){e.next(t)},deviceModel:this.getDeviceModel(),onUpdateDeviceModel:function(t){e.handleUpdateDeviceModel(t)}});case n.Finish:var t=bizagi.clone(this.state);e.props.onClose(),setTimeout(function(){e.props.onCreateForm(t.device,t.deviceModel)},10);default:return null}},render:function(){if(!this.props.show)return null;var e=document.body.clientHeight,t=this.props.height||600,i={backgroundColor:"#e5e5e5",borderRadius:5,width:this.props.width||400,maxHeight:t,margin:"0 auto",position:"relative",top:parseInt((e-(t+30))/2)};return DIV({id:"sidebar__add-specific-form",style:{position:"fixed",top:0,bottom:0,left:0,right:0,backgroundColor:"rgba(0,0,0,0.3)",zIndex:1e3}},DIV({className:"modal",style:i},this.getHeader(),this.getCurrentStep()))}});e.Wizard=r}(bizagi.editor.app.sidebar,bizagi.editor.app.deviceSelector),function(e){var t=createReactClass({getInitialState:function(){return this.view={},{views:this.props.views,viewToShow:this.props.viewToShow,offlineActive:this.props.offlineActive}},componentWillReceiveProps:function(e){this.setState({views:e.views,viewToShow:e.viewToShow,offlineActive:e.offlineActive})},buildMainView:function(e){var t=e===this.state.viewToShow?["view__show"]:["view__hide"],i=e===this.state.viewToShow&&this.state.offlineActive;return LI({className:t.join(" "),key:e},DIV({id:e+"_online",className:i?"view__hide":"view__show"}),DIV({id:e+"_offline",className:i?"view__show":"view__hide"}))},render:function(){return null==this.props.viewToShow?null:MAIN({},UL({},this.state.views.map(this.buildMainView)))}});e.main=t}(bizagi.editor.app);
//# sourceMappingURL=../../../../Maps/desktop/formmodeller.production.js.map
// 4.1.6 (2014-10-08) @notMinified 
!function (e, t) { "use strict"; function n(e, t) { for (var n, r = [], i = 0; i < e.length; ++i) { if (n = s[e[i]] || o(e[i]), !n) throw "module definition dependecy not found: " + e[i]; r.push(n) } t.apply(null, r) } function r(e, r, i) { if ("string" != typeof e) throw "invalid module definition, module id must be defined and be a string"; if (r === t) throw "invalid module definition, dependencies must be specified"; if (i === t) throw "invalid module definition, definition function must be specified"; n(r, function () { s[e] = i.apply(null, arguments) }) } function i(e) { return !!s[e] } function o(t) { for (var n = e, r = t.split(/[.\/]/), i = 0; i < r.length; ++i) { if (!n[r[i]]) return; n = n[r[i]] } return n } function a(n) { for (var r = 0; r < n.length; r++) { for (var i = e, o = n[r], a = o.split(/[.\/]/), l = 0; l < a.length - 1; ++l) i[a[l]] === t && (i[a[l]] = {}), i = i[a[l]]; i[a[a.length - 1]] = s[o] } } var s = {}, l = "tinymce/dom/EventUtils", c = "tinymce/dom/Sizzle", u = "tinymce/util/Tools", d = "tinymce/Env", f = "tinymce/dom/DomQuery", p = "tinymce/html/Styles", h = "tinymce/dom/TreeWalker", m = "tinymce/dom/Range", g = "tinymce/html/Entities", v = "tinymce/dom/StyleSheetLoader", y = "tinymce/dom/DOMUtils", b = "tinymce/dom/ScriptLoader", C = "tinymce/AddOnManager", x = "tinymce/dom/RangeUtils", w = "tinymce/NodeChange", _ = "tinymce/html/Node", E = "tinymce/html/Schema", N = "tinymce/html/SaxParser", k = "tinymce/html/DomParser", S = "tinymce/html/Writer", T = "tinymce/html/Serializer", R = "tinymce/dom/Serializer", A = "tinymce/dom/TridentSelection", B = "tinymce/util/VK", D = "tinymce/dom/ControlSelection", L = "tinymce/dom/BookmarkManager", H = "tinymce/dom/Selection", M = "tinymce/dom/ElementUtils", P = "tinymce/fmt/Preview", O = "tinymce/Formatter", I = "tinymce/UndoManager", F = "tinymce/EnterKey", z = "tinymce/ForceBlocks", W = "tinymce/EditorCommands", V = "tinymce/util/URI", U = "tinymce/util/Class", $ = "tinymce/util/EventDispatcher", q = "tinymce/ui/Selector", j = "tinymce/ui/Collection", Y = "tinymce/ui/DomUtils", K = "tinymce/ui/Control", G = "tinymce/ui/Factory", X = "tinymce/ui/KeyboardNavigation", J = "tinymce/ui/Container", Q = "tinymce/ui/DragHelper", Z = "tinymce/ui/Scrollable", et = "tinymce/ui/Panel", tt = "tinymce/ui/Movable", nt = "tinymce/ui/Resizable", rt = "tinymce/ui/FloatPanel", it = "tinymce/ui/Window", ot = "tinymce/ui/MessageBox", at = "tinymce/WindowManager", st = "tinymce/util/Quirks", lt = "tinymce/util/Observable", ct = "tinymce/EditorObservable", ut = "tinymce/Shortcuts", dt = "tinymce/Editor", ft = "tinymce/util/I18n", pt = "tinymce/FocusManager", ht = "tinymce/EditorManager", mt = "tinymce/LegacyInput", gt = "tinymce/util/XHR", vt = "tinymce/util/JSON", yt = "tinymce/util/JSONRequest", bt = "tinymce/util/JSONP", Ct = "tinymce/util/LocalStorage", xt = "tinymce/Compat", wt = "tinymce/ui/Layout", _t = "tinymce/ui/AbsoluteLayout", Et = "tinymce/ui/Tooltip", Nt = "tinymce/ui/Widget", kt = "tinymce/ui/Button", St = "tinymce/ui/ButtonGroup", Tt = "tinymce/ui/Checkbox", Rt = "tinymce/ui/ComboBox", At = "tinymce/ui/ColorBox", Bt = "tinymce/ui/PanelButton", Dt = "tinymce/ui/ColorButton", Lt = "tinymce/util/Color", Ht = "tinymce/ui/ColorPicker", Mt = "tinymce/ui/Path", Pt = "tinymce/ui/ElementPath", Ot = "tinymce/ui/FormItem", It = "tinymce/ui/Form", Ft = "tinymce/ui/FieldSet", zt = "tinymce/ui/FilePicker", Wt = "tinymce/ui/FitLayout", Vt = "tinymce/ui/FlexLayout", Ut = "tinymce/ui/FlowLayout", $t = "tinymce/ui/FormatControls", qt = "tinymce/ui/GridLayout", jt = "tinymce/ui/Iframe", Yt = "tinymce/ui/Label", Kt = "tinymce/ui/Toolbar", Gt = "tinymce/ui/MenuBar", Xt = "tinymce/ui/MenuButton", Jt = "tinymce/ui/ListBox", Qt = "tinymce/ui/MenuItem", Zt = "tinymce/ui/Menu", en = "tinymce/ui/Radio", tn = "tinymce/ui/ResizeHandle", nn = "tinymce/ui/Spacer", rn = "tinymce/ui/SplitButton", on = "tinymce/ui/StackLayout", an = "tinymce/ui/TabPanel", sn = "tinymce/ui/TextBox", ln = "tinymce/ui/Throbber"; r(l, [], function () { function e(e, t, n, r) { e.addEventListener ? e.addEventListener(t, n, r || !1) : e.attachEvent && e.attachEvent("on" + t, n) } function t(e, t, n, r) { e.removeEventListener ? e.removeEventListener(t, n, r || !1) : e.detachEvent && e.detachEvent("on" + t, n) } function n(e, t) { function n() { return !1 } function r() { return !0 } var i, o = t || {}, l; for (i in e) s[i] || (o[i] = e[i]); if (o.target || (o.target = o.srcElement || document), e && a.test(e.type) && e.pageX === l && e.clientX !== l) { var c = o.target.ownerDocument || document, u = c.documentElement, d = c.body; o.pageX = e.clientX + (u && u.scrollLeft || d && d.scrollLeft || 0) - (u && u.clientLeft || d && d.clientLeft || 0), o.pageY = e.clientY + (u && u.scrollTop || d && d.scrollTop || 0) - (u && u.clientTop || d && d.clientTop || 0) } return o.preventDefault = function () { o.isDefaultPrevented = r, e && (e.preventDefault ? e.preventDefault() : e.returnValue = !1) }, o.stopPropagation = function () { o.isPropagationStopped = r, e && (e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0) }, o.stopImmediatePropagation = function () { o.isImmediatePropagationStopped = r, o.stopPropagation() }, o.isDefaultPrevented || (o.isDefaultPrevented = n, o.isPropagationStopped = n, o.isImmediatePropagationStopped = n), o } function r(n, r, i) { function o() { i.domLoaded || (i.domLoaded = !0, r(c)) } function a() { ("complete" === l.readyState || "interactive" === l.readyState && l.body) && (t(l, "readystatechange", a), o()) } function s() { try { l.documentElement.doScroll("left") } catch (e) { return void setTimeout(s, 0) } o() } var l = n.document, c = { type: "ready" }; return i.domLoaded ? void r(c) : (l.addEventListener ? "complete" === l.readyState ? o() : e(n, "DOMContentLoaded", o) : (e(l, "readystatechange", a), l.documentElement.doScroll && n.self === n.top && s()), void e(n, "load", o)) } function i() { function i(e, t) { var n, r, i, o, a = s[t]; if (n = a && a[e.type]) for (r = 0, i = n.length; i > r; r++) if (o = n[r], o && o.func.call(o.scope, e) === !1 && e.preventDefault(), e.isImmediatePropagationStopped()) return } var a = this, s = {}, l, c, u, d, f; c = o + (+new Date).toString(32), d = "onmouseenter" in document.documentElement, u = "onfocusin" in document.documentElement, f = { mouseenter: "mouseover", mouseleave: "mouseout" }, l = 1, a.domLoaded = !1, a.events = s, a.bind = function (t, o, p, h) { function m(e) { i(n(e || _.event), g) } var g, v, y, b, C, x, w, _ = window; if (t && 3 !== t.nodeType && 8 !== t.nodeType) { for (t[c] ? g = t[c] : (g = l++, t[c] = g, s[g] = {}), h = h || t, o = o.split(" "), y = o.length; y--; ) b = o[y], x = m, C = w = !1, "DOMContentLoaded" === b && (b = "ready"), a.domLoaded && "ready" === b && "complete" == t.readyState ? p.call(h, n({ type: b })) : (d || (C = f[b], C && (x = function (e) { var t, r; if (t = e.currentTarget, r = e.relatedTarget, r && t.contains) r = t.contains(r); else for (; r && r !== t; ) r = r.parentNode; r || (e = n(e || _.event), e.type = "mouseout" === e.type ? "mouseleave" : "mouseenter", e.target = t, i(e, g)) })), u || "focusin" !== b && "focusout" !== b || (w = !0, C = "focusin" === b ? "focus" : "blur", x = function (e) { e = n(e || _.event), e.type = "focus" === e.type ? "focusin" : "focusout", i(e, g) }), v = s[g][b], v ? "ready" === b && a.domLoaded ? p({ type: b }) : v.push({ func: p, scope: h }) : (s[g][b] = v = [{ func: p, scope: h}], v.fakeName = C, v.capture = w, v.nativeHandler = x, "ready" === b ? r(t, x, a) : e(t, C || b, x, w))); return t = v = 0, p } }, a.unbind = function (e, n, r) { var i, o, l, u, d, f; if (!e || 3 === e.nodeType || 8 === e.nodeType) return a; if (i = e[c]) { if (f = s[i], n) { for (n = n.split(" "), l = n.length; l--; ) if (d = n[l], o = f[d]) { if (r) for (u = o.length; u--; ) if (o[u].func === r) { var p = o.nativeHandler, h = o.fakeName, m = o.capture; o = o.slice(0, u).concat(o.slice(u + 1)), o.nativeHandler = p, o.fakeName = h, o.capture = m, f[d] = o } r && 0 !== o.length || (delete f[d], t(e, o.fakeName || d, o.nativeHandler, o.capture)) } } else { for (d in f) o = f[d], t(e, o.fakeName || d, o.nativeHandler, o.capture); f = {} } for (d in f) return a; delete s[i]; try { delete e[c] } catch (g) { e[c] = null } } return a }, a.fire = function (e, t, r) { var o; if (!e || 3 === e.nodeType || 8 === e.nodeType) return a; r = n(null, r), r.type = t, r.target = e; do o = e[c], o && i(r, o), e = e.parentNode || e.ownerDocument || e.defaultView || e.parentWindow; while (e && !r.isPropagationStopped()); return a }, a.clean = function (e) { var t, n, r = a.unbind; if (!e || 3 === e.nodeType || 8 === e.nodeType) return a; if (e[c] && r(e), e.getElementsByTagName || (e = e.document), e && e.getElementsByTagName) for (r(e), n = e.getElementsByTagName("*"), t = n.length; t--; ) e = n[t], e[c] && r(e); return a }, a.destroy = function () { s = {} }, a.cancel = function (e) { return e && (e.preventDefault(), e.stopImmediatePropagation()), !1 } } var o = "mce-data-", a = /^(?:mouse|contextmenu)|click/, s = { keyLocation: 1, layerX: 1, layerY: 1, returnValue: 1 }; return i.Event = new i, i.Event.bind(window, "ready", function () { }), i }), r(c, [], function () { function e(e, t, n, r) { var i, o, a, s, l, c, d, p, h, m; if ((t ? t.ownerDocument || t : z) !== D && B(t), t = t || D, n = n || [], !e || "string" != typeof e) return n; if (1 !== (s = t.nodeType) && 9 !== s) return []; if (H && !r) { if (i = vt.exec(e)) if (a = i[1]) { if (9 === s) { if (o = t.getElementById(a), !o || !o.parentNode) return n; if (o.id === a) return n.push(o), n } else if (t.ownerDocument && (o = t.ownerDocument.getElementById(a)) && I(t, o) && o.id === a) return n.push(o), n } else { if (i[2]) return Z.apply(n, t.getElementsByTagName(e)), n; if ((a = i[3]) && x.getElementsByClassName) return Z.apply(n, t.getElementsByClassName(a)), n } if (x.qsa && (!M || !M.test(e))) { if (p = d = F, h = t, m = 9 === s && e, 1 === s && "object" !== t.nodeName.toLowerCase()) { for (c = N(e), (d = t.getAttribute("id")) ? p = d.replace(bt, "\\$&") : t.setAttribute("id", p), p = "[id='" + p + "'] ", l = c.length; l--; ) c[l] = p + f(c[l]); h = yt.test(e) && u(t.parentNode) || t, m = c.join(",") } if (m) try { return Z.apply(n, h.querySelectorAll(m)), n } catch (g) { } finally { d || t.removeAttribute("id") } } } return S(e.replace(st, "$1"), t, n, r) } function n() { function e(n, r) { return t.push(n + " ") > w.cacheLength && delete e[t.shift()], e[n + " "] = r } var t = []; return e } function r(e) { return e[F] = !0, e } function i(e) { var t = D.createElement("div"); try { return !!e(t) } catch (n) { return !1 } finally { t.parentNode && t.parentNode.removeChild(t), t = null } } function o(e, t) { for (var n = e.split("|"), r = e.length; r--; ) w.attrHandle[n[r]] = t } function a(e, t) { var n = t && e, r = n && 1 === e.nodeType && 1 === t.nodeType && (~t.sourceIndex || K) - (~e.sourceIndex || K); if (r) return r; if (n) for (; n = n.nextSibling; ) if (n === t) return -1; return e ? 1 : -1 } function s(e) { return function (t) { var n = t.nodeName.toLowerCase(); return "input" === n && t.type === e } } function l(e) { return function (t) { var n = t.nodeName.toLowerCase(); return ("input" === n || "button" === n) && t.type === e } } function c(e) { return r(function (t) { return t = +t, r(function (n, r) { for (var i, o = e([], n.length, t), a = o.length; a--; ) n[i = o[a]] && (n[i] = !(r[i] = n[i])) }) }) } function u(e) { return e && typeof e.getElementsByTagName !== Y && e } function d() { } function f(e) { for (var t = 0, n = e.length, r = ""; n > t; t++) r += e[t].value; return r } function p(e, t, n) { var r = t.dir, i = n && "parentNode" === r, o = V++; return t.first ? function (t, n, o) { for (; t = t[r]; ) if (1 === t.nodeType || i) return e(t, n, o) } : function (t, n, a) { var s, l, c = [W, o]; if (a) { for (; t = t[r]; ) if ((1 === t.nodeType || i) && e(t, n, a)) return !0 } else for (; t = t[r]; ) if (1 === t.nodeType || i) { if (l = t[F] || (t[F] = {}), (s = l[r]) && s[0] === W && s[1] === o) return c[2] = s[2]; if (l[r] = c, c[2] = e(t, n, a)) return !0 } } } function h(e) { return e.length > 1 ? function (t, n, r) { for (var i = e.length; i--; ) if (!e[i](t, n, r)) return !1; return !0 } : e[0] } function m(t, n, r) { for (var i = 0, o = n.length; o > i; i++) e(t, n[i], r); return r } function g(e, t, n, r, i) { for (var o, a = [], s = 0, l = e.length, c = null != t; l > s; s++) (o = e[s]) && (!n || n(o, r, i)) && (a.push(o), c && t.push(s)); return a } function v(e, t, n, i, o, a) { return i && !i[F] && (i = v(i)), o && !o[F] && (o = v(o, a)), r(function (r, a, s, l) { var c, u, d, f = [], p = [], h = a.length, v = r || m(t || "*", s.nodeType ? [s] : s, []), y = !e || !r && t ? v : g(v, f, e, s, l), b = n ? o || (r ? e : h || i) ? [] : a : y; if (n && n(y, b, s, l), i) for (c = g(b, p), i(c, [], s, l), u = c.length; u--; ) (d = c[u]) && (b[p[u]] = !(y[p[u]] = d)); if (r) { if (o || e) { if (o) { for (c = [], u = b.length; u--; ) (d = b[u]) && c.push(y[u] = d); o(null, b = [], c, l) } for (u = b.length; u--; ) (d = b[u]) && (c = o ? tt.call(r, d) : f[u]) > -1 && (r[c] = !(a[c] = d)) } } else b = g(b === a ? b.splice(h, b.length) : b), o ? o(null, a, b, l) : Z.apply(a, b) }) } function y(e) { for (var t, n, r, i = e.length, o = w.relative[e[0].type], a = o || w.relative[" "], s = o ? 1 : 0, l = p(function (e) { return e === t }, a, !0), c = p(function (e) { return tt.call(t, e) > -1 }, a, !0), u = [function (e, n, r) { return !o && (r || n !== T) || ((t = n).nodeType ? l(e, n, r) : c(e, n, r)) } ]; i > s; s++) if (n = w.relative[e[s].type]) u = [p(h(u), n)]; else { if (n = w.filter[e[s].type].apply(null, e[s].matches), n[F]) { for (r = ++s; i > r && !w.relative[e[r].type]; r++); return v(s > 1 && h(u), s > 1 && f(e.slice(0, s - 1).concat({ value: " " === e[s - 2].type ? "*" : "" })).replace(st, "$1"), n, r > s && y(e.slice(s, r)), i > r && y(e = e.slice(r)), i > r && f(e)) } u.push(n) } return h(u) } function b(t, n) { var i = n.length > 0, o = t.length > 0, a = function (r, a, s, l, c) { var u, d, f, p = 0, h = "0", m = r && [], v = [], y = T, b = r || o && w.find.TAG("*", c), C = W += null == y ? 1 : Math.random() || .1, x = b.length; for (c && (T = a !== D && a); h !== x && null != (u = b[h]); h++) { if (o && u) { for (d = 0; f = t[d++]; ) if (f(u, a, s)) { l.push(u); break } c && (W = C) } i && ((u = !f && u) && p--, r && m.push(u)) } if (p += h, i && h !== p) { for (d = 0; f = n[d++]; ) f(m, v, a, s); if (r) { if (p > 0) for (; h--; ) m[h] || v[h] || (v[h] = J.call(l)); v = g(v) } Z.apply(l, v), c && !r && v.length > 0 && p + n.length > 1 && e.uniqueSort(l) } return c && (W = C, T = y), m }; return i ? r(a) : a } var C, x, w, _, E, N, k, S, T, R, A, B, D, L, H, M, P, O, I, F = "sizzle" + -new Date, z = window.document, W = 0, V = 0, U = n(), $ = n(), q = n(), j = function (e, t) { return e === t && (A = !0), 0 }, Y = typeof t, K = 1 << 31, G = {}.hasOwnProperty, X = [], J = X.pop, Q = X.push, Z = X.push, et = X.slice, tt = X.indexOf || function (e) { for (var t = 0, n = this.length; n > t; t++) if (this[t] === e) return t; return -1 }, nt = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", rt = "[\\x20\\t\\r\\n\\f]", it = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+", ot = "\\[" + rt + "*(" + it + ")(?:" + rt + "*([*^$|!~]?=)" + rt + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + it + "))|)" + rt + "*\\]", at = ":(" + it + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + ot + ")*)|.*)\\)|)", st = new RegExp("^" + rt + "+|((?:^|[^\\\\])(?:\\\\.)*)" + rt + "+$", "g"), lt = new RegExp("^" + rt + "*," + rt + "*"), ct = new RegExp("^" + rt + "*([>+~]|" + rt + ")" + rt + "*"), ut = new RegExp("=" + rt + "*([^\\]'\"]*?)" + rt + "*\\]", "g"), dt = new RegExp(at), ft = new RegExp("^" + it + "$"), pt = { ID: new RegExp("^#(" + it + ")"), CLASS: new RegExp("^\\.(" + it + ")"), TAG: new RegExp("^(" + it + "|[*])"), ATTR: new RegExp("^" + ot), PSEUDO: new RegExp("^" + at), CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + rt + "*(even|odd|(([+-]|)(\\d*)n|)" + rt + "*(?:([+-]|)" + rt + "*(\\d+)|))" + rt + "*\\)|)", "i"), bool: new RegExp("^(?:" + nt + ")$", "i"), needsContext: new RegExp("^" + rt + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + rt + "*((?:-\\d)?\\d*)" + rt + "*\\)|)(?=[^-]|$)", "i") }, ht = /^(?:input|select|textarea|button)$/i, mt = /^h\d$/i, gt = /^[^{]+\{\s*\[native \w/, vt = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, yt = /[+~]/, bt = /'|\\/g, Ct = new RegExp("\\\\([\\da-f]{1,6}" + rt + "?|(" + rt + ")|.)", "ig"), xt = function (e, t, n) { var r = "0x" + t - 65536; return r !== r || n ? t : 0 > r ? String.fromCharCode(r + 65536) : String.fromCharCode(r >> 10 | 55296, 1023 & r | 56320) }; try { Z.apply(X = et.call(z.childNodes), z.childNodes), X[z.childNodes.length].nodeType } catch (wt) { Z = { apply: X.length ? function (e, t) { Q.apply(e, et.call(t)) } : function (e, t) { for (var n = e.length, r = 0; e[n++] = t[r++]; ); e.length = n - 1 } } } x = e.support = {}, E = e.isXML = function (e) { var t = e && (e.ownerDocument || e).documentElement; return t ? "HTML" !== t.nodeName : !1 }, B = e.setDocument = function (e) { var t, n = e ? e.ownerDocument || e : z, r = n.defaultView; return n !== D && 9 === n.nodeType && n.documentElement ? (D = n, L = n.documentElement, H = !E(n), r && r !== r.top && (r.addEventListener ? r.addEventListener("unload", function () { B() }, !1) : r.attachEvent && r.attachEvent("onunload", function () { B() })), x.attributes = i(function (e) { return e.className = "i", !e.getAttribute("className") }), x.getElementsByTagName = i(function (e) { return e.appendChild(n.createComment("")), !e.getElementsByTagName("*").length }), x.getElementsByClassName = gt.test(n.getElementsByClassName), x.getById = i(function (e) { return L.appendChild(e).id = F, !n.getElementsByName || !n.getElementsByName(F).length }), x.getById ? (w.find.ID = function (e, t) { if (typeof t.getElementById !== Y && H) { var n = t.getElementById(e); return n && n.parentNode ? [n] : [] } }, w.filter.ID = function (e) { var t = e.replace(Ct, xt); return function (e) { return e.getAttribute("id") === t } }) : (delete w.find.ID, w.filter.ID = function (e) { var t = e.replace(Ct, xt); return function (e) { var n = typeof e.getAttributeNode !== Y && e.getAttributeNode("id"); return n && n.value === t } }), w.find.TAG = x.getElementsByTagName ? function (e, t) { return typeof t.getElementsByTagName !== Y ? t.getElementsByTagName(e) : void 0 } : function (e, t) { var n, r = [], i = 0, o = t.getElementsByTagName(e); if ("*" === e) { for (; n = o[i++]; ) 1 === n.nodeType && r.push(n); return r } return o }, w.find.CLASS = x.getElementsByClassName && function (e, t) { return H ? t.getElementsByClassName(e) : void 0 }, P = [], M = [], (x.qsa = gt.test(n.querySelectorAll)) && (i(function (e) { e.innerHTML = "<select msallowcapture=''><option selected=''></option></select>", e.querySelectorAll("[msallowcapture^='']").length && M.push("[*^$]=" + rt + "*(?:''|\"\")"), e.querySelectorAll("[selected]").length || M.push("\\[" + rt + "*(?:value|" + nt + ")"), e.querySelectorAll(":checked").length || M.push(":checked") }), i(function (e) { var t = n.createElement("input"); t.setAttribute("type", "hidden"), e.appendChild(t).setAttribute("name", "D"), e.querySelectorAll("[name=d]").length && M.push("name" + rt + "*[*^$|!~]?="), e.querySelectorAll(":enabled").length || M.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), M.push(",.*:") })), (x.matchesSelector = gt.test(O = L.matches || L.webkitMatchesSelector || L.mozMatchesSelector || L.oMatchesSelector || L.msMatchesSelector)) && i(function (e) { x.disconnectedMatch = O.call(e, "div"), O.call(e, "[s!='']:x"), P.push("!=", at) }), M = M.length && new RegExp(M.join("|")), P = P.length && new RegExp(P.join("|")), t = gt.test(L.compareDocumentPosition), I = t || gt.test(L.contains) ? function (e, t) { var n = 9 === e.nodeType ? e.documentElement : e, r = t && t.parentNode; return e === r || !(!r || 1 !== r.nodeType || !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r))) } : function (e, t) { if (t) for (; t = t.parentNode; ) if (t === e) return !0; return !1 }, j = t ? function (e, t) { if (e === t) return A = !0, 0; var r = !e.compareDocumentPosition - !t.compareDocumentPosition; return r ? r : (r = (e.ownerDocument || e) === (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1, 1 & r || !x.sortDetached && t.compareDocumentPosition(e) === r ? e === n || e.ownerDocument === z && I(z, e) ? -1 : t === n || t.ownerDocument === z && I(z, t) ? 1 : R ? tt.call(R, e) - tt.call(R, t) : 0 : 4 & r ? -1 : 1) } : function (e, t) { if (e === t) return A = !0, 0; var r, i = 0, o = e.parentNode, s = t.parentNode, l = [e], c = [t]; if (!o || !s) return e === n ? -1 : t === n ? 1 : o ? -1 : s ? 1 : R ? tt.call(R, e) - tt.call(R, t) : 0; if (o === s) return a(e, t); for (r = e; r = r.parentNode; ) l.unshift(r); for (r = t; r = r.parentNode; ) c.unshift(r); for (; l[i] === c[i]; ) i++; return i ? a(l[i], c[i]) : l[i] === z ? -1 : c[i] === z ? 1 : 0 }, n) : D }, e.matches = function (t, n) { return e(t, null, null, n) }, e.matchesSelector = function (t, n) { if ((t.ownerDocument || t) !== D && B(t), n = n.replace(ut, "='$1']"), !(!x.matchesSelector || !H || P && P.test(n) || M && M.test(n))) try { var r = O.call(t, n); if (r || x.disconnectedMatch || t.document && 11 !== t.document.nodeType) return r } catch (i) { } return e(n, D, null, [t]).length > 0 }, e.contains = function (e, t) { return (e.ownerDocument || e) !== D && B(e), I(e, t) }, e.attr = function (e, n) { (e.ownerDocument || e) !== D && B(e); var r = w.attrHandle[n.toLowerCase()], i = r && G.call(w.attrHandle, n.toLowerCase()) ? r(e, n, !H) : t; return i !== t ? i : x.attributes || !H ? e.getAttribute(n) : (i = e.getAttributeNode(n)) && i.specified ? i.value : null }, e.error = function (e) { throw new Error("Syntax error, unrecognized expression: " + e) }, e.uniqueSort = function (e) { var t, n = [], r = 0, i = 0; if (A = !x.detectDuplicates, R = !x.sortStable && e.slice(0), e.sort(j), A) { for (; t = e[i++]; ) t === e[i] && (r = n.push(i)); for (; r--; ) e.splice(n[r], 1) } return R = null, e }, _ = e.getText = function (e) { var t, n = "", r = 0, i = e.nodeType; if (i) { if (1 === i || 9 === i || 11 === i) { if ("string" == typeof e.textContent) return e.textContent; for (e = e.firstChild; e; e = e.nextSibling) n += _(e) } else if (3 === i || 4 === i) return e.nodeValue } else for (; t = e[r++]; ) n += _(t); return n }, w = e.selectors = { cacheLength: 50, createPseudo: r, match: pt, attrHandle: {}, find: {}, relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling"} }, preFilter: { ATTR: function (e) { return e[1] = e[1].replace(Ct, xt), e[3] = (e[3] || e[4] || e[5] || "").replace(Ct, xt), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4) }, CHILD: function (t) { return t[1] = t[1].toLowerCase(), "nth" === t[1].slice(0, 3) ? (t[3] || e.error(t[0]), t[4] = +(t[4] ? t[5] + (t[6] || 1) : 2 * ("even" === t[3] || "odd" === t[3])), t[5] = +(t[7] + t[8] || "odd" === t[3])) : t[3] && e.error(t[0]), t }, PSEUDO: function (e) { var t, n = !e[6] && e[2]; return pt.CHILD.test(e[0]) ? null : (e[3] ? e[2] = e[4] || e[5] || "" : n && dt.test(n) && (t = N(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && (e[0] = e[0].slice(0, t), e[2] = n.slice(0, t)), e.slice(0, 3)) } }, filter: { TAG: function (e) { var t = e.replace(Ct, xt).toLowerCase(); return "*" === e ? function () { return !0 } : function (e) { return e.nodeName && e.nodeName.toLowerCase() === t } }, CLASS: function (e) { var t = U[e + " "]; return t || (t = new RegExp("(^|" + rt + ")" + e + "(" + rt + "|$)")) && U(e, function (e) { return t.test("string" == typeof e.className && e.className || typeof e.getAttribute !== Y && e.getAttribute("class") || "") }) }, ATTR: function (t, n, r) { return function (i) { var o = e.attr(i, t); return null == o ? "!=" === n : n ? (o += "", "=" === n ? o === r : "!=" === n ? o !== r : "^=" === n ? r && 0 === o.indexOf(r) : "*=" === n ? r && o.indexOf(r) > -1 : "$=" === n ? r && o.slice(-r.length) === r : "~=" === n ? (" " + o + " ").indexOf(r) > -1 : "|=" === n ? o === r || o.slice(0, r.length + 1) === r + "-" : !1) : !0 } }, CHILD: function (e, t, n, r, i) { var o = "nth" !== e.slice(0, 3), a = "last" !== e.slice(-4), s = "of-type" === t; return 1 === r && 0 === i ? function (e) { return !!e.parentNode } : function (t, n, l) { var c, u, d, f, p, h, m = o !== a ? "nextSibling" : "previousSibling", g = t.parentNode, v = s && t.nodeName.toLowerCase(), y = !l && !s; if (g) { if (o) { for (; m; ) { for (d = t; d = d[m]; ) if (s ? d.nodeName.toLowerCase() === v : 1 === d.nodeType) return !1; h = m = "only" === e && !h && "nextSibling" } return !0 } if (h = [a ? g.firstChild : g.lastChild], a && y) { for (u = g[F] || (g[F] = {}), c = u[e] || [], p = c[0] === W && c[1], f = c[0] === W && c[2], d = p && g.childNodes[p]; d = ++p && d && d[m] || (f = p = 0) || h.pop(); ) if (1 === d.nodeType && ++f && d === t) { u[e] = [W, p, f]; break } } else if (y && (c = (t[F] || (t[F] = {}))[e]) && c[0] === W) f = c[1]; else for (; (d = ++p && d && d[m] || (f = p = 0) || h.pop()) && ((s ? d.nodeName.toLowerCase() !== v : 1 !== d.nodeType) || ! ++f || (y && ((d[F] || (d[F] = {}))[e] = [W, f]), d !== t)); ); return f -= i, f === r || f % r === 0 && f / r >= 0 } } }, PSEUDO: function (t, n) { var i, o = w.pseudos[t] || w.setFilters[t.toLowerCase()] || e.error("unsupported pseudo: " + t); return o[F] ? o(n) : o.length > 1 ? (i = [t, t, "", n], w.setFilters.hasOwnProperty(t.toLowerCase()) ? r(function (e, t) { for (var r, i = o(e, n), a = i.length; a--; ) r = tt.call(e, i[a]), e[r] = !(t[r] = i[a]) }) : function (e) { return o(e, 0, i) }) : o } }, pseudos: { not: r(function (e) { var t = [], n = [], i = k(e.replace(st, "$1")); return i[F] ? r(function (e, t, n, r) { for (var o, a = i(e, null, r, []), s = e.length; s--; ) (o = a[s]) && (e[s] = !(t[s] = o)) }) : function (e, r, o) { return t[0] = e, i(t, null, o, n), !n.pop() } }), has: r(function (t) { return function (n) { return e(t, n).length > 0 } }), contains: r(function (e) { return e = e.replace(Ct, xt), function (t) { return (t.textContent || t.innerText || _(t)).indexOf(e) > -1 } }), lang: r(function (t) { return ft.test(t || "") || e.error("unsupported lang: " + t), t = t.replace(Ct, xt).toLowerCase(), function (e) { var n; do if (n = H ? e.lang : e.getAttribute("xml:lang") || e.getAttribute("lang")) return n = n.toLowerCase(), n === t || 0 === n.indexOf(t + "-"); while ((e = e.parentNode) && 1 === e.nodeType); return !1 } }), target: function (e) { var t = window.location && window.location.hash; return t && t.slice(1) === e.id }, root: function (e) { return e === L }, focus: function (e) { return e === D.activeElement && (!D.hasFocus || D.hasFocus()) && !!(e.type || e.href || ~e.tabIndex) }, enabled: function (e) { return e.disabled === !1 }, disabled: function (e) { return e.disabled === !0 }, checked: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && !!e.checked || "option" === t && !!e.selected }, selected: function (e) { return e.parentNode && e.parentNode.selectedIndex, e.selected === !0 }, empty: function (e) { for (e = e.firstChild; e; e = e.nextSibling) if (e.nodeType < 6) return !1; return !0 }, parent: function (e) { return !w.pseudos.empty(e) }, header: function (e) { return mt.test(e.nodeName) }, input: function (e) { return ht.test(e.nodeName) }, button: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && "button" === e.type || "button" === t }, text: function (e) { var t; return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || "text" === t.toLowerCase()) }, first: c(function () { return [0] }), last: c(function (e, t) { return [t - 1] }), eq: c(function (e, t, n) { return [0 > n ? n + t : n] }), even: c(function (e, t) { for (var n = 0; t > n; n += 2) e.push(n); return e }), odd: c(function (e, t) { for (var n = 1; t > n; n += 2) e.push(n); return e }), lt: c(function (e, t, n) { for (var r = 0 > n ? n + t : n; --r >= 0; ) e.push(r); return e }), gt: c(function (e, t, n) { for (var r = 0 > n ? n + t : n; ++r < t; ) e.push(r); return e })} }, w.pseudos.nth = w.pseudos.eq; for (C in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) w.pseudos[C] = s(C); for (C in { submit: !0, reset: !0 }) w.pseudos[C] = l(C); return d.prototype = w.filters = w.pseudos, w.setFilters = new d, N = e.tokenize = function (t, n) { var r, i, o, a, s, l, c, u = $[t + " "]; if (u) return n ? 0 : u.slice(0); for (s = t, l = [], c = w.preFilter; s; ) { (!r || (i = lt.exec(s))) && (i && (s = s.slice(i[0].length) || s), l.push(o = [])), r = !1, (i = ct.exec(s)) && (r = i.shift(), o.push({ value: r, type: i[0].replace(st, " ") }), s = s.slice(r.length)); for (a in w.filter) !(i = pt[a].exec(s)) || c[a] && !(i = c[a](i)) || (r = i.shift(), o.push({ value: r, type: a, matches: i }), s = s.slice(r.length)); if (!r) break } return n ? s.length : s ? e.error(t) : $(t, l).slice(0) }, k = e.compile = function (e, t) { var n, r = [], i = [], o = q[e + " "]; if (!o) { for (t || (t = N(e)), n = t.length; n--; ) o = y(t[n]), o[F] ? r.push(o) : i.push(o); o = q(e, b(i, r)), o.selector = e } return o }, S = e.select = function (e, t, n, r) { var i, o, a, s, l, c = "function" == typeof e && e, d = !r && N(e = c.selector || e); if (n = n || [], 1 === d.length) { if (o = d[0] = d[0].slice(0), o.length > 2 && "ID" === (a = o[0]).type && x.getById && 9 === t.nodeType && H && w.relative[o[1].type]) { if (t = (w.find.ID(a.matches[0].replace(Ct, xt), t) || [])[0], !t) return n; c && (t = t.parentNode), e = e.slice(o.shift().value.length) } for (i = pt.needsContext.test(e) ? 0 : o.length; i-- && (a = o[i], !w.relative[s = a.type]); ) if ((l = w.find[s]) && (r = l(a.matches[0].replace(Ct, xt), yt.test(o[0].type) && u(t.parentNode) || t))) { if (o.splice(i, 1), e = r.length && f(o), !e) return Z.apply(n, r), n; break } } return (c || k(e, d))(r, t, !H, n, yt.test(e) && u(t.parentNode) || t), n }, x.sortStable = F.split("").sort(j).join("") === F, x.detectDuplicates = !!A, B(), x.sortDetached = i(function (e) { return 1 & e.compareDocumentPosition(D.createElement("div")) }), i(function (e) { return e.innerHTML = "<a href='#'></a>", "#" === e.firstChild.getAttribute("href") }) || o("type|href|height|width", function (e, t, n) { return n ? void 0 : e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2) }), x.attributes && i(function (e) { return e.innerHTML = "<input/>", e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value") }) || o("value", function (e, t, n) { return n || "input" !== e.nodeName.toLowerCase() ? void 0 : e.defaultValue }), i(function (e) { return null == e.getAttribute("disabled") }) || o(nt, function (e, t, n) { var r; return n ? void 0 : e[t] === !0 ? t.toLowerCase() : (r = e.getAttributeNode(t)) && r.specified ? r.value : null }), e }), r(u, [], function () { function e(e) { return null === e || e === t ? "" : ("" + e).replace(m, "") } function n(e, n) { return n ? "array" == n && g(e) ? !0 : typeof e == n : e !== t } function r(e) { var t = e, n, r; if (!g(e)) for (t = [], n = 0, r = e.length; r > n; n++) t[n] = e[n]; return t } function i(e, t, n) { var r; for (e = e || [], t = t || ",", "string" == typeof e && (e = e.split(t)), n = n || {}, r = e.length; r--; ) n[e[r]] = {}; return n } function o(e, n, r) { var i, o; if (!e) return 0; if (r = r || e, e.length !== t) { for (i = 0, o = e.length; o > i; i++) if (n.call(r, e[i], i, e) === !1) return 0 } else for (i in e) if (e.hasOwnProperty(i) && n.call(r, e[i], i, e) === !1) return 0; return 1 } function a(e, t) { var n = []; return o(e, function (e) { n.push(t(e)) }), n } function s(e, t) { var n = []; return o(e, function (e) { (!t || t(e)) && n.push(e) }), n } function l(e, t, n) { var r = this, i, o, a, s, l, c = 0; if (e = /^((static) )?([\w.]+)(:([\w.]+))?/.exec(e), a = e[3].match(/(^|\.)(\w+)$/i)[2], o = r.createNS(e[3].replace(/\.\w+$/, ""), n), !o[a]) { if ("static" == e[2]) return o[a] = t, void (this.onCreate && this.onCreate(e[2], e[3], o[a])); t[a] || (t[a] = function () { }, c = 1), o[a] = t[a], r.extend(o[a].prototype, t), e[5] && (i = r.resolve(e[5]).prototype, s = e[5].match(/\.(\w+)$/i)[1], l = o[a], o[a] = c ? function () { return i[s].apply(this, arguments) } : function () { return this.parent = i[s], l.apply(this, arguments) }, o[a].prototype[a] = o[a], r.each(i, function (e, t) { o[a].prototype[t] = i[t] }), r.each(t, function (e, t) { i[t] ? o[a].prototype[t] = function () { return this.parent = i[t], e.apply(this, arguments) } : t != a && (o[a].prototype[t] = e) })), r.each(t["static"], function (e, t) { o[a][t] = e }) } } function c(e, t) { var n, r; if (e) for (n = 0, r = e.length; r > n; n++) if (e[n] === t) return n; return -1 } function u(e, n) { var r, i, o, a = arguments, s; for (r = 1, i = a.length; i > r; r++) { n = a[r]; for (o in n) n.hasOwnProperty(o) && (s = n[o], s !== t && (e[o] = s)) } return e } function d(e, t, n, r) { r = r || this, e && (n && (e = e[n]), o(e, function (e, i) { return t.call(r, e, i, n) === !1 ? !1 : void d(e, t, n, r) })) } function f(e, t) { var n, r; for (t = t || window, e = e.split("."), n = 0; n < e.length; n++) r = e[n], t[r] || (t[r] = {}), t = t[r]; return t } function p(e, t) { var n, r; for (t = t || window, e = e.split("."), n = 0, r = e.length; r > n && (t = t[e[n]], t); n++); return t } function h(t, r) { return !t || n(t, "array") ? t : a(t.split(r || ","), e) } var m = /^\s*|\s*$/g, g = Array.isArray || function (e) { return "[object Array]" === Object.prototype.toString.call(e) }; return { trim: e, isArray: g, is: n, toArray: r, makeMap: i, each: o, map: a, grep: s, inArray: c, extend: u, create: l, walk: d, createNS: f, resolve: p, explode: h} }), r(d, [], function () { var e = navigator, t = e.userAgent, n, r, i, o, a, s, l; n = window.opera && window.opera.buildNumber, r = /WebKit/.test(t), i = !r && !n && /MSIE/gi.test(t) && /Explorer/gi.test(e.appName), i = i && /MSIE (\w+)\./.exec(t)[1], o = -1 == t.indexOf("Trident/") || -1 == t.indexOf("rv:") && -1 == e.appName.indexOf("Netscape") ? !1 : 11, i = i || o, a = !r && !o && /Gecko/.test(t), s = -1 != t.indexOf("Mac"), l = /(iPad|iPhone)/.test(t); var c = !l || t.match(/AppleWebKit\/(\d*)/)[1] >= 534; return { opera: n, webkit: r, ie: i, gecko: a, mac: s, iOS: l, contentEditable: c, transparentSrc: "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7", caretAfter: 8 != i, range: window.getSelection && "Range" in window, documentMode: i ? document.documentMode || 7 : 10} }), r(f, [l, c, u, d], function (e, n, r, i) { function o(e) { return "undefined" != typeof e } function a(e) { return "string" == typeof e } function s(e, t) { var n, r, i; for (t = t || x, i = t.createElement("div"), n = t.createDocumentFragment(), i.innerHTML = e; r = i.firstChild; ) n.appendChild(r); return n } function l(e, t, n, r) { var i; if (a(t)) t = s(t, g(e[0])); else if (t.length && !t.nodeType) { if (t = d.makeArray(t), r) for (i = t.length - 1; i >= 0; i--) l(e, t[i], n, r); else for (i = 0; i < t.length; i++) l(e, t[i], n, r); return e } if (t.nodeType) for (i = e.length; i--; ) n.call(e[i], t); return e } function c(e, t) { return e && t && -1 !== (" " + e.className + " ").indexOf(" " + t + " ") } function u(e, t, n) { var r, i; return t = d(t)[0], e.each(function () { var e = this; n && r == e.parentNode ? i.appendChild(e) : (r = e.parentNode, i = t.cloneNode(!1), e.parentNode.insertBefore(i, e), i.appendChild(e)) }), e } function d(e, t) { return new d.fn.init(e, t) } function f(e, t) { var n; if (t.indexOf) return t.indexOf(e); for (n = t.length; n--; ) if (t[n] === e) return n; return -1 } function p(e) { return null === e || e === k ? "" : ("" + e).replace(L, "") } function h(e, t) { var n, r, i, o, a; if (e) if (n = e.length, n === o) { for (r in e) if (e.hasOwnProperty(r) && (a = e[r], t.call(a, r, a) === !1)) break } else for (i = 0; n > i && (a = e[i], t.call(a, i, a) !== !1); i++); return e } function m(e, t) { var n = []; return h(e, function (e, r) { t(r, e) && n.push(r) }), n } function g(e) { return e ? 9 == e.nodeType ? e : e.ownerDocument : x } function v(e, n, r) { var i = [], o = e[n]; for ("string" != typeof r && r instanceof d && (r = r[0]); o && 9 !== o.nodeType; ) { if (r !== t) { if (o === r) break; if ("string" == typeof r && d(o).is(r)) break } 1 === o.nodeType && i.push(o), o = o[n] } return i } function y(e, n, r, i) { var o = []; for (i instanceof d && (i = i[0]); e; e = e[n]) if (!r || e.nodeType === r) { if (i !== t) { if (e === i) break; if ("string" == typeof i && d(e).is(i)) break } o.push(e) } return o } function b(e, t, n) { for (e = e[t]; e; e = e[t]) if (e.nodeType == n) return e; return null } function C(e, t, n) { h(n, function (n, r) { e[n] = e[n] || {}, e[n][t] = r }) } var x = document, w = Array.prototype.push, _ = Array.prototype.slice, E = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, N = e.Event, k, S = r.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom", " "), T = r.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected", " "), R = { "for": "htmlFor", "class": "className", readonly: "readOnly" }, A = { "float": "cssFloat" }, B = {}, D = {}, L = /^\s*|\s*$/g; return d.fn = d.prototype = { constructor: d, selector: "", context: null, length: 0, init: function (e, t) { var n = this, r, i; if (!e) return n; if (e.nodeType) return n.context = n[0] = e, n.length = 1, n; if (t && t.nodeType) n.context = t; else { if (t) return d(e).attr(t); n.context = t = document } if (a(e)) { if (n.selector = e, r = "<" === e.charAt(0) && ">" === e.charAt(e.length - 1) && e.length >= 3 ? [null, e, null] : E.exec(e), !r) return d(t).find(e); if (r[1]) for (i = s(e, g(t)).firstChild; i; ) w.call(n, i), i = i.nextSibling; else { if (i = g(t).getElementById(r[2]), !i) return n; if (i.id !== r[2]) return n.find(e); n.length = 1, n[0] = i } } else this.add(e, !1); return n }, toArray: function () { return r.toArray(this) }, add: function (e, t) { var n = this, r, i; if (a(e)) return n.add(d(e)); if (e.nodeType) return n.add([e]); if (t !== !1) for (r = d.unique(n.toArray().concat(d.makeArray(e))), n.length = r.length, i = 0; i < r.length; i++) n[i] = r[i]; else w.apply(n, d.makeArray(e)); return n }, attr: function (e, t) { var n = this, r; if ("object" == typeof e) h(e, function (e, t) { n.attr(e, t) }); else { if (!o(t)) { if (n[0] && 1 === n[0].nodeType) { if (r = B[e], r && r.get) return r.get(n[0], e); if (T[e]) return n.prop(e) ? e : k; t = n[0].getAttribute(e, 2), null === t && (t = k) } return t } this.each(function () { var n; if (1 === this.nodeType) { if (n = B[e], n && n.set) return void n.set(this, t); null === t ? this.removeAttribute(e, 2) : this.setAttribute(e, t, 2) } }) } return n }, removeAttr: function (e) { return this.attr(e, null) }, prop: function (e, t) { var n = this; if (e = R[e] || e, "object" == typeof e) h(e, function (e, t) { n.prop(e, t) }); else { if (!o(t)) return n[0] && n[0].nodeType && e in n[0] ? n[0][e] : t; this.each(function () { 1 == this.nodeType && (this[e] = t) }) } return n }, css: function (e, t) { function n(e) { return e.replace(/-(\D)/g, function (e, t) { return t.toUpperCase() }) } function r(e) { return e.replace(/[A-Z]/g, function (e) { return "-" + e }) } var i = this, a, s; if ("object" == typeof e) h(e, function (e, t) { i.css(e, t) }); else if (o(t)) e = n(e), "number" != typeof t || S[e] || (t += "px"), i.each(function () { var n = this.style; if (s = D[e], s && s.set) return void s.set(this, t); try { this.style[A[e] || e] = t } catch (i) { } (null === t || "" === t) && (n.removeProperty ? n.removeProperty(r(e)) : n.removeAttribute(e)) }); else { if (a = i[0], s = D[e], s && s.get) return s.get(a); if (a.ownerDocument.defaultView) try { return a.ownerDocument.defaultView.getComputedStyle(a, null).getPropertyValue(r(e)) } catch (l) { return k } else if (a.currentStyle) return a.currentStyle[n(e)] } return i }, remove: function () { for (var e = this, t, n = this.length; n--; ) t = e[n], N.clean(t), t.parentNode && t.parentNode.removeChild(t); return this }, empty: function () { for (var e = this, t, n = this.length; n--; ) for (t = e[n]; t.firstChild; ) t.removeChild(t.firstChild); return this }, html: function (e) { var t = this, n; if (o(e)) { n = t.length; try { for (; n--; ) t[n].innerHTML = e } catch (r) { d(t[n]).empty().append(e) } return t } return t[0] ? t[0].innerHTML : "" }, text: function (e) { var t = this, n; if (o(e)) { for (n = t.length; n--; ) "innerText" in t[n] ? t[n].innerText = e : t[0].textContent = e; return t } return t[0] ? t[0].innerText || t[0].textContent : "" }, append: function () { return l(this, arguments, function (e) { 1 === this.nodeType && this.appendChild(e) }) }, prepend: function () { return l(this, arguments, function (e) { 1 === this.nodeType && this.insertBefore(e, this.firstChild) }, !0) }, before: function () { var e = this; return e[0] && e[0].parentNode ? l(e, arguments, function (e) { this.parentNode.insertBefore(e, this) }) : e }, after: function () { var e = this; return e[0] && e[0].parentNode ? l(e, arguments, function (e) { this.parentNode.insertBefore(e, this.nextSibling) }, !0) : e }, appendTo: function (e) { return d(e).append(this), this }, prependTo: function (e) { return d(e).prepend(this), this }, replaceWith: function (e) { return this.before(e).remove() }, wrap: function (e) { return u(this, e) }, wrapAll: function (e) { return u(this, e, !0) }, wrapInner: function (e) { return this.each(function () { d(this).contents().wrapAll(e) }), this }, unwrap: function () { return this.parent().each(function () { d(this).replaceWith(this.childNodes) }) }, clone: function () { var e = []; return this.each(function () { e.push(this.cloneNode(!0)) }), d(e) }, addClass: function (e) { return this.toggleClass(e, !0) }, removeClass: function (e) { return this.toggleClass(e, !1) }, toggleClass: function (e, t) { var n = this; return "string" != typeof e ? n : (-1 !== e.indexOf(" ") ? h(e.split(" "), function () { n.toggleClass(this, t) }) : n.each(function (n, r) { var i, o; o = c(r, e), o !== t && (i = r.className, o ? r.className = p((" " + i + " ").replace(" " + e + " ", " ")) : r.className += i ? " " + e : e) }), n) }, hasClass: function (e) { return c(this[0], e) }, each: function (e) { return h(this, e) }, on: function (e, t) { return this.each(function () { N.bind(this, e, t) }) }, off: function (e, t) { return this.each(function () { N.unbind(this, e, t) }) }, trigger: function (e) { return this.each(function () { "object" == typeof e ? N.fire(this, e.type, e) : N.fire(this, e) }) }, show: function () { return this.css("display", "") }, hide: function () { return this.css("display", "none") }, slice: function () { return new d(_.apply(this, arguments)) }, eq: function (e) { return -1 === e ? this.slice(e) : this.slice(e, +e + 1) }, first: function () { return this.eq(0) }, last: function () { return this.eq(-1) }, find: function (e) { var t, n, r = []; for (t = 0, n = this.length; n > t; t++) d.find(e, this[t], r); return d(r) }, filter: function (e) { return d("function" == typeof e ? m(this.toArray(), function (t, n) { return e(n, t) }) : d.filter(e, this.toArray())) }, closest: function (e) { var t = []; return e instanceof d && (e = e[0]), this.each(function (n, r) { for (; r; ) { if ("string" == typeof e && d(r).is(e)) { t.push(r); break } if (r == e) { t.push(r); break } r = r.parentNode } }), d(t) }, offset: function (e) { var t, n, r, i = 0, o = 0, a; return e ? this.css(e) : (t = this[0], t && (n = t.ownerDocument, r = n.documentElement, t.getBoundingClientRect && (a = t.getBoundingClientRect(), i = a.left + (r.scrollLeft || n.body.scrollLeft) - r.clientLeft, o = a.top + (r.scrollTop || n.body.scrollTop) - r.clientTop)), { left: i, top: o }) }, push: w, sort: [].sort, splice: [].splice }, r.extend(d, { extend: r.extend, makeArray: r.toArray, inArray: f, isArray: r.isArray, each: h, trim: p, grep: m, find: n, expr: n.selectors, unique: n.uniqueSort, text: n.getText, contains: n.contains, filter: function (e, t, n) { var r = t.length; for (n && (e = ":not(" + e + ")"); r--; ) 1 != t[r].nodeType && t.splice(r, 1); return t = 1 === t.length ? d.find.matchesSelector(t[0], e) ? [t[0]] : [] : d.find.matches(e, t) } }), h({ parent: function (e) { var t = e.parentNode; return t && 11 !== t.nodeType ? t : null }, parents: function (e) { return v(e, "parentNode") }, next: function (e) { return b(e, "nextSibling", 1) }, prev: function (e) { return b(e, "previousSibling", 1) }, children: function (e) { return y(e.firstChild, "nextSibling", 1) }, contents: function (e) { return r.toArray(("iframe" === e.nodeName ? e.contentDocument || e.contentWindow.document : e).childNodes) } }, function (e, t) { d.fn[e] = function (n) { var r = this, i = []; return r.each(function () { var e = t.call(i, this, n, i); e && (d.isArray(e) ? i.push.apply(i, e) : i.push(e)) }), this.length > 1 && (i = d.unique(i), 0 === e.indexOf("parents") && (i = i.reverse())), i = d(i), n ? i.filter(n) : i } }), h({ parentsUntil: function (e, t) { return v(e, "parentNode", t) }, nextUntil: function (e, t) { return y(e, "nextSibling", 1, t).slice(1) }, prevUntil: function (e, t) { return y(e, "previousSibling", 1, t).slice(1) } }, function (e, t) { d.fn[e] = function (n, r) { var i = this, o = []; return i.each(function () { var e = t.call(o, this, n, o); e && (d.isArray(e) ? o.push.apply(o, e) : o.push(e)) }), this.length > 1 && (o = d.unique(o), (0 === e.indexOf("parents") || "prevUntil" === e) && (o = o.reverse())), o = d(o), r ? o.filter(r) : o } }), d.fn.is = function (e) { return !!e && this.filter(e).length > 0 }, d.fn.init.prototype = d.fn, d.overrideDefaults = function (e) { function t(r, i) { return n = n || e(), 0 === arguments.length && (r = n.element), i || (i = n.context), new t.fn.init(r, i) } var n; return d.extend(t, this), t }, i.ie && i.ie < 8 && (C(B, "get", { maxlength: function (e) { var t = e.maxLength; return 2147483647 === t ? k : t }, size: function (e) { var t = e.size; return 20 === t ? k : t }, "class": function (e) { return e.className }, style: function (e) { var t = e.style.cssText; return 0 === t.length ? k : t } }), C(B, "set", { "class": function (e, t) { e.className = t }, style: function (e, t) { e.style.cssText = t } })), i.ie && i.ie < 9 && (A["float"] = "styleFloat", C(D, "set", { opacity: function (e, t) { var n = e.style; null === t || "" === t ? n.removeAttribute("filter") : (n.zoom = 1, n.filter = "alpha(opacity=" + 100 * t + ")") } })), d.attrHooks = B, d.cssHooks = D, d }), r(p, [], function () { return function (e, t) { function n(e, t, n, r) { function i(e) { return e = parseInt(e, 10).toString(16), e.length > 1 ? e : "0" + e } return "#" + i(t) + i(n) + i(r) } var r = /rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi, i = /(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi, o = /\s*([^:]+):\s*([^;]+);?/g, a = /\s+$/, s, l, c = {}, u, d, f, p = "\ufeff"; for (e = e || {}, t && (d = t.getValidStyles(), f = t.getInvalidStyles()), u = ("\\\" \\' \\; \\: ; : " + p).split(" "), l = 0; l < u.length; l++) c[u[l]] = p + l, c[p + l] = u[l]; return { toHex: function (e) { return e.replace(r, n) }, parse: function (t) { function s(e, t, n) { var r, i, o, a; if (r = m[e + "-top" + t], r && (i = m[e + "-right" + t], i && (o = m[e + "-bottom" + t], o && (a = m[e + "-left" + t])))) { var s = [r, i, o, a]; for (l = s.length - 1; l-- && s[l] === s[l + 1]; ); l > -1 && n || (m[e + t] = -1 == l ? s[0] : s.join(" "), delete m[e + "-top" + t], delete m[e + "-right" + t], delete m[e + "-bottom" + t], delete m[e + "-left" + t]) } } function u(e) { var t = m[e], n; if (t) { for (t = t.split(" "), n = t.length; n--; ) if (t[n] !== t[0]) return !1; return m[e] = t[0], !0 } } function d(e, t, n, r) { u(t) && u(n) && u(r) && (m[e] = m[t] + " " + m[n] + " " + m[r], delete m[t], delete m[n], delete m[r]) } function f(e) { return b = !0, c[e] } function p(e, t) { return b && (e = e.replace(/\uFEFF[0-9]/g, function (e) { return c[e] })), t || (e = e.replace(/\\([\'\";:])/g, "$1")), e } function h(t, n, r, i, o, a) { if (o = o || a) return o = p(o), "'" + o.replace(/\'/g, "\\'") + "'"; if (n = p(n || r || i), !e.allow_script_urls) { var s = n.replace(/[\s\r\n]+/, ""); if (/(java|vb)script:/i.test(s)) return ""; if (!e.allow_svg_data_urls && /^data:image\/svg/i.test(s)) return "" } return C && (n = C.call(x, n, "style")), "url('" + n.replace(/\'/g, "\\'") + "')" } var m = {}, g, v, y, b, C = e.url_converter, x = e.url_converter_scope || this; if (t) { for (t = t.replace(/[\u0000-\u001F]/g, ""), t = t.replace(/\\[\"\';:\uFEFF]/g, f).replace(/\"[^\"]+\"|\'[^\']+\'/g, function (e) { return e.replace(/[;:]/g, f) }); g = o.exec(t); ) { if (v = g[1].replace(a, "").toLowerCase(), y = g[2].replace(a, ""), y = y.replace(/\\[0-9a-f]+/g, function (e) { return String.fromCharCode(parseInt(e.substr(1), 16)) }), v && y.length > 0) { if (!e.allow_script_urls && ("behavior" == v || /expression\s*\(|\/\*|\*\//.test(y))) continue; "font-weight" === v && "700" === y ? y = "bold" : ("color" === v || "background-color" === v) && (y = y.toLowerCase()), y = y.replace(r, n), y = y.replace(i, h), m[v] = b ? p(y, !0) : y } o.lastIndex = g.index + g[0].length } s("border", "", !0), s("border", "-width"), s("border", "-color"), s("border", "-style"), s("padding", ""), s("margin", ""), d("border", "border-width", "border-style", "border-color"), "medium none" === m.border && delete m.border, "none" === m["border-image"] && delete m["border-image"] } return m }, serialize: function (e, t) { function n(t) { var n, r, o, a; if (n = d[t]) for (r = 0, o = n.length; o > r; r++) t = n[r], a = e[t], a !== s && a.length > 0 && (i += (i.length > 0 ? " " : "") + t + ": " + a + ";") } function r(e, t) { var n; return n = f["*"], n && n[e] ? !1 : (n = f[t], n && n[e] ? !1 : !0) } var i = "", o, a; if (t && d) n("*"), n(t); else for (o in e) a = e[o], a !== s && a.length > 0 && (!f || r(o, t)) && (i += (i.length > 0 ? " " : "") + o + ": " + a + ";"); return i } } } }), r(h, [], function () { return function (e, t) { function n(e, n, r, i) { var o, a; if (e) { if (!i && e[n]) return e[n]; if (e != t) { if (o = e[r]) return o; for (a = e.parentNode; a && a != t; a = a.parentNode) if (o = a[r]) return o } } } var r = e; this.current = function () { return r }, this.next = function (e) { return r = n(r, "firstChild", "nextSibling", e) }, this.prev = function (e) { return r = n(r, "lastChild", "previousSibling", e) } } }), r(m, [u], function (e) { function t(n) { function r() { return M.createDocumentFragment() } function i(e, t) { _(F, e, t) } function o(e, t) { _(z, e, t) } function a(e) { i(e.parentNode, j(e)) } function s(e) { i(e.parentNode, j(e) + 1) } function l(e) { o(e.parentNode, j(e)) } function c(e) { o(e.parentNode, j(e) + 1) } function u(e) { e ? (H[U] = H[V], H[$] = H[W]) : (H[V] = H[U], H[W] = H[$]), H.collapsed = F } function d(e) { a(e), c(e) } function f(e) { i(e, 0), o(e, 1 === e.nodeType ? e.childNodes.length : e.nodeValue.length) } function p(e, t) { var n = H[V], r = H[W], i = H[U], o = H[$], a = t.startContainer, s = t.startOffset, l = t.endContainer, c = t.endOffset; return 0 === e ? w(n, r, a, s) : 1 === e ? w(i, o, a, s) : 2 === e ? w(i, o, l, c) : 3 === e ? w(n, r, l, c) : void 0 } function h() { E(I) } function m() { return E(P) } function g() { return E(O) } function v(e) { var t = this[V], r = this[W], i, o; 3 !== t.nodeType && 4 !== t.nodeType || !t.nodeValue ? (t.childNodes.length > 0 && (o = t.childNodes[r]), o ? t.insertBefore(e, o) : 3 == t.nodeType ? n.insertAfter(e, t) : t.appendChild(e)) : r ? r >= t.nodeValue.length ? n.insertAfter(e, t) : (i = t.splitText(r), t.parentNode.insertBefore(e, i)) : t.parentNode.insertBefore(e, t) } function y(e) { var t = H.extractContents(); H.insertNode(e), e.appendChild(t), H.selectNode(e) } function b() { return q(new t(n), { startContainer: H[V], startOffset: H[W], endContainer: H[U], endOffset: H[$], collapsed: H.collapsed, commonAncestorContainer: H.commonAncestorContainer }) } function C(e, t) { var n; if (3 == e.nodeType) return e; if (0 > t) return e; for (n = e.firstChild; n && t > 0; ) --t, n = n.nextSibling; return n ? n : e } function x() { return H[V] == H[U] && H[W] == H[$] } function w(e, t, r, i) { var o, a, s, l, c, u; if (e == r) return t == i ? 0 : i > t ? -1 : 1; for (o = r; o && o.parentNode != e; ) o = o.parentNode; if (o) { for (a = 0, s = e.firstChild; s != o && t > a; ) a++, s = s.nextSibling; return a >= t ? -1 : 1 } for (o = e; o && o.parentNode != r; ) o = o.parentNode; if (o) { for (a = 0, s = r.firstChild; s != o && i > a; ) a++, s = s.nextSibling; return i > a ? -1 : 1 } for (l = n.findCommonAncestor(e, r), c = e; c && c.parentNode != l; ) c = c.parentNode; for (c || (c = l), u = r; u && u.parentNode != l; ) u = u.parentNode; if (u || (u = l), c == u) return 0; for (s = l.firstChild; s; ) { if (s == c) return -1; if (s == u) return 1; s = s.nextSibling } } function _(e, t, r) { var i, o; for (e ? (H[V] = t, H[W] = r) : (H[U] = t, H[$] = r), i = H[U]; i.parentNode; ) i = i.parentNode; for (o = H[V]; o.parentNode; ) o = o.parentNode; o == i ? w(H[V], H[W], H[U], H[$]) > 0 && H.collapse(e) : H.collapse(e), H.collapsed = x(), H.commonAncestorContainer = n.findCommonAncestor(H[V], H[U]) } function E(e) { var t, n = 0, r = 0, i, o, a, s, l, c; if (H[V] == H[U]) return N(e); for (t = H[U], i = t.parentNode; i; t = i, i = i.parentNode) { if (i == H[V]) return k(t, e); ++n } for (t = H[V], i = t.parentNode; i; t = i, i = i.parentNode) { if (i == H[U]) return S(t, e); ++r } for (o = r - n, a = H[V]; o > 0; ) a = a.parentNode, o--; for (s = H[U]; 0 > o; ) s = s.parentNode, o++; for (l = a.parentNode, c = s.parentNode; l != c; l = l.parentNode, c = c.parentNode) a = l, s = c; return T(a, s, e) } function N(e) { var t, n, i, o, a, s, l, c, u; if (e != I && (t = r()), H[W] == H[$]) return t; if (3 == H[V].nodeType) { if (n = H[V].nodeValue, i = n.substring(H[W], H[$]), e != O && (o = H[V], c = H[W], u = H[$] - H[W], 0 === c && u >= o.nodeValue.length - 1 ? o.parentNode.removeChild(o) : o.deleteData(c, u), H.collapse(F)), e == I) return; return i.length > 0 && t.appendChild(M.createTextNode(i)), t } for (o = C(H[V], H[W]), a = H[$] - H[W]; o && a > 0; ) s = o.nextSibling, l = D(o, e), t && t.appendChild(l), --a, o = s; return e != O && H.collapse(F), t } function k(e, t) { var n, i, o, a, s, l; if (t != I && (n = r()), i = R(e, t), n && n.appendChild(i), o = j(e), a = o - H[W], 0 >= a) return t != O && (H.setEndBefore(e), H.collapse(z)), n; for (i = e.previousSibling; a > 0; ) s = i.previousSibling, l = D(i, t), n && n.insertBefore(l, n.firstChild), --a, i = s; return t != O && (H.setEndBefore(e), H.collapse(z)), n } function S(e, t) { var n, i, o, a, s, l; for (t != I && (n = r()), o = A(e, t), n && n.appendChild(o), i = j(e), ++i, a = H[$] - i, o = e.nextSibling; o && a > 0; ) s = o.nextSibling, l = D(o, t), n && n.appendChild(l), --a, o = s; return t != O && (H.setStartAfter(e), H.collapse(F)), n } function T(e, t, n) { var i, o, a, s, l, c, u; for (n != I && (o = r()), i = A(e, n), o && o.appendChild(i), a = j(e), s = j(t), ++a, l = s - a, c = e.nextSibling; l > 0; ) u = c.nextSibling, i = D(c, n), o && o.appendChild(i), c = u, --l; return i = R(t, n), o && o.appendChild(i), n != O && (H.setStartAfter(e), H.collapse(F)), o } function R(e, t) { var n = C(H[U], H[$] - 1), r, i, o, a, s, l = n != H[U]; if (n == e) return B(n, l, z, t); for (r = n.parentNode, i = B(r, z, z, t); r; ) { for (; n; ) o = n.previousSibling, a = B(n, l, z, t), t != I && i.insertBefore(a, i.firstChild), l = F, n = o; if (r == e) return i; n = r.previousSibling, r = r.parentNode, s = B(r, z, z, t), t != I && s.appendChild(i), i = s } } function A(e, t) { var n = C(H[V], H[W]), r = n != H[V], i, o, a, s, l; if (n == e) return B(n, r, F, t); for (i = n.parentNode, o = B(i, z, F, t); i; ) { for (; n; ) a = n.nextSibling, s = B(n, r, F, t), t != I && o.appendChild(s), r = F, n = a; if (i == e) return o; n = i.nextSibling, i = i.parentNode, l = B(i, z, F, t), t != I && l.appendChild(o), o = l } } function B(e, t, r, i) { var o, a, s, l, c; if (t) return D(e, i); if (3 == e.nodeType) { if (o = e.nodeValue, r ? (l = H[W], a = o.substring(l), s = o.substring(0, l)) : (l = H[$], a = o.substring(0, l), s = o.substring(l)), i != O && (e.nodeValue = s), i == I) return; return c = n.clone(e, z), c.nodeValue = a, c } if (i != I) return n.clone(e, z) } function D(e, t) { return t != I ? t == O ? n.clone(e, F) : e : void e.parentNode.removeChild(e) } function L() { return n.create("body", null, g()).outerText } var H = this, M = n.doc, P = 0, O = 1, I = 2, F = !0, z = !1, W = "startOffset", V = "startContainer", U = "endContainer", $ = "endOffset", q = e.extend, j = n.nodeIndex; return q(H, { startContainer: M, startOffset: 0, endContainer: M, endOffset: 0, collapsed: F, commonAncestorContainer: M, START_TO_START: 0, START_TO_END: 1, END_TO_END: 2, END_TO_START: 3, setStart: i, setEnd: o, setStartBefore: a, setStartAfter: s, setEndBefore: l, setEndAfter: c, collapse: u, selectNode: d, selectNodeContents: f, compareBoundaryPoints: p, deleteContents: h, extractContents: m, cloneContents: g, insertNode: v, surroundContents: y, cloneRange: b, toStringIE: L }), H } return t.prototype.toString = function () { return this.toStringIE() }, t }), r(g, [u], function (e) { function t(e) { var t; return t = document.createElement("div"), t.innerHTML = e, t.textContent || t.innerText || e } function n(e, t) { var n, r, i, a = {}; if (e) { for (e = e.split(","), t = t || 10, n = 0; n < e.length; n += 2) r = String.fromCharCode(parseInt(e[n], t)), o[r] || (i = "&" + e[n + 1] + ";", a[r] = i, a[i] = r); return a } } var r = e.makeMap, i, o, a, s = /[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g, l = /[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g, c = /[<>&\"\']/g, u = /&(#x|#)?([\w]+);/g, d = { 128: "\u20ac", 130: "\u201a", 131: "\u0192", 132: "\u201e", 133: "\u2026", 134: "\u2020", 135: "\u2021", 136: "\u02c6", 137: "\u2030", 138: "\u0160", 139: "\u2039", 140: "\u0152", 142: "\u017d", 145: "\u2018", 146: "\u2019", 147: "\u201c", 148: "\u201d", 149: "\u2022", 150: "\u2013", 151: "\u2014", 152: "\u02dc", 153: "\u2122", 154: "\u0161", 155: "\u203a", 156: "\u0153", 158: "\u017e", 159: "\u0178" }; o = { '"': "&quot;", "'": "&#39;", "<": "&lt;", ">": "&gt;", "&": "&amp;", "`": "&#96;" }, a = { "&lt;": "<", "&gt;": ">", "&amp;": "&", "&quot;": '"', "&apos;": "'" }, i = n("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro", 32); var f = { encodeRaw: function (e, t) { return e.replace(t ? s : l, function (e) { return o[e] || e }) }, encodeAllRaw: function (e) { return ("" + e).replace(c, function (e) { return o[e] || e }) }, encodeNumeric: function (e, t) { return e.replace(t ? s : l, function (e) { return e.length > 1 ? "&#" + (1024 * (e.charCodeAt(0) - 55296) + (e.charCodeAt(1) - 56320) + 65536) + ";" : o[e] || "&#" + e.charCodeAt(0) + ";" }) }, encodeNamed: function (e, t, n) { return n = n || i, e.replace(t ? s : l, function (e) { return o[e] || n[e] || e }) }, getEncodeFunc: function (e, t) { function a(e, n) { return e.replace(n ? s : l, function (e) { return o[e] || t[e] || "&#" + e.charCodeAt(0) + ";" || e }) } function c(e, n) { return f.encodeNamed(e, n, t) } return t = n(t) || i, e = r(e.replace(/\+/g, ",")), e.named && e.numeric ? a : e.named ? t ? c : f.encodeNamed : e.numeric ? f.encodeNumeric : f.encodeRaw }, decode: function (e) { return e.replace(u, function (e, n, r) { return n ? (r = parseInt(r, 2 === n.length ? 16 : 10), r > 65535 ? (r -= 65536, String.fromCharCode(55296 + (r >> 10), 56320 + (1023 & r))) : d[r] || String.fromCharCode(r)) : a[e] || i[e] || t(e) }) } }; return f }), r(v, [], function () { return function (e, t) { function n(t) { e.getElementsByTagName("head")[0].appendChild(t) } function r(t, r, s) { function l() { for (var e = v.passed, t = e.length; t--; ) e[t](); v.status = 2, v.passed = [], v.failed = [] } function c() { for (var e = v.failed, t = e.length; t--; ) e[t](); v.status = 3, v.passed = [], v.failed = [] } function u() { var e = navigator.userAgent.match(/WebKit\/(\d*)/); return !!(e && e[1] < 536) } function d(e, t) { e() || ((new Date).getTime() - g < a ? window.setTimeout(t, 0) : c()) } function f() { d(function () { for (var t = e.styleSheets, n, r = t.length, i; r--; ) if (n = t[r], i = n.ownerNode ? n.ownerNode : n.owningElement, i && i.id === h.id) return l(), !0 }, f) } function p() { d(function () { try { var e = m.sheet.cssRules; return l(), !!e } catch (t) { } }, p) } var h, m, g, v; if (o[t] ? v = o[t] : (v = { passed: [], failed: [] }, o[t] = v), r && v.passed.push(r), s && v.failed.push(s), 1 != v.status) { if (2 == v.status) return void l(); if (3 == v.status) return void c(); if (v.status = 1, h = e.createElement("link"), h.rel = "stylesheet", h.type = "text/css", h.id = "u" + i++, h.async = !1, h.defer = !1, g = (new Date).getTime(), "onload" in h && !u()) h.onload = f, h.onerror = c; else { if (navigator.userAgent.indexOf("Firefox") > 0) return m = e.createElement("style"), m.textContent = '@import "' + t + '"', p(), void n(m); f() } n(h), h.href = t } } var i = 0, o = {}, a; t = t || {}, a = t.maxLoadTime || 5e3, this.load = r } }), r(y, [c, f, p, l, h, m, g, d, u, v], function (e, n, r, i, o, a, s, l, c, u) { function d(e, t) { var n = {}, r = t.keep_values, i; return i = { set: function (n, r, i) { t.url_converter && (r = t.url_converter.call(t.url_converter_scope || e, r, i, n[0])), n.attr("data-mce-" + i, r).attr(i, r) }, get: function (e, t) { return e.attr("data-mce-" + t) || e.attr(t) } }, n = { style: { set: function (e, t) { return null !== t && "object" == typeof t ? void e.css(t) : (r && e.attr("data-mce-style", t), void e.attr("style", t)) }, get: function (t) { var n = t.attr("data-mce-style") || t.attr("style"); return n = e.serializeStyle(e.parseStyle(n), t[0].nodeName) } } }, r && (n.href = n.src = i), n } function f(e, t) { var o = this, a; o.doc = e, o.win = window, o.files = {}, o.counter = 0, o.stdMode = !v || e.documentMode >= 8, o.boxModel = !v || "CSS1Compat" == e.compatMode || o.stdMode, o.styleSheetLoader = new u(e), o.boundEvents = [], o.settings = t = t || {}, o.schema = t.schema, o.styles = new r({ url_converter: t.url_converter, url_converter_scope: t.url_converter_scope }, t.schema), o.fixDoc(e), o.events = t.ownEvents ? new i(t.proxy) : i.Event, o.attrHooks = d(o, t), a = t.schema ? t.schema.getBlockElements() : {}, o.$ = n.overrideDefaults(function () { return { context: e, element: o.getRoot()} }), o.isBlock = function (e) { if (!e) return !1; var t = e.nodeType; return t ? !(1 !== t || !a[e.nodeName]) : !!a[e] } } var p = c.each, h = c.is, m = c.grep, g = c.trim, v = l.ie, y = /^([a-z0-9],?)+$/i, b = /^[ \t\r\n]*$/; return f.prototype = { $$: function (e) { return "string" == typeof e && (e = this.get(e)), this.$(e) }, root: null, fixDoc: function (e) { var t = this.settings, n; if (v && t.schema) { "abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g, function (t) { e.createElement(t) }); for (n in t.schema.getCustomElements()) e.createElement(n) } }, clone: function (e, t) { var n = this, r, i; return !v || 1 !== e.nodeType || t ? e.cloneNode(t) : (i = n.doc, t ? r.firstChild : (r = i.createElement(e.nodeName), p(n.getAttribs(e), function (t) { n.setAttrib(r, t.nodeName, n.getAttrib(e, t.nodeName)) }), r)) }, getRoot: function () { var e = this; return e.settings.root_element || e.doc.body }, getViewPort: function (e) { var t, n; return e = e ? e : this.win, t = e.document, n = this.boxModel ? t.documentElement : t.body, { x: e.pageXOffset || n.scrollLeft, y: e.pageYOffset || n.scrollTop, w: e.innerWidth || n.clientWidth, h: e.innerHeight || n.clientHeight} }, getRect: function (e) { var t = this, n, r; return e = t.get(e), n = t.getPos(e), r = t.getSize(e), { x: n.x, y: n.y, w: r.w, h: r.h} }, getSize: function (e) { var t = this, n, r; return e = t.get(e), n = t.getStyle(e, "width"), r = t.getStyle(e, "height"), -1 === n.indexOf("px") && (n = 0), -1 === r.indexOf("px") && (r = 0), { w: parseInt(n, 10) || e.offsetWidth || e.clientWidth, h: parseInt(r, 10) || e.offsetHeight || e.clientHeight} }, getParent: function (e, t, n) { return this.getParents(e, t, n, !1) }, getParents: function (e, n, r, i) { var o = this, a, s = []; for (e = o.get(e), i = i === t, r = r || ("BODY" != o.getRoot().nodeName ? o.getRoot().parentNode : null), h(n, "string") && (a = n, n = "*" === n ? function (e) { return 1 == e.nodeType } : function (e) { return o.is(e, a) }); e && e != r && e.nodeType && 9 !== e.nodeType; ) { if (!n || n(e)) { if (!i) return e; s.push(e) } e = e.parentNode } return i ? s : null }, get: function (e) { var t; return e && this.doc && "string" == typeof e && (t = e, e = this.doc.getElementById(e), e && e.id !== t) ? this.doc.getElementsByName(t)[1] : e }, getNext: function (e, t) { return this._findSib(e, t, "nextSibling") }, getPrev: function (e, t) { return this._findSib(e, t, "previousSibling") }, select: function (t, n) { var r = this; return e(t, r.get(n) || r.settings.root_element || r.doc, []) }, is: function (n, r) { var i; if (n.length === t) { if ("*" === r) return 1 == n.nodeType; if (y.test(r)) { for (r = r.toLowerCase().split(/,/), n = n.nodeName.toLowerCase(), i = r.length - 1; i >= 0; i--) if (r[i] == n) return !0; return !1 } } if (n.nodeType && 1 != n.nodeType) return !1; var o = n.nodeType ? [n] : n; return e(r, o[0].ownerDocument || o[0], null, o).length > 0 }, add: function (e, t, n, r, i) { var o = this; return this.run(e, function (e) { var a; return a = h(t, "string") ? o.doc.createElement(t) : t, o.setAttribs(a, n), r && (r.nodeType ? a.appendChild(r) : o.setHTML(a, r)), i ? a : e.appendChild(a) }) }, create: function (e, t, n) { return this.add(this.doc.createElement(e), e, t, n, 1) }, createHTML: function (e, t, n) { var r = "", i; r += "<" + e; for (i in t) t.hasOwnProperty(i) && null !== t[i] && "undefined" != typeof t[i] && (r += " " + i + '="' + this.encode(t[i]) + '"'); return "undefined" != typeof n ? r + ">" + n + "</" + e + ">" : r + " />" }, createFragment: function (e) { var t, n, r = this.doc, i; for (i = r.createElement("div"), t = r.createDocumentFragment(), e && (i.innerHTML = e); n = i.firstChild; ) t.appendChild(n); return t }, remove: function (e, t) { return e = this.$$(e), t ? e.each(function () { for (var e; e = this.firstChild; ) 3 == e.nodeType && 0 === e.data.length ? this.removeChild(e) : this.parentNode.insertBefore(e, this) }).remove() : e.remove(), e.length > 1 ? e.toArray() : e[0] }, setStyle: function (e, t, n) { e = this.$$(e).css(t, n), this.settings.update_styles && e.attr("data-mce-style", null) }, getStyle: function (e, n, r) { return e = this.$$(e), r ? e.css(n) : (n = n.replace(/-(\D)/g, function (e, t) { return t.toUpperCase() }), "float" == n && (n = v ? "styleFloat" : "cssFloat"), e[0] && e[0].style ? e[0].style[n] : t) }, setStyles: function (e, t) { e = this.$$(e).css(t), this.settings.update_styles && e.attr("data-mce-style", null) }, removeAllAttribs: function (e) { return this.run(e, function (e) { var t, n = e.attributes; for (t = n.length - 1; t >= 0; t--) e.removeAttributeNode(n.item(t)) }) }, setAttrib: function (e, t, n) { var r = this, i, o, a = r.settings; "" === n && (n = null), e = r.$$(e), i = e.attr(t), e.length && (o = r.attrHooks[t], o && o.set ? o.set(e, n, t) : e.attr(t, n), i != n && a.onSetAttrib && a.onSetAttrib({ attrElm: e, attrName: t, attrValue: n })) }, setAttribs: function (e, t) { var n = this; n.$$(e).each(function (e, r) { p(t, function (e, t) { n.setAttrib(r, t, e) }) }) }, getAttrib: function (e, t, n) { var r = this, i, o; return e = r.$$(e), e.length && (i = r.attrHooks[t], o = i && i.get ? i.get(e, t) : e.attr(t)), "undefined" == typeof o && (o = n || ""), o }, getPos: function (e, t) { var r = this, i = 0, o = 0, a, s = r.doc, l = s.body, c; if (e = r.get(e), t = t || l, e) { if (t === l && e.getBoundingClientRect && "static" === n(l).css("position")) return c = e.getBoundingClientRect(), t = r.boxModel ? s.documentElement : l, i = c.left + (s.documentElement.scrollLeft || l.scrollLeft) - t.clientLeft, o = c.top + (s.documentElement.scrollTop || l.scrollTop) - t.clientTop, { x: i, y: o }; for (a = e; a && a != t && a.nodeType; ) i += a.offsetLeft || 0, o += a.offsetTop || 0, a = a.offsetParent; for (a = e.parentNode; a && a != t && a.nodeType; ) i -= a.scrollLeft || 0, o -= a.scrollTop || 0, a = a.parentNode } return { x: i, y: o} }, parseStyle: function (e) { return this.styles.parse(e) }, serializeStyle: function (e, t) { return this.styles.serialize(e, t) }, addStyle: function (e) { var t = this, n = t.doc, r, i; if (t !== f.DOM && n === document) { var o = f.DOM.addedStyles; if (o = o || [], o[e]) return; o[e] = !0, f.DOM.addedStyles = o } i = n.getElementById("mceDefaultStyles"), i || (i = n.createElement("style"), i.id = "mceDefaultStyles", i.type = "text/css", r = n.getElementsByTagName("head")[0], r.firstChild ? r.insertBefore(i, r.firstChild) : r.appendChild(i)), i.styleSheet ? i.styleSheet.cssText += e : i.appendChild(n.createTextNode(e)) }, loadCSS: function (e) { var t = this, n = t.doc, r; return t !== f.DOM && n === document ? void f.DOM.loadCSS(e) : (e || (e = ""), r = n.getElementsByTagName("head")[0], void p(e.split(","), function (e) { var i; t.files[e] || (t.files[e] = !0, i = t.create("link", { rel: "stylesheet", href: e }), v && n.documentMode && n.recalc && (i.onload = function () { n.recalc && n.recalc(), i.onload = null }), r.appendChild(i)) })) }, addClass: function (e, t) { this.$$(e).addClass(t) }, removeClass: function (e, t) { this.toggleClass(e, t, !1) }, hasClass: function (e, t) { return this.$$(e).hasClass(t) }, toggleClass: function (e, t, r) { this.$$(e).toggleClass(t, r).each(function () { "" === this.className && n(this).attr("class", null) }) }, show: function (e) { this.$$(e).show() }, hide: function (e) { this.$$(e).hide() }, isHidden: function (e) { return "none" == this.$$(e).css("display") }, uniqueId: function (e) { return (e ? e : "mce_") + this.counter++ }, setHTML: function (e, t) { e = this.$$(e), v ? e.each(function (e, r) { if (r.canHaveHTML !== !1) { for (; r.firstChild; ) r.removeChild(r.firstChild); try { r.innerHTML = "<br>" + t, r.removeChild(r.firstChild) } catch (i) { n("<div>").html("<br>" + t).contents().slice(1).appendTo(r) } return t } }) : e.html(t) }, getOuterHTML: function (e) { return e = this.get(e), 1 == e.nodeType ? e.outerHTML : n("<div>").append(n(e).clone()).html() }, setOuterHTML: function (e, t) { var r = this; r.$$(e).each(function () { try { this.outerHTML = t } catch (e) { r.remove(n(this).html(t), !0) } }) }, decode: s.decode, encode: s.encodeAllRaw, insertAfter: function (e, t) { return t = this.get(t), this.run(e, function (e) { var n, r; return n = t.parentNode, r = t.nextSibling, r ? n.insertBefore(e, r) : n.appendChild(e), e }) }, replace: function (e, t, n) { var r = this; return r.run(t, function (t) { return h(t, "array") && (e = e.cloneNode(!0)), n && p(m(t.childNodes), function (t) { e.appendChild(t) }), t.parentNode.replaceChild(e, t) }) }, rename: function (e, t) { var n = this, r; return e.nodeName != t.toUpperCase() && (r = n.create(t), p(n.getAttribs(e), function (t) { n.setAttrib(r, t.nodeName, n.getAttrib(e, t.nodeName)) }), n.replace(r, e, 1)), r || e }, findCommonAncestor: function (e, t) { for (var n = e, r; n; ) { for (r = t; r && n != r; ) r = r.parentNode; if (n == r) break; n = n.parentNode } return !n && e.ownerDocument ? e.ownerDocument.documentElement : n }, toHex: function (e) { return this.styles.toHex(c.trim(e)) }, run: function (e, t, n) { var r = this, i; return "string" == typeof e && (e = r.get(e)), e ? (n = n || this, e.nodeType || !e.length && 0 !== e.length ? t.call(n, e) : (i = [], p(e, function (e, o) { e && ("string" == typeof e && (e = r.get(e)), i.push(t.call(n, e, o))) }), i)) : !1 }, getAttribs: function (e) { var t; if (e = this.get(e), !e) return []; if (v) { if (t = [], "OBJECT" == e.nodeName) return e.attributes; "OPTION" === e.nodeName && this.getAttrib(e, "selected") && t.push({ specified: 1, nodeName: "selected" }); var n = /<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi; return e.cloneNode(!1).outerHTML.replace(n, "").replace(/[\w:\-]+/gi, function (e) { t.push({ specified: 1, nodeName: e }) }), t } return e.attributes }, isEmpty: function (e, t) { var n = this, r, i, a, s, l, c = 0; if (e = e.firstChild) { s = new o(e, e.parentNode), t = t || (n.schema ? n.schema.getNonEmptyElements() : null); do { if (a = e.nodeType, 1 === a) { if (e.getAttribute("data-mce-bogus")) continue; if (l = e.nodeName.toLowerCase(), t && t[l]) { if ("br" === l) { c++; continue } return !1 } for (i = n.getAttribs(e), r = i.length; r--; ) if (l = i[r].nodeName, "name" === l || "data-mce-bookmark" === l) return !1 } if (8 == a) return !1; if (3 === a && !b.test(e.nodeValue)) return !1 } while (e = s.next()) } return 1 >= c }, createRng: function () { var e = this.doc; return e.createRange ? e.createRange() : new a(this) }, nodeIndex: function (e, t) { var n = 0, r, i; if (e) for (r = e.nodeType, e = e.previousSibling; e; e = e.previousSibling) i = e.nodeType, (!t || 3 != i || i != r && e.nodeValue.length) && (n++, r = i); return n }, split: function (e, t, n) { function r(e) { function t(e) { var t = e.previousSibling && "SPAN" == e.previousSibling.nodeName, n = e.nextSibling && "SPAN" == e.nextSibling.nodeName; return t && n } var n, o = e.childNodes, a = e.nodeType; if (1 != a || "bookmark" != e.getAttribute("data-mce-type")) { for (n = o.length - 1; n >= 0; n--) r(o[n]); if (9 != a) { if (3 == a && e.nodeValue.length > 0) { var s = g(e.nodeValue).length; if (!i.isBlock(e.parentNode) || s > 0 || 0 === s && t(e)) return } else if (1 == a && (o = e.childNodes, 1 == o.length && o[0] && 1 == o[0].nodeType && "bookmark" == o[0].getAttribute("data-mce-type") && e.parentNode.insertBefore(o[0], e), o.length || /^(br|hr|input|img)$/i.test(e.nodeName))) return; i.remove(e) } return e } } var i = this, o = i.createRng(), a, s, l; return e && t ? (o.setStart(e.parentNode, i.nodeIndex(e)), o.setEnd(t.parentNode, i.nodeIndex(t)), a = o.extractContents(), o = i.createRng(), o.setStart(t.parentNode, i.nodeIndex(t) + 1), o.setEnd(e.parentNode, i.nodeIndex(e) + 1), s = o.extractContents(), l = e.parentNode, l.insertBefore(r(a), e), n ? l.replaceChild(n, t) : l.insertBefore(t, e), l.insertBefore(r(s), e), i.remove(e), n || t) : void 0 }, bind: function (e, t, n, r) { var i = this; if (c.isArray(e)) { for (var o = e.length; o--; ) e[o] = i.bind(e[o], t, n, r); return e } return !i.settings.collect || e !== i.doc && e !== i.win || i.boundEvents.push([e, t, n, r]), i.events.bind(e, t, n, r || i) }, unbind: function (e, t, n) { var r = this, i; if (c.isArray(e)) { for (i = e.length; i--; ) e[i] = r.unbind(e[i], t, n); return e } if (r.boundEvents && (e === r.doc || e === r.win)) for (i = r.boundEvents.length; i--; ) { var o = r.boundEvents[i]; e != o[0] || t && t != o[1] || n && n != o[2] || this.events.unbind(o[0], o[1], o[2]) } return this.events.unbind(e, t, n) }, fire: function (e, t, n) { return this.events.fire(e, t, n) }, getContentEditable: function (e) { var t; return e && 1 == e.nodeType ? (t = e.getAttribute("data-mce-contenteditable"), t && "inherit" !== t ? t : "inherit" !== e.contentEditable ? e.contentEditable : null) : null }, getContentEditableParent: function (e) { for (var t = this.getRoot(), n = null; e && e !== t && (n = this.getContentEditable(e), null === n); e = e.parentNode); return n }, destroy: function () { var t = this; if (t.boundEvents) { for (var n = t.boundEvents.length; n--; ) { var r = t.boundEvents[n]; this.events.unbind(r[0], r[1], r[2]) } t.boundEvents = null } e.setDocument && e.setDocument(), t.win = t.doc = t.root = t.events = t.frag = null }, isChildOf: function (e, t) { for (; e; ) { if (t === e) return !0; e = e.parentNode } return !1 }, dumpRng: function (e) { return "startContainer: " + e.startContainer.nodeName + ", startOffset: " + e.startOffset + ", endContainer: " + e.endContainer.nodeName + ", endOffset: " + e.endOffset }, _findSib: function (e, t, n) { var r = this, i = t; if (e) for ("string" == typeof i && (i = function (e) { return r.is(e, t) }), e = e[n]; e; e = e[n]) if (i(e)) return e; return null } }, f.DOM = new f(document), f }), r(b, [y, u], function (e, t) { function n() { function e(e, t) { function n() { o.remove(s), a && (a.onreadystatechange = a.onload = a = null), t() } function i() { "undefined" != typeof console && console.log && console.log("Failed to load: " + e) } var o = r, a, s; s = o.uniqueId(), a = document.createElement("script"), a.id = s, a.type = "text/javascript", a.src = e, "onreadystatechange" in a ? a.onreadystatechange = function () { /loaded|complete/.test(a.readyState) && n() } : a.onload = n, a.onerror = i, (document.getElementsByTagName("head")[0] || document.body).appendChild(a) } var t = 0, n = 1, a = 2, s = {}, l = [], c = {}, u = [], d = 0, f; this.isDone = function (e) { return s[e] == a }, this.markDone = function (e) { s[e] = a }, this.add = this.load = function (e, n, r) { var i = s[e]; i == f && (l.push(e), s[e] = t), n && (c[e] || (c[e] = []), c[e].push({ func: n, scope: r || this })) }, this.loadQueue = function (e, t) { this.loadScripts(l, e, t) }, this.loadScripts = function (t, r, l) { function p(e) { i(c[e], function (e) { e.func.call(e.scope) }), c[e] = f } var h; u.push({ func: r, scope: l || this }), (h = function () { var r = o(t); t.length = 0, i(r, function (t) { return s[t] == a ? void p(t) : void (s[t] != n && (s[t] = n, d++, e(t, function () { s[t] = a, d--, p(t), h() }))) }), d || (i(u, function (e) { e.func.call(e.scope) }), u.length = 0) })() } } var r = e.DOM, i = t.each, o = t.grep; return n.ScriptLoader = new n, n }), r(C, [b, u], function (e, n) { function r() { var e = this; e.items = [], e.urls = {}, e.lookup = {} } var i = n.each; return r.prototype = { get: function (e) { return this.lookup[e] ? this.lookup[e].instance : t }, dependencies: function (e) { var t; return this.lookup[e] && (t = this.lookup[e].dependencies), t || [] }, requireLangPack: function (t, n) { var i = r.language; if (i && r.languageLoad !== !1) { if (n) if (n = "," + n + ",", -1 != n.indexOf("," + i.substr(0, 2) + ",")) i = i.substr(0, 2); else if (-1 == n.indexOf("," + i + ",")) return; e.ScriptLoader.add(this.urls[t] + "/langs/" + i + ".js") } }, add: function (e, t, n) { return this.items.push(t), this.lookup[e] = { instance: t, dependencies: n }, t }, createUrl: function (e, t) { return "object" == typeof t ? t : { prefix: e.prefix, resource: t, suffix: e.suffix} }, addComponents: function (t, n) { var r = this.urls[t]; i(n, function (t) { e.ScriptLoader.add(r + "/" + t) }) }, load: function (n, o, a, s) { function l() { var r = c.dependencies(n); i(r, function (e) { var n = c.createUrl(o, e); c.load(n.resource, n, t, t) }), a && a.call(s ? s : e) } var c = this, u = o; c.urls[n] || ("object" == typeof o && (u = o.prefix + o.resource + o.suffix), 0 !== u.indexOf("/") && -1 == u.indexOf("://") && (u = r.baseURL + "/" + u), c.urls[n] = u.substring(0, u.lastIndexOf("/")), c.lookup[n] ? l() : e.ScriptLoader.add(u, l, s)) } }, r.PluginManager = new r, r.ThemeManager = new r, r }), r(x, [u, h], function (e, t) { function n(e, t) { var n = e.childNodes; return t--, t > n.length - 1 ? t = n.length - 1 : 0 > t && (t = 0), n[t] || e } function r(e) { this.walk = function (t, r) { function o(e) { var t; return t = e[0], 3 === t.nodeType && t === c && u >= t.nodeValue.length && e.splice(0, 1), t = e[e.length - 1], 0 === f && e.length > 0 && t === d && 3 === t.nodeType && e.splice(e.length - 1, 1), e } function a(e, t, n) { for (var r = []; e && e != n; e = e[t]) r.push(e); return r } function s(e, t) { do { if (e.parentNode == t) return e; e = e.parentNode } while (e) } function l(e, t, n) { var i = n ? "nextSibling" : "previousSibling"; for (g = e, v = g.parentNode; g && g != t; g = v) v = g.parentNode, y = a(g == e ? g : g[i], i), y.length && (n || y.reverse(), r(o(y))) } var c = t.startContainer, u = t.startOffset, d = t.endContainer, f = t.endOffset, p, h, m, g, v, y, b; if (b = e.select("td.mce-item-selected,th.mce-item-selected"), b.length > 0) return void i(b, function (e) { r([e]) }); if (1 == c.nodeType && c.hasChildNodes() && (c = c.childNodes[u]), 1 == d.nodeType && d.hasChildNodes() && (d = n(d, f)), c == d) return r(o([c])); for (p = e.findCommonAncestor(c, d), g = c; g; g = g.parentNode) { if (g === d) return l(c, p, !0); if (g === p) break } for (g = d; g; g = g.parentNode) { if (g === c) return l(d, p); if (g === p) break } h = s(c, p) || c, m = s(d, p) || d, l(c, h, !0), y = a(h == c ? h : h.nextSibling, "nextSibling", m == d ? m.nextSibling : m), y.length && r(o(y)), l(d, m) }, this.split = function (e) { function t(e, t) { return e.splitText(t) } var n = e.startContainer, r = e.startOffset, i = e.endContainer, o = e.endOffset; return n == i && 3 == n.nodeType ? r > 0 && r < n.nodeValue.length && (i = t(n, r), n = i.previousSibling, o > r ? (o -= r, n = i = t(i, o).previousSibling, o = i.nodeValue.length, r = 0) : o = 0) : (3 == n.nodeType && r > 0 && r < n.nodeValue.length && (n = t(n, r), r = 0), 3 == i.nodeType && o > 0 && o < i.nodeValue.length && (i = t(i, o).previousSibling, o = i.nodeValue.length)), { startContainer: n, startOffset: r, endContainer: i, endOffset: o} }, this.normalize = function (n) { function r(r) { function a(n, r) { for (var i = new t(n, e.getParent(n.parentNode, e.isBlock) || f); n = i[r ? "prev" : "next"](); ) if ("BR" === n.nodeName) return !0 } function s(e, t) { return e.previousSibling && e.previousSibling.nodeName == t } function l(n, r) { var a, s, l; if (r = r || c, l = e.getParent(r.parentNode, e.isBlock) || f, n && "BR" == r.nodeName && g && e.isEmpty(l)) return c = r.parentNode, u = e.nodeIndex(r), void (i = !0); for (a = new t(r, l); p = a[n ? "prev" : "next"](); ) { if ("false" === e.getContentEditableParent(p)) return; if (3 === p.nodeType && p.nodeValue.length > 0) return c = p, u = n ? p.nodeValue.length : 0, void (i = !0); if (e.isBlock(p) || h[p.nodeName.toLowerCase()]) return; s = p } o && s && (c = s, i = !0, u = 0) } var c, u, d, f = e.getRoot(), p, h, m, g; if (c = n[(r ? "start" : "end") + "Container"], u = n[(r ? "start" : "end") + "Offset"], g = 1 == c.nodeType && u === c.childNodes.length, h = e.schema.getNonEmptyElements(), m = r, 1 == c.nodeType && u > c.childNodes.length - 1 && (m = !1), 9 === c.nodeType && (c = e.getRoot(), u = 0), c === f) { if (m && (p = c.childNodes[u > 0 ? u - 1 : 0], p && (h[p.nodeName] || "TABLE" == p.nodeName))) return; if (c.hasChildNodes() && (u = Math.min(!m && u > 0 ? u - 1 : u, c.childNodes.length - 1), c = c.childNodes[u], u = 0, c.hasChildNodes() && !/TABLE/.test(c.nodeName))) { p = c, d = new t(c, f); do { if (3 === p.nodeType && p.nodeValue.length > 0) { u = m ? 0 : p.nodeValue.length, c = p, i = !0; break } if (h[p.nodeName.toLowerCase()]) { u = e.nodeIndex(p), c = p.parentNode, "IMG" != p.nodeName || m || u++, i = !0; break } } while (p = m ? d.next() : d.prev()) } } o && (3 === c.nodeType && 0 === u && l(!0), 1 === c.nodeType && (p = c.childNodes[u], p || (p = c.childNodes[u - 1]), !p || "BR" !== p.nodeName || s(p, "A") || a(p) || a(p, !0) || l(!0, p))), m && !o && 3 === c.nodeType && u === c.nodeValue.length && l(!1), i && n["set" + (r ? "Start" : "End")](c, u) } var i, o; return o = n.collapsed, r(!0), o || r(), i && o && n.collapse(!0), i } } var i = e.each; return r.compareRanges = function (e, t) { if (e && t) { if (!e.item && !e.duplicate) return e.startContainer == t.startContainer && e.startOffset == t.startOffset; if (e.item && t.item && e.item(0) === t.item(0)) return !0; if (e.isEqual && t.isEqual && t.isEqual(e)) return !0 } return !1 }, r }), r(w, [x], function (e) { return function (t) { function n(e) { var n, r; if (r = t.$(e).parentsUntil(t.getBody()).add(e), r.length === i.length) { for (n = r.length; n >= 0 && r[n] === i[n]; n--); if (-1 === n) return i = r, !0 } return i = r, !1 } var r, i = []; "onselectionchange" in t.getDoc() || t.on("NodeChange Click MouseUp KeyUp Focus", function (n) { var i, o; i = t.selection.getRng(), o = { startContainer: i.startContainer, startOffset: i.startOffset, endContainer: i.endContainer, endOffset: i.endOffset }, "nodechange" != n.type && e.compareRanges(o, r) || t.fire("SelectionChange"), r = o }), t.on("contextmenu", function () { t.fire("SelectionChange") }), t.on("SelectionChange", function () { var e = t.selection.getStart(!0); t.selection.isCollapsed() || n(e) || !t.dom.isChildOf(e, t.getBody()) || t.nodeChanged({ selectionChange: !0 }) }), t.on("MouseUp", function (e) { e.isDefaultPrevented() || setTimeout(function () { t.nodeChanged() }, 0) }), this.nodeChanged = function (e) { var n = t.selection, r, i, o; t.initialized && n && !t.settings.disable_nodechange && !t.settings.readonly && (o = t.getBody(), r = n.getStart() || o, r = r.ownerDocument != t.getDoc() ? t.getBody() : r, "IMG" == r.nodeName && n.isCollapsed() && (r = r.parentNode), i = [], t.dom.getParent(r, function (e) { return e === o ? !0 : void i.push(e) }), e = e || {}, e.element = r, e.parents = i, t.fire("NodeChange", e)) } } }), r(_, [], function () { function e(e, t, n) { var r, i, o = n ? "lastChild" : "firstChild", a = n ? "prev" : "next"; if (e[o]) return e[o]; if (e !== t) { if (r = e[a]) return r; for (i = e.parent; i && i !== t; i = i.parent) if (r = i[a]) return r } } function t(e, t) { this.name = e, this.type = t, 1 === t && (this.attributes = [], this.attributes.map = {}) } var n = /^[ \t\r\n]*$/, r = { "#text": 3, "#comment": 8, "#cdata": 4, "#pi": 7, "#doctype": 10, "#document-fragment": 11 }; return t.prototype = { replace: function (e) { var t = this; return e.parent && e.remove(), t.insert(e, t), t.remove(), t }, attr: function (e, t) { var n = this, r, i, o; if ("string" != typeof e) { for (i in e) n.attr(i, e[i]); return n } if (r = n.attributes) { if (t !== o) { if (null === t) { if (e in r.map) for (delete r.map[e], i = r.length; i--; ) if (r[i].name === e) return r = r.splice(i, 1), n; return n } if (e in r.map) { for (i = r.length; i--; ) if (r[i].name === e) { r[i].value = t; break } } else r.push({ name: e, value: t }); return r.map[e] = t, n } return r.map[e] } }, clone: function () { var e = this, n = new t(e.name, e.type), r, i, o, a, s; if (o = e.attributes) { for (s = [], s.map = {}, r = 0, i = o.length; i > r; r++) a = o[r], "id" !== a.name && (s[s.length] = { name: a.name, value: a.value }, s.map[a.name] = a.value); n.attributes = s } return n.value = e.value, n.shortEnded = e.shortEnded, n }, wrap: function (e) { var t = this; return t.parent.insert(e, t), e.append(t), t }, unwrap: function () { var e = this, t, n; for (t = e.firstChild; t; ) n = t.next, e.insert(t, e, !0), t = n; e.remove() }, remove: function () { var e = this, t = e.parent, n = e.next, r = e.prev; return t && (t.firstChild === e ? (t.firstChild = n, n && (n.prev = null)) : r.next = n, t.lastChild === e ? (t.lastChild = r, r && (r.next = null)) : n.prev = r, e.parent = e.next = e.prev = null), e }, append: function (e) { var t = this, n; return e.parent && e.remove(), n = t.lastChild, n ? (n.next = e, e.prev = n, t.lastChild = e) : t.lastChild = t.firstChild = e, e.parent = t, e }, insert: function (e, t, n) { var r; return e.parent && e.remove(), r = t.parent || this, n ? (t === r.firstChild ? r.firstChild = e : t.prev.next = e, e.prev = t.prev, e.next = t, t.prev = e) : (t === r.lastChild ? r.lastChild = e : t.next.prev = e, e.next = t.next, e.prev = t, t.next = e), e.parent = r, e }, getAll: function (t) { var n = this, r, i = []; for (r = n.firstChild; r; r = e(r, n)) r.name === t && i.push(r); return i }, empty: function () { var t = this, n, r, i; if (t.firstChild) { for (n = [], i = t.firstChild; i; i = e(i, t)) n.push(i); for (r = n.length; r--; ) i = n[r], i.parent = i.firstChild = i.lastChild = i.next = i.prev = null } return t.firstChild = t.lastChild = null, t }, isEmpty: function (t) { var r = this, i = r.firstChild, o, a; if (i) do { if (1 === i.type) { if (i.attributes.map["data-mce-bogus"]) continue; if (t[i.name]) return !1; for (o = i.attributes.length; o--; ) if (a = i.attributes[o].name, "name" === a || 0 === a.indexOf("data-mce-bookmark")) return !1 } if (8 === i.type) return !1; if (3 === i.type && !n.test(i.value)) return !1 } while (i = e(i, r)); return !0 }, walk: function (t) { return e(this, null, t) } }, t.create = function (e, n) { var i, o; if (i = new t(e, r[e] || 1), n) for (o in n) i.attr(o, n[o]); return i }, t }), r(E, [u], function (e) { function t(e, t) { return e ? e.split(t || " ") : [] } function n(e) { function n(e, n, r) { function i(e, t) { var n = {}, r, i; for (r = 0, i = e.length; i > r; r++) n[e[r]] = t || {}; return n } var s, c, u, d = arguments; for (r = r || [], n = n || "", "string" == typeof r && (r = t(r)), c = 3; c < d.length; c++) "string" == typeof d[c] && (d[c] = t(d[c])), r.push.apply(r, d[c]); for (e = t(e), s = e.length; s--; ) u = [].concat(l, t(n)), a[e[s]] = { attributes: i(u), attributesOrder: u, children: i(r, o)} } function r(e, n) { var r, i, o, s; for (e = t(e), r = e.length, n = t(n); r--; ) for (i = a[e[r]], o = 0, s = n.length; s > o; o++) i.attributes[n[o]] = {}, i.attributesOrder.push(n[o]) } var a = {}, l, c, u, d, f, p; return i[e] ? i[e] : (l = t("id accesskey class dir lang style tabindex title"), c = t("address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul"), u = t("a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment"), "html4" != e && (l.push.apply(l, t("contenteditable contextmenu draggable dropzone hidden spellcheck translate")), c.push.apply(c, t("article aside details dialog figure header footer hgroup section nav")), u.push.apply(u, t("audio canvas command datalist mark meter output progress time wbr video ruby bdi keygen"))), "html5-strict" != e && (l.push("xml:lang"), p = t("acronym applet basefont big font strike tt"), u.push.apply(u, p), s(p, function (e) { n(e, "", u) }), f = t("center dir isindex noframes"), c.push.apply(c, f), d = [].concat(c, u), s(f, function (e) { n(e, "", d) })), d = d || [].concat(c, u), n("html", "manifest", "head body"), n("head", "", "base command link meta noscript script style title"), n("title hr noscript br"), n("base", "href target"), n("link", "href rel media hreflang type sizes hreflang"), n("meta", "name http-equiv content charset"), n("style", "media type scoped"), n("script", "src async defer type charset"), n("body", "onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload", d), n("address dt dd div caption", "", d), n("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn", "", u), n("blockquote", "cite", d), n("ol", "reversed start type", "li"), n("ul", "", "li"), n("li", "value", d), n("dl", "", "dt dd"), n("a", "href target rel media hreflang type", u), n("q", "cite", u), n("ins del", "cite datetime", d), n("img", "src alt usemap ismap width height"), n("iframe", "src name width height", d), n("embed", "src type width height"), n("object", "data type typemustmatch name usemap form width height", d, "param"), n("param", "name value"), n("map", "name", d, "area"), n("area", "alt coords shape href target rel media hreflang type"), n("table", "border", "caption colgroup thead tfoot tbody tr" + ("html4" == e ? " col" : "")), n("colgroup", "span", "col"), n("col", "span"), n("tbody thead tfoot", "", "tr"), n("tr", "", "td th"), n("td", "colspan rowspan headers", d), n("th", "colspan rowspan headers scope abbr", d), n("form", "accept-charset action autocomplete enctype method name novalidate target", d), n("fieldset", "disabled form name", d, "legend"), n("label", "form for", u), n("input", "accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"), n("button", "disabled form formaction formenctype formmethod formnovalidate formtarget name type value", "html4" == e ? d : u), n("select", "disabled form multiple name required size", "option optgroup"), n("optgroup", "disabled label", "option"), n("option", "disabled label selected value"), n("textarea", "cols dirname disabled form maxlength name readonly required rows wrap"), n("menu", "type label", d, "li"), n("noscript", "", d), "html4" != e && (n("wbr"), n("ruby", "", u, "rt rp"), n("figcaption", "", d), n("mark rt rp summary bdi", "", u), n("canvas", "width height", d), n("video", "src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered", d, "track source"), n("audio", "src crossorigin preload autoplay mediagroup loop muted controls buffered volume", d, "track source"), n("source", "src type media"), n("track", "kind src srclang label default"), n("datalist", "", u, "option"), n("article section nav aside header footer", "", d), n("hgroup", "", "h1 h2 h3 h4 h5 h6"), n("figure", "", d, "figcaption"), n("time", "datetime", u), n("dialog", "open", d), n("command", "type label icon disabled checked radiogroup command"), n("output", "for form name", u), n("progress", "value max", u), n("meter", "value min max low high optimum", u), n("details", "open", d, "summary"), n("keygen", "autofocus challenge disabled form keytype name")), "html5-strict" != e && (r("script", "language xml:space"), r("style", "xml:space"), r("object", "declare classid code codebase codetype archive standby align border hspace vspace"), r("embed", "align name hspace vspace"), r("param", "valuetype type"), r("a", "charset name rev shape coords"), r("br", "clear"), r("applet", "codebase archive code object alt name width height align hspace vspace"), r("img", "name longdesc align border hspace vspace"), r("iframe", "longdesc frameborder marginwidth marginheight scrolling align"), r("font basefont", "size color face"), r("input", "usemap align"), r("select", "onchange"), r("textarea"), r("h1 h2 h3 h4 h5 h6 div p legend caption", "align"), r("ul", "type compact"), r("li", "type"), r("ol dl menu dir", "compact"), r("pre", "width xml:space"), r("hr", "align noshade size width"), r("isindex", "prompt"), r("table", "summary width frame rules cellspacing cellpadding align bgcolor"), r("col", "width align char charoff valign"), r("colgroup", "width align char charoff valign"), r("thead", "align char charoff valign"), r("tr", "align char charoff valign bgcolor"), r("th", "axis align char charoff valign nowrap bgcolor width height"), r("form", "accept"), r("td", "abbr axis scope align char charoff valign nowrap bgcolor width height"), r("tfoot", "align char charoff valign"), r("tbody", "align char charoff valign"), r("area", "nohref"), r("body", "background bgcolor text link vlink alink")), "html4" != e && (r("input button select textarea", "autofocus"), r("input textarea", "placeholder"), r("a", "download"), r("link script img", "crossorigin"), r("iframe", "sandbox seamless allowfullscreen")), s(t("a form meter progress dfn"), function (e) { a[e] && delete a[e].children[e] }), delete a.caption.children.table, i[e] = a, a) } function r(e, t) { var n; return e && (n = {}, "string" == typeof e && (e = { "*": e }), s(e, function (e, r) { n[r] = "map" == t ? a(e, /[, ]/) : c(e, /[, ]/) })), n } var i = {}, o = {}, a = e.makeMap, s = e.each, l = e.extend, c = e.explode, u = e.inArray; return function (e) { function o(t, n, r) { var o = e[t]; return o ? o = a(o, /[, ]/, a(o.toUpperCase(), /[, ]/)) : (o = i[t], o || (o = a(n, " ", a(n.toUpperCase(), " ")), o = l(o, r), i[t] = o)), o } function d(e) { return new RegExp("^" + e.replace(/([?+*])/g, ".$1") + "$") } function f(e) { var n, r, i, o, s, l, c, f, p, h, m, g, v, b, x, w, _, E, N, k = /^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/, S = /^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/, T = /[*?+]/; if (e) for (e = t(e, ","), y["@"] && (w = y["@"].attributes, _ = y["@"].attributesOrder), n = 0, r = e.length; r > n; n++) if (s = k.exec(e[n])) { if (b = s[1], p = s[2], x = s[3], f = s[5], g = {}, v = [], l = { attributes: g, attributesOrder: v }, "#" === b && (l.paddEmpty = !0), "-" === b && (l.removeEmpty = !0), "!" === s[4] && (l.removeEmptyAttrs = !0), w) { for (E in w) g[E] = w[E]; v.push.apply(v, _) } if (f) for (f = t(f, "|"), i = 0, o = f.length; o > i; i++) if (s = S.exec(f[i])) { if (c = {}, m = s[1], h = s[2].replace(/::/g, ":"), b = s[3], N = s[4], "!" === m && (l.attributesRequired = l.attributesRequired || [], l.attributesRequired.push(h), c.required = !0), "-" === m) { delete g[h], v.splice(u(v, h), 1); continue } b && ("=" === b && (l.attributesDefault = l.attributesDefault || [], l.attributesDefault.push({ name: h, value: N }), c.defaultValue = N), ":" === b && (l.attributesForced = l.attributesForced || [], l.attributesForced.push({ name: h, value: N }), c.forcedValue = N), "<" === b && (c.validValues = a(N, "?"))), T.test(h) ? (l.attributePatterns = l.attributePatterns || [], c.pattern = d(h), l.attributePatterns.push(c)) : (g[h] || v.push(h), g[h] = c) } w || "@" != p || (w = g, _ = v), x && (l.outputName = p, y[x] = l), T.test(p) ? (l.pattern = d(p), C.push(l)) : y[p] = l } } function p(e) { y = {}, C = [], f(e), s(_, function (e, t) { b[t] = e.children }) } function h(e) { var n = /^(~)?(.+)$/; e && (i.text_block_elements = i.block_elements = null, s(t(e, ","), function (e) { var t = n.exec(e), r = "~" === t[1], i = r ? "span" : "div", o = t[2]; if (b[o] = b[i], L[o] = i, r || (R[o.toUpperCase()] = {}, R[o] = {}), !y[o]) { var a = y[i]; a = l({}, a), delete a.removeEmptyAttrs, delete a.removeEmpty, y[o] = a } s(b, function (e, t) { e[i] && (b[t] = e = l({}, b[t]), e[o] = e[i]) }) })) } function m(e) { var n = /^([+\-]?)(\w+)\[([^\]]+)\]$/; e && s(t(e, ","), function (e) { var r = n.exec(e), i, o; r && (o = r[1], i = o ? b[r[2]] : b[r[2]] = { "#comment": {} }, i = b[r[2]], s(t(r[3], "|"), function (e) { "-" === o ? (b[r[2]] = i = l({}, b[r[2]]), delete i[e]) : i[e] = {} })) }) } function g(e) { var t = y[e], n; if (t) return t; for (n = C.length; n--; ) if (t = C[n], t.pattern.test(e)) return t } var v = this, y = {}, b = {}, C = [], x, w, _, E, N, k, S, T, R, A, B, D, L = {}, H = {}; e = e || {}, _ = n(e.schema), e.verify_html === !1 && (e.valid_elements = "*[*]"), x = r(e.valid_styles), w = r(e.invalid_styles, "map"), T = r(e.valid_classes, "map"), E = o("whitespace_elements", "pre script noscript style textarea video audio iframe object"), N = o("self_closing_elements", "colgroup dd dt li option p td tfoot th thead tr"), k = o("short_ended_elements", "area base basefont br col frame hr img input isindex link meta param embed source wbr track"), S = o("boolean_attributes", "checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"), A = o("non_empty_elements", "td th iframe video audio object script", k), B = o("text_block_elements", "h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"), R = o("block_elements", "hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup", B), D = o("text_inline_elements", "span strong b em i font strike u var cite dfn code mark q sup sub samp"), s((e.special || "script noscript style textarea").split(" "), function (e) { H[e] = new RegExp("</" + e + "[^>]*>", "gi") }), e.valid_elements ? p(e.valid_elements) : (s(_, function (e, t) { y[t] = { attributes: e.attributes, attributesOrder: e.attributesOrder }, b[t] = e.children }), "html5" != e.schema && s(t("strong/b em/i"), function (e) { e = t(e, "/"), y[e[1]].outputName = e[0] }), y.img.attributesDefault = [{ name: "alt", value: ""}], s(t("ol ul sub sup blockquote span font a table tbody tr strong em b i"), function (e) { y[e] && (y[e].removeEmpty = !0) }), s(t("p h1 h2 h3 h4 h5 h6 th td pre div address caption"), function (e) { y[e].paddEmpty = !0 }), s(t("span"), function (e) { y[e].removeEmptyAttrs = !0 })), h(e.custom_elements), m(e.valid_children), f(e.extended_valid_elements), m("+ol[ul|ol],+ul[ul|ol]"), e.invalid_elements && s(c(e.invalid_elements), function (e) { y[e] && delete y[e] }), g("span") || f("span[!data-mce-type|*]"), v.children = b, v.getValidStyles = function () { return x }, v.getInvalidStyles = function () { return w }, v.getValidClasses = function () { return T }, v.getBoolAttrs = function () { return S }, v.getBlockElements = function () { return R }, v.getTextBlockElements = function () { return B }, v.getTextInlineElements = function () { return D }, v.getShortEndedElements = function () { return k }, v.getSelfClosingElements = function () { return N }, v.getNonEmptyElements = function () { return A }, v.getWhiteSpaceElements = function () { return E }, v.getSpecialElements = function () { return H }, v.isValidChild = function (e, t) { var n = b[e]; return !(!n || !n[t]) }, v.isValid = function (e, t) { var n, r, i = g(e); if (i) { if (!t) return !0; if (i.attributes[t]) return !0; if (n = i.attributePatterns) for (r = n.length; r--; ) if (n[r].pattern.test(e)) return !0 } return !1 }, v.getElementRule = g, v.getCustomElements = function () { return L }, v.addValidElements = f, v.setValidElements = p, v.addCustomElements = h, v.addValidChildren = m, v.elements = y } }), r(N, [E, g, u], function (e, t, n) { function r(e, t, n) { var r = 1, i, o, a, s; for (s = e.getShortEndedElements(), a = /<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g, a.lastIndex = i = n; o = a.exec(t); ) { if (i = a.lastIndex, "/" === o[1]) r--; else if (!o[1]) { if (o[2] in s) continue; r++ } if (0 === r) break } return i } function i(i, a) { function s() { } var l = this; i = i || {}, l.schema = a = a || new e, i.fix_self_closing !== !1 && (i.fix_self_closing = !0), o("comment cdata text start end pi doctype".split(" "), function (e) { e && (l[e] = i[e] || s) }), l.parse = function (e) { function o(e) { var t, n; for (t = p.length; t-- && p[t].name !== e; ); if (t >= 0) { for (n = p.length - 1; n >= t; n--) e = p[n], e.valid && l.end(e.name); p.length = t } } function s(e, t, n, r, o) { var a, s, l = /[\s\u0000-\u001F]+/g; if (t = t.toLowerCase(), n = t in x ? t : z(n || r || o || ""), _ && !y && 0 !== t.indexOf("data-")) { if (a = T[t], !a && R) { for (s = R.length; s-- && (a = R[s], !a.pattern.test(t)); ); -1 === s && (a = null) } if (!a) return; if (a.validValues && !(n in a.validValues)) return } if (V[t] && !i.allow_script_urls) { var c = n.replace(l, ""); try { c = decodeURIComponent(c) } catch (u) { c = unescape(c) } if (U.test(c)) return; if (!i.allow_html_data_urls && $.test(c) && !/^data:image\//i.test(c)) return } h.map[t] = n, h.push({ name: t, value: n }) } var l = this, c, u = 0, d, f, p = [], h, m, g, v, y, b, C, x, w, _, E, N, k, S, T, R, A, B, D, L, H, M, P, O, I, F = 0, z = t.decode, W, V = n.makeMap("src,href,data,background,formaction,poster"), U = /((java|vb)script|mhtml):/i, $ = /^data:/i; for (M = new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-_\\:\\.]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))", "g"), P = /([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g, C = a.getShortEndedElements(), H = i.self_closing_elements || a.getSelfClosingElements(), x = a.getBoolAttrs(), _ = i.validate, b = i.remove_internals, W = i.fix_self_closing, O = a.getSpecialElements(); c = M.exec(e); ) { if (u < c.index && l.text(z(e.substr(u, c.index - u))), d = c[6]) d = d.toLowerCase(), ":" === d.charAt(0) && (d = d.substr(1)), o(d); else if (d = c[7]) { if (d = d.toLowerCase(), ":" === d.charAt(0) && (d = d.substr(1)), w = d in C, W && H[d] && p.length > 0 && p[p.length - 1].name === d && o(d), !_ || (E = a.getElementRule(d))) { if (N = !0, _ && (T = E.attributes, R = E.attributePatterns), (S = c[8]) ? (y = -1 !== S.indexOf("data-mce-type"), y && b && (N = !1), h = [], h.map = {}, S.replace(P, s)) : (h = [], h.map = {}), _ && !y) { if (A = E.attributesRequired, B = E.attributesDefault, D = E.attributesForced, L = E.removeEmptyAttrs, L && !h.length && (N = !1), D) for (m = D.length; m--; ) k = D[m], v = k.name, I = k.value, "{$uid}" === I && (I = "mce_" + F++), h.map[v] = I, h.push({ name: v, value: I }); if (B) for (m = B.length; m--; ) k = B[m], v = k.name, v in h.map || (I = k.value, "{$uid}" === I && (I = "mce_" + F++), h.map[v] = I, h.push({ name: v, value: I })); if (A) { for (m = A.length; m-- && !(A[m] in h.map); ); -1 === m && (N = !1) } if (k = h.map["data-mce-bogus"]) { if ("all" === k) { u = r(a, e, M.lastIndex), M.lastIndex = u; continue } N = !1 } } N && l.start(d, h, w) } else N = !1; if (f = O[d]) { f.lastIndex = u = c.index + c[0].length, (c = f.exec(e)) ? (N && (g = e.substr(u, c.index - u)), u = c.index + c[0].length) : (g = e.substr(u), u = e.length), N && (g.length > 0 && l.text(g, !0), l.end(d)), M.lastIndex = u; continue } w || (S && S.indexOf("/") == S.length - 1 ? N && l.end(d) : p.push({ name: d, valid: N })) } else (d = c[1]) ? (">" === d.charAt(0) && (d = " " + d), i.allow_conditional_comments || "[if" !== d.substr(0, 3) || (d = " " + d), l.comment(d)) : (d = c[2]) ? l.cdata(d) : (d = c[3]) ? l.doctype(d) : (d = c[4]) && l.pi(d, c[5]); u = c.index + c[0].length } for (u < e.length && l.text(z(e.substr(u))), m = p.length - 1; m >= 0; m--) d = p[m], d.valid && l.end(d.name) } } var o = n.each; return i.findEndTag = r, i }), r(k, [_, E, N, u], function (e, t, n, r) { var i = r.makeMap, o = r.each, a = r.explode, s = r.extend; return function (r, l) { function c(t) { var n, r, o, a, s, c, d, f, p, h, m, g, v, y; for (m = i("tr,td,th,tbody,thead,tfoot,table"), h = l.getNonEmptyElements(), g = l.getTextBlockElements(), n = 0; n < t.length; n++) if (r = t[n], r.parent && !r.fixed) if (g[r.name] && "li" == r.parent.name) { for (v = r.next; v && g[v.name]; ) v.name = "li", v.fixed = !0, r.parent.insert(v, r.parent), v = v.next; r.unwrap(r) } else { for (a = [r], o = r.parent; o && !l.isValidChild(o.name, r.name) && !m[o.name]; o = o.parent) a.push(o); if (o && a.length > 1) { for (a.reverse(), s = c = u.filterNode(a[0].clone()), p = 0; p < a.length - 1; p++) { for (l.isValidChild(c.name, a[p].name) ? (d = u.filterNode(a[p].clone()), c.append(d)) : d = c, f = a[p].firstChild; f && f != a[p + 1]; ) y = f.next, d.append(f), f = y; c = d } s.isEmpty(h) ? o.insert(r, a[0], !0) : (o.insert(s, a[0], !0), o.insert(r, s)), o = a[0], (o.isEmpty(h) || o.firstChild === o.lastChild && "br" === o.firstChild.name) && o.empty().remove() } else if (r.parent) { if ("li" === r.name) { if (v = r.prev, v && ("ul" === v.name || "ul" === v.name)) { v.append(r); continue } if (v = r.next, v && ("ul" === v.name || "ul" === v.name)) { v.insert(r, v.firstChild, !0); continue } r.wrap(u.filterNode(new e("ul", 1))); continue } l.isValidChild(r.parent.name, "div") && l.isValidChild("div", r.name) ? r.wrap(u.filterNode(new e("div", 1))) : "style" === r.name || "script" === r.name ? r.empty().remove() : r.unwrap() } } } var u = this, d = {}, f = [], p = {}, h = {}; r = r || {}, r.validate = "validate" in r ? r.validate : !0, r.root_name = r.root_name || "body", u.schema = l = l || new t, u.filterNode = function (e) { var t, n, r; n in d && (r = p[n], r ? r.push(e) : p[n] = [e]), t = f.length; for (; t--; ) n = f[t].name, n in e.attributes.map && (r = h[n], r ? r.push(e) : h[n] = [e]); return e }, u.addNodeFilter = function (e, t) { o(a(e), function (e) { var n = d[e]; n || (d[e] = n = []), n.push(t) }) }, u.addAttributeFilter = function (e, t) { o(a(e), function (e) { var n; for (n = 0; n < f.length; n++) if (f[n].name === e) return void f[n].callbacks.push(t); f.push({ name: e, callbacks: [t] }) }) }, u.parse = function (t, o) { function a() { function e(e) { e && (t = e.firstChild, t && 3 == t.type && (t.value = t.value.replace(R, "")), t = e.lastChild, t && 3 == t.type && (t.value = t.value.replace(D, ""))) } var t = y.firstChild, n, i; if (l.isValidChild(y.name, I.toLowerCase())) { for (; t; ) n = t.next, 3 == t.type || 1 == t.type && "p" !== t.name && !T[t.name] && !t.attr("data-mce-type") ? i ? i.append(t) : (i = u(I, 1), i.attr(r.forced_root_block_attrs), y.insert(i, t), i.append(t)) : (e(i), i = null), t = n; e(i) } } function u(t, n) { var r = new e(t, n), i; return t in d && (i = p[t], i ? i.push(r) : p[t] = [r]), r } function m(e) { var t, n, r; for (t = e.prev; t && 3 === t.type; ) n = t.value.replace(D, ""), n.length > 0 ? (t.value = n, t = t.prev) : (r = t.prev, t.remove(), t = r) } function g(e) { var t, n = {}; for (t in e) "li" !== t && "p" != t && (n[t] = e[t]); return n } var v, y, b, C, x, w, _, E, N, k, S, T, R, A = [], B, D, L, H, M, P, O, I; if (o = o || {}, p = {}, h = {}, T = s(i("script,style,head,html,body,title,meta,param"), l.getBlockElements()), O = l.getNonEmptyElements(), P = l.children, S = r.validate, I = "forced_root_block" in o ? o.forced_root_block : r.forced_root_block, M = l.getWhiteSpaceElements(), R = /^[ \t\r\n]+/, D = /[ \t\r\n]+$/, L = /[ \t\r\n]+/g, H = /^[ \t\r\n]+$/, v = new n({ validate: S, allow_script_urls: r.allow_script_urls, allow_conditional_comments: r.allow_conditional_comments, self_closing_elements: g(l.getSelfClosingElements()), cdata: function (e) { b.append(u("#cdata", 4)).value = e }, text: function (e, t) { var n; B || (e = e.replace(L, " "), b.lastChild && T[b.lastChild.name] && (e = e.replace(R, ""))), 0 !== e.length && (n = u("#text", 3), n.raw = !!t, b.append(n).value = e) }, comment: function (e) { b.append(u("#comment", 8)).value = e }, pi: function (e, t) { b.append(u(e, 7)).value = t, m(b) }, doctype: function (e) { var t; t = b.append(u("#doctype", 10)), t.value = e, m(b) }, start: function (e, t, n) { var r, i, o, a, s; if (o = S ? l.getElementRule(e) : {}) { for (r = u(o.outputName || e, 1), r.attributes = t, r.shortEnded = n, b.append(r), s = P[b.name], s && P[r.name] && !s[r.name] && A.push(r), i = f.length; i--; ) a = f[i].name, a in t.map && (N = h[a], N ? N.push(r) : h[a] = [r]); T[e] && m(r), n || (b = r), !B && M[e] && (B = !0) } }, end: function (t) { var n, r, i, o, a; if (r = S ? l.getElementRule(t) : {}) { if (T[t] && !B) { if (n = b.firstChild, n && 3 === n.type) if (i = n.value.replace(R, ""), i.length > 0) n.value = i, n = n.next; else for (o = n.next, n.remove(), n = o; n && 3 === n.type; ) i = n.value, o = n.next, (0 === i.length || H.test(i)) && (n.remove(), n = o), n = o; if (n = b.lastChild, n && 3 === n.type) if (i = n.value.replace(D, ""), i.length > 0) n.value = i, n = n.prev; else for (o = n.prev, n.remove(), n = o; n && 3 === n.type; ) i = n.value, o = n.prev, (0 === i.length || H.test(i)) && (n.remove(), n = o), n = o } if (B && M[t] && (B = !1), (r.removeEmpty || r.paddEmpty) && b.isEmpty(O)) if (r.paddEmpty) b.empty().append(new e("#text", "3")).value = "\xa0"; else if (!b.attributes.map.name && !b.attributes.map.id) return a = b.parent, T[b.name] ? b.empty().remove() : b.unwrap(), void (b = a); b = b.parent } } }, l), y = b = new e(o.context || r.root_name, 11), v.parse(t), S && A.length && (o.context ? o.invalid = !0 : c(A)), I && ("body" == y.name || o.isRootContent) && a(), !o.invalid) { for (k in p) { for (N = d[k], C = p[k], _ = C.length; _--; ) C[_].parent || C.splice(_, 1); for (x = 0, w = N.length; w > x; x++) N[x](C, k, o) } for (x = 0, w = f.length; w > x; x++) if (N = f[x], N.name in h) { for (C = h[N.name], _ = C.length; _--; ) C[_].parent || C.splice(_, 1); for (_ = 0, E = N.callbacks.length; E > _; _++) N.callbacks[_](C, N.name, o) } } return y }, r.remove_trailing_brs && u.addNodeFilter("br", function (t) { var n, r = t.length, i, o = s({}, l.getBlockElements()), a = l.getNonEmptyElements(), c, u, d, f, p, h; for (o.body = 1, n = 0; r > n; n++) if (i = t[n], c = i.parent, o[i.parent.name] && i === c.lastChild) { for (d = i.prev; d; ) { if (f = d.name, "span" !== f || "bookmark" !== d.attr("data-mce-type")) { if ("br" !== f) break; if ("br" === f) { i = null; break } } d = d.prev } i && (i.remove(), c.isEmpty(a) && (p = l.getElementRule(c.name), p && (p.removeEmpty ? c.remove() : p.paddEmpty && (c.empty().append(new e("#text", 3)).value = "\xa0")))) } else { for (u = i; c && c.firstChild === u && c.lastChild === u && (u = c, !o[c.name]); ) c = c.parent; u === c && (h = new e("#text", 3), h.value = "\xa0", i.replace(h)) } }), r.allow_html_in_named_anchor || u.addAttributeFilter("id,name", function (e) { for (var t = e.length, n, r, i, o; t--; ) if (o = e[t], "a" === o.name && o.firstChild && !o.attr("href")) { i = o.parent, n = o.lastChild; do r = n.prev, i.insert(n, o), n = r; while (n) } }), r.validate && l.getValidClasses() && u.addAttributeFilter("class", function (e) { for (var t = e.length, n, r, i, o, a, s = l.getValidClasses(), c, u; t--; ) { for (n = e[t], r = n.attr("class").split(" "), a = "", i = 0; i < r.length; i++) o = r[i], u = !1, c = s["*"], c && c[o] && (u = !0), c = s[n.name], u || !c || c[o] || (u = !0), u && (a && (a += " "), a += o); a.length || (a = null), n.attr("class", a) } }) } }), r(S, [g, u], function (e, t) { var n = t.makeMap; return function (t) { var r = [], i, o, a, s, l; return t = t || {}, i = t.indent, o = n(t.indent_before || ""), a = n(t.indent_after || ""), s = e.getEncodeFunc(t.entity_encoding || "raw", t.entities), l = "html" == t.element_format, { start: function (e, t, n) { var c, u, d, f; if (i && o[e] && r.length > 0 && (f = r[r.length - 1], f.length > 0 && "\n" !== f && r.push("\n")), r.push("<", e), t) for (c = 0, u = t.length; u > c; c++) d = t[c], r.push(" ", d.name, '="', s(d.value, !0), '"'); r[r.length] = !n || l ? ">" : " />", n && i && a[e] && r.length > 0 && (f = r[r.length - 1], f.length > 0 && "\n" !== f && r.push("\n")) }, end: function (e) { var t; r.push("</", e, ">"), i && a[e] && r.length > 0 && (t = r[r.length - 1], t.length > 0 && "\n" !== t && r.push("\n")) }, text: function (e, t) { e.length > 0 && (r[r.length] = t ? e : s(e)) }, cdata: function (e) { r.push("<![CDATA[", e, "]]>") }, comment: function (e) { r.push("<!--", e, "-->") }, pi: function (e, t) { t ? r.push("<?", e, " ", t, "?>") : r.push("<?", e, "?>"), i && r.push("\n") }, doctype: function (e) { r.push("<!DOCTYPE", e, ">", i ? "\n" : "") }, reset: function () { r.length = 0 }, getContent: function () { return r.join("").replace(/\n$/, "") } } } }), r(T, [S, E], function (e, t) { return function (n, r) { var i = this, o = new e(n); n = n || {}, n.validate = "validate" in n ? n.validate : !0, i.schema = r = r || new t, i.writer = o, i.serialize = function (e) { function t(e) { var n = i[e.type], s, l, c, u, d, f, p, h, m; if (n) n(e); else { if (s = e.name, l = e.shortEnded, c = e.attributes, a && c && c.length > 1) { for (f = [], f.map = {}, m = r.getElementRule(e.name), p = 0, h = m.attributesOrder.length; h > p; p++) u = m.attributesOrder[p], u in c.map && (d = c.map[u], f.map[u] = d, f.push({ name: u, value: d })); for (p = 0, h = c.length; h > p; p++) u = c[p].name, u in f.map || (d = c.map[u], f.map[u] = d, f.push({ name: u, value: d })); c = f } if (o.start(e.name, c, l), !l) { if (e = e.firstChild) do t(e); while (e = e.next); o.end(s) } } } var i, a; return a = n.validate, i = { 3: function (e) { o.text(e.value, e.raw) }, 8: function (e) { o.comment(e.value) }, 7: function (e) { o.pi(e.name, e.value) }, 10: function (e) { o.doctype(e.value) }, 4: function (e) { o.cdata(e.value) }, 11: function (e) { if (e = e.firstChild) do t(e); while (e = e.next) } }, o.reset(), 1 != e.type || n.inner ? i[11](e) : t(e), o.getContent() } } }), r(R, [y, k, g, T, _, E, d, u], function (e, t, n, r, i, o, a, s) { var l = s.each, c = s.trim, u = e.DOM; return function (e, i) { var s, d, f; return i && (s = i.dom, d = i.schema), s = s || u, d = d || new o(e), e.entity_encoding = e.entity_encoding || "named", e.remove_trailing_brs = "remove_trailing_brs" in e ? e.remove_trailing_brs : !0, f = new t(e, d), f.addAttributeFilter("data-mce-tabindex", function (e, t) { for (var n = e.length, r; n--; ) r = e[n], r.attr("tabindex", r.attributes.map["data-mce-tabindex"]), r.attr(t, null) }), f.addAttributeFilter("src,href,style", function (t, n) { for (var r = t.length, i, o, a = "data-mce-" + n, l = e.url_converter, c = e.url_converter_scope, u; r--; ) i = t[r], o = i.attributes.map[a], o !== u ? (i.attr(n, o.length > 0 ? o : null), i.attr(a, null)) : (o = i.attributes.map[n], "style" === n ? o = s.serializeStyle(s.parseStyle(o), i.name) : l && (o = l.call(c, o, n, i.name)), i.attr(n, o.length > 0 ? o : null)) }), f.addAttributeFilter("class", function (e) { for (var t = e.length, n, r; t--; ) n = e[t], r = n.attr("class"), r && (r = n.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g, ""), n.attr("class", r.length > 0 ? r : null)) }), f.addAttributeFilter("data-mce-type", function (e, t, n) { for (var r = e.length, i; r--; ) i = e[r], "bookmark" !== i.attributes.map["data-mce-type"] || n.cleanup || i.remove() }), f.addNodeFilter("noscript", function (e) { for (var t = e.length, r; t--; ) r = e[t].firstChild, r && (r.value = n.decode(r.value)) }), f.addNodeFilter("script,style", function (e, t) { function n(e) { return e.replace(/(<!--\[CDATA\[|\]\]-->)/g, "\n").replace(/^[\r\n]*|[\r\n]*$/g, "").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi, "").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g, "") } for (var r = e.length, i, o, a; r--; ) i = e[r], o = i.firstChild ? i.firstChild.value : "", "script" === t ? (a = i.attr("type"), a && i.attr("type", "mce-no/type" == a ? null : a.replace(/^mce\-/, "")), o.length > 0 && (i.firstChild.value = "// <![CDATA[\n" + n(o) + "\n// ]]>")) : o.length > 0 && (i.firstChild.value = "<!--\n" + n(o) + "\n-->") }), f.addNodeFilter("#comment", function (e) { for (var t = e.length, n; t--; ) n = e[t], 0 === n.value.indexOf("[CDATA[") ? (n.name = "#cdata", n.type = 4, n.value = n.value.replace(/^\[CDATA\[|\]\]$/g, "")) : 0 === n.value.indexOf("mce:protected ") && (n.name = "#text", n.type = 3, n.raw = !0, n.value = unescape(n.value).substr(14)) }), f.addNodeFilter("xml:namespace,input", function (e, t) { for (var n = e.length, r; n--; ) r = e[n], 7 === r.type ? r.remove() : 1 === r.type && ("input" !== t || "type" in r.attributes.map || r.attr("type", "text")) }), e.fix_list_elements && f.addNodeFilter("ul,ol", function (e) { for (var t = e.length, n, r; t--; ) n = e[t], r = n.parent, ("ul" === r.name || "ol" === r.name) && n.prev && "li" === n.prev.name && n.prev.append(n) }), f.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize", function (e, t) { for (var n = e.length; n--; ) e[n].attr(t, null) }), { schema: d, addNodeFilter: f.addNodeFilter, addAttributeFilter: f.addAttributeFilter, serialize: function (t, n) { var i = this, o, u, p, h, m; return a.ie && s.select("script,style,select,map").length > 0 ? (m = t.innerHTML, t = t.cloneNode(!1), s.setHTML(t, m)) : t = t.cloneNode(!0), o = t.ownerDocument.implementation, o.createHTMLDocument && (u = o.createHTMLDocument(""), l("BODY" == t.nodeName ? t.childNodes : [t], function (e) { u.body.appendChild(u.importNode(e, !0)) }), t = "BODY" != t.nodeName ? u.body.firstChild : u.body, p = s.doc, s.doc = u), n = n || {}, n.format = n.format || "html", n.selection && (n.forced_root_block = ""), n.no_events || (n.node = t, i.onPreProcess(n)), h = new r(e, d), n.content = h.serialize(f.parse(c(n.getInner ? t.innerHTML : s.getOuterHTML(t)), n)), n.cleanup || (n.content = n.content.replace(/\uFEFF/g, "")), n.no_events || i.onPostProcess(n), p && (s.doc = p), n.node = null, n.content }, addRules: function (e) { d.addValidElements(e) }, setRules: function (e) { d.setValidElements(e) }, onPreProcess: function (e) { i && i.fire("PreProcess", e) }, onPostProcess: function (e) { i && i.fire("PostProcess", e) } } } }), r(A, [], function () { function e(e) { function t(t, n) { var r, i = 0, o, a, s, l, c, u, d = -1, f; if (r = t.duplicate(), r.collapse(n), f = r.parentElement(), f.ownerDocument === e.dom.doc) { for (; "false" === f.contentEditable; ) f = f.parentNode; if (!f.hasChildNodes()) return { node: f, inside: 1 }; for (s = f.children, o = s.length - 1; o >= i; ) if (u = Math.floor((i + o) / 2), l = s[u], r.moveToElementText(l), d = r.compareEndPoints(n ? "StartToStart" : "EndToEnd", t), d > 0) o = u - 1; else { if (!(0 > d)) return { node: l }; i = u + 1 } if (0 > d) for (l ? r.collapse(!1) : (r.moveToElementText(f), r.collapse(!0), l = f, a = !0), c = 0; 0 !== r.compareEndPoints(n ? "StartToStart" : "StartToEnd", t) && 0 !== r.move("character", 1) && f == r.parentElement(); ) c++; else for (r.collapse(!0), c = 0; 0 !== r.compareEndPoints(n ? "StartToStart" : "StartToEnd", t) && 0 !== r.move("character", -1) && f == r.parentElement(); ) c++; return { node: l, position: d, offset: c, inside: a} } } function n() { function n(e) { var n = t(o, e), r, i, s = 0, l, c, u; if (r = n.node, i = n.offset, n.inside && !r.hasChildNodes()) return void a[e ? "setStart" : "setEnd"](r, 0); if (i === c) return void a[e ? "setStartBefore" : "setEndAfter"](r); if (n.position < 0) { if (l = n.inside ? r.firstChild : r.nextSibling, !l) return void a[e ? "setStartAfter" : "setEndAfter"](r); if (!i) return void (3 == l.nodeType ? a[e ? "setStart" : "setEnd"](l, 0) : a[e ? "setStartBefore" : "setEndBefore"](l)); for (; l; ) { if (3 == l.nodeType && (u = l.nodeValue, s += u.length, s >= i)) { r = l, s -= i, s = u.length - s; break } l = l.nextSibling } } else { if (l = r.previousSibling, !l) return a[e ? "setStartBefore" : "setEndBefore"](r); if (!i) return void (3 == r.nodeType ? a[e ? "setStart" : "setEnd"](l, r.nodeValue.length) : a[e ? "setStartAfter" : "setEndAfter"](l)); for (; l; ) { if (3 == l.nodeType && (s += l.nodeValue.length, s >= i)) { r = l, s -= i; break } l = l.previousSibling } } a[e ? "setStart" : "setEnd"](r, s) } var o = e.getRng(), a = i.createRng(), s, l, c, u, d; if (s = o.item ? o.item(0) : o.parentElement(), s.ownerDocument != i.doc) return a; if (l = e.isCollapsed(), o.item) return a.setStart(s.parentNode, i.nodeIndex(s)), a.setEnd(a.startContainer, a.startOffset + 1), a; try { n(!0), l || n() } catch (f) { if (-2147024809 != f.number) throw f; d = r.getBookmark(2), c = o.duplicate(), c.collapse(!0), s = c.parentElement(), l || (c = o.duplicate(), c.collapse(!1), u = c.parentElement(), u.innerHTML = u.innerHTML), s.innerHTML = s.innerHTML, r.moveToBookmark(d), o = e.getRng(), n(!0), l || n() } return a } var r = this, i = e.dom, o = !1; this.getBookmark = function (n) { function r(e) { var t, n, r, o, a = []; for (t = e.parentNode, n = i.getRoot().parentNode; t != n && 9 !== t.nodeType; ) { for (r = t.children, o = r.length; o--; ) if (e === r[o]) { a.push(o); break } e = t, t = t.parentNode } return a } function o(e) { var n; return n = t(a, e), n ? { position: n.position, offset: n.offset, indexes: r(n.node), inside: n.inside} : void 0 } var a = e.getRng(), s = {}; return 2 === n && (a.item ? s.start = { ctrl: !0, indexes: r(a.item(0))} : (s.start = o(!0), e.isCollapsed() || (s.end = o()))), s }, this.moveToBookmark = function (e) { function t(e) { var t, n, r, o; for (t = i.getRoot(), n = e.length - 1; n >= 0; n--) o = t.children, r = e[n], r <= o.length - 1 && (t = o[r]); return t } function n(n) { var i = e[n ? "start" : "end"], a, s, l, c; i && (a = i.position > 0, s = o.createTextRange(), s.moveToElementText(t(i.indexes)), c = i.offset, c !== l ? (s.collapse(i.inside || a), s.moveStart("character", a ? -c : c)) : s.collapse(n), r.setEndPoint(n ? "StartToStart" : "EndToStart", s), n && r.collapse(!0)) } var r, o = i.doc.body; e.start && (e.start.ctrl ? (r = o.createControlRange(), r.addElement(t(e.start.indexes)), r.select()) : (r = o.createTextRange(), n(!0), n(), r.select())) }, this.addRange = function (t) { function n(e) { var t, n, a, d, h; a = i.create("a"), t = e ? s : c, n = e ? l : u, d = r.duplicate(), (t == f || t == f.documentElement) && (t = p, n = 0), 3 == t.nodeType ? (t.parentNode.insertBefore(a, t), d.moveToElementText(a), d.moveStart("character", n), i.remove(a), r.setEndPoint(e ? "StartToStart" : "EndToEnd", d)) : (h = t.childNodes, h.length ? (n >= h.length ? i.insertAfter(a, h[h.length - 1]) : t.insertBefore(a, h[n]), d.moveToElementText(a)) : t.canHaveHTML && (t.innerHTML = "<span>&#xFEFF;</span>", a = t.firstChild, d.moveToElementText(a), d.collapse(o)), r.setEndPoint(e ? "StartToStart" : "EndToEnd", d), i.remove(a)) } var r, a, s, l, c, u, d, f = e.dom.doc, p = f.body, h, m; if (s = t.startContainer, l = t.startOffset, c = t.endContainer, u = t.endOffset, r = p.createTextRange(), s == c && 1 == s.nodeType) { if (l == u && !s.hasChildNodes()) { if (s.canHaveHTML) return d = s.previousSibling, d && !d.hasChildNodes() && i.isBlock(d) ? d.innerHTML = "&#xFEFF;" : d = null, s.innerHTML = "<span>&#xFEFF;</span><span>&#xFEFF;</span>", r.moveToElementText(s.lastChild), r.select(), i.doc.selection.clear(), s.innerHTML = "", void (d && (d.innerHTML = "")); l = i.nodeIndex(s), s = s.parentNode } if (l == u - 1) try { if (m = s.childNodes[l], a = p.createControlRange(), a.addElement(m), a.select(), h = e.getRng(), h.item && m === h.item(0)) return } catch (g) { } } n(!0), n(), r.select() }, this.getRangeAt = n } return e }), r(B, [d], function (e) { return { BACKSPACE: 8, DELETE: 46, DOWN: 40, ENTER: 13, LEFT: 37, RIGHT: 39, SPACEBAR: 32, TAB: 9, UP: 38, modifierPressed: function (e) { return e.shiftKey || e.ctrlKey || e.altKey }, metaKeyPressed: function (t) { return e.mac ? t.metaKey : t.ctrlKey && !t.altKey } } }), r(D, [B, u, d], function (e, t, n) { return function (r, i) { function o(e) { var t = i.settings.object_resizing; return t === !1 || n.iOS ? !1 : ("string" != typeof t && (t = "table,img,div"), "false" === e.getAttribute("data-mce-resize") ? !1 : i.dom.is(e, t)) } function a(t) { var n, r, o, a, s; n = t.screenX - T, r = t.screenY - R, P = n * k[2] + D, O = r * k[3] + L, P = 5 > P ? 5 : P, O = 5 > O ? 5 : O, o = "IMG" == w.nodeName && i.settings.resize_img_proportional !== !1 ? !e.modifierPressed(t) : e.modifierPressed(t) || "IMG" == w.nodeName && k[2] * k[3] !== 0, o && (W(n) > W(r) ? (O = V(P * H), P = V(O / H)) : (P = V(O / H), O = V(P * H))), C.setStyles(_, { width: P, height: O }), a = k.startPos.x + n, s = k.startPos.y + r, a = a > 0 ? a : 0, s = s > 0 ? s : 0, C.setStyles(E, { left: a, top: s, display: "block" }), E.innerHTML = P + " &times; " + O, k[2] < 0 && _.clientWidth <= P && C.setStyle(_, "left", A + (D - P)), k[3] < 0 && _.clientHeight <= O && C.setStyle(_, "top", B + (L - O)), n = U.scrollWidth - $, r = U.scrollHeight - q, n + r !== 0 && C.setStyles(E, { left: a - n, top: s - r }), M || (i.fire("ObjectResizeStart", { target: w, width: D, height: L }), M = !0) } function s() { function e(e, t) { t && (w.style[e] || !i.schema.isValid(w.nodeName.toLowerCase(), e) ? C.setStyle(w, e, t) : C.setAttrib(w, e, t)) } M = !1, e("width", P), e("height", O), C.unbind(I, "mousemove", a), C.unbind(I, "mouseup", s), F != I && (C.unbind(F, "mousemove", a), C.unbind(F, "mouseup", s)), C.remove(_), C.remove(E), z && "TABLE" != w.nodeName || l(w), i.fire("ObjectResized", { target: w, width: P, height: O }), C.setAttrib(w, "style", C.getAttrib(w, "style")), i.nodeChanged() } function l(e, t, r) { var l, u, d, f, p; g(), l = C.getPos(e, U), A = l.x, B = l.y, p = e.getBoundingClientRect(), u = p.width || p.right - p.left, d = p.height || p.bottom - p.top, w != e && (m(), w = e, P = O = 0), f = i.fire("ObjectSelected", { target: e }), o(e) && !f.isDefaultPrevented() ? x(N, function (e, i) { function o(t) { T = t.screenX, R = t.screenY, D = w.clientWidth, L = w.clientHeight, H = L / D, k = e, e.startPos = { x: u * e[0] + A, y: d * e[1] + B }, $ = U.scrollWidth, q = U.scrollHeight, _ = w.cloneNode(!0), C.addClass(_, "mce-clonedresizable"), C.setAttrib(_, "data-mce-bogus", "all"), _.contentEditable = !1, _.unSelectabe = !0, C.setStyles(_, { left: A, top: B, margin: 0 }), _.removeAttribute("data-mce-selected"), U.appendChild(_), C.bind(I, "mousemove", a), C.bind(I, "mouseup", s), F != I && (C.bind(F, "mousemove", a), C.bind(F, "mouseup", s)), E = C.add(U, "div", { "class": "mce-resize-helper", "data-mce-bogus": "all" }, D + " &times; " + L) } var l, c; return t ? void (i == t && o(r)) : (l = C.get("mceResizeHandle" + i), l ? C.show(l) : (c = U, l = C.add(c, "div", { id: "mceResizeHandle" + i, "data-mce-bogus": "all", "class": "mce-resizehandle", unselectable: !0, style: "cursor:" + i + "-resize; margin:0; padding:0" }), n.ie && (l.contentEditable = !1)), e.elm || (C.bind(l, "mousedown", function (e) { e.stopImmediatePropagation(), e.preventDefault(), o(e) }), e.elm = l), void C.setStyles(l, { left: u * e[0] + A - l.offsetWidth / 2, top: d * e[1] + B - l.offsetHeight / 2 })) }) : c(), w.setAttribute("data-mce-selected", "1") } function c() { var e, t; g(), w && w.removeAttribute("data-mce-selected"); for (e in N) t = C.get("mceResizeHandle" + e), t && (C.unbind(t), C.remove(t)) } function u(e) { function t(e, t) { if (e) do if (e === t) return !0; while (e = e.parentNode) } var n, i; if (!M) return x(C.select("img[data-mce-selected],hr[data-mce-selected]"), function (e) { e.removeAttribute("data-mce-selected") }), i = "mousedown" == e.type ? e.target : r.getNode(), i = C.$(i).closest(z ? "table" : "table,img,hr")[0], t(i, U) && (v(), n = r.getStart(!0), t(n, i) && t(r.getEnd(!0), i) && (!z || i != n && "IMG" !== n.nodeName)) ? void l(i) : void c() } function d(e, t, n) { e && e.attachEvent && e.attachEvent("on" + t, n) } function f(e, t, n) { e && e.detachEvent && e.detachEvent("on" + t, n) } function p(e) { var t = e.srcElement, n, r, o, a, s, c, u; n = t.getBoundingClientRect(), c = S.clientX - n.left, u = S.clientY - n.top; for (r in N) if (o = N[r], a = t.offsetWidth * o[0], s = t.offsetHeight * o[1], W(a - c) < 8 && W(s - u) < 8) { k = o; break } M = !0, i.fire("ObjectResizeStart", { target: w, width: w.clientWidth, height: w.clientHeight }), i.getDoc().selection.empty(), l(t, r, S) } function h(e) { var t = e.srcElement; if (t != w) { if (i.fire("ObjectSelected", { target: t }), m(), 0 === t.id.indexOf("mceResizeHandle")) return void (e.returnValue = !1); ("IMG" == t.nodeName || "TABLE" == t.nodeName) && (c(), w = t, d(t, "resizestart", p)) } } function m() { f(w, "resizestart", p) } function g() { for (var e in N) { var t = N[e]; t.elm && (C.unbind(t.elm), delete t.elm) } } function v() { try { i.getDoc().execCommand("enableObjectResizing", !1, !1) } catch (e) { } } function y(e) { var t; if (z) { t = I.body.createControlRange(); try { return t.addElement(e), t.select(), !0 } catch (n) { } } } function b() { w = _ = null, z && (m(), f(U, "controlselect", h)) } var C = i.dom, x = t.each, w, _, E, N, k, S, T, R, A, B, D, L, H, M, P, O, I = i.getDoc(), F = document, z = n.ie && n.ie < 11, W = Math.abs, V = Math.round, U = i.getBody(), $, q; N = { n: [.5, 0, 0, -1], e: [1, .5, 1, 0], s: [.5, 1, 0, 1], w: [0, .5, -1, 0], nw: [0, 0, -1, -1], ne: [1, 0, 1, -1], se: [1, 1, 1, 1], sw: [0, 1, -1, 1] }; var j = ".mce-content-body"; return i.contentStyles.push(j + " div.mce-resizehandle {position: absolute;border: 1px solid black;background: #FFF;width: 5px;height: 5px;z-index: 10000}" + j + " .mce-resizehandle:hover {background: #000}" + j + " img[data-mce-selected], hr[data-mce-selected] {outline: 1px solid black;resize: none}" + j + " .mce-clonedresizable {position: absolute;" + (n.gecko ? "" : "outline: 1px dashed black;") + "opacity: .5;filter: alpha(opacity=50);z-index: 10000}" + j + " .mce-resize-helper {background: #555;background: rgba(0,0,0,0.75);border-radius: 3px;border: 1px;color: white;display: none;font-family: sans-serif;font-size: 12px;white-space: nowrap;line-height: 14px;margin: 5px 10px;padding: 5px;position: absolute;z-index: 10001}"), i.on("init", function () { z ? (i.on("ObjectResized", function (e) { "TABLE" != e.target.nodeName && (c(), y(e.target)) }), d(U, "controlselect", h), i.on("mousedown", function (e) { S = e })) : (v(), n.ie >= 11 && (i.on("mouseup", function (e) { var t = e.target.nodeName; !M && /^(TABLE|IMG|HR)$/.test(t) && (i.selection.select(e.target, "TABLE" == t), i.nodeChanged()) }), i.dom.bind(U, "mscontrolselect", function (e) { /^(TABLE|IMG|HR)$/.test(e.target.nodeName) && (e.preventDefault(), "IMG" == e.target.tagName && window.setTimeout(function () { i.selection.select(e.target) }, 0)) }))), i.on("nodechange ResizeEditor", u), i.on("keydown keyup", function (e) { w && "TABLE" == w.nodeName && u(e) }), i.on("hide", c) }), i.on("remove", g), { isResizable: o, showResizeRect: l, hideResizeRect: c, updateResizeRect: u, controlSelect: y, destroy: b} } }), r(L, [d, u], function (e, t) { function n(n) { var r = n.dom; this.getBookmark = function (e, i) { function o(e, n) { var i = 0; return t.each(r.select(e), function (e, t) { e == n && (i = t) }), i } function a(e) { function t(t) { var n, r, i, o = t ? "start" : "end"; n = e[o + "Container"], r = e[o + "Offset"], 1 == n.nodeType && "TR" == n.nodeName && (i = n.childNodes, n = i[Math.min(t ? r : r - 1, i.length - 1)], n && (r = t ? 0 : n.childNodes.length, e["set" + (t ? "Start" : "End")](n, r))) } return t(!0), t(), e } function s() { function e(e, t) { var n = e[t ? "startContainer" : "endContainer"], a = e[t ? "startOffset" : "endOffset"], s = [], l, c, u = 0; if (3 == n.nodeType) { if (i) for (l = n.previousSibling; l && 3 == l.nodeType; l = l.previousSibling) a += l.nodeValue.length; s.push(a) } else c = n.childNodes, a >= c.length && c.length && (u = 1, a = Math.max(0, c.length - 1)), s.push(r.nodeIndex(c[a], i) + u); for (; n && n != o; n = n.parentNode) s.push(r.nodeIndex(n, i)); return s } var t = n.getRng(!0), o = r.getRoot(), a = {}; return a.start = e(t, !0), n.isCollapsed() || (a.end = e(t)), a } var l, c, u, d, f, p, h = "&#xFEFF;", m; if (2 == e) return p = n.getNode(), f = p ? p.nodeName : null, "IMG" == f ? { name: f, index: o(f, p)} : n.tridentSel ? n.tridentSel.getBookmark(e) : s(); if (e) return { rng: n.getRng() }; if (l = n.getRng(), u = r.uniqueId(), d = n.isCollapsed(), m = "overflow:hidden;line-height:0px", l.duplicate || l.item) { if (l.item) return p = l.item(0), f = p.nodeName, { name: f, index: o(f, p) }; c = l.duplicate(); try { l.collapse(), l.pasteHTML('<span data-mce-type="bookmark" id="' + u + '_start" style="' + m + '">' + h + "</span>"), d || (c.collapse(!1), l.moveToElementText(c.parentElement()), 0 === l.compareEndPoints("StartToEnd", c) && c.move("character", -1), c.pasteHTML('<span data-mce-type="bookmark" id="' + u + '_end" style="' + m + '">' + h + "</span>")) } catch (g) { return null } } else { if (p = n.getNode(), f = p.nodeName, "IMG" == f) return { name: f, index: o(f, p) }; c = a(l.cloneRange()), d || (c.collapse(!1), c.insertNode(r.create("span", { "data-mce-type": "bookmark", id: u + "_end", style: m }, h))), l = a(l), l.collapse(!0), l.insertNode(r.create("span", { "data-mce-type": "bookmark", id: u + "_start", style: m }, h)) } return n.moveToBookmark({ id: u, keep: 1 }), { id: u} }, this.moveToBookmark = function (i) { function o(e) { var t = i[e ? "start" : "end"], n, r, o, a; if (t) { for (o = t[0], r = c, n = t.length - 1; n >= 1; n--) { if (a = r.childNodes, t[n] > a.length - 1) return; r = a[t[n]] } 3 === r.nodeType && (o = Math.min(t[0], r.nodeValue.length)), 1 === r.nodeType && (o = Math.min(t[0], r.childNodes.length)), e ? l.setStart(r, o) : l.setEnd(r, o) } return !0 } function a(n) { var o = r.get(i.id + "_" + n), a, s, l, c, h = i.keep; if (o && (a = o.parentNode, "start" == n ? (h ? (a = o.firstChild, s = 1) : s = r.nodeIndex(o), u = d = a, f = p = s) : (h ? (a = o.firstChild, s = 1) : s = r.nodeIndex(o), d = a, p = s), !h)) { for (c = o.previousSibling, l = o.nextSibling, t.each(t.grep(o.childNodes), function (e) { 3 == e.nodeType && (e.nodeValue = e.nodeValue.replace(/\uFEFF/g, "")) }); o = r.get(i.id + "_" + n); ) r.remove(o, 1); c && l && c.nodeType == l.nodeType && 3 == c.nodeType && !e.opera && (s = c.nodeValue.length, c.appendData(l.nodeValue), r.remove(l), "start" == n ? (u = d = c, f = p = s) : (d = c, p = s)) } } function s(t) { return !r.isBlock(t) || t.innerHTML || e.ie || (t.innerHTML = '<br data-mce-bogus="1" />'), t } var l, c, u, d, f, p; if (i) if (i.start) { if (l = r.createRng(), c = r.getRoot(), n.tridentSel) return n.tridentSel.moveToBookmark(i); o(!0) && o() && n.setRng(l) } else i.id ? (a("start"), a("end"), u && (l = r.createRng(), l.setStart(s(u), f), l.setEnd(s(d), p), n.setRng(l))) : i.name ? n.select(r.select(i.name)[i.index]) : i.rng && n.setRng(i.rng) } } return n.isBookmarkNode = function (e) { return e && "SPAN" === e.tagName && "bookmark" === e.getAttribute("data-mce-type") }, n }), r(H, [h, A, D, x, L, d, u], function (e, n, r, i, o, a, s) { function l(e, t, i, a) { var s = this; s.dom = e, s.win = t, s.serializer = i, s.editor = a, s.bookmarkManager = new o(s), s.controlSelection = new r(s, a), s.win.getSelection || (s.tridentSel = new n(s)) } var c = s.each, u = s.trim, d = a.ie; return l.prototype = { setCursorLocation: function (e, t) { var n = this, r = n.dom.createRng(); e ? (r.setStart(e, t), r.setEnd(e, t), n.setRng(r), n.collapse(!1)) : (n._moveEndPoint(r, n.editor.getBody(), !0), n.setRng(r)) }, getContent: function (e) { var n = this, r = n.getRng(), i = n.dom.create("body"), o = n.getSel(), a, s, l; return e = e || {}, a = s = "", e.get = !0, e.format = e.format || "html", e.selection = !0, n.editor.fire("BeforeGetContent", e), "text" == e.format ? n.isCollapsed() ? "" : r.text || (o.toString ? o.toString() : "") : (r.cloneContents ? (l = r.cloneContents(), l && i.appendChild(l)) : r.item !== t || r.htmlText !== t ? (i.innerHTML = "<br>" + (r.item ? r.item(0).outerHTML : r.htmlText), i.removeChild(i.firstChild)) : i.innerHTML = r.toString(), /^\s/.test(i.innerHTML) && (a = " "), /\s+$/.test(i.innerHTML) && (s = " "), e.getInner = !0, e.content = n.isCollapsed() ? "" : a + n.serializer.serialize(i, e) + s, n.editor.fire("GetContent", e), e.content) }, setContent: function (e, t) { var n = this, r = n.getRng(), i, o = n.win.document, a, s; if (t = t || { format: "html" }, t.set = !0, t.selection = !0, e = t.content = e, t.no_events || n.editor.fire("BeforeSetContent", t), e = t.content, r.insertNode) { e += '<span id="__caret">_</span>', r.startContainer == o && r.endContainer == o ? o.body.innerHTML = e : (r.deleteContents(), 0 === o.body.childNodes.length ? o.body.innerHTML = e : r.createContextualFragment ? r.insertNode(r.createContextualFragment(e)) : (a = o.createDocumentFragment(), s = o.createElement("div"), a.appendChild(s), s.outerHTML = e, r.insertNode(a))), i = n.dom.get("__caret"), r = o.createRange(), r.setStartBefore(i), r.setEndBefore(i), n.setRng(r), n.dom.remove("__caret"); try { n.setRng(r) } catch (l) { } } else r.item && (o.execCommand("Delete", !1, null), r = n.getRng()), /^\s+/.test(e) ? (r.pasteHTML('<span id="__mce_tmp">_</span>' + e), n.dom.remove("__mce_tmp")) : r.pasteHTML(e); t.no_events || n.editor.fire("SetContent", t) }, getStart: function (e) { var t = this, n = t.getRng(), r, i, o, a; if (n.duplicate || n.item) { if (n.item) return n.item(0); for (o = n.duplicate(), o.collapse(1), r = o.parentElement(), r.ownerDocument !== t.dom.doc && (r = t.dom.getRoot()), i = a = n.parentElement(); a = a.parentNode; ) if (a == r) { r = i; break } return r } return r = n.startContainer, 1 == r.nodeType && r.hasChildNodes() && (e && n.collapsed || (r = r.childNodes[Math.min(r.childNodes.length - 1, n.startOffset)])), r && 3 == r.nodeType ? r.parentNode : r }, getEnd: function (e) { var t = this, n = t.getRng(), r, i; return n.duplicate || n.item ? n.item ? n.item(0) : (n = n.duplicate(), n.collapse(0), r = n.parentElement(), r.ownerDocument !== t.dom.doc && (r = t.dom.getRoot()), r && "BODY" == r.nodeName ? r.lastChild || r : r) : (r = n.endContainer, i = n.endOffset, 1 == r.nodeType && r.hasChildNodes() && (e && n.collapsed || (r = r.childNodes[i > 0 ? i - 1 : i])), r && 3 == r.nodeType ? r.parentNode : r) }, getBookmark: function (e, t) { return this.bookmarkManager.getBookmark(e, t) }, moveToBookmark: function (e) { return this.bookmarkManager.moveToBookmark(e) }, select: function (e, t) { var n = this, r = n.dom, i = r.createRng(), o; if (n.lastFocusBookmark = null, e) { if (!t && n.controlSelection.controlSelect(e)) return; o = r.nodeIndex(e), i.setStart(e.parentNode, o), i.setEnd(e.parentNode, o + 1), t && (n._moveEndPoint(i, e, !0), n._moveEndPoint(i, e)), n.setRng(i) } return e }, isCollapsed: function () { var e = this, t = e.getRng(), n = e.getSel(); return !t || t.item ? !1 : t.compareEndPoints ? 0 === t.compareEndPoints("StartToEnd", t) : !n || t.collapsed }, collapse: function (e) { var t = this, n = t.getRng(), r; n.item && (r = n.item(0), n = t.win.document.body.createTextRange(), n.moveToElementText(r)), n.collapse(!!e), t.setRng(n) }, getSel: function () { var e = this.win; return e.getSelection ? e.getSelection() : e.document.selection }, getRng: function (e) { function t(e, t, n) { try { return t.compareBoundaryPoints(e, n) } catch (r) { return -1 } } var n = this, r, i, o, a = n.win.document, s; if (!e && n.lastFocusBookmark) { var l = n.lastFocusBookmark; return l.startContainer ? (i = a.createRange(), i.setStart(l.startContainer, l.startOffset), i.setEnd(l.endContainer, l.endOffset)) : i = l, i } if (e && n.tridentSel) return n.tridentSel.getRangeAt(0); try { (r = n.getSel()) && (i = r.rangeCount > 0 ? r.getRangeAt(0) : r.createRange ? r.createRange() : a.createRange()) } catch (c) { } if (d && i && i.setStart && a.selection) { try { s = a.selection.createRange() } catch (c) { } s && s.item && (o = s.item(0), i = a.createRange(), i.setStartBefore(o), i.setEndAfter(o)) } return i || (i = a.createRange ? a.createRange() : a.body.createTextRange()), i.setStart && 9 === i.startContainer.nodeType && i.collapsed && (o = n.dom.getRoot(), i.setStart(o, 0), i.setEnd(o, 0)), n.selectedRange && n.explicitRange && (0 === t(i.START_TO_START, i, n.selectedRange) && 0 === t(i.END_TO_END, i, n.selectedRange) ? i = n.explicitRange : (n.selectedRange = null, n.explicitRange = null)), i }, setRng: function (e, t) { var n = this, r; if (e) if (e.select) try { e.select() } catch (i) { } else if (n.tridentSel) { if (e.cloneRange) try { return void n.tridentSel.addRange(e) } catch (i) { } } else if (r = n.getSel()) { n.explicitRange = e; try { r.removeAllRanges(), r.addRange(e) } catch (i) { } t === !1 && r.extend && (r.collapse(e.endContainer, e.endOffset), r.extend(e.startContainer, e.startOffset)), n.selectedRange = r.rangeCount > 0 ? r.getRangeAt(0) : null } }, setNode: function (e) { var t = this; return t.setContent(t.dom.getOuterHTML(e)), e }, getNode: function () { function e(e, t) { for (var n = e; e && 3 === e.nodeType && 0 === e.length; ) e = t ? e.nextSibling : e.previousSibling; return e || n } var t = this, n = t.getRng(), r, i = n.startContainer, o = n.endContainer, a = n.startOffset, s = n.endOffset, l = t.dom.getRoot(); return n ? n.setStart ? (r = n.commonAncestorContainer, !n.collapsed && (i == o && 2 > s - a && i.hasChildNodes() && (r = i.childNodes[a]), 3 === i.nodeType && 3 === o.nodeType && (i = i.length === a ? e(i.nextSibling, !0) : i.parentNode, o = 0 === s ? e(o.previousSibling, !1) : o.parentNode, i && i === o)) ? i : r && 3 == r.nodeType ? r.parentNode : r) : (r = n.item ? n.item(0) : n.parentElement(), r.ownerDocument !== t.win.document && (r = l), r) : l }, getSelectedBlocks: function (t, n) { var r = this, i = r.dom, o, a, s = []; if (a = i.getRoot(), t = i.getParent(t || r.getStart(), i.isBlock), n = i.getParent(n || r.getEnd(), i.isBlock), t && t != a && s.push(t), t && n && t != n) { o = t; for (var l = new e(t, a); (o = l.next()) && o != n; ) i.isBlock(o) && s.push(o) } return n && t != n && n != a && s.push(n), s }, isForward: function () { var e = this.dom, t = this.getSel(), n, r; return t && t.anchorNode && t.focusNode ? (n = e.createRng(), n.setStart(t.anchorNode, t.anchorOffset), n.collapse(!0), r = e.createRng(), r.setStart(t.focusNode, t.focusOffset), r.collapse(!0), n.compareBoundaryPoints(n.START_TO_START, r) <= 0) : !0 }, normalize: function () { var e = this, t = e.getRng(); return !d && new i(e.dom).normalize(t) && e.setRng(t, e.isForward()), t }, selectorChanged: function (e, t) { var n = this, r; return n.selectorChangedData || (n.selectorChangedData = {}, r = {}, n.editor.on("NodeChange", function (e) { var t = e.element, i = n.dom, o = i.getParents(t, null, i.getRoot()), a = {}; c(n.selectorChangedData, function (e, t) { c(o, function (n) { return i.is(n, t) ? (r[t] || (c(e, function (e) { e(!0, { node: n, selector: t, parents: o }) }), r[t] = e), a[t] = e, !1) : void 0 }) }), c(r, function (e, n) { a[n] || (delete r[n], c(e, function (e) { e(!1, { node: t, selector: n, parents: o }) })) }) })), n.selectorChangedData[e] || (n.selectorChangedData[e] = []), n.selectorChangedData[e].push(t), n }, getScrollContainer: function () { for (var e, t = this.dom.getRoot(); t && "BODY" != t.nodeName; ) { if (t.scrollHeight > t.clientHeight) { e = t; break } t = t.parentNode } return e }, scrollIntoView: function (e) { function t(e) { for (var t = 0, n = 0, r = e; r && r.nodeType; ) t += r.offsetLeft || 0, n += r.offsetTop || 0, r = r.offsetParent; return { x: t, y: n} } var n, r, i = this, o = i.dom, a = o.getRoot(), s, l; if ("BODY" != a.nodeName) { var c = i.getScrollContainer(); if (c) return n = t(e).y - t(c).y, l = c.clientHeight, s = c.scrollTop, void ((s > n || n + 25 > s + l) && (c.scrollTop = s > n ? n : n - l + 25)) } r = o.getViewPort(i.editor.getWin()), n = o.getPos(e).y, s = r.y, l = r.h, (n < r.y || n + 25 > s + l) && i.editor.getWin().scrollTo(0, s > n ? n : n - l + 25) }, placeCaretAt: function (e, t) { var n = this.editor.getDoc(), r, i; if (n.caretPositionFromPoint) i = n.caretPositionFromPoint(e, t), r = n.createRange(), r.setStart(i.offsetNode, i.offset), r.collapse(!0); else if (n.caretRangeFromPoint) r = n.caretRangeFromPoint(e, t); else if (n.body.createTextRange) { r = n.body.createTextRange(); try { r.moveToPoint(e, t), r.collapse(!0) } catch (o) { r.collapse(t < n.body.clientHeight) } } this.setRng(r) }, _moveEndPoint: function (t, n, r) { var i = n, o = new e(n, i), s = this.dom.schema.getNonEmptyElements(); do { if (3 == n.nodeType && 0 !== u(n.nodeValue).length) return void (r ? t.setStart(n, 0) : t.setEnd(n, n.nodeValue.length)); if (s[n.nodeName] && !/^(TD|TH)$/.test(n.nodeName)) return void (r ? t.setStartBefore(n) : "BR" == n.nodeName ? t.setEndBefore(n) : t.setEndAfter(n)); if (a.ie && a.ie < 11 && this.dom.isBlock(n) && this.dom.isEmpty(n)) return void (r ? t.setStart(n, 0) : t.setEnd(n, 0)) } while (n = r ? o.next() : o.prev()); "BODY" == i.nodeName && (r ? t.setStart(i, 0) : t.setEnd(i, i.childNodes.length)) }, destroy: function () { this.win = null, this.controlSelection.destroy() } }, l }), r(M, [L, u], function (e, t) { function n(t) { this.compare = function (n, i) { function o(e) { var n = {}; return r(t.getAttribs(e), function (r) { var i = r.nodeName.toLowerCase(); 0 !== i.indexOf("_") && "style" !== i && "data-mce-style" !== i && (n[i] = t.getAttrib(e, i)) }), n } function a(e, t) { var n, r; for (r in e) if (e.hasOwnProperty(r)) { if (n = t[r], "undefined" == typeof n) return !1; if (e[r] != n) return !1; delete t[r] } for (r in t) if (t.hasOwnProperty(r)) return !1; return !0 } return n.nodeName != i.nodeName ? !1 : a(o(n), o(i)) && a(t.parseStyle(t.getAttrib(n, "style")), t.parseStyle(t.getAttrib(i, "style"))) ? !e.isBookmarkNode(n) && !e.isBookmarkNode(i) : !1 } } var r = t.each; return n }), r(P, [u], function (e) { function t(e, t) { function r(e) { return e.replace(/%(\w+)/g, "") } var i, o, a = e.dom, s = "", l, c; if (c = e.settings.preview_styles, c === !1) return ""; if (c || (c = "font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"), "string" == typeof t) { if (t = e.formatter.get(t), !t) return; t = t[0] } return i = t.block || t.inline || "span", o = a.create(i), n(t.styles, function (e, t) { e = r(e), e && a.setStyle(o, t, e) }), n(t.attributes, function (e, t) { e = r(e), e && a.setAttrib(o, t, e) }), n(t.classes, function (e) { e = r(e), a.hasClass(o, e) || a.addClass(o, e) }), e.fire("PreviewFormats"), a.setStyles(o, { position: "absolute", left: -65535 }), e.getBody().appendChild(o), l = a.getStyle(e.getBody(), "fontSize", !0), l = /px$/.test(l) ? parseInt(l, 10) : 0, n(c.split(" "), function (t) { var n = a.getStyle(o, t, !0); if (!("background-color" == t && /transparent|rgba\s*\([^)]+,\s*0\)/.test(n) && (n = a.getStyle(e.getBody(), t, !0), "#ffffff" == a.toHex(n).toLowerCase()) || "color" == t && "#000000" == a.toHex(n).toLowerCase())) { if ("font-size" == t && /em|%$/.test(n)) { if (0 === l) return; n = parseFloat(n, 10) / (/%$/.test(n) ? 100 : 1), n = n * l + "px" } "border" == t && n && (s += "padding:0 2px;"), s += t + ":" + n + ";" } }), e.fire("AfterPreviewFormats"), a.remove(o), s } var n = e.each; return { getCssText: t} }), r(O, [h, x, L, M, u, P], function (e, t, n, r, i, o) { return function (a) { function s(e) { return e.nodeType && (e = e.nodeName), !!a.schema.getTextBlockElements()[e.toLowerCase()] } function l(e, t) { return U.getParents(e, t, U.getRoot()) } function c(e) { return 1 === e.nodeType && "_mce_caret" === e.id } function u() { p({ valigntop: [{ selector: "td,th", styles: { verticalAlign: "top"}}], valignmiddle: [{ selector: "td,th", styles: { verticalAlign: "middle"}}], valignbottom: [{ selector: "td,th", styles: { verticalAlign: "bottom"}}], alignleft: [{ selector: "figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li", styles: { textAlign: "left" }, defaultBlock: "div" }, { selector: "img,table", collapsed: !1, styles: { "float": "left"}}], aligncenter: [{ selector: "figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li", styles: { textAlign: "center" }, defaultBlock: "div" }, { selector: "img", collapsed: !1, styles: { display: "block", marginLeft: "auto", marginRight: "auto"} }, { selector: "table", collapsed: !1, styles: { marginLeft: "auto", marginRight: "auto"}}], alignright: [{ selector: "figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li", styles: { textAlign: "right" }, defaultBlock: "div" }, { selector: "img,table", collapsed: !1, styles: { "float": "right"}}], alignjustify: [{ selector: "figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li", styles: { textAlign: "justify" }, defaultBlock: "div"}], bold: [{ inline: "strong", remove: "all" }, { inline: "span", styles: { fontWeight: "bold"} }, { inline: "b", remove: "all"}], italic: [{ inline: "em", remove: "all" }, { inline: "span", styles: { fontStyle: "italic"} }, { inline: "i", remove: "all"}], underline: [{ inline: "span", styles: { textDecoration: "underline" }, exact: !0 }, { inline: "u", remove: "all"}], strikethrough: [{ inline: "span", styles: { textDecoration: "line-through" }, exact: !0 }, { inline: "strike", remove: "all"}], forecolor: { inline: "span", styles: { color: "%value" }, links: !0, remove_similar: !0 }, hilitecolor: { inline: "span", styles: { backgroundColor: "%value" }, links: !0, remove_similar: !0 }, fontname: { inline: "span", styles: { fontFamily: "%value"} }, fontsize: { inline: "span", styles: { fontSize: "%value"} }, fontsize_class: { inline: "span", attributes: { "class": "%value"} }, blockquote: { block: "blockquote", wrapper: 1, remove: "all" }, subscript: { inline: "sub" }, superscript: { inline: "sup" }, code: { inline: "code" }, link: { inline: "a", selector: "a", remove: "all", split: !0, deep: !0, onmatch: function () { return !0 }, onformat: function (e, t, n) { at(n, function (t, n) { U.setAttrib(e, n, t) }) } }, removeformat: [{ selector: "b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q", remove: "all", split: !0, expand: !1, block_expand: !0, deep: !0 }, { selector: "span", attributes: ["style", "class"], remove: "empty", split: !0, expand: !1, deep: !0 }, { selector: "*", attributes: ["style", "class"], split: !1, expand: !1, deep: !0}] }), at("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/), function (e) { p(e, { block: e, remove: "all" }) }), p(a.settings.formats) } function d() { a.addShortcut("ctrl+b", "bold_desc", "Bold"), a.addShortcut("ctrl+i", "italic_desc", "Italic"), a.addShortcut("ctrl+u", "underline_desc", "Underline"); for (var e = 1; 6 >= e; e++) a.addShortcut("ctrl+" + e, "", ["FormatBlock", !1, "h" + e]); a.addShortcut("ctrl+7", "", ["FormatBlock", !1, "p"]), a.addShortcut("ctrl+8", "", ["FormatBlock", !1, "div"]), a.addShortcut("ctrl+9", "", ["FormatBlock", !1, "address"]) } function f(e) { return e ? V[e] : V } function p(e, t) { e && ("string" != typeof e ? at(e, function (e, t) { p(t, e) }) : (t = t.length ? t : [t], at(t, function (e) { e.deep === tt && (e.deep = !e.selector), e.split === tt && (e.split = !e.selector || e.inline), e.remove === tt && e.selector && !e.inline && (e.remove = "none"), e.selector && e.inline && (e.mixed = !0, e.block_expand = !0), "string" == typeof e.classes && (e.classes = e.classes.split(/\s+/)) }), V[e] = t)) } function h(e) { return e && V[e] && delete V[e], V } function m(e) { var t; return a.dom.getParent(e, function (e) { return t = a.dom.getStyle(e, "text-decoration"), t && "none" !== t }), t } function g(e) { var t; 1 === e.nodeType && e.parentNode && 1 === e.parentNode.nodeType && (t = m(e.parentNode), a.dom.getStyle(e, "color") && t ? a.dom.setStyle(e, "text-decoration", t) : a.dom.getStyle(e, "textdecoration") === t && a.dom.setStyle(e, "text-decoration", null)) } function v(t, n, r) { function i(e, t) { if (t = t || d, e) { if (t.onformat && t.onformat(e, t, n, r), at(t.styles, function (t, r) { U.setStyle(e, r, A(t, n)) }), t.styles) { var i = U.getAttrib(e, "style"); i && e.setAttribute("data-mce-style", i) } at(t.attributes, function (t, r) { U.setAttrib(e, r, A(t, n)) }), at(t.classes, function (t) { t = A(t, n), U.hasClass(e, t) || U.addClass(e, t) }) } } function o() { function t(t, n) { var i = new e(n); for (r = i.current(); r; r = i.prev()) if (r.childNodes.length > 1 || r == t || "BR" == r.tagName) return r } var n = a.selection.getRng(), i = n.startContainer, o = n.endContainer; if (i != o && 0 === n.endOffset) { var s = t(i, o), l = 3 == s.nodeType ? s.length : s.childNodes.length; n.setEnd(s, l) } return n } function l(e, r, o) { var a = [], l, f, p = !0; l = d.inline || d.block, f = U.create(l), i(f), q.walk(e, function (e) { function r(e) { var g, v, y, b, x; return x = p, g = e.nodeName.toLowerCase(), v = e.parentNode.nodeName.toLowerCase(), 1 === e.nodeType && nt(e) && (x = p, p = "true" === nt(e), b = !0), S(g, "br") ? (h = 0, void (d.block && U.remove(e))) : d.wrapper && C(e, t, n) ? void (h = 0) : p && !b && d.block && !d.wrapper && s(g) && j(v, l) ? (e = U.rename(e, l), i(e), a.push(e), void (h = 0)) : d.selector && (at(u, function (t) { "collapsed" in t && t.collapsed !== m || U.is(e, t.selector) && !c(e) && (i(e, t), y = !0) }), !d.inline || y) ? void (h = 0) : void (!p || b || !j(l, g) || !j(v, l) || !o && 3 === e.nodeType && 1 === e.nodeValue.length && 65279 === e.nodeValue.charCodeAt(0) || c(e) || d.inline && Y(e) ? (h = 0, at(st(e.childNodes), r), b && (p = x), h = 0) : (h || (h = U.clone(f, Q), e.parentNode.insertBefore(h, e), a.push(h)), h.appendChild(e))) } var h; at(e, r) }), d.links === !0 && at(a, function (e) { function t(e) { "A" === e.nodeName && i(e, d), at(st(e.childNodes), t) } t(e) }), at(a, function (e) { function r(e) { var t = 0; return at(e.childNodes, function (e) { B(e) || ot(e) || t++ }), t } function o(e) { var t, n; return at(e.childNodes, function (e) { return 1 != e.nodeType || ot(e) || c(e) ? void 0 : (t = e, Q) }), t && !ot(t) && k(t, d) && (n = U.clone(t, Q), i(n), U.replace(n, e, Z), U.remove(t, 1)), n || e } var s; if (s = r(e), (a.length > 1 || !Y(e)) && 0 === s) return void U.remove(e, 1); if (d.inline || d.wrapper) { if (d.exact || 1 !== s || (e = o(e)), at(u, function (t) { at(U.select(t.inline, e), function (e) { ot(e) || M(t, n, e, t.exact ? e : null) }) }), C(e.parentNode, t, n)) return U.remove(e, 1), e = 0, Z; d.merge_with_parents && U.getParent(e.parentNode, function (r) { return C(r, t, n) ? (U.remove(e, 1), e = 0, Z) : void 0 }), e && d.merge_siblings !== !1 && (e = I(O(e), e), e = I(e, O(e, Z))) } }) } var u = f(t), d = u[0], p, h, m = !r && $.isCollapsed(); if (d) if (r) r.nodeType ? (h = U.createRng(), h.setStartBefore(r), h.setEndAfter(r), l(L(h, u), null, !0)) : l(r, null, !0); else if (m && d.inline && !U.select("td.mce-item-selected,th.mce-item-selected").length) z("apply", t, n); else { var y = a.selection.getNode(); K || !u[0].defaultBlock || U.getParent(y, U.isBlock) || v(u[0].defaultBlock), a.selection.setRng(o()), p = $.getBookmark(), l(L($.getRng(Z), u), p), d.styles && (d.styles.color || d.styles.textDecoration) && (lt(y, g, "childNodes"), g(y)), $.moveToBookmark(p), W($.getRng(Z)), a.nodeChanged() } } function y(e, t, n, r) { function i(e) { var n, r, o, a, s; if (1 === e.nodeType && nt(e) && (a = y, y = "true" === nt(e), s = !0), n = st(e.childNodes), y && !s) for (r = 0, o = p.length; o > r && !M(p[r], t, e, e); r++); if (h.deep && n.length) { for (r = 0, o = n.length; o > r; r++) i(n[r]); s && (y = a) } } function o(n) { var i; return at(l(n.parentNode).reverse(), function (n) { var o; i || "_start" == n.id || "_end" == n.id || (o = C(n, e, t, r), o && o.split !== !1 && (i = n)) }), i } function s(e, n, r, i) { var o, a, s, l, c, u; if (e) { for (u = e.parentNode, o = n.parentNode; o && o != u; o = o.parentNode) { for (a = U.clone(o, Q), c = 0; c < p.length; c++) if (M(p[c], t, a, a)) { a = 0; break } a && (s && a.appendChild(s), l || (l = a), s = a) } !i || h.mixed && Y(e) || (n = U.split(e, n)), s && (r.parentNode.insertBefore(s, r), l.appendChild(r)) } return n } function c(e) { return s(o(e), e, e, !0) } function u(e) { var t = U.get(e ? "_start" : "_end"), n = t[e ? "firstChild" : "lastChild"]; return ot(n) && (n = n[e ? "firstChild" : "lastChild"]), U.remove(t, !0), n } function d(e) { var t, n, r = e.commonAncestorContainer; e = L(e, p, Z), h.split && (t = F(e, Z), n = F(e), t != n ? (/^(TR|TH|TD)$/.test(t.nodeName) && t.firstChild && (t = "TR" == t.nodeName ? t.firstChild.firstChild || t : t.firstChild || t), r && /^T(HEAD|BODY|FOOT|R)$/.test(r.nodeName) && /^(TH|TD)$/.test(n.nodeName) && n.firstChild && (n = n.firstChild || n), t = D(t, "span", { id: "_start", "data-mce-type": "bookmark" }), n = D(n, "span", { id: "_end", "data-mce-type": "bookmark" }), c(t), c(n), t = u(Z), n = u()) : t = n = c(t), e.startContainer = t.parentNode, e.startOffset = G(t), e.endContainer = n.parentNode, e.endOffset = G(n) + 1), q.walk(e, function (e) { at(e, function (e) { i(e), 1 === e.nodeType && "underline" === a.dom.getStyle(e, "text-decoration") && e.parentNode && "underline" === m(e.parentNode) && M({ deep: !1, exact: !0, inline: "span", styles: { textDecoration: "underline"} }, null, e) }) }) } var p = f(e), h = p[0], g, v, y = !0; return n ? void (n.nodeType ? (v = U.createRng(), v.setStartBefore(n), v.setEndAfter(n), d(v)) : d(n)) : void ($.isCollapsed() && h.inline && !U.select("td.mce-item-selected,th.mce-item-selected").length ? z("remove", e, t, r) : (g = $.getBookmark(), d($.getRng(Z)), $.moveToBookmark(g), h.inline && x(e, t, $.getStart()) && W($.getRng(!0)), a.nodeChanged())) } function b(e, t, n) { var r = f(e); !x(e, t, n) || "toggle" in r[0] && !r[0].toggle ? v(e, t, n) : y(e, t, n) } function C(e, t, n, r) { function i(e, t, i) { var o, a, s = t[i], l; if (t.onmatch) return t.onmatch(e, t, i); if (s) if (s.length === tt) { for (o in s) if (s.hasOwnProperty(o)) { if (a = "attributes" === i ? U.getAttrib(e, o) : T(e, o), r && !a && !t.exact) return; if ((!r || t.exact) && !S(a, R(A(s[o], n), o))) return } } else for (l = 0; l < s.length; l++) if ("attributes" === i ? U.getAttrib(e, s[l]) : T(e, s[l])) return t; return t } var o = f(t), a, s, l; if (o && e) for (s = 0; s < o.length; s++) if (a = o[s], k(e, a) && i(e, a, "attributes") && i(e, a, "styles")) { if (l = a.classes) for (s = 0; s < l.length; s++) if (!U.hasClass(e, l[s])) return; return a } } function x(e, t, n) { function r(n) { var r = U.getRoot(); return n === r ? !1 : (n = U.getParent(n, function (n) { return n.parentNode === r || !!C(n, e, t, !0) }), C(n, e, t)) } var i; return n ? r(n) : (n = $.getNode(), r(n) ? Z : (i = $.getStart(), i != n && r(i) ? Z : Q)) } function w(e, t) { var n, r = [], i = {}; return n = $.getStart(), U.getParent(n, function (n) { var o, a; for (o = 0; o < e.length; o++) a = e[o], !i[a] && C(n, a, t) && (i[a] = !0, r.push(a)) }, U.getRoot()), r } function _(e) { var t = f(e), n, r, i, o, a; if (t) for (n = $.getStart(), r = l(n), o = t.length - 1; o >= 0; o--) { if (a = t[o].selector, !a || t[o].defaultBlock) return Z; for (i = r.length - 1; i >= 0; i--) if (U.is(r[i], a)) return Z } return Q } function E(e, t, n) { var r; return et || (et = {}, r = {}, a.on("NodeChange", function (e) { var t = l(e.element), n = {}; t = i.grep(t, function (e) { return 1 == e.nodeType && !e.getAttribute("data-mce-bogus") }), at(et, function (e, i) { at(t, function (o) { return C(o, i, {}, e.similar) ? (r[i] || (at(e, function (e) { e(!0, { node: o, format: i, parents: t }) }), r[i] = e), n[i] = e, !1) : void 0 }) }), at(r, function (i, o) { n[o] || (delete r[o], at(i, function (n) { n(!1, { node: e.element, format: o, parents: t }) })) }) })), at(e.split(","), function (e) { et[e] || (et[e] = [], et[e].similar = n), et[e].push(t) }), this } function N(e) { return o.getCssText(a, e) } function k(e, t) { return S(e, t.inline) ? Z : S(e, t.block) ? Z : t.selector ? 1 == e.nodeType && U.is(e, t.selector) : void 0 } function S(e, t) { return e = e || "", t = t || "", e = "" + (e.nodeName || e), t = "" + (t.nodeName || t), e.toLowerCase() == t.toLowerCase() } function T(e, t) { return R(U.getStyle(e, t), t) } function R(e, t) { return ("color" == t || "backgroundColor" == t) && (e = U.toHex(e)), "fontWeight" == t && 700 == e && (e = "bold"), "fontFamily" == t && (e = e.replace(/[\'\"]/g, "").replace(/,\s+/g, ",")), "" + e } function A(e, t) { return "string" != typeof e ? e = e(t) : t && (e = e.replace(/%(\w+)/g, function (e, n) { return t[n] || e })), e } function B(e) { return e && 3 === e.nodeType && /^([\t \r\n]+|)$/.test(e.nodeValue) } function D(e, t, n) { var r = U.create(t, n); return e.parentNode.insertBefore(r, e), r.appendChild(e), r } function L(t, n, r) { function i(e) { function t(e) { return "BR" == e.nodeName && e.getAttribute("data-mce-bogus") && !e.nextSibling } var r, i, o, a, s; if (r = i = e ? g : y, a = e ? "previousSibling" : "nextSibling", s = U.getRoot(), 3 == r.nodeType && !B(r) && (e ? v > 0 : b < r.nodeValue.length)) return r; for (; ; ) { if (!n[0].block_expand && Y(i)) return i; for (o = i[a]; o; o = o[a]) if (!ot(o) && !B(o) && !t(o)) return i; if (i.parentNode == s) { r = i; break } i = i.parentNode } return r } function o(e, t) { for (t === tt && (t = 3 === e.nodeType ? e.length : e.childNodes.length); e && e.hasChildNodes(); ) e = e.childNodes[t], e && (t = 3 === e.nodeType ? e.length : e.childNodes.length); return { node: e, offset: t} } function c(e) { for (var t = e; t; ) { if (1 === t.nodeType && nt(t)) return "false" === nt(t) ? t : e; t = t.parentNode } return e } function u(t, n, i) { function o(e, t) { var n, o, a = e.nodeValue; return "undefined" == typeof t && (t = i ? a.length : 0), i ? (n = a.lastIndexOf(" ", t), o = a.lastIndexOf("\xa0", t), n = n > o ? n : o, -1 === n || r || n++) : (n = a.indexOf(" ", t), o = a.indexOf("\xa0", t), n = -1 !== n && (-1 === o || o > n) ? n : o), n } var s, l, c, u; if (3 === t.nodeType) { if (c = o(t, n), -1 !== c) return { container: t, offset: c }; u = t } for (s = new e(t, U.getParent(t, Y) || a.getBody()); l = s[i ? "prev" : "next"](); ) if (3 === l.nodeType) { if (u = l, c = o(l), -1 !== c) return { container: l, offset: c} } else if (Y(l)) break; return u ? (n = i ? 0 : u.length, { container: u, offset: n }) : void 0 } function d(e, r) { var i, o, a, s; for (3 == e.nodeType && 0 === e.nodeValue.length && e[r] && (e = e[r]), i = l(e), o = 0; o < i.length; o++) for (a = 0; a < n.length; a++) if (s = n[a], !("collapsed" in s && s.collapsed !== t.collapsed) && U.is(i[o], s.selector)) return i[o]; return e } function f(e, t) { var r, i = U.getRoot(); if (n[0].wrapper || (r = U.getParent(e, n[0].block, i)), r || (r = U.getParent(3 == e.nodeType ? e.parentNode : e, function (e) { return e != i && s(e) })), r && n[0].wrapper && (r = l(r, "ul,ol").reverse()[0] || r), !r) for (r = e; r[t] && !Y(r[t]) && (r = r[t], !S(r, "br")); ); return r || e } var p, h, m, g = t.startContainer, v = t.startOffset, y = t.endContainer, b = t.endOffset; if (1 == g.nodeType && g.hasChildNodes() && (p = g.childNodes.length - 1, g = g.childNodes[v > p ? p : v], 3 == g.nodeType && (v = 0)), 1 == y.nodeType && y.hasChildNodes() && (p = y.childNodes.length - 1, y = y.childNodes[b > p ? p : b - 1], 3 == y.nodeType && (b = y.nodeValue.length)), g = c(g), y = c(y), (ot(g.parentNode) || ot(g)) && (g = ot(g) ? g : g.parentNode, g = g.nextSibling || g, 3 == g.nodeType && (v = 0)), (ot(y.parentNode) || ot(y)) && (y = ot(y) ? y : y.parentNode, y = y.previousSibling || y, 3 == y.nodeType && (b = y.length)), n[0].inline && (t.collapsed && (m = u(g, v, !0), m && (g = m.container, v = m.offset), m = u(y, b), m && (y = m.container, b = m.offset)), h = o(y, b), h.node)) { for (; h.node && 0 === h.offset && h.node.previousSibling; ) h = o(h.node.previousSibling); h.node && h.offset > 0 && 3 === h.node.nodeType && " " === h.node.nodeValue.charAt(h.offset - 1) && h.offset > 1 && (y = h.node, y.splitText(h.offset - 1)) } return (n[0].inline || n[0].block_expand) && (n[0].inline && 3 == g.nodeType && 0 !== v || (g = i(!0)), n[0].inline && 3 == y.nodeType && b !== y.nodeValue.length || (y = i())), n[0].selector && n[0].expand !== Q && !n[0].inline && (g = d(g, "previousSibling"), y = d(y, "nextSibling")), (n[0].block || n[0].selector) && (g = f(g, "previousSibling"), y = f(y, "nextSibling"), n[0].block && (Y(g) || (g = i(!0)), Y(y) || (y = i()))), 1 == g.nodeType && (v = G(g), g = g.parentNode), 1 == y.nodeType && (b = G(y) + 1, y = y.parentNode), { startContainer: g, startOffset: v, endContainer: y, endOffset: b} } function H(e, t) { return t.links && "A" == e.tagName } function M(e, t, n, r) { var i, o, a; if (!k(n, e) && !H(n, e)) return Q; if ("all" != e.remove) for (at(e.styles, function (i, o) { i = R(A(i, t), o), "number" == typeof o && (o = i, r = 0), (e.remove_similar || !r || S(T(r, o), i)) && U.setStyle(n, o, ""), a = 1 }), a && "" === U.getAttrib(n, "style") && (n.removeAttribute("style"), n.removeAttribute("data-mce-style")), at(e.attributes, function (e, i) { var o; if (e = A(e, t), "number" == typeof i && (i = e, r = 0), !r || S(U.getAttrib(r, i), e)) { if ("class" == i && (e = U.getAttrib(n, i), e && (o = "", at(e.split(/\s+/), function (e) { /mce\w+/.test(e) && (o += (o ? " " : "") + e) }), o))) return void U.setAttrib(n, i, o); "class" == i && n.removeAttribute("className"), J.test(i) && n.removeAttribute("data-mce-" + i), n.removeAttribute(i) } }), at(e.classes, function (e) { e = A(e, t), (!r || U.hasClass(r, e)) && U.removeClass(n, e) }), o = U.getAttribs(n), i = 0; i < o.length; i++) if (0 !== o[i].nodeName.indexOf("_")) return Q; return "none" != e.remove ? (P(n, e), Z) : void 0 } function P(e, t) { function n(e, t, n) { return e = O(e, t, n), !e || "BR" == e.nodeName || Y(e) } var r = e.parentNode, i; t.block && (K ? r == U.getRoot() && (t.list_block && S(e, t.list_block) || at(st(e.childNodes), function (e) { j(K, e.nodeName.toLowerCase()) ? i ? i.appendChild(e) : (i = D(e, K), U.setAttribs(i, a.settings.forced_root_block_attrs)) : i = 0 })) : Y(e) && !Y(r) && (n(e, Q) || n(e.firstChild, Z, 1) || e.insertBefore(U.create("br"), e.firstChild), n(e, Z) || n(e.lastChild, Q, 1) || e.appendChild(U.create("br")))), t.selector && t.inline && !S(t.inline, e) || U.remove(e, 1) } function O(e, t, n) { if (e) for (t = t ? "nextSibling" : "previousSibling", e = n ? e : e[t]; e; e = e[t]) if (1 == e.nodeType || !B(e)) return e } function I(e, t) { function n(e, t) { for (i = e; i; i = i[t]) { if (3 == i.nodeType && 0 !== i.nodeValue.length) return e; if (1 == i.nodeType && !ot(i)) return i } return e } var i, o, a = new r(U); if (e && t && (e = n(e, "previousSibling"), t = n(t, "nextSibling"), a.compare(e, t))) { for (i = e.nextSibling; i && i != t; ) o = i, i = i.nextSibling, e.appendChild(o); return U.remove(t), at(st(t.childNodes), function (t) { e.appendChild(t) }), e } return t } function F(t, n) { var r, i, o; return r = t[n ? "startContainer" : "endContainer"], i = t[n ? "startOffset" : "endOffset"], 1 == r.nodeType && (o = r.childNodes.length - 1, !n && i && i--, r = r.childNodes[i > o ? o : i]), 3 === r.nodeType && n && i >= r.nodeValue.length && (r = new e(r, a.getBody()).next() || r), 3 !== r.nodeType || n || 0 !== i || (r = new e(r, a.getBody()).prev() || r), r } function z(t, n, r, i) { function o(e) { var t = U.create("span", { id: g, "data-mce-bogus": !0, style: b ? "color:red" : "" }); return e && t.appendChild(a.getDoc().createTextNode(X)), t } function l(e, t) { for (; e; ) { if (3 === e.nodeType && e.nodeValue !== X || e.childNodes.length > 1) return !1; t && 1 === e.nodeType && t.push(e), e = e.firstChild } return !0 } function c(e) { for (; e; ) { if (e.id === g) return e; e = e.parentNode } } function u(t) { var n; if (t) for (n = new e(t, t), t = n.current(); t; t = n.next()) if (3 === t.nodeType) return t } function d(e, t) { var n, r; if (e) r = $.getRng(!0), l(e) ? (t !== !1 && (r.setStartBefore(e), r.setEndBefore(e)), U.remove(e)) : (n = u(e), n.nodeValue.charAt(0) === X && (n.deleteData(0, 1), r.startContainer == n && r.startOffset > 0 && r.setStart(n, r.startOffset - 1), r.endContainer == n && r.endOffset > 0 && r.setEnd(n, r.endOffset - 1)), U.remove(e, 1)), $.setRng(r); else if (e = c($.getStart()), !e) for (; e = U.get(g); ) d(e, !1) } function p() { var e, t, i, a, s, l, d; e = $.getRng(!0), a = e.startOffset, l = e.startContainer, d = l.nodeValue, t = c($.getStart()), t && (i = u(t)), d && a > 0 && a < d.length && /\w/.test(d.charAt(a)) && /\w/.test(d.charAt(a - 1)) ? (s = $.getBookmark(), e.collapse(!0), e = L(e, f(n)), e = q.split(e), v(n, r, e), $.moveToBookmark(s)) : (t && i.nodeValue === X ? v(n, r, t) : (t = o(!0), i = t.firstChild, e.insertNode(t), a = 1, v(n, r, t)), $.setCursorLocation(i, a)) } function h() { var e = $.getRng(!0), t, a, l, c, u, d, p = [], h, m; for (t = e.startContainer, a = e.startOffset, u = t, 3 == t.nodeType && (a != t.nodeValue.length && (c = !0), u = u.parentNode); u; ) { if (C(u, n, r, i)) { d = u; break } u.nextSibling && (c = !0), p.push(u), u = u.parentNode } if (d) if (c) l = $.getBookmark(), e.collapse(!0), e = L(e, f(n), !0), e = q.split(e), y(n, r, e), $.moveToBookmark(l); else { for (m = o(), u = m, h = p.length - 1; h >= 0; h--) u.appendChild(U.clone(p[h], !1)), u = u.firstChild; u.appendChild(U.doc.createTextNode(X)), u = u.firstChild; var g = U.getParent(d, s); g && U.isEmpty(g) ? d.parentNode.replaceChild(m, d) : U.insertAfter(m, d), $.setCursorLocation(u, 1), U.isEmpty(d) && U.remove(d) } } function m() { var e; e = c($.getStart()), e && !U.isEmpty(e) && lt(e, function (e) { 1 != e.nodeType || e.id === g || U.isEmpty(e) || U.setAttrib(e, "data-mce-bogus", null) }, "childNodes") } var g = "_mce_caret", b = a.settings.caret_debug; a._hasCaretEvents || (it = function () { var e = [], t; if (l(c($.getStart()), e)) for (t = e.length; t--; ) U.setAttrib(e[t], "data-mce-bogus", "1") }, rt = function (e) { var t = e.keyCode; d(), (8 == t || 37 == t || 39 == t) && d(c($.getStart())), m() }, a.on("SetContent", function (e) { e.selection && m() }), a._hasCaretEvents = !0), "apply" == t ? p() : h() } function W(t) { var n = t.startContainer, r = t.startOffset, i, o, a, s, l; if (3 == n.nodeType && r >= n.nodeValue.length && (r = G(n), n = n.parentNode, i = !0), 1 == n.nodeType) for (s = n.childNodes, n = s[Math.min(r, s.length - 1)], o = new e(n, U.getParent(n, U.isBlock)), (r > s.length - 1 || i) && o.next(), a = o.current(); a; a = o.next()) if (3 == a.nodeType && !B(a)) return l = U.create("a", { "data-mce-bogus": "all" }, X), a.parentNode.insertBefore(l, a), t.setStart(a, 0), $.setRng(t), void U.remove(l) } var V = {}, U = a.dom, $ = a.selection, q = new t(U), j = a.schema.isValidChild, Y = U.isBlock, K = a.settings.forced_root_block, G = U.nodeIndex, X = "\ufeff", J = /^(src|href|style)$/, Q = !1, Z = !0, et, tt, nt = U.getContentEditable, rt, it, ot = n.isBookmarkNode, at = i.each, st = i.grep, lt = i.walk, ct = i.extend; ct(this, { get: f, register: p, unregister: h, apply: v, remove: y, toggle: b, match: x, matchAll: w, matchNode: C, canApply: _, formatChanged: E, getCssText: N }), u(), d(), a.on("BeforeGetContent", function (e) { it && "raw" != e.format && it() }), a.on("mouseup keydown", function (e) { rt && rt(e) }) } }), r(I, [d, u, N], function (e, t, n) { var r = t.trim, i; return i = new RegExp(["<span[^>]+data-mce-bogus[^>]+>[\u200b\ufeff]+<\\/span>", '\\s?data-mce-selected="[^"]+"'].join("|"), "gi"), function (t) { function o() { var e = t.getContent({ format: "raw", no_events: 1 }), o = /<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g, a, s, l, c, u, d = t.schema; for (e = e.replace(i, ""), u = d.getShortEndedElements(); c = o.exec(e); ) s = o.lastIndex, l = c[0].length, a = u[c[1]] ? s : n.findEndTag(d, e, s), e = e.substring(0, s - l) + e.substring(a), o.lastIndex = s - l; return r(e) } function a(e) { s.typing = !1, s.add({}, e) } var s = this, l = 0, c = [], u, d, f = 0; return t.on("init", function () { s.add() }), t.on("BeforeExecCommand", function (e) { var t = e.command; "Undo" != t && "Redo" != t && "mceRepaint" != t && s.beforeChange() }), t.on("ExecCommand", function (e) { var t = e.command; "Undo" != t && "Redo" != t && "mceRepaint" != t && a(e) }), t.on("ObjectResizeStart", function () { s.beforeChange() }), t.on("SaveContent ObjectResized blur", a), t.on("DragEnd", a), t.on("KeyUp", function (n) { var r = n.keyCode; (r >= 33 && 36 >= r || r >= 37 && 40 >= r || 45 == r || 13 == r || n.ctrlKey) && (a(), t.nodeChanged()), (46 == r || 8 == r || e.mac && (91 == r || 93 == r)) && t.nodeChanged(), d && s.typing && (t.isDirty() || (t.isNotDirty = !c[0] || o() == c[0].content, t.isNotDirty || t.fire("change", { level: c[0], lastLevel: null })), t.fire("TypingUndo"), d = !1, t.nodeChanged()) }), t.on("KeyDown", function (e) { var t = e.keyCode; return t >= 33 && 36 >= t || t >= 37 && 40 >= t || 45 == t ? void (s.typing && a(e)) : void ((16 > t || t > 20) && 224 != t && 91 != t && !s.typing && (s.beforeChange(), s.typing = !0, s.add({}, e), d = !0)) }), t.on("MouseDown", function (e) { s.typing && a(e) }), t.addShortcut("ctrl+z", "", "Undo"), t.addShortcut("ctrl+y,ctrl+shift+z", "", "Redo"), t.on("AddUndo Undo Redo ClearUndos", function (e) { e.isDefaultPrevented() || t.nodeChanged() }), s = { data: c, typing: !1, beforeChange: function () { f || (u = t.selection.getBookmark(2, !0)) }, add: function (e, n) { var r, i = t.settings, a; if (e = e || {}, e.content = o(), f || t.removed) return null; if (a = c[l], t.fire("BeforeAddUndo", { level: e, lastLevel: a, originalEvent: n }).isDefaultPrevented()) return null; if (a && a.content == e.content) return null; if (c[l] && (c[l].beforeBookmark = u), i.custom_undo_redo_levels && c.length > i.custom_undo_redo_levels) { for (r = 0; r < c.length - 1; r++) c[r] = c[r + 1]; c.length--, l = c.length } e.bookmark = t.selection.getBookmark(2, !0), l < c.length - 1 && (c.length = l + 1), c.push(e), l = c.length - 1; var s = { level: e, lastLevel: a, originalEvent: n }; return t.fire("AddUndo", s), l > 0 && (t.isNotDirty = !1, t.fire("change", s)), e }, undo: function () { var e; return s.typing && (s.add(), s.typing = !1), l > 0 && (e = c[--l], 0 === l && (t.isNotDirty = !0), t.setContent(e.content, { format: "raw" }), t.selection.moveToBookmark(e.beforeBookmark), t.fire("undo", { level: e })), e }, redo: function () { var e; return l < c.length - 1 && (e = c[++l], t.setContent(e.content, { format: "raw" }), t.selection.moveToBookmark(e.bookmark), t.fire("redo", { level: e })), e }, clear: function () { c = [], l = 0, s.typing = !1, t.fire("ClearUndos") }, hasUndo: function () { return l > 0 || s.typing && c[0] && o() != c[0].content }, hasRedo: function () { return l < c.length - 1 && !this.typing }, transact: function (e) { s.beforeChange(); try { f++, e() } finally { f-- } s.add() } } } }), r(F, [h, x, d], function (e, t, n) { var r = n.ie && n.ie < 11; return function (i) { function o(o) { function f(e) { return e && a.isBlock(e) && !/^(TD|TH|CAPTION|FORM)$/.test(e.nodeName) && !/^(fixed|absolute)/i.test(e.style.position) && "true" !== a.getContentEditable(e) } function p(e) { var t; a.isBlock(e) && (t = s.getRng(), e.appendChild(a.create("span", null, "\xa0")), s.select(e), e.lastChild.outerHTML = "", s.setRng(t)) } function h(e) { var t = e, n = [], r; if (t) { for (; t = t.firstChild; ) { if (a.isBlock(t)) return; 1 != t.nodeType || d[t.nodeName.toLowerCase()] || n.push(t) } for (r = n.length; r--; ) t = n[r], !t.hasChildNodes() || t.firstChild == t.lastChild && "" === t.firstChild.nodeValue ? a.remove(t) : "A" == t.nodeName && " " === (t.innerText || t.textContent) && a.remove(t) } } function m(t) { function r(e) { for (; e; ) { if (1 == e.nodeType || 3 == e.nodeType && e.data && /[\r\n\s]/.test(e.data)) return e; e = e.nextSibling } } var i, o, l, c = t, u; if (t) { if (n.ie && n.ie < 9 && A && A.firstChild && A.firstChild == A.lastChild && "BR" == A.firstChild.tagName && a.remove(A.firstChild), /^(LI|DT|DD)$/.test(t.nodeName)) { var f = r(t.firstChild); f && /^(UL|OL|DL)$/.test(f.nodeName) && t.insertBefore(a.doc.createTextNode("\xa0"), t.firstChild) } if (l = a.createRng(), n.ie || t.normalize(), t.hasChildNodes()) { for (i = new e(t, t); o = i.current(); ) { if (3 == o.nodeType) { l.setStart(o, 0), l.setEnd(o, 0); break } if (d[o.nodeName.toLowerCase()]) { l.setStartBefore(o), l.setEndBefore(o); break } c = o, o = i.next() } o || (l.setStart(c, 0), l.setEnd(c, 0)) } else "BR" == t.nodeName ? t.nextSibling && a.isBlock(t.nextSibling) ? ((!B || 9 > B) && (u = a.create("br"), t.parentNode.insertBefore(u, t)), l.setStartBefore(t), l.setEndBefore(t)) : (l.setStartAfter(t), l.setEndAfter(t)) : (l.setStart(t, 0), l.setEnd(t, 0)); s.setRng(l), a.remove(u), s.scrollIntoView(t) } } function g(e) { var t = l.forced_root_block; t && t.toLowerCase() === e.tagName.toLowerCase() && a.setAttribs(e, l.forced_root_block_attrs) } function v(e) { var t = T, n, i, o, s = u.getTextInlineElements(); if (e || "TABLE" == P ? (n = a.create(e || I), g(n)) : n = A.cloneNode(!1), o = n, l.keep_styles !== !1) do if (s[t.nodeName]) { if ("_mce_caret" == t.id) continue; i = t.cloneNode(!1), a.setAttrib(i, "id", ""), n.hasChildNodes() ? (i.appendChild(n.firstChild), n.appendChild(i)) : (o = i, n.appendChild(i)) } while (t = t.parentNode); return r || (o.innerHTML = '<br data-mce-bogus="1">'), n } function y(t) { var n, r, i; if (3 == T.nodeType && (t ? R > 0 : R < T.nodeValue.length)) return !1; if (T.parentNode == A && F && !t) return !0; if (t && 1 == T.nodeType && T == A.firstChild) return !0; if ("TABLE" === T.nodeName || T.previousSibling && "TABLE" == T.previousSibling.nodeName) return F && !t || !F && t; for (n = new e(T, A), 3 == T.nodeType && (t && 0 === R ? n.prev() : t || R != T.nodeValue.length || n.next()); r = n.current(); ) { if (1 === r.nodeType) { if (!r.getAttribute("data-mce-bogus") && (i = r.nodeName.toLowerCase(), d[i] && "br" !== i)) return !1 } else if (3 === r.nodeType && !/^[ \t\r\n]*$/.test(r.nodeValue)) return !1; t ? n.prev() : n.next() } return !0 } function b(e, t) { var n, r, o, s, l, c, d = I || "P"; if (r = a.getParent(e, a.isBlock), c = i.getBody().nodeName.toLowerCase(), !r || !f(r)) { if (r = r || S, !r.hasChildNodes()) return n = a.create(d), g(n), r.appendChild(n), N.setStart(n, 0), N.setEnd(n, 0), n; for (s = e; s.parentNode != r; ) s = s.parentNode; for (; s && !a.isBlock(s); ) o = s, s = s.previousSibling; if (o && u.isValidChild(c, d.toLowerCase())) { for (n = a.create(d), g(n), o.parentNode.insertBefore(n, o), s = o; s && !a.isBlock(s); ) l = s.nextSibling, n.appendChild(s), s = l; N.setStart(e, t), N.setEnd(e, t) } } return e } function C() { function e(e) { for (var t = M[e ? "firstChild" : "lastChild"]; t && 1 != t.nodeType; ) t = t[e ? "nextSibling" : "previousSibling"]; return t === A } function t() { var e = M.parentNode; return /^(LI|DT|DD)$/.test(e.nodeName) ? e : M } var n = M.parentNode.nodeName; /^(OL|UL|LI)$/.test(n) && (I = "LI"), L = I ? v(I) : a.create("BR"), e(!0) && e() ? "LI" == n ? a.insertAfter(L, t()) : a.replace(L, M) : e(!0) ? "LI" == n ? (a.insertAfter(L, t()), L.appendChild(a.doc.createTextNode(" ")), L.appendChild(M)) : M.parentNode.insertBefore(L, M) : e() ? (a.insertAfter(L, t()), p(L)) : (M = t(), k = N.cloneRange(), k.setStartAfter(A), k.setEndAfter(M), H = k.extractContents(), "LI" == I && "LI" == H.firstChild.nodeName ? (L = H.firstChild, a.insertAfter(H, M)) : (a.insertAfter(H, M), a.insertAfter(L, M))), a.remove(A), m(L), c.add() } function x() { i.execCommand("InsertLineBreak", !1, o) } function w(e) { do 3 === e.nodeType && (e.nodeValue = e.nodeValue.replace(/^[\r\n]+/, "")), e = e.firstChild; while (e) } function _(e) { var t = a.getRoot(), n, r; for (n = e; n !== t && "false" !== a.getContentEditable(n); ) "true" === a.getContentEditable(n) && (r = n), n = n.parentNode; return n !== t ? r : t } function E(e) { var t; r || (e.normalize(), t = e.lastChild, (!t || /^(left|right)$/gi.test(a.getStyle(t, "float", !0))) && a.add(e, "br")) } var N, k, S, T, R, A, B, D, L, H, M, P, O, I, F; if (N = s.getRng(!0), !o.isDefaultPrevented()) { if (!N.collapsed) return void i.execCommand("Delete"); if (new t(a).normalize(N), T = N.startContainer, R = N.startOffset, I = (l.force_p_newlines ? "p" : "") || l.forced_root_block, I = I ? I.toUpperCase() : "", B = a.doc.documentMode, D = o.shiftKey, 1 == T.nodeType && T.hasChildNodes() && (F = R > T.childNodes.length - 1, T = T.childNodes[Math.min(R, T.childNodes.length - 1)] || T, R = F && 3 == T.nodeType ? T.nodeValue.length : 0), S = _(T)) { if (c.beforeChange(), !a.isBlock(S) && S != a.getRoot()) return void ((!I || D) && x()); if ((I && !D || !I && D) && (T = b(T, R)), A = a.getParent(T, a.isBlock), M = A ? a.getParent(A.parentNode, a.isBlock) : null, P = A ? A.nodeName.toUpperCase() : "", O = M ? M.nodeName.toUpperCase() : "", "LI" != O || o.ctrlKey || (A = M, P = O), /^(LI|DT|DD)$/.test(P)) { if (!I && D) return void x(); if (a.isEmpty(A)) return void C() } if ("PRE" == P && l.br_in_pre !== !1) { if (!D) return void x() } else if (!I && !D && "LI" != P || I && D) return void x(); I && A === i.getBody() || (I = I || "P", y() ? (L = /^(H[1-6]|PRE|FIGURE)$/.test(P) && "HGROUP" != O ? v(I) : v(), l.end_container_on_empty_block && f(M) && a.isEmpty(A) ? L = a.split(M, A) : a.insertAfter(L, A), m(L)) : y(!0) ? (L = A.parentNode.insertBefore(v(), A), p(L), m(A)) : (k = N.cloneRange(), k.setEndAfter(A), H = k.extractContents(), w(H), L = H.firstChild, a.insertAfter(H, A), h(L), E(A), m(L)), a.setAttrib(L, "id", ""), i.fire("NewBlock", { newBlock: L }), c.add()) } } } var a = i.dom, s = i.selection, l = i.settings, c = i.undoManager, u = i.schema, d = u.getNonEmptyElements(); i.on("keydown", function (e) { 13 == e.keyCode && o(e) !== !1 && e.preventDefault() }) } }), r(z, [], function () { return function (e) { function t() { var t = i.getStart(), s = e.getBody(), l, c, u, d, f, p, h, m = -16777215, g, v, y, b, C; if (C = n.forced_root_block, t && 1 === t.nodeType && C) { for (; t && t != s; ) { if (a[t.nodeName]) return; t = t.parentNode } if (l = i.getRng(), l.setStart) { c = l.startContainer, u = l.startOffset, d = l.endContainer, f = l.endOffset; try { v = e.getDoc().activeElement === s } catch (x) { } } else l.item && (t = l.item(0), l = e.getDoc().body.createTextRange(), l.moveToElementText(t)), v = l.parentElement().ownerDocument === e.getDoc(), y = l.duplicate(), y.collapse(!0), u = -1 * y.move("character", m), y.collapsed || (y = l.duplicate(), y.collapse(!1), f = -1 * y.move("character", m) - u); for (t = s.firstChild, b = s.nodeName.toLowerCase(); t; ) if ((3 === t.nodeType || 1 == t.nodeType && !a[t.nodeName]) && o.isValidChild(b, C.toLowerCase())) { if (3 === t.nodeType && 0 === t.nodeValue.length) { h = t, t = t.nextSibling, r.remove(h); continue } p || (p = r.create(C, e.settings.forced_root_block_attrs), t.parentNode.insertBefore(p, t), g = !0), h = t, t = t.nextSibling, p.appendChild(h) } else p = null, t = t.nextSibling; if (g && v) { if (l.setStart) l.setStart(c, u), l.setEnd(d, f), i.setRng(l); else try { l = e.getDoc().body.createTextRange(), l.moveToElementText(s), l.collapse(!0), l.moveStart("character", u), f > 0 && l.moveEnd("character", f), l.select() } catch (x) { } e.nodeChanged() } } } var n = e.settings, r = e.dom, i = e.selection, o = e.schema, a = o.getBlockElements(); n.forced_root_block && e.on("NodeChange", t) } }), r(W, [T, d, u, M, x, h], function (e, n, r, i, o, a) { var s = r.each, l = r.extend, c = r.map, u = r.inArray, d = r.explode, f = n.gecko, p = n.ie, h = n.ie && n.ie < 11, m = !0, g = !1; return function (r) { function v(e, t, n) { var r; return e = e.toLowerCase(), (r = T.exec[e]) ? (r(e, t, n), m) : g } function y(e) { var t; return e = e.toLowerCase(), (t = T.state[e]) ? t(e) : -1 } function b(e) { var t; return e = e.toLowerCase(), (t = T.value[e]) ? t(e) : g } function C(e, t) { t = t || "exec", s(e, function (e, n) { s(n.toLowerCase().split(","), function (n) { T[t][n] = e }) }) } function x(e, n, i) { return n === t && (n = g), i === t && (i = null), r.getDoc().execCommand(e, n, i) } function w(e) { return A.match(e) } function _(e, n) { A.toggle(e, n ? { value: n} : t), r.nodeChanged() } function E(e) { B = S.getBookmark(e) } function N() { S.moveToBookmark(B) } var k = r.dom, S = r.selection, T = { state: {}, exec: {}, value: {} }, R = r.settings, A = r.formatter, B; l(this, { execCommand: v, queryCommandState: y, queryCommandValue: b, addCommands: C }), C({ "mceResetDesignMode,mceBeginUndoLevel": function () { }, "mceEndUndoLevel,mceAddUndoLevel": function () { r.undoManager.add() }, "Cut,Copy,Paste": function (e) { var t = r.getDoc(), i; try { x(e) } catch (o) { i = m } if (i || !t.queryCommandSupported(e)) { var a = r.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead."); n.mac && (a = a.replace(/Ctrl\+/g, "\u2318+")), r.windowManager.alert(a) } }, unlink: function () { if (S.isCollapsed()) { var e = S.getNode(); return void ("A" == e.tagName && r.dom.remove(e, !0)) } A.remove("link") }, "JustifyLeft,JustifyCenter,JustifyRight,JustifyFull": function (e) { var t = e.substring(7); "full" == t && (t = "justify"), s("left,center,right,justify".split(","), function (e) { t != e && A.remove("align" + e) }), _("align" + t), v("mceRepaint") }, "InsertUnorderedList,InsertOrderedList": function (e) { var t, n; x(e), t = k.getParent(S.getNode(), "ol,ul"), t && (n = t.parentNode, /^(H[1-6]|P|ADDRESS|PRE)$/.test(n.nodeName) && (E(), k.split(n, t), N())) }, "Bold,Italic,Underline,Strikethrough,Superscript,Subscript": function (e) { _(e) }, "ForeColor,HiliteColor,FontName": function (e, t, n) { _(e, n) }, FontSize: function (e, t, n) { var r, i; n >= 1 && 7 >= n && (i = d(R.font_size_style_values), r = d(R.font_size_classes), n = r ? r[n - 1] || n : i[n - 1] || n), _(e, n) }, RemoveFormat: function (e) { A.remove(e) }, mceBlockQuote: function () { _("blockquote") }, FormatBlock: function (e, t, n) { return _(n || "p") }, mceCleanup: function () { var e = S.getBookmark(); r.setContent(r.getContent({ cleanup: m }), { cleanup: m }), S.moveToBookmark(e) }, mceRemoveNode: function (e, t, n) { var i = n || S.getNode(); i != r.getBody() && (E(), r.dom.remove(i, m), N()) }, mceSelectNodeDepth: function (e, t, n) { var i = 0; k.getParent(S.getNode(), function (e) { return 1 == e.nodeType && i++ == n ? (S.select(e), g) : void 0 }, r.getBody()) }, mceSelectNode: function (e, t, n) { S.select(n) }, mceInsertContent: function (t, n, o) { function a(e) { function t(e) { return r[e] && 3 == r[e].nodeType } var n, r, i; return n = S.getRng(!0), r = n.startContainer, i = n.startOffset, 3 == r.nodeType && (i > 0 ? e = e.replace(/^&nbsp;/, " ") : t("previousSibling") || (e = e.replace(/^ /, "&nbsp;")), i < r.length ? e = e.replace(/&nbsp;(<br>|)$/, " ") : t("nextSibling") || (e = e.replace(/(&nbsp;| )(<br>|)$/, "&nbsp;"))), e } function l(e) { if (w) for (b = e.firstChild; b; b = b.walk(!0)) _[b.name] && b.attr("data-mce-new", "true") } function c() { if (w) { var e = r.getBody(), t = new i(k); s(k.select("*[data-mce-new]"), function (n) { n.removeAttribute("data-mce-new"); for (var r = n.parentNode; r && r != e; r = r.parentNode) t.compare(r, n) && k.remove(n, !0) }) } } var u, d, f, h, m, g, v, y, b, C, x, w, _ = r.schema.getTextInlineElements(); "string" != typeof o && (w = o.merge, o = o.content), /^ | $/.test(o) && (o = a(o)), u = r.parser, d = new e({}, r.schema), x = '<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>', g = { content: o, format: "html", selection: !0 }, r.fire("BeforeSetContent", g), o = g.content, -1 == o.indexOf("{$caret}") && (o += "{$caret}"), o = o.replace(/\{\$caret\}/, x), y = S.getRng(); var E = y.startContainer || (y.parentElement ? y.parentElement() : null), N = r.getBody(); E === N && S.isCollapsed() && k.isBlock(N.firstChild) && k.isEmpty(N.firstChild) && (y = k.createRng(), y.setStart(N.firstChild, 0), y.setEnd(N.firstChild, 0), S.setRng(y)), S.isCollapsed() || r.getDoc().execCommand("Delete", !1, null), f = S.getNode(); var T = { context: f.nodeName.toLowerCase() }; if (m = u.parse(o, T), l(m), b = m.lastChild, "mce_marker" == b.attr("id")) for (v = b, b = b.prev; b; b = b.walk(!0)) if (3 == b.type || !k.isBlock(b.name)) { r.schema.isValidChild(b.parent.name, "span") && b.parent.insert(v, b, "br" === b.name); break } if (T.invalid) { for (S.setContent(x), f = S.getNode(), h = r.getBody(), 9 == f.nodeType ? f = b = h : b = f; b !== h; ) f = b, b = b.parentNode; o = f == h ? h.innerHTML : k.getOuterHTML(f), o = d.serialize(u.parse(o.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i, function () { return d.serialize(m) }))), f == h ? k.setHTML(h, o) : k.setOuterHTML(f, o) } else o = d.serialize(m), b = f.firstChild, C = f.lastChild, !b || b === C && "BR" === b.nodeName ? k.setHTML(f, o) : S.setContent(o); c(), v = k.get("mce_marker"), S.scrollIntoView(v), y = k.createRng(), b = v.previousSibling, b && 3 == b.nodeType ? (y.setStart(b, b.nodeValue.length), p || (C = v.nextSibling, C && 3 == C.nodeType && (b.appendData(C.data), C.parentNode.removeChild(C)))) : (y.setStartBefore(v), y.setEndBefore(v)), k.remove(v), S.setRng(y), r.fire("SetContent", g), r.addVisual() }, mceInsertRawHTML: function (e, t, n) { S.setContent("tiny_mce_marker"), r.setContent(r.getContent().replace(/tiny_mce_marker/g, function () { return n })) }, mceToggleFormat: function (e, t, n) { _(n) }, mceSetContent: function (e, t, n) { r.setContent(n) }, "Indent,Outdent": function (e) { var t, n, i; t = R.indentation, n = /[a-z%]+$/i.exec(t), t = parseInt(t, 10), y("InsertUnorderedList") || y("InsertOrderedList") ? x(e) : (R.forced_root_block || k.getParent(S.getNode(), k.isBlock) || A.apply("div"), s(S.getSelectedBlocks(), function (o) { if ("LI" != o.nodeName) { var a = r.getParam("indent_use_margin", !1) ? "margin" : "padding"; a += "rtl" == k.getStyle(o, "direction", !0) ? "Right" : "Left", "outdent" == e ? (i = Math.max(0, parseInt(o.style[a] || 0, 10) - t), k.setStyle(o, a, i ? i + n : "")) : (i = parseInt(o.style[a] || 0, 10) + t + n, k.setStyle(o, a, i)) } })) }, mceRepaint: function () { if (f) try { E(m), S.getSel() && S.getSel().selectAllChildren(r.getBody()), S.collapse(m), N() } catch (e) { } }, InsertHorizontalRule: function () { r.execCommand("mceInsertContent", !1, "<hr />") }, mceToggleVisualAid: function () { r.hasVisual = !r.hasVisual, r.addVisual() }, mceReplaceContent: function (e, t, n) { r.execCommand("mceInsertContent", !1, n.replace(/\{\$selection\}/g, S.getContent({ format: "text" }))) }, mceInsertLink: function (e, t, n) { var r; "string" == typeof n && (n = { href: n }), r = k.getParent(S.getNode(), "a"), n.href = n.href.replace(" ", "%20"), r && n.href || A.remove("link"), n.href && A.apply("link", n, r) }, selectAll: function () { var e = k.getRoot(), t; S.getRng().setStart ? (t = k.createRng(), t.setStart(e, 0), t.setEnd(e, e.childNodes.length), S.setRng(t)) : (t = S.getRng(), t.item || (t.moveToElementText(e), t.select())) }, "delete": function () { x("Delete"); var e = r.getBody(); k.isEmpty(e) && (r.setContent(""), e.firstChild && k.isBlock(e.firstChild) ? r.selection.setCursorLocation(e.firstChild, 0) : r.selection.setCursorLocation(e, 0)) }, mceNewDocument: function () { r.setContent("") }, InsertLineBreak: function (e, t, n) { function i() { for (var e = new a(p, v), t, n = r.schema.getNonEmptyElements(); t = e.next(); ) if (n[t.nodeName.toLowerCase()] || t.length > 0) return !0 } var s = n, l, c, u, d = S.getRng(!0); new o(k).normalize(d); var f = d.startOffset, p = d.startContainer; if (1 == p.nodeType && p.hasChildNodes()) { var g = f > p.childNodes.length - 1; p = p.childNodes[Math.min(f, p.childNodes.length - 1)] || p, f = g && 3 == p.nodeType ? p.nodeValue.length : 0 } var v = k.getParent(p, k.isBlock), y = v ? v.nodeName.toUpperCase() : "", b = v ? k.getParent(v.parentNode, k.isBlock) : null, C = b ? b.nodeName.toUpperCase() : "", x = s && s.ctrlKey; "LI" != C || x || (v = b, y = C), p && 3 == p.nodeType && f >= p.nodeValue.length && (h || i() || (l = k.create("br"), d.insertNode(l), d.setStartAfter(l), d.setEndAfter(l), c = !0)), l = k.create("br"), d.insertNode(l); var w = k.doc.documentMode; return h && "PRE" == y && (!w || 8 > w) && l.parentNode.insertBefore(k.doc.createTextNode("\r"), l), u = k.create("span", {}, "&nbsp;"), l.parentNode.insertBefore(u, l), S.scrollIntoView(u), k.remove(u), c ? (d.setStartBefore(l), d.setEndBefore(l)) : (d.setStartAfter(l), d.setEndAfter(l)), S.setRng(d), r.undoManager.add(), m } }), C({ "JustifyLeft,JustifyCenter,JustifyRight,JustifyFull": function (e) { var t = "align" + e.substring(7), n = S.isCollapsed() ? [k.getParent(S.getNode(), k.isBlock)] : S.getSelectedBlocks(), r = c(n, function (e) { return !!A.matchNode(e, t) }); return -1 !== u(r, m) }, "Bold,Italic,Underline,Strikethrough,Superscript,Subscript": function (e) { return w(e) }, mceBlockQuote: function () { return w("blockquote") }, Outdent: function () { var e; if (R.inline_styles) { if ((e = k.getParent(S.getStart(), k.isBlock)) && parseInt(e.style.paddingLeft, 10) > 0) return m; if ((e = k.getParent(S.getEnd(), k.isBlock)) && parseInt(e.style.paddingLeft, 10) > 0) return m } return y("InsertUnorderedList") || y("InsertOrderedList") || !R.inline_styles && !!k.getParent(S.getNode(), "BLOCKQUOTE") }, "InsertUnorderedList,InsertOrderedList": function (e) { var t = k.getParent(S.getNode(), "ul,ol"); return t && ("insertunorderedlist" === e && "UL" === t.tagName || "insertorderedlist" === e && "OL" === t.tagName) } }, "state"), C({ "FontSize,FontName": function (e) { var t = 0, n; return (n = k.getParent(S.getNode(), "span")) && (t = "fontsize" == e ? n.style.fontSize : n.style.fontFamily.replace(/, /g, ",").replace(/[\'\"]/g, "").toLowerCase()), t } }, "value"), C({ Undo: function () { r.undoManager.undo() }, Redo: function () { r.undoManager.redo() } }) } }), r(V, [u], function (e) { function t(e, o) { var a = this, s, l; if (e = r(e), o = a.settings = o || {}, s = o.base_uri, /^([\w\-]+):([^\/]{2})/i.test(e) || /^\s*#/.test(e)) return void (a.source = e); var c = 0 === e.indexOf("//"); 0 !== e.indexOf("/") || c || (e = (s ? s.protocol || "http" : "http") + "://mce_host" + e), /^[\w\-]*:?\/\//.test(e) || (l = o.base_uri ? o.base_uri.path : new t(location.href).directory, "" === o.base_uri.protocol ? e = "//mce_host" + a.toAbsPath(l, e) : (e = /([^#?]*)([#?]?.*)/.exec(e), e = (s && s.protocol || "http") + "://mce_host" + a.toAbsPath(l, e[1]) + e[2])), e = e.replace(/@@/g, "(mce_at)"), e = /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e), n(i, function (t, n) { var r = e[n]; r && (r = r.replace(/\(mce_at\)/g, "@@")), a[t] = r }), s && (a.protocol || (a.protocol = s.protocol), a.userInfo || (a.userInfo = s.userInfo), a.port || "mce_host" !== a.host || (a.port = s.port), a.host && "mce_host" !== a.host || (a.host = s.host), a.source = ""), c && (a.protocol = "") } var n = e.each, r = e.trim, i = "source protocol authority userInfo user password host port relative path directory file query anchor".split(" "), o = { ftp: 21, http: 80, https: 443, mailto: 25 }; return t.prototype = { setPath: function (e) { var t = this; e = /^(.*?)\/?(\w+)?$/.exec(e), t.path = e[0], t.directory = e[1], t.file = e[2], t.source = "", t.getURI() }, toRelative: function (e) { var n = this, r; if ("./" === e) return e; if (e = new t(e, { base_uri: n }), "mce_host" != e.host && n.host != e.host && e.host || n.port != e.port || n.protocol != e.protocol && "" !== e.protocol) return e.getURI(); var i = n.getURI(), o = e.getURI(); return i == o || "/" == i.charAt(i.length - 1) && i.substr(0, i.length - 1) == o ? i : (r = n.toRelPath(n.path, e.path), e.query && (r += "?" + e.query), e.anchor && (r += "#" + e.anchor), r) }, toAbsolute: function (e, n) { return e = new t(e, { base_uri: this }), e.getURI(n && this.isSameOrigin(e)) }, isSameOrigin: function (e) { if (this.host == e.host && this.protocol == e.protocol) { if (this.port == e.port) return !0; var t = o[this.protocol]; if (t && (this.port || t) == (e.port || t)) return !0 } return !1 }, toRelPath: function (e, t) { var n, r = 0, i = "", o, a; if (e = e.substring(0, e.lastIndexOf("/")), e = e.split("/"), n = t.split("/"), e.length >= n.length) for (o = 0, a = e.length; a > o; o++) if (o >= n.length || e[o] != n[o]) { r = o + 1; break } if (e.length < n.length) for (o = 0, a = n.length; a > o; o++) if (o >= e.length || e[o] != n[o]) { r = o + 1; break } if (1 === r) return t; for (o = 0, a = e.length - (r - 1); a > o; o++) i += "../"; for (o = r - 1, a = n.length; a > o; o++) i += o != r - 1 ? "/" + n[o] : n[o]; return i }, toAbsPath: function (e, t) { var r, i = 0, o = [], a, s; for (a = /\/$/.test(t) ? "/" : "", e = e.split("/"), t = t.split("/"), n(e, function (e) { e && o.push(e) }), e = o, r = t.length - 1, o = []; r >= 0; r--) 0 !== t[r].length && "." !== t[r] && (".." !== t[r] ? i > 0 ? i-- : o.push(t[r]) : i++); return r = e.length - i, s = 0 >= r ? o.reverse().join("/") : e.slice(0, r).join("/") + "/" + o.reverse().join("/"), 0 !== s.indexOf("/") && (s = "/" + s), a && s.lastIndexOf("/") !== s.length - 1 && (s += a), s }, getURI: function (e) { var t, n = this; return (!n.source || e) && (t = "", e || (t += n.protocol ? n.protocol + "://" : "//", n.userInfo && (t += n.userInfo + "@"), n.host && (t += n.host), n.port && (t += ":" + n.port)), n.path && (t += n.path), n.query && (t += "?" + n.query), n.anchor && (t += "#" + n.anchor), n.source = t), n.source } }, t }), r(U, [u], function (e) { function t() { } var n = e.each, r = e.extend, i, o; return t.extend = i = function (e) { function t() { var e, t, n, r = this; if (!o && (r.init && r.init.apply(r, arguments), t = r.Mixins)) for (e = t.length; e--; ) n = t[e], n.init && n.init.apply(r, arguments) } function a() { return this } function s(e, t) { return function () { var n = this, r = n._super, i; return n._super = c[e], i = t.apply(n, arguments), n._super = r, i } } var l = this, c = l.prototype, u, d, f; o = !0, u = new l, o = !1, e.Mixins && (n(e.Mixins, function (t) { t = t; for (var n in t) "init" !== n && (e[n] = t[n]) }), c.Mixins && (e.Mixins = c.Mixins.concat(e.Mixins))), e.Methods && n(e.Methods.split(","), function (t) { e[t] = a }), e.Properties && n(e.Properties.split(","), function (t) { var n = "_" + t; e[t] = function (e) { var t = this, r; return e !== r ? (t[n] = e, t) : t[n] } }), e.Statics && n(e.Statics, function (e, n) { t[n] = e }), e.Defaults && c.Defaults && (e.Defaults = r({}, c.Defaults, e.Defaults)); for (d in e) f = e[d], u[d] = "function" == typeof f && c[d] ? s(d, f) : f; return t.prototype = u, t.constructor = t, t.extend = i, t }, t }), r($, [u], function (e) { function t(e) { function t() { return !1 } function n() { return !0 } function r(r, i) { var a, s, l, d; if (r = r.toLowerCase(), i = i || {}, i.type = r, i.target || (i.target = c), i.preventDefault || (i.preventDefault = function () { i.isDefaultPrevented = n }, i.stopPropagation = function () { i.isPropagationStopped = n }, i.stopImmediatePropagation = function () { i.isImmediatePropagationStopped = n }, i.isDefaultPrevented = t, i.isPropagationStopped = t, i.isImmediatePropagationStopped = t), e.beforeFire && e.beforeFire(i), a = u[r]) for (s = 0, l = a.length; l > s; s++) { if (a[s] = d = a[s], d.once && o(r, d), i.isImmediatePropagationStopped()) return i.stopPropagation(), i; if (d.call(c, i) === !1) return i.preventDefault(), i } return i } function i(e, n, r) { var i, o, a; if (n === !1 && (n = t), n) for (o = e.toLowerCase().split(" "), a = o.length; a--; ) e = o[a], i = u[e], i || (i = u[e] = [], d(e, !0)), r ? i.unshift(n) : i.push(n); return l } function o(e, t) { var n, r, i, o, a; if (e) for (o = e.toLowerCase().split(" "), n = o.length; n--; ) { if (e = o[n], r = u[e], !e) { for (i in u) d(i, !1), delete u[i]; return l } if (r) { if (t) for (a = r.length; a--; ) r[a] === t && (r = r.slice(0, a).concat(r.slice(a + 1)), u[e] = r); else r.length = 0; r.length || (d(e, !1), delete u[e]) } } else { for (e in u) d(e, !1); u = {} } return l } function a(e, t, n) { return t.once = !0, i(e, t, n) } function s(e) { return e = e.toLowerCase(), !(!u[e] || 0 === u[e].length) } var l = this, c, u = {}, d; e = e || {}, c = e.scope || l, d = e.toggleEvent || t, l.fire = r, l.on = i, l.off = o, l.once = a, l.has = s } var n = e.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchend", " "); return t.isNative = function (e) { return !!n[e.toLowerCase()] }, t }), r(q, [U], function (e) { function t(e) { for (var t = [], n = e.length, r; n--; ) r = e[n], r.__checked || (t.push(r), r.__checked = 1); for (n = t.length; n--; ) delete t[n].__checked; return t } var n = /^([\w\\*]+)?(?:#([\w\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i, r = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, i = /^\s*|\s*$/g, o, a = e.extend({ init: function (e) { function t(e) { return e ? (e = e.toLowerCase(), function (t) { return "*" === e || t.type === e }) : void 0 } function o(e) { return e ? function (t) { return t._name === e } : void 0 } function a(e) { return e ? (e = e.split("."), function (t) { for (var n = e.length; n--; ) if (!t.hasClass(e[n])) return !1; return !0 }) : void 0 } function s(e, t, n) { return e ? function (r) { var i = r[e] ? r[e]() : ""; return t ? "=" === t ? i === n : "*=" === t ? i.indexOf(n) >= 0 : "~=" === t ? (" " + i + " ").indexOf(" " + n + " ") >= 0 : "!=" === t ? i != n : "^=" === t ? 0 === i.indexOf(n) : "$=" === t ? i.substr(i.length - n.length) === n : !1 : !!n } : void 0 } function l(e) { var t; return e ? (e = /(?:not\((.+)\))|(.+)/i.exec(e), e[1] ? (t = u(e[1], []), function (e) { return !d(e, t) }) : (e = e[2], function (t, n, r) { return "first" === e ? 0 === n : "last" === e ? n === r - 1 : "even" === e ? n % 2 === 0 : "odd" === e ? n % 2 === 1 : t[e] ? t[e]() : !1 })) : void 0 } function c(e, r, c) { function u(e) { e && r.push(e) } var d; return d = n.exec(e.replace(i, "")), u(t(d[1])), u(o(d[2])), u(a(d[3])), u(s(d[4], d[5], d[6])), u(l(d[7])), r.psuedo = !!d[7], r.direct = c, r } function u(e, t) { var n = [], i, o, a; do if (r.exec(""), o = r.exec(e), o && (e = o[3], n.push(o[1]), o[2])) { i = o[3]; break } while (o); for (i && u(i, t), e = [], a = 0; a < n.length; a++) ">" != n[a] && e.push(c(n[a], [], ">" === n[a - 1])); return t.push(e), t } var d = this.match; this._selectors = u(e, []) }, match: function (e, t) { var n, r, i, o, a, s, l, c, u, d, f, p, h; for (t = t || this._selectors, n = 0, r = t.length; r > n; n++) { for (a = t[n], o = a.length, h = e, p = 0, i = o - 1; i >= 0; i--) for (c = a[i]; h; ) { if (c.psuedo) for (f = h.parent().items(), u = d = f.length; u-- && f[u] !== h; ); for (s = 0, l = c.length; l > s; s++) if (!c[s](h, u, d)) { s = l + 1; break } if (s === l) { p++; break } if (i === o - 1) break; h = h.parent() } if (p === o) return !0 } return !1 }, find: function (e) { function n(e, t, i) { var o, a, s, l, c, u = t[i]; for (o = 0, a = e.length; a > o; o++) { for (c = e[o], s = 0, l = u.length; l > s; s++) if (!u[s](c, o, a)) { s = l + 1; break } if (s === l) i == t.length - 1 ? r.push(c) : c.items && n(c.items(), t, i + 1); else if (u.direct) return; c.items && n(c.items(), t, i) } } var r = [], i, s, l = this._selectors; if (e.items) { for (i = 0, s = l.length; s > i; i++) n(e.items(), l[i], 0); s > 1 && (r = t(r)) } return o || (o = a.Collection), new o(r) } }); return a }), r(j, [u, q, U], function (e, t, n) { var r, i, o = Array.prototype.push, a = Array.prototype.slice; return i = { length: 0, init: function (e) { e && this.add(e) }, add: function (t) { var n = this; return e.isArray(t) ? o.apply(n, t) : t instanceof r ? n.add(t.toArray()) : o.call(n, t), n }, set: function (e) { var t = this, n = t.length, r; for (t.length = 0, t.add(e), r = t.length; n > r; r++) delete t[r]; return t }, filter: function (e) { var n = this, i, o, a = [], s, l; for ("string" == typeof e ? (e = new t(e), l = function (t) { return e.match(t) }) : l = e, i = 0, o = n.length; o > i; i++) s = n[i], l(s) && a.push(s); return new r(a) }, slice: function () { return new r(a.apply(this, arguments)) }, eq: function (e) { return -1 === e ? this.slice(e) : this.slice(e, +e + 1) }, each: function (t) { return e.each(this, t), this }, toArray: function () { return e.toArray(this) }, indexOf: function (e) { for (var t = this, n = t.length; n-- && t[n] !== e; ); return n }, reverse: function () { return new r(e.toArray(this).reverse()) }, hasClass: function (e) { return this[0] ? this[0].hasClass(e) : !1 }, prop: function (e, t) { var n = this, r, i; return t !== r ? (n.each(function (n) { n[e] && n[e](t) }), n) : (i = n[0], i && i[e] ? i[e]() : void 0) }, exec: function (t) { var n = this, r = e.toArray(arguments).slice(1); return n.each(function (e) { e[t] && e[t].apply(e, r) }), n }, remove: function () { for (var e = this.length; e--; ) this[e].remove(); return this } }, e.each("fire on off show hide addClass removeClass append prepend before after reflow".split(" "), function (t) { i[t] = function () { var n = e.toArray(arguments); return this.each(function (e) { t in e && e[t].apply(e, n) }), this } }), e.each("text name disabled active selected checked visible parent value data".split(" "), function (e) { i[e] = function (t) { return this.prop(e, t) } }), r = n.extend(i), t.Collection = r, r }), r(Y, [u, y], function (e, t) { var n = 0; return { id: function () { return "mceu_" + n++ }, createFragment: function (e) { return t.DOM.createFragment(e) }, getWindowSize: function () { return t.DOM.getViewPort() }, getSize: function (e) { var t, n; if (e.getBoundingClientRect) { var r = e.getBoundingClientRect(); t = Math.max(r.width || r.right - r.left, e.offsetWidth), n = Math.max(r.height || r.bottom - r.bottom, e.offsetHeight) } else t = e.offsetWidth, n = e.offsetHeight; return { width: t, height: n} }, getPos: function (e, n) { return t.DOM.getPos(e, n) }, getViewPort: function (e) { return t.DOM.getViewPort(e) }, get: function (e) { return document.getElementById(e) }, addClass: function (e, n) { return t.DOM.addClass(e, n) }, removeClass: function (e, n) { return t.DOM.removeClass(e, n) }, hasClass: function (e, n) { return t.DOM.hasClass(e, n) }, toggleClass: function (e, n, r) { return t.DOM.toggleClass(e, n, r) }, css: function (e, n, r) { return t.DOM.setStyle(e, n, r) }, getRuntimeStyle: function (e, n) { return t.DOM.getStyle(e, n, !0) }, on: function (e, n, r, i) { return t.DOM.bind(e, n, r, i) }, off: function (e, n, r) { return t.DOM.unbind(e, n, r) }, fire: function (e, n, r) { return t.DOM.fire(e, n, r) }, innerHtml: function (e, n) { t.DOM.setHTML(e, n) } } }), r(K, [U, u, $, j, Y], function (e, t, n, r, i) { function o(e) { return e._eventDispatcher || (e._eventDispatcher = new n({ scope: e, toggleEvent: function (t, r) { r && n.isNative(t) && (e._nativeEvents || (e._nativeEvents = {}), e._nativeEvents[t] = !0, e._rendered && e.bindPendingEvents()) } })), e._eventDispatcher } var a = "onmousewheel" in document, s = !1, l = "mce-", c = e.extend({ Statics: { classPrefix: l }, isRtl: function () { return c.rtl }, classPrefix: l, init: function (e) { var n = this, r, o; if (n.settings = e = t.extend({}, n.Defaults, e), n._id = e.id || i.id(), n._text = n._name = "", n._width = n._height = 0, n._aria = { role: e.role }, this._elmCache = {}, r = e.classes) for (r = r.split(" "), r.map = {}, o = r.length; o--; ) r.map[r[o]] = !0; n._classes = r || [], n.visible(!0), t.each("title text width height name classes visible disabled active value".split(" "), function (t) { var r = e[t], i; r !== i ? n[t](r) : n["_" + t] === i && (n["_" + t] = !1) }), n.on("click", function () { return n.disabled() ? !1 : void 0 }), e.classes && t.each(e.classes.split(" "), function (e) { n.addClass(e) }), n.settings = e, n._borderBox = n.parseBox(e.border), n._paddingBox = n.parseBox(e.padding), n._marginBox = n.parseBox(e.margin), e.hidden && n.hide() }, Properties: "parent,title,text,width,height,disabled,active,name,value", Methods: "renderHtml", getContainerElm: function () { return document.body }, getParentCtrl: function (e) { for (var t, n = this.getRoot().controlIdLookup; e && n && !(t = n[e.id]); ) e = e.parentNode; return t }, parseBox: function (e) { var t, n = 10; if (e) return "number" == typeof e ? (e = e || 0, { top: e, left: e, bottom: e, right: e }) : (e = e.split(" "), t = e.length, 1 === t ? e[1] = e[2] = e[3] = e[0] : 2 === t ? (e[2] = e[0], e[3] = e[1]) : 3 === t && (e[3] = e[1]), { top: parseInt(e[0], n) || 0, right: parseInt(e[1], n) || 0, bottom: parseInt(e[2], n) || 0, left: parseInt(e[3], n) || 0 }) }, borderBox: function () { return this._borderBox }, paddingBox: function () { return this._paddingBox }, marginBox: function () { return this._marginBox }, measureBox: function (e, t) { function n(t) { var n = document.defaultView; return n ? (t = t.replace(/[A-Z]/g, function (e) { return "-" + e }), n.getComputedStyle(e, null).getPropertyValue(t)) : e.currentStyle[t] } function r(e) { var t = parseFloat(n(e), 10); return isNaN(t) ? 0 : t } return { top: r(t + "TopWidth"), right: r(t + "RightWidth"), bottom: r(t + "BottomWidth"), left: r(t + "LeftWidth")} }, initLayoutRect: function () { var e = this, t = e.settings, n, r, o = e.getEl(), a, s, l, c, u, d, f, p; n = e._borderBox = e._borderBox || e.measureBox(o, "border"), e._paddingBox = e._paddingBox || e.measureBox(o, "padding"), e._marginBox = e._marginBox || e.measureBox(o, "margin"), p = i.getSize(o), d = t.minWidth, f = t.minHeight, l = d || p.width, c = f || p.height, a = t.width, s = t.height, u = t.autoResize, u = "undefined" != typeof u ? u : !a && !s, a = a || l, s = s || c; var h = n.left + n.right, m = n.top + n.bottom, g = t.maxWidth || 65535, v = t.maxHeight || 65535; return e._layoutRect = r = { x: t.x || 0, y: t.y || 0, w: a, h: s, deltaW: h, deltaH: m, contentW: a - h, contentH: s - m, innerW: a - h, innerH: s - m, startMinWidth: d || 0, startMinHeight: f || 0, minW: Math.min(l, g), minH: Math.min(c, v), maxW: g, maxH: v, autoResize: u, scrollW: 0 }, e._lastLayoutRect = {}, r }, layoutRect: function (e) { var t = this, n = t._layoutRect, r, i, o, a, s, l; return n || (n = t.initLayoutRect()), e ? (o = n.deltaW, a = n.deltaH, e.x !== s && (n.x = e.x), e.y !== s && (n.y = e.y), e.minW !== s && (n.minW = e.minW), e.minH !== s && (n.minH = e.minH), i = e.w, i !== s && (i = i < n.minW ? n.minW : i, i = i > n.maxW ? n.maxW : i, n.w = i, n.innerW = i - o), i = e.h, i !== s && (i = i < n.minH ? n.minH : i, i = i > n.maxH ? n.maxH : i, n.h = i, n.innerH = i - a), i = e.innerW, i !== s && (i = i < n.minW - o ? n.minW - o : i, i = i > n.maxW - o ? n.maxW - o : i, n.innerW = i, n.w = i + o), i = e.innerH, i !== s && (i = i < n.minH - a ? n.minH - a : i, i = i > n.maxH - a ? n.maxH - a : i, n.innerH = i, n.h = i + a), e.contentW !== s && (n.contentW = e.contentW), e.contentH !== s && (n.contentH = e.contentH), r = t._lastLayoutRect, (r.x !== n.x || r.y !== n.y || r.w !== n.w || r.h !== n.h) && (l = c.repaintControls, l && l.map && !l.map[t._id] && (l.push(t), l.map[t._id] = !0), r.x = n.x, r.y = n.y, r.w = n.w, r.h = n.h), t) : n }, repaint: function () { var e = this, t, n, r, i, o = 0, a = 0, s, l; l = document.createRange ? function (e) { return e } : Math.round, t = e.getEl().style, r = e._layoutRect, s = e._lastRepaintRect || {}, i = e._borderBox, o = i.left + i.right, a = i.top + i.bottom, r.x !== s.x && (t.left = l(r.x) + "px", s.x = r.x), r.y !== s.y && (t.top = l(r.y) + "px", s.y = r.y), r.w !== s.w && (t.width = l(r.w - o) + "px", s.w = r.w), r.h !== s.h && (t.height = l(r.h - a) + "px", s.h = r.h), e._hasBody && r.innerW !== s.innerW && (n = e.getEl("body").style, n.width = l(r.innerW) + "px", s.innerW = r.innerW), e._hasBody && r.innerH !== s.innerH && (n = n || e.getEl("body").style, n.height = l(r.innerH) + "px", s.innerH = r.innerH), e._lastRepaintRect = s, e.fire("repaint", {}, !1) }, on: function (e, t) { function n(e) { var t, n; return "string" != typeof e ? e : function (i) { return t || r.parentsAndSelf().each(function (r) { var i = r.settings.callbacks; return i && (t = i[e]) ? (n = r, !1) : void 0 }), t.call(n, i) } } var r = this; return o(r).on(e, n(t)), r }, off: function (e, t) { return o(this).off(e, t), this }, fire: function (e, t, n) { var r = this; if (t = t || {}, t.control || (t.control = r), t = o(r).fire(e, t), n !== !1 && r.parent) for (var i = r.parent(); i && !t.isPropagationStopped(); ) i.fire(e, t, !1), i = i.parent(); return t }, hasEventListeners: function (e) { return o(this).has(e) }, parents: function (e) { var t = this, n, i = new r; for (n = t.parent(); n; n = n.parent()) i.add(n); return e && (i = i.filter(e)), i }, parentsAndSelf: function (e) { return new r(this).add(this.parents(e)) }, next: function () { var e = this.parent().items(); return e[e.indexOf(this) + 1] }, prev: function () { var e = this.parent().items(); return e[e.indexOf(this) - 1] }, findCommonAncestor: function (e, t) { for (var n; e; ) { for (n = t; n && e != n; ) n = n.parent(); if (e == n) break; e = e.parent() } return e }, hasClass: function (e, t) { var n = this._classes[t || "control"]; return e = this.classPrefix + e, n && !!n.map[e] }, addClass: function (e, t) { var n = this, r, i; return e = this.classPrefix + e, r = n._classes[t || "control"], r || (r = [], r.map = {}, n._classes[t || "control"] = r), r.map[e] || (r.map[e] = e, r.push(e), n._rendered && (i = n.getEl(t), i && (i.className = r.join(" ")))), n }, removeClass: function (e, t) { var n = this, r, i, o; if (e = this.classPrefix + e, r = n._classes[t || "control"], r && r.map[e]) for (delete r.map[e], i = r.length; i--; ) r[i] === e && r.splice(i, 1); return n._rendered && (o = n.getEl(t), o && (o.className = r.join(" "))), n }, toggleClass: function (e, t, n) { var r = this; return t ? r.addClass(e, n) : r.removeClass(e, n), r }, classes: function (e) { var t = this._classes[e || "control"]; return t ? t.join(" ") : "" }, innerHtml: function (e) { return i.innerHtml(this.getEl(), e), this }, getEl: function (e) { var t = e ? this._id + "-" + e : this._id; return this._elmCache[t] || (this._elmCache[t] = i.get(t)), this._elmCache[t] }, visible: function (e) { var t = this, n; return "undefined" != typeof e ? (t._visible !== e && (t._rendered && (t.getEl().style.display = e ? "" : "none"), t._visible = e, n = t.parent(), n && (n._lastRect = null), t.fire(e ? "show" : "hide")), t) : t._visible }, show: function () { return this.visible(!0) }, hide: function () { return this.visible(!1) }, focus: function () { try { this.getEl().focus() } catch (e) { } return this }, blur: function () { return this.getEl().blur(), this }, aria: function (e, t) { var n = this, r = n.getEl(n.ariaTarget); return "undefined" == typeof t ? n._aria[e] : (n._aria[e] = t, n._rendered && r.setAttribute("role" == e ? e : "aria-" + e, t), n) }, encode: function (e, t) { return t !== !1 && (e = this.translate(e)), (e || "").replace(/[&<>"]/g, function (e) { return "&#" + e.charCodeAt(0) + ";" }) }, translate: function (e) { return c.translate ? c.translate(e) : e }, before: function (e) { var t = this, n = t.parent(); return n && n.insert(e, n.items().indexOf(t), !0), t }, after: function (e) { var t = this, n = t.parent(); return n && n.insert(e, n.items().indexOf(t)), t }, remove: function () { var e = this, t = e.getEl(), n = e.parent(), r, o; if (e.items) { var a = e.items().toArray(); for (o = a.length; o--; ) a[o].remove() } n && n.items && (r = [], n.items().each(function (t) { t !== e && r.push(t) }), n.items().set(r), n._lastRect = null), e._eventsRoot && e._eventsRoot == e && i.off(t); var s = e.getRoot().controlIdLookup; return s && delete s[e._id], t && t.parentNode && t.parentNode.removeChild(t), e._rendered = !1, e }, renderBefore: function (e) { var t = this; return e.parentNode.insertBefore(i.createFragment(t.renderHtml()), e), t.postRender(), t }, renderTo: function (e) { var t = this; return e = e || t.getContainerElm(), e.appendChild(i.createFragment(t.renderHtml())), t.postRender(), t }, postRender: function () { var e = this, t = e.settings, n, r, o, a, s; for (a in t) 0 === a.indexOf("on") && e.on(a.substr(2), t[a]); if (e._eventsRoot) { for (o = e.parent(); !s && o; o = o.parent()) s = o._eventsRoot; if (s) for (a in s._nativeEvents) e._nativeEvents[a] = !0 } e.bindPendingEvents(), t.style && (n = e.getEl(), n && (n.setAttribute("style", t.style), n.style.cssText = t.style)), e._visible || i.css(e.getEl(), "display", "none"), e.settings.border && (r = e.borderBox(), i.css(e.getEl(), { "border-top-width": r.top, "border-right-width": r.right, "border-bottom-width": r.bottom, "border-left-width": r.left })); var l = e.getRoot(); l.controlIdLookup || (l.controlIdLookup = {}), l.controlIdLookup[e._id] = e; for (var c in e._aria) e.aria(c, e._aria[c]); e.fire("postrender", {}, !1) }, scrollIntoView: function (e) { function t(e, t) { var n, r, i = e; for (n = r = 0; i && i != t && i.nodeType; ) n += i.offsetLeft || 0, r += i.offsetTop || 0, i = i.offsetParent; return { x: n, y: r} } var n = this.getEl(), r = n.parentNode, i, o, a, s, l, c, u = t(n, r); return i = u.x, o = u.y, a = n.offsetWidth, s = n.offsetHeight, l = r.clientWidth, c = r.clientHeight, "end" == e ? (i -= l - a, o -= c - s) : "center" == e && (i -= l / 2 - a / 2, o -= c / 2 - s / 2), r.scrollLeft = i, r.scrollTop = o, this }, bindPendingEvents: function () { function e(e) { var t = o.getParentCtrl(e.target); t && t.fire(e.type, e) } function t() { var e = d._lastHoverCtrl; e && (e.fire("mouseleave", { target: e.getEl() }), e.parents().each(function (e) { e.fire("mouseleave", { target: e.getEl() }) }), d._lastHoverCtrl = null) } function n(e) { var t = o.getParentCtrl(e.target), n = d._lastHoverCtrl, r = 0, i, a, s; if (t !== n) { if (d._lastHoverCtrl = t, a = t.parents().toArray().reverse(), a.push(t), n) { for (s = n.parents().toArray().reverse(), s.push(n), r = 0; r < s.length && a[r] === s[r]; r++); for (i = s.length - 1; i >= r; i--) n = s[i], n.fire("mouseleave", { target: n.getEl() }) } for (i = r; i < a.length; i++) t = a[i], t.fire("mouseenter", { target: t.getEl() }) } } function r(e) { e.preventDefault(), "mousewheel" == e.type ? (e.deltaY = -1 / 40 * e.wheelDelta, e.wheelDeltaX && (e.deltaX = -1 / 40 * e.wheelDeltaX)) : (e.deltaX = 0, e.deltaY = e.detail), e = o.fire("wheel", e) } var o = this, l, c, u, d, f, p; if (o._rendered = !0, f = o._nativeEvents) { for (u = o.parents().toArray(), u.unshift(o), l = 0, c = u.length; !d && c > l; l++) d = u[l]._eventsRoot; for (d || (d = u[u.length - 1] || o), o._eventsRoot = d, c = l, l = 0; c > l; l++) u[l]._eventsRoot = d; var h = d._delegates; h || (h = d._delegates = {}); for (p in f) { if (!f) return !1; "wheel" !== p || s ? ("mouseenter" === p || "mouseleave" === p ? d._hasMouseEnter || (i.on(d.getEl(), "mouseleave", t), i.on(d.getEl(), "mouseover", n), d._hasMouseEnter = 1) : h[p] || (i.on(d.getEl(), p, e), h[p] = !0), f[p] = !1) : a ? i.on(o.getEl(), "mousewheel", r) : i.on(o.getEl(), "DOMMouseScroll", r) } } }, getRoot: function () { for (var e = this, t, n = []; e; ) { if (e.rootControl) { t = e.rootControl; break } n.push(e), t = e, e = e.parent() } t || (t = this); for (var r = n.length; r--; ) n[r].rootControl = t; return t }, reflow: function () { return this.repaint(), this } }); return c }), r(G, [], function () { var e = {}, t; return { add: function (t, n) { e[t.toLowerCase()] = n }, has: function (t) { return !!e[t.toLowerCase()] }, create: function (n, r) { var i, o, a; if (!t) { a = tinymce.ui; for (o in a) e[o.toLowerCase()] = a[o]; t = !0 } if ("string" == typeof n ? (r = r || {}, r.type = n) : (r = n, n = r.type), n = n.toLowerCase(), i = e[n], !i) throw new Error("Could not find control by type: " + n); return i = new i(r), i.type = n, i } } }), r(X, [], function () { return function (e) { function t(e) { return e = e || b, e && e.getAttribute("role") } function n(e) { for (var n, r = e || b; r = r.parentNode; ) if (n = t(r)) return n } function r(e) { var t = b; return t ? t.getAttribute("aria-" + e) : void 0 } function i(e) { var t = e.tagName.toUpperCase(); return "INPUT" == t || "TEXTAREA" == t } function o(e) { return i(e) && !e.hidden ? !0 : /^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell)$/.test(t(e)) ? !0 : !1 } function a(e) { function t(e) { if (1 == e.nodeType && "none" != e.style.display) { o(e) && n.push(e); for (var r = 0; r < e.childNodes.length; r++) t(e.childNodes[r]) } } var n = []; return t(e || y.getEl()), n } function s(e) { var t, n; e = e || C, n = e.parents().toArray(), n.unshift(e); for (var r = 0; r < n.length && (t = n[r], !t.settings.ariaRoot); r++); return t } function l(e) { var t = s(e), n = a(t.getEl()); t.settings.ariaRemember && "lastAriaIndex" in t ? c(t.lastAriaIndex, n) : c(0, n) } function c(e, t) { return 0 > e ? e = t.length - 1 : e >= t.length && (e = 0), t[e] && t[e].focus(), e } function u(e, t) { var n = -1, r = s(); t = t || a(r.getEl()); for (var i = 0; i < t.length; i++) t[i] === b && (n = i); n += e, r.lastAriaIndex = c(n, t) } function d() { var e = n(); "tablist" == e ? u(-1, a(b.parentNode)) : C.parent().submenu ? g() : u(-1) } function f() { var e = t(), i = n(); "tablist" == i ? u(1, a(b.parentNode)) : "menuitem" == e && "menu" == i && r("haspopup") ? v() : u(1) } function p() { u(-1) } function h() { var e = t(), i = n(); "menuitem" == e && "menubar" == i ? v() : "button" == e && r("haspopup") ? v({ key: "down" }) : u(1) } function m(e) { var t = n(); if ("tablist" == t) { var r = a(C.getEl("body"))[0]; r && r.focus() } else u(e.shiftKey ? -1 : 1) } function g() { C.fire("cancel") } function v(e) { e = e || {}, C.fire("click", { target: b, aria: e }) } var y = e.root, b, C; try { b = document.activeElement } catch (x) { b = document.body } return C = y.getParentCtrl(b), y.on("keydown", function (e) { function t(e, t) { i(b) || t(e) !== !1 && e.preventDefault() } if (!e.isDefaultPrevented()) switch (e.keyCode) { case 37: t(e, d); break; case 39: t(e, f); break; case 38: t(e, p); break; case 40: t(e, h); break; case 27: g(); break; case 14: case 13: case 32: t(e, v); break; case 9: m(e) !== !1 && e.preventDefault() } }), y.on("focusin", function (e) { b = e.target, C = e.control }), { focusFirst: l} } }), r(J, [K, j, q, G, X, u, Y], function (e, t, n, r, i, o, a) { var s = {}; return e.extend({ layout: "", innerClass: "container-inner", init: function (e) { var n = this; n._super(e), e = n.settings, n._fixed = e.fixed, n._items = new t, n.isRtl() && n.addClass("rtl"), n.addClass("container"), n.addClass("container-body", "body"), e.containerCls && n.addClass(e.containerCls), n._layout = r.create((e.layout || n.layout) + "layout"), n.settings.items && n.add(n.settings.items), n._hasBody = !0 }, items: function () { return this._items }, find: function (e) { return e = s[e] = s[e] || new n(e), e.find(this) }, add: function (e) { var t = this; return t.items().add(t.create(e)).parent(t), t }, focus: function (e) { var t = this, n, r, i; return e && (r = t.keyboardNav || t.parents().eq(-1)[0].keyboardNav) ? void r.focusFirst(t) : (i = t.find("*"), t.statusbar && i.add(t.statusbar.items()), i.each(function (e) { return e.settings.autofocus ? (n = null, !1) : void (e.canFocus && (n = n || e)) }), n && n.focus(), t) }, replace: function (e, t) { for (var n, r = this.items(), i = r.length; i--; ) if (r[i] === e) { r[i] = t; break } i >= 0 && (n = t.getEl(), n && n.parentNode.removeChild(n), n = e.getEl(), n && n.parentNode.removeChild(n)), t.parent(this) }, create: function (t) { var n = this, i, a = []; return o.isArray(t) || (t = [t]), o.each(t, function (t) { t && (t instanceof e || ("string" == typeof t && (t = { type: t }), i = o.extend({}, n.settings.defaults, t), t.type = i.type = i.type || t.type || n.settings.defaultType || (i.defaults ? i.defaults.type : null), t = r.create(i)), a.push(t)) }), a }, renderNew: function () { var e = this; return e.items().each(function (t, n) { var r, i; t.parent(e), t._rendered || (r = e.getEl("body"), i = a.createFragment(t.renderHtml()), r.hasChildNodes() && n <= r.childNodes.length - 1 ? r.insertBefore(i, r.childNodes[n]) : r.appendChild(i), t.postRender()) }), e._layout.applyClasses(e), e._lastRect = null, e }, append: function (e) { return this.add(e).renderNew() }, prepend: function (e) { var t = this; return t.items().set(t.create(e).concat(t.items().toArray())), t.renderNew() }, insert: function (e, t, n) { var r = this, i, o, a; return e = r.create(e), i = r.items(), !n && t < i.length - 1 && (t += 1), t >= 0 && t < i.length && (o = i.slice(0, t).toArray(), a = i.slice(t).toArray(), i.set(o.concat(e, a))), r.renderNew() }, fromJSON: function (e) { var t = this; for (var n in e) t.find("#" + n).value(e[n]); return t }, toJSON: function () { var e = this, t = {}; return e.find("*").each(function (e) { var n = e.name(), r = e.value(); n && "undefined" != typeof r && (t[n] = r) }), t }, preRender: function () { }, renderHtml: function () { var e = this, t = e._layout, n = this.settings.role; return e.preRender(), t.preRender(e), '<div id="' + e._id + '" class="' + e.classes() + '"' + (n ? ' role="' + this.settings.role + '"' : "") + '><div id="' + e._id + '-body" class="' + e.classes("body") + '">' + (e.settings.html || "") + t.renderHtml(e) + "</div></div>" }, postRender: function () { var e = this, t; return e.items().exec("postRender"), e._super(), e._layout.postRender(e), e._rendered = !0, e.settings.style && a.css(e.getEl(), e.settings.style), e.settings.border && (t = e.borderBox(), a.css(e.getEl(), { "border-top-width": t.top, "border-right-width": t.right, "border-bottom-width": t.bottom, "border-left-width": t.left })), e.parent() || (e.keyboardNav = new i({ root: e })), e }, initLayoutRect: function () { var e = this, t = e._super(); return e._layout.recalc(e), t }, recalc: function () { var e = this, t = e._layoutRect, n = e._lastRect; return n && n.w == t.w && n.h == t.h ? void 0 : (e._layout.recalc(e), t = e.layoutRect(), e._lastRect = { x: t.x, y: t.y, w: t.w, h: t.h }, !0) }, reflow: function () { var t; if (this.visible()) { for (e.repaintControls = [], e.repaintControls.map = {}, this.recalc(), t = e.repaintControls.length; t--; ) e.repaintControls[t].repaint(); "flow" !== this.settings.layout && "stack" !== this.settings.layout && this.repaint(), e.repaintControls = [] } return this } }) }), r(Q, [Y], function (e) { function t() { var e = document, t, n, r, i, o, a, s, l, c = Math.max; return t = e.documentElement, n = e.body, r = c(t.scrollWidth, n.scrollWidth), i = c(t.clientWidth, n.clientWidth), o = c(t.offsetWidth, n.offsetWidth), a = c(t.scrollHeight, n.scrollHeight), s = c(t.clientHeight, n.clientHeight), l = c(t.offsetHeight, n.offsetHeight), { width: o > r ? i : r, height: l > a ? s : a} } return function (n, r) { function i() { return a.getElementById(r.handle || n) } var o, a = document, s, l, c, u, d, f; r = r || {}, l = function (n) { var l = t(), p, h; n.preventDefault(), s = n.button, p = i(), d = n.screenX, f = n.screenY, h = window.getComputedStyle ? window.getComputedStyle(p, null).getPropertyValue("cursor") : p.runtimeStyle.cursor, o = a.createElement("div"), e.css(o, { position: "absolute", top: 0, left: 0, width: l.width, height: l.height, zIndex: 2147483647, opacity: 1e-4, cursor: h }), a.body.appendChild(o), e.on(a, "mousemove", u), e.on(a, "mouseup", c), r.start(n) }, u = function (e) { return e.button !== s ? c(e) : (e.deltaX = e.screenX - d, e.deltaY = e.screenY - f, e.preventDefault(), void r.drag(e)) }, c = function (t) { e.off(a, "mousemove", u), e.off(a, "mouseup", c), o.parentNode.removeChild(o), r.stop && r.stop(t) }, this.destroy = function () { e.off(i()) }, e.on(i(), "mousedown", l) } }), r(Z, [Y, Q], function (e, t) { return { init: function () { var e = this; e.on("repaint", e.renderScroll) }, renderScroll: function () { function n() { function t(t, a, s, l, c, u) { var d, f, p, h, m, g, v, y, b; if (f = i.getEl("scroll" + t)) { if (y = a.toLowerCase(), b = s.toLowerCase(), i.getEl("absend") && e.css(i.getEl("absend"), y, i.layoutRect()[l] - 1), !c) return void e.css(f, "display", "none"); e.css(f, "display", "block"), d = i.getEl("body"), p = i.getEl("scroll" + t + "t"), h = d["client" + s] - 2 * o, h -= n && r ? f["client" + u] : 0, m = d["scroll" + s], g = h / m, v = {}, v[y] = d["offset" + a] + o, v[b] = h, e.css(f, v), v = {}, v[y] = d["scroll" + a] * g, v[b] = h * g, e.css(p, v) } } var n, r, a; a = i.getEl("body"), n = a.scrollWidth > a.clientWidth, r = a.scrollHeight > a.clientHeight, t("h", "Left", "Width", "contentW", n, "Height"), t("v", "Top", "Height", "contentH", r, "Width") } function r() { function n(n, r, a, s, l) { var c, u = i._id + "-scroll" + n, d = i.classPrefix; i.getEl().appendChild(e.createFragment('<div id="' + u + '" class="' + d + "scrollbar " + d + "scrollbar-" + n + '"><div id="' + u + 't" class="' + d + 'scrollbar-thumb"></div></div>')), i.draghelper = new t(u + "t", { start: function () { c = i.getEl("body")["scroll" + r], e.addClass(e.get(u), d + "active") }, drag: function (e) { var t, u, d, f, p = i.layoutRect(); u = p.contentW > p.innerW, d = p.contentH > p.innerH, f = i.getEl("body")["client" + a] - 2 * o, f -= u && d ? i.getEl("scroll" + n)["client" + l] : 0, t = f / i.getEl("body")["scroll" + a], i.getEl("body")["scroll" + r] = c + e["delta" + s] / t }, stop: function () { e.removeClass(e.get(u), d + "active") } }) } i.addClass("scroll"), n("v", "Top", "Height", "Y", "Width"), n("h", "Left", "Width", "X", "Height") } var i = this, o = 2; i.settings.autoScroll && (i._hasScroll || (i._hasScroll = !0, r(), i.on("wheel", function (e) { var t = i.getEl("body"); t.scrollLeft += 10 * (e.deltaX || 0), t.scrollTop += 10 * e.deltaY, n() }), e.on(i.getEl("body"), "scroll", n)), n()) } } }), r(et, [J, Z], function (e, t) { return e.extend({ Defaults: { layout: "fit", containerCls: "panel" }, Mixins: [t], renderHtml: function () { var e = this, t = e._layout, n = e.settings.html; return e.preRender(), t.preRender(e), "undefined" == typeof n ? n = '<div id="' + e._id + '-body" class="' + e.classes("body") + '">' + t.renderHtml(e) + "</div>" : ("function" == typeof n && (n = n.call(e)), e._hasBody = !1), '<div id="' + e._id + '" class="' + e.classes() + '" hidefocus="1" tabindex="-1" role="group">' + (e._preBodyHtml || "") + n + "</div>" } }) }), r(tt, [Y], function (e) { function t(t, n, r) { var i, o, a, s, l, c, u, d, f, p; return f = e.getViewPort(), o = e.getPos(n), a = o.x, s = o.y, t._fixed && "static" == e.getRuntimeStyle(document.body, "position") && (a -= f.x, s -= f.y), i = t.getEl(), p = e.getSize(i), l = p.width, c = p.height, p = e.getSize(n), u = p.width, d = p.height, r = (r || "").split(""), "b" === r[0] && (s += d), "r" === r[1] && (a += u), "c" === r[0] && (s += Math.round(d / 2)), "c" === r[1] && (a += Math.round(u / 2)), "b" === r[3] && (s -= c), "r" === r[4] && (a -= l), "c" === r[3] && (s -= Math.round(c / 2)), "c" === r[4] && (a -= Math.round(l / 2)), { x: a, y: s, w: l, h: c} } return { testMoveRel: function (n, r) { for (var i = e.getViewPort(), o = 0; o < r.length; o++) { var a = t(this, n, r[o]); if (this._fixed) { if (a.x > 0 && a.x + a.w < i.w && a.y > 0 && a.y + a.h < i.h) return r[o] } else if (a.x > i.x && a.x + a.w < i.w + i.x && a.y > i.y && a.y + a.h < i.h + i.y) return r[o] } return r[0] }, moveRel: function (e, n) { "string" != typeof n && (n = this.testMoveRel(e, n)); var r = t(this, e, n); return this.moveTo(r.x, r.y) }, moveBy: function (e, t) { var n = this, r = n.layoutRect(); return n.moveTo(r.x + e, r.y + t), n }, moveTo: function (t, n) { function r(e, t, n) { return 0 > e ? 0 : e + n > t ? (e = t - n, 0 > e ? 0 : e) : e } var i = this; if (i.settings.constrainToViewport) { var o = e.getViewPort(window), a = i.layoutRect(); t = r(t, o.w + o.x, a.w), n = r(n, o.h + o.y, a.h) } return i._rendered ? i.layoutRect({ x: t, y: n }).repaint() : (i.settings.x = t, i.settings.y = n), i.fire("move", { x: t, y: n }), i } } }), r(nt, [Y], function (e) { return { resizeToContent: function () { this._layoutRect.autoResize = !0, this._lastRect = null, this.reflow() }, resizeTo: function (t, n) { if (1 >= t || 1 >= n) { var r = e.getWindowSize(); t = 1 >= t ? t * r.w : t, n = 1 >= n ? n * r.h : n } return this._layoutRect.autoResize = !1, this.layoutRect({ minW: t, minH: n, w: t, h: n }).reflow() }, resizeBy: function (e, t) { var n = this, r = n.layoutRect(); return n.resizeTo(r.w + e, r.h + t) } } }), r(rt, [et, tt, nt, Y], function (e, t, n, r) { function i() { function e(e, t) { for (; e; ) { if (e == t) return !0; e = e.parent() } } u || (u = function (t) { if (2 != t.button) for (var n = p.length; n--; ) { var r = p[n], i = r.getParentCtrl(t.target); if (r.settings.autohide) { if (i && (e(i, r) || r.parent() === i)) continue; t = r.fire("autohide", { target: t.target }), t.isDefaultPrevented() || r.hide() } } }, r.on(document, "click", u)) } function o() { d || (d = function () { var e; for (e = p.length; e--; ) s(p[e]) }, r.on(window, "scroll", d)) } function a() { if (!f) { var e = document.documentElement, t = e.clientWidth, n = e.clientHeight; f = function () { document.all && t == e.clientWidth && n == e.clientHeight || (t = e.clientWidth, n = e.clientHeight, g.hideAll()) }, r.on(window, "resize", f) } } function s(e) { function t(t, n) { for (var r, i = 0; i < p.length; i++) if (p[i] != e) for (r = p[i].parent(); r && (r = r.parent()); ) r == e && p[i].fixed(t).moveBy(0, n).repaint() } var n = r.getViewPort().y; e.settings.autofix && (e._fixed ? e._autoFixY > n && (e.fixed(!1).layoutRect({ y: e._autoFixY }).repaint(), t(!1, e._autoFixY - n)) : (e._autoFixY = e.layoutRect().y, e._autoFixY < n && (e.fixed(!0).layoutRect({ y: 0 }).repaint(), t(!0, n - e._autoFixY)))) } function l(e, t) { var n, i = g.zIndex || 65535, o; if (e) h.push(t); else for (n = h.length; n--; ) h[n] === t && h.splice(n, 1); if (h.length) for (n = 0; n < h.length; n++) h[n].modal && (i++, o = h[n]), h[n].getEl().style.zIndex = i, h[n].zIndex = i, i++; var a = document.getElementById(t.classPrefix + "modal-block"); o ? r.css(a, "z-index", o.zIndex - 1) : a && (a.parentNode.removeChild(a), m = !1), g.currentZIndex = i } function c(e) { var t; for (t = p.length; t--; ) p[t] === e && p.splice(t, 1); for (t = h.length; t--; ) h[t] === e && h.splice(t, 1) } var u, d, f, p = [], h = [], m, g = e.extend({ Mixins: [t, n], init: function (e) { var t = this; t._super(e), t._eventsRoot = t, t.addClass("floatpanel"), e.autohide && (i(), a(), p.push(t)), e.autofix && (o(), t.on("move", function () { s(this) })), t.on("postrender show", function (e) { if (e.control == t) { var n, i = t.classPrefix; t.modal && !m && (n = r.createFragment('<div id="' + i + 'modal-block" class="' + i + "reset " + i + 'fade"></div>'), n = n.firstChild, t.getContainerElm().appendChild(n), setTimeout(function () { r.addClass(n, i + "in"), r.addClass(t.getEl(), i + "in") }, 0), m = !0), l(!0, t) } }), t.on("show", function () { t.parents().each(function (e) { return e._fixed ? (t.fixed(!0), !1) : void 0 }) }), e.popover && (t._preBodyHtml = '<div class="' + t.classPrefix + 'arrow"></div>', t.addClass("popover").addClass("bottom").addClass(t.isRtl() ? "end" : "start")) }, fixed: function (e) { var t = this; if (t._fixed != e) { if (t._rendered) { var n = r.getViewPort(); e ? t.layoutRect().y -= n.y : t.layoutRect().y += n.y } t.toggleClass("fixed", e), t._fixed = e } return t }, show: function () { var e = this, t, n = e._super(); for (t = p.length; t-- && p[t] !== e; ); return -1 === t && p.push(e), n }, hide: function () { return c(this), l(!1, this), this._super() }, hideAll: function () { g.hideAll() }, close: function () { var e = this; return e.fire("close").isDefaultPrevented() || (e.remove(), l(!1, e)), e }, remove: function () { c(this), this._super() }, postRender: function () { var e = this; return e.settings.bodyRole && this.getEl("body").setAttribute("role", e.settings.bodyRole), e._super() } }); return g.hideAll = function () { for (var e = p.length; e--; ) { var t = p[e]; t && t.settings.autohide && (t.hide(), p.splice(e, 1)) } }, g }), r(it, [rt, et, Y, Q], function (e, t, n, r) { var i = e.extend({ modal: !0, Defaults: { border: 1, layout: "flex", containerCls: "panel", role: "dialog", callbacks: { submit: function () { this.fire("submit", { data: this.toJSON() }) }, close: function () { this.close() } } }, init: function (e) { var n = this; n._super(e), n.isRtl() && n.addClass("rtl"), n.addClass("window"), n._fixed = !0, e.buttons && (n.statusbar = new t({ layout: "flex", border: "1 0 0 0", spacing: 3, padding: 10, align: "center", pack: n.isRtl() ? "start" : "end", defaults: { type: "button" }, items: e.buttons }), n.statusbar.addClass("foot"), n.statusbar.parent(n)), n.on("click", function (e) { -1 != e.target.className.indexOf(n.classPrefix + "close") && n.close() }), n.on("cancel", function () { n.close() }), n.aria("describedby", n.describedBy || n._id + "-none"), n.aria("label", e.title), n._fullscreen = !1 }, recalc: function () { var e = this, t = e.statusbar, r, i, o, a; e._fullscreen && (e.layoutRect(n.getWindowSize()), e.layoutRect().contentH = e.layoutRect().innerH), e._super(), r = e.layoutRect(), e.settings.title && !e._fullscreen && (i = r.headerW, i > r.w && (o = r.x - Math.max(0, i / 2), e.layoutRect({ w: i, x: o }), a = !0)), t && (t.layoutRect({ w: e.layoutRect().innerW }).recalc(), i = t.layoutRect().minW + r.deltaW, i > r.w && (o = r.x - Math.max(0, i - r.w), e.layoutRect({ w: i, x: o }), a = !0)), a && e.recalc() }, initLayoutRect: function () { var e = this, t = e._super(), r = 0, i; if (e.settings.title && !e._fullscreen) { i = e.getEl("head"); var o = n.getSize(i); t.headerW = o.width, t.headerH = o.height, r += t.headerH } e.statusbar && (r += e.statusbar.layoutRect().h), t.deltaH += r, t.minH += r, t.h += r; var a = n.getWindowSize(); return t.x = Math.max(0, a.w / 2 - t.w / 2), t.y = Math.max(0, a.h / 2 - t.h / 2), t }, renderHtml: function () { var e = this, t = e._layout, n = e._id, r = e.classPrefix, i = e.settings, o = "", a = "", s = i.html; return e.preRender(), t.preRender(e), i.title && (o = '<div id="' + n + '-head" class="' + r + 'window-head"><div id="' + n + '-title" class="' + r + 'title">' + e.encode(i.title) + '</div><button type="button" class="' + r + 'close" aria-hidden="true">\xd7</button><div id="' + n + '-dragh" class="' + r + 'dragh"></div></div>'), i.url && (s = '<iframe src="' + i.url + '" tabindex="-1"></iframe>'), "undefined" == typeof s && (s = t.renderHtml(e)), e.statusbar && (a = e.statusbar.renderHtml()), '<div id="' + n + '" class="' + e.classes() + '" hidefocus="1"><div class="' + e.classPrefix + 'reset" role="application">' + o + '<div id="' + n + '-body" class="' + e.classes("body") + '">' + s + "</div>" + a + "</div></div>" }, fullscreen: function (e) { var t = this, r = document.documentElement, i, o = t.classPrefix, a; if (e != t._fullscreen) if (n.on(window, "resize", function () { var e; if (t._fullscreen) if (i) t._timer || (t._timer = setTimeout(function () { var e = n.getWindowSize(); t.moveTo(0, 0).resizeTo(e.w, e.h), t._timer = 0 }, 50)); else { e = (new Date).getTime(); var r = n.getWindowSize(); t.moveTo(0, 0).resizeTo(r.w, r.h), (new Date).getTime() - e > 50 && (i = !0) } }), a = t.layoutRect(), t._fullscreen = e, e) { t._initial = { x: a.x, y: a.y, w: a.w, h: a.h }, t._borderBox = t.parseBox("0"), t.getEl("head").style.display = "none", a.deltaH -= a.headerH + 2, n.addClass(r, o + "fullscreen"), n.addClass(document.body, o + "fullscreen"), t.addClass("fullscreen"); var s = n.getWindowSize(); t.moveTo(0, 0).resizeTo(s.w, s.h) } else t._borderBox = t.parseBox(t.settings.border), t.getEl("head").style.display = "", a.deltaH += a.headerH, n.removeClass(r, o + "fullscreen"), n.removeClass(document.body, o + "fullscreen"), t.removeClass("fullscreen"), t.moveTo(t._initial.x, t._initial.y).resizeTo(t._initial.w, t._initial.h); return t.reflow() }, postRender: function () { var e = this, t; setTimeout(function () { e.addClass("in") }, 0), e._super(), e.statusbar && e.statusbar.postRender(), e.focus(), this.dragHelper = new r(e._id + "-dragh", { start: function () { t = { x: e.layoutRect().x, y: e.layoutRect().y} }, drag: function (n) { e.moveTo(t.x + n.deltaX, t.y + n.deltaY) } }), e.on("submit", function (t) { t.isDefaultPrevented() || e.close() }) }, submit: function () { return this.fire("submit", { data: this.toJSON() }) }, remove: function () { var e = this, t = e.classPrefix; e.dragHelper.destroy(), e._super(), e.statusbar && this.statusbar.remove(), e._fullscreen && (n.removeClass(document.documentElement, t + "fullscreen"), n.removeClass(document.body, t + "fullscreen")) }, getContentWindow: function () { var e = this.getEl().getElementsByTagName("iframe")[0]; return e ? e.contentWindow : null } }); return i }), r(ot, [it], function (e) { var t = e.extend({ init: function (e) { e = { border: 1, padding: 20, layout: "flex", pack: "center", align: "center", containerCls: "panel", autoScroll: !0, buttons: { type: "button", text: "Ok", action: "ok" }, items: { type: "label", multiline: !0, maxWidth: 500, maxHeight: 200} }, this._super(e) }, Statics: { OK: 1, OK_CANCEL: 2, YES_NO: 3, YES_NO_CANCEL: 4, msgBox: function (n) { function r(e, t, n) { return { type: "button", text: e, subtype: n ? "primary" : "", onClick: function (e) { e.control.parents()[1].close(), o(t) } } } var i, o = n.callback || function () { }; switch (n.buttons) { case t.OK_CANCEL: i = [r("Ok", !0, !0), r("Cancel", !1)]; break; case t.YES_NO: case t.YES_NO_CANCEL: i = [r("Yes", 1, !0), r("No", 0)], n.buttons == t.YES_NO_CANCEL && i.push(r("Cancel", -1)); break; default: i = [r("Ok", !0, !0)] } return new e({ padding: 20, x: n.x, y: n.y, minWidth: 300, minHeight: 100, layout: "flex", pack: "center", align: "center", buttons: i, title: n.title, role: "alertdialog", items: { type: "label", multiline: !0, maxWidth: 500, maxHeight: 200, text: n.text }, onPostRender: function () { this.aria("describedby", this.items()[0]._id) }, onClose: n.onClose, onCancel: function () { o(!1) } }).renderTo(document.body).reflow() }, alert: function (e, n) { return "string" == typeof e && (e = { text: e }), e.callback = n, t.msgBox(e) }, confirm: function (e, n) { return "string" == typeof e && (e = { text: e }), e.callback = n, e.buttons = t.OK_CANCEL, t.msgBox(e) } } }); return t }), r(at, [it, ot], function (e, t) { return function (n) { function r() { return o.length ? o[o.length - 1] : void 0 } var i = this, o = []; i.windows = o, n.on("remove", function () { for (var e = o.length; e--; ) o[e].close() }), i.open = function (t, r) { var i; return n.editorManager.setActive(n), t.title = t.title || " ", t.url = t.url || t.file, t.url && (t.width = parseInt(t.width || 320, 10), t.height = parseInt(t.height || 240, 10)), t.body && (t.items = { defaults: t.defaults, type: t.bodyType || "form", items: t.body }), t.url || t.buttons || (t.buttons = [{ text: "Ok", subtype: "primary", onclick: function () { i.find("form")[0].submit() } }, { text: "Cancel", onclick: function () { i.close() } }]), i = new e(t), o.push(i), i.on("close", function () { for (var e = o.length; e--; ) o[e] === i && o.splice(e, 1); o.length || n.focus() }), t.data && i.on("postRender", function () { this.find("*").each(function (e) { var n = e.name(); n in t.data && e.value(t.data[n]) }) }), i.features = t || {}, i.params = r || {}, 1 === o.length && n.nodeChanged(), i.renderTo().reflow() }, i.alert = function (e, r, i) { t.alert(e, function () { r ? r.call(i || this) : n.focus() }) }, i.confirm = function (e, n, r) { t.confirm(e, function (e) { n.call(r || this, e) }) }, i.close = function () { r() && r().close() }, i.getParams = function () { return r() ? r().params : null }, i.setParams = function (e) { r() && (r().params = e) }, i.getWindows = function () { return o } } }), r(st, [B, x, _, g, d, u], function (e, t, n, r, i, o) { return function (a) { function s(e, t) { try { a.getDoc().execCommand(e, !1, t) } catch (n) { } } function l() { var e = a.getDoc().documentMode; return e ? e : 6 } function c(e) { return e.isDefaultPrevented() } function u() { function t(e) { var t = new i(function () { }); o.each(a.getBody().getElementsByTagName("*"), function (e) { "SPAN" == e.tagName && e.setAttribute("mce-data-marked", 1), !e.hasAttribute("data-mce-style") && e.hasAttribute("style") && a.dom.setAttrib(e, "style", a.dom.getAttrib(e, "style")) }), t.observe(a.getDoc(), { childList: !0, attributes: !0, subtree: !0, attributeFilter: ["style"] }), a.getDoc().execCommand(e ? "ForwardDelete" : "Delete", !1, null); var n = a.selection.getRng(), r = n.startContainer.parentNode; o.each(t.takeRecords(), function (e) { if (q.isChildOf(e.target, a.getBody())) { if ("style" == e.attributeName) { var t = e.target.getAttribute("data-mce-style"); t ? e.target.setAttribute("style", t) : e.target.removeAttribute("style") } o.each(e.addedNodes, function (e) { if ("SPAN" == e.nodeName && !e.getAttribute("mce-data-marked")) { var t, i; e == r && (t = n.startOffset, i = e.firstChild), q.remove(e, !0), i && (n.setStart(i, t), n.setEnd(i, t), a.selection.setRng(n)) } }) } }), t.disconnect(), o.each(a.dom.select("span[mce-data-marked]"), function (e) { e.removeAttribute("mce-data-marked") }) } var n = a.getDoc(), r = "data:text/mce-internal,", i = window.MutationObserver, s, l; i || (s = !0, i = function () { function e(e) { var t = e.relatedNode || e.target; n.push({ target: t, addedNodes: [t] }) } function t(e) { var t = e.relatedNode || e.target; n.push({ target: t, attributeName: e.attrName }) } var n = [], r; this.observe = function (n) { r = n, r.addEventListener("DOMSubtreeModified", e, !1), r.addEventListener("DOMNodeInsertedIntoDocument", e, !1), r.addEventListener("DOMNodeInserted", e, !1), r.addEventListener("DOMAttrModified", t, !1) }, this.disconnect = function () { r.removeEventListener("DOMSubtreeModified", e, !1), r.removeEventListener("DOMNodeInsertedIntoDocument", e, !1), r.removeEventListener("DOMNodeInserted", e, !1), r.removeEventListener("DOMAttrModified", t, !1) }, this.takeRecords = function () { return n } }), a.on("keydown", function (n) { var r = n.keyCode == $, i = e.metaKeyPressed(n); if (!c(n) && (r || n.keyCode == U)) { var o = a.selection.getRng(), s = o.startContainer, l = o.startOffset; if (!i && o.collapsed && 3 == s.nodeType && (r ? l < s.data.length : l > 0)) return; n.preventDefault(), i && a.selection.getSel().modify("extend", r ? "forward" : "backward", "word"), t(r) } }), a.on("keypress", function (n) { c(n) || j.isCollapsed() || !n.charCode || e.metaKeyPressed(n) || (n.preventDefault(), t(!0), a.selection.setContent(String.fromCharCode(n.charCode))) }), a.addCommand("Delete", function () { t() }), a.addCommand("ForwardDelete", function () { t(!0) }), s || (a.on("dragstart", function (e) { var t; a.selection.isCollapsed() && "IMG" == e.target.tagName && j.select(e.target), l = j.getRng(), t = a.selection.getContent(), t.length > 0 && e.dataTransfer.setData("URL", "data:text/mce-internal," + escape(t)) }), a.on("drop", function (e) { if (!c(e)) { var i = e.dataTransfer.getData("URL"); if (!i || -1 == i.indexOf(r) || !n.caretRangeFromPoint) return; i = unescape(i.substr(r.length)), n.caretRangeFromPoint && (e.preventDefault(), window.setTimeout(function () { var r = n.caretRangeFromPoint(e.x, e.y); l && (j.setRng(l), l = null), t(), j.setRng(r), a.insertContent(i) }, 0)) } }), a.on("cut", function (e) { !c(e) && e.clipboardData && (e.preventDefault(), e.clipboardData.clearData(), e.clipboardData.setData("text/html", a.selection.getContent()), e.clipboardData.setData("text/plain", a.selection.getContent({ format: "text" })), t(!0)) })) } function d() { function e(e) { var t = q.create("body"), n = e.cloneContents(); return t.appendChild(n), j.serializer.serialize(t, { format: "html" }) } function n(n) { if (!n.setStart) { if (n.item) return !1; var r = n.duplicate(); return r.moveToElementText(a.getBody()), t.compareRanges(n, r) } var i = e(n), o = q.createRng(); o.selectNode(a.getBody()); var s = e(o); return i === s } a.on("keydown", function (e) { var t = e.keyCode, r, i; if (!c(e) && (t == $ || t == U)) { if (r = a.selection.isCollapsed(), i = a.getBody(), r && !q.isEmpty(i)) return; if (!r && !n(a.selection.getRng())) return; e.preventDefault(), a.setContent(""), i.firstChild && q.isBlock(i.firstChild) ? a.selection.setCursorLocation(i.firstChild, 0) : a.selection.setCursorLocation(i, 0), a.nodeChanged() } }) } function f() { a.shortcuts.add("ctrl+a", null, "SelectAll") } function p() { a.settings.content_editable || (q.bind(a.getDoc(), "focusin", function () { j.setRng(j.getRng()) }), q.bind(a.getDoc(), "mousedown mouseup", function (e) { e.target == a.getDoc().documentElement && (a.getBody().focus(), "mousedown" == e.type ? j.placeCaretAt(e.clientX, e.clientY) : j.setRng(j.getRng())) })) } function h() { a.on("keydown", function (e) { if (!c(e) && e.keyCode === U) { if (!a.getBody().getElementsByTagName("hr").length) return; if (j.isCollapsed() && 0 === j.getRng(!0).startOffset) { var t = j.getNode(), n = t.previousSibling; if ("HR" == t.nodeName) return q.remove(t), void e.preventDefault(); n && n.nodeName && "hr" === n.nodeName.toLowerCase() && (q.remove(n), e.preventDefault()) } } }) } function m() { window.Range.prototype.getClientRects || a.on("mousedown", function (e) { if (!c(e) && "HTML" === e.target.nodeName) { var t = a.getBody(); t.blur(), setTimeout(function () { t.focus() }, 0) } }) } function g() { a.on("click", function (e) { var t = e.target; /^(IMG|HR)$/.test(t.nodeName) && (e.preventDefault(), j.getSel().setBaseAndExtent(t, 0, t, 1), a.nodeChanged()), "A" == t.nodeName && q.hasClass(t, "mce-item-anchor") && (e.preventDefault(), j.select(t)) }) } function v() { function e() { var e = q.getAttribs(j.getStart().cloneNode(!1)); return function () { var t = j.getStart(); t !== a.getBody() && (q.setAttrib(t, "style", null), V(e, function (e) { t.setAttributeNode(e.cloneNode(!0)) })) } } function t() { return !j.isCollapsed() && q.getParent(j.getStart(), q.isBlock) != q.getParent(j.getEnd(), q.isBlock) } a.on("keypress", function (n) { var r; return c(n) || 8 != n.keyCode && 46 != n.keyCode || !t() ? void 0 : (r = e(), a.getDoc().execCommand("delete", !1, null), r(), n.preventDefault(), !1) }), q.bind(a.getDoc(), "cut", function (n) { var r; !c(n) && t() && (r = e(), setTimeout(function () { r() }, 0)) }) } function y() { document.body.setAttribute("role", "application") } function b() { a.on("keydown", function (e) { if (!c(e) && e.keyCode === U && j.isCollapsed() && 0 === j.getRng(!0).startOffset) { var t = j.getNode().previousSibling; if (t && t.nodeName && "table" === t.nodeName.toLowerCase()) return e.preventDefault(), !1 } }) } function C() { l() > 7 || (s("RespectVisibilityInDesign", !0), a.contentStyles.push(".mceHideBrInPre pre br {display: none}"), q.addClass(a.getBody(), "mceHideBrInPre"), K.addNodeFilter("pre", function (e) { for (var t = e.length, r, i, o, a; t--; ) for (r = e[t].getAll("br"), i = r.length; i--; ) o = r[i], a = o.prev, a && 3 === a.type && "\n" != a.value.charAt(a.value - 1) ? a.value += "\n" : o.parent.insert(new n("#text", 3), o, !0).value = "\n" }), G.addNodeFilter("pre", function (e) { for (var t = e.length, n, r, i, o; t--; ) for (n = e[t].getAll("br"), r = n.length; r--; ) i = n[r], o = i.prev, o && 3 == o.type && (o.value = o.value.replace(/\r?\n$/, "")) })) } function x() { q.bind(a.getBody(), "mouseup", function () { var e, t = j.getNode(); "IMG" == t.nodeName && ((e = q.getStyle(t, "width")) && (q.setAttrib(t, "width", e.replace(/[^0-9%]+/g, "")), q.setStyle(t, "width", "")), (e = q.getStyle(t, "height")) && (q.setAttrib(t, "height", e.replace(/[^0-9%]+/g, "")), q.setStyle(t, "height", ""))) }) } function w() { a.on("keydown", function (t) { var n, r, i, o, s; if (!c(t) && t.keyCode == e.BACKSPACE && (n = j.getRng(), r = n.startContainer, i = n.startOffset, o = q.getRoot(), s = r, n.collapsed && 0 === i)) { for (; s && s.parentNode && s.parentNode.firstChild == s && s.parentNode != o; ) s = s.parentNode; "BLOCKQUOTE" === s.tagName && (a.formatter.toggle("blockquote", null, s), n = q.createRng(), n.setStart(r, 0), n.setEnd(r, 0), j.setRng(n)) } }) } function _() { function e() { a._refreshContentEditable(), s("StyleWithCSS", !1), s("enableInlineTableEditing", !1), Y.object_resizing || s("enableObjectResizing", !1) } Y.readonly || a.on("BeforeExecCommand MouseDown", e) } function E() { function e() { V(q.select("a"), function (e) { var t = e.parentNode, n = q.getRoot(); if (t.lastChild === e) { for (; t && !q.isBlock(t); ) { if (t.parentNode.lastChild !== t || t === n) return; t = t.parentNode } q.add(t, "br", { "data-mce-bogus": 1 }) } }) } a.on("SetContent ExecCommand", function (t) { ("setcontent" == t.type || "mceInsertLink" === t.command) && e() }) } function N() { Y.forced_root_block && a.on("init", function () { s("DefaultParagraphSeparator", Y.forced_root_block) }) } function k() { a.on("Undo Redo SetContent", function (e) { e.initial || a.execCommand("mceRepaint") }) } function S() { a.on("keydown", function (e) { var t; c(e) || e.keyCode != U || (t = a.getDoc().selection.createRange(), t && t.item && (e.preventDefault(), a.undoManager.beforeChange(), q.remove(t.item(0)), a.undoManager.add())) }) } function T() { var e; l() >= 10 && (e = "", V("p div h1 h2 h3 h4 h5 h6".split(" "), function (t, n) { e += (n > 0 ? "," : "") + t + ":empty" }), a.contentStyles.push(e + "{padding-right: 1px !important}")) } function R() { l() < 9 && (K.addNodeFilter("noscript", function (e) { for (var t = e.length, n, r; t--; ) n = e[t], r = n.firstChild, r && n.attr("data-mce-innertext", r.value) }), G.addNodeFilter("noscript", function (e) { for (var t = e.length, i, o, a; t--; ) i = e[t], o = e[t].firstChild, o ? o.value = r.decode(o.value) : (a = i.attributes.map["data-mce-innertext"], a && (i.attr("data-mce-innertext", null), o = new n("#text", 3), o.value = a, o.raw = !0, i.append(o))) })) } function A() { function e(e, t) { var n = i.createTextRange(); try { n.moveToPoint(e, t) } catch (r) { n = null } return n } function t(t) { var r; t.button ? (r = e(t.x, t.y), r && (r.compareEndPoints("StartToStart", a) > 0 ? r.setEndPoint("StartToStart", a) : r.setEndPoint("EndToEnd", a), r.select())) : n() } function n() { var e = r.selection.createRange(); a && !e.item && 0 === e.compareEndPoints("StartToEnd", e) && a.select(), q.unbind(r, "mouseup", n), q.unbind(r, "mousemove", t), a = o = 0 } var r = q.doc, i = r.body, o, a, s; r.documentElement.unselectable = !0, q.bind(r, "mousedown contextmenu", function (i) { if ("HTML" === i.target.nodeName) { if (o && n(), s = r.documentElement, s.scrollHeight > s.clientHeight) return; o = 1, a = e(i.x, i.y), a && (q.bind(r, "mouseup", n), q.bind(r, "mousemove", t), q.getRoot().focus(), a.select()) } }) } function B() { a.on("keyup focusin mouseup", function (t) { 65 == t.keyCode && e.metaKeyPressed(t) || j.normalize() }, !0) } function D() { a.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}") } function L() { a.inline || a.on("keydown", function () { document.activeElement == document.body && a.getWin().focus() }) } function H() { a.inline || (a.contentStyles.push("body {min-height: 150px}"), a.on("click", function (e) { "HTML" == e.target.nodeName && (a.getBody().focus(), a.selection.normalize(), a.nodeChanged()) })) } function M() { i.mac && a.on("keydown", function (t) { !e.metaKeyPressed(t) || 37 != t.keyCode && 39 != t.keyCode || (t.preventDefault(), a.selection.getSel().modify("move", 37 == t.keyCode ? "backward" : "forward", "word")) }) } function P() { s("AutoUrlDetect", !1) } function O() { a.inline || a.on("focus blur beforegetcontent", function () { var e = a.dom.create("br"); a.getBody().appendChild(e), e.parentNode.removeChild(e) }, !0) } function I() { a.on("click", function (e) { var t = e.target; do if ("A" === t.tagName) return void e.preventDefault(); while (t = t.parentNode) }), a.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}") } function F() { a.on("touchstart", function (e) { var t, n, r, i; t = e.target, n = (new Date).getTime(), i = e.changedTouches, !i || i.length > 1 || (r = i[0], a.once("touchend", function (e) { var i = e.changedTouches[0], o; (new Date).getTime() - n > 500 || Math.abs(r.clientX - i.clientX) > 5 || Math.abs(r.clientY - i.clientY) > 5 || (o = { target: t }, V("pageX pageY clientX clientY screenX screenY".split(" "), function (e) { o[e] = i[e] }), o = a.fire("click", o), o.isDefaultPrevented() || (a.selection.placeCaretAt(i.clientX, i.clientY), a.nodeChanged())) })) }) } function z() { a.on("init", function () { a.dom.bind(a.getBody(), "submit", function (e) { e.preventDefault() }) }) } function W() { K.addNodeFilter("br", function (e) { for (var t = e.length; t--; ) "Apple-interchange-newline" == e[t].attr("class") && e[t].remove() }) } var V = o.each, U = e.BACKSPACE, $ = e.DELETE, q = a.dom, j = a.selection, Y = a.settings, K = a.parser, G = a.serializer, X = i.gecko, J = i.ie, Q = i.webkit; w(), d(), B(), Q && (u(), p(), g(), N(), z(), b(), W(), F(), i.iOS ? (L(), H(), I()) : f()), J && i.ie < 11 && (h(), y(), C(), x(), S(), T(), R(), A()), i.ie >= 11 && (H(), O(), b()), i.ie && (f(), P()), X && (h(), m(), v(), _(), E(), k(), D(), M(), b()) } }), r(lt, [$], function (e) { function t(t) { return t._eventDispatcher || (t._eventDispatcher = new e({ scope: t, toggleEvent: function (n, r) { e.isNative(n) && t.toggleNativeEvent && t.toggleNativeEvent(n, r) } })), t._eventDispatcher } return { fire: function (e, n, r) { var i = this; if (i.removed && "remove" !== e) return n; if (n = t(i).fire(e, n, r), r !== !1 && i.parent) for (var o = i.parent(); o && !n.isPropagationStopped(); ) o.fire(e, n, !1), o = o.parent(); return n }, on: function (e, n, r) { return t(this).on(e, n, r) }, off: function (e, n) { return t(this).off(e, n) }, once: function (e, n) { return t(this).once(e, n) }, hasEventListeners: function (e) { return t(this).has(e) } } }), r(ct, [lt, y, u], function (e, t, n) { function r(e, t) { return "selectionchange" == t ? e.getDoc() : !e.inline && /^mouse|click|contextmenu|drop|dragover|dragend/.test(t) ? e.getDoc().documentElement : e.settings.event_root ? (e.eventRoot || (e.eventRoot = o.select(e.settings.event_root)[0]), e.eventRoot) : e.getBody() } function i(e, t) { var n = r(e, t), i; if (e.delegates || (e.delegates = {}), !e.delegates[t]) if (e.settings.event_root) { if (a || (a = {}, e.editorManager.on("removeEditor", function () { var t; if (!e.editorManager.activeEditor && a) { for (t in a) e.dom.unbind(r(e, t)); a = null } })), a[t]) return; i = function (n) { for (var r = n.target, i = e.editorManager.editors, a = i.length; a--; ) { var s = i[a].getBody(); (s === r || o.isChildOf(r, s)) && (i[a].hidden || i[a].fire(t, n)) } }, a[t] = i, o.bind(n, t, i) } else i = function (n) { e.hidden || e.fire(t, n) }, o.bind(n, t, i), e.delegates[t] = i } var o = t.DOM, a, s = { bindPendingEventDelegates: function () { var e = this; n.each(e._pendingNativeEvents, function (t) { i(e, t) }) }, toggleNativeEvent: function (e, t) { var n = this; n.settings.readonly || "focus" != e && "blur" != e && (t ? n.initialized ? i(n, e) : n._pendingNativeEvents ? n._pendingNativeEvents.push(e) : n._pendingNativeEvents = [e] : n.initialized && (n.dom.unbind(r(n, e), e, n.delegates[e]), delete n.delegates[e])) }, unbindAllNativeEvents: function () { var e = this, t; if (e.delegates) { for (t in e.delegates) e.dom.unbind(r(e, t), t, e.delegates[t]); delete e.delegates } e.inline || (e.getBody().onload = null, e.dom.unbind(e.getWin()), e.dom.unbind(e.getDoc())), e.dom.unbind(e.getBody()), e.dom.unbind(e.getContainer()) } }; return s = n.extend({}, e, s) }), r(ut, [u, d], function (e, t) { var n = e.each, r = e.explode, i = { f9: 120, f10: 121, f11: 122 }; return function (o) { var a = this, s = {}; o.on("keyup keypress keydown", function (e) { (e.altKey || e.ctrlKey || e.metaKey) && !e.isDefaultPrevented() && n(s, function (n) { var r = t.mac ? e.metaKey : e.ctrlKey; if (n.ctrl == r && n.alt == e.altKey && n.shift == e.shiftKey) return e.keyCode == n.keyCode || e.charCode && e.charCode == n.charCode ? (e.preventDefault(), "keydown" == e.type && n.func.call(n.scope), !0) : void 0 }) }), a.add = function (t, a, l, c) { var u; return u = l, "string" == typeof l ? l = function () { o.execCommand(u, !1, null) } : e.isArray(u) && (l = function () { o.execCommand(u[0], u[1], u[2]) }), n(r(t.toLowerCase()), function (e) { var t = { func: l, scope: c || o, desc: o.translate(a), alt: !1, ctrl: !1, shift: !1 }; n(r(e, "+"), function (e) { switch (e) { case "alt": case "ctrl": case "shift": t[e] = !0; break; default: /^[0-9]{2,}$/.test(e) ? t.keyCode = parseInt(e, 10) : (t.charCode = e.charCodeAt(0), t.keyCode = i[e] || e.toUpperCase().charCodeAt(0)) } }), s[(t.ctrl ? "ctrl" : "") + "," + (t.alt ? "alt" : "") + "," + (t.shift ? "shift" : "") + "," + t.keyCode] = t }), !0 } } }), r(dt, [y, f, C, w, _, R, T, H, O, I, F, z, W, V, b, l, at, E, k, st, d, u, ct, ut], function (e, n, r, i, o, a, s, l, c, u, d, f, p, h, m, g, v, y, b, C, x, w, _, E) { function N(e, t, i) { var o = this, a, s; a = o.documentBaseUrl = i.documentBaseURL, s = i.baseURI, o.settings = t = R({ id: e, theme: "modern", delta_width: 0, delta_height: 0, popup_css: "", plugins: "", document_base_url: a, add_form_submit_trigger: !0, submit_patch: !0, add_unload_trigger: !0, convert_urls: !0, relative_urls: !0, remove_script_host: !0, object_resizing: !0, doctype: "<!DOCTYPE html>", visual: !0, font_size_style_values: "xx-small,x-small,small,medium,large,x-large,xx-large", font_size_legacy_values: "xx-small,small,medium,large,x-large,xx-large,300%", forced_root_block: "p", hidden_input: !0, padd_empty_editor: !0, render_ui: !0, indentation: "30px", inline_styles: !0, convert_fonts_to_spans: !0, indent: "simple", indent_before: "p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist", indent_after: "p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist", validate: !0, entity_encoding: "named", url_converter: o.convertURL, url_converter_scope: o, ie7_compat: !0 }, t), r.language = t.language || "en", r.languageLoad = t.language_load, r.baseURL = i.baseURL, o.id = t.id = e, o.isNotDirty = !0, o.plugins = {}, o.documentBaseURI = new h(t.document_base_url || a, { base_uri: s }), o.baseURI = s, o.contentCSS = [], o.contentStyles = [], o.shortcuts = new E(o), o.execCommands = {}, o.queryStateCommands = {}, o.queryValueCommands = {}, o.loadedCSS = {}, t.target && (o.targetElm = t.target), o.suffix = i.suffix, o.editorManager = i, o.inline = t.inline, i.fire("SetupEditor", o), o.execCallback("setup", o), o.$ = n.overrideDefaults(function () { return { context: o.inline ? o.getBody() : o.getDoc(), element: o.getBody()} }) } var k = e.DOM, S = r.ThemeManager, T = r.PluginManager, R = w.extend, A = w.each, B = w.explode, D = w.inArray, L = w.trim, H = w.resolve, M = g.Event, P = x.gecko, O = x.ie; return N.prototype = { render: function () { function e() { k.unbind(window, "ready", e), n.render() } function t() { var e = m.ScriptLoader; if (r.language && "en" != r.language && !r.language_url && (r.language_url = n.editorManager.baseURL + "/langs/" + r.language + ".js"), r.language_url && e.add(r.language_url), r.theme && "function" != typeof r.theme && "-" != r.theme.charAt(0) && !S.urls[r.theme]) { var t = r.theme_url; t = t ? n.documentBaseURI.toAbsolute(t) : "themes/" + r.theme + "/theme" + o + ".js", S.load(r.theme, t) } w.isArray(r.plugins) && (r.plugins = r.plugins.join(" ")), A(r.external_plugins, function (e, t) { T.load(t, e), r.plugins += " " + t }), A(r.plugins.split(/[ ,]/), function (e) { if (e = L(e), e && !T.urls[e]) if ("-" == e.charAt(0)) { e = e.substr(1, e.length); var t = T.dependencies(e); A(t, function (e) { var t = { prefix: "plugins/", resource: e, suffix: "/plugin" + o + ".js" }; e = T.createUrl(t, e), T.load(e.resource, e) }) } else T.load(e, { prefix: "plugins/", resource: e, suffix: "/plugin" + o + ".js" }) }), e.loadQueue(function () { n.removed || n.init() }) } var n = this, r = n.settings, i = n.id, o = n.suffix; if (!M.domLoaded) return void k.bind(window, "ready", e); if (n.getElement() && x.contentEditable) { r.inline ? n.inline = !0 : (n.orgVisibility = n.getElement().style.visibility, n.getElement().style.visibility = "hidden"); var a = n.getElement().form || k.getParent(i, "form"); a && (n.formElement = a, r.hidden_input && !/TEXTAREA|INPUT/i.test(n.getElement().nodeName) && (k.insertAfter(k.create("input", { type: "hidden", name: i }), i), n.hasHiddenInput = !0), n.formEventDelegate = function (e) { n.fire(e.type, e) }, k.bind(a, "submit reset", n.formEventDelegate), n.on("reset", function () { n.setContent(n.startContent, { format: "raw" }) }), !r.submit_patch || a.submit.nodeType || a.submit.length || a._mceOldSubmit || (a._mceOldSubmit = a.submit, a.submit = function () { return n.editorManager.triggerSave(), n.isNotDirty = !0, a._mceOldSubmit(a) })), n.windowManager = new v(n), "xml" == r.encoding && n.on("GetContent", function (e) { e.save && (e.content = k.encode(e.content)) }), r.add_form_submit_trigger && n.on("submit", function () { n.initialized && n.save() }), r.add_unload_trigger && (n._beforeUnload = function () { !n.initialized || n.destroyed || n.isHidden() || n.save({ format: "raw", no_events: !0, set_dirty: !1 }) }, n.editorManager.on("BeforeUnload", n._beforeUnload)), t() } }, init: function () { function e(n) { var r = T.get(n), i, o; i = T.urls[n] || t.documentBaseUrl.replace(/\/$/, ""), n = L(n), r && -1 === D(m, n) && (A(T.dependencies(n), function (t) { e(t) }), o = new r(t, i, t.$), t.plugins[n] = o, o.init && (o.init(t, i), m.push(n))) } var t = this, n = t.settings, r = t.getElement(), i, o, a, s, l, c, u, d, f, p, h, m = []; if (t.rtl = this.editorManager.i18n.rtl, t.editorManager.add(t), n.aria_label = n.aria_label || k.getAttrib(r, "aria-label", t.getLang("aria.rich_text_area")), n.theme && ("function" != typeof n.theme ? (n.theme = n.theme.replace(/-/, ""), c = S.get(n.theme), t.theme = new c(t, S.urls[n.theme]), t.theme.init && t.theme.init(t, S.urls[n.theme] || t.documentBaseUrl.replace(/\/$/, ""), t.$)) : t.theme = n.theme), A(n.plugins.replace(/\-/g, "").split(/[ ,]/), e), n.render_ui && t.theme && (t.orgDisplay = r.style.display, "function" != typeof n.theme ? (i = n.width || r.style.width || r.offsetWidth, o = n.height || r.style.height || r.offsetHeight, a = n.min_height || 100, p = /^[0-9\.]+(|px)$/i, p.test("" + i) && (i = Math.max(parseInt(i, 10), 100)), p.test("" + o) && (o = Math.max(parseInt(o, 10), a)), l = t.theme.renderUI({ targetNode: r, width: i, height: o, deltaWidth: n.delta_width, deltaHeight: n.delta_height }), n.content_editable || (o = (l.iframeHeight || o) + ("number" == typeof o ? l.deltaHeight || 0 : ""), a > o && (o = a))) : (l = n.theme(t, r), l.editorContainer.nodeType && (l.editorContainer = l.editorContainer.id = l.editorContainer.id || t.id + "_parent"), l.iframeContainer.nodeType && (l.iframeContainer = l.iframeContainer.id = l.iframeContainer.id || t.id + "_iframecontainer"), o = l.iframeHeight || r.offsetHeight), t.editorContainer = l.editorContainer), n.content_css && A(B(n.content_css), function (e) { t.contentCSS.push(t.documentBaseURI.toAbsolute(e)) }), n.content_style && t.contentStyles.push(n.content_style), n.content_editable) return r = s = l = null, t.initContentBody(); for (t.iframeHTML = n.doctype + "<html><head>", n.document_base_url != t.documentBaseUrl && (t.iframeHTML += '<base href="' + t.documentBaseURI.getURI() + '" />'), !x.caretAfter && n.ie7_compat && (t.iframeHTML += '<meta http-equiv="X-UA-Compatible" content="IE=7" />'), t.iframeHTML += '<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />', h = 0; h < t.contentCSS.length; h++) { var g = t.contentCSS[h]; /*t.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+g+'" />',t.loadedCSS[g]=!0*/ } d = n.body_id || "tinymce", -1 != d.indexOf("=") && (d = t.getParam("body_id", "", "hash"), d = d[t.id] || d), f = n.body_class || "", -1 != f.indexOf("=") && (f = t.getParam("body_class", "", "hash"), f = f[t.id] || ""), n.content_security_policy && (t.iframeHTML += '<meta http-equiv="Content-Security-Policy" content="' + n.content_security_policy + '" />'), t.iframeHTML += '</head><body id="' + d + '" class="mce-content-body ' + f + '" data-id="' + t.id + '"><br></body></html>'; var v = 'javascript:(function(){document.open();document.domain="' + document.domain + '";var ed = window.parent.tinymce.get("' + t.id + '");document.write(ed.iframeHTML);document.close();ed.initContentBody(true);})()'; document.domain != location.hostname && (u = v); var y = k.create("iframe", { id: t.id + "_ifr", frameBorder: "0", allowTransparency: "true", title: t.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"), style: { width: "100%", height: o, display: "block"} }); if (y.onload = function () { y.onload = null, t.fire("load") }, k.setAttrib(y, "src", u || 'javascript:""'), t.contentAreaContainer = l.iframeContainer, t.iframeElement = y, s = k.add(l.iframeContainer, y), O) try { t.getDoc() } catch (b) { s.src = u = v } l.editorContainer && (k.get(l.editorContainer).style.display = t.orgDisplay, t.hidden = k.isHidden(l.editorContainer)), t.getElement().style.display = "none", k.setAttrib(t.id, "aria-hidden", !0), u || t.initContentBody(), r = s = l = null }, initContentBody: function (t) { var n = this, r = n.settings, s = n.getElement(), h = n.getDoc(), m, g; r.inline || (n.getElement().style.visibility = n.orgVisibility), t || r.content_editable || (h.open(), h.write(n.iframeHTML), h.close()), r.content_editable && (n.on("remove", function () { var e = this.getBody(); k.removeClass(e, "mce-content-body"), k.removeClass(e, "mce-edit-focus"), k.setAttrib(e, "contentEditable", null) }), k.addClass(s, "mce-content-body"), n.contentDocument = h = r.content_document || document, n.contentWindow = r.content_window || window, n.bodyElement = s, r.content_document = r.content_window = null, r.root_name = s.nodeName.toLowerCase()), m = n.getBody(), m.disabled = !0, r.readonly || (n.inline && "static" == k.getStyle(m, "position", !0) && (m.style.position = "relative"), m.contentEditable = n.getParam("content_editable_state", !0)), m.disabled = !1, n.schema = new y(r), n.dom = new e(h, { keep_values: !0, url_converter: n.convertURL, url_converter_scope: n, hex_colors: r.force_hex_style_colors, class_filter: r.class_filter, update_styles: !0, root_element: n.inline ? n.getBody() : null, collect: r.content_editable, schema: n.schema, onSetAttrib: function (e) { n.fire("SetAttrib", e) } }), n.parser = new b(r, n.schema), n.parser.addAttributeFilter("src,href,style,tabindex", function (e, t) { for (var r = e.length, i, o = n.dom, a, s; r--; ) i = e[r], a = i.attr(t), s = "data-mce-" + t, i.attributes.map[s] || ("style" === t ? (a = o.serializeStyle(o.parseStyle(a), i.name), a.length || (a = null), i.attr(s, a), i.attr(t, a)) : "tabindex" === t ? (i.attr(s, a), i.attr(t, null)) : i.attr(s, n.convertURL(a, t, i.name))) }), n.parser.addNodeFilter("script", function (e) { for (var t = e.length, n; t--; ) n = e[t], n.attr("type", "mce-" + (n.attr("type") || "no/type")) }), n.parser.addNodeFilter("#cdata", function (e) { for (var t = e.length, n; t--; ) n = e[t], n.type = 8, n.name = "#comment", n.value = "[CDATA[" + n.value + "]]" }), n.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div", function (e) { for (var t = e.length, r, i = n.schema.getNonEmptyElements(); t--; ) r = e[t], r.isEmpty(i) && (r.append(new o("br", 1)).shortEnded = !0) }), n.serializer = new a(r, n), n.selection = new l(n.dom, n.getWin(), n.serializer, n), n.formatter = new c(n), n.undoManager = new u(n), n.forceBlocks = new f(n), n.enterKey = new d(n), n.editorCommands = new p(n), n._nodeChangeDispatcher = new i(n), n.fire("PreInit"), r.browser_spellcheck || r.gecko_spellcheck || (h.body.spellcheck = !1, k.setAttrib(m, "spellcheck", "false")), n.fire("PostRender"), n.quirks = new C(n), r.directionality && (m.dir = r.directionality), r.nowrap && (m.style.whiteSpace = "nowrap"), r.protect && n.on("BeforeSetContent", function (e) { A(r.protect, function (t) { e.content = e.content.replace(t, function (e) { return "<!--mce:protected " + escape(e) + "-->" }) }) }), n.on("SetContent", function () { n.addVisual(n.getBody()) }), r.padd_empty_editor && n.on("PostProcess", function (e) { e.content = e.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/, "") }), n.load({ initial: !0, format: "html" }), n.startContent = n.getContent({ format: "raw" }), n.initialized = !0, n.bindPendingEventDelegates(), n.fire("init"), n.focus(!0), n.nodeChanged({ initial: !0 }), n.execCallback("init_instance_callback", n), n.contentStyles.length > 0 && (g = "", A(n.contentStyles, function (e) { g += e + "\r\n" }), n.dom.addStyle(g)), A(n.contentCSS, function (e) { n.loadedCSS[e] || (/*n.dom.loadCSS(e)*/true, n.loadedCSS[e] = !0) }), r.auto_focus && setTimeout(function () { var e; e = r.auto_focus === !0 ? n : n.editorManager.get(r.auto_focus), e.focus() }, 100), s = h = m = null }, focus: function (e) { var t = this, n = t.selection, r = t.settings.content_editable, i, o, a = t.getDoc(), s; if (!e) { if (i = n.getRng(), i.item && (o = i.item(0)), t._refreshContentEditable(), r || (x.opera || t.getBody().focus(), t.getWin().focus()), P || r) { if (s = t.getBody(), s.setActive) try { s.setActive() } catch (l) { s.focus() } else s.focus(); r && n.normalize() } o && o.ownerDocument == a && (i = a.body.createControlRange(), i.addElement(o), i.select()) } t.editorManager.setActive(t) }, execCallback: function (e) { var t = this, n = t.settings[e], r; if (n) return t.callbackLookup && (r = t.callbackLookup[e]) && (n = r.func, r = r.scope), "string" == typeof n && (r = n.replace(/\.\w+$/, ""), r = r ? H(r) : 0, n = H(n), t.callbackLookup = t.callbackLookup || {}, t.callbackLookup[e] = { func: n, scope: r }), n.apply(r || t, Array.prototype.slice.call(arguments, 1)) }, translate: function (e) { var t = this.settings.language || "en", n = this.editorManager.i18n; return e ? n.data[t + "." + e] || e.replace(/\{\#([^\}]+)\}/g, function (e, r) { return n.data[t + "." + r] || "{#" + r + "}" }) : "" }, getLang: function (e, n) { return this.editorManager.i18n.data[(this.settings.language || "en") + "." + e] || (n !== t ? n : "{#" + e + "}") }, getParam: function (e, t, n) { var r = e in this.settings ? this.settings[e] : t, i; return "hash" === n ? (i = {}, "string" == typeof r ? A(r.split(r.indexOf("=") > 0 ? /[;,](?![^=;,]*(?:[;,]|$))/ : ","), function (e) { e = e.split("="), i[L(e[0])] = L(e.length > 1 ? e[1] : e) }) : i = r, i) : r }, nodeChanged: function (e) { this._nodeChangeDispatcher.nodeChanged(e) }, addButton: function (e, t) { var n = this; t.cmd && (t.onclick = function () { n.execCommand(t.cmd) }), t.text || t.icon || (t.icon = e), n.buttons = n.buttons || {}, t.tooltip = t.tooltip || t.title, n.buttons[e] = t }, addMenuItem: function (e, t) { var n = this; t.cmd && (t.onclick = function () { n.execCommand(t.cmd) }), n.menuItems = n.menuItems || {}, n.menuItems[e] = t }, addCommand: function (e, t, n) { this.execCommands[e] = { func: t, scope: n || this} }, addQueryStateHandler: function (e, t, n) { this.queryStateCommands[e] = { func: t, scope: n || this} }, addQueryValueHandler: function (e, t, n) { this.queryValueCommands[e] = { func: t, scope: n || this} }, addShortcut: function (e, t, n, r) { this.shortcuts.add(e, t, n, r) }, execCommand: function (e, t, n, r) { var i = this, o = 0, a; if (/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e) || r && r.skip_focus || i.focus(), r = R({}, r), r = i.fire("BeforeExecCommand", { command: e, ui: t, value: n }), r.isDefaultPrevented()) return !1; if ((a = i.execCommands[e]) && a.func.call(a.scope, t, n) !== !0) return i.fire("ExecCommand", { command: e, ui: t, value: n }), !0; if (A(i.plugins, function (r) { return r.execCommand && r.execCommand(e, t, n) ? (i.fire("ExecCommand", { command: e, ui: t, value: n }), o = !0, !1) : void 0 }), o) return o; if (i.theme && i.theme.execCommand && i.theme.execCommand(e, t, n)) return i.fire("ExecCommand", { command: e, ui: t, value: n }), !0; if (i.editorCommands.execCommand(e, t, n)) return i.fire("ExecCommand", { command: e, ui: t, value: n }), !0; try { o = i.getDoc().execCommand(e, t, n) } catch (s) { } return o ? (i.fire("ExecCommand", { command: e, ui: t, value: n }), !0) : !1 }, queryCommandState: function (e) { var t = this, n, r; if (!t._isHidden()) { if ((n = t.queryStateCommands[e]) && (r = n.func.call(n.scope), r === !0 || r === !1)) return r; if (r = t.editorCommands.queryCommandState(e), -1 !== r) return r; try { return t.getDoc().queryCommandState(e) } catch (i) { } } }, queryCommandValue: function (e) { var n = this, r, i; if (!n._isHidden()) { if ((r = n.queryValueCommands[e]) && (i = r.func.call(r.scope), i !== !0)) return i; if (i = n.editorCommands.queryCommandValue(e), i !== t) return i; try { return n.getDoc().queryCommandValue(e) } catch (o) { } } }, show: function () { var e = this; e.hidden && (e.hidden = !1, e.inline ? e.getBody().contentEditable = !0 : (k.show(e.getContainer()), k.hide(e.id)), e.load(), e.fire("show")) }, hide: function () { var e = this, t = e.getDoc(); e.hidden || (O && t && !e.inline && t.execCommand("SelectAll"), e.save(), e.inline ? (e.getBody().contentEditable = !1, e == e.editorManager.focusedEditor && (e.editorManager.focusedEditor = null)) : (k.hide(e.getContainer()), k.setStyle(e.id, "display", e.orgDisplay)), e.hidden = !0, e.fire("hide")) }, isHidden: function () { return !!this.hidden }, setProgressState: function (e, t) { this.fire("ProgressState", { state: e, time: t }) }, load: function (e) { var n = this, r = n.getElement(), i; return r ? (e = e || {}, e.load = !0, i = n.setContent(r.value !== t ? r.value : r.innerHTML, e), e.element = r, e.no_events || n.fire("LoadContent", e), e.element = r = null, i) : void 0 }, save: function (e) { var t = this, n = t.getElement(), r, i; if (n && t.initialized) return e = e || {}, e.save = !0, e.element = n, r = e.content = t.getContent(e), e.no_events || t.fire("SaveContent", e), r = e.content, /TEXTAREA|INPUT/i.test(n.nodeName) ? n.value = r : (t.inline || (n.innerHTML = r), (i = k.getParent(t.id, "form")) && A(i.elements, function (e) { return e.name == t.id ? (e.value = r, !1) : void 0 })), e.element = n = null, e.set_dirty !== !1 && (t.isNotDirty = !0), r }, setContent: function (e, t) { var n = this, r = n.getBody(), i; return t = t || {}, t.format = t.format || "html", t.set = !0, t.content = e, t.no_events || n.fire("BeforeSetContent", t), e = t.content, 0 === e.length || /^\s+$/.test(e) ? (i = n.settings.forced_root_block, i && n.schema.isValidChild(r.nodeName.toLowerCase(), i.toLowerCase()) ? (e = O && 11 > O ? "" : '<br data-mce-bogus="1">', e = n.dom.createHTML(i, n.settings.forced_root_block_attrs, e)) : O || (e = '<br data-mce-bogus="1">'), n.dom.setHTML(r, e), n.fire("SetContent", t)) : ("raw" !== t.format && (e = new s({}, n.schema).serialize(n.parser.parse(e, { isRootContent: !0 }))), t.content = L(e), n.dom.setHTML(r, t.content), t.no_events || n.fire("SetContent", t)), t.content }, getContent: function (e) { var t = this, n, r = t.getBody(); return e = e || {}, e.format = e.format || "html", e.get = !0, e.getInner = !0, e.no_events || t.fire("BeforeGetContent", e), n = "raw" == e.format ? r.innerHTML : "text" == e.format ? r.innerText || r.textContent : t.serializer.serialize(r, e), e.content = "text" != e.format ? L(n) : n, e.no_events || t.fire("GetContent", e), e.content }, insertContent: function (e, t) { t && (e = R({ content: e }, t)), this.execCommand("mceInsertContent", !1, e) }, isDirty: function () { return !this.isNotDirty }, getContainer: function () { var e = this; return e.container || (e.container = k.get(e.editorContainer || e.id + "_parent")), e.container }, getContentAreaContainer: function () { return this.contentAreaContainer }, getElement: function () { return this.targetElm || (this.targetElm = k.get(this.id)), this.targetElm }, getWin: function () { var e = this, t; return e.contentWindow || (t = e.iframeElement, t && (e.contentWindow = t.contentWindow)), e.contentWindow }, getDoc: function () { var e = this, t; return e.contentDocument || (t = e.getWin(), t && (e.contentDocument = t.document)), e.contentDocument }, getBody: function () { return this.bodyElement || this.getDoc().body }, convertURL: function (e, t, n) { var r = this, i = r.settings; return i.urlconverter_callback ? r.execCallback("urlconverter_callback", e, n, !0, t) : !i.convert_urls || n && "LINK" == n.nodeName || 0 === e.indexOf("file:") || 0 === e.length ? e : i.relative_urls ? r.documentBaseURI.toRelative(e) : e = r.documentBaseURI.toAbsolute(e, i.remove_script_host) }, addVisual: function (e) { var n = this, r = n.settings, i = n.dom, o; e = e || n.getBody(), n.hasVisual === t && (n.hasVisual = r.visual), A(i.select("table,a", e), function (e) { var t; switch (e.nodeName) { case "TABLE": return o = r.visual_table_class || "mce-item-table", t = i.getAttrib(e, "border"), void (t && "0" != t || !n.hasVisual ? i.removeClass(e, o) : i.addClass(e, o)); case "A": return void (i.getAttrib(e, "href", !1) || (t = i.getAttrib(e, "name") || e.id, o = r.visual_anchor_class || "mce-item-anchor", t && n.hasVisual ? i.addClass(e, o) : i.removeClass(e, o))) } }), n.fire("VisualAid", { element: e, hasVisual: n.hasVisual }) }, remove: function () { var e = this; e.removed || (e.save(), e.removed = 1, e.unbindAllNativeEvents(), e.hasHiddenInput && k.remove(e.getElement().nextSibling), e.inline || (O && 10 > O && e.getDoc().execCommand("SelectAll", !1, null), k.setStyle(e.id, "display", e.orgDisplay), e.getBody().onload = null), e.fire("remove"), e.editorManager.remove(e), k.remove(e.getContainer()), e.destroy()) }, destroy: function (e) { var t = this, n; if (!t.destroyed) { if (!e && !t.removed) return void t.remove(); e || (t.editorManager.off("beforeunload", t._beforeUnload), t.theme && t.theme.destroy && t.theme.destroy(), t.selection.destroy(), t.dom.destroy()), n = t.formElement, n && (n._mceOldSubmit && (n.submit = n._mceOldSubmit, n._mceOldSubmit = null), k.unbind(n, "submit reset", t.formEventDelegate)), t.contentAreaContainer = t.formElement = t.container = t.editorContainer = null, t.bodyElement = t.contentDocument = t.contentWindow = null, t.iframeElement = t.targetElm = null, t.selection && (t.selection = t.selection.win = t.selection.dom = t.selection.dom.doc = null), t.destroyed = 1 } }, _refreshContentEditable: function () { var e = this, t, n; e._isHidden() && (t = e.getBody(), n = t.parentNode, n.removeChild(t), n.appendChild(t), t.focus()) }, _isHidden: function () { var e; return P ? (e = this.selection.getSel(), !e || !e.rangeCount || 0 === e.rangeCount) : 0 } }, R(N.prototype, _), N }), r(ft, [], function () { var e = {}; return { rtl: !1, add: function (t, n) { for (var r in n) e[r] = n[r]; this.rtl = this.rtl || "rtl" === e._dir }, translate: function (t) { if ("undefined" == typeof t) return t; if ("string" != typeof t && t.raw) return t.raw; if (t.push) { var n = t.slice(1); t = (e[t[0]] || t[0]).replace(/\{([^\}]+)\}/g, function (e, t) { return n[t] }) } return e[t] || t }, data: e} }), r(pt, [y, d], function (e, t) { function n(e) { function s() { try { return document.activeElement } catch (e) { return document.body } } function l(e, t) { if (t && t.startContainer) { if (!e.isChildOf(t.startContainer, e.getRoot()) || !e.isChildOf(t.endContainer, e.getRoot())) return; return { startContainer: t.startContainer, startOffset: t.startOffset, endContainer: t.endContainer, endOffset: t.endOffset} } return t } function c(e, t) { var n; return t.startContainer ? (n = e.getDoc().createRange(), n.setStart(t.startContainer, t.startOffset), n.setEnd(t.endContainer, t.endOffset)) : n = t, n } function u(e) { return !!a.getParent(e, n.isEditorUIElement) } function d(n) { var d = n.editor; d.on("init", function () { (d.inline || t.ie) && ("onbeforedeactivate" in document && t.ie < 9 ? d.dom.bind(d.getBody(), "beforedeactivate", function (e) { if (e.target == d.getBody()) try { d.lastRng = d.selection.getRng() } catch (t) { } }) : d.on("nodechange mouseup keyup", function (e) { var t = s(); "nodechange" == e.type && e.selectionChange || (t && t.id == d.id + "_ifr" && (t = d.getBody()), d.dom.isChildOf(t, d.getBody()) && (d.lastRng = d.selection.getRng())) }), t.webkit && !r && (r = function () { var t = e.activeEditor; if (t && t.selection) { var n = t.selection.getRng(); n && !n.collapsed && (d.lastRng = n) } }, a.bind(document, "selectionchange", r))) }), d.on("setcontent", function () { d.lastRng = null }), d.on("mousedown", function () { d.selection.lastFocusBookmark = null }), d.on("focusin", function () { var t = e.focusedEditor; d.selection.lastFocusBookmark && (d.selection.setRng(c(d, d.selection.lastFocusBookmark)), d.selection.lastFocusBookmark = null), t != d && (t && t.fire("blur", { focusedEditor: d }), e.setActive(d), e.focusedEditor = d, d.fire("focus", { blurredEditor: t }), d.focus(!0)), d.lastRng = null }), d.on("focusout", function () { window.setTimeout(function () { var t = e.focusedEditor; u(s()) || t != d || (d.fire("blur", { focusedEditor: null }), e.focusedEditor = null, d.selection && (d.selection.lastFocusBookmark = null)) }, 0) }), i || (i = function (t) { var n = e.activeEditor; n && t.target.ownerDocument == document && (n.selection && t.target != n.getBody() && (n.selection.lastFocusBookmark = l(n.dom, n.lastRng)), t.target == document.body || u(t.target) || e.focusedEditor != n || (n.fire("blur", { focusedEditor: null }), e.focusedEditor = null)) }, a.bind(document, "focusin", i)), d.inline && !o && (o = function (t) { var n = e.activeEditor; if (n.inline && !n.dom.isChildOf(t.target, n.getBody())) { var r = n.selection.getRng(); r.collapsed || (n.lastRng = r) } }, a.bind(document, "mouseup", o)) } function f(t) { e.focusedEditor == t.editor && (e.focusedEditor = null), e.activeEditor || (a.unbind(document, "selectionchange", r), a.unbind(document, "focusin", i), a.unbind(document, "mouseup", o), r = i = o = null) } e.on("AddEditor", d), e.on("RemoveEditor", f) } var r, i, o, a = e.DOM; return n.isEditorUIElement = function (e) { return -1 !== e.className.toString().indexOf("mce-") }, n }), r(ht, [dt, f, y, V, d, u, lt, ft, pt], function (e, t, n, r, i, o, a, s, l) { function c(e) { var t = v.editors, n; delete t[e.id]; for (var r = 0; r < t.length; r++) if (t[r] == e) { t.splice(r, 1), n = !0; break } return v.activeEditor == e && (v.activeEditor = t[0]), v.focusedEditor == e && (v.focusedEditor = null), n } function u(e) { return e && !(e.getContainer() || e.getBody()).parentNode && (c(e), e.unbindAllNativeEvents(), e.destroy(!0), e = null), e } var d = n.DOM, f = o.explode, p = o.each, h = o.extend, m = 0, g, v; return v = { $: t, majorVersion: "4", minorVersion: "1.6", releaseDate: "2014-10-08", editors: [], i18n: s, activeEditor: null, setup: function () { var e = this, t, n, i = "", o, a; if (n = document.location.href, /^[^:]+:\/\/\/?[^\/]+\//.test(n) && (n = n.replace(/[\?#].*$/, "").replace(/[\/\\][^\/]+$/, ""), /[\/\\]$/.test(n) || (n += "/")), o = window.tinymce || window.tinyMCEPreInit) t = o.base || o.baseURL, i = o.suffix; else { for (var s = document.getElementsByTagName("script"), c = 0; c < s.length; c++) if (a = s[c].src, /tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(a)) { -1 != a.indexOf(".min") && (i = ".min"), t = a.substring(0, a.lastIndexOf("/")); break } !t && document.currentScript && (a = document.currentScript.src, -1 != a.indexOf(".min") && (i = ".min"), t = a.substring(0, a.lastIndexOf("/"))) } e.baseURL = new r(n).toAbsolute(t), e.documentBaseURL = n, e.baseURI = new r(e.baseURL), e.suffix = i, e.focusManager = new l(e) }, init: function (t) { function n(e) { var t = e.id; return t || (t = e.name, t = t && !d.get(t) ? e.name : d.uniqueId(), e.setAttribute("id", t)), t } function r(t, n, r) { if (!u(s.get(t))) { var i = new e(t, n, s); i.targetElm = i.targetElm || r, l.push(i), i.render() } } function i(e) { var n = t[e]; if (n) return n.apply(s, Array.prototype.slice.call(arguments, 2)) } function o(e, t) { return t.constructor === RegExp ? t.test(e.className) : d.hasClass(e, t) } function a() { var e, s; if (d.unbind(window, "ready", a), i("onpageload"), t.types) return void p(t.types, function (e) { p(d.select(e.selector), function (i) { r(n(i), h({}, t, e), i) }) }); if (t.selector) return void p(d.select(t.selector), function (e) { r(n(e), t, e) }); switch (t.target && r(n(t.target), t), t.mode) { case "exact": e = t.elements || "", e.length > 0 && p(f(e), function (e) { var n; (n = d.get(e)) ? r(e, t, n) : p(document.forms, function (n) { p(n.elements, function (n) { n.name === e && (e = "mce_editor_" + m++, d.setAttrib(n, "id", e), r(e, t, n)) }) }) }); break; case "textareas": case "specific_textareas": p(d.select("textarea"), function (e) { t.editor_deselector && o(e, t.editor_deselector) || (!t.editor_selector || o(e, t.editor_selector)) && r(n(e), t, e) }) } t.oninit && (e = s = 0, p(l, function (t) { s++, t.initialized ? e++ : t.on("init", function () { e++, e == s && i("oninit") }), e == s && i("oninit") })) } var s = this, l = []; s.settings = t, d.bind(window, "ready", a) }, get: function (e) { return arguments.length ? e in this.editors ? this.editors[e] : null : this.editors }, add: function (e) { var t = this, n = t.editors; return n[e.id] = e, n.push(e), t.activeEditor = e, t.fire("AddEditor", { editor: e }), g || (g = function () { t.fire("BeforeUnload") }, d.bind(window, "beforeunload", g)), e }, createEditor: function (t, n) { return this.add(new e(t, n, this)) }, remove: function (e) { var t = this, n, r = t.editors, i; { if (e) return "string" == typeof e ? (e = e.selector || e, void p(d.select(e), function (e) { i = r[e.id], i && t.remove(i) })) : (i = e, r[i.id] ? (c(i) && t.fire("RemoveEditor", { editor: i }), r.length || d.unbind(window, "beforeunload", g), i.remove(), i) : null); for (n = r.length - 1; n >= 0; n--) t.remove(r[n]) } }, execCommand: function (t, n, r) { var i = this, o = i.get(r); switch (t) { case "mceAddEditor": return i.get(r) || new e(r, i.settings, i).render(), !0; case "mceRemoveEditor": return o && o.remove(), !0; case "mceToggleEditor": return o ? (o.isHidden() ? o.show() : o.hide(), !0) : (i.execCommand("mceAddEditor", 0, r), !0) } return i.activeEditor ? i.activeEditor.execCommand(t, n, r) : !1 }, triggerSave: function () { p(this.editors, function (e) { e.save() }) }, addI18n: function (e, t) { s.add(e, t) }, translate: function (e) { return s.translate(e) }, setActive: function (e) { var t = this.activeEditor; this.activeEditor != e && (t && t.fire("deactivate", { relatedTarget: e }), e.fire("activate", { relatedTarget: t })), this.activeEditor = e } }, h(v, a), v.setup(), window.tinymce = window.tinyMCE = v, v }), r(mt, [ht, u], function (e, t) { var n = t.each, r = t.explode; e.on("AddEditor", function (e) { var t = e.editor; t.on("preInit", function () { function e(e, t) { n(t, function (t, n) { t && s.setStyle(e, n, t) }), s.rename(e, "span") } function i(e) { s = t.dom, l.convert_fonts_to_spans && n(s.select("font,u,strike", e.node), function (e) { o[e.nodeName.toLowerCase()](s, e) }) } var o, a, s, l = t.settings; l.inline_styles && (a = r(l.font_size_legacy_values), o = { font: function (t, n) { e(n, { backgroundColor: n.style.backgroundColor, color: n.color, fontFamily: n.face, fontSize: a[parseInt(n.size, 10) - 1] }) }, u: function (t, n) { e(n, { textDecoration: "underline" }) }, strike: function (t, n) { e(n, { textDecoration: "line-through" }) } }, t.on("PreProcess SetContent", i)) }) }) }), r(gt, [lt, u], function (e, t) { var n = { send: function (e) { function t() { !e.async || 4 == r.readyState || i++ > 1e4 ? (e.success && 1e4 > i && 200 == r.status ? e.success.call(e.success_scope, "" + r.responseText, r, e) : e.error && e.error.call(e.error_scope, i > 1e4 ? "TIMED_OUT" : "GENERAL", r, e), r = null) : setTimeout(t, 10) } var r, i = 0; if (e.scope = e.scope || this, e.success_scope = e.success_scope || e.scope, e.error_scope = e.error_scope || e.scope, e.async = e.async === !1 ? !1 : !0, e.data = e.data || "", r = new XMLHttpRequest) { if (r.overrideMimeType && r.overrideMimeType(e.content_type), r.open(e.type || (e.data ? "POST" : "GET"), e.url, e.async), e.crossDomain && (r.withCredentials = !0), e.content_type && r.setRequestHeader("Content-Type", e.content_type), r.setRequestHeader("X-Requested-With", "XMLHttpRequest"), r = n.fire("beforeSend", { xhr: r, settings: e }).xhr, r.send(e.data), !e.async) return t(); setTimeout(t, 10) } } }; return t.extend(n, e), n }), r(vt, [], function () { function e(t, n) { var r, i, o, a; if (n = n || '"', null === t) return "null"; if (o = typeof t, "string" == o) return i = "\bb	t\nn\ff\rr\"\"''\\\\", n + t.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g, function (e, t) { return '"' === n && "'" === e ? e : (r = i.indexOf(t), r + 1 ? "\\" + i.charAt(r + 1) : (e = t.charCodeAt().toString(16), "\\u" + "0000".substring(e.length) + e)) }) + n; if ("object" == o) { if (t.hasOwnProperty && "[object Array]" === Object.prototype.toString.call(t)) { for (r = 0, i = "["; r < t.length; r++) i += (r > 0 ? "," : "") + e(t[r], n); return i + "]" } i = "{"; for (a in t) t.hasOwnProperty(a) && (i += "function" != typeof t[a] ? (i.length > 1 ? "," + n : n) + a + n + ":" + e(t[a], n) : ""); return i + "}" } return "" + t } return { serialize: e, parse: function (e) { try { return window[String.fromCharCode(101) + "val"]("(" + e + ")") } catch (t) { } } } }), r(yt, [vt, gt, u], function (e, t, n) { function r(e) { this.settings = i({}, e), this.count = 0 } var i = n.extend; return r.sendRPC = function (e) { return (new r).send(e) }, r.prototype = { send: function (n) { var r = n.error, o = n.success; n = i(this.settings, n), n.success = function (t, i) { t = e.parse(t), "undefined" == typeof t && (t = { error: "JSON Parse error." }), t.error ? r.call(n.error_scope || n.scope, t.error, i) : o.call(n.success_scope || n.scope, t.result) }, n.error = function (e, t) { r && r.call(n.error_scope || n.scope, e, t) }, n.data = e.serialize({ id: n.id || "c" + this.count++, method: n.method, params: n.params }), n.content_type = "application/json", t.send(n) } }, r }), r(bt, [y], function (e) { return { callbacks: {}, count: 0, send: function (n) { var r = this, i = e.DOM, o = n.count !== t ? n.count : r.count, a = "tinymce_jsonp_" + o; r.callbacks[o] = function (e) { i.remove(a), delete r.callbacks[o], n.callback(e) }, i.add(i.doc.body, "script", { id: a, src: n.url, type: "text/javascript" }), r.count++ } } }), r(Ct, [], function () { function e() { s = []; for (var e in a) s.push(e); i.length = s.length } function n() { function n(e) { var n, r; return r = e !== t ? u + e : i.indexOf(",", u), -1 === r || r > i.length ? null : (n = i.substring(u, r), u = r + 1, n) } var r, i, s, u = 0; if (a = {}, c) { o.load(l), i = o.getAttribute(l) || ""; do { var d = n(); if (null === d) break; if (r = n(parseInt(d, 32) || 0), null !== r) { if (d = n(), null === d) break; s = n(parseInt(d, 32) || 0), r && (a[r] = s) } } while (null !== r); e() } } function r() { var t, n = ""; if (c) { for (var r in a) t = a[r], n += (n ? "," : "") + r.length.toString(32) + "," + r + "," + t.length.toString(32) + "," + t; o.setAttribute(l, n); try { o.save(l) } catch (i) { } e() } } var i, o, a, s, l, c; try { if (window.localStorage) return localStorage } catch (u) { } return l = "tinymce", o = document.documentElement, c = !!o.addBehavior, c && o.addBehavior("#default#userData"), i = { key: function (e) { return s[e] }, getItem: function (e) { return e in a ? a[e] : null }, setItem: function (e, t) { a[e] = "" + t, r() }, removeItem: function (e) { delete a[e], r() }, clear: function () { a = {}, r() } }, n(), i }), r(xt, [y, l, b, C, u, d], function (e, t, n, r, i, o) { var a = window.tinymce; return a.DOM = e.DOM, a.ScriptLoader = n.ScriptLoader, a.PluginManager = r.PluginManager, a.ThemeManager = r.ThemeManager, a.dom = a.dom || {}, a.dom.Event = t.Event, i.each(i, function (e, t) { a[t] = e }), i.each("isOpera isWebKit isIE isGecko isMac".split(" "), function (e) { a[e] = o[e.substr(2).toLowerCase()] }), {} }), r(wt, [U, u], function (e, t) { return e.extend({ Defaults: { firstControlClass: "first", lastControlClass: "last" }, init: function (e) { this.settings = t.extend({}, this.Defaults, e) }, preRender: function (e) { e.addClass(this.settings.containerClass, "body") }, applyClasses: function (e) { var t = this, n = t.settings, r, i, o; r = e.items().filter(":visible"), i = n.firstControlClass, o = n.lastControlClass, r.each(function (e) { e.removeClass(i).removeClass(o), n.controlClass && e.addClass(n.controlClass) }), r.eq(0).addClass(i), r.eq(-1).addClass(o) }, renderHtml: function (e) { var t = this, n = t.settings, r, i = ""; return r = e.items(), r.eq(0).addClass(n.firstControlClass), r.eq(-1).addClass(n.lastControlClass), r.each(function (e) { n.controlClass && e.addClass(n.controlClass), i += e.renderHtml() }), i }, recalc: function () { }, postRender: function () { } }) }), r(_t, [wt], function (e) { return e.extend({ Defaults: { containerClass: "abs-layout", controlClass: "abs-layout-item" }, recalc: function (e) { e.items().filter(":visible").each(function (e) { var t = e.settings; e.layoutRect({ x: t.x, y: t.y, w: t.w, h: t.h }), e.recalc && e.recalc() }) }, renderHtml: function (e) { return '<div id="' + e._id + '-absend" class="' + e.classPrefix + 'abs-end"></div>' + this._super(e) } }) }), r(Et, [K, tt], function (e, t) { return e.extend({ Mixins: [t], Defaults: { classes: "widget tooltip tooltip-n" }, text: function (e) { var t = this; return "undefined" != typeof e ? (t._value = e, t._rendered && (t.getEl().lastChild.innerHTML = t.encode(e)), t) : t._value }, renderHtml: function () { var e = this, t = e.classPrefix; return '<div id="' + e._id + '" class="' + e.classes() + '" role="presentation"><div class="' + t + 'tooltip-arrow"></div><div class="' + t + 'tooltip-inner">' + e.encode(e._text) + "</div></div>" }, repaint: function () { var e = this, t, n; t = e.getEl().style, n = e._layoutRect, t.left = n.x + "px", t.top = n.y + "px", t.zIndex = 131070 } }) }), r(Nt, [K, Et], function (e, t) { var n, r = e.extend({ init: function (e) { var t = this; t._super(e), e = t.settings, t.canFocus = !0, e.tooltip && r.tooltips !== !1 && (t.on("mouseenter", function (n) { var r = t.tooltip().moveTo(-65535); if (n.control == t) { var i = r.text(e.tooltip).show().testMoveRel(t.getEl(), ["bc-tc", "bc-tl", "bc-tr"]); r.toggleClass("tooltip-n", "bc-tc" == i), r.toggleClass("tooltip-nw", "bc-tl" == i), r.toggleClass("tooltip-ne", "bc-tr" == i), r.moveRel(t.getEl(), i) } else r.hide() }), t.on("mouseleave mousedown click", function () { t.tooltip().hide() })), t.aria("label", e.ariaLabel || e.tooltip) }, tooltip: function () { return n || (n = new t({ type: "tooltip" }), n.renderTo()), n }, active: function (e) { var t = this, n; return e !== n && (t.aria("pressed", e), t.toggleClass("active", e)), t._super(e) }, disabled: function (e) { var t = this, n; return e !== n && (t.aria("disabled", e), t.toggleClass("disabled", e)), t._super(e) }, postRender: function () { var e = this, t = e.settings; e._rendered = !0, e._super(), e.parent() || !t.width && !t.height || (e.initLayoutRect(), e.repaint()), t.autofocus && e.focus() }, remove: function () { this._super(), n && (n.remove(), n = null) } }); return r }), r(kt, [Nt], function (e) { return e.extend({ Defaults: { classes: "widget btn", role: "button" }, init: function (e) { var t = this, n; t.on("click mousedown", function (e) { e.preventDefault() }), t._super(e), n = e.size, e.subtype && t.addClass(e.subtype), n && t.addClass("btn-" + n) }, icon: function (e) { var t = this, n = t.classPrefix; if ("undefined" == typeof e) return t.settings.icon; if (t.settings.icon = e, e = e ? n + "ico " + n + "i-" + t.settings.icon : "", t._rendered) { var r = t.getEl().firstChild, i = r.getElementsByTagName("i")[0]; e ? (i && i == r.firstChild || (i = document.createElement("i"), r.insertBefore(i, r.firstChild)), i.className = e) : i && r.removeChild(i), t.text(t._text) } return t }, repaint: function () { var e = this.getEl().firstChild.style; e.width = e.height = "100%", this._super() }, text: function (e) { var t = this; if (t._rendered) { var n = t.getEl().lastChild.lastChild; n && (n.data = t.translate(e)) } return t._super(e) }, renderHtml: function () { var e = this, t = e._id, n = e.classPrefix, r = e.settings.icon, i; return i = e.settings.image, i ? (r = "none", "string" != typeof i && (i = window.getSelection ? i[0] : i[1]), i = " style=\"background-image: url('" + i + "')\"") : i = "", r = e.settings.icon ? n + "ico " + n + "i-" + r : "", '<div id="' + t + '" class="' + e.classes() + '" tabindex="-1" aria-labelledby="' + t + '"><button role="presentation" type="button" tabindex="-1">' + (r ? '<i class="' + r + '"' + i + "></i>" : "") + (e._text ? (r ? "\xa0" : "") + e.encode(e._text) : "") + "</button></div>" } }) }), r(St, [J], function (e) { return e.extend({ Defaults: { defaultType: "button", role: "group" }, renderHtml: function () { var e = this, t = e._layout; return e.addClass("btn-group"), e.preRender(), t.preRender(e), '<div id="' + e._id + '" class="' + e.classes() + '"><div id="' + e._id + '-body">' + (e.settings.html || "") + t.renderHtml(e) + "</div></div>" } }) }), r(Tt, [Nt], function (e) { return e.extend({ Defaults: { classes: "checkbox", role: "checkbox", checked: !1 }, init: function (e) { var t = this; t._super(e), t.on("click mousedown", function (e) { e.preventDefault() }), t.on("click", function (e) { e.preventDefault(), t.disabled() || t.checked(!t.checked()) }), t.checked(t.settings.checked) }, checked: function (e) { var t = this; return "undefined" != typeof e ? (e ? t.addClass("checked") : t.removeClass("checked"), t._checked = e, t.aria("checked", e), t) : t._checked }, value: function (e) { return this.checked(e) }, renderHtml: function () { var e = this, t = e._id, n = e.classPrefix; return '<div id="' + t + '" class="' + e.classes() + '" unselectable="on" aria-labelledby="' + t + '-al" tabindex="-1"><i class="' + n + "ico " + n + 'i-checkbox"></i><span id="' + t + '-al" class="' + n + 'label">' + e.encode(e._text) + "</span></div>" } }) }), r(Rt, [Nt, G, Y], function (e, t, n) { return e.extend({ init: function (e) { var t = this; t._super(e), t.addClass("combobox"), t.subinput = !0, t.ariaTarget = "inp", e = t.settings, e.menu = e.menu || e.values, e.menu && (e.icon = "caret"), t.on("click", function (n) { for (var r = n.target, i = t.getEl(); r && r != i; ) r.id && -1 != r.id.indexOf("-open") && (t.fire("action"), e.menu && (t.showMenu(), n.aria && t.menu.items()[0].focus())), r = r.parentNode }), t.on("keydown", function (e) { "INPUT" == e.target.nodeName && 13 == e.keyCode && t.parents().reverse().each(function (n) { return e.preventDefault(), t.fire("change"), n.hasEventListeners("submit") && n.toJSON ? (n.fire("submit", { data: n.toJSON() }), !1) : void 0 }) }), e.placeholder && (t.addClass("placeholder"), t.on("focusin", function () { t._hasOnChange || (n.on(t.getEl("inp"), "change", function () { t.fire("change") }), t._hasOnChange = !0), t.hasClass("placeholder") && (t.getEl("inp").value = "", t.removeClass("placeholder")) }), t.on("focusout", function () { 0 === t.value().length && (t.getEl("inp").value = e.placeholder, t.addClass("placeholder")) })) }, showMenu: function () { var e = this, n = e.settings, r; e.menu || (r = n.menu || [], r.length ? r = { type: "menu", items: r} : r.type = r.type || "menu", e.menu = t.create(r).parent(e).renderTo(e.getContainerElm()), e.fire("createmenu"), e.menu.reflow(), e.menu.on("cancel", function (t) { t.control === e.menu && e.focus() }), e.menu.on("show hide", function (t) { t.control.items().each(function (t) { t.active(t.value() == e.value()) }) }).fire("show"), e.menu.on("select", function (t) { e.value(t.control.value()) }), e.on("focusin", function (t) { "INPUT" == t.target.tagName.toUpperCase() && e.menu.hide() }), e.aria("expanded", !0)), e.menu.show(), e.menu.layoutRect({ w: e.layoutRect().w }), e.menu.moveRel(e.getEl(), e.isRtl() ? ["br-tr", "tr-br"] : ["bl-tl", "tl-bl"]) }, value: function (e) { var t = this; return "undefined" != typeof e ? (t._value = e, t.removeClass("placeholder"), t._rendered && (t.getEl("inp").value = e), t) : t._rendered ? (e = t.getEl("inp").value, e != t.settings.placeholder ? e : "") : t._value }, disabled: function (e) { var t = this; return t._rendered && "undefined" != typeof e && (t.getEl("inp").disabled = e), t._super(e) }, focus: function () { this.getEl("inp").focus() }, repaint: function () { var e = this, t = e.getEl(), r = e.getEl("open"), i = e.layoutRect(), o, a; o = r ? i.w - n.getSize(r).width - 10 : i.w - 10; var s = document; return s.all && (!s.documentMode || s.documentMode <= 8) && (a = e.layoutRect().h - 2 + "px"), n.css(t.firstChild, { width: o, lineHeight: a }), e._super(), e }, postRender: function () { var e = this; return n.on(this.getEl("inp"), "change", function () { e.fire("change") }), e._super() }, remove: function () { n.off(this.getEl("inp")), this._super() }, renderHtml: function () { var e = this, t = e._id, n = e.settings, r = e.classPrefix, i = n.value || n.placeholder || "", o, a, s = "", l = ""; return "spellcheck" in n && (l += ' spellcheck="' + n.spellcheck + '"'), n.maxLength && (l += ' maxlength="' + n.maxLength + '"'), n.size && (l += ' size="' + n.size + '"'), n.subtype && (l += ' type="' + n.subtype + '"'), e.disabled() && (l += ' disabled="disabled"'), o = n.icon, o && "caret" != o && (o = r + "ico " + r + "i-" + n.icon), a = e._text, (o || a) && (s = '<div id="' + t + '-open" class="' + r + "btn " + r + 'open" tabIndex="-1" role="button"><button id="' + t + '-action" type="button" hidefocus="1" tabindex="-1">' + ("caret" != o ? '<i class="' + o + '"></i>' : '<i class="' + r + 'caret"></i>') + (a ? (o ? " " : "") + a : "") + "</button></div>", e.addClass("has-open")), '<div id="' + t + '" class="' + e.classes() + '"><input id="' + t + '-inp" class="' + r + "textbox " + r + 'placeholder" value="' + i + '" hidefocus="1"' + l + " />" + s + "</div>" } }) }), r(At, [Rt], function (e) { return e.extend({ init: function (e) { var t = this; e.spellcheck = !1, e.onaction && (e.icon = "none"), t._super(e), t.addClass("colorbox"), t.on("change keyup postrender", function () { t.repaintColor(t.value()) }) }, repaintColor: function (e) { var t = this.getEl().getElementsByTagName("i")[0]; if (t) try { t.style.background = e } catch (n) { } }, value: function (e) { var t = this; return "undefined" != typeof e && t._rendered && t.repaintColor(e), t._super(e) } }) }), r(Bt, [kt, rt], function (e, t) { return e.extend({ showPanel: function () { var e = this, n = e.settings; if (e.active(!0), e.panel) e.panel.show(); else { var r = n.panel; r.type && (r = { layout: "grid", items: r }), r.role = r.role || "dialog", r.popover = !0, r.autohide = !0, r.ariaRoot = !0, e.panel = new t(r).on("hide", function () { e.active(!1) }).on("cancel", function (t) { t.stopPropagation(), e.focus(), e.hidePanel() }).parent(e).renderTo(e.getContainerElm()), e.panel.fire("show"), e.panel.reflow() } e.panel.moveRel(e.getEl(), n.popoverAlign || (e.isRtl() ? ["bc-tr", "bc-tc"] : ["bc-tl", "bc-tc"])) }, hidePanel: function () { var e = this; e.panel && e.panel.hide() }, postRender: function () { var e = this; return e.aria("haspopup", !0), e.on("click", function (t) { t.control === e && (e.panel && e.panel.visible() ? e.hidePanel() : (e.showPanel(), e.panel.focus(!!t.aria))) }), e._super() }, remove: function () { return this.panel && (this.panel.remove(), this.panel = null), this._super() } }) }), r(Dt, [Bt, y], function (e, t) { var n = t.DOM; return e.extend({ init: function (e) { this._super(e), this.addClass("colorbutton") }, color: function (e) { return e ? (this._color = e, this.getEl("preview").style.backgroundColor = e, this) : this._color }, renderHtml: function () { var e = this, t = e._id, n = e.classPrefix, r = e.settings.icon ? n + "ico " + n + "i-" + e.settings.icon : "", i = e.settings.image ? " style=\"background-image: url('" + e.settings.image + "')\"" : ""; return '<div id="' + t + '" class="' + e.classes() + '" role="button" tabindex="-1" aria-haspopup="true"><button role="presentation" hidefocus="1" type="button" tabindex="-1">' + (r ? '<i class="' + r + '"' + i + "></i>" : "") + '<span id="' + t + '-preview" class="' + n + 'preview"></span>' + (e._text ? (r ? " " : "") + e._text : "") + '</button><button type="button" class="' + n + 'open" hidefocus="1" tabindex="-1"> <i class="' + n + 'caret"></i></button></div>' }, postRender: function () { var e = this, t = e.settings.onclick; return e.on("click", function (r) { r.aria && "down" == r.aria.key || r.control != e || n.getParent(r.target, "." + e.classPrefix + "open") || (r.stopImmediatePropagation(), t.call(e, r)) }), delete e.settings.onclick, e._super() } }) }), r(Lt, [], function () { function e(e) { function i(e, i, o) { var a, s, l, c, u, d; return a = 0, s = 0, l = 0, e /= 255, i /= 255, o /= 255, u = t(e, t(i, o)), d = n(e, n(i, o)), u == d ? (l = u, { h: 0, s: 0, v: 100 * l }) : (c = e == u ? i - o : o == u ? e - i : o - e, a = e == u ? 3 : o == u ? 1 : 5, a = 60 * (a - c / (d - u)), s = (d - u) / d, l = d, { h: r(a), s: r(100 * s), v: r(100 * l) }) } function o(e, i, o) { var a, s, l, c; if (e = (parseInt(e, 10) || 0) % 360, i = parseInt(i, 10) / 100, o = parseInt(o, 10) / 100, i = n(0, t(i, 1)), o = n(0, t(o, 1)), 0 === i) return void (d = f = p = r(255 * o)); switch (a = e / 60, s = o * i, l = s * (1 - Math.abs(a % 2 - 1)), c = o - s, Math.floor(a)) { case 0: d = s, f = l, p = 0; break; case 1: d = l, f = s, p = 0; break; case 2: d = 0, f = s, p = l; break; case 3: d = 0, f = l, p = s; break; case 4: d = l, f = 0, p = s; break; case 5: d = s, f = 0, p = l; break; default: d = f = p = 0 } d = r(255 * (d + c)), f = r(255 * (f + c)), p = r(255 * (p + c)) } function a() { function e(e) { return e = parseInt(e, 10).toString(16), e.length > 1 ? e : "0" + e } return "#" + e(d) + e(f) + e(p) } function s() { return { r: d, g: f, b: p} } function l() { return i(d, f, p) } function c(e) { var t; return "object" == typeof e ? "r" in e ? (d = e.r, f = e.g, p = e.b) : "v" in e && o(e.h, e.s, e.v) : (t = /rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e)) ? (d = parseInt(t[1], 10), f = parseInt(t[2], 10), p = parseInt(t[3], 10)) : (t = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e)) ? (d = parseInt(t[1], 16), f = parseInt(t[2], 16), p = parseInt(t[3], 16)) : (t = /#([0-F])([0-F])([0-F])/gi.exec(e)) && (d = parseInt(t[1] + t[1], 16), f = parseInt(t[2] + t[2], 16), p = parseInt(t[3] + t[3], 16)), d = 0 > d ? 0 : d > 255 ? 255 : d, f = 0 > f ? 0 : f > 255 ? 255 : f, p = 0 > p ? 0 : p > 255 ? 255 : p, u } var u = this, d = 0, f = 0, p = 0; e && c(e), u.toRgb = s, u.toHsv = l, u.toHex = a, u.parse = c } var t = Math.min, n = Math.max, r = Math.round; return e }), r(Ht, [Nt, Q, Y, Lt], function (e, t, n, r) { return e.extend({ Defaults: { classes: "widget colorpicker" }, init: function (e) { this._super(e) }, postRender: function () { function e(e, t) { var r = n.getPos(e), i, o; return i = t.pageX - r.x, o = t.pageY - r.y, i = Math.max(0, Math.min(i / e.clientWidth, 1)), o = Math.max(0, Math.min(o / e.clientHeight, 1)), { x: i, y: o} } function i(e, t) { var i = (360 - e.h) / 360; n.css(d, { top: 100 * i + "%" }), t || n.css(p, { left: e.s + "%", top: 100 - e.v + "%" }), f.style.background = new r({ s: 100, v: 100, h: e.h }).toHex(), s.color().parse({ s: e.s, v: e.v, h: e.h }) } function o(t) { var n; n = e(f, t), c.s = 100 * n.x, c.v = 100 * (1 - n.y), i(c), s.fire("change") } function a(t) { var n; n = e(u, t), c = l.toHsv(), c.h = 360 * (1 - n.y), i(c, !0), s.fire("change") } var s = this, l = s.color(), c, u, d, f, p; u = s.getEl("h"), d = s.getEl("hp"), f = s.getEl("sv"), p = s.getEl("svp"), s._repaint = function () { c = l.toHsv(), i(c) }, s._super(), s._svdraghelper = new t(s._id + "-sv", { start: o, drag: o }), s._hdraghelper = new t(s._id + "-h", { start: a, drag: a }), s._repaint() }, rgb: function () { return this.color().toRgb() }, value: function (e) { var t = this; return arguments.length ? (t.color().parse(e), void (t._rendered && t._repaint())) : t.color().toHex() }, color: function () { return this._color || (this._color = new r), this._color }, renderHtml: function () { function e() { var e, t, n = "", i, a; for (i = "filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=", a = o.split(","), e = 0, t = a.length - 1; t > e; e++) n += '<div class="' + r + 'colorpicker-h-chunk" style="height:' + 100 / t + "%;" + i + a[e] + ",endColorstr=" + a[e + 1] + ");-ms-" + i + a[e] + ",endColorstr=" + a[e + 1] + ')"></div>'; return n } var t = this, n = t._id, r = t.classPrefix, i, o = "#ff0000,#ff0080,#ff00ff,#8000ff,#0000ff,#0080ff,#00ffff,#00ff80,#00ff00,#80ff00,#ffff00,#ff8000,#ff0000", a = "background: -ms-linear-gradient(top," + o + ");background: linear-gradient(to bottom," + o + ");"; return i = '<div id="' + n + '-h" class="' + r + 'colorpicker-h" style="' + a + '">' + e() + '<div id="' + n + '-hp" class="' + r + 'colorpicker-h-marker"></div></div>', '<div id="' + n + '" class="' + t.classes() + '"><div id="' + n + '-sv" class="' + r + 'colorpicker-sv"><div class="' + r + 'colorpicker-overlay1"><div class="' + r + 'colorpicker-overlay2"><div id="' + n + '-svp" class="' + r + 'colorpicker-selector1"><div class="' + r + 'colorpicker-selector2"></div></div></div></div></div>' + i + "</div>" } }) }), r(Mt, [Nt], function (e) { return e.extend({ init: function (e) { var t = this; e.delimiter || (e.delimiter = "\xbb"), t._super(e), t.addClass("path"), t.canFocus = !0, t.on("click", function (e) { var n, r = e.target; (n = r.getAttribute("data-index")) && t.fire("select", { value: t.data()[n], index: n }) }) }, focus: function () { var e = this; return e.getEl().firstChild.focus(), e }, data: function (e) { var t = this; return "undefined" != typeof e ? (t._data = e, t.update(), t) : t._data }, update: function () { this.innerHtml(this._getPathHtml()) }, postRender: function () { var e = this; e._super(), e.data(e.settings.data) }, renderHtml: function () { var e = this; return '<div id="' + e._id + '" class="' + e.classes() + '">' + e._getPathHtml() + "</div>" }, _getPathHtml: function () { var e = this, t = e._data || [], n, r, i = "", o = e.classPrefix; for (n = 0, r = t.length; r > n; n++) i += (n > 0 ? '<div class="' + o + 'divider" aria-hidden="true"> ' + e.settings.delimiter + " </div>" : "") + '<div role="button" class="' + o + "path-item" + (n == r - 1 ? " " + o + "last" : "") + '" data-index="' + n + '" tabindex="-1" id="' + e._id + "-" + n + '" aria-level="' + n + '">' + t[n].name + "</div>"; return i || (i = '<div class="' + o + 'path-item">\xa0</div>'), i } }) }), r(Pt, [Mt, ht], function (e, t) { return e.extend({ postRender: function () { function e(e) { if (1 === e.nodeType) { if ("BR" == e.nodeName || e.getAttribute("data-mce-bogus")) return !0; if ("bookmark" === e.getAttribute("data-mce-type")) return !0 } return !1 } var n = this, r = t.activeEditor; return n.on("select", function (e) { r.focus(), r.selection.select(this.data()[e.index].element), r.nodeChanged() }), r.on("nodeChange", function (t) { for (var i = [], o = t.parents, a = o.length; a--; ) if (1 == o[a].nodeType && !e(o[a])) { var s = r.fire("ResolveName", { name: o[a].nodeName.toLowerCase(), target: o[a] }); if (s.isDefaultPrevented() || i.push({ name: s.name, element: o[a] }), s.isPropagationStopped()) break } n.data(i) }), n._super() } }) }), r(Ot, [J], function (e) { return e.extend({ Defaults: { layout: "flex", align: "center", defaults: { flex: 1} }, renderHtml: function () { var e = this, t = e._layout, n = e.classPrefix; return e.addClass("formitem"), t.preRender(e), '<div id="' + e._id + '" class="' + e.classes() + '" hidefocus="1" tabindex="-1">' + (e.settings.title ? '<div id="' + e._id + '-title" class="' + n + 'title">' + e.settings.title + "</div>" : "") + '<div id="' + e._id + '-body" class="' + e.classes("body") + '">' + (e.settings.html || "") + t.renderHtml(e) + "</div></div>" } }) }), r(It, [J, Ot, u], function (e, t, n) { return e.extend({ Defaults: { containerCls: "form", layout: "flex", direction: "column", align: "stretch", flex: 1, padding: 20, labelGap: 30, spacing: 10, callbacks: { submit: function () { this.submit() } } }, preRender: function () { var e = this, r = e.items(); e.settings.formItemDefaults || (e.settings.formItemDefaults = { layout: "flex", autoResize: "overflow", defaults: { flex: 1} }), r.each(function (r) { var i, o = r.settings.label; o && (i = new t(n.extend({ items: { type: "label", id: r._id + "-l", text: o, flex: 0, forId: r._id, disabled: r.disabled()} }, e.settings.formItemDefaults)), i.type = "formitem", r.aria("labelledby", r._id + "-l"), "undefined" == typeof r.settings.flex && (r.settings.flex = 1), e.replace(r, i), i.add(r)) }) }, recalcLabels: function () { var e = this, t = 0, n = [], r, i, o; if (e.settings.labelGapCalc !== !1) for (o = "children" == e.settings.labelGapCalc ? e.find("formitem") : e.items(), o.filter("formitem").each(function (e) { var r = e.items()[0], i = r.getEl().clientWidth; t = i > t ? i : t, n.push(r) }), i = e.settings.labelGap || 0, r = n.length; r--; ) n[r].settings.minWidth = t + i }, visible: function (e) { var t = this._super(e); return e === !0 && this._rendered && this.recalcLabels(), t }, submit: function () { return this.fire("submit", { data: this.toJSON() }) }, postRender: function () { var e = this; e._super(), e.recalcLabels(), e.fromJSON(e.settings.data) } }) }), r(Ft, [It], function (e) { return e.extend({ Defaults: { containerCls: "fieldset", layout: "flex", direction: "column", align: "stretch", flex: 1, padding: "25 15 5 15", labelGap: 30, spacing: 10, border: 1 }, renderHtml: function () { var e = this, t = e._layout, n = e.classPrefix; return e.preRender(), t.preRender(e), '<fieldset id="' + e._id + '" class="' + e.classes() + '" hidefocus="1" tabindex="-1">' + (e.settings.title ? '<legend id="' + e._id + '-title" class="' + n + 'fieldset-title">' + e.settings.title + "</legend>" : "") + '<div id="' + e._id + '-body" class="' + e.classes("body") + '">' + (e.settings.html || "") + t.renderHtml(e) + "</div></fieldset>" } }) }), r(zt, [Rt, u], function (e, t) { return e.extend({ init: function (e) { var n = this, r = tinymce.activeEditor, i = r.settings, o, a, s; e.spellcheck = !1, s = i.file_picker_types || i.file_browser_callback_types, s && (s = t.makeMap(s, /[, ]/)), (!s || s[e.filetype]) && (a = i.file_picker_callback, !a || s && !s[e.filetype] ? (a = i.file_browser_callback, !a || s && !s[e.filetype] || (o = function () { a(n.getEl("inp").id, n.value(), e.filetype, window) })) : o = function () { var i = n.fire("beforecall").meta; i = t.extend({ filetype: e.filetype }, i), a.call(r, function (e, t) { n.value(e).fire("change", { meta: t }) }, n.value(), i) }), o && (e.icon = "browse", e.onaction = o), n._super(e) } }) }), r(Wt, [_t], function (e) { return e.extend({ recalc: function (e) { var t = e.layoutRect(), n = e.paddingBox(); e.items().filter(":visible").each(function (e) { e.layoutRect({ x: n.left, y: n.top, w: t.innerW - n.right - n.left, h: t.innerH - n.top - n.bottom }), e.recalc && e.recalc() }) } }) }), r(Vt, [_t], function (e) { return e.extend({ recalc: function (e) { var t, n, r, i, o, a, s, l, c, u, d, f, p, h, m, g, v = [], y, b, C, x, w, _, E, N, k, S, T, R, A, B, D, L, H, M, P, O, I, F, z = Math.max, W = Math.min; for (r = e.items().filter(":visible"), i = e.layoutRect(), o = e._paddingBox, a = e.settings, f = e.isRtl() ? a.direction || "row-reversed" : a.direction, s = a.align, l = e.isRtl() ? a.pack || "end" : a.pack, c = a.spacing || 0, ("row-reversed" == f || "column-reverse" == f) && (r = r.set(r.toArray().reverse()), f = f.split("-")[0]), "column" == f ? (k = "y", E = "h", N = "minH", S = "maxH", R = "innerH", T = "top", A = "deltaH", B = "contentH", P = "left", H = "w", D = "x", L = "innerW", M = "minW", O = "right", I = "deltaW", F = "contentW") : (k = "x", E = "w", N = "minW", S = "maxW", R = "innerW", T = "left", A = "deltaW", B = "contentW", P = "top", H = "h", D = "y", L = "innerH", M = "minH", O = "bottom", I = "deltaH", F = "contentH"), d = i[R] - o[T] - o[T], _ = u = 0, t = 0, n = r.length; n > t; t++) p = r[t], h = p.layoutRect(), m = p.settings, g = m.flex, d -= n - 1 > t ? c : 0, g > 0 && (u += g, h[S] && v.push(p), h.flex = g), d -= h[N], y = o[P] + h[M] + o[O], y > _ && (_ = y); if (x = {}, x[N] = 0 > d ? i[N] - d + i[A] : i[R] - d + i[A], x[M] = _ + i[I], x[B] = i[R] - d, x[F] = _, x.minW = W(x.minW, i.maxW), x.minH = W(x.minH, i.maxH), x.minW = z(x.minW, i.startMinWidth), x.minH = z(x.minH, i.startMinHeight), !i.autoResize || x.minW == i.minW && x.minH == i.minH) { for (C = d / u, t = 0, n = v.length; n > t; t++) p = v[t], h = p.layoutRect(), b = h[S], y = h[N] + h.flex * C, y > b ? (d -= h[S] - h[N], u -= h.flex, h.flex = 0, h.maxFlexSize = b) : h.maxFlexSize = 0; for (C = d / u, w = o[T], x = {}, 0 === u && ("end" == l ? w = d + o[T] : "center" == l ? (w = Math.round(i[R] / 2 - (i[R] - d) / 2) + o[T], 0 > w && (w = o[T])) : "justify" == l && (w = o[T], c = Math.floor(d / (r.length - 1)))), x[D] = o[P], t = 0, n = r.length; n > t; t++) p = r[t], h = p.layoutRect(), y = h.maxFlexSize || h[N], "center" === s ? x[D] = Math.round(i[L] / 2 - h[H] / 2) : "stretch" === s ? (x[H] = z(h[M] || 0, i[L] - o[P] - o[O]), x[D] = o[P]) : "end" === s && (x[D] = i[L] - h[H] - o.top), h.flex > 0 && (y += h.flex * C), x[E] = y, x[k] = w, p.layoutRect(x), p.recalc && p.recalc(), w += y + c } else if (x.w = x.minW, x.h = x.minH, e.layoutRect(x), this.recalc(e), null === e._lastRect) { var V = e.parent(); V && (V._lastRect = null, V.recalc()) } } }) }), r(Ut, [wt], function (e) { return e.extend({ Defaults: { containerClass: "flow-layout", controlClass: "flow-layout-item", endClass: "break" }, recalc: function (e) { e.items().filter(":visible").each(function (e) { e.recalc && e.recalc() }) } }) }), r($t, [K, Nt, rt, u, ht, d], function (e, t, n, r, i, o) { function a(e) { function t(t, n) { return function () { var r = this; e.on("nodeChange", function (i) { var o = e.formatter, a = null; s(i.parents, function (e) { return s(t, function (t) { return n ? o.matchNode(e, n, { value: t.value }) && (a = t.value) : o.matchNode(e, t.value) && (a = t.value), a ? !1 : void 0 }), a ? !1 : void 0 }), r.value(a) }) } } function r(e) { e = e.replace(/;$/, "").split(";"); for (var t = e.length; t--; ) e[t] = e[t].split("="); return e } function i() { function t(e) { var n = []; if (e) return s(e, function (e) { var o = { text: e.title, icon: e.icon }; if (e.items) o.menu = t(e.items); else { var a = e.format || "custom" + r++; e.format || (e.name = a, i.push(e)), o.format = a, o.cmd = e.cmd } n.push(o) }), n } function n() { var n; return n = t(e.settings.style_formats_merge ? e.settings.style_formats ? o.concat(e.settings.style_formats) : o : e.settings.style_formats || o) } var r = 0, i = [], o = [{ title: "Headings", items: [{ title: "Heading 1", format: "h1" }, { title: "Heading 2", format: "h2" }, { title: "Heading 3", format: "h3" }, { title: "Heading 4", format: "h4" }, { title: "Heading 5", format: "h5" }, { title: "Heading 6", format: "h6"}] }, { title: "Inline", items: [{ title: "Bold", icon: "bold", format: "bold" }, { title: "Italic", icon: "italic", format: "italic" }, { title: "Underline", icon: "underline", format: "underline" }, { title: "Strikethrough", icon: "strikethrough", format: "strikethrough" }, { title: "Superscript", icon: "superscript", format: "superscript" }, { title: "Subscript", icon: "subscript", format: "subscript" }, { title: "Code", icon: "code", format: "code"}] }, { title: "Blocks", items: [{ title: "Paragraph", format: "p" }, { title: "Blockquote", format: "blockquote" }, { title: "Div", format: "div" }, { title: "Pre", format: "pre"}] }, { title: "Alignment", items: [{ title: "Left", icon: "alignleft", format: "alignleft" }, { title: "Center", icon: "aligncenter", format: "aligncenter" }, { title: "Right", icon: "alignright", format: "alignright" }, { title: "Justify", icon: "alignjustify", format: "alignjustify"}]}]; return e.on("init", function () { s(i, function (t) { e.formatter.register(t.name, t) }) }), { type: "menu", items: n(), onPostRender: function (t) { e.fire("renderFormatsMenu", { control: t.control }) }, itemDefaults: { preview: !0, textStyle: function () { return this.settings.format ? e.formatter.getCssText(this.settings.format) : void 0 }, onPostRender: function () { var t = this; t.parent().on("show", function () { var n, r; n = t.settings.format, n && (t.disabled(!e.formatter.canApply(n)), t.active(e.formatter.match(n))), r = t.settings.cmd, r && t.active(e.queryCommandState(r)) }) }, onclick: function () { this.settings.format && l(this.settings.format), this.settings.cmd && e.execCommand(this.settings.cmd) } }} } function o(t) { return function () { function n() { return e.undoManager ? e.undoManager[t]() : !1 } var r = this; t = "redo" == t ? "hasRedo" : "hasUndo", r.disabled(!n()), e.on("Undo Redo AddUndo TypingUndo ClearUndos", function () { r.disabled(!n()) }) } } function a() { var t = this; e.on("VisualAid", function (e) { t.active(e.hasVisual) }), t.active(e.hasVisual) } function l(t) { t.control && (t = t.control.value()), t && e.execCommand("mceToggleFormat", !1, t) } var c; c = i(), s({ bold: "Bold", italic: "Italic", underline: "Underline", strikethrough: "Strikethrough", subscript: "Subscript", superscript: "Superscript" }, function (t, n) { e.addButton(n, { tooltip: t, onPostRender: function () { var t = this; e.formatter ? e.formatter.formatChanged(n, function (e) { t.active(e) }) : e.on("init", function () { e.formatter.formatChanged(n, function (e) { t.active(e) }) }) }, onclick: function () { l(n) } }) }), s({ outdent: ["Decrease indent", "Outdent"], indent: ["Increase indent", "Indent"], cut: ["Cut", "Cut"], copy: ["Copy", "Copy"], paste: ["Paste", "Paste"], help: ["Help", "mceHelp"], selectall: ["Select all", "SelectAll"], removeformat: ["Clear formatting", "RemoveFormat"], visualaid: ["Visual aids", "mceToggleVisualAid"], newdocument: ["New document", "mceNewDocument"] }, function (t, n) { e.addButton(n, { tooltip: t[0], cmd: t[1] }) }), s({ blockquote: ["Blockquote", "mceBlockQuote"], numlist: ["Numbered list", "InsertOrderedList"], bullist: ["Bullet list", "InsertUnorderedList"], subscript: ["Subscript", "Subscript"], superscript: ["Superscript", "Superscript"], alignleft: ["Align left", "JustifyLeft"], aligncenter: ["Align center", "JustifyCenter"], alignright: ["Align right", "JustifyRight"], alignjustify: ["Justify", "JustifyFull"] }, function (t, n) { e.addButton(n, { tooltip: t[0], cmd: t[1], onPostRender: function () { var t = this; e.formatter ? e.formatter.formatChanged(n, function (e) { t.active(e) }) : e.on("init", function () { e.formatter.formatChanged(n, function (e) { t.active(e) }) }) } }) }), e.addButton("undo", { tooltip: "Undo", onPostRender: o("undo"), cmd: "undo" }), e.addButton("redo", { tooltip: "Redo", onPostRender: o("redo"), cmd: "redo" }), e.addMenuItem("newdocument", { text: "New document", shortcut: "Ctrl+N", icon: "newdocument", cmd: "mceNewDocument" }), e.addMenuItem("undo", { text: "Undo", icon: "undo", shortcut: "Ctrl+Z", onPostRender: o("undo"), cmd: "undo" }), e.addMenuItem("redo", { text: "Redo", icon: "redo", shortcut: "Ctrl+Y", onPostRender: o("redo"), cmd: "redo" }), e.addMenuItem("visualaid", { text: "Visual aids", selectable: !0, onPostRender: a, cmd: "mceToggleVisualAid" }), s({ cut: ["Cut", "Cut", "Ctrl+X"], copy: ["Copy", "Copy", "Ctrl+C"], paste: ["Paste", "Paste", "Ctrl+V"], selectall: ["Select all", "SelectAll", "Ctrl+A"], bold: ["Bold", "Bold", "Ctrl+B"], italic: ["Italic", "Italic", "Ctrl+I"], underline: ["Underline", "Underline"], strikethrough: ["Strikethrough", "Strikethrough"], subscript: ["Subscript", "Subscript"], superscript: ["Superscript", "Superscript"], removeformat: ["Clear formatting", "RemoveFormat"] }, function (t, n) { e.addMenuItem(n, { text: t[0], icon: n, shortcut: t[2], cmd: t[1] }) }), e.on("mousedown", function () { n.hideAll() }), e.addButton("styleselect", { type: "menubutton", text: "Formats", menu: c }), e.addButton("formatselect", function () { var n = [], i = r(e.settings.block_formats || "Paragraph=p;Address=address;Pre=pre;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6"); return s(i, function (t) { n.push({ text: t[0], value: t[1], textStyle: function () { return e.formatter.getCssText(t[1]) } }) }), { type: "listbox", text: i[0][0], values: n, fixedWidth: !0, onselect: l, onPostRender: t(n)} }), e.addButton("fontselect", function () { var n = "Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats", i = [], o = r(e.settings.font_formats || n); return s(o, function (e) { i.push({ text: { raw: e[0] }, value: e[1], textStyle: -1 == e[1].indexOf("dings") ? "font-family:" + e[1] : "" }) }), { type: "listbox", text: "Font Family", tooltip: "Font Family", values: i, fixedWidth: !0, onPostRender: t(i, "fontname"), onselect: function (t) { t.control.settings.value && e.execCommand("FontName", !1, t.control.settings.value) } } }), e.addButton("fontsizeselect", function () { var n = [], r = "8pt 10pt 12pt 14pt 18pt 24pt 36pt", i = e.settings.fontsize_formats || r; return s(i.split(" "), function (e) { var t = e, r = e, i = e.split("="); i.length > 1 && (t = i[0], r = i[1]), n.push({ text: t, value: r }) }), { type: "listbox", text: "Font Sizes", tooltip: "Font Sizes", values: n, fixedWidth: !0, onPostRender: t(n, "fontsize"), onclick: function (t) { t.control.settings.value && e.execCommand("FontSize", !1, t.control.settings.value) } } }), e.addMenuItem("formats", { text: "Formats", menu: c }) } var s = r.each; i.on("AddEditor", function (t) { t.editor.rtl && (e.rtl = !0), a(t.editor) }), e.translate = function (e) { return i.translate(e) }, t.tooltips = !o.iOS }), r(qt, [_t], function (e) { return e.extend({ recalc: function (e) { var t = e.settings, n, r, i, o, a, s, l, c, u, d, f, p, h, m, g, v, y, b, C, x, w, _, E = [], N = [], k, S, T, R, A, B; t = e.settings, i = e.items().filter(":visible"), o = e.layoutRect(), r = t.columns || Math.ceil(Math.sqrt(i.length)), n = Math.ceil(i.length / r), y = t.spacingH || t.spacing || 0, b = t.spacingV || t.spacing || 0, C = t.alignH || t.align, x = t.alignV || t.align, g = e._paddingBox, A = "reverseRows" in t ? t.reverseRows : e.isRtl(), C && "string" == typeof C && (C = [C]), x && "string" == typeof x && (x = [x]); for (d = 0; r > d; d++) E.push(0); for (f = 0; n > f; f++) N.push(0); for (f = 0; n > f; f++) for (d = 0; r > d && (u = i[f * r + d], u); d++) c = u.layoutRect(), k = c.minW, S = c.minH, E[d] = k > E[d] ? k : E[d], N[f] = S > N[f] ? S : N[f]; for (T = o.innerW - g.left - g.right, w = 0, d = 0; r > d; d++) w += E[d] + (d > 0 ? y : 0), T -= (d > 0 ? y : 0) + E[d]; for (R = o.innerH - g.top - g.bottom, _ = 0, f = 0; n > f; f++) _ += N[f] + (f > 0 ? b : 0), R -= (f > 0 ? b : 0) + N[f]; if (w += g.left + g.right, _ += g.top + g.bottom, l = {}, l.minW = w + (o.w - o.innerW), l.minH = _ + (o.h - o.innerH), l.contentW = l.minW - o.deltaW, l.contentH = l.minH - o.deltaH, l.minW = Math.min(l.minW, o.maxW), l.minH = Math.min(l.minH, o.maxH), l.minW = Math.max(l.minW, o.startMinWidth), l.minH = Math.max(l.minH, o.startMinHeight), !o.autoResize || l.minW == o.minW && l.minH == o.minH) { o.autoResize && (l = e.layoutRect(l), l.contentW = l.minW - o.deltaW, l.contentH = l.minH - o.deltaH); var D; D = "start" == t.packV ? 0 : R > 0 ? Math.floor(R / n) : 0; var L = 0, H = t.flexWidths; if (H) for (d = 0; d < H.length; d++) L += H[d]; else L = r; var M = T / L; for (d = 0; r > d; d++) E[d] += H ? H[d] * M : M; for (h = g.top, f = 0; n > f; f++) { for (p = g.left, s = N[f] + D, d = 0; r > d && (B = A ? f * r + r - 1 - d : f * r + d, u = i[B], u); d++) m = u.settings, c = u.layoutRect(), a = Math.max(E[d], c.startMinWidth), c.x = p, c.y = h, v = m.alignH || (C ? C[d] || C[0] : null), "center" == v ? c.x = p + a / 2 - c.w / 2 : "right" == v ? c.x = p + a - c.w : "stretch" == v && (c.w = a), v = m.alignV || (x ? x[d] || x[0] : null), "center" == v ? c.y = h + s / 2 - c.h / 2 : "bottom" == v ? c.y = h + s - c.h : "stretch" == v && (c.h = s), u.layoutRect(c), p += a + y, u.recalc && u.recalc(); h += s + b } } else if (l.w = l.minW, l.h = l.minH, e.layoutRect(l), this.recalc(e), null === e._lastRect) { var P = e.parent(); P && (P._lastRect = null, P.recalc()) } } }) }), r(jt, [Nt], function (e) { return e.extend({ renderHtml: function () { var e = this; return e.addClass("iframe"), e.canFocus = !1, '<iframe id="' + e._id + '" class="' + e.classes() + '" tabindex="-1" src="' + (e.settings.url || "javascript:''") + '" frameborder="0"></iframe>' }, src: function (e) { this.getEl().src = e }, html: function (e, t) { var n = this, r = this.getEl().contentWindow.document.body; return r ? (r.innerHTML = e, t && t()) : setTimeout(function () { n.html(e) }, 0), this } }) }), r(Yt, [Nt, Y], function (e, t) { return e.extend({ init: function (e) { var t = this; t._super(e), t.addClass("widget"), t.addClass("label"), t.canFocus = !1, e.multiline && t.addClass("autoscroll"), e.strong && t.addClass("strong") }, initLayoutRect: function () { var e = this, n = e._super(); if (e.settings.multiline) { var r = t.getSize(e.getEl()); r.width > n.maxW && (n.minW = n.maxW, e.addClass("multiline")), e.getEl().style.width = n.minW + "px", n.startMinH = n.h = n.minH = Math.min(n.maxH, t.getSize(e.getEl()).height) } return n }, repaint: function () { var e = this; return e.settings.multiline || (e.getEl().style.lineHeight = e.layoutRect().h + "px"), e._super() }, text: function (e) { var t = this; return t._rendered && e && this.innerHtml(t.encode(e)), t._super(e) }, renderHtml: function () { var e = this, t = e.settings.forId; return '<label id="' + e._id + '" class="' + e.classes() + '"' + (t ? ' for="' + t + '"' : "") + ">" + e.encode(e._text) + "</label>" } }) }), r(Kt, [J], function (e) { return e.extend({ Defaults: { role: "toolbar", layout: "flow" }, init: function (e) { var t = this; t._super(e), t.addClass("toolbar") }, postRender: function () { var e = this; return e.items().addClass("toolbar-item"), e._super() } }) }), r(Gt, [Kt], function (e) { return e.extend({ Defaults: { role: "menubar", containerCls: "menubar", ariaRoot: !0, defaults: { type: "menubutton"}} }) }), r(Xt, [kt, G, Gt], function (e, t, n) { function r(e, t) { for (; e; ) { if (t === e) return !0; e = e.parentNode } return !1 } var i = e.extend({ init: function (e) { var t = this; t._renderOpen = !0, t._super(e), t.addClass("menubtn"), e.fixedWidth && t.addClass("fixed-width"), t.aria("haspopup", !0), t.hasPopup = !0 }, showMenu: function () { var e = this, n = e.settings, r; return e.menu && e.menu.visible() ? e.hideMenu() : (e.menu || (r = n.menu || [], r.length ? r = { type: "menu", items: r} : r.type = r.type || "menu", e.menu = t.create(r).parent(e).renderTo(), e.fire("createmenu"), e.menu.reflow(), e.menu.on("cancel", function (t) { t.control.parent() === e.menu && (t.stopPropagation(), e.focus(), e.hideMenu()) }), e.menu.on("select", function () { e.focus() }), e.menu.on("show hide", function (t) { t.control == e.menu && e.activeMenu("show" == t.type), e.aria("expanded", "show" == t.type) }).fire("show")), e.menu.show(), e.menu.layoutRect({ w: e.layoutRect().w }), void e.menu.moveRel(e.getEl(), e.isRtl() ? ["br-tr", "tr-br"] : ["bl-tl", "tl-bl"])) }, hideMenu: function () { var e = this; e.menu && (e.menu.items().each(function (e) { e.hideMenu && e.hideMenu() }), e.menu.hide()) }, activeMenu: function (e) { this.toggleClass("active", e) }, renderHtml: function () { var e = this, t = e._id, r = e.classPrefix, i = e.settings.icon, o; return o = e.settings.image, o ? (i = "none", "string" != typeof o && (o = window.getSelection ? o[0] : o[1]), o = " style=\"background-image: url('" + o + "')\"") : o = "", i = e.settings.icon ? r + "ico " + r + "i-" + i : "", e.aria("role", e.parent() instanceof n ? "menuitem" : "button"), '<div id="' + t + '" class="' + e.classes() + '" tabindex="-1" aria-labelledby="' + t + '"><button id="' + t + '-open" role="presentation" type="button" tabindex="-1">' + (i ? '<i class="' + i + '"' + o + "></i>" : "") + "<span>" + (e._text ? (i ? "\xa0" : "") + e.encode(e._text) : "") + '</span> <i class="' + r + 'caret"></i></button></div>' }, postRender: function () { var e = this; return e.on("click", function (t) { t.control === e && r(t.target, e.getEl()) && (e.showMenu(), t.aria && e.menu.items()[0].focus()) }), e.on("mouseenter", function (t) { var n = t.control, r = e.parent(), o; n && r && n instanceof i && n.parent() == r && (r.items().filter("MenuButton").each(function (e) { e.hideMenu && e != n && (e.menu && e.menu.visible() && (o = !0), e.hideMenu()) }), o && (n.focus(), n.showMenu())) }), e._super() }, text: function (e) { var t = this, n, r; if (t._rendered) for (r = t.getEl("open").getElementsByTagName("span"), n = 0; n < r.length; n++) r[n].innerHTML = (t.settings.icon && e ? "\xa0" : "") + t.encode(e); return this._super(e) }, remove: function () { this._super(), this.menu && this.menu.remove() } }); return i }), r(Jt, [Xt], function (e) { return e.extend({ init: function (e) { function t(r) { for (var a = 0; a < r.length; a++) { if (i = r[a].selected || e.value === r[a].value) { o = o || r[a].text, n._value = r[a].value; break } r[a].menu && t(r[a].menu) } } var n = this, r, i, o, a; n._values = r = e.values, r && ("undefined" != typeof e.value && t(r), !i && r.length > 0 && (o = r[0].text, n._value = r[0].value), e.menu = r), e.text = e.text || o || r[0].text, n._super(e), n.addClass("listbox"), n.on("select", function (t) { var r = t.control; a && (t.lastControl = a), e.multiple ? r.active(!r.active()) : n.value(t.control.settings.value), a = r }) }, value: function (e) { function t(e, n) { e.items().each(function (e) { i = e.value() === n, i && (o = o || e.text()), e.active(i), e.menu && t(e.menu, n) }) } function n(t) { for (var r = 0; r < t.length; r++) i = t[r].value == e, i && (o = o || t[r].text), t[r].active = i, t[r].menu && n(t[r].menu) } var r = this, i, o, a; return "undefined" != typeof e && (r.menu ? t(r.menu, e) : (a = r.settings.menu, n(a)), r.text(o || this.settings.text)), r._super(e) } }) }), r(Qt, [Nt, G, d], function (e, t, n) { return e.extend({ Defaults: { border: 0, role: "menuitem" }, init: function (e) { var t = this; t.hasPopup = !0, t._super(e), e = t.settings, t.addClass("menu-item"), e.menu && t.addClass("menu-item-expand"), e.preview && t.addClass("menu-item-preview"), ("-" === t._text || "|" === t._text) && (t.addClass("menu-item-sep"), t.aria("role", "separator"), t._text = "-"), e.selectable && (t.aria("role", "menuitemcheckbox"), t.addClass("menu-item-checkbox"), e.icon = "selected"), e.preview || e.selectable || t.addClass("menu-item-normal"), t.on("mousedown", function (e) { e.preventDefault() }), e.menu && !e.ariaHideMenu && t.aria("haspopup", !0) }, hasMenus: function () { return !!this.settings.menu }, showMenu: function () { var e = this, n = e.settings, r, i = e.parent(); if (i.items().each(function (t) { t !== e && t.hideMenu() }), n.menu) { r = e.menu, r ? r.show() : (r = n.menu, r.length ? r = { type: "menu", items: r} : r.type = r.type || "menu", i.settings.itemDefaults && (r.itemDefaults = i.settings.itemDefaults), r = e.menu = t.create(r).parent(e).renderTo(), r.reflow(), r.on("cancel", function (t) { t.stopPropagation(), e.focus(), r.hide() }), r.on("show hide", function (e) { e.control.items().each(function (e) { e.active(e.settings.selected) }) }).fire("show"), r.on("hide", function (t) { t.control === r && e.removeClass("selected") }), r.submenu = !0), r._parentMenu = i, r.addClass("menu-sub"); var o = r.testMoveRel(e.getEl(), e.isRtl() ? ["tl-tr", "bl-br", "tr-tl", "br-bl"] : ["tr-tl", "br-bl", "tl-tr", "bl-br"]); r.moveRel(e.getEl(), o), r.rel = o, o = "menu-sub-" + o, r.removeClass(r._lastRel), r.addClass(o), r._lastRel = o, e.addClass("selected"), e.aria("expanded", !0) } }, hideMenu: function () { var e = this; return e.menu && (e.menu.items().each(function (e) { e.hideMenu && e.hideMenu() }), e.menu.hide(), e.aria("expanded", !1)), e }, renderHtml: function () { var e = this, t = e._id, r = e.settings, i = e.classPrefix, o = e.encode(e._text), a = e.settings.icon, s = "", l = r.shortcut; return a && e.parent().addClass("menu-has-icons"), r.image && (a = "none", s = " style=\"background-image: url('" + r.image + "')\""), l && n.mac && (l = l.replace(/ctrl\+alt\+/i, "&#x2325;&#x2318;"), l = l.replace(/ctrl\+/i, "&#x2318;"), l = l.replace(/alt\+/i, "&#x2325;"), l = l.replace(/shift\+/i, "&#x21E7;")), a = i + "ico " + i + "i-" + (e.settings.icon || "none"), '<div id="' + t + '" class="' + e.classes() + '" tabindex="-1">' + ("-" !== o ? '<i class="' + a + '"' + s + "></i>\xa0" : "") + ("-" !== o ? '<span id="' + t + '-text" class="' + i + 'text">' + o + "</span>" : "") + (l ? '<div id="' + t + '-shortcut" class="' + i + 'menu-shortcut">' + l + "</div>" : "") + (r.menu ? '<div class="' + i + 'caret"></div>' : "") + "</div>" }, postRender: function () { var e = this, t = e.settings, n = t.textStyle; if ("function" == typeof n && (n = n.call(this)), n) { var r = e.getEl("text"); r && r.setAttribute("style", n) } return e.on("mouseenter click", function (n) { n.control === e && (t.menu || "click" !== n.type ? (e.showMenu(), n.aria && e.menu.focus(!0)) : (e.fire("select"), e.parent().hideAll())) }), e._super(), e }, active: function (e) { return "undefined" != typeof e && this.aria("checked", e), this._super(e) }, remove: function () { this._super(), this.menu && this.menu.remove() } }) }), r(Zt, [rt, Qt, u], function (e, t, n) { var r = e.extend({ Defaults: { defaultType: "menuitem", border: 1, layout: "stack", role: "application", bodyRole: "menu", ariaRoot: !0 }, init: function (e) { var t = this; if (e.autohide = !0, e.constrainToViewport = !0, e.itemDefaults) for (var r = e.items, i = r.length; i--; ) r[i] = n.extend({}, e.itemDefaults, r[i]); t._super(e), t.addClass("menu") }, repaint: function () { return this.toggleClass("menu-align", !0), this._super(), this.getEl().style.height = "", this.getEl("body").style.height = "", this }, cancel: function () { var e = this; e.hideAll(), e.fire("select") }, hideAll: function () { var e = this; return this.find("menuitem").exec("hideMenu"), e._super() }, preRender: function () { var e = this; return e.items().each(function (t) { var n = t.settings; return n.icon || n.selectable ? (e._hasIcons = !0, !1) : void 0 }), e._super() } }); return r }), r(en, [Tt], function (e) { return e.extend({ Defaults: { classes: "radio", role: "radio"} }) }), r(tn, [Nt, Q], function (e, t) { return e.extend({ renderHtml: function () { var e = this, t = e.classPrefix; return e.addClass("resizehandle"), "both" == e.settings.direction && e.addClass("resizehandle-both"), e.canFocus = !1, '<div id="' + e._id + '" class="' + e.classes() + '"><i class="' + t + "ico " + t + 'i-resize"></i></div>' }, postRender: function () { var e = this; e._super(), e.resizeDragHelper = new t(this._id, { start: function () { e.fire("ResizeStart") }, drag: function (t) { "both" != e.settings.direction && (t.deltaX = 0), e.fire("Resize", t) }, stop: function () { e.fire("ResizeEnd") } }) }, remove: function () { return this.resizeDragHelper && this.resizeDragHelper.destroy(), this._super() } }) }), r(nn, [Nt], function (e) { return e.extend({ renderHtml: function () { var e = this; return e.addClass("spacer"), e.canFocus = !1, '<div id="' + e._id + '" class="' + e.classes() + '"></div>' } }) }), r(rn, [Xt, Y], function (e, t) { return e.extend({ Defaults: { classes: "widget btn splitbtn", role: "button" }, repaint: function () { var e = this, n = e.getEl(), r = e.layoutRect(), i, o; return e._super(), i = n.firstChild, o = n.lastChild, t.css(i, { width: r.w - t.getSize(o).width, height: r.h - 2 }), t.css(o, { height: r.h - 2 }), e }, activeMenu: function (e) { var n = this; t.toggleClass(n.getEl().lastChild, n.classPrefix + "active", e) }, renderHtml: function () { var e = this, t = e._id, n = e.classPrefix, r, i = e.settings.icon; return r = e.settings.image, r ? (i = "none", "string" != typeof r && (r = window.getSelection ? r[0] : r[1]), r = " style=\"background-image: url('" + r + "')\"") : r = "", i = e.settings.icon ? n + "ico " + n + "i-" + i : "", '<div id="' + t + '" class="' + e.classes() + '" role="button" tabindex="-1"><button type="button" hidefocus="1" tabindex="-1">' + (i ? '<i class="' + i + '"' + r + "></i>" : "") + (e._text ? (i ? " " : "") + e._text : "") + '</button><button type="button" class="' + n + 'open" hidefocus="1" tabindex="-1">' + (e._menuBtnText ? (i ? "\xa0" : "") + e._menuBtnText : "") + ' <i class="' + n + 'caret"></i></button></div>' }, postRender: function () { var e = this, t = e.settings.onclick; return e.on("click", function (e) { var n = e.target; if (e.control == this) for (; n; ) { if (e.aria && "down" != e.aria.key || "BUTTON" == n.nodeName && -1 == n.className.indexOf("open")) return e.stopImmediatePropagation(), void t.call(this, e); n = n.parentNode } }), delete e.settings.onclick, e._super() } }) }), r(on, [Ut], function (e) { return e.extend({ Defaults: { containerClass: "stack-layout", controlClass: "stack-layout-item", endClass: "break"} }) }), r(an, [et, Y], function (e, t) { return e.extend({ Defaults: { layout: "absolute", defaults: { type: "panel"} }, activateTab: function (e) { var n; this.activeTabId && (n = this.getEl(this.activeTabId), t.removeClass(n, this.classPrefix + "active"), n.setAttribute("aria-selected", "false")), this.activeTabId = "t" + e, n = this.getEl("t" + e), n.setAttribute("aria-selected", "true"), t.addClass(n, this.classPrefix + "active"), this.items()[e].show().fire("showtab"), this.reflow(), this.items().each(function (t, n) { e != n && t.hide() }) }, renderHtml: function () { var e = this, t = e._layout, n = "", r = e.classPrefix; return e.preRender(), t.preRender(e), e.items().each(function (t, i) { var o = e._id + "-t" + i; t.aria("role", "tabpanel"), t.aria("labelledby", o), n += '<div id="' + o + '" class="' + r + 'tab" unselectable="on" role="tab" aria-controls="' + t._id + '" aria-selected="false" tabIndex="-1">' + e.encode(t.settings.title) + "</div>" }), '<div id="' + e._id + '" class="' + e.classes() + '" hidefocus="1" tabindex="-1"><div id="' + e._id + '-head" class="' + r + 'tabs" role="tablist">' + n + '</div><div id="' + e._id + '-body" class="' + e.classes("body") + '">' + t.renderHtml(e) + "</div></div>" }, postRender: function () { var e = this; e._super(), e.settings.activeTab = e.settings.activeTab || 0, e.activateTab(e.settings.activeTab), this.on("click", function (t) { var n = t.target.parentNode; if (t.target.parentNode.id == e._id + "-head") for (var r = n.childNodes.length; r--; ) n.childNodes[r] == t.target && e.activateTab(r) }) }, initLayoutRect: function () { var e = this, n, r, i; r = t.getSize(e.getEl("head")).width, r = 0 > r ? 0 : r, i = 0, e.items().each(function (e) { r = Math.max(r, e.layoutRect().minW), i = Math.max(i, e.layoutRect().minH) }), e.items().each(function (e) { e.settings.x = 0, e.settings.y = 0, e.settings.w = r, e.settings.h = i, e.layoutRect({ x: 0, y: 0, w: r, h: i }) }); var o = t.getSize(e.getEl("head")).height; return e.settings.minWidth = r, e.settings.minHeight = i + o, n = e._super(), n.deltaH += o, n.innerH = n.h - n.deltaH, n } }) }), r(sn, [Nt, Y], function (e, t) { return e.extend({ init: function (e) { var t = this; t._super(e), t._value = e.value || "", t.addClass("textbox"), e.multiline ? t.addClass("multiline") : t.on("keydown", function (e) { 13 == e.keyCode && t.parents().reverse().each(function (t) { return e.preventDefault(), t.hasEventListeners("submit") && t.toJSON ? (t.fire("submit", { data: t.toJSON() }), !1) : void 0 }) }) }, disabled: function (e) { var t = this; return t._rendered && "undefined" != typeof e && (t.getEl().disabled = e), t._super(e) }, value: function (e) { var t = this; return "undefined" != typeof e ? (t._value = e, t._rendered && (t.getEl().value = e), t) : t._rendered ? t.getEl().value : t._value }, repaint: function () { var e = this, t, n, r, i = 0, o = 0, a; t = e.getEl().style, n = e._layoutRect, a = e._lastRepaintRect || {}; var s = document; return !e.settings.multiline && s.all && (!s.documentMode || s.documentMode <= 8) && (t.lineHeight = n.h - o + "px"), r = e._borderBox, i = r.left + r.right + 8, o = r.top + r.bottom + (e.settings.multiline ? 8 : 0), n.x !== a.x && (t.left = n.x + "px", a.x = n.x), n.y !== a.y && (t.top = n.y + "px", a.y = n.y), n.w !== a.w && (t.width = n.w - i + "px", a.w = n.w), n.h !== a.h && (t.height = n.h - o + "px", a.h = n.h), e._lastRepaintRect = a, e.fire("repaint", {}, !1), e }, renderHtml: function () { var e = this, t = e._id, n = e.settings, r = e.encode(e._value, !1), i = ""; return "spellcheck" in n && (i += ' spellcheck="' + n.spellcheck + '"'), n.maxLength && (i += ' maxlength="' + n.maxLength + '"'), n.size && (i += ' size="' + n.size + '"'), n.subtype && (i += ' type="' + n.subtype + '"'), e.disabled() && (i += ' disabled="disabled"'), n.multiline ? '<textarea id="' + t + '" class="' + e.classes() + '" ' + (n.rows ? ' rows="' + n.rows + '"' : "") + ' hidefocus="1"' + i + ">" + r + "</textarea>" : '<input id="' + t + '" class="' + e.classes() + '" value="' + r + '" hidefocus="1"' + i + " />" }, postRender: function () { var e = this; return t.on(e.getEl(), "change", function (t) { e.fire("change", t) }), e._super() }, remove: function () { t.off(this.getEl()), this._super() } }) }), r(ln, [Y, K], function (e, t) { return function (n, r) { var i = this, o, a = t.classPrefix; i.show = function (t) { return i.hide(), o = !0, window.setTimeout(function () { o && n.appendChild(e.createFragment('<div class="' + a + "throbber" + (r ? " " + a + "throbber-inline" : "") + '"></div>')) }, t || 0), i }, i.hide = function () { var e = n.lastChild; return e && -1 != e.className.indexOf("throbber") && e.parentNode.removeChild(e), o = !1, i } } }), a([l, c, u, d, f, p, h, m, g, y, b, C, _, E, N, k, S, T, R, A, B, D, L, H, M, O, I, F, z, W, V, U, $, q, j, Y, K, G, X, J, Q, Z, et, tt, nt, rt, it, ot, at, st, lt, ct, ut, dt, ft, pt, ht, mt, gt, vt, yt, bt, Ct, xt, wt, _t, Et, Nt, kt, St, Tt, Rt, At, Bt, Dt, Lt, Ht, Mt, Pt, Ot, It, Ft, zt, Wt, Vt, Ut, $t, qt, jt, Yt, Kt, Gt, Xt, Jt, Qt, Zt, en, tn, nn, rn, on, an, sn, ln]) } (this); tinymce.PluginManager.add("autoresize", function (a) { function b() { return a.plugins.fullscreen && a.plugins.fullscreen.isFullscreen() } function c(d) { var g, h, i, j, k, l, m, n, o, p, q, r, s = tinymce.DOM; if (h = a.getDoc()) { if (i = h.body, j = h.documentElement, k = e.autoresize_min_height, !i || d && "setcontent" === d.type && d.initial || b()) return void (i && j && (i.style.overflowY = "auto", j.style.overflowY = "auto")); m = a.dom.getStyle(i, "margin-top", !0), n = a.dom.getStyle(i, "margin-bottom", !0), o = a.dom.getStyle(i, "padding-top", !0), p = a.dom.getStyle(i, "padding-bottom", !0), q = a.dom.getStyle(i, "border-top-width", !0), r = a.dom.getStyle(i, "border-bottom-width", !0), l = i.offsetHeight + parseInt(m, 10) + parseInt(n, 10) + parseInt(o, 10) + parseInt(p, 10) + parseInt(q, 10) + parseInt(r, 10), (isNaN(l) || 0 >= l) && (l = tinymce.Env.ie ? i.scrollHeight : tinymce.Env.webkit && 0 === i.clientHeight ? 0 : i.offsetHeight), l > e.autoresize_min_height && (k = l), e.autoresize_max_height && l > e.autoresize_max_height ? (k = e.autoresize_max_height, i.style.overflowY = "auto", j.style.overflowY = "auto") : (i.style.overflowY = "hidden", j.style.overflowY = "hidden", i.scrollTop = 0), k !== f && (g = k - f, s.setStyle(a.iframeElement, "height", k + "px"), f = k, tinymce.isWebKit && 0 > g && c(d)) } } function d(a, b, e) { setTimeout(function () { c({}), a-- ? d(a, b, e) : e && e() }, b) } var e = a.settings, f = 0; a.settings.inline || (e.autoresize_min_height = parseInt(a.getParam("autoresize_min_height", a.getElement().offsetHeight), 10), e.autoresize_max_height = parseInt(a.getParam("autoresize_max_height", 0), 10), a.on("init", function () { var b = a.getParam("autoresize_overflow_padding", 1); a.dom.setStyles(a.getBody(), { paddingBottom: a.getParam("autoresize_bottom_margin", 50), paddingLeft: b, paddingRight: b }) }), a.on("nodechange setcontent keyup FullscreenStateChanged", c), a.getParam("autoresize_on_init", !0) && a.on("init", function () { d(20, 100, function () { d(5, 1e3) }) }), a.addCommand("mceAutoResize", c)) }); tinymce.PluginManager.add("code", function (a) { function b() { var b = a.windowManager.open({ title: "Source code", body: { type: "textbox", name: "code", multiline: !0, minWidth: a.getParam("code_dialog_width", 600), minHeight: a.getParam("code_dialog_height", Math.min(tinymce.DOM.getViewPort().h - 200, 500)), spellcheck: !1, style: "direction: ltr; text-align: left" }, onSubmit: function (b) { a.focus(), a.undoManager.transact(function () { a.setContent(b.data.code) }), a.selection.setCursorLocation(), a.nodeChanged() } }); b.find("#code").value(a.getContent({ source_view: !0 })) } a.addCommand("mceCodeEditor", b), a.addButton("code", { icon: "code", tooltip: "Source code", onclick: b }), a.addMenuItem("code", { icon: "code", text: "Source code", context: "tools", onclick: b }) }); tinymce.PluginManager.add("textcolor", function (a) { function b(b) { var c; return a.dom.getParents(a.selection.getStart(), function (a) { var d; (d = a.style["forecolor" == b ? "color" : "background-color"]) && (c = d) }), c } function c() { var b, c, d = []; for (c = a.settings.textcolor_map || ["000000", "Black", "993300", "Burnt orange", "333300", "Dark olive", "003300", "Dark green", "003366", "Dark azure", "000080", "Navy Blue", "333399", "Indigo", "333333", "Very dark gray", "800000", "Maroon", "FF6600", "Orange", "808000", "Olive", "008000", "Green", "008080", "Teal", "0000FF", "Blue", "666699", "Grayish blue", "808080", "Gray", "FF0000", "Red", "FF9900", "Amber", "99CC00", "Yellow green", "339966", "Sea green", "33CCCC", "Turquoise", "3366FF", "Royal blue", "800080", "Purple", "999999", "Medium gray", "FF00FF", "Magenta", "FFCC00", "Gold", "FFFF00", "Yellow", "00FF00", "Lime", "00FFFF", "Aqua", "00CCFF", "Sky blue", "993366", "Red violet", "FFFFFF", "White", "FF99CC", "Pink", "FFCC99", "Peach", "FFFF99", "Light yellow", "CCFFCC", "Pale green", "CCFFFF", "Pale cyan", "99CCFF", "Light sky blue", "CC99FF", "Plum"], b = 0; b < c.length; b += 2) d.push({ text: c[b + 1], color: "#" + c[b] }); return d } function d() { function b(a, b) { var c = "transparent" == a; return '<td class="mce-grid-cell' + (c ? " mce-colorbtn-trans" : "") + '"><div id="' + n + "-" + o++ + '" data-mce-color="' + (a ? a : "") + '" role="option" tabIndex="-1" style="' + (a ? "background-color: " + a : "") + '" title="' + tinymce.translate(b) + '">' + (c ? "&#215;" : "") + "</div></td>" } var d, e, f, g, h, k, l, m = this, n = m._id, o = 0; for (d = c(), d.push({ text: tinymce.translate("No color"), color: "transparent" }), f = '<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>', g = d.length - 1, k = 0; j > k; k++) { for (f += "<tr>", h = 0; i > h; h++) l = k * i + h, l > g ? f += "<td></td>" : (e = d[l], f += b(e.color, e.text)); f += "</tr>" } if (a.settings.color_picker_callback) { for (f += '<tr><td colspan="' + i + '" class="mce-custom-color-btn"><div id="' + n + '-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="' + n + '-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">' + tinymce.translate("Custom...") + "</button></div></td></tr>", f += "<tr>", h = 0; i > h; h++) f += b("", "Custom color"); f += "</tr>" } return f += "</tbody></table>" } function e(b, c) { a.focus(), a.formatter.apply(b, { value: c }), a.nodeChanged() } function f(b) { a.focus(), a.formatter.remove(b, { value: null }, null, !0), a.nodeChanged() } function g(c) { function d(a) { j.hidePanel(), j.color(a), e(j.settings.format, a) } function g(a, b) { a.style.background = b, a.setAttribute("data-mce-color", b) } var h, j = this.parent(); if (tinymce.DOM.getParent(c.target, ".mce-custom-color-btn") && (j.hidePanel(), a.settings.color_picker_callback.call(a, function (a) { var b, c, e, f = j.panel.getEl().getElementsByTagName("table")[0]; for (b = tinymce.map(f.rows[f.rows.length - 1].childNodes, function (a) { return a.firstChild }), e = 0; e < b.length && (c = b[e], c.getAttribute("data-mce-color")); e++); if (e == i) for (e = 0; i - 1 > e; e++) g(b[e], b[e + 1].getAttribute("data-mce-color")); g(c, a), d(a) }, b(j.settings.format))), h = c.target.getAttribute("data-mce-color")) { if (this.lastId && document.getElementById(this.lastId).setAttribute("aria-selected", !1), c.target.setAttribute("aria-selected", !0), this.lastId = c.target.id, "transparent" == h) return f(j.settings.format), void j.hidePanel(); d(h) } else null !== h && j.hidePanel() } function h() { var a = this; a._color && e(a.settings.format, a._color) } var i, j; j = a.settings.textcolor_rows || 5, i = a.settings.textcolor_cols || 8, a.addButton("forecolor", { type: "colorbutton", tooltip: "Text color", format: "forecolor", panel: { role: "application", ariaRemember: !0, html: d, onclick: g }, onclick: h }), a.addButton("backcolor", { type: "colorbutton", tooltip: "Background color", format: "hilitecolor", panel: { role: "application", ariaRemember: !0, html: d, onclick: g }, onclick: h }) }); tinymce.ThemeManager.add("modern", function (a) { function b() { function b(b) { var d, e = []; if (b) return l(b.split(/[ ,]/), function (b) { function c() { var c = a.selection; "bullist" == f && c.selectorChanged("ul > li", function (a, c) { for (var d, e = c.parents.length; e-- && (d = c.parents[e].nodeName, "OL" != d && "UL" != d); ); b.active(a && "UL" == d) }), "numlist" == f && c.selectorChanged("ol > li", function (a, c) { for (var d, e = c.parents.length; e-- && (d = c.parents[e].nodeName, "OL" != d && "UL" != d); ); b.active(a && "OL" == d) }), b.settings.stateSelector && c.selectorChanged(b.settings.stateSelector, function (a) { b.active(a) }, !0), b.settings.disabledStateSelector && c.selectorChanged(b.settings.disabledStateSelector, function (a) { b.disabled(a) }) } var f; "|" == b ? d = null : k.has(b) ? (b = { type: b }, j.toolbar_items_size && (b.size = j.toolbar_items_size), e.push(b), d = null) : (d || (d = { type: "buttongroup", items: [] }, e.push(d)), a.buttons[b] && (f = b, b = a.buttons[f], "function" == typeof b && (b = b()), b.type = b.type || "button", j.toolbar_items_size && (b.size = j.toolbar_items_size), b = k.create(b), d.items.push(b), a.initialized ? c() : a.on("init", c))) }), c.push({ type: "toolbar", layout: "flow", items: e }), !0 } var c = []; if (tinymce.isArray(j.toolbar)) { if (0 === j.toolbar.length) return; tinymce.each(j.toolbar, function (a, b) { j["toolbar" + (b + 1)] = a }), delete j.toolbar } for (var d = 1; 10 > d && b(j["toolbar" + d]); d++); return c.length || j.toolbar === !1 || b(j.toolbar || o), c.length ? { type: "panel", layout: "stack", classes: "toolbar-grp", ariaRoot: !0, ariaRemember: !0, items: c} : void 0 } function c() { function b(b) { var c; return "|" == b ? { text: "|"} : c = a.menuItems[b] } function c(c) { var d, e, f, g, h; if (h = tinymce.makeMap((j.removed_menuitems || "").split(/[ ,]/)), j.menu ? (e = j.menu[c], g = !0) : e = n[c], e) { d = { text: e.title }, f = [], l((e.items || "").split(/[ ,]/), function (a) { var c = b(a); c && !h[a] && f.push(b(a)) }), g || l(a.menuItems, function (a) { a.context == c && ("before" == a.separator && f.push({ text: "|" }), a.prependToContext ? f.unshift(a) : f.push(a), "after" == a.separator && f.push({ text: "|" })) }); for (var i = 0; i < f.length; i++) "|" == f[i].text && (0 === i || i == f.length - 1) && f.splice(i, 1); if (d.menu = f, !d.menu.length) return null } return d } var d, e = [], f = []; if (j.menu) for (d in j.menu) f.push(d); else for (d in n) f.push(d); for (var g = "string" == typeof j.menubar ? j.menubar.split(/[ ,]/) : f, h = 0; h < g.length; h++) { var i = g[h]; i = c(i), i && e.push(i) } return e } function d(b) { function c(a) { var c = b.find(a)[0]; c && c.focus(!0) } a.shortcuts.add("Alt+F9", "", function () { c("menubar") }), a.shortcuts.add("Alt+F10", "", function () { c("toolbar") }), a.shortcuts.add("Alt+F11", "", function () { c("elementpath") }), b.on("cancel", function () { a.focus() }) } function e(b, c) { function d(a) { return { width: a.clientWidth, height: a.clientHeight} } var e, f, g, h; e = a.getContainer(), f = a.getContentAreaContainer().firstChild, g = d(e), h = d(f), null !== b && (b = Math.max(j.min_width || 100, b), b = Math.min(j.max_width || 65535, b), m.setStyle(e, "width", b + (g.width - h.width)), m.setStyle(f, "width", b)), c = Math.max(j.min_height || 100, c), c = Math.min(j.max_height || 65535, c), m.setStyle(f, "height", c), a.fire("ResizeEditor") } function f(b, c) { var d = a.getContentAreaContainer(); i.resizeTo(d.clientWidth + b, d.clientHeight + c) } function g(e) { function f() { if (n && n.moveRel && n.visible() && !n._fixed) { var b = a.selection.getScrollContainer(), c = a.getBody(), d = 0, e = 0; if (b) { var f = m.getPos(c), g = m.getPos(b); d = Math.max(0, g.x - f.x), e = Math.max(0, g.y - f.y) } n.fixed(!1).moveRel(c, a.rtl ? ["tr-br", "br-tr"] : ["tl-bl", "bl-tl", "tr-br"]).moveBy(d, e) } } function g() { n && (n.show(), f(), m.addClass(a.getBody(), "mce-edit-focus")) } function h() { n && (n.hide(), m.removeClass(a.getBody(), "mce-edit-focus")) } function l() { return n ? void (n.visible() || g()) : (n = i.panel = k.create({ type: o ? "panel" : "floatpanel", role: "application", classes: "tinymce tinymce-inline", layout: "flex", direction: "column", align: "stretch", autohide: !1, autofix: !0, fixed: !!o, border: 1, items: [j.menubar === !1 ? null : { type: "menubar", border: "0 0 1 0", items: c() }, b()] }), a.fire("BeforeRenderUI"), n.renderTo(o || document.body).reflow(), d(n), g(), a.on("nodeChange", f), a.on("activate", g), a.on("deactivate", h), void a.nodeChanged()) } var n, o; return j.fixed_toolbar_container && (o = m.select(j.fixed_toolbar_container)[0]), j.content_editable = !0, a.on("focus", function () { e.skinUiCss ? tinymce.DOM.styleSheetLoader.load(e.skinUiCss, l, l) : l() }), a.on("blur hide", h), a.on("remove", function () { n && (n.remove(), n = null) }), e.skinUiCss && tinymce.DOM.styleSheetLoader.load(e.skinUiCss), {} } function h(f) { var g, h, l; return /*f.skinUiCss&&tinymce.DOM.loadCSS(f.skinUiCss)*/true, g = i.panel = k.create({ type: "panel", role: "application", classes: "tinymce", style: "visibility: hidden", layout: "stack", border: 1, items: [j.menubar === !1 ? null : { type: "menubar", border: "0 0 1 0", items: c() }, b(), { type: "panel", name: "iframe", layout: "stack", classes: "edit-area", html: "", border: "1 0 0 0"}] }), j.resize !== !1 && (h = { type: "resizehandle", direction: j.resize, onResizeStart: function () { var b = a.getContentAreaContainer().firstChild; l = { width: b.clientWidth, height: b.clientHeight} }, onResize: function (a) { "both" == j.resize ? e(l.width + a.deltaX, l.height + a.deltaY) : e(null, l.height + a.deltaY) } }), j.statusbar !== !1 && g.add({ type: "panel", name: "statusbar", classes: "statusbar", layout: "flow", border: "1 0 0 0", ariaRoot: !0, items: [{ type: "elementpath" }, h] }), j.readonly && g.find("*").disabled(!0), a.fire("BeforeRenderUI"), g.renderBefore(f.targetNode).reflow(), j.width && tinymce.DOM.setStyle(g.getEl(), "width", j.width), a.on("remove", function () { g.remove(), g = null }), d(g), { iframeContainer: g.find("#iframe")[0].getEl(), editorContainer: g.getEl()} } var i = this, j = a.settings, k = tinymce.ui.Factory, l = tinymce.each, m = tinymce.DOM, n = { file: { title: "File", items: "newdocument" }, edit: { title: "Edit", items: "undo redo | cut copy paste pastetext | selectall" }, insert: { title: "Insert", items: "|" }, view: { title: "View", items: "visualaid |" }, format: { title: "Format", items: "bold italic underline strikethrough superscript subscript | formats | removeformat" }, table: { title: "Table" }, tools: { title: "Tools"} }, o = "undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"; i.renderUI = function (b) { var c = j.skin !== !1 ? j.skin || "lightgray" : !1; if (c) { var d = j.skin_url; d = d ? a.documentBaseURI.toAbsolute(d) : tinymce.baseURL + "/skins/" + c, b.skinUiCss = tinymce.Env.documentMode <= 7 ? d + "/skin.ie7.min.css" : d + "/skin.min.css", a.contentCSS.push(d + "/content" + (a.inline ? ".inline" : "") + ".min.css") } return a.on("ProgressState", function (a) { i.throbber = i.throbber || new tinymce.ui.Throbber(i.panel.getEl("body")), a.state ? i.throbber.show(a.time) : i.throbber.hide() }), j.inline ? g(b) : h(b) }, i.resizeTo = e, i.resizeBy = f });;
