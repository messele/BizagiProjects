{"version":3,"sources":["jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.container.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.render.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.form.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.panel.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.contentPanel.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.nestedForm.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.tab.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.tabItem.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.horizontal.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.layout.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.accordion.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.accordionItem.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.group.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.searchForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.searchForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.startForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.form.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.ecm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.text.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.extendedText.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.label.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.number.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.money.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.date.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.actionLauncher.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.entityTemplate.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.polymorphicLauncher.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.yesno.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.check.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.checkList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.list.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.multiSelect.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.radio.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.cascadingCombo.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.combo.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.collectionnavigator.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.hidden.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.upload.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.upload.offline.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.ecm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.offline.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.grouped.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.search.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.letter.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.button.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.fileprint.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.link.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.image.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.formLink.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.geolocation.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.association.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.searchList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.userfield.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.activityCheckList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.numberScientificNotation.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.range.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeDate.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeMoney.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeNumber.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.render.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.image.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.placeholder.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.boolean.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.link.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.label.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.text.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.dateTime.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.number.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.money.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.upload.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.column.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.combo.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.document.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.date.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.text.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.number.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.image.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.upload.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.link.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.search.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.uploadecm.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.button.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.radio.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.list.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.exclusiveCheck.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.readonly.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.document.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.queryForm.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.formTemplate.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.usersForm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.specific_text.js","jquery/rendering/js/smartphone/bizagi.rendering.smartphone.factory.js"],"names":["bizagi","rendering","container","extend","startLoading","endLoading","render","base","prototype","smartphone","initializeData","data","this","_super","formContainer","getFormContainer","formParams","getParams","internalPostRender","element","changeDisplayOption","postRender","getLabel","label","$","observableElement","getContainerRender","getAlignClass","alignType","getControl","control","length","getControlFiller","controlFiller","getContainerMessage","containerMessage","getColumnContainerMessage","changeLabelAlign","changeValueAlign","customizeRenderWidth","submitOnChange","bRefreshForm","self","defer","Deferred","util","when","isReadyToSave","done","internalSubmitOnChange","resolve","fail","reject","always","stopLoading","promise","setValidationMessage","message","isGridControl","properties","type","$message","column","test","replace","attr","text","addClass","removeClass","setDisplayValue","value","setValue","editable","display","displayValue","getDisplayValue","html","actionSave","inputEdition","val","configureLabel","displayName","getElementsToStylize","context","getDisplayOptionClass","displayType","getFormattingLabel","clearDisplayValue","input","find","filter","index","ele","getValue","getFormParams","getRTLDisplayType","changeVisibility","argument","visible","parseBoolean","show","css","hide","changeRequired","required","triggerRenderValidate","changeRequiredLabel","changeEditabilityCellControl","key","xpath","form","init","params","warnings","errors","postRenderContainer","buttons","getButtons","document","unbind","bind","e","deferredSave","autoSaveEvents","window","newData","collectRenderValues","isEmptyObject","localization","getResource","saveBox","isStartForm","formtype","showConfirmationBox","saveForm","handler","processButtons","saveButton","nextButton","i","action","navigation","getNavigation","view_container","getViewContainer","setNavigationButtons","bindTouchEvents","refreshForm","focus","getFocus","options","idCase","idWorkitem","idTask","selectedTabs","getSelectedTabs","xpathContext","idPageCache","isRefresh","getEndPointAction","idStartScope","postRenderEdit","originalParams","triggerHandler","addValidationMessage","validationMessage","validationController","showValidationMessage","each","expandNotificationBox","hasOwnProperty","undoRemoveLastSuscriber","delay","configureHandlers","configureComplexGateway","command","controllers","validation","validations","actionController","actions","readyDeferred","modalViewDidAppear","modalViewDidDisappear","internalSubmitForm","buttonProperties","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","submitData","executeRule","createnewcase","collectRenderValuesForSubmit","animate","scrollTop","dataService","prepare","tag","prepareCheckpointAction","id","executeButton","idRender","prepareCommitAction","next","back","save","transitions","activeTransitions","push","countProps","messageComplexGateway","errorComplexGateway","showMessageBox","forcePlanCompletion","contexttype","contextType","surrogatekey","surrogateKey","flowControlDeferred","deferreds","apply","response","console","log","multiaction","execute","responses","bHasValidations","result","messages","sendRollbackAction","postProcessButton","refresh","routing","IdCase","caseNumber","CaseNumber","nonSupportedMethods","_","messageError","error","indexOf","errorType","then","_params","failHandler","validateFeatureSupport","isFloatingButtonsEnabled","isFormButtonsEnabled","dispose","triggerGlobalHandler","eventType","parent","trigger","error_obj","JSON","parse","code","setTimeout","renderContainer","template","renderFactory","getTemplate","fasttmpl","uniqueId","helptext","helpText","mode","getMode","queryForm","getFormType","summaryForm","globalForm","displayAsReadOnly","processPath","breadCrumb","orientation","replaceChildrenHtml","renderChildrenHtml","touchMoveStart","event","preventDefault","currentPossitionY","originalEvent","targetTouches","pageY","blur","currentPositionY","changedTouches","ordinal","processButton","complexGatewayContainer","children","hasClass","on","$selected","transitionId","is","panel","contentPanel","tab","material_bizagi_tabs","direction","active_index_tab","activeTab","ev","info","stopPropagation","setActiveTab","rippleEffect","tabItem","setAsActiveContainer","ready","tabs","click","activate","counter","horizontal","layout","accordion","accordionItem","group","toggleClass","collapse","isOpen","expand","toogleContainer","searchForm","renderResult","skipInitialLoad","rowsPerPage","sortBy","sortOrder","overrideGetRemoteData","getRemoteData","elements","columns","caption","parseAdditionalProperties","dataType","columnVisible","allowDecimals","showTime","grid","getRender","allowAdd","allowEdit","allowDelete","resultsGrid","results","postRenderElement","configureDesignView","configureLayoutView","criteriaContainer","resultsContainer","ui","searchParams","refreshResults","records","rows","title","Class","searchForms","searchFormParams","searchFormDeferred","renderEdition","renderSearchForm","createRenderContainer","getSearchContainerData","getContainer","Object","keys","map","errorTemplate","getCommonTemplate","appendTo","slideForm","tabContainer","firstChild","loadSearchTab","currentSearchForm","navigate","containerGridResults","containerSearchCriteria","applyButtons","renderAddForm","addContainer","guidEntity","entity","requestedForm","getFormData","addFormParams","indicator","style","callback","saveDataAddForm","destroy","maxRows","performSearch","innerHTML","currentAddForm","handleSearchFormZindex","refreshParams","validateForm","forceCollectData","formData","isMapEmpty","mapping","found","obj","setDisplayValueToControl","jqXHR","renderControlSearchForm","addForm","displayBottomButtons","getSearchFormData","pipe","searchFormContainer","detach","append","deferred","searchFormToLoad","otherElements","isDefault","searchFormData","Math","guid","idSearchForm","url","containerButtons","empty","templateBtn","btnSearch","tmpl","name","btnSelect","btnAdd","btnCancel","setSearchState","toggle","allowNew","pop","virtual","renderEditionAddForm","canvas","kendoView","viewContainer","allowFullSearch","maxRecords","isAddForm","pane","jQuery","arguments","option","modalViewDisplayed","grep","n","slideFormParams","slideContainer","configureViewHandlers","goBack","renderSlideForm","getStartForm","formClass","submitForm","getPageCache","onSave","renders","getRenders","updateOriginalValue","addErrorMessage","containerParams","saveButtonLabel","onCancel","cancelButtonLabel","remove","delegate","xhr","error_message","slideFormDeferred","getMetadataForm","$renderEdition","onSaveDataMetadataForm","fileData","shift","pageCacheId","sessionId","metadata","item","renderType","getRenderType","metadataType","newRender","assign","metadataId","description","readOnly","toUpperCase","thousands","maxLength","autoExtend","update","metadataValues","idMetadata","idFileUpload","fileName","xPath","idAttrib","metaValues","encode","loading","start","updateECMMetadata","fileProperties","stop","renderReadOnly","sanitizeHTML","decodedValue","decodeURI","validateValue","br2nl","replaceAll","attachRetypeDouble","retypeDouble","currentValue","createTooltip","tooltip","$context","substr","extendedText","minLines","maxLines","maxCharactersToShow","textarea","resize","isOfflineForm","showChar","startString","endString","actualMaxLength","which","prop","updateTextareaSize","configureHandlersReadOnly","$control","delegateTarget","currentRows","scrollHeight","offsetHeight","previousValue","undefined","newValue","number","isDesign","numericInput","executeFormatCurrencyPlugin","money","date","MAX_YEARS_DISPLAY","getFormattedDate","dateFormatter","formatDate","fullFormat","postRenderReadOnly","getDateControl","controlElements","defaultDateControl","minDateControl","minValue","maxDateControl","maxValue","timeFormat","getTimeFormat","isNaN","Date","setFullYear","getFullYear","setHours","mobiscroll","calendar","controls","min","max","defaultValue","showScrollArrows","lang","languages","BIZAGI_LANGUAGE","headerText","inst","time","timeS","onChangeHandler","clear","onSet","valueText","getVal","day","getDate","month","getMonth","year","hours","getHours","minutes","getMinutes","is24h","onBeforeShow","changeMinValue","changeMaxValue","isiOSDevice","onClose","onShow","isCordovaSupported","isAndroidDevice","cordova","plugins","Keyboard","disableScroll","close","initializer","isObjectEmpty","toString","getTime","currentDate","split","getDateFromInvariant","currentTime","fullDateFormated","setHour","getFullFormatedDate","getDateFromISO","dateControl","formatInvariant","preprocessDateValue","parseInt","isClearButton","formatedFullDate","setNewDateValue","fullDate","formatISO","dateFromFormat","getDateFromFormat","applyDateFormat","initIndexTime","endIndexTime","substring","isValid","invalidElements","bValid","validateMinAndMaxValue","hasValue","showMandatoryMessage","isMinValue","vValue","resultValue","formatedDate","propertiee","isValidMinMaxValue","formattedDate","actionLauncher","getActions","processPropertyValueArgs","getPropertiesActionLaucher","deferredActions","isHorizontal","templatetype","getPropertyData","processPropertyValueDataTmplArgs","templateData","engine","isDefaultTemplate","wrap","configureActionsHandlers","configureTemplateHandlers","guidProcess","guidAction","actionType","readOnlyForm","xpathActions","processAction","actionSheet","actionClicked","expr","FilterAction","array","search","RegExp","keyup","not","subscribe","filters","multipleSelection","countSameActions","actionManager","act","executeAction","showConfirmationDialog","notifyExecution","notifier","add","class_name","sticky","processActionForm","additionalXpaths","additionalXpath","join","def","slide","detailLabel","showSaveButton","isActionStartForm","savedData","editMode","IdScope","renderParams","idForm","caseId","typeForm","surrogatedKey","recordXpath","rewriteContextType","processActionFormCollection","xpathContextWithKey","printf","idEntity","xpathContextWithoutKey","addGridRecordData","IdEntity","addActionToQueue","processStartForm","args","startForm","guidprocess","mappingstakeholders","executeActionImmediately","actionsToExecuteContainer","configureQueueVisibility","listOfActions","removeActionSelector","openActionSelector","removeActionToQueue","target","extraParams","dataAction","actionsToExecuteTitle","allowactions","len","calculateFilters","polymorphicLauncher","getPolymorphicActions","serializePolymorphicActions","totalActions","clone","lessActions","templateArguments","allowSearch","treeActionsList","getTreeItems","bindHandlers","level","templateTreeItem","$targetData","guidObject","guidConstructor","onActionClicked","status","pageCache","maximized","$target","yesno","radio","parsedValue","change","cleanData","check","removeAttr","evt","isCheck","checkList","unique","ceil","random","itemId","onCheckListGroupChange","checked","items","combo","list","renderControl","mobileView","customHeader","contentTemplate","open","configureActions","isDependant","getParentCombo","parentValue","BA_ACTION_PARAMETER_PREFIX","renderCombo","content","configureModalViewHandlers","processComboData","forEach","comboValue","mapValue","isNumeric","selected","findDataValueById","isArray","formatItem","selectedValue","valueObjet","$elementsList","$clearButton","header","$searchInput","filterList","$li","stringContainer","stringToSearch","renderComboTemplate","selectedId","hasItems","validateItem","multiSelect","MORE_OPTION_WIDTH","SEARCH_MIN_LENGTH","isExecutionMode","getData","openModalView","el","template_content","values","isChecked","template_footer","footer","footerTemplate","transition","afterOpenAnimation","view","modalView","$listContainer","$suggestInput","newList","call","querySelector","getAttribute","findItemById","trim","siblings","cascadingCombo","services","service","BA_CONTEXT_PARAMETER_PREFIX","parentCombo","initializingCascadingCombo","isInitialValue","isRendered","deferredVisible","configureCombo","changeCombo","valueItem","getSelectedValue","getTemplateName","itemSelected","collectionnavigator","hidden","BA_PAGE_CACHE","upload","QUALITY_PICTURE","LIMIT","EXTENSIONSIMG","EXTENSIONSFILE","EXTENSIONSVIDEO","EXTENSIONSAUDIO","isNative","renderItem","noFiles","filesCount","file","files","renderUploadItem","replaceFilesHtml","$contentFile","$inputFile","$nativeFile","checkFileExtensions","attachEvents","media","downloadFile","executeFormFailHandler","off","chooseFile","removeFile","getUploadChoices","handlerUploadFile","appear","cancelClicked","getImageResolutionSizes","withoutCancel","handlerResolutionUpload","addFile","navigator","camera","getPicture","dataImage","extensions","concat","checkMaxSize","getFileDataInfo","checkFileTypes","version","getAndroidVersion","saveImage","isAndroid","modalResolutionUpload","buttonIndex","getImageResolutionItems","onFail","quality","correctOrientation","sourceType","Camera","PictureSourceType","PHOTOLIBRARY","CAMERA","mediaType","MediaType","PICTURE","destinationType","DestinationType","FILE_URI","targetWidth","targetHeight","device","capture","captureVideo","dataVideo","checkMaxSizeVideo","saveVideo","limit","actionSelected","ResolutionType","ORIGINAL","resolution","getImageResolution","transformImageSize","editedImageURL","localUrl","base64Image","dataItem","dataFile","getImagePath","mimeType","uploadFile","fullPath","addParams","buildAddParams","queueID","encodeXpath","getUploadXpath","FileUploadOptions","fileKey","uploadKey","addUrl","decodeURIComponent","onUploadFileCompleted","processFailMessage","isValidResource","$wrapper","newItem","slice","checkMaxFiles","isMaxFilesReached","maxFiles","maxfiles","actualFiles","validExtensions","validOptions","video","image","toLowerCase","fileAPISupported","buildAddFileParams","prefix","FormData","BIZAGI_SESSION_NAME","processUploadFile","itemsUpload","errorResponse","responseText","checkMaxSizeFile","deleteUploadItem","triggerRenderChange","getTemplateItemName","maxFileSizeOfProperty","Number","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","updateFilesCount","openOfflineFile","handlerWebUploadFile","removeOfflineFile","fileId","randomNumber","getBlobFromPath","blob","saveOfflineFile","saveResponse","onUploadOfflineFileCompleted","addInteractions","collectData","renderValues","method","fileUploaded","itemTemplate","filename","canBeSent","failReadFile","fileIndex","fileValue","includes","triggerEvents","dataIndex","getFileParams","offlineType","getOfflineFile","binaryFile","handleBinaryFile","path","blobPromise","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","reader","FileReader","onloadend","Blob","readAsArrayBuffer","blobFile","parameters","operationType","ecm","ERROR_ECM_NO_AVAILABLE","ACTION_DETAILS","ACTION_EDIT","getXpathContext","originalData","buildItemUrl","getFileProperties","renderFileLayout","metadataECMMultiaction","getECMMetadata","metaData","Array","showMetadata","Filename","attackMenuEvents","addMenuEvents","$fileItem","viewMore","fn","processActionByType","allowUpdateMetadata","allowCheckOut","lockECMFile","allowCancelCheckOut","unlockECMFile","deleteECMFile","overflowMenu","lockUploadItem","replaceWith","unlockUploadItem","performValidationMessage","isFailResponse","lastIndexOf","singleInstance","cellMetadata","setDisplayValueEdit","updateAffectedCellManually","getRowIndexByKey","showMore","buildColumnModel","columnsTotalizers","a","bizagi_grid_smartphone","waiting","table","emptyTable","specialColumn","row","rowButtons","cell","specialCell","pager","edit","withEditForm","details","allowDetail","inlineAdd","allowMore","totalizer","showSummary","hasTotalizer","pageRequested","onPageRequested","sortRequested","fetchData","page","sortType","isValidGrid","drawCell","isNewRow","cellReady","onCellReady","rowSelected","totalData","onTotalData","gridControlReady","processLayout","isLabelFormat","textFormat","valueFormat","addRow","editRow","deleteRow","showFormDetails","showDetailForm","updateData","changed","changeBackgroundColor","color","setHeaderStyles","label_style","headerFormat","format","bold","background","italic","underline","strikethru","size","fetchTotalData","operationState","showTotal","columnIndex","bizAgiProperties","totalize","operation","sum","return_value","defaultvalue","count","avg","toFixed","formatTotalizedResult","total","showTotals","dataUrl","sort","searchFilter","getGridData","isRTL","changeOrderData","controlType","formatMonetaryCell","cssClass","showBorder","columnModel","align","columnLabel","isEmpty","gridColumn","summarizeBy","dataReady","dataReadyDeferred","setCellOverrides","triggerGridPluginHandler","omitKeys","changes","newRecords","renderColumn","originalProperties","cellOverride","getCellOverride","labelAlign","columntitlealign","valueAlign","columnAlign","j","cellOverrides","bindRenderChange","newFontSize","outerHTML","originalEditable","getDecorated","submitOnChangexpathContext","dataservice","submitAddRequest","newid","propertiesGridForm","recordXPath","addPage","addLabel","idAsigned","enableEditSubmitRequest","hideLabel","disableProcessButons","argumentsfl","formlink","formLink","contextEdit","actionSaveNewRow","actionCancel","actionCancelRow","_sendRelation","_getData","_InternalRenderLinkForm","containerForm","editPage","editLabel","submitEditRequest","submitDeleteRequest","rowDeleted","submitRollbackRequest","submitSaveRequest","resp","applyActionUpdateGrid","originalMethod","decorated","selfIntern","child","getElementType","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","parentPromise","inlineAddPromise","inlineAddDeferred","setError","changeCellValue","getControlCell","_value","compositeValue","getCompositeValue","collectGridChange","changeCellBackgroundColor","background-color","background-image","changeCellColor","changeCellVisibility","getColumn","changeCellEditability","changeEditability","changeCellMinValue","changeCellMaxValue","cleanCellData","rowLength","errorsMessage","clearValidationMessages","isBinding","setSeconds","setMilliseconds","getIndexes","merge","getDataNewRows","reduce","acum","current","originalRows","completeRows","isTaskForm","newRowKeys","k","createdOffline","groupBy","groupSummary","addWarning","initialLoadDone","applyGridPlugin","pendingActions","enableXlsExport","enablePdfExport","processChanges","internalRedersValues","temporalNew","sortArray","currentChanges","columnXpath","canColumnBeSent","columnNumber","match","buildCellXpathFilter","addRowData","idRow","isNew","stringify","processOldRows","newRows","tempRows","col","leng","temp","processRow","setSurrogateKey","drawEditableCell","drawReadonlyCell","overrideProperties","onCellChange","originalFormat","renderSummary","newRow","createAddRowData","editInline","saveInlineAddedRows","bRefresh","removeNewRecords","splice","delInfo","deleteUrl","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","CLEAR_SEARCH_ID","NO_RESULTS_SEARCH_ID","DEFAULT_SEARCH_ID","SEARCH_DELAY","SEARCH_MAX_RECORDS","deferredReference","additionallabel","searchInput","advancedSearch","_simplySearchView","_advanceSearchView","readyActionExecution","modalViewList","suggestFilter","debounce","autoCompleteSearchResults","selectItem","formSearchParams","helpers","getContentTemplate","processRequest","term","renderSearchItem","searchItem","req","suggestions","allowSuggest","searchLength","getSuggestData","getOfflineData","state","hideStatus","parseValue","highlightMatches","inputText","allowClear","dataList","startsWith","letter","button","needsUserConfirmation","userConfirmationMessage","pressed","runButtonAction","fileprint","link","preventDefaultForAnchorTag","isValidValue","getFullyDecodedURI","linkEncode","encodeURI","linkSolver","linktarget","linkTarget","isDisposed","isDesignMode","showAsyncImage","choosePhoto","imageAdd","resolutionButtonHandler","imagePreview","useCamera","coordinates","getBoundingClientRect","popoverOptions","CameraPopoverOptions","left","top","performUploadFile","imageDelete","deleteImage","uploadFileCompleted","msg","saveImageOffline","htmlImage","configureMenu","baseParams","zoom","useNativeScrolling","imageData","img","onPreviewActionBack","buildFullItemUrl","$preview","originalImageWidth","width","$viewMore","buildItemUrlOffline","dataUrlToSave","controlValueIsChanged","originalElement","orgiginalDisplayType","_isRefreshForm","paramsRender","proxyPrefix","serviceLocator","getFormLinkXpathContext","getFormLinkXpath","hasentryrule","openLink","resolveCheckpointRequest","openLinkRule","err","paintFormLink","rollbackForm","property","getPropertyValue","dataRuleResp","showErrorMessage","propertyName","extra","textStatus","errorThrown","withAddForm","hideSaveButton","wiew_container","saveRecord","error_code","executeSubmitOnChange","hasexitrule","closeExitRule","resolveSubmitCommitRequest","ex","saveGridRecord","saveUrl","submitCommitRequest","submitCheckpointRequest","parentXpathContext","geolocation","ALLOW_UPDATE","coordinate","updateDisplayValue","performPrecision","onSuccess","position","coords","latitude","longitude","getCurrentPosition","association","getFlipAssociation","flip","makeJsonBase","flipped","columnData","getColumnData","getRightAssociation","formatJson","dataAssociation","rightData","leftData","isExecution","addEventControl","showDefaultGroupList","$groups","slideDown","$input","parentId","addElement","removeElement","flipstate","$element","$groupList","parents","closeAccordionSection","active","slideUp","searchList","SEARCH_ELEMENTS","searchListInput","_searchListViewModal","getHeaderTemplate","getFooterTemplate","cssClassHeader","adjustResize","finalValue","deleteItem","templateItem","getTagTemplate","modalViewTagList","modalFooter","modalHeader","getListItems","initialScreenSize","innerHeight","height","emptyItems","userfieldWrapper","getUserfieldControl","sControl","userfieldName","exists","eval","createUserfieldInstance","getUserfieldDefinition","userfield","userfieldGuid","loadUserfield","dynamicFunction","initialParams","getUserFieldInstance","isUserField","userfieldInstance","replicateUserfieldMethods","styleGuid","str","loadStyle","defaultUserField","designUserField","userfieldDefinition","basicUserField","renderSingle","renderUserfieldControl","getEditableControl","isSupported","getReadonlyControl","controlName","goal","activityDescription","newItemName","addEditButton","cancelEditButton","additionalElements","notifyLoadItems","resolvedItems","resolved","setItemLocalStorage","hasChanges","idActivity","itemsResolved","progress","activityWork","webpart","publish","prepareNewItem","that","contentHolder","closest","itemPosition","repaintControl","itemSelectedName","itemContent","setSelectionRange","addSelectedHandlers","keypress","addItem","guidItem","checkListHtml","refreshValue","completed","floor","originalValue","numberScientificNotation","range","rangeDate","defineRangeControl","rangeMoney","rangeNumber","layoutRender","layoutImage","templateUri","getImageUri","ajax","processData","success","contentType","getResponseHeader","byteArrayToBlob","stringToByteArray","imageUrl","URL","webkitURL","createObjectURL","hash","getUrl","replaceMultiple","layoutPlaceholder","layoutBoolean","layoutLink","proxy","onClickElement","navigateFromRender","reference","referenceType","kendoMobileApplication","layoutLabel","layoutText","layoutDateTime","layoutNumber","formatCurrency","symbol","positiveFormat","negativeFormat","decimalSymbol","digitGroupSymbol","groupDigits","roundToDecimalPlace","numDecimals","colorize","layoutMoney","layoutUpload","getValueFilesByData","valueResult","getHTMLFiles","getUploadFileEntityUrl","isContextContainerWidgetRender","guidentity","applyOverrides","originalGetControl","isValueValid","propertyOverrides","applyColumnStyles","cellIcon","getXpath","getDocumentXpath","getContextXpath","documentTemplateGenerate","preRenderControl","deleteDocumentTemplate","xpathcontext","generateDocumentTemplate","autoOpenDocuments","xpathPath","tableCell","deleteUploadFile","columnXpathSplit","nameFile","getUploadFileUrl","calculateInitialLayoutProperties","getECMXpathContext","idSession","readonly","ACTION_SHOW","ACTION_DOWNLOAD","ACTION_DELETE","documents","downloadalldocuments","allowgenerate","allowGenerate","renderDocumentsHtml","renderActionsHtml","replaceActionsHtml","$inputDocument","$listDocuments","$listActions","getTemplateReadonly","buttonExecuted","validate","validateContainer","documentFile","renderAllDocumentDownload","getTemplateDownload","buildAllDocumentsUrl","joined","redrawDocuments","downloadAllDocuments","$documentContainer","$actionContainer","showDocumentPreview","resolveDocumentTemplateGenerate","resolveDeleteDocumentTemplate","formTemplate","regularExpressionExpression","regularExpression","expression","regularExpressionMessage","isEmptyField","retype","mask","validationMessages","keyUnicode","charCode","keyCode","decodedDisplayValue","valueToDisplay","isNull","performDesignModeMethods","internalSetInitialValue","factory","loadTemplates","loadTemplate","getFileTemplate","tmplIcons","src","onDemand","detectDevice","usersForm","nestedForm","mobileform","mobilegroup","columnParams","isExtended","isExclusive","exclusiveCheck","uploadecm","offline","enableQuerySuggestBehavior","entityTemplate","getSearchRender","activityCheckList","getLayoutRender","getRangeRender","specific_text"],"mappings":"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","sourcesContent":["/**\r\n *   Name: Bizagi Smartphone Container Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.smartphone.container\", {}, {\r\n    /**\r\n     * Starts waiting signal for async stuff\r\n     */\r\n    startLoading: function () {\r\n    },\r\n\r\n    /**\r\n     * Ends waiting for async stuff\r\n     */\r\n    endLoading: function () {\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render base\r\nbizagi.rendering.render.extend(\"bizagi.rendering.smartphone.render\", bizagi.rendering.render.base.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.render\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var formContainer = this.getFormContainer();\r\n        this.formParams = formContainer.getParams();\r\n    },\r\n\r\n    /**\r\n     * Override internal rendering in order to apply new smartphone layout\r\n     */\r\n    internalPostRender: function (element) {\r\n        this._super(element);\r\n\r\n        this.changeDisplayOption();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Returns the label element usually to apply styles\r\n     */\r\n    getLabel: function() {\r\n        if (!this.label)\r\n            this.label = $(\".bz-form-label label\", this.element || this.observableElement);\r\n\r\n        return this.label;\r\n    },\r\n\r\n    getContainerRender: function () {\r\n        return $(this.element);\r\n    },\r\n\r\n    /**\r\n     * Return the right align class\r\n     */\r\n    getAlignClass: function (alignType) {\r\n        return alignType;\r\n    },\r\n\r\n    /**\r\n     * Template method to get the control element\r\n     */\r\n    getControl: function () {\r\n        if (!this.control || this.control.length === 0)\r\n            this.control = $(\".bz-control\", this.element || this.observableElement);\r\n\r\n        if (!this.control || this.control.length === 0) return null;\r\n\r\n        return this.control;\r\n    },\r\n\r\n    /**\r\n     * Template method to get the control filler element\r\n     */\r\n    getControlFiller: function () {\r\n        if (!this.controlFiller)\r\n            this.controlFiller = $(\".bz-form-item__control\", this.element || this.observableElement);\r\n\r\n        return this.controlFiller;\r\n    },\r\n\r\n    getContainerMessage: function () {\r\n        if (!this.containerMessage)\r\n            this.containerMessage = $(\".bz-form-message__text\", this.element || this.observableElement);\r\n\r\n        return this.containerMessage;\r\n    },\r\n\r\n    getColumnContainerMessage: function () {\r\n        if (!this.containerMessage)\r\n            this.containerMessage = $(\".bz-form-cell-message__text\", this.element || this.observableElement);\r\n\r\n        return this.containerMessage;\r\n    },\r\n\r\n    /**\r\n     * Customizes render label align\r\n     */\r\n    changeLabelAlign: function (alignType) {\r\n    },\r\n\r\n    /**\r\n     * Customizes render value align\r\n     */\r\n    changeValueAlign: function (alignType) {\r\n    },\r\n\r\n    /**\r\n     * Customizes render label and value width\r\n     * @returns {}\r\n     */\r\n    customizeRenderWidth: function () {\r\n    },\r\n\r\n    /**\r\n     * Sends all the info to the server then refreshes the form. Returns a deferred\r\n     */\r\n    submitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // TODO: Review loader for smartphone\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        $.when(self.isReadyToSave()).done(function () {\r\n            $.when(self.internalSubmitOnChange(data, bRefreshForm))\r\n                .done(function () {\r\n                    defer.resolve();\r\n                }).fail(function () {\r\n                defer.reject();\r\n            }).always(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Adds a validation message to the render\r\n     */\r\n    setValidationMessage: function (message) {\r\n        // Call base\r\n        this._super(message);\r\n\r\n        var isGridControl = (this.properties.type === \"grid\");\r\n        var isColumn = (this.column && /column/.test(this.properties.type));\r\n        var $message = isColumn ? this.getColumnContainerMessage() : this.getContainerMessage();\r\n\r\n        if (message && message.length > 0) {\r\n            message = message.replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\r\n\r\n            $message.attr(\"data-error\", message);\r\n            $message.text(message);\r\n\r\n            isGridControl ? this.element.addClass(\"bz-form-item-grid--error\") : this.element.addClass(\"bz-form-item--error\");\r\n        } else {\r\n            $message.text(\"\");\r\n            isGridControl ? this.element.removeClass(\"bz-form-item-grid--error\") : this.element.removeClass(\"bz-form-item--error\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable && self.properties.display !== \"check\") {\r\n            // Render as simple value\r\n            var displayValue = self.getDisplayValue(value);\r\n\r\n            if (typeof (displayValue) == \"string\" || typeof (displayValue) == \"number\") {\r\n                $(control).html(\"<label class='bz-form-label'>\" + displayValue + \"</label>\");\r\n            }\r\n        }\r\n    },\r\n\r\n    actionSave: function () {\r\n        this.setValue(this.inputEdition.val(), false);\r\n    },\r\n\r\n    configureLabel: function () {\r\n        return this.properties.displayName;\r\n    },\r\n\r\n    /**\r\n     * Starts waiting signal for async stuff\r\n     */\r\n    startLoading: function () {\r\n    },\r\n\r\n    /**\r\n     * Ends waiting for async stuff\r\n     */\r\n    endLoading: function () {\r\n    },\r\n\r\n    /**\r\n     * In mobiles, don't apply styles to icon's elements\r\n     * @param context\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(\".bz-input\", context);\r\n    },\r\n\r\n    /**\r\n     * Return the right display option class\r\n     * @param displayType\r\n     * @returns {string}\r\n     */\r\n    getDisplayOptionClass: function (displayType) {\r\n        if (displayType === \"reversed\") {\r\n            return \"bz-form-item--display-reversed\";\r\n        } else if (displayType === \"label\") {\r\n            return \"bz-form-item--display-label\";\r\n        } else if (displayType === \"value\") {\r\n            return \"bz-form-item--display-value\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Return the label\r\n     */\r\n    getFormattingLabel: function () {\r\n        // TODO: Despues de cambiar a genome desktop, validar se solo se deja este metodo en la base\r\n        return this.getLabel();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var input = control.find(\"input\").filter(function (index, ele) {\r\n            return ele.type !== \"file\" && ele.type !== \"radio\" && ele.type !== \"checkbox\"\r\n        });\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else {\r\n            self.setDisplayValue(\"\");\r\n        }\r\n    },\r\n\r\n    getFormParams: function () {\r\n        return this.formParams || {};\r\n    },\r\n\r\n    /**\r\n     * Transform the display type when using RTL orientation\r\n     */\r\n    getRTLDisplayType: function (displayType) {\r\n        return displayType;\r\n    },\r\n\r\n    /**\r\n     * Changes the render visibility\r\n     * @param argument\r\n     */\r\n    changeVisibility: function (argument) {\r\n        // Update properties\r\n        this.properties.visible = argument;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (this.properties.type !== \"hidden\") {\r\n                this.element.show();\r\n                this.element.css(\"display\", \"\");\r\n            }\r\n        } else if (this.element) {\r\n            this.element.hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Changes the render required\r\n     * @param argument\r\n     */\r\n    changeRequired: function (argument) {\r\n        // Update properties\r\n        this.properties.required = argument;\r\n\r\n        if (bizagi.util.parseBoolean(argument) && this.properties.editable) {\r\n            this.element.addClass(\"bz-form-item--required\");\r\n        } else {\r\n            this.element.removeClass(\"bz-form-item--required\");\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        // Prevent take the base\r\n    },\r\n\r\n    /**\r\n     * Change cell editability and attach bindings\r\n     * @param argument\r\n     * @param key\r\n     * @param xpath\r\n     */\r\n    changeEditabilityCellControl: function (argument, key, xpath) {\r\n        this._super(argument, key, xpath);\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Form Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the form class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.form\", bizagi.rendering.form.prototype);\r\n// Auto extend\r\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.form\", {}, {\r\n\r\n    init: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Define variables\r\n        self.warnings = {};\r\n        self.errors = {};\r\n\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed\r\n     */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n\r\n        self._super(container);\r\n\r\n        //Set button length\r\n        var buttons = self.getButtons();\r\n        var lengthButtons = buttons ? buttons.length : 0;\r\n\r\n        if (lengthButtons) {\r\n\r\n            $(document).data('auto-save', 'auto-save');\r\n\r\n            // Bind event auto-save\r\n            $(document).unbind(\"save-form\").bind(\"save-form\", function (e, deferredSave) {\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            $(window).unbind('beforeunload').bind('beforeunload', function (e) {\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data('auto-save'))\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");\r\n\r\n                return;\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Auto Save Events\r\n     */\r\n    autoSaveEvents: function (deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        self.collectRenderValues(data);\r\n\r\n        if (!$.isEmptyObject(data)) {\r\n            var isStartForm = self.properties.formtype === \"startform\";\r\n            var message = isStartForm ? bizagi.localization.getResource(\"confirmation-savebox-message4\") : bizagi.localization.getResource(\"confirmation-savebox-message1\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"warning\")).done(function () {\r\n                if (!isStartForm)\r\n                    self.saveForm();\r\n\r\n                deferredSave.resolve();\r\n            }).fail(function () {\r\n                if (isStartForm) {\r\n                    deferredSave.reject();\r\n                } else {\r\n                    deferredSave.resolve();\r\n                }\r\n            });\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * TEMPLATE METHOD TO GET THE BUTTONS OBJECTS\r\n     */\r\n    getButtons: function () {\r\n        var self = this;\r\n\r\n        if (self.getParams() && (handler = self.getParams().getButtons))\r\n            handler(self);\r\n\r\n        return $(\".ui-bizagi-button-container :button\", self.container);\r\n    },\r\n\r\n    processButtons: function () {\r\n        var self = this;\r\n        var params = self.getParams();\r\n\r\n        if (params && params.processButtons) {\r\n            var handler = params.processButtons;\r\n            handler(self);\r\n        }\r\n\r\n        var properties = self.properties;\r\n        properties.buttons = self.buttons;\r\n\r\n        // To cache a submit Data Buttom if exist\r\n        self.saveButton = null;\r\n        self.nextButton = null;\r\n\r\n        // Set saveButton and nextButton if exist\r\n        for (var i = 0, length = properties.buttons.length; i < length; i++) {\r\n            if (properties.buttons[i].action === \"save\") {\r\n                self.saveButton = properties.buttons[i];\r\n            } else if (properties.buttons[i].action === \"next\") {\r\n                self.nextButton = properties.buttons[i];\r\n            }\r\n        }\r\n\r\n        var navigation = self.getNavigation();\r\n\r\n        if (typeof (navigation) !== \"undefined\") {\r\n            //si tiene un viewConteiner sera porque es una forma dentro de container de edicion\r\n            var view_container = self.getViewContainer();\r\n            if (typeof view_container !== \"undefined\") {\r\n                view_container.setNavigationButtons(self);\r\n            } else {\r\n                navigation.setNavigationButtons(self);\r\n            }\r\n        }\r\n\r\n        // bind de touch events\r\n        self.bindTouchEvents(self.getButtons());\r\n    },\r\n\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var params = self.getParams();\r\n        var defer = new $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            isRefresh: true,\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\",\r\n            navigation: params.navigation,\r\n            view_container: params.view_container\r\n        };\r\n\r\n        if (params.postRenderEdit || params.processButtons) {\r\n            options.postRenderEdit = params.postRenderEdit;\r\n            options.processButtons = params.processButtons;\r\n            options.originalParams = params.originalParams || {};\r\n            options.getButtons = params.getButtons;\r\n        }\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            defer.resolve();\r\n        }).fail(function () {\r\n            defer.reject();\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Add a validation message to the form\r\n    */\r\n    addValidationMessage: function (validationMessage) {\r\n        var self = this;\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage);\r\n        } else {\r\n            $.each(validationMessage, function (i, message) {\r\n                self.validationController.showValidationMessage(message);\r\n            });\r\n        }\r\n\r\n        self.validationController.expandNotificationBox();\r\n\r\n        // TODO: Review function\r\n        var navigation = self.getNavigation();\r\n        if (navigation && navigation.hasOwnProperty(\"undoRemoveLastSuscriber\")) {\r\n            self.getNavigation().undoRemoveLastSuscriber();\r\n        }\r\n    },\r\n\r\n    startLoading: function (delay) {\r\n        bizagi.util.smartphone.startLoading();\r\n    },\r\n\r\n    endLoading: function () {\r\n        bizagi.util.smartphone.stopLoading();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the container's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var form = self.container;\r\n\r\n        // Process complex-gateway\r\n        self.configureComplexGateway();\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        //Event to notify the native code the form will be showing a modal view \r\n        self.bind(\"modalViewDidAppear\", function () {\r\n            self.params.navigation.modalViewDidAppear();\r\n        });\r\n\r\n        //Event to notify the native code the form will be hiding a modal view \r\n        self.bind(\"modalViewDidDisappear\", function () {\r\n            self.params.navigation.modalViewDidDisappear();\r\n        });\r\n    },\r\n\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var actions = [];\r\n        var defer = $.Deferred();\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var data;\r\n\r\n        // Fill data hash | Collect data\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase)\r\n            data = self.collectRenderValuesForSubmit();\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({scrollTop: $('.ui-bizagi-loading-icon')}, 'slow');\r\n        });\r\n\r\n        // Prepare actions\r\n        // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n        if (buttonProperties.executeRule) {\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n\r\n            submitDataAction.tag = \"submitData\";\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n\r\n            executeButtonAction.tag = \"executeRule\";\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    var messageComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-path\");\r\n                    var errorComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-error\");\r\n\r\n                    bizagi.showMessageBox(messageComplexGateway, errorComplexGateway, \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: buttonProperties.action,\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n\r\n            //Validates if the method CHECKPOINT is supported\r\n            if (checkpointAction) {\r\n                actions.push(checkpointAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n\r\n            //Validates if the method COMMIT is supported\r\n            if (commitAction) {\r\n                actions.push(commitAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n        }\r\n\r\n        if (performAction)\r\n            actions.push(performAction);\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                }).fail(function () {\r\n                console.log(\"Error: It was not possible resolve async actions on form \")\r\n                flowControlDeferred.reject();\r\n            })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        $.when(flowControlDeferred).done(function () {\r\n            bizagi.util.smartphone.startLoading();\r\n            $.when(self.dataService.multiaction().execute({actions: actions})).done(function (responses) {\r\n                // End asynchronous operation\r\n                self.endLoading();\r\n                // Find validations\r\n                var bHasValidations;\r\n                $.each(responses, function (i, response) {\r\n                    // Something went wrong, we gotta display messages in notifications grid\r\n                    if (response.result.type == \"validationMessages\") {\r\n                        self.addValidationMessage(response.result.messages);\r\n                        bHasValidations = true;\r\n                    }\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties))\r\n                        return;\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh)\r\n                        self.refreshForm();\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        self.triggerHandler(\"routing\", {idCase: self.params.idCase});\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (buttonProperties.executeRule)\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                //Removes the nonSupportedMethods to prevent further iterations\r\n                delete self.nonSupportedMethods;\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                var messageError = \"\";\r\n                var errorTypeList = [\"WaitForCompletionPlanException\", \"InvalidPlanStateException\", \"CustomMessageException\"];\r\n\r\n                if (buttonProperties.executeRule) self.sendRollbackAction(buttonProperties.id);\r\n\r\n                if (response && response.error && errorTypeList.indexOf(response.error.errorType) !== -1) {\r\n                    messageError = bizagi.localization.getResource(response.error.message);\r\n                    self.endLoading();\r\n\r\n                    $.when(bizagi.showConfirmationBox(messageError, null, false)).then(function () {\r\n                        var _params = $.extend({}, buttonProperties, {forcePlanCompletion: true});\r\n\r\n                        return $.when(self.internalSubmitForm(_params));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    messageError = typeof (response) === \"undefined\" ? bizagi.localization.getResource(\"workportal-general-error\") : response;\r\n                    self.failHandler({\"error\": messageError});\r\n                    defer.reject(response);\r\n                }\r\n            }).always(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            });\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    prepareCheckpointAction: function (id) {\r\n        return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\r\n    },\r\n\r\n    prepareCommitAction: function (id) {\r\n        return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\r\n    },\r\n\r\n    getNavigation: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.navigation;\r\n    },\r\n\r\n    getViewContainer: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.view_container;\r\n    },\r\n\r\n    isFloatingButtonsEnabled: function () {\r\n        var navigation = this.getNavigation();\r\n        return navigation && navigation.isFloatingButtonsEnabled();\r\n    },\r\n\r\n    isFormButtonsEnabled: function () {\r\n        var navigation = this.getNavigation();\r\n        return navigation && navigation.isFormButtonsEnabled();\r\n    },\r\n\r\n    dispose: function (params) {\r\n        // Active refresh on smartphone\r\n        if (typeof (params) === \"undefined\" || (typeof (params.isRefresh) === \"undefined\" || params.isRefresh == false)) {\r\n            this._super();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Publish a global event that the facade will replicate, also will be triggered in the form\r\n     */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        var self = this;\r\n\r\n        if (!self.parent) {\r\n            if (self.observableElement) {\r\n                self.observableElement.trigger(eventType, data);\r\n            }\r\n        } else {\r\n            self.parent.triggerGlobalHandler(eventType, data);\r\n        }\r\n\r\n        return self._super(eventType, data);\r\n    },\r\n\r\n    // TODO: REVIEW, ADD NOTIFIER PLUGIN!!!\r\n    failHandler: function (error) {\r\n        var self = this;\r\n        self._super(error);\r\n\r\n        var error_obj = {};\r\n\r\n        try {\r\n            error_obj = JSON.parse(error) || {};\r\n        } catch (e) {\r\n            error_obj = (error.length && error.length > 1) ? error[0] : error;\r\n        } finally {\r\n            //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n            //trigger the routing event in order to refresh the case\r\n            if (typeof error_obj.code !== \"undefined\" && error_obj.code === \"AUTH_ERROR\") {\r\n\r\n                //$.notifier.add({\r\n                //    class_name: \"error\",\r\n                //    title: \"Error\",\r\n                //    text: bizagi.localization.getResource(\"render-idle-expired-error\", \"Idle timer expired. For safety reasons this view will be refreshed automatically in 5 seconds. Note that any unsaved data is lost.\").replace(\"%s\", \"5\"),\r\n                //    sticky: false,\r\n                //    time: 5000\r\n                //});\r\n\r\n                setTimeout(function () {\r\n                    self.triggerHandler(\"routing\", {\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem\r\n                    });\r\n                }, 5000);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Build the container html\r\n     */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.fasttmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        return self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n    },\r\n\r\n    bindTouchEvents: function (buttons) {\r\n        var self = this;\r\n        var touchMoveStart = 0;\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length === 0) return;\r\n\r\n        buttons.bind(\"touchstart\", function (event) {\r\n            event.preventDefault();\r\n\r\n            var pointer = event.originalEvent.targetTouches ? event.originalEvent.targetTouches[0] : event;\r\n            var currentPossitionY = pointer.pageY;\r\n\r\n            touchMoveStart = currentPossitionY;\r\n        });\r\n\r\n        buttons.bind(\"touchend\", function (event) {\r\n            event.preventDefault();\r\n\r\n            // Trigger the blur of the focused element in order to catch the render Change in the last changed control\r\n            $(\":focus\", self.container).blur();\r\n            var pointer = event.originalEvent.changedTouches ? event.originalEvent.changedTouches[0] : event;\r\n            var currentPositionY = pointer.pageY;\r\n\r\n            self.startLoading();\r\n\r\n            // If the finger is too far from the button when you stop touching the screen, then do nothing\r\n            if (event.type !== \"click\" && currentPositionY > touchMoveStart + 40 || currentPositionY < touchMoveStart - 40) {\r\n                self.endLoading();\r\n            } else {\r\n                var button = $(this);\r\n                var ordinal = button.attr(\"ordinal\");\r\n                var buttonProperties = self.buttons[ordinal];\r\n\r\n                // Execute button\r\n                $.when(self.processButton(buttonProperties)).always(function () {\r\n                    self.endLoading();\r\n                });\r\n            }\r\n        });\r\n\r\n        buttons.bind(\"click\", function(){\r\n            self.startLoading();\r\n            var ordinal = $(this).attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            // Execute button\r\n            $.when(self.processButton(buttonProperties)).always(function () {\r\n                self.endLoading();\r\n            });\r\n        });\r\n\r\n        return;\r\n    },\r\n\r\n    /**\r\n     * Configure actions to complex-gateway\r\n     */\r\n    configureComplexGateway: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form.children()).each(function () {\r\n                if ($(this).hasClass('.bz-complex-gateway'))\r\n                    complexGatewayContainer = this;\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".bz-complex-gateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Set events for complex gateway interface\r\n        $(\".bz-checkbox__input\", complexGatewayContainer).on(\"click\", function () {\r\n            var $selected = $(this);\r\n            var transitionId = $selected.data(\"value\") || \"\";\r\n\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            self.activeTransitions[transitionId] = $selected.is(':checked') || false;\r\n\r\n        });\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Smartphone Panel Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.panel\", bizagi.rendering.panel.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.panel.extend(\"bizagi.rendering.smartphone.panel\", {}, {});\r\n","/**\r\n *   Name: Bizagi Smartphone ContentPanel Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the content panel class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.contentPanel\", bizagi.rendering.contentPanel.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.contentPanel.extend(\"bizagi.rendering.smartphone.contentPanel\", {}, {});\r\n","/*\r\n*   Name: Bizagi Smartphone Nested Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a nested form container class for smartphone devices\r\n*/\r\n\r\n// Extends from panel smartphone base\r\nbizagi.rendering.smartphone.panel.extend(\"bizagi.rendering.smartphone.nestedForm\", {}, {\r\n\r\n});","/**\r\n *   Name: Bizagi Smartphone Tab Container Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.tab\", bizagi.rendering.tab.prototype);\r\n// Auto extend\r\nbizagi.rendering.smartphone.tab.extend(\"bizagi.rendering.smartphone.tab\", {}, {\r\n\r\n    /* POST RENDER CONTAINER ACTIONS\r\n    =================================================*/\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n\r\n        this._super(container);\r\n\r\n        container.material_bizagi_tabs({\r\n            direction: this.properties.orientation,\r\n            active_index_tab: this.activeTab\r\n        }).on(\"updateActive\", function (ev, info) {\r\n            ev.stopPropagation();\r\n\r\n            self.setActiveTab(info.index);\r\n        });\r\n\r\n        $(\"> .bz-tabs > .bz-tab\", container).rippleEffect();\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Panel Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.tabItem\", bizagi.rendering.tabItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.tabItem.extend(\"bizagi.rendering.smartphone.tabItem\", {}, {\r\n\r\n    /**\r\n     * Change selected item\r\n     *\r\n     * @param {} argument\r\n     * @returns {}\r\n     */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            var tabItem = $(\"[data-reference='#ui-bizagi-tab-\" + self.properties.id + \"']\", self.parent.tabs);\r\n\r\n            tabItem.css(\"display\", \"\");\r\n            tabItem.click();\r\n        });\r\n    },\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        // Activate the tab if it hasn't been loaded\r\n        this.activate();\r\n\r\n        // Set this tab as an active container\r\n        this.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     *  Hides / Show container\r\n     *\r\n     * @param {} argument\r\n     * @returns {}\r\n     */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n\r\n        // Store in properties\r\n        self.properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        $.when(self.ready()).done(function () {\r\n            var tabItem = $(\"[data-reference='#ui-bizagi-tab-\" + self.properties.id + \"']\", self.parent.tabs);\r\n            var activeTab = self.parent.container.material_bizagi_tabs(\"getActiveTab\");\r\n\r\n            // Hide - show the render\r\n            if (self.properties.visible) {\r\n                self.container.css(\"display\", \"\");\r\n                tabItem.css(\"display\", \"\");\r\n\r\n\r\n                if (self.properties.counter === activeTab.index) {\r\n                    tabItem.css(\"display\", \"\");\r\n                    self.setAsActiveContainer();\r\n                } else {\r\n                    self.container.css(\"display\", \"none\");\r\n                }\r\n            } else {\r\n                self.container.css(\"display\", \"none\");\r\n                tabItem.css(\"display\", \"none\");\r\n\r\n                // If we are focus in the same tab is going to be invisible\r\n                activeTab = self.parent.container.material_bizagi_tabs(\"getActiveTab\");\r\n\r\n                if (self.properties.counter === activeTab.index) {\r\n                    self.parent.container.material_bizagi_tabs(\"moveToNextTab\");\r\n                } else {\r\n                    self.parent.container.material_bizagi_tabs(\"refreshPositions\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Horizontal Container Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.horizontal\", bizagi.rendering.horizontal.prototype);\r\n// Auto extend\r\nbizagi.rendering.smartphone.horizontal.extend(\"bizagi.rendering.smartphone.horizontal\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Layout Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the layout class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.layout\", bizagi.rendering.layout.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.layout.extend(\"bizagi.rendering.smartphone.layout\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi smartphone Accordion Container Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the accordion class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.accordion\", bizagi.rendering.accordion.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.accordion.extend(\"bizagi.rendering.smartphone.accordion\", {}, {\r\n\r\n});","/*\r\n*   Name: Bizagi smartphone AccordionItem Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the accordion item class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.accordionItem\", bizagi.rendering.accordionItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.accordionItem.extend(\"bizagi.rendering.smartphone.accordionItem\", {}, {\r\n\r\n});","/*\r\n *   Name: Bizagi Smartphones Group Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the group class to adjust to smartphones devices\r\n */\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.group\", bizagi.rendering.group.prototype);\r\n// Auto extend\r\nbizagi.rendering.smartphone.group.extend(\"bizagi.rendering.smartphone.group\", {}, {\r\n\r\n    /**\r\n    * Method to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        $(\">h5.bz-collapsible__header\", self.container).bind(\"click\", function () {\r\n            $(self.container).toggleClass(\"bz-collapsible--collapsed\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processeds\r\n     * @param {} group      \r\n     */\r\n    postRenderContainer: function (group) {\r\n        // Call base\r\n        this._super(group);\r\n        if (this.properties.collapse){\r\n            this.collapse();\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Check if group its open\r\n    * \r\n    * @return boolean\r\n    */\r\n    isOpen: function () {\r\n        return this.container.hasClass(\"bz-collapsible--collapsed\") ? false : true;\r\n    },\r\n\r\n    /**\r\n     * Focus on container     \r\n     */\r\n    focus: function () {\r\n        // Expand container\r\n        this.expand();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Expands group container \r\n     * @returns {} \r\n     */\r\n    expand: function () {\r\n        if (!this.isOpen()){\r\n            $(\">h5.bz-collapsible__header\", this.container).trigger(\"click\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Collapses group container \r\n     * @returns {} \r\n     */\r\n    collapse: function () {\r\n        if (this.isOpen()){\r\n            $(\">h5.bz-collapsible__header\", this.container).trigger(\"click\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Expands or collapse the container from actions\r\n     * @param {} argument      \r\n     */\r\n    toogleContainer: function (argument) {\r\n        if (argument) {\r\n            this.expand();\r\n        } else {\r\n            this.collapse();\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Search Form Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from container smartphone base\r\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.searchForm\", bizagi.rendering.searchForm.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.searchForm.extend(\"bizagi.rendering.smartphone.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: \"grid\",\r\n            xpath: \"searchForm\" + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function (params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function (i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0)\r\n                column.render.properties.columnVisible = false;\r\n\r\n            // if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8)\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n\r\n            // if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11)\r\n                column.render.properties.allowDecimals = true;\r\n\r\n            // if column is date push showtime property\r\n            if (columns[i].dataType == 12)\r\n                column.render.properties.showTime = columns[i].showTime;\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        grid.properties.allowAdd = false;\r\n        grid.properties.allowEdit = false;\r\n        grid.properties.allowDelete = false;\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        self._super(container);\r\n\r\n        var results = container.find(\".bz-container__search-results\");\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        // Apply handlers\r\n        if (mode == \"execution\") {\r\n            self.configureHandlers();\r\n        }\r\n\r\n        // Configure view\r\n        if (mode == \"design\") {\r\n            self.configureDesignView();\r\n        }\r\n\r\n        // Configure view\r\n        if (mode == \"layout\") {\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".bz-container__search-criteria\", self.container);\r\n        self.resultsContainer = $(\".bz-container__search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty(\"multiSelect\")) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n        var self = this;\r\n        self.trigger(\"instancerefresh\");\r\n\r\n        $.when(self.resultsGrid.refresh()).done(function () {\r\n            self.trigger(\"instancerefreshdone\");\r\n\r\n            if (self.resultsGrid.properties.data && self.resultsGrid.properties.data.records == 0 && self.resultsGrid.properties.data.rows.length == 0) {\r\n                var message = bizagi.localization.getResource(\"workportal-general-no-records-found\");\r\n                var title = bizagi.localization.getResource(\"render-dialog-sendemail-message\");\r\n\r\n                bizagi.showMessageBox(message, title);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Publish a global event that the facade will replicate, also will be triggered by the principal form\r\n     */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        var self = this;\r\n        self._super(eventType, data);\r\n        if (!self.parent) {\r\n            if (self.observableElement) {\r\n                return self.observableElement.trigger(eventType, data);\r\n            } else {\r\n                return null;\r\n            }\r\n        } else {\r\n            return self.parent.triggerGlobalHandler(eventType, data);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Search Slide Implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will shows a search form\r\n */\r\n$.Class.extend(\"bizagi.rendering.smartphone.helpers.searchForm\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, searchFormParams) {\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.searchForms = searchForms;\r\n        this.searchParams = searchParams;\r\n        this.searchFormParams = searchFormParams;\r\n        this.searchFormDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * Render the edition form,... if is an addform, then show the currentAddForm view\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    renderEdition: function (params) {\r\n        var self = this;\r\n        self.properties = params;\r\n\r\n        //Render the search form\r\n        self.renderSearchForm(params);\r\n\r\n        // Return promise\r\n        return self.searchFormDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Get the searchform and render it!\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    renderSearchForm: function (params) {\r\n        var self = this;\r\n\r\n        // Creates a container, be careful you must destroy it later\r\n        var container = self.searchFormParams.navigation.createRenderContainer({title: params.displayName});\r\n\r\n        $.when(self.getSearchContainerData(params))\r\n            .then(function (data) {\r\n                if (params.editable === false) {\r\n                    data.form.properties.editable = false;\r\n                }\r\n\r\n                if (data.form.properties) {\r\n                    data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n                }\r\n\r\n                var form = self.renderFactory.getContainer($.extend({}, self.searchFormParams, {\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.searchFormParams.navigation,\r\n                    view_container: container\r\n                }));\r\n\r\n                self.form = form;\r\n\r\n                var keys = Object.keys(form.children);\r\n\r\n                keys.map(function (key) {\r\n                    form.children[key].params = $.extend({}, form.children[key].params, self.searchFormParams);\r\n                });\r\n\r\n                return form.render();\r\n\r\n            }, function (message) {\r\n                var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n                $.fasttmpl(errorTemplate, {message: message}).appendTo(slideForm.find(\".scroll-content\"));\r\n            }).done(function (element) {\r\n            var tabContainer = self.form.firstChild().properties.type === \"tab\" ? self.form.firstChild() : null;\r\n            if (tabContainer) {\r\n                // Bind select tab event\r\n                tabContainer.bind(\"selected\", function (e, ui) {\r\n                    var searchForm = self.searchForms[ui.index];\r\n                    $.when(self.loadSearchTab(params, ui.tab, searchForm))\r\n                        .done(function () {\r\n                            // Set currents search form\r\n                            self.currentSearchForm = ui.tab.firstChild();\r\n                            self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n                        });\r\n                });\r\n\r\n                tabContainer.container.tabs(\"select\", 0);\r\n                self.currentSearchForm = tabContainer.firstChild().firstChild();\r\n\r\n                if (!self.currentSearchForm.readyDeferred)\r\n                    self.currentSearchForm.readyDeferred = new $.Deferred();\r\n\r\n                self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n            } else {\r\n                // Set currents search form\r\n                self.currentSearchForm = self.form.firstChild();\r\n\r\n                if (!self.currentSearchForm.readyDeferred)\r\n                    self.currentSearchForm.readyDeferred = new $.Deferred();\r\n\r\n                self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n            }\r\n\r\n            container.element.html(element);\r\n            self.searchFormParams.navigation.navigate(container.id);\r\n\r\n            self.containerGridResults = self.currentSearchForm.container.find(\".bz-container__search-results\");\r\n            self.containerSearchCriteria = self.currentSearchForm.container.find(\".bz-container__search-criteria\");\r\n            self.applyButtons(container);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get the addform and show it\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    renderAddForm: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var properties = self.properties;\r\n\r\n        if (typeof self.addContainer === \"undefined\") {\r\n            var message = bizagi.localization.getResource(\"render-dialog-entity\");\r\n            self.addContainer = self.searchFormParams.navigation.createRenderContainer({title: message});\r\n\r\n            // Binds the view close event, and send the RollBack\r\n            self.addContainer.element.bind(\"close\", function () {\r\n                delete self.addContainer;\r\n            });\r\n        }\r\n\r\n        var isRefresh = params.isRefresh || false;\r\n\r\n        var getFormParams = {\r\n            idPageCache: params.idPageCache,\r\n            guidEntity: properties.entity,\r\n            contextType: \"entity\"\r\n        };\r\n\r\n        if (isRefresh) {\r\n            getFormParams.isRefresh = true;\r\n            getFormParams.idStartScope = params.idStartScope;\r\n        } else {\r\n            getFormParams.idRender = properties.idRender;\r\n            getFormParams.requestedForm = \"addForm\";\r\n        }\r\n\r\n        // Get the addform\r\n        $.when(self.dataService.getFormData(getFormParams)).then(function (data) {\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            if (typeof (data.form.properties) !== \"undefined\") {\r\n                data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n            }\r\n\r\n            data.form.contextType = \"entity\";\r\n\r\n            var form = self.renderFactory.getContainer($.extend({}, self.addFormParams, {\r\n                type: \"form\",\r\n                data: data.form,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: isRefresh,\r\n                requestedForm: params.requestedForm,\r\n                navigation: self.searchFormParams.navigation,\r\n                view_container: self.addContainer\r\n            }));\r\n\r\n            form.buttons = [\r\n                $.extend(\r\n                    form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            // When the data is saved then\r\n                            return self.saveDataAddForm(form).done(function () {\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n\r\n                                // Force a search after a new item is created!\r\n                                self.searchParams.maxRows = 1;\r\n                                self.currentSearchForm.performSearch(self.searchParams);\r\n                            });\r\n                        }\r\n                    }),\r\n                $.extend(\r\n                    form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\"\r\n                    },\r\n                    {\r\n                        // This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            self.addContainer.destroy();\r\n                            delete self.addContainer;\r\n                        }\r\n                    })\r\n            ];\r\n\r\n            $.extend(form, {\r\n                processButtons: function () {\r\n                    // Not send information set in memory and save\r\n                    $.each(form.buttons, function (index, element) {\r\n                        switch (element[\"ordinal\"]) {\r\n                            case 1: //next button will behave as a cancel button\r\n                                $(form.getButtons()[index]).click(function () {\r\n                                    self.addContainer.destroy();\r\n                                    delete self.addContainer;\r\n                                });\r\n\r\n                                form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                form.buttons[index].action = \"back\";\r\n                                break;\r\n\r\n                            default:\r\n                                $(form.getButtons()[index]).click(function () {\r\n                                    self.saveDataAddForm(form);\r\n                                    self.addContainer.destroy();\r\n                                    delete self.addContainer;\r\n                                });\r\n                                break;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            for (var indicator in form.children) {\r\n                form.children[indicator].params = $.extend({}, form.children[indicator].params, self.addFormParams);\r\n            }\r\n\r\n            return $.when(form.render()).done(function (element) {\r\n                // Set currents search form\r\n                self.currentAddForm = form.firstChild();\r\n                self.addContainer.element.html(element);\r\n\r\n                if (!isRefresh) {\r\n                    self.searchFormParams.navigation.navigate(self.addContainer.id);\r\n                }\r\n\r\n                self.addContainer.setNavigationButtons(form);\r\n\r\n                form.triggerHandler(\"ondomincluded\");\r\n\r\n                // if is any modal view displayed, hide it to allow this search form been displayed\r\n                self.handleSearchFormZindex(\"show\");\r\n\r\n                form.bind(\"refresh\", function (_, refreshParams) {\r\n                    refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                    refreshParams = $.extend({\r\n                        focus: focus,\r\n                        selectedTabs: self.form.getSelectedTabs(),\r\n                        isRefresh: true,\r\n                        contextType: self.properties.contextType || \"\",\r\n                        navigation: self.searchFormParams.navigation,\r\n                        view_container: self.addContainer\r\n                    }, refreshParams);\r\n\r\n                    return self.renderAddForm(refreshParams);\r\n                });\r\n            });\r\n        }).fail(function () {\r\n            self.addContainer.destroy();\r\n            delete self.addContainer;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Save data to add form\r\n     * @param {} form\r\n     * @returns {}\r\n     */\r\n    saveDataAddForm: function (form) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        if (form.validateForm()) {\r\n            var data = {};\r\n            $.forceCollectData = true;\r\n\r\n            form.collectRenderValues(data);\r\n            data.idPageCache = form.idPageCache;\r\n\r\n            var params = {\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idPageCache: data.idPageCache,\r\n                guidEntity: form.properties.entity,\r\n                contexttype: \"entity\"\r\n            };\r\n\r\n            // Check if the add form has data\r\n            var formData = {};\r\n\r\n            form.collectRenderValuesForSubmit(formData);\r\n\r\n            // Turn off flag\r\n            $.forceCollectData = false;\r\n\r\n            if (!bizagi.util.isMapEmpty(formData)) {\r\n                $.when(self.dataService.submitData(params))\r\n                    .done(function (response) {\r\n                        function dataHasXpath(xpath) {\r\n                            var render = self.currentSearchForm.getRender(xpath);\r\n\r\n                            if (typeof render === \"object\" && render !== null)\r\n                                return {\"found\": true, \"obj\": render};\r\n                            return {\"found\": false, \"obj\": {}};\r\n                        }\r\n\r\n                        for (var i in formData) {\r\n                            var mapping = dataHasXpath(i);\r\n                            if (mapping.found) {\r\n                                mapping.obj.setValue(formData[i]);\r\n                                self.setDisplayValueToControl(mapping.obj, form, i, formData);\r\n                            }\r\n                        }\r\n\r\n                        defer.resolve();\r\n                    })\r\n                    .fail(function (jqXHR, type, message) {\r\n                        form.addValidationMessage(message.message);\r\n                        defer.reject();\r\n                    });\r\n            } else {\r\n                // Form has not data\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\r\n                defer.reject();\r\n            }\r\n        } else {\r\n            defer.reject();\r\n        }\r\n        return defer;\r\n    },\r\n\r\n    /***\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function (renderControlSearchForm, addForm, xpath, formData) {\r\n        if (renderControlSearchForm.properties.type === \"searchSuggest\") {\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        } else {\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * configure searchform buttons\r\n     * */\r\n    applyButtons: function (container) {\r\n        var self = this;\r\n\r\n        self.displayBottomButtons(container);\r\n\r\n        container.element.bind(\"close\", function () {\r\n            self.searchFormDeferred.reject();\r\n        });\r\n    },\r\n\r\n    loadSearchTab: function (params, tab, searchForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If the tab has children it is loaded already\r\n        if (tab.children.length > 0)\r\n            return null;\r\n\r\n        // Load search form data\r\n        $.when(self.getSearchFormData(params, searchForm))\r\n            .pipe(function (data) {\r\n                // Render data inside selected tab\r\n                var searchFormContainer = self.renderFactory.getContainer({\r\n                    type: \"searchForm\",\r\n                    data: data.form\r\n                });\r\n\r\n                tab.children.push(searchFormContainer);\r\n                return searchFormContainer.render();\r\n            })\r\n            .done(function (element) {\r\n                // Remove button container\r\n                $(\".ui-bizagi-button-container\", element).detach();\r\n                tab.container.append(element);\r\n                defer.resolve();\r\n            });\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the search dialog sub-containers\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: {\r\n                properties: {},\r\n                elements: []\r\n            }\r\n        };\r\n\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n            var tabContainer = {};\r\n            tabContainer.properties = {type: \"tab\"};\r\n\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: \"tabItem\",\r\n                    displayName: searchForm.caption\r\n                };\r\n                tab.elements = [];\r\n                // Append children\r\n                if (isDefault) {\r\n                    tabContainer.elements.push({container: tab});\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n                } else {\r\n                    otherElements.push({container: tab});\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad))\r\n            .done(function (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n                container.properties.id = Math.guid();\r\n\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            });\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Loads a search form\r\n     * @param {} params\r\n     * @param {} searchForm\r\n     * @returns {}\r\n     */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n            return data;\r\n        });\r\n    },\r\n\r\n    displayBottomButtons: function (container) {\r\n        var self = this;\r\n        var containerButtons = self.currentSearchForm.container.find(\".bz-container__button-edit\").empty().show();\r\n        var templateBtn = \"<button class='ui-bizagi-form-button ${name}'>${text}</button>\";\r\n        var btnSearch = $.tmpl(templateBtn, {\r\n            name: \"bz-btn-search\",\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-search\")\r\n        }).appendTo(containerButtons);\r\n        var btnSelect = $.tmpl(templateBtn, {\r\n            name: \"bz-btn-select\",\r\n            text: bizagi.localization.getResource(\"render-search-advanced-results-button\")\r\n        }).appendTo(containerButtons);\r\n        var btnAdd = $.tmpl(templateBtn, {\r\n            name: \"bz-btn-add\",\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-add\")\r\n        }).appendTo(containerButtons);\r\n        var btnCancel = $.tmpl(templateBtn, {\r\n            name: \"bz-btn-cancel\",\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\")\r\n        }).appendTo(containerButtons);\r\n\r\n        container.element.bind(\"close\", function (e) {\r\n            //If the view results is in front, shouldn't go back, but change the showed panel\r\n            if (self.containerSearchCriteria.css(\"display\") === \"none\") {\r\n                e.preventDefault();\r\n                setSearchState();\r\n            }\r\n        });\r\n\r\n        var setSearchState = function setSearchButtons() {\r\n            // List possible buttons for search\r\n            var buttons = [\r\n                {\r\n                    \"ordinal\": 1,\r\n                    \"action\": \"search\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                    \"callback\": function () {\r\n                        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\r\n                        self.searchParams.maxRows = 1;\r\n                        return self.currentSearchForm.performSearch(self.searchParams);\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 2,\r\n                    \"action\": \"cancel\",\r\n                    \"caption\": \"cancel\",\r\n                    \"callback\": function () {\r\n                        self.searchFormDeferred.reject();\r\n                        container.destroy();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 3,\r\n                    \"action\": \"add\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                    \"callback\": function () {\r\n                        var params = {\r\n                            \"idCase\": self.searchFormParams.idCase,\r\n                            \"idRender\": self.properties.idRender,\r\n                            \"displayName\": self.properties.displayName,\r\n                            \"idPageCache\": self.properties.idPageCache,\r\n                        };\r\n\r\n                        self.renderAddForm(params);\r\n                    },\r\n                },\r\n            ];\r\n\r\n            self.containerSearchCriteria.show();\r\n            self.containerGridResults.hide();\r\n\r\n            // Add only seen when allowed\r\n            $(btnAdd).toggle(self.searchParams.allowNew);\r\n            btnSearch.show();\r\n            btnSelect.hide();\r\n\r\n            if (!self.searchParams.allowNew) {\r\n                buttons.pop();\r\n            }\r\n\r\n            self.form.buttons = buttons;\r\n            delete self.form.properties.virtual;\r\n            container.setNavigationButtons(self.form);\r\n        };\r\n\r\n        var setResultState = function setSearchButtons() {\r\n\r\n            // List posible buttons for result\r\n            var buttons = [\r\n                {\r\n                    \"ordinal\": 4,\r\n                    \"action\": \"select\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-search-advanced-results-button\"),\r\n                    \"callback\": function () {\r\n                        self.searchFormDeferred.resolve(container.element.find(\".bz-container__search-results [data-key]\").data(\"business-key\"));\r\n                        container.destroy();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 5,\r\n                    \"action\": \"cancel\",\r\n                    \"caption\": \"cancel\",\r\n                    \"callback\": function () {\r\n                        setSearchState();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 3,\r\n                    \"action\": \"add\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                    \"callback\": function () {\r\n                        var params = {\r\n                            \"idCase\": self.searchFormParams.idCase,\r\n                            \"idRender\": self.properties.idRender,\r\n                            \"displayName\": self.properties.displayName,\r\n                            \"idPageCache\": self.properties.idPageCache,\r\n                        };\r\n\r\n                        self.renderAddForm(params);\r\n                    },\r\n                },\r\n            ];\r\n\r\n            self.containerSearchCriteria.hide();\r\n            self.containerGridResults.show();\r\n\r\n            // Add only seen when allowed\r\n            $(btnAdd).toggle(self.searchParams.allowNew);\r\n            btnSearch.hide();\r\n            btnSelect.show();\r\n\r\n            if (!self.searchParams.allowNew) {\r\n                buttons.pop();\r\n            }\r\n\r\n            self.form.buttons = buttons;\r\n            self.form.properties.virtual = true;\r\n            container.setNavigationButtons(self.form);\r\n        };\r\n\r\n        btnSearch.bind(\"click\", function () {\r\n            // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\r\n            self.searchParams.maxRows = 1;\r\n            self.currentSearchForm.performSearch(self.searchParams);\r\n        });\r\n\r\n        btnAdd.bind(\"click\", function () {\r\n            var params = {\r\n                \"idCase\": self.searchFormParams.idCase,\r\n                \"idRender\": self.properties.idRender,\r\n                \"displayName\": self.properties.displayName,\r\n                \"idPageCache\": self.properties.idPageCache\r\n            };\r\n\r\n            self.renderAddForm(params);\r\n        });\r\n\r\n        btnCancel.bind(\"click\", function () {\r\n            self.searchFormDeferred.reject();\r\n            container.destroy();\r\n        });\r\n\r\n        btnSelect.bind(\"click\", function () {\r\n            self.searchFormDeferred.resolve(container.element.find(\".bz-container__search-results [data-key]\").data(\"business-key\"));\r\n            container.destroy();\r\n        });\r\n\r\n        self.currentSearchForm.bind(\"instancerefreshdone\", function () {\r\n            // Show search results container\r\n            if (self.currentSearchForm.resultsGrid.properties.data !== null &&\r\n                !$.isEmptyObject(self.currentSearchForm.resultsGrid.properties.data.rows) &&\r\n                self.currentSearchForm.resultsGrid.properties.data.rows.length > 0\r\n            ) {\r\n                setResultState();\r\n            } else {\r\n                setSearchState();\r\n            }\r\n        });\r\n\r\n        setSearchState();\r\n    },\r\n\r\n    renderEditionAddForm: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = $(params.id + \" .inputEditionContent\");\r\n        var canvas = $(params.id + \" .inputEditionContent\");\r\n        var kendoView = $(params.id, \"body\");\r\n\r\n        self.viewContainer = params.viewContainer;\r\n\r\n        self.addFormParams = {\r\n            container: container,\r\n            canvas: canvas,\r\n            kendoView: kendoView,\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords,\r\n            allowNew: false\r\n        };\r\n\r\n        self.renderEdition({\r\n            \"idRender\": properties.idRender,\r\n            \"requestedForm\": \"addForm\",\r\n            \"xpathContext\": properties.xpathContext,\r\n            \"idPageCache\": properties.idPageCache,\r\n            \"isAddForm\": true,\r\n            \"contextType\": \"entity\"\r\n        }).done(function () {\r\n            if (self.form.validateForm()) {\r\n                var data = {};\r\n                $.forceCollectData = true;\r\n\r\n                self.form.collectRenderValues(data);\r\n                data.idPageCache = self.form.idPageCache;\r\n                var defer = $.Deferred();\r\n\r\n                var params = {\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    idPageCache: data.idPageCache,\r\n                    guidEntity: self.form.properties.entity,\r\n                    contexttype: \"entity\"\r\n                };\r\n\r\n                // Check if the add form has data\r\n                var formData = {};\r\n\r\n                self.form.collectRenderValuesForSubmit(formData);\r\n\r\n                // Turn off flag\r\n                $.forceCollectData = false;\r\n\r\n                if (!bizagi.util.isMapEmpty(formData)) {\r\n                    self.pane.navigate(\"#:back\");\r\n                    $.when(self.dataService.submitData(params)).done(function (response) {\r\n                        function dataHasXpath(xpath) {\r\n                            var render = self.currentSearchForm.getRender(xpath);\r\n\r\n                            if (typeof render == \"object\" && render !== null) {\r\n                                return {\"found\": true, \"obj\": render};\r\n                            }\r\n\r\n                            return {\"found\": false, \"obj\": {}};\r\n                        }\r\n\r\n                        for (var i in formData) {\r\n                            var mapping = dataHasXpath(i);\r\n                            if (mapping.found) {\r\n                                var value = data[i];\r\n                                mapping.obj.setValue(value);\r\n                                mapping.obj.setDisplayValue(value);\r\n\r\n                                if (self.currentSearchForm.resultsGrid.properties.data !== null &&\r\n                                    !jQuery.isEmptyObject(self.currentSearchForm.resultsGrid.properties.data.rows) &&\r\n                                    self.currentSearchForm.resultsGrid.properties.data.rows.length > 0) {\r\n                                    self.containerSearchCriteria.show();\r\n                                    self.currentSearchForm.container.find(\".bz-btn-search\").show();\r\n                                    self.currentSearchForm.container.find(\".bz-btn-select\").hide();\r\n                                    self.containerGridResults.hide();\r\n                                }\r\n                            }\r\n                        }\r\n                    }).fail(function (jqXHR, type, message) {\r\n                        if (type === \"parsererror\") {\r\n                            defer.resolve({type: \"error\", message: message.message});\r\n                        } else {\r\n                            defer.reject(arguments);\r\n                        }\r\n                    });\r\n                } else {\r\n                    // Form has not data\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\r\n                }\r\n            }\r\n        }).fail(function () {\r\n            self.pane.navigate(\"#:back\");\r\n        });\r\n\r\n        self.pane.navigate(params.id);\r\n    },\r\n\r\n    handleSearchFormZindex: function (option) {\r\n        var self = this;\r\n\r\n        //if there is an open modal, change z-index to make searchForm visible\r\n        var modalViewDisplayed = $.grep($(\".km-modalview-root\"), function (n, i) {\r\n            return ($(n).css(\"display\") == \"block\");\r\n        });\r\n\r\n        if (modalViewDisplayed.length > 0) {\r\n            if (option == \"show\") {\r\n                $(modalViewDisplayed).css(\"z-index\", 0);\r\n            } else {\r\n                $(modalViewDisplayed).css(\"z-index\", 10001);\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Smartphone slide StartForm implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.smartphone.startForm\", {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container    \t\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({title: self.slideFormParams.title});\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Handlers de la vista de kendo\r\n     */\r\n    configureViewHandlers: function () {\r\n    },\r\n\r\n    /**\r\n     * go back and destroy\r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /*\r\n     *   Render the form\r\n     *   The params are the same that will be send to the ajax service\r\n     *   Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n        // Fill content\r\n        self.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function (params) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getStartForm(params)).then(function (data) {\r\n            /*** SUCCESS FILTER **/\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Render dialog template\r\n            var formClass = bizagi.rendering.smartphone.form.extend({\r\n                submitForm: function () {\r\n                    if (self.form) {\r\n                        this.endLoading();\r\n                        // Perform validations\r\n                        if (self.form.validateForm()) {\r\n                            // Collect data\r\n                            var data = {};\r\n                            self.form.collectRenderValues(data);\r\n                            // Add page cache for this form\r\n                            data.idPageCache = self.form.getPageCache();\r\n                            // Call user callback\r\n                            if (self.slideFormParams.onSave) {\r\n                                $.when(self.slideFormParams.onSave(data))\r\n                                    .done(function (result) {\r\n                                        if (result === null || result === true || result.type === \"success\") {\r\n                                            defer.resolve();\r\n                                            self.goBack();\r\n                                        } else if (result.type === \"validationMessages\") {\r\n                                            // Add validation messages\r\n                                            self.form.addValidationMessage(result.messages);\r\n                                            // Update original value to use as reference to other futures changes in the dialogBox\r\n                                            $.each(data, function (key) {\r\n                                                var renders = self.form.getRenders(key);\r\n                                                $.each(renders, function (i, render) {\r\n                                                    render.updateOriginalValue();\r\n                                                });\r\n                                            });\r\n                                        } else if (result.type === \"error\") {\r\n                                            // Add error messages\r\n                                            self.form.addErrorMessage(result.message);\r\n                                        }\r\n                                    });\r\n\r\n                            } else {\r\n                                defer.resolve();\r\n                                self.goBack();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            var containerParams = $.extend({\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.slideFormParams.navigation,\r\n                    view_container: self.slideContainer\r\n                },\r\n                {\r\n                    renderFactory: self.renderFactory,\r\n                    dataService: self.renderFactory.dataService\r\n                });\r\n            self.form = new formClass(containerParams);\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                refreshParams = $.extend({\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true\r\n                }, params, refreshParams, {idStartScope: self.form.properties.idStartScope});\r\n\r\n                self.renderSlideForm(refreshParams);\r\n            });\r\n            // Return rendering promise\r\n\r\n            self.form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": self.slideFormParams.saveButtonLabel,\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            // When the data is saved then\r\n                            self.form.submitForm();\r\n                        },\r\n                    }),\r\n                $.extend(\r\n                    self.form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            if (self.slideFormParams.onCancel) {\r\n                                self.slideFormParams.onCancel();\r\n                            }\r\n                            self.goBack();\r\n                        },\r\n                    }),\r\n            ];\r\n\r\n            return self.form.render();\r\n        }).done(function (element) {\r\n            var saveButtonLabel = (self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\"));\r\n            var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n\r\n            if (!params.isRefresh) {\r\n                self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n            }\r\n\r\n            $(\".ui-bizagi-button-container div\", self.form.container).remove();\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal='0' id='formButton0' class='action-button ui-bizagi-form-button'>\" +\r\n                    saveButtonLabel + \"</div>\").delegate(\"div[ordinal='0']\", \"click\", function () {\r\n                self.form.submitForm();\r\n            });\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal='1' id='formButton1' class='action-button ui-bizagi-form-button'>\" +\r\n                    cancelButtonLabel + \"</div>\").delegate(\"div[ordinal='1']\", \"click\", function () {\r\n                self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                self.goBack();\r\n            });\r\n\r\n            //self.view.scroller.reset();\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n        }).fail(function (xhr, errorType, message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.tmpl(errorTemplate, {message: error_message}).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone slide form implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n$.Class.extend(\"bizagi.rendering.smartphone.slide.form\", {}, {\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({title: self.slideFormParams.title});\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * go back and destroy\r\n     */\r\n    goBack: function () {\r\n        this.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Handlers de la vista de kendo\r\n     */\r\n    configureViewHandlers: function () {\r\n    },\r\n\r\n    /*\r\n     *   Render the form\r\n     *   The params are the same that will be send to the ajax service\r\n     *   Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        this.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params))\r\n            .pipe(function (data) {\r\n                /*** SUCCESS FILTER **/\r\n                // Apply editable param\r\n                if (params.editable === false) {\r\n                    data.form.properties.editable = false;\r\n                }\r\n\r\n                // Render dialog template\r\n                var formClass = bizagi.rendering.smartphone.form.extend({\r\n                    submitForm: function (arguments) {\r\n                        if (self.form) {\r\n                            this.endLoading();\r\n                            // Perform validations\r\n                            if (self.form.validateForm()) {\r\n                                // Collect data\r\n                                var data = {};\r\n                                self.form.collectRenderValues(data);\r\n                                // Add page cache for this form\r\n                                data.idPageCache = self.form.getPageCache();\r\n                                // Call user callback\r\n                                if (self.slideFormParams.onSave) {\r\n                                    $.when(self.slideFormParams.onSave(data))\r\n                                        .done(function (result) {\r\n                                            if (result === null || result === true || result.type === \"success\") {\r\n                                                defer.resolve();\r\n                                                self.goBack();\r\n                                            } else if (result.type === \"validationMessages\") {\r\n                                                // Add validation messages\r\n                                                self.form.addValidationMessage(result.messages);\r\n                                                // Update original value to use as reference to other futures changes in the dialogBox\r\n                                                $.each(data, function (key, value) {\r\n                                                    var renders = self.form.getRenders(key);\r\n                                                    $.each(renders, function (i, render) {\r\n                                                        render.updateOriginalValue();\r\n                                                    });\r\n                                                });\r\n                                            } else if (result.type === \"error\") {\r\n                                                // Add error messages\r\n                                                self.form.addErrorMessage(result.message);\r\n                                            }\r\n                                        });\r\n\r\n                                } else {\r\n                                    defer.resolve();\r\n                                    self.goBack();\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n                var containerParams = $.extend({\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.slideFormParams.navigation,\r\n                    view_container: self.slideContainer\r\n                }, {\r\n                    renderFactory: self.renderFactory,\r\n                    dataService: self.renderFactory.dataService\r\n                });\r\n                self.form = new formClass(containerParams);\r\n\r\n                self.form.buttons = [\r\n                    $.extend(\r\n                        self.form.buttons[0] || {},\r\n                        {\r\n                            \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                            \"actions\": [\"submitData\", \"refresh\"],\r\n                            \"submitData\": true,\r\n                            \"refresh\": true,\r\n                            \"ordinal\": 0,\r\n                            \"action\": \"save\",\r\n                            \"save\": true,\r\n                            \"style\": \"\",\r\n                        },\r\n                        {\r\n                            //This callback avoid to call the default processButton in the form\r\n                            callback: function () {\r\n                                // When the data is saved then\r\n                                self.form.submitForm();\r\n                            },\r\n                        }),\r\n                    $.extend(\r\n                        self.form.buttons[1] || {},\r\n                        {\r\n                            \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                            \"actions\": [\"submitData\", \"refresh\"],\r\n                            \"submitData\": true,\r\n                            \"refresh\": true,\r\n                            \"ordinal\": 1,\r\n                            \"action\": \"back\",\r\n                            \"save\": true,\r\n                            \"style\": \"\",\r\n                        },\r\n                        {\r\n                            //This callback avoid to call the default processButton in the form\r\n                            callback: function () {\r\n                                if (self.slideFormParams.onCancel) {\r\n                                    self.slideFormParams.onCancel();\r\n                                }\r\n                                self.goBack();\r\n                            },\r\n                        }),\r\n                ];\r\n\r\n                // Return rendering promise\r\n                return self.form.render();\r\n            }).done(function (element) {\r\n            var saveButtonLabel = (self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"));\r\n            var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n\r\n            $(\".ui-bizagi-button-container div\", self.form.container).remove();\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal=\\\"0\\\" id=\\\"formButton0\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\r\n                    saveButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"0\\\"]\", \"click\", function () {\r\n                self.form.submitForm();\r\n            });\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal=\\\"1\\\" id=\\\"formButton1\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\r\n                    cancelButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"1\\\"]\", \"click\", function () {\r\n                self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                self.goBack();\r\n            });\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function () {\r\n                self.renderSlideForm(params);\r\n            });\r\n        }).fail(function (message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.tmpl(errorTemplate, {message: error_message}).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone ECM Slide Implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will shows a ECM form\r\n */\r\n$.Class.extend(\"bizagi.rendering.smartphone.slide.ecm\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param dataService\r\n     * @param renderFactory\r\n     * @param slideFormParams\r\n     */\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n\r\n        self.slideFormParams = slideFormParams || {};\r\n        self.slideFormDeferred = new $.Deferred();\r\n\r\n        // Create container\r\n        self.container = self.slideFormParams.navigation.createRenderContainer({title: self.slideFormParams.title});\r\n    },\r\n\r\n    /**\r\n     * Render the form\r\n     * @param params\r\n     */\r\n    render: function (params) {\r\n\r\n        // Fill content\r\n        this.renderSlideForm(params);\r\n\r\n        // Return promise\r\n        return this.slideFormDeferred.promise();\r\n    },\r\n\r\n    renderSlideForm: function (params) {\r\n        var self = this;\r\n        var data = self.getMetadataForm(params);\r\n\r\n        // Load template and data\r\n        self.form = self.renderFactory.getContainer({\r\n            type: \"form\",\r\n            data: data.form,\r\n            navigation: self.slideFormParams.navigation,\r\n            view_container: self.container\r\n        });\r\n\r\n        // Binds the view close event\r\n        /*self.container.element.bind(\"close\", function () {\r\n            // delete self.container;\r\n            console.log(\"closed!\");\r\n        });*/\r\n\r\n        $.when(self.form.render())\r\n            .done(function ($renderEdition) {\r\n\r\n                // Append form in the slide view\r\n                self.container.element.html($renderEdition);\r\n\r\n                self.slideFormParams.navigation.navigate(self.container.id);\r\n\r\n                self.processButtons(self.form, params);\r\n                self.container.setNavigationButtons(self.form);\r\n\r\n                // Publish an event to check if the form has been set in the DOM\r\n                self.form.triggerHandler(\"ondomincluded\");\r\n\r\n                // Attach a refresh handler to recreate all the form\r\n                /*self.form.bind(\"refresh\", function () {\r\n                    // self.renderSlideForm(params);\r\n                });*/\r\n\r\n            }).always(function () {\r\n            self.slideFormDeferred.resolve();\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Shows the slideForm form container in the browser\r\n     * @returns {} Returns a promise that the dialog will be closed\r\n     */\r\n    processButtons: function (form, params) {\r\n        var self = this;\r\n\r\n        form.buttons = [\r\n            {\r\n                ordinal: 0,\r\n                action: \"save\",\r\n                caption: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                callback: self.onSaveDataMetadataForm.bind(self, params.fileData)\r\n            },\r\n            {\r\n                ordinal: 1,\r\n                action: \"back\",\r\n                caption: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                callback: function () {\r\n                    self.slideFormParams.onCancel({});\r\n\r\n                    self.goBack();\r\n                }\r\n            }\r\n        ];\r\n\r\n        // Add save button if the form is editable\r\n        if (!self.slideFormParams.editable) {\r\n            form.buttons.shift();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process render data\r\n     * @param params\r\n     * @returns {{form: *, type: string}}\r\n     */\r\n    getMetadataForm: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            type: \"form\",\r\n            form: {\r\n                elements: [],\r\n                pageCacheId: params.pageCacheId,\r\n                sessionId: params.sessionId,\r\n                properties: {\r\n                    id: 101,\r\n                    xpathContext: params.xpathContext,\r\n                    editable: self.slideFormParams.editable,\r\n                    orientation: self.slideFormParams.orientation || \"ltr\"\r\n                }\r\n            }\r\n        };\r\n\r\n        // Mapping metadata to render\r\n        $.each(params.metadata, function (index, item) {\r\n            var renderType = self.getRenderType(item.metadataType);\r\n\r\n            var newRender = Object.assign({\r\n                \"id\": (index + 1),\r\n                \"xpath\": item.metadataId,\r\n                \"displayName\": item.description,\r\n                \"required\": bizagi.util.parseBoolean(item.required) === true,\r\n                \"editable\": bizagi.util.parseBoolean(item.readOnly) === false,\r\n                \"value\": item.value\r\n            }, renderType);\r\n\r\n            data.form.elements.push({\"render\": {\"properties\": newRender}});\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Get type of render\r\n     * @param type\r\n     * @returns {*}\r\n     */\r\n    getRenderType: function (type) {\r\n        switch (type.toUpperCase()) {\r\n            case \"INTEGER\":\r\n                return {\r\n                    type: \"number\",\r\n                    dataType: 2,\r\n                    allowDecimals: false,\r\n                    thousands: false\r\n                };\r\n            case \"DECIMAL\":\r\n                return {\r\n                    type: \"number\",\r\n                    dataType: 10,\r\n                    allowDecimals: true,\r\n                    thousands: true\r\n                };\r\n            case \"DATETIME\":\r\n                return {type: \"date\", dataType: 12};\r\n            case \"BOOL\":\r\n                return {type: \"boolean\", dataType: 5};\r\n            case \"STRING\":\r\n            default:\r\n                return {\r\n                    type: \"text\",\r\n                    dataType: 15,\r\n                    maxLength: 50,\r\n                    autoExtend: false\r\n                };\r\n\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Save data to ECM form\r\n     * @returns {jQuery}\r\n     * @param fileData\r\n     */\r\n    onSaveDataMetadataForm: function (fileData) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        if (self.form.validateForm()) {\r\n            // Check if the add form has data\r\n            var formData = {};\r\n            self.form.collectRenderValuesForSubmit(formData);\r\n\r\n            // Turn off flag\r\n            $.forceCollectData = false;\r\n\r\n            if (!bizagi.util.isMapEmpty(formData)) {\r\n\r\n                var metadataValues = Object.keys(formData)\r\n                    .map(function (key, index) {\r\n                        return {\"idMetadata\": key, \"value\": formData[key]};\r\n                    });\r\n\r\n                var params = {\r\n                    \"idFileUpload\": fileData.idFileUpload,\r\n                    \"fileName\": fileData.fileName,\r\n                    \"idPageCache\": fileData.idPageCache,\r\n                    \"xpathContext\": fileData.xpathContext,\r\n                    \"xPath\": fileData.xpath,\r\n                    \"idAttrib\": fileData.idAttrib\r\n                };\r\n\r\n                params.metaValues = JSON.encode({metadataValues: metadataValues});\r\n                bizagi.loading.start();\r\n\r\n                $.when(self.dataService.updateECMMetadata(params))\r\n                    .done(function (fileProperties) {\r\n                        if (fileProperties && fileProperties.idFileUpload) {\r\n\r\n                            self.slideFormParams.onSave({\r\n                                update: true,\r\n                                idFileUpload: fileProperties.idFileUpload,\r\n                                fileName: fileData.fileName\r\n                            });\r\n\r\n                            deferred.resolve({update: true});\r\n                        }\r\n\r\n                        self.goBack();\r\n\r\n                    }).fail(function (message) {\r\n                    self.form.addValidationMessage(message.message);\r\n                    deferred.reject();\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            } else {\r\n                self.slideFormParams.onSave({update: false});\r\n                deferred.resolve({update: false});\r\n                self.goBack();\r\n            }\r\n        }\r\n\r\n        deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     */\r\n    goBack: function () {\r\n        this.container.destroy();\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.text\", bizagi.rendering.text.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.text.extend(\"bizagi.rendering.smartphone.text\", {}, {\r\n\r\n    //#region Side effects funtions\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base \r\n        this._super();\r\n\r\n        // Define max length of element\r\n        if (this.properties.maxLength > 0)\r\n            this.input.attr(\"maxlength\", this.properties.maxLength);\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"text-read-only\");\r\n        var value = this.getValue();\r\n        value = (typeof value !== \"undefined\" && value !== null) ? bizagi.util.sanitizeHTML(value) : \"\";\r\n        \r\n        var data = {\r\n            value: value,\r\n            editable: this.properties.editable\r\n        };\r\n\r\n        return $.fasttmpl(template, data);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = this.validateValue((typeof (decodedValue) == \"string\" ? decodedValue : \"\"), self.properties.maxLength);\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (value) {\r\n            value = $.br2nl(value).replaceAll('\\\\n', '\\n') ;            \r\n        }\r\n\r\n       // Set value in input           \r\n        if (self.properties.editable){                   \r\n            self.input.val(value);\r\n        } else {\r\n            $(\".bz-text-readonly\", self.getControl()).html(bizagi.util.sanitizeHTML(value));\r\n        }        \r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible) {\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \r\n    getElementsToStylize: function($context){\r\n        return this.properties.editable ? $(\"input\", $context) : $(\".bz-text-readonly\", $context); \r\n    },\r\n    //#endregion Side effects funtions\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Render Text Extension\r\n*   Author: UI Forms Team\r\n*   Comments: Extended text implementation\r\n*/\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.extendedText\", bizagi.rendering.extendedText.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.extendedText.extend(\"bizagi.rendering.smartphone.extendedText\", {\r\n    minLines: 2,\r\n    maxLines: 8,\r\n    maxCharactersToShow: 100\r\n}, {\r\n\r\n    //#region Side effects funtions\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();        \r\n        self.textarea = self.getControl().find(\"textarea\");        \r\n        if (self.textarea) self.textarea.css({resize: \"vertical\"});        \r\n    },\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data      \r\n     */\r\n    initializeData: function(data) {   \r\n        // Call base\r\n        this._super(data);\r\n        var maxLines = this.properties.maxLines;\r\n        this.properties.maxLines = maxLines > this.Class.maxLines ? this.Class.maxLines : (maxLines < this.Class.minLines ? this.Class.minLines : maxLines);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values     \r\n     */\r\n    renderReadOnly: function() {        \r\n        var template = this.renderFactory.getTemplate(\"extendedText-readOnly\");\r\n        var value = this.getValue();\r\n        value = (typeof value !== \"undefined\" && value !== null) ? bizagi.util.sanitizeHTML(value) : \"\";\r\n        var showChar = this.Class.maxCharactersToShow;\r\n\r\n        var startString = value.substr(0, showChar);\r\n        var endString = value.substr(showChar-1, value.length - showChar);\r\n\r\n        var data = {\r\n            \"value\": value,\r\n            \"startString\": startString,\r\n            \"endString\": endString\r\n        };\r\n\r\n        return $.fasttmpl(template, data);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the redered control\r\n     * @param {} value      \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = self.validateValue(typeof (decodedValue) == \"string\" ? decodedValue : \"\", self.properties.maxLength);\r\n\r\n        // Call base        \r\n        self.setValue(value, false);\r\n\r\n        if (value) {\r\n            value = $.br2nl(value).replaceAll('\\\\n', '\\n') ;            \r\n        }\r\n        \r\n        // Set value in input\r\n        if (self.properties.editable){   \r\n            self.textarea.val(value);\r\n        } else {\r\n            $(\".bz-textarea-readonly\", self.getControl()).html(bizagi.util.sanitizeHTML(value));\r\n        }        \r\n    },\r\n\r\n    /**\r\n     * Implement to customize the render's behaviour to add handlers     \r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Define max length of element\r\n\r\n        // Cuando el tipo de dato es extended manda como maxlength 0 por lo que la validacion no puede ir sobre todo el metodo\r\n        if (self.properties.maxLength > 0) {\r\n            self.textarea.attr(\"maxlength\", self.properties.maxLength);\r\n            self.actualMaxLength = self.properties.maxLength;\r\n        }\r\n\r\n        $(self.textarea).bind(\"focus keyup paste\", function(e) {\r\n            if (e.which === 8 || e.which === 46) {\r\n                var currentRow = self.textarea.prop(\"rows\");\r\n                if (currentRow > self.properties.maxLines){\r\n                    self.textarea.prop(\"rows\", self.properties.maxLines);\r\n                }\r\n            }\r\n            self.updateTextareaSize(this);\r\n        });\r\n\r\n        $(self.textarea).bind(\"blur\", function(e) {\r\n            self.textarea.prop(\"rows\", self.properties.maxLines);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sets the functions when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function(){\r\n        var self = this;\r\n\r\n        var $control = this.getControl();\r\n        $(\".bz-textarea-readonly\", $control).on(\"click\", \".bz-read-more\", function(e){\r\n            if($(e.delegateTarget).hasClass(\"bz-textarea-readonly--active\")) {\r\n                $(e.delegateTarget).removeClass(\"bz-textarea-readonly--active\");\r\n                $(this).html(self.getResource(\"workportal-project-discussion-comment-viewmore\"));\r\n            } else {\r\n                $(e.delegateTarget).addClass(\"bz-textarea-readonly--active\");\r\n                $(this).html(self.getResource(\"workportal-project-discussion-comment-viewless\"));\r\n            }\r\n            return false;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Changes control's height when it's auto extended\r\n     * @param {Object} control HTML Object          \r\n     */     \r\n    updateTextareaSize: function(textarea){\r\n        if (this.properties.autoExtend){\r\n            var currentRows = $(textarea).prop(\"rows\");\r\n            if (textarea.scrollHeight > textarea.offsetHeight && currentRows >= this.Class.minLines && currentRows < this.Class.maxLines){\r\n                //Extend the rows\r\n                $(textarea).prop(\"rows\", (currentRows + 1));\r\n                this.updateTextareaSize(textarea);\r\n            }           \r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler of retype double actions\r\n     */\r\n    attachRetypeDouble: function() {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input, textarea\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function() {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n\r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\")) {\r\n                    $(this).data().newValue = undefined;\r\n                }\r\n            }\r\n\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Retype actions\r\n     * @param {} control      \r\n     */\r\n    retypeDouble: function(control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue == \"\") return;\r\n\r\n                if (currentValue !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n    getElementsToStylize: function ($context) {\r\n        return this.properties.editable ? $(\"textarea\", $context) : $(\".bz-textarea-readonly\", $context); \r\n    },\r\n    //#endregion Side effects funtions\r\n});","/**\r\n *   Name: Bizagi Smartphone Render Label Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the label render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.label\", bizagi.rendering.label.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.label.extend(\"bizagi.rendering.smartphone.label\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Render Number Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.number\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.number.extend(\"bizagi.rendering.smartphone.number\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"number\");\r\n\r\n        return $.fasttmpl(template, {\r\n            value: self.getDisplayValue(),\r\n            editable: self.properties.editable,\r\n            type: \"text\",\r\n            isDesign: self.getMode() !== \"execution\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self.setValue(value, false);\r\n\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            self.value = self.properties.value = value;\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Retype function\r\n     */\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            var typeControl = self.parent.properties.type;\r\n\r\n            if (typeControl === \"grid\") {\r\n                if (previousValue != null && value !== previousValue) {\r\n                    if ($(this).data(\"newValue\") !== undefined && control.val() !== $(this).data(\"newValue\"))\r\n                        $(this).data().newValue = undefined;\r\n                }\r\n\r\n                self.retypeDouble(control);\r\n            } else {\r\n                self.retypeDouble(control);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Retype function\r\n     * @param control\r\n     */\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") === undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Context to apply styles\r\n     * @param context\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\"input\", $context); \r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the money render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.money\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.money.extend(\"bizagi.rendering.smartphone.money\", bizagi.rendering.money.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.money.extend(\"bizagi.rendering.smartphone.money\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"number\");\r\n\r\n        return $.fasttmpl(template, {\r\n            value: self.getDisplayValue(),\r\n            editable: self.properties.editable,\r\n            type: \"text\",\r\n            isDesign: self.getMode() !== \"execution\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Call base\r\n        this.setValue(value, false);\r\n\r\n        // Set value in input\r\n        if (value !== undefined && value !== null && this.properties.editable) {\r\n            this.numericInput.val(value);\r\n\r\n            // Formats the input\r\n            this.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Context to apply styles\r\n     * @param context\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n    /*getElementsToStylize: function (context) {\r\n        return $(\".bz-input\", context);\r\n    }*/\r\n\r\n    \r\n    getElementsToStylize: function($context){\r\n        return  $(\"input\", $context);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the date render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.date\", bizagi.rendering.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.date.extend(\"bizagi.rendering.smartphone.date\", {\r\n    MAX_YEARS_DISPLAY: 100\r\n}, {\r\n\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var value = this.getFormattedDate(this.getValue(), this.properties.showTime, true)\r\n        value = bizagi.util.dateFormatter.formatDate(value, this.properties.fullFormat);\r\n        var data = {value: value, editable: this.properties.editable};\r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.fasttmpl(template, data);\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.input = $(\"input\", this.getDateControl());\r\n    },\r\n\r\n    /**\r\n     * To configure the mobiscroll plugin\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n        this.input = $(\"input\", this.getDateControl());\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var controlElements = self.properties.showTime ? [\"calendar\", \"time\"] : [\"calendar\"];\r\n\r\n        var defaultDateControl = self.getFormattedDate(self.properties.value, self.properties.showTime, true);\r\n        var minDateControl = self.getFormattedDate(self.properties.minValue, self.properties.showTime, false);\r\n        var maxDateControl = self.getFormattedDate(self.properties.maxValue, self.properties.showTime, false);\r\n\r\n        var timeFormat = self.properties.showTime ? self.getTimeFormat() : \"\";\r\n\r\n        // Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(minDateControl))) {\r\n            minDateControl = new Date();\r\n            minDateControl.setFullYear(minDateControl.getFullYear() - self.Class.MAX_YEARS_DISPLAY);\r\n            minDateControl.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        // Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(maxDateControl))) {\r\n            maxDateControl = new Date();\r\n            maxDateControl.setFullYear(maxDateControl.getFullYear() + self.Class.MAX_YEARS_DISPLAY);\r\n            maxDateControl.setHours(23, 59, 59);\r\n        }\r\n\r\n        $(\".bz-input-icon\", this.getControl()).mobiscroll().calendar({\r\n            mode: \"mixed\", // Specify scroller mode like: mode: 'mixed' or omit setting to use default\r\n            display: \"bottom\", // Specify display mode like: display: 'bottom' or omit setting to use default\r\n            controls: controlElements,\r\n            min: minDateControl,\r\n            max: maxDateControl,\r\n            defaultValue: defaultDateControl,\r\n            timeFormat: timeFormat,\r\n            showScrollArrows: true,\r\n            lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n            headerText: \"{value}\",\r\n            buttons: [\r\n                \"set\",\r\n                {\r\n                    text: this.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n                    handler: function (e, inst) {\r\n                        self.date = undefined;\r\n                        self.time = undefined;\r\n                        self.timeS = undefined;\r\n                        self.onChangeHandler(true);\r\n                        inst.clear();\r\n                    }\r\n                },\r\n                \"cancel\"\r\n            ],\r\n            onSet: function (valueText, inst) {\r\n                var data = inst.getVal();\r\n                self.date = {\"day\": data.getDate(), \"month\": data.getMonth(), \"year\": data.getFullYear()};\r\n\r\n                //Checks if its has time, and included it\r\n                if (self.properties.showTime) {\r\n                    self.time = {\"hours\": data.getHours(), \"minutes\": data.getMinutes()};\r\n                    if (!self.is24h) {\r\n                        self.timeS = data.getHours() < 12 ? \"am\" : \"pm\";\r\n                    }\r\n                }\r\n\r\n                self.onChangeHandler();\r\n            },\r\n            onBeforeShow: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n\r\n                //TODO temporal fix in ios smartphone when a notification container is already displayed (QAF-6385 / MOB-171), review mobiscroll.min versions\r\n                if (bizagi.util.isiOSDevice()) {\r\n                    $(\".ui-bizagi-notifications-container\").css(\"display\", \"none\");\r\n                }\r\n            },\r\n            onClose: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"auto\");\r\n            },\r\n            onShow: function (event, inst) {\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"hidden\");\r\n            }\r\n        });\r\n\r\n        // Bind event for change value\r\n        this.input.on(\"focus\", function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isAndroidDevice()) {\r\n                cordova.plugins.Keyboard.disableScroll(true);\r\n                cordova.plugins.Keyboard.close();\r\n            }\r\n        });\r\n\r\n        //Set input displayValue if it has default value\r\n        if (self.properties.displayValue === \"\" && self.properties.value) {\r\n            var date = self.getFormattedDate(self.properties.value, self.properties.showTime, true, false);\r\n            if (typeof (date) !== \"undefined\") {\r\n                var displayValue = bizagi.util.dateFormatter.formatDate(date, self.properties.fullFormat);\r\n                this.input.prop(\"value\", displayValue);\r\n            }\r\n        }\r\n\r\n        this.input.attr(\"keyboard\", \"disable\");\r\n    },\r\n\r\n    /**\r\n     * Configure the timeformat\r\n     */\r\n    getTimeFormat: function () {\r\n        if (this.properties.timeFormat.indexOf(\"H\") !== -1 || this.properties.timeFormat.indexOf(\"HH\") !== -1) {\r\n            this.is24h = true;\r\n            return \"HH:ii\";\r\n        } else {\r\n            this.is24h = false;\r\n            return \"hh:ii A\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date whit the Invariant and ISO Format applied.\r\n     */\r\n    getFormattedDate: function (date, showTime, initializer) {\r\n        var self = this;\r\n        \r\n        if (!date || bizagi.util.isObjectEmpty(date)) return;\r\n        date = (typeof date != \"string\") ? date.toString() : date;\r\n\r\n        //There are some dates that haven't time,... actions and validations for example or when we have to put a initial value (default value without time),\r\n        //in that cases we should identify the case and if the date haven't the time value, we have to add (00:00:00) it to can apply the format (getDateFromInvariant).\r\n        var time = (showTime && (self.getTime() === \"0:0\" || initializer)) ? \" \" + date.substr(date.length - 8, date.length) : \"\";\r\n\r\n        var currentDate = (initializer && showTime && time.split(\"/\").length > 1) || (date.split(\":\").length === 1) ? date += \" 00:00:00\" : date;\r\n        date = bizagi.util.dateFormatter.getDateFromInvariant(currentDate, showTime);\r\n\r\n        var currentTime = showTime ? time !== \"\" ? time : \" \" + self.getTime() : \" 00:00\";\r\n        var fullDateFormated = self.setHour(self.getFullFormatedDate(date, currentTime));\r\n\r\n        fullDateFormated = bizagi.util.dateFormatter.getDateFromISO(fullDateFormated, true);\r\n\r\n        return fullDateFormated;\r\n    },\r\n\r\n    /**\r\n     * Changes the render min value\r\n     * @param {} value\r\n     */\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', {min: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', {min: bizagi.util.dateFormatter.getDateFromInvariant(value, true)});\r\n            }\r\n\r\n            properties.minValue = value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Changes the render max value\r\n     * @param {} value\r\n     */\r\n    changeMaxValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', {max: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', {max: bizagi.util.dateFormatter.getDateFromInvariant(value, true)});\r\n            }\r\n\r\n            properties.maxValue = value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Set the display value on input\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var date = self.getFormattedDate(value, self.properties.showTime, false);\r\n        var displayValue = self.preprocessDateValue(date);\r\n\r\n        self.input = self.input ? self.input : self.getDateControl();\r\n\r\n        if (self.properties.editable === false) {\r\n            // Render as simple value\r\n            if (typeof (displayValue) === \"string\" || typeof (displayValue) === \"number\") {\r\n                self.input.html(displayValue);\r\n            }\r\n        } else {\r\n            self.input.prop(\"value\", displayValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get the DOM Control\r\n     */\r\n    getDateControl: function () {\r\n        return $(\".bz-input-icon\", this.getControl());\r\n    },\r\n\r\n    /**\r\n     * Get Time from mobiscroll\r\n     */\r\n    getTime: function () {\r\n        var self = this;\r\n\r\n        //Converting the time in 24h format.\r\n        if (self.properties.showTime && (self.time && self.time[\"minutes\"] !== \"\")) {\r\n            var time = self.time[\"hours\"] + \":\" + self.time[\"minutes\"];\r\n            time += self.timeS;\r\n\r\n            if (time.indexOf(\"am\") != -1 && self.time[\"hours\"] == 12) {\r\n                time = time.replace(\"12\", \"0\");\r\n            }\r\n\r\n            if (time.indexOf(\"pm\") != -1 && self.time[\"hours\"] < 12) {\r\n                time = time.replace(self.time[\"hours\"], (parseInt(self.time[\"hours\"]) + 12));\r\n            }\r\n\r\n            return time.replace(/(am|pm)/, '');\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date from mobiscroll\r\n     * */\r\n    getDate: function () {\r\n        if (this.date && this.date[\"month\"] !== \"\") {\r\n            return this.date[\"year\"] + \"-\" + (parseInt(this.date[\"month\"]) + 1) + \"-\" + this.date[\"day\"];\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Set the control value when the control change\r\n     */\r\n    onChangeHandler: function (isClearButton) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentDate = self.getDate();\r\n        var currentTime = (properties.showTime) ? \" \" + self.getTime() : \" 0:00\";\r\n\r\n        // If curren date is empty reset actual value\r\n        if ((currentDate === \"\" && !properties.showTime) || (currentDate === \"\" && currentTime === \"\") || (isClearButton)) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            properties.displayValue = \"\";\r\n        } else {\r\n            var formatedFullDate = self.setHour(self.getFullFormatedDate(currentDate, currentTime));\r\n\r\n            formatedFullDate = bizagi.util.dateFormatter.getDateFromISO(formatedFullDate, true);\r\n\r\n            if (!formatedFullDate || formatedFullDate == 0) return;\r\n\r\n            // Set date value\r\n            self.setNewDateValue(formatedFullDate, properties.showTime);\r\n\r\n            var displayValue = self.preprocessDateValue(formatedFullDate);\r\n            properties.displayValue = displayValue;\r\n\r\n            self.input.prop(\"value\", self.properties.displayValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply the final format that will be showed on the input\r\n     */\r\n    getFullFormatedDate: function (currentDate, currentTime) {\r\n        var fullDate = \"\";\r\n\r\n        if (currentDate.length > 0) {\r\n            fullDate = currentDate;\r\n        } else if (currentDate !== undefined) {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(currentDate, false);\r\n        } else {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(new Date(), false);\r\n        }\r\n\r\n        fullDate += currentTime;\r\n        var dateFromFormat = bizagi.util.dateFormatter.getDateFromFormat(fullDate, \"yyyy-MM-dd H:m\");\r\n\r\n        return bizagi.util.dateFormatter.formatDate(dateFromFormat !== 0 ? dateFromFormat : currentDate, \"yyyy-MM-dd H:mm:ss\");\r\n    },\r\n\r\n    /**\r\n     * Set the control value\r\n     */\r\n    setNewDateValue: function (formatedFullDate, showTime) {\r\n        var value = \"\";\r\n\r\n        if (formatedFullDate != \"\")\r\n            value = bizagi.util.dateFormatter.formatInvariant(formatedFullDate, showTime);\r\n\r\n        this.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Removing the time when be necesary\r\n     */\r\n    applyDateFormat: function (date, showTime) {\r\n        if (!showTime) {\r\n            var initIndexTime = null;\r\n\r\n            if (date.indexOf(\"00:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"00:00\");\r\n            } else if (date.indexOf(\"0:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"0:00\");\r\n            } else if (date.indexOf(\"12:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"12:00\");\r\n            } else {\r\n                initIndexTime = \"-1\";\r\n            }\r\n\r\n            var endIndexTime = initIndexTime + 8;\r\n            date = initIndexTime === -1 ? date : date.replace(date.substring(initIndexTime, endIndexTime), \"\").replace(\" am\", \"\").replace(\" pm\", \"\");\r\n        }\r\n\r\n        return date;\r\n    },\r\n\r\n    /*\r\n     *  Checks if the date could be localized using site language\r\n     */\r\n    preprocessDateValue: function (date) {\r\n        return bizagi.util.dateFormatter.formatDate(date, this.properties.fullFormat);\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable)) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n                if (value != 0) {\r\n                    // Clear time for validations\r\n                    value.setHours(0, 0, 0, 0);\r\n\r\n                    // Check min value and max value\r\n                    if (properties.minValue && typeof (properties.minValue) === 'string') {\r\n                        bValid = self.validateMinAndMaxValue(value, true, properties, invalidElements) ? false : bValid;\r\n                    }\r\n\r\n                    if (properties.maxValue && typeof (properties.maxValue) === 'string') {\r\n                        bValid = self.validateMinAndMaxValue(value, false, properties, invalidElements) ? false : bValid;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(properties.editable)) {\r\n            // Check required\r\n            if (properties.required && !self.hasValue()) {\r\n                self.showMandatoryMessage(properties, invalidElements);\r\n            }\r\n        }\r\n\r\n        if (bValid) {\r\n            // Clear error message\r\n            self.setValidationMessage(\"\");\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * To validate the min and max values\r\n     * @param {} value\r\n     * @param {} isMinValue\r\n     * @param {} properties\r\n     * @param {} invalidElements\r\n     */\r\n    validateMinAndMaxValue: function (value, isMinValue, properties, invalidElements) {\r\n        var vValue = bizagi.util.dateFormatter.getDateFromInvariant(isMinValue ? properties.minValue : properties.maxValue);\r\n\r\n        //In case the value from the minValue or maxValue are assigned from a Date control that does not have the option  \"showTime!\r\n        if (vValue == 0) {\r\n            var resultValue = \"\";\r\n            if (properties.timeFormat.indexOf(\":ss\") == -1) {\r\n                if (isMinValue) {\r\n                    resultValue = properties.minValue + \":00\";\r\n                } else {\r\n                    resultValue = properties.maxValue + \":00\";\r\n                }\r\n            }\r\n\r\n            vValue = bizagi.util.dateFormatter.getDateFromFormat(resultValue, properties.fullFormat + \":ss\");\r\n        }\r\n\r\n        vValue.setHours(0, 0, 0, 0);\r\n\r\n        if ((isMinValue && value < vValue) || (!isMinValue && value > vValue)) {\r\n            var formatedDate = bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat);\r\n            var message = \"\";\r\n\r\n            if (isMinValue) {\r\n                message = this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", formatedDate);\r\n            } else {\r\n                message = this.getResource(\"rendr-date-maximum-validation\").replaceAll(\"#label#\", propertiee).replaceAll(\"#maxValue#\", formatedDate);\r\n            }\r\n\r\n            invalidElements.push({xpath: properties.xpath, message: message});\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * To show the mandatory values message\r\n     * */\r\n    showMandatoryMessage: function (properties, invalidElements) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n\r\n        invalidElements.push({xpath: properties.xpath, message: message});\r\n\r\n        return false;\r\n    },\r\n\r\n    setHour: function (date) {\r\n        return date.replace(\" 0:\", \" 00:\").replace(\" 1:\", \" 01:\").replace(\" 2:\", \" 02:\").replace(\" 3:\", \" 03:\").replace(\" 4:\", \" 04:\").replace(\" 5:\", \" 05:\").replace(\" 6:\", \" 06:\").replace(\" 7:\", \" 07:\").replace(\" 8:\", \" 08:\").replace(\" 9:\", \" 09:\");\r\n    },\r\n\r\n    /**\r\n     * Cleans the control fields as it requires\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.date = undefined;\r\n        self.time = undefined;\r\n        self.timeS = undefined;\r\n        self.onChangeHandler(true);\r\n        self.setDisplayValue('');\r\n    },\r\n    isValidMinMaxValue: function () {\r\n        var self = this;\r\n        var isValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n            if (value !== 0) {\r\n                // Clear time for validations\r\n                value.setHours(0, 0, 0, 0);\r\n\r\n                // Check min value and max value\r\n                if (self.properties.minValue && typeof (self.properties.minValue) === 'string')\r\n                    isValid = self.validateMinAndMaxValue(value, true);\r\n\r\n                if (self.properties.maxValue && typeof (self.properties.maxValue) === 'string')\r\n                    isValid = self.validateMinAndMaxValue(value, false);\r\n            }\r\n        }\r\n\r\n        return isValid;\r\n    },\r\n\r\n    validateMinAndMaxValue: function (currentDate, isMinValue) {\r\n        var self = this;\r\n        var date = isMinValue ? self.properties.minValue : self.properties.maxValue;\r\n        var formattedDate = bizagi.util.dateFormatter.getDateFromInvariant(date);\r\n\r\n        formattedDate.setHours(0, 0, 0, 0);\r\n\r\n        return !((isMinValue && currentDate < formattedDate) || (!isMinValue && currentDate > formattedDate));\r\n\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {        \r\n        return $(\"input\", $context); \r\n    }\r\n});","/**\r\n * Tablet definition of Action Launcher\r\n *\r\n * @author: Ricardo Prez\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.actionLauncher\", bizagi.rendering.actionLauncher.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.actionLauncher.extend(\"bizagi.rendering.smartphone.actionLauncher\", {}, {\r\n    \r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function () {\r\n        if (this.getMode() == \"design\"){\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        self.actions = [];\r\n        self.startLoading();\r\n\r\n        // Define params to get list of actions        \r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n            .then(function (response) {\r\n                response = self.getPropertiesActionLaucher(response);\r\n                self.actions = response;\r\n                self.deferredActions.resolve(response);\r\n\r\n                if (self.actions.length > 0) {\r\n                    $(\"[data-element='actions-add-btn']\", control).show();\r\n                }\r\n                else{\r\n                    $(\"[data-element='actions-add-btn']\", control).hide();\r\n                }\r\n\r\n                if (properties.isHorizontal) {\r\n                    if (properties.templatetype != \"none\") {\r\n                        return self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n                            .then(function (templateData) {\r\n                                return self.engine.render($.extend(templateData, {\r\n                                    isDefaultTemplate: properties.templatetype === \"default\",\r\n                                    sessionId: self.properties.sessionId\r\n                                }), self.processPropertyValueDataTmplArgs);\r\n                            }).then(function (tmpl) {\r\n                                template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                var html = $($.fasttmpl(template, {\r\n                                    template: true\r\n                                }));\r\n\r\n                                $(\".bz-template\", html.wrap(\"<div>\").parent()).append(tmpl);\r\n                                return html;\r\n                            });\r\n                    }\r\n                }\r\n                else{\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                    return $.fasttmpl(template, {\r\n                        template: false\r\n                    });\r\n                }\r\n            }).done(function (html) {\r\n                $(\"[data-element='template-container']\", control).append(html);\r\n                self.configureActionsHandlers();\r\n                self.configureTemplateHandlers();\r\n            }).always(function () {\r\n                self.endLoading();\r\n            });\r\n    },\r\n\r\n\r\n    /**\r\n     * Validates if the action launcher control contains a valid value\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n        return typeof value !== \"undefined\" && value !== null && value.length > 0;\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureActionsHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionLauncherControls = $(\".action-launcher-control\", control);\r\n\r\n        //Binding for click action on buttons\r\n        actionLauncherControls.on(\"click\", function () {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\r\n                readOnlyForm: item[6] || false,\r\n                guidEntity: self.properties.guidEntity,\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            self.processAction(action);\r\n        });\r\n\r\n        var actions = [];\r\n        for (var i = 0, length = self.actions.length; i < length; i++) {\r\n            actions.push({\r\n                guid: self.actions[i][0],\r\n                displayName: self.actions[i][1]\r\n            });\r\n        }\r\n\r\n\r\n        //Binding for click action sheet\r\n        $(\"[data-element='actions-add-btn']\", control).actionSheet({\r\n            actions: actions,\r\n            actionClicked: function (action) {\r\n                var item = self.actions.find(function (element) {\r\n                    return element[0] == action.guid;\r\n                });\r\n\r\n                self.processAction({\r\n                    guidProcess: item[0],\r\n                    guidAction: item[4],\r\n                    displayName: item[1],\r\n                    actionType: item[3],\r\n                    xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\r\n                    readOnlyForm: item[6] || false,\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                });\r\n            }\r\n        });\r\n\r\n        //Catch the typed text in the search field and filter the action list\r\n        $.expr[\":\"].FilterAction = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) {\r\n                return false;\r\n            }\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".action-launcher-control\", control).show();\r\n            if (search) {\r\n                $(\".action-launcher-control\", control)\r\n                    .not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     */\r\n    configureTemplateHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Catch the event from the layout link\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\r\n            params.filters = [];\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n\r\n        $(\".bz-template-more-or-less\", control).bind(\"click\", function(){\r\n            $(\".bz-template\", control).toggleClass(\"bz-template--collapsed\");\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     */\r\n    processAction: function (action) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties.multipleSelection;\r\n\r\n        if (multipleSelection) {\r\n            // If this is a form and has been queued, so open it\r\n            if (action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                //Open action\r\n                $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        } else if (self.getValue().length > 0) {\r\n            self.showConfirmationDialog(action);\r\n        } else {\r\n            $.when(self.actionManager(action)).done(function (act) {\r\n                self.executeAction(act);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @param action\r\n     */\r\n    notifyExecution: function (data, action) {\r\n        var self = this;\r\n\r\n        if (data.response == \"success\") {\r\n            $.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        } else {\r\n            $.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionForm: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getParams();\r\n\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    if (!action.editMode && self.countSameActions(action) === 0) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        var renderParams = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        };\r\n\r\n        if (action.actionType === \"Form\") {\r\n            renderParams.contextType = \"entitytemplate\";\r\n            renderParams.xpathContext = undefined;\r\n            renderParams.guidEntity = action.guidEntity;\r\n            renderParams.rewriteContextType = true;\r\n        }\r\n\r\n        slideForm.render(renderParams);\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionFormCollection: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext !== \"\") ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext !== \"\") ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\r\n        var formParams = form.getParams();\r\n\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                if (action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).done(function (savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).done(function (savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": formParams.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function (args) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        // Show dialog\r\n        var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\r\n            title: args.title || \"\",\r\n            navigation: formParams.navigation,\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\")\r\n                ? bizagi.localization.getResource(\"render-form-button-create\")\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n        // Render the search form\r\n        slideForm.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     */\r\n    executeAction: function (action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function () {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the confirmation dialog\r\n     * bizagi.createOkCancelPopup\r\n     * @param action\r\n     * */\r\n    showConfirmationDialog: function (action) {\r\n        var self = this;\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\r\n        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n            .done(function () {\r\n                self.setValue([]);\r\n\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\"[data-element='actions-container']\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        $.when(self.deferredActions).done(function (listOfActions) {\r\n            var getMappingAction = function (guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function (key, value) {\r\n                    if (value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n\r\n                return mapping;\r\n\r\n            };\r\n\r\n            $.each(data, function (key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if (data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if (data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if (data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n\r\n            if (data.length > 0){\r\n                $.when($.fasttmpl(template, { actions: data })).done(function (html) {\r\n                    actionsToExecuteContainer.empty();\r\n                    actionsToExecuteContainer.append(html);\r\n\r\n                    var removeActionSelector = $(\".bz-actions-to-execute .bz-btn-icn\", actionsToExecuteContainer);\r\n                    var openActionSelector = $(\"label\", actionsToExecuteContainer);\r\n\r\n                    removeActionSelector.on(\"click\", function () {\r\n                        var index = $(this).parent().data(\"index\");\r\n                        self.removeActionToQueue(index);\r\n                    });\r\n\r\n                    openActionSelector.on(\"click\", function () {\r\n                        var target = $(this).parent();\r\n                        var type = target.data(\"actiontype\");\r\n                        var guidprocess = target.data(\"guidprocess\");\r\n                        var idStartScope = target.data(\"idstartscope\");\r\n                        var title = target.data(\"title\");\r\n                        // When undefined return string \"undefined\" instead of type \"undefined\"\r\n                        var xpathContext = target.data(\"xpathcontext\");\r\n                        var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                        var idEntity = target.data(\"identity\") || \"\";\r\n                        var guidAction = target.data(\"guidaction\");\r\n                        var recordXpath = xpathContext || self.properties.xpathContext;\r\n                        switch (type) {\r\n                            case \"Process\":\r\n                                if (idStartScope) {\r\n                                    self.processStartForm({\r\n                                        guidprocess: guidprocess,\r\n                                        idStartScope: idStartScope,\r\n                                        title: title,\r\n                                        xpathContext: xpathContext,\r\n                                        recordXpath: recordXpath\r\n                                    });\r\n                                }\r\n                                break;\r\n                            case \"Form\":\r\n                                var action = {\r\n                                    guidProcess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    editMode: true,\r\n                                    xpathContext: xpathContext,\r\n                                    readOnlyForm: readOnlyForm,\r\n                                    idEntity: idEntity,\r\n                                    recordXpath: recordXpath\r\n                                };\r\n\r\n                                if (action.xpathContext) {\r\n                                    self.processActionFormCollection(action);\r\n                                } else {\r\n                                    // Convert string \"undefined\" into type \"undefined\"\r\n                                    action.xpathContext = undefined;\r\n\r\n                                    // Add parameters if action form\r\n                                    var extraParams = {};\r\n                                    var dataAction = self.value.filter(function (item) {\r\n                                        return item.guidAction == guidAction;\r\n                                    });\r\n\r\n                                    if (dataAction.length > 0) {\r\n                                        extraParams = {\r\n                                            actionType: \"Form\",\r\n                                            contextType: \"entitytemplate\",\r\n                                            guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                        }\r\n                                    }\r\n\r\n                                    self.processActionForm($.extend(action, extraParams));\r\n                                }\r\n                                break;\r\n                            case \"Rule\":\r\n                                // Rules dont have forms or something like that\r\n                                break;\r\n                        }\r\n                    });\r\n                });\r\n            }else{\r\n                actionsToExecuteContainer.empty();\r\n            }\r\n\r\n        });\r\n    },\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".action-to-execute-label\", control);\r\n\r\n        if (self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/**\r\n * Tablet definition of entity template\r\n *\r\n * @author: Ricardo Prez\r\n */\r\n\r\nbizagi.rendering.smartphone.actionLauncher.extend(\"bizagi.rendering.smartphone.entityTemplate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for smartphone device\r\n     */\r\n    postRender: function() {\r\n        if (this.getMode() == \"design\"){\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        self.actions = [];\r\n        self.configureQueueVisibility();\r\n        self.startLoading();\r\n\r\n        // Define params to get template               \r\n        self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n            .then(function(templateData) {\r\n                return self.engine.render(templateData, self.processPropertyValueDataTmplArgs)\r\n                    .then(function(tmpl) {\r\n                        var template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\")\r\n                        var html = $($.fasttmpl(template, { template: true }));\r\n                        $(\".bz-template\", html.wrap(\"<div>\").parent()).append(tmpl);\r\n\r\n                        if (properties.allowactions) {\r\n                           return self.dataService.multiaction().getActions(self.processPropertyValueArgs)\r\n                                .then(function(response) {\r\n                                    self.deferredActions.resolve(response);\r\n                                    self.actions = response;\r\n\r\n                                    if (self.actions.length > 0) {\r\n                                        $(\"[data-element='actions-add-btn']\", control).show();\r\n                                    }\r\n                                    else{\r\n                                        $(\"[data-element='actions-add-btn']\", control).hide();\r\n                                    }\r\n                                    return html;\r\n                                });\r\n                        }\r\n                        else{\r\n                            return html;    \r\n                        }\r\n                    });\r\n                    \r\n            }).done(function(html) {\r\n                $(\"[data-element='template-container']\", control).append(html);\r\n                self.configureActionsHandlers();\r\n                self.configureTemplateHandlers();\r\n            }).always(function() {\r\n                self.endLoading();\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureActionsHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n        /**\r\n         * Binding for click action on buttons\r\n         */\r\n        entityTemplateControls.on(\"click\", function() {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\"),\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            if (action.actionType === \"Form\") {\r\n                action.xpathContext = undefined;\r\n                action.contextType = \"entitytemplate\";\r\n                action.guidEntity = self.properties.guidEntity;\r\n            }\r\n\r\n            self.processAction(action);\r\n        });\r\n\r\n        var actions = [];\r\n        for (var i = 0, len = self.actions.length; i < len; i++) {\r\n            actions.push({\r\n                guid: self.actions[i][0],\r\n                displayName: self.actions[i][1]\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Binding for click action sheet\r\n         */\r\n        $(\"[data-element='actions-add-btn']\", control).actionSheet({\r\n            actions: actions,\r\n            actionClicked: function(action) {\r\n                var item = self.actions.find(function(e) {\r\n                    return e[0] == action.guid;\r\n                });\r\n                self.processAction({\r\n                    guidProcess: item[0],\r\n                    guidAction: item[4],\r\n                    displayName: item[1],\r\n                    actionType: item[3],\r\n                    xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\")\r\n                });\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    configureTemplateHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        /**\r\n         * Catch the event from the layout link\r\n         */\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function(ev, params) {\r\n            params.filters = [];\r\n            params.calculateFilters = params.calculateFilters || true;\r\n\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n\r\n        $(\".bz-template-more-or-less\", control).bind(\"click\", function(){\r\n            $(\".bz-template\", control).toggleClass(\"bz-template--collapsed\");\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Andres Felipe Arenas\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.polymorphicLauncher\", bizagi.rendering.polymorphicLauncher.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.polymorphicLauncher.extend(\"bizagi.rendering.smartphone.polymorphicLauncher\", {}, {\r\n    /**\r\n      * Render a specific implementation for Smartphone device\r\n      */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n\r\n        if (mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n\t\t/**\r\n\t\t * Define params to get list of actions\r\n\t\t */\r\n        return $.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function (response) {\r\n            // Convert default response to tree data structure\r\n            response = self.dataService.serializePolymorphicActions(response);\r\n            self.totalActions = bizagi.clone(response);\r\n            var actions = bizagi.clone(response);\r\n            self.lessActions = bizagi.clone(actions);\r\n\r\n            // NOTE: Code extracted\r\n            var templateArguments = {\r\n                actions: actions,\r\n                allowSearch: properties.allowSearch,\r\n                treeActionsList: self.getTreeItems(actions)\r\n            };\r\n            template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n            var control = self.getControl();\r\n            var actionsContainer = $(\".bz-polymorphic-launcher__constructors\", control);\r\n            actionsContainer.append($.fasttmpl(template, templateArguments));\r\n            self.bindHandlers();\r\n        });\r\n    },\r\n\r\n\t/**\r\n\t * Get rendered html of each node of constructors\r\n\t * @param actions\r\n\t * @param level\r\n\t * @return {string}\r\n\t */\r\n    getTreeItems: function (actions, level) {\r\n        var self = this;\r\n        var item = \"<ul>\";\r\n        var templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n        actions = actions || {};\r\n        level = level || 1;\r\n\r\n        $.each(actions, function (key, value) {\r\n            item += $.fasttmpl(templateTreeItem, value);\r\n\r\n            if (value.children) {\r\n                item += self.getTreeItems(value.children, level + 1);\r\n            }\r\n        });\r\n        item += \"</ul>\";\r\n        return item;\r\n    },\r\n\r\n\t/**\r\n\t * Add binding to html elements\r\n\t */\r\n    bindHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionLauncherControls = $(\".bz-polymorphic-launcher__constructors li span\", control);\r\n\r\n        //Binding for click action on buttons\r\n        actionLauncherControls.on(\"click\", function () {\r\n            var $targetData = $(this).parent();\r\n            var action = {\r\n                guidEntity: $targetData.data(\"guidentity\"),\r\n                guidObject: $targetData.data(\"guidobject\"),\r\n                guidConstructor: $targetData.data(\"guidconstructor\"),\r\n                displayName: $targetData.data(\"display-name\"),\r\n                actionType: $targetData.data(\"action-type\"),\r\n                xpathContext: $targetData.data(\"xpathcontext\")\r\n            };\r\n            self.onActionClicked(action);\r\n        });\r\n        //Catch the typed text in the search field and filter the action list\r\n        $.expr[\":\"].FilterAction = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) {\r\n                return false;\r\n            }\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n        $(\"input[data-action=search]\", control).keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".bz-polymorphic-launcher__constructors li\", control).show();\r\n            if (search) {\r\n                $(\".bz-polymorphic-launcher__constructors li\", control).not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n\r\n    },\r\n\t/**\r\n\t * Execute an Action\r\n\t * @param action\r\n\t */\r\n    onActionClicked: function (action) {\r\n        var self = this;\r\n\r\n        $.when(self.actionManager(action)).done(function (act) {\r\n            self.executeAction(act);\r\n        });\r\n    },\r\n\t/**\r\n\t * Show a message when action has been executed\r\n\t * @param status\r\n\t * @param action\r\n\t */\r\n    notifyExecution: function (status, action) {\r\n        var self = this;\r\n        if (status == \"success\") {\r\n            $.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n\r\n        } else {\r\n            $.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        }\r\n    },\r\n\t/**\r\n\t * Show a dialog with a form\r\n\t * @param action\r\n\t * @return {*}\r\n\t */\r\n    processActionForm: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = action.xpathContext || \"\";\r\n        var formParams = form.getParams();\r\n\r\n        var recordXpath = self.properties.recordXpath;\r\n\r\n        // Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                var pageCache = data.idPageCache;\r\n                data.idPageCache = null;\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext, //self.properties.xpathContext,\r\n                    idPageCache: pageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    if (!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            \"idForm\": action.guidObject,\r\n            \"contextType\": \"entity\",\r\n            \"guidEntity\": action.guidEntity,\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            //\"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"recordXpath\": recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\t/**\r\n\t * Process a start form\r\n\t * @param args\r\n\t * @return {*}\r\n\t */\r\n    processStartForm: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var def = new $.Deferred();\r\n        var formParams = form.getParams();\r\n        args = args || {};\r\n\r\n\r\n        var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\r\n            //showSaveButton: properties.editable,\r\n            maximized: properties.maximized,\r\n            title: args.title || \"\",\r\n            navigation: formParams.navigation,\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function (data) {\r\n                form.startLoading();\r\n\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    form.endLoading();\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\t/**\r\n\t * Execute and action if a form is global form or summary, or send to queue\r\n\t * @param action\r\n\t */\r\n    executeAction: function (action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function () {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function (action) {\r\n        var self = this;\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\r\n        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n            .done(function () {\r\n                self.setValue([]);\r\n\r\n                $.when(self.actionManager(action))\r\n                    .done(function (act) {\r\n                        self.executeAction(act);\r\n                    });\r\n            });\r\n    },\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n        self.configureQueueVisibility();\r\n\r\n        $.when($.fasttmpl(template, { actions: data })).done(function (html) {\r\n            actionsToExecuteContainer.empty();\r\n            actionsToExecuteContainer.append(html);\r\n            var removeActionSelector = $(\".bz-pill .bz-btn-icn\", actionsToExecuteContainer);\r\n            var openActionSelector = $(\".bz-pill__label\", actionsToExecuteContainer);\r\n            removeActionSelector.on(\"click\", function () {\r\n                var index = $(this).parent().data(\"index\");\r\n                self.removeActionToQueue(index);\r\n            });\r\n            openActionSelector.bind(\"click\", function () {\r\n                var $target = $(this).parent();\r\n                var type = $target.data(\"actiontype\");\r\n                var guidprocess = $target.data(\"guidprocess\");\r\n                var idStartScope = $target.data(\"idstartscope\");\r\n                var title = $target.data(\"title\");\r\n                var xpathContext = $target.data(\"xpathcontext\");\r\n                var idEntity = $target.data(\"identity\") || \"\";\r\n                var guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n                switch (type) {\r\n                    case \"Process\":\r\n                        if (idStartScope) {\r\n                            self.processStartForm({\r\n                                guidprocess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                title: title,\r\n                                xpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n                            });\r\n                        }\r\n                        break;\r\n                    case \"Form\":\r\n                        var action = {\r\n                            guidProcess: guidprocess,\r\n                            idStartScope: idStartScope,\r\n                            editMode: true,\r\n                            xpathContext: xpathContext,\r\n                            idEntity: idEntity,\r\n                            guidEntity: guidEntity,\r\n                            guidObject: guidprocess\r\n                        };\r\n\r\n                        self.processActionForm(action);\r\n                        break;\r\n                    case \"Rule\":\r\n                        // Rules dont have forms or something like that\r\n                        break;\r\n                }\r\n            });\r\n        });\r\n    },\r\n\t/**\r\n\t * Show container if it has actions\r\n\t */\r\n    configureQueueVisibility: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".bz-polymorphic-launcher__title\", control);\r\n        if (self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Smartphone Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.yesno\", bizagi.rendering.yesno.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.yesno.extend(\"bizagi.rendering.smartphone.yesno\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.radio = $control.find(\"input[type=radio]\");\r\n\r\n        if (this.properties.editable && (this.value == null || this.value === undefined) && this.properties.value != null) {\r\n            this.value = this.properties.value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n\r\n        return $.fasttmpl(template, {value: this.getDisplayValue()});\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.radio = $control.find(\"input\");\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var $control = this.getControl();\r\n        var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n        this.setValue(parsedValue, false);\r\n\r\n        if (this.properties.editable) {\r\n            if (parsedValue) {\r\n                $control.find(\"input[value=true]\").prop('checked', true);\r\n                $control.find(\"input[value=false]\").prop('checked', false);\r\n            } else {\r\n                $control.find(\"input[value=false]\").prop('checked', true);\r\n                $control.find(\"input[value=true]\").prop('checked', false);\r\n            }\r\n        } else {\r\n            this.radio.val((this.getDisplayValue()));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self.radio.change(function () {\r\n            var $selected = $(this);\r\n            var value = $selected.prop('value');\r\n\r\n            if (self.value !== value) {\r\n                self.setValue(value);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Context to apply styles\r\n     * @param context\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(\"label.bz-radio__label\", context);\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var value = {id: \"\", label: \"\"};\r\n        this.setValue(value, false);\r\n\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        if (this.properties.editable) {\r\n            this.radio.prop('checked', false);\r\n        } else {\r\n            this.radio.val(this.getDisplayValue());\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Check\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.check\", bizagi.rendering.check.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.check.extend(\"bizagi.rendering.smartphone.check\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.check = $control.find(\"input\");\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n\r\n        return $.fasttmpl(template, {value: this.getDisplayValue()});\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.check = $control.find(\"input\");\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Render as simple value\r\n        var displayValue = bizagi.util.parseBoolean(value);\r\n\r\n        // Set internal value\r\n        this.setValue(displayValue, false);\r\n\r\n        if (this.properties.editable) {\r\n            if (displayValue) {\r\n                this.check.attr(\"checked\", \"checked\");\r\n            } else {\r\n                this.check.removeAttr(\"checked\");\r\n            }\r\n        } else {\r\n            this.check.val((this.getDisplayValue()));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        this.check.on(\"click\", function (evt) {\r\n            var isCheck = $(this).is(':checked');\r\n\r\n            self.setValue(isCheck, true);\r\n\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        this.setDisplayValue(false);\r\n        this.setValue(false, false);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.checkList\", bizagi.rendering.checkList.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.checkList.extend(\"bizagi.rendering.smartphone.checkList\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();        \r\n        this.properties.unique = Math.ceil(Math.random() * 1000);        \r\n        this.properties.required = true;\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        $(\"input[type=checkbox]\", self.getControl()).bind(\"change\", function () {\r\n            var itemId = $(this).data(\"item-guid\");\r\n            self.onCheckListGroupChange(itemId, this.checked);\r\n        });\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        $(\"input[type=checkbox]\", this.getControl()).removeAttr(\"checked\");\r\n    },\r\n\r\n    setDisplayValue : function (value){\r\n        var self = this;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi smartphone Render list Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to smartphone devices\r\n */\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.list\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.list.extend(\"bizagi.rendering.smartphone.list\", bizagi.rendering.list.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.list.extend(\"bizagi.rendering.smartphone.list\", {}, {\r\n    \r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"list\");\r\n\r\n        return $.fasttmpl(template, {\r\n            editable: this.properties.editable,\r\n            value: this.getDisplayValue()\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Add event handlers to the combo control\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() !== \"execution\") {\r\n            return;\r\n        }\r\n\r\n        $(\".bz-form-list\", control).bind(\"click\", function () {\r\n            //self.processComboData(self.properties.data);\r\n\r\n            $(this).mobileView({\r\n                customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {}),\r\n                displayName: self.properties.displayName || \"\",\r\n                orientation: self.properties.orientation || \"\",\r\n                contentTemplate: \"\",\r\n\r\n                close: function () {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                },\r\n\r\n                open: function () {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n\r\n                configureActions: function (context) {\r\n                    var params = {};\r\n                    if (self.isDependant && self.properties && /^cascadingcombo$/i.test(self.properties.type) && self.getParentCombo) {\r\n                        var parentValue = self.getParentCombo().getValue();\r\n                        if (parentValue && parentValue.id) {\r\n                            params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue.id;\r\n                        }\r\n                    }\r\n\r\n                    $.when(self.renderCombo(params)).done(function (list) {\r\n                        $(\".bz-modal-view__content\", context.content).html(list);\r\n                        self.configureModalViewHandlers(context);\r\n                    })\r\n                }\r\n            });\r\n        });\r\n\r\n    },\r\n\r\n    processComboData: function (data) {\r\n        var self = this;\r\n        data.forEach(function (value) {\r\n            self.validateValue(value);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Setting the display value, always you call a setDisplayValue yor are performinng a setValue under the hood.\r\n     * */\r\n    setDisplayValue: function (value) {\r\n        var comboValue;\r\n        value = this.mapValue(value);\r\n\r\n        if (value && (typeof value === \"object\" && typeof value.label !== \"undefined\")) {\r\n\r\n            if (value.label !== \"\" && !bizagi.util.isNumeric(value.label)) {\r\n                comboValue = value.label;\r\n            } else {\r\n                var selected = this.findDataValueById(value.value);\r\n                comboValue = selected ? selected.value : \"\";\r\n            }\r\n\r\n            if ($.isArray(comboValue)) {\r\n                comboValue = comboValue.join(\" - \");\r\n            }\r\n            value = ({ \"id\": value.id, \"value\": comboValue });\r\n        }\r\n\r\n        var control = this.getControl();\r\n        $(\"input\", control).val(this.formatItem(value.value));\r\n\r\n        //Set Value\r\n        this.selectedValue = value;\r\n        this.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Set the handlers for the modal elements\r\n     * @param {kendoModalObject} context full modal object\r\n     */\r\n    configureModalViewHandlers: function (context) {\r\n        var self = this;\r\n\r\n        $(\".bz-list__item\", context.content).on(\"click\", function () {\r\n            var valueObjet = {\r\n                \"id\": $(this).data(\"value\"),\r\n                \"value\": $(this).text()\r\n            };\r\n\r\n            if (valueObjet.id == \"\") {\r\n                valueObjet.value = \"\";\r\n            }\r\n\r\n            self.setDisplayValue(valueObjet);\r\n            self.trigger(\"select\", [valueObjet, false]);\r\n            context.close();\r\n        });\r\n\r\n        var $elementsList = $(\".bz-list li\", context.content);\r\n        var $clearButton = $(\".bz-modal-view__clear\", context.header);\r\n        var $searchInput = $(\".bz-modal-view__search\", context.header);\r\n\r\n        $(\"[data-action=close]\", context.header).bind(\"click\", function () {\r\n            context.close();\r\n        });\r\n\r\n        $clearButton.bind(\"click\", function () {\r\n            $searchInput.val(\"\").trigger(\"change\");\r\n        });\r\n        // Filtering list\r\n        $searchInput.bind(\"change keyup\", function () {\r\n            if (this.value == \"\") {\r\n                $clearButton.removeClass(\"bz-modal-view__clear--visible\");\r\n            } else {\r\n                $clearButton.addClass(\"bz-modal-view__clear--visible\");\r\n            }\r\n            self.filterList(this.value, $elementsList);\r\n        }).focus();\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * @returns {}\r\n     */\r\n    filterList: function (search, $li) {\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    /**\r\n     * Print the list of elements to show in the modal\r\n     * @param {object} data list of elements to print\r\n     */\r\n    renderComboTemplate: function (data) {\r\n        var template = this.renderFactory.getTemplate(\"list-items\");\r\n        var value = this.getValue();\r\n        value = (value !== null && typeof value !== \"undefined\") ? value : {\"id\": \"\", \"value\": \"\"};\r\n\r\n        return $.fasttmpl(template, {\r\n            \"items\": data,\r\n            \"selectedId\": value.id,\r\n            \"hasItems\": data.length > 0\r\n        }, {\r\n            \"validateItem\": this.validateValue\r\n        });\r\n    },\r\n\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context);\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the multiSelect render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render tablet base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.multiSelect\", bizagi.rendering.multiSelect.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.multiSelect.extend(\"bizagi.rendering.smartphone.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40,\r\n    SEARCH_MIN_LENGTH: 1\r\n}, {\r\n\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"searchList.readonly\");\r\n\r\n        // Render template\r\n        var content = $.fasttmpl(template, {\r\n            items: self.properties.value || {},\r\n            editable: self.properties.editable || true\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n\r\n        return content;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        if (this.isExecutionMode()) {\r\n            this.getData().done(function (data) {\r\n                self.properties.data = data;\r\n            });\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        $(\"[data-action=modal]\", $control).bind(\"click\", function () {\r\n            self.openModalView();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sets the value and display, avoid to include setValue in this method.\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        this._super(value);\r\n\r\n        if (value !== undefined) {\r\n            $(\".bz-input-icon__input\", this.getControl()).html(value.map(function (el) {\r\n                return self.formatItem(el.value);\r\n            }).join(\", \"));\r\n        }\r\n    },\r\n    /**\r\n     * Opens the modal view\r\n     */\r\n    openModalView: function () {\r\n        var self = this;\r\n        self.getData().done(function (result) {\r\n            var template_content = self.renderFactory.getTemplate('multiselect-list');\r\n            var value = self.getValue();\r\n\r\n            if (!$.isArray(value)) {\r\n                value = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n            }\r\n\r\n            var data = {\r\n                values: result,\r\n                isChecked: function (id) {\r\n                    return self.isChecked(value, id);\r\n                }\r\n            };\r\n\r\n            var content = $.fasttmpl(template_content, data, {\r\n                formatItem: self.formatItem\r\n            });\r\n\r\n            var template_footer = self.renderFactory.getTemplate(\"modal-footer-done\");\r\n            var footer = $.fasttmpl(template_footer, {});\r\n\r\n            self.getControl().mobileView({\r\n                customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {}),\r\n                // displayName: self.properties.displayName || \"\",\r\n                orientation: self.properties.orientation || \"\",\r\n                contentTemplate: content,\r\n                footerTemplate: footer,\r\n                transition: \"slideIn:up\",\r\n                close: function () {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                },\r\n                afterOpenAnimation: function (event) {\r\n                    $(\".bz-modal-view__search\", event.view.header).focus();\r\n                },\r\n                open: function () {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                configureActions: function (modalView) {\r\n                    self.configureModalViewHandlers(modalView);\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (modalView) {\r\n        var self = this;\r\n\r\n        var $listContainer = $(\".bz-checkbox-list li\", modalView.content);\r\n        //clear button\r\n        var $clearButton = $(\".bz-modal-view__clear\", modalView.header);\r\n        // Suggest input\r\n        var $suggestInput = $(\".bz-modal-view__search\", modalView.header);\r\n\r\n        $suggestInput.on(\"change keyup\", function () {\r\n            if (this.value == \"\") {\r\n                $clearButton.removeClass(\"bz-modal-view__clear--visible\");\r\n            } else {\r\n                $clearButton.addClass(\"bz-modal-view__clear--visible\");\r\n            }\r\n            self.filterList(this.value, $listContainer);\r\n        }).on(\"focus\", function () {\r\n            modalView.header.addClass(\"bz-modal-view__header--active\");\r\n        }).on(\"blur\", function () {\r\n            modalView.header.removeClass(\"bz-modal-view__header--active\");\r\n        });\r\n\r\n        //Clear the search\r\n        $clearButton.on(\"click\", function () {\r\n            $suggestInput.val(\"\").trigger(\"change\");\r\n        });\r\n\r\n        $(\"[data-action=close]\", modalView.header).on(\"click\", function () {\r\n            modalView.close();\r\n        });\r\n\r\n        $(modalView.footer).on(\"click\", \"[data-action=save]\", function (evt) {\r\n            // Create a temporal array\r\n            var newList = [];\r\n\r\n            $.each.call(this, $listContainer, function (index, item) {\r\n                var check = item.querySelector(\"input\");\r\n\r\n                if (check.checked) {\r\n                    var id = check.getAttribute(\"data-id\");\r\n                    var element = this.findItemById(id);\r\n                    var value = element.value;\r\n                    newList.push({id: id, value: value});\r\n                }\r\n            }.bind(self));\r\n\r\n            self.setDisplayValue(newList);\r\n\r\n            modalView.close();\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the radio render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.radio\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.radio.extend(\"bizagi.rendering.smartphone.radio\", bizagi.rendering.radio.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.radio.extend(\"bizagi.rendering.smartphone.radio\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.radio = $control.find(\"input[type=radio]\");\r\n\r\n        if (this.properties.editable && (this.value == null || this.value === undefined) && (this.properties.value != null)) {\r\n            this.value = this.properties.value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n\r\n        return $.fasttmpl(template, {value: this.getDisplayValue()});\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.radio = $control.find(\"input\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Map data from actions\r\n        value = self.mapValue(value);\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (value !== undefined && value.id != null && value.id !== \"\") {\r\n\r\n            if (this.properties.editable) {\r\n\r\n                var radioItem = $control\r\n                    .find('input[type=\"radio\"][value=\"' + value.id + '\"]');\r\n\r\n                radioItem.prop('checked', 'checked');\r\n            } else {\r\n                self.radio.val((this.getDisplayValue()));\r\n                self.radio.attr(\"id\", value.id);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Add action handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        this.radio.change(function () {\r\n            var $selected = $(this);\r\n\r\n            var newValue = {\r\n                id: $selected.prop('value'),\r\n                value: $.trim($selected.siblings(\"label\").text())\r\n            };\r\n\r\n            self.setValue(newValue);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Context to apply styles\r\n     * @param context\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(\"label.bz-radio__label\", context);\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var value = {id: \"\", label: \"\"};\r\n        this.setValue(value, false);\r\n\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        if (this.properties.editable) {\r\n            this.radio.prop('checked', false);\r\n        } else {\r\n            this.radio.val(this.getDisplayValue());\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n*   Name: BizAgi Smartphone Render Cascading combo Extension\r\n*   Author: Forms team\r\n*   Comments:\r\n*   -   This script will redefine the cascading combo render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.cascadingCombo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.cascadingCombo.extend(\"bizagi.rendering.smartphone.cascadingCombo\", bizagi.rendering.cascadingCombo.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.cascadingCombo.extend(\"bizagi.rendering.smartphone.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n   *   Template method to implement in each children to customize each control\r\n   */\r\n    renderControl: function () {\r\n        var mode = this.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        this.parentCombo = this.getParentCombo();\r\n        if (this.parentCombo != null) {\r\n\r\n            if ((/cascadingcombo/i.test(this.parentCombo.properties.type))) {\r\n                this.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        this.initializingCascadingCombo = true;\r\n\r\n        if (mode != \"execution\") {\r\n            this.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return bizagi.rendering.smartphone.combo.prototype.renderControl.apply(this, arguments);\r\n    },\r\n\r\n    postRender: function () {\r\n        bizagi.rendering.smartphone.combo.prototype.postRender.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n   *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n   */\r\n    configureHandlers: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.smartphone.combo.prototype.configureHandlers.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n     * Override to avoid the trigguer\r\n     */\r\n    cleanData: function () {\r\n        bizagi.rendering.smartphone.combo.prototype.cleanData.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Refresh the combo, after it has been painted\r\n    */\r\n    refresh: function (params, isInitialValue) {\r\n        var self = this;\r\n        // Wait until current element is rendered\r\n        $.when(self.isRendered()).done(function () {\r\n            // Clear current control\r\n            var control = self.getControl();\r\n            var mode = self.getMode();\r\n            control.empty();\r\n\r\n            // Render combo again\r\n            $.when(self.renderControl()).then(function (html) {\r\n                // Append new element\r\n                control.html(html);\r\n                // Post-render method\r\n                self.postRender();\r\n\r\n                if (mode == \"execution\") {\r\n                    self.configureHandlers();\r\n                }\r\n\r\n                // Set current value\r\n                if (isInitialValue) {\r\n                    self.setDisplayValue(self.getValue());\r\n                } else {\r\n                    self.setDisplayValue({\r\n                        \"id\": \"\",\r\n                        \"value\": \"\"\r\n                    });\r\n                }\r\n\r\n                if (self.deferredVisible) {\r\n                    self.deferredVisible.resolve();\r\n                }\r\n\r\n                self.trigger(\"select\", [self.getValue(), isInitialValue]);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        bizagi.rendering.smartphone.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    processComboData: function () {\r\n        bizagi.rendering.smartphone.combo.prototype.processComboData.apply(this, arguments);\r\n    },\r\n\r\n    validateValue: function () {\r\n        return bizagi.rendering.smartphone.combo.prototype.validateValue.apply(this, arguments);\r\n    },\r\n\r\n    renderComboTemplate: function () {\r\n        return bizagi.rendering.smartphone.combo.prototype.renderComboTemplate.apply(this, arguments);\r\n    },\r\n\r\n    configureModalViewHandlers: function () {\r\n        bizagi.rendering.smartphone.combo.prototype.configureModalViewHandlers.apply(this, arguments);\r\n    },\r\n\r\n    configureCombo: function () {\r\n        bizagi.rendering.smartphone.combo.prototype.configureCombo.apply(this, arguments);\r\n    },\r\n\r\n    changeCombo: function (valueItem, valueObjet) {\r\n        bizagi.rendering.smartphone.combo.prototype.changeCombo.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n        return bizagi.rendering.smartphone.combo.prototype.getSelectedValue.call(this, arguments);\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n    /**\r\n     * Filtering list of elements\r\n     * @returns {}\r\n     */\r\n    filterList: function (search, $li) {\r\n        return bizagi.rendering.smartphone.combo.prototype.filterList.call(this, search, $li);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi smartphone Render option select\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   Renders an option html input with attached handlers\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.combo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.combo.extend(\"bizagi.rendering.smartphone.combo\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"combo\");\r\n\r\n        return $.fasttmpl(template, {\r\n            editable: this.properties.editable,\r\n            value: this.getDisplayValue()\r\n        });\r\n\r\n    },\r\n\r\n    postRender: function() {\r\n        this._super();\r\n        this.itemSelected = undefined;\r\n    },\r\n\r\n    /**\r\n     * Add event handlers to the combo control\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() !== \"execution\") {\r\n            return;\r\n        }\r\n\r\n        $(\".bz-form-combo\", control).bind(\"click\", function () {\r\n            //self.processComboData(self.properties.data);\r\n\r\n            $(this).mobileView({\r\n                customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {}),\r\n                displayName: self.properties.displayName || \"\",\r\n                orientation: self.properties.orientation || \"\",\r\n                contentTemplate: \"\",\r\n\r\n                close: function () {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                },\r\n\r\n                open: function () {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n\r\n                configureActions: function (context) {\r\n                    var params = {};\r\n\r\n                    if (self.isDependant && self.properties && (/cascadingcombo/i.test(self.properties.type)) && self.getParentCombo) {\r\n                        var parentValue = self.getParentCombo().getValue();\r\n                        if (parentValue && parentValue.id) {\r\n                            params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue.id;\r\n                        }\r\n                    }\r\n\r\n                    $.when(self.renderCombo(params)).done(function (list) {\r\n                        $(\".bz-modal-view__content\", context.content).html(list);\r\n                        self.configureModalViewHandlers(context);\r\n                    })\r\n                }\r\n            });\r\n        });\r\n\r\n    },\r\n\r\n    processComboData: function (data) {\r\n        var self = this;\r\n        data.forEach(function (value) {\r\n            self.validateValue(value);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Setting the display value, always you call a setDisplayValue yor are performinng a setValue under the hood.\r\n     * */\r\n    setDisplayValue: function (value) {\r\n        var comboValue;\r\n        value = this.mapValue(value);\r\n\r\n        if (value && (typeof value === \"object\" && typeof value.label !== \"undefined\")) {\r\n\r\n            if (value.label !== \"\" && !bizagi.util.isNumeric(value.label)) {\r\n                comboValue = value.label;\r\n            } else {\r\n                var selected = this.findDataValueById(value.value);\r\n                comboValue = selected ? selected.value : \"\";\r\n            }\r\n\r\n            if ($.isArray(comboValue)) {\r\n                comboValue = comboValue.join(\" - \");\r\n            }\r\n\r\n            value = ({ \"id\": value.id, \"value\": comboValue });\r\n        }\r\n\r\n        var control = this.getControl();\r\n        $(\"input\", control).val(this.formatItem(value.value));\r\n\r\n        //Set Value\r\n        this.selectedValue = value;\r\n        this.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Set the handlers for the modal elements\r\n     * @param {kendoModalObject} context full modal object\r\n     */\r\n    configureModalViewHandlers: function (context) {\r\n        var self = this;\r\n\r\n        $(\".bz-list__item\", context.content).on(\"click\", function () {\r\n            var valueObjet = {\r\n                \"id\": $(this).data(\"value\"),\r\n                \"value\": $(this).text()\r\n            };\r\n\r\n            if (valueObjet.id == \"\") {\r\n                valueObjet.value = \"\";\r\n            }\r\n\r\n            self.itemSelected = true; //must be before the setDisplayValue\r\n            self.setDisplayValue(valueObjet);\r\n            self.trigger(\"select\", [valueObjet, false]);\r\n            context.close();\r\n        });\r\n\r\n        var $elementsList = $(\".bz-list li\", context.content);\r\n        var $clearButton = $(\".bz-modal-view__clear\", context.header);\r\n        var $searchInput = $(\".bz-modal-view__search\", context.header);\r\n\r\n        $(\"[data-action=close]\", context.header).bind(\"click\", function () {\r\n            context.close();\r\n        });\r\n\r\n        $clearButton.bind(\"click\", function () {\r\n            $searchInput.val(\"\").trigger(\"change\");\r\n        });\r\n        // Filtering list\r\n        $searchInput.bind(\"change keyup\", function () {\r\n            if (this.value == \"\") {\r\n                $clearButton.removeClass(\"bz-modal-view__clear--visible\");\r\n            } else {\r\n                $clearButton.addClass(\"bz-modal-view__clear--visible\");\r\n            }\r\n            self.filterList(this.value, $elementsList);\r\n        }).focus();\r\n    },\r\n\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * @returns {}\r\n     */\r\n    filterList: function (search, $li) {\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    /**\r\n     * Print the list of elements to show in the modal\r\n     * @param {object} data list of elements to print\r\n     */\r\n    renderComboTemplate: function (data) {\r\n        var template = this.renderFactory.getTemplate(\"combo-list\");\r\n        var value = this.getValue();\r\n        value = (value !== null && typeof value !== \"undefined\") ? value : {\"id\": \"\", \"value\": \"\"};\r\n\r\n        return $.fasttmpl(template, {\r\n            \"items\": data,\r\n            \"selectedId\": value.id,\r\n            \"hasItems\": data.length > 0\r\n        }, {\r\n            \"validateItem\": this.validateValue\r\n        });\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context);\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Collection Navigator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the collection Navigator class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.collectionnavigator\", bizagi.rendering.collectionnavigator.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.collectionnavigator.extend(\"bizagi.rendering.smartphone.collectionnavigator\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\r\n    }\r\n\r\n\r\n});","/**\r\n *   Name: Bizagi Smartphones Render Hidden Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the hidden render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.hidden\", bizagi.rendering.hidden.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.hidden.extend(\"bizagi.rendering.smartphone.hidden\", {}, {});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Upload Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.upload\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.upload.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.upload.extend(\"bizagi.rendering.smartphone.upload\", {\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"]\r\n}, {\r\n    /**\r\n     * Whether or not is a native device\r\n     * @var isNative boolean\r\n     */\r\n    isNative: false,\r\n\r\n    /**\r\n     * Whether or not we are offline\r\n     * @var isOfflineForm boolean\r\n     */\r\n    isOfflineForm: false,\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: this});\r\n        this.isNative = bizagi.util.isCordovaSupported();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"upload\");\r\n\r\n        return this.renderItem(template, {});\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"upload-readonly\");\r\n        var data = {\r\n            noFiles: this.filesCount === 0\r\n        };\r\n\r\n        return this.renderItem(template, data);\r\n    },\r\n\r\n    /**\r\n     * Method to render items\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderItem: function (template, data) {\r\n        var self = this;\r\n        var items = \"\";\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, data);\r\n\r\n        // Render current children\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n\r\n        this.$contentFile = $(\".bz-file-upload__container\", $control);\r\n        this.$inputFile = $(\".bz-file-upload__input\", $control);\r\n        this.$nativeFile = $(\".bz-file-upload__native\", $control);        \r\n    },\r\n\r\n    /**\r\n     * Add action handlers\r\n     */\r\n    configureHandlers: function () {\r\n        this.checkFileExtensions();\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Handler to download a file\r\n        $(\"ul.bz-readonly-lists\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            var file = item.data();\r\n\r\n            bizagi.loading.start();\r\n\r\n            $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to configure the actions with control\r\n     * @return {}\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Attach all events\r\n        this.$contentFile.off(\"click\").on(\"click\", function (evt) {\r\n            self.chooseFile();\r\n        });\r\n\r\n        // Handler to download the file\r\n        $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            var file = item.data();\r\n\r\n            bizagi.loading.start();\r\n\r\n            $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n\r\n        // Attach delete option & Removes a file from the upload control\r\n        $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-icn\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            var file = item.data();\r\n\r\n            self.removeFile(item, file.id);\r\n        });\r\n\r\n        if (self.isNative) {\r\n            // Upload files\r\n            this.$nativeFile.off(\"click\").actionSheet({\r\n                actions: self.getUploadChoices(),\r\n                actionClicked: function (action) {\r\n                    self.handlerUploadFile(action.guid);\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n\r\n            // Resolution upload\r\n            $(\".bz-file-upload__resolution\", $control).off(\"click\").actionSheet({\r\n                actions: bizagi.util.media.getImageResolutionSizes(),\r\n                withoutCancel: true,\r\n                actionClicked: function (action) {\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(self.handlerResolutionUpload(action.guid)).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n        } else {\r\n\r\n            // Attach event to web upload-control\r\n            this.$inputFile.off(\"change\").on(\"change\", function () {\r\n                self.addFile();\r\n                this.value = \"\";\r\n            });\r\n\r\n            // Just in case\r\n            this.$inputFile.off(\"click\").on(\"click\", function (evt) {\r\n                evt.stopPropagation();\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler of upload files\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerUploadFile: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        switch (actionSelected) {\r\n            case 2:\r\n\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    self.dataImage = dataImage;\r\n                    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\r\n\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            //Gets the real properties for the file\r\n                            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage))\r\n                                .then(function (fileData) {\r\n                                    self.fileProperties = fileData;\r\n\r\n                                    if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\r\n                                        // \"new Blob\" constructor is not supported in android version 4.2.2\r\n                                        var version = bizagi.util.getAndroidVersion();\r\n\r\n                                        if ((version && version <= 4.2) || self.isOfflineForm) {\r\n                                            return self.saveImage(self.dataImage);\r\n                                        } else {\r\n\r\n                                            if (!bizagi.util.isAndroid()) {\r\n                                                return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\r\n                                                    if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                        return self.handlerResolutionUpload(buttonIndex);\r\n                                                    }\r\n                                                });\r\n\r\n                                            } else {\r\n                                                // Force click to show actionSheet menu\r\n                                                $(\".bz-file-upload__resolution\", self.getControl()).click();\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                });\r\n                        }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n\r\n                }, self.onFail.bind(self), {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    correctOrientation: true,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY\r\n                });\r\n                break;\r\n            case 1:\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                        bizagi.loading.start();\r\n\r\n                        $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\r\n                                return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                                    self.fileProperties = fileData;\r\n                                    return self.saveImage(dataImage);\r\n                                });\r\n                            }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                    },\r\n                    self.onFail.bind(self), {\r\n                        quality: self.Class.QUALITY_PICTURE,\r\n                        sourceType: navigator.camera.PictureSourceType.CAMERA,\r\n                        mediaType: navigator.camera.MediaType.PICTURE,\r\n                        destinationType: Camera.DestinationType.FILE_URI,\r\n                        correctOrientation: true,\r\n                        targetWidth: 1280,\r\n                        targetHeight: 960\r\n                    });\r\n                break;\r\n            case 3:\r\n                navigator.device.capture.captureVideo(function (dataVideo) {\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSizeVideo(dataVideo, self.properties))\r\n                        .then(function () {\r\n                            return self.saveVideo(dataVideo);\r\n                        }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n\r\n                }, self.onFail.bind(self), {limit: self.Class.LIMIT});\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler of resolution upload\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerResolutionUpload: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return self.saveImage(self.dataImage);\r\n        } else {\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).then(function (result) {\r\n                self.editedImageURL = result.localUrl;\r\n                self.properties.url = result.base64Image;\r\n\r\n                return self.saveImage(self.dataImage);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Send image using HTTP\r\n     * @param {} dataImage\r\n     */\r\n    saveImage: function (dataImage) {\r\n        var self = this;\r\n        var dataItem = \"\";\r\n\r\n        if (self.editedImageURL) {\r\n            dataItem = self.editedImageURL;\r\n        } else if (self.fileProperties) {\r\n            dataItem = self.fileProperties.url;\r\n        }\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        var dataFile = bizagi.util.media.getImagePath(dataItem);\r\n        var data = {\r\n            dataFile: dataFile,\r\n            fileName: self.fileProperties.name,\r\n            mimeType: \"image/jpeg\"\r\n        };\r\n\r\n        // Cleans variables related previous uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        return this.uploadFile(data);\r\n    },\r\n\r\n    /**\r\n     * Method to save a video file\r\n     * @param {} dataVideo\r\n     * @returns {}\r\n     */\r\n    saveVideo: function (dataVideo) {\r\n        var data = {\r\n            dataFile: dataVideo[0].fullPath,\r\n            fileName: dataVideo[0].name,\r\n            mimeType: \"video/quicktime\"\r\n        };\r\n\r\n        return this.uploadFile(data);\r\n    },\r\n\r\n    /**\r\n     * Method to save a file\r\n     * @param data\r\n     * @returns {*|void}\r\n     */\r\n    uploadFile: function (data) {\r\n        var self = this;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = data.fileName;\r\n        params.options.uploadKey = {key: addParams[\"h_xpath\"]};\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = data.dataFile;\r\n\r\n        if (data.mimeType)\r\n            params.options.mimeType = data.mimeType;\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).then(function (result) {\r\n            var response = JSON.parse(decodeURIComponent(result.response));\r\n\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(response);\r\n            }\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * onFail\r\n     * @param {} error\r\n     */\r\n    onFail: function (error) {\r\n        var messageError = bizagi.util.processFailMessage(error);\r\n\r\n        bizagi.loading.stop();\r\n\r\n        if (messageError && typeof (messageError) === \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\r\n            var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\r\n            var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\r\n\r\n            bizagi.showMessageBox(message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * onUploadFileCompleted\r\n     * @param {} result\r\n     */\r\n    onUploadFileCompleted: function (result) {\r\n        var self = this;\r\n        var $wrapper = $(\".bz-files\", self.getControl());\r\n\r\n        if (result.id && result.fileName) {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem(result);\r\n            $wrapper.append(newItem);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Update value\r\n            self.setValue(files, true);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            self.editedImageURL = null;\r\n        } else {\r\n            bizagi.showMessageBox(result.message, \"Error\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check maximum number of files\r\n     */\r\n    checkMaxFiles: function () {\r\n        if (this.isMaxFilesReached()) {\r\n            $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\r\n        } else {\r\n            $(this.$contentFile).removeClass(\"bz-file-upload__container--hidden\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if the maximum number of files than can be uploaded has been reached\r\n     * @returns {}\r\n     */\r\n    isMaxFilesReached: function () {\r\n        var maxFiles = this.properties.maxfiles;\r\n        var actualFiles = this.properties.value ? this.properties.value.length : 0;\r\n\r\n        return maxFiles !== 0 && (this.filesCount >= maxFiles && actualFiles >= maxFiles);\r\n    },\r\n\r\n    /**\r\n     * Check allow extensions and define possible choices\r\n     * @returns {}\r\n     */\r\n    checkFileExtensions: function () {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        self.validOptions = {video: false, image: false, file: false};\r\n\r\n        // Preprocess the extensions string\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions === \"\") {\r\n            self.validOptions = {video: true, image: true, file: true};\r\n        } else {\r\n            validExtensions = validExtensions.split(\";\");\r\n\r\n            if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n                self.validOptions.video = true;\r\n                self.validOptions.image = true;\r\n            } else {\r\n                for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n                    validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n                    if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.file = true;\r\n                    } else if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.image = true;\r\n                    } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.video = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Media is not supported then upload control is disabled\r\n        if (!self.validOptions.file && !self.validOptions.image && !self.validOptions.video) {\r\n            $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\r\n        }\r\n\r\n        // Limit of files is reached then upload control is disabled\r\n        if (self.isMaxFilesReached() || (!self.isNative && (!bizagi.util.media.fileAPISupported() || self.isOfflineForm))) {\r\n            $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @param {} dataFile\r\n     */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(prefix + \"xpath\", self.getUploadXpath());\r\n        formData.append(prefix + \"idRender\", self.properties.id);\r\n        formData.append(prefix + \"xpathContext\", self.properties.xpathContext);\r\n        formData.append(prefix + self.Class.BA_PAGE_CACHE, self.properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(self.properties.xpath, dataFile);\r\n\r\n        if (self.properties.contexttype)\r\n            formData.append(prefix + \"contexttype\", self.properties.contexttype);\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    processUploadFile: function (dataFile) {\r\n        var data = {\r\n            url: this.properties.addUrl,\r\n            formData: this.buildAddFileParams(dataFile)\r\n        };\r\n\r\n        return this.dataService.processUploadFile(data);\r\n    },\r\n\r\n    /**\r\n     * Remove data of file upload\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var items = $(\".bz-files\", self.getControl());\r\n\r\n        $(\".bz-file\", items).each(function (index, item) {\r\n            item = $(item);\r\n            var file = item.data();\r\n\r\n            self.removeFile(item, file.id);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Add upload options\r\n     */\r\n    getUploadChoices: function () {\r\n        var self = this;\r\n        var itemsUpload = [];\r\n\r\n        // Take photo, Choose photo\r\n        if (self.validOptions.image) {\r\n            itemsUpload.push({\r\n                \"guid\": 1,\r\n                \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\")\r\n            });\r\n            itemsUpload.push({\r\n                \"guid\": 2,\r\n                \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\")\r\n            });\r\n        }\r\n\r\n        // Take video\r\n        if (self.validOptions.video) {\r\n            itemsUpload.push({\r\n                \"guid\": 3,\r\n                \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\")\r\n            });\r\n        }\r\n\r\n        // Stores the upload options        \r\n        return [].concat(itemsUpload);\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var errorResponse = \"\";\r\n\r\n        if (error && error.responseText) {\r\n            errorResponse = error.responseText;\r\n        } else {\r\n            errorResponse = bizagi.localization.getResource(\"workportal-general-error\");\r\n        }\r\n\r\n        this.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * Method to add new file from native or hybrid environment\r\n     */\r\n    chooseFile: function () {\r\n        if (this.isNative) {\r\n            this.$nativeFile.click();\r\n        } else if (bizagi.util.media.fileAPISupported() && !this.isOfflineForm) {\r\n            this.$inputFile.click();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to add new file\r\n     */\r\n    addFile: function () {\r\n        var self = this;\r\n        var dataFile = this.$inputFile[0].files[0];\r\n        var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSVIDEO);\r\n\r\n        dataFile.fullPath = this.$inputFile[0].value;\r\n        bizagi.loading.start();\r\n\r\n        if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n            $.when(self.processUploadFile(dataFile))\r\n                .then(function (result) {\r\n                    self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result)));\r\n                }).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        } else {\r\n            bizagi.loading.stop();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to remove item\r\n     * @param item\r\n     * @param id\r\n     */\r\n    removeFile: function (item, id) {\r\n        var self = this;\r\n\r\n        $.when(self.deleteUploadItem(item, id)).done(function () {\r\n            // Remove item\r\n            item.hide();\r\n            item.remove();\r\n\r\n            // Update value\r\n            self.setValue(self.files, false);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template for upload items\r\n     */\r\n    getTemplateItemName: function () {\r\n        return \"upload-item\";\r\n    },\r\n\r\n    getElementsToStylize: function(context){\r\n        return $(\".bz-input-icon__input\", context);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Smartphone Render upload Extension\r\n *   Author: Mobile SWAT Team\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.upload.extend(\"bizagi.rendering.smartphone.upload.offline\", {\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"]\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        var self = this;\r\n        this._super(data);\r\n\r\n        var maxFileSizeOfProperty = Number(this.properties.maxSize) || 1048576;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\r\n\r\n        this.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\r\n\r\n        this.updateFilesCount();\r\n    },\r\n    /**\r\n     * Method to render items\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderItem: function (template, data) {\r\n        var self = this;\r\n        var items = \"\";\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, data);\r\n\r\n        // Render current children\r\n        for (var i = 0; i < self.files.length; i++) {\r\n            var file = self.files[i];\r\n            if(file.status && file.status !== \"deleted\" && file.status !== \"new-deleted\"){\r\n                var item = self.renderUploadItem(file, i);\r\n                items += item;\r\n            }\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Handler to download the file\r\n        $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            self.openOfflineFile(item);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to configure the actions with control\r\n     * @return {}\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Attach all events\r\n        this.$contentFile.off(\"click\").on(\"click\", function (evt) {\r\n            if(self.isNative)\r\n                self.$nativeFile.click();\r\n            else\r\n                self.$inputFile.click();\r\n                self.$inputFile.off(\"change\").on(\"change\", function(){\r\n                    self.handlerWebUploadFile();\r\n                });\r\n        });\r\n\r\n        // Handler to download the file\r\n        $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            self.openOfflineFile(item);\r\n        });\r\n\r\n        // Attach delete option & Removes a file from the upload control\r\n        $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-icn\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            self.removeOfflineFile(item);\r\n        });\r\n\r\n        if (self.isNative) {\r\n            // Upload files\r\n            this.$nativeFile.off(\"click\").actionSheet({\r\n                actions: self.getUploadChoices(),\r\n                actionClicked: function (action) {\r\n                    // this.getBoundingClientRect()\r\n                    self.handlerUploadFile(action.guid);\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    //Only should be used for testing purposes\r\n    handlerWebUploadFile: function(){\r\n        var self = this;\r\n        var dataFile = self.$inputFile[0].files[0];\r\n        \r\n        var fileId = bizagi.util.randomNumber();\r\n        var fileName, mimeType;\r\n        \r\n        $.when(self.getBlobFromPath(dataFile))\r\n        .then( function(blob){            \r\n            bizagi.loading.start();\r\n            mimeType = blob.type;\r\n            fileName = blob.name;\r\n            return self.saveOfflineFile(blob, fileId, mimeType);\r\n        }).then( function(saveResponse){\r\n            self.onUploadOfflineFileCompleted(fileName, mimeType, fileId);\r\n        }).always( function(){\r\n            bizagi.loading.stop();\r\n        })\r\n        self.$inputFile[0].value = \"\";\r\n    },\r\n\r\n    /**\r\n     * Handler of upload image\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerUploadFile: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n        switch (actionSelected) {\r\n            case 2:\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    self.dataImage = dataImage;\r\n                    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\r\n\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            //Gets the real properties for the file\r\n                            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage))\r\n                                .then(function (fileData) {\r\n                                    self.fileProperties = fileData;\r\n                                    if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\r\n                                        return self.saveImage(self.dataImage);\r\n                                    }\r\n                                });\r\n                        }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n\r\n                }, self.onFail.bind(self), {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    correctOrientation: true\r\n                });\r\n                break;\r\n            case 1:\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                        bizagi.loading.start();\r\n\r\n                        $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\r\n                            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                                self.fileProperties = fileData;\r\n                                return self.saveImage(dataImage);\r\n                            });\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                    },\r\n                    self.onFail.bind(self), {\r\n                        quality: self.Class.QUALITY_PICTURE,\r\n                        sourceType: navigator.camera.PictureSourceType.CAMERA,\r\n                        mediaType: navigator.camera.MediaType.PICTURE,\r\n                        destinationType: Camera.DestinationType.FILE_URI,\r\n                        correctOrientation: true,\r\n                        targetWidth: 1280,\r\n                        targetHeight: 960\r\n                    });\r\n                break;\r\n            default:\r\n                console.log(\"The option is not supported!\")\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Add the interactions to the upload control items\r\n     * @return {}\r\n     */\r\n    addInteractions: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Attach delete option & Removes a file from the upload control\r\n        $(\"ul.bz-files\", control).on(\"click\", \".bz-file .bz-file__delete\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            self.removeOfflineFile(item);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Collect Data\r\n     * @param {} renderValues\r\n     * @returns {}\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        if (self.filesCount > 0) {\r\n            renderValues[self.properties.xpath] = self.files;\r\n        } else if (self.properties.method === \"delete\") {\r\n            renderValues[self.properties.xpath] = [];\r\n\r\n            delete self.properties.method;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Send image using HTTP\r\n     * @param {} dataImage\r\n     */\r\n    saveImage: function (dataImage) {\r\n        var self = this;\r\n        bizagi.loading.start();\r\n\r\n        var fileId = bizagi.util.randomNumber();\r\n        var fileName = self.fileProperties.name\r\n        var mimeType;\r\n\r\n        //TODO: SWAT Check if the file already exists\r\n        $.when(self.getBlobFromPath(dataImage))\r\n        .always( function(){\r\n            bizagi.loading.stop();\r\n        })\r\n        .then( function(blob){\r\n            mimeType = blob.type;\r\n            fileName = blob.name;\r\n            return self.saveOfflineFile(blob, fileId, mimeType);\r\n        }).then( function(saveResponse){            \r\n            self.onUploadOfflineFileCompleted(fileName, mimeType, fileId);            \r\n        });\r\n        self.$inputFile[0].value = \"\";\r\n    },\r\n\r\n    /**\r\n     * Check allow extensions and define possible choices\r\n     * Only support to image in offline capability\r\n     * @returns {}\r\n     */\r\n    checkFileExtensions: function () {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        self.validOptions = {video: false, image: false, file: false};\r\n\r\n        // Preprocess the extensions string\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions === \"\") {\r\n            self.validOptions.image = true;\r\n        } else {\r\n            validExtensions = validExtensions.split(\";\");\r\n\r\n            if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n                self.validOptions.image = true;\r\n            } else {\r\n                for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n                    validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n                    if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.image = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Media is not supported then upload control is disabled\r\n        if (!self.validOptions.image) {\r\n            $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\r\n        }\r\n\r\n        // Limit of files is reached then upload control is disabled\r\n        if (self.isMaxFilesReached() || !bizagi.util.media.fileAPISupported() ) {\r\n            $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * onUploadOfflineFileCompleted\r\n     * @param {} result\r\n     */\r\n    onUploadOfflineFileCompleted: function (fileName, mimeType, fileId) {\r\n        var self = this;\r\n        var $wrapper = $(\".bz-files\", self.getControl());\r\n\r\n        var fileUploaded = {\r\n            id: fileId,\r\n            fileName: fileName,\r\n            mimeType: mimeType,\r\n            status: \"new\"\r\n        };\r\n\r\n        // Locate it before the upload wrapper\r\n        var newItem = self.renderUploadItem(fileUploaded, self.files.length);\r\n        $wrapper.append(newItem);\r\n\r\n        // Increment counter\r\n        self.filesCount = self.filesCount + 1;\r\n\r\n        // Copy the files value but not its reference\r\n        var files = self.files.slice();\r\n\r\n        //Add the new item to this temporal array\r\n        files.push(fileUploaded);\r\n\r\n        // Update value\r\n        self.setValue(files, false);\r\n\r\n        // Check maxFiles\r\n        self.checkMaxFiles(); \r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderUploadItem: function (file, index) {\r\n        var self = this;\r\n        var itemTemplate = self.getTemplateItemName();\r\n        var template = self.renderFactory.getTemplate(itemTemplate);\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: \"javascript:void(0);\",\r\n            id: file.id,\r\n            allowDelete: self.properties.allowDelete || false,\r\n            filename: file.fileName,\r\n            index: index\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * This render cannot be sent because it is full ajax\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Fail action\r\n     * @param {} evt\r\n     * @returns {}\r\n     */\r\n    failReadFile: function (evt) {\r\n        try {\r\n            bizagi.log(\"Error code: \" + evt.target.error.code);\r\n        } catch (e) {\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Fail action\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    onFail: function (error) {\r\n        this._super(error);\r\n    },\r\n\r\n    /**\r\n     * Method to remove item\r\n     * @param item\r\n     * @param id\r\n     */\r\n    removeOfflineFile: function (item) {\r\n        var self = this;\r\n        var file = item.data();\r\n        var fileIndex = file.index;\r\n\r\n\r\n\r\n        // Mark the file as deleted\r\n        var fileValue = self.files[fileIndex];\r\n        if( !fileValue){\r\n            //Nothing to do\r\n            return;\r\n        }\r\n        if(fileValue.status !== \"new\"){\r\n            fileValue.status = \"deleted\";\r\n        }\r\n        else {\r\n            fileValue.status = \"new-deleted\";\r\n        }\r\n        \r\n\r\n        // Remove item\r\n        item.hide();\r\n        item.remove();\r\n\r\n        // Update value\r\n        self.setValue(self.files, false);\r\n\r\n        // Check maxFiles\r\n        self.checkMaxFiles();\r\n\r\n        // Trigger change\r\n        self.triggerRenderChange();\r\n    },\r\n    /**\r\n     * Update the filesCount attribute based on the status (new|deleted) of each file\r\n     */\r\n    updateFilesCount: function(){\r\n        var self = this;\r\n        var files = this.properties.value;\r\n        for(var i=0; i < files.length; i++){\r\n            var status = files[i].status;\r\n            if( status && status.includes(\"deleted\") ) {\r\n                self.filesCount= self.filesCount - 1;\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        self._super(value, triggerEvents);\r\n        self.updateFilesCount();\r\n        if (self.filesCount === 0) {\r\n            self.properties.method = \"delete\";\r\n        }\r\n    },\r\n    /**\r\n     * Check if the maximum number of files than can be uploaded has been reached\r\n     * @returns {}\r\n     */\r\n    isMaxFilesReached: function () {\r\n        var maxFiles = this.properties.maxfiles;\r\n        return maxFiles !== 0 && (this.filesCount >= maxFiles);\r\n    },\r\n\r\n    openOfflineFile: function(item) {\r\n        var self = this;\r\n        var file = item.data();\r\n        var dataIndex = file.index;\r\n        var selectedValue = typeof (dataIndex) == \"number\" ? self.properties.value[dataIndex] : null;\r\n        if (selectedValue) {\r\n            var formParams = self.getFormParams();\r\n            var getFileParams = {\r\n                idCase: formParams.idCase,\r\n                idWorkitem: formParams.idWorkitem,\r\n                id: self.properties.xpath + '.' + selectedValue.id,\r\n                offlineType: formParams.offlineType\r\n            }\r\n            bizagi.loading.start();\r\n            $.when(self.dataService.getOfflineFile( getFileParams, \"blob\", selectedValue.mimeType))\r\n            .done( function(binaryFile){\r\n                var fileName = file.title;\r\n                bizagi.util.media.handleBinaryFile( binaryFile, fileName);\r\n            })\r\n            .fail( function(error){\r\n                console.log(\"Error opening offline file\", error);\r\n            })\r\n            .always( function() {\r\n                bizagi.loading.stop();\r\n            });\r\n        }\r\n    },\r\n\r\n    getBlobFromPath: function(path){\r\n        var blobPromise = new $.Deferred();\r\n        var self = this;\r\n\r\n        if(self.isNative){\r\n            var fileName = self.fileProperties.name;            \r\n            if (!bizagi.util.isAndroidDevice()) {\r\n                path = bizagi.util.media.normalizeIOSFilePath(path);\r\n            }\r\n            else{\r\n                // Fix android 4.4 getting images from recent folder\r\n                path = bizagi.util.media.getImagePath(path);\r\n            }\r\n            \r\n            var errorHandler = function (error) {\r\n                console.log('Error converting path to blob', error);  \r\n                blobPromise.reject(error);\r\n            };\r\n    \r\n            window.resolveLocalFileSystemURL(path, function (fileEntry) {\r\n                fileEntry.file(function (file) {    \r\n                    var reader = new FileReader();\r\n                    reader.onloadend = function () {\r\n                        var blob = new Blob([this.result], {type: file.type});\r\n                        blob.name = fileName;\r\n                        blobPromise.resolve(blob);\r\n                    }\r\n                    reader.readAsArrayBuffer(file);\r\n                }, errorHandler);\r\n            }, errorHandler);\r\n        }\r\n        else {\r\n            //In browser is the File\r\n            blobPromise.resolve(path);\r\n        }\r\n        return blobPromise;\r\n    },\r\n\r\n    saveOfflineFile: function(blobFile, fileId, mimeType){\r\n        var self = this;\r\n        var formParams = self.getFormParams();\r\n        var parameters = {\r\n            idCase: formParams.idCase,\r\n            idWorkitem: formParams.idWorkitem,\r\n            id: self.properties.xpath + '.' + fileId,\r\n            operationType: \"edition\",\r\n            offlineType: formParams.offlineType\r\n        }        \r\n        return self.dataService.saveOfflineFile(parameters, blobFile, mimeType);\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render ECM Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the ecm render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.ecm\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.ecm.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.ecm.extend(\"bizagi.rendering.smartphone.ecm\", {\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"],\r\n    ERROR_ECM_NO_AVAILABLE: 3,\r\n    ACTION_DETAILS: \"details\",\r\n    ACTION_EDIT: \"edit\"\r\n}, {\r\n\r\n    /**\r\n     * Whether or not is a native device\r\n     * @var isNative boolean\r\n     */\r\n    isNative: false,\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        this.isNative = bizagi.util.isCordovaSupported();\r\n        this.fileData = [];\r\n    },\r\n\r\n    /**\r\n     * Method to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = this.renderFactory.getTemplate(\"ecm\");\r\n\r\n        // Set files property\r\n        self.files = self.properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        return this.renderItem(template, {});\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"ecm-readonly\");\r\n        var data = {\r\n            noFiles: this.filesCount === 0\r\n        };\r\n\r\n        return this.renderItem(template, data);\r\n    },\r\n\r\n    /**\r\n     * Method to render items\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderItem: function (template, data) {\r\n        var self = this;\r\n        var items = \"\";\r\n        var html = $.fasttmpl(template, data);\r\n\r\n        // Render current children\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var item = self.renderUploadItem(self.files[i]);\r\n\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"ecm-item\");\r\n        var form = self.getFormContainer();\r\n\r\n        var data = {\r\n            id: self.properties.id,\r\n            idFileUpload: file[0],\r\n            fileName: file[1],\r\n            editable: self.properties.editable,\r\n            xPath: self.properties.xpath,\r\n            xpathContext: self.getXpathContext() || form.properties.xpathContext || \"\",\r\n            idPageCache: self.properties.idPageCache,\r\n            idAttrib: self.properties.idAttrib,\r\n            sessionId: form.properties.sessionId\r\n        };\r\n\r\n        // Builds the upload item url\r\n        var originalData = $.extend({}, data);\r\n        data.url = self.buildItemUrl(originalData);\r\n\r\n        // Define File Properties\r\n        file.getFileProperties = $.when(self.renderFileLayout(data));\r\n\r\n        var html = $.fasttmpl(template, data);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to get properties and metadata of ECM item\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    renderFileLayout: function (data) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var deferred = new $.Deferred();\r\n\r\n        var originalData = $.extend({}, data);\r\n\r\n        $.when(\r\n            self.dataService.metadataECMMultiaction().getECMMetadata(data),\r\n            self.dataService.metadataECMMultiaction().getFileProperties(originalData)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            if (Array.isArray(fileProperties)) {\r\n                fileProperties = fileProperties[0];\r\n            }\r\n\r\n            if (Array.isArray(metaData)) {\r\n                metaData = metaData[0];\r\n            }\r\n\r\n            fileProperties.idAttrib = self.properties.idAttrib;\r\n            fileProperties.showMetadata = self.properties.showMetadata;\r\n            fileProperties.xpathContext = self.getXpathContext() || form.properties.xpathContext || \"\";\r\n            fileProperties.xpath = self.properties.xpath;\r\n            fileProperties.fileName = data.fileName;\r\n            fileProperties.idPageCache = self.properties.idPageCache;\r\n            fileProperties.fileData = originalData;\r\n\r\n            var result = $.extend({}, fileProperties, metaData);\r\n\r\n            deferred.resolve(result);\r\n\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n\r\n        this.$contentFile = $(\".bz-file-upload__container\", $control);\r\n        this.$inputFile = $(\".bz-file-upload__input\", $control);\r\n        this.$nativeFile = $(\".bz-file-upload__native\", $control);        \r\n    },\r\n\r\n    configureHandlers: function () {\r\n        this.checkFileExtensions();\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Handler to download the file\r\n        $(\"ul.bz-readonly-lists\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            var file = item.data();\r\n\r\n            bizagi.loading.start();\r\n\r\n            $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Send image using HTTP\r\n     */\r\n    saveImage: function () {\r\n        var self = this;\r\n        var dataItem = \"\";\r\n\r\n        if (self.editedImageURL) {\r\n            dataItem = self.editedImageURL;\r\n        } else if (self.fileProperties) {\r\n            dataItem = self.fileProperties.url;\r\n        }\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        var dataFile = bizagi.util.media.getImagePath(dataItem);\r\n        var data = {\r\n            dataFile: dataFile,\r\n            fileName: self.fileProperties.name,\r\n            mimeType: \"image/jpeg\"\r\n        };\r\n\r\n        // Cleans variables related previous uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        return this.uploadFile(data);\r\n    },\r\n\r\n    /**\r\n     * Method to save a video file\r\n     * @param {} dataVideo\r\n     * @returns {}\r\n     */\r\n    saveVideo: function (dataVideo) {\r\n        var data = {\r\n            dataFile: dataVideo[0].fullPath,\r\n            fileName: dataVideo[0].name,\r\n            mimeType: \"video/quicktime\"\r\n        };\r\n\r\n        return this.uploadFile(data);\r\n    },\r\n\r\n    /**\r\n     * Method to save a file\r\n     * @param data\r\n     * @returns {*|void}\r\n     */\r\n    uploadFile: function (data) {\r\n        var self = this;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = data.fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = data.fileName;\r\n        params.options.uploadKey = {key: \"Filedata\"};\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = data.dataFile;\r\n\r\n        if (data.mimeType)\r\n            params.options.mimeType = data.mimeType;\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).then(function (result) {\r\n            self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result.response)));\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to configure the actions with control\r\n     * @return {}\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Handlers to management of menu actions\r\n        $.each(self.files, function (i, file) {\r\n            self.attackMenuEvents(file);\r\n        });\r\n\r\n        // Attach all events\r\n        this.$contentFile.off(\"click\").on(\"click\", function (evt) {\r\n            self.chooseFile();\r\n        });\r\n\r\n        // Handler to download the file\r\n        $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\r\n            var item = $(this).parent(\".bz-file\");\r\n            var file = item.data();\r\n\r\n            bizagi.loading.start();\r\n\r\n            $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n\r\n\r\n        if (self.isNative) {\r\n            // Upload files\r\n            this.$nativeFile.off(\"click\").actionSheet({\r\n                actions: self.getUploadChoices(),\r\n                actionClicked: function (action) {\r\n                    self.handlerUploadFile(action.guid);\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n\r\n            // Resolution upload\r\n            $(\".bz-file-upload__resolution\", $control).off(\"click\").actionSheet({\r\n                actions: bizagi.util.media.getImageResolutionSizes(),\r\n                withoutCancel: true,\r\n                actionClicked: function (action) {\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(self.handlerResolutionUpload(action.guid)).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n        } else {\r\n\r\n            // Attach event to web upload-control\r\n            this.$inputFile.off(\"change\").on(\"change\", function () {\r\n                self.addFile();\r\n                this.value = \"\";\r\n            });\r\n\r\n            // Just in case\r\n            this.$inputFile.off(\"click\").on(\"click\", function (evt) {\r\n                evt.stopPropagation();\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Update menu options\r\n     * @param $fileItem\r\n     * @param fileProperties\r\n     */\r\n    addMenuEvents: function ($fileItem, fileProperties) {\r\n        var self = this;\r\n        var viewMore = $fileItem.find(\".bz-file-menu\");\r\n        var items = [];\r\n\r\n        if (fileProperties.showMetadata) {\r\n            items.push({\r\n                name: self.getResource(\"render-collection-navigator-details-form\"),\r\n                fn: function () {\r\n                    self.processActionByType(self.Class.ACTION_DETAILS, fileProperties, $fileItem);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (fileProperties.showMetadata && fileProperties.allowUpdateMetadata)\r\n            items.push({\r\n                name: self.getResource(\"render-collection-navigator-edit-form\"),\r\n                fn: function () {\r\n                    self.processActionByType(self.Class.ACTION_EDIT, fileProperties, $fileItem);\r\n                }\r\n            });\r\n\r\n        if (fileProperties.allowCheckOut) {\r\n            items.push({\r\n                name: self.getResource(\"render-ecm-bt-lock\"),\r\n                fn: function () {\r\n                    self.lockECMFile($fileItem, fileProperties);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (fileProperties.allowCancelCheckOut) {\r\n            items.push({\r\n                name: self.getResource(\"render-ecm-bt-unlock\"),\r\n                fn: function () {\r\n                    self.unlockECMFile($fileItem, fileProperties);\r\n                }\r\n            });\r\n        }\r\n\r\n        /*if (fileProperties.allowUpdateContent) {\r\n            items.push({\r\n                name: self.getResource(\"render-ecm-bt-upgrade\"),\r\n                fn: function () {\r\n                    self.processActionByType(\"upgrade\", fileProperties);\r\n                }\r\n            });\r\n        }*/\r\n\r\n        if (fileProperties.allowDelete) {\r\n            items.push({\r\n                name: self.getResource(\"render-ecm-bt-delete\"),\r\n                fn: function () {\r\n                    self.deleteECMFile($fileItem, fileProperties.idFileUpload);\r\n                }\r\n            });\r\n        }\r\n\r\n        // TODO: Check items has data\r\n        viewMore.overflowMenu({items: items});\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the ECM control\r\n     * @param $fileItem\r\n     * @param fileId\r\n     */\r\n    deleteECMFile: function ($fileItem, fileId) {\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-ecm-confirm-message\"))\r\n            .done(function () {\r\n                $.when(self.deleteUploadItem($fileItem, fileId))\r\n                    .done(function () {\r\n                        // Detach item\r\n                        $fileItem.hide();\r\n                        $fileItem.remove();\r\n\r\n                        // Update value\r\n                        self.setValue(self.files, false);\r\n\r\n                        // Check maxFiles\r\n                        self.checkMaxFiles();\r\n\r\n                        // Trigger change\r\n                        self.triggerRenderChange();\r\n                    });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Check maximum number of files\r\n     */\r\n    checkMaxFiles: function () {\r\n        if (this.isMaxFilesReached()) {\r\n            $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\r\n        } else {\r\n            $(this.$contentFile).removeClass(\"bz-file-upload__container--hidden\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if the maximum number of files than can be uploaded has been reached\r\n     * @returns {}\r\n     */\r\n    isMaxFilesReached: function () {\r\n        var maxFiles = this.properties.maxfiles;\r\n        var actualFiles = this.properties.value ? this.properties.value.length : 0;\r\n\r\n        return maxFiles !== 0 && (this.filesCount >= maxFiles && actualFiles >= maxFiles);\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var errorResponse = \"\";\r\n\r\n        if (error && error.code === this.Class.ERROR_ECM_NO_AVAILABLE) {\r\n            errorResponse = this.getResource(\"render-ecm-service-not-available\");\r\n        } else if (error && error.responseText) {\r\n            errorResponse = error.responseText;\r\n        } else {\r\n            errorResponse = this.getResource(\"render-ecm-service-general-error\");\r\n        }\r\n\r\n        this.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    lockECMFile: function ($fileItem, fileProperties) {\r\n        var self = this;\r\n\r\n        $.when(self.lockUploadItem(fileProperties.idFileUpload)).done(\r\n            function (result) {\r\n                var file = [result.idFileUpload, fileProperties.fileName];\r\n                var newItem = self.renderUploadItem(file);\r\n\r\n                $fileItem.replaceWith(newItem);\r\n                self.attackMenuEvents(file);\r\n            });\r\n    },\r\n\r\n    unlockECMFile: function ($fileItem, fileProperties) {\r\n        var self = this;\r\n\r\n        $.when(self.unlockUploadItem(fileProperties.idFileUpload))\r\n            .done(function (result) {\r\n                var file = [result.idFileUpload, fileProperties.fileName];\r\n                var newItem = self.renderUploadItem(file);\r\n\r\n                $fileItem.replaceWith(newItem);\r\n                self.attackMenuEvents(file);\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Method to add new file from native or hybrid environment\r\n     */\r\n    chooseFile: function () {\r\n        if (this.isNative) {\r\n            this.$nativeFile.click();\r\n        } else if (bizagi.util.media.fileAPISupported()) {\r\n            this.$inputFile.click();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check allow extensions and define possible choices\r\n     * @returns {}\r\n     */\r\n    checkFileExtensions: function () {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        self.validOptions = {video: false, image: false, file: false};\r\n\r\n        // Preprocess the extensions string\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions === \"\") {\r\n            self.validOptions = {video: true, image: true, file: true};\r\n        } else {\r\n            validExtensions = validExtensions.split(\";\");\r\n\r\n            if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n                self.validOptions.video = true;\r\n                self.validOptions.image = true;\r\n            } else {\r\n                for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n                    validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n                    if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.file = true;\r\n                    } else if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.image = true;\r\n                    } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.video = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Media is not supported then upload control is disabled\r\n        if (!self.validOptions.file && !self.validOptions.image && !self.validOptions.video) {\r\n            $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\r\n        }\r\n\r\n        // Limit of files is reached then upload control is disabled\r\n        if (self.isMaxFilesReached() || (!self.isNative && !bizagi.util.media.fileAPISupported())) {\r\n            $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Add upload options\r\n     */\r\n    getUploadChoices: function () {\r\n        var self = this;\r\n        var itemsUpload = [];\r\n\r\n        // Take photo, Choose photo\r\n        if (self.validOptions.image) {\r\n            itemsUpload.push({\r\n                \"guid\": 1,\r\n                \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\")\r\n            });\r\n            itemsUpload.push({\r\n                \"guid\": 2,\r\n                \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\")\r\n            });\r\n        }\r\n\r\n        // Take video\r\n        if (self.validOptions.video) {\r\n            itemsUpload.push({\r\n                \"guid\": 3,\r\n                \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\")\r\n            });\r\n        }\r\n\r\n        // Stores the upload options\r\n        return [].concat(itemsUpload);\r\n    },\r\n\r\n    /**\r\n     * Handler of upload files\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerUploadFile: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        switch (actionSelected) {\r\n            case 2:\r\n\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    self.dataImage = dataImage;\r\n                    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\r\n\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            // Gets the real properties for the file\r\n                            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage))\r\n                                .then(function (fileData) {\r\n                                    self.fileProperties = fileData;\r\n\r\n                                    if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\r\n                                        if (!bizagi.util.isAndroid()) {\r\n                                            return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\r\n                                                if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                    return self.handlerResolutionUpload(buttonIndex);\r\n                                                }\r\n                                            });\r\n\r\n                                        } else {\r\n                                            // Force click to show actionsheet menu\r\n                                            $(\".bz-file-upload__resolution\", self.getControl()).click();\r\n                                        }\r\n                                    }\r\n                                });\r\n                        }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n\r\n                }, self.onFail.bind(self), {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY\r\n                });\r\n                break;\r\n            case 1:\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                        bizagi.loading.start();\r\n\r\n                        $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\r\n                            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                                self.fileProperties = fileData;\r\n                                return self.saveImage(dataImage);\r\n                            });\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                    },\r\n                    self.onFail.bind(self), {\r\n                        quality: self.Class.QUALITY_PICTURE,\r\n                        sourceType: navigator.camera.PictureSourceType.CAMERA,\r\n                        mediaType: navigator.camera.MediaType.PICTURE,\r\n                        destinationType: Camera.DestinationType.FILE_URI,\r\n                        correctOrientation: true,\r\n                        targetWidth: 1280,\r\n                        targetHeight: 960\r\n                    });\r\n                break;\r\n            case 3:\r\n                navigator.device.capture.captureVideo(function (dataVideo) {\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSizeVideo(dataVideo, self.properties))\r\n                        .then(function () {\r\n                            return self.saveVideo(dataVideo);\r\n                        }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n\r\n                }, self.onFail.bind(self), {limit: self.Class.LIMIT});\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Catch errors\r\n     * @param {} error\r\n     */\r\n    onFail: function (error) {\r\n        var messageError = bizagi.util.processFailMessage(error);\r\n\r\n        bizagi.loading.stop();\r\n\r\n        if (messageError && typeof (messageError) === \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\r\n            var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\r\n            var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\r\n\r\n            self.performValidationMessage(message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Adds a validation message to the render\r\n     * @param message\r\n     */\r\n    performValidationMessage: function (message) {\r\n        var fail = bizagi.util.processFailMessage(message);\r\n\r\n        bizagi.showMessageBox(fail);\r\n    },\r\n\r\n    /**\r\n     * Handler of resolution upload\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerResolutionUpload: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return self.saveImage(self.dataImage);\r\n        } else {\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).then(function (result) {\r\n\r\n                self.editedImageURL = result.localUrl;\r\n                self.properties.url = result.base64Image;\r\n\r\n                return self.saveImage(self.dataImage);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to add new file\r\n     */\r\n    addFile: function () {\r\n        var self = this;\r\n        var dataFile = this.$inputFile[0].files[0];\r\n        var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSVIDEO);\r\n\r\n        dataFile.fullPath = this.$inputFile[0].value;\r\n        bizagi.loading.start();\r\n\r\n        if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n            $.when(self.processUploadFile(dataFile)).done(function (result) {\r\n                if (!bizagi.util.isFailResponse(result)) {\r\n                    self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result)));\r\n                } else {\r\n                    self.performValidationMessage(result)\r\n                }\r\n            }).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        } else {\r\n            bizagi.loading.stop();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @param {} dataFile\r\n     */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n        var data = self.buildAddParams();\r\n\r\n        // Build add params to send to the server\r\n        var keys = Object.keys(data);\r\n\r\n        keys.map(function (key) {\r\n            formData.append(key, data[key]);\r\n        });\r\n\r\n        formData.append(\"Filedata\", dataFile);\r\n        formData.append(\"Filename\", dataFile.name.substr(dataFile.name.replace(/([\\\\\\/]+)/g, \"/\").lastIndexOf(\"/\") + 1));\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n\r\n        if (self.properties.contexttype)\r\n            formData.append(prefix + \"contexttype\", self.properties.contexttype);\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    processUploadFile: function (dataFile) {\r\n        var data = {\r\n            url: this.properties.addUrl,\r\n            formData: this.buildAddFileParams(dataFile)\r\n        };\r\n\r\n        return this.dataService.processUploadFile(data);\r\n    },\r\n\r\n    /**\r\n     * onUploadFileCompleted\r\n     * @param {} result\r\n     */\r\n    onUploadFileCompleted: function (result) {\r\n        var self = this;\r\n        var $wrapper = $(\".bz-files\", self.getControl());\r\n\r\n        if (result.idFileUpload && result.fileName) {\r\n            var file = [result.idFileUpload, result.fileName];\r\n            var newItem = self.renderUploadItem(file);\r\n\r\n            // Locate it before the upload wrapper\r\n            $wrapper.append(newItem);\r\n\r\n            // Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push(file);\r\n\r\n            // Update value\r\n            self.setValue(files, true);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n            self.attackMenuEvents(file);\r\n\r\n            self.editedImageURL = null;\r\n        } else {\r\n            self.performValidationMessage(result.message);\r\n        }\r\n    },\r\n\r\n    attackMenuEvents: function (file) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        if (file && file.getFileProperties) {\r\n            $.when(file.getFileProperties).done(function (fileProperties) {\r\n                // TODO: Fail scenario...\r\n                var $fileItem = $(\".\" + self.properties.id + \"-\" + fileProperties.idFileUpload, $control);\r\n\r\n                self.fileData[fileProperties.idFileUpload] = fileProperties.metadata || [];\r\n                self.addMenuEvents($fileItem, fileProperties);\r\n            });\r\n        }\r\n    },\r\n\r\n    processActionByType: function (type, fileData, $fileItem) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        bizagi.loading.start();\r\n\r\n        // Instantiate slide form object\r\n        var slideView = new bizagi.rendering.smartphone.slide.ecm(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",\r\n            container: form.container,\r\n            navigation: self.getParams().navigation,\r\n            editable: properties.editable && type !== self.Class.ACTION_DETAILS,\r\n            orientation: properties.orientation || \"ltr\",\r\n            onSave: function (result) {\r\n                if (result.update) {\r\n                    var file = [result.idFileUpload, result.fileName];\r\n                    var newItem = self.renderUploadItem(file);\r\n\r\n                    $fileItem.replaceWith(newItem);\r\n                    self.attackMenuEvents(file);\r\n                }\r\n            },\r\n            onCancel: function () {\r\n                // console.log(\"CANCEL\");\r\n            }\r\n        });\r\n\r\n        slideView.render({metadata: fileData.metadata, fileData: fileData})\r\n            .always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Grid Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the grid render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.grid\", bizagi.rendering.grid.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid\", {}, {\r\n\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n\r\n        //support multiples instances of decorates objects   the object in false means \r\n        //enable the decorated is an array and so can save several renderings\r\n        data.properties.singleInstance = false;\r\n        // Call base\r\n\r\n        data.properties.rowsPerPage = 1;\r\n        //data.properties.labelAlign = \"left\";\r\n        data.properties.displayType = \"vertical\";\r\n        self._super(params);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        //properties.labelAlign = \"left\";\r\n        properties.rowsPerPage = 1;\r\n\r\n        //revisar base para mejorar comportamiento cuando esta en false los elementos\r\n        $.each(self.columns, function (index, value) {\r\n            if (this.properties && this.properties.editable)\r\n                this.properties.editable = (properties.allowEdit == true) ? true : false;\r\n            //enable to apply edit and next send request            \r\n        });\r\n        // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\r\n        if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\r\n            var newData = [];\r\n            newData.push(properties.data.rows[0]);\r\n            properties.data.rows = newData;\r\n        }\r\n    },\r\n\r\n    /* method overrides\r\n    *  from base or virtual\r\n    */\r\n    setDisplayValue: function (value) {\r\n    },\r\n\r\n    setDisplayValueEdit: function (value) {\r\n    },\r\n\r\n    actionSave: function () {\r\n    },\r\n\r\n    /*\r\n    * Updates manually the affected cell \r\n    */\r\n    updateAffectedCellManually: function () {\r\n    },\r\n\r\n    /*\r\n    * Get the row index using the key as a reference\r\n    */\r\n    getRowIndexByKey: function () {\r\n    },\r\n\r\n    /**\r\n     *  Shows more info about a grid row\r\n     * in smartphones not implemented\r\n     */\r\n    showMore: function (id) {\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        var properties = self.properties;\r\n        properties.rowsPerPage = 1;\r\n        var container = self.getContainerRender();\r\n        self.getLabel().hide();\r\n        var control = self.getControl();\r\n        var grid = self.grid = $(\".bz-mobile-grid\", control);\r\n\r\n        var mode = self.getMode();\r\n        var columns = self.buildColumnModel();\r\n\r\n        var columnsTotalizers = jQuery.grep(columns, function (a) {\r\n            return (a.summarizeBy);\r\n        });\r\n\r\n        //bizagi_grid_smartphone\r\n        grid.bizagi_grid_smartphone({\r\n            columns: columns,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm),\r\n                details: properties.allowDetail,\r\n                remove: properties.allowDelete,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: false,\r\n                totalizer: properties.showSummary,\r\n                hasTotalizer: columnsTotalizers.length > 0 && properties.data.rows.length > 0 ? true : false\r\n            },\r\n\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.onPageRequested(ui);\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            isValid: function (invalidElements) {\r\n                return self.isValidGrid(invalidElements);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                //self.triggerHandler(\"rowSelected\", { id: ui.key });\r\n            },\r\n            totalData: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.onTotalData();\r\n            },\r\n            gridControlReady: function () {\r\n                self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n                self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n            },\r\n            addRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.addRow();\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            showFormDetails: function (ui) {\r\n                self.showDetailForm(ui.key);\r\n            },\r\n            showMore: function (ui) {\r\n                self.showMore(ui.key);\r\n            }\r\n        });\r\n\r\n\r\n        // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\r\n        if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\r\n            var newData = [];\r\n            newData.push(properties.data.rows[0]);\r\n            properties.data.rows = newData;\r\n        }\r\n\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        // Set initial data\r\n        if (!properties.skipInitialLoad) {\r\n            if (properties.data) {\r\n                self.updateData(properties.data);\r\n\r\n                // Trigger change in order to start up the actions when the controls is ready\r\n                $.when(self.ready())\r\n                    .done(function () {\r\n                        self.triggerRenderChange({changed: false});\r\n                    });\r\n            } else {\r\n                self.fetchData(properties.page, properties.sortBy, properties.sortOrder);\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n   *   Method to render non editable values\r\n   */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Do the same as the post-render\r\n        self.postRender();\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (control) {\r\n            if (color != 'none') {\r\n                $(\".bz-mobile-grid\", control).css(\"background-color\", color);\r\n            } else {\r\n                $(\".bz-mobile-grid\", control).css(\"background-color\", \"\");\r\n            }\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    setHeaderStyles: function (cell) {\r\n        var self = this;\r\n        var label_style = \"font-weight: bold; \";\r\n        var properties = self.properties;\r\n\r\n        if (properties.headerFormat) {\r\n            var format = properties.headerFormat;\r\n\r\n            if (typeof format.bold !== \"undefined\") {\r\n                label_style = \"font-weight: normal; \";\r\n            }\r\n\r\n            if (format.color) {\r\n                label_style += \"color: \" + format.color + \";\";\r\n            }\r\n\r\n            if (format.background) {\r\n                label_style += \"background-color: \" + format.background + \";\";\r\n            }\r\n\r\n            if (format.italic) {\r\n                label_style += \"font-style: italic; \";\r\n            }\r\n\r\n            if (format.underline || format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\r\n\r\n                label_style += \"text-decoration: \" + strikethru + underline + \";\";\r\n            }\r\n\r\n            if (format.size && format.size != \"0\") {\r\n                var newFontSize = (100 + Number(format.size) * 10) + \"%\";\r\n                label_style += \"font-size: \" + newFontSize + \";\";\r\n            }\r\n        }\r\n        return cell.replace(\"%labelStyle%\", label_style);\r\n    },\r\n\r\n    onTotalData: function (ui) {\r\n\r\n        var self = this;\r\n        var containerForm = self.getFormContainer();\r\n        containerForm.saveForm();\r\n\r\n        //defered que retorne la respuesta del servidor\r\n        bizagi.loading.start();\r\n        $.when(self.fetchTotalData()).done(function (data) {\r\n            var rows = data.rows;\r\n            var rowsLength = rows.length;\r\n\r\n            //calcula los totalizadores y crea el html\r\n            var showTotal = [];\r\n\r\n            var columnsModel = self.buildColumnModel();\r\n            var result;\r\n\r\n            var operationState;\r\n\r\n            columnsModel.forEach(function callback(column, columnIndex) {\r\n                if (column.bizAgiProperties) {\r\n                    operationState = column.bizAgiProperties.totalize.operation;\r\n\r\n                    switch (operationState) {\r\n                        case \"sum\":\r\n                            result = rows.sum(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value)\r\n                            }, columnIndex);\r\n                            break;\r\n\r\n                        case \"count\":\r\n                            result = rows.count(function (row) {\r\n                                //Checks if there is a DefaultValue, so assign it to the returnedvalu in case it doesn't have value\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n\r\n                                if (!bizagi.util.isArray(return_value)) {\r\n                                    return return_value;\r\n                                }\r\n\r\n                                if (bizagi.util.isArray(return_value) && return_value.length > 0) {\r\n                                    return return_value; //If the returned value is not undefined, neither null, it will count +1\r\n                                }\r\n                            }, column, columnIndex);\r\n\r\n                            break;\r\n\r\n                        case \"max\":\r\n                            result = rows.max(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value)\r\n                            }, columnIndex);\r\n\r\n                            break;\r\n\r\n                        case \"min\":\r\n                            result = rows.min(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value);\r\n                            }, columnIndex);\r\n                            break;\r\n\r\n                        case \"avg\":\r\n                            result = rows.avg(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value);\r\n                            }, columnIndex);\r\n\r\n                            result = result.toFixed(2);\r\n                            break;\r\n                    }\r\n\r\n                    if (operationState) {\r\n                        result = self.formatTotalizedResult(operationState, column.bizAgiProperties.type, result);\r\n                        showTotal.push({label: column.label, total: result});\r\n                    }\r\n                }\r\n            });\r\n\r\n            self.showTotals(showTotal);\r\n        }).fail(function (error) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-no-records\"), \"Error\");\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Fetch Sum Data\r\n     */\r\n    fetchTotalData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sort,\r\n            page: 1,\r\n            rows: self.properties.data.records,\r\n            searchFilter: properties.searchFilter\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            var result = properties.overrideGetRemoteData(params);\r\n            return result != null ? result.promise() : null;\r\n        }\r\n\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridData(params).done(function (data) {\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n\r\n            defer.resolve(data);\r\n        }).fail(function (fail) {\r\n\r\n            defer.reject(fail);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    formatTotalizedResult: function (operation, controlType, value) {\r\n        switch (operation) {\r\n            case 'sum':\r\n            case 'avg':\r\n            case 'min':\r\n            case 'max':\r\n                if (controlType == \"columnMoney\" || controlType == \"money\") {\r\n                    return bizagi.util.formatMonetaryCell(value);\r\n                }\r\n                break;\r\n        }\r\n\r\n        return value || 0;\r\n    },\r\n\r\n    showTotals: function (params) {\r\n        var self = this;\r\n        var content = $.fasttmpl(self.renderFactory.getTemplate('bizagi.grid.totalizer'), {items: params});\r\n\r\n        self.grid.mobileView({\r\n            displayName: bizagi.localization.getResource(\"render-grid-totalizer\"),\r\n            orientation: self.properties.orientation,\r\n            style: \"width: 90%; height: 70%\",\r\n            transition: \"fade:in\",\r\n            cssClass: \"bz-modal-view--totalizer\",\r\n            showBorder: true,\r\n            contentTemplate: content\r\n        });\r\n    },\r\n\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            align: \"\",\r\n            key: true\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                hidden: (!column.properties.visible || column.properties.type === \"columnHidden\" || column.properties.columnVisible === false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n\r\n    /**\r\n     * Makes the grid to refresh\r\n     */\r\n    refresh: function () {\r\n        return $.when(this.fetchData());\r\n    },\r\n\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function () {\r\n        return this.dataReadyDeferred != null ? this.dataReadyDeferred.promise() : null;\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data && self.properties) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n\r\n            self.triggerGridPluginHandler(\"setData\", data);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Define defaults\r\n        page = page || 1;\r\n        sortBy = sortBy || \"\";\r\n        sortType = sortType || \"asc\";\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        bizagi.loading.start();\r\n\r\n        return $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n\r\n                if (data) {\r\n                    $.when(self.updateData(data)).done(function () {\r\n                        self.triggerRenderChange({changed: false});\r\n                    });\r\n                }\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n\r\n        // Remove changes for inline added rows\r\n        if (grid && self.properties.inlineAdd) {\r\n            var omitKeys = grid.bizagi_grid_smartphone.hasOwnProperty(\"getNewRowKeys\") ? grid.bizagi_grid_smartphone(\"getNewRowKeys\") : [];\r\n            for (var i = 0, length = omitKeys.length; i < length; i++) {\r\n                if (self.changes[omitKeys[i]]) {\r\n                    delete self.changes[omitKeys[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        self._super(renderValues);\r\n    },\r\n\r\n    onPageRequested: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        if (!jQuery.isEmptyObject(data)) {\r\n\r\n            self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache\r\n            });\r\n\r\n        }\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n    },\r\n\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        //revisar ya que en las demas implementacion en desktop y tablet utilizan una validacion para edicion en linea o no\r\n        var self = this;\r\n        self.newRecords = {};\r\n\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n\r\n        if (cellOverride) {\r\n            visible = cellOverride.visible;\r\n            editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        }\r\n\r\n        // Set the value of labelAlign and valueAlign to use the rendering in the base\r\n        //TODO: validar despues que sucede si se adiciona a la base para todos los dispositivos\r\n        renderColumn.properties.labelAlign = \"default\"\r\n        if (renderColumn.properties.columntitlealign) {\r\n            renderColumn.properties.labelAlign = renderColumn.properties.columntitlealign;\r\n        }\r\n\r\n        renderColumn.properties.valueAlign = \"default\"\r\n        if (renderColumn.properties.columnAlign) {\r\n            renderColumn.properties.valueAlign = renderColumn.properties.columnAlign;\r\n        }\r\n\r\n\r\n        if (visible) {\r\n            //&& self.properties.inlineEdit\r\n            if (editable) {\r\n                var defer = new $.Deferred();\r\n\r\n                $.when(renderColumn.render(key, value)).done(function (cell) {\r\n\r\n                    if (cell && $(cell).css(\"display\") !== \"none\") {\r\n                        //cell = self.setHeaderStyles(cell);\r\n                    }\r\n\r\n                    // Register array with new records\r\n                    if (isNewRow && !self.newRecords[key]) {\r\n                        self.newRecords[key] = {};\r\n                    }\r\n\r\n                    for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                        self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                        self.getCellOverride(key, j).visible = true;\r\n                    }\r\n\r\n                    self.bindRenderChange(renderColumn, key, true);\r\n\r\n                    defer.resolve(cell);\r\n                });\r\n                return defer.promise();\r\n            } else {\r\n                /**/\r\n                //return renderColumn.renderReadOnly(key, value);\r\n\r\n                return $.when(renderColumn.renderReadOnly(key, value)).then(function (cell) {\r\n\r\n                    if (cell && $(cell).css(\"display\") !== \"none\") {\r\n                        //cell = self.setHeaderStyles(cell);\r\n                        var item = $(cell);\r\n\r\n                        if (typeof (self.properties.textFormat) !== \"undefined\") {\r\n\r\n                            if (typeof (self.properties.textFormat.color) !== \"undefined\") {\r\n                                $('label', item).css('color', self.properties.textFormat.color);\r\n                            }\r\n\r\n                            if ((typeof (self.properties.textFormat.size) !== \"undefined\") && (self.properties.textFormat.size > 0)) {\r\n                                var newFontSize = (100 + Number(self.properties.textFormat.size) * 10) + \"%\";\r\n                                $('label', item).css('font-size', newFontSize);\r\n                            }\r\n                        }\r\n                        // TODO: Review template cell.readonly\r\n                        cell = item && item[0] ? item[0].outerHTML : cell;\r\n                    }\r\n\r\n                    return (cell || \"\");\r\n                });\r\n\r\n            }\r\n\r\n\r\n        } else {\r\n            return \"\";\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = ((self.cellMetadata[key][columnIndex] != undefined) ? self.cellMetadata[key][columnIndex].properties : undefined) || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        $(\".bz-rn-messages\", cell).toggleClass(\"bz-rn-messages\", \"bz-rn-messages-grid\");\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n            if (editable) {\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n            } else {\r\n\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                renderColumn.postRender(key, cell);\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    addRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getFormContainer().container;\r\n        var dataservice = self.dataService;\r\n\r\n        bizagi.loading.start();\r\n\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n                var propertiesGridForm = {\r\n                    idRender: properties.id,\r\n                    \"recordXPath\": recordXpath,\r\n                    url: properties.addPage,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    xpath: recordXpath,\r\n                    editable: true,\r\n                    requestedForm: \"addForm\",\r\n                    displayName: properties.addLabel,\r\n                    idAsigned: newid,\r\n                    enableEditSubmitRequest: false,\r\n                    hideLabel: true,\r\n                    disableProcessButons: true\r\n                };\r\n\r\n                var argumentsfl = {\r\n                    \"renderFactory\": self.renderFactory,\r\n                    \"dataService\": dataservice,\r\n                    \"parent\": self,\r\n                    \"data\": {\r\n                        properties: propertiesGridForm\r\n                    }\r\n                };\r\n\r\n                var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\r\n                jQuery.extend(formlink, {\r\n                    contextEdit: $(container).find(\".bz-container__item-edit\"),\r\n                    element: self.element,\r\n                    actionSave: self.actionSaveNewRow,\r\n                    actionCancel: self.actionCancelRow,\r\n                    _sendRelation: function () {\r\n                        return true;\r\n                    },\r\n                    _getData: self.dataService.getFormData,\r\n                    _params: propertiesGridForm\r\n                });\r\n\r\n                self._InternalRenderLinkForm(formlink);\r\n\r\n            }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Edit form in the grid\r\n     * @param id\r\n     */\r\n    editRow: function (id) {\r\n        var self = this;\r\n        var containerForm = self.getFormContainer();\r\n        var properties = self.properties;\r\n        var container = self.getFormContainer().container;\r\n        var dataservice = self.dataService;\r\n\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        bizagi.loading.start();\r\n        $.when(containerForm.saveForm()).done(function () {\r\n\r\n            var propertiesGridForm = {\r\n                idRender: properties.id,\r\n                id: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                recordXPath: recordXpath,\r\n                xpath: recordXpath,\r\n                editable: true,\r\n                url: properties.editPage,\r\n                requestedForm: \"editForm\",\r\n                displayName: properties.editLabel,\r\n                idAsigned: id,\r\n                disableProcessButons: true\r\n            };\r\n\r\n            var argumentsfl = {\r\n                \"renderFactory\": self.renderFactory,\r\n                \"dataService\": dataservice,\r\n                \"parent\": self,\r\n                \"data\": {\r\n                    properties: propertiesGridForm\r\n                }\r\n            };\r\n\r\n            var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\r\n\r\n            jQuery.extend(formlink, {\r\n                contextEdit: $(container).find(\".bz-container__item-edit\"),\r\n                element: self.element,\r\n                //disable if you want only save at the end (submit the form)\r\n                actionSave: self.actionSaveNewRow,\r\n                actionCancel: self.actionCancelRow,\r\n                _sendRelation: formlink.submitEditRequest,\r\n                _getData: self.dataService.getFormData,\r\n                _params: propertiesGridForm\r\n            });\r\n\r\n            self._InternalRenderLinkForm(formlink);\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    _InternalRenderLinkForm: function (formlink) {\r\n        $.when(formlink.renderEdition()).done(function () {\r\n            formlink.endLoading();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show details form\r\n     * @param id\r\n     */\r\n    showDetailForm: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getFormContainer().container;\r\n        var dataservice = self.dataService;\r\n\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        var propertiesGridForm = {\r\n            idRender: properties.id,\r\n            id: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: recordXpath,\r\n            xpath: recordXpath,\r\n            editable: false,\r\n            url: properties.editPage,\r\n            requestedForm: \"detailForm\",\r\n            displayName: properties.editLabel,\r\n            idAsigned: id,\r\n            disableProcessButons: true\r\n        };\r\n\r\n        var argumentsfl = {\r\n            \"renderFactory\": self.renderFactory,\r\n            \"dataService\": dataservice,\r\n            \"parent\": self,\r\n            \"data\": {\r\n                properties: propertiesGridForm\r\n            }\r\n        };\r\n\r\n        var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\r\n\r\n        jQuery.extend(formlink, {\r\n            contextEdit: $(container).find(\".bz-container__item-edit\"),\r\n            element: self.element,\r\n            _getData: self.dataService.getFormData,\r\n            _params: propertiesGridForm\r\n        });\r\n\r\n        self._InternalRenderLinkForm(formlink);\r\n    },\r\n\r\n    /**\r\n     *  Deletes  a row to the grid\r\n     */\r\n    deleteRow: function (id) {\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n                // Do a grid record deletion\r\n                $.when(self.submitDeleteRequest(id))\r\n                    .done(function (data) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n\r\n                        if (data.type == \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({rowDeleted: true, changed: false, key: id});\r\n                        }\r\n                    }).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                });\r\n            });\r\n    },\r\n\r\n    actionCancelRow: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.submitRollbackRequest()).done(function () {\r\n            deferred.resolve();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     * Save data in the form link related\r\n     * parameter: data data collected in the related form link\r\n     */\r\n    actionSaveNewRow: function (data) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        if (self.form.validateForm() === true) {\r\n            var properties = self.properties;\r\n\r\n            if (!data) {\r\n                self.form.collectRenderValues(data);\r\n            }\r\n\r\n            data.idPageCache = self.form.getPageCache();\r\n\r\n            $.when(\r\n                self.parent.submitSaveRequest(properties.idAsigned, data)).done(function (resp) {\r\n                if (resp.type == \"validationMessages\") {\r\n                    self.form.addValidationMessage(resp.messages);\r\n                    properties.submitOnChange = false;\r\n                    deferred.reject(resp.messages);\r\n                } else {\r\n                    self.parent.fetchData();\r\n                    if (!properties.submitOnChange) {\r\n                        properties.submitOnChange = true;\r\n                    }\r\n                    self.submitOnChange({}, true);\r\n                    deferred.resolve();\r\n                }\r\n            });\r\n        } else {\r\n            deferred.reject();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    applyActionUpdateGrid: function (column, context) {\r\n        var self = context;\r\n        var properties = self.properties;\r\n        var originalMethod = column.decorated.actionSave;\r\n\r\n        jQuery.extend(column.decorated, {\r\n            actionSave: function () {\r\n                var selfIntern = this;\r\n                $.when(originalMethod.apply(selfIntern, arguments)).done(function () {\r\n                    var data = {};\r\n                    self.collectRenderValues(data);\r\n\r\n                    $.when(self.submitSaveRequest(selfIntern.surrogateKey, data)).done(function () {\r\n                        self.fetchData();\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n\r\n        $.each(self.columns, function (i, child) {\r\n\r\n            child = child.decorated;\r\n\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValues(renderValues);\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSent()) {\r\n                    child.collectData(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*   Sets an error on the cell\r\n    */\r\n    setError: function (key, xpath) {\r\n        var self = this;\r\n    },\r\n\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control) {\r\n            if (argument != null)\r\n                control.setDisplayValue(argument);\r\n\r\n            //ISUPP 3866\r\n            var _value = control.column.getValue(key);\r\n            var compositeValue = control.column.getCompositeValue(key);\r\n\r\n            if (argument != null)\r\n                control.setDisplayValue(argument);\r\n\r\n            var trigger = false;\r\n            self.collectGridChange({\r\n                id: key,\r\n                xpath: xpath,\r\n                value: _value,\r\n                compositeValue: compositeValue,\r\n                columnIndex: control.column,\r\n                trigger: trigger\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *\r\n    */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this,\r\n            control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeCellBackgroundColor(argument);\r\n\r\n            //Exclusive for complex elements such as checkboxes, and list\r\n            if (control.element) {\r\n                control.element.find(\".bz-container-render-cell1, .bz-control\").css({\r\n                    \"background-color\": argument,\r\n                    \"background-image\": argument\r\n                });\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control)\r\n            control.changeCellColor(argument);\r\n\r\n    },\r\n    /*\r\n    *   Changes the visibility for a cell\r\n    */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeCellVisibility(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).visible = argument;\r\n\r\n            // Bind/Ubind the render change, so it can works with actions and validations as needed\r\n            if (control.properties.editable && argument) {\r\n                self.bindRenderChange(self.getColumn(xpath), key, true);\r\n            } else {\r\n                self.bindRenderChange(self.getColumn(xpath), key, false);\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    *   Changes the editability for a cell\r\n    */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control) {\r\n            control.changeEditability(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).editable = argument;\r\n\r\n            // Bind/Unbind the render change, so it can works with actions and validations as neededn\r\n            if (control.properties.visible && argument) {\r\n                self.bindRenderChange(self.getColumn(xpath), key, true);\r\n            } else {\r\n                self.bindRenderChange(self.getColumn(xpath), key, false);\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    *   Changes the min value for a cell\r\n    */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeMinValue(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).minValue = argument;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeMaxValue(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).maxValue = argument;\r\n        }\r\n    },\r\n\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.cleanData();\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            var rows = self.properties.data.rows, i = 0, rowLength = rows.length;\r\n            for (; i < rowLength; i++) {\r\n                if (Number(key) === rows[i][0]) {\r\n                    rows[i][j + 1] = [[\"\", \"\"]];\r\n                    break;\r\n                }\r\n            }\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).value = null;\r\n        }\r\n    },\r\n\r\n    isValidGrid: function (invalidElements) {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof (form.validationController) !== \"undefined\")\r\n            form.validationController.clearValidationMessages();\r\n\r\n        self.isValid(errorsMessage);\r\n\r\n        if (errorsMessage.length > 0) {\r\n            if (typeof (form.validationController) !== \"undefined\") {\r\n                for (var i = 0, length = errorsMessage.length; i < length; i++) {\r\n                    // Show validation message\r\n                    form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                }\r\n            }\r\n\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the grid plugin event\r\n     * @returns {}\r\n     */\r\n    triggerGridPluginHandler: function () {\r\n        var self = this;\r\n        var args = Array.prototype.slice.call(arguments, 0);\r\n\r\n        return self.grid.bizagi_grid_smartphone.apply(self.grid, args);\r\n    },\r\n\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    bindRenderChange: function (renderColumn, key, isBinding) {\r\n        var self = this;\r\n\r\n        if (isBinding) {\r\n\r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\r\n\r\n                var value = renderColumn.getValue(args.render.surrogateKey);\r\n                var compositeValue = renderColumn.getCompositeValue(args.render.surrogateKey);\r\n\r\n                if (renderColumn.properties.type == \"columnDate\") {\r\n                    if (!bizagi.util.isEmpty(value)) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                        date.setSeconds(0);\r\n                        date.setMilliseconds(0);\r\n\r\n                        value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    } else if (value === \"\") {\r\n                        value = \"\";\r\n                    }\r\n                }\r\n\r\n                self.collectGridChange($.extend(args, {\r\n                    id: args.render.surrogateKey,\r\n                    xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                    value: value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: renderColumn.columnIndex\r\n                }));\r\n\r\n                // Update change in grid's component data\r\n                self.grid.bizagi_grid_smartphone(\"changeCellValue\", args.render.surrogateKey, renderColumn.columnIndex,\r\n                    value);\r\n\r\n                // If the column has totalizers then we need to refresh the summary\r\n                if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n                    self.grid.bizagi_grid_smartphone(\"refreshSummary\", renderColumn.columnIndex);\r\n                }\r\n            });\r\n        } else {\r\n            renderColumn.getDecorated(key).unbind(\"renderchange\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * Returns the indexes of all elements in the grid\r\n     * @returns {*}\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.properties.data.rows, self.getDataNewRows());\r\n\r\n        return data.reduce(function (acum, current) {\r\n            if (typeof acum.find(function (el) {\r\n                return el[0] == current[0];\r\n            }) === 'undefined') {\r\n                acum.push(current);\r\n            }\r\n            return acum;\r\n        }, []).map(function (item) {\r\n            return item[0];\r\n        });\r\n    },\r\n\r\n    startLoading: function () {\r\n        bizagi.loading.start();\r\n    },\r\n\r\n    endLoading: function () {\r\n        bizagi.loading.stop();\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Grid Offline Extension\r\n *   Author: Daniel Ordonez\r\n *   Comments:\r\n *   -   This script will redefine the offline grid render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid.offline\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var originalRows = bizagi.clone(params.data.properties.data.rows);     \r\n        var completeRows = bizagi.clone(params.data.properties.data.rows);     \r\n        // Call base\r\n        this._super(params);\r\n        var properties = this.properties;\r\n        properties.data.originalRows = originalRows;\r\n        properties.data.completeRows = completeRows;\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        // Fill default properties\r\n        var form = self.getFormContainer();        \r\n    \r\n        properties.isTaskForm = form.properties.isTaskForm\r\n        self.newRecords = {};\r\n        //Preload new lines previously added offline\r\n        if(properties[\"new-records\"]) {            \r\n            var newRowKeys = Object.keys(properties[\"new-records\"]);\r\n            for(var k = 0; k< newRowKeys.length;k++) {\r\n                self.newRecords[newRowKeys[k]] = { createdOffline: true };\r\n                self.changes[newRowKeys[k]] = properties[\"new-records\"][newRowKeys[k]];                \r\n            }\r\n        }\r\n        self[\"deleted-records\"] = properties[\"deleted-records\"] ? properties[\"deleted-records\"] : {};\r\n\r\n        if (properties.groupBy || properties.groupSummary) {\r\n            // Add warning\r\n            form.addWarning(self.getResource(\"render-tablet-warning-grid\"));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.initialLoadDone = false;\r\n\r\n        // Find component holder\r\n        self.grid = $(\">div\", control);\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Grid plugin\r\n        self.applyGridPlugin();\r\n\r\n        // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\r\n        if (properties.data && properties.data.completeRows && properties.data.completeRows.length > 0) {\r\n            var newData = [];\r\n            newData.push(properties.data.completeRows[0]);\r\n            properties.data.rows = newData;\r\n        }\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n\r\n            self.updateData(properties.data);\r\n\r\n            // Trigger change in order to start up the actions when the controls is ready\r\n            $.when(self.ready()).done(function () {\r\n                    self.triggerRenderChange({changed: false});\r\n                });\r\n        }\r\n\r\n        // Execute pending actions\r\n        self.initialLoadDone = true;\r\n\r\n        for (var i in self.pendingActions) {\r\n            self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Do the same as the post-render            \r\n        self.postRender();\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var grid = self.grid;\r\n        var mode = self.getMode();\r\n\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_smartphone({\r\n            columns: columns,\r\n            title: properties.displayName,\r\n            isOfflineForm: this.isOfflineForm || false,\r\n            mode: self.getMode(),\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),            \r\n                pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),                \r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.offline.cell.special\"),\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,               \r\n                inlineAdd: properties.inlineAdd,\r\n                details: false,\r\n                allowMore: false,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false,\r\n                hasTotalizer: false\r\n            },\r\n            isValid: function () {\r\n                return self.isValidGrid();\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.onPageRequested(ui)\r\n            },\r\n            totalData: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                //self.onTotalData();\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {                \r\n                //self.triggerHandler(\"rowSelected\", {id: ui.key, data: ui});\r\n            },\r\n            addRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.addRow();\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            showMore: function (ui) {\r\n                self.showMore(ui.key);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Define defaults\r\n        page = page || 1;\r\n        sortBy = sortBy || \"\";\r\n        sortType = sortType || \"asc\";\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData()).then(function (data) {\r\n            self.endLoading();\r\n            if (data) {\r\n                self.updateData(data);\r\n                self.triggerRenderChange();\r\n                self.dataReadyDeferred.resolve();\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Method not required in smartphone implementation\r\n    */\r\n    processChanges: function () {\r\n        var self = this;\r\n        var rowsList = [];\r\n        return rowsList;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var internalRedersValues = [];\r\n        var properties = self.properties;\r\n        var data = self.properties.data;\r\n        var temporalNew = {};\r\n        // Save pending inline add rows\r\n        if (self.isValidGrid()) {\r\n            for (var id in self.changes) {\r\n                var sortArray = [];\r\n                var currentChanges = {};                \r\n                for (var columnXpath in self.changes[id]) {\r\n\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var columnNumber = self.getColumn(columnXpath).columnIndex - 1;\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        if (typeof value === \"string\") {\r\n                            if (value.match(/\\n/gm) !== null) {\r\n                                value = value.replaceAll(\"\\n\", \"\\\\n\");\r\n                            }\r\n                        }\r\n\r\n                        sortArray[columnNumber] = value;                                  \r\n                        var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var value = self.changes[id][columnXpath].value?self.changes[id][columnXpath].value:self.changes[id][columnXpath];                                \r\n                        renderValues[xpath] = value;\r\n                        //Changes are store to delete them if the row is new, the rest of changes can be saved by xpath\r\n                        currentChanges[xpath] = value;\r\n                    }\r\n                }\r\n                //If new record store action data\r\n                if(self.newRecords[id]) {\r\n                    //Use - to avoid issues with possible xpaths in renderValues used both in new and deleted records\r\n                    var addRowData = {\r\n                        url: properties.addUrl,\r\n                        idRender: properties.id,\r\n                        xpath: properties.xpath,\r\n                        xpathContext: properties.xpathContext,\r\n                        contexttype: properties.contexttype,\r\n                        idPageCache: properties.idPageCache,\r\n                        submitData: self.changes[id],\r\n                        prepare: true,\r\n                        idRow: parseInt(id+'')\r\n                    }\r\n                    temporalNew[id] = addRowData;\r\n                    for(change in currentChanges) {\r\n                        delete renderValues[change];\r\n                    }\r\n                    var details = {}; \r\n                    details.idRow = parseInt(id+'');     \r\n                    details.isNew = true; \r\n                    details.changes = self.changes[id]; \r\n                    sortArray.push(details); \r\n                    if (!self.newRecords[id].createdOffline)                         \r\n                        internalRedersValues[internalRedersValues.length] = sortArray;                                            \r\n                } \r\n            }\r\n        }\r\n\r\n        // Get data\r\n        if (JSON.stringify(data.completeRows) !== JSON.stringify(data.originalRows) || internalRedersValues.length > 0) {\r\n            renderValues[properties.xpath] = renderValues[properties.xpath]? renderValues[properties.xpath]: {} \r\n            if (typeof (data.completeRows) !== \"undefined\" && data.completeRows.length > 0) {\r\n                renderValues[properties.xpath].rows = self.processOldRows(data.completeRows);\r\n            } else {\r\n                renderValues[properties.xpath].rows = internalRedersValues;\r\n            }\r\n            if(self[\"deleted-records\"] && Object.keys(self[\"deleted-records\"]).length > 0 )\r\n                renderValues[properties.xpath][\"deleted-records\"] = self[\"deleted-records\"];\r\n            if(temporalNew && Object.keys(temporalNew).length > 0)\r\n                renderValues[properties.xpath][\"new-records\"] = temporalNew;\r\n        }\r\n        \r\n\r\n    },\r\n\r\n    /*\r\n    *   Delete field id array objects\r\n    */\r\n    processOldRows: function (rows) {\r\n        var newRows = [];\r\n        var tempRows = rows;\r\n        var self = this;\r\n\r\n        for (var col = 0, leng = tempRows.length; col < leng; col++) {\r\n            var temp = tempRows[col];\r\n            newRows[col] = $.grep(temp, function (n, i) {\r\n                return i > 0;\r\n            });\r\n            var details = {}; \r\n            details.idRow = parseInt(temp[0]+'');     \r\n            details.isNew = self.newRecords[temp[0]]? true : false; \r\n            details.changes = self.changes[temp[0]] ? self.changes[temp[0]] : {}; \r\n            newRows[col].push(details); \r\n        }\r\n\r\n        return newRows;\r\n    },\r\n    /*\r\n    *   Delete field id array\r\n    */\r\n    processRow: function (row) {\r\n        return $.grep(row, function (n, i) {\r\n            return i > 0;\r\n        });\r\n    },\r\n\r\n    onPageRequested: function (ui) {\r\n        var self = this;\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n    },\r\n\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n\r\n        if (column.key) return value;\r\n\r\n        if (typeof (value) === \"object\" && value!==null && !isNewRow) {\r\n            value = value.hasOwnProperty(\"value\") ? value.value : value;\r\n        }\r\n\r\n        // Get render column                \r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n\r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n        if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = properties.editable ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key === \"summary\") editable = false;\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n        renderColumn.setValue(key, value);\r\n        renderColumn.setSurrogateKey(key);\r\n        renderColumn.properties.data = renderColumn.properties.data || [];\r\n\r\n        // Column search\r\n        if (renderColumn.properties.type === \"columnSearch\" && value != null) {\r\n            for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\r\n                if (renderColumn.properties.data[i].id == value) {\r\n                    value = {id: renderColumn.properties.data[i].id, label: renderColumn.properties.data[i].value};\r\n                }\r\n            }\r\n        }\r\n\r\n        if ((renderColumn.properties.type === \"columnCombo\" || renderColumn.properties.type === \"columnList\") && value != null) { //|| renderColumn.properties.type == \"columnRadio\"\r\n            for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\r\n                if (renderColumn.properties.data[i].id == value) {\r\n                    value = [[renderColumn.properties.data[i].id, renderColumn.properties.data[i].value]];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable) {\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            } else {\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Draws the editable version for the cell\r\n    */\r\n    drawEditableCell: function (renderColumn, properties, key, value, isNewRow) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = true;\r\n\r\n        // Fix problem when required property lose\r\n        renderColumn.overrideProperties({required: properties.required});\r\n\r\n        // Render cell\r\n        $.when(renderColumn.render(key, value)).done(function (cell) {\r\n            // Register array with new records, just when this is a new-record\r\n            if (isNewRow && !self.newRecords[key]) {\r\n                self.newRecords[key] = {};\r\n            }\r\n\r\n            // convert all row visible\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = (self.getCellOverride(key, j).visible != undefined) ? self.getCellOverride(key, j).visible : true;\r\n            }\r\n\r\n            // Add change handler  \r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function (render) {\r\n                self.onCellChange(renderColumn, cell, key);\r\n            });\r\n\r\n            // Resolve cell\r\n            defer.resolve(cell);\r\n        });\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (key === \"summary\") {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Defines the handler when a cell changes its value\r\n    */\r\n    onCellChange: function (renderColumn, cell, key) {\r\n\r\n        var self = this;\r\n        var _value = renderColumn.getValue(key);\r\n        var compositeValue = renderColumn.getCompositeValue(key);\r\n\r\n        if (renderColumn.properties.type === \"columnDate\" && renderColumn.data.properties.showTime == true) {\r\n\r\n            if (!bizagi.util.isEmpty(_value)) {\r\n                var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\r\n                _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n            } else if (_value === \"\") {\r\n                _value = \"\";\r\n            }\r\n        } else if (renderColumn.properties.type === \"columnDate\") {\r\n\r\n            if (!bizagi.util.isEmpty(_value)) {\r\n                var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\r\n                date.setHours(0, 0, 0, 0);\r\n                _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n            } else if (_value === \"\") {\r\n                _value = \"\";\r\n            }\r\n        }\r\n\r\n        if (self.properties.allowEdit || self.grid.bizagi_grid_smartphone(\"isNewRecord\", key)) {\r\n            var trigger = self.grid.bizagi_grid_smartphone(\"isNewRecord\", key) ? false : true;\r\n            self.collectGridChange({\r\n                id: key,\r\n                xpath: renderColumn.properties.xpath,\r\n                value: _value,\r\n                compositeValue: compositeValue,\r\n                columnIndex: renderColumn.columnIndex,\r\n                trigger: trigger\r\n            });\r\n        }\r\n\r\n        // Update change in grid's component data\r\n        self.grid.bizagi_grid_smartphone(\"changeCellValue\", key, renderColumn.columnIndex, _value);\r\n\r\n        // If the column has totalizers then we need to refresh the summary\r\n        if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n            self.grid.bizagi_grid_smartphone(\"refreshSummary\", renderColumn.columnIndex);\r\n        }\r\n    },\r\n    /*\r\n    *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n    */\r\n    collectGridChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n\r\n        if (trigger)\r\n            self.triggerRenderChange({key: id, column: xpath});\r\n    },\r\n\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    addRow: function () {\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = properties.data;\r\n        // Handle information stored offline based on data        \r\n        var newData = [];\r\n        var newRow = self.createAddRowData();\r\n        newData.push(newRow);\r\n\r\n        //Support for deletion and new rows\r\n        self.newRecords[newRow[0]] = { createdOffline: true };\r\n\r\n        data.rows = newData;\r\n        data.completeRows.push(newRow);\r\n        data.records++;\r\n        data.page = data.records;        \r\n        \r\n        self.updateData(data);\r\n        self.triggerRenderChange();\r\n    },\r\n\r\n    /**\r\n     * Creates a dummy data for the new row\r\n     * @returns {}\r\n     */\r\n    createAddRowData: function () {\r\n        var self = this;\r\n        \r\n        var row = [];\r\n        var key = Math.ceil(Math.random() * 100000);\r\n        row.push(key);\r\n        $.each(self.columns, function (i) {\r\n                row.push(null);            \r\n        });\r\n\r\n        return row;\r\n    },\r\n\r\n    /**\r\n     *  Edits a row in the grid\r\n     */\r\n    editRow: function (id) {\r\n    },\r\n\r\n    /**\r\n     *  Deletes a row to the grid\r\n     */\r\n    deleteRow: function (id) {\r\n        var self = this;\r\n\r\n        if (!id || id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).done(function () {\r\n            // Do a grid record deletion\r\n            $.when(self.submitDeleteRequest(id))\r\n                .done(function () {\r\n                    // Reload grid\r\n                    self.fetchData();\r\n                });\r\n        });\r\n    },\r\n\r\n    /**\r\n     *  Edits the entire row (inline) in another slide\r\n     */\r\n    editInline: function (id) {\r\n    },\r\n    /*\r\n    *   Retrieve the data for the new rows and push them into the server\r\n    */\r\n    saveInlineAddedRows: function (keys, bRefresh) {\r\n        var self = this;\r\n        var rows = self.processChanges();\r\n\r\n        if (!bizagi.util.isEmpty(rows)) {\r\n            self.properties.data.rows = $.merge(self.properties.data.rows, rows);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Removes invalid records \r\n    */\r\n    removeNewRecords: function (ui) {\r\n        var self = this;\r\n\r\n        if (ui && ui.keys) {\r\n            $.each(ui.keys, function (_, key) {\r\n                if (self.newRecords[key]) {\r\n                    delete self.newRecords[key];\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            var result = properties.overrideGetRemoteData(params);\r\n            return result != null ? result.promise() : null;\r\n        }\r\n\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n\r\n        \r\n        // Resolve with remote data\r\n        var data = properties.data;\r\n        // Handle information stored offline based on data\r\n        if (properties.data && properties.data.completeRows && properties.data.completeRows.length > 0) {\r\n            var newData = [];\r\n            newData.push(properties.data.completeRows[(properties.page-1)]);\r\n            properties.data.rows = newData;\r\n            properties.data.page = properties.page;\r\n        }\r\n        else if (properties.data.completeRows && properties.data.completeRows.length == 0 ) {\r\n            properties.data.rows = [];            \r\n        }                \r\n\r\n        // Check RTL\r\n        if (self.isRTL()) {\r\n            data.rows = self.changeOrderData(data.rows);\r\n        }\r\n\r\n        defer.resolve(data);\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Submits a grid delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = self.properties.data;\r\n        for (var i = 0, length = data.completeRows.length; i < length; i++) {\r\n            if (data.completeRows[i][0] == id) {\r\n\r\n                data.completeRows.splice(i, 1);\r\n                i--;\r\n\r\n                data.records--;\r\n                //Enters if it was created online\r\n                if(!self.newRecords[id])\r\n                {\r\n                    var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n                    var delInfo = {\r\n                        url: properties.deleteUrl,\r\n                        idRender: properties.id,\r\n                        xpath: xpath,\r\n                        xpathContext: properties.xpathContext,\r\n                        idPageCache: properties.idPageCache,\r\n                        contexttype: properties.contextType,\r\n                        prepare: true\r\n                    }\r\n                    self[\"deleted-records\"][id] = delInfo;\r\n                }else{\r\n                    delete self.newRecords[id];\r\n                    delete self.changes[id];\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        return (data.completeRows);\r\n    },\r\n\r\n    isValidGrid: function () {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof (form.validationController) !== \"undefined\")\r\n            form.validationController.clearValidationMessages();\r\n\r\n        //self.isValid(errorsMessage);\r\n\r\n        if (errorsMessage.length > 0) {\r\n            if (typeof (form.validationController) !== \"undefined\") {\r\n                for (var index = 0; index < errorsMessage.length; index++) {\r\n                    form.validationController.showValidationMessage(errorsMessage[index].message, errorsMessage[index].xpath);\r\n                }\r\n            }\r\n\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Smartphone Render Grouped Grid Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Grouped Grid render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from Grid Smartphone base\r\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid.grouped\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\r\n    },\r\n\r\n    isValidGrid: function (invalidElements) {\r\n        return this._super(invalidElements);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Smartphone Render Search Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the search render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.search\", bizagi.rendering.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.search.extend(\"bizagi.rendering.smartphone.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    CLEAR_SEARCH_ID: -3,\r\n    NO_RESULTS_SEARCH_ID: -4,\r\n    DEFAULT_SEARCH_ID: \"\",\r\n    SEARCH_MIN_LENGTH: 3,\r\n    SEARCH_DELAY: 250,\r\n    SEARCH_MAX_RECORDS: 50\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data submitData\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: this});\r\n        this.properties.submitOnChange = this.isOfflineForm ? false : this.properties.submitOnChange;\r\n\r\n        // Store reference of all ajax request in order to run only one instance of them\r\n        this.deferredReference = null;\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        var value = this.getDisplayValue();\r\n        var label = value.label || value.value;\r\n\r\n        if (typeof label != \"undefined\") {\r\n            if (typeof label == \"object\")\r\n                label = label.join(\" - \");\r\n        } else {\r\n            label = \"\";\r\n        }\r\n\r\n        if (typeof label == \"string\") {\r\n            if (value.additionallabel) {\r\n                label += \" - \" + value.additionallabel;\r\n            }\r\n\r\n            label = bizagi.util.sanitizeHTML(label);\r\n        }\r\n\r\n        return $.fasttmpl(template, {\r\n            value: label,\r\n            editable: this.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        this.searchInput = $(\".bz-input-icon\", this.getControl());\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.searchInput = $(\".bz-input-icon\", this.getControl());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Select new item\r\n        $(\".bz-input-icon\", control).on(\"click\", function () {\r\n            if (!self.properties.advancedSearch || self.isOfflineForm) {\r\n                self._simplySearchView();\r\n            } else {\r\n                self._advanceSearchView();\r\n            }\r\n        });\r\n\r\n        $(\".bz-icn--clear\", control).bind(\"click\", function (event) {\r\n            // Change display icon\r\n            $(\".bz-input-icon\", control).addClass(\"bz-input-icon--empty\");\r\n\r\n            // Call clean data\r\n            self.cleanData();\r\n\r\n            // Submit info to server\r\n            self.readyActionExecution().done(function () {\r\n                if (self.properties.submitOnChange) {\r\n                    self.submitData();\r\n                }\r\n            });\r\n\r\n            event.stopPropagation();\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new suggest control\r\n     * @param {} inputContainer\r\n     * @returns {}\r\n     */\r\n    configureModalViewHandlers: function (modalView) {\r\n        var self = this;\r\n\r\n        // Configuring list as a selectable element\r\n        self.modalViewList = $(\".bz-list\", modalView.content);\r\n\r\n        // Suggest\r\n        var suggestFilter = bizagi.util.debounce(function (value) {\r\n            self.autoCompleteSearchResults($.trim(value));\r\n        }, self.Class.SEARCH_DELAY);\r\n\r\n        $(\"[data-action=close]\", modalView.header).bind(\"click\", function () {\r\n            modalView.close();\r\n        });\r\n\r\n        var $clearButton = $(\".bz-modal-view__clear\", modalView.header);\r\n        var $searchInput = $(\".bz-modal-view__search\", modalView.header);\r\n\r\n        $clearButton.bind(\"click\", function () {\r\n            $searchInput.val(\"\").trigger(\"clean\");\r\n        });\r\n\r\n        // Setting the initial selected display value\r\n        $(\".bz-list\", modalView.content).on(\"click\", \"li\", function () {\r\n            var item = $.data(this).item;\r\n            if (!item || (item && item.id == self.Class.NO_RESULTS_SEARCH_ID))\r\n                return;\r\n\r\n            self.selectItem(item);\r\n            modalView.close();\r\n        });\r\n\r\n        // Filtering list\r\n        $searchInput.bind(\"clean keyup\", function () {\r\n            if (this.value == \"\") {\r\n                $clearButton.removeClass(\"bz-modal-view__clear--visible\");\r\n            } else {\r\n                $clearButton.addClass(\"bz-modal-view__clear--visible\");\r\n            }\r\n            suggestFilter(this.value);\r\n        }).on(\"focus\", function () {\r\n            modalView.header.addClass(\"bz-modal-view__header--active\");\r\n        }).on(\"blur\", function () {\r\n            modalView.header.removeClass(\"bz-modal-view__header--active\");\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * Opens the search slide\r\n     * @private\r\n     */\r\n    _advanceSearchView: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formSearchParams = $.extend({}, self.getParams(), {\r\n                navigation: self.getFormContainer().getNavigation()\r\n            }\r\n        );\r\n\r\n        var searchForm = new bizagi.rendering.smartphone.helpers.searchForm(\r\n            self.dataService, self.renderFactory,\r\n            properties.searchForms, {\r\n                allowFullSearch: properties.allowFullSearch,\r\n                maxRecords: properties.maxRecords,\r\n                allowNew: properties.allowNew || false,\r\n                orientation: properties.orientation || \"ltr\",\r\n                editable: properties.editable\r\n            },\r\n            formSearchParams\r\n        );\r\n\r\n        searchForm.renderEdition({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            displayName: properties.displayName,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (itemId) {\r\n            self.setValue({id: itemId});\r\n\r\n            //send the item selected\r\n            properties.submitOnChange = true;\r\n\r\n            self.submitData();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Simply search autocomplete\r\n     * @private\r\n     */\r\n    _simplySearchView: function () {\r\n        var self = this;\r\n        var content = self.getContentTemplate();\r\n\r\n        self.searchInput.mobileView({\r\n            customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {}),\r\n            orientation: self.properties.orientation || \"\",\r\n            contentTemplate: content,\r\n            transition: \"slideIn:up\",\r\n            close: function () {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            },\r\n            afterOpenAnimation: function (event) {\r\n                $(\".bz-modal-view__search\", event.view.header).focus();\r\n            },\r\n            open: function (event) {\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            configureActions: function (context) {\r\n                self.configureModalViewHandlers(context);\r\n            }\r\n        });\r\n    },\r\n\r\n    autoCompleteSearchResults: function (currentValue) {\r\n        var self = this;\r\n\r\n        $.when(self.processRequest({term: currentValue}))\r\n            .done(function (response) {\r\n\r\n                self.modalViewList.find(\"li\").remove();\r\n\r\n                for (var i = 0, length = response.length; i < length; i++) {\r\n                    var searchItem = self.renderSearchItem(response[i]);\r\n\r\n                    searchItem.appendTo(self.modalViewList);\r\n                }\r\n            });\r\n    },\r\n\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"search.item\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            id: item.id,\r\n            label: item.label,\r\n            value: item.value\r\n        });\r\n\r\n        searchItem.data(\"item\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    processRequest: function (req) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var deferred = new $.Deferred();\r\n\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if (self.properties.allowSuggest && (req.term.length >= self.properties.searchLength)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n\r\n            var getSuggestData = self.isOfflineForm ? self.getOfflineData() : self.getData();\r\n\r\n            // Cancel previous request in order to improve the performance\r\n            if (self.deferredReference && typeof (self.deferredReference.reject) === \"function\" && self.deferredReference.state() !== \"resolved\") {\r\n                self.deferredReference.reject({hideStatus: true});\r\n            }\r\n\r\n            self.deferredReference = getSuggestData.done(function (data) {\r\n                if (data && data.length > 0) {\r\n                    data = data.slice(0, properties.maxRecords);\r\n\r\n                    if (data.length > self.Class.SEARCH_MAX_RECORDS) {\r\n                        data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\r\n\r\n                        suggestions.push({\r\n                            id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                            label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                            value: \"\"\r\n                        });\r\n\r\n\r\n                    } else {\r\n                        data = data.slice(0, properties.maxRecords);\r\n                    }\r\n\r\n                    // Default value\r\n                    suggestions.push({\r\n                        id: self.Class.DEFAULT_SEARCH_ID,\r\n                        label: self.getResource(\"render-combo-empty-value\"),\r\n                        value: \"\"\r\n                    });\r\n\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords === 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n\r\n                            suggestions.push({id: val.id, label: parseValue, value: val.value});\r\n                        }\r\n                    });\r\n\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: \"\"\r\n                    });\r\n                }\r\n\r\n                deferred.resolve(suggestions);\r\n\r\n            }).fail(function () {\r\n                deferred.reject();\r\n            });\r\n\r\n        } else {\r\n            deferred.resolve(suggestions);\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Sets the value to show and calls the method to sets the control value\r\n     * @param {object} value\r\n     * @param {int} value.id\r\n     * @param {string} value.label\r\n     * @param {string=} value.additionallabel\r\n     * @example\r\n     *   value = {\r\n     *     id: 123,\r\n     *     label: \"xx\",\r\n     *     additionallabel: \"yyyy\"\r\n     *   }\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var label = \"\";\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (value !== null && typeof value !== \"undefined\" && typeof value.id !== \"undefined\") {\r\n            if (value.additionallabel && value.label) {\r\n                label = value.label + \" - \" + value.additionallabel;\r\n            } else if (value.label) {\r\n                label = value.label;\r\n            } else {\r\n                label = \"\";\r\n            }\r\n\r\n            var inputText = self.searchInput.find(\"input\");\r\n            inputText.val(label);\r\n            inputText.attr(\"id\", value.id);\r\n\r\n            if (value.id !== \"\" && self.properties.allowClear) {\r\n                $(\".bz-input-icon\", self.getControl()).removeClass(\"bz-input-icon--empty\");\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                self.setValue(value, true);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * on the smartphone only sends the id to submit in the smartphone it send the id and the value\r\n     * @returns {}\r\n     */\r\n    submitData: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[self.properties.xpath] = self.getValue();\r\n\r\n        // Executes submit on change\r\n        if (self.properties.submitOnChange && data[self.properties.xpath].id != undefined)\r\n            self.submitOnChange(data, true);\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * @returns {}\r\n     */\r\n    cleanData: function () {\r\n        var value = {id: \"\", value: \"\"};\r\n\r\n        if(bizagi.util.isEmpty(this.value)){\r\n            value ={};\r\n        }\r\n\r\n        this.setValue(value);\r\n        this.setDisplayValue(value);\r\n    },\r\n\r\n    getContentTemplate: function () {\r\n        var template = this.renderFactory.getTemplate(\"search.items\");\r\n        var content = $.fasttmpl(template, {});\r\n\r\n        return $.trim(content);\r\n    },\r\n\r\n    selectItem: function (item) {\r\n        var self = this;\r\n        var previousValue = self.hasValue();\r\n        var label = Array.isArray(item.value) ? item.value.join(\" - \") : item.value;\r\n\r\n        self.setDisplayValue({id: item.id, label: label});\r\n\r\n        if (self.properties.allowClear) {\r\n\r\n            if (item.id === self.Class.DEFAULT_SEARCH_ID) {\r\n                self.searchInput.find(\".gn-bz-search__clear\").addClass(\"gn-bz-search--hidden\");\r\n                self.searchInput.find(\".gn-bz-search__icon\").removeClass(\"gn-bz-search--hidden\");\r\n            } else {\r\n                if (!previousValue && item.id !== self.Class.DEFAULT_SEARCH_ID) {\r\n                    self.searchInput.find(\".gn-bz-search__clear\").removeClass(\"gn-bz-search--hidden\");\r\n                    self.searchInput.find(\".gn-bz-search__icon\").addClass(\"gn-bz-search--hidden\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get offline data for request\r\n     * @param request\r\n     */\r\n    getOfflineData: function () {\r\n        var self = this;\r\n        var dataList = self.properties.data || [];\r\n        var filter = (self.properties.term || \"\").toLowerCase();\r\n\r\n        return $.when(filter.startsWith(\"%%\") ? dataList : dataList.filter(function (item) {\r\n            var value = item && item.value ? item.value : \"\";\r\n            if (typeof (value) === \"object\") {\r\n                value = value.toString();\r\n            }\r\n            return value.toLowerCase().indexOf(filter) > -1;\r\n        }));\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Letter Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the letter render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.letter\", bizagi.rendering.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.label.extend(\"bizagi.rendering.smartphone.letter\", {}, {});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Button Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the button render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.button\", bizagi.rendering.button.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.button.extend(\"bizagi.rendering.smartphone.button\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        $(\":button\", self.getControl()).on(\"click\", function () {\r\n            self.processButton();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n\r\n            // Check if action need conformation\r\n            if (self.properties.needsUserConfirmation) {\r\n                $.when(bizagi.showConfirmationBox(self.properties.userConfirmationMessage, \"Bizagi\", \"warning\"))\r\n                    .done(function () {\r\n                        // Trigger change\r\n                        self.triggerRenderChange({pressed: true});\r\n                    });\r\n            } else {\r\n                if (!self.properties.preventDefault)\r\n                    self.runButtonAction();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange({pressed: true});\r\n            }\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return  $(\"button\", $context);         \r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render fileprint Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.fileprint\", bizagi.rendering.fileprint.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.fileprint.extend(\"bizagi.rendering.smartphone.fileprint\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this.getControl().parent().hide();\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi smartphone Render Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to smartphoe devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.link\", bizagi.rendering.link.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.link.extend(\"bizagi.rendering.smartphone.link\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.link = $control.find(\".bz-link\");\r\n\r\n        this._super();\r\n\r\n        this.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.link = $control.find(\".bz-link\");\r\n\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n\r\n        if (this.isValidValue()) {\r\n            // Get the decoded version of the URL\r\n            value = getFullyDecodedURI($.trim(value));\r\n\r\n            this.link.attr(\"href\", value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n\r\n        if (self.isValidValue()) {\r\n            self.link.on(\"click\", function (evt) {\r\n                evt.preventDefault();\r\n                evt.stopPropagation();\r\n\r\n                var linkEncode = encodeURI(this.getAttribute(\"href\"));\r\n\r\n                self.linkSolver(linkEncode, self.properties.linktarget);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     * TODO: Check if this validation is necessary\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    isValidValue: function () {\r\n        if (!this.hasValue()) return false;\r\n        var value = $.trim(this.getValue() || \"\");\r\n\r\n        return (value.toLowerCase().match(/^(http|https):\\/\\//) !== null) || false;\r\n    },\r\n\r\n    /**\r\n     * Executes the link\r\n     * @param {} linkEncode\r\n     * @param {} linkTarget\r\n     * @returns {}\r\n     */\r\n    linkSolver: function (linkEncode, linkTarget) {\r\n        if (linkTarget === \"newwindow\" || bizagi.util.isCordovaSupported()) {\r\n            window.open(linkEncode, \"_system\", \"location=yes\");\r\n        } else {\r\n            window.open(linkEncode, \"_system\");\r\n        }\r\n    },\r\n    \r\n    processLayout: function (isLabelFormat) {\r\n        if(!isLabelFormat){\r\n             this._super(isLabelFormat, this.properties.textFormat);\r\n        } else {\r\n            if(typeof this.properties.textFormat.background !== \"undefined\"){\r\n                this._super(isLabelFormat, { background: this.properties.textFormat.background });\r\n            }\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\".bz-link\", $context); \r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Image Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.image.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.image.extend(\"bizagi.rendering.smartphone.image\", {\r\n    QUALITY_PICTURE: 80,\r\n    EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"]\r\n}, {\r\n\r\n    /**\r\n     * DOM input to handle HTML uploads\r\n     * @var $inputFile jQuery DOM\r\n     */\r\n    $inputFile: null,\r\n\r\n    /**\r\n     * Whether or not is a native device 'Just a shortcut\r\n     * @var isNative boolean\r\n     */\r\n    isNative: false,\r\n\r\n    /**\r\n     * Whether or not we are offline 'Just a shortcut\r\n     * @var isOfflineForm boolean\r\n     */\r\n    isOfflineForm: false,\r\n    \r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: this});\r\n        this.isNative = bizagi.util.isCordovaSupported();\r\n\r\n        if (this.isOfflineForm) {\r\n            var maxFileSizeOfProperty = Number(this.properties.maxSize) || 1048576;\r\n            var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\r\n\r\n            this.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * This method tries to get the HTML template an render the current object inside\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"image\");\r\n\r\n        return $.fasttmpl(template, {url: \"\"});\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $({});\r\n    },\r\n\r\n    /**\r\n     * There is no difference when rendering a readonly image, so...\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = this.renderFactory.getTemplate(\"image-readonly\");\r\n        var def = new $.Deferred();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            var url = dataUrl || \"\";\r\n\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = url;\r\n                self.properties.value = url.length > 0 ? [url] : null;\r\n\r\n                self.setValue(self.properties.value);\r\n\r\n                var html = $.fasttmpl(template, {url: self.properties.url});\r\n                def.resolve(html);\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * After rendering element\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.$inputFile = $(\".bz-image__input\", $control);\r\n        this.$nativeFile = $(\".bz-image__native\", $control);\r\n\r\n        if (!this.isDesignMode())\r\n            this.showAsyncImage();       \r\n    },\r\n\r\n    /**\r\n     * Add action handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var $control = this.getControl();\r\n\r\n        // Attach all events\r\n        $control.on(\"click\", \"[data-action=upload]\", function (evt) {\r\n            self.choosePhoto();\r\n        });\r\n\r\n        if (this.isNative) {\r\n            // Upload Image Options\r\n            this.$nativeFile.off(\"click\").actionSheet({\r\n                actions: self.getUploadChoices(),\r\n                actionClicked: function (action) {\r\n                    switch (action.guid) {\r\n                        case 1:\r\n                            self.imageAdd();\r\n                            break;\r\n                        case 2:\r\n                            self.imageAdd(true);\r\n                            break;\r\n                        default:\r\n                    }\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n\r\n            $(\".bz-image__resolution\", $control).off(\"click\").actionSheet({\r\n                actions: bizagi.util.media.getImageResolutionSizes(),\r\n                withoutCancel: true,\r\n                actionClicked: function (action) {\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(self.resolutionButtonHandler(action.guid))\r\n                        .always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n        } else {\r\n\r\n            // Image change (Hybrid only)\r\n            this.$inputFile.off(\"change\").on(\"change\", function () {\r\n                self.imageAdd();\r\n                this.value = \"\";\r\n            });\r\n\r\n            // Just in case\r\n            this.$inputFile.off(\"click\").on(\"click\", function (evt) {\r\n                evt.stopPropagation();\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n        var $control = this.getControl();\r\n\r\n        $control.on(\"click\", \".bz-image\", function () {\r\n            self.imagePreview();\r\n        })\r\n    },\r\n\r\n    /**\r\n     * Add an image\r\n     * @param useCamera boolean Whether or not to use device's camera\r\n     */\r\n    imageAdd: function (useCamera) {\r\n        var self = this;\r\n\r\n        if (!this.isNative) {\r\n            var extensions = this.Class.EXTENSIONSIMG;\r\n            var dataFile = this.$inputFile[0].files[0];\r\n\r\n            dataFile.fullPath = this.$inputFile[0].value;\r\n\r\n            bizagi.loading.start();\r\n\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.performUploadFile(dataFile))\r\n                    .always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n        } else {\r\n\r\n            var options = {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                targetWidth: 1280,\r\n                targetHeight: 960,\r\n                correctOrientation: true\r\n            };\r\n\r\n            if (!useCamera) {\r\n                var coordinates = self.getControl()[0].getBoundingClientRect();\r\n\r\n                options = {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    popoverOptions: new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4),\r\n                    destinationType: navigator.camera.DestinationType.FILE_URI,\r\n                    correctOrientation: true\r\n                };\r\n            }\r\n\r\n            navigator.camera.getPicture(function (dataImage) {\r\n\r\n                bizagi.loading.start();\r\n\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\r\n                    return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                        if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\r\n\r\n                            self.dataImage = dataImage;\r\n                            self.fileProperties = fileData;\r\n\r\n                            // \"new Blob\" constructor is not supported in android version 4.2.2\r\n                            var version = bizagi.util.getAndroidVersion();\r\n                            if ((version && version <= 4.2) || self.isOfflineForm) {\r\n\r\n                                return $.when(self.performUploadFile(self.dataImage))\r\n                                    .always(function () {\r\n                                        bizagi.loading.stop();\r\n                                    });\r\n\r\n                            } else {\r\n\r\n                                if (!bizagi.util.isAndroid()) {\r\n                                    return $.when(bizagi.util.media.modalResolutionUpload())\r\n                                        .then(function (buttonIndex) {\r\n                                            if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                return self.resolutionButtonHandler(buttonIndex);\r\n                                            }\r\n                                        });\r\n\r\n                                } else {\r\n                                    // Force click to show actionsheet menu\r\n                                    $(\".bz-image__resolution\", self.getControl()).click();\r\n                                }\r\n\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, options);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * onFail\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    onFail: function (error) {\r\n        bizagi.loading.stop();\r\n    },\r\n\r\n    /**\r\n     * Remove the current image\r\n     */\r\n    imageDelete: function () {\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(self.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n                bizagi.loading.start();\r\n\r\n                $.when(self.dataService.deleteImage({\r\n                    url: self.properties.deleteUrl,\r\n                    idRender: self.properties.id,\r\n                    xpath: self.properties.xpath,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: self.properties.idPageCache,\r\n                    contexttype: self.properties.contexttype\r\n                })).done(function () {\r\n                    self.uploadFileCompleted();\r\n                }).fail(function (msg) {\r\n                    var message;\r\n                    var responseText = msg.responseText;\r\n\r\n                    try {\r\n                        message = JSON.parse(responseText);\r\n                        message = message.message || responseText;\r\n                    } catch (e) {\r\n                        message = responseText;\r\n                    }\r\n\r\n                    self.setValidationMessage(message);\r\n\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function (dataFile) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (!this.isOfflineForm) {\r\n            if (this.isNative) {\r\n\r\n                var params = {};\r\n                var addParams = self.buildAddParams();\r\n                var fileName = self.fileProperties.name;\r\n\r\n                if (self.editedImageURL) {\r\n                    params.dataFile = self.editedImageURL;\r\n                } else if (self.fileProperties) {\r\n                    params.dataFile = self.fileProperties.url;\r\n                }\r\n\r\n                addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n                params.data = addParams;\r\n                params.options = new FileUploadOptions();\r\n                params.options.fileKey = \"file\";\r\n                params.options.fileName = fileName;\r\n                params.options.mimeType = \"image/jpeg\";\r\n                params.options.uploadKey = {key: addParams[\"h_xpath\"]};\r\n                params.options.addUrl = self.properties.addUrl;\r\n\r\n                //Cleans variables related previous uploads\r\n                self.editedImageURL = null;\r\n                self.fileProperties = null;\r\n\r\n                // Fix android 4.4 getting images from recent folder\r\n                params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n                $.when(bizagi.util.media.uploadFile(params)).done(function (response) {\r\n                    var response = JSON.parse(decodeURIComponent(response.response));\r\n\r\n                    if (response.type === \"error\") {\r\n                        defer.reject(response);\r\n                    } else {\r\n                        defer.resolve(response);\r\n                    }\r\n                }).fail(function (error) {\r\n                    defer.reject(error);\r\n                });\r\n            } else {\r\n\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, self.Class.EXTENSIONSIMG)) {\r\n\r\n                    self.dataService.processUploadFile({\r\n                        url: self.properties.addUrl,\r\n                        formData: self.buildAddFileParams(dataFile)\r\n                    }).done(function (response) {\r\n                        defer.resolve(response);\r\n                    }).fail(function (error) {\r\n                        defer.reject(error);\r\n                    });\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n            }\r\n        } else {\r\n            // Save the image\r\n            self.saveImageOffline(dataFile, defer);\r\n\r\n            // Enables canbesent on offline mode\r\n            // In order to evaluate the xpath in synchronization phase\r\n            // The value collected always will be \"\"\r\n            self.canBeSent = function () {\r\n                $.forceCollectData = true;\r\n                return true;\r\n            };\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * File upload is done\r\n     * @param context\r\n     */\r\n    uploadFileCompleted: function () {\r\n        try {\r\n            this.showAsyncImage();\r\n            this.editedImageURL = null;\r\n        } catch (error) {\r\n            // TODO: Review scenario\r\n            this.getFormContainer().refreshForm();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show async image\r\n     * */\r\n    showAsyncImage: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var $wrapper = $(\".bz-input-icon\", $control);\r\n\r\n        $.when(self.renderUploadItem()).done(function (htmlImage) {\r\n            if (!self.isDisposed()) {\r\n\r\n                // Empty container and add new image\r\n                $wrapper.empty();\r\n                $wrapper.append(htmlImage);\r\n\r\n                var action = self.hasValue() ? \"update\" : \"upload\";\r\n\r\n                $wrapper.attr(\"data-action\", action);\r\n                self.setValue(self.properties.value);\r\n\r\n                // Attack events to overflow-menu\r\n                if (self.hasValue()) {\r\n                    self.configureMenu();\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * resolutionButtonHandler\r\n     * @param ordinal\r\n     */\r\n    resolutionButtonHandler: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return self.performUploadFile(self.dataImage);\r\n        } else {\r\n\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).then(function (result) {\r\n\r\n                self.editedImageURL = result.localUrl;\r\n                self.properties.url = result.base64Image;\r\n\r\n                return self.performUploadFile(self.dataImage);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Render edition view\r\n     * @returns {}\r\n     */\r\n    imagePreview: function () {\r\n        var self = this;\r\n        var baseParams = self.getParams();\r\n        var container = baseParams.navigation.createRenderContainer({\r\n            title: self.properties.displayName,\r\n            view: {\r\n                zoom: true,\r\n                useNativeScrolling: false\r\n            }\r\n        });\r\n\r\n        var template = self.renderFactory.getTemplate(\"image-preview\");\r\n        var imageData = {\"url\": self.value && self.value[0] !== \"\" ? self.value[0] : \"\"};\r\n        var img = $.fasttmpl(template, imageData);\r\n\r\n        container.element.css(\"display\", \"none\");\r\n        self.inputEdition = container.element.html(img);\r\n        baseParams.navigation.navigate(container.id);\r\n\r\n        if (self.isOfflineForm) {\r\n            container.element.on(\"close\", self.onPreviewActionBack.bind(self));\r\n        }\r\n\r\n        bizagi.loading.start();\r\n\r\n        // TODO: Review fail scenario, should it call the forms.failHandler method?\r\n        $.when(self.buildFullItemUrl()).done(function (dataUrl) {\r\n            container.element.css(\"display\", \"block\");\r\n\r\n            if (dataUrl.indexOf(\"error\") < 0) {\r\n                var $preview = $(\".bz-image__preview-item:first\", container.element).attr(\"src\", dataUrl);\r\n                var originalImageWidth = $preview.css(\"width\");\r\n\r\n                originalImageWidth = Number(originalImageWidth.substring(0, originalImageWidth.length - 2));\r\n\r\n                if (self.properties.width !== -1 && self.properties.width < originalImageWidth) {\r\n                    $preview.css(\"width\", \"100%\");\r\n                }\r\n            }\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(prefix + \"xpath\", properties.xpath);\r\n        formData.append(prefix + \"idRender\", properties.id);\r\n        formData.append(prefix + \"xpathContext\", properties.xpathContext);\r\n        formData.append(prefix + self.Class.BA_PAGE_CACHE, properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(prefix + \"action\", \"savefile\");\r\n        formData.append(self.properties.xpath, dataFile);\r\n\r\n        if (properties.contexttype) {\r\n            formData.append(prefix + \"contexttype\", properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\r\n\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * Execute upload file\r\n     * @param {} context\r\n     * @param {} dataImage\r\n     * @returns {}\r\n     */\r\n    performUploadFile: function (dataImage) {\r\n        var self = this;\r\n\r\n        return $.when(self.uploadFile(dataImage))\r\n            .done(function (result) {\r\n                self.uploadFileCompleted();\r\n            }).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Choose photo\r\n     */\r\n    choosePhoto: function () {\r\n        if (this.isNative) {\r\n            this.$nativeFile.click();\r\n        } else if (bizagi.util.media.fileAPISupported() && !self.isOfflineForm) {\r\n            this.$inputFile.click();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process an action in order to do something with the image\r\n     */\r\n    configureMenu: function () {\r\n        var self = this;\r\n        var items = [];\r\n        var $control = this.getControl();\r\n        var $viewMore = $(\".bz-input-icon__input + .bz-icn\", $control);\r\n        var allowDelete = self.isOfflineForm ? false : self.properties.allowDelete && self.properties.editable;\r\n\r\n        items.push({\r\n            name: bizagi.localization.getResource(\"workportal-actionsheet-upload-image-preview\"),\r\n            fn: function () {\r\n                self.imagePreview();\r\n            }\r\n        });\r\n\r\n        items.push({\r\n            name: bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\"),\r\n            fn: function () {\r\n                self.choosePhoto();\r\n            }\r\n        });\r\n\r\n        if (allowDelete) {\r\n            items.push({\r\n                name: bizagi.localization.getResource(\"workportal-actionsheet-upload-remove-photo\"),\r\n                fn: function () {\r\n                    self.imageDelete();\r\n                }\r\n            });\r\n        }\r\n\r\n        $viewMore.overflowMenu({items: items});\r\n    },\r\n\r\n    /**\r\n     * Add upload options\r\n     */\r\n    getUploadChoices: function () {\r\n        return [\r\n            {\"guid\": 1, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\")},\r\n            {\"guid\": 2, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\")}\r\n        ];\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (params) {\r\n        if (this.isOfflineForm) {\r\n            return this.buildItemUrlOffline(params);\r\n        } else {\r\n            return this._super(params);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Refresh data\r\n     * @param {} event\r\n     */\r\n    onPreviewActionBack: function (event) {\r\n        var self = this;\r\n        var dataUrl = $(\".bz-image__preview-item\", event.target).attr(\"src\") || \"\";\r\n\r\n        var dataUrlToSave = dataUrl.length > 0 ? [].concat(dataUrl) : null;\r\n        self.setValue(dataUrlToSave);\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        if(self.isOfflineForm && self.controlValueIsChanged()){\r\n            var xpath = self.properties.xpath;\r\n            var value = self.getValue();\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                //Only form mark the xpath as edited in the db\r\n                //The value is taked from attachments\r\n                renderValues[xpath] = \"*\";\r\n            }\r\n        }\r\n        else{\r\n            $._super(renderValues);\r\n        }\r\n    },\r\n\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Smartphone Render Form Link Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.formLink\", {\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, bizagi.rendering.formLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.formLink.extend(\"bizagi.rendering.smartphone.formLink\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self._super(data);\r\n\r\n        var properties = self.properties;\r\n\r\n        self.originalElement = self.element;\r\n        properties.orgiginalDisplayType = properties.displayType;\r\n        properties.displayType = \"normal\";\r\n\r\n        self._sendRelation = self.submitEditRequest;\r\n        self._getData = self.dataService.getFormData;\r\n        self._isRefreshForm = false;\r\n    },\r\n\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        params.context = params.context || \"workflow\";\r\n\r\n        var paramsRender = $.extend({}, this._params, {\r\n            \"proxyPrefix\": this.dataService.serviceLocator.proxyPrefix,\r\n            \"context\": this.dataService.serviceLocator.context\r\n        });\r\n\r\n        this.serviceLocator = new bizagi.render.services.context(paramsRender);\r\n    },\r\n\r\n    /**\r\n     * Para la grilla lo que se debe hacer es sobreescribir o crear los metodos params, sendrelation,getData\r\n     * @returns {*}\r\n     */\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._params = {\r\n            idRender: properties.id,\r\n            xpathContext: self.getFormLinkXpathContext(),\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            url: properties.editPage\r\n        };\r\n\r\n        self.container = self.getParams().navigation.createRenderContainer({title: properties.displayName});\r\n        self.inputEdition = self.container.element;\r\n\r\n        if (self.properties.hasentryrule) {\r\n            var form = self.getFormContainer();\r\n\r\n            $.when(form.saveForm()).done(function () {\r\n                self.resolveCheckpointRequest().done(function () {\r\n                    return self.openLinkRule(\"entryrule\");\r\n                }).fail(function (error) {\r\n                    bizagi.log(\"Error: \" + err.code);\r\n                });\r\n            });\r\n        } else {\r\n            return self.openLink();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Open link display from inside a dialog\r\n     */\r\n    openLink: function () {\r\n        var self = this;\r\n\r\n        return $.when(self._sendRelation.apply(self)).done(function () {\r\n            bizagi.loading.start();\r\n\r\n            $.when(self.paintFormLink()).done(function () {\r\n                bizagi.loading.stop();\r\n            }).fail(function () {\r\n                //Executes Rollback action\r\n                bizagi.loading.start();\r\n                self.rollbackForm();\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    openLinkRule: function (property) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        bizagi.loading.start();\r\n\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n                if (dataRuleResp.messages) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n\r\n                    form.validationController.showErrorMessage(message);\r\n                    def.reject();\r\n                } else {\r\n                    if (property === \"entryrule\") {\r\n                        self.openLink();\r\n                    }\r\n                }\r\n                def.resolve();\r\n            }).fail(function () {\r\n            def.reject();\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type === \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                var form = self.getFormContainer();\r\n\r\n                form.validationController.showErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            // Add error messages\r\n            var form = self.getFormContainer();\r\n\r\n            form.validationController.showErrorMessage(jqXHR.message);\r\n\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    paintFormLink: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        $.extend(self._params, {\"proxyPrefix\": self.serviceLocator.proxyPrefix});\r\n\r\n        $.when(self._getData.call(self, self._params)).pipe(function (data) {\r\n            if (self._params.recordXPath) {\r\n                data.form.properties.recordXpath = self._params.recordXPath;\r\n            }\r\n\r\n            if (self._params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Grid\r\n            if (self._params.hasOwnProperty(\"withAddForm\") && self._params.withAddForm) {\r\n                if (!data.form.elements || (data.form.elements && data.form.elements.length === 0)) {\r\n                    self._params.hideSaveButton = true;\r\n                }\r\n            }\r\n\r\n            /**\r\n             * This creation of form on every action like refresh or save\r\n             * is driving nuts the listeners in native apps\r\n             */\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.getParams().navigation,\r\n                wiew_container: self.container\r\n            });\r\n\r\n            self.form.params = self.getFormContainer().getParams();\r\n\r\n            self.form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                        // This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            // When the data is saved then\r\n                            return self.saveRecord().then(function () {\r\n                                self.container.destroy();\r\n                            }).fail(function (error) {\r\n                                if (error && error.error_code && error.error_code == 1) {\r\n                                    //if doesn't support commit, rollback, etc.\r\n                                    $.when(self.actionSave(error.data)).then(function () {\r\n                                        self.container.destroy();\r\n                                    });\r\n                                } else if (error && error.type == \"validationMessages\") {\r\n                                    self.form.addValidationMessage(error.messages);\r\n                                } else if (error && error.responseText) {\r\n                                    bizagi.showMessageBox(error.responseText || \"Error\", \"Error\");\r\n                                }\r\n                            });\r\n                        }\r\n                    }),\r\n                $.extend(\r\n                    self.form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            self.container.destroy();\r\n                            deferred.reject();\r\n                        }\r\n                    })\r\n            ];\r\n\r\n            $.extend(self.form, {\r\n                processButtons: function () {\r\n                    //not send information set in memory and save\r\n                    $.each(self.form.buttons, function (index, element) {\r\n                        switch (element[\"ordinal\"]) {\r\n                            case 1: //next button will behave as a cancel button\r\n                                $(self.form.getButtons()[index]).click(function () {\r\n                                    self.container.destroy();\r\n                                    deferred.reject();\r\n                                });\r\n\r\n                                self.form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n\r\n                                self.form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                self.form.buttons[index].action = \"back\";\r\n                                break;\r\n\r\n                            default:\r\n                                $(self.form.getButtons()[index]).click(function () {\r\n                                    if (self._params.hideSaveButton) {\r\n                                        $(self.form.getButtons()[index]).hide();\r\n                                    }\r\n\r\n                                    return self.saveRecord().then(function () {\r\n                                        self.container.destroy();\r\n                                    }).fail(function (error) {\r\n                                        if (error && error.error_code && error.error_code == 1) {\r\n                                            //if doesn't support commit, rollback, etc.\r\n                                            $.when(self.actionSave(error.data)).then(function () {\r\n                                                self.container.destroy();\r\n                                            });\r\n                                        } else {\r\n                                            bizagi.showMessageBox(error.responseText || \"Error\", \"Error\");\r\n                                        }\r\n                                    });\r\n                                });\r\n                                break;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            return self.form.render();\r\n\r\n        }, function (message) {\r\n            // FAIL FILTER\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            $.tmpl(errorTemplate, {message: message}).appendTo(self.inputEdition);\r\n\r\n            deferred.reject();\r\n        }).done(function (element) {\r\n            // Remove button container\r\n\r\n            self.inputEdition.html(element);\r\n            if (!self._isRefreshForm) {\r\n                self.getParams().navigation.navigate(self.container.id);\r\n            }\r\n\r\n            self.container.setNavigationButtons(self.form);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function () {\r\n                //TODO the parent who call this class implement redraw. see smartphone.grid _InternalRenderLinkForm\r\n                self.inputEdition.empty();\r\n                self._isRefreshForm = true;\r\n\r\n                //Adds the events to capture the\r\n                $.when(self.paintFormLink()).done(function () {\r\n                })\r\n                    .fail(function () {\r\n                        self.submitRollbackRequest();\r\n                    });\r\n            });\r\n\r\n            // Binds the view close event, and send the RollBack\r\n            self.container.element.bind(\"close\", function () {\r\n                self.rollbackForm();\r\n            });\r\n\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    rollbackForm: function () {\r\n        var self = this;\r\n        var form = self.form || self.getFormContainer();\r\n\r\n        $.when(self.submitRollbackRequest({idPageCache: form.idPageCache})).done(function () {\r\n            // Sends additional rollback request to delete checkpoint from entry rule\r\n            if (self.properties.hasentryrule) {\r\n                self.submitRollbackRequest({idPageCache: form.idPageCache});\r\n            }\r\n        });\r\n    },\r\n\r\n    saveRecord: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n        var properties = self.properties;\r\n\r\n        if (self.form.validateForm()) {\r\n            var data = {};\r\n            self.form.collectRenderValues(data);\r\n            // Add page cache for this form\r\n            data.idPageCache = self.form.getPageCache();\r\n\r\n            $.when(self.submitSaveRequest(data)).done(function (result) {\r\n                try {\r\n                    var executeSubmitOnChange = true;\r\n                    if (result && result.type === \"validationMessages\") {\r\n                        executeSubmitOnChange = false;\r\n                        deferred.reject(result);\r\n                    }\r\n                    if (properties.hasexitrule) {\r\n                        self.closeExitRule().done(function () {\r\n                            if (executeSubmitOnChange) {\r\n                                self.resolveSubmitCommitRequest().then(function () {\r\n                                    self.submitOnChange({}).then(function () {\r\n                                        deferred.resolve(result);\r\n                                        if (properties.hasentryrule) {\r\n                                            self.resolveSubmitCommitRequest();\r\n                                        }\r\n                                    });\r\n                                });\r\n                            } else {\r\n                                deferred.reject();\r\n                            }\r\n                        }).fail(function () {\r\n                            deferred.reject();\r\n                        });\r\n                    } else if (executeSubmitOnChange) {\r\n                        self.resolveSubmitCommitRequest().then(function () {\r\n                            if (properties.hasentryrule) {\r\n                                self.resolveSubmitCommitRequest().done(function () {\r\n                                    self.submitOnChange({}).then(function () {\r\n                                        deferred.resolve(result);\r\n                                    });\r\n                                });\r\n                            } else {\r\n                                self.submitOnChange({}).then(function () {\r\n                                    deferred.resolve(result);\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        deferred.reject();\r\n                    }\r\n                } catch (ex) {\r\n                    deferred.reject();\r\n                }\r\n            }).fail(function (error) {\r\n                var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n\r\n                if (err.code === \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1\r\n                    && err.message.indexOf(\"was not found\") !== -1) {\r\n                    deferred.reject({error_code: 1, data: data});\r\n                } else {\r\n                    deferred.reject(error);\r\n                }\r\n            });\r\n        } else {\r\n            deferred.reject();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (properties.editable === false && !properties.value) {\r\n            return null;\r\n        }\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (properties.xpathContext !== undefined && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        // SaveGridRecord\r\n        return self.dataService.saveGridRecord({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    resolveSubmitCommitRequest: function () {\r\n        var def = new $.Deferred();\r\n\r\n        this.submitCommitRequest().done(function () {\r\n            def.resolve();\r\n        }).fail(function (error) {\r\n            var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n            if (err.code === \"UNKNOWN_ERROR\") {\r\n                def.resolve();\r\n            } else {\r\n                def.reject();\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    resolveCheckpointRequest: function () {\r\n        var def = new $.Deferred();\r\n\r\n        this.submitCheckpointRequest().done(function () {\r\n            def.resolve();\r\n        }).fail(function (error) {\r\n            var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n\r\n            if (err.code === \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1\r\n                && err.message.indexOf(\"was not found\") !== -1) {\r\n                def.resolve();\r\n            } else {\r\n                def.reject();\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    closeExitRule: function () {\r\n        var def = new $.Deferred();\r\n\r\n        if (this.properties.hasexitrule) {\r\n            $.when(this.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function () {\r\n                def.reject();\r\n            });\r\n        } else {\r\n            def.resolve();\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var xpathContext = this.properties.xpathContext;\r\n        var parentXpathContext = this.getXpathContext();\r\n\r\n        if (parentXpathContext && xpathContext) {\r\n            return xpathContext.indexOf(parentXpathContext) === 0 ? xpathContext : parentXpathContext + \".\" + xpathContext;\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        $(\"[data-action=open]\", $control).on(\"click\", function () {\r\n            bizagi.loading.start();\r\n\r\n            $.when(self.renderEdition()).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    processLayout: function (isLabelFormat) {\r\n        if (!isLabelFormat) {\r\n            this._super(isLabelFormat, this.properties.textFormat);\r\n        } else {\r\n            if (typeof this.properties.textFormat.background !== \"undefined\") {\r\n                this._super(isLabelFormat, {background: this.properties.textFormat.background});\r\n            }\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return $(\".bz-link\", $context);\r\n    }\r\n});","/**\r\n *   Name: Bizagi Smartphone Render Geolocation Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the geolocation render class to adjust to Smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.geolocation\", bizagi.rendering.geolocation.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.geolocation.extend(\"bizagi.rendering.smartphone.geolocation\", {\r\n    ALLOW_UPDATE: \"update\"\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.coordinate = $control.find(\"input\");\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n\r\n        return $.fasttmpl(template, {value: this.getDisplayValue()});\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.coordinate = $control.find(\"input\");\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // If the control doesn't have a value set the position\r\n        if (self.value == null) {\r\n            self.updateDisplayValue();\r\n        }\r\n\r\n        $control.on(\"click\", \"[data-action=\" + self.Class.ALLOW_UPDATE + \"]\", self.processAction.bind(self));\r\n\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            if (self.coordinate)\r\n                self.coordinate.val(self.performPrecision(value));\r\n\r\n            // Set internal value \r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n            var onSuccess = function (position) {\r\n                var coordinates = position.coords.latitude + \" \" + position.coords.longitude;\r\n\r\n                self.coordinate.val(self.performPrecision(coordinates));\r\n\r\n                // Set internal value \r\n                self.setValue(coordinates, false);\r\n                def.resolve();\r\n            };\r\n\r\n            var onFail = function (message) {\r\n                def.reject(message);\r\n            };\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                navigator.geolocation.getCurrentPosition(onSuccess, onFail);\r\n            } else {\r\n                self.getCurrentPosition(onSuccess, onFail);\r\n            }\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    updateDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.setDisplayValue().then(function () {\r\n            self.setValidationMessage(\"\");\r\n        }).fail(function (message) {\r\n            self.coordinate.val(\"\");\r\n            self.setValidationMessage(message);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Process an action in order to do something with the geolocation\r\n     */\r\n    processAction: function () {\r\n        this.coordinate.empty();\r\n        this.updateDisplayValue();\r\n    },\r\n\r\n    \r\n    getElementsToStylize: function($context){\r\n        return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context); \r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi smartphone Render Association\r\n*   Author: UI Forms Team\r\n*   Comments: Defines the association control\r\n*/\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.association\", bizagi.rendering.association.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.association.extend(\"bizagi.rendering.smartphone.association\", {}, {\r\n\r\n   /**\r\n     * Template method to implement in each children to customize each control\r\n     * \r\n     * @returns {} \r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation()).done(function (flip) {\r\n            // Make json base, create self.properties.formatJson\r\n            self.makeJsonBase();\r\n\r\n            self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n            var columnData = self.getColumnData();\r\n\r\n            var html = $.fasttmpl(template, $.extend(self.properties, { columnData: columnData }), {\r\n                getColumnData: self.getColumnData,\r\n                getRightAssociation: self.getRightAssociation\r\n            });\r\n\r\n            /* by default need set self.properties.formatJson */\r\n            self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n            def.resolve(html);\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /**\r\n     * Get Left Data, verify if flipper flags sets true\r\n     *\r\n     * @param column {'0'||'1'}\r\n     */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = [];\r\n\r\n        self.data = properties;\r\n\r\n        var dataAssociation = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(dataAssociation, function (key, item) {\r\n            data.push({\r\n                id: item.id,\r\n                value: item.value,\r\n                association: self.getRightAssociation(item.id)\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var isExecution = self.getMode() === \"execution\";\r\n        var $control = self.getControl();\r\n\r\n        // Cache control\r\n        self.association = $(\".bz-association\", $control);\r\n       \r\n        // Add Events at Association Control\r\n        if (isExecution) {self.addEventControl(); }\r\n               \r\n        self.showDefaultGroupList();\r\n    },\r\n\r\n    showDefaultGroupList: function(){\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var $groups = $('.bz-association-group', $control);\r\n\r\n        if($groups.length > 0){\r\n            $(\"[data-action='collapse']\", $groups[0]).toggleClass(\"bz-icn--expanded\")\r\n\r\n            $(\".bz-association-group__list\", $groups[0])\r\n                .slideDown(300, function(){                                               \r\n                    $(this).toggleClass(\"bz-association-group__list--hidden\")\r\n                });           \r\n        }\r\n    },\r\n\r\n    /**\r\n     * Add event to control\r\n     * @returns {} \r\n     */\r\n    addEventControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Bind check toggle\r\n        self.association\r\n            .on(\"change\", \"input:checkbox\", function () {\r\n                var $input = $(this);\r\n                var parentId = $input.data(\"parent-id\");\r\n                var id = $input.data(\"id\");\r\n\r\n                if ($input.prop(\"checked\")) { self.addElement(parentId, id);} \r\n                else { self.removeElement(parentId, id);}\r\n            });\r\n\r\n        // Bind flip actions\r\n        self.association\r\n            .find(\"[data-action='flip']\")\r\n            .click(function () {\r\n                $(control).empty();\r\n\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                // Send flip data to server\r\n                self.properties.flipstate = self.properties.flipped;\r\n\r\n                self.dataService.getFlipAssociation(self.properties);\r\n\r\n                var columnData = self.getColumnData();\r\n\r\n                // Render template\r\n                $($.fasttmpl(template, $.extend(self.properties, { columnData: columnData }), {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                })).appendTo(control);\r\n\r\n                self.postRender();\r\n            });\r\n\r\n        //header\r\n        self.association.on(\"click\",  \"[data-action='collapse']\", function(){\r\n            var $element = $(this); \r\n            var $groupList = \r\n                $element\r\n                    .parents('.bz-association-group')\r\n                    .find(\".bz-association-group__list\");\r\n                            \r\n            self.closeAccordionSection();\r\n            if ($groupList.hasClass(\"bz-association-group__list--hidden\")) {\r\n\r\n                $element.toggleClass(\"bz-icn--expanded\");\r\n\r\n                $groupList.slideDown(300, function(){                    \r\n                    $(this).toggleClass(\"bz-association-group__list--hidden\");\r\n                });        \r\n            }                                               \r\n        });\r\n    },\r\n\r\n    closeAccordionSection: function(active){\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        $(\"[data-action='collapse']\", $control).removeClass('bz-icn--expanded'); \r\n\r\n        $(\".bz-association-group__list\", $control)\r\n            .slideUp(300, function(){\r\n                $(this).addClass(\"bz-association-group__list--hidden\");    \r\n            });\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        return self.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Render for readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.postRender();       \r\n    },\r\n\r\n    /* SET-DISPLAY-VALUE\r\n     =====================================================*/\r\n    setDisplayValue: function (value) {        \r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    getLabel: function () {\r\n        if (!this.label) {\r\n            var label = $(\"> .bz-form-label\", this.element || this.observableElement);\r\n\r\n            if (label.length > 0)\r\n                this.label = label;\r\n\r\n            return label;\r\n        }\r\n        return this.label;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Smartphone Render Search List Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the search-list render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.searchList\", bizagi.rendering.searchList.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.searchList.extend(\"bizagi.rendering.smartphone.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2,\r\n    SEARCH_MAX_RECORDS: 50,\r\n    SEARCH_DELAY: 250,\r\n    SEARCH_ELEMENTS: {}\r\n}, {\r\n\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            value: properties.value.map(function(el){\r\n                return self.formatItem(el.value);\r\n            }).join(\", \")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        this.searchListInput = $(\".bz-search-list__input\", this.getControl());\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.searchListInput = $(\".bz-search-list__input\", this.getControl());\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"searchList.readonly\");\r\n\r\n        // Render template\r\n        var content = $.fasttmpl(template, {\r\n            items: self.properties.value || {},\r\n            editable: self.properties.editable || true\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n\r\n        return content;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Select new item\r\n        self.searchListInput.on(\"click\", function (evt) {\r\n            var parent = $(evt.target).parent() || {};\r\n            if (parent.hasClass('bz-pill')) return;\r\n\r\n            self._searchListViewModal();\r\n        });\r\n    },\r\n\r\n    _searchListViewModal: function () {\r\n        var self = this;\r\n        var header = self.getHeaderTemplate();\r\n        var content = self.getContentTemplate();\r\n        var footer = self.getFooterTemplate();\r\n\r\n        self.searchListInput.mobileView({\r\n            customHeader: header,\r\n            orientation: self.properties.orientation || \"\",\r\n            cssClassHeader: \"bz-modal-view__header-multiple\",\r\n            contentTemplate: content,\r\n            footerTemplate: footer,\r\n            transition: \"slideIn:up\",\r\n            close: function () {\r\n                $(window).unbind(\"resize\");\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            },\r\n            afterOpenAnimation: function(event){\r\n                $(\".bz-modal-view__search\", event.view.header).focus();\r\n            },\r\n            open: function () {\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            configureActions: function (context) {\r\n                self.adjustResize();\r\n                self.configureModalViewHandlers(context);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        // Set internal value\r\n        self.setValue(finalValue);\r\n\r\n        if (value !== undefined) {\r\n            if (self.properties.editable) {\r\n                self.searchListInput.html(finalValue.map(function(el){\r\n                    return self.formatItem(el.value);\r\n                }).join(\", \"));\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Remove a item from the list\r\n     * @param {} element\r\n     * @returns {}\r\n     */\r\n    deleteItem: function (element) {\r\n        var self = this;\r\n        var item = element.parent('div');\r\n\r\n        // Remove from main memory and set the new value\r\n        self.removeElement({ id: item.data(\"id\") });\r\n\r\n        // Remove list element\r\n        item.remove();\r\n    },\r\n\r\n    selectItem: function (item) {\r\n        var templateItem = this.getTagTemplate(item, this.properties.editable);\r\n        this.modalViewTagList.append(templateItem);\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new suggest control\r\n     * @param {} inputContainer\r\n     * @returns {}\r\n     */\r\n    configureModalViewHandlers: function (modalView) {\r\n        var self = this;\r\n        var modalFooter = modalView.footer;\r\n        var modalHeader = modalView.header;\r\n\r\n        // Initialize data\r\n        var elements = {};\r\n\r\n        if (self.hasValue()) {\r\n            var list = self.getListItems();\r\n            $.each(list, function (index, item) {\r\n                elements[item.id] = item;\r\n            });\r\n        }\r\n\r\n        // Configuring list as a selectable element\r\n        self.modalViewList = $(\".bz-list\", modalView.content);\r\n        self.modalViewTagList = $(\".bz-search-pill__results\", modalHeader);\r\n\r\n        var $clearButton = $(\".bz-modal-view__clear\", modalHeader);\r\n\r\n        // Suggest\r\n        var $suggestInput = $(\".bz-modal-view__search\", modalHeader);\r\n        var suggestFilter = bizagi.util.debounce(function () {\r\n            if (this.value === \"\") {\r\n                $clearButton.removeClass(\"bz-modal-view__clear--visible\");\r\n            } else {\r\n                $clearButton.addClass(\"bz-modal-view__clear--visible\");\r\n            }\r\n            self.autoCompleteSearchResults($.trim(this.value));\r\n        }, this.Class.SEARCH_DELAY);\r\n\r\n        $suggestInput.on(\"change keyup\", suggestFilter).on(\"focus\", function () {\r\n            modalView.header.addClass(\"bz-modal-view__header--active\");\r\n        }).on(\"blur\", function () {\r\n            modalView.header.removeClass(\"bz-modal-view__header--active\");\r\n        });\r\n\r\n        //Clear the search\r\n        $clearButton.bind(\"click\", function () {\r\n            $suggestInput.val(\"\").trigger(\"change\");\r\n        });\r\n\r\n        $(\"[data-action=close]\", modalView.header).bind(\"click\", function () {\r\n            modalView.close();\r\n        });\r\n\r\n        // Add tags to list\r\n        self.modalViewList.on(\"click\", \"li\", function () {\r\n            var item = $.data(this).item;\r\n\r\n            // Prevent duplicate elements\r\n            if (!item || (item && elements[item.id])) return;\r\n            elements[item.id] = item;\r\n\r\n            // Update state of button\r\n            $(modalFooter).find('.bz-btn').removeClass(\"bz-btn--secundary\");\r\n            $(modalFooter).find('.bz-btn').addClass(\"bz-btn--primary\");\r\n\r\n            // Update list\r\n            if ((Object.keys(elements) || []).length === 1) {\r\n                $(modalHeader).find(\".bz-search-pill__selected \")\r\n                    .removeClass(\"bz-search-pill__selected--hidden\");\r\n            }\r\n\r\n            self.selectItem(item);\r\n        });\r\n\r\n        // Remove tags of list\r\n        self.modalViewTagList.on(\"click\", '.bz-pill > .bz-btn-icn', function (evt) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n\r\n            var element = $(this);\r\n            var tag = element.parent('div');\r\n\r\n            // Update state of button\r\n            $(modalFooter).find('.bz-btn').removeClass(\"bz-btn--secundary\");\r\n            $(modalFooter).find('.bz-btn').addClass(\"bz-btn--primary\");\r\n\r\n            // Remove from main memory and set the new value\r\n            delete elements[tag.data(\"id\")];\r\n\r\n            // Remove list element\r\n            tag.remove();\r\n\r\n            // Update list\r\n            if ((Object.keys(elements) || []).length === 0) {\r\n                $(modalHeader).find(\".bz-search-pill__selected \")\r\n                    .addClass(\"bz-search-pill__selected--hidden\");\r\n            }\r\n        });\r\n\r\n        $(modalFooter).delegate(\"[data-action=save]\", \"click\", function (evt) {\r\n            // Create a temporal array\r\n            var newList = [];\r\n            $.each(elements, function (index, item) {\r\n                newList.push(item);\r\n            });\r\n\r\n            self.setDisplayValue({value: newList});\r\n\r\n            modalView.close();\r\n        });\r\n    },\r\n\r\n    autoCompleteSearchResults: function (currentValue) {\r\n        var self = this;\r\n\r\n        $.when(self.processRequest({ term: currentValue }))\r\n            .done(function (response) {\r\n\r\n                self.modalViewList.find(\"li\").remove();\r\n\r\n                for (var i = 0, length = response.length; i < length; i++) {\r\n                    var searchItem = self.renderSearchItem(response[i]);\r\n\r\n                    searchItem.appendTo(self.modalViewList);\r\n                }\r\n            });\r\n    },\r\n\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"searchList.item\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            id: item.id,\r\n            label: item.label,\r\n            value: this.formatItem(item.value)\r\n        });\r\n\r\n        searchItem.data(\"item\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Process the request data for the autocomplete control\r\n     * @param {} req\r\n     * @returns {}\r\n     */\r\n    processRequest: function (req) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var deferred = new $.Deferred();\r\n\r\n        // Create array for response objects   \r\n        var suggestions = [];\r\n\r\n        if (req.term.length >= this.Class.SEARCH_MIN_LENGTH) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n\r\n            // Cancel previous request in order to improve the performance\r\n            if (self.deferredReference && typeof (self.deferredReference.reject) === \"function\" &&\r\n                self.deferredReference.state() !== \"resolved\") {\r\n                self.deferredReference.reject({ hideStatus: true });\r\n            }\r\n\r\n            self.deferredReference = self.getData().done(function (data) {\r\n                if (data && data.length > 0) {\r\n                    data = data.slice(0, properties.maxRecords);\r\n\r\n                    if (data.length > self.Class.SEARCH_MAX_RECORDS) {\r\n                        data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\r\n\r\n                        suggestions.push({\r\n                            id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                            label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                            value: \"\"\r\n                        });\r\n\r\n\r\n                    } else {\r\n                        data = data.slice(0, properties.maxRecords);\r\n                    }\r\n\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords === 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n\r\n                            suggestions.push({ id: val.id, label: parseValue, value: val.value });\r\n                        }\r\n                    });\r\n\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: \"\"\r\n                    });\r\n                }\r\n\r\n                deferred.resolve(suggestions);\r\n\r\n            }).fail(function () {\r\n                deferred.reject();\r\n            });\r\n\r\n        } else {\r\n            deferred.resolve(suggestions);\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    getContentTemplate: function () {\r\n        var self = this;\r\n        var value = self.getValue();\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        var template = this.renderFactory.getTemplate(\"searchList.items\");\r\n        var content = $.fasttmpl(template, {\r\n            items: finalValue || {},\r\n            editable: self.properties.editable || true\r\n        },{\r\n            formatItem: self.formatItem\r\n        });\r\n\r\n        return $.trim(content);\r\n    },\r\n\r\n    getFooterTemplate: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"searchList.actions\");\r\n        var content = $.fasttmpl(template, {\r\n            items: self.properties.value || {},\r\n            editable: self.properties.editable || true\r\n        });\r\n\r\n        return $.trim(content);\r\n    },\r\n\r\n    getTagTemplate: function (item, editable) {\r\n        var template = this.renderFactory.getTemplate(\"searchList.tag\");\r\n        var content = $.fasttmpl(template, {\r\n            id: item.id,\r\n            label: item.label,\r\n            value: this.formatItem(item.value),\r\n            editable: editable\r\n        });\r\n        return $.trim(content);\r\n    },\r\n\r\n    adjustResize: function () {\r\n        var self = this;\r\n        var initialScreenSize = window.innerHeight;\r\n\r\n        $(window).off(\"resize\").on(\"resize\", bizagi.util.debounce(function () {\r\n            var that = $(this);\r\n\r\n            // Hide the footer\r\n            if (that.height() < initialScreenSize) {\r\n                $(\".bz-mobile-view__footer_content\").addClass(\"bz-hidden\");\r\n            } else {\r\n                $(\".bz-mobile-view__footer_content\").removeClass(\"bz-hidden\");\r\n            }\r\n        }, self.Class.SEARCH_DELAY));\r\n    },\r\n\r\n    getHeaderTemplate: function () {\r\n        var self = this;\r\n        var value = self.getValue();\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n        var template = this.renderFactory.getTemplate(\"searchList-modal-header\");\r\n\r\n        var content = $.fasttmpl(template, {\r\n            items: finalValue || {},\r\n            editable: self.properties.editable || true,\r\n            emptyItems: (finalValue || []).length === 0,\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n\r\n        return $.trim(content);\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi User Field render tablet Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will define the basic behaviour for userfields    \r\n*/\r\n\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.userfieldWrapper\", bizagi.rendering.userfieldWrapper.prototype);\r\n\r\nbizagi.rendering.smartphone.userfieldWrapper.extend(\"bizagi.rendering.smartphone.userfieldWrapper\", {}, {\r\n\r\n    /** \r\n    *   Load userfield\r\n    */\r\n    getUserfieldControl: function () {\r\n        var self = this;\r\n        var sControl = self.userfieldName;\r\n        var mode = self.getMode();\r\n        var exists = (mode !== \"execution\") || eval(\"bizagi.rendering.smartphone.\" + sControl + \" !== undefined\");\r\n        var def = new $.Deferred();\r\n        if (exists) {\r\n            // Creates the userfield instance\r\n            // Set true argument for tabItem\r\n            $.when(self.parent.ready()).done(function () {\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n\r\n        } else {\r\n            // Call ajax service in order to retrieve user field definitions\r\n            $.when(self.dataService.getUserfieldDefinition({ userfield: self.userfieldGuid, device: \"smartphone\" })).pipe(function (data) {\r\n                // Load userfield in memory\r\n                self.loadUserfield(data);\r\n\r\n                // Creates the userfield instance\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n        }\r\n\r\n\r\n        return def.promise();\r\n    },\r\n\r\n        /**\r\n     * Creates the userfield instance when the userfield prototype is loaded in memory \r\n     */    \r\n    createUserfieldInstance: function (sControl) {\r\n        var self = this;\r\n        var control;\r\n        try {\r\n            // Create a dynamic function to avoid problem with eval calls when minifying the code\r\n            var dynamicFunction = \"var baDynamicFn = function(renderParams){ \\r\\n\";\r\n            dynamicFunction += \"return new bizagi.rendering.smartphone.\" + sControl + \"(renderParams);\\r\\n\";\r\n            dynamicFunction += \"}\\r\\n\";\r\n            dynamicFunction += \"baDynamicFn\";\r\n            dynamicFunction = eval(dynamicFunction);\r\n\r\n            // Call the dynamic function\r\n            control = dynamicFunction(self.initialParams);\r\n        } catch (e) {\r\n            // If the call fails, return the default user field\r\n            control = self.getUserFieldInstance(self.initialParams);\r\n        }\r\n        control.properties.isUserField = true;\r\n\r\n        // Save userfield instance\r\n        self.userfieldInstance = control;\r\n\r\n        // Create proxy methods from the wrapper to the userfield instance\r\n        self.replicateUserfieldMethods(control);\r\n\r\n        // Replicate renderchange event from wrapped element to grid if applies\r\n        self.userfieldInstance.bind(\"renderchange\", function () {\r\n            self.triggerHandler(\"renderchange\", arguments);\r\n        });\r\n\r\n        return control;\r\n    },\r\n\r\n     /**\r\n     * Load userfield into memory\r\n     */\r\n    loadUserfield: function (data) {\r\n        var self = this;\r\n        self.properties.styleGuid = self.properties.styleGuid || Math.guid();\r\n\r\n        try {\r\n            // Parse data\r\n            try { data = eval(data); } catch (e) { bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message); }\r\n\r\n            // Iterate elements\r\n            $.each(data, function (index, val) {\r\n                if (val.type == \"js\") {\r\n                    try { \r\n                         function replaceWithDevice(str)\r\n                        {\r\n                          return str.replace(/bizagi.rendering/gi, \"bizagi.rendering.smartphone\");\r\n                        }\r\n                        val.content = val.content.replace(/bizagi\\.rendering\\.[^\\s]+\\.extend(\\s|\\n|\\s)*\\((\\s|\\n|\\s)*\\\"bizagi\\.rendering\\.[^\\s]+\\\"/gmi, replaceWithDevice);\r\n                        window.eval(val.content);\r\n                    } catch (ex) { bizagi.log(\"Could not parse result userfield3 \" + self.userfieldName, ex.message); };\r\n                }\r\n                if (val.type == \"css\") {\r\n                    bizagi.util.loadStyle(val.content, self.properties.styleGuid);\r\n                }\r\n            });\r\n\r\n            // Replicate userfield methods to the wrapper\r\n            var control = eval(\"bizagi.rendering.\" + self.userfieldName);\r\n\r\n        } catch (e) { bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message); };\r\n    },\r\n\r\n    getUserFieldInstance: function (params) {\r\n        var mode = this.getMode();\r\n        // If the call fails, return the default user field\r\n        return   (mode === \"execution\") ?\r\n                    new bizagi.rendering.smartphone.defaultUserField(params) :\r\n                    new bizagi.rendering.smartphone.designUserField(params);\r\n    }\r\n});\r\n\r\n// Auto-extension\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.basicUserField\", bizagi.rendering.userfieldDefinition.prototype);\r\n\r\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.basicUserField\", bizagi.rendering.basicUserField.prototype);\r\n\r\n\r\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.basicUserField\", {}, {\r\n\r\n\r\n\r\n    renderSingle: function () {        \r\n\r\n        return this.postRender();\r\n\r\n    },\r\n\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        $.when(self.postRender()).done(function () {\r\n            $.when(self.renderUserfieldControl()).done(function () {\r\n\r\n                self.inputEdition = self.input;\r\n                // alert(\"render Edition\");\r\n                defer.resolve();\r\n            });\r\n\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n\r\n    getEditableControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getEditableControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n\r\n    getReadonlyControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getReadonlyControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n\r\n    isSupported: function () { return true; }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n        var properties = self.properties;\r\n        var controlName = properties.control.replace(/column/g, \"\");\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n        self.input.addClass(\"ui-bizagi-render-userfield-notSupported\");\r\n        container.addClass(\"bz-command-not-edit\");\r\n        return self.input;\r\n    },\r\n\r\n    /*\r\n    *  Dont send the data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        return \"Userfield: \" + controlName + \" not found\";\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n        return mycontrol;\r\n    }\r\n\r\n\r\n});","/*\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the activity checkList render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.smartphone.checkList.extend(\"bizagi.rendering.smartphone.activityCheckList\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        var goal = (this.properties.activityDescription && this.properties.activityDescription !== \"\") \r\n        ?  bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") + \": \" + this.properties.activityDescription : \"\";\r\n        this.properties.displayName = (goal !== \"\") ? goal : bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\");\r\n        this.properties.displayType = \"vertical\";\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n\r\n        self.newItemName = $(\".bz-checkList__input\", $control);\r\n        self.addEditButton = $(\".add-edit-item-button-checklist\", $control);\r\n        self.cancelEditButton = $(\".cancel-edit-item-button-checklist\", $control);\r\n\r\n        self.additionalElements();\r\n        self.notifyLoadItems();        \r\n    },\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            var resolvedItems = self.properties.items.filter(function(i){\r\n                return i.resolved\r\n            }).length;\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': true,\r\n                'idActivity': self.properties.idActivity,\r\n                'itemsResolved': resolvedItems,\r\n                'items': self.properties.items,\r\n                'progress': self.properties.activityWork\r\n            }));\r\n\r\n            bizagi.webpart.publish(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n\r\n        if (self.addEditButton && self.addEditButton.length > 0) {\r\n            self.addEditButton.hide();\r\n        }\r\n        if (self.cancelEditButton && self.cancelEditButton.length > 0) {\r\n            self.cancelEditButton.hide();\r\n        }\r\n        //control.parent().addClass(\"render-activity-check\");\r\n    },\r\n\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n        $(\"[data-action=add]\", control).unbind(\"click\").click(function() {\r\n            var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".bz-checkList__input\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\"[data-action=delete]\", self.control).bind(\"click\", function() {\r\n            var that = this;\r\n            var message = bizagi.localization.getResource(\"workportal-widget-reports-confirm\");\r\n            var contentHolder = $(this).closest(\".bz-checkList__item\");\r\n\r\n            contentHolder.addClass(\"ui-bizagi-to-remove\");\r\n           \r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function() {\r\n\r\n                    var itemId = $(that).closest(\".bz-checkList__item\").data(\"item-guid\");\r\n\r\n                    self.deleteItem(itemId);\r\n                }).fail(function() {\r\n                    contentHolder.removeClass(\"ui-bizagi-to-remove\");\r\n                });\r\n        });\r\n\r\n        $(\"label[data-action=edit-item]\", self.control).bind(\"click\", function() {\r\n            var element = $(this).closest(\".bz-checkList__item\");\r\n            var itemId = element.data(\"item-guid\");\r\n            var itemPosition = element.data(\"item-position\");\r\n\r\n            self.selectItem(itemId, itemPosition);\r\n        });\r\n    },\r\n\r\n    selectItem: function(itemId) {\r\n        var self = this;\r\n\r\n        for (var i = 0, length = self.properties.items.length; i < length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items[i].selected = true;\r\n            } else {\r\n                self.properties.items[i].selected = false;\r\n            }\r\n        }\r\n\r\n        self.repaintControl();\r\n\r\n        var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.getControl());\r\n        var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function(itemId) {\r\n        var self = this;\r\n\r\n        for (var i = 0, length = self.properties.items.length; i < length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.newItemName.focus();\r\n\r\n        self.newItemName.blur(function () {\r\n             var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\r\n             var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\r\n             var valueInput = itemSelectedName.val();\r\n\r\n             if(valueInput === \"\" && self.properties.items && self.properties.items.length >= 1\r\n                    && self.properties.items.slice(-1)[0].name === \"\"){\r\n                self.properties.items.pop();\r\n             }\r\n         });\r\n        self.addSelectedHandlers();\r\n        self.newItemName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                self.addItem();\r\n                self.prepareNewItem();\r\n            }\r\n        });\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\r\n        var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\r\n        itemSelectedName.focus();\r\n        $(\"[data-action=accept-edit]\", itemSelected).bind(\"click\", function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n        });\r\n\r\n        \r\n        $(\"[data-action=cancel-edit]\", itemSelected).bind(\"click\", function (e) {\r\n            var newItemName = itemSelectedName.val();\r\n            var element = $(this).closest(\".bz-checkList__item\");\r\n            var itemPosition = element.data(\"item-position\");\r\n            var guidItem = element.data(\"item-guid\");\r\n\r\n            if (newItemName && newItemName !== \"\" && self.properties.items[itemPosition].name !== \"\") {\r\n                self.properties.items[itemPosition].selected = false;\r\n            }\r\n            if (newItemName === \"\" || self.properties.items[itemPosition].name === \"\") {\r\n                self.deleteItem(guidItem);\r\n            }\r\n            //self.addButton.show();\r\n            self.repaintControl();\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", $control);\r\n        var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var checkListHtml = self.renderControl();\r\n        $(\"[data-component=checkList]\", self.control).replaceWith(checkListHtml);\r\n        self.postRender();\r\n        self.configureHandlers();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 100;\r\n        }\r\n\r\n        self.notifyLoadItems();\r\n    },\r\n\r\n    getValue: function () {\r\n        var self = this;\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    renderValues[properties.xpath] = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }else{\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': false\r\n            }));\r\n        }\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                break;\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi smartphone Render Number Extension\r\n*   Author: Bizagi Mobile Team \r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.numberScientificNotation\", bizagi.rendering.numberScientificNotation.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.numberScientificNotation.extend(\"bizagi.rendering.smartphone.numberScientificNotation\", {}, {    \r\n\r\n});","/*  \r\n *   Name: Bizagi Smartphone Range Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render Smartphone base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.range\", bizagi.rendering.range.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.range\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Smartphone device\r\n     */\r\n    postRender: function() {        \r\n        var properties = this.properties;\r\n    },\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var control = this.getControl();\r\n    }\r\n\r\n});","/*  \r\n *   Name: Bizagi Smartphone Range Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range date render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from range smartphone base\r\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeDate\", bizagi.rendering.rangeDate.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.rangeDate.extend(\"bizagi.rendering.smartphone.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        this.defineRangeControl();\r\n    }\r\n\r\n});","/*  \r\n *   Name: Bizagi Smartphone Money Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range money render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from range smartphone base\r\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeMoney\", bizagi.rendering.rangeMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.rangeMoney.extend(\"bizagi.rendering.smartphone.rangeMoney\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        this.defineRangeControl();\r\n    }\r\n\r\n});","/*  \r\n *   Name: Bizagi Smartphone Range Number Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range number render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from range smartphone base\r\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeNumber\", bizagi.rendering.rangeNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.rangeNumber.extend(\"bizagi.rendering.smartphone.rangeNumber\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        this.defineRangeControl();\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Desktop Render Template Text Extension\r\n*   Author: Andrs Fernando Muoz\r\n*   Comments:\r\n*   -   This script will redefine the layout render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.layoutRender\", bizagi.rendering.layoutRender.prototype);","/*\r\n *   Name: BizAgi Render Layout Image Class\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable image control inside templates\r\n *   -   This control is based on the image no flash render control\r\n */\r\n\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutImage\", bizagi.rendering.layoutImage.prototype);\r\n\r\nbizagi.rendering.smartphone.layoutImage.extend(\"bizagi.rendering.smartphone.layoutImage\", {\r\n}, {\r\n    \r\n    renderControl: function () {\r\n        var self = this;\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n        self.control = self.getControl();\r\n        return $.fasttmpl(templateUri, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.media.byteArrayToBlob(bizagi.util.media.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    \r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return [self.value];\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutPlaceholder\", bizagi.rendering.layoutPlaceholder.prototype);\r\n","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutBoolean\", bizagi.rendering.layoutBoolean.prototype);","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n *   -   This control is based on the link render control\r\n */\r\n\r\n \r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutLink\", bizagi.rendering.layoutLink.prototype);\r\n\r\nbizagi.rendering.smartphone.layoutLink.extend(\"bizagi.rendering.smartphone.layoutLink\", {\r\n\r\n    configureHandlers: function(){\r\n        var self= this;\r\n        var element = self.element;\r\n        if (element){\r\n            element.on(\"click\", $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n\r\n    onClickElement: function(){\r\n        var self = this,\r\n            params = {\r\n                \"displayName\": self.properties.displayName,\r\n                \"navigateFromRender\": false,\r\n                \"reference\": self.properties.reference,\r\n                \"referenceType\": self.properties.referenceType,\r\n                \"xpath\": self.properties.xpath\r\n            };\r\n        if (bizagi.kendoMobileApplication && bizagi.kendoMobileApplication.view().id == \"#renderSplitView\"){\r\n            params.navigateFromRender = true;\r\n        }\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", params);\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Label Class\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will define basic stuff for labels inside templates\r\n*/\r\n\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutLabel\", bizagi.rendering.layoutLabel.prototype);\r\n\r\nbizagi.rendering.smartphone.layoutLabel.extend(\"bizagi.rendering.smartphone.layoutLabel\", {\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n        self.properties.displayName = val;\r\n        this._super(val, triggerEvents);\r\n        var control = self.getControl();\r\n        if (control) {\r\n            $(\".ui-bizagi-render-label\", control).text(val);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutText\", bizagi.rendering.layoutText.prototype);\r\n\r\nbizagi.rendering.smartphone.layoutText.extend(\"bizagi.rendering.smartphone.layoutText\", {\r\n    setDisplayValue: function (value) {\r\n    }\r\n});","/*\r\n*   Name: BizAgi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Muoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutDateTime\", bizagi.rendering.layoutDateTime.prototype);","/*\r\n *   Name: BizAgi Desktop Render Template number Extension\r\n *   Author: Mauricio Sanchez\r\n *   Comments:\r\n *   -   This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutNumber\", bizagi.rendering.layoutNumber.prototype);\r\n\r\nbizagi.rendering.smartphone.layoutNumber.extend(\"bizagi.rendering.smartphone.layoutNumber\", {\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        val = (typeof val === \"undefined\" || val === null) ?  \"\" : self.getDisplayValue(val);\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var label = $('<label/>').html(value); // To get the display value by the format currency plugin, because it requires a control\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        return [label.text()];\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template Money Extension\r\n *   Author: Andres Fernando Muoz\r\n *   Comments:\r\n *   -   This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutMoney\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.layoutMoney.extend(\"bizagi.rendering.smartphone.layoutMoney\", bizagi.rendering.layoutMoney.prototype);\r\nbizagi.rendering.smartphone.layoutMoney.extend(\"bizagi.rendering.smartphone.layoutMoney\", {\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n\tsetValue: function (val, triggerEvents) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\r\n\t\tval = (typeof val === \"undefined\" || val === null) ? \"\" : self.getDisplayValue(val);\r\n\t\tself.properties.displayName = val;\r\n\r\n\t\tthis._super(val, triggerEvents);\r\n\t\tif (control) {\r\n\t\t\t$(\".ui-bizagi-render-number\", control).text(val);\r\n\t\t}\r\n\t}\r\n});","/*\r\n *   Name: BizAgi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutUpload\", bizagi.rendering.layoutUpload.prototype);\r\n\r\nbizagi.rendering.smartphone.layoutUpload.extend(\"bizagi.rendering.smartphone.layoutUpload\", {\r\n\t/**\r\n\t *   Template method to implement in each children to customize each control\r\n\t */\r\n\trenderControl: function () {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties,\r\n\t\t\tdefer = $.Deferred();\r\n\r\n\t\t$.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n\t\t\tself.properties = properties;\r\n\t\t\tself.files = valueResult.files;\r\n\t\t\tdefer.resolve(self.getHTMLFiles());\r\n\t\t});\r\n\r\n\t\treturn defer.promise();\r\n\t},\r\n\r\n\tpostRender: function() {\r\n\t    var self = this;\r\n\t    var control = self.getControl();\r\n\t    var filesLinkElements = control.find(\".ui-bizagi-render-upload-item a\");\r\n\r\n\t    filesLinkElements.on(\"click\", function() {\r\n\t        bizagi.loading.start();\r\n\t        $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function(error) {\r\n\t            if (error.responseText) {\r\n\t                self.getFormContainer().failHandler(error.responseText);\r\n\t            }\r\n\t        }).always(function() {\r\n\t            bizagi.loading.stop();\r\n\t        });\r\n\t    });\r\n\t},\r\n\r\n\tgetHTMLFiles: function(){\r\n\t\tvar self = this;\r\n\t\tvar files = $.map(self.files, function(el){\r\n\t\t\tvar file = {\"id\": el[0], \"filename\": el[1]};\r\n\t\t\tfile.url =  self.buildItemUrl(file);\r\n\t\t\treturn file;\r\n\t\t});\r\n\r\n\t\tvar template = self.renderFactory.getTemplate(\"layout-upload\");\r\n\t\treturn $.fasttmpl(template, {\"files\": files});\r\n\t},\r\n\r\n\t/**\r\n\t *   Builds the upload item url\r\n\t */\r\n\tbuildItemUrl: function (file) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\treturn self.dataService.getUploadFileEntityUrl({\r\n\t\t\tisContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n\t\t\txpath: self.getUploadXpath(),\r\n\t\t\tfileId: file.id,\r\n\t\t\tidRender: form.properties.paramsRender.idRender || \"undefined\",\r\n\t\t\txpathContext: properties.xpathContext,\r\n\t\t\tidPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n\t\t\txpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n\t\t\tsessionId: form.properties.sessionId,\r\n\t\t\tsurrogatekey: self.properties.value.surrogateKey,\r\n\t\t\tguidentity: self.properties.value.guid\r\n\t\t});\r\n\t}\r\n});","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.smartphone.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function(decorated) {\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated && decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n            decorated.properties.displayType = \"normal\";\r\n        }\r\n    },\r\n\r\n    getContainerMessage: function(surrogateKey){\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        return $(\".bz-form-cell-message__text\", decorated.element);\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function() {\r\n        return $(\".bz-control\", this.element || this.observableElement);\r\n    },\r\n\r\n    isValueValid: function(surrogateKey, value, messages, propertyOverrides){\r\n        var isValid = this._super(surrogateKey, value, messages, propertyOverrides);\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        var $message = this.getContainerMessage(surrogateKey);\r\n\r\n        if (!isValid) {\r\n            var message = messages.join(\",\").replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\r\n            $message.text(message);\r\n            decorated.element.addClass(\"bz-form-item--error\");\r\n        }\r\n        else {\r\n            $message.text(\"\");\r\n            decorated.element.removeClass(\"bz-form-item--error\");\r\n        }\r\n        return isValid;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function(element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function(surrogateKey, cell) {\r\n        var self = this;\r\n\r\n        // Call base        \r\n        self._super(key, cell);\r\n\r\n        // Just draw render if the cell layout has been filled\r\n        if (cell && cell.length > 0) {\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            if (!self.properties.editable) cellIcon.detach();\r\n\r\n            // Apply styles to cell\r\n            self.applyColumnStyles(cell);\r\n\r\n            if (self.properties.align == \"left\") {\r\n                cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n            }\r\n        }\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\r\n\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.combo\", {}, bizagi.rendering.columns.combo.prototype );\r\n// Extends itself\r\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.combo\", {}, {\r\n    applyOverrides: function(decorated) {\r\n        // Hacks the getControl method in the decorated render to add features\r\n        var self = this;\r\n        self._super(decorated);\r\n\r\n        if (decorated && decorated.getControl) {\r\n            self.originalGetControl = decorated.getControl;\r\n            decorated.getControl = self.getControl;\r\n            decorated.properties.displayType = \"normal\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function() {\r\n        var self = this;\r\n        var result = self._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n     /*\r\n    *   Sets the internal value\r\n    */\r\n   setValue: function(surrogateKey, value) {\r\n    var self = this;\r\n    var decorated = self.getDecorated(surrogateKey);\r\n    // Check is offline form\t    \r\n    var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n    if (decorated === null) {\r\n        return;\r\n    }\r\n\r\n    // Perform default set value when rendering summary row\r\n    if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n    if(isOfflineForm && (typeof (value) == \"number\" || typeof (value) == \"string\")){\r\n        var newValue =  typeof (self.properties.data) == \"object\" ? self.properties.data.find(function(item){ return item.id == value }) : value;\r\n\r\n        self._super(surrogateKey, newValue);\r\n        decorated.selectedValue = value;\r\n    } else if (value && value.length > 0) {\r\n\r\n        // Create the value property\r\n        var newValue = {\r\n            id: value[0][0],\r\n            value: value[0].length > 2 ? $.grep(value[0], function (item, i) { return i != 0; }) : value[0][1]\r\n        };\r\n        // Call base\r\n        self._super(surrogateKey, newValue);\r\n        decorated.selectedValue = newValue.value;\r\n    } else if (value && value.id && value.value) {\r\n        self._super(surrogateKey, value);\r\n        decorated.selectedValue = value.value;\r\n    } else if (self.properties.type == \"columnRadio\") {\r\n        self._super(surrogateKey, null);\r\n        decorated.selectedValue = value;\r\n    } else if (value && typeof (value) == \"number\") {\r\n        self._super(surrogateKey, value);\r\n    } else if (isOfflineForm && (value !== null && typeof (value) === \"object\" && value.value)) {\r\n        self._super(surrogateKey, value.value);\r\n        decorated.selectedValue = value.value;\r\n    } else {\r\n        // Set null values when the entry array is null\r\n        self._super(surrogateKey, null);\r\n        decorated.selectedValue = \"\";\r\n    }\r\n}\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Document Generator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.document\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        if (mode !== \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.preRenderControl = this.preRenderControl;\r\n            decorated.deleteDocumentTemplate = this.deleteDocumentTemplate;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * This method tries to get the HTML template an render the current object inside\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderControl: function () {\r\n        this.preRenderControl();\r\n\r\n        return this._super();\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.startLoading();\r\n\r\n        // Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        var grid = self.parent;\r\n        var form = self.getFormContainer();\r\n\r\n        $.when(form.submitData()).done(function () {\r\n            $.when(self.dataService.generateDocumentTemplate(properties)).done(function (response) {\r\n                $.when(grid.refresh()).done(function () {\r\n                    self.autoOpenDocuments();\r\n                });\r\n\r\n                self.endLoading();\r\n\r\n            }).fail(function () {\r\n                self.showErrorMessage();\r\n                self.endLoading();\r\n            });\r\n        }).fail(function (message) {\r\n            // Add error messages\r\n            self.getFormContainer().addErrorMessage(message);\r\n\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param xpath\r\n     * @returns {string}\r\n     */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index !== -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*|string}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index !== -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param surrogateKey\r\n     * @param cell\r\n     * @param tableCell\r\n     */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {string}\r\n     */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var xpathContext = (form.properties.xpathContext) ? form.properties.xpathContext + \".\" : \"\";\r\n        return xpathContext + this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n        if (this.value != undefined && this.properties.value != undefined) {\r\n            this.properties.value = this.value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var grid = self.parent;\r\n        var params = {};\r\n\r\n        params.xpath = self.properties.xpath + \"[fileName='\" + filename + \"']\";\r\n        params.idRender = self.properties.id;\r\n        params.xpathContext = self.getContextXpath();\r\n        params.idPageCache = self.properties.idPageCache;\r\n\r\n        $.when(self.dataService.deleteUploadFile(params)).done(function () {\r\n            grid.refresh();\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Date Column Decorator Extension\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.date\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Text Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.text\", {}, {\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Number Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.number\", {}, {});\r\n","/**\r\n *   Name: Bizagi Smartphone Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.image\", {}, {\r\n\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n\r\n        this._super(decorated);\r\n\r\n        var propertiesGrid = self.grid.properties != \"undefined\" ? self.grid.properties : decorated.grid.properties;\r\n        var xpath = propertiesGrid.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        //decorated.getUploadXpath = this.getUploadXpath;\r\n        decorated.properties.xpathContext =\r\n            self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n        decorated.setDisplayValue = function () {\r\n            return true;\r\n        };\r\n    },\r\n    /**\r\n     * Returns the xpath to be used  \r\n     * @returns {} \r\n     */\r\n    /*getUploadXpath: function() {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }*/\r\n\r\n});","/*\r\n*   Name: Bizagi smartphone Upload Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the upload column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.upload\", {}, {\r\n\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n\r\n            decorated.getUploadXpath = self.getUploadXpath;\r\n\r\n            decorated.getXpathContext = function() {\r\n\r\n                var surrogateKey = this.surrogateKey || \"\";\r\n                var columnXpath = self.getUploadXpath(decorated);\r\n                var columnXpathSplit = columnXpath.split(\".\");\r\n                var nameFile = columnXpathSplit[columnXpathSplit.length - 1];\r\n                var xpath = self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n\r\n                var xpathContext = self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n\r\n                return { xpathContext: xpathContext, nameFile: nameFile };\r\n            };\r\n\r\n            decorated.buildItemUrl = function(file) {\r\n                var that = this;\r\n                var form = that.getFormContainer();\r\n                var context = that.getXpathContext();\r\n\r\n                return that.dataService.getUploadFileUrl({\r\n                    idRender: that.properties.id,\r\n                    xpath: context.nameFile,\r\n                    xpathContext: context.xpathContext,\r\n                    idPageCache: that.properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: that.properties.contexttype\r\n                });\r\n            };\r\n\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used  \r\n     * @param {} decorated \r\n     * @returns {} \r\n     */\r\n    getUploadXpath: function(decorated) {\r\n        var self = decorated || this;\r\n\r\n        return self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + self.properties.xpath;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Link Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the number column decorator class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.link\", {}, {\r\n\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        if (mode !== \"design\" && mode !== \"layout\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n\r\n            decorated.getXpath = self.getXpath;\r\n            decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) === -1) {\r\n                decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n            }\r\n\r\n        }\r\n\r\n        if (decorated.properties.type === \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param {} xpath\r\n     * @returns {}\r\n     */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index !== -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {}\r\n     */\r\n    getContextXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    },\r\n\r\n    /**\r\n     * Get Form Link xpath to use\r\n     * @returns {*}\r\n     */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) !== null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath) return;\r\n        return this.properties.xpath;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\r\n\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.search\", {}, bizagi.rendering.columns.search.prototype );\r\n// Extends itself\r\nbizagi.rendering.smartphone.columns.search.extend(\"bizagi.rendering.smartphone.columns.search\", {}, {\r\n\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    },\r\n\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        if (value && value.length > 0) {\r\n            value = [].concat(value[0]);\r\n            return self._super(surrogateKey, {\r\n                id: value[0],\r\n                label: value[1],\r\n                additionallabel: value[2] || undefined\r\n            });\r\n        }\r\n        else {\r\n            return self._super(surrogateKey, value);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone ECM Column Decorator Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the ECM column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.uploadecm\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param {} decorated      \r\n     */\r\n    applyOverrides: function(decorated) {\r\n        this._super(decorated);\r\n\r\n        if (decorated && decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n        }\r\n\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n        decorated.getXpathContext = this.getECMXpathContext;\r\n\r\n        decorated.buildItemUrl = function(file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n\r\n            columnXpath = columnXpath.split(\".\");\r\n\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.buildAddParams = function() {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();            \r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return {\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                idAttrib: properties.idAttrib,\r\n                xpathContext: xpathContext,\r\n                metaValues: [],\r\n                idPageCache: properties.idPageCache,\r\n                idSession: form.properties.sessionId,\r\n                contexttype: \"entity\",\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize\r\n            }\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey      \r\n     */\r\n    getUploadXpath: function(surrogateKey) {\r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        return this.grid.properties.xpath + \"[id=\" + surrogateKey + \"].\" + this.properties.xpath;\r\n    },\r\n\r\n\r\n    getControl: function() {\r\n        var result = this._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            return $(\".ui-bizagi-cell-readonly\", this.element || this.observableElement);\r\n        } else {\r\n            return $(\".bz-control\", this.element || this.observableElement);\r\n        }\r\n\r\n    },\r\n\r\n    getECMXpathContext: function() {\r\n        var xpath = this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n\r\n        return this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" + xpath : xpath;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.button\", {}, {\r\n});","/*\r\n*   Name: Bizagi Smartphone Radio Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the Radio column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.radio\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to Smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.list\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Date Column Decorator Extension\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will redefine the check column to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.exclusiveCheck\", {}, { \r\n});","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from columns smartphone base\r\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.readonly\", bizagi.rendering.columns.readonly.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.columns.readonly.extend(\"bizagi.rendering.smartphone.columns.readonly\", {}, {\r\n\r\n});","/**\r\n *   Name: Bizagi smartphone Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from render smartphone base and document base\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.document\", bizagi.rendering.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.document.extend(\"bizagi.rendering.smartphone.document\", {\r\n    ACTION_SHOW: \"show\",\r\n    ACTION_DOWNLOAD: \"download\",\r\n    ACTION_DELETE: \"delete\"\r\n}, {\r\n\r\n    /**\r\n     * This method tries to get the HTML template an render the current object inside\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = this.renderFactory.getTemplate(self.getTemplate());\r\n        var documents = this.properties.value || [];\r\n\r\n        var data = {\r\n            downloadalldocuments: this.properties.downloadalldocuments,\r\n            allowgenerate: this.properties.allowGenerate,\r\n            noFiles: documents ? (documents.length === 0) : true,\r\n            append: this.properties.append,\r\n            caption: this.properties.caption\r\n        };\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, data);\r\n\r\n        // Render current children\r\n        var items = this.renderDocumentsHtml(documents);\r\n        html = this.replaceFilesHtml(html, items);\r\n\r\n        // Render current children\r\n        var actions = this.renderActionsHtml(documents, data.noFiles, data.downloadalldocuments);\r\n        html = this.replaceActionsHtml(html, actions);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n\r\n        this.$inputDocument = $(\".bz-document-template__container\", $control);\r\n        this.$listDocuments = $(\"[data-component=files]\", $control);\r\n        this.$listActions = $(\"[data-component=actions]\", $control);\r\n\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = this.renderFactory.getTemplate(self.getTemplateReadonly());\r\n        var documents = this.properties.value || [];\r\n        var noFiles = documents ? (documents.length === 0) : true;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {noFiles: noFiles});\r\n\r\n        // Render current children\r\n        var items = this.renderDocumentsHtml(documents);\r\n        html = this.replaceFilesHtml(html, items);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        this.$listDocuments = $(\"[data-component=files]\", $control);\r\n    },\r\n\r\n    /**\r\n     * TMethod to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Attach handler\r\n        this.$inputDocument.on(\"click\", function (evt) {\r\n            self.properties.buttonExecuted = true;\r\n\r\n            if (self.properties.validate) {\r\n                // Check if the form is valid, then generate\r\n                if (self.validateContainer()) self.documentTemplateGenerate();\r\n            } else {\r\n                // Just generate the form\r\n                self.documentTemplateGenerate();\r\n            }\r\n\r\n            self.properties.buttonExecuted = false;\r\n        });\r\n\r\n        // Configure delete and preview handler\r\n        this.$listDocuments.on(\"click\", \"[data-action]\", function (evt) {\r\n            var $context = $(this);\r\n\r\n            var item = $context.parent(\".bz-document\");\r\n            var documentFile = item.data();\r\n            var action = $context.data(\"action\");\r\n\r\n            self.processAction(action, documentFile);\r\n        });\r\n\r\n        // Configure delete and download handler\r\n        self.$listActions.on(\"click\", \"[data-action]\", function (evt) {\r\n            var $context = $(this);\r\n\r\n            var item = $context.parent(\".bz-document__download\");\r\n            var documentFile = item.data();\r\n            var action = $context.data(\"action\");\r\n\r\n            self.processAction(action, documentFile);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Configure delete and preview handler\r\n        this.$listDocuments.on(\"click\", \"[data-action]\", function (evt) {\r\n            var $context = $(this);\r\n\r\n            var item = $context.parent(\".bz-document\");\r\n            var documentFile = item.data();\r\n            var action = $context.data(\"action\");\r\n\r\n            self.processAction(action, documentFile);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * This method must be implemented by the specific class of each device. (Virtual method)\r\n     * @param file\r\n     * @returns {*|*|*}\r\n     */\r\n    renderAllDocumentDownload: function (file) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateDownload());\r\n        var url = self.buildAllDocumentsUrl();\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (!this.isExecutionMode()) url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            filename: file.fileName,\r\n            joined: true\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadAllDocuments) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var $documentContainer = $(\"[data-component='files']\", $control);\r\n        var $actionContainer = $(\"[data-component='actions']\", $control);\r\n\r\n        // Clear current links\r\n        $documentContainer.empty();\r\n        $actionContainer.empty();\r\n\r\n        // Draw links again\r\n        var items = this.renderDocumentsHtml(documents);\r\n        $documentContainer.append(items);\r\n\r\n        // Check if there are documents and the flag to download all are available to show the link.\r\n        var actions = this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n        $actionContainer.append(actions);\r\n\r\n        //Set value\r\n        self.setValue(documents);\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed (Virtual method)\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n        bizagi.loading.start();\r\n\r\n        $.when(bizagi.util.media.downloadFile(url, filename))\r\n            .fail(function (error) {\r\n                if (error.responseText) {\r\n                    self.getFormContainer().failHandler(error.responseText);\r\n                }\r\n            }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Process request of DocumentTemplateGenerate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDocumentTemplateGenerate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n    },\r\n\r\n    /**\r\n     * Process request of DocumentTemplateGenerate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDeleteDocumentTemplate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n    },\r\n\r\n    processAction: function (action, documentFile) {\r\n        if (action === this.Class.ACTION_DELETE) {\r\n            this.deleteDocumentTemplate(documentFile.filename);\r\n        } else if (action === this.Class.ACTION_SHOW) {\r\n            this.showDocumentPreview(documentFile.url, documentFile.filename);\r\n        } else if (action === this.Class.ACTION_DOWNLOAD) {\r\n            this.showDocumentPreview(documentFile.url, documentFile.filename);\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone queryForm Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n *   -   Will apply a desktop form template\r\n */\r\n\r\n// Extends from form smartphone base\r\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.queryForm\", {}, {});","/**\r\n *   Name: Bizagi Smartphone FormTemplate Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the form template class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from form smartphone base\r\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.formTemplate\", bizagi.rendering.formTemplate.prototype);\r\n// Extends itself\r\nbizagi.rendering.smartphone.formTemplate.extend(\"bizagi.rendering.smartphone.formTemplate\", {}, {});\r\n","/**\r\n *   Name: Bizagi Rendering Users Form\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script override rendering.form to create and update users\r\n */\r\n\r\n// Extends from container smartphone form base\r\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.usersForm\", {}, {});","/*\r\n *   Name: BizAgi Render Text Class\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.specific_text\", {}, {\r\n    \r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        if (properties.regularExpressionExpression) {\r\n            properties.regularExpression = {\r\n                \"expression\": properties.regularExpressionExpression,\r\n                \"message\": properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\")\r\n            };\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"text\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, { value: properties.value, \"isEmptyField\": typeof properties.value === \"undefined\", helpText: properties.helpText, editable: properties.editable });\r\n        return html;\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"text-read-only\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, { value: self.getValue() });\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.input = control.find(\"input\");\r\n        //Attach event for retype double\r\n        if (properties.retype == \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n\r\n    },\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            if ($(control).attr(\"type\") != \"hidden\" &&\r\n                $(control).css(\"display\") != \"none\" &&\r\n                $(control).css(\"visibility\") != \"hidden\") {\r\n\r\n                if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") == \"\") {\r\n\r\n                    // Check that there is something in the value\r\n                    if (control.val() == \"\")\r\n                        return;\r\n\r\n                    // Check if a value has already been set\r\n                    if (control.val() == control.attr(\"newValue\"))\r\n                        return;\r\n\r\n                    control.data(\"oldValue\", control.val());\r\n                    control.val(\"\");\r\n                    // Create new tooltip\r\n                    try {\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype\")); //\"Re-escriba el valor\"\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n                    // Focus after 100ms to avoid bubbling\r\n                    setTimeout(function () { control.focus(); input.focus(); }, 100);\r\n\r\n                }\r\n\r\n                else {\r\n                    if (control.val() != control.data(\"oldValue\")) {\r\n                        self.setValue(\"\");\r\n                        control.val(\"\");\r\n                        control.data(\"oldValue\", \"\");\r\n                        control.tooltip(\"destroy\");\r\n                        control.attr(\"title\", self.getResource(\"render-text-retype-error\"));\r\n                        control.tooltip();\r\n                        control.tooltip(\"open\");\r\n                        setTimeout(function () { control.focus(); }, 100);\r\n                    } else {\r\n\r\n                        control.data(\"newValue\", control.val());\r\n                        control.data(\"oldValue\", \"\");\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    }\r\n\r\n                }\r\n            }\r\n        });\r\n\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var input = self.input;\r\n\r\n        // Check mask property\r\n        if (properties.mask) {\r\n            self.input.mask({ mask: properties.mask });\r\n        }\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            var oldValue = self.getValue();\r\n            self.setValue(self.input.val(), false);\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype != \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) == \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.input.val(), true);\r\n                } else {\r\n                    // Set error message\r\n                    message = validationMessages[0].message;\r\n                    //bizagi.showMessageBox(message, \"Bizagi\", \"error\");\r\n                }\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        //When the form have big data, block browser executing RegExp. QAF-1418.\r\n        // Check regular expression\r\n        if (typeof value == \"string\") {\r\n            if (properties.regularExpression) {\r\n                if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(new RegExp(properties.regularExpression.expression)) && self.properties && self.properties.xpath === \"userName\"))) {\r\n                    var message = properties.regularExpression.message;\r\n                    invalidElements.push({ xpath: properties.xpath, message: message });\r\n                    bValid = false;\r\n                } else {\r\n                    if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(new RegExp(properties.regularExpression.expression))))) {\r\n                        var message = properties.regularExpression.message;\r\n                        invalidElements.push({ xpath: properties.xpath, message: message });\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            } else {\r\n                //strange behavior on IE. When matchs are united on IE have is very slow\r\n                //solution, divide matchs\r\n                //.*? means for more information search: \"Lazy matching regexp\"\r\n                if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                    if (properties.editable) {\r\n                        var message = this.getResource(\"render-text-regular-expression-default-message\");\r\n                        invalidElements.push({ xpath: properties.xpath, message: message });\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n         var displayValue = self.getDisplayValue();\r\n         var decodedValue = bizagi.util.decodeURI(value);\r\n         var decodedDisplayValue = bizagi.util.decodeURI(displayValue);\r\n        \r\n        if (!bizagi.util.parseBoolean(self.properties.editable)) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n                control.html(\"<input class='readonly-control bz-form-control' readonly='readonly' value=\"+valueToDisplay+\" >\");\r\n                \r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    control.html(\"\");\r\n                }\r\n            }\r\n        }\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n    /**\r\n    * Extend setValue to fix all encode data from database\r\n    * More information SUITE-9407\r\n    */\r\n    setValue: function (value) {\r\n        /*ISUPP-4116/*\r\n        /*var decodedValue = bizagi.util.decodeURI(value);*/\r\n        var self = this;\r\n        self._super(value);\r\n    },\r\n    /*\r\n*   Execute design only methods\r\n*/\r\n    performDesignModeMethods: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set all controls read-only\r\n        var control = self.getControl();\r\n        //Valid control\r\n        if (control !== null) {\r\n            $(\"select, button, textarea\", control).attr(\"readonly\", true);\r\n        }\r\n        // Execute custom code for each render\r\n        self.configureDesignView();\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    }\r\n});","/*\r\n*   Name: Bizagi Smartphone Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define a render factory to create smartphone versions of each render type\r\n*/\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.smartphone.factory\", {}, {\r\n\r\n    /**\r\n     * Load all the templates used for rendering\r\n     * @returns {} \r\n     */\r\n    loadTemplates: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(\r\n            // Icons\r\n            self.loadTemplate(\"icons\", self.getFileTemplate(\"common.bizagi.rendering.icons\")),\r\n\r\n            // Containers\r\n            self.loadTemplate(\"form\", self.getFileTemplate(\"bizagi.rendering.smartphone.form\") + \"#bz-form-container\"),\r\n            self.loadTemplate(\"complexgateway\", self.getFileTemplate(\"bizagi.rendering.smartphone.form\") + \"#bz-form-complex-gateway\"),\r\n\r\n            self.loadTemplate(\"panel\", self.getFileTemplate(\"bizagi.rendering.smartphone.panel\")),\r\n            self.loadTemplate(\"tab\", self.getFileTemplate(\"bizagi.rendering.smartphone.tab\")),\r\n            self.loadTemplate(\"tabItem\", self.getFileTemplate(\"bizagi.rendering.smartphone.tabItem\")),\r\n            self.loadTemplate(\"horizontal\", self.getFileTemplate(\"bizagi.rendering.smartphone.horizontal\")),\r\n            self.loadTemplate(\"group\", self.getFileTemplate(\"bizagi.rendering.smartphone.group\")),\r\n            self.loadTemplate(\"searchForm\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchForm\")),\r\n            self.loadTemplate(\"accordion\", self.getFileTemplate(\"bizagi.rendering.smartphone.accordion\")),\r\n            self.loadTemplate(\"accordionItem\", self.getFileTemplate(\"bizagi.rendering.smartphone.accordionItem\")),\r\n            self.loadTemplate(\"contentPanel\", self.getFileTemplate(\"bizagi.rendering.smartphone.contentPanel\")),\r\n\r\n            // Renders\r\n            self.loadTemplate(\"render\", self.getFileTemplate(\"bizagi.rendering.smartphone.render\")),\r\n            self.loadTemplate(\"readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.readonly\")),\r\n            self.loadTemplate(\"text\", self.getFileTemplate(\"bizagi.rendering.smartphone.text\") + \"#bz-render-text\"),\r\n            self.loadTemplate(\"text-read-only\", self.getFileTemplate(\"bizagi.rendering.smartphone.text\") + \"#bz-render-text-readonly\"),\r\n\r\n            self.loadTemplate(\"number\", self.getFileTemplate(\"bizagi.rendering.smartphone.number\")),\r\n            self.loadTemplate(\"extendedText\", self.getFileTemplate(\"bizagi.rendering.smartphone.extendedText\") + \"#bz-render-extended-text\"),\r\n            self.loadTemplate(\"extendedText-readOnly\", self.getFileTemplate(\"bizagi.rendering.smartphone.extendedText\") + \"#bz-render-extended-text-readonly\"),\r\n            self.loadTemplate(\"date\", self.getFileTemplate(\"bizagi.rendering.smartphone.date\")),\r\n            self.loadTemplate(\"yesno\", self.getFileTemplate(\"bizagi.rendering.smartphone.yesno\")),\r\n            self.loadTemplate(\"check\", self.getFileTemplate(\"bizagi.rendering.smartphone.check\")),\r\n            self.loadTemplate(\"checkList\", self.getFileTemplate(\"bizagi.rendering.smartphone.checkList\")),\r\n            self.loadTemplate(\"button\", self.getFileTemplate(\"bizagi.rendering.smartphone.button\")),\r\n            self.loadTemplate(\"link\", self.getFileTemplate(\"bizagi.rendering.smartphone.link\")),\r\n            self.loadTemplate(\"formLink\", self.getFileTemplate(\"bizagi.rendering.smartphone.formLink\")),\r\n            self.loadTemplate(\"geolocation\", self.getFileTemplate(\"bizagi.rendering.smartphone.geolocation\")),\r\n            self.loadTemplate(\"radio\", self.getFileTemplate(\"bizagi.rendering.smartphone.radio\")),\r\n\r\n            self.loadTemplate('association', self.getFileTemplate('bizagi.rendering.smartphone.association')),\r\n\r\n            self.loadTemplate(\"ecm\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm\"),\r\n            self.loadTemplate(\"ecm-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm-item\"),\r\n            self.loadTemplate(\"ecm-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm-readonly\"),\r\n\r\n            self.loadTemplate(\"image\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image\"),\r\n            self.loadTemplate(\"image-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-item\"),\r\n            self.loadTemplate(\"image-preview\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-preview\"),\r\n            self.loadTemplate(\"image-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-readonly\"),\r\n\r\n            self.loadTemplate(\"upload\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload\"),\r\n            self.loadTemplate(\"upload-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload-readonly\"),\r\n            self.loadTemplate(\"upload-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload-item\"),\r\n\r\n            self.loadTemplate(\"document\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator\"),\r\n            self.loadTemplate(\"document-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-item\"),\r\n            self.loadTemplate(\"document-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-readonly\"),\r\n            self.loadTemplate(\"document-download\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-download\"),\r\n\r\n            self.loadTemplate(\"list-multiselect\", self.getFileTemplate(\"bizagi.rendering.smartphone.multiSelect\") + \"#bz-multiselect\"),\r\n            self.loadTemplate(\"multiselect-list\", self.getFileTemplate(\"bizagi.rendering.smartphone.multiSelect\") + \"#bz-multiselect-list\"),\r\n            \r\n            self.loadTemplate(\"combo\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control\"),\r\n            self.loadTemplate(\"combo-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control-readonly\"),\r\n            self.loadTemplate(\"combo-list\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control-list\"), \r\n\r\n            self.loadTemplate(\"modal-header-search\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-header-search\"),\r\n            self.loadTemplate(\"modal-header-title\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-header-title\"),\r\n            self.loadTemplate(\"modal-footer-done\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-footer-done\"),\r\n\r\n            self.loadTemplate(\"list\", self.getFileTemplate(\"bizagi.rendering.smartphone.list\") + \"#bz-render-list\"),            \r\n            self.loadTemplate(\"list-items\", self.getFileTemplate(\"bizagi.rendering.smartphone.list\") + \"#bz-render-list-items\"),\r\n\r\n            self.loadTemplate(\"search\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search\"),\r\n            self.loadTemplate(\"search.item\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search-item\"),\r\n            self.loadTemplate(\"search.items\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search-items\"),            \r\n\r\n            self.loadTemplate('searchList', self.getFileTemplate('bizagi.rendering.smartphone.searchList') + \"#bz-render-search-list\"),\r\n            self.loadTemplate(\"searchList.item\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-item\"),\r\n            self.loadTemplate(\"searchList.items\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-items\"),            \r\n            self.loadTemplate(\"searchList.actions\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-actions\"),\r\n            self.loadTemplate(\"searchList.tag\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-tag\"),\r\n            self.loadTemplate(\"searchList.readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-readonly\"),\r\n            self.loadTemplate(\"searchList-modal-header\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-modal-header\"),\r\n\r\n            self.loadTemplate(\"letter\", self.getFileTemplate(\"bizagi.rendering.smartphone.letter\")),\r\n\r\n            //Renders commons\r\n            self.loadTemplate(\"form-error\", self.getFileTemplate(\"bizagi.rendering.smartphone.form-error\")),\r\n            self.loadTemplate(\"form-waiting\", self.getFileTemplate(\"bizagi.rendering.smartphone.form-waiting\")),\r\n\r\n            // Action launcher\r\n            self.loadTemplate(\"render-actionLauncher\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n            self.loadTemplate(\"render-actionLauncher-vertical\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n            self.loadTemplate(\"render-actionLauncher-actions-to-execute\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-actionLauncher-design\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-design\"),\r\n\r\n            // Polymorphic launcher\r\n            self.loadTemplate(\"render-polymorphicLauncher\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-confirm\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-design\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-design\"),\r\n\r\n            //GRIDS SMARTPHONES\r\n            self.loadTemplate(\"grid\", self.getFileTemplate(\"bizagi.rendering.smartphone.grid\")),\r\n            self.loadTemplate(\"cell\", self.getFileTemplate(\"bizagi.rendering.smartphone.cell\")),\r\n            self.loadTemplate(\"cell.readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.cell.readonly\")),\r\n\r\n            //grid items\r\n            self.loadTemplate(\"bizagi.grid.grid\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid\"),\r\n            self.loadTemplate(\"bizagi.grid.totalizer\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-totalizer\"),\r\n            self.loadTemplate(\"bizagi.grid.waiting\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-waiting\"),\r\n            self.loadTemplate(\"bizagi.grid.table\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table\"),\r\n            self.loadTemplate(\"bizagi.grid.table.empty\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table-empty\"),\r\n            self.loadTemplate(\"bizagi.grid.column\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column\"),\r\n            self.loadTemplate(\"bizagi.grid.column.special\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column-special\"),\r\n            self.loadTemplate(\"bizagi.grid.row\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.cell\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.cell.special\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell-special\"),\r\n            self.loadTemplate(\"bizagi.grid.pager\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-buttons\"),\r\n\r\n            // Renders Layouts\r\n            self.loadTemplate(\"render-layout\", self.getFileTemplate(\"bizagi.rendering.smartphone.render.layout\")),\r\n\r\n            self.loadTemplate(\"layout-image\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n            self.loadTemplate(\"layout-image64\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n            self.loadTemplate(\"layout-label\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.label\")),\r\n            self.loadTemplate(\"layout-link\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.link\")),\r\n            self.loadTemplate(\"layout-text\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.text\")),\r\n            self.loadTemplate(\"layout-date-time\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.dateTime\")),\r\n            self.loadTemplate(\"layout-money\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.money\")),\r\n            self.loadTemplate(\"layout-number\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.number\")),\r\n            self.loadTemplate(\"layout-upload\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.upload\"))\r\n\r\n        ).done(function () {\r\n            var tmplIcons = $.fasttmpl(self.getTemplate(\"icons\"));\r\n            var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n            if (svgStoreCounter === 0) {\r\n                $(\"head\").append(tmplIcons);\r\n            }\r\n\r\n            // Resolve when all templates are loaded\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getFileTemplate: function(src, onDemand){\r\n        var device = bizagi.detectDevice();\r\n        return bizagi.getTemplate(src, onDemand, device == \"desktop\" ? \"smartphone_ios\" : device);\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiate container based on the container type\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getContainer: function(params) {\r\n        var self = this;\r\n        var type = params.type;        \r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        type = type.replace(/smartphone/, '');\r\n\r\n        if (type == \"form\")\r\n            return new bizagi.rendering.smartphone.form(containerParams);\r\n\r\n        if (type == \"template\")\r\n            return new bizagi.rendering.smartphone.formTemplate(containerParams);\r\n\r\n        if (type == \"queryForm\")\r\n            return new bizagi.rendering.smartphone.queryForm(containerParams);\r\n\r\n        if (type == \"layout\")\r\n            return new bizagi.rendering.smartphone.layout(containerParams);\r\n\r\n        if (type == \"usersForm\")\r\n            return new bizagi.rendering.smartphone.usersForm(containerParams);\r\n\r\n        if (type == \"panel\")\r\n            return new bizagi.rendering.smartphone.panel(containerParams);\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\")\r\n            return new bizagi.rendering.smartphone.contentPanel(containerParams);\r\n\r\n        if (type == \"nestedForm\")\r\n            return new bizagi.rendering.smartphone.nestedForm(containerParams);\r\n\r\n        if (type == \"tab\")\r\n            return new bizagi.rendering.smartphone.tab(containerParams);\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\")\r\n            return new bizagi.rendering.smartphone.tabItem(containerParams);\r\n\r\n        if (type == \"horizontal\")\r\n            return new bizagi.rendering.smartphone.horizontal(containerParams);\r\n\r\n        if (type == \"accordion\")\r\n            return new bizagi.rendering.smartphone.accordion(containerParams);\r\n\r\n        if (type == \"accordionItem\")\r\n            return new bizagi.rendering.smartphone.accordionItem(containerParams);\r\n\r\n        if (type == \"group\")\r\n            return new bizagi.rendering.smartphone.group(containerParams);\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.smartphone.searchForm(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\")\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n\r\n        if (type == \"mobilegroup\")\r\n            return new bizagi.rendering.mobilegroup(containerParams);        \r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", params.data, \"error\");\r\n\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiate column based on the render type\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getColumn: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        type = type.replace(/smartphone/, '');\r\n\r\n        if (type == \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.smartphone.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.smartphone.text;\r\n            }\r\n\r\n            return new bizagi.rendering.smartphone.columns.text(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.searchList;\r\n            return new bizagi.rendering.smartphone.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type == \"columnNumber\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.number;\r\n            return new bizagi.rendering.smartphone.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.money;\r\n            return new bizagi.rendering.smartphone.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.date;\r\n            return new bizagi.rendering.smartphone.columns.date(columnParams);\r\n        }\r\n\r\n        if (type == \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.smartphone.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.smartphone.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.smartphone.yesno;\r\n            }\r\n            return new bizagi.rendering.smartphone.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.combo;\r\n            return new bizagi.rendering.smartphone.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type == \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.radio;\r\n            return new bizagi.rendering.smartphone.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type == \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.list;\r\n            return new bizagi.rendering.smartphone.columns.list(columnParams);\r\n        }\r\n\r\n        if (type == \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.hidden;\r\n            return new bizagi.rendering.smartphone.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.upload;\r\n            return new bizagi.rendering.smartphone.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type == \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.image;\r\n            return new bizagi.rendering.smartphone.columns.image(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.ecm;\r\n            return new bizagi.rendering.smartphone.columns.uploadecm(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.link;\r\n            return new bizagi.rendering.smartphone.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.formLink;\r\n            return new bizagi.rendering.smartphone.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.userfieldWrapper;\r\n            return new bizagi.rendering.smartphone.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.search;\r\n            return new bizagi.rendering.smartphone.columns.search(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.label;\r\n            return new bizagi.rendering.smartphone.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.label;\r\n            return new bizagi.rendering.smartphone.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.document;\r\n            return new bizagi.rendering.smartphone.columns.document(columnParams);\r\n        }\r\n\r\n        /*\r\n        Not supported\r\n         if (type == \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.letter;\r\n            return new bizagi.rendering.columns.letter(columnParams);\r\n        } */\r\n\r\n        if (type == \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.smartphone.button;\r\n            return new bizagi.rendering.smartphone.columns.button(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    getRender: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ container: params.parent });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        type = type.replace(/smartphone/, '');    \r\n\r\n        if (type == \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.smartphone.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.smartphone.text(renderParams);\r\n        }\r\n\r\n        if (type == \"association\") {\r\n            return new bizagi.rendering.smartphone.association(renderParams);\r\n        }\r\n\r\n        if (type == \"label\") {\r\n            return new bizagi.rendering.smartphone.label(renderParams);\r\n        }\r\n\r\n        if (type == \"hidden\") {\r\n            return new bizagi.rendering.smartphone.hidden(renderParams);\r\n        }\r\n\r\n        if (type == \"number\") {\r\n            // Number Scientific Notation\r\n            if (properties && properties.dataType === 29) {\r\n                return new bizagi.rendering.smartphone.numberScientificNotation(renderParams);\r\n            }\r\n\r\n            return new bizagi.rendering.smartphone.number(renderParams);\r\n        }\r\n\r\n        if (type == \"money\") {\r\n            return new bizagi.rendering.smartphone.money(renderParams);\r\n        }\r\n\r\n        if (type == \"date\") {\r\n            return new bizagi.rendering.smartphone.date(renderParams);\r\n        }\r\n\r\n        if (type == \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display == \"check\") {\r\n                return new bizagi.rendering.smartphone.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.smartphone.yesno(renderParams);\r\n        }\r\n\r\n        if (type == \"combo\") {\r\n            return new bizagi.rendering.smartphone.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.smartphone.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"list\") {\r\n            return new bizagi.rendering.smartphone.list(renderParams);\r\n        }\r\n\r\n        if (type == \"radio\") {\r\n            return new bizagi.rendering.smartphone.radio(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            return new bizagi.rendering.smartphone.image(renderParams);\r\n        }\r\n\r\n        if (type == \"uploadecm\") {\r\n            return new bizagi.rendering.smartphone.ecm(renderParams);\r\n        }\r\n\r\n        if (type == \"upload\") {\r\n            if( isOfflineForm ){\r\n                return new bizagi.rendering.smartphone.upload.offline(renderParams);\r\n            }\r\n            else{\r\n                return new bizagi.rendering.smartphone.upload(renderParams);\r\n            }            \r\n        }\r\n\r\n        if (type == \"grid\") {\r\n            if (isOfflineForm) {\r\n                return new bizagi.rendering.smartphone.grid.offline(renderParams);\r\n            } else {\r\n                return new bizagi.rendering.smartphone.grid(renderParams);\r\n            }\r\n        }\r\n\r\n        if (type == \"groupedgrid\") {\r\n            // return new bizagi.rendering.smartphone.grid.grouped(renderParams);\r\n            return new bizagi.rendering.smartphone.grid(renderParams); // Not supported. Nonetheless, all entries are shown.\r\n        }\r\n\r\n        if (type == \"search\") {\r\n            return new bizagi.rendering.smartphone.search(renderParams);\r\n        }\r\n\r\n        if (type == \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.smartphone.search(renderParams);\r\n        }\r\n\r\n        if (type == \"searchList\") {\r\n            return new bizagi.rendering.smartphone.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.smartphone.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"button\") {\r\n            return new bizagi.rendering.smartphone.button(renderParams);\r\n        }\r\n\r\n        if (type == \"formLink\") {\r\n            return new bizagi.rendering.smartphone.formLink(renderParams);\r\n        }\r\n\r\n        if (type == \"link\") {\r\n            return new bizagi.rendering.smartphone.link(renderParams);\r\n        }\r\n\r\n        if (type == \"actionLauncher\") {\r\n            return new bizagi.rendering.smartphone.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"entityTemplate\") {\r\n            return new bizagi.rendering.smartphone.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type == \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.smartphone.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"userfield\") {\r\n            return new bizagi.rendering.smartphone.userfieldWrapper(renderParams);\r\n        }\r\n\r\n        // Check query renders (starts with \"query\")\r\n        //if (type.indexOf(\"query\") == 0) {\r\n        //    return this.getQueryRender(params);\r\n        //}\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") == 0) {\r\n            return this.getSearchRender(params);\r\n        }\r\n\r\n        if (type == \"document\") {\r\n            return new bizagi.rendering.smartphone.document(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            return new bizagi.rendering.smartphone.image(renderParams);\r\n        }\r\n\r\n        if (type == \"fileprint\") {\r\n            return new bizagi.rendering.smartphone.fileprint(renderParams);\r\n        }\r\n\r\n        if (type == \"geolocation\") {\r\n            return new bizagi.rendering.smartphone.geolocation(renderParams);\r\n        }\r\n\r\n        if (type == \"collectionnavigator\") {\r\n            return new bizagi.rendering.smartphone.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type == \"activityCheckList\") {\r\n           return new bizagi.rendering.smartphone.activityCheckList(renderParams);\r\n        }\r\n\r\n        // Check layout renders (starts with \"layout\")\r\n        if (type.indexOf(\"layout\") === 0) {\r\n            return self.getLayoutRender(params);\r\n        }\r\n\r\n        // Check range renders (starts with \"range\")\r\n        if (type.indexOf(\"range\") === 0) {\r\n            return self.getRangeRender(params);\r\n        }\r\n\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.smartphone.specific_text(renderParams);\r\n        }\r\n\r\n        // Deprecated control\r\n        if (type == \"letter\")\r\n            return new bizagi.rendering.smartphone.letter(renderParams);\r\n\r\n        // No type supported\r\n        //bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        //return null;\r\n\r\n        return this._super(params);\r\n    },\r\n\r\n    /**\r\n   * Returns the appropiatelayout render based on the type   \r\n   */\r\n    getLayoutRender: function(params) {\r\n        var type = params.type;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        type = type.replace(/smartphone/, '');    \r\n\r\n        if (type == \"layoutImage\")\r\n            return new bizagi.rendering.smartphone.layoutImage(renderParams);\r\n\r\n        if (type == \"layoutLink\")\r\n            return new bizagi.rendering.smartphone.layoutLink(renderParams);\r\n\r\n        if (type == \"layoutLabel\")\r\n            return new bizagi.rendering.smartphone.layoutLabel(renderParams);\r\n\r\n        if (type == \"layoutText\")\r\n            return new bizagi.rendering.smartphone.layoutText(renderParams);\r\n\r\n        if (type == 'layoutDateTime')\r\n            return new bizagi.rendering.smartphone.layoutDateTime(renderParams);\r\n\r\n        if (type == \"layoutNumber\")\r\n            return new bizagi.rendering.smartphone.layoutNumber(renderParams);\r\n\r\n        if (type == \"layoutMoney\")\r\n            return new bizagi.rendering.smartphone.layoutMoney(renderParams);\r\n\r\n        if (type == \"layoutPlaceholder\")\r\n            return new bizagi.rendering.smartphone.layoutPlaceholder(renderParams);\r\n\r\n        if (type == \"layoutBoolean\")\r\n            return new bizagi.rendering.smartphone.layoutBoolean(renderParams);\r\n\r\n        if (type == \"layoutUpload\")\r\n            return new bizagi.rendering.smartphone.layoutUpload(renderParams);\r\n\r\n        return this._super(params);\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiate search render based on the type     \r\n     */\r\n    getRangeRender: function (params) {\r\n        var type = params.type;        \r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        type = type.replace(/smartphone/, '');    \r\n\r\n        if (type === \"rangeDate\")\r\n            return new bizagi.rendering.smartphone.rangeDate(renderParams);\r\n\r\n        if (type === \"rangeMoney\")\r\n            return new bizagi.rendering.smartphone.rangeMoney(renderParams);\r\n\r\n        if (type === \"rangeNumber\")\r\n            return new bizagi.rendering.smartphone.rangeNumber(renderParams);\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", params.data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiate search render based on the type     \r\n     */\r\n    getSearchRender: function(params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        type = type.replace(/smartphone/, '');    \r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended)\r\n                return new bizagi.rendering.smartphone.extendedText(searchParams);\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.smartphone.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display == \"check\")\r\n                return new bizagi.rendering.smartphone.check(searchParams);\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.smartphone.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            // Creates a Scientific Notation render\r\n            if (data.properties.dataType == 29)\r\n                return new bizagi.rendering.smartphone.numberScientificNotation(searchParams);\r\n\r\n            return new bizagi.rendering.smartphone.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\")\r\n            return new bizagi.rendering.smartphone.money(searchParams);\r\n\r\n        if (type == \"searchDate\")\r\n            return new bizagi.rendering.smartphone.date(searchParams);\r\n\r\n        if (type == \"searchCombo\")\r\n            return new bizagi.rendering.smartphone.combo(searchParams);\r\n\r\n        if (type == \"searchSuggest\")\r\n            return new bizagi.rendering.smartphone.search(searchParams);\r\n\r\n        if (type == \"searchLabel\")\r\n            return new bizagi.rendering.smartphone.label(searchParams);\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    }\r\n});\r\n"]}