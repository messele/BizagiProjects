{"version":3,"sources":["jquery/common/bizagi.grid/js/bizagi.grid.js","jquery/common/bizagi.grid/js/smartphone/bizagi.grid.smartphone.js","jquery/common/bizagi/js/bizagi.util.js","jquery/renderingflat/js/common/bizagi.rendering.util.js","jquery/rendering/js/plugins/common/jquery.mask.js","jquery/rendering/js/plugins/common/jquery.numeric.js","jquery/rendering/js/plugins/common/jquery.formatCurrency.js","jquery/rendering/js/plugins/common/jquery.mobiscroll.js","jquery/renderingflat/js/plugins/bizagi.mobile.pagination.grid/js/bizagi.mobile.pagination.grid.js","jquery/renderingflat/js/plugins/bizagi.mobile.grid/js/bizagi.mobile.grid.js","jquery/common/base/js/lib/mobile/jquery.timeago.js","jquery/common/base/js/lib/mobile/jquery.tabs.js","jquery/common/base/js/lib/mobile/jquery.helptext.js","jquery/rendering/js/services/bizagi.render.services.endPoints.js","jquery/rendering/js/services/bizagi.render.services.context.js","jquery/rendering/js/services/bizagi.render.services.service.js","jquery/rendering/js/services/bizagi.render.services.multiactionservice.js","jquery/rendering/js/services/bizagi.render.services.metadataMultiactionservice.js","jquery/rendering/js/base/command/bizagi.command.controllers.controller.js","jquery/rendering/js/base/command/bizagi.command.controllers.validation.js","jquery/rendering/js/base/command/bizagi.command.controllers.action.js","jquery/renderingflat/js/base/command/bizagi.command.controllers.action.js","jquery/rendering/js/base/bizagi.rendering.element.js","jquery/rendering/js/base/container/bizagi.rendering.container.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.container.js","jquery/rendering/js/base/render/bizagi.rendering.render.js","jquery/rendering/js/base/render/bizagi.rendering.render.base.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.render.js","jquery/rendering/js/base/container/bizagi.rendering.form.js","jquery/rendering/js/base/container/bizagi.rendering.formTemplate.js","jquery/rendering/js/base/container/bizagi.rendering.layout.js","jquery/rendering/js/base/container/bizagi.rendering.accordion.js","jquery/rendering/js/base/container/bizagi.rendering.accordionItem.js","jquery/rendering/js/base/render/bizagi.rendering.collectionnavigator.js","jquery/rendering/js/base/container/bizagi.rendering.group.js","jquery/rendering/js/base/container/bizagi.rendering.horizontal.js","jquery/rendering/js/base/container/bizagi.rendering.panel.js","jquery/rendering/js/base/container/bizagi.rendering.contentPanel.js","jquery/rendering/js/base/container/bizagi.rendering.searchForm.js","jquery/rendering/js/base/container/bizagi.rendering.tab.js","jquery/rendering/js/base/container/bizagi.rendering.tabItem.js","jquery/rendering/js/base/container/bizagi.rendering.nestedForm.js","jquery/rendering/js/base/render/bizagi.rendering.actionLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.entityTemplate.js","jquery/rendering/js/base/render/bizagi.rendering.polymorphicLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.combo.js","jquery/rendering/js/base/render/bizagi.rendering.check.js","jquery/rendering/js/base/render/bizagi.rendering.number.js","jquery/rendering/js/base/render/bizagi.rendering.numberScientificNotation.js","jquery/rendering/js/base/render/bizagi.rendering.date.js","jquery/rendering/js/base/render/bizagi.rendering.extendedText.js","jquery/rendering/js/base/render/bizagi.rendering.grid.js","jquery/rendering/js/base/render/bizagi.rendering.hidden.js","jquery/rendering/js/base/render/bizagi.rendering.label.js","jquery/rendering/js/base/render/bizagi.rendering.search.js","jquery/rendering/js/base/render/bizagi.rendering.text.js","jquery/rendering/js/base/render/bizagi.rendering.button.js","jquery/rendering/js/base/render/bizagi.rendering.fileprint.js","jquery/rendering/js/base/render/bizagi.rendering.link.js","jquery/rendering/js/base/render/bizagi.rendering.checkList.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.render.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.image.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.link.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.label.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.text.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.upload.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.boolean.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.dateTime.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.number.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.money.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.placeholder.js","jquery/rendering/js/base/render/bizagi.rendering.geolocation.js","jquery/rendering/js/base/render/bizagi.rendering.association.js","jquery/rendering/js/base/render/bizagi.rendering.upload.js","jquery/rendering/js/base/render/bizagi.rendering.ecm.js","jquery/rendering/js/base/render/bizagi.rendering.yesno.js","jquery/rendering/js/base/render/bizagi.rendering.letter.js","jquery/rendering/js/base/render/bizagi.rendering.formLink.js","jquery/rendering/js/base/render/bizagi.rendering.cascadingCombo.js","jquery/rendering/js/base/render/bizagi.rendering.list.js","jquery/rendering/js/base/render/bizagi.rendering.multiSelect.js","jquery/rendering/js/base/render/bizagi.rendering.searchList.js","jquery/rendering/js/base/render/bizagi.rendering.money.js","jquery/rendering/js/base/render/bizagi.rendering.radio.js","jquery/rendering/js/base/render/bizagi.rendering.image.js","jquery/rendering/js/base/render/bizagi.rendering.userfield.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.column.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.readonly.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.combo.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.date.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.search.js","jquery/rendering/js/base/render/bizagi.rendering.document.js","jquery/rendering/js/base/render/bizagi.rendering.range.js","jquery/rendering/js/base/render/bizagi.rendering.rangeDate.js","jquery/rendering/js/base/render/bizagi.rendering.rangeMoney.js","jquery/rendering/js/base/render/bizagi.rendering.rangeNumber.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.form.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.panel.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.contentPanel.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.tab.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.tabItem.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.horizontal.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.group.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.searchForm.js","jquery/renderingflat/js/smartphone/container/helpers/bizagi.rendering.smartphone.helpers.searchForm.js","jquery/renderingflat/js/smartphone/container/helpers/bizagi.rendering.smartphone.slide.startForm.js","jquery/renderingflat/js/smartphone/container/helpers/bizagi.rendering.smartphone.slide.form.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.actionLauncher.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.entityTemplate.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.polymorphicLauncher.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.text.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.extendedText.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.label.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.number.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.numberScientificNotation.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.money.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.date.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.yesno.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.check.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.list.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.multiSelect.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.radio.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.cascadingCombo.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.combo.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.collectionnavigator.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.hidden.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.upload.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.ecm.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.searchList.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.grid.beta.js","jquery/renderingflat/js/smartphone/container/helpers/bizagi.rendering.smartphone.helpers.grid.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.grid.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.search.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.letter.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.button.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.fileprint.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.link.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.checkList.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.activityCheckList.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.image.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.link.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.label.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.text.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.dateTime.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.number.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.money.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.upload.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.image.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.formLink.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.geolocation.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.association.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.userfield.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.column.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.combo.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.document.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.date.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.text.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.number.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.image.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.upload.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.link.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.search.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.uploadecm.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.button.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.numberScientificNotation.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.radio.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.list.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.exclusiveCheck.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.document.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.rangeDate.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.rangeMoney.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.rangeNumber.js","jquery/rendering/js/base/bizagi.rendering.base.factory.js","jquery/renderingflat/js/smartphone/bizagi.rendering.smartphone.factory.js","jquery/rendering/js/bizagi.rendering.device.factory.js","jquery/rendering/js/bizagi.rendering.facade.js"],"names":["$","widget","options","id","columns","sortBy","sortType","showSummary","collapse","collapseState","data","indexedData","maxColumns","buttonsPst","title","tableCssClass","headerStyles","floatingHeader","template","grid","waiting","table","emptyTable","column","specialColumn","row","rowButtons","cell","specialCell","pager","buttons","dynamicPager","summary","summaryCell","actions","add","edit","remove","details","allowMore","enableXlsExport","enablePdfExport","mode","_init","self","this","element","page","changes","totalRows","totalPages","selectedRow","components","asyncCells","scrollableArea","columnByIndex","columnByName","columnKeyIndex","each","i","key","label","name","tooltip","index","split","addClass","attr","calculateKeyIndex","startLoading","bUseTimeout","waitingFn","waitingTimeout","append","fasttmpl","setTimeout","endLoading","clearTimeout","empty","setData","refresh","getData","rows","j","getChanges","_cleanComponents","_cleanButtons","draw","refreshSummary","columnIndex","_getComponent","drawing","refreshSummaryCell","drawSummary","postRenderSummary","getCell","cells","is","children","find","html","drawSummaryCell","replaceWith","onCellReady","changeCellValue","value","deleteCellExclusiveValues","orientation","gridRtl","isDesign","drawTable","appendTo","postRender","attachPaginator","attachHandlers","$tableContainer","$table","offset","parseInt","css","replace","stickyTableHeaders","fixedOffset","zIndex","cacheHeaderHeight","bind","trigger","length","hide","_getButton","show","_replaceElement","drawHeader","drawBody","drawPager","drawButtons","drawGridExportOptions","drawRowButtons","drawDynamicPager","isExactMatch","exactMatch","drawColumn","_canShowButtons","drawSpecialColumn","columnProperties","bizAgiProperties","cssClass","cssclass","header","columntitlealign","extend","isKey","sortActive","sortOrder","columnCssClass","headerLabelStyles","drawRow","rowData","isNewRow","newRow","rnd","Math","floor","random","businessKey","drawCell","_canShowRowButtons","drawSpecialCell","cellAlign","columnAlign","hidden","summarizeBy","result","onDrawCell","calculateSummary","undefined","done","state","resolveResult","messageValidation","promise","drawGroupHeader","drawFooter","pages","total","push","number","active","records","tooltips","parameters","buttonsRtl","exportOptions","rtl","postRenderRow","_triggerHandler","asyncResult","when","selectDynamicPager","onDynamicPager","changePage","currentPage","Number","newPage","onPageRequested","isValid","type","indexOf","sortAttribute","sortColumn","onSortRequested","selectRow","onRowUnselected","selectedBusinessKey","onRowSelected","unselectRow","operation","defaultvalue","columnValues","map","max","min","columnValue","Array","processAction","action","params","onEditRow","onDeleteRow","onShowMore","onShowDetails","onAddRow","onShowExportGridOptions","_buildRefreshParameters","onCollapseGrid","onDrawControl","onDrawGroupHeader","sortColumnIndex","callback","call","component","foundComponent","button","jQuery","ui","bizagi_grid","on","pageNumber","_input","items","bizagi","localization","getResource","fn","hasTotalizer","totalizer","overflowMenu","_row_buttons","totalData","_super","verifyTotalizer","actualActionSheet","util","isObjectEmpty","destroy","kendoMobileActionSheet","smartphone","stopLoading","success_callback","fail_callback","e","NaN","prototype","apply","arguments","getNewRowKeys","_showRowButtons","_hideRowButtons","RegExp","isNewRecord","context","tablet","DEVICES","printf","msg","arg","args","slice","a","val","shift","charCodeAt","round","String","bizagiQueue","queue","callbacks","addParallel","execute","starter","Deferred","queueLength","pipe","deferred","resolve","fail","deviceEnum","callInside","fx","tagName","toLowerCase","contentWindow","browser","msie","execScript","toString","webkit","mozilla","eval","callInsidePopup","document","ready","CSSStyleDeclaration","getPropertyValue","getAttribute","setProperty","styleName","priority","setAttribute","rule","escape","cssText","removeProperty","removeAttribute","getPropertyPriority","test","text","style","get","nl2br","br2nl","controlValueIsChanged","control","properties","getValue","compareValue","originalValue","forceCollectData","includes","parseBoolean","Date","getTime","getMaxZindex","elm","maxZindex","zindex","equalizeHeights","selector","heights","outerHeight","autoSave","deferredSave","detectDevice","_data","anonymizedUserInformation","username","email","domain","picture","isAnonymized","datepickerResource","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","liveProcessesEvents","newLiveProcess","createEvent","initEvent","routeEvents","route","saveEvent","lastWidget","nextWidget","liveSave","widgetName","deferredLiveSave","indeX","location","href","workportal","widgets","BIZAGI_WORKPORTAL_WIDGET_PROFLY","saveLivePromise","dispatchEvent","md5","message","CryptoJS","s","p","m","l","lib","n","r","Base","b","h","mixIn","hasOwnProperty","init","$super","create","clone","q","WordArray","words","sigBytes","t","stringify","concat","clamp","g","ceil","v","enc","Hex","k","join","parse","substr","Latin1","fromCharCode","u","Utf8","decodeURIComponent","Error","unescape","encodeURIComponent","BufferedBlockAlgorithm","reset","_nDataBytes","_append","_process","blockSize","_minBufferSize","_doProcessBlock","splice","Hasher","cfg","_doReset","update","finalize","_doFinalize","_createHelper","_createHmacHelper","HMAC","algo","abs","sin","MD5","_hash","w","f","x","y","z","A","B","C","D","c","d","HmacMD5","multiReplace","mapDataToReplace","reg","replaceAll","pcFrom","pcTo","replaceAllGlobalRegExp","temp","re","capitalize","charAt","toUpperCase","startsWith","str","getInitials","initials","sign","isNaN","obj","JSON","encode","measureString","string","fontSize","width","detach","trim","endsWith","suffix","isIE7","isIE","documentMode","isIE8","isIE9","isIE10","isIE11","navigator","userAgent","match","isIE11OrLower","isIE10OrLower","isEdge","appName","getIEVersion","sAgent","window","indexMSIE","version","substring","isChrome","vendor","isFirefox","minVersion","ua","M","tem","exec","appVersion","getBrowser","bw","emptyNavigatorInfo","info","language","setIphoneXOverrides","isNativePluginSupported","bizagiapp","isIphoneX","isiOSDevice","isString","Object","isObject","isArray","isNull","isBoolean","getInternetExplorerVersion","isNumeric","parseFloat","isFinite","isGUID","mustImplement","notImplementedMethod","console","log","exe","encodeXpath","xpath","isEmpty","isEmptyObject","isEmptyCombo","object","property","other","decodeURI","infinityControl","finishDecoded","decodedValue","hasNonVisibleChars","ch","percent2Number","isMapEmpty","replaceSelector","container","elementToReplace","unwrap","hasScroll","el","direction","identicalObjects","obj1","obj2","countProps","count","isScrolledIntoView","elem","layout","scrollTop","elemTop","top","height","centerElementIntoScroll","actualScroll","elementTop","elementHeight","newTop","encodeHtml","decodeHtmlEntities","getHashParams","hash","loadFile","defer","url","src","loader","then","initWebpart","webpart","device","initialized","initializing","loadingDeferred","getQueryString","pairs","pos","argname","extendQueryString","additionalParams","plainUrl","existingParams","newParams","param","getStackTrace","callstack","isCallstackPopulated","dont","exist","stack","lines","len","opera","entry","currentFunction","callee","caller","fname","highLightElement","removeClass","autoScrollBottom","elScrollHeight","scrollHeight","autoScrollInterval","autoScroll","itemScroll","limitTop","limitBottom","idInterval","outSide","clearInterval","mousemove","event","pageY","autoScrollTopInterval","autoScrollBottomInterval","classCSS","setInterval","valueMaxScrollBottom","innerHeight","removeAutoScroll","unbind","getMaxZIndex","showPopup","callbackFn","left","newWindow","open","BAPopupWindow","BAPopupCallback","BACloseWindow","controls","submitForm","close","showQuirksModePopup","quirksModePage","BIZAGI_PATH_TO_BASE","BAQuirksPopupWindow","windowParams","popupWindow","quirksOnLoad","loadedBody","iframe","afterLoad","userParams","callbackParams","loadingFunction","body","createPopup","popupName","onClose","popupTitle","overlay","popup","closeButton","popupContent","additionalClass","center","closeHandler","click","fullPopup","content","createOkCancelPopup","onOk","onCancel","buttonsContainer","buttonOk","buttonCancel","okHandler","cancelHandler","ok","cancel","dialog","modal","closeQuirksModePopup","quirksPopup","getStyle","pathName","getFontFace","getAllChildrens","matchStyles","stringCss","awesomeBrowser","file","styleSheets","rules","cssRules","BIZAGI_ENVIRONMENT","cssTextOriginal","selectorText","lastLevel","styleSheet","suckBrowser","cookie","expires","days","setDate","getDate","raw","toUTCString","path","secure","decode","randomNumber","setContext","reloadCSS","queryString","_name","_call","_params","_singleton","singleton","_timeOut","timeout","_maxIterations","iterations","_context","_killWhenExitContext","killWhenExitContext","timeOut","maxIterations","itsRunning","timeInit","executeTimeOut","now","actualIterations","ieFunction","pointer","timeOutRunning","isDate","dateField","timeField","resultDate","hasTime","resultTime","arrayDate","unicode2htmlencode","input","htmlHex","getHeadElement","hd","getElementsByTagName","docEl","documentElement","createElement","insertBefore","firstChild","loadStyle","styleText","layoutGuid","node","getElementById","createTextNode","childNodes","nodeValue","replaceChild","appendChild","loadIconStyle","icon","userfieldname","innerHTML","formatDecimalAndMoneyCell","tableData","externalMoneyFormat","moneyFormat","decimalFormat","externalDecimalFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","roundToDecimalPlace","decimalDigits","symbol","colorize","groupDigits","negativeFormat","positiveFormat","columnTitle","fields","formatMoney","numberValue","formatDecimal","override","removeTrailingZeros","positive","BIZAGI_DEFAULT_CURRENCY_INFO","formatBoolean","formatInvariantBoolean","htmlContent","not","$element","format","formatCurrency","formatMonetaryCells","tmpResult","intSection","decimalSection","decimalResult","isNegative","decimalDigitPosition","fixDecimalDigits","getOnlyNumbersByString","stringValue","toFixed","formatInvariantMoney","defaultFormat","allowDecimals","formatInvariantNumber","numberFormat","thousands","containsLetter","formatNumber","percentage","formatInvariantDate","dateTimeFormat","isValidDate","getFormatDate","formatDate","dateFormatter","formatDateFromInvariantStringDate","stringInvariantDate","dateValue","defaultFormatDate","H","getHours","getMinutes","getSeconds","ms","getMilliseconds","formatValueByDataType","dataType","replaceLineBreak","formatMonetaryCell","formatDecimalCell","parseDate","valueOf","LZ","getDateFromFormat","getRelativeTime","date","onlyUnitsTime","time","kendo","diff","timeDiff","getTimeDiffDescription","unit","timeDivisor","unitAmount","resourceAgo","compareDates","date1","dateformat1","date2","dateformat2","d1","d2","getDifferenceBetweenDates","i18n","token","i_format","getFullYear","getMonth","E","getDay","isValidResource","months","i_val","year","getYear","month","hh","mm","ss","ampm","_getInt","month_name","day_name","ff","_isInteger","_val","minlength","maxlength","_token","preferEuro","generalFormats","monthFirst","dateFirst","checkList","analyzeTimeFormat","timeFormat","returnObj","show24Hours","showSeconds","separator","lastToken","getDateFromInvariant","showTime","INVARIANT_FORMAT","setHours","formatInvariant","getDateFromISO","ISO_FORMAT","formatISO","formatISO8601","dateObject","restartTimeToMidnight","isFormatISO8601","stringDate","sleep","delay","start","getDateFormatByDatePickerJqueryUI","browserSupportLocalStorage","setItemLocalStorage","localStorage","setItem","getItemLocalStorage","getItem","removeItemLocalStorage","removeItem","clearLocalStorage","clear","bizagiConfig","showConsoleLog","elementToapply","isEventSupported","eventName","isSupported","needsFallback","circularDependencies","Function","list","lastNodeAdded","addNode","OBJ","foundObjChildNode","_search","_addNode","nodeObj","timeStamp","addChild","resolved","seen","_getFirstNodeWithChilds","_resolve","childs","hasObject","error","dependencyFrom","dependencyFromObj","dependencyTo","dependencyToObj","standardError","status","responseText","makeErrorMessage","multiactionError","toSearch","collection","messageTmpl","cssExtended","instance","cssToAdd","cssExtendedApplyChanges","option","$this","attrToAdd","tmpStyle","arrProperties","resultProperties","cssProperty","canvas","parent","sortJSON","way","sort","shortNumber","newNumber","lenghtNumber","escapeHtml","div","showNotification","div_sync","fadeIn","stop","fadeOut","isModeOnline","isOfflineForm","dispose","arrayEach","array","getStandardNotation","tmp","decimalNumber","exponentialNumber","scientificNotationFormat","sdLimit","expMinLimit","expMaxLimit","sNregex","sNFormat","exp","prefix","originalPointIndex","tempParts","significantDigits","intPart","from","to","significantFlag","firstDigit","restDigits","stripslashes","isHTMLValidText","resetData","sessionStorage","isAuthenticate","changeData","isMobileDevice","isTabletDevice","isAndroidTabletDevice","isiOSTabletDevice","isSmartphoneDevice","isAndroidSmartphoneDevice","isiOSSmartphoneDevice","formContainer","getFormContainer","formParams","getParams","detectAndroidVersion","indexAndroid","androidVersion","getPathUrl","solvedUrl","locationParts","pathname","basePath","protocol","host","pathToBaseBackwards","getAndroidVersion","mobileImagePath","image","dataImage","photoSplit","resource","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","byteNumbers","byteArray","Uint8Array","Blob","stringToByteArray","hasOfflineFormsEnabled","BIZAGI_ENABLE_OFFLINE_FORMS","isFlatDesignEnabled","BIZAGI_ENABLE_FLAT","isMobileGridEnabled","BIZAGI_ENABLE_MOBILE_GRID","isNativeHeaderEnabled","NATIVE_HEADER_ENABLE","isQuickSearchEnabled","BIZAGI_ENABLE_QUICK_SEARCH","isOAuth2Enabled","BIZAGI_AUTH_TYPE","getNativeComponent","BIZAGI_NATIVE_COMPONENT","isVersionSupported","supported","BIZAGI_SERVER_VERSION","isCordovaSupported","isTabletNativeSupported","isSmartphoneNativeSupported","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","detectRealDevice","settedDevice","BIZAGI_DEFAULT_DEVICE","isAndroid","isAndroidDevice","getChannelType","BIZAGI_SERVER_CHANNEL","channel","isDataUrl","getDataUrl","currentUrl","tempUrl","processFailMessage","tmp_block_header","disableWorkPortalMenu","blockHeight","prependTo","position","background","opacity","z-index","enableWorkPortalMenu","downloadFile","completeuRL","ulrToDownload","arrayURL","executeActionRoutingFromWorkportal","idCase","idWorkItem","controllers","menu","publish","BIZAGI_WORKPORTAL_ACTION_ROUTING","getMessageFromNetworkState","sanitizeHTML","textContent","arrayUnique","debounce","func","wait","immediate","callNow","isNativeImageEditorSupported","enableImageEditor","errorMessage","validateUrlWellFormed","decodedDisplayValue","valueToDisplay","setCaretPosition","ctrl","setSelectionRange","focus","createTextRange","range","moveEnd","moveStart","select","getCaretPosition","oField","iCaretPos","selection","oSel","createRange","selectionStart","escapeRegex","getFeatureObject","arr","featureObjectCache","features","getConfigFeatures","pivot","getFeatureObjectIte","bizagiConfiguration","BIZAGI_MOBILE_FEATURES","resetConfigFeatures","isFailResponse","code","formatItem","highlightMatches","item","term","parseValue","regEx","getDesktopResolution","resolution","devicePixelRatio","screenWidth","screen","screenHeight","deviceXDPI","logicalXDPI","getDeviceCode","BIZAGI_DEVICE_MARKET_NAME","normalizeType","hideOrShowXToCloseDialog","isEnableFeature","feature","parents","ps","parentNode","prop","getComputedStyle","scroll","scrollerParent","HTMLElement","SVGElement","scrollingElement","startkendo","kendoMobileApplication","mobile","Application","skin","browserHistory","progress","started","bizagiNavigate","navigate","isSharepointContext","BIZAGI_SHAREPOINT_CONTEXT","isEmptyValue","guid","scenarioInfo","getFileScenario","category","scenario","BIZAGI_SMARTPHONE_PATH","b64EncodeUnicode","btoa","p1","pasteEventName","caret","begin","end","mask","placeholder","_prepareBuffer","_bindEvents","_checkVal","allowPartials","removeData","res","buffer","tests","formatted","_setData","eventsBound","_escapeMask","defs","definitions","partialPosition","firstNonMaskPos","maskEscaped","ignore","focusText","_writeBuffer","change","keyCode","SHIFT","SPACE","BACKSPACE","DELETE","_clearBuffer","_shiftL","ESCAPE","charCode","which","ctrlKey","altKey","metaKey","_seekNext","_shiftR","next","completed","originalPos","allow","lastMatch","literals","replacements","getter","defaults","#","*","selectionEnd","duplicate","numeric","decimal","keypress","nodeName","shiftKey","blur","numericSN","getRegionOrCulture","region","regionInfo","regions","culture","generateRegex","settings","destination","global","eventOnDecimalsEntered","regex","num","multiCeroPattern","search","numParts","isPositive","hasDecimals","decimals","originalDecimals","money","$destination","toNumber","method","asNumber","parseType","validateParseType","eq","F","J","values","setValue","validate","hasClass","prev","outerWidth","offsetHeight","clientHeight","O","N","P","K","enable","disabled","disable","I","PI","closest","formatResult","display","headerText","onChange","theme","wheels","showLabel","setText","cancelText","insertAfter","onSelect","delegate","readonly","preventDefault","originalEvent","wheelDelta","detail","G","stopPropagation","o","onShow","scroller","themes","presets","preset","methods","readOnly","showOnFocus","changedTouches","L","isDisabled","getInst","setDefaults","dateOrder","timeWheels","startYear","endYear","shortYearCutoff","monthText","dayText","yearText","hourText","minuteText","secText","ampmText","stepHour","stepMinute","stepSecond","minDate","maxDate","ap","Q","0","1","invalid","dates","daysOfWeek","daysOfMonth","datetime","inputClass","android","ios","jqm","jqmBody","jqmHeader","jqmWheel","jqmClickPick","jqmSet","jqmCancel","mobilePagination","defaultOptions","firstPage","actualPage","listElement","first","firstClass","previous","previousClass","nextClass","last","lastClass","liClass","arrowClass","clickCallBack","pagination","previousPage","nextPage","modalTemplate","query","lastProcessedValue","force","filter","prepend","modalPagerTemplate","modalPager","modalContainer","listItems","modalListContainer","useWithBlock","kendoMobileModalView","useNativeScrolling","itemSelected","keyup","that","mobileGrid","columnKeyStyle","columnHiddenStyle","bSpecialColumnAdded","kendoTmpl","bSpecialCellAdded","pagerData","hasPagination","pagerContainer","pagerOptions","actionSheet","displayName","editLabel","deleteLabel","detailLabel","titleLabel","setDataToShow","evt","target","actionClicked","cancelClicked","getContainer","timeago","timestamp","$t","refreshMillis","allowFuture","localeTitle","cutoff","strings","prefixAgo","prefixFromNow","suffixAgo","suffixFromNow","seconds","minute","minutes","hour","hours","day","years","wordSeparator","numbers","inWords","distanceMillis","$l","substitute","stringOrFunction","isFunction","iso8601","isTime","bztabs","activeTab","tabNumber","activate","popUp","beforeActivate","tabCountPopup","tabHeader","tabCountReal","widthRow","tabCurrent","widthTabSelected","updateTabSize","origin","changeTab","dataRef","tempTabs","moveAtTheEnd","currentTarget","tabChildren","toggle","domIncluded","headerWidth","innerWidth","totalWidth","pop","helpText","dir","$html","render","services","endPoints","getEndPoints","renderHandlerPathRest","renderUploadHandlerPathRest","renderFileHandlerPathRest","letterHandlerPathRest","multiActionHandlerPathRest","metadataHandlerPathRest","form-get-data","proxyPrefix","form-submit-data","form-submit-data-upload","render-property-refresh","render-multiaction","render-upload-cancel-image","render-upload-data-url","render-upload-add-url","render-upload-delete-url","render-ecm-upload-url","render-multiaction-metadata","render-grid-edit-url","render-grid-save-url","render-grid-add-url","render-grid-rollback-url","render-grid-commit-url","render-grid-checkpoint-url","render-save-entity","render-stakeholder-associated","render-search-default-image","render-search-form-get-data","render-search-advanced-url","render-letter-notEditable-url","render-letter-content-url","render-letter-save-url","render-letter-content-icons","render-userfield-definition","render-document-generate","render-document-generateAllDocuments","render-processes-startform","render-processes-getstartform","render-entity-layout-image64","render-entity-layout-imageByteArray","getXSRFToken","render-entity-layout-upload-files","case-handler-getCaseSummary","case-handler-getCaseSummaryByGuid","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getWorkItemsByGuid","admin-getUsersList","admin-getUsersList-FromPreferences","admin-getUsersList-ForStakeholders","admin-getUsersForAssignation","admin-users-config","admin-usersform","admin-GenerateDataToSendByEmail","admin-sendUserEmail","alert","sharepointProxyPrefix","Class","getUrl","service","setProxyPrefix","BA_ACTION_PARAMETER_PREFIX","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","serviceLocator","multiactionService","multiactionservice","enableECMMetadataMultiaction","multiactionMetadataService","metadatamultiactionservice","userfieldRequests","deviceType","desktop","deviceCode","multiaction","metadataECMMultiaction","getFormData","idProcess","idForm","idEntity","surrogateKey","idRender","xpathContext","requestedForm","recordXPath","summaryForm","idWorkitem","idTask","idPageCache","contextType","guidEntity","isRefresh","isActionStartForm","additionalXpaths","idStartScope","readOnlyForm","printversion","recordXpath","downloadOfflineForm","editable","BA_ALL_PARAMETER_PREFIX","prepare","chrono","initAndStart","ajax","serviceType","response","stopAndLog","form","transformGridDataToReadOnly","allowAdd","allowDelete","allowEdit","allowGrouping","allowSearch","getSearchFormData","idSearchForm","processDataValues","submitData","resolveData","contexttype","transitions","surrogatekey","forcePlanCompletion","actionType","debug","newName","getPropertyData","extra","sessionId","guidentity","pxpath","prows","ppage","pfilter","psort","porder","pcaseId","pguidEntity","psurrogatedKey","pactionXpath","ptemplateGuid","pparameters","beforeSend","xhr","multiactionConnection","getSearchData","getCollapseData","getGridData","order","searchFilter","getGridDataExclusivesSelected","xpathfilter","getUploadCancelImage","pathToBase","getUploadFileUrl","fileId","verifyPathToBase","getUploadFileEntityUrl","isContextContainerWidgetRender","xpathActions","getUploadAddUrl","getUploadAddFileUrl","isUserPreferences","deleteImage","deleteUploadFile","getECMMetadata","idFileUpload","xPath","idAttrib","interceptor","intercept","source","checkOutFile","cancelCheckOut","deleteECMFile","updateECMFileContent","metaValues","updateECMMetadata","getFileProperties","uploadECMFile","fileUpload","fileName","getECMFileUrl","p_sessionId","isFileOnECM","idUpload","read","editGridRecord","addGridRecord","addGridRecordData","saveGridRecord","disableServerGridValidations","deleteGridRecord","getFlipAssociation","flipstate","parseJSON","rollbackGridAction","getSearchDefaultImage","processDataCriteria","criteria","submitSearch","allowFullSearch","maxRecords","associateStakeholder","associatedUser","refreshAssociateStakeholder","getLetterNotEditableUrl","getLetterContent","getCanGenerateLetter","saveLetterContent","fullUrl","getLetterEditorIconsPath","executeButton","getFilePrintUrl","disposition","editLinkForm","saveLinkForm","rollbackLinkForm","commitLinkForm","commitGridAction","sendCheckpoint","sendCheckpointAction","getUserfieldDefinition","userfield","guidUserfield","refreshControl","refreshGridCell","typeRender","executeRule","executeInterface","interface","executeSAPConnector","guidsap","executeConnector","guidConnector","generateDocumentTemplate","h_pageCacheId","contextXpath","xpathcontext","groupMappingId","groupMapping","xpathAttribute","controlId","getAllDocumentsDownloadUrl","getCaseNumber","isMobile","getCaseAssignees","getWorkitems","onlyUserWorkItems","getGridExportUrl","exportType","sendEmail","subject","selected","invalidatePageCache","getUsersList","getUsersListFromPreferences","getUsersListForStakeholders","getUsersForAssignation","getUsersForm","generateDataToSendByEmail","idUser","password","sendUserEmail","eMailTo","getConfiguration","getTemplate","forcePersonalizedColumns","templateType","templateGuid","isDefaultTemplate","hasStartForm","guidWFClass","getStartForm","guidprocess","surrogatedKey","mappingstakeholders","cache","editActionForm","getActions","extendParams","ptags","pmaxitems","executeActions","pguidConstructor","pguidAction","getPolymorphicActions","serializePolymorphicActions","getParents","fillTree","child","hasConstructor","guidObject","guidConstructor","getEntityImage64","entity","getFilesDataForLayoutUploadControl","processUploadFile","verifyMobilePathToBase","formData","processData","batch","batchTimer","replicateServiceMethods","getService","proxyMethod","makeCircularDependenciesError","h_action","detectCircularDependencies","batchTimeout","tag","singleAction","resolveDependencies","reject","fire","rejectDeferreds","responses","finalResponse","THROW_ERROR","buildConditions","conditions","bGridDetected","bCheckEditability","operator","expressions","buildConditionOperator","sJsCondition","expression","simple","bGDetected","searchGridReferenceInCondition","buildSimpleCondition","complex","conditionsOperator","condition","sXpath","sArgument","ensureValueJs","ensureEditable","renderId","detectedArgumentType","detectConditionArgumentType","argumentType","buildXpath","boolean","argument","buildArgument","getRender","getRenderById","gridXpath","processGridXpath","remainingXpath","getColumn","renderType","isRelatedEntityRender","setSeconds","setMilliseconds","isEditable","showRenderNotFoundError","isVisible","visible","isParentVisible","evalGridXpath","evalXpath","gridColumn","cellValue","getCellCurrentValue","renderToEval","renders","getRenders","rendersToEval","bIsGrid","isFileUploaded","isValidEmail","isButtonPressed","pressed","isGridButtonPressed","arrGridXpath","isChanged","grep","onDeletedGridRow","rowDeleted","idMatches","showContainerNotFoundError","containerId","getCurrentDate","currentDate","matches","searchForGridReference","commands","command","searchForGridReferenceInCommand","bGridReferenceFound","searchGridReferenceInXpath","getGridControl","getControlCell","controller","validations","mainForm","enableDebug","validationBox","bizagi_notifications","expand","triggerGlobalHandler","itemIcon","minimized","clearEnabled","onNotificationClick","buildValidations","fnValidations","buildAllValidations","showErrorMessage","showErrorAlertDialog","showValidationMessage","showAlertMessage","showInfoMessage","itemAdditionalClass","performValidationFn","clearValidationMessages","validating","performValidations","countValidationMessages","hideValidationMessages","setValidationMessage","one","showValidationMessages","expandNotificationBox","autofocus","isExpandedNotificationBox","invalidElements","bRendersValid","validateRenders","bFormValid","triggerHandler","sJSCode","enabled","buildValidation","validationCommand","logError","sStatement","evalValidation","sJsValidation","gridReference","tokens","sGridStatement","bValid","forEach","showValidationMessageById","globalDependencies","initialCallFunctions","initialCallFunctionsDeferred","buildActions","internalSubmitActions","initialCallTimeout","initialCallIncrements","actionsHistory","period","processInternalSubmitAction","buildAction","isSummaryOrGlobalForm","typeForm","evalClientAction","serverCommand","elseCommands","isClientAction","dontExecute","hashes","executeOnlyClientActions","hashC","unbindActions","handle","refreshActions","newActions","_","dependencies","dependenciesId","dependencyAlreadyAdded","renderById","inArray","buildFunction","ev","changed","gridColumns","searchGridColumns","sJsAction","sJsElseAction","bAutomaticRestore","bCondition","queueAction","isServerCommand","buildCommand","buildRestoreCommand","elseCommand","commandType","isRecentAction","runAction","detectCommandArgumentType","controlType","ruleObj","guidRule","xpathContextRow","interfaceObj","guidInterface","connectorObj","restoreRender","originalProperties","textFormat","changeRenderBackground","changeRenderForeground","color","changeRenderVisibility","changeRenderEditability","changeRenderRequired","required","restoreContainer","changeContainerBackground","backgroundColor","changeContainerVisibility","toogleContainer","changeContainerEditability","isGridComponent","lenIndex","indexes","getIndexes","changeCellBackgroundColor","changeBackgroundColor","changeButtonBackground","getButton","changeCellColor","changeColor","changeButtonForeground","changeCellVisibility","renderingDeferred","changeVisibility","changeButtonVisibility","isValidRender","changeCellEditability","changeEditability","changeButtonEditability","removeAttr","triggerClick","changeCellRequired","changeRequired","changeRenderValue","fromAction","asyncRenderDeferred","setDisplayValue","changeRenderMinValue","changeCellMinValue","changeMinValue","changeRenderMaxValue","changeCellMaxValue","changeMaxValue","executeCalculatedField","runFormula","refreshContainer","def","internalQueue","refreshCell","submitFormData","submitRender","submitOnChange","cleanRenderData","cleanCellData","cleanData","changeActiveItem","setAsActiveContainer","changeFormButtonVisibility","findIndex","navigation","getNavigation","setNavigationButtons","isFloatingButtonsEnabled","changeFloatingButtonVisibility","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","ELEMENT_TYPE_COLUMN","renderFactory","dataService","resources","observableElement","disposed","initializeData","subscribers","getXpathContext","getPageCache","getElementType","resize","size","effect","eventType","getRenderedElement","getMode","getFormType","isReadyToSave","getCustomHandlers","off","disposeTime","isDisposed","errorType","validationController","beforeToRefresh","afterToRefresh","rendering","TYPE_QUERY_FORM","uniqueId","childrenHash","elements","createRenderElement","createContainerElement","createFormElement","originalElement","inlineEdit","retype","processDuplicateRender","registerRender","getElement","getElementsByType","clonedElement","isClone","cloneRender","internalRender","applyContainerDefaults","renderContainerHtml","postRenderContainer","renderContainer","isRendered","replaceTag","replaceChildrenTag","replaceChildrenHtml","executeChildrenPostRender","configureHandlers","applyPlaceHolderPolyfill","configureDesignView","configureLayoutView","config","placeHolderConfig","forceApply","Placeholders","childrenElements","childElement","postRenderElement","renderChildrenHtml","renderElement","collectRenderValues","renderValues","canBeSent","collectData","hasChanged","collectRenderValuesQueryForm","canBeSentQueryForm","collectDataQueryForm","getRendersByXpath","hasValidGrids","childrenPromises","getFocus","getCustomHandler","customHandlers","unregisterChildren","removeActions","currentContainer","triggerChildrenActions","always","refreshDesignContainer","triggerRenderChange","registerActions","actionController","unregisterRender","getChildById","getMenu","postRenderTimeout","maxRendersPerScreen","rendersExecuted","renderOptimization","startOptimization","stopOptimization","included","includedInResult","maxLength","valueFormat","isHidden","labelAlign","valueAlign","previousValue","calculateInitialLayoutProperties","displayType","getDefaultLabelAlign","getDefaultValueAlign","getRTLAlign","renderWidth","calculateRenderWidth","labelWidth","valueWidth","layoutType","renderTemplateName","renderTemplate","isFullRender","isExtendedText","isExtended","displayOptionClass","getDisplayOptionClass","labelAlignClass","getAlignClass","valueAlignClass","stringLabelWidth","stringValueWidth","printVersion","showFullRender","internalRenderControl","replaceControlHtml","renderControl","renderReadOnly","configureSubmitOnChange","isLabelFormat","executePostRender","_element","internalPostRender","getControl","emptyControlByAsyncRenderDeferred","processLayout","postRenderPrintVersion","postRenderReadOnly","performExecutionModeMethods","performDesignModeMethods","configureHandlersQueryForm","configureHandlersReadOnly","internalSetInitialValue","internalSetInitialValueFlag","inlineAdd","hasValue","isQueryForm","messageData","isQuery","columnEditable","bold","changeFontBold","italic","changeFontItalic","underline","changeFontUnderline","strikethru","changeFontStrikethru","changeFontSize","triggerEvents","checkRequired","changeRequiredLabel","triggerRenderValidate","validateInputRetype","enableCheck","displayValue","getDisplayValue","getLabel","getControlFiller","validationMessage","readOnlyValue","changeDisplayOption","changeLabelAlign","alignType","changeValueAlign","customizeRenderWidth","getElementsToStylize","originalColor","currentStyle","getFormattingLabel","baseValue","defaultValue","compareValueObj","_findAction","targetObj","guidAction","objectValue","valuestrikethru","valueunderline","newFontSize","emptyControlByChangeEditability","changeEditabilityCellControl","renderColumn","decorated","getDecorated","readyDeferred","onCellChange","labelElement","controlElement","controlFiller","currentElement","refreshDesignControl","clearDisplayValue","updateOriginalValue","queryValue","searchType","typeSearch","rangeQuery","newParameter","orderType","displayXpath","displayOnly","defaultControl","innerControl","align","submitOnChangexpathContext","addSubmitAction","bRefreshForm","notCollect","internalSubmitOnChange","getCacheIdCase","idCaseObject","getIdCase","getIdWorkitem","getidTask","getSessionId","backgroundImage","needBGPaint","background-color","background-image","startActionExecution","actionExecutionDeferred","endActionExecution","readyActionExecution","isFromCreatedRow","submitInvalidatePageCacheRequest","pageCacheToInvalidate","isDesignMode","isExecutionMode","preventDefaultForAnchorTag","processLabelLayout","processControlLayout","warm","$label","changeFontColor","changeTextDecoration","$control","$elements","textDecoration","postRenderSingle","configureHelpText","checkListGroup","contextEdition","renderEdition","postRenderEdit","setDisplayValueEdit","actualscroll","kendoTmpls","inputEdition","contexttmp","contextEdit","backActionCommon","scrollTo","actionSave","getContainerRender","getArrowContainer","arrow","getArrow","getContainerHelpText","containerHelpText","getContainerMessage","containerMessage","getContextEdit","dspType","excludeControls","renderSingle","setPlaceHolder","renderedElement","toggleClass","changeRequiredLabelByVal","before","changeRequiredControl","configureLabel","containerHelp","ele","rendersById","rendersByXpath","rendersByType","pageCacheId","displayAsReadOnly","userConfirmationMessage","hasRule","paramsRender","processPath","breadCrumb","allowValidateAndSaveAction","enableActionValidateAndSave","initializeButtons","originalProcessButton","processButton","isRoutingDisabled","applicationParent","isOfflineFormsV2Supported","caption","ordinal","nextWithoutValidations","back","createnewcase","save","routing","buildButtonStyle","useCustomButtons","unshift","setParam","listRendesByType","getRenderByType","listRendesByTypeLength","renderKey","listRender","getGridByColumn","grids","columnsIds","helptext","queryForm","globalForm","complexGatewayContainer","activeTransitions","processButtons","validation","checkboxLabel","transitionId","strStyle","getContextType","getEndPointAction","formtype","getButtons","stopImmediatePropagation","buttonProperties","lastActionButton","routingDisabled","propagateExternalEvents","processDefer","contains","preProcessButton","postProcessButton","setLoaderDeferred","loaderDeferred","deleteLoaderDeferred","isLoaderDeferredSet","useOrSetLoaderDeferred","getLoaderPromise","appendWaitForLoader","getAllTabs","getAllTabsLength","innerTabsLoading","needsUserConfirmation","showConfirmationBox","customHandler","validateForm","saveForm","collectRenderValuesForSubmit","deferredsToWait","deferreds","internalSubmitFormOffline","internalSubmitForm","checkWidgetsData","isComplexGatewayPainted","getLastActionButton","showMessageBox","offlineType","waitForOnlineResponse","online","tryPushResponsePromise","responsePromise","IdCase","caseNumber","CaseNumber","failHandler","offlineAction","animate","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","waitingDeferreds","prepareCheckpointAction","prepareCommitAction","getButtonAction","flowControlDeferred","bHasValidations","alertMessage","propertiesToDisplayMessages","validationToDisplayMessages","messages","modalError","sendRollbackAction","refreshForm","jqxhrList","abortAll","messageType","addValidationMessage","addErrorMessage","selectedTabs","getSelectedTabs","tabContainers","tabs","tabContainer","tab","waitingTemplate","waitingOverlay","waitingMessage","tmpl","isSharePoint","getSize","getOffset","min-height","min-width","getFocusedElement","setFocusedElement","errorJson","setSize","clearOnlyServer","cancelPreviousRequest","focusIdentifier","IdScope","objMessage","strMessage","connection","abort","buttonId","checkpointUrl","commitUrl","rollbackUrl","getFloatingButton","contextEvent","processTemplate","processedTemplate","g1","g2","layoutCollection","getCss","layoutguid","getContextEvent","withAddForm","withEditForm","allowDetail","keys","getKeys","inlineAddRecords","showPreview","drawControls","drawActions","drawControl","drawForms","drawPreview","templateItem","hasData","getTotalRows","getRow","getNextRow","getPreviousRow","getFirstRow","getLastRow","setPointer","isTherePendingInlineRow","addKey","newId","removeKey","navigationform","getParameters","submitAddRequest","addUrl","submitEditRequest","editUrl","submitDeleteRequest","deleteUrl","submitSaveRequest","saveUrl","dataFail","submitRollbackRequest","getRemoteData","dataUrl","validateControls","expandedIcon","getExpandedIcon","collapsedIcon","getCollapsedIcon","expandedClassIcon","bImmediate","loading","panel","renderResult","performSearch","searchParams","refreshResults","collectSearchValues","maxRows","deviceMaxRecordsExceeded","onSearchFinished","errorObject","submitArray","getCriteriaOperation","criteriaData","parseAdditionalProperties","tabItems","counter","tabOrientation","getActiveTab","loadOnDemand","containsFocusedElement","setActiveTab","selectedTab","renderTabContent","deferredActions","engine","templateEngine","autoGenerateData","selecttemplate","processPropertyValueArgs","tagslist","maxItems","processPropertyValueDataTmplArgs","defaultAllowActions","allowactions","isHorizontal","templatetype","executeActionImmediately","processPropertyValueExecuteAction","notifyExecution","actionName","templateDefined","actionManager","guidProcess","processStartForm","processActionFormCollection","processActionForm","addActionToQueue","actionsList","additionalXpath","idParentWorkitem","entityXpath","newValueActionsList","removeActionToQueue","controlValue","countSameActions","getPropertiesActionLaucher","actionsLaucher","getTagList","processPropertyValueExecuteConstructor","displayNamee","taglist","hasLocalData","enableTyping","complementData","isDependant","getParentCombo","valueControl","renderCombo","renderComboTemplate","dataPromise","getTemplateName","emptyValue","emptyLabelForCombo","getTemplateParams","unique","showEmpty","showCurrentData","getDummyData","remoteDataLoaded","recalculate","msgObj","auxMsg","combo","getSelectedValue","currentValue","parseAdditionalValues","newItem","bCurrentDataFound","emptyFound","dataValue","comboData","isExtraItem","escapeValue","mapValue","validateValue","translated","findDataValueById","showLetters","randomId","getDefaultAllowDecimals","numDecimals","setGroupDigits","colorizeOnNegative","dataTypeMinValue","calculateMinValue","dataTypeMaxValue","calculateMaxValue","numericInput","attachRetypeDouble","attachFormatCurrency","removeValidations","digitGroupSeparator","minValue","getMinValue","maxValue","getMaxValue","inputValue","inputLength","oldVal","isInvalidFormat","tempValue","messageToShow","isValidRenderMessage","executeFormatCurrencyPlugin","tmpData","clipboardData","totalVal","keydown","keyUnicode","formatTimeout","floatPart","currentPosition","character","regExp","validMessage","getDefaultGroupDigits","newValue","createTooltip","currentTitle","toolTipZindex","fullFormat","datePickerRegional","indexDateTimeSeparation","lastIndexOf","uppercaseDatePlaceholder","intHandler","isNow","dateControl","getDateControl","timeControl","getTimeControl","onChangeHandler","updatingTime","hasMaxLines","maxLines","regularExpressionExpression","regularExpressionMessage","regularExpression","isEmptyField","textarea","validationMessages","originalData","areThereEditableColumns","areThereTotalizedColumns","initProperties","enabledChecks","exclusiveChanges","originalEnabledChecks","groupBy","spliceRowData","isExclusive","columnRender","singleInstance","totalize","reverse","rowsPerPage","keyColumn","skipInitialLoad","allowFilter","groupSummary","groupText","groupCollapsed","groupOrder","formShowMode","addLabel","exportOptionsLabel","alreadySaved","overrideGetRemoteData","cellOverrides","changeOrderData","rowKey","reverseDataRows","removeRemainingColumns","numColumns","remainingColumns","getColumnType","getGridTemplate","applyTemplate","columnInitializers","initialize","spliceIndex","spliceRowDataVisible","spliceRowDataEditable","rowTemplate","buildCellXpathFilter","dataResp","collectGridChange","isPressed","configureColumnSubmitOnChange","keysToDelete","columnXpath","canColumnBeSent","columnExclusiveChanges","columnEnabledChecks","lengthEnabledChecks","cellOverride","getCellOverride","getCellValue","setError","changeCellProperties","saveGrid","changeColumnsEditability","saveInlineAddedRows","getDepthData","updateAffectedCellManually","canBeExported","hasErrors","newRows","getDataNewRows","merge","uniqueMessages","isValueValid","messagesLength","gridValidationMessage","setCellOverrides","len_v","newRecords","submitForGridChange","getEnabledChecks","cleanNewRecords","hasColorHeader","headerFormat","allowDinamiclabel","bindingValue","searchForms","advancedSearch","allowSuggest","allowTyping","allowClear","searchLength","enableLocalStorage","expireCache","submitVersion","h_contexttype","enableQuerySuggestBehavior","regexC","hideStatus","selectedValue","showDesignValidations","submitOnChangexpathContextRow","runButtonAction","$context","filesCount","horizontal","vertical","templateUri","useDefaultImage","getImage64","getImageUri","replaceMultiple","allowSendInMail","getValueFilesByData","dataFiles","valueAuxFiles","getDataFilesWithoutScope","valueResult","err","warn","files","getUploadXpath","indexHour","dateObj","formattedDateTime","showsymbol","currencySymbol","geolocation","allowUpdate","getCurrentPosition","succes_callback","getErrorMessage","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","performPrecision","latitude","longitude","toPrecision","allowFlip","flipped","leftData","rightData","processPropertyValue","flip","makeJsonBase","getColumnData","getRightAssociation","formatJson","associationData","leftId","association","isChecked","idRight","checked","removeElement","rightId","removeValue","addElement","leftXpath","rightXpath","leftFactName","rightFactName","maxFileSizeOfProperty","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","maxfiles","validExtensions","singleExtensions","defExtensions","haveFiles","noFiles","renderUploadItem","replaceFilesHtml","itemTemplate","getTemplateItemName","buildItemUrl","filename","deleteUploadItem","fileItem","buildAddParams","BIZAGI_SESSION_NAME","setRenderRequired","maxFiles","q_xpath","showMetadata","listControl","fileProperties","getFileExtension","isImage","lengthValues","renderFileLayout","productBuildToAbout","replaceItemHtml","metadataTemplate","metaData","ecm_ecmStatus","ecmStatus","ecm_isVisible","ecm_allowUpdateMetadata","allowUpdateMetadata","ecm_allowDelete","ecm_allowUpdateContent","allowUpdateContent","ecm_allowView","allowView","ecm_allowCheckOut","allowCheckOut","ecm_allowCancelCheckOut","allowCancelCheckOut","ecm_allowEdit","idFileUploads","extension","lockUploadItem","unlockUploadItem","letterOpened","getXpath","getContextXpath","maximized","likeButton","getFormLinkXpath","executeSubmitOnChange","submitCommitRequest","submitCheckpointRequest","submitDataRequest","dependants","parentCombo","initializingCascadingCombo","bindDependantCombo","configureReadOnlyHandlers","isInitialValue","deferredVisible","dependantCombo","onChangeFunction","refreshDependantCombo","focusDependant","cleanInput","isEventBinded","unbindDependantCombo","dependant","parentValue","inputCombo","parentLength","parentArray","configured","listSize","getDataValue","idToRemove","markAsChecked","some","found","canAddMoreItems","$tagsContainer","toArray","reduce","acc","getElementWidth","MORE_OPTION_WIDTH","styles","filterList","$container","stringContainer","stringToSearch","addSelectedElements","findItemById","hasSearchForm","removeLastElement","getListItems","isUserPreference","isAutoWidth","isAutoHeight","getTemplateItem","currentUser","buildItemUrlOffline","getFormParams","getOfflineImage","imageValue","saveImageOffline","blobPromise","isNative","media","getImagePath","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","reader","FileReader","onloadend","blob","readAsArrayBuffer","blobImage","operationType","saveOfflineImage","buildFullItemUrl","getFileDependencies","fileDependencies","renderUserfieldControl","extendedData","userEditableControl","getEditableControl","renderComplex","loadUserfieldReadOnly","userReadOnlyControl","getReadonlyControl","getReadonlyValue","setEditableValue","getEditableValue","propertyName","jqXHR","textStatus","errorThrown","getRenderElements","getServerResourceURL","userfieldGuid","getRenderValue","showDialog","initialParams","userfieldName","getUserfieldControl","isColumn","getControlXpathContext","getUserFieldInstance","replicateUserfieldMethods","userfieldInstance","decoratedClass","decorateRenders","columnVisible","showColumn","isReadonly","instanceDecoratedClass","applyOverrides","propertyOverrides","invalidElement","overrideDecoratedRenderProperties","renderSummary","setSurrogateKey","setDefaultValue","getCompositeValue","overrideProperties","getSortName","getAnyDecoratedInstance","getSortColumn","originalGetData","getDataForAllCells","findDataById","fetchingData","valueForGrid","tableCell","formattedDate","downloadalldocuments","allowGenerate","preRenderControl","downloadAllDocuments","documents","getControlHtml","renderDocumentsHtml","renderActionsHtml","noActivateButton","allowgenerate","activateButton","getDocumentXpath","renderDocumentItem","joined","buildAllDocumentsUrl","caseId","workitemId","htmlControl","updateControlForPrintMode","validateContainer","replaceActionsHtml","buttonExecuted","generateLink","isPropagationStopped","documentTemplateGenerate","showDocumentPreview","deleteDocumentTemplate","resolveDeleteDocumentTemplate","resolveDocumentTemplateGenerate","messageText","autoOpenDocuments","returnCssTypeFile","lenght","redrawDocuments","documentContainer","renderAllDocumentDownload","removeDeleteButton","startIndex","restOfWord","finishIndex","downloadAllDocumentsLink","getErrorTemplate","getTemplateDownload","getTemplateReadonly","setRanageControls","minControl","maxControl","$maxCanvas","$minCanvas","renderRangeControl","$canvas","defineRangeControl","dateMin","suscribe","observer","notify","dateMax","getRenderProperties","typeRangeControl","renderProperties","moneyMin","moneyMax","numberMin","numberMax","autoSaveEvents","newData","modalViewDidAppear","modalViewDidDisappear","selectedElement","saveBox","isStartForm","messageComplexGateway","errorComplexGateway","nonSupportedMethods","messageError","validateFeatureSupport","handler","saveButton","nextButton","view_container","getViewContainer","bindTouchEvents","touchMoveStart","targetTouches","currentPositionY","originalParams","isFormButtonsEnabled","undoRemoveLastSuscriber","error_obj","notifier","class_name","sticky","contentPanel","VISIBLE_TABS","suscribeMethods","checkPlusVisibility","tabItem","tabReadyDeferred","tabActiveDeferred","headerShow","headerHide","group","subscribeOnTouch","searchForm","resultsGrid","results","criteriaContainer","resultsContainer","searchFormParams","searchFormDeferred","renderSearchForm","createRenderContainer","getSearchContainerData","errorTemplate","getCommonTemplate","slideForm","loadSearchTab","currentSearchForm","containerGridResults","containerSearchCriteria","applyButtons","renderAddForm","addContainer","addFormParams","indicator","saveDataAddForm","currentAddForm","handleSearchFormZindex","refreshParams","mapping","setDisplayValueToControl","renderControlSearchForm","addForm","displayBottomButtons","searchFormContainer","searchFormToLoad","otherElements","isDefault","searchFormData","containerButtons","templateBtn","btnSearch","btnSelect","btnAdd","btnCancel","setSearchState","allowNew","virtual","renderEditionAddForm","kendoView","viewContainer","isAddForm","pane","modalViewDisplayed","slideFormParams","slideContainer","configureViewHandlers","goBack","renderSlideForm","formClass","onSave","containerParams","saveButtonLabel","cancelButtonLabel","error_message","actionLauncher","configureQueueVisibility","templateData","wrap","actionsContainer","configureTemplateHandlers","expr","FilterAction","subscribe","filters","multipleSelection","act","executeAction","showConfirmationDialog","slide","showSaveButton","savedData","editMode","renderParams","rewriteContextType","xpathContextWithKey","xpathContextWithoutKey","IdEntity","startForm","actionsToExecuteContainer","listOfActions","removeActionSelector","openActionSelector","extraParams","dataAction","actionsToExecuteTitle","htmlTemplate","calculateFilters","polymorphicLauncher","totalActions","lessActions","templateArguments","treeActionsList","getTreeItems","bindHandlers","level","templateTreeItem","$targetData","onActionClicked","pageCache","$target","extendedText","TEXTAREA_LINE_HEIGHT","calculateHeight","resolvedValue","newHeight","retypeDouble","numberScientificNotation","inputDisplay","attachFormatSientificNotation","scientificNotationNumber","scientificNotationNumberDisplay","outerHTML","numericIcon","DEFAULT_PROPERTIES","maxYearsToDisplay","inputControl","controlElements","defaultDateControl","getFormattedDate","minDateControl","maxDateControl","getTimeFormat","setFullYear","isValidMinMaxValue","mobiscroll","calendar","showScrollArrows","lang","languages","BIZAGI_LANGUAGE","inst","timeS","onSet","valueText","getVal","is24h","onBeforeShow","disableScroll","initializer","fullDateFormated","setHour","getFullFormatedDate","preprocessDateValue","isClearButton","currentTime","fullFormattedDate","setNewDateValue","fullDate","dateFromFormat","formatedFullDate","applyDateFormat","initIndexTime","endIndexTime","validateMinAndMaxValue","showMandatoryMessage","isMinValue","vValue","yesno","nValue","parsedValue","check","requiredElement","configureListHandlers","modalViewTemplate","modalView","configureModalViewHandlers","inputContainer","closeModalViewPromise","modalViewList","setModalViewDisplayValue","_value","$li","multiSelect","base","SEARCH_MIN_LENGTH","temporalElements","openModalView","onUnselectElement","onShowSelectedElements","valuesToShow","$listView","showFloatListView","datasource","$tagElements","modalListHandlers","$listContainer","addNewValuesToInput","tempArray","totalValues","elementTemplate","$ChildToAdd","viewMoreTemplate","$viewMore","$floatListContext","checkbox","addTemporalElement","closeFloatView","elementToRemove","$containerControl","$floatList","widthControl","my","at","of","collision","radio","selectedRadio","radioItem","cascadingCombo","ex","onComboChange","parentComboValue","initialValueSet","configureCombo","processComboData","showDisplayValue","inputSpan","comboValue","collectionnavigator","upload","QUALITY_PICTURE","LIMIT","EXTENSIONSIMG","EXTENSIONSFILE","EXTENSIONSVIDEO","EXTENSIONSAUDIO","allow_upload","checkExtensions","validOptions","video","nonSupportedExtension","uploadOptions","upload_options","checkImageFile","containerRender","itemAddfile","itIsMaxNumberFilesReached","fileAPISupported","buildUploadControl","addInteractions","fileInput","handlerUploadImage","appear","getImageResolutionItems","handlerResolutionUpload","dataFile","extensions","fullPath","checkMaxSizeFile","checkFileTypes","onUploadFileCompleted","statusText","checkMaxFiles","attachDeleteHandler","executeFormFailHandler","camera","getPicture","checkMaxSize","getFileDataInfo","fileData","modalResolutionUpload","buttonIndex","onFail","quality","sourceType","Camera","PictureSourceType","PHOTOLIBRARY","saveImage","CAMERA","mediaType","MediaType","PICTURE","destinationType","DestinationType","FILE_URI","correctOrientation","targetWidth","targetHeight","capture","captureVideo","dataVideo","checkMaxSizeVideo","saveVideo","limit","actionSelected","ResolutionType","ORIGINAL","getImageResolution","transformImageSize","editedImageURL","localUrl","base64Image","errorResponse","addParams","queueID","FileUploadOptions","fileKey","mimeType","uploadKey","uploadFile","uploadWrapper","actualFiles","audio","nonSupportedExtensionsArr","getUploadChoices","buildAddFileParams","FormData","itemsUpload","ecm","respString","holder","startWaiting","$button","stopWaiting","$inputFile","adjustUrl","filesLinkElements","closeAccordionSection","elementBase","tmpidElement","elementsEvent","lock","unlock","del","elementReference","panelMetadata","btnSave","addEventsEcm","removeEventsEcm","menuItem","metadata","slideUp","nTimeoutAccordionSection","setMobiscroll","slideDown","elementsToCheck","isInvalid","metadataelement","tmpElement","oldValue","description","idmetadata","actualValue","idMetadata","metadataValues","$input","valueDate","captureAudio","mediaFiles","audioUrl","localURL","saveAudio","Filename","dataAudio","enableVideo","enableAudio","enableImage","validateFileExtensions","nameArchivo","meta","metadataType","$arrayEcmControls","arrayItems","idfileupload","searchList","modalViewTemplates","inputTemplates","configureReadOnly","configureModalView","newElement","showResults","showNoResultsMessage","processRequest","suggestions","appendFoundItem","siblings","$newElement","lastElement","isModalViewContainer","li","defaultElement","req","finalValue","gridView","helpers","GRID_PAGE_SIZE","cellMetadata","getViewTemplate","view","View","stretch","scrollContent","contentElement","addRow","onFilterRow","columnFilter","buildColumnFilter","modalFilterTemplate","modalFilter","attachModalFilterHandlers","localstorage","buildColumns","showHeaders","cssIndex","tags","applyGridPlugin","fetchData","updateData","configureHeaderAndFooterFixed","attachScrollHandler","scrollLeft","tableLeft","scrollHeader","transformLeft","transform","webkitTransform","OTransform","transformTop","tbody","cols","colgroup","col","offsetWidth","tbodyLeftTable","footer","scrollContainer","buildColumnModel","currentGrid","scrollElement","gridDefaultSortBy","cellReady","rowSelected","rowUnselected","editRow","deleteRow","showFormDetails","pageRequested","sortRequested","triggerGridPluginHandler","getRowIndexByKey","showMore","getHeaderStyles","columnModel","columnLabel","dataReady","dataReadyDeferred","fetchTotalData","onTotalData","showTotals","originalEditable","parentPromise","dataservice","propertiesGridForm","addPage","idAsigned","enableEditSubmitRequest","hideLabel","argumentsGrid","formlink","formLink","actionSaveNewRow","actionCancel","actionCancelRow","_sendRelation","_getData","_InternalRenderLinkForm","editPage","hideSaveButton","resp","noAction","history","current","applyActionUpdateGrid","allRows","acum","columnsTotalizers","bizagi_grid_smartphone","isValidGrid","gridControlReady","showDetail","omitKeys","operationState","showTotal","sum","return_value","avg","formatTotalizedResult","bindRenderChange","isBinding","compositeValue","newid","disableProcessButons","argumentsfl","containerForm","executeSubmitShowDetailRequest","originalMethod","selfIntern","inlineAddPromise","inlineAddDeferred","rowLength","errorsMessage","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","SEARCH_DELAY","inputText","_simplySearch","hasMozillaHelpText","additionallabel","autoCompleteSearchResults","elemObject","itemautocomplete","wrapper","elementUl","searchItem","renderSearchItem","formSearchParams","itemId","addToSuggestions","alSuggestions","autocomplete","letter","fileprint","link","isValidValue","getFullyDecodedURI","linkEncode","encodeURI","linktarget","onCheckListGroupChange","addButton","newItemName","goalActivity","addEditButton","cancelEditButton","additionalElements","notifyLoadItems","resolvedItems","hasChanges","idActivity","itemsResolved","activityWork","activityFormTitle","activityDescription","prepareNewItem","contentHolder","deleteItem","itemPosition","selectItem","repaintControl","itemSelectedName","itemContent","addSelectedHandlers","addItem","guidItem","checkListHtml","refreshValue","layoutImage","success","getResponseHeader","byteArrayToBlob","imageUrl","URL","webkitURL","createObjectURL","idcase","idworkitem","contextxpath","layoutLink","proxy","onClickElement","navigateFromRender","reference","referenceType","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getHTMLFiles","$addImage","$deleteImage","resolutionUpload","imageAdd","imageDelete","resolutionButtonHandler","useCamera","coordinates","getBoundingClientRect","popoverOptions","CameraPopoverOptions","uploadFileCompleted","showAsyncImage","Image","onload","getContext","drawImage","toDataURL","baseParams","zoom","img","$preview","originalImageWidth","orgiginalDisplayType","_isRefreshForm","getFormLinkXpathContext","hasentryrule","openLink","resolveCheckpointRequest","openLinkRule","paintFormLink","rollbackForm","dataRuleResp","wiew_container","saveRecord","error_code","hideHeadersButtonEdit","hasexitrule","closeExitRule","resolveSubmitCommitRequest","parentXpathContext","cordinate","updateDisplayValue","onSuccess","coords","onError","columnData","dataAssociation","addEventControl","showDefaultContainer","defaultHeader","defaultContainer","contextElement","associateElement","dissociateElement","headers","contents","parentId","itemAdd","itemRemove","basicUserField","defaultUserField","controlName","originalGetControl","applyColumnStyles","cellIcon","isInlineRow","xpathPath","calculateValue","resolveValue","datepicker","getImageXpathContext","columnXpathSplit","nameFile","getECMXpathContext","h_xpath","simpleXpathArray","simpleXpath","clearOtherRows","rowsNumber","rowIndex","applyDocumentTemplatesFormat","documentList","previewTooltip","returnType","rangeDate","rangeMoney","rangeNumber","templates","loadOverrides","initAsyncStuff","loadTemplates","loadTemplate","templateDestination","templateService","resolvedTemplate","mobileform","formTemplate","usersForm","nestedForm","accordion","accordionItem","mobilegroup","mobiletext","layoutPlaceholder","layoutBoolean","entityTemplate","userfieldWrapper","getSearchRender","getQueryRender","getUser","activityCheckList","columnParams","exclusiveCheck","uploadecm","queryExtendedText","queryText","queryCheck","queryYesNo","queryNumber","queryMoney","queryDate","queryCombo","queryCascadingCombo","querySuggest","queryLabel","queryList","queryMultiSelect","querySearch","queryRadio","queryState","queryCaseState","queryProcess","querySearchUser","factory","enableMSF","resolvedRemplate","getGridTemplates","tmplIcons","enableCustomizations","getJavaScript","beta","execution_device","cachedFactory","getRenderFactory","print","getDataService","executionDeferred","deviceFactory","getFactory","unsubscribe","doc","ownerDocument","process","refreshing","pathProcess","lastWidth","lastHeight","resizeInPopUpHTML","configureRefresh","configureRouting","configureRenderError","configureResize","configureGlobalHandlers","enableE2EInterface","transformGridControl","processForm","getFailDeferred","jsonErrorMessage","BIZAGI_ORIENTATION","buttonsForm","fastEmpty","canvasParent","resizeTimeout","forceResize","triggerParams","heightActivitiFormContainer","renderForm","buttonContainer","heightButtonContainer","renderBehavior","heightCanvas"],"mappings":"CAeA,SAAWA,GACPA,EAAEC,OAAO,kBACLC,SACIC,GAAI,QACJC,WACAC,OAAQ,GACRC,SAAU,MACVC,aAAa,EACbC,UAAU,EACVC,eAAe,EACfC,QACAC,eACAC,WAAY,EACZC,YAAY,EACZC,MAAO,GACPC,cAAe,GACfC,aAAc,GACdC,gBAAgB,EAChBC,UACIC,KAAM,GACNC,QAAS,GACTC,MAAO,GACPC,WAAY,GACZC,OAAQ,GACRC,cAAe,GACfC,IAAK,GACLC,WAAY,GACZC,KAAM,GACNC,YAAa,GACbC,MAAO,GACPC,QAAS,GACTC,aAAc,GACdC,QAAS,GACTC,YAAa,IAEjBC,SACIC,KAAK,EACLC,MAAM,EACNC,QAAQ,EACRC,SAAS,EACTC,WAAW,EACXC,iBAAiB,EACjBC,iBAAiB,GAErBC,KAAM,aAKVC,MAAO,WACH,IAAIC,EAAOC,KACP3C,EAAU0C,EAAK1C,QACf4C,EAAUF,EAAKE,QAGnBF,EAAKG,KAAO,EACZH,EAAKI,WACLJ,EAAKK,UAAY,EACjBL,EAAKM,WAAa,EAClBN,EAAKlC,KAAOR,EAAQQ,KACpBkC,EAAKO,YAAc,EACnBP,EAAKQ,cACLR,EAAKd,WACLc,EAAKS,cACLT,EAAKU,eAAiBpD,EAAQoD,gBAAkBV,EAGhDA,EAAKW,iBACLX,EAAKY,gBACLZ,EAAKa,eAAiB,EACtBzD,EAAE0D,KAAKxD,EAAQE,QAAS,SAAUuD,EAAGpC,GAEjCA,EAAOqC,SAA8B,IAAhBrC,EAAU,KAAoBA,EAAOqC,IAC1DrC,EAAOsC,WAAkC,IAAlBtC,EAAY,MAAoBA,EAAOsC,MAAQtC,EAAOuC,KAC7EvC,EAAOjB,SAAW,MAClBiB,EAAOwC,aAAsC,IAApBxC,EAAc,QAAoBA,EAAOwC,QAAU,GAG5EnB,EAAKW,cAAchC,EAAOyC,OAASzC,EACnCqB,EAAKY,aAAajC,EAAOuC,MAAQvC,EAC7BA,EAAOqC,MACPhB,EAAKa,eAAiBlC,EAAOyC,SAKrC9D,EAAQG,OAASH,EAAQG,QAAUuC,EAAKW,cAAc,GAAGO,KACrDlB,EAAKY,aAAatD,EAAQG,QAC1BuC,EAAKY,aAAatD,EAAQG,QAAQC,SAAWJ,EAAQI,SAEjDsC,EAAKY,aAAatD,EAAQG,OAAO4D,MAAM,KAAK,MAC5CrB,EAAKY,aAAatD,EAAQG,OAAO4D,MAAM,KAAK,IAAI3D,SAAWJ,EAAQI,UAK3EwC,EAAQoB,SAAS,0BACjBpB,EAAQqB,KAAK,iBAAkBjE,EAAQC,IAGvCyC,EAAKwB,oBAGLxB,EAAKnC,cAAgBP,EAAQO,cAG7BmC,EAAKyB,cAAa,IAKtBA,aAAc,SAAUC,GACpB,IAAI1B,EAAOC,KAGX,GAFAyB,OAAuC,IAAlB,GAAgCA,EAE3B,cAAtB1B,EAAK1C,QAAQwC,WAAuD,IAAxBE,EAAK1C,QAAQG,OAA7D,CAKA,IAAIkE,EAAY,WACZ,IAAIzB,EAAUF,EAAKE,QACf5C,EAAU0C,EAAK1C,QAGnB0C,EAAK4B,eAAiB,KAEtB1B,EAAQ2B,OAAOzE,EAAE0E,SAASxE,EAAQgB,SAASE,WAG3CkD,EACA1B,EAAK4B,eAAiBG,WAAWJ,EAAW,KAE5CA,MAORK,WAAY,WACR,IAAIhC,EAAOC,KACPC,EAAUF,EAAKE,QAGfF,EAAK4B,iBACLK,aAAajC,EAAK4B,gBAClB5B,EAAK4B,eAAiB,MAI1B1B,EAAQgC,SAMZC,QAAS,SAAUrE,GACf,IAAIkC,EAAOC,KAGXD,EAAKlC,KAAOA,EACZkC,EAAKwB,oBAGLxB,EAAKoC,WAKTC,QAAS,WAIL,OAHWpC,KAGCnC,MAMhB0D,kBAAmB,WACf,IAAIxB,EAAOC,KACPzC,EAAUwC,EAAK1C,QAAQE,QACvBM,EAAOkC,EAAKlC,KAEhBC,eAEID,EAAKwE,MACLlF,EAAE0D,KAAKhD,EAAKwE,KAAM,SAAUvB,EAAGlC,GAC3B,IAAImC,EAEJ5D,EAAE0D,KAAKtD,EAAS,SAAU+E,EAAG5D,GACrBA,EAAOqC,MAAKA,EAAMnC,EAAI0D,MAE9BxE,YAAYiD,GAAOnC,IAG3BmB,EAAKjC,YAAcA,aAMvByE,WAAY,aAMZJ,QAAS,WACL,IAAIpC,EAAOC,KAGXD,EAAKyC,mBACLzC,EAAK0C,gBAGL1C,EAAKQ,cACLR,EAAK2C,QAMTC,eAAgB,SAAUC,GACtB,IAAI7C,EAAOC,KACP3C,EAAU0C,EAAK1C,QACf8B,EAAUY,EAAK8C,cAAc,WAG7B9C,EAAK+C,SACJ3D,GAGD9B,EAAQK,cAEJkF,EAEA7C,EAAKgD,mBAAmBH,IAIxBzD,EAAQ8C,QACR9C,EAAQyC,OAAO7B,EAAKiD,eAGpBjD,EAAKkD,kBAAkB9D,MAQnC4D,mBAAoB,SAAUH,GAC1B,IAAI7C,EAAOC,KAEPb,GADUY,EAAK1C,QACL0C,EAAK8C,cAAc,YAC7BK,EAAU,SAAU/D,EAASyD,GAC7B,IAAIO,EAAQhE,EAAQiE,GAAG,yCAA2CjE,EAAQkE,WAAalE,EAAQmE,KAAK,yCAAyCD,WAC7I,OAAOlG,EAAEgG,EAAMP,KAEf9D,EAAOoE,EAAQ/D,EAASyD,GAGxBlE,EAASqB,EAAKW,cAAckC,GAChC,IAAIlE,EAAOqC,IAAX,CAGA,IAAIwC,EAAOxD,EAAKyD,gBAAgB9E,GAChCI,EAAK2E,YAAYF,GAGjBzE,EAAOoE,EAAQ/D,EAASyD,GAGxB7C,EAAK2D,YAAYhF,EAAQ,UAAWI,GAAM,KAM9C6E,gBAAiB,SAAU5C,EAAK6B,EAAagB,GAC9B5D,KACFlC,YAAYiD,KADVf,KAEFlC,YAAYiD,GAAK6B,GAAegB,IAI7CC,0BAA2B,SAASjB,GAChC,IAAI7C,EAAOC,KACPD,EAAKjC,aACLX,EAAE0D,KAAKd,EAAKjC,YAAa,SAAUiD,GAC/BhB,EAAKjC,YAAYiD,GAAK6B,IAAe,KAQjDF,KAAM,WACF,IAAI3C,EAAOC,KACP3C,EAAU0C,EAAK1C,QACf4C,EAAUF,EAAKE,QAQnB,GALAF,EAAK+C,SAAU,EAGf/C,EAAKgC,aAEuB,QAAxB1E,EAAQyG,YAGR,IAAIP,EAAOpG,EAAE0E,SAASxE,EAAQgB,SAAS0F,SACnC/C,MAAO3D,EAAQY,MACfD,WAAYX,EAAQW,WACpBL,SAAUN,EAAQM,SAClBC,cAAemC,EAAKnC,cACpBoG,SAA4B,WAAjB3G,EAAQwC,YAKnB0D,EAAOpG,EAAE0E,SAASxE,EAAQgB,SAASC,MACnC0C,MAAO3D,EAAQY,MACfD,WAAYX,EAAQW,WACpBL,SAAUN,EAAQM,SAClBC,cAAemC,EAAKnC,cACpBoG,SAA4B,WAAjB3G,EAAQwC,OAmB3B,GAdA0D,EAAOxD,EAAKkE,UAAUV,GACtBxD,EAAKzB,KAAOnB,EAAEoG,GAAMW,SAASjE,GAG7BF,EAAKoE,WAAWpE,EAAKzB,MAEA,WAAjBjB,EAAQwC,OAERE,EAAKqE,kBAGLrE,EAAKsE,kBAGY,cAAjBhH,EAAQwC,MAAwBxC,EAAQe,eAAgB,CACxD,IAAIkG,EAAkBvE,EAAK8C,cAAc,SACrC0B,EAASpH,EAAE,QAASmH,GACpBE,EAASC,SAAStH,EAAE4C,EAAKU,gBAAgBiE,IAAI,eAAeC,QAAQ,UAAW,MAAQ,EAE3FJ,EAAOK,oBACHC,YAAaL,EAAS,EAAIA,EAAS,EAAIA,EACvC/D,eAAgBV,EAAKU,eACrBqE,OAAQ,IACRC,mBAAmB,IAEvBT,EAAgBU,KAAK,SAAU,WAC3BT,EAAOU,QAAQ,+BAKO,IAA1BlF,EAAKlC,KAAKwE,KAAK6C,QACfnF,EAAK8C,cAAc,SAASsC,OAC5BpF,EAAK8C,cAAc,SAASsC,OAC5BpF,EAAKqF,WAAW,UAAUD,OAC1BpF,EAAKqF,WAAW,QAAQD,OACxBpF,EAAK8C,cAAc,gBAAgBsC,OACnCpF,EAAK8C,cAAc,cAAcwC,SAGjCtF,EAAK8C,cAAc,SAASwC,OAC5BtF,EAAKqF,WAAW,UAAUC,OAC1BtF,EAAKqF,WAAW,QAAQC,OACxBtF,EAAK8C,cAAc,cAAcsC,OAE7B9H,EAAQgC,QAAQK,WAChBK,EAAK8C,cAAc,gBAAgBwC,OACnCtF,EAAK8C,cAAc,SAASsC,SAE5BpF,EAAK8C,cAAc,SAASwC,OAC5BtF,EAAK8C,cAAc,gBAAgBsC,QAGnC9H,EAAQgC,QAAQE,MAChBQ,EAAKqF,WAAW,QAAQC,OAGxBhI,EAAQgC,QAAQM,iBAAmBtC,EAAQgC,QAAQO,gBACnDG,EAAKqF,WAAW,4BAA4BC,OAE5CtF,EAAKqF,WAAW,4BAA4BV,IAAI,UAAW,SAMnE3E,EAAK+C,SAAU,GAGnBsB,gBAAiB,aAMjBH,UAAW,SAAUV,GACjB,IAAIxD,EAAOC,KACP3C,EAAU0C,EAAK1C,QAGfmB,EAAQrB,EAAE0E,SAASxE,EAAQgB,SAASG,OACpCd,YAAaL,EAAQK,YACrBQ,cAAeb,EAAQa,gBAEvBO,EAAatB,EAAE0E,SAASxE,EAAQgB,SAASI,YA+B7C,OA5BAD,EAAQuB,EAAKuF,gBAAgB9G,EAAO,UAAWuB,EAAKwF,cAGpD/G,EAAQuB,EAAKuF,gBAAgB9G,EAAO,OAAQuB,EAAKyF,YAG7CnI,EAAQK,cACRc,EAAQuB,EAAKuF,gBAAgB9G,EAAO,UAAWuB,EAAKiD,gBAIxDO,EAAOxD,EAAKuF,gBAAgB/B,EAAM,QAASxD,EAAK0F,aAGhDlC,EAAOxD,EAAKuF,gBAAgB/B,EAAM,UAAWxD,EAAK2F,eAGlDnC,EAAOxD,EAAKuF,gBAAgB/B,EAAM,oBAAqBxD,EAAK4F,yBAG5DpC,EAAOxD,EAAKuF,gBAAgB/B,EAAM,aAAcxD,EAAK6F,kBAGrDrC,EAAOxD,EAAKuF,gBAAgB/B,EAAM,eAAgBxD,EAAK8F,oBAGvDtC,EAAOxD,EAAKuF,gBAAgB/B,EAAM,QAAS/E,GAC3C+E,EAAOxD,EAAKuF,gBAAgB/B,EAAM,aAAc9E,IAMpDqH,aAAc,WAKV,IAJA,IACIvI,EADOyC,KACQ3C,QAAQE,QACvBC,EAFOwC,KAEO3C,QAAQG,OACtBsD,EAAI,EAAGoE,EAAS3H,EAAQ2H,OACrBpE,EAAIoE,GACP,GAAI1H,GAAUD,EAAQuD,KAAKG,KACvB,OAAO,EAGf,OAAO,GAMXsE,WAAY,WACR,IAAIxF,EAAOC,KACP3C,EAAU0C,EAAK1C,QAGfE,EAAU,GAqBd,OAnBAwC,EAAKgG,WAAahG,EAAK+F,eAEvB3I,EAAE0D,KAAKxD,EAAQE,QAAS,SAAUuD,EAAGpC,GAC7BqB,EAAK1C,QAAQU,WAAa,EACtB+C,GAAKf,EAAK1C,QAAQU,aAElBR,GAAWwC,EAAKiG,WAAWtH,IAI/BnB,GAAWwC,EAAKiG,WAAWtH,KAI/BqB,EAAK1C,QAAQU,WAAa,GAAKgC,EAAKkG,oBAEpC1I,GAAWwC,EAAKmG,qBAGb3I,GAMXyI,WAAY,SAAUtH,GAClB,IACIrB,EADO2C,KACQ3C,QAEf8I,EAAmBzH,EAAO0H,qBAC1BC,EAAWF,EAAiBG,SAAWH,EAAiBG,SAAW,GACnEnI,EAAgBd,EAAQc,aAAed,EAAQc,aAAaoI,OAAS,GAIzE,OAHApI,IAAkC,KAAjBA,EAAsB,gBAAkB,gBAAkBgI,EAAiBK,iBAAmBL,EAAiBK,iBAAmB,UAG5IrJ,EAAE0E,SAASxE,EAAQgB,SAASK,OAAQvB,EAAEsJ,UAAW/H,GACpDgI,MAAOhI,EAAOqC,IACd4F,WAAYjI,EAAOuC,OAAS5D,EAAQG,OAASkB,EAAOuC,OAAS5D,EAAQG,OAASkB,EAAOuC,OAAS5D,EAAQG,OAAO4D,MAAM,KAAK,KAXjHpB,KAW6H+F,YAAarH,EAAOuC,OAAS5D,EAAQG,OAAO4D,MAAM,KAAK,GAC3L3D,SAAUJ,EAAQuJ,UAClB1F,QAASxC,EAAOwC,SAAW,GAC3B2F,eAAgBR,EAChBS,kBAAmBzJ,EAAQc,aAAed,EAAQc,aAAa6C,MAAQ,GACvE7C,aAAcA,MAMtB+H,kBAAmB,WACf,IACI7I,EADO2C,KACQ3C,QAGnB,OAAOF,EAAE0E,SAASxE,EAAQgB,SAASM,gBAGvCkH,iBAAkB,WACd,IACIxI,EADO2C,KACQ3C,QAGnB,OAAOF,EAAE0E,SAASxE,EAAQgB,SAASa,eAMvCsG,SAAU,WACN,IAAIzF,EAAOC,KAGPqC,EAAO,GAKX,OAJAlF,EAAE0D,KAAKd,EAAKlC,KAAKwE,KAAM,SAAUvB,EAAGlC,GAChCyD,GAAQtC,EAAKgH,QAAQnI,KAGlByD,GAMX0E,QAAS,SAAUC,EAASC,GACxB,IAAIlH,EAAOC,KACP3C,EAAU0C,EAAK1C,QACf0D,EAAMiG,EAAQjH,EAAKa,gBACnBsG,EAASD,IAAY,EACrBE,EAAMC,KAAKC,MAAsB,IAAhBD,KAAKE,UACtB1I,EAAMzB,EAAE0E,SAASxE,EAAQgB,SAASO,KAClCmC,IAAKoG,EACLF,SAAUA,EACVM,YAAaxG,IAIboC,EAAQ,GAoBZ,OAnBAhG,EAAE0D,KAAKmG,EAAS,SAAUlG,EAAGhC,GACrBiB,EAAK1C,QAAQU,WAAa,EACtB+C,EAAIf,EAAK1C,QAAQU,WAAa,IAE9BoF,GAASpD,EAAKyH,SAAS1G,EAAGC,EAAKjC,EAAMoI,IAIzC/D,GAASpD,EAAKyH,SAAS1G,EAAGC,EAAKjC,EAAMoI,KAIzCnH,EAAK1C,QAAQU,WAAa,GAAKgC,EAAK0H,uBAEpCtE,GAASpD,EAAK2H,gBAAgB3H,EAAK1C,QAAQU,WAAa,IAI5Da,EAAMmB,EAAKuF,gBAAgB1G,EAAK,QAASuE,IAO7CH,YAAa,WACT,IAAIjD,EAAOC,KACP3C,EAAU0C,EAAK1C,QACfuB,EAAMzB,EAAE0E,SAASxE,EAAQgB,SAASc,SAClCgE,EAAQ,GAiBZ,OAdAhG,EAAE0D,KAAKxD,EAAQE,QAAS,SAAUuD,EAAGpC,GAC7BqB,EAAK1C,QAAQU,WAAa,EACtB+C,GAAKf,EAAK1C,QAAQU,aAElBoF,GAASpD,EAAKyD,gBAAgB9E,IAIlCyE,GAASpD,EAAKyD,gBAAgB9E,KAKtCE,EAAMmB,EAAKuF,gBAAgB1G,EAAK,gBAAiBuE,IAOrDK,gBAAiB,SAAU9E,GACvB,IAAIqB,EAAOC,KACP3C,EAAU0C,EAAK1C,QAEf8I,EAAmBzH,EAAO0H,qBAC1BuB,EAAYxB,EAAiByB,YAAczB,EAAiByB,YAAc,SAG1E9I,EAAO3B,EAAE0E,SAASxE,EAAQgB,SAASe,aACnCyI,OAAQnJ,EAAOmJ,SAAU,EACzBC,YAAapJ,EAAOoJ,YACpBH,UAAWA,IAGXI,EAAShI,EAAKiI,WAAWtJ,EAAQ,UAAWqB,EAAKkI,iBAAiBvJ,IAAS,GAuB/E,OAtBAqJ,EAAoBG,MAAVH,GAA0C,iBAAZ,EAAwBA,EAAOpD,QAAQ,eAAgB5E,EAAKkI,iBAAiBvJ,IAAWqJ,KAG5HA,EAAS,IAGmB,iBAAb,GAAyBA,EAAOI,KAExB,aAAnBJ,EAAOK,QAEPtJ,EAAOiB,EAAKuF,gBAAgBxG,EAAM,cAAeiB,EAAKsI,cAAcN,KAGpEjJ,EAAOiB,EAAKuF,gBAAgBxG,EAAM,cAAe,IACjDiB,EAAKS,WAAWO,IAAM,IAAM6B,aAAemF,GAK/CjJ,EAAOiB,EAAKuF,gBAAgBxG,EAAM,cAAeiJ,GAG9CjJ,GAMX0I,SAAU,SAAU5E,EAAa7B,EAAK6C,EAAOqD,GACzC,IAAIlH,EAAOC,KACP3C,EAAU0C,EAAK1C,QACnB4J,EAAWA,IAAY,EACvB,IAAIqB,EAAoB,GAGxB,IAAKvI,EAAKW,cAAckC,GACpB,MAAO,GAIPA,EAAc,IACd0F,EAAoBvI,EAAKW,cAAckC,GAAawD,kBAAoBrG,EAAKW,cAAckC,GAAawD,iBAAiBkC,mBAG7H,IAAInC,EAAmBpG,EAAKW,cAAckC,GAAawD,qBACnDC,EAAYF,EAAyB,SAAIA,EAAiBG,SAAW,GACrEqB,EAAYxB,EAAiByB,YAAczB,EAAiByB,YAAc,SAG1E9I,EAAO3B,EAAE0E,SAASxE,EAAQgB,SAASS,MACnC4H,MAAO3G,EAAKW,cAAckC,GAAa7B,IACvC8G,OAAQxK,EAAQE,QAAQqF,GAAaiF,SAAU,EAC/C7D,SAA4B,WAAjB3G,EAAQwC,KACnByI,kBAAmBA,EACnBzB,eAAgBR,EAChB/I,GAAID,EAAQE,QAAQqF,GAAawD,iBAAmB/I,EAAQE,QAAQqF,GAAawD,iBAAiB9I,QAAK4K,EACvGP,UAAWA,IAGXI,EAAShI,EAAKiI,WAAWjI,EAAKW,cAAckC,GAAc7B,EAAK6C,EAAOqD,GAqB1E,OApBKc,IACDA,EAAS,IAEmB,iBAAb,GAAyBA,EAAOI,KAExB,aAAnBJ,EAAOK,QAEPtJ,EAAOiB,EAAKuF,gBAAgBxG,EAAM,cAAeiB,EAAKsI,cAAcN,KAGpEjJ,EAAOiB,EAAKuF,gBAAgBxG,EAAM,cAAe,IACjDiB,EAAKS,WAAWO,EAAM,IAAM6B,GAAemF,GAK/CjJ,EAAOiB,EAAKuF,gBAAgBxG,EAAM,cAAeiJ,GAGrDhI,EAAKW,cAAckC,GAAmB,KAAIzF,EAAE2B,GACrCA,GAKXuJ,cAAe,SAAUE,GACrB,IAAIR,EAMJ,OAJAQ,EAAQJ,KAAK,SAAUtK,GACnBkK,EAASlK,IAGNkK,GAKXL,gBAAiB,SAAU9E,GACvB,IACIvF,EADO2C,KACQ3C,QAUnB,OAFWF,EAAE0E,SAASxE,EAAQgB,SAASU,cAO3CyJ,gBAAiB,aAMjBC,WAAY,aAMZhD,UAAW,WAMP,IALA,IAAI1F,EAAOC,KACP3C,EAAU0C,EAAK1C,QAGfqL,KACK5H,EAAI,EAAGA,GAAKf,EAAKlC,KAAK8K,MAAO7H,IAClC4H,EAAME,MACFC,OAAQ/H,EACRgI,OAAShI,GAAKf,EAAKlC,KAAKqC,OAKhC,OAAO/C,EAAE0E,SAASxE,EAAQgB,SAASW,OAC/BkB,KAAMH,EAAKlC,KAAKqC,KAChBwI,MAAOA,EACPK,QAAShJ,EAAKlC,KAAKkL,WAM3BrD,YAAa,WACT,IACIrI,EADO2C,KACQ3C,QACf2L,EAAW3L,EAAQ2L,aAEnBC,EAAa9L,EAAEsJ,OAAOpJ,EAAQgC,QAAS2J,GAE3C,OANWhJ,KAMFiG,kBAEuB,QAAxB5I,EAAQyG,YACD3G,EAAE0E,SAASxE,EAAQgB,SAAS6K,WAAYD,GAExC9L,EAAE0E,SAASxE,EAAQgB,SAASY,QAASgK,GAGzC,IAOftD,sBAAuB,WACnB,IACItI,EADO2C,KACQ3C,QACfgC,EAAUhC,EAAQgC,QAEtB2J,SAAW3L,EAAQ2L,aAEnB,IAAIC,EAAa9L,EAAEsJ,QACf9G,gBAAiBN,EAAQM,gBACzBC,gBAAiBP,EAAQO,iBAC1BoJ,UAEH,OAAO7L,EAAE0E,SAASxE,EAAQgB,SAAS8K,cAAeF,IAOtDrD,eAAgB,WACZ,IACIvI,EADO2C,KACQ3C,QAEnB,OAHW2C,KAGFyH,qBAEuB,QAAxBpK,EAAQyG,YACD3G,EAAE0E,SAASxE,EAAQgB,SAASQ,WAAWuK,IAAK/L,EAAQgC,SAEpDlC,EAAE0E,SAASxE,EAAQgB,SAASQ,WAAYxB,EAAQgC,SAGpD,IAMf8E,WAAY,WACR,IAAIpE,EAAOC,KACP3C,EAAU0C,EAAK1C,QAGfgF,EAAOtC,EAAK8C,cAAc,SAS9B,GARIR,GACAlF,EAAE0D,KAAKwB,EAAM,SAAUvB,EAAGlC,GACtBA,EAAMzB,EAAEyB,GACRmB,EAAKsJ,cAAczK,KAKvBvB,EAAQK,YAAa,CACrB,IAAIyB,EAAUY,EAAK8C,cAAc,WACjC9C,EAAKkD,kBAAkB9D,GAG3BY,EAAKuJ,gBAAgB,qBAMzBD,cAAe,SAAUzK,GACrB,IAAImB,EAAOC,KACPe,EAAMnC,EAAI0C,KAAK,qBACf2F,EAAWrI,EAAI0C,KAAK,gBACpB6B,EAAQvE,EAAIwE,GAAG,iCAAmCxE,EAAIyE,WAAazE,EAAI0E,KAAK,iCAAiCD,WAEjHlG,EAAE0D,KAAKsC,EAAO,SAAUrC,EAAGhC,GACvB,IAAIJ,EAASqB,EAAKW,cAAcI,GAChC,QAAqB,IAAVpC,IAAyBA,EAAOqC,IAA3C,CAGA,IAAIwI,EAAcxJ,EAAKS,WAAWO,EAAM,IAAMrC,EAAOyC,OACjDoI,EACApM,EAAEqM,KAAKD,GACFpB,KAAK,SAAU5E,IAEZzE,EAAO3B,EAAE2B,IACJ8C,OAAO2B,GACZxD,EAAK2D,YAAYhF,EAAQqC,EAAKjC,EAAMmI,KAG5ClH,EAAK2D,YAAYhF,EAAQqC,EAAK5D,EAAE2B,GAAOmI,OAQnDhE,kBAAmB,SAAU9D,GACzB,IAAIY,EAAOC,KACPmD,EAAQhE,EAAQiE,GAAG,yCAA2CjE,EAAQkE,WAAalE,EAAQmE,KAAK,yCAAyCD,WAE7IlG,EAAE0D,KAAKsC,EAAO,SAAUrC,EAAGhC,GACvB,IAAIJ,EAASqB,EAAKW,cAAcI,GAChC,IAAIpC,EAAOqC,IAAX,CAGA,IAAIwI,EAAcxJ,EAAKS,WAAWO,IAAM,IAAMrC,EAAOyC,OACjDoI,EACApM,EAAEqM,KAAKD,GACFpB,KAAK,SAAU5E,IAEZzE,EAAO3B,EAAE2B,IACJ8C,OAAO2B,GACZxD,EAAK2D,YAAYhF,EAAQ,UAAWI,GAAM,KAGlDiB,EAAK2D,YAAYhF,EAAQ,UAAWvB,EAAE2B,IAAO,OAQzDuF,eAAgB,aAGhBoF,mBAAoB,WAChBzJ,KAAK0J,kBAMTC,WAAY,SAAUzJ,GAClB,IAAIH,EAAOC,KACP4J,EAAcC,OAAO9J,EAAKlC,KAAKqC,MAC/ByI,EAAQ5I,EAAKlC,KAAK8K,MAClBmB,EAAU5J,EAGd,GAAa,aAATA,EAAqB,CACrB,KAAI0J,EAAc,GAGd,OAFAE,EAAUF,EAAc,EAOhC,GAAa,SAAT1J,EAAiB,CACjB,KAAI0J,EAAcjB,GAGd,OAFAmB,EAAUF,EAAc,EAOhC7J,EAAKyC,mBAGLzC,EAAKG,KAAO2J,OAAOC,GAGnB/J,EAAKgK,mBAMTC,QAAS,WAEL,OAAOhK,KAAKsJ,gBAAgB,YAMhC9L,OAAQ,SAAUoF,EAAanF,GAC3B,IACIJ,EADO2C,KACQ3C,QACfqB,EAFOsB,KAEOU,cAAckC,GAEhC,QAA8B,IAAnBvF,EAAQG,OACf,OAAO,OAIkB,IAAjBkB,EAAW,OAAmBA,EAAOuC,KAAOvC,EAAOsC,OAE3DvD,EADAiB,EAAOuC,MAAQ5D,EAAQG,OACZC,IAAkC,OAArBJ,EAAQuJ,UAAqB,OAAS,OAE1DlI,EAAOuC,MAAQ5D,EAAQG,OAAO4D,MAAM,KAAK,GAC9B3D,IAAiC,OAApBJ,EAAQI,SAAoB,OAAS,OAElDA,GAAYJ,EAAQI,SAKnCJ,EAAQG,OAAO4D,MAAM,KAAK8D,OAAS,GAC/B7H,EAAQG,OAAO4D,MAAM,KAAK,GAAM1C,EAAOuC,KACvC5D,EAAQG,OAASkB,EAAOuC,MAK5B5D,EAAQG,OAASkB,EAAOuC,UAG2B,IAA3CvC,EAAO0H,iBAA8B,gBAAyE,IAApD1H,EAAO0H,iBAAiB6D,KAAKC,QAAQ,YACvG7M,EAAQG,OAASkB,EAAOuC,KAAO,IAAMvC,EAAO0H,iBAAiB+D,eAGjE9M,EAAQ+M,WAAa1L,EACrBrB,EAAQI,SAAWA,EACnBJ,EAAQuJ,UAAYnJ,EArCTuC,KAwCNwC,mBAxCMxC,KA2CNqK,mBAMTC,UAAW,SAAUvJ,EAAKwG,GACtB,IAAIxH,EAAOC,KAEPD,EAAKO,aAAeS,GAEpBhB,EAAKwK,kBAGLxK,EAAKO,YAAc,EACnBP,EAAKyK,oBAAsB,IAEH,GAApBzK,EAAKO,aAELP,EAAKwK,kBAITxK,EAAKO,YAAcS,EACnBhB,EAAKyK,oBAAsBjD,EAG3BxH,EAAK0K,kBAObC,YAAa,WAGe,GAFb1K,KAEFM,cAFEN,KAIFuK,kBAJEvK,KAKFM,YAAc,EALZN,KAMFwK,oBAAsB,IAOnCvC,iBAAkB,SAAUvJ,GACxB,IAAIqB,EAAOC,KACP2K,EAAYjM,EAAOoJ,YAGvB3K,EAAE0D,KAAKd,EAAKlC,KAAKwE,KAAM,SAAUvB,EAAG8C,QACe,IAApC7D,EAAKlC,KAAKwE,KAAKvB,GAAGpC,EAAOyC,QAA6D,MAAnCpB,EAAKlC,KAAKwE,KAAKvB,GAAGpC,EAAOyC,QAA0D,MAAxCzC,EAAO0H,iBAAiBwE,eAC7H7K,EAAKlC,KAAKwE,KAAKvB,GAAGpC,EAAOyC,OAASzC,EAAO0H,iBAAiBwE,gBAGlE,IACI7C,EADA8C,EAAe1N,EAAE2N,IAAI/K,EAAKlC,KAAKwE,KAAM,SAAUzD,EAAKkC,GAAK,OAAOlC,EAAIF,EAAOyC,SAI/E,GAA2B,GAAvB0J,EAAa3F,OAAa,OAAO,EAGrC,GAAkB,QAAdyF,EACA5C,EAAS,EACT5K,EAAE0D,KAAKgK,EAAc,SAAU/J,EAAG8C,GAAsB,MAATA,IAAemE,GAAU8B,OAAOjG,WAE5E,GAAkB,QAAd+G,EACP5C,EAAS8C,EAAa,IAAM,EAC5B1N,EAAE0D,KAAKgK,EAAc,SAAU/J,EAAG8C,GAAgC,iBAAZ,GAAiC,MAATA,GAAkBA,EAAQmE,IAASA,EAAS8B,OAAOjG,MAC7HmE,IAAWX,KAAK2D,QAAOhD,EAAS,WAEjC,GAAkB,QAAd4C,EACP5C,EAAS8C,EAAa,IAAM,EAC5B1N,EAAE0D,KAAKgK,EAAc,SAAU/J,EAAG8C,GAAgC,iBAAZ,GAAiC,MAATA,GAAkBA,EAAQmE,IAASA,EAAS8B,OAAOjG,MAC7HmE,IAAWX,KAAK4D,QAAOjD,EAAS,WAEjC,GAAkB,QAAd4C,EACP5C,EAAS,EACT5K,EAAE0D,KAAKgK,EAAc,SAAU/J,EAAG8C,GAAsB,MAATA,IAAemE,GAAU8B,OAAOjG,MAC/EmE,GAAkB8C,EAAa3F,YAE5B,GAAkB,UAAdyF,EAIP,IAHA5C,EAAS,EACT8C,EAAe9K,EAAKlC,KAAKwE,KAEpBvB,EAAI,EAAGA,EAAI+J,EAAa3F,OAAQpE,IAAK,CACtC,IAAImK,EAAcJ,EAAa/J,GAAGpC,EAAOyC,OAErC8J,aAAuBC,OAASD,EAAY/F,OAAS,EACrD6C,GAAU,EAEHkD,aAAuBC,OAA0B,OAAhBD,GAAwC,KAAhBA,IAChElD,GAAU,GAItB,OAAOA,GAMXoD,cAAe,SAAUC,EAAQC,GAC7B,IAAItL,EAAOC,KAEPe,EAAMsK,GAAUA,EAAOtK,IAAMsK,EAAOtK,IAAMhB,EAAKyK,oBACpC,SAAXY,GACArL,EAAKuL,UAAUvK,GAEJ,WAAXqK,GACArL,EAAKwL,YAAYxK,GAEN,SAAXqK,GACArL,EAAKyL,WAAWzK,GAEL,YAAXqK,GACArL,EAAK0L,cAAc1K,GAER,QAAXqK,GACArL,EAAK2L,WAGM,6BAAXN,GACArL,EAAK4L,2BAMb5B,gBAAiB,WAOb,OANW/J,KAGNwB,eAHMxB,KAMCsJ,gBAAgB,gBANjBtJ,KAMuC4L,4BAKtDvB,gBAAiB,WAOb,OANWrK,KAGNwB,eAHMxB,KAMCsJ,gBAAgB,gBANjBtJ,KAMuC4L,4BAKtDnB,cAAe,WAGX,OAFWzK,KAECsJ,gBAAgB,eAAiBvI,IAFlCf,KAE4CwK,uBAK3DD,gBAAiB,WAEb,OADWvK,KACCsJ,gBAAgB,iBAAmBvI,IADpCf,KAC8CwK,uBAM7DqB,eAAgB,WAEZ,OADW7L,KACCsJ,gBAAgB,wBAIhCI,eAAgB,WAEZ,OADW1J,KACCsJ,gBAAgB,YAAcvI,IAD/Bf,KACyCwK,uBAMxDxC,WAAY,SAAUtJ,EAAQqC,EAAK6C,EAAOqD,GAEtC,OADWjH,KACCsJ,gBAAgB,YACxB5K,OAAQA,EACRqC,IAAKA,EACL6C,MAAOA,EACPqD,SAAUA,KAMlBvD,YAAa,SAAUhF,EAAQqC,EAAKjC,EAAMmI,GAEtC,OADWjH,KACCsJ,gBAAgB,aACxB5K,OAAQA,EACRqC,IAAKA,EACLjC,KAAMA,EACNmI,SAAUA,KAOlB6E,cAAe,aAMfC,kBAAmB,aAMnBL,SAAU,WAEN,OADW1L,KACCsJ,gBAAgB,WAKhCgC,UAAW,SAAUvK,GAEjB,OADWf,KACCsJ,gBAAgB,WAAavI,IAAKA,KAKlDwK,YAAa,SAAUxK,GAEnB,OADWf,KACCsJ,gBAAgB,aAAevI,IAAKA,KAKpDyK,WAAY,SAAUzK,GAElB,OADWf,KACCsJ,gBAAgB,YAAcvI,IAAKA,KAKnD0K,cAAe,SAAU1K,GAErB,OADWf,KACCsJ,gBAAgB,mBAAqBvI,IAAKA,KAK1D4K,wBAAyB,WAErB,OADW3L,KACCsJ,gBAAgB,0BAMhChE,gBAAiB,SAAU/B,EAAMtD,EAAS0E,GACtC,OAAOpB,EAAKoB,QAAQ,aAAe1E,EAAU,KAAM0E,IAMvDiH,wBAAyB,WACrB,IACIvO,EADO2C,KACQ3C,QACf+M,EAAoClC,MAAtB7K,EAAQ+M,WAA2B/M,EAAQ+M,WAAWjJ,MAAQ,EAChF,OACIjB,KAJOF,KAIIE,KACX1C,OAAQH,EAAQG,OAChBC,SAAUJ,EAAQuJ,UAClBoF,gBAAiB5B,IAMzBd,gBAAiB,SAAUW,EAAMpM,GAC7B,IAAIoO,EAAWjM,KAAK3C,QAAQ4M,GAC5B,OAAKgC,EAGEA,EAASC,KAAKlM,KAAKC,QAAQ,GAAIpC,GAF3B,MAOfgF,cAAe,SAAUsJ,GACrB,IACIlM,EADOD,KACQC,QACnB,IAFWD,KAEDO,WAAW4L,GAAY,CAC7B,IAAIC,EAAiBjP,EAAE,0BAA4BgP,EAAY,IAAKlM,GAC9C,MAAlBmM,GAA0BA,EAAelH,OAAS,IAJ/ClF,KAKEO,WAAW4L,GAAaC,GAGrC,OARWpM,KAQCO,WAAW4L,IAK3B/G,WAAY,SAAUiH,GAClB,IACIpM,EADOD,KACQC,QAGnB,OAJWD,KAEDf,QAAQoN,KAFPrM,KAGFf,QAAQoN,GAAUlP,EAAE,gBAAkBkP,EAAS,IAAKpM,IAHlDD,KAICf,QAAQoN,IAKxB7J,iBAAkB,WACHxC,KACNO,eAKTkC,cAAe,WACAzC,KACNf,YAKTgH,gBAAiB,WACb,OAAO,GAKXwB,mBAAoB,WAChB,OAAO,KA31CnB,CA+1CG6E,QCl2CH,SAAWnP,GACPA,EAAEC,OAAO,4BAA6BD,EAAEoP,GAAGC,aAKvCnI,eAAgB,WACZ,IAAItE,EAAOC,KAGPhB,EAAQe,EAAK8C,cAAc,SAkB/B,GAjBA7D,EAAMyN,GAAG,QAAS,iBAAkB,WAChC,IAAIC,EAAavP,EAAE6C,MAAMsB,KAAK,oBAC1BoL,GAAc3M,EAAKiK,WACnBjK,EAAK4J,WAAW+C,KAIxB1N,EAAMyN,GAAG,SAAU,QAAS,WACxB,IAAIvM,EAAOF,KAAK4D,MAChB,GAAI1D,GAAQH,EAAKiK,UAAW,CACxB,IAAI2C,EAAS3M,KACbD,EAAK4J,WAAWzJ,EAAiB,aAAyB,WACtDyM,EAAO/I,MAAQ7D,EAAKG,UAKKgI,MAAjCnI,EAAK8C,cAAc,WAAyB,CAC5C,IAAI+J,KACA7M,EAAK1C,QAAQgC,QAAQC,KACrBsN,EAAMhE,MACF3H,KAAM4L,OAAOC,aAAaC,YAAY,yBACtCC,GAAI,WACAjN,EAAKoL,cAAc,OACnBpL,EAAK2K,iBAKb3K,EAAK1C,QAAQgC,QAAQ4N,cACrBL,EAAMhE,MACF3H,KAAM,YACN+L,GAAI,WACAjN,EAAKmN,eAKjBnN,EAAK8C,cAAc,WAAWS,KAAK,eAAe6J,cAAeP,MAAOA,IAI5E,IAAIQ,EAAerN,EAAK8C,cAAc,cAClCuK,GACAA,EAAaX,GAAG,QAAS,gBAAiB,WACtC1M,EAAKoL,cAAchO,EAAE6C,MAAMsB,KAAK,sBAO5C4L,UAAW,WACIlN,KACN3C,QAAQgQ,aAMjB3K,KAAM,WACF,IAAI3C,EAAOC,KACXD,EAAKuN,SACL,IAAIC,EAAkBxN,EAAK1C,QAAQgC,QAAQ6N,UAC3C,GAA6B,GAAzBnN,EAAKlC,KAAKwE,KAAK6C,OAAa,CAC5B,IAAIrG,EAAckB,EAAK8C,cAAc,cACjChE,GACAA,EAAWsG,OAEfpF,EAAKE,QAAQoB,SAAS,yBAGtBkM,SACqC,IAA1BxN,EAAKyN,mBAAqCX,OAAOY,KAAKC,cAAc3N,EAAKyN,oBAChFzN,EAAKyN,kBAAkB3P,KAAK,0BAA0B8P,UAG1D5N,EAAKyN,kBAAoBzN,EAAKE,QAAQqD,KAAK,6BAA6BsK,0BAI5Ef,OAAOY,KAAKI,WAAWC,eAG3B/G,QAAS,SAAUC,EAASC,GAExB,OADAjH,KAAKwK,oBAAsBxD,EAAQhH,KAAKY,gBACjCZ,KAAKsN,OAAOtG,EAASC,IAGhC0C,WAAY,SAAUzJ,EAAM6N,EAAkBC,GAC1C,IACIpE,EAAcC,OADP7J,KACmBnC,KAAKqC,MAE/ByI,EAHO3I,KAGMnC,KAAKkL,QAClBe,EAAU5J,EAGd,GAAY,YAARA,EAAoB,CACpB,KAAI0J,EAAc,GAGd,YADIoE,GAAeA,KAFFlE,EAAUF,EAAc,EAOjD,GAAY,QAAR1J,EAAgB,CAChB,KAAI0J,EAAcjB,GAGd,YADIqF,GAAeA,KAFElE,EAAUF,EAAc,EAOrD,GAAa,SAAT1J,GAA4B,aAATA,GAAuC,iBAATA,EAAmB,CACpE,IACI4J,EAAUD,OAAO3J,GAErB,MAAO+N,GAEH,YADID,GAAeA,KAGvB,GAAeE,KAAXpE,GAAkBA,EAAUnB,GAASmB,EAAU,EAE/C,YADIkE,GAAeA,KAM3BnB,OAAOY,KAAKI,WAAWrM,eACvBM,WAAW,WACP+K,OAAOY,KAAKI,WAAWC,eACxB,KAzCQ9N,KA4CNE,KAAO2J,OAAOC,GA5CR9J,KA+CN+J,kBACDgE,GACAA,KAORtD,cAAe,WAGXtN,EAAEoP,GAAGC,YAAY2B,UAAU1D,cAAc2D,MAF9BpO,KAE0CqO,YAMzD9D,gBAAiB,WAGbpN,EAAEoP,GAAGC,YAAY2B,UAAU5D,gBAAgB6D,MAFhCpO,KAE4CqO,YAM3DpI,gBAAiB,WACb,IACI5G,EADOW,KACQ3C,QAAQgC,QAC3B,OAAOA,EAAa,KAAKA,EAAc,MAAKA,EAAgB,QAAMA,EAAiB,SAMvFoI,mBAAoB,WAChB,IACIpI,EADOW,KACQ3C,QAAQgC,QAC3B,OAAOA,EAAc,MAAKA,EAAgB,QAM9CiP,cAAe,WACX,IACIjM,EADOrC,KACK6C,cAAc,QAAQS,KAAK,kBAC3C,OAAOnG,EAAE2N,IAAIzI,EAAM,SAAUzD,EAAKkC,GAC9B,OAAO3D,EAAEyB,GAAKf,KAAK,mBAQ3B0Q,gBAAiB,aAMjBC,gBAAiB,aAWjBlJ,gBAAiB,SAAU/B,EAAMtD,EAAS0E,GACtC,OAAOpB,EAAKoB,QAAQ,IAAI8J,OAAO,aAAexO,EAAU,KAAM,KAAM0E,IAQxE+J,YAAa,SAAUnH,GACnB,IACI3I,EADOoB,KACI6C,cAAc,QAE7B,SAAIjE,IACA2I,EAAc3I,EAAI0E,KAAK,uBAAyBiE,EAAc,OAC1DpK,EAAEoK,GAAa1J,KAAK,gBA7OxC,CAqPGyO,QCzPHO,OAA8B,oBAAb,OAA4BA,UAC7CA,OAAOY,UAAiC,IAAjBZ,OAAW,KAAqBA,OAAOY,QAC9DZ,OAAO8B,aAAuC,IAApB9B,OAAc,QAAqBA,OAAO8B,WACpE9B,OAAOY,KAAKI,gBAAkD,IAA5BhB,OAAOY,KAAe,WAAqBZ,OAAOY,KAAKI,cACzFhB,OAAOY,KAAKmB,YAA0C,IAAxB/B,OAAOY,KAAW,OAAqBZ,OAAOY,KAAKmB,UAEjF,IAAIC,WA6zFJ,SAASC,OAAOC,GACZ,IAAqDC,EAAjDC,EAAO/D,MAAMiD,UAAUe,MAAMhD,KAAKmC,UAAW,GACjD,OAAOU,EAAIpK,QAAQ,aAAc,SAAUwK,EAAGC,GAE1C,QAAYlH,KADZ8G,EAAMC,EAAKI,SAEP,OAAQD,EAAIE,WAAW,IACnB,KAAK,IACD,OAAQN,EACZ,KAAK,IACD,OAAO5H,KAAKmI,OAAOP,GACvB,KAAK,IACD,OAAOQ,OAAOR,GAClB,KAAK,IACD,OAAOA,EAGnB,OAAOI,IAsFf,SAASK,cACL,IAAI1P,EAAOC,KACP0P,KAEJ3P,EAAKT,IAAM,SAAU2M,GACjByD,EAAM9G,MAAO+G,WAAY1D,MAG7BlM,EAAK6P,YAAc,SAAU3D,GACzB,GAAoB,GAAhByD,EAAMxK,OACN,OAAOnF,EAAKT,IAAI2M,GAITyD,EAAMA,EAAMxK,OAAS,GAC3ByK,UAAU/G,KAAKqD,IAGxBlM,EAAK8P,QAAU,WAIX,IAHA,IAAIC,EAAU,IAAI3S,EAAE4S,SAChBxH,EAAUuH,EAAQvH,UAClByH,EAAcN,EAAMxK,OACfpE,EAAI,EAAGA,EAAIkP,EAAalP,IAC7ByH,EAAUA,EAAQ0H,KAAK,WACnB,IAAIhQ,EAAUyP,EAAML,QACpB,OAAOlS,EAAEqM,KAAK4E,MAAMjR,EAAGA,EAAE2N,IAAI7K,EAAQ0P,UAAW,SAAU1D,GAEtD,GAAyB,mBAAd,EAA0B,CACjC,IAAIiE,EAAW/S,EAAE4S,WAMjB,OALA5S,EAAEqM,KAAKyC,KAAY9D,KAAK,WACpB+H,EAASC,YACVC,KAAK,WACJF,EAASC,YAEND,EAAS3H,UAGpB,OAAO0D,OAWnB,OANA6D,EAAQK,UACR5H,EAAUA,EAAQJ,KAAK,WAEnBuH,QA98FZb,QAAQA,QAAiB,QAAI,GAAK,UAClCA,QAAQA,QAAoB,WAAI,GAAK,aACrCA,QAAQA,QAAgB,OAAI,GAAK,SAEjChC,OAAOwD,WAAaxB,QAKpB,SAAW1R,GACPA,EAAE6P,GAAGsD,WAAa,SAAUC,EAAItB,GAC5B,GAAwC,UAApC9R,EAAE6C,MAAM,GAAGwQ,QAAQC,cACnB,OAAO,KAEX,GAAgC,MAA5BtT,EAAE6C,MAAM,GAAG0Q,cACX,OAAO,KAEX,IAEIvT,EAAE6C,MAAM,GAAG0Q,cAAczB,KAAOA,EAClC,MAAOhB,GAEL,OAAO,KAGX,OAAI9Q,EAAEwT,QAAQC,KACHzT,EAAE6C,MAAM,GAAG0Q,cAAcG,WAAW,mEAAqEN,EAAGO,WAAa,0BACzH3T,EAAEwT,QAAQI,QAAU5T,EAAEwT,QAAQK,QAC9B7T,EAAE6C,MAAM,GAAG0Q,cAAcO,KAAK,uCAAyCV,EAAGO,WAAa,+BAD3F,GAlBf,CAsBGxE,QACH,SAAWnP,GACPA,EAAE6P,GAAGkE,gBAAkB,SAAUX,EAAItB,GAEjC,IAAIlP,EAAOC,KACX7C,EAAEgU,UAAUC,MAAM,WAEd,IAEIjU,EAAE4C,GAAM,GAAGkP,KAAOA,EACpB,MAAOhB,GAEL,OAAO,KAGX,OAAI9Q,EAAEwT,QAAQC,KACHzT,EAAE4C,GAAM,GAAG8Q,WAAW,mEAAqEN,EAAGO,WAAa,0BAC3G3T,EAAEwT,QAAQI,QAAU5T,EAAEwT,QAAQK,QAC9B7T,EAAE4C,GAAM,GAAGkR,KAAK,uCAAyCV,EAAGO,WAAa,+BAD7E,KAhBnB,CAsBGxE,QAiEAA,SA7D8B+E,oBAAoBlD,UAAUmD,mBAEvDD,oBAAoBlD,UAAUmD,iBAAmB,SAAUnC,GACvD,OAAOnP,KAAKuR,aAAapC,IAE7BkC,oBAAoBlD,UAAUqD,YAAc,SAAUC,EAAW7N,EAAO8N,GAGpE,GAFA1R,KAAK2R,aAAaF,EAAW7N,GAEb,KADZ8N,OAA8B,IAAZA,EAA0BA,EAAW,IACvC,CAEhB,IAAIE,EAAO,IAAInD,OAAOA,OAAOoD,OAAOJ,GAAa,YAAchD,OAAOoD,OAAOjO,GAAS,WAAY,OAClG5D,KAAK8R,QAAU9R,KAAK8R,QAAQnN,QAAQiN,EAAMH,EAAY,KAAO7N,EAAQ,KAAO8N,EAAW,OAI/FL,oBAAoBlD,UAAU4D,eAAiB,SAAU5C,GACrD,OAAOnP,KAAKgS,gBAAgB7C,IAGhCkC,oBAAoBlD,UAAU8D,oBAAsB,SAAUR,GAE1D,OADW,IAAIhD,OAAOA,OAAOoD,OAAOJ,GAAa,yCAA0C,OAC/ES,KAAKlS,KAAK8R,SAAW,YAAc,KAKvDrD,OAAOoD,OAAS,SAAUM,GACtB,OAAOA,EAAKxN,QAAQ,2BAA4B,SAIpD2H,OAAOU,GAAGoF,MAAQ,SAAUX,EAAW7N,EAAO8N,GAI1C,QAAmB,IAFR1R,KAAKqS,IAAI,GAEpB,CAIA,IAAID,EAAQpS,KAAKqS,IAAI,GAAGD,MAExB,QAAwB,IAAbX,EAiBP,OAAOW,EAhBP,QAAoB,IAATxO,EAYP,OAAOwO,EAAMd,iBAAiBG,GAV1BC,OAA8B,IAAZA,EAA0BA,EAAW,GAEvDU,EAAMZ,YACNY,EAAMZ,YAAYC,EAAW7N,EAAO8N,GAEpCU,EAAMT,aAAaF,EAAW7N,EAAO8N,KAkBtDpF,OAHCA,OAAOgG,MAAQ,SAAU1O,GACrB,OAAOA,EAAMe,QAAQ,2CAA4C,SAUtE2H,OAHCA,OAAOiG,MAAQ,SAAU3O,GACrB,OAAOA,EAAMe,QAAQ,cAAe,OAQ5C,SAAWxH,GACPmP,OAAOkG,sBAAwB,SAAUC,GACrC,IAAI1S,EAAO0S,EACPC,EAAa3S,EAAK2S,WAClB9O,EAAQ7D,EAAK4S,WACbC,EAAeF,EAAWG,cAC1B9K,GAAS,EAGb,QAAI5K,EAAE2V,mBAKyB,QAA3BL,EAAQC,WAAWzI,MAA6C,WAA3BwI,EAAQrB,QAAQhJ,YAIpD,QAAS,aAAc,OAAQ,YAAa,QAAS,aAAc,cAAgB2K,SAASL,EAAWzI,OAAS,oBAAoBiI,KAAKQ,EAAWzI,OACjJrG,QAA0BsE,IAAjBtE,EAAMsB,SACftB,EAAQA,EAAM,IACdgP,QAAwC1K,IAAxB0K,EAAa1N,SAC7B0N,EAAeA,EAAa,IAChChP,EAAQA,GAASA,EAAMtG,GAAKsG,EAAMtG,GAAKsG,EAEvCmE,GADA6K,EAAeA,GAAgBA,EAAatV,GAAKsV,EAAatV,GAAKsV,IACzChP,GAE1BmE,EAD0B,WAAnB2K,EAAWzI,MAAwC,gBAAnByI,EAAWzI,MAA6C,cAAnByI,EAAWzI,KAC7E4C,OAAOY,KAAKuF,aAAaJ,IAAiB/F,OAAOY,KAAKuF,aAAapP,GACnD,gBAAnB8O,EAAWzI,OAET,EACkB,SAApByI,EAAWzI,KACR,IAAIgJ,KAAKL,GAAcM,YAAgB,IAAID,KAAKrP,GAAOsP,UAEvDN,IAAiBhP,EAGxBmE,IArCf,CAuCGuE,QAEH,SAAWnP,GACPmP,OAAO6G,aAAe,WAClB,IAAIC,EAAMjW,EAAE,KACRkW,EAAY,EAUhB,OARAlW,EAAE0D,KAAKuS,EAAK,SAAUrS,EAAK6C,GACvB,IAAI0P,EAAS7O,SAAStH,EAAEyG,GAAOc,IAAI,YAC/B4O,EAASD,IACTA,EAAYC,EAAS,KAKtBD,GAbf,CAeG/G,QAKH,SAAWnP,GACPmP,OAAOiH,gBAAkB,SAAUC,GAC/B,IAAIC,EAAU,IAAIvI,MAElB/N,EAAEqW,GAAU3S,KAAK,WAGb1D,EAAE6C,MAAM0E,IAAI,aAAc,KAC1BvH,EAAE6C,MAAM0E,IAAI,aAAc,QAC1BvH,EAAE6C,MAAM0E,IAAI,SAAU,QAGtB+O,EAAQ7K,KAAKzL,EAAE6C,MAAM0T,iBAIzB,IAAI3I,EAAM3D,KAAK2D,IAAIqD,MAAMhH,KAAMqM,GAG/BtW,EAAEqW,GAAU3S,KAAK,WACb1D,EAAE6C,MAAM0E,IAAI,SAAUqG,EAAM,SApBxC,CAuBGuB,QAGHO,OAAOY,KAAKkG,SAAW,WACnB,IAAIC,EAAezW,EAAE4S,WAgBrB,MAbmC,YAA/BlD,OAAOY,KAAKoG,eACR1W,EAAEgU,UAAUtT,KAAK,aACjBV,EAAEgU,UAAUlM,QAAQ,aAAc2O,IAElCA,EAAazD,UAGbhT,EAAE2W,MAAM3W,EAAEgU,UAAU,GAAI,UAAU,cAAgBhU,EAAE2W,MAAM3W,EAAEgU,UAAU,GAAI,UAAU,aAAajM,OAAS,EAC1G/H,EAAEgU,UAAUlM,QAAQ,aAAc2O,IAElCA,EAAazD,UAGdyD,EAAarL,WAGxBsE,OAAOY,KAAKsG,2BACRzW,GAAI,uCACJ2D,KAAM,GACN+S,SAAU,GACVC,MAAO,GACPC,OAAQ,GACRC,QAAS,GACTC,cAAc,GAIlBvH,OAAOY,KAAK4G,sBAEZxH,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,OAAQC,SAAU,OAAOC,SAAU,OAAOC,YAAa,QAAQC,YAAc,UAAU,WAAW,QAAQ,QAAQ,MAAM,OAAO,OAAO,SAAS,YAAY,UAAU,WAAW,YAAaC,iBAAmB,MAAO,MAAO,MAAO,MAAO,MAAO,MAAM,MAAO,MAAO,MAAO,MAAO,MAAO,OAAQC,UAAY,SAAU,SAAU,UAAW,YAAa,WAAY,SAAU,YAAaC,eAAiB,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAAQC,aAAe,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAOC,WAAY,KAAKC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IAC/oBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,SAAUC,SAAU,YAAYC,SAAU,YAAYC,YAAa,MAAMC,YAAc,QAAQ,UAAU,QAAQ,QAAQ,OAAO,QAAQ,QAAQ,SAAS,aAAa,UAAU,YAAY,aAAcC,iBAAmB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,UAAY,UAAU,QAAQ,SAAS,YAAY,SAAS,UAAU,UAAWC,eAAiB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,aAAe,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAMC,WAAY,KAAKC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IAC3nBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,QAASC,SAAU,eAAeC,SAAU,eAAeC,YAAa,QAAQC,YAAc,QAAS,SAAU,OAAQ,QAAS,OAAQ,QAAQ,QAAS,QAAS,SAAU,SAAU,SAAU,UAAWC,iBAAmB,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,MAAOC,UAAY,QAAS,UAAW,WAAY,WAAY,SAAU,SAAU,SAAUC,eAAiB,MAAO,QAAS,SAAU,SAAU,OAAQ,OAAQ,OAAQC,aAAe,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAMC,WAAY,QAAQC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAKC,oBAAoB,EAAMC,WAAY,IACjpBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,SAAUC,SAAU,cAAcC,SAAU,gBAAgBC,YAAa,OAAOC,YAAc,QAAQ,OAAO,SAAS,QAAQ,SAAS,SAAS,WAAW,QAAQ,OAAO,QAAQ,WAAW,YAAaC,iBAAmB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,UAAY,SAAU,UAAW,QAAS,SAAU,UAAW,QAAS,UAAWC,eAAiB,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAOC,aAAe,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAOC,WAAY,MAAMC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IACpoBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,YAAaC,SAAU,eAAeC,SAAU,YAAYC,YAAa,QAAQC,YAAc,SAAS,UAAU,OAAO,QAAQ,MAAM,OAAO,OAAO,SAAS,YAAY,UAAU,WAAW,YAAaC,iBAAmB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,UAAY,UAAU,SAAS,WAAW,WAAW,aAAa,UAAU,WAAYC,eAAiB,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAOC,aAAe,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAOC,WAAY,KAAKC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IACpoBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,SAAUC,SAAU,YAAYC,SAAU,UAAUC,YAAa,cAAcC,YAAc,UAAW,UAAW,OAAQ,QAAS,MAAO,OAAO,UAAW,OAAQ,YAAa,UAAW,WAAY,YAAaC,iBAAmB,QAAS,QAAS,OAAQ,OAAQ,MAAO,OAAQ,QAAS,OAAQ,QAAS,OAAQ,OAAQ,QAASC,UAAY,WAAY,QAAS,QAAS,WAAY,QAAS,WAAY,UAAWC,eAAiB,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QAASC,aAAe,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAMC,WAAY,OAAOC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IACrrBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,SAAUC,SAAU,aAAaC,SAAU,aAAaC,YAAa,OAAOC,YAAc,UAAU,WAAW,QAAQ,SAAS,SAAS,SAAS,SAAS,SAAS,YAAY,UAAU,WAAW,YAAaC,iBAAmB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,UAAY,WAAW,SAAS,UAAU,YAAY,UAAU,UAAU,UAAWC,eAAiB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,aAAe,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAOC,WAAY,KAAKC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IAC9oBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,MAAOC,SAAU,UAAUC,SAAU,UAAUC,YAAa,KAAKC,YAAc,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,MAAM,OAAQC,iBAAmB,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,MAAM,OAAQC,UAAY,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,eAAiB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAMC,aAAe,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAMC,WAAY,IAAIC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAKC,WAAY,KAC/gBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,UAAWC,SAAU,IAAIC,SAAU,IAAIC,YAAa,UAAUC,YAAc,UAAW,WAAY,QAAS,QAAS,MAAO,OAAO,OAAQ,WAAY,YAAa,UAAW,WAAY,YAAaC,iBAAmB,MAAO,MAAO,MAAO,MAAO,MAAO,MAAM,MAAO,MAAO,MAAO,MAAO,MAAO,OAAQC,UAAY,SAAU,UAAW,UAAW,WAAY,YAAa,UAAW,YAAaC,eAAiB,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAAQC,aAAe,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAOC,WAAY,KAAKC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IAClqBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,SAAUC,SAAU,WAAWC,SAAU,WAAWC,YAAa,OAAOC,YAAc,UAAU,YAAY,QAAQ,QAAQ,OAAO,QAAQ,QAAQ,SAAS,WAAW,UAAU,WAAW,YAAaC,iBAAmB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,UAAW,UAAU,gBAAgB,cAAc,eAAe,eAAe,cAAc,UAAUC,eAAiB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,aAAe,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,WAAY,MAAMC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IACjqBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,UAAWC,SAAU,aAAaC,SAAU,aAAaC,YAAa,UAAUC,YAAc,SAAS,UAAU,OAAO,SAAS,MAAM,OAAO,OAAO,SAAS,WAAW,UAAU,SAAS,WAAYC,iBAAmB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,UAAY,cAAc,cAAc,UAAU,QAAQ,UAAU,UAAU,WAAYC,eAAiB,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,aAAe,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAOC,WAAY,MAAMC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAMC,WAAY,IAC1oBvI,OAAOY,KAAK4G,mBAAuB,IAAIC,UAAW,KAAMC,SAAU,WAAWC,SAAU,WAAWC,YAAa,KAAKC,YAAc,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,OAAQC,iBAAmB,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,OAAQC,UAAY,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAQC,eAAiB,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAOC,aAAe,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAMC,WAAY,IAAIC,WAAY,WAAWC,SAAU,EAAEC,OAAO,EAAMC,oBAAoB,EAAKC,WAAY,KAKrhBvI,OAAOY,KAAK4H,oBAAsBxI,OAAOY,KAAK4H,wBAC9CxI,OAAOY,KAAK4H,oBAAoBC,eAAiBnE,SAASoE,YAAY,SACtE1I,OAAOY,KAAK4H,oBAAoBC,eAAeE,UAAU,oBAAoB,GAAM,GAGnF3I,OAAOY,KAAK4H,oBAAoBI,YAActE,SAASoE,YAAY,SACnE1I,OAAOY,KAAK4H,oBAAoBI,YAAYD,UAAU,uBAAuB,GAAM,GACnF3I,OAAOY,KAAK4H,oBAAoBI,YAAYC,MAAQ,IAGpD7I,OAAOY,KAAK4H,oBAAoBM,UAAYxE,SAASoE,YAAY,SACjE1I,OAAOY,KAAK4H,oBAAoBM,UAAUH,UAAU,aAAa,GAAM,GACvE3I,OAAOY,KAAK4H,oBAAoBM,UAAUC,WAAa,GACvD/I,OAAOY,KAAK4H,oBAAoBM,UAAUE,WAAa,GAEvDhJ,OAAOY,KAAKqI,SAAW,SAAUC,GAC7BlJ,OAAOY,KAAK4H,oBAAoBM,UAAUE,WAAaE,EACvD,IAAIC,EAAmB7Y,EAAE4S,WACrBkG,EAAQ,EAEZ,IACIA,EAAQ9Y,EAAEgU,UAAU7N,KAAK,UAAU,GAAGoN,cAAcwF,SAASC,KAAKjM,QAAQ,gBAE9E,MAAO+D,GACHgI,GAAS,EAYb,OATKF,IAAelJ,OAAOuJ,WAAWC,QAAQjZ,OAAOkZ,iCAAmCP,IAAelJ,OAAOY,KAAK4H,oBAAoBM,UAAUC,aAC7IzY,EAAEgU,UAAU7N,KAAK,UAAU4B,OAAS,GAAM+Q,EAAQ,GAElDpJ,OAAOY,KAAK4H,oBAAoBM,UAAUY,gBAAkBP,EAC5D7E,SAASqF,cAAc3J,OAAOY,KAAK4H,oBAAoBM,YAEvDK,EAAiB7F,UAErBhT,EAAEqM,KAAKwM,GAAkB7N,KAAK,WAAc0E,OAAOY,KAAK4H,oBAAoBM,UAAUC,WAAaG,IAC5FC,EAAiBzN,WAQ5BsE,OAAOY,KAAKgJ,IAAM,SAAUC,GAGxB,IAAIC,EAAWA,GAAY,SAAUC,EAAGC,GAAK,IAAIC,KAAQC,EAAID,EAAEE,OAAUC,EAAI,aAAiBC,EAAIH,EAAEI,MAAS1Q,OAAQ,SAAU2Q,GAAKH,EAAE9I,UAAYnO,KAAM,IAAIqX,EAAI,IAAIJ,EAAwJ,OAArJG,GAAKC,EAAEC,MAAMF,GAAIC,EAAEE,eAAe,UAAYF,EAAEG,KAAO,WAAcH,EAAEI,OAAOD,KAAKpJ,MAAMpO,KAAMqO,aAAegJ,EAAEG,KAAKrJ,UAAYkJ,EAAGA,EAAEI,OAASzX,KAAaqX,GAAKK,OAAQ,WAAc,IAAIN,EAAIpX,KAAKyG,SAAsC,OAA5B2Q,EAAEI,KAAKpJ,MAAMgJ,EAAG/I,WAAmB+I,GAAKI,KAAM,aAAiBF,MAAO,SAAUF,GAAK,IAAK,IAAIC,KAAKD,EAAGA,EAAEG,eAAeF,KAAOrX,KAAKqX,GAAKD,EAAEC,IAAKD,EAAEG,eAAe,cAAgBvX,KAAK8Q,SAAWsG,EAAEtG,WAAa6G,MAAO,WAAc,OAAO3X,KAAKwX,KAAKrJ,UAAU1H,OAAOzG,QAAW4X,EAAIb,EAAEc,UAAYX,EAAEzQ,QAAS+Q,KAAM,SAAUJ,EAAGC,GAAKD,EAAIpX,KAAK8X,MAAQV,MAASpX,KAAK+X,SAA/rB,MAA0sBV,EAASA,EAAI,EAAID,EAAElS,QAAU4L,SAAU,SAAUsG,GAAK,OAAQA,GAAKY,GAAGC,UAAUjY,OAASkY,OAAQ,SAAUd,GAAK,IAAIC,EAAIrX,KAAK8X,MAAO3I,EAAIiI,EAAEU,MAAOxV,EAAItC,KAAK+X,SAAwC,GAA9BX,EAAIA,EAAEW,SAAU/X,KAAKmY,QAAa7V,EAAI,EAAG,IAAK,IAAI8V,EAAI,EAAGA,EAAIhB,EAAGgB,IAAKf,EAAE/U,EAAI8V,IAAM,KAAOjJ,EAAEiJ,IAAM,KAAO,GAAUA,EAAI,EAAT,EAAc,MAAQ,IAAW9V,EAAI8V,GAAK,EAAf,OAAwB,GAAI,MAAQjJ,EAAEjK,OAAQ,IAAKkT,EAAI,EAAGA,EAAIhB,EAAGgB,GAAK,EAAGf,EAAE/U,EAAI8V,IAAM,GAAKjJ,EAAEiJ,IAAM,QAASf,EAAEzO,KAAKwF,MAAMiJ,EAAGlI,GAAwB,OAApBnP,KAAK+X,UAAYX,EAAUpX,MAAQmY,MAAO,WAAc,IAAIf,EAAIpX,KAAK8X,MAAOT,EAAIrX,KAAK+X,SAAUX,EAAEC,IAAM,IAAM,YAAc,GAAUA,EAAI,EAAT,EAAaD,EAAElS,OAAS0R,EAAEyB,KAAKhB,EAAI,IAAMM,MAAO,WAAc,IAAIP,EAAIF,EAAES,MAAMzL,KAAKlM,MAAsC,OAA/BoX,EAAEU,MAAQ9X,KAAK8X,MAAM5I,MAAM,GAAWkI,GAAK9P,OAAQ,SAAU8P,GAAK,IAAK,IAAIC,KAAQlI,EAAI,EAAGA,EAAIiI,EAAGjI,GAAK,EAAGkI,EAAEzO,KAAK,WAAagO,EAAEtP,SAAW,GAAI,OAAO,IAAIsQ,EAAEJ,KAAKH,EAAGD,MAASkB,EAAIxB,EAAEyB,OAAUP,EAAIM,EAAEE,KAAQP,UAAW,SAAUb,GAAK,IAAIjI,EAAIiI,EAAEU,MAAOV,EAAIA,EAAEW,SAAU,IAAK,IAAIK,KAAQ9V,EAAI,EAAGA,EAAI8U,EAAG9U,IAAK,CAAE,IAAImW,EAAItJ,EAAE7M,IAAM,KAAO,GAAUA,EAAI,EAAT,EAAc,IAAK8V,EAAExP,MAAM6P,IAAM,GAAG3H,SAAS,KAAMsH,EAAExP,MAAU,GAAJ6P,GAAQ3H,SAAS,KAAO,OAAOsH,EAAEM,KAAK,KAAOC,MAAO,SAAUvB,GAAK,IAAK,IAAIjI,EAAIiI,EAAElS,OAAQkT,KAAQ9V,EAAI,EAAGA,EAAI6M,EAAG7M,GAAK,EAAG8V,EAAE9V,IAAM,IAAMmC,SAAS2S,EAAEwB,OAAOtW,EAAG,GAAI,KAAO,GAAUA,EAAI,EAAT,EAAa,OAAO,IAAIsV,EAAEJ,KAAKY,EAAGjJ,EAAI,KAAQA,EAAImJ,EAAEO,QAAWZ,UAAW,SAAUb,GAAK,IAAIjI,EAAIiI,EAAEU,MAAOV,EAAIA,EAAEW,SAAU,IAAK,IAAIK,KAAQ9V,EAAI,EAAGA,EAAI8U,EAAG9U,IAAK8V,EAAExP,KAAK4G,OAAOsJ,aAAa3J,EAAE7M,IAAM,KAAO,GAAUA,EAAI,EAAT,EAAc,MAAO,OAAO8V,EAAEM,KAAK,KAAOC,MAAO,SAAUvB,GAAK,IAAK,IAAIjI,EAAIiI,EAAElS,OAAQkT,KAAQ9V,EAAI,EAAGA,EAAI6M,EAAG7M,IAAK8V,EAAE9V,IAAM,KAAyB,IAAlB8U,EAAE9H,WAAWhN,KAAa,GAAUA,EAAI,EAAT,EAAa,OAAO,IAAIsV,EAAEJ,KAAKY,EAAGjJ,KAAQ4J,EAAIT,EAAEU,MAASf,UAAW,SAAUb,GAAK,IAAM,OAAO6B,mBAAmBpH,OAAO1C,EAAE8I,UAAUb,KAAO,MAAOgB,GAAK,MAAMc,MAAM,0BAA8BP,MAAO,SAAUvB,GAAK,OAAOjI,EAAEwJ,MAAMQ,SAASC,mBAAmBhC,OAAUgB,EAAIrB,EAAEsC,uBAAyBnC,EAAEzQ,QAAS6S,MAAO,WAActZ,KAAK8T,MAAQ,IAAI8D,EAAEJ,KAAMxX,KAAKuZ,YAAc,GAAKC,QAAS,SAAUpC,GAAK,iBAAmBA,IAAMA,EAAI2B,EAAEJ,MAAMvB,IAAKpX,KAAK8T,MAAMoE,OAAOd,GAAIpX,KAAKuZ,aAAenC,EAAEW,UAAY0B,SAAU,SAAUrC,GAAK,IAAIjI,EAAInP,KAAK8T,MAAOsE,EAAIjJ,EAAE2I,MAAOxV,EAAI6M,EAAE4I,SAAUU,EAAIzY,KAAK0Z,UAAW5C,EAAIxU,GAAK,EAAImW,GAAiG,GAAhCrB,GAA7DN,EAAIM,EAAIR,EAAEyB,KAAKvB,GAAKF,EAAE7L,KAAS,EAAJ+L,GAAS9W,KAAK2Z,eAAgB,IAAYlB,EAAGnW,EAAIsU,EAAE5L,IAAI,EAAIoM,EAAG9U,GAAQ8U,EAAG,CAAE,IAAK,IAAIL,EAAI,EAAGA,EAAIK,EAAGL,GAAK0B,EAAGzY,KAAK4Z,gBAAgBxB,EAAGrB,GAAIA,EAAIqB,EAAEyB,OAAO,EAAGzC,GAAIjI,EAAE4I,UAAYzV,EAAI,OAAO,IAAIsV,EAAEJ,KAAKT,EAAGzU,IAAMqV,MAAO,WAAc,IAAIP,EAAIF,EAAES,MAAMzL,KAAKlM,MAAqC,OAA9BoX,EAAEtD,MAAQ9T,KAAK8T,MAAM6D,QAAgBP,GAAKuC,eAAgB,IAAM5C,EAAE+C,OAAS1B,EAAE3R,QAASsT,IAAK7C,EAAEzQ,SAAU+Q,KAAM,SAAUJ,GAAKpX,KAAK+Z,IAAM/Z,KAAK+Z,IAAItT,OAAO2Q,GAAIpX,KAAKsZ,SAAWA,MAAO,WAAclB,EAAEkB,MAAMpN,KAAKlM,MAAOA,KAAKga,YAAcC,OAAQ,SAAU7C,GAAuC,OAAlCpX,KAAKwZ,QAAQpC,GAAIpX,KAAKyZ,WAAmBzZ,MAAQka,SAAU,SAAU9C,GAA2B,OAAtBA,GAAKpX,KAAKwZ,QAAQpC,GAAWpX,KAAKma,eAAiBT,UAAW,GAAIU,cAAe,SAAUhD,GAAK,OAAO,SAAUjI,EAAGiJ,GAAK,OAAO,IAAKhB,EAAEI,KAAKY,GAAI8B,SAAS/K,KAAQkL,kBAAmB,SAAUjD,GAAK,OAAO,SAAUjI,EAAGiJ,GAAK,OAAO,IAAKK,EAAE6B,KAAK9C,KAAKJ,EAAGgB,GAAI8B,SAAS/K,OAAW,IAAIsJ,EAAI3B,EAAEyD,QAAW,OAAOzD,EAArtH,CAAytH1P,MAEpvH,OAF2vH,SAAWwP,GAAK,SAASC,EAAE1H,EAAGsJ,EAAGrB,EAAGC,EAAGN,EAAGzU,EAAGwU,GAAuC,QAAlC3H,EAAIA,GAAKsJ,EAAIrB,GAAKqB,EAAIpB,GAAKN,EAAID,IAAgBxU,EAAI6M,IAAM,GAAK7M,GAAKmW,EAAI,SAAS3B,EAAE3H,EAAGsJ,EAAGrB,EAAGC,EAAGN,EAAGzU,EAAGwU,GAAuC,QAAlC3H,EAAIA,GAAKsJ,EAAIpB,EAAID,GAAKC,GAAKN,EAAID,IAAgBxU,EAAI6M,IAAM,GAAK7M,GAAKmW,EAAI,SAAS1B,EAAE5H,EAAGsJ,EAAGrB,EAAGC,EAAGN,EAAGzU,EAAGwU,GAAkC,QAA7B3H,EAAIA,GAAKsJ,EAAIrB,EAAIC,GAAKN,EAAID,IAAgBxU,EAAI6M,IAAM,GAAK7M,GAAKmW,EAAI,SAASxB,EAAE9H,EAAGsJ,EAAGrB,EAAGC,EAAGN,EAAGzU,EAAGwU,GAAqC,QAAhC3H,EAAIA,GAAKiI,GAAKqB,GAAKpB,IAAMN,EAAID,IAAgBxU,EAAI6M,IAAM,GAAK7M,GAAKmW,EAAI,IAAK,IAAIvB,EAAIP,EAAqB2B,GAAXV,EAAIV,EAAEF,KAAWa,UAAWG,EAAIJ,EAAEkC,OAAQlC,EAAIV,EAAEqD,KAAMpL,KAAQ4J,EAAI,EAAG,GAAKA,EAAGA,IAAK5J,EAAE4J,GAAK,WAAanC,EAAE4D,IAAI5D,EAAE6D,IAAI1B,EAAI,IAAM,EAAGnB,EAAIA,EAAE8C,IAAM1C,EAAEvR,QAASuT,SAAU,WAAcha,KAAK2a,MAAQ,IAAIrC,EAAEd,MAAM,WAAY,WAAY,WAAY,aAAeoC,gBAAiB,SAAUxB,EAAGK,GAAK,IAAK,IAAIrB,EAAI,EAAG,GAAKA,EAAGA,IAAK,CAAE,IAAewD,EAAIxC,EAAff,EAAIoB,EAAIrB,GAAagB,EAAEf,GAA2B,UAArBuD,GAAK,EAAIA,IAAM,IAAuC,YAArBA,GAAK,GAAKA,IAAM,GAAsBxD,EAAIpX,KAAK2a,MAAM7C,MAAnB,IAAuuE+C,EAAiC5M,EAA9uEoJ,EAAIe,EAAEK,EAAI,GAAkBnW,GAAdsY,EAAIxC,EAAEK,EAAI,GAAQL,EAAEK,EAAI,IAAIb,EAAIQ,EAAEK,EAAI,GAAIvB,EAAIkB,EAAEK,EAAI,GAAI7B,EAAIwB,EAAEK,EAAI,GAAIT,EAAII,EAAEK,EAAI,GAAIM,EAAIX,EAAEK,EAAI,GAAIH,EAAIF,EAAEK,EAAI,GAAIqC,EAAI1C,EAAEK,EAAI,GAAIsC,EAAI3C,EAAEK,EAAI,IAAKuC,EAAI5C,EAAEK,EAAI,IAAKwC,EAAI7C,EAAEK,EAAI,IAAKyC,EAAI9C,EAAEK,EAAI,IAAK0C,EAAI/C,EAAEK,EAAI,IAAK2C,EAAIhD,EAAEK,EAAI,IAAK4C,EAAIjE,EAAE,GAAmiEkE,EAAIrE,EAAvIqE,EAAIrE,EAAvIqE,EAAIrE,EAAvIqE,EAAIrE,EAAvIqE,EAAIvE,EAAvIuE,EAAIvE,EAAvIuE,EAAIvE,EAAvIuE,EAAIvE,EAAvIuE,EAAIxE,EAAtIwE,EAAIxE,EAAtIwE,EAAIxE,EAAtIwE,EAAIxE,EAAtIwE,EAAIzE,EAAvIyE,EAAIzE,EAApIyE,EAAIzE,EAAnIyE,EAAIzE,EAAjIyE,EAAIlE,EAAE,GAAuFnJ,EAAI4I,EAAvF5I,EAAImJ,EAAE,GAA6CyD,EAAIhE,EAA7CgE,EAAIzD,EAAE,GAAIiE,EAAIxE,EAAEwE,EAAGC,EAAGrN,EAAG4M,EAAGxD,EAAG,EAAGlI,EAAE,IAAiBmM,EAAGrN,EAAG2M,EAAG,GAAIzL,EAAE,IAAiBkM,EAAGC,EAAGhZ,EAAG,GAAI6M,EAAE,IAAiB0L,EAAGQ,EAAGzD,EAAG,GAAIzI,EAAE,IAAoElB,EAAI4I,EAAE5I,EAAtC4M,EAAIhE,EAAEgE,EAArCQ,EAAIxE,EAAEwE,EAAGC,EAAGrN,EAAG4M,EAAG3D,EAAG,EAAG/H,EAAE,IAAiBmM,EAAGrN,EAAG2I,EAAG,GAAIzH,EAAE,IAAiBkM,EAAGC,EAAGtD,EAAG,GAAI7I,EAAE,IAAiB0L,EAAGQ,EAAGtC,EAAG,GAAI5J,EAAE,IAAoElB,EAAI4I,EAAE5I,EAAtC4M,EAAIhE,EAAEgE,EAArCQ,EAAIxE,EAAEwE,EAAGC,EAAGrN,EAAG4M,EAAGvC,EAAG,EAAGnJ,EAAE,IAAiBmM,EAAGrN,EAAG6M,EAAG,GAAI3L,EAAE,IAAiBkM,EAAGC,EAAGP,EAAG,GAAI5L,EAAE,KAAkB0L,EAAGQ,EAAGL,EAAG,GAAI7L,EAAE,KAAuElB,EAAI4I,EAAE5I,EAAvC4M,EAAIhE,EAAEgE,EAAtCQ,EAAIxE,EAAEwE,EAAGC,EAAGrN,EAAG4M,EAAGI,EAAG,EAAG9L,EAAE,KAAkBmM,EAAGrN,EAAGiN,EAAG,GAAI/L,EAAE,KAAkBkM,EAAGC,EAAGH,EAAG,GAAIhM,EAAE,KAAkB0L,EAAGQ,EAAGD,EAAG,GAAIjM,EAAE,KAAsElB,EAAI6I,EAAE7I,EAAtC4M,EAAI/D,EAAE+D,EAAtCQ,EAAIvE,EAAEuE,EAAGC,EAAGrN,EAAG4M,EAAGD,EAAG,EAAGzL,EAAE,KAAkBmM,EAAGrN,EAAG+J,EAAG,EAAG7I,EAAE,KAAkBkM,EAAGC,EAAGN,EAAG,GAAI7L,EAAE,KAAkB0L,EAAGQ,EAAGhE,EAAG,GAAIlI,EAAE,KAAsElB,EAAI6I,EAAE7I,EAAtC4M,EAAI/D,EAAE+D,EAAtCQ,EAAIvE,EAAEuE,EAAGC,EAAGrN,EAAG4M,EAAGjE,EAAG,EAAGzH,EAAE,KAAkBmM,EAAGrN,EAAG8M,EAAG,EAAG5L,EAAE,KAAkBkM,EAAGC,EAAGF,EAAG,GAAIjM,EAAE,KAAkB0L,EAAGQ,EAAGnE,EAAG,GAAI/H,EAAE,KAAsElB,EAAI6I,EAAE7I,EAAtC4M,EAAI/D,EAAE+D,EAAtCQ,EAAIvE,EAAEuE,EAAGC,EAAGrN,EAAG4M,EAAGC,EAAG,EAAG3L,EAAE,KAAkBmM,EAAGrN,EAAGkN,EAAG,EAAGhM,EAAE,KAAkBkM,EAAGC,EAAG1D,EAAG,GAAIzI,EAAE,KAAkB0L,EAAGQ,EAAG/C,EAAG,GAAInJ,EAAE,KAAsElB,EAAI6I,EAAE7I,EAAtC4M,EAAI/D,EAAE+D,EAAtCQ,EAAIvE,EAAEuE,EAAGC,EAAGrN,EAAG4M,EAAGK,EAAG,EAAG/L,EAAE,KAAkBmM,EAAGrN,EAAG3L,EAAG,EAAG6M,EAAE,KAAkBkM,EAAGC,EAAGvC,EAAG,GAAI5J,EAAE,KAAkB0L,EAAGQ,EAAGJ,EAAG,GAAI9L,EAAE,KAAuElB,EAAI8I,EAAE9I,EAAvC4M,EAAI9D,EAAE8D,EAAtCQ,EAAItE,EAAEsE,EAAGC,EAAGrN,EAAG4M,EAAGjE,EAAG,EAAGzH,EAAE,KAAkBmM,EAAGrN,EAAGqK,EAAG,GAAInJ,EAAE,KAAkBkM,EAAGC,EAAGN,EAAG,GAAI7L,EAAE,KAAkB0L,EAAGQ,EAAGF,EAAG,GAAIhM,EAAE,KAAuElB,EAAI8I,EAAE9I,EAAvC4M,EAAI9D,EAAE8D,EAAtCQ,EAAItE,EAAEsE,EAAGC,EAAGrN,EAAG4M,EAAGD,EAAG,EAAGzL,EAAE,KAAkBmM,EAAGrN,EAAGiJ,EAAG,GAAI/H,EAAE,KAAkBkM,EAAGC,EAAGvC,EAAG,GAAI5J,EAAE,KAAkB0L,EAAGQ,EAAGN,EAAG,GAAI5L,EAAE,KAAuElB,EAAI8I,EAAE9I,EAAvC4M,EAAI9D,EAAE8D,EAAtCQ,EAAItE,EAAEsE,EAAGC,EAAGrN,EAAG4M,EAAGK,EAAG,EAAG/L,EAAE,KAAkBmM,EAAGrN,EAAGoJ,EAAG,GAAIlI,EAAE,KAAkBkM,EAAGC,EAAG1D,EAAG,GAAIzI,EAAE,KAAkB0L,EAAGQ,EAAGrD,EAAG,GAAI7I,EAAE,KAAuElB,EAAI8I,EAAE9I,EAAvC4M,EAAI9D,EAAE8D,EAAtCQ,EAAItE,EAAEsE,EAAGC,EAAGrN,EAAG4M,EAAGC,EAAG,EAAG3L,EAAE,KAAkBmM,EAAGrN,EAAGgN,EAAG,GAAI9L,EAAE,KAAkBkM,EAAGC,EAAGF,EAAG,GAAIjM,EAAE,KAAkB0L,EAAGQ,EAAG/Y,EAAG,GAAI6M,EAAE,KAAuElB,EAAIgJ,EAAEhJ,EAAvC4M,EAAI5D,EAAE4D,EAAtCQ,EAAIpE,EAAEoE,EAAGC,EAAGrN,EAAG4M,EAAGxD,EAAG,EAAGlI,EAAE,KAAkBmM,EAAGrN,EAAG8K,EAAG,GAAI5J,EAAE,KAAkBkM,EAAGC,EAAGH,EAAG,GAAIhM,EAAE,KAAkB0L,EAAGQ,EAAGzE,EAAG,GAAIzH,EAAE,KAAuElB,EAAIgJ,EAAEhJ,EAAvC4M,EAAI5D,EAAE4D,EAAtCQ,EAAIpE,EAAEoE,EAAGC,EAAGrN,EAAG4M,EAAGI,EAAG,EAAG9L,EAAE,KAAkBmM,EAAGrN,EAAG2J,EAAG,GAAIzI,EAAE,KAAkBkM,EAAGC,EAAGP,EAAG,GAAI5L,EAAE,KAAkB0L,EAAGQ,EAAGT,EAAG,GAAIzL,EAAE,KAAuElB,EAAIgJ,EAAEhJ,EAAvC4M,EAAI5D,EAAE4D,EAAtCQ,EAAIpE,EAAEoE,EAAGC,EAAGrN,EAAG4M,EAAGvC,EAAG,EAAGnJ,EAAE,KAAkBmM,EAAGrN,EAAGmN,EAAG,GAAIjM,EAAE,KAAkBkM,EAAGC,EAAGtD,EAAG,GAAI7I,EAAE,KAAkB0L,EAAGQ,EAAGH,EAAG,GAAI/L,EAAE,KAAuElB,EAAIgJ,EAAEhJ,EAAvC4M,EAAI5D,EAAE4D,EAAtCQ,EAAIpE,EAAEoE,EAAGC,EAAGrN,EAAG4M,EAAG3D,EAAG,EAAG/H,EAAE,KAAkBmM,EAAGrN,EAAG+M,EAAG,GAAI7L,EAAE,KAAkBkM,EAAGC,EAAGhZ,EAAG,GAAI6M,EAAE,KAAkB0L,EAAGQ,EAAGP,EAAG,GAAI3L,EAAE,KAAMiI,EAAE,GAAKA,EAAE,GAAKiE,EAAI,EAAGjE,EAAE,GAAKA,EAAE,GAAKkE,EAAI,EAAGlE,EAAE,GAAKA,EAAE,GAAKnJ,EAAI,EAAGmJ,EAAE,GAAKA,EAAE,GAAKyD,EAAI,GAAKV,YAAa,WAAc,IAAIhL,EAAInP,KAAK8T,MAAO2E,EAAItJ,EAAE2I,MAAOV,EAAI,EAAIpX,KAAKuZ,YAAalC,EAAI,EAAIlI,EAAE4I,SAAUU,EAAEpB,IAAM,IAAM,KAAO,GAAKA,EAAI,GAAI,IAAIN,EAAIH,EAAEvP,MAAM+P,EAAI,YAA8R,IAAjRqB,EAAwB,IAArBpB,EAAI,KAAO,GAAK,IAAiC,UAArBN,GAAK,EAAIA,IAAM,IAAuC,YAArBA,GAAK,GAAKA,IAAM,GAAiB0B,EAAwB,IAArBpB,EAAI,KAAO,GAAK,IAAiC,UAArBD,GAAK,EAAIA,IAAM,IAAuC,YAArBA,GAAK,GAAKA,IAAM,GAAiBjI,EAAE4I,SAAW,GAAKU,EAAEvT,OAAS,GAAIlF,KAAKyZ,WAA4BhB,GAAhBtJ,EAAInP,KAAK2a,OAAa7C,MAAYV,EAAI,EAAG,EAAIA,EAAGA,IAAKC,EAAIoB,EAAErB,GAAIqB,EAAErB,GAA2B,UAArBC,GAAK,EAAIA,IAAM,IAAuC,YAArBA,GAAK,GAAKA,IAAM,GAAiB,OAAOlI,GAAKwI,MAAO,WAAc,IAAIxI,EAAI6I,EAAEL,MAAMzL,KAAKlM,MAAqC,OAA9BmP,EAAEwL,MAAQ3a,KAAK2a,MAAMhD,QAAgBxI,KAAQ+H,EAAEwD,IAAM1C,EAAEoC,cAAcxC,GAAIV,EAAEqE,QAAUvD,EAAEqC,kBAAkBzC,GAAp9H,CAA09HxQ,MAE9sPuP,EAAS+D,IAAIhE,GAAS5F,YAOjCjE,OAAOY,KAAK+N,aAAe,SAAUrJ,EAAMsJ,GAGvC,IAAK,IAAI1a,KAFT0a,EAAmBA,MAEe,CAC9B,IAAIC,EAAM,IAAIjN,OAAO1N,EAAK,KAC1BoR,EAAOA,EAAKxN,QAAQ+W,EAAKD,EAAiB1a,IAE9C,OAAOoR,GAKXtF,OAAOY,KAAKkO,WAAa,SAAUxJ,EAAMyJ,EAAQC,GAE7C,OAAOhP,OAAO8O,WAAWxJ,EAAMyJ,EAAQC,IAK3ChP,OAAOY,KAAKqO,uBAAyB,SAAU3J,EAAMyJ,EAAQC,GACzD,IAAIE,EAAO5J,EAEP6J,EAAK,IAAIvN,OAAOmN,EAAQ,KAG5B,OAFAG,EAAOA,EAAKpX,QAAQqX,EAAIH,IAEZ/K,YAGhBtB,OAAOrB,UAAUwN,WAAa,SAAUC,EAAQC,GAC5C,OAAOhP,OAAOY,KAAKkO,WAAW3b,KAAM4b,EAAQC,IAGhDrM,OAAOrB,UAAU8N,WAAa,WAC1B,OAAOjc,KAAKkc,OAAO,GAAGC,cAAgBnc,KAAKkP,MAAM,IAGrDM,OAAOrB,UAAUiO,WAAa,SAAUC,GACpC,OAAOrc,KAAKkP,MAAM,EAAGmN,EAAInX,SAAWmX,GAMxC7M,OAAOrB,UAAUmO,YAAc,WAC3B,IAAIC,EAAW,GACf,GAAkB,IAAdvc,KAAKkF,OACLqX,EAAW,oJACR,CACH,IAGI,IAFA,IACIzE,EADqB9X,KAAK2E,QAAQ,OAAQ,KACfvD,MAAM,KAC5BN,EAAI,EAAGA,EAAIgX,EAAM5S,QAEC,IADvBqX,GAAYzE,EAAMhX,GAAG,IAAM,IACdoE,OAFiBpE,GAAK,IAMzC,MAAOmN,IAETsO,EAAWA,EAASJ,cAExB,OAAOI,GAGXnV,KAAKoV,KAAOpV,KAAKoV,MAAQ,SAAU1B,GAE/B,OAAU,KADVA,GAAKA,IACU2B,MAAM3B,GACVA,EAEJA,EAAI,EAAI,GAAK,GAIxBjO,OAAO8K,MAAQ,SAAU+E,GACrB,OAAOC,KAAKhE,MAAMgE,KAAKC,OAAOF,KAGlC7P,OAAOgQ,cAAgB,SAAUC,EAAQC,GACrC,IAAI7K,EAAO/U,EAAE,WAAW+G,SAAS,QACjCgO,EAAKC,KAAK2K,GACNC,GACA7K,EAAKxN,IAAI,YAAaqY,GAC1B,IAAIC,EAAQ9K,EAAK8K,QAEjB,OADA9K,EAAK+K,SACED,GAKXnQ,OAAOY,KAAKyP,KAAO,SAAU/K,GACzB,YAAsB,IAAX,GAAkC,MAARA,EAC1BA,EAEJA,EAAKxN,QAAQ,SAAU,IAAIA,QAAQ,SAAU,KAGxD6K,OAAOrB,UAAUgP,SAAW,SAAUC,GAClC,OAA8D,IAAvDpd,KAAKkK,QAAQkT,EAAQpd,KAAKkF,OAASkY,EAAOlY,SAMrD2H,OAAOY,KAAK4P,MAAQ,WAChB,OAAOxQ,OAAOY,KAAK6P,QAAmC,GAAzBnM,SAASoM,cAK1C1Q,OAAOY,KAAK+P,MAAQ,WAChB,OAAO3Q,OAAOY,KAAK6P,QAAmC,GAAzBnM,SAASoM,cAK1C1Q,OAAOY,KAAKgQ,MAAQ,WAChB,OAAO5Q,OAAOY,KAAK6P,QAAmC,GAAzBnM,SAASoM,cAK1C1Q,OAAOY,KAAKiQ,OAAS,WACjB,OAAO7Q,OAAOY,KAAK6P,QAAmC,IAAzBnM,SAASoM,cAK1C1Q,OAAOY,KAAKkQ,OAAS,WACjB,QAASC,UAAUC,UAAUC,MAAM,kBAAoBF,UAAUC,UAAUC,MAAM,UAMrFjR,OAAOY,KAAKsQ,cAAgB,WACxB,OAAOlR,OAAOY,KAAKkQ,UAAY9Q,OAAOY,KAAKiQ,UAAY7Q,OAAOY,KAAKgQ,SAAW5Q,OAAOY,KAAK+P,SAAW3Q,OAAOY,KAAK4P,SAMrHxQ,OAAOY,KAAKuQ,cAAgB,WACxB,OAAOnR,OAAOY,KAAKiQ,UAAY7Q,OAAOY,KAAKgQ,SAAW5Q,OAAOY,KAAK+P,SAAW3Q,OAAOY,KAAK4P,SAM7FxQ,OAAOY,KAAKwQ,OAAS,WACjB,QAAI,YAAY/L,KAAK0L,UAAUC,YAQnChR,OAAOY,KAAK6P,KAAO,WACf,OAAQM,UAAUM,QAAQhU,QAAQ,qBAAuB,KAAO0T,UAAUC,UAAUC,MAAM,YAK9FjR,OAAOY,KAAK0Q,aAAe,WACvB,IAAIC,EAASC,OAAOT,UAAUC,UAC1BS,EAAYF,EAAOlU,QAAQ,QAC3BqU,EAAU,EAOd,OANID,EAAY,EACZC,EAAU9Z,SAAS2Z,EAAOI,UAAUF,EAAY,EAAGF,EAAOlU,QAAQ,IAAKoU,MAEjEV,UAAUC,UAAUC,MAAM,YAAcO,OAAOT,UAAUC,UAAU3T,QAAQ,SAAW,KACxFqU,EAAU,IAEXA,GAKX1R,OAAOY,KAAKgR,SAAW,WACnB,MAAO,SAASvM,KAAK0L,UAAUC,YAAc,aAAa3L,KAAK0L,UAAUc,SAK7E7R,OAAOY,KAAKkR,UAAY,SAASC,GAkB7B,MAAO,UAAU1M,KAAK0L,UAAUC,kBAA4B3V,IAAb0W,GAA0BA,IAhBjEC,EAAGjB,UAAUC,UAAciB,EAAED,EAAGf,MAAM,oEACvC,WAAW5L,KAAK4M,EAAE,KAET7d,KAAK,KAAKsd,SADlBQ,EAAI,kBAAkBC,KAAKH,QACI,IAAI,IAE7B,WAAPC,EAAE,IAEO,OADRC,EAAIF,EAAGf,MAAM,uBACY7c,KAAK,QAASsd,QAAQQ,EAAI,KAEvDD,EAAEA,EAAE,IAAKA,EAAE,GAAIA,EAAE,KAAMlB,UAAUM,QAASN,UAAUqB,WAAY,MAC1B,OAAlCF,EAAIF,EAAGf,MAAM,qBAA4BgB,EAAEjF,OAAO,EAAE,EAAEkF,EAAI,KAE5D9d,KAAM6d,EAAE,GACRP,QAASO,EAAE,MAGiFP,SAjBlG,IAC+BQ,EAAvBF,EAA2BC,GAqBvCjS,OAAOY,KAAKyR,WAAa,WACrB,IAAIC,EAAG,aAaP,OAZGtS,OAAOY,KAAKgR,WACXU,EAAG,SACEtS,OAAOY,KAAKkR,YACjBQ,EAAG,UACEtS,OAAOY,KAAKwQ,SACjBkB,EAAG,OACEtS,OAAOY,KAAKkQ,SACjBwB,EAAG,OAEEtS,OAAOY,KAAKiQ,WACjByB,EAAG,QAEAA,GAMXtS,OAAOY,KAAK2R,mBAAqB,WACzBvS,OAAO+Q,WAAa/Q,OAAO+Q,UAAUyB,OACrCxS,OAAO+Q,UAAUyB,UAOzBliB,EAAGgU,UAAWC,MAAM,WAEhB,GADAjU,EAAE,QAAQkE,SAAS,WAAWwL,OAAOY,KAAKyR,cACtCrS,OAAOyS,SAAU,CACjB,IAAIA,EAASzS,OAAOyS,SAASle,MAAM,KAC/Bke,GAAYA,EAASpa,OAAO,GAC5B/H,EAAE,QAAQkE,SAAS,YAAYie,EAAS,OAWpDzS,OAAOY,KAAK8R,oBAAsB,WAC1B1S,OAAOY,KAAK+R,gCAA8D,IAAzBC,UAAmB,WACpEA,UAAUC,UAAU,SAAU9b,GAI1B,GAAoB,SAHFA,EAIdzG,EAAE,QAAQyE,OAAO,qDACjBzE,EAAE,iBAAiBgV,KAJJ,gzBAMZ,GAAItF,OAAOY,KAAKkS,cAAe,CAClCxiB,EAAE,QAAQyE,OAAO,oDAEjBzE,EAAE,gBAAgBgV,KADC,2DAOnCtF,OAAOY,KAAKmS,SAAW,SAAUhc,GAC7B,MAAkD,oBAA3Cic,OAAO1R,UAAU2C,SAAS1C,MAAMxK,IAG3CiJ,OAAOY,KAAKqS,SAAW,SAAUlc,GAC7B,MAAkD,oBAA3Cic,OAAO1R,UAAU2C,SAAS1C,MAAMxK,IAG3CiJ,OAAOY,KAAKsS,QAAU,SAAUnc,GAC5B,OAAOsH,MAAM6U,QAAQnc,IAEzBiJ,OAAOY,KAAKuS,OAAS,SAAUpc,GAC3B,MAAkD,kBAA3Cic,OAAO1R,UAAU2C,SAAS1C,MAAMxK,IAE3CiJ,OAAOY,KAAKwS,UAAY,SAAUrc,GAC9B,MAAkD,qBAA3Cic,OAAO1R,UAAU2C,SAAS1C,MAAMxK,IAM3CiJ,OAAOY,KAAKyS,2BAA6B,WACrC,OAAKrT,OAAOY,KAAK6P,OAEVzT,OAAOsH,SAASoM,eADX,GAMhB1Q,OAAOY,KAAKoG,aAAe,WAEvB,OAAOhH,OAAOgH,gBAIlBhH,OAAOY,KAAK0S,UAAY,SAAUlJ,GAC9B,OAAQwF,MAAM2D,WAAWnJ,KAAOoJ,SAASpJ,IAI7CpK,OAAOY,KAAK6S,OAAS,SAAUrJ,GAC3B,MAAO,6EAA6E/E,KAAK+E,IAG7FpK,OAAOY,KAAK8S,cAAgB,SAAUC,GAClC,IACIC,QAAQC,IAAI,8BAAgCF,GAC9C,MAAOG,MAKb9T,OAAOY,KAAKmT,YAAc,SAAUC,GAChC,OAAIhU,OAAOY,KAAKqT,QAAQD,SAAsC,IAArBA,EAAMlF,WACpC,GACJkF,EAAMlF,WAAW,IAAK,KAAKA,WAAW,IAAK,KAAKA,WAAW,IAAK,KAAKA,WAAW,IAAK,MAGhG9O,OAAOY,KAAKuF,aAAe,SAAUpP,GACjC,YAAcsE,IAAVtE,EACO,KAGG,OAAVA,EACO,KAGG,KAAVA,EACO,MAIG,IAAVA,GAA4B,IAAVA,GAAoC,SAArBA,EAAMkN,YAAmC,MAAVlN,IAG7B,SAAnCA,EAAMkN,WAAWL,gBAKN,OAAV7M,IAA4B,IAAVA,IAA8B,IAAVA,GAAoC,UAArBA,EAAMkN,YAAoC,MAAVlN,IAGnD,UAAnCA,EAAMkN,WAAWL,eAId,QAKX5D,OAAOY,KAAKqT,QAAU,SAAUld,GAC5B,OAAc,IAAVA,IAGAA,MAAAA,GAAmD,KAAVA,IAItB,gBAAZ,EACgB,GAAhBA,EAAMsB,OAG8B,mBAA3C2a,OAAO1R,UAAU2C,SAAS1C,MAAMxK,GACR,IAAjBA,EAAMsB,OAG8B,oBAA3C2a,OAAO1R,UAAU2C,SAAS1C,MAAMxK,OAC5BzG,EAAE4jB,cAAcnd,IAGTiJ,OAAOY,KAAKuT,aAAapd,OAY5CiJ,OAAOY,KAAKuT,aAAe,SAAUC,GACjC,GAAgD,oBAA5CpB,OAAO1R,UAAU2C,SAAS1C,MAAM6S,GAA+B,CAC/D,IAAIC,EAAU5jB,GAAK,EAEf6jB,GAAQ,EACZ,IAAKD,KAAYD,EACb,GAAIA,EAAO1J,eAAe2J,KACL,OAAbA,EACA5jB,GAAK,EAEY,UAAb4jB,GACQ,EAERC,GAAQ,EAGZA,GACA,OAAO,EAInB,GAAI7jB,EACA,MAAqB,KAAjB2jB,EAAW,KAa3BpU,OAAOY,KAAK2T,UAAY,SAAUxd,GAO9B,IALA,IAEIyd,EAFAC,GAAgB,EAChBC,EAFJ3d,EAAQA,GAAS,IAMT0d,GACJ,IAEI,GADAD,EAAkBD,UAAUG,GACxB1U,OAAOY,KAAK+T,mBAAmBH,GAAkB,CACjDE,EAAe3d,EACf,MAEAyd,GAAmBE,EACnBD,GAAgB,EAEhBC,EAAeF,EAErB,MAAOpT,GACLqT,GAAgB,EAIxB,OAAOC,GAGX1U,OAAOY,KAAK+T,mBAAqB,SAAU5d,GAMvC,IAJA,IAGI6d,EAHAvc,GADJtB,EAAQA,GAAS,IACEsB,OACfpE,EAAI,EACJiH,GAAS,EAENjH,EAAIoE,GAEP,IADAuc,EAAK7d,EAAM0L,WAAWxO,MACb,IAAM2gB,EAAK,IAAK,CACrB1Z,GAAS,EACT,MAGR,OAAOA,GAMX8E,OAAOY,KAAKiU,eAAiB,SAAU9d,GACnC,OAAOiG,OAAO2F,OAAO5L,GAAOe,QAAQ,IAAK,MAK7CkI,OAAOY,KAAKC,cAAgB,SAAUgP,GAClC,QAAIA,EAAIxX,OAAS,IAOrB2H,OAAOY,KAAKkU,WAAa,SAAU7W,GAE/B,GAAkB,GAAdA,EAAI5F,QAAgC,GAAjB4F,EAAI,GAAG5F,OAC1B,OAAO,EAEX,IAAK,IAAInE,KAAO+J,EACZ,GAAIA,EAAIyM,eAAexW,GACnB,OAAO,EAGf,OAAO,GAKX8L,OAAOY,KAAKmU,gBAAkB,SAAUC,EAAWrO,EAAU7O,GAEzD,IAAImd,EAAmB3kB,EAAEqW,EAAUqO,GAC/BC,EAAiB5c,OAAS,IAC1B4c,EAAiBlgB,OAAO+C,GACxBmd,EAAiBze,WAAW0e,WAMpClV,OAAOY,KAAKuU,UAAY,SAAUC,EAAIC,GAC9BD,EAAG/c,SACH+c,EAAKA,EAAG,IAEZ,IAAIla,IAAWka,EADfC,EAA2B,aAAdA,EAA4B,YAAc,cAOvD,OALKna,IACDka,EAAGC,GAAa,EAChBna,IAAWka,EAAGC,GACdD,EAAGC,GAAa,GAEbna,GAIX8E,OAAOY,KAAK0U,iBAAmB,SAAUC,EAAMC,GAG3C,UAAW,UAAkB,EACzB,OAAO,EAGX,GAAsB,mBAAX,EACP,OAAOD,EAAKtR,aAAeuR,EAAKvR,WAGpC,GAAIsR,aAAgBvC,QAAUwC,aAAgBxC,OAAQ,CAGlD,GAAIhT,OAAOY,KAAK6U,WAAWF,KAAUvV,OAAOY,KAAK6U,WAAWD,GACxD,OAAO,EAIX,IAAK5J,KAAK2J,EAEN,IADIvV,OAAOY,KAAK0U,iBAAiBC,EAAK3J,GAAI4J,EAAK5J,IAE3C,OAAO,EAGf,OAAO,EAEP,OAAO2J,IAASC,GAIxBxV,OAAOY,KAAK6U,WAAa,SAAU5F,GAC/B,IAAI6F,EAAQ,EACZ,IAAK9J,KAAKiE,EACFA,EAAInF,eAAekB,IACnB8J,IAGR,OAAOA,GAKX1V,OAAOY,KAAK+U,mBAAqB,SAAUC,EAAMC,GAC7C,GAAYxa,MAARua,EACA,OAAO,EAIX,IAAIE,GADJD,EAASA,GAAUvlB,EAAEkhB,SACEsE,YACnBC,EAAUzlB,EAAEslB,GAAMje,SAASqe,IAG/B,OAFiBD,EAAUzlB,EAAEslB,GAAMK,UACfH,EAAYxlB,EAAEulB,GAAQI,UACAF,GAAWD,GAEzD9V,OAAOY,KAAKsV,wBAA0B,SAAUN,EAAMC,GAClD,GAAYxa,MAARua,EACA,OAAO,EAIX,IAAIO,GADJN,EAASA,GAAUvlB,EAAEkhB,SACKsE,YACtBM,EAAa9lB,EAAEslB,GAAMje,SAASqe,IAC9BK,EAAgB/lB,EAAEslB,GAAMK,SAOxBK,EAASH,GALTC,EAAa,EACJA,EAAaC,EAEbD,EAAaC,GAG1BR,EAAOC,UAAUQ,IAKrBtW,OAAOY,KAAK2V,WAAa,SAAUjR,GAC/B,OAAIA,MAAAA,EACO,GAEU,iBAAV,EACAA,EAAKxN,QAAQ,KAAM,SAASA,QAAQ,KAAM,QAAQA,QAAQ,KAAM,QAEpEwN,GAMXtF,OAAOY,KAAK4V,mBAAqB,SAAUlR,GACvC,OAAIA,MAAAA,EACO,GAEU,iBAAV,EACAA,EAAKxN,QAAQ,UAAW,KAAKA,QAAQ,QAAS,KAAKA,QAAQ,QAAS,KAAKA,QAAQ,UAAW,KAEhGwN,GAKXtF,OAAOY,KAAK6V,cAAgB,WAExB,OADajF,OAAOnI,SAASqN,KAAK/E,UAAU,GAAGpd,MAAM,MAMzDyL,OAAOY,KAAK+V,SAAW,SAAUnY,GAC7B,IAAIoY,EAAQ,IAAItmB,EAAE4S,SACd2T,EAAMrY,GAAUA,EAAOsY,IAAMtY,EAAOsY,IAAMtY,EAC1CpB,EAAOoB,GAAUA,EAAOpB,KAAOoB,EAAOpB,KAAO,KAOjD,OALA4C,OAAO+W,OAAOJ,UAAWG,IAAKD,EAAKzZ,KAAMA,IACpC4Z,KAAK,WACFJ,EAAMtT,YAGPsT,EAAMlb,WAMjBsE,OAAOY,KAAKqW,YAAc,SAAUC,EAASC,GACzC,IAAIP,EAAQ,IAAItmB,EAAE4S,SA4BlB,OA1BAiU,EAASA,GAAUnX,OAAOgH,eAEtBkQ,EAAQE,YAERR,EAAMtT,UAGF4T,EAAQG,aACR/mB,EAAEqM,KAAKua,EAAQI,gBAAgB5b,WAC1BJ,KAAK,WACFsb,EAAMtT,aAId4T,EAAQI,gBAAkB,IAAIhnB,EAAE4S,SAChCgU,EAAQG,cAAe,EACvBrX,OAAO+W,OAAOE,YAAYC,EAASC,EAAQ,WAGvCD,EAAQI,gBAAgBhU,UACxB4T,EAAQG,cAAe,EACvBT,EAAMtT,aAKXsT,EAAMlb,WAKjBsE,OAAOY,KAAK2W,eAAiB,SAAUV,GAKnC,IAJA,IAAIrY,KAGAgZ,IAFJX,EAAMA,GAAOrF,OAAOnI,SAASC,MACbjM,QAAQ,KAAO,EAAIwZ,EAAIlF,UAAUkF,EAAIxZ,QAAQ,KAAO,GAAK,IACvD9I,MAAM,KACfN,EAAIujB,EAAMnf,OAAS,EAAGpE,GAAK,EAAGA,IAAK,CACxC,IAAIwjB,EAAMD,EAAMvjB,GAAGoJ,QAAQ,KAC3B,IAAY,GAARoa,EAAJ,CAEA,IAAIC,EAAUF,EAAMvjB,GAAG0d,UAAU,EAAG8F,GAChC1gB,EAAQygB,EAAMvjB,GAAG0d,UAAU8F,EAAM,GACrCjZ,EAAOkZ,GAAWpL,SAASvV,IAE/B,OAAOyH,GAKXwB,OAAOY,KAAK+W,kBAAoB,SAAUd,EAAKe,GAC3C,IAAIC,EAAWhB,EAAIxZ,QAAQ,KAAO,EAAIwZ,EAAIlF,UAAU,EAAGkF,EAAIxZ,QAAQ,MAAQwZ,EACvEiB,EAAiB9X,OAAOY,KAAK2W,eAAeV,GAC5CkB,EAAYznB,EAAEsJ,UAAWke,EAAgBF,GAC7C,OAAOC,EAAW,IAAMvnB,EAAE0nB,MAAMD,IAEpC/X,OAAOY,KAAKqX,cAAgB,WACxB,IAAIC,KACAC,GAAuB,EAC3B,IACIlkB,EAAEmkB,KAAKC,OAAS,EAClB,MAAOjX,GACL,GAAIA,EAAEkX,MAAO,CAET,IADA,IAAIC,EAAQnX,EAAEkX,MAAM/jB,MAAM,MACjBN,EAAI,EAAGukB,EAAMD,EAAMlgB,OAAQpE,EAAIukB,EAAKvkB,IACrCskB,EAAMtkB,GAAGgd,MAAM,4BACfiH,EAAUnc,KAAKwc,EAAMtkB,IAI7BikB,EAAU1V,QACV2V,GAAuB,OACpB,GAAI3G,OAAOiH,OAASrX,EAAEyI,QAAS,CAElC,IADI0O,EAAQnX,EAAEyI,QAAQtV,MAAM,MACnBN,EAAI,EAAGukB,EAAMD,EAAMlgB,OAAQpE,EAAIukB,EAAKvkB,IACzC,GAAIskB,EAAMtkB,GAAGgd,MAAM,2BAA4B,CAC3C,IAAIyH,EAAQH,EAAMtkB,GAEdskB,EAAMtkB,EAAI,KACVykB,GAAS,OAASH,EAAMtkB,EAAI,GAC5BA,KAEJikB,EAAUnc,KAAK2c,GAIvBR,EAAU1V,QACV2V,GAAuB,GAG/B,IAAKA,EAED,IADA,IAAIQ,EAAkBnX,UAAUoX,OAAOC,OAChCF,GAAiB,CACpB,IAAIxY,EAAKwY,EAAgB1U,WACrB6U,EAAQ3Y,EAAGwR,UAAUxR,EAAG9C,QAAQ,YAAc,EAAG8C,EAAG9C,QAAQ,MAAQ,YACxE6a,EAAUnc,KAAK+c,GACfH,EAAkBA,EAAgBE,OAG1C,OAAOX,GAKXlY,OAAOY,KAAKmY,iBAAmB,SAAU3D,GACrCA,EAAG5gB,SAAS,wBACZlE,EAAEqM,KACE1H,WAAW,WACPmgB,EAAG5gB,SAAS,6BACb,MACL8G,KACErG,WAAW,WACPmgB,EAAG4D,YAAY,kDAChB,OAKXhZ,OAAOY,KAAKqY,iBAAmB,SAAU7D,GACrC,IACI,IAAI8D,EACJA,EAAiB9D,EAAG,GAAG+D,aACvB/D,EAAGU,UAAUoD,GACf,MAAO9X,MAIbpB,OAAOY,KAAKwY,oBAAuBzO,MAAM,GACzC3K,OAAOY,KAAKyY,WAAa,SAAUC,EAAYC,EAAUC,EAAaC,GAClE,IAAIC,GAAU,EAEdC,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,IAC7CzZ,OAAOY,KAAKwY,mBAAmBK,GAAc,EAC7CzZ,OAAOY,KAAKwY,mBAAyB,MAAI,EACzC9oB,EAAE,QAAQkE,SAAS,cACnBlE,EAAE,mBAAmBspB,UAAU,SAAUC,GACjCA,EAAMC,MAAQP,EACTG,IACDA,GAAU,EACV1Z,OAAOY,KAAKmZ,sBAAsBT,EAAY,aAAcG,IAEzDI,EAAMC,MAAQN,EAChBE,IACDA,GAAU,EACV1Z,OAAOY,KAAKoZ,yBAAyBV,EAAY,aAAcG,KAGnEE,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,IAC7CC,GAAU,MAKtB1Z,OAAOY,KAAKmZ,sBAAwB,SAAUT,EAAYW,EAAUR,GAChEE,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,IACzCQ,GACA3pB,EAAE,QAAQkE,SAASylB,GAEO,GAA1BX,EAAWxD,YACX6D,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,KAE7CE,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,IAC7CzZ,OAAOY,KAAKwY,mBAAmBK,GAAcS,YAAY,WACjDZ,EAAWxD,YAAc,EACzBwD,EAAWxD,UAAUwD,EAAWxD,YAAc,IAE9C6D,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,KAElD,OAKXzZ,OAAOY,KAAKoZ,yBAA2B,SAAUV,EAAYW,EAAUR,GACnEE,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,IACzCQ,GACA3pB,EAAE,QAAQkE,SAASylB,GAEvB,IAAIE,EAAuB7pB,EAAEgpB,GAAY,GAAGH,aAAe7oB,EAAEgpB,GAAYc,cACrEd,EAAWxD,aAAeqE,EAC1BR,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,KAE7CE,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,IAC7CzZ,OAAOY,KAAKwY,mBAAmBK,GAAcS,YAAY,WACrDla,OAAOY,KAAKqY,iBAAiB3oB,EAAE,SAC3BgpB,EAAWxD,YAAcqE,EACzBb,EAAWxD,UAAUwD,EAAWxD,YAAc,IAE9C6D,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,KAElD,OAIXzZ,OAAOY,KAAKyZ,iBAAmB,SAAUJ,EAAUR,GAC/CnpB,EAAE,QAAU2pB,GAAUK,OAAO,aAAatB,YAAYiB,GACtDN,cAAc3Z,OAAOY,KAAKwY,mBAAmBK,IAC7CzZ,OAAOY,KAAKwY,mBAAmBzO,MAAO,GAG1C3K,OAAOY,KAAK2Z,aAAe,SAAU5T,GAEjC,OADAA,EAAWA,GAAYrW,EAAE,YAClBiK,KAAK2D,IAAIqD,MAAM,KAAMjR,EAAEqW,GAAU1I,IAAI,WACxC,IAAIhG,EACJ,OAAO2X,MAAM3X,EAASL,SAAStH,EAAE6C,MAAM0E,IAAI,WAAY,KAAO,EAAII,MAO1E+H,OAAOwa,UAAY,SAAU3D,EAAKrY,EAAQic,GACtC,IAAItK,EAAQ3R,EAAO2R,OAAS,KACxB8F,EAASzX,EAAOyX,QAAU,IAC1BD,EAAM1lB,EAAEkhB,QAAQyE,SAAW,EAAIA,EAAS,EACxCyE,EAAOpqB,EAAEkhB,QAAQrB,QAAU,EAAIA,EAAQ,EAEvCwK,EAAYnJ,OAAOoJ,KAAK/D,EAAK,GAAI,SAAW1G,EAAQ,WAAa8F,EAAS,SAAWD,EAAM,UAAY0E,EAAO,wDAElHlJ,OAAOqJ,cAAgBF,EACvBnJ,OAAOsJ,gBAAkBL,EAEzBjJ,OAAOuJ,cAAgB,SAAUC,EAAUC,GAEvCzJ,OAAOqJ,cAAcK,QAErB1J,OAAOsJ,gBAAgBE,EAAUC,KASzCjb,OAAOmb,oBAAsB,SAAUtE,EAAKrY,GACxC,IAAI4c,EAAiB5J,OAAO6J,oBAAsB,cAC9ClL,EAAQ3R,EAAO2R,OAAS,KACxB8F,EAASzX,EAAOyX,QAAU,IAC1BD,EAAM1lB,EAAEkhB,QAAQyE,SAAW,EAAIA,EAAS,EACxCyE,EAAOpqB,EAAEkhB,QAAQrB,QAAU,EAAIA,EAAQ,EAEvCwK,EAAYnJ,OAAOoJ,KAAKQ,EAAgB,cAAe,SAAWjL,EAAQ,WAAa8F,EAAS,SAAWD,EAAM,UAAY0E,EAAO,wDACxIlJ,OAAO8J,oBAAsBX,EAE7B1lB,WAAW,WACP,IACI0lB,EAAUrW,SAASlT,MAAQoN,EAAOpN,MACpC,MAAOgQ,MACV,IAEH9Q,EAAEqqB,GAAWtW,gBAAgB,SAAUkX,GAEnC,IAAIjrB,EAAIirB,EAAa9b,OACjB+b,EAAcD,EAAaC,YAC/BA,EAAYC,aAAe,WACvB,IAAIC,EAAaprB,EAAE,OAAQkrB,EAAYlX,UACnCqX,EAASrrB,EAAE,SAAUorB,GAEzBA,EAAW1C,YAAY,6BACvB2C,EAAOnjB,OAGP,IAAIojB,EAAYL,EAAaM,WAAWD,UACxC,GAAIA,GAA0B,MAAbA,EAAmB,CAChC,IAAIE,EAAiBxrB,EAAEsJ,OAAO2hB,EAAaM,YACvCL,YAAaA,IAEjBG,EAAOlY,WAAWmY,EAAWE,KAGrC,IAAIC,EAAkB,WAClB,IAAIC,EAAO1rB,EAAE,OAAQkrB,EAAYlX,UAE7B0X,EAAK3jB,OAAS,EACd2jB,EAAKjnB,OAAO,uDAAyDwmB,EAAa1E,IAAM,wGAGxF5hB,WAAW,WACP8mB,KACD,KAIXA,MAEItc,OAAQnP,EACRurB,WAAYrd,EACZgd,YAAab,EACb9D,IAAKA,KAMjB7W,OAAOxE,cAAgB,SAAUE,GAC7B,IAAIR,EAIJ,OAHAQ,EAAQJ,KAAK,SAAUtK,GACnBkK,EAASlK,IAENkK,GAKX8E,OAAOic,YAAc,SAAUzd,GAC3B,IAAI0d,EAAY1d,EAAOpK,KACnB+nB,EAAU3d,EAAO2d,QAEjBC,EAAc5d,EAAY,MAAIA,EAAOpN,MAAQ,GAC7CirB,EAAU/rB,EAAE,iCAAmC4rB,EAAY,gBAC3DI,EAAQhsB,EAAE,eAAiB4rB,EAAY,6BAA6B7kB,SAASglB,GAC7EE,EAAcjsB,EAAE,eAAiB4rB,EAAY,iHAAiH7kB,SAASilB,GACvK9d,EAAOpN,OACOd,EAAE,eAAiB4rB,EAAY,uCAAyCE,EAAa,eAAe/kB,SAASilB,GAG/H,IAAIE,EAAelsB,EAAE,eAAiB4rB,EAAY,sBAAsB7kB,SAASilB,GAEjFA,EAAMhkB,OACFkG,EAAOie,iBACPH,EAAM9nB,SAASgK,EAAOie,iBAC1B,IAAIzH,EAAYxW,EAAOwW,WAAa,OACpCqH,EAAQhlB,SAAS/G,EAAE0kB,EAAW1Q,WAE1B9F,EAAOke,SAEPJ,EAAMzkB,IAAI,OAAQwkB,EAAQpG,SAAWqG,EAAMrG,UAAY,GACvDqG,EAAMzkB,IAAI,QAASwkB,EAAQlM,QAAUmM,EAAMnM,SAAW,IAE1DmM,EAAM9jB,OAEN,IAAImkB,EAAe,SAAUne,GACzB6d,EAAQjM,SACJ+L,GACAA,EAAQ3d,IAIhB,OAFA+d,EAAYK,MAAMD,IAGdE,UAAWP,EACXD,QAASA,EACTS,QAASN,EACTtB,MAAO,SAAU1c,GACbme,EAAane,MAQzBwB,OAAO+c,oBAAsB,SAAUve,GACnCA,EAAOpK,KAAO,kBACd,IAAI4oB,EAAOxe,EAAOwe,KACdC,EAAWze,EAAOye,SAClBX,EAAQtc,OAAOic,YAAYzd,GAC3BwW,EAAY1kB,EAAE,eAAekE,SAAS,4BACtCqV,EAAUvZ,EAAE,eAAekE,SAAS,+DACpC0oB,EAAmB5sB,EAAE,eAAekE,SAAS,mDACjDqV,EAAQvE,KAAK9G,EAAOqL,SACpBA,EAAQxS,SAAS2d,GACjB,IAAImI,EAAW7sB,EAAE,iBAAiBkE,SAAS,4EACvC4oB,EAAe9sB,EAAE,iBAAiBkE,SAAS,gFAC/C2oB,EAAS7X,KAAKtF,OAAOC,aAAaC,YAAY,8BAC9Ckd,EAAa9X,KAAKtF,OAAOC,aAAaC,YAAY,kCAClDid,EAAS9lB,SAAS6lB,GAClBE,EAAa/lB,SAAS6lB,GACtBA,EAAiB7lB,SAAS2d,GAC1BA,EAAU3d,SAASilB,EAAMQ,SACzB,IAAIO,EAAY,WACZf,EAAMpB,QACe,mBAAV,GACP8B,KAGRG,EAASP,MAAMS,GACf,IAAIC,EAAgB,WAChBhB,EAAMpB,QACmB,mBAAd,GACP+B,KAIR,OADAG,EAAaR,MAAMU,IAEfpC,MAAO,WACHoB,EAAMpB,SAEVqC,GAAI,WACAF,KAEJG,OAAQ,WACJF,OAOZtd,OAAOyd,OAAS,SAAUjf,GAEtB,IAAIif,EAASntB,EAAE,eAAekE,SAAS,cACnC0N,EAAM5R,EAAE,WACZ4R,EAAIoD,KAAK9G,EAAOqL,SAAW,IAC3B3H,EAAI7K,SAASomB,GACbA,EAAOpmB,SAAS/G,EAAE,OAAQgU,WAC1BmZ,EAAOA,QACHrsB,MAAOoN,EAAOpN,MACdssB,OAAO,EACPtrB,QAASoM,EAAOpM,QAChB8oB,MAAO,WACHuC,EAAOA,OAAO,eAO1Bzd,OAAO2d,qBAAuB,WAC1B,IAAIC,EAAcpM,OAAO8J,oBACzB9J,OAAO8J,oBAAsB,KAC7B,IACQsC,GACAA,EAAY1C,QAClB,MAAO9Z,MAKbpB,OAAO6d,SAAW,SAAUtY,GACxB,IAMI1N,EANAimB,EAAWzU,SAASC,KAAKxR,QAAQ,gBAAiB,IAClDimB,IAAexY,EAAM0L,MAAM,KAE3B+M,IAAmBzY,EAAM0L,MAAM,MAC/BgN,EAAc,IAAIrc,OAAO2D,EAAMzN,QAAQ,IAAK,IAAK,KACjDomB,EAAY,GAEhB,GAAa,IAAT3Y,EACA,MAAO,GAEX,IAAI4Y,EAAiB,SAAU5Y,GAC3B,IAAK,IAAI6Y,EAAO,EAAGA,EAAO9Z,SAAS+Z,YAAYhmB,OAAQ+lB,IAEnD,GAAW,OADXvmB,EAAMyM,SAAS+Z,YAAYD,GAAME,OAASha,SAAS+Z,YAAYD,GAAMG,UAEjE,IAAK,IAAIrqB,EAAM,EAAGA,EAAM2D,EAAIQ,OAAQnE,IAChC,GAAuC,MAAnCoQ,SAAS+Z,YAAYD,GAAM9U,OAAuE,MAAtDhF,SAAS+Z,YAAYD,GAAM9U,KAAK2H,MAAM,cAA8C,WAAtBuN,oBAAkC,CAE5I,IAAIC,EAAmB5mB,EAAI3D,GAAY,QAAI2D,EAAI3D,GAAK+Q,QAAU,GAE1D+Y,EAC6B3iB,MAAzBxD,EAAI3D,GAAKwqB,cAAyE,MAA5C7mB,EAAI3D,GAAKwqB,aAAazN,MAAMgN,KAE9D3tB,EAAEwT,QAAQI,OACVga,GAAarmB,EAAI3D,GAAK+Q,QAAQnN,QAAQ,YAAa,IAC5CxH,EAAEwT,QAAQC,MAA6B,OAArBzT,EAAEwT,QAAQ4N,QACnCwM,GAAarmB,EAAI3D,GAAKqR,MAAMN,QAE5BiZ,GAAarmB,EAAI3D,GAAK+Q,QAAQnN,QAAQ,YAAa,wCAG3BuD,MAAzBxD,EAAI3D,GAAKwqB,cAA6B7mB,EAAI3D,GAAKwqB,cAAgBnZ,IACtE2Y,GAAarmB,EAAI3D,GAAK+Q,SAItB8Y,GACgB1iB,MAAZxD,EAAI3D,IAAwCmH,MAAnBojB,IACsB,GAA3CA,EAAgBphB,QAnC5B,gBAqCgB/M,EAAEwT,QAAQI,OACVga,GAAaO,EAAgB3mB,QAAQ,sCAAuC,IAAIA,QAAQ,YAAa,IAErGomB,GAAaO,EAAgB3mB,QAAQ,YAAa,WAUlF,OAAOomB,GA2CX,OADc5tB,EAAEwT,QAAY,KAxCV,SAAUyB,GACxB,GAAyB,OAArBjV,EAAEwT,QAAQ4N,QAEV,OAAOyM,EAAe5Y,GAG1B,IADA,IAAIoZ,EACKP,EAAO,EAAGA,EAAO9Z,SAAS+Z,YAAYhmB,OAAQ+lB,IAGnD,GAAW,OAFXvmB,EAAMyM,SAAS+Z,YAAYD,GAAMG,UAAYja,SAAS+Z,YAAYD,GAAME,OAGpE,IAAK,IAAIpqB,EAAM,EAAGA,EAAM2D,EAAIQ,OAAQnE,IAChC,GAA0B,WAAtBsqB,mBAEIR,IAC6B3iB,MAAzBxD,EAAI3D,GAAKwqB,cAAyE,MAA5C7mB,EAAI3D,GAAKwqB,aAAazN,MAAMgN,GAClEC,GAAarmB,EAAI3D,GAAK+Q,QAAQnN,QAAQ,YAAagmB,EAAW,kCAC9BziB,MAAzBxD,EAAI3D,GAAKwqB,cAA6B7mB,EAAI3D,GAAKwqB,cAAgBnZ,IACtE2Y,GAAarmB,EAAI3D,GAAK+Q,QAAQnN,QAAQ,YAAagmB,EAAW,yCAGnE,GAAqB,MAAjBjmB,EAAI3D,GAAKoV,MAAiCjO,MAAjBxD,EAAI3D,GAAKoV,MAAyD,MAApCzR,EAAI3D,GAAKoV,KAAK2H,MAAM,aAAsB,CAExG0N,EAAY9mB,EAAI3D,GAAK0qB,WAAWL,aAChC,IAAK,IAAInU,EAAI,EAAGA,EAAIuU,EAAUtmB,OAAQ+R,IAC9B4T,EACkC3iB,MAA7BsjB,EAAUvU,GAAGsU,cAA0D,MAA7BC,EAAUvU,GAAGsU,cAAyE,MAAhDC,EAAUvU,GAAGsU,aAAazN,MAAMgN,KAEjHC,GAAaS,EAAUvU,GAAGnF,QAAQnN,QAAQ,YAAagmB,EAAW,mCAElCziB,MAA7BsjB,EAAUvU,GAAGsU,cAA6BC,EAAUvU,GAAGsU,cAAgBnZ,IAE9E2Y,GAAaS,EAAUvU,GAAGnF,QAAQnN,QAAQ,YAAagmB,EAAW,mCAO1F,OAAOI,EAEqBW,CAAYtZ,GAAS4Y,EAAe5Y,IAMxEvF,OAAO8e,OAAS,SAAU5qB,EAAK6C,EAAOvG,GAElC,GAAIgR,UAAUnJ,OAAS,GAAuB,oBAAlBsK,OAAO5L,GAA8B,CAM7D,GALAvG,EAAUF,EAAEsJ,UAAWpJ,GACnBuG,MAAAA,IACAvG,EAAQuuB,SAAW,GAGQ,iBAApBvuB,EAAQuuB,QAAsB,CACrC,IAAIC,EAAOxuB,EAAQuuB,QACf5T,EAAI3a,EAAQuuB,QAAU,IAAI3Y,KAC9B+E,EAAE8T,QAAQ9T,EAAE+T,UAAYF,GAI5B,OADAjoB,EAAQ4L,OAAO5L,GACPuN,SAASwa,QACbvS,mBAAmBrY,GAAM,IACzB1D,EAAQ2uB,IAAMpoB,EAAQwV,mBAAmBxV,GACzCvG,EAAQuuB,QAAU,aAAevuB,EAAQuuB,QAAQK,cAAgB,GACjE5uB,EAAQ6uB,KAAO,UAAY7uB,EAAQ6uB,KAAO,GAC1C7uB,EAAQ6W,OAAS,YAAc7W,EAAQ6W,OAAS,GAChD7W,EAAQ8uB,OAAS,WAAa,IAChCzT,KAAK,IAKX,IAAI3Q,EAAQqkB,GADZ/uB,EAAUuG,OACmBooB,IAAM,SAAUpV,GACzC,OAAOA,GACPqC,mBACJ,OAAQlR,EAAS,IAAI0G,OAAO,WAAa2K,mBAAmBrY,GAAO,YAAYie,KAAK7N,SAASwa,SAAWS,EAAOrkB,EAAO,IAAM,MAKhI8E,OAAOY,KAAK4e,aAAe,SAAUrhB,EAAKD,GAGtC,OAFAC,EAAMA,GAAO,EACbD,EAAMA,GAAO,IACN3D,KAAKC,MAAMD,KAAKE,UAAYyD,EAAMC,EAAM,IAAMA,GAQzD6B,OAAOY,KAAK6e,WAAa,SAAUjhB,EAAQiO,GACvCjO,EAASA,OACTiO,EAAQA,IAAS,KAEbzM,OAAO8B,YAEXxR,EAAE0D,KAAKwK,EAAQ,SAAUtK,EAAK6C,GAC1BiJ,OAAO8B,QAAQ5N,GAAO6C,IAI1BiJ,OAAO8B,QAAoB,WAAI9B,OAAO8B,QAAoB,YAG9D9B,OAAOY,KAAK8e,UAAY,WACpB,IAAIC,EAAc,YAAa,IAAIvZ,MAAOC,UAC1C/V,EAAE,0BAA0B0D,KAAK,WAC7Bb,KAAKmW,KAAOnW,KAAKmW,KAAKxR,QAAQ,SAAU6nB,MAShD3f,OAAOY,KAAKsZ,YAAc,SAAU1b,QAChC,IAAIohB,MAAQphB,OAAOpK,MAAQ,UACvByrB,MAAQrhB,OAAOa,MAAQ,aACvBygB,QAAUthB,OAAOA,WACjBuhB,WAAavhB,OAAOwhB,YAAa,EACjCC,SAAWzhB,OAAO0hB,SAAW,IAC7BC,eAAiB3hB,OAAO4hB,YAAc,IACtCC,SAAW7hB,OAAOsD,SAAW,QAE7Bwe,sBAAwB9hB,OAAOkM,eAAe,wBAA0BlM,OAAO+hB,oBACnFvgB,OAAOwgB,QAAUxgB,OAAOwgB,YACKnlB,MAAzB2E,OAAOwgB,QAAQZ,SACf5f,OAAOwgB,QAAQZ,WAIfG,YAAuC1kB,MAAzB2E,OAAOwgB,QAAQZ,SAC7B5f,OAAOwgB,QAAQZ,WAInB5f,OAAOwgB,QAAQZ,OAAO7jB,MAClB3H,KAAMwrB,MACNphB,OAAQshB,QACRzgB,KAAMwgB,MACNG,UAAWD,WACXS,QAASP,SACTG,WAAY,EACZK,cAAeN,eACfre,QAASue,SACTE,oBAAqBD,qBACrBI,YAAY,EACZC,SAAUpmB,KAAKmI,OAAM,IAAK0D,MAAQC,aAEtC,IAAIua,eAAiB,WACjBtwB,EAAE0D,KAAKgM,OAAOwgB,QAAS,SAAU5U,EAAGH,GAChCnb,EAAE0D,KAAKyX,EAAG,SAAUvX,IAAK6C,OACrB,IAAI8pB,IAAMtmB,KAAKmI,OAAM,IAAK0D,MAAQC,WAC9Bya,iBAAmBvmB,KAAKmI,OAAOme,IAAM9pB,MAAM4pB,UAAY5pB,MAAMypB,SAEjE,GADAxgB,OAAOwgB,QAAQzpB,MAAM3C,MAAMF,KAAiB,WAAI4sB,iBAC5CA,iBAAmB/pB,MAAM0pB,cAEzB,GAAIrc,KAAKrN,MAAM+K,UACX,IAAK/K,MAAM2pB,WAAY,CACnB,GAAI3pB,MAAMyH,QAEFlO,EAAEwT,QAAQC,KACV,IAAIgd,WAAa,WACb,OAAOhqB,MAAMsI,KAAKtI,MAAMyH,SAIpCwB,OAAOwgB,QAAQzpB,MAAM3C,MAAMF,KAAc,QAAK5D,EAAEwT,QAAY,KAAIoW,YAAY6G,WAAYhqB,MAAMypB,QAAS,cAAgBtG,YAAYnjB,MAAMsI,KAAMtI,MAAMypB,QAASzpB,MAAMyH,QACpKwB,OAAOwgB,QAAQzpB,MAAM3C,MAAMF,KAAiB,YAAI,QAE7C6C,MAAMwpB,qBACbvgB,OAAOwgB,QAAQzpB,MAAM3C,MAAM4Y,OAAO9Y,IAAK,GACvCiB,aAAa4B,MAAMiqB,WAEnBhhB,OAAOwgB,QAAQzpB,MAAM3C,MAAMF,KAAiB,YAAI,EAChDiB,aAAa4B,MAAMiqB,eAIvB7rB,aAAa4B,MAAMiqB,SACnBhhB,OAAOwgB,QAAQzpB,MAAM3C,MAAM4Y,OAAO9Y,IAAK,QAMlD8L,OAAOihB,iBACRjhB,OAAOihB,gBAAiB,EACxB/G,YAAY0G,eAAgB,OAGpC5gB,OAAOY,KAAKsgB,OAAS,SAAUnqB,GAK3B,IAYIoqB,EACAC,EARAC,GAAa,EACbC,GAAU,EACVC,GAAa,EAIbC,GAFJzqB,EAAQA,GAAS,IAEKkN,WAAW1P,MAAM,KA6BvC,OAzBA4sB,EAAYK,EAAU,IAfA,4BAiBFnc,KAAK8b,IAhBH,4BAgBiC9b,KAAK8b,IAftC,8BAeoE9b,KAAK8b,MAC3FE,GAAa,GAGbG,EAAUnpB,OAAS,IAEnB+oB,EAAYI,EAAU,GAEtBF,GAAU,EAGc,GAApBE,EAAUnpB,SACV+oB,EAAYA,EAAY,IAAMI,EAAU,IA1BhC,0CA4BEnc,KAAK+b,KACfG,GAAa,IAGjBD,EACSD,GAAcE,EAEdF,GAOjBrhB,OAAOY,KAAK6gB,mBAAqB,SAAUC,GAEvC,IAEIztB,EACAukB,GAFJkJ,EAAQA,EAAM5pB,QAAQ,QAAS,OAEfO,OACZspB,EAAU,GACd,IAAK1tB,EAAI,EAAGA,EAAIukB,EAAKvkB,IAGjB0tB,GAAW,MAFND,EAAY,WAAEztB,GACVgQ,SAAS,IACO,IAE7B,OAAO0d,GAKX3hB,OAAOY,KAAKghB,eAAiB,WACzB,IAAIC,EAAKvd,SAASwd,qBAAqB,QAAQ,GAC3CC,EAAQzd,UAAYA,SAAS0d,gBASjC,OARKH,IACDA,EAAKvd,SAAS2d,cAAc,QAC5BF,EAAMG,aAAaL,EAAIE,EAAMI,aAGjCniB,OAAOY,KAAKghB,eAAiB,WACzB,OAAOC,GAEJA,GAKX7hB,OAAOY,KAAKwhB,UAAY,SAAUC,EAAWC,GAEzC,IASmBC,EATfnvB,EAAUkR,SAASke,eAAeF,GAEtC,GAAID,IAAcjvB,EAAS,CACvB,IAAIyE,EAAMyM,SAAS2d,cAAc,SACjCpqB,EAAIuF,KAAO,WACXvF,EAAIpH,GAAK6xB,EACLzqB,EAAI+mB,WACJ/mB,EAAI+mB,WAAW3Z,QAAUod,GAEdE,EAQRje,SAASme,eAAeJ,GAPnBxqB,EAAI6qB,WAAWrqB,OACXR,EAAIsqB,WAAWQ,YAAcJ,EAAKI,WAClC9qB,EAAI+qB,aAAaL,EAAM1qB,EAAIsqB,YAG/BtqB,EAAIgrB,YAAYN,IAI5BviB,OAAOY,KAAKghB,iBAAiBiB,YAAYhrB,KAOjDmI,OAAOY,KAAKkiB,cAAgB,SAAUC,EAAMC,GACxChjB,OAAO6T,IAAI,6BACX,IAAIhc,EAAMyM,SAAS2d,cAAc,SACjCpqB,EAAIuF,KAAO,WAEX,IAAI6H,EAAU,qBAAuB+d,EAAgB,2CAA6CD,EAAO,OACzGlrB,EAAIorB,UAAYhe,EAEhBjF,OAAOY,KAAKghB,iBAAiBiB,YAAYhrB,IAG7CmI,OAAOY,KAAKsiB,0BAA4B,SAAUC,EAAWC,GACzD,IAAIC,EAAaC,EAAervB,EAAGwB,EAC/B8tB,GACAC,cAAeJ,EAAoBK,iBACnCC,iBAAkBN,EAAoBO,eACtCC,oBAAqBR,EAAoBS,eAsB7C,IAHAR,EAAc/yB,EAAEsJ,QAhBZkqB,OAAQ,IACRL,iBAAkB,IAClBE,eAAgB,IAChBE,cAAe,KAawBT,GAC3CE,EAAgBhzB,EAAEsJ,QAXdmqB,UAAU,EACVP,cAAe,IACfE,iBAAkB,IAClBM,aAAa,EACbC,eAAgB,SAChBC,eAAgB,OAChBN,oBAAqB,IACrBE,OAAQ,IAImCP,GAE1CtvB,EAAI,EAAGA,EAAIkvB,EAAUgB,YAAY9rB,OAAQpE,IAAK,CAC/C,GAAmD,SAA/CkvB,EAAUgB,YAAYlwB,GAAGmJ,KAAKkS,cAC9B,IAAK7Z,EAAI,EAAGA,EAAI0tB,EAAU3tB,KAAK6C,OAAQ5C,IACnC0tB,EAAU3tB,KAAKC,GAAG2uB,OAAOnwB,GAAK+L,OAAOY,KAAKyjB,YAAYlB,EAAU3tB,KAAKC,GAAG2uB,OAAOnwB,GAAIovB,GAG3F,GAAmD,SAA/CF,EAAUgB,YAAYlwB,GAAGmJ,KAAKkS,eAA2E,QAA/C6T,EAAUgB,YAAYlwB,GAAGmJ,KAAKkS,cACxF,IAAK7Z,EAAI,EAAGA,EAAI0tB,EAAU3tB,KAAK6C,OAAQ5C,IAAK,CACxC,IAAI6uB,EAActkB,OAAOY,KAAK2jB,cAAcpB,EAAU3tB,KAAKC,GAAG2uB,OAAOnwB,GAAIqvB,GAEzE,IAA4C,IAAxCtjB,OAAOwkB,SAASC,oBAA8B,CAC9C,IAAIC,GAAW,GAC6B,GAAxCJ,EAAYrgB,WAAW5G,QAAQ,OAC/BqnB,GAAW,EACXJ,EAAcA,EAAYxsB,QAAQ,IAAK,IAAIA,QAAQ,IAAK,KAE5D,IAAIqX,EAAK,IAAIvN,OAAO,IAAM+iB,6BAA6BlB,iBAAmB,iBAAkB,KAC5Fa,EAAcA,EAAYxsB,QAAQqX,EAAI,MACtCA,EAAK,IAAIvN,OAAO,KAAO+iB,6BAA6BlB,iBAAmB,MAAO,KAC9Ea,EAAcA,EAAYxsB,QAAQqX,EAAI,IAEjCuV,IAAUJ,EAAc,IAAMA,EAAc,KAErDnB,EAAU3tB,KAAKC,GAAG2uB,OAAOnwB,GAAKqwB,GAK1C,OAAOnB,GAIXnjB,OAAOY,KAAKgkB,cAAgB,SAAU7tB,GAElC,OAAuC,GAAnCiJ,OAAOY,KAAKuF,aAAapP,GAClBiJ,OAAOC,aAAaC,YAAY,sBACG,GAAnCF,OAAOY,KAAKuF,aAAapP,GACzBiJ,OAAOC,aAAaC,YAAY,qBAEhC,IAIfF,OAAOY,KAAKikB,uBAAyB,SAAUC,GAC3CA,EAAcA,GAAe,GAC7Bx0B,EAAE,iBAAkBw0B,GAAaC,IAAI,cAAc/wB,KAAK,SAAUM,EAAOlB,GACrE,IAAI4xB,EAAW10B,EAAE8C,GACb0pB,EAAUkI,EAAStuB,OACvBsuB,EAASxwB,SAAS,aAClB,IACI,IAAIowB,EAAgB5kB,OAAOY,KAAKgkB,cAAc9H,GAC9CkI,EAAStuB,KAAKkuB,GAChB,MAAOxjB,GACL4jB,EAAStuB,KAAKomB,OAK1B9c,OAAOY,KAAK2jB,cAAgB,SAAUxtB,EAAOkuB,GACzC,IAAIhxB,EAAI3D,EAAE,QAAQgV,KAAKvO,GAEvB,OADA9C,EAAEixB,eAAeD,GACVhxB,EAAEqR,QAMbtF,OAAOY,KAAKukB,oBAAsB,SAAUhC,EAAWE,GASnDA,EAAcA,IANVS,OAAQ,IACRL,iBAAkB,IAClBE,eAAgB,IAChBE,cAAe,KAKnB,IAAK,IAAI5vB,EAAI,EAAGA,EAAIkvB,EAAUgB,YAAY9rB,OAAQpE,IAC9C,GAAmD,SAA/CkvB,EAAUgB,YAAYlwB,GAAGmJ,KAAKkS,cAC9B,IAAK,IAAI7Z,EAAI,EAAGA,EAAI0tB,EAAU3tB,KAAK6C,OAAQ5C,IACvC0tB,EAAU3tB,KAAKC,GAAG2uB,OAAOnwB,GAAK+L,OAAOY,KAAKyjB,YAAYlB,EAAU3tB,KAAKC,GAAG2uB,OAAOnwB,GAAIovB,GAK/F,OAAOF,GAcXnjB,OAAOY,KAAKyjB,YAAc,SAAUttB,EAAOkuB,GACvC,IAAI/pB,EAAS,GACTkqB,EAAY,GACZC,EAAa,GACbC,EAAiB,GACjBC,EAAgB,GAChBC,EAAczuB,EAAQ,EAQ1B,GANa,MAATA,IACAA,EAAQ,KAGZA,EAAQA,EAAMkN,YAEJ5L,QAAU,EAAG,CACnB,IAAIotB,EAAuB1uB,EAAMsG,QAAQ,KAEzC,GAAIooB,EAAuB,EAEvBJ,GADAtuB,EAAQiJ,OAAOY,KAAK8kB,iBAAiB3uB,EAAOkuB,EAAOpB,gBAChClS,UAAU,EAAG8T,GAAsB3tB,QAAQ,MAAO,QAClE,CAGH,IAFA,IAES7D,EAAI,EAAGA,EAAIgxB,EAAOpB,cAAe5vB,IACtCsxB,GAHW,IAKfF,EAAatuB,EAAMe,QAAQ,MAAO,IAYtC,GARAf,EAAQA,EAAMe,QAAQ,MAAO,IAGzBwtB,EADAL,EAAOpB,cAAgB,EACN4B,EAAuB,EAAIR,EAAOxB,iBAAmB1sB,EAAM4a,UAAU5a,EAAMsB,OAAS4sB,EAAOpB,cAAe9sB,EAAMsB,QAAU4sB,EAAOxB,iBAAmB8B,EAEpJ,GAGjBF,EAAWhtB,OAAS,EAAG,CACvB,IAAIqd,EAAQ,EAGZ,IAASzhB,EAAIoxB,EAAWhtB,OAAS,EAAGpE,GAAK,EAAGA,IAC3B,GAATyhB,IACA0P,GAAa,IACb1P,EAAQ,GAEZ0P,GAAaC,EAAWpxB,GACxByhB,GAAS,EAGb,IAASzhB,EAAImxB,EAAU/sB,OAAS,EAAGpE,GAAK,EAAGA,IACvCiH,GAAUkqB,EAAUnxB,QAGxBiH,EAASmqB,EAMb,GAFAnqB,EAASA,EAAO4T,WAAW,IAAKmW,EAAOtB,gBAEnC6B,EAEAtqB,EADqB8E,OAAOC,aAAaC,YAAY,iBAAiB+jB,eAC9CnsB,QAAQ,KAAMmtB,EAAOnB,QAAQhsB,QAAQ,KAAMoD,EAASoqB,QAE5EpqB,EAAS+pB,EAAOnB,OAAS5oB,EAASoqB,EAGtC,OAAOpqB,EAEP,OAAOnE,GASfiJ,OAAOY,KAAK+kB,uBAAyB,SAAUC,GAC3C,OAAOA,EAAY9tB,QAAQ,MAAO,KAOtCkI,OAAOY,KAAK8kB,iBAAmB,SAAU3uB,EAAO8sB,GAC5C,IAAI4B,EAEAH,EAMJ,GAJAG,EAAuB1uB,EAAMsG,QAAQ,KACxBtG,EAAM4a,UAAU,EAAG8T,GAG5B5B,GAFJyB,EAAiBvuB,EAAM4a,UAAU8T,EAAuB,EAAG1uB,EAAMsB,SAE9BA,OAC/B,IAAK,IAAIpE,EAAIqxB,EAAejtB,OAAQpE,EAAI4vB,EAAe5vB,IACnD8C,GAAS,SAGbA,EAAQwc,WAAWxc,GAAO8uB,QAAQhC,GAGtC,OAAO9sB,GAOXiJ,OAAOY,KAAKklB,qBAAuB,SAAUhB,EAAazB,GACtDyB,EAAcA,GAAe,GAC7B,IAAIiB,GACAjC,OAAQT,EAAYS,OACpBL,iBAAkBJ,EAAYI,kBAAoB,IAClDE,eAAgBN,EAAYM,gBAAkB,IAC9CE,cAAeR,EAAYQ,eAAiB,MAEd,IAA9BR,EAAY2C,gBACZD,EAAclC,cAAgB,KAGlCvzB,EAAE,eAAgBw0B,GAAaC,IAAI,aAAa/wB,KAAK,SAAUM,EAAOshB,GAClE,IAAIkH,EAAUxsB,EAAEslB,GAAMlf,OACtBpG,EAAEslB,GAAMphB,SAAS,YACjB,IACI,IAAIuC,EAAQwc,WAAWuJ,GACvB,IAAKlN,MAAM7Y,GAAQ,CACf,IAAIstB,EAAcrkB,OAAOY,KAAKyjB,YAAYttB,EAAOgvB,GACjDz1B,EAAEslB,GAAMlf,KAAK2tB,IAEnB,MAAOjjB,GAEL9Q,EAAEslB,GAAMlf,KAAKomB,OAQzB9c,OAAOY,KAAKqlB,sBAAwB,SAAUnB,EAAaoB,GACvDpB,EAAcA,GAAe,GAC7B,IAAIjB,EAAgB,IAEhBA,EAD8B,KAA9BqC,EAAarC,cACG,IAEAqC,EAAarC,eAAiB,IAElD,IAAIkC,GACAjC,OAAQ,GACRL,iBAAkByC,EAAazC,kBAAoB,IACnDE,eAAgBuC,EAAavC,gBAAkBuC,EAAaC,UAAY,IAAM,GAC9EtC,cAAeA,GAEnBvzB,EAAE,eAAgBw0B,GAAaC,IAAI,aAAa/wB,KAAK,SAAUM,EAAOshB,GAClE,IAAIkH,EAAUxsB,EAAEslB,GAAMlf,OACtBpG,EAAEslB,GAAMphB,SAAS,YACjB,IACI,IAAI4xB,EAAiBtJ,EAAQ7L,MAAM,YAC/Bla,EAA2B,MAAlBqvB,GAA0BA,EAAe/tB,OAAS,EAAKgJ,IAAMkS,WAAWuJ,GACrF,IAAKlN,MAAM7Y,GAAQ,CACf,IAAIsvB,EAAermB,OAAOY,KAAKyjB,YAAYttB,EAAOgvB,GAC9CG,EAAaI,aACbD,EAAeA,EAAapiB,WAAa,KAE7C3T,EAAEslB,GAAMlf,KAAK2vB,IAEnB,MAAOjlB,GAEL9Q,EAAEslB,GAAMlf,KAAKomB,OAQzB9c,OAAOY,KAAK2lB,oBAAsB,SAAUzB,EAAa3c,GACrD2c,EAAcA,GAAe,GAC7B3c,EAAaA,GAAc,sBAC3B7X,EAAE,cAAew0B,GAAaC,IAAI,aAAa/wB,KAAK,SAAUM,EAAOshB,GACjE,IAAIkH,EAAUxsB,EAAEslB,GAAMlf,OACtBpG,EAAEslB,GAAMphB,SAAS,YACjB,IACI,IAAIuC,EAAQ,IAAIqP,KAAK0W,GACjB0J,EAAiBre,EAEjBnI,OAAOY,KAAK6lB,YAAY1vB,KACxByvB,EAAiBxmB,OAAOY,KAAK8lB,cAAc3vB,EAAOyvB,IAEtD,IAAIG,EAAa3mB,OAAOY,KAAKgmB,cAAcD,WAAW5vB,EAAOyvB,GAC7Dl2B,EAAEslB,GAAMlf,KAAKiwB,GACf,MAAOvlB,GAEL9Q,EAAEslB,GAAMlf,KAAKomB,OASzB9c,OAAOY,KAAKimB,kCAAoC,SAAUC,GACtD,GAAI9mB,OAAOY,KAAK6lB,YAAYK,GAAsB,CAC9C,IAAIN,EAAiBxmB,OAAOC,aAAaC,YAAY,cAAgB,IAAMF,OAAOC,aAAaC,YAAY,cACvGnJ,EAAQ,IAAIqP,KAAK0gB,GAIrB,OAHAN,EAAiBxmB,OAAOY,KAAK8lB,cAAc3vB,EAAOyvB,GAEjCxmB,OAAOY,KAAKgmB,cAAcD,WAAW5vB,EAAOyvB,GAGjE,OAAOM,GAAuB,IAGlC9mB,OAAOY,KAAK8lB,cAAgB,SAAUK,EAAWC,GAC7C,IAAIR,EAAiBQ,EAEjBC,EAAIF,EAAUG,WACdjd,EAAI8c,EAAUI,aACdpd,EAAIgd,EAAUK,aACdC,EAAKN,EAAUO,kBAMnB,OAHU,IAANL,GAAiB,IAANhd,GAAiB,IAANF,GAAkB,IAAPsd,IACjCb,EAAiBxmB,OAAOC,aAAaC,YAAY,eAE9CsmB,GAOXxmB,OAAOY,KAAK2mB,sBAAwB,SAAUxwB,EAAOywB,GASjD,IAAItsB,EAASnE,EACb,OAAQywB,GACJ,IAAK,QACL,KAAK,GACL,IAAK,OACL,KAAK,GACL,IAAK,UACL,KAAK,GACL,IAAK,OACL,KAAK,GACGzwB,GAASA,EAAMsB,OAAS,KACxB6C,EAAS8E,OAAOY,KAAK6mB,iBAAiB1wB,IAE1C,MACJ,IAAK,UACL,KAAK,EACL,IAAK,SACL,KAAK,GACDmE,EAAS8E,OAAOY,KAAKgkB,cAAc7tB,GACnC,MACJ,IAAK,MACL,KAAK,EACL,IAAK,SACL,KAAK,EACL,IAAK,WACL,KAAK,EACL,IAAK,UACL,KAAK,EACL,IAAK,UACL,KAAK,EACDmE,EAAS,MAACnE,EAAyC,GAAKA,EACxD,MACJ,IAAK,QACL,KAAK,EACDmE,EAAS8E,OAAOY,KAAK8mB,mBAAmB3wB,GACxC,MACJ,IAAK,QACL,KAAK,GACL,IAAK,OACL,KAAK,GACL,IAAK,UACL,KAAK,EACDmE,EAAS8E,OAAOY,KAAK+mB,kBAAkB5wB,GACvC,MACJ,IAAK,WACL,KAAK,GACL,IAAK,gBACL,KAAK,GACDmE,EAAS8E,OAAOY,KAAKimB,kCAAkC9vB,GAM/D,OAHc,MAAVmE,IACAA,EAAS,IAENA,GAMX8E,OAAOY,KAAK6lB,YAAc,SAAUjoB,GAChC,QAAuB,IAAZ,GAAqC,MAAVA,EAAgB,CAClD,IAAIopB,EAAY,IAAIxhB,KAAK5H,GACzB,OAAQoR,MAAMgY,EAAUC,WACrB,OAAO,GAMlB7nB,OAAOY,KAAKiH,WAAa,IAAIxJ,MAAM,UAAW,WAAY,QAAS,QAAS,MAAO,OAAQ,OAAQ,SAAU,YAAa,UAAW,WAAY,WAAY,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAC1O2B,OAAOY,KAAKmH,SAAW,IAAI1J,MAAM,SAAU,SAAU,UAAW,YAAa,WAAY,SAAU,WAAY,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAEzJ2B,OAAOY,KAAKgmB,cAAgB,IAAI,WAC5BzzB,KAAK20B,GAAK,SAAU7Z,GAChB,OAAQA,EAAI,GAAKA,EAAI,EAAI,GAAK,KAAOA,GASzC9a,KAAK+tB,OAAS,SAAU3e,EAAK0iB,GAEzB,OAAY,GADD9xB,KAAK40B,kBAAkBxlB,EAAK0iB,IAO3C9xB,KAAK60B,gBAAkB,SAAUC,EAAM9f,EAAY+f,GAE/C,IACIrH,EAAM,IAAIza,KACV+hB,EAAQF,aAAgB7hB,KAAQ6hB,EAAOG,MAAMR,UAAUK,EAAM9f,GAC7DkgB,EAAOxH,EAAIxa,UAAY8hB,EAAK9hB,UAC5BiiB,EAAWC,EAAuBF,EAAM,OAAQ,QAAaH,GAgCjE,OA9BKI,IACDA,EAAWC,EAAuBF,EAAM,QAAS,OAAYH,MAEzDI,EAAWC,EAAuBF,EAAM,OAAQ,OAAWH,MAEvDI,EAAWC,EAAuBF,EAAM,MAAO,MAAUH,MAErDI,EAAWC,EAAuBF,EAAM,OAAQ,KAASH,MAErDI,EAAWC,EAAuBF,EAAM,SAAU,IAAOH,MAEjDA,EAEII,EAAWC,EADF,IAATF,EACkCA,EAAO,EAEPA,EAFU,SAAU,EAAGH,IAK7DI,EAAWC,EAAuBF,EAAM,SAAU,IAAMH,MAEpDI,EAAWtoB,OAAOC,aAAaC,YAAY,uCAUpEooB,EAKP,SAASC,EAAuBF,EAAMG,EAAMC,EAAaP,GACrD,IAAIQ,GAAcL,EAAOI,GAAa5C,QAAQ,GAE9C,GAAI6C,EAAa,EAAG,CAChB,GAAIR,EACA,OAAsB,GAAdQ,EAAkB1oB,OAAOC,aAAaC,YAAY,2BAA6BsoB,GAAM1wB,QAAQ,KAAM4wB,GAAc1oB,OAAOC,aAAaC,YAAY,2BAA6BsoB,EAAO,KAAK1wB,QAAQ,KAAM4wB,GAEhN,IAAIC,EAAc3oB,OAAOC,aAAaC,YAAY,+BAClD,OAAsB,GAAdwoB,EAAkBC,EAAY7wB,QAAQ,KAAMkI,OAAOC,aAAaC,YAAY,2BAA6BsoB,GAAM1wB,QAAQ,KAAM4wB,IAAeC,EAAY7wB,QAAQ,KAAMkI,OAAOC,aAAaC,YAAY,2BAA6BsoB,EAAO,KAAK1wB,QAAQ,KAAM4wB,IAIzQ,OAAO,OAanBv1B,KAAKy1B,aAAe,SAAUC,EAAOC,EAAaC,EAAOC,GACrD,IAAIC,EAAKlB,kBAAkBc,EAAOC,GAC9BI,EAAKnB,kBAAkBgB,EAAOC,GAClC,OAAU,GAANC,GAAiB,GAANC,GACH,EACDD,EAAKC,EACL,EAEJ,GAUX/1B,KAAKg2B,0BAA4B,SAAUN,EAAOE,EAAOP,GACrD,KAAIK,aAAiBziB,MAAQyiB,aAAiBziB,MAU1C,MAAO,wBATP,OAAQoiB,GACJ,IAAK,UACD,OAAQO,EAAM1iB,UAAYwiB,EAAMxiB,WAAa,IACjD,IAAK,eACD,OAAQ0iB,EAAM1iB,UAAYwiB,EAAMxiB,UACpC,QACI,MAAO,wBAYvBlT,KAAKwzB,WAAa,SAAUsB,EAAMhD,EAAQmE,GAEtC,IAAKppB,OAAOY,KAAK6lB,YAAYwB,IAAiB,GAARA,EAClC,MAAO,GAGX,IAAIpgB,EAAa7H,OAAOY,KAAKiH,WACzBE,EAAW/H,OAAOY,KAAKmH,SAC3Bkd,GAAkB,GAClB,IAEIzW,EACA6a,EAHAnuB,EAAS,GACTouB,EAAW,EAGXpb,EAAI+Z,EAAKsB,cAAgB,GACzBtX,EAAIgW,EAAKuB,WAAa,EACtB/a,EAAIwZ,EAAK/I,UACTuK,EAAIxB,EAAKyB,SACTzC,EAAIgB,EAAKf,WACTjd,EAAIge,EAAKd,aACTpd,EAAIke,EAAKb,aACTpZ,EAAIia,EAAKX,kBAETvwB,EAAQ,IAAIic,OAMhB,GAJIhT,OAAOY,KAAK+oB,gBAAgB,wBAC5BP,EAAOppB,OAAOC,aAAaC,YAAY,uBAGvCkpB,EAAM,CACN,IAAIQ,EAASR,EAAKvhB,WAAWwD,OAAO+d,EAAKthB,iBACrCkX,EAAOoK,EAAKrhB,SAASsD,OAAO+d,EAAKphB,eACrCH,EAAaA,EAAW5D,aAAe2lB,EAAO3lB,WAAa4D,EAAa+hB,EACxE7hB,EAAWA,EAAS9D,aAAe+a,EAAK/a,WAAa8D,EAAWiX,EAqDpE,KAlDI9Q,EAAE7V,OAAS,GAAsB,MAAhB6V,EAAEmB,OAAO,IAAcnB,EAAE7V,OAAS,KACnD6V,EAAI,IAAMA,EAAI,EAAI,OAEtBnX,EAAS,EAAI,GAAKmX,EAClBnX,EAAY,KAAImX,EAChBnX,EAAU,GAAImX,EAAEyD,UAAU,EAAG,GAC7B5a,EAAS,EAAIkb,EACblb,EAAU,GAAI5D,KAAK20B,GAAG7V,GACtBlb,EAAW,IAAI8Q,EAAWoK,EAAI,IAC9Blb,EAAY,KAAI8Q,EAAWoK,EAAI,GAC/Blb,EAAW,IAAI8Q,EAAWoK,EAAI,IAC9Blb,EAAS,EAAI0X,EACb1X,EAAU,GAAI5D,KAAK20B,GAAGrZ,GACtB1X,EAAW,IAAIgR,EAAS0hB,EAAI,GAC5B1yB,EAAY,KAAIgR,EAAS0hB,GACzB1yB,EAAS,EAAIgR,EAAS0hB,EAAI,GAC1B1yB,EAAU,GAAIgR,EAAS0hB,GACvB1yB,EAAS,EAAIkwB,EACblwB,EAAU,GAAI5D,KAAK20B,GAAGb,GACtBlwB,EAAU,GAAIkwB,EAAI,GAAK,KAAO,KAC9BlwB,EAAU,GAAIkwB,EAAI,GAAK,KAAO,KAI1BlwB,EAAS,EADJ,GAALkwB,EACa,GACNA,EAAI,GACEA,EAAI,GAEJA,EAEjBlwB,EAAU,GAAI5D,KAAK20B,GAAG/wB,EAAS,GAE3BA,EAAS,EADTkwB,EAAI,GACSA,EAAI,GAEJA,EAEjBlwB,EAAS,EAAIkwB,EAAI,EACjBlwB,EAAU,GAAI5D,KAAK20B,GAAG/wB,EAAS,GAC/BA,EAAU,GAAI5D,KAAK20B,GAAG/wB,EAAS,GAE3BA,EAAS,EADTkwB,EAAI,GACS,KAEA,KAEjBlwB,EAAS,EAAIkT,EACblT,EAAU,GAAI5D,KAAK20B,GAAG7d,GACtBlT,EAAS,EAAIgT,EACbhT,EAAU,GAAI5D,KAAK20B,GAAG/d,GACtBhT,EAAW,IAAIiX,EAERsb,EAAWrE,EAAO5sB,QAAQ,CAG7B,IAFAmW,EAAIyW,EAAO5V,OAAOia,GAClBD,EAAQ,GACApE,EAAO5V,OAAOia,IAAa9a,GAAO8a,EAAWrE,EAAO5sB,QACxDgxB,GAASpE,EAAO5V,OAAOia,KAEP,MAAhBvyB,EAAMsyB,GACNnuB,GAAkBnE,EAAMsyB,GAExBnuB,GAAkBmuB,EAG1B,OAAOnuB,GASX/H,KAAK40B,kBAAoB,SAAUxlB,EAAK0iB,EAAQmE,GAC5C,IAAIvhB,EAAa7H,OAAOY,KAAKiH,WACzBE,EAAW/H,OAAOY,KAAKmH,SAC3BxF,GAAY,GACZ0iB,GAAkB,GAClB,IAEIzW,EACA6a,EAHAQ,EAAQ,EACRP,EAAW,EAGXrb,EAAI,EACJC,EAAI,EACJ2S,EAAM,IAAIza,KACV0jB,EAAOjJ,EAAIkJ,UACXC,EAAQnJ,EAAI2I,WAAa,EACzBvB,EAAO,EACPgC,EAAKpJ,EAAIqG,WACTgD,EAAKrJ,EAAIsG,aACTgD,EAAKtJ,EAAIuG,aAETgD,GADMvJ,EAAIyG,kBACH,IAMX,GAJItnB,OAAOY,KAAK+oB,gBAAgB,wBAC5BP,EAAOppB,OAAOC,aAAaC,YAAY,uBAGvCkpB,EAAM,CACN,IAAIQ,EAASR,EAAKvhB,WAAWwD,OAAO+d,EAAKthB,iBACrCkX,EAAOoK,EAAKrhB,SAASsD,OAAO+d,EAAKphB,eACrCH,EAAaA,EAAW5D,aAAe2lB,EAAO3lB,WAAa4D,EAAa+hB,EACxE7hB,EAAWA,EAAS9D,aAAe+a,EAAK/a,WAAa8D,EAAWiX,EAGpE,KAAOsK,EAAWrE,EAAO5sB,QAAQ,CAI7B,IAFAmW,EAAIyW,EAAO5V,OAAOia,GAClBD,EAAQ,GACApE,EAAO5V,OAAOia,IAAa9a,GAAO8a,EAAWrE,EAAO5sB,QACxDgxB,GAASpE,EAAO5V,OAAOia,KAG3B,GAAa,QAATD,GAA4B,MAATA,GAA0B,KAATA,EAAc,CAclD,GAba,QAATA,IACApb,EAAI,EACJC,EAAI,GAEK,MAATmb,IACApb,EAAI,EACJC,EAAI,GAEK,KAATmb,IACApb,EAAI,EACJC,EAAI,GAGI,OADZ4b,EAAOO,EAAQ9nB,EAAKsnB,EAAO5b,EAAGC,IAE1B,OAAO,EAEX2b,GAASC,EAAKzxB,OACK,GAAfyxB,EAAKzxB,SAEDyxB,EADAA,EAAO,GACQA,EAAO,EAAf,KAEQA,EAAO,EAAf,UAGZ,GAAa,QAATT,GAA4B,OAATA,GAA2B,OAATA,EAAgB,CAC5DW,EAAQ,EACR,IAAK,IAAI/1B,EAAI,EAAGA,EAAI4T,EAAWxP,OAAQpE,IAAK,CACxC,IAAIq2B,EAAaziB,EAAW5T,GAC5B,GAAIsO,EAAIoP,UAAUkY,EAAOA,EAAQS,EAAWjyB,QAAQuL,eAAiB0mB,EAAW1mB,gBAC/D,QAATylB,GAA4B,OAATA,GAA4B,OAATA,GAAkBp1B,EAAI,IAAK,EACjE+1B,EAAQ/1B,EAAI,GACA,KACR+1B,GAAS,IAEbH,GAASS,EAAWjyB,OACpB,OAIZ,GAAK2xB,EAAQ,GAAOA,EAAQ,GACxB,OAAO,OAER,GAAa,QAATX,GAA4B,MAATA,GAA0B,KAATA,EAC3C,IAAK,IAAI5zB,EAAI,EAAGA,EAAIsS,EAAS1P,OAAQ5C,IAAK,CACtC,IAAI80B,EAAWxiB,EAAStS,GACxB,GAAI8M,EAAIoP,UAAUkY,EAAOA,EAAQU,EAASlyB,QAAQuL,eAAiB2mB,EAAS3mB,cAAe,CACvFimB,GAASU,EAASlyB,OAClB,YAGL,GAAa,MAATgxB,GAA0B,KAATA,EAAc,CAEtC,GAAa,OADbW,EAAQK,EAAQ9nB,EAAKsnB,EAAO,EAAG,KACTG,EAAQ,GAAOA,EAAQ,GACzC,OAAO,EAEXH,GAASG,EAAM3xB,YACZ,GAAa,MAATgxB,GAA0B,KAATA,EAAc,CAEtC,GAAY,OADZpB,EAAOoC,EAAQ9nB,EAAKsnB,EAAO,EAAG,KACT5B,EAAO,GAAOA,EAAO,GACtC,OAAO,EAEX4B,GAAS5B,EAAK5vB,YACX,GAAa,MAATgxB,GAA0B,KAATA,EAAc,CAEtC,GAAU,OADVY,EAAKI,EAAQ9nB,EAAKsnB,EAAOR,EAAMhxB,OAAQ,KACpB4xB,EAAK,GAAOA,EAAK,GAChC,OAAO,EAEXJ,GAASI,EAAG5xB,YACT,GAAa,MAATgxB,GAA0B,KAATA,EAAc,CAEtC,GAAU,OADVY,EAAKI,EAAQ9nB,EAAKsnB,EAAOR,EAAMhxB,OAAQ,KACpB4xB,EAAK,GAAOA,EAAK,GAChC,OAAO,EAEXJ,GAASI,EAAG5xB,YACT,GAAa,MAATgxB,GAA0B,KAATA,EAAc,CAEtC,GAAU,OADVY,EAAKI,EAAQ9nB,EAAKsnB,EAAOR,EAAMhxB,OAAQ,KACpB4xB,EAAK,GAAOA,EAAK,GAChC,OAAO,EAEXJ,GAASI,EAAG5xB,YACT,GAAa,MAATgxB,GAA0B,KAATA,EAAc,CAEtC,GAAU,OADVY,EAAKI,EAAQ9nB,EAAKsnB,EAAOR,EAAMhxB,OAAQ,KACpB4xB,EAAK,GAAOA,EAAK,GAChC,OAAO,EAEXJ,GAASI,EAAG5xB,OACZ4xB,SACG,GAAa,MAATZ,GAA0B,KAATA,EAAc,CAEtC,GAAU,OADVa,EAAKG,EAAQ9nB,EAAKsnB,EAAOR,EAAMhxB,OAAQ,KACpB6xB,EAAK,GAAOA,EAAK,GAChC,OAAO,EAEXL,GAASK,EAAG7xB,YACT,GAAa,MAATgxB,GAA0B,KAATA,EAAc,CAEtC,GAAU,OADVc,EAAKE,EAAQ9nB,EAAKsnB,EAAOR,EAAMhxB,OAAQ,KACpB8xB,EAAK,GAAOA,EAAK,GAChC,OAAO,EAEXN,GAASM,EAAG9xB,YACT,GAAa,OAATgxB,EAAgB,CAEvB,GADAmB,GAAKH,EAAQ9nB,EAAKsnB,EAAOR,EAAMhxB,OAAQ,GAC7B,MAANmyB,IAAeA,GAAK,GAAOA,GAAK,IAChC,OAAO,EAEXX,GAASW,GAAGnyB,YACT,GAAa,KAATgxB,GAAyB,MAATA,EAAe,CACtC,GAAqD,MAAjD9mB,EAAIoP,UAAUkY,EAAOA,EAAQ,GAAGjmB,cAChCwmB,EAAO,SACJ,CAAA,GAAqD,MAAjD7nB,EAAIoP,UAAUkY,EAAOA,EAAQ,GAAGjmB,cAGvC,OAAO,EAFPwmB,EAAO,KAIXP,GAAS,MACN,CACH,GAAItnB,EAAIoP,UAAUkY,EAAOA,EAAQR,EAAMhxB,SAAWgxB,EAC9C,OAAO,EAEPQ,GAASR,EAAMhxB,QAM3B,GAAa,GAAT2xB,EAEA,GAAMF,EAAO,GAAK,GAAOA,EAAO,KAAO,GAAQA,EAAO,KAAO,GACzD,GAAI7B,EAAO,GACP,OAAO,OAGX,GAAIA,EAAO,GACP,OAAO,EAInB,OAAc,GAAT+B,GAAyB,GAATA,GAAyB,GAATA,GAAyB,IAATA,IAC7C/B,EAAO,GACA,GAIXgC,EAAK,IAAc,MAARG,EACXH,EAAKA,EAAK,EAAI,GACPA,EAAK,IAAc,MAARG,IAClBH,GAAM,IAEI,IAAI7jB,KAAK0jB,EAAME,EAAQ,EAAG/B,EAAMgC,EAAIC,EAAIC,IAMtD,SAASM,EAAWC,GAEhB,IADA,IACS9e,EAAI,EAAGA,EAAI8e,EAAKryB,OAAQuT,IAC7B,IAAuC,GAF9B,aAEEvO,QAAQqtB,EAAKrb,OAAOzD,IAC3B,OAAO,EAGf,OAAO,EAKX,SAASye,EAAQ7a,EAAKtF,EAAGygB,EAAWC,GAChC,IAAK,IAAI3gB,EAAI2gB,EAAW3gB,GAAK0gB,EAAW1gB,IAAK,CACzC,IAAI4gB,EAASrb,EAAImC,UAAUzH,EAAGA,EAAID,GAClC,GAAI4gB,EAAOxyB,OAASsyB,EAChB,OAAO,KAEX,GAAIF,EAAWI,GACX,OAAOA,EAGf,OAAO,OAgBf13B,KAAKy0B,UAAY,SAAUrlB,GAOvB,IANA,IAKIkM,EALAqc,EAAkC,GAApBtpB,UAAUnJ,QAAemJ,UAAU,GACjDupB,EAAiB,IAAI1sB,MAAM,QAAS,WAAY,UAAW,UAAW,UAAW,SACjF2sB,EAAa,IAAI3sB,MAAM,QAAS,QAAS,QAAS,QAAS,MAAO,OAClE4sB,EAAY,IAAI5sB,MAAM,QAAS,QAAS,QAAS,QAAS,MAAO,OACjE6sB,EAAY,IAAI7sB,MAAM0sB,EAAgBD,EAAaG,EAAYD,EAAYF,EAAaE,EAAaC,GAEhGh3B,EAAI,EAAGA,EAAIi3B,EAAU7yB,OAAQpE,IAElC,IADA,IAAIiW,EAAIsH,OAAO0Z,EAAUj3B,IAChBwB,EAAI,EAAGA,EAAIyU,EAAE7R,OAAQ5C,IAE1B,GAAS,IADTgZ,EAAIsZ,kBAAkBxlB,EAAK2H,EAAEzU,KAEzB,OAAO,IAAI2Q,KAAKqI,GAI5B,OAAO,MAKXtb,KAAKg4B,kBAAoB,SAAUC,GAW/B,IAVA,IACI5c,EAQA6a,EATAp1B,EAAI,EAGJo3B,GACAC,aAAa,EACbC,aAAa,EACbC,UAAW,KAGJC,EAAY,GAChBx3B,EAAIm3B,EAAW/yB,QAAQ,CAI1B,IAFAmW,EAAI4c,EAAW/b,OAAOpb,GACtBo1B,EAAQ,GACA+B,EAAW/b,OAAOpb,IAAMua,GAAOva,EAAIm3B,EAAW/yB,QAClDgxB,GAAS+B,EAAW/b,OAAOpb,KAIlB,MAATo1B,GAA0B,KAATA,GACjBoC,EAAYpC,EACZgC,EAAUC,aAAc,GACR,MAATjC,GAA0B,KAATA,GACxBoC,EAAYpC,EACZgC,EAAUC,aAAc,GACR,MAATjC,GAA0B,KAATA,EACxBoC,EAAYpC,EACI,MAATA,GAA0B,KAATA,GACxBoC,EAAYpC,EACZgC,EAAUE,aAAc,GACR,KAATlC,EACPoC,EAAYpC,EAEmB,KAA3BoC,EAAUnc,eAAmD,MAA3Bmc,EAAUnc,gBAC5C+b,EAAUG,UAAYnC,GAKlC,OAAOgC,GAEXl4B,KAAKu4B,qBAAuB,SAAU30B,EAAO40B,GAEzC50B,EAAyB,iBADzBA,EAAkB,MAATA,EAAiB,GAAKA,GACMA,EAAMkN,WAAalN,EACxD,IAAI60B,EAAmB,cAAgBD,EAAW,WAAa,IAC3DA,GACI50B,IAAUA,EAAM6M,cAAcvG,QAAQ,MAAQ,GAAKtG,EAAM6M,cAAcvG,QAAQ,MAAQ,KACvFuuB,EAAmB,wBAG3B,IAAI3D,EAAOjoB,OAAOY,KAAKgmB,cAAcmB,kBAAkBhxB,EAAO60B,GAW9D,OATY,GAAR3D,GAAc0D,EAGC,GAAR1D,GAAa0D,GAAqB,MAAT50B,GAA0B,IAATA,IACjD60B,EAAmB,cACnB3D,EAAOjoB,OAAOY,KAAKgmB,cAAcmB,kBAAkBhxB,EAAO60B,IACrDC,SAAS,EAAG,EAAG,EAAG,KALvBD,EAAmB,qBACnB3D,EAAOjoB,OAAOY,KAAKgmB,cAAcmB,kBAAkBhxB,EAAO60B,IAOvD3D,GAEX90B,KAAK24B,gBAAkB,SAAU7D,EAAM0D,GACnC,IAAIC,EAAmB,cAAgBD,EAAW,YAAc,IAEhE,OADoB3rB,OAAOY,KAAKgmB,cAAcD,WAAWsB,EAAM2D,IAGnEz4B,KAAK44B,eAAiB,SAAUh1B,EAAO40B,GACnC,IAAIK,EAAa,cAAgBL,EAAW,SAAW,IACnD1D,EAAOjoB,OAAOY,KAAKgmB,cAAcmB,kBAAkBhxB,EAAOi1B,GAkB9D,OAhBY,GAAR/D,GAAa0D,IACbK,EAAa,cAAgBL,EAAW,YAAc,IACtD1D,EAAOjoB,OAAOY,KAAKgmB,cAAcmB,kBAAkBhxB,EAAOi1B,IAIlD,GAAR/D,GAAc0D,IACdK,EAAa,mBAGD,IAFZ/D,EAAOjoB,OAAOY,KAAKgmB,cAAcmB,kBAAkBhxB,EAAOi1B,MAGtDA,EAAa,sBACb/D,EAAOjoB,OAAOY,KAAKgmB,cAAcmB,kBAAkBhxB,EAAOi1B,KAI3D/D,GAEX90B,KAAK84B,UAAY,SAAUhE,EAAM0D,GAC7B,IAAIK,EAAa,cAAgBL,EAAW,SAAW,IAEvD,OADoB3rB,OAAOY,KAAKgmB,cAAcD,WAAWsB,EAAM+D,IAInE74B,KAAK+4B,cAAgB,SAAUC,EAAYC,GAMvC,OALIA,EAAwBA,IAAyB,IAGjDD,EAAWN,SAAS,EAAG,EAAG,EAAG,GAE1B7rB,OAAOY,KAAKgmB,cAAcD,WAAWwF,EAJvB,wBAOzBh5B,KAAKk5B,gBAAkB,SAAUC,GAE7B,MADyB,gEACCjnB,KAAKinB,IAGnCn5B,KAAKo5B,MAAQ,SAAUC,GAGnB,IADA,IAAIC,GAAQ,IAAIrmB,MAAOC,WAChB,IAAID,MAAOC,UAAYomB,EAAQD,MAI1Cr5B,KAAKu5B,kCAAoC,WACrC,OAAO1sB,OAAOC,aAAaC,YAAY,cAAcpI,QAAQ,OAAQ,QAQ7EkI,OAAOY,KAAK+rB,2BAA6B,WACrC,IACI,MAAO,iBAAkBnb,QAAqC,OAA3BA,OAAqB,aAC1D,MAAOpQ,GACL,OAAO,IAMfpB,OAAOY,KAAKgsB,oBAAsB,SAAU14B,EAAK6C,GAC7C,QAAIiJ,OAAOY,KAAK+rB,+BACZE,aAAaC,QAAQ54B,EAAK6C,IACnB,IAMfiJ,OAAOY,KAAKmsB,oBAAsB,SAAU74B,GACxC,OAAO24B,aAAaG,QAAQ94B,IAGhC8L,OAAOY,KAAKqsB,uBAAyB,SAAU/4B,GAC3C24B,aAAaK,WAAWh5B,IAG5B8L,OAAOY,KAAKusB,kBAAoB,WACxBntB,OAAOY,KAAK+rB,8BACZE,aAAaO,SA2BE,UAD6B,oBAAtB5O,mBAAqCA,mBAAqB,WAEnD,iBAAlBhN,OAAOoC,UACdpC,OAAOoC,SACHC,IAAK,SAAU3R,OAID,iBAAX0R,QACPpC,OAAOoC,SACHC,IAAK,SAAU3R,MAEZmrB,eAAiBA,aAAaC,iBACrC1Z,QAAQC,IAAM,SAAUvR,MAKpCtC,OAAOY,KAAKI,WAAWrM,aAAe,SAAUqgB,IACvBA,GAAa1kB,EAAE,SACrByE,OAAO,+GAE1BiL,OAAOY,KAAKI,WAAWC,YAAc,SAAU+T,GAC3C,IAAIuY,EAAiBvY,GAAa1kB,EAAE,QACpCA,EAAE,6BAA8Bi9B,GAAgB56B,UAWpDqN,OAAOY,KAAK4sB,iBAAmB,SAAUC,EAAWr6B,GAChD,IACIs6B,EADAC,IAAkB,WAAYrpB,SAAS0d,iBAG3C,QAAKyL,IAGAr6B,GAA8B,iBAAZA,IACnBA,EAAUkR,SAAS2d,cAAc7uB,GAAW,UAOhDs6B,GADAD,EAAY,KAAOA,KACQr6B,IAGPu6B,IACXv6B,EAAQ0R,eAGT1R,EAAUkR,SAAS2d,cAAc,QAEjC7uB,EAAQ0R,cAAgB1R,EAAQ+R,kBAChC/R,EAAQ0R,aAAa2oB,EAAW,IAChCC,EAA4C,mBAAvBt6B,EAAQq6B,QAEFpyB,IAAvBjI,EAAQq6B,KAERr6B,EAAQq6B,QAAapyB,GAEzBjI,EAAQ+R,gBAAgBsoB,KAGzBC,IAsEX1tB,OAAO4tB,qBAAuB,WAC1B,IACI16B,GADuB,IAAI26B,UACCvsB,UAChCpO,EAAK46B,QACL56B,EAAK66B,cAEL76B,EAAK86B,QAAU,SAAU55B,EAAMyb,GAC3B,IAAIoe,EAAMne,KAAKC,OAAOF,GAClBqe,EAAoBC,EAAQ/5B,EAAM65B,GACtC,IAAIC,EAIG,CACH,IAAI3L,EAAO,IAAI6L,EAASh6B,EAAM65B,GAO9B,OANA/6B,EAAK46B,KAAK/xB,MACN3H,KAAMA,EACNyb,IAAKoe,EACLI,QAAS9L,EACT+L,WAAW,IAAIloB,MAAOC,YAEnBkc,GAXQrvB,EAAK66B,eAAiB76B,EAAK46B,KAAK56B,EAAK46B,KAAKz1B,OAAS,IACzDg2B,QAAQE,SAASL,EAAkBG,SAC5Cn7B,EAAK66B,cAAgBG,GAa7Bh7B,EAAKoQ,QAAU,SAAUif,EAAMiM,EAAUC,GAIrC,OAFAlM,EAAOA,GAAQmM,KAA6Bx7B,EAAK46B,KAAK,GAAGO,QAC/B,IAAIM,EAASpM,EAAMiM,EAAUC,IAI3D,IAgDQnrB,EA2CApQ,EAvFJw7B,EAA0B,WAC1B,IAAK,IAAIz6B,EAAI,EAAGA,EAAIf,EAAK46B,KAAKz1B,OAAQpE,IAClC,GAAIf,EAAK46B,KAAK75B,GAAGo6B,QAAQO,OAAOv2B,OAAS,EACrC,OAAOnF,EAAK46B,KAAK75B,GAAGo6B,QAG5B,OAAQn7B,EAAK46B,KAAKz1B,OAAS,EAAKnF,EAAK46B,KAAK,GAAGO,YAG7CF,EAAU,SAAU/5B,EAAMyb,GAC1B,IAAK,IAAI5b,EAAI,EAAGA,EAAIf,EAAK46B,KAAKz1B,OAAQpE,IAClC,GAAIf,EAAK46B,KAAK75B,GAAGG,MAAQA,EAAM,CAE3B,IAAIysB,GAAM,IAAIza,MAAOC,UAErB,GAAKnT,EAAK46B,KAAK75B,GAAGq6B,UADD,IAC2BzN,EAExC3tB,EAAK46B,KAAK9gB,OAAO/Y,EAAG,QACjB,GAAIf,EAAK46B,KAAK75B,GAAG4b,KAAOA,EAC3B,OAAO3c,EAAK46B,KAAK75B,GAI7B,OAAO,GAGPm6B,EAAW,SAAWh6B,EAAMyb,GAC5Bzb,EAAOA,GAAQ,GACfyb,EAAMA,MACN,IAAI0S,EAAO,SAAUnuB,EAAMyb,GACvB1c,KAAKiB,KAAOA,EACZjB,KAAK0c,IAAMA,EACX1c,KAAKy7B,WAQT,OANWrM,EAAKjhB,UAEXitB,SAAW,SAAUhM,GACtBpvB,KAAKy7B,OAAO7yB,KAAKwmB,IAGdA,EAdI,GAiBXoM,IA4CIz7B,GA3CAoQ,EAAU,SAAUif,EAAMiM,EAAUC,GACpCt7B,KAAKovB,KAAOA,MACZpvB,KAAKovB,KAAKqM,OAASz7B,KAAKovB,KAAKqM,WAC7Bz7B,KAAKq7B,SAAWA,MAChBr7B,KAAKs7B,KAAOA,MAEZt7B,KAAKs7B,KAAK1yB,KAAK5I,KAAKovB,MAEpB,IAAK,IAAItuB,EAAI,EAAGA,EAAId,KAAKovB,KAAKqM,OAAOv2B,OAAQpE,IACzC,IAAKf,EAAK27B,UAAU17B,KAAKovB,KAAKqM,OAAO36B,GAAId,KAAKq7B,UAAW,CACrD,GAAIt7B,EAAK27B,UAAU17B,KAAKovB,KAAKqM,OAAO36B,GAAId,KAAKs7B,MAAO,CAzDhEv7B,EAAK46B,QA4DW,IAAIgB,GACAC,eAAgB57B,KAAKovB,KAAKnuB,KAC1B46B,kBAAmB77B,KAAKovB,KAAK1S,IAC7Bof,aAAc97B,KAAKovB,KAAKqM,OAAO36B,GAAGG,KAClC86B,gBAAiB/7B,KAAKovB,KAAKqM,OAAO36B,GAAG4b,IACrCwP,KAAMlsB,KAAKs7B,MAGf,OACIK,MAAOx+B,EAAEsJ,QACLu1B,eACIC,OAAQ,QACRC,aAAcvf,KAAKC,QAASlG,QAAS3W,EAAKo8B,iBAAiBR,GAAQ1xB,KAAM,WAE7EmyB,kBACI1lB,QAAS3W,EAAKo8B,iBAAiBR,GAC/B1xB,KAAM,UAEX0xB,IAGP,OAAOxrB,EAAQnQ,KAAKovB,KAAKqM,OAAO36B,GAAId,KAAKq7B,SAAUr7B,KAAKs7B,MAIhEt7B,KAAKq7B,UACLr7B,KAAKq7B,SAASzyB,KAAK5I,KAAKovB,QAIbjhB,WAEdutB,UAAY,SAAUW,EAAUC,GAEjC,IAAK,IAAIx7B,EAAI,EAAGA,EAAIw7B,EAAWp3B,OAAQpE,IACnC,GAAIw7B,EAAWx7B,GAAGG,MAAQo7B,EAASp7B,KAC/B,OAAO,EAGf,OAAO,GAGXlB,EAAKo8B,iBAAmB,SAAUR,GAC9B,IAAIY,EAAc1vB,OAAOC,aAAaC,YAAY,kCAElD,OAAO+B,OAAOytB,EAAaZ,EAAMC,eAAgBD,EAAMG,eASpD3rB,GAGX,OAAOpQ,GASX8M,OAAOY,KAAK+uB,YAAc,SAAUC,EAAUp/B,GAC1C,IAAIq/B,EAAWr/B,EAAQ+D,MAAM,KAE7B,IAAKN,EAAI,EAAGA,EAAI47B,EAASx3B,OAAQpE,IACV,IAAf47B,EAAS57B,IACT+L,OAAOY,KAAKkvB,wBAAwBF,EAAUC,EAAS57B,KAUnE+L,OAAOY,KAAKkvB,wBAA0B,SAAUF,EAAUG,GAEtD,IAAK,IAAI97B,EAAI,EAAGA,EAAI27B,EAASv3B,OAAQpE,IAAK,CACtC,IAAI+7B,EAAQ1/B,EAAEs/B,EAAS37B,IACnBg8B,EAAYF,EAAOx7B,MAAM,KAAK,GAElC,GAAIy7B,EAAMv7B,KAAK,SAAU,CACrB,IAAIy7B,EAAWF,EAAMv7B,KAAK,SAASF,MAAM,KACrC47B,KACAC,EAAmB,GAEvB,IAAK36B,EAAI,EAAGA,EAAIy6B,EAAS73B,OAAQ5C,IAAK,CAClC,IAAI46B,EAAcH,EAASz6B,GAAGlB,MAAM,KAEhCjE,EAAE+f,KAAKggB,EAAY,KAAOJ,GAAuC,IAA1B3/B,EAAE+f,KAAKggB,EAAY,KAC1DF,EAAcp0B,KAAKs0B,EAAY,GAAK,IAAMA,EAAY,GAAK,KAE/DD,EAAmBtgB,KAAK1E,UAAU+kB,GAAer4B,QAAQ,QAAS,KAAKA,QAAQ,OAAQ,KAAKA,QAAQ,OAAQ,KAGhHs4B,EAAuC,MAApBA,EAA2B,GAAKA,EAEnDJ,EAAMv7B,KAAK,QAAS27B,EAAmBL,EAAS,UAC7C,GAAIC,EAAMn4B,IAAIo4B,GAAY,CACzBC,EAAWF,EAAMn4B,IAAIo4B,GAErBG,EAAmB,IADnBD,MAGUp0B,KAAKg0B,EAAS,KAE5BK,EAAuC,MAApBA,EAA2B,GAAKA,EAEnDJ,EAAMv7B,KAAK,QAAS27B,EAAmBL,EAAS,QAQ5D/vB,OAAOY,KAAKkV,UAAY,SAAUwa,GAC9B,GAAIA,GAAUA,EAAO,GACjB,KAA6B,SAAtBA,EAAO,GAAG3sB,SAAkD,UAA5B2sB,EAAOz4B,IAAI,eAAyD,QAA5By4B,EAAOz4B,IAAI,eAA2By4B,EAAOC,SAASl4B,OAAS,GAC1Ii4B,EAASA,EAAOC,SAGxB,OAAOD,GAOXtwB,OAAOY,KAAK4vB,SAAW,SAAUx/B,EAAMkD,EAAKu8B,GACxC,OAAOz/B,EAAK0/B,KAAK,SAAUpuB,EAAGiI,GAC1B,IAAI0D,EAAI3L,EAAEpO,GACNga,EAAI3D,EAAErW,GACV,MAAY,QAARu8B,EACSxiB,EAAIC,GAAM,EAAMD,EAAIC,EAAK,EAAI,EAE9B,SAARuiB,EACSxiB,EAAIC,GAAM,EAAMD,EAAIC,EAAK,EAAI,OAD1C,KASRlO,OAAOY,KAAK+vB,YAAc,SAAU30B,GAChC,IAAI40B,EAAY50B,EAAOiI,WACnB4sB,EAAeD,EAAUv4B,OAU7B,OARIw4B,GAAgB,GAAKA,EAAe,EACpCD,EAAY,IAAMA,EAAUvhB,OAAO,GAAK,IACjCwhB,GAAgB,GAAKA,EAAe,GAC3CD,EAAY,IAAMA,EAAUvhB,OAAO,GAAK,IACjCwhB,GAAgB,KACvBD,EAAY,IAAMA,EAAUvhB,OAAO,GAAK,KAGrC,qBAAuBuhB,GAMlC5wB,OAAOY,KAAK6mB,iBAAmB,SAAUxX,GACrC,MAAyB,iBAAXA,EAAsBA,EAAOnY,QAAQ,0BAA2B,SAAWmY,GAI7FjQ,OAAOY,KAAKkwB,WAAa,SAAUthB,GAC/B,IAAIuhB,EAAMzsB,SAAS2d,cAAc,OAEjC,OADA8O,EAAIlO,YAAYve,SAASme,eAAejT,IACjCuhB,EAAI9N,WAOfjjB,OAAOY,KAAK8mB,mBAAqB,SAAU3wB,GACvC,OAAOiJ,OAAOY,KAAKyjB,YAAYttB,EAAO4tB,+BAM1C3kB,OAAOY,KAAK+mB,kBAAoB,SAAU5wB,GACtC,IAAIusB,EACAC,GACAC,cAAemB,6BAA6BlB,iBAC5CC,iBAAkBiB,6BAA6BhB,eAC/CC,oBAAqBe,6BAA6Bd,eAYtDP,EAAgBhzB,EAAEsJ,QATdmqB,UAAU,EACVP,cAAe,IACfE,iBAAkB,IAClBM,aAAa,EACbC,eAAgB,SAChBC,eAAgB,OAChBN,oBAAqB,IACrBE,OAAQ,IAEmCP,GAC/C,IAAIe,EAActkB,OAAOY,KAAK2jB,cAAcxtB,EAAOusB,GACnD,IAA4C,IAAxCtjB,OAAOwkB,SAASC,oBAA8B,CAC9C,IAAIC,GAAW,GAC6B,GAAxCJ,EAAYrgB,WAAW5G,QAAQ,OAC/BqnB,GAAW,EACXJ,EAAcA,EAAYxsB,QAAQ,IAAK,IAAIA,QAAQ,IAAK,KAE5D,IAAIqX,EAAK,IAAIvN,OAAO,IAAM+iB,6BAA6BlB,iBAAmB,iBAAkB,KAC5Fa,EAAcA,EAAYxsB,QAAQqX,EAAI,MACtCA,EAAK,IAAIvN,OAAO,KAAO+iB,6BAA6BlB,iBAAmB,MAAO,KAC9Ea,EAAcA,EAAYxsB,QAAQqX,EAAI,IAGjCuV,IAAUJ,EAAc,IAAMA,EAAc,KAErD,OAAOA,GAMXtkB,OAAOY,KAAKowB,iBAAmB,SAAUxyB,GACjCA,EAASA,MAAb,IACIyyB,EAAW3gC,EAAE,yDAAyDgV,KAAK9G,EAAO8G,MAAQ,IAC9F2rB,EAAS55B,SAAS/G,EAAE,SACpB2gC,EAASC,OAAO,KAAM,WAClBD,EAASE,SAGbF,EAASG,QAAQ,IAAM,WACnBH,EAASt+B,YAOjBqN,OAAOY,KAAKywB,aAAe,WACvB,YAA+C,IAAjCrxB,OAAO8B,QAAQwvB,gBAAkCtxB,OAAO8B,QAAQwvB,eAGlFtxB,OAAOY,KAAK2wB,QAAU,SAAU1hB,GAC5B,IAAK3b,OAAO2b,EACiB,iBAAbA,EAAI3b,aAA0B2b,EAAI3b,KACrB,mBAAb2b,EAAI3b,OAAuB2b,EAAI3b,KAAO,YAAa2b,EAAI3b,OAI3E8L,OAAOY,KAAK4wB,UAAY,SAAUC,EAAOryB,GAG7B,IAAI9K,EAFZ,GAAMm9B,EACF,GAA+C,mBAA3Cze,OAAO1R,UAAU2C,SAAS1C,MAAMkwB,IAA6E,sBAA9Cze,OAAO1R,UAAU2C,SAAS1C,MAAMnC,IAE/F,IAAK9K,KAASm9B,EACV,GAAIA,EAAM/mB,eAAepW,KAEP,IADN8K,EAASC,KAAKoyB,EAAMn9B,GAAQA,EAAOm9B,EAAMn9B,IAE7C,YAKZhE,EAAE0D,KAAKy9B,EAAOryB,IAM1BY,OAAOY,KAAK8wB,oBAAsB,SAAU11B,EAAQwnB,GAG5CA,EAAgBA,GAAiB,IAFrC,IAIImO,EAAM,GAENC,GAAgB,EAChBC,GAAoB,EACxB71B,GAAUA,EAAO3D,OAAS,EAAI2D,EAAOiI,WAAWL,cAAgB,IAAI9L,QAAQ,KAAM,IAClF,IAAK,IAAI7D,EAAI,EAAGA,EAAI+H,EAAO3D,OAAQpE,KATf,MAUX+H,EAAO/H,IATK,MASmB+H,EAAO/H,IAAiC,IAANA,GAP1D,KAOqE+H,EAAO/H,EAAI,KAEhF2b,MAAM5S,OAAOhB,EAAO/H,KAEpB+H,EAAO/H,KAAOuvB,GAAmBoO,EAXjC,MAcA51B,EAAO/H,IAAsB49B,IACrCF,GAAO31B,EAAO/H,GACd49B,GAAoB,IAJpBF,GAAO31B,EAAO/H,GACd29B,GAAgB,GALhBD,GAAO31B,EAAO/H,GAWtB,OAAO09B,GAGX3xB,OAAOY,KAAKkxB,yBAA2B,SAAU91B,EAAQwnB,EAAeuO,EAASC,EAAaC,GAC1FzO,EAAgBA,GAAiB,IACjCxnB,EAASgE,OAAOY,KAAK8wB,oBAAoB11B,EAAQwnB,GACjDuO,EAAWA,EAAU,EAAKA,EAAU,GACpCC,EAAeA,EAAc,EAAKA,GAAe,IACjDC,EAAeA,EAAc,EAAKA,EAAc,IAChD,IACIC,EAAU,IAAItwB,OAAO,UAAY4hB,EAAgB,2BACjD2O,EAAWn2B,EAAOiV,MAAMihB,GAGxBE,EAAM,EAENC,EAAuB,MAAdr2B,EAAO,GAAaA,EAAO,GAAK,GACzCs2B,EAAqB,EAKzB,GAHAt2B,EAASA,EAAOlE,QAAQu6B,EAAQ,IAG5BF,GAAYA,EAAS,IAAMA,EAAS,GAAI,CACxC,IAAII,EAAYJ,EAAS,GAAMA,EAAS,GAAGr6B,QAAQq6B,EAAS,GAAI,IAAI59B,MAAMivB,GAAkB,GAExFgP,EAAoB,GACpBC,EAAU,GA6Bd,OAzBAF,EAAU,GAAKA,EAAU,GAAGz6B,QAAQ,OAAQ,IAExCy6B,EAAU,GAAGl6B,OAAS,GAEtBi6B,GADAE,EAAoBD,EAAU,GAAGlwB,MAAM,IACAhK,OACvCo6B,EAAUF,EAAU,GAAG,IAAM,GAC7BC,EAAoBA,EAAkBnnB,OAAO8mB,EAAS,IAAM,KAC7B,IAAxBI,EAAU,GAAGl6B,QACpBo6B,EAAUF,EAAU,GAAG,IAAM,GAC7BC,EAAoBA,EAAkBnnB,OAAOknB,EAAU,IAAM,MAE7DD,EAAqBC,EAAU,GAAGl6B,OAClCk6B,EAAU,GAAKA,EAAU,GAAGz6B,QAAQ,OAAQ,IAC5Cw6B,EAAsBC,EAAU,GAAGl6B,OAAS,EAAKi6B,EACjDG,EAAUF,EAAU,GAAG,GACvBC,EAAoBD,EAAU,GAAGlwB,MAAM,KAG3CmwB,EAAoBA,EAAkB16B,QAAQ0rB,EAAe,IAAI1rB,QAAQ,OAAQ,KAE3DO,QAAU05B,IAC5BS,EAAoBA,EAAkBnwB,MAAM,EAAG0vB,EAAU,IAItDM,EAASI,GAAWD,EAAqBhP,EAAgBgP,EAAqB,IA9CzE,MA6CZJ,GADAA,EAAMp1B,OAAOm1B,EAAS,GAAGr6B,QA5Cb,IA4CgC,KAAOw6B,GACtCL,EAAeA,EAAeG,EAAMJ,EAAeA,EAAcI,GACgC,EAAI,IAAMA,EAAMA,GAC3H,GAAIp2B,EAAQ,CAEfs2B,EAAqBt2B,EAAOqB,QAAQmmB,GACpC,IAAIkP,EAAO,EACPC,EAAK32B,EAAO3D,OAAS,EAGzB2D,EAASA,EAAOlE,QAAQ0rB,EAAe,IAIvC,IADA,IAAIvvB,EAAIy+B,GACAE,GACc,MAAd52B,EAAO/H,IAAc+H,EAAO/H,KAAOuvB,GACnCoP,GAAkB,EAClBF,EAAOz+B,GACFA,IAKb,IAFA,IAAI2+B,GAAkB,EAClBn9B,EAAIk9B,GACAC,GACc,MAAd52B,EAAOvG,IAAcuG,EAAOvG,KAAO+tB,GACnCoP,GAAkB,EAClBD,EAAKl9B,EAAI,GACJA,IAGb,GADAk9B,EAAKA,EAAKZ,EAAUW,EAAOX,EAAUW,EAAOC,GAChB,IAAxBL,EAA2B,CAEvBM,GAAkB,EAItB,OADAR,EAAME,GADWI,EAAO,IADpBF,EAAoBx2B,EAAOqG,MAAMqwB,EAAMC,IAGrBt6B,OAAS,IAAMuX,MAAM5S,OAAOw1B,EAAkB,KACzDH,EAASG,EAAkB,IAAMA,EAAkBn6B,OAAS,EAAImrB,EAAgBgP,EAAkBnwB,MAAM,GAAK,IAjFhH,KAiFmI+vB,EAAM,EAAI,IAAMA,EAAMA,GACjJ,IAIhB,IAAIS,EAAa72B,EAAOqG,MAAMqwB,EAAMA,EAAO,GACvCI,EAAa92B,EAAOqG,MAAMqwB,EAAO,EAAG12B,EAAO3D,QAM/C,OALA+5B,EAAMU,EAAWz6B,QACjBy6B,EAAaA,EAAWh7B,QAAQ,OAAQ,KACzBO,OAAS05B,IACpBe,EAAa92B,EAAOqG,MAAMqwB,EAAO,EAAGX,EAAUW,IAE9C11B,OAAO61B,GACAR,EAASQ,GAAcC,EAAWz6B,OAAS,EAAImrB,EAAgBsP,EAAa,IA9F/E,KA8FkGV,EAAM,EAAI,IAAMA,EAAMA,GAChH,IAEf,MAAO,IAMpBpyB,OAAOY,KAAKmyB,aAAe,SAAUvjB,GACjC,OAAOA,EAAI1X,QAAQ,OAAQ,KAAMA,QAAQ,MAAO,KAAKA,QAAQ,QAAS,MAAMA,QAAQ,OAAQ,OAMhGkI,OAAOY,KAAKoyB,gBAAkB,SAAU1tB,GAEpC,OADS,IAAI1D,OAAO,eACVyD,KAAKC,IAGnBtF,OAAOY,KAAKqyB,UAAY,WACpB,IAAIpjB,EAAMC,KAAKhE,MAAMonB,eAAelG,QAAQ,yBAC5CkG,eAAehG,WAAW,wBAC1B58B,EAAEsJ,OAAOiW,GAAOsjB,eAAgB,UAChCD,eAAepG,QAAQ,uBAAwBhd,KAAKC,OAAOF,KAG/D7P,OAAOY,KAAKwyB,WAAa,SAAU50B,GAC/B,IAAIqR,EAAMC,KAAKhE,MAAMonB,eAAelG,QAAQ,yBAC5CkG,eAAehG,WAAW,wBAC1B58B,EAAEsJ,OAAOiW,EAAKrR,GACd00B,eAAepG,QAAQ,uBAAwBhd,KAAKC,OAAOF,KAO/D7P,OAAOY,KAAKyyB,eAAiB,SAAUlc,GAGnC,OAFAA,EAASA,GAAUnX,OAAOgH,gBAGtB,iBACA,wBACA,qBACA,4BACA,SACA,aACA,oBACA,iBACA,yBACF3J,QAAQ8Z,IAAW,GAOzBnX,OAAOY,KAAK0yB,eAAiB,SAAUnc,GAGnC,OAFAA,EAASA,GAAUnX,OAAOY,KAAKoG,gBAG3B,SACA,aACA,oBACA,iBACA,yBACF3J,QAAQ8Z,IAAW,GAOzBnX,OAAOY,KAAK2yB,sBAAwB,SAAUpc,GAG1C,OAFAA,EAASA,GAAUnX,OAAOY,KAAKoG,eAExBhH,OAAOY,KAAK0yB,mBAAoD,IAA/Bnc,EAAO9Z,QAAQ,YAO3D2C,OAAOY,KAAK4yB,kBAAoB,SAAUrc,GAGtC,OAFAA,EAASA,GAAUnX,OAAOY,KAAKoG,eAExBhH,OAAOY,KAAK0yB,qBAAqD,IAA/Bnc,EAAO9Z,QAAQ,aAQ5D2C,OAAOY,KAAK6yB,mBAAqB,SAAUtc,GAGvC,OAFAA,EAASA,GAAUnX,OAAOY,KAAKoG,gBAG3B,iBACA,wBACA,qBACA,6BACF3J,QAAQ8Z,IAAW,GAOzBnX,OAAOY,KAAK8yB,0BAA4B,SAAUvc,GAG9C,OAFAA,EAASA,GAAUnX,OAAOY,KAAKoG,eAExBhH,OAAOY,KAAK6yB,uBAAwD,IAA/Btc,EAAO9Z,QAAQ,YAO/D2C,OAAOY,KAAK+yB,sBAAwB,SAAUxc,GAG1C,OAFAA,EAASA,GAAUnX,OAAOY,KAAKoG,eAExBhH,OAAOY,KAAK6yB,uBAAoD,IAA3Btc,EAAO9Z,QAAQ,QAQ/D2C,OAAOY,KAAK0wB,cAAgB,SAAU9yB,GAClC,IAAKwB,OAAOY,KAAKyyB,uBAAwC,IAAb,EACxC,OAAO,EAEX,IAAIvxB,EAAUtD,EAAOsD,SAAW,KAC5BkT,EAAYxW,EAAOwW,WAAa,KAEhC4e,EAA8B,OAAd5e,EAChBA,EAAyB,OAAZlT,EAAmBA,EAAQ+xB,mBAAqB,KAEjE,GAAsB,OAAlBD,EACA,OAAO,EAEX,IAAIE,EAAaF,EAAcG,gBAI/B,YAH0D,IAA9BD,EAAwB,eAChD9zB,OAAOY,KAAKuF,aAAa2tB,EAAWxC,gBAK5CtxB,OAAOY,KAAKozB,qBAAuB,WAC/B,IAAIC,EAAeljB,UAAUC,UAAUpN,cAAcvG,QAAQ,WACzD62B,EAAiBnjB,UAAUC,UAAUpN,cAAc+N,UAAUsiB,EAAe,EAAGA,EAAe,IAElG,OADAC,EAAiBA,EAAeplB,WAAW,IAAK,IACzC9R,OAAOk3B,IAGlBl0B,OAAOY,KAAKuzB,WAAa,SAAUtd,GAC/B,IAAIud,EAAY,GACZC,EAAgBhrB,SAASirB,SAAS//B,MAAM,KACxCggC,EAAWlrB,SAASmrB,SAAW,KAAOnrB,SAASorB,KAEnD,GAA8B,KAA1BpZ,oBAAoB,GACpB+Y,EAAYG,EAAWlZ,oBAAsBxE,MAC1C,CAEH,IADA,IAAI6d,EAAsBrZ,oBAAoB9mB,MAAM,OAAO8D,OAClDpE,EAAI,EAAGiW,EAAImqB,EAAch8B,OAAQpE,EAAIiW,EAAIwqB,EAAqBzgC,IACnEsgC,GAAYF,EAAcpgC,GAAK,IAInCmgC,GADAG,EAA6C,MAAlCA,EAASA,EAASl8B,OAAS,GAAak8B,EAAWA,EAAW,KAClD1d,EAE3B,OAAOud,GAOXp0B,OAAOY,KAAK+zB,kBAAoB,WAC5B,IACI1jB,EADYF,UAAUC,UAAUpN,cACdqN,MAAM,uBAE5B,QAAOA,GAAQsC,WAAWtC,EAAM,KAQpCjR,OAAOY,KAAKg0B,gBAAkB,SAAUC,GACpC,IAAIC,EAAYD,EACZnjB,EAAU1R,OAAOY,KAAK+zB,oBAE1B,IAAKjjB,EACD,OAAOojB,EAEX,GAAmC,0BAA/BA,EAAUnjB,UAAU,EAAG,KAAmCD,GAAW,IAAK,CAC1E,IAAIqjB,EAAaD,EAAUvgC,MAAM,OAE7BugC,EADAC,EAAW18B,OAAS,EACR,yCAA2C08B,EAAW,GAGtD,0CADZA,EAAaD,EAAUvgC,MAAM,MACqCwgC,EAAW18B,OAAS,GAI9F,OAAOy8B,GAQX90B,OAAOY,KAAK+oB,gBAAkB,SAAUqL,GACpC,QAAKh1B,OAAOC,cACJD,OAAOC,aAAaC,YAAY80B,KAAcA,GAS1Dh1B,OAAOY,KAAKq0B,UAAY,SAAUC,EAASC,EAAaC,GACpDD,EAAcA,GAAe,GAC7BC,EAAYA,GAAa,IAKzB,IAHA,IAAIC,EAAiBC,KAAKJ,GACtBK,KAEK59B,EAAS,EAAGA,EAAS09B,EAAeh9B,OAAQV,GAAUy9B,EAAW,CAItE,IAHA,IAAI/yB,EAAQgzB,EAAehzB,MAAM1K,EAAQA,EAASy9B,GAE9CI,EAAc,IAAIn3B,MAAMgE,EAAMhK,QACzBpE,EAAI,EAAGA,EAAIoO,EAAMhK,OAAQpE,IAC9BuhC,EAAYvhC,GAAKoO,EAAMI,WAAWxO,GAGtC,IAAIwhC,EAAY,IAAIC,WAAWF,GAE/BD,EAAWx5B,KAAK05B,GAIpB,OADW,IAAIE,KAAKJ,GAAcn4B,KAAM+3B,KAQ5Cn1B,OAAOY,KAAKg1B,kBAAoB,SAAUpmB,GAEtC,IADA,IAAIimB,EAAY,IAAIC,WAAWlmB,EAAInX,QAC1BpE,EAAI,EAAGA,EAAIub,EAAInX,OAAQpE,IAC5BwhC,EAAUxhC,GAAyB,IAApBub,EAAI/M,WAAWxO,GAElC,OAAOwhC,GAWXz1B,OAAOY,KAAKi1B,uBAAyB,WACjC,MAAgD,oBAAlC,8BAA2G,IAA1D71B,OAAOY,KAAKuF,aAAa2vB,8BAQ5F91B,OAAOY,KAAKm1B,oBAAsB,WAC9B,MAAuC,oBAAzB,qBAAyF,IAAjD/1B,OAAOY,KAAKuF,aAAa6vB,qBAOnFh2B,OAAOY,KAAKq1B,oBAAsB,WAC9B,MAA8C,oBAAhC,4BAAuG,IAAxDj2B,OAAOY,KAAKuF,aAAa+vB,4BAO1Fl2B,OAAOY,KAAKu1B,sBAAwB,WAChC,MAAyC,oBAA3B,uBAA6F,IAAnDn2B,OAAOY,KAAKuF,aAAaiwB,uBAOrFp2B,OAAOY,KAAKy1B,qBAAuB,WAC/B,MAA+C,oBAAjC,6BAAyG,IAAzDr2B,OAAOY,KAAKuF,aAAamwB,6BAO3Ft2B,OAAOY,KAAK21B,gBAAkB,WAC1B,MAAqC,oBAAvB,kBAA2D,UAArBC,kBAOxDx2B,OAAOY,KAAK61B,mBAAqB,WAC7B,MAA4C,oBAA9B,wBAA4CC,wBAA0B,IAOxF12B,OAAOY,KAAK+1B,mBAAqB,WAC7B,IAAIC,GAAY,EAEhB,GAAuC,oBAA5B,wBAA4C52B,OAAOY,KAAKqT,QAAQ4iB,uBAAwB,CAC/F,IAAInlB,EAAUmlB,sBAAsB5lB,MAAM,YAC1C2lB,GAAYllB,GAAW6B,WAAW7B,EAAQlP,UAAY,GAG1D,OAAOo0B,GAOX52B,OAAOY,KAAKk2B,mBAAqB,WAC7B,MAA4B,oBAAd,SAOlB92B,OAAOY,KAAK+R,wBAA0B,WAClC,MAA8B,oBAAhB,WAOlB3S,OAAOY,KAAKm2B,wBAA0B,WAClC,MAA8B,oBAAhB,WAA+B/2B,OAAOY,KAAK0yB,kBAO7DtzB,OAAOY,KAAKo2B,4BAA8B,WACtC,MAA8B,oBAAhB,WAA+Bh3B,OAAOY,KAAK6yB,sBAMzDzzB,OAAOY,KAAK+R,2BAA6BnB,OAAOylB,SAAWzlB,OAAOylB,QAAQC,QAAQC,UAClFF,QAAQC,QAAQC,SAASC,0BAAyB,GAOtDp3B,OAAOY,KAAKy2B,iBAAmB,WAC3B,IAAIC,EAAkD,oBAA5B,uBAA4Ct3B,OAAOY,KAAKqT,QAAQsjB,uBAC9D,KAAxBA,sBAEJA,sBAAwB,GACxB,IAAIpgB,EAASnX,OAAOgH,eAGpB,OAFAuwB,sBAAwBD,EAEjBngB,GAOXnX,OAAOY,KAAK42B,UAAY,WACpB,OAAQzmB,UAAUC,UAAUpN,cAAcvG,QAAQ,YAAc,GAGpE2C,OAAOY,KAAK62B,gBAAkB,WAE1B,OADaz3B,OAAOY,KAAKoG,eACX3J,QAAQ,YAAc,GAGxC2C,OAAOY,KAAKkS,YAAc,WAEtB,OAAsC,IADzB9S,OAAOY,KAAKoG,eACX3J,QAAQ,YAQ1B2C,OAAOY,KAAK82B,eAAiB,WACzB,MAAuC,oBAA5B,uBAA4C13B,OAAOY,KAAKqT,QAAQ0jB,uBAGpE33B,OAAO+W,OAAO6gB,SAAW,GAFrBD,uBAUf33B,OAAOY,KAAKi3B,UAAY,SAAU7mC,GAG9B,IACI,QAAUA,EAAKiT,WAAYgN,MAHnB,6GAIV,MAAO6d,IAET,OAAO,GAQX9uB,OAAOY,KAAKk3B,WAAa,SAAUjyB,GAC/B,IAAIkyB,EAEJ,IACI,QAAkC,IAAtBlyB,EAAgB,OAAsB7F,OAAOY,KAAKqT,QAAQpO,EAAW9O,OAW7EghC,EAAalyB,EAAWgR,KAAO,OAXsD,CACrF,IAAI7lB,EAAO6U,EAAW9O,MAClB8f,EAAM7lB,EAAK+F,OAAS/F,EAExB,GAAIqN,MAAM6U,QAAQ2D,GAAM,CACpB,IAAImhB,EAAUnhB,EAAIrU,QAClBu1B,EAAa15B,MAAM6U,QAAQ8kB,GAAWA,EAAQnsB,KAAK,IAAMmsB,OAEzDD,EAAalhB,GAMrBkhB,EAAc/3B,OAAOY,KAAKqT,QAAQ8jB,GAAsF,GAAxE,yBAA2BA,EAAWjgC,QAAQ,mBAAoB,OAErD,IAA3CigC,EAAW16B,QAAQ,qBACjC06B,EAAa,IAEnB,MAAOjJ,GACLiJ,EAAa,GAGjB,OAAOA,GAQX/3B,OAAOY,KAAKq3B,mBAAqB,SAAUjnC,GACvC,IAAI6Y,EAAU7Y,MAEd,IAEI6Y,GADAA,EAA8B,iBAAb,EAAwBiG,KAAKhE,MAAMjC,GAAWA,GAC7CwlB,cAAiBxlB,EAAQA,SAAWA,EACxD,MAAOzI,GACLyI,EAAU7Y,EAGd,OAAO6Y,GAMX,IAAIquB,iBAAmB,+CC51HvB,SAASt1B,cACL,IAAI1P,EAAOC,KACP0P,KAEJ3P,EAAKT,IAAM,SAAU2M,GACjByD,EAAM9G,MAAO+G,WAAY1D,MAG7BlM,EAAK6P,YAAc,SAAU3D,GACzB,GAAoB,GAAhByD,EAAMxK,OACN,OAAOnF,EAAKT,IAAI2M,GAGTyD,EAAMA,EAAMxK,OAAS,GAC3ByK,UAAU/G,KAAKqD,IAGxBlM,EAAK8P,QAAU,WAIX,IAHA,IAAIC,EAAU,IAAI3S,EAAE4S,SAChBxH,EAAUuH,EAAQvH,UAClByH,EAAcN,EAAMxK,OACfpE,EAAI,EAAGA,EAAIkP,EAAalP,IAC7ByH,EAAUA,EAAQ0H,KAAK,WACnB,IAAIhQ,EAAUyP,EAAML,QACpB,OAAOlS,EAAEqM,KAAK4E,MAAMjR,EAAGA,EAAE2N,IAAI7K,EAAQ0P,UAAW,SAAU1D,GAEtD,MAAyB,mBAAd,EACAA,IAEJA,OAWnB,OANA6D,EAAQK,UACR5H,EAAUA,EAAQJ,KAAK,WAEnBuH,QDwzHZ7C,OAAOY,KAAKu3B,sBAAwB,WAChC,IAAIC,EAAc9nC,EAAE,QAAQmG,KAAK,sBAAsBwf,SACvD3lB,EAAE4nC,kBAAkBG,UAAU,QAC9B/nC,EAAE,QAAQmG,KAAK,6BAA6BoB,KAAMygC,SAAY,WAAYnoB,MAAS,OAAQ8F,OAAUmiB,EAAc,KAAMG,WAAc,OAAQC,QAAW,MAAOC,UAAW,SAGhLz4B,OAAOY,KAAK83B,qBAAuB,WAC/BpoC,EAAE,QAAQmG,KAAK,6BAA6B2Z,UAIhDpQ,OAAOY,KAAK+3B,aAAe,SAAS9hB,EAAK+hB,GACrC,IACI70B,EADKyN,OAAOT,UAAUC,UACZ3T,QAAQ,SAClBw7B,EAAgB,GACpB,GAAGD,EACCC,EAAgBhiB,MACf,CACD,IAAIiiB,EAAWjiB,EAAItiB,MAAM,KACzBskC,EAAiBrnB,OAAOnI,SAASC,KAAK/U,MAAM,KAAK,GAAMukC,EAASz2B,MAAMy2B,EAASz7B,QAAQ,OAAQy7B,EAASzgC,QAAQwT,KAAK,KAGrH7L,OAAOY,KAAKwQ,UAAYrN,EAAO,GAAOgN,UAAUC,UAAUC,MAAM,qBAC5B,IAAjC3gB,EAAE,oBAAoB+H,OACrB/H,EAAE,aAAamE,MACXqiB,IAAK+hB,EACLtzB,MAAO,iCACP9U,GAAI,oBACL4G,SAAS,QAEZ/G,EAAE,oBAAoBmE,KAAK,MAAO,GAGtC+c,OAAOoJ,KAAKie,IAIpB74B,OAAOY,KAAKm4B,mCAAqC,SAAUC,EAAQC,GAC/Dj5B,OAAOuJ,WAAW2vB,YAAYC,KAAK73B,UAAU83B,QAAQ,iBACjD76B,OAAQyB,OAAOuJ,WAAW/W,QAAQ+L,OAAO86B,iCACzCL,OAAQA,EACRC,WAAYA,KAUpBj5B,OAAOY,KAAK04B,2BAA6B,SAAU/9B,GAC/C,OAAIA,EACOyE,OAAOC,aAAaC,YAAY,+CAAgD,qFAEhFF,OAAOC,aAAaC,YAAY,oCAAqC,oGAIpFF,OAAOY,KAAK24B,aAAe,SAAU/pB,GACpC,IAAIN,EAAO5K,SAAS2d,cAAc,OAElC,OADA/S,EAAKsqB,YAAchqB,EACZN,EAAK+T,WAGbjjB,OAAOY,KAAK64B,YAAc,SAAUhI,GAGhC,IAFA,IAAI1xB,EAAQ0xB,EAAMpmB,SAETpX,EAAI,EAAGoE,EAAS0H,EAAM1H,OAAQpE,EAAIoE,IAAUpE,EACjD,IAAK,IAAIwB,EAAIxB,EAAI,EAAGwB,EAAI4C,IAAU5C,EAC1BsK,EAAM9L,KAAO8L,EAAMtK,IACnBsK,EAAMiN,OAAOvX,GAAK,EAAG,GAMjC,OAAOsK,GAcXC,OAAOY,KAAK84B,SAAW,SAAUC,EAAMC,EAAMC,GACzC,IAAI3Z,EACJ,OAAO,WACH,IAAIpe,EAAU3O,KAAMiP,EAAOZ,UAKvBs4B,EAAUD,IAAc3Z,EAC5B/qB,aAAa+qB,GACbA,EAAUjrB,WANE,WACRirB,EAAU,KACL2Z,GAAWF,EAAKp4B,MAAMO,EAASM,IAIZw3B,GACxBE,GAASH,EAAKp4B,MAAMO,EAASM,KAQzCpC,OAAOY,KAAKm5B,6BAA+B,WACvC,OAAO/5B,OAAOY,KAAK+R,2BAA6B3S,OAAOY,KAAKkS,eAAiB9S,OAAOwkB,SAASwV,mBAKjGh6B,OAAOY,KAAKq5B,aAAgB,SAAUpwB,GAClC,MAAO,mIAGPA,EACA,cAOJ7J,OAAOY,KAAKs5B,sBAAyB,SAAUrjB,GAE3C,GAD2B,0HACHxR,KAAKwR,GAAK,CAK9B,MAJ4B,uBACFxR,KAAKwR,KAC3BA,EAAM,UAAYA,GAEfA,EAEX,OAAO,MAQX7W,OAAOY,KAAKu5B,oBAAsB,SAAUnpC,GACxC,IAAI+F,EAAQ/F,GAAQ,GAChBopC,EAAiB,GAEE,iBAAZ,IAQPA,GADAA,GADAA,GADAA,GADAA,GADAA,EAF0Bp6B,OAAOY,KAAK2T,UAAUxd,GAEX+X,WAAW,IAAK,UACrBA,WAAW,IAAK,UAChBA,WAAW,IAAK,QAAQA,WAAW,IAAK,SACxCA,WAAW,IAAM,SAASA,WAAW,IAAK,SAASA,WAAW,IAAK,UACnEA,WAAW,MAAO,UAClBA,WAAW,KAAM,UAGrD,OAAOsrB,GASXp6B,OAAOY,KAAKy5B,iBAAmB,SAAU5iB,EAAK6iB,GAI1C,GAAIA,EAAKC,kBACLD,EAAKE,QACLF,EAAKC,kBAAkB9iB,EAAKA,QAGzB,GAAI6iB,EAAKG,gBAAiB,CAC7B,IAAIC,EAAQJ,EAAKG,kBACjBC,EAAM5pC,UAAS,GACf4pC,EAAMC,QAAQ,YAAaljB,GAC3BijB,EAAME,UAAU,YAAanjB,GAC7BijB,EAAMG,WAWd76B,OAAOY,KAAKk6B,iBAAmB,SAAUC,GAGrC,IAAIC,EAAY,EAGhB,GAAI12B,SAAS22B,UAAW,CAGpBF,EAAOP,QAGP,IAAIU,EAAO52B,SAAS22B,UAAUE,cAG9BD,EAAKN,UAAU,aAAcG,EAAOhkC,MAAMsB,QAG1C2iC,EAAYE,EAAK51B,KAAKjN,YACf0iC,EAAOK,gBAA2C,KAAzBL,EAAOK,kBACvCJ,EAAYD,EAAOK,gBAGvB,OAAOJ,GAQXh7B,OAAOY,KAAKy6B,YAAc,SAAUtkC,GAGhC,OAFAA,EAAQA,GAAS,IAEJe,QAAQ,qCAAsC,SAM/DkI,OAAOY,KAAK06B,iBAAmB,SAAUjc,GACrC,IAAIkc,EAAMlc,EAAK9qB,MAAM,KAerB,OAdApB,KAAKqoC,mBAAqBroC,KAAKqoC,uBAc3Bnc,KAAQlsB,KAAKqoC,mBACNroC,KAAKqoC,mBAAmBnc,GAExBlsB,KAAKqoC,mBAAmBnc,GAfnC,SAA6Bkc,GACzB,IAAIE,EAAWz7B,OAAOY,KAAK86B,oBAE3B,GAAoB,iBAATrc,QAAwC,IAAZoc,EAAvC,CAGA,IADA,IAAIE,EAAQF,EACHxnC,EAAI,EAAGukB,EAAM+iB,EAAIljC,OAAQpE,EAAIukB,EAAKvkB,IAEvC,QAAqB,KADrB0nC,EAAQA,EAAMJ,EAAItnC,KACgB,OAEtC,OAAO0nC,GAKgCC,CAAoBL,IAOnEv7B,OAAOY,KAAK86B,kBAAoB,WAC5B,IAAIG,EAAsBrqB,OAAO6b,cAAgBA,iBAMjD,OAJGrtB,OAAOY,KAAKyyB,kBAAuD,oBAA7B,yBAA6CrzB,OAAOY,KAAKqT,QAAQ6nB,0BACtGD,EAAoBJ,SAAW3rB,KAAKhE,MAAMgwB,wBAA0B,OAGjED,EAAoBJ,UAM/Bz7B,OAAOY,KAAKm7B,oBAAsB,WAC9B/7B,OAAOY,KAAK46B,wBAAqBngC,GAQrC2E,OAAOY,KAAKo7B,eAAiB,SAAU9gC,GACnC,OAAOA,IAAYA,EAAOkC,MAAwB,UAAhBlC,EAAOkC,MAAsBlC,EAAOk0B,QAA4B,UAAlBl0B,EAAOk0B,QAAwBl0B,EAAO+gC,MAAwB,kBAAhB/gC,EAAO+gC,OAazIj8B,OAAOY,KAAKs7B,WAAa,SAAUnlC,GAC/B,GAAIA,MAAAA,EAAuC,CACvC,GAAIzG,EAAE4iB,QAAQnc,GAAQ,CAElB,IAAK,IAAI9C,EAAI,EAAGoE,EAAStB,EAAMsB,OAAQpE,EAAIoE,EAAQpE,IAC/B,MAAZ8C,EAAM9C,IAAmC,kBAAb8C,EAAM9C,MACS,IAAvC+L,OAAOY,KAAKuF,aAAapP,EAAM9C,IAC/B8C,EAAM9C,GAAK+L,OAAOC,aAAaC,YAAY,uBAEG,IAAvCF,OAAOY,KAAKuF,aAAapP,EAAM9C,MACtC8C,EAAM9C,GAAK+L,OAAOC,aAAaC,YAAY,uBAGnDnJ,EAAM9C,GAAK+L,OAAOY,KAAK24B,aAAaxiC,EAAM9C,IAG9C,OAAO8C,EAAM8U,KAAK,OAElB,OAAO7L,OAAOY,KAAK24B,aAAaxiC,GAGpC,MAAO,IAUfiJ,OAAOY,KAAKu7B,iBAAmB,SAASC,EAAMC,GAC1C,IAAIC,EAEJ,cAAeF,EAAKrlC,OAChB,IAAK,SACDulC,EAAaF,EAAKrlC,MAClB,MACJ,IAAK,SACDulC,EAAat8B,OAAOY,KAAKs7B,WAAWE,EAAKrlC,OACzC,MACJ,IAAK,SACD,IAAI/F,EAAOgP,OAAOY,KAAKy6B,YAAYgB,GAAMvtB,WAAW,IAAK,IACrDytB,EAAQ,IAAI36B,OAAO,0BAA4B5Q,EAAO,0BAA2B,MAErFsrC,EAAat8B,OAAOY,KAAK24B,aAAa6C,EAAKrlC,OAAOe,QAAQykC,EAAO,uBACjE,MACJ,QACID,EAAaF,EAAKrlC,MAI1B,OAAOulC,GAOXt8B,OAAOY,KAAK47B,qBAAuB,WAC/B,IAAIC,EAAa,GACbC,EAAmB,EACnBC,EAAcnrB,OAAOorB,OAAOzsB,MAC5B0sB,EAAerrB,OAAOorB,OAAO3mB,OAcjC,MAZI,eAAgB2mB,OAChBF,EAAmBE,OAAOE,WAAaF,OAAOG,YACvC,qBAAsBvrB,SAC7BkrB,EAAmBlrB,OAAOkrB,kBAG9BA,EAAmB1/B,OAAO0/B,EAAiB7W,QAAQ,IAE9C8W,GAAeA,EAAc,GAAOE,GAAgBA,EAAe,IACpEJ,EAAcE,EAAcD,EAAoB,IAAOG,EAAeH,GAGnED,GAOXz8B,OAAOY,KAAKo8B,cAAgB,WASxB,OANIh9B,OAAOY,KAAKyyB,iBACwC,oBAAhC,2BAAgDrzB,OAAOY,KAAKqT,QAAQgpB,2BAAyD,GAA5BA,0BAExGj9B,OAAOY,KAAK47B,wBAWjCx8B,OAAOY,KAAKs8B,cAAgB,SAAS9/B,GACjC,YAAsB,IAAX,EAA+BA,EAEnCA,EACFtF,QAAQ,aAAc,IACtBA,QAAQ,SAAU,IAClBA,QAAQ,UAAW,KAO5BkI,OAAOY,KAAKu8B,yBAA2B,SAAS1f,EAAQjlB,GACpD,IAAImO,EAAW,4BACXnO,EACAlI,EAAEqW,EAAU8W,GAAQjlB,OAEpBlI,EAAEqW,EAAU8W,GAAQnlB,QAQ5B0H,OAAOY,KAAKw8B,gBAAkB,SAASC,GACnC,OAAkC,IAA3Br9B,OAAOy7B,SAAS4B,IAM3B,SAAW/sC,GAEP,IAAIgtC,EAAU,SAAU/a,EAAMgb,GAC1B,OAAwB,OAApBhb,EAAKib,WAA4BD,EAE9BD,EAAQ/a,EAAKib,WAAYD,EAAGlyB,QAAQkX,MAG3Chd,EAAQ,SAAUgd,EAAMkb,GACxB,OAAOC,iBAAiBnb,EAAM,MAAM9d,iBAAiBg5B,IAOrDE,EAAS,SAAUpb,GACnB,MAAO,gBAAgBld,KAJhBE,EADcgd,EAKgBA,EAJlB,YAAchd,EAAMgd,EAAM,cAAgBhd,EAAMgd,EAAM,eAD9D,IAAUA,GASzBjyB,EAAEstC,eAAiB,SAAUrb,GACzB,GAAMA,aAAgBsb,aAAetb,aAAgBub,WAArD,CAIA,IAFA,IAAIP,EAAKD,EAAQ/a,EAAKib,eAEbvpC,EAAI,EAAGA,EAAIspC,EAAGllC,OAAQpE,GAAK,EAChC,GAAI0pC,EAAOJ,EAAGtpC,IAAK,OAAOspC,EAAGtpC,GAGjC,OAAOqQ,SAASy5B,kBAAoBz5B,SAAS0d,kBA9BrD,CAgCGviB,QAEHO,OAAOY,KAAKo9B,WAAa,SAAUx/B,QACgB,IAAnCwB,OAA6B,wBACrCA,OAAOi+B,uBAAyB,IAAI7V,MAAM8V,OAAOC,YAAY7tC,EAAE,SAC3D8tC,KAAM,OACNC,gBAAgB,EAChB1zB,KAAM,SAAUvJ,GACZgnB,MAAM1oB,GAAG4+B,SAAShuC,EAAE,aAAa,GACjCkO,EAAO+/B,SAAW//B,EAAO+/B,aAIjCv+B,OAAOi+B,uBAAuBO,eAAiB,SAAUp9B,EAAG+J,GACxDhY,KAAKsrC,SAASr9B,EAAG+J,KAGrB3M,EAAO+/B,SAAW//B,EAAO+/B,WASjCv+B,OAAOY,KAAK89B,oBAAsB,WAC9B,MAA8C,oBAAhC,4BAAuG,IAAxD1+B,OAAOY,KAAKuF,aAAaw4B,4BAQ1F3+B,OAAOY,KAAKg+B,aAAe,SAAU7nC,GACjC,GAAc,IAAVA,EAAa,OAAO,EACxB,GAAIA,MAAAA,GAAmD,KAAVA,EAAc,OAAO,EAClE,GAAuB,gBAAZ,EAAqB,OAAwB,IAAjBA,EAAMsB,OAC7C,GAA+C,mBAA3C2a,OAAO1R,UAAU2C,SAAS1C,MAAMxK,GAA6B,OAAwB,IAAjBA,EAAMsB,OAE9E,GAA+C,oBAA3C2a,OAAO1R,UAAU2C,SAAS1C,MAAMxK,GAA8B,CAC9D,IAAK,IAAI7C,KAAO6C,EACZ,GAAIA,EAAM2T,eAAexW,KAAS8L,OAAOY,KAAKg+B,aAAa7nC,EAAM7C,IAC7D,OAAO,EAIf,OAAO,EAGX,OAAO,GC/8IX8L,OAA8B,oBAAb,OAA4BA,UAC7CA,OAAOY,UAAiC,IAAjBZ,OAAW,KAAqBA,OAAOY,QAC9DZ,OAAO8B,aAAuC,IAApB9B,OAAc,QAAqBA,OAAO8B,WAKpE9B,OAAOY,KAAK4e,aAAe,SAAUrhB,EAAKD,GAGtC,OAFAC,EAAMA,GAAO,EACbD,EAAMA,GAAO,IACN3D,KAAKC,MAAMD,KAAKE,UAAYyD,EAAMC,EAAM,IAAMA,GAMzD6B,OAAOxE,cAAgB,SAAUE,GAC7B,IAAIR,EAIJ,OAHAQ,EAAQJ,KAAK,SAAUtK,GACnBkK,EAASlK,IAENkK,GAMX8E,OAAOY,KAAK0U,iBAAmB,SAAUC,EAAMC,GAG3C,UAAW,UAAkB,EACzB,OAAO,EAGX,GAAsB,mBAAX,EACP,OAAOD,EAAKtR,aAAeuR,EAAKvR,WAGpC,GAAIsR,aAAgBvC,QAAUwC,aAAgBxC,OAAQ,CAGlD,GAAIhT,OAAOY,KAAK6U,WAAWF,KAAUvV,OAAOY,KAAK6U,WAAWD,GACxD,OAAO,EAIX,IAAK5J,KAAK2J,EAEN,IADIvV,OAAOY,KAAK0U,iBAAiBC,EAAK3J,GAAI4J,EAAK5J,IAE3C,OAAO,EAGf,OAAO,EAEP,OAAO2J,IAASC,GAKxBxV,OAAOY,KAAK6U,WAAa,SAAU5F,GAC/B,IAAI6F,EAAQ,EACZ,IAAK9J,KAAKiE,EACFA,EAAInF,eAAekB,IACnB8J,IAGR,OAAOA,GAMX1V,OAAOY,KAAK2V,WAAa,SAAUjR,GAC/B,OAAIA,MAAAA,EACO,GAEU,iBAAV,EACAA,EAAKxN,QAAQ,KAAM,SAASA,QAAQ,KAAM,QAAQA,QAAQ,KAAM,QAEpEwN,GAMXtF,OAAOY,KAAKmT,YAAc,SAAUC,GAChC,OAAIhU,OAAOY,KAAKqT,QAAQD,GACb,GACJA,EAAMlF,WAAW,IAAK,KAAKA,WAAW,IAAK,KAAKA,WAAW,IAAK,KAAKA,WAAW,IAAK,MAMhG9O,OAAO8K,MAAQ,SAAU+E,GACrB,OAAOC,KAAKhE,MAAMgE,KAAKC,OAAOF,KAMlCtV,KAAKskC,KAAO,WACR,MAAO,uCAAuC/mC,QAAQ,QAAS,SAAU0W,GACrE,IAAInE,EAAoB,GAAhB9P,KAAKE,SAAgB,EAC7B,OADyC,KAAL+T,EAAWnE,EAAS,EAAJA,EAAU,GACrDpG,SAAS,OAwD1BjE,OAAOY,KAAKkU,WAAa,SAAU7W,GAE/B,GAAkB,GAAdA,EAAI5F,QAAgC,GAAjB4F,EAAI,GAAG5F,OAC1B,OAAO,EAEX,IAAK,IAAInE,KAAO+J,EACZ,GAAIA,EAAIyM,eAAexW,GACnB,OAAO,EAGf,OAAO,GAMX8L,OAAOY,KAAKkV,UAAY,SAAUwa,GAC9B,GAAIA,GAAUA,EAAO,GACjB,KAA6B,SAAtBA,EAAO,GAAG3sB,SAAkD,UAA5B2sB,EAAOz4B,IAAI,eAAyD,QAA5By4B,EAAOz4B,IAAI,eAA2By4B,EAAOC,SAASl4B,OAAS,GAC1Ii4B,EAASA,EAAOC,SAGxB,OAAOD,GAMXtwB,OAAOY,KAAK2W,eAAiB,SAAUV,GAKnC,IAJA,IAAIrY,KAGAgZ,IAFJX,EAAMA,GAAOrF,OAAOnI,SAASC,MACbjM,QAAQ,KAAO,EAAIwZ,EAAIlF,UAAUkF,EAAIxZ,QAAQ,KAAO,GAAK,IACvD9I,MAAM,KACfN,EAAI,EAAGA,EAAIujB,EAAMnf,OAAQpE,IAAK,CACnC,IAAIwjB,EAAMD,EAAMvjB,GAAGoJ,QAAQ,KAC3B,IAAY,GAARoa,EAAJ,CAEA,IAAIC,EAAUF,EAAMvjB,GAAG0d,UAAU,EAAG8F,GAChC1gB,EAAQygB,EAAMvjB,GAAG0d,UAAU8F,EAAM,GACrCjZ,EAAOkZ,GAAWpL,SAASvV,IAE/B,OAAOyH,GAOX,IAAIsgC,aAAe,SAAUtgC,GAqBzB,OApBWrL,KASN4rC,gBAAkB,SAASvgC,GAE5B,IAEIwgC,IAHJxgC,EAASA,OAEaygC,SAAS1qC,MAAM,UACb,GAIxB,OAFM2qC,uBAAyB,aAAeF,EAAW,IAAMxgC,EAAOygC,SAAW,QAMjFF,gBArBO5rC,KAqBe4rC,kBA2K9B,SAAS98B,OAAOC,GACZ,IAAqDC,EAAjDC,EAAO/D,MAAMiD,UAAUe,MAAMhD,KAAKmC,UAAW,GACjD,OAAOU,EAAIpK,QAAQ,aAAc,SAAUwK,EAAGC,GAE1C,QAAYlH,KADZ8G,EAAMC,EAAKI,SAEP,OAAQD,EAAIE,WAAW,IACnB,KAAK,IACD,OAAQN,EACZ,KAAK,IACD,OAAO5H,KAAKmI,OAAOP,GACvB,KAAK,IACD,OAAOQ,OAAOR,GAClB,KAAK,IACD,OAAOA,EAGnB,OAAOI,IApLfvC,OAAOY,KAAK0S,UAAY,SAAUlJ,GAC9B,OAAQwF,MAAM2D,WAAWnJ,KAAOoJ,SAASpJ,IAM7CpK,OAAOY,KAAK+U,mBAAqB,SAAUC,EAAMC,GAC7C,GAAYxa,MAARua,EACA,OAAO,EAIX,IAAIE,GADJD,EAASA,GAAUvlB,EAAEkhB,SACEsE,YACnBC,EAAUzlB,EAAEslB,GAAMje,SAASqe,IAG/B,OAFiBD,EAAUzlB,EAAEslB,GAAMK,UACfH,EAAYxlB,EAAEulB,GAAQI,UACAF,GAAWD,GASzD9V,OAAOY,KAAK4sB,iBAAmB,SAAUC,EAAWr6B,GAChD,IACIs6B,EADAC,IAAkB,WAAYrpB,SAAS0d,iBAG3C,QAAKyL,IAGAr6B,GAA8B,iBAAZA,IACnBA,EAAUkR,SAAS2d,cAAc7uB,GAAW,UAOhDs6B,GADAD,EAAY,KAAOA,KACQr6B,IAGPu6B,IACXv6B,EAAQ0R,eAGT1R,EAAUkR,SAAS2d,cAAc,QAEjC7uB,EAAQ0R,cAAgB1R,EAAQ+R,kBAChC/R,EAAQ0R,aAAa2oB,EAAW,IAChCC,EAA4C,mBAAvBt6B,EAAQq6B,QAEFpyB,IAAvBjI,EAAQq6B,KAERr6B,EAAQq6B,QAAapyB,GAEzBjI,EAAQ+R,gBAAgBsoB,KAGzBC,IAKX1tB,OAAOY,KAAK42B,UAAY,WACpB,OAAQzmB,UAAUC,UAAUpN,cAAcvG,QAAQ,YAAc,GAMpE,SAAW/M,GACPA,EAAE6P,GAAGxL,aAAe,SAAU6J,GAC1BwB,OAAOY,KAAKI,WAAWrM,gBAG3BrE,EAAE6P,GAAGjL,WAAa,WACd8K,OAAOY,KAAKI,WAAWC,eAN/B,CAQGxB,QAOHO,OAAOY,KAAK2wB,QAAU,SAAU1hB,GAC5B,IAAK3b,OAAO2b,EACiB,iBAAbA,EAAI3b,aAA0B2b,EAAI3b,KACrB,mBAAb2b,EAAI3b,OAAuB2b,EAAI3b,KAAO,YAAa2b,EAAI3b,OAO3E8L,OAAOY,KAAKmyB,aAAe,SAAUvjB,GACjC,OAAOA,EAAI1X,QAAQ,OAAQ,KAAMA,QAAQ,MAAO,KAAKA,QAAQ,QAAS,MAAMA,QAAQ,OAAQ,OAQhGkI,OAAOY,KAAKgJ,IAAM,SAAUC,GAGxB,IAAIC,EAAWA,GAAY,SAAUC,EAAGC,GAAK,IAAIC,KAAQC,EAAID,EAAEE,OAAUC,EAAI,aAAiBC,EAAIH,EAAEI,MAAS1Q,OAAQ,SAAU2Q,GAAKH,EAAE9I,UAAYnO,KAAM,IAAIqX,EAAI,IAAIJ,EAAwJ,OAArJG,GAAKC,EAAEC,MAAMF,GAAIC,EAAEE,eAAe,UAAYF,EAAEG,KAAO,WAAcH,EAAEI,OAAOD,KAAKpJ,MAAMpO,KAAMqO,aAAegJ,EAAEG,KAAKrJ,UAAYkJ,EAAGA,EAAEI,OAASzX,KAAaqX,GAAKK,OAAQ,WAAc,IAAIN,EAAIpX,KAAKyG,SAAsC,OAA5B2Q,EAAEI,KAAKpJ,MAAMgJ,EAAG/I,WAAmB+I,GAAKI,KAAM,aAAiBF,MAAO,SAAUF,GAAK,IAAK,IAAIC,KAAKD,EAAGA,EAAEG,eAAeF,KAAOrX,KAAKqX,GAAKD,EAAEC,IAAKD,EAAEG,eAAe,cAAgBvX,KAAK8Q,SAAWsG,EAAEtG,WAAa6G,MAAO,WAAc,OAAO3X,KAAKwX,KAAKrJ,UAAU1H,OAAOzG,QAAW4X,EAAIb,EAAEc,UAAYX,EAAEzQ,QAAS+Q,KAAM,SAAUJ,EAAGC,GAAKD,EAAIpX,KAAK8X,MAAQV,MAASpX,KAAK+X,SAA/rB,MAA0sBV,EAASA,EAAI,EAAID,EAAElS,QAAU4L,SAAU,SAAUsG,GAAK,OAAQA,GAAKY,GAAGC,UAAUjY,OAASkY,OAAQ,SAAUd,GAAK,IAAIC,EAAIrX,KAAK8X,MAAO3I,EAAIiI,EAAEU,MAAOxV,EAAItC,KAAK+X,SAAwC,GAA9BX,EAAIA,EAAEW,SAAU/X,KAAKmY,QAAa7V,EAAI,EAAG,IAAK,IAAI8V,EAAI,EAAGA,EAAIhB,EAAGgB,IAAKf,EAAE/U,EAAI8V,IAAM,KAAOjJ,EAAEiJ,IAAM,KAAO,GAAUA,EAAI,EAAT,EAAc,MAAQ,IAAW9V,EAAI8V,GAAK,EAAf,OAAwB,GAAI,MAAQjJ,EAAEjK,OAAQ,IAAKkT,EAAI,EAAGA,EAAIhB,EAAGgB,GAAK,EAAGf,EAAE/U,EAAI8V,IAAM,GAAKjJ,EAAEiJ,IAAM,QAASf,EAAEzO,KAAKwF,MAAMiJ,EAAGlI,GAAwB,OAApBnP,KAAK+X,UAAYX,EAAUpX,MAAQmY,MAAO,WAAc,IAAIf,EAAIpX,KAAK8X,MAAOT,EAAIrX,KAAK+X,SAAUX,EAAEC,IAAM,IAAM,YAAc,GAAUA,EAAI,EAAT,EAAaD,EAAElS,OAAS0R,EAAEyB,KAAKhB,EAAI,IAAMM,MAAO,WAAc,IAAIP,EAAIF,EAAES,MAAMzL,KAAKlM,MAAsC,OAA/BoX,EAAEU,MAAQ9X,KAAK8X,MAAM5I,MAAM,GAAWkI,GAAK9P,OAAQ,SAAU8P,GAAK,IAAK,IAAIC,KAAQlI,EAAI,EAAGA,EAAIiI,EAAGjI,GAAK,EAAGkI,EAAEzO,KAAK,WAAagO,EAAEtP,SAAW,GAAI,OAAO,IAAIsQ,EAAEJ,KAAKH,EAAGD,MAASkB,EAAIxB,EAAEyB,OAAUP,EAAIM,EAAEE,KAAQP,UAAW,SAAUb,GAAK,IAAIjI,EAAIiI,EAAEU,MAAOV,EAAIA,EAAEW,SAAU,IAAK,IAAIK,KAAQ9V,EAAI,EAAGA,EAAI8U,EAAG9U,IAAK,CAAE,IAAImW,EAAItJ,EAAE7M,IAAM,KAAO,GAAUA,EAAI,EAAT,EAAc,IAAK8V,EAAExP,MAAM6P,IAAM,GAAG3H,SAAS,KAAMsH,EAAExP,MAAU,GAAJ6P,GAAQ3H,SAAS,KAAO,OAAOsH,EAAEM,KAAK,KAAOC,MAAO,SAAUvB,GAAK,IAAK,IAAIjI,EAAIiI,EAAElS,OAAQkT,KAAQ9V,EAAI,EAAGA,EAAI6M,EAAG7M,GAAK,EAAG8V,EAAE9V,IAAM,IAAMmC,SAAS2S,EAAEwB,OAAOtW,EAAG,GAAI,KAAO,GAAUA,EAAI,EAAT,EAAa,OAAO,IAAIsV,EAAEJ,KAAKY,EAAGjJ,EAAI,KAAQA,EAAImJ,EAAEO,QAAWZ,UAAW,SAAUb,GAAK,IAAIjI,EAAIiI,EAAEU,MAAOV,EAAIA,EAAEW,SAAU,IAAK,IAAIK,KAAQ9V,EAAI,EAAGA,EAAI8U,EAAG9U,IAAK8V,EAAExP,KAAK4G,OAAOsJ,aAAa3J,EAAE7M,IAAM,KAAO,GAAUA,EAAI,EAAT,EAAc,MAAO,OAAO8V,EAAEM,KAAK,KAAOC,MAAO,SAAUvB,GAAK,IAAK,IAAIjI,EAAIiI,EAAElS,OAAQkT,KAAQ9V,EAAI,EAAGA,EAAI6M,EAAG7M,IAAK8V,EAAE9V,IAAM,KAAyB,IAAlB8U,EAAE9H,WAAWhN,KAAa,GAAUA,EAAI,EAAT,EAAa,OAAO,IAAIsV,EAAEJ,KAAKY,EAAGjJ,KAAQ4J,EAAIT,EAAEU,MAASf,UAAW,SAAUb,GAAK,IAAM,OAAO6B,mBAAmBpH,OAAO1C,EAAE8I,UAAUb,KAAO,MAAOgB,GAAK,MAAMc,MAAM,0BAA8BP,MAAO,SAAUvB,GAAK,OAAOjI,EAAEwJ,MAAMQ,SAASC,mBAAmBhC,OAAUgB,EAAIrB,EAAEsC,uBAAyBnC,EAAEzQ,QAAS6S,MAAO,WAActZ,KAAK8T,MAAQ,IAAI8D,EAAEJ,KAAMxX,KAAKuZ,YAAc,GAAKC,QAAS,SAAUpC,GAAK,iBAAmBA,IAAMA,EAAI2B,EAAEJ,MAAMvB,IAAKpX,KAAK8T,MAAMoE,OAAOd,GAAIpX,KAAKuZ,aAAenC,EAAEW,UAAY0B,SAAU,SAAUrC,GAAK,IAAIjI,EAAInP,KAAK8T,MAAOsE,EAAIjJ,EAAE2I,MAAOxV,EAAI6M,EAAE4I,SAAUU,EAAIzY,KAAK0Z,UAAW5C,EAAIxU,GAAK,EAAImW,GAAiG,GAAhCrB,GAA7DN,EAAIM,EAAIR,EAAEyB,KAAKvB,GAAKF,EAAE7L,KAAS,EAAJ+L,GAAS9W,KAAK2Z,eAAgB,IAAYlB,EAAGnW,EAAIsU,EAAE5L,IAAI,EAAIoM,EAAG9U,GAAQ8U,EAAG,CAAE,IAAK,IAAIL,EAAI,EAAGA,EAAIK,EAAGL,GAAK0B,EAAGzY,KAAK4Z,gBAAgBxB,EAAGrB,GAAIA,EAAIqB,EAAEyB,OAAO,EAAGzC,GAAIjI,EAAE4I,UAAYzV,EAAI,OAAO,IAAIsV,EAAEJ,KAAKT,EAAGzU,IAAMqV,MAAO,WAAc,IAAIP,EAAIF,EAAES,MAAMzL,KAAKlM,MAAqC,OAA9BoX,EAAEtD,MAAQ9T,KAAK8T,MAAM6D,QAAgBP,GAAKuC,eAAgB,IAAM5C,EAAE+C,OAAS1B,EAAE3R,QAASsT,IAAK7C,EAAEzQ,SAAU+Q,KAAM,SAAUJ,GAAKpX,KAAK+Z,IAAM/Z,KAAK+Z,IAAItT,OAAO2Q,GAAIpX,KAAKsZ,SAAWA,MAAO,WAAclB,EAAEkB,MAAMpN,KAAKlM,MAAOA,KAAKga,YAAcC,OAAQ,SAAU7C,GAAuC,OAAlCpX,KAAKwZ,QAAQpC,GAAIpX,KAAKyZ,WAAmBzZ,MAAQka,SAAU,SAAU9C,GAA2B,OAAtBA,GAAKpX,KAAKwZ,QAAQpC,GAAWpX,KAAKma,eAAiBT,UAAW,GAAIU,cAAe,SAAUhD,GAAK,OAAO,SAAUjI,EAAGiJ,GAAK,OAAO,IAAKhB,EAAEI,KAAKY,GAAI8B,SAAS/K,KAAQkL,kBAAmB,SAAUjD,GAAK,OAAO,SAAUjI,EAAGiJ,GAAK,OAAO,IAAKK,EAAE6B,KAAK9C,KAAKJ,EAAGgB,GAAI8B,SAAS/K,OAAW,IAAIsJ,EAAI3B,EAAEyD,QAAW,OAAOzD,EAArtH,CAAytH1P,MAEpvH,OAF2vH,SAAWwP,GAAK,SAASC,EAAE1H,EAAGsJ,EAAGrB,EAAGC,EAAGN,EAAGzU,EAAGwU,GAAuC,QAAlC3H,EAAIA,GAAKsJ,EAAIrB,GAAKqB,EAAIpB,GAAKN,EAAID,IAAgBxU,EAAI6M,IAAM,GAAK7M,GAAKmW,EAAI,SAAS3B,EAAE3H,EAAGsJ,EAAGrB,EAAGC,EAAGN,EAAGzU,EAAGwU,GAAuC,QAAlC3H,EAAIA,GAAKsJ,EAAIpB,EAAID,GAAKC,GAAKN,EAAID,IAAgBxU,EAAI6M,IAAM,GAAK7M,GAAKmW,EAAI,SAAS1B,EAAE5H,EAAGsJ,EAAGrB,EAAGC,EAAGN,EAAGzU,EAAGwU,GAAkC,QAA7B3H,EAAIA,GAAKsJ,EAAIrB,EAAIC,GAAKN,EAAID,IAAgBxU,EAAI6M,IAAM,GAAK7M,GAAKmW,EAAI,SAASxB,EAAE9H,EAAGsJ,EAAGrB,EAAGC,EAAGN,EAAGzU,EAAGwU,GAAqC,QAAhC3H,EAAIA,GAAKiI,GAAKqB,GAAKpB,IAAMN,EAAID,IAAgBxU,EAAI6M,IAAM,GAAK7M,GAAKmW,EAAI,IAAK,IAAIvB,EAAIP,EAAqB2B,GAAXV,EAAIV,EAAEF,KAAWa,UAAWG,EAAIJ,EAAEkC,OAAQlC,EAAIV,EAAEqD,KAAMpL,KAAQ4J,EAAI,EAAG,GAAKA,EAAGA,IAAK5J,EAAE4J,GAAK,WAAanC,EAAE4D,IAAI5D,EAAE6D,IAAI1B,EAAI,IAAM,EAAGnB,EAAIA,EAAE8C,IAAM1C,EAAEvR,QAASuT,SAAU,WAAcha,KAAK2a,MAAQ,IAAIrC,EAAEd,MAAM,WAAY,WAAY,WAAY,aAAeoC,gBAAiB,SAAUxB,EAAGK,GAAK,IAAK,IAAIrB,EAAI,EAAG,GAAKA,EAAGA,IAAK,CAAE,IAAewD,EAAIxC,EAAff,EAAIoB,EAAIrB,GAAagB,EAAEf,GAA2B,UAArBuD,GAAK,EAAIA,IAAM,IAAuC,YAArBA,GAAK,GAAKA,IAAM,GAAsBxD,EAAIpX,KAAK2a,MAAM7C,MAAnB,IAAuuE+C,EAAiC5M,EAA9uEoJ,EAAIe,EAAEK,EAAI,GAAkBnW,GAAdsY,EAAIxC,EAAEK,EAAI,GAAQL,EAAEK,EAAI,IAAIb,EAAIQ,EAAEK,EAAI,GAAIvB,EAAIkB,EAAEK,EAAI,GAAI7B,EAAIwB,EAAEK,EAAI,GAAIT,EAAII,EAAEK,EAAI,GAAIM,EAAIX,EAAEK,EAAI,GAAIH,EAAIF,EAAEK,EAAI,GAAIqC,EAAI1C,EAAEK,EAAI,GAAIsC,EAAI3C,EAAEK,EAAI,IAAKuC,EAAI5C,EAAEK,EAAI,IAAKwC,EAAI7C,EAAEK,EAAI,IAAKyC,EAAI9C,EAAEK,EAAI,IAAK0C,EAAI/C,EAAEK,EAAI,IAAK2C,EAAIhD,EAAEK,EAAI,IAAK4C,EAAIjE,EAAE,GAAmiEkE,EAAIrE,EAAvIqE,EAAIrE,EAAvIqE,EAAIrE,EAAvIqE,EAAIrE,EAAvIqE,EAAIvE,EAAvIuE,EAAIvE,EAAvIuE,EAAIvE,EAAvIuE,EAAIvE,EAAvIuE,EAAIxE,EAAtIwE,EAAIxE,EAAtIwE,EAAIxE,EAAtIwE,EAAIxE,EAAtIwE,EAAIzE,EAAvIyE,EAAIzE,EAApIyE,EAAIzE,EAAnIyE,EAAIzE,EAAjIyE,EAAIlE,EAAE,GAAuFnJ,EAAI4I,EAAvF5I,EAAImJ,EAAE,GAA6CyD,EAAIhE,EAA7CgE,EAAIzD,EAAE,GAAIiE,EAAIxE,EAAEwE,EAAGC,EAAGrN,EAAG4M,EAAGxD,EAAG,EAAGlI,EAAE,IAAiBmM,EAAGrN,EAAG2M,EAAG,GAAIzL,EAAE,IAAiBkM,EAAGC,EAAGhZ,EAAG,GAAI6M,EAAE,IAAiB0L,EAAGQ,EAAGzD,EAAG,GAAIzI,EAAE,IAAoElB,EAAI4I,EAAE5I,EAAtC4M,EAAIhE,EAAEgE,EAArCQ,EAAIxE,EAAEwE,EAAGC,EAAGrN,EAAG4M,EAAG3D,EAAG,EAAG/H,EAAE,IAAiBmM,EAAGrN,EAAG2I,EAAG,GAAIzH,EAAE,IAAiBkM,EAAGC,EAAGtD,EAAG,GAAI7I,EAAE,IAAiB0L,EAAGQ,EAAGtC,EAAG,GAAI5J,EAAE,IAAoElB,EAAI4I,EAAE5I,EAAtC4M,EAAIhE,EAAEgE,EAArCQ,EAAIxE,EAAEwE,EAAGC,EAAGrN,EAAG4M,EAAGvC,EAAG,EAAGnJ,EAAE,IAAiBmM,EAAGrN,EAAG6M,EAAG,GAAI3L,EAAE,IAAiBkM,EAAGC,EAAGP,EAAG,GAAI5L,EAAE,KAAkB0L,EAAGQ,EAAGL,EAAG,GAAI7L,EAAE,KAAuElB,EAAI4I,EAAE5I,EAAvC4M,EAAIhE,EAAEgE,EAAtCQ,EAAIxE,EAAEwE,EAAGC,EAAGrN,EAAG4M,EAAGI,EAAG,EAAG9L,EAAE,KAAkBmM,EAAGrN,EAAGiN,EAAG,GAAI/L,EAAE,KAAkBkM,EAAGC,EAAGH,EAAG,GAAIhM,EAAE,KAAkB0L,EAAGQ,EAAGD,EAAG,GAAIjM,EAAE,KAAsElB,EAAI6I,EAAE7I,EAAtC4M,EAAI/D,EAAE+D,EAAtCQ,EAAIvE,EAAEuE,EAAGC,EAAGrN,EAAG4M,EAAGD,EAAG,EAAGzL,EAAE,KAAkBmM,EAAGrN,EAAG+J,EAAG,EAAG7I,EAAE,KAAkBkM,EAAGC,EAAGN,EAAG,GAAI7L,EAAE,KAAkB0L,EAAGQ,EAAGhE,EAAG,GAAIlI,EAAE,KAAsElB,EAAI6I,EAAE7I,EAAtC4M,EAAI/D,EAAE+D,EAAtCQ,EAAIvE,EAAEuE,EAAGC,EAAGrN,EAAG4M,EAAGjE,EAAG,EAAGzH,EAAE,KAAkBmM,EAAGrN,EAAG8M,EAAG,EAAG5L,EAAE,KAAkBkM,EAAGC,EAAGF,EAAG,GAAIjM,EAAE,KAAkB0L,EAAGQ,EAAGnE,EAAG,GAAI/H,EAAE,KAAsElB,EAAI6I,EAAE7I,EAAtC4M,EAAI/D,EAAE+D,EAAtCQ,EAAIvE,EAAEuE,EAAGC,EAAGrN,EAAG4M,EAAGC,EAAG,EAAG3L,EAAE,KAAkBmM,EAAGrN,EAAGkN,EAAG,EAAGhM,EAAE,KAAkBkM,EAAGC,EAAG1D,EAAG,GAAIzI,EAAE,KAAkB0L,EAAGQ,EAAG/C,EAAG,GAAInJ,EAAE,KAAsElB,EAAI6I,EAAE7I,EAAtC4M,EAAI/D,EAAE+D,EAAtCQ,EAAIvE,EAAEuE,EAAGC,EAAGrN,EAAG4M,EAAGK,EAAG,EAAG/L,EAAE,KAAkBmM,EAAGrN,EAAG3L,EAAG,EAAG6M,EAAE,KAAkBkM,EAAGC,EAAGvC,EAAG,GAAI5J,EAAE,KAAkB0L,EAAGQ,EAAGJ,EAAG,GAAI9L,EAAE,KAAuElB,EAAI8I,EAAE9I,EAAvC4M,EAAI9D,EAAE8D,EAAtCQ,EAAItE,EAAEsE,EAAGC,EAAGrN,EAAG4M,EAAGjE,EAAG,EAAGzH,EAAE,KAAkBmM,EAAGrN,EAAGqK,EAAG,GAAInJ,EAAE,KAAkBkM,EAAGC,EAAGN,EAAG,GAAI7L,EAAE,KAAkB0L,EAAGQ,EAAGF,EAAG,GAAIhM,EAAE,KAAuElB,EAAI8I,EAAE9I,EAAvC4M,EAAI9D,EAAE8D,EAAtCQ,EAAItE,EAAEsE,EAAGC,EAAGrN,EAAG4M,EAAGD,EAAG,EAAGzL,EAAE,KAAkBmM,EAAGrN,EAAGiJ,EAAG,GAAI/H,EAAE,KAAkBkM,EAAGC,EAAGvC,EAAG,GAAI5J,EAAE,KAAkB0L,EAAGQ,EAAGN,EAAG,GAAI5L,EAAE,KAAuElB,EAAI8I,EAAE9I,EAAvC4M,EAAI9D,EAAE8D,EAAtCQ,EAAItE,EAAEsE,EAAGC,EAAGrN,EAAG4M,EAAGK,EAAG,EAAG/L,EAAE,KAAkBmM,EAAGrN,EAAGoJ,EAAG,GAAIlI,EAAE,KAAkBkM,EAAGC,EAAG1D,EAAG,GAAIzI,EAAE,KAAkB0L,EAAGQ,EAAGrD,EAAG,GAAI7I,EAAE,KAAuElB,EAAI8I,EAAE9I,EAAvC4M,EAAI9D,EAAE8D,EAAtCQ,EAAItE,EAAEsE,EAAGC,EAAGrN,EAAG4M,EAAGC,EAAG,EAAG3L,EAAE,KAAkBmM,EAAGrN,EAAGgN,EAAG,GAAI9L,EAAE,KAAkBkM,EAAGC,EAAGF,EAAG,GAAIjM,EAAE,KAAkB0L,EAAGQ,EAAG/Y,EAAG,GAAI6M,EAAE,KAAuElB,EAAIgJ,EAAEhJ,EAAvC4M,EAAI5D,EAAE4D,EAAtCQ,EAAIpE,EAAEoE,EAAGC,EAAGrN,EAAG4M,EAAGxD,EAAG,EAAGlI,EAAE,KAAkBmM,EAAGrN,EAAG8K,EAAG,GAAI5J,EAAE,KAAkBkM,EAAGC,EAAGH,EAAG,GAAIhM,EAAE,KAAkB0L,EAAGQ,EAAGzE,EAAG,GAAIzH,EAAE,KAAuElB,EAAIgJ,EAAEhJ,EAAvC4M,EAAI5D,EAAE4D,EAAtCQ,EAAIpE,EAAEoE,EAAGC,EAAGrN,EAAG4M,EAAGI,EAAG,EAAG9L,EAAE,KAAkBmM,EAAGrN,EAAG2J,EAAG,GAAIzI,EAAE,KAAkBkM,EAAGC,EAAGP,EAAG,GAAI5L,EAAE,KAAkB0L,EAAGQ,EAAGT,EAAG,GAAIzL,EAAE,KAAuElB,EAAIgJ,EAAEhJ,EAAvC4M,EAAI5D,EAAE4D,EAAtCQ,EAAIpE,EAAEoE,EAAGC,EAAGrN,EAAG4M,EAAGvC,EAAG,EAAGnJ,EAAE,KAAkBmM,EAAGrN,EAAGmN,EAAG,GAAIjM,EAAE,KAAkBkM,EAAGC,EAAGtD,EAAG,GAAI7I,EAAE,KAAkB0L,EAAGQ,EAAGH,EAAG,GAAI/L,EAAE,KAAuElB,EAAIgJ,EAAEhJ,EAAvC4M,EAAI5D,EAAE4D,EAAtCQ,EAAIpE,EAAEoE,EAAGC,EAAGrN,EAAG4M,EAAG3D,EAAG,EAAG/H,EAAE,KAAkBmM,EAAGrN,EAAG+M,EAAG,GAAI7L,EAAE,KAAkBkM,EAAGC,EAAGhZ,EAAG,GAAI6M,EAAE,KAAkB0L,EAAGQ,EAAGP,EAAG,GAAI3L,EAAE,KAAMiI,EAAE,GAAKA,EAAE,GAAKiE,EAAI,EAAGjE,EAAE,GAAKA,EAAE,GAAKkE,EAAI,EAAGlE,EAAE,GAAKA,EAAE,GAAKnJ,EAAI,EAAGmJ,EAAE,GAAKA,EAAE,GAAKyD,EAAI,GAAKV,YAAa,WAAc,IAAIhL,EAAInP,KAAK8T,MAAO2E,EAAItJ,EAAE2I,MAAOV,EAAI,EAAIpX,KAAKuZ,YAAalC,EAAI,EAAIlI,EAAE4I,SAAUU,EAAEpB,IAAM,IAAM,KAAO,GAAKA,EAAI,GAAI,IAAIN,EAAIH,EAAEvP,MAAM+P,EAAI,YAA8R,IAAjRqB,EAAwB,IAArBpB,EAAI,KAAO,GAAK,IAAiC,UAArBN,GAAK,EAAIA,IAAM,IAAuC,YAArBA,GAAK,GAAKA,IAAM,GAAiB0B,EAAwB,IAArBpB,EAAI,KAAO,GAAK,IAAiC,UAArBD,GAAK,EAAIA,IAAM,IAAuC,YAArBA,GAAK,GAAKA,IAAM,GAAiBjI,EAAE4I,SAAW,GAAKU,EAAEvT,OAAS,GAAIlF,KAAKyZ,WAA4BhB,GAAhBtJ,EAAInP,KAAK2a,OAAa7C,MAAYV,EAAI,EAAG,EAAIA,EAAGA,IAAKC,EAAIoB,EAAErB,GAAIqB,EAAErB,GAA2B,UAArBC,GAAK,EAAIA,IAAM,IAAuC,YAArBA,GAAK,GAAKA,IAAM,GAAiB,OAAOlI,GAAKwI,MAAO,WAAc,IAAIxI,EAAI6I,EAAEL,MAAMzL,KAAKlM,MAAqC,OAA9BmP,EAAEwL,MAAQ3a,KAAK2a,MAAMhD,QAAgBxI,KAAQ+H,EAAEwD,IAAM1C,EAAEoC,cAAcxC,GAAIV,EAAEqE,QAAUvD,EAAEqC,kBAAkBzC,GAAp9H,CAA09HxQ,MAE9sPuP,EAAS+D,IAAIhE,GAAS5F,YAUjCjE,OAAOY,KAAKq0B,UAAY,SAAUC,EAASC,EAAaC,GACpDD,EAAcA,GAAe,GAC7BC,EAAYA,GAAa,IAKzB,IAHA,IAAIC,EAAiBC,KAAKJ,GACtBK,KAEK59B,EAAS,EAAGA,EAAS09B,EAAeh9B,OAAQV,GAAUy9B,EAAW,CAItE,IAHA,IAAI/yB,EAAQgzB,EAAehzB,MAAM1K,EAAQA,EAASy9B,GAE9CI,EAAc,IAAIn3B,MAAMgE,EAAMhK,QACzBpE,EAAI,EAAGA,EAAIoO,EAAMhK,OAAQpE,IAC9BuhC,EAAYvhC,GAAKoO,EAAMI,WAAWxO,GAGtC,IAAIwhC,EAAY,IAAIC,WAAWF,GAE/BD,EAAWx5B,KAAK05B,GAIpB,OADW,IAAIE,KAAKJ,GAAcn4B,KAAM+3B,KAI5Cn1B,OAAOY,KAAK4wB,UAAY,SAAUC,EAAOryB,GAG7B,IAAI9K,EAFZ,GAAMm9B,EACF,GAA+C,mBAA3Cze,OAAO1R,UAAU2C,SAAS1C,MAAMkwB,IAA6E,sBAA9Cze,OAAO1R,UAAU2C,SAAS1C,MAAMnC,IAE/F,IAAK9K,KAASm9B,EACV,GAAIA,EAAM/mB,eAAepW,KAEP,IADN8K,EAASC,KAAKoyB,EAAMn9B,GAAQA,EAAOm9B,EAAMn9B,IAE7C,YAKZhE,EAAE0D,KAAKy9B,EAAOryB,IA4B1BY,OAAOY,KAAKoyB,gBAAkB,SAAU1tB,GAEpC,OADS,IAAI1D,OAAO,eACVyD,KAAKC,IAOnBtF,OAAOY,KAAKuU,UAAY,SAAUC,EAAIC,GAC9BD,EAAG/c,SACH+c,EAAKA,EAAG,IAEZ,IAAIla,IAAWka,EADfC,EAA2B,aAAdA,EAA4B,YAAc,cAOvD,OALKna,IACDka,EAAGC,GAAa,EAChBna,IAAWka,EAAGC,GACdD,EAAGC,GAAa,GAEbna,GAQX8E,OAAOY,KAAKu+B,iBAAmB,SAASlvB,GACpC,OAAOmvB,KAAK7yB,mBAAmB0D,GAAQnY,QAAQ,kBAAmB,SAAUmZ,EAAOouB,GAC/E,OAAO18B,OAAOsJ,aAAa,KAAOozB,OAK1Cr/B,OAAOY,KAAK8wB,oBAAsB,SAAU11B,EAAQwnB,GAG5CA,EAAgBA,GAAiB,IAFrC,IAIImO,EAAM,GAENC,GAAgB,EAChBC,GAAoB,EACxB71B,GAAUA,EAAO3D,OAAS,EAAI2D,EAAOiI,WAAWL,cAAgB,IAAI9L,QAAQ,KAAM,IAClF,IAAK,IAAI7D,EAAI,EAAGA,EAAI+H,EAAO3D,OAAQpE,KATf,MAUX+H,EAAO/H,IATK,MASmB+H,EAAO/H,IAAiC,IAANA,GAP1D,KAOqE+H,EAAO/H,EAAI,KAEhF2b,MAAM5S,OAAOhB,EAAO/H,KAGtB+H,EAAO/H,KAAOuvB,GAAmBoO,EAZ/B,MAgBF51B,EAAO/H,IAAsB49B,IACnCF,GAAO31B,EAAO/H,GACd49B,GAAoB,IALpBF,GAAO31B,EAAO/H,GACd29B,GAAgB,GANhBD,GAAO31B,EAAO/H,GAatB,OAAO09B,GAIX3xB,OAAOY,KAAKkxB,yBAA2B,SAAU91B,EAAQwnB,EAAeuO,EAASC,EAAaC,GAC1FzO,EAAgBA,GAAiB,IACjCxnB,EAASgE,OAAOY,KAAK8wB,oBAAoB11B,EAAQwnB,GACjDuO,EAAWA,EAAU,EAAKA,EAAU,GACpCC,EAAeA,EAAc,EAAKA,GAAe,IACjDC,EAAeA,EAAc,EAAKA,EAAc,IAChD,IACIC,EAAU,IAAItwB,OAAO,UAAY4hB,EAAgB,2BACjD2O,EAAWn2B,EAAOiV,MAAMihB,GAGxBE,EAAM,EAENC,EAAuB,MAAdr2B,EAAO,GAAaA,EAAO,GAAK,GACzCs2B,EAAqB,EAKzB,GAHAt2B,EAASA,EAAOlE,QAAQu6B,EAAQ,IAG5BF,GAAYA,EAAS,IAAMA,EAAS,GAAI,CACxC,IAAII,EAAYJ,EAAS,GAAMA,EAAS,GAAGr6B,QAAQq6B,EAAS,GAAI,IAAI59B,MAAMivB,GAAkB,GAExFgP,EAAoB,GACpBC,EAAU,GA+Bd,OA3BAF,EAAU,GAAKA,EAAU,GAAGz6B,QAAQ,OAAQ,IAExCy6B,EAAU,GAAGl6B,OAAS,GAEtBi6B,GADAE,EAAoBD,EAAU,GAAGlwB,MAAM,IACAhK,OACvCo6B,EAAUF,EAAU,GAAG,IAAM,GAC7BC,EAAoBA,EAAkBnnB,OAAO8mB,EAAS,IAAM,KAE/B,IAAxBI,EAAU,GAAGl6B,QAClBo6B,EAAUF,EAAU,GAAG,IAAM,GAC7BC,EAAoBA,EAAkBnnB,OAAOknB,EAAU,IAAM,MAG7DD,EAAqBC,EAAU,GAAGl6B,OAClCk6B,EAAU,GAAKA,EAAU,GAAGz6B,QAAQ,OAAQ,IAC5Cw6B,EAAsBC,EAAU,GAAGl6B,OAAS,EAAKi6B,EACjDG,EAAUF,EAAU,GAAG,GACvBC,EAAoBD,EAAU,GAAGlwB,MAAM,KAG3CmwB,EAAoBA,EAAkB16B,QAAQ0rB,EAAe,IAAI1rB,QAAQ,OAAQ,KAE3DO,QAAU05B,IAC5BS,EAAoBA,EAAkBnwB,MAAM,EAAG0vB,EAAU,IAItDM,EAASI,GAAWD,EAAqBhP,EAAgBgP,EAAqB,IAhDzE,MA+CZJ,GADAA,EAAMp1B,OAAOm1B,EAAS,GAAGr6B,QA9Cb,IA8CgC,KAAOw6B,GACtCL,EAAeA,EAAeG,EAAMJ,EAAeA,EAAcI,GACgC,EAAI,IAAMA,EAAMA,GAE7H,GAAIp2B,EAAQ,CAEbs2B,EAAqBt2B,EAAOqB,QAAQmmB,GACpC,IAAIkP,EAAO,EACPC,EAAK32B,EAAO3D,OAAS,EAGzB2D,EAASA,EAAOlE,QAAQ0rB,EAAe,IAIvC,IADA,IAAIvvB,EAAIy+B,GACAE,GACc,MAAd52B,EAAO/H,IAAc+H,EAAO/H,KAAOuvB,GAAiBoP,GAAkB,EAAMF,EAAOz+B,GAChFA,IAKX,IAFA,IAAI2+B,GAAkB,EAClBn9B,EAAIk9B,GACAC,GACc,MAAd52B,EAAOvG,IAAcuG,EAAOvG,KAAO+tB,GAAwBoP,GAAkB,EAAMD,EAAKl9B,EAAI,GACzFA,IAGX,GADAk9B,EAAKA,EAAKZ,EAAUW,EAAOX,EAAUW,EAAOC,GAChB,IAAxBL,EAA2B,CAEvBM,GAAkB,EAItB,OADAR,EAAME,GADWI,EAAO,IADpBF,EAAoBx2B,EAAOqG,MAAMqwB,EAAMC,IAGrBt6B,OAAS,IAAMuX,MAAM5S,OAAOw1B,EAAkB,KACzDH,EAASG,EAAkB,IAAMA,EAAkBn6B,OAAS,EAAImrB,EAAgBgP,EAAkBnwB,MAAM,GAAK,IAhFhH,KAgFmI+vB,EAAM,EAAI,IAAMA,EAAMA,GAEnJ,IAKd,IAAIS,EAAa72B,EAAOqG,MAAMqwB,EAAMA,EAAO,GACvCI,EAAa92B,EAAOqG,MAAMqwB,EAAO,EAAG12B,EAAO3D,QAM/C,OALA+5B,EAAMU,EAAWz6B,QACjBy6B,EAAaA,EAAWh7B,QAAQ,OAAQ,KACzBO,OAAS05B,IACpBe,EAAa92B,EAAOqG,MAAMqwB,EAAO,EAAGX,EAAUW,IAE9C11B,OAAO61B,GACAR,EAASQ,GAAcC,EAAWz6B,OAAS,EAAImrB,EAAgBsP,EAAa,IA/F/E,KA+FkGV,EAAM,EAAI,IAAMA,EAAMA,GAChH,IAGjB,MAAO,IAGlBpyB,OAAOY,KAAKmS,SAAW,SAAUhc,GAC7B,MAAkD,oBAA3Cic,OAAO1R,UAAU2C,SAAS1C,MAAMxK,IAG3CiJ,OAAOY,KAAKsS,QAAU,SAAUnc,GAC5B,MAAkD,mBAA3Cic,OAAO1R,UAAU2C,SAAS1C,MAAMxK,IC1kB3C,SAAWzG,GAEP,IAAIgvC,GAAkBt/B,OAAOY,KAAK4sB,iBAAiB,SAAW,QAAU,SAAW,QAEnFl9B,EAAEC,OAAO,WAEL0C,MAAO,WAEH,IAAIzC,EAAU2C,KAAK3C,QAAS0C,EAAOC,KAEnC7C,EAAEsJ,OAAOzG,MAAQosC,MAAO,SAAUC,EAAOC,GAAO,OAAOnvC,EAAEoP,GAAGggC,KAAKH,MAAMrsC,EAAKE,QAASosC,EAAOC,MAEvFjvC,EAAQkvC,MAASlvC,EAAQkvC,KAAKrnC,SAC9B7H,EAAQmvC,aAAgBnvC,EAAQmvC,YAAYtnC,SAC7C7H,EAAQmvC,YAAc,KAG1BxsC,KAAKysC,iBACLzsC,KAAK0sC,cACL1sC,KAAK2sC,UAAW3sC,KAAKC,QAAQmP,MAAMlK,QAAU7H,EAAQuvC,iBAGzDj/B,QAAS,WACL3N,KAAKC,QACbknB,OAAO,SACP0lB,WAAW,SAGPjpC,MAAO,WACS5D,KAAKC,QAAjB,IACTF,EAAOC,KACP8sC,EAAM3vC,EAAE2N,IAAI/K,EAAKgtC,OAAQ,SAAU1xB,EAAGva,GAAK,OAAOf,EAAKitC,MAAMlsC,GAAKua,EAAI,OAAS3C,KAAK,IACpFxB,EAAI,IAAIzI,OAAO,KAAOzO,KAAK3C,QAAQmvC,YAAa,MACvC,OAAOM,EAAInoC,QAAQuS,EAAG,KAG1B+1B,UAAW,WACP,IAAI/1B,EAAI,IAAIzI,OAAO,KAAOzO,KAAK3C,QAAQmvC,YAAa,MAEpD,OADHxsC,KAAKC,QAAQmP,MACCzK,QAAQuS,EAAG,KAG1B9I,MAAO,WACHpO,KAAKC,QAAQgF,QAAQ,eAGzBioC,SAAU,SAAUnsC,EAAK6C,GAErBzG,EAAEC,OAAO+Q,UAAU++B,SAAS9+B,MAAMpO,KAAMqO,WACxC,IAAIhR,EAAU2C,KAAK3C,QAEnB,OAAQ0D,GACJ,IAAK,OAED,IAAK1D,EAAQkvC,OAASlvC,EAAQkvC,KAAKrnC,OAAQ,CACvClF,KAAKC,QAAQknB,OAAO,SACpB,MAER,IAAK,cACI9pB,EAAQmvC,aAAgBnvC,EAAQmvC,YAAYtnC,SAC7C7H,EAAQmvC,YAAc,KAE1BxsC,KAAKC,QAAQmP,IAAI,IACjBpP,KAAKysC,kBACJzsC,KAAKmtC,aAAentC,KAAK0sC,gBAMtCD,eAAgB,WAEZzsC,KAAKotC,cAEL,IAAIrtC,EAAOC,KACpBuuB,EAAQvuB,KAAKC,QACb5C,EAAU2C,KAAK3C,QACfkvC,EAAOlvC,EAAQkvC,KACfc,EAAOlwC,EAAEoP,GAAGggC,KAAKe,YACjBN,KACAO,EAAkBhB,EAAKrnC,OACvBsoC,EAAkB,KACZjB,EAAKrnC,OAGGqpB,EAAMnrB,GAAG,YAAWmrB,EAAMnf,IAAMmf,EAAMhrB,MAE3CpG,EAAE0D,KAAK0rC,EAAKnrC,MAAM,IAAK,SAAUN,EAAGua,GACvB,KAALA,GACAgK,EACAkoB,EAAkBzsC,GAEbusC,EAAKhyB,IACV2xB,EAAMpkC,KAAK,IAAI6F,OAAO4+B,EAAKhyB,KACJ,MAAnBmyB,IACAA,EAAkBR,EAAM9nC,OAAS,IAGrC8nC,EAAMpkC,KAAK,QAInBzL,EAAEsJ,OAAOzG,MACL+sC,OAAQ5vC,EAAE2N,IAAIyhC,EAAKnrC,MAAM,IAAK,SAAUia,EAAGva,GACvC,GAAS,KAALua,EACA,OAAOgyB,EAAKhyB,GAAKhe,EAAQmvC,YAAcnxB,IAG/C2xB,MAAOA,EACPQ,gBAAiBA,EACjBD,gBAAiBA,IAGrBvtC,KAAK+sC,OAAS5vC,EAAE2N,IAAI9K,KAAK+sC,OAAQ,SAAU1xB,EAAGva,GAC1C,MAAS,MAALua,EACOtb,EAAK0tC,YAAY3sC,GAErBua,IAGXrb,KAAK3C,QAAQkvC,KAAOA,EAAOvsC,KAAKytC,aAGpCf,YAAa,WAET,IAAI3sC,EAAOC,KACpBuuB,EAAQvuB,KAAKC,QACbytC,GAAS,EACTC,EAAYpf,EAAMnf,MA8DJmf,EAAMjtB,KAAK,cACZitB,EACXvpB,KAAK,aAAc,WAChB2oC,EAAYpf,EAAMnf,MAClB,IAAIkV,EAAMvkB,EAAK4sC,YACf5sC,EAAK6tC,eACL9rC,WAAW,WACHwiB,GAAOvkB,EAAK1C,QAAQkvC,KAAKrnC,OACzBnF,EAAKqsC,MAAM,EAAG9nB,GAEdvkB,EAAKqsC,MAAM9nB,IAChB,KAENtf,KAAK,YAAa,WACfjF,EAAK4sC,YACDpe,EAAMnf,OAASu+B,GACfpf,EAAMsf,WAEb7oC,KAAK,aAAc,WAChB2oC,EAAYpf,EAAMnf,MACRrP,EAAK4sC,YACf5sC,EAAK6tC,iBAER5oC,KAAK,eAnFE,SAAsBiJ,GAClBA,EAAIA,GAAKoQ,OAAOqI,MAChB,IAAIpC,EAAMvkB,EAAKqsC,QAC3B3zB,EAAIxK,EAAE6/B,QACNA,EAAU3wC,EAAEoP,GAAGuhC,QASH,OAPAJ,EAAUj1B,EAAIq1B,EAAQC,OAAUt1B,EAAIq1B,EAAQC,OAASt1B,EAAIq1B,EAAQE,OAAWv1B,EAAIq1B,EAAQE,OAASv1B,EAAI,GAGhG6L,EAAI+nB,MAAQ/nB,EAAIgoB,KAAQ,GAAOoB,GAAUj1B,GAAKq1B,EAAQG,WAAax1B,GAAKq1B,EAAQI,QACjFnuC,EAAKouC,aAAa7pB,EAAI+nB,MAAO/nB,EAAIgoB,KAGjC7zB,GAAKq1B,EAAQG,WAAax1B,GAAKq1B,EAAQI,QACvCnuC,EAAKquC,QAAQ9pB,EAAI+nB,OAAU5zB,GAAKq1B,EAAQI,QAAWz1B,GAAKq1B,EAAQG,WAAa3pB,EAAI+nB,OAAS/nB,EAAIgoB,IAAQ,GAAK,GAAIllC,KAAKoT,IAAI8J,EAAI+nB,MAAQ/nB,EAAIgoB,OACjI,GAEF7zB,GAAKq1B,EAAQO,QAClB9f,EAAMnf,IAAIu+B,GACV5tC,EAAKqsC,MAAM,EAAGrsC,EAAK4sC,cACZ,QAHN,IAmEhB3nC,KAAK,gBA5DE,SAAuBiJ,GAInB,IAAIwK,GAFJxK,EAAIA,GAAKoQ,OAAOqI,OAEN4nB,UAAYrgC,EAAE6/B,SAAW7/B,EAAEsgC,MACjDT,EAAU3wC,EAAEoP,GAAGuhC,QACfzoB,EAAMtlB,EAAK1C,QAAQkvC,KAAKrnC,OAEZ,GAAIwoC,EAGA,OAFAA,GAAS,EAEDz/B,EAAE6/B,SAAWA,EAAQG,WAAqB,KAGtD,IAAI3pB,EAAMvkB,EAAKqsC,QAEf,GAAIn+B,EAAEugC,SAAWvgC,EAAEwgC,QAAUxgC,EAAEygC,QAC3B,OAAO,EAEN,GAAKj2B,GAAKq1B,EAAQE,OAASv1B,GAAK,KAAQA,EAAI,IAAK,CAClD,IAAI5B,EAAI9W,EAAK4uC,UAAUrqB,EAAI+nB,MAAQ,GACnC,GAAIx1B,EAAIwO,EAAK,CACT,IAAIhK,EAAI7L,OAAOsJ,aAAaL,GAC5B,GAAI1Y,EAAKitC,MAAMn2B,IAAM9W,EAAKitC,MAAMn2B,GAAG3E,KAAKmJ,GAAI,CACxCtb,EAAK6uC,QAAQ/3B,GACb9W,EAAKgtC,OAAOl2B,GAAKwE,EACjBtb,EAAK6tC,eACL,IAAIiB,EAAO9uC,EAAK4uC,UAAU93B,GAC1B9W,EAAKqsC,MAAMyC,GACX9uC,EAAK1C,QAAQyxC,WAAaD,GAAQxpB,GAAOtlB,EAAK1C,QAAQyxC,UAAU5iC,KAAKqiB,KAIjF,OAAO,IA4BlBvpB,KAAKmnC,EAAgB,WAClBrqC,WAAW,WAAc/B,EAAKqsC,MAAMrsC,EAAK4sC,WAAU,KAAW,KAEtD3sC,KAAKmtC,aAAc,IAI3BS,aAAc,WACV,OAAO5tC,KAAKC,QAAQmP,IAAIpP,KAAK+sC,OAAOr0B,KAAK,KAAKtJ,OAGlD++B,aAAc,SAAU7U,EAAOgT,GAE3B,IADA,IAAIjnB,EAAMrlB,KAAK3C,QAAQkvC,KAAKrnC,OACnBpE,EAAIw4B,EAAOx4B,EAAIwrC,GAAOxrC,EAAIukB,EAAKvkB,IAChCd,KAAKgtC,MAAMlsC,KACXd,KAAK+sC,OAAOjsC,GAAKd,KAAK3C,QAAQmvC,cAI1CmC,UAAW,SAAUrqB,GAEjB,IADA,IAAIe,EAAMrlB,KAAK3C,QAAQkvC,KAAKrnC,SACnBof,GAAOe,IAAQrlB,KAAKgtC,MAAM1oB,KACnC,OAAOA,GAGXsqB,QAAS,SAAUtqB,GAEf,IADA,IAAIe,EAAMrlB,KAAK3C,QAAQkvC,KAAKrnC,OACnBpE,EAAIwjB,EAAKjJ,EAAIrb,KAAK3C,QAAQmvC,YAAa1rC,EAAIukB,EAAKvkB,IACrD,GAAId,KAAKgtC,MAAMlsC,GAAI,CACf,IAAIwB,EAAItC,KAAK2uC,UAAU7tC,GACnBkX,EAAIhY,KAAK+sC,OAAOjsC,GAEpB,GADAd,KAAK+sC,OAAOjsC,GAAKua,IACb/Y,EAAI+iB,GAAOrlB,KAAKgtC,MAAM1qC,GAAG4P,KAAK8F,IAI9B,MAHAqD,EAAIrD,IASpBo2B,QAAS,SAAU9pB,EAAKpf,GAEpB,MAAQlF,KAAKgtC,MAAM1oB,MAAUA,GAAO,IAMpC,IAJA,IAAIyqB,EAAczqB,EAC3Be,EAAMrlB,KAAK3C,QAAQkvC,KAAKrnC,OACxBsnC,EAAcxsC,KAAK3C,QAAQmvC,YAET1rC,EAAIwjB,EAAKxjB,EAAIukB,IAAQvkB,GAAK,GAAKoE,EAAS,GAAIpE,IACjD,GAAId,KAAKgtC,MAAMlsC,GAAI,CACfd,KAAK+sC,OAAOjsC,GAAK0rC,EACjB,IAAIlqC,EAAItC,KAAK2uC,UAAU7tC,GACvB,GAAIwB,EAAI+iB,GAAOrlB,KAAKgtC,MAAMlsC,GAAGoR,KAAKlS,KAAK+sC,OAAOzqC,IAI1C,IAHAtC,KAAK+sC,OAAOzoB,GAAOtkB,KAAK+sC,OAAOzqC,GAC/BtC,KAAK+sC,OAAOzqC,GAAKkqC,EACjBloB,KACQtkB,KAAKgtC,MAAM1oB,IAAMA,IAIrCtkB,KAAK4tC,eACL5tC,KAAKosC,MAAMhlC,KAAK2D,IAAI/K,KAAKwtC,gBAAiBuB,KAG9CpC,UAAW,SAAUqC,GAOjB,IALA,IAAIzgB,EAAQvuB,KAAKC,QAC1BiS,EAAOqc,EAAMnf,MACbiW,EAAMrlB,KAAK3C,QAAQkvC,KAAKrnC,OACxB+pC,GAAa,EAEKnuC,EAAI,EAAGwjB,EAAM,EAAGxjB,EAAIukB,EAAKvkB,IAC9B,GAAId,KAAKgtC,MAAMlsC,GAAI,CAEf,IADAd,KAAK+sC,OAAOjsC,GAAKd,KAAK3C,QAAQmvC,YACvBloB,IAAQpS,EAAKhN,QAAQ,CACxB,IAAImW,EAAInJ,EAAKgK,OAAOoI,EAAM,GAC1B,GAAItkB,KAAKgtC,MAAMlsC,GAAGoR,KAAKmJ,GAAI,CACvBrb,KAAK+sC,OAAOjsC,GAAKua,EACjB4zB,EAAYnuC,EACZ,OAGR,GAAIwjB,EAAMpS,EAAKhN,OACX,WAEClF,KAAK+sC,OAAOjsC,IAAMoR,EAAKoS,IAAQxjB,GAAKd,KAAKutC,kBAC9CjpB,IACA2qB,EAAYnuC,GAgBpB,OAbKkuC,GAASC,EAAY,EAAIjvC,KAAKutC,gBAC1BvtC,KAAK3C,QAAQuvC,eAAkB5sC,KAAK4D,QAAQsB,OAKxCqpB,EAAMnrB,GAAG,WAAWpD,KAAK4tC,gBAJ9Brf,EAAMnf,IAAI,IACVpP,KAAKmuC,aAAa,EAAG9oB,KAMpB2pB,GAASC,EAAY,GAAKjvC,KAAKutC,mBACpCvtC,KAAK4tC,eACAoB,GAAOzgB,EAAMnf,IAAImf,EAAMnf,MAAMoP,UAAU,EAAGywB,EAAY,KAEvDjvC,KAAKutC,gBAAkBzsC,EAAId,KAAKwtC,iBAG5CJ,YAAa,WAKT,IAJA,IAAIb,EAAOvsC,KAAK3C,QAAQkvC,KACjC2C,KACAC,KAEkBruC,EAAI,EAAGA,EAAIyrC,EAAKrnC,OAAQpE,IAAK,CAClC,IAAIua,EAAGU,EAAOwwB,EAAKzrC,IAAMyrC,EAAKrwB,OAAOpb,GACzB,MAARib,GAA+B,MAAfwwB,EAAKzrC,EAAI,KACN,MAAfyrC,EAAKzrC,EAAI,IACTua,EAAI,KACJ8zB,EAAaD,EAAShqC,QAAU6W,GAGhCV,EAAIU,EAERmzB,EAASA,EAAShqC,QAAUmW,GAIpCrb,KAAK3C,QAAQkvC,KAAO2C,EAASx2B,KAAK,IAElC,IAAS5X,EAAI,EAAGA,EAAIouC,EAAShqC,OAAQpE,SACToH,IAApBinC,EAAaruC,KACbouC,EAASpuC,GAAKquC,EAAaruC,IAInCd,KAAKytC,YAAcyB,EAASx2B,KAAK,OAKzCvb,EAAEsJ,OAAOtJ,EAAEoP,GAAGggC,MACVhuB,QAAS,WACT6wB,OAAQ,kBACRC,UACI9C,KAAM,GACNC,YAAa,IACbsC,UAAW,KACXlC,eAAe,GAEnBU,aACIgC,IAAK,QACLngC,EAAK,WACLogC,IAAK,eAETnD,MAAO,SAAUnsC,EAASosC,EAAOC,GAC7B,IAAI/d,EAAQtuB,EAAQ,GACpB,GAAoB,iBAATosC,EAAmB,CAE1B,GADAC,EAAqB,iBAAPA,EAAmBA,EAAMD,EACnC9d,EAAM6Y,kBACN7Y,EAAM8Y,QACN9Y,EAAM6Y,kBAAkBiF,EAAOC,QAC5B,GAAI/d,EAAM+Y,gBAAiB,EAC1BC,EAAQhZ,EAAM+Y,mBACZ3pC,UAAS,GACf4pC,EAAMC,QAAQ,YAAa8E,GAC3B/E,EAAME,UAAU,YAAa4E,GAC7B9E,EAAMG,SAEV,OAAOznC,EAEP,GAAIsuB,EAAM6Y,kBACNiF,EAAQ9d,EAAM0Z,eACdqE,EAAM/d,EAAMihB,kBAEX,GAAIr+B,SAAS22B,WAAa32B,SAAS22B,UAAUE,YAAa,CAC3D,IAAIT,EAEJ+E,GADAD,EAAQ,GADJ9E,EAAQp2B,SAAS22B,UAAUE,eACbyH,YAAYhI,UAAU,aAAc,MACxCF,EAAMp1B,KAAKjN,OAE7B,OAASmnC,MAAOA,EAAOC,IAAKA,MA1Y5C,CA+YGhgC,QClYHA,OAAOU,GAAG0iC,QAAU,SAAUC,EAAS1jC,GAkFnC,OAjFA0jC,EAAUA,GAAW,IACrB1jC,EAA8B,mBAAZA,EAAyBA,EAAW,aACtDjM,KAAK4vC,SACP,SAAU3hC,GACN,IAAIlN,EAAMkN,EAAEqgC,SAAWrgC,EAAEqgC,SAAWrgC,EAAE6/B,QAAU7/B,EAAE6/B,QAAU,EAE5D,GAAW,IAAP/sC,GAA4C,SAA/Bf,KAAK6vC,SAASp/B,cAC3B,OAAO,EAEN,GAAW,IAAP1P,EACL,OAAO,EAEX,IAAIiuC,GAAQ,EAEZ,GAAK/gC,EAAEugC,SAAkB,IAAPztC,GAA6BkN,EAAEugC,SAAkB,IAAPztC,EAAwB,OAAO,EAE3F,GAAKkN,EAAEugC,SAAkB,KAAPztC,GAA8BkN,EAAEugC,SAAkB,IAAPztC,EAAwB,OAAO,EAE5F,GAAKkN,EAAEugC,SAAkB,IAAPztC,GAA6BkN,EAAEugC,SAAkB,IAAPztC,EAAwB,OAAO,EAE3F,GAAKkN,EAAEugC,SAAkB,KAAPztC,GAA8BkN,EAAEugC,SAAkB,IAAPztC,EAAwB,OAAO,EAE5F,GAAKkN,EAAEugC,SAAkB,KAAPztC,GAA8BkN,EAAEugC,SAAkB,IAAPztC,GAC5DkN,EAAE6hC,UAAmB,IAAP/uC,EAAY,OAAO,EAElC,GAAIA,EAAM,IAAMA,EAAM,GAAI,CAEtB,GAAW,IAAPA,GAAkC,GAArBf,KAAK4D,MAAMsB,OAAa,OAAO,EAE5CnE,GAAO4uC,EAAQrgC,WAAW,KAAsC,GAAhCtP,KAAK4D,MAAMsG,QAAQylC,KACnDX,GAAQ,GAIV,GAAPjuC,GACO,GAAPA,GACO,IAAPA,GACO,IAAPA,GACO,IAAPA,GACO,IAAPA,GACO,IAAPA,GACO,IAAPA,EAESiuC,GAAQ,OAKiB,IAAd/gC,EAAEqgC,WAELrgC,EAAE6/B,SAAW7/B,EAAEsgC,OAAoB,GAAXtgC,EAAEsgC,MAC1BS,GAAQ,EAGU,GAAb/gC,EAAE6/B,SAA8B,GAAd7/B,EAAEqgC,UAA4B,GAAXrgC,EAAEsgC,QAC5CS,GAAQ,IAKhBjuC,GAAO4uC,EAAQrgC,WAAW,KAAsC,GAAhCtP,KAAK4D,MAAMsG,QAAQylC,KACnDX,GAAQ,QAIZA,GAAQ,EAEZ,OAAOA,IAGXe,KACA,WACI,IAAI3gC,EAAM9C,OAAOtM,MAAMoP,MACZ,IAAPA,IACS,IAAIX,OAAO,cAAgBkhC,EAAU,QACtC3wB,KAAK5P,IACTnD,EAASmC,MAAMpO,SAKlBA,MAGXsM,OAAOU,GAAGgjC,UAAY,SAAUL,EAAS1Q,GACrC0Q,EAAUA,GAAW,IACrB1Q,EAAMA,GAAO,IAgGb,OA7FAhzB,SAA8B,mBAAZA,SAAyBA,SAAW,aACtDjM,KAAK4vC,SACD,SAAU3hC,GACN,IAAIlN,EAAMkN,EAAEqgC,SAAWrgC,EAAEqgC,SAAWrgC,EAAE6/B,QAAU7/B,EAAE6/B,QAAU,EAE5D,GAAW,IAAP/sC,GAA4C,SAA/Bf,KAAK6vC,SAASp/B,cAC3B,OAAO,EAEN,GAAW,IAAP1P,EACL,OAAO,EAEX,IAAIiuC,GAAQ,EAEZ,SAAK/gC,EAAEugC,SAAkB,IAAPztC,GAA6BkN,EAAEugC,SAAkB,IAAPztC,QAEvDkN,EAAEugC,SAAkB,KAAPztC,GAA8BkN,EAAEugC,SAAkB,IAAPztC,QAExDkN,EAAEugC,SAAkB,IAAPztC,GAA6BkN,EAAEugC,SAAkB,IAAPztC,QAEvDkN,EAAEugC,SAAkB,KAAPztC,GAA8BkN,EAAEugC,SAAkB,IAAPztC,QAExDkN,EAAEugC,SAAkB,KAAPztC,GAA8BkN,EAAEugC,SAAkB,IAAPztC,GACrDkN,EAAE6hC,UAAmB,IAAP/uC,KAElBA,EAAM,IAAMA,EAAM,IAGdA,GAAO4uC,EAAQrgC,WAAW,KAAsC,GAAhCtP,KAAK4D,MAAMsG,QAAQylC,KACnDX,GAAQ,GAGRjuC,GAAOk+B,EAAI3vB,WAAW,KAAkC,GAA5BtP,KAAK4D,MAAMsG,QAAQ+0B,KAC/C+P,GAAQ,GAMD,GAAPjuC,GACO,GAAPA,GACO,IAAPA,GACO,IAAPA,GACO,IAAPA,GACO,IAAPA,GACO,IAAPA,EAEAiuC,GAAQ,OAKiB,IAAd/gC,EAAEqgC,WAELrgC,EAAE6/B,SAAW7/B,EAAEsgC,OAAoB,GAAXtgC,EAAEsgC,MAC1BS,GAAQ,EAGU,GAAb/gC,EAAE6/B,SAA8B,GAAd7/B,EAAEqgC,UAA4B,GAAXrgC,EAAEsgC,QAC5CS,GAAQ,IAKhBjuC,GAAOk+B,EAAI3vB,WAAW,KAAkC,GAA5BtP,KAAK4D,MAAMsG,QAAQ+0B,KAC/C+P,GAAQ,GAGRjuC,GAAO4uC,EAAQrgC,WAAW,KAAsC,GAAhCtP,KAAK4D,MAAMsG,QAAQylC,KACnDX,GAAQ,GAIRjuC,GAzEJ,IAyEiBuO,WAAW,IAAMvO,GA1EnC,IA0E+CuO,WAAW,KACrD0/B,GAAQ,IAIZA,GAAQ,EAELA,SAGVe,KACD,WACI,IAAI3gC,EAAM9C,OAAOtM,MAAMoP,MACZ,IAAPA,IACS,IAAIX,OAAO,cAAgBkhC,EAAU,QACtC3wB,KAAK5P,IACTnD,SAASmC,MAAMpO,SAKxBA,MCnMX,SAAW7C,GAoMP,SAAS8yC,EAAmBC,GACxB,IAAIC,EAAahzC,EAAE40B,eAAeqe,QAAQF,GAC1C,GAAIC,EACA,OAAOA,EAGP,GAAI,eAAej+B,KAAKg+B,GAAS,CAC7B,IAAIG,EAAUH,EAAOvrC,QAAQ,eAAgB,MAC7C,OAAOxH,EAAE40B,eAAeqe,QAAQC,GAIxC,OAAO,KAcX,SAASC,EAAcC,GACnB,GAAwB,KAApBA,EAAS5f,OACT,OAAO,IAAIliB,OAAO,QAAU8hC,EAASlgB,cAAgB,KAAM,KAG3D,IAAIM,EAAS4f,EAAS5f,OAAOhsB,QAAQ,IAAK,OAAOA,QAAQ,IAAK,OAC9D,OAAO,IAAI8J,OAAOkiB,EAAS,SAAW4f,EAASlgB,cAAgB,KAAM,KAlO7ElzB,EAAE40B,kBAEF50B,EAAE40B,eAAeqe,WAGjBjzC,EAAE40B,eAAeqe,QAAQ,KACrBzf,OAAQ,IACRI,eAAgB,OAChBD,eAAgB,SAChBT,cAAe,IACfE,iBAAkB,IAClBM,aAAa,GAGjB1zB,EAAE6P,GAAG+kB,eAAiB,SAAUye,EAAaD,GAEjB,GAApBliC,UAAUnJ,QAAsC,iBAAhBsrC,IAChCD,EAAWC,EACXA,GAAc,GAIlB,IAAInB,GACApuC,KAAM,iBACN2vB,UAAU,EACVsf,OAAQ,GACRO,QAAQ,EACRhgB,oBAAqB,EACrBigB,wBAAwB,GAa5B,OAVArB,EAAWlyC,EAAEsJ,OAAO4oC,EAAUlyC,EAAE40B,eAAeqe,QAAQ,MAEvDG,EAAWpzC,EAAEsJ,OAAO4oC,EAAUkB,IAGjBL,OAAOhrC,OAAS,IACzBqrC,EAAWpzC,EAAEsJ,OAAO8pC,EAAUN,EAAmBM,EAASL,UAE9DK,EAASI,MAAQL,EAAcC,GAExBvwC,KAAKa,KAAK,WACb,IAAIg8B,EAAQ1/B,EAAE6C,MAGV4wC,EAAM,IACNC,EAAmB,IAAIpiC,OAAO,YAAY,KAW9C,IAVAmiC,EAAM/T,EAAMA,EAAMz5B,GAAG,2BAA6B,MAAQ,WAGlD0tC,OAAO,QAAU,IACrBF,EAAM,IAAMA,GAIXA,EAAI9yB,MAAM,YAAY8yB,EAAMA,EAAIjsC,QAAQksC,EAAkB,IAEnD,KAARD,IAAuB,MAARA,IAAiD,IAAlCL,EAAS9f,qBAA3C,CAKA,GAAIhU,MAAMm0B,GAAM,CAIZ,GAAY,MAFZA,EAAMA,EAAIjsC,QAAQ4rC,EAASI,MAAO,MAEP,MAARC,IAAiD,IAAlCL,EAAS9f,oBACvC,OAG0B,KAA1B8f,EAASlgB,gBACTugB,EAAMA,EAAIjsC,QAAQ4rC,EAASlgB,cAAe,MAE1C5T,MAAMm0B,KACNA,EAAM,KAKd,IAAIG,EAAWvhC,OAAOohC,GAAKxvC,MAAM,KAC7B4vC,EAAcJ,GAAOxpC,KAAKoT,IAAIo2B,GAC9BK,EAAeF,EAAS7rC,OAAS,EACjCgsC,EAAYD,EAAcF,EAAS,GAAGjgC,WAAa,IACnDqgC,EAAmBD,EAevB,GAZAN,EAAMxpC,KAAKoT,IAAIu2B,EAAS,IACxBH,EAAMn0B,MAAMm0B,GAAO,EAAIA,EACnBL,EAAS9f,qBAAuB,IAGA,MADhCygB,GADAA,EAAW9wB,WAAW,KAAO8wB,IACTxe,QAAQ6d,EAAS9f,sBACxBjS,UAAU,EAAG,KACtBoyB,EAAM/mC,OAAO+mC,GAAO,GAExBM,EAAWA,EAAS1yB,UAAU,IAElCoyB,EAAMphC,OAAOohC,GAETL,EAAS1f,YACT,IAAK,IAAI/vB,EAAI,EAAGA,EAAIsG,KAAKC,OAAOupC,EAAI1rC,QAAU,EAAIpE,IAAM,GAAIA,IACxD8vC,EAAMA,EAAIpyB,UAAU,EAAGoyB,EAAI1rC,QAAU,EAAIpE,EAAI,IAAMyvC,EAAShgB,iBAAmBqgB,EAAIpyB,UAAUoyB,EAAI1rC,QAAU,EAAIpE,EAAI,KAItHmwC,IAAgD,GAAjCV,EAAS9f,qBAA8B8f,EAAS9f,oBAAsB,KACtFmgB,GAAOL,EAASlgB,cAAgB6gB,GAIpC,IACIE,GADSJ,EAAaT,EAASxf,eAAiBwf,EAASzf,gBAC1CnsB,QAAQ,MAAO4rC,EAAS5f,QAC3CygB,EAAQA,EAAMzsC,QAAQ,MAAOisC,GAG7B,IAAIS,EAAel0C,OAIfk0C,EAHCb,EAGcrzC,EAAEqzC,GAFF3T,GAKNwU,EAAajuC,GAAG,2BAA6B,MAAQ,QAAQguC,GAGlFH,GACAV,EAASG,wBACTS,EAAiBjsC,OAASqrC,EAAS9f,qBAEvB4gB,EAAapsC,QAAQ,kBAAmBksC,GAIxCZ,EAAS3f,UACTygB,EAAa3sC,IAAI,QAASssC,EAAa,QAAU,WAM7D7zC,EAAE6P,GAAGskC,SAAW,SAAUf,GACtB,IAAIlB,EAAWlyC,EAAEsJ,QACbxF,KAAM,WACNivC,OAAQ,GACRO,QAAQ,GACTtzC,EAAE40B,eAAeqe,QAAQ,KAQ5B,OANAG,EAAWjkC,OAAO7F,OAAO4oC,EAAUkB,IACtBL,OAAOhrC,OAAS,IACzBqrC,EAAWpzC,EAAEsJ,OAAO8pC,EAAUN,EAAmBM,EAASL,UAE9DK,EAASI,MAAQL,EAAcC,GAExBvwC,KAAKa,KAAK,WACb,IAAI0wC,EAASp0C,EAAE6C,MAAMoD,GAAG,2BAA6B,MAAQ,OAC7DjG,EAAE6C,MAAMuxC,GAAQp0C,EAAE6C,MAAMuxC,KAAU5sC,QAAQ,IAAK,MAAMA,QAAQ4rC,EAASI,MAAO,QAKrFxzC,EAAE6P,GAAGwkC,SAAW,SAAUjB,GACtB,IAAIlB,EAAWlyC,EAAEsJ,QACbxF,KAAM,WACNivC,OAAQ,GACRv3B,OAAO,EACP84B,UAAW,QACXhB,QAAQ,GACTtzC,EAAE40B,eAAeqe,QAAQ,MAC5BG,EAAWjkC,OAAO7F,OAAO4oC,EAAUkB,IACtBL,OAAOhrC,OAAS,IACzBqrC,EAAWpzC,EAAEsJ,OAAO8pC,EAAUN,EAAmBM,EAASL,UAE9DK,EAASI,MAAQL,EAAcC,GAC/BA,EAASkB,UAqCb,SAA2BA,GACvB,OAAQA,EAAUhhC,eACd,IAAK,MACD,MAAO,MACX,IAAK,QACD,MAAO,QACX,QACI,KAAM,qBA5COihC,CAAkBnB,EAASkB,WAEhD,IAAIF,EAASp0C,EAAE6C,MAAMoD,GAAG,2BAA6B,MAAQ,OACzDwtC,EAAMzzC,EAAE6C,MAAMuxC,KAIlB,OADAX,GADAA,GADAA,EAAMA,GAAY,IACRjsC,QAAQ,IAAK,OACbA,QAAQ4rC,EAASI,MAAO,IAC7BJ,EAAS53B,OAII,GAAdi4B,EAAI1rC,SACJ0rC,EAAM,KAGoB,KAA1BL,EAASlgB,gBACTugB,EAAMA,EAAIjsC,QAAQ4rC,EAASlgB,cAAe,MAGvChS,OAAO,QAAUkyB,EAASkB,WAAWb,IAXjCA,GAtLnB,CAwOGtkC,QCvPH,SAAW6C,GACP,SAASsJ,EAAErB,EAAGiE,GAC4J,SAAStC,EAAE3B,GAAKnJ,EAAIkB,EAAE,UAAWiI,GAAGu6B,GAAG,GAAGxwC,QAASma,EAAInM,EAAE,UAAWiI,GAAGu6B,IAAI,GAAGxwC,QAAS0Z,EAAI/Z,EAAEgiB,OAAQ8uB,EAAI96B,EAA6H,SAASD,IAAMC,EAAEiF,KAAO81B,GAAK,OAAS/6B,EAAE1H,KAAO0H,EAAE1H,KAAOgI,EAAEhI,OAAS,OAAS0H,EAAEg7B,OAAShxC,EAAEqoC,WAAW/xB,EAAEhI,MAAQgI,EAAEhI,MAAQ,GAAI0H,GAAKA,EAAEg7B,OAAO5iC,MAAM,GAAI4H,EAAEi7B,UAAS,GAC3iB,SAAS/2B,EAAE5D,EAAGiE,EAAGpN,EAAG8K,EAAG8B,GAAK/Z,EAAEkxC,SAAS9lC,KAAKgP,EAAGH,EAAG9M,GAAIkB,EAAE,UAAW4L,GAAGla,KAAK,SAAUkY,GAAK,IAAIjY,EAAIqO,EAAEnP,MAAoEoY,EAA7DkD,EAAInM,EAAE,gBAAkB2H,EAAEiF,KAAKhD,GAAK,KAAMjY,GAA0Bwa,EAAtBxa,EAAIwa,EAAEna,QAAuB,IAAKiX,EAAE65B,SAAS,QAAS,CAAE,IAAK,IAAI56B,EAAIe,EAAG0C,EAAI,EAAGxY,EAAI,EAAG+U,EAAE66B,OAAOhtC,SAAWmS,EAAE46B,SAAS,SAAW56B,EAAIA,EAAE66B,OAAQp3B,IAAK,KAAO1C,EAAEy2B,OAAO3pC,SAAWkT,EAAE65B,SAAS,SAAW75B,EAAIA,EAAEy2B,OAAQvsC,IAAKA,EAAIwY,GAAKxY,GAAK,IAAMuY,IAAMC,IAAMzD,EAAE46B,SAAS,SAAW,GAAKp3B,EAAIS,GAAKhZ,GAAK8V,EAAIf,EAAGiE,GAAKR,GAAIhE,EAAEiF,KAAKhD,GAAKX,EAAEva,KAAK,OAAaiD,GAAKwa,GAAKvC,GAAK9K,QAAK,IAAWA,GAAG6I,EAAE0zB,OAAOr7B,EAAEnP,MAAOsb,EAAGvC,GAAK9K,EAAImJ,EAAI,EAAGiE,EAAGtC,KAAOjC,EAAE+2B,OAAO90B,GAAK,SAASN,IAC7kB,IAC0EL,EAAGf,EAH9DlI,EAAmBiI,EAE9BA,EAAI,EAAGiE,EAAI,EAAGtC,EAAI5J,EAAEkP,QAAQrB,QAC5C/O,EAAIkB,EAAEkP,QAAQyE,SAAUxH,EAAInM,EAAEkP,QAAQsE,YAAa7hB,EAAIqO,EAAE,OAAQ4L,GAAIF,EAAI1L,EAAE,MAAO4L,GAAU5L,EAAE,OAAQ4L,GAAGla,KAAK,WAAcuX,EAAIjJ,EAAEnP,MAAMmyC,YAAW,GAAK/6B,GAAKgB,EAAGiD,EAAIjD,EAAIiD,EAAIjD,EAAIiD,IAAMjD,EAAIhB,EAAI2B,EAAIsC,EAAIjE,EAAGyD,EAAEmC,MAAM5E,GAAIA,EAAIyC,EAAEs3B,aAAc96B,EAAIwD,EAAEnH,cAAemH,EAAEnW,KAAM6iB,MAAOxO,EAAIX,GAAK,EAAGyK,IAAKvH,GAAKrN,EAAIoJ,GAAK,IAAMvW,EAAEgiB,OAAO,GAAGA,QAHnS3T,EAAIgC,SAAS0X,KAAMzR,EAAIjG,SAAS0d,gBAAwBznB,KAAK2D,IAAIoE,EAAE6W,aAAc7W,EAAEijC,aAAch7B,EAAEi7B,aAAcj7B,EAAE4O,aAAc5O,EAAEg7B,gBAIpJ,SAASx3B,EAAExD,GAAK,IAAIjI,GAAKiI,EAAEvZ,KAAK,OAAS,EAAGkZ,EAAEK,EAAGjI,EAAImM,EAAIrN,EAAIkB,EAAG,GAAK,SAASmnB,EAAElf,GAAK,IAAIjI,GAAKiI,EAAEvZ,KAAK,OAAS,EAAGkZ,EAAEK,EAAGjI,EAAIlB,EAAIqN,EAAInM,EAAG,GAAK,IAA+B2P,EAAwBwzB,EAAGv3B,EAAtDjE,EAAI9W,KAAMkb,EAAI9D,EAAgBtW,GAAbsW,EAAIjI,EAAE+L,GAAW/L,EAAE1I,UAAW2U,IAAUm3B,KAAQC,KAAQX,EAAIz6B,EAAEhU,GAAG,SAAUqvC,GAAI,EAAI37B,EAAE47B,OAAS,WAAc5xC,EAAE6xC,UAAW,EAAId,GAAKz6B,EAAEkzB,KAAK,YAAY,IACtTxzB,EAAE87B,QAAU,WAAc9xC,EAAE6xC,UAAW,EAAId,GAAKz6B,EAAEkzB,KAAK,YAAY,IAAOxzB,EAAE0zB,OAAS,SAAUpzB,EAAGjI,EAAGkM,EAAGtC,EAAG9K,GACvG,IAAIqN,GAAKg3B,EAAInjC,GAAKrO,EAAEgiB,OAAuK,GAA/J1L,EAAE9V,KAAK,SAAU+Z,EAAIyY,EAAI,mBAAqBzY,EAAEqX,QAAQ,GAAK,cAAgB,KAAOmgB,EAAI/e,EAAI,4BAA8BxY,EAAI,SAAW,OAASA,EAAI,QAAaD,EAAG,CAC9L,IAAIjD,EAAI,EAAGoO,cAAc+rB,EAAEtkC,IAAKskC,EAAEtkC,GAAK8Y,YAAY,WAAc3O,GAAK,GAAKhB,EAAEvZ,KAAK,MAAOuJ,KAAKmI,OAAOJ,EAAI4J,GAAK3R,KAAKqT,IAAIrC,EAAIiD,GAAKjU,KAAK0rC,GAAK,IAAM/5B,IAAKX,GAAKiD,IAAMmL,cAAc+rB,EAAEtkC,IAAKmJ,EAAEvZ,KAAK,MAAOsR,KAAO,KAAMnN,aAAawwC,EAAEvkC,IAAKukC,EAAEvkC,GAAKnM,WAAW,WAClP,SAAWhB,EAAEjB,OAASuX,EAAE66B,SAAS,QACrD76B,EAAE27B,QAAQ,SAASzvC,KAAK,SAASy6B,OAAO,SACrB,IAAM1iB,QACNjE,EAAEvZ,KAAK,MAAOsR,IACtB2H,EAAEi7B,SAAW,SAAU5iC,EAAGkM,EAAGpN,GAAK,IAAI8K,EAAIjY,EAAEkyC,aAAal8B,EAAEiF,MAAOjF,EAAE1H,IAAM2J,EAAGjC,EAAEg7B,OAASh7B,EAAEiF,KAAK7M,MAAM,GAAIujC,GAAKtjC,GAAK6L,EAAE/M,GAAIoN,GAAKw2B,GAAKz6B,EAAEhI,IAAI2J,GAAG9T,QAAQ,WAAa6R,EAAEk7B,SAAW,SAAU56B,EAAGjI,EAAGkM,EAAGtC,GAAKiC,EAAE5D,EAAGjI,EAAGkM,GAAG,EAAItC,IAAMjC,EAAE+2B,OAAS,SAAUz2B,GAAK,IAZsCA,EAASjI,EAY3CkM,EAAIva,EAAEkyC,aAAal8B,EAAEiF,MAAO,UAAYjb,EAAEmyC,QAAUn8B,EAAEi7B,UAAS,EAAI36B,GAAKjI,EAAE,OAAQ4L,GAAGxX,MAZnD6T,EAY0DiE,GAZjDlM,EAAIrO,EAAEoyC,YAAuB,mBAAqB/jC,EAAIA,EAAEjD,KAAKgP,EAAG9D,GAAKjI,EAAExK,QAAQ,WAAYyS,GAAK,KAY1CA,GAAKtW,EAAEqyC,SAASjnC,KAAKgP,EAAGG,EAAGvE,IAAMA,EAAE3R,KAAO,WACnY,IAAI,IAAOrE,EAAEkoB,QAAQ9c,KAAKgP,EAAGpE,EAAE1H,IAAK0H,GAAI,OAAO,EAAI3H,EAAE,SAASm7B,KAAK,YAAY,GAAIzkB,YAAY,QAC/FzO,EAAE24B,OAAQh1B,GAAKA,EAAEvb,SAAUizC,GAAI,EAAItjC,EAAEkP,QAAQ8I,OAAO,QACrDrQ,EAAEzR,KAAO,WACR,GAAIvE,EAAE6xC,UAAYF,EAAG,OAAO,EAAI,IAAIp3B,EAAIva,EAAEgiB,OAAQ7U,EAAInN,EAAEuB,KAAOgZ,EAAGxE,IAAK,IAAK,IAAIyE,EAAI,eAAiBxa,EAAEsyC,MAAQ,MAAQ,UAAYtyC,EAAEmyC,QAAU,8CAAgD,kEAAoEnyC,EAAEoyC,WAAa,0BAA4B,KAAMr4B,EAAI,EAAGA,EAAI/Z,EAAEuyC,OAAOnuC,OAAQ2V,IAAK,CACjV,IAChBxD,EADoBiE,EAAIA,EAAK,mBAAqB,YAAcxa,EAAEjB,KAAO,QAAU,UAAYiB,EAAEwyC,UAAY,GAAK,SAAW,uEAC1H,IAAKj8B,KAAKvW,EAAEuyC,OAAOx4B,GAAI,CACN,IAA6YC,EAAzYQ,EAAIA,EAAK,+BAAiC,YAAcxa,EAAEjB,KAAO,yCAA2Cwb,EAAI,kBAAoBA,EAAI,kEAAoEA,EAAI,kBAAoBA,EAAI,kCAAoC,IAAM,oBAAsBhE,EAAI,6CAA+CpJ,EAAI,gBAAkBnN,EAAEkc,MAAQ,YAAiB,IAAKlC,KAAKha,EAAEuyC,OAAOx4B,GAAGxD,GAAIiE,GAAK,8BAAgCR,EAAI,mBAAqBO,EAAI,kBAAoBA,EAAI,QAAUva,EAAEuyC,OAAOx4B,GAAGxD,GAAGyD,GACjjB,QAASQ,GAAK,0EACIA,GAAK,4BACTA,IAAM,UAAYxa,EAAEmyC,QAAU,sEAAwEnyC,EAAEyyC,QAAU,+DAAiEzyC,EAAE0yC,WAAa,oBAAsB,4BAA8B,qBAAsBz4B,EAAI5L,EAAEmM,GAAIN,IAAK,UAAYla,EAAEmyC,QAAUl4B,EAAE7W,SAAS,QAAUkT,EAAEhU,GAAG,OAASgU,EAAE7T,KAAKwX,GAAKA,EAAE04B,YAAYr8B,GAAIq7B,GAAI,EAAI3zB,EAAEtH,KAAKuD,EAAGjE,GAAI,UAAYhW,EAAEmyC,UAAY9jC,EAAE,WACpb4L,GAAG0O,MAAM,WAA0E,OAA5D3S,EAAEi7B,UAAS,GAAI,GAAKj7B,EAAE3R,OAAQrE,EAAE4yC,SAASxnC,KAAKgP,EAAGpE,EAAE1H,IAAK0H,IAAW,IAAO3H,EAAE,WAAY4L,GAAG0O,MAAM,WAAsD,OAAxC3S,EAAE3R,OAAQrE,EAAEgpB,SAAS5d,KAAKgP,EAAGpE,EAAE1H,IAAK0H,IAAW,IAAO3H,EAAE,gBAAgBtO,KAAK,WAAcsO,EAAEnP,MAAMsqC,KAAK,aAAen7B,EAAEnP,MAAMqB,SAAS,UAAY8N,EAAE,gBAAgBm7B,KAAK,YAAY,GAAK7xB,IAAKtJ,EAAEkP,QAAQrZ,KAAK,YAAayT,IAAKsC,EAAE44B,SAAS,QAAS,4BAA6B,SAAUv8B,GAC/Z,IAAKtW,EAAE8yC,SAAU,CACbx8B,EAAEy8B,iBAA2Cz8B,GAArBA,EAAIA,EAAE08B,eAAqBC,WAAa38B,EAAE28B,WAAa,IAAM38B,EAAE48B,QAAU58B,EAAE48B,OAAS,EAAI,EAA5F,IAA+F34B,EAAIlM,EAAE,KACjInP,MAAOsb,GAAKD,EAAExd,KAAK,OAAQyd,EAAIlU,KAAKmI,MAAM+L,EAAIlE,GAAI2B,EAAEsC,GAAItE,EAAEsE,EAAGC,EAAGlE,EAAI,EAAI,EAAI,MAEzEu8B,SAAS,cAAeM,EAAG,WAAc9kC,EAAEnP,MAAMqB,SAAS,WAAYsyC,SAAS,QAASM,EAAG,SAAU78B,GAAK,IAAKtW,EAAE8yC,SAAU,CAAEx8B,EAAEy8B,iBAAkBz8B,EAAE88B,kBAAmB,IAAI74B,EAAIlM,EAAEnP,MAAM+yC,QAAQ,SAASzvC,KAAK,MAAOkjC,KAAOr3B,EAAEnP,MAAMiyC,SAAS,SAAWr3B,EAAI0b,EAAGvd,EAAEsC,GAAImL,cAAcpO,GAAIA,EAAI2O,YAAY,WAAcyf,KAAKnrB,IAAMva,EAAEu4B,OAAQmN,KAAKnrB,MAAQs4B,SAAS,QAASM,EAAG,SAAU78B,GAC9WF,GAAe,aAAVpW,EAAEjB,MAAwBiB,EAAE8yC,WAClCx8B,EAAEy8B,iBAAkB38B,GAAI,EAAMN,EAAIzH,EAAE,KAAMnP,MAAMqB,SAAS,OACjE,SADyEP,EAAEjB,MAChEsP,EAAE,QAASnP,MAAMi+B,QAAQ,QAAS3lB,GAAK1B,EAAE/Y,KAAK,OAAQkb,EAAEnC,GAAIoB,EAAIm8B,EAAE/8B,GAAI6D,EAAI,IAAIhI,KAAM2E,EAAII,EAAGlB,EAAE0zB,OAAO5zB,EAAG0B,MAE9GxX,EAAEszC,OAAOloC,KAAKgP,EAAGH,EAAGjE,IACbA,EAAEU,KAAO,SAAU6D,GAClByD,EAAI3P,EAAE1I,QAAS4oC,YAAc73B,KAAMP,GAAK9H,EAAEklC,SAASC,OAAOj5B,EAAE+3B,MAAQ/3B,EAAE+3B,MAAQtyC,EAAEsyC,QAASjkC,EAAE1I,OAAO3F,EAAGge,EAAEuwB,SAAUh0B,GAAIvE,EAAEy5B,SAAWzvC,EAAGwxC,EAAIlrC,KAAKC,MAAMvG,EAAEuB,KAAO,GAAI,IAAIiZ,EAAInM,EAAEklC,SAASE,QAAQzzC,EAAE0zC,QAASp9B,EAAE+P,OAAO,OAAQ7L,IAAMA,EAAIA,EAAEpP,KAAKgP,EAAGpE,GAAI3H,EAAE1I,OAAO3F,EAAGwa,EAAGD,GAAIlM,EAAE1I,OAAO0U,EAAGG,EAAEm5B,eAAW,IAAWr9B,EAAEvZ,KAAK,UAAYqd,EAAEw5B,SAAWr9B,EAAED,EAAEvZ,KAAK,UAAW40C,GAAK37B,EAAE3R,OAAQ,UAAYrE,EAAEmyC,QAAUn8B,EAAEzR,QAAUwR,IAAKg7B,GAAK/wC,EAAE6zC,cACrav9B,EAAEvZ,KAAK,OAAQqd,EAAEw5B,UAAWx5B,EAAEw5B,UAAW,EAAIt9B,EAAEpS,KAAK,WAAY8R,EAAEzR,SACxDyR,EAAEg7B,OAAS,KAAMh7B,EAAE1H,IAAM,KAAM0H,EAAEiF,KAAO,KAAMjF,EAAEU,KAAK6D,GAC1D,SAAST,EAAExD,GAAK,IAAK,IAAIjI,KAAKiI,EAAG,QAAI,IAAW4D,EAAE5D,EAAEjI,IAAK,OAAO,EAAI,OAAO,EAAK,SAASglC,EAAE/8B,GAAK,OAAOkf,EAAIlf,EAAE08B,cAAgB18B,EAAE08B,cAAcc,eAAe,GAAGjuB,MAAQvP,EAAEw9B,eAAe,GAAGjuB,MAAQvP,EAAEuP,MAAQ,SAAStP,EAAED,GAAK,OAAO,IAAOA,GAAK,QAAUA,EAAI,SAASL,EAAEK,EAAGiE,EAAGjD,EAAGW,EAAG8B,GACnR,IAAIxD,EAAID,EAAE27B,QAAQ,SAASzvC,KAAK,MAAMnC,MAAMiW,GAAuBiE,GAAnBA,EAAIA,EAAIC,EAAIA,EAAID,GAAWpN,EAAIA,EAAIoN,EAAGjE,EAAIjI,EAAE,KAAMiI,GAAGu6B,GAAGt2B,GAAIu2B,EAAE71B,KAAK1E,GAAKD,EAAEvZ,KAAK,OAAQ+zC,EAAEI,SAASj5B,EAAIsC,GAAKR,EAAI,GAAMzT,KAAKoT,IAAI,IAAOa,EAC7LR,IAAM,EAAGA,EAAGxD,EAAGe,GACT,IAAYA,EAAwByC,EAAG5M,EAAGqN,EAAGs2B,EAA+C55B,EAAGJ,EAAGqD,EAAG3C,EAAjGhW,KAAW2U,EAAI,aAA6BJ,GAAI,IAAK5D,MAAMC,UAAWgE,GAAI,EAAIN,EAAI,KAAkBoE,EAAI7J,SAAS2d,cAAc9T,GAAG5I,MAAOygC,EAAIj4B,GAAG,sBAAuB,oBAAqB,iBAAkB,eAAgB,mBAAqB,sBAAuBzJ,SAAS0d,gBAAgBzc,MAAO0hB,EAAI,WAAc,IAAsC3kB,EAAlCiI,GAAK,SAAU,MAAO,IAAK,MAAU,IAAKjI,KAAKiI,EAAG,GAAIwD,GAAGxD,EAAEjI,GAAK,cAAe,MAAO,IAAMiI,EAAEjI,GAAGsB,cAAe,MAAO,GAAzI,GAAkJ6lB,EAAI,iBAAkBjY,OAAQ41B,EAAI3d,EAAI,aAAe,YAAaue,EAAIve,EAAI,WAAa,UAAWlb,GAAM4B,MAAO,GAAI8F,OAAQ,GAC7jBzgB,KAAM,EAAGg3B,MAAO,IAAKsZ,UAAU,EAAIiB,UAAU,EAAIe,aAAa,EAAIrB,WAAW,EAAID,UAAYD,MAAO,GAAIF,WAAY,UAAWD,QAAS,QAASpzC,KAAM,WAAY20C,OAAQ,GAAIjB,QAAS,MAAOC,WAAY,SAAUY,OAAQn9B,EAAG+R,QAAS/R,EAAGy8B,SAAUz8B,EAAG6S,SAAU7S,EAAGk8B,SAAUl8B,EAAG+7B,aAAc,SAAU57B,GAAK,IAAK,IAAIjI,EAAI,GAAImM,EAAI,EAAGA,EAAIlE,EAAElS,OAAQoW,IAAKnM,IAAM,EAAImM,EAAI,IAAM,IAAMlE,EAAEkE,GAAI,OAAOnM,GAAKg6B,WAAY,SAAU/xB,EAAGjI,GAC5Z,IAAK,IAAImM,EAAInM,EAAEohC,SAAS8C,OAA0BplC,GAAlBmJ,EAAIA,EAAEhW,MAAM,SAAcyZ,EAAI,EAAGzC,EAAI,EAAGA,EAAIkD,EAAEpW,OAAQkT,IAAK,IAAK,IAAIf,KAAKiE,EAAElD,GAAI,CAC3G,QAAI,IAAWkD,EAAElD,GAAGf,GAAGD,EAAEyD,IAAK5M,EAAErF,KAAKwO,EAAEyD,SAAU,IAAK,IAAIvY,KAAKgZ,EAAElD,GAAGf,GAAI,CACpEpJ,EAAErF,KAAKtG,GACP,MACFuY,IACJ,OAAO5M,GACV+jC,SAAU/6B,GACdkE,GAAM3D,KAAM,SAAUJ,GAA+B,YAA1B,IAAWA,IAAMA,MAAgBpX,KAAKa,KAAK,WAAcb,KAAK1C,KAAOuZ,GAAK,EAAG7W,KAAK1C,GAAK,UAAYuZ,GAAIvU,EAAEtC,KAAK1C,IAAM,IAAImb,EAAEzY,KAAMoX,MAASs7B,OAAQ,WAAc,OAAO1yC,KAAKa,KAAK,WAAc,IAAIuW,EAAI9U,EAAEtC,KAAK1C,IAAK8Z,GAAKA,EAAEs7B,YAAeE,QAAS,WAAc,OAAO5yC,KAAKa,KAAK,WAAc,IAAIuW,EAAI9U,EAAEtC,KAAK1C,IAAK8Z,GAAKA,EAAEw7B,aAAgBkC,WAAY,WAAc,IAAI19B,EAAI9U,EAAEtC,KAAK,GAAG1C,IAAK,GAAI8Z,EAAG,OAAOA,EAAEm5B,SAASoC,UAAY/V,OAAQ,SAAUxlB,EAAGjI,GAC9c,OAAOnP,KAAKa,KAAK,WACb,IAAIya,EAAIhZ,EAAEtC,KAAK1C,IAAK,GAAIge,EAAG,CACvB,IAAIrN,KAAQ,iBAAoBmJ,EAChDnJ,EAAImJ,EAAInJ,EAAEmJ,GAAKjI,EAAGmM,EAAE9D,KAAKvJ,OAGlB8jC,SAAU,SAAU36B,EAAGjI,EAAGmM,GAAK,OAAOtb,KAAKa,KAAK,WAAc,IAAIoN,EAAI3L,EAAEtC,KAAK1C,IAAK2Q,IAAMA,EAAE8N,KAAO3E,EAAGnJ,EAAE8jC,UAAS,EAAI5iC,EAAGmM,OAAUy5B,QAAS,WAAc,OAAOzyC,EAAEtC,KAAK,GAAG1C,KAAOqV,SAAU,WAAc,IAAIyE,EAAI9U,EAAEtC,KAAK,GAAG1C,IAAK,GAAI8Z,EAAG,OAAOA,EAAE06B,QAAUzsC,KAAM,WAAc,IAAI+R,EAAI9U,EAAEtC,KAAK,GAAG1C,IAAK,GAAI8Z,EAAG,OAAOA,EAAE/R,QAAUF,KAAM,WAAc,OAAOnF,KAAKa,KAAK,WAAc,IAAIuW,EAAI9U,EAAEtC,KAAK1C,IAAK8Z,GAAKA,EAAEjS,UAAawI,QAAS,WACha,OAAO3N,KAAKa,KAAK,WACb,IAAIuW,EAAI9U,EAAEtC,KAAK1C,IAAK8Z,IAAMA,EAAEjS,OAAQgK,EAAEnP,MAAMmnB,OAAO,cAAe7kB,EAAEtC,KAAK1C,IAAK6R,EAAEnP,MAAMoD,GAAG,WACpGpD,KAAK00C,SAAWr9B,EAAElI,EAAEnP,MAAMnC,KAAK,eAGzBsR,EAAEgC,UAAUnM,KAAKsxB,EAAI,YAAc,YAAa,SAAUlf,GAAKF,IAAME,EAAEy8B,iBAAkBj8B,EAAIu8B,EAAE/8B,GAAoDA,GAA3BA,GAArBA,EAAIkB,GAAKN,EAAIJ,GAAKiD,GAAWS,EAAI,EAAIA,EAAI,EAAIlE,GAAWnJ,EAAI,EAAIA,EAAI,EAAImJ,EAAGw6B,EAAEpH,OAAO5zB,EAAGQ,MAAQjI,EAAEgC,UAAUnM,KAAK6vC,EAAG,SAAUz9B,GAAK,GAAIF,EAAG,CAAEE,EAAEy8B,iBAAkBj9B,EAAEiP,YAAY,OAAQ,IAAIxK,EAAI,IAAIpI,KAAOgI,EAAmD7D,GAA3BA,GAArBA,EAAIkB,GAAKN,EAAIJ,GAAKiD,GAAWS,EAAI,EAAIA,EAAI,EAAIlE,GAAWnJ,EAAI,EAAIA,EAAI,EAAImJ,EAAG,IAAMiE,GAAsBA,GAAjBA,GAAKzD,EAAII,GAAKqD,GAAWA,EAAI,MAAQ,EAAIzD,EAAII,IAAMqD,GAAKA,IAAMA,EAAIzD,EAAII,EAAGjB,EAAEH,EAAGxP,KAAKmI,MAAM+I,EAAI+C,EAAIR,GAAI,GAAG,EAAIzT,KAAKmI,MAAM6H,IAAKF,GAAI,EAAIN,EAAI,KAAO4P,cAAcpO,GAAIjJ,EAAE,UAAU0W,YAAY,WAAa1W,EAAEnC,GAAGqnC,SAAW,SAAUj9B,GACnmB,OAAI+D,EAAE/D,GAAW+D,EAAE/D,GAAGhJ,MAAMpO,KACpCkL,MAAMiD,UAAUe,MAAMhD,KAAKmC,UAAW,IAAS,iBAAoB+I,GAAMA,OAAyCjI,EAAEwsB,MAAM,kBAAvCxgB,EAAE3D,KAAKpJ,MAAMpO,KAAMqO,YAC/Fc,EAAEklC,UAAaW,YAAa,SAAU59B,GAAKjI,EAAE1I,OAAO2U,EAAGhE,IAAMm9B,WAAaD,WApEjF,CAqEGhoC,QAAS,SAAW6C,GACnB,IAAkByL,GAAM5F,WAAY,WAAYigC,UAAW,QAASC,WAAY,QAASjd,WAAY,UAAWkd,WAA5G18B,EAAI,IAAIxF,MAAiHmjB,cAAgB,IAAKgf,QAAS38B,EAAE2d,cAAgB,EAAG1hB,WAAY,wFAAwFtT,MAAM,KAAMuT,gBAAiB,kDAAkDvT,MAAM,KAAMwT,SAAU,2DAA2DxT,MAAM,KAAMyT,cAAe,8BAA8BzT,MAAM,KAAMi0C,gBAAiB,MACtgBC,UAAW,QAASC,QAAS,MAAOC,SAAU,OAAQC,SAAU,QAASC,WAAY,UAAWC,QAAS,UAAWC,SAAU,SAAUC,SAAU,EAAGC,WAAY,EAAGC,WAAY,EAAG1d,UAAW,KAC/L5f,EAAI,SAAU07B,GACb,SAAS98B,EAAED,EAAGjI,EAAGkM,GAAK,YAAO,IAAWxE,EAAE1H,IAAMiI,EAAEP,EAAE1H,SAAM,IAAWkM,EAAIA,EAAIyY,EAAE5c,EAAE/H,IAAM2kB,EAAE5c,EAAE/H,MAAQ+H,EAAE/H,GAAG2kB,GAAK,SAAS/c,EAAEK,EAAGjI,GAAK,OAAO/H,KAAKC,MAAM+P,EAAIjI,GAAKA,EAAI,SAAS7M,EAAE8U,GAAK,IAAIjI,EAAIkI,EAAED,EAAG,IAAK,GAAI,OAAO,IAAInE,KAAKoE,EAAED,EAAG,KAAMC,EAAED,EAAG,KAAMC,EAAED,EAAG,KAAMC,EAAED,EAAG,MAAQjI,EAAI,GAAKA,EAAGkI,EAAED,EAAG,IAAK,GAAIC,EAAED,EAAG,IAAK,IAAM,IAAiBH,EAAG,IAAhBmB,EAAIjJ,EAAEnP,OAAgBoD,GAAG,SAAU,CAChV,OAAQgV,EAAE9W,KAAK,SACX,IAAK,OAAQ2V,EAC7B,WAAY,MAAO,IAAK,WAAYA,EAAI,qBAAsB,MAAO,IAAK,iBAAkBA,EAAI,oBAAqB,MAAO,IAAK,QAASA,EAAI,QAAS2D,EAAEq6B,UAAY,OAAQ,MAAO,IAAK,OAAQh+B,EAAI,WACvL,IAAI4D,EAAIzC,EAAE9W,KAAK,OAAQ8W,EAAIA,EAAE9W,KAAK,OAAQuZ,IAAMD,EAAEo7B,QAAU7mC,EAAEklC,SAAS5f,UAAUxd,EAAG4D,IAAKzC,IAAMwC,EAAEq7B,QAAU9mC,EAAEklC,SAAS5f,UAAUxd,EAAGmB,IACvI,IAAInK,EAAIkB,EAAE1I,UAAWmU,EAAGu5B,EAAE5D,UAAWj1B,EAAI,EAAW7C,GAARoC,SAAgBhE,KAAQK,GAAM6D,EAAG,cAAejE,EAAG,WAAYwE,EAAG,UAAWjE,EAAG,SAAUD,GAAsD,OAAjDA,EAAIA,EAAE2c,WAAkDhd,EAAtCK,EAAI4D,GAAK,IAAM5D,EAAIA,EAAI,GAAKA,EAAekf,IAAMx1B,EAAG,SAAUsW,GAAK,OAAOL,EAAEK,EAAE4c,aAAcigB,IACvPr9B,EAAG,SAAUQ,GAAK,OAAOL,EAAEK,EAAE6c,aAAc4gB,IAAMqB,GAAI,SAAU9+B,GAAK,OAAOkB,GAAK,GAAKlB,EAAE2c,WAAa,EAAI,IACzGnd,EAAI3I,EAAEumC,OAAQx8B,EAAI/J,EAAEgnC,UAAWr9B,EAAI3J,EAAEinC,WAAYj6B,EAAIjD,EAAE8F,MAAM,KAAMxF,EAAIV,EAAEkG,MAAM,MAAO9C,EAAIpD,EAAEkG,MAAM,KAAM+0B,EAAI,YAAcj8B,EAAI3I,EAAE+G,WAAa/G,EAAEoqB,UAAYpqB,EAAEgqB,WAAa,QAAUrhB,EAAI3I,EAAEgqB,WAAahqB,EAAE+G,WAAY8e,EAAI,IAAI7gB,KAAMqjB,EAAIroB,EAAE4nC,SAAU5B,EAAIhmC,EAAE6nC,WAAYjB,EAAI5mC,EAAE8nC,WAAY36B,EAAInN,EAAE+nC,QAAS76B,EAAIlN,EAAEgoC,QAAwB,GAAfh/B,EAAIA,GAAQ47B,EAAOj8B,EAAEkH,MAAM,SAAU,CACzV3O,EAAEtO,MAAM,IAAK,IAAK,KAAM,SAAUuW,EAAGjI,IAAoC,GAA/BiI,EAAIY,EAAE84B,OAAOriC,OAAOU,EAAG,QAAiBsJ,EAAE7P,MAAOurC,EAAG/8B,EAAGkB,EAAGnJ,MAASsJ,EAAE8kB,KAAK,SAAUnmB,EAAGjI,GAAK,OAAOiI,EAAE+8B,EAAIhlC,EAAEglC,EAAI,GAAK,IAC9JhlC,EAAEtO,KAAK4X,EAAG,SAAUrB,EAAGjI,GAAK0H,EAAE1H,EAAEmJ,GAAKlB,IAAegB,KAAT,IAAK,IAAYhB,EAAI,EAAG,EAAIA,EAAGA,IAAK,GAAIA,GAAKP,EAAEkE,EAAG,CAAEO,IAAKlD,EAAEnK,EAAEunC,aAAgB,IAAK,IAAIn6B,EAAID,EAAIA,EAAEgb,cAAgBnoB,EAAEknC,UAAWgB,EAAIh7B,EAAIA,EAAEib,cAAgBnoB,EAAEmnC,QAAS/5B,GAAK86B,EAAG96B,IAAKjD,EAAEnK,EAAEunC,UAAUn6B,GAAKrD,EAAE8F,MAAM,OAASzC,GAAKA,EAAI,IAAIzC,OAAO,EAAG,QAAU,GAAIxB,GAAKP,EAAEC,EAA+B,IAA1BwE,IAAKlD,EAAEnK,EAAEqnC,cAAsBj6B,EAAI,EAAG,GAAKA,EAAGA,IAAKjD,EAAEnK,EAAEqnC,WAAWj6B,GAAKrD,EAAE8F,MAAM,MAAQ7P,EAAEyG,WAAW2G,GAAKrD,EAAE8F,MAAM,KAAO7P,EAAE0G,gBAAgB0G,GAAKrD,EAAE8F,MAAM,OAAS,EAAIzC,EAAI,KAAOA,EAAI,GAAKA,EAAI,OAAS,GAAIjE,GAAKP,EAAEyE,EAA6B,IAAxBA,IAAKlD,EAAEnK,EAAEsnC,YAAoBl6B,EAAI,EAAG,GAAKA,EAAGA,IAAKjD,EAAEnK,EAAEsnC,SAASl6B,GAAKrD,EAAE8F,MAAM,QAAU,GAAKzC,EAAI,IAAMA,EAAIA,EAAIR,EAAEjS,KAAKwP,GACznB,GAAIxB,EAAEkH,MAAM,SAAU,CAE5B,GADQ1F,KACJR,EAAEkG,MAAM,MAAwC,IAA/BjH,EAAEQ,EAAIiE,IAAKlD,EAAEnK,EAAEwnC,aAAqBp6B,EAAI,EAAGA,GAAKL,EAAI,GAAK,IAAKK,GAAKib,EAAGle,EAAEnK,EAAEwnC,UAAUp6B,GAAKL,GAAK,GAAKK,EAAI,GAAKzD,EAAEkG,MAAM,QAAU,GAAKzC,EAAI,IAAMA,EAAIA,EAAI,GAAIzD,EAAEkG,MAAM,KAAyC,IAAjCjH,EAAE/V,EAAIwa,IAAKlD,EAAEnK,EAAEynC,eAAuBr6B,EAAI,EAAG,GAAKA,EAAGA,GAAK44B,EAAG77B,EAAEnK,EAAEynC,YAAYr6B,GAAKzD,EAAEkG,MAAM,OAAS,GAAKzC,EAAI,IAAMA,EAAIA,EAAI,GAAIzD,EAAEkG,MAAM,KAAsC,IAA9BjH,EAAED,EAAI0E,IAAKlD,EAAEnK,EAAE0nC,YAAoBt6B,EAAI,EAAG,GAAKA,EAAGA,GAAKw5B,EAAGz8B,EAAEnK,EAAE0nC,SAASt6B,GAAKzD,EAAEkG,MAAM,OAAS,GAAKzC,EAAI,IAAMA,EAAIA,EAAI/C,IAAMzB,EAAEq/B,GAAK56B,IAAKA,EAAI1D,EAAEkG,MAAM,KAAM1F,EAAEnK,EAAE2nC,WAAcQ,EAAK96B,EAAI,KAAO,KAAM+6B,EAAG/6B,EAAI,KAAO,OAAST,EAAEjS,KAAKwP,GACpiB,OAASi7B,OAAQx4B,EAAGq4B,WAAY,WAC9B,OAAO/jC,EAAEklC,SAAS7gB,WAAWqf,EAAGvwC,EAAE6xC,EAAEp4B,MAChD9N,IACW+kC,aAAc,SAAU57B,GAAK,OAAOjI,EAAEklC,SAAS7gB,WAAWvc,EAAG3U,EAAE8U,GAAInJ,IAAMk7B,WAAY,SAAU/xB,GAAK,IAAIiE,EAAI,IAAIpI,KAAMqI,KAAQ,IAAMD,EAAIlM,EAAEklC,SAAS5f,UAAUxd,EAAGG,EAAGnJ,GAAK,MAAOmK,IAAO,IAAK,IAAIyC,KAAKhE,EAAGyE,EAAEzE,EAAEgE,IAAMQ,EAAEnE,EAAE2D,IAAMQ,EAAEnE,EAAE2D,MAAQ3D,EAAE2D,GAAGQ,GAAI,OAAOC,GAAK02B,SAAU,SAAU56B,EAAGiE,GAClR,IAAIC,EAAI64B,EAAEp4B,KAAMlB,GAAM/D,EAAG,EAAGwE,EAAG,EAAGjE,EAAG,EAAGvW,EAAG,EAAG8V,EAAG,EAAGs/B,GAAI,GAAK99B,GAAMtB,EAAG,GAAIwE,EAAG,GAAIjE,EAAGN,EAAEiE,EAAI,GAAK,GAAIsb,GAAIx1B,EAAGiW,EAAE,GAAIk9B,GAAIr9B,EAAGG,EAAE,GAAI89B,GAAIqB,GAAI,GAAK5zC,GAAI,EAAI2U,GAAI,EAAI9H,EAAEtO,KAAKua,GAAKD,EAAI,iBAAiB/Z,MAAM,KAAOia,GAAKxE,EAAEkE,GAAKM,GAAKxE,EAAEC,QAAK,IAAWuE,GAAK,QAAW,SAAUA,EAAGtE,GACpQ,QAAI,IAAWF,EAAEE,GAAI,CACjB,IACpBa,EAAGkD,EADqBq5B,EAAIt5B,EAAE9D,GAAIjW,EAAIsX,EAAErB,GAAIiE,EAAI,GAAIvC,EAAIpB,EAAEiE,EAAGvE,GAAIH,EAAIzH,EAAE,KAAMiI,GAAGu6B,GAAG96B,EAAEE,IACuW,GAAtb,KAAOA,IAAMa,EAAIP,EAAEiE,EAAG,KAAMR,EAAIzD,EAAEiE,EAAG,KAAMxa,EAAIka,EAAI,GAAK,IAAK/H,KAAK2E,EAAGkD,EAAG,IAAKiR,UAAW9Q,GAAK9L,EAAE,KAAMyH,GAAG/V,KAAK,WAAc,IAAIuW,EAAIjI,EAAEnP,MAAOqb,EAAIjE,EAAEvZ,KAAK,OAAQyd,EAAI,IAAKrI,KAAK2E,EAAGkD,EAAGO,GAAIkb,SAAUnf,EAAE7T,KAAKyU,EAAErT,QAAQ,SAAU,IAAIA,QAAQ,KAAM,GAAK0W,EAAI,IAAMA,EAAIA,GAAG1W,QAAQ,IAAK0W,GAAG1W,QAAQ,KAAMsJ,EAAE2G,SAAS0G,IAAI3W,QAAQ,IAAKsJ,EAAE4G,cAAcyG,QAAUhZ,GAAK8Y,IAAM+4B,EAAI/4B,EAAElE,EAAEH,IAAMqE,EAAElE,EAAEH,MAAQG,EAAEH,GAAGqE,IAAKnE,GAAKkE,IAAMra,EAAIqa,EAAEjE,EAAEH,IAAMoE,EAAEjE,EAAEH,MAAQG,EAAEH,GAAGoE,IAAS,KAAOpE,EAAG,CAClb,IAAI66B,EAAIziC,EAAE,gBAAkBglC,EAAI,KAAMv9B,GAAGzV,QAASyZ,EAAIzL,EAAE,gBAAkBrO,EAAI,KAAM8V,GAAGzV,QAASgO,EAAE,KAAMyH,GAAGiP,YAAY,QAAQ3W,MAAM0iC,EAAGh3B,EAAI,GAAGvZ,SAAS,QACxJ,KAAO0V,GAAK5H,EAAE,KAAMyH,GAAGiP,YAAY,QAAQ3W,MAAM8L,GAAG3Z,SAAS,QAASoX,EAAI07B,IAAM17B,EAAI07B,GAAI17B,EAAI3X,IAAM2X,EAAI3X,GAClE,GAAtCwB,IAAMA,EAAImW,GAAK07B,GAAIl9B,IAAMA,EAAIwB,GAAK3X,GAAQmN,EAAEqoC,SAAW,KAAOv/B,EAAG,CAC/D,IAAIuB,KAA8I,GAAtIrK,EAAEqoC,QAAQC,OAASpnC,EAAEtO,KAAKoN,EAAEqoC,QAAQC,MAAO,SAAUn/B,EAAGjI,GAAKA,EAAEinB,eAAiBxe,GAAKzI,EAAEknB,YAAcvb,GAAKxC,EAAE1P,KAAKuG,EAAE4c,UAAY,KAAW9d,EAAEqoC,QAAQE,WAAY,CAAE,IAAI3D,EAAI,IAAK5/B,KAAK2E,EAAGkD,EAAG,GAAIyb,SAAUpnB,EAAEtO,KAAKoN,EAAEqoC,QAAQE,WAAY,SAAUp/B,EAAGjI,GAAK,IAAK,IAAIkM,EAAIlM,EAAI0jC,EAAGx3B,EAAIL,EAAGK,GAAQ,EAAGA,GAAK,GAAK/C,EAAE1P,KAAKyS,KAAQpN,EAAEqoC,QAAQG,aAAetnC,EAAEtO,KAAKoN,EAAEqoC,QAAQG,YAAa,SAAUr/B,EAAGjI,IAClYA,GAAKA,EAAI,IAAI/N,MAAM,MAAQ,GAAK+N,EAAE,GAAK,GAAK2L,GAAKxC,EAAE1P,KAAKuG,EAAE,GACtF,GAAKmJ,EAAE1P,KAAKuG,EAAE,GAAK,KACSA,EAAEtO,KAAKyX,EAAG,SAAUlB,EAAGiE,GAAKlM,EAAE,KAAMyH,GAAG+6B,GAAGt2B,GAAGwK,YAAY,eAI1E4uB,SAAW1oB,QAAS,SAAU3U,GAAK,IAAIiE,EAAIlM,EAAEnP,MAAMq0C,SAAS,WAAY,GAAIh5B,EAAG,OAAO/Y,EAAE8U,EAAIiE,EAAEU,KAAOV,EAAEy2B,SAAWhmB,QAAS,SAAU1U,EAAGiE,EAAGC,GAA8B,OAAzB,MAAUD,IAAMA,GAAI,GAAYrb,KAAKa,KAAK,WAAc,IAAIoN,EAAIkB,EAAEnP,MAAMq0C,SAAS,WAAY,GAAIpmC,EAAG,CAAE,IAAK,IAAI4M,KAAKhE,EAAG5I,EAAE8N,KAAKlF,EAAEgE,IAAMzD,EAAEF,EAAE2D,IAAMzD,EAAEF,EAAE2D,MAAQ3D,EAAE2D,GAAGzD,GAAInJ,EAAE8jC,UAAS,EAAI12B,EAAGC,UAE3UnM,EAAEklC,SAASE,QAAQzf,KAAOrc,EAAGtJ,EAAEklC,SAASE,QAAQmC,SAAWj+B,EAAGtJ,EAAEklC,SAASE,QAAQvf,KAAOvc,EAAGtJ,EAAEklC,SAAS7gB,WAAa,SAAU2gB,EAAG98B,EAAGN,GAClI,IAAKM,EAAG,OAAO,KACNN,EAAI5H,EAAE1I,UAAWmU,EAAG7D,GAA7B,IAAK,IAA4BzU,EAAI,SAAU6M,GAAK,IAAK,IAAIlB,EAAI,EAAGqN,EAAI,EAAI64B,EAAEjvC,QAAUivC,EAAEj4B,OAAOZ,EAAI,IAAMnM,GAAKlB,IAAKqN,IAAK,OAAOrN,GAAKmK,EAAI,SAAUjJ,EAAGmM,EAAGrN,GAAiB,GAAZqN,EAAI,GAAKA,EAAOhZ,EAAE6M,GAAI,KAAOmM,EAAEpW,OAAS+I,GAAKqN,EAAI,IAAMA,EAAG,OAAOA,GAAKrE,EAAI,SAAU9H,EAAGmM,EAAGrN,EAAG4M,GAAK,OAAOvY,EAAE6M,GAAK0L,EAAES,GAAKrN,EAAEqN,IAAMT,EAAI,GAAI5M,GAAI,EAAIqN,EAAI,EAAGA,EAAI64B,EAAEjvC,OAAQoW,IAAK,GAAIrN,EAAG,KAAOkmC,EAAEj4B,OAAOZ,IAAOhZ,EAAE,KAAgBuY,GAAKs5B,EAAEj4B,OAAOZ,GAAvBrN,GAAI,OAA4B,OAAQkmC,EAAEj4B,OAAOZ,IAC5Z,IAAK,IAAKT,GAAKzC,EAAE,IAAKf,EAAE0U,UAAW,GAAI,MAAO,IAAK,IAAKlR,GAAK5D,EAAE,IAAKI,EAAEkf,SAAUxf,EAAElC,cAAekC,EAAEnC,UAAW,MAAO,IAAK,IAAKiG,GAAKzC,EAAE,KAAMf,EAAEnE,UAAY,IAAKD,KAAKoE,EAAE+e,cAAe,EAAG,GAAIljB,WAAa,MACrN,GAAI,MAAO,IAAK,IAAK2H,GAAKzC,EAAE,IAAKf,EAAEgf,WAAa,EAAG,GAAI,MAAO,IAAK,IAAKxb,GAAK5D,EAAE,IAAKI,EAAEgf,WAAYtf,EAAEpC,gBAAiBoC,EAAErC,YAAa,MAAO,IAAK,IAAKmG,GAAKvY,EAAE,KAAO+U,EAAE+e,eAAiB,GAAK/e,EAAEuf,UAAY,IAAM,IAAM,IAAMvf,EAAEuf,UAAY,IAAK,MAAO,IAAK,IAAK,IAAIne,EAAIpB,EAAE0c,WAAYlZ,EAAIA,EAAIzC,EAAE,IAAK,GAAKK,EAAIA,EAAI,GAAK,GAAKA,EAAI,GAAKA,EAAG,GAAI,MAAO,IAAK,IAAKoC,GAAKzC,EAAE,IAAKf,EAAE0c,WAAY,GAAI,MAAO,IAAK,IAAKlZ,GAAKzC,EAAE,IAAKf,EAAE2c,aAAc,GAAI,MAAO,IAAK,IAAKnZ,GAAKzC,EAAE,IAAKf,EAAE4c,aAAc,GAAI,MAAO,IAAK,IAAKpZ,GAAK,GAAKxD,EAAE0c,WAAa,KAAO,KAAM,MAAO,IAAK,IAAKlZ,GAAK,GAAKxD,EAAE0c,WAAa,KAAO,KAAM,MAAO,IAAK,IAAKzxB,EAAE,KAAOuY,GACpmB,IAAM5M,GAAI,EAAI,MAAO,QAAS4M,GAAKs5B,EAAEj4B,OAAOZ,GAClC,OAAOT,GACV1L,EAAEklC,SAAS5f,UAAY,SAAUhc,EAAGpB,EAAGN,GACtC,IAAIzU,EAAI,IAAI2Q,KAAM,IAAKwF,IAAMpB,EAAG,OAAO/U,EAAY+U,EAAI,iBAAmBA,EAAIA,EAAEvG,WAAauG,EAAI,GAAvD,IAAK,IAAsDe,EAAIjJ,EAAE1I,UAAWmU,EAAG7D,GAAyBE,GAArBF,EAAIzU,EAAE8zB,cAAmB9zB,EAAE+zB,WAAa,GAAGxb,EAAIvY,EAAEypB,UAAW9d,GAAK,EAAGqN,EAAIhZ,EAAEyxB,WAAgC6d,GAApBtvC,EAAIA,EAAE0xB,aAAkB,GAAGnd,GAAK,EAAGK,GAAI,EAAIN,EAAI,SAAUzH,GAA4D,OAAtDA,EAAImJ,EAAI,EAAIG,EAAEvT,QAAUuT,EAAEyD,OAAO5D,EAAI,IAAMnJ,IAAMmJ,IAAYnJ,GAAK6I,EAAI,SAAU7I,GACpO,OAA1HyH,EAAEzH,IAAIA,EAAIkI,EAAEuB,OAAOqC,GAAG6C,MAAMrP,OAAO,WAAa,KAAOU,EAAI,GAAK,KAAOA,EAAI,GAAK,KAAOA,EAAI,EAAI,KAAOA,EAAI,EAAI,GAAK,QAAyB8L,GAAK9L,EAAE,GAAGjK,OAAeT,SAAS0K,EAAE,GAC5L,KADqJ,GAE1IyI,EAAI,SAAUzI,EAAGmM,EAAGrN,GAAuB,IAAlBkB,EAAIyH,EAAEzH,GAAKlB,EAAIqN,EAAQA,EAAI,EAAGA,EAAInM,EAAEjK,OAAQoW,IAAK,GAAIjE,EAAEuB,OAAOqC,EAAG9L,EAAEmM,GAAGpW,QAAQuL,eAAiBtB,EAAEmM,GAAG7K,cAAe,OAAOwK,GAAK9L,EAAEmM,GAAGpW,OAAQoW,EAAI,EAAG,OAAO,GAAKL,EAAI,EAAG3C,EAAI,EAAGA,EAAIG,EAAEvT,OAAQoT,IAAK,GAAIpB,EAAG,KAAOuB,EAAEyD,OAAO5D,IAAO1B,EAAE,KAAgBqE,IAAT/D,GAAI,OAAe,OAAQuB,EAAEyD,OAAO5D,IACnS,IAAK,IAAKuC,EAAI7C,EAAE,KAAM,MAAO,IAAK,IAAKJ,EAAE,IAAKQ,EAAEvD,cAAeuD,EAAExD,UAAW,MAAO,IAAK,IAAK3G,EAAI+J,EAAE,KAAM,MAAO,IAAK,IAAKf,EAAIe,EAAE,KAAM,MAAO,IAAK,IAAKf,EAAIW,EAAE,IAAKQ,EAAEzD,gBAAiByD,EAAE1D,YAAa,MAAO,IAAK,IAAKqC,EAAIiB,EAAE,KAAM,MAAO,IAAK,IAAKsD,EAAItD,EAAE,KAAM,MAAO,IAAK,IAAKsD,EAAItD,EAAE,KAAM,MAAO,IAAK,IAAK1V,EACxT0V,EAAE,KAAM,MAAO,IAAK,IAAK45B,EAAI55B,EAAE,KAAM,MAAO,IAAK,IAAKnB,EAAIe,EAAE,KAAM,KAAM,OAAQ,KAAM,OAAS,EAAG,MAAO,IAAK,IAAKf,EAAIe,EAAE,KAAM,KAAM,OAAQ,KAAM,OAAS,EAAG,MAAO,IAAK,IAAKhB,EAAE,KAAOqE,IAAM/D,GAAI,EAAI,MAAO,QAAS+D,IAC1F,GAAnH,IAAMlE,IAAMA,IAAK,IAAK9D,MAAMmjB,eAAgB,IAAKnjB,MAAMmjB,cAAgB,KAAOrf,GAAKqB,EAAEi9B,gBAAkB,GAAK,OAAY,EAAIpnC,EAAmB,IAAdgJ,EAAI,EAAG4D,EAAI5M,IAAM,CAA+C,GAAI4M,IAAjDzC,EAAI,GAAK,IAAKnF,KAAK8D,EAAGE,EAAI,EAAG,IAAK8U,WAAuB,MAAO9U,IAAK4D,GAAKzC,EAA6G,IAA7FkD,EAAI,IAAIrI,KAAK8D,EAAGE,EAAI,EAAG4D,GAAI,GAAKhE,EAAIyE,EAAIzE,GAAK,GAAKyE,EAAIA,EAAI,GAAMzE,GAAK,IAAMyE,EAAQA,EAAJ,EAAOhZ,EAAGsvC,IAAUxb,eAAiBrf,GAAKuE,EAAE+a,WAAa,GAAKpf,GAAKqE,EAAEyQ,WAAalR,EAAG,KAAM,eAAgB,OAAOS,GAnD7a,CAqDThP,QAAS,SAAW6C,GACnB,IAAIsJ,GAAMk+B,WAAY,IAAMxnC,EAAEklC,SAASE,QAAQ7M,OAAS,SAAU9sB,GAC9D,IAAIu5B,EAAIhlC,EAAE1I,UAAWgS,EAAGmC,EAAE21B,UAAWl5B,EAAIlI,EAAEnP,MAAO+W,EAAI/W,KAAK1C,GAAK,SAAU6R,EAAE,cAAgBnP,KAAK1C,GAAK,MAAMgE,KAAK,MAAOyV,GAAI,IAAqCzU,GAAjCA,EAAI6M,EAAE,cAAgB4H,EAAI,OAAa7R,OAAS5C,EAAE6P,OAASkF,EAAE/V,KAAK,QAAS8W,KAAQnB,OAAUA,EAAE,GAAG3U,MAAS,IAAIuY,EAAI5D,EAAE,GAAG3U,GAAI6M,EAAE,SAAUkI,GAAGxW,KAAK,WAAc,IAAIya,EAAInM,EAAEnP,MAAMsB,KAAK,SAAUuZ,EAAES,GAAKnM,EAAEnP,MAAMmS,OAAQhD,EAAEnP,MAAMsqC,KAAK,aAAelyB,EAAExP,KAAK0S,KAAOnM,EAAE,IAAM4H,GAAGvX,SAAU,IAAIyO,EAAIkB,EAAE,0BAA4B4H,EAAI,YAAc8D,EAAExD,EAAEjI,OAAS,YAAc+kC,EAAEwC,WAAa,iBAAiB5nB,aAAa1X,GACta,OAA7G88B,EAAEQ,aAAe1mC,EAAEo5B,MAAM,WAAczsB,EAAEvV,SAAWgS,EAAElS,OAAO4tC,QAAQ,qBAAqB9tC,QAAQ,WAAoB+X,MAAO,IAAKq2B,OAAQp8B,EAAGi8B,YAAY,EAAIF,aAAc,SAAU7jC,GAAK,OAAO0L,EAAE1L,EAAE,KAAOg6B,WAAY,WAAc,OAAQ9xB,EAAEjI,QAAU4iC,SAAU,SAAU12B,GAAKnM,EAAEtO,KAAKuX,EAAG,SAAUnK,EAAG4M,GAAK1L,EAAE,gBAAkB0L,EAAI,KAAMS,GAAGuK,YAAY,WAAc6tB,SAAU,SAAUvkC,EAAG0L,GAAK5M,EAAEmB,IAAID,GAAIkI,EAAEjI,IAAIyL,EAAEi3B,OAAO,IAAI7sC,QAAQ,WAAakuC,SAAU,SAAUhkC,EAAG0L,GAAK,UAAYs5B,EAAElB,UAAYhlC,EAAEmB,IAAID,GAAIkI,EAAEjI,IAAIyL,EAAEkB,KAAK,IAAI9W,QAAQ,YAAc+jB,QAAS,WAAc/a,EAAE8hC,UAHpjB,CAKTzjC,QAA0HA,OAA/F+nC,SAASC,OAAOsC,SAAYvH,UAAY4F,UAAW,QAASp1C,KAAM,YAAaijB,OAAQ,KAAiB,SAAW3T,GAAK,IAAIsJ,GAAM42B,UAAY4F,UAAW,QAASp1C,KAAM,QAASwC,KAAM,EAAG2a,MAAO,GAAIs2B,WAAW,IAAOnkC,EAAEklC,SAASC,OAAO,eAAiB77B,EAAGtJ,EAAEklC,SAASC,OAAO,qBAAuB77B,EAA9L,CAAmMnM,QAAsJA,OAA3H+nC,SAASC,OAAOuC,KAAQxH,UAAY4F,UAAW,QAAS5yC,KAAM,EAAGygB,OAAQ,GAAI9F,MAAO,GAAIk2B,YAAY,EAAII,WAAW,IAAiB,SAAWnkC,GAC/eA,EAAEklC,SAASC,OAAOwC,KAAQzH,UAAY0H,QAAS,IAAKC,UAAW,IAAKC,SAAU,IAAKC,aAAc,IAAKC,OAAQ,IAAKC,UAAW,KAAO5/B,KAAM,SAAUiB,EAAGmC,GACpJ,IAAIu5B,EAAIv5B,EAAE21B,SAAUphC,EAAE,MAAOsJ,GAAGoN,YAAY,QAAQxkB,SAAS,6CAA8C8N,EAAE,WAAYsJ,GAAGnX,KAAK,YAAa,UAAUA,KAAK,aAAc6yC,EAAEgD,QAAShoC,EAAE,WAAYsJ,GAAGnX,KAAK,YAAa,UAAUA,KAAK,aAAc6yC,EAAEiD,WAAYjoC,EAAE,QAASsJ,GAAGnX,KAAK,YAAa,UAAUA,KAAK,aAAc6yC,EAAE+C,cAAe/nC,EAAE,OAAQsJ,GAAGpX,SAAS,oBAChX8yC,EAAE6C,WAAY7nC,EAAE,QAASsJ,GAAGpX,SAAS,WAAa8yC,EAAE4C,SAAU5nC,EAAE,aAAcsJ,GAAGpX,SAAS,WAAa8yC,EAAE8C,UAAW,UAAY9C,EAAElB,SAAW9jC,EAAE,MAAOsJ,GAAGpX,SAAS,UAAWoX,EAAExT,QAAQ,UAAWkK,EAAE,OAAQsJ,GAAGgR,MAAM,WAAc7O,EAAEzV,WAHmQ,CAMremH,QChIH,SAAWnP,GACPA,EAAE6P,GAAGqqC,iBAAmB,SAAUh6C,GAE9BA,EAAUA,MAEV,IAAIi6C,GACAC,UAAW,EACXl3C,WAAY,EACZm3C,WAAY,EACZ9uC,SAGA+uC,YAAat6C,EAAE,MACfu6C,MAAO,0DACPC,WAAY,QACZC,SAAU,qDACVC,cAAe,WACfhJ,KAAM,mDACNiJ,UAAW,OACXC,KAAM,wDACNC,UAAW,OACXC,QAAS,UACTC,WAAY,gBAGZC,cAAe,cAIf96C,EAAQm6C,WAAan6C,EAAQgD,aAC7BhD,EAAQm6C,WAAan6C,EAAQgD,YAIjClD,EAAEsJ,OAAO6wC,EAAgBA,EAAgBj6C,GAEzC,IAAI+6C,GACAC,aAAef,EAAeE,WAAa,EAAKF,EAAeE,WAAa,EAAI,EAChFc,SAAWhB,EAAeE,WAAaF,EAAej3C,WAAci3C,EAAeE,WAAa,EAAIF,EAAej3C,YAInHk4C,EAAgB,24CAsMpB,SAASzH,EAAOzlC,GACZ,IACIwW,EAAYxW,EAAOwW,UACnB8Y,EAAOtvB,EAAOsvB,KAElB,GAAItvB,EAAOmtC,QAJAx4C,KAIey4C,oBAAuBptC,EAAOqtC,MAAxD,CAJW14C,KAQNy4C,mBAAqBptC,EAAOmtC,MAEZ,KAAjBntC,EAAOmtC,MAC+E,SAAlF32B,EAAUve,KAAK,gDAAgDoB,IAAI,YACnEmd,EAAUve,KAAK,gDAAgD+B,KAAK,KAExEwc,EAAUve,KAAK,gDAAgD6B,KAAK,KAIxE,IAAIwzC,EAAS,IAAIlqC,OAAOpD,EAAOmtC,MAAO,KACtC7d,EAAKge,OAAO,WAER,GAAIA,EAAOzmC,KAAK/U,EADL6C,MACamS,QACpB,OAAOhV,EAFA6C,MAIP7C,EAJO6C,MAICmF,SAEbE,SAjMP,WAEI,GAAIiyC,EAAej3C,YAAci3C,EAAej3C,WAAa,EAAG,CAE5Di3C,EAAe5uC,SACf,IAAK,IAAI5H,EAAI,EAAGA,GAAKw2C,EAAej3C,WAAYS,IAC5Cw2C,EAAe5uC,MAAME,MACjBtL,GAAIwD,EACJ8C,MAAO9C,EACPgI,OAAShI,IAAMw2C,EAAeE,aAiB1CF,EAAeG,YAAYmB,QAAQ,SAASt1C,KAAK,YAC5CjC,SAASi2C,EAAeY,WAAa,IAAMZ,EAAeO,eAC1Dh6C,KAAK,OAAQu6C,EAAWC,cACxB90C,KAAK+zC,EAAeM,UAGzBN,EAAeG,YAAYmB,QAAQ,SAASt1C,KAAK,YAC5CjC,SAASi2C,EAAeY,WAAa,IAAMZ,EAAeK,YAC1D95C,KAAK,OAAQy5C,EAAeC,WAC5Bh0C,KAAK+zC,EAAeI,OAGzBJ,EAAeG,YAAY71C,OAAO,SAAS0B,KAAK,WAC3CjC,SAASi2C,EAAeY,WAAa,IAAMZ,EAAeQ,WAC1Dj6C,KAAK,OAAQu6C,EAAWE,UACxB/0C,KAAK+zC,EAAezI,MAGzByI,EAAeG,YAAY71C,OAAO,SAAS0B,KAAK,WAC3CjC,SAASi2C,EAAeY,WAAa,IAAMZ,EAAeU,WAC1Dn6C,KAAK,OAAQy5C,EAAej3C,YAC5BkD,KAAK+zC,EAAeS,MASzB56C,EAAE,MAAQm6C,EAAeY,WAAYZ,EAAeG,aAAahuB,MAAM,WACnE,IAAIvpB,EAAQ/C,EAAE6C,MAAMiyC,SAASqF,EAAeU,WAAcV,EAAej3C,WAAawJ,OAAO1M,EAAE6C,MAAMnC,KAAK,SAE1Gy5C,EAAea,eAAgBj4C,KAAMA,MAIzC/C,EAAE,2BAA4Bm6C,EAAeG,aAAahuB,MAAM,WASpE,IAMQovB,EACAC,EA0BqBC,EAErBC,EACAC,EA9BAJ,EAAqB5jB,MAAM52B,SAASk6C,GAAiBW,cAAc,KACnEJ,EAAa37C,EAAE07C,GAAqBle,KAAM2c,EAAe5uC,MAAOzK,MALxD,aAKsEuuC,YAJhE,eAI0FphC,OAH/F,OAGiH8R,SAEnHi8B,sBACPpxB,MAAO,WACH/nB,KAAK2N,UACL3N,KAAKC,QAAQT,UAEjB45C,oBAAoB,EACpB7uB,OAAO,IAoBPyuB,GAFqBD,EAfLD,GAiBWx1C,KAAK,2CAChC21C,EAAqBF,EAAez1C,KAAK,wCAG7Cy1C,EAAetsC,GAAG,QAAS,8CAA+C,WACtEssC,EAAeI,qBAAqB,WAIxCJ,EAAetsC,GAAG,QAAS,wCAAyC,WAChE,IAAI4sC,EAAeJ,EAAmB31C,KAAK,sDAE3C,GAAI+1C,GAAgBA,EAAan0C,OAAS,EAAG,CACzC,IAAIhF,EAAO2J,OAAOwvC,EAAax7C,KAAK,SAEpCk7C,EAAeI,qBAAqB,SACpC7B,EAAea,eAAgBj4C,KAAMA,OAK7C64C,EAAez1C,KAAK,yCAAyCg2C,MAAM,SAAU5yB,GACzE,IAAI6yB,EAAOv5C,KAES,KAAhB0mB,EAAM6nB,MACNuC,GAASjvB,UAAWk3B,EAAgBpe,KAAMqe,EAAWR,MAAOe,EAAK31C,MAAO80C,OAAO,KAE3Ea,EAAKxsB,SACL/qB,aAAau3C,EAAKxsB,SAEtBwsB,EAAKxsB,QAAUjrB,WAAW,WACtBgvC,GAASjvB,UAAWk3B,EAAgBpe,KAAMqe,EAAWR,MAAOe,EAAK31C,SAClE,QAKXm1C,EAAez1C,KAAK,gDAAgDmJ,GAAG,QAAS,WAC5EqkC,GAASjvB,UAAWk3B,EAAgBpe,KAAMqe,EAAWR,MAAO,GAAIE,OAAO,IACvEK,EAAez1C,KAAK,yCAAyC8L,IAAI,MAIrE6pC,EAAmBxsC,GAAG,QAAS,KAAM,WAGjCwsC,EACK31C,KAAK,sDACLuiB,YAAY,qDAEjB1oB,EANW6C,MAMHqB,SAAS,uDAhErBy3C,EAAW/F,QAAQ,yBACd1xC,SAAS,mCACTA,SAAS,oCAEdy3C,EAAWK,qBAAqB,WAoGpC3hC,IA/QR,CAiRGlL,QCjRH,SAAWnP,GACPA,EAAE6P,GAAGwsC,WAAa,SAAUn8C,GAExB,IA2CI0C,EAAOC,KAOX,OANAD,EAAKE,QAAUD,KACfD,EAAK1C,QAAUF,EAAEsJ,QA5CbnJ,GAAI,QACJC,WACAC,OAAQ,GACRC,SAAU,MACVC,aAAa,EACbC,UAAU,EACVC,eAAe,EACfC,QACAC,eACAC,WAAY,EACZC,YAAY,EACZC,MAAO,GACPC,cAAe,GACfC,aAAc,GACds7C,eAAgB,wBAChBC,kBAAmB,2BACnBr7C,UACIC,KAAM,GACNC,QAAS,GACTC,MAAO,GACPC,WAAY,GACZC,OAAQ,GACRC,cAAe,GACfC,IAAK,GACLC,WAAY,GACZC,KAAM,GACNC,YAAa,GACbC,MAAO,GACPC,QAAS,GACTC,aAAc,GACdC,QAAS,GACTC,YAAa,IAEjBC,SACIC,KAAK,EACLC,MAAM,EACNC,QAAQ,EACRC,SAAS,GAEbI,KAAM,aAK8BxC,OAmBxC,WACI,IAAIA,EAAU0C,EAAK1C,QACf4C,EAAUF,EAAKE,QAGnBF,EAAKG,KAAO,EACZH,EAAKI,WACLJ,EAAKK,UAAY,EACjBL,EAAKM,WAAa,EAClBN,EAAKlC,KAAOR,EAAQQ,KACpBkC,EAAKO,YAAc,EACnBP,EAAKQ,cACLR,EAAKd,WACLc,EAAKS,cAGLT,EAAKW,iBACLX,EAAKY,gBACLZ,EAAKa,eAAiB,EAEtBzD,EAAE0D,KAAKxD,EAAQE,QAAS,SAAUuD,EAAGpC,GAEjCA,EAAOqC,SAA8B,IAAhBrC,EAAU,KAAoBA,EAAOqC,IAC1DrC,EAAOsC,WAAkC,IAAlBtC,EAAY,MAAoBA,EAAOsC,MAAQtC,EAAOuC,KAC7EvC,EAAOjB,SAAW,MAGlBsC,EAAKW,cAAchC,EAAOyC,OAASzC,EACnCqB,EAAKY,aAAajC,EAAOuC,MAAQvC,EAC7BA,EAAOqC,MACPhB,EAAKa,eAAiBlC,EAAOyC,SAKrC9D,EAAQG,OAASH,EAAQG,QAAUuC,EAAKW,cAAc,GAAGO,KACrDlB,EAAKY,aAAatD,EAAQG,QAC1BuC,EAAKY,aAAatD,EAAQG,QAAQC,SAAWJ,EAAQI,SAEjDsC,EAAKY,aAAatD,EAAQG,OAAO4D,MAAM,KAAK,MAC5CrB,EAAKY,aAAatD,EAAQG,OAAO4D,MAAM,KAAK,IAAI3D,SAAWJ,EAAQI,UAM3EwC,EAAQqB,KAAK,iBAAkBjE,EAAQC,IAGvCiE,IAGAxB,EAAKnC,cAAgBP,EAAQO,cApEjC4Z,IAGItV,QA2HJ,SAAiBrE,GAEbkC,EAAKlC,KAAOA,EACZ0D,IA6CAiB,IAIAzC,EAAKQ,cAqDT,WACI,IA3HIN,EA2HA5C,EAAU0C,EAAK1C,QACf4C,EAAUF,EAAKE,QAGnBF,EAAK+C,SAAU,EA/HX7C,EAAUF,EAAKE,QAGfF,EAAK4B,iBACLK,aAAajC,EAAK4B,gBAClB5B,EAAK4B,eAAiB,MAI1B1B,EAAQgC,QA4HR,IAucI5C,EACAhC,EACA2L,EACAC,EA3XA5G,EAlCWkB,EAqGXlB,EA4DAhF,EAGAE,EACAo8C,EApKAt8C,EAGAmB,EAKAC,EAtDA8E,EAAOpG,EAAEy8C,UAAUv8C,EAAQgB,SAASC,MACpC0C,MAAO3D,EAAQY,MACfD,WAAYX,EAAQW,WACpBL,SAAUN,EAAQM,SAClBC,cAAemC,EAAKnC,cACpBoG,SAA4B,WAAjB3G,EAAQwC,OAwCR0D,EApCEA,EAqCblG,EAAU0C,EAAK1C,QAGfmB,EAAQrB,EAAEy8C,UAAUv8C,EAAQgB,SAASG,OACrCd,YAAaL,EAAQK,YACrBQ,cAAeb,EAAQa,gBAGvBO,EAAatB,EAAEy8C,UAAUv8C,EAAQgB,SAASI,YAM9CD,EAAQ8G,EAHR9G,EAAQ8G,EAAgB9G,EAAO,WAqJ3BnB,EAAU0C,EAAK1C,QAGfE,EAAU,GACVo8C,GAAsB,EAE1B55C,EAAKgG,WAxHT,WAQI,IAPA,IAAI1I,EAAU0C,EAAK1C,QACfE,EAAUF,EAAQE,QAClBC,EAASH,EAAQG,OAEjBsD,EAAI,EACJoE,EAAS3H,EAAQ2H,OAEdpE,EAAIoE,GACP,GAAI1H,IAAWD,EAAQuD,KAAKG,KACxB,OAAO,EAIf,OAAO,EA0GW6E,GAElB3I,EAAE0D,KAAKxD,EAAQE,QAAS,SAAUuD,EAAGpC,GAC7Bi7C,IAIAt8C,EAAQU,WAAa,EACjB+C,GAAKf,EAAK1C,QAAQU,WAElBR,GAAWyI,EAAWtH,IAGtBnB,GAAW2I,kBAAkBxH,GAC7Bi7C,GAAsB,GAI1Bp8C,GAAWyI,EAAWtH,MAIvBnB,IA9KwB,QAsF3B8E,EAAO,GAEXlF,EAAE0D,KAAKd,EAAKlC,KAAKwE,KAAM,SAAUvB,EAAGlC,GAaxC,IAAiBoI,EAASC,EAClB5J,EACA0D,EACAmG,EACAC,EAEAvI,EAOAuE,EACA02C,EA1BAx3C,IAYS2E,EAZOpI,EAahBvB,EAAU0C,EAAK1C,QACf0D,EAAMiG,EAAQjH,EAAKa,gBACnBsG,EAASD,IAAY,EACrBE,EAAMC,KAAKC,MAAsB,IAAhBD,KAAKE,UAEtB1I,EAAMzB,EAAEy8C,UAAUv8C,EAAQgB,SAASO,KACnCmC,IAAKoG,EACLF,SAAUA,EACVM,YAAaxG,IAIboC,EAAQ,GACR02C,GAAoB,EACxB18C,EAAE0D,KAAKmG,EAAS,SAAUlG,EAAGhC,GACrB+6C,IAIAx8C,EAAQU,WAAa,EACjB+C,EAAIzD,EAAQU,WAAa,EAEzBoF,GAASqE,EAAS1G,EAAGC,EAAKjC,EAAMoI,IAGhC/D,GAASuE,gBAAgB5G,EAAGC,EAAKjC,GACjC+6C,GAAoB,GAIxB12C,GAASqE,EAAS1G,EAAGC,EAAKjC,EAAMoI,MAKxCtI,EAAM0G,EAAgB1G,EAAK,QAASuE,MA7C7Bd,IA/IPkB,EA0DAA,EAAO+B,EADP/B,EAAO+B,EAHP/B,EAAO+B,EAAgB/B,EAAM,QA0RjC,WACI,IAAIlG,EAAU0C,EAAK1C,QACfy8C,KAEJA,EAAUC,cAAgBh6C,EAAKlC,KAAK8K,MAAQ,EAC5CmxC,EAAU55C,KAAO2J,OAAO9J,EAAKlC,KAAKqC,MAGlC45C,EAAUpxC,SACV,IAAK,IAAI5H,EAAI,EAAGA,GAAKf,EAAKlC,KAAK8K,MAAO7H,IAClCg5C,EAAUpxC,MAAME,MACZC,OAAQ/H,EACRgI,OAAShI,IAAMg5C,EAAU55C,OASjC,OAJA45C,EAAUzB,aAAgBt4C,EAAKlC,KAAKqC,KAAO,EAAKH,EAAKlC,KAAKqC,KAAO,EAAI,EACrE45C,EAAUxB,SAAYv4C,EAAKlC,KAAKqC,KAAOH,EAAKlC,KAAK8K,MAAS5I,EAAKlC,KAAKqC,KAAO,EAAIH,EAAKlC,KAAK8K,MACzFmxC,EAAUz5C,WAAaN,EAAKlC,KAAK8K,MAE1BxL,EAAEy8C,UAAUv8C,EAAQgB,SAASW,MAAO86C,GA/SLr0C,IAGT,QAASjH,GACT,aAAcC,GAzD3CsB,EAAKzB,KAAOnB,EAAEoG,GAAMW,SAASjE,GAGlBF,EAAKzB,MAkEZ+D,EAAOQ,EAAc,WAErB1F,EAAE0D,KAAKwB,EAAM,SAAUvB,EAAGlC,GAiClC,IAAuBA,EAEfmC,EACAkG,EACA9D,EApCIvE,EAAMzB,EAAEyB,GAkCZmC,GAFenC,EA/BGA,GAiCR0C,KAAK,qBACf2F,EAAWrI,EAAI0C,KAAK,gBACpB6B,EAAQvE,EAAIwE,GAAG,iCAAmCxE,EAAIyE,WAAazE,EAAI0E,KAAK,iCAAiCD,WAEjHlG,EAAE0D,KAAKsC,EAAO,SAAUrC,EAAGhC,GACvB,IAAIJ,EAASqB,EAAKW,cAAcI,GAChC,IAAIpC,EAAOqC,IAAX,CAGA,IAAIwI,EAAcxJ,EAAKS,WAAWO,EAAM,IAAMrC,EAAOyC,OACjDoI,EACApM,EAAEqM,KAAKD,GACFpB,KAAK,SAAU5E,IAEZzE,EAAO3B,EAAE2B,IACJ8C,OAAO2B,GACZG,EAAYhF,EAAQqC,EAAKjC,EAAMmI,KAGvCvD,EAAYhF,EAAQqC,EAAK5D,EAAE2B,GAAOmI,QA6P9C,WACI,GAAIlH,EAAKlC,KAAK8K,MAAQ,EAAG,CAErB,IAAIqxC,EAAiBn3C,EAAc,SAASS,KAAK,MAC7C22C,GACA55C,WAAYN,EAAKlC,KAAK8K,MACtB6uC,WAAY3tC,OAAO9J,EAAKlC,KAAKqC,MAC7Bu3C,YAAauC,EACb7B,cAAe,SAAU96C,GAyGrC,IAAoB6C,EACZ0J,EACAjB,EACAmB,EAHY5J,EAxGO7C,EAAQ6C,KAyG3B0J,EAAcC,OAAO9J,EAAKlC,KAAKqC,MAC/ByI,EAAQ5I,EAAKlC,KAAK8K,OAClBmB,EAAU5J,KAEE0J,GAAeE,EAAU,GAAKA,EAAUnB,IAIxDnG,IAGAzC,EAAKG,KAAO2J,OAAOC,GA8KZR,EAAgB,gBAAiBsC,QA7RpCouC,EAAe3C,iBAAiB4C,IAlYpC71C,GA6YAvB,EAAc,QAAQS,KAAK,MAAMmJ,GAAG,QAAS,WACzC,IAkKW1L,EAAKwG,EAlKZxG,EAAM5D,EAAE6C,MAAMsB,KAAK,YACnBiG,EAAcpK,EAAE6C,MAAMsB,KAAK,qBAiKpBP,EA/JDA,EA+JMwG,EA/JDA,EAiKfxH,EAAKO,cAAgBS,GAErBwJ,IAGAxK,EAAKO,YAAc,EACnBP,EAAKyK,oBAAsB,IAEF,IAArBzK,EAAKO,aAELiK,IAIJxK,EAAKO,YAAcS,EACnBhB,EAAKyK,oBAAsBjD,EAkDxB+B,EAAgB,eAAiBvI,IAAKhB,EAAKO,iBA9NlDuC,EAAc,WAAWS,KAAK,sBAAsBmJ,GAAG,QAAS,WAC5D,IAuGQ7J,EAAanF,EACrBJ,EACAqB,EAzGIkE,EAAczF,EAAE6C,MAAMsB,KAAK,qBAuGvBsB,EArGDA,EAsGPvF,EAAU0C,EAAK1C,QACfqB,EAASqB,EAAKW,cAAckC,QAEA,IAApBvF,EAAc,cAKG,IAAjBqB,EAAW,OACnBA,EAAOuC,KAAOvC,EAAOsC,OAIrBvD,EADAiB,EAAOuC,OAAS5D,EAAQG,OACbC,IAAmC,QAAtBJ,EAAQuJ,UAAsB,OAAS,OAE3DlI,EAAOuC,OAAS5D,EAAQG,OAAO4D,MAAM,KAAK,GAC/B3D,IAAkC,QAArBJ,EAAQI,SAAqB,OAAS,OAEnDA,GAAYJ,EAAQI,SAKnCJ,EAAQG,OAAO4D,MAAM,KAAK8D,OAAS,GAC/B7H,EAAQG,OAAO4D,MAAM,KAAK,GAAO1C,EAAOuC,KACxC5D,EAAQG,OAASkB,EAAOuC,MAK5B5D,EAAQG,OAASkB,EAAOuC,KAG5B5D,EAAQ+M,WAAa1L,EACrBrB,EAAQI,SAAWA,EACnBJ,EAAQuJ,UAAYnJ,EAGpB+E,IAwIO8G,EAAgB,gBAAiBsC,QAhRxC/I,EAAc,QAAQS,KAAK,MAAM42C,aAC7B76C,SA0BAA,KACAhC,EAAU0C,EAAK1C,QACf2L,EAAW3L,EAAQ2L,aACnBC,EAAa9L,EAAEsJ,OAAOpJ,EAAQgC,QAAS2J,GAEvCC,EAAW1J,MACXF,EAAQuJ,MAAO8iC,KAAM,OAAQyO,YAAalxC,EAAWmxC,YAGrDnxC,EAAWzJ,QACXH,EAAQuJ,MAAO8iC,KAAM,SAAUyO,YAAalxC,EAAWoxC,cAGvDpxC,EAAWxJ,SACXJ,EAAQuJ,MAAO8iC,KAAM,UAAWyO,YAAalxC,EAAWqxC,cAGrDj7C,GA1CHk7C,WAAY,eACZC,cAAe,SAAUC,GACrB,IACI15C,EAAM5D,EAAEs9C,EAAIC,QAAQ3H,QAAQ,MAAMzxC,KAAK,YACvCiG,EAAcpK,EAAEs9C,EAAIC,QAAQ3H,QAAQ,MAAMzxC,KAAK,qBAFxCtB,KAINqL,QAAWtK,IAAKA,EAAKwG,YAAaA,IAE3CozC,cAAe,SAAUvvC,GAGrBD,EAAcC,EAAOsgC,KAFV1rC,KAEqBqL,QAChCX,KAEJkwC,cAAe,SAAUl0B,GACrBhc,OAvasB,IAA1B3K,EAAKlC,KAAKwE,KAAK6C,QACfrC,EAAc,SAASsC,OACvBtC,EAAc,SAASsC,OAEvBtC,EAAc,cAAcwC,SAG5BxC,EAAc,SAASwC,OACvBxC,EAAc,SAASwC,OAGvBxC,EAAc,cAAcsC,QAIhCpF,EAAK+C,SAAU,EApGfJ,IA/KAN,QAuIJ,WAEI,OAAOrC,EAAKlC,MAxIZyQ,cA6+BJ,WACI,IAAIjM,EAAOQ,EAAc,QAAQS,KAAK,kBAEtC,OAAOnG,EAAE2N,IAAIzI,EAAM,SAAUzD,EAAKkC,GAC9B,OAAO3D,EAAEyB,GAAKf,KAAK,mBAh/BvB8F,gBAuNJ,SAAyB5C,EAAK6B,EAAagB,GACnC7D,EAAKjC,YAAYiD,KACjBhB,EAAKjC,YAAYiD,GAAK6B,GAAegB,IAxNzCjB,eAoLJ,SAAwBC,GAEpB,IAAIvF,EAAU0C,EAAK1C,QACf8B,EAAU0D,EAAc,WAG5B,GAAI9C,EAAK+C,QAAS,OAClB,IAAK3D,EAAS,OAGV9B,EAAQK,cAEJkF,EAEAG,mBAAmBH,IAInBzD,EAAQ8C,QACR9C,EAAQyC,OAAOoB,eAGfC,kBAAkB9D,MAzM1B07C,aAs/BJ,WACI,OAAO19C,EAAE4C,EAAKE,UAt/BdkL,cAAeA,GA2InB,SAAS5J,IACL,IACIhE,EADUwC,EAAK1C,QACGE,QAClBM,EAAOkC,EAAKlC,KACZC,KAEAD,EAAKwE,MACLlF,EAAE0D,KAAKhD,EAAKwE,KAAM,SAAUvB,EAAGlC,GAC3B,IAAImC,EAEJ5D,EAAE0D,KAAKtD,EAAS,SAAU+E,EAAG5D,GACrBA,EAAOqC,MAAKA,EAAMnC,EAAI0D,MAG9BxE,EAAYiD,GAAOnC,IAG3BmB,EAAKjC,YAAcA,EA+TvB,SAASkI,EAAWtH,GAChB,IACI2H,EADAhJ,EAAU0C,EAAK1C,QAIfgJ,EADA3H,EAAOqC,IACI1D,EAAQo8C,eAEf/6C,EAAOmJ,OACIxK,EAAQq8C,uBAE2B,IAA3Bh7C,EAAO0H,kBAAmC1H,EAAO0H,iBAAiBE,SAAY5H,EAAO0H,iBAAiBE,SAAW,GAK5I,IAAIK,EAAajI,EAAOuC,OAAS5D,EAAQG,OAASkB,EAAOuC,OAAS5D,EAAQG,OAASkB,EAAOuC,OAAS5D,EAAQG,OAAO4D,MAAM,KAAK,KAAOrB,EAAKgG,YAAarH,EAAOuC,OAAS5D,EAAQG,OAAO4D,MAAM,KAAK,GAEhM,OAAOjE,EAAEy8C,UAAUv8C,EAAQgB,SAASK,OAAQvB,EAAEsJ,UAAW/H,GACrDiI,WAAYA,EACZlJ,SAAUJ,EAAQuJ,UAClBE,kBAAmBzJ,EAAQc,aAAed,EAAQc,aAAa6C,MAAQ,GACvE7C,aAAcd,EAAQc,aAAed,EAAQc,aAAaoI,OAAS,GACnEM,eAAgBR,KAYxB,SAASmB,EAAS5E,EAAa7B,EAAK6C,EAAOqD,GACvC,IAAI5J,EAAU0C,EAAK1C,QACfiL,EAAoB,GAKxB,GAHArB,EAAWA,IAAY,GAGlBlH,EAAKW,cAAckC,GACpB,MAAO,GAIPA,EAAc,IACd0F,EAAoBvI,EAAKW,cAAckC,GAAawD,kBAAoBrG,EAAKW,cAAckC,GAAawD,iBAAiBkC,mBAG7H,IAEIjC,EAFAK,EAAQ3G,EAAKW,cAAckC,GAAa7B,IACxC8G,EAASxK,EAAQE,QAAQqF,GAAaiF,SAAU,EAIhDxB,EADAK,EACWrJ,EAAQo8C,eAEf5xC,EACWxK,EAAQq8C,uBAEoD,IAApD35C,EAAKW,cAAckC,GAAawD,kBAAmCrG,EAAKW,cAAckC,GAAawD,iBAAiBE,SAAYvG,EAAKW,cAAckC,GAAawD,iBAAiBE,SAAW,GAKvN,IAoEIyB,EApEAjJ,EAAO3B,EAAEy8C,UAAUv8C,EAAQgB,SAASS,MACpC4H,MAAOA,EACPmB,OAAQA,EACR7D,SAA4B,WAAjB3G,EAAQwC,KACnByI,kBAAmBA,EACnBzB,eAAgBR,IAGhB0B,EAoTGuB,EAAgB,YAAc5K,OApTbqB,EAAKW,cAAckC,GAoTU7B,IApTIA,EAoTM6C,MApTDA,EAoTeqD,SApTRA,IAuBrE,OAtBKc,IACDA,EAAS,IAGmB,iBAAb,GAAyBA,EAAOI,KAExB,aAAnBJ,EAAOK,QAEPtJ,EAAOwG,EAAgBxG,EAAM,eAA6BiJ,EAqD1DI,KAAK,SAAUtK,GACnBkK,EAASlK,IAGNkK,KAtDCjJ,EAAOwG,EAAgBxG,EAAM,cAAe,IAC5CiB,EAAKS,WAAWO,EAAM,IAAM6B,GAAemF,GAK/CjJ,EAAOwG,EAAgBxG,EAAM,cAAeiJ,GAGhDhI,EAAKW,cAAckC,GAAmB,KAAIzF,EAAE2B,GAErCA,EA+IX,SAASqM,EAAcC,EAAQC,GAEZ,SAAXD,GAgMG9B,EAAgB,WAAavI,IAAKhB,EAAKyK,sBA5L/B,WAAXY,GA4KG9B,EAAgB,aAAevI,IAAKhB,EAAKyK,sBAxKjC,YAAXY,GAgLG9B,EAAgB,mBAAqBvI,IAAKhB,EAAKyK,sBA/D1D,SAASE,IACoB,IAArB3K,EAAKO,cAELiK,IAEAxK,EAAKO,YAAc,EACnBP,EAAKyK,oBAAsB,GAwBnC,SAAS9G,EAAYhF,EAAQqC,EAAKjC,EAAMmI,GACpC,OAAOqC,EAAgB,aAAe5K,OAAQA,EAAQqC,IAAKA,EAAKjC,KAAMA,EAAMmI,SAAUA,IAe1F,SAASsD,IACL,OAAOjB,EAAgB,iBAAmBvI,IAAKhB,EAAKO,cA0DxD,SAASgJ,EAAgBW,EAAMpM,GAC3B,IAAIoO,EAAW5O,EAAQ4M,GAEvB,OAAKgC,EAGEA,EAASC,KAAKnM,EAAKE,QAASpC,GAFxB,KASf,SAAS2E,IACLzC,EAAKQ,cAQT,SAASsC,EAAcsJ,GACnB,IAAIlM,EAAUF,EAAKE,QAEnB,IAAKF,EAAKQ,WAAW4L,GAAY,CAC7B,IAAIC,EAAiBjP,EAAE,0BAA4BgP,EAAY,IAAKlM,GAC9C,MAAlBmM,GAA0BA,EAAelH,OAAS,IAClDnF,EAAKQ,WAAW4L,GAAaC,GAGrC,OAAOrM,EAAKQ,WAAW4L,GAU3B,SAAS7G,EAAgB/B,EAAMtD,EAAS0E,GACpC,OAAOpB,EAAKoB,QAAQ,aAAe1E,EAAU,KAAM0E,GAOvD,SAASiH,IACL,IAAIvO,EAAU0C,EAAK1C,QACf+M,EAAoClC,MAAtB7K,EAAQ+M,WAA2B/M,EAAQ+M,WAAWjJ,MAAQ,EAChF,OAASjB,KAAMH,EAAKG,KAAM1C,OAAQH,EAAQG,OAAQC,SAAUJ,EAAQuJ,UAAWoF,gBAAiB5B,KA9hC5G,CAujCGkC,QC5iCH,SAAWnP,GACPA,EAAE29C,QAAU,SAAUC,GA2BlB,OA1BAC,EAAGzK,UACC0K,cAAe,IACfC,aAAa,EACbC,aAAa,EACbC,OAAQ,EACRC,SACIC,UAAW,KACXC,cAAe,KACfC,UAAW3uC,OAAOC,aAAaC,YAAY,kCAC3C0uC,cAAe5uC,OAAOC,aAAaC,YAAY,uCAC/C2uC,QAAS7uC,OAAOC,aAAaC,YAAY,sCACzC4uC,OAAQ9uC,OAAOC,aAAaC,YAAY,qCACxC6uC,QAAS/uC,OAAOC,aAAaC,YAAY,sCACzC8uC,KAAMhvC,OAAOC,aAAaC,YAAY,mCACtC+uC,MAAOjvC,OAAOC,aAAaC,YAAY,oCACvCgvC,IAAKlvC,OAAOC,aAAaC,YAAY,kCACrC8e,KAAMhf,OAAOC,aAAaC,YAAY,mCACtC8pB,MAAOhqB,OAAOC,aAAaC,YAAY,oCACvC0pB,OAAQ5pB,OAAOC,aAAaC,YAAY,qCACxC4pB,KAAM9pB,OAAOC,aAAaC,YAAY,mCACtCivC,MAAOnvC,OAAOC,aAAaC,YAAY,oCACvCkvC,cAAe,IACfC,aAIJnB,aAAqB9nC,KACdkpC,EAAQpB,GACa,iBAAdA,GACdA,EAAYA,EAAUp2C,QAAQ,IAAK,KAC5Bw3C,EAAQh/C,EAAE29C,QAAQniC,MAAMoiC,KAExBoB,EADqB,iBAAdpB,EACC,IAAI9nC,KAAK8nC,GAET59C,EAAE29C,QAAQpE,SAASqE,KAG1C,IAAIC,EAAK79C,EAAE29C,QA0EX,SAASqB,EAAQrnB,GACb,OAAOkmB,EAAGmB,SAGIrnB,EAHaA,GAInB,IAAI7hB,MAAOC,UAAY4hB,EAAK5hB,YADxC,IAAkB4hB,EA5ElB33B,EAAEsJ,OAAOtJ,EAAE29C,SAKPqB,QAAS,SAAUC,GACf,IAAIC,EAAKr8C,KAAKuwC,SAAS8K,QACnBnc,EAASmd,EAAGf,UACZl+B,EAASi/B,EAAGb,UACZx7C,KAAKuwC,SAAS2K,aACVkB,EAAiB,IACjBld,EAASmd,EAAGd,cACZn+B,EAASi/B,EAAGZ,eAIpB,IAAIC,EAAUt0C,KAAKoT,IAAI4hC,GAAkB,IACrCR,EAAUF,EAAU,GACpBI,EAAQF,EAAU,GAClB/vB,EAAOiwB,EAAQ,GACfE,EAAQnwB,EAAO,IAEnB,SAASywB,EAAWC,EAAkB1zC,GAClC,IAAIiU,EAAS3f,EAAEq/C,WAAWD,GAAoBA,EAAiB1zC,EAAQuzC,GAAkBG,EACrF34C,EAASy4C,EAAGH,SAAWG,EAAGH,QAAQrzC,IAAYA,EAClD,OAAOiU,EAAOnY,QAAQ,MAAOf,GAGjC,IAAIkU,EAAQ4jC,EAAU,IAAMY,EAAWD,EAAGX,QAASt0C,KAAKmI,MAAMmsC,KAClDA,EAAU,IAAMY,EAAWD,EAAGV,OAAQ,IACtCC,EAAU,IAAMU,EAAWD,EAAGT,QAASx0C,KAAKmI,MAAMqsC,KAClDA,EAAU,IAAMU,EAAWD,EAAGR,KAAM,IACpCC,EAAQ,IAAMQ,EAAWD,EAAGP,MAAO10C,KAAKmI,MAAMusC,KAC9CA,EAAQ,IAAMQ,EAAWD,EAAGN,IAAK,IACjClwB,EAAO,IAAMywB,EAAWD,EAAGxwB,KAAMzkB,KAAKmI,MAAMsc,KAC5CA,EAAO,IAAMywB,EAAWD,EAAGxlB,MAAO,IAClChL,EAAO,KAAOywB,EAAWD,EAAG5lB,OAAQrvB,KAAKmI,MAAMsc,EAAO,MACtDmwB,EAAQ,KAAOM,EAAWD,EAAG1lB,KAAM,IACnC2lB,EAAWD,EAAGL,MAAO50C,KAAKmI,MAAMysC,IAExC3jB,EAAYgkB,EAAGJ,eAAiB,GAEpC,YADyB/zC,IAArBm0C,EAAGJ,gBAA+B5jB,EAAY,KAC3Cl7B,EAAE+f,MAAMgiB,EAAQpnB,EAAOsF,GAAQ1E,KAAK2f,KAK/C1f,MAAO,SAAU8jC,GACb,IAAI7lC,EAAIzZ,EAAE+f,KAAKu/B,GAMf,OADA7lC,GADAA,GADAA,GADAA,GADAA,EAAIA,EAAEjS,QAAQ,QAAS,KACjBA,QAAQ,IAAK,KAAKA,QAAQ,IAAK,MAC/BA,QAAQ,IAAK,KAAKA,QAAQ,IAAK,SAC/BA,QAAQ,wBAAyB,UACjCA,QAAQ,gBAAiB,SACxB,IAAIsO,KAAK2D,IAKpB8/B,SAAU,SAAUj0B,GAChB,IAAIg6B,EAAUzB,EAAG0B,OAAOj6B,GAAQtlB,EAAEslB,GAAMnhB,KAAK,YAAcnE,EAAEslB,GAAMnhB,KAAK,SACxE,OAAO05C,EAAGriC,MAAM8jC,IAKpBC,OAAQ,SAAUj6B,GAEd,MAAgD,SAAzCtlB,EAAEslB,GAAMpQ,IAAI,GAAG7B,QAAQC,iBA7G1C,CAyHGnE,QC5HH,SAAWnP,GACPA,EAAE6P,GAAG2vC,OAAS,SAAUtxC,GAEpB,IAAItL,EAAO5C,EAAE6C,OAEbqL,EAASA,OACFuxC,UAAYvxC,EAAOuxC,WAAa,EACvCvxC,EAAOwxC,UAAYxxC,EAAOwxC,WAAa,EAGvC,IAAIC,EAAYzxC,EAAOyxC,UAAuC,mBAApBzxC,EAAOyxC,SAA2BzxC,EAAOyxC,SAAW,aAI1FC,GAHkB1xC,EAAO2xC,gBAAmD,mBAA1B3xC,EAAO2xC,gBAAiC3xC,EAAO2xC,eAGzFj9C,EAAKuD,KAAK,sCAAsC6B,QAExD83C,EAAgBF,EAAM15C,WAAW6B,OAEjCg4C,EAAY//C,EAAE,wCAEdggD,EAAgB9xC,EAAOwxC,UAAYI,EAAiBA,EAAgB5xC,EAAOwxC,UAG3EO,EAAWh2C,KAAKC,MAAM,IAAMwC,OAAOszC,IAGvCJ,EAAM15C,WAAWxC,KAAK,SAAUC,EAAGmoC,GAC/BiU,EAAUt7C,OACN,0DAA4Dd,EAAI,yBAChEmoC,EAAK13B,aAAa,sBAAwB,WAC1C03B,EAAK5C,YAAc,mBAG3B6W,EAAU55C,KAAK,oBAAoBoB,IAAI,QAAS04C,EAAW,KAC3DF,EAAUt7C,OAAO,mGAEjB7B,EAAK64C,QAAQsE,GAEb,IAAIG,EAAat9C,EAAKuD,KAAK,+DAA+DquC,GAAGtmC,EAAOuxC,WAClFz/C,EAAEA,EAAEkgD,GAAYx/C,KAAK,iBAAkBkC,GAE7CsB,SAAS,kBACrBg8C,EAAWh8C,SAAS,eAGpB,IAAIu7C,EAAYz/C,EAAE,6BAA+BkO,EAAOuxC,UAAY,GAAK,IAAKM,GAAW77C,SAAS,eAG9Fi8C,EAAmBF,GAAY,IAAOA,EAAWD,GAGrD,SAASI,IACDlyC,EAAOwxC,UAAYI,GAEnB9/C,EAAE,8BAA+B4C,GAAM23C,QAAQr2C,SAAS,cACxD67C,EAAU77C,SAAS,cACnBu7C,EAAU33C,QAAQ,SAAWu4C,OAAQ,YAErCrgD,EAAE,8BAA+B4C,GAAM8lB,YAAY,cACnDq3B,EAAUr3B,YAAY,cACtBq3B,EAAU55C,KAAK,yBAAyBjC,SAAS,oBAqBzD,SAASo8C,EAAUxvC,EAAG5C,GAQlB,IANAA,EAASA,OACFmyC,OAASnyC,EAAOmyC,QAAU,SAEjCvvC,EAAEimC,kBACFjmC,EAAE4lC,kBAEE12C,EAAE6C,MAAMiyC,SAAS,gBAAoC,UAAlB5mC,EAAOmyC,OAA9C,CAIA,IA5BiBE,EAEbC,EACAC,EAyBAF,EAAUzvC,EAAE4vC,cAActsC,aAAa,sBACvCusC,EAAc3gD,EAAEugD,EAAS39C,GAE7B68C,EAAYz/C,EAAE8Q,EAAE4vC,eAEhB99C,EAAKuD,KAAK,uBAAuBuiB,YAAY,kBAC7Ci4B,EAAYz8C,SAAS,kBAGrB67C,EAAU55C,KAAK,oBAAoBuiB,YAAY,eAAenhB,IAAI,QAAS04C,EAAW,KAEzD,UAAzBL,EAAMr4C,IAAI,YACVq4C,EAAMgB,SAGN1yC,EAAOmyC,QAA4B,UAAlBnyC,EAAOmyC,SACxBZ,EAAYz/C,EAAE,wBAA0BugD,EAAU,KAAMR,GA5C3CQ,EA6CDA,EA3CZC,EAAWT,EAAU55C,KAAK,kBAC1Bs6C,GAAe,EAEnBD,EAAS98C,KAAK,SAAUC,EAAGmoC,GACnByU,IAAYzU,EAAK13B,aAAa,uBAAyBqsC,GACvDV,EAAU19C,OAAO,wBAA0Bk+C,EAAU,MACrDR,EAAUt7C,OAAOqnC,IAEjB2U,GAAe,KAuCvBhB,EAAUv7C,SAAS,eAAeqD,IAAI,QAAS44C,EAAmB,KAClER,EAAS7uC,EAAG5C,IAlEhBuxC,EAAUl4C,IAAI,QAAS44C,EAAmB,UAqEN,IAAxBjyC,EAAkB,YAE1BlO,EAAEqM,KAAK6B,EAAO2yC,aAAa71C,KAAK,WAC5Bo1C,MAGJA,IAIJx9C,EAAKuD,KAAK,+BAA+Bo0C,QAAQ1yC,KAAK,QAAS,SAAU0hB,GAGrE,IAAIu3B,EAAef,EAAUgB,aAAe,GACxCC,EAAa,EAGjBhhD,EAAE,2BAA4B4/C,GAAOl3B,YAAY,QAEjDq3B,EAAU55C,KAAK,kBAAkBzC,KAAK,SAAUC,EAAGmoC,IAE/CkV,GAAchhD,EAAE,eAAgB8rC,GAAMkJ,cAGrB8L,GAEblB,EAAM15C,WAAWxC,KAAK,SAAUyB,EAAG87C,GAC/B,GAAIA,EAAI/X,cAAgB4C,EAAK5C,YAKzB,OAJAlpC,EAAEihD,GAAK/8C,SAAS,QAChBlE,EAAE,iCAAiCuH,IAAI,gBAAiB,SACxDvH,EAAE,sCAAsC46C,OAAOrzC,IAAI,gBAAiB,YAQpFgiB,EAAMwtB,kBACNxtB,EAAMmtB,iBACNkJ,EAAMgB,WAGV5gD,EAAE,YAAa4/C,GAAO/3C,KAAK,QAAS,SAAUiJ,GAC1CwvC,EAAUxvC,GAAKuvC,OAAQ,YAG3BrgD,EAAE,iBAAkB+/C,GAAWl4C,KAAK,QAASy4C,GAE7CP,EAAUl4C,KAAK,eAAgB,WAC3Bu4C,OAxKZ,CA2KGjxC,QCnLH,SAAWnP,GACPA,EAAE6P,GAAGqxC,SAAW,SAAUhhD,IACtBA,EAAUA,OACFghD,SAAWhhD,EAAQghD,UAAY,GACvChhD,EAAQihD,SAA6B,IAAhBjhD,EAAQihD,KAAuC,KAAhBjhD,EAAQihD,IAAajhD,EAAQihD,IAAM,UAEvF,IAWIjgD,EAAW42B,MAAM52B,SAVjB,qWAUkC66C,cAAc,IAChDqF,EAAQphD,EAAEkB,EAAShB,IAEvBF,EAAE6C,MAAMgF,KAAK,QAAS,WAClB7H,EAAE,QAAQyE,OAAO28C,GACjBphD,EAAE,QAAQuH,IAAI,WAAY,SAC1BvH,EAAE,IAAKohD,GAAOlsC,IAAI,GAAGg1B,QACrBlqC,EAAE,aAAcohD,GAAOv5C,KAAK,QAAS,WACjCu5C,EAAM/+C,SACNrC,EAAE,QAAQuH,IAAI,WAAY,MAE9BvH,EAAE,IAAKohD,GAAOv5C,KAAK,OAAQ,WACvB7H,EAAE,aAAcohD,GAAO90B,UAE3B80B,EAAMl9C,SAAS,aA/B3B,CAkCGiL,QC9BHO,OAAO2xC,YAAqC,IAAnB3xC,OAAa,OAAqBA,OAAO2xC,UAClE3xC,OAAO2xC,OAAOC,cAAgD,IAA5B5xC,OAAO2xC,OAAe,SAAqB3xC,OAAO2xC,OAAOC,YAC3F5xC,OAAO2xC,OAAOC,SAASC,aAGvB7xC,OAAO2xC,OAAOC,SAASE,aAAe,SAAUtzC,GAE5C,IAAIuzC,EAAwB,uBACxBC,EAA8B,8BAC9BC,EAA4B,2BAC5BC,EAAwB,uBACxBC,EAA6B,4BAC7BC,EAA0B,yBAG9B,MAAsB,YAAlB5zC,EAAOsD,SAEHuwC,gBAAiB7zC,EAAO8zC,YAAcP,EACtCQ,mBAAoB/zC,EAAO8zC,YAAcP,EACzCS,0BAA2Bh0C,EAAO8zC,YAAcN,EAChDS,0BAA2Bj0C,EAAO8zC,YAAcP,EAChDW,qBAAsBl0C,EAAO8zC,YAAcH,EAC3CQ,6BAA8Bn0C,EAAO8zC,YAAc,sEACnDM,yBAA0Bp0C,EAAO8zC,YAAcL,EAC/CY,wBAAyBr0C,EAAO8zC,YAAcN,EAC9Cc,2BAA4Bt0C,EAAO8zC,YAAcP,EACjDgB,wBAAyBv0C,EAAO8zC,YAAcF,EAC9CY,8BAA+Bx0C,EAAO8zC,YAdL,oCAejCW,uBAAwBz0C,EAAO8zC,YAAcP,EAC7CmB,uBAAwB10C,EAAO8zC,YAAcP,EAC7CoB,sBAAuB30C,EAAO8zC,YAAcP,EAC5CqB,2BAA4B50C,EAAO8zC,YAAcP,EACjDsB,yBAA0B70C,EAAO8zC,YAAcP,EAC/CuB,6BAA8B90C,EAAO8zC,YAAcP,EACnDwB,qBAAsB/0C,EAAO8zC,YAAcP,EAC3CyB,gCAAiCh1C,EAAO8zC,YAAcP,EACtD0B,8BAA+Bj1C,EAAO8zC,YAAc,wDACpDoB,8BAA+Bl1C,EAAO8zC,YAAcP,EAAwB,0BAC5E4B,6BAA8Bn1C,EAAO8zC,YAAc,sBACnDsB,gCAAiCp1C,EAAO8zC,YAAcJ,EACtD2B,4BAA6Br1C,EAAO8zC,YAAcJ,EAClD4B,yBAA0Bt1C,EAAO8zC,YAAcP,EAC/CgC,8BAA+Bv1C,EAAO8zC,YAAc,uEACpD0B,8BAA+Bx1C,EAAO8zC,YAAc,+DACpD2B,2BAA4Bz1C,EAAO8zC,YAAc,uCACjD4B,uCAAwC11C,EAAO8zC,YAAc,mDAC7D6B,6BAA8B31C,EAAO8zC,YAAc,8BACnD8B,gCAAiC51C,EAAO8zC,YAAc,8BACtD+B,+BAAgC71C,EAAO8zC,YAAc,sDACrDgC,sCAAuC91C,EAAO8zC,YAAc,qLAA4LtyC,OAAOu0C,eAC/PC,oCAAqCh2C,EAAO8zC,YAAc,iEAC1DmC,8BAA+Bj2C,EAAO8zC,YAAc,kCACpDoC,oCAAqCl2C,EAAO8zC,YAAc,kCAC1DqC,gCAAiCn2C,EAAO8zC,YAAc,oCACtDsC,4BAA6Bp2C,EAAO8zC,YAAc,gCAClDuC,kCAAmCr2C,EAAO8zC,YAAc,oCACxDwC,qBAAsBt2C,EAAO8zC,YAAc,yBAC3CyC,qCAAsCv2C,EAAO8zC,YAAc,wCAC3D0C,qCAAsCx2C,EAAO8zC,YAAc,wCAC3D2C,+BAAgCz2C,EAAO8zC,YAAc,iCACrD4C,qBAAsB12C,EAAO8zC,YAAc,kCAE3C6C,kBAAmB32C,EAAO8zC,YAAc,uBACxC8C,kCAAmC52C,EAAO8zC,YAAc,uCACxD+C,sBAAuB72C,EAAO8zC,YAAc,4BAI9B,cAAlB9zC,EAAOsD,SAA6C,UAAlBtD,EAAOsD,cACK,IAAlCtD,EAA4B,uBAAmB82C,MAAM,6FAE7DjD,gBAAiB7zC,EAAO+2C,sBAAwBxD,EAChDQ,mBAAoB/zC,EAAO+2C,sBAAwBxD,EACnDS,0BAA2Bh0C,EAAO+2C,sBAAwBvD,EAC1DS,0BAA2Bj0C,EAAO+2C,sBAAwBxD,EAC1DW,qBAAsBl0C,EAAO+2C,sBAAwBpD,EACrDQ,6BAA8B,sEAC9BC,yBAA0Bp0C,EAAO+2C,sBAAwBtD,EACzDY,wBAAyBr0C,EAAO+2C,sBAAwBvD,EACxDc,2BAA4Bt0C,EAAO+2C,sBAAwBxD,EAC3DgB,wBAAyBv0C,EAAO+2C,sBAAwBnD,EACxDa,uBAAwBz0C,EAAO+2C,sBAAwBxD,EACvDmB,uBAAwB10C,EAAO+2C,sBAAwBxD,EACvDoB,sBAAuB30C,EAAO+2C,sBAAwBxD,EACtDqB,2BAA4B50C,EAAO+2C,sBAAwBxD,EAC3DsB,yBAA0B70C,EAAO+2C,sBAAwBxD,EACzDuB,6BAA8B90C,EAAO+2C,sBAAwBxD,EAC7DwB,qBAAsB/0C,EAAO+2C,sBAAwBxD,EACrDyB,gCAAiCh1C,EAAO8zC,YAAcP,EACtD0B,8BAA+B,qDAC/BC,8BAA+Bl1C,EAAO+2C,sBAAwBxD,EAAwB,0BACtF4B,6BAA8Bn1C,EAAO+2C,sBAAwB,sBAC7D3B,gCAAiCp1C,EAAO+2C,sBAAwBrD,EAChE2B,4BAA6Br1C,EAAO+2C,sBAAwBrD,EAC5D4B,yBAA0Bt1C,EAAO+2C,sBAAwBxD,EACzDgC,8BAA+B,qDAC/BC,8BAA+Bx1C,EAAO+2C,sBAAwB,+DAC9DtB,2BAA4Bz1C,EAAO+2C,sBAAwB,uCAC3DrB,uCAAwC11C,EAAO+2C,sBAAwB,mDACvEpB,6BAA8B31C,EAAO8zC,YAAc,8BACnD8B,gCAAiC51C,EAAO8zC,YAAc,8BACtD+B,+BAAgC71C,EAAO8zC,YAAc,sDACrDgC,sCAAuC91C,EAAO8zC,YAAc,qLAA4LtyC,OAAOu0C,eAC/PE,8BAA+Bj2C,EAAO+2C,sBAAwB,8BAC9Db,oCAAqCl2C,EAAO+2C,sBAAwB,kCACpEX,4BAA6Bp2C,EAAO+2C,sBAAwB,gCAC5DV,kCAAmCr2C,EAAO8zC,YAAc,sCAI1C,oBAAlB9zC,EAAOsD,SAEHuwC,gBAAiB7zC,EAAO8zC,YAAcP,EAAwB,wBAC9DQ,mBAAoB/zC,EAAO8zC,YAAcP,EAAwB,wBACjES,0BAA2Bh0C,EAAO8zC,YAAcN,EAA8B,wBAC9ES,0BAA2Bj0C,EAAO8zC,YAAcP,EAAwB,wBACxEY,6BAA8B,sEAC9BC,yBAA0Bp0C,EAAO8zC,YAAcL,EAA4B,wBAC3EY,wBAAyBr0C,EAAO8zC,YAAcN,EAA8B,wBAC5Ec,2BAA4Bt0C,EAAO8zC,YAAcP,EAAwB,wBACzEkB,uBAAwBz0C,EAAO8zC,YAAcP,EAAwB,wBACrEmB,uBAAwB10C,EAAO8zC,YAAcP,EAAwB,wBACrEoB,sBAAuB30C,EAAO8zC,YAAcP,EAAwB,wBACpEqB,2BAA4B50C,EAAO8zC,YAAcP,EAAwB,wBACzEsB,yBAA0B70C,EAAO8zC,YAAcP,EAAwB,wBACvEuB,6BAA8B90C,EAAO8zC,YAAcP,EAAwB,wBAC3E0B,8BAA+B,wDAC/BC,8BAA+Bl1C,EAAO8zC,YAAcP,EAAwB,0BAC5E4B,6BAA8Bn1C,EAAO8zC,YAAc,2CACnDsB,gCAAiCp1C,EAAO8zC,YAAcJ,EAAwB,wBAC9E2B,4BAA6Br1C,EAAO8zC,YAAcJ,EAAwB,wBAC1E4B,yBAA0Bt1C,EAAO8zC,YAAcP,EAAwB,wBACvEgC,8BAA+B,wEAIjB,UAAlBv1C,EAAOsD,SAEHuwC,gBAAiB7zC,EAAO8zC,YAAcP,EAAwB,0BAC9DQ,mBAAoB/zC,EAAO8zC,YAAcP,EAAwB,0BACjES,0BAA2Bh0C,EAAO8zC,YAAcN,EAA8B,0BAC9ES,0BAA2Bj0C,EAAO8zC,YAAcP,EAAwB,0BACxEY,6BAA8B,sEAC9BC,yBAA0Bp0C,EAAO8zC,YAAcL,EAA4B,0BAC3EY,wBAAyBr0C,EAAO8zC,YAAcN,EAA8B,0BAC5Ec,2BAA4Bt0C,EAAO8zC,YAAcP,EAAwB,0BACzEkB,uBAAwBz0C,EAAO8zC,YAAcP,EAAwB,0BACrEmB,uBAAwB10C,EAAO8zC,YAAcP,EAAwB,0BACrEoB,sBAAuB30C,EAAO8zC,YAAcP,EAAwB,0BACpEqB,2BAA4B50C,EAAO8zC,YAAcP,EAAwB,0BACzEsB,yBAA0B70C,EAAO8zC,YAAcP,EAAwB,0BACvEuB,6BAA8B90C,EAAO8zC,YAAcP,EAAwB,0BAC3E0B,8BAA+B,wDAC/BC,8BAA+Bl1C,EAAO8zC,YAAcP,EAAwB,0BAC5E4B,6BAA8Bn1C,EAAO8zC,YAAc,6CACnDsB,gCAAiCp1C,EAAO8zC,YAAcJ,EAAwB,0BAC9E2B,4BAA6Br1C,EAAO8zC,YAAcJ,EAAwB,0BAC1E4B,yBAA0Bt1C,EAAO8zC,YAAcP,EAAwB,0BACvEgC,8BAA+B,4EChK3CzjD,EAAEklD,MAAM57C,OAAO,qCAIX+Q,KAAM,SAAUnM,GACZrL,KAAK2O,QAAUtD,EAAOsD,QACtB3O,KAAK0+C,UAAY7xC,OAAO2xC,OAAOC,SAASE,aAAatzC,GACrDrL,KAAKm/C,YAAetyC,OAAOY,KAAKqT,QAAQzV,EAAO8zC,aAAoC,GAArB9zC,EAAO8zC,aAMzEmD,OAAQ,SAAUC,GAId,OAH+B,MAA3BviD,KAAK0+C,UAAU6D,IACfJ,MAAM,4BAA8BI,GAEjCviD,KAAK0+C,UAAU6D,IAG1BC,eAAgB,SAASn3C,GACrBrL,KAAKm/C,YAAetyC,OAAOY,KAAKqT,QAAQzV,EAAO8zC,aAAoC,GAArB9zC,EAAO8zC,YACrEn/C,KAAK0+C,UAAY7xC,OAAO2xC,OAAOC,SAASE,aAAatzC,MCtB7DlO,EAAEklD,MAAM57C,OAAO,kCAGPg8C,2BAA4B,KAC5BC,4BAA6B,KAC7BC,cAAe,gBAMfnrC,KAAM,SAASnM,IACXA,EAASA,OACFsD,QAAUtD,EAAOsD,SAAW,WACnCtD,EAAO8zC,YAAetyC,OAAOY,KAAKqT,QAAQzV,EAAO8zC,aAAoC,GAArB9zC,EAAO8zC,YACvEn/C,KAAK4iD,eAAiB,IAAI/1C,OAAO2xC,OAAOC,SAAS9vC,QAAQtD,GACzDrL,KAAK6iD,mBAAqB,IAAIh2C,OAAO2xC,OAAOC,SAASqE,mBAAmB9iD,MACxEA,KAAK0rC,KAAOtkC,KAAKskC,OAEb7+B,OAAOwkB,SAAS0xB,+BAChB/iD,KAAKgjD,2BAA6B,IAAIn2C,OAAO2xC,OAAOC,SAASwE,2BAA2BjjD,OAI5FA,KAAKkjD,qBAELljD,KAAKmjD,WAAa93C,EAAO83C,aAAet2C,OAAOY,KAAK6yB,qBAAuBzzB,OAAOwD,WAAWxC,WAAahB,OAAOY,KAAK0yB,iBAAmBtzB,OAAOwD,WAAWzB,OAAQ/B,OAAOwD,WAAW+yC,SACrLpjD,KAAKqjD,WAAax2C,OAAOY,KAAKo8B,iBAKlCyZ,YAAa,WACT,OAAOtjD,KAAK6iD,oBAGhBU,uBAAwB,WACpB,OAAO12C,OAAOwkB,SAAS0xB,6BAA+B/iD,KAAKgjD,2BAA4BhjD,MAU3FwjD,YAAa,SAASn4C,GAClB,IAAItL,EAAOC,KAGX,GAAIqL,GAAUA,EAAOxN,KACjB,OAAOwN,EAAOxN,KAIlBwN,EAASA,MACT,IAAIxN,KA4DJ,GA3DAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAYr3C,EAAOD,QAAU,WAC3EvN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgB3iD,EAAKojD,WACnEtlD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgB3iD,EAAKsjD,WAE/Dh4C,EAAOo4C,YACP5lD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,aAAer3C,EAAOo4C,WACpEp4C,EAAOq4C,SACP7lD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAYr3C,EAAOq4C,QACjEr4C,EAAOs4C,WACP9lD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOs4C,UACnEt4C,EAAOu4C,eACP/lD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOu4C,cACvEv4C,EAAOw4C,WACPhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,UACnEx4C,EAAOy4C,eACPjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cACvEz4C,EAAO04C,gBACPlmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,iBAAmBr3C,EAAO04C,eACxE14C,EAAO24C,cACPnmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO24C,aACtE34C,EAAO44C,cACPpmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO44C,aACtE54C,EAAOw6B,SACPhoC,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAYr3C,EAAOw6B,QACjEx6B,EAAO64C,aACPrmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAO64C,YACrE74C,EAAO84C,SACPtmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAYr3C,EAAO84C,QACjE94C,EAAO+4C,cACPvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,aACjF/4C,EAAOg5C,cACPxmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAOg5C,aACtEh5C,EAAOi5C,aACPzmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAOi5C,YACpEz3C,OAAOY,KAAKqT,QAAQzV,EAAOk5C,aAC5B1mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,aAAer3C,EAAOk5C,WACpEl5C,EAAOm5C,oBACP3mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,qBAAuBr3C,EAAOm5C,mBAC5En5C,EAAOo5C,mBACP5mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,oBAAsBr3C,EAAOo5C,kBAC3Ep5C,EAAOq5C,eACP7mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOq5C,mBACxC,IAAxBr5C,EAAOs5C,eACd9mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOs5C,mBACxC,IAAxBt5C,EAAOu5C,eACd/mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,aAAer3C,EAAOu5C,mBACtC,IAAvBv5C,EAAOw5C,cACdhnD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,uBAAyBr3C,EAAOw5C,aAC9Ex5C,EAAOqgC,OACP7tC,EAAKkC,EAAKsiD,MAAMK,4BAA8B,QAAUr3C,EAAOqgC,MAC/DrgC,EAAOy5C,sBACPjnD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,uBAAyB,IAEnD,IAApBr3C,EAAO05C,WACPlnD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,0BAA2B,GAKzEr3C,EAAOu5C,aAAc,CAErB,IAAII,EAA0B,OAE1B35C,EAAOtL,EAAKsiD,MAAMI,2BAA6BuC,EAA0B,UACzEnnD,EAAKkC,EAAKsiD,MAAMI,2BAA6BuC,EAA0B,QAAU35C,EAAOtL,EAAKsiD,MAAMI,2BAA6BuC,EAA0B,SAKlK,OAAI35C,EAAO45C,QACApnD,GAIXgP,OAAOq4C,OAAOC,aAAa,QACpBhoD,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,iBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAah6C,EAAOD,QAAU,SAE7B6E,KAAK,SAASq1C,GAIX,GAHAz4C,OAAOq4C,OAAOK,WAAW,QAGrBl6C,EAAOu5C,aACP,IACIU,EAASE,KAAK9yC,WAAWqyC,SAAW,QAEpC,IAAIU,EAA8B,SAAS3xC,GACvC,OAAa,MAATA,EACOA,GAEPA,EAAMyD,eAAe,SAAyB,QAAdzD,EAAM7J,MACtC6J,EAAMxW,GAAKO,EAAKP,GAAK,SACrBwW,EAAM4xC,SAAW,QACjB5xC,EAAM6xC,YAAc,QACpB7xC,EAAM8xC,UAAY,QAClB9xC,EAAM+xC,cAAgB,QACtB/xC,EAAMpU,UAAY,QAClBoU,EAAMgyC,YAAc,SAEpB3oD,EAAE0D,KAAKhD,EAAM,SAASkD,EAAK6C,GACD,iBAAX,IACPkQ,EAAM/S,GAAO0kD,EAA4B3xC,EAAM/S,OAIpD+S,IAEXwxC,EAAWG,EAA4BH,GACzC,MAAOr3C,IAIb,OAAOq3C,MAOnBS,kBAAmB,SAAS16C,GACxB,IAAItL,EAAOC,KAGXqL,EAASA,MACT,IAAIxN,KAcJ,OAbAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,aACtDr3C,EAAOwV,QACPhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,OAChExV,EAAOw4C,WACPhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,UACnEx4C,EAAOy4C,eACPjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cACvEz4C,EAAO26C,eACPnoD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,cAAgBp3C,EAAO26C,cACpE36C,EAAO+4C,cACPvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,aAGjF/4C,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,+BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,gBAIrBY,kBAAmB,SAASpoD,GACxB,IAAIs2C,EAEJ,IAAKA,KADLt2C,EAAOV,EAAEsJ,QAAO,KAAU5I,GAElBA,EAAK0Z,eAAe48B,IAAyB,UAAnBh3C,EAAE8M,KAAKpM,EAAKs2C,KAElCt2C,EAAKs2C,GAAG58B,eAAe,QACvB1Z,EAAKs2C,GAAKt2C,EAAKs2C,GAAG72C,IAI9B,OAAOO,GAKXqoD,WAAY,SAAS76C,GACjB,IAAItL,EAAOC,KAGXnC,KAAOkC,EAAKomD,YAAY96C,EAAOxN,SAAYwN,EAAOy4C,cAClDjmD,KAAOkC,EAAKkmD,kBAAkBpoD,MAE9BA,KAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAYr3C,EAAOD,QAGjEC,EAASA,OACEwV,QACPhjB,KAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,OAChExV,EAAOw4C,WACPhmD,KAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,UACnEx4C,EAAOy4C,eACPjmD,KAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cACvEz4C,EAAO+4C,cACPvmD,KAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,aACjF/4C,EAAOi5C,aACPzmD,KAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAOi5C,YACrEj5C,EAAO+6C,cACPvoD,KAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aACtE/6C,EAAOg7C,cACPxoD,KAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAOg7C,aACtEh7C,EAAOi7C,eACPzoD,KAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOi7C,cACvEj7C,EAAOk7C,sBACP1oD,KAAKkC,EAAKsiD,MAAMK,4BAA8B,uBAAyBr3C,EAAOk7C,qBAKlF,IAAIC,EAAan7C,EAAOD,OAAO0F,WAAWqL,cAM1C,OAHAtP,OAAO45C,MAAM,YAAa5oD,MAGtBwN,EAAO45C,QACApnD,KAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,oBAC9CzkD,KAAMA,KACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAamB,KAMrBL,YAAa,SAAStoD,EAAMimD,GACxB,IAAI7iD,EAAMylD,EAAS9iD,EACnB,IAAKzG,EAAE4jB,cAAcljB,IAASimD,IACiB,IAAvCA,EAAahT,OAAO,cACpB,IAAK7vC,KAAQpD,GAC0B,IAA/BoD,EAAK6vC,OAAO,eAAwBgT,GAAgB7iD,EAAK2X,OAAO,EAAG3X,EAAK6vC,OAAO,MAAQ,KACvF4V,EAAUzlD,EAAK2X,OAAO3X,EAAK6vC,OAAO,MAAQ,GAC1CltC,EAAQ/F,EAAKoD,GACbpD,EAAK6oD,GAAW9iD,SACT/F,EAAKoD,IAK5B,OAAOpD,GAUX8oD,gBAAiB,SAASt7C,GACtB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAmDlB,OAlDA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,uBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAO6V,SAEnE7V,EAAOw7C,YACPhpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAep3C,EAAOw7C,WACnEx7C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aACtE/6C,EAAOy7C,aACPjpD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAOy7C,YACrEz7C,EAAOi7C,eACPzoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOi7C,cACvEj7C,EAAO07C,SACPlpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,SAAWp3C,EAAO07C,QAC/D17C,EAAO27C,QACPnpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,QAAUp3C,EAAO27C,OAC9D37C,EAAO47C,QACPppD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,QAAUp3C,EAAO47C,OAC5C/+C,MAAlBmD,EAAO67C,SAA0C,MAAlB77C,EAAO67C,UACtCrpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,UAAYp3C,EAAO67C,SAGhDh/C,MAAhBmD,EAAO87C,OAAsC,MAAhB97C,EAAO87C,QACpCtpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,QAAUp3C,EAAO87C,OAC9D97C,EAAO+7C,SACPvpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,SAAWp3C,EAAO+7C,QAC/D/7C,EAAOg8C,UACPxpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,UAAYp3C,EAAOg8C,SAChEh8C,EAAOi8C,cACPzpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,cAAgBp3C,EAAOi8C,aACpEj8C,EAAOk8C,iBACP1pD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,iBAAmBp3C,EAAOk8C,gBAEvEl8C,EAAOm8C,eACP3pD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,eAAiBp3C,EAAOm8C,cAErEn8C,EAAOo8C,gBACP5pD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,gBAAkBp3C,EAAOo8C,eAEtEp8C,EAAOq8C,cACP7pD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,cAAgBp3C,EAAOq8C,aAIxE76C,OAAO45C,MAAM,yBAA2Bp7C,EAAOwV,MAAQ,IAAKhjB,GAGxDwN,EAAO45C,QACApnD,EAKJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,2BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAUhpB,EAAOgpB,UAAY,OAC7BgxB,YAAa,uBACbsC,WAAY,SAASC,EAAK3rB,GACtBpvB,OAAOg7C,sBAAwBh7C,OAAOg7C,0BACtCh7C,OAAOg7C,sBAAsBj/C,KAAKg/C,OAY9CxlD,QAAS,SAASiJ,GACd,OAAOrL,KAAK2mD,gBAAgBxpD,EAAEsJ,OAAO4E,GACjC6V,SAAU,WAYlB4mC,cAAe,SAASz8C,GAKpB,OAHAA,EAAOu7C,MAAQv7C,EAAOu7C,UACtBv7C,EAAOu7C,MAFI5mD,KAEOqiD,MAAMI,2BAA6B,QAAUp3C,EAAO69B,KAE/DlpC,KAAK2mD,gBAAgBxpD,EAAEsJ,OAAO4E,GACjC6V,SAAU,WASlB6mC,gBAAiB,SAAS18C,GAMtB,OAJAA,EAAOu7C,MAAQv7C,EAAOu7C,UAEtBv7C,EAAOu7C,MAHI5mD,KAGOqiD,MAAMI,2BAA6B,iBAAmBp3C,EAAOzN,cAExEoC,KAAK2mD,gBAAgBxpD,EAAEsJ,OAAO4E,GACjC6V,SAAU,oBAelB8mC,YAAa,SAAS38C,GAClB,IAAItL,EAAOC,KAUX,OATAqL,EAAOu7C,MAAQv7C,EAAOu7C,UAEtBv7C,EAAOu7C,MAAM7mD,EAAKsiD,MAAMI,2BAA6B,QAAUp3C,EAAOkyB,KACtElyB,EAAOu7C,MAAM7mD,EAAKsiD,MAAMI,2BAA6B,SAAWp3C,EAAO48C,MACvE58C,EAAOu7C,MAAM7mD,EAAKsiD,MAAMI,2BAA6B,QAAUp3C,EAAOnL,KACtEmL,EAAOu7C,MAAM7mD,EAAKsiD,MAAMI,2BAA6B,QAAUp3C,EAAOhJ,KACtEgJ,EAAOu7C,MAAM7mD,EAAKsiD,MAAMI,2BAA6B,gBAAkBp3C,EAAO68C,aAC9E78C,EAAOu7C,MAAM7mD,EAAKsiD,MAAMI,2BAA6B,SAAWp3C,EAAOzH,MAEhE5D,KAAK2mD,gBAAgBxpD,EAAEsJ,OAAO4E,GACjC6V,SAAU,WAIlBinC,8BAA+B,SAAS98C,GAMpC,OAJAA,EAAOu7C,MAAQv7C,EAAOu7C,UACtBv7C,EAAOu7C,MAFI5mD,KAEOqiD,MAAMI,2BAA6B,QAAUp3C,EAAOhJ,KACtEgJ,EAAOu7C,MAHI5mD,KAGOqiD,MAAMI,2BAA6B,SAAWp3C,EAAOzH,MACvEyH,EAAOu7C,MAJI5mD,KAIOqiD,MAAMI,2BAA6B,eAAiBp3C,EAAO+8C,YACtEpoD,KAAK2mD,gBAAgBxpD,EAAEsJ,OAAO4E,GACjC6V,SAAU,yBAOlBmnC,qBAAsB,WAClB,OAAOx7C,OAAO4xC,SAAS2G,KAAKkD,WAAatoD,KAAK4iD,eAAeN,OAAO,+BAKxEiG,iBAAkB,SAASl9C,GACvB,IAAItL,EAAOC,KACP0jB,EAAM1jB,KAAK4iD,eAAeN,OAAO,0BACjCzkD,KAUJ,OATAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,uBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkB,cAChE7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,UAAYp3C,EAAOm9C,OAChE3qD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAep3C,EAAOw7C,UAClEx7C,EAAkB,cAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aACtFrmD,EAAK0oD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,GAAQ,SAAWgP,OAAOu0C,gBAGtHsH,uBAAwB,SAASr9C,GAC7B,IAAItL,EAAOC,KACP0jB,EAAM1jB,KAAK4iD,eAAeN,OAAO,0BACjCzkD,KAiBJ,OAfAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,+BAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkB,cAChE7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMI,2BAA6B,UAAYp3C,EAAOm9C,OAC5Dn9C,EAAOs9C,gCACP9qD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAep3C,EAAOw7C,UACnEhpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,gBAAkBp3C,EAAOu9C,eAEtE/qD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOi7C,aACvEzoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAOy7C,YAGlE/mD,EAAK0oD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,GAAQ,SAAWgP,OAAOu0C,gBAMtHyH,gBAAiB,WACb,IACInlC,EAAM1jB,KAAK4iD,eAAeN,OAAO,yBACjCzkD,KAGJ,OAFAA,EAHWmC,KAGDqiD,MAAMK,4BAA8B,UAAY,UAH/C1iD,KAKCyoD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,IAK5FirD,oBAAqB,SAASC,GAC1B,IACIrlC,EAAM1jB,KAAK4iD,eAAeN,OAAO,2BACjCzkD,KAIJ,OAFAA,EAJWmC,KAIDqiD,MAAMK,4BAA8B,WAAmC,IAAtBqG,EAA8B,gBAAkB,WAJhG/oD,KAMCyoD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,IAG5FmrD,YAAa,SAAS39C,GAClB,IAAItL,EAAOC,KAEPnC,EAAOwN,EAAOu7C,UAYlB,OAXA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,kBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAChF/4C,EAAkB,cAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAG7Fv5C,OAAO45C,MAAM,mBAAqBp7C,EAAOwV,MAAQ,IAAKhjB,GAGlDwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,4BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAOlB40B,iBAAkB,SAAS59C,GACvB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAYlB,OAXA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,iBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAChF/4C,EAAkB,cAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAG7Fv5C,OAAO45C,MAAM,4BAA8Bp7C,EAAOwV,MAAQ,IAAKhjB,GAG3DwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,4BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAOlB60B,eAAgB,SAAS79C,GACrB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAclB,OAbA/oD,EAAKuN,OAAS,iBACdvN,EAAKsrD,aAAe99C,EAAO89C,aAC3BtrD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aAC3BjmD,EAAKurD,MAAQ/9C,EAAO+9C,MACpBvrD,EAAKwrD,SAAWh+C,EAAOg+C,SACnBh+C,EAAOw7C,YACPhpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAep3C,EAAOw7C,WAGvEh6C,OAAO45C,MAAM,sBAAwBp7C,EAAO+9C,MAAQ,IAAKvrD,GAGrDwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,yBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVi1B,aACIC,WAAW,EACXC,OAAQ,aAAezpD,EAAK2rC,SAQxC+d,aAAc,SAASp+C,GACnB,IAGIxN,EAAOwN,EAAOu7C,UAalB,OAZA/oD,EAAKuN,OAAS,eACdvN,EAAKsrD,aAAe99C,EAAO89C,aAC3BtrD,EAAKurD,MAAQ/9C,EAAO+9C,MACpBvrD,EAAKwrD,SAAWh+C,EAAOg+C,SACvBxrD,EARWmC,KAQDqiD,MAAMK,4BARL1iD,KAQwCqiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aAI3Bj3C,OAAO45C,MAAM,kBAAoBp7C,EAAO+9C,MAAQ,IAAKvrD,GAGjDwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KArBL1jB,KAqBiB4iD,eAAeN,OAAO,yBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAMlBq1B,eAAgB,SAASr+C,GACrB,IAGIxN,EAAOwN,EAAOu7C,UAYlB,OAXA/oD,EAAKuN,OAAS,iBACdvN,EAAKsrD,aAAe99C,EAAO89C,aAC3BtrD,EAAKurD,MAAQ/9C,EAAO+9C,MACpBvrD,EAAKwrD,SAAWh+C,EAAOg+C,SACvBxrD,EARWmC,KAQDqiD,MAAMK,4BARL1iD,KAQwCqiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aAG3Bj3C,OAAO45C,MAAM,kBAAoBp7C,EAAO+9C,MAAQ,IAAKvrD,GAGjDwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KApBL1jB,KAoBiB4iD,eAAeN,OAAO,yBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAMlBs1B,cAAe,SAASt+C,GACpB,IAGIxN,EAAOwN,EAAOu7C,UAYlB,OAXA/oD,EAAKuN,OAAS,SACdvN,EAAKsrD,aAAe99C,EAAO89C,aAC3BtrD,EAAKurD,MAAQ/9C,EAAO+9C,MACpBvrD,EAAKwrD,SAAWh+C,EAAOg+C,SACvBxrD,EARWmC,KAQDqiD,MAAMK,4BARL1iD,KAQwCqiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aAG3Bj3C,OAAO45C,MAAM,eAAiBp7C,EAAO+9C,MAAQ,IAAKvrD,GAG9CwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KApBL1jB,KAoBiB4iD,eAAeN,OAAO,yBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAMlBu1B,qBAAsB,SAASv+C,GAC3B,IAGIxN,EAAOwN,EAAOu7C,UAclB,OAbA/oD,EAAKuN,OAAS,uBACdvN,EAAKsrD,aAAe99C,EAAO89C,aAC3BtrD,EAAKurD,MAAQ/9C,EAAO+9C,MACpBvrD,EAAKwrD,SAAWh+C,EAAOg+C,SAEvBxrD,EAAKgsD,WAAax+C,EAAOw+C,WACzBhsD,EAVWmC,KAUDqiD,MAAMK,4BAVL1iD,KAUwCqiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aAG3Bj3C,OAAO45C,MAAM,wBAA0Bp7C,EAAO+9C,MAAQ,IAAKvrD,GAGvDwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAtBL1jB,KAsBiB4iD,eAAeN,OAAO,yBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAMlBy1B,kBAAmB,SAASz+C,GACxB,IAGIxN,EAAOwN,EAAOu7C,UAclB,OAbA/oD,EAAKuN,OAAS,oBACdvN,EAAKsrD,aAAe99C,EAAO89C,aAC3BtrD,EAAKurD,MAAQ/9C,EAAO+9C,MACpBvrD,EAAKwrD,SAAWh+C,EAAOg+C,SAEvBxrD,EAAKgsD,WAAax+C,EAAOw+C,WACzBhsD,EAVWmC,KAUDqiD,MAAMK,4BAVL1iD,KAUwCqiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aAG3Bj3C,OAAO45C,MAAM,0BAA4Bp7C,EAAO+9C,MAAQ,IAAKvrD,GAGzDwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAtBL1jB,KAsBiB4iD,eAAeN,OAAO,yBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAGlB01B,kBAAmB,SAAS1+C,GACxB,IAGIxN,EAAOwN,EAAOu7C,UAWlB,OAVA/oD,EAAKuN,OAAS,oBACdvN,EAAKsrD,aAAe99C,EAAO89C,aAC3BtrD,EAAKurD,MAAQ/9C,EAAO+9C,MACpBvrD,EAPWmC,KAODqiD,MAAMK,4BAPL1iD,KAOwCqiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aAG3Bj3C,OAAO45C,MAAM,wBAA0Bp7C,EAAO+9C,MAAQ,IAAKvrD,GAGvDwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAnBL1jB,KAmBiB4iD,eAAeN,OAAO,yBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVi1B,aACIC,WAAW,EACXC,OAAQ,aAzBLxpD,KAyByB0rC,SAIxCse,cAAe,SAAS3+C,GACpB,IAGIxN,EAAOwN,EAAOu7C,UAgBlB,OAfA/oD,EAAKuN,OAAS,gBACdvN,EAAKosD,WAAa5+C,EAAO4+C,WACzBpsD,EAAKurD,MAAQ/9C,EAAO+9C,MAEpBvrD,EAAKwrD,SAAWh+C,EAAOg+C,SACvBxrD,EAAKqsD,SAAW7+C,EAAO6+C,SACvBrsD,EAAKgsD,WAAax+C,EAAOw+C,WACzBhsD,EAXWmC,KAWDqiD,MAAMK,4BAXL1iD,KAWwCqiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aAI3Bj3C,OAAO45C,MAAM,oBAAsBp7C,EAAO+9C,MAAQ,IAAKvrD,GAGnDwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAxBL1jB,KAwBiB4iD,eAAeN,OAAO,yBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAGlB81B,cAAe,SAAS9+C,GACpB,IAAItL,EAAOC,KACP0jB,EAAMrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,yBAA2B,OAG1EzkD,EAAOwN,EAAOu7C,UAqBlB,OAnBA/oD,EAAKuN,OAAS,cACdvN,EAAKsrD,aAAe99C,EAAO89C,aAC3BtrD,EAAKurD,MAAQ/9C,EAAO+9C,MACpBvrD,EAAKwrD,SAAWh+C,EAAOg+C,SAEvBxrD,EAAKqsD,SAAW7+C,EAAO6+C,SACvBrsD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKimD,aAAez4C,EAAOy4C,aACvBz4C,EAAOw7C,YACPhpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAep3C,EAAOw7C,WAEnEx7C,EAAO++C,cACPvsD,EAAKusD,YAAc/+C,EAAO++C,aAK9Bv9C,OAAO45C,MAAM,uBAAyBp7C,EAAO+9C,MAAQ,IAAKvrD,GAEnDkC,EAAK0oD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,GAAQ,SAAWgP,OAAOu0C,gBAKtHiJ,YAAa,SAASh/C,GAClB,IAGIxN,GACJuN,OAAiB,eAIjB,OAHAvN,EAAe,SAAIwN,EAAOi/C,SAGnBntD,EAAEotD,KAREvqD,KAQQ4iD,eAAeN,OAAO,yBAA0BzkD,IAKvE2sD,eAAgB,SAASn/C,GACrB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAgBlB,OAdA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,eAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAE7E/4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAI1Ev5C,OAAO45C,MAAM,sCAAwCp7C,EAAOwV,MAAQ,IAAKhjB,GAGrEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,wBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,kBAOrBoF,cAAe,SAASp/C,GACpB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAgBlB,OAdA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,cAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACnEz4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAE1EvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAGjFv3C,OAAO45C,MAAM,iCAAmCp7C,EAAOwV,MAAQ,IAAKhjB,GAIhEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,uBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,iBAOrBqF,kBAAmB,SAASr/C,GACxB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAElB/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,sBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAC7E/4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAI1E,IAAIF,EAAa76C,EAAO66C,eACxB,IAAKnlD,OAAOmlD,EACRroD,EAAKkD,KAAOmlD,EAAWnlD,KAO3B,OAHA8L,OAAO45C,MAAM,iCAAmCp7C,EAAOwV,MAAQ,IAAKhjB,GAGhEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,uBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,yBAMrBsF,eAAgB,SAASt/C,GACrB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAElB/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,eAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aAEnEz4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAG1EvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gCAAkCr3C,EAAOu/C,+BAAgC,EAGnHv/C,EAAO66C,WAAW9B,cAClBvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO66C,WAAW9B,mBACrF/4C,EAAO66C,WAAW9B,aAG7B,IAAI8B,EAAa76C,EAAO66C,eAKxB,IAAKnlD,OAFLmlD,EAAanmD,EAAKkmD,kBAAkBC,GAGhCroD,EAAKkD,KAAOmlD,EAAWnlD,KAO3B,OAHA8L,OAAO45C,MAAM,kCAAoCp7C,EAAOwV,MAAQ,IAAKhjB,GAGjEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,wBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,kBAMrBwF,iBAAkB,SAASx/C,GACvB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAelB,OAbA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,iBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAC7E/4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAI1Ev5C,OAAO45C,MAAM,oCAAsCp7C,EAAOwV,MAAQ,IAAKhjB,GAGnEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,wBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,oBAOrByF,mBAAoB,SAASz/C,GACzB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAiBlB,OAfA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,uBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAO/N,GACnEO,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkB,UAChE7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAep3C,EAAO0/C,UAC/D1/C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAI1Ev5C,OAAO45C,MAAM,iDAAmDp7C,EAAOwV,MAAQ,IAAKhjB,GAGhFwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,2BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,SACXpkB,KAAK,SAASq1C,GACb,IAEI,OAAOz4C,OAAO4xC,SAAS2G,KAAK4F,UAAU1F,GACxC,MAAOr3C,GAEL,OAAOq3C,MAOnB2F,mBAAoB,SAAS5/C,GACzB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAgBlB,OAdA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,WAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAE7E/4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAI1Ev5C,OAAO45C,MAAM,sCAAwCp7C,EAAOwV,MAAQ,IAAKhjB,GAGrEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,4BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,cAMrB6F,sBAAuB,WACnB,OAAOr+C,OAAO4xC,SAAS2G,KAAKkD,WAAatoD,KAAK4iD,eAAeN,OAAO,gCAGxE6I,oBAAqB,SAASC,GAC1B,IAAIjX,EAEJ,IAAKA,KADLiX,EAAWjuD,EAAEsJ,QAAO,KAAU2kD,GAEtBA,EAAS7zC,eAAe48B,IAAMiX,EAASjX,GAAG58B,eAAe,UAAyC,UAA7Bpa,EAAE8M,KAAKmhD,EAASjX,GAAGvwC,QAEpFwnD,EAASjX,GAAGvwC,MAAM2T,eAAe,OAAS6zC,EAASjX,GAAGvwC,MAAM2T,eAAe,WAC3E6zC,EAASjX,GAAGvwC,MAAQwnD,EAASjX,GAAGvwC,MAAMtG,IAIlD,OAAO8tD,GAMXC,aAAc,SAAShgD,GACnB,IAAiB+/C,EAAbrrD,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAEdrpB,EAAOlyB,EAAOkyB,MAAwB,KAAhBlyB,EAAOkyB,KAAclyB,EAAOkyB,KAAO,GA4B7D,OA1BIlyB,EAAO48C,OAA0B,KAAjB58C,EAAO48C,OAAyB,KAAT1qB,IACvCA,GAAQ,IAAMlyB,EAAO48C,OAEzBpqD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,wBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,cAAgBp3C,EAAO26C,aACpEnoD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,QAAUllB,EACvD1/B,EAAKkC,EAAKsiD,MAAMI,2BAA6B,QAAUp3C,EAAOnL,KAC9DrC,EAAKkC,EAAKsiD,MAAMI,2BAA6B,YAAcp3C,EAAOhJ,KAClExE,EAAKkC,EAAKsiD,MAAMI,2BAA6B,gBAAkBp3C,EAAO68C,aAEtEkD,EAAWrrD,EAAKorD,oBAAoB9/C,EAAO+/C,UAC3CvtD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,kBAAoB9lC,KAAKC,OAAOwuC,GAGzE//C,EAAOigD,kBACPztD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,mBAAqBp3C,EAAOigD,iBACzEjgD,EAAOkgD,aACP1tD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,kBAAoBp3C,EAAOkgD,YAG5E1+C,OAAO45C,MAAM,6BAA8B5oD,GAGvCwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,8BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,2BAOrBmG,qBAAsB,SAASngD,GAC3B,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAYlB,OAXA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,OAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,YACtEvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOu4C,aACvE/lD,EAAqB,eAAIwN,EAAOogD,eAChC5tD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAOy7C,WAGrEj6C,OAAO45C,MAAM,yBAA2Bp7C,EAAOwV,MAAQ,IAAKhjB,GAGxDwN,EAAO45C,QACApnD,EAKJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,iCAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAUhpB,EAAOgpB,UAAY,UAOrCq3B,4BAA6B,SAASrgD,GAClC,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAWlB,OAVA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,uBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,YACtEvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAO6V,SACvErjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAGjFv3C,OAAO45C,MAAM,yBAA2Bp7C,EAAOwV,MAAQ,IAAKhjB,GAGxDwN,EAAO45C,QACApnD,EAKJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,iCAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAUhpB,EAAOgpB,UAAY,OAC7BgxB,YAAa,0BAOrBsG,wBAAyB,SAAStgD,GAC9B,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAElB/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,YAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAGjF,IAAI1gC,EAAMrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,iCACnD,OAAOviD,EAAK0oD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,IAK5F+tD,iBAAkB,SAASvgD,GACvB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UASlB,OAPA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,YAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAG7E/4C,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,6BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,SACXpkB,KAAK,SAASq1C,GACb,IACI,OAAOz4C,OAAO4xC,SAAS2G,KAAK4F,UAAU1F,GACxC,MAAOr3C,GACL,OAAOq3C,MAOnBuG,qBAAsB,SAASxgD,GAC3B,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UASlB,OAPA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,oBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAG7E/4C,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAK3jB,EAAK6iD,eAAeN,OAAO,6BAChCzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAMlBy3B,kBAAmB,SAASzgD,GACxB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAClB/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,eAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAGjF,IAAIz6B,EAAUte,EAAOse,SAAW,GAI5BoiC,GADM1gD,EAAOqY,KAAQ3jB,EAAK6iD,eAAeN,OAAO,2BAChC,IAAMh2C,OAAOuY,MAAMhnB,GAMvC,OAHAgP,OAAO45C,MAAM,oCAAsCsF,EAASpiC,GAGxDte,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKqoC,EACLluD,KAAM8rB,EACN1f,KAAM,OACNoqB,SAAU,UAMlB23B,yBAA0B,WACtB,OAAOn/C,OAAO4xC,SAAS2G,KAAKkD,WAAatoD,KAAK4iD,eAAeN,OAAO,gCAKxE2J,cAAe,SAAS5gD,GACpB,OAAOrL,KAAK2mD,gBAAgBxpD,EAAEsJ,OAAO4E,GACjC6V,SAAU,iBAMlBgrC,gBAAiB,SAAS7gD,GAEtB,IAAItL,EAAOC,KACP0jB,EAAM1jB,KAAK4iD,eAAeN,OAAO,0BACjCzkD,KAUJ,OATAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,uBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkB,OAChE7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO8gD,YACtEtuD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAep3C,EAAOw7C,UACnEhpD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAChF/4C,EAAkB,cAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAEtFrmD,EAAK0oD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,IAM5FuuD,aAAc,SAAS/gD,GAEnB,OAAOrL,KAAKwqD,eAAen/C,IAK/BghD,aAAc,SAAShhD,GAGnB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAElB/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,uBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aAEnEz4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAItE/6C,EAAO66C,WAAW9B,cAClBvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO66C,WAAW9B,mBACrF/4C,EAAO66C,WAAW9B,aAG7B,IAAI8B,EAAa76C,EAAO66C,eAKxB,IAAKnlD,OAFLmlD,EAAanmD,EAAKkmD,kBAAkBC,GAGhCroD,EAAKkD,KAAOmlD,EAAWnlD,KAO3B,OAHA8L,OAAO45C,MAAM,kCAAoCp7C,EAAOwV,MAAQ,IAAKhjB,GAGjEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,wBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,0BAMrBiH,iBAAkB,SAASjhD,GAEvB,OAAOrL,KAAKirD,mBAAmB5/C,IAInCkhD,eAAgB,SAASlhD,GAErB,OAAOrL,KAAKwsD,iBAAiBnhD,IAIjCohD,eAAgB,SAASphD,GAErB,OAAOrL,KAAK0sD,qBAAqBrhD,IAKrCshD,uBAAwB,SAASthD,GAC7B,IAAItL,EAAOC,KAIX,OAHAqL,EAASA,MAGLtL,EAAKmjD,kBAAkB73C,EAAOuhD,WACvB7sD,EAAKmjD,kBAAkB73C,EAAOuhD,YAGzC7sD,EAAKmjD,kBAAkB73C,EAAOuhD,WAAazvD,EAAEotD,KAAKxqD,EAAK6iD,eAAeN,OAAO,gCAErEuK,cAAexhD,EAAOuhD,UACtB5oC,OAAS3Y,EAAO2Y,QAAU,YAK3BjkB,EAAKmjD,kBAAkB73C,EAAOuhD,aAMzCE,eAAgB,SAASzhD,GACrB,IAAItL,EAAOC,KACXqL,EAASA,MAET,IAAIxN,KASJ,OARAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,UAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SAClEx4C,EAAmB,eAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cAC/FjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAChF/4C,EAAkB,cAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAC5F/6C,EAAa,SAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAYr3C,EAAOq4C,QAG/Er4C,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,iBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,oBAOrB0H,gBAAiB,SAAS1hD,GACtB,IAAItL,EAAOC,KACXqL,EAASA,MAET,IAAIxN,KAWJ,OAVAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,kBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAO3M,OACpE2M,EAAmB,eAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cAC/FjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAChF/4C,EAAa,SAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAYr3C,EAAOq4C,QAClFr4C,EAAiB,aAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAO2hD,YAGvF3hD,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,iBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,UAOlB44B,YAAa,SAAS5hD,GAClB,IAAItL,EAAOC,KAGPnC,KAUJ,OATAwN,EAASA,MAETxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,cAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOuG,MAAQ,GAC1EvG,EAAmB,eAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cAC9Fz4C,EAAkB,cAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAGzF/6C,EAAO45C,QACApnD,EAGJV,EAAEua,OAAO3X,EAAK6iD,eAAeN,OAAO,oBAAqBzkD,IAMpEqvD,iBAAkB,SAAS7hD,GACvB,IAAItL,EAAOC,KACPnC,KASJ,OARAwN,EAASA,MAETxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,mBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,iBAAmBr3C,EAAO8hD,WAAa,GACrFtvD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cAAgB,GAGnFz4C,EAAO45C,QACApnD,EAGJV,EAAEua,OAAO3X,EAAK6iD,eAAeN,OAAO,oBAAqBzkD,IAMpEuvD,oBAAqB,SAAS/hD,GAC1B,IAAItL,EAAOC,KACPnC,KASJ,OARAwN,EAASA,MAETxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,aAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,WAAar3C,EAAOgiD,SAAW,GAC7ExvD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cAAgB,GAGnFz4C,EAAO45C,QACApnD,EAGJV,EAAEua,OAAO3X,EAAK6iD,eAAeN,OAAO,oBAAqBzkD,IAOpEyvD,iBAAkB,SAASjiD,GACvB,IAAItL,EAAOC,KACPnC,KASJ,OARAwN,EAASA,MAETxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,mBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,iBAAmBr3C,EAAOkiD,eAAiB,GACzF1vD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cAAgB,GAGnFz4C,EAAO45C,QACApnD,EAGJV,EAAEua,OAAO3X,EAAK6iD,eAAeN,OAAO,oBAAqBzkD,IAKpE2vD,yBAA0B,SAASniD,GAK/B,OAHAA,EAASA,OACFzJ,SAASyJ,EAAOzJ,QAASyJ,EAAOzJ,OAEhCzE,EAAEua,OAJE1X,KAKF4iD,eAAeN,OAAO,6BAEvBmL,cAAepiD,EAAO+4C,YACtBsJ,aAAcriD,EAAOsiD,aACrBC,eAAgBviD,EAAOwiD,aACvBC,eAAgBziD,EAAOwV,MACvBjf,OAAQyJ,EAAOzJ,OACfmsD,UAAW1iD,EAAO/N,MAO9B0wD,2BAA4B,SAAS3iD,GACjC,IACIqY,EAAM1jB,KAAK4iD,eAAeN,OAAO,wCACjCzkD,KAQJ,OAPAA,EAAoB,cAAIwN,EAAO+4C,YAC/BvmD,EAAmB,aAAIwN,EAAOy4C,aAC9BjmD,EAAqB,eAAIwN,EAAOwV,MAChChjB,EAAa,OAAIwN,EAAOw6B,OACxBhoC,EAAiB,WAAIwN,EAAOy6B,WAC5BjoC,EAAkB,YAAIwN,EAAOw7C,UARlB7mD,KAUCyoD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,GAAQ,SAAWgP,OAAOu0C,gBAKtH6M,cAAe,SAAS5iD,GAKpB,OAAOlO,EAAEioD,MACL1hC,IALO1jB,KAKG4iD,eAAeN,OAAO,+BAA+B39C,QAAQ,WAAY0G,EAAOw6B,QAAU,2DAA6Dh5B,OAAOqhD,WACxKjkD,KAAM,MACNoqB,SAAU,UAIlB85B,iBAAkB,SAAS9iD,GAKvB,OAHAA,EAASA,MAGFlO,EAAEotD,KAJEvqD,KAKF4iD,eAAeN,OAAO,kCACvBzc,OAAQx6B,EAAOw6B,SAErB51B,KAAK,SAASq1C,GACR,OAAOA,KAInB8I,aAAc,SAAS/iD,GAInB,OAFAA,EAASA,MAEFlO,EAAEotD,KAHEvqD,KAGQ4iD,eAAeN,OAAO,8BACrCzc,OAAQx6B,EAAOw6B,OACfwoB,kBAAmBhjD,EAAOgjD,mBAAqB,MAMvDC,iBAAkB,SAASjjD,GAEvB,IAAItL,EAAOC,KACP0jB,EAAM1jB,KAAK4iD,eAAeN,OAAO,0BACjCzkD,KAaJ,OAXAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,uBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOkjD,WACvE1wD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO8gD,YACtEtuD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,QAAUp3C,EAAOkyB,KAC9D1/B,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAep3C,EAAOw7C,UACnEhpD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,UAAYp3C,EAAOq4C,OAChE7lD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAChF/4C,EAAkB,cAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAEtFrmD,EAAK0oD,iBAAiB57C,OAAO4xC,SAAS2G,KAAKkD,WAAY5kC,GAAO,IAAMpX,OAAOuY,MAAMhnB,GAAQ,SAAWgP,OAAOu0C,gBAMtHoN,UAAW,SAASnjD,GAChB,IAAItL,EAAOC,KACXqL,EAASA,MAET,IAAIxN,KAeJ,GAdAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,uBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YACjFvmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAO6V,UAAY,YAClF7V,EAAmB,eAAIxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,cAG/FjmD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,MAAQp3C,EAAOm0B,GAC5D3hC,EAAKkC,EAAKsiD,MAAMI,2BAA6B,WAAap3C,EAAOojD,QACjE5wD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,WAAap3C,EAAOqL,QACjE7Y,EAAKkC,EAAKsiD,MAAMI,2BAA6B,YAAc9lC,KAAKC,OAAOvR,EAAOqjD,UAG1ErjD,EAAO45C,QACP,OAAOpnD,EAGX,IAAI6lB,EAAMrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,iBAEnD,OAAOnlD,EAAEua,OAAOgM,EAAK7lB,IAMzB8wD,oBAAqB,SAAStjD,GAC1B,IAGIxN,EAAOwN,EAAOu7C,UAMlB,OAJA/oD,EALWmC,KAKDqiD,MAAMK,4BAA8B,UAAY,sBAC1D7kD,EANWmC,KAMDqiD,MAAMK,4BANL1iD,KAMwCqiD,MAAMM,eAAiBt3C,EAAO+4C,YAG7E/4C,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAdL1jB,KAciB4iD,eAAeN,OAAO,oBAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,yBASrBuJ,aAAc,SAASvjD,GAGnB,OAAOlO,EAAEotD,KAFEvqD,KAEQ4iD,eAAeN,OAAO,sBAAuBj3C,IAOpEwjD,4BAA6B,SAASxjD,GAClC,OAAOlO,EAAEotD,KAAKvqD,KAAK4iD,eAAeN,OAAO,sCAAuCj3C,IAQpFyjD,4BAA6B,SAASzjD,GAClC,OAAOlO,EAAEotD,KAAKvqD,KAAK4iD,eAAeN,OAAO,sCAAuCj3C,IAQpF0jD,uBAAwB,SAAS1jD,GAG7B,OAAOlO,EAAEotD,KAFEvqD,KAEQ4iD,eAAeN,OAAO,gCAAiCj3C,IAM9E2jD,aAAc,SAAS3jD,GAEnB,OAAOlO,EAAEua,OADE1X,KACU4iD,eAAeN,OAAO,mBAAoBj3C,IAKnE4jD,0BAA2B,SAAS5jD,IAEhCA,EAASA,OAGU6jD,OACL7jD,EAAO8jD,SAIrB,OAAOhyD,EAAEioD,MACL1hC,IAVO1jB,KAUG4iD,eAAeN,OAAO,mCAChCzkD,KAAMwN,EACNpB,KAAM,OACNoqB,SAAU,UAMlB+6B,cAAe,SAAS/jD,IAEpBA,EAASA,OAGWgkD,QACPhkD,EAAOojD,QACVpjD,EAAOwd,KAGjB,OAAO1rB,EAAEioD,MACL1hC,IAVO1jB,KAUG4iD,eAAeN,OAAO,uBAChCzkD,KAAMwN,EACNpB,KAAM,OACNoqB,SAAU,UASlBi7B,iBAAkB,WACd,IACI5rC,EADO1jB,KACI4iD,eAAeN,OAAO,sBAErC,OAAOnlD,EAAEotD,KAAK7mC,IAMlB+kC,iBAAkB,SAASH,EAAY5kC,GAEnC,OAA4B,GAAxBA,EAAIxZ,QAAQ,SAA+B,IAAdo+C,EACtB5kC,EAEA4kC,EAAa5kC,GAS5B6rC,YAAa,SAASlkD,GAClB,IAAItL,EAAOC,KACPnC,KACJwN,EAASA,MAETxN,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,eAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiB,SAC/D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAOqgC,KACrE7tC,EAAKkC,EAAKsiD,MAAMK,4BAA8B,iBAAmBr3C,EAAOmkD,yBAEpEnkD,EAAOokD,eACP5xD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOokD,cAGvEpkD,EAAOqkD,eACP7xD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOqkD,cAG3CxnD,MAA5BmD,EAAOskD,oBACP9xD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,qBAAuBr3C,EAAOskD,mBAKhF,IAAIxM,EAAat2C,OAAOY,KAAKoG,eAU7B,OATIhH,OAAOY,KAAK0yB,iBACZgjB,EAAa,SACNt2C,OAAOY,KAAK6yB,uBACnB6iB,EAAa,UAGjBtlD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBS,EAG1D93C,EAAO45C,QACApnD,EAGJV,EAAEua,OAAO3X,EAAK6iD,eAAeN,OAAO,iBAAkBzkD,IAQjE+xD,aAAc,SAASvkD,GACnB,IACIxN,KAMJ,OAJIwN,EAAOwkD,cACPhyD,EAAKgyD,YAAcxkD,EAAOwkD,aAGvB1yD,EAAEotD,KAPEvqD,KAOQ4iD,eAAeN,OAAO,8BAA+BzkD,IAQ5EiyD,aAAc,SAASzkD,GACnB,IAAItL,EAAOC,KACPnC,KAiCJ,OA/BAA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,gBAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO0kD,YACtElyD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,sBAAuB,EACrE7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgB3iD,EAAKojD,WACnEtlD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgB3iD,EAAKsjD,WAE/Dh4C,EAAOq5C,eACP7mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOq5C,cAEvEr5C,EAAOw6B,SACPhoC,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAYr3C,EAAOw6B,QAEjEx6B,EAAOq5C,eACP7mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOq5C,cAEvEr5C,EAAO64C,aACPrmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,cAAgBr3C,EAAO64C,YAErE74C,EAAOo5C,mBACP5mD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,oBAAsBr3C,EAAOo5C,kBAE3Ep5C,EAAO2kD,gBACPnyD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,iBAAmBp3C,EAAO2kD,eAEvE3kD,EAAOw5C,cACPhnD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,uBAAyBr3C,EAAOw5C,aAE9Ex5C,EAAO4kD,sBACPpyD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,uBAAyBr3C,EAAO4kD,qBAG3E9yD,EAAEioD,MACL1hC,IAAK3jB,EAAK6iD,eAAeN,OAAO,iBAChCzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACV67B,OAAO,KAMfC,eAAgB,SAAS9kD,GAErB,OAAOrL,KAAKwqD,eAAen/C,IAQ/B+kD,WAAY,SAAS/kD,GACjB,IACIglD,EAAelzD,EAAEsJ,OAAO4E,GAAU45C,SAAS,IAE3CpnD,EAHOmC,KAGK2mD,gBAAgB0J,OAUhC,OARIhlD,EAAOilD,QACPzyD,EANOmC,KAMGqiD,MAAMI,2BAA6B,QAAUp3C,EAAOilD,OAG9DjlD,EAAOklD,YACP1yD,EAVOmC,KAUGqiD,MAAMI,2BAA6B,YAAcp3C,EAAOklD,WAGlEllD,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAlBL1jB,KAkBiB4iD,eAAeN,OAAO,2BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAUhpB,EAAOgpB,UAAY,OAC7BgxB,YAAa,uBACbsC,WAAY,SAASC,EAAK3rB,GACtBpvB,OAAOg7C,sBAAwBh7C,OAAOg7C,0BACtCh7C,OAAOg7C,sBAAsBj/C,KAAKg/C,OAU9C4I,eAAgB,SAASnlD,GACrB,IACIglD,EAAelzD,EAAEsJ,UAAW4E,GAAU45C,SAAS,IAC/CpnD,EAFOmC,KAEK2mD,gBAAgB0J,OAShC,OAPIhlD,EAAOolD,mBACP5yD,EALOmC,KAKGqiD,MAAMI,2BAA6B,mBAAqBp3C,EAAOolD,kBAGzEplD,EAAOqlD,cACP7yD,EATOmC,KASGqiD,MAAMI,2BAA6B,cAAgBp3C,EAAOqlD,aAEpErlD,EAAO45C,QACApnD,EAEJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAfL1jB,KAeiB4iD,eAAeN,OAAO,2BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAUhpB,EAAOgpB,UAAY,OAC7BgxB,YAAa,0BAUrBsL,sBAAuB,SAAStlD,GAC5B,IACIglD,EAAelzD,EAAEsJ,OAAO4E,GAAU45C,SAAS,IAC3CpnD,EAFOmC,KAEK2mD,gBAAgB0J,OAUhC,OARIhlD,EAAOilD,QACPzyD,EALOmC,KAKGqiD,MAAMI,2BAA6B,QAAUp3C,EAAOilD,OAG9DjlD,EAAOo5C,mBACP5mD,EATOmC,KASGqiD,MAAMI,2BAA6B,oBAAsBp3C,EAAOo5C,kBAG1Ep5C,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAjBL1jB,KAiBiB4iD,eAAeN,OAAO,2BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAUhpB,EAAOgpB,UAAY,OAC7BgxB,YAAa,0BASrBuL,4BAA6B,SAAS9e,GAElC,IAAIzyC,KAyBAwxD,EAAa,SAASzhC,GACtBA,EAAOA,MACP,IAAI+a,EAAU,GAOd,OALAhtC,EAAE0D,KAAKixC,EAAQ,SAAS/wC,EAAK6C,GACrBA,EA7BM,IA6BgBwrB,EA7B6F,KA8BnH+a,GAAW0mB,EAAWjtD,GAASA,EA9BP,GA8B6B,SAGtDumC,GAUP2mB,EAAW,SAASn2B,EAAM+Q,GAC1B,IAAItc,EArCmBsc,EACnBroC,EAqCAA,GArCAA,KACJqoC,GAFuBA,EAsCIA,IApCZ,GAEfvuC,EAAE0D,KAAKixC,EAAQ,SAAS/wC,EAAK6C,GACrBA,EAZmH,IAYtF8nC,GAC7BroC,EAASuF,KAAKhF,KAGfP,GAgDP,OAlBAlG,EAAE0D,KAAKwC,EAAU,SAAStC,EAAK6C,GAC3B,IAAImtD,EAAQD,KAAaltD,EA/Cf,KA2DmB,MAX7BwrB,GACIk1B,WAAc1gD,EAjDR,GAkDNu2C,YAAev2C,EAlDS,GAmDxBotD,iBAAmBptD,EAnDwE,GAoD3FqG,KAAQrG,EApD4C,GAqDpDqtD,WAAcrtD,EArDuD,GAsDrEstD,gBAAmBttD,EAtDwE,GAuD3FkgD,aAAgBlgD,EAvD0B,GAwD1CP,SAAY0tD,EACZ5mB,QAAW0mB,EAAWjtD,KAEjBstD,iBAA0B9hC,EAAK/rB,SAAS6B,OAAS,IACtDy1B,EAAK/xB,KAAKwmB,KAIXuL,GAGX,OADAm2B,EAASzxD,EAAS,IACXA,GAOX8xD,iBAAkB,SAAS9lD,GACvB,IACIxN,GACImf,MAAO3R,EAAOxN,KACdilB,OAAQzX,EAAOyX,OACfjC,MAAOxV,EAAOwV,OAElB6C,EANO1jB,KAMI4iD,eAAeN,OAAO,gCAAgC39C,QAAQ,WAAY0G,EAAO+lD,QAAQzsD,QAAQ,iBAAkB0G,EAAOu4C,cAEzI,OAAOzmD,EAAEioD,MACL1hC,IAAKA,EACL7lB,KAAMA,KAOdwzD,mCAAoC,SAAShmD,GAEzC,OAAOlO,EAAEotD,KADEvqD,KACQ4iD,eAAeN,OAAO,qCAAsCj3C,IAQnFimD,kBAAmB,SAASjmD,GACxB,OAAOlO,EAAEioD,MACL1hC,IAAK1jB,KAAKuxD,uBAAuB1kD,OAAO4xC,SAAS2G,KAAKkD,YAAc,GAAIj9C,EAAOqY,KAC/E7lB,KAAMwN,EAAOmmD,SACbvnD,KAAM,OACN+3B,aAAa,EACbyvB,aAAa,KASrBjF,iBAAkB,SAASnhD,GACvB,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAgBlB,OAdA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,SAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAE7E/4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAI1Ev5C,OAAO45C,MAAM,sCAAwCp7C,EAAOwV,MAAQ,IAAKhjB,GAGrEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,0BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,YAMrBqH,qBAAsB,SAASrhD,GAC3B,IAAItL,EAAOC,KAGPnC,EAAOwN,EAAOu7C,UAgBlB,OAdA/oD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,aAC1D7kD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAWr3C,EAAOwV,MAChEhjB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAcr3C,EAAOw4C,SACnEhmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBr3C,EAAOy4C,aACvEjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBt3C,EAAO+4C,YAE7E/4C,EAAO+6C,cACPvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBr3C,EAAO+6C,aAI1Ev5C,OAAO45C,MAAM,wCAA0Cp7C,EAAOwV,MAAQ,IAAKhjB,GAGvEwN,EAAO45C,QACApnD,EAGJV,EAAEioD,MACL1hC,IAAKrY,EAAOqY,KAAO3jB,EAAK6iD,eAAeN,OAAO,8BAC9CzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,gBAOrBkM,uBAAwB,SAASjJ,EAAY5kC,GACzC,OAAO7W,OAAOY,KAAK89B,uBAAyB7nB,GAAO,IAAI/H,WAAW2sC,EAAY,IAAK5kC,KCv0E/FvmB,EAAEklD,MAAM57C,OAAO,6CAEXg8C,2BAA4B,KAC5BC,4BAA6B,KAC7BC,cAAe,gBAMfnrC,KAAM,SAAU+qC,GACZviD,KAAKuiD,QAAUA,EACfviD,KAAK4iD,eAAiBL,EAAQK,eAG9B5iD,KAAK0xD,SACL1xD,KAAK2xD,WAAa,GAClB3xD,KAAKy6B,qBAAuB,IAAI5tB,OAAO4tB,qBAGvCz6B,KAAK4xD,2BAMTC,WAAY,WACR,OAAO7xD,KAAKuiD,SAMhBqP,wBAAyB,WACrB,IAAI7xD,KAAOC,KACX,IAAK,IAAIe,OAAOf,KAAKuiD,QAAQF,MAAMl0C,UAEpB,QAAPpN,KAAwB,eAAPA,KAA+B,SAAPA,KAAyB,eAAPA,MAG/DhB,KAAKgB,KAAOkQ,KAAK,mEAAqElQ,IAAM,wBAOpG+wD,YAAa,SAAUvgB,EAAQljC,WAC3B,IAAIk0C,EAAUviD,KAAKuiD,QAGnB,IAAKl0C,WAAiC,GAApBA,UAAUnJ,OACxB,OAAOqsC,EAAOnjC,MAAMm0C,EAASl0C,WAIjC,GAA6B,iBAAjBA,UAAU,GAClB,OAAOkjC,EAAOnjC,MAAMm0C,EAASl0C,WAGjC,IAAIhD,EAASgD,UAAU,GAGvB,GAAsB,GAAlBhD,EAAO45C,QAAiB,OAAO1T,EAAOnjC,MAAMm0C,EAASl0C,WAGzDhD,EAAO45C,SAAU,EACjB,IAAI75C,EAASmmC,EAAOnjC,MAAMm0C,EAASl0C,WAEnC,OAAOrO,KAAKV,IAAI8L,IAMpB2mD,8BAA+B,SAAUp2B,GACrC,IAAIY,EAAc1vB,OAAOC,aAAaC,YAAY,kCAElD,OAAO+B,OAAOytB,EAAaZ,EAAMC,eAAgBD,EAAMG,eAQ3Dx8B,IAAK,SAAU8L,GACX,IAAIrL,EAAOC,KACPkQ,EAAW,IAAI/S,EAAE4S,SAEjB9O,EAAOmK,EAAO4mD,UAAY,WAGN,uBAAwB,eAAgB,uBAE3C9nD,QAAQjJ,GAAQ,GAAK4L,OAAOwkB,SAAS4gC,4BACtDlyD,EAAK06B,qBAAqBI,QAAQ55B,EAAMmK,GAI5CpJ,aAAajC,EAAKmyD,cAClB,IAAIC,EAAM/mD,EAAO+mD,IAAM/qD,KAAKskC,OACxB0mB,GAAiBhnD,OAAQA,EAAQ8E,SAAUA,GAmB/C,OAlBAnQ,EAAK2xD,MAAMS,GAAOC,EAGlBryD,EAAKmyD,aAAepwD,WAAW,WAC3B,IAAIuwD,EAAsBtyD,EAAK06B,qBAAqBtqB,UAEpD,GAAIkiD,EAAoB12B,MAAO,CAE3B,IAAK,IAAI76B,KAAKf,EAAK2xD,MAAO,CACtB,IAAIh7C,EAAU27C,EAAoB12B,MAAMS,iBACxCr8B,EAAK2xD,MAAM5wD,GAAGoP,SAASoiD,OAAO57C,GAElC3W,EAAK2xD,cAEL3xD,EAAKwyD,QAEVxyD,EAAK4xD,YAEDzhD,EAAS3H,WAKpBgqD,KAAM,WACF,IACIb,KAGAryD,KACJlC,EAAE0D,KALSb,KAKC0xD,MAAO,SAAUS,EAAKlpB,GAC9B5pC,EAAQuJ,KAAKqgC,EAAK79B,QAClBsmD,EAAMS,GAAOlpB,IAPNjpC,KAWN0xD,SAGLv0D,EAAEqM,KAdSxJ,KAcC6P,SAAUxQ,QAASA,EAASmzD,iBAAiB,KAChDrqD,KAAK,SAAUsqD,GAGZt1D,EAAE0D,KAAK4xD,EAAW,SAAU3xD,EAAGwkD,GAC3B,IAAI6M,EAAM7M,EAAS6M,IACd7M,EAAS3pB,MAGV+1B,EAAMS,GAAKjiD,SAASoiD,OAAOhN,EAAS3pB,MAAO2pB,EAAUA,EAAS3pB,MAAMjlB,SAFpEg7C,EAAMS,GAAKjiD,SAASC,QAAQm1C,EAASv9C,eAMlC2pD,EAAMS,KAIjBh1D,EAAE0D,KAAK6wD,EAAO,SAAU5wD,EAAGmoC,GACvBA,EAAK/4B,SAASoiD,QAASroD,KAAM,gBAAiByM,QAAS,6BAA+B,GAAI,iCAE/FtG,KAAK,SAAUw3C,EAAK39C,EAAM0xB,GAGzB,IAAImL,OAAkC,IAAZ,EAA0BnL,EAAMjlB,QAAWilB,GAAS,4BAC9Ex+B,EAAE0D,KAAK6wD,EAAO,SAAU5wD,EAAGmoC,GACvBA,EAAK/4B,SAASoiD,QAASroD,KAAM,gBAAiByM,QAASowB,GAAgB,GAAI,kCAO/Fj3B,QAAS,SAAUxE,GACf,IAAItL,EAAOC,KAGPnC,KACA20D,OAA6CtqD,IAA3BmD,EAAOmnD,iBAAgCnnD,EAAOmnD,gBACpE30D,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,cAG1DvlD,EAAE0D,KAAKwK,EAAOhM,QAAS,SAAUyB,EAAGsK,GAChCA,EAAOrL,EAAKsiD,MAAMK,4BAA8B,OAASt3C,EAAO+mD,KAAOrxD,SAChEsK,EAAO+mD,OAIlB9mD,EAASA,OACEhM,UACPxB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,WAAa/lC,KAAKC,OAAOvR,EAAOhM,UAIlFwN,OAAO45C,MAAM,0BAA2B5oD,GAGxC,IAAIqS,EAAW,IAAI/S,EAAE4S,SAqCrB,OApCA5S,EAAEioD,MACE1hC,IAAK3jB,EAAK6iD,eAAeN,OAAO,sBAChCzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,cACbsC,WAAY,SAAUC,EAAK3rB,GACvBpvB,OAAOg7C,sBAAwBh7C,OAAOg7C,0BACtCh7C,OAAOg7C,sBAAsBj/C,KAAKg/C,MAGvCz/C,KAAK,SAAUsqD,GACd,IAAK3xD,KAAK2xD,EACN,GAA4B,mBAAjBA,EAAU3xD,GAAmB,CACpC,IAAIwkD,EAAWmN,EAAU3xD,GACzB,GAAIwkD,EAAS3pB,OACL62B,EAEA,YADAtiD,EAASoiD,OAAOtyD,KAAM,cAAeslD,GAOrDp1C,EAASC,QAAQsiD,KAElBriD,KAAK,SAAUw3C,GACd,IACI8K,EADApN,EAAWsC,EAAI1rB,cAAgB0rB,EAGnC,IACI8K,EAAgB/1C,KAAKhE,MAAM2sC,GAC7B,MAAOr3C,IACTiC,EAASoiD,OAAO1K,EAAK,cAAe8K,KAGjCxiD,EAAS3H,aC1OxBsE,OAAO2xC,OAAOC,SAASqE,mBAAmBr8C,OAAO,qDAE7Cg8C,2BAA4B,KAC5BC,4BAA6B,KAC7BC,cAAe,kBAMf9yC,QAAS,SAAUxE,GACf,IAAItL,EAAOC,KAGPnC,KACA20D,OAA6CtqD,IAA3BmD,EAAOmnD,iBAAgCnnD,EAAOmnD,gBACpE30D,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,cAG1DvlD,EAAE0D,KAAKwK,EAAOhM,QAAS,SAAUyB,EAAGsK,GAChCA,EAAOrL,EAAKsiD,MAAMK,4BAA8B,OAASt3C,EAAO+mD,KAAOrxD,EACnEsK,EAAOrL,EAAKsiD,MAAMM,iBAClB9kD,EAAKkC,EAAKsiD,MAAMM,eAAiBv3C,EAAOrL,EAAKsiD,MAAMM,uBAEhDv3C,EAAOrL,EAAKsiD,MAAMM,sBAClBv3C,EAAO+mD,OAIlB9mD,EAASA,OACEhM,UACPxB,EAAKkC,EAAKsiD,MAAMK,4BAA8B,WAAa/lC,KAAKC,OAAOvR,EAAOhM,UAIlFwN,OAAO45C,MAAM,mCAAoC5oD,GAGjD,IAAIqS,EAAW,IAAI/S,EAAE4S,SAqCrB,OApCA5S,EAAEioD,MACE1hC,IAAK3jB,EAAK6iD,eAAeN,OAAO,+BAChCzkD,KAAMA,EACNoM,KAAM,OACNoqB,SAAU,OACVgxB,YAAa,cACbsC,WAAY,SAAUC,EAAK3rB,GACvBpvB,OAAOg7C,sBAAwBh7C,OAAOg7C,0BACtCh7C,OAAOg7C,sBAAsBj/C,KAAKg/C,MAGvCz/C,KAAK,SAAUsqD,GACd,IAAK3xD,KAAK2xD,EACN,GAA4B,mBAAjBA,EAAU3xD,GAAmB,CACpC,IAAIwkD,EAAWmN,EAAU3xD,GACzB,GAAIwkD,EAAS3pB,OACL62B,EAEA,YADAtiD,EAASoiD,OAAOtyD,KAAM,cAAeslD,GAOrDp1C,EAASC,QAAQsiD,KAElBriD,KAAK,SAAUw3C,GACd,IACI8K,EADApN,EAAWsC,EAAI1rB,cAAgB0rB,EAGnC,IACI8K,EAAgB/1C,KAAKhE,MAAM2sC,GAC7B,MAAOr3C,IACTiC,EAASoiD,OAAO1K,EAAK,cAAe8K,KAGjCxiD,EAAS3H,aC1ExBpL,EAAEklD,MAAM57C,OAAO,yCAIXksD,aAAa,IAMbn7C,KAAM,SAAUguC,GACZxlD,KAAKwlD,KAAOA,EACZxlD,KAAKgV,WAAawwC,EAAKz4C,YAAY,eAKvC6lD,gBAAiB,SAAUC,EAAYC,EAAeC,GAClD,IACIC,EAAWH,EAAWI,aAAeJ,EAAWI,YAAY/tD,OAAS,EAD9DlF,KACuEkzD,uBAAuBL,EAAWG,UAAYH,EAAWG,SAO3I,GAJAF,EAAgBA,IAAiB,EACjCC,EAAoBA,IAAqB,EAGzB,QAAZC,EACA,MAAO,OACX,GAAgB,SAAZA,EACA,MAAO,QAIX,IAFA,IAAIG,EAAe,GAEVryD,EAAI,EAAGA,EAAI+xD,EAAWI,YAAY/tD,OAAQpE,IAAK,CACpD,IAAIsyD,EAAaP,EAAWI,YAAYnyD,GAExC,GAAIsyD,EAAWC,OAAQ,CACnB,IAAIC,EAnBDtzD,KAmBmBuzD,+BAA+BH,EAAWC,QAChEF,GApBGnzD,KAoBkBwzD,qBAAqBJ,EAAWC,OAAQC,EAAYP,QAElEK,EAAWK,UAClBN,GAAgB,IAvBbnzD,KAuBwB4yD,gBAAgBQ,EAAWK,QAASX,EAAeC,GAAqB,MAIvGI,GAAiBryD,EAAI+xD,EAAWI,YAAY/tD,OAAS,EAAI8tD,EAAW,GAGxE,OAAOG,GAKXD,uBAAwB,SAAUQ,GAC9B,MAA0B,OAAtBA,EACO,OACe,MAAtBA,EACO,OACJA,GAKXF,qBAAsB,SAAUG,EAAWb,EAAeC,GACtD,IACIa,EACA/yC,EACAgzC,EAAY,GACZb,EAAWW,EAAUX,SACrBc,EAAgB,GAChBC,EAAiB,GAGrBjB,EAAgBA,IAAiB,EACjCC,EAAoBA,IAAqB,EAIzC,IACItgD,EAAUkhD,EAAU9yC,OAAS8yC,EAAUK,SAEvCC,EAjBOj0D,KAiBqBk0D,4BAA4BzhD,EAASkhD,EAAUQ,cA6B/E,GA1BAP,EApBW5zD,KAoBGo0D,WAAW3hD,EAASwhD,EAAsBnB,GAC5B,WAAxBmB,IACAH,GAAiB,wBAA0BF,EAAS,SAIpDb,GAAqBtgD,GAAWA,EAAQvN,OAAS,KAZtBmvD,QAAW,IAYwC98C,eAAe08C,KAC7FF,EAAiB,mBAAqBthD,EAAU,0BAA4BA,EAAU,UAIrF5F,OAAOY,KAAKqT,QAAQ6yC,EAAUW,UAQD,KAAvBX,EAAUW,WAEjBT,EAAY,OATZA,EAhCO7zD,KAgCUu0D,cAAcZ,EAAUW,SAAUL,EAAsBnB,GAG7C,SAAxBmB,IACAH,GAAiB,wBAA0BD,EAAY,UAU/C,YAAZb,EACA,OAAOe,EAAiBD,EAAgB,iBAAmBF,EAAS,IAAMC,EAAY,KAG1F,GAAgB,WAAZb,EACA,MAAO,kBAAoBY,EAAS,oBAExC,GAAgB,UAAZZ,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,OAASC,EAC9D,GAAgB,cAAZb,EACA,OAAOe,EAAiBH,EAAS,OAASC,EAC9C,GAAgB,aAAZb,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,MAAQC,EAC7D,GAAgB,oBAAZb,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,OAASC,EAC9D,GAAgB,gBAAZb,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,MAAQC,EAC7D,GAAgB,uBAAZb,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,OAASC,EAC9D,GAAgB,QAAZb,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,uBAAyBC,EAAY,UAC1F,GAAgB,YAAZb,EACA,MAA4B,UAAxBiB,EACOF,EAAiB,uBAAyBH,EAAS,IAEnDG,EAAiB,IAAMH,EAAS,gCAAkCA,EAAS,KAG1F,GAAgB,gBAAZZ,EACA,MAA4B,UAAxBiB,EACOF,EAAiB,wBAA0BH,EAAS,IAEpDG,EAAiB,IAAMH,EAAS,iCAAmCA,EAAS,KAG3F,GAAgB,WAAZZ,EACA,OAAOe,EAAiB,KAAOH,EAAS,eAAiBA,EAAS,eACtE,GAAgB,YAAZZ,EACA,OAAOe,EAAiB,KAAOH,EAAS,gBAAkBA,EAAS,kBAAoBA,EAAS,gBACpG,GAAgB,oBAAZZ,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,uBAAyBC,EAAY,SAC1F,GAAgB,YAAZb,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,uBAAyBC,EAAY,UAC1F,GAAgB,eAAZb,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,0BAA4BC,EAAY,aAC7F,GAAgB,wBAAZb,EACA,OAAOe,EAAiBD,EAAgBF,EAAS,0BAA4BC,EAAY,cAC7F,GAAgB,iBAAZb,EAKA,OAJAnyC,EAAQpO,EACJqgD,GAAiBjyC,IACjBA,EAAQA,EAAMlF,WAAW,KAAM,gBAE5Bo4C,EAAiB,wBAA0BlzC,EAAQ,MAE9D,GAAgB,qBAAZmyC,EAKA,OAJAnyC,EAAQpO,EACJqgD,GAAiBjyC,IACjBA,EAAQA,EAAMlF,WAAW,KAAM,gBAE5Bo4C,EAAiB,yBAA2BlzC,EAAQ,MAE/D,GAAgB,oBAAZmyC,EACA,OAAOe,EAAiB,sBAAwBH,EAAS,KAC7D,GAAgB,iBAAZZ,EACA,MAAO,QACX,GAAgB,qBAAZA,EACA,MAAO,QACX,GAAgB,eAAZA,EACA,MAAO,aAAea,EAE1B,GAAgB,YAAZb,EACA,OAAIF,EAEO,4BAvHJ9yD,KAsHWo0D,WAAW3hD,EAAS,KAAMqgD,GACE,oBAEnC,yBAA2BrgD,EAAU,qBAKpD,GAAgB,kBAAZugD,EAEA,MAAO,2BADPnyC,EAAQpO,GAAW,IACwB,wBAI/C,MAAM,GAAI,gDAAkDugD,GAKhEkB,4BAA6B,SAAUzhD,EAAS0hD,GAG5C,QAAqBjsD,IAAjBisD,GAA8C,SAAhBA,EAAyB,CAGvD,IAAI3O,EALGxlD,KAKSwlD,KACZhH,EAASgH,EAAKgP,UAAU/hD,IAAY+yC,EAAKiP,cAAchiD,GAG3D,GAAc,MAAV+rC,EACA,MAAM,IAAItlC,MAAM,0GAIpB,GAA8B,QAA1BslC,EAAO9rC,WAAWzI,KAAgB,CAClC,IAAIyqD,EAfD10D,KAekB20D,iBAAiBliD,GAEtC,GAAiC,KAA7BiiD,EAAUE,eAEV,MAAO,QAGP,GAAc,OADdpW,EAASA,EAAOqW,UAAUH,EAAUE,iBAEhC,MAAM,IAAI17C,MAAM,0GAK5B,IAAImb,EAAWmqB,EAAO9rC,WAAW2hB,SAC7BygC,EAAajoD,OAAOY,KAAKs8B,cAAcyU,EAAO9rC,WAAWzI,MAE7D,OA/BOjK,KA+BE+0D,sBAAsBD,GACpB,SAIK,GAAZzgC,GAA6B,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GAA6B,IAAZA,GAA8B,IAAZA,EACjH,SAIK,GAAZA,EACO,QAIK,IAAZA,GAA8B,IAAZA,EACgB,GAA9BmqB,EAAO9rC,WAAW8lB,SACX,WAEA,OAKC,GAAZnE,EACO,UAIO,UAAdygC,EACO,SAIJ,OAEJ,MAAoB,SAAhBX,GAA2C,YAAhBA,GAA8C,UAAhBA,EACzDA,EAIJ,QAKXY,sBAAuB,SAAUD,GAC7B,OAAQ,QAAS,OAAQ,QAAS,SAAU,cAAe,eAAe/hD,SAAS+hD,IAAe,oBAAoB5iD,KAAK4iD,IAG/HV,WAAY,SAAUvzC,EAAOszC,EAAcrB,GAWvC,OAPAA,EAAgBA,IAAiB,KAI7BjyC,EAAQA,EAAMlF,WAAW,KAAM,gBAGf,SAAhBw4C,GAA4BrB,EAEL,MAAhBqB,EACA,IAAMtzC,EAAQ,IACE,YAAhBszC,EAEA,mBAAqBtzC,EAAQ,OAhB7B7gB,KAesBk0D,4BAA4BrzC,EAAO,SACC,KAC1DiyC,EACA,+BAAiCjyC,EAAQ,OAASszC,EAAe,KAGrE,mBAAqBtzC,EAAQ,OAASszC,EAAe,KAVjD,mBAAqBtzC,EAAQ,OAX7B7gB,KAW2Ck0D,4BAA4BrzC,EAAO,SAAW,MAYxG0zC,cAAe,SAAUD,SAAUH,aAAcrB,cAAehP,cAC5D,IAAI/jD,KAAOC,KACP6I,OAKJ,GAFAiqD,cAAgBA,gBAAiB,EAEb,QAAhBqB,aAWA,OATAG,SAAwB,MAAZA,SAAoB,GAAKA,SACrCA,SAA+B,iBAAZA,SAAwBA,SAASxjD,WAAawjD,UACnC,GAA1BA,SAASpqD,QAAQ,OACjBoqD,SAAWA,SAAS34C,WAAW,IAAK,SAGT,GAA3B24C,SAASpqD,QAAQ,QACjBoqD,SAAWA,SAAS34C,WAAW,KAAM,KAElC,IAAM24C,SAASxjD,WAAa,IAEvC,GAAoB,WAAhBqjD,aAEA,MAAyB,iBAAd,SACiC,GAAhCljD,KAAKqjD,SAAS7jD,eAAyB,OAAS,QAE9B,GAAlBQ,KAAKqjD,UAAoB,OAAS,QAGlD,GAAoB,UAAhBH,aAGA,OADAtrD,OAAS,IAAIgB,OAAOyqD,UACNpmD,KAAVrF,OACO,YACJA,OAAOiI,WAElB,GAAoB,SAAhBqjD,aAGA,OADAtrD,OAAS,IAAIgB,OAAOyqD,UACNpmD,KAAVrF,OACO,YACJA,OAAOiI,WAElB,GAAoB,QAAhBqjD,aAAwB,CAExB,IAAIr/B,KAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB+7B,UAO1D,OANKx/B,MAAgB,GAARA,OACTA,KAAO,IAAI7hB,KAAK,IAGpB6hB,KAAK4D,SAAS,EAAG,EAAG,EAAG,GAEhB,mDAAqD7rB,OAAOY,KAAKgmB,cAAckF,gBAAgB7D,MAAQ,eAElH,GAAoB,YAAhBq/B,aAA4B,CAE5B,IAAIr/B,KAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB+7B,UAAU,GAQpE,OAPKx/B,MAAgB,GAARA,OACTA,KAAO,IAAI7hB,KAAK,IAGpB6hB,KAAKkgC,WAAW,GAChBlgC,KAAKmgC,gBAAgB,GAEd,mDAAqDpoD,OAAOY,KAAKgmB,cAAckF,gBAAgB7D,MAAM,GAAQ,qBAExH,GAAoB,SAAhBq/B,aAEA,MAAO,IAAMG,SAASxjD,WAAa,IAEvC,GAAoB,UAAhBqjD,aAA0B,CAE1B,GAAItnD,OAAOY,KAAKqT,QAAQwzC,UACpB,OAAO,KAEX,IACIA,SAAgC,iBAAd,SAAyB33C,KAAKhE,MAAM27C,UAAYA,SACpE,MAAOrmD,GACLqmD,SAAWA,aAKf,IAAIvsD,OAASusD,SAASh3D,IAAMg3D,SAC5B,OAAO33C,KAAK1E,UAAUlQ,QAE1B,GAAoB,SAAhBosD,aAAyB,CAEzB,IAAItzC,MAAQyzC,SAASxjD,WAWrB,OARIgiD,gBACAjyC,MAAQA,MAAMlF,WAAW,KAAM,gBAG/BmoC,eACAjjC,MAAQijC,aAAe,IAAMjjC,OAG1B9gB,KAAKq0D,WAAWvzC,MAAOszC,aAAcrB,eAEhD,GAAoB,QAAhBqB,aAEA,OAAOx3C,KAAKC,OAAO03C,UAEvB,GAAoB,YAAhBH,aAA4B,CAC5B,GAAgB,SAAZG,SACA,MAAO,wBAGX,KAAM,2CAA6CA,SAGvD,GAAoBpsD,MAAhBisD,aACA,OAAO,KAIX,KAAM,gDAAkDA,cAK5De,WAAY,SAAUr0C,GAClB,IAEI29B,EAFOx+C,KAEOw0D,UAAU3zC,GAC5B,GAAc,MAAV29B,EAOJ,OAAOA,EAAO9rC,WAAWqyC,SAVd/kD,KAIEqiD,MAAMsQ,aAJR3yD,KAKEm1D,wBAAwBt0C,IAQzCu0C,UAAW,SAAUv0C,GACjB,IAEI29B,EAFOx+C,KAEOw0D,UAAU3zC,GAC5B,GAAc,MAAV29B,EAAJ,CAOA,GAAIA,EAAO9rC,WAAW2iD,QAClB,OAXOr1D,KAWKs1D,gBAAgB9W,EAAOphB,QAEnC,IAAI03B,EAAajoD,OAAOY,KAAKs8B,cAAcyU,EAAO9rC,WAAWzI,MAC7D,QAAI,YAAYiI,KAAK4iD,GAdd90D,KAIEqiD,MAAMsQ,aAJR3yD,KAKEm1D,wBAAwBt0C,IAiBzCy0C,gBAAiB,SAAU9W,GAEvB,OAAIA,EAAOphB,SACHohB,EAAO9rC,WAAW2iD,SAFfr1D,KAGSs1D,gBAAgB9W,EAAOphB,QAKhCohB,EAAO9rC,WAAW2iD,SAOjCE,cAAe,SAASlqD,OAAQwV,MAAOszC,cACnC,IAAIp0D,KAAOC,KAEX,QAAekI,IAAXmD,OACA,OAAOrL,KAAKw1D,UAAU30C,MAAOszC,cAGjC,IAAI71D,KAAO+M,OAAO/M,KAElB,GAAIA,MAAAA,KAIA,OAHIyB,KAAKsiD,MAAMsQ,aACX5yD,KAAKo1D,wBAAwBt0C,OAE1B,KAIX,IAAI6zC,UAAY30D,KAAK40D,iBAAiB9zC,OAGlC40C,WAAan3D,KAAKu2D,UAAUH,UAAUE,gBAE1C,IAAKa,WACD,OAAO,EAIX,IAAIC,UAAYp3D,KAAKq3D,oBAAoBjB,UAAUvzD,MAAOuzD,UAAUE,gBAsBpE,MApBkC,eAA9Ba,WAAW/iD,WAAWzI,OAGdyrD,UAFJA,UACIA,UAAUxwD,OAAS,GAAKwwD,UAAU,GAAGxwD,OAAS,EAClCwwD,UAAU,GAAG,GAEbA,UAAUp4D,GAGd,GAGc,eAA9Bm4D,WAAW/iD,WAAWzI,OACtByrD,UAAaA,WAAaA,UAAUp4D,GAAMo4D,UAAUp4D,GAAK,GAG3B,gBAA9Bm4D,WAAW/iD,WAAWzI,OACtByrD,UAAaA,WAAaA,UAAUp4D,GAAMo4D,UAAUp4D,GAAK,GAIzDuP,OAAOY,KAAKqT,QAAQ40C,YAEA,WAAhBvB,aACqC,SAAjCsB,WAAW/iD,WAAWugC,SAGf,KAME,WAAhBkhB,cAA+C,QAAhBA,eAA2BtnD,OAAOY,KAAKqT,QAAQ/gB,KAAKy0D,UAAU3zC,MAAOszC,cAAcvwD,OAC5GqN,KAAKlR,KAAKw0D,cAAcmB,UAAWvB,qBAGnB,IAAhB,iBAAiE,IAA1BsB,WAAqB,iBAA2D,IAA/BA,WAAW/iD,WAAe,MAAkD,cAA9B+iD,WAAW/iD,WAAWzI,OACnKyrD,UAAY7oD,OAAOY,KAAKgmB,cAAc8E,qBAAqBm9B,YAExDA,YAMXF,UAAW,SAAU30C,MAAOszC,cACxB,IAAIp0D,KAAOC,KAAMc,EAAG80D,aAEhBC,QAAU91D,KAAK+1D,WAAWj1C,OAC9B,GAAe,MAAXg1C,QAIA,OAHI91D,KAAKsiD,MAAMsQ,aACX5yD,KAAKo1D,wBAAwBt0C,OAE1B,KAGX,IAAIk1C,iBAeJ,IAdA54D,EAAE0D,KAAKg1D,QAAS,SAAU/0D,EAAG09C,GACrBA,EAAO9rC,WAAWqyC,UAClBgR,cAAcntD,KAAK41C,KAKE,IAAzBuX,cAAc7wD,QACd/H,EAAE0D,KAAKg1D,QAAS,SAAU/0D,EAAG09C,GACzBuX,cAAcntD,KAAK41C,KAI3B19C,EAAI,EACGA,EAAIi1D,cAAc7wD,QAAQ,CAC7B0wD,aAAeG,cAAcj1D,KAC7B,IAAIk1D,QAA2C,QAAhCJ,aAAaljD,WAAWzI,KACvC,GAAK+rD,QAyCE,CAGH,IAAItB,UAAY30D,KAAK40D,iBAAiB9zC,OAGlC40C,WAAaG,aAAaf,UAAUH,UAAUE,gBAElD,IAAKa,WACD,SAGJ,IAAIC,UAAYE,aAAaD,oBAAoBjB,UAAUvzD,MAAOuzD,UAAUE,gBAsB5E,MApBkC,eAA9Ba,WAAW/iD,WAAWzI,OAGdyrD,UAFJA,UACIA,UAAUxwD,OAAS,GAAKwwD,UAAU,GAAGxwD,OAAS,EAClCwwD,UAAU,GAAG,GAEbA,UAAUp4D,GAGd,GAGc,eAA9Bm4D,WAAW/iD,WAAWzI,OACtByrD,UAAaA,WAAaA,UAAUp4D,GAAMo4D,UAAUp4D,GAAK,GAG3B,gBAA9Bm4D,WAAW/iD,WAAWzI,OACtByrD,UAAaA,WAAaA,UAAUp4D,GAAMo4D,UAAUp4D,GAAK,GAIzDuP,OAAOY,KAAKqT,QAAQ40C,YAEA,WAAhBvB,aACqC,SAAjCsB,WAAW/iD,WAAWugC,SAGf,KAME,WAAhBkhB,cAA+C,QAAhBA,eAA2BtnD,OAAOY,KAAKqT,QAAQ/gB,KAAKy0D,UAAU3zC,MAAOszC,cAAcvwD,OAC5GqN,KAAKlR,KAAKw0D,cAAcmB,UAAWvB,qBAGnB,IAAhB,iBAAiE,IAA1BsB,WAAqB,iBAA2D,IAA/BA,WAAW/iD,WAAe,MAAkD,cAA9B+iD,WAAW/iD,WAAWzI,OACnKyrD,UAAY7oD,OAAOY,KAAKgmB,cAAc8E,qBAAqBm9B,YAExDA,WA5FP,IAAI9xD,MAAQgyD,aAAajjD,WACrBmiD,WAAajoD,OAAOY,KAAKs8B,cAAc6rB,aAAaljD,WAAWzI,MAAQ,IAE3E,YAAqB/B,IAAjBisD,cAA+C,cAAjBA,aACvBvwD,SAIN,QAAS,OAAQ,SAAU,SAASmP,SAAS+hD,aAAe,oBAAoB5iD,KAAK4iD,eAClFjoD,OAAOY,KAAKqT,QAAQld,QAAsB,IAAZA,MAAMtG,MACpCsG,MAAQ,GAIG,kBAAfkxD,WACyB,iBAAVlxD,MAAsB+Y,KAAKhE,MAAM/U,OAAOA,MAAQA,MAG/DiJ,OAAOY,KAAKqT,QAAQld,QAED,YAAfkxD,YAAgE,UAApCc,aAAaljD,WAAWugC,aAIpDpmC,OAAOY,KAAKqT,QAAQld,QAED,YAAfkxD,YAAgE,UAApCc,aAAaljD,WAAWugC,UAKrDrvC,OAGU,UAAjBuwD,aACOljD,KAAKlR,KAAKw0D,cAAc1zC,MAAOszC,eAE/BljD,KAAKlR,KAAKw0D,cAAc3wD,MAAOuwD,kBAkEtD8B,eAAgB,SAAUp1C,GACtB,IAEIjd,EAFO5D,KAEMw1D,UAAU30C,GAE3B,SAAIjd,GAASA,EAAMsB,QACXtB,EAAMsB,OAAS,IAS3BgxD,aAAc,SAAUtyD,GAEpB,SAAIA,IAASA,EAAMka,MAAM,IAAIrP,OADjB,+JAShB0nD,gBAAiB,SAAU1jD,EAAS2jD,GAEhC,IAAI5X,EAASx+C,KAAKy0D,cAAchiD,GAC5BqiD,EAAajoD,OAAOY,KAAKs8B,cAAcyU,EAAO9rC,WAAWzI,MAC7D,QAAe,OAAXu0C,IAAoB,YAAYtsC,KAAK4iD,KAElCsB,GAKXC,oBAAqB,SAAU5jD,EAAS2jD,GAEpC,IAAIE,EAAet2D,KAAK20D,iBAAiBliD,GACrCiiD,EAAY4B,EAAa5B,UACzBlW,EAASx+C,KAAKw0D,UAAUE,GACxBh2D,EAAS43D,EAAa1B,gBAAkB,GAU5C,OAPIwB,GAAW5X,GAAUA,EAAOjhD,SAC5BJ,EAAE0D,KAAK29C,EAAOjhD,QAAS,SAAUwD,EAAK6C,GAC7BA,EAAM8O,WAAWmO,QAAUniB,GAAUkF,EAAM8O,WAAWpV,KAAOoB,GAAqC,iBAA1BkF,EAAM8O,WAAWzI,OAC1FmsD,GAAU,KAIfA,GAMXG,UAAW,SAAU3yD,EAAO2yD,GACxB,OAAI3yD,MAAAA,GAGG2yD,GAMXxjD,SAAU,SAAUnP,EAAO0wD,GACvB,OAAI,MAAO1wD,IAGP,MAAO0wD,GAGGn3D,EAAEq5D,KAAK5yD,EAAO,SAAUqK,GAClC,OAAOA,EAAE3Q,IAAMg3D,IAEPpvD,OAAS,IASzBuxD,iBAAkB,SAAU51C,EAAO61C,GAI/B,UAHW12D,KACKw0D,UAAU3zC,UAEd61C,IAUhBZ,WAAY,SAAUj1C,GAClB,IACI2kC,EADOxlD,KACKwlD,KAEZqQ,EAAU,KAGVc,EAJQ,gBAIU33C,KAAK6B,GAC3B,GAAI81C,GAAaA,EAAUzxD,OAAS,EAAG,CACnC,IAAIs5C,EARGx+C,KAQWy0D,cAAckC,EAAU,IAC1C,OAAInY,EACqB,GAAjBA,EAAOt5C,OACA,OAEP2wD,MACQjtD,KAAK41C,GACNqX,GAGJ,KAMf,OAAsB,IADtBA,EAAUrQ,EAAKsQ,WAAWj1C,IACd3b,OACD,KACJ2wD,GAKXrB,UAAW,SAAU3zC,GAIjB,OAHW7gB,KACKwlD,KAEJgP,UAAU3zC,IAK1B4zC,cAAe,SAAUn3D,GAIrB,OAHW0C,KACKwlD,KAEJiP,cAAcn3D,IAK9B63D,wBAAyB,SAAUt0C,GAC/BhU,OAAO45C,MAAM,8BAAgC5lC,IAKjD+1C,2BAA4B,SAAUC,GAClChqD,OAAO45C,MAAM,iCAAmCoQ,IAKpDC,eAAgB,WACZ,IAAIC,EAAc,IAAI9jD,KAItB,OADA8jD,EAAYr+B,SAAS,EAAG,EAAG,EAAG,GACvBq+B,GAKXpC,iBAAkB,SAAU9zC,GAGxB,IAEI1f,EAAOyzD,EAAgBF,EADvBsC,EADQ,IAAIvoD,OAAO,wCACHuQ,KAAK6B,GAWzB,OATIm2C,GACAtC,EAAYsC,EAAQ,GACpB71D,EAAQ61D,EAAQ,GAChBpC,EAAiBoC,EAAQ,KAEzB71D,EAAQ,GACRyzD,EAAiB,KAGZ/zC,MAAOA,EAAO1f,MAAOA,EAAOyzD,eAAgBA,EAAgBF,UAAWA,IAKpFuC,uBAAwB,SAAUpE,EAAYqE,GAC1C,IACIp2D,EAEJ,GAAI+xD,EACA,OAJO7yD,KAIKuzD,+BAA+BV,GAI/C,GAAIqE,EACA,IAAKp2D,KAAKo2D,EAAU,CAChB,IAAIC,EAAUD,EAASp2D,GACvB,OAXGd,KAWSo3D,gCAAgCD,GAIpD,OAAO,MAKXC,gCAAiC,SAASD,GACtC,OAAIA,EAAQt2C,OAASs2C,EAAQt2C,MAAM3W,QAAQ,MAAQ,EACxCitD,EAAQt2C,MAAMrC,UAAU,EAAG24C,EAAQt2C,MAAM3W,QAAQ,OAIhC,SAAxBitD,EAAQhD,cACJgD,EAAQ7C,SAASpqD,QAAQ,MAAQ,EAC1BitD,EAAQ7C,SAAS91C,UAAU,EAAG24C,EAAQ7C,SAASpqD,QAAQ,YAFtE,GAUJqpD,+BAAgC,SAAUI,GACtC,IACI0D,EADAt3D,EAAOC,KAEX,GAA2B,iBAAhB,GAAmD,kBAAhB,EAC1C,OAAO,KACX,GAAI2zD,EAAUV,aACV,IAAKnyD,KAAK6yD,EAAUV,YAChB,GAAGU,EAAUV,YAAY17C,eAAezW,KACpCu2D,EAAsBt3D,EAAKwzD,+BAA+BI,EAAUV,YAAYnyD,KAE5E,OAAOu2D,MAIhB,CAAA,GAAI1D,EAAUN,OACjB,OAAOtzD,EAAKwzD,+BAA+BI,EAAUN,QAElD,GAAIM,EAAUF,QACjB,OAAO1zD,EAAKwzD,+BAA+BI,EAAUF,SAGrD,GAAIE,EAAU9yC,OAAS8yC,EAAUK,SAAU,CAGvC,GADAqD,EAAsBt3D,EAAKu3D,2BAA2B3D,EAAU9yC,QAAU9gB,EAAKu3D,2BAA2B3D,EAAUK,UAEhH,OAAOqD,EAGX,GAA8B,SAA1B1D,EAAUQ,eACVkD,EAAsBt3D,EAAKu3D,2BAA2B3D,EAAUW,WAE5D,OAAO+C,GAOvB,OAAO,MAKXC,2BAA4B,SAAUz2C,GAElC,OAAIA,GAASA,EAAM3W,QAAQ,MAAQ,EACxB2W,EAAMrC,UAAU,EAAGqC,EAAM3W,QAAQ,OAErC,MAEXqtD,eAAgB,SAAU12C,EAAO+iC,GAC7B,IACIgR,EADO50D,KACe20D,iBAAiB9zC,GAAO+zC,eAIlD,OALW50D,KAEKw0D,UAAU3zC,GACR22C,eAAe5T,EAAcgR,MC78BvD/nD,OAAOsqD,QAAQpxB,YAAY0xB,WAAWhxD,OAAO,4CAKzC+Q,KAAM,SAAUguC,EAAMkS,EAAaC,GAC/B,IAAI53D,EAAOC,KAGXD,EAAK63D,aAAc,EAGnB53D,KAAKsN,OAAOk4C,GAEZ,IAAI3jC,EAAwB3Z,MAAZyvD,EAAwBA,EAAS91C,UAAY2jC,EAAK3jC,UAE9Dg2C,EAAgB16D,EAAE,WAAW+G,SAAS2d,GAG1C1kB,EAAEC,OAAQ,0BAA2BD,EAAEoP,GAAGurD,sBACtCC,OAAQ,WACJ/3D,KAAKsN,SACLvN,EAAKylD,KAAKwS,qBAAqB,0BAEnCr6D,SAAU,WACNqC,KAAKsN,SACLvN,EAAKylD,KAAKwS,qBAAqB,6BAEnC7yD,KAAM,WACFnF,KAAKsN,SACLvN,EAAKylD,KAAKwS,qBAAqB,+BAKvCH,EAAcC,sBACVG,SAAU,uBACVC,WAAW,EACXC,cAAc,EACdl6D,MAAOunD,EAAKz4C,YAAY,uCACxBiX,OAAQnX,OAAOY,KAAKoG,eACpB/P,YAAa0hD,EAAK9yC,WAAW5O,cAKjC+zD,EAAc7yD,KAAK,YAAa,SAAUiJ,EAAG1B,GACzCxM,EAAKq4D,oBAAoB7rD,EAAG1O,QAI5B65D,GACA33D,EAAKs4D,iBAAiBX,GAG1B33D,EAAK83D,cAAgBA,EACrB93D,EAAK23D,YAAcA,OAOvBW,iBAAkB,SAAUX,GACxB,IAAI33D,EAAOC,KACPs4D,EAAgBv4D,EAAKw4D,oBAAoBb,GAE7C33D,EAAKylD,KAAKxgD,KAAK,iBAAkB,WAC7B,OAAOszD,EAAcv4D,MAO7By4D,iBAAkB,SAAU9hD,GACxB7J,OAAO4rD,sBAAuB,EAC9Bz4D,KAAK04D,sBAAsBhiD,EAAS,KAAM,uBAAwB,mBAMtEiiD,iBAAkB,SAAUjiD,GACxB1W,KAAK04D,sBAAsBhiD,EAAS,KAAM,gBAAiB,uBAM/DkiD,gBAAiB,SAAUliD,GACvB1W,KAAK04D,sBAAsBhiD,EAAS,KAAM,eAAgB,uBAM9DgiD,sBAAuB,SAAUhiD,EAAS2wB,EAAOzX,EAAMipC,EAAqB5uD,EAAM+pD,GAC9E,IAAIj0D,EAAOC,KACPwlD,EAAOzlD,EAAKylD,KACZhH,EAAS,KAGTA,EADAwV,EACSxO,EAAKiP,cAAcT,IAAa,KAEhC3sB,EAAQme,EAAKgP,UAAUntB,GAAS,KAG7Cx6B,OAAO4rD,sBAAuB,EAG9B,IAAIK,EAAsB,WAEtB/4D,EAAKg5D,0BAGLh5D,EAAKi5D,YAAa,EAClBj5D,EAAKk5D,qBACLl5D,EAAKi5D,YAAa,EAGoB,GAAlCj5D,EAAKm5D,2BACLn5D,EAAKo5D,yBACLp5D,EAAKylD,KAAKwS,qBAAqB,6BAE/Bj4D,EAAKylD,KAAKwS,qBAAqB,yBAGnCxS,EAAKwS,qBAAqB,6BAI9Bj4D,EAAK83D,cAAcC,qBAAqB,kBAAmBphD,EAAS2wB,EAAOzX,EAAMipC,EAAqBC,EAAqB7uD,EAAM+pD,GAE7HxV,IAEAA,EAAO4a,qBAAqB1iD,GAEvB7J,OAAOY,KAAK+P,SAGRzd,EAAKi5D,YAAYxa,EAAO6a,IAAI,iBAAkBP,KAQ/DI,wBAAyB,WACrB,OAAOl5D,KAAK63D,cAAcC,qBAAqB,UAMnDiB,wBAAyB,SAAU1tD,GAG/B,OAFuBlO,EAAE,qCAAsC,QAAQy0B,IAAI,4BAEnDkmC,qBAAqB,gBAAY5vD,EAAWmD,IAMxE8tD,uBAAwB,WACpB,OAAOn5D,KAAK63D,cAAcC,qBAAqB,SAMnDwB,uBAAwB,WACpB,OAAOt5D,KAAK63D,cAAcC,qBAAqB,SAMnDyB,sBAAuB,SAAUC,GAG7B,OADkB,IAAdA,GAAqBx5D,KAAK63D,cAAcC,qBAAqB,uBAC1D93D,KAAK63D,cAAcC,qBAAqB,WAGnD2B,0BAA2B,WACvB,OAAOz5D,KAAK63D,cAAcC,qBAAqB,eAAiB93D,KAAK63D,cAAcC,qBAAqB,qBAM5GmB,mBAAoB,SAAUS,GAC1B,IAAI35D,EAAOC,KAGXD,EAAKg5D,0BACLh5D,EAAK83D,cAAcC,qBAAqB,aAGxC,IAAI6B,EAAgB55D,EAAK65D,gBAAgBF,GAGrCG,IAAa95D,EAAK23D,YAAYxyD,OAAS,IAAInF,EAAKylD,KAAKsU,eAAe,kBAIxE,OAHA/5D,EAAK83D,cAAcC,qBAAqB,eAGnC+B,IAAeF,KAChB55D,EAAK83D,cAAcC,qBAAqB,SACjC,IAWfS,oBAAqB,SAAUb,GAI3B,IAHA,IACIqC,EAAU,GAELj5D,EAAI,EAAGA,EAAI42D,EAAYxyD,OAAQpE,IAAK,CAGzC,GAD2CoH,MAA1BwvD,EAAY52D,GAAGk5D,SAAyBtC,EAAY52D,GAAGk5D,QAIpE,IAAMD,GATH/5D,KASmBi6D,gBAAgBvC,EAAY52D,GAAG+xD,WAAY6E,EAAY52D,GAAGo5D,mBAAsB,MAAOjsD,GACxF,2BAAbA,EAAEyI,SACF7J,OAAOstD,SAAS,gCAAkClsD,EAAEyI,QAASghD,EAAY52D,KAOzF,IAAIs5D,EAAa,oEAAsEL,EAAU,gCAGjG,OArBW/5D,KAqBCq6D,eAAeD,IAM/BH,gBAAiB,SAAUpH,EAAYqH,GACnC,IACI/G,EAAe,GACfmH,EAAgB,GAGhBC,EALOv6D,KAKci3D,uBAAuBpE,GAC5CC,EAAkC,MAAjByH,EAGrBpH,GAAgB,KATLnzD,KASiB4yD,gBAAgBC,EAAYC,GAAe,GAAQ,KAG/EoH,EAAkBxjD,QAAUwjD,EAAkBxjD,QAAQ/R,QAAQ,KAAM,OACpEu1D,EAAkBxjD,QAAUwjD,EAAkBxjD,QAAQ/R,QAAQ,MAAO,KAGrE,IAAI0iC,EAAQ6yB,EAAkB7yB,OAAS,GAQvC,GAPIyrB,IAAezrB,EAAQkzB,GACvBL,EAAkBM,OAClBF,GAAiB,gCAAkCJ,EAAkBxjD,QAAU,OAAS2wB,EAAQ,kBAAoB1qB,KAAKC,OAAOs9C,EAAkBM,QAAU,2BAE5JF,GAAiB,gCAAkCJ,EAAkBxjD,QAAU,OAAS2wB,EAAQ,0BAG/FyrB,EAIE,CACH,IAAI2H,EAAiB,mCAAqCF,EAAgB,UAQ1E,OAPAE,GAAkB,qCAClBA,GAAkB,oCAClBA,GAAkB,6BAClBA,GAAkB,oCAClBA,GAAkB,OAAStH,EAAe,mCAC1CsH,GAAkB,UAClBA,GAAkB,iCAAmCH,EAAgB,QATrE,MAAO,OAASnH,EAAe,UAAYmH,EAAgB,UAiBnElC,oBAAqB,SAAUv6D,GAC3B,IACI2nD,EADOxlD,KACKwlD,KACZ3kC,EAAQhjB,EAAKwpC,MACb2sB,EAAWn2D,EAAKP,GAEpB,GAAIujB,EAAO,CACP,IAAI29B,EAASwV,EAAWxO,EAAKiP,cAAcT,GAAYxO,EAAKgP,UAAU3zC,GAElE29B,GACAA,EAAOnX,UAQnBuyB,gBAAiB,SAAUF,GACvB,IAAI35D,EAAOC,KACX05D,EAAkBA,MAGlB,IAAIgB,EAAS36D,EAAKylD,KAAKx7C,QAAQ0vD,GAY/B,OAXKgB,GACDhB,EAAgBiB,QAAQ,SAAS16D,GACzBA,EAAQ3C,GAERyC,EAAK66D,0BAA0B36D,EAAQyW,QAASzW,EAAQ4gB,MAAO5gB,EAAQ3C,KAChE2C,EAAQyW,SAAWzW,EAAQ4gB,QAClC9gB,EAAK24D,sBAAsBz4D,EAAQyW,QAASzW,EAAQ4gB,SAKzD65C,GAMXL,eAAgB,SAAUlD,SACtB,IAAIp3D,KAAOC,KAMX,OAJID,KAAK63D,aAA0B1vD,MAAXuY,SACpBA,QAAQC,IAAIy2C,SAGTlmD,KAAKkmD,UAShByD,0BAA2B,SAAUlkD,EAASmK,EAAOmzC,GACjDh0D,KAAK04D,sBAAsBhiD,EAASmK,OAAO3Y,GAAW,OAAOA,EAAW8rD,MC/VhFnnD,OAAOsqD,QAAQpxB,YAAY0xB,WAAWhxD,OAAO,wCAIzC+Q,KAAM,SAAUguC,EAAMnmD,GAClB,IAAIU,EAAOC,KAGXA,KAAKsN,OAAOk4C,GAGZzlD,EAAK86D,sBACL96D,EAAK+6D,wBACL/6D,EAAKg7D,6BAA+B,IAAI59D,EAAE4S,SAGtC1Q,GACAU,EAAKi7D,aAAa37D,GAGtBU,EAAKV,QAAUA,EACfU,EAAKk7D,yBAGLl7D,EAAKm7D,mBAAqB,GAC1Bn7D,EAAKo7D,sBAAwB,GAC7Bp7D,EAAKq7D,kBACLr7D,EAAKs7D,OAAS,IAKlBC,4BAA6B,SAAUz6C,EAAOzV,GAC/BpL,KAIFi7D,sBAAsBp6C,KAJpB7gB,KAQNi7D,sBAAsBp6C,GAASzV,EARzBpL,KASNu7D,YAAYnwD,GAAQ,KAG7BowD,sBAAuB,WACnB,IACIzzD,GAAS,EAGb,MADsC,gBAH3B/H,KAGFwlD,KAAK9yC,WAAW+oD,UAAgE,eAH9Ez7D,KAGiDwlD,KAAK9yC,WAAW+oD,WAA2B1zD,GAAS,GACzGA,GAGX2zD,iBAAkB,SAAUtwD,GAKxB,IAJA,IAA+C+rD,EAA9Br2D,EAAI,EAAG66D,GAAgB,EACpCzE,KAAch/C,OAAO9M,EAAO8rD,SAAU9rD,EAAOwwD,cAC7C12D,EAASgyD,EAAShyD,OAEfpE,EAAIoE,EAAQpE,IAEf,GADAq2D,EAAUD,EAASp2D,IALZd,KAMG67D,eAAe1E,GAAU,CAC/BwE,GAAgB,EAChB,MAIJA,IACAvwD,EAAO4uD,SAAU,IAKzBgB,aAAc,SAAU37D,EAASy8D,GAC7B,IAAiBh7D,EAAGukB,EAAhBtlB,EAAOC,KACP+7D,KAEAC,EAA2Bj8D,EAAKy7D,wBAEpC,IAAK16D,EAAI,EAAGukB,EAAMhmB,EAAQ6F,OAAQpE,EAAIukB,EAAKvkB,IAEvC,IACI,IAAIsK,EAAS/L,EAAQyB,GACjByiB,EAAO1W,OAAOY,KAAKgJ,IAAIkG,KAAK1E,UAAU7M,EAAOynD,aAC7CoJ,EAAQpvD,OAAOY,KAAKgJ,IAAIkG,KAAK1E,UAAU7M,EAAO8rD,WAC9C6E,EAAOx4C,IAC8B,IAAjCw4C,EAAOx4C,GAAMrZ,QAAQ+xD,KAErBD,GAA4Bj8D,EAAK27D,iBAAiBtwD,GAClDrL,EAAKw7D,YAAYnwD,EAAQ0wD,GACzBC,EAAOx4C,GAAM3a,KAAKqzD,KAGtBD,GAA4Bj8D,EAAK27D,iBAAiBtwD,GAClDrL,EAAKw7D,YAAYnwD,EAAQ0wD,GACzBC,EAAOx4C,IAAS04C,IAEtB,MAAOhuD,GAEa,4BAAdA,EAAEyI,SACF7J,OAAOstD,SAAS,4BAA8BlsD,EAAEyI,QAASrX,EAAQyB,MAQjFo7D,cAAe,WAIX/+D,EAAE0D,KAHSb,KAGC66D,mBAAoB,SAAU/5D,EAAG09C,GACzCA,EAAOr3B,OAAO,yBAJPnnB,KAON66D,sBAGL19D,EAAE0D,KAVSb,KAUC86D,qBAAsB,SAAUh6D,EAAGq7D,GAC3Cn6D,aAAam6D,KAXNn8D,KAaN86D,yBAKTsB,eAAgB,SAAUC,GACtB,IAAIt8D,EAAOC,KAEXD,EAAKm7D,mBAAqB,GAC1Bn7D,EAAK+6D,wBAELuB,EAAaA,MAGbt8D,EAAKV,QAAUU,EAAKV,QAAQ6Y,OAAOmkD,GACnCt8D,EAAKi7D,aAAaj7D,EAAKV,SAAS,GAGhClC,EAAE0D,KAAKd,EAAKk7D,sBAAuB,SAAUqB,EAAGlxD,GAC5C,IACIrL,EAAKw7D,YAAYnwD,GAAQ,GAC3B,MAAO6C,GAEa,4BAAdA,EAAEyI,SACF7J,OAAOstD,SAAS,4BAA8BlsD,EAAEyI,QAAStL,OAMzEmwD,YAAa,SAAUnwD,EAAQ0wD,GAC3B,IAAI/7D,EAAOC,KACPwlD,EAAOzlD,EAAKylD,KACZ+W,KACAC,KAIJ,GAFmCt0D,MAAlBkD,EAAO4uD,SAAwB5uD,EAAO4uD,QAEvD,CAgCA,GA5BI5uD,EAAOynD,YAA4C,QAA9BznD,EAAOynD,WAAWG,WAClC5nD,EAAOmxD,eACRnxD,EAAOmxD,iBACXp/D,EAAE0D,KAAKuK,EAAO8rD,SAAU,SAAUoF,EAAGnF,GACjC,IAAIoD,EAAgBx6D,EAAKu3D,2BAA2BH,EAAQt2C,OAC5D,GAAI05C,EAAe,CACf,IAAoCj4D,EAAG+iB,EAAnCo3C,GAAyB,EAC7B,IAAKn6D,EAAI,EAAG+iB,EAAMja,EAAOmxD,aAAcj6D,EAAI+iB,EAAK/iB,IACxC8I,EAAOmxD,aAAaj6D,IAAMi4D,IAC1BkC,GAAyB,GAE5BA,GACDrxD,EAAOmxD,aAAa3zD,KAAK2xD,OAgBrCnvD,EAAOmxD,aACP,IAAK,IAAIz7D,EAAI,EAAGA,EAAIsK,EAAOmxD,aAAar3D,OAAQpE,IAC5C,QAAqC,IAA1BsK,EAAOmxD,aAAaz7D,GAAmB,CAC9C,IAAI+0D,EAAUrQ,EAAKsQ,WAAW1qD,EAAOmxD,aAAaz7D,IAClD,GAAuB,IAAnB+0D,EAAQ3wD,OAAc,CACtB,IAAIw3D,EAAalX,EAAKiP,cAAcrpD,EAAOmxD,aAAaz7D,IACxD+0D,EAAU,GAAgB6G,GAAc,KAGxC7G,GACA14D,EAAE0D,KAAKg1D,EAAS,SAAUyG,EAAG9d,GArB7C,IAA2Bv0C,EAsBH9M,EAAEw/D,QAAQne,EAAO9rC,WAAWpV,GAAIk/D,GAAkB,IAtB/CvyD,EAuBmBu0C,EAAO9rC,WAAWzI,MArB5B,KADhB,cAAe,uBAClBC,QAAQD,KAsBGuyD,EAAe5zD,KAAK41C,EAAO9rC,WAAWpV,IACtCi/D,EAAa3zD,KAAK41C,OAW9C,IAAIxxC,EAAKjN,EAAK68D,cAAcxxD,EAAOynD,WAAYznD,EAAO8rD,SAAU9rD,EAAOwwD,cAuCvE,GApCAz+D,EAAE0D,KAAK07D,EAAc,SAAUD,EAAG9d,GAC9BA,EAAOx5C,KAAK,sBAAuB,SAAU63D,EAAI5tD,GAO7C,IANAA,EAAOA,OAGF6tD,aAA2B50D,IAAjB+G,EAAK6tD,SAAwB7tD,EAAK6tD,QAG7C7tD,EAAKvQ,QACL,IAAK,IAAI4D,EAAI,EAAGA,EAAI8I,EAAO2xD,YAAY73D,OAAQ5C,IAC3C,GAAI2M,EAAKvQ,QAAU0M,EAAO2xD,YAAYz6D,GAGlC,YADA0K,EAAGjN,EAAMkP,QAMjBjC,EAAGjN,EAAMkP,KAKjBlP,EAAK86D,mBAAmBrc,EAAO9rC,WAAWpV,IAAMkhD,EAGjB,SAA3BA,EAAO9rC,WAAWzI,OAClB6xD,GAAc,EAGd1wD,EAAO2xD,eACPh9D,EAAKi9D,kBAAkB5xD,EAAOynD,WAAYznD,EAAO2xD,iBAKrDjB,EAAJ,CAKA,IAAwB/7D,EAEhB2rC,EAEAywB,EAJgBp8D,EAmBhBA,EAjBA2rC,EAAOtkC,KAAKskC,OAEZywB,EAASr6D,WAAW,WACpB,IAEIkL,EAAGjN,UACIA,EAAK+6D,qBAAqBpvB,GACnC,MAAOz9B,MAEVlO,EAAKm7D,oBAGRn7D,EAAK+6D,qBAAqBpvB,GAAQywB,EAClCp8D,EAAKm7D,oBAAsBn7D,EAAKo7D,yBASxCyB,cAAe,SAAU/J,WAAYqE,SAAU0E,cAC3C,IAAI77D,KAAOC,KAEPu6D,cAAgBx6D,KAAKk3D,uBAAuBpE,WAAYqE,UACxDpE,cAAkC,MAAjByH,eAAyBA,cAC1CpH,aAAe,GACf8J,UAAY,GACZ7C,WACA8C,cAAgB,GAChBC,mBAAoBvB,aACpBwB,aAAavK,WACb/xD,EAQJ,IALIs8D,aACAjK,cAAgBpzD,KAAK6yD,gBAAgBC,WAAYC,gBAIhDhyD,EAAI,EAAGA,EAAIo2D,SAAShyD,OAAQpE,IAAK,CAElC,IAAIu8D,YAAct9D,KAAKu9D,gBAAgBpG,SAASp2D,IAAM,cAAgB,MAClEq2D,QAAUp3D,KAAKw9D,aAAarG,SAASp2D,GAAIgyD,eAG7CqE,QAAWA,QAAQjtD,QAAQ,MAAQ,EAAKitD,QAAQxyD,QAAQ,IAAK,IAAMwyD,QACnE8F,WAAa,eAAiBI,YAAc,sBAAwBlG,QAAU,aAE1EgG,oBACAD,eAAiBn9D,KAAKy9D,oBAAoBtG,SAASp2D,GAAIgyD,gBAK/D,IAAKqK,kBAAmB,CAGpB,IAFAD,eAAiB,4CACjBA,eAAiB,iEACZp8D,EAAI,EAAGA,EAAI86D,aAAa12D,OAAQpE,IAAK,CACtC,IAAIu8D,YAAct9D,KAAKu9D,gBAAgB1B,aAAa96D,IAAM,cAAgB,MACtE28D,YAAc19D,KAAKw9D,aAAa3B,aAAa96D,GAAIgyD,eAErD2K,YAAeA,YAAYvzD,QAAQ,MAAQ,EAAKuzD,YAAY94D,QAAQ,IAAK,IAAM84D,YAC/EP,eAAiB,eAAiBG,YAAc,sBAAwBI,YAAc,aAE1FP,eAAiB,8DACjBA,eAAiB,wEACjBA,eAAiB,yEAiCrB,GA5BA9C,WAAa,6CACbA,YAAc,6BACVtH,gBACAsH,YAAc,0BACdA,YAAc,mCAEdgD,aACAhD,YAAc,OAASjH,aAAe,WAI1CiH,YAAc,4CACdA,YAAc,iEACdA,YAAc6C,UACd7C,YAAc,8DACdA,YAAc,wEACdA,YAAc,yEAEVgD,aACAhD,YAAc,UACV8C,cAAch4D,OAAS,IACvBk1D,YAAc,cAAgB8C,cAAgB,WAItD9C,YAAc,SAGTtH,cAEE,CACH,IAAI2H,eAAiB,+CACrBA,gBAAkB,yBAClBA,gBAAkB,qDAAuDF,cAAgB,iBACzFE,gBAAkB,sDAAwDF,cAAgB,kBAC1FE,gBAAkB,4BAClBA,gBAAkB,2CAClBA,gBAAkB,uCAClBA,gBAAkB,2CAClBA,gBAAkB,8BAClBA,gBAAkB,gCAClBA,gBAAkB,aAClBA,gBAAkB,eAClBA,gBAAkB,wCAClBA,gBAAkB,kCAClBA,gBAAkB,QAClBA,gBAAkB,SAClBL,YAAcK,eACdL,YAAc,mBAnBdA,YAAc,UAuBlB,OAAOnpD,KAAKmpD,aAMhBkD,gBAAiB,SAAUnG,GACvB,IAAIuG,EAAcvG,EAAQA,QAE1B,OAAQ,UAAW,cAAe,eAAgB,oBAAqB,cAAe,oBAAqB,qBAAqBpkD,SAAS2qD,IAG7I7B,eAAgB,SAAU1E,GACtB,IAAIuG,EAAcvG,EAAQA,QAE1B,OAAQ,mBAAoB,YAAa,UAAW,WAAY,WAAY,cAAcpkD,SAAS2qD,IAGvGC,eAAgB,SAAUz+B,EAAQi4B,GAC9B,IAAIp3D,EAAOC,KACPmyD,EAAMjzB,EAAS,IAAMi4B,EACzB,OAAgC,MAA5Bp3D,EAAKq7D,eAAejJ,KAGxBh1D,EAAEqM,KAAKzJ,EAAK69D,UAAU1+B,EAAQi4B,IAAUhvD,KAAK,kBAClCpI,EAAKq7D,eAAejJ,GAC3BtlD,OAAO6T,IAAI,WAAayxC,MAErB,IAGXyL,UAAW,SAAU1+B,EAAQi4B,GACzB,IACIhF,EAAMjzB,EAAS,IAAMi4B,EAGzB,OAJWn3D,KAENo7D,eAAejJ,GAAO,IAAIh1D,EAAE4S,SACjCjO,WAHW9B,KAGKo7D,eAAejJ,GAAKhiD,QAHzBnQ,KAGuCq7D,QAHvCr7D,KAICo7D,eAAejJ,GAAK5pD,WAKpCg1D,aAAc,SAAUpG,EAASrE,GAC7B,IAKIyH,EAFJzH,EAAgBA,IAAiB,EAK7B4K,EAAcvG,EAAQA,QACtBlD,EATOj0D,KASqB69D,0BAA0B1G,EAAQhD,aAAcuJ,GAC5EpJ,EAVOt0D,KAUSu0D,cAAc4C,EAAQ7C,SAAUL,EAAsBnB,EAAeqE,EAAQrT,cAC7FjjC,EAAQs2C,EAAQt2C,MAapB,GATIs2C,EAAQnD,WACRnzC,EAAQ,MAAQs2C,EAAQnD,UAIxBlB,GAAiBjyC,IACjBA,EAAQA,EAAMlF,WAAW,KAAM,gBAG9Bw7C,EAAQt2C,OAASs2C,EAAQt2C,MAAM3b,OAAS,GAAOiyD,EAAQnD,UAAYmD,EAAQnD,SAAS9uD,OAAS,EAE9F,OAAQw4D,GACJ,IAAK,mBACD,MAA4B,uBAAxBvG,EAAQ2G,YACD,gCAAkCj9C,EAAQ,MAAQyzC,EAAW,KAE7D,gCAAkCzzC,EAAQ,MAAQyzC,EAAW,KAG5E,IAAK,YACD,MAA4B,uBAAxB6C,EAAQ2G,YACD,gCAAkCj9C,EAAQ,MAAQyzC,EAAW,KAE7D,gCAAkCzzC,EAAQ,MAAQyzC,EAAW,KAG5E,IAAK,UACD,MAA4B,uBAAxB6C,EAAQ2G,YACD,gCAAkCj9C,EAAQ,MAAQyzC,EAAW,KAE7D,gCAAkCzzC,EAAQ,MAAQyzC,EAAW,KAG5E,IAAK,WACD,MAA4B,uBAAxB6C,EAAQ2G,YACD,iCAAmCj9C,EAAQ,MAAQyzC,EAAW,KAE9D,iCAAmCzzC,EAAQ,MAAQyzC,EAAW,KAG7E,IAAK,WACD,MAAO,8BAAgCzzC,EAAQ,MAAQyzC,EAAW,KAEtE,IAAK,YAQD,OANIxB,GAA0C,UAAzBqE,EAAQhD,cAA8BgD,EAAQrT,eAE/DqT,EAAQ7C,SAAW6C,EAAQrT,aAAe,IAAMqT,EAAQ7C,SACxDA,EA/DLt0D,KA+DqBu0D,cAAc4C,EAAQ7C,SAAUL,EAAsBnB,IAGnE,2BAA6BjyC,EAAQ,MAAQyzC,EAAW,KAEnE,IAAK,UACD,MAAO,8BAAgCzzC,EAAQ,MAAQyzC,EAAW,KAEtE,IAAK,UACD,MAAO,8BAAgCzzC,EAAQ,MAAQyzC,EAAW,KAEtE,IAAK,YACD,MAAO,gCAAkCzzC,EAAQ,MAErD,IAAK,eACD,MAAO,sBAAwBA,EAAQ,OAASyzC,EAAW,MAE/D,IAAK,aACD,MAAO,yBAA2BzzC,EAAQ,MAI9C,IAAK,UAGD,OAxFD7gB,KAsFgCo3D,gCAAgCD,GAGpD,yBAA2Bt2C,EAAQ,QAAes2C,EAAQrT,cAAgB,IAAM,MAEhF,wBAA0BjjC,EAAQ,QAAes2C,EAAQrT,cAAgB,IAAM,MAAQ4Z,EAAc,MAGpH,IAAK,gBACD,MAAO,sBAAwB78C,EAAQ,WAM/C,OAAQ68C,GACJ,IAAK,mBACD,MAAO,mCAAqCvG,EAAQt1C,UAAY,MAAQyyC,EAAW,KAEvF,IAAK,UACD,MAAO,mCAAqC6C,EAAQt1C,UAAY,MAAQyyC,EAAW,KAEvF,IAAK,WACD,MAAO,yBAA2B6C,EAAQt1C,UAAY,OAAShV,OAAOY,KAAKuF,aAAashD,GAAY,KAExG,IAAK,aACD,MAAO,0BAA4B6C,EAAQt1C,UAAY,MAE3D,IAAK,WACD,MAAO,oCAAsCs1C,EAAQt1C,UAAY,MAAQhV,OAAOY,KAAKuF,aAAashD,GAAY,KAIlH,IAAK,UAED,MAAO,0BAA4B6C,EAAQt1C,UAAY,QAAes1C,EAAQrT,cAAgB,IAAM,MAMhH,GAAoB,gBAAhB4Z,EACA,MAAO,yBAGX,GAAoB,iBAAhBA,EAAgC,CAChC,IAAIK,EAAU5G,EAAQ7C,aAClB0J,EAAW,GACf,IACIA,EAAWrhD,KAAKhE,MAAMolD,GAASryB,KACjC,MAAOz9B,IAGT,IAAI61C,EAAeqT,EAAQrT,cAAgB,GAC3C,GAAIgP,EAAe,CACf,IAAImL,EAAkB1D,EAAgB,UACtC,MAAO,qBAAuByD,EAAW,cAAgBC,EAAkB,UAAYP,EAAc,MAErG,MAAO,qBAAuBM,EAAW,MAAQla,EAAe,MAAQ4Z,EAAc,MAI9F,GAAoB,sBAAhBA,EAAqC,CACrC,IAAIQ,EAAe/G,EAAQ7C,aACvB6J,EAAgB,GAEpB,IACIA,EAAgBxhD,KAAKhE,MAAMulD,GAAcxyB,KAC3C,MAAOz9B,IAIT,OADA61C,EAAeqT,EAAQrT,cAAgB,GACnCgP,EAEO,0BAA4BqL,EAAgB,eADnDF,EAAkB1D,EAAgB,WACmD,SAE9E,0BAA4B4D,EAAgB,MAAQra,EAAe,MAIlF,GAAoB,gBAAhB4Z,EAA+B,CAC/B,IAAIU,EAAejH,EAAQ7C,aACvBjH,EAAU,GAEd,IACIA,EAAU1wC,KAAKhE,MAAMylD,GAAc1yB,KACrC,MAAOz9B,IAIT,OADA61C,EAAeqT,EAAQrT,cAAgB,GACnCgP,EAEO,6BAA+BzF,EAAU,eADhD4Q,EAAkB1D,EAAgB,WACgD,SAE3E,6BAA+BlN,EAAU,MAAQvJ,EAAe,MAI/E,GAAoB,sBAAhB4Z,GAAuD,sBAAhBA,EAAqC,CACxEU,EAAejH,EAAQ7C,aAA3B,IACI/G,EAAgB,GAEpB,IACIA,EAAgB5wC,KAAKhE,MAAMylD,GAAc1yB,KAC3C,MAAOz9B,IAIT,OADA61C,EAAeqT,EAAQrT,cAAgB,GACnCgP,EAEO,0BAA4BvF,EAAgB,eADnD0Q,EAAkB1D,EAAgB,WACmD,SAE9E,0BAA4BhN,EAAgB,MAAQzJ,EAAe,MAKlF,OADAj3C,OAAO6T,IAAI,2CAA6Cg9C,GACjD,IAKXF,oBAAqB,SAAUrG,EAASrE,GACpC,IAAIjyC,EAAQs2C,EAAQt2C,MAChB68C,EAAcvG,EAAQA,QAgB1B,OAbArE,EAAgBA,IAAiB,EAG7BqE,EAAQnD,WACRnzC,EAAQ,MAAQs2C,EAAQnD,UAIxBlB,IACAjyC,EAAQA,EAAMlF,WAAW,KAAM,gBAI/BkF,GAASA,EAAM3b,OAAS,EACjB,uBAAyB2b,EAAQ,OAAS68C,EAAc,MAExD,0BAA4BvG,EAAQt1C,UAAY,OAAS67C,EAAc,OAMtFG,0BAA2B,SAAU1J,EAAcuJ,GAC/C,QAAqBx1D,IAAjBisD,EACA,OAAOA,EAEJ,GAAoB,SAAhBA,EAAyB,CAEhC,GAAmB,oBAAfuJ,EACA,MAAO,QACX,GAAmB,aAAfA,EACA,MAAO,QACX,GAAmB,WAAfA,EACA,MAAO,UACX,GAAmB,YAAfA,EACA,MAAO,UACX,GAAmB,YAAfA,EACA,MAAO,UACX,GAAmB,aAAfA,EACA,MAAO,OACX,GAAmB,YAAfA,EACA,MAAO,UACX,GAAmB,cAAfA,EACA,MAAO,SACX,GAAmB,WAAfA,EACA,MAAO,OACX,GAAmB,WAAfA,EACA,MAAO,OACX,GAAmB,aAAfA,EACA,OACJ,GAAmB,WAAfA,EACA,OACJ,GAAmB,gBAAfA,EACA,MAAO,YAER,GAAqB,UAAjBvJ,GAA6C,WAAjBA,EACnC,OAAOA,EAIX,OADAtnD,OAAO6T,IAAI,2CAA6Cg9C,GACjD,MAKXW,cAAe,SAAUx9C,EAAO68C,GAC5B,IAAI39D,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACzB,IAAI9rC,EAAa8rC,EAAO8f,mBACpBC,EAAa7rD,EAAW6rD,eACT,oBAAfb,GACA39D,EAAKy+D,uBAAuB39C,EAAO09C,EAAWn5B,YAAc,IAC7C,aAAfs4B,GACA39D,EAAK0+D,uBAAuB59C,EAAO09C,EAAWG,OAAS,QACxC,WAAfhB,GACA39D,EAAK4+D,uBAAuB99C,EAA6B3Y,MAAtBwK,EAAW2iD,SAAuB3iD,EAAW2iD,SACjE,YAAfqI,GACA39D,EAAK6+D,wBAAwB/9C,EAA8B3Y,MAAvBwK,EAAWqyC,UAAwBryC,EAAWqyC,UACnE,YAAf2Y,GACA39D,EAAK8+D,qBAAqBh+C,EAA8B3Y,MAAvBwK,EAAWosD,UAAwBpsD,EAAWosD,YAlB/E/+D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAwBzCk+C,iBAAkB,SAAUlI,EAAa6G,GACrC,IAAI39D,EAAOC,KAEP6hB,EADO9hB,EAAKylD,KACK3K,aAAagc,GAClC,GAAiB,MAAbh1C,EAAJ,CAOA,IAAInP,EAAamP,EAAUy8C,mBACR,oBAAfZ,GACA39D,EAAKi/D,0BAA0BnI,EAAankD,EAAWusD,iBAAmB,QAC3D,WAAfvB,GACA39D,EAAKm/D,0BAA0BrI,EAAmC3uD,MAAtBwK,EAAW2iD,SAAuB3iD,EAAW2iD,SAC1E,YAAfqI,GACA39D,EAAKo/D,gBAAgBtI,GAAa,GAEnB,YAAf6G,GACA39D,EAAKq/D,2BAA2BvI,EAAoC3uD,MAAvBwK,EAAWqyC,UAAwBryC,EAAWqyC,eAfvFhlD,EAAKsiD,MAAMsQ,aACX5yD,EAAK62D,2BAA2B/1C,QAoB5C29C,uBAAwB,SAAU39C,EAAOyzC,GACrC,IAAIv0D,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GAEzB,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAM3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAG5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAOihB,0BAA0BF,EAAQj9D,GAAIoyD,EAAUE,eAAgBN,QAL3E9V,EAAOihB,0BAA0B/K,EAAUvzD,MAAOuzD,EAAUE,eAAgBN,UATpFn3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxBq2C,EAAOkhB,sBAAsBpL,OAXjCv0D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAkCzC8+C,uBAAwB,SAAU9+C,EAAOyzC,GACrC,IACI5oB,EAAO7qB,EAAMrC,UAAU,GACvBve,EAFOD,KAEQwlD,KAAKoa,UAAUl0B,GAElCzrC,EAAQyE,IAAI,mBAAoB,QAChCzE,EAAQoB,SAAS,2BAEW,IAAhBpB,EAAQ,IAChBA,EAAQ,GAAGmS,MAAMZ,YAAY,mBAAoB8iD,EAAU,cAOnEmK,uBAAwB,SAAU59C,EAAOyzC,GACrC,IAAIv0D,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GAEzB,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAM3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAG5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAOqhB,gBAAgBN,EAAQj9D,GAAIoyD,EAAUE,eAAgBN,QALjE9V,EAAOqhB,gBAAgBnL,EAAUvzD,MAAOuzD,EAAUE,eAAgBN,UAT1En3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxBq2C,EAAOshB,YAAYxL,OAXvBv0D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAiCzCk/C,uBAAwB,SAAUl/C,EAAOyzC,GACrC,IACI5oB,EAAO7qB,EAAMrC,UAAU,GADhBxe,KAEQwlD,KAAKoa,UAAUl0B,GAC1BhnC,IAAI,QAAS4vD,EAAU,eAKnCqK,uBAAwB,SAAU99C,EAAOyzC,GACrC,IAAIv0D,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GAEzB,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAO3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAG5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAOwhB,qBAAqBT,EAAQj9D,GAAIoyD,EAAUE,eAAgBN,QALtE9V,EAAOwhB,qBAAqBtL,EAAUvzD,MAAOuzD,EAAUE,eAAgBN,UAV/En3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxBhL,EAAEqM,KAAKg1C,EAAOyhB,mBAAmB93D,KAAK,WAClCq2C,EAAO0hB,iBAAiB5L,SAZhCv0D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAkCzCs/C,uBAAwB,SAAUt/C,EAAOyzC,GACrC,IACI5oB,EAAO7qB,EAAMrC,UAAU,GACvBve,EAFOD,KAEQwlD,KAAKoa,UAAUl0B,GACQ,GAAtC7+B,OAAOY,KAAKuF,aAAashD,IACzBr0D,EAAQoF,OACRpF,EAAQyE,IAAI,UAAW,KAEvBzE,EAAQkF,QAMhBy5D,wBAAyB,SAAU/9C,EAAOyzC,GACtC,IAAIv0D,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GAEzB,GAAIz+C,EAAKqgE,cAAc5hB,GAEnB,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAO3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAG5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAO6hB,sBAAsBd,EAAQj9D,GAAIoyD,EAAUE,eAAgBN,QALvE9V,EAAO6hB,sBAAsB3L,EAAUvzD,MAAOuzD,EAAUE,eAAgBN,UAVhFn3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxBhL,EAAEqM,KAAKg1C,EAAOyhB,mBAAmB93D,KAAK,WAClCq2C,EAAO8hB,kBAAkBhM,SAdrCv0D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAuCzC0/C,wBAAyB,SAAU1/C,EAAOyzC,GACtC,IACI5oB,EAAO7qB,EAAMrC,UAAU,GACvBve,EAFOD,KAEQwlD,KAAKoa,UAAUl0B,GACQ,GAAtC7+B,OAAOY,KAAKuF,aAAashD,GACzBr0D,EAAQugE,WAAW,YAEnBvgE,EAAQqB,KAAK,WAAY,aAMjCm/D,aAAc,SAAU5/C,GACpB,IACI6qB,EAAO7qB,EAAMrC,UAAU,GADhBxe,KAEQwlD,KAAKoa,UAAUl0B,GAC1BzmC,QAAQ,UAMpB45D,qBAAsB,SAAUh+C,EAAOyzC,GACnC,IAAIv0D,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GAC1Bk1C,KAEW,MAAXF,GAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACrB3xC,OAAOY,KAAKuF,aAAawrC,EAAO9rC,WAAWqyC,WAC3CgR,EAAcntD,KAAK41C,KAIE,IAAzBuX,EAAc7wD,SACd6wD,EAAgBF,GAGpB14D,EAAE0D,KAAKk1D,EAAe,SAAUj1D,EAAG09C,GAE/B,GAAIz+C,EAAKqgE,cAAc5hB,GAEnB,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAO3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAG5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAOkiB,mBAAmBnB,EAAQj9D,GAAIoyD,EAAUE,eAAgBN,QALpE9V,EAAOkiB,mBAAmBhM,EAAUvzD,MAAOuzD,EAAUE,eAAgBN,UAV7En3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxBhL,EAAEqM,KAAKg1C,EAAOyhB,mBAAmB93D,KAAK,WAClCq2C,EAAOmiB,eAAerM,UAxBlCv0D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IA+CzC+/C,kBAAmB,SAAU//C,EAAOyzC,GAChC,IAAIv0D,EAAOC,KAEK,MAAZs0D,GAAwC,iBAAbA,IAC3BA,EAAWn3D,EAAEsJ,OAAO6tD,GAAWuM,YAAY,KAG/C,IAAIhL,EAAU91D,EAAK+1D,WAAWj1C,GAC9B,GAAe,MAAXg1C,EAAJ,CAQA,IAAIE,KACJ54D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACrBA,EAAO9rC,WAAWqyC,UAClBgR,EAAcntD,KAAK41C,KAKC,GAAxBuX,EAAc7wD,QACd/H,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACzBuX,EAAcntD,KAAK41C,KAI3BrhD,EAAE0D,KAAKk1D,EAAe,SAAUj1D,EAAG09C,GAE/B,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAW3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAG5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAO76C,gBAAgB47D,EAAQj9D,GAAIoyD,EAAUE,eAAgBN,QALjE9V,EAAO76C,gBAAgB+wD,EAAUvzD,MAAOuzD,EAAUE,eAAgBN,UAd1En3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACpBq2C,EAAOsiB,oBACP3jE,EAAEqM,KAAKg1C,EAAOsiB,qBAAqB34D,KAAK,WACpCq2C,EAAOuiB,gBAAgBzM,KAG3B9V,EAAOuiB,gBAAgBzM,YA/B/Bv0D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAqDzCmgD,qBAAsB,SAAUngD,EAAOyzC,GACnC,IAAIv0D,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GAEzB,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAS3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAG5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAOyiB,mBAAmB1B,EAAQj9D,GAAIoyD,EAAUE,eAAgBN,QALpE9V,EAAOyiB,mBAAmBvM,EAAUvzD,MAAOuzD,EAAUE,eAAgBN,UAZ7En3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,IAAI2sD,EAAatW,EAAO9rC,WAAWzI,KAChB,WAAf6qD,GAA0C,SAAfA,GAAwC,UAAfA,GACpDtW,EAAO0iB,eAAe5M,OAb9Bv0D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAoCzCsgD,qBAAsB,SAAUtgD,EAAOyzC,GACnC,IAAIv0D,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GAEzB,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAM3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAG5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAO4iB,mBAAmB7B,EAAQj9D,GAAIoyD,EAAUE,eAAgBN,QALpE9V,EAAO4iB,mBAAmB1M,EAAUvzD,MAAOuzD,EAAUE,eAAgBN,UAT7En3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxBq2C,EAAO6iB,eAAe/M,OAX1Bv0D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAiCzCygD,uBAAwB,SAAUzgD,GAC9B,IACIg1C,EADO71D,KACQ81D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACzBrhD,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxBq2C,EAAO+iB,iBAXJvhE,KAGEqiD,MAAMsQ,aAHR3yD,KAIEm1D,wBAAwBt0C,IAczCisC,eAAgB,SAAUjsC,EAAOijC,EAAc4Z,GAC3C,IACI7H,EADO71D,KACQ81D,WAAWj1C,IADnB7gB,KACkCwlD,KAAK3K,aAAah6B,GAC3DnR,EAAQ,IAAID,YAEhB,GAAe,MAAXomD,EAeJ,OAPA14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACzB9uC,EAAMpQ,IAAIk/C,EAAOptC,QAAQnB,KAAK,WAC1B,OAAOuuC,EAAOsO,gBAAgBjsC,MAAOA,EAAOijC,aAAcA,SAK3Dp0C,EAAMG,UAnBF7P,KAKEqiD,MAAMsQ,aALR3yD,KAMEm1D,wBAAwBt0C,IAkBzC2gD,iBAAkB,SAAU3K,EAAa/S,GACrC,IACIjiC,EADO7hB,KACUwlD,KAAK3K,aAAagc,GAEvC,GAAiB,MAAbh1C,EAOJ,OAAO1kB,EAAEqM,KAAKqY,EAAUzQ,SACnBnB,KAAK,WACF,OAAO4R,EAAU2/C,kBAAkB1d,aAAcA,MAZ9C9jD,KAIEqiD,MAAMsQ,aAJR3yD,KAKEm1D,wBAAwB0B,IAazC9J,gBAAiB,SAAUlsC,EAAOijC,GAC9B,IAAI/jD,EAAOC,KACP0P,EAAQ,IAAID,YACZgyD,EAAM,IAAItkE,EAAE4S,SACZ8lD,EAAU91D,EAAK+1D,WAAWj1C,IAAU9gB,EAAKylD,KAAK3K,aAAah6B,GAE/D,GAAe,MAAXg1C,EAIA,OAHI91D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,GAE1B,KAIX,IAAIk1C,KAgBJ,OAfA54D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACzB,GAAIA,EAAO9rC,WAAWqyC,SAElB,OADAgR,EAAcntD,KAAK41C,IACZ,IAKa,GAAxBuX,EAAc7wD,QACd/H,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GAEzB,OADAuX,EAAcntD,KAAK41C,IACZ,IAIc,IAAzBuX,EAAc7wD,QAKdnF,EAAKylD,MAA8C,KAAtCzlD,EAAKylD,KAAK9yC,WAAWoxC,eAClCA,EAAiC,KAAjBA,EAAuB/jD,EAAKylD,KAAK9yC,WAAWoxC,aAAe,IAAMA,EAAe/jD,EAAKylD,KAAK9yC,WAAWoxC,cAGzHp0C,EAAMpQ,IAAImiE,EAAIl5D,WAEdpL,EAAEqM,KAAK4E,MAAMjR,EAAGA,EAAE2N,IAAIirD,EAAe,SAAUz3D,GAC3CA,EAAK8S,WAEJjJ,KAAK,WAGF,IAFA,IAAIkd,EAAM0wC,EAAc7wD,OACpBw8D,EAAgB,IAAIjyD,YACf3O,EAAI,EAAGA,EAAIukB,EAAKvkB,IAAK,CAC1B,IAAIxC,EAAOy3D,EAAcj1D,GAErB4zD,EAAY30D,EAAK40D,iBAAiB9zC,GACtC,GAAKhU,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAW/B,IAFA,IAAIo+D,EAAUjhE,EAAKkhE,aACfF,EAAWC,EAAQr6D,OACd5C,EAAI,EAAGA,EAAIg9D,EAAUh9D,IAC1Bo/D,EAAc9xD,YAAYtR,EAAKqjE,aAC3B5gE,IAAKw+D,EAAQj9D,GACb5D,OAAQg2D,EAAUE,eAClB9Q,aAAcA,UAbtB4d,EAAcpiE,IAAIhB,EAAKqjE,aACnB5gE,IAAK2zD,EAAUvzD,MACfzC,OAAQg2D,EAAUE,eAClB9Q,aAAcA,KAgB1B3mD,EAAEqM,KAAKk4D,EAAc7xD,WAChB1H,KAAK,WACFs5D,EAAItxD,cAKbT,EAAMG,gBAjDb,GAuDJ+xD,eAAgB,SAAUv2D,GACtB,IAGIm6C,EAHOxlD,KAGKwlD,KAGhB,OAAOroD,EAAEqM,KAAKg8C,EAAKp0C,SACdnB,KAAK,WACF,OAAOu1C,EAAKU,WAAW76C,MAMnC4hD,YAAa,SAAUr7C,EAAMkyC,EAAc4Z,GACvC,IAEIlY,EAFOxlD,KAEKwlD,KACZtmB,EAASttB,EAAO,IAAMkyC,EAC1B,OAJW9jD,KAIF29D,eAAez+B,EAAQw+B,QAC5B,EAGOvgE,EAAEqM,KAAKg8C,EAAKp0C,SACdnB,KAAK,WACF,OAAOu1C,EAAKyH,aAAar7C,KAAMA,EAAMkyC,aAAcA,OAInEoJ,iBAAkB,SAAUC,EAAWrJ,GACnC,IAEI0B,EAFOxlD,KAEKwlD,KAGhB,OAAOroD,EAAEqM,KAAKg8C,EAAKp0C,SACdnB,KAAK,WACF,OAAOu1C,EAAK0H,kBAAkBC,UAAWA,EAAWrJ,aAAcA,OAK9EsJ,oBAAqB,SAAUC,EAASvJ,GACpC,IACI0B,EADOxlD,KACKwlD,KAChB,OAAOroD,EAAEqM,KAAKg8C,EAAKp0C,OAAOnB,KAAK,WAC3B,OAAOu1C,EAAK4H,qBAAqBC,QAASA,EAASvJ,aAAcA,OAIzEwJ,iBAAkB,SAAUC,EAAezJ,GACvC,IACI0B,EADOxlD,KACKwlD,KAChB,OAAOroD,EAAEqM,KAAKg8C,EAAKp0C,OAAOnB,KAAK,WAC3B,OAAOu1C,EAAK8H,kBAAkBC,cAAeA,EAAezJ,aAAcA,OAMlF+d,aAAc,SAAUhhD,EAAOyzC,GAC3B,IAEI9V,EAFOx+C,KAEOw0D,UAAU3zC,GAC5B,GAAc,MAAV29B,EAQJ,OAAOrhD,EAAEqM,KAAKg1C,EAAOptC,SAASnB,KAAK,WAC/B,OAAOuuC,EAAOsjB,mBAZP9hE,KAIEqiD,MAAMsQ,aAJR3yD,KAKEm1D,wBAAwBt0C,IAazCkhD,gBAAiB,SAAUlhD,GACvB,IAAI9gB,EAAOC,KACP61D,EAAU91D,EAAK+1D,WAAWj1C,GACf,MAAXg1C,EAOJ14D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GAEzB,GAAKz+C,EAAKs/D,gBAAgB7gB,EAAQ39B,GAQ3B,CAEH,IAAI6zC,EAAY30D,EAAK40D,iBAAiB9zC,GACtC1jB,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxB,GAAK0E,OAAOY,KAAKqT,QAAQ4zC,EAAUvzD,OAE5B,CACH,IAAmCmB,EAAGg9D,EAAlCC,EAAU/gB,EAAOghB,aACrB,IAAKl9D,EAAI,EAAGg9D,EAAWC,EAAQr6D,OAAQ5C,EAAIg9D,EAAUh9D,IACjDk8C,EAAOwjB,cAAczC,EAAQj9D,GAAIoyD,EAAUE,qBAJ/CpW,EAAOwjB,cAActN,EAAUvzD,MAAOuzD,EAAUE,uBAXxDz3D,EAAEqM,KAAKg1C,EAAOptC,SAASjJ,KAAK,WACxBhL,EAAEqM,KAAKg1C,EAAOyhB,mBAAmB93D,KAAK,WAClCq2C,EAAOyjB,YACPliE,EAAK8+D,qBAAqBh+C,EAAqC3Y,MAA9Bs2C,EAAO9rC,WAAWosD,UAAwBtgB,EAAO9rC,WAAWosD,gBAbrG/+D,EAAKsiD,MAAMsQ,aACX5yD,EAAKo1D,wBAAwBt0C,IAkCzCm+C,0BAA2B,SAAUnI,EAAavC,GAC9C,IAEIzyC,EAFO7hB,KACKwlD,KACK3K,aAAagc,GACjB,MAAbh1C,EAOJ1kB,EAAEqM,KAAKqY,EAAUzQ,SAASjJ,KAAK,WAC3B0Z,EAAU69C,sBAAsBpL,KAXzBt0D,KAIEqiD,MAAMsQ,aAJR3yD,KAKE42D,2BAA2BC,IAY5CqI,0BAA2B,SAAUrI,EAAavC,GAC9C,IAEIzyC,EAFO7hB,KACKwlD,KACK3K,aAAagc,GACjB,MAAbh1C,EAOJ1kB,EAAEqM,KAAKqY,EAAUzQ,OAAM,IAAOjJ,KAAK,WAC/BhL,EAAEqM,KAAKqY,EAAUo+C,mBAAmB93D,KAAK,WACrC0Z,EAAUq+C,iBAAiB5L,OAZxBt0D,KAIEqiD,MAAMsQ,aAJR3yD,KAKE42D,2BAA2BC,IAc5CsI,gBAAiB,SAAUtI,EAAavC,GACpC,IAEIzyC,EAFO7hB,KACKwlD,KACK3K,aAAagc,GACjB,MAAbh1C,EAM8B,UAA9BA,EAAUnP,WAAWzI,MAGzB9M,EAAEqM,KAAKqY,EAAUzQ,SAASjJ,KAAK,WAC3B0Z,EAAUs9C,gBAAgB7K,KAbnBt0D,KAIEqiD,MAAMsQ,aAJR3yD,KAKE42D,2BAA2BC,IAc5CqL,iBAAkB,SAAUrL,GACxB,IAEIh1C,EAFO7hB,KACKwlD,KACK3K,aAAagc,GACjB,MAAbh1C,GAM8B,YAA9BA,EAAUnP,WAAWzI,MAAsB4X,EAAUsC,iBACrDtC,EAAUsC,gBAAgBhU,UAE9BhT,EAAEqM,KAAKqY,EAAUzQ,SAASjJ,KAAK,WAC3B0Z,EAAUsgD,0BAbHniE,KAIEqiD,MAAMsQ,aAJR3yD,KAKE42D,2BAA2BC,IAc5CuI,2BAA4B,SAAUvI,EAAavC,GAC/C,IAEIzyC,EAFO7hB,KACKwlD,KACK3K,aAAagc,GACjB,MAAbh1C,EAOJ1kB,EAAEqM,KAAKqY,EAAUzQ,SAASjJ,KAAK,WAC3B0Z,EAAUy+C,kBAAkBhM,KAXrBt0D,KAIEqiD,MAAMsQ,aAJR3yD,KAKE42D,2BAA2BC,IAY5CmG,kBAAmB,SAAUrJ,EAAWoJ,GACpC,IACIr+D,EACJ,GAA2B,iBAAhB,GAAmD,kBAAhB,EAC1C,OAAO,KACX,GAAIi1D,EAAUV,YAAa,CACvB,IAAI3wD,EAAGg9D,EACP,IAAKh9D,EAAI,EAAGg9D,EAAW3L,EAAUV,YAAY/tD,OAAQ5C,EAAIg9D,EAAUh9D,IAN5DtC,KAOEg9D,kBAAkBrJ,EAAUV,YAAY3wD,GAAIy6D,OAGlD,CAAA,GAAIpJ,EAAUN,OACjB,OAXOrzD,KAWKg9D,kBAAkBrJ,EAAUN,OAAQ0J,GAE7C,GAAIpJ,EAAUF,QACjB,OAdOzzD,KAcKg9D,kBAAkBrJ,EAAUF,QAASsJ,GAEjD,IAAIl8C,EAAQ8yC,EAAU9yC,OAAS8yC,EAAUK,SACrCnzC,IAEIA,GAASA,EAAM3W,QAAQ,MAAQ,IAC/BxL,EAASmiB,EAAMrC,UAAUqC,EAAM3W,QAAQ,MAAQ,GAC/C6yD,EAAYn0D,KAAKlK,IAIU,UAA3Bi1D,EAAUQ,cACNR,EAAUW,SAASpqD,QAAQ,MAAQ,IACnCxL,EAASi1D,EAAUW,SAAS91C,UAAUm1C,EAAUW,SAASpqD,QAAQ,MAAQ,GACzE6yD,EAAYn0D,KAAKlK,KAMjC,OAAO,MAIX2gE,gBAAiB,SAAU7gB,EAAQ39B,GAC/B,IAAIi0C,EAAajoD,OAAOY,KAAKs8B,cAAcyU,EAAO9rC,WAAWzI,MAC7D,MAAQ,UAAUiI,KAAK4iD,IAAej0C,EAAM3W,QAAQ,MAAQ,GAIhEk2D,cAAe,SAAU5hB,GAGrB,OAAqD,KAFrC,uBAEAt0C,QAAQs0C,EAAO9rC,WAAWzI,OAS9Cm4D,2BAA4B,SAASvhD,EAAOw0C,GACxC,IACI7P,EADOxlD,KACKwlD,KACZ9Z,EAAO7qB,EAAMrC,UAAU,GAEvBvf,EAAUumD,EAAKvmD,SAAWumD,EAAKvmD,QAAQiG,OAASsgD,EAAKvmD,QAAUumD,EAAK9yC,WAAWzT,YAC/Em2D,GAAkD,IAAtCvoD,OAAOY,KAAKuF,aAAaqiD,GACrCl0D,EAAQlC,EAAQojE,UAAU,SAASp5B,GAAQ,OAAOA,EAAK3rC,KAAOouC,IAC9D42B,EAAa9c,EAAK+c,iBAEP,IAAXphE,IACAlC,EAAQkC,GAAOk0D,QAAUD,GAE7B5P,EAAKvmD,QAAUA,MACfqjE,EAAWE,qBAAqBhd,MC7kDxC34C,OAAOsqD,QAAQpxB,YAAY36B,OAAO3E,OAAO,wCASrCk5D,uBAAwB,SAAS9+C,EAAO69C,GAChC1+D,KAAKwlD,OAASxlD,KAAKwlD,KAAKid,4BACxBziE,KAAKsN,OAAOuT,EAAO69C,IAS3BqB,uBAAwB,SAASl/C,EAAO69C,GAChC1+D,KAAKwlD,OAASxlD,KAAKwlD,KAAKid,4BACxBziE,KAAKsN,OAAOuT,EAAO69C,IAS3ByB,uBAAwB,SAASt/C,EAAOob,GACzBj8B,KAEFwlD,OAFExlD,KAEYwlD,KAAKid,2BAFjBziE,KAGFsN,OAAOuT,EAAOob,GAHZj8B,KAKF0iE,+BAA+B7hD,EAAOob,IAUnDskC,wBAAyB,SAAU1/C,EAAOob,GAC3Bj8B,KAEFwlD,OAFExlD,KAEYwlD,KAAKid,2BAFjBziE,KAGFsN,OAAOuT,EAAOob,GAHZj8B,KAKF0iE,+BAA+B7hD,EAAOob,IAUnDymC,+BAAgC,SAAS7hD,EAAOw0C,GAC5C,IACI7P,EADOxlD,KACKwlD,KACZ9Z,EAAO7qB,EAAMrC,UAAU,GACvB8jD,EAAa9c,EAAK+c,gBAClBtjE,EAAUumD,EAAKvmD,SAAWumD,EAAKvmD,QAAQiG,OAASsgD,EAAKvmD,QAAUumD,EAAK9yC,WAAWzT,YAC/Em2D,GAAkD,IAAtCvoD,OAAOY,KAAKuF,aAAaqiD,GACrCl0D,EAAQlC,EAAQojE,UAAU,SAASp5B,GAAQ,OAAOA,EAAK3rC,KAAOouC,KAEnD,IAAXvqC,IACAlC,EAAQkC,GAAOk0D,QAAUD,GAE7B5P,EAAKvmD,QAAUA,MACfqjE,EAAWE,qBAAqBhd,MC7ExCroD,EAAEklD,MAAM57C,OAAO,4BACXk8D,uBAAwB,EACxBC,oBAAqB,EACrBC,oBAAqB,IAMrBrrD,KAAM,SAAUnM,GAEZrL,KAAK8iE,cAAgBz3D,EAAOy3D,cAG5B9iE,KAAK+iE,YAAc13D,EAAO03D,YAG1B/iE,KAAKo9B,OAAS/xB,EAAO+xB,OAGrBp9B,KAAKgjE,UAAYn2D,OAAOC,aAGxB9M,KAAKijE,kBAAoB9lE,EAAE,WAG3B6C,KAAKkjE,UAAW,EAGhBljE,KAAKmjE,eAAe93D,EAAOxN,MAG3BmC,KAAKojE,gBAMTD,eAAgB,SAAUtlE,GAItBmC,KAAK0S,cACD7U,GAAQA,EAAK6U,aAAY1S,KAAK0S,WAAa7U,EAAK6U,YAGpD1S,KAAK0S,WAAWoxC,aAAe9jD,KAAKqjE,kBAGpCrjE,KAAK0S,WAAW0xC,YAAcpkD,KAAKsjE,gBAMvCD,gBAAiB,WAIb,OAAuBn7D,MAAflI,KAAKo9B,QAA6D,mBAA/Bp9B,KAAKo9B,OAAOimC,gBAAiCrjE,KAAKo9B,OAAOimC,kBAAoB,IAM5HC,aAAc,WAIV,OAAuBp7D,MAAflI,KAAKo9B,QAA0D,mBAA5Bp9B,KAAKo9B,OAAOkmC,aAA8BtjE,KAAKo9B,OAAOkmC,eAAiB,IAMtH5iC,iBAAkB,WAGd,QAA4B,IAAhB1gC,KAAW,OACvB,OAAOA,KAAKo9B,OAAOsD,oBAOvB3zB,YAAa,SAAUhM,GACnB,OAAOf,KAAKgjE,UAAUj2D,YAAYhM,IAMtCwiE,eAAgB,aAKhBC,OAAQ,SAAUC,KAOlBp8B,MAAO,WAEH,GAAIrnC,KAAK0S,WAAWosD,SAAU,CAC1B,IAAIp8C,EAASvlB,EAAE,yCAEV0P,OAAOY,KAAK+U,mBAAmBxiB,KAAKC,QAASyiB,IAC9CvlB,EAAE6C,KAAKC,SAASqB,KAAK,YAAa,GAAG+lC,QAErCrnC,KAAKC,SACLD,KAAKC,QAAQyjE,OAAO,YAAa,KAKrC1jE,KAAKo9B,QAAsC,mBAArBp9B,KAAKo9B,OAAOiK,OAClCrnC,KAAKo9B,OAAOiK,SAOpB2wB,qBAAsB,SAAU2L,EAAW9lE,GACvC,OAAImC,KAAKkjE,SAAiB,KACtBljE,KAAKo9B,OAAep9B,KAAKo9B,OAAO46B,qBAAqB2L,EAAW9lE,GAC7D,MAMXoH,QAAS,SAAU0+D,EAAW9lE,GAC1B,OAAImC,KAAKkjE,SAAiB,KACtBljE,KAAKijE,kBAA0BjjE,KAAKijE,kBAAkBh+D,QAAQ0+D,EAAW9lE,GACtE,MAMXi8D,eAAgB,SAAU6J,EAAW9lE,GACjC,OAAImC,KAAKkjE,SAAiB,KACtBljE,KAAKijE,kBAA0BjjE,KAAKijE,kBAAkBnJ,eAAe6J,EAAW9lE,GAC7E,MAMXmH,KAAM,SAAU2+D,EAAW32D,GACvB,OAAIhN,KAAKkjE,SAAiB,KACtBljE,KAAKijE,kBAA0BjjE,KAAKijE,kBAAkBj+D,KAAK2+D,EAAW32D,IAC1EhN,KAAKojE,YAAYx6D,MAAO8d,MAAOi9C,IACxB,OAMXx8C,OAAQ,SAAUw8C,EAAW32D,GACzB,OAAIhN,KAAKkjE,SAAiB,KACtBljE,KAAKijE,kBAA0BjjE,KAAKijE,kBAAkB97C,OAAOw8C,EAAW32D,GACrE,MAMXqsD,IAAK,SAAUsK,EAAW32D,GACtB,OAAIhN,KAAKkjE,SAAiB,KACtBljE,KAAKijE,kBAA0BjjE,KAAKijE,kBAAkB5J,IAAIsK,EAAW32D,IACzEhN,KAAKojE,YAAYx6D,MAAO8d,MAAOi9C,IACxB,OAMXC,mBAAoB,aAKpBC,QAAS,WACL,GAAI7jE,KAAKo9B,OAAQ,OAAOp9B,KAAKo9B,OAAOymC,WAMxCjjC,UAAW,WACP,GAAI5gC,KAAKo9B,OAAQ,OAAOp9B,KAAKo9B,OAAOwD,aAMxCkjC,YAAa,WAIT,OAHW9jE,KAEK0gC,mBACJhuB,WAAWzI,MAAQ,QAMnCmH,MAAO,aAKP2yD,cAAe,aAKfC,kBAAmB,WACf,OAAO,MAMX5lC,QAAS,WACL,IAAIr+B,EAAOC,KACXD,EAAKmjE,UAAW,EAEhBphE,WAAW,WACiB,MAApB/B,EAAKqjE,aAELjmE,EAAE0D,KAAKd,EAAKqjE,YAAa,SAAUtiE,EAAGmoC,GAClClpC,EAAKonB,OAAO8hB,EAAKviB,gBAGlB3mB,EAAKqjE,YAERrjE,EAAKkjE,mBAAmBljE,EAAKkjE,kBAAkBgB,MACnDp3D,OAAOY,KAAK2wB,QAAQr+B,IACrB8M,OAAOwkB,SAAS6yC,aAAe,KAMtCC,WAAY,WACR,OAAOnkE,KAAKkjE,UAMhBp+B,mBAAoB,SAASpuB,GACzB,IACI8uC,EADOxlD,KACK0gC,mBACZvC,EAAgBtxB,OAAOY,KAAK0wB,eAAgBxvB,QAFrC3O,OAIX,GAA0B,2BAAtB0W,EAAQ0tD,UAAwC,CAEhD5e,EAAK6e,qBAAqBtL,0BAC1B,IAAIp9B,EAAQ9uB,OAAOC,aAAaC,YAAY2J,EAAQA,SACpD8uC,EAAK6e,qBAAqB7L,iBAAiB78B,QACxC,GAA0B,8BAAtBjlB,EAAQ0tD,UAA2C,CAC1D,IAAI/4D,EAASm6C,EAAK5kB,YAElB4kB,EAAK6e,qBAAqBtL,0BAG1BvT,EAAK3jC,UAAU5c,QAAQ,WAAa4gC,OAAQx6B,EAAOw6B,QAAUh5B,OAAO8B,QAAQk3B,aACzE,CACH,IAEI57B,GADJyM,EAA8B,iBAD1BA,EAAUA,OAC2BiG,KAAKhE,MAAMjC,GAAWA,GAC5CzM,MAAQ,QACvB6+B,EAAOpyB,EAAQoyB,MAAQ,OAI3B,GAHApyB,EAAUA,EAAQwlB,cAAiBxlB,EAAQA,SAAWA,EAGzC,kBAATzM,EAA0B,OAC9B,GAAa,cAATA,EAAsB,OAC1B,GAAIk0B,GAA0B,eAAT2K,EAAuB,OAG5C0c,EAAK6e,qBAAqBtL,0BACd,SAAR9uD,EACAu7C,EAAK6e,qBAAqB1L,iBAAiBjiD,GAE3C8uC,EAAK6e,qBAAqB7L,iBAAiB9hD,GAInD,OAAOA,GAMXlV,aAAc,aAKdO,WAAY,aAMZuiE,gBAAiB,aAKjBC,eAAgB,eC7TpB13D,OAAO23D,UAAUvkE,QAAQwG,OAAO,8BAC5Bg+D,gBAAiB,cAMjBtB,eAAgB,SAAUtlE,GACtB,IAAIkC,EAAOC,KAGXD,EAAKuN,OAAOzP,GAGZ,IAAI6U,EAAa3S,EAAK2S,WACtBA,EAAWgyD,SAAWt9D,KAAKiR,KAAqB,IAAhBjR,KAAKE,UACrCoL,EAAWqyC,cAA0C,IAAvBryC,EAAWqyC,UAA2Bl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,UACxGryC,EAAW2iD,aAAwC,IAAtB3iD,EAAW2iD,SAA0BxoD,OAAOY,KAAKuF,aAAaN,EAAW2iD,SAGtG3iD,EAAW5O,YAAc4O,EAAW5O,aAAe,OAGnD9D,KAAKs+D,mBAAqB3hD,KAAKhE,MAAMgE,KAAKC,OAAOlK,IAGjD1S,KAAKqD,YACLrD,KAAK2kE,gBAED9mE,EAAK+mE,UACLznE,EAAE0D,KAAKhD,EAAK+mE,SAAU,SAAS9jE,EAAGb,GAC1BA,EAAQu+C,OACRz+C,EAAK8kE,oBAAoB5kE,GAClBA,EAAQ4hB,UACf9hB,EAAK+kE,uBAAuB7kE,GACrBA,EAAQulD,MACfzlD,EAAKglE,kBAAkB9kE,MASvC4kE,oBAAqB,SAAU5kE,GAC3B,IAEI+kE,EAFAjlE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAIK,GAAvBA,EAAWqyC,WACX9kD,EAAQu+C,OAAO9rC,WAAWqyC,SAAWryC,EAAWqyC,SACV,QAAlC9kD,EAAQu+C,OAAO9rC,WAAWzI,OAC1BhK,EAAQu+C,OAAO9rC,WAAWuyD,YAAa,KAInB,IAAxBvyD,EAAWosD,WACX7+D,EAAQu+C,OAAO9rC,WAAWosD,SAAWpsD,EAAWosD,UAIZ,aAApC7+D,EAAQu+C,OAAO9rC,WAAWwyD,SAC1BF,EAAkBn4D,OAAO8K,MAAM1X,IAGnC,IAAIu+C,EAASz+C,EAAK+iE,cAActO,WAC5BvqD,KAAMhK,EAAQu+C,OAAO9rC,WAAWzI,KAChCpM,KAAMoC,EAAQu+C,OACdukB,YAAahjE,EAAKgjE,YAClB3lC,OAAQr9B,EACRF,KAAME,EAAK8jE,YAIf9jE,EAAKsD,SAASuF,KAAK41C,GAGqB,aAApCv+C,EAAQu+C,OAAO9rC,WAAWwyD,QAC1BnlE,EAAKolE,uBAAuB3mB,EAAQwmB,GAMxCjlE,EAAK2gC,mBAAmB0kC,eAAe5mB,IAK3CsmB,uBAAwB,SAAU7kE,GAC9B,IAAIF,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGK,GAAvBA,EAAWqyC,WACX9kD,EAAQ4hB,UAAUnP,WAAWqyC,SAAWryC,EAAWqyC,WAI3B,IAAxBryC,EAAWosD,WACX7+D,EAAQ4hB,UAAUnP,WAAWosD,SAAWpsD,EAAWosD,UAGvD,IAAIj9C,EAAY9hB,EAAK+iE,cAAcjoB,cAC/B5wC,KAAMhK,EAAQ4hB,UAAUnP,WAAWzI,KACnCpM,KAAMoC,EAAQ4hB,UACdub,OAAQr9B,EACRgjE,YAAahjE,EAAKgjE,YAClBljE,KAAME,EAAK8jE,UACX7/D,SAA6B,WAAnBjE,EAAK8jE,YAGnB9jE,EAAKsD,SAASuF,KAAKiZ,GAGnB9hB,EAAK2gC,mBAAmB0kC,eAAevjD,IAK3CkjD,kBAAmB,SAAU9kE,GACzB,IAAIF,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGK,GAAvBA,EAAWqyC,WACX9kD,EAAQ4hB,UAAUnP,WAAWqyC,SAAWryC,EAAWqyC,UAGvD,IAAIS,EAAOzlD,EAAK+iE,cAAcjoB,cAC1B5wC,KAAOhK,EAAQulD,KAAK9yC,WAAWzI,MAAQ,OACvCpM,KAAMoC,EAAQulD,KACdpoB,OAAQr9B,EACRgjE,YAAahjE,EAAKgjE,YAClBljE,KAAME,EAAK8jE,YAEf9jE,EAAKsD,SAASuF,KAAK48C,IAKvB6f,WAAY,WAER,OADWrlE,KACC6hB,WAKhByjD,kBAAmB,SAAUr7D,EAAM26D,GAC/BA,EAAWA,MAaX,OATAznE,EAAE0D,KAHSb,KAGCqD,SAAU,SAAUvC,EAAGiwD,GAC3BA,EAAMr+C,WAAWzI,MAAQA,GACzB26D,EAASh8D,KAAKmoD,GAEdA,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,wBACnD5R,EAAMuU,kBAAkBr7D,EAAM26D,KAI/BA,GAKXO,uBAAwB,SAAU3mB,EAAQv+C,GACtC,IAAIF,EAAOC,KACPulE,EAAgB5oD,KAAKhE,MAAMgE,KAAKC,OAAO3c,EAAQu+C,SAGnD+mB,EAAc7yD,WAAWynC,YAAcorB,EAAc7yD,WAAWynC,YAAc,IAAMp6C,EAAKgN,YAAY,qCACrGw4D,EAAc7yD,WAAWmO,MAAQ0kD,EAAc7yD,WAAWmO,MAAQ,SAClE0kD,EAAc7yD,WAAW8yD,SAAU,EAGnC,IAAI7tD,EAAQ5X,EAAK+iE,cAActO,WAC3BvqD,KAAMs7D,EAAc7yD,WAAWzI,KAC/BpM,KAAM0nE,EACNnoC,OAAQr9B,EACRF,KAAME,EAAK8jE,YAIfrlB,EAAOinB,YAAc9tD,EAGrB5X,EAAKsD,SAASuF,KAAK+O,IAKvB4rD,eAAgB,WACZ,OAAO12D,OAAO23D,UAAUvkE,QAAQ0iE,wBAKpCnkB,OAAQ,WACJ,IAEIz2C,EAFAhI,EAAOC,KACAD,EAAK8jE,UAsBhB,OAlBA97D,EAAShI,EAAK2lE,iBAGd3lE,EAAK4lE,yBAGL59D,EAAOzG,KAAK,oBAAqBvB,EAAK2S,WAAWpV,IAG7CyC,EAAK2S,WAAWy/C,KAChBpqD,EAAOzG,KAAK,WAAYvB,EAAK2S,WAAWy/C,KAIxCpyD,EAAKsL,QACDtL,EAAKsL,OAAO04C,eACZh8C,EAAO1G,SAAStB,EAAKsL,OAAO04C,eAE7Bh8C,GAKX29D,eAAgB,WACZ,IAGIniE,EAHOvD,KAGK4lE,sBAGZ/jD,EANO7hB,KAMU6hB,UAAY1kB,EAAEoG,GAKnC,OAXWvD,KASN6lE,oBAAoBhkD,GATd7hB,KAWC6hB,WAKhB+jD,oBAAqB,WAKjB,OAJW5lE,KAENigE,kBAFMjgE,KAEmBigE,mBAAqB,IAAI9iE,EAAE4S,SAElD/P,KAAK8lE,mBAKhBC,WAAY,WAER,QADW/lE,KACDigE,mBADCjgE,KAGCigE,kBAAkB13D,WAKlCq7D,mBAAoB,WAIhB,OAHI/2D,OAAOY,KAAKqT,QAAQ9gB,KAAK6hB,YACzBsgC,MAAM,mCAEHniD,KAAK6hB,WAKhB8jD,uBAAwB,WACpB,IACQjzD,EADG1S,KACe0S,WAGtBA,EAAWusD,iBAJJj/D,KAKF0/D,sBAAsBhtD,EAAWusD,iBAGrCvsD,EAAW2iD,SARLr1D,KASFkgE,iBAAiBxtD,EAAW2iD,UAKzCqK,sBAAuB,SAAUhB,GAClB1+D,KACW0S,WAEXusD,gBAAkBP,EAG7BvhE,EAAE0D,KANSb,KAMCqD,SAAU,SAAUvC,EAAGiwD,GAC3BA,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBACnD5R,EAAM2O,sBAAsBhB,GAErB3N,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,qBAC1D7R,EAAM2O,sBAAsBhB,MAOxCwB,iBAAkB,SAAU5L,GACxB,IACI5hD,EADO1S,KACW0S,WAGtBA,EAAW2iD,QAAUxoD,OAAOY,KAAKuF,aAAashD,GAG1C5hD,EAAW2iD,QAPJr1D,KAQF6hB,UAAUxc,OARRrF,KAWF6hB,UAAU1c,QAIvBm7D,kBAAmB,SAAUhM,GACdt0D,KACW0S,WAGXqyC,SAAWl4C,OAAOY,KAAKuF,aAAashD,GAG/Cn3D,EAAE0D,KAPSb,KAOCqD,SAAU,SAAUvC,EAAGiwD,GAC3BA,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBACnD5R,EAAMuP,kBAAkBhM,GAEjBvD,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,qBAC1D7R,EAAMuP,kBAAkBhM,MAOpC0R,WAAY,SAAUnkD,EAAWswC,EAAKxtD,GAClCkI,OAAOY,KAAKmU,gBAAgBC,EAAWswC,EAAKxtD,IAKhDshE,mBAAoB,SAAUpkD,EAAWld,GACrC3E,KAAKgmE,WAAWnkD,EAAW,YAAald,IAK5CuhE,oBAAqB,SAAU3iE,EAAMoB,GACjC,OAAOpB,EAAKoB,QAAQ,eAAgBA,IAMxCmhE,gBAAiB,aAMjBD,oBAAqB,SAAUhkD,GAC3B,IAAI9hB,EAAOC,KAEPH,GADaE,EAAK2S,WACX3S,EAAK8jE,WAGZ9jE,EAAKkgE,mBACLlgE,EAAKkgE,kBAAkB9vD,UAG3BpQ,EAAK8hB,UAAYA,EACjB9hB,EAAKomE,0BAA0BtkD,GAEnB,aAARhiB,IAEAE,EAAKqmE,oBACLrmE,EAAKsmE,4BAGG,UAARxmE,GAEAE,EAAKumE,sBAEG,UAARzmE,IAEAE,EAAKumE,sBACLvmE,EAAKwmE,wBAIbF,yBAA0B,WACtB,IACIG,EAASnoD,OAAOooD,uBACf,gBAAiBtpE,EAAE,WAAW,IAAM,gBAAiBA,EAAE,WAAW,MAAQqpE,EAAOE,YAItFC,aAAaj0B,UAKjByzB,0BAA2B,SAAUtkD,GACjC,IAAI9hB,EAAOC,KACP4mE,EAAmB/kD,EAAUxe,WAEjClG,EAAE0D,KAAK+lE,EAAkB,SAAU9lE,EAAG+lE,GAClCA,EAAe1pE,EAAE0pE,GACjB,IAAIvpE,EAAKuM,OAAOg9D,EAAahpE,KAAK,cAClC,GAAIP,EAAI,CACJ,IAAIyzD,EAAQhxD,EAAK4kE,aAAarnE,GAC9B,GAAIyzD,EAAO,CACP,IAAI9mD,EAAO8mD,EAAMwS,iBACbt5D,GAAQ4C,OAAO23D,UAAUvkE,QAAQ2iE,qBACjC7R,EAAM+V,kBAAkBD,GACxB58D,GAAQ4C,OAAO23D,UAAUvkE,QAAQ0iE,wBACjC5R,EAAM8U,oBAAoBgB,SAGlC9mE,EAAKomE,0BAA0BU,MAO3CT,kBAAmB,aAKnBE,oBAAqB,aAKrBC,oBAAqB,aAMrBQ,mBAAoB,WAChB,IAAIhnE,EAAOC,KACP+b,EAAO,GAWX,OATA5e,EAAE0D,KAAKd,EAAKsD,SAAU,SAAUvC,EAAGiwD,GAC/B,IAAI9mD,EAAO8mD,EAAMwS,iBACbt5D,GAAQ4C,OAAO23D,UAAUvkE,QAAQ2iE,sBACjC7mD,GAAQg1C,EAAMiW,iBACd/8D,GAAQ4C,OAAO23D,UAAUvkE,QAAQ0iE,yBACjC5mD,GAAQg1C,EAAM6U,uBAClB7lE,EAAK4kE,aAAa5T,EAAMr+C,WAAWgyD,UAAY3T,IAG5Ch1C,GAKXkrD,oBAAqB,SAAUC,GAChBlnE,KACFqD,UACLlG,EAAE0D,KAFKb,KAEKqD,SAAU,SAAUvC,EAAGiwD,GAC3BA,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAEnD5R,EAAMkW,oBAAoBC,GAEnBnW,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,qBAEtD7R,EAAMoW,aACNpW,EAAMqW,YAAYF,MAUtCG,WAAY,SAAUt/D,GAIlB,IAFAA,EAASA,OAEG7C,OASR,OAAO6C,EAZA/H,KAICqD,UACJlG,EAAE0D,KALCb,KAKSqD,SAAU,SAAUvC,EAAGiwD,GAC/B,GAAIhpD,EAAO7C,QAAU6rD,EAAMsW,WAAWt/D,GAClC,OAAO,KAY3Bu/D,6BAA8B,SAAUJ,GAEpC/pE,EAAE0D,KADSb,KACCqD,SAAU,SAAUvC,EAAGiwD,GAC3BA,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAEnD5R,EAAMuW,6BAA6BJ,GAE5BnW,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,qBAEtD7R,EAAMwW,sBACNxW,EAAMyW,qBAAqBN,MAQ3Cl4C,WAAY,WACR,OAAOhvB,KAAKqD,SAAS,IAKzByyD,WAAY,SAAUj1C,EAAOg1C,GAsBzB,OAnBAA,EAAUA,MAGNh1C,EAAM3W,QAAQ,KAAO,IACrB2W,EAAQA,EAAMrC,UAAU,EAAGqC,EAAM3W,QAAQ,OAG7C/M,EAAE0D,KATSb,KASCqD,SAAU,SAAUvC,EAAGiwD,GAC3BA,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAEnD5R,EAAM+E,WAAWj1C,EAAOg1C,GAEjB9E,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,qBACtD/hD,GAASkwC,EAAMr+C,WAAWmO,OAC1Bg1C,EAAQjtD,KAAKmoD,KAKlB8E,GAKXrB,UAAW,SAAU3zC,GACjB,IACIg1C,EADO71D,KACQ81D,WAAWj1C,GAC1B9Y,EAAS,KAeb,OAdA5K,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACrBA,EAAO9rC,WAAWqyC,UACJ,MAAVh9C,IACAA,EAASy2C,KAKP,MAAVz2C,GACA5K,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACzBz2C,EAASy2C,IAIVz2C,GAMX0/D,kBAAmB,SAAU5mD,GAEzB,OADW7gB,KACC81D,WAAWj1C,IAM3Bg6B,aAAc,SAAUv9C,GACpB,IAKIyK,EAHJ,OAFW/H,KAEF0S,WAAWpV,IAAMA,EACf0C,MAGX7C,EAAE0D,KANSb,KAMCqD,SAAU,SAAUvC,EAAGiwD,GAC/B,GAAIA,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAAwB,CAE3E,IAAIxuB,EAAI4c,EAAMlW,aAAav9C,GAC3B,GAAS,MAAL62C,EAEA,OADApsC,EAASosC,GACF,KAKZpsC,IAKXiC,QAAS,SAAU0vD,GAgBf,OAbAv8D,EAAE0D,KAFSb,KAECqD,SAAU,SAAUvC,EAAGiwD,GAC3BA,EAAMr+C,WAAW2iD,UACbtE,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAEnD5R,EAAM/mD,QAAQ0vD,GAEP3I,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,qBAE1D7R,EAAM/mD,QAAQ0vD,MAKO,GAA1BA,EAAgBx0D,QAM3BwiE,cAAe,SAAUhO,GAgBrB,OAbAv8D,EAAE0D,KAFSb,KAECqD,SAAU,SAAUvC,EAAGiwD,GAC3BA,EAAMr+C,WAAW2iD,UACbtE,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAEnD5R,EAAM2W,cAAchO,GAEb3I,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,0BAA8C,IAAf7R,EAAU,MAEnGA,EAAM/mD,QAAQ0vD,MAKO,GAA1BA,EAAgBx0D,QAK3BkM,MAAO,WAEH,OAAOjU,EAAEqM,KADExJ,KACQo9B,OAAOhsB,QADfpR,KAC6B+lE,eAK5ChC,cAAe,WACX,IACI4D,EAAmBxqE,EAAE2N,IADd9K,KACuBqD,SAAU,SAAU0tD,GAClD,OAAOA,EAAMgT,kBAEjB,OAAO5mE,EAAEqM,KAAK4E,MAAMjR,EAAGwqE,IAK3BC,SAAU,WACN,IACIvgC,EAUJ,OATAlqC,EAAE0D,KAFSb,KAECqD,SAAU,SAAUvC,EAAGiwD,GAC/B,GAAIA,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAAwB,CAC3E,IAAI56D,EAASgpD,EAAM6W,WACd/6D,OAAOY,KAAKqT,QAAQ/Y,KACrBs/B,EAAQt/B,MAKbs/B,GAKX28B,kBAAmB,WACf,IACIxe,EADOxlD,KACK0gC,mBAEhB,GAAI8kB,EACA,OAAOA,EAAKwe,qBAMpB6D,iBAAkB,SAAU9mE,GACxB,IACI+mE,EADO9nE,KACegkE,oBAE1B,GAAI8D,EACA,OAAOA,EAAe/mE,IAM9Bq9B,QAAS,WACL,IAAIr+B,EAAOC,KAGX8B,WAAW,WACH/B,EAAKsD,UACLlG,EAAE0D,KAAKd,EAAKsD,SAAU,SAAUvC,EAAGiwD,GAC/BA,EAAM3yB,aAGfvxB,OAAOwkB,SAAS6yC,aAAe,IAGlCnkE,EAAKuN,UAMTk0D,iBAAkB,SAAUvyD,GACxB,IAAIlP,EAAOC,KACP0S,EAAa3S,EAAK2S,WAStB,OANA3S,EAAKyB,eAGLzB,EAAKukE,kBAGEnnE,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAcwJ,gBACzCjsC,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrB8mD,YAAa1xC,EAAW0xC,YACxBN,aAAepxC,EAAWoxC,cAAgB70C,EAAK60C,aAC/CsC,YAAarmD,EAAK2S,WAAW0zC,aAAe,MAC5Cj+C,KAAK,SAAUtK,GAEf,IAAKkC,EAAKokE,aAAc,CAGpBpkE,EAAKgoE,4BACEhoE,EAAKsD,gBACLtD,EAAK4kE,aAEZ5kE,EAAK2gC,mBAAmBsnC,iBAGS,IAA7BjoE,EAAK2S,WAAWqyC,UAChBlnD,EAAKgkB,WAAahkB,EAAKgkB,UAAUnP,aAAc7U,EAAKgkB,UAAUnP,WAAWqyC,UAAW,GAIxFhlD,EAAKojE,eAAetlE,EAAKgkB,WAGzB,IAAIomD,EAAmBloE,EAAK8hB,UACxB9Z,EAAShI,EAAKy+C,SAEU,WAAxBz+C,EAAK2S,WAAWzI,MAChB9M,EAAE4K,GAAQ1G,SAAS,kBAGvB4mE,EAAiBxkE,YAAYsE,GAG7B,IAAI1I,EAAUxB,EAAKgkB,WAAahkB,EAAKgkB,UAAUxiB,QAAUxB,EAAKgkB,UAAUxiB,WACxEU,EAAK2gC,mBAAmB07B,eAAe/8D,GAEvCU,EAAKmoE,yBAGLnoE,EAAKwkE,oBAGVn0D,KAAK,SAAUsG,GACdA,EAAU3W,EAAK+kC,mBAAmBpuB,KAEnCyxD,OAAO,WACNpoE,EAAKgC,gBAObqmE,uBAAwB,SAAUvqE,GAC9B,IAAIkC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAoBtB,GAjBA3S,EAAKukE,gBAAgBzmE,GAGrBV,EAAEsJ,OAAO5I,EAAK6U,YACVqyC,SAAUryC,EAAWqyC,SACrBqB,YAAc1zC,EAAW0zC,aAAe,GACxChC,YAAa1xC,EAAW0xC,YACxBP,SAAUnxC,EAAWpV,GACrBgL,kBAAmBoK,EAAWpK,kBAC9Bo8D,SAAUhyD,EAAWgyD,SACrBrP,QAAQ3iD,EAAW2iD,QACnBx0C,MAAOnO,EAAWmO,MAClBhhB,KAAM,SACNikD,aAAcpxC,EAAWoxC,cAAgB,MAIxC/jD,EAAKokE,aAAc,CAEpBpkE,EAAKgoE,4BACEhoE,EAAKsD,gBACLtD,EAAK4kE,cAGqB,IAA7B5kE,EAAK2S,WAAWqyC,UAChBlnD,EAAKgkB,WAAahkB,EAAKgkB,UAAUnP,aAAc7U,EAAKgkB,UAAUnP,WAAWqyC,UAAW,GAIxFhlD,EAAKojE,eAAetlE,EAAKgkB,WAGzB,IAAIomD,EAAmBloE,EAAK8hB,UACxB9Z,EAAShI,EAAKy+C,SAEU,WAAxBz+C,EAAK2S,WAAWzI,MAChB9M,EAAE4K,GAAQ1G,SAAS,kBAGvB4mE,GAAoBA,EAAiBxkE,YAAYsE,GAGjDhI,EAAKwkE,mBAIbD,gBAAiB,WAIb,IAHA,IAGSxjE,EAAI,EAAGA,EAHLd,KAGcqD,SAAS6B,OAAQpE,IAH/Bd,KAIFqD,SAASvC,GAAGwjE,mBAIzBC,eAAgB,WAIZ,IAHA,IAGSzjE,EAAI,EAAGA,EAHLd,KAGcqD,SAAS6B,OAAQpE,IAH/Bd,KAIFqD,SAASvC,GAAGyjE,kBAOzB2D,uBAAwB,WACTloE,KAEK0gC,mBAGhB,IALA,IAGIr9B,EAHOrD,KAGSqD,SAEXvC,EAAI,EAAGiW,EAAI1T,EAAS6B,OAAQpE,EAAIiW,EAAGjW,IAAK,CAC7C,IAAIiwD,EAAQ1tD,EAASvC,GACjBmJ,EAAO8mD,EAAMwS,iBAEbt5D,IAAS4C,OAAO23D,UAAUvkE,QAAQ0iE,uBAClC5R,EAAMmX,yBAEDj+D,IAAS4C,OAAO23D,UAAUvkE,QAAQ2iE,qBACvC7R,EAAMsX,qBAAsBvL,SAAS,MASjDwL,gBAAiB,SAAUjpE,GACvB,IACImmD,EADOxlD,KACK0gC,mBAEZrhC,GACAmmD,EAAK+iB,iBAAiBvN,aAAa37D,IAO3C0oE,mBAAoB,WAMhB,IALA,IAEIviB,EAFOxlD,KAEK0gC,mBACZr9B,EAHOrD,KAGSqD,SAEXvC,EAAI,EAAGiW,EAAI1T,EAAS6B,OAAQpE,EAAIiW,EAAGjW,IAAK,CAC7C,IAAIiwD,EAAQ1tD,EAASvC,GACjBmJ,EAAO8mD,EAAMwS,iBAEbt5D,IAAS4C,OAAO23D,UAAUvkE,QAAQ0iE,uBAClC5R,EAAMgX,qBAED99D,IAAS4C,OAAO23D,UAAUvkE,QAAQ2iE,qBACvCpd,EAAKgjB,iBAAiBzX,KAOlCthC,aAAc,SAAUxvB,GAKpB,IAJA,IAEIoD,EAFOrD,KAESqD,SAEXvC,EAAI,EAAGiW,EAAI1T,EAAS6B,OAAQpE,EAAIiW,EAAGjW,IAAK,CAG7C,GAFYuC,EAASvC,GAEX4R,WAAWgyD,UAAYzkE,EAAQyS,WAAWgyD,SAAU,CAC1DrhE,EAASwW,OAAO/Y,EAAG,GACnBuC,EAASwW,OAAO/Y,EAAG,EAAGb,GACtB,SAOZwoE,aAAc,SAAUnrE,GAMpB,IAJA,IAEI+F,EAFOrD,KAESqD,SAEXvC,EAAI,EAAGiW,EAAI1T,EAAS6B,OAAQpE,EAAIiW,EAAGjW,IAAK,CAC7C,IAAIiwD,EAAQ1tD,EAASvC,GAErB,GAAIiwD,EAAMr+C,WAAWpV,IAAMA,EACvB,OAAOyzD,EAIf,OAAO,QCj8BflkD,OAAO23D,UAAU3iD,UAAUpb,OAAO,iCAC9BiiE,QAAS,WAEL,OADa1oE,KAAK0gC,mBAAmBE,YACvBoF,MAMlBxkC,aAAc,WACV,IACIvB,EADOD,KACQ6hB,UACf5hB,GACAA,EAAQuB,cAAe63B,MAAO,IAAKnQ,SAAS,KAOpDnnB,WAAY,WACR,IAEI9B,EAFOD,KAEQ6hB,UACf5hB,GACAA,EAAQ8B,gBC1BpB8K,OAAO23D,UAAUvkE,QAAQwG,OAAO,2BAC5BkiE,kBAAmB,EACnBC,oBAAqB,GACrBC,gBAAiB,EACjBC,oBAAoB,EACpBrE,gBAAiB,YACjBsE,kBAAmB,WACfl8D,OAAO23D,UAAUhmB,OAAOmqB,kBAAoB,IAC5C97D,OAAO23D,UAAUhmB,OAAOqqB,gBAAkB,EAE1Ch8D,OAAO23D,UAAUhmB,OAAOsqB,oBAAqB,GAEjDE,iBAAkB,WACdn8D,OAAO23D,UAAUhmB,OAAOmqB,kBAAoB,EAC5C97D,OAAO23D,UAAUhmB,OAAOqqB,gBAAkB,EAC1Ch8D,OAAO23D,UAAUhmB,OAAOsqB,oBAAqB,KAMjD3F,eAAgB,SAAUtlE,GACtB,IAAIkC,EAAOC,KAGXD,EAAKuN,OAAOzP,GAEZ,IAAI2nD,EAAOzlD,EAAK2gC,mBAGZhuB,EAAa3S,EAAK2S,WAEtBA,EAAWu2D,cAA0C,IAAvBv2D,EAAWu2D,UAA2Bp8D,OAAOY,KAAKuF,aAAaN,EAAWu2D,UACxGv2D,EAAWgyD,SAAWt9D,KAAKiR,KAAqB,IAAhBjR,KAAKE,UACrCoL,EAAWynC,YAAcznC,EAAWynC,aAAe,GACnDznC,EAAWqyC,cAA0C,IAAvBryC,EAAWqyC,UAA2Bl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,UACxGryC,EAAW2iD,aAAwC,IAAtB3iD,EAAW2iD,SAA0BxoD,OAAOY,KAAKuF,aAAaN,EAAW2iD,SACtG3iD,EAAWw2D,sBAA0D,IAA/Bx2D,EAAWw2D,kBAAmCr8D,OAAOY,KAAKuF,aAAaN,EAAWw2D,kBAExH,IAAIpU,EAAajoD,OAAOY,KAAKs8B,cAAcr3B,EAAWzI,MAClD,YAAYiI,KAAK4iD,KACjBpiD,EAAW2iD,SAAU,GAGzB3iD,EAAWosD,cAA0C,IAAvBpsD,EAAWosD,UAA2BjyD,OAAOY,KAAKuF,aAAaN,EAAWosD,UACxGpsD,EAAWovD,oBAAsD,IAA7BpvD,EAAWovD,gBAAiCj1D,OAAOY,KAAKuF,aAAaN,EAAWovD,gBACpHpvD,EAAWy2D,UAAYz2D,EAAWy2D,WAAa,EAC/Cz2D,EAAW2rC,SAAWxxC,OAAOY,KAAKyP,KAAKxK,EAAW2rC,WAAa,GAC/D3rC,EAAW6rD,WAAa7rD,EAAW6rD,eACnC7rD,EAAW02D,YAAc12D,EAAW02D,gBACpC12D,EAAW22D,cAA0C,IAAvB32D,EAAW22D,UAA2Bx8D,OAAOY,KAAKuF,aAAaN,EAAW22D,UACxG32D,EAAW2iD,SAAW3iD,EAAmB,UAAYA,EAAW2iD,QAG5D3iD,EAAWgsD,QACXhsD,EAAW6rD,WAAWG,MAAQhsD,EAAWgsD,OAGzChsD,EAAWusD,kBACXvsD,EAAW6rD,WAAWU,gBAAkBvsD,EAAWusD,iBAIvDvsD,EAAWosD,WAAWpsD,EAAWqyC,UAAWryC,EAAWosD,SAGvDpsD,EAAW5O,YAAc4O,EAAW5O,aAAe,OAGnD4O,EAAW0zC,YAAeZ,EAAKn6C,QAAUm6C,EAAKn6C,OAAOxN,MAAQ2nD,EAAKn6C,OAAOxN,KAAKwmD,YAAemB,EAAKn6C,OAAOxN,KAAKwmD,YAAc,GAG5HtkD,EAAKu+D,oBACDC,YACIG,MAAOhsD,EAAW6rD,WAAWG,MAC7BO,gBAAiBvsD,EAAW6rD,WAAWU,iBAE3CmK,aACI1K,MAAOhsD,EAAW6rD,WAAWG,MAC7BO,gBAAiBvsD,EAAW6rD,WAAWU,iBAE3C5J,QAAS3iD,EAAW2iD,QACpBtQ,SAAUryC,EAAWqyC,SACrB+Z,SAAUpsD,EAAWosD,SACrBwK,WAAY52D,EAAW42D,WACvBC,WAAY72D,EAAW62D,YAI3BxpE,EAAK6D,WAAsC,IAAtB8O,EAAgB,MAAoBA,EAAW9O,MAAQ,KAG5E7D,EAAK2S,WAAWG,cAAgB9S,EAAK6D,MACrC7D,EAAK2S,WAAW82D,cAAgBzpE,EAAK6D,MAGrC7D,EAAK0pE,oCAKTA,iCAAkC,WAC9B,IAAI1pE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGtBA,EAAWg3D,YAAch3D,EAAWg3D,aAAe,SACnDh3D,EAAW42D,WAAa52D,EAAW42D,YAAcvpE,EAAK4pE,qBAAqBj3D,EAAWg3D,aACtFh3D,EAAW62D,WAAa72D,EAAW62D,YAAcxpE,EAAK6pE,qBAAqBl3D,EAAWg3D,aAGvD,QAA3Bh3D,EAAW5O,cACX4O,EAAW42D,WAAavpE,EAAK8pE,YAAYn3D,EAAW42D,YACpD52D,EAAW62D,WAAaxpE,EAAK8pE,YAAYn3D,EAAW62D,aAIxD,IAAIO,EAAc/pE,EAAKgqE,qBAAqBr3D,EAAWs3D,WAAYt3D,EAAWu3D,WAAYv3D,EAAWg3D,aACrGh3D,EAAWs3D,WAAaF,EAAY9oE,MACpC0R,EAAWu3D,WAAaH,EAAYr3D,QAEN,eAA1BC,EAAWw3D,aACXx3D,EAAWu3D,WAAaH,EAAYr3D,SAGX,GAAzBC,EAAWs3D,aACXt3D,EAAWg3D,YAAc,QACzBh3D,EAAWu3D,WAAaH,EAAYr3D,SAGX,GAAzBC,EAAWu3D,aACXv3D,EAAWg3D,YAAc,SAGL,cAApBh3D,EAAWzI,OACoB,SAA3ByI,EAAWg3D,aACXh3D,EAAWu3D,WAAav3D,EAAWu3D,YAAc,GACjDv3D,EAAWs3D,WAAat3D,EAAWs3D,YAAc,IACf,aAA3Bt3D,EAAWg3D,aAClBh3D,EAAWu3D,WAAa,IACxBv3D,EAAWs3D,WAAa,MAExBt3D,EAAWu3D,WAAa,IACxBv3D,EAAWs3D,WAAa,KAOpCzG,eAAgB,WACZ,OAAO12D,OAAO23D,UAAUvkE,QAAQ2iE,qBAKpCpkB,OAAQ,SAAU2rB,GACd,OAAOnqE,KAAKgnE,cAAcmD,IAK9BnD,cAAe,SAAUmD,GACrB,IAAIpqE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB8yC,EAAOzlD,EAAK2gC,mBAEhB3gC,EAAKkgE,kBAAoB,IAAI9iE,EAAE4S,SAG/Bo6D,EAAqBA,GAAsB,SAC3C,IAAIC,EAAiBrqE,EAAK+iE,cAAcvT,YAAY4a,GAGhDnpE,EAAQ0R,EAAWynC,YACH,iBAATn5C,IAMPA,GADAA,GADAA,GADAA,GADAA,GADAA,EAAQA,EAAM2a,WAAW,IAAK,UAChBA,WAAW,IAAK,UAChBA,WAAW,IAAK,QAAQA,WAAW,IAAK,SACxCA,WAAW,IAAM,SAASA,WAAW,IAAK,SAASA,WAAW,IAAK,UACnEA,WAAW,MAAO,UAClBA,WAAW,KAAM,UAGnC,IAAI0uD,EAA8C,YAA/Bx9D,OAAOY,KAAKoG,iBAAqD,gBAApBnB,EAAWzI,MAA8C,cAApByI,EAAWzI,OAA8C,mBAApByI,EAAWzI,MAAiD,wBAApByI,EAAWzI,OAAmC4C,OAAOY,KAAK0yB,kBAA0C,SAApBztB,EAAWzI,OAAoB4C,OAAOY,KAAK0yB,kBACzS6pC,EAAa5pD,WAAW1N,EAAWs3D,YAGnCzmE,EAAOpG,EAAE0E,SAASuoE,GAClBppE,MAAOA,EAAOq9C,SAAU3rC,EAAW2rC,SACnC0G,SAAUryC,EAAWqyC,SACrBulB,eAAoC,QAAnB53D,EAAWzI,MAAkByI,EAAW63D,WACzDzmE,YAAa4O,EAAW5O,YACxB4gE,SAAUhyD,EAAWgyD,SACrBpnE,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClBsxC,IAAKz/C,EAAWy/C,IAChBuX,YAAah3D,EAAWg3D,YACxBc,mBAAoBzqE,EAAK0qE,sBAAsB/3D,EAAWg3D,aAC1DgB,gBAAiB3qE,EAAK4qE,cAAcj4D,EAAW42D,YAC/CsB,gBAAiB7qE,EAAK4qE,cAAcj4D,EAAW62D,YAC/CS,WAAYA,EACZa,iBAAkBb,GAAuC,UAAzBt3D,EAAWw3D,WAAyB,KAAO,KAC3ED,WAAY7pD,WAAW1N,EAAWu3D,YAClCa,iBAAkB1qD,WAAW1N,EAAWu3D,aAAwC,UAAzBv3D,EAAWw3D,WAAyB,KAAO,KAClGA,WAAYx3D,EAAWw3D,WACvBlmE,SAA6B,WAAnBjE,EAAK8jE,UACfv7D,kBAAmBoK,EAAWpK,kBAC9ByiE,aAAcvlB,EAAKn6C,OAAOu5C,aAC1Bv+C,SAAUqM,EAAWpM,UAAY,GACjC4iE,iBAAkBx2D,EAAWw2D,iBAC7BD,SAAUv2D,EAAWu2D,SACrBh/D,KAAMyI,EAAWzI,KACjB+gE,eAAgBX,EAChBvL,SAAUpsD,EAAWosD,SACrBzgB,SAAU3rC,EAAW2rC,WAIrBt2C,EAAShI,EAAKkrE,wBAsBlB,OArBKljE,IACDA,EAAS,IAImB,iBAAb,GAAyBA,EAAOI,KAKxB,aAAnBJ,EAAOK,SAEP7E,EAAOxD,EAAKmrE,mBAAmB3nE,EAAMxD,EAAKsI,cAAcN,IACxDhI,EAAK+gE,oBAAsB,OAG3B/gE,EAAK+gE,oBAAsB/4D,EAC3BxE,EAAOxD,EAAKmrE,mBAAmB3nE,EAAM,KAVzCA,EAAOxD,EAAKmrE,mBAAmB3nE,EAAMwE,GAclCxE,GAKX8E,cAAe,SAAUE,GACrB,OAAOsE,OAAOxE,cAAcE,IAKhCw9D,WAAY,WAER,QADW/lE,KACDigE,mBADCjgE,KAICigE,kBAAkB13D,WAKlC0iE,sBAAuB,WACnB,IAAIlrE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGtB,OAFA3S,EAAK0S,QAAU,KAEX1S,EAAK+iE,cAAciI,cACnBr4D,EAAWqyC,UAAW,EACfhlD,EAAKorE,iBACLz4D,EAAWqyC,SACXhlD,EAAKorE,gBAGTprE,EAAKqrE,kBAKhBtE,kBAAmB,SAAU7mE,GACzB,IAAIF,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGtB3S,EAAKE,QAAUA,EAEXyS,EAAWovD,gBACX/hE,EAAKsrE,0BAGTC,eAAgB,EAEhB,IAAIC,EAAoB,SAAUC,GAC1B3+D,OAAO23D,UAAUhmB,OAAOsqB,oBACxBj8D,OAAO23D,UAAUhmB,OAAOqqB,gBAAkBh8D,OAAO23D,UAAUhmB,OAAOoqB,oBAGlE9mE,WAAW,WACP/B,EAAK0rE,mBAAmBD,GACxB3+D,OAAO23D,UAAUhmB,OAAOmqB,mBAAqB,IAC9C97D,OAAO23D,UAAUhmB,OAAOmqB,mBAG3B5oE,EAAK0rE,mBAAmBD,GAE5B3+D,OAAO23D,UAAUhmB,OAAOqqB,mBAGxB9oE,EAAK+gE,oBAEL3jE,EAAEqM,KAAKzJ,EAAK+gE,qBACP34D,KAAK,SAAU5E,GACZ,IAAIkP,EAAU1S,EAAK2rE,aACkC,mBAA1C3rE,EAAK4rE,mCACZ5rE,EAAK4rE,oCAETl5D,EAAQ7Q,OAAO2B,GAGfgoE,EAAkBtrE,GAClBF,EAAK6rE,eAAeN,cAAevrE,EAAK2S,WAAW02D,mBAI3DmC,EAAkBtrE,IAM1BwrE,mBAAoB,SAAUxrE,GAC1B,IAAIF,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB7S,EAAOE,EAAK8jE,UAEhB9jE,EAAK0S,QAAU1S,EAAK2rE,aAGhB3rE,EAAKkgE,mBACLlgE,EAAKkgE,kBAAkB9vD,UAIvBuC,EAAWqyC,SAEPhlD,EAAK+iE,cAAciI,cAAgBhrE,EAAK8rE,uBACxC9rE,EAAK8rE,yBAEL9rE,EAAKoE,aAKTpE,EAAK+rE,mBAAmB7rE,GAIhB,aAARJ,EACAE,EAAKgsE,8BAELhsE,EAAKisE,2BAGTjsE,EAAK6rE,cAAcN,cAAevrE,EAAK2S,WAAW6rD,gBAClDx+D,EAAK6rE,eAAeN,cAAevrE,EAAK2S,WAAW02D,kBAKvD2C,4BAA6B,WACzB,IAAIhsE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB3S,EAAK+jE,eAAiB/jE,EAAKsiD,MAAMoiB,iBACjC1kE,EAAKksE,6BAILv5D,EAAWqyC,SACXhlD,EAAKqmE,oBAELrmE,EAAKmsE,4BAITnsE,EAAKosE,2BAKTH,yBAA0B,WACXhsE,KAGNsmE,sBAHMtmE,KAMNmsE,2BAKTjB,mBAAoB,SAAU3nE,EAAMoB,GAGhC,OADAA,EAAUA,GAAW,IADrBpB,EAAOA,GAAQ,IAEHoB,QAAQ,cAAeA,IAKvCi/D,mBAAoB,WAKhB,OAJI/2D,OAAOY,KAAKqT,QAAQ9gB,KAAKC,UACzB4M,OAAO6T,IAAI,gCAAiC1gB,KAAM,SAG/CA,KAAKC,SAKhBksE,wBAAyB,WACrB,IAAIpsE,EAAOC,KACP0S,EAAa3S,EAAK2S,WACtB3S,EAAKqsE,6BAA8B,EAG/B15D,EAAWqyC,SACNl4C,OAAOY,KAAKqT,QAAQ/gB,EAAK6D,QAC1B7D,EAAKghE,gBAAgBhhE,EAAK6D,OAOlC7D,EAAKqsE,6BAA8B,GAKvCpiE,QAAS,SAAU0vD,GACf,IAEIhjD,EAFA3W,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElB25D,EAAYtsE,EAAKzB,MAAQyB,EAAKzB,KAAKoU,YAAc3S,EAAKzB,KAAKoU,WAAW25D,UAG1E,IAAqD,IAAjDx/D,OAAOY,KAAKuF,aAAaN,EAAW2iD,SACpC,OAAO,EAGX,IAAsD,IAAlDxoD,OAAOY,KAAKuF,aAAaN,EAAWqyC,YAAwBsnB,EAC5D,OAAO,EAOX,GAHAtsE,EAAKq5D,qBAAqB,IAGtBvsD,OAAOY,KAAKuF,aAAaN,EAAWosD,UAAW,CAC/C,IAAItZ,EAAOzlD,EAAK2gC,mBACZ4rC,GAAW,EACXzW,EAAU91D,EAAKzB,MAAQyB,GAAQylD,EAAKsQ,WAAWpjD,EAAWmO,OAC1D0rD,EAAc,UAAUr6D,KAAKQ,EAAWzI,MAW5C,GATA4rD,EAAQld,OAAO,SAAU6F,GACrB,OAAOA,EAAO9rC,WAAWpV,IAAMoV,EAAWpV,KAC3Cq9D,QAAQ,SAAUnc,GACjB,GAAIA,EAAO8tB,aAAe9tB,EAAO9rC,WAAWqyC,UAAYsnB,GAEpD,OADAC,GAAW,GACJ,KAIVA,IAAavsE,EAAK2S,WAAW8yD,QAAS,CACvC9uD,EAAU3W,EAAKgN,YAAY,wBAAwB4O,WAAW,UAAWjJ,EAAWynC,aACpF,IAAIqyB,GAAe3rD,MAAOnO,EAAWmO,MAAOnK,QAASA,GAUrD,OARI61D,IACAC,EAAcrvE,EAAEsJ,UAAW+lE,GACvBlvE,GAAIoV,EAAWpV,GACfmvE,QAASF,KAIjB7S,EAAgB9wD,KAAK4jE,IACd,GAKf,GAAyB,aAArB95D,EAAWwyD,QAEX,GAAInlE,EAAK0lE,aACD1lE,EAAK0lE,YAAY9yD,YAAc5S,EAAK4S,WAGpC,OAFA+D,EAAU3W,EAAKgN,YAAY,4BAC3B2sD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,KACjD,OAGZ,GAAyB,UAArBhE,EAAWwyD,OAAoB,CACtC,IAAIzyD,EAAUtV,EAAE,QAAS4C,EAAKE,SAG9B,GAAIwS,GAAWA,EAAQ5U,KAAK,YAAa,CACrC,GAAsB,KAAlB4U,EAAQrD,MAQR,OANAsH,EAAU3W,EAAKgN,YAAY,4BAC3B2sD,EAAgB9wD,MACZiY,MAAOnO,EAAWmO,MAClBnK,QAASA,KAGN,EACJ,GAAIjE,EAAQrD,OAASqD,EAAQ5U,KAAK,YAIrC,OAHA6Y,EAAU3W,EAAKgN,YAAY,4BAC3B2sD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,KAEjD,GAMnB,IAAIg2D,GAAiB3sE,EAAKzB,OAAQyB,EAAKzB,KAAKu2D,WAAY90D,EAAKzB,KAAKu2D,UAAU90D,EAAK2S,WAAWmO,OAAOnO,WAAWqyC,SAC9G,GAAwB,iBAApBryC,EAAWzI,WAAoD/B,IAAzBwK,EAAWy2D,WAA2Bz2D,EAAWy2D,UAAY,GAAKt8D,OAAOY,KAAK0S,UAAUzN,EAAWy2D,aACrIuD,IAAoBA,GAAkB3sE,EAAKyS,yBAA0B,CACrE,IAAI22D,EAAY,IAAIt/D,OAAO6I,EAAWy2D,WAClCvlE,EAAQ7D,EAAK4S,WAEjB,GAAI/O,GAASA,EAAMkN,WAAW5L,OAASikE,EAGnC,OAFAzyD,EAAU3W,EAAKgN,YAAY,+BAA+B4O,WAAW,cAAewtD,GACpFzP,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,KACjD,EAKnB,OAAO,GAMX41D,SAAU,WACN,IAEI1oE,EAFO5D,KAEM2S,WAEjB,OADA/O,EAASA,GAAkC,SAHhC5D,KAGY0S,WAAWzI,KAAmBrG,EAAMsZ,OAAStZ,GAC5DiJ,OAAOY,KAAKqT,QAAQld,IAKhCO,WAAY,aAKZ2nE,mBAAoB,aAKpB1F,kBAAmB,aAKnB8F,0BAA2B,aAK3B5F,oBAAqB,aAKrBsF,cAAe,SAAUN,EAAex5C,GACpC,IAAI/xB,EAAOC,KACP0S,EAAa3S,EAAK2S,WAEtB,GAAyB,MAArB3S,EAAK2rE,aAAT,EAGA55C,EAASA,OAEE4sC,OACP3+D,EAAK+/D,YAAYhuC,EAAO4sC,MAAO4M,GAE/Bx5C,EAAOsT,YACPrlC,EAAK2/D,sBAAsB5tC,EAAOsT,aAGlCtT,EAAO66C,MAAS76C,EAAO66C,MAASrB,GAChCvrE,EAAK6sE,eAAe96C,EAAO66C,KAAMrB,GAEjCx5C,EAAO+6C,QACP9sE,EAAK+sE,iBAAiBh7C,EAAO+6C,OAAQvB,GAErCx5C,EAAOi7C,WACPhtE,EAAKitE,oBAAoBl7C,EAAOi7C,UAAWzB,GAE3Cx5C,EAAOm7C,YACPltE,EAAKmtE,qBAAqBp7C,EAAOm7C,WAAY3B,GAE7Cx5C,EAAO2xC,MACP1jE,EAAKotE,eAAer7C,EAAO2xC,KAAM6H,GAIrC54D,EAAWosD,SAAkC52D,MAAvBwK,EAAWosD,UAAwBjyD,OAAOY,KAAKuF,aAAaN,EAAWosD,UAC7F,IAAIzJ,EAAgCntD,MAAtBwK,EAAW2iD,SAAuBxoD,OAAOY,KAAKuF,aAAaN,EAAW2iD,SAChF3iD,EAAWosD,UACX/+D,EAAK4gE,eAAejuD,EAAWosD,UAE9BzJ,GACDt1D,EAAKmgE,iBAAiB7K,KAM9BtjB,SAAU,SAAUnuC,EAAOwpE,GACvB,IAAIrtE,EAAOC,KACXotE,OAAkCllE,IAAlBklE,GAA8BA,EAExCvgE,OAAOY,KAAK0U,iBAAiBve,EAAO7D,EAAK6D,SAE3C7D,EAAK2S,WAAW82D,cAAgBzpE,EAAK2S,WAAWG,cAAgB9S,EAAK6D,MAGrE7D,EAAK6D,MAAQ7D,EAAK2S,WAAW9O,MAAQA,EACjC7D,EAAK2S,WAAWosD,UAA8B,aAAlB/+D,EAAK8jE,YAE7B9jE,EAAKstE,kBACLttE,EAAKutE,qBAAoB,GAEzBvtE,EAAKutE,qBAAoB,IAK7BF,IAAkBrtE,EAAKqsE,8BACvBrsE,EAAKsoE,sBACLtoE,EAAKwtE,2BAKjBF,cAAe,SAAU3T,GACrB,IACIhnD,EADO1S,KACW0S,WAEtB,QAAI7F,OAAOY,KAAKuF,aAAaN,EAAWosD,YAH7B9+D,KAIGssE,cACN51D,QALG1W,KAKY+M,YAAY,wBAAwB4O,WAAW,UAAWjJ,EAAWynC,aACpFuf,EAAgB9wD,MACZiY,MAAOnO,EAAWmO,MAClBnK,QAASA,WAEN,IAMnB82D,oBAAqB,WAEjB,OADWxtE,KACF0S,WAAWwyD,SADTllE,KACwBylE,aADxBzlE,KAEK2S,YAFL3S,KAEwBylE,YAAY9yD,YAQnD01D,oBAAqB,SAAUh9D,IAE3BA,EAASA,OACFyxD,aAA6B50D,IAAnBmD,EAAOyxD,SAAwBzxD,EAAOyxD,QAF5C98D,KAGN85D,eAAe,gBAAiBtb,OAH1Bx+C,KAGwC88D,QAASzxD,EAAOyxD,WAKvEyQ,sBAAuB,WACRvtE,KACN85D,eAAe,kBAAmBtb,OAD5Bx+C,QAMf+gE,gBAAiB,SAAUn9D,GACvB,IAAI7D,EAAOC,KACPyS,EAAU1S,EAAK2rE,aAKnB,GAFA3rE,EAAKgyC,SAASnuC,GAAO,IAEhB7D,EAAK2S,WAAWqyC,WAAyC,UAA5BhlD,EAAK2S,WAAWugC,SAAoD,UAA5BlzC,EAAK2S,WAAWugC,UAAuD,IAAhCpmC,OAAOwkB,SAASo8C,aAAwB,CAErJ,IAAIC,EAAe3tE,EAAK4tE,gBAAgB/pE,GACX,iBAAlB,GAAuD,iBAAlB,IAC5C8pE,EAAe7gE,OAAOY,KAAK24B,aAAasnC,GACxCvwE,EAAEsV,GAASlP,KAAK,mCAAqCmqE,EAAe,eAOhF/6D,SAAU,WACN,OAAO3S,KAAK4D,OAKhB+pE,gBAAiB,WACb,OAAO3tE,KAAK2S,YAKhBi7D,SAAU,WACN/gE,OAAOY,KAAK8S,cAAc,aAK9BmrD,WAAY,WACR7+D,OAAOY,KAAK8S,cAAc,eAK9BstD,iBAAkB,WACdhhE,OAAOY,KAAK8S,cAAc,qBAK9B4qD,cAAe,aAKf/R,qBAAsB,SAAU1iD,GAC5B1W,KAAK8tE,kBAAoBp3D,GAK7B00D,eAAgB,WACZ,IAAIrjE,EAAS/H,KAAK2S,WACdo7D,EAAgB,GAYpB,OAVIlhE,OAAOY,KAAKqS,SAAS/X,SAAqC,IAAlBA,EAAY,MACpDgmE,EAAgBlhE,OAAOY,KAAK24B,aAAar+B,EAAOnE,OACxCiJ,OAAOY,KAAKqT,QAAQ/Y,KAExBgmE,EADAlhE,OAAOY,KAAKmS,SAAS7X,GACL8E,OAAOY,KAAKu5B,oBAAoBj/B,GAEhCA,GAIjBgmE,GAMXlC,uBAAwB,aAMxBmC,oBAAqB,SAAUtE,GAC3B1pE,KAAK0S,WAAWg3D,YAAcA,GAMlCe,sBAAuB,SAAUf,GAC7B,MAAO,IAMXuE,iBAAkB,SAAUC,GACxBluE,KAAK0S,WAAW42D,WAAa4E,GAMjCC,iBAAkB,SAAUD,GACxBluE,KAAK0S,WAAW62D,WAAa2E,GAMjCvD,cAAe,SAAUuD,GACrB,MAAO,IAMXE,qBAAsB,aAItBtO,YAAa,SAAUpB,EAAO4M,GAC1B,IAAIvrE,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACf1qE,EAAQjB,EAAK6tE,WACbtC,OAAyC,IAAjBA,GAAiD,MAAjBA,GAAyBA,EAEjF74D,GAAWzR,IACE,QAAT09D,EAEoC,UAAhC3+D,EAAK2S,WAAWg3D,aAA4B4B,GAM5CvrE,EAAKE,QAAQY,KAAK,WACdb,KAAKoS,MAAMZ,YAAY,QAASktD,EAAO,eAGf,QAAxB3+D,EAAK2S,WAAWzI,MAChBlK,EAAK2rE,aAAapoE,KAAK,iCAAiCzC,KAAK,WACzDb,KAAKoS,MAAMZ,YAAY,QAASktD,EAAO,eAI/C3+D,EAAK6tE,WAAWtqE,KAAK,SAASoB,IAAI,QAASg6D,EAAO,eACjB,IAA7B3+D,EAAK2S,WAAWqyC,WAChBhlD,EAAKsuE,qBAAqBtuE,EAAK2rE,cAAchnE,IAAI,QAASg6D,EAAO,cACjE3+D,EAAKsuE,qBAAqBlxE,EAAE,QAAS4C,EAAK2rE,cAAchnE,IAAI,QAASg6D,EAAO,kBAlBhF3+D,EAAKsuE,qBAAqBtuE,EAAK2rE,cAAchnE,IAAI,QAASg6D,EAAO,cACjE3+D,EAAK2rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1CF,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,QAASg6D,EAAO,kBAoB/D3+D,EAAKE,QAAQyE,IAAI,QAAS,IAC1B3E,EAAK6tE,WAAWtqE,KAAK,SAASoB,IAAI,QAAS,IAC3C3E,EAAK2rE,aAAahnE,IAAI,QAAS,IAE/B3E,EAAK2rE,aAAapoE,KAAK,mBAAmBzC,KAAK,SAAUC,EAAGb,GACxD,IAAIquE,EAAgBnxE,EAAE8C,GAASpC,KAAK,kBAAoB,GACxDkC,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,QAAS4pE,QAOhE5O,sBAAuB,SAAUhB,GAC7B,IAAI3+D,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACf1qE,EAAQjB,EAAK6tE,WAEjB,GAAIn7D,GAAWzR,EACX,GAAa,QAAT09D,EAAiB,CACjB3+D,EAAKE,QAAQY,KAAK,WACdb,KAAKoS,MAAMZ,YAAY,mBAAoBktD,EAAO,oBAGX,IAA/B19D,EAAMsC,KAAK,SAAc,MACjCvD,EAAK6tE,WAAWtqE,KAAK,SAAS8O,MAAM,mBAAoBssD,EAAO,aAE/D3+D,EAAK6tE,WAAWtqE,KAAK,SAASoB,IAAI,mBAAoBg6D,EAAO,cAGjE,IAAI6P,EAAexuE,EAAK6tE,WAAWtsE,KAAK,SACxCitE,GAAgB,sBAAwB7P,EAAQ,aAChD3+D,EAAK6tE,WAAWtsE,KAAK,QAASitE,QAE9BxuE,EAAKE,QAAQyE,IAAI,mBAAoB,IACrC3E,EAAK6tE,WAAWtqE,KAAK,SAASoB,IAAI,mBAAoB,IACtD3E,EAAK2rE,aAAahnE,IAAI,mBAAoB,IAC1C3E,EAAK2rE,aAAapoE,KAAK,mBAAmBzC,KAAK,SAAUC,EAAGb,GACxD,IAAIquE,EAAgBnxE,EAAE8C,GAASpC,KAAK,kBAAoB,GACxDV,EAAE8C,GAASyE,IAAI,mBAAoB4pE,MAOnDE,mBAAoB,WAEhB,OADWxuE,KACC4tE,WAAWtqE,KAAK,UAIhCspE,eAAgB,SAAUD,EAAMrB,GAExBA,OAAyC,IAAjBA,GAAiD,MAAjBA,GAAyBA,EAG/C,GAAlCz+D,OAAOY,KAAKuF,aAAa25D,IAAkBrB,GAJpCtrE,KAKFwuE,qBAAqB9pE,IAAI,cAAe,OAAQ,cAL9C1E,KAMF0rE,aAAa7qE,KAAK,SAAUC,EAAGb,GAChC9C,EAAE8C,GAASyE,IAAI,cAAe,OAAQ,iBAItC4mE,GAXGtrE,KAYEwuE,qBAAqB9pE,IAAI,cAAe,SAAU,cAE1D4mE,IACqC,GAAlCz+D,OAAOY,KAAKuF,aAAa25D,GAftB3sE,KAgBE0rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1C9C,EAAE8C,GAASyE,IAAI,cAAe,OAAQ,iBAjBvC1E,KAoBE0rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1C9C,EAAE8C,GAASyE,IAAI,cAAe,SAAU,gBArBzC1E,KAuBE0rE,aAAahnE,IAAI,cAAe,SAAU,iBAK3D8N,sBAAuB,WACnB,IACIE,EADO1S,KACW0S,WAClB9O,EAFO5D,KAEM2S,WACbC,EAAeF,EAAWG,cAC1B47D,EAAY/7D,EAAWg8D,aACvB3mE,GAAS,EACT+sD,EAAajoD,OAAOY,KAAKs8B,cAAcr3B,EAAWzI,MAGtD,GAAI9M,EAAE2V,iBACF,OAAO,EAIX,GAAmB,SAAfgiD,GAAkD,YAd3C90D,KAcuBoR,QAAQhJ,QACtC,OAAO,EAGX,IAAK,QAAS,aAAc,OAAQ,YAAY,QAAS,cAAc2K,SAAS+hD,IAAe,oBAAoB5iD,KAAK4iD,GAChHlxD,QAA0BsE,IAAjBtE,EAAMsB,SACftB,EAAQA,EAAM,IAEdgP,QAAwC1K,IAAxB0K,EAAa1N,SAC7B0N,EAAeA,EAAa,IAE5B67D,QAAkCvmE,IAArBumE,EAAUvpE,SACvBupE,EAAYA,EAAU,IAE1B7qE,EAAQA,GAASA,EAAMtG,GAAKsG,EAAMtG,GAAKsG,EACvCgP,EAAeA,GAAgBA,EAAatV,GAAKsV,EAAatV,GAAKsV,EAG/D7K,OADoB,KADxB0mE,EAAYA,GAAaA,EAAUnxE,GAAKmxE,EAAUnxE,GAAKmxE,IACH,MAAbA,EACzB77D,GAAgBhP,GAAWgP,GAAgB67D,EAE3C77D,GAAgBhP,OAE3B,GAAmB,YAAfkxD,GAA2C,iBAAfA,GAAgD,eAAfA,EACpE/sD,EAAU8E,OAAOY,KAAKuF,aAAaJ,IAAiB/F,OAAOY,KAAKuF,aAAapP,QAC1E,GAAmB,iBAAfkxD,EACP/sD,IAAW,OACR,GAAmB,WAAf+sD,EAIH/sD,GAHW,OAAVnE,GAA4B,KAAVA,GAAmC,OAAjBgP,GAA0C,KAAjBA,IAGpDA,IAAiBhP,OAE5B,GAAmB,SAAfkxD,EAIH/sD,GAHW,OAAVnE,GAA4B,KAAVA,GAAmC,OAAjBgP,GAA0C,KAAjBA,IAGpDA,IAAiBhP,OAE5B,GAAmB,SAAfkxD,EAIH/sD,KAHC6K,IAAiBhP,IAGRgP,GAAgBhP,OAE3B,GAAmB,mBAAfkxD,EAAiC,CAExC/sD,GAAS,EACT,IAAI4mE,KACJ,IAEQA,EADwB,iBAAjB/7D,EACW+J,KAAKhE,MAAM/F,GAEXA,EAExB,MAAO3E,IAGT,IAAI2gE,EAAc,SAAUljC,EAAMmjC,GAC9BnjC,EAAOA,GAAQ,GAGf,IADA,IAAI3jC,GAAS,EACJjH,EAAI,EAAGiW,GAFhB83D,EAAYA,OAEkB3pE,OAAQpE,EAAIiW,EAAGjW,IACzC,GAAI+tE,EAAU/tE,GAAGguE,YAAcpjC,EAAM,CACjC3jC,GAAS,EACT,MAGR,OAAOA,GAGX,GAAI4mE,EAAgBzpE,QAAUtB,EAAMsB,OAChC,IAAK,IAAIpE,EAAI,EAAGiW,EAAI43D,EAAgBzpE,OAAQpE,EAAIiW,EAAGjW,IAC1C8tE,EAAYD,EAAgB7tE,GAAGguE,WAAYlrE,KAC5CmE,GAAS,QAKjBA,GAAS,OAEV,GAAmB,wBAAf+sD,GAAuD,mBAAfA,EAG3C/sD,EADA6K,EAAa1N,QAAUtB,EAAMsB,QAGnByX,KAAKC,OAAOhZ,IAAU+Y,KAAKC,OAAOhK,QAE7C,GAAmB,UAAfkiD,EAEH/sD,IADgB,MAAhB6K,GAAwBhP,EAAMsG,SAAQ,GAAQ,QAK/C,GAAmB,eAAf4qD,EAA6B,CACpC,IAAIia,KACJ,IACIA,EAAcpyD,KAAKhE,MAAM/U,GAC3B,MAAOqK,GACLwS,QAAQC,IAAI,wDAEhB3Y,EAAU4U,KAAKC,OAAOhK,IAAiB+J,KAAKC,OAAOmyD,EAAYnrE,YAE/DmE,EAAU6K,IAAiBhP,EAG/B,OAAOmE,GAIX+kE,iBAAkB,SAAUD,EAAQvB,GAChC,IAAIvrE,EAAOC,KACPsrE,OAAyC,IAAjBA,GAAiD,MAAjBA,GAAyBA,EAGlD,SAA/BvrE,EAAK2S,WAAWg3D,aAA2B4B,EAyBH,GAApCz+D,OAAOY,KAAKuF,aAAa65D,GACzB9sE,EAAKyuE,qBAAqB9pE,IAAI,aAAc,SAAU,cAEtD3E,EAAKyuE,qBAAqB9pE,IAAI,aAAc,SAAU,cA3BlB,GAApCmI,OAAOY,KAAKuF,aAAa65D,IACrBvB,GACAvrE,EAAKyuE,qBAAqB9pE,IAAI,aAAc,SAAU,cAEtD3E,EAAK2S,WAAWqyC,SAChBhlD,EAAK2rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1CF,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,aAAc,SAAU,gBAGnE3E,EAAKsuE,qBAAqBtuE,EAAK2rE,cAAchnE,IAAI,aAAc,SAAU,gBAGzE4mE,GACAvrE,EAAKyuE,qBAAqB9pE,IAAI,aAAc,SAAU,cAEtD3E,EAAK2S,WAAWqyC,SAChBhlD,EAAK2rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1CF,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,aAAc,SAAU,gBAGnE3E,EAAKsuE,qBAAqBtuE,EAAK2rE,cAAchnE,IAAI,aAAc,SAAU,gBAazFsoE,oBAAqB,SAAUD,EAAWzB,GACtC,IAAIvrE,EAAOC,KACPu+D,EAAax+D,EAAK2S,WAAW6rD,eAC7B6K,EAAcrpE,EAAK2S,WAAW02D,gBAC9B6D,EAAapgE,OAAOY,KAAKuF,aAAaurD,EAAW0O,YAAc,gBAAkB,GACjF+B,EAAkBniE,OAAOY,KAAKuF,aAAao2D,EAAY6D,YAAc,gBAAkB,GACvF3B,OAAyC,IAAjBA,GAAiD,MAAjBA,GAAyBA,EAG1C,GAAvCz+D,OAAOY,KAAKuF,aAAa+5D,IAAsBzB,GAC/CvrE,EAAKyuE,qBAAqB9pE,IAAI,kBAAmBuoE,EAAa,YAAa,cAC3EltE,EAAK2rE,aAAa7qE,KAAK,SAAUC,EAAGb,GAChCF,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,kBAAmBuoE,EAAa,gBAGvE3B,GACAvrE,EAAKyuE,qBAAqB9pE,IAAI,kBAAmBuoE,EAAY,cAElC,SAA/BltE,EAAK2S,WAAWg3D,aAA2B4B,IACA,GAAvCz+D,OAAOY,KAAKuF,aAAa+5D,GACrBhtE,EAAK2S,WAAWqyC,SAChBhlD,EAAK2rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1CF,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,kBAAmBsqE,EAAkB,YAAa,gBAG7FjvE,EAAKsuE,qBAAqBtuE,EAAK2rE,cAAchnE,IAAI,kBAAmBsqE,EAAkB,YAAa,cAGvGjvE,EAAK2rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1CF,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,kBAAmBsqE,EAAiB,kBAO3F9B,qBAAsB,SAAUD,EAAY3B,GACxC,IAAIvrE,EAAOC,KACPu+D,EAAax+D,EAAK2S,WAAW6rD,eAC7B6K,EAAcrpE,EAAK2S,WAAW02D,gBAC9B2D,EAAYlgE,OAAOY,KAAKuF,aAAaurD,EAAWwO,WAAa,aAAe,GAC5EkC,EAAiBpiE,OAAOY,KAAKuF,aAAao2D,EAAY2D,WAAa,aAAe,GAClFzB,OAAyC,IAAjBA,GAAiD,MAAjBA,GAAyBA,EAGzC,GAAxCz+D,OAAOY,KAAKuF,aAAai6D,IAAuB3B,EAChDvrE,EAAKyuE,qBAAqB9pE,IAAI,kBAAmBqoE,EAAY,eAAgB,cAEzEzB,GACAvrE,EAAKyuE,qBAAqB9pE,IAAI,kBAAmBqoE,EAAW,cAGjC,SAA/BhtE,EAAK2S,WAAWg3D,aAA2B4B,IACC,GAAxCz+D,OAAOY,KAAKuF,aAAai6D,GACrBltE,EAAK2S,WAAWqyC,SAChBhlD,EAAK2rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1CF,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,kBAAmBuqE,EAAiB,eAAgB,gBAG/FlvE,EAAKsuE,qBAAqBtuE,EAAK2rE,cAAchnE,IAAI,kBAAmBuqE,EAAiB,eAAgB,cAGrGlvE,EAAK2S,WAAWqyC,SAChBhlD,EAAK2rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC1CF,EAAKsuE,qBAAqBpuE,GAASyE,IAAI,kBAAmBuqE,EAAgB,gBAG9ElvE,EAAKsuE,qBAAqBtuE,EAAK2rE,cAAchnE,IAAI,kBAAmBuqE,EAAgB,gBAOpG9B,eAAgB,SAAU1J,EAAM6H,GAExBA,OAAyC,IAAjBA,GAAiD,MAAjBA,GAAyBA,EAGrF,GAAY,KAAR7H,EAAa,CACb,IAAIziE,EALGhB,KAKUwuE,qBACbU,EAAe,IAAqB,GAAfrlE,OAAO45D,GAAc,IAI9C,GAHI6H,GACAtqE,EAAM0D,IAAI,YAAawqE,EAAa,cAEL,SAV5BlvE,KAUE0S,WAAWg3D,cAA2B4B,EAAe,CAC1D,IAAI74D,EAXDzS,KAWgB0rE,aACc,iBAAtBj5D,EAAQpP,YAA0BoP,EAAQpP,WAAW6B,OAAS,EAZtElF,KAaMquE,qBAAqB57D,EAAQpP,YAAYqB,IAAI,YAAawqE,EAAa,eAb7ElvE,KAeMquE,qBAAqB57D,GAAS/N,IAAI,YAAawqE,EAAa,eAEpB,GAjB9ClvE,KAiBU0S,WAAWzI,KAAKC,QAAQ,SAAiBu5D,EAAO,GAAsBhxD,EAASpP,SAAS,GAAGyf,OAAO,EAAI2gD,EAAO,KAjBvHzjE,KAoBEquE,qBAAqB57D,EAAQnP,KAAK,2BAA2BoB,IAAI,cAAe,aAQjG2pE,qBAAsB,SAAU1/D,GAC5B,OAAOxR,EAAEwR,IAIbuxD,iBAAkB,SAAU5L,GACxB,IACI5hD,EADO1S,KACW0S,WAGoB,GAAtC7F,OAAOY,KAAKuF,aAAashD,GACD,WAApB5hD,EAAWzI,OALRjK,KAMEC,QAAQoF,OANVrF,KAOEC,QAAQyE,IAAI,UAAW,IAExBgO,EAAWosD,WATZ9+D,KAUWssE,YAVXtsE,KAWUstE,qBAAoB,KAX9BttE,KAeKC,SAfLD,KAgBFC,QAAQkF,OAIjBuN,EAAW2iD,QAAUf,GAGzBgM,kBAAmB,SAAUhM,GACzB,IAAIv0D,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBD,EAAU1S,EAAK2rE,aAGnBh5D,EAAWqyC,SAAWl4C,OAAOY,KAAKuF,aAAashD,GAG/C7hD,EAAQxQ,QAEiC,mBAA9BlC,EAAKkrE,uBACZ9tE,EAAEqM,KAAKzJ,EAAKkrE,yBAAyB9iE,KAAK,SAAU5E,GACG,mBAAxCxD,EAAKovE,iCACZpvE,EAAKovE,kCACJpvE,EAAK+gE,qBACNruD,EAAQ7Q,OAAO2B,GACnBxD,EAAK+mE,kBAAkB/mE,EAAKE,YAQxCmvE,6BAA8B,SAAU9a,EAAUvzD,EAAK8f,GACnD,IAAI9gB,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBD,EAAU1S,EAAK2rE,aAEf2D,EAAetvE,EAAKzB,KAAKu2D,UAAUh0C,GACnCyuD,EAAYD,EAAaE,aAAaxuE,GAG1C2R,EAAWqyC,SAAWl4C,OAAOY,KAAKuF,aAAashD,GAG/C7hD,EAAQxQ,QACiC,mBAA9BlC,EAAKkrE,uBACZ9tE,EAAEqM,KAAKzJ,EAAKkrE,yBAAyB9iE,KAAK,SAAU5E,GAC3CxD,EAAK+gE,qBACNruD,EAAQ7Q,OAAO2B,GAGnBxD,EAAK+mE,kBAAkB/mE,EAAKE,SAExByS,EAAWqyC,WAEXsqB,EAAarqE,KAAK,WAAY,WAC1BqqE,EAAaG,cAAcr/D,YAG/Bm/D,EAAUnoD,OAAO,gBAGjBmoD,EAAUtqE,KAAK,eAAgB,SAAUw5C,EAAQvvC,GAC7CogE,EAAavS,SAAU,EACvB/8D,EAAKzB,KAAKmxE,aAAaJ,EAAc,KAAMtuE,EAAKkO,SAOpE0xD,eAAgB,SAAUrM,GACtB,IACI5hD,EADO1S,KACW0S,WAElB1R,EAAQ0R,EAAWynC,aAAe,GAClCu1B,EAAevyE,EAAE,QAJV6C,KAIwB4tE,YAC/B+B,EALO3vE,KAKe0rE,aAG1Bh5D,EAAWosD,SAAWxK,EAGA,aAXXt0D,KAWF6jE,WAXE7jE,KAW+BqtE,kBAX/BrtE,KAYFstE,qBAAoB,GACoB,GAAtCzgE,OAAOY,KAAKuF,aAAashD,IAAqB5hD,EAAWqyC,SAC7B,OAd5B/kD,KAcE0S,WAAW5O,YAChB6rE,EAAe/2B,QAAQ,8DAEvB+2B,EAAetuE,SAAS,oBACxBsuE,EAAe/2B,QAAQ,0DAIQ,OAtB5B54C,KAsBE0S,WAAW5O,YAChB3G,EAAE,yCAA0CwyE,GAAgBnwE,UAE5DmwE,EAAe9pD,YAAY,oBAC3B1oB,EAAE,qCAAsCwyE,GAAgBnwE,UAKhEkwE,EAAansE,KAAKvC,GA/BPhB,KAkCNutE,yBASTD,oBAAqB,SAAUhZ,GAC3B,IACI5hD,EADO1S,KACW0S,WAElB1R,EAAQ0R,EAAWynC,aAAe,GAClCu1B,EAAevyE,EAAE,QAJV6C,KAIwB4tE,YAC/B+B,EALO3vE,KAKe0rE,aAGgB,GAAtC7+D,OAAOY,KAAKuF,aAAashD,IAAqB5hD,EAAWqyC,SACtB,OAT5B/kD,KASE0S,WAAW5O,YAChB6rE,EAAe/2B,QAAQ,8DAEvB+2B,EAAetuE,SAAS,oBACxBsuE,EAAe/tE,OAAO,0DAIS,OAjB5B5B,KAiBE0S,WAAW5O,YAChB3G,EAAE,yCAA0CwyE,GAAgBnwE,UAE5DmwE,EAAe9pD,YAAY,oBAC3B1oB,EAAE,qCAAsCwyE,GAAgBnwE,UAKhEkwE,EAAansE,KAAKvC,GA1BPhB,KA6BNutE,yBAKTzgB,eAAgB,SAAU79C,GACtB,IAAIlP,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlBgxC,GAFgB3jD,EAAK6D,MACd7D,EAAK2gC,mBACEhuB,WAAWpV,IAAM,IAWnC,OATA2R,EAAOA,MAGPlP,EAAKyB,eAGLzB,EAAKukE,kBAGEnnE,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAcwJ,gBACzCjsC,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrB8mD,YAAa1xC,EAAW0xC,YACxBN,aAAepxC,EAAWoxC,cAAgB70C,EAAK60C,aAC/CJ,OAAQA,KACRzzC,KAAK,SAAUpS,GAEfkC,EAAK0S,QAAU1S,EAAK6vE,cAAgB7vE,EAAKiB,MAAQ,KAGjD,IAAI6uE,EAAiB9vE,EAAKE,QAI1B,OAHAF,EAAKojE,eAAetlE,EAAK2gD,QAGlBrhD,EAAEqM,KAAKzJ,EAAKy+C,UAAUvuC,KAAK,SAAU1M,GACxC,IAAIwE,EAAS5K,EAAEoG,GAEAxD,EAAK+mE,kBAAkB/+D,GAEtC,OADAhI,EAAK2S,WAAWG,cAAgB9S,EAAK6D,MAC9BmE,IACRkI,KAAK,SAAUlI,GAEd8nE,EAAepsE,YAAYsE,GAGtBhI,EAAKzB,MACNyB,EAAKsoE,qBAAqBvL,SAAS,IAIvC/8D,EAAKwkE,qBAGVn0D,KAAK,SAAUsG,GACVA,EAAU3W,EAAK+kC,mBAAmBpuB,KAEvCyxD,OAAO,WACNpoE,EAAKgC,gBAOb+tE,qBAAsB,SAAUjyE,GAC5B,IAAIkC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGtB3S,EAAKukE,kBAGLvkE,EAAK0S,QAAU1S,EAAK6vE,cAAgB7vE,EAAKiB,MAAQ,KAEjD7D,EAAEsJ,OAAO5I,EAAK2gD,OAAO9rC,YACjBmO,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAepxC,EAAWoxC,cAAgB,OAC1CM,YAAa1xC,EAAW0xC,cAI5B,IAAIyrB,EAAiB9vE,EAAKE,QAI1B,OAHAF,EAAKojE,eAAetlE,EAAK2gD,QAGlBrhD,EAAEqM,KAAKzJ,EAAKy+C,UAAUvuC,KAAK,SAAU1M,GACxC,IAAIwE,EAAS5K,EAAEoG,GAEAxD,EAAK+mE,kBAAkB/+D,GAEtC,OADAhI,EAAK2S,WAAWG,cAAgB9S,EAAK6D,MAC9BmE,IACRkI,KAAK,SAAUlI,GAEd8nE,EAAepsE,YAAYsE,GAC3BhI,EAAKsoE,sBAGLtoE,EAAKukE,qBAObrC,UAAW,WACIjiE,KAEN+xC,SAAS,IAFH/xC,KAGN+vE,qBAMTA,kBAAmB,WACf,IACIt9D,EADOzS,KACQ0rE,aACfn9C,EAAQ9b,EAAQnP,KAAK,SAErBirB,EAAMrpB,OAAS,EACfqpB,EAAMnf,IALCpP,KAKQ2S,aACqB,IAN7B3S,KAMK0S,WAAWqyC,UACvB5nD,EAAEsV,GAASlP,KAAK,6CAOxBysE,oBAAqB,WACNhwE,KACN0S,WAAWG,cADL7S,KAC0B4D,OAKzCwjE,YAAa,SAAUF,GACnB,IACIx0D,EADO1S,KACW0S,WAGlBmO,EAAQnO,EAAWmO,MACnBjd,EALO5D,KAKM2S,WALN3S,KAOFwS,0BAEA3F,OAAOY,KAAKqT,QAAQD,KAChBhU,OAAOY,KAAKqT,QAAQld,GAEJ,KAAVA,GAA0B,OAAVA,IACvBsjE,EAAax0D,EAAWmO,OAAS,IAFjCqmD,EAAax0D,EAAWmO,OAASjd,IAXlC5D,KAmBDwtE,wBACNtG,EAAax0D,EAAWmO,OAAS,KAIzCwmD,WAAY,SAAUt/D,GAElB,QADW/H,KACFwS,0BACLzK,EAAOa,MAAK,IACL,IASfqjE,2BAA4B,WACxB,IAAIlsE,EAAOC,KACSD,EAAKE,QAAQqD,KAAK,sCACxBuqC,OAAO,WACjB9tC,EAAK2S,WAAWu2D,SAAW9rE,EAAE6C,MAAMoD,GAAG,eAM9CokE,qBAAsB,SAAUN,GAC5B,IACIx0D,EADO1S,KACW0S,WAClBmO,EAAQnO,EAAWmO,MACnBjd,EAHO5D,KAGM2S,WACbs9D,EAAa,KACjB,IAAKpjE,OAAOY,KAAKqT,QAAQD,GAAQ,CAC7B,GAAIjd,MAAAA,EAGIqsE,OAFiC,IAAdrsE,EAAQ,GAEZiJ,OAAOY,KAAKqT,QAAQld,EAAMtG,IAAiB,MAATsG,GAEzB,KAAVA,EAAgBA,EAAQ,KAG9C,IAAmB,OAAfqsE,GAAuBv9D,EAAWu2D,YAEN,SAAtBv2D,EAAWugC,SAA0C,GAApBvgC,EAAW9O,OAAiB,CAE/D,IAAIssE,EAlBLlwE,KAkBuB0S,WAAWy9D,YAlBlCnwE,KAkBqD0S,WAAW09D,YAAc,OAC7EF,EAAaA,EAAW/zD,cACxB,IAAIk0D,GACAzsE,MAASqsE,EACThH,SAtBLjpE,KAsBsB0S,WAAWu2D,SAC5BpoD,MAASnO,EAAWmO,MACpBqvD,WAAcA,EACdI,UAAa,aAEsB,IAA5B59D,EAAW69D,cAA4D,KAA5B79D,EAAW69D,eAE7DF,EAAaE,aAAe79D,EAAW69D,cAE3CrJ,EAAat+D,KAAKynE,MASlClJ,UAAW,WACP,IAAiBzuB,EACbhmC,EADO1S,KACW0S,WAClB89D,EAAc3jE,OAAOY,KAAKuF,aAAaN,EAAW89D,eAAgB,EAClEzrB,EAAWryC,EAAWqyC,SAG1B,IAAKyrB,GAAezrB,EAChB,OAAO,EAIX,GAAIryC,EAAW8yD,QACX,OAAO,EAGX,GAAI9yD,EAAWmO,OAEqC,GAjBzC7gB,KAgBS0gC,mBACPo1B,WAAWpjD,EAAWmO,OAAO3b,OAAa,CAG/C,GAFAwzC,IAAQv7C,EAAE2V,kBAAmB3V,EAAE2V,iBAAiBhC,WAChD3T,EAAE2V,iBAAmB4lC,OAAQxwC,EAAY/K,EAAE2V,iBAnBxC9S,KAoBMwS,wBAEL,OADArV,EAAE2V,iBAAmB4lC,EAAQ7rC,OAAOY,KAAKuF,aAAa0lC,GAASv7C,EAAE2V,kBAC1D,EAEX3V,EAAE2V,iBAAmB4lC,EAAQ7rC,OAAOY,KAAKuF,aAAa0lC,GAASv7C,EAAE2V,iBAIzE,OAAO,GAKXy0D,mBAAoB,WAIhB,OAHWvnE,KACW0S,WAEP8yD,SAQnBn+B,MAAO,SAAUrS,GACb,IAAIj1B,EAAOC,KAGX,GAAKD,EAAK2S,WAAW2iD,QAArB,CAGAr1D,KAAKsN,SACL,IAAIoV,EAASvlB,EAAE,yCAGXumE,EAAS,WACT,IAAIjxD,EAAU1S,EAAK2rE,aACf+E,EAA0C,QAAxB1wE,EAAK2S,WAAWzI,KAAkB9M,EAAE,kCAAmCsV,GAAWtV,EAAE,kCAAmCsV,GAASilC,QAClJ+4B,EAAevrE,OAAS,GAGxB/H,EAAE0D,KAAK4vE,EAAgB,SAAU3vE,GAC7B,IAAI4vE,EAAeD,EAAe3vE,GAClC,GAAoC,UAAhC3D,EAAEuzE,GAAcpvE,KAAK,SAAyD,QAAlCnE,EAAEuzE,GAAchsE,IAAI,YAA6D,UAArCvH,EAAEuzE,GAAchsE,IAAI,cAE5G,IACSmI,OAAOY,KAAK6P,QACbzQ,OAAOY,KAAKqY,iBAAiBpD,GAEjCguD,EAAarpC,QACf,MAAOp5B,QAQzB9Q,EAAEqM,KAAKzJ,EAAKqR,SACPjJ,KAAK,WAEE6sB,EAAO,EACPlzB,WAAW4hE,EAAQ1uC,GAEnB0uC,QAQhBiG,qBAAsB,SAAUD,GAC5B,MAAO,WAMXE,qBAAsB,SAAUF,GAC5B,MAAO,WAKXG,YAAa,SAAU8G,GAInB,OAAOA,GAMXtF,wBAAyB,WACrB,IAAItrE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmO,EAAQ,GAEZ,GAAKnO,EAAWqyC,SAAhB,CAGAryC,EAAW6pD,aAAe7pD,EAAW6pD,cAAgB,MAgBrD,IAAInxD,GACAynD,YACII,cAEQI,QACIxyC,MAjBZA,EAFJnO,EAAWmO,MACPnO,EAAWk+D,2BACHl+D,EAAWk+D,2BAA6B,IAAMl+D,EAAWmO,MAEzDnO,EAAWmO,MAGnBnO,EAAWk+D,2BACHl+D,EAAWk+D,2BAA6B,IAAMl+D,EAAWpV,GAEzDoV,EAAWpV,GAUP01D,SAAY,UACZmB,aAAgB,YAKhC+C,WAEQr2C,MAASA,EACTs2C,QAAW,eACX7C,SAAY5hD,EAAW6pD,eAG/BA,cAAiB17C,GACjB+6C,iBAIJz+D,EAAEqM,KAAKzJ,EAAKqR,SAASjJ,KAAK,WACXpI,EAAK2gC,mBACXmwC,gBAAgBhwD,EAAOzV,OAQpC02D,eAAgB,SAAUjkE,EAAMizE,EAAcC,GAC1C,IAAIhxE,EAAOC,KACPyjB,EAAQtmB,EAAE4S,WAed,MAZmC,IAA/BhQ,EAAK2S,WAAW0zC,aAAqBvoD,IACrCA,EAAKkC,EAAKgjE,YAAY1gB,MAAMK,4BAA8B,eAAiB3iD,EAAK2S,WAAW0zC,aAG/FjpD,EAAEqM,KAAKzJ,EAAKgkE,iBAAiB57D,KAAK,WAC9BpI,EAAKixE,uBAAuBnzE,EAAMizE,EAAcC,GAAY5oE,KAAK,WAC7Dsb,EAAMtT,YACPC,KAAK,WACJqT,EAAM6uC,aAIP7uC,EAAMlb,WAGjB0oE,eAAgB,WACZ,IACIprC,EADO7lC,KACO4gC,YAAYiF,OA4B9B,YA1BqB39B,IAAjB2E,OAAOqjD,OACPrjD,OAAOqjD,SACPrjD,OAAOqjD,MAAMghB,cACTrrC,YAAmB39B,IAAX29B,EAAuBA,OAAkC39B,IAAxB2E,OAAOqjD,MAAMrqB,OAAuBh5B,OAAOqjD,MAAMrqB,YAAS39B,SAGxFA,IAAX29B,QAAsD39B,IAA9B2E,OAAOqjD,MAAMghB,aACrCrkE,OAAOqjD,MAAMghB,aAAarrC,OAASA,OAEpB39B,IAAX29B,QAAsD39B,IAA9B2E,OAAOqjD,MAAMghB,eACrCrkE,OAAOqjD,MAAMghB,gBACbrkE,OAAOqjD,MAAMghB,aAAarrC,OAASA,GAOvCA,OAFO39B,IAAX29B,OACkC39B,IAA9B2E,OAAOqjD,MAAMghB,kBACJhpE,EAEA2E,OAAOqjD,MAAMghB,aAAarrC,OAG9BA,GAUjBmrC,uBAAwB,SAAUnzE,EAAMizE,EAAcC,GAClD,IACIvrB,EADOxlD,KACK0gC,mBACZhuB,EAFO1S,KAEW0S,WAClBzJ,GACApL,KAAMA,EACNizE,aAAcA,EACdC,WAAYA,EACZr+D,YACImzB,OARG7lC,KAQUixE,iBACb3zE,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClBujC,YAAa1xC,EAAW0xC,YACxBgC,YAAa1zC,EAAW0zC,cAIhC,OAAOZ,EAAKwrB,uBAAuB/nE,IAKvCmI,MAAO,WAEH,OAAOjU,EAAEqM,KADExJ,KACQo9B,OAAOhsB,QADfpR,KAC6B+lE,eAK5C/B,kBAAmB,WACf,IACIxe,EADOxlD,KACK0gC,mBAEhB,OAAI8kB,EACOA,EAAKwe,oBAET,MAKX6D,iBAAkB,SAAU9mE,GACxB,IACI+mE,EADO9nE,KACegkE,oBAE1B,OAAI8D,EACOA,EAAe/mE,GAEnB,MAKXgpE,qBAAsB,SAAUC,EAAYC,EAAYP,GAWpD,GANIM,EADc,OAAdC,QAA6C,IAAfD,EACjB,IAEAA,EAA4B,KAAdA,EAAoBA,EAAa,KAAQ,MAExEC,EAAaA,EAA4B,KAAdA,EAAoBA,EAAa,KAAQ,MAEjD,UAAfP,GAA0C,QAAfA,GAAwC,YAAfA,EAA2B,CAG/E,GAAIM,GAAcn9D,OAAOY,KAAKiU,eAAesoD,GAAc,GACvDC,GAAcp9D,OAAOY,KAAKiU,eAAeuoD,GAAc,EACvD,OAAQjpE,MAAO,EAAGyR,QAAS,KAG3Bu3D,IAAeC,EAEfA,EAAa,KADbD,EAAan9D,OAAOY,KAAKiU,eAAesoD,KAGhCA,GAAcC,EAEtBD,EAAa,KADbC,EAAap9D,OAAOY,KAAKiU,eAAeuoD,KAGxCD,EAAan9D,OAAOY,KAAKiU,eAAesoD,KACxCC,EAAap9D,OAAOY,KAAKiU,eAAeuoD,KAGP,UAAmC,IA9BjEjqE,KA8B4D,YAAkD,UA9B9GA,KA8BqF0S,WAAWw3D,aAC/FD,EAAa,IAAMD,QAI3BA,EAAa,IACbC,EAAa,IAGjB,OAAQjpE,MAAOgpE,EAAYv3D,QAASw3D,IAKxCkH,UAAW,WAEP,OADWnxE,KACC0gC,mBAAmBr1B,OAAOw6B,QAAUh5B,OAAO8B,QAAQk3B,QAKnEurC,cAAe,WAEX,OADWpxE,KACC0gC,mBAAmBr1B,OAAO64C,YAAcr3C,OAAO8B,QAAQu1C,YAKvEmtB,UAAW,WAEP,OADWrxE,KACC0gC,mBAAmBr1B,OAAO84C,QAAUt3C,OAAO8B,QAAQw1C,QAKnEmtB,aAAc,WAEV,OADWtxE,KACC0gC,mBAAmBhuB,WAAWm0C,WAS9CgZ,gBAAiB,SAAUnB,GACvB,IACIjsD,EADOzS,KACQ0rE,aACfj5D,IACa,QAATisD,GACAjsD,EAAQ/N,IAAI,QAASg6D,GACrBjsD,EAAQnP,KAAK,0BAA0BzC,KAAK,SAAUC,EAAGb,GACrD9C,EAAE8C,GAASyE,IAAI,QAASg6D,OAG5BjsD,EAAQ/N,IAAI,QAAS,IACrB+N,EAAQnP,KAAK,0BAA0BzC,KAAK,SAAUC,EAAGb,GACrD9C,EAAE8C,GAASyE,IAAI,QAAS,SAUxC+6D,0BAA2B,SAAUf,GACjC,IACIjsD,EADOzS,KACQ0rE,aACfzM,EAAkB,GAClBsS,EAAkB,GAEtB,GAAI9+D,EAMA,GALa,QAATisD,IACAO,EAAkBP,EAClB6S,EAAkB,QARfvxE,KAWE0S,WAAWqyC,SAAU,CAC1B,IAAIysB,GAAc,EAElB/+D,EAAQnP,KAAK,mCAAmCzC,KAAK,SAAUC,EAAGb,GAExC,QAAhBA,EAAQgK,MAAoC,YAAhBhK,EAAQgK,MAA0B9M,EAAE8C,GAASgyC,SAAS,oBACpFu/B,GAAc,GAElBr0E,EAAE8C,GAASyE,KACP+sE,mBAAoBxS,EACpByS,mBAAoBH,MAIvBC,GACD/+D,EAAQsgC,QAAQ,MAAMlyC,KAAK,SAAUC,EAAGb,GACpC9C,EAAE8C,GAASyE,KACP+sE,mBAAoBxS,EACpByS,mBAAoBH,WAMhC9+D,EAAQ5R,KAAK,SAAUC,EAAGb,IAEV9C,EAAE8C,GAASgyC,SAAS,2BAA8Bx/B,EAAQsgC,QAAQ,MAAQ51C,EAAE8C,IACnFyE,KACD+sE,mBAAoBxS,EACpByS,mBAAoBH,OAaxCvR,qBAAsB,SAAU1L,GAC5B,IACI5hD,EADO1S,KACW0S,WAClBD,EAFOzS,KAEQ0rE,aAEfj5D,IAE0C,GAAtC5F,OAAOY,KAAKuF,aAAashD,IAEzB7hD,EAAQ/N,IAAI,aAAc,WAC1B+N,EAAQ/N,IAAI,UAAW,IATpB1E,KAWEC,SAXFD,KAWkBC,QAAQoF,QAG7BoN,EAAQ/N,IAAI,aAAc,WAKlCgO,EAAW2iD,QAAUf,GAOzBoM,mBAAoB,SAAUpM,GAC1B,IACI5hD,EADO1S,KACW0S,WAClBD,EAFOzS,KAEQ0rE,aAEfj5D,IAE0C,GAAtC5F,OAAOY,KAAKuF,aAAashD,IAAqBznD,OAAOY,KAAKqT,QANvD9gB,KAMoE4D,QACvE6O,EAAQpR,SAAS,oBACjBoR,EAAQ7Q,OAAO,2DAEf6Q,EAAQoT,YAAY,oBACpB1oB,EAAE,qCAAsCsV,GAASjT,UAGrDkT,EAAWosD,SAAWxK,IAO9Bqd,qBAAsB,WACP3xE,KACNwB,eADMxB,KAEN4xE,wBAA0B,IAAIz0E,EAAE4S,UAMzC8hE,mBAAoB,WACL7xE,KACN+B,aADM/B,KAEF4xE,yBAFE5xE,KAE4B4xE,wBAAwBzhE,iBAFpDnQ,KAGC4xE,yBAOhBE,qBAAsB,WAElB,OADW9xE,KACD4xE,wBADC5xE,KAEC4xE,wBAAwBrpE,UADMpL,EAAEqM,MAAK,IAQrDuoE,iBAAkB,WAGd,GAFW/xE,KAEF1B,KAGL,IAFA,IAAIwC,EAHGd,KAGM1B,KAAKf,QAAQ2H,OAEnBpE,KAAM,GACT,GANGd,KAMM1B,KAAKf,QAAQuD,GAAG4R,WAAWmO,OANjC7gB,KAM+C0S,WAAWmO,OACpB,GAPtC7gB,KAOU1B,KAAKf,QAAQuD,GAAGmG,SACrB,OAAO,EAKvB,OAAO,GAMX+qE,iCAAkC,SAAU3mE,GACxC,IACIqH,EADO1S,KACW0S,WAClBu/D,EAAwB5mE,EAASA,EAAO+4C,YAAc1xC,EAAW0xC,YAF1DpkD,KAKN+iE,YAAYpU,qBAAqBvK,YAAa6tB,KAMvDC,aAAc,WACV,MAA0B,WAAnBlyE,KAAK6jE,WAMhBsO,gBAAiB,WACb,MAA0B,cAAnBnyE,KAAK6jE,WAIhBuO,2BAA4B,WACpBvlE,OAAOY,KAAK89B,uBACZpuC,EAAE,IAAK6C,KAAK0rE,cAAcjiD,MAAM,SAASozC,GACrCA,EAAGhpB,sBC7mEnB12C,EAAEklD,MAAM57C,OAAO,mCAOXmlE,cAAe,SAAUN,EAAex5C,GACpC,IAAIpf,EAAa1S,KAAK0S,WAEtB,GAA6B,kBAAlB44D,EAKX,GAAIA,EACAtrE,KAAKqyE,mBAAmBvgD,OACrB,CACH9xB,KAAKsyE,qBAAqBxgD,GAG1Bpf,EAAWosD,cAA4C,IAAzBpsD,EAAmB,UAAoB7F,OAAOY,KAAKuF,aAAaN,EAAWosD,UACzG,IAAIzJ,OAA0C,IAAxB3iD,EAAkB,SAAoB7F,OAAOY,KAAKuF,aAAaN,EAAW2iD,SAE5F3iD,EAAWosD,UACX9+D,KAAK2gE,eAAejuD,EAAWosD,UAG9BzJ,GACDr1D,KAAKkgE,iBAAiB7K,QAlB1B50C,QAAQ8xD,KAAK,gEA4BrBF,mBAAoB,SAAUvgD,GAC1B,IAAI0gD,EAASxyE,KAAK4tE,WACJ,MAAV4E,SAIuB,KAD3B1gD,EAASA,OACS66C,OACd76C,EAAO66C,MAAO,GAGlB3sE,KAAK0/D,sBAAsB5tC,EAAOsT,YAC7BqtC,gBAAgBD,EAAQ1gD,EAAO4sC,OAC/BkO,eAAe4F,EAAQ1gD,EAAO66C,MAC9BQ,eAAeqF,EAAQ1gD,EAAO2xC,MAC9BqJ,iBAAiB0F,EAAQ1gD,EAAO+6C,QAChC6F,qBAAqBF,GAAS1gD,EAAOi7C,UAAY,YAAc,KAAOj7C,EAAOm7C,WAAa,gBAAkB,OAQrHqF,qBAAsB,SAAUxgD,GAC5B,IAAI6gD,EAAW3yE,KAAK0rE,aAChBkH,EAAY5yE,KAAKquE,qBAAqBsE,GAG1C7gD,EAASA,MAET9xB,KAAKyyE,gBAAgBG,EAAW9gD,EAAO4sC,OAClCkO,eAAegG,EAAW9gD,EAAO66C,MACjCG,iBAAiB8F,EAAW9gD,EAAO+6C,QACnCM,eAAeyF,EAAW9gD,EAAO2xC,MACjCiP,qBAAqBE,GAAY9gD,EAAOi7C,UAAY,YAAc,KAAOj7C,EAAOm7C,WAAa,gBAAkB,MAQxHnN,YAAa,SAAUpB,GACnB,IAAI8T,EAASxyE,KAAK4tE,WACd+E,EAAW3yE,KAAK0rE,aAChBkH,EAAY5yE,KAAKquE,qBAAqBsE,GAE1C,OAAO3yE,KACFyyE,gBAAgBD,EAAQ9T,GACxB+T,gBAAgBG,EAAWlU,IASpC+T,gBAAiB,SAAU5gD,EAAU6sC,GACjC,QAAiBx2D,IAAb2pB,EAAwB,OAAO7xB,KACnC,QAAckI,IAAVw2D,EAAqB,OAAO1+D,KAEhC,IAAIoS,EAAkB,SAAVssD,EAAmBA,EAAQ,GAGvC,OAFA7sC,EAASntB,IAAI,QAAS0N,GAEfpS,MASXmtE,eAAgB,SAAUt7C,EAAU4xC,GAChC,QAAav7D,IAATu7D,EAAoB,OAAOzjE,KAC/B,QAAiBkI,IAAb2pB,EAAwB,OAAO7xB,KAEnC,GAAa,MAATyjE,EAAc,CACd,IAAIyL,EAAc,IAAqB,GAAfrlE,OAAO45D,GAAa,IAC5C5xC,EAASntB,IAAI,YAAawqE,GAG9B,OAAOlvE,MASX0yE,qBAAsB,SAAU7gD,EAAUghD,GACtC,YAAuB3qE,IAAnB2qE,EAAqC7yE,UACxBkI,IAAb2pB,EAA+B7xB,MAEnC6yE,GAAkBhhD,EAASntB,IAAI,kBAAmBmuE,GAE3C7yE,OASX8sE,iBAAkB,SAAUj7C,EAAUg7C,GAClC,IAAIz6D,EAAQvF,OAAOY,KAAKuF,aAAa65D,GAAU,SAAW,SAI1D,OAFAh7C,EAASntB,IAAI,aAAc0N,GAEpBpS,MASX4sE,eAAgB,SAAU4F,EAAQ7F,GAC9B,IAAIv6D,EAAQvF,OAAOY,KAAKuF,aAAa25D,GAAQ,OAAS,SAItD,OAFA6F,EAAO9tE,IAAI,cAAe0N,GAEnBpS,MAQX0/D,sBAAuB,SAAUhB,GAC7B,YAAqB,IAAVA,EAA8B1+D,MAE3B,SAAV0+D,EACA1+D,KAAKC,QAAQyE,IAAI,mBAAoBg6D,GAErC1+D,KAAKC,QAAQyE,IAAI,mBAAoB,IAGlC1E,OAOXstE,oBAAqB,aAOrB5M,mBAAoB,SAAUpM,GAC1Bt0D,KAAK2gE,eAAerM,IAMxBuV,YAAa,SAAU8G,GACnB,YAAoB,IAATA,GAAiC,IAATA,EACxB,UAEJA,GAMXhH,qBAAsB,WAClB,MAAO,WAMXC,qBAAsB,WAClB,MAAO,aC7Nf/8D,OAAO23D,UAAUhmB,OAAO/3C,OAAO,8BAC3BiiE,QAAS,WAEL,OADa1oE,KAAK0gC,mBAAmBE,YACvBoF,MAMlB7hC,WAAY,WACR0I,OAAO6T,IAAI,gCAAiC1gB,KAAM,UAMtD8yE,iBAAkB,WACd,IAAI/yE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBD,EAAU1S,EAAK2rE,aA8BnB,GA5BA3rE,EAAKgzE,oBAELhzE,EAAKizE,eAAiB71E,EAAE,+DAAgEsV,QAEjD,IAA3BC,EAAqB,iBAAmE,IAAtCA,EAAW6rD,WAAqB,YAC1Fx+D,EAAK2/D,sBAAsBhtD,EAAW6rD,WAAWn5B,iBAGd,IAA3B1yB,EAAqB,iBAA8D,IAAjCA,EAAW6rD,WAAgB,QACrFx+D,EAAK2rE,aAAatuC,SAAS14B,IAAI,QAASgO,EAAW6rD,WAAWG,OAC9D3+D,EAAKE,QAAQqD,KAAK,SAASoB,IAAI,QAASgO,EAAW6rD,WAAWG,OAGtC,UAApBhsD,EAAWzI,MACXlK,EAAKE,QAAQqD,KAAK,oCAAoCoB,IAAI,QAASgO,EAAW6rD,WAAWG,aAIzD,IAA5BhsD,EAAsB,kBAA+D,IAAlCA,EAAW02D,YAAiB,QACvFrpE,EAAKE,QAAQqD,KAAK,oCAAoCoB,IAAI,QAASgO,EAAW02D,YAAY1K,OAGlE,UAApBhsD,EAAWzI,MACXlK,EAAKE,QAAQqD,KAAK,SAASoB,IAAI,QAASgO,EAAW02D,YAAY1K,QAKnEvhE,EAAE4C,EAAKE,SAASgyC,SAAS,2BAA6B90C,EAAE4C,EAAKE,SAASgyC,SAAS,wBAA0B90C,EAAE4C,EAAKE,SAASgyC,SAAS,sBAClI,OAAO,EAGX,IAAIghC,EAAiBlzE,EAAKE,SAEG,UAAzBF,EAAK2S,WAAWzI,MAA6C,gBAAzBlK,EAAK2S,WAAWzI,MAMtB,KAD9BgpE,EAAiB91E,EAAE4C,EAAKE,SAASqD,KAAK,QACnB4B,SAQvB/H,EAAE81E,GAAgBjuE,KAAK,QAAS,WAC5B7H,EAAEqM,KAAKzJ,EAAKmzE,iBACPrvD,KAAK,WAEF9jB,EAAKgC,aACLhC,EAAKozE,iBAEAtmE,OAAOY,KAAKqT,QAAQ/gB,EAAK6D,SACtB7D,EAAK6D,MAEL7D,EAAKqzE,oBAAoBrzE,EAAK6D,aAUtDuvE,eAAgB,WAEZ,IAAIpzE,EAAOC,KACP2O,EAAU5O,EAAK2gC,mBAAmB7e,UAClCnP,EAAa3S,EAAK2S,WAClB2gE,EAAel2E,EAAE,QAAQwlB,YAE7B,GAAI5iB,EAAK6gC,aAAe7gC,EAAK6gC,YAAYuyC,eACrC,OAAOpzE,EAAK6gC,YAAYuyC,eAAepzE,GAG3C5C,EAAE,wBAAyBwR,GAASrL,KAAK,+BAA+B9D,SAEpErC,EAAE,qCAAsCwR,GAASxJ,OACjDhI,EAAE,wBAAyBwR,GAAS1M,QACpC9E,EAAE,wBAAyBwR,GAAStJ,OACpClI,EAAE,8BAA+BwR,GAASxJ,OAI9ChI,EAAE,wBAAyBwR,GAAS/M,OAAOzE,EAAEm2E,WAAWvzE,EAAK+iE,cAAcvT,YAAY,eACnFvuD,MAAS0R,EAAWynC,eAGxBh9C,EAAE,wBAAyBwR,GAASrL,KAAK,+BAA+BC,KAAKxD,EAAKwzE,cAElF,IAAIC,EAAazzE,EAAK0zE,YAAct2E,EAAEwR,GAASrL,KAAK,yBAChDowE,EAAmB,WACnBv2E,EAAE,qCAAsCwR,GAAStJ,OACjDlI,EAAE,wBAAyBwR,GAASxJ,OACpChI,EAAE,8BAA+BwR,GAAStJ,OAE1CvD,WAAW,WACPuc,OAAOs1D,SAAS,EAAGN,IACpB,KAGPl2E,EAAE,uDAAwDq2E,GAAYxuE,KAAK,QAAS,WAChF0uE,IACAv2E,EAAEqM,KAAKzJ,EAAK6zE,cACPzrE,KAAK,WACEpI,EAAK2S,WAAWovD,gBAChB/hE,EAAK+hE,qBAKrB3kE,EAAE,yDAA0Dq2E,GAAYxuE,KAAK,QAAS,WAClF0uE,OAOR9F,SAAU,WAEN,IADW5tE,KACDgB,MAAO,CACb,IAAIA,EAAQ7D,EAAE,mBAFP6C,KAEgCC,SAFhCD,KAEgDijE,mBAIvD,OAHIjiE,EAAMkE,OAAS,IAHZlF,KAIEgB,MAAQA,GAEVA,EAEX,OARWhB,KAQCgB,OAGhB6yE,mBAAoB,WAEhB,OAAO12E,EADI6C,KACGC,UAGlB6zE,kBAAmB,WAOf,OANW9zE,KAED+zE,QAFC/zE,KAGF+zE,MAAQ52E,EAAE,+DAHR6C,KAG6EC,SAH7ED,KAG6FijE,oBAH7FjjE,KAMC+zE,OAMhBpJ,cAAe,SAAUuD,GACrB,OAAOA,GAGX8F,SAAU,WAIN,OAHWh0E,KAEN+zE,MAAQ52E,EAAE,8EAFJ6C,KAEwFC,SAFxFD,KAEwGijE,mBAFxGjjE,KAGC+zE,OAMhBrI,WAAY,WAOR,OANW1rE,KAEDyS,SAAmC,IAFlCzS,KAEeyS,QAAQvN,SAFvBlF,KAGFyS,QAAUtV,EAAE,4BAHV6C,KAG4CC,SAH5CD,KAG4DijE,oBAH5DjjE,KAMCyS,SAOhBwhE,qBAAsB,WAOlB,OANWj0E,KAEDk0E,oBAFCl0E,KAGFk0E,kBAAoB/2E,EAAE,4BAHpB6C,KAGsDC,SAHtDD,KAGsEijE,oBAHtEjjE,KAMDk0E,mBAAuD,IANtDl0E,KAMyBk0E,kBAAkBhvE,OAN3ClF,KAUCk0E,kBAHD,MASfrG,iBAAkB,WAMd,OALW7tE,KACD4vE,gBADC5vE,KAEF4vE,cAAgBzyE,EAAE,4BAFhB6C,KAEkDC,SAFlDD,KAEkEijE,oBAFlEjjE,KAKC4vE,eAGhBuE,oBAAqB,WAMjB,OALWn0E,KACDo0E,mBADCp0E,KAEFo0E,iBAAmBj3E,EAAE,kBAFnB6C,KAE2CC,SAF3CD,KAE2DijE,oBAF3DjjE,KAKCo0E,kBAGhBC,eAAgB,WACZ,OAAOr0E,KAAKyzE,aAOhBzF,oBAAqB,SAAUsG,GAC3B,IACI5hE,EADO1S,KACW0S,WAClBg3D,EAAc4K,GAAY5hE,EAAWg3D,aAAe,SACpD5lE,EAAc4O,EAAW5O,aAAe,GACxC2O,EAJOzS,KAIQ0rE,aAEf6I,GAAmB,QAAS,cAAe,oBAAqB,YAAa,OAAQ,aAAc,aAAc,OAAQ,aAAc,OAAQ,aAAc,YAAa,aAAc,cAAe,QAAS,eAGhN1nE,OAAOY,KAAKq1B,uBACZyxC,EAAgB3rE,KAAK,eAAgB,eAGpCzL,EAbM6C,KAaCC,SAASgyC,SAAS,4BAA2E,IAA9CsiC,EAAgBrqE,QAAQwI,EAAWzI,OAC1F9M,EAdO6C,KAcAC,SAASoB,SAAS,0BAGV,SAAfqoE,IACIj3D,GACAA,EAAQpR,SAAS,uBAnBdrB,KAsBF4tE,WAAWzoE,QAIA,aAAhBukE,GAA8C,QAAhB5lE,IAE9B2O,EAAQpR,SAAS,uBACjBoR,EAAQnP,KAAK,SAASjC,SAAS,sBAE1BoR,EAAQpP,WAAW4uC,SAAS,uBAC7Bx/B,EAAQpP,WAAWhC,SAAS,sBAhCzBrB,KAmCF4tE,WAAWvsE,SAAS,sBAGV,SAAfqoE,GAA8C,gBAApBh3D,EAAWzI,OACrCwI,EAAQtN,OAvCDnF,KAwCF4tE,WAAWvoE,SAOxB4oE,iBAAkB,SAAUC,KAM5BC,iBAAkB,SAAUD,KAM5BE,qBAAsB,aAQtBtM,eAAgB,SAAUjkE,EAAMizE,GAC5B,IAAI/wE,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SAgBlB,OAdAlD,OAAOY,KAAKI,WAAWrM,eAEvBrE,EAAEqM,KAAKzJ,EAAKgkE,iBACP57D,KAAK,WACFhL,EAAEqM,KAAKzJ,EAAKixE,uBAAuBnzE,EAAMizE,IACpC3oE,KAAK,WACFsb,EAAMtT,YACPC,KAAK,WACJqT,EAAM6uC,WACP6V,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,kBAIhC2V,EAAMlb,WAMjB6wD,qBAAsB,SAAU1iD,GAC5B,IAKQzW,GALGD,KACNsN,OAAOoJ,GAERA,GAAWA,EAAQxR,OAAS,IAC5BwR,EAAUA,EAAQ/R,QAAQ,uBAAwB,MAJ3C3E,KAMFm0E,sBAAsB5wE,KAAKtD,EAAU9C,EAAE,oCAC5C8C,EAAQqB,KAAK,aAAcoV,IAPpB1W,KASFm0E,sBAAsB5wE,KAAK,KAOxCixE,aAAc,aAMdtB,cAAe,aAMfzH,mBAAoB,WAChB,IAAI1rE,EAAOC,KAGX7C,EAAEqM,KAAKzJ,EAAKy0E,gBACP3wD,KAAK,WAGF9jB,EAAKgC,aACLhC,EAAKiuE,sBAGLjuE,EAAK+yE,mBAGD/yE,EAAKkgE,mBACLlgE,EAAKkgE,kBAAkB9vD,UAItBtD,OAAOY,KAAKqT,QAAQ/gB,EAAK6D,SACtB7D,EAAK6D,MAEL7D,EAAKghE,gBAAgBhhE,EAAK6D,QAOlC7D,EAAK6rE,cAAcN,cAAevrE,EAAK2S,WAAW6rD,gBAClDx+D,EAAK6rE,eAAeN,cAAevrE,EAAK2S,WAAW02D,oBAO/DrI,gBAAiB,SAAUn9D,GACvB,IACI6O,EADOzS,KACQ0rE,aADR1rE,KAIN+xC,SAASnuC,GAAO,GAGrB,IAAI8pE,EAPO1tE,KAOa2tE,gBAAgB/pE,GAEX,iBAAlB,GACP6O,EAAQlP,KAAKmqE,IAIrB+G,eAAgB,WACZ,IACI/hE,EADO1S,KACW0S,WAClBD,EAFOzS,KAEQ0rE,aAEfh5D,EAAWqyC,UACXtyC,EAAQnP,KAAK,eAAehC,KAAK,cAAgBoR,EAAmB,SAAI,WAAa,aAK7F4tD,kBAAmB,SAAUhM,GACzB,IAEIogB,EADA3vB,EAAWl4C,OAAOY,KAAKuF,aAAashD,GAD7Bt0D,KAINsN,OAAOgnD,IAEZogB,EANW10E,KAMY4jE,uBAEnB8Q,EAAgBC,YAAY,sBAAuB5vB,GAAU4vB,YAAY,mBAAoB5vB,IAOrGquB,oBAAqB,SAAUxvE,KAG/BgwE,WAAY,WACG5zE,KACN+xC,SADM/xC,KACQuzE,aAAankE,OAAO,IAG3Ck+D,oBAAqB,WAEkB,SADxBttE,KACF0S,WAAWg3D,YADT1pE,KAMW0S,WAEPosD,WARJ9+D,KASGqtE,kBAINlwE,EAAE,qBAbC6C,KAa0B4tE,YAAYzoE,OAHzChI,EAAE,qBAVC6C,KAU0B4tE,YAAYvoE,QAVtCrF,KAEF40E,4BAoBbA,yBAA0B,WACX50E,KACW0S,WAEPosD,WAHJ9+D,KAKGqtE,kBAINlwE,EAAE,qBATC6C,KAS0B0rE,cAAcvmE,OAH3ChI,EAAE,qBANC6C,KAM0B0rE,cAAcrmE,SAOvDs7D,eAAgB,SAAUrM,GAEtB,GAAmC,SADxBt0D,KACF0S,WAAWg3D,YAApB,CAIA,IAAIgG,EAAevyE,EAAE,QALV6C,KAKwB4tE,YALxB5tE,KAON4tE,WAAWtqE,KAAK,mBAAmB9D,SACxC,IAAIkT,EARO1S,KAQW0S,WAGtBA,EAAWosD,SAAWxK,EAGlBznD,OAAOY,KAAKuF,aAAashD,IACzBob,EAAav9D,MAAMO,EAAWynC,aAAe,IAAM,KAf5Cn6C,KAiBGssE,WAGNoD,EAAamF,OAAO,4DAFpBnF,EAAamF,OAAO,sCAlBjB70E,KAuBFy0E,kBAEL/E,EAAav9D,KAAMO,EAAWynC,aAAe,IAzBtCn6C,KA6BNutE,6BA7BMvtE,KAEF80E,sBAAsBxgB,IA8BnCwgB,sBAAuB,SAAUxgB,GAC7B,IAEI7hD,EAFOzS,KAEQ0rE,aACnBj5D,EAAQnP,KAAK,mBAAmB9D,SAHrBQ,KAIW0S,WAGXosD,SAAWxK,EAGlBznD,OAAOY,KAAKuF,aAAashD,KAVlBt0D,KAWGssE,WAGN75D,EAAQmmC,QAAQ,4DAFhBnmC,EAAQmmC,QAAQ,sCAZb54C,KAiBFy0E,kBAjBEz0E,KAqBNutE,yBAGTwH,eAAgB,WACZ,OAAO/0E,KAAK0S,WAAWynC,aAG3B44B,kBAAmB,WACf,IACIrgE,EADO1S,KACW0S,WAEtB,GAAIA,GAAcA,EAAW2rC,UAAoC,KAAxB3rC,EAAW2rC,SAAiB,CACjE,IAAI22B,EAJGh1E,KAIkBi0E,uBAErBe,GACA73E,EAAE63E,GAAe32B,UAAWA,SAAU3rC,EAAW2rC,SAAUC,IAAK5rC,EAAW5O,gBAQvFtC,aAAc,aAMd6sE,qBAAsB,SAAU1/D,GAE5B,OADAA,EAAUxR,EAAE,uGAAwGA,EAAEwR,KAO1H5M,WAAY,aAGZ29D,sBAAuB,SAAUhB,GAEzBA,GAAmB,SAAVA,GADF1+D,KAEF0rE,aAAa34B,QAAQ,qBAAqBruC,IAAI,mBAAoBg6D,IAO/EqR,kBAAmB,WACf,IAEIxhD,EAFOvuB,KACQ0rE,aACCpoE,KAAK,SAASq1C,OAAO,SAAUx3C,EAAO8zE,GACtD,MAAoB,SAAbA,EAAIhrE,MAAgC,UAAbgrE,EAAIhrE,MAAiC,aAAbgrE,EAAIhrE,OAG1DskB,EAAMrpB,OAAS,EACfqpB,EAAMnf,IAPCpP,KAOQ2S,YAPR3S,KASF+gE,gBAAgB,OC9lBjC5jE,EAAEklD,MAAM57C,OAAO,4BAIX+Q,KAAM,SAAUnM,GACZ,IAAItL,EAAOC,KACPnC,EAAOwN,EAAOxN,KACdmmB,EAASnX,OAAOY,KAAKoG,eAGzB9T,EAAKm1E,eACLn1E,EAAKo1E,kBACLp1E,EAAKq1E,iBAGLr1E,EAAKqkD,YAAcvmD,EAAKw3E,YAGxBt1E,EAAKF,KAAOwL,EAAOxL,MAAQ,YAC3BE,EAAKsnC,MAAQh8B,EAAOg8B,MAGpBtnC,EAAKsL,OAASA,EAGdrL,KAAKsN,OAAOjC,GAGZ,IAAIqL,EAAU,GAGVA,EADW,YAAXsN,EACUhkB,KAAK+M,YAAY,yCAAyCpI,QAAQ,gBAAiB,MAEnF3E,KAAK+M,YAAY,yCAI/B,IAAI2F,EAAa3S,EAAK2S,WA8BtB,GA7BAA,EAAWm0C,UAAYhpD,EAAKgpD,UAC5Bn0C,EAAW4iE,kBAAoBzoE,OAAOY,KAAKuF,aAAanV,EAAKy3E,qBAAsB,EACnF5iE,EAAW6iE,wBAA0B7iE,EAAW6iE,yBAA2B7+D,EAC3EhE,EAAW5O,YAAc4O,EAAW5O,aAAe,MACnD4O,EAAW8iE,QAAU3oE,OAAOY,KAAKuF,aAAaN,EAAW8iE,WAAY,EACrE9iE,EAAW0zC,YAAc/6C,EAAO+6C,aAAe,GAC/C1zC,EAAW+iE,aAAepqE,EAAOoqE,iBACjC/iE,EAAWgjE,YAAcrqE,EAAOxN,KAAK63E,YAAcrqE,EAAOxN,KAAK63E,YAAY/5D,WAAW,MAAO,gBAAkB,GAC/GjJ,EAAWijE,WAAatqE,EAAOxN,KAAK63E,YAAcrqE,EAAOxN,KAAK63E,YAAYt0E,MAAM,UAGhFpB,KAAK03D,YAAc75D,EAAK65D,YACxB13D,KAAKX,QAAUxB,EAAKwB,QAGpBU,EAAK61E,2BAA6B/oE,OAAOwkB,WAA4D,IAAhDxkB,OAAOwkB,SAASwkD,4BAGrE91E,EAAK+1E,kBAAkBj4E,GAGnBA,EAAKwoD,cACLtmD,EAAKsmD,YAAcxoD,EAAKwoD,aAG5BrmD,KAAK+1E,sBAAwB/1E,KAAKg2E,cAGlCj2E,EAAKk2E,mBAAoB,EACrB5qE,EAAO6qE,kBACP,OAAQ7qE,EAAO6qE,mBACX,IAAK,gBACDn2E,EAAKk2E,mBAAoB,EAKrCl2E,EAAKo2E,0BAA6BtpE,OAAOY,KAAKyyB,kBAAoBrzB,OAAOY,KAAK0oE,6BAMlFL,kBAAmB,SAAUj4E,GACzB,IAAIkC,EAAOC,KAEXD,EAAKd,WAGDpB,EAAKoB,SACL9B,EAAE0D,KAAKhD,EAAKoB,QAAS,SAAU6B,EAAGmoC,GAC9B,IAAI58B,EAAS48B,EAAK58B,OAAOqG,WAGzBrG,EAAO+pE,QAAWvpE,OAAOY,KAAKqT,QAAQzU,EAAO+pE,UAAYr2E,EAAKgN,YAAYV,EAAO+pE,UAAY/pE,EAAO+pE,QAA6C/pE,EAAO+pE,QAA1Cr2E,EAAKgN,YAAYV,EAAO+pE,SAGlI/pE,EAAOhN,SACPlC,EAAE0D,KAAKwL,EAAOhN,QAAS,SAAUyB,EAAGsK,GAChCiB,EAAOjB,IAAU,IAKzBiB,EAAOgqE,QAAUv1E,EACjBuL,EAAOjB,OAASiB,EAAOwiC,KAAO,OAC1BxiC,EAAOiqE,uBAAyB,yBAC5BjqE,EAAO65C,WAAa,OAChB75C,EAAOge,OAAS,SACZhe,EAAOkqE,KAAO,OACVlqE,EAAOmqE,cAAgB,gBACnBnqE,EAAO2lC,SAAW,WAAa,GAGvD3lC,EAAOoqE,KAA0B,SAAlBpqE,EAAOjB,QAGlBiB,EAAOwiC,MAAQxiC,EAAOkqE,MAAQlqE,EAAOiqE,0BACrCjqE,EAAOqqE,SAAU,GAGjBrqE,EAAOmpE,UACPnpE,EAAO4gD,aAAc,GAGrBltD,EAAK61E,4BAA8BvpE,EAAO2lC,WAC1C3lC,EAAO65C,YAAa,EACpB75C,EAAOlK,SAAU,EACjBkK,EAAOoqE,MAAO,EACQ,SAAlBpqE,EAAOjB,QAAuC,kBAAlBiB,EAAOjB,SACnCiB,EAAOlK,SAAU,IAKzBkK,EAAO+F,MAAQrS,EAAK42E,iBAAiBtqE,GAGD,QAAhCtM,EAAK2S,WAAW5O,aAA0B/D,EAAK2S,WAAWkkE,iBAG1D72E,EAAKd,QAAQ2J,KAAKyD,GAFlBtM,EAAKd,QAAQ43E,QAAQxqE,MAYrCu0B,UAAW,WACP,OAAO5gC,KAAKqL,QAGhByrE,SAAU,SAAU51D,EAAUtd,GACtB5D,KAAKqL,SACLrL,KAAKqL,OAAO6V,GAAYtd,IAOhCigE,QAAS,WACL,OAAO7jE,KAAKH,MAKhBmkE,kBAAmB,WAEf,GADWhkE,KACFqL,OACL,OAFOrL,KAEKqL,OAAOy8D,gBAM3B1C,eAAgB,SAAU5mB,GACXx+C,KAENk1E,YAAY12B,EAAO9rC,WAAWpV,IAAMkhD,EACrCA,EAAO9rC,WAAWmO,QAHX7gB,KAIGm1E,eAAe32B,EAAO9rC,WAAWmO,SAJpC7gB,KAKEm1E,eAAe32B,EAAO9rC,WAAWmO,WALnC7gB,KAOFm1E,eAAe32B,EAAO9rC,WAAWmO,OAAOjY,KAAK41C,IAP3Cx+C,KAUDo1E,cAAc52B,EAAO9rC,WAAWzI,QAV/BjK,KAWFo1E,cAAc52B,EAAO9rC,WAAWzI,UAX9BjK,KAaNo1E,cAAc52B,EAAO9rC,WAAWzI,MAAMrB,KAAK41C,IAKpDgqB,iBAAkB,SAAUhqB,GACxB,IAAIz+C,EAAOC,KAMX,GAJID,EAAKm1E,YAAY12B,EAAO9rC,WAAWpV,YAC5ByC,EAAKm1E,YAAY12B,EAAO9rC,WAAWpV,IAG1CkhD,EAAO9rC,WAAWmO,MAClB,GAAI1jB,EAAE4iB,QAAQhgB,EAAKo1E,eAAe32B,EAAO9rC,WAAWmO,SAC7C9gB,EAAKo1E,eAAe32B,EAAO9rC,WAAWmO,OAAO3b,OAAS,EACzD,IAAK,IAAIpE,EAAI,EAAGiW,EAAIhX,EAAKo1E,eAAe32B,EAAO9rC,WAAWmO,OAAO3b,OAAQpE,EAAIiW,EAAGjW,IAAK,CAEjF,GADcf,EAAKo1E,eAAe32B,EAAO9rC,WAAWmO,OAAO/f,GAC/C4R,WAAWpV,KAAOkhD,EAAO9rC,WAAWpV,GAAI,CAChDyC,EAAKo1E,eAAe32B,EAAO9rC,WAAWmO,OAAOhH,OAAO/Y,EAAG,GACvD,mBAIDf,EAAKo1E,eAAe32B,EAAO9rC,WAAWmO,OAKrD,GAAI29B,EAAO9rC,WAAWzI,KAClB,CAAA,IAAI8sE,EAAmBh3E,EAAKi3E,gBAAgBx4B,EAAO9rC,WAAWzI,MAC1DgtE,EAAyBF,EAAiB7xE,OAC1CgyE,EAAY14B,EAAO9rC,WAAWpV,IAAMkhD,EAAO9rC,WAAWmO,MAE1D,IAAS/f,EAAI,EAAGA,EAAIm2E,EAAwBn2E,IAAK,CAC7C,IAAIq2E,EAAaJ,EAAiBj2E,GAClC,QAAwC,IAA5Bq2E,EAAWzkE,WAAWpV,IAAqB65E,EAAWzkE,WAAWpV,IAAM45E,QACxC,IAA/BC,EAAWzkE,WAAWmO,OAAwBs2D,EAAWzkE,WAAWmO,OAASq2D,EAAY,CAEjGn3E,EAAKq1E,cAAc52B,EAAO9rC,WAAWzI,MAAM4P,OAAO/Y,EAAG,GACrD,UAQhB2zD,cAAe,SAAUn3D,GAGrB,OAFW0C,KAECk1E,YAAY53E,IAG5B85E,gBAAiB,SAAU95E,GAKvB,IAJA,IACI+5E,EADOr3E,KACMg3E,gBAAgB,QAC7Bl2E,EAAI,EAEDA,EAAIu2E,EAAMnyE,OAAQpE,IAErB,IAAoB,GADNu2E,EAAMv2E,GAAGw2E,WAAWptE,QAAQ5M,GAEtC,OAAO+5E,EAAMv2E,GAIrB,OAAO,MAMXg1D,WAAY,SAAUj1C,GASlB,OALIA,GAASA,EAAM3W,SACX2W,EAAM3W,QAAQ,KAAO,IACrB2W,EAAQA,EAAMrC,UAAU,EAAGqC,EAAM3W,QAAQ,OALtClK,KAQCm1E,eAAet0D,GARhB7gB,KAQ8Bm1E,eAAet0D,OAK5Dm2D,gBAAiB,SAAU/sE,GAIvB,MAAmB,iBAARA,GAAoBA,EAAK/E,OAAS,GAHlClF,KAKMo1E,cAAcnrE,GALpBjK,KAKkCo1E,cAAcnrE,OAQ/D67D,gBAAiB,WACb,IAAI/lE,EAAOC,KACP0S,EAAa1S,KAAK0S,WAClBrU,EAAW0B,EAAK+iE,cAAcvT,YAAY,QAI1ChsD,EAAOpG,EAAE0E,SAASxD,GAClBY,QAASc,EAAKd,QACdonD,YAAatmD,EAAKsmD,YAClBqe,SAAUhyD,EAAWgyD,SACrB6S,SAAU7kE,EAAW2rC,SACrBx+C,KAAME,EAAK8jE,UACX2T,UAAiC,aAAtBz3E,EAAK+jE,cAChB7f,YAAalkD,EAAKsL,OAAO44C,cAAe,EACxCwzB,WAAY13E,EAAK2S,WAAW4iE,oBAAqB,EACjDzvC,OAZS,GAaTsU,YAAap6C,EAAKsL,OAAO8uC,aAbhB,GAcTu7B,YAAahjE,EAAWgjE,YACxBC,WAAYjjE,EAAWijE,WACvB7xE,YAAa4O,EAAW5O,cAK5B,OADAP,EAAOxD,EAAKmmE,oBAAoB3iE,EAAMxD,EAAKgnE,uBAM/ClB,oBAAqB,SAAUrgB,GAC3B,IACI3lD,EADOG,KACK6jE,UAGhBre,EAAKnkD,SAAS,4BAA8BxB,GAG5CG,KAAKsN,OAAOk4C,IAKhB4gB,kBAAmB,WACf,IACIsR,EADA33E,EAAOC,KAEPwlD,EAAOzlD,EAAK8hB,UAEZ2jC,EAAKtgD,OAAS,EACd/H,EAAEqoD,GAAM3kD,KAAK,WACL1D,EAAE6C,MAAMiyC,SAAS,wCACjBylC,EAA0B13E,QAIlC03E,EAA0Bv6E,EAAE,sCAAuCqoD,GAIvEzlD,EAAK43E,qBAGL53E,EAAK63E,eAAepyB,GAGpBzlD,EAAKiF,KAAK,gBAAiB,SAAUiJ,EAAG0pD,GAEpC53D,EAAKskE,qBAAuB,IAAIx3D,OAAOsqD,QAAQpxB,YAAY8xC,WAAW93E,EAAMA,EAAK23D,YAAaC,GAE9F53D,EAAKwoE,iBAAmB,IAAI17D,OAAOsqD,QAAQpxB,YAAY36B,OAAOrL,EAAMA,EAAKV,SAGzEU,EAAKyvE,cAAcr/D,YAIvBhT,EAAEu6E,GAAyBp0E,KAAK,gBAAgB0B,KAAK,QAAS,WAC1D,IAAI8yE,EAAgB36E,EAAE,QAAS6C,MAE3B+3E,EAAeD,EAAcj6E,KAAK,UAAY,QACC,IAAxCkC,EAAK43E,kBAAkBI,KAC9Bh4E,EAAK43E,kBAAkBI,IAAgB,GAGvClrE,OAAOY,KAAKuF,aAAa8kE,EAAcj6E,KAAK,aAE5Ci6E,EAAcjyD,YAAY,6BAC1BiyD,EAAcjyD,YAAY,YAAYxkB,SAAS,gBAC/Cy2E,EAAcj6E,KAAK,WAAW,GAC9BkC,EAAK43E,kBAAkBI,IAAgB,IAGvCD,EAAcz2E,SAAS,6BACvBy2E,EAAcz2E,SAAS,cAAcA,SAAS,YAAYwkB,YAAY,gBACtEiyD,EAAcj6E,KAAK,WAAW,GAC9BkC,EAAK43E,kBAAkBI,IAAgB,MAOnDzR,oBAAqB,WACjB,IAAIvmE,EAAOC,KAIXD,EAAKiF,KAAK,gBAAiB,WAEvBjF,EAAKyvE,cAAcr/D,aAM3BwmE,iBAAkB,SAAUtqE,GAExB,IAAI+F,KACJ,GAAI/F,EAAOylB,OAAQ,CACf,GAAIzlB,EAAOylB,OAAO2xC,MACY,KAAtBp3D,EAAOylB,OAAO2xC,KAAa,CAC3B,IAAIyL,EAAe,IAAmC,GAA7BrlE,OAAOwC,EAAOylB,OAAO2xC,MAAc,IAC5DrxD,EAAM,aAAe88D,EAAc,cAY3C,GATI7iE,EAAOylB,OAAO66C,OACdv6D,EAAM,eAAiB,kBACnBvF,OAAOY,KAAK6P,SACZlL,EAAM,eAAiB,2EAG3B/F,EAAOylB,OAAO+6C,SACdz6D,EAAM,cAAgB,qBAEtB/F,EAAOylB,OAAOi7C,WAAa1gE,EAAOylB,OAAOm7C,WAAY,CACrD,IAAIA,EAAapgE,OAAOY,KAAKuF,aAAa3G,EAAOylB,OAAOm7C,YAAc,gBAAkB,GACpFF,EAAYlgE,OAAOY,KAAKuF,aAAa3G,EAAOylB,OAAOi7C,WAAa,aAAe,GACnF36D,EAAM,mBAAqB66D,EAAaF,EAAY,cAEpD1gE,EAAOylB,OAAOsT,aACdhzB,EAAM,oBAAsB/F,EAAOylB,OAAOsT,WAAa,cACvDhzB,EAAM,oBAAsB,mBAE5B/F,EAAOylB,OAAO4sC,QACdtsD,EAAa,MAAI/F,EAAOylB,OAAO4sC,MAAQ,eAI/C,IAAIsZ,EAAW,GACf,IAAKj3E,OAAOqR,EACR4lE,GAAYj3E,IAAM,IAAMqR,EAAMrR,KAAO,IAEzC,OAAOi3E,GAMXx5B,OAAQ,WAUJ,OATWx+C,KAGDwvE,gBAHCxvE,KAIFwvE,cAAgB,IAAIryE,EAAE4S,UAGlB/P,KAAKsN,UAQtB8D,MAAO,WAGH,OAFWpR,KAECwvE,cAAcjnE,WAK9B86D,gBAAiB,WACb,OAAOrjE,KAAK0S,WAAWoxC,cAAgB,IAK3Cm0B,eAAgB,WACZ,OAAOj4E,KAAK0S,WAAW0zC,aAAe,IAM1C8xB,kBAAmB,WAIf,GAA2B,aAHhBl4E,KACW0S,WAEPylE,SACX,MAAO,iBASf7U,aAAc,WACV,OAAOtjE,KAAKokD,aAKhB1jB,iBAAkB,WACd,OAAO1gC,MAKX43E,eAAgB,WACZ,IAAI73E,EAAOC,KACPf,EAAUc,EAAKq4E,aAGdn5E,GAA6B,GAAlBA,EAAQiG,QAKxBjG,EAAQwN,GAAG,QAAS,SAAUwB,GAC1BA,EAAE4lC,iBACF5lC,EAAEoqE,2BAEFt4E,EAAKyB,eAEL,IAAI6K,EAASlP,EAAE6C,MACXq2E,EAAUhqE,EAAO/K,KAAK,WACtBg3E,EAAmBv4E,EAAKd,QAAQo3E,GAEpCt2E,EAAKw4E,iBAAmBD,EACQ,SAA5BA,EAAiBltE,SACjBktE,EAAiBE,gBAAkBz4E,EAAKk2E,mBAG5C5pE,EAAOi+B,KAAK,YAAY,GAErBj+B,EAAOkL,eAAe,aACrBlL,EAAOA,OAAO,WAIlBtM,EAAK04E,wBAAwBxqE,GAI7BnM,WAAW,WACP3E,EAAEqM,KAAKzJ,EAAKi2E,cAAcsC,IAAmBnQ,OAAO,WAChDpoE,EAAK24E,kBAAexwE,EACpBnI,EAAKgC,aACD5E,EAAEw7E,SAASxnE,SAAS0d,gBAAiBxiB,EAAOgG,IAAI,MAChDhG,EAAOi+B,KAAK,YAAY,GAErBj+B,EAAOkL,eAAe,WACrBlL,EAAOA,OAAO,cAI3B,QAMXusE,iBAAkB,SAAUN,GACxB,OAAO,GAKXO,kBAAmB,SAAUpmB,EAAW6lB,GACpC,OAAO,GAGXQ,kBAAmB,WACJ94E,KAEN+4E,eAAiB57E,EAAE4S,WAAWI,WAGvC6oE,qBAAsB,WAClB,IAAIj5E,EAAOC,KAEPD,EAAKk5E,uBACL97E,EAAEqM,KAAKzJ,EAAKg5E,eAAexwE,WAAWJ,KAAK,kBAChCpI,EAAKg5E,kBAKxBG,uBAAwB,WACTl5E,KAEDi5E,uBAFCj5E,KAGF84E,qBAIbK,iBAAkB,WAGd,OAFWn5E,KAEFi5E,sBAFEj5E,KAGK+4E,eAAexwE,eAE3B,GAIR0wE,oBAAqB,WAGjB,QAFWj5E,KAEF+4E,gBAObK,oBAAqB,SAAU/tE,GAC3B,IACI9C,EAAU8C,EAAO9C,QACjBmP,EAASrM,EAAOqM,SAAU,EAE9B,IAJW1X,KAIDi5E,sBAAuB,CAC7B,IAAIvhE,EAGA,OARG1X,KAME84E,oBANF94E,KAYN+4E,eAZM/4E,KAYgB+4E,eAAel1D,KAAK,WAC3C,OACWtb,KASnBytE,cAAe,SAAUsC,GACrB,IAAIv4E,EAAOC,KACPyjB,EAAQtmB,EAAE4S,WACV2C,EAAa3S,EAAK2S,WACjB4lE,EAAiB5B,SAClB7pE,OAAOq4C,OAAOC,aAAa,cAE/Bt4C,OAAOq4C,OAAO1tC,KAAK,WAGnBzX,EAAKskE,qBAAqBtL,0BAG1B,IAAIvT,EAAOzlD,EAAK2gC,mBACZ24C,EAAa7zB,EAAKwxB,gBAAgB,WAClCsC,EAAmBD,EAAWn0E,OAElCsgD,EAAK+zB,kBAAmB,EAGxBx5E,EAAKm5E,yBAGL,IAAK,IAAIp4E,EAAI,EAAGA,EAAIw4E,EAAkBx4E,IAAK,CACvC,IAAI09C,EAAS66B,EAAWv4E,GAEpB09C,EAAOr6B,iBAAmBq6B,EAAOphB,OAAOvb,WACxC28B,EAAOr6B,gBAAgBhU,UAoE/B,cAhEOq1C,EAAK+zB,iBAEZp8E,EAAEqM,KAAKzJ,EAAKqR,QAASrR,EAAKo5E,oBAAoBhxE,KAAK,WAC/CpI,EAAKi5E,wBAEOnsE,OAAOY,KAAKuF,aAAaslE,EAAiBtmC,WAAYjyC,EAAKskE,qBAAqBpL,uBAGnF,OAAQ,OAAQ,OAAQ,gBAAiB,0BAA0BlmD,SAASulE,EAAiBltE,SAC9FjO,EAAEgU,UAAUtT,KAAK,YAAa,IAI9BgP,OAAOY,KAAKuF,aAAajT,EAAK2S,WAAW8mE,wBAA0B3sE,OAAOY,KAAKuF,aAAaslE,EAAiB5B,UAC7G32E,EAAKgC,aACL5E,EAAEqM,KAAKqD,OAAO4sE,oBAAoB/mE,EAAW6iE,wBAAyB,MAAM,IAAQptE,KAAK,WAEjFpI,EAAK64E,iBAAiBN,KAEtBv4E,EAAKi4D,qBAAqB,qBAAsBsgB,GAChDn7E,EAAEqM,KAAKzJ,EAAK+nB,WAAWwwD,IAAmBnwE,KAAK,WAC3Csb,EAAMtT,YACPC,KAAK,WACJqT,EAAM6uC,OAAOjkD,gBAGtB+B,KAAK,WACJqT,EAAM6uC,YAINvyD,EAAK64E,iBAAiBN,KAEtBv4E,EAAKi4D,qBAAqB,qBAAsBsgB,GAChDn7E,EAAEqM,KAAKzJ,EAAK+nB,WAAWwwD,IAAmBnwE,KAAK,WAC3ChL,EAAEgU,UAAUlM,QAAQ,aAAcqzE,GAClC70D,EAAMtT,YACPC,KAAK,WACJqT,EAAM6uC,OAAOjkD,gBAOzBtO,EAAKgC,aACDu2E,EAAiBpyB,WACjB/oD,EAAEqM,KAAKzJ,EAAKmmD,cAAc/9C,KAAK,WAC3Bsb,EAAM6uC,WAIV7uC,EAAM6uC,SAGVvyD,EAAKskE,qBAAqB9K,yBAG9B,IAAImgB,EAAgB35E,EAAK8nE,iBAAiB,wBACtC6R,GACAA,EAAcpB,KAIf70D,EAAMlb,WAKjBoxE,aAAc,WAOV,OANW35E,KAGNqkE,qBAAqBtL,0BAHf/4D,KAMCqkE,qBAAqBpL,sBAKrC2gB,SAAU,WACN,IAAI75E,EAAOC,KAGPm+B,EAAgBtxB,OAAOY,KAAK0wB,eAAgBxvB,QAAS5O,IAGrDlC,EAAOkC,EAAK85E,+BAGZC,EAAkB,KAOtB,OANIj8E,EAAKk8E,YACLD,EAAkB38E,EAAEqM,KAAK4E,MAAMjR,EAAGU,EAAKk8E,kBAChCl8E,EAAKk8E,WAIT58E,EAAEqM,KAAKswE,GAAiB7pE,KAAK,WAIhC,OAHAlQ,EAAKyB,eAGErE,EAAEqM,KAAKzJ,EAAKgjE,YAAY7c,YAC3B96C,OAAQ,OACRvN,KAAMA,EACNgoC,OAAQ9lC,EAAKsL,OAAOw6B,OACpBqe,WAAYnkD,EAAKsL,OAAO64C,WACxBJ,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAarkD,EAAK2S,WAAW0xC,YAC7BjmB,cAAeA,IAAiB,KAChCgqC,OAAO,WACPpoE,EAAKgC,kBAOjB+lB,WAAY,SAAUwwD,GAClB,IAAIv4E,EAAOC,KACPyjB,EAAQtmB,EAAE4S,WAGVouB,EAAgBtxB,OAAOY,KAAK0wB,eAAgBxvB,QAAS5O,IAmBzD,OAjBA5C,EAAEqM,KAAKzJ,EAAKgkE,iBACP57D,KAAK,WACEg2B,EACAp+B,EAAKi6E,0BAA0B1B,GAGnCn7E,EAAEqM,KAAKzJ,EAAKk6E,mBAAmB3B,IAAmBnwE,KAAK,WACnDsb,EAAMtT,YACPC,KAAK,WACJqT,EAAM6uC,OAAOjkD,eAGlB+B,KAAK,WACRrQ,EAAKgC,aACL8K,OAAO6T,IAAI,gDACX+C,EAAM6uC,WAEH7uC,EAAMlb,WAEjB2xE,iBAAkB,aAGlBC,wBAAyB,WACrB,OAAO,GAOXC,oBAAqB,WAEjB,OADWp6E,KACCu4E,kBAQhByB,0BAA2B,SAAU1B,GACjC,IAEIz6E,EAFAkC,EAAOC,KACP0W,EAAU,GAIVynB,EAAgBtxB,OAAOY,KAAK0wB,eAAgBxvB,QAAS5O,IAYzD,GAVIo+B,GAAkBp+B,EAAK2S,aAAe3S,EAAK2S,WAAW0xC,cACtDrkD,EAAK2S,WAAW0xC,YAAc,KAI9Bk0B,EAAiBpyB,YAAcoyB,EAAiBrrB,eAEhDpvD,EAAOkC,EAAK85E,gCAGZ95E,EAAKsmD,YAAa,CAClB,IAAIA,KAKJ,GAJAlpD,EAAE0D,KAAKb,KAAK23E,kBAAmB,SAAU52E,EAAK6C,GAC1C,GAAUyiD,EAAYz9C,KAAK7H,KAGY,GAAvC8L,OAAOY,KAAK6U,WAAW+jC,GAMvB,OALAx5C,OAAOwtE,eACHxtE,OAAOC,aAAaC,YAAY,qCAChCF,OAAOC,aAAaC,YAAY,sCAAuC,QAAQ,GAEnFhN,EAAKgC,aACE,GAIf5E,EAAEqM,KAAKzJ,EAAKgjE,YAAY7c,YACpB96C,OAAQktE,EAAiBltE,OACzBvN,KAAMA,EACNimD,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAarkD,EAAK2S,WAAW0xC,YAC7BV,OAAQ3jD,EAAK2S,WAAWpV,GACxB2nD,SAAS,EACToB,YAAaA,GAAe,GAC5BxgB,OAAQ9lC,EAAKsL,OAAOw6B,OACpBqe,WAAYnkD,EAAKsL,OAAO64C,WACxB/lB,cAAeA,IAAiB,EAChCm8C,YAAav6E,EAAKsL,OAAOivE,aAAe,MACxCnyE,KAAK,SAAUsqD,GAEf,GAAK1yD,EAAK84E,kBAAkBpmB,EAAW6lB,GAIvC,GAAIA,EAAiB5B,QAAS,CAC1B,IAAI6D,GAAwB,EAC5B,GAAGp8C,GAAiBp+B,EAAKo2E,2BAA6Bp2E,EAAKsL,OAAOmvE,OAAQ,CACtED,GAAwB,EACxB,IAAIE,EAAyB,IAAIt9E,EAAE4S,SACnChQ,EAAKsL,OAAOqvE,gBAAkBD,EAC9Bt9E,EAAEgU,UAAUlM,QAAQ,sBAAuBlF,EAAKsL,aAE3C8yB,IAAkBp+B,EAAKo2E,2BAC5Bh5E,EAAEgU,UAAUlM,QAAQ,uBAGpBs1E,EAQAp9E,EAAEqM,KAAKixE,GACN52D,KAAM,SAAS9b,GACZhI,EAAK+5D,eAAe,WAChBj0B,OAAQ99B,EAAO4yE,OACfC,WAAY7yE,EAAO8yE,eAG1BzqE,KAAM,SAASurB,GACZ57B,EAAK+6E,YAAYn/C,KAfrB57B,EAAK+5D,eAAe,WAChBihB,cAAezC,EAAiBltE,OAChCy6B,OAAQ9lC,EAAKsL,OAAOw6B,OACpBqe,WAAYnkD,EAAKsL,OAAO64C,kBAiBhCxtC,EAAU7J,OAAOY,KAAK+oB,gBAAgB,6CAChC3pB,OAAOC,aAAaC,YAAY,6CAChC,QAENF,OAAOY,KAAKowB,kBAAmB1rB,KAAMuE,EAASzM,KAAM,cAGzDmG,KAAK,SAAUurB,GACdjlB,EAAU7J,OAAOY,KAAK+oB,gBAAgB,6CAChC3pB,OAAOC,aAAaC,YAAY,6CAChC,YAENF,OAAOY,KAAKowB,kBAAmB1rB,KAAMuE,EAASzM,KAAM,aAO5DgwE,mBAAoB,SAAU3B,GAC1B,IAEIz6E,EAFAkC,EAAOC,KACPyjB,EAAQtmB,EAAE4S,YAIVuoE,EAAiBpyB,YAAcoyB,EAAiBrrB,aAAeqrB,EAAiB9B,iBAEhF34E,EAAOkC,EAAK85E,gCAIhB18E,EAAEqM,KAAKzJ,EAAKyB,gBAAgB2G,KAAK,WAC7BhL,EAAE,cAAc69E,SAAUr4D,UAAWxlB,EAAE,4BAA8B,UAGzE,IAAI89E,EAAmB,KACnBC,EAAsB,KACtBC,EAAgB,KAChBC,EAAmB,KACnBC,EAAe,KACfC,KACAxB,EAAkB,KAmCtB,GAhCIxB,EAAiBrrB,cAEbpvD,EAAKk8E,YACLD,EAAkB38E,EAAEqM,KAAK4E,MAAMjR,EAAGU,EAAKk8E,WACvCuB,EAAiB1yE,KAAKkxE,UACfj8E,EAAKk8E,YAGhBkB,EAAmBl7E,EAAKgjE,YAAY7c,YAChC96C,OAAQ,aACRvN,KAAMA,EACNimD,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAarkD,EAAK2S,WAAW0xC,YAC7Ba,SAAS,KAEIkN,IAAM,aAEvBipB,EAAmBr7E,EAAKw7E,wBAAwBjD,EAAiBh7E,IAGjEO,MACAq9E,EAAsBn7E,EAAKgjE,YAAY9W,eACnCpI,SAAUy0B,EAAiBh7E,GAC3BwmD,aAAc/jD,EAAK2S,WAAWoxC,cAAgB,GAC9CM,YAAarkD,EAAK2S,WAAW0xC,YAC7Ba,SAAS,KAEOkN,IAAM,cAE1BkpB,EAAet7E,EAAKy7E,oBAAoBlD,EAAiBh7E,KAGzDg7E,EAAiBzpC,MAAQypC,EAAiB/B,MAAQ+B,EAAiB7B,MAAQ6B,EAAiB9B,eAAiB8B,EAAiBhC,uBAAwB,CAEtJ,GAAIv2E,EAAKsmD,YAAa,CAClB,IAAIA,KAKJ,GAJAlpD,EAAE0D,KAAKb,KAAK23E,kBAAmB,SAAU52E,EAAK6C,GAC1C,GAAUyiD,EAAYz9C,KAAK7H,KAGY,GAAvC8L,OAAOY,KAAK6U,WAAW+jC,GAKvB,OAJAx5C,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,qCAAsCF,OACvFC,aAAaC,YAAY,sCAAuC,QAAQ,GAC7EhN,EAAKgC,aACL0hB,EAAM6uC,SACC7uC,EAAMlb,UAIjB1K,EAAKk8E,YACLD,EAAkB38E,EAAEqM,KAAK4E,MAAMjR,EAAGU,EAAKk8E,WACvCuB,EAAiB1yE,KAAKkxE,UACfj8E,EAAKk8E,YAIhBoB,EAAgBp7E,EAAKgjE,YAAY7c,YAC7B96C,OAAQrL,EAAK07E,gBAAgBnD,EAAiBltE,QAC9Cm7C,oBAAqB+xB,EAAiB/xB,oBACtC1oD,KAAMA,EACNimD,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAarkD,EAAK2S,WAAW0xC,YAC7Ba,SAAS,EACToB,YAAaA,GAAe,GAC5BD,YAAarmD,EAAK2S,WAAW2xC,YAC7BiC,aAAcvmD,EAAK2S,WAAWkxC,gBAEpBuO,IAAM,gBAIxB,IAAI9yD,KAEA67E,IACA77E,EAAQuJ,KAAKqyE,GACb57E,EAAQuJ,KAAKwyE,GACb/7E,EAAQuJ,KAAKsyE,GACb77E,EAAQuJ,KAAKyyE,IAGbF,GACA97E,EAAQuJ,KAAKuyE,GAIjBtuE,OAAOq4C,OAAOC,aAAa,mBAI3B,IAAIu2B,EAAsB,IAAIv+E,EAAE4S,SA8FhC,OA7FIlS,GAAQA,EAAKk8E,UACb58E,EAAEqM,KAAK4E,MAAMpO,KAAMnC,EAAKk8E,WACnB5xE,KAAK,SAAUm9C,GACZo2B,EAAoBvrE,QAAQm1C,KAE/Bl1C,KAAK,WACFsrE,EAAoBppB,SACpB7xC,QAAQC,IAAI,+DAGpBg7D,EAAoBvrE,UAGxBmrE,EAAiB1yE,KAAK8yE,GAEtBv+E,EAAEqM,KAAK4E,MAAMjR,EAAGm+E,GAAkBnzE,KAAK,WACnChL,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAczzC,SAAUxQ,QAASA,KAAY8I,KAAK,SAAUsqD,GAKhF,IAAIkpB,EAJJ9uE,OAAOq4C,OAAOlnB,KAAK,mBAEnBj+B,EAAKgC,aAGL,IAAI65E,EAAe,GASnB,GARAz+E,EAAE0D,KAAK4xD,EAAW,SAAU3xD,EAAGwkD,GAE3B,IAAIu2B,EAA8B97E,EAAK+7E,4BAA4BH,EAAiBr2B,EAASv9C,OAAOkC,KAAMq7C,EAASv9C,OAAOg0E,SAAUH,GACpID,EAAkBE,EAA4BF,gBAC9CC,EAAeC,EAA4BD,eAI1CD,EAgCmB,KAAjBC,GACC/uE,OAAOmvE,WAAW32E,KAAKu2E,EAAc,uCAAuC,GAE5EtD,EAAiBrrB,aACjBltD,EAAKk8E,mBAAmB3D,EAAiBh7E,QApC3B,CAElB,IAAKyC,EAAK84E,kBAAkBpmB,EAAW6lB,GACnC,OAIAA,EAAiBn2E,SACjBpC,EAAKm8E,cAIL5D,EAAiB5B,UACjB7pE,OAAOsvE,UAAUC,SAAS,aAAer8E,EAAKgjE,YAAYr3B,MAC1D3rC,EAAK+5D,eAAe,WAChBj0B,OAAQ9lC,EAAKsL,OAAOw6B,OACpB2yC,gBAAiBF,EAAiBE,mBAKtCF,EAAiB9B,eACb/jB,EAAUvtD,OAAS,IACnB2H,OAAOsvE,UAAUC,SAAS,aAAer8E,EAAKgjE,YAAYr3B,MAC1D3rC,EAAK+5D,eAAe,WAChBj0B,OAAQ4sB,EAAU,GAAG1qD,OAAO4yE,OAC5BC,WAAYnoB,EAAU,GAAG1qD,OAAO8yE,cAchDp3D,EAAMtT,YACPC,KAAK,SAAUksD,EAAGA,EAAGhX,GAChBgzB,EAAiBrrB,aACjBltD,EAAKk8E,mBAAmB3D,EAAiBh7E,IAGzCgoD,GAAYA,EAAS3pB,QAAuC,mCAA7B2pB,EAAS3pB,MAAMyoC,WACjB,8BAA7B9e,EAAS3pB,MAAMyoC,WAA0E,2BAA7B9e,EAAS3pB,MAAMyoC,YAC3ErkE,EAAKgC,aACL5E,EAAEqM,KAAKqD,OAAO4sE,oBAAoB5sE,OAAOC,aAAaC,YAAYu4C,EAAS3pB,MAAMjlB,SAAU,MAAM,IAAQmN,KAAK,WAC1G,OAAO1mB,EAAEqM,KAAKzJ,EAAKk6E,mBAAmB98E,EAAEsJ,UAAW6xE,GAAoB/xB,qBAAqB,QAC7Fp+C,KAAK,WACJsb,EAAMtT,YACPC,KAAK,WACJqT,EAAM6uC,aAGVvyD,EAAK+6E,YAAYx1B,GACjB7hC,EAAM6uC,OAAOhN,QAIlB7hC,EAAMlb,WAEjBuzE,4BAA6B,SAASH,EAAiBU,EAAa3lE,EAASklE,GAmBzE,MAhBmB,sBAAfS,IAFOr8E,KAIFs8E,qBAAqB5lE,GAC1BilE,GAAkB,GAEM,WAAzB9uE,OAAOgH,gBAA8C,iBAAfwoE,IAGjCT,EADgB,KAAjBA,EACgBllE,EAEAklE,EAAe,OAASllE,EAG3CilE,GAAkB,IAGdA,gBAAmBA,EAAiBC,aAAgBA,IAMhEU,qBAAsB,SAAUxO,EAAmBzmC,EAAOzX,EAAMipC,EAAqBW,EAAWvvD,GAC5F,IAAIlK,EAAOC,KAEND,EAAKskE,uBACNtkE,EAAKskE,qBAAuB,IAAIx3D,OAAOsqD,QAAQpxB,YAAY8xC,WAAW93E,IAGxC,iBAAvB,EACPA,EAAKskE,qBAAqB3L,sBAAsBoV,EAAmBzmC,EAAOzX,EAAMipC,EAAqB5uD,GAErG9M,EAAE0D,KAAKitE,EAAmB,SAAUhtE,EAAG4V,GACnC3W,EAAKskE,qBAAqB3L,sBAAsBhiD,EAAS2wB,EAAOzX,EAAMipC,EAAqB5uD,KAGnGlK,EAAKskE,qBAAqB9K,sBAAsBC,IAKpDT,wBAAyB,SAAU1tD,GACpBrL,KAGFqkE,sBAHErkE,KAIFqkE,qBAAqBtL,wBAAwB1tD,IAO1DkxE,gBAAiB,SAAUz1C,GACZ9mC,KAENqkE,qBAAqB7L,iBAAiB1xB,GAFhC9mC,KAGNqkE,qBAAqB9K,yBAK9B2iB,YAAa,SAAU70C,GACnB,IAAItnC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBxC,EAAW/S,EAAE4S,YAEjBs3B,EAAQA,GAAStnC,EAAK6nE,cAGRvgC,EAAM/pC,KAChB+pC,GACI/pC,GAAI+pC,IAIZ,IAAIhqC,GACAwoC,OAAQ9lC,EAAKsL,OAAOw6B,QAAU,GAC9Bqe,WAAYnkD,EAAKsL,OAAO64C,YAAc,GACtCC,OAAQpkD,EAAKsL,OAAO84C,QAAU,GAC9B9c,MAAOA,EACPm1C,aAAcz8E,EAAK08E,kBACnB34B,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBG,WAAW,EACXF,YAAatkD,EAAKk4E,kBAAoB,GACtC7sE,OAAQrL,EAAKm4E,oBACbxzB,aAAc3kD,EAAK2S,WAAWgyC,cAAgB,IAYlD,OARA3kD,EAAKyB,eACLrE,EAAEqM,KAAKzJ,EAAK+5D,eAAe,UAAWz8D,IAAU8K,KAAK,WACjDpI,EAAKgC,aACLmO,EAASC,YACVC,KAAK,WACJrQ,EAAKgC,aACLmO,EAASoiD,WAENpiD,EAAS3H,WAKpBk0E,gBAAiB,WAOb,IANA,IACIC,EADO18E,KACcslE,kBAAkB,OACvCqX,EAAOx/E,EAAE2N,IAAI4xE,EAAe,SAAUE,GACtC,OAASC,IAAKD,EAAalqE,WAAWpV,GAAIoxD,SAAUkuB,EAAahgC,aAEjE4/B,KACK17E,EAAI,EAAGoE,EAASy3E,EAAKz3E,OAAQpE,EAAIoE,EAAQpE,IAC9C07E,EAAaG,EAAK77E,GAAG+7E,KAAOF,EAAK77E,GAAG4tD,SAExC,OAAO8tB,GAKXpE,WAAY,aAKZvH,gBAAiB,SAAUhwD,EAAOzV,GACnBpL,KACNuoE,iBAAiBjN,4BAA4Bz6C,EAAOzV,IAO7D5J,aAAc,WACV,IAAIzB,EAAOC,KACP88E,EAAkB/8E,EAAK+iE,cAAcvT,YAAY,gBAErD,IAAIxvD,EAAKg9E,iBAAkBh9E,EAAKi9E,eAIhC,GAAKnwE,OAAOY,KAAK0yB,iBAoCbpgC,EAAKg9E,eAAiB5/E,EAAE,qCAAqC+G,SAAS,OAAQ/G,EAAEgU,WAChFpR,EAAKi9E,eAAiB7/E,EAAE8/E,KAAKH,GAAiB54E,SAAS,OAAQ/G,EAAEgU,eArClC,CAE/B,IAAI+rE,EAAuC,eAAxBn9E,EAAKsL,OAAOsD,QAC3BwuB,EAASp9B,EAAKsL,OAAO8xB,OACrB+/C,IACA//C,EAAStwB,OAAOY,KAAKkV,UAAUwa,IAEjBxuB,UAIdwuB,EAAShgC,EAAE,OAAQA,EAAEgU,YAIzB,IAAIsyD,EAAOzjE,KAAKm9E,UACZh4C,EAAWnlC,KAAKo9E,YAChB3Z,EAAK3gD,QAAU3lB,EAAEkhB,QAAQyE,WACzBqiB,EAAStiB,IAAM,GAEnB9iB,EAAKg9E,eAAiB5/E,EAAE,qCAAqC+G,SAASi5B,GACtEp9B,EAAKi9E,eAAiB7/E,EAAE8/E,KAAKH,GAAiB54E,SAASi5B,GACvDp9B,EAAKg9E,eAAer4E,KAChBoe,OAAU,OACV9F,MAAS,OACTqgE,aAAc5Z,EAAK3gD,OACnBw6D,YAAa7Z,EAAKzmD,QAEtBjd,EAAKi9E,eAAet4E,KAChBme,IAAQsiB,EAAStiB,IAAMzb,KAAKiR,MAAMorD,EAAK3gD,OAAS/iB,EAAKi9E,eAAetpE,eAAiB,GAAM,KAC3F6T,KAASngB,KAAKiR,MAAMorD,EAAKzmD,MAAQjd,EAAKi9E,eAAe7qC,cAAgB,GAAM,OAE/EhV,EAAOz4B,IAAI,WAAY,cAW/B3C,WAAY,WAER,GADW/B,KACF+8E,gBADE/8E,KACqBg9E,eAAgB,CADrCh9E,KAEF+8E,eAAev9E,SAFbQ,KAGFg9E,eAAex9E,SAHbQ,KAIF+8E,eAAiB,KAJf/8E,KAKFg9E,eAAiB,KAEtB,IAAI7/C,EAPGn9B,KAOWqL,OAAO8xB,OAEXj1B,MAAVi1B,GACAA,EAAOz4B,IAAI,WAAY,MAMnC64E,kBAAmB,WAEf,OADWv9E,KACCqnC,OAKhBm2C,kBAAmB,SAAUn2C,GACdrnC,KACNqnC,MAAQA,GAKjB2wB,qBAAsB,SAAU2L,EAAW9lE,GACvC,OAAOmC,KAAK85D,eAAe,iBAAmB6J,UAAWA,EAAW9lE,KAAMA,KAK9Ei9E,YAAa,SAAUn/C,GAInB,IACIA,EAAQhf,KAAKhE,MAAMgjB,GACrB,MAAO1tB,IAST,GALI0tB,EAAQA,EAAMz2B,QAAUy2B,EAAMz2B,OAAS,IAAGy2B,EAAQA,EAAM,IACxDA,EAAMA,QAAOA,EAAQA,EAAMA,OAC3BA,EAAMA,QAAOA,EAAQA,EAAMA,OAGX,iBAATA,GAAqBA,EAAMjlB,QAE9BilB,EADoB,mCAApBA,EAAMyoC,WAAsE,8BAApBzoC,EAAMyoC,WAAiE,2BAApBzoC,EAAMyoC,UACzGv3D,OAAOC,aAAaC,YAAY4uB,EAAMjlB,SAGtCilB,EAAMjlB,aAGf,GAAoB,iBAATilB,EAEd,IACI,IAAI8hD,EAAY9gE,KAAKhE,MAAMgjB,GACC,mCAAxB8hD,EAAUrZ,WAA0E,8BAAxBqZ,EAAUrZ,WAAiE,2BAApBzoC,EAAMyoC,YACzHqZ,EAAU/mE,QAAU7J,OAAOC,aAAaC,YAAY0wE,EAAU/mE,UAElEilB,EAAQ8hD,EAAU/mE,QACpB,MAAOzI,IA9BFjO,KAmCNu8E,gBAAgB5gD,GAnCV37B,KAoCN+B,cAKTyhE,OAAQ,SAAUC,GAEdzjE,KAAK09E,QAAQja,IAKjBia,QAAS,SAAUja,GACfzjE,KAAKyjE,KAAOA,GAKhB0Z,QAAS,WACL,GAAIn9E,KAAKyjE,KACL,OAAOzjE,KAAKyjE,KAEhB,IAAItmC,EAAUn9B,KAAKqL,OAAa,OAAIrL,KAAKqL,OAAO8xB,OAASn9B,KAAK0gC,mBAAmB7e,UAKjF,OACI7E,MAJcmgB,EAAOngB,QAKrB8F,OAJeqa,EAAOra,WAO9Bs6D,UAAW,WAGP,OAFap9E,KAAK0gC,mBAAmB7e,UAEvBrd,UAMlB0hD,WAAY,SAAUj3C,GAClB,IAAIlP,EAAOC,KAGPnC,EAAOkC,EAAK85E,+BAkBhB,GAfoBhtE,OAAOY,KAAK0wB,eAAgBxvB,QAAS5O,KAEnCA,EAAK2S,aAAe3S,EAAK2S,WAAW0xC,cACtDrkD,EAAK2S,WAAW0xC,YAAc,IAIlCjnD,EAAE0D,KAAKhD,EAAM,SAAUkD,EAAK6C,GACxB,IAAIiyD,EAAU91D,EAAK+1D,WAAW/0D,GAC9B5D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACzBA,EAAOwxB,2BAKX7yE,EAAE4jB,cAAcljB,GAKpB,OAAOV,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAc4C,YACzC96C,OAAQ,aACRvN,KAAMA,EACNumD,YAAarkD,EAAK2S,WAAW0xC,YAC7BN,aAAc/jD,EAAK2S,WAAWoxC,aAC9BsC,YAAarmD,EAAK2S,WAAW0zC,aAAe,MAC5Ch2C,KAAK,SAAUsG,GACfA,EAAU3W,EAAK+kC,mBAAmBpuB,MAM1Cu2C,YAAa,SAAUh+C,GACnB,IAAIlP,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBoxC,EAAe70C,EAAK60C,aASxB,MAP+B,IAA3BpxC,EAAWoxC,eAEXA,EAAgC,IAAhBA,EAAsBpxC,EAAWoxC,aAAe,IAAMA,EAAepxC,EAAWoxC,cAK7F3mD,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAc2J,aACzC7I,YAAa1xC,EAAW0xC,YACxBxyC,KAAM3C,EAAK2C,KACXkyC,aAAcA,EACdsC,YAAarmD,EAAK2S,WAAW0zC,aAAe,MAC5Cj+C,KAAK,SAAUuO,GAEf3W,EAAK2gC,mBAAmBq4B,yBAA0B4kB,iBAAiB,IAC/DjnE,GAA2B,sBAAhBA,EAAQzM,MACnBlK,EAAK2gC,mBAAmB47C,qBAAqBluE,MAAMrO,GAAO2W,EAAQqlE,cAAU7zE,OAAWA,OAAWA,GAAW,EAAO,kBAE5F,WAAzB2E,OAAOgH,gBAA+C,iBAAhB6C,EAAQzM,MAC7C4C,OAAOmvE,WAAW32E,KAAKqR,EAAQqlE,SAASrjE,KAAK,QAAS,uCAAuC,KAElGtI,KAAK,SAAUsG,GACdA,EAAU3W,EAAK+kC,mBAAmBpuB,MAM1Cw2C,iBAAkB,SAAUj+C,GACxB,IAAIlP,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBoxC,EAAe70C,EAAK60C,aAQxB,MAN+B,IAA3BpxC,EAAWoxC,eAEXA,EAAgC,IAAhBA,EAAsBpxC,EAAWoxC,aAAe,IAAMA,EAAepxC,EAAWoxC,cAI7F3mD,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAc4J,kBACzC9I,YAAa1xC,EAAW0xC,YACxB+I,UAAWl+C,EAAKk+C,UAChBrJ,aAAcA,EACdsC,YAAarmD,EAAK2S,WAAW0zC,aAAe,MAC5Cj+C,KAAK,SAAUuO,GAEf3W,EAAK2gC,mBAAmBq4B,0BACpBriD,GAA2B,sBAAhBA,EAAQzM,MACnBlK,EAAK2gC,mBAAmB47C,qBAAqB5lE,EAAQqlE,YAG1D3rE,KAAK,SAAUsG,GACdA,EAAU3W,EAAK+kC,mBAAmBpuB,MAG1C02C,oBAAqB,SAAUn+C,GAC3B,IAAIlP,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBoxC,EAAe70C,EAAK60C,aAQxB,MAN+B,IAA3BpxC,EAAWoxC,eAEXA,EAAgC,IAAhBA,EAAsBpxC,EAAWoxC,aAAe,IAAMA,EAAepxC,EAAWoxC,cAI7F3mD,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAc8J,qBACzChJ,YAAa1xC,EAAW0xC,YACxBiJ,QAASp+C,EAAKo+C,QACdvJ,aAAcA,EACdsC,YAAarmD,EAAK2S,WAAW0zC,aAAe,MAC5Cj+C,KAAK,SAAUuO,GAEf3W,EAAK2gC,mBAAmBq4B,0BACpBriD,GAA2B,sBAAhBA,EAAQzM,MACnBlK,EAAK2gC,mBAAmB47C,qBAAqB5lE,EAAQqlE,YAG1D3rE,KAAK,SAAUsG,GACdA,EAAU3W,EAAK+kC,mBAAmBpuB,MAK1C42C,iBAAkB,SAAUr+C,GACxB,IAAIlP,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBoxC,EAAe70C,EAAK60C,aASxB,MAP+B,IAA3BpxC,EAAWoxC,eAEXA,EAAgC,IAAhBA,EAAsBpxC,EAAWoxC,aAAe,IAAMA,EAAepxC,EAChFoxC,cAIF3mD,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAcgK,kBACzClJ,YAAa1xC,EAAW0xC,YACxBmJ,cAAet+C,EAAKs+C,cACpBzJ,aAAcA,EACdsC,YAAarmD,EAAK2S,WAAW0zC,aAAe,MAC5Cj+C,KAAK,SAAUuO,GAEf3W,EAAK2gC,mBAAmBq4B,0BACpBriD,GAA2B,sBAAhBA,EAAQzM,MACnBlK,EAAK2gC,mBAAmB47C,qBAAqB5lE,EAAQqlE,YAG1D3rE,KAAK,SAAUsG,GACdA,EAAU3W,EAAK+kC,mBAAmBpuB,MAQ1C0lD,eAAgB,SAAU/8D,GACXW,KACNuoE,iBAAiBnM,eAAe/8D,IAKzC2oE,cAAe,WACAhoE,KACNuoE,iBAAiBrM,iBAK1B2d,6BAA8B,SAAUh8E,GACpC,IAAIkC,EAAOC,KAcX,OAbAnC,EAAOA,MAGPkC,EAAKknE,oBAAoBppE,GAGzBV,EAAE0D,KAAKhD,EAAM,SAAUkD,EAAK6C,GACxB,IAAIiyD,EAAU91D,EAAK+1D,WAAW/0D,GAC9B5D,EAAE0D,KAAKg1D,EAAS,SAAU/0D,EAAG09C,GACzBA,EAAOwxB,0BAIRnyE,GAQXmzE,uBAAwB,SAAU3lE,GAE9B,IAAItL,EAAOC,KACP0S,GAFJrH,EAASA,OAEeqH,WAEpB+Q,EAAQ,IAAItmB,EAAE4S,SACdlS,EAAOwN,EAAOxN,SACdizE,OAA+C,IAAxBzlE,EAAmB,cAAmBA,EAAOylE,cACvDzlE,EAAO0lE,WAAa1lE,EAAO0lE,gBAAa7oE,KAGpC/K,EAAE4jB,cAAcljB,IACjCkC,EAAK85E,6BAA6Bh8E,GAEtCkC,EAAKyB,eAIL,IAAIs4E,EAAkB,KAkEtB,OAjEIj8E,EAAKk8E,YACLD,EAAkB38E,EAAEqM,KAAK4E,MAAMjR,EAAGU,EAAKk8E,kBAChCl8E,EAAKk8E,WAGhB58E,EAAEqM,KAAKswE,GAAiBj2D,KAAK,WAEzB9jB,EAAKgjE,YAAY7c,YACb96C,OAAQ,iBACRvN,KAAMA,EACNgmD,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAa1xC,EAAW0xC,YACxBgC,YAAa1zC,EAAW0zC,cACzBj+C,KAAK,SAAUm9C,GAOd,GALAvlD,EAAK69E,wBAEL79E,EAAKgC,aAGDujD,GAA6B,sBAAjBA,EAASr7C,KACsB,mBAAhClK,EAAKg5D,yBACZh5D,EAAKg5D,0BAGTh5D,EAAKu8E,qBAAqBh3B,EAASy2B,UACnCt4D,EAAMtT,eACH,GAAI2gE,EAAc,CACrB,IAAI+M,GACAvgF,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,YAEI3Y,IAAtBwK,EAAWmzB,QACX1oC,EAAEsJ,OAAOo3E,GACL3M,aAAcrkE,OAAOqjD,MAAMghB,eAG/B5rB,EAASw4B,UACT/9E,EAAK2S,WAAWgyC,aAAeY,EAASw4B,SAE5C3gF,EAAEqM,KAAKzJ,EAAKm8E,YAAY2B,IAAkB11E,KAAK,WAC3Csb,EAAMtT,YACPC,KAAK,WACJqT,EAAMtT,iBAGVsT,EAAMtT,YAEXC,KAAK,SAAUsG,GACd3W,EAAKgC,aACL,IAAIg8E,EAAaphE,KAAKhE,MAAyB,iBAAXjC,GAAuBA,EAAQwlB,aAAgBxlB,EAAQwlB,qBACvF8hD,EAAaD,EAAWrnE,SAAWA,EAEvC3W,EAAKskE,qBAAqBtL,0BACH,SAAnBglB,EAAW9zE,KACXlK,EAAKskE,qBAAqB1L,iBAAiBqlB,GAE3Cj+E,EAAKskE,qBAAqB7L,iBAAiBwlB,GAE/Cv6D,EAAMtT,cAIPsT,EAAMlb,WAGjBq1E,sBAAuB,WACnB,GAAI/wE,OAAOg7C,uBAAyBh7C,OAAOg7C,sBAAsB3iD,OAG7D,IAFA,IACW+4E,EADP/4E,EAAS2H,OAAOg7C,sBAAsB3iD,OACtCpE,EAAI,EACDA,EAAIoE,EAAQpE,KACfm9E,EAAapxE,OAAOg7C,sBAAsBzJ,QACxB6/B,EAAWC,QACzBrxE,OAAO4rD,sBAAuB,EAC9BwlB,EAAWC,UAM3B3C,wBAAyB,SAAU4C,GAC/B,IAEI/C,EAFOp7E,KAEiB+iE,YAAYtW,gBACpC/oC,IAHO1jB,KAGG0S,WAAW0rE,cACrBv6B,SAAUs6B,EACVt9D,MAAO,GACPijC,aANO9jD,KAMY0S,WAAWoxC,aAC9BM,YAPOpkD,KAOW0S,WAAW0xC,YAC7Ba,SAAS,IAKb,OAFAm2B,EAAiBjpB,IAAM,aAEhBipB,GAGXI,oBAAqB,SAAU2C,GAC3B,IAEI9C,EAFOr7E,KAEa+iE,YAAYxW,gBAChC7oC,IAHO1jB,KAGG0S,WAAW2rE,UACrBx6B,SAAUs6B,EACVt9D,MAAO,GACPijC,aANO9jD,KAMY0S,WAAWoxC,aAC9BM,YAPOpkD,KAOW0S,WAAW0xC,YAC7Ba,SAAS,IAKb,OAFAo2B,EAAalpB,IAAM,SAEZkpB,GAGXY,mBAAoB,SAAUkC,GACfn+E,KAEN+iE,YAAYzW,kBACb5oC,IAHO1jB,KAGG0S,WAAW4rE,YACrBz6B,SAAUs6B,EACVt9D,MAAO,GACPijC,aANO9jD,KAMY0S,WAAWoxC,aAC9BM,YAPOpkD,KAOW0S,WAAW0xC,eAIrChmB,QAAS,WACL,IAAIr+B,EAAOC,KACXD,EAAKgC,aAELD,WAAW,WACH/B,EAAKsL,eACEtL,EAAKsL,OAAO8xB,cAEhBp9B,EAAKsL,cACLtL,EAAK0S,QACR1S,EAAKskE,uBACLtkE,EAAKonB,OAAO,yBACLpnB,EAAKskE,sBAGZtkE,EAAKwoE,mBACLxoE,EAAKwoE,iBAAiBrM,uBACfn8D,EAAKwoE,mBAEjB17D,OAAOwkB,SAAS6yC,aAAe,IAGlCnkE,EAAKuN,UAETsyD,UAAW,SAAUl0B,GACjB,OAAOvuC,EAAE,8BAAgCuuC,EAAO,KAAM1rC,KAAK6hB,YAG/D08D,kBAAmB,SAAU7yC,GACzB,OAAOvuC,EAAE,eAAiBuuC,EAAO,KAAM1rC,KAAK6hB,YAGhD42D,wBAAyB,SAAUh+B,GAEXt9C,EAAE,sBAElBA,EAAEgU,UAAUlM,QAAQ,kBAGP9H,EAAE,uBAAmE,SAA1CA,EAAE,sBAAsBuH,IAAI,YAGpEvH,EAAE,2BAA2BssB,SAGrCgyD,gBAAiB,SAAUrwE,GACvB,OAAOpL,KAAK41E,4BAAyC,aAAXxqE,EAAwB,OAASA,KCzzDnFjO,EAAEklD,MAAM57C,OAAO,iCAKX+Q,KAAM,SAAUnM,GACZrL,KAAKsN,OAAOjC,GACTA,EAAOoqE,cAAgBpqE,EAAOoqE,aAAa+I,eAC1Cz+E,KAAKy+E,aAAenzE,EAAOoqE,aAAa+I,eAUnDC,gBAAiB,SAASpgF,EAAUwpB,GAChC,IAIC62D,EAAoBrgF,EAASsG,QAHb,4GAGoC,IAcxD,OALG+5E,GANHA,EAAoBA,EAAkB/5E,QAPhB,6CAOsC,SAASmZ,EAAO6gE,EAAIC,EAAIp6E,EAAQsY,GACxF,IAAI7T,EAAa0T,KAAKhE,MAAMimE,GAE/B,OAAO/2D,EAAS5e,EAAW3L,KAAO,MAGMqH,QAAQ,mBAAoB,WAC9D,MAAO,MAWfmhE,gBAAiB,WAChB,IAAI/lE,EAAOC,KACP6+E,EAAmB9+E,EAAKi3E,gBAAgB,UACxCt0D,EAAUm8D,EAAiB35E,OAAS,EAAK25E,EAAiB,MAC1DxgF,EAAyC,mBAAtBqkB,EAAO6sC,YAA6B7sC,EAAO6sC,cAAgB,GAC9E7qD,EAA+B,mBAAjBge,EAAOo8D,OAAwBp8D,EAAOo8D,SAAW,GAC/Dj/E,EAAOE,EAAK8jE,UACZ10C,EAAapvB,EAAK2S,WAAWqsE,YAAc33E,KAAKskC,OAEhD7jB,KAyBJ,OApBGnF,EAAOrf,UACTlG,EAAE0D,KAAK6hB,EAAOrf,SAAU,SAASvC,EAAGiwD,GAEhC,GAAc,aAARlxD,GAAgD,qBAAzBkxD,EAAMr+C,WAAWzI,KAA8B,CAExE,IAAIA,EAAO8mD,EAAMwS,iBACbt5D,GAAQ4C,OAAO23D,UAAUvkE,QAAQ2iE,sBACjC/6C,EAASkpC,EAAMr+C,WAAWpV,IAAMyzD,EAAMiW,iBAEtC/8D,GAAQ4C,OAAO23D,UAAUvkE,QAAQ0iE,yBACjC96C,EAASkpC,EAAMr+C,WAAWpV,IAAMyzD,EAAM6U,uBAE1C7lE,EAAK4kE,aAAa5T,EAAMr+C,WAAWgyD,UAAY3T,KAMxDlkD,OAAOY,KAAKwhB,UAAUvqB,EAAKyqB,GAEpBpvB,EAAK0+E,gBAAgBpgF,EAAUwpB,IAOpCm3D,gBAAiB,WACb,OAAOj/E,KAAKy+E,gBC3FpBrhF,EAAEklD,MAAM57C,OAAO,8BAMd8oD,YAAa,WACT,IACI1vD,EADOG,KACK6jE,UACZtgE,EAFOvD,KAEK0S,WAAWnP,MAAQ,GAOtC,MAJe,UAAR1D,GAAoB0D,IACjBA,EAAO,mCAAqCA,EAAO,UAGtDsJ,OAAOY,KAAKmyB,aAAar8B,IAOjCu7E,OAAQ,WACJ,IACCp6E,EADU1E,KACC0S,WAAWhO,KAAO,GAOjC,MAJY,UAJE1E,KAGE6jE,YAEZn/D,EAAMA,GAAOA,EAAI0+C,SAGdv2C,OAAOY,KAAKmyB,aAAal7B,IAQjCmhE,oBAAqB,SAAShkD,GAC7B,IACIhiB,EADOG,KACK6jE,UADL7jE,KAIHigE,mBAJGjgE,KAKLigE,kBAAkB9vD,UALbnQ,KAQN6hB,UAAYA,EARN7hB,KASNmmE,0BAA0BtkD,GAEpB,aAARhiB,GAXQG,KAaLomE,oBAEK,UAARvmE,GAfQG,KAiBLsmE,sBAEK,UAARzmE,IAnBQG,KAqBLsmE,sBArBKtmE,KAsBLumE,0BCxDRppE,EAAEklD,MAAM57C,OAAO,iCAKX08D,eAAgB,SAAU93D,GAItBrL,KAAKsN,OAAOjC,GAGZlO,EAAE0D,KANSb,KAMCqD,SAAU,SAAUvC,EAAGiwD,GAC/BA,EAAMr+C,WAAW2jE,QAAUv1E,KAQnCglE,gBAAiB,WACb,IACIpzD,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,aAG1ChsD,EAAOpG,EAAE0E,SAASxD,GAClBqmE,SAAUhyD,EAAWgyD,WAKzB,OADAnhE,EAVWvD,KAUCkmE,oBAAoB3iE,EAVrBvD,KAUgC+mE,yBChCnD5pE,EAAEklD,MAAM57C,OAAO,qCAKXq/D,gBAAiB,WACb,IACIpzD,EAAa1S,KAAK0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,iBAG1ChsD,EAAOpG,EAAE0E,SAASxD,GAClBf,GAAIoV,EAAWpV,GACf+4E,QAAS3jE,EAAW2jE,QACpBl8B,YAAaznC,EAAWynC,YACxBr2C,YAAa4O,EAAW5O,YACxB4gE,SAAUhyD,EAAWgyD,WAKzB,OADAnhE,EAdWvD,KAcCkmE,oBAAoB3iE,EAdrBvD,KAcgC+mE,uBAO/CjqB,SAAU,WACK98C,KACN8I,QAAS,GAMlB8+D,SAAU,WACN,IACIvgC,EADOrnC,KACMsN,SAKjB,OAJIT,OAAOY,KAAKqT,QAAQumB,IAFbrnC,KAE4B8I,SACnCu+B,EAHOrnC,KAGM0S,WAAWpV,IAGrB+pC,KC1CflqC,EAAEklD,MAAM57C,OAAO,2CAEX08D,eAAgB,SAAU93D,GACtB,IAAItL,EAAOC,KAEXD,EAAKuN,OAAOjC,GAEZ,IAAIqH,EAAa3S,EAAK2S,WACtBA,EAAWgzC,cAA0C,IAAvBhzC,EAAWgzC,UAA2B74C,OAAOY,KAAKuF,aAAaN,EAAWgzC,UACxGhzC,EAAWusE,YAAcvsE,EAAWusE,aAAevsE,EAAWgzC,SAC9DhzC,EAAWkzC,eAA4C,IAAxBlzC,EAAWkzC,WAA4B/4C,OAAOY,KAAKuF,aAAaN,EAAWkzC,WAC1GlzC,EAAWwsE,aAAexsE,EAAWwsE,cAAgBxsE,EAAWkzC,UAChElzC,EAAWysE,iBAAgD,IAA1BzsE,EAAWysE,aAA8BtyE,OAAOY,KAAKuF,aAAaN,EAAWysE,aAC9GzsE,EAAW25D,eAA4C,IAAxB35D,EAAW25D,WAA4Bx/D,OAAOY,KAAKuF,aAAaN,EAAW25D,WAC1G35D,EAAW25D,UAAY35D,EAAW25D,WAAa35D,EAAWgzC,SAC1DhzC,EAAWuyD,gBAA8C,IAAzBvyD,EAAWuyD,YAA6Bp4D,OAAOY,KAAKuF,aAAaN,EAAWuyD,YAC5GvyD,EAAWuyD,WAAavyD,EAAWuyD,YAAcvyD,EAAWkzC,UAC5DlzC,EAAWizC,iBAAgD,IAA1BjzC,EAAWizC,aAA8B94C,OAAOY,KAAKuF,aAAaN,EAAWizC,aAE9G5lD,EAAK+D,YAAc/D,EAAK2S,WAAW5O,aAAe,MAClD/D,EAAKlC,KAAOkC,EAAK2S,WAAW7U,KAC5BkC,EAAKq/E,KAAOr/E,EAAKlC,KAAOkC,EAAKs/E,QAAQt/E,EAAKlC,KAAKwE,SAC/CtC,EAAK8tB,QAAU,EACf9tB,EAAKK,UAAY,EACjBL,EAAKu/E,oBAEDv/E,EAAKlC,OACLkC,EAAKK,UAAYL,EAAKlC,KAAKwE,KAAK6C,SAMxCm6E,QAAS,SAAUh9E,GAIf,IAFA,IAAI+8E,KAEKt+E,EAAI,EAAGiW,GAHhB1U,EAAOA,OAGkB6C,OAAQpE,EAAIiW,EAAGjW,IAAK,CACzC,IAAIlC,EAAMyD,EAAKvB,GACfs+E,EAAKx2E,KAAKhK,EAAI,IAElB,OAAOwgF,GAMXjU,cAAe,WACX,IACIz4D,EAAa1S,KAAK0S,WAElBrU,EAHO2B,KAGS8iE,cAAcvT,YADf,uBAEf1vD,EAJOG,KAIK6jE,UAGZtgE,EAAOpG,EAAE0E,SAASxD,GAClBqmE,SAAUhyD,EAAWgyD,SACrBvqB,YAAaznC,EAAWynC,YAAcznC,EAAWynC,YAAc,GAC/D78C,GAAIoV,EAAWpV,GACfouC,KAAMh5B,EAAWg5B,KACjB6zC,YAZOv/E,KAYWu/E,cAClB1/E,KAAMA,EACNiE,YAdO9D,KAcW0gC,mBAAmBhuB,WAAW5O,cAKpD,OAFAP,EAjBWvD,KAiBCw/E,aAAaj8E,IAQ7B6nE,eAAgB,WACZ,OAAOprE,KAAKmrE,iBAMhBqU,aAAc,SAAUj8E,KAQxBk8E,YAAa,SAAU53D,KAOvB63D,YAAa,SAAU73D,KAOvB83D,UAAW,SAAU93D,KAOrB+3D,YAAa,WACT,IAEIC,EAAyB,cAFlB7/E,KACK6jE,UAC4B,gCAAkC,8BAC1ExlE,EAHO2B,KAGS8iE,cAAcvT,YAAYswB,GAC1Ct8E,EAAOpG,EAAE8/E,KAAK5+E,GAJP2B,KAMNm9B,OAAOv7B,OAAO2B,IAOvBu8E,QAAS,WACL,OAAO9/E,KAAK+/E,eAAiB,GAMjCC,OAAQ,WACJ,OAAOhgF,KAAKo/E,KAAKp/E,KAAK6tB,UAM1BoyD,WAAY,WAMR,OALWjgF,KAEF+/E,eAFE//E,KAEqB6tB,QAAU,IAF/B7tB,KAGF6tB,SAAW,GAHT7tB,KAKCggF,UAMhBE,eAAgB,WAMZ,OALWlgF,KAEF6tB,QAAU,IAFR7tB,KAGF6tB,SAAW,GAHT7tB,KAKCggF,UAMhBG,YAAa,WAIT,OAHWngF,KAEN6tB,QAAU,EAFJ7tB,KAGCggF,UAMhBI,WAAY,WAIR,OAHWpgF,KAEN6tB,QAFM7tB,KAESo/E,KAAKl6E,OAAS,EAFvBlF,KAGCggF,UAMhBD,aAAc,WACV,OAAO//E,KAAKo/E,KAAKl6E,QAGrBs6D,WAAY,WACR,OAAOx/D,KAAK0S,WAAW7U,KAAKwE,MAMhCg+E,WAAY,SAAUl/E,GAClBnB,KAAK6tB,QAAU1sB,EAAQ,GAM3Bm/E,wBAAyB,WACrB,OAAOtgF,KAAKs/E,iBAAiBp6E,OAAS,GAM1Cq7E,OAAQ,SAAUC,GACdxgF,KAAKo/E,KAAKx2E,KAAK43E,IAMnBC,UAAW,WACP,IACIt/E,EADOnB,KACM6tB,QAEjB,GAAI1sB,GAAS,EAAG,CAHLnB,KAIFo/E,KAAKvlE,OAAO1Y,EAAO,GAExB,IAAIf,EANGJ,KAMc+/E,eACjB3/E,EAAY,GAAKe,GAASf,GAPvBJ,KAQEqgF,WAAWjgF,KAS5Bm/E,YAAa,WACT,IACI1/E,EADOG,KACK6jE,UACZnxD,EAFO1S,KAEW0S,WAEtB,MAAY,aAAR7S,GAJOG,KAKM8/E,WAELjzE,OAAOY,KAAKuF,aAAaN,EAAWguE,iBAOpDC,cAAe,SAAUt1E,GACrB,IAEIpC,KACAyJ,EAHO1S,KAGW0S,WAClBmyC,EAAcnyC,EAAWmO,MAAQ,OAASxV,EAAO/N,GAAK,IAa1D,OAXA2L,EAAW46C,SAAWnxC,EAAWpV,GACjC2L,EAAW+6C,YAAca,EACzB57C,EAAW66C,aAAepxC,EAAWoxC,aACrC76C,EAAWm7C,YAAc1xC,EAAW0xC,YACpCn7C,EAAW86C,cAAgB14C,EAAO04C,cAClC96C,EAAWo7C,YAAc3xC,EAAW2xC,aAAe3xC,EAAW0zC,YAC9Dn9C,EAAWya,IAAMrY,EAAOqY,IACxBza,EAAW87C,SAAW15C,EAAO05C,SAChBryC,EAAW5O,YAGjBmF,GAOX23E,iBAAkB,WACd,IACIluE,EADO1S,KACW0S,WAiBtB,OAlBW1S,KAGQ+iE,YAAYtY,eAC3B/mC,IAAKhR,EAAWmuE,OAChBh9B,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcpxC,EAAWoxC,aACzBsC,YAAa1zC,EAAW2xC,aAAe3xC,EAAW0zC,YAClDhC,YAAa1xC,EAAW0xC,YACxBtgD,YAAa4O,EAAW5O,aAAe,QAGdmM,KAAK,SAAUpS,GAExC,OAAOA,EAAK8lD,WAGMp7C,WAO1Bu4E,kBAAmB,SAAUxjF,GACzB,IACIoV,EADO1S,KACW0S,WAClBmO,EAAQnO,EAAWmO,MAAQ,OAASvjB,EAAK,IAE7C,OAJW0C,KAIC+iE,YAAYvY,gBACpB9mC,IAAKhR,EAAWquE,QAChBl9B,SAAUnxC,EAAWpV,GACrBujB,MAAOA,EACPijC,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBgC,YAAa1zC,EAAW2xC,aAAe3xC,EAAW0zC,aAAe,GACjEtiD,YAAa4O,EAAW5O,aAAe,SAQ/Ck9E,oBAAqB,SAAU1jF,GAC3B,IAAIyC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmO,EAAQnO,EAAWmO,MAAQ,OAASvjB,EAAK,IAE7C,OAAOyC,EAAKgjE,YAAYlY,kBACpBnnC,IAAKhR,EAAWuuE,UAChBp9B,SAAUnxC,EAAWpV,GACrBujB,MAAOA,EACPijC,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBgC,YAAa1zC,EAAW2xC,aAAe3xC,EAAW0zC,cACnDn2C,KAAK,SAAUpS,GACd,GAAiB,sBAAbA,EAAKoM,KAA8B,CACnC,IAAIu7C,EAAOzlD,EAAK2gC,mBACZhqB,EAAU7Y,EAAKk+E,SAASrjE,KAAK,KACjC8sC,EAAKs1B,aAAcpkE,QAASA,IAGhC,OAAO7Y,KAQfqjF,kBAAmB,SAAU5jF,EAAIO,GAC7B,IAAIkC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+Q,EAAQtmB,EAAE4S,WAGV+zC,EAAepxC,EAAWoxC,aAAa5+C,OAAS,EAAIwN,EAAWoxC,aAAe,IAAMpxC,EAAWmO,MAAQ,OAASvjB,EAAK,IAAMoV,EAAWmO,MAAQ,OAASvjB,EAAK,IAE5Jw8E,EAAkB,KAuCtB,OAtCIj8E,EAAKk8E,YACLD,EAAkB38E,EAAEqM,KAAK4E,MAAMjR,EAAGU,EAAKk8E,kBAChCl8E,EAAKk8E,WAGhB58E,EAAEqM,KAAKswE,GAAiBj2D,KAAK,WAEzB9jB,EAAKgjE,YAAYpY,gBACbjnC,IAAKhR,EAAWyuE,QAChBt9B,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcA,EACdsC,YAAa1zC,EAAW2xC,aAAe3xC,EAAW0zC,aAAe,GACjEF,WAAYroD,IACbsK,KAAK,SAASm9C,GACb7hC,EAAMtT,QAAQm1C,KACfl1C,KAAK,SAAUgxE,GACd,IAAI57B,EAAOzlD,EAAK2gC,mBACZhqB,EAAW0qE,EAAqB,aAAIA,EAASllD,aAAoC,iBAAZklD,EAAwBA,EAAWA,EAAStwE,WAErH,GAAsB,iBAAX4F,EACP,IACIA,EAAUiG,KAAKhE,MAAMjC,GAASA,QAChC,MAAOzI,GAELyI,GADAA,EAAUA,EAAQoH,MAAM,oBAAoB,IAC1BlF,OAAO,GAAIlC,EAAQxR,OAAS,SAG1CwR,EAAQA,UAChBA,EAAU0qE,GAEd57B,EAAKm0B,eACLn0B,EAAKuT,0BACLvT,EAAK82B,qBAAqB5lE,OAK3B+M,EAAMlb,WAOjB84E,sBAAuB,SAAU1lD,GAC7B,IACIjpB,EADO1S,KACW0S,WAEtB,OAHW1S,KAGC+iE,YAAY9X,oBACpBvnC,IAAKhR,EAAW4rE,YAChBz6B,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcpxC,EAAWoxC,aACzBM,YAAazoB,EAAMyoB,YACnBgC,YATOpmD,KASW0S,WAAW0zC,aAAe,MAMpDk7B,cAAe,SAAUj2E,GACrB,IACIqH,EADO1S,KACW0S,WActB,OAXArH,EAASA,MACTlO,EAAEsJ,OAAO4E,GACLqY,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBsC,YAAa1zC,EAAW2xC,aAAe3xC,EAAW0zC,YAClDhC,YAAa1xC,EAAW0xC,cAXjBpkD,KAeC+iE,YAAY3gE,QAAQiJ,IAGpCrB,QAAS,SAAU0vD,GACf,IAAIlU,EAAOxlD,KAAKwlD,KAsBhB,YApBsB,IAAX,IACNA,EAAKniD,cAAgBs3D,QAAQ,SAAU5J,GACpC,GAAIA,EAAMr+C,WAAW2iD,QACjB,GAAItE,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAEnD5R,EAAM/mD,QAAQ0vD,QAEX,GAAI3I,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,sBAErD7R,EAAM/mD,QAAQ0vD,GAAkB,CACjC,IAAI/vC,EAAU+vC,EAAgBA,EAAgBx0D,OAAS,GACvDw0D,EAAgBA,EAAgBx0D,OAAS,GAAK/H,EAAEsJ,OAAOkjB,GACnDrsB,GAAIyzD,EAAMr+C,WAAWpV,QAQX,IAA3Bo8D,EAAgBx0D,QAG3Bs8E,iBAAkB,SAAS9nB,GACvB,QAAK15D,KAAKwlD,MACHxlD,KAAKwlD,KAAK6e,qBAAqBpL,mBAAmBS,MC7cjEv8D,EAAEklD,MAAM57C,OAAO,6BAKX08D,eAAgB,SAAU93D,GACXrL,KAGNsN,OAAOjC,GAGZ,IAAIqH,EANO1S,KAMW0S,WAEtBA,EAAW2rC,SAAW3rC,EAAW2rC,UAAY3rC,EAAWynC,YAGxDznC,EAAWpM,SAAWoM,EAAWpM,UAAY,oBAE7CoM,EAAW/U,gBAA0C,IAAvB+U,EAAW/U,WAA2BkP,OAAOY,KAAKuF,aAAaN,EAAW/U,YAM5GmoE,gBAAiB,WACb,IACIpzD,EAAa1S,KAAK0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,SAFnCvvD,KAKNyhF,aALMzhF,KAKc0hF,kBALd1hF,KAMN2hF,cANM3hF,KAMe4hF,mBAG1B,IAAIr+E,EAAOpG,EAAE0E,SAASxD,GAClBwjF,kBAVO7hF,KAUiByhF,aACxBtnC,YAAaznC,EAAWynC,YACxB4K,SAAUryC,EAAWqyC,SACrBjhD,YAAa4O,EAAW5O,YACxB4gE,SAAUhyD,EAAWgyD,SACrB/mE,SAAU+U,EAAW/U,SACrBqG,SAA8B,cAhBvBhE,KAgBS6jE,UAChBv7D,kBAAmBoK,EAAWpK,kBAC9BhC,SAAUoM,EAAWpM,SACrBolC,KAAMh5B,EAAWg5B,OAKrB,OADAnoC,EAvBWvD,KAuBCkmE,oBAAoB3iE,EAvBrBvD,KAuBgC+mE,uBAO/C2a,gBAAiB,aAKjBE,iBAAkB,aAKlBziB,gBAAiB,SAAU7K,EAAUwtB,OCjEzC3kF,EAAEklD,MAAM57C,OAAO,kCAKXq/D,gBAAiB,WACb,IACIpzD,EAAa1S,KAAK0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,cAG1ChsD,EAAOpG,EAAE0E,SAASxD,GAClBqmE,SAAUhyD,EAAWgyD,WAKzB,OADAnhE,EAVWvD,KAUCkmE,oBAAoB3iE,EAVrBvD,KAUgC+mE,yBCjBnD5pE,EAAEklD,MAAM57C,OAAO,6BAKX08D,eAAgB,SAAS93D,GACVrL,KAGNsN,OAAOjC,GAGZ,IAAIqH,EANO1S,KAMW0S,WACtBA,EAAWynC,YAAcznC,EAAWynC,aAAe,IAOvD2rB,gBAAiB,WACb,IACIpzD,EAAa1S,KAAK0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,SAG1ChsD,EAAOpG,EAAE0E,SAASxD,GAClB87C,YAAaznC,EAAWynC,YACxB4nC,QAASrvE,EAAWqvE,QACpBrrE,QAAShE,EAAWgE,QACpB5S,YAAa4O,EAAW5O,YACxB4gE,SAAUhyD,EAAWgyD,SACrBr+D,SAAUqM,EAAWpM,WAKzB,OADA/C,EAfWvD,KAeCkmE,oBAAoB3iE,EAfrBvD,KAegC+mE,uBAO/ClB,oBAAqB,SAASmc,GAC1B,IACItvE,EADO1S,KACW0S,WAGlBA,EAAWoQ,QACXk/D,EAAMl/D,OAAOpQ,EAAWoQ,QALjB9iB,KASNsN,OAAO00E,MCrDpB7kF,EAAEklD,MAAM57C,OAAO,oCAKX08D,eAAgB,SAAU93D,GACXrL,KAGNsN,OAAOjC,GAGZ,IAAIqH,EANO1S,KAMW0S,WACtBA,EAAWynC,YAAcznC,EAAWynC,aAAe,IAOvD2rB,gBAAiB,WACb,IACIpzD,EAAa1S,KAAK0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,gBAG1ChsD,EAAOpG,EAAE0E,SAASxD,GAClB87C,YAAaznC,EAAWynC,YACxBt6C,KAPOG,KAOI6jE,UACXa,SAAUhyD,EAAWgyD,SACrB1gE,SAA6B,WATtBhE,KASQ6jE,UACfv7D,kBAAmBoK,EAAWpK,kBAC9BjC,SAAUqM,EAAWpM,SACrBolC,KAAMh5B,EAAWg5B,OAKrB,OADAnoC,EAhBWvD,KAgBCkmE,oBAAoB3iE,EAhBrBvD,KAgBgC+mE,uBAO/ClB,oBAAqB,SAAUmc,GAE3BhiF,KAAKsN,OAAO00E,MC9CpB7kF,EAAEklD,MAAM57C,OAAO,kCAKXq/D,gBAAiB,WACb,IACIpzD,EAAa1S,KAAK0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,cAGhB,UAA1B78C,EAAW0zC,aALJpmD,KAKoCo9B,SAC3C1qB,EAAW0zC,YAAoD,mBANxDpmD,KAM+Bo9B,OAAO66C,eANtCj4E,KAM2Eo9B,OAAO66C,iBAAmB,IAIhH,IAAI10E,EAAOpG,EAAE0E,SAASxD,GAClB87C,YAAaznC,EAAWynC,YACxBuqB,SAAUhyD,EAAWgyD,WASzB,OAFAnhE,GAHAA,EAhBWvD,KAgBCkmE,oBAAoB3iE,EAhBrBvD,KAgBgC+mE,uBAG/BpiE,QAAQ,aAnBT3E,KAmB4BiiF,iBAQ3CC,cAAe,SAAUC,GACVniF,KACW0S,WAGXyvE,aAAeA,EAJfniF,KAONqrD,gBAMTA,aAAc,WACCrrD,KAGNoiF,kBAMThxE,MAAO,WAEH,OADWpR,KACCo9B,OAAOhsB,SAOvBkwE,cAAe,SAAUj2E,GACrB,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+Q,EAAQ,IAAItmB,EAAE4S,SAGdlS,EAAOkC,EAAKsiF,sBAEhB,OAAIx1E,OAAOY,KAAKkU,WAAW9jB,IACvBgP,OAAOwtE,eAAer6E,KAAK+M,YAAY,qCAAsC/M,KAAK+M,YAAY,iCAAkC,SACzH,OAGX1B,EAAOhJ,KAAQqQ,EAAWyvE,cAAgBzvE,EAAWyvE,aAAa52B,YAAc74C,EAAWyvE,aAAa52B,WAAa,EAAK74C,EAAWyvE,aAAa52B,WAAalgD,EAAOhJ,KAGlKqQ,EAAWyvE,mBAA4D,IAArCzvE,EAAWyvE,aAAoB,UACjE92E,EAAOhJ,KAAOqQ,EAAWyvE,aAAaG,SAAWj3E,EAAOhJ,MAI5DtC,EAAKgjE,YAAY1X,aAAaluD,EAAEsJ,OAAO4E,GACnCqY,IAAKhR,EAAW6uE,QAChB19B,SAAUnxC,EAAWmxC,SACrBO,YAAa1xC,EAAW0xC,YACxB4B,aAActzC,EAAWpV,GACzBguD,gBAAkB54C,EAAWyvE,aAAa72B,gBAAkB54C,EAAWyvE,aAAa72B,gBAAkB,KACtGC,WAAa74C,EAAWyvE,aAAa52B,WAAa,EAAI74C,EAAWyvE,aAAa52B,WAAa,KAC3FH,SAAUvtD,KAEVsK,KAAK,SAAUm9C,GAGf5yC,EAAWxS,KAAOolD,EAASplD,KAC3BwS,EAAW3J,QAAUu8C,EAASv8C,QAC9B2J,EAAWrS,WAAailD,EAASjlD,YAAc,EAG3CilD,EAASv8C,QAAU,KACnB2J,EAAW6vE,0BAA2B,EACtCj9B,EAASi9B,0BAA2B,UAE7B7vE,EAAW6vE,yBAGtB9+D,EAAMtT,QAAQm1C,GAGdvlD,EAAKyiF,qBACNpyE,KAAK,SAAUqyE,GAEd,GADA51E,OAAO4rD,sBAAuB,EAC1BgqB,EAAYvmD,aACZ,IACI,IAAIxlB,EAAUiG,KAAKhE,MAAM8pE,EAAYvmD,cAAcxlB,QACnD7J,OAAOwtE,eAAe3jE,EAAS,GAAI,SACrC,MAAOzI,IAEbwV,EAAM6uC,WAGH7uC,EAAMlb,YAOjB85E,oBAAqB,WACjB,IAGIxkF,KACJmC,KAAKinE,oBAAoBppE,GAGzB,IAAI6kF,KACJ,IAAK3hF,OAAOlD,EAAM,CACd,IAAIgjB,EAAQ9f,IACR6C,EAAQ/F,EAAKkD,KACb4J,EAXG3K,KAWc2iF,qBAXd3iF,KAWwCw0D,UAAU3zC,IACrD+hE,KACC/1E,OAAOY,KAAKqT,QAAQld,KACrBg/E,EAAoB,MAAI/hE,EACxB+hE,EAAoB,MAAIh/E,EACxBg/E,EAAwB,UAAIj4E,EAC5B+3E,EAAY95E,KAAKg6E,IAIzB,OAAOF,GAQXC,qBAAsB,SAAUnkC,GAC5B,IACI9rC,EADO1S,KACW0S,WAElB/H,EAAY,SAWhB,MAVkC,MAA9B6zC,EAAO9rC,WAAW2hB,gBAC0B,IAAjCmqB,EAAO9rC,WAAWy9D,YAA+D,WAAjC3xB,EAAO9rC,WAAWy9D,aAErExlE,EADA+H,EAAW44C,gBACC,WAGA,SAIjB3gD,GAOXs3E,aAAc,aAKdG,eAAgB,aAKhBS,0BAA2B,SAAUxuD,GAGjC,OAAgB,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GACtB,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GACtB,IAAZA,GAA8B,IAAZA,GAETpqB,KAAM,gBAKH,IAAZoqB,GAESpqB,KAAM,kCAIH,GAAZoqB,GAESpqB,KAAM,eAIH,IAAZoqB,GAA8B,IAAZA,GAETpqB,KAAM,cAIH,GAAZoqB,GAESpqB,KAAM,kBAIVA,KAAM,eAMnBu4E,iBAAkB,eC7OtBrlF,EAAEklD,MAAM57C,OAAO,2BAKX08D,eAAgB,SAAS93D,GAIrBrL,KAAKsN,OAAOjC,GAGZ,IAAIqH,EANO1S,KAMW0S,WACtBA,EAAW2rC,SAAW3rC,EAAW2rC,UAAY3rC,EAAWynC,YAGxDznC,EAAWpM,SAAWoM,EAAWpM,UAAY,IAMjDw/D,gBAAiB,WA2Bb,IA1BA,IAAI/lE,EAAOC,KACP0S,EAAa1S,KAAK0S,WAClBowE,EAAW3lF,EAAE2N,IAAI/K,EAAKsD,SAAU,SAAS0tD,EAAOhwD,GAGhD,OAFAgwD,EAAMr+C,WAAWqwE,QAAUhiF,EAC3BgwD,EAAMr+C,WAAWxR,QAAW6vD,EAAMr+C,WAAWxR,SAAW6vD,EAAMr+C,WAAWynC,aAAe,GACjF4W,EAAMr+C,aAEbrU,EAAW0B,EAAK+iE,cAAcvT,YAAY,OAC1C1vD,EAAOE,EAAK8jE,UAGZtgE,EAAOpG,EAAE0E,SAASxD,GAClBf,GAAIoV,EAAWpV,GACfq/E,KAAMmG,EACNjjF,KAAMA,EACNmE,SAA8B,cAAnBjE,EAAK8jE,UAChB9e,SAAUryC,EAAWqyC,SACrBi+B,eAAgBtwE,EAAW5O,YAC3B4gE,SAAUhyD,EAAWgyD,SACrBp+D,SAAUoM,EAAWpM,WAIrBs2C,EAAY78C,EAAK68C,UAAY78C,EAAKkjF,eAG7BniF,EAAI,EAAGoE,EAASnF,EAAKsD,SAAS6B,OAAQpE,EAAIoE,EAAQpE,IAEvDf,EAAKsD,SAASvC,GAAG4R,WAAWwwE,aAAgBpiF,GAAK87C,EAGrD,OADAr5C,EAAOxD,EAAKmmE,oBAAoB3iE,EAAMxD,EAAKgnE,uBAO/Ckc,aAAc,WACV,IACIvwE,EADO1S,KACW0S,WAClBiuB,EAAa3gC,KAAK0gC,mBAAmBE,YAG5B,cALF5gC,KAGK6jE,YAGPljC,EAAW4jB,WAAa7xC,EAAWkqC,WANjC58C,KAOE0gC,mBAAmB88C,kBAAkB9qE,EAAWkqC,WAI7D,IAAI4/B,EAAe77C,GAAcA,EAAW67C,aAAe77C,EAAW67C,gBAGtE,GAAIA,EAdOx8E,KAcW0S,WAAWpV,KAAO,EACpC,OAAOk/E,EAfAx8E,KAekB0S,WAAWpV,IAIxC,IAAK,IAAIwD,EAAI,EAAGoE,EAnBLlF,KAmBmBqD,SAAS6B,OAAQpE,EAAIoE,EAAQpE,IAEvD,GArBOd,KAqBEqD,SAASvC,GAAGqiF,yBAA0B,OAAOriF,EAE1D,OAAO,GAOXsiF,aAAc,SAAUjiF,GAKpB,GAJWnB,KAEN85D,eAAe,YAAc34D,MAAOA,EAAO07E,IAFrC78E,KAE+CqD,SAASlC,KAFxDnB,KAIFqD,SAASlC,GAAQ,CACtB,IAAIqkD,EALGxlD,KAKS0gC,mBALT1gC,KAOFqD,SAASlC,GAAO27C,WAPd98C,KAQF48C,UAAYz7C,EAEjB,IAAIkiF,KACJA,EAXOrjF,KAWUqD,SAASlC,GAAOi8B,OAAO1qB,WAAWpV,IAAM6D,EACzDqkD,EAAKsxB,SAAS,eAAgBuM,OCxG1ClmF,EAAEklD,MAAM57C,OAAO,+BAKXq/D,gBAAiB,WACb,IACIpzD,EAAa1S,KAAK0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,WAG1ChsD,EAAOpG,EAAE0E,SAASxD,GAClBf,GAAIoV,EAAWpV,GACfonE,SAAUhyD,EAAWgyD,SACrBqe,QAASrwE,EAAWqwE,QACpB/+E,SAA8B,cATvBhE,KASS6jE,YAMpB,OAFAtgE,EAbWvD,KAaCsjF,iBAAiB//E,IAQjC+/E,iBAAkB,SAAU//E,GAExB,OAAOvD,KAAKkmE,oBAAoB3iE,EAAMvD,KAAK+mE,uBAM/CjqB,SAAU,WACN98C,KAAK8I,QAAS,GAMlB8+D,SAAU,WACN,IACIvgC,EADOrnC,KACMsN,SAKjB,OAJIT,OAAOY,KAAKqT,QAAQumB,IAFbrnC,KAE4B8I,SACnCu+B,EAHOrnC,KAGM0S,WAAWpV,IAGrB+pC,GAMX87C,uBAAwB,WACpB,IACI97C,EADOrnC,KACM0gC,mBAAmB68C,oBAEpC,GAAIl2C,EAAO,CAGP,GAAIA,EAAMxmB,MAAO,CAEb,IAAI+jD,EARD5kE,KAQiB0gC,mBAAmBo1B,WAAWzuB,EAAMxmB,OAGxD1jB,EAAE0D,KAAK+jE,EAAU,SAAU9jE,EAAGmoC,GAEtBA,EAAKv2B,WAAWpV,IAAM+pC,EAAM/pC,IAAM2rC,EAAKv2B,WAAWqyC,WAClD9kD,EAAUgpC,UAKlB,IAAIhpC,EAnBDD,KAmBgB0gC,mBAAmBma,aAAaxT,IAnBhDrnC,KAmB+D0gC,mBAAmB+zB,cAAcptB,GAIvG,GAAIpnC,EACA,KAAOA,EAAQm9B,QAAQ,CACnB,GAAIn9B,EAAQyS,WAAWpV,IAzBxB0C,KAyBmC0S,WAAWpV,IAAM2C,EAAQm9B,OAAO1qB,WAAWpV,IAzB9E0C,KAyByF0S,WAAWpV,GAAI,OAAO,EAC9G2C,EAAUA,EAAQm9B,QAK9B,OAAO,KCvFfjgC,EAAEklD,MAAM57C,OAAO,qCCFftJ,EAAEklD,MAAM57C,OAAO,sCAKX08D,eAAgB,SAAUtlE,GACtB,IAAIkC,EAAOC,KAEXA,KAAKsN,OAAOzP,GACZ,IAAI2nD,EAAOzlD,EAAK2gC,mBAChB1gC,KAAKy7D,SAAWjW,EAAK9yC,WAAW+oD,UAAY,GAC5C,IAAI57D,EAAOE,EAAK8jE,UACZnxD,EAAa3S,EAAK2S,WAEtB3S,EAAKwjF,gBAAkB,IAAIpmF,EAAE4S,SAC7BhQ,EAAKwjF,gBAAgBh7E,UAET,aAAR1I,IACAE,EAAKyjF,OAAS,IAAI32E,OAAO42E,gBACrB3gB,cAAe/iE,EAAK+iE,cACpB5S,OAAO,EACPwzB,kBAAkB,EAClBh0B,aAAch9C,EAAWixE,kBAKjC5jF,EAAK6jF,0BACDv8B,QAAWtnD,EAAKoxE,YAChB7pB,YAAevnD,EAAK2S,WAAW4xC,WAC/BT,SAAY9jD,EAAK2S,WAAWpV,GAC5BwmD,aAAgB0B,EAAK9yC,WAAWoxC,aAChCM,YAAeoB,EAAK9yC,WAAW0xC,YAC/BljC,SAAY,OACZqmC,eAAkBxnD,EAAK2S,WAAWs9C,cAClCM,MAASvwD,EAAK2S,WAAWmxE,aACzBtzB,UAAaxwD,EAAK2S,WAAWoxE,SAC7Bt8B,aAAgBznD,EAAK2S,WAAWk2C,cAGpC7oD,EAAKgkF,kCACDv8B,aAAgBznD,EAAK2S,WAAWk2C,aAChC/E,SAAY9jD,EAAK2S,WAAWpV,GAC5BwmD,aAAgB0B,EAAK9yC,WAAWoxC,aAChCM,YAAeoB,EAAK9yC,WAAW0xC,YAC/BqD,cAAiB/0C,EAAWixE,eAC5BziE,SAAY,eACZ0nC,aAAgB7oD,EAAK2S,WAAWk2C,cAGpC7oD,EAAK2S,WAAWu3D,WAAa,IAC7BlqE,EAAK2S,WAAWg3D,YAAc,QAC9B,IAAIsa,EAA+C,mBAAzBnmF,EAAK6U,WAAWzI,KAC1ClK,EAAK2S,WAAWuxE,kBAAuD,IAAhCpmF,EAAK6U,WAAWuxE,aACjDD,EAAsBnmF,EAAK6U,WAAWuxE,aAC5ClkF,EAAK2S,WAAWwxE,kBAAuD,IAAhCrmF,EAAK6U,WAAWwxE,cAC1CrmF,EAAK6U,WAAWwxE,aAC7BnkF,EAAK2S,WAAWozC,iBAAqD,IAA/BjoD,EAAK6U,WAAWozC,aACxCjoD,EAAK6U,WAAWozC,YAC9B/lD,EAAK2S,WAAWixE,oBAA2D,IAAlC9lF,EAAK6U,WAAWixE,eACnD,GAAK9lF,EAAK6U,WAAWixE,eAC3B5jF,EAAK2S,WAAWyxE,kBAAkD,IAA3BzxE,EAAWyxE,aAC5CzxE,EAAWyxE,aAAe,OAEhCpkF,EAAK2S,WAAWm0C,UAAYrB,EAAKn6C,OAAOxN,KAAKgpD,UAExC9mD,EAAK2S,WAAW9O,MAGsB,iBAAzB7D,EAAK2S,WAAW9O,QAC9B7D,EAAK2S,WAAW9O,MAAQ7D,EAAK6D,MAAQ+Y,KAAKhE,MAAM5Y,EAAK2S,WAAW9O,SAHhE7D,EAAK2S,WAAW9O,MAAQ7D,EAAK6D,SAC7B7D,EAAK2S,WAAWG,mBAWxBuxE,yBAA0B,SAAUh5E,GAChC,IAAIrL,EAAOC,KAEPwlD,EAAOzlD,EAAK2gC,mBAEZ2jD,GACAxgC,SAAY9jD,EAAK2S,WAAWpV,GAC5BwmD,aAAgB0B,EAAK9yC,WAAWoxC,aAChCM,YAAeoB,EAAK9yC,WAAW0xC,YAC/BljC,SAAY,gBACZqmC,eAAkBxnD,EAAK2S,WAAWs9C,cAClCU,YAAetlD,EAAO0jE,WACtBpnB,YAAe/qC,KAAKC,QAChB8nC,aAAgBt5C,EAAOs5C,aACvB8C,aAAgBznD,EAAK2S,WAAWk2C,aAChCxE,YAAeh5C,EAAOg5C,eAI9BrkD,EAAKgjE,YAAYvS,eAAe6zB,GAAmCl8E,KAAK,SAAUtK,GAC9EkC,EAAKukF,gBAAgBzmF,EAAMuN,KAC5BgF,KAAK,SAAUurB,GAEd57B,EAAKukF,gBAAgB,QAASl5E,MAStCk5E,gBAAiB,SAAUh/B,EAAUi/B,KAQrCnZ,eAAgB,WACZ,OAAOprE,KAAKmrE,iBAMhBW,mBAAoB,WAChB9rE,KAAK0S,WAAWgiC,UAAW,EAC3B10C,KAAKmE,cAOTgnE,cAAe,WACX,IAGI9sE,EAFAqU,EADO1S,KACW0S,WAGlBnP,EAAO,GAGX,GAAY,UAPDvD,KAEK6jE,UAKM,CAClBxlE,EARO2B,KAQS8iE,cAAcvT,YAAY,gCAC1C,IAAIlkD,GACApB,KAAMyI,EAAWzI,KACjBi6E,aAAcxxE,EAAWwxE,aACzBp+B,YAAapzC,EAAWozC,YACxB0+B,gBAA4C,QAA3B9xE,EAAWyxE,aAC5BF,aAAcvxE,EAAWuxE,cAE7B1gF,EAAOpG,EAAE0E,SAASxD,EAAUgN,QACrBqH,EAAWs9C,gBAClB3xD,EAlBO2B,KAkBS8iE,cAAcvT,YAAY,yBAC1ChsD,EAAOpG,EAAE0E,SAASxD,GAAY4lF,aAnBvBjkF,KAmB0C0S,WAAWuxE,gBAEhE,OAAO1gF,GASXyG,QAAS,SAAU0vD,GACf,IACIhnD,EADO1S,KACW0S,WADX1S,KAEM2S,WAIjB,OAAoD,GAAhD9F,OAAOY,KAAKuF,aAAaN,EAAW2iD,WAIa,GAAjDxoD,OAAOY,KAAKuF,aAAaN,EAAWqyC,cAKpCryC,EAAWosD,WAfJ9+D,KAgBE4D,SAhBF5D,KAiBM4D,MAAMsB,OAAS,IAExBwR,QAnBG1W,KAmBY+M,YAAY,mCAC3B2sD,EAAgB9wD,MAAOiY,MAAOnO,EAAWmO,MAAOnK,QAASA,WAClD,MAWnBqqD,gBAAiB,SAAUn9D,GACZ5D,KACQ0rE,aADR1rE,KAIN+xC,SAASnuC,GAAO,IAOzB6gF,cAAe,SAAUr5E,GACrB,IAAIrL,EAAOC,KACP0kF,EAAct5E,EAAOs5E,aAAe,GACpCjjB,EAAM,IAAItkE,EAAE4S,SAOhB,OALA3E,EAAOy5C,YAAc9kD,EAAK2gC,mBAAmBhuB,WAAWmyC,YAKhDz5C,EAAOo7C,YACX,IAAK,UAED,IAAIn7C,GACAwkD,YAAa60B,GAGjBvnF,EAAEqM,KAAKzJ,EAAKgjE,YAAYnT,aAAavkD,IAASlD,KAAK,SAAUJ,GACrDA,EAAO6nD,aAEPzyD,EAAEqM,KAAKzJ,EAAK4kF,kBACR50B,YAAa20B,EACbzmF,MAAOmN,EAAO+uC,YACd0K,YAAaz5C,EAAOy5C,eACpB18C,KAAK,SAAUu8C,GACft5C,EAAOs5C,aAAeA,EACtB+c,EAAItxD,QAAQ/E,KAIhBq2D,EAAItxD,QAAQ/E,KAIpB,MACJ,IAAK,OAEDq2D,EAAItxD,QAAQ/E,GACZ,MACJ,IAAK,OAEGA,EAAO04C,aACP3mD,EAAEqM,KAAKzJ,EAAK6kF,4BAA4Bx5E,IAASjD,KAAK,SAAUu8C,GAC5Dt5C,EAAOs5C,aAAeA,EACtB+c,EAAItxD,QAAQ/E,MAIU,SAAtBA,EAAOo7C,aACPp7C,EAAO04C,kBAAe57C,EACtBkD,EAAOi5C,YAAc,iBACrBj5C,EAAOk5C,WAAal5C,EAAOk5C,YAAcvkD,EAAK2S,WAAW4xC,YAG7DnnD,EAAEqM,KAAKzJ,EAAK8kF,kBAAkBz5E,IAASjD,KAAK,SAAUu8C,GAClDt5C,EAAOs5C,aAAeA,EACtB+c,EAAItxD,QAAQ/E,MAM5B,OAAOq2D,EAAIl5D,WAOfu8E,iBAAkB,SAAU15E,GACxB,IACI25E,EADO/kF,KACY2S,WACnBguB,EAFO3gC,KAEW0gC,mBAAmBE,YAEzCx1B,EAAOC,OAASD,EAAOC,WAEvB,IAAIw5C,EANO7kD,KAMY0S,WAAWoxC,aAElC,OAAQ14C,EAAOo7C,YACX,IAAK,UACDp7C,EAAOC,QACHq5C,aAAct5C,EAAOs5C,aACrBD,iBAZDzkD,KAYwB0S,WAAWsyE,gBAAgBtsE,KAAK,KACvDusE,iBAAkBtkD,EAAWujB,YAAcr3C,OAAO8B,QAAQm3B,WAC1D+e,YAAaA,GAEjB,MACJ,IAAK,OACDz5C,EAAOC,QACHq5C,aAAct5C,EAAOs5C,aACrBD,iBApBDzkD,KAoBwB0S,WAAWsyE,gBAAgBtsE,KAAK,KACvDwsE,YArBDllF,KAqBmB0S,WAAWk2C,aAC7Bq8B,iBAAkBtkD,EAAWujB,YAAcr3C,OAAO8B,QAAQm3B,WAC1D6d,SAAUv4C,EAAOu4C,UAErB,MACJ,IAAK,OACDv4C,EAAOC,QACHu9C,aAAcx9C,EAAOw9C,cAAgB,GACrC/D,YAAaA,GAKzB,IAAIsgC,EAAsBt4E,OAAO8K,MAAMotE,GACvCI,EAAoBv8E,KAAKwC,GAnCdpL,KAoCN+xC,SAASozC,GApCHnlF,KAqCN+gE,gBAAgBokB,IAOzBC,oBAAqB,SAAUjkF,GAC3B,IACIgkF,EAAsBt4E,OAAO8K,MADtB3X,KACiC2S,YAC5CwyE,EAAoBtrE,OAAO1Y,EAAO,GAFvBnB,KAGN+xC,SAASozC,GAHHnlF,KAIN+gE,gBAAgBokB,IAMzB/d,YAAa,SAAUF,GAEnB,GADWlnE,KACFwS,wBAAyB,CAC9B,IACIqO,EAHG7gB,KAEe0S,WACCmO,MACnBwkE,EAJGrlF,KAIiB2S,WACpBtT,KACJlC,EAAE0D,KAAKwkF,EAAc,SAAUlkF,EAAOyC,GAClC,IAAIwH,KACJA,EAAOC,OAASzH,EAAMyH,WACtBD,EAAO0jE,WAAalrE,EAAMkrE,WAE1BzvE,EAAQuJ,KAAKwC,KAEjB87D,EAAarmD,GAA4B,GAAlBxhB,EAAQ6F,OAAe,GAAKyX,KAAKC,OAAOvd,KASvEimF,iBAAkB,SAAUl6E,GACxB,IACIxH,EADO5D,KACM2S,WACb4P,EAAQ,EAMZ,OALAplB,EAAE0D,KAAK+C,EAAO,SAAU7C,EAAK6C,GACrBA,EAAMkrE,YAAc1jE,EAAO0jE,YAC3BvsD,MAGDA,GAQXgjE,2BAA4B,SAAUC,GAalC,IAZA,IACIhgC,EADOxlD,KACK0gC,mBAWP5/B,EAAI,EAAmCwB,EAAvBkjF,EAAetgF,OAAoBpE,EAAIwB,EAAGxB,GAAK,EAKnC,IAA7B0kF,EAAe1kF,GAAGoE,SAClBsgF,EAAe1kF,GAAG+Y,OAAO,EAAG,EAAG,IAEH,WAAxB2rE,EAAe1kF,GAAG,IAAmB0kD,EAAK9yC,WAAWoxC,eACrD0hC,EAAe1kF,GAAG,GAAK0kD,EAAK9yC,WAAWoxC,eAKnD,OAAO0hC,KClZfroF,EAAEklD,MAAM57C,OAAO,sCAIX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAMhB83D,eAAgB,SAAStlE,GACrB,IAAIkC,EAAOC,KAEXA,KAAKsN,OAAOzP,GACZ,IAAI2nD,EAAOzlD,EAAK2gC,mBAEhB3gC,EAAKwjF,gBAAkB,IAAIpmF,EAAE4S,SAC7BhQ,EAAKwjF,gBAAgBh7E,UAGrBxI,EAAK6jF,0BACDv8B,QAAWtnD,EAAKoxE,YAChB7pB,YAAevnD,EAAK2S,WAAW4xC,WAC/BT,SAAY9jD,EAAK2S,WAAWpV,GAC5BwmD,aAAgB0B,EAAK9yC,WAAWoxC,aAChCM,YAAeoB,EAAK9yC,WAAW0xC,YAC/BljC,SAAY,OACZqmC,eAAkBxnD,EAAK2S,WAAWs9C,eAGtCjwD,EAAK2S,WAAWu3D,WAAa,IAC7BlqE,EAAK2S,WAAWg3D,YAAc,QAC9B3pE,EAAK2S,WAAWuxE,kBAAuD,IAAhCpmF,EAAK6U,WAAWuxE,cAAsCpmF,EAAK6U,WAAWuxE,aAEzGlkF,EAAK2S,WAAW9O,MAEsB,iBAAzB7D,EAAK2S,WAAW9O,QAC7B7D,EAAK2S,WAAW9O,MAAQ7D,EAAK6D,MAAQ+Y,KAAKhE,MAAM5Y,EAAK2S,WAAW9O,QAFhE7D,EAAK2S,WAAW9O,MAAQ7D,EAAK6D,UASrCunE,cAAe,WACX,IAEI9sE,EACAkF,EAAO,GAUX,MARY,UALDvD,KACK6jE,WAKZxlE,EANO2B,KAMS8iE,cAAcvT,YAAY,gCAC1ChsD,EAAOpG,EAAE0E,SAASxD,OAPX2B,KASE0S,WAAWs9C,gBACpB3xD,EAVO2B,KAUS8iE,cAAcvT,YAAY,yBAC1ChsD,EAAOpG,EAAE0E,SAASxD,GAAW4lF,aAXtBjkF,KAWyC0S,WAAWuxE,gBAExD1gF,GAMXyG,QAAS,SAAU0vD,GACJ15D,KACW0S,WADtB,IAGIgoD,EAAS16D,KAAKsN,OAAOosD,GAHd15D,KAIM2S,WAEjB,OAAO+nD,GAMXqG,gBAAiB,SAAUn9D,GACZ5D,KACQ0rE,aADR1rE,KAIN+xC,SAASnuC,GAAO,MCpF7BzG,EAAEklD,MAAM57C,OAAO,2CAId+Q,KAAM,SAASnM,GAEdrL,KAAKsN,OAAOjC,IAMb83D,eAAgB,SAAStlE,GACxB,IAAIkC,EAAOC,KAEXA,KAAKsN,OAAOzP,GACZ,IAAI2nD,EAAOzlD,EAAK2gC,mBAChB1gC,KAAKy7D,SAAWjW,EAAK9yC,WAAW+oD,UAAY,GACjC17D,EAAK8jE,UAEhB9jE,EAAKwjF,gBAAkB,IAAIpmF,EAAE4S,SAC7BhQ,EAAKwjF,gBAAgBh7E,UAErBxI,EAAK2S,WAAWu3D,WAAa,IAC7BlqE,EAAK2S,WAAWg3D,YAAc,QAC9B3pE,EAAK2S,WAAWozC,iBAAqD,IAA/BjoD,EAAK6U,WAAWozC,aAAsCjoD,EAAK6U,WAAWozC,YAC5G/lD,EAAK2S,WAAWsyE,gBAAkBjlF,EAAK2S,WAAWsyE,oBAE9CjlF,EAAK2S,WAAW9O,MAGsB,iBAAzB7D,EAAK2S,WAAW9O,QAChC7D,EAAK2S,WAAW9O,MAAQ7D,EAAK6D,MAAQ+Y,KAAKhE,MAAM5Y,EAAK2S,WAAW9O,SAHhE7D,EAAK2S,WAAW9O,MAAQ7D,EAAK6D,SAC7B7D,EAAK2S,WAAWG,kBAMjB9S,EAAK6jF,0BACJv8B,QAAWtnD,EAAKoxE,YAChB7pB,YAAevnD,EAAK2S,WAAW4xC,WAC/BT,SAAY9jD,EAAK2S,WAAWpV,GAC5BwmD,aAAgB0B,EAAK9yC,WAAWoxC,aAChCM,YAAeoB,EAAK9yC,WAAW0xC,YAC/BljC,SAAY,OACZovC,MAASvwD,EAAK0lF,WAAW1lF,EAAK2S,WAAWmxE,UACzCp/B,iBAAoB1kD,EAAK2S,WAAWsyE,kBAStCZ,yBAA0B,SAASh5E,GAClC,IAAIrL,EAAOC,KAEPwlD,EAAOzlD,EAAK2gC,mBAEZglD,GACH7hC,SAAY9jD,EAAK2S,WAAWpV,GAC5BwmD,aAAgB0B,EAAK9yC,WAAWoxC,aAChCM,YAAeoB,EAAK9yC,WAAW0xC,YAC/BljC,SAAY,qBACZqmC,eAAkBxnD,EAAK2S,WAAWs9C,cAClCS,iBAAoBrlD,EAAO8lD,gBAC3BxJ,YAAe/qC,KAAKC,QACnB8nC,aAAgBt5C,EAAOs5C,aACvB8C,aAAgBznD,EAAK2S,WAAWk2C,aAChCxE,YAAeh5C,EAAOg5C,eAIxBrkD,EAAKgjE,YAAYvS,eAAek1B,GAAwCv9E,KAAK,SAAStK,GACrFkC,EAAKukF,gBAAgBzmF,EAAKynD,SAAUl6C,KAClCgF,KAAK,SAASurB,GAEhB57B,EAAKukF,gBAAgB,QAASl5E,MAQhCk5E,gBAAiB,SAASh/B,EAAUi/B,KAQpCnZ,eAAgB,WACf,OAAOprE,KAAKmrE,iBAMbW,mBAAoB,WACnB9rE,KAAK0S,WAAWgiC,UAAW,EAC3B10C,KAAKmE,cAONgnE,cAAe,WACd,IAGI9sE,EAFAqU,EADO1S,KACW0S,WAGlBnP,EAAO,GAGX,GAAW,UAPAvD,KAEK6jE,UAKK,CACpBxlE,EARU2B,KAQM8iE,cAAcvT,YAAY,qCAC1C,IAAIlkD,GACHpB,KAAMyI,EAAWzI,KACjB67C,YAAapzC,EAAWozC,aAEzBviD,EAAOpG,EAAE0E,SAASxD,EAAUgN,QACnBqH,EAAWs9C,gBACpB3xD,EAfU2B,KAeM8iE,cAAcvT,YAAY,8BAC1ChsD,EAAOpG,EAAE0E,SAASxD,IAEnB,OAAOkF,GASRyG,QAAS,SAAS0vD,GACN15D,KACQ0S,WADnB,IAGIgoD,EAAS16D,KAAKsN,OAAOosD,GAHd15D,KAIM2S,WAEjB,OAAO+nD,GAORqG,gBAAiB,SAASn9D,GACd5D,KAEN+xC,SAASnuC,GAAO,IAOtB6gF,cAAe,SAASr5E,GACvB,IAAIrL,EAAOC,KACP0kF,EAAct5E,EAAO6lD,YAAc,GACnCwQ,EAAM,IAAItkE,EAAE4S,SAQhB,OANM3E,EAAOy5C,YAAc9kD,EAAK2gC,mBAAmBhuB,WAAWmyC,YAMvDz5C,EAAOo7C,YACb,IAAK,UAEJ,IAAIn7C,GACHwkD,YAAa60B,GAGdvnF,EAAEqM,KAAKzJ,EAAKgjE,YAAYnT,aAAavkD,IAASlD,KAAK,SAASJ,GACxDA,EAAO6nD,aAETzyD,EAAEqM,KAAKzJ,EAAK4kF,kBACX50B,YAAa20B,EACbzmF,MAAOmN,EAAOu6E,aACO9gC,YAAaz5C,EAAOy5C,eACtC18C,KAAK,SAASu8C,GACjBt5C,EAAOs5C,aAAeA,EACtB+c,EAAItxD,QAAQ/E,KAIbq2D,EAAItxD,QAAQ/E,KAId,MACD,IAAK,OAEJq2D,EAAItxD,QAAQ/E,GACZ,MACD,IAAK,OACJjO,EAAEqM,KAAKzJ,EAAK8kF,kBAAkBz5E,IAASjD,KAAK,SAASu8C,GACpDt5C,EAAOs5C,aAAeA,EACtB+c,EAAItxD,QAAQ/E,KAKf,OAAOq2D,EAAIl5D,WAOZu8E,iBAAkB,SAAS15E,GAC1B,IACI25E,EADO/kF,KACY2S,WACnBguB,EAFO3gC,KAEW0gC,mBAAmBE,YAEzCx1B,EAAOC,OAASD,EAAOC,WAEjB,IAAIw5C,EANC7kD,KAMkB0S,WAAWoxC,aAExC,OAAO14C,EAAOo7C,YACb,IAAK,UACJp7C,EAAOC,QACNo5C,iBAXQzkD,KAWe0S,WAAWsyE,gBAAgBtsE,KAAK,KACvDusE,iBAAkBtkD,EAAWujB,YAAcr3C,OAAO8B,QAAQm3B,WAC3C+e,YAAaA,QAEkB,IAAxBz5C,EAAOs5C,eACdt5C,EAAOC,OAAOq5C,aAAet5C,EAAOs5C,cAEpD,MACD,IAAK,OACJt5C,EAAOC,QACNq5C,aAAct5C,EAAOs5C,aACrBD,iBAtBQzkD,KAsBe0S,WAAWsyE,gBAAgBtsE,KAAK,KACvDwsE,YAvBQllF,KAuBU0S,WAAWk2C,aAC7Bq8B,iBAAkBtkD,EAAWujB,YAAcr3C,OAAO8B,QAAQm3B,WAC1D6d,SAAUv4C,EAAOu4C,SACjBW,WAAYl5C,EAAOk5C,YAQtBygC,EAAYn8E,KAAKwC,GAlCNpL,KAmCN+xC,SAASgzC,GAnCH/kF,KAoCN+gE,gBAAgBgkB,IAOtBK,oBAAqB,SAASjkF,GAC7B,IACIyC,EADO5D,KACM2S,WACjB/O,EAAMiW,OAAO1Y,EAAO,GAFTnB,KAGN+xC,SAASnuC,GAHH5D,KAIN+gE,gBAAgBn9D,IAMtBwjE,YAAa,SAASF,GAErB,GADWlnE,KACHwS,wBAAyB,CAChC,IACIqO,EAHM7gB,KAEY0S,WACCmO,MACnBwkE,EAJMrlF,KAIc2S,WACpBtT,KACJlC,EAAE0D,KAAKwkF,EAAc,SAASlkF,EAAOyC,GACpC,IAAIwH,KACJA,EAAOC,OAASzH,EAAMyH,WACtBD,EAAO0jE,WAAalrE,EAAMqtD,YAAcrtD,EAAMkrE,WAC9C1jE,EAAO+uC,YAAcv2C,EAAMu2C,YAC3B/uC,EAAO8lD,gBAAkBttD,EAAMstD,gBAC/B9lD,EAAOo7C,WAAa5iD,EAAM4iD,WAC1Bp7C,EAAO04C,aAAelgD,EAAMkgD,aAC5B14C,EAAOk5C,WAAa1gD,EAAM0gD,WAC1BjlD,EAAQuJ,KAAKwC,KAEd87D,EAAarmD,GAA4B,GAAlBxhB,EAAQ6F,OAAe,GAAKyX,KAAKC,OAAOvd,KASjEimF,iBAAkB,SAASl6E,GAC1B,IACIxH,EADO5D,KACM2S,WACb4P,EAAQ,EAMZ,OALAplB,EAAE0D,KAAK+C,EAAO,SAAS7C,EAAK6C,GACxBA,EAAMkrE,YAAc1jE,EAAO0jE,YAC7BvsD,MAGKA,GAQRkjE,WAAY,SAASG,GAIpB,IAFA,IAAI79E,KAEIjH,GAHR8kF,EAAUA,OAGU1gF,OAAQpE,EAAI,EAAGA,IAClCiH,EAAOa,KAAKg9E,EAAQ9kF,EAAI,GAAG8C,OAE5B,OAAQmE,EAAO7C,OAAS,EAAK6C,EAAS,MChUxC5K,EAAEklD,MAAM57C,OAAO,6BAKX08D,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAEtBA,EAAWmzE,aAAenzE,EAAW7U,OAAQ,EAE7C6U,EAAW9O,MAAQ8O,EAAW9O,OAAS8O,EAAW9O,MAAMsB,OAAS,EAAIwN,EAAW9O,MAAM,GAAM8O,EAAWg8D,cAAgBh8D,EAAWg8D,aAAaxpE,OAAS,EAAIwN,EAAWg8D,aAAa,GAAK,UAEhJ,IAA7Bh8D,EAAuB,eAAmBA,EAAWozE,cAAe,GAC5EpzE,EAAW9O,YAAiCsE,IAAxBwK,EAAW9O,MAAMtG,KAAkBoV,EAAW9O,MAAQ,MAC9E5D,KAAK4D,MAAQ8O,EAAW9O,MAGpB8O,EAAWmzE,eACXnzE,EAAW7U,KAAOmC,KAAK+lF,eAAerzE,EAAW7U,OAIrD6U,EAAWwwE,cAAe,GAO9B/X,cAAe,WACX,IACI9/D,KACAypD,EAAajoD,OAAOY,KAAKs8B,cAFlB/pC,KAEqC0S,WAAWzI,MAE3D,GAJWjK,KAIFgmF,aAJEhmF,KAIkB0S,YAAc,oBAAoBR,KAAK4iD,IAJzD90D,KAI6EimF,eAAgB,CACpG,IAAIC,EALGlmF,KAKiBimF,iBAAiBtzE,WACrCuzE,GAAgBA,EAAa5oF,KAC7B+N,EAPGrL,KAOSqiD,MAAMI,2BAA6B,UAAYyjC,EAAa5oF,IAIhF,OAXW0C,KAWCmmF,YAAY96E,IAM5B86E,YAAa,SAAU96E,GACnB,IAAItL,EAAOC,KAGX,GAFiBD,EAAK2S,WAEPwwE,aAGX,OADWnjF,EAAKqmF,sBAKhB,IAAI3iE,EAAQ,IAAItmB,EAAE4S,SACds2E,EAActmF,EAAKqC,QAAQiJ,GAe/B,OAZAlO,EAAEqM,KAAK68E,GAAal+E,KAAK,SAAUtK,GAE/B,IAAI0F,EAAOxD,EAAKqmF,oBAAoBvoF,GACpCkC,EAAK2S,WAAW7U,KAAOA,EACvB4lB,EAAMtT,QAAQ5M,KAEf6M,KAAK,SAAUvS,GACd,IAAI0F,EAAOxD,EAAKqmF,wBAChB3iE,EAAMtT,QAAQ5M,KAIXkgB,EAAMlb,WAIrB69E,oBAAqB,SAAUvoF,GAC3B,IACI6U,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAFvBvvD,KAEwCsmF,mBAC/CC,EAAa15E,OAAOwkB,SAASm1D,oBAHtBxmF,KAGiD+M,YAAY,gCACpEnJ,EAAQ8O,EAAW9O,MAAQ,GAAK2iF,EAmBpC,OAlBA1oF,EAAOA,GALImC,KAKS0S,WAAW7U,SAEF,gBAPlBmC,KAOF0S,WAAWzI,MAAoC,KAAVrG,GAA4C,iBAArB8O,EAAW9O,OAA8C,KAAxB8O,EAAW9O,MAAMtG,IAAyC,KAA3BoV,EAAW9O,MAAMA,OAAgB8O,EAAW9O,MAAMA,QAP5K5D,KAO2L+M,YAAY,8BAC9MnJ,EARO5D,KAQM+M,YAAY,iCAGlB5P,EAAE0E,SAASxD,EAAUlB,EAAEsJ,OAXvBzG,KAWmCymF,qBAC1CnpF,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClB6lE,OAAQ75E,OAAOY,KAAK4e,aAAa,IAAO,KACxC+3B,YAAa1xC,EAAW0xC,YACxBx3C,MAAO/O,EACP8yE,MAAOj+D,EAAW62D,WAClB3lE,MAAOA,EACPmhD,SAAUryC,EAAWqyC,aAW7B+mB,mBAAoB,WAChB,IAAI/rE,EAAOC,KACXD,EAAKuN,SACL,IAAI27B,EAAOlpC,EAAK4S,WACZF,EAAU1S,EAAK2rE,aAEf3rE,EAAK0S,SAAW1S,EAAK0S,QAAQ2qB,UAC7Br9B,EAAK0S,QAAQ2qB,SAAS/7B,SAAS,yBAA2BtB,EAAK2S,WAAWg3D,aAE1EzgC,GAEkB,MAAdA,EAAKrlC,OAAyC,kBAAhBqlC,EAAU,SACK,IAAzCp8B,OAAOY,KAAKuF,aAAai2B,EAAKrlC,OAC9BqlC,EAAKrlC,MAAQ5D,KAAK+M,YAAY,sBAEiB,GAAxCF,OAAOY,KAAKuF,aAAai2B,EAAKrlC,SACrCqlC,EAAKrlC,MAAQ5D,KAAK+M,YAAY,uBAKlChN,EAAKgN,YAAY,8BAAgCk8B,EAAKrlC,OAAS7D,EAAKgN,YAAY,kCAAoCk8B,EAAKrlC,MACzH6O,EAAQN,KAAK,IAEbM,EAAQlP,KAAK,mCAAqCxD,EAAKgpC,WAAWE,EAAKrlC,OAAS,aAIpF6O,EAAQN,KAAK,KAQrBm0E,gBAAiB,WACb,MAAO,SAOXK,UAAW,WACP,OAAO,GAOXC,gBAAiB,WACb,OAAO,GAMXxkF,QAAS,SAAUiJ,GACf,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+Q,EAAQ,IAAItmB,EAAE4S,SAIlB,GAAa,cAHFhQ,EAAK8jE,UAGU,OAAO9jE,EAAK8mF,eAEtC,GAAIn0E,EAAWmzE,aAGXpiE,EAAMtT,QAAQuC,EAAW7U,UAEtB,CACH,IAAIi3D,EAAajoD,OAAOY,KAAKs8B,cAAcr3B,EAAWzI,MAGlDyI,EAAWo0E,mBAAsB,oBAAoB50E,KAAK4iD,GAC1DrxC,EAAMtT,QAAQuC,EAAW7U,MAGzBkC,EAAKgjE,YAAYzf,cAAclhD,SAC3BshB,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBwC,MAAOv7C,EACP+6C,YAAarmD,EAAK2S,WAAW0zC,aAAe,OAC7Cj+C,KAAK,SAAUtK,GAGT6U,EAAWq0E,cACZr0E,EAAWo0E,kBAAmB,GAElCp0E,EAAW7U,KAAOkC,EAAKgmF,eAAeloF,GACtC4lB,EAAMtT,QAAQuC,EAAW7U,QAE1BuS,KAAK,SAAUvS,GAEd,GAAkB,kBAAdA,EAAKoM,KAAT,CAIA,IAAIu7C,EAAOzlD,EAAK2gC,mBACZsmD,EAASjnF,EAAK2S,WAAWynC,YAAc,KAE3C,GAAoB,iBAATt8C,EACP,IAAIopF,EAAStqE,MAAQA,KAAKhE,MAAM9a,IAASV,EAAE6tD,UAAUntD,QAEjDopF,EAASppF,EAGjBmpF,GAAUC,EAAOvwE,QAEjB8uC,EAAK82B,qBAAqB0K,GAE1BvjE,EAAM6uC,OAAOz0D,MAKzB,OAAO4lB,EAAMlb,WAMjBs+E,aAAc,WACV,IACIn0E,EADO1S,KACW0S,WACtB,OAAIA,EAAW7U,KACJ6U,EAAW7U,MAGlB6U,EAAW7U,QACX6U,EAAW7U,KAPJmC,KAOgB+lF,eAAerzE,EAAW7U,MAGjD6U,EAAW7U,KAAK+K,MAAMtL,GAAI,GAAIsG,MAAO,WACrC8O,EAAW7U,KAAK+K,MAAMtL,GAAI,GAAIsG,MAAO,WAE9B8O,EAAW7U,OAO1BiiC,UAAW,WACP,IACIptB,EADO1S,KACW0S,WAEtBA,EAAWmzE,cAAe,EAC1BnzE,EAAW7U,KAAO,KAClB6U,EAAWo0E,kBAAmB,GAMlCnZ,gBAAiB,WAGb,GAFW3tE,KAEFknF,OAFElnF,KAEYknF,MAAMhiF,OAAS,EAElC,OAJOlF,KAIKmnF,mBAEZ,IAAIzZ,EAAe,GACfzkC,EAPGjpC,KAOS2S,WAOhB,OALIs2B,IAEAykC,EAXG1tE,KAWiB+oC,WAAWE,EAAKrlC,QAGjC8pE,GAQfyZ,iBAAkB,aAMlBV,kBAAmB,WACf,UAaJ19C,WAAY,SAAUnlC,GAElB,GAAIA,MAAAA,EAAuC,CACvC,GAAIzG,EAAE4iB,QAAQnc,GAAQ,CAElB,IAAK,IAAI9C,EAAI,EAAGoE,EAAStB,EAAMsB,OAAQpE,EAAIoE,EAAQpE,IAC/B,MAAZ8C,EAAM9C,IAAoC,kBAAd8C,EAAM9C,MACS,IAAvC+L,OAAOY,KAAKuF,aAAapP,EAAM9C,IAC/B8C,EAAM9C,GAAKd,KAAK+M,YAAY,uBACkB,IAAvCF,OAAOY,KAAKuF,aAAapP,EAAM9C,MACtC8C,EAAM9C,GAAKd,KAAK+M,YAAY,uBAIxC,OAAOnJ,EAAM8U,KAAK,OAElB,OAAO9U,EAGX,MAAO,IAOfwjE,YAAa,SAAUF,GACnB,IACIx0D,EADO1S,KACW0S,WAGlBmO,EAAQnO,EAAWmO,MACnBjd,EALO5D,KAKM2S,WALN3S,KAOFwS,0BAGA3F,OAAOY,KAAKqT,QAAQD,IAArB,MAA+Bjd,IAER,iBAAZ,QAAsCsE,IAAbtE,EAAMtG,IAAiC,KAAbsG,EAAMtG,GAIhE4pE,EAAax0D,EAAWmO,YAA+B,IAAdjd,EAAQ,GAAoBA,EAAMtG,GAAK,GAHhF4pE,EAAax0D,EAAWmO,OAAS,MASjDrO,sBAAuB,WACnB,IACIE,EADO1S,KACW0S,WAClB00E,EAFOpnF,KAEa2S,WACpBE,EAAgBH,EAAWG,cAC3B67D,EAAeh8D,EAAWg8D,aAE1B3mE,GAAS,EAEb,OAAI5K,EAAE2V,iBACK/K,GAGXq/E,EAAeA,QAAwCl/E,IAAxBk/E,EAAaliF,OAAuBkiF,EAAa,GAAKA,EACrFv0E,EAAgBA,QAA0C3K,IAAzB2K,EAAc3N,OAAuB2N,EAAc,GAAKA,EACzF67D,EAAeA,QAAwCxmE,IAAxBwmE,EAAaxpE,OAAuBwpE,EAAa,GAAKA,EAErF0Y,EAAeA,QAAoCl/E,IAApBk/E,EAAa9pF,GAAmB8pF,EAAa9pF,GAAK8pF,EACjFv0E,EAAgBA,QAAsC3K,IAArB2K,EAAcvV,GAAmBuV,EAAcvV,GAAKuV,EAK7E9K,OAFaG,KAFrBwmE,EAAeA,QAAoCxmE,IAApBwmE,EAAapxE,GAAmBoxE,EAAapxE,GAAKoxE,GAGzEA,GAAgB77D,GAAiB67D,GAAgB0Y,EAM5CA,GAAgBv0E,IASjCw0E,sBAAuB,SAAUxpF,GAC7B,IAAIkC,EAAOC,KAEX,OAAO7C,EAAE2N,IAAIjN,EAAM,SAAUorC,GACzB,IAAIrlC,EAAQqlC,EAAKrlC,MAAQ7D,EAAKgpC,WAAWE,EAAKrlC,OAASqlC,EACnDq+C,GAAWhqF,GAAI2rC,EAAK3rC,GAAIsG,MAAOA,GAGnC,OADIqlC,EAAKphC,SAAQy/E,EAAQz/E,QAAS,GAC3BohC,KAOf88C,eAAgB,SAAUloF,GACtB,IAAIkC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElB60E,GAAoB,EAgBxB,GAfApqF,EAAE0D,KAAKhD,EAAM,SAAUiD,EAAGmoC,QAEH/gC,IAAf+gC,EAAKrlC,OAAsC,OAAfqlC,EAAKrlC,OACjCqlC,EAAKrlC,MAAQ7D,EAAKgpC,WAAWE,EAAKrlC,OAC9B8O,EAAW9O,OACPqlC,EAAK3rC,IAAMoV,EAAW9O,MAAMtG,KAC5BiqF,GAAoB,IAI5Bt+C,EAAKrlC,MAAQ,KAKjB7D,EAAK4mF,YAAa,CAElB,IADA,IAAIa,GAAa,EACR1mF,EAAI,EAAGoE,EAASrH,EAAKqH,OAAQpE,EAAIoE,EAAQpE,IAC9C,GAAmB,KAAfjD,EAAKiD,GAAGxD,GAAW,CACnBkqF,GAAa,EACb,MAIR,IAAKA,EAAY,CACb,IAAIC,EAAY56E,OAAOwkB,SAASm1D,oBAAsB35E,OAAOC,aAAaC,YAAY,4BACtFlP,EAAKg5E,SAASv5E,GAAI,GAAIsG,MAAO6jF,KAWrC,OAPI/0E,EAAW9O,QACN2jF,GAAqBxnF,EAAK6mF,mBAC3B/oF,EAAKg5E,SAASv5E,GAAIoV,EAAW9O,MAAMtG,GAAIsG,MAAO8O,EAAW9O,MAAMA,MAAOiE,QAAQ,IAK/E9H,EAAKsnF,sBAAsBxpF,IAMtCyuE,SAAU,WACN,IACI8a,EADOpnF,KACa2S,WAExB,OAAI9F,OAAOY,KAAKqT,QAAQsmE,KAC8B,oBAAlDvnE,OAAO1R,UAAU2C,SAAS1C,MAAMg5E,KAAwCv6E,OAAOY,KAAKqT,QAAQsmE,EAAa9pF,KAA0B,GAAnB8pF,EAAa9pF,KASrI2kE,UAAW,WACP,IACIr+D,GAAStG,GAAI,GAAI0D,MAAO,IADjBhB,KAGN+gE,gBAAgBn9D,GAHV5D,KAIN+xC,SAASnuC,GAAO,IAGzB0gE,gBAAiB,WACbtkE,KAAKtB,SAAWsB,KAAKtB,OAAOgpF,WAAa1nF,KAAKoC,WAGlDulF,YAAa,WACT,IAEI/jF,GAFO5D,KACK4D,WACCA,OAAS,GAE1B,MAAiB,KAAVA,GAAgBA,IAJZ5D,KAI2B+M,YAAY,iCAAmCnJ,IAJ1E5D,KAIyF+M,YAAY,6BAGpH66E,YAAa,SAAUhkF,GACnB,OAAIiJ,OAAOY,KAAKmS,SAAShc,GACDA,EAAM+X,WAAW,IAAK,QAAQA,WAAW,IAAK,QAG3D/X,GASfikF,SAAU,SAAUjkF,GAChB,OAAIA,GAASA,EAAMi9D,YAEXvjE,GAAIsG,EAAMA,MACVA,MAAOA,EAAM5C,MACbA,MAAO4C,EAAM5C,OAId4C,GAGXkkF,cAAe,SAAUlkF,GACrB,GAAiBsE,MAAZtE,EAAMtG,KAA0C,iBAAbsG,EAAMtG,IAAgC,OAAbsG,EAAMtG,IAAqC,iBAAbsG,EAAMtG,IAAmBsG,EAAMtG,GAAG4H,OAAS,GACtI,GAAoB,OAAhBtB,EAAMA,OAAyC,kBAAhBA,EAAMA,MACrCmkF,YAAa,GACiC,IAA1Cl7E,OAAOY,KAAKuF,aAAapP,EAAMA,OAC/BA,EAAMA,MAAQiJ,OAAOC,aAAaC,YAAY,uBACG,IAA1CF,OAAOY,KAAKuF,aAAapP,EAAMA,SACtCA,EAAMA,MAAQiJ,OAAOC,aAAaC,YAAY,2BAE/C,GAAmB,MAAfnJ,EAAMA,OAAwC,iBAAhBA,EAAMA,MAC3C,IAAK,IAAI9C,EAAI,EAAGoE,EAAStB,EAAMA,MAAMsB,OAAQpE,EAAIoE,EAAQpE,IAC/B,MAAlB8C,EAAMA,MAAM9C,IAA0C,kBAApB8C,EAAMA,MAAM9C,MACG,IAA7C+L,OAAOY,KAAKuF,aAAapP,EAAMA,MAAM9C,IACrC8C,EAAMA,MAAM9C,GAAK+L,OAAOC,aAAaC,YAAY,uBACG,IAA7CF,OAAOY,KAAKuF,aAAapP,EAAMA,MAAM9C,MAC5C8C,EAAMA,MAAM9C,GAAK+L,OAAOC,aAAaC,YAAY,uBAOrE,OAAOnJ,GAQXokF,kBAAmB,SAAU1qF,GACzB,OAAQ0C,KAAK0S,WAAW7U,UAAYyF,KAAK,SAAU2K,GAC/C,OAAOA,EAAE3Q,IAAMA,OChjB3BH,EAAEklD,MAAM57C,OAAO,6BAMX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAW9O,WAAqC,IAArB8O,EAAgB,MAAmB7F,OAAOY,KAAKuF,aAAaN,EAAW9O,OAAS,KAE3G8O,EAAWu1E,YAAep7E,OAAOwkB,WAA4C,IAAhCxkB,OAAOwkB,SAASo8C,cAA0B/6D,EAAWqyC,UAMtGomB,cAAe,WACX,IAAI9sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,SAC1C24B,EAAWr7E,OAAOY,KAAK4e,aAAa,IAAK,KAQ7C,OALWlvB,EAAE0E,SAASxD,GAClBf,GAAI4qF,EACJnjC,SAAU/kD,KAAK0S,WAAWqyC,YAUlCqmB,eAAgB,WACZ,OAAOprE,KAAKmrE,iBAMhBhnE,WAAY,WAERnE,KAAKsN,UAMTqgE,gBAAiB,WACb,IAAI/pE,EAAQ5D,KAAK2S,WAEjB,OAAwC,IAApC9F,OAAOY,KAAKuF,aAAapP,GAClB5D,KAAK+M,YAAY,uBACmB,IAApCF,OAAOY,KAAKuF,aAAapP,GACzB5D,KAAK+M,YAAY,qBAEjB,IAOfu/D,SAAU,WACN,IAAI1oE,EAAQ5D,KAAK2S,WAEjB,OAAI9F,OAAOY,KAAKqT,QAAQld,OAIE,IAFPiJ,OAAOY,KAAKuF,aAAapP,IAET5D,KAAK0S,WAAWosD,aC1E3D3hE,EAAEklD,MAAM57C,OAAO,8BAMX08D,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAClBof,EAAS9xB,KAAK+M,YAAY,iBAE9B2F,EAAWmgB,mBAAuD,IAA9BngB,EAAwB,cAAqB7F,OAAOY,KAAKuF,aAAaN,EAAWmgB,eAAiB7yB,KAAKmoF,wBAAwBz1E,EAAW2hB,UAC9K3hB,EAAW01E,YAAc11E,EAAWmgB,cAAiBngB,EAAW01E,YAAc11E,EAAW01E,YAAyD,oBAAnC,6BAAiD52D,6BAA6Bd,cAAgB,EAAM,EACnNhe,EAAWie,OAAS,GACpBje,EAAWqe,eAAiBe,EAAOf,eACnCre,EAAWoe,eAAiBgB,EAAOhB,eACnCpe,EAAW2d,cAA0D,oBAAnC,6BAAiDmB,6BAA6BlB,iBAAmBwB,EAAOzB,cAC1I3d,EAAW6d,iBAA6D,oBAAnC,6BAAiDiB,6BAA6BhB,eAAiBsB,EAAOvB,iBAC3I7d,EAAWme,YAAc7wB,KAAKqoF,iBAC9B31E,EAAWke,SAAWle,EAAW41E,qBAAsB,EACvD51E,EAAW61E,iBAAmBvoF,KAAKwoF,kBAAkB91E,EAAW2hB,UAChE3hB,EAAW+1E,iBAAmBzoF,KAAK0oF,kBAAkBh2E,EAAW2hB,WAOpE82C,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,UAU9C,OAPWpyD,EAAE0E,SAASxD,GAClB0mD,SALO/kD,KAKQ0S,WAAWqyC,SAC1BnhD,MAAOiJ,OAAOqhD,WANPluD,KAMyB2tE,kBAAoB,GACpD1jE,KAAM4C,OAAOY,KAAK62B,kBAAoB,MAAQ,OAC9CtgC,SAA6B,cARtBhE,KAQQ6jE,aASvB1/D,WAAY,WACGnE,KAENsN,SAEL,IAAImF,EAJOzS,KAIQ0rE,aACfh5D,EALO1S,KAKW0S,WALX1S,KAON2oF,aAAel2E,EAAQnP,KAAK,SAPtBtD,KAUN2oF,aAAaj5C,QAVP1vC,KAUoB0S,WAAW2d,eAGhB,WAAtB3d,EAAWwyD,QAbJllE,KAcF4oF,sBAObxiB,kBAAmB,WAEfpmE,KAAK6oF,wBAMTC,kBAAmB,YACJ9oF,KAAK0gC,mBAAmBtD,QAAUp9B,KAAK0gC,oBAE7Cq4B,2BAOT6vB,mBAAoB,aAOpBC,qBAAsB,WAClB,IAAI9oF,KAAOC,KACP0S,WAAa3S,KAAK2S,WAClBgE,QAAU7J,OAAOC,aAAaC,YAAY,6BAC9ChN,KAAKqgE,cAAgBrgE,KAAKqgE,gBAAiB,EAGM,MAA7CjjE,EAAE40B,eAAeqe,QAAQvjC,OAAOyS,YAChCniB,EAAE40B,eAAeqe,QAAQvjC,OAAOyS,UAAYtf,KAAK+M,YAAY,kBAGjEhN,KAAK4oF,aAAa54C,KAAK,gBAC0C,IAAjDhwC,KAAK2gC,mBAAuC,uBAAkB3gC,KAAK2gC,mBAAmB2jC,qBAAuB,IAAIx3D,OAAOsqD,QAAQpxB,YAAY8xC,WAAW93E,KAAK2gC,mBAAoB3gC,KAAK23D,cACjM,IAAI2M,EAAuBtkE,KAAK2gC,mBAAmB2jC,sBAAwBtkE,KAAK2gC,mBAAmBtD,OAAOinC,qBACtG/zC,EAAmB,IACnBy4D,EAAsB,IACmB,oBAAlC,8BACPz4D,EAAmBvwB,KAAKgN,YAAY,iBAAiBsjB,eAAiB,IACtE04D,EAAsBhpF,KAAKgN,YAAY,iBAAiBwjB,kBAAoB,MAG5ED,EAAmBkB,6BAA6BlB,iBAChDy4D,EAAsBv3D,6BAA6BhB,gBAGvD,IAAIw4D,EAAWjpF,KAAKkpF,cAChBC,EAAWnpF,KAAKopF,cAEjBz2E,WAAWygB,YAAWpzB,KAAK4oF,aAAav5E,IAAIrP,KAAK4oF,aAAav5E,MAAMzK,QAAQ,IAAK,KACpF,IAAIykF,EAAarpF,KAAK4oF,aAAav5E,MAEnCg6E,GADAA,EAAkC,KAApB94D,EAA2B84D,EAAWzkF,QAAQ,QAAS,IAAMykF,EAAWzkF,QAAQ,QAAS,KAC/EA,QAAQ+N,WAAWie,OAAQ,KAGK,IADxDy4D,EAAav8E,OAAOY,KAAKkO,WAAWytE,EAAYL,EAAqB,KACtDj4E,WAAW5G,QAAQomB,KACN,KAApBA,IAAyB84D,EAAaA,EAAWzkF,QAAQ,mCAAoC,OACzE,KAApB2rB,IAAyB84D,EAAaA,EAAWzkF,QAAQ,mCAAoC,QAGnFuD,MAAdkhF,GAA2BA,EAAWlkF,OAAS,GAAGnF,KAAK4oF,aAAav5E,IAAIg6E,GAExE,SAASl3E,KAAKk3E,KACdA,EAAaA,EAAWzkF,QAAQ,SAAU,OAC1C5E,KAAK4oF,aAAav5E,IAAIg6E,IAG1B,IAAIC,EAAcD,EAAWzkF,QAAQ,WAAY,IAAIO,OACjDkkD,EAAQrpD,KAAK2S,WAAWmO,MACxByoE,EAASvpF,KAAK4oF,aAAav5E,MAG/B,GAA6B,MAAxBrP,KAAKwpF,iBAAmD,GAAxBxpF,KAAKwpF,iBACpB,IAAdH,IAAoF,IAA/D,IAAK,IAAK,IAAK,IAAK12E,WAAWie,QAAQzmB,QAAQk/E,GAIxE,OAHArpF,KAAKgyC,SAAS,IACdhyC,KAAK2rE,aAAapoE,KAAK,SAAS8L,IAAI,SACpCrP,KAAK4oF,aAAav5E,IAAI,IAI1B,GAAoC,IAAhCvC,OAAOY,KAAKyP,KAAKksE,GAArB,CAMA,IAAII,EAAYppE,WAAWgpE,EAAWzkF,QAAQ,IAAK,MAmBnD,GAlBI8X,MAAM+sE,KACNA,EAAYzpF,KAAK4oF,aAAan3C,YAI9B96B,aADaxO,IAAb8gF,GAAsC,MAAZA,GAAoBQ,EAAYR,EAChDn8E,OAAOC,aAAaC,YAAY,qCACrC4O,WAAW,UAAWjJ,WAAWynC,YAAc,KAAOmvC,EAAS,KAC/D3tE,WAAW,aAAcqtE,EAASl4E,YAElCo4E,MAAAA,GAA+CM,EAAYN,EACtDr8E,OAAOC,aAAaC,YAAY,qCACrC4O,WAAW,UAAWjJ,WAAWynC,YAAc,KAAOmvC,EAAS,KAC/D3tE,WAAW,aAAcutE,EAASp4E,YAE7B4F,QAAU,IAAM4yE,EAKzBN,MAAAA,GAA+CQ,EAAYR,GACxDE,MAAAA,GAA+CM,EAAYN,GAC/B,IAA5BnpF,KAAK2S,WAAW2hB,UAAkBg1D,EAAc,IACpB,GAA5BtpF,KAAK2S,WAAW2hB,UAAiBg1D,EAAc,IACnB,IAA5BtpF,KAAK2S,WAAW2hB,UAAkBg1D,EAAc,GACpB,IAA5BtpF,KAAK2S,WAAW2hB,UAAkBg1D,EAAc,GAChDC,EAAOxrE,MAAM,kBAPrB,CASI,QAAmC,IAAxBumD,GAA+D,MAAxBA,EAA8B,CAC5EtkE,KAAK+oF,oBAEL,IAAIW,EAAgB/yE,SACkB,IAAnC+yE,EAAcv/E,QAAQo/E,KACrBG,EAAgB/yE,QAAU,IAAM4yE,GAGpCjlB,EAAqB3L,sBAAsB+wB,EAAergC,GAC1DrpD,KAAKqgE,eAAgB,EACrBrgE,KAAK2pF,qBAAuBD,EAEhC/yE,QAAUA,QAAQ/R,QAAQ2kF,EAAQ,SAIlCvpF,KAAKqgE,eAAgB,EACrBrgE,KAAK2pF,qBAAuB,GAI5B1pF,KAAK4D,MAAMkN,WAAW5L,OAAS,IAAMwN,WAAWmgB,gBAAkBngB,WAAWme,aAC7E7wB,KAAK4D,MAAQ5D,KAAK4D,MAAMkN,WAAWnM,QAAQ,MAAO,IAC9C+N,WAAWie,OAAOzrB,OAAS,IAAGlF,KAAK4D,MAAQ5D,KAAK4D,MAAMkN,WAAWnM,QAAQ+N,WAAWie,OAAS,IAAKje,WAAWie,SACjH3wB,KAAK4D,MAAQ5D,KAAK4D,MAAMkN,WAAWnM,QAAQ,MAAO,IACL,GAAzC3E,KAAK4D,MAAM+X,WAAW,IAAK,IAAIzW,OAC/BlF,KAAK4D,MAAQ8O,WAAWie,OAAS,IAC5B3wB,KAAK4D,MAAMkN,YAAcrM,SAASzE,KAAK4D,SAAQ5D,KAAK4D,MAAQ8O,WAAWie,OAAS3wB,KAAK4D,QAGlE,UAAzB7D,KAAK2S,WAAWzI,MAA6C,WAAzBlK,KAAK2S,WAAWzI,MAA8C,gBAAzBlK,KAAK2S,WAAWzI,MAAmD,iBAAzBlK,KAAK2S,WAAWzI,OAClIjK,KAAK4D,MAAQ5D,KAAK4D,MAAMkN,WAAWnM,QAAQ,MAAO,IAChC,KAAf3E,KAAK4D,QACJ5D,KAAK4D,MAAQ,IAIzB7D,KAAK4pF,8BAGL5pF,KAAKgyC,SAAShyC,KAAK4oF,aAAan3C,UAC5B7gB,OAAQje,WAAWie,OACnBI,eAAgBre,WAAWqe,eAC3BD,eAAgBpe,WAAWoe,eAC3BT,cAAe3d,WAAW2d,cAC1BE,iBAAkB7d,WAAW6d,iBAC7BM,YAAane,WAAWme,eAGxBne,WAAWygB,YACPpzB,KAAK4oF,eAAyD,GAAzC5oF,KAAK4oF,aAAav5E,MAAMlF,QAAQ,MACrDnK,KAAK4oF,aAAav5E,IAAIrP,KAAK4oF,aAAav5E,MAAQ,KAExDsH,QAAUA,QAAQ/R,QAAQ2kF,EAAQ,SAtF9BvpF,KAAKgyC,SAAS,MA0FjB/sC,KAAK,QAAS,SAAUiJ,GACrB,IACI,IAAI27E,QAAW/8E,OAAOY,KAAK6P,QAAUzQ,OAAOY,KAAKkQ,SAAYU,OAAOwrE,cAAcznF,QAAQ,QAAU6L,EAAE6lC,cAAc+1C,cAAcznF,QAAQ,QAKtI0nF,SAAW,SACXp3E,WAAW2d,cAAcnrB,OAAS,IAClC4kF,UAAYp3E,WAAW2d,eAGA,GAAvB3d,WAAW2hB,WACP3hB,WAAWie,OAAOzrB,OAAS,IAC3B4kF,UAAYp3E,WAAWie,QAEvBje,WAAW6d,iBAAiBrrB,OAAS,IACrC4kF,UAAYp3E,WAAW6d,mBAG/Bu5D,UAAY,aACZ,IACQF,QAAQjlF,QAAQsM,KAAK64E,UAAW,IAAI5kF,QAAU0kF,QAAQ1kF,QACtD+I,EAAE4lC,iBAEV,MAAO5lC,KAGX,MAAOA,GACHpB,OAAO6T,IAAI,4BACX3gB,KAAKwpF,iBAAkB,KAI9BQ,QAAQ,SAAU97E,GACflO,KAAKypE,cAAgBxpE,KAAK4D,MAE1B,IAAIomF,GADJ/7E,EAAKoQ,OAAOqI,OAASrI,OAAOqI,MAAMmtB,eAAkBx1B,OAAOqI,MAAQzY,GAChDqgC,UAAYrgC,EAAE6/B,QAOjC,GAL6C,oBAAlC,8BAC2C,GAA9Ctc,6BAA6Bd,gBAAoBhe,WAAWmgB,eAAgB,IAChFngB,WAAW2hB,SAAW,GAA6B,GAAvB3hB,WAAW2hB,UAA6C,GAA5B3hB,WAAWmgB,iBACjD,KAAdm3D,GAAmC,KAAdA,GAAmC,KAAdA,GAC1C/7E,EAAE4lC,kBACN7zC,KAAK4D,YACKsE,IAAN+F,GAAmBjO,KAAK4D,MAAMsB,OAAS,IAA6B,GAAvBwN,WAAW2hB,UAAwC,IAAvB3hB,WAAW2hB,UAEpF,GAAI21D,EAAa,IAAMA,EAAa,GAAI,CAChCjqF,KAAKkqF,eACLjoF,aAAajC,KAAKkqF,eAGtB,IAAIC,EAAYlqF,KAAK4D,MAAQ,GAEzB8O,WAAW6d,kBAAoB7d,WAAW6d,iBAAiBrrB,OAAS,IACpEglF,EAAYA,EAAUvuE,WAAWjJ,WAAW6d,iBAAkB,KAE9D7d,WAAWie,OAAOzrB,OAAS,IAC3BglF,EAAYA,EAAUvuE,WAAWjJ,WAAWie,OAAQ,KAGxDu5D,EAAY/sF,EAAE+f,KAAKgtE,GACfx3E,WAAW2d,eAAiB3d,WAAW2d,cAAcnrB,OAAS,IAC9DglF,EAAYA,EAAUvuE,WAAWjJ,WAAW2d,cAAe,MAG/C,GAAZ65D,EAAiBx3E,WAAW+1E,kBAC5Bx6E,EAAE4lC,sBAGL,GAAkB,KAAdm2C,GAAmC,KAAdA,EAC1B,GAA2B,GAAvBhqF,KAAKioC,gBAAuBjoC,KAAKwvC,cAAgBxvC,KAAK4D,MAAMsB,OAAQ,CACpE,IAAIilF,EAAkBnqF,KAAKwvC,aAC3BxvC,KAAK4D,MAAQ8O,WAAWie,OAAS,IAAM3wB,KAAK4D,MAAMe,QAAQ+N,WAAWie,OAAQ,IAC7E3wB,KAAKioC,eAAiBjoC,KAAKwvC,aAAe26C,EAAkB,OAC9B,GAAvBnqF,KAAKioC,gBAAuBjoC,KAAKwvC,cAAgBxvC,KAAK4D,MAAMsB,SACnElF,KAAK4D,MAAQ,IACb5D,KAAKioC,eAAiBjoC,KAAKwvC,aAAexvC,KAAK4D,MAAMsB,UAMxEo0C,MAAM,SAAUrrC,GAEb,IAAI+7E,GADJ/7E,EAAIoQ,OAAOqI,OAASzY,GACDqgC,UAAYrgC,EAAE6/B,QACjC,QAAU5lC,IAAN+F,EACA,OAAQ+7E,GACJ,KAAK,GAEL,KAAK,GAEL,KAAK,GAEL,KAAK,GACD,MACJ,KAAK,GACDhqF,KAAK4D,MAAQ,MA4B1BgsC,SAAS,SAAU3hC,GAEtB,IAAI+7E,GADJ/7E,EAAKoQ,OAAOqI,OAASrI,OAAOqI,MAAMmtB,eAAkBx1B,OAAOqI,MAAQzY,GAChDqgC,UAAYrgC,EAAE6/B,QACjC,QAAmB,IAAR,EAAqB,CACV,IAAdk8C,GAAkC,IAAdA,GAAkC,IAAdA,EACxC/7E,EAAE4lC,iBAC4B,GAAvBnhC,WAAW2hB,UAA+B,IAAd21D,GACnC/7E,EAAE4lC,iBAIN,IAAIu2C,EAAY56E,OAAOsJ,aAAakxE,IACH,IAA7Bt3E,WAAWmgB,eAAsD,IAA3BngB,WAAW01E,aAAqBgC,IAAc13E,WAAW2d,eAC/FpiB,EAAE4lC,qBAMlB81C,4BAA6B,WACzB,IACIj3E,EADO1S,KACW0S,WAetB,GAhBW1S,KAGF2oF,cAHE3oF,KAIF2oF,aAAa52D,gBACdpB,OAAQje,EAAWie,OACnBI,eAAgBre,EAAWqe,eAC3BD,eAAgBpe,EAAWoe,eAC3BT,cAAe3d,EAAW2d,cAC1BE,iBAAkB7d,EAAW6d,iBAC7BM,YAAane,EAAWme,YACxBJ,oBAAqB/d,EAAW01E,YAChCx3D,SAAUle,EAAWke,WAID,IAAxBle,EAAW2hB,WAA0D,IAAxCxnB,OAAOwkB,SAASC,oBAA8B,CAC3E,IAAI1tB,EAjBG5D,KAiBU2oF,aAAav5E,MAC1BmiB,GAAW,GAEa,IAAxB3tB,EAAMsG,QAAQ,OACdqnB,GAAW,EACX3tB,EAAQA,EAAMe,QAAQ,IAAK,IAAIA,QAAQ,IAAK,KAGhD,IAAI0lF,EAAS,IAAI57E,OAAO,IAAMiE,EAAW2d,cAAgB,iBAAkB,KAC3EzsB,EAAQA,EAAMe,QAAQ0lF,EAAQ,MAE9BA,EAAS,IAAI57E,OAAO,KAAOiE,EAAW2d,cAAgB,MAAO,KAC7DzsB,EAAQA,EAAMe,QAAQ0lF,EAAQ,IA7BvBrqF,KA8BF2oF,aAAav5E,IAAIxL,GAEjB2tB,GAhCEvxB,KAgCa2oF,aAAav5E,IAAI,IAAMxL,EAAQ,KAGnD8O,EAAWygB,YAnCJnzB,KAoCF2oF,aAAav5E,IApCXpP,KAoCoB2oF,aAAav5E,MAAQ,MAOxDu+D,gBAAiB,WACb,IACIj7D,EADO1S,KACW0S,WAClBD,EAFOzS,KAEQ0rE,aACf9nE,OAA4BsE,IAHrBlI,KAGM2S,WAHN3S,KAGsC2S,WAAaxV,EAAE,QAASsV,GAASrD,OAAS,GAGvFpO,EAAQ7D,EAAE,YAAYoG,KAAKK,GAiB/B,GAfA5C,EAAM+wB,gBACFpB,OAAQje,EAAWie,OACnBI,eAAgBre,EAAWqe,eAC3BD,eAAgBpe,EAAWoe,eAC3BT,cAAe3d,EAAW2d,cAC1BE,iBAAkB7d,EAAW6d,iBAC7BM,YAAane,EAAWme,YACxBJ,oBAAqB/d,EAAW01E,YAChCx3D,SAAUle,EAAWke,WAGrBle,EAAWygB,aACXnyB,EAAQ7D,EAAE,YAAYoG,KAAKvC,EAAMmR,OAAS,OAGzCO,EAAWqyC,UAAoC,IAAxBryC,EAAW2hB,WAA0D,IAAxCxnB,OAAOwkB,SAASC,oBAA8B,CAEnG,IAAIC,GAAW,GAEwB,KAHvC3tB,EAAQ5C,EAAMmR,QAGJrB,WAAW5G,QAAQ,OACzBqnB,GAAW,EACX3tB,EAAQA,EAAMe,QAAQ,IAAK,IAAIA,QAAQ,IAAK,KAGhD,IAAIqX,EAAK,IAAIvN,OAAO,IAAMiE,EAAW2d,cAAgB,iBAAkB,KAOvE,OANAzsB,EAAQA,EAAMe,QAAQqX,EAAI,MAE1BA,EAAK,IAAIvN,OAAO,KAAOiE,EAAW2d,cAAgB,MAAO,KACzDzsB,EAAQA,EAAMe,QAAQqX,EAAI,IAErBuV,IAAU3tB,EAAQ,IAAMA,EAAQ,KAC9BA,EAGX,OAAO5C,EAAMmR,QAQjBnI,QAAS,SAAU0vD,GACf,IAMIhjD,EALAhE,EADO1S,KACW0S,WAGlBgoD,EAAS16D,KAAKsN,OAAOosD,GACrB91D,EALO5D,KAKM2S,WAEbq2E,EAPOhpF,KAOSipF,cAChBC,EAROlpF,KAQSmpF,cA0BpB,GAxBsB,iBAAX,GAAgC,IAATvlF,IAC9BA,EAAQiG,OAAOjG,IAXR5D,KAeFssE,aACAz/D,OAAOY,KAAKqT,QAAQkoE,IACjBplF,EAAQolF,IACRtyE,EAAU1W,KAAK+M,YAAY,qCAAqC4O,WAAW,UAAWjJ,EAAWynC,YAAYrpC,WAAa,KAAOlN,EAAQ,KAAK+X,WAAW,aAAcqtE,EAASl4E,YAChL4oD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,GAIZ7tD,OAAOY,KAAKqT,QAAQooE,IACjBtlF,EAAQslF,IACRxyE,EAAU1W,KAAK+M,YAAY,qCAAqC4O,WAAW,UAAWjJ,EAAWynC,YAAYrpC,WAAa,KAAOlN,EAAQ,KAAK+X,WAAW,aAAcutE,EAASp4E,YAChL4oD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,OAMM,IAlChB16D,KAkCFogE,eAA6B1F,GAAU7tD,OAAOY,KAAKyyB,kBAAmB,CAC3Ew6B,GAAS,EACT,IAAI4vB,EApCGtqF,KAoCiB0pF,qBApCjB1pF,KAoC6C0pF,qBAAuB,QAC3EhwB,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAAS4zE,IAG5D,OAAO5vB,GAOXuuB,YAAa,WACT,IAAID,EAAWhpF,KAAK0S,WAAWs2E,SAE/B,OAAIA,MAAAA,EACOA,EAEJhpF,KAAK0S,WAAW61E,kBAO3BY,YAAa,WACT,IAAID,EAAWlpF,KAAK0S,WAAWw2E,SAE/B,OAAIA,MAAAA,EACOA,EAEJlpF,KAAK0S,WAAW+1E,kBAQ3BN,wBAAyB,SAAU9zD,GAC/B,GAAIA,EAAU,CAEV,GAAiB,IAAbA,GAA+B,IAAbA,GAA+B,IAAbA,GAA+B,IAAbA,GAA+B,IAAbA,EACxE,OAAO,EAGX,GAAiB,IAAbA,GAA+B,IAAbA,GAA+B,KAAbA,GAAgC,KAAbA,EACvD,OAAO,EAGf,OAAO,GAOXk2D,sBAAuB,SAAUl2D,GAC7B,GAAIA,EAAU,CAEV,GAAiB,IAAbA,GAA+B,IAAbA,GAA+B,IAAbA,GAA+B,IAAbA,GAA+B,IAAbA,EACxE,OAAO,EAIX,GAAiB,IAAbA,GAA+B,IAAbA,GAA+B,KAAbA,GAAgC,KAAbA,EACvD,OAAO,EAGf,OAAO,GAOXg0D,eAAgB,WAEZ,YAA2C,IADhCroF,KACM0S,WAAoB,YAD1B1S,KAEE0S,WAAW6d,kBACT1jB,OAAOY,KAAKuF,aAHhBhT,KAGkC0S,WAAWsgB,aAH7ChzB,KAOK0S,WAAW6d,kBAChBvwB,KAAKuqF,sBARLvqF,KAQgC0S,WAAW2hB,WAW1Dm0D,kBAAmB,SAAUn0D,GACzB,OAAiB,IAAbA,GAA+B,KAAbA,GACV,gBAEK,IAAbA,EACO,EAEM,IAAbA,GACQ,MAEK,IAAbA,GACQ,WAEK,IAAbA,GACQ,gBAEL,MAQXq0D,kBAAmB,SAAUr0D,GACzB,OAAiB,IAAbA,GAA+B,KAAbA,EACX,gBAEM,IAAbA,EACO,IAEM,IAAbA,EACO,MAEM,IAAbA,EACO,WAEM,IAAbA,EACO,gBAEJ,MAGX6sC,eAAgB,SAAUt9D,GACtB,IACI4mF,EAAW3gF,OAAOjG,GADX5D,KAGN0S,WAAWs2E,SAHLhpF,KAGqB0S,WAAW61E,iBAAmB1+E,OAAO4S,MAAM+tE,GAHhExqF,KAGiFwoF,kBAHjFxoF,KAGwG0S,WAAW2hB,UAAYm2D,GAG9InpB,eAAgB,SAAUz9D,GACtB,IAAI4mF,EAAW3gF,OAAOjG,GAEtB5D,KAAK0S,WAAWw2E,SAAWlpF,KAAK0S,WAAW+1E,iBAAmB5+E,OAAO4S,MAAM+tE,GAAYxqF,KAAK0oF,kBAAkB1oF,KAAK0S,WAAW2hB,UAAYm2D,GAG9IC,cAAe,SAAUh4E,EAAS20E,EAAcsD,GAC5Cj4E,EAAQ5U,KAAK,WAAYupF,GACzB30E,EAAQrD,IAAI,IAEZ,IAEIqD,EAAQvR,QAAQ,WAClB,MAAO+M,IAGTwE,EAAQnR,KAAK,QAASopF,GACtBj4E,EAAQvR,UAER,IAAIypF,EAAgBxtF,EAAEgW,eACtBV,EAAQvR,UAAUuL,GAAG,cAAe,SAAUia,EAAOna,GACjDA,EAAGrL,QAAQ4D,OAAO6lF,KAItBl4E,EAAQvR,QAAQ,QAEhBY,WAAW,WACP2Q,EAAQ40B,SACT,QCzrBXlqC,EAAEklD,MAAM57C,OAAO,6CAIX08D,eAAgB,SAAStlE,GAIrBmC,KAAKsN,OAAOzP,GAHDmC,KAMW0S,WAEX2d,cAA0D,oBAAnC,6BAC5BmB,6BAA6BlB,iBAAmBwB,OAAOzB,eAGjE86C,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,4BAI9C,OADWpyD,EAAE0E,SAASxD,OAO1B8F,WAAY,WACR,IACIsO,EADOzS,KACQ0rE,aADR1rE,KAEN2oF,aAAel2E,EAAQnP,KAAK,SAFtBtD,KAIN2oF,aAAa34C,UAJPhwC,KAIsB0S,WAAW2d,gBAIhDs9C,gBAAiB,WAEb,OADW3tE,KACC2S,WAAWhO,QAAQ,IADpB3E,KAC8B0S,WAAW2d,gBAGxD0hB,SAAU,SAASnuC,GAEfA,GAASA,GAAS,IAAIkN,WAAWnM,QADtB3E,KACmC0S,WAAW2d,cAAe,KAD7DrwB,KAENsN,OAAO1J,IAEhB4O,sBAAuB,WACnB,IACIE,EADO1S,KACW0S,WAClB9O,EAFO5D,KAEM2S,YAAc,GAC3BC,EAAeF,EAAWG,eAAiB,GAI/C,QAAI1V,EAAE2V,kBAGIF,EAAanC,eAAiB7M,EAAM6M,iBC5DtDtT,EAAEklD,MAAM57C,OAAO,4BAKX08D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAClBsC,EAAahV,KAAK+M,YAAY,cAC9BkrB,EAAaj4B,KAAK+M,YAAY,cAiBlC,GAdA2F,EAAWg7D,aAAe,GAC1Bh7D,EAAW8lB,cAAmCtwB,IAAxBwK,EAAW8lB,UAAyB3rB,OAAOY,KAAKuF,aAAaN,EAAW8lB,UAC9F9lB,EAAWsC,WAAatC,EAAWsC,YAAcA,EACjDtC,EAAWulB,WAAavlB,EAAWulB,YAAcA,EACjDvlB,EAAWk4E,WAAal4E,EAAWsC,WAG/BtC,EAAW8lB,WACuC,IAA9C9lB,EAAWk4E,WAAW95C,OAAO,cAC7Bp+B,EAAWk4E,WAAal4E,EAAWk4E,WAAa,IAAMl4E,EAAWulB,YAKrEvlB,EAAW9O,MAAO,CAElB,IAAIkxB,EAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB7lB,EAAW9O,MAAO8O,EAAW8lB,UAEvF,GAAY,GAAR1D,EAAW,CA5BR90B,KA8BE4D,MAAQ8O,EAAW9O,MACxB,IAAIinF,EAAqBh+E,OAAOC,aAAaC,YAAY,sBACzD2F,EAAWg7D,aAAe7gE,OAAOY,KAAKgmB,cAAcD,WAAWsB,EAAMpiB,EAAWk4E,WAAYC,QAhCzF7qF,KAkCE4D,MAAQ,OAQzBunE,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,QAC1Cu7B,EAA0Bp4E,EAAWsC,WAAWwJ,UAAU,EAAG9L,EAAWsC,WAAW9K,QAAQ,MAAM6gF,YAAY,KAC7G/1E,EAAc81E,EAA0B,EAAKp4E,EAAWsC,WAAWwJ,UAAU,EAAGssE,GAA2Bp4E,EAAWsC,WAY1H,OATW7X,EAAE0E,SAASxD,GAClBm6B,SAAU9lB,EAAW8lB,SACrB50B,MAAO8O,EAAW9O,MAClBmhD,SAAUryC,EAAWqyC,SACrB/vC,WAAYnI,OAAOwkB,WAAyD,IAA7CxkB,OAAOwkB,SAAS25D,yBAAoCh2E,EAAWmH,cAAgBnH,EAC9GijB,WAAavlB,EAAW8lB,UAAYsyD,EAA0B,EAAKp4E,EAAWsC,WAAWwJ,UAAUssE,GAA2B,GAC9H1hF,IAAgC,OAA1BsJ,EAAW5O,eASzBsiE,kBAAmB,SAAU6kB,EAAYC,GACrC,IAAInrF,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlBy4E,EAAcprF,EAAKqrF,iBACnBC,EAActrF,EAAKurF,iBAGnB54E,EAAW65B,MACX4+C,EAAY5+C,MACRA,KAAM75B,EAAW65B,OAKzB4+C,EAAYnmF,KAAK,SAAU,WACvBjF,EAAKwrF,oBAEL74E,EAAW8lB,UACX6yD,EAAYrmF,KAAK,SAAU,SAAUiJ,EAAGi9E,GAChCnrF,EAAKyrF,oBACEzrF,EAAKyrF,aAGhBzrF,EAAKwrF,gBAAgBL,MAQjCK,gBAAiB,aAGjB5d,gBAAiB,SAAU/pE,GACvB,IAEI8pE,EADAh7D,EADO1S,KACW0S,WAGtB,IAAKA,EAAWg7D,cAAgB9pE,EAAO,CACnC,IAAIkxB,EAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,EAAO8O,EAAW8lB,UACxEqyD,EAAqBh+E,OAAOC,aAAaC,YAAY,sBACzD2gE,EAAe7gE,OAAOY,KAAKgmB,cAAcD,WAAWsB,EAAMpiB,EAAWk4E,WAAYC,QAEjFnd,EAAe,GAInB,OAAOh7D,EAAWg7D,cAAgBA,GAAgB,IAMtDtG,YAAa,SAAUF,GACnB,IACIx0D,EADO1S,KACW0S,WAGlBmO,EAAQnO,EAAWmO,MACnBjd,EALO5D,KAKM2S,WAEjB,GAPW3S,KAOFwS,0BAEA3F,OAAOY,KAAKqT,QAAQD,GACrB,GAAKhU,OAAOY,KAAKqT,QAAQld,GAUJ,KAAVA,IACPsjE,EAAax0D,EAAWmO,OAAS,QAXJ,CAE7B,IAAIiU,EAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,EAAO8O,EAAW8lB,eACvD,IAAV,GACM,IAAT1D,IACKpiB,EAAW8lB,UACZ1D,EAAK4D,SAAS,EAAG,EAAG,EAAG,GAE3BwuC,EAAax0D,EAAWmO,OAAShU,OAAOY,KAAKgmB,cAAckF,gBAAgB7D,GAAM,MAazGs2D,eAAgB,aAKhBE,eAAgB,aAKhBthF,QAAS,SAAU0vD,GACf,IASYhjD,EARZhE,EADW1S,KACO0S,WAGdgoD,EAAS16D,KAAKsN,OAAOosD,GACrB91D,EALO5D,KAKM2S,WACjB,GAAI/O,KACsD,IAAlDiJ,OAAOY,KAAKuF,aAAaN,EAAWqyC,WAKvB,IAJbnhD,EAAQiJ,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,EAAO8O,EAAW8lB,YAIzD,CAMZ,GAJA50B,EAAMoxD,WAAW,GACjBpxD,EAAMqxD,gBAAgB,GAGlBviD,EAAWs2E,WAA4C,iBAAxBt2E,EAAWs2E,UAAuD,iBAAvBt2E,EAAWs2E,UAAuB,CAC5G,IAAIA,EAAyC,iBAAvBt2E,EAAWs2E,SAAuBn8E,OAAOY,KAAKgmB,cAAc8E,qBAAqB7lB,EAAWs2E,SAAUt2E,EAAW8lB,UAAY,IAAIvlB,KAAKP,EAAWs2E,UACvKA,EAASh0B,WAAW,GACpBg0B,EAAS/zB,gBAAgB,GAErBrxD,EAAQolF,IACRtyE,EAAU1W,KAAK+M,YAAY,kCAAkC4O,WAAW,UAAWjJ,EAAWynC,aAAax+B,WAAW,aAAc9O,OAAOY,KAAKgmB,cAAcD,WAAWw1D,EAAUt2E,EAAWk4E,aAC9LlxB,EAAgB9wD,MACZiY,MAAOnO,EAAWmO,MAClBnK,QAASA,IAEbgkD,GAAS,GAKjB,GAAIhoD,EAAWw2E,WAA2C,iBAAvBx2E,EAAWw2E,UAAsD,iBAAvBx2E,EAAWw2E,UAAuB,CAC3G,IAAIA,EAAyC,iBAAvBx2E,EAAWw2E,SAAuBr8E,OAAOY,KAAKgmB,cAAc8E,qBAAqB7lB,EAAWw2E,SAAUx2E,EAAW8lB,UAAY,IAAIvlB,KAAKP,EAAWw2E,UACvKA,EAASl0B,WAAW,GACpBk0B,EAASj0B,gBAAgB,GAErBrxD,EAAQslF,IACRxyE,EAAU1W,KAAK+M,YAAY,kCAAkC4O,WAAW,UAAWjJ,EAAWynC,aAAax+B,WAAW,aAAc9O,OAAOY,KAAKgmB,cAAcD,WAAW01D,EAAUx2E,EAAWk4E,aAC9LlxB,EAAgB9wD,MACZiY,MAAOnO,EAAWmO,MAClBnK,QAASA,IAEbgkD,GAAS,IAQ7B,GAAIhoD,EAAW8lB,WAC2C,IAAlD3rB,OAAOY,KAAKuF,aAAaN,EAAWqyC,WAEhCryC,EAAWosD,UAxDZ9+D,KAwD6BssE,WAAY,CAGxC,IAAI6e,EA3DLnrF,KA2DwBorF,iBACnBC,EA5DLrrF,KA4DwBsrF,iBAGvB,GAAIH,EAAYjmF,OAAS,GAAKmmF,EAAYnmF,OAAS,GAC3CimF,EAAY/7E,MAAMlK,OAAS,GAAiC,GAA5BmmF,EAAYj8E,MAAMlK,OAMlD,OALAwR,EAjET1W,KAiEwB+M,YAAY,wBAAwB4O,WAAW,UAAWjJ,EAAWynC,aACpFuf,EAAgB9wD,MACZiY,MAAOnO,EAAWmO,MAClBnK,QAASA,KAEN,EAO3B,OAAOgkD,KCvPfv9D,EAAEklD,MAAM57C,OAAO,oCAMX08D,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAGZmC,KAAKm+B,cAAgBtxB,OAAOY,KAAK0wB,eAAexvB,QANrC3O,OAOXA,KAAKyrF,cAAczrF,KAAK0S,WAAWg5E,SAGnC,IAAIh5E,EAAa1S,KAAK0S,WAKtB,GAFAA,EAAWg5E,SAAW1rF,KAAK0S,WAAWg5E,UAAY,EAE9Ch5E,EAAWi5E,4BAA6B,CACxC,IAAIj1E,EAAUhE,EAAWk5E,0BAhBlB5rF,KAgBmD+M,YAAY,kDAEtE2F,EAAWm5E,mBAAqBz4B,WAAc1gD,EAAWi5E,4BAA6Bj1E,QAAWA,KAOzGy0D,cAAe,WACX,IAAI9sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,gBAQ9C,OALWpyD,EAAE0E,SAASxD,GAClBytF,kBAAiD,IAA3B9rF,KAAK0S,WAAgB,MAC3CqyC,SAAU/kD,KAAK0S,WAAWqyC,YASlC5gD,WAAY,WACGnE,KACNsN,SAEL,IAAImF,EAHOzS,KAGQ0rE,aAHR1rE,KAIN+rF,SAAWt5E,EAAQnP,KAAK,YAJlBtD,KAOF+rF,SAPE/rF,KAQF+rF,SAASrnF,KAAK8+D,OAAQ,SARpBxjE,KAUF+rF,SAASrnF,KAAK8+D,OAAQ,SAIA,WAdpBxjE,KAcF0S,WAAWwyD,QAdTllE,KAeF4oF,sBAMbA,mBAAoB,aAMpBxiB,kBAAmB,WACf,IAAIrmE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAIlBA,EAAWy2D,WACXppE,EAAKgsF,SAASzhD,KAAK,YAAa53B,EAAWy2D,WAE3Cz2D,EAAWg5E,SACX3rF,EAAKgsF,SAASzhD,KAAK,OAAQ53B,EAAWg5E,UAEtC3rF,EAAKgsF,SAASzhD,KAAK,OAAQ,GAI/BvqC,EAAKgsF,SAAS/mF,KAAK,SAAU,WAGzBjF,EAAKgyC,SAAShyC,EAAKgsF,SAAS38E,OAG5B,IAAI48E,KACJ,GAA0B,cAAtBt5E,EAAWwyD,OACX,GAAInlE,EAAKiK,QAAQgiF,SAAiE,IAAlCt5E,EAA4B,kBAExE3S,EAAKgyC,SAAShyC,EAAKgsF,SAAS38E,OAAO,OAChC,CAEH,IAAIsH,EAAUs1E,EAAmB,GAAGt1E,QACpC7J,OAAOwtE,eAAe3jE,EAAS,SAAU,YAMrD3W,EAAKgsF,SAAS/mF,KAAK,OAAQ,WAEvBjF,EAAKgyC,SAAShyC,EAAKgsF,SAAS38E,UASpCpF,QAAS,SAAU0vD,GACf,IAEIhjD,EADAhE,EADO1S,KACW0S,WAIlBgoD,EAAS16D,KAAKsN,OAAOosD,GACrB91D,EANO5D,KAMM2S,WACby2B,EAAQ,IAAI36B,OAAO,yDAA0D,KA+BjF,OA5BIzO,KAAKm+B,eAAiBtxB,OAAOY,KAAKyyB,mBAClCt8B,EAAQA,GAA4B,iBAAZ,GAAwBA,EAAMA,MAAQA,EAAMA,MAAQA,GAI5E8O,EAAWm5E,kBAEPjoF,IAAWA,EAAMka,MAAMsrB,KAAaxlC,EAAMka,MAAM,IAAIrP,OAAOiE,EAAWm5E,kBAAkBz4B,cAjBrFpzD,KAiB2G0S,YAAwC,aAjBnJ1S,KAiB8H0S,WAAWmO,QAC5InK,EAAUhE,EAAWm5E,kBAAkBn1E,QACvCgjD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,IAEL92D,IAAWA,EAAMka,MAAMsrB,IAAaxlC,EAAMka,MAAM,IAAIrP,OAAOiE,EAAWm5E,kBAAkBz4B,eACxF18C,EAAUhE,EAAWm5E,kBAAkBn1E,QACvCgjD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,GAIb92D,GAAUA,EAAMka,MAAM,IAAIrP,OAAO,aAAc,OAAW7K,EAAMka,MAAM,IAAIrP,OAAO,iBAAkB,OAC/FiE,EAAWqyC,WACXruC,EAAU1W,KAAK+M,YAAY,kDAC3B2sD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,GAKdA,GAQXqG,gBAAiB,SAAUn9D,GACvB,IACI6O,EADOzS,KACQ0rE,aACfnqD,EAAe1U,OAAOY,KAAK2T,UAAUxd,GAEzC,GAAgC,GAJrB5D,KAIF0S,WAAWqyC,UAEM,iBAAX,EAAqB,CAG5B,IAAI9d,EAAiBp6B,OAAOY,KAAKu5B,oBAT9BhnC,KASuD2tE,mBAE1Dl7D,EAAQlP,KAAK0jC,GAXVjnC,KAgBN+xC,SAASxwB,GAAc,IAQhC6lD,YAAa,SAAUF,GAEnBlnE,KAAKsN,OAAO45D,IAShBn1B,SAAU,SAAUnuC,GAChB,IAAI2d,EAAe1U,OAAOY,KAAK2T,UAAUxd,GAEzC5D,KAAKsN,OAAOiU,IAShBkpE,cAAe,SAAUh4E,EAAS20E,EAAcsD,GAC5Cj4E,EAAQ5U,KAAK,WAAYupF,GACzB30E,EAAQrD,IAAI,IAEZ,IAEIqD,EAAQvR,QAAQ,WAClB,MAAO+M,IAGTwE,EAAQnR,KAAK,QAASopF,GACtBj4E,EAAQvR,UAER,IAAIypF,EAAgBxtF,EAAEgW,eACtBV,EAAQvR,UAAUuL,GAAG,cAAe,SAAUia,EAAOna,GACjDA,EAAGrL,QAAQ4D,OAAO6lF,KAItBl4E,EAAQvR,QAAQ,QAEhBY,WAAW,WACP2Q,EAAQ40B,SACT,MAUPygD,cAAe,SAAUlkF,EAAOulE,GAC5B,OAAGA,EAAU,GAAKvlE,EAAMsB,QAAQikE,EAAiBvlE,EAC1CA,EAAMgV,OAAO,EAAGuwD,MC5P/BhsE,EAAEklD,MAAM57C,OAAO,4BAKX08D,eAAgB,SAAUtlE,GACtB,IAAIkC,EAAOC,KAEXD,EAAKksF,aAAep/E,OAAO8K,MAAM9Z,EAAK6U,YAEtC1S,KAAKsN,OAAOzP,GAGZ,IAKIquF,EACAC,EANAz5E,EAAa1S,KAAK0S,WAEtB3S,EAAKqsF,iBAKLrsF,EAAKxC,WACLwC,EAAKu3E,cACLv3E,EAAKssF,iBACLtsF,EAAKusF,oBACLvsF,EAAKwsF,yBACLpvF,EAAE0D,KAAKhD,EAAK+mE,SAAU,SAAU9jE,EAAGpC,GAC/B,IAAIyH,EAAmBzH,EAAO8/C,OAAO9rC,WAWrC,GARIvM,EAAiBqmF,UACjB95E,EAAW85E,QAAUrmF,EAAiB0a,OAAS,GAC/CnO,EAAWmzC,eAAiBh5C,OAAOY,KAAKqT,QAAQpO,EAAW85E,UAEjC,gBAA1BrmF,EAAiB8D,MACjBlK,EAAK0sF,cAAc5uF,EAAK6U,WAAW7U,KAAMiD,EAAI,GAGnB,kBAA1BqF,EAAiB8D,MAA4B9D,EAAiBumF,YAAa,CAEhEvmF,EAAiB0a,MAE5B,GAAIhjB,EAAK6U,WAAW7U,KAAM,CACtBkC,EAAKssF,cAAclmF,EAAiB0a,UACpC,IAAK,IAAIve,EAAI,EAAGA,EAAIzE,EAAK6U,WAAW7U,KAAKwE,KAAK6C,OAAQ5C,IAAK,CACvD,IAAI1D,EAAMf,EAAK6U,WAAW7U,KAAKwE,KAAKC,GAChC2mC,EAAOrqC,EAAIkC,EAAI,GACfmoC,IACAlpC,EAAKwsF,sBAAsB3jF,KAAKhK,EAAI,IACpCmB,EAAKssF,cAAclmF,EAAiB0a,OAAOjY,MAAMhK,EAAI,GAAIqqC,OAOpElpC,EAAK2S,WAAWuyD,aACjBvmE,EAAO8/C,OAAO9rC,WAAWqyC,UAAW,GAIxC,IAAI4nC,EAAe5sF,EAAK+iE,cAAcjO,WAClC5qD,KAAM9D,EAAiB8D,KACvBpM,KAAMa,EAAO8/C,OACbphB,OAAQr9B,EACR6sF,eAAgBl6E,EAAWk6E,iBAG/B7sF,EAAKxC,QAAQqL,KAAK+jF,GAClB5sF,EAAKu3E,WAAW1uE,KAAKlK,EAAO8/C,OAAO9rC,WAAWpV,IAE1C6I,EAAiB4+C,WACjBmnC,GAA0B,GAG1B/lF,EAAiB0mF,UAAY1mF,EAAiB0mF,SAASliF,YACvDwhF,GAA2B,EAG3BhmF,EAAiB0mF,SAAS/6D,OAAS3rB,EAAiB0mF,SAAS/6D,WAC7D3rB,EAAiB0mF,SAAS/6D,OAAO66C,UAAiDzkE,IAA1C/B,EAAiB0mF,SAAS/6D,OAAO66C,MAAqBxmE,EAAiB0mF,SAAS/6D,OAAO66C,QAKxG,QAA3Bj6D,EAAW5O,cACX/D,EAAKxC,QAAUwC,EAAKxC,QAAQuvF,WAG5Bp6E,EAAWuyD,aAAeinB,IAC1Bx5E,EAAWuyD,YAAa,EACxBvyD,EAAWkzC,WAAY,GAIvBumC,IACAz5E,EAAWhV,aAAc,EACzBgV,EAAWq6E,YAAc,IAIjCX,eAAgB,WACZ,IAAIrsF,EAAOC,KACPwlD,EAAOzlD,EAAK2gC,mBACZhuB,EAAa3S,EAAK2S,WAKtBA,EAAWqyC,SAAWl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,YAAa,EACvEryC,EAAWkzC,UAA8D,MAAlD/4C,OAAOY,KAAKuF,aAAaN,EAAWkzC,YAAqB/4C,OAAOY,KAAKuF,aAAaN,EAAWkzC,WACpHlzC,EAAWuyD,WAAgE,MAAnDp4D,OAAOY,KAAKuF,aAAaN,EAAWuyD,aAAsBp4D,OAAOY,KAAKuF,aAAaN,EAAWuyD,YACtHvyD,EAAWwsE,aAAoE,MAArDryE,OAAOY,KAAKuF,aAAaN,EAAWwsE,eAAwBryE,OAAOY,KAAKuF,aAAaN,EAAWwsE,cAK1HxsE,EAAWgzC,SAA4D,MAAjD74C,OAAOY,KAAKuF,aAAaN,EAAWgzC,WAAoB74C,OAAOY,KAAKuF,aAAaN,EAAWgzC,UAClHhzC,EAAW25D,YAAa35D,EAAmB,WAAuD,MAAlD7F,OAAOY,KAAKuF,aAAaN,EAAW25D,YAAsBx/D,OAAOY,KAAKuF,aAAaN,EAAW25D,YAG9I35D,EAAWizC,YAAkE,MAApD94C,OAAOY,KAAKuF,aAAaN,EAAWizC,cAAuB94C,OAAOY,KAAKuF,aAAaN,EAAWizC,aAGxHjzC,EAAWysE,YAAkE,MAApDtyE,OAAOY,KAAKuF,aAAaN,EAAWysE,cAAuBtyE,OAAOY,KAAKuF,aAAaN,EAAWysE,aAGxHzsE,EAAWs6E,UAAY,GACvBt6E,EAAW7U,KAAO6U,EAAW7U,MAAQ,KACrC6U,EAAWg3D,YAAc,QACzBh3D,EAAWu6E,gBAAkBv6E,EAAWu6E,kBAAmB,EAC3Dv6E,EAAWhT,UAAYmN,OAAOY,KAAKuF,aAAaN,EAAWhT,aAAc,EACzEgT,EAAWw6E,YAAcrgF,OAAOY,KAAKuF,aAAaN,EAAWw6E,eAAgB,EAC7Ex6E,EAAWmzC,eAAgB,EAC3BnzC,EAAW85E,QAAU,GACrB95E,EAAWy6E,aAAez6E,EAAWy6E,cAAgB,KACrDz6E,EAAW06E,UAAYptF,KAAK+M,YAAY,0BACxC2F,EAAW26E,eAAiBxgF,OAAOY,KAAKuF,aAAaN,EAAW26E,kBAAmB,EACnF36E,EAAW46E,WAAa56E,EAAW46E,YAAc,MACjD56E,EAAW66E,aAAe1gF,OAAOY,KAAKuF,aAAaN,EAAW66E,eAAiB,QAC/E76E,EAAWtU,eAAiByO,OAAOY,KAAKuF,aAAaN,EAAWtU,kBAAmB,EAEnFsU,EAAWlV,OAASkV,EAAWlV,OAASkV,EAAWlV,OAASkV,EAAW7U,MAAQ6U,EAAW7U,KAAK0/B,KAAO7qB,EAAW7U,KAAK0/B,KAAO7qB,EAAWs6E,UACxIt6E,EAAW9L,eAAqCsB,IAAzBwK,EAAW9L,WAAoD,OAAzB8L,EAAW9L,UAA+C,SAAzB8L,EAAW9L,UAAuB,MAAQ,OAAU8L,EAAW7U,MAAQ6U,EAAW7U,KAAKoqD,MAAQv1C,EAAW7U,KAAKoqD,MAAQ,MACrNv1C,EAAW6qB,KAAO7qB,EAAWlV,OAAS,IAAMkV,EAAW9L,UAEvD8L,EAAWq6E,YAAcr6E,EAAWmzC,cAAgB,IAAQnzC,EAAWq6E,aAAe,GACtFr6E,EAAWxS,KAAO,EAClBwS,EAAW3J,QAAU,EACrB2J,EAAWrS,WAAa,EAExBqS,EAAW86E,SAAW96E,EAAW86E,UAAYxtF,KAAK+M,YAAY,yBAA2B2F,EAAWynC,YACpGznC,EAAW0nC,UAAY1nC,EAAW0nC,WAAaj9C,EAAE+f,KAAKld,KAAK+M,YAAY,2BAA6B,IAAM2F,EAAWynC,YACrHznC,EAAW2nC,YAAc3nC,EAAW2nC,aAAer6C,KAAK+M,YAAY,gCAAkC,IAAM2F,EAAWynC,YACvHznC,EAAW+6E,mBAAqB/6E,EAAW+6E,oBAAsBztF,KAAK+M,YAAY,oCAAsC2F,EAAWynC,YACnIznC,EAAW4nC,YAAc5nC,EAAW4nC,aAAet6C,KAAK+M,YAAY,4CAIpE2F,EAAWxU,cAAgBwU,EAAWrM,UAAY,GAElDqM,EAAWg7E,cAAe,EAGI,UAA1Bh7E,EAAW0zC,cACX1zC,EAAW0zC,YAAoD,mBAA9BrmD,EAAKq9B,OAAO66C,eAAgCl4E,EAAKq9B,OAAO66C,iBAAmB,IAQhH,KACSl4E,EAAKq9B,QAAoD,kBAAnCr9B,EAAKq9B,OAAO1qB,WAAWqyC,WAA0BhlD,EAAKq9B,OAAO1qB,WAAWqyC,WAAcryC,EAAWqyC,YACxHryC,EAAWgzC,UAAW,EACtBhzC,EAAWkzC,WAAY,EACvBlzC,EAAWizC,aAAc,EACzBjzC,EAAWuyD,YAAa,EACxBvyD,EAAW25D,WAAY,EACvB35D,EAAWqyC,UAAW,GAE5B,MAAO92C,IAMJyE,EAAWkzC,YAAelzC,EAAWuyD,YAAevyD,EAAWwsE,gBAChExsE,EAAWqyC,UAAW,GAI1BryC,EAAWs3D,WAAa,EACxBt3D,EAAWu3D,WAAa,OAGxBv3D,EAAWi7E,sBAAwBj7E,EAAWi7E,4BAAyBzlF,EAEvEwK,EAAWk6E,iBAAiB//E,OAAOY,KAAKqT,QAAQpO,EAAWk6E,iBAAyBl6E,EAAWk6E,eAG/Fl6E,EAAW2xC,YAAemB,EAAKn6C,QAAUm6C,EAAKn6C,OAAOxN,MAAQ2nD,EAAKn6C,OAAOxN,KAAKwmD,YAAemB,EAAKn6C,OAAOxN,KAAKwmD,YAAc,KAG5HtkD,EAAKI,WAGLJ,EAAK6tF,iBAID7tF,EAAKmV,SAA8B,MAAnBxC,EAAW7U,OAC3B6U,EAAW7U,KAAKwE,KAAOtC,EAAK8tF,gBAAgBn7E,EAAW7U,KAAKwE,QAOpEiqE,SAAU,WACN,OAAOtsE,KAAK0S,WAAW7U,MAAQmC,KAAK0S,WAAW7U,KAAKwE,KAAK6C,OAAS,GAGtEgQ,MAAO,WACH,IAAIxC,EAAa1S,KAAK0S,WACtB,OAAKA,GACoC,iBAA1BA,EAAW5O,aAAmE,OAAxC4O,EAAW5O,YAAYqY,eAEhF0xE,gBAAiB,SAAUhwF,GACvB,IAEIiwF,EAFAC,KACA1rF,EAAOxE,MAaX,OAVAV,EAAE0D,KAAKwB,EAAM,SAAUtB,EAAK6C,GAExBkqF,EAASlqF,EAAMyL,SACf0+E,EAAkBnqF,EAAMkpF,WAERjW,QAAQiX,GAExBzrF,EAAKtB,GAAOgtF,IAGT1rF,GAQX2rF,uBAAwB,SAAUnwF,EAAMowF,GACpC,IAAI5rF,EAAOxE,MACPqwF,EAAmB,EAavB,OAZI7rF,EAAK6C,OAAS,IAEdgpF,EAAmB7rF,EAAK,GAAG6C,OAAS+oF,EAAa,GAEjDC,EAAmB,GACnB/wF,EAAE0D,KAAKwB,EAAM,SAAUtB,EAAK6C,GAExB,IAAK,IAAI9C,EAAI,EAAGA,EAAIotF,EAAkBptF,IAClC8C,EAAMw6C,QAIX/7C,GAMXwyD,UAAW,SAAUh0C,GACjB,IACI9Y,EAAS,KAOb,OANA5K,EAAE0D,KAFSb,KAECzC,QAAS,SAAUuD,EAAGpC,GAC1BA,EAAOgU,WAAWmO,OAASA,GAASniB,EAAOgU,WAAWpV,IAAMujB,IAC5D9Y,EAASrJ,KAIVqJ,GAGXomF,cAAe,SAAU7wF,GACrB,IACIsF,EADO5C,KACYs3E,WAAWptE,QAAQ5M,GAE1C,OAAoB,GAAhBsF,EAHO5C,KAIKzC,QAAQqF,GAAa8P,WAAWzI,KAGzC,MAOXkhE,cAAe,WACX,IACIz4D,EAAa1S,KAAK0S,WAClB+Q,EAAQ,IAAItmB,EAAE4S,SAIL,cANF/P,KAKK6jE,YAEZnxD,EAAW7U,KAPJmC,KAOgB6mF,gBAG3B,IAAIxoF,EAVO2B,KAUSouF,kBAGhB7qF,EAbOvD,KAaKquF,cAAchwF,GAG1BiwF,KAcJ,OAbAnxF,EAAE0D,KAjBSb,KAiBCzC,QAAS,SAAUuD,EAAGpC,GAG9B,IAAIqJ,EAASrJ,EAAO6vF,aAChBxmF,GACAumF,EAAmB1lF,KAAKb,KAIhC5K,EAAEqM,KAAK4E,MAAMjR,EAAGmxF,GAAoBnmF,KAAK,WACrCsb,EAAMtT,QAAQ5M,KAGXkgB,EAAMlb,WAKjBpE,WAAY,WACR,IACIsO,EADOzS,KACQ0rE,aAGnB1rE,KAAKsN,SAILmF,EAAQpR,SAAS,mCACZA,SAAS,mCAMlB+sF,gBAAiB,WACb,OAAOpuF,KAAK8iE,cAAcvT,YAAY,SAM1C8+B,cAAe,SAAUhwF,GACrB,IACIqU,EADO1S,KACW0S,WAGtB,OAFA5O,YAFW9D,KAEQ0S,WAAW5O,YAEvB3G,EAAE0E,SAASxD,GACdf,GAAIuP,OAAOY,KAAKmT,YAAYlO,EAAWmO,OACvCs5B,YAAattC,OAAOY,KAAKmT,YAAYlO,EAAWynC,aAChDuL,SAAUhzC,EAAWgzC,SACrB8nC,SAAU96E,EAAW86E,YAO7BpiB,eAAgB,WAMZ,OALWprE,KAKCmrE,iBAKhBmW,cAAe,SAAUj2E,GACrB,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAoBtB,OAjBArH,EAASA,MACTlO,EAAEsJ,OAAO4E,GACLqY,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBsC,YAAa1zC,EAAW2xC,YACxBD,YAAa1xC,EAAW0xC,YACxB7mB,KAAM7qB,EAAWlV,OACjByqD,MAAOv1C,EAAWjV,SAClByC,KAAMwS,EAAWxS,KACjBmC,KAAMqQ,EAAWq6E,YACjB7kC,aAAcx1C,EAAWw1C,aACzBpkD,YAAa4O,EAAW5O,aAAe,QAIvC4O,EAAWi7E,sBACJj7E,EAAWi7E,sBAAsBtiF,GAGjCtL,EAAKgjE,YAAYzf,cAAc0E,YAAY38C,GAAQwY,KAAK,SAAUhmB,GASrE,OARAkC,EAAKksF,aAAelsF,EAAKksF,iBACzBlsF,EAAKksF,aAAapuF,KAAOgP,OAAO8K,MAAM9Z,GAGtC6U,EAAWxS,KAAOrC,EAAKqC,KACvBwS,EAAW3J,QAAUlL,EAAKkL,QAC1B2J,EAAWrS,WAAaxC,EAAKwC,WAEtBxC,KAOnB4uF,cAAe,SAAU5uF,EAAMsD,GAGd,cAFFnB,KACK6jE,WACahmE,GAAQA,EAAKwE,MACtClF,EAAE0D,KAAKhD,EAAKwE,KAAM,SAAUtB,EAAK6C,GAC7B,IAAI4qF,EAAcrtF,GAAStD,EAAKwE,KAAKtB,GAAKmE,OAC1CrH,EAAKwE,KAAKtB,GAAK8Y,OAAO20E,EAAa,EAAG,OAKlDC,qBAAsB,SAAS5wF,EAAMsD,GAGpB,cAFFnB,KACK6jE,WACahmE,GAAQA,EAAKw3D,SACtCl4D,EAAE0D,KAAKhD,EAAKw3D,QAAS,SAAUt0D,EAAK6C,GAChC,IAAI4qF,EAAcrtF,GAAStD,EAAKw3D,QAAQt0D,GAAKmE,OAC7CrH,EAAKw3D,QAAQt0D,GAAK8Y,OAAO20E,EAAa,GAAG,MAKrDE,sBAAuB,SAAS7wF,EAAMsD,GAGrB,cAFFnB,KACK6jE,WACahmE,GAAQA,EAAKknD,UACtC5nD,EAAE0D,KAAKhD,EAAKknD,SAAU,SAAUhkD,EAAK6C,GACjC,IAAI4qF,EAAcrtF,GAAStD,EAAKknD,SAAShkD,GAAKmE,OAC9CrH,EAAKknD,SAAShkD,GAAK8Y,OAAO20E,EAAa,GAAG,MAQtD3H,aAAc,WACV,IACIn0E,EADO1S,KACW0S,WACtB,GAAIA,EAAW7U,KACX,OAAO6U,EAAW7U,KAMlB,IAHA,IAAI8wF,GAAe,KAGV7tF,EAAI,EAAGA,EATTd,KASkBzC,QAAQ2H,OAAQpE,IACrC6tF,EAAY/lF,KAAK,IAUrB,OANI1I,KAAQ,EACRyI,MAAS,EACTI,QAAW,EACX1G,MAASssF,KAUrB7N,kBAAmB,SAAUxjF,GACzB,IACIoV,EADO1S,KACW0S,WAElBmO,EAAQnO,EAAWmO,MAHZ7gB,KAGyB4uF,qBAAqBtxF,GAEzD,OALW0C,KAKC+iE,YAAYvY,gBACpB9mC,IAAKhR,EAAWquE,QAChBl9B,SAAUnxC,EAAWpV,GACrBujB,MAAOA,EACPijC,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBgC,YAAa1zC,EAAW2xC,eAOhC68B,kBAAmB,SAAU5jF,EAAIO,GAC7B,IAAIkC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlBonE,EAAkB,KAClBj8E,EAAKk8E,YACLD,EAAkB38E,EAAEqM,KAAK4E,MAAMjR,EAAGU,EAAKk8E,kBAChCl8E,EAAKk8E,WAIhB,IAAIj2B,EAAepxC,EAAWoxC,aAAa5+C,OAAS,EAAIwN,EAAWoxC,aAAe,IAAMpxC,EAAWmO,MAAQ9gB,EAAK6uF,qBAAqBtxF,GAAMoV,EAAWmO,MAAQ9gB,EAAK6uF,qBAAqBtxF,GAExL,OAAOH,EAAEqM,KAAKswE,GAAiB7pE,KAAK,WAEhC,OADAlQ,EAAKyB,eACEzB,EAAKgjE,YAAYpY,gBACpBjnC,IAAKhR,EAAWyuE,QAChBt9B,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcA,EACdoC,WAAYroD,EACZuoD,YAAa1zC,EAAW2xC,YACxBuG,6BAA8B/sD,EAAK+sD,+BAAgC,IACpE36C,KAAK,SAAU4+E,GAEd,OADA9uF,EAAKgC,aACE8sF,IACRz+E,KAAK,SAAUgxE,GACd,IAAI57B,EAAOzlD,EAAK2gC,mBACZhqB,EAAW0qE,EAAqB,aAAIA,EAASllD,aAAoC,iBAAZklD,EAAwBA,EAAWA,EAAStwE,WAErH,GAAsB,iBAAX4F,EACP,IACIA,EAAUiG,KAAKhE,MAAMjC,GAASA,QAChC,MAAOzI,GAELyI,GADAA,EAAUA,EAAQoH,MAAM,oBAAoB,IAC1BlF,OAAO,GAAIlC,EAAQxR,OAAS,SAG1CwR,EAAQA,UAChBA,EAAU0qE,GAEd57B,EAAKm0B,eACLn0B,EAAKuT,0BACLvT,EAAK82B,qBAAqB5lE,QAQtCsqE,oBAAqB,SAAU1jF,GAC3B,IAAIyC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElBmO,EAAQnO,EAAWmO,MAAQ9gB,EAAK6uF,qBAAqBtxF,GAEzD,OAAOyC,EAAKgjE,YAAYlY,kBACpBnnC,IAAKhR,EAAWuuE,UAChBp9B,SAAUnxC,EAAWpV,GACrBujB,MAAOA,EACPijC,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBgC,YAAa1zC,EAAW2xC,cACzBp0C,KAAK,SAAUpS,GACd,GAAiB,sBAAbA,EAAKoM,KAA8B,CACnC,IAAIu7C,EAAOzlD,EAAK2gC,mBACZhqB,EAAU7Y,EAAKk+E,SAASrjE,KAAK,KACjC8sC,EAAKs1B,aAAapkE,QAASA,IAG/B,OAAO7Y,KAOf+iF,iBAAkB,WACd,IACIluE,EADO1S,KACW0S,WAgBtB,OAjBW1S,KAGQ+iE,YAAYtY,eAC3B/mC,IAAKhR,EAAWmuE,OAChBh9B,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcpxC,EAAWoxC,aACzBsC,YAAa1zC,EAAW2xC,YACxBD,YAAa1xC,EAAW0xC,cAGCn0C,KAAK,SAAUpS,GAExC,OAAOA,EAAK8lD,WAGMp7C,WAM1B84E,sBAAuB,SAAUh2E,GAC7B,IACIqH,EADO1S,KACW0S,WAEtB,OAHW1S,KAGC+iE,YAAY9X,oBACpBvnC,IAAKhR,EAAW4rE,YAChBz6B,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcpxC,EAAWoxC,aACzBM,YAAa/4C,EAASA,EAAO+4C,YAAc1xC,EAAW0xC,YACtDgC,YATOpmD,KASW0S,WAAW0zC,aAAe,MAMpD0oC,kBAAmB,SAAUzjF,GACzB,IAEI/N,GADJ+N,EAASA,OACO/N,GACZujB,EAAQxV,EAAOwV,MACfjd,EAAQyH,EAAOzH,MACfqB,OAAsC,IAApBoG,EAAc,SAAoBA,EAAOpG,QAC3D8pF,EAAY1jF,EAAO+qD,UAAW,EANvBp2D,KAQNG,QAAQ7C,GARF0C,KAQaG,QAAQ7C,OARrB0C,KASNG,QAAQ7C,GAAIujB,GAASjd,EAEtBqB,GAXOjF,KAYFqoE,qBAAqBtnE,IAAKzD,EAAIoB,OAAQmiB,EAAOu1C,QAAS24B,KAKnEC,8BAA+B,SAAUnuE,GACrC,IAAI9gB,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlBtH,GACA8rD,WACIr2C,MAAOnO,EAAWmO,MAClBs2C,QAAS,eACT7C,SAAU,QAEdzB,YACIG,SAAU,MACVC,cAEQI,QACIL,SAAU,cACVnyC,MAAOnO,EAAWmO,MAAQ,MAAQA,EAClCszC,aAAc,OACdG,SAAUzzC,MAK1B07C,cAAe7pD,EAAWmO,QAI9B1jB,EAAEqM,KAAKzJ,EAAKqR,SACPjJ,KAAK,WACSpI,EAAK2gC,mBACXmwC,gBAAgBhwD,EAAOzV,MAMxCg8D,YAAa,SAAUF,GACnB,IAAInnE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBu8E,KAEJ,IAAK,IAAI3xF,KAAMyC,EAAKI,QAAS,CAEzB,GAAU,WAAN7C,EACA,IAAK,IAAI4xF,KAAenvF,EAAKI,QAAQ7C,GAEjC,GAAIyC,EAAKovF,gBAAgB7xF,EAAI4xF,GAAc,CACvC,IAAIruE,EAAQnO,EAAWmO,MAAQ9gB,EAAK6uF,qBAAqBtxF,GAAM,IAAM4xF,EAEjEtrF,GADoB8O,EAAWmO,MAAQ9gB,EAAK6uF,qBAAqBtxF,GAAa4xF,EAAYt2E,OAAOs2E,EAAYnE,YAAY,KAAO,EAAGmE,EAAYhqF,QACvInF,EAAKI,QAAQ7C,GAAI4xF,IAE7BhoB,EAAarmD,GAASjd,EAMlCqrF,EAAarmF,KAAKtL,GAItB,GAAIyC,EAAKusF,iBACL,IAAK,IAAIhvF,KAAMyC,EAAKusF,iBAAkB,CAElC,IAAI8C,EAAyBrvF,EAAKusF,iBAAiBhvF,GAC/C+xF,EAAsBtvF,EAAKssF,cAAc/uF,GACzCgyF,EAAsBD,EAAoBnqF,OAC9C,GAAIkqF,GAA0BC,EAAqB,CAC/C,IAAK,IAAIvuF,EAAI,EAAGA,EAAIwuF,EAAqBxuF,IAAK,CAE1ComE,EAD+Bx0D,EAAWmO,MAAQ9gB,EAAK6uF,qBAAqB7uF,EAAKssF,cAAc/uF,GAAI+R,QAAQ,IAAM,IAAM/R,IAC9E,EAI7C4pE,EADwBx0D,EAAWmO,MAAQ9gB,EAAK6uF,qBAAqBQ,EAAuBruF,KAAO,IAAMquF,EAAuBvuE,OAC9FuuE,EAAuBxrF,OASrEzG,EAAE0D,KAAKouF,EAAc,SAAUluF,EAAKuX,UACzBvY,EAAKI,QAAQmY,MAI5B+uD,WAAY,SAAUt/D,GAElB,OAAK5K,EAAE4jB,cADI/gB,KACeG,UAIjBhD,EAAE4jB,cALA/gB,KAKmBssF,oBACtBvkF,EAAOa,MAAK,IACL,IALXb,EAAOa,MAAK,IACL,IAcfumF,gBAAiB,SAAU7xF,EAAI4xF,GAC3B,IAAiBpuF,EAAGwB,EACpB,IAAKxB,KADMd,KACIzC,QACX,GAFOyC,KAEEzC,QAAQga,eAAezW,GAAI,CAChC,IAAIpC,EAHDsB,KAGezC,QAAQuD,GAC1B,GAA+B,oBAA3BpC,EAAOgU,WAAWzI,MAClB,GAAIvL,EAAOgU,WAAWmO,OAASquE,EAAa,CACxC,IAAIK,EANTvvF,KAM6BwvF,gBAAgBlyF,EAAIoB,EAAOkE,YAAc,GACjE,OAAOlE,EAAOyoE,UAAU7pE,EAAIiyF,SAGhC,IAAKjtF,KAAK5D,EAAOgU,WACb,GAAIhU,EAAOgU,WAAW6E,eAAejV,IAC6B,oBAA1Dud,OAAO1R,UAAU2C,SAAS1C,MAAM1P,EAAOgU,WAAWpQ,KAC1C5D,EAAOgU,WAAWpQ,GAAGsW,OAAOla,EAAOgU,WAAWpQ,GAAGyoF,YAAY,KAAO,KAC9DmE,EACV,OAAO,EAUnC,OAAO,GAKX/nB,UAAW,WACP,IACIz0D,EADO1S,KACW0S,WAItB,QAHkB7F,OAAOY,KAAKuF,aAAaN,EAAW89D,eAAgB,IAGjD99D,EAAWuyD,aAAcvyD,EAAW25D,WAAclvE,EAAE4jB,cAL9D/gB,KAKiFG,WAQhGsvF,aAAc,SAAU1uF,EAAK8f,GAGzB,IAFA,IACIhjB,EADOmC,KACK0S,WAAW7U,KAAKwE,KACvBvB,EAAI,EAAGA,EAAIjD,EAAKqH,OAAQpE,IAC7B,GAAIjD,EAAKiD,GAAG,IAAMC,EACd,IAAK,IAAIuB,EAAI,EAAGA,EAJbtC,KAIsBzC,QAAQ2H,OAAQ5C,IAAK,CAC1C,GALDtC,KAKUzC,QAAQ+E,GAAGoQ,WAAWmO,OAASA,EAEpC,OADahjB,EAAKiD,GAAGwB,EAAI,GAMzC,OAAO,MAKXqzD,oBAAqB,SAAU50D,EAAK8f,GAChC,IAEIpO,EAFOzS,KAEQw3D,eAAez2D,EAAK8f,GACvC,OAAIpO,GAAuC,mBAArBA,EAAQE,SACnBF,EAAQE,WAEZ,MAKX6kD,eAAgB,SAAUz2D,EAAK8f,GAC3B,IACIpO,EAAU,KACd,QAA6B,IAFlBzS,KAEa,QACpB,IAAK,IAAIsC,EAAI,EAAGA,EAHTtC,KAGkBzC,QAAQ2H,OAAQ5C,IACrC,GAJGtC,KAIMzC,QAAQ+E,GAAGoQ,WAAWmO,OAASA,GAJrC7gB,KAImDzC,QAAQ+E,GAAGoQ,WAAWpV,IAAMujB,EAAO,CACrFpO,EALDzS,KAKgBzC,QAAQ+E,GAAGitE,aAAaxuE,GACvC,MAKZ,OAAO0R,GAGXkuD,eAAgB,SAAUrM,GACtBt0D,KAAK0S,WAAWosD,SAAWxK,EAC3Bt0D,KAAKstE,oBAAoBhZ,IAG7BgZ,oBAAqB,SAAUhZ,GAC3B,IAAI7hD,EAAUzS,KAAK0rE,aAEfj5D,EAAQvN,OAAS,IACM,cAAnBlF,KAAK6jE,UACqC,GAAtCh3D,OAAOY,KAAKuF,aAAashD,IAAqBt0D,KAAK0S,WAAWqyC,SAC9DtyC,EAAQpR,SAAS,yBAEjBoR,EAAQoT,YAAY,yBAGkB,GAAtChZ,OAAOY,KAAKuF,aAAashD,KAAsBt0D,KAAKssE,YAActsE,KAAK0S,WAAWqyC,SAClFtyC,EAAQpR,SAAS,yBAEjBoR,EAAQoT,YAAY,0BAKhC7lB,KAAKutE,yBAMTprE,QAAS,aAKTutF,SAAU,SAAU3uF,EAAKmuF,KAKzBzvB,0BAA2B,SAAU1+D,EAAK8f,EAAOyzC,KAKjDuL,gBAAiB,SAAU9+D,EAAK8f,EAAOyzC,KAKvC0L,qBAAsB,SAAUj/D,EAAK8f,EAAOyzC,KAK5C+L,sBAAuB,SAAUt/D,EAAK8f,EAAOyzC,KAK7CoM,mBAAoB,SAAU3/D,EAAK8f,EAAOyzC,KAK1Cq7B,qBAAsB,SAAU5uF,EAAK8f,EAAOyzC,KAM5C8M,mBAAoB,SAAUrgE,EAAK8f,EAAOyzC,KAM1C2M,mBAAoB,SAAUlgE,EAAK8f,EAAOyzC,KAM1C0N,cAAe,SAAUjhE,EAAK8f,KAG9By/C,kBAAmB,SAAUhM,GACzB,IAAIv0D,EAAOC,KACPyS,EAAU1S,EAAK2rE,aAEnB3rE,EAAK6vF,WAAWznF,KAAK,WAGjB,IAAIuK,GAAcA,WAAYvV,EAAEsJ,QAAQs+C,SAAUl4C,OAAOY,KAAKuF,aAAashD,IAAYv0D,EAAKksF,eAG5Fx5E,EAAQxQ,QAER4K,OAAO23D,UAAUhmB,OAAOrwC,UAAUg1D,eAAe/0D,MAAMrO,GAAO2S,IAE9D3S,EAAKqsF,iBACLrsF,EAAK8vF,yBAAyBv7B,GAEW,mBAA9Bv0D,EAAKkrE,uBACZ9tE,EAAEqM,KAAKzJ,EAAKkrE,yBAAyB9iE,KAAK,SAAU5E,GAChDkP,EAAQ7Q,OAAO2B,GACfxD,EAAK+mE,kBAAkB/mE,EAAKE,cAS5C2vF,SAAU,WACN,IACInsE,EAAQtmB,EAAE4S,WAEV1N,EAAOlF,EAAE,+BAHF6C,KAGuCC,SAASqD,KAAK,uBAYhE,OAXIjB,EAAK6C,OAAS,GACd7C,EAAOlF,EAAE2N,IAAIzI,EAAM,SAAUzD,EAAKkC,GAC9B,OAAO3D,EAAEyB,GAAKf,KAAK,kBANhBmC,KAQF8vF,oBAAoBztF,GAAM8F,KAAK,WAChCsb,EAAMtT,aAGVsT,EAAMtT,UAGHsT,EAAMlb,WAGjBsnF,yBAA0B,SAAUjsF,GAChC,IACIrG,EADOyC,KACQzC,YAEnBJ,EAAE0D,KAAKtD,EAAS,SAAUuD,EAAGpC,GACzBA,EAAOgU,WAAWqyC,SAAWnhD,KAOrC+9D,YAAa,SAAUt2D,GACnB,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB3R,EAAMsK,EAAOtK,IACbrC,EAAS2M,EAAO3M,OAChBolD,EAAwC,KAAxBz4C,EAAOy4C,aAAuBz4C,EAAOy4C,aAAe,IAAM/jD,EAAK2S,WAAWmO,MAAQ9gB,EAAK6uF,qBAAqB7tF,GAAOhB,EAAK2S,WAAWmO,MAAQ9gB,EAAK6uF,qBAAqB7tF,GACrLjC,EAAOiB,EAAKy3D,eAAez2D,EAAKsK,EAAO3M,QAEvCglD,EADO3jD,EAAK2gC,mBACEhuB,WAAWpV,GAE7B,GAAKwB,EAQL,OAHAA,EAAKwlE,kBAGEnnE,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAcyJ,iBACzClJ,SAAUnxC,EAAWpV,GACrBoB,OAAQI,EAAK4T,WAAWpV,GACxB8mD,YAAa1xC,EAAW0xC,YACxBN,aAAcA,EACdJ,OAAQA,EACRsJ,WAAYluD,EAAK4T,WAAWzI,QAC5B9B,KAAK,SAAUtK,GAEf,IAAIkyF,EAAe,SAAUr1C,GACzB,OAAIA,GAA2B,iBAAVA,GAAsBA,EAAOx1C,QAAU,EAChDw1C,EAAO,GAAGx1C,QAAU,EAAKw1C,EAAO,GAAG,GAAKA,EAAO,GAEpD,IAEP8vC,EAAWuF,EAAalyF,EAAKwE,MAC7B0iD,EAAWgrC,EAAalyF,EAAKknD,UAC5Bl4C,OAAOY,KAAKwS,UAAU8kC,KACvBA,EAAWA,IAAY,GAE3B,IAAIsQ,EAAU06B,EAAalyF,EAAKw3D,SAC3BxoD,OAAOY,KAAKwS,UAAUo1C,KACvBA,EAAUA,IAAW,GAIzBt1D,EAAKigE,qBAAqBj/D,EAAKrC,EAAQ22D,GACvCt1D,EAAKsgE,sBAAsBt/D,EAAKrC,EAAQqmD,GAGxCjmD,EAAKizC,SAASy4C,GACd1rF,EAAKiiE,gBAAgBypB,GAGrBzqF,EAAKsoE,qBAAqBtnE,IAAKA,EAAKrC,OAAQA,EAAQo+D,SAAS,IAK1C50D,MAAfpJ,EAAKJ,QAAqD,WAA9BmO,OAAOY,KAAKoG,gBACxC9T,EAAKiwF,2BAA2BjvF,EAAKypF,EAAU1rF,EAAKJ,OAAOkE,aAK/D9D,EAAKylE,oBAOb8D,oBAAqB,SAAUh9D,GAE3BA,EAASA,MAEJwB,OAAOY,KAAKqT,QAAQzV,IAA6B,GAAlBA,EAAOyxD,UAHhC98D,KAIF0S,WAAWu9E,eAAgB,GAJzBjwF,KAKN85D,eAAe,gBAChBtb,OANOx+C,KAOP4jD,aAAcv4C,EAAOtK,IACrBrC,OAAQ2M,EAAO3M,OACfo+D,QAASzxD,EAAOyxD,QAChBpG,WAAYrrD,EAAOqrD,WACnBN,QAAS/qD,EAAO+qD,WAOxBpkB,SAAU,WACNhyC,KAAKgK,aAKTA,QAAS,SAAU0vD,GACf,IAAI35D,EAAOC,KACP06D,GAAS,EAOb,GAJA36D,EAAKmwF,WAAY,EACjBnwF,EAAKq5D,qBAAqB,IAGtBr5D,EAAK2S,WAAW7U,MAAQkC,EAAK2S,WAAW7U,KAAKwE,KAAM,CACnD,IAAI8tF,EAAUpwF,EAAKqwF,iBAGG,GAAlBD,EAAQjrF,QAAe2H,OAAOY,KAAKuF,aAAajT,EAAK2S,WAAWosD,YAC3D/+D,EAAKusE,aACN51D,QAAU3W,EAAKgN,YAAY,wBAAwB4O,WAAW,UAAW5b,EAAK2S,WAAWynC,aACzFuf,EAAgB9wD,MACZiY,MAAO9gB,EAAK2S,WAAWmO,MACvBnK,QAASA,UAEbgkD,GAAS,IAMjB,IAFA,IAAI78D,EAAOV,EAAEkzF,MAAMlzF,EAAEkzF,SAAUtwF,EAAK2S,WAAW7U,KAAKwE,MAAO8tF,GAElDrvF,EAAI,EAAGA,EAAIf,EAAKxC,QAAQ2H,OAAQpE,IAAK,CAI1C,IAHA,IAAIi7E,KACAuU,KAEKhuF,EAAI,EAAGA,EAAIzE,EAAKqH,OAAQ5C,IAAK,CAClC,IAAIsB,EAAQ/F,EAAKyE,GAAGxB,EAAI,GACpBC,EAAMlD,EAAKyE,GAAG,GACNvC,EAAKxC,QAAQuD,GAAG4R,WAAWmO,WACb3Y,IAAtBnI,EAAKI,QAAQY,SAA8EmH,IAAxDnI,EAAKI,QAAQY,GAAKhB,EAAKxC,QAAQuD,GAAG4R,WAAWmO,SAChFjd,EAAQ7D,EAAKI,QAAQY,GAAKhB,EAAKxC,QAAQuD,GAAG4R,WAAWmO,QAIxC9gB,EAAKxC,QAAQuD,GAAGyvF,aAAaxvF,EAAK6C,EAAOm4E,EAAUh8E,EAAKyvF,gBAAgBzuF,EAAKD,MAE1F45D,GAAS,EAET36D,EAAKmwF,WAAY,EACjBnwF,EAAK2vF,SAAS3uF,EAAKhB,EAAKxC,QAAQuD,GAAG4R,WAAWmO,QAGtD,IAAK,IAAIpI,EAAI,EAAG+3E,EAAiBzU,EAAS72E,OAAQuT,EAAI+3E,EAAgB/3E,IAC/B,MAA/B63E,EAAevU,EAAStjE,MACxB63E,EAAevU,EAAStjE,IAAMsjE,EAAStjE,IAI/C,GAAIsjE,EAAS72E,OAAS,EAAG,CACrB,IAAIurF,EAAwB1wF,EAAKgN,YAAY,0BAA0B4O,WAAW,SAAU5b,EAAK2S,WAAWynC,aAC5G,IAAKp5C,KAAOuvF,EACR52B,EAAgB9wD,MACZiY,MAAO9gB,EAAK2S,WAAWmO,MACvBnK,QAAS+5E,EAAwB,IAAM1vF,MAO3D,OAAO25D,GAKX2Q,wBAAyB,aAMzBmkB,gBAAiB,SAAUzuF,EAAKrC,GAI5BqC,EAAM8I,OAAO9I,GACbrC,EAASmL,OAAOnL,GAGhB,IAAIyH,EAPOnG,KAOiBzC,QAAQmB,GAAQgU,WAW5C,OAlBW1S,KAQD4tF,cAAc7sF,KARbf,KASF4tF,cAAc7sF,OATZf,KAUD4tF,cAAc7sF,GAAKrC,KAVlBsB,KAWF4tF,cAAc7sF,GAAKrC,IACpB22D,QAASlvD,EAAiBkvD,QAC1BtQ,SAAU5+C,EAAiB4+C,SAC3B+Z,SAAU34D,EAAiB24D,WAdxB9+D,KAkBC4tF,cAAc7sF,GAAKrC,IAMnCgyF,iBAAkB,SAAU7yF,EAAMN,GAC9B,IACIwD,EAGJ,GAAIlD,EAAKw3D,QACL,IAAK,IAAIv0D,EAAI,EAAGukB,EAAMxnB,EAAKw3D,QAAQnwD,OAAQpE,EAAIukB,EAAKvkB,IAAK,CACrDC,EAAMlD,EAAKw3D,QAAQv0D,GAAG,GACtB,IAAK,IAAIwB,EAAI,EAAGquF,EAAQ9yF,EAAKw3D,QAAQv0D,GAAGoE,OAAQ5C,EAAIquF,EAAOruF,IAEnDA,EAAI,IATTtC,KAUUwvF,gBAAgBzuF,EAAKuB,EAAI,GAAG+yD,QAAUxoD,OAAOY,KAAKuF,aAAanV,EAAKw3D,QAAQv0D,GAAGwB,KAMpG,GAAIzE,EAAKknD,SACL,IAASjkD,EAAI,EAAGukB,EAAMxnB,EAAKknD,SAAS7/C,OAAQpE,EAAIukB,EAAKvkB,IAAK,CACtDC,EAAMlD,EAAKknD,SAASjkD,GAAG,GACvB,IAASwB,EAAI,EAAGquF,EAAQ9yF,EAAKknD,SAASjkD,GAAGoE,OAAQ5C,EAAIquF,EAAOruF,IAExD,GAAIA,EAAI,EAAG,CACP,IAAIoqE,GAAiBnvE,GAAUsP,OAAOY,KAAKuF,aAAazV,EAAQ+E,EAAI,GAAGoQ,WAAWqyC,UAtBvF/kD,KAuBUwvF,gBAAgBzuF,EAAKuB,EAAI,GAAGyiD,WAAW2nB,GAAiB7/D,OAAOY,KAAKuF,aAAanV,EAAKknD,SAASjkD,GAAGwB,KAOvH,GAAIzE,EAAKihE,SACL,IAASh+D,EAAI,EAAGukB,EAAMxnB,EAAKihE,SAAS55D,OAAQpE,EAAIukB,EAAKvkB,IAAK,CACtDC,EAAMlD,EAAKihE,SAASh+D,GAAG,GACvB,IAASwB,EAAI,EAAGquF,EAAQ9yF,EAAKihE,SAASh+D,GAAGoE,OAAQ5C,EAAIquF,EAAOruF,IAEpDA,EAAI,IAnCTtC,KAoCUwvF,gBAAgBzuF,EAAKuB,EAAI,GAAGw8D,SAAWjyD,OAAOY,KAAKuF,aAAanV,EAAKihE,SAASh+D,GAAGwB,OAQ1Gk9D,WAAY,WACR,IACI3hE,EAAOV,EAAEkzF,MADFrwF,KACa0S,WAAW7U,KAAKwE,KAD7BrC,KACwCowF,kBACnD,OAAOjzF,EAAE2N,IAAIjN,EAAM,SAAUorC,EAAMnoC,GAC/B,OAAOmoC,EAAK,MAOpBmnD,eAAgB,WACZ,IAAIrwF,EAAOC,KACPmwF,KAaJ,MAX8B,iBAAnBpwF,EAAK6wF,YAA2BzzF,EAAE4jB,cAAchhB,EAAK6wF,aAC5DzzF,EAAE0D,KAAKd,EAAK6wF,WAAY,SAAU9C,GAC9B,IAAIp4B,KACJA,EAAU9sD,KAAKiB,OAAOikF,IACtB,IAAK,IAAIhtF,EAAI,EAAGoE,EAASnF,EAAKxC,QAAQ2H,OAAQpE,EAAIoE,EAAQpE,IACtD40D,EAAU9sD,KAAK7I,EAAK41D,oBAAoBm4B,EAAQ/tF,EAAKxC,QAAQuD,GAAG4R,WAAWmO,QAG/EsvE,EAAQvnF,KAAK8sD,KAGdy6B,GAOX7hC,iBAAkB,SAAUjjD,GACxB,IACIqH,EADO1S,KACW0S,WAEtB,OAHW1S,KAGC+iE,YAAYzU,kBACpBzK,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,cAAgB,GACzCM,YAAa1xC,EAAW0xC,YACxB+H,YAAa9gD,EAAO8gD,YACpBoC,WAAYljD,EAAOkjD,WACnBhxB,KAAM7qB,EAAW6qB,KACjBspB,UAVO7mD,KAUSsxE,eAChB5tB,OAXO1jD,KAWM0gC,mBAAmBhuB,WAAWpV,MAKnDuzF,oBAAqB,WAEjB,OADW7wF,KACC8hE,eAAe,MAAM,IAGrC1jC,QAAS,WACL,IAAIr+B,EAAOC,KAEX8B,WAAW,WACH/B,EAAKxC,SACLJ,EAAE0D,KAAKd,EAAKxC,QAAS,SAAUuD,EAAGpC,GAC9BA,EAAO0/B,aAGhBvxB,OAAOwkB,SAAS6yC,aAAe,IAGlCnkE,EAAKuN,UAGTwjF,iBAAkB,SAAUzlF,GACxB,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WACtBrH,EAASA,MACTlO,EAAEsJ,OAAO4E,GACLqY,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBsC,YAAa1zC,EAAW2xC,YACxBD,YAAa1xC,EAAW0xC,YACxB/hD,KAAMqQ,EAAWq6E,YACjB3kC,YAAa/8C,EAAOwV,QAGxB,IAAI4C,EAAQ,IAAItmB,EAAE4S,SAclB,OAZAhQ,EAAKgjE,YAAYzf,cAAc6E,8BAA8B98C,GAAQlD,KAAK,SAAUtK,GAEhF6U,EAAWxS,KAAOrC,EAAKqC,KACvBwS,EAAW3J,QAAUlL,EAAKkL,QAC1B2J,EAAWrS,WAAaxC,EAAKwC,WAGzBN,EAAKmV,UACLrX,EAAKwE,KAAOtC,EAAK8tF,gBAAgBhwF,EAAKwE,OAE1CohB,EAAMtT,QAAQtS,KAEX4lB,EAAMlb,WAGjBqmF,qBAAsB,SAAU7tF,GAC5B,OAAI8L,OAAOY,KAAK0S,UAAUpf,GAAa,OAASA,EAAM,IAC/C,QAAUA,EAAM,MAG3BgwF,gBAAiB,WAEb/wF,KAAK4wF,eAWTlxB,sBAAuB,SAAUhB,GAC7B1+D,KAAKsN,OAAOoxD,GAEZ,IAAIjsD,EAAUzS,KAAK0rE,aAInB,OAHAj5D,EAAQnP,KAAK,4BAA4BoB,IAAI,mBAAoBg6D,EAAO,cACxEjsD,EAAQnP,KAAK,iCAAiCoB,IAAI,mBAAoBg6D,EAAO,cAEtE1+D,MAOXgxF,eAAgB,WACZ,IAAIC,EAAejxF,KAAK0S,WAAWu+E,iBAEnC,QAAOA,IAAgBpkF,OAAOY,KAAKqT,QAAQmwE,EAAavyB,UCx1ChEvhE,EAAEklD,MAAM57C,OAAO,8BAKX0kE,cAAe,WACX,MAAuB,WAAnBnrE,KAAK6jE,UACE,QAAUh3D,OAAOC,aAAaC,YAAY,6BAA+B,SAEzE,WAOf5I,WAAY,WACR,IAAIuO,EAAa1S,KAAK0S,WAGtB1S,KAAKsN,cAGoBpF,IAArBwK,EAAW9O,OACX5D,KAAK+gE,gBAAgBruD,EAAW9O,UCzB5CzG,EAAEklD,MAAM57C,OAAO,6BAOX08D,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAHDmC,KAMW0S,WACXosD,UAAW,EAPX9+D,KAUN0S,WAAWg3D,YAAc,QAVnB1pE,KAYN0S,WAAWynC,YAAct8C,EAAK6U,WAAWynC,aAAe,GAEzDttC,OAAOY,KAAKuF,aAdLhT,KAcuB0S,WAAWw+E,qBACzClxF,KAAK0S,WAAWynC,YAAct8C,EAAK6U,WAAWynC,aAAettC,OAAOC,aAAaC,YAAY,sCAftF/M,KAkBNmxF,eAlBMnxF,KAqBNypE,oCAMTtlE,WAAY,WACRnE,KAAKsN,SAELtN,KAAKguE,oBAAoB,SAGY,mBAA1BhuE,KAAK+yE,mBACZ/yE,KAAK+yE,qBAMbjH,mBAAoB,WAChB9rE,KAAKsN,SAELtN,KAAKguE,oBAAoB,SACzBhuE,KAAKiuE,iBAAiBjuE,KAAK0S,WAAW42D,YAAc,SAOxDt/D,QAAS,SAAU0vD,KAQnByN,UAAW,WAEP,OAAO,GAGXgqB,aAAc,WACV,IAAIpxF,EAAOC,KAEPD,EAAK2S,WAAWw+E,mBAAqBnxF,EAAK2S,WAAW9O,QACd,iBAA3B7D,EAAK2S,WAAgB,OAAkB3S,EAAK2S,WAAW9O,MAAM,GACrE7D,EAAK2S,WAAWynC,YAAcp6C,EAAK2S,WAAW9O,MAAM,GAAGA,MACb,iBAA3B7D,EAAK2S,WAAgB,OAA4C,KAA1B3S,EAAK2S,WAAW9O,QACtE7D,EAAK2S,WAAWynC,YAAcp6C,EAAK2S,WAAW9O,SAK1D4O,sBAAuB,WAEnB,OAAO,KCrFfrV,EAAEklD,MAAM57C,OAAO,8BAMX08D,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAEtBA,EAAW0+E,YAAc1+E,EAAW0+E,gBAGpC1+E,EAAW64C,WAAa1hD,OAAO6I,EAAW64C,aAAe,GACzD74C,EAAW2+E,eAA0E,OAAxDxkF,OAAOY,KAAKuF,aAAaN,EAAW2+E,iBAAoCxkF,OAAOY,KAAKuF,aAAaN,EAAW2+E,gBACzI3+E,EAAW4+E,aAAqE,OAAtDzkF,OAAOY,KAAKuF,aAAaN,EAAW4+E,eAAyBzkF,OAAOY,KAAKuF,aAAaN,EAAW4+E,cAC3H5+E,EAAW44C,gBAAkB54C,EAAW44C,kBAAmB,EAC3D54C,EAAWgzC,SAAW74C,OAAOY,KAAKuF,aAAaN,EAAWgzC,YAAa,EACvEhzC,EAAW6+E,YAAmE,OAArD1kF,OAAOY,KAAKuF,aAAaN,EAAW6+E,cAAwB1kF,OAAOY,KAAKuF,aAAaN,EAAW6+E,aACzH7+E,EAAW6+E,cAAc1kF,OAAOY,KAAKuF,aAAaN,EAAW4+E,eAAuB5+E,EAAW6+E,YAC/F7+E,EAAW8+E,WAAiE,OAApD3kF,OAAOY,KAAKuF,aAAaN,EAAW8+E,aAAuB3kF,OAAOY,KAAKuF,aAAaN,EAAW8+E,YACvH9+E,EAAWqyC,SAA6D,OAAlDl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,WAAqBl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,UAGnHryC,EAAW++E,aAAe/+E,EAAW++E,cAAgB,EAGrD/+E,EAAWg/E,oBAAqB,EAChCh/E,EAAWi/E,YAAc,IAIrBj/E,EAAW2+E,gBAAqC,cA9BzCrxF,KA8B2B6jE,YAClCnxD,EAAWovD,eAAiBj1D,OAAOY,KAAKuF,aAAaN,EAAWovD,kBAAmB,EACnFpvD,EAAWovD,kBAAkBpvD,EAAWk/E,eAAiB,GAAK,IAAIl/E,EAAWovD,iBAQrFqJ,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,UAE9C,OAAOpyD,EAAE0E,SAASxD,GACdf,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClB0wE,YAAa7+E,EAAW6+E,YACxBF,eAAgB3+E,EAAW2+E,eAC3BC,aAAc5+E,EAAW4+E,aACzBvsC,SAAUryC,EAAWqyC,SACrBysC,WAAY9+E,EAAW8+E,WACvBllB,SAZOtsE,KAYQssE,cASvBlqE,QAAS,SAAUiJ,GACf,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+Q,EAAQ,IAAItmB,EAAE4S,SACdy1C,EAAOzlD,EAAK2gC,mBACZ2jB,EAAcmB,EAAKyyB,kBAAoBzyB,EAAKn6C,OAAO+6C,cAAe,EAmBtE,GAjBA/6C,EAASA,MAGLtL,EAAK2S,WAAW0zC,YAChB/6C,EAAOwmF,cAAgB9xF,EAAK2S,WAAW0zC,YAChC/B,IACPh5C,EAAOwmF,cAAgBxtC,GAG3Bh5C,EAAOwmF,cAAgB9xF,EAAK2S,WAAWo/E,2BAA6B,WAAazmF,EAAOwmF,cAGpFxmF,GAAUA,EAAOwmF,eAA0C,aAAzBxmF,EAAOwmF,gBACzCn/E,EAAWoxC,aAAe,IAI1BpxC,EAAWw2B,KAAKh/B,QAAQ,MAAS,EAAG,CACpC,IAAI6nF,EAAS,IAAItjF,OAAO,IAAM,KAC9BiE,EAAWw2B,KAAOx2B,EAAWw2B,KAAKvkC,QAAQotF,EAAQ,UAItD,GAAIr/E,EAAWw2B,KAAKh/B,QAAQ,MAAS,EAAG,CAChC6nF,EAAS,IAAItjF,OAAO,IAAM,KAC9BiE,EAAWw2B,KAAOx2B,EAAWw2B,KAAKvkC,QAAQotF,EAAQ,KA2BtD,OAvBAhyF,EAAKgjE,YAAYzf,cAAcwE,eAC3BpkC,IAAKhR,EAAW6uE,QAChBn7B,YAAa/6C,EAAOwmF,cACpBhxE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBlb,KAAOx2B,EAA0B,gBAAI,IAAMA,EAAWw2B,KAAOx2B,EAAWw2B,KACxE0d,MAAOv7C,IACRlD,KAAK,SAAUtK,GAEd6U,EAAW7U,KAAOA,EAClB4lB,EAAMtT,QAAQuC,EAAW7U,QAC1BuS,KAAK,SAAUvS,GACd,IAAIm0F,EAAan0F,EAAKm0F,aAAc,EAEpCvuE,EAAMtT,YAED6hF,GACDjyF,EAAKkF,QAAQ,gBAAiBpH,KAI/B4lB,EAAMlb,QAAQkb,IASzBsuB,SAAU,SAAUnuC,EAAOwpE,GAEvBA,OAAkCllE,IAAlBklE,GAA8BA,EADnCptE,KAGNsN,OAAO1J,EAAOwpE,GAENllE,MAATtE,GACA5D,KAAK4D,MAAQA,EACb5D,KAAKiyF,cAAgBruF,EAAM5C,QAE3BhB,KAAK4D,MAAQ,KACb5D,KAAKiyF,cAAgB,OAK7BpK,SAAU,SAAUjkF,GAChB,OAAIA,GAASA,EAAMi9D,YAEXvjE,GAAIsG,EAAMA,MACVA,MAAOA,EAAM5C,MACbA,MAAO4C,EAAM5C,OAId4C,GAMXwjE,YAAa,SAAUF,GACnB,IACIrmD,EADO7gB,KACM0S,WAAWmO,MACxBjd,EAFO5D,KAEM2S,WAEjB,GAJW3S,KAIFwS,0BAGA3F,OAAOY,KAAKqT,QAAQD,IAArB,MAA+Bjd,EAAkD,CAEjF,GAAsB,iBAAX,QAAoCsE,IAAbtE,EAAMtG,GACpC,OAEJ4pE,EAAarmD,GAASjd,IASlCsiD,WAAY,WACR,IACIroD,KADOmC,KAID1B,OACNT,EALOmC,KAKG0S,WAAWmO,OALd7gB,KAK4B2S,YAL5B3S,KASN8hE,eAAejkE,OAAMqK,GAAW,IAQzC8B,QAAS,SAAU0vD,GACf,OAAO15D,KAAKsN,OAAOosD,IAGvB4S,SAAU,WACN,IAAI1oE,EAAQ5D,KAAK2S,WAEjB,YAAsB,IAAX,GAAmC,MAAT/O,IAEhB,iBAAVA,GAAmC,KAAbA,EAAMtG,SAAmC,IAAdsG,EAAQ,KAC5DiJ,OAAOY,KAAKqT,QAAQld,KAahCmlC,WAAY,SAAUnlC,GAClB,OAAOiJ,OAAOY,KAAKs7B,WAAWnlC,MCxOtCzG,EAAEklD,MAAM57C,OAAO,4BAMX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAEtB,GAAIA,EAAWi5E,4BAA6B,CACxC,IAAIj1E,EAAUhE,EAAWk5E,0BAA4B5rF,KAAK+M,YAAY,kDACtE2F,EAAWm5E,mBAAqBz4B,WAAc1gD,EAAWi5E,4BAA6Bj1E,QAAWA,KAQzGy0D,cAAe,WACX,IAAI9sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,QAU9C,OAPWpyD,EAAE0E,SAASxD,GAClBuF,MAAO5D,KAAK0S,WAAW9O,MACvBkoF,kBAAiD,IAA3B9rF,KAAK0S,WAAgB,MAC3C2rC,SAAUr+C,KAAK0S,WAAW2rC,SAC1B0G,SAAU/kD,KAAK0S,WAAWqyC,YASlCqmB,eAAgB,WACZ,IAAI/sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,kBAC1C3rD,EAAQ5D,KAAK2S,WAOjB,OALI9F,OAAOY,KAAKmS,SAAShc,KACrBA,EAAQA,EAAM+X,WAAW,IAAK,UAI3Bxe,EAAE0E,SAASxD,GAAWuF,MAAOA,EAAOmhD,SAAU/kD,KAAK0S,WAAWqyC,YAMzE5gD,WAAY,WAERnE,KAAKsN,SAELtN,KAAKuuB,MAAQvuB,KAAK0rE,aAAapoE,KAAK,SAGL,WAA3BtD,KAAK0S,WAAWwyD,QAChBllE,KAAK4oF,sBAMbA,mBAAoB,aAMpBxiB,kBAAmB,WACf,IAAIrmE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlBA,EAAW65B,MACXxsC,EAAKwuB,MAAMge,MAAMA,KAAM75B,EAAW65B,OAGtCxsC,EAAKwuB,MAAMvpB,KAAK,SAAU,WAGtBjF,EAAKgyC,SAAShyC,EAAKwuB,MAAMnf,OAAO,GAIN,cAAtBsD,EAAWwyD,SACPnlE,EAAKiK,kBAAyE,IAAlC0I,EAA4B,oBAExE3S,EAAKgyC,SAAShyC,EAAKwuB,MAAMnf,OAAO,KAIzCwgC,SAAS,SAAU3hC,GAElB,IAAI+7E,GADJ/7E,EAAIoQ,OAAOqI,OAASzY,GACDqgC,UAAYrgC,EAAE6/B,aAEvB5lC,IAAN+F,GACkB,IAAd+7E,GACA7sF,EAAE6C,MAAMiF,QAAQ,aAWhC+E,QAAS,SAAU0vD,GACf,IACIhnD,EADO1S,KACW0S,WAElBgoD,EAAS16D,KAAKsN,OAAOosD,GACrB91D,EAJO5D,KAIM2S,WAIjB,GAAoB,iBAAT/O,EACP,GAAI8O,EAAWm5E,kBAAmB,CAC9B,IAAIl7C,EAAQ,IAAIliC,OAAO,IACvB,IACIkiC,EAAQ,IAAIliC,OAAOiE,EAAWm5E,kBAAkBz4B,YAClD,MAAOnlD,GACDpB,OAAOwkB,SAAS6gE,wBAChBrlF,OAAO6T,IAAIzS,GACXyrD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASzI,EAAEyI,UAC1DgkD,GAAS,GAIjB,GAAI92D,IAAWA,EAAMka,MAAM,IAAIrP,OAAO,yDAA0D,QAAY7K,EAAMka,MAAM6yB,IArBrH3wC,KAqBoI0S,YAAwC,aArB5K1S,KAqBuJ0S,WAAWmO,OAAwB,CACzL,IAAInK,EAAUhE,EAAWm5E,kBAAkBn1E,QAC3CgjD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,OAET,GAAI92D,IAAWA,EAAMka,MAAM,IAAIrP,OAAO,yDAA0D,QAAY7K,EAAMka,MAAM6yB,IAAU,CAC1Hj6B,EAAUhE,EAAWm5E,kBAAkBn1E,QAC3CgjD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,QAOjB,GAAI92D,GAAUA,EAAMka,MAAM,IAAIrP,OAAO,aAAc,OAAW7K,EAAMka,MAAM,IAAIrP,OAAO,iBAAkB,OAC/FiE,EAAWqyC,SAAU,CACjBruC,EAAU1W,KAAK+M,YAAY,kDAE/B2sD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,EAMzB,OAAOA,GAOXqG,gBAAiB,SAAUn9D,GACvB,IACI6O,EADOzS,KACQ0rE,aACfnqD,EAAe1U,OAAOY,KAAK2T,UAAUxd,GAEzC,IAAKiJ,OAAOY,KAAKuF,aAJNhT,KAIwB0S,WAAWqyC,UAE1C,GAAuB,iBAAZ,EAAsB,CAE7B,IAAI9d,EAAiBp6B,OAAOY,KAAKu5B,oBAR9BhnC,KAQuD2tE,mBAE1Dl7D,EAAQlP,KAAK,mCAAqC0jC,EAAiB,iBAE/Dp6B,OAAOY,KAAKuS,OAAOpc,IACnB6O,EAAQlP,KAAK,IAbdvD,KAmBN+xC,SAASxwB,GAAc,IAOhCwwB,SAAU,SAAUnuC,GAChB5D,KAAKsN,OAAO1J,IAShB6mF,cAAe,SAAUh4E,EAAS20E,EAAcsD,GAC5Cj4E,EAAQ5U,KAAK,WAAYupF,GACzB30E,EAAQrD,IAAI,IAEZ,IAEIqD,EAAQvR,QAAQ,WAClB,MAAO+M,IAGTwE,EAAQnR,KAAK,QAASopF,GACtBj4E,EAAQvR,UAER,IAAIypF,EAAgBxtF,EAAEgW,eACtBV,EAAQvR,UAAUuL,GAAG,cAAe,SAAUia,EAAOna,GACjDA,EAAGrL,QAAQ4D,OAAO6lF,KAItBl4E,EAAQvR,QAAQ,QAEhBY,WAAW,WACP2Q,EAAQ40B,SACT,MAWPygD,cAAe,SAAUlkF,EAAOulE,GAC5B,OAAGA,EAAU,GAAKvlE,EAAMsB,QAAQikE,EAAiBvlE,EAC1CA,EAAMgV,OAAO,EAAGuwD,MCnP/BhsE,EAAEklD,MAAM57C,OAAO,8BAOX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAW0jE,QAAU1jE,EAAW0jE,SAAW,GAG3C1jE,EAAWg3D,YAAc,QAGzBh3D,EAAWosD,UAAW,EAItBpsD,EAAWmhC,eAAiBnhC,EAAWmhC,iBAAkB,GAO7Ds3B,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,UAG9C,OAAOpyD,EAAE0E,SAASxD,GACd+3E,QALOp2E,KAKO0S,WAAW0jE,QACzB/vE,SANOrG,KAMQ0S,WAAWpM,UAAY,GACtCy+C,SAPO/kD,KAOQ0S,WAAWqyC,YAQlCqmB,eAAgB,WAEZ,OAAOprE,KAAKmrE,iBAMhBW,mBAAoB,WAEhB9rE,KAAKsN,SAELtN,KAAK4tE,WAAWvsE,SAAS,0BAM7B8C,WAAY,WAERnE,KAAKsN,SAELtN,KAAK4tE,WAAWvsE,SAAS,0BAO7Bu4E,SAAU,WAEN,OADW55E,KAAK0gC,mBACJk5C,YAOhB3tB,cAAe,WACX,IAAIlsD,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBoxC,EAAepxC,EAAWoxC,cAAgB,GAS9C,OAPIpxC,EAAWy/E,gCACXruC,EAAeA,EAAeA,EAAe,IAAMpxC,EAAWy/E,8BAAgCz/E,EAAWy/E,+BAI7GpyF,EAAK2gC,mBAAmBl/B,eAEjBzB,EAAKgjE,YAAYzf,cAAc2I,eAClCpI,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,OAAS,GAC3BijC,aAAcA,GAAgB,GAC9BM,YAAa1xC,EAAW0xC,cACzB+jB,OAAO,WAEN,OADApoE,EAAK2gC,mBAAmB3+B,aACjBsM,UAAYA,UAAU,QAAKnG,KAQ1Cg0E,YAAa,WACEl8E,KAAK0gC,mBACXw7C,YAAYl8E,KAAK0S,WAAWpV,KAOrC04E,cAAe,WACAh2E,KAEF0S,WAAWqyC,UAFT/kD,KAIFoyF,mBASb/pB,oBAAqB,SAAUh9D,GAC3B,IAGI+qD,GAFJ/qD,EAASA,OAEY+qD,UAAW,EAHrBp2D,KAKN85D,eAAe,gBAAiBtb,OAL1Bx+C,KAKwCo2D,QAASA,KAOhEg8B,gBAAiB,WACb,IAAIryF,EAAOC,KAGXD,EAAK2gC,mBAAmBq4B,0BAExBh5D,EAAK65E,WAAW3pE,KAAK,WACjB,OAAOlQ,EAAKksD,kBACb9jD,KAAK,SAAUJ,GAEd,GAAc,MAAVA,GAA4B,GAAVA,GAAoC,YAAlBA,EAAOA,QAAwC,YAAhBA,EAAOkC,KAC1E,OAAOlK,EAAKm8E,cACT,GAAoB,uBAAhBn0E,EAAOkC,KACd,IAEIlK,EAAK2gC,mBAAmB47C,qBAAqBv0E,EAAOg0E,UACtD,MAAO9tE,OAIdmC,KAAK,SAAUjB,EAAGiI,EAAGV,GAEpB,IACI3W,EAAK2gC,mBAAmB67C,gBAAgB7lE,GAC1C,MAAOzI,QAMjB29D,cAAe,SAAUN,EAAex5C,GAChCw5C,IACAtrE,KAAK0/D,sBAAsB5tC,EAAOsT,YAClCplC,KAAKsN,QAAQg+D,EAAex5C,KAIpC4tC,sBAAuB,SAAUhB,GAC7B,YAAqB,IAAVA,EAA8B1+D,MAE3B,SAAV0+D,EACA1+D,KAAKquE,qBAAqBruE,KAAK0rE,cAAct5D,MAAM,aAAcssD,EAAO,aAExE1+D,KAAKquE,qBAAqBruE,KAAK0rE,cAAchnE,IAAI,aAAc,IAG5D1E,OAGXquE,qBAAsB,SAAUgkB,GAC5B,OAAOl1F,EAAE,QAASk1F,IAOtBlrB,UAAW,WAEP,OAAO,KC9MfhqE,EAAEklD,MAAM57C,OAAO,iCAKX08D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAW0jE,QAAW1jE,EAAW0jE,SAAiC,KAAtB1jE,EAAW0jE,QAAiB1jE,EAAW0jE,QAAU,oCAC7F1jE,EAAW4/E,WAAa5/E,EAAW4/E,WAAa5/E,EAAW4/E,WAAa,EAGxE5/E,EAAWg3D,YAAc,QAGzB1pE,KAAKypE,mCAGL/2D,EAAWosD,UAAW,GAK1BqM,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,aAE9C,OAAOpyD,EAAE0E,SAASxD,GACd+3E,QAAS1jE,EAAW0jE,WAM5BhL,eAAgB,WAIZ,OAHWprE,KAGCmrE,iBAMhBjf,gBAAiB,SAAUC,GACvB,IACIz5C,EADO1S,KACW0S,WAEtB,OAHW1S,KAGC+iE,YAAY7W,iBACpBrI,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,cAAgB,GACzCM,YAAa1xC,EAAW0xC,YACxB+H,YAAaA,EACbtF,UARO7mD,KAQSsxE,kBAQxB4K,YAAa,WACT,IACIxpE,EADO1S,KACW0S,WADX1S,KAGK0gC,mBACXw7C,YAAYxpE,EAAWpV,KAMhCs8E,SAAU,WAGN,OAFW55E,KACK0gC,mBACJk5C,cChFpBz8E,EAAEklD,MAAM57C,OAAO,4BAOX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAWosD,UAAW,EACtBpsD,EAAWg3D,YAAc,QAGzB1pE,KAAKypE,oCAOT0B,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,QAG9C,OAAOpyD,EAAE0E,SAASxD,GACd87C,YALOn6C,KAKW0S,WAAWynC,YAC7Bw2B,MANO3wE,KAMK0S,WAAW62D,WACvBxkB,SAPO/kD,KAOQ0S,WAAWqyC,YAOlC5gD,WAAY,WACRnE,KAAKsN,SACLtN,KAAK4tE,WAAWvsE,SAAS,0BAO7B+pE,eAAgB,WAEZ,OAAOprE,KAAKmrE,iBAMhBW,mBAAoB,WAChB9rE,KAAKsN,SACLtN,KAAK4tE,WAAWvsE,SAAS,0BAO7B2I,QAAS,SAAU0vD,KAQnBqH,gBAAiB,SAAUn9D,KAQ3BujE,UAAW,WACP,OAAO,KClFfhqE,EAAEklD,MAAM57C,OAAO,iCAKX08D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAW6/E,WAAa1lF,OAAOY,KAAKuF,aAAaN,EAAW6/E,cAAe,EANhEvyF,KAON+xC,SAASr/B,EAAW9F,OAPd5M,KAQNgwE,uBAMT7rE,WAAY,WACR,IACIsO,EADOzS,KACQ0rE,aADR1rE,KAINsN,SAJMtN,KAKNgzE,eAAiB71E,EAAE,+DAAgEsV,IAM5F04D,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAFvBvvD,KAEwCsmF,mBAC/C15E,EAHO5M,KAGM0S,WAAW9F,UAS5B,OAPWzP,EAAE0E,SAASxD,EAAUlB,EAAEsJ,OALvBzG,KAKmCymF,qBAC1CnpF,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClB6lE,OAAQ75E,OAAOY,KAAK4e,aAAa,IAAO,KACxC+3B,YAAa1xC,EAAW0xC,YACxBx3C,MAAOA,MASf05E,gBAAiB,WACb,MAAO,aAOXK,UAAW,WACP,OAAO,GAOXC,gBAAiB,WACb,OAAO,GAMXH,kBAAmB,WAIf,OACI+L,UAJOxyF,KACW0S,WAGI6/E,aAM9BtwB,UAAW,aAIXlwB,SAAU,SAAUnuC,GAChB5D,KAAK4D,MAAQiJ,OAAO8K,MAAM/T,IAG9B+O,SAAU,SAAU9U,GAChB,OAAOmC,KAAK4D,aC/FpBzG,EAAEklD,MAAM57C,OAAO,oCAIdugE,cAAe,SAAU3oE,GACxB,IAAI0B,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB8yC,EAAOzlD,EAAK2gC,mBAEhB3gC,EAAKkgE,kBAAoB,IAAI9iE,EAAE4S,SAG/B1R,EAAWA,GAAY,gBACvB,IAAI+rE,EAAiBrqE,EAAK+iE,cAAcvT,YAAYlxD,GAGhD2C,EAAQ0R,EAAWynC,YACH,iBAATn5C,IAMVA,GADAA,GADAA,GADAA,GADAA,GADAA,EAAQA,EAAM2a,WAAW,IAAK,UAChBA,WAAW,IAAK,UAChBA,WAAW,IAAK,QAAQA,WAAW,IAAK,SACxCA,WAAW,IAAM,SAASA,WAAW,IAAK,SAASA,WAAW,IAAK,UACnEA,WAAW,MAAO,UAClBA,WAAW,KAAM,UAIhC,IAAIpY,EAAOpG,EAAE0E,SAASuoE,GACrBppE,MAAOA,EACPspE,eAAoC,QAAnB53D,EAAWzI,MAAkByI,EAAW63D,WACzDzmE,YAAa4O,EAAW5O,YACxB4gE,SAAUhyD,EAAWgyD,SACrBpnE,GAAIoV,EAAWpV,GACf0G,SAA6B,WAAnBjE,EAAK8jE,UACfv7D,kBAAmBoK,EAAWpK,kBAC9ByiE,aAAcvlB,EAAKn6C,OAAOu5C,aAC1Bv+C,SAAUqM,EAAWpM,UAAY,GACjCnB,KAAMuN,EAAWvN,OAId4C,EAAShI,EAAKkrE,wBAsBlB,OArBKljE,IACJA,EAAS,IAIsB,iBAAb,GAAyBA,EAAOI,KAK3B,aAAnBJ,EAAOK,SAEV7E,EAAOxD,EAAKmrE,mBAAmB3nE,EAAMxD,EAAKsI,cAAcN,IACxDhI,EAAK+gE,oBAAsB,OAG3B/gE,EAAK+gE,oBAAsB/4D,EAC3BxE,EAAOxD,EAAKmrE,mBAAmB3nE,EAAM,KAVtCA,EAAOxD,EAAKmrE,mBAAmB3nE,EAAMwE,GAc/BxE,GAMRmoE,WAAY,WAKX,QAJW1rE,KACDyS,SADCzS,KACgByS,mBAAmBnG,QAAkC,IADrEtM,KACkDyS,QAAQvN,UAD1DlF,KAELyS,QAFKzS,KAEUC,SAFVD,KAIDyS,SAAkC,GAJjCzS,KAIeyS,QAAQvN,OAJvBlF,KAOCyS,QAFJ,MAQTq6D,iBAAkB,SAAUD,GAM3B,OALIhgE,OAAOY,KAAKuF,aAAa65D,GAC5B7sE,KAAK0rE,aAAahnE,IAAI,aAAc,SAAU,cAE9C1E,KAAK0rE,aAAahnE,IAAI,aAAc,SAAU,cAExC1E,MAMRgtE,oBAAqB,SAAUD,GAC9B,IAAI3D,EAAcppE,KAAK0S,WAAW02D,gBACjC4F,EAAkBniE,OAAOY,KAAKuF,aAAao2D,EAAY6D,YAAc,gBAAkB,GAUxF,OARIpgE,OAAOY,KAAKuF,aAAa+5D,GAC5B/sE,KAAK0rE,aAAahnE,IAAI,kBAAmBsqE,EAAkB,YAAa,cAExEhvE,KAAK0rE,aAAapoE,KAAK,KAAKzC,KAAK,SAAUC,EAAGb,GAC7C9C,EAAE8C,GAASyE,IAAI,kBAAmBsqE,EAAiB,gBAI9ChvE,QC3GT7C,EAAEklD,MAAM57C,OAAO,mCAIX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAMhB8/D,cAAe,WACAnrE,KACK6jE,UADL7jE,KAGS0S,WAAW9O,MAH/B,IAOI6uF,EAPOzyF,KAOY8iE,cAAcvT,YAAY,gBAejD,OAAOpyD,EAAE0E,SAAS4wF,GAAcC,iBAAiB,KAMrDC,WAAY,WACR,IAEItnF,GACAwV,MAHO7gB,KAGK0S,WAAWmO,MACvBuwC,OAJOpxD,KAIM4D,MAAM8nC,KACnBkY,aALO5jD,KAKY4D,MAAMggD,aACzB5mC,MAAO,GACP8F,OAAQ,IAGZ,OAVW9iB,KAUC+iE,YAAY5R,iBAAiB9lD,IAM7CunF,YAAa,WACT,IAEI9nF,GACAsmD,OAHOpxD,KAGM4D,MAAM8nC,KACnBkY,aAJO5jD,KAIY4D,MAAMggD,aACzB/iC,MALO7gB,KAKK0S,WAAWmO,MACvB7D,MAAO,GACP8F,OAAQ,GACRS,KAROvjB,KAQI4D,MAAMA,OAGrB,OAXW5D,KAWC+iE,YAAYngB,eAAeN,OAAO,uCAAuCuwC,gBAAgB/nF,MCtE7G3N,EAAEklD,MAAM57C,OAAO,kCAIX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAMhB8/D,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,eAG9C,OADWpyD,EAAE0E,SAASxD,GAAW87C,YAHtBn6C,KAGwC0S,WAAWynC,iBChBtEh9C,EAAEklD,MAAM57C,OAAO,mCAKX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,GAEZrL,KAAK0S,WAAWosD,UAAW,EAG3B9+D,KAAK0S,WAAWg3D,YAAc,QAC9B1pE,KAAK0S,WAAW42D,WAAatpE,KAAKs+D,mBAAmBgL,YAAc,OAGnEtpE,KAAKypE,oCAQT0B,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,gBAC1C3rD,EAFO5D,KAEM0S,WAAWynC,aAFjBn6C,KAEqC0S,WAAW9O,OAAS,GAGpE,OADWzG,EAAE0E,SAASxD,GAAWuF,MAAOA,OC7BhDzG,EAAEklD,MAAM57C,OAAO,kCAIX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAGhB83D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGKmC,KAAK0S,YAO1By4D,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,eAG9C,OADWpyD,EAAE0E,SAASxD,GAAWuF,MAHtB5D,KAGkC0S,WAAW9O,MAAMmhD,SAHnD/kD,KAGkE0S,WAAWqyC,YAM5FqmB,eAAgB,WAGZ,OAFWprE,KAECmrE,mBCnCpBhuE,EAAEklD,MAAM57C,OAAO,iCAEZg8C,2BAA4B51C,OAAO2xC,OAAOC,SAAS8D,QAAQE,2BAC3DC,4BAA6B71C,OAAO2xC,OAAOC,SAAS8D,QAAQG,4BAC5DC,cAAe91C,OAAO2xC,OAAOC,SAAS8D,QAAQI,gBAK9CnrC,KAAM,SAAUnM,GAEbrL,KAAKsN,OAAOjC,IAMf83D,eAAgB,SAAUtlE,GAGvBmC,KAAKsN,OAAOzP,GAEZ,IAAI2nD,EAJOxlD,KAIK0gC,mBAGZhuB,EAAa1S,KAAK0S,WAEtBA,EAAWqyC,UAAW,EACtBryC,EAAWizC,aAAc,EAEzBjzC,EAAW0zC,YAAeZ,EAAKn6C,QAAUm6C,EAAKn6C,OAAOxN,MAAQ2nD,EAAKn6C,OAAOxN,KAAKwmD,YAAemB,EAAKn6C,OAAOxN,KAAKwmD,YAAc,GAC5H3xC,EAAWogF,gBAAkBpgF,EAAWogF,kBAAmB,GAM9DC,oBAAqB,SAASrgF,GAC3B,IAEIsgF,EAOAC,EARAxvE,EAAQtmB,EAAE4S,WAGVijF,EADAtgF,EAAW9O,MAAMA,MACL8O,EAAW9O,MAAMA,MAGjB8O,EAAW9O,MAG3B,IAVW5D,KAWA2oD,kCACLsqC,EAAgBt2E,KAAKhE,MAAM,cAAkBq6E,EAAa,KAC1DvvE,EAAMtT,QAAQuC,EAAYugF,IAG1B91F,EAAEqM,KAhBGxJ,KAgBOkzF,4BAA4B/qF,KAAK,SAASgrF,GACnDF,EAAgBt2E,KAAKhE,MAAM,cAAkBw6E,EAAe,KAC5D1vE,EAAMtT,QAAQuC,EAAYugF,KAInC,MAAMG,GACHH,EAAgBt2E,KAAKhE,MAAM,kBAC3B8K,EAAMtT,QAAQuC,EAAYugF,GAC1BxyE,QAAQ4yE,KAAK,2CAA4CD,GAE5D,OAAO3vE,EAAMlb,WAGhBogD,+BAAgC,WAC7B,IAEIloB,EAFOzgC,KAEc0gC,mBACzB,OAAOD,EAAcp1B,OAAOoqE,cAAgBh1C,EAAcp1B,OAAOoqE,aAAa5xB,UAOjFqvC,yBAA0B,WACvB,IAEI7nF,GACDwV,MAHQ7gB,KAGI0S,WAAWmO,MACvBuwC,OAJQpxD,KAIK4D,MAAM8nC,KACnBkY,aALQ5jD,KAKW4D,MAAMggD,cAG5B,OARW5jD,KAQC+iE,YAAY1R,mCAAmChmD,IAM9DsH,SAAU,WACP,OAAO3S,KAAKszF,OAMfC,eAAgB,WACb,OAAOvzF,KAAK0S,WAAWmO,SCtG7B1jB,EAAEklD,MAAM57C,OAAO,qCAIX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAGhB83D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGKmC,KAAK0S,WACXqyC,UAAW,GAM1BomB,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,kBAG9C,OADWpyD,EAAE0E,SAASxD,GAAWuF,MAAO5D,KAAK0S,WAAW9O,SAM5DwnE,eAAgB,WAGZ,OAFWprE,KAECmrE,iBAGhBp5B,SAAU,SAAUnuC,EAAOwpE,GACV,OAAVxpE,GAA4B,KAAVA,EACjB5D,KAAK0S,WAAW9O,MAAQ,GAEgB,SAAnCA,EAAMkN,WAAWL,eAA+D,UAAnC7M,EAAMkN,WAAWL,gBACnEzQ,KAAK0S,WAAW9O,MAAQiJ,OAAOY,KAAKuF,aAAapP,GAAS5D,KAAK+M,YAAY,sBAAwB/M,KAAK+M,YAAY,sBAExH/M,KAAKsN,OAAOtN,KAAK0S,WAAW9O,MAAOwpE,MC7C3CjwE,EAAEklD,MAAM57C,OAAO,sCAIX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAOhB83D,eAAgB,SAAUtlE,GACXmC,KAENsN,OAAOzP,GAGZ,IAAI6U,EALO1S,KAKW0S,WAClBsC,EANOhV,KAMW+M,YAAY,cAC9BkrB,EAPOj4B,KAOW+M,YAAY,cAUlC,GAPA2F,EAAWg7D,aAAe,GAC1Bh7D,EAAW8lB,cAAmCtwB,IAAxBwK,EAAW8lB,UAAyB3rB,OAAOY,KAAKuF,aAAaN,EAAW8lB,UAC9F9lB,EAAWsC,WAAatC,EAAWsC,YAAcA,EACjDtC,EAAWulB,WAAavlB,EAAWulB,YAAcA,EACjDvlB,EAAWk4E,WAAal4E,EAAWsC,WAG/BtC,EAAW8lB,UACuC,IAA9C9lB,EAAWk4E,WAAW95C,OAAO,cAC7Bp+B,EAAWk4E,WAAal4E,EAAWk4E,WAAa,IAAMl4E,EAAWulB,gBAGrE,CACA,IAAIu7D,EAAY9gF,EAAWk4E,WAAW95C,OAAO,aAC1B,IAAf0iD,IACA9gF,EAAWk4E,WAAal4E,EAAWk4E,WAAWpsE,UAAU,EAAGg1E,EAAY,IAK/E,GAAI9gF,EAAW9O,MAAO,CAClB,IAAIkxB,EAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB7lB,EAAW9O,MAAO8O,EAAW8lB,UAGvF,GAAY,GAAR1D,EAAW,CACX,IAAI+1D,EAAqBh+E,OAAOC,aAAaC,YAAY,sBAnCtD/M,KAoCE4D,MAAQ8O,EAAW9O,MACxB8O,EAAWg7D,aAAe7gE,OAAOY,KAAKgmB,cAAcD,WAAWsB,EAAMpiB,EAAWk4E,WAAYC,QArCzF7qF,KAwCE4D,MAAQ,UAxCV5D,KA4CF4D,MAAQ,KACb8O,EAAW9O,MAAQ,GACnB8O,EAAWg7D,aAAe,IAOlCvC,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,oBAC1C3rD,EAAmC,OAF5B5D,KAEO0S,WAAW9O,OAA4C,KAF9D5D,KAEyC0S,WAAW9O,MAAiB,GAFrE5D,KAE+E0S,WAAW9O,MAGrG,OAAOzG,EAAE0E,SAASxD,GAAWuF,MAAOA,KAMxCm9D,gBAAiB,SAAUn9D,GACvB,IAAiB6vF,EACb/gF,EADO1S,KACW0S,WAClBy4E,EAFOnrF,KAEYorF,iBACnB3yD,EAAmB,qBAcvB,GAjBWz4B,KAINi2B,KAAOppB,OAAOC,aAAaC,YAAY,sBAExCnJ,EAAMsB,QAAUuzB,EAAiBvzB,QAAUtB,EAAMsB,QAAWuzB,EAAiBvzB,OAAS,EACtFuuF,EAAU5mF,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,GAAO,KAGhE6vF,EAAU5mF,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,KACzC6Y,MAAMxJ,KAAK0F,MAAM86E,KAAct2F,EAAEgjB,UAAUszE,IACvDA,EAAQ/6D,SAAS,EAAG,EAAG,EAAG,GAK9B90B,IAAU6Y,MAAMxJ,KAAK0F,MAAM/U,IAAS,CACpC,IAAI8vF,EAAoB7mF,OAAOY,KAAKgmB,cAAcD,WAAWigE,EAAS/gF,EAAWk4E,WAlB1E5qF,KAkB2Fi2B,MAClGk1D,EAAYh5E,KAAKuhF,KAOzBtI,eAAgB,WAGZ,OAFWprF,KACNmrF,YAAchuF,EAAE,8BADV6C,KAC8C0rE,cAD9C1rE,KAECmrF,eC7GpBhuF,EAAEklD,MAAM57C,OAAO,oCAIX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAKhB83D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAClBof,EAAS9xB,KAAK+M,YAAY,iBAE9B2F,EAAWmgB,mBAAsD,IAA9BngB,EAAwB,cAAoB7F,OAAOY,KAAKuF,aAAaN,EAAWmgB,eAAiB7yB,KAAKmoF,wBAAwBz1E,EAAW2hB,UAC5K3hB,EAAW01E,YAAc11E,EAAWmgB,cAAiBngB,EAAW01E,YAAc11E,EAAW01E,YAAyD,oBAAnC,6BAAiD52D,6BAA6Bd,cAAgB,EAAM,EACnNhe,EAAWie,OAAS,GACpBje,EAAWqe,eAAiBe,EAAOf,eACnCre,EAAWoe,eAAiBgB,EAAOhB,eACnCpe,EAAW2d,cAA0D,oBAAnC,6BAAiDmB,6BAA6BlB,iBAAmBwB,EAAOzB,cAC1I3d,EAAW6d,iBAA6D,oBAAnC,6BAAiDiB,6BAA6BhB,eAAiBsB,EAAOvB,iBAC3I7d,EAAWme,YAAc7wB,KAAKuqF,sBAAsB73E,EAAW2hB,UAC/D3hB,EAAWke,SAAWle,EAAW41E,qBAAsB,GAM3Dnd,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,iBAG9C,OADWpyD,EAAE0E,SAASxD,GAAWuF,MAHtB5D,KAGkC0S,WAAW9O,SAM5DwnE,eAAgB,WAGZ,OAFWprE,KAECmrE,iBAMhBwC,gBAAiB,SAAU/pE,GACvB,IACI8O,EADO1S,KACW0S,WAIlB1R,GALOhB,KAEQ0rE,aAGPvuE,EAAE,YAAYoG,KAAKK,IAe/B,OAbKA,EAAMkN,WAAWgN,MADR,0BAEV9c,EAAM+wB,gBAEEpB,OAAQje,EAAWie,OACnBI,eAAgBre,EAAWqe,eAC3BD,eAAgBpe,EAAWoe,eAC3BT,cAAe3d,EAAW2d,cAC1BE,iBAAkB7d,EAAW6d,iBAC7BM,YAAane,EAAWme,YACxBJ,oBAAqB/d,EAAW01E,YAChCx3D,SAAUle,EAAWke,WAG1B5vB,EAAMmR,QAMjBg2E,wBAAyB,SAAU9zD,GAC/B,GAAIA,EAAU,CAEV,GAAgB,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,EACpE,OAAO,EAGX,GAAgB,GAAZA,GAA6B,GAAZA,GAA6B,IAAZA,GAA8B,IAAZA,EACpD,OAAO,EAGf,OAAO,GAKXk2D,sBAAuB,SAAUl2D,GAC7B,GAAIA,EAAU,CAEV,GAAgB,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,GAA6B,GAAZA,EACpE,OAAO,EAGX,GAAgB,GAAZA,GAA6B,GAAZA,GAA6B,IAAZA,GAA8B,IAAZA,EACpD,OAAO,EAGf,OAAO,KC3Gfl3B,EAAEklD,MAAM57C,OAAO,mCAIX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAMhB83D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAClBof,EAAS9xB,KAAK+M,YAAY,iBAG9B2F,EAAWihF,gBAAgD,IAA3BjhF,EAAqB,YAAoBA,EAAWihF,WAEhFjhF,EAAWihF,WACXjhF,EAAWie,OAASje,EAAWkhF,eAAiBlhF,EAAWkhF,eACZ,oBAAnC,6BAAiDpiE,6BAA6Bb,OAASmB,EAAOnB,OAG1Gje,EAAWie,OAAS,GAExBje,EAAWme,aAAc,KC/BjC1zB,EAAEklD,MAAM57C,OAAO,yCAKX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,IAOhB83D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGKmC,KAAK0S,YAO1By4D,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,sBAC1C3rD,EAFO5D,KAEM0S,WAAW9O,OAFjB5D,KAE+B0S,WAAWynC,aAAe,GAGpE,OADWh9C,EAAE0E,SAASxD,GAAWuF,MAAOA,OChChDzG,EAAEklD,MAAM57C,OAAO,mCAMX+Q,KAAM,SAAU3Z,GAEZmC,KAAKsN,OAAOzP,GACZmC,KAAK6zF,YAAcx1E,OAAOT,UAAUi2E,YAEpC,IAAInhF,EAAa1S,KAAK0S,WACtBA,EAAWohF,aAAmE,IAArDjnF,OAAOY,KAAKuF,aAAaN,EAAWohF,cAOjE3oB,cAAe,WACX,IACI9sE,EADO2B,KACS8iE,cAAcvT,YAAY,eAI9C,OADWpyD,EAAE0E,SAASxD,EAJX2B,KAI0B0S,aAQzC1I,QAAS,SAAU0vD,GAEf,OAAO15D,KAAKsN,OAAOosD,IAQvBqH,gBAAiB,SAAUn9D,GAEvB5D,KAAK+xC,SAASnuC,GAAO,IAOzBwiE,kBAAmB,aASnB2tB,mBAAoB,SAAUC,EAAiBhmF,GAC3C,IAAIjO,EAAOC,KAEX,QAAkC,IAAtBD,EAAgB,YAA5B,CAkBA,OAAOA,EAAK8zF,YAAYE,mBAZR,SAAU5uD,GAClB6uD,GACAA,EAAgB7uD,IAGV,SAAUxJ,GACpB,IAAIqiD,EAAaj+E,EAAKk0F,gBAAgBt4D,GAElC3tB,GACAA,EAAcgwE,KAddhwE,GACAA,EAAcnB,OAAOC,aAAaC,YAAY,wCAAwCpI,QAAQ,MAAO5E,EAAK2S,WAAWzI,QAwBjIgqF,gBAAiB,SAAUt4D,GACvB,IAAIqiD,EAAa,GAGjB,OAAQriD,EAAMmN,MACV,KAAKnN,EAAMu4D,kBACX,KAAK,EACDlW,EAAanxE,OAAOC,aAAaC,YAAY,wCAC7C,MACJ,KAAK4uB,EAAMw4D,qBACX,KAAK,EACDnW,EAAanxE,OAAOC,aAAaC,YAAY,2CAC7C,MACJ,KAAK4uB,EAAMy4D,QACX,KAAK,EACDpW,EAAanxE,OAAOC,aAAaC,YAAY,8BAC7C,MACJ,QACIixE,EAAa,OAASnxE,OAAOC,aAAaC,YAAY,wCAI9D,OAAOixE,GAQXqW,iBAAkB,SAAUx2F,GACxB,IAAIg2F,EAAch2F,EAAKuD,MAAM,MAAQ,GAErC,IAAKyyF,EAAa,OAAOh2F,EAEzB,IACI,IAAIy2F,EAAWl0E,WAAWyzE,EAAY,GAAG32E,QACrCq3E,EAAYn0E,WAAWyzE,EAAY,GAAG32E,QAE1C,OAAOo3E,EAASE,YAAY,IAAM,IAAMD,EAAUC,YAAY,IAChE,MAAOvmF,GACL,OAAOpQ,MClInBV,EAAEklD,MAAM57C,OAAO,mCAKX08D,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAEZ,IAAI6U,EALO1S,KAKW0S,WAGtBA,EAAWwO,SAAW,UACtBxO,EAAWmxC,SATA7jD,KASgB0S,WAAWpV,GACtCoV,EAAW+hF,eAA4C,IAAxB/hF,EAAW+hF,WAA4B5nF,OAAOY,KAAKuF,aAAaN,EAAW+hF,WAC1G/hF,EAAWgiF,aAAwC,IAAtBhiF,EAAWgiF,SAA0B7nF,OAAOY,KAAKuF,aAAaN,EAAWgiF,SACtGhiF,EAAWq4C,UAAYr4C,EAAWgiF,QAIlChiF,EAAWiiF,SAAWjiF,EAAWiiF,aACjCjiF,EAAWkiF,UAAYliF,EAAWkiF,cAE9BliF,EAAW9O,OAnBJ5D,KAoBF60F,wBASb1pB,cAAe,WACX,IAAIprE,EAAOC,KACP3B,EAAW0B,EAAK+iE,cAAcvT,YAAY,eAC1CkS,EAAM,IAAItkE,EAAE4S,SAyBhB,OAvBAhQ,EAAK2S,WAAWwO,SAAW,UAC3BnhB,EAAK2S,WAAWmxC,SAAW9jD,EAAK2S,WAAWpV,GAG3CH,EAAEqM,KAAKzJ,EAAK+qD,sBACP3iD,KAAK,SAAU2sF,GAGZ/0F,EAAKg1F,eAELh1F,EAAK2S,WAAWgiF,QAAU7nF,OAAOY,KAAKuF,aAAa8hF,KAAS,EAE5D,IAAIvxF,EAAOpG,EAAE0E,SAASxD,EAAU0B,EAAK2S,YACjCsiF,cAAej1F,EAAKi1F,cACpBC,oBAAqBl1F,EAAKk1F,sBAI9Bl1F,EAAKgyC,SAASp1B,KAAKC,OAAO7c,EAAK2S,WAAWwiF,aAE1CzzB,EAAItxD,QAAQ5M,KAGbk+D,EAAIl5D,WAOfuiD,mBAAoB,WAIhB,MAAY,aAHD9qD,KACK6jE,WADL7jE,KAIK+iE,YAAYjY,mBAJjB9qD,KAIyC0S,aAQxDi7D,gBAAiB,WAIb,OAHW3tE,KACM2S,YAQrB2zE,gBAAiB,WACb,MAAO,eASX0O,cAAe,WACX,IACItiF,EADO1S,KACWnC,KAClBA,KACAs3F,EAAkBziF,EAAWgiF,QAAUhiF,EAAWkiF,UAAYliF,EAAWiiF,SAM7E,OAJAx3F,EAAE0D,KAAKs0F,EAAiB,SAASp0F,EAAKkoC,GAClCprC,EAAK+K,MAAOtL,GAAI2rC,EAAK3rC,GAAIsG,MAAOqlC,EAAKrlC,UAGlC/F,GAMXo3F,oBAAqB,SAAUG,GAC3B,IACI1iF,EADO1S,KACWnC,KAClBw3F,KAGAC,EAAY,SAAUF,EAAQG,GAC9B,IAAIC,GAAU,EAOd,OANAr4F,EAAE0D,KAAK6R,EAAWwiF,WAAWtxF,MAAO,SAAU7C,EAAK6C,IAC1C4xF,GAAW5xF,EAAMtG,IAAM83F,GAAUxxF,EAAMA,MAAMsG,QAAQqrF,IAAY,IAClEC,GAAU,KAIXA,GAwBX,OApBI9iF,EAAWgiF,QAEXv3F,EAAE0D,KAAK6R,EAAWiiF,SAAU,SAAU5zF,EAAKlD,GACvCw3F,EAAYzsF,MACRtL,GAAIO,EAAKP,GACT2D,KAAMpD,EAAK+F,MACX4xF,QAASF,EAAUz3F,EAAKP,GAAI83F,OAKpCj4F,EAAE0D,KAAK6R,EAAWkiF,UAAW,SAAU7zF,EAAKlD,GACxCw3F,EAAYzsF,MACRtL,GAAIO,EAAKP,GACT2D,KAAMpD,EAAK+F,MACX4xF,QAASF,EAAUF,EAAQv3F,EAAKP,QAKrC+3F,GAIXI,cAAe,SAAUL,EAAQM,GAC7B,IAAI31F,EAAOC,KAEX7C,EAAE0D,KAAKd,EAAK2S,WAAWwiF,WAAWtxF,MAAO,SAAU7C,EAAKlD,GAChDkC,EAAK2S,WAAWgiF,QACZ72F,EAAKP,IAAMo4F,GAEXv4F,EAAE0D,KAAKd,EAAK2S,WAAWwiF,WAAWtxF,MAAM7C,GAAY,MAAG,SAAU0/E,EAAWkV,GACpEP,GAAUO,GAEV51F,EAAK2S,WAAWwiF,WAAWtxF,MAAM7C,GAAY,MAAE8Y,OAAO4mE,EAAW,KAItE5iF,EAAKP,IAAM83F,GAElBj4F,EAAE0D,KAAKd,EAAK2S,WAAWwiF,WAAWtxF,MAAM7C,GAAY,MAAG,SAAU0/E,EAAWkV,GACpED,GAAWC,GAEX51F,EAAK2S,WAAWwiF,WAAWtxF,MAAM7C,GAAY,MAAE8Y,OAAO4mE,EAAW,OAKjF1gF,EAAKgyC,SAASp1B,KAAKC,OAAO7c,EAAK2S,WAAWwiF,cAI9CU,WAAY,SAAUR,EAAQM,GAC1B,IAAI31F,EAAOC,KAEX7C,EAAE0D,KAAKd,EAAK2S,WAAWwiF,WAAWtxF,MAAO,SAAU7C,EAAKlD,GAChDkC,EAAK2S,WAAWgiF,QACZ72F,EAAKP,IAAMo4F,GAEX31F,EAAK2S,WAAWwiF,WAAWtxF,MAAM7C,GAAY,MAAE6H,KAAKwsF,GAEjDv3F,EAAKP,IAAM83F,GAElBr1F,EAAK2S,WAAWwiF,WAAWtxF,MAAM7C,GAAY,MAAE6H,KAAK8sF,KAG5D31F,EAAKgyC,SAASp1B,KAAKC,OAAO7c,EAAK2S,WAAWwiF,cAG9CH,aAAc,WACC/0F,KACN0S,WAAWwiF,WADLl1F,KACuB0S,WAAWwiF,aACzCW,UAFO71F,KAES0S,WAAWmjF,UAC3BC,WAHO91F,KAGU0S,WAAWojF,WAC5BC,aAJO/1F,KAIY0S,WAAWqjF,aAC9BC,cALOh2F,KAKa0S,WAAWsjF,cAC/BpyF,MANO5D,KAMK0S,WAAW9O,QAQ/B0oE,SAAU,WAGN,GAFWtsE,KAEF0S,WAAWwiF,WAChB,IAAIpjD,EAHG9xC,KAGW0S,WAAWwiF,WAAWtxF,WAExCkuC,EALO9xC,KAKO0S,WAAW9O,MAI7B,IAAK,IAAI9C,EAAI,EAAGiW,EAAI+6B,EAAO5sC,OAAQpE,EAAIiW,EAAGjW,IAAK,CAC3C,IAAIjD,EAAOi0C,EAAOhxC,GAClB,GAAIjD,GAAQA,EAAK+F,MAAMsB,OAAS,EAC5B,OAAO,EAIf,OAAO,GAOX2vF,qBAAsB,WAMlB,IALA,IACIniF,EADO1S,KACW0S,WAClBo/B,EAASp/B,EAAW9O,MACpBmE,KAEKjH,EAAI,EAAGiW,EAAI+6B,EAAO5sC,OAAQpE,EAAIiW,EAAGjW,IAAK,CAC3C,IAAI8C,EAAQkuC,EAAOhxC,GACnBiH,EAAOa,MAAOtL,GAAIsG,EAAM,GAAIA,MAAOA,EAAM,KAG7C8O,EAAW9O,MAAQmE,KChQ3B5K,EAAEklD,MAAM57C,OAAO,8BAKX08D,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAEZ,IAAI2nD,EALOxlD,KAKK0gC,mBAGZhuB,EAAa1S,KAAK0S,WAElBujF,EAAwBpsF,OAAO6I,EAAWwjF,UAAY,EACtDC,EAAiD,oBAAtB,sBAAoF,IAAvCC,gBAAiC,kBAAoBvsF,OAAOusF,gBAAgBC,mBAAqB,QAM7K,GAJA3jF,EAAWwjF,QAAUD,GAAyBE,EAC9CzjF,EAAW4jF,SAAWzsF,OAAO6I,EAAW4jF,WAAa,IACrD5jF,EAAW6jF,gBAAkB7jF,EAAW6jF,iBAAmB,GAEvD7jF,EAAW6jF,gBAAgBrxF,OAAS,GAAKwN,EAAW6jF,gBAAgBrsF,QAAQ,KAAO,EAAG,CAItF,IAHA,IAAIssF,EAAmB9jF,EAAW6jF,gBAAgB5xF,QAAQ,OAAQ,IAAIvD,MAAM,KACxEq1F,KAEK31F,EAAI,EAAGA,EAAI01F,EAAiBtxF,OAAQpE,IACzC,GAAI01F,EAAiB11F,GAAGoE,OAAS,EAC7BuxF,EAAc7tF,KAAK,KAAO4tF,EAAiB11F,QACxC,CAES01F,EAAiBtsF,QAAQssF,EAAiB11F,IACtD01F,EAAiB38E,OAAO/Y,EAAG,GAInC4R,EAAW6jF,gBAAkBE,EAAc/9E,KAAK,KAGpDhG,EAAWmuE,OAASnuE,EAAWmuE,QAlCpB7gF,KAkCmC+iE,YAAYla,kBAC1Dn2C,EAAWuuE,UAAYvuE,EAAWuuE,gBAAa/4E,EAC/CwK,EAAWqyC,SAAWl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,YAAa,EACvEryC,EAAWizC,cAAoE,OAArD94C,OAAOY,KAAKuF,aAAaN,EAAWizC,eAAyBjzC,EAAWqyC,WAAYl4C,OAAOY,KAAKuF,aAAaN,EAAWizC,aAElJjzC,EAAW0zC,YAAeZ,EAAKn6C,QAAUm6C,EAAKn6C,OAAOxN,MAAQ2nD,EAAKn6C,OAAOxN,KAAKwmD,YAAemB,EAAKn6C,OAAOxN,KAAKwmD,YAAc,GAC5H3xC,EAAWogF,gBAAkBpgF,EAAWogF,kBAAmB,EAxChD9yF,KA2CNszF,MAAQ5gF,EAAW9O,UA3Cb5D,KA4CNsyF,WA5CMtyF,KA4CYszF,MAAMpuF,QAOjCimE,cAAe,WAgBX,IAfA,IAAIprE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBrU,EAAW0B,EAAK+iE,cAAcvT,YAAY,UAG1ChsD,EAAOpG,EAAE0E,SAASxD,GAClBwiB,MAAOhU,OAAOY,KAAKmT,YAAY7gB,EAAKwzF,kBACpCxuC,SAAUryC,EAAWqyC,SACrB2xC,UAA+B,IAApB32F,EAAKuyF,WAChBqE,QAA6B,IAApB52F,EAAKuyF,WACdQ,gBAAiBpgF,EAAWogF,kBAI5BlmF,EAAQ,GACH9L,EAAI,EAAGA,EAAIf,EAAKuyF,WAAYxxF,IAAK,CACtC,IAAImqB,GAAQ3tB,GAAIyC,EAAKuzF,MAAMxyF,GAAG,GAAIopD,SAAUnqD,EAAKuzF,MAAMxyF,GAAG,IAG1D8L,GAFW7M,EAAK62F,iBAAiB3rE,GAMrC,OADA1nB,EAAOxD,EAAK82F,iBAAiBtzF,EAAMqJ,IAQvCw+D,eAAgB,WACZ,OAAOprE,KAAKmrE,iBAQhByrB,iBAAkB,SAAU3rE,GACxB,IACIprB,EADOG,KACK6jE,UACZizB,EAFO92F,KAEa+2F,sBACpB14F,EAHO2B,KAGS8iE,cAAcvT,YAAYunC,GAG1CpzE,EANO1jB,KAMKmyE,kBANLnyE,KAMmCg3F,aAAa/rE,GAAvB,GAWpC,OATW9tB,EAAE0E,SAASxD,GAClBf,GAAI2tB,EAAK3tB,GACTuC,KAAMA,EACN6jB,IAAKA,EACLiiC,YAZO3lD,KAYW0S,WAAWizC,YAC7BsxC,SAAUhsE,EAAKi/B,SACfnF,SAdO/kD,KAcQ0S,WAAWqyC,YAWlCiyC,aAAc,SAAU/rE,GACpB,IACIvY,EADO1S,KACW0S,WAClB8yC,EAFOxlD,KAEK0gC,mBAEhB,OAJW1gC,KAIC+iE,YAAYxa,kBACpB1E,SAAUnxC,EAAWpV,GACrBujB,MANO7gB,KAMKuzF,iBACZzvC,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBoE,OAAQv9B,EAAK3tB,GACbupD,UAAWrB,EAAK9yC,WAAWm0C,UAC3BT,YAAa1zC,EAAW0zC,eAUhCywC,iBAAkB,SAAUtzF,EAAMoB,GAC9B,OAAOpB,EAAKoB,QAAQ,YAAaA,IASrCuyF,iBAAkB,SAAUjuD,EAAMuf,GAC9B,IAAIzoD,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmO,EAAQ9gB,EAAKwzF,kBAAoB1mF,OAAOY,KAAK0S,UAAUqoC,GAAU,OAASA,EAAS,IAAM,QAAUA,EAAS,MAEhH,OAAOzoD,EAAKgjE,YAAY9Z,kBACpBvlC,IAAKhR,EAAWuuE,UAChBp9B,SAAUnxC,EAAWpV,GACrBujB,MAAOA,EACPijC,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBgC,YAAa1zC,EAAW0zC,cACzBn2C,KAAK,WAGJlQ,EAAKuyF,WAAavyF,EAAKuyF,WAAa,EAGpCvyF,EAAKuzF,MAAQn2F,EAAEq5D,KAAKz2D,EAAKuzF,MAAO,SAAU6D,GACtC,OAAOA,EAAS,IAAM3uC,OASlC2e,UAAW,WAEP,OAAO,GAQXp1B,SAAU,SAAUnuC,EAAOwpE,GACZptE,KAGNszF,MAAQ1vF,MAHF5D,KAINsyF,WAJMtyF,KAIYszF,MAAMpuF,OAJlBlF,KAONsN,OAAO1J,EAAOwpE,IAOvBz6D,SAAU,WACN,OAAO3S,KAAKszF,OAQhBtpF,QAAS,SAAU0vD,GACf,IAEIhjD,EADAhE,EADO1S,KACW0S,WAElBgoD,GAAS,EAMb,GATW16D,KAMNo5D,qBAAqB,IAGtB1mD,EAAWosD,UAAYpsD,EAAWqyC,SAAU,CAC5C,IAAI79C,EAVGlH,KAUW1B,MAVX0B,KAUwB1B,KAAKyzE,iBAAiB3jE,MAV9CpO,MAYP,GAZOA,KAYEsyF,YAAc,IAAMprF,IAZtBlH,KAamB1B,MAbnB0B,KAa+B1B,KAAKoU,WAAWuyD,cAG9CvuD,EAhBD1W,KAgBgB+M,YAAY,0BAA0B4O,WAAW,UAAWjJ,EAAWynC,aACtFuf,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,IACxDgkD,GAAS,GAKrB,OAAOA,GAMX08B,eAAgB,WACZ,IACI1kF,EADO1S,KACW0S,WAClB8yC,EAFOxlD,KAEK0gC,mBACZ7iC,KACAqhC,EAJOl/B,KAIOqiD,MAAMK,4BAExB7kD,EAAKqhC,EAAS,SANHl/B,KAMmBuzF,iBAC9B11F,EAAKqhC,EAAS,YAAcxsB,EAAWpV,GACvCO,EAAKqhC,EAAS,gBAAkBxsB,EAAWoxC,aAC3CjmD,EAAKqhC,EATMl/B,KASQqiD,MAAMM,eAAiBjwC,EAAW0xC,YACrDvmD,EAVWmC,KAUDqiD,MAAMI,2BAA6B,aAAe+C,EAAK9yC,WAAWm0C,UAC5EhpD,EAAKqhC,EAAS,eAAiBxsB,EAAW0zC,YAE1C,IACyC,oBAA1B,oBACPvoD,EAAKw5F,qBAAuB7xC,EAAK9yC,WAAWm0C,UAE5ChpD,EAAiB,WAAI2nD,EAAK9yC,WAAWm0C,UAE3C,MAAO54C,GACLpQ,EAAiB,WAAI2nD,EAAK9yC,WAAWm0C,UAGzC,OAAOhpD,GAOX01F,eAAgB,WACZ,OAAOvzF,KAAK0S,WAAWmO,OAG3BwsD,cAAe,SAAU3T,GACrB,IACIhnD,EADO1S,KACW0S,WAEtB,GAAI7F,OAAOY,KAAKuF,aAAaN,EAAWosD,UACpC,GAJO9+D,KAIE1B,OAA2C,IAJ7C0B,KAIe1B,KAAKoU,WAAW25D,WAClC,IALGrsE,KAKOssE,aALPtsE,KAK4B0rE,aAAavhC,QAAQ,MAAMtsC,KAAK,WAE3D,OAPDmC,KAMMs3F,kBAAkB59B,EAAiBhnD,IACjC,OAGX,IAVG1S,KAUOssE,WAEN,OAZDtsE,KAWMs3F,kBAAkB59B,EAAiBhnD,IACjC,EAKnB,OAAO,GAGX4kF,kBAAmB,SAAU59B,EAAiBhnD,GAC1C,IACIgE,EADO1W,KACQ+M,YAAY,wBAAwB4O,WAAW,UAAWjJ,EAAWynC,aACxFuf,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,KAM5DqgF,oBAAqB,WACjB,MAAO,gBCzTf55F,EAAEklD,MAAM57C,OAAO,2BAMX08D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAEZ,IACI6U,EADO1S,KACW0S,WAMtB,GAJAA,EAAWwjF,QAAUrsF,OAAO6I,EAAWwjF,WAA0C,oBAAtB,sBAAoF,IAAvCE,gBAAiC,kBAAoBvsF,OAAOusF,gBAAgBC,mBAAqB3jF,EAAWwjF,QAAUrsF,OAAO6I,EAAWwjF,UAAY,SAC5PxjF,EAAW6kF,SAAW1tF,OAAO6I,EAAW4jF,WAAa,IACrD5jF,EAAW6jF,gBAAkB7jF,EAAW6jF,iBAAmB,GAEvD7jF,EAAW6jF,gBAAgBrxF,OAAS,GAAKwN,EAAW6jF,gBAAgBrsF,QAAQ,KAAO,EAAG,CAEtF,IADA,IAAIssF,EAAmB9jF,EAAW6jF,gBAAgBn1F,MAAM,KAC/CN,EAAI,EAAGA,EAAI01F,EAAiBtxF,OAAQpE,IACzC01F,EAAiB11F,GAAK,KAAO01F,EAAiB11F,GAElD4R,EAAW6jF,gBAAkBC,EAAiB99E,KAAK,KAGvDhG,EAAWmuE,OAfA7gF,KAec+iE,YAAYngB,eAAeN,OAAO,yBAA2B,wBACtF5vC,EAAWquE,QAhBA/gF,KAgBe+iE,YAAYngB,eAAeN,OAAO,yBAA2B,+BACvF5vC,EAAWuuE,UAAYvuE,EAAWuuE,gBAAa/4E,EAC/CwK,EAAWizC,YAAmE,OAArD94C,OAAOY,KAAKuF,aAAaN,EAAWizC,cAAwB94C,OAAOY,KAAKuF,aAAaN,EAAWizC,aACzHjzC,EAAW8kF,QAAU3qF,OAAOY,KAAKmT,YAAYlO,EAAWmO,OACxDnO,EAAW+kF,kBAA2CvvF,IAA5BwK,EAAW+kF,cAA0D,OAA5B/kF,EAAW+kF,cAA+B5qF,OAAOY,KAAKuF,aAAaN,EAAW+kF,cAEjJ,IAAIziF,EAAahV,KAAK+M,YAAY,cAC9BkrB,EAAaj4B,KAAK+M,YAAY,cAGlC2F,EAAWg7D,aAAe,GAC1Bh7D,EAAW8lB,cAAmCtwB,IAAxBwK,EAAW8lB,UAAyB3rB,OAAOY,KAAKuF,aAAaN,EAAW8lB,UAC9F9lB,EAAWsC,WAAatC,EAAWsC,YAAcA,EACjDtC,EAAWulB,WAAavlB,EAAWulB,YAAcA,EACjDvlB,EAAWk4E,WAAal4E,EAAWsC,WA9BxBhV,KAiCNszF,MAAQ5gF,EAAW9O,UAjCb5D,KAkCNsyF,WAlCMtyF,KAkCYszF,MAAMpuF,OAE7BwN,EAAWoxC,aAAe9jD,KAAKo9B,OAAO1qB,WAAWoxC,cAAgBpxC,EAAWoxC,cAAgB,IAUhGqnB,cAAe,SAAUusB,EAAaC,GAClC,IAAI53F,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBrU,EAAW0B,EAAK+iE,cAAcvT,YAAY,OAC1C1vD,EAAOE,EAAK8jE,UACZpgD,EAAQ,IAAItmB,EAAE4S,SAElB2C,EAAW9O,MAAQ,IAAqB+zF,EAAexuC,aAAcwuC,EAAeztC,WAAanqD,EAAK6D,MACtG,IAAIL,EAAOpG,EAAE0E,SAASxD,EAAUqU,GAC5BklF,iBAAkB73F,EAAK63F,iBACvBC,QAAS93F,EAAK83F,UAGlB,GAA6B3vF,MAAzBnI,EAAK2S,WAAW9O,MAAoB,CAEpC,IAAIk0F,EAAe/3F,EAAK2S,WAAW9O,MAAMsB,OAEpB,IAAjB4yF,GACAr0E,EAAMtT,QAAQ5M,GAGlBpG,EAAE0D,KAAKd,EAAK2S,WAAW9O,MAAO,SAAU7C,EAAK6C,GACzC,IAAI/F,KAEJA,EAAKsrD,aAAevlD,EAAM,GAC1B/F,EAAKqsD,SAAWtmD,EAAM,GACtB/F,EAAKumD,YAAcrkD,EAAK2S,WAAW0xC,YACnCvmD,EAAKimD,aAAe/jD,EAAKsjE,kBACzBxlE,EAAKurD,MAAQrpD,EAAK2S,WAAWmO,MAC7BhjB,EAAKknD,SAAWhlD,EAAK2S,WAAWqyC,SAChClnD,EAAKwrD,SAAWtpD,EAAK2S,WAAW22C,SAEhC,IAAI7D,EAAOzlD,EAAK2gC,mBACZ8kB,GAAQA,EAAK9yC,YAAc8yC,EAAK9yC,WAAWm0C,YAC3ChpD,EAAKgpD,UAAYrB,EAAK9yC,WAAWm0C,WAGxB,cAAThnD,GACA1C,EAAEqM,KAAKzJ,EAAKg4F,iBAAiBl6F,EAAM85F,IAAiBxvF,KAAK,SAAU8gC,GAC/D6uD,IAEIjrF,OAAO+W,OAAOo0E,qBAA6E,IAAtDnrF,OAAO+W,OAAOo0E,oBAAoB9tF,QAAQ,UAC/E++B,EAAOA,EAAKttB,WAAW,wBAAyB,sBAGpDpY,EAAOxD,EAAKk4F,gBAAgB10F,EAAMxD,EAAK2S,WAAWpV,GAAK,IAAMO,EAAKsrD,aAAclgB,GAC3D,IAAjB6uD,GACAr0E,EAAMtT,QAAQ5M,YAO9BkgB,EAAMtT,QAAQ5M,GAElB,OAAOkgB,EAAMlb,WAGjB0vF,gBAAiB,SAAU10F,EAAMjG,EAAIqH,GACjC,OAAOpB,EAAKoB,QAAQ,KAAOrH,EAAK,KAAMqH,IAG1CozF,iBAAkB,SAAUl6F,EAAM85F,GAC9B,IAAI53F,EAAOC,KACPwlD,EAAOzlD,EAAK2gC,mBACZw3D,EAAmBn4F,EAAK+iE,cAAcvT,YAAY,gBAElDr/C,EAAW/S,EAAE4S,WAmCjB,OAjCA5S,EAAEqM,KAAKzJ,EAAKgjE,YAAY7Z,eAAerrD,GACnC,GAAoB85F,GAAkB53F,EAAKgjE,YAAYhZ,kBAAkBlsD,IAC3EsK,KAAK,SAAUgwF,EAAUR,GAEvBA,EAAe,GAAG95F,KAAOA,EAGzB85F,EAAe,GAAG7zC,aAAe6zC,EAAe,GAAG7zC,cAAgB0B,EAAK9yC,WAAWoxC,cAAgB,GACnG6zC,EAAe,GAAG92E,MAAQ9gB,EAAK2S,WAAWmO,MAE1Cs3E,EAAS,GAAGlB,SAAWp5F,EAAKqsD,SAC5BiuC,EAAS,GAAGz0E,IAAM3jB,EAAKi3F,aAAaW,EAAe,IAGnDQ,EAAS,GAAGC,cAAgBT,EAAe,GAAGU,UAC9CF,EAAS,GAAGG,cAAgBX,EAAe,GAAGviC,UAC9C+iC,EAAS,GAAGI,wBAA0BZ,EAAe,GAAGa,oBACxDL,EAAS,GAAGM,gBAAkBd,EAAe,GAAGhyC,YAChDwyC,EAAS,GAAGO,uBAAyBf,EAAe,GAAGgB,mBACvDR,EAAS,GAAGS,cAAgBjB,EAAe,GAAGkB,UAC9CV,EAAS,GAAGW,kBAAoBnB,EAAe,GAAGoB,cAClDZ,EAAS,GAAGa,wBAA0BrB,EAAe,GAAGsB,oBACxDd,EAAS,GAAGe,cAAgBr7F,EAAKknD,UAAY4yC,EAAe,GAAG/xC,UAC/DuyC,EAAS,GAAGC,cAAgBT,EAAe,GAAGU,UAC9CF,EAAS,GAAGgB,cAAgBxB,EAAe,GAAGxuC,aAC9CgvC,EAAS,GAAGt3E,MAAQ82E,EAAe,GAAG92E,MACtCs3E,EAAS,GAAGv0F,MAAQiJ,OAAOY,KAAKuF,aAAa2kF,EAAe,GAAG/zF,OAC/Du0F,EAAS,GAAGh1C,WAAat2C,OAAOgH,eAEhC,IAAItQ,EAAOpG,EAAE0E,SAASq2F,EAAkBC,EAAS,IACjDjoF,EAASC,QAAQ5M,KAGd2M,EAAS3H,WAGpBsvF,QAAS,SAAU5sE,GACf,IAAImuE,EAAYp5F,KAAK43F,iBAAiB3sE,GAGtC,OAFa,MAAO,OAAQ,MAAO,MAAO,OAE5B/gB,QAAQkvF,EAAUj9E,gBAAkB,GAGtD06E,iBAAkB,SAAUtzF,EAAMoB,GAC9B,OAAOpB,EAAKoB,QAAQ,YAAaA,IAOrCymE,eAAgB,WACZ,OAAOprE,KAAKmrE,iBAOhBhE,UAAW,WAEP,OAAO,GAQX6vB,aAAc,SAAU/rE,GACpB,IACIm/B,EAAcv9C,OAAO8e,OAAO,cAMhC,OAJIV,EAAKptB,OACLotB,EAAKptB,MAAQqsD,SAAUj/B,EAAKi/B,SAAUb,SAAUp+B,EAAKo+B,WAJ9CrpD,KAOC+iE,YAAY5Y,eACpBhB,aAAcl+B,EAAKk+B,aACnBC,MAAOn+B,EAAKpK,OAASoK,EAAKm+B,MAC1BtF,aAAc74B,EAAK64B,aACnBuF,SAAUp+B,EAAKptB,KAAKwrD,SACpBjF,YAZOpkD,KAYW0S,WAAW0xC,YAC7B8F,SAAUj/B,EAAKptB,KAAKqsD,SAASvlD,QAAQ,KAAM,KAC3CylD,YAAaA,EACbvD,UAAW57B,EAAKptB,KAAKgpD,WAAa,MAI1CuwC,eAAgB,WACZ,IACI1kF,EADO1S,KACW0S,WAClB7U,KAUJ,OANAA,EAAKurD,MAAQ12C,EAAWmO,MACxBhjB,EAAKwrD,SAAW32C,EAAW22C,SAC3BxrD,EAAKimD,aAAepxC,EAAWoxC,aAC/BjmD,EAAKgsD,cACLhsD,EAVWmC,KAUDqiD,MAAMK,4BAVL1iD,KAUwCqiD,MAAMM,eAAiBjwC,EAAW0xC,YAE9EvmD,GAQX+5F,iBAAkB,SAAU1tC,GAExB,OADAA,EAAWA,GAAY,IACP9oD,MAAM,KAAKg9C,OAQ/BrM,SAAU,SAAUnuC,EAAOwpE,GACvB,IACI16D,EADO1S,KACW0S,WADX1S,KAINsN,OAAO1J,EAAOwpE,GAJRptE,KAONszF,MAAQ5gF,EAAW9O,UAPb5D,KAQNsyF,WARMtyF,KAQaszF,MAAY,OARzBtzF,KAQkCszF,MAAMpuF,OAASwN,EAAW9O,OAO3Ey/D,gBAAiB,WACb,OAAOrjE,KAAK0S,WAAWoxC,cAAgB,IAO3CyvC,eAAgB,WACZ,OAAOvzF,KAAK0S,WAAWmO,OAS3Bq2E,iBAAkB,SAAUjuD,EAAMuf,GAC9B,IAAIzoD,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElBrH,GACA89C,aAAcX,EACdY,MAAO12C,EAAWmO,MAClBwoC,SAAU32C,EAAW22C,SACrBjF,YAAa1xC,EAAW0xC,YACxBN,aAAc/jD,EAAKsjE,mBAGvB,OAAOtjE,EAAKgjE,YAAYpZ,cAAct+C,GAAQ4E,KAAK,WAG/ClQ,EAAKuyF,WAAavyF,EAAKuyF,WAAa,EAGpCvyF,EAAKuzF,MAAQn2F,EAAEq5D,KAAKz2D,EAAKuzF,MAAO,SAAU6D,GACtC,OAAOA,EAAS,IAAM3uC,OAWlC6wC,eAAgB,SAAU7wC,GACtB,IACI91C,EADO1S,KACW0S,WAElBrH,GACA89C,aAAcX,EACdY,MAAO12C,EAAWmO,MAClBwoC,SAAU32C,EAAW22C,SACrBjF,YAAa1xC,EAAW0xC,YACxBN,aARO9jD,KAQYqjE,mBAGvB,OAXWrjE,KAWC+iE,YAAYtZ,aAAap+C,IASzCiuF,iBAAkB,SAAU9wC,GACxB,IACI91C,EADO1S,KACW0S,WAElBrH,GACA89C,aAAcX,EACdY,MAAO12C,EAAWmO,MAClBwoC,SAAU32C,EAAW22C,SACrBjF,YAAa1xC,EAAW0xC,YACxBN,aARO9jD,KAQYqjE,mBAGvB,OAXWrjE,KAWC+iE,YAAYrZ,eAAer+C,MCxV/ClO,EAAEklD,MAAM57C,OAAO,6BAMX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAW9O,WAAqC,IAArB8O,EAAgB,MAAmB7F,OAAOY,KAAKuF,aAAaN,EAAW9O,OAAS,MAM/GunE,cAAe,WACX,IAAI9sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,SAC1C24B,EAAWr7E,OAAOY,KAAK4e,aAAa,IAAK,KAQ7C,OALWlvB,EAAE0E,SAASxD,GAClBf,GAAI4qF,EACJnjC,SAAU/kD,KAAK0S,WAAWqyC,YASlC4oB,gBAAiB,WACb,IAAI/pE,EAAQ5D,KAAK2S,WAEjB,OAAwC,IAApC9F,OAAOY,KAAKuF,aAAapP,GAClB5D,KAAK+M,YAAY,uBACmB,IAApCF,OAAOY,KAAKuF,aAAapP,GACzB5D,KAAK+M,YAAY,qBAEjB,IAQfu/D,SAAU,WACN,IAAI1oE,EAAQ5D,KAAK2S,WAEjB,OAAI9F,OAAOY,KAAKg+B,aAAa7nC,IACc,OAApCiJ,OAAOY,KAAKuF,aAAapP,MCrDxCzG,EAAEklD,MAAM57C,OAAO,8BAMX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAGZmC,KAAKu5F,cAAe,GAQxBpuB,cAAe,WACX,IAAI9sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,UAG9C,OAAOpyD,EAAE0E,SAASxD,IAOtB+sE,eAAgB,WACZ,IAAI/sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,mBAG9C,OAAOpyD,EAAE0E,SAASxD,IAMtButD,iBAAkB,WAId,OAFA5rD,KAAKu5F,cAAe,EAEbv5F,KAAK+iE,YAAYnX,kBACpBloC,IAAK1jB,KAAK0S,WAAW4vC,OACrBuB,SAAU7jD,KAAK0S,WAAWpV,GAC1BujB,MAAO7gB,KAAKw5F,WACZ11C,aAAc9jD,KAAKy5F,kBACnBr1C,YAAapkD,KAAK0S,WAAW0xC,eAQrC0H,kBAAmB,SAAUniC,GACzB,OAAO3pB,KAAK+iE,YAAYjX,mBACpBpoC,IAAK1jB,KAAK0S,WAAWyuE,QACrBt9B,SAAU7jD,KAAK0S,WAAWpV,GAC1BujB,MAAO7gB,KAAKw5F,WACZ11C,aAAc9jD,KAAKy5F,kBACnBr1C,YAAapkD,KAAK0S,WAAW0xC,YAC7Bz6B,QAASA,KAOjBkiC,qBAAsB,WAClB,OAAO7rD,KAAK+iE,YAAYlX,sBACpBhI,SAAU7jD,KAAK0S,WAAWpV,GAC1BujB,MAAO7gB,KAAKw5F,WACZ11C,aAAc9jD,KAAKy5F,kBACnBr1C,YAAapkD,KAAK0S,WAAW0xC,eAOrCw1B,SAAU,WAGN,OAFW55E,KACK0gC,mBACJk5C,YAGhB5vE,QAAS,SAAU0vD,GACf,IAEIhjD,EADAhE,EADO1S,KACW0S,WAItB,OAAoD,GAAhD7F,OAAOY,KAAKuF,aAAaN,EAAW2iD,WAGa,GAAjDxoD,OAAOY,KAAKuF,aAAaN,EAAWqyC,YAR7B/kD,KAWNo5D,qBAAqB,KAGtB1mD,EAAWosD,UACc,GAflB9+D,KAeEu5F,eACL7iF,EAhBG1W,KAgBY+M,YAAY,+BAA+B4O,WAAW,UAAWjJ,EAAWynC,aAC3Fuf,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,KACjD,MAUnB8iF,SAAU,WACN,OAAOx5F,KAAK0S,WAAWmO,OAM3B44E,gBAAiB,WACb,OAAOz5F,KAAK0S,WAAWoxC,gBC/H/B3mD,EAAEklD,MAAM57C,OAAO,gCAMX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAEtBA,EAAWg3D,YAAc,QACzBh3D,EAAWgnF,UAAmE,MAAvD7sF,OAAOY,KAAKuF,aAAahT,KAAK0S,WAAWgnF,YAAqB7sF,OAAOY,KAAKuF,aAAahT,KAAK0S,WAAWgnF,WAG9H15F,KAAKypE,oCAOT0B,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,YAG9C,OAAOpyD,EAAE0E,SAASxD,GACdf,GAAIoV,EAAWpV,GACfqzE,MAAOj+D,EAAW62D,WAClBpvB,YAAaznC,EAAWynC,YACxBv2C,MAAO8O,EAAW9O,MAClBmhD,SAAUryC,EAAWqyC,SACrB40C,WAAY9sF,OAAOY,KAAKuF,aAAaN,EAAWinF,cAAe,KAQvEvuB,eAAgB,WAEZ,OAAOprE,KAAKmrE,iBAOhBhnE,WAAY,WACRnE,KAAKsN,SACLtN,KAAK4tE,WAAWvsE,SAAS,0BAM7ByqE,mBAAoB,WAChB9rE,KAAKsN,SACLtN,KAAK4tE,WAAWvsE,SAAS,0BAO7By/E,kBAAmB,WACf,IACIpuE,EADO1S,KACW0S,WAGtB,OAAKA,EAAWqyC,UAAaryC,EAAW9O,MAJ7B5D,KAOC+iE,YAAY3W,cACpB1oC,IAAKhR,EAAWquE,QAChBl9B,SAAUnxC,EAAWpV,GACrBujB,MAVO7gB,KAUK45F,mBACZ91C,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,cAPjB,MAgBf88B,kBAAmB,SAAUrjF,GACzB,IAAIkC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGtB,IAAKA,EAAWqyC,WAAaryC,EAAW9O,MACpC,OAAO,KAEX,IAAIid,EAAQ9gB,EAAK65F,mBACb91C,EAAejjC,EAMnB,YAJyC,IAA7BnO,EAAuB,cAAiD,KAA5BA,EAAWoxC,eAC/DA,EAAejjC,EAAQnO,EAAWoxC,aAAe,IAAMjjC,EAAQnO,EAAWoxC,cAGvE/jD,EAAKgjE,YAAY1W,cACpB3oC,IAAKhR,EAAWyuE,QAChBt9B,SAAUnxC,EAAWpV,GACrBwmD,aAAcA,EACdoC,WAAYroD,IACbsK,KAAK,SAAUm9C,GACd,IAAIu0C,GAAwB,EAExBv0C,GAA8B,uBAAlBA,EAASr7C,OACrB4vF,GAAwB,GAExBA,GACA95F,EAAK+hE,sBASjBuf,sBAAuB,SAAUh2E,GAC7B,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAEtB,OAAOvV,EAAEqM,KAEAkJ,EAAWqyC,UAAaryC,EAAW9O,MAI7B7D,EAAKgjE,YAAYzW,kBACpB5oC,IAAKhR,EAAW4rE,YAChBz6B,SAAUnxC,EAAWpV,GACrBujB,MAAO9gB,EAAK65F,mBACZ91C,aAAcpxC,EAAWoxC,aACzBM,YAAa/4C,EAASA,EAAO+4C,YAAc1xC,EAAW0xC,cARnD,OAkBnB01C,oBAAqB,WACjB,IAAI/5F,EAAOC,KACP0S,EAAa3S,EAAK2S,WAEtB,OAAOvV,EAAEqM,KAEAkJ,EAAWqyC,UAAaryC,EAAW9O,MAG7B7D,EAAKgjE,YAAYxW,gBACpB7oC,IAAKhR,EAAW2rE,UAChBx6B,SAAUnxC,EAAWpV,GACrBujB,MAAO9gB,EAAK65F,mBACZ91C,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,cAPrB,OAiBnB21C,wBAAyB,WACrB,IAAIh6F,EAAOC,KACP0S,EAAa3S,EAAK2S,WAEtB,OAAOvV,EAAEqM,KAEAkJ,EAAWqyC,UAAaryC,EAAW9O,MAG7B7D,EAAKgjE,YAAYtW,gBACpB/oC,IAAKhR,EAAW0rE,cAChBv6B,SAAUnxC,EAAWpV,GACrBujB,MAAO9gB,EAAK65F,mBACZ91C,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,cAPrB,OAiBnB41C,kBAAmB,WACf,IAAIj6F,EAAOC,KACP0S,EAAa3S,EAAK2S,WAEtB,OAAOvV,EAAEqM,KAEAkJ,EAAWqyC,UAAaryC,EAAW9O,MAK7B7D,EAAKgjE,YAAY7c,YACpBxiC,IAAKhR,EAAW0rE,cAChBhzE,OAAQ,aACRy4C,SAAUnxC,EAAWpV,GACrBujB,MAAO9gB,EAAK65F,mBACZ91C,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,cAVrB,OAoBnBp6C,QAAS,SAAU0vD,KAQnBkgC,iBAAkB,WACd,OAAO55F,KAAK0S,WAAWmO,OAO3BsmD,UAAW,WACP,OAAO,GAOXpG,gBAAiB,SAAUn9D,OC5P/BzG,EAAEklD,MAAM57C,OAAO,mCAEXg8C,2BAA4B51C,OAAO2xC,OAAOC,SAAS8D,QAAQE,2BAC3DC,4BAA6B71C,OAAO2xC,OAAOC,SAAS8D,QAAQG,8BAM5DlrC,KAAM,SAAUnM,GACDrL,KAGNsN,OAAOjC,GAHDrL,KAMNi6F,cANMj6F,KAONgmF,aAAc,GAMvB7iB,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAWmzE,eAAeh5E,OAAOY,KAAKqT,QAAQpO,EAAWwnF,cAAexnF,EAAWmzE,aAE/EnzE,EAAW9O,YAAiCsE,IAAxBwK,EAAW9O,MAAMtG,KACrCoV,EAAW9O,MAAQ,MAVZ5D,KAYN4D,MAAQ8O,EAAW9O,MAGpB8O,EAAWmzE,eACXnzE,EAAW7U,KAhBJmC,KAgBgB+lF,eAAerzE,EAAW7U,QAMzDstE,cAAe,WACX,IACItrE,EADOG,KACK6jE,UAGZq2B,EAJOl6F,KAIYk6F,YAJZl6F,KAI+BimF,iBAC1C,GAAmB,MAAfiU,EAAqB,CACrB,IAAIplC,EAAajoD,OAAOY,KAAKs8B,cAAcmwD,EAAYxnF,WAAWzI,MAE9D,oBAAoBiI,KAAK4iD,KARtB90D,KASEgmF,aAAc,GAThBhmF,KAcNm6F,4BAA6B,EAGlC,IAAIpyF,EAAS/H,KAAKsN,SAMlB,MAJa,cAATzN,IAnBOG,KAoBFm6F,4BAA6B,GAG/BpyF,GAMXq+D,kBAAmB,WACJpmE,KACNm6F,4BAA6B,EADvBn6F,KAIFgmF,aAJEhmF,KAKFk6F,YAAYE,mBALVp6F,OASfq6F,0BAA2B,WACZr6F,KACNm6F,4BAA6B,EADvBn6F,KAIFgmF,aAJEhmF,KAKFk6F,YAAYE,mBALVp6F,OAWfmC,QAAS,SAAUkJ,EAAQivF,GACvB,IAAIv6F,EAAOC,KAGX7C,EAAEqM,KAAKzJ,EAAKgmE,cAAc59D,KAAK,WAM3B,IAAIsK,EAAU1S,EAAK2rE,aACf7rE,EAAOE,EAAK8jE,UAChBpxD,EAAQxQ,QAGR9E,EAAEqM,KAAKzJ,EAAKomF,YAAY96E,IAASwY,KAAK,SAAUtgB,GAE5CkP,EAAQlP,KAAKA,GAGbxD,EAAKoE,aAEO,aAARtE,GACAE,EAAKqmE,yBAIel+D,IAApBnI,EAAK4S,YACL5S,EAAKghE,gBAAgBhhE,EAAK4S,YAG1B5S,EAAKw6F,iBACLx6F,EAAKw6F,gBAAgBpqF,UAGzBpQ,EAAKkF,QAAQ,UAAWlF,EAAK6D,MAAO02F,SAShDl4F,QAAS,SAAUiJ,GAKf,MAAY,aAJDrL,KACK6jE,UADL7jE,KAI0B6mF,eAJ1B7mF,KAOFgmF,aAPEhmF,KAQEk6F,aAAe7uF,IARjBrL,KASE0S,WAAWo0E,kBAAmB,GAOpB,KAhBZ9mF,KAciBk6F,YAAyB,cAd1Cl6F,KAcmDk6F,YAAYjI,cAAc30F,GAAK,IAG9E0C,KAAKsN,OAAOjC,OAMpBrL,KAAKsN,OAAOjC,IAOvB+uF,mBAAoB,SAAUI,GAC1B,IAAIz6F,EAAOC,KACP80D,EAAajoD,OAAOY,KAAKs8B,cAAcywD,EAAe9nF,WAAWzI,MAGjE,oBAAoBiI,KAAK4iD,KAGzB/0D,EAAKk6F,WAAWrxF,KAAK4xF,GAGrBA,EAAeC,iBAAmB,SAAU/zE,EAAOuiB,EAAMqxD,GAErDv6F,EAAK26F,sBAAsBF,EAAgBvxD,EAAK3rC,GAAIyC,EAAK46F,eAAgBL,GAGpEA,GAEDE,EAAeI,cAIlB76F,EAAK86F,cAAc,WACpB96F,EAAKiF,KAAK,SAAUw1F,EAAeC,kBAIlC5tF,OAAOY,KAAKqT,QAAQ/gB,EAAK4S,aAGtB5S,EAAK2S,WAAWmzE,cAChB9lF,EAAK26F,sBAAsBF,EAAgBz6F,EAAK4S,WAAWrV,MAM3Eu9F,cAAe,SAAUn0E,GACrB,YAAgE,IAArDvpB,EAAE2W,MAAM9T,KAAKijE,kBAAkB5wD,IAAI,GAAI,gBAGyB,IAA5DlV,EAAE2W,MAAM9T,KAAKijE,kBAAkB5wD,IAAI,GAAI,UAAUqU,IAYpEo0E,qBAAsB,SAAUN,GAE5Bx6F,KAAKmnB,OAAO,SAAUqzE,EAAeC,mBAMzCC,sBAAuB,SAAUK,EAAWC,EAAa3zD,EAAOizD,GAC5D,IACIjvF,KACJA,EAFWrL,KAECqiD,MAAMI,2BAA6B,UAAYu4C,EAE3DD,EAAUR,gBAAkBp9F,EAAE4S,WAEzBuqF,GAEDS,EAAUhpD,SAAS,IAAI,GAG3BgpD,EAAU54F,QAAQkJ,EAAQivF,GAEtBjzD,GACAlqC,EAAEqM,KAAKuxF,EAAUR,gBAAgBhyF,WAAWJ,KAAK,WAC7C4yF,EAAUE,WAAWh2F,QAAQ,YASzCkqE,gCAAiC,WACfnvE,KAAK0rE,aACXzpE,SAMZ24F,WAAY,WACR56F,KAAK85D,eAAe,UAAWx8D,GAAI,KAMvC2oF,eAAgB,WACZ,IACIvzE,EADO1S,KACW0S,WAGtB,QAA+BxK,IAA3BwK,EAAWwnF,YACX,OAAO,KAaX,IAVA,IAAI10C,EAROxlD,KAQK0gC,mBACZo0B,EAAajoD,OAAOY,KAAKs8B,cATlB/pC,KASqC0S,WAAWzI,MACvD4d,EAAW,oBAAoB3V,KAAK4iD,GAActP,EAAKwxB,gBAAgBtkE,EAAWzI,SAElFnJ,EAAI,EACJwB,EAAI,EACJ6nC,KAEA13B,EAAU,KAEP3R,EAAI+mB,EAAS3iB,OAAQpE,IACpB4R,EAAWwnF,cAAgBryE,EAAS/mB,GAAG4R,WAAWpV,IAClD6sC,EAAQvhC,MAAM6J,QAASoV,EAAS/mB,GAAIK,MAAOL,IAInD,GAAIqpC,EAAQjlC,OAAS,GAGjB,IAFA,IAAIg2F,EAAmCC,EAEhC74F,EAAI6nC,EAAQjlC,OAAQ5C,IAOvB,GAHA44F,GADAC,EAFShxD,EAAQ7nC,GAAGmQ,QACCC,WAAWmO,MACNzf,MAAM,MACL8D,OACbi2F,EAAYjsF,MAAM,EAAGgsF,EAAe,GAAGxiF,KAAK,OAEtChG,EAAWmO,MAAO,CAClCpO,EAAUoV,EAASsiB,EAAQ7nC,GAAGnB,OAC9B,YAIRsR,EAAU+yC,EAAKiP,cAAc/hD,EAAWwnF,aAI5C,OAAOznF,GAMX00D,UAAW,WAIP,OAHWnnE,KAGCsN,UAAYT,OAAOY,KAAKkU,WAHzB3hB,KAGyCi6F,aAOxDrT,gBAAiB,WAGb,MAAY,aAFD5mF,KAAK6jE,WASpBwH,wBAAyB,WACVrrE,KAEDo7F,aAFCp7F,KAIFsN,SAJEtN,KAKFo7F,YAAa,IAI1BpqB,uBAAwB,SAAUnzE,EAAMizE,GACpC,IACIrtD,EAAQ,IAAItmB,EAAE4S,SAElB,OAHW/P,KAGFgmF,aAHEhmF,KAGkBmnE,kBAAqCj/D,IAHvDlI,KAGsCq5C,aAHtCr5C,KAIKsN,OAAOzP,EAAMizE,GACtBrtD,EAAMtT,WAKjBg8D,wBAAyB,WACVnsE,KAENsN,SAFMtN,KAIF4D,OAA6B,GAJ3B5D,KAIYgmF,cAJZhmF,KAKFosE,6BAA8B,EAL5BpsE,KAMFiF,QAAQ,UANNjF,KAMsB4D,OAAO,KAN7B5D,KASNosE,6BAA8B,KCzX3CjvE,EAAEklD,MAAM57C,OAAO,4BAOX08D,eAAgB,SAAStlE,GAErBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAW2oF,SAAW3oF,EAAW2oF,UAAY,GAQjD/U,gBAAiB,WACb,MAAO,QAQXM,gBAAiB,WACb,OAAO,KC/BfzpF,EAAEklD,MAAM57C,OAAO,mCAMX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAWqyC,SAA6D,OAAlDl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,WAAqBl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,UACnHryC,EAAW64C,WAAa1hD,OAAO6I,EAAW64C,aAAe,IAO7D4f,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,oBAE9C,OAAOpyD,EAAE0E,SAASxD,GACdf,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClBkkC,SAAUryC,EAAWqyC,SACrB4rB,MAAOj+D,EAAW62D,aAElBxgC,WAVO/oC,KAUU+oC,cAOzBqiC,eAAgB,WACZ,IACI14D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,oBAE9C,OAAOpyD,EAAE0E,SAASxD,GACdf,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClBkkC,SAAUryC,EAAWqyC,SACrB4rB,MAAOj+D,EAAW62D,aAElBxgC,WAVO/oC,KAUU+oC,cAQzB3mC,QAAS,WACL,IAAIrC,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SACd2C,EAAa1S,KAAK0S,WAqCtB,OAlCA3S,EAAKgjE,YAAYzf,cAAclhD,SAC3BshB,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBsC,YAAa1zC,EAAW0zC,aAAe,KACvChC,YAAa1xC,EAAW0xC,cACzBj8C,KAAK,SAAUtK,GAEd6U,EAAW7U,KAAOA,EAClB4lB,EAAMtT,QAAQuC,EAAW7U,QAE1BuS,KAAK,SAAUvS,GACd,GAAkB,kBAAdA,EAAKoM,KAAT,CAIA,IACIu7C,EAAOzlD,EAAK2gC,mBACZsmD,EAASjnF,EAAK2S,WAAWynC,YAAc,KAQ3C6sC,IANmB,iBAARnpF,EACE8e,MAAQA,KAAKhE,MAAM9a,IAASV,EAAE6tD,UAAUntD,GAExCA,GAGI6Y,QAEjB8uC,EAAK82B,qBAAqB0K,GAE1BvjE,EAAM6uC,OAAOz0D,MAGV4lB,EAAMlb,WAQjBwpC,SAAU,SAAUnuC,EAAOwpE,GACvBA,OAAkCllE,IAAlBklE,GAA8BA,EAE9CxpE,EAAQ+Y,KAAKC,QAAQhZ,MAASA,IAE9B5D,KAAKsN,OAAO1J,EAAOwpE,IAOvBrM,gBAAiB,SAAUn9D,GACZ5D,KAGN+xC,SAASnuC,GAAO,IAOzBujE,UAAW,WACP,OAAO,GAOXx0D,SAAU,WACN,OAAO3S,KAAK4D,WAOhB03F,aAAc,WAGV,IAGI,OAFO3+E,KAAKhE,MAAM3Y,KAAK4D,OAEXA,UACd,MAAOqK,GACL,WAQRq+D,SAAU,WACN,IAAIx6B,EAAS9xC,KAAKs7F,eAElB,OAAOxpD,GAAUA,EAAO5sC,OAAS,GAGrCmpE,qBAAsB,SAAU1/D,GAC5B,OAAOxR,EAAE,kEAAmEwR,IAOhFinF,WAAY,SAAUhyF,GAClB,IAAI4mF,EAAWxqF,KAAKs7F,eAEpB9Q,EAAS5hF,KAAKhF,GAEd5D,KAAK+xC,SAASy4C,IAOlBiL,cAAe,SAAU7xF,GACrB,IAAI23F,EAAa33F,EAAMtG,GACnBktF,EAAWxqF,KAAKs7F,eACf3iD,OAAO,SAAU1P,GACd,OAAOA,EAAK3rC,KAAOi+F,IAG3Bv7F,KAAK+xC,SAASy4C,IAMlBtkC,WAAY,WACR,IAAIroD,KAGJA,EAAKmC,KAAK0S,WAAWmO,OAAS7gB,KAAK2S,WAGnC3S,KAAK8hE,eAAejkE,IAQxB29F,cAAe,SAAUl+F,GACrB,IAAIyC,EAAOC,KAEX,OAAOD,EAAK2uD,SAAS+sC,KAAK,SAAUxyD,EAAM9nC,GACtC,IAAIu6F,EAAQzyD,EAAK3rC,KAAOA,EAGxB,OADIo+F,GAAO37F,EAAK2uD,SAAS70C,OAAO1Y,EAAO,GAChCu6F,KAIfpG,UAAW,SAAUxjD,EAAQx0C,GACzB,OAAOw0C,EAAO2pD,KAAK,SAAUxyD,GACzB,OAAOA,EAAK3rC,IAAMA,KAS1Bq+F,gBAAiB,SAAUC,GACvB,IAAI77F,EAAOC,KAWX,OAVqByE,SAASm3F,EAAel3F,IAAI,UACjCk3F,EAAev4F,WAG1Bw4F,UACAC,OAAO,SAAUC,EAAKhrC,GAEnB,OADAgrC,GAAOh8F,EAAKi8F,gBAAgBjrC,IAE7B,GAEkChxD,EAAKsiD,MAAM45C,mBASxDD,gBAAiB,SAAU/7F,GACvB,IAAIi8F,EAAS79E,OAAOksB,iBAAiBtqC,GAErC,OADiB9C,EAAE8C,GAASkyC,cAExB,eACA,gBACA,cACA,gBACF2pD,OAAO,SAAUC,EAAK76E,GAEpB,OADA66E,GAAOt3F,SAASy3F,EAAOh7E,KAExB,IAQPi7E,WAAY,SAAU3jD,EAAO4jD,GAEzBA,EAAWzjD,OAAO,WACd,IAAI0jD,EAAkBl/F,EAAE6C,MAAMmS,OAAOgK,cACjCmgF,EAAiB9jD,EAAMr8B,cAE3B,GAAIkgF,EAAgBnyF,QAAQoyF,IAAmB,EAC3C,OAAOn/F,EAAE6C,MAET7C,EAAE6C,MAAMmF,SAEbE,QAOPk3F,oBAAqB,aAQrBC,aAAc,SAAUl/F,GACpB,OAAQ0C,KAAK0S,WAAW7U,UAAYyF,KAAK,SAAU2lC,GAC/C,OAAOA,EAAK3rC,IAAMA,KAc1ByrC,WAAY,SAAUnlC,GAClB,OAAOiJ,OAAOY,KAAKs7B,WAAWnlC,MCjUtCzG,EAAEklD,MAAM57C,OAAO,kCAOX08D,eAAgB,SAAStlE,GACVmC,KAGNsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAW64C,WAAa1hD,OAAO6I,EAAW64C,aAAe,GACzD74C,EAAWqyC,SAA6D,OAAlDl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,WAAqBl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,UARxG/kD,KAWN+xC,SAASr/B,EAAW9O,QAO7BunE,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,cAE9C,OAAOpyD,EAAE0E,SAASxD,GACdf,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClBjd,MAAO8O,EAAW9O,MAClB2tF,YAAa7+E,EAAW6+E,YACxB3kF,MAAO8F,EAAW9O,MAClB64F,gBAAe/pF,EAAW0+E,YAC1BrsC,SAAUryC,EAAWqyC,WAErBhc,WAbO/oC,KAaU+oC,cAQzBqiC,eAAgB,WACZ,OAAOprE,KAAKmrE,iBAQhBp5B,SAAU,SAASnuC,GACf5D,KAAK4D,MAAQ+Y,KAAKC,QAAShZ,MAASA,IACpC5D,KAAKqoE,uBAQTutB,WAAY,SAAShyF,GACjB,IAAI+2B,EAAOhe,KAAKhE,MAAM3Y,KAAK4D,OAE3B+2B,EAAK/2B,MAAMgF,KAAKhF,GAEhB5D,KAAK+xC,SAASpX,EAAK/2B,QAQvB6xF,cAAe,SAAS7xF,GACpB,IAAI+2B,EAAOhe,KAAKhE,MAAM3Y,KAAK4D,OACvBmE,KAEJ5K,EAAE0D,KAAK85B,EAAK/2B,MAAO,SAAS7C,EAAKqO,GACzBA,EAAI9R,IAAMsG,EAAMtG,IAChByK,EAAOa,MAAOtL,GAAI8R,EAAI9R,GAAIsG,MAAOwL,EAAIxL,UAI7C5D,KAAK+xC,SAAShqC,IAOlB20F,kBAAmB,WACf,IAAI/hE,EAAOhe,KAAKhE,MAAM3Y,KAAK4D,OAEvB+2B,EAAK/2B,MAAMsB,OAAS,IACpBy1B,EAAK/2B,MAAMw6C,MACXp+C,KAAK+xC,SAASpX,EAAK/2B,SAS3BxB,QAAS,SAASiJ,GACd,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+Q,EAAQ,IAAItmB,EAAE4S,SAyBlB,OAtBAhQ,EAAKgjE,YAAYjb,eACbpkC,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBlb,KAAMx2B,EAAWw2B,KACjB0d,MAAOv7C,IACRlD,KAAK,SAAStK,GAEb6U,EAAW7U,KAAOA,EAClB4lB,EAAMtT,QAAQuC,EAAW7U,QAC1BuS,KAAK,SAASvS,GACb,IAAIm0F,EAAan0F,EAAKm0F,aAAc,EAEpCvuE,EAAMtT,YAED6hF,GACDjyF,EAAKkF,QAAQ,gBAAiBpH,KAI/B4lB,EAAMlb,WAOjB29C,WAAY,WACR,IAAIroD,KAGJA,EAAKmC,KAAK0S,WAAWmO,OAAS7gB,KAAK2S,WAGnC3S,KAAK8hE,eAAejkE,IAOxBspE,UAAW,WACP,OAAO,GAOXmF,SAAU,WAGN,OAFWtsE,KAAK28F,eAEJz3F,OAAS,GAGzBy3F,aAAc,WACV,IAAI/4F,EAAQ5D,KAAK2S,WAGjB,OAFoC,iBAAZ,EAAuBgK,KAAKhE,MAAM/U,GAAOA,MAAQA,EAAMA,YAenFmlC,WAAY,SAAUnlC,GAClB,OAAOiJ,OAAOY,KAAKs7B,WAAWnlC,MC9LtCzG,EAAEklD,MAAM57C,OAAO,6BAOX08D,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAGZ,IAAI6U,EANO1S,KAMW0S,WAClBof,EAAS9xB,KAAK+M,YAAY,iBAK9B,GAFA2F,EAAWihF,gBAAgD,IAA3BjhF,EAAqB,YAAoBA,EAAWihF,WAEhFjhF,EAAWihF,WAAY,CACvB,IAAIhjE,EAAmD,oBAAnC,6BAAiDa,6BAA6Bb,OAASmB,EAAOnB,OAClHje,EAAWie,OAASje,EAAWkhF,eAAiBlhF,EAAWkhF,eAAiBjjE,OAE5Eje,EAAWie,OAAS,GAGxBje,EAAWme,aAAc,KC3BjC1zB,EAAEklD,MAAM57C,OAAO,6BAMX08D,eAAgB,SAAUtlE,GAGtBmC,KAAKsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WACtBA,EAAW6/E,WAAa1lF,OAAOY,KAAKuF,aAAaN,EAAW6/E,cAAe,EAG3E7/E,EAAWg0E,OAAS75E,OAAOY,KAAK4e,aAAa,IAAM,MAQvDi6D,gBAAiB,WACb,MAAO,SAQXK,UAAW,WACP,OAAO,GAQXC,gBAAiB,WACb,OAAO,GAOXH,kBAAmB,WACf,IACI/zE,EADO1S,KACW0S,WAEtB,OACI8/E,UAAW9/E,EAAW6/E,WACtBA,WAAY7/E,EAAW6/E,aAO/BtwB,UAAW,WACP,IACIr+D,GAAStG,GAAI,GAAI0D,MAAO,IADjBhB,KAEaC,QAAQqD,KAAK,2BAExBuiB,YAAY,0BAJd7lB,KAKN+gE,gBAAgBn9D,GALV5D,KAMN+xC,SAASnuC,GAAO,GANV5D,KAON+vE,qBAOTv9D,sBAAuB,WACnB,IACIE,EADO1S,KACW0S,WAElB9O,EAHO5D,KAGM2S,WACbC,EAAeF,EAAWG,cAC1B47D,EAAY/7D,EAAWg8D,aAoC3B,OAhCI9qE,QAA0BsE,IAAjBtE,EAAMsB,SACftB,EAAQA,EAAM,IAEdgP,QAAwC1K,IAAxB0K,EAAa1N,SAC7B0N,EAAeA,EAAa,IAE5B67D,QAAkCvmE,IAArBumE,EAAUvpE,SACvBupE,EAAYA,EAAU,IAG1B7qE,EAAQA,QAAsBsE,IAAbtE,EAAMtG,GAAmBsG,EAAMtG,GAAKsG,EACrDgP,EAAeA,QAAoC1K,IAApB0K,EAAatV,GAAmBsV,EAAatV,GAAKsV,OAG/D1K,KAFlBumE,EAAYA,QAA8BvmE,IAAjBumE,EAAUnxE,GAAmBmxE,EAAUnxE,GAAKmxE,IAG5DA,GAAa7qE,GAAWA,GAASgP,MAGnB,OAAVhP,GAA4B,KAAVA,GAAmC,OAAjBgP,GAA0C,KAAjBA,IAGpDA,GAAgBhP,IAInB,OAAVA,GAA4B,KAAVA,GAAmC,OAAjBgP,GAA0C,KAAjBA,IAGpDA,GAAgBhP,KCpH1CzG,EAAEklD,MAAM57C,OAAO,0BAEXg8C,2BAA4B51C,OAAO2xC,OAAOC,SAAS8D,QAAQE,2BAC3DC,4BAA6B71C,OAAO2xC,OAAOC,SAAS8D,QAAQG,4BAC5DC,cAAe91C,OAAO2xC,OAAOC,SAAS8D,QAAQI,gBAO9CwgB,eAAgB,SAAUtlE,GACXmC,KAGNsN,OAAOzP,GAGZ,IAAI6U,EAAa1S,KAAK0S,WAClBwjF,EAAU,QAYd,GAVGxjF,EAAWwjF,QACVA,EAAUrsF,OAAO6I,EAAWwjF,SACQ,oBAAtB,sBAAoF,IAAvCE,gBAAiC,oBAC5FF,EAAUrsF,OAAOusF,gBAAgBC,oBAGrC3jF,EAAWwjF,QAAUA,EACrBxjF,EAAWqyC,UAA6D,IAAlDl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,UAC1DryC,EAAW6jF,gBAAkB7jF,EAAW6jF,iBAAmB,GAEvD7jF,EAAW6jF,gBAAgBrxF,OAAS,GAAKwN,EAAW6jF,gBAAgBrsF,QAAQ,KAAO,EAAG,CAGtF,IAFA,IAAIssF,EAAmB9jF,EAAW6jF,gBAAgB5xF,QAAQ,OAAQ,IAAIvD,MAAM,KAEnEN,EAAI,EAAGA,EAAI01F,EAAiBtxF,OAAQpE,IACzC,GAAkC,GAA9B01F,EAAiB11F,GAAGoE,OACpBsxF,EAAiB11F,GAAK,KAAO01F,EAAiB11F,GAAG6a,WAAW,IAAK,QAC9D,CAES66E,EAAiBtsF,QAAQssF,EAAiB11F,IACtD01F,EAAiB38E,OAAO/Y,EAAG,GAInC4R,EAAW6jF,gBAAkBC,EAAiB99E,KAAK,KAGvDhG,EAAWmuE,OAASnuE,EAAWmuE,QAnCpB7gF,KAmCmC+iE,YAAYja,oBAAoBp2C,EAAWkqF,kBACzFlqF,EAAWizC,YAAmE,OAArD94C,OAAOY,KAAKuF,aAAaN,EAAWizC,aAE7DjzC,EAAWmqF,aAAc,EACzBnqF,EAAWoqF,cAAe,GAEA,IAAtBpqF,EAAWsK,OACXtK,EAAWsK,MAAQ,OACnBtK,EAAWmqF,aAAc,GAEzBnqF,EAAWsK,MAAQtK,EAAWsK,MAAQ,MAGf,IAAvBtK,EAAWoQ,QACXpQ,EAAWoQ,OAAS,OACpBpQ,EAAWoqF,cAAe,GAE1BpqF,EAAWoQ,OAASpQ,EAAWoQ,OAAS,MAQhDqoD,cAAe,WACX,IAAIprE,EAAOC,KACPyhE,EAAM,IAAItkE,EAAE4S,SACZ1R,EAAW0B,EAAK+iE,cAAcvT,YAAY,SAa9C,OAXApyD,EAAEqM,KAAKzJ,EAAKi3F,gBAAgB7uF,KAAK,SAAUo5E,GACvC,IAAKxhF,EAAKokE,aAAc,CACpBpkE,EAAK2S,WAAWgR,IAAkB,KAAZ69D,EAAiBA,EAAU,GACjDxhF,EAAK2S,WAAW9O,MAAQ7D,EAAK6D,MAAQ7D,EAAK2S,WAAWgR,IAAIxe,OAAS,GAAKnF,EAAK2S,WAAWgR,KAAO,KAC9F3jB,EAAKgyC,SAAShyC,EAAK2S,WAAW9O,OAE9B,IAAIL,EAAOpG,EAAE0E,SAASxD,GAAYqlB,IAAK3jB,EAAK2S,WAAWgR,MACvD+9C,EAAItxD,QAAQ5M,MAIbk+D,EAAIl5D,WAOf6iE,eAAgB,WACZ,IAAI/sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,kBAG9C,OAFWpyD,EAAE0E,SAASxD,IAS1B0+F,gBAAiB,WACb,OAAO/8F,KAAK8iE,cAAcvT,YAAY,eAQ1CqnC,iBAAkB,SAAU3rE,GACxB,IAAIlrB,EAAOC,KACPH,EAAOE,EAAK8jE,UACZpC,EAAM,IAAItkE,EAAE4S,SACZ1R,EAAW0B,EAAKg9F,kBAkBpB,OAhBA5/F,EAAEqM,KAAKzJ,EAAKi3F,gBAAgB7uF,KAAK,SAAUo5E,GACvC,IAAI79D,EAAM69D,GAAW,GAEjBh+E,EAAOpG,EAAE0E,SAASxD,GAClBqlB,IAAKA,EACLiiC,YAAa5lD,EAAK2S,WAAWizC,YAC7BZ,SAAUhlD,EAAK2S,WAAWqyC,SAC1BllD,KAAMA,IAGVE,EAAK2S,WAAWgR,IAAMA,EACtB3jB,EAAK2S,WAAW9O,MAAQ8f,EAAIxe,OAAS,GAAKwe,GAAO,KAEjD+9C,EAAItxD,QAAQ5M,KAGTk+D,EAAIl5D,WAQfyuF,aAAc,SAAU3rF,GACpB,IACIqH,EADO1S,KACW0S,WAClB+uD,EAAM,IAAItkE,EAAE4S,SACZ2T,EAAM,GAEV,GAAK1jB,KAAKmyE,kBAGH,CACH,IAAIlpE,GACAya,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBljC,SAAU7V,GAAUA,EAAO6V,SAAW7V,EAAO6V,SAAW,cACxDmT,SAAU,QAGV3hB,EAAW0zC,cACXn9C,EAAWm9C,YAAc1zC,EAAW0zC,aAGpC1zC,EAAWkqF,mBAvBR58F,KAwBEg9F,YAAcnwF,OAAOmwF,YAAY9tC,OACtCjmD,EAAW66C,aAAe,wBAzBvB9jD,KAyBsDg9F,YAAc,IACvE/zF,EAAWm9C,YAAc,SACzBn9C,EAAWq9C,aA3BRtmD,KA2B4Bg9F,aA3B5Bh9F,KA8BF+iE,YAAYzf,cAAcqD,gBAAgB19C,EAAY,QACtDd,KAAK,SAAUtK,GACW,MAAnBA,EAAKqe,OAAO,KACZre,EAAOA,EAAKqR,MAAM,GAAI,IAGb,KAATrR,IACA6lB,EAAM,yBAA2B7lB,GAGrC4jE,EAAItxD,QAAQuT,UAlCpBA,EAAM,GACN+9C,EAAItxD,QAAQuT,GAqChB,OAAO+9C,EAAIl5D,WAGf00F,oBAAqB,SAASh0F,GAC1B,IAAIw4D,EAAM,IAAItkE,EAAE4S,SAEZ2C,EADO1S,KACW0S,WAClBiuB,EAFO3gC,KAEWk9F,gBAClBj0F,GACA48B,OAAQlF,EAAWkF,OACnBqe,WAAYvjB,EAAWujB,WACvB5mD,GAAIoV,EAAWmO,MACfy5D,YAAa35C,EAAW25C,aAO5B,OALAn9E,EAAEqM,KATSxJ,KASC+iE,YAAYo6B,gBAAgBl0F,EAAY,WACnDd,KAAM,SAASi1F,GACZ1qF,EAAW9O,MAAQw5F,EACnB37B,EAAItxD,QAAQtD,OAAOY,KAAKk3B,WAAWjyB,MAEhC+uD,EAAIl5D,WAQf80F,iBAAkB,SAAUnxE,EAAM3jB,GAC9B,IAAIxI,EAAOC,KACPs9F,EAAc,IAAIngG,EAAE4S,SAExB,GAAGhQ,EAAKw9F,SAAS,CACb,IAAIrzC,EAAWnqD,EAAK43F,eAAe12F,KAM/BirB,EALCrf,OAAOY,KAAK62B,kBAKNz3B,OAAOY,KAAK+vF,MAAMC,aAAavxE,GAJ/Brf,OAAOY,KAAK+vF,MAAME,qBAAqBxxE,GAOlD,IAAIyxE,EAAe,SAAUhiE,GACzB9uB,OAAO6T,IAAI,gCAAiCib,GAC5C2hE,EAAYhrC,OAAO32B,IAGvBtd,OAAOu/E,0BAA0B1xE,EAAM,SAAU2xE,GAC7CA,EAAU5yE,KAAK,SAAUA,GACrB,IAAI6yE,EAAS,IAAIC,WACjBD,EAAOE,UAAY,WACf,IAAIC,EAAO,IAAIz7D,MAAMxiC,KAAK+H,SAAUkC,KAAMghB,EAAKhhB,OAC/Cg0F,EAAKh9F,KAAOipD,EACZozC,EAAYntF,QAAQ8tF,IAExBH,EAAOI,kBAAkBjzE,IAC1B0yE,IACJA,QAGHL,EAAYntF,QAAQ+b,GAGxB/uB,EAAEqM,KAAK8zF,GACNn1F,KAAM,SAASg2F,GAEZ,IAAIx9D,EAAa5gC,EAAKm9F,gBAClBj0F,GACA48B,OAAQlF,EAAWkF,OACnBqe,WAAYvjB,EAAWujB,WACvB5mD,GAAIyC,EAAK2S,WAAWmO,MACpBu9E,cAAe,UACf9jB,YAAa35C,EAAW25C,aAG5Bn9E,EAAEqM,KAAKzJ,EAAKgjE,YAAYs7B,iBAAiBp1F,EAAYk1F,IACpDh2F,KAAM,WACHI,EAAQ4H,eASpBmuF,iBAAkB,WACd,IAAI78B,EAAM,IAAItkE,EAAE4S,SAOhB,OALA5S,EAAEqM,KAAKxJ,KAAKg3F,cAAc91E,SAAY,qBACjC/Y,KAAK,SAAUo5E,GACZ9f,EAAItxD,QAAQoxE,KAGb9f,EAAIl5D,WAOf4+D,UAAW,WAEP,OAAO,GAQXp1B,SAAU,SAAUnuC,EAAOwpE,GAEvBptE,KAAKsN,OAAO1J,EAAOwpE,IAOvBz6D,SAAU,WACN,OAAO3S,KAAK0S,WAAW9O,WAQ3BoG,QAAS,SAAU0vD,GACf,IAAI35D,EAAOC,KAGX,IAA0D,IAAtD6M,OAAOY,KAAKuF,aAAajT,EAAK2S,WAAW2iD,SACzC,OAAO,EAIX,IAA2D,IAAvDxoD,OAAOY,KAAKuF,aAAajT,EAAK2S,WAAWqyC,UACzC,OAAO,EAOX,IAHAhlD,EAAKq5D,qBAAqB,IAGtBr5D,EAAK2S,WAAWosD,cACH/+D,EAAKzB,MAAQyB,EAAKzB,KAAKyzE,iBAAiB3jE,MAAMrO,KAKlC,IAFTA,EAAK4S,WAEPzN,QAAc,CACpB,IAAIwR,EAAU3W,EAAKgN,YAAY,wBAAwB4O,WAAW,UAAW5b,EAAK2S,WAAWynC,aAE7F,OADAuf,EAAgB9wD,MAAOiY,MAAO9gB,EAAK2S,WAAWmO,MAAOnK,QAASA,KACvD,EAKnB,OAAO,GAMX0gF,eAAgB,WACZ,IAAIr3F,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB8yC,EAAOzlD,EAAK2gC,mBACZ7iC,KAEJA,EAAKkC,EAAKsiD,MAAMK,4BAA8B,SAAW3iD,EAAKwzF,iBAC9D11F,EAAKkC,EAAKsiD,MAAMK,4BAA8B,YAAchwC,EAAWpV,GACvEO,EAAKkC,EAAKsiD,MAAMK,4BAA8B,gBAAkBhwC,EAAWoxC,aAC3EjmD,EAAKkC,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,eAAiBjwC,EAAW0xC,YACrFvmD,EAAKkC,EAAKsiD,MAAMI,2BAA6B,aAAe+C,EAAK9yC,WAAWm0C,UAC5EhpD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,UAAY,WAEtDhwC,EAAW0zC,cACXvoD,EAAKkC,EAAKsiD,MAAMK,4BAA8B,eAAiBhwC,EAAW0zC,aAG9E,IACyC,oBAA1B,oBACPvoD,EAAKw5F,qBAAuB7xC,EAAK9yC,WAAWm0C,UAE5ChpD,EAAiB,WAAI2nD,EAAK9yC,WAAWm0C,UAE3C,MAAO54C,GACLpQ,EAAiB,WAAI2nD,EAAK9yC,WAAWm0C,UAGzC,OAAOhpD,GAOX01F,eAAgB,WACZ,OAAOvzF,KAAK0S,WAAWmO,OAM3B8qD,kCAAmC,WAChB3rE,KAAK0rE,aACXzpE,WC/YjB9E,EAAEklD,MAAM57C,OAAO,2CASX83F,oBAAqB,WACjB,OAAO,MAGXp6F,WAAY,WACR,IAAIpE,EAAOC,KAGXD,EAAKuN,SAEL,IAAImW,EAAQtmB,EAAE4S,WACVyuF,EAAmBz+F,EAAKw+F,sBAe5B,OAdIC,GAAoBA,EAAiBt5F,OAAS,EAC9C2H,OAAO+W,OAAOJ,SAASg7E,GAC/B36E,KAAK,WAEF9jB,EAAKkrE,wBACLxnD,EAAMtT,YAIDhT,EAAEqM,KAAMzJ,EAAK0+F,0BAA0Bt2F,KAAK,WACxCsb,EAAMtT,YAIPsT,EAAMlb,WAGjBk2F,uBAAwB,WACpB,IAAI1+F,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACfh5D,EAAa3S,EAAK2S,WAClB+uD,EAAM,IAAItkE,EAAE4S,SAEZ2C,EAAWgsF,cAAgBhsF,EAAWgsF,aAAax5F,OAAS,EAC5DnF,EAAK2+F,aAAe7xF,OAAO4xC,SAAS2G,KAAK4F,UAAUt4C,EAAWgsF,cAE9D3+F,EAAK2+F,gBAIT,IACQC,EAYR,OAZQA,EAAsB5+F,EAAK6+F,wBAE3B7+F,EAAKwuB,MAAQ9b,EAAQlP,KAAKo7F,IAE9B5+F,EAAK8+F,gBACLp9B,EAAItxD,UAODsxD,EAAIl5D,WAGfujE,mBAAoB,WAChB,IAAI/rE,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACfh5D,EAAa3S,EAAK2S,WAElBA,EAAWgsF,cAAgBhsF,EAAWgsF,aAAax5F,OAAS,EAC5DnF,EAAK2+F,aAAe7xF,OAAO4xC,SAAS2G,KAAK4F,UAAUt4C,EAAWgsF,cAE9D3+F,EAAK2+F,gBAGT,IAAII,EAAwB,WACxB,IACI,IAAIC,EAAsBh/F,EAAKi/F,qBAC3BD,IACAh/F,EAAKwuB,MAAQ9b,EAAQlP,KAAKw7F,IAE9Bh/F,EAAK8+F,gBAEP,MAAOljE,GACL,IAAIwe,EAAcp6C,EAAK2S,WAAWynC,aAAe,SACjD1nC,EAAQlP,KAAK,OAAS42C,EAAe,WAKzCp6C,EAAKqR,MACLrR,EAAKqR,QAAQjJ,KAAK,WACd22F,MAGJA,KAIRnxB,gBAAiB,WAEb,OADW3tE,KACCi/F,oBAMhBl+B,gBAAiB,SAAUn9D,GACZ5D,KAGN+xC,SAASnuC,GAHH5D,KAMNk/F,iBAAiBt7F,IAG1B+O,SAAU,WAEN,OADW3S,KACCm/F,oBAGhB7tF,iBAAkB,SAAU8tF,EAAc/zF,GACtC,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+Q,EAAQ,IAAItmB,EAAE4S,SAsBlB,OArBAhQ,EAAKgjE,YAAYzf,cAAcqD,iBAC3BjjC,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBljC,SAAUk+E,EACVx4C,MAAOv7C,EACPgpB,SAAUhpB,EAASA,EAAOgpB,SAAW,OACtClsB,KAAK,SAAUtK,GACG,SAAbA,EAAKoM,MAELlK,EAAK2gC,mBAAmB67C,gBAAgB1+E,EAAK6Y,SAC7C+M,EAAM6uC,OAAOz0D,IAEb4lB,EAAMtT,QAAQtS,KAEnBuS,KAAK,SAAUivF,EAAOC,EAAYC,GACjC97E,EAAM6uC,OAAO+sC,EAAOC,EAAYC,KAG7B97E,EAAMlb,WAMjBqxE,SAAU,WAGN,OAFW55E,KACK0gC,mBACJk5C,YAMhB4lB,kBAAmB,SAAU3+E,GACzB,IACI9Y,EAAS5K,IACT0qB,EAFO7nB,KAES0gC,mBAAmBo1B,WAAWj1C,GAKlD,OAJA1jB,EAAE0D,KAAKgnB,EAAU,SAAU/mB,EAAGmoC,GAC1BlhC,EAASA,EAAOzI,IAAInC,EAAE8rC,EAAKhpC,YAGxB8H,GAGX03F,qBAAsB,SAAU59D,GAC5B,IACIne,EAAM,uCACVA,EAAMA,EAAI/e,QAAQ,MAFP3E,KAEmB0S,WAAWgtF,eACzC79D,EAAWA,EAASl9B,QAAQ,KAAM,MAAMA,QAAQ,IAAK,MACrD,IAAIqf,EAASnX,OAAOY,KAAKoG,eAIzB,OAFA6P,GADAA,EAAMA,EAAI/e,QAAQ,MAAOqf,IACfrf,QAAQ,MAAOk9B,IAQ7B89D,eAAgB,SAAU9+E,GACtB,IAEIpO,EADAoV,EADO7nB,KACS0gC,mBAAmBo1B,WAAWj1C,GAOlD,OALA1jB,EAAE0D,KAAKgnB,EAAU,SAAU1mB,EAAO8nC,GACzBx2B,IAAWw2B,EAAKv2B,WAAWqyC,WAC5BtyC,EAAUw2B,KAGdx2B,EACOA,EAAQE,WAER,MAOfupE,YAAa,WACT,IACIxpE,EADO1S,KACW0S,WADX1S,KAGK0gC,mBACXw7C,YAAYxpE,EAAWpV,KAMhCsiG,WAAY,SAAUl8E,EAAKrY,GACvBwB,OAAOY,KAAK8S,cAAc,yCAM9B8G,UAAW,SAAU3D,EAAKrY,GACtBwB,OAAOY,KAAK8S,cAAc,wCAG9ByvD,oBAAqB,WACNhwE,KACN0S,WAAWG,cADL7S,KAC0B4D,MAD1B5D,KACuC0S,WAAW9O,SAOrEzG,EAAEklD,MAAM57C,OAAO,sCAKXm4F,mBAAoB,aAGpBC,cAAe,aAIfM,iBAAkB,WACd,OAAOtyF,OAAO23D,UAAUhmB,OAAOrwC,UAAUwE,SAASvE,MAAMpO,KAAMqO,YAIlE6wF,iBAAkB,SAAUt7F,GACxB,OAAOiJ,OAAO23D,UAAUhmB,OAAOrwC,UAAU4jC,SAAS3jC,MAAMpO,KAAMqO,YAGlE2wF,mBAAoB,aAGpBC,iBAAkB,WAEd,OAAOpyF,OAAO23D,UAAUhmB,OAAOrwC,UAAUw/D,gBAAgBv/D,MAAMpO,KAAMqO,YAGzE+vB,QAAS,WACMp+B,KAGNsN,YASbnQ,EAAEklD,MAAM57C,OAAO,wCAKX+Q,KAAM,SAAUnM,GACDrL,KAGNsN,OAAOjC,GAHDrL,KAKN6/F,cAAgBx0F,EALVrL,KAMN0/F,cAAgB1/F,KAAK0S,WAAWgtF,cAN1B1/F,KAON8/F,cAAgB9/F,KAAK0S,WAAWD,SAMzCg5D,mBAAoB,WAChB,IAAI1rE,EAAOC,KACX7C,EAAEqM,KAAKzJ,EAAKggG,uBACX53F,KAAK,SAAUsK,GAYZ,OAXAA,EAAQxS,QAAUF,EAAKE,QAGnBF,EAAKrB,SACL+T,EAAQutF,UAAW,EACnBvtF,EAAQnU,KAAOyB,EAAKzB,KACpBmU,EAAQmxC,aAAe7jD,EAAK6jD,aAC5BnxC,EAAQC,WAAWoxC,aAAe/jD,EAAKkgG,uBAAuBxtF,GAC9DA,EAAQi5D,WAAa3rE,EAAKrB,OAAOgtE,YAG9Bj5D,EAAQg5D,wBAOvBw0B,uBAAwB,SAAUxtF,GAC9B,IACIC,EAAaD,EAAQC,WAEzB,OAAID,EAAQutF,SACDttF,EAAWoxC,aAAa5+C,OAAS,EAAIwN,EAAWoxC,aAAe,IAAMrxC,EAAQnU,KAAKoU,WAAWmO,MAAQ,OAASpO,EAAQmxC,aAAe,IAAMnxC,EAAQnU,KAAKoU,WAAWmO,MAAQ,OAASpO,EAAQmxC,aAAe,IAG/MlxC,EAAWoxC,cAItBo8C,qBAAsB,SAAS70F,GAC3BoV,QAAQC,IAAI,oBAMhBy/E,0BAA2B,SAAU1tF,SACjC,IAAI1S,KAAOC,KACX,IAAK,IAAIe,OAAO0R,QAAQ4vC,MAAMl0C,UAEf,QAAPpN,KAAwB,eAAPA,KAA+B,SAAPA,KAAyB,aAAPA,KAA6B,eAAPA,KAC1E,WAAPA,KAA2B,UAAPA,KAA0B,kBAAPA,KAAkC,WAAPA,MAGtEhB,KAAKgB,KAAOkQ,KAAK,mFAAqFlQ,IAAM,iEAIhH0R,QAAQC,WAAa3S,KAAK2S,WAC1BD,QAAQ7O,MAAQ7D,KAAK6D,OAGzBw6B,QAAS,WACL,IAAIr+B,EAAOC,KAEX8B,WAAW,WACH/B,EAAKqgG,oBACLrgG,EAAKqgG,kBAAkBj5E,OAAO,gBAC9BpnB,EAAKqgG,kBAAkBhiE,YAE5BvxB,OAAOwkB,SAAS6yC,aAAe,IAGlCnkE,EAAKuN,YCjXbT,OAAO23D,UAAUvkE,QAAQwG,OAAO,sCAI5B+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,GAEZrL,KAAKqgG,eAAiBh1F,EAAOikE,UAC7BtvE,KAAKnC,KAAOwN,EAAOxN,KACfwN,EAAOuhF,gBACP5sF,KAAKsvE,UAAY,IAAItvE,KAAKqgG,gBACtBxiG,KAAMmC,KAAKnC,KACXu/B,OAAQp9B,KAAKo9B,OACb0lC,cAAe9iE,KAAK8iE,cACpBC,YAAa/iE,KAAK+iE,cAEtB/iE,KAAKsvE,UAAU5D,WAAa1rE,KAAK0rE,WACjCrgE,EAAOikE,UAAYtvE,KAAKsvE,UACxBtvE,KAAKsvE,UAAU58D,WAAWstF,UAAW,GAErChgG,KAAKsgG,mBAETtgG,KAAK1B,KAAO+M,EAAO+xB,OAGnB,IAAI1qB,EAAa1S,KAAK0S,WACtBA,EAAW6tF,cAAsE,MAAtD1zF,OAAOY,KAAKuF,aAAaN,EAAW6tF,gBAAyB1zF,OAAOY,KAAKuF,aAAaN,EAAW6tF,eAC5H7tF,EAAWi+D,MAAQj+D,EAAWi+D,OAAS,SACvCj+D,EAAW6rD,WAAa7rD,EAAW6rD,eACnC7rD,EAAWovD,oBAAsD,IAA7BpvD,EAAWovD,gBAAiCj1D,OAAOY,KAAKuF,aAAaN,EAAWovD,gBACpHpvD,EAAWk6E,eAAiBvhF,EAAOuhF,eACnCl6E,EAAWqyC,cAA0C,IAAvBryC,EAAWqyC,UAA2Bl4C,OAAOY,KAAKuF,aAAaN,EAAWqyC,UACxGryC,EAAW2iD,aAAwC,IAAtB3iD,EAAW2iD,SAA0BxoD,OAAOY,KAAKuF,aAAaN,EAAW2iD,SACtG3iD,EAAWosD,cAA0C,IAAvBpsD,EAAWosD,UAA2BjyD,OAAOY,KAAKuF,aAAaN,EAAWosD,UACxGpsD,EAAW8tF,gBAA8C,IAAzB9tF,EAAW8tF,YAA6B3zF,OAAOY,KAAKuF,aAAaN,EAAW8tF,YAG5G,IACQn1F,EAAO+xB,QAAsD,kBAArC/xB,EAAO+xB,OAAO1qB,WAAWqyC,WAA0B15C,EAAO+xB,OAAO1qB,WAAWqyC,WACpGryC,EAAWqyC,UAAW,GAE5B,MAAO92C,IAITjO,KAAK4zC,cAAmC1rC,IAAxBwK,EAAWkhC,UAAyBlhC,EAAWkhC,SAC3D5zC,KAAK4zC,WAAUlhC,EAAWqyC,SAAW+Z,UAAW,GAGpD9+D,KAAKs+D,mBAAqB3hD,KAAKhE,MAAMgE,KAAKC,OAAOlK,KAMrD+tF,WAAY,WACR,OAAO,GAOX/0B,WAAY,WAER,OAAOvuE,EAAE,4BADE6C,KACgCC,SADhCD,KACgDijE,oBAK/DsM,aAAc,SAAU3rB,GAGpB,GAFW5jD,KACW0S,WACPk6E,eACX,OAHO5sF,KAGKsvE,UAGZ,IAAIA,EANGtvE,KAMcsgG,gBAAgB18C,GACrC,GAAiB17C,MAAbonE,EAAwB,CACW,iBARhCtvE,KAQasgG,kBARbtgG,KASMsgG,oBAET,IAAII,EAAyB,IAAI1gG,KAAKqgG,gBAClCxiG,KAAMgP,OAAO8K,MAAM3X,KAAKnC,MACxBu/B,OAAQp9B,KAAKo9B,OACb0lC,cAAe9iE,KAAK8iE,cACpBC,YAAa/iE,KAAK+iE,cAEtBuM,EAAYoxB,EAjBT1gG,KAkBEsgG,gBAAgB18C,GAAgB88C,EAGrCpxB,EAAU1rB,aAAeA,EArBtB5jD,KAwBE2gG,eAAerxB,GAGA,WAAhB1rB,GAA0D,eAA7B0rB,EAAU58D,WAAWzI,MAAsD,gBAA7BqlE,EAAU58D,WAAWzI,OAEhGqlE,EAAUvO,gBAAkB,SAAUn9D,GACpB5D,KAAK0rE,aAGXnoE,KAAKK,KAIzB,OAAO0rE,GAMfl+D,MAAO,WACH,OAAOpR,KAAKwvE,cAAcjnE,WAM9BgmF,WAAY,aAMZpnB,UAAW,SAAUvjB,EAAcgqC,GAC/B,IACIte,EADOtvE,KACUuvE,aAAa3rB,GAMlC,OAJIgqC,IACAte,EAAU58D,WAAW2iD,QAAUu4B,EAAcv4B,QAC7Cia,EAAU58D,WAAWqyC,SAAW6oC,EAAc7oC,UAE3CuqB,EAAUnI,cAPNnnE,KAO4B0S,WAAWqyC,UAPvC/kD,KAOwDqnE,eAAmBiI,EAAU58D,WAAWqyC,UAPhG/kD,KAOiHqnE,cAKhIkpB,aAAc,SAAU3sC,EAAchgD,EAAOm4E,EAAU6kB,GACnD,IACItxB,EADOtvE,KACUuvE,aAAa3rB,GAC9B8V,KAgBJ,OAdIknC,EAAkBvrC,UAJXr1D,KAKF+xC,SAAS6R,EAAchgD,GAG5B0rE,EAAU58D,WAAavV,EAAEsJ,OAAO6oE,EAAU58D,WAAYkuF,GAR/C5gG,KAUE1B,WAAmC,IAApBgxE,EAAc,OAClCA,EAAUhxE,KAXP0B,KAWmB1B,MAI1BgxE,EAAUtlE,QAAQ0vD,MAGlBA,EAAgBx0D,OAAS,KACzB/H,EAAE0D,KAAK64D,EAAiB,SAAU54D,EAAG+/F,GACjC9kB,EAASnzE,KAAKi4F,EAAenqF,YAE1B,IAQfiqF,eAAgB,SAAUrxB,KAM1B9wB,OAAQ,SAAUoF,EAAchgD,GAC5B,IAAI7D,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElB48D,EAAYvvE,EAAKwvE,aAAa3rB,GAgBlC,GAfA0rB,EAAUhxE,KAAOyB,EAAKzB,KACtBgxE,EAAU5wE,OAASsB,KACnBsvE,EAAU1rB,aAAeA,EAGzB7jD,EAAKgyC,SAAS6R,EAAchgD,GAG5B7D,EAAK+gG,kCAAkCl9C,GAGvC7jD,EAAK+8D,SAAU,GAIVpqD,EAAWqyC,UAA6B,wCAAjB12C,UAAU,GAClC,OAAOtO,EAAKqrE,eAAeh9D,MAAMrO,EAAMsO,WAG3CtO,EAAKyvE,cAAgB,IAAIryE,EAAE4S,SAC3B,IAAIjR,EAAOwwE,EAAU9wB,OAAO,QAW5B,OARA8wB,EAAUtqE,KAAK,eAAgB,WAC3BjF,EAAK+8D,SAAU,IAGnB/8D,EAAKiF,KAAK,WAAY,WAClBjF,EAAKyvE,cAAcr/D,YAGhBrR,GAKXqF,WAAY,SAAUy/C,EAAc9kD,GACrBkB,KACUuvE,aAAa3rB,GACxBkjB,kBAAkBhoE,IAKhCssE,eAAgB,SAAUxnB,EAAchgD,GACpC,IAAI7D,EAAOC,KAEPsvE,EAAYvvE,EAAKwvE,aAAa3rB,GAClC0rB,EAAUhxE,KAAOyB,EAAKzB,KACtBgxE,EAAU5wE,OAASsB,KACnBsvE,EAAU1rB,aAAeA,EAGzB7jD,EAAKgyC,SAAS6R,EAAchgD,GAG5B7D,EAAK+gG,kCAAkCl9C,GAGvC0rB,EAAU58D,WAAWqyC,UAAW,EAGhChlD,EAAKyvE,cAAgB,IAAIryE,EAAE4S,SAC3B,IAAIhI,EAASunE,EAAU9wB,OAAO,iBAO9B,OALAz+C,EAAKiF,KAAK,WAAY,WAClBjF,EAAKyvE,cAAcr/D,YAIhBpI,GAMXg5F,cAAe,SAAUhgG,EAAK6C,GAC1B,IACImE,EADO/H,KACO8iE,cAAcvT,YAAY,gBAC5C,OAAOpyD,EAAE8/E,KAAKl1E,GAAQxE,QAM1BuoE,mBAAoB,SAAUloB,EAAc9kD,GACxC,IACIwwE,EADOtvE,KACUuvE,aAAa3rB,GAC9BmB,EAFO/kD,KAES0S,WAAWqyC,SAC/BuqB,EAAU58D,WAAWqyC,UAAW,EAHrB/kD,KAIF0S,WAAWk6E,iBAChBtd,EAAUrvE,QAAUnB,GAExBwwE,EAAUxI,kBAAkBhoE,GAC5BwwE,EAAU58D,WAAWqyC,SAAWA,GAMpC9hD,kBAAmB,WACf,OAAO,GAMXC,QAAS,WACL,OAAOlD,KAAKsvE,UAAU3B,mBAK1BqzB,gBAAiB,SAAUjgG,GACvBf,KAAK4jD,aAAe7iD,GAKxBgxC,SAAU,SAAU6R,EAAchgD,GAC9B,IAEI0rE,EAFOtvE,KAEUuvE,aAAa3rB,GACjB,aAAb0rB,GAAyC,MAAbA,IAE5BA,EAAU58D,WAAWG,cAAgBjP,EACrC0rE,EAAU58D,WAAW82D,cAAgB5lE,EAEjC,MAACA,QAA2EsE,IARzElI,KAQ6C0S,WAAW9H,cAAgD1C,MAAlBonE,EAAUhxE,OACnGsF,EATG5D,KASUihG,gBAAgBr9C,EAAc0rB,IAG/CA,EAAU58D,WAAW9O,MAAQA,EAC7B0rE,EAAUv9B,SAASnuC,GAAO,KAOlCq9F,gBAAiB,SAAUr9C,EAAc0rB,GACrC,IACI1rE,EADO5D,KACM0S,WAAW9H,aAK5B,OAHA0kE,EAAUhxE,KAAK6B,QAAQyjD,GAAgB0rB,EAAUhxE,KAAK6B,QAAQyjD,OAC9D0rB,EAAUhxE,KAAK6B,QAAQyjD,GAJZ5jD,KAI+B0S,WAAWmO,OAASjd,EAEvDA,GAKX+O,SAAU,SAAUixC,GAGhB,OAFW5jD,KACUuvE,aAAa3rB,GACjBjxC,YAKrBuuF,kBAAmB,SAAUt9C,GACzB,OAAO5jD,KAAK2S,SAASixC,IAKzB2f,eAAgB,WACZ,OAAO12D,OAAO23D,UAAUvkE,QAAQ4iE,qBAKpCwE,WAAY,WACR,OAAOrnE,KAAK88D,SAKhB73D,QAAS,SAAU0+D,EAAW9lE,GACtBmC,KAAKsvE,WACLtvE,KAAKsvE,UAAUrqE,QAAQ0+D,EAAW9lE,IAK1Ci8D,eAAgB,SAAU6J,EAAW9lE,GAC7BmC,KAAKsvE,WACLtvE,KAAKsvE,UAAUxV,eAAe6J,EAAW9lE,IAKjDmH,KAAM,SAAU2+D,EAAW32D,GACnBhN,KAAKsvE,WACLtvE,KAAKsvE,UAAUtqE,KAAK2+D,EAAW32D,IAKvCma,OAAQ,SAAUw8C,EAAW32D,GACrBhN,KAAKsvE,WACLtvE,KAAKsvE,UAAUnoD,OAAOw8C,EAAW32D,IAKzC8zF,kCAAmC,SAAUl9C,GACzC,IACI0rB,EADOtvE,KACUuvE,aAAa3rB,GAGlC0rB,EAAU58D,WAAWqyC,SAAW/kD,KAAK0S,WAAWqyC,SAChDuqB,EAAU58D,WAAW2iD,QAAUr1D,KAAK0S,WAAW2iD,QAC/Cia,EAAU58D,WAAWosD,SAAW9+D,KAAK0S,WAAWosD,UAGpDqiC,mBAAoB,SAAUzuF,GACf1S,KAEN0S,WAAWqyC,SAAWryC,EAAWqyC,UAF3B/kD,KAE4C0S,WAAWqyC,SAFvD/kD,KAGN0S,WAAW2iD,QAAU3iD,EAAW2iD,SAH1Br1D,KAG0C0S,WAAW2iD,QAHrDr1D,KAIN0S,WAAWosD,SAAWpsD,EAAWosD,UAJ3B9+D,KAI4C0S,WAAWosD,UAMtEsiC,YAAa,WACT,IAGI9xB,EAHOtvE,KAGUqhG,0BACrB,OAAI/xB,GAAaA,EAAUgyB,cAChBhyB,EAAUgyB,gBALVthG,KASC0S,WAAWmO,OAM3BwgF,wBAAyB,WACrB,IACI3pD,EAGJ,IAAKA,KAAS13C,KAAKsgG,gBAAiB,MAGpC,OAAI5oD,EAAc13C,KAAKsgG,gBAAgB5oD,GAEhC,MAGXtZ,QAAS,WACL,IAAIr+B,EAAOC,KAEX8B,WAAW,WACH/B,EAAKuvE,YACLvvE,EAAKuvE,UAAUnoD,OAAO,gBACtBpnB,EAAKuvE,UAAUlxC,WAGfr+B,EAAKugG,iBACLzzF,OAAOY,KAAK4wB,UAAUt+B,EAAKugG,gBAAiB,SAAUv/F,EAAKy9C,GACnDA,IACAA,EAAOr3B,OAAO,gBACdq3B,EAAOpgB,cAIpBvxB,OAAOwkB,SAAS6yC,aAAe,IAGlCnkE,EAAKuN,YC1cbnQ,EAAEklD,MAAM57C,OAAO,wCAKX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,GAGKrL,KAAK0S,WAGXqyC,SAAW+Z,UAAW,GAMrC2hC,WAAY,WACR,OAAO,GAOXjiD,OAAQ,SAAUoF,EAAchgD,GAC5B,GAAqB,iBAAVA,EAAoB,CAC3B,IAAIqjC,EAAiBrjC,EAAM+X,WAAW,MAAO,SAE7C,OADAsrB,EAAiBA,EAAetrB,WAAW,KAAM,SAGhD,OAAc,OAAV/X,EACE,GAGJA,GAMXO,WAAY,SAAUy/C,EAAc9kD,KAOpCssE,eAAgB,SAAUxnB,EAAchgD,GACpC,OAAO5D,KAAKw+C,OAAOoF,EAAchgD,IAMrCkoE,mBAAoB,SAAUloB,EAAc9kD,KAO5CyxF,aAAc,WAEV,OAAO,KCnEfpzF,EAAEklD,MAAM57C,OAAO,qCAKX+Q,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,GAGZ,IAAIqH,EAAa1S,KAAK0S,WACtBA,EAAWq0E,YAAcl6E,OAAOY,KAAKuF,aAAaN,EAAWq0E,eAAgB,GAOjF4Z,eAAgB,SAAUrxB,GACtB,IAAI58D,EAAa1S,KAAK0S,WAEtB1S,KAAKsN,OAAOgiE,GAEP58D,EAAWq0E,cACZzX,EAAUiyB,gBAAkBjyB,EAAUltE,QACtCktE,EAAUltE,QAAUpC,KAAKwhG,mBACzBlyB,EAAUmyB,aAAezhG,KAAKyhG,eAItCA,aAAc,SAAUnkG,GACpB,IACIyK,KASJ,OARI/H,KAAKtB,QAAUsB,KAAKtB,OAAOgpF,WAC3BvqF,EAAE0D,KAAKb,KAAKtB,OAAOgpF,UAAW,SAAU3mF,EAAK6C,GACrCA,EAAMtG,IAAMA,IACZyK,EAASnE,KAKdmE,GAMXy5F,mBAAoB,SAAUn2F,GAC1B,IAAI3M,EAASsB,KAAKtB,OAClB,OAAIA,EAAOgpF,UAAkBhpF,EAAOgpF,UAChChpF,EAAOgjG,aAAqBhjG,EAAO2nF,aAGvC3nF,EAAOgjG,cAAe,EACtBhjG,EAAO2nF,YAAclpF,EAAEqM,KAAKxJ,KAAKuhG,gBAAgBl2F,IAChD4E,KAAK,SAAUlI,GAGZ,OAFArJ,EAAOgpF,UAAY3/E,EACnBrJ,EAAOgjG,cAAe,EACf35F,IAGJrJ,EAAO2nF,cAMlBt0C,SAAU,SAAS6R,EAAchgD,GAC7B,IACI0rE,EADOtvE,KACUuvE,aAAa3rB,GAClC,GAAkB,OAAd0rB,EAAJ,CAKA,GAAoB,WAAhB1rB,EAA2B,OAPpB5jD,KAOgCsN,OAAOs2C,EAAchgD,GAEhE,GAAIA,GAASiJ,OAAOY,KAAKmS,SAAShc,GATvB5D,KAUFsN,OAAOs2C,EAAchgD,QACvB,GAAIA,GAASA,EAAMsB,OAAS,EAAG,CAElC,IAAIslF,GACAltF,GAAIsG,EAAM,GAAG,GACbA,MAAOA,EAAM,GAAGsB,OAAS,EAAI/H,EAAEq5D,KAAK5yD,EAAM,GAAI,SAASqlC,EAAMnoC,GAAK,OAAY,GAALA,IAAa8C,EAAM,GAAG,IAf5F5D,KAkBFsN,OAAOs2C,EAAc4mC,GAC1Blb,EAAU2iB,cAAgBzH,EAAS5mF,WAC5BA,GAASA,EAAMtG,IAAMsG,EAAMA,OApB3B5D,KAqBFsN,OAAOs2C,EAAchgD,GAC1B0rE,EAAU2iB,cAAgBruF,EAAMA,OACD,eAvBxB5D,KAuBK0S,WAAWzI,MAvBhBjK,KAwBFsN,OAAOs2C,EAAc,MAC1B0rB,EAAU2iB,cAAgBruF,GACnBA,GAA2B,iBAAX,EA1BhB5D,KA2BFsN,OAAOs2C,EAAchgD,IA3BnB5D,KA8BFsN,OAAOs2C,EAAc,MAC1B0rB,EAAU2iB,cAAgB,MAOlCiP,kBAAmB,SAAUt9C,GACzB,IACI0rB,EADOtvE,KACUuvE,aAAa3rB,GAC9BhgD,EAAQ0rE,EAAU38D,WAClB3R,EAAQsuE,EAAU6X,mBAGlBwa,KASJ,OARI/9F,IAAUA,EAAMtG,GAAK,GAAKuP,OAAOY,KAAKmS,SAAShc,EAAMtG,MACrDqkG,EAAa/4F,SACb+4F,EAAa,GAAG/4F,KAAKhF,EAAMtG,IAC3BqkG,EAAa,GAAG/4F,KAAK5H,IAErB2gG,EAAa/4F,SAGV+4F,GAMXhvF,SAAU,SAAUixC,GAChB,IAEIhgD,EAFO5D,KACUuvE,aAAa3rB,GACZjxC,WACtB,OAAI/O,EAAcA,EAAMtG,GACjBsG,GAOX46C,OAAQ,SAAUoF,EAAchgD,EAAOg+F,GACnC,IACItyB,EADOtvE,KACUuvE,aAAa3rB,GAC9BlxC,EAFO1S,KAEW0S,WAGlBA,EAAWq0E,aACXzX,EAAUxvC,YAId,IAAIgkB,EAAepxC,EAAWoxC,aAAa5+C,OAAS,EAAIwN,EAAWoxC,aAAe,IAVvE9jD,KAUkF1B,KAAKoU,WAAWmO,MAAQ,OAAS+iC,EAAe,IAVlI5jD,KAU6I1B,KAAKoU,WAAWmO,MAAQ,OAAS+iC,EAAe,IAMxM,OALA0rB,EAAU58D,WAAWoxC,aAAeA,EAGvB9jD,KAAKsN,OAAOs2C,EAAchgD,EAAOg+F,IAKlDx2B,eAAgB,SAAUrqE,EAAK6C,GAC3B,IACI0rE,EADOtvE,KACUuvE,aAAaxuE,GAC9B2R,EAFO1S,KAEW0S,WAGlBoxC,EAAepxC,EAAWoxC,aAAa5+C,OAAS,EAAIwN,EAAWoxC,aAAe,IALvE9jD,KAKkF1B,KAAKoU,WAAWmO,MAAQ,OAAS9f,EAAM,IALzHf,KAKoI1B,KAAKoU,WAAWmO,MAAQ,OAAS9f,EAAM,IAMtL,OALAuuE,EAAU58D,WAAWoxC,aAAeA,EAGvB9jD,KAAKsN,OAAOvM,EAAK6C,MCzKtCzG,EAAEklD,MAAM57C,OAAO,oCAKXsrC,SAAU,SAAU6R,EAAchgD,GAC9B,IACI0rE,EADOtvE,KACUuvE,aAAa3rB,GAClC,GAAkB,OAAd0rB,EAAJ,CAQA,GAVWtvE,KAINsN,OAAOs2C,EAAchgD,GACtB,MAACA,QAA2EsE,IALrElI,KAKyC0S,WAAW9H,eAC3DhH,EANO5D,KAMMihG,gBAAgBr9C,EAAc0rB,IAI1B,YAAjB1rB,EAA4B,OAVrB5jD,KAUiCsN,OAAOs2C,EAAchgD,GAEpD,MAATA,IACA0rE,EAAUv9B,SAASnuC,GAAO,GAC1B0rE,EAAU58D,WAAWg7D,aAAe,IAGxC,IAAI54C,EAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,EAAO0rE,EAAU58D,WAAW8lB,UAOtF,GALa,IAAT1D,IAEAA,EAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,GAAQ0rE,EAAU58D,WAAW8lB,WAG1E,IAAT1D,EAAY,CACZ,IAAI+1D,EAAqBh+E,OAAOC,aAAaC,YAAY,sBACrD80F,EAAgBh1F,OAAOY,KAAKgmB,cAAcD,WAAWsB,EAAMw6C,EAAU58D,WAAWk4E,WAAYC,GAGhGvb,EAAU58D,WAAWg7D,aAAem0B,EAGpCvyB,EAAUv9B,SAASnuC,GAAO,MAOlCq9F,gBAAiB,SAAUr9C,EAAc0rB,GACrC,IACI1rE,EADO5D,KACM0S,WAAW9H,aAS5B,OAPA0kE,EAAUhxE,KAAK6B,QAAQyjD,GAAgB0rB,EAAUhxE,KAAK6B,QAAQyjD,OAE9DhgD,EAAQiJ,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,EAAO0rE,EAAU58D,WAAW8lB,WAAY,GAE/F50B,EAAQiJ,OAAOY,KAAKgmB,cAAckF,gBAAgB/0B,GAAO,GACzD0rE,EAAUhxE,KAAK6B,QAAQyjD,GARZ5jD,KAQ+B0S,WAAWmO,OAASjd,EAEvDA,KCzDfzG,EAAEklD,MAAM57C,OAAO,sCAKd+Q,KAAM,SAAUnM,GAETrL,KAAKsN,OAAOjC,GAGZ,IAAIqH,EAAa1S,KAAK0S,WAElBA,EAAW2+E,gBAAqC,cAAnBrxF,KAAK6jE,YAClCnxD,EAAWovD,eAAiBj1D,OAAOY,KAAKuF,aAAaN,EAAWovD,kBAAmB,EACnFpvD,EAAWovD,kBAAkBpvD,EAAWk/E,eAAiB,GAAK,IAAIl/E,EAAWovD,iBAQxFtjB,OAAQ,SAAUoF,EAAchgD,EAAOg+F,GACtC,IACItyB,EADOtvE,KACUuvE,aAAa3rB,GAC9BlxC,EAFO1S,KAEW0S,WAGlBA,EAAWq0E,aACdzX,EAAUxvC,YAIX,IAAIgkB,EAAepxC,EAAWoxC,aAAa5+C,OAAS,EAAIwN,EAAWoxC,aAAe,IAVvE9jD,KAUkF1B,KAAKoU,WAAWmO,MAAQ,OAAS+iC,EAAe,IAVlI5jD,KAU6I1B,KAAKoU,WAAWmO,MAAQ,OAAS+iC,EAAe,IAMxM,OALM0rB,EAAU58D,WAAWoxC,aAAeA,EAG7B9jD,KAAKsN,OAAOs2C,EAAchgD,EAAOg+F,IAQ5CjvF,SAAU,SAAUixC,GAChB,IAEIhgD,EAFO5D,KACOuvE,aAAa3rB,GACTjxC,WACtB,OAAI/O,GAA0B,iBAAX,EAA6BA,EAAMtG,GAElDsG,GAERmuC,SAAU,SAAU6R,EAAchgD,GAC9B,IACI0rE,EADOtvE,KACUuvE,aAAa3rB,GAClC,GAAkB,OAAd0rB,EAAJ,CAGA,GAAoB,WAAhB1rB,EAA2B,OALpB5jD,KAKgCsN,OAAOs2C,EAAchgD,GAEhE,GAAIA,GAASA,EAAMsB,OAAS,EAAG,CAE3B,IAAIslF,GACAltF,GAAIsG,EAAM,GAAG,GACbA,MAAOA,EAAM,GAAGsB,OAAS,EAAI/H,EAAEq5D,KAAK5yD,EAAM,GAAI,SAAUqlC,EAAMnoC,GAAK,OAAY,GAALA,IAAa8C,EAAM,GAAG,IAX7F5D,KAcFsN,OAAOs2C,EAAc4mC,GAC1Blb,EAAU2iB,cAAgBzH,EAAS5mF,WAC5BA,GAASA,EAAMtG,IAAMsG,EAAMA,OAhB3B5D,KAiBFsN,OAAOs2C,EAAchgD,GAC1B0rE,EAAU2iB,cAAgBruF,EAAMA,OAC1BA,GAASA,EAAMtG,IAAMsG,EAAM5C,OAnB1BhB,KAoBFsN,OAAOs2C,EAAchgD,GAC1B0rE,EAAU2iB,cAAgBruF,EAAM5C,QArBzBhB,KAwBFsN,OAAOs2C,EAAchgD,GAC1B0rE,EAAU2iB,cAAgB,QC/EtC90F,EAAEklD,MAAM57C,OAAO,gCAMX08D,eAAgB,SAAUtlE,GAEtBmC,KAAKsN,OAAOzP,GAEZ,IAAI6U,EAAa1S,KAAK0S,WAEtBA,EAAWs/B,SAA4D,MAAjDnlC,OAAOY,KAAKuF,aAAaN,EAAWs/B,WAAoBnlC,OAAOY,KAAKuF,aAAaN,EAAWs/B,UAClHt/B,EAAWovF,uBAAuBpvF,EAAWovF,sBAAuBpvF,EAAWovF,qBAC/EpvF,EAAWqvF,mBAA6C75F,IAA7BwK,EAAWqvF,eAA8BrvF,EAAWqvF,cAC/ErvF,EAAW9Q,SAAS8Q,EAAW9Q,QAAS8Q,EAAW9Q,OAE/C8Q,EAAW0jE,SACX1jE,EAAW0jE,QAAUvpE,OAAOY,KAAKyP,KAAKxK,EAAW0jE,SAEf,IAA9B1jE,EAAW0jE,QAAQlxE,SACnBwN,EAAW0jE,QAAUp2E,KAAK+M,YAAY,2CAG1C2F,EAAW0jE,QAAUp2E,KAAK+M,YAAY,0CAQ9Co+D,cAAe,WACAnrE,KAENgiG,mBAEL,IAAItvF,EAJO1S,KAIW0S,WAClB7S,EALOG,KAKK6jE,UACZo+B,EAAuBvvF,EAAWovF,qBAClCC,EAAgBrvF,EAAWqvF,cAC3B1jG,EARO2B,KAQS8iE,cAAcvT,YARvBvvD,KAQwCuvD,eAC/C2yC,EAAYxvF,EAAW9O,UACvB+yF,GAAUuL,GAAkC,IAArBA,EAAUh9F,OAGjC3B,EAbOvD,KAaKmiG,eAAe9jG,EAAUwB,EAAMoiG,EAAsBF,EAAervF,EAAYikF,GAG5F/pF,EAAQ5M,KAAKoiG,oBAAoBF,GAIrC,OAHAt1F,GAAS5M,KAAKqiG,kBAAkBH,EAAWvL,EAASsL,GAEpD1+F,EAnBWvD,KAmBC62F,iBAAiBtzF,EAAMqJ,IAcvCu1F,eAAgB,SAAU9jG,EAAUwB,EAAMoiG,EAAsBF,EAAervF,EAAYikF,GAGvF,OAAOx5F,EAAE0E,SAASxD,GACdikG,kBAAkB,EAClBv9C,SAAmB,cAATllD,EACVA,KAAMA,EACNiiG,qBAAsBG,EACtBnjC,SAAUpsD,EAAWosD,SACrByjC,cAAeR,EACflhF,MATO7gB,KASKw5F,SAAS9mF,EAAWmO,OAChCjf,OAAQ8Q,EAAW9Q,OACnBw0E,QAAS1jE,EAAW0jE,QACpBugB,QAASA,EACT7D,gBAAiBpgF,EAAWogF,mBASpC0G,SAAU,SAAU34E,GAChB,OAAOA,GAMXmhF,iBAAkB,aAOlBQ,eAAgB,WACZ,OAAO,GAQXC,iBAAkB,SAAU5hF,GACxB,OAAOA,GAOX44E,gBAAiB,WACb,OAAOz5F,KAAK0S,WAAWoxC,cAQ3B4+C,mBAAoB,SAAUz3E,GAC1B,IACIprB,EADOG,KACK6jE,UACZxlE,EAFO2B,KAES8iE,cAAcvT,YAFvBvvD,KAEwC+8F,mBAC/Cr5E,EAHO1jB,KAGIg3F,aAAa/rE,GAc5B,MAXa,cAATprB,IAAsB6jB,EAAM,uBAErBvmB,EAAE0E,SAASxD,GAClBqlB,IAAKA,EACLiiC,YAVO3lD,KAUW0S,WAAWizC,YAC7BsxC,SAAUhsE,EAAKi/B,SACfrqD,KAAMA,EACNklD,SAbO/kD,KAaQ0S,WAAWqyC,SAC1B49C,QAAQ,KAWhB3L,aAAc,SAAU/rE,GACpB,IACIvY,EADO1S,KACW0S,WAEtB,OAHW1S,KAGC+iE,YAAYxa,kBACpB1E,SAAUnxC,EAAWpV,GACrBujB,MALO7gB,KAKKyiG,iBAAiB/vF,EAAWmO,OACxCijC,aANO9jD,KAMYy5F,kBACnBr1C,YAAa1xC,EAAW0xC,YACxBoE,OAAQv9B,EAAK3tB,GACbupD,UATO7mD,KASSsxE,kBAQxBsxB,qBAAsB,WAClB,IACIlwF,EADO1S,KACW0S,WAWtB,OAZW1S,KAGW+iE,YAAY/U,4BAC9BntC,MAJO7gB,KAIKyiG,iBAAiB/vF,EAAWmO,OACxCijC,aALO9jD,KAKYy5F,kBACnBr1C,YAAa1xC,EAAW0xC,YACxBve,OAAQnzB,EAAWmwF,OACnB/8D,WAAYpzB,EAAWowF,WACvBj8C,UATO7mD,KASSsxE,kBAUxBntE,WAAY,WAIR,OAFAnE,KAAKsN,SAEE,eAMXw+D,mBAAoB,WAIhB,GAAa,WAHF9rE,KACK6jE,UAEO,CACnB,IAAIpxD,EAJGzS,KAIY0rE,aACfq3B,EALG/iG,KAKgBmrE,gBAEvB14D,EAAQ7Q,OAAOmhG,GAPR/iG,KASFgjG,0BAA0BvwF,GATxBzS,KAYFmE,eAQb8+F,kBAAmB,WAGf,OADWjjG,KAAK0gC,mBACJi5C,gBAOhBlD,KAAM,WAGF,OAFWz2E,KAAK0gC,mBAEJk5C,YAShBid,iBAAkB,SAAUtzF,EAAMoB,GAC9B,OAAOpB,EAAKoB,QAAQ,YAAaA,IASrCu+F,mBAAoB,SAAU3/F,EAAMoB,GAChC,OAAOpB,EAAKoB,QAAQ,cAAeA,IAOvCwiE,UAAW,WAEP,OAAO,GAQXn9D,QAAS,SAAU0vD,GACf,IAEIhjD,EADAhE,EADO1S,KACW0S,WAItB,OAAqD,IAAjD7F,OAAOY,KAAKuF,aAAaN,EAAW2iD,YAIc,IAAlDxoD,OAAOY,KAAKuF,aAAaN,EAAWqyC,YAT7B/kD,KAcNo5D,qBAAqB,MAGtB1mD,EAAWosD,WAAapsD,EAAWywF,gBAjB5BnjG,KAkBE4D,SAlBF5D,KAmBM4D,MAAMsB,OAAS,IACxBwR,EApBG1W,KAoBY+M,YAAY,iCAC3B2sD,EAAgB9wD,MAAMiY,MAAOnO,EAAWmO,MAAOnK,QAASA,KACjD,OAUnB0vD,kBAAmB,WACf,IAAIrmE,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACf7rE,EAAOE,EAAK8jE,UAGhB9jE,EAAKuN,SAGL,IAAI81F,EAAejmG,EAAE,sCAAuCsV,GAC/C,cAAT5S,GACAujG,EAAa35E,MAAM,SAAUxb,GACzB,IAAIA,EAAEo1F,uBAAN,CAKA,GAJAp1F,EAAEimC,kBAEFn0C,EAAK2S,WAAWywF,gBAAiB,EAE7BpjG,EAAK2S,WAAWs/B,SAEFjyC,EAAKkjG,qBAEfljG,EAAKujG,gCAITvjG,EAAKujG,2BAGTvjG,EAAK2S,WAAWywF,gBAAiB,KAKzChmG,EAAE,8BAA+BsV,GAASgX,MAAM,SAAUxb,GAClDA,EAAEo1F,yBACNp1F,EAAEimC,kBAEFn0C,EAAKwjG,oBAAoBpmG,EAAE6C,MAAMnC,KAAK,OAAQV,EAAE6C,MAAMnC,KAAK,gBAI/DV,EAAE,6CAA8CsV,GAASgX,MAAM,SAAUxb,GACjEA,EAAEo1F,yBACNp1F,EAAEimC,kBAEFn0C,EAAKyjG,uBAAuBrmG,EAAE6C,MAAMnC,KAAK,iBAQjD2lG,uBAAwB,SAAUvM,GAC9B,IAAIl3F,EAAOC,KACPqL,GACAwV,MAAO9gB,EAAK2S,WAAWmO,MAAQ,cAAgBo2E,EAAW,KAC1DpzC,SAAU9jD,EAAK2S,WAAWpV,GAC1BwmD,aAAc/jD,EAAK05F,kBACnBr1C,YAAarkD,EAAK2S,WAAW0xC,aAGjCrkD,EAAKyB,eAELrE,EAAEqM,KAAKzJ,EAAKgjE,YAAY9Z,iBAAiB59C,IACpClD,KAAK,WACFhL,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAcqD,iBAClC9lC,MAAO9gB,EAAK2S,WAAWmO,MACvBgjC,SAAU9jD,EAAK2S,WAAWpV,GAC1BwmD,aAAc/jD,EAAK05F,kBACnBr1C,YAAarkD,EAAK2S,WAAW0xC,YAC7BljC,SAAU,WACV/Y,KAAK,SAAU+5F,GACfniG,EAAK0jG,8BAA8BvB,GAAW,EAAOniG,EAAK2S,WAAWovF,sBAGrE/hG,EAAKgC,kBAQrBuhG,yBAA0B,WACtB,IAAIvjG,EAAOC,KACP0S,EAAa3S,EAAK2S,WAEtB3S,EAAKyB,eAGLkR,EAAWi7C,aAAe5tD,EAAK05F,kBAC/B/mF,EAAWmO,MAAQ9gB,EAAK0iG,iBAAiB/vF,EAAWmO,OAEpD9gB,EAAK02E,OAAOtuE,KAAK,WAEb0E,OAAO4rD,sBAAuB,EAE9Bt7D,EAAEqM,KAAKzJ,EAAKgjE,YAAYvV,yBAAyB96C,IAC5CvK,KAAK,WAGFhL,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAcqD,iBAClC9lC,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAc/jD,EAAK05F,kBACnBr1C,YAAa1xC,EAAW0xC,YACxBljC,SAAU,WACV/Y,KAAK,SAAU+5F,GACfniG,EAAK2jG,gCAAgCxB,GAAW,EAAOxvF,EAAWovF,sBAGlE/hG,EAAKgC,iBAGVqO,KAAK,SAAUurB,GAClB57B,EAAKgC,aAGLhC,EAAKy4D,iBAAiB78B,OAE3BvrB,KAAK,SAAUsG,GACd3W,EAAKgC,aAGLhC,EAAKy4D,iBAAiB78B,UAQ9B68B,iBAAkB,SAAU78B,GACxB,IACI6pB,EADOxlD,KACK0gC,mBACZijE,EAFO3jG,KAEYgjE,UAAUj2D,YAAY,+BAA+BpI,QAAQ,MAAOyxF,gBAAgBC,mBAE3G,IACIsN,EAAchoE,QAAyC,IAAxBA,EAAkB,aAAoBhf,KAAKhE,MAAMgjB,EAAMO,cAAcxlB,QAAUilB,EAChH,MAAO1tB,IAGTu3C,EAAK+2B,gBAAgBonB,GACrBn+C,EAAKzjD,cAMT6hG,kBAAmB,aAQnBL,oBAAqB,SAAU7/E,EAAKuzE,KAQpC4M,kBAAmB,SAAU54E,GAEzB,GAAY/iB,MAAR+iB,GAAqC,IAAhBA,EAAK64E,OAC1B,MAAO,8CAKX,OAFgB74E,EAAKrS,OAAQqS,EAAK8/D,YAAY,KAAO,IAGjD,IAAK,OACD,MAAO,qCACX,IAAK,MACD,MAAO,qCACX,IAAK,OACD,MAAO,qCACX,QACI,MAAO,gDAUnBgZ,gBAAiB,SAAU7B,EAAWvL,EAASsL,GAC3C,IACIxvF,EADOzS,KACQ0rE,aACfnoE,EAAO,GACPygG,EAAoB7mG,EAAE,2BAA4BsV,GAGtDuxF,EAAkB/hG,QAGlBsB,GAAQvD,KAAKoiG,oBAAoBF,GAGjC3+F,GAAQvD,KAAKqiG,kBAAkBH,EAAWvL,EAASsL,GAEnD+B,EAAkBpiG,OAAO2B,GAddvD,KAiBN+xC,SAASmwD,IAQlB+B,0BAA2B,SAAUh5E,GACjC,IACIvY,EADO1S,KACW0S,WAClB7S,EAFOG,KAEK6jE,UAEZxlE,EAJO2B,KAIS8iE,cAAcvT,YAJvBvvD,KAIwC+8F,mBAC/Cr5E,EALO1jB,KAKI4iG,uBAGF,cAAT/iG,IAAsB6jB,EAAM,uBAEhC,IAAIngB,EAAOpG,EAAE0E,SAASxD,GAClBqlB,IAAKA,EACLiiC,YAAajzC,EAAWizC,YACxBsxC,SAAUhsE,EAAKi/B,SACfrqD,KAAMA,EACN8iG,QAAQ,IAGZ,OAlBW3iG,KAkBCkkG,mBAAmB3gG,IAQnC2gG,mBAAoB,SAAU3gG,GAC1B,IAAI4gG,EAAa5gG,EAAK2G,QAAQ,0DAE9B,GAAIi6F,EAAa,EAAG,CAChB,IAAIC,EAAa7gG,EAAKib,UAAU2lF,GAC5BE,EAAcD,EAAWl6F,QAAQ,WAAa,EAElD,OAAO3G,EAAKib,UAAU,EAAG2lF,GAAcC,EAAW5lF,UAAU6lF,GAE5D,OAAO9gG,GAUfmgG,gCAAiC,SAAUxB,EAAWvL,EAASsL,GAE3DjiG,KAAK+jG,gBAAgB7B,EAAWvL,EAASsL,GACzCjiG,KAAK4D,MAAQs+F,EAGbliG,KAAK4jG,oBACL5jG,KAAKomE,qBASTq9B,8BAA+B,SAAUvB,EAAWvL,EAASsL,GAEzDjiG,KAAK+jG,gBAAgB7B,EAAWvL,EAASsL,GACzCjiG,KAAK4D,MAAQs+F,EAGbliG,KAAKomE,qBAQTg8B,oBAAqB,SAAUF,GAG3B,IAFA,IAAIt1F,EAAQ,GAEH9L,EAAI,EAAGA,EAAIohG,EAAUh9F,OAAQpE,IAAK,CACvC,IAAIqQ,GAAY7T,GAAI4kG,EAAUphG,GAAG,GAAIopD,SAAUg4C,EAAUphG,GAAG,IAG5D8L,GAFW5M,KAAK0iG,mBAAmBvxF,GAKvC,OAAOvE,GAUXy1F,kBAAmB,SAAUH,EAAWvL,EAASsL,GAC7C,IAAI5iG,EAAU,GAEd,GAAI4iG,IAA0BtL,GAAWuL,EAAUh9F,OAAS,EAAI,CAC5D,IAAIo/F,GAA4Bp6C,SAAUlqD,KAAK+M,YAAY,yCAG3D1N,GAFaW,KAAKikG,0BAA0BK,GAKhD,OAAOjlG,GAGXkwD,YAAa,WACT,MAAO,YAGXwtC,gBAAiB,WACb,MAAO,iBAGXwH,iBAAkB,WACd,MAAO,cAGXC,oBAAqB,WACjB,MAAO,qBAGXC,oBAAqB,WACjB,MAAO,uBC5oBftnG,EAAEklD,MAAM57C,OAAO,6BAIX+Q,KAAM,SAASnM,GAEXrL,KAAKsN,OAAOjC,IAMhB83D,eAAgB,SAAStlE,GAGrBmC,KAAKsN,OAAOzP,IAOhBstE,cAAe,WACX,IAEI9sE,EAFO2B,KACW0S,WAMtB,OAFArU,EALW2B,KAKK8iE,cAAcvT,YAAY,gBACnCpyD,EAAE0E,SAASxD,OAQtBqmG,kBAAmB,SAAUC,EAAYC,GAC1B5kG,KACN2kG,WAAaA,GAAc,KADrB3kG,KAEN4kG,WAAaA,GAAc,KAChC,IAAInyF,EAHOzS,KAGQ0rE,aAEfm5B,EAAa1nG,EAAE,oBAAqBsV,GACpCqyF,EAAa3nG,EAAE,oBAAqBsV,GAN7BzS,KAWN+kG,mBAAmBD,EAAYH,GAXzB3kG,KAYN+kG,mBAAmBF,EAAYD,IAMxCjyF,SAAU,WASN,OAHI3H,IALOhL,KACS2kG,WAAWhyF,WAK3B5H,IANO/K,KAES4kG,WAAWjyF,aASnCoyF,mBAAoB,SAAUC,EAASvyF,GACnCtV,EAAEqM,KAAKiJ,EAAQ+rC,OAAO,WAAWr2C,KAAK,SAAU5E,GAC5CyhG,EAAQ/iG,QAAQL,OAAO2B,GACvBkP,EAAQq0D,kBAAkBk+B,QCvEtC7nG,EAAEklD,MAAM57C,OAAO,iCAKXw+F,mBAAoB,SAAU55F,GAC1B,IAEI65F,EAAUr4F,OAAO23D,UAAU1vC,KAAKruB,QAChC0+F,SAAU,SAAU1yF,GAChBzS,KAAKolG,SAAWplG,KAAKolG,aACrBplG,KAAKolG,SAASx8F,KAAK6J,IAGvB4yF,OAAQ,SAAUzhG,GACd,IAAK,IAAI9C,EAAId,KAAKolG,SAASlgG,OAAS,EAAIpE,GAAK,EAAGA,IAC5Cd,KAAKolG,SAAStkG,GAAGogE,eAAet9D,IAIxCmuC,SAAU,SAAUnuC,GAChBA,EAAQA,GAAS,GACjB5D,KAAKsN,OAAO1J,GACZ5D,KAAKqlG,OAAOzhG,MAIhB0hG,EAAUz4F,OAAO23D,UAAU1vC,KAAKruB,QAChC0+F,SAAU,SAAU1yF,GAChBzS,KAAKolG,SAAWplG,KAAKolG,aACrBplG,KAAKolG,SAASx8F,KAAK6J,IAGvB4yF,OAAQ,SAAUzhG,GACd,IAAK,IAAI9C,EAAId,KAAKolG,SAASlgG,OAAS,EAAGpE,GAAK,EAAGA,IAC3Cd,KAAKolG,SAAStkG,GAAGugE,eAAez9D,IAIxCmuC,SAAU,SAAUnuC,GAChBA,EAAQA,GAAS,GACjB5D,KAAKsN,OAAO1J,GACZ5D,KAAKqlG,OAAOzhG,MAKhB+gG,EAAa,IAAIO,EAzCVllG,KAyCuBulG,oBAAoB,QAClDX,EAAa,IAAIU,EA1CVtlG,KA0CuBulG,oBAAoB,QAEtDZ,EAAWQ,SAASP,GACpBA,EAAWO,SAASR,GA7CT3kG,KAgDN0kG,kBAAkBC,EAAYC,IAGvCW,oBAAqB,SAAUC,GAC3B,IACIhgD,EADOxlD,KACK0gC,mBACZhuB,EAFO1S,KAEW0S,WAElB+yF,GACA5nG,MACI6U,YACIpV,GAAMoV,EAAWpV,GACjBujB,MAASnO,EAAWmO,MAAQ,IAAM2kF,EAClC97B,YAAe,UAGvB7pE,KAAM,UACNu9B,OAAQooB,EACRsd,cAdO9iE,KAca8iE,cACpBE,UAAWn2D,OAAOC,aAClBi2D,YAhBO/iE,KAgBW+iE,aAStB,OALI0iC,EAAiB5nG,KAAK6U,WAAWynC,YADZ,QAArBqrD,EAC+C,OAEA,KAG5CC,KCnFftoG,EAAEklD,MAAM57C,OAAO,kCAKXw+F,mBAAoB,WAChB,IAEIS,EAAW74F,OAAO23D,UAAUpzB,MAAM3qC,QAClC0+F,SAAU,SAAU1yF,GAChBzS,KAAKolG,SAAWplG,KAAKolG,aACrBplG,KAAKolG,SAASx8F,KAAK6J,IAGvB4yF,OAAQ,SAAUzhG,GACd,IAAK,IAAI9C,EAAId,KAAKolG,SAASlgG,OAAS,EAAIpE,GAAK,EAAGA,IAC5Cd,KAAKolG,SAAStkG,GAAGogE,eAAet9D,IAIxCmuC,SAAU,SAAUnuC,GAChBA,EAAQA,GAAS,GACjB5D,KAAKsN,OAAO1J,GACZ5D,KAAKqlG,OAAOzhG,MAIhB+hG,EAAW94F,OAAO23D,UAAUpzB,MAAM3qC,QAClC0+F,SAAU,SAAU1yF,GAChBzS,KAAKolG,SAAWplG,KAAKolG,aACrBplG,KAAKolG,SAASx8F,KAAK6J,IAGvB4yF,OAAQ,SAAUzhG,GACd,IAAK,IAAI9C,EAAId,KAAKolG,SAASlgG,OAAS,EAAGpE,GAAK,EAAGA,IAC3Cd,KAAKolG,SAAStkG,GAAGugE,eAAez9D,IAIxCmuC,SAAU,SAAUnuC,GAChBA,EAAQA,GAAS,GACjB5D,KAAKsN,OAAO1J,GACZ5D,KAAKqlG,OAAOzhG,MAIhB+gG,EAAa,IAAIe,EAxCV1lG,KAwCwBulG,oBAAoB,QACnDX,EAAa,IAAIe,EAzCV3lG,KAyCwBulG,oBAAoB,QAEvDZ,EAAWQ,SAASP,GACpBA,EAAWO,SAASR,GA5CT3kG,KA8CN0kG,kBAAkBC,EAAYC,IAIvCW,oBAAqB,SAAUC,GAC3B,IACIhgD,EADOxlD,KACK0gC,mBACZhuB,EAFO1S,KAEW0S,WAgBtB,OAbI7U,MACI6U,YACIpV,GAAMoV,EAAWpV,GACjBujB,MAASnO,EAAWmO,MAAQ,IAAM2kF,EAClC97B,YAAe,UAGvB7pE,KAAM,UACNu9B,OAAQooB,EACRsd,cAdO9iE,KAca8iE,cACpBE,UAAWn2D,OAAOC,aAClBi2D,YAhBO/iE,KAgBW+iE,gBCzE7B5lE,EAAEklD,MAAM57C,OAAO,mCAKZw+F,mBAAoB,WAChB,IAEIW,EAAY/4F,OAAO23D,UAAU37D,OAAOpC,QACpC0+F,SAAU,SAAU1yF,GAChBzS,KAAKolG,SAAWplG,KAAKolG,aACrBplG,KAAKolG,SAASx8F,KAAK6J,IAGvB4yF,OAAQ,SAAUzhG,GACd,IAAK,IAAI9C,EAAId,KAAKolG,SAASlgG,OAAS,EAAIpE,GAAK,EAAGA,IAC5Cd,KAAKolG,SAAStkG,GAAGogE,eAAet9D,IAIxCmuC,SAAU,SAAUnuC,GAChBA,EAAQA,GAAS,GACjB5D,KAAKsN,OAAO1J,GACZ5D,KAAKqlG,OAAOzhG,MAIhBiiG,EAAYh5F,OAAO23D,UAAU37D,OAAOpC,QACpC0+F,SAAU,SAAU1yF,GAChBzS,KAAKolG,SAAWplG,KAAKolG,aACrBplG,KAAKolG,SAASx8F,KAAK6J,IAGvB4yF,OAAQ,SAAUzhG,GACd,IAAK,IAAI9C,EAAId,KAAKolG,SAASlgG,OAAS,EAAGpE,GAAK,EAAGA,IAC3Cd,KAAKolG,SAAStkG,GAAGugE,eAAez9D,IAIxCmuC,SAAU,SAAUnuC,GAChBA,EAAQA,GAAS,GACjB5D,KAAKsN,OAAO1J,GACZ5D,KAAKqlG,OAAOzhG,MAIhB+gG,EAAa,IAAIiB,EAxCV5lG,KAwCyBulG,oBAAoB,QACpDX,EAAa,IAAIiB,EAzCV7lG,KAyCyBulG,oBAAoB,QAExDZ,EAAWQ,SAASP,GACpBA,EAAWO,SAASR,GA5CT3kG,KA8CN0kG,kBAAkBC,EAAYC,IAIvCW,oBAAqB,SAAUC,GAC3B,IACIhgD,EADOxlD,KACK0gC,mBACZhuB,EAFO1S,KAEW0S,WAiBtB,OAdI7U,MACI6U,YACIpV,GAAMoV,EAAWpV,GACjBujB,MAASnO,EAAWmO,MAAQ,IAAM2kF,EAClC97B,YAAe,UAGvB7pE,KAAM,UACNu9B,OAAQooB,EACRsd,cAdO9iE,KAca8iE,cACpBE,UAAWn2D,OAAOC,aAClBi2D,YAhBO/iE,KAgBW+iE,gBCvE9Bl2D,OAAO23D,UAAUhf,KAAK/+C,OAAO,yBAEzB+Q,KAAM,SAASnM,GACArL,KAGNsN,OAAOjC,IAMhBw6D,oBAAqB,SAAShkD,GAC1B,IAAI9hB,EAAOC,KAEXD,EAAKuN,OAAOuU,GAGZ,IAAI5iB,EAAUc,EAAKq4E,cACC,EAAYn5E,EAAQiG,OAAS,KAI7C/H,EAAEgU,UAAUtT,KAAK,YAAa,aAG9BV,EAAEgU,UAAUgW,OAAO,aAAaniB,KAAK,YAAa,SAASiJ,EAAG2F,GAC1D7T,EAAK+lG,eAAelyF,KAIxBzW,EAAEkhB,QAAQ8I,OAAO,gBAAgBniB,KAAK,eAAgB,SAASiJ,GAE3D,IAAI83F,KAIJ,GAHAhmG,EAAKknE,oBAAoB8+B,IAGpB5oG,EAAE4jB,cAAcglF,IAAY5oG,EAAEgU,UAAUtT,KAAK,aAC9C,OAAOgP,OAAOC,aAAaC,YAAY,qCAWvDq5D,kBAAmB,WACf,IACIsR,EADA33E,EAAOC,KAEPwlD,EAAOzlD,EAAK8hB,UAEhB1kB,EAAEqoD,EAAKniD,YAAYxC,KAAK,WAChB1D,EAAE6C,MAAMiyC,SAAS,wCACjBylC,EAA0B13E,QAKlCD,EAAK43E,qBAGL53E,EAAK63E,eAAepyB,GAEpBzlD,EAAKiF,KAAK,gBAAiB,WAEvBjF,EAAKskE,qBAAuB,IAAIx3D,OAAOsqD,QAAQpxB,YAAY8xC,WAAW93E,EAAMA,EAAK23D,aAGjF33D,EAAKwoE,iBAAmB,IAAI17D,OAAOsqD,QAAQpxB,YAAY36B,OAAOrL,EAAMA,EAAKV,SAGzEU,EAAKyvE,cAAcr/D,YAIvBpQ,EAAKiF,KAAK,qBAAsB,WAC5BjF,EAAKsL,OAAOi3D,WAAW0jC,uBAI3BjmG,EAAKiF,KAAK,wBAAyB,WAC/BjF,EAAKsL,OAAOi3D,WAAW2jC,0BAI3B9oG,EAAE,qBAAsBu6E,GAAyB1yE,KAAK,QAAS,WAC3D,IAAIkhG,EAAkB/oG,EAAE6C,MAAMsD,KAAK,SAC/By0E,EAAemuB,EAAgBroG,KAAK,UAAY,QAED,IAAxCkC,EAAK43E,kBAAkBI,KAC9Bh4E,EAAK43E,kBAAkBI,IAAgB,GAGvClrE,OAAOY,KAAKuF,aAAakzF,EAAgBroG,KAAK,aAE9CqoG,EAAgBrgF,YAAY,6BAC5BqgF,EAAgBrgF,YAAY,YAAYxkB,SAAS,gBACjD6kG,EAAgBroG,KAAK,WAAW,GAChCkC,EAAK43E,kBAAkBI,IAAgB,IAGvCmuB,EAAgB7kG,SAAS,6BACzB6kG,EAAgB7kG,SAAS,cAAcA,SAAS,YAAYwkB,YAAY,gBACxEqgF,EAAgBroG,KAAK,WAAW,GAChCkC,EAAK43E,kBAAkBI,IAAgB,MAQnD+tB,eAAgB,SAASlyF,EAAcuyF,GACnC,IAAIpmG,EAAOC,KACPnC,KAIJ,GAFAkC,EAAKknE,oBAAoBppE,GAEpBV,EAAE4jB,cAAcljB,GAiBjB+V,EAAazD,cAjBW,CACxB,IAAIi2F,EAA2C,cAA7BrmG,EAAK2S,WAAWylE,SAC9BzhE,EAAU0vF,EAAcv5F,OAAOC,aAAaC,YAAY,iCAAmCF,OAAOC,aAAaC,YAAY,iCAE/H5P,EAAEqM,KAAKqD,OAAO4sE,oBAAoB/iE,EAAS,SAAU,YAAYvO,KAAK,WAC7Di+F,GACDrmG,EAAK65E,WAEThmE,EAAazD,YACdC,KAAK,WACAg2F,EACAxyF,EAAa0+C,SAEb1+C,EAAazD,cAQ7B8pE,mBAAoB,SAAS3B,GACzB,IASIz6E,EATAkC,EAAOC,KAEPX,KACAokB,EAAQtmB,EAAE4S,WACVkrE,EAAmB,KACnBC,EAAsB,KACtBC,EAAgB,KAChBC,EAAmB,KACnBC,EAAe,KAyCnB,IArCI/C,EAAiBpyB,YAAcoyB,EAAiBrrB,aAAeqrB,EAAiB9B,iBAEhF34E,EAAOkC,EAAK85E,gCAIhB18E,EAAEqM,KAAKzJ,EAAKyB,gBAAgB2G,KAAK,WAC7BhL,EAAE,cAAc69E,SAAUr4D,UAAWxlB,EAAE,4BAA8B,UAIrEm7E,EAAiBrrB,eAEjBguB,EAAmBl7E,EAAKgjE,YAAY7c,YAChC96C,OAAQ,aACRvN,KAAMA,EACNimD,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAarkD,EAAK2S,WAAW0xC,YAC7Ba,SAAS,KAEIkN,IAAM,aAEvBipB,EAAmBr7E,EAAKw7E,wBAAwBjD,EAAiBh7E,IAGjEO,MACAq9E,EAAsBn7E,EAAKgjE,YAAY9W,eACnCpI,SAAUy0B,EAAiBh7E,GAC3BwmD,aAAc/jD,EAAK2S,WAAWoxC,cAAgB,GAC9CM,YAAarkD,EAAK2S,WAAW0xC,YAC7Ba,SAAS,KAEOkN,IAAM,cAE1BkpB,EAAet7E,EAAKy7E,oBAAoBlD,EAAiBh7E,KAGzDg7E,EAAiBzpC,MAAQypC,EAAiB/B,MAAQ+B,EAAiB7B,MAAQ6B,EAAiB9B,cAAe,CAE3G,GAAIz2E,EAAKsmD,YAAa,CAClB,IAAIA,KAKJ,GAJAlpD,EAAE0D,KAAKb,KAAK23E,kBAAmB,SAAS52E,EAAK6C,GACzC,GAAUyiD,EAAYz9C,KAAK7H,KAGY,GAAvC8L,OAAOY,KAAK6U,WAAW+jC,GAAmB,CAC1C,IAAIggD,EAAwBx5F,OAAOC,aAAaC,YAAY,qCACxDu5F,EAAsBz5F,OAAOC,aAAaC,YAAY,sCAK1D,OAHAF,OAAOwtE,eAAegsB,EAAuBC,EAAqB,QAAQ,GAC1EvmG,EAAKgC,aACL0hB,EAAM6uC,SACC7uC,EAAMlb,YAIrB4yE,EAAgBp7E,EAAKgjE,YAAY7c,YAC7B96C,OAAQktE,EAAiBltE,OACzBm7C,oBAAqB+xB,EAAiB/xB,oBACtC1oD,KAAMA,EACNimD,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAarkD,EAAK2S,WAAW0xC,YAC7Ba,SAAS,EACToB,YAAaA,GAAe,GAC5BD,YAAarmD,EAAK2S,WAAW2xC,YAC7BiC,aAAcvmD,EAAK2S,WAAWkxC,gBAGpBuO,IAAM,gBAGpB+oB,IACA77E,EAAQuJ,KAAKqyE,GAGTG,GACA/7E,EAAQuJ,KAAKwyE,GAGjB/7E,EAAQuJ,KAAKsyE,GAGTG,GACAh8E,EAAQuJ,KAAKyyE,GAGjBh8E,EAAQuJ,KAAKsyE,IAGbC,GACA97E,EAAQuJ,KAAKuyE,GAIjB,IAAIO,EAAsB,IAAIv+E,EAAE4S,SAkGhC,OAjGIlS,GAAQA,EAAKk8E,UACb58E,EAAEqM,KAAK4E,MAAMpO,KAAMnC,EAAKk8E,WAAW5xE,KAAK,SAASm9C,GAC7Co2B,EAAoBvrE,QAAQm1C,KAC7Bl1C,KAAK,WACJqQ,QAAQC,IAAI,6DACZg7D,EAAoBppB,WAGxBopB,EAAoBvrE,UAGxBhT,EAAEqM,KAAKkyE,GAAqBvzE,KAAK,WAC7B0E,OAAOY,KAAKI,WAAWrM,eAEvBrE,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAczzC,SAAUxQ,QAASA,KACpD8I,KAAK,SAASsqD,GAIX,IAAIkpB,EASJ,GAXA57E,EAAKgC,aAGL5E,EAAE0D,KAAK4xD,EAAW,SAAS3xD,EAAGwkD,GACE,sBAAxBA,EAASv9C,OAAOkC,OAEhBlK,EAAKu8E,qBAAqBh3B,EAASv9C,OAAOg0E,UAC1CJ,GAAkB,KAIrBA,EA4BGrD,EAAiBrrB,aACjBltD,EAAKk8E,mBAAmB3D,EAAiBh7E,QA7B3B,CAElB,IAAKyC,EAAK84E,kBAAkBpmB,EAAW6lB,GACnC,OAIAA,EAAiBn2E,SACjBpC,EAAKm8E,cAIL5D,EAAiB5B,SACjB32E,EAAK+5D,eAAe,WAChBj0B,OAAQ9lC,EAAKsL,OAAOw6B,SAKxByyC,EAAiB9B,eACb/jB,EAAUvtD,OAAS,GACnBnF,EAAK+5D,eAAe,WAChBj0B,OAAQ4sB,EAAU,GAAG1qD,OAAO4yE,OAC5BC,WAAYnoB,EAAU,GAAG1qD,OAAO8yE,oBAWzC96E,EAAKwmG,oBAEZ9iF,EAAMtT,YACPC,KAAK,SAASksD,EAAGA,EAAGhX,GACnB,IAAIkhD,EAAe,GAKfluB,EAAiBrrB,aACjBltD,EAAKk8E,mBAAmB3D,EAAiBh7E,IAEzCgoD,GAAYA,EAAS3pB,QAA8D,KANnF,iCAAkC,4BAA6B,0BAMnBzxB,QAAQo7C,EAAS3pB,MAAMyoC,YACnEoiC,EAAe35F,OAAOC,aAAaC,YAAYu4C,EAAS3pB,MAAMjlB,SAC9D3W,EAAKgC,aACL5E,EAAEqM,KAAKqD,OAAO4sE,oBAAoB+sB,EAAc,MAAM,IAAQ3iF,KAAK,WAC/D,IAAI8I,EAAUxvB,EAAEsJ,UAAW6xE,GAAoB/xB,qBAAqB,IAEpE,OAAOppD,EAAEqM,KAAKzJ,EAAKk6E,mBAAmBttD,MACvCxkB,KAAK,WACJsb,EAAMtT,YACPC,KAAK,WACJqT,EAAM6uC,aAGVk0C,OAAqC,IAAf,EAA6B35F,OAAOC,aAAaC,YAAY,4BAA8Bu4C,EACjHvlD,EAAK+6E,aAAcn/C,MAAS6qE,IAC5B/iF,EAAM6uC,OAAOhN,MAElB6iB,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,kBAEhCq6D,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,gBAEpB2V,EAAMlb,WAGjBgzE,wBAAyB,SAASj+E,GAC9B,OAAOuP,OAAOY,KAAKg5F,uBAAuB,yBAA2BzmG,KAAKsN,OAAOhQ,GAAM,MAG3Fk+E,oBAAqB,SAASl+E,GAC1B,OAAOuP,OAAOY,KAAKg5F,uBAAuB,yBAA2BzmG,KAAKsN,OAAOhQ,GAAM,MAM3F86E,WAAY,WAMR,OALWp4E,KAEF4gC,cAAgB8lE,QAFd1mG,KAE6B4gC,YAAYw3C,aAChDsuB,QAHO1mG,MAKJ7C,EAAE,6CALE6C,KAKiD6hB,YAGhE+1D,eAAgB,WACZ,IAAI73E,EAAOC,KACPqL,EAAStL,EAAK6gC,YAEdv1B,GAAUA,EAAOusE,iBAEjB8uB,EADcr7F,EAAOusE,gBACb73E,GAGZ,IAAI2S,EAAa3S,EAAK2S,WACtBA,EAAWzT,QAAUc,EAAKd,QAG1Bc,EAAK4mG,WAAa,KAClB5mG,EAAK6mG,WAAa,KAGlB,IAAK,IAAI9lG,EAAI,EAAGoE,EAASwN,EAAWzT,QAAQiG,OAAQpE,EAAIoE,EAAQpE,IACvB,SAAjC4R,EAAWzT,QAAQ6B,GAAGsK,OACtBrL,EAAK4mG,WAAaj0F,EAAWzT,QAAQ6B,GACG,SAAjC4R,EAAWzT,QAAQ6B,GAAGsK,SAC7BrL,EAAK6mG,WAAal0F,EAAWzT,QAAQ6B,IAI7C,IAAIwhE,EAAaviE,EAAKwiE,gBAEtB,QAA4B,IAAjB,EAA8B,CAErC,IAAIskC,EAAiB9mG,EAAK+mG,wBAEI,IAAnBD,EACPA,EAAerkC,qBAAqBziE,GAEpCuiE,EAAWE,qBAAqBziE,GAKxCA,EAAKgnG,gBAAgBhnG,EAAKq4E,eAG9B2uB,gBAAiB,SAAS9nG,GACtB,IAAIc,EAAOC,KACPgnG,EAAiB,EAGhB/nG,GAA8B,IAAnBA,EAAQiG,SAExBjG,EAAQ+F,KAAK,aAAc,SAAS0hB,GAChCA,EAAMmtB,iBAEN,IAAIhmB,EAAUnH,EAAMotB,cAAcmzD,cAAgBvgF,EAAMotB,cAAcmzD,cAAc,GAAKvgF,EACzFsgF,EAAiBn5E,EAAQlH,QAG7B1nB,EAAQ+F,KAAK,mBAAoB,SAAS0hB,GACtCA,EAAMmtB,iBAGN12C,EAAE,SAAU4C,EAAK8hB,WAAWkuB,OAC5B,IACIm3D,GADUxgF,EAAMotB,eAAiBptB,EAAMotB,cAAcc,eAAiBluB,EAAMotB,cAAcc,eAAe,GAAKluB,GACnFC,MAK/B,GAHA5mB,EAAKyB,eAGc,UAAfklB,EAAMzc,MAAoBi9F,EAAmBF,EAAiB,IAAME,EAAmBF,EAAiB,GACxGjnG,EAAKgC,iBACF,CACH,IACIs0E,EADSl5E,EAAE6C,MACMsB,KAAK,WACtBg3E,EAAmBv4E,EAAKd,QAAQo3E,GAGpCl5E,EAAEqM,KAAKzJ,EAAKi2E,cAAcsC,IAAmBnQ,OAAO,WAChDpoE,EAAKgC,oBAQrBm6E,YAAa,SAAS70C,GAClB,IAAItnC,EAAOC,KACPqL,EAAStL,EAAK6gC,YACdnd,EAAQ,IAAItmB,EAAE4S,SAElBs3B,EAAQA,GAAStnC,EAAK6nE,WAEtB,IAAIvqE,GACAwoC,OAAQ9lC,EAAKsL,OAAOw6B,QAAU,GAC9Bqe,WAAYnkD,EAAKsL,OAAO64C,YAAc,GACtCC,OAAQpkD,EAAKsL,OAAO84C,QAAU,GAC9B9c,MAAOA,EACPm1C,aAAcz8E,EAAK08E,kBACnB34B,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAarkD,EAAK2S,WAAW0xC,YAC7BG,WAAW,EACXn5C,OAAQrL,EAAKm4E,oBACbxzB,aAAc3kD,EAAK2S,WAAWgyC,cAAgB,GAC9C4d,WAAYj3D,EAAOi3D,WACnBukC,eAAgBx7F,EAAOw7F,gBAyB3B,OAtBIx7F,EAAO8nE,gBAAkB9nE,EAAOusE,kBAChCv6E,EAAQ81E,eAAiB9nE,EAAO8nE,eAChC91E,EAAQu6E,eAAiBvsE,EAAOusE,eAChCv6E,EAAQ8pG,eAAiB97F,EAAO87F,mBAChC9pG,EAAQ+6E,WAAa/sE,EAAO+sE,YAGhCj7E,EAAE,uBAAuBuH,IAAI,6BAA8B,WAG3D3E,EAAKyB,eACLrE,EAAEqM,KAAKzJ,EAAK+5D,eAAe,UAAWz8D,IAAU8K,KAAK,WACjDsb,EAAMtT,UACNrO,WAAW,WACP3E,EAAE,uBAAuBuH,IAAI,6BAA8B,UAC5D,OACJ0L,KAAK,WACJqT,EAAM6uC,WACP6V,OAAO,WACNpoE,EAAKgC,eAGF0hB,EAAMlb,WAGjBk0E,gBAAiB,WAWb,IAVA,IACIC,EADO18E,KACcslE,kBAAkB,OAEvCqX,EAAOx/E,EAAE2N,IAAI4xE,EAAe,SAASE,GACrC,OAASC,IAAKD,EAAalqE,WAAWpV,GAAIoxD,SAAUkuB,EAAahgC,aAGjE4/B,KACA17E,EAAI67E,EAAKz3E,OAENpE,KAAM,GACT07E,EAAaG,EAAK77E,GAAG+7E,KAAOF,EAAK77E,GAAG4tD,SAGxC,OAAO8tB,GAGXja,cAAe,WAEX,OADaviE,KAAK0gC,mBAAmBE,YACvB0hC,YAGlBwkC,iBAAkB,WAEd,OADa9mG,KAAK0gC,mBAAmBE,YACvBimE,gBAGlBpkC,yBAA0B,WACtB,IAAIH,EAAatiE,KAAKuiE,gBACtB,OAAOD,GAAcA,EAAWG,4BAGpC2kC,qBAAsB,WAClB,IAAI9kC,EAAatiE,KAAKuiE,gBACtB,OAAOD,GAAcA,EAAW8kC,wBAMpC9qB,qBAAsB,SAASxO,GAC3B,IAAI/tE,EAAOC,KAEuB,iBAAvB,EACPD,EAAKskE,qBAAqB3L,sBAAsBoV,GAEhD3wE,EAAE0D,KAAKitE,EAAmB,SAAShtE,EAAG4V,GAClC3W,EAAKskE,qBAAqB3L,sBAAsBhiD,KAIxD3W,EAAKskE,qBAAqB9K,wBAG1B,IAAI+I,EAAaviE,EAAKwiE,gBAClBD,GAAcA,EAAW/qD,eAAe,4BACxCxX,EAAKwiE,gBAAgB8kC,2BAI7B7lG,aAAc,SAAS63B,GACnBxsB,OAAOY,KAAKI,WAAWrM,gBAG3BO,WAAY,WACR8K,OAAOY,KAAKI,WAAWC,eAG3BswB,QAAS,SAAS/yB,QAIU,IAAb,QAA2D,IAAtBA,EAAgB,WAAyC,GAApBA,EAAOk5C,WAHjFvkD,KAIFsN,UAOb0qD,qBAAsB,SAAS2L,EAAW9lE,GAEtC,OADAmC,KAAKsN,OAAOq2D,EAAW9lE,GAClBmC,KAAKo9B,OAOCp9B,KAAKo9B,OAAO46B,qBAAqB2L,EAAW9lE,GAN/CmC,KAAKijE,kBACEjjE,KAAKijE,kBAAkBh+D,QAAQ0+D,EAAW9lE,GAE1C,MAOnBi9E,YAAa,SAASn/C,GAClB,IAAI57B,EAAOC,KACXD,EAAKuN,OAAOquB,GAEZ,IAAI2rE,KACJ,IACIA,EAAY3qF,KAAKhE,MAAMgjB,OACzB,MAAO1tB,GACLq5F,EAAa3rE,EAAMz2B,QAAUy2B,EAAMz2B,OAAS,EAAKy2B,EAAM,GAAKA,EAC9D,QAGM2rE,EAAU3rE,QAAO2rE,EAAYA,EAAU3rE,OACvC2rE,EAAU3rE,QAAO2rE,EAAYA,EAAU3rE,YAGb,IAAnB2rE,EAAUx+D,MAA0C,cAAlBw+D,EAAUx+D,OAEnD3rC,EAAEoqG,SAASjoG,KACPkoG,WAAY,QACZvpG,MAAO,QACPkU,KAAMtF,OAAOC,aAAaC,YAAY,4BAA6B,sIAAsIpI,QAAQ,KAAM,KACvN8iG,QAAQ,EACRzyE,KAAM,MAGVlzB,WAAW,WACP/B,EAAK+5D,eAAe,WAChBj0B,OAAQ9lC,EAAKsL,OAAOw6B,OACpBqe,WAAYnkD,EAAKsL,OAAO64C,cAE7B,QAQf4hB,gBAAiB,WACb,IAAI/lE,EAAOC,KACP0S,EAAa1S,KAAK0S,WAClBrU,EAAW0B,EAAK+iE,cAAcvT,YAAY,QAI1ChsD,EAAOpG,EAAEy8C,UAAUv7C,GACnBY,QAASc,EAAKd,QACdonD,YAAatmD,EAAKsmD,YAClBqe,SAAUhyD,EAAWgyD,SACrB6S,SAAU7kE,EAAW2rC,SACrBx+C,KAAME,EAAK8jE,UACX2T,UAAiC,aAAtBz3E,EAAK+jE,cAChB7f,YAAalkD,EAAKsL,OAAO44C,cAAe,EACxCwzB,WAAY13E,EAAK2S,WAAW4iE,oBAAqB,EACjDzvC,OAZS,GAaTsU,YAAap6C,EAAKsL,OAAO8uC,aAbhB,GAcTu7B,YAAahjE,EAAWgjE,YACxBC,WAAYjjE,EAAWijE,WACvB7xE,YAAa4O,EAAW5O,cAI5B,OAAO/D,EAAKmmE,oBAAoB3iE,EAAMxD,EAAKgnE,yBClpBnDl6D,OAAO23D,UAAUwd,MAAMv7E,OAAO,gCCA9BoG,OAAO23D,UAAUkjC,aAAajhG,OAAO,uCCArCoG,OAAO23D,UAAUqY,IAAIp2E,OAAO,wBACxBkhG,aAAc,IAKd9hC,oBAAqB,SAAUgX,GAChB78E,KACNsN,OAAOuvE,GADD78E,KAIN4nG,mBAGTA,gBAAiB,WACb,IAAI7nG,EAAOC,KACP68E,EAAM98E,EAAK8hB,UAGf1kB,EAAE0/E,GAAKlgC,QACHC,eAA+B10C,IAAnBnI,EAAK68C,WAA8C,OAAnB78C,EAAK68C,UAAsB78C,EAAK68C,UAAY,EACxFC,UAAW98C,EAAKsiD,MAAMslD,aACtB3pD,YAAaj+C,EAAKqR,QAClB0rC,SAAU,SAAUp2B,EAAOna,GACvBxM,EAAK68C,UAAYz/C,EAAEupB,EAAMm3B,eAAiB1gD,EAAEupB,EAAMm3B,eAAehgD,KAAK,SAAW,EAEjF,IAAIsD,EAAQpB,EAAK68C,UACb4I,EAAOzlD,EAAK2gC,mBACZ2iD,KACJA,EAAYtjF,EAAKsD,SAASlC,GAAOi8B,OAAO1qB,WAAWpV,IAAM6D,EACzDqkD,EAAKsxB,SAAS,eAAgBuM,OAQ1CwkB,oBAAqB,WAEE1qG,EAAE,kDADV6C,KACkE6hB,WAC7D3c,QAFLlF,KAEoBqiD,MAAMslD,aACjCxqG,EAAE,oBAHK6C,KAGqB6hB,WAAWgE,YAAY,cAGnD1oB,EAAE,oBANK6C,KAMqB6hB,WAAWxgB,SAAS,iBC7C5DwL,OAAO23D,UAAUsjC,QAAQrhG,OAAO,+BAI5B+Q,KAAM,SAAUnM,GAIZrL,KAAKsN,OAAOjC,GAHDrL,KAMN+nG,iBAAmB,IAAI5qG,EAAE4S,SANnB/P,KAONmkB,gBAAkB,IAAIhnB,EAAE4S,SAPlB/P,KAQNgoG,kBAAoB,IAAI7qG,EAAE4S,UAQnCoyD,qBAAsB,SAAU7N,GAC5B,IAAIv0D,EAAOC,KAEX7C,EAAEqM,KAAKzJ,EAAKqR,SAASjJ,KAAK,WAEtB,IAAIy0E,EAAe78E,EAAKq9B,OACpBw/C,GAAgBA,EAAa/6D,UAAU86D,KAAKplE,eAAe,WAC3DqlE,EAAa/6D,UAAU86D,KAAK,SAAU,SAAU58E,EAAK8hB,UAAUhkB,KAAK,mBAUhFwpC,MAAO,WACQrnC,KAGNmiE,uBAGLniE,KAAKsN,UAST4yD,iBAAkB,SAAU5L,GAExB,IAAIv0D,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBkqE,EAAe78E,EAAKq9B,OAAOvb,UAC3B+6B,EAAY78C,EAAKq9B,OAAO6lD,eAExB3lF,EAAK,iBAAmBoV,EAAWpV,GACnCiJ,EAASpJ,EAAE,yCAA2CG,EAAK,KAAMs/E,GAGrElqE,EAAW2iD,QAAUxoD,OAAOY,KAAKuF,aAAashD,GAE9Cn3D,EAAEqM,KAAKzJ,EAAKqR,SACPjJ,KAAK,WAEF,GAAIuK,EAAW2iD,SAKX,GAJAt1D,EAAK8hB,UAAUnd,IAAI,UAAW,IAE9B3E,EAAKoiE,uBAED57D,GAAUA,EAAO7B,IAAI,UAAW,QAAS,CACzC,IAAIujG,EAAa9qG,EAAE,4BAA8BG,EAAK,KAAMs/E,GAC5DqrB,GAAcA,EAAWvjG,IAAI,UAAW,UAI5C,GADA3E,EAAK8hB,UAAU1c,OACXoB,GAAUA,EAAO7B,IAAI,UAAW,SAAU,CAC1C,IAAIwjG,EAAa/qG,EAAE,4BAA8BG,EAAK,KAAMs/E,GAC5DsrB,GAAcA,EAAW/iG,UAIlCgjE,OAAO,WACFyU,GAAgBA,EAAaD,KAAKplE,eAAe,WACjDqlE,EAAaD,KAAK,SAAU,SAAU//B,GAE1C78C,EAAKq9B,OAAOyqE,2BC3F5Bh7F,OAAO23D,UAAU+tB,WAAW9rF,OAAO,qCCAnCoG,OAAO23D,UAAU2jC,MAAM1hG,OAAO,6BAI1Bo/D,oBAAqB,SAAUsiC,GAChBnoG,KAGNsN,OAAO66F,GAHDnoG,KAINooG,oBAMTrwC,OAAQ,WACO/3D,KACM6hB,WAMrBlkB,SAAU,WACKqC,KACM6hB,WAMrBs9C,gBAAiB,SAAU7K,GAGnBA,EAFOt0D,KAGF+3D,SAHE/3D,KAKFrC,YAIbyqG,iBAAkB,WACd,IACID,EADOnoG,KACM6hB,UAEjB1kB,EAAEgrG,GAAO7kG,KAAK,oBAAoB0B,KAAK,QAAS,WAC5C7H,EAAEgrG,GAAOxzB,YAAY,kBC9CjC9nE,OAAO23D,UAAU6jC,WAAW5hG,OAAO,kCAK/Bw7E,aAAc,WACV,IAAIliF,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlB7U,KACJA,EAAK6U,YACDynC,YAAap6C,EAAKgN,YAAY,wCAC9B9C,KAAM,OACN4W,MAAO,aAAenO,EAAWpV,GACjCA,GAAIoV,EAAWpV,GACf2vF,iBAAiB,EACjBF,YAAa,GACbvvF,OAAQkV,EAAWlV,OACnBoJ,UAAW8L,EAAW9L,UACtB+mF,sBAAuB,SAAUtiF,GAC7B,OAAOtL,EAAKuhF,cAAcj2E,KAIlCxN,EAAK+mE,YAGL,IAAIrnE,EAAUmV,EAAWnV,QACzBJ,EAAE0D,KAAKtD,EAAS,SAAUuD,GACtB,IAAIpC,GACA8/C,WAEJ9/C,EAAO8/C,OAAO9rC,YACVynC,YAAa58C,EAAQuD,GAAGs1E,QACxBv1D,MAAOtjB,EAAQuD,GAAG+f,MAClBkkC,UAAU,GAGd5nD,EAAEsJ,OAAO/H,EAAO8/C,OAAO9rC,WAAY3S,EAAK8iF,0BAA0BtlF,EAAQuD,GAAGuzB,WAIlD,GAAvB92B,EAAQuD,GAAGuzB,WACX31B,EAAO8/C,OAAO9rC,WAAW6tF,eAAgB,GAGlB,GAAvBhjG,EAAQuD,GAAGuzB,UAAwC,GAAvB92B,EAAQuD,GAAGuzB,WACvC31B,EAAO8/C,OAAO9rC,WAAWmgB,cAAgBt1B,EAAQuD,GAAG+xB,eAG7B,IAAvBt1B,EAAQuD,GAAGuzB,UAAyC,IAAvB92B,EAAQuD,GAAGuzB,WACxC31B,EAAO8/C,OAAO9rC,WAAWmgB,eAAgB,GAGlB,IAAvBt1B,EAAQuD,GAAGuzB,WACX31B,EAAO8/C,OAAO9rC,WAAW8lB,SAAWj7B,EAAQuD,GAAG03B,UAEnD36B,EAAK+mE,SAASh8D,KAAKlK,KAGvB,IAAIJ,EAAOyB,EAAK+iE,cAActO,WAC1BvqD,KAAM,OACNpM,KAAMA,EACNu/B,OAAQr9B,EACRF,KAAME,EAAK8jE,YAUf,OAPAvlE,EAAKoU,WAAWgzC,UAAW,EAC3BpnD,EAAKoU,WAAWkzC,WAAY,EAC5BtnD,EAAKoU,WAAWizC,aAAc,EAG9B5lD,EAAKuoG,YAAchqG,EAEZA,EAAKkgD,UAMhBqnB,oBAAqB,SAAUhkD,GACnB7hB,KACHsN,OAAOuU,GAEZ,IAAI0mF,EAAU1mF,EAAUve,KAAK,uCACzBzD,EAJIG,KAIQ6jE,UAJR7jE,KAOH6hB,UAAYA,EAGjB,IAAIvjB,EAAOnB,EAAEorG,EAAQllG,WAAW,IAVxBrD,KAWHsoG,YAAYxhC,kBAAkBxoE,GAEvB,aAARuB,GAbIG,KAeComE,oBAEG,UAARvmE,GAjBIG,KAmBCsmE,sBAEG,UAARzmE,IArBIG,KAuBCsmE,sBAvBDtmE,KAwBCumE,wBAKbH,kBAAmB,WACf,IAAIrmE,EAAOC,KAGXD,EAAKyoG,kBAAoBrrG,EAAE,uCAAwC4C,EAAK8hB,WACxE9hB,EAAK0oG,iBAAmBtrG,EAAE,sCAAuC4C,EAAK8hB,WAGtE9hB,EAAKuoG,YAAYtjG,KAAK,cAAe,SAASiJ,EAAG1B,GACzCxM,EAAK2S,WAAWyvE,aAAa5qE,eAAe,eAC5CxX,EAAKkF,QAAQ,cAAesH,GAG5BxM,EAAKkF,QAAQ,mBAAoBsH,MAQ7C61E,eAAgB,WACZ,IAAIriF,EAAOC,KAGX,OAFAD,EAAKkF,QAAQ,mBAEN9H,EAAEqM,KAAKzJ,EAAKuoG,YAAYnmG,WAAWgG,KAAK,WAC3CpI,EAAKkF,QAAQ,uBACTlF,EAAKuoG,YAAY51F,WAAW7U,MAAoD,GAA5CkC,EAAKuoG,YAAY51F,WAAW7U,KAAKkL,SACrB,GAAhDhJ,EAAKuoG,YAAY51F,WAAW7U,KAAKwE,KAAK6C,QACtC2H,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,uCAClDF,OAAOC,aAAaC,YAAY,uCAQhDirD,qBAAsB,SAAU2L,EAAW9lE,GAKvC,OAJWmC,KAENsN,OAAOq2D,EAAW9lE,GAFZmC,KAIDo9B,OAJCp9B,KAWKo9B,OAAO46B,qBAAqB2L,EAAW9lE,GAX5CmC,KAKEijE,kBALFjjE,KAMSijE,kBAAkBh+D,QAAQ0+D,EAAW9lE,GAE1C,QChKvBV,EAAEklD,MAAM57C,OAAO,qDAIX+Q,KAAM,SAAUurD,EAAaD,EAAesuB,EAAajP,EAAcumB,GACnE1oG,KAAK+iE,YAAcA,EACnB/iE,KAAK8iE,cAAgBA,EACrB9iE,KAAKoxF,YAAcA,EACnBpxF,KAAKmiF,aAAeA,EACpBniF,KAAK0oG,iBAAmBA,EACxB1oG,KAAK2oG,mBAAqB,IAAIxrG,EAAE4S,UAMpCmjE,cAAe,SAAU7nE,GAQrB,OAPWrL,KACN0S,WAAarH,EADPrL,KAIN4oG,iBAAiBv9F,GAJXrL,KAOC2oG,mBAAmBpgG,WAMnCqgG,iBAAkB,SAASv9F,GACvB,IAAItL,EAAOC,KAGP6hB,EAAY9hB,EAAK2oG,iBAAiBpmC,WAAWumC,uBAAwB5qG,MAAOoN,EAAO8uC,cACvFh9C,EAAEqM,KAAKzJ,EAAK+oG,uBAAuBz9F,IAC9BwY,KAAK,SAAShmB,IACa,IAApBwN,EAAO05C,WACPlnD,EAAK2nD,KAAK9yC,WAAWqyC,UAAW,GAGhClnD,EAAK2nD,KAAK9yC,aACV7U,EAAK2nD,KAAK9yC,WAAW5O,YAAc/D,EAAKoiF,aAAar+E,aAAe,OAGxE,IAAI0hD,EAAOzlD,EAAK+iE,cAAcjoB,aAAa19C,EAAEsJ,UAAW1G,EAAK2oG,kBACzDz+F,KAAM,OACNpM,KAAMA,EAAK2nD,KACX8c,WAAYviE,EAAK2oG,iBAAiBpmC,WAClCukC,eAAgBhlF,KAUpB,OAPA9hB,EAAKylD,KAAOA,EAED3lC,OAAOu/D,KAAK55B,EAAKniD,UACvByH,IAAI,SAAS/J,GACdykD,EAAKniD,SAAStC,GAAKsK,OAASlO,EAAEsJ,UAAW++C,EAAKniD,SAAStC,GAAKsK,OAAQtL,EAAK2oG,oBAGtEljD,EAAKhH,UAEb,SAAS9nC,GACR,IAAIqyF,EAAgBhpG,EAAK+iE,cAAckmC,kBAAkB,cACzD7rG,EAAEm2E,WAAWy1B,GAAiBryF,QAASA,IAAWxS,SAAS+kG,UAAU3lG,KAAK,sBAC3E6E,KAAK,SAASlI,GACb,IAAI28E,EAA0D,QAA3C78E,EAAKylD,KAAKx2B,aAAatc,WAAWzI,KAAiBlK,EAAKylD,KAAKx2B,aAAe,KAC3F4tD,GAEAA,EAAa53E,KAAK,WAAY,SAASiJ,EAAG1B,GACtC,IAAI87F,EAAatoG,EAAKqxF,YAAY7kF,EAAGpL,OACrChE,EAAEqM,KAAKzJ,EAAKmpG,cAAc79F,EAAQkB,EAAGswE,IAAKwrB,IACrClgG,KAAK,WAEFpI,EAAKopG,kBAAoB58F,EAAGswE,IAAI7tD,aAChCjvB,EAAKopG,kBAAkBrvC,eAAe,qBAIlD8iB,EAAa/6D,UAAU86D,KAAK,SAAU,GACtC58E,EAAKopG,kBAAoBvsB,EAAa5tD,aAAaA,aAE9CjvB,EAAKopG,kBAAkB35B,gBACxBzvE,EAAKopG,kBAAkB35B,cAAgB,IAAIryE,EAAE4S,UAEjDhQ,EAAKopG,kBAAkBrvC,eAAe,mBAGtC/5D,EAAKopG,kBAAoBppG,EAAKylD,KAAKx2B,aAE9BjvB,EAAKopG,kBAAkB35B,gBACxBzvE,EAAKopG,kBAAkB35B,cAAgB,IAAIryE,EAAE4S,UAEjDhQ,EAAKopG,kBAAkBrvC,eAAe,kBAG1Cj4C,EAAU5hB,QAAQsD,KAAKtD,GACvBF,EAAK2oG,iBAAiBpmC,WAAWh3B,SAASzpB,EAAUvkB,IAEpDyC,EAAKqpG,qBAAuBrpG,EAAKopG,kBAAkBtnF,UAAUve,KAAK,uCAClEvD,EAAKspG,wBACDtpG,EAAKopG,kBAAkBtnF,UAAUve,KAAK,wCAC1CvD,EAAKupG,aAAaznF,MAS9B0nF,cAAe,SAASl+F,GACpB,IAAItL,EAAOC,KACXqL,EAASA,MACT,IAAIqH,EAAa3S,EAAK2S,WAEtB,QAAiC,IAAtB3S,EAAKypG,aAA8B,CAC1C,IAAI9yF,EAAU7J,OAAOC,aAAaC,YAAY,wBAC9ChN,EAAKypG,aAAezpG,EAAK2oG,iBAAiBpmC,WAAWumC,uBAAwB5qG,MAAOyY,IAGpF3W,EAAKypG,aAAavpG,QAAQ+E,KAAK,QAAS,kBAC7BjF,EAAKypG,eAIpB,IAAIjlD,EAAYl5C,EAAOk5C,YAAa,EAEhC24C,GACA94C,YAAa/4C,EAAO+4C,YACpBE,WAAY5xC,EAAW0+C,OACvB/M,YAAa,UAGbE,GACA24C,EAAc34C,WAAY,EAC1B24C,EAAcx4C,aAAer5C,EAAOq5C,eAGpCw4C,EAAcr5C,SAAWnxC,EAAWmxC,SACpCq5C,EAAcn5C,cAAgB,WAIlC5mD,EAAEqM,KAAKzJ,EAAKgjE,YAAYvf,YAAY05C,IAAgBr5E,KAAK,SAAShmB,IACtC,IAApBwN,EAAO05C,WACPlnD,EAAK2nD,KAAK9yC,WAAWqyC,UAAW,QAGE,IAA1BlnD,EAAK2nD,KAAe,aAC5B3nD,EAAK2nD,KAAK9yC,WAAW5O,YAAc/D,EAAKoiF,aAAar+E,aAAe,OAGxEjG,EAAK2nD,KAAKnB,YAAc,SAExB,IAAImB,EAAOzlD,EAAK+iE,cAAcjoB,aAAa19C,EAAEsJ,UAAW1G,EAAK0pG,eACzDx/F,KAAM,OACNpM,KAAMA,EAAK2nD,KACXne,MAAOh8B,EAAOg8B,QAAS,EACvBm1C,aAAcnxE,EAAOmxE,aACrBj4B,UAAWA,EACXR,cAAe14C,EAAO04C,cACtBue,WAAYviE,EAAK2oG,iBAAiBpmC,WAClCukC,eAAgB9mG,EAAKypG,gBA+EzB,IAAK,IAAIE,KA5ETlkD,EAAKvmD,SACD9B,EAAEsJ,OACE++C,EAAKvmD,QAAQ,QAETm3E,QAAWvpE,OAAOC,aAAaC,YAAY,+BAC3C1N,SAAY,aAAc,WAC1B6mD,YAAc,EACd/jD,SAAW,EACXk0E,QAAW,EACXjrE,OAAU,OACVqrE,MAAQ,EACRrkE,MAAS,KAITnG,SAAU,WAEN,OAAOlM,EAAK4pG,gBAAgBnkD,GAAMr9C,KAAK,WACnCpI,EAAKypG,aAAa77F,iBACX5N,EAAKypG,aAGZzpG,EAAKoiF,aAAaG,QAAU,EAC5BviF,EAAKopG,kBAAkBjnB,cAAcniF,EAAKoiF,mBAI1DhlF,EAAEsJ,OACE++C,EAAKvmD,QAAQ,QAETm3E,QAAWvpE,OAAOC,aAAaC,YAAY,gCAC3C1N,SAAY,aAAc,WAC1B6mD,YAAc,EACd/jD,SAAW,EACXk0E,QAAW,EACXjrE,OAAU,OACVqrE,MAAQ,EACRrkE,MAAS,KAITnG,SAAU,WACNlM,EAAKypG,aAAa77F,iBACX5N,EAAKypG,iBAK5BrsG,EAAEsJ,OAAO++C,GACLoyB,eAAgB,WAEZz6E,EAAE0D,KAAK2kD,EAAKvmD,QAAS,SAASkC,EAAOlB,GACjC,OAAQA,EAAiB,SACrB,KAAK,EACD9C,EAAEqoD,EAAK4yB,aAAaj3E,IAAQsoB,MAAM,WAC9B1pB,EAAKypG,aAAa77F,iBACX5N,EAAKypG,eAGhBhkD,EAAK4yB,aAAaj3E,GAAO2uB,UAAYjjB,OAAOC,aAAaC,YAAY,gCACrEy4C,EAAKvmD,QAAQkC,GAAOi1E,QAAUvpE,OAAOC,aAAaC,YAAY,gCAC9Dy4C,EAAKvmD,QAAQkC,GAAOiK,OAAS,OAC7B,MAEJ,QACIjO,EAAEqoD,EAAK4yB,aAAaj3E,IAAQsoB,MAAM,WAC9B1pB,EAAK4pG,gBAAgBnkD,GACrBzlD,EAAKypG,aAAa77F,iBACX5N,EAAKypG,qBAQdhkD,EAAKniD,SACvBmiD,EAAKniD,SAASqmG,GAAWr+F,OAASlO,EAAEsJ,UAAW++C,EAAKniD,SAASqmG,GAAWr+F,OAAQtL,EAAK0pG,eAGzF,OAAOtsG,EAAEqM,KAAKg8C,EAAKhH,UAAUr2C,KAAK,SAASlI,GAEvCF,EAAK6pG,eAAiBpkD,EAAKx2B,aAC3BjvB,EAAKypG,aAAavpG,QAAQsD,KAAKtD,GAE1BskD,GACDxkD,EAAK2oG,iBAAiBpmC,WAAWh3B,SAASvrC,EAAKypG,aAAalsG,IAGhEyC,EAAKypG,aAAahnC,qBAAqBhd,GAEvCA,EAAKsU,eAAe,iBAGpB/5D,EAAK8pG,uBAAuB,QAE5BrkD,EAAKxgD,KAAK,UAAW,SAAUs3D,EAAGwtC,GAW9B,OAVAA,EAAcnnF,UAAY5iB,EAAKylD,KAAK3jC,UAAUub,SAASza,YACvDmnF,EAAgB3sG,EAAEsJ,QACd4gC,MAAOA,MACPm1C,aAAcz8E,EAAKylD,KAAKi3B,kBACxBl4B,WAAW,EACXF,YAAatkD,EAAK2S,WAAW2xC,aAAe,GAC5Cie,WAAYviE,EAAK2oG,iBAAiBpmC,WAClCukC,eAAgB9mG,EAAKypG,cACtBM,GAEI/pG,EAAKwpG,cAAcO,SAGnC15F,KAAK,WACJrQ,EAAKypG,aAAa77F,iBACX5N,EAAKypG,aACZ/oF,QAAQC,IAAI,4BASpBipF,gBAAiB,SAAUnkD,GACvB,IAAIzlD,EAAOC,KAEPyjB,GADa1jB,EAAK2S,WACVvV,EAAE4S,YAEd,GAAIy1C,EAAKm0B,eAAgB,CACrB,IAAI97E,KACJV,EAAE2V,kBAAmB,EAErB0yC,EAAKyhB,oBAAoBppE,GACzBA,EAAKumD,YAAcoB,EAAKpB,YAExB,IAAI/4C,GACAD,OAAQ,OACRvN,KAAMA,EACNumD,YAAavmD,EAAKumD,YAClBE,WAAYkB,EAAK9yC,WAAW0+C,OAC5BhL,YAAa,UAIboL,KAEJhM,EAAKq0B,6BAA6BroB,GAGlCr0D,EAAE2V,kBAAmB,EAEhBjG,OAAOY,KAAKkU,WAAW6vC,IA2BxB3kD,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,sCACtD0W,EAAM6uC,UA3BNn1D,EAAEqM,KAAKzJ,EAAKgjE,YAAY7c,WAAW76C,IAC9BlD,KAAK,SAAUm9C,GASZ,IAAK,IAAIxkD,KAAK0wD,EAAU,CACpB,IAAIu4C,GATclpF,EASS/f,OARvB09C,EAEkB,iBAFlBA,EAASz+C,EAAKopG,kBAAkB30C,UAAU3zC,KAED,OAAX29B,GACrBk9C,OAAS,EAAMh/E,IAAO8hC,IAC1Bk9C,OAAS,EAAOh/E,SAKrBqtF,EAAQrO,QACRqO,EAAQrtF,IAAIq1B,SAASyf,EAAS1wD,IAC9Bf,EAAKiqG,yBAAyBD,EAAQrtF,IAAK8oC,EAAM1kD,EAAG0wD,IAZ5D,IAAsB3wC,EACd29B,EAeR/6B,EAAMtT,YAETC,KAAK,SAAUivF,EAAOp1F,EAAMyM,GACzB8uC,EAAK82B,qBAAqB5lE,EAAQA,SAClC+M,EAAM6uC,gBASlB7uC,EAAM6uC,SAEV,OAAO7uC,GAUXumF,yBAA0B,SAASC,EAAyBC,EAASrpF,EAAO2wC,GACxB,kBAA5Cy4C,EAAwBv3F,WAAWzI,KACnCggG,EAAwBlpC,gBAAgBmpC,EAAQ11C,UAAU3zC,GAAO8sD,mBAEjEs8B,EAAwBlpC,gBAAgBvP,EAAS3wC,KAOzDyoF,aAAc,SAAUznF,GACpB,IAAI9hB,EAAOC,KAEXD,EAAKoqG,qBAAqBtoF,GAE1BA,EAAU5hB,QAAQ+E,KAAK,QAAS,WAC5BjF,EAAK4oG,mBAAmBr2C,YAIhC42C,cAAe,SAAU79F,EAAQwxE,EAAKwrB,GAClC,IAAItoG,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SAGlB,OAAI8sE,EAAIx5E,SAAS6B,OAAS,EACf,MAGX/H,EAAEqM,KAAKzJ,EAAKgmD,kBAAkB16C,EAAQg9F,IACjCp4F,KAAK,SAAUpS,GAEZ,IAAIusG,EAAsBrqG,EAAK+iE,cAAcjoB,cACzC5wC,KAAM,aACNpM,KAAMA,EAAK2nD,OAIf,OADAq3B,EAAIx5E,SAASuF,KAAKwhG,GACXA,EAAoB5rD,WAE9Br2C,KAAK,SAAUlI,GAEZ9C,EAAE,8BAA+B8C,GAASgd,SAC1C4/D,EAAIh7D,UAAUjgB,OAAO3B,GACrBwjB,EAAMtT,YAEPsT,EAAMlb,YAQjBugG,uBAAwB,SAAUz9F,GAC9B,IAAItL,EAAOC,KACPkQ,EAAW,IAAI/S,EAAE4S,SACjBlS,GACA2nD,MACI9yC,cACAkyD,cAIJ/iD,EAAYhkB,EAAK2nD,KACjB6kD,EAAmBtqG,EAAKqxF,YAAY,GAGxC,GAAIrxF,EAAKqxF,YAAYlsF,OAAS,EAAG,CAC7B,IAAI03E,GACJlqE,YACIzI,KAAM,OAGV26D,aACI0lC,KAEJntG,EAAE0D,KAAKd,EAAKqxF,YAAa,SAAUtwF,EAAGunG,GAClC,IAAIkC,EAAYlC,EAAoB,UAAK,EAErCxrB,KACJA,EAAInqE,YACApV,GAAIwD,EACJmJ,KAAM,UACNkwC,YAAakuD,EAAWjyB,SAE5ByG,EAAIjY,YAEA2lC,GACA3tB,EAAahY,SAASh8D,MAClBiZ,UAAWg7D,IAGfh7D,EAAYg7D,EACZwtB,EAAmBtqG,EAAKqxF,YAAY,IAEpCkZ,EAAc1hG,MACViZ,UAAWg7D,MAMvB1/E,EAAE0D,KAAKypG,EAAe,SAAUxpG,EAAGb,GAC/B28E,EAAahY,SAASh8D,KAAK3I,KAE/BpC,EAAK2nD,KAAKof,SAASh8D,MACfiZ,UAAW+6D,IAanB,OARAz/E,EAAEqM,KAAKzJ,EAAKgmD,kBAAkB16C,EAAQg/F,IACjCliG,KAAK,SAAUqiG,GACZ3oF,EAAU+iD,SAASh8D,KAAK4hG,GACxB3oF,EAAUnP,WAAWpV,GAAK8J,KAAKskC,OAG/Bx7B,EAASC,QAAQtS,KAElBqS,EAAS3H,WASpBw9C,kBAAmB,SAAU16C,EAAQg9F,GAEjC,OADWroG,KACC+iE,YAAYhd,kBAAkB5oD,EAAEsJ,OAAO4E,GAC/C26C,aAAcqiD,EAAW/qG,GACzBomB,IAAK2kF,EAAW3kF,OAChBzT,KAAK,SAAUpS,GAGf,OADAA,EAAK2nD,KAAK9yC,WAAWmxC,SAAWx4C,EAAOw4C,SAChChmD,KAIfssG,qBAAsB,SAAUtoF,GAC5B,IAAI9hB,EAAOC,KACPyqG,EAAmB1qG,EAAKopG,kBAAkBtnF,UAAUve,KAAK,oCAAoCrB,QAAQoD,OACrGqlG,EAAc,iFACdC,EAAYxtG,EAAEm2E,WAAWo3B,GAAezpG,KAAM,gBAAiBkR,KAAMtF,OAAOC,aAAaC,YAAY,mCAAoC7I,SAASumG,GAClJG,EAAYztG,EAAEm2E,WAAWo3B,GAAezpG,KAAM,gBAAiBkR,KAAMtF,OAAOC,aAAaC,YAAY,2CAA4C7I,SAASumG,GAC1JI,EAAS1tG,EAAEm2E,WAAWo3B,GAAezpG,KAAM,aAAckR,KAAMtF,OAAOC,aAAaC,YAAY,gCAAiC7I,SAASumG,GACzIK,EAAY3tG,EAAEm2E,WAAWo3B,GAAezpG,KAAM,gBAAiBkR,KAAMtF,OAAOC,aAAaC,YAAY,mCAAoC7I,SAASumG,GAEtJ5oF,EAAU5hB,QAAQ+E,KAAK,QAAS,SAAUiJ,GAEc,SAAhDlO,EAAKspG,wBAAwB3kG,IAAI,aACjCuJ,EAAE4lC,iBACFk3D,OAIR,IAAIA,EAAiB,WAEjB,IAAI9rG,IAEIo3E,QAAW,EACXjrE,OAAU,SACVgrE,QAAWvpE,OAAOC,aAAaC,YAAY,iCAC3Cd,SAAY,WAGR,OADAlM,EAAKoiF,aAAaG,QAAU,EACrBviF,EAAKopG,kBAAkBjnB,cAAcniF,EAAKoiF,iBAIrD9L,QAAW,EACXjrE,OAAU,SACVgrE,QAAW,SACXnqE,SAAY,WACRlM,EAAK4oG,mBAAmBr2C,SACxBzwC,EAAUlU,aAId0oE,QAAW,EACXjrE,OAAU,MACVgrE,QAAWvpE,OAAOC,aAAaC,YAAY,8BAC3Cd,SAAY,WACR,IAAIZ,GACAw6B,OAAU9lC,EAAK2oG,iBAAiB7iE,OAChCge,SAAY9jD,EAAK2S,WAAWmxC,SAC5B1J,YAAep6C,EAAK2S,WAAWynC,YAC/BiK,YAAerkD,EAAK2S,WAAW0xC,aAGnCrkD,EAAKwpG,cAAcl+F,MAK/BtL,EAAKspG,wBAAwBhkG,OAC7BtF,EAAKqpG,qBAAqBjkG,OAG1BhI,EAAE0tG,GAAQ9sD,OAAOh+C,EAAKoiF,aAAa6oB,UACnCL,EAAUtlG,OACVulG,EAAUzlG,OAENpF,EAAKoiF,aAAa6oB,UAClB/rG,EAAQm/C,MAGZr+C,EAAKylD,KAAKvmD,QAAUA,SACbc,EAAKylD,KAAK9yC,WAAWu4F,QAC5BppF,EAAU2gD,qBAAqBziE,EAAKylD,OA0DxCmlD,EAAU3lG,KAAK,QAAS,WAEpBjF,EAAKoiF,aAAaG,QAAU,EAC5BviF,EAAKopG,kBAAkBjnB,cAAcniF,EAAKoiF,gBAG9C0oB,EAAO7lG,KAAK,QAAS,WACjB,IAAIqG,GACAw6B,OAAU9lC,EAAK2oG,iBAAiB7iE,OAChCge,SAAY9jD,EAAK2S,WAAWmxC,SAC5B1J,YAAep6C,EAAK2S,WAAWynC,YAC/BiK,YAAerkD,EAAK2S,WAAW0xC,aAGnCrkD,EAAKwpG,cAAcl+F,KAGvBy/F,EAAU9lG,KAAK,QAAS,WACpBjF,EAAK4oG,mBAAmBr2C,SACxBzwC,EAAUlU,YAGdi9F,EAAU5lG,KAAK,QAAS,WACpBjF,EAAK4oG,mBAAmBx4F,QAAQ0R,EAAU5hB,QAAQqD,KAAK,kDAAkDzF,KAAK,iBAC9GgkB,EAAUlU,YAGd5N,EAAKopG,kBAAkBnkG,KAAK,sBAAuB,WAlF9B,IAGb/F,EAiFuD,OAAvDc,EAAKopG,kBAAkBb,YAAY51F,WAAW7U,OAC7CyO,OAAOyU,cAAchhB,EAAKopG,kBAAkBb,YAAY51F,WAAW7U,KAAKwE,OACzEtC,EAAKopG,kBAAkBb,YAAY51F,WAAW7U,KAAKwE,KAAK6C,OAAS,GAnFjEjG,IAEIo3E,QAAW,EACXjrE,OAAU,SACVgrE,QAAWvpE,OAAOC,aAAaC,YAAY,yCAC3Cd,SAAY,WACRlM,EAAK4oG,mBAAmBx4F,QAAQ0R,EAAU5hB,QAAQqD,KAAK,kDAAkDzF,KAAK,iBAC9GgkB,EAAUlU,aAId0oE,QAAW,EACXjrE,OAAU,SACVgrE,QAAW,SACXnqE,SAAY,WACR8+F,OAIJ10B,QAAW,EACXjrE,OAAU,MACVgrE,QAAWvpE,OAAOC,aAAaC,YAAY,8BAC3Cd,SAAY,WACR,IAAIZ,GACAw6B,OAAU9lC,EAAK2oG,iBAAiB7iE,OAChCge,SAAY9jD,EAAK2S,WAAWmxC,SAC5B1J,YAAep6C,EAAK2S,WAAWynC,YAC/BiK,YAAerkD,EAAK2S,WAAW0xC,aAGnCrkD,EAAKwpG,cAAcl+F,MAK/BtL,EAAKspG,wBAAwBlkG,OAC7BpF,EAAKqpG,qBAAqB/jG,OAG1BlI,EAAE0tG,GAAQ9sD,OAAOh+C,EAAKoiF,aAAa6oB,UACnCL,EAAUxlG,OACVylG,EAAUvlG,OAENtF,EAAKoiF,aAAa6oB,UAClB/rG,EAAQm/C,MAGZr+C,EAAKylD,KAAKvmD,QAAUA,EACpBc,EAAKylD,KAAK9yC,WAAWu4F,SAAU,EAC/BppF,EAAU2gD,qBAAqBziE,EAAKylD,OAuChCulD,MAIRA,KAGJG,qBAAsB,SAAS7/F,GAC3B,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY1kB,EAAEkO,EAAO/N,GAAK,yBAC1B6/B,EAAShgC,EAAEkO,EAAO/N,GAAK,yBACvB6tG,EAAYhuG,EAAEkO,EAAO/N,GAAI,QAE7ByC,EAAKqrG,cAAgB//F,EAAO+/F,cAE5BrrG,EAAK0pG,eACD5nF,UAAWA,EACXsb,OAAQA,EACRguE,UAAWA,EACX7/C,gBAAiB54C,EAAW44C,gBAC5BC,WAAY74C,EAAW64C,WACvBy/C,UAAU,GAGdjrG,EAAKmzE,eACDrvB,SAAYnxC,EAAWmxC,SACvBE,cAAiB,UACjBD,aAAgBpxC,EAAWoxC,aAC3BM,YAAe1xC,EAAW0xC,YAC1BinD,WAAa,EACbhnD,YAAe,WAChBl8C,KAAK,WACJ,GAAIpI,EAAKylD,KAAKm0B,eAAgB,CAC1B,IAAI97E,KACJV,EAAE2V,kBAAmB,EAErB/S,EAAKylD,KAAKyhB,oBAAoBppE,GAC9BA,EAAKumD,YAAcrkD,EAAKylD,KAAKpB,YAC7B,IAAI3gC,EAAQtmB,EAAE4S,WAEV1E,GACAD,OAAQ,OACRvN,KAAMA,EACNumD,YAAavmD,EAAKumD,YAClBE,WAAYvkD,EAAKylD,KAAK9yC,WAAW0+C,OACjChL,YAAa,UAIboL,KAEJzxD,EAAKylD,KAAKq0B,6BAA6BroB,GAGvCr0D,EAAE2V,kBAAmB,EAEhBjG,OAAOY,KAAKkU,WAAW6vC,GAuCxB3kD,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,uCAtCtDhN,EAAKurG,KAAKhgE,SAAS,UACnBnuC,EAAEqM,KAAKzJ,EAAKgjE,YAAY7c,WAAW76C,IAASlD,KAAK,SAASm9C,GAWtD,IAAK,IAAIxkD,KAAK0wD,EAAU,CACpB,IAAIu4C,GAXclpF,EAWS/f,OAVvB09C,EAEiB,iBAFjBA,EAASz+C,EAAKopG,kBAAkB30C,UAAU3zC,KAEF,OAAX29B,GACpBk9C,OAAS,EAAMh/E,IAAO8hC,IAG1Bk9C,OAAS,EAAOh/E,SAKzB,GAAIqtF,EAAQrO,MAAO,CACf,IAAI93F,EAAQ/F,EAAKiD,GACjBipG,EAAQrtF,IAAIq1B,SAASnuC,GACrBmmG,EAAQrtF,IAAIqkD,gBAAgBn9D,GAE+B,OAAvD7D,EAAKopG,kBAAkBb,YAAY51F,WAAW7U,OAC7CyO,OAAOyU,cAAchhB,EAAKopG,kBAAkBb,YAAY51F,WAAW7U,KAAKwE,OACzEtC,EAAKopG,kBAAkBb,YAAY51F,WAAW7U,KAAKwE,KAAK6C,OAAS,IACjEnF,EAAKspG,wBAAwBhkG,OAC7BtF,EAAKopG,kBAAkBtnF,UAAUve,KAAK,kBAAkB+B,OACxDtF,EAAKopG,kBAAkBtnF,UAAUve,KAAK,kBAAkB6B,OACxDpF,EAAKqpG,qBAAqBjkG,SAvBtC,IAAsB0b,EACd29B,IA0BTpuC,KAAK,SAASivF,EAAOp1F,EAAMyM,GACb,gBAATzM,EACAwZ,EAAMtT,SAAUlG,KAAM,QAASyM,QAASA,EAAQA,UAEhD+M,EAAM6uC,OAAOjkD,iBAQ9B+B,KAAK,WACJrQ,EAAKurG,KAAKhgE,SAAS,YAGvBvrC,EAAKurG,KAAKhgE,SAASjgC,EAAO/N,KAG9BusG,uBAAwB,SAASjtE,GAC7B,IAGI2uE,EAAqBj/F,OAAOkqD,KAAKr5D,EAAE,sBAAuB,SAAS8Z,EAAGnW,GACtE,MAA+B,SAAvB3D,EAAE8Z,GAAGvS,IAAI,aAGjB6mG,EAAmBrmG,OAAS,IACd,QAAV03B,EACAz/B,EAAEouG,GAAoB7mG,IAAI,UAAW,GAErCvH,EAAEouG,GAAoB7mG,IAAI,UAAW,WC7wBrDvH,EAAEklD,MAAM57C,OAAO,4CAIX+Q,KAAM,SAASurD,EAAaD,EAAe0oC,GAC5BxrG,KAGN+iE,YAAcA,EAHR/iE,KAIN8iE,cAAgBA,EAJV9iE,KAKNwrG,gBAAkBA,MALZxrG,KAQNyrG,eARMzrG,KAQgBwrG,gBAAgBlpC,WAAWumC,uBAAwB5qG,MARnE+B,KAQ+EwrG,gBAAgBvtG,QAR/F+B,KASN0rG,yBAMTA,sBAAuB,aAMvBC,OAAQ,WACO3rG,KACNyrG,eAAe99F,WAQxB6wC,OAAQ,SAASnzC,GACFrL,KAEN4rG,gBAAgBvgG,IAKzBugG,gBAAiB,SAASvgG,GAEtB,IAAItL,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SA8JlB,OA3JA5S,EAAEqM,KAAKzJ,EAAKgjE,YAAYjT,aAAazkD,IAASwY,KAAK,SAAShmB,IAGhC,IAApBwN,EAAO05C,WACPlnD,EAAK2nD,KAAK9yC,WAAWqyC,UAAW,GAIpC,IAAI8mD,EAAYh/F,OAAO23D,UAAUhf,KAAK/+C,QAClCqhB,WAAY,WACR,GAAI/nB,EAAKylD,OACLxlD,KAAK+B,aAEDhC,EAAKylD,KAAKm0B,gBAAgB,CAE1B,IAAI97E,KACJkC,EAAKylD,KAAKyhB,oBAAoBppE,GAE9BA,EAAKumD,YAAcrkD,EAAKylD,KAAK8d,eAEzBvjE,EAAKyrG,gBAAgBM,OACrB3uG,EAAEqM,KAAKzJ,EAAKyrG,gBAAgBM,OAAOjuG,IAC9BsK,KAAK,SAASJ,GACI,OAAXA,IAA8B,IAAXA,GAAmC,YAAhBA,EAAOkC,MAC7CwZ,EAAMtT,UACNpQ,EAAK4rG,UACkB,uBAAhB5jG,EAAOkC,MAEdlK,EAAKylD,KAAK82B,qBAAqBv0E,EAAOg0E,UAEtC5+E,EAAE0D,KAAKhD,EAAM,SAASkD,GAClB,IAAI80D,EAAU91D,EAAKylD,KAAKsQ,WAAW/0D,GACnC5D,EAAE0D,KAAKg1D,EAAS,SAAS/0D,EAAG09C,GACxBA,EAAOwxB,2BAGQ,UAAhBjoE,EAAOkC,MAEdlK,EAAKylD,KAAK+2B,gBAAgBx0E,EAAO2O,YAK7C+M,EAAMtT,UACNpQ,EAAK4rG,cAOrBI,EAAkB5uG,EAAEsJ,QAChBwD,KAAM,OACNpM,KAAMA,EAAK2nD,KACX8c,WAAYviE,EAAKyrG,gBAAgBlpC,WACjCukC,eAAgB9mG,EAAK0rG,iBAGrB3oC,cAAe/iE,EAAK+iE,cACpBC,YAAahjE,EAAK+iE,cAAcC,cAyDxC,OAvDAhjE,EAAKylD,KAAO,IAAIqmD,EAAUE,GAE1BhsG,EAAKylD,KAAKxgD,KAAK,UAAW,SAASs3D,EAAGwtC,GAClCA,EAAgB3sG,EAAEsJ,QACd+1E,aAAcz8E,EAAKylD,KAAKi3B,kBACxBl4B,WAAW,GACZl5C,EAAQy+F,GAAiBplD,aAAc3kD,EAAKylD,KAAK9yC,WAAWgyC,eAE/D3kD,EAAK6rG,gBAAgB9B,KAIzB/pG,EAAKylD,KAAKvmD,SACN9B,EAAEsJ,OACE1G,EAAKylD,KAAKvmD,QAAQ,QAEdm3E,QAAWr2E,EAAKyrG,gBAAgBQ,gBAChC3sG,SAAY,aAAc,WAC1B6mD,YAAc,EACd/jD,SAAW,EACXk0E,QAAW,EACXjrE,OAAU,OACVqrE,MAAQ,EACRrkE,MAAS,KAITnG,SAAU,WAENlM,EAAKylD,KAAK19B,gBAGtB3qB,EAAEsJ,OACE1G,EAAKylD,KAAKvmD,QAAQ,QAEdm3E,QAAWvpE,OAAOC,aAAaC,YAAY,gCAC3C1N,SAAY,aAAc,WAC1B6mD,YAAc,EACd/jD,SAAW,EACXk0E,QAAW,EACXjrE,OAAU,OACVqrE,MAAQ,EACRrkE,MAAS,KAITnG,SAAU,WACFlM,EAAKyrG,gBAAgB1hF,UACrB/pB,EAAKyrG,gBAAgB1hF,WAEzB/pB,EAAK4rG,aAKd5rG,EAAKylD,KAAKhH,WAClBr2C,KAAK,SAASlI,GACb,IAAI+rG,EAAmBjsG,EAAKyrG,gBAAgBQ,gBAAkBjsG,EAAKyrG,gBAAgBQ,gBAAkBn/F,OAAOC,aAAaC,YAAY,+BACjIk/F,EAAoBp/F,OAAOC,aAAaC,YAAY,iCAExDhN,EAAK0rG,eAAexrG,QAAQsD,KAAKtD,GAE5BoL,EAAOk5C,WACRxkD,EAAKyrG,gBAAgBlpC,WAAWh3B,SAASvrC,EAAK0rG,eAAenuG,IAGjEH,EAAE,kCAAmC4C,EAAKylD,KAAK3jC,WAAWriB,SAE1DrC,EAAE,8BAA+B4C,EAAKylD,KAAK3jC,WACtCjgB,OAAO,iFACJoqG,EAAkB,UAAUr4D,SAAS,mBAAoB,QAAS,WAClE5zC,EAAKylD,KAAK19B,eAGlB3qB,EAAE,8BAA+B4C,EAAKylD,KAAK3jC,WACtCjgB,OAAO,iFACJqqG,EAAoB,UAAUt4D,SAAS,mBAAoB,QAAS,WACpE5zC,EAAKyrG,gBAAgB1hF,UAAY/pB,EAAKyrG,gBAAgB1hF,WACtD/pB,EAAK4rG,WAKb5rG,EAAKylD,KAAKsU,eAAe,mBAC1B1pD,KAAK,SAASw3C,EAAKwc,EAAW1tD,GAE7B,IAAIqyF,EAAgBhpG,EAAK+iE,cAAckmC,kBAAkB,cACrDkD,EAAgBx1F,EAAQA,SAAW,QAEvCvZ,EAAEm2E,WAAWy1B,GAAiBryF,QAASw1F,IAAiBhoG,SAASnE,EAAK0rG,eAAexrG,SAErFF,EAAKyrG,gBAAgBlpC,WAAWh3B,SAASvrC,EAAK0rG,eAAenuG,MAG1DmmB,EAAMlb,aC/MrBpL,EAAEklD,MAAM57C,OAAO,6CACX+Q,KAAM,SAASurD,EAAaD,EAAe0oC,GAC5BxrG,KAGN+iE,YAAcA,EAHR/iE,KAIN8iE,cAAgBA,EAJV9iE,KAKNwrG,gBAAkBA,MALZxrG,KAQNyrG,eARMzrG,KAQgBwrG,gBAAgBlpC,WAAWumC,uBAAwB5qG,MARnE+B,KAQ+EwrG,gBAAgBvtG,QAR/F+B,KASN0rG,yBAMTC,OAAQ,WACJ3rG,KAAKyrG,eAAe99F,WAMxB+9F,sBAAuB,aAQvBltD,OAAQ,SAASnzC,GACbrL,KAAK4rG,gBAAgBvgG,IAKzBugG,gBAAiB,SAASvgG,GACtB,IAAItL,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SAqJlB,OAlJA5S,EAAEqM,KAAKzJ,EAAKgjE,YAAYvf,YAAYn4C,IAC/B4E,KAAK,SAASpS,IAGa,IAApBwN,EAAO05C,WACPlnD,EAAK2nD,KAAK9yC,WAAWqyC,UAAW,GAIpC,IAAI8mD,EAAYh/F,OAAO23D,UAAUhf,KAAK/+C,QAClCqhB,WAAY,SAASzZ,WACjB,GAAItO,EAAKylD,OACLxlD,KAAK+B,aAEDhC,EAAKylD,KAAKm0B,gBAAgB,CAE1B,IAAI97E,KACJkC,EAAKylD,KAAKyhB,oBAAoBppE,GAE9BA,EAAKumD,YAAcrkD,EAAKylD,KAAK8d,eAEzBvjE,EAAKyrG,gBAAgBM,OACrB3uG,EAAEqM,KAAKzJ,EAAKyrG,gBAAgBM,OAAOjuG,IAC9BsK,KAAK,SAASJ,GACI,OAAXA,IAA8B,IAAXA,GAAmC,YAAhBA,EAAOkC,MAC7CwZ,EAAMtT,UACNpQ,EAAK4rG,UACkB,uBAAhB5jG,EAAOkC,MAEdlK,EAAKylD,KAAK82B,qBAAqBv0E,EAAOg0E,UAEtC5+E,EAAE0D,KAAKhD,EAAM,SAASkD,EAAK6C,GACvB,IAAIiyD,EAAU91D,EAAKylD,KAAKsQ,WAAW/0D,GACnC5D,EAAE0D,KAAKg1D,EAAS,SAAS/0D,EAAG09C,GACxBA,EAAOwxB,2BAGQ,UAAhBjoE,EAAOkC,MAEdlK,EAAKylD,KAAK+2B,gBAAgBx0E,EAAO2O,YAK7C+M,EAAMtT,UACNpQ,EAAK4rG,cAMrBI,EAAkB5uG,EAAEsJ,QACpBwD,KAAM,OACNpM,KAAMA,EAAK2nD,KACX8c,WAAYviE,EAAKyrG,gBAAgBlpC,WACjCukC,eAAgB9mG,EAAK0rG,iBAErB3oC,cAAe/iE,EAAK+iE,cACpBC,YAAahjE,EAAK+iE,cAAcC,cAgDpC,OA9CAhjE,EAAKylD,KAAO,IAAIqmD,EAAUE,GAE1BhsG,EAAKylD,KAAKvmD,SACN9B,EAAEsJ,OACE1G,EAAKylD,KAAKvmD,QAAQ,QAEdm3E,QAAWvpE,OAAOC,aAAaC,YAAY,+BAC3C1N,SAAY,aAAc,WAC1B6mD,YAAc,EACd/jD,SAAW,EACXk0E,QAAW,EACXjrE,OAAU,OACVqrE,MAAQ,EACRrkE,MAAS,KAITnG,SAAU,WAENlM,EAAKylD,KAAK19B,gBAGtB3qB,EAAEsJ,OACE1G,EAAKylD,KAAKvmD,QAAQ,QAEdm3E,QAAWvpE,OAAOC,aAAaC,YAAY,gCAC3C1N,SAAY,aAAc,WAC1B6mD,YAAc,EACd/jD,SAAW,EACXk0E,QAAW,EACXjrE,OAAU,OACVqrE,MAAQ,EACRrkE,MAAS,KAITnG,SAAU,WACFlM,EAAKyrG,gBAAgB1hF,UACrB/pB,EAAKyrG,gBAAgB1hF,WAEzB/pB,EAAK4rG,aAMd5rG,EAAKylD,KAAKhH,WAClBr2C,KAAK,SAASlI,GACjB,IAAI+rG,EAAmBjsG,EAAKyrG,gBAAgBQ,gBAAkBjsG,EAAKyrG,gBAAgBQ,gBAC7En/F,OAAOC,aAAaC,YAAY,+BAClCk/F,EAAoBp/F,OAAOC,aAAaC,YAAY,iCAGxDhN,EAAK0rG,eAAexrG,QAAQsD,KAAKtD,GAEjCF,EAAKyrG,gBAAgBlpC,WAAWh3B,SAASvrC,EAAK0rG,eAAenuG,IAE7DH,EAAE,kCAAmC4C,EAAKylD,KAAK3jC,WAAWriB,SAC1DrC,EAAE,8BAA+B4C,EAAKylD,KAAK3jC,WACtCjgB,OAAO,iFACJoqG,EAAkB,UAAUr4D,SAAS,mBAAsB,QAAS,WACxE5zC,EAAKylD,KAAK19B,eAEd3qB,EAAE,8BAA+B4C,EAAKylD,KAAK3jC,WACtCjgB,OAAO,iFACJqqG,EAAoB,UAAUt4D,SAAS,mBAAsB,QAAS,WAC1E5zC,EAAKyrG,gBAAgB1hF,UAAY/pB,EAAKyrG,gBAAgB1hF,WACtD/pB,EAAK4rG,WAIT5rG,EAAKylD,KAAKsU,eAAe,iBAEzB/5D,EAAKylD,KAAKxgD,KAAK,UAAW,WACtBjF,EAAK6rG,gBAAgBvgG,OAE1B+E,KAAK,SAASsG,GAEb,IAAIqyF,EAAgBhpG,EAAK+iE,cAAckmC,kBAAkB,cACrDkD,EAAgBx1F,EAAQA,SAAW,QAEvCvZ,EAAEm2E,WAAWy1B,GAAiBryF,QAASw1F,IAAiBhoG,SAASnE,EAAK0rG,eAAexrG,SAErFF,EAAKyrG,gBAAgBlpC,WAAWh3B,SAASvrC,EAAK0rG,eAAenuG,MAG1DmmB,EAAMlb,aC7LrBsE,OAAO23D,UAAU2nC,eAAe1lG,OAAO,sCAInCqsE,iBAAkB,WACd,IAEIz0E,EAFA0B,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElB+uD,EAAM,IAAItkE,EAAE4S,SA+DhB,OA7DAhQ,EAAKV,WACLU,EAAKqsG,2BACLrsG,EAAKyB,eAGLrE,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAc8M,WAAWrwD,EAAK6jF,2BACjD//D,KAAK,SAAUyhC,GAKZ,OAJAA,EAAWvlD,EAAKwlF,2BAA2BjgC,GAC3CvlD,EAAKV,QAAUimD,EACfvlD,EAAKwjF,gBAAgBpzE,QAAQm1C,GAEzB5yC,EAAWwxE,aACoB,QAA3BxxE,EAAWyxE,aACJpkF,EAAKgjE,YAAYzf,cAAcqD,gBAAgB5mD,EAAKgkF,kCACtDlgE,KAAK,SAAUwoF,GACZ,OAAOtsG,EAAKyjF,OAAOhlC,OAAOrhD,EAAEsJ,OAAO4lG,GAC/B18C,kBAA+C,YAA5Bj9C,EAAWyxE,aAC9Bt9B,UAAW9mD,EAAK2S,WAAWm0C,YAC3B1pD,EAAEsJ,UAAW1G,EAAKgkF,kCAAmCpjD,WAAY5gC,EAAKm9F,cAAcn9F,EAAK2gC,yBAC9F7c,KAAK,SAAUo5D,GACd5+E,EAAW0B,EAAK+iE,cAAcvT,YAAY,oCAC1C,IAAIhsD,EAAOpG,EAAEA,EAAEy8C,UAAUv7C,GACrBgB,QAASU,EAAKV,QACdhB,UAAU,KAId,OADAlB,EAAE,sBAAuBoG,EAAK+oG,KAAK,SAASlvE,UAAUx7B,OAAOq7E,GACtD15E,KAGflF,EAAW0B,EAAK+iE,cAAcvT,YAAY,oCACnCpyD,EAAEy8C,UAAUv7C,GACfgB,QAASU,EAAKV,YAItBhB,EAAW0B,EAAK+iE,cAAcvT,YAAY,kCACnCpyD,EAAEy8C,UAAUv7C,GACfgB,QAASU,EAAKV,QACdymD,YAAapzC,EAAWozC,YACxBg+B,SAAUpxE,EAAWoxE,cAI9B37E,KAAK,SAAU5E,GACd,IAAIkP,EAAU1S,EAAK2rE,aACf6gC,EAAmBpvG,EAAE,wCAAyCsV,GAElE1S,EAAKgC,aAELwqG,EAAiB3qG,OAAO2B,GACxBxD,EAAKqmE,oBAELrmE,EAAKysG,4BAEL/qC,EAAItxD,QAAQo8F,KACbn8F,KAAK,SAAUurB,GACd57B,EAAKgC,aACL0/D,EAAIrxD,KAAKurB,KAGV8lC,EAAIl5D,WAMf20F,cAAe,SAAU13C,GACrB,OAAIA,EAAKpoB,OACEp9B,KAAKk9F,cAAc13C,EAAKpoB,OAAOsD,oBAG/B8kB,EAAK5kB,aASpB0rC,SAAU,WACN,IAAI1oE,EAAQ5D,KAAK2S,WACjB,OAAO,MAAO/O,GAA2CA,EAAMsB,OAAS,GAM5EkhE,kBAAmB,WACf,IAAIrmE,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACUvuE,EAAE,2BAA4BsV,GAGpChG,GAAG,QAAS,WAC/B,IAAIw8B,EAAOlpC,EAAKV,QAAQoF,SAAStH,EAAE6C,MAAMnC,KAAK,WAC1CuN,GACAs5E,YAAaz7C,EAAK,GAClB6lC,WAAY7lC,EAAK,GACjBkR,YAAalR,EAAK,GAClBud,WAAYvd,EAAK,GACjB6a,kBAAiC,IAAZ7a,EAAK,IAAkC,SAAZA,EAAK,GACrD0b,aAAc1b,EAAK,KAAM,EACzBqb,WAAYvkD,EAAK2S,WAAW4xC,WAC5BsE,aAAc7oD,EAAK2S,WAAWk2C,cAAgB,IAGlD7oD,EAAKoL,cAAcC,KAIvB,IADA,IAAI/L,KACKyB,EAAI,EAAGoE,EAASnF,EAAKV,QAAQ6F,OAAQpE,EAAIoE,EAAQpE,IACtDzB,EAAQuJ,MACJ8iC,KAAM3rC,EAAKV,QAAQyB,GAAG,GACtBq5C,YAAap6C,EAAKV,QAAQyB,GAAG,KAMrC3D,EAAE,kBAAmBsV,GAASynC,aAC1B76C,QAASA,EACTs7C,cAAe,SAAUvvC,GACrB,IAAI69B,EAAOlpC,EAAKV,QAAQiE,KAAK,SAAUrD,GACnC,OAAOA,EAAQ,IAAMmL,EAAOsgC,OAGhC3rC,EAAKoL,eACDu5E,YAAaz7C,EAAK,GAClB6lC,WAAY7lC,EAAK,GACjBkR,YAAalR,EAAK,GAClBud,WAAYvd,EAAK,GACjB6a,kBAAiC,IAAZ7a,EAAK,IAAkC,SAAZA,EAAK,GACrD0b,aAAc1b,EAAK,KAAM,EACzB2f,aAAc7oD,EAAK2S,WAAWk2C,cAAgB,QAM1DzrD,EAAEsvG,KAAK,KAAKC,aAAe,SAAUt7C,EAAQtwD,EAAGw9B,GAC5C,IAAIwS,EAASxS,EAAM,GACnB,QAAKwS,GAGE,IAAIriC,OAAOqiC,EAAQ,KAAK5+B,KAAK/U,EAAEi0D,GAAQj/C,SAElDhV,EAAE,sDAAuDsV,GAAS6mC,MAAM,WACpE,IAAIxI,EAAS3zC,EAAE6C,MAAMoP,MACrBjS,EAAE,2BAA4BsV,GAASpN,OACnCyrC,GACA3zC,EAAE,2BAA4BsV,GACzBmf,IAAI,iBAAmBkf,EAAS,KAAK3rC,UAOtDqnG,0BAA2B,WACvB,IAAIzsG,EAAOC,KAGXD,EAAKyjF,OAAOmpB,UAAU,uBAAwB,SAAU9vC,EAAIxxD,GACxDA,EAAOuhG,WACP7sG,EAAKi4D,qBAAqB,iBAAkB3sD,MAOpDF,cAAe,SAAUC,GACrB,IAAIrL,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACfh5D,EAAa3S,EAAK2S,gBAC0C,IAAhCA,EAAWm6F,mBAA2Cn6F,EAAWm6F,kBAIpE,QAArBzhG,EAAOo7C,YAAwBzmD,EAAKulF,iBAAiBl6E,IAAW,IAAMA,EAAO04C,aAE7E3mD,EAAE,+CAAiDiO,EAAO0jE,WAAa,WAAYr8D,GAASgX,QAE5FtsB,EAAEqM,KAAKzJ,EAAK0kF,cAAcr5E,IAASjD,KAAK,SAAU2kG,GAC9C/sG,EAAKgtG,cAAcD,KAGpB/sG,EAAK4S,WAAWzN,OAAS,EAChCnF,EAAKitG,uBAAuB5hG,GAE5BjO,EAAEqM,KAAKzJ,EAAK0kF,cAAcr5E,IAASjD,KAAK,SAAU2kG,GAC9C/sG,EAAKgtG,cAAcD,MAU/BxoB,gBAAiB,SAAUzmF,EAAMuN,GAGR,WAAjBvN,EAAKynD,SACLnoD,EAAEoqG,SAASjoG,KACPkoG,WAAY,UACZvpG,MAAOmN,EAAO+uC,YACdhoC,KANGnS,KAMQ+M,YAAY,6CAA6CpI,QAAQ,KAAMyG,EAAO+uC,aACzFstD,QAAQ,IAGZtqG,EAAEoqG,SAASjoG,KACPkoG,WAAY,QACZvpG,MAAOmN,EAAO+uC,YACdhoC,KAbGnS,KAaQ+M,YAAY,4CAA4CpI,QAAQ,KAAMyG,EAAO+uC,aACxFstD,QAAQ,KASpB5iB,kBAAmB,SAAUz5E,GACzB,IAAIrL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBiuB,EAAa5gC,EAAK6gC,YAElB6jB,EAAmB1kD,EAAK2S,WAAWsyE,gBAAgBtsE,KAAK,KACxDorC,EAAgB14C,EAAmB,aAAIrL,EAAK2S,WAAWk2C,aAAe,IAAMx9C,EAAO04C,aAAe/jD,EAAK2S,WAAWk2C,aAClH6Y,EAAM,IAAItkE,EAAE4S,SAGZk5F,EAAY,IAAIp8F,OAAO23D,UAAU32D,WAAWo/F,MAAMznD,KAAKzlD,EAAKgjE,YAAahjE,EAAK+iE,eAC9E7kE,MAAOyU,EAAW4nC,aAAeztC,OAAOC,aAAaC,YAAY,4BACjEu1D,WAAY3hC,EAAW2hC,WACvB4qC,gBAAgB,EAChBjB,kBAAmBp/F,OAAOC,aAAaC,YAAY,gCACnD++F,OAAQ,SAAUjuG,GAEd,OAAOkC,EAAKgjE,YAAYzf,cAAc4C,YAClC96C,OAAQ,OACRvN,KAAMA,EACNimD,aAAcmlD,EAAUzjD,KAAK9yC,WAAWoxC,aACxCM,YAAavmD,EAAKumD,YAClBjmB,eAAe,EACfqmB,mBAAmB,IACpBr8C,KAAK,SAAUglG,GACT/hG,EAAOgiG,UAA8C,IAAlCrtG,EAAKulF,iBAAiBl6E,KAC1CA,EAAOs5C,aAAeyoD,EAAUrvB,SAEpCrc,EAAItxD,QAAQg9F,EAAUrvB,YAG9Bh0D,SAAU,SAAUjsB,OAKpBwvG,GACA3pD,OAAUt4C,EAAOs5E,YACjBrgC,YAAe,QACfxe,OAAU9lC,EAAK2S,WAAWmwF,OAC1B3+C,WAA+B,eAAjBnkD,EAAK07D,SAA4B96B,EAAWujB,gBAAah8C,EACvEu8C,iBAAoBA,EACpBX,aAAgBA,EAChBY,aAAgBt5C,EAAOs5C,aACvBd,aAAgB7jD,EAAK2S,WAAWs9C,cAChCrL,aAAgBv5C,EAAOu5C,aACvBE,YAAez5C,EAAOy5C,aAY1B,MAT0B,SAAtBz5C,EAAOo7C,aACP6mD,EAAahpD,YAAc,iBAC3BgpD,EAAavpD,kBAAe57C,EAC5BmlG,EAAa/oD,WAAal5C,EAAOk5C,WACjC+oD,EAAaC,oBAAqB,GAGtCrE,EAAUzqD,OAAO6uD,GAEV5rC,EAAIl5D,WAOfq8E,4BAA6B,SAAUx5E,GACnC,IAAIrL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB8yC,EAAOzlD,EAAK2gC,mBACZ+jB,EAAmB1kD,EAAK2S,WAAWsyE,gBAAgBtsE,KAAK,KACxD+oD,EAAM,IAAItkE,EAAE4S,SACZ+zC,EAAgB14C,EAAmB,aAAIrL,EAAK2S,WAAWk2C,aAAe,IAAMx9C,EAAO04C,aAAe/jD,EAAK2S,WAAWk2C,aAGlH2kD,EAAwC,KAAjBzpD,EAAuBh1C,OAF/B,YAEoDg1C,EAAc14C,EAAOu4C,UAAYG,EACpG0pD,EAA2C,KAAjB1pD,EAAuBh1C,OAFxB,OAEuDg1C,GAAgBA,EAChGnjB,EAAa6kB,EAAK5kB,YAoDtB,OAlDgB,IAAI/zB,OAAO23D,UAAU32D,WAAWo/F,MAAMznD,KAAKzlD,EAAKgjE,YAAahjE,EAAK+iE,eAC9E7kE,MAAOyU,EAAW4nC,aAAeztC,OAAOC,aAAaC,YAAY,4BACjEu1D,WAAY3hC,EAAW2hC,WACvB4qC,gBAAgB,EAChBjB,kBAAmBp/F,OAAOC,aAAaC,YAAY,gCACnD++F,OAAQ,SAAUjuG,GACd,OAAIuN,EAAOgiG,SACArtG,EAAKgjE,YAAYzf,cAAc4C,YAClC96C,OAAQ,OACRvN,KAAMA,EACNimD,aAAcypD,EACdnpD,YAAavmD,EAAKumD,YAClBjmB,eAAe,EACfqmB,mBAAmB,IACpBr8C,KAAK,SAAUglG,GACd1rC,EAAItxD,QAAQg9F,EAAUrvB,WAGnB/9E,EAAKgjE,YAAYrY,mBACpB7G,SAAUnxC,EAAWpV,GAErBwmD,aAAcA,EACdsC,YAAa,QACbhC,YAAavmD,EAAKumD,YAClB8B,WAAYroD,IACbsK,KAAK,SAAUglG,GACd/hG,EAAOs5C,aAAeyoD,EAAUrvB,QAChC1yE,EAAOu4C,SAAWwpD,EAAUM,SAC5B1tG,EAAK+kF,iBAAiB15E,GACtBq2D,EAAItxD,QAAQg9F,EAAUrvB,YAIlCh0D,SAAU,SAAUjsB,OAKd2gD,QACNkF,OAAUt4C,EAAOs5E,YACjBrgC,YAAe,QACfxe,OAAUlF,EAAWkF,OACrB4e,iBAAoBA,EACpBX,aAAiB14C,EAAe,SAAImiG,EAAsBC,EAC1D9oD,aAAgBt5C,EAAOs5C,aACvBd,aAAgB7jD,EAAK2S,WAAWs9C,cAChCrL,aAAgBv5C,EAAOu5C,aACvBE,YAAez5C,EAAOy5C,cAGnB4c,EAAIl5D,WAOfo8E,iBAAkB,SAAU11E,GACxB,IAAIlP,EAAOC,KACPyhE,EAAM,IAAItkE,EAAE4S,SAChBd,EAAOA,MACP,IAAI0xB,EAAa5gC,EAAK2gC,mBAAmBE,YAmCzC,OAhCgB,IAAI/zB,OAAO23D,UAAU32D,WAAW6/F,UAAU3tG,EAAKgjE,YAAahjE,EAAK+iE,eAC7E7kE,MAAOgR,EAAKhR,OAAS,GACrBqkE,WAAY3hC,EAAW2hC,WACvB0pC,gBAAmC,cAAjBjsG,EAAK07D,UAA6C,eAAjB17D,EAAK07D,SAClD5uD,OAAOC,aAAaC,YAAY,6BAChCF,OAAOC,aAAaC,YAAY,+BACtC++F,OAAQ,SAAUjuG,GAEd,OAAOkC,EAAKgjE,YAAYzf,cAAc4C,YAClC96C,OAAQ,OACRvN,KAAMA,EACNimD,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAavmD,EAAKumD,YAClBjmB,eAAe,EACfqmB,mBAAmB,IACpBr8C,KAAK,SAAUglG,GACd1rC,EAAItxD,QAAQg9F,EAAUrvB,cAKxBt/B,QACNuR,YAAa9gD,EAAK8gD,YAClBrL,aAAcz1C,EAAKy1C,aACnB7e,OAAQ9lC,EAAK2S,WAAWmwF,OACxB3+C,WAA6B,eAAjBnkD,EAAK07D,SAA4B96B,EAAWujB,gBAAah8C,EACrEu8C,iBAAkB1kD,EAAK2S,WAAWsyE,gBAAgBtsE,KAAK,KACvDs3C,cAAejwD,EAAK2S,WAAWs9C,cAC/BnL,YAAa51C,EAAK41C,YAClBoL,qBAAqB,IAGlBwR,EAAIl5D,WAMfwkG,cAAe,SAAU3hG,GACrB,IAAIrL,EAAOC,KAEX,GAAqB,cAAjBD,EAAK07D,UAA6C,eAAjB17D,EAAK07D,SAA2B,CACjE,IAAI/kD,EAAU7J,OAAOC,aAAaC,YAAY,yDAE9C5P,EAAEqM,KAAKqD,OAAO4sE,oBAAoB/iE,EAAS,SAAU,SAChDvO,KAAK,WACFpI,EAAKqkF,yBAAyBh5E,UAGtCrL,EAAK+kF,iBAAiB15E,IAS9B4hG,uBAAwB,SAAU5hG,GAC9B,IAAIrL,EAAOC,KACP0W,EAAU7J,OAAOC,aAAaC,YAAY,qDAE9C5P,EAAEqM,KAAKqD,OAAO4sE,oBAAoB/iE,EAAS,SAAU,SAChDvO,KAAK,WACFpI,EAAKgyC,aAEL50C,EAAEqM,KAAKzJ,EAAK0kF,cAAcr5E,IAASjD,KAAK,SAAU2kG,GAC9C/sG,EAAKgtG,cAAcD,QASnC/rC,gBAAiB,SAAUljE,GACvB,IAAIkC,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACfiiC,EAA4BxwG,EAAE,mDAAoDsV,GAClFpU,EAAW0B,EAAK+iE,cAAcvT,YAAY,4CAE9CxvD,EAAKqsG,2BAELjvG,EAAEqM,KAAKzJ,EAAKwjF,iBAAiBp7E,KAAK,SAAUylG,GAaxCzwG,EAAE0D,KAAKhD,EAAM,SAAUkD,EAAK6C,GACxB,IAb6BkrE,EACzBi7B,EAYAA,GAbyBj7B,EAaElrE,EAAMkrE,WAZjCi7B,KACJ5sG,EAAE0D,KAAK+sG,EAAe,SAAU7sG,EAAK6C,GAC7BA,EAAM,IAAMkrE,IACZi7B,EAAUnmG,KAIXmmG,GAMPlsG,EAAKkD,GAAKo5C,YAAc4vD,EAAQ,GAChClsG,EAAKkD,GAAK2jF,YAAcqlB,EAAQ,GAChClsG,EAAKkD,GAAKylD,WAAaujD,EAAQ,GAC/BlsG,EAAKkD,GAAK+iD,aAAeimD,EAAQ,GACjClsG,EAAKkD,GAAK4jD,aAAeolD,EAAQ,GAE7BlsG,EAAKkD,GAAKsK,QAAUxN,EAAKkD,GAAKsK,OAAOq5C,eACrC7mD,EAAKkD,GAAK2jD,aAAe7mD,EAAKkD,GAAKsK,OAAOq5C,cAE1C7mD,EAAKkD,GAAKsK,QAAUxN,EAAKkD,GAAKsK,OAAO+4C,cACrCvmD,EAAKkD,GAAKqjD,YAAcvmD,EAAKkD,GAAKsK,OAAO+4C,aAEzCvmD,EAAKkD,GAAKsK,QAAUxN,EAAKkD,GAAKsK,OAAOs4C,WACrC9lD,EAAKkD,GAAK4iD,SAAW9lD,EAAKkD,GAAKsK,OAAOs4C,YAI9CxmD,EAAEqM,KAAKrM,EAAEy8C,UAAUv7C,GAAYgB,QAASxB,KAASsK,KAAK,SAAU5E,GAC5DoqG,EAA0B1rG,QAC1B0rG,EAA0B/rG,OAAO2B,GAEjC,IAAIsqG,EAAuB1wG,EAAE,4CAA6CwwG,GACtEG,EAAqB3wG,EAAE,mCAAoCwwG,GAE/DE,EAAqBphG,GAAG,QAAS,WAC7B,IAAItL,EAAQhE,EAAE6C,MAAMo9B,SAASv/B,KAAK,SAClCkC,EAAKqlF,oBAAoBjkF,KAG7B2sG,EAAmBrhG,GAAG,QAAS,WAC3B,IAAIiuC,EAASv9C,EAAE6C,MAAMo9B,SACjBnzB,EAAOywC,EAAO78C,KAAK,cACnBkyD,EAAcrV,EAAO78C,KAAK,eAC1B6mD,EAAehK,EAAO78C,KAAK,gBAC3BI,EAAQy8C,EAAO78C,KAAK,SAEpBimD,EAAepJ,EAAO78C,KAAK,gBAC3B8mD,EAAejK,EAAO78C,KAAK,kBAAmB,EAC9C8lD,EAAWjJ,EAAO78C,KAAK,aAAe,GACtCixE,EAAap0B,EAAO78C,KAAK,cACzBgnD,EAAcf,GAAgB/jD,EAAK2S,WAAWoxC,aAClD,OAAQ75C,GACJ,IAAK,UACGy6C,GACA3kD,EAAK4kF,kBACD50B,YAAaA,EACbrL,aAAcA,EACdzmD,MAAOA,EACP6lD,aAAcA,EACde,YAAaA,IAGrB,MACJ,IAAK,OACD,IAAIz5C,GACAs5E,YAAa30B,EACbrL,aAAcA,EACd0oD,UAAU,EACVtpD,aAAcA,EACda,aAAcA,EACdhB,SAAUA,EACVkB,YAAaA,GAGjB,GAAIz5C,EAAO04C,aACP/jD,EAAK6kF,4BAA4Bx5E,OAC9B,CAEHA,EAAO04C,kBAAe57C,EAGtB,IAAI6lG,KACAC,EAAajuG,EAAK6D,MAAM+0C,OAAO,SAAU1P,GACzC,OAAOA,EAAK6lC,YAAcA,IAG1Bk/B,EAAW9oG,OAAS,IACpB6oG,GACIvnD,WAAY,OACZnC,YAAa,iBACbC,WAAYvkD,EAAK2S,WAAW4xC,YAAc0pD,EAAW,GAAG1pD,aAIhEvkD,EAAK8kF,kBAAkB1nF,EAAEsJ,OAAO2E,EAAQ2iG,aAcpE3B,yBAA0B,WACtB,IACI35F,EADOzS,KACQ0rE,aACfiiC,EAA4BxwG,EAAE,mDAAoDsV,GAClFw7F,EAAwB9wG,EAAE,2BAA4BsV,GAH/CzS,KAKF2S,WAAWzN,OAAS,GACzByoG,EAA0BtoG,OAC1B4oG,EAAsB5oG,SAEtBsoG,EAA0BxoG,OAC1B8oG,EAAsB9oG,WC3kBlC0H,OAAO23D,UAAU2nC,eAAe1lG,OAAO,sCAKnCqsE,iBAAkB,WACd,IAAI/yE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+uD,EAAM,IAAItkE,EAAE4S,SAqDhB,OAnDAhQ,EAAKV,WAELU,EAAK+zE,oBAAoB3uE,OACzBpF,EAAKqsG,2BAELrsG,EAAKyB,eAGLzB,EAAKgjE,YAAYzf,cAAcqD,gBAAgB5mD,EAAKgkF,kCAC/ClgE,KAAK,SAASwoF,GACX,OAAOtsG,EAAKyjF,OAAOhlC,OAAO6tD,EAActsG,EAAKgkF,kCACxClgE,KAAK,SAASo5D,GACX,IAAI5+E,EAAW0B,EAAK+iE,cAAcvT,YAAY,oCAC9C,GAAI78C,EAAWuxE,aACX,OAAOlkF,EAAKgjE,YAAYzf,cAAc8M,WAAWrwD,EAAK6jF,0BACjD//D,KAAK,SAASyhC,GACXvlD,EAAKwjF,gBAAgBpzE,QAAQm1C,GAC7BvlD,EAAKV,QAAUimD,EAEf,IAAI4oD,EAAe/wG,EAAEA,EAAEy8C,UAAUv7C,GAC7BgB,QAASU,EAAKV,QACdhB,UAAU,KAKd,OAFAlB,EAAE,sBAAuB+wG,EAAa5B,KAAK,SAASlvE,UAAUx7B,OAAOq7E,GAE9DixB,IAGf,IAAIA,EAAe/wG,EAAEA,EAAEy8C,UAAUv7C,GAAYA,UAAU,KAGvD,OAFAlB,EAAE,sBAAuB+wG,EAAa5B,KAAK,SAASlvE,UAAUx7B,OAAOq7E,GAE9DixB,MAIpB/lG,KAAK,SAAS5E,GACb,IAAIkP,EAAU1S,EAAK2rE,aACf6gC,EAAmBpvG,EAAE,wCAAyCsV,GAElE1S,EAAKgC,aAELwqG,EAAiB3qG,OAAO2B,GACxBxD,EAAKqmE,oBACLrmE,EAAKysG,4BAEL/qC,EAAItxD,QAAQo8F,KACbn8F,KAAK,SAASurB,GACb57B,EAAKgC,aACL0/D,EAAIrxD,KAAKurB,KAEV8lC,EAAIl5D,WAMf69D,kBAAmB,WACf,IAAIrmE,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACUvuE,EAAE,2BAA4BsV,GAKpChG,GAAG,QAAS,WAC/B,IAAIw8B,EAAOlpC,EAAKV,QAAQoF,SAAStH,EAAE6C,MAAMnC,KAAK,WAC1CuN,GACAs5E,YAAaz7C,EAAK,GAClB6lC,WAAY7lC,EAAK,GACjBkR,YAAalR,EAAK,GAClBud,WAAYvd,EAAK,GACjB6a,kBAAkC,IAAZ7a,EAAK,IAAkC,SAAZA,EAAK,GACtD2f,aAAc7oD,EAAK2S,WAAWk2C,cAAgB,IAGxB,SAAtBx9C,EAAOo7C,aACPp7C,EAAO04C,kBAAe57C,EACtBkD,EAAOi5C,YAAc,iBACrBj5C,EAAOk5C,WAAavkD,EAAK2S,WAAW4xC,YAGxCvkD,EAAKoL,cAAcC,KAIvB,IADA,IAAI/L,KACKyB,EAAI,EAAGukB,EAAMtlB,EAAKV,QAAQ6F,OAAQpE,EAAIukB,EAAKvkB,IAChDzB,EAAQuJ,MACJ8iC,KAAM3rC,EAAKV,QAAQyB,GAAG,GACtBq5C,YAAap6C,EAAKV,QAAQyB,GAAG,KAOrC3D,EAAE,kBAAmBsV,GAASynC,aAC1B76C,QAASA,EACTs7C,cAAe,SAASvvC,GACpB,IAAI69B,EAAOlpC,EAAKV,QAAQiE,KAAK,SAAS2K,GAClC,OAAOA,EAAE,IAAM7C,EAAOsgC,OAE1B3rC,EAAKoL,eACDu5E,YAAaz7C,EAAK,GAClB6lC,WAAY7lC,EAAK,GACjBkR,YAAalR,EAAK,GAClBud,WAAYvd,EAAK,GACjB6a,kBAAkC,IAAZ7a,EAAK,IAAkC,SAAZA,EAAK,SAOtEujE,0BAA2B,WACvB,IAAIzsG,EAAOC,KAIXD,EAAKyjF,OAAOmpB,UAAU,uBAAwB,SAAS9vC,EAAIxxD,GACvDA,EAAOuhG,WACPvhG,EAAO8iG,iBAAmB9iG,EAAO8iG,mBAAoB,EAErDpuG,EAAKi4D,qBAAqB,iBAAkB3sD,QCrIxDwB,OAAO23D,UAAU4pC,oBAAoB3nG,OAAO,2CAIxCqsE,iBAAkB,WACd,IAGUz0E,EAHN0B,EAAOC,KACP0S,EAAa3S,EAAK2S,WAItB,MAAY,UAHD3S,EAAK8jE,WAGS9jE,EAAK2S,WAAWs9C,eAIzCjwD,EAAKqsG,2BAKEjvG,EAAEqM,KAAKzJ,EAAKgjE,YAAYzf,cAAcqN,sBAAsB5wD,EAAK6jF,2BACnEz7E,KAAK,SAASm9C,GAEXA,EAAWvlD,EAAKgjE,YAAYnS,4BAA4BtL,GACxDvlD,EAAKsuG,aAAexhG,OAAO8K,MAAM2tC,GACjC,IAAIjmD,EAAUwN,OAAO8K,MAAM2tC,GAC3BvlD,EAAKuuG,YAAczhG,OAAO8K,MAAMtY,GAGhC,IAAIkvG,GACAlvG,QAASA,EACTymD,YAAapzC,EAAWozC,YACxB0oD,gBAAiBzuG,EAAK0uG,aAAapvG,IAEvChB,EAAW0B,EAAK+iE,cAAcvT,YAAY,4CAE1C,IAAI98C,EAAU1S,EAAK2rE,aACIvuE,EAAE,kDAAmDsV,GAC3D7Q,OAAOzE,EAAEy8C,UAAUv7C,EAAUkwG,IAC9CxuG,EAAK2uG,kBA3BF,IAqCfD,aAAc,SAAUpvG,EAASsvG,GAC7B,IAAI5uG,EAAOC,KACPipC,EAAO,OACP2lE,EAAmB7uG,EAAK+iE,cAAcvT,YAAY,iDAYtD,OAXAlwD,EAAUA,MACVsvG,EAAQA,GAAS,EAEjBxxG,EAAE0D,KAAKxB,EAAS,SAAU0B,EAAK6C,GAC3BqlC,GAAQ9rC,EAAEy8C,UAAUg1D,EAAkBhrG,GAElCA,EAAMP,WACN4lC,GAAQlpC,EAAK0uG,aAAa7qG,EAAMP,SAAUsrG,EAAQ,MAG1D1lE,GAAQ,SAOZylE,aAAc,WACV,IAAI3uG,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACUvuE,EAAE,0DAA2DsV,GAGnEhG,GAAG,QAAS,WAC/B,IAAIoiG,EAAc1xG,EAAE6C,MAAMo9B,SACtBhyB,GACAk5C,WAAYuqD,EAAYhxG,KAAK,cAC7BozD,WAAY49C,EAAYhxG,KAAK,cAC7BqzD,gBAAiB29C,EAAYhxG,KAAK,mBAClCs8C,YAAa00D,EAAYhxG,KAAK,gBAC9B2oD,WAAYqoD,EAAYhxG,KAAK,eAC7BimD,aAAc+qD,EAAYhxG,KAAK,iBAEnCkC,EAAK+uG,gBAAgB1jG,KAGzBjO,EAAEsvG,KAAK,KAAKC,aAAe,SAAUt7C,EAAQtwD,EAAGw9B,GAC5C,IAAIwS,EAASxS,EAAM,GACnB,QAAKwS,GAGE,IAAIriC,OAAOqiC,EAAQ,KAAK5+B,KAAK/U,EAAEi0D,GAAQj/C,SAElDhV,EAAE,sDAAuDsV,GAAS6mC,MAAM,WACpE,IAAIxI,EAAS3zC,EAAE6C,MAAMoP,MACrBjS,EAAE,qDAAsDsV,GAASpN,OAC7DyrC,GACA3zC,EAAE,qDAAsDsV,GAASmf,IAAI,iBAAmBkf,EAAS,KAAK3rC,UASlH2pG,gBAAiB,SAAU1jG,GACvB,IAAIrL,EAAOC,KAEX7C,EAAEqM,KAAKzJ,EAAK0kF,cAAcr5E,IAASjD,KAAK,SAAU2kG,GAC9C/sG,EAAKgtG,cAAcD,MAQ3BxoB,gBAAiB,SAAUroD,EAAQ7wB,GAEjB,WAAV6wB,EACA9+B,EAAEoqG,SAASjoG,KACPkoG,WAAY,UACZvpG,MAAOmN,EAAO+uC,YACdhoC,KALGnS,KAKQ+M,YAAY,6CAA6CpI,QAAQ,KAAMyG,EAAO+uC,aACzFstD,QAAQ,IAIZtqG,EAAEoqG,SAASjoG,KACPkoG,WAAY,QACZvpG,MAAOmN,EAAO+uC,YACdhoC,KAbGnS,KAaQ+M,YAAY,4CAA4CpI,QAAQ,KAAMyG,EAAO+uC,aACxFstD,QAAQ,KASpB5iB,kBAAmB,SAAUz5E,GACzB,IAAIrL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB8yC,EAAOzlD,EAAK2gC,mBACZ+jB,EAAmB1kD,EAAK2S,WAAWsyE,gBAAgBtsE,KAAK,KACxD+oD,EAAM,IAAItkE,EAAE4S,SAEZ4wB,GADev1B,EAAO04C,aACT0B,EAAK5kB,aAElBikB,EAAc9kD,EAAK2S,WAAWmyC,YAG9BokD,EAAY,IAAIp8F,OAAO23D,UAAU32D,WAAWo/F,MAAMznD,KAAKzlD,EAAKgjE,YAAahjE,EAAK+iE,eAC9E7kE,MAAOyU,EAAW4nC,aAAeztC,OAAOC,aAAaC,YAAY,4BACjEu1D,WAAY3hC,EAAW2hC,WACvB4qC,gBAAgB,EAChBjB,kBAAmBp/F,OAAOC,aAAaC,YAAY,gCACnD++F,OAAQ,SAAUjuG,GACd,IAAIkxG,EAAYlxG,EAAKumD,YAGrB,OAFAvmD,EAAKumD,YAAc,KAEZrkD,EAAKgjE,YAAYzf,cAAc4C,YAClC96C,OAAQ,OACRvN,KAAMA,EACNimD,aAAcmlD,EAAUzjD,KAAK9yC,WAAWoxC,aACxCM,YAAa2qD,EACb5wE,eAAe,EACfqmB,mBAAmB,IACpBr8C,KAAK,SAAUglG,GACT/hG,EAAOgiG,UAA6C,GAAjCrtG,EAAKulF,iBAAiBl6E,KAC1CA,EAAOs5C,aAAeyoD,EAAUrvB,SAEpCrc,EAAItxD,QAAQg9F,EAAUrvB,YAG9Bh0D,SAAU,SAAUjsB,OAkBxB,OAbAorG,EAAUzqD,QACNkF,OAAUt4C,EAAO6lD,WACjB5M,YAAe,SACfC,WAAcl5C,EAAOk5C,WACrBze,OAAU9lC,EAAK2S,WAAWmwF,OAC1B3+C,WAA+B,eAAjBnkD,EAAK07D,SAA4B96B,EAAWujB,gBAAah8C,EACvEu8C,iBAAoBA,EAEpBC,aAAgBt5C,EAAOs5C,aACvBd,aAAgB7jD,EAAK2S,WAAWs9C,cAChCnL,YAAeA,IAGZ4c,EAAIl5D,WAQfo8E,iBAAkB,SAAU11E,GACxB,IAAIlP,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB8yC,EAAOzlD,EAAK2gC,mBACZ+gC,EAAM,IAAItkE,EAAE4S,SACZ4wB,EAAa6kB,EAAK5kB,YAyCtB,OAxCA3xB,EAAOA,MAGS,IAAIpC,OAAO23D,UAAU32D,WAAW6/F,UAAU3tG,EAAKgjE,YAAahjE,EAAK+iE,eAE7E42B,UAAWhnF,EAAWgnF,UACtBz7F,MAAOgR,EAAKhR,OAAS,GACrBqkE,WAAY3hC,EAAW2hC,WACvB0pC,gBAAmC,cAAjBjsG,EAAK07D,UAA6C,eAAjBz7D,KAAKy7D,SAClD5uD,OAAOC,aAAaC,YAAY,6BAChCF,OAAOC,aAAaC,YAAY,+BACtC++F,OAAQ,SAAUjuG,GAId,OAHA2nD,EAAKhkD,eAGEzB,EAAKgjE,YAAYzf,cAAc4C,YAClC96C,OAAQ,OACRvN,KAAMA,EACNimD,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAavmD,EAAKumD,YAClBjmB,eAAe,EACfqmB,mBAAmB,IACpBr8C,KAAK,SAAUglG,GACd3nD,EAAKzjD,aACL0/D,EAAItxD,QAAQg9F,EAAUrvB,cAKxBt/B,QACNuR,YAAa9gD,EAAK8gD,YAClBrL,aAAcz1C,EAAKy1C,aACnB7e,OAAQ9lC,EAAK2S,WAAWmwF,OACxB3+C,WAA6B,eAAjBnkD,EAAK07D,SAA4B96B,EAAWujB,gBAAah8C,EACrEu8C,iBAAkB1kD,EAAK2S,WAAWsyE,gBAAgBtsE,KAAK,KACvDs3C,cAAejwD,EAAK2S,WAAWs9C,cAC/BnL,YAAa51C,EAAK41C,YAClBoL,qBAAqB,IAGlBwR,EAAIl5D,WAMfwkG,cAAe,SAAU3hG,GACrB,IAAIrL,EAAOC,KAEX,GAAqB,cAAjBD,EAAK07D,UAA6C,eAAjB17D,EAAK07D,SAA2B,CACjE,IAAI/kD,EAAU7J,OAAOC,aAAaC,YAAY,yDAE9C5P,EAAEqM,KAAKqD,OAAO4sE,oBAAoB/iE,EAAS,SAAU,SAChDvO,KAAK,WACFpI,EAAKqkF,yBAAyBh5E,UAGtCrL,EAAK+kF,iBAAiB15E,IAQ9B4hG,uBAAwB,SAAU5hG,GAC9B,IAAIrL,EAAOC,KACP0W,EAAU7J,OAAOC,aAAaC,YAAY,qDAE9C5P,EAAEqM,KAAKqD,OAAO4sE,oBAAoB/iE,EAAS,SAAU,SAChDvO,KAAK,WACFpI,EAAKgyC,aAEL50C,EAAEqM,KAAKzJ,EAAK0kF,cAAcr5E,IAASjD,KAAK,SAAU2kG,GAC9C/sG,EAAKgtG,cAAcD,QASnC/rC,gBAAiB,SAAUljE,GACvB,IAAIkC,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACfiiC,EAA4BxwG,EAAE,6DAA8DsV,GAC5FpU,EAAW0B,EAAK+iE,cAAcvT,YAAY,iDAC9CxvD,EAAKqsG,2BAELjvG,EAAEqM,KAAKrM,EAAEy8C,UAAUv7C,GAAYgB,QAASxB,KAASsK,KAAK,SAAU5E,GAC5DoqG,EAA0B1rG,QAC1B0rG,EAA0B/rG,OAAO2B,GACjC,IAAIsqG,EAAuB1wG,EAAE,4CAA6CwwG,GACtEG,EAAqB3wG,EAAE,mCAAoCwwG,GAC/DE,EAAqBphG,GAAG,QAAS,WAC7B,IAAItL,EAAQhE,EAAE6C,MAAMo9B,SAASv/B,KAAK,SAClCkC,EAAKqlF,oBAAoBjkF,KAE7B2sG,EAAmB9oG,KAAK,QAAS,WAC7B,IAAIgqG,EAAU7xG,EAAE6C,MAAMo9B,SAClBnzB,EAAO+kG,EAAQnxG,KAAK,cACpBkyD,EAAci/C,EAAQnxG,KAAK,eAC3B6mD,EAAesqD,EAAQnxG,KAAK,gBAC5BI,EAAQ+wG,EAAQnxG,KAAK,SACrBimD,EAAekrD,EAAQnxG,KAAK,gBAC5B8lD,EAAWqrD,EAAQnxG,KAAK,aAAe,GACvCymD,EAAa0qD,EAAQnxG,KAAK,cAC1BgnD,EAAcf,GAAgB/jD,EAAK2S,WAAWoxC,aAElD,OAAQ75C,GACJ,IAAK,UACGy6C,GACA3kD,EAAK4kF,kBACD50B,YAAaA,EACbrL,aAAcA,EACdzmD,MAAOA,EACP6lD,aAAcA,EACde,YAAaA,IAGrB,MACJ,IAAK,OACD,IAAIz5C,GACAs5E,YAAa30B,EACbrL,aAAcA,EACd0oD,UAAU,EACVtpD,aAAcA,EACdH,SAAUA,EACVW,WAAYA,EACZ2M,WAAYlB,GAGhBhwD,EAAK8kF,kBAAkBz5E,SAa3CghG,yBAA0B,WACtB,IACI35F,EADOzS,KACQ0rE,aACfiiC,EAA4BxwG,EAAE,6DAA8DsV,GAC5Fw7F,EAAwB9wG,EAAE,4BAA6BsV,GAHhDzS,KAIF2S,WAAWzN,OAAS,GACzByoG,EAA0BtoG,OAC1B4oG,EAAsB5oG,SAEtBsoG,EAA0BxoG,OAC1B8oG,EAAsB9oG,WC7WlC0H,OAAO23D,UAAUryD,KAAK1L,OAAO,4BAIzB+tE,aAAc,WACV,IACI9hE,EADO1S,KACW0S,WAClBmP,EAFO7hB,KAEU6zE,qBACjBphE,EAHOzS,KAGQ0rE,aAHR1rE,KAKNuuB,MAAyC,GAAhC9b,EAAQnP,KAAK,SAAS4B,OAAeuN,EAAQnP,KAAK,SAAWmP,EAAQnP,KAAK,uBAGpFoP,EAAWy2D,UAAY,GARhBnpE,KASFuuB,MAAMjtB,KAAK,YAAaoR,EAAWy2D,WAGvCz2D,EAAWqyC,UAIZljC,EAAUxgB,SAAS,0BAhBZrB,KAiBFuuB,MAAMiyC,WAAW,YAjBfxgE,KAkBFomE,sBALLvkD,EAAUxgB,SAAS,sBAbZrB,KAcFuuB,MAAMjtB,KAAK,WAAY,cAapC8pE,eAAgB,WACZ,IAAI/sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,YAC9C,OAAOpyD,EAAEy8C,UAAUv7C,OAOvBy0E,iBAAkB,WAEd,IACIpgE,EADO1S,KACW0S,WADX1S,KAGNsN,SAEoB,UAArBoF,EAAWwyD,QALJllE,KAMF4oF,qBAKT,IAAI3oF,EAXOD,KAWQC,QACfsuB,EAAQpxB,EAAE,QAAS8C,GAElBsuB,GAASA,EAAMrpB,QAGxB67D,gBAAiB,SAAUn9D,GACZ5D,KACN+xC,SAASnuC,GAAO,GAGC,iBAAX,GAGY,iBAFvBA,EAA0B,kBAAX,EAAuBA,EAAMkN,WAAalN,KAIrDA,GADAA,EAAQA,EAAM+X,WAAW,MAAO,KAAKA,WAAW,KAAM,MACxCA,WAAW,QAAS,KAT3B3b,KAWE0S,WAAWqyC,UAXb/kD,KAYEuuB,MAAMmpB,QAAQn0C,KAAKK,GAZrB5D,KAaEuuB,MAAMmpB,QAAQtoC,IAAIxL,IAbpB5D,KAeEuuB,MAAMpc,KAAKvO,KAK5BwvE,oBAAqB,SAAUxvE,GAChB5D,KACNuzE,aAAankE,IAAIxL,IAG1BgwE,WAAY,WACR,IACIhwE,EADO5D,KACMuzE,aAAankE,MADnBpP,KAGN+xC,SAASnuC,GAAO,GAHV5D,KAINuuB,MAAMhrB,KAAKK,GAJL5D,KAKNuuB,MAAMnf,IAAIxL,IAGnB0iF,gBAAiB,WACb,MAAO,QAGXsC,mBAAoB,WAChB,IAAI7oF,EAAOC,KACPC,EAAUF,EAAKE,QAEfsuB,EAAQpxB,EAAE,QAAS8C,GAClBsuB,GAA0B,IAAjBA,EAAMrpB,QAGpBqpB,EAAMwhB,KAAK,WACP,IAAIt9B,EAAUtV,EAAE6C,MAChB,GAAgC,WAA5B7C,EAAEsV,GAASnR,KAAK,SACc,SAA9BnE,EAAEsV,GAAS/N,IAAI,YACkB,WAAjCvH,EAAEsV,GAAS/N,IAAI,cAEf,GAAK+N,EAAQ5U,KAAK,aAA4C,KAA7BV,EAAE6C,MAAMnC,KAAK,YA0BtC4U,EAAQrD,QAAUqD,EAAQ5U,KAAK,aAC/BkC,EAAKgyC,SAAS,IACdt/B,EAAQrD,IAAI,IACZqD,EAAQ5U,KAAK,WAAY,IACzB4U,EAAQvR,QAAQ,WAChBuR,EAAQnR,KAAK,QAASvB,EAAKgN,YAAY,6BACvC0F,EAAQvR,UACRuR,EAAQvR,QAAQ,QAEhBY,WAAW,WACP2Q,EAAQ40B,SACT,OAEH50B,EAAQ5U,KAAK,WAAY4U,EAAQrD,OACjCqD,EAAQ5U,KAAK,WAAY,IAGzB4U,EAAQvR,QAAQ,gBA3C0C,CAI9D,GAAsB,KAAlBuR,EAAQrD,OAAgBqD,EAAQrD,QAAUqD,EAAQnR,KAAK,YACvD,OAEJmR,EAAQ5U,KAAK,WAAY4U,EAAQrD,OACjCqD,EAAQrD,IAAI,IAEZ,IAEIqD,EAAQvR,QAAQ,WAClB,MAAO+M,IAGTwE,EAAQnR,KAAK,QAASvB,EAAKgN,YAAY,yBACvC0F,EAAQvR,UACRuR,EAAQvR,QAAQ,QAGhBY,WAAW,WACP2Q,EAAQ40B,QACR9Y,EAAM8Y,SACP,WC5IvBx6B,OAAO23D,UAAUyqC,aAAaxoG,OAAO,iCACjCyoG,qBAAsB,KAOtB9jC,eAAgB,WACZ,IAAI/sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,wBAE9C,OAAOpyD,EAAEy8C,UAAUv7C,IAGvBm2E,aAAc,WACV,IAAIz0E,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBAErB9zE,EAAKE,QAAU4hB,EAEVnP,EAAWqyC,UAIZhlD,EAAKwuB,MAAQ1M,EAAUve,KAAK,wBAC5Bue,EAAUxgB,SAAS,0BAEnBlE,EAAE4C,EAAKwuB,OAAOvpB,KAAK,QAAS,WACxBjF,EAAKovG,gBAAgBnvG,MACrBD,EAAKgyC,SAAShyC,EAAKwuB,MAAMnf,OAAO,OARpCrP,EAAKwuB,MAAQ1M,EAAUve,KAAK,4BAC5Bue,EAAUxgB,SAAS,wBAY3ByxE,iBAAkB,WAEd,IACIpgE,EADO1S,KACW0S,WAClBD,EAFOzS,KAEQ0rE,aAFR1rE,KAIN+rF,SAAWt5E,EAAQnP,KAAK,YAIzBoP,EAAWy2D,UAAY,GARhBnpE,KASF+rF,SAASzhD,KAAK,YAAa53B,EAAWy2D,WAE3Cz2D,EAAWg5E,UAXJ1rF,KAYFyrF,aAAc,EAZZzrF,KAaF+rF,SAASzhD,KAAK,OAAQ53B,EAAWg5E,YAb/B1rF,KAeFyrF,aAAc,EAfZzrF,KAgBF+rF,SAASzhD,KAAK,OAAQ,IAhBpBtqC,KAmBNsN,UAOTyzD,gBAAiB,SAASn9D,GAEtB,IACI8O,EADO1S,KACW0S,WAClB6O,EAAe1U,OAAOY,KAAK2T,UAAUxd,GAOzC,GANAA,EAA+B,iBAAhB2d,EAA2BA,EAAe,GAGzDvhB,KAAKsN,OAAO1J,GAGRA,GAAS8O,EAAWqyC,SAAU,CAC9B,IAAIqqD,EAAgBjyG,EAAEoV,MAAM3O,GAG5B,GAbO5D,KAWF+rF,SAAS38E,IAAIggG,IAXXpvG,KAaGyrF,YAAa,CACnB,IAAIppF,EAdDrC,KAcauuB,MAAMnf,MAAMhO,MAAM,MAd/BpB,KAeEuuB,MAAM+b,KAAK,OAAQjoC,EAAK6C,OAAS,MAKlDguE,cAAe,aAGfE,oBAAqB,SAAUxvE,KAG/BgwE,WAAY,aAGZu7B,gBAAiB,SAAS5gF,GACtB,IACIw9D,EAAWx9D,EACX8gF,EAAYtjB,EAAS/lE,aAGrBqpF,EAFgBtjB,EAAS15C,eAHlBryC,KAK4ByrF,aACnCtuF,EAAE4uF,GAAUrnF,IAAI,SAAU2qG,EAAY,EAN/BrvG,KAMwCqiD,MAAM6sD,qBAAuB,SClGxFriG,OAAO23D,UAAUxjE,MAAMyF,OAAO,6BAE1B+tE,aAAc,WACV,IACI9hE,EADO1S,KACW0S,WAClBmP,EAFO7hB,KAEU6zE,qBAErBnhE,EAAWqyC,UAAW,EAJX/kD,KAKN8zE,oBAAoB3uE,OALdnF,KAOD0S,WAAWqyC,UAPV/kD,KAQF6zE,qBAAqBxyE,SAAS,sBAEvCwgB,EAAUxgB,SAAS,uBAEnBrB,KAAKsN,YCfbT,OAAO23D,UAAU37D,OAAOpC,OAAO,8BAE3B2kE,eAAgB,WACZ,IAAI/sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,kBAC9C,OAAOpyD,EAAEy8C,UAAUv7C,OAGvBm2E,aAAc,WACV,IAAIz0E,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACjBphE,EAAU1S,EAAK2rE,aAEdh5D,EAAWqyC,UAKZhlD,EAAK4oF,aAAe5oF,EAAKwuB,MAAQ9b,EAAQnP,KAAK,SAC9Cue,EAAUxgB,SAAS,0BACnBtB,EAAKwuB,MAAMiyC,WAAW,YAGS,KAA5B9tD,EAAW2d,eACVtwB,EAAKwuB,MAAMjtB,KAAK,OAAQ,UAG5BvB,EAAKqmE,sBAbLrmE,EAAK4oF,aAAe5oF,EAAKwuB,MAAQ9b,EAAQnP,KAAK,6BAC9Cue,EAAUxgB,SAAS,sBACnBwgB,EAAUve,KAAK,KAAKjC,SAAS,uBAAuBA,SAAS,cAAcA,SAAS,oBAe5FyxE,iBAAkB,WACH9yE,KAENsN,SAG0B,WALpBtN,KAKF0S,WAAWwyD,QALTllE,KAMF4oF,sBAIbe,4BAA6B,WACzB,IACIj3E,EADO1S,KACW0S,WADX1S,KAGNsN,UAEAoF,EAAWqyC,UAAYryC,EAAWygB,YAL5BnzB,KAMF2oF,aAAax2E,KANXnS,KAMqBuuB,MAAMpc,OAAS,MAInD4uD,gBAAiB,SAAUn9D,GACZ5D,KAEN+xC,SAASnuC,GAAO,GAFV5D,KAID0S,WAAWqyC,UAJV/kD,KAOFuuB,MAAMhrB,KAAKK,GAPT5D,KAQFuuB,MAAMnf,IAAIxL,GARR5D,KAWF2pF,+BAXE3pF,KAKFuuB,MAAMpc,KALJnS,KAKc2tE,oBAU7BvH,kBAAmB,WACf,IAAIrmE,EAAOC,KACPuuB,EAAQxuB,EAAKwuB,MACAxuB,EAAK2S,WAEtB3S,EAAK4oF,aAAep6D,EACpBxuB,EAAK8oF,uBAGL9oF,EAAKwuB,MAAMmhB,QAAQ3vC,EAAK2S,WAAW2d,eAEnCtwB,EAAKwuB,MAAMwhB,KAAK,WACZ,IAAIq5C,EAAarpF,EAAKwuB,MAAMnf,OAET,KAAfg6E,IAAsBv8E,OAAOY,KAAK0S,UAAUipE,IAAyC,IAA1BrpF,EAAK2S,WAAW9O,SAC3E7D,EAAKgyC,SAAS,IAAI,GAElBhyC,EAAKwuB,MAAMhrB,KAAK,IAChBxD,EAAKwuB,MAAMnf,IAAI,QAK3Bw5E,mBAAoB,WAChB,IAAI7oF,EAAOC,KACPC,EAAUF,EAAKE,QACfsuB,EAAQpxB,EAAE,QAAS8C,GAElBsuB,GAA0B,IAAjBA,EAAMrpB,QAGpBqpB,EAAMwhB,KAAK,WACP,IAAIt9B,EAAUtV,EAAE6C,MAChBD,EAAKuvG,aAAa78F,MAI1B68F,aAAc,SAAU78F,GAGpB,GAAgC,WAA5BtV,EAAEsV,GAASnR,KAAK,SACkB,SAA9BnE,EAAEsV,GAAS/N,IAAI,YACkB,WAAjCvH,EAAEsV,GAAS/N,IAAI,cAEnB,GAAK+N,EAAQ5U,KAAK,aAA4C,KAA7BV,EAAE6C,MAAMnC,KAAK,YA2BvC,CAGH,GAAsB,KAAlB4U,EAAQrD,MACR,OAGJ,GAAIqD,EAAQrD,QAAUqD,EAAQ5U,KAAK,YAAa,CAxC7CmC,KAyCM+xC,SAAS,IAEdt/B,EAAQrD,IAAI,IACZqD,EAAQ5U,KAAK,WAAY,IAEzB,IAEI4U,EAAQvR,QAAQ,WAClB,MAAO+M,IAETwE,EAAQnR,KAAK,QAnDdtB,KAmD4B+M,YAAY,8BACvC0F,EAAQvR,UACRuR,EAAQvR,QAAQ,QAEhBY,WAAW,WACP2Q,EAAQ40B,SACT,SAEA,CACH50B,EAAQ5U,KAAK,WAAY4U,EAAQrD,OACjCqD,EAAQ5U,KAAK,WAAY,IAEzB,IAEI4U,EAAQvR,QAAQ,WAClB,MAAO+M,UA5DiD,CAI9D,GAAsB,KAAlBwE,EAAQrD,OAAgBqD,EAAQrD,QAAUqD,EAAQnR,KAAK,YACvD,OAGJmR,EAAQ5U,KAAK,WAAY4U,EAAQrD,OACjCqD,EAAQrD,IAAI,IAEZ,IACIqD,EAAQvR,QAAQ,WAClB,MAAO+M,IAGTwE,EAAQnR,KAAK,QAtBVtB,KAsBwB+M,YAAY,yBAGvC0F,EAAQvR,UACRuR,EAAQvR,QAAQ,QAGhBY,WAAW,WACP2Q,EAAQ40B,SACT,SC3InBx6B,OAAO23D,UAAU+qC,yBAAyB9oG,OAAO,gDAK7C+tE,aAAc,WACV,IAAIz0E,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACfh5D,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACrB9zE,EAAKyvG,aAAeryG,EAAE,QAASsV,GAASilC,QACxC33C,EAAK4oF,aAAe5oF,EAAKwuB,MAAS9b,EAAQnP,KAAK,SAAS4B,OAAS,EAAK/H,EAAE,QAASsV,GAASslC,OAAStlC,EAAQ7Q,OAAO,yEAA2E0B,KAAK,QAGlMvD,EAAK4oF,aAAa34C,UAAUjwC,EAAK2S,WAAW2d,eAG5CtwB,EAAK0vG,gCAEA/8F,EAAWqyC,UAMZljC,EAAUxgB,SAAS,0BACnBtB,EAAK4oF,aAAanoB,WAAW,YAC7BzgE,EAAKyvG,aAAahvC,WAAW,cAP7B3+C,EAAUxgB,SAAS,sBACnBtB,EAAK4oF,aAAatnF,SAAS,uBAAuBA,SAAS,cAAcA,SAAS,2BAClFtB,EAAK4oF,aAAarnF,KAAK,WAAY,YACnCvB,EAAKyvG,aAAaluG,KAAK,WAAY,cAQ3Cy/D,gBAAiB,SAAUn9D,GACvB,IACI8O,EADO1S,KACW0S,WAElBg7D,GADA9pE,EAAQiJ,OAAOY,KAAKkxB,yBAAyB/6B,EAAO8O,EAAW2d,cAAe,IAC/DxjB,OAAOY,KAAKkxB,yBAAyB/6B,EAAO8O,EAAW2d,cAAe,KAH9ErwB,KAMN2oF,aAAav5E,IAAIxL,GANX5D,KAONwvG,aAAapgG,IAAIs+D,GAPX1tE,KAQN2oF,aAAaplF,KAAKmqE,GARZ1tE,KASN4D,MATM5D,KASO0S,WAAW9O,MAAQA,GAGzC6rG,8BAA+B,WAC3B,IAAI1vG,EAAOC,KAEXD,EAAKyvG,aAAanoE,MAAM,WACpBlqC,EAAE6C,MAAMoP,IAAIrP,EAAK4tE,qBAIrB5tE,EAAKyvG,aAAaz/D,KAAK,gBAC0C,IAAjDhwC,EAAK2gC,mBAAuC,uBAAkB3gC,EAAK2gC,mBAAmB2jC,qBAAuB,IAAIx3D,OAAOsqD,QAAQpxB,YAAY8xC,WAAW93E,EAAK2gC,mBAAoB3gC,EAAK23D,cAEjM,IAAIg4C,EAA2B7iG,OAAOY,KAAKkxB,yBAAyB5+B,EAAKyvG,aAAapgG,MAAOrP,EAAK2S,WAAW2d,cAAe,IACxHs/E,EAAkC9iG,OAAOY,KAAKkxB,yBAAyB5+B,EAAKyvG,aAAapgG,MAAOrP,EAAK2S,WAAW2d,cAAe,IAEnItwB,EAAK4oF,aAAav5E,IAAIsgG,GACtB3vG,EAAKyvG,aAAapgG,IAAIugG,GAGtB5vG,EAAKgyC,SAAS29D,QC7D1B7iG,OAAO23D,UAAUpzB,MAAM3qC,OAAO,6BAE1B2kE,eAAgB,WACZ,IACIxnE,EADO5D,KACMsN,SACbjP,EAFO2B,KAES8iE,cAAcvT,YAAY,kBAC1C0tB,EAAO9/E,EAAEA,EAAEy8C,UAAUv7C,GAAWuF,MAAOA,KAG3C,OAFAzG,EAAE,cAAe8/E,GAAMp3D,YAAY,qBAAqBA,YAAY,kBAAkBxkB,SAAS,iBAAiBA,SAAS,mBAElH47E,EAAK5qE,IAAI,GAAGu9F,WAGvBp7B,aAAc,WACV,IAAIz0E,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACjBphE,EAAU1S,EAAK2rE,aAEdh5D,EAAWqyC,UAIZhlD,EAAK8vG,YAAc1yG,EAAE,OAAQsV,GAC7B1S,EAAK8vG,YAAYhqF,YAAY,kBAAkBxkB,SAAS,iBAExDtB,EAAK4oF,aAAe5oF,EAAKwuB,MAAQ9b,EAAQnP,KAAK,SAC9Cue,EAAUxgB,SAAS,0BACnBtB,EAAKwuB,MAAMiyC,WAAW,YAGS,KAA5B9tD,EAAW2d,eACVtwB,EAAKwuB,MAAMjtB,KAAK,OAAQ,UAG5BvB,EAAKqmE,sBAfLrmE,EAAK4oF,aAAe5oF,EAAKwuB,MAAQ9b,EAAQnP,KAAK,6BAC9Cue,EAAUxgB,SAAS,wBAkB3ByxE,iBAAkB,WACH9yE,KACNsN,UAGTyzD,gBAAiB,SAAUn9D,GACvB,IACI8O,EADO1S,KACW0S,WADX1S,KAGN+xC,SAASnuC,GAAO,GAEhB8O,EAAWqyC,UALL/kD,KAQFuuB,MAAMhrB,KAAKK,GART5D,KASFuuB,MAAMnf,IAAIxL,IATR5D,KAMFuuB,MAAMpc,KAAKvO,GANT5D,KAYN2pF,+BAITA,4BAA6B,WACzB,IACIj3E,EADO1S,KACW0S,WADX1S,KAGNuuB,MAAMwD,gBACPpB,OAAQje,EAAWie,OACnBI,eAAgBre,EAAWqe,eAC3BD,eAAgBpe,EAAWoe,eAC3BT,cAAe3d,EAAW2d,cAC1BE,iBAAkB7d,EAAW6d,iBAC7BM,YAAane,EAAWme,YACxBJ,oBAAqB/d,EAAW01E,YAChCx3D,SAAUle,EAAWke,YAI7Bw1C,kBAAmB,WACf,IAAIrmE,EAAOC,KACPuuB,EAAQxuB,EAAKwuB,MACAxuB,EAAK2S,WAEtB3S,EAAK4oF,aAAep6D,EACpBxuB,EAAK8oF,uBACL9oF,EAAK4pF,8BAGL5pF,EAAKwuB,MAAMmhB,QAAQ3vC,EAAK2S,WAAW2d,eAEnCtwB,EAAKwuB,MAAMwhB,KAAK,WACZ,IAAIq5C,EAAarpF,EAAKwuB,MAAMnf,OACT,KAAfg6E,IAAsBv8E,OAAOY,KAAK0S,UAAUipE,IAAyC,IAA1BrpF,EAAK2S,WAAW9O,SAC3E7D,EAAKgyC,SAAS,GAAG,GACjBhyC,EAAKwuB,MAAMhrB,KAAK,GAChBxD,EAAKwuB,MAAMnf,IAAI,GACfrP,EAAK4pF,kCAKjBrD,gBAAiB,WACb,MAAO,UCvGfz5E,OAAO23D,UAAU1vC,KAAKruB,OAAO,yBACzBqpG,oBAAsBC,kBAAqB,OAK3Cv7B,aAAc,WACV,IACI9hE,EADO1S,KACW0S,WAClBmP,EAFO7hB,KAEU6zE,qBACjBphE,EAHOzS,KAGQ0rE,aAEdh5D,EAAWqyC,SALL/kD,KAYFuuB,MAZEvuB,KAYWorF,kBALlBvpE,EAAUxgB,SAAS,sBAPZrB,KASFuuB,MAAQ9b,EAAQnP,KAAK,QAAQjC,SAAS,wBAOnD+pE,eAAgB,WACZ,IAAI/sE,EAAW2B,KAAK8iE,cAAcvT,YAAY,YAC9C,OAAOpyD,EAAEy8C,UAAUv7C,OAMvBy0E,iBAAkB,WACd,IAAI/yE,EAAOC,KAGXD,EAAKuN,SAEL,IAAI0iG,EAAejwG,EAAKqrF,iBACpB6kB,EAAkBlwG,EAAK2S,WAAW8lB,UAAY,WAAY,SAAW,YACrE03E,EAAqBnwG,EAAKowG,iBAAiBpwG,EAAK2S,WAAW9O,MAAO7D,EAAK2S,WAAW8lB,UAAU,GAC5F43E,EAAiBrwG,EAAKowG,iBAAiBpwG,EAAK2S,WAAWs2E,SAAUjpF,EAAK2S,WAAW8lB,UAAU,GAC3F63E,EAAiBtwG,EAAKowG,iBAAiBpwG,EAAK2S,WAAWw2E,SAAUnpF,EAAK2S,WAAW8lB,UAAU,GAC3FP,EAAal4B,EAAK2S,WAAW8lB,SAAWz4B,EAAKuwG,gBAAkB,GAkGnE,GA/FI7zF,MAAMxJ,KAAK0F,MAAMy3F,OACjBA,EAAiB,IAAIn9F,MACNs9F,YAAYH,EAAeh6E,cAAgBr2B,EAAKsiD,MAAMytD,mBAAmBC,mBACxFK,EAAe13E,SAAS,EAAG,EAAG,EAAG,IAIjCjc,MAAMxJ,KAAK0F,MAAM03F,OACjBA,EAAiB,IAAIp9F,MACNs9F,YAAYF,EAAej6E,cAAgBr2B,EAAKsiD,MAAMytD,mBAAmBC,mBACxFM,EAAe33E,SAAS,GAAI,GAAI,KAGpCv7B,EAAE,qBAAsB4C,EAAK0S,SAASgX,MAAM,WACxCumF,EAAavmF,UAGZ1pB,EAAKywG,uBACNzwG,EAAKgyC,SAAS,IACdhyC,EAAKwuB,MAAM+b,KAAK,QAAS,IACzBvqC,EAAK2S,WAAWg7D,aAAe,IAGnCsiC,EAAaS,aAAaC,UACtB7wG,KAAM,QACNozC,QAAS,SACTprB,SAAUooF,EACVjlG,IAAKolG,EACLrlG,IAAKslG,EACL3hC,aAAcwhC,EACdj4E,WAAYA,EACZ04E,kBAAkB,EAClBC,KAAM/jG,OAAOY,KAAKojG,UAAUC,kBAAoB,KAChD7xG,SACA,OAEIkT,KAAMnS,KAAK+M,YAAY,gDACvB25F,QAAS,SAAUz4F,EAAG8iG,GAClBhxG,EAAK+0B,UAAO5sB,EACZnI,EAAKi1B,UAAO9sB,EACZnI,EAAKixG,WAAQ9oG,EACbnI,EAAKwrF,iBAAgB,GACrBwlB,EAAK92E,UAGb,UAEAg3E,MAAO,SAAUC,EAAWH,GACxB,IAAIlzG,EAAOkzG,EAAKI,SAChBpxG,EAAK+0B,MAASinB,IAAOl+C,EAAKkuB,UAAW8K,MAASh5B,EAAKw4B,WAAYM,KAAQ94B,EAAKu4B,eAGxEr2B,EAAK2S,WAAW8lB,WAChBz4B,EAAKi1B,MAAS8mB,MAASj+C,EAAKk2B,WAAY6nB,QAAW/9C,EAAKm2B,cACnDj0B,EAAKqxG,QACNrxG,EAAKixG,MAAQnzG,EAAKk2B,WAAa,GAAK,KAAO,OAInDh0B,EAAKwrF,mBAET8lB,aAAc,SAAU3qF,EAAOqqF,GAE3BhxG,EAAKi4D,qBAAqB,yBAE1Bj4D,EAAKmhE,eAAenhE,EAAK2S,WAAWs2E,UACpCjpF,EAAKshE,eAAethE,EAAK2S,WAAWw2E,UAGhCr8E,OAAOY,KAAKkS,eACZxiB,EAAE,sCAAsCuH,IAAI,UAAW,SAG/DskB,QAAS,SAAUtC,EAAOqqF,GAEtBhxG,EAAKi4D,qBAAqB,4BAC1B76D,EAAE,mBAAmBuH,IAAI,aAAc,SAE3C0vC,OAAQ,SAAU1tB,EAAOqqF,GACrB5zG,EAAE,mBAAmBuH,IAAI,aAAc,aAK/CsrG,EAAavjG,GAAG,QAAS,SAAUwB,GAC/BA,EAAE4lC,iBACF5lC,EAAEimC,kBAEErnC,OAAOY,KAAKk2B,sBAAwB92B,OAAOY,KAAK62B,oBAChDR,QAAQC,QAAQC,SAASstE,eAAc,GACvCxtE,QAAQC,QAAQC,SAASjc,WAKI,KAAjChoB,EAAK2S,WAAWg7D,cAAuB3tE,EAAK2S,WAAW9O,MAAO,CAC9D,IAAIkxB,EAAO/0B,EAAKowG,iBAAiBpwG,EAAK2S,WAAW9O,MAAO7D,EAAK2S,WAAW8lB,UAAU,GAAM,GACpFk1C,EAAe7gE,OAAOY,KAAKgmB,cAAcD,WAAWsB,EAAM/0B,EAAK2S,WAAWk4E,YAC9E7qF,EAAKwuB,MAAM+b,KAAK,QAASojC,GAG7BsiC,EAAa1uG,KAAK,WAAY,YAMlCgvG,cAAe,WAGX,OAAiD,IAFtCtwG,KAEF0S,WAAWulB,WAAW/tB,QAAQ,OAA6D,IAFzFlK,KAEgD0S,WAAWulB,WAAW/tB,QAAQ,OAF9ElK,KAGFoxG,OAAQ,EACN,UAJApxG,KAMFoxG,OAAQ,EACN,YAOfjB,iBAAkB,SAAUr7E,EAAM0D,EAAU+4E,GAGxC,GAAKz8E,IAAQjoB,OAAOY,KAAKC,cAAconB,GAAvC,CAIA,IAAIE,EAAQwD,IAAgC,QANjCx4B,KAMmBkT,WAAuBq+F,GAAgB,IACrEz8E,EAAKlc,OAAOkc,EAAK5vB,OAAS,EAAG4vB,EAAK5vB,QAAU,GAC5C4vB,EAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAuBg5E,GAAe/4E,GAAYxD,EAAK5zB,MAAM,KAAK8D,OAAS,GAAkC,IAA3B4vB,EAAK1zB,MAAM,KAAK8D,OACnI4vB,GAAQ,YAAcA,EAAM0D,GAE5B,IAAIg5E,EAXOxxG,KAWiByxG,QAXjBzxG,KAW8B0xG,oBAAoB58E,EAAM0D,EAAoB,KAATxD,EAAcA,EAAO,IAXxFh1B,KAWmGkT,UAAY,WAG1H,OAFAs+F,EAAmB3kG,OAAOY,KAAKgmB,cAAcmF,eAAe44E,GAAkB,KAQlFtwC,eAAgB,SAAUt9D,GACtB,IACI8O,EADO1S,KACW0S,WAClBy4E,EAFOnrF,KAEYorF,iBAGnBxnF,GALO5D,KAKO0S,WAAWqyC,WACF,iBAAZ,GACPnhD,EAAQ,IAAIqP,KAAKrP,GACjBunF,EAAYslB,WAAW,UAAYzlG,IAAKpH,IACxCA,EAAQiJ,OAAOY,KAAKgmB,cAAckF,gBAAgB/0B,EAAO8O,EAAW8lB,WAEpE2yD,EAAYslB,WAAW,UAAYzlG,IAAK6B,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,GAAO,KAGlG8O,EAAWs2E,SAAWplF,IAO9By9D,eAAgB,SAAUz9D,GACtB,IACI8O,EADO1S,KACW0S,WAClBy4E,EAFOnrF,KAEYorF,iBAGnBxnF,GALO5D,KAKO0S,WAAWqyC,WACF,iBAAZ,GACPnhD,EAAQ,IAAIqP,KAAKrP,GACjBunF,EAAYslB,WAAW,UAAY1lG,IAAKnH,IACxCA,EAAQiJ,OAAOY,KAAKgmB,cAAckF,gBAAgB/0B,EAAO8O,EAAW8lB,WAEpE2yD,EAAYslB,WAAW,UAAY1lG,IAAK8B,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,GAAO,KAGlG8O,EAAWw2E,SAAWtlF,IAO9Bm9D,gBAAiB,SAAUn9D,GACvB,IACI8O,EADO1S,KACW0S,WAClBoiB,EAFO90B,KAEKmwG,iBAAiBvsG,EAAO8O,EAAW8lB,UAAU,GACzDk1C,EAHO1tE,KAGa2xG,oBAAoB78E,GAExCpiB,EAAWqyC,UALJ/kD,KAMFuuB,MAAMhrB,KAAKmqE,GANT1tE,KAOFuuB,MAAM+b,KAAK,QAASojC,IAPlB1tE,KASFuuB,MAAMpc,KAAKu7D,IAIxBqC,kBAAmB,WACJ/vE,KAEN80B,UAAO5sB,EAFDlI,KAGNg1B,UAAO9sB,EAHDlI,KAINgxG,WAAQ9oG,EAJFlI,KAKNurF,iBAAgB,GALVvrF,KAMN+gE,gBAAgB,KAMzBqqB,eAAgB,WAGZ,OAAOjuF,EAAE,2BAFE6C,KAE+B0rE,eAM9Cx4D,QAAS,WACL,IAAInT,EAAOC,KAGX,GAAID,EAAK2S,WAAW8lB,UAAaz4B,EAAKi1B,MAAiC,KAAzBj1B,EAAKi1B,KAAc,QAAW,CACxE,IAAIA,EAAOj1B,EAAKi1B,KAAY,MAAI,IAAMj1B,EAAKi1B,KAAc,QAWzD,OAR2B,IAF3BA,GAAQj1B,EAAKixG,OAEJ9mG,QAAQ,OAAqC,IAAtBnK,EAAKi1B,KAAY,QAC7CA,EAAOA,EAAKrwB,QAAQ,KAAM,OAGH,GAAvBqwB,EAAK9qB,QAAQ,OAAenK,EAAKi1B,KAAY,MAAI,KACjDA,EAAOA,EAAKrwB,QAAQ5E,EAAKi1B,KAAY,MAAIvwB,SAAS1E,EAAKi1B,KAAY,OAAK,KAGrEA,EAAKrwB,QAAQ,UAAW,IAE/B,MAAO,IAOfonB,QAAS,WAEL,OADW/rB,KACE80B,MAA+B,KADjC90B,KACe80B,KAAY,MAD3B90B,KAC4C80B,KAAW,KAAI,KAAOrwB,SADlEzE,KACgF80B,KAAY,OAAK,GAAK,IADtG90B,KACiH80B,KAAU,IAAI,IAM9Iy2D,gBAAiB,SAAUqmB,GACvB,IAAI7xG,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBqkD,EAAch3D,EAAKgsB,UACnB8lF,EAAen/F,EAAmB,SAAI,IAAM3S,EAAKmT,UAAY,QAGjE,GAAqB,KAAhB6jD,IAAuBrkD,EAAW8lB,UAA8B,KAAhBu+B,GAAsC,KAAhB86C,GAAuB,EAC9F9xG,EAAKgyC,SAAS,IACdhyC,EAAKwuB,MAAM+b,KAAK,QAAS,IACzB53B,EAAWg7D,aAAe,OACvB,CACH,IAAIA,EACAm0B,EAAgB9hG,EAAK0xG,QAAQ1xG,EAAK2xG,oBAAoB36C,EAAa86C,IACnEC,EAAoBjlG,OAAOY,KAAKgmB,cAAcmF,eAAeipE,GAAe,GAEhF,IAAKiQ,GAA2C,IAAtBA,EAAyB,OAGnD/xG,EAAKgyG,gBAAgBD,EAAmBp/F,EAAW8lB,UAEnDk1C,EAAe3tE,EAAK4xG,oBAAoBG,GACxCp/F,EAAWg7D,aAAeA,EAC1B3tE,EAAKwuB,MAAM+b,KAAK,QAASvqC,EAAK2S,WAAWg7D,gBAOjDgkC,oBAAqB,SAAU36C,EAAa86C,GACxC,IAAIG,EAAW,GAGXA,EADAj7C,EAAY7xD,OAAS,EACV6xD,OACY7uD,IAAhB6uD,EACIlqD,OAAOY,KAAKgmB,cAAcqF,UAAUi+B,GAAa,GAEjDlqD,OAAOY,KAAKgmB,cAAcqF,UAAU,IAAI7lB,MAAQ,GAG/D++F,GAAYH,EACZ,IAAII,EAAiBplG,OAAOY,KAAKgmB,cAAcmB,kBAAkBo9E,EAAU,kBAE3E,OAAOnlG,OAAOY,KAAKgmB,cAAcD,WAA8B,IAAnBy+E,EAAuBA,EAAiBl7C,EAAa,uBAMrGg7C,gBAAiB,SAAUG,EAAkB15E,GACzC,IACI50B,EAA4B,IAApBsuG,EAAyBrlG,OAAOY,KAAKgmB,cAAckF,gBAAgBu5E,EAAkB15E,GAAY,GADlGx4B,KAEN+xC,SAASnuC,IAMlBuuG,gBAAiB,SAAUr9E,EAAM0D,GAC7B,IAAKA,EAAU,CACX,IAAI45E,EAAgB,KAWhBC,GATAD,GAD0B,GAA1Bt9E,EAAK5qB,QAAQ,SACG4qB,EAAK5qB,QAAQ,UACG,GAAzB4qB,EAAK5qB,QAAQ,QACJ4qB,EAAK5qB,QAAQ,SACI,GAA1B4qB,EAAK5qB,QAAQ,SACJ4qB,EAAK5qB,QAAQ,SAEb,MAGe,EACnC4qB,GAA0B,IAAnBs9E,EAAuBt9E,EAAOA,EAAKnwB,QAAQmwB,EAAKtW,UAAU4zF,EAAeC,GAAe,IAAI1tG,QAAQ,MAAO,IAAIA,QAAQ,MAAO,IAGzI,OAAOmwB,GAMX68E,oBAAqB,SAAU78E,GAC3B,IACIpiB,EADO1S,KACW0S,WAKtB,OAFe7F,OAAOY,KAAKgmB,cAAcD,WAAWsB,EAAMpiB,EAAWk4E,aAQzE5gF,QAAS,SAAU0vD,GACf,IAAI35D,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBgoD,GAAS,EACT92D,EAAQ7D,EAAK4S,WAsBjB,GApBI/O,GACIiJ,OAAOY,KAAKuF,aAAaN,EAAWqyC,WAGvB,IAFbnhD,EAAQiJ,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,MAInDA,EAAM80B,SAAS,EAAG,EAAG,EAAG,GAGpBhmB,EAAWs2E,UAA6C,iBAAzBt2E,EAAmB,WAClDgoD,GAAS36D,EAAKuyG,uBAAuB1uG,GAAO,EAAM8O,EAAYgnD,IAA2BgB,GAGzFhoD,EAAWw2E,UAA6C,iBAAzBx2E,EAAmB,WAClDgoD,GAAS36D,EAAKuyG,uBAAuB1uG,GAAO,EAAO8O,EAAYgnD,IAA2BgB,IAMtG7tD,OAAOY,KAAKuF,aAAaN,EAAWqyC,UAEpC,GAAIryC,EAAWosD,UAAY/+D,EAAKusE,WAAY,CACxC,IAAI75D,EAAU1S,EAAKqrF,iBAEf34E,EAAQvN,OAAS,GAAKuN,EAAQrD,MAAMlK,QAAU,IAC9Cw1D,EAAS36D,EAAKwyG,qBAAqB7/F,EAAYgnD,SAE5ChnD,EAAWosD,WAAa/+D,EAAKusE,YACpCvsE,EAAKwyG,qBAAqB7/F,EAAYgnD,GAS9C,OALIgB,GAEA36D,EAAKq5D,qBAAqB,IAGvBsB,GAMX43C,uBAAwB,SAAU1uG,EAAO4uG,EAAY9/F,EAAYgnD,GAC7D,IAAI+4C,EAAS5lG,OAAOY,KAAKgmB,cAAc8E,qBAAqBi6E,EAAa9/F,EAAWs2E,SAAWt2E,EAAWw2E,UAG1G,GAFAupB,EAAO/5E,SAAS,EAAG,EAAG,EAAG,GAEpB85E,GAAc5uG,EAAQ6uG,IAAaD,GAAc5uG,EAAQ6uG,EAAS,CACnE,IAAI/7F,EAAU87F,EACdxyG,KAAK+M,YAAY,kCAAkC4O,WAAW,UAAWjJ,EAAWynC,aAAax+B,WAAW,aAAc9O,OAAOY,KAAKgmB,cAAcD,WAAWi/E,EAAQ//F,EAAWk4E,aAChL5qF,KAAK+M,YAAY,kCAAkC4O,WAAW,UAAWjJ,EAAWynC,aAAax+B,WAAW,aAAc9O,OAAOY,KAAKgmB,cAAcD,WAAWi/E,EAAQ//F,EAAWk4E,aAMpL,OAJAlxB,EAAgB9wD,MACZiY,MAAOnO,EAAWmO,MAClBnK,QAASA,KAEN,EAGX,OAAO,GAMX67F,qBAAsB,SAAU7/F,EAAYgnD,GACxC,IACIhjD,EADO1W,KACQ+M,YAAY,wBAAwB4O,WAAW,UAAWjJ,EAAWynC,aAIxF,OAFAuf,EAAgB9wD,MAAOiY,MAAOnO,EAAWmO,MAAOnK,QAASA,KAElD,GAGX+6F,QAAS,SAAU38E,GACf,OAAOA,EAAKnwB,QAAQ,MAAO,QAAQA,QAAQ,MAAO,QAAQA,QAAQ,MAAO,QAAQA,QAAQ,MAAO,QAAQA,QAAQ,MAAO,QAAQA,QAAQ,MAAO,QAAQA,QAAQ,MAAO,QAAQA,QAAQ,MAAO,QAAQA,QAAQ,MAAO,QAAQA,QAAQ,MAAO,SAG9O6rG,mBAAoB,WAChB,IACIxmG,GAAU,EACVpG,EAFO5D,KAEM2S,WAkBjB,OAhBI/O,GAGc,KAFdA,EAAQiJ,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,MAInDA,EAAM80B,SAAS,EAAG,EAAG,EAAG,GATrB14B,KAYM0S,WAAWs2E,UAAkD,iBAZnEhpF,KAY0C0S,WAAmB,WAC5D1I,EAbDhK,KAagBsyG,uBAAuB1uG,GAAO,IAb9C5D,KAeM0S,WAAWw2E,UAAkD,iBAfnElpF,KAe0C0S,WAAmB,WAC5D1I,EAhBDhK,KAgBgBsyG,uBAAuB1uG,GAAO,KAIlDoG,GAGXsoG,uBAAwB,SAAUv7C,EAAay7C,GAC3C,IACI19E,EAAO09E,EADAxyG,KACkB0S,WAAWs2E,SAD7BhpF,KAC6C0S,WAAWw2E,SAC/D2Y,EAAgBh1F,OAAOY,KAAKgmB,cAAc8E,qBAAqBzD,GAInE,OAFA+sE,EAAcnpE,SAAS,EAAG,EAAG,EAAG,KAEtB85E,GAAcz7C,EAAc8qC,IAAoB2Q,GAAcz7C,EAAc8qC,MC/f9Fh1F,OAAO23D,UAAUkuC,MAAMjsG,OAAO,6BAC1B+tE,aAAc,WACV,IAAIz0E,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACfh5D,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBAEjBnhE,EAAWqyC,UACQ,MAAdhlD,EAAK6D,YAAgCsE,IAAfnI,EAAK6D,OAAkD,MAAzB7D,EAAK2S,WAAW9O,QACrE7D,EAAK6D,MAAQ8O,EAAW9O,OAG5B7D,EAAKwuB,MAAQxuB,EAAK2rE,aAAapoE,KAAK,SACpCue,EAAUxgB,SAAS,0BAEnBtB,EAAKwuB,MAAMsf,OAAO,WACd,IACI8kE,EADgB5yG,EAAKwuB,MAAMjrB,KAAK,uBACTgnC,KAAK,SAE5BvqC,EAAK6D,QAAU+uG,IACf5yG,EAAKgyC,SAAS4gE,GACd5yG,EAAKghE,gBAAgB4xC,GAEjB5yG,EAAK2S,WAAWovD,gBAChB/hE,EAAK+hE,sBAMjBjgD,EAAUxgB,SAAS,sBACnBtB,EAAKwuB,MAAQ9b,EAAQ7Q,OAAO,yEAA2E0B,KAAK,UAIpH+qE,qBAAsB,SAAS1/D,GAC3B,OAAO3O,KAAK0S,WAAWqyC,SAAW5nD,EAAE,eAAgBwR,GAAWxR,EAAEwR,IAMrEoyD,gBAAiB,SAASn9D,GACtB,IACI8O,EADO1S,KACW0S,WAItB,GALW1S,KAGN+xC,SAASnuC,EAAMkN,WAAWL,eAAe,GAE1CiC,EAAWqyC,SAAU,CACrB,IAAI6tD,EAAc/lG,OAAOY,KAAKuF,aAAapP,GANpC5D,KAOFuuB,MAAMjrB,KAAK,kBACXgnC,KAAK,WAA2B,IAAhBsoE,GAChBj+B,YAAY,gBAAgC,IAAhBi+B,GAC5Bj+B,YAAY,YAA4B,IAAhBi+B,GAVtB5yG,KAYFuuB,MAAMjrB,KAAK,mBACXgnC,KAAK,WAA2B,IAAhBsoE,GAChBj+B,YAAY,gBAAgC,IAAhBi+B,GAC5Bj+B,YAAY,YAA4B,IAAhBi+B,QAE7B5yG,KAAKsN,OAAO1J,MC3DxBiJ,OAAO23D,UAAUquC,MAAMpsG,OAAO,6BAC1BqsE,iBAAkB,WACd,IAAI/yE,EAAOC,KAEP0S,GADU3S,EAAK2rE,aACF3rE,EAAK2S,YAClBmP,EAAY9hB,EAAK8zE,qBACrB9zE,EAAKgzE,oBAILhzE,EAAKE,QAAQqD,KAAK,yDAAyDjC,SAAS,oBACpFtB,EAAKE,QAAQqD,KAAK,gDAAgDjC,SAAS,kBAC3EtB,EAAKE,QAAQqD,KAAK,yDAAyDyrB,aAAahvB,EAAKE,QAAQqD,KAAK,iDAC1GvD,EAAKwuB,MAAQxuB,EAAK2rE,aAAapoE,KAAK,SAEhCoP,EAAWqyC,UACXljC,EAAUxgB,SAAS,0BAEnBtB,EAAKwuB,MAAMvpB,KAAK,QAAS,WACrB,IAAIswF,EAAYv1F,EAAKwuB,MAAMnrB,GAAG,YAS9B,GAPArD,EAAKgyC,SAASujD,GAAW,GACzBA,EAAYv1F,EAAKwuB,MAAM1I,YAAY,gBAAgBxkB,SAAS,YAActB,EAAKwuB,MAAMltB,SAAS,gBAAgBwkB,YAAY,YAEtH9lB,EAAK2S,WAAWovD,gBAChB/hE,EAAK+hE,iBAGN/hE,EAAK2S,WAAWosD,WAAaw2B,EAAU,CACtC,IAAIwd,EAAkB/yG,EAAKE,QAAQqD,KAAK,oCACxCwvG,EAAgB5tG,OAAS,EAAI4tG,EAAgBztG,OAAStF,EAAKE,QAAQqD,KAAK,oBAAoBs1C,QAAQ,0CAI5G/2B,EAAUxgB,SAAS,uBAM3B0/D,gBAAiB,SAASn9D,GACtB,IACI8O,EADO1S,KACW0S,WADX1S,KAIN+xC,SAASnuC,GAAO,GAErB,IAAIgvG,EAAc,GAEdA,EADAlgG,EAAWqyC,SACGl4C,OAAOY,KAAKuF,aAAapP,GAEzBiJ,OAAOY,KAAKuF,aAVnBhT,KAUqC0S,WAAW9O,OAVhD5D,KAaNuuB,MAAM+b,KAAK,WAA2B,IAAhBsoE,GAbhB5yG,KAcNuuB,MAAMomD,YAAY,YAA4B,IAAhBi+B,GAAsBj+B,YAAY,gBAAgC,IAAhBi+B,MCrD7F/lG,OAAO23D,UAAU7pC,KAAKl0B,OAAO,4BAEzB2kE,eAAgB,WACZ,IACI/sE,EADO2B,KACS8iE,cAAcvT,YAAY,YAC1C3rD,EAFO5D,KAEM0S,WAAW9O,OAFjB5D,KAE+BssE,WAF/BtsE,KAEiD0S,WAAW9O,MAAMA,MAAQ,MAErF,OAAOzG,EAAEy8C,UAAUv7C,GAAYuF,MAAOA,KAG1C4wE,aAAc,WAEV,IACI/hE,EADOzS,KACQ0rE,aACf7pD,EAFO7hB,KAEU6zE,qBAGrB7zE,KAAKsN,SALMtN,KAOD0S,WAAWqyC,SAPV/kD,KAiBF26B,KAAOx9B,EAAE,yBAA0BsV,IARxCoP,EAAUxgB,SAAS,sBATZrB,KAYF26B,KAAOloB,EAAQnP,KAAK,QAZlBtD,KAcF26B,KAAKr5B,KAAK,WAAY,aAdpBtB,KAoBN+yG,yBAMTjgC,iBAAkB,WACd,IAAI/yE,EAAOC,KACXD,EAAKuN,SAGLnQ,EAAEqM,KAAKzJ,EAAKqR,SAASjJ,KAAK,WACjBpI,EAAKusE,WAINvsE,EAAK2rE,aAAapoE,KAAK,+BAA+B+B,KAAK,MAH3DtF,EAAK2rE,aAAapoE,KAAK,yBAAyBC,KAAK,iBACrDxD,EAAK2rE,aAAapoE,KAAK,+BAA+B6B,KAAK,SAUvE4tG,sBAAuB,WACnB,IAAIhzG,EAAOC,KACPyS,EAAU1S,EAAK2rE,aAEnB3rE,EAAK46B,KAAKr3B,KAAK,kBAAkB0B,KAAK,QAAS,WAC3C,IAAI3G,EAAW0B,EAAK+iE,cAAcvT,YAAY,iBAC1CyjD,EAAoB/9E,MAAM52B,SAASA,GAAY66C,cAAc,IAC7Dr7C,GACA+O,MAAS7M,EAAK2S,WAAW7U,KACzBs8C,YAAep6C,EAAK2S,WAAWynC,aAAe,GAC9Cr2C,YAAe/D,EAAK2S,WAAW5O,aAE/BmvG,EAAY91G,EAAEA,EAAE+f,KAAK81F,EAAkBn1G,KAE3Co1G,EAAU95D,sBACNpxB,MAAO,WACHhoB,EAAKi4D,qBAAqB,4BAE1Bh4D,KAAK2N,UACL3N,KAAKC,QAAQT,UAEjB45C,oBAAoB,EACpB7uB,OAAO,IAGXxqB,EAAKmzG,2BAA2BD,GAEhClzG,EAAKi4D,qBAAqB,yBAC1Bi7C,EAAU95D,qBAAqB,UAInCp5C,EAAK46B,KAAKluB,GAAG,QAAS,yBAA0B,WAC5C,IAGI+9E,GAAaltF,GAHPH,EAAE6C,MAAMnC,KAAK,SAGK+F,MAFhBzG,EAAE6C,MAAMmS,QAGpBpS,EAAKkyF,cAAgBzH,EAAS5mF,MAC9B7D,EAAKgyC,SAASy4C,GACdzqF,EAAKghE,gBAAgBypB,KAIzB/3E,EAAQnP,KAAK,kCAAkCmJ,GAAG,QAAS,8BAA+B,WACtF,IAGI+9E,GAAaltF,GAHP,GAGkBsG,MAFhB,iBAGZ7D,EAAKgyC,SAASy4C,GACdzqF,EAAKkyF,cAAgBzH,EAAS5mF,MAC9B7D,EAAKghE,gBAAgBypB,MAO7B0oB,2BAA4B,SAAUC,GAClC,IAAIpzG,EAAOC,KAEPozG,EAAwB,IAAIj2G,EAAE4S,SAG9B8R,EAAYsxF,EAAe7vG,KAAK,sCAGpC6vG,EAAe7vG,KAAK,yCAAyC6B,KAAK,KAGlEguG,EAAex/D,SAAS,2BAA4B,QAAS,WACzDy/D,EAAsB9gD,SACtB6gD,EAAet1G,KAAK,wBAAwBkqB,UAIhDorF,EAAe7vG,KAAK,wCAAwC0B,KAAK,+BAAgC,WAC7FjF,EAAKo8F,WAAWn8F,KAAK4D,MAAOie,EAAWsxF,KAI3CA,EAAe7vG,KAAK,yCAAyC0B,KAAK,QAAS,WACvEjF,EAAKo8F,WAAW,GAAIt6E,EAAWsxF,GAC/BA,EAAe7vG,KAAK,wCAAwC8L,IAAI,IAChEjS,EAAE6C,MAAMmF,KAAK,OAIjBpF,EAAKszG,cAAgBl2G,EAAE,kCAAmCg2G,GAC1DpzG,EAAKuzG,2BAGLvzG,EAAKszG,cAAc5mG,GAAG,QAAS,KAAM,WACjC1M,EAAKszG,cAAc/vG,KAAK,MAAMq1C,OAAO,WACjC,GAAIx7C,EAAE6C,MAAMiyC,SAAS,eACjB,OAAO90C,EAAE6C,QAEd6lB,YAAY,eAEf1oB,EAAE6C,MAAMqB,SAAS,eACjBlE,EAAE,uCAAwCg2G,GAAgBpjE,SAG9DojE,EAAex/D,SAAS,0BAA2B,QAAS,WACxDy/D,EAAsBjjG,UACtBgjG,EAAet1G,KAAK,wBAAwBkqB,UAGhDorF,EAAe7vG,KAAK,0BAA0B0B,KAAK,QAAS,WACxDouG,EAAsB9gD,SACtB6gD,EAAet1G,KAAK,wBAAwBkqB,UAGhD5qB,EAAEqM,KAAK4pG,GAAuBjrG,KAAK,WAC/B,IAAIumD,EAAWvxD,EAAE,iBAAkB4C,EAAKszG,eACpCE,EAASp2G,EAAEuxD,GAAU7wD,KAAK,SAC1BmD,EAAQ7D,EAAEuxD,GAAUv8C,OAGxB,QAAsB,IAAXohG,EAAwB,CAC/B,IAAI/oB,GAAaltF,GAAMi2G,EAAQ3vG,MAAS5C,GACxCjB,EAAKgyC,SAASy4C,GACdzqF,EAAKkyF,cAAgBzH,EAAS5mF,MAC9B7D,EAAKghE,gBAAgBypB,MAE1Bp6E,KAAK,eAOZ+rF,WAAY,SAAUrrD,EAAQ0iE,EAAKL,GAChB,KAAXriE,EACAqiE,EAAe7vG,KAAK,yCAAyC+B,KAAK,KAElE8tG,EAAe7vG,KAAK,yCAAyC6B,KAAK,KAGtEquG,EAAI76D,OAAO,WACP,IAAI0jD,EAAkBl/F,EAAE6C,MAAMmS,OAAOgK,cACjCmgF,EAAiBxrD,EAAO30B,cAE5B,GAAIkgF,EAAgBnyF,QAAQoyF,IAAmB,EAC3C,OAAOn/F,EAAE6C,MAET7C,EAAE6C,MAAMmF,SAEbE,QAQP07D,gBAAiB,SAAUn9D,GACvB,IACI6O,EADOzS,KACQ0rE,aADR1rE,KAGF0S,WAAWqyC,cACO,IAAZ,IACPtyC,EAAQnP,KAAK,yBAAyBC,KAAKK,EAAMA,OAE7B,kBAAhBA,EAAMA,OAA6C,KAAhBA,EAAMA,MACzC6O,EAAQnP,KAAK,+BAA+B6B,KAAK,KAEjDsN,EAAQnP,KAAK,+BAA+B+B,KAAK,MAVlDrF,KAcF26B,KAAKxoB,KAAKvO,EAAMA,QAO7Bq+D,UAAW,WACP,IACIr+D,GAAStG,GAAG,GAAIsG,MAAM,IADf5D,KAEQ0rE,aAFR1rE,KAIN+xC,SAASnuC,GAJH5D,KAKN+gE,gBAAgBn9D,IAMzB0vG,yBAA0B,WACtB,IACI5gG,EADO1S,KACW0S,WADX1S,KAGF26B,MAAQjoB,EAAWqyC,UAHjB/kD,KAIF0S,WAAW9O,YAA2C,IAJpD5D,KAI8B0S,WAAgB,OACxB,KALtB1S,KAKF0S,WAAW9O,MAAMtG,IACtBH,EAAE,mBANK6C,KAMqB0S,WAAW9O,MAAMtG,GANtC0C,KAM+CqzG,eAAehyG,SAAS,gBAOtF+kE,kBAAmB,WACJpmE,KAGNsN,UAOT65E,iBAAkB,WAEd,OADWnnF,KACCiyF,iBCjRpBplF,OAAO23D,UAAUivC,YAAYhtG,OAAO,+BAAgCoG,OAAO23D,UAAUhmB,OAAOk1D,KAAKvlG,WAEjGtB,OAAO23D,UAAUivC,YAAYhtG,OAAO,gCAChCw1F,kBAAmB,GACnB0X,kBAAmB,EACnBC,sBAMAp/B,aAAc,WAEVx0E,KAAKsN,UAGTwlE,iBAAkB,WACV9yE,KAAK0S,WAAWqyC,SAChB/kD,KAAKomE,oBAELpmE,KAAKksE,6BAIb9F,kBAAmB,WACf,IAAIuM,EAAW3yE,KAAK0rE,aACpBvuE,EAAE,yBAA0Bw1E,GACvBlmE,GAAG,QAASzM,KAAK6zG,cAAc7uG,KAAKhF,OAEzC7C,EAAE,0BAA2Bw1E,GACxBlmE,GAAG,QAAS,oBAAqBzM,KAAK8zG,kBAAkB9uG,KAAKhF,OAC7DyM,GAAG,QAAS,0BAA2BzM,KAAK+zG,uBAAuB/uG,KAAKhF,QAMjFksE,0BAA2B,WACvB,IAAIyG,EAAW3yE,KAAK0rE,aAEpBvuE,EAAE,0BAA2Bw1E,GACxBlmE,GAAG,QAAS,0BAA2BzM,KAAK+zG,uBAAuB/uG,KAAKhF,QAGjF8zG,kBAAmB,SAAUj3C,GACzB,IACI0+B,EADWp+F,EAAE0/D,EAAGniB,QACM78C,KAAK,MAG/BmC,KAAKy1F,eAAen4F,GAAIi+F,IACxBv7F,KAAKu8F,uBAGTwX,uBAAwB,SAAUl3C,GAC9B,IAAI98D,EAAOC,KAEPmB,EADWhE,EAAE0/D,EAAGhf,eACChgD,KAAK,SAEtBm2G,GADSj0G,EAAKu7F,oBACgBpsF,MAAM/N,GACpC9C,EAAW2B,KAAK8iE,cAAcvT,YAAY,yBAC1C0kD,EAAYj0G,KAAKk0G,kBAAkB71G,GACnC81G,WAAYH,EACZjvD,SAAUhlD,EAAK2S,WAAWqyC,WAG1BqvD,EAAej3G,EAAE,0BAA2B82G,GAEhDG,EAAa3nG,GAAG,mBAAoB,oBAAqB,SAAUowD,GAC/D98D,EAAK+zG,kBAAkBj3C,GACvBo3C,EAAUz0G,WAGdy0G,EAAUxnG,GAAG,YAAa,WACtB2nG,EAAanwC,IAAI,QAAS,oBAAqBlkE,EAAK+zG,kBAAkB9uG,KAAKjF,IAC3Ek0G,EAAUz0G,YAIlBq0G,cAAe,WAEX,IAAI9zG,EAAOC,KAEXD,EAAKsiD,MAAMuxD,oBACX,IAAIv1G,EAAW0B,EAAK+iE,cAAcvT,YAAY,wBAC1Czd,EAAS/xC,EAAKu7F,eACdj+F,GACAqxD,SAAU5c,EACVwjD,UAAW,SAAUh4F,GACjB,OAAOyC,EAAKy7F,cAActvF,KAAKlM,KAAM1C,KAI7C0C,KAAKoC,UAAU+F,KAAK,SAAUJ,GAC1B,IAAIlK,GACAs8C,YAAep6C,EAAK2S,WAAWynC,aAAe,GAC9Cr2C,YAAe/D,EAAK2S,WAAW5O,YAC/BqwG,WAAcpsG,EACd1K,QAAWA,GAEf,IAEI,IADA,IAAI21G,EAAoB/9E,MAAM52B,SAASA,GAAW66C,cAAc,IACvDp4C,EAAI,EAAGoE,EAAS4sC,EAAO5sC,OAAQpE,EAAIoE,EAAQpE,IAChDf,EAAKsiD,MAAMuxD,iBAAiB9hE,EAAOhxC,GAAGxD,IAAMw0C,EAAOhxC,GAEvD,IAAImyG,EAAY91G,EAAEA,EAAE+f,KAAK81F,EAAkBn1G,KAC3CkC,EAAKs0G,kBAAkBpB,GAEvBA,EAAU95D,sBACNpxB,MAAO,WACHhoB,EAAKi4D,qBAAqB,4BAC1Bh4D,KAAK2N,UACL3N,KAAKC,QAAQT,UAEjB45C,oBAAoB,EACpB7uB,OAAO,IAGXxqB,EAAKmzG,2BAA2BD,GAEhClzG,EAAKi4D,qBAAqB,yBAC1Bi7C,EAAU95D,qBAAqB,QACjC,MAAOlrC,GACLpB,OAAO6T,IAAIzS,EAAEyI,aAQzBw8F,2BAA4B,SAAUC,GAClC,IAAIpzG,EAAOC,KACPs0G,EAAiBnB,EAAe7vG,KAAK,4BACrC8vG,EAAwB,IAAIj2G,EAAE4S,SAGlCojG,EAAe7vG,KAAK,yCAAyC6B,KAAK,KAElEguG,EAAex/D,SAAS,2BAA4B,QAAS,WACzDy/D,EAAsB9gD,SACtB6gD,EAAet1G,KAAK,wBAAwBkqB,UAIhDorF,EAAe7vG,KAAK,wCAAwC0B,KAAK,iBAAkB,WAC5D,KAAfhF,KAAK4D,MACLuvG,EAAe7vG,KAAK,yCAAyC+B,KAAK,MAElE8tG,EAAe7vG,KAAK,yCAAyC6B,KAAK,KAClEhI,EAAE,yDAA0Dg2G,GAAgB9tG,QAIhFtF,EAAKo8F,WAAWn8F,KAAK4D,MAAO0wG,KAC7BjtE,MAAM,WACL8rE,EAAe7vG,KAAK,sCAAsCjC,SAAS,eACpE0uC,KAAK,WACJojE,EAAe7vG,KAAK,sCAAsCuiB,YAAY,eAI1EstF,EAAe7vG,KAAK,yCAAyC0B,KAAK,QAAS,WACvE7H,EAAE,yDAA0Dg2G,GAAgB9tG,OAC5E8tG,EAAe7vG,KAAK,wCAAwC8L,IAAI,IAChEjS,EAAE6C,MAAMmF,KAAK,OAIjBguG,EAAex/D,SAAS,0BAA2B,QAAS,WACxDy/D,EAAsBjjG,UACtBgjG,EAAet1G,KAAK,wBAAwBkqB,UAGhDorF,EAAe7vG,KAAK,0BAA0B0B,KAAK,QAAS,WACxDouG,EAAsB9gD,SACtB6gD,EAAet1G,KAAK,wBAAwBkqB,UAIhDorF,EAAe7vG,KAAK,sCAAsCmJ,GAAG,QAAS,mCAAoC,WACtG1M,EAAKg6B,WAAW58B,EAAE6C,OAAO,GAEzB,IAAIkpC,EAAOiqE,EAAe7vG,KAAK,wCAAwC8L,MAGvErP,EAAKo8F,WAAWjzD,EAAMorE,KAG1Bn3G,EAAEqM,KAAK4pG,GAAuBjrG,KAAK,WAC/BpI,EAAKw0G,sBACLx0G,EAAKsiD,MAAMuxD,sBACZxjG,KAAK,WACJrQ,EAAKsiD,MAAMuxD,uBAOnBW,oBAAqB,WACjB,IAGIC,KAEJr3G,EAAE0D,KALSb,KAKCqiD,MAAMuxD,iBAAkB,SAAU9yG,EAAGm0E,GAC7Cu/B,EAAU5rG,KAAKqsE,KANRj1E,KASN+xC,SAASyiE,GATHx0G,KAUNu8F,uBAMTzwB,mBAAoB,WAEhB9rE,KAAKsN,UAMTivF,oBAAqB,WACjB,IACI5pB,EADO3yE,KACS0rE,aAChB55B,EAFO9xC,KAEOs7F,eACdmZ,EAAc3iE,EAAO5sC,OACrB02F,EAAiBz+F,EAAE,0BAA2Bw1E,GAC9C5tB,EAAW/kD,KAAK0S,WAAWqyC,SAG/B,GAFA62C,EAAe35F,QAEXwyG,EAAc,EAId,IAFA,IAAIp2G,EAAW2B,KAAK8iE,cAAcvT,YAAY,wBAErCzuD,EAAI,EAAGA,EAAI2zG,EAAa3zG,IAAK,CAClC,IAAImoC,EAAO6I,EAAOhxC,GACdjD,GAAQP,GAAI2rC,EAAK3rC,GAAIsG,MAAOqlC,EAAKrlC,MAAOmhD,SAAUA,GAClD2vD,EAAkBz/E,MAAM52B,SAASA,GAAW66C,cAAc,IAC1Dy7D,EAAcx3G,EAAEA,EAAE+f,KAAKw3F,EAAgB72G,KAO3C,GALA+9F,EAAeh6F,OAAO+yG,GAGtB30G,KAAKsyE,qBAAqBtyE,KAAK0S,WAAW02D,kBAErCppE,KAAK27F,gBAAgBC,GAAiB,CAEvCA,EACKv4F,WACA00C,OACAv4C,SAGD3B,GACA+F,MAAS6wG,EAAc3zG,EACvBK,MAASL,GAFb,IAKI8zG,EAAmB3/E,MAAM52B,SAAS2B,KAAK8iE,cAAcvT,YAAY,+BAAgCrW,cAAc,IAC/G27D,EAAY13G,EAAEA,EAAE+f,KAAK03F,EAAiB/2G,KAC1C+9F,EAAeh6F,OAAOizG,GACtB,SAOhBR,kBAAmB,SAAUS,GACzB,IAAI/0G,EAAOC,KACPs0G,EAAiBQ,EAAkBxxG,KAAK,4BACxCyxG,EAAWT,EAAehxG,KAAK,wBAEnCwxG,EAAkBxxG,KAAK,iCAAiC0B,KAAK,kCAAmC,SAAUy1C,GACtGA,EAAIvG,kBAEJn0C,EAAKo8F,WAAWn8F,KAAK4D,MAAO0wG,KAGhCS,EAASlnE,OAAO,WACZ,IAAIwkD,EAAWl1F,EAAE6C,MACbs1F,EAAYjD,EAASjvF,GAAG,YACxBonF,GAAYltF,GAAI+0F,EAASx0F,KAAK,MAAO+F,MAAOyuF,EAASx0F,KAAK,UAE1Dy3F,EACAv1F,EAAKi1G,mBAAmBxqB,GAAU,GAElCzqF,EAAKi1G,mBAAmBxqB,GAAU,KAI1CsqB,EAAkBroG,GAAG,YAAa,WAC9B1M,EAAKk1G,iBAEL93G,EAAEgU,UAAUgW,OAAO,4BAI3B6tF,mBAAoB,SAAU/0G,EAASi1G,GAE/BA,SADOl1G,KAEKqiD,MAAMuxD,iBAAiB3zG,EAAQ3C,IAFpC0C,KAIFqiD,MAAMuxD,iBAAiB3zG,EAAQ3C,IAAM2C,GAIlDi0G,kBAAmB,SAAU71G,EAAUR,GACnC,IACI80E,EADO3yE,KACS0rE,aAChB+nC,EAAct2G,EAAE,kBAAmBw1E,GAEnCwiC,EAAoBxiC,EAAS5/B,QAAQ,6BACrCigE,EAAoB/9E,MAAM52B,SAASA,GAAW66C,cAAc,IAC5Dk8D,EAAaj4G,EAAEA,EAAE+f,KAAK81F,EAAkBn1G,KACxCw3G,EAAe5B,EAAYz2F,QA2B/B,OAzBAm4F,EAAkBvzG,OAAOwzG,GAEzBA,EAAWp4F,MAAMq4F,GAEjBD,EAAWjwE,UACPmwE,GAAI,WACJC,GAAI,cACJC,GAAI/B,EACJgC,UAAW,QACZtwG,OAGHiwG,EAAW/vG,OAGX+vG,EAAW3oG,GAAG,YAAa,SAAUowD,GAEjC,OADAA,EAAGhpB,kBACI,IAIX12C,EAAEgU,UAAUkoD,IAAI,wBAAyB,SAAU5e,GAC/C26D,EAAWnwG,QAAQ,eAGhBmwG,KCzVfvoG,OAAO23D,UAAUkxC,MAAMjvG,OAAO,6BAI1B+tE,aAAc,WACV,IAAIz0E,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACjB3jE,EAAW/S,EAAE4S,WAqCjB,OAnCAhQ,EAAK+zE,oBAAoB3uE,OACzBhI,EAAEqM,KAAKzJ,EAAKorE,iBAAiBhjE,KAAK,WAC9BpI,EAAKwuB,MAAQxuB,EAAKmnF,MAAQ/pF,EAAE,sBAAuB4C,EAAK2rE,cAEpD3rE,EAAK6D,OACL7D,EAAKgyC,SAAShyC,EAAK6D,OAAO,GAE1B8O,EAAWqyC,UACXljC,EAAUxgB,SAAS,0BAEnBtB,EAAKwuB,MAAMsf,OAAO,WACd,IAAI8nE,EAAgB51G,EAAKwuB,MAAMjrB,KAAK,uBACpCvD,EAAKwuB,MAAMjrB,KAAK,YAAYuiB,YAAY,WACxC9lB,EAAKwuB,MAAMjrB,KAAK,aAAajC,SAAS,gBAAgBwkB,YAAY,YAElE8vF,EAAc5iE,QAAQ,OAAO1xC,SAAS,WACtCs0G,EAAct0G,SAAS,YACvBs0G,EAAc9vF,YAAY,gBAE1B,IAAI2kE,GAAaltF,GAAIq4G,EAAcrrE,KAAK,SAAU1mC,MAAO+xG,EAAcv4E,SAASjrB,QAChFpS,EAAKgyC,SAASy4C,OAOlB3oE,EAAUxgB,SAAS,sBACnBtB,EAAKwuB,MAAQxuB,EAAKmnF,MAAQnnF,EAAK2rE,aAAanoE,KAAK,yEAA2ED,KAAK,SAGrI4M,EAASC,YAIND,EAAS3H,WAKpBw4D,gBAAiB,SAAUn9D,GACvB,IACI8O,EADO1S,KACW0S,WAEtB,QAAcxK,IAAVtE,GAAmC,MAAZA,EAAMtG,GAC7B,GAAIoV,EAAWqyC,SAAU,CAErB,IAAI6wD,EAND51G,KAMkBuuB,MAAMjrB,KAAK,8BAAgCM,EAAMtG,GAAK,MAC3Es4G,EAAUtrE,KAAK,UAAW,WAC1BsrE,EAAU7iE,QAAQ,OAAO1xC,SAAS,WAClCu0G,EAAUv0G,SAAS,YAAYwkB,YAAY,qBATxC7lB,KAYEuuB,MAAMhrB,KAAMK,EAAMA,MAAQA,EAAMA,MAAMkN,WAAa,IAZrD9Q,KAaEuuB,MAAMjtB,KAAK,KAAMsC,EAAMtG,KAQxC2kE,UAAW,WACP,IACIr+D,GAAUtG,GAAI,GAAI0D,MAAO,IADlBhB,KAEaC,QAAQqD,KAAK,YAAYuiB,YAAY,WAEhDviB,KAAK,qBAAqBgnC,KAAK,WAAW,GAAOzkB,YAAY,YAAYxkB,SAAS,gBAJpFrB,KAKN+xC,SAASnuC,GAAO,GALV5D,KAMN+gE,gBAAgBn9D,MC/E7BiJ,OAAO23D,UAAUqxC,eAAepvG,OAAO,sCAEnC+Q,KAAM,SAASnM,GACX,IAAItL,EAAOC,KACXD,EAAKuN,OAAOjC,GACZrL,KAAK0S,WAAW7U,KAAOmC,KAAK0S,WAAW7U,SAEvCkC,EAAKiF,KAAK,SAAU,SAAU8wG,EAAIlyG,GAC9B7D,EAAKg2G,cAAcnyG,MAM3BwnE,eAAgB,WACZ,OAAOv+D,OAAO23D,UAAU0iB,MAAM/4E,UAAUi9D,eAAeh9D,MAAMpO,KAAMqO,YAMvEmmE,aAAc,WACV,IAAIz0E,EAAOC,KACXD,EAAKuN,SAEL,IAAI4sF,EAAcn6F,EAAKkmF,iBAEH,OAAhBiU,GAAuD,kBAA/BA,EAAYxnF,WAAWzI,OAC/ClK,EAAKimF,aAAc,EACnBkU,EAAYD,WAAWrxF,KAAK7I,GACL,MAAnBA,EAAK4S,WACL5S,EAAK2S,WAAWsjG,iBAAmBj2G,EAAK4S,WAAWrV,GAEnDyC,EAAKo6F,4BAA6B,GAI1Cp6F,EAAKk2G,iBAAkB,EACvB94G,EAAEqM,KAAKqD,OAAO23D,UAAU0iB,MAAM/4E,UAAUqmE,aAAapmE,MAAMrO,EAAMsO,YAC5DlG,KAAK,WACEpI,EAAK6D,OAA6B,GAApB7D,EAAKimF,aACnBjmF,EAAK+5D,eAAe,SAAU/5D,EAAK6D,OAEvC7D,EAAKk2G,iBAAkB,KAOnCnjC,iBAAkB,WACdjmE,OAAO23D,UAAU0iB,MAAM/4E,UAAU2kE,iBAAiB1kE,MAAMpO,KAAMqO,YAGlE6kE,cAAe,WACXrmE,OAAO23D,UAAU0iB,MAAM/4E,UAAU+kE,cAAc9kE,MAAMpO,KAAMqO,YAM/D6nG,eAAgB,WACZrpG,OAAO23D,UAAU0iB,MAAM/4E,UAAU+nG,eAAe9nG,MAAMpO,KAAMqO,YAGhE6kG,2BAA4B,WACxBrmG,OAAO23D,UAAU0iB,MAAM/4E,UAAU+kG,2BAA2B9kG,MAAMpO,KAAMqO,YAG5E8tF,WAAY,WACRtvF,OAAO23D,UAAU0iB,MAAM/4E,UAAUguF,WAAW/tF,MAAMpO,KAAMqO,YAG5DilG,yBAA0B,WACtBzmG,OAAO23D,UAAU0iB,MAAM/4E,UAAUmlG,yBAAyBllG,MAAMpO,KAAMqO,YAM1E0yD,gBAAiB,WACbl0D,OAAO23D,UAAU0iB,MAAM/4E,UAAU4yD,gBAAgB3yD,MAAMpO,KAAMqO,YAGjE0jC,SAAU,SAAUnuC,EAAOwpE,GAEvBA,OAAkCllE,IAAlBklE,GAA8BA,EAEhC,KAAVxpE,IACAA,GAAUtG,GAAI,GAAIsG,MAAO,KAGvBA,IACiB,OARZ5D,KAQE4D,OARF5D,KAQyB4D,MAAMtG,KAAOsG,EAAMtG,IAR5C0C,KASE85D,eAAe,SAAUl2D,GAGlC5D,KAAKsN,OAAO1J,EAAOwpE,KAS3B4a,kBAAmB,SAAU1qF,GACzB,OAAQ0C,KAAK0S,WAAW7U,UAAYyF,KAAK,SAAS2K,GAC9C,OAAOA,EAAE3Q,IAAMA,KAOvB2kE,UAAW,WACPp1D,OAAO23D,UAAU0iB,MAAM/4E,UAAU8zD,UAAU7zD,MAAMpO,KAAMqO,YAM3DyxB,UAAW,WACPjzB,OAAO23D,UAAU0iB,MAAM/4E,UAAU2xB,UAAU1xB,MAAMpO,KAAMqO,YAG3D8nG,iBAAkB,SAASt4G,GACvBgP,OAAO23D,UAAU0iB,MAAM/4E,UAAUgoG,iBAAiB/nG,MAAMpO,KAAMqO,YAGlEy5E,cAAe,SAASlkF,GACpBiJ,OAAO23D,UAAU0iB,MAAM/4E,UAAU25E,cAAc15E,MAAMpO,KAAMqO,YAM/D84E,iBAAkB,WACd,OAAOt6E,OAAO23D,UAAU0iB,MAAM/4E,UAAUg5E,iBAAiBj7E,KAAKlM,KAAMqO,YAMxE0nG,cAAe,SAAUvrB,GACrB,IAAIzqF,EAAOC,KACXD,EAAKkyF,cAAgBzH,EAAS5mF,MAC9B,IAAIyH,KACJA,EAAOtL,EAAKsiD,MAAMI,2BAA6B,UAAY+nC,EAASltF,GAEpEH,EAAE0D,KAAKb,KAAKi6F,WAAY,SAASl5F,EAAKg6F,GAClCA,EAAUroF,WAAWrH,OAASA,EAC9B0vF,EAAUroF,WAAWsjG,iBAAmBxrB,EAASltF,GAE9B,IAAfktF,EAASltF,IACTy9F,EAAUj7D,YACVi7D,EAAUh6B,iBAAkBzjE,GAAI,GAAIsG,MAAO,MAE3CzG,EAAEqM,KAAKuxF,EAAU34F,QAAQiJ,IAASlD,KAAK,SAAUtK,GAE7C,GADAk9F,EAAUroF,WAAW7U,KAAOA,EACJ,OAApBk9F,EAAUn3F,MAAe,CACzB,IAAI8qD,EAAWqsC,EAAU/S,kBAAkB+S,EAAUn3F,MAAMtG,IACvDoxD,EACmB,IAAfA,EAASpxD,IAAayC,EAAK6D,OAA6B,IAApB7D,EAAK6D,MAAMA,OAC/Cm3F,EAAUj7D,YACVi7D,EAAUh6B,iBAAkBzjE,GAAI,GAAIsG,MAAO,MAE3Cm3F,EAAUjhC,eAAe,SAAUpL,IAIvCqsC,EAAUh6B,iBAAkBzjE,GAAI,GAAIsG,MAAO,KAC3Cm3F,EAAUjhC,eAAe,UAAYx8D,GAAI,GAAIsG,MAAO,WAGxDm3F,EAAUjhC,eAAe,UAAYx8D,GAAI,GAAIsG,MAAO,UAQxE0iF,gBAAiB,WACb,MAAO,WCtLfz5E,OAAO23D,UAAU0iB,MAAMzgF,OAAO,6BAM1B2kE,eAAgB,WACDprE,KACOsN,SADlB,IAEIjP,EAFO2B,KAES8iE,cAAcvT,YAAY,iBAC9C,OAAOpyD,EAAEy8C,UAAUv7C,OAMvBm2E,aAAc,WACV,IAAIz0E,EAAOC,KAEXD,EAAKuN,SAEL,IAAIoF,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACjBphE,EAAU1S,EAAK2rE,aACfrgE,KAGJtL,EAAKq2G,kBAAmB,EAGxBr2G,EAAKwuB,MAAQpxB,EAAE,uBAAwBsV,GACnCC,EAAWsjG,kBAAmD,MAA/BtjG,EAAWsjG,mBAC1C3qG,EAAOtL,EAAKsiD,MAAMI,2BAA6B,UAAY/vC,EAAWsjG,iBAGtEj2G,EAAKq2G,iBAAmBr2G,EAAKm6F,aAAen6F,EAAKm6F,YAAYt2F,OAA0C,KAAjC7D,EAAKm6F,YAAYt2F,MAAMA,OAAgB7D,EAAK2S,WAAW9O,OAAS7D,EAAK2S,WAAW9O,MAAMA,OAG3J8O,EAAWqyC,cAQwB,IAAzBhlD,EAAKk2G,iBAAoCl2G,EAAKk2G,gBAQrDl2G,EAAKm2G,iBAPL/4G,EAAEqM,KAAKzJ,EAAKomF,YAAY96E,IAASlD,KAAK,SAAU5E,GAC5CxD,EAAK2rE,aAAanoE,KAAKA,GACvBxD,EAAKwuB,MAAQxuB,EAAKmnF,MAAQnnF,EAAK2rE,aAC/B3rE,EAAKm2G,iBACLn2G,EAAK6rE,eAAc,EAAO7rE,EAAK2S,WAAW02D,oBAZlDrpE,EAAKs2G,UAAYl5G,EAAE,cAAesV,GAClCoP,EAAUxgB,SAAS,6CAED,MAAdtB,EAAK6D,OACL7D,EAAKs2G,UAAUlkG,KAAKpS,EAAK6D,MAAMA,OAAS7D,EAAK6D,MAAMtG,MAmB/Dw1E,iBAAkB,WACd,IACIpgE,EADO1S,KACW0S,WAClBmP,EAFO7hB,KAEU6zE,qBAEjBnhE,EAAWqyC,UACXljC,EAAUxgB,SAAS,0BALZrB,KAQNsN,UAGT4lE,cAAe,aAKfgjC,eAAgB,WACZ,IAAIn2G,EAAOC,KAEXD,EAAKs2G,UAAYt2G,EAAKwuB,MAAMjrB,KAAK,wBACjCvD,EAAKs2G,UAAU9yG,KAAKpG,EAAE,kBAAmB4C,EAAKwuB,OAAOpc,QACrDpS,EAAKs2G,UAAUjnG,IAAIjS,EAAE,kBAAmB4C,EAAKwuB,OAAOpc,QAEpDhV,EAAE,yBAA0B4C,EAAK2rE,cAAcvkD,SAASniB,KAAK,QAAS,WAElEjF,EAAKwuB,MAAMjrB,KAAK,wBAAwBysC,OACxC5yC,EAAE4C,EAAKwuB,OAAOwhB,OAEdhwC,EAAKwuB,MAAMjtB,KAAK,WAAY,WAG5BvB,EAAKo2G,iBAAiBp2G,EAAK2S,WAAW7U,MACtC,IAAIQ,EAAW0B,EAAK+iE,cAAcvT,YAAY,kBAC1CyjD,EAAoB/9E,MAAM52B,SAASA,GAAY66C,cAAc,IAC7Dr7C,GACA+O,MAAS7M,EAAK2S,WAAW7U,KACzBs8C,YAAep6C,EAAK2S,WAAWynC,aAAe,GAC9Cr2C,YAAe/D,EAAK2S,WAAW5O,aAG/BmvG,EAAY91G,EAAEA,EAAE+f,KAAK81F,EAAkBn1G,KAE3Co1G,EAAU95D,sBACNpxB,MAAO,WACHhoB,EAAKi4D,qBAAqB,4BAE1Bh4D,KAAK2N,UACL3N,KAAKC,QAAQT,UAEjB45C,oBAAoB,EACpB7uB,OAAO,IAGXxqB,EAAKmzG,2BAA2BD,GAEhClzG,EAAKi4D,qBAAqB,yBAC1Bi7C,EAAU95D,qBAAqB,WAIvCg9D,iBAAkB,SAASt4G,GACvB,IAAIkC,EAAOC,KAEXnC,EAAK88D,QAAQ,SAAS/2D,GAClB7D,EAAK+nF,cAAclkF,MAI3BkkF,cAAe,SAASlkF,GAGpB,GAAiBsE,MAAZtE,EAAMtG,KAA0C,iBAAbsG,EAAMtG,IAAgC,OAAbsG,EAAMtG,IAAqC,iBAAbsG,EAAMtG,IAAmBsG,EAAMtG,GAAG4H,OAAS,GAAK,CAE3I,GAAoB,OAAhBtB,EAAMA,OAAyC,kBAAhBA,EAAMA,OACxB,GACiC,IAA1CiJ,OAAOY,KAAKuF,aAAapP,EAAMA,OAC/BA,EAAMA,MAAQiJ,OAAOC,aAAaC,YAAY,uBACG,IAA1CF,OAAOY,KAAKuF,aAAapP,EAAMA,SACtCA,EAAMA,MAAQiJ,OAAOC,aAAaC,YAAY,2BAE/C,GAAmB,MAAfnJ,EAAMA,OAAwC,iBAAhBA,EAAMA,MAC3C,IAAK,IAAI9C,EAAI,EAAGoE,EAAStB,EAAMA,MAAMsB,OAAQpE,EAAIoE,EAAQpE,IAC/B,MAAlB8C,EAAMA,MAAM9C,IAA0C,kBAApB8C,EAAMA,MAAM9C,MACG,IAA7C+L,OAAOY,KAAKuF,aAAapP,EAAMA,MAAM9C,IACrC8C,EAAMA,MAAM9C,GAAK+L,OAAOC,aAAaC,YAAY,uBACG,IAA7CF,OAAOY,KAAKuF,aAAapP,EAAMA,MAAM9C,MAC5C8C,EAAMA,MAAM9C,GAAK+L,OAAOC,aAAaC,YAAY,yBAWzEmmG,2BAA4B,SAAUC,GAClC,IAAIpzG,EAAOC,KAEPozG,EAAwB,IAAIj2G,EAAE4S,SAG9B8R,EAAYsxF,EAAe7vG,KAAK,oCAGpC6vG,EAAe7vG,KAAK,yCAAyC6B,KAAK,KAElEguG,EAAex/D,SAAS,2BAA4B,QAAS,WACzDy/D,EAAsB9gD,SACtB6gD,EAAet1G,KAAK,wBAAwBkqB,UAIhDorF,EAAe7vG,KAAK,wCAAwC0B,KAAK,gCAAiC,WAC9FjF,EAAKo8F,WAAWn8F,KAAK4D,MAAOie,EAAWsxF,KAI3CA,EAAe7vG,KAAK,yCAAyC0B,KAAK,QAAS,WACvEjF,EAAKo8F,WAAW,GAAIt6E,EAAWsxF,GAC/BA,EAAe7vG,KAAK,wCAAwC8L,IAAI,IAChEjS,EAAE6C,MAAMmF,KAAK,OAIjBpF,EAAK46B,KAAOx9B,EAAE,gCAAiCg2G,GAC/CpzG,EAAKuzG,yBAAyBvzG,EAAK2S,WAAW9O,QAAS,GAEvD7D,EAAKs2G,UAAYlD,EAAe7vG,KAAK,wBACrCvD,EAAKs2G,UAAU9yG,KAAKpG,EAAE,iBAAkB4C,EAAK46B,MAAMxoB,QACnDpS,EAAKs2G,UAAUjnG,IAAIjS,EAAE,iBAAkB4C,EAAK46B,MAAMxoB,QAElDpS,EAAK46B,KAAKr3B,KAAK,MAAM0B,KAAK,QAAS,WAC/BjF,EAAK46B,KAAKr3B,KAAK,MAAMq1C,OAAO,WACxB,GAAIx7C,EAAE6C,MAAMiyC,SAAS,eACjB,OAAO90C,EAAE6C,QAEd6lB,YAAY,eAEf1oB,EAAE6C,MAAMqB,SAAS,eACjBtB,EAAKwuB,MAAMwhB,OACX5yC,EAAE,uCAAwCg2G,GAAgBpjE,SAG9DojE,EAAex/D,SAAS,0BAA2B,QAAS,WACxDy/D,EAAsBjjG,UACtBgjG,EAAet1G,KAAK,wBAAwBkqB,UAGhDorF,EAAe7vG,KAAK,0BAA0B0B,KAAK,QAAS,WACxDouG,EAAsB9gD,SACtB6gD,EAAet1G,KAAK,wBAAwBkqB,UAGhD5qB,EAAEqM,KAAK4pG,GAAuBjrG,KAAK,WAC/B,IAAIumD,EAAWvxD,EAAE,iBAAkB4C,EAAK46B,MAKpC6vD,GAAaltF,GAJLH,EAAEuxD,GAAU7wD,KAAK,SAID+F,MAHhBzG,EAAEuxD,GAAUv8C,QAIxBpS,EAAKkyF,cAAgBzH,EAAS5mF,MAC9B7D,EAAKghE,gBAAgBypB,KAEtBp6E,KAAK,eAQZ+rF,WAAY,SAAUrrD,EAAQ0iE,EAAKL,GAChB,KAAXriE,EACAqiE,EAAe7vG,KAAK,yCAAyC+B,KAAK,KAElE8tG,EAAe7vG,KAAK,yCAAyC6B,KAAK,KAGtEquG,EAAI76D,OAAO,WACP,IAAI0jD,EAAkBl/F,EAAE6C,MAAMmS,OAAOgK,cACjCmgF,EAAiBxrD,EAAO30B,cAE5B,GAAIkgF,EAAgBnyF,QAAQoyF,IAAmB,EAC3C,OAAOn/F,EAAE6C,MAET7C,EAAE6C,MAAMmF,SAEbE,QAMPiuG,yBAA0B,SAAU1vG,GACrB5D,KACW0S,WAEPqyC,UAAanhD,GAAD,MAAiB,GAA2D,KAAbA,EAAMtG,IAHrF0C,KAIF26B,KAAKr3B,KAAK,mBAAqBM,EAAMtG,IAAI+D,SAAS,gBAO/D0/D,gBAAiB,SAAUn9D,GACrB,GAAIA,GAA2B,iBAAVA,QAA6C,IAAhBA,EAAM5C,MAAwB,CAC5E,IAAIs1G,EAA6B,IAAf1yG,EAAM5C,OAAgB6L,OAAOY,KAAK0S,UAAUvc,EAAM5C,OAA0BhB,KAAKgoF,kBAAkBpkF,EAAMA,OAAOA,OAAS,GAA7DA,EAAM5C,MAEhF7D,EAAE4iB,QAAQu2F,KACdA,EAAaA,EAAW59F,KAAK,QAG7B9U,GAAWtG,GAAIsG,EAAMA,MAAOA,MAAO0yG,GAGzC,IAAI7jG,EAAUzS,KAAK0rE,aACnBvuE,EAAE,QAASsV,GAASrD,IAAIpP,KAAK+oC,WAAWnlC,EAAMA,QAG9C5D,KAAK+xC,SAASnuC,IAGlBk8B,UAAW,WACP,IACIptB,EADO1S,KACW0S,WAEtBA,EAAWmzE,cAAe,EAC1BnzE,EAAW7U,QACX6U,EAAWo0E,kBAAmB,GAOlC7kB,UAAW,WAEPjiE,KAAK+gE,iBADQzjE,GAAG,GAAIsG,MAAM,MAO9B0iF,gBAAiB,WACb,MAAO,WCzTfz5E,OAAO23D,UAAU+xC,oBAAoB9vG,OAAO,2CAE1C+tE,aAAc,WAEGx0E,KACU6zE,qBAEXxyE,SAAS,0BCN3BwL,OAAO23D,UAAU38D,OAAOpB,OAAO,8BAK3B+3C,OAAQ,WAGJ,OAFWx+C,KAECw0E,gBAOhBA,aAAc,WAEV,MAAuB,WADZx0E,KACF6jE,UACE,QAAUh3D,OAAOC,aAAaC,YAAY,6BAA+B,SAEzE,WAQf+lE,iBAAkB,WACd,IACIpgE,EADO1S,KACW0S,WADX1S,KAINsN,cAGoBpF,IAArBwK,EAAW9O,OAPJ5D,KAQF+gE,gBAAgBruD,EAAW9O,QASxCm9D,gBAAiB,SAAUn9D,GACZ5D,KACN+xC,SAASnuC,GAAO,MChD7BiJ,OAAO23D,UAAUgyC,OAAO/vG,OAAO,2BAC3Bg8C,2BAA4B51C,OAAO2xC,OAAOC,SAAS8D,QAAQE,2BAC3DC,4BAA6B71C,OAAO2xC,OAAOC,SAAS8D,QAAQG,4BAC5D+zD,gBAAiB,GACjBC,MAAO,EACPC,eAAgB,aAAc,OAAQ,QAAS,MAAO,MAAO,OAC7DC,gBAAiB,MAAO,OAAQ,MAAO,OAAQ,MAAO,OAAQ,MAAO,MAAO,MAAO,OACnFC,iBAAkB,kBAAmB,YAAa,KAAM,OACxDC,iBAAkB,YAAa,QAAS,MAAO,SAO/C3rC,cAAe,WACX,IAAIprE,EAAOC,KACP3B,EAAW0B,EAAK+iE,cAAcvT,YAAY,UAC1CwnD,GAAe,EAEnBh3G,EAAKi3G,kBAEDnqG,OAAOY,KAAKk2B,uBACZozE,EAAeh3G,EAAKk3G,eAAiBl3G,EAAKk3G,aAAav1E,OAAS3hC,EAAKk3G,aAAaC,QAgBtF,IAZA,IAAI3zG,EAAOpG,EAAEy8C,UAAUv7C,GACnBwiB,MAAOhU,OAAOY,KAAKmT,YAAY7gB,EAAKwzF,kBACpCxuC,SAAUhlD,EAAK2S,WAAWqyC,UAAYgyD,EACtCpgB,QAA8B,IAApB52F,EAAKuyF,WACfykB,aAAcA,EACdI,sBAAuBp3G,EAAKo3G,sBAC5BC,cAAer3G,EAAKs3G,eACpBvkB,gBAAiB/yF,EAAK2S,WAAWogF,kBAIjClmF,EAAQ,GACH9L,EAAI,EAAGwxF,EAAavyF,EAAKuyF,WAAYxxF,EAAIwxF,EAAYxxF,IAAK,CAC/D,IAAImqB,GAAS3tB,GAAIyC,EAAKuzF,MAAMxyF,GAAG,GAAIopD,SAAUnqD,EAAKuzF,MAAMxyF,GAAG,IAE3D8L,GADW7M,EAAK62F,iBAAiB3rE,GAKrC,OADA1nB,EAAOxD,EAAK82F,iBAAiBtzF,EAAMqJ,IASvCgqF,iBAAkB,SAAU3rE,GACxB,IACIprB,EADOG,KACK6jE,UACZniC,EAFO1hC,KAEMs3G,eAAersF,EAAKi/B,UACjC7rD,EAHO2B,KAGS8iE,cAAcvT,YAAY,cAG1C7rC,EAAe,cAAT7jB,EAAuB,sBANtBG,KAMmDg3F,aAAa/rE,GAa3E,OAXW9tB,EAAEy8C,UAAUv7C,GACnBqlB,IAAKA,EACLge,MAAOA,EACPikB,YAXO3lD,KAWW0S,WAAWizC,YAC7BZ,SAZO/kD,KAYQ0S,WAAWqyC,SAC1BkyC,SAAUhsE,EAAKi/B,SACf5sD,GAAI2tB,EAAK3tB,GACTuC,KAAMA,EACN8jC,mBAAoB92B,OAAOY,KAAKk2B,wBAUxCmvC,iBAAkB,WACd,IAAI/yE,EAAOC,KACPu3G,EAAkBx3G,EAAK8zE,qBAE3B9zE,EAAKgzE,oBAELhzE,EAAKy3G,YAAcr6G,EAAE,0BAA2B4C,EAAK2rE,cAEhD3rE,EAAK2S,WAAWqyC,WAAYhlD,EAAK03G,8BAAiC5qG,OAAOY,KAAKk2B,sBAAyB92B,OAAOY,KAAK+vF,MAAMka,qBAC1H33G,EAAKy3G,YAAYryG,OAGhBpF,EAAK2S,WAAWqyC,WAAcl4C,OAAOY,KAAKk2B,sBAAyB92B,OAAOY,KAAK+vF,MAAMka,qBAGtFH,EAAgBl2G,SAAS,0BACzBtB,EAAK43G,sBAHLJ,EAAgBl2G,SAAS,sBAM7BtB,EAAK63G,mBAGTD,mBAAoB,WAChB,IAAI53G,EAAOC,KACP6hB,EAAY9hB,EAAK2rE,aACjBmsC,EAAY16G,EAAE,oBAAqB0kB,GAEnChV,OAAOY,KAAKk2B,sBAEZxmC,EAAE4C,EAAKy3G,aAAat9D,aAChB76C,QAASU,EAAKs3G,eACd18D,cAAe,SAAUvvC,GAED,IAAhBA,EAAOsgC,KACPmsE,EAAUpuF,QAEV1pB,EAAK+3G,mBAAmB1sG,EAAOsgC,OAGvCqsE,OAAQ,SAAU3sG,GACdrL,EAAKi4D,qBAAqB,0BAE9Bpd,cAAe,SAAUxvC,GACrBrL,EAAKi4D,qBAAqB,+BAKlC76D,EAAE,qCAAsC0kB,GAAWq4B,aAC/C76C,QAASwN,OAAOY,KAAK+vF,MAAMwa,0BAC3Br9D,cAAe,SAAUvvC,GACrByB,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKzJ,EAAKk4G,wBAAwB7sG,EAAOsgC,OAAOy8B,OAAO,WACrDt7D,OAAOk1E,QAAQ/jD,UAGvB+5E,OAAQ,SAAU3sG,GACdrL,EAAKi4D,qBAAqB,0BAE9Bpd,cAAe,SAAUxvC,GACrBrL,EAAKi4D,qBAAqB,gCAIlC76D,EAAE4C,EAAKy3G,aAAa/tF,MAAM,WACtBouF,EAAUpuF,UAIlBouF,EAAUprG,GAAG,QAAS,SAAUwB,GAC5BA,EAAEimC,oBAIN2jE,EAAUprG,GAAG,SAAU,WACnB,IACIyrG,EADOl4G,KACSszF,MAAM,GACtB6kB,EAAap4G,EAAKsiD,MAAMs0D,cAAcz+F,OAAOnY,EAAKsiD,MAAMu0D,eAAgB72G,EAAKsiD,MAAMy0D,gBAAiB/2G,EAAKsiD,MAAMw0D,iBAEnHqB,EAASE,SAJEp4G,KAIc4D,MAEzBiJ,OAAOk1E,QAAQzoD,QAEXzsB,OAAOY,KAAK+vF,MAAM6a,iBAAiBH,EAAUn4G,EAAK2S,aAAe7F,OAAOY,KAAK+vF,MAAM8a,eAAeJ,EAAUn4G,EAAK2S,WAAYylG,GAE7Hh7G,EAAEqM,KAAKzJ,EAAKuxD,kBAAkB4mD,IACzBr0F,KAAK,SAAU9b,GACZhI,EAAKw4G,sBAAsBx4G,EAAM4c,KAAKhE,MAAMM,mBAAmBlR,OAChEqI,KAAK,SAAUurB,GACW,iBAArBA,EAAM68E,YAAoE,OAAnC78E,EAAM68E,WAAW/nG,eACxD5D,OAAOwtE,eAAet6E,EAAKgN,YAAY,6CAE5Co7D,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,SAGvBnxB,OAAOk1E,QAAQ/jD,OAInB7gC,EAzBW6C,MAyBHoP,IAAI,MAIhBrP,EAAK04G,gBAGL14G,EAAK24G,uBAOTd,gBAAiB,WACb,IAAI73G,EAAOC,KAGX7C,EAAE,WAAY4C,EAAK2rE,cAAcj/D,GAAG,QAAS,gCAAiC,WAC1EI,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMh4D,aAAaroC,EAAE6C,MAAMsB,KAAK,YAAatB,KAAK/B,QAAQmS,KAAK,SAAUurB,GACxF57B,EAAK44G,uBAAuBh9E,KAC7BwsC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,YAS3B06E,oBAAqB,WACjB,IAAI34G,EAAOC,KAEX7C,EAAE,4BAA6B4C,EAAK2rE,cAAcj/D,GAAG,QAAS,WAC1D,IAAIw8B,EAAO9rC,EAAE6C,MAAMo9B,OAAO,iCACtBnS,EAAOge,EAAKprC,OAChBV,EAAEqM,KAAKzJ,EAAKm3F,iBAAiBjuD,EAAMhe,EAAK3tB,KACnC6K,KAAK,WAEF8gC,EAAK9jC,OACL8jC,EAAKzpC,SAGLO,EAAKgyC,SAAShyC,EAAKuzF,OAAO,GAG1BvzF,EAAK04G,gBAGL14G,EAAKsoE,2BAUrByvC,mBAAoB,SAAUzhC,GAC1B,IAAIt2E,EAAOC,KAGX,OAFqBq2E,GAAW,GAG5B,KAAK,EACDz4D,UAAUg7F,OAAOC,WAAW,SAAUl3E,GAClC5hC,EAAK4hC,UAAYA,EACjB,IAAIw2E,EAAap4G,EAAKsiD,MAAMs0D,cAAcz+F,OAAOnY,EAAKsiD,MAAMw0D,iBAC5DhqG,OAAOk1E,QAAQzoD,QAEfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMsb,aAAan3E,EAAW5hC,EAAK2S,aACjDmR,KAAK,WAEF,OAAO1mB,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMub,gBAAgBh5G,EAAK4hC,YAChD9d,KAAK,SAAUm1F,GAEZ,GADAj5G,EAAK43F,eAAiBqhB,EAClBnsG,OAAOY,KAAK+vF,MAAM8a,eAAeU,EAAUj5G,EAAK2S,WAAYylG,GAAa,CACzE,IAAKtrG,OAAOY,KAAK42B,YACb,OAAOlnC,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMyb,yBAAyBp1F,KAAK,SAAUq1F,GAChE,GAAIA,GAAersG,OAAOY,KAAK+vF,MAAMwa,0BAA0B9yG,OAC3D,OAAOnF,EAAKk4G,wBAAwBiB,KAMhD/7G,EAAE,qCAAsC4C,EAAK8zE,sBAAsBpqD,aAIpF0+C,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAExBj+B,EAAKo5G,OAAOn0G,KAAKjF,IAChBq5G,QAASr5G,EAAKsiD,MAAMo0D,gBACpB4C,WAAYC,OAAOC,kBAAkBC,eAEzC,MACJ,KAAK,EACD57F,UAAUg7F,OAAOC,WAAW,SAAUl3E,GAClC90B,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMsb,aAAan3E,EAAW5hC,EAAK2S,aACjDmR,KAAK,WACF,OAAO1mB,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMub,gBAAgBp3E,IAAY9d,KAAK,SAAUm1F,GAEvE,OADAj5G,EAAK43F,eAAiBqhB,EACfj5G,EAAK05G,UAAU15G,EAAM4hC,OAEjCwmC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAGvBj+B,EAAKo5G,OAAOn0G,KAAKjF,IAEbq5G,QAASr5G,EAAKsiD,MAAMo0D,gBACpB4C,WAAYz7F,UAAUg7F,OAAOW,kBAAkBG,OAC/CC,UAAW/7F,UAAUg7F,OAAOgB,UAAUC,QACtCC,gBAAiBR,OAAOS,gBAAgBC,SACxCC,oBAAoB,EACpBC,YAAa,KACbC,aAAc,MAEtB,MACJ,KAAK,EACDv8F,UAAUoG,OAAOo2F,QAAQC,aAAa,SAAUC,GAC5CztG,OAAOk1E,QAAQzoD,QAEfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAM+c,kBAAkBD,EAAWv6G,EAAK2S,aACtDmR,KAAK,WACF,OAAO9jB,EAAKy6G,UAAUz6G,EAAMu6G,KAC7BnyC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAExBj+B,EAAKo5G,OAAOn0G,KAAKjF,IAAS06G,MAAO16G,EAAKsiD,MAAMq0D,UAU3DuB,wBAAyB,SAAU5hC,GAC/B,IAAIt2E,EAAOC,KACP06G,EAAiBrkC,GAAW,EAGhC,GAAIqkC,IAAmB7tG,OAAOY,KAAK+vF,MAAMmd,eAAeC,SACpD,OAAO76G,EAAK05G,UAAU15G,EAAMA,EAAK4hC,WAEjC,IAAI2H,EAAaz8B,OAAOY,KAAK+vF,MAAMqd,mBAAmBH,GAEtD,OAAOv9G,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMsd,mBAAmB/6G,EAAK4hC,UAAW2H,IAC9DzlB,KAAK,SAAU9b,GAGZ,OAFAhI,EAAKg7G,eAAiBhzG,EAAOizG,SAC7Bj7G,EAAK2S,WAAWgR,IAAM3b,EAAOkzG,YACtBl7G,EAAK05G,UAAU15G,EAAMA,EAAK4hC,cAUjDg3E,uBAAwB,SAAUh9E,GAC9B,IACIu/E,EAAgBv/E,EAAMO,aAAeP,EAAMO,aAAervB,OAAOC,aAAaC,YAAY,4BADnF/M,KACqH0gC,mBAAmBo6C,YAAYogC,IAQnK5D,eAAgB,SAAUptD,GACtB,IACIqsC,EADOv2F,KACgBqiD,MAAMs0D,cAEjC,IAAKzsD,GAAYr9C,OAAOY,KAAKC,cAAcw8C,GAAW,OAAO,EAE7D,IAAK,IAAIppD,EAAI,EAAGoE,EAASqxF,EAAgBrxF,OAAQpE,EAAIoE,EAAQpE,IAAK,CAG9D,GAFYopD,EAAShgD,QAAQ,IAAMqsF,EAAgBz1F,KAEtC,EACT,OAAO,EAIf,OAAO,GAOXwlF,gBAAiB,WACb,MAAO,UAGXyQ,oBAAqB,WACjB,MAAO,cASX0iB,UAAW,SAAU9qG,EAASgzB,GAC1B,IAAI5hC,EAAO4O,EACPtD,KACA8vG,EAAYp7G,EAAKq3F,iBACjBltC,EAAWnqD,EAAK43F,eAAe12F,KAwBnC,OAtBIlB,EAAKg7G,eACL1vG,EAAO6sG,SAAWn4G,EAAKg7G,eAChBh7G,EAAK43F,iBACZtsF,EAAO6sG,SAAWn4G,EAAK43F,eAAej0E,KAG1Cy3F,EAAUC,QAAU,KAAOvuG,OAAOY,KAAKmT,YAAY7gB,EAAKwzF,kBACxDloF,EAAOxN,KAAOs9G,EACd9vG,EAAOhO,QAAU,IAAIg+G,kBACrBhwG,EAAOhO,QAAQi+G,QAAU,OACzBjwG,EAAOhO,QAAQ6sD,SAAWA,EAC1B7+C,EAAOhO,QAAQk+G,SAAW,aAC1BlwG,EAAOhO,QAAQm+G,WAAcz6G,IAAKo6G,EAAmB,SACrD9vG,EAAOhO,QAAQwjF,OAAS9gF,EAAK2S,WAAWmuE,OAGxC9gF,EAAKg7G,eAAiB,KACtBh7G,EAAK43F,eAAiB,KAGtBtsF,EAAO6sG,SAAWrrG,OAAOY,KAAK+vF,MAAMC,aAAapyF,EAAO6sG,UAEjD/6G,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMie,WAAWpwG,IAASwY,KAAK,SAAU3M,GAC/D,IAAIouC,EAAW3oC,KAAKhE,MAAMM,mBAAmB/B,EAAEouC,WACzB,UAAlBA,EAASr7C,KACT4C,OAAOwtE,eAAe/0B,EAAS5uC,QAAS4uC,EAAS8e,WAEjDrkE,EAAKw4G,sBAAsB5pG,EAAS22C,KAEzCl1C,KAAK,SAAUurB,GACd57B,EAAK44G,uBAAuBh9E,MAUpC6+E,UAAW,SAAU7rG,EAAS2rG,GAC1B,IAAIv6G,EAAO4O,EACPtD,KACA8vG,EAAYp7G,EAAKq3F,iBAYrB,OAVA+jB,EAAUC,QAAU,KAAOvuG,OAAOY,KAAKmT,YAAY7gB,EAAKwzF,kBAExDloF,EAAOxN,KAAOs9G,EACd9vG,EAAOhO,QAAU,IAAIg+G,kBACrBhwG,EAAOhO,QAAQ6sD,SAAWowD,EAAU,GAAGr5G,KACvCoK,EAAOhO,QAAQk+G,SAAW,kBAC1BlwG,EAAOhO,QAAQm+G,WAAcz6G,IAAKo6G,EAAmB,SACrD9vG,EAAOhO,QAAQwjF,OAAS9gF,EAAK2S,WAAWmuE,OACxCx1E,EAAO6sG,SAAWoC,EAAU,GAAGlC,SAExBj7G,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMie,WAAWpwG,IAASwY,KAAK,SAAU3M,GAC/D,IAAIouC,EAAW3oC,KAAKhE,MAAMM,mBAAmB/B,EAAEouC,WACzB,UAAlBA,EAASr7C,KACT4C,OAAOwtE,eAAe/0B,EAAS5uC,QAAS4uC,EAAS8e,WAEjDrkE,EAAKw4G,sBAAsB5pG,EAAS22C,KAEzCl1C,KAAK,SAAUurB,GACd57B,EAAK44G,uBAAuBh9E,MAOpCw9E,OAAQ,SAAUx9E,GACd,IAAI6qE,EAAe35F,OAAOY,KAAKq3B,mBAAmBnJ,GAIlD,GAFA9uB,OAAOk1E,QAAQ/jD,OAEc,iBAAlB,IAA8F,IAAhEwoE,EAAat8F,QAAQ,sCAA8C,CACxG,IACIwM,EADc7J,OAAOY,KAAK+oB,gBAAgB,iCAClB3pB,OAAOC,aAAaC,YAAY,iCAAmC,2DAE/FF,OAAOwtE,eAAe3jE,KAU9B6hG,sBAAuB,SAAU5pG,EAAS5G,GACtC,IAAIhI,EAAO4O,EACP8D,EAAU1S,EAAK2rE,aACfgwC,EAAgBv+G,EAAE,4CAA6CsV,GAEnE,GAAI1K,EAAOzK,IAAMyK,EAAOmiD,SAAU,CAE9B,IAAIo9B,EAAUvnF,EAAK62F,iBAAiB7uF,GACpC2zG,EAAc95G,OAAO0lF,GAGrBvnF,EAAKuyF,WAAavyF,EAAKuyF,WAAa,EAGpC,IAAIgB,EAAQvzF,EAAKuzF,MAAMpkF,QAGvBokF,EAAM1qF,MAAMb,EAAOzK,GAAIyK,EAAOmiD,WAG9BnqD,EAAKgyC,SAASuhD,GAAO,GAGrBvzF,EAAK04G,gBAED14G,EAAK2S,WAAWizC,aAAe5lD,EAAK2S,WAAWqyC,UAC/ChlD,EAAK24G,sBAGT34G,EAAKg7G,eAAiB,UAEtBluG,OAAOwtE,eAAetyE,EAAO2O,QAAS,UAQ9C1M,QAAS,SAAU0vD,GACf,IAEIgB,EAFO16D,KAEOsN,OAAOosD,GAOzB,OALIgB,GAJO16D,KAMFo5D,qBAAqB,IAGvBsB,GAOX+9C,cAAe,WACX,IACI/lG,EADO1S,KACW0S,WAClBD,EAFOzS,KAEQ0rE,aACf6rB,EAAW7kF,EAAW4jF,SAEtBqlB,EAAcjpG,EAAW9O,MAAQ8O,EAAW9O,MAAMsB,OAAS,EAE3DwN,EAAWqyC,SACM,IAAbwyC,GARGv3F,KAQsBsyF,YAAciF,GAAYokB,GAAepkB,EAR/Dv3F,KASEw3G,YAAYryG,OATdnF,KAWEw3G,YAAYnyG,OAIE,GAfhBrF,KAeEsyF,YACLn1F,EAAE,YAAasV,GAASpN,QASpC2xG,gBAAiB,WACb,IAAIj3G,EAAOC,KACPu2F,EAAkBx2F,EAAK2S,WAAW6jF,iBAAmB,GAEzDx2F,EAAKk3G,cAAiB2E,OAAO,EAAO1E,OAAO,EAAOx1E,OAAO,EAAOzW,MAAM,GAGtEsrE,EAAkBA,EAAgB5xF,QAAQ,OAAQ,IAAI8L,cAGtD,IAAIorG,KAKJ,GAFA97G,EAAKo3G,sBAAwB,QAEI,IAAtB,GAAyD,KAApB5gB,EAC5Cx2F,EAAKk3G,cACDC,OAAO,EACPx1E,OAAO,EACPzW,MAAM,QAKV,GAA+B,KAF/BsrE,EAAkBA,EAAgBn1F,MAAM,MAEpB8D,SAAuD,IAAvCqxF,EAAgB,GAAGrsF,QAAQ,OAC3DnK,EAAKk3G,aAAaC,OAAQ,EAC1Bn3G,EAAKk3G,aAAav1E,OAAQ,OAE1B,IAAK,IAAI5gC,EAAI,EAAGoE,EAASqxF,EAAgBrxF,OAAQpE,EAAIoE,EAAQpE,IACzDy1F,EAAgBz1F,GAAKy1F,EAAgBz1F,GAAG6D,QAAQ,KAAM,IAElD5E,EAAKsiD,MAAMu0D,eAAe9lG,WAAW5G,QAAQqsF,EAAgBz1F,KAAO,EACpEf,EAAKk3G,aAAahsF,MAAO,EAClBlrB,EAAKsiD,MAAMs0D,cAAc7lG,WAAW5G,QAAQqsF,EAAgBz1F,KAAO,EAC1Ef,EAAKk3G,aAAav1E,OAAQ,EACnB3hC,EAAKsiD,MAAMw0D,gBAAgB/lG,WAAW5G,QAAQqsF,EAAgBz1F,KAAO,EAC5Ef,EAAKk3G,aAAaC,OAAQ,EAG1B2E,EAA0BjzG,KAAK2tF,EAAgBz1F,IAM1Df,EAAKk3G,aAAahsF,MAASlrB,EAAKk3G,aAAav1E,OAAU3hC,EAAKk3G,aAAaC,YACxC,IAAtBn3G,EAAgB,aACxBA,EAAKy3G,YAAYryG,OAKzBpF,EAAK+7G,mBAGL/7G,EAAKo3G,sBAAwB0E,EAA0BnjG,KAAK,OAAS,IAOzE++F,0BAA2B,WACvB,IAAIlgB,EAAWv3F,KAAK0S,WAAW4jF,SAC3BqlB,EAAc37G,KAAK0S,WAAW9O,MAAQ5D,KAAK0S,WAAW9O,MAAMsB,OAAS,EAEzE,OAAoB,IAAbqyF,GAAmBokB,GAAepkB,GAQ7CwkB,mBAAoB,SAAU7D,GAC1B,IAAIn4G,EAAOC,KACPk/B,EAASn/B,EAAKsiD,MAAMK,4BACpB8O,EAAW,IAAIwqD,SACfx2D,EAAOzlD,EAAK2gC,mBAGhB8wB,EAAS5vD,OAAOs9B,EAAS,QAASn/B,EAAKwzF,kBACvC/hC,EAAS5vD,OAAOs9B,EAAS,WAAYn/B,EAAK2S,WAAWpV,IACrDk0D,EAAS5vD,OAAOs9B,EAAS,eAAgBn/B,EAAK2S,WAAWoxC,cAAgB9jD,KAAKqjE,mBAC9E7R,EAAS5vD,OAAOs9B,EAASn/B,EAAKsiD,MAAMM,cAAe5iD,EAAK2S,WAAW0xC,aACnEoN,EAAS5vD,OAAO7B,EAAKsiD,MAAMI,2BAA6B,YAAa+C,EAAK9yC,WAAWm0C,WACrF2K,EAAS5vD,OAAO7B,EAAK2S,WAAWmO,MAAOq3F,GAEnCn4G,EAAK2S,WAAW0zC,aAChBoL,EAAS5vD,OAAOs9B,EAAS,cAAen/B,EAAK2S,WAAW0zC,aAG5D,IACyC,oBAA1B,oBACPoL,EAAS5vD,OAAOy1F,oBAAqB7xC,EAAK9yC,WAAWm0C,WAErD2K,EAAS5vD,OAAO,aAAc4jD,EAAK9yC,WAAWm0C,WAEpD,MAAO54C,GACLujD,EAAS5vD,OAAO,aAAc4jD,EAAK9yC,WAAWm0C,WAGlD,OAAO2K,GAMX6R,gBAAiB,WAEb,IADItjE,EAAOC,MACH1B,KAAM,CACV,IACIyB,EADeC,KAAK4jD,aAExB,OADI7jD,EAAOC,MACC1B,KAAKoU,WAAWmO,MAAQ,OAAS9gB,EAAK6jD,aAAe,IAEjE,MAAO,IAUf0N,kBAAmB,SAAU4mD,GACzB,IAAIr6G,GAAS6lB,IAAK1jB,KAAK0S,WAAWmuE,OAAQrvB,SAAUxxD,KAAK+7G,mBAAmB7D,IAC5E,OAAOl4G,KAAK+iE,YAAYzR,kBAAkBzzD,IAG9CkyE,kBAAmB,WACf,IAAIhwE,EAAOC,KACC7C,EAAE,gCAAiC4C,EAAK2rE,cAE9C7qE,KAAK,SAAUM,EAAO8nC,GAExB,IAAIhe,GADJge,EAAO9rC,EAAE8rC,IACOprC,OAEhBV,EAAEqM,KAAKzJ,EAAKm3F,iBAAiBjuD,EAAMhe,EAAK3tB,KAAK6K,KAAK,WAE9C8gC,EAAK9jC,OACL8jC,EAAKzpC,SAGLO,EAAKgyC,SAAShyC,EAAKuzF,OAAO,GAG1BvzF,EAAK04G,gBAGL14G,EAAKsoE,2BAKjByzC,iBAAkB,WACd,IACIG,KADOj8G,KAIFi3G,aAAahsF,MAAQpe,OAAOY,KAAK+vF,MAAMka,oBAAuB7qG,OAAOY,KAAK62B,oBAAsBz3B,OAAOY,KAAKk2B,sBAEjHs4E,EAAYrzG,MAAO8iC,KAAQ,EAAGyO,YAAettC,OAAOC,aAAaC,YAAY,8BAG7EF,OAAOY,KAAKk2B,uBATL3jC,KAUEi3G,aAAav1E,QAElBu6E,EAAYrzG,MACR8iC,KAAQ,EACRyO,YAAettC,OAAOC,aAAaC,YAAY,8CAEnDkvG,EAAYrzG,MACR8iC,KAAQ,EACRyO,YAAettC,OAAOC,aAAaC,YAAY,iDAlBhD/M,KAsBEi3G,aAAaC,OAElB+E,EAAYrzG,MACR8iC,KAAQ,EACRyO,YAAettC,OAAOC,aAAaC,YAAY,+CA1BhD/M,KAgCNq3G,kBAAoBn/F,OAAO+jG,MCtvBxCpvG,OAAO23D,UAAU03C,IAAIz1G,OAAO,wBACxBg8C,2BAA4B51C,OAAO2xC,OAAOC,SAAS8D,QAAQE,2BAC3DC,4BAA6B71C,OAAO2xC,OAAOC,SAAS8D,QAAQG,4BAC5D+zD,gBAAiB,GACjBC,MAAO,EACPC,eAAgB,aAAc,OAAQ,QAAS,MAAO,OACtDE,iBAAkB,kBAAmB,YAAa,KAAM,OACxDC,iBAAkB,YAAa,QAAS,SAExC3rC,cAAe,SAAUusB,EAAaC,GAClC,IAAI53F,EAAOC,KAEX,OAAO7C,EAAEqM,KAAKzJ,EAAKuN,OAAOoqF,EAAaC,IAAiBxvF,KAAK,SAAU5E,GACnE,OAAOA,IACR6M,KAAK,WACJ,MAAO,UACR+3D,OAAO,SAAU5kE,GAEhB,OADAxD,EAAK+N,cACEvK,KASfo9D,eAAgB,SAAUrM,GACtB,IAEI7hD,EAFOzS,KAEQ0rE,aACnBj5D,EAAQnP,KAAK,uBAAuB9D,SAHzBQ,KAIW0S,WAGXosD,SAAWxK,EAGlBznD,OAAOY,KAAKuF,aAAashD,KAVlBt0D,KAWGssE,WAGN75D,EAAQmmC,QAAQ,gEAFhBnmC,EAAQmmC,QAAQ,0CAZb54C,KAiBFy0E,kBAjBEz0E,KAqBNutE,yBAOTD,oBAAqB,WACjB,IACI76D,EADOzS,KACQ0rE,aACnBj5D,EAAQnP,KAAK,uBAAuB9D,SAFzBQ,KAIW0S,WAEPosD,WANJ9+D,KAQGqtE,kBAIN56D,EAAQmmC,QAAQ,gEAHhBnmC,EAAQmmC,QAAQ,4CAQ5BsyB,mBAAoB,SAAU3nE,EAAMoB,GAChCpB,EAAOA,GAAQ,GACfoB,EAAUA,GAAW,GAErB,IAAIw3G,EAAah/G,EAAEoG,EAAKoB,QAAQ,cAAeA,IAM/C,MAJgB,KAAZA,GACA3E,KAAKwB,aAAa26G,GAGfA,EAAW9pG,IAAI,GAAGu9F,WAG7BpuG,aAAc,SAAU46G,GACpBA,EAASA,GAAUp8G,KAAK4jE,qBACxBzmE,EAAE,4BAA6Bi/G,GAAQxjE,QAAQ,mCAAqCv3C,SAAS,sBAGjGyM,YAAa,WACT3Q,EAAE,eAAgB6C,KAAK0rE,cAAclsE,UAGzC68G,aAAc,SAAUC,GACpB,IAAI3pC,EAAW2pC,EAAQvpE,QAAQ,uBAC/BupE,EAAQj7G,SAAS,WACjBsxE,EAASrvE,KAAK,YAAYoB,IAAI,UAAW,IACzCiuE,EAASrvE,KAAK,2CAA2CgnC,KAAK,WAAY,YAC1EqoC,EAASrvE,KAAK,SAASgnC,KAAK,WAAY,aAG5CiyE,YAAa,SAAUD,GACnB,IAAI3pC,EAAW2pC,EAAQvpE,QAAQ,uBAC/B4/B,EAASrvE,KAAK,YAAYoB,IAAI,UAAW,GACzCiuE,EAASrvE,KAAK,2CAA2CgnC,KAAK,YAAY,GAC1EqoC,EAASrvE,KAAK,SAASgnC,KAAK,YAAY,GACxCqoC,EAASrvE,KAAK,YAAYuiB,YAAY,YAG1CitD,iBAAkB,WACd,IAAI/yE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK2rE,aACjB6rC,EAAkBx3G,EAAK8zE,qBACvBphE,EAAU1S,EAAK2rE,aAYnB,GAVA3rE,EAAKy3G,YAAcr6G,EAAE,oBAAqB0kB,GAC1C9hB,EAAKy8G,WAAar/G,EAAE,0BAA2BsV,GAG/CoP,EAAUxgB,SAAS,0BAEnBS,WAAW,WACP2Q,EAAQ2qB,SAAS95B,KAAK,oBAAoB6B,QAC3C,KAECsN,EAAQnP,KAAK,oBAAoB4B,OAAS,EAAG,CAC7C,IAAIu3G,EAAYhqG,EAAQnP,KAAK,oBAAoBhC,KAAK,WAAWqD,QAAQ,SAAU,IACnF8N,EAAQnP,KAAK,oBAAoBhC,KAAK,UAAWm7G,GAIrD,GAAI5vG,OAAOY,KAAK+R,0BAA2B,CACvC,IAAIk9F,EAAoBjqG,EAAQnP,KAAK,oBAErCo5G,EAAkBl8C,WAAW,WAE7Bk8C,EAAkBjwG,GAAG,QAAS,WAC1BI,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMh4D,aAAaroC,EAAE6C,MAAMsB,KAAK,YAAatB,KAAK/B,QAAQmS,KAAK,SAAUurB,GACpFA,EAAMO,cACNn8B,EAAK2gC,mBAAmBo6C,YAAYn/C,EAAMO,gBAE/CisC,OAAO,WACNt7D,OAAOk1E,QAAQzoD,YAiD3B,GA5CAv5B,EAAKgzE,oBACLhzE,EAAK48G,wBAEAjqG,EAAWqyC,SAGZwyD,EAAgBl2G,SAAS,0BAFzBk2G,EAAgBl2G,SAAS,sBAK7BlE,EAAE,2BAA4BsV,GAASzN,KAAK,QAAS,WACjD,IAAI43G,EAAcz/G,EAAE6C,MAChBmqC,EAAUyyE,EAAYzyE,QAAQ,uBAC9BnE,EAAO7oC,EAAE,4BAA6BgtC,GAErChtC,EAAE6C,MAAMoD,GAAG,YAAejG,EAAE,gCAAiCgtC,GAAS/mC,GAAG,WAIlEjG,EAAE,gCAAiCgtC,GAAS/mC,GAAG,aACvDjG,EAAE6C,MAAM6lB,YAAY,UACpB9lB,EAAK48G,0BALL58G,EAAK48G,wBACLx/G,EAAE6C,MAAMqB,SAAS,UACjB2kC,EAAK3kC,SAAS,aAMlB,IAAIw7G,EAAeD,EAAYx/E,SAASv/B,KAAK,iBAAmB,GAChEkC,EAAK+8G,eACD92E,KAAQA,EACR+2E,KAAQ5/G,EAAE,eAAgB6oC,GAC1Bg3E,OAAU7/G,EAAE,iBAAkB6oC,GAC9Bi3E,IAAO9/G,EAAE,iBAAkB6oC,GAC3BzmC,KAAQpC,EAAE,eAAgB6oC,GAC1B/lC,SAAa3C,GAAMu/G,EAAc5lB,SAAY2lB,EAAYx/E,SAAS97B,KAAK,UAAY,GAAI47G,iBAAkBl9G,MACzGqL,QAAY89C,aAAc0zD,EAAczzD,MAAOrpD,EAAK2S,WAAWmO,MAAOwoC,SAAUtpD,EAAK2S,WAAW22C,SAAUjF,YAAarkD,EAAK2S,WAAW0xC,YAAaN,aAAc/jD,EAAKsjE,mBACvK85C,cAAiBhgH,EAAE,gCAAiCgtC,GACpD2gE,UAAa3tG,EAAE,kBAAmBgtC,GAClCizE,QAAWjgH,EAAE,gBAAiBgtC,IAG9BnE,EAAK5iC,GAAG,YACRrD,EAAKs9G,eAELt9G,EAAKu9G,oBAIR5qG,EAAWqyC,SAKhB,GAAIl4C,OAAOY,KAAKk2B,qBAAsB,CAElC,IAAIs4E,EAAcl8G,EAAKi3G,kBAGvB75G,EAAE4C,EAAKy3G,aAAat9D,aAChB76C,QAAS48G,EACTthE,cAAe,SAAUvvC,GACrBrL,EAAK+3G,mBAAmB1sG,EAAOsgC,SAIvC3rC,EAAK04G,qBAGD5rG,OAAOY,KAAK+vF,MAAMka,mBAClBv6G,EAAE4C,EAAKy3G,aAAavzC,IAAI,SAASx6C,MAAM,WACnC1pB,EAAKy8G,WAAW/yF,UAIpB1pB,EAAKy3G,YAAYryG,OAIrBpF,EAAKy8G,WAAWv4C,IAAI,SAASx3D,GAAG,QAAS,SAAUwB,GAAKA,EAAEimC,oBAG1Dn0C,EAAKy8G,WAAWv4C,IAAI,SAASx3D,GAAG,SAAU,WACtC,IAAIyrG,EAAWn4G,EAAKy8G,WAAW,GAAGlpB,MAAM,GACxC4kB,EAASE,SAAWr4G,EAAKy8G,WAAW,GAAG54G,MACvC,IAAIu0G,KAAgBjgG,OAAOnY,EAAKsiD,MAAMs0D,cAAe52G,EAAKsiD,MAAMw0D,gBAAiB92G,EAAKsiD,MAAMy0D,iBAE5F/2G,EAAKyB,eACDqL,OAAOY,KAAK+vF,MAAM6a,iBAAiBH,EAAUn4G,EAAK2S,aAClD7F,OAAOY,KAAK+vF,MAAM8a,eAAeJ,EAAUn4G,EAAK2S,WAAYylG,GAE5Dh7G,EAAEqM,KAAKzJ,EAAK07G,WAAWvD,IAAW/vG,KAAK,SAAUJ,GACvB,iBAAXA,IAEPA,GACIu9C,SAAUv9C,IAGlBhI,EAAKw4G,sBAAsBx4G,EAAMgI,KAClCqI,KAAK,SAAUurB,GACd57B,EAAK+N,cAEoB,iBAArB6tB,EAAM68E,YACN3rG,OAAOwtE,eAAet6E,EAAKgN,YAAY,2CAGxB,IAAf4uB,EAAMmN,KACNj8B,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAE5EF,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAEhFF,OAAO6T,IAAI,iCAAmCib,EAAMmN,QAIxD/oC,EAAK+N,qBAjEb/N,EAAKy3G,YAAYryG,QAuEzBw3G,sBAAuB,WACnB,IACIlqG,EADOzS,KACQ0rE,aACf6xC,EAAWpgH,EAAE,2BAA4BsV,GACzCuzB,EAAO7oC,EAAE,4BAA6BsV,GACtC+qG,EAAWrgH,EAAE,gCAAiCsV,GAElD8qG,EAAS13F,YAAY,UACrBmgB,EAAKngB,YAAY,YAEjB23F,EAAS33F,YAAY,UACrB23F,EAASC,QAAQ,KAAK53F,YAAY,SAGtCw3F,aAAc,WACV,IAAIt9G,EAAOC,KACXD,EAAKu9G,kBAELv9G,EAAK2rE,aAAapoE,KAAK,4DAA8DmmB,MAAM,SAAU/C,GACjGA,EAAMmtB,mBAGV9zC,EAAK+8G,cAAcC,KAAKtzF,MAAM,WAC1BtsB,EAAEqM,KAAKzJ,EAAKgjE,YAAYtZ,aAAa1pD,EAAK+8G,cAAczxG,SAASlD,KAAK,WAClEpI,EAAK+8G,cAAcC,KAAKl3F,YAAY,2BACpC9lB,EAAK+8G,cAAcE,OAAO37G,SAAS,+BAI3CtB,EAAK+8G,cAAcE,OAAOvzF,MAAM,WAC5BtsB,EAAEqM,KAAKzJ,EAAKgjE,YAAYrZ,eAAe3pD,EAAK+8G,cAAczxG,SAASlD,KAAK,WACpEpI,EAAK+8G,cAAcE,OAAOn3F,YAAY,2BACtC9lB,EAAK+8G,cAAcC,KAAK17G,SAAS,+BAIzC,IAAIq8G,EAA2B,KAE/B39G,EAAK+8G,cAAcG,IAAIj4G,KAAK,QAAS,WAEjChD,aAAa07G,GACb39G,EAAK48G,wBACL58G,EAAKyB,eAELrE,EAAE4C,EAAK+8G,cAAc78G,QAAQi9G,kBAAkBnqE,QAAQ,uBAAuBruC,IAAI,UAAW,IAE7FvH,EAAEqM,KAAKzJ,EAAKgjE,YAAYpZ,cAAc5pD,EAAK+8G,cAAczxG,SAASlD,KAAK,WACnEpI,EAAKu9G,kBACLngH,EAAE4C,EAAK+8G,cAAc78G,QAAQi9G,kBAAkB/yE,QAAQ,uBAAuB3qC,SAM9E,IAHA,IAAI8zF,KAAWp7E,OAAOnY,EAAKuzF,OAGlBxyF,EAAI,EAAGA,EAAIwyF,EAAMpuF,OAAQpE,IAC1BwyF,EAAMxyF,GAAG,KAAOf,EAAK+8G,cAAczxG,OAAO89C,cAC1CmqC,EAAMz5E,OAAO/Y,EAAG,GAKxBf,EAAKgyC,SAASuhD,GAGdvzF,EAAK04G,kBACNtwC,OAAO,WACNhrE,EAAE4C,EAAK+8G,cAAc78G,QAAQi9G,kBAAkBnqE,QAAQ,uBAAuBruC,IAAI,UAAW,GAC7F3E,EAAK+N,kBAIb/N,EAAK49G,gBAEL59G,EAAK+8G,cAAcv9G,KAAKkqB,MAAM,WAE1BznB,aAAa07G,GACb39G,EAAK48G,wBAEA58G,EAAK+8G,cAAcK,cAAc/5G,GAAG,aACrCrD,EAAK+8G,cAAcK,cAAc97G,SAAS,UAC1Cq8G,EAA2B57G,WAAW,WAClC/B,EAAK+8G,cAAcK,cAAcn/E,OAAO4/E,UAAU,KAAKv8G,SAAS,SACjE,QAIXtB,EAAK+8G,cAAcM,QAAQ3zF,MAAM,WAC7B,IAAI/W,EAAa3S,EAAK2S,WAClBmrG,EAAkB1gH,EAAE,4BAA6B4C,EAAK+8G,cAAcK,eACpEK,KACAM,GAAY,EACZxB,EAAUn/G,EAAE6C,MAGhBgC,aAAa07G,GAGb39G,EAAKs8G,aAAaC,GAElB,IAAK,IAAIyB,EAAkB,EAAGA,EAAkBF,EAAgB34G,OAAQ64G,IAAmB,CACvF,IAAIC,EAAaH,EAAgBE,GAC7BE,EAAW9gH,EAAE6gH,GAAYngH,KAAK,SAC9BoM,EAAO9M,EAAE6gH,GAAYngH,KAAK,gBAC1BihE,EAAW3hE,EAAE6gH,GAAYngH,KAAK,YAC9B+1C,EAAWz2C,EAAE6gH,GAAYngH,KAAK,YAC9BqgH,EAAc/gH,EAAE6gH,GAAYngH,KAAK,eACjCsgH,EAAahhH,EAAE6gH,GAAYngH,KAAK,cAChCugH,EAAc,KAElB,GAAIxqE,EAGA,OAFA7zC,EAAK+N,cACL/N,EAAKw8G,YAAYD,IACV,EAGX,GAAa,WAATryG,GAA8B,YAATA,EACrBm0G,EAAcjhH,EAAE,QAAS6gH,GAAY5uG,WAClC,GAAa,SAATnF,EACPm0G,EAAcjhH,EAAE,gCAAiC6gH,GAAY5uG,WAC1D,GAAa,aAATnF,EAAqB,CAC5B,IAAI6nB,EAAU/xB,EAAK2S,WAAWk4E,WAAa7qF,EAAK2S,WAAWk4E,WAAgD,cAAlC7qF,EAAKgN,YAAY,cAAgChN,EAAKgN,YAAY,cAAgB,sBAC3JqxG,EAAcvxG,OAAOY,KAAKgmB,cAAcD,WAAW3mB,OAAOY,KAAKgmB,cAAcmF,eAAez7B,EAAE,QAAS6gH,GAAY18G,KAAK,UAAU,GAAQwwB,IAG1IgtC,GAA6B,KAAhBs/C,GAAsC,OAAhBA,IACnCvxG,OAAOwtE,eAAe6jC,EAAc,KAAOn+G,EAAKgN,YAAY,gCAAiC,SAC7F+wG,GAAY,GAGXA,GAAaM,GAAeH,GAC7BT,EAAS50G,MACLy1G,WAAYF,EACZv6G,MAAOw6G,IAKnB,GAAKN,EAeD/9G,EAAK+N,cACL/N,EAAKw8G,YAAYD,OAhBL,CACZ,IAAIjxG,EAAStL,EAAKq3F,iBAClB/rF,EAAO6+C,SAAWnqD,EAAK+8G,cAAc78G,QAAQg3F,SAC7C5rF,EAAO89C,aAAeppD,EAAK+8G,cAAc78G,QAAQ3C,GACjD+N,EAAO+4C,YAAc1xC,EAAW0xC,YAChC/4C,EAAOw+C,WAAaltC,KAAKC,QACrB0hG,eAAgBd,IAGpBrgH,EAAEqM,KAAKzJ,EAAKgjE,YAAYjZ,kBAAkBz+C,IAASlD,KAAK,WACpDpI,EAAK+N,cACL/N,EAAKw8G,YAAYD,QAS7Bv8G,EAAK+8G,cAAchS,UAAUrhF,MAAM,WAC/B1pB,EAAK48G,wBACL58G,EAAKu9G,qBAObK,cAAe,WACA39G,KACiB88G,cAAcK,cAAc75G,KAAK,yBAC5CzC,KAAK,SAAUM,EAAOotB,GACnC,IAAIgwF,EAASphH,EAAEoxB,GACX3qB,EAAQ26G,EAAOj9G,KAAK,SACpBosB,EAAM,IAAIza,KACVurG,EAAa56G,EAAQ,IAAIqP,KAAKrP,GAAS8pB,EACvCsoB,EAAWtoB,EAAIxa,UAAYsrG,EAAUtrG,UAAYwa,EAAM8wF,EAE3DxoE,EAAQu6D,YAAYv6D,EAAQ5f,cAAgB,GAE5CmoF,EAAO9N,aAAaC,UAChB7wG,KAAM,QACNozC,QAAS,SACTprB,UAAW,YACX7c,IAAKgrC,EACL04B,aAAc8vC,EACd5N,KAAM/jG,OAAOY,KAAKojG,UAAUC,kBAAoB,KAChDG,MAAO,SAAUC,GAEbqN,EAAOj9G,KAAK,QAAS4vG,GACrBqN,EAAOxrE,QAAQ,4BAA4BzvC,KAAK,4BAA4BuiB,YAAY,iCAMxGy3F,gBAAiB,WACFt9G,KAEN88G,cAAcC,KAAK51F,OAAO,SAFpBnnB,KAGN88G,cAAcE,OAAO71F,OAAO,SAHtBnnB,KAIN88G,cAAcG,IAAI91F,OAAO,SAJnBnnB,KAKN88G,cAAcv9G,KAAK4nB,OAAO,SALpBnnB,KAMN88G,cAAcM,QAAQj2F,OAAO,SANvBnnB,KAON88G,cAAchS,UAAU3jF,OAAO,UAGxC2wF,mBAAoB,SAAUzhC,GAC1B,IAAIt2E,EAAOC,KACP06G,EAAiBrkC,GAAW,EAEhCxpE,OAAOk1E,QAAQzoD,QAEQ,IAAnBohF,EAEA98F,UAAUg7F,OAAOC,WAAW,SAAUl3E,GAClCxkC,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMsb,aAAan3E,EAAW5hC,EAAK2S,aAAavK,KAAK,WACpEhL,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMub,gBAAgBp3E,IAAY9d,KAAK,SAAUm1F,GAChEj5G,EAAK43F,eAAiBqhB,EACtBj5G,EAAK05G,UAAU15G,EAAM4hC,OAE1BwmC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAEpBj+B,EAAKo5G,QACJC,QAASr5G,EAAKsiD,MAAMo0D,gBACpB4C,WAAYC,OAAOC,kBAAkBC,eAEf,IAAnBkB,EAEP98F,UAAUg7F,OAAOC,WAAW,SAAUl3E,GAClCxkC,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMsb,aAAan3E,EAAW5hC,EAAK2S,aAAavK,KAAK,WACpEhL,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMub,gBAAgBp3E,IAAY9d,KAAK,SAAUm1F,GAChEj5G,EAAK43F,eAAiBqhB,EACtBj5G,EAAK05G,UAAU15G,EAAM4hC,OAE1BwmC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAGvBj+B,EAAKo5G,QAEDC,QAASr5G,EAAKsiD,MAAMo0D,gBACpB4C,WAAYz7F,UAAUg7F,OAAOW,kBAAkBG,OAC/CC,UAAW/7F,UAAUg7F,OAAOgB,UAAUC,QACtCC,gBAAiBR,OAAOS,gBAAgBC,SACxCC,oBAAoB,IAGE,IAAnBS,EAEP98F,UAAUoG,OAAOo2F,QAAQC,aAAa,SAAU14E,GAC5CxkC,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAM+c,kBAAkB54E,EAAW5hC,EAAK2S,aAAavK,KAAK,WACzEpI,EAAKy6G,UAAUz6G,EAAM4hC,KACtBwmC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAEpBj+B,EAAKo5G,QAAUsB,MAAO16G,EAAKsiD,MAAMq0D,QACV,IAAnBgE,GAEP98F,UAAUoG,OAAOo2F,QAAQqE,aAAa,SAAUC,GAC5C,IAAIC,EAAWD,EAAW,GAAGE,SAC7BzhH,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMsb,aAAa6F,EAAU5+G,EAAK2S,aAAavK,KAAK,WACnEpI,EAAK8+G,UAAU9+G,EAAM2+G,KACtBv2C,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAEpBj+B,EAAKo5G,QAAUsB,MAAO16G,EAAKsiD,MAAMq0D,SAI5C9f,iBAAkB,SAAU3rE,GACxB,OAAOjrB,KAAKsN,OAAO2d,IAQvBwwF,WAAY,SAAUvD,GAClB,IAAIn4G,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SAElB,GAAIlD,OAAOY,KAAK+vF,MAAM6a,iBAAiBH,EAAUn4G,EAAK2S,aAClD7F,OAAOY,KAAK+vF,MAAM8a,eAAeJ,EAAUn4G,EAAK2S,cAAewF,OAAOnY,EAAKsiD,MAAMs0D,cAAe52G,EAAKsiD,MAAMw0D,gBAAiB92G,EAAKsiD,MAAMy0D,kBAAmB,CAG1J,IAAItlD,EAAW,IAAIwqD,SACfx2D,EAAOzlD,EAAK2gC,mBACZ7iC,EAAOkC,EAAKq3F,iBAELv3E,OAAOu/D,KAAKvhF,GAClBiN,IAAI,SAAU/J,GACfywD,EAAS5vD,OAAOb,EAAKlD,EAAKkD,MAG9BywD,EAAS5vD,OAAO,WAAYs2G,GAE5B1mD,EAAS5vD,OAAO,WAAYs2G,EAASj3G,KAAK2X,OAAOs/F,EAASj3G,KAAK0D,QAAQ,aAAc,KAAKomF,YAAY,KAAO,IAEzGhrF,EAAK2S,WAAW0zC,aAChBoL,EAAS5vD,OAAO7B,EAAKsiD,MAAMK,4BAA8B,cAAe3iD,EAAK2S,WAAW0zC,aAG5F,IACyC,oBAA1B,oBACPoL,EAAS5vD,OAAOy1F,oBAAqB7xC,EAAK9yC,WAAWm0C,WAErD2K,EAAS5vD,OAAO,aAAc4jD,EAAK9yC,WAAWm0C,WAEpD,MAAO54C,GACLujD,EAAS5vD,OAAO,aAAc4jD,EAAK9yC,WAAWm0C,WAGlD9mD,EAAKgjE,YAAYzR,mBACb5tC,IAAK3jB,EAAK2S,WAAWmuE,OACrBrvB,SAAUA,IACXrpD,KAAK,SAAUm9C,GACd7hC,EAAMtT,QAAQm1C,KACfl1C,KAAK,SAAUurB,GACdlY,EAAM6uC,OAAO32B,UAIjB9uB,OAAOk1E,QAAQ/jD,OAGnB,OAAOva,EAAMlb,WAGjBkxG,UAAW,SAAU9qG,EAASgzB,GAC1B,IAAI5hC,EAAO4O,EACPtD,KACA8vG,EAAYp7G,EAAKq3F,iBACjBltC,EAAWnqD,EAAK43F,eAAe12F,KAE/BlB,EAAKg7G,eACL1vG,EAAO6sG,SAAWn4G,EAAKg7G,eAChBh7G,EAAK43F,iBACZtsF,EAAO6sG,SAAWn4G,EAAK43F,eAAej0E,KAG1Cy3F,EAAUC,QAAU,KAAOvuG,OAAOY,KAAKmT,YAAY7gB,EAAKwzF,kBACxD4nB,EAAiB,MAAIA,EAAiB,MACtCA,EAAU2D,SAAW50D,EAErB7+C,EAAOxN,KAAOs9G,EACd9vG,EAAOhO,QAAU,IAAIg+G,kBACrBhwG,EAAOhO,QAAQi+G,QAAU,OACzBjwG,EAAOhO,QAAQ6sD,SAAWA,EAC1B7+C,EAAOhO,QAAQk+G,SAAW,aAC1BlwG,EAAOhO,QAAQm+G,WAAcz6G,IAAKo6G,EAAiB,OACnD9vG,EAAOhO,QAAQwjF,OAAS9gF,EAAK2S,WAAWmuE,OAGxC9gF,EAAKg7G,eAAiB,KACtBh7G,EAAK43F,eAAiB,KAGtBtsF,EAAO6sG,SAAWrrG,OAAOY,KAAK+vF,MAAMC,aAAapyF,EAAO6sG,UAExDrrG,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMie,WAAWpwG,IAASlD,KAAK,SAAU+O,GACxDnX,EAAKw4G,sBAAsB5pG,EAASuI,KACrC9G,KAAK,SAAUurB,GACK,IAAfA,EAAMmN,KACNj8B,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAE5EF,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAEhFF,OAAO6T,IAAI,iCAAmCib,EAAMmN,QACrDq/B,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,YAIvB6gF,UAAW,SAAUlwG,EAASowG,GAC1B,IAAIh/G,EAAO4O,EACPtD,KACA6+C,EAAW60D,EAAU,GAAG99G,KACxBk6G,EAAYp7G,EAAKq3F,iBAErB+jB,EAAUC,QAAU,KAAOvuG,OAAOY,KAAKmT,YAAY7gB,EAAKwzF,kBACxD4nB,EAAiB,MAAIA,EAAiB,MACtCA,EAAU2D,SAAW50D,EAErB7+C,EAAOxN,KAAOs9G,EACd9vG,EAAOhO,QAAU,IAAIg+G,kBACrBhwG,EAAOhO,QAAQi+G,QAAU,OACzBjwG,EAAOhO,QAAQ6sD,SAAWA,EAC1B7+C,EAAOhO,QAAQm+G,WAAcz6G,IAAKo6G,EAAiB,OACnD9vG,EAAOhO,QAAQwjF,OAAS9gF,EAAK2S,WAAWmuE,OACxCx1E,EAAO6sG,SAAW6G,EAAU,GAAG3G,SAE/BvrG,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMie,WAAWpwG,IAASlD,KAAK,SAAU+O,GACxDnX,EAAKw4G,sBAAsB5pG,EAASuI,KACrC9G,KAAK,SAAUurB,GACK,IAAfA,EAAMmN,KACNj8B,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAE5EF,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAEhFF,OAAO6T,IAAI,iCAAmCib,EAAMmN,QACrDq/B,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,YAIvBw8E,UAAW,SAAU7rG,EAAS2rG,GAC1B,IAAIv6G,EAAO4O,EACPtD,KACA6+C,EAAWowD,EAAU,GAAGr5G,KACxBk6G,EAAYp7G,EAAKq3F,iBAErB+jB,EAAUC,QAAU,KAAOvuG,OAAOY,KAAKmT,YAAY7gB,EAAKwzF,kBACxD4nB,EAAiB,MAAIA,EAAiB,MACtCA,EAAU2D,SAAW50D,EAErB7+C,EAAOxN,KAAOs9G,EACd9vG,EAAOhO,QAAU,IAAIg+G,kBACrBhwG,EAAOhO,QAAQi+G,QAAU,OACzBjwG,EAAOhO,QAAQ6sD,SAAWA,EAC1B7+C,EAAOhO,QAAQm+G,WAAcz6G,IAAKo6G,EAAiB,OACnD9vG,EAAOhO,QAAQwjF,OAAS9gF,EAAK2S,WAAWmuE,OACxCx1E,EAAO6sG,SAAWoC,EAAU,GAAGlC,SAE/BvrG,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMie,WAAWpwG,IAASlD,KAAK,SAAU+O,GACxDnX,EAAKw4G,sBAAsB5pG,EAASuI,KACrC9G,KAAK,SAAUurB,GACK,IAAfA,EAAMmN,KACNj8B,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAE5EF,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAGhFF,OAAO6T,IAAI,iCAAmCib,EAAMmN,QACrDq/B,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,YAIvBm7E,OAAQ,SAAUx9E,GACd9uB,OAAO6T,IAAI,eAAiBib,EAAMmN,OAGtCyvE,sBAAuB,SAAU5pG,EAAS22C,GACtC,IAAIvlD,EAAOC,KAEX,IAGI,GAA6B,cAF7BslD,EAAW3oC,KAAKhE,MAAMyI,UAAUkkC,EAASA,YAE5B6D,cAAyD,OAA1B7D,EAAS6D,aAkBjD,KAAM,2BAfN,IAAI12C,EAAU1S,EAAK2rE,aAGnB3rE,EAAKuyF,WAAavyF,EAAKuyF,WAAa,EACpC,IAAIgB,KAAWp7E,OAAOnY,EAAKuzF,OAC3BA,EAAM1qF,MAAM08C,EAAS6D,aAAc7D,EAAS4E,WAG5CnqD,EAAKgyC,SAASuhD,GAAO,GAErBn2F,EAAEqM,KAAKzJ,EAAKorE,cAAc,KAAM,OAAOhjE,KAAK,SAAUJ,GAClD0K,EAAQlP,KAAKwE,GACbhI,EAAK+yE,qBAMf,MAAO7kE,GACLpB,OAAOwtE,eAAet6E,EAAKgN,YAAY,oCAAqC,SAC5EF,OAAO6T,IAAI,cACX7T,OAAO6T,IAAIzS,KAInBwqG,cAAe,WACX,IACI/lG,EADO1S,KACW0S,WAClB6kF,EAAW7kF,EAAW4jF,SACtBqlB,EAAcjpG,EAAW9O,MAAMsB,OAElB,IAAbqyF,GAAmBokB,GAAepkB,GAL3Bv3F,KAMFw3G,YAAYryG,QAIzB6xG,gBAAiB,WACb,IAEIzgB,EAFOv2F,KACW0S,WACW6jF,gBAE7ByoB,GAAc,EACdC,GAAc,EACdC,GAAc,EAEdjD,KAEJ,QAAiC,IAAtB,GAAyD,KAApB1lB,EAC5CyoB,EAAcC,EAAcC,GAAc,OAI1C,GAA+B,KAF/B3oB,EAAkBA,EAAgBn1F,MAAM,MAEpB8D,SAAuD,IAAvCqxF,EAAgB,GAAGrsF,QAAQ,OAC3D80G,EAAcC,EAAcC,GAAc,OAE1C,IAAK,IAAIp+G,EAAI,EAAGoE,EAASqxF,EAAgBrxF,OAAQpE,EAAIoE,EAAQpE,IACzDy1F,EAAgBz1F,GAAKy1F,EAAgBz1F,GAAG6D,QAAQ,KAAM,IAnBvD3E,KAqBUqiD,MAAMs0D,cAAc7lG,WAAW5G,QAAQqsF,EAAgBz1F,KAAO,IACnEo+G,GAAc,GAtBnBl/G,KAyBUqiD,MAAMy0D,gBAAgBhmG,WAAW5G,QAAQqsF,EAAgBz1F,KAAO,IACrEm+G,GAAc,GA1BnBj/G,KA6BUqiD,MAAMw0D,gBAAgB/lG,WAAW5G,QAAQqsF,EAAgBz1F,KAAO,IACrEk+G,GAAc,GA6B9B,OAvBKC,GAAgBC,GAAgBF,GApC1Bh/G,KAqCFw3G,YAAYryG,OAIjB+5G,IACAjD,EAAYrzG,MAAO8iC,KAAQ,EAAGyO,YAAettC,OAAOC,aAAaC,YAAY,8CAC7EkvG,EAAYrzG,MAAO8iC,KAAQ,EAAGyO,YAAettC,OAAOC,aAAaC,YAAY,iDAgB1EkvG,GAGXkD,uBAAwB,SAAUC,GAG9B,MAFsB,8EAEEltG,KAAKktG,IAGjCrnB,iBAAkB,SAAUl6F,EAAM85F,GAC9B,IAAI53F,EAAOC,KACPwlD,EAAOzlD,EAAK2gC,mBACZw3D,EAAmBn4F,EAAK+iE,cAAcvT,YAAY,gBAClDr/C,EAAW/S,EAAE4S,WA8CjB,OA5CA5S,EAAEqM,KAAKzJ,EAAKgjE,YAAY7Z,eAAerrD,GACnC,GAAoB85F,GAAkB53F,EAAKgjE,YAAYhZ,kBAAkBlsD,IAC3EsK,KAAK,SAAUgwF,EAAUR,GAEvBA,EAAe,GAAG95F,KAAOA,EAGzB85F,EAAe,GAAG7zC,aAAe6zC,EAAe,GAAG7zC,cAAgB0B,EAAK9yC,WAAWoxC,cAAgB,GACnG6zC,EAAe,GAAG92E,MAAQ9gB,EAAK2S,WAAWmO,MAE1Cs3E,EAAS,GAAGlB,SAAWp5F,EAAKqsD,SAC5BiuC,EAAS,GAAGz0E,IAAM3jB,EAAKi3F,aAAaW,EAAe,IAGnDQ,EAAS,GAAGC,cAAgBT,EAAe,GAAGU,UAC9CF,EAAS,GAAGG,cAAgBX,EAAe,GAAGviC,UAC9C+iC,EAAS,GAAGI,wBAA0BZ,EAAe,GAAGa,oBACxDL,EAAS,GAAGM,gBAAkBd,EAAe,GAAGhyC,YAChDwyC,EAAS,GAAGO,uBAAyBf,EAAe,GAAGgB,mBACvDR,EAAS,GAAGS,cAAgBjB,EAAe,GAAGkB,UAC9CV,EAAS,GAAGW,kBAAoBnB,EAAe,GAAGoB,cAClDZ,EAAS,GAAGa,wBAA0BrB,EAAe,GAAGsB,oBACxDd,EAAS,GAAGe,cAAgBr7F,EAAKknD,UAAY4yC,EAAe,GAAG/xC,UAC/DuyC,EAAS,GAAGC,cAAgBT,EAAe,GAAGU,UAC9CF,EAAS,GAAGgB,cAAgBxB,EAAe,GAAGxuC,aAC9CgvC,EAAS,GAAGt3E,MAAQ82E,EAAe,GAAG92E,MACtCs3E,EAAS,GAAGv0F,MAAQiJ,OAAOY,KAAKuF,aAAa2kF,EAAe,GAAG/zF,OAC/Du0F,EAAS,GAAGh1C,WAAat2C,OAAOgH,eAE5BskF,EAAS,GAAGqlB,UAAYrlB,EAAS,GAAGqlB,SAASt4G,QAC7CizF,EAAS,GAAGqlB,SAAS1yG,IAAI,SAA6Bu0G,GACxB,aAAtBA,EAAKC,eAGLD,EAAKrqG,WAAiD,eAAnCjV,EAAKgN,YAAY,cAAiChN,EAAKgN,YAAY,cAAiBhN,EAAK2S,WAAWk4E,WAAa7qF,EAAK2S,WAAWk4E,WAAa,sBACjKy0B,EAAKz7G,MAASy7G,EAAKz7G,MAAQiJ,OAAOY,KAAKgmB,cAAcD,WAAW3mB,OAAOY,KAAKgmB,cAAcmB,kBAAkByqF,EAAKz7G,MAAOy7G,EAAKrqG,YAAa,cAAgB,MAKtK,IAAIzR,EAAOpG,EAAEy8C,UAAUs+C,EAAkBC,EAAS,IAClDjoF,EAASC,QAAQ5M,KAGd2M,EAAS3H,WAGpByB,QAAS,SAAU0vD,GACf,IACIjnD,EADOzS,KACQ0rE,aACfh1D,KACAilB,GAAQ,EACRjpB,EAJO1S,KAIW0S,WAGlBgoD,GAAS,EAEThoD,EAAWosD,WAGXpE,KAZO16D,KAUW1B,MAVX0B,KAUwB1B,KAAKyzE,iBAAiB3jE,MAV9CpO,QAYkBA,KAAKsN,OAAOosD,GAEb,IAdjB15D,KAcEsyF,YAAoB53B,IAEzBhB,EAAgB9wD,MACZwgD,MAAO12C,EAAWmO,MAClBnK,QAlBD1W,KAkBe+M,YAAY,wBAAwB4O,WAAW,UAAWjJ,EAAWynC,eAEvFugB,GAAS,IAIjB,GAAIhoD,EAAWqyC,SAAU,CACrB,IAAIw6D,EAAoBpiH,EAAE,+BAAgCsV,GAASnP,KAAK,mDACxEnG,EAAE0D,KAAK0+G,EAAmB,SAAUx+G,EAAK6C,GACL,KAA5BzG,EAAE,QAASyG,GAAOwL,QAClBsH,EAAQ9N,KAAKzL,EAAEyG,GAAO/F,KAAK,gBAC3B89B,GAAQ,KAKpB,GAAIA,EAAO,CACP,IAAImL,EAnCG9mC,KAmCiB+M,YAAY,wBAAwB4O,WAAW,UAAWjF,EAAQgC,KAAK,OAC/FghD,EAAgB9wD,MACZwgD,MAAO12C,EAAWmO,MAClBnK,QAASowB,IAQjB,OAAO4zB,GAMXuH,UAAW,WACIjiE,KAEN+xC,SAAS,MAFH/xC,KAGN+vE,qBAMTA,kBAAmB,WACf,IAAIhwE,EAAOC,KAGPw/G,EAFUz/G,EAAK2rE,aAEMpoE,KAAK,6BACjBk8G,EAAWt6G,OAExB/H,EAAE0D,KAAK2+G,EAAY,SAAUr+G,EAAOyC,GAChC,IAAIqlC,EAAO9rC,EAAEyG,GACTqnB,EAAOge,EAAKprC,OAEZotB,GACA9tB,EAAEqM,KAAKzJ,EAAKm3F,iBAAiBjuD,EAAMhe,EAAKw0F,eAAet3G,KAAK,WAExD8gC,EAAKzpC,aAMjBO,EAAKuyF,WAAa,KCt8B1BzlF,OAAO23D,UAAUk7C,WAAWj5G,OAAO,+BAC/BktG,kBAAmB,EACnBC,sBAKAp/B,aAAc,WACCx0E,KAENsN,SAEL,IAAImF,EAJOzS,KAIQ0rE,aAJR1rE,KAONg0E,WAAWx0E,SAPLQ,KAUN2/G,mBAAqB1qF,MAAM52B,SAVrB2B,KAUmC8iE,cAAcvT,YAAY,oCAAsCrW,cAAc,IAVjHl5C,KAWN4/G,eAAiB3qF,MAAM52B,SAXjB2B,KAW+B8iE,cAAcvT,YAAY,gCAAkCrW,cAAc,IAXzGl5C,KAcNuuB,MAAQpxB,EAAE,8BAA+BsV,GAdnCzS,KAgBN+yG,yBAMTjgC,iBAAkB,WACd,IAAI/yE,EAAOC,KAGXA,KAAKsN,SAEAvN,EAAK2S,WAAWqyC,UAEjBhlD,EAAK8/G,oBAIT9/G,EAAKwuB,MAAM9hB,GAAG,QAAS,mCAAoC,WACvD1M,EAAKg6B,WAAW58B,EAAE6C,UAO1B+yG,sBAAuB,WACR/yG,KAEF0S,WAAWqyC,WAFT/kD,KAGE0S,WAAW9O,MAAMsB,OAAS,EAH5BlF,KAIE8/G,mBAAmB,sBAJrB9/G,KAME8/G,mBAAmB,MANrB9/G,KAOE8/G,mBAAmB,wBAQpCA,mBAAoB,SAAStsG,GACzB,IAAIzT,EAAOC,MACwB,KAAbwT,EAAmBzT,EAAKwuB,MAAQpxB,EAAEqW,EAAUzT,EAAKwuB,QAExDpH,SAASniB,KAAK,QAAS,WAElC,IAAI4/D,EAAWznE,EAAE,8BAA+B4C,EAAKwuB,OACjDujB,KAGJ/xC,EAAKsiD,MAAMuxD,oBAEX,IAAK,IAAI9yG,EAAI,EAAGoE,EAAS0/D,EAAS1/D,OAAQpE,EAAIoE,EAAQpE,IAAK,CACvD,IAAIxD,EAAKH,EAAEynE,EAAS9jE,IAAIjD,KAAK,MACzB+F,EAAQzG,EAAE,QAASA,EAAEynE,EAAS9jE,KAAKqR,OACnC4tG,GAAeziH,GAAMA,EAAIsG,MAASA,GAEtCkuC,EAAOlpC,KAAKm3G,GAGZhgH,EAAKi1G,mBAAmB13G,EAAIsG,GAAO,GAIvC,IAAIvF,EAAW0B,EAAK+iE,cAAcvT,YAAY,uBAC1CyjD,EAAoB/9E,MAAM52B,SAASA,GAAY66C,cAAc,IAC7Dr7C,GACA+O,MAASklC,EACTqI,YAAep6C,EAAK2S,WAAWynC,aAAe,GAC9Cr2C,YAAe/D,EAAK2S,WAAW5O,aAE/BmvG,EAAY91G,EAAEA,EAAE+f,KAAK81F,EAAkBn1G,KAE3Co1G,EAAU95D,sBACNpxB,MAAO,WACHhoB,EAAKi4D,qBAAqB,4BAE1Bh4D,KAAK2N,UACL3N,KAAKC,QAAQT,UAEjB45C,oBAAoB,EACpB7uB,OAAO,IAGXxqB,EAAKmzG,2BAA2BD,GAEhClzG,EAAKi4D,qBAAqB,yBAC1Bi7C,EAAU95D,qBAAqB,WAOvC+5D,2BAA4B,SAAUC,GAClC,IAAIpzG,EAAOC,KAEPozG,EAAwB,IAAIj2G,EAAE4S,SAGlCojG,EAAe7vG,KAAK,yCAAyC6B,KAAK,KAGlEguG,EAAe7vG,KAAK,wCAAwC0B,KAAK,iBAAkB,WAC5D,KAAfhF,KAAK4D,MACLuvG,EAAe7vG,KAAK,yCAAyC+B,KAAK,KAElE8tG,EAAe7vG,KAAK,yCAAyC6B,KAAK,KAItE0H,OAAOk1E,QAAQzoD,OAAQ9lB,SAAY,wCAGnCrW,EAAEqM,KAAKzJ,EAAKigH,YAAYhgH,KAAK4D,MAAOuvG,IAAiBhrC,OAAO,WACxDt7D,OAAOk1E,QAAQ/jD,MAAOxqB,SAAY,4CAEvC6zB,MAAM,WACL8rE,EAAe7vG,KAAK,sCAAsCjC,SAAS,eACpE0uC,KAAK,WACJojE,EAAe7vG,KAAK,sCAAsCuiB,YAAY,eAI1EstF,EAAe7vG,KAAK,yCAAyC0B,KAAK,QAAS,WACvEjF,EAAKkgH,qBAAqBlgH,EAAKgN,YAAY,kDAAmDomG,GAC9FA,EAAe7vG,KAAK,wCAAwC8L,IAAI,IAChEjS,EAAE6C,MAAMmF,KAAK,OAIjBguG,EAAex/D,SAAS,qCAAsC,QAAS,WACnEy/D,EAAsBjjG,UACtBgjG,EAAet1G,KAAK,wBAAwBkqB,UAGhDorF,EAAe7vG,KAAK,0BAA0B0B,KAAK,QAAS,WACxDouG,EAAsB9gD,SACtB6gD,EAAet1G,KAAK,wBAAwBkqB,UAIhDorF,EAAe7vG,KAAK,sCAAsCmJ,GAAG,QAAS,mCAAoC,WACtG1M,EAAKg6B,WAAW58B,EAAE6C,OAAO,GAEzB,IAAIkpC,EAAOiqE,EAAe7vG,KAAK,wCAAwC8L,MAGvEvC,OAAOk1E,QAAQzoD,OAAQ9lB,SAAY,wCAGnCrW,EAAEqM,KAAKzJ,EAAKigH,YAAY92E,EAAMiqE,IAAiBhrC,OAAO,WAClDt7D,OAAOk1E,QAAQzoD,OAAQ9lB,SAAY,4CAI3CrW,EAAEqM,KAAK4pG,GAAuBjrG,KAAK,WAC/BpI,EAAKw0G,sBACLx0G,EAAKsiD,MAAMuxD,sBACZxjG,KAAK,WACJrQ,EAAKsiD,MAAMuxD,uBAOnBoM,YAAa,SAAUp8G,EAAOuvG,GAC1B,IAAIpzG,EAAOC,KAEX,OAAO7C,EAAEqM,KAAKzJ,EAAKmgH,gBAAiBh3E,KAAQtlC,KAAUuE,KAAK,SAAUg4G,GACtC,IAAvBA,EAAYj7G,OACZnF,EAAKkgH,qBAAqBlgH,EAAKgN,YAAY,kDAAmDomG,IAG9Fh2G,EAAE,wDAAyDg2G,GAAgB3zG,SAG1DrC,EAAE,KAAMA,EAAE0P,OAAOY,KAAKyP,KAAKnd,EAAK4/G,oBAAqBthH,SAAY,aAAcuO,MAASuzG,OAC9Fj8G,SAAS/G,EAAE,qDAAsDg2G,IAG5EpzG,EAAKszG,cAAgBl2G,EAAE,kCAAmCg2G,GAG1DpzG,EAAKszG,cAAc/vG,KAAK,MAAM6jB,SAASniB,KAAK,QAAS,WAEjDjF,EAAKqgH,gBAAgBpgH,KAAM7C,EAAE,qCAAsCg2G,IAEjC,IAA9Bh2G,EAAE6C,MAAMqgH,WAAWn7G,QACnBnF,EAAKkgH,qBAAqBlgH,EAAKgN,YAAY,kDAAmDomG,GAGlGh2G,EAAE6C,MAAMR,cAGjB4Q,KAAK,SAAUk1C,GACdvlD,EAAKkgH,qBAAqB36D,EAAU6tD,MAO5CoB,oBAAqB,WACjB,IAAIx0G,EAAOC,KAGPw0G,KAEJr3G,EAAE0D,KAAKd,EAAKsiD,MAAMuxD,iBAAkB,SAAU9yG,EAAGm0E,GAC7Cu/B,EAAU5rG,KAAKqsE,EAAIv4D,OAGvB3c,EAAKgyC,SAASyiE,GAGdr3G,EAAE,QAAS4C,EAAKwuB,OAAO/uB,SAGFrC,EAAE,KAAMA,EAAE0P,OAAOY,KAAKyP,KAAKnd,EAAK6/G,gBAAiBvhH,SAAY,iBAAkBuF,MAAS4wG,OAG9FtwG,SAAS/G,EAAE,KAAM4C,EAAKwuB,QAGrCpxB,EAAE,KAAM4C,EAAKwuB,OAAOpH,SACpBhqB,EAAE,oBAAqB4C,EAAKwuB,OAAOpH,SAG/BqtF,EAAUtvG,OAAS,EACnBnF,EAAK+/G,mBAAmB,sBAExB//G,EAAK+/G,mBAAmB,MACxB//G,EAAK+/G,mBAAmB,uBAOhCxzC,SAAU,WAEN,OAAO3vD,KAAKhE,MADD3Y,KACY2S,YAAY/O,MAAMsB,OAAS,GAMtD6sC,SAAU,SAAUnuC,EAAOwpE,GAEvBA,OAAkCllE,IAAlBklE,GAA8BA,EADnCptE,KAIN4D,MAAQ+Y,KAAKC,QAAQhZ,MAASA,IAJxB5D,KAMNstE,sBAEDF,IAROptE,KAQgBosE,6BARhBpsE,KASFqoE,uBAOb43C,qBAAsB,SAAUvpG,EAASy8F,GAErCh2G,EAAE,wDAAyDg2G,GAAgB3zG,SAC1DrC,EAAE,KAAMA,EAAE0P,OAAOY,KAAKyP,KAF5Bld,KAEsC2/G,oBAAqBthH,SAAY,0BAA2BqY,QAAWA,OAC7GxS,SAAS/G,EAAE,qDAAsDg2G,KAMhFiN,gBAAiB,SAAUn3E,EAAMpnB,GAS7B,IAA8C,GAL9B1kB,EAAE2N,IAAI3N,EAAE,KAAM0kB,GAAY,SAAUzS,GAChD,OAAOjS,EAAEiS,GAAKvR,KAAK,QAITqM,QAAQ/M,EAAE8rC,GAAMprC,KAAK,OAAc,CAC7C,IAAIP,EAAKH,EAAE8rC,GAAMprC,KAAK,MAClB+F,EAAQzG,EAAE,QAAS8rC,GAAM92B,OACzBmuG,EAAcnjH,EAAE,KAAMA,EAAE0P,OAAOY,KAAKyP,KAXjCld,KAW2C2/G,oBAAqBthH,SAAY,cAAef,GAAMA,EAAIsG,MAASA,OAGjH28G,EAAcpjH,EAAE,UAAW0kB,GAC3B0+F,EAAYtuE,SAAS,sBACrBsuE,EAAY/gH,SACZrC,EAAE,KAAM0kB,GAAW+2B,QAAQ0nE,IAE3BnjH,EAAE,KAAM0kB,GAAW+2B,QAAQ0nE,GAnBxBtgH,KAsBFg1G,mBAAmB73G,EAAE8rC,GAAMprC,KAAK,MAAOV,EAAE,QAAS8rC,GAAM92B,QAAQ,KAO7E4nB,WAAY,SAAU95B,EAASugH,GAC3B,IACIC,EAAKxgH,EAAQm9B,SACbvb,EAAY5hB,EAAQ8yC,QAAQ,+BAgBhC,GAdyB,IAArBlxB,EAAU3c,SACV2c,EAAY5hB,EAAQ8yC,QAAQ,uCAG3BytE,SARMxgH,KAYKqiD,MAAMuxD,iBAAiB6M,EAAG5iH,KAAK,OAZpCmC,KAUFy1F,eAAgBn4F,GAAImjH,EAAG5iH,KAAK,QAMrC4iH,EAAGjhH,SAECqiB,EAAUve,KAAK,MAAM4B,QAAU,IAAMs7G,EACrCrjH,EAAE,2BAA4B0kB,GAAWgE,YAAY,UAnB9C7lB,KAoBF8/G,mBAAmB,MApBjB9/G,KAqBF8/G,mBAAmB,0BACrB,GAAoC,IAAhCj+F,EAAUve,KAAK,MAAM4B,QAAgBs7G,EAAsB,CAClE,IAAIE,EAAiBvjH,EAAE0P,OAAOY,KAAKyP,KAvB5Bld,KAuBsC2/G,oBAAqBthH,SAAY,4BAC9ElB,EAAE,KAAMujH,GAAgBx8G,SAAS/G,EAAE,KAAM0kB,MAOjDq+F,eAAgB,SAAUS,GACtB,IAAI5gH,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlBytG,KACA18F,EAAQ,IAAItmB,EAAE4S,SA0ClB,OAxCK4wG,EAAIz3E,KAAKhkC,QAAUlF,KAAKqiD,MAAMsxD,mBAG/BjhG,EAAWw2B,KAAOy3E,EAAIz3E,KACtBlpC,KAAKoC,UACI+F,KAAK,SAAUtK,GAGZV,EAAE0D,KAAKhD,EAAM,SAAUiD,EAAGsO,GACtB,IAAI+5B,EACJ,cAAe/5B,EAAIxL,OACf,IAAK,SACDulC,EAAa/5B,EAAIxL,MACjB,MACJ,IAAK,SACDulC,EAAa/5B,EAAIxL,MAAMkN,WACvB,MACJ,IAAK,SACDq4B,EAAa/5B,EAAIxL,MAAMe,QAAQ,IAAI8J,OAAO,0BAA4BkyG,EAAIz3E,KAAO,0BAA2B,MAAO,uBACnH,MACJ,QACIC,EAAa/5B,EAAIxL,WAI0B,IAAxC7D,EAAKsiD,MAAMuxD,iBAAiBxkG,EAAI9R,KACvC6iH,EAAYv3G,MACRtL,GAAI8R,EAAI9R,GACR0D,MAAOmoC,EACPvlC,MAAOwL,EAAIxL,UAKvB6f,EAAMtT,QAAQgwG,MAG1B18F,EAAM6uC,OAAOvyD,EAAKgN,YAAY,mDAG3B0W,GAMXs9C,gBAAiB,SAAUn9D,GACvB,IACI8O,EADO1S,KACW0S,WAClBkuG,EAA8B,iBAAVh9G,EAAqB+Y,KAAKhE,MAAM/U,GAAOA,MAAQA,EAAMA,MAFlE5D,KAKN+xC,SAAS6uE,QAEA14G,IAAVtE,GACI8O,EAAWqyC,UARR/kD,KASEuuB,MAAMnf,IAAIxL,EAAM5C,QAQjCoqE,eAAgB,WACZ,IACI14D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,cAE9C,OAAOpyD,EAAEy8C,UAAUv7C,GACff,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClBjd,MAAO8O,EAAW9O,MAClBmhD,UAAU,KAIlB86D,kBAAmB,WACf,IACIptG,EADOzS,KACQ0rE,aAGnBvuE,EAAE,oBAAqBsV,GAAS0U,OAAO,SACvChqB,EAAE,gCAAiCsV,GAAS0U,OAAO,SAGnDhqB,EAAE,2BAA4BsV,GAASjT,SAGvCrC,EAAE,mCAAoCsV,GAASjT,SAXpCQ,KAaNuuB,MAAMltB,SAAS,0BAMxB2zG,mBAAoB,SAAU13G,EAAIsG,EAAOsxG,GAC1Bl1G,KAEFqiD,MAAMuxD,iBAAiBt2G,WAFrB0C,KAGKqiD,MAAMuxD,iBAAiBt2G,GAH5B0C,KAMNqiD,MAAMuxD,iBAAiBt2G,IAAQof,KAASpf,GAAMA,EAAIsG,MAASA,GAASpE,OAAU01G,MC3d3FroG,OAAO23D,UAAUhmB,OAAO/3C,OAAO,iCAC3B+Q,KAAM,SAAUnM,GACDrL,KAENqL,OAASA,EAFHrL,KAKNsN,OAAOjC,IAOhB+iF,gBAAiB,WACb,OAAOpuF,KAAK8iE,cAAcvT,YAAY,iBAQ1C8+B,cAAe,SAAUhwF,GACrB,IACIqU,EADO1S,KACW0S,WAClB5O,EAFO9D,KAEY0S,WAAW5O,YAGlC,OAAO3G,EAAEy8C,UAAUv7C,GACff,GAAIuP,OAAOY,KAAKmT,YAAYlO,EAAWmO,OACvCs5B,YAAattC,OAAOY,KAAKmT,YAAYlO,EAAWynC,aAChDr2C,YAAaA,KAQrBqnE,cAAe,WACX,IACI1nD,EAAQ,IAAItmB,EAAE4S,SACd1R,EAFO2B,KAESouF,kBAGhB7qF,EALOvD,KAKKquF,cAAchwF,GAG9B,OAFAolB,EAAMtT,QAAQ5M,GAEPkgB,EAAMlb,WAGjBuqE,iBAAkB,WACd,IAAI/yE,EAAOC,KACP6hB,EAAY9hB,EAAK8zE,qBAErBhyD,EAAUxgB,SAAS,0BACnBwgB,EAAUve,KAAK,oBAAoB6B,OACnCpF,EAAK+zE,oBAAoB3uE,OAGzBpF,EAAKuN,SAGLnQ,EAAE4C,EAAKE,SAASwM,GAAG,QAAS,SAAUwB,GAClCpB,OAAOk1E,QAAQzoD,QACfx3B,WAAW,WACP3E,EAAEqM,KAAKzJ,EAAKmzE,iBACXrvD,KAAK,SAAUg9F,GACZA,EAAS/tC,sBAEd,MAKXI,cAAe,WACX,IACIzgE,EADOzS,KACQ0rE,aACfx7D,EAAW/S,EAAE4S,WAFN/P,KAINqL,OAAOigG,KAAO74F,EAAQsgC,QAAQ,yBAGnC,IAAIz0C,EAAO,IAAIuO,OAAO23D,UAAU32D,WAAWizG,QAAQxiH,KAPxC0B,KAOkDqL,QAG7D,OAFA6E,EAASC,QAAQ7R,GAEV4R,EAAS3H,aCzFxBsE,OAAO23D,UAAUlmE,KAAKmI,OAAO,4CAC3Bs6G,eAAgB,KAQhBvpG,KAAM,SAASnM,GACX,IAAItL,EAAOC,KACPnC,EAAOwN,EAAOxN,UAEW,IAAjBwN,EAAW,KACnBtL,EAAKurG,KAAOjgG,EAAOigG,KAGnB7qF,QAAQ4yE,KAAK,mHAIjBx1F,EAAK6U,WAAWk6E,gBAAiB,EAGjC7sF,EAAKuN,OAAOjC,GAGZtL,EAAKihH,gBAGL,IAAItuG,EAAa3S,EAAK2S,WAItBA,EAAWg3D,YAAc,WACzBh3D,EAAW42D,WAAa,OAIxBnsE,EAAE0D,KAAKd,EAAKxC,QAAS,WACbwC,EAAK2S,YAAc3S,EAAK2S,WAAWqyC,WACnChlD,EAAK2S,WAAWqyC,UAAqC,IAAzBryC,EAAWkzC,aAK/C,IAAIvnD,EAAW0B,EAAKkhH,kBACpBlhH,EAAK8gH,SAAW1jH,EAAE4C,EAAKsuF,cAAchwF,IACrC0B,EAAKurG,KAAK1pG,OAAO7B,EAAK8gH,UAKtB9gH,EAAKmhH,KAAO,IAAIjsF,MAAM8V,OAAOx+B,GAAG40G,KAAKphH,EAAK8gH,UACtCznE,oBAAsB,EACtBgoE,SAAS,EACT5pG,KAAM,WACFzX,EAAKsE,oBAKbtE,EAAKshH,cAAgBlkH,EAAE,IAAM0P,OAAOY,KAAKmT,YAAYlO,EAAWmO,OAAQ9gB,EAAKmhH,KAAKI,mBAQtFn+C,eAAgB,SAAUtlE,GAIxBA,EAAK6U,WAAWk6E,gBAAiB,EAHtB5sF,KAMNsN,OAAOzP,IAOdojH,gBAAiB,WACf,OAAOjhH,KAAK8iE,cAAcvT,YAAY,cAQxC8+B,cAAe,SAAShwF,GACtB,IACIqU,EADO1S,KACW0S,WAGlBw6E,EAJOltF,KAIYzC,QAAQ2H,OAAS,EAMxC,OAHA2H,OAAOY,KAAKqsB,uBAAuB,eAAiBpnB,EAAWpV,IAC/DuP,OAAOY,KAAKgsB,oBAAoB,eAAiB/mB,EAAWpV,GAAI,MAEzDH,EAAEy8C,UAAUv7C,GACjBf,GAAIuP,OAAOY,KAAKmT,YAAYlO,EAAWmO,OACvC5iB,MAAOyU,EAAWynC,YAClBuL,SAAUhzC,EAAWgzC,SACrBwnC,YAAaA,KAQjB7oF,eAAgB,WACd,IAAItE,EAAOC,KAEX7C,EAAE,sBAAuB4C,EAAK8gH,UAAUp0G,GAAG,QAAS,SAAUguC,GAC5DA,EAAIvG,kBAEJn0C,EAAKoL,cAAchO,EAAE6C,MAAMsB,KAAK,mBAUpC6J,cAAe,SAAUC,EAAQC,GAGhB,UAAXD,GAFOpL,KAGJgpB,UAGQ,QAAX5d,GANOpL,KAOJuhH,SAGQ,WAAXn2G,GAVOpL,KAWJwhH,eAQTx4F,QAAS,WACP,IACItW,EADO1S,KACW0S,WAGtB7F,OAAOY,KAAKqsB,uBAAuB,eAAiBpnB,EAAWpV,IAJpD0C,KAMNsrG,KAAKztG,KAAK,mBAAmBytC,SAAS,UANhCtrC,KAONkhH,KAAKvzG,UAPC3N,KAQNkhH,KAAKjhH,QAAQT,UAGpBgiH,YAAa,WACX,IAAIzhH,EAAOC,KAIPu4C,EAAgBx4C,EAAK+iE,cAAcvT,YAAY,qBAC/CkyD,EAAe1hH,EAAK2hH,oBACpBC,EAAsB1sF,MAAM52B,SAASk6C,GAAiBW,cAAc,IACpE0oE,EAAczkH,EAAEwkH,GAAsBhnF,KAAM8mF,EAAcxjH,MALlD,kBAKgEmN,OAJ/D,WAIiF8R,QAE9F0kG,EAAYzoE,sBACVpxB,MAAO,WACLhoB,EAAKi4D,qBAAqB,4BAC1Bh4D,KAAK2N,UACL3N,KAAKC,QAAQT,UAEf45C,oBAAoB,EACpB7uB,OAAO,IAGTxqB,EAAK8hH,0BAA0BD,GAC/B7hH,EAAKi4D,qBAAqB,yBAC1B4pD,EAAYzoE,qBAAqB,SAOnCuoE,kBAAmB,WACjB,IACIhvG,EADO1S,KACW0S,WAClB+uG,KAGAK,EAAej1G,OAAOY,KAAKmsB,oBAAoB,eAAiBlnB,EAAWpV,IAAMqf,KAAKhE,MAAM9L,OAAOY,KAAKmsB,oBAAoB,eAAiBlnB,EAAWpV,KAAO,KAC/JC,EAAUukH,GANH9hH,KAMsC+hH,aAWjD,OATA5kH,EAAE0D,KAAKtD,EAAS,SAAS4D,EAAOzC,GACzBA,EAAOqC,KAAQrC,EAAOmJ,SACzBnJ,EAAOoK,YAAoC,IAAnBpK,EAAa,QAAoBA,EAAOoK,OAChE24G,EAAa74G,KAAKlK,MAItBmO,OAAOY,KAAKgsB,oBAAoB,eAAiB/mB,EAAWpV,GAAIqf,KAAK1E,UAAUwpG,IAExEA,GAQTI,0BAA2B,SAAS9oE,GAClC,IACIrmC,EADO1S,KACW0S,WAElBumC,EAAqBF,EAAez1C,KAAK,oCAG7Cy1C,EAAetsC,GAAG,QAAS,0CAA2C,WACpEssC,EAAeI,qBAAqB,WAGtCJ,EAAetsC,GAAG,QAAS,oCAAqC,WAC9D,IAAIq1G,EAAej1G,OAAOY,KAAKmsB,oBAAoB,eAAiBlnB,EAAWpV,IAAMqf,KAAKhE,MAAM9L,OAAOY,KAAKmsB,oBAAoB,eAAiBlnB,EAAWpV,KAAO,KAI/J0kH,EAAc/oE,EAAmB31C,KAAK,SAASwH,IAAI,WAErD,OAAS3J,MAAOhE,EADL6C,MACanC,KAAK,SAAUiL,OAD5B9I,KACyCw1F,WAGtDr4F,EAAE0D,KAAKmhH,EAAa,SAAS7gH,EAAO8nC,GAClC,IAAIg5E,EAAWh5E,EAAK9nC,MAAQ,EAE5B2gH,EAAa3gH,GAAO2H,OAASmgC,EAAKngC,OAElC,IAAIo5G,EAAO/kH,EAAE,kCAAoC8kH,EAAW,qCAAuCA,EAAW,KAC1Gh5E,EAAKngC,OACPo5G,EAAK78G,OAEL68G,EAAK/8G,SAIT0H,OAAOY,KAAKgsB,oBAAoB,eAAiB/mB,EAAWpV,GAAIqf,KAAK1E,UAAU6pG,IAC/E/oE,EAAeI,qBAAqB,WAGtCF,EAAmBxsC,GAAG,QAAS,QAAS,WAGlCwsC,EAAmB31C,KAAK,0BAA0B4B,OAAS,EACzC/H,EAHX6C,MAGmBoD,GAAG,YAG7BjG,EANO6C,MAMC6lB,YAAY,gBAAgBxkB,SAAS,YAC7ClE,EAPO6C,MAOCqB,SAAS,gBAAgBwkB,YAAY,YAE/C1oB,EATS6C,MASDsqC,KAAK,WAAW,MAY9BwoC,iBAAkB,WAChB,IAAI/yE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACjBphE,EAAU1S,EAAK2rE,aAEnB7pD,EAAUxgB,SAAS,0BAEc,KAA7BtB,EAAK2S,WAAW2rC,UAClB5rC,EAAQpR,SAAS,iCAInBtB,EAAK8zE,qBAAqBvwE,KAAK,oBAAoB6B,OACnDpF,EAAK+zE,oBAAoB3uE,OAGzBpF,EAAKuN,SAGLvN,EAAKoiH,kBAGLzvG,EAAWu6E,gBAAkBv6E,EAAWu6E,kBAAmB,EAEtDv6E,EAAWu6E,kBACVv6E,EAAW7U,KACW,KAApB6U,EAAW7U,MAAiD,IAAjC6U,EAAW7U,KAAS,KAAEqH,QAAgBwN,EAAW7U,KAAKqC,KAAO,EAC1FH,EAAKqiH,eAAUl6G,EAAWnI,EAAKvC,OAAQuC,EAAKtC,WAE5CsC,EAAKsiH,WAAW3vG,EAAW7U,MAG3BV,EAAEqM,KAAKzJ,EAAKqR,SACTjJ,KAAK,WACJpI,EAAKsoE,qBAAsBvL,SAAS,IACpC/8D,EAAKurG,KAAKztG,KAAK,mBAAmBytC,SAASvrC,EAAKmhH,KAAK5jH,IAErDyC,EAAKuiH,gCACLviH,EAAKwiH,sBACLxiH,EAAKgC,gBAIXhC,EAAKqiH,UAAU1vG,EAAWxS,KAAMwS,EAAWlV,OAAQkV,EAAW9L,aASpE27G,oBAAqB,WACnB,IACI7vG,EADO1S,KACW0S,WAClB8vG,EAAa,EACb7/F,EAAY,EAGd,IAAIjQ,EAAW7U,MAAoC,IAA5B6U,EAAW7U,KAAKkL,QAAvC,CAIF,IAAIsrC,EAVOr0C,KAUSkhH,KAAKv3F,QAAQrmB,KAAK,8BAA8BzF,KAAK,uBAErEw2C,GACFA,EAAS/6B,QAGX,IAAImpG,EAhBOziH,KAgBUkhH,KAAKv3F,QAAQrmB,KAAK,eAAe+O,IAAI,GACtDqwG,EAjBO1iH,KAiBakhH,KAAKv3F,QAAQrmB,KAAK,6BAA6B+O,IAAI,GAE3EgiC,EAASrvC,KAAK,SAAU,SAAU0hB,GAChC,IAAIa,EAAOb,EAAM87F,WACb3/F,EAAM6D,EAAM/D,UAEhB,GAAI4E,IAASi7F,EAAY,CACvB,IAAIG,EAAgB,eAA2B,EAAX,EAAgB,MACpDD,EAAatwG,MAAMwwG,UAAYD,EAC/BD,EAAatwG,MAAMywG,gBAAkBF,EACrCD,EAAatwG,MAAM0wG,WAAaH,EAEhCH,EAAaj7F,EAGf,GAAI1E,IAAQF,EAAW,CACrB,IAAIogG,EAAe,eAA0B,EAAV,EAAe,MAClDN,EAAUrwG,MAAMwwG,UAAYG,EAC5BN,EAAUrwG,MAAMywG,gBAAkBE,EAClCN,EAAUrwG,MAAM0wG,WAAaC,EAE7BpgG,EAAYE,OASlBy/F,8BAA+B,WAC7B,IAEI95E,EAFAzoC,EAAOC,KAGPc,GAAK,EACL4R,EAAa3S,EAAK2S,WAEtB,IAAIA,EAAW7U,MAAoC,IAA5B6U,EAAW7U,KAAKkL,QAAvC,CAMA,IAJA,IAAIi6G,EAAQjjH,EAAKshH,cAAc/9G,KAAK,oBAChC2/G,EAAO9lH,EAAE,oBAAqB6lH,GAC9BE,EAAW/lH,EAAE,yBAEVqrC,EAAQy6E,IAAOniH,IAAI,CACxB,IAAIqiH,EAAMhyG,SAAS2d,cAAc,OACjCq0F,EAAI/wG,MAAM4K,MAAQwrB,EAAM46E,YAAc,KACtCF,EAASthH,OAAOuhH,GAMlB,IAHA,IAAI9gH,EAAOlF,EAAE,KAAM6lH,GAAS7lH,EAAE,KAAM6lH,GAAO99G,OAAS,EAChDm+G,EAAiBlmH,EAAE,8BAEdmF,EAAI,EAAGA,EAAID,EAAMC,IAAK,CAC7B,IAAI1D,EAAMzB,EAAE,YAAcmF,EAAI,GAAK,cACnC+gH,EAAezhH,OAAOhD,GAIxBmB,EAAKmhH,KAAKv3F,QAAQrmB,KAAK,8BAA8BrB,QACrDlC,EAAKmhH,KAAKv3F,QAAQrmB,KAAK,6BAA6BrB,QAGpDlC,EAAKmhH,KAAKv3F,QAAQrmB,KAAK,8BAA8B1B,OAAOyhH,GAG5DtjH,EAAKmhH,KAAKv3F,QAAQrmB,KAAK,qBAAqBs1C,QAAQsqE,EAASvrG,SAG7D,IAAIpR,EAASxG,EAAKshH,cAAc/9G,KAAK,sBACrCvD,EAAKmhH,KAAKv3F,QAAQrmB,KAAK,6BACpB1B,OAAOzE,EAAE,4CACPyE,OAAOshH,GAAUthH,OAAO2E,IAG7BxG,EAAKmhH,KAAKoC,OAAOrhH,QACjB,IAAIjD,EAAQe,EAAKshH,cAAc/9G,KAAK,+BACpCvD,EAAKmhH,KAAKoC,OAAO1hH,OAAO5C,KAO1BmjH,gBAAiB,WACf,IAAIpiH,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB6wG,EAAkBxjH,EAAKmhH,KAAKv3F,QAAQrmB,KAAK,8BAA8BzF,KAAK,uBAEhFkC,EAAKgiH,aAAehiH,EAAKyjH,mBAEzBzjH,EAAK0jH,YAActmH,EAAEomH,EAAgBG,eAAelqE,YAClDj8C,QAASwC,EAAKgiH,aACd9jH,MAAOyU,EAAWynC,YAClBt6C,KAAME,EAAK8jE,UACXrmE,OAAQkV,EAAWlV,QAAU,GAC7BoJ,UAAW8L,EAAW9L,WAAa,GACnCnJ,SAAUoP,OAAOwkB,SAASsyF,mBAAqB,MAC/CtlH,UACEC,KAAMyB,EAAK+iE,cAAcvT,YAAY,QACrC/wD,MAAOuB,EAAK+iE,cAAcvT,YAAY,cACtC9wD,WAAYsB,EAAK+iE,cAAcvT,YAAY,oBAC3C7wD,OAAQqB,EAAK+iE,cAAcvT,YAAY,qBACvC5wD,cAAeoB,EAAK+iE,cAAcvT,YAAY,6BAC9C3wD,IAAKmB,EAAK+iE,cAAcvT,YAAY,kBACpCzwD,KAAMiB,EAAK+iE,cAAcvT,YAAY,mBACrCxwD,YAAagB,EAAK+iE,cAAcvT,YAAY,2BAC5CvwD,MAAOe,EAAK+iE,cAAcvT,YAAY,oBACtChxD,QAAS,IAEXc,SACEC,IAAKoT,EAAWgzC,SAChBnmD,KAAMmT,EAAWkzC,WAAalzC,EAAWwsE,aACzC1/E,OAAQkT,EAAWizC,YACnBlmD,QAASiT,EAAWysE,aAEtBn2E,UACEwkF,SAAUrwF,EAAE+f,KAAKrQ,OAAOC,aAAaC,YAAY,0BACjDqtC,UAAWj9C,EAAE+f,KAAKrQ,OAAOC,aAAaC,YAAY,2BAClDstC,YAAal9C,EAAE+f,KAAKrQ,OAAOC,aAAaC,YAAY,iCACpDutC,YAAan9C,EAAE+f,KAAKrQ,OAAOC,aAAaC,YAAY,8CAEtDvF,SAAU,SAAU6D,GAClB,OAAOtL,EAAKyH,SAAS6D,EAAO3M,OAAQ2M,EAAOtK,IAAKsK,EAAOzH,MAAOyH,EAAOpE,WAEvE28G,UAAW,SAAUv4G,GACnB,OAAOtL,EAAK2D,YAAY2H,EAAO3M,OAAQ2M,EAAOtK,IAAKsK,EAAOvM,KAAMuM,EAAOpE,WAEzE48G,YAAa,SAAUx4G,GACrBtL,EAAK8jH,YAAYx4G,EAAOtK,MAE1B+iH,cAAe,SAAUz4G,GACvBtL,EAAK+jH,cAAcz4G,EAAOtK,MAE5BgjH,QAAS,SAAU14G,GACjBtL,EAAKgkH,QAAQ14G,EAAOtK,MAEtBijH,UAAW,SAAU34G,GACnBtL,EAAKikH,UAAU34G,EAAOtK,MAExBkjH,gBAAiB,SAAU54G,GACzBtL,EAAKkkH,gBAAgB54G,EAAOtK,MAE9BmjH,cAAe,SAAU74G,GACvBtL,EAAKmkH,cAAc74G,IAErB84G,cAAe,SAAU94G,GACvBtL,EAAKqiH,UAAU/2G,EAAOnL,KAAMmL,EAAO7N,OAAQ6N,EAAO5N,cAQxD2mH,yBAA0B,WAEbl5G,MAAMiD,UAAUe,MAAMhD,KAAKmC,UAAW,IASnDw1G,YAAa,SAAU9iH,GACVf,KACKyjH,YACG5oE,eAGMv3C,KAAK,4CAA8CvC,EAAM,KACvEM,SAAS,8BAQtByiH,cAAe,SAAU/iH,GACZf,KACKyjH,YACG5oE,eAEFv3C,KAAK,4CAA8CvC,EAAM,KACvE8kB,YAAY,8BAQjBk7C,gBAAiB,SAAUn9D,KAO3BwvE,oBAAqB,SAAUxvE,KAM/BgwE,WAAY,aAMZoc,2BAA4B,aAM5Bq0B,iBAAkB,aAOlBC,SAAU,SAAUhnH,KAMpBinH,gBAAiB,aAMjBf,iBAAkB,WAChB,IACIjmH,EADOyC,KACQzC,QAafinH,KAmBJ,OAlBAA,EAAY57G,MAVV3H,KAAM,KACNE,MAAO,EACPH,MAAO,KACP6G,QAAQ,EACR8oE,MAAO,SACP5vE,KAAK,IAOP5D,EAAE0D,KAAKtD,EAAS,SAAU4D,EAAOzC,GAE/BA,EAAOkE,YAAczB,EAAQ,EAC7B,IAAIsjH,EAAe53G,OAAOY,KAAKqT,QAAQpiB,EAAOgU,WAAWynC,aAA+C,IAAhCz7C,EAAOgU,WAAWynC,YACtFsb,GACFx0D,KAAMvC,EAAOgU,WAAWmO,MACxB1f,MAAOA,EAAQ,EACfH,MAAOyjH,EACP1jH,KAAK,EACL8G,QAAUnJ,EAAOgU,WAAW2iD,SAAqC,gBAA1B32D,EAAOgU,WAAWzI,OAA8D,IAApCvL,EAAOgU,WAAW6tF,cACrGz4F,YAAcpJ,EAAOgU,WAAWm6E,UAAYnuF,EAAOgU,WAAWm6E,SAASliF,UAAYjM,EAAOgU,WAAWm6E,SAASliF,eAAYzC,EAC1H9B,iBAAkB1H,EAAOgU,YAE3B8xG,EAAY57G,KAAK6sD,KAGZ+uD,GAOTriH,QAAS,WACP,IACI+N,EAAW/S,EAAE4S,WAMjB,OAJA5S,EAAEqM,KAHSxJ,KAGCoiH,aAAaj6G,KAAK,WAC5B+H,EAASC,YAGJD,EAAS3H,WAOlBm8G,UAAW,WAGT,OAAiC,MAFtB1kH,KAEC2kH,kBAFD3kH,KAEkC2kH,kBAAkBp8G,UAAY,MAQ7E85G,WAAY,SAAUxkH,GACpB,IACIS,EADO0B,KACKyjH,aAEX5lH,EAAKkL,SAAYlL,EAAKkL,SAA4B,IAAjBlL,EAAKkL,SAHhC/I,KAIJkhH,KAAKv3F,QAAQrmB,KAAK,uDAAuD6B,OAJrEnF,KAKJkhH,KAAKv3F,QAAQrmB,KAAK,8BAA8BoB,IAAI,QAAS,SAEO,SAPhE1E,KAOAkhH,KAAKv3F,QAAQrmB,KAAK,2BAA2BoB,IAAI,YAPjD1E,KAQFkhH,KAAKv3F,QAAQrmB,KAAK,uDAAuD+B,OAK9ExH,GAbOmC,KAaM0S,aAbN1S,KAcJ0S,WAAW7U,KAAOA,EAddmC,KAeJ0wF,iBAAiB7yF,GACtBS,EAAK4D,QAAQrE,KAWjBukH,UAAW,SAAUliH,EAAM1C,EAAQC,GACjC,IAAIsC,EAAOC,KACP0S,EAAa3S,EAAK2S,WA0CtB,OAxCA3S,EAAK4kH,kBAAoBxnH,EAAE4S,WAC3BhQ,EAAKvC,OAASA,EACduC,EAAKtC,SAAWA,EAGhByC,EAAOA,GAAQ,EACf1C,EAASA,GAAWkV,EAAWlV,QAAU,KACzCC,EAAWA,GAAaiV,EAAW9L,WAAa,MAGhD8L,EAAWxS,KAAOA,EAClBwS,EAAWlV,OAASA,EACpBkV,EAAWjV,SAAWA,EACtBiV,EAAW6qB,KAAO//B,EAAS,IAAMC,EAGjCsC,EAAKyB,eAELrE,EAAEqM,KAAKzJ,EAAKuhF,iBACTz9D,KAAK,SAAUhmB,GACdkC,EAAKgC,aAEDlE,IACEA,EAAK0kF,0BACP11E,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,0CACtDhN,EAAK4kH,kBAAkBx0G,WAEvBhT,EAAEqM,KAAKzJ,EAAKsiH,WAAWxkH,IACpBsK,KAAK,WAEJpI,EAAKuiH,gCACLviH,EAAKwiH,sBAELxiH,EAAKsoE,qBAAsBvL,SAAS,IACpC/8D,EAAK4kH,kBAAkBx0G,eAM5BpQ,EAAK4kH,kBAAkBp8G,WAQhCq8G,eAAgB,SAAUv5G,KAQ1B+7D,YAAa,SAAUF,KAOvBg9C,cAAe,SAAU74G,GACvB,IACIqH,EADO1S,KACW0S,WAClB7U,KAECyO,OAAOyU,cAAcljB,IAJfmC,KAMJ+iE,YAAY7c,YACf96C,OAAQ,aACRvN,KAAMA,EACNgmD,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,cAZjBpkD,KAiBNoiH,UAAU/2G,EAAOnL,KAAMmL,EAAO7N,OAAQ6N,EAAO5N,WAQpDonH,YAAa,SAAUt4G,KAOvBu4G,WAAY,SAAUz5G,KAUtB7D,SAAU,SAAU9I,EAAQqC,EAAK6C,EAAOqD,GACtC,IAAIlH,EAAOC,KAEX,GAAItB,EAAOqC,IAAK,OAAO6C,EAEvB7D,EAAK6wF,WAAa7wF,EAAK6wF,eAGvB,IAAIhuF,EAAclE,EAAOyC,MAAQ,EAC7BkuE,EAAetvE,EAAKxC,QAAQqF,GAE3B7C,EAAKihH,aAAajgH,KAAMhB,EAAKihH,aAAajgH,OAC1ChB,EAAKihH,aAAajgH,GAAK6B,KAC1B7C,EAAKihH,aAAajgH,GAAK6B,OAGzB,IAAI8P,EAAa3S,EAAKihH,aAAajgH,GAAK6B,GAAa8P,YAAc28D,EAAa/Q,mBAC5EjJ,OAAiCntD,IAAvBwK,EAAW2iD,SAAwB3iD,EAAW2iD,aACrBntD,IAAxBwK,EAAWqyC,UAAyBryC,EAAWqyC,SAS9D,GANAryC,EAAWqyC,UAAW,EACtBsqB,EAAa38D,WAAWg3D,YAAc,QAEtC2F,EAAat9B,SAAShxC,EAAK6C,GAC3ByrE,EAAa2xB,gBAAgBjgG,GAEzBs0D,EAAS,CACX,IAAI5xC,EAAQ,IAAItmB,EAAE4S,SAYlB,OAXAs/D,EAAa38D,WAAaA,EAE1BvV,EAAEqM,KAAK6lE,EAAajE,eAAerqE,EAAK6C,IAAQuE,KAAK,SAAUrJ,GAE7D,IAAK,IAAIwD,EAAI,EAAGA,EAAIvC,EAAKxC,QAAQ2H,OAAQ5C,IACvCvC,EAAK6tF,cAAc7sF,GAAOhB,EAAK6tF,cAAc7sF,OAC7ChB,EAAKyvF,gBAAgBzuF,EAAKuB,GAAG+yD,SAAU,EAEzC5xC,EAAMtT,QAAQrR,KAGT2kB,EAAMlb,UAGb,MAAO,IAYX7E,YAAa,SAAUhF,EAAQqC,EAAKjC,EAAMmI,GACxC,IAiBMwL,EAdF7P,EAAclE,EAAOyC,MAAQ,EAC7BkuE,EAJOrvE,KAIazC,QAAQqF,GAC5B8P,GAAsDxK,MAL/ClI,KAKaghH,aAAajgH,GAAK6B,GAL/B5C,KAKiEghH,aAAajgH,GAAK6B,GAAa8P,gBAAaxK,IAAcmnE,EAAa/Q,mBAC/IjJ,OAAiCntD,IAAvBwK,EAAW2iD,SAAwB3iD,EAAW2iD,QACxDtQ,OAAmC78C,IAAxBwK,EAAWqyC,UAAyBryC,EAAWqyC,SAS9D,GALEA,IADE99C,EAMAouD,EAEF,GAAItQ,EAAU,CAEZ,IAAIggE,EAAmB11C,EAAa38D,WAAWqyC,SAC/CsqB,EAAa38D,WAAWqyC,SAAWA,EAG/BsqB,EAAa38D,WAAWovD,iBAC1BrvD,EAAU48D,EAAaE,aAAaxuE,MAElC0R,EAAQC,WAAWk+D,2BA3BhB5wE,KA2BkD0S,WAAWmO,MAAQ,MAK5EwuD,EAAalrE,WAAWpD,EAAKjC,GAG7BuwE,EAAa38D,WAAWqyC,SAAWggE,OAEnC11C,EAAavD,mBAAmB/qE,EAAKjC,IAS3CsS,MAAO,WACL,IACI4zG,EADOhlH,KACcsN,SAEzB,OAAOnQ,EAAEqM,KAAKw7G,IAOhBzD,OAAQ,WACN,IAAIxhH,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElBmP,EAAY9hB,EAAK2gC,mBAAmB7e,UACpCojG,EAAcllH,EAAKgjE,YACnBD,EAAgB/iE,EAAK+iE,cAEzB/iE,EAAKyB,eAELrE,EAAEqM,KAAKzJ,EAAK6gF,oBACTz4E,KAAK,SAAUq4E,GACd,IAAI37B,EAAcnyC,EAAWmO,MAAQ,OAAS2/D,EAAQ,IAElD0kC,GACFrhE,SAAUnxC,EAAWpV,GACrB0mD,YAAea,EACfnhC,IAAKhR,EAAWyyG,QAChBrhE,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBvjC,MAAOgkC,EACPE,UAAU,EACVhB,cAAe,UACf5J,YAAaznC,EAAW86E,SACxB43B,UAAW5kC,EACX6kC,yBAAyB,EACzBC,WAAW,EACXrmC,aAAa,GAGXsmC,GACFziD,cAAiBA,EACjBC,YAAekiD,EACf7nF,OAAUr9B,EACVlC,MACE6U,WAAYwyG,IAIZM,EAAW,IAAI34G,OAAO23D,UAAUihD,SAASF,GAE7CpoH,EAAEsJ,OAAO++G,GACP/xC,YAAat2E,EAAE0kB,GAAWve,KAAK,yBAC/BrD,QAASF,EAAKE,QACd2zE,WAAY7zE,EAAK2lH,iBACjBC,aAAc5lH,EAAK6lH,gBACnBC,cAAe,WACb,OAAO,GAETC,SAAU/lH,EAAKgjE,YAAYvf,YAC3B72B,QAASu4F,IAGXnlH,EAAKgmH,wBAAwBP,GAC7BzlH,EAAKgC,eAEJqO,KAAK,SAAUurB,GAClB57B,EAAKgC,aACL8K,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,0BAA2B,YASrFg3G,QAAS,SAAUzmH,GACjB,IAAIyC,EAAOC,KAGSD,EAAK2gC,mBACXk5C,WAEd,IAAIlnE,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK2gC,mBAAmB7e,UACpCojG,EAAcllH,EAAKgjE,YACnBD,EAAgB/iE,EAAK+iE,cACrBje,EAAcnyC,EAAWmO,MAAQ,OAASvjB,EAAK,IAE/C4nH,GACFrhE,SAAUnxC,EAAWpV,GACrBA,GAAIoV,EAAWpV,GACfwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBJ,YAAaa,EACbhkC,MAAOgkC,EACPE,UAAU,EACVrhC,IAAKhR,EAAWszG,SAChBjiE,cAAe,WACf5J,YAAaznC,EAAW0nC,UACxBgrE,UAAW9nH,GAGTioH,GACFziD,cAAiBA,EACjBC,YAAekiD,EACf7nF,OAAUr9B,EACVlC,MACE6U,WAAYwyG,IAIZM,EAAW,IAAI34G,OAAO23D,UAAUihD,SAASF,GAE7CpoH,EAAEsJ,OAAO++G,GACP/xC,YAAat2E,EAAE0kB,GAAWve,KAAK,yBAC/BrD,QAASF,EAAKE,QACd2zE,WAAY7zE,EAAK2lH,iBACjBC,aAAc5lH,EAAK6lH,gBACnBC,cAAeL,EAAS1kC,kBACxBglC,SAAU/lH,EAAKgjE,YAAYvf,YAC3B72B,QAASu4F,IAGXnlH,EAAKgmH,wBAAwBP,IAQ/BxB,UAAW,SAAU1mH,GACnB,IAAIyC,EAAOC,KAEA,IAAP1C,EAKJuP,OAAO4sE,oBAAoBz5E,KAAK+M,YAAY,oCACzC5E,KAAK,WAEJhL,EAAEqM,KAAKzJ,EAAKihF,oBAAoB1jF,IAC7B6K,KAAK,SAAUtK,GAEdkC,EAAKqiH,YAEa,YAAdvkH,EAAKoM,MAGPlK,EAAKsoE,qBAAsB3R,YAAY,EAAMoG,SAAS,EAAO/7D,IAAKzD,QAf1EuP,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,uCAAwCF,OAAOC,aAAaC,YAAY,wCA0BlIk3G,gBAAiB,SAAU3mH,GAGzB,GAAW,IAAPA,GAAkB4K,MAAN5K,EAAhB,CASA,IAAIoV,EAXO1S,KAWW0S,WAClBmP,EAZO7hB,KAYU0gC,mBAAmB7e,UACpCojG,EAbOjlH,KAaY+iE,YACnBD,EAdO9iE,KAcc8iE,cACrBje,EAAcnyC,EAAWmO,MAAQ,OAASvjB,EAAK,IAE/C4nH,GACFrhE,SAAUnxC,EAAWpV,GACrBA,GAAIoV,EAAWpV,GACfwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBJ,YAAaa,EACbhkC,MAAOgkC,EACPE,UAAU,EACVrhC,IAAKhR,EAAWszG,SAChBjiE,cAAe,aACf5J,YAAaznC,EAAW4nC,YACxB8qE,UAAW9nH,EACX2oH,gBAAgB,GAGdV,GACFziD,cAAiBA,EACjBC,YAAekiD,EACf7nF,OAnCSp9B,KAoCTnC,MACE6U,WAAYwyG,IAIZM,EAAW,IAAI34G,OAAO23D,UAAUihD,SAASF,GAE7CpoH,EAAEsJ,OAAO++G,GACP/xC,YAAat2E,EAAE0kB,GAAWve,KAAK,yBAC/BrD,QA7CSD,KA6CKC,QAGd4lH,cAAeL,EAAS1kC,kBACxBglC,SAjDS9lH,KAiDM+iE,YAAYvf,YAC3B72B,QAASu4F,IAlDAllH,KAqDN+lH,wBAAwBP,QAlD3B34G,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,uCAAwCF,OAAOC,aAAaC,YAAY,wCAyDlI64G,gBAAiB,WACf,IACI11G,EAAW/S,EAAE4S,WAMjB,OAJA5S,EAAEqM,KAHSxJ,KAGCqhF,yBAAyBl5E,KAAK,WACxC+H,EAASC,YAGJD,EAAS3H,WAOlBm9G,iBAAkB,WAChB,IAAI3lH,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBxC,EAAW/S,EAAE4S,WACblS,KA4BJ,OA1BiC,IAA7BkC,EAAKylD,KAAKm0B,eACZx8E,EAAEqM,KACAzJ,EAAKylD,KAAKyhB,oBAAoBppE,GAC9BA,EAAKumD,YAAcrkD,EAAKylD,KAAK8d,gBAC7Bz/C,KAAK,WACL1mB,EAAEqM,KACAzJ,EAAKq9B,OAAO8jD,kBAAkBxuE,EAAW0yG,UAAWvnH,IAAOsK,KAAK,SAAU+9G,GACzD,sBAAbA,EAAKj8G,MACPlK,EAAKylD,KAAK82B,qBAAqB4pC,EAAKnqC,UACpCrpE,EAAWovD,gBAAiB,EAC5B5xD,EAASoiD,OAAO4zD,EAAKnqC,YAErBh8E,EAAKq9B,OAAOglF,YACP1vG,EAAWovD,iBACdpvD,EAAWovD,gBAAiB,GAE9B/hE,EAAK+hE,mBAAmB,GACxB5xD,EAASC,eAMfD,EAASoiD,QAAS6zD,UAAU,IAGvBj2G,EAAS3H,WAQlBw9G,wBAAyB,SAAUP,GACjC,IAAIzlH,EAAOC,KAEX7C,EAAEqM,KAAKg8G,EAAStyC,iBAAiB/qE,KAC/B,WACEq9G,EAASzjH,aACTyjH,EAASryC,iBAETqyC,EAAShgE,KAAK6T,IAAI,UAAW,SAAUiD,EAAGwtC,GACxC,GAAI0b,EAASra,UAAW,CACtB,IAAI7tG,EAAKkoH,EAASra,UAAUttG,KAAK,mBAAmBP,GAOpD,SAAS6E,IACPpC,EAAOC,KACP6M,OAAOi+B,uBAAuBQ,SAAS,UACvCk6E,EAASra,UAAUttG,KAAK,mBAAmB8P,UAC3C5N,EAAKgmH,wBAAwBP,GAV3BloH,EAAGkhB,UAAU,EAAGlhB,EAAG4H,UAAY+vB,MAAMmxF,QAAQC,QAC/ClkH,EAAQiM,MAAMrO,GAEdylH,EAASra,UAAUttG,KAAK,mBAAmBmH,KAAK,YAAa7C,EAAQ6C,KAAKjF,UAqBtFumH,sBAAuB,SAAU5nH,EAAQiQ,KAOzCs4D,oBAAqB,SAAUC,KAK/BwoB,SAAU,SAAU3uF,EAAK8f,KASzBld,gBAAiB,SAAU5C,EAAK8f,EAAOyzC,KASvCmL,0BAA2B,SAAU1+D,EAAK8f,EAAOyzC,KASjDuL,gBAAiB,SAAU9+D,EAAK8f,EAAOyzC,KASvC0L,qBAAsB,SAAUj/D,EAAK8f,EAAOyzC,KAS5C+L,sBAAuB,SAAUt/D,EAAK8f,EAAOyzC,KAQ7C0N,cAAe,SAAUjhE,EAAK8f,KAO9Brf,aAAc,WACZqL,OAAOk1E,QAAQzoD,SAOjBv3B,WAAY,WACV8K,OAAOk1E,QAAQ/jD,UCzwCnBnxB,OAAO23D,UAAUlmE,KAAKmI,OAAO,4BACzB+Q,KAAM,SAAUnM,GACZ,IACIxN,EAAOwN,EAAOxN,KAElBA,EAAK6U,WAAWk6E,gBAAiB,EACjC/uF,EAAK6U,WAAWq6E,YAAc,EAC9BlvF,EAAK6U,WAAW42D,WAAa,OAC7BzrE,EAAK6U,WAAWg3D,YAAc,WANnB1pE,KASNsN,OAAOjC,GAGZrL,KAAKghH,gBAGL,IAAItuG,EAAa1S,KAAK0S,WAGtBA,EAAWg3D,YAAc,WACzBh3D,EAAW42D,WAAa,OACxB52D,EAAWq6E,YAAc,EAGrBr6E,EAAW7U,MAAQ6U,EAAW7U,KAAKwE,OAvB5BrC,KAwBFumH,WAAaruG,OAAOxF,EAAW7U,KAAKwE,OAG7ClF,EAAE0D,KA3BSb,KA2BCzC,QAAS,SAAU4D,EAAOyC,GAC9B5D,KAAK0S,YAAc1S,KAAK0S,WAAWqyC,WACnC/kD,KAAK0S,WAAWqyC,UAAqC,IAAzBryC,EAAWkzC,aAK3ClzC,EAAW7U,MAAQ6U,EAAW7U,KAAKwE,MAAQqQ,EAAW7U,KAAKwE,KAAK6C,OAAS,IACzEwN,EAAW7U,KAAKwE,QAAU6V,QAAQxF,EAAW7U,KAAKwE,KAAK,OAO/D0+D,gBAAiB,SAAUn9D,KAC3BwvE,oBAAqB,SAAUxvE,KAC/BgwE,WAAY,aAIZoc,2BAA4B,aAK5Bq0B,iBAAkB,aAKlBC,SAAU,SAAUhnH,KAOpBkiE,WAAY,WAIR,OAFWriE,EAAEkzF,MADFrwF,KACaumH,QADbvmH,KAC2BowF,kBAE1B0L,OAAO,SAAU0qB,EAAMH,GAI/B,YAHwE,IAA7DG,EAAKljH,KAAK,SAAU2e,GAAM,OAAOA,EAAG,IAAMokG,EAAQ,MACzDG,EAAK59G,KAAKy9G,GAEPG,OACJ17G,IAAI,SAAUm+B,GACjB,OAAOA,EAAK,MAIpB6pC,iBAAkB,WACd,IAAI/yE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACjBphE,EAAU1S,EAAK2rE,aAEnBh5D,EAAWq6E,YAAc,EAEzBlrE,EAAUxgB,SAAS,0BACc,KAA7BtB,EAAK2S,WAAW2rC,UAChB5rC,EAAQpR,SAAS,iCAKrBtB,EAAK8zE,qBAAqBvwE,KAAK,oBAAoB6B,OACnDpF,EAAK+zE,oBAAoB3uE,OAGzBnF,KAAKsN,SACL,IAAIhP,EAAOyB,EAAKwzE,aAAexzE,EAAKwuB,MAAQxuB,EAAKzB,KAAOmU,EAAQnP,KAAK,IAAMuJ,OAAOY,KAAKmT,YAAYlO,EAAWmO,QAAQxf,SAAS,cAC3HxB,EAAOE,EAAK8jE,UACZtmE,EAAUwC,EAAKyjH,mBAEfiD,EAAoBn6G,OAAOkqD,KAAKj5D,EAAS,SAAU4R,GACnD,OAAQA,EAAa,cAIzB7Q,EAAKooH,wBACDnpH,QAASA,EACTU,MAAOyU,EAAWynC,YAClBt6C,KAAME,EAAK8jE,UACXxlE,UACIC,KAAMyB,EAAK+iE,cAAcvT,YAAY,oBACrChxD,QAASwB,EAAK+iE,cAAcvT,YAAY,uBACxC/wD,MAAOuB,EAAK+iE,cAAcvT,YAAY,qBACtC9wD,WAAYsB,EAAK+iE,cAAcvT,YAAY,2BAC3C7wD,OAAQqB,EAAK+iE,cAAcvT,YAAY,sBACvC5wD,cAAeoB,EAAK+iE,cAAcvT,YAAY,8BAC9C3wD,IAAKmB,EAAK+iE,cAAcvT,YAAY,mBACpC1wD,WAAYkB,EAAK+iE,cAAcvT,YAAY,2BAC3CzwD,KAAMiB,EAAK+iE,cAAcvT,YAAY,oBACrCxwD,YAAagB,EAAK+iE,cAAcvT,YAAY,4BAC5CvwD,MAAOe,EAAK+iE,cAAcvT,YAAY,qBACtCtwD,QAASc,EAAK+iE,cAAcvT,YAAY,uBACxCriD,UAAWnN,EAAK+iE,cAAcvT,YAAY,0BAE9ClwD,SACIC,IAAKoT,EAAWgzC,SAChBnmD,KAAOmT,EAAWkzC,WAAalzC,EAAWwsE,aAC1C1/E,OAAQkT,EAAWizC,YACnBlmD,QAASiT,EAAWysE,YACpB9S,UAAW35D,EAAW25D,UACtB3sE,WAAW,EACXwN,UAAWwF,EAAWhV,YACtBuP,aAAcw5G,EAAkBvhH,OAAS,GAAKwN,EAAW7U,KAAKwE,KAAK6C,OAAS,GAEhFg/G,cAAe,SAAU33G,GACT,aAAR1M,GACJE,EAAKgK,gBAAgBwC,IAEzBc,UAAW,SAAUd,GACL,aAAR1M,GAEJE,EAAK8kH,eAETV,cAAe,SAAU53G,GACT,aAAR1M,GACJE,EAAKqiH,UAAU71G,EAAGrM,KAAMqM,EAAG/O,OAAQ+O,EAAG9O,WAE1CuM,QAAS,SAAU0vD,GACf,OAAO35D,EAAK4mH,YAAYjtD,IAE5BlyD,SAAU,SAAU+E,GAChB,OAAOxM,EAAKyH,SAAS+E,EAAG7N,OAAQ6N,EAAGxL,IAAKwL,EAAG3I,MAAO2I,EAAGtF,WAEzD28G,UAAW,SAAUr3G,GACjB,OAAOxM,EAAK2D,YAAY6I,EAAG7N,OAAQ6N,EAAGxL,IAAKwL,EAAGzN,KAAMyN,EAAGtF,WAE3D48G,YAAa,SAAUt3G,KAGvBq6G,iBAAkB,WACd7mH,EAAK6rE,cAAcN,cAAevrE,EAAK2S,WAAW6rD,gBAClDx+D,EAAK6rE,eAAeN,cAAevrE,EAAK2S,WAAW02D,kBAEvDm4C,OAAQ,SAAUh1G,GACF,aAAR1M,GACJE,EAAKwhH,UAETwC,QAAS,SAAUx3G,GACH,aAAR1M,GACJE,EAAKgkH,QAAQx3G,EAAGxL,MAEpBijH,UAAW,SAAUz3G,GACL,aAAR1M,GACJE,EAAKikH,UAAUz3G,EAAGxL,MAEtBujH,SAAU,SAAU/3G,GAChBxM,EAAKukH,SAAS/3G,EAAGxL,MAErBkjH,gBAAiB,SAAS13G,GACV,aAAR1M,GACJE,EAAK8mH,WAAWt6G,EAAGxL,QAKvB2R,EAAW7U,MAAQ6U,EAAW7U,KAAKwE,MAAQqQ,EAAW7U,KAAKwE,KAAK6C,OAAS,IACzEwN,EAAW7U,KAAKwE,QAAU6V,QAAQxF,EAAW7U,KAAKwE,KAAK,MAG3DqQ,EAAWu6E,gBAAkBv6E,EAAWu6E,kBAAmB,EAEtDv6E,EAAWu6E,kBACRv6E,EAAW7U,MACXkC,EAAKsiH,WAAW3vG,EAAW7U,MAG3BV,EAAEqM,KAAKzJ,EAAKqR,SACPjJ,KAAK,WACFpI,EAAKsoE,qBAAsBvL,SAAS,OAG5C/8D,EAAKqiH,UAAU1vG,EAAWxS,KAAMwS,EAAWlV,OAAQkV,EAAW9L,aAK1E29G,gBAAiB,WACb,IACIvjH,EAAQ,GACRuF,EAAS,GACTmM,EAHO1S,KAGW0S,WAEtB,GAAIA,EAAWu+E,aAAc,CACzB,IAAIn/D,EAASpf,EAAWu+E,aAkBxB,GAhBIn/D,EAAO4sC,QACP19D,GAAS,UAAY8wB,EAAO4sC,MAAQ,KAGpC5sC,EAAOsT,aACP7+B,GAAU,qBAAuBurB,EAAOsT,WAAa,KAGrDtT,EAAO66C,OACP3rE,GAAS,uBAGT8wB,EAAO+6C,SACP7rE,GAAS,wBAGT8wB,EAAOi7C,WAAaj7C,EAAOm7C,WAI3BjsE,GAAS,qBAHQ6L,OAAOY,KAAKuF,aAAa8e,EAAOm7C,YAAc,gBAAkB,KACjEpgE,OAAOY,KAAKuF,aAAa8e,EAAOi7C,WAAa,aAAe,IAEpB,IAG5D,GAAIj7C,EAAO2xC,MAAuB,KAAf3xC,EAAO2xC,KAEtBziE,GAAS,eADU,IAA4B,GAAtB6I,OAAOioB,EAAO2xC,MAAc,KACd,IAI/C,OAASziE,MAAOA,EAAOuF,OAAQA,IAGnCi9G,iBAAkB,WACHxjH,KACW0S,WADtB,IAEInV,EAFOyC,KAEQzC,QAafinH,KAmBJ,OAlBAA,EAAY57G,MAVR3H,KAAM,KACNE,MAAO,EACPH,MAAO,KACP6G,QAAQ,EACR8oE,MAAO,SACP5vE,KAAK,IAOT5D,EAAE0D,KAAKtD,EAAS,SAAU4D,EAAOzC,GAE7BA,EAAOkE,YAAczB,EAAQ,EAC7B,IAAIsjH,EAAe53G,OAAOY,KAAKqT,QAAQpiB,EAAOgU,WAAWynC,aAA+C,IAAhCz7C,EAAOgU,WAAWynC,YACtFsb,GACAx0D,KAAMvC,EAAOgU,WAAWmO,MACxB1f,MAAOA,EAAQ,EACfH,MAAOyjH,EACP1jH,KAAK,EACL8G,QAAUnJ,EAAOgU,WAAW2iD,SAAsC,iBAA3B32D,EAAOgU,WAAWzI,OAA+D,IAApCvL,EAAOgU,WAAW6tF,cACtGz4F,YAAcpJ,EAAOgU,WAAWm6E,UAAYnuF,EAAOgU,WAAWm6E,SAASliF,UAAYjM,EAAOgU,WAAWm6E,SAASliF,eAAYzC,EAC1H9B,iBAAkB1H,EAAOgU,YAE7B8xG,EAAY57G,KAAK6sD,KAGd+uD,GAMXriH,QAAS,WAGL,OAAOhF,EAAEqM,KAFExJ,KAEQoiH,cAMvBsC,UAAW,WAGP,OAAiC,MAFtB1kH,KAEC2kH,kBAFD3kH,KAEkC2kH,kBAAkBp8G,UAAY,MAM/E85G,WAAY,SAAUxkH,GAClB,IACIN,EADOyC,KACQzC,QAGfM,GAJOmC,KAIM0S,aAJN1S,KAKF0S,WAAW7U,KAAOA,EALhBmC,KAMF0wF,iBAAiB7yF,EAAMN,GANrByC,KAQFokH,yBAAyB,UAAWvmH,KAOjDukH,UAAW,SAAUliH,EAAM1C,EAAQC,GAC/B,IAAIsC,EAAOC,KACP0S,EAAa3S,EAAK2S,WAatB,OAVAxS,EAAOA,GAAQ,EACf1C,EAASA,GAAU,GACnBC,EAAWA,GAAY,MAGvBiV,EAAWxS,KAAOA,EAClBwS,EAAW6qB,KAAO//B,EAAS,IAAMC,EAEjCoP,OAAOY,KAAKI,WAAWrM,eAEhBrE,EAAEqM,KAAKzJ,EAAKuhF,iBACdz9D,KAAK,SAAUhmB,GAEZ,GAAIA,EACA,OAAOV,EAAEqM,KACLzJ,EAAKsiH,WAAWxkH,IAClBsK,KAAK,WACHpI,EAAKsoE,qBAAsBvL,SAAS,QAG7CqL,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,iBAMnC82G,eAAgB,SAAUv5G,GACtB,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAiBtB,GAfArH,EAASA,MACTlO,EAAEsJ,OAAO4E,GACLqY,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBsC,YAAa1zC,EAAW2xC,YACxBD,YAAa1xC,EAAW0xC,YACxB7mB,KAAM7qB,EAAW6qB,KACjBr9B,KAAM,EACNmC,KAAMtC,EAAK2S,WAAW7U,KAAKkL,QAC3Bm/C,aAAcx1C,EAAWw1C,eAIzBx1C,EAAWi7E,sBAAuB,CAClC,IAAI5lF,EAAS2K,EAAWi7E,sBAAsBtiF,GAC9C,OAAiB,MAAVtD,EAAiBA,EAAOQ,UAAY,KAI/C,IAAIkb,EAAQ,IAAItmB,EAAE4S,SAelB,OAZAhQ,EAAKgjE,YAAYzf,cAAc0E,YAAY38C,GAAQlD,KAAK,SAAUtK,GAE1DkC,EAAKmV,UACLrX,EAAKwE,KAAOtC,EAAK8tF,gBAAgBhwF,EAAKwE,OAG1CohB,EAAMtT,QAAQtS,KACfuS,KAAK,SAAUA,GAEdqT,EAAM6uC,OAAOliD,KAGVqT,EAAMlb,WAKjB6+D,YAAa,SAAUF,GACnB,IACI5oE,EADO0B,KACK1B,KAGhB,GAJW0B,KAIF0S,WAAW25D,UAEhB,IADA,IAAIy6C,EAAWxoH,EAAKooH,uBAAuBnvG,eAAe,iBAAmBjZ,EAAKooH,uBAAuB,oBAChG5lH,EAAI,EAAGoE,EAAS4hH,EAAS5hH,OAAQpE,EAAIoE,EAAQpE,IAN/Cd,KAOMG,QAAQ2mH,EAAShmH,YAPvBd,KAQaG,QAAQ2mH,EAAShmH,IAR9Bd,KAaNsN,OAAO45D,IAGhBn9D,gBAAiB,SAAUwC,GACvB,IACImG,EADO1S,KACW0S,WAClB7U,KAECyO,OAAOyU,cAAcljB,IAJfmC,KAMF+iE,YAAY7c,YACb96C,OAAQ,aACRvN,KAAMA,EACNgmD,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,cAZrBpkD,KAgBNoiH,UAAU71G,EAAGrM,KAAMqM,EAAG/O,OAAQ+O,EAAG9O,WAG1ConH,YAAa,SAAUt4G,GAEnB,IAAIxM,EAAOC,KACSD,EAAK2gC,mBACXk5C,WAGd/sE,OAAOY,KAAKI,WAAWrM,eACvBrE,EAAEqM,KAAKzJ,EAAK6kH,kBAAkBz8G,KAAK,SAAUtK,GACzC,IAOIkK,EAEAg/G,EATA1kH,EAAOxE,EAAKwE,KAIZ2kH,GAHa3kH,EAAK6C,WAKHnF,EAAKyjH,mBAKX7oD,QAAQ,SAAkBj8D,EAAQkE,GAC3C,GAAIlE,EAAO0H,iBAAkB,CAGzB,OAFA2gH,EAAiBroH,EAAO0H,iBAAiBymF,SAASliF,WAG9C,IAAK,MACD5C,EAAS1F,EAAK4kH,IAAI,SAAUroH,GACxB,IAAIsoH,EAAoC,OAArBtoH,EAAIgE,GAAwBhE,EAAIgE,GAAelE,EAAO0H,iBAAiBwE,aAC1F,OAAOf,OAAOq9G,IACftkH,GACH,MAEJ,IAAK,QACDmF,EAAS1F,EAAKkgB,MAAM,SAAU3jB,GAE1B,IAAIsoH,EAAoC,OAArBtoH,EAAIgE,GAAwBhE,EAAIgE,GAAelE,EAAO0H,iBAAiBwE,aAE1F,OAAKiC,OAAOY,KAAKsS,QAAQmnG,GAIrBr6G,OAAOY,KAAKsS,QAAQmnG,IAAiBA,EAAahiH,OAAS,EACpDgiH,OADX,EAHWA,GAMZxoH,EAAQkE,GAEX,MAEJ,IAAK,MACDmF,EAAS1F,EAAK0I,IAAI,SAAUnM,GACxB,IAAIsoH,EAAoC,OAArBtoH,EAAIgE,GAAwBhE,EAAIgE,GAAelE,EAAO0H,iBAAiBwE,aAC1F,OAAOf,OAAOq9G,IACftkH,GAEH,MAEJ,IAAK,MACDmF,EAAS1F,EAAK2I,IAAI,SAAUpM,GACxB,IAAIsoH,EAAoC,OAArBtoH,EAAIgE,GAAwBhE,EAAIgE,GAAelE,EAAO0H,iBAAiBwE,aAC1F,OAAOf,OAAOq9G,IACftkH,GACH,MAEJ,IAAK,MAMDmF,GALAA,EAAS1F,EAAK8kH,IAAI,SAAUvoH,GACxB,IAAIsoH,EAAoC,OAArBtoH,EAAIgE,GAAwBhE,EAAIgE,GAAelE,EAAO0H,iBAAiBwE,aAC1F,OAAOf,OAAOq9G,IACftkH,IAEa8vB,QAAQ,GAI5Bq0F,IACAh/G,EAAShI,EAAKqnH,sBAAsBL,EAAgBroH,EAAO0H,iBAAiB6D,KAAMlC,GAClFi/G,EAAUp+G,MAAO5H,MAAOtC,EAAOsC,MAAO2H,MAAOZ,QAKzDhI,EAAK+kH,WAAWkC,KACjB52G,KAAK,SAAUurB,GACd9uB,OAAOwtE,eAAextE,OAAOC,aAAaC,YAAY,0BAA2B,WAClFo7D,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,iBAI/Bs5G,sBAAuB,SAAUz8G,EAAWmzD,EAAal6D,GACrD,OAAQ+G,GACJ,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,MACD,GAAmB,eAAfmzD,GAA+C,SAAfA,EAChC,OAAOjxD,OAAOY,KAAK8mB,mBAAmB3wB,GAKlD,OAAOA,GAAS,GAGpBkhH,WAAY,SAAUz5G,GAClB,IAAItL,EAAOC,KACPgzG,EAAoB/9E,MAAM52B,SAAS0B,EAAK+iE,cAAcvT,YAAY,0BAA4BrW,cAAc,IAC5Gr7C,EAAOV,EAAEsJ,OAAO4E,GAAUvH,YAAe/D,EAAK2S,WAAW5O,cACzDmvG,EAAY91G,EAAEA,EAAE+f,KAAK81F,EAAkBn1G,KAE3CV,EAAE,kCAAkCqC,SAEpCyzG,EAAU95D,sBACNpxB,MAAO,WACHhoB,EAAKi4D,qBAAqB,4BAC1Bh4D,KAAK2N,UACL3N,KAAKC,QAAQT,UAEjB45C,oBAAoB,IAGxB65D,EAAUt/D,SAAS,iCAAkC,QAAS,WAC1Ds/D,EAAUp1G,KAAK,wBAAwBkqB,UAG3ChoB,EAAKi4D,qBAAqB,yBAC1Bi7C,EAAU95D,qBAAqB,SAMnC3xC,SAAU,SAAU9I,EAAQqC,EAAK6C,EAAOqD,GAEpC,IAAIlH,EAAOC,KAGX,GAFAD,EAAK6wF,cAEDlyF,EAAOqC,IACP,OAAO6C,EAIX,IAAIhB,EAAclE,EAAOyC,MAAQ,EAC7BkuE,EAAetvE,EAAKxC,QAAQqF,GAE3B7C,EAAKihH,aAAajgH,KAAMhB,EAAKihH,aAAajgH,OAC1ChB,EAAKihH,aAAajgH,GAAK6B,KACxB7C,EAAKihH,aAAajgH,GAAK6B,OAG3B,IAAI8P,EAAa3S,EAAKihH,aAAajgH,GAAK6B,GAAa8P,YAAc28D,EAAa/Q,mBAC5EjJ,OAAiCntD,IAAvBwK,EAAW2iD,SAAwB3iD,EAAW2iD,QACxDtQ,OAAmC78C,IAAxBwK,EAAWqyC,UAAyBryC,EAAWqyC,SAE9DsqB,EAAa38D,WAAWg3D,YAAc,SAGlCziE,IAAU89C,GAAW,GAEzB,IAAIwqC,EAAexvF,EAAKyvF,gBAAgBzuF,EAAKrC,EAAOyC,MAAQ,GAO5D,GALIouF,IACAl6B,EAAUk6B,EAAal6B,QACvBtQ,IAAYryC,EAAmB,UAAI68E,EAAaxqC,UAGhDsQ,EAAS,CACT,GAAItQ,EAAU,CACV,IAAIthC,EAAQ,IAAItmB,EAAE4S,SAyBlB,OAvBA5S,EAAEqM,KAAK6lE,EAAa7wB,OAAOz9C,EAAK6C,IAAQuE,KAAK,SAAUrJ,GAEnD,GAAIA,GAAmC,SAA3B3B,EAAE2B,GAAM4F,IAAI,WAAuB,CAC3C,IAAIvG,EAAe4B,EAAKwkH,kBAGxBzlH,GADAA,EAAOA,EAAK6F,QAAQ,eAAgBxG,EAAaoI,SACrC5B,QAAQ,oBAAqBxG,EAAa6C,OAItDiG,IAAalH,EAAK6wF,WAAW7vF,KAC7BhB,EAAK6wF,WAAW7vF,OAGpB,IAAK,IAAIuB,EAAI,EAAG4C,EAASnF,EAAKxC,QAAQ2H,OAAQ5C,EAAI4C,EAAQ5C,IACtDvC,EAAK6tF,cAAc7sF,GAAOhB,EAAK6tF,cAAc7sF,OAC7ChB,EAAKyvF,gBAAgBzuF,EAAKuB,GAAG+yD,SAAU,EAG3Ct1D,EAAKsnH,iBAAiBh4C,EAActuE,GAAK,GAEzC0iB,EAAMtT,QAAQrR,KAEX2kB,EAAMlb,UAGb,OAAOpL,EAAEqM,KAAK6lE,EAAajE,eAAerqE,EAAK6C,IAAQigB,KAAK,SAAU/kB,GAElE,GAAIA,GAAmC,SAA3B3B,EAAE2B,GAAM4F,IAAI,WAAuB,CAC3C,IAAIvG,EAAe4B,EAAKwkH,kBACpBt7E,EAAO9rC,EAAE2B,GAKb,GAHA3B,EAAE,mBAAoB8rC,GAAM3nC,KAAK,QAASnD,EAAaoI,QACvDpJ,EAAE,QAAS8rC,GAAM3nC,KAAK,QAASnD,EAAa6C,YAEA,IAAhCjB,EAAK2S,WAAqB,kBAEgB,IAAtC3S,EAAK2S,WAAW6rD,WAAgB,OACxCphE,EAAE,QAAS8rC,GAAMvkC,IAAI,QAAS3E,EAAK2S,WAAW6rD,WAAWG,YAGX,IAArC3+D,EAAK2S,WAAW6rD,WAAe,MAAuBx+D,EAAK2S,WAAW6rD,WAAWkF,KAAO,GAAI,CACrG,IAAIyL,EAAe,IAAgD,GAA1CrlE,OAAO9J,EAAK2S,WAAW6rD,WAAWkF,MAAc,IACzEtmE,EAAE,QAAS8rC,GAAMvkC,IAAI,YAAawqE,GAI1CpwE,EAAOmqC,EAAK,GAAG2mE,UAGnB,OAAO9wG,IAKf,MAAO,IAOf4E,YAAa,SAAUhF,EAAQqC,EAAKjC,EAAMmI,GACtC,IAGIrE,EAAclE,EAAOyC,MAAQ,EAC7BkuE,EAJOrvE,KAIazC,QAAQqF,GAC5B8P,GAAsDxK,MAL/ClI,KAKaghH,aAAajgH,GAAK6B,GAL/B5C,KAKiEghH,aAAajgH,GAAK6B,GAAa8P,gBAAaxK,IAAcmnE,EAAa/Q,mBAC/IjJ,OAAiCntD,IAAvBwK,EAAW2iD,SAAwB3iD,EAAW2iD,QACxDtQ,OAAmC78C,IAAxBwK,EAAWqyC,UAAyBryC,EAAWqyC,SAc9D,GAZA5nD,EAAE,kBAAmB2B,GAAM61E,YAAY,iBAAkB,uBAG9C,WAAP5zE,IACAgkD,GAAW,GAIX99C,IACA89C,GAAW,GAGXsQ,EACA,GAAItQ,EAAU,CAEV,IAAIggE,EAAmB11C,EAAa38D,WAAWqyC,SAI/C,GAHAsqB,EAAa38D,WAAWqyC,SAAWA,EAG/BsqB,EAAa38D,WAAWovD,gBACpBrvD,EAAU48D,EAAaE,aAAaxuE,MAEpC0R,EAAQC,WAAWk+D,2BA/BxB5wE,KA+B0D0S,WAAWmO,MAAQ,MAKhFwuD,EAAalrE,WAAWpD,EAAKjC,GAG7BuwE,EAAa38D,WAAWqyC,SAAWggE,MAChC,CAGC,IAAItyG,EADR,GAAI48D,EAAa38D,WAAWovD,gBACpBrvD,EAAU48D,EAAaE,aAAaxuE,MAEpC0R,EAAQC,WAAWk+D,2BA7CxB5wE,KA6C0D0S,WAAWmO,MAAQ,MAIhFwuD,EAAalrE,WAAWpD,EAAKjC,KAQzCuoH,iBAAkB,SAAUh4C,EAActuE,EAAKumH,GAC3C,GAAIA,EAAW,CACX,IAAIvnH,EAAOC,KACXqvE,EAAaE,aAAaxuE,GAAKiE,KAAK,eAAgB,SAAUw5C,EAAQvvC,GAElE,IAAIrL,EAAQyrE,EAAa18D,SAAS1D,EAAKuvC,OAAOoF,cAC1C2jE,EAAiBl4C,EAAa6xB,kBAAkBjyF,EAAKuvC,OAAOoF,cAEhE,GAAoC,cAAhCyrB,EAAa38D,WAAWzI,KACxB,GAAK4C,OAAOY,KAAKqT,QAAQld,GAGJ,KAAVA,IACPA,EAAQ,QAJqB,CAC7B,IAAIkxB,EAAOjoB,OAAOY,KAAKgmB,cAAc8E,qBAAqB30B,EAAOqL,EAAKuvC,OAAO9rC,WAAW8lB,WAAY,GACpG50B,EAAQiJ,OAAOY,KAAKgmB,cAAckF,gBAAgB7D,GAAM,GAKhE/0B,EAAK+uF,kBAAkB3xF,EAAEsJ,OAAOwI,GAC5B3R,GAAI2R,EAAKuvC,OAAOoF,aAChB/iC,MAAOwuD,EAAa38D,WAAWmO,OAASwuD,EAAa38D,WAAWpV,GAChEsG,MAAOA,EACP2jH,eAAgBA,EAChB3kH,YAAaysE,EAAazsE,eAI9B7C,EAAKzB,KAAKooH,uBAAuB,kBAAmBz3G,EAAKuvC,OAAOoF,aAAcyrB,EAAazsE,YAAagB,GAGpGyrE,EAAa38D,WAAWm6E,UAAYxd,EAAa38D,WAAWm6E,SAASliF,WACrE5K,EAAKzB,KAAKooH,uBAAuB,iBAAkBr3C,EAAazsE,oBAIxEysE,EAAaE,aAAaxuE,GAAKomB,OAAO,iBAO9Co6F,OAAQ,WACJ,IAAIxhH,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElBmP,EAAY9hB,EAAK2gC,mBAAmB7e,UACpCojG,EAAcllH,EAAKgjE,YAEvBl2D,OAAOY,KAAKI,WAAWrM,eAEvBrE,EAAEqM,KAAKzJ,EAAK6gF,oBACPz4E,KAAK,SAAUq/G,GACZ,IAAI3iE,EAAcnyC,EAAWmO,MAAQ,OAAS2mG,EAAQ,IAClDtC,GACArhE,SAAUnxC,EAAWpV,GACrB0mD,YAAea,EACfnhC,IAAKhR,EAAWyyG,QAChBrhE,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBvjC,MAAOgkC,EACPE,UAAU,EACVhB,cAAe,UACf5J,YAAaznC,EAAW86E,SACxB43B,UAAWoC,EACXnC,yBAAyB,EACzBC,WAAW,EACXmC,sBAAsB,GAGtBC,GACA5kD,cAAiB/iE,EAAK+iE,cACtBC,YAAekiD,EACf7nF,OAAUr9B,EACVlC,MACI6U,WAAYwyG,IAIhBM,EAAW,IAAI34G,OAAO23D,UAAUihD,SAASiC,GAE7Cp7G,OAAO7F,OAAO++G,GACV/xC,YAAat2E,EAAE0kB,GAAWve,KAAK,yBAC/BrD,QAASF,EAAKE,QACd2zE,WAAY7zE,EAAK2lH,iBACjBC,aAAc5lH,EAAK6lH,gBACnBC,cAAe,WACX,OAAO,GAEXC,SAAU/lH,EAAKgjE,YAAYvf,YAC3B72B,QAASu4F,IAGbnlH,EAAKgmH,wBAAwBP,GAC7B34G,OAAOY,KAAKI,WAAWC,gBACxBsC,KAAK,SAAUurB,GAClB57B,EAAK44G,uBAAuBh9E,KAC7BwsC,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,iBAK/Bi2G,QAAS,SAAUzmH,GACf,IAAIyC,EAAOC,KAGP2nH,EAAgB5nH,EAAK2gC,mBACzBinF,EAAc/tC,WAEd,IAAIlnE,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK2gC,mBAAmB7e,UACpCojG,EAAcllH,EAAKgjE,YAEnBle,EAAcnyC,EAAWmO,MAAQ,OAASvjB,EAAK,IAEnDuP,OAAOY,KAAKI,WAAWrM,eACvBrE,EAAEqM,KAAKm+G,EAAc/tC,YAAYzxE,KAAK,WAClC,IAAI+8G,GACArhE,SAAUnxC,EAAWpV,GACrBA,GAAIoV,EAAWpV,GACfwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBJ,YAAaa,EACbhkC,MAAOgkC,EACPE,UAAU,EACVrhC,IAAKhR,EAAWszG,SAChBjiE,cAAe,WACf5J,YAAaznC,EAAW0nC,UACxBgrE,UAAW9nH,EACXmqH,sBAAsB,GAGtBC,GACA5kD,cAAiB/iE,EAAK+iE,cACtBC,YAAekiD,EACf7nF,OAAUr9B,EACVlC,MACI6U,WAAYwyG,IAIhBM,EAAW,IAAI34G,OAAO23D,UAAUihD,SAASiC,GAE7Cp7G,OAAO7F,OAAO++G,GACV/xC,YAAat2E,EAAE0kB,GAAWve,KAAK,yBAC/BrD,QAASF,EAAKE,QAEd2zE,WAAY7zE,EAAK2lH,iBACjBC,aAAc5lH,EAAK6lH,gBACnBC,cAAeL,EAAS1kC,kBACxBglC,SAAU/lH,EAAKgjE,YAAYvf,YAC3B72B,QAASu4F,IAGbnlH,EAAKgmH,wBAAwBP,KAC9Bp1G,KAAK,SAAUurB,GACd57B,EAAK44G,uBAAuBh9E,KAC7BwsC,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,iBAI/Bi4G,wBAAyB,SAAUP,GAC/BroH,EAAEqM,KAAKg8G,EAAStyC,iBAAiB/qE,KAC7B,WACIq9G,EAASzjH,gBAQrBiiH,UAAW,SAAU1mH,GACjB,IAAIyC,EAAOC,KACX6M,OAAO4sE,oBAAoBz5E,KAAK+M,YAAY,oCACvC5E,KAAK,WAEFhL,EAAEqM,KAAKzJ,EAAKihF,oBAAoB1jF,IAC3B6K,KAAK,SAAUtK,GAEZkC,EAAKqiH,YACY,WAAbvkH,EAAKoM,MAILlK,EAAKsoE,qBAAsB3R,YAAY,EAAMoG,SAAS,EAAO/7D,IAAKzD,MAEvE8S,KAAK,SAAUurB,GAClB57B,EAAK44G,uBAAuBh9E,QAQ5CkrF,WAAY,SAAUvpH,GACP0C,KACN4nH,+BAA+BtqH,IAMxCsqH,+BAAgC,SAAStqH,GACrC,IACIoV,EADO1S,KACW0S,WAClBmyC,EAAcnyC,EAAWmO,MAAQ,OAASvjB,EAAK,IAFxC0C,KAGY+iE,YAHZ/iE,KAIc8iE,cACV,IAAIj2D,OAAO23D,UAAU32D,WAAWo/F,MAAMznD,KAL1CxlD,KAKoD+iE,YALpD/iE,KAKsE8iE,eAC7E7kE,MAAOyU,EAAW4nC,aAAeztC,OAAOC,aAAaC,YAAY,4BACjEu1D,WAPOtiE,KAOU4gC,YAAY0hC,WAC7BzgD,UARO7hB,KAQS0gC,mBAAmB7e,UACnCqrF,gBAAgB,IAGX1uD,QACLqF,SAAUnxC,EAAWpV,GACrB0mD,YAAaa,EACbf,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBL,cAAe,aACfgB,UAAU,KAIlB6gE,gBAAiB,WACb,IACI11G,EAAW/S,EAAE4S,WAMjB,OAJA5S,EAAEqM,KAHSxJ,KAGCqhF,yBAAyBl5E,KAAK,WACtC+H,EAASC,YAGND,EAAS3H,WAOpBm9G,iBAAkB,SAAU7nH,GACxB,IAAIkC,EAAOC,KACPkQ,EAAW/S,EAAE4S,WAEjB,IAAiC,IAA7BhQ,EAAKylD,KAAKm0B,eAAyB,CACnC,IAAIjnE,EAAa3S,EAAK2S,WAEjB7U,GACDkC,EAAKylD,KAAKyhB,oBAAoBppE,GAGlCA,EAAKumD,YAAcrkD,EAAKylD,KAAK8d,eAE7BnmE,EAAEqM,KACEzJ,EAAKq9B,OAAO8jD,kBAAkBxuE,EAAW0yG,UAAWvnH,IAAOsK,KAAK,SAAU+9G,GACzD,sBAAbA,EAAKj8G,MACLlK,EAAKylD,KAAK82B,qBAAqB4pC,EAAKnqC,UACpCrpE,EAAWovD,gBAAiB,EAC5B5xD,EAASoiD,OAAO4zD,EAAKnqC,YAErBh8E,EAAKq9B,OAAOglF,YACP1vG,EAAWovD,iBACZpvD,EAAWovD,gBAAiB,GAEhC/hE,EAAK+hE,mBAAmB,GACxB5xD,EAASC,kBAIjBD,EAASoiD,SAGb,OAAOpiD,EAAS3H,WAGpB+9G,sBAAuB,SAAU5nH,EAAQiQ,GACrC,IAAI5O,EAAO4O,EACPk5G,EAAiBnpH,EAAO4wE,UAAUsE,WAEtCtnE,OAAO7F,OAAO/H,EAAO4wE,WACjBsE,WAAY,WACR,IAAIk0C,EAAa9nH,KACjB7C,EAAEqM,KAAKq+G,EAAez5G,MAAM05G,EAAYz5G,YAAYlG,KAAK,WACrD,IAAItK,KACJkC,EAAKknE,oBAAoBppE,GAEzBV,EAAEqM,KAAKzJ,EAAKmhF,kBAAkB4mC,EAAWlkE,aAAc/lD,IAAOsK,KAAK,WAC/DpI,EAAKqiH,oBAQzBn7C,oBAAqB,SAAUC,GAG3B/pE,EAAE0D,KAFSb,KAECzC,QAAS,SAAUuD,EAAGiwD,IAC9BA,EAAQA,EAAMue,WACJ/L,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ0iE,uBAEnD5R,EAAMkW,oBAAoBC,GACnBnW,EAAMwS,kBAAoB12D,OAAO23D,UAAUvkE,QAAQ2iE,qBAEtD7R,EAAMoW,aACNpW,EAAMqW,YAAYF,MASlC91D,MAAO,WACH,IACI4zG,EADOhlH,KACcsN,SACrBy6G,EAFO/nH,KAEiBgoH,kBAFjBhoH,KAE0CgoH,kBAAkBz/G,UAAY,KAEnF,OAAOpL,EAAEqM,KAAKw7G,EAAe+C,IAKjCr4B,SAAU,SAAU3uF,EAAK8f,KAOzBld,gBAAiB,SAAU5C,EAAK8f,EAAOyzC,GACnC,IAEI7hD,EAFOzS,KAEQw3D,eAAez2D,EAAK8f,GACvC,GAAIpO,EAAS,CACO,MAAZ6hD,GACA7hD,EAAQsuD,gBAAgBzM,GAG5B,IAAIi/C,EAAS9gG,EAAQ/T,OAAOiU,SAAS5R,GACjCwmH,EAAiB90G,EAAQ/T,OAAOwiG,kBAAkBngG,GAEtC,MAAZuzD,GACA7hD,EAAQsuD,gBAAgBzM,GAZrBt0D,KAeF8uF,mBAAoBxxF,GAAIyD,EAAK8f,MAAOA,EAAOjd,MAAO2vG,EAAQgU,eAAgBA,EAAgB3kH,YAAa6P,EAAQ/T,OAAQuG,SAD9G,MAKtBw6D,0BAA2B,SAAU1+D,EAAK8f,EAAOyzC,GAC7C,IAEI7hD,EAFOzS,KAEQw3D,eAAez2D,EAAK8f,GACnCpO,IACAA,EAAQgtD,0BAA0BnL,GAG9B7hD,EAAQxS,SACRwS,EAAQxS,QAAQqD,KAAK,yDAAyDoB,KAC1E+sE,mBAAoBnd,EACpBod,mBAAoBpd,MAQpCuL,gBAAiB,SAAU9+D,EAAK8f,EAAOyzC,GACnC,IACI7hD,EADOzS,KACQw3D,eAAez2D,EAAK8f,GAEnCpO,GACAA,EAAQotD,gBAAgBvL,IAMhC0L,qBAAsB,SAAUj/D,EAAK8f,EAAOyzC,GACxC,IAAIv0D,EAAOC,KACPyS,EAAU1S,EAAKy3D,eAAez2D,EAAK8f,GAEvC,GAAIpO,EAAS,CACTA,EAAQutD,qBAAqB1L,GAC7B,IAAK,IAAIhyD,EAAI,EAAG4C,EAASnF,EAAKxC,QAAQ2H,OAAQ5C,EAAI4C,GAC1CnF,EAAKxC,QAAQ+E,GAAGoQ,WAAWmO,OAASA,EADcve,KAM1DvC,EAAK6tF,cAAc7sF,GAAOhB,EAAK6tF,cAAc7sF,OAC7ChB,EAAKyvF,gBAAgBzuF,EAAKuB,GAAG+yD,QAAUf,EAGnC7hD,EAAQC,WAAWqyC,UAAYuP,EAC/Bv0D,EAAKsnH,iBAAiBtnH,EAAK80D,UAAUh0C,GAAQ9f,GAAK,GAElDhB,EAAKsnH,iBAAiBtnH,EAAK80D,UAAUh0C,GAAQ9f,GAAK,KAQ9Ds/D,sBAAuB,SAAUt/D,EAAK8f,EAAOyzC,GACzC,IAAIv0D,EAAOC,KACPyS,EAAU1S,EAAKy3D,eAAez2D,EAAK8f,GAEvC,GAAIpO,EAAS,CACTA,EAAQ6tD,kBAAkBhM,GAC1B,IAAK,IAAIhyD,EAAI,EAAG4C,EAASnF,EAAKxC,QAAQ2H,OAAQ5C,EAAI4C,GAC1CnF,EAAKxC,QAAQ+E,GAAGoQ,WAAWmO,OAASA,EADcve,KAM1DvC,EAAK6tF,cAAc7sF,GAAOhB,EAAK6tF,cAAc7sF,OAC7ChB,EAAKyvF,gBAAgBzuF,EAAKuB,GAAGyiD,SAAWuP,EAGpC7hD,EAAQC,WAAW2iD,SAAWf,EAC9Bv0D,EAAKsnH,iBAAiBtnH,EAAK80D,UAAUh0C,GAAQ9f,GAAK,GAElDhB,EAAKsnH,iBAAiBtnH,EAAK80D,UAAUh0C,GAAQ9f,GAAK,KAQ9DkgE,mBAAoB,SAAUlgE,EAAK8f,EAAOyzC,GACtC,IACI7hD,EADOzS,KACQw3D,eAAez2D,EAAK8f,GAEvC,GAAIpO,EAAS,CACTA,EAAQyuD,eAAe5M,GACvB,IAAK,IAAIhyD,EAAI,EAAG4C,EALTlF,KAKuBzC,QAAQ2H,OAAQ5C,EAAI4C,GAL3ClF,KAMMzC,QAAQ+E,GAAGoQ,WAAWmO,OAASA,EADcve,KALnDtC,KAWF4tF,cAAc7sF,GAXZf,KAWwB4tF,cAAc7sF,OAXtCf,KAYFwvF,gBAAgBzuF,EAAKuB,GAAG0mF,SAAW10B,IAOhD8M,mBAAoB,SAAUrgE,EAAK8f,EAAOyzC,GACtC,IACI7hD,EADOzS,KACQw3D,eAAez2D,EAAK8f,GAEvC,GAAIpO,EAAS,CACTA,EAAQ4uD,eAAe/M,GACvB,IAAK,IAAIhyD,EAAI,EAAG4C,EALTlF,KAKuBzC,QAAQ2H,OAAQ5C,EAAI4C,GAL3ClF,KAMMzC,QAAQ+E,GAAGoQ,WAAWmO,OAASA,EADcve,KALnDtC,KAWF4tF,cAAc7sF,GAXZf,KAWwB4tF,cAAc7sF,OAXtCf,KAYFwvF,gBAAgBzuF,EAAKuB,GAAG4mF,SAAW50B,IAIhD0N,cAAe,SAAUjhE,EAAK8f,GAC1B,IACIpO,EADOzS,KACQw3D,eAAez2D,EAAK8f,GAEvC,GAAIpO,EAAS,CACTA,EAAQwvD,YACR,IAAK,IAAI3/D,EAAI,EAAGA,EALTtC,KAKkBzC,QAAQ2H,QAL1BlF,KAMMzC,QAAQ+E,GAAGoQ,WAAWmO,OAASA,EADHve,KAOzC,IADA,IAAID,EAXGrC,KAWS0S,WAAW7U,KAAKwE,KAAMvB,EAAI,EAAGmnH,EAAY5lH,EAAK6C,OACvDpE,EAAImnH,EAAWnnH,IAClB,GAAI+I,OAAO9I,KAASsB,EAAKvB,GAAG,GAAI,CAC5BuB,EAAKvB,GAAGwB,EAAI,KAAO,GAAI,KACvB,MAfDtC,KAkBF4tF,cAAc7sF,GAlBZf,KAkBwB4tF,cAAc7sF,OAlBtCf,KAmBFwvF,gBAAgBzuF,EAAKuB,GAAGsB,MAAQ,OAQ7CwgH,yBAA0B,WACtB,IACIn1G,EAAO/D,MAAMiD,UAAUe,MAAMhD,KAAKmC,UAAW,GAEjD,OAHWrO,KAGC1B,KAAKooH,uBAAuBt4G,MAH7BpO,KAGwC1B,KAAM2Q,IAG7D03G,YAAa,SAAUjtD,GACnB,IACIwuD,KACA1iE,EAFOxlD,KAEK0gC,mBAOhB,QAL2C,IAA/B8kB,EAAyB,sBACjCA,EAAK6e,qBAAqBtL,0BALnB/4D,KAONgK,QAAQk+G,GAETA,EAAchjH,OAAS,EAAG,CAC1B,QAA2C,IAA/BsgD,EAAyB,qBACjC,IAAK,IAAI1kD,EAAI,EAAGoE,EAASgjH,EAAchjH,OAAQpE,EAAIoE,EAAQpE,IAEvD0kD,EAAK6e,qBAAqB3L,sBAAsBwvD,EAAcpnH,GAAG4V,QAASwxG,EAAcpnH,GAAG+f,OAInG,OAAO,EAEP,OAAO,GAIf+sD,SAAU,WAEN,OAAOzwE,EAAE,mBADE6C,KACuBC,SADvBD,KACuCijE,oBAGtDvD,sBAAuB,SAAUhB,GAClB1+D,KACNsN,OAAOoxD,GADD1+D,KAGQ0rE,aACXpoE,KAAK,yBAAyBoB,IAAI,mBAAoBg6D,EAAO,eAQzEi6C,uBAAwB,SAAUh9E,GAC9B,IACIu/E,EAAgBv/E,EAAMO,aAAeP,EAAMO,aAAervB,OAAOC,aAAaC,YAAY,4BADnF/M,KAEN0gC,mBAAmBo6C,YAAYogC,IAGxC15G,aAAc,WACVqL,OAAOk1E,QAAQzoD,SAEnBv3B,WAAY,WACR8K,OAAOk1E,QAAQ/jD,UC5wCvBnxB,OAAO23D,UAAU1zB,OAAOrqC,OAAO,2BAC3B0hH,oBAAqB,EACrBC,sBAAuB,EACvBzU,kBAAmB,EACnB0U,aAAc,MAGdj9C,eAAgB,WACZ,IACI/sE,EADO2B,KACS8iE,cAAcvT,YAAY,kBAC1C3rD,EAFO5D,KAEM0S,WAAW9O,OAFjB5D,KAE+BssE,WAF/BtsE,KAEiD0S,WAAW9O,MAAM5C,MAAQ,GAErF,OAAO7D,EAAEy8C,UAAUv7C,GAAWuF,MAAOA,KAGzC4wE,aAAc,WACV,IACI9hE,EADO1S,KACW0S,WAClBmP,EAFO7hB,KAEU6zE,qBACjBphE,EAHOzS,KAGQ0rE,aAHR1rE,KAMNuuB,MAAQpxB,EAAE,0BAA2BsV,GAN/BzS,KAONsoH,UAPMtoH,KAOWuuB,MAAMjrB,KAAK,4BAE5BoP,EAAWqyC,WACZljC,EAAUxgB,SAAS,sBAVZrB,KAWFsoH,UAAYnrH,EAAE,cAAesV,IAGlCC,EAAW4+E,eACXzvE,EAAUxgB,SAAS,0BACfqR,EAAWqyC,UAhBR/kD,KAiBEuoH,iBAjBFvoH,KAqBNomE,qBAGTA,kBAAmB,WACf,IAAIrmE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBAEjB9zE,EAAK2S,WAAW2+E,gBAAkB3+E,EAAWqyC,WAC7CljC,EAAUxgB,SAAS,0BACnBtB,EAAKwuB,MAAMvpB,KAAK,QAAS,WACrBjF,EAAK6oG,sBAIVl2F,EAAWqyC,UACVhlD,EAAKwuB,MAAM9hB,GAAG,QAAS,oCAAqC,SAASwB,GACjEA,EAAEimC,kBACFn0C,EAAKgyC,UAAUz0C,GAAI,KACnByC,EAAKuoH,UAAUh+E,KAAK,QAAS,IAC7BntC,EAAE6C,MAAMqB,SAAS,UACjBtB,EAAKuoH,UAAUziG,YAAY,eAKvCymD,SAAU,WAEN,OAA0B,MADftsE,KACC2S,YAA6C,KAD9C3S,KAC4B2S,WAAWrV,SAA2C,IADlF0C,KACgE2S,WAAWrV,IAG1F6tE,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAClBrU,EAFO2B,KAES8iE,cAAcvT,YAAY,UAE1ClkD,GACAimF,aAAc5+E,EAAW4+E,aACzBvsC,SAAUryC,EAAWqyC,SACrBysC,WAAY9+E,EAAW8+E,WACvBl0F,GAAIoV,EAAWpV,GACfujB,MAAOnO,EAAWmO,MAClByrD,SAVOtsE,KAUQssE,WACfilB,YAAa7+E,EAAW6+E,YACxBF,eAAgB3+E,EAAW2+E,eAC3Bm3B,sBAAqBrrH,EAAEwT,UAAWxT,EAAEwT,QAAQK,SAAmC,OAAxB0B,EAAW2rC,UAA4C,IAAvB3rC,EAAW2rC,WAGtG,OAAOlhD,EAAEy8C,UAAUv7C,EAAUgN,IAMjC+7D,YAAa,SAAUF,GACnB,IACIx0D,EADO1S,KACW0S,WAGlBmO,EAAQnO,EAAWmO,MACnBjd,EALO5D,KAKM2S,WACbC,EAAeF,EAAWG,cAI9B,KAAKD,GAAgBA,EAAatV,KAAOsG,EAAMtG,IAAMH,EAAE2V,oBAC9CjG,OAAOY,KAAKqT,QAAQD,IAArB,MAA+Bjd,EAAkD,CAEjF,GAAsB,iBAAX,QAAoCsE,IAAbtE,EAAMtG,GACpC,OAEJ4pE,EAAax0D,EAAWmO,OAASjd,IAmB7Cm9D,gBAAiB,SAAUn9D,GACvB,IACI5C,EAAQ,GAGR4C,OAFJA,EAFW5D,KAEE6nF,SAASjkF,UAEoD,IAAbA,EAAMtG,KAE3D0D,EADA4C,EAAM6kH,iBAAmB7kH,EAAM5C,MACvB4C,EAAM5C,MAAQ,KAAO4C,EAAM6kH,gBAC5B7kH,EAAM5C,MACL4C,EAAM5C,MAEN,GAVLhB,KAaE0S,WAAWqyC,UAbb/kD,KAcE+xC,SAASnuC,GAAO,GAdlB5D,KAeEsoH,UAAUl5G,IAAIpO,GAfhBhB,KAgBEsoH,UAAUhnH,KAAK,KAAMsC,EAAMtG,IAhB7B0C,KAiBEsoH,UAAU/kH,KAAKvC,QAEA,IAAV4C,EAnBP5D,KAoBMsoH,UAAUjnH,SAAS,YApBzBrB,KAsBMsoH,UAAUziG,YAAY,aAtB5B7lB,KAyBEsoH,UAAUn2G,KAAKnR,KAQhCihE,UAAW,WACP,IACIr+D,GAAUtG,GAAI,GAAIsG,MAAO,IADlB5D,KAEN+xC,SAASnuC,GAFH5D,KAGN+gE,gBAAgBn9D,IAGzB2kH,cAAe,WACX,IAAIxoH,EAAOC,KACPyS,EAAU1S,EAAK2rE,aAEnB3rE,EAAKuoH,UAAU77G,GAAG,cAAe,WAC7B1M,EAAK2oH,8BAGTj2G,EAAQhG,GAAG,kBAAmB,KAAM,WAChC,IAAIk8G,EAAaxrH,EAAEU,KAAKmC,MAAM4oH,iBAC1B5nH,EAAQkK,MAAM6U,QAAQ4oG,EAAW/kH,OAAS+kH,EAAW/kH,MAAM8U,KAAK,KAAOiwG,EAAW/kH,MACtF7D,EAAKghE,iBAAkBzjE,GAAIqrH,EAAWrrH,GAAI0D,MAAOA,IACjD7D,EAAE6C,MAAMo9B,SAASj4B,OACjBpF,EAAKwuB,MAAMjrB,KAAK,qCAAqCuiB,YAAY,UACjE9lB,EAAKuoH,UAAUjnH,SAAS,cAG5BoR,EAAQhG,GAAG,WAAY,QAAS,WAC5BgG,EAAQnP,KAAK,MAAM6B,OACnBpF,EAAKuoH,UAAUlrF,SAAS95B,KAAK,+BAA+BjC,SAAS,aAK7EqnH,0BAA2B,WACvB,IAAI3oH,EAAOC,KACPonF,EAAernF,EAAKuoH,UAAUl5G,MACd,KAAjBg4E,GACCrnF,EAAKwuB,MAAMjrB,KAAK,qCAAqCjC,SAAS,UAGlElE,EAAEqM,KACEzJ,EAAKmgH,gBAAiBh3E,KAAMk+C,GAAgB,eAC9Cj/E,KAAK,SAAU+9G,GACb,IAAI2C,EAAU9oH,EAAKuoH,UAAUlrF,SAAS95B,KAAK,+BACxC4iH,EAAKhhH,OAAS,EACb2jH,EAAQhjG,YAAY,UAEfgjG,EAAQ52E,SAAS,WAClB42E,EAAQxnH,SAAS,UAIzB,IAAIynH,EAAY/oH,EAAKuoH,UAAUlrF,SAAS95B,KAAK,MAC7CwlH,EAAUxlH,KAAK,MAAM9D,SAErBspH,EAAUpkH,KACNuuC,QAAS,eACT1rB,KAAMxnB,EAAKuoH,UAAUnjF,WAAW5d,KAChC1E,IAAK9iB,EAAKuoH,UAAUnjF,WAAWtiB,IAAM,GACrC7F,MAAOjd,EAAKuoH,UAAU5jH,IAAI,WAG9B,IAAK,IAAI5D,EAAI,EAAGoE,EAASghH,EAAKhhH,OAASpE,EAAIoE,EAAQpE,IAAK,CACpD,IAAIioH,EAAahpH,EAAKipH,iBAAiB9C,EAAKplH,IAC5C3D,EAAE4rH,GAAY1nH,SAAS,2BACvB0nH,EAAW7kH,SAAS4kH,OAKhClgB,iBAAkB,WACd,IAAI7oG,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElBu2G,EAAmB9rH,EAAEsJ,UAAW1G,EAAK6gC,aACrC0hC,WAAYviE,EAAK2gC,mBAAmB6hC,kBAGvB,IAAI11D,OAAO23D,UAAU32D,WAAWizG,QAAQzY,WAAWtoG,EAAKgjE,YAAahjE,EAAK+iE,cAAepwD,EAAW0+E,aAC7G9lC,gBAAiB54C,EAAW44C,gBAC5BC,WAAY74C,EAAW64C,WACvBy/C,SAAUt4F,EAAWs4F,WAAY,EACjClnG,YAAa4O,EAAW5O,aAAe,OAE3CmlH,GAGO/1C,eACPrvB,SAAUnxC,EAAWpV,GACrBujB,MAAOnO,EAAWmO,MAClBijC,aAAcpxC,EAAWoxC,aACzB3J,YAAaznC,EAAWynC,YACxBiK,YAAa1xC,EAAW0xC,cACzBj8C,KAAK,SAAU+gH,GACdnpH,EAAKgyC,UAAWz0C,GAAI4rH,IAGpBx2G,EAAWovD,gBAAiB,EAE5B/hE,EAAKmmD,gBAIb8iE,iBAAkB,SAAU//E,GACxB,IACI8/E,EAAa5rH,EAAEm2E,WADRtzE,KACwB8iE,cAAcvT,YAAY,wBACzDjyD,GAAI2rC,EAAK3rC,GACT0D,MAAOioC,EAAKjoC,MACZ4C,MAAOqlC,EAAKrlC,QAKhB,OAFAmlH,EAAWlrH,KAAK,mBAAoBorC,GAE7B8/E,GAGX7I,eAAgB,SAAUS,EAAKrhH,GAC3B,IAAIS,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+Q,EAAQ,IAAItmB,EAAE4S,SAGdowG,KAGJ,SAASgJ,EAAiBC,GASlB12G,EAAW2+E,gBACX+3B,EAAcxgH,MAAOtL,GAAIyC,EAAKsiD,MAAM8lE,mBAAoBnnH,MAAO,GAAI4C,MAAO,KAG1E8O,EAAWgzC,UACX0jE,EAAcxgH,MAAOtL,GAAIyC,EAAKsiD,MAAM+lE,qBAAsBpnH,MAAO,GAAI4C,MAAO,KAIhF6f,EAAMtT,QAAQi5G,GAmClB,OA/BKzI,EAAIz3E,KAAKhkC,QAAUlF,KAAKqiD,MAAMsxD,mBAE/BjhG,EAAWw2B,KAAOy3E,EAAIz3E,KACtBlpC,KAAKoC,UACA+F,KAAK,SAAUtK,GAKZ,IAFA,IAAIiD,GAAK,EAEEjD,IAAOiD,IAAM4R,EAAW64C,WAAazqD,GAAKA,EAAI,IACrDq/G,EAAYv3G,MACRtL,GAAIO,EAAKiD,GAAGxD,GACZ0D,MAAOnD,EAAKiD,GAAG8C,MAAMkN,WAAWnM,QAAQ,IAAI8J,OAAO,0BAA4BtR,EAAEoP,GAAG88G,aAAanhF,YAAYy4E,EAAIz3E,MAAQ,0BAA2B,MAAO,uBAC3JtlC,MAAO/F,EAAKiD,GAAG8C,QAIvBulH,EAAiBhJ,KAElB/vG,KAAK,WAERqT,EAAM6uC,YAIV62D,EAAiBhJ,GAMd18F,EAAMlb,WAGjB6qE,oBAAqB,SAAUxvE,GAChB5D,KAENuzE,aAAajwE,KAAK,4BAA4B8L,IAFxCpP,KAEiDiyF,gBAKhE/rC,WAAY,WACR,IACIxzC,EADO1S,KACW0S,WAGlB7U,KAEJA,EAAK6U,EAAWmO,OANL7gB,KAMmB2S,WAG1BD,EAAWovD,gBAA+C55D,MAA7BrK,EAAK6U,EAAWmO,OAAOvjB,IAT7C0C,KAUF8hE,eAAejkE,GAAM,IAGlC+1E,WAAY,WACG5zE,KAENsoH,UAAU/kH,KAFJvD,KAEc4D,MAAMA,OAFpB5D,KAEkC4D,MAAM5C,OAFxChB,KAGNsoH,UAAUl5G,IAHJpP,KAGa4D,MAAMA,OAHnB5D,KAGiC4D,MAAM5C,OAHvChB,KAINsoH,UAAUhnH,KAAK,KAJTtB,KAIoB4D,MAAMtG,OC/W7CuP,OAAO23D,UAAU8kD,OAAO7iH,OAAO,8BAE3B+tE,aAAc,WACCx0E,KACW0S,WAEXqyC,UAAW,KCP9Bl4C,OAAO23D,UAAUn4D,OAAO5F,OAAO,8BAK3B+tE,aAAc,WACV,IAAIz0E,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACjBphE,EAAU1S,EAAK2rE,aAEnBvuE,EAAEqM,KAAKzJ,EAAKorE,iBAAiBhjE,KAAK,WAC9BpI,EAAKwuB,MAAQpxB,EAAE,UAAWsV,GAASgX,MAAM,WACrC1pB,EAAKi2E,oBAEV7N,OAAO,WACFz1D,EAAWqyC,SACXljC,EAAUxgB,SAAS,2BAEnBwgB,EAAUxgB,SAAS,sBACnBtB,EAAKwuB,MAAM+b,KAAK,YAAY,OAQxC0rC,cAAe,WACX,IAAIj2E,EAAOC,KACP0S,EAAa3S,EAAK2S,WAElBA,EAAWqyC,WAEPryC,EAAW8mE,sBACXr8E,EAAEqM,KAAKqD,OAAO4sE,oBAAoB/mE,EAAW6iE,wBAAyB,SAAU,YAC3EptE,KAAK,WAEFpI,EAAKsoE,qBAAsBjS,SAAS,OAGvC1jD,EAAWmhC,gBACZ9zC,EAAKqyF,kBAGTryF,EAAKsoE,qBAAsBjS,SAAS,OAKhDg8B,gBAAiB,WACb,IAAIryF,EAAOC,KAGXD,EAAK2gC,mBAAmBq4B,0BAExBh5D,EAAK65E,WAAW3pE,KAAK,WACjB,OAAOlQ,EAAKksD,kBACb9jD,KAAK,SAAUJ,GACd,GAAc,MAAVA,GAA4B,GAAVA,GAAmC,WAAjBA,EAAOA,QAAsC,WAAfA,EAAOkC,KACzE,OAAOlK,EAAKm8E,cACT,GAAmB,sBAAfn0E,EAAOkC,KACd,IAEIlK,EAAK2gC,mBAAmB47C,qBAAqBv0E,EAAOg0E,UACtD,MAAO9tE,GACLpB,OAAOwtE,eAAetyE,EAAOg0E,SAAU,YAGhD3rE,KAAK,SAAUjB,EAAGiI,EAAGV,GAEpB,IACI3W,EAAK2gC,mBAAmB67C,gBAAgB7lE,GAC1C,MAAOzI,GACLpB,OAAOwtE,eAAe3jE,EAAS,aAM3Ck1D,cAAe,WACX,IACIl5D,EADO1S,KACW0S,WAClB2iD,EAAgCntD,MAAtBwK,EAAW2iD,SAAuBxoD,OAAOY,KAAKuF,aAAaN,EAAW2iD,SAGpF3iD,EAAWosD,SAAkC52D,MAAvBwK,EAAWosD,UAAwBjyD,OAAOY,KAAKuF,aAAaN,EAAWosD,UAEzFpsD,EAAWosD,UAPJ9+D,KAQF2gE,eAAejuD,EAAWosD,UAG9BzJ,GAXMr1D,KAYFkgE,iBAAiB7K,MC5FlCxoD,OAAO23D,UAAU+kD,UAAU9iH,OAAO,iCAI9B+tE,aAAc,WACCx0E,KACN0rE,aAAatuC,SAASj4B,UCRnC0H,OAAO23D,UAAUglD,KAAK/iH,OAAO,4BACzB+tE,aAAc,WACV,IACI/hE,EADOzS,KACQ0rE,aACf7pD,EAFO7hB,KAEU6zE,qBACjB21C,EAAOrsH,EAAE,yBAA0BsV,GAH5BzS,KAKNuuB,MAAQ9b,EAAQnP,KAAK,KALftD,KAMN8zE,oBAAoB3uE,OANdnF,KAQF0S,WAAW9O,MART5D,KASFomE,qBAELojD,EAAKnoH,SAAS,qBACdwgB,EAAUxgB,SAAS,wBAS3B0/D,gBAAiB,SAAUn9D,GACZ5D,KAEFypH,aAAa7lH,KAElBA,EAAQ8lH,mBAAmBvsH,EAAE+f,KAAKtZ,IAJ3B5D,KAKFuuB,MAAMjtB,KAAK,OAAQsC,KAIhCwiE,kBAAmB,WACf,IAAIrmE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAEtB3S,EAAKwuB,MAAM9hB,GAAG,QAAS,SAAUia,GAI7B,GAHAA,EAAMmtB,iBACNntB,EAAMwtB,kBAEFn0C,EAAK0pH,aAAa/2G,EAAW9O,OAAQ,CACrC,IAAI+lH,EAAaC,UAAU5pH,KAAKuR,aAAa,SAEf,cAA1BmB,EAAWm3G,YAA8Bh9G,OAAOY,KAAKk2B,qBACrDtlB,OAAOoJ,KAAKkiG,EAAY,UAAW,gBAEnCtrG,OAAOoJ,KAAKkiG,EAAY,eAWxCF,aAAc,SAAU7lH,GACpB,OAAQA,GAA0E,OAAjEzG,EAAE+f,KAAKtZ,EAAQ,IAAI6M,cAAcqN,MAAM,wBAAmC,KCzDnGjR,OAAO23D,UAAUzsC,UAAUtxB,OAAO,iCAK9BqsE,iBAAkB,WACd,IACIrgE,EADOzS,KACQ0rE,aAEnB1rE,KAAKsN,SAELmF,EAAQpR,SAAS,kCALNrB,KAMN0S,WAAWg0E,OAASt/E,KAAKiR,KAAqB,IAAhBjR,KAAKE,WAQ5C8+D,kBAAmB,WACf,IAAIrmE,EAAOC,KAEXD,EAAKuN,SACLnQ,EAAE,uBAAwB4C,EAAKizE,gBAAgBhuE,KAAK,SAAU,SAAUy1C,EAAKluC,GACzE,IAAI28G,EAAS/rH,EAAE6C,MAAMnC,KAAK,aACtB23F,GAAU,EACVr4F,EAAE6C,MAAMiyC,SAAS,aACjB90C,EAAE6C,MAAM6lB,YAAY,YAAYxkB,SAAS,gBACzCm0F,GAAU,IAEVr4F,EAAE6C,MAAM6lB,YAAY,gBAAgBxkB,SAAS,YAC7Cm0F,GAAU,GAGdz1F,EAAK+pH,uBAAuBZ,EAAQ1zB,MAI5Cs0B,uBAAwB,SAAUZ,EAAQ1zB,GACtC,IACIvsD,EACAr8B,EAAQzP,EAAEq5D,KAFHx2D,KAEa0S,WAAW9F,MAAO,SAAU3M,EAASkB,GACzD,OAAOlB,EAAQyrC,OAASw9E,IAExBt8G,GAASA,EAAM1H,OAAS,IACxB+jC,EAAOr8B,EAAM,IAEjBq8B,EAAKusD,QAAUA,GAMnBzlB,kBAAmB,WAEf5yE,EAAE,uBADS6C,KACoBgzE,gBAAgBxS,WAAW,YAG9DO,gBAAkB,SAAUn9D,OC3DhCiJ,OAAO23D,UAAUzsC,UAAUtxB,OAAO,yCAK9BqsE,iBAAkB,WACd,IAAI/yE,EAAOC,KACGD,EAAK2rE,aAEnB1rE,KAAKsN,SACLvN,EAAKwG,OAASpJ,EAAE,4CAA6C4C,EAAKE,SAClEF,EAAKgqH,UAAY5sH,EAAE,uCAAwC4C,EAAK0S,SAChE1S,EAAKiqH,YAAc7sH,EAAE,yCAA0C4C,EAAK0S,SACpE1S,EAAKs4B,UAAYl7B,EAAE,wCAAyC4C,EAAKE,SACjEF,EAAKkqH,aAAe9sH,EAAE,4CAA6C4C,EAAKE,SACxEF,EAAKmqH,cAAgB/sH,EAAE,kCAAmC4C,EAAK0S,SAC/D1S,EAAKoqH,iBAAmBhtH,EAAE,qCAAsC4C,EAAK0S,SACrE1S,EAAKqqH,qBACLrqH,EAAKqmE,oBACLjpE,EAAE,kCAAmC4C,EAAK2rE,aAAatuC,UAAUj4B,OAEjEpF,EAAKsqH,mBAGTA,gBAAiB,WACb,IAAItqH,EAAOC,KACX8B,WAAW,WACP,IAAIwoH,EAAgBvqH,EAAK2S,WAAW9F,MAAM+rC,OAAO,SAAS73C,GACtD,OAAOA,EAAEu6B,WACVn2B,OACH2H,OAAOY,KAAKgsB,oBAAoB,aAAc9c,KAAK1E,WAC/CsyG,YAAc,EACdC,WAAczqH,EAAK2S,WAAW83G,WAC9BC,cAAiBH,EACjB19G,MAAS7M,EAAK2S,WAAW9F,MACzBu+B,SAAYprC,EAAK2S,WAAWg4G,gBAGhC79G,OAAOkX,QAAQkiB,QAAQ,uCAAyCr5B,MAAS7M,EAAK2S,WAAW9F,MAAO89G,aAAgB3qH,EAAK2S,WAAWg4G,gBACjI,MAGPN,mBAAoB,WAChB,IAAIrqH,EAAOC,KACPyS,EAAU1S,EAAK2rE,aAEfi/C,GADoB3qH,KAAK+M,YAAY,2CAAoDhN,EAAK2S,WAAWg4G,aACrF1qH,KAAK+M,YAAY,oCACnChN,EAAKwG,QAAUxG,EAAKwG,OAAOrB,OAAS,GACtCnF,EAAKE,QAAQ24C,QAAQz7C,EAAE,UAAUkE,SAAS,4CAA4CO,OAAOzE,EAAE,WAAWgV,KAAKtF,OAAOC,aAAaC,YAAY,kDAE7IhN,EAAKkqH,cAAgBlqH,EAAKkqH,aAAa/kH,OAAS,GAC/CnF,EAAK2S,WAAWk4G,qBAA+D,KAAxC7qH,EAAK2S,WAAWk4G,qBACtD7qH,EAAKE,QAAQ24C,QAAQz7C,EAAE,UAAUkE,SAAS,4CAA4CO,OAAO,uCAC7FiL,OAAOC,aAAaC,YAAY,yCAChC,kBAAoBhN,EAAK2S,WAAWk4G,oBAAuB,iBAG7D7qH,EAAKgqH,WAAahqH,EAAKgqH,UAAU7kH,OAAS,GAC5CnF,EAAK0S,QAAQ7Q,OAAOzE,EAAE,UAAUkE,SAAS,uCAAuCO,OAAOzE,EAAE,aAAagV,KAAK,OAEzGpS,EAAKs4B,WAAat4B,EAAKs4B,UAAUnzB,OAAS,GAC5CnF,EAAKE,QAAQ2B,OAAOzE,EAAE,UAAUkE,SAAS,wCAAwCO,OAAOzE,EAAE,WAAWgV,KAAKw4G,KAE1G5qH,EAAKmqH,eAAiBnqH,EAAKmqH,cAAchlH,OAAS,GAClDnF,EAAKmqH,cAAc/kH,OAEnBpF,EAAKoqH,kBAAoBpqH,EAAKoqH,iBAAiBjlH,OAAS,GACxDnF,EAAKoqH,iBAAiBhlH,OAE1BsN,EAAQ2qB,SAAS/7B,SAAS,0BAG9B+kE,kBAAmB,WACf,IAAIrmE,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACnB1rE,KAAKsN,SACLnQ,EAAE,8CAA+CsV,GAAS0U,OAAO,SAASsC,MAAM,WAC5E,IAAI4vB,EAAel8C,EAAE,4CAA6C4C,EAAK0S,SACnE4mC,EAAan0C,QAAU,EACvBnF,EAAK8qH,iBAEL1tH,EAAE,yCAA0Ck8C,GAAchS,UAIlElqC,EAAE,6BAA8B4C,EAAK0S,SAASzN,KAAK,QAAS,WACxD,IAAIu0C,EAAOv5C,KACP0W,EAAU7J,OAAOC,aAAaC,YAAY,qCAC1C+9G,EAAgB3tH,EAAE6C,MAAM+yC,QAAQ,oCAEpC+3E,EAAczpH,SAAS,uBAEvBlE,EAAEqM,KAAKqD,OAAO4sE,oBAAoB/iE,EAAS,SAAU,SAChDvO,KAAK,WAEF,IAAI+gH,EAAS/rH,EAAEo8C,GAAMxG,QAAQ,oCAAoCl1C,KAAK,aAEtEkC,EAAKgrH,WAAW7B,GAChBnpH,EAAKgqH,UAAU1kH,SAEhB+K,KAAK,WACJ06G,EAAcjlG,YAAY,2BAItC1oB,EAAE,uBAAwB4C,EAAK0S,SAASzN,KAAK,QAAS,WAClD,IAAI/E,EAAU9C,EAAE6C,MAAM+yC,QAAQ,oCAC1Bm2E,EAASjpH,EAAQpC,KAAK,aACtBmtH,EAAe/qH,EAAQpC,KAAK,iBAEhCkC,EAAKkrH,WAAW/B,EAAQ8B,MAIhCC,WAAY,SAAS/B,GAGjB,IAFA,IAESpoH,EAAI,EAAGoE,EAFLlF,KAEmB0S,WAAW9F,MAAM1H,OAAQpE,EAAIoE,EAAQpE,IAFxDd,KAGE0S,WAAW9F,MAAM9L,GAAG4qC,OAASw9E,EAH/BlpH,KAIE0S,WAAW9F,MAAM9L,GAAG4tD,UAAW,EAJjC1uD,KAME0S,WAAW9F,MAAM9L,GAAG4tD,UAAW,EANjC1uD,KAUNkrH,iBAEL,IAAI7xE,EAAel8C,EAAE,6CACjBguH,EAAmBhuH,EAAE,yCAA0Ck8C,GAC/D+xE,EAAcD,EAAiB/7G,MAEnC+7G,EAAiB9jF,QACjB8jF,EAAiB,GAAG/jF,kBAAkBgkF,EAAYlmH,OAAQkmH,EAAYlmH,QAjB3DlF,KAkBN+pH,UAAU5kH,OAlBJnF,KAoBNqrH,uBAGTN,WAAY,SAAS7B,GAGjB,IAFA,IAESpoH,EAAI,EAAGoE,EAFLlF,KAEmB0S,WAAW9F,MAAM1H,OAAQpE,EAAIoE,EAAQpE,IAC/D,GAHOd,KAGE0S,WAAW9F,MAAM9L,GAAG4qC,OAASw9E,EAAQ,CAHvClpH,KAIE0S,WAAW9F,MAAMiN,OAAO/Y,EAAG,GAChC,MALGd,KASN+xC,SATM/xC,KASQ0S,WAAW9F,OATnB5M,KAUNkrH,iBAVMlrH,KAWNqrH,uBAGTR,eAAgB,WACZ,IAAI9qH,EAAOC,KACPsnF,GACA57C,KAAMtkC,KAAKskC,OACXrQ,UAAU,EACVp6B,KAAM,GACNytD,UAAU,GAGd3uD,EAAK2S,WAAW9F,MAAMhE,KAAK0+E,GAC3BvnF,EAAKmrH,iBACLnrH,EAAKgqH,UAAU5kH,OACfpF,EAAKiqH,YAAY3iF,QAEjBtnC,EAAKiqH,YAAYj6E,KAAK,WACjB,IAAIsJ,EAAel8C,EAAE,4CAA6C4C,EAAK0S,SAIrD,KAHKtV,EAAE,yCAA0Ck8C,GACjCjqC,OAEVrP,EAAK2S,WAAW9F,OAAS7M,EAAK2S,WAAW9F,MAAM1H,QAAU,GAC3B,KAA5CnF,EAAK2S,WAAW9F,MAAMsC,OAAO,GAAG,GAAGjO,MAC1ClB,EAAK2S,WAAW9F,MAAMwxC,QAG9Br+C,EAAKsrH,sBACLtrH,EAAKiqH,YAAYp6E,SAAS,SAAUlpB,GACb,IAAfA,EAAM6nB,QACN7nB,EAAMmtB,iBACN9zC,EAAKurH,UACLvrH,EAAK8qH,qBAKjBQ,oBAAqB,WACjB,IAAItrH,EAAOC,KACPq5C,EAAel8C,EAAE,4CAA6C4C,EAAK0S,SACnE04G,EAAmBhuH,EAAE,yCAA0Ck8C,GACnE8xE,EAAiB9jF,QACjBlqC,EAAE,6BAA8Bk8C,GAAcr0C,KAAK,QAAS,WACxD,IAAIglH,EAAcmB,EAAiB/7G,MAC/B46G,GAA+B,KAAhBA,GACfjqH,EAAKurH,YAGbnuH,EAAE,gCAAiCk8C,GAAcr0C,KAAK,QAAS,SAAUiJ,GACrE,IAAI+7G,EAAcmB,EAAiB/7G,MAC/BnP,EAAU9C,EAAE6C,MAAM+yC,QAAQ,oCAC1Bi4E,EAAe/qH,EAAQpC,KAAK,iBAC5B0tH,EAAWtrH,EAAQpC,KAAK,aAExBmsH,GAA+B,KAAhBA,GAAmE,KAA7CjqH,EAAK2S,WAAW9F,MAAMo+G,GAAc/pH,OACzElB,EAAK2S,WAAW9F,MAAMo+G,GAAct8D,UAAW,GAE/B,KAAhBs7D,GAAmE,KAA7CjqH,EAAK2S,WAAW9F,MAAMo+G,GAAc/pH,MAC1DlB,EAAKgrH,WAAWQ,GAEpBxrH,EAAKgqH,UAAU1kH,OACftF,EAAKmrH,oBAIbI,QAAS,WACMtrH,KACQ0rE,aADnB,IAGIryB,EAAel8C,EAAE,4CAHV6C,KAG4DyS,SAEnEu3G,EADmB7sH,EAAE,yCAA0Ck8C,GAChCjqC,MAEnCjS,EAAE0D,KAPSb,KAOC0S,WAAW9F,MAAO,SAAUzL,EAAO8nC,GACvCA,EAAKylB,WACLzlB,EAAKhoC,KAAO+oH,EACZ/gF,EAAKylB,UAAW,KAVb1uD,KAaNgwE,sBAbMhwE,KAcN+xC,SAdM/xC,KAcQ0S,WAAW9F,OAdnB5M,KAeNkrH,iBAfMlrH,KAgBN+pH,UAAU1kH,QAGnB6lH,eAAgB,WACDlrH,KACQ0rE,aADnB,IAEI8/C,EAFOxrH,KAEcmrE,gBACzBhuE,EAAE,8BAHS6C,KAG2ByS,SAAShP,YAAY+nH,GAHhDxrH,KAIN8yE,oBAGTg3C,uBAAwB,SAAUZ,EAAQ1zB,GACtC,IACIvsD,EACAr8B,EAAQzP,EAAEq5D,KAFHx2D,KAEa0S,WAAW9F,MAAO,SAAU3M,EAASkB,GACzD,OAAOlB,EAAQyrC,OAASw9E,IAExBt8G,GAASA,EAAM1H,OAAS,IACxB+jC,EAAOr8B,EAAM,IAEjBq8B,EAAK5N,SAAWm6D,EARLx1F,KASN+xC,SATM/xC,KASQ0S,WAAW9F,OATnB5M,KAUNyrH,aAVMzrH,KAUY0S,WAAW9F,QAGtC6+G,aAAc,SAAS7+G,GACR5M,KACQ0rE,aAInB,IALA,IAEIxmE,EAAS0H,EAAM1H,OACf4pC,EAAY,EAEPhuC,EAAI,EAAGA,EAAIoE,EAAQpE,IACpB8L,EAAM9L,GAAGu6B,WACTyT,GAAa,GAPV9uC,KAYF0S,WAAWg4G,aADhBxlH,EAAS,EACsBkC,KAAKC,MAAM,IAAMynC,EAAY5pC,GAG7B,IAfxBlF,KAkBNqqH,mBAGT13G,SAAU,SAAU9U,GAGhB,OAFWmC,KAEC4D,WAGhB4O,sBAAuB,WAInB,OAFoBmK,KAAK1E,UADdjY,KAC6B0S,WAAWG,iBACpC8J,KAAK1E,UAFTjY,KAEwB4D,QAOvCosE,oBAAqB,WACNhwE,KACN0S,WAAWG,cAAgBhG,OAAO8K,MAD5B3X,KACuC4D,QAMtDwjE,YAAa,SAAUF,GACnB,IACIx0D,EADO1S,KACW0S,WAGlBmO,EAAQnO,EAAWmO,MACnBjd,EALO5D,KAKM2S,WACb63G,EANOxqH,KAMW0S,WAAW83G,WANtBxqH,KAQFwS,wBAEA3F,OAAOY,KAAKqT,QAAQD,IAAWhU,OAAOY,KAAKqT,QAAQ0pG,KAChDt/G,MAAM6U,QAAQnc,GACdsjE,EAAax0D,EAAWmO,QACpB2pG,WAAYA,EACZ59G,MAAOhJ,GAEM,KAAVA,IACPsjE,EAAax0D,EAAWmO,OAAS,KAIzChU,OAAOY,KAAKgsB,oBAAoB,aAAc9c,KAAK1E,WAC/CsyG,YAAc,MAK1BvgH,QAAS,SAAU0vD,GACf,IAEIhjD,EADAhE,EADO1S,KACW0S,WAElB9F,EAHO5M,KAGM2S,WACjB+D,EAJW1W,KAII+M,YAAY,yCAC3B,IAAK,IAAIjM,EAAI,EAAGA,EAAI8L,EAAM1H,OAAQpE,GAAG,EAAG,CAEpC,IADW8L,EAAM9L,GACPu6B,SAAU,CAChBq+B,EAAgB9wD,MACZiY,MAAOnO,EAAWmO,MAClBnK,QAASA,IAEb,WCxVhB7J,OAAO23D,UAAUknD,YAAYjlH,OAAO,mCAGhC0kE,cAAe,WACX,IACIsnB,EADOzyF,KACY8iE,cAAcvT,YAAY,gBAEjD,OAHWvvD,KAENyS,QAFMzS,KAES0rE,aACbvuE,EAAEy8C,UAAU64C,OAGvB3f,iBAAkB,WACd,IACIrgE,EADOzS,KACQ0rE,aAEnB,GAHW1rE,KAGF4D,YAAqC,IAHnC5D,KAGmB4D,MAAMA,OAA8C,KAHvE5D,KAGuD4D,MAAMA,OAAqC,OAHlG5D,KAGkF4D,MAAMA,MAAgB,CAE/G,IAAI8f,EALG1jB,KAKQ4yF,cACfz1F,EAAEioD,MACE1hC,IAAKA,EACLzZ,KAAM,MACNoqB,SAAU,SACVo9B,aAAa,EACbk6D,QAAS,SAAU1tB,GAEf,GAAmB,iBAARA,EAAkB,CACzB,IACIj8D,EADM3zB,UAAU,GACEu9G,kBAAkB,gBACxC3tB,EAAOpxF,OAAOY,KAAK+vF,MAAMquB,gBAAgBh/G,OAAOY,KAAK+vF,MAAM/6D,kBAAkBw7D,GAAOj8D,GAGxF,IACI8pF,GADaztG,OAAO0tG,KAAO1tG,OAAO2tG,WACZC,gBAAgBhuB,GAE1C9gG,EAAEsV,GAASnP,KAAK,OAAOhC,KAAK,MAAOwqH,QASnDl5B,YAAa,WACT,IAEIya,EAFOrtG,KACgBo9B,OAAOA,OACC1qB,WAAW+iE,iBAE1C3qE,GACAsmD,OALOpxD,KAKM4D,MAAM8nC,KACnBkY,aANO5jD,KAMY4D,MAAMggD,aACzB/iC,MAPO7gB,KAOK0S,WAAWmO,MACvB7D,MAAO,GACP8F,OAAQ,GACRS,KAVOvjB,KAUI4D,MAAMA,MACjBsoH,OAAQ7e,EAAaxpD,SAAWwpD,EAAa1sE,WAAWkF,OAAS,IACjEsmF,WAAY9e,EAAaxpD,SAAWwpD,EAAa1sE,WAAWujB,WAAa,IACzEkoE,aAAc/e,EAAaxpD,SAAWwpD,EAAazkD,aAAe,KAGtE,OAhBW5oD,KAgBC+iE,YAAYngB,eAAeN,OAAO,uCAAuCuwC,gBAAgB/nF,IAKzG6iE,gBAAiB,WAEb,OADW3tE,KACE4D,UClErBiJ,OAAO23D,UAAU6nD,WAAW5lH,OAAO,kCAI/B+tE,aAAc,WACCx0E,KACU6zE,qBACXxyE,SAAS,uBAFRrB,KAGN4D,WAAQsE,GAGjB4qE,iBAAkB,WACd,IACI7yE,EADMD,KACSC,QACfA,GACAA,EAAQwM,GAAG,QAAStP,EAAEmvH,MAHhBtsH,KAG2BusH,eAH3BvsH,QAOdusH,eAAgB,WACZ,IACIlhH,GACI8uC,YAFGn6C,KAEiB0S,WAAWynC,YAC/BqyE,oBAAsB,EACtBC,UAJGzsH,KAIe0S,WAAW+5G,UAC7BC,cALG1sH,KAKmB0S,WAAWg6G,cACjC7rG,MANG7gB,KAMW0S,WAAWmO,OAE7BhU,OAAOi+B,wBAAqE,oBAA3Cj+B,OAAOi+B,uBAAuBo2E,OAAO5jH,KACtE+N,EAAOmhH,oBAAqB,GATrBxsH,KAWNg4D,qBAAqB,kBAAmB3sD,MChCrDwB,OAAO23D,UAAUmoD,YAAYlmH,OAAO,mCAEhCsrC,SAAU,SAAS3iC,EAAIg+D,GACRptE,KACN0S,WAAWynC,YAAc/qC,EAC9BpP,KAAKsN,OAAO8B,EAAKg+D,GACjB,IAAI36D,EAHOzS,KAGQ0rE,aAChBj5D,GACCtV,EAAE,0BAA2BsV,GAASN,KAAK/C,MCRvDvC,OAAO23D,UAAUooD,WAAWnmH,OAAO,kCAC/Bs6D,gBAAiB,SAAUn9D,OCA/BiJ,OAAO23D,UAAUqoD,eAAepmH,OAAO,yCCAvCoG,OAAO23D,UAAUsoD,aAAarmH,OAAO,oCAIjCsrC,SAAU,SAAS3iC,EAAKg+D,GACpB,IACI36D,EADOzS,KACQ0rE,aACnBt8D,EAAM,MAAQA,EAAwC,GAF3CpP,KAEqD2tE,gBAAgBv+D,GAFrEpP,KAGN0S,WAAWynC,YAAc/qC,EAE9BpP,KAAKsN,OAAO8B,EAAKg+D,GACd36D,GACCtV,EAAE,2BAA4BsV,GAASN,KAAK/C,IAOpDu+D,gBAAiB,SAAU/pE,GACvB,IACI8O,EADO1S,KACW0S,WAClB1R,EAAQ7D,EAAE,YAAYoG,KAAKK,GAa/B,OAXA5C,EAAM+wB,gBACFpB,OAAQje,EAAWie,OACnBI,eAAgBre,EAAWqe,eAC3BD,eAAgBpe,EAAWoe,eAC3BT,cAAe3d,EAAW2d,cAC1BE,iBAAkB7d,EAAW6d,iBAC7BM,YAAane,EAAWme,YACxBJ,oBAAqB/d,EAAW01E,YAChCx3D,SAAUle,EAAWke,YAGjB5vB,EAAMmR,WCnCtBtF,OAAO23D,UAAUuoD,YAAYtmH,OAAO,mCAIhCsrC,SAAU,SAAS3iC,EAAKg+D,GAC3B,IACI36D,EADOzS,KACQ0rE,aAEnBt8D,EAAM,MAAQA,EAAwC,GAH3CpP,KAGqD2tE,gBAAgBv+D,GAHrEpP,KAIN0S,WAAWynC,YAAc/qC,EAE9BpP,KAAKsN,OAAO8B,EAAKg+D,GACd36D,GACCtV,EAAE,2BAA4BsV,GAASN,KAAK/C,MCdjDvC,OAAO23D,UAAUwoD,aAAavmH,OAAO,oCAIpC0kE,cAAe,WACd,IAAIprE,EAAOC,KACV0S,EAAa3S,EAAK2S,WAClB+Q,EAAQtmB,EAAE4S,WAQX,OANA5S,EAAEqM,KAAKzJ,EAAKgzF,oBAAoBlmF,OAAO8K,MAAMjF,KAAcvK,KAAK,SAASuK,EAAYygF,GACpFpzF,EAAK2S,WAAaA,EAClB3S,EAAKuzF,MAAQH,EAAYG,MACzB7vE,EAAMtT,QAAQpQ,EAAKktH,kBAGbxpG,EAAMlb,WAGduqE,iBAAkB,WACd,IAAI/yE,EAAOC,KACGD,EAAK2rE,aACapoE,KAAK,mCAEnBmJ,GAAG,QAAS,WAC1BI,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMh4D,aAAaroC,EAAE6C,MAAMsB,KAAK,YAAatB,KAAK/B,QAAQmS,KAAK,SAASurB,GACnFA,EAAMO,cACNn8B,EAAK2gC,mBAAmBo6C,YAAYn/C,EAAMO,gBAE/CisC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,YAK3BivF,aAAc,WACb,IAAIltH,EAAOC,KACPszF,EAAQn2F,EAAE2N,IAAI/K,EAAKuzF,MAAO,SAASrxE,GACtC,IAAIgJ,GAAQ3tB,GAAM2kB,EAAG,GAAIg1E,SAAYh1E,EAAG,IAExC,OADAgJ,EAAKvH,IAAO3jB,EAAKi3F,aAAa/rE,GACvBA,IAGJ5sB,EAAW0B,EAAK+iE,cAAcvT,YAAY,iBAC9C,OAAOpyD,EAAEy8C,UAAUv7C,GAAWi1F,MAASA,KAMxC0D,aAAc,SAAU/rE,GACvB,IACCvY,EADU1S,KACQ0S,WAEf8yC,EAHOxlD,KAGK0gC,mBAEhB,OALW1gC,KAKC+iE,YAAYra,wBACvBC,+BANU3oD,KAM2B2oD,iCACrC9nC,MAPU7gB,KAOEuzF,iBACZ/qC,OAAQv9B,EAAK3tB,GACbumD,SAAU2B,EAAK9yC,WAAW+iE,aAAa5xB,UAAY,YACnDC,aAAcpxC,EAAWoxC,aACzBM,YAAaoB,EAAK9yC,WAAW+iE,aAAarxB,aAAe,YACzDwE,aAAcpD,EAAK9yC,WAAW+iE,aAAa7sB,cAAgB,YAC3D/B,UAAWrB,EAAK9yC,WAAWm0C,UAC3BP,aAdUtmD,KAcS0S,WAAW9O,MAAMggD,aACpCkD,WAfU9mD,KAeO0S,WAAW9O,MAAM8nC,UChErC7+B,OAAO23D,UAAU9iC,MAAMj7B,OAAO,0BAC1BgwG,gBAAiB,GACjBE,eAAgB,OAAQ,MAAO,SAgB/BuW,UAAW,KAKXC,aAAc,KAKd3Q,WAAY,KAKZjf,UAAU,EAKVp/D,eAAe,EAMfgtC,cAAe,WACX,IACIz4D,EADO1S,KACW0S,WAOtB1S,KAAKm+B,eAAgB,EACrBn+B,KAAKu9F,SAAW1wF,OAAOY,KAAKk2B,qBAE5B,IAAItlC,EAXO2B,KAWS8iE,cAAcvT,YAAY,SAE1C5J,GAbO3lD,KAaYm+B,gBAAwBzrB,EAAWizC,aAAejzC,EAAWqyC,UACpF,OAAO5nD,EAAEy8C,UAAUv7C,GACfqlB,IAAK,GACLiiC,YAAaA,EACbZ,SAAUryC,EAAWqyC,YAI7BspB,qBAAsB,SAAS1/D,GAC3B,OAAOxR,OAOXiuE,eAAgB,WACZ,OAAOprE,KAAKmrE,iBAMhBhnE,WAAY,aAMZ2nE,mBAAoB,WAEhB9rE,KAAKC,QAAQoB,SAAS,uCAM1B+kE,kBAAmB,WACf,IAAIrmE,EAAOC,KACPue,EAAU1R,OAAOY,KAAK+zB,oBACtB4rF,KAEJptH,KAAKktH,UAAY/vH,EAAE,2BAA4B6C,KAAK0rE,cACpD1rE,KAAKmtH,aAAehwH,EAAE,8BAA+B6C,KAAK0rE,cAC1D1rE,KAAKw8G,WAAar/G,EAAE,0BAA2B6C,KAAK0rE,cAEpD1rE,KAAKsN,SAEDtN,KAAKu9F,SAELv9F,KAAKktH,UAAUjpD,IAAI,SAAS/pB,aACxB76C,UAEQqsC,KAAQ,EACRyO,YAAettC,OAAOC,aAAaC,YAAY,gDAG/C2+B,KAAQ,EACRyO,YAAettC,OAAOC,aAAaC,YAAY,8CAGvD4tC,cAAe,SAASvvC,GACpB,OAAQA,EAAOsgC,MACf,KAAK,EACD3rC,EAAKstH,WACL,MACJ,KAAK,EACDttH,EAAKstH,UAAS,KAKtBtV,OAAQ,SAAS3sG,GACbrL,EAAKi4D,qBAAqB,0BAE9Bpd,cAAe,SAASxvC,GACpBrL,EAAKi4D,qBAAqB,+BAI9BnrD,OAAOY,KAAK+vF,MAAMka,mBAClB13G,KAAKktH,UAAUjpD,IAAI,SAASx6C,MAAM,WAC9B1pB,EAAKy8G,WAAW/yF,WAGpBzpB,KAAKC,QAAQoB,SAAS,sCACtBrB,KAAKktH,UAAUrnG,YAAY,WAAWxkB,SAAS,oBAKvDrB,KAAKmtH,aAAalpD,IAAI,SAASx6C,MAAM,WAAa1pB,EAAKutH,gBAEvDttH,KAAKw8G,WAAWv4C,IAAI,UAAUx3D,GAAG,SAAU,WACvC1M,EAAKstH,WACLrtH,KAAK4D,MAAQ,KAIjB5D,KAAKw8G,WAAWv4C,IAAI,SAASx3D,GAAG,QAAS,SAASwB,GAAKA,EAAEimC,oBAKrDk5E,EADA7uG,GAAWA,GAAW,MAEhBmtB,KAAQ,EAAGyO,YAAettC,OAAOC,aAAaC,YAAY,8BAG7CF,OAAOY,KAAK+vF,MAAMwa,0BAGzC76G,EAAE,2BAA4B4C,EAAK2rE,cAAczH,IAAI,SAAS/pB,aAC1D76C,QAAS+tH,EACTzyE,cAAe,SAASvvC,GACpByB,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKzJ,EAAKwtH,wBAAwBniH,EAAOsgC,OACtCy8B,OAAO,WACJt7D,OAAOk1E,QAAQ/jD,UAG3B+5E,OAAQ,SAAS3sG,GACbrL,EAAKi4D,qBAAqB,0BAE9Bpd,cAAe,SAASxvC,GACpBrL,EAAKi4D,qBAAqB,gCAKtC+X,kBAAmB,WACf/vE,KAAKmtH,aAAa1jG,SAOtB4jG,SAAU,SAASG,GAEf,IAAIztH,EAAOC,KAEX,GAAKA,KAAKu9F,SAoBH,CAEH,IAAIlgG,GACA+7G,QAASr5G,EAAKsiD,MAAMo0D,gBACpByD,YAAa,KACbC,aAAc,IACdF,oBAAoB,GAGxB,IAAKuT,EAAW,CACZ,IAAIC,EAAc1tH,EAAK2rE,aAAa,GAAGgiD,wBAEvCrwH,GACI+7G,QAASr5G,EAAKsiD,MAAMo0D,gBACpB4C,WAAYC,OAAOC,kBAAkBC,aACrCmU,eAAgB,IAAIC,qBAAqBH,EAAYlmG,KAAMkmG,EAAY5qG,IAAM,GAAI,IAAK,IAAK,GAC3Fi3F,gBAAiBl8F,UAAUg7F,OAAOmB,gBAAgBC,SAClDC,oBAAoB,GAK5Br8F,UAAUg7F,OAAOC,WAAW,SAASl3E,GAEjC90B,OAAOk1E,QAAQzoD,QAEfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMsb,aAAan3E,EAAW5hC,EAAK2S,aAAamR,KAAK,WACpE,OAAO1mB,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMub,gBAAgBp3E,IAAY9d,KAAK,SAASm1F,GACtE,GAAInsG,OAAOY,KAAK+vF,MAAM8a,eAAeU,EAAUj5G,EAAK2S,WAAY3S,EAAKsiD,MAAMs0D,eAAgB,CACvF52G,EAAK4hC,UAAYA,EACjB5hC,EAAK43F,eAAiBqhB,EAEtB,IAAIz6F,EAAU1R,OAAOY,KAAK+zB,oBAC1B,GAAKjjB,GAAWA,GAAW,KAAQxe,EAAKo+B,cACpC,OAAOhhC,EAAEqM,KAAKzJ,EAAK07G,WAAW17G,EAAK4hC,YAAYx5B,KAAK,SAASJ,GACzDhI,EAAK8tH,oBAAoB9tH,KAC1BqQ,KAAK,SAASurB,GACb57B,EAAK44G,uBAAuBh9E,KAC7BwsC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,SAKnB,IAAKnxB,OAAOY,KAAK42B,YACb,OAAOlnC,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMyb,yBAAyBp1F,KACrD,SAASq1F,GACL,GAAIA,GAAersG,OAAOY,KAAK+vF,MAAMwa,0BAA0B9yG,OAC3D,OAAOnF,EAAKwtH,wBAAwBrU,KAMhD/7G,EAAE,2BAA4B4C,EAAK2rE,cAAcjiD,aAOlE0+C,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAEpBj+B,EAAKo5G,OAAQ97G,OApFA,CAChB,IAAI66G,EAAWl4G,KAAKw8G,WAAW,GAAGlpB,MAAM,GACxC4kB,EAASE,SAAWp4G,KAAKw8G,WAAW,GAAG54G,MACvC,IAAIu0G,EAAan4G,KAAKqiD,MAAMs0D,cAE5B9pG,OAAOk1E,QAAQzoD,QACXzsB,OAAOY,KAAK+vF,MAAM6a,iBAAiBH,EAAUn4G,EAAK2S,aAAe7F,OAAOY,KAAK+vF,MAC5E8a,eAAeJ,EAAUn4G,EAAK2S,WAAYylG,GAE3Ch7G,EAAEqM,KAAKzJ,EAAK07G,WAAWvD,IAAW/vG,KAAK,SAASJ,GAC5ChI,EAAK8tH,oBAAoB9tH,KAC1BqQ,KAAK,SAASurB,GACb57B,EAAK44G,uBAAuBh9E,KAC7BwsC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,SAInBnxB,OAAOk1E,QAAQ/jD,SA4E3Bm7E,OAAQ,SAASx9E,GACb9uB,OAAOY,KAAKI,WAAWC,eAM3Bw/G,YAAa,WACT,IAAIvtH,EAAOC,KACX6M,OAAO4sE,oBAAoBz5E,KAAK+M,YAAY,oCACvC5E,KAAK,WACF0E,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKzJ,EAAKgjE,YAAY/Z,aACpBtlC,IAAK3jB,EAAK2S,WAAWuuE,UACrBp9B,SAAU9jD,EAAK2S,WAAWpV,GAC1BujB,MAAO9gB,EAAK2S,WAAWmO,MACvBijC,aAAc/jD,EAAK2S,WAAWoxC,aAC9BM,YAAarkD,EAAK2S,WAAW0xC,YAC7BgC,YAAarmD,EAAK2S,WAAW0zC,eAC7Bj+C,KAAK,WACLpI,EAAK8tH,oBAAoB9tH,KAC1BqQ,KAAK,SAASrB,GACb,IAAI2H,EACAwlB,EAAentB,EAAImtB,aAEvB,IAEIxlB,GADAA,EAAUiG,KAAKhE,MAAMujB,IACHxlB,SAAWwlB,EAC/B,MAAOjuB,GACLyI,EAAUwlB,EAEdrvB,OAAOwtE,eAAe3jE,EAAS,WAEhCyxD,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,YAU/By9E,WAAY,SAASvD,GAEjB,IAAIn4G,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SAElB,GAAK/P,KAAKm+B,cA6DNp+B,EAAKs9F,iBAAiBt9F,EAAMm4G,EAAU,SAAS32B,GAC3CxhF,EAAKgyC,SAASwvC,GACd99D,EAAMtT,YAIVpQ,EAAKonE,UAAY,WACb,OAAO,QAjEX,GAAInnE,KAAKu9F,SAAU,CAGf,IAAIlyF,KACA8vG,EAAYp7G,EAAKq3F,iBACjBltC,EAAWnqD,EAAK43F,eAAe12F,KAE/BlB,EAAKg7G,eACL1vG,EAAO6sG,SAAWn4G,EAAKg7G,eAChBh7G,EAAK43F,iBACZtsF,EAAO6sG,SAAWn4G,EAAK43F,eAAej0E,KAG1Cy3F,EAAUC,QAAU,KAAOvuG,OAAOY,KAAKmT,YAAY7gB,EAAKwzF,kBACxDloF,EAAOxN,KAAOs9G,EACd9vG,EAAOhO,QAAU,IAAIg+G,kBACrBhwG,EAAOhO,QAAQi+G,QAAU,OACzBjwG,EAAOhO,QAAQ6sD,SAAWA,EAC1B7+C,EAAOhO,QAAQk+G,SAAW,aAC1BlwG,EAAOhO,QAAQm+G,WAAcz6G,IAAKo6G,EAAmB,SACrD9vG,EAAOhO,QAAQwjF,OAAS9gF,EAAK2S,WAAWmuE,OAGxC9gF,EAAKg7G,eAAiB,KACtBh7G,EAAK43F,eAAiB,KAGtBtsF,EAAO6sG,SAAWrrG,OAAOY,KAAK+vF,MAAMC,aAAapyF,EAAO6sG,UAExD/6G,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMie,WAAWpwG,IAASlD,KAAK,SAAS+O,GACvD,IAAIouC,EAAW3oC,KAAKhE,MAAMM,mBAAmB/B,EAAEouC,WACzB,UAAlBA,EAASr7C,KACTwZ,EAAM6uC,OAAOhN,GAEb7hC,EAAMtT,QAAQm1C,KAEnBl1C,KAAK,SAASurB,GACblY,EAAM6uC,OAAO32B,UAIb9uB,OAAOY,KAAK+vF,MAAM6a,iBAAiBH,EAAUn4G,EAAK2S,aAClD7F,OAAOY,KAAK+vF,MAAM8a,eAAeJ,EAAUn4G,EAAK2S,WAAY3S,EAAKsiD,MAAMs0D,eAEvE52G,EAAKgjE,YAAYzR,mBACb5tC,IAAK3jB,EAAK2S,WAAWmuE,OACrBrvB,SAAUzxD,EAAKg8G,mBAAmB7D,KACnC/vG,KAAK,SAASm9C,GACb7hC,EAAMtT,QAAQm1C,KACfl1C,KAAK,SAASurB,GACblY,EAAM6uC,OAAO32B,KAGjBlY,EAAM6uC,SAgBlB,OAAO7uC,EAAMlb,WAOjBslH,oBAAqB,SAASl/G,GAC1B,IAAI5O,EAAO4O,EAEX,IACI5O,EAAK+tH,iBACL/tH,EAAKg7G,eAAiB,KACxB,MAAOp/E,GACL57B,EAAK2gC,mBAAmBw7C,gBAMhC4xC,eAAgB,WACZ,IAAI/tH,EAAOC,KACPyS,EAAU1S,EAAK2rE,aAEnBvuE,EAAEqM,KAAKzJ,EAAKi3F,gBAAgB7uF,KAAK,SAASo5E,GACjCxhF,EAAKokE,eACNpkE,EAAK2S,WAAWgR,IAAmB,KAAZ69D,EAAkBA,EAAU,GACnDxhF,EAAK2S,WAAW9O,MAAQ7D,EAAK2S,WAAWgR,IAAIxe,OAAS,GAAKnF,EAAK2S,WAAWgR,KAAO,KACjF3jB,EAAKgyC,SAAShyC,EAAK2S,WAAW9O,OAE1B7D,EAAKo+B,gBAAyD,IAAxCojD,EAAQr3E,QAAQ,qBACtCnK,EAAK2S,WAAWgR,IAAM,IAG1BjR,EAAQnP,KAAK,0BAA0B2gE,IAAI,SAAS0Q,YAAY,0BAC5D50E,EAAK2S,WAAWqyC,UAAoC,KAAxBhlD,EAAK2S,WAAWgR,KAEpB,KAAxB3jB,EAAK2S,WAAWgR,KAChBjR,EAAQnP,KAAK,8BAA8BoB,IAAI,UAAW,WACrDpD,KAAK,MAAOvB,EAAK2S,WAAWgR,KACjCjR,EAAQnP,KAAK,8BAA8B2gE,IAAI,SAASx6C,MAAM,WAAa1pB,EAAKmzE,kBAChFzgE,EAAQnP,KAAK,4BAA4By6C,OAAOh+C,EAAK2S,WAAWqyC,UAChEtyC,EAAQnP,KAAK,+BACRy6C,OAAOh+C,EAAK2S,WAAWizC,aAAe5lD,EAAK2S,WAAWqyC,YAE3DtyC,EAAQnP,KAAK,8BAA8BoB,IAAI,UAAW,QAC1D+N,EAAQnP,KAAK,sCAAsC6B,OACnDsN,EAAQnP,KAAK,+BAA+B6B,QAEhDpF,EAAKqmE,wBAWjBi3B,iBAAkB,SAAS1uF,EAAS+U,EAAKzX,GACrC,IAAIwG,EAAUzS,KAAK0rE,aACfhqC,EAAQ,IAAIqsF,MAEhBrsF,EAAMssF,OAAS,WACX,IAAI7wF,EAAShsB,SAAS2d,cAAc,UACpCqO,EAAOngB,MAAQhd,KAAKgd,MACpBmgB,EAAOra,OAAS9iB,KAAK8iB,OAErBqa,EAAO8wF,WAAW,MAAMC,UAAUluH,KAAM,EAAG,GAG3C,IAAIuhF,EAAUpkD,EAAOgxF,UAAU,aAC/BliH,EAASs1E,EAAQ58E,QAAQ,sCAAuC,MAGpE+8B,EAAM/d,IAAMD,EACZjR,EAAQnP,KAAK,OAAOG,YAAYi+B,GAChCjvB,EAAQnP,KAAK,0BAA0BG,YAAYi+B,IAOvD6rF,wBAAyB,SAASl3C,GAC9B,IAAIt2E,EAAOC,KACP06G,EAAiBrkC,GAAW,EAGhC,GAAIqkC,IAAmB7tG,OAAOY,KAAK+vF,MAAMmd,eAAeC,SAEpD,OAAOz9G,EAAEqM,KAAKzJ,EAAK07G,WAAW17G,EAAK4hC,YAAYx5B,KAAK,SAASJ,GACzDhI,EAAK8tH,oBAAoB9tH,KAC1BqQ,KAAK,SAASurB,GACb57B,EAAK44G,uBAAuBh9E,KAKhC,IAAI2N,EAAaz8B,OAAOY,KAAK+vF,MAAMqd,mBAAmBH,GAEtD,OAAOv9G,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMsd,mBAAmB/6G,EAAK4hC,UAAW2H,IAC9DzlB,KAAK,SAAS9b,GAKX,OAHAhI,EAAKg7G,eAAiBhzG,EAAOizG,SAC7Bj7G,EAAK2S,WAAWgR,IAAM3b,EAAOkzG,YAEtB99G,EAAEqM,KAAKzJ,EAAK07G,WAAW17G,EAAK4hC,YAC9Bx5B,KAAK,SAASJ,GACXhI,EAAK8tH,oBAAoB9tH,KAC1BqQ,KAAK,SAASurB,GACb57B,EAAK44G,uBAAuBh9E,QAapDg9E,uBAAwB,SAASh9E,GAC7B,IACIu/E,EAAgBv/E,EAAMO,aAAeP,EAAMO,aACzCrvB,OAAOC,aAAaC,YAAY,4BAF3B/M,KAGN0gC,mBAAmBo6C,YAAYogC,IAMxCpoC,iBAAkB,WACH9yE,KAENsN,SAFMtN,KAINomE,oBAJMpmE,KAKN+yE,oBALM/yE,KAQD0S,WAAWqyC,UARV/kD,KASF8rE,qBATE9rE,KAYN8tH,kBAOT56C,cAAe,WACX,IAAInzE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlB07G,EAAaruH,EAAK6gC,YAClB/e,EAAYusG,EAAW9rD,WAAWumC,uBAE9B5qG,MAAOyU,EAAWynC,YAClB+mE,MACImN,MAAM,EACNj1E,oBAAoB,KAK5Bk1E,EAAMnxH,EAAEm2E,WAAWvzE,EAAK+iE,cAAcvT,YAAY,kBAChD7rC,IAAQ3jB,EAAK6D,OAA2B,KAAlB7D,EAAK6D,MAAM,GAAY7D,EAAK6D,MAAM,GAAK,KACnEie,EAAU5hB,QAAQyE,IAAI,UAAW,QACjC3E,EAAKwzE,aAAe1xD,EAAU5hB,QAAQsD,KAAK+qH,GAC3CF,EAAW9rD,WAAWh3B,SAASzpB,EAAUvkB,IAEzCuP,OAAOk1E,QAAQzoD,QAGfn8B,EAAEqM,KAAKzJ,EAAKu+F,oBAAoBn2F,KAAK,SAASo5E,GAG1C,GAFA1/D,EAAU5hB,QAAQyE,IAAI,UAAW,SAE7B68E,EAAQr3E,QAAQ,SAAW,EAAG,CAC9B,IAAIqkH,EAAWpxH,EAAE,oCAAqC0kB,EAAU5hB,SAASqB,KAAK,MAAOigF,GACjFitC,EAAqBD,EAAS7pH,IAAI,SACtC8pH,EAAqB3kH,OAAO2kH,EAAmBhwG,UAAU,EAAGgwG,EAAmBtpH,OAAS,KAEzD,IAA3BnF,EAAK2S,WAAWsK,OAAgBjd,EAAK2S,WAAWsK,MAAQwxG,GACxDD,EAAS7pH,IAAI,QAAS,WAG/ByjE,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,UAUvB+9E,mBAAoB,SAAS7D,GACzB,IAAIn4G,EAAOC,KACP0S,EAAa3S,EAAK2S,WAGlB8+C,EAAW,IAAIwqD,SACfx2D,EAAOzlD,EAAK2gC,mBAGhB8wB,EAAS5vD,OAAO7B,EAAKsiD,MAAMK,4BAA8B,QAAShwC,EAAWmO,OAC7E2wC,EAAS5vD,OAAO7B,EAAKsiD,MAAMK,4BAA8B,WAAYhwC,EAAWpV,IAChFk0D,EAAS5vD,OAAO7B,EAAKsiD,MAAMK,4BAA8B,eAAgBhwC,EAAWoxC,cACpF0N,EAAS5vD,OAAO7B,EAAKsiD,MAAMK,4BAA8B3iD,EAAKsiD,MAAMM,cAAejwC,EAAW0xC,aAC9FoN,EAAS5vD,OAAO7B,EAAKsiD,MAAMI,2BAA6B,YAAa+C,EAAK9yC,WAAWm0C,WACrF2K,EAAS5vD,OAAO7B,EAAKsiD,MAAMK,4BAA8B,SAAU,YACnE8O,EAAS5vD,OAAO7B,EAAK2S,WAAWmO,MAAOq3F,GAEnCxlG,EAAW0zC,aACXoL,EAAS5vD,OAAO7B,EAAKsiD,MAAMK,4BAA8B,cAAehwC,EAAW0zC,aAGvF,IACyC,oBAA1B,oBACPoL,EAAS5vD,OAAOy1F,oBAAqB7xC,EAAK9yC,WAAWm0C,WAErD2K,EAAS5vD,OAAO,aAAc4jD,EAAK9yC,WAAWm0C,WAEpD,MAAO54C,GACLujD,EAAS5vD,OAAO,aAAc4jD,EAAK9yC,WAAWm0C,WAGlD,OAAO2K,GAOX2hB,eAAgB,eChpBpBtmE,OAAO23D,UAAUihD,SAASh/G,OAAO,6BAC7Bg8C,2BAA4B,KAC5BC,4BAA6B,KAC7BC,cAAe,gBAEfnrC,KAAM,SAAUnM,GAEZrL,KAAKsN,OAAOjC,GACZA,EAAOsD,QAAUtD,EAAOsD,SAAW,WACnC,IAAI8mE,EAAet4E,EAAEsJ,UAAWzG,KAAK2sB,SAAWwyB,YAAen/C,KAAK+iE,YAAYngB,eAAezD,YAAaxwC,QAAW3O,KAAK+iE,YAAYngB,eAAej0C,UACvJ3O,KAAK4iD,eAAiB,IAAI/1C,OAAO2xC,OAAOC,SAAS9vC,QAAQ8mE,IAG7DjB,aAAc,WACV,IAAIz0E,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClBmP,EAAY9hB,EAAK8zE,qBACjBphE,EAAU1S,EAAK2rE,aAEnB3rE,EAAK+zE,oBAAoB3uE,OAEM,UAA3BuN,EAAWg3D,aACX3pE,EAAKiuE,oBAAoBt7D,EAAWg3D,aAExC3pE,EAAKilE,gBAAkBjlE,EAAKE,QAC5ByS,EAAW+7G,qBAAuB/7G,EAAWg3D,YAC7Ch3D,EAAWg3D,YAAc,SACzB3pE,EAAKwuB,MAAQxuB,EAAKE,QAAUwS,EAAQnP,KAAK,KAEzCvD,EAAK8lH,cAAgB9lH,EAAK+gF,kBAC1B/gF,EAAK+lH,SAAW/lH,EAAKgjE,YAAYvf,YACjCzjD,EAAK2uH,gBAAiB,EACtB3uH,EAAK4sB,SACDk3B,SAAUnxC,EAAWpV,GACrBwmD,aAAc/jD,EAAK4uH,0BACnBvqE,YAAa1xC,EAAW0xC,YACxBJ,YAAajkD,EAAK65F,mBAClB71C,cAAe,WACfgB,SAAUryC,EAAWqyC,SACrBrhC,IAAKhR,EAAWszG,UAGftzG,EAAWqyC,SAGZljC,EAAUxgB,SAAS,0BAFnBwgB,EAAUxgB,SAAS,uBAO3B6xE,cAAe,WACX,IAAInzE,EAAOC,KACP0S,EAAa3S,EAAK2S,WAKtB,GAHA3S,EAAK8hB,UAAY9hB,EAAK6gC,YAAY0hC,WAAWumC,uBAAwB5qG,MAAOyU,EAAWynC,cACvFp6C,EAAKwzE,aAAexzE,EAAK8hB,UAAU5hB,SAEhCF,EAAK2S,WAAWk8G,aAUf,OAAO7uH,EAAK8uH,WATZ,IAAIrpE,EAAOzlD,EAAK2gC,mBAChBvjC,EAAEqM,KAAKg8C,EAAKo0B,YAAYzxE,KAAK,WACzBpI,EAAK+uH,2BAA2B3mH,KAAK,WACjC,OAAOpI,EAAKgvH,aAAa,eAC1B3+G,KAAK,SAAUurB,GACd9uB,OAAO6T,IAAI,UAAY0yE,IAAItqD,WAQ3C+lF,SAAU,WACN,IAAI9uH,EAAOC,KAGX,OAAO7C,EAAEqM,KAAKzJ,EAAK8lH,cAAcz3G,MAAMrO,IAAOoI,KAAK,WAC/C0E,OAAOY,KAAKI,WAAWrM,eACvBrE,EAAEqM,KAAKzJ,EAAKivH,iBAAiB7mH,KAAK,WAC9B0E,OAAOY,KAAKI,WAAWC,gBACxBsC,KAAK,WACJvD,OAAOY,KAAKI,WAAWrM,eACvBzB,EAAKkvH,iBACN9mD,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,kBAE5Bq6D,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,iBAI/BihH,aAAc,SAAU7tG,GACpB,IAAInhB,EAAOC,KACPyhE,EAAM,IAAItkE,EAAE4S,SAuBhB,OArBAlD,OAAOY,KAAKI,WAAWrM,eAEvBzB,EAAKuR,iBAAiB4P,MACjB/Y,KAAK,SAAU+mH,GACZ,GAAIA,EAAanzC,SAAU,CACvB,IAAIrlE,EAAUw4G,EAAanzC,SAAS,GACzBh8E,EAAK2gC,mBACX2jC,qBAAqB7L,iBAAiB9hD,GAC3C+qD,EAAInP,aAEa,cAAbpxC,GACAnhB,EAAK8uH,WAGbptD,EAAItxD,YACLC,KAAK,WACRqxD,EAAInP,WAEH6V,OAAO,WACJt7D,OAAOY,KAAKI,WAAWC,gBAExB2zD,EAAIl5D,WAGf+I,iBAAkB,SAAU8tF,EAAc/zF,GACtC,IAAItL,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB+Q,EAAQ,IAAItmB,EAAE4S,SA4BlB,OA1BAhQ,EAAKgjE,YAAYzf,cAAcqD,iBAC3BjjC,IAAKhR,EAAW6uE,QAChB1gE,MAAOnO,EAAWmO,MAClBgjC,SAAUnxC,EAAWpV,GACrBwmD,aAAcpxC,EAAWoxC,aACzBM,YAAa1xC,EAAW0xC,YACxBljC,SAAUk+E,EACVx4C,MAAOv7C,EACPgpB,SAAUhpB,EAASA,EAAOgpB,SAAW,OACtClsB,KAAK,SAAUtK,GACI,UAAdA,EAAKoM,MAEMlK,EAAK2gC,mBACX2jC,qBAAqB7L,iBAAiB36D,EAAK6Y,SAChD+M,EAAM6uC,OAAOz0D,IAEb4lB,EAAMtT,QAAQtS,KAEnBuS,KAAK,SAAUivF,EAAOC,EAAYC,GAEtBx/F,EAAK2gC,mBACX2jC,qBAAqB7L,iBAAiB6mC,EAAM3oF,SAEjD+M,EAAM6uC,OAAO+sC,EAAOC,EAAYC,KAG7B97E,EAAMlb,WAMjB4qE,eAAgB,aAMhB67C,cAAe,WACX,IAAIjvH,EAAOC,KACPkQ,EAAW/S,EAAE4S,WAyKjB,OAvKA5S,EAAEsJ,OAAO1G,EAAK4sB,SAAWwyB,YAAep/C,EAAK6iD,eAAezD,cAE5DhiD,EAAEqM,KAAKzJ,EAAK+lH,SAAS55G,KAAKnM,EAAMA,EAAK4sB,UAAU1c,KAAK,SAAUpS,GA0H1D,OAzHIkC,EAAK4sB,QAAQq3B,cACbnmD,EAAK2nD,KAAK9yC,WAAWmyC,YAAc9kD,EAAK4sB,QAAQq3B,cAGtB,IAA1BjkD,EAAK4sB,QAAQo4B,WACblnD,EAAK2nD,KAAK9yC,WAAWqyC,UAAW,GAIhChlD,EAAK4sB,QAAQpV,eAAe,gBAAkBxX,EAAK4sB,QAAQsyD,eACtDphF,EAAK2nD,KAAKof,UAAa/mE,EAAK2nD,KAAKof,UAA0C,IAA9B/mE,EAAK2nD,KAAKof,SAAS1/D,UACjEnF,EAAK4sB,QAAQs5F,gBAAiB,GAQtClmH,EAAKylD,KAAOzlD,EAAK+iE,cAAcjoB,cAC3B5wC,KAAM,OACNpM,KAAMA,EAAK2nD,KACX8c,WAAYviE,EAAK6gC,YAAY0hC,WAC7B6sD,eAAgBpvH,EAAK8hB,YAGzB9hB,EAAKylD,KAAKn6C,OAAStL,EAAK2gC,mBAAmBE,YAE3C7gC,EAAKylD,KAAKvmD,SACN9B,EAAEsJ,OACE1G,EAAKylD,KAAKvmD,QAAQ,QAEdm3E,QAAWvpE,OAAOC,aAAaC,YAAY,+BAC3C1N,SAAY,aAAc,WAC1B6mD,YAAc,EACd/jD,SAAW,EACXk0E,QAAW,EACXjrE,OAAU,OACVqrE,MAAQ,EACRrkE,MAAS,GAETnG,SAAU,WAEN,OAAOlM,EAAKqvH,aAAavrG,KAAK,WAC1B9jB,EAAK8hB,UAAUlU,YAChByC,KAAK,SAASurB,GACTA,GAASA,EAAM0zF,YAAkC,GAApB1zF,EAAM0zF,WAEnClyH,EAAEqM,KAAKzJ,EAAK6zE,WAAWj4C,EAAM99B,OAAOgmB,KAAK,WACrC9jB,EAAK8hB,UAAUlU,YAEZguB,GAAuB,sBAAdA,EAAM1xB,KACtBlK,EAAKylD,KAAK82B,qBAAqB3gD,EAAMogD,UAC/BpgD,GAASA,EAAMO,cACrBrvB,OAAOwtE,eAAe1+C,EAAMO,cAAgB,QAAS,cAKzE/+B,EAAEsJ,OACE1G,EAAKylD,KAAKvmD,QAAQ,QAEdm3E,QAAWvpE,OAAOC,aAAaC,YAAY,gCAC3C1N,SAAY,aAAc,WAC1B6mD,YAAc,EACd/jD,SAAW,EACXk0E,QAAW,EACXjrE,OAAU,OACVqrE,MAAQ,EACRrkE,MAAS,GAETnG,SAAU,WACNlM,EAAK8hB,UAAUlU,UACfuC,EAASoiD,aAKzBn1D,EAAEsJ,OAAO1G,EAAKylD,MACVoyB,eAAgB,WAEZz6E,EAAE0D,KAAKd,EAAKylD,KAAKvmD,QAAS,SAAUkC,EAAOlB,GACvC,OAAQA,EAAiB,SACrB,KAAK,EACD9C,EAAE4C,EAAKylD,KAAK4yB,aAAaj3E,IAAQsoB,MAAM,WACnC1pB,EAAK8hB,UAAUlU,UACfuC,EAASoiD,WAGbvyD,EAAKylD,KAAK4yB,aAAaj3E,GAAO2uB,UAAYjjB,OAAOC,aAAaC,YAAY,gCAE1EhN,EAAKylD,KAAKvmD,QAAQkC,GAAOi1E,QAAUvpE,OAAOC,aAAaC,YAAY,gCACnEhN,EAAKylD,KAAKvmD,QAAQkC,GAAOiK,OAAS,OAClC,MAEJ,QACIjO,EAAE4C,EAAKylD,KAAK4yB,aAAaj3E,IAAQsoB,MAAM,WAKnC,OAJI1pB,EAAK4sB,QAAQs5F,gBACb9oH,EAAE4C,EAAKylD,KAAK4yB,aAAaj3E,IAAQgE,OAG9BpF,EAAKqvH,aAAavrG,KAAK,WAC1B9jB,EAAK8hB,UAAUlU,YAChByC,KAAK,SAASurB,GACTA,GAASA,EAAM0zF,YAAkC,GAApB1zF,EAAM0zF,WAEnClyH,EAAEqM,KAAKzJ,EAAK6zE,WAAWj4C,EAAM99B,OAAOgmB,KAAK,WACrC9jB,EAAK8hB,UAAUlU,YAInBd,OAAOwtE,eAAe1+C,EAAMO,cAAgB,QAAS,mBAU9En8B,EAAKylD,KAAKhH,UAElB,SAAU9nC,GAET,IAAIqyF,EAAgBhpG,EAAK+iE,cAAckmC,kBAAkB,cACzD7rG,EAAEm2E,WAAWy1B,GAAiBryF,QAASA,IAAWxS,SAASnE,EAAKwzE,cAEhErjE,EAASoiD,WACVnqD,KAAK,SAAUlI,GAGdF,EAAKwzE,aAAahwE,KAAKtD,GAClBF,EAAK2uH,gBACN3uH,EAAK6gC,YAAY0hC,WAAWh3B,SAASvrC,EAAK8hB,UAAUvkB,IAGxDyC,EAAK8hB,UAAU2gD,qBAAqBziE,EAAKylD,MAGzCzlD,EAAKylD,KAAKsU,eAAe,iBAGzB/5D,EAAKylD,KAAKxgD,KAAK,UAAW,WAEtBjF,EAAKwzE,aAAatxE,QAClBlC,EAAK2uH,gBAAiB,EAGtBvxH,EAAEqM,KAAKzJ,EAAKivH,iBAAiB7mH,KAAK,cAC7BiI,KAAK,WACFrQ,EAAKshF,4BAKjBthF,EAAK8hB,UAAU5hB,QAAQ+E,KAAK,QAAS,WACjCjF,EAAKkvH,mBAGV9mD,OAAO,WACNt7D,OAAOY,KAAKI,WAAWC,gBAGpBoC,EAAS3H,WAGpB+mH,sBAAuB,WACnB,IACI3gH,EADO3O,KACQq0E,iBADRr0E,KAEW0S,WAEP4yG,WACX32G,EAAQrL,KAAK,gBAAgB6B,QAIrCiuE,oBAAqB,aAKrB67C,aAAc,WACV,IAAIlvH,EAAOC,KAEX7C,EAAEqM,KAAKzJ,EAAKshF,yBAAyBl5E,KAAK,WAElCpI,EAAK2S,WAAWk8G,cAChB7uH,EAAKshF,2BAOjB+tC,WAAY,WACR,IAAIrvH,EAAOC,KACPkQ,EAAW/S,EAAE4S,WACb2C,EAAa3S,EAAK2S,WAEtB,GAAI3S,EAAKylD,KAAKm0B,eAAgB,CAC1B,IAAI97E,KACJkC,EAAKylD,KAAKyhB,oBAAoBppE,GAE9BA,EAAKumD,YAAcrkD,EAAKylD,KAAK8d,eAE7BnmE,EAAEqM,KAAKzJ,EAAKmhF,kBAAkBrjF,IAAOsK,KAAK,SAAUJ,GAChD,IACI,IAAI8xF,GAAwB,EACxB9xF,GAAyB,sBAAfA,EAAOkC,OACjB4vF,GAAwB,EACxB3pF,EAASoiD,OAAOvqD,IAEhB2K,EAAW68G,YACXxvH,EAAKyvH,gBAAgBrnH,KAAK,WAClB0xF,EACA95F,EAAK0vH,6BAA6B5rG,KAAK,WACnC9jB,EAAK+hE,mBAAmBj+C,KAAK,WACzB3T,EAASC,QAAQpI,GACb2K,EAAWk8G,cACX7uH,EAAK0vH,iCAKjBv/G,EAASoiD,WAEdliD,KAAK,WACJF,EAASoiD,WAENunC,EACP95F,EAAK0vH,6BAA6B5rG,KAAM,WAChCnR,EAAWk8G,aACX7uH,EAAK0vH,6BAA6BtnH,KAAM,WACpCpI,EAAK+hE,mBAAmBj+C,KAAK,WACzB3T,EAASC,QAAQpI,OAIzBhI,EAAK+hE,mBAAmBj+C,KAAK,WACzB3T,EAASC,QAAQpI,OAK7BmI,EAASoiD,SAEf,MAAOwjD,GACL5lG,EAASoiD,YAEdliD,KAAM,SAASurB,GACd,IAAIy3D,EAAMz2E,KAAKhE,MAAMgjB,EAAMO,cAAgB,0BAC3B,iBAAZk3D,EAAItqD,OAAuE,IAA5CsqD,EAAI18E,QAAQxM,QAAQ,qBACN,IAA1CkpF,EAAI18E,QAAQxM,QAAQ,iBACvBgG,EAASoiD,QAAQ+8D,WAAY,EAAGxxH,KAAMA,IAEtCqS,EAASoiD,OAAO32B,UAIxBzrB,EAASoiD,SAGb,OAAOpiD,EAAS3H,WAMpB24E,kBAAmB,SAAUrjF,GACzB,IACI6U,EADO1S,KACW0S,WAGtB,IAA4B,IAAxBA,EAAWqyC,WAAuBryC,EAAW9O,MAC7C,OAAO,KAGX,IAAIid,EARO7gB,KAQM45F,mBAGjB,OAXW55F,KAWC+iE,YAAYpY,gBACpBjnC,IAAKhR,EAAWyuE,QAChBt9B,SAAUnxC,EAAWpV,GACrBwmD,kBAA0C57C,IAA5BwK,EAAWoxC,cAA0D,KAA5BpxC,EAAWoxC,aAAsBjjC,EAASA,EAAQnO,EAAWoxC,aAAe,IAAMjjC,EAAQnO,EAAWoxC,aAC5JoC,WAAYroD,KAOpB4xH,2BAA4B,WACxB,IACIhuD,EAAM,IAAItkE,EAAE4S,SAahB,OAdW/P,KAGN85F,sBAAsB3xF,KAAK,WAC5Bs5D,EAAItxD,YACLC,KAAK,SAASurB,GAEG,iBADNhf,KAAKhE,MAAMgjB,EAAMO,cAAgB,0BACnC4M,KACJ24B,EAAItxD,UAEJsxD,EAAInP,WAILmP,EAAIl5D,WAMfumH,yBAA0B,WACtB,IACIrtD,EAAM,IAAItkE,EAAE4S,SAchB,OAfW/P,KAGN+5F,0BAA0B5xF,KAAK,WAChCs5D,EAAItxD,YACLC,KAAK,SAASurB,GACb,IAAIy3D,EAAMz2E,KAAKhE,MAAMgjB,EAAMO,cAAgB,0BAC3B,iBAAZk3D,EAAItqD,OAAuE,IAA5CsqD,EAAI18E,QAAQxM,QAAQ,qBACN,IAA1CkpF,EAAI18E,QAAQxM,QAAQ,iBACvBu3D,EAAItxD,UAEJsxD,EAAInP,WAILmP,EAAIl5D,WAMfinH,cAAe,WACX,IACI98G,EADO1S,KACW0S,WAClB+uD,EAAM,IAAItkE,EAAE4S,SAYhB,OAVI2C,EAAW68G,YACXpyH,EAAEqM,KALKxJ,KAKK+uH,aAAa,aAAa5mH,KAAK,SAAUJ,GACjD05D,EAAItxD,QAAQpI,KACbqI,KAAK,WACJqxD,EAAInP,WAGRmP,EAAItxD,UAGDsxD,EAAIl5D,WAGfomH,wBAAyB,WACrB,IACI7qE,EADO9jD,KACa0S,WAAWoxC,aAC/B4rE,EAFO1vH,KAEmBqjE,kBAC9B,OAAIqsD,GAAsB5rE,EAC2B,IAA7CA,EAAa55C,QAAQwlH,GACd5rE,EAEA4rE,EAAqB,IAAM5rE,EAG/BA,KCrhBnBj3C,OAAO23D,UAAUqvB,YAAYptF,OAAO,mCAEhC+tE,aAAc,WACV,IACI/hE,EADOzS,KACQ0rE,aADR1rE,KAEU6zE,qBAEXxyE,SAAS,sBAJRrB,KAMN2vH,UAAYxyH,EAAE,gCAAiCsV,IAMxD24D,eAAgB,WACZ,IACI/sE,EADO2B,KACS8iE,cAAcvT,YAAY,eAC9C,OAAOpyD,EAAEy8C,UAAUv7C,EAFR2B,KAEuB0S,aAMtCogE,iBAAkB,WACH9yE,KAGNsN,SAHMtN,KAINomE,qBAMTA,kBAAmB,WACf,IAAIrmE,EAAOC,KAEY,cAAnBD,EAAK8jE,WAA6B9jE,EAAK2S,WAAWqyC,WAGhC,MAAdhlD,EAAK6D,OACL7D,EAAK6vH,qBAETzyH,EAAE,8BAA+B4C,EAAK2rE,cAAcj/D,GAAG,QAAS,WAC5D1M,EAAK4vH,UAAU1tH,QAGflC,EAAK6vH,yBAQjB7uD,gBAAiB,SAAUn9D,GACvB,IAAI7D,EAAOC,KACPyhE,EAAM,IAAItkE,EAAE4S,SAEhB,GAAa,MAATnM,GAA2B,KAAVA,EACZ7D,EAAK4vH,YACN5vH,EAAK4vH,UAAY5vH,EAAK2rE,cAE1B3rE,EAAK4vH,UAAUpsH,KAAKK,GAGpB7D,EAAKgyC,SAASnuC,GAAO,GACrB69D,EAAItxD,cACD,CAEH,IAAI0/G,EAAY,SAAU1qF,GACtB,IAEIwqF,EAFWxqF,EAAS2qF,OAAOx7B,SAASxjF,WAEb,IADXq0B,EAAS2qF,OAAOv7B,UAAUzjF,WAG1C/Q,EAAK4vH,UAAUpsH,KAAKosH,GAGpB5vH,EAAKgyC,SAAS49E,GAAW,GACzBluD,EAAItxD,WAIJ4/G,EAAU,SAAUr5G,GACpB,IAAIsnE,EAAatnE,EAEb7J,OAAOY,KAAKk2B,sBAAwB92B,OAAOY,KAAKkS,gBAChDq+D,EAAaj+E,EAAKk0F,gBAAgBv9E,IAGtC+qD,EAAInP,OAAO0rB,IAGXnxE,OAAOY,KAAKk2B,sBAAwB92B,OAAOY,KAAKkS,cAChD/B,UAAUi2E,YAAYE,mBAAmB87B,EAAWE,GAEpDhwH,EAAKg0F,mBAAmB87B,EAAWE,GAK3C,OAAOtuD,EAAIl5D,WAIfqnH,mBAAoB,WAChB,IAAI7vH,EAAOC,KAEXD,EAAKghE,kBAAkBl9C,KAAK,cAAiBzT,KAAK,SAAUsG,GACxD3W,EAAK4vH,UAAUvgH,IAAI,IACnBrP,EAAK4vH,UAAUpsH,KAAK,4BAA8BmT,EAAU,gBChHxE7J,OAAO23D,UAAU6wB,YAAY5uF,OAAO,mCAMhC0kE,cAAe,WACX,IAAIprE,EAAOC,KACP3B,EAAW0B,EAAK+iE,cAAcvT,YAAY,eAC1CkS,EAAM,IAAItkE,EAAE4S,SAyBhB,OAvBAhQ,EAAK2S,WAAWwO,SAAW,UAC3BnhB,EAAK2S,WAAWmxC,SAAW9jD,EAAK2S,WAAWpV,GAG3CH,EAAEqM,KAAKzJ,EAAK+qD,sBAAsB3iD,KAAK,SAAU2sF,GAE7C/0F,EAAKg1F,eAELh1F,EAAK2S,WAAWgiF,QAAU7nF,OAAOY,KAAKuF,aAAa8hF,KAAS,EAE5D,IAAIk7B,EAAajwH,EAAKi1F,gBAElBzxF,EAAOpG,EAAEy8C,UAAUv7C,EAAUlB,EAAEsJ,OAAO1G,EAAK2S,YAAcs9G,WAAYA,KACrEh7B,cAAej1F,EAAKi1F,cACpBC,oBAAqBl1F,EAAKk1F,sBAI9Bl1F,EAAKgyC,SAASp1B,KAAKC,OAAO7c,EAAK2S,WAAWwiF,aAE1CzzB,EAAItxD,QAAQ5M,KAGTk+D,EAAIl5D,WASfysF,cAAe,WACX,IAAIj1F,EAAOC,KACP0S,EAAa3S,EAAK2S,WAClB7U,KAEJkC,EAAKlC,KAAO6U,EAEZ,IAAIu9G,EAAkBv9G,EAAWgiF,QAAUhiF,EAAWkiF,UAAYliF,EAAWiiF,SAU7E,OARAx3F,EAAE0D,KAAKovH,EAAiB,SAAUlvH,EAAKkoC,GACnCprC,EAAK+K,MACDtL,GAAI2rC,EAAK3rC,GACTsG,MAAOqlC,EAAKrlC,MACZyxF,YAAat1F,EAAKk1F,oBAAoBhsD,EAAK3rC,QAI5CO,GAGXi1E,iBAAkB,WACd,IACIrgE,EADOzS,KACQ0rE,aADR1rE,KAINq1F,YAAcl4F,EAAE,6BAA8BsV,GAJxCzS,KAKN8zE,oBAAoBpvE,IAAI,aAAc,UALhC1E,KAMN8zE,oBAAoB3uE,OANdnF,KASNkwH,kBATMlwH,KAWD0S,WAAWqyC,WAXV/kD,KAYFq1F,YAAY/xF,KAAK,kBAAkB6B,OAZjCnF,KAaFq1F,YAAY/xF,KAAK,8BAA8BjC,SAAS,mCAbtDrB,KAgBNmwH,wBAGTA,qBAAsB,WAClB,IACI19G,EADOzS,KACQ0rE,aAGnB,GAFmBvuE,EAAE,+DAAgEsV,GAErEvN,OAAS,EAAE,CACvB,IAAIkrH,EAAgBjzH,EAAEA,EAAE,+DAAgEsV,GAAS,IAC7F49G,EAAmBlzH,EAAEA,EAAE,8DAA+DsV,GAAS,IAN5FzS,KAQF28G,uBAAsB,GAC3ByT,EAAc/uH,SAAS,UACvBgvH,EAAiBzS,UAAU,KAAKv8G,SAAS,UAQjD6uH,gBAAiB,WACb,IAAInwH,EAAOC,KACP3B,EAAW0B,EAAK+iE,cAAcvT,YAAY,eAC1C98C,EAAU1S,EAAK2rE,aAGnB3rE,EAAKs1F,YAAY1hD,SAAS,iBAAkB,SAAU,WAClD,IAAI28E,EAAiBnzH,EAAE6C,MAEnBswH,EAAehmF,KAAK,YAEpBgmF,EAAejvH,SAAS,YACxBtB,EAAKwwH,iBAAiBD,KAGtBA,EAAezqG,YAAY,YAC3B9lB,EAAKywH,kBAAkBF,MAK/BvwH,EAAKs1F,YAAY1hD,SAAS,iCAAkC,QAAS,WACjEx2C,EAAEsV,GAASxQ,QAGXlC,EAAK2S,WAAWgiF,SAAW30F,EAAK2S,WAAWgiF,QAG3C30F,EAAK2S,WAAWq4C,UAAYhrD,EAAK2S,WAAWgiF,QAE5C30F,EAAKgjE,YAAYjY,mBAAmB/qD,EAAK2S,YAEzC,IAAIs9G,EAAajwH,EAAKi1F,gBAGtB73F,EAAEm2E,WAAWj1E,EAAUlB,EAAEsJ,OAAO1G,EAAK2S,YAAcs9G,WAAYA,KAC3Dh7B,cAAej1F,EAAKi1F,cACpBC,oBAAqBl1F,EAAKk1F,sBAC3B/wF,SAASuO,GAEZ1S,EAAK+yE,qBAGT/yE,EAAKs1F,YAAY1hD,SAAS,yDAA0D,QAAS,WACrFx2C,EAAE6C,MAAMoD,GAAG,aACXrD,EAAK48G,wBACLx/G,EAAE6C,MAAMqB,SAAS,UACjBlE,EAAE6C,MAAMqgH,WAAWzC,UAAU,KAAKv8G,SAAS,YAKvDs7G,sBAAuB,SAAS7zG,GAC5B,IACI2J,EADOzS,KACQ0rE,aACf+kD,EAAUtzH,EAAE,+DAAgEsV,GAC5Ei+G,EAAWvzH,EAAE,8DAA+DsV,GAE7E3J,IACC2nH,EAAUA,EAAQ7+F,IAAI,UAAU/L,YAAY,UAC5C6qG,EAAWA,EAAS9+F,IAAI,UAAU6rF,QAAQ,KAAK53F,YAAY,SAG/D4qG,EAAQ5qG,YAAY,UACpB6qG,EAASjT,QAAQ,KAAK53F,YAAY,SAGtCulD,eAAgB,WAGZ,OAFWprE,KAECmrE,iBAOhBW,mBAAoB,WAChB,IAAI/rE,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACfrtE,EAAW0B,EAAK+iE,cAAcvT,YAAY,eAC1CygE,EAAajwH,EAAKi1F,gBAGtB73F,EAAEm2E,WAAWj1E,EAAUlB,EAAEsJ,OAAO1G,EAAK2S,YAAcs9G,WAAYA,KAC3Dh7B,cAAej1F,EAAKi1F,cACpBC,oBAAqBl1F,EAAKk1F,sBAC3B/wF,SAASuO,GAGZ1S,EAAKs1F,YAAcl4F,EAAE,6BAA8BsV,GACnD1S,EAAK+zE,oBAAoBpvE,IAAI,aAAc,UAG3C3E,EAAKs1F,YAAY1hD,SAAS,iCAAkC,QAAS,WACjEx2C,EAAEsV,GAASxQ,QAEXlC,EAAK2S,WAAWgiF,SAAW30F,EAAK2S,WAAWgiF,QAE3C30F,EAAK+rE,wBAQbykD,iBAAkB,SAAUtwH,GACxB,IACI0O,EADO3O,KACQ0rE,aAGfilD,EAAWxzH,EAAE8C,EAAQkqC,QAAQ,MAAOx7B,GAAS9Q,KAAK,aAClD+yH,EAAU3wH,EAAQpC,KAAK,MALhBmC,KAQN41F,WAAW+6B,EAAUC,IAQ9BJ,kBAAmB,SAAUvwH,GACzB,IACI0O,EADO3O,KACQ0rE,aAGfilD,EAAWxzH,EAAE8C,EAAQkqC,QAAQ,MAAOx7B,GAAS9Q,KAAK,aAClDgzH,EAAa5wH,EAAQpC,KAAK,MALnBmC,KAQNy1F,cAAck7B,EAAUE,IAKjC9vD,gBAAiB,SAAUn9D,GAEvB5D,KAAK+xC,SAASnuC,GAAO,MChP7BiJ,OAAO23D,UAAUssD,eAAerqH,OAAO,sCACnC+tE,aAAc,WAMV,OAFAr3E,EAAE,kCAHS6C,KAG+B0rE,aAAatuC,UAAUj4B,OAHtDnF,KAKCmE,cAIhB+uE,cAAe,WACX,IAAInzE,EAAOC,KACPyjB,EAAQtmB,EAAE4S,WASd,OAPA5S,EAAEqM,KAAKzJ,EAAKoE,cAAcgE,KAAK,WAC3BhL,EAAEqM,KAAKzJ,EAAK0+F,0BAA0Bt2F,KAAK,WACvCpI,EAAKwzE,aAAexzE,EAAKwuB,MACzB9K,EAAMtT,cAIPsT,EAAMlb,WAGjBq2F,mBAAoB,WAChB,IAAK5+F,KAAKu6B,cACN,OAAO1tB,OAAO23D,UAAUusD,iBAAiB5iH,UAAUywF,mBAAmBxwF,MAAMpO,KAAMqO,YAI1F2wF,mBAAoB,WAChB,IAAKh/F,KAAKu6B,cACN,OAAO1tB,OAAO23D,UAAUusD,iBAAiB5iH,UAAU6wF,mBAAmB5wF,MAAMpO,KAAMqO,YAI1FksB,YAAa,WACT,OAAO,KAOf1tB,OAAO23D,UAAUssD,eAAerqH,OAAO,wCAKnCm4F,mBAAoB,WAChB,IACInsF,EADOzS,KACQ0rE,aACf7pD,EAFO7hB,KAEU6zE,qBAEjBm9C,EAJOhxH,KAGW0S,WACOD,QAAQ9N,QAAQ,UAAW,IAMxD,OAVW3E,KAMNuuB,MAAQpxB,EAAE,qBAAuB6zH,EAAc,sBAAsB9sH,SAASuO,GANxEzS,KAONuuB,MAAMltB,SAAS,2CACpBwgB,EAAUxgB,SAAS,sBARRrB,KAUCuuB,OAMhB64C,YAAa,SAASF,KAGtByG,gBAAiB,WAKb,MAAO,cAJI3tE,KACW0S,WACOD,QAEQ,cAGzCusF,mBAAoB,WAChB,IACIvsF,EADOzS,KACQ0rE,aAEfslD,EAHOhxH,KAEW0S,WACOD,QAG7B,OAFgBtV,EAAE,qBAAuB6zH,EAAc,sBAAsB9sH,SAASuO,MCnF9F5F,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,sCAKnCk6F,eAAgB,SAAUrxB,GAElBA,GAAaA,EAAU5D,aACvB1rE,KAAKixH,mBAAqB3hD,EAAU5D,WACpC4D,EAAU5D,WAAa1rE,KAAK0rE,WAC5B4D,EAAU58D,WAAWg3D,YAAc,WAQ3CgC,WAAY,WACR,IACI3jE,EAAS/H,KAAKsN,SAElB,IAAKvF,GAA4B,IAAlBA,EAAO7C,OAAc,CAChC,IAAIsO,EAAW3G,OAAOY,KAAKq1B,sBAAwB,4BAA8B,2BACjF/6B,EAAS5K,EAAEqW,EALJxT,KAKmBC,SALnBD,KAKmCijE,mBAG9C,OAAOl7D,GAKXmpH,kBAAmB,SAAUjxH,GACzB,IACIyS,EADO1S,KACW0S,YAEtBzS,EAAU9C,EAAE8C,IAGJyE,IAAI,mBAAoBgO,EAAWi+D,OAGvCj+D,EAAW6rD,WAAWn5B,aACtBnlC,EAAQyE,IAAI,mBAAoBgO,EAAW6rD,WAAWn5B,YACtDnlC,EAAQyE,IAAI,mBAAoB,UAMxConE,mBAAoB,SAAUloB,EAAc9kD,GACxC,IAQQqyH,EAPJz+G,EADO1S,KACW0S,YAGtB1S,KAAKsN,OAAOs2C,EAAc9kD,GAGtBA,GAAQA,EAAKoG,OAAS,KAGlB2H,OAAOY,KAAKq1B,uBACZquF,EAAWh0H,EAAE,cAAe2B,GACxB3B,EAZD6C,KAYQC,SAASgyC,SAAS,2BACzB90C,EAbD6C,KAaQC,SAAS00E,YAAY,0BAG3BjiE,EAAWqyC,WACZosE,EAAStrG,YAAY,cACrBsrG,EAAStrG,YAAY,qDAGzBsrG,EAAWh0H,EAAE,uBAAwB2B,GACb,QAApB4T,EAAWi+D,OACXwgD,EAAS9vH,SAAS,6BAGjBqR,EAAWqyC,UACZosE,EAASl0G,UA3BVjd,KAgCFkxH,kBAAkBpyH,OCnFnC+N,OAAO23D,UAAUjnE,QAAQ2pF,MAAMzgF,OAAO,qCAElCk6F,eAAgB,SAAUrxB,GAEXtvE,KACNsN,OAAOgiE,GACRA,GAAaA,EAAU5D,aAFhB1rE,KAGFixH,mBAAqB3hD,EAAU5D,WACpC4D,EAAU5D,WAJH1rE,KAIqB0rE,WAC5B4D,EAAU58D,WAAWg3D,YAAc,WAQ3CgC,WAAY,WACR,IACI3jE,EADO/H,KACOsN,SAMlB,OAJKvF,GAA2B,GAAjBA,EAAO7C,SAClB6C,EAAS5K,EAAE,2BAJJ6C,KAIqCC,SAJrCD,KAIqDijE,oBAGzDl7D,KCzBf8E,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,wCAKnCk6F,eAAgB,SAASrxB,GACrB,IACIzvE,EADOG,KACK6jE,UADL7jE,KAENsN,OAAOgiE,GAEZA,EAAU6yB,eAJCniG,KAIqBmiG,eAEpB,UAARtiG,IANOG,KAOF4jD,aAAe0rB,EAAU1rB,aAC9B0rB,EAAUkqB,SAAWx5F,KAAKw5F,SAC1BlqB,EAAUmzB,iBAAmBziG,KAAKyiG,iBAClCnzB,EAAUmqB,gBAAkBz5F,KAAKy5F,gBACjCnqB,EAAUg0B,yBAA2BtjG,KAAKsjG,yBAC1Ch0B,EAAU58D,WAAWoxC,aAZd9jD,KAYkCy5F,oBAOjD6J,yBAA0B,WACtB,IAAIvjG,EAAOC,KACP0S,EAAa3S,EAAK2S,WACtB3S,EAAKyB,eAELkR,EAAWi7C,aAAe5tD,EAAK05F,kBAC/B/mF,EAAWmO,MAAQ9gB,EAAK0iG,iBAAiB/vF,EAAWmO,OAEpD,IAAIviB,EAAOyB,EAAKq9B,OAEhBjgC,EAAEqM,KAAKlL,EAAKwjE,eAAe,IAAI,IAC1B35D,KAAK,WACFhL,EAAEqM,KAAKzJ,EAAKgjE,YAAYvV,yBAAyB96C,IAC5CvK,KAAK,SAASm9C,GACXnoD,EAAEqM,KAAKlL,EAAK6D,WACPgG,KAAK,WACFpI,EAAK6jG,sBAGb7jG,EAAKgC,eACNqO,KAAK,WACJrQ,EAAKy4D,mBACLz4D,EAAKgC,iBAEdqO,KAAK,SAASsG,GAEb3W,EAAK2gC,mBAAmB67C,gBAAgB7lE,GACxC3W,EAAKgC,gBAOjBogG,eAAgB,SAAS9jG,EAAUwB,EAAMiiG,EAAsBC,EAAervF,EAAYikF,GAItF,IAHA,IACIy6B,GAAc,EAETtwH,EAAI,EAAGA,EAHLd,KAGco9B,OAAO1qB,WAAW7U,KAAKwE,KAAK6C,OAAQpE,IACzD,GAJOd,KAIEo9B,OAAO1qB,WAAW7U,KAAKwE,KAAKvB,GAAG,IAJjCd,KAI4C4jD,aAAc,CAC7DwtE,GAAc,EACd,MAgBR,OAZWj0H,EAAEy8C,UAAUv7C,GACnBikG,iBAAkB8uB,EAClBrsE,SAAkB,aAARllD,EACViiG,qBAAsBA,EACtBhjC,SAAUpsD,EAAWosD,SACrByjC,cAAeR,EACflhF,MAhBO7gB,KAgBKw5F,SAAS9mF,EAAWmO,OAChCjf,SAAQ8Q,EAAW9Q,QAAS8Q,EAAW9Q,OACvCw0E,QAAS1jE,EAAW0jE,QACpBugB,QAASA,IAGDhyF,QAAQ,wCAAyC,iDAMjE60F,SAAU,SAAS34E,GACf,IAAIwwG,EAAYxwG,EACZ1f,EAAQkwH,EAAUnnH,QAAQlK,KAAK1B,KAAKoU,WAAWmO,OAMnD,OAJc,GAAV1f,IACAkwH,EAAYA,EAAUz4G,OAAOzX,EAAQnB,KAAK1B,KAAKoU,WAAWmO,MAAM3b,OAAS,IAGtElF,KAAK1B,KAAKoU,WAAWmO,MAAQ,OAAS7gB,KAAK4jD,aAAe,KAAOytE,GAM5E5uB,iBAAkB,SAAS5hF,GACvB,IAAIwwG,EAAYxwG,EACZ1f,EAAQkwH,EAAUnnH,QAAQlK,KAAK1B,KAAKoU,WAAWmO,OAMnD,OAJc,GAAV1f,IACAkwH,EAAYA,EAAUz4G,OAAOzX,EAAQnB,KAAK1B,KAAKoU,WAAWmO,MAAM3b,OAAS,IAGtEmsH,GAMXvlD,mBAAoB,SAASloB,EAAc9kD,EAAM8iG,GAE7C5hG,KAAKsN,OAAOs2C,EAAc9kD,EAAM8iG,IAMpCnI,gBAAiB,WACb,OAAOz5F,KAAK1B,KAAKoU,WAAWmO,MAAQ,OAAS7gB,KAAK4jD,aAAe,OC7HzE/2C,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,oCACnCk6F,eAAgB,SAASrxB,GACrB,IAAIvvE,EAAOC,KACPH,EAAOE,EAAK8jE,UAEhB9jE,EAAKuN,OAAOgiE,GAGRA,IACAA,EAAU92C,UAAW,EAER,cAAT34B,IACAyvE,EAAUpO,eAAiB,SAASt9D,GAEhC,IAAI8O,EAAa1S,KAAK0S,WAClBy4E,EAAcnrF,KAAKorF,iBACnBkmC,EAAiBvxH,EAAKwxH,aAAavxH,KAAM4D,GAGzCA,GAAS8O,EAAWqyC,WACY,iBAArB,GACPusE,EAAiB,IAAIr+G,KAAKq+G,GAC1BnmC,EAAYslB,WAAW,UAAYzlG,IAAKsmH,IACxCA,EAAiBzkH,OAAOY,KAAKgmB,cAAckF,gBAAgB24F,EAAgB5+G,EAAW8lB,WAEtF2yD,EAAYqmC,WAAW,SAAU,UAAW3kH,OAAOY,KAAKgmB,cAAc8E,qBAAqB+4F,IAG/F5+G,EAAWs2E,SAAWplF,EACtB0rE,EAAU58D,WAAWs2E,SAAWsoC,IAIxChiD,EAAUjO,eAAiB,SAASz9D,GAEhC,IAAI8O,EAAa1S,KAAK0S,WAClBy4E,EAAcnrF,KAAKorF,iBACnBkmC,EAAiBvxH,EAAKwxH,aAAavxH,KAAM4D,GAGzCA,GAAS8O,EAAWqyC,WAEY,iBAArB,GACPusE,EAAiB,IAAIr+G,KAAKq+G,GAC1BnmC,EAAYslB,WAAW,UAAY1lG,IAAKumH,IACxCA,EAAiBzkH,OAAOY,KAAKgmB,cAAckF,gBAAgB24F,EAAgB5+G,EAAW8lB,WAEtF2yD,EAAYqmC,WAAW,SAAU,UAAW3kH,OAAOY,KAAKgmB,cAAc8E,qBAAqB+4F,IAG/F5+G,EAAWw2E,SAAWtlF,EACtB0rE,EAAU58D,WAAWw2E,SAAWooC,OAOpDC,aAAc,SAAS5iH,EAAS/K,GAC5B,IAAImE,EAAS,GAMb,IAJI8E,OAAOY,KAAKmS,SAAShc,IAAUiJ,OAAOY,KAAK0S,UAAUvc,MACrDmE,EAASnE,GAGTiJ,OAAOY,KAAKsS,QAAQnc,GAAQ,CAC5B,IAAI27D,EAAU5wD,EAAQrQ,KAAKkhE,aACvB5b,EAAej1C,EAAQi1C,aACvBziD,EAAQo+D,EAAQr1D,QAAQ05C,IACb,IAAXziD,IACA4G,EAASnE,EAAMzC,IAIvB,OAAO4G,KC1Ef8E,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,oCACnCk6F,eAAgB,SAAUrxB,GACtBtvE,KAAKsN,OAAOgiE,MCFpBziE,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,sCAEnCk6F,eAAgB,SAAUrxB,GACtBtvE,KAAKsN,OAAOgiE,MCHpBziE,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,qCAEnCk6F,eAAgB,SAASrxB,GACrB,IAAI58D,EAAa1S,KAAK0S,WACtB1S,KAAKsN,OAAOgiE,GAEZA,EAAUjM,gBAAkBrjE,KAAKyxH,qBAEjCniD,EAAUvO,gBAAkB,WACxB,OAAO,GAKa,cAAnB/gE,KAAK6jE,YACNyL,EAAU58D,WAAWoxC,cAAiBpxC,EAAWoxC,aAAepxC,EAAWoxC,aAAe,IAAM,IAAO9jD,KAAK1B,KAAKoU,WAAWmO,MAAQ,OAASyuD,EAAU1rB,aAAe,MAI9K6tE,qBAAsB,WAClB,OAASzxH,KAAKtB,OAAOgU,WAAWoxC,aAAe9jD,KAAKtB,OAAOgU,WAAWoxC,aAAe,IAAM,IAAO9jD,KAAKtB,OAAOJ,KAAKoU,WAAWmO,MAAQ,OAAS7gB,KAAK4jD,aAAe,OCpB3K/2C,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,sCACnCk6F,eAAgB,SAAUrxB,GACtBtvE,KAAKsN,OAAOgiE,GACZ,IAAIvvE,EAAOC,KACPH,EAAOE,EAAK8jE,UAEJ,UAARhkE,GAA4B,UAARA,IAEpByvE,EAAUikB,eAAiBvzF,KAAKuzF,eAEhCjkB,EAAUjM,gBAAkB,WAExB,IAAIzf,EAAe5jD,KAAK4jD,cAAgB,GACpClxC,EAAa3S,EAAK2S,WAElBg/G,EADc3xH,EAAKwzF,eAAejkB,GACHluE,MAAM,KACrCuwH,EAAWD,EAAiBA,EAAiBxsH,OAAS,GAG1D,OAAS4+C,aAFUpxC,EAAWoxC,aAAa5+C,OAAS,EAAIwN,EAAWoxC,aAAe,IAAM/jD,EAAKzB,KAAKoU,WAAWmO,MAAQ,OAAS+iC,EAAe,IAAM7jD,EAAKzB,KAAKoU,WAAWmO,MAAQ,OAAS+iC,EAAe,IAEnK+tE,SAAUA,IAKnDriD,EAAU0nB,aAAe,SAAU/rE,GAC/B,IACIvY,EADa1S,KACW0S,WAExB8yC,EAHaxlD,KAGK0gC,mBAClB/xB,EAJa3O,KAIQqjE,kBAEzB,OANiBrjE,KAMC+iE,YAAYxa,kBAC1B1E,SAAUnxC,EAAWpV,GACrBujB,MAAOlS,EAAQgjH,SACf7tE,aAAcn1C,EAAQm1C,aACtBM,YAAa1xC,EAAW0xC,YACxBoE,OAAQv9B,EAAK3tB,GACbupD,UAAWrB,EAAK9yC,WAAWm0C,UAC3BT,YAAa1zC,EAAW0zC,iBAUxCmtC,eAAgB,SAAUjkB,GACtB,OAAQA,GAAatvE,MAAM1B,KAAKoU,WAAWmO,MAAQ,QAAUyuD,GAAatvE,MAAM4jD,aAAe,MAAQ0rB,GAAatvE,MAAM0S,WAAWmO,SCjD7IhU,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,oCACnCk6F,eAAgB,SAAUrxB,GACtBtvE,KAAKsN,OAAOgiE,GAEZ,IACIzvE,EADOG,KACK6jE,UAEJ,UAARhkE,GAA4B,UAARA,IAHbG,KAIF4jD,aAAe0rB,EAAU1rB,aAC9B0rB,EAAUkqB,SAAWx5F,KAAKw5F,SAE1BlqB,EAAU58D,WAAWoxC,aAPd9jD,KAOkC1B,KAAKoU,WAAWmO,MAAQ,OAP1D7gB,KAOwE4jD,aAAe,IAPvF5jD,KASE1B,KAAKoU,WAAWoxC,eAAiG,GAAjFwrB,EAAU58D,WAAWoxC,aAAa55C,QATpElK,KASiF1B,KAAKoU,WAAWoxC,gBACpGwrB,EAAU58D,WAAWoxC,aAVlB9jD,KAUsC1B,KAAKoU,WAAWoxC,aAAe,IAAMwrB,EAAU58D,WAAWoxC,eAG1E,kBAA7BwrB,EAAU58D,WAAWzI,OACrBqlE,EAAUsqB,iBAAmB55F,KAAK45F,mBAO1CJ,SAAU,SAAU34E,GAChB,IAAIwwG,EAAYxwG,EACZ1f,EAAQkwH,EAAUnnH,QAAQlK,KAAK1B,KAAKoU,WAAWmO,OAMnD,OAJc,GAAV1f,IACAkwH,EAAYA,EAAUz4G,OAAOzX,EAAQnB,KAAK1B,KAAKoU,WAAWmO,MAAM3b,OAAS,IAGtElF,KAAK1B,KAAKoU,WAAWmO,MAAQ,OAAS7gB,KAAK4jD,aAAe,KAAOytE,GAM5Ez3B,iBAAkB,WAKd,GAHA55F,KAAK0S,WAAWgnF,UAAmE,MAAvD7sF,OAAOY,KAAKuF,aAAahT,KAAK0S,WAAWgnF,YAAqB7sF,OAAOY,KAAKuF,aAAahT,KAAK0S,WAAWgnF,WACnI15F,KAAKypE,mCAEAzpE,KAAK0S,WAAWmO,MAGrB,OAAO7gB,KAAK0S,WAAWmO,SC/C/BhU,OAAO23D,UAAUjnE,QAAQuzC,OAAOrqC,OAAO,sCAEnCk6F,eAAgB,SAAUrxB,GACtBtvE,KAAKsN,OAAOgiE,IAGhB9wB,OAAQ,SAAUoF,EAAchgD,GAE5B,OAAIA,EAAMsB,OAAS,GACftB,KAAWsU,OAAOtU,EAAM,IAFjB5D,KAGKsN,OAAOs2C,GACftmD,GAAIsG,EAAM,GACV5C,MAAO4C,EAAM,GACb6kH,gBAAiB7kH,EAAM,SAAMsE,KAN1BlI,KAUKsN,OAAOs2C,EAAchgD,MCjB7CiJ,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,yCAInCk6F,eAAgB,SAAUrxB,GACtBtvE,KAAKsN,OAAOgiE,GAEZA,EAAUjM,gBAAkBrjE,KAAK4xH,mBAEjCtiD,EAAUikB,eAAiBvzF,KAAKuzF,eAEhCjkB,EAAU0nB,aAAe,SAAU/rE,GAC/B,IACIvY,EADO1S,KACW0S,WAElB8yC,EAHOxlD,KAGK0gC,mBAEZwuD,EALOlvF,KAKYuzF,eALZvzF,KAKgC4jD,cAEvC+tE,GADJziC,EAAcA,EAAY9tF,MAAM,MACL8tF,EAAYhqF,OAAS,GAC5C4+C,EARO9jD,KAQaqjE,gBARbrjE,KAQkC4jD,cAE7C,OAVW5jD,KAUC+iE,YAAYxa,kBACpB1E,SAAUnxC,EAAWpV,GACrBujB,MAAO8wG,EACP7tE,aAAcA,EACdM,YAAa1xC,EAAW0xC,YACxBoE,OAAQv9B,EAAKk+B,aACbtC,UAAWrB,EAAK9yC,WAAWm0C,UAC3BT,YAAa1zC,EAAW0zC,eAIhCkpB,EAAU8nB,eAAiB,WACvB,IAAI1kF,EAAa1S,KAAK0S,WAClB8yC,EAAOxlD,KAAK0gC,mBAEhB,OACIhd,IAAKhR,EAAWmuE,OAChBgxC,QAASn/G,EAAWmO,MACpBwoC,SAAU32C,EAAW22C,SACrBvF,aAAc9jD,KAAKqjE,gBAAgBrjE,KAAK4jD,cACxCwF,MAAO12C,EAAWmO,MAClBupC,YAAa5E,EAAK9yC,WAAWm0C,UAC7BgrC,cAAe,SACfpkC,cAAe/6C,EAAW0xC,eAWtCmvC,eAAgB,SAAU3vC,GAEtB,OADAA,EAAe5jD,KAAK4jD,cAAgBA,GAAgB,GAC7C5jD,KAAK1B,KAAKoU,WAAWmO,MAAQ,OAAS+iC,EAAe,KAAO5jD,KAAK0S,WAAWmO,OAIvF+wG,mBAAoB,WAChB,OAAS5xH,KAAKtB,OAAOgU,WAAWoxC,aAAe9jD,KAAKtB,OAAOgU,WAAWoxC,aAAe,IAAM,IAAO9jD,KAAKtB,OAAOJ,KAAKoU,WAAWmO,MAAQ,OAAS7gB,KAAK4jD,aAAe,OClE3K/2C,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,sCACnCk6F,eAAgB,SAAUrxB,GACtBtvE,KAAKsN,OAAOgiE,MCApBziE,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,wDAInCtC,WAAY,SAAUy/C,EAAc9kD,GAEhCkB,KAAKsN,OAAOs2C,EAAc9kD,GAG1B,IAAIyvB,EAAQpxB,EAAE,QAAS2B,GACvBkB,KAAKkxH,kBAAkB3iG,IAE3BwyE,cAAe,SAAUhgG,EAAK6C,GAE1B,OADW5D,KACCorE,eAAerqE,EAAK6C,IAEpCX,kBAAmB,SAAUlC,EAAK6C,GAG9B,OAFW5D,KACN8rE,mBAAmB/qE,EAAK6C,IACtB,KClBfiJ,OAAO23D,UAAUjnE,QAAQ2pF,MAAMzgF,OAAO,wCCAtCoG,OAAO23D,UAAUjnE,QAAQ2pF,MAAMzgF,OAAO,uCCAtCoG,OAAO23D,UAAUjnE,QAAQmB,OAAO+H,OAAO,8CAMnC+3C,OAAQ,SAAUoF,EAAchgD,GAE5B,IAAI7D,EAAOC,KAEXD,EAAK+8D,SAAU,EACf,IAAIpqD,EAAa3S,EAAK2S,WAElB48D,EAAYvvE,EAAKwvE,aAAa3rB,GAClC0rB,EAAUhxE,KAAOyB,EAAKzB,KACtBgxE,EAAU5wE,OAASsB,KACnBsvE,EAAU1rB,aAAeA,EAId7jD,EAAK8jE,UAEhB,GAAI9jE,EAAKzB,KAAKguF,iBAAiBvsF,EAAK2S,WAAWmO,OACvC9gB,EAAKzB,KAAKguF,iBAAiBvsF,EAAK2S,WAAWmO,OAAO9f,MAAQ6iD,EAC1D7jD,EAAKgyC,SAAS6R,EAAc7jD,EAAKzB,KAAKguF,iBAAiBvsF,EAAK2S,WAAWmO,OAAOjd,OAG9E7D,EAAKgyC,SAAS6R,GAAc,OAG/B,CACmB7jD,EAAKzB,KAAK+tF,cAActsF,EAAK2S,WAAWmO,OAC5D9gB,EAAKgyC,SAAS6R,EAAchgD,GAOhC,GAHA7D,EAAK+gG,kCAAkCl9C,IAGlClxC,EAAWqyC,SACZ,OAAOhlD,EAAKqrE,eAAeh9D,MAAMrO,EAAMsO,WAG3CtO,EAAKyvE,cAAgB,IAAIryE,EAAE4S,SAC3B,IAAIjR,EAAOwwE,EAAU9wB,OAAO,QAsB5B,OAnBA8wB,EAAUtqE,KAAK,eAAgB,WAG3B,GAFAjF,EAAK+8D,SAAU,GACD/8D,EAAKzB,KAAKguF,iBAAiBvsF,EAAK2S,WAAWmO,OAAS9gB,EAAKzB,KAAKguF,iBAAiBvsF,EAAK2S,WAAWmO,OAAO9f,KAAO,KAC3G6iD,EAAc,CAC1B,IAAIkuE,EAAmB/xH,EAAK2S,WAAWmO,MAAMzf,MAAM,KACnDrB,EAAKzB,KAAKguF,iBAAiBvsF,EAAK2S,WAAWmO,QACvCA,MAAO9gB,EAAK2S,WAAWmO,MACvBkxG,YAAaD,EAAiBA,EAAiB5sH,OAAS,GACxDtB,MAAO7D,EAAK4S,SAASixC,GACrB7iD,IAAK6iD,GAET7jD,EAAKiyH,eAAepuE,EAAchgD,MAI1C7D,EAAKiF,KAAK,WAAY,WAClBjF,EAAKyvE,cAAcr/D,YAGhBrR,GAMXqF,WAAY,SAAUy/C,EAAc9kD,GAGhCkB,KAAKsN,OAAOs2C,EAAc9kD,IAyB9BkzH,eAAgB,SAAUpuE,EAAchgD,GAEpC,IADA,IACStB,EAAI,EAAG2vH,EADLjyH,KACuB1B,KAAKoU,WAAW7U,KAAKwE,KAAK6C,OAAQ5C,EAAI2vH,EAAY3vH,IAAK,CACrF,IAAI4vH,EAFGlyH,KAEa1B,KAAKoU,WAAW7U,KAAKwE,KAAKC,GAAG,GACjD,GAAI4vH,IAAatuE,EAHV5jD,KAIkBuvE,aAAa2iD,GACxBnxD,iBAAgB,GALvB/gE,KAME+xC,SAASmgF,GAAU,OC3GxCrlH,OAAO23D,UAAUrzD,SAAS1K,OAAO,gCAI7B0rH,6BAA8B,WAC1B,IAAIpyH,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACnB3rE,EAAK+zE,oBAAoB3uE,OAGzBsN,EAAQpR,SAAS,kCAGjB,IAAI+wH,EAAej1H,EAAE,kCAAmCsV,GAExDtV,EAAE0D,KAAKuxH,EAAc,SAAUjxH,EAAOyC,GAClCzG,EAAE,2BAA4ByG,GAAOvC,SAAS,gCAG9C,IAAIgxH,EAAiBl1H,EAAE,8BAA+ByG,GACtDyuH,EAAe/wH,KAAK,QAASvB,EAAKijE,UAAUj2D,YAAY,oCACxDslH,EAAenxH,UAGf,IAAIoxH,EAAavyH,EAAK8jG,kBAAkB1mG,EAAE,cAAeyG,GAAOL,QAChEpG,EAAE,2BAA4ByG,GAAOvC,SAASixH,GAG9Cn1H,EAAE,oBAAqByG,GAAOpE,SAC9BrC,EAAE,8BAA+ByG,GAAOtC,KAAK,UAAW,WAShEuiG,kBAAmB,SAAU54E,GAEzB,GAAY/iB,MAAR+iB,GAAqC,IAAhBA,EAAK64E,OAC1B,MAAO,2DAKX,OAFgB74E,EAAKrS,OAAQqS,EAAK8/D,YAAY,KAAO,IAGjD,IAAK,OACD,MAAO,kDACX,IAAK,MACD,MAAO,iDACX,IAAK,OACD,MAAO,mDACX,QACI,MAAO,6DAInBjY,iBAAkB,WACd,IACIpgE,EADO1S,KACW0S,WAClBmP,EAFO7hB,KAEU6zE,qBAFV7zE,KAGN+yE,oBAHM/yE,KAINmyH,+BAJMnyH,KAKNomE,oBAEA1zD,EAAWqyC,SAGZljC,EAAUxgB,SAAS,0BAFnBwgB,EAAUxgB,SAAS,uBAS3B+kE,kBAAmB,WACf,IAAIrmE,EAAOC,KACPyS,EAAU1S,EAAK2rE,aACf7rE,EAAOE,EAAK8jE,UAGZu/B,EAAejmG,EAAE,sCAAuCsV,GAChD,aAAR5S,GACAujG,EAAa35E,MAAM,SAAUxb,GACzB,IAAIA,EAAEo1F,uBAAN,CAMA,GAJAp1F,EAAEimC,kBAEFn0C,EAAK2S,WAAWywF,gBAAiB,EAE7BpjG,EAAK2S,WAAWs/B,SAEFjyC,EAAKkjG,qBAEfljG,EAAKujG,gCAITvjG,EAAKujG,2BAGTvjG,EAAK2S,WAAWywF,gBAAiB,KAKzChmG,EAAE,uEAAwEsV,GAASgX,MAAM,SAAUxb,GAC/FlO,EAAKwjG,oBAAoBpmG,EAAE6C,MAAMnC,KAAK,OAAQV,EAAE6C,MAAMsB,KAAK,YAI/DnE,EAAE,8BAA+BsV,GAASgX,MAAM,SAAUxb,GAClDA,EAAEo1F,yBAENp1F,EAAEimC,kBAEFn0C,EAAKyjG,uBAAuBrmG,EAAE6C,MAAMo9B,SAASv/B,KAAK,iBAO1DkmG,gBAAiB,SAAU7B,EAAWvL,EAASmL,GAChC9hG,KAENsN,OAAO40F,EAAWvL,EAASmL,GAFrB9hG,KAINmyH,gCAMTvuB,kBAAmB,aAGnBZ,0BAA2B,aAG3BO,oBAAqB,SAAS7/E,EAAKzlB,GAC/B4O,OAAOk1E,QAAQzoD,QACfn8B,EAAEqM,KAAKqD,OAAOY,KAAK+vF,MAAMh4D,aAAa9hB,EAAKzlB,IAAQmS,KAAK,SAAUurB,GAC1DA,EAAMO,cACNn8B,KAAK2gC,mBAAmBo6C,YAAYn/C,EAAMO,gBAE/CisC,OAAO,WACNt7D,OAAOk1E,QAAQ/jD,YCtJ3BnxB,OAAO23D,UAAU+tD,UAAU9rH,OAAO,iCAK9BqsE,iBAAkB,WACH9yE,KACNg0E,WAAW7uE,OADLnF,KAGNilG,wBCTbp4F,OAAO23D,UAAUguD,WAAW/rH,OAAO,kCAKlCqsE,iBAAkB,WACA9yE,KACNg0E,WAAW7uE,OADLnF,KAENilG,wBCRbp4F,OAAO23D,UAAUiuD,YAAYhsH,OAAO,mCAKnCqsE,iBAAkB,WACN9yE,KACAg0E,WAAW7uE,OADXnF,KAEAilG,wBCPb9nG,EAAEklD,MAAM57C,OAAO,oCAIX+Q,KAAM,SAAUurD,GACZ/iE,KAAK0yH,aACL1yH,KAAK+iE,YAAcA,GAMvB4vD,cAAe,aAKfC,eAAgB,WACZ,OAAOz1H,EAAEqM,KAAK4E,MAAMjR,GAAI6C,KAAK2yH,gBAAiB3yH,KAAK6yH,mBAKvDA,cAAe,aAKfC,aAAc,SAASz0H,EAAU00H,GAC7B,IAAIhzH,EAAOC,KAGX,OAAO6M,OAAOmmH,gBAAgBzjE,YAAYwjE,EAAqB10H,GACtD8J,KAAK,SAAU8qH,GAChBlzH,EAAK2yH,UAAUr0H,GAAY40H,KAMvCjqB,kBAAmB,SAAU3qG,GACzB,OAAO2B,KAAK0yH,UAAUr0H,IAK1Bw8C,aAAc,SAAUxvC,GAGpB,IAAIpB,EAAOoB,EAAOpB,KACdpM,EAAOwN,EAAOxN,KACdkuG,EAAkB5uG,EAAEsJ,OAAO4E,GAC3By3D,cAAe9iE,KACf+iE,YAAa13D,EAAO03D,aAAe/iE,KAAK+iE,cAG5C,MAAY,QAAR94D,EACO,IAAI4C,OAAO23D,UAAUhf,KAAKumD,GAGzB,cAAR9hG,EACO,IAAI4C,OAAO23D,UAAU0uD,WAAWnnB,GAG/B,YAAR9hG,EACO,IAAI4C,OAAO23D,UAAU2uD,aAAapnB,GAGjC,aAAR9hG,EACO,IAAI4C,OAAO23D,UAAUgT,UAAUu0B,GAG9B,UAAR9hG,EACO,IAAI4C,OAAO23D,UAAU9hD,OAAOqpF,GAG3B,aAAR9hG,EACO,IAAI4C,OAAO23D,UAAU4uD,UAAUrnB,GAG9B,SAAR9hG,EACO,IAAI4C,OAAO23D,UAAUwd,MAAM+pB,GAG1B,gBAAR9hG,GAAkC,gBAARA,EACnB,IAAI4C,OAAO23D,UAAUkjC,aAAaqE,GAGnB,cAAtB9hG,EAAKwG,cACE,IAAI5D,OAAO23D,UAAU6uD,WAAWtnB,GAG/B,OAAR9hG,EACO,IAAI4C,OAAO23D,UAAUqY,IAAIkvB,GAGxB,WAAR9hG,GAA6B,WAARA,EACd,IAAI4C,OAAO23D,UAAUsjC,QAAQiE,GAG5B,cAAR9hG,EACO,IAAI4C,OAAO23D,UAAU+tB,WAAWwZ,GAG/B,aAAR9hG,EACO,IAAI4C,OAAO23D,UAAU8uD,UAAUvnB,GAG9B,iBAAR9hG,EACO,IAAI4C,OAAO23D,UAAU+uD,cAAcxnB,GAGlC,SAAR9hG,EACO,IAAI4C,OAAO23D,UAAU2jC,MAAM4D,GAG1B,eAAR9hG,EACO,IAAI4C,OAAO23D,UAAUgvD,YAAYznB,GAGhC,cAAR9hG,GACA8hG,EAAgBp9F,QAAU,SAC1Bo9F,EAAgB3lD,YAAc,WACvB,IAAIv5C,OAAO23D,UAAU6jC,WAAW0D,KAI3Cl/F,OAAO6T,IAAIzW,EAAO,mCAAoCpM,EAAM,SACrD,OAKX22D,UAAW,SAAUnpD,GAGjB,IAAIpB,EAAOoB,EAAOpB,KACdpM,EAAOwN,EAAOxN,KACdwvG,EAAelwG,EAAEsJ,OAAO4E,GACxBy3D,cAAe9iE,KACf+iE,YAAa13D,EAAO03D,aAAe/iE,KAAK+iE,cAM5C,OAHK94D,IACDA,EAAO,SAEC,QAARA,EACiB4C,OAAOY,KAAKuF,aAAanV,EAAK6U,WAAW63D,cAAe,EAI9D,IAAI19D,OAAO23D,UAAUyqC,aAAa5B,GAItC,IAAIxgG,OAAO23D,UAAUryD,KAAKk7F,GAEzB,cAARpjG,EACO,IAAI4C,OAAO23D,UAAUivD,WAAWpmB,GAG/B,eAARpjG,EACO,IAAI4C,OAAO23D,UAAU6wB,YAAYgY,GAGhC,SAARpjG,EACO,IAAI4C,OAAO23D,UAAUxjE,MAAMqsG,GAG1B,UAARpjG,EACO,IAAI4C,OAAO23D,UAAU38D,OAAOwlG,GAG3B,UAARpjG,EACO,IAAI4C,OAAO23D,UAAU37D,OAAOwkG,GAG3B,SAARpjG,EACO,IAAI4C,OAAO23D,UAAUpzB,MAAMi8D,GAG1B,QAARpjG,EACO,IAAI4C,OAAO23D,UAAU1vC,KAAKu4E,GAGzB,WAARpjG,EAGe,UAFDpM,EAAK6U,WAAWugC,SAAW,UAI9B,IAAIpmC,OAAO23D,UAAUquC,MAAMxF,GAI/B,IAAIxgG,OAAO23D,UAAUkuC,MAAMrF,GAG1B,SAARpjG,EACO,IAAI4C,OAAO23D,UAAU0iB,MAAMmmB,GAGlC,oBAAoBn7F,KAAKjI,GAClB,IAAI4C,OAAO23D,UAAUqxC,eAAexI,GAGnC,QAARpjG,EACO,IAAI4C,OAAO23D,UAAU7pC,KAAK0yE,GAGzB,eAARpjG,EACO,IAAI4C,OAAO23D,UAAUivC,YAAYpG,GAGhC,SAARpjG,EACO,IAAI4C,OAAO23D,UAAUkxC,MAAMrI,GAG1B,SAARpjG,EAEO,IAAI4C,OAAO23D,UAAU9iC,MAAM2rE,GAE1B,aAARpjG,EAEO,IAAI4C,OAAO23D,UAAU03C,IAAI7O,GAGxB,UAARpjG,EACO,IAAI4C,OAAO23D,UAAUgyC,OAAOnJ,GAE3B,QAARpjG,EACO,IAAI4C,OAAO23D,UAAUlmE,KAAK+uG,GAGzB,eAARpjG,EACO,IAAI4C,OAAO23D,UAAUlmE,KAAK+uG,GAGzB,UAARpjG,EACO,IAAI4C,OAAO23D,UAAU1zB,OAAOu8D,GAG3B,WAARpjG,GACAojG,EAAaxvG,KAAK6U,WAAWo/E,4BAA6B,EACnD,IAAIjlF,OAAO23D,UAAU1zB,OAAOu8D,IAG3B,cAARpjG,EACO,IAAI4C,OAAO23D,UAAUk7C,WAAWrS,GAG/B,UAARpjG,EACO,IAAI4C,OAAO23D,UAAU8kD,OAAOjc,GAG3B,UAARpjG,EACO,IAAI4C,OAAO23D,UAAUn4D,OAAOghG,GAG3B,YAARpjG,EACO,IAAI4C,OAAO23D,UAAUihD,SAASpY,GAG7B,QAARpjG,EACO,IAAI4C,OAAO23D,UAAUglD,KAAKnc,GAGzB,eAARpjG,EACO,IAAI4C,OAAO23D,UAAUknD,YAAYre,GAGhC,cAARpjG,EACO,IAAI4C,OAAO23D,UAAU6nD,WAAWhf,GAG/B,eAARpjG,EACO,IAAI4C,OAAO23D,UAAUmoD,YAAYtf,GAGhC,cAARpjG,EACO,IAAI4C,OAAO23D,UAAUooD,WAAWvf,GAG/B,kBAARpjG,EACO,IAAI4C,OAAO23D,UAAUqoD,eAAexf,GAGnC,gBAARpjG,EACO,IAAI4C,OAAO23D,UAAUsoD,aAAazf,GAGjC,eAARpjG,EACO,IAAI4C,OAAO23D,UAAUuoD,YAAY1f,GAGhC,qBAARpjG,EACO,IAAI4C,OAAO23D,UAAUkvD,kBAAkBrmB,GAGtC,kBAARpjG,EACO,IAAI4C,OAAO23D,UAAU2nC,eAAekB,GAGnC,iBAARpjG,EACO,IAAI4C,OAAO23D,UAAUmvD,cAActmB,GAGlC,gBAARpjG,EACO,IAAI4C,OAAO23D,UAAUwoD,aAAa3f,GAGjC,kBAARpjG,EACO,IAAI4C,OAAO23D,UAAUovD,eAAevmB,GAGnC,uBAARpjG,EACO,IAAI4C,OAAO23D,UAAU4pC,oBAAoBf,GAGxC,aAARpjG,EACO,IAAI4C,OAAO23D,UAAUqvD,iBAAiBxmB,GAInB,GAA1BpjG,EAAKC,QAAQ,UACNlK,KAAK8zH,gBAAgBzoH,GAGH,GAAzBpB,EAAKC,QAAQ,SACNlK,KAAK+zH,eAAe1oH,GAGnB,YAARpB,EACO,IAAI4C,OAAO23D,UAAUrzD,SAASk8F,GAG7B,SAARpjG,EACO,IAAI4C,OAAO23D,UAAU9iC,MAAM2rE,GAE1B,aAARpjG,EACO,IAAI4C,OAAO23D,UAAU+kD,UAAUlc,GAE9B,eAARpjG,EACO,IAAI4C,OAAO23D,UAAUqvB,YAAYwZ,GAGhC,uBAARpjG,EACO,IAAI4C,OAAO23D,UAAU+xC,oBAAoBlJ,GAGxC,WAARpjG,EACO,IAAI4C,OAAO23D,UAAUwvD,QAAQ3mB,GAG5B,aAARpjG,EACO,IAAI4C,OAAO23D,UAAU+tD,UAAUllB,GAG9B,cAARpjG,EACO,IAAI4C,OAAO23D,UAAUguD,WAAWnlB,GAG/B,eAARpjG,EACO,IAAI4C,OAAO23D,UAAUiuD,YAAYplB,GAGhC,qBAARpjG,EACO,IAAI4C,OAAO23D,UAAUyvD,kBAAkB5mB,IAIlDxgG,OAAO6T,IAAIzW,EAAO,mCAAoCpM,EAAM,SACrD,OAKXg3D,UAAW,SAAUxpD,GACjB,IAAIpB,EAAOoB,EAAOpB,KACdpM,EAAOwN,EAAOxN,KACdq2H,EAAe/2H,EAAEsJ,OAAO4E,GACxBy3D,cAAe9iE,KACf+iE,YAAa13D,EAAO03D,aAAe/iE,KAAK+iE,YACxC6pB,iBAAgB//E,OAAOY,KAAKqT,QAAQzV,EAAOuhF,iBAAyBvhF,EAAOuhF,iBAG/E,GAAY,cAAR3iF,EAAsB,CACtB,IAAIsgE,EAAa19D,OAAOY,KAAKuF,aAAanV,EAAK6U,WAAW63D,cAAe,EASzE,OALI2pD,EAAa5kD,UAFb/E,EAEyB19D,OAAO23D,UAAUyqC,aAGjBpiG,OAAO23D,UAAUryD,KAEvC,IAAItF,OAAO23D,UAAUjnE,QAAQ4U,KAAK+hH,GAG7C,GAAY,oBAARjqH,EAEA,OADAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUk7C,WACnC,IAAI7yG,OAAO23D,UAAUjnE,QAAQmiH,WAAWwU,GAGnD,GAAY,gBAARjqH,EAEA,OADAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU37D,OACnC,IAAIgE,OAAO23D,UAAUjnE,QAAQsL,OAAOqrH,GAG/C,GAAY,eAARjqH,EAEA,OADAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUpzB,MACnC,IAAIvkC,OAAO23D,UAAUjnE,QAAQsL,OAAOqrH,GAG/C,GAAY,cAARjqH,EAEA,OADAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU1vC,KACnC,IAAIjoB,OAAO23D,UAAUjnE,QAAQu3B,KAAKo/F,GAG7C,GAAY,iBAARjqH,EAAyB,CAGzB,GAAe,UAFDpM,EAAK6U,WAAWugC,SAAW,WAKrC,GADAihF,EAAa5kD,UAAYziE,OAAO23D,UAAUquC,MACtCxnG,EAAOxN,KAAK6U,WAAWg6E,YACvB,OAAO,IAAI7/E,OAAO23D,UAAUjnE,QAAQ42H,eAAeD,QAIvDA,EAAa5kD,UAAYziE,OAAO23D,UAAUkuC,MAE9C,OAAO,IAAI7lG,OAAO23D,UAAUjnE,QAAQmB,OAAOw1H,GAG/C,MAAY,eAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU0iB,MACnC,IAAIr6E,OAAO23D,UAAUjnE,QAAQ2pF,MAAMgtC,IAGlC,eAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUkxC,MACnC,IAAI7oG,OAAO23D,UAAUjnE,QAAQm4G,MAAMwe,IAGlC,cAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU7pC,KACnC,IAAI9tB,OAAO23D,UAAUjnE,QAAQo9B,KAAKu5F,IAGjC,gBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU38D,OACnC,IAAIgF,OAAO23D,UAAUjnE,QAAQmB,OAAOw1H,IAGnC,gBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUgyC,OACnC,IAAI3pG,OAAO23D,UAAUjnE,QAAQi5G,OAAO0d,IAGnC,eAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU9iC,MACnC,IAAI70B,OAAO23D,UAAUjnE,QAAQmkC,MAAMwyF,IAGlC,mBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU03C,IACnC,IAAIrvG,OAAO23D,UAAUjnE,QAAQ62H,UAAUF,IAEtC,cAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUglD,KACnC,IAAI38G,OAAO23D,UAAUjnE,QAAQisH,KAAK0K,IAGjC,kBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUihD,SACnC,IAAI54G,OAAO23D,UAAUjnE,QAAQisH,KAAK0K,IAGjC,mBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUqvD,iBACnC,IAAIhnH,OAAO23D,UAAUjnE,QAAQmB,OAAOw1H,IAGnC,gBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU1zB,OACnC,IAAIjkC,OAAO23D,UAAUjnE,QAAQuzC,OAAOojF,IAGnC,eAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUxjE,MACnC,IAAI6L,OAAO23D,UAAUjnE,QAAQmB,OAAOw1H,IAGnC,kBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUxjE,MACnC,IAAI6L,OAAO23D,UAAUjnE,QAAQq2C,SAASsgF,IAGrC,kBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUrzD,SACnC,IAAItE,OAAO23D,UAAUjnE,QAAQ4T,SAAS+iH,IAGrC,gBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAU8kD,OACnC,IAAIz8G,OAAO23D,UAAUjnE,QAAQ+rH,OAAO4K,IAGnC,gBAARjqH,GACAiqH,EAAa5kD,UAAYziE,OAAO23D,UAAUn4D,OACnC,IAAIQ,OAAO23D,UAAUjnE,QAAQ8O,OAAO6nH,KAI/CrnH,OAAO6T,IAAIzW,EAAO,mCAAoCpM,EAAM,SACrD,OAKXi2H,gBAAiB,SAAUzoH,GACvB,IAAIpB,EAAOoB,EAAOpB,KACdpM,EAAOwN,EAAOxN,KACdskF,EAAehlF,EAAEsJ,OAAO4E,GACxBy3D,cAAe9iE,KACf+iE,YAAa13D,EAAO03D,aAAe/iE,KAAK+iE,cAG5C,MAAY,cAAR94D,EACiB4C,OAAOY,KAAKuF,aAAanV,EAAK6U,WAAW63D,cAAe,EAI9D,IAAI19D,OAAO23D,UAAUyqC,aAAa9sB,GAItC,IAAIt1E,OAAO23D,UAAUryD,KAAKgwE,GAGzB,iBAARl4E,EAGe,UAFDpM,EAAK6U,WAAWugC,SAAW,UAI9B,IAAIpmC,OAAO23D,UAAUquC,MAAM1wB,GAI/B,IAAIt1E,OAAO23D,UAAUkuC,MAAMvwB,GAG1B,gBAARl4E,EACgC,IAA5BpM,EAAK6U,WAAW2hB,SAET,IAAIxnB,OAAO23D,UAAU+qC,yBAAyBptB,GAElD,IAAIt1E,OAAO23D,UAAU37D,OAAOs5E,GAG3B,eAARl4E,EACO,IAAI4C,OAAO23D,UAAUpzB,MAAM+wC,GAG1B,cAARl4E,EACO,IAAI4C,OAAO23D,UAAU1vC,KAAKqtD,GAGzB,eAARl4E,EACO,IAAI4C,OAAO23D,UAAU0iB,MAAM/E,GAG1B,iBAARl4E,EACO,IAAI4C,OAAO23D,UAAU1zB,OAAOqxC,GAG3B,eAARl4E,EACO,IAAI4C,OAAO23D,UAAUxjE,MAAMmhF,IAItCt1E,OAAO6T,IAAIzW,EAAO,mCAAoCpM,EAAM,SACrD,OAKXk2H,eAAgB,SAAU1oH,GACtB,IAAIpB,EAAOoB,EAAOpB,KACdpM,EAAOwN,EAAOxN,KACdskF,EAAehlF,EAAEsJ,OAAO4E,GACxBy3D,cAAe9iE,KACf+iE,YAAa13D,EAAO03D,aAAe/iE,KAAK+iE,cAG5C,MAAY,aAAR94D,EACiB4C,OAAOY,KAAKuF,aAAanV,EAAK6U,WAAW63D,cAAe,EAI9D,IAAI19D,OAAO23D,UAAU6vD,kBAAkBlyC,GAI3C,IAAIt1E,OAAO23D,UAAU8vD,UAAUnyC,GAG9B,gBAARl4E,EAGe,UAFDpM,EAAK6U,WAAWugC,SAAW,UAI9B,IAAIpmC,OAAO23D,UAAU+vD,WAAWpyC,GAIpC,IAAIt1E,OAAO23D,UAAUgwD,WAAWryC,GAG/B,eAARl4E,EAEO,IAAI4C,OAAO23D,UAAUiwD,YAAYtyC,GAGhC,cAARl4E,EACO,IAAI4C,OAAO23D,UAAUkwD,WAAWvyC,GAG/B,aAARl4E,EACO,IAAI4C,OAAO23D,UAAUmwD,UAAUxyC,GAG9B,cAARl4E,EACO,IAAI4C,OAAO23D,UAAUowD,WAAWzyC,GAG/B,uBAARl4E,EACO,IAAI4C,OAAO23D,UAAUqwD,oBAAoB1yC,GAGxC,gBAARl4E,EACO,IAAI4C,OAAO23D,UAAUswD,aAAa3yC,GAGjC,cAARl4E,EACO,IAAI4C,OAAO23D,UAAUuwD,WAAW5yC,GAG/B,aAARl4E,EACO,IAAI4C,OAAO23D,UAAUwwD,UAAU7yC,GAG9B,oBAARl4E,EACO,IAAI4C,OAAO23D,UAAUywD,iBAAiB9yC,GAGrC,eAARl4E,EACO,IAAI4C,OAAO23D,UAAU0wD,YAAY/yC,GAGhC,cAARl4E,EACO,IAAI4C,OAAO23D,UAAU2wD,WAAWhzC,GAG/B,cAARl4E,EACO,IAAI4C,OAAO23D,UAAU4wD,WAAWjzC,GAG/B,kBAARl4E,EACO,IAAI4C,OAAO23D,UAAU6wD,eAAelzC,GAGnC,gBAARl4E,EACO,IAAI4C,OAAO23D,UAAU8wD,aAAanzC,GAGjC,mBAARl4E,EACO,IAAI4C,OAAO23D,UAAU+wD,gBAAgBpzC,GAGpC,eAARl4E,EACO,IAAI4C,OAAO23D,UAAU38D,OAAOs6E,IAIvCt1E,OAAO6T,IAAIzW,EAAO,mCAAoCpM,EAAM,SACrD,OAKX0xD,YAAa,SAAUlxD,GAEnB,OADW2B,KACC0yH,UAAUr0H,MCrrB9BwO,OAAO23D,UAAUkvC,KAAK8hB,QAAQ/uH,OAAO,0CAEjC+Q,KAAM,SAASurD,GACA/iE,KAENsN,OAAOy1D,GAERl2D,OAAOwkB,SAASokG,UACZ5oH,OAAO0K,eAAe,SALnBvX,KAMEgzH,gBAAkB,IAAInmH,OAAOooB,MAAMy9F,UAAUj0E,SAAS8D,QAAQ11C,OAAOC,cANvE9M,KAQEgzH,gBAAkB,IAAInmH,OAAO6lH,UAAUj0E,SAAS8D,QAAQ11C,OAAOC,cARjE9M,KAWFgzH,gBAAkB,IAAInmH,OAAOooB,MAAMy9F,UAAUj0E,SAAS8D,QAAQ11C,OAAOC,eAIpFgmH,aAAc,SAASz0H,EAAU00H,GAC7B,IAAIhzH,EAAOC,KAGX,OAAOD,EAAKizH,gBAAgBzjE,YAAYwjE,EAAqB10H,GACxD8J,KAAK,SAAUutH,GACZ31H,EAAK2yH,UAAUr0H,GAAYq3H,KAOvC7C,cAAe,WACb,IAAI9yH,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SAmHlB,OAjHA5S,EAAEqM,KAEAzJ,EAAK+yH,aAAa,QAASjmH,OAAO0iD,YAAY,kCAE9CxvD,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,wCAA0C,0BACvFxvD,EAAK+yH,aAAa,iBAAkBjmH,OAAO0iD,YAAY,wCAA0C,oCACjGxvD,EAAK+yH,aAAa,QAASjmH,OAAO0iD,YAAY,0CAC9CxvD,EAAK+yH,aAAa,MAAOjmH,OAAO0iD,YAAY,wCAC5CxvD,EAAK+yH,aAAa,UAAWjmH,OAAO0iD,YAAY,4CAChDxvD,EAAK+yH,aAAa,aAAcjmH,OAAO0iD,YAAY,+CACnDxvD,EAAK+yH,aAAa,QAASjmH,OAAO0iD,YAAY,0CAC9CxvD,EAAK+yH,aAAa,aAAcjmH,OAAO0iD,YAAY,yCACnDxvD,EAAK+yH,aAAa,aAAcjmH,OAAO0iD,YAAY,+CACnDxvD,EAAK+yH,aAAa,YAAajmH,OAAO0iD,YAAY,8CAClDxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,kDACtDxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,iDAGrDxvD,EAAK+yH,aAAa,SAAUjmH,OAAO0iD,YAAY,2CAC/CxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,kDACtDxvD,EAAK+yH,aAAa,QAASjmH,OAAO0iD,YAAY,yCAA2C,+BACzFxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,yCAA2C,wCACjGxvD,EAAK+yH,aAAa,iBAAkBjmH,OAAO0iD,YAAY,yCAA2C,iCAClGxvD,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,wCAA0C,eACvFxvD,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,yCAC7CxvD,EAAK+yH,aAAa,SAAUjmH,OAAO0iD,YAAY,0CAA4C,gCAC3FxvD,EAAK+yH,aAAa,iBAAkBjmH,OAAO0iD,YAAY,0CAA4C,yCACnGxvD,EAAK+yH,aAAa,2BAA4BjmH,OAAO0iD,YAAY,6DACjExvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,gDAAkD,uCACvGxvD,EAAK+yH,aAAa,uBAAwBjmH,OAAO0iD,YAAY,gDAAkD,gDAC/GxvD,EAAK+yH,aAAa,QAASjmH,OAAO0iD,YAAY,0CAC9CxvD,EAAK+yH,aAAa,QAASjmH,OAAO0iD,YAAY,0CAC9CxvD,EAAK+yH,aAAa,SAAUjmH,OAAO0iD,YAAY,2CAC/CxvD,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,yCAC7CxvD,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,gDAAkD,8BAC/FxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,gDAAkD,gCACxGxvD,EAAK+yH,aAAa,cAAejmH,OAAO0iD,YAAY,gDACpDxvD,EAAK+yH,aAAa,QAASjmH,OAAO0iD,YAAY,0CAC9CxvD,EAAK+yH,aAAa,SAAUjmH,OAAO0iD,YAAY,0CAA4C,gCAC3FxvD,EAAK+yH,aAAa,iBAAkBjmH,OAAO0iD,YAAY,0CAA4C,yCACnGxvD,EAAK+yH,aAAa,aAAcjmH,OAAO0iD,YAAY,8CAAgD,oCACnGxvD,EAAK+yH,aAAa,sBAAuBjmH,OAAO0iD,YAAY,8CAAgD,sCAC5GxvD,EAAK+yH,aAAa,kCAAmCjmH,OAAO0iD,YAAY,8CAAgD,8DACxHxvD,EAAK+yH,aAAa,8BAA+BjmH,OAAO0iD,YAAY,8CAAgD,0DACpHxvD,EAAK+yH,aAAa,SAAUjmH,OAAO0iD,YAAY,0CAA4C,2BAC3FxvD,EAAK+yH,aAAa,aAAcjmH,OAAO0iD,YAAY,0CAA4C,sBAC/FxvD,EAAK+yH,aAAa,cAAejmH,OAAO0iD,YAAY,gDACpDxvD,EAAK+yH,aAAa,MAAOjmH,OAAO0iD,YAAY,uCAAyC,gCACrFxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,uCAAyC,uBAC9FxvD,EAAK+yH,aAAa,YAAajmH,OAAO0iD,YAAY,8CAClDxvD,EAAK+yH,aAAa,QAASjmH,OAAO0iD,YAAY,yCAA2C,2BACzFxvD,EAAK+yH,aAAa,aAAcjmH,OAAO0iD,YAAY,yCAA2C,gCAC9FxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,yCAA2C,gCACjGxvD,EAAK+yH,aAAa,WAAYjmH,OAAO0iD,YAAY,4CAA8C,0BAC/FxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,4CAA8C,+BACpGxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,0CACrDxvD,EAAK+yH,aAAa,WAAYjmH,OAAO0iD,YAAY,6CACjDxvD,EAAK+yH,aAAa,mBAAoBjmH,OAAO0iD,YAAY,+CAAiD,qCAC1GxvD,EAAK+yH,aAAa,uBAAwBjmH,OAAO0iD,YAAY,+CAAiD,iCAC9GxvD,EAAK+yH,aAAa,wBAAyBjmH,OAAO0iD,YAAY,+CAAiD,6BAC/GxvD,EAAK+yH,aAAa,6BAA8BjmH,OAAO0iD,YAAY,+CAAiD,uCACpHxvD,EAAK+yH,aAAa,uBAAwBjmH,OAAO0iD,YAAY,+CAAiD,uCAG9GxvD,EAAK+yH,aAAa,oBAAqBjmH,OAAO0iD,YAAY,+CAG1DxvD,EAAK+yH,aAAa,wBAAyBjmH,OAAO0iD,YAAY,kDAAoD,gCAClHxvD,EAAK+yH,aAAa,mCAAoCjmH,OAAO0iD,YAAY,kDAAoD,2CAC7HxvD,EAAK+yH,aAAa,iCAAkCjmH,OAAO0iD,YAAY,kDAAoD,yCAC3HxvD,EAAK+yH,aAAa,2CAA4CjmH,OAAO0iD,YAAY,kDAAoD,mDAGrIxvD,EAAK+yH,aAAa,6BAA8BjmH,OAAO0iD,YAAY,uDAAyD,qCAC5HxvD,EAAK+yH,aAAa,2CAA4CjmH,OAAO0iD,YAAY,uDAAyD,mDAC1IxvD,EAAK+yH,aAAa,gDAAiDjmH,OAAO0iD,YAAY,uDAAyD,wDAC/IxvD,EAAK+yH,aAAa,gDAAiDjmH,OAAO0iD,YAAY,uDAAyD,wDAC/IxvD,EAAK+yH,aAAa,qCAAsCjmH,OAAO0iD,YAAY,uDAAyD,6CAGpIxvD,EAAK+yH,aAAa,iBAAkBjmH,OAAO0iD,YAAY,mDACvDxvD,EAAK+yH,aAAa,qBAAsBjmH,OAAO0iD,YAAY,kDAAoD,qBAC/GxvD,EAAK+yH,aAAa,sBAAuBjmH,OAAO0iD,YAAY,kDAAoD,sBAChHxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,iDACrDxvD,EAAK+yH,aAAa,iBAAkBjmH,OAAO0iD,YAAY,mDAGvDxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,gDAAkD,kCACvGxvD,EAAK+yH,aAAa,iBAAkBjmH,OAAO0iD,YAAY,gDAAkD,oCACzGxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,iDACrDxvD,EAAK+yH,aAAa,cAAejmH,OAAO0iD,YAAY,gDACpDxvD,EAAK+yH,aAAa,cAAejmH,OAAO0iD,YAAY,gDACpDxvD,EAAK+yH,aAAa,mBAAoBjmH,OAAO0iD,YAAY,oDACzDxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,iDACrDxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,kDACtDxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,kDAGtDxvD,EAAK+yH,aAAa,aAAcjmH,OAAO0iD,YAAY,+CACnDxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,iDAErDxvD,EAAK41H,oBACLxtH,KAAK,WACL,IAAIytH,EAAY71H,EAAKwvD,YAAY,SAGT,IAFFpyD,EAAE,QAAQmG,KAAK,uBAAuB4B,QAGxD/H,EAAE,QAAQyE,OAAOg0H,GAGrBnyG,EAAMtT,YAGDsT,EAAMlb,WAMfoqH,cAAe,WAEX,GAAI9lH,OAAOgpH,qBACP,OAAOhpH,OAAOY,KAAK+V,UACfG,IAAK9W,OAAOipH,cAAc,0CAC1B7rH,KAAM,QAYlBuqD,UAAW,SAAUnpD,GACnB,IACIpB,EAAOoB,EAAOpB,KACdpM,EAAOwN,EAAOxN,KAEdwvG,EAAelwG,EAAEsJ,OAAO4E,GAC1By3D,cAAe9iE,KACf+iE,YAAa13D,EAAO03D,aAAe/iE,KAAK+iE,cAG1C,GAAa,WAAT94D,EAAmB,CACrB,IAAIyI,EAAa7U,EAAK6U,WACtB,GAAIA,GAAsC,KAAxBA,EAAW2hB,SAC3B,OAAO,IAAIxnB,OAAO23D,UAAU+qC,yBAAyBlC,GAKzD,OAAIxgG,OAAOY,KAAKq1B,uBAAkC,SAAT74B,EAChC,IAAI4C,OAAO23D,UAAUlmE,KAAKy3H,KAAK1oB,GAlB7BrtG,KAqBCsN,OAAOjC,IAQrBwpD,UAAW,SAAUxpD,GACnB,IACIpB,EAAOoB,EAAOpB,KACdiqH,EAAe/2H,EAAEsJ,OAAO4E,GAC1By3D,cAAe9iE,KACf+iE,YAAa13D,EAAO03D,aAAe/iE,KAAK+iE,YACxC6pB,iBAAgB//E,OAAOY,KAAKqT,QAAQzV,EAAOuhF,iBAAyBvhF,EAAOuhF,iBAG7E,GAAa,iBAAT3iF,EAAyB,CAC3B,IACIyI,EADOrH,EAAOxN,KACI6U,WACtB,GAAIA,GAAsC,KAAxBA,EAAW2hB,SAE3B,OADA6/F,EAAa5kD,UAAYziE,OAAO23D,UAAU+qC,yBACnC,IAAI1iG,OAAO23D,UAAUjnE,QAAQgyG,yBAAyB2kB,GAKjE,OAlBWl0H,KAkBCsN,OAAOjC,IAOrBsqH,iBAAkB,WAChB,IAAI51H,EAAOC,KACPkQ,EAAW,IAAI/S,EAAE4S,SAqDrB,OAnDIlD,OAAOY,KAAKq1B,sBACd3lC,EAAEqM,KAEAzJ,EAAK+yH,aAAa,YAAajmH,OAAO0iD,YAAY,iDAGlDxvD,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,gDAAkD,eAC/FxvD,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,gDAAkD,oBAC/FxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,gDAAkD,6BAGxGxvD,EAAK+yH,aAAa,eAAgBjmH,OAAO0iD,YAAY,gDAAkD,uBACvGxvD,EAAK+yH,aAAa,aAAcjmH,OAAO0iD,YAAY,gDAAkD,qBACrGxvD,EAAK+yH,aAAa,mBAAoBjmH,OAAO0iD,YAAY,gDAAkD,2BAC3GxvD,EAAK+yH,aAAa,oBAAqBjmH,OAAO0iD,YAAY,gDAAkD,4BAC5GxvD,EAAK+yH,aAAa,4BAA6BjmH,OAAO0iD,YAAY,gDAAkD,oCACpHxvD,EAAK+yH,aAAa,iBAAkBjmH,OAAO0iD,YAAY,gDAAkD,yBACzGxvD,EAAK+yH,aAAa,kBAAmBjmH,OAAO0iD,YAAY,gDAAkD,0BAC1GxvD,EAAK+yH,aAAa,0BAA2BjmH,OAAO0iD,YAAY,gDAAkD,kCAClHxvD,EAAK+yH,aAAa,mBAAoBjmH,OAAO0iD,YAAY,gDAAkD,2BAE3GxvD,EAAK+yH,aAAa,oBAAqBjmH,OAAO0iD,YAAY,gDAAkD,uBAC3GpnD,KAAK,WACJ+H,EAASC,YAGbhT,EAAEqM,KAEAzJ,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,yCAC7CxvD,EAAK+yH,aAAa,OAAQjmH,OAAO0iD,YAAY,yCAC7CxvD,EAAK+yH,aAAa,gBAAiBjmH,OAAO0iD,YAAY,kDAGtDxvD,EAAK+yH,aAAa,mBAAoBjmH,OAAO0iD,YAAY,+CAAiD,mBAC1GxvD,EAAK+yH,aAAa,sBAAuBjmH,OAAO0iD,YAAY,+CAAiD,2BAC7GxvD,EAAK+yH,aAAa,oBAAqBjmH,OAAO0iD,YAAY,+CAAiD,yBAC3GxvD,EAAK+yH,aAAa,0BAA2BjmH,OAAO0iD,YAAY,+CAAiD,+BACjHxvD,EAAK+yH,aAAa,qBAAsBjmH,OAAO0iD,YAAY,+CAAiD,0BAC5GxvD,EAAK+yH,aAAa,6BAA8BjmH,OAAO0iD,YAAY,+CAAiD,kCACpHxvD,EAAK+yH,aAAa,kBAAmBjmH,OAAO0iD,YAAY,+CAAiD,uBACzGxvD,EAAK+yH,aAAa,0BAA2BjmH,OAAO0iD,YAAY,+CAAiD,+BACjHxvD,EAAK+yH,aAAa,mBAAoBjmH,OAAO0iD,YAAY,+CAAiD,wBAC1GxvD,EAAK+yH,aAAa,2BAA4BjmH,OAAO0iD,YAAY,+CAAiD,gCAClHxvD,EAAK+yH,aAAa,oBAAqBjmH,OAAO0iD,YAAY,+CAAiD,yBAC3GxvD,EAAK+yH,aAAa,sBAAuBjmH,OAAO0iD,YAAY,+CAAiD,2BAC7GxvD,EAAK+yH,aAAa,wBAAyBjmH,OAAO0iD,YAAY,+CAAiD,8BAC9GpnD,KAAK,WACJ+H,EAASC,YAIRD,EAAS3H,aC1RpBpL,EAAEklD,MAAM57C,OAAO,sCAMX+Q,KAAM,SAAUnM,GACZrL,KAAKg2H,iBAAmBnpH,OAAOY,KAAKoG,eACpC7T,KAAKi2H,kBAUTC,iBAAkB,SAAUnzD,EAAa/+C,GACrC,IAAIjkB,EAAOC,KACXgkB,EAASA,GAAU,UACnB,IAAIP,EAAQ,IAAItmB,EAAE4S,SA+DlB,YA7D0C,IAA/BhQ,EAAKk2H,cAAcjyG,IAE1BjkB,EAAKk2H,cAAcjyG,GAAQ+mD,cAAe,EAE1CtnD,EAAMtT,QAAQpQ,EAAKk2H,cAAcjyG,KAGlB,UAAXA,GAGAjkB,EAAKk2H,cAAcjyG,GAAU,IAAInX,OAAO23D,UAAU2xD,MAAMX,QAAQzyD,GAGhEhjE,EAAKk2H,cAAcjyG,GAAQ4uG,iBACtBzqH,KAAK,WAEFsb,EAAMtT,QAAQpQ,EAAKk2H,cAAcjyG,OAGvB,YAAXA,GAGPjkB,EAAKk2H,cAAcjyG,GAAU,IAAInX,OAAO23D,UAAUphB,QAAQoyE,QAAQzyD,GAGlEhjE,EAAKk2H,cAAcjyG,GAAQ4uG,iBACtBzqH,KAAK,WAEFsb,EAAMtT,QAAQpQ,EAAKk2H,cAAcjyG,OAGlCnX,OAAOY,KAAK0yB,eAAenc,IAGlCjkB,EAAKk2H,cAAcjyG,GAAU,IAAInX,OAAO23D,UAAU51D,OAAO4mH,QAAQzyD,GAGjEhjE,EAAKk2H,cAAcjyG,GAAQ4uG,iBACtBzqH,KAAK,WAEFsb,EAAMtT,QAAQpQ,EAAKk2H,cAAcjyG,OAElCnX,OAAOY,KAAK6yB,mBAAmBtc,IAGtCjkB,EAAKk2H,cAAcjyG,GAAU,IAAInX,OAAO23D,UAAU32D,WAAW2nH,QAAQzyD,GAGrEhjE,EAAKk2H,cAAcjyG,GAAQ4uG,iBACtBzqH,KAAK,WAGFsb,EAAMtT,QAAQpQ,EAAKk2H,cAAcjyG,QAIzCnX,OAAOwtE,eAAe,yBAA2Br2D,GACjDP,EAAM6uC,OAAO,yBAA2BtuC,IAIzCP,EAAMlb,WAOjB6tH,eAAgB,WACZ,OAAOp2H,KAAK+iE,eC1FpBl2D,OAAO23D,UAAY33D,OAAO23D,cAO1BrnE,EAAEklD,MAAM57C,OAAO,2BACX++C,UAAMt9C,EACNmuH,kBAAmB,IAAIl5H,EAAE4S,WAKzByH,KAAM,SAAUnM,GACZA,EAASA,MAGTrL,KAAKijE,kBAAoB9lE,MAGzB,IAAI6mB,EAAS3Y,EAAO2Y,QAAU,GAG9BhkB,KAAKs2H,cAAgB,IAAIzpH,OAAO23D,UAAUxgD,OAAOwxG,QAGjDx1H,KAAK+iE,YAAc,IAAIl2D,OAAO2xC,OAAOC,SAAS8D,QAAQl3C,GAGtDrL,KAAK8iE,cAAgB9iE,KAAKs2H,cAAcJ,iBAAiBl2H,KAAK+iE,YAAa/+C,IAE/EuyG,WAAY,WAER,OACID,cAFOt2H,KAEas2H,cACpBvzD,YAHO/iE,KAGW+iE,YAClBD,cAJO9iE,KAIa8iE,gBAM5B6pC,UAAW,WACP3sG,KAAKijE,kBAAkBj+D,KAAKoJ,MAAMpO,KAAKijE,kBAAmB50D,YAK9DmoH,YAAa,WACTx2H,KAAKijE,kBAAkB97C,OAAO/Y,MAAMpO,KAAKijE,kBAAmB50D,YAKhE43B,QAAS,WACL,OAAOjmC,KAAKijE,kBAAkBnJ,eAAe1rD,MAAMpO,KAAKijE,kBAAmB50D,YAK/E4L,OAAQ,SAAU5O,GAQd,OAJIA,EAAOxL,OAHAG,KAIFH,KAAOwL,EAAOxL,MAJZG,KAOC6P,QAAQ1S,EAAEsJ,QAClB02B,OAROn9B,KAQMm9B,OACbt9B,KATOG,KASIH,MACZwL,KAMPwE,QAAS,SAAUxE,GACf,IAAItL,EAAOC,KACPy2H,EAAMz2H,KAAK02H,cACX7tG,EAAO1rB,EAAE,OAAQs5H,GAiBrB,GAhBAprH,EAASA,MAGLtL,EAAKs2H,mBAAqBt2H,EAAKs2H,kBAAkBjuH,MACX,YAAlCrI,EAAKs2H,kBAAkBjuH,UACvBrI,EAAKs2H,kBAAoBl5H,EAAE4S,YAG/BhQ,EAAKs2H,kBAAoBl5H,EAAE4S,WAI/BlD,OAAOq4C,OAAOC,aAAa,kBAAkB,GAC7Ct4C,OAAO23D,UAAUhmB,OAAOuqB,yBAGK,IAAjB19D,EAAW,OACdwB,OAAOY,KAAKqT,QAAQzC,OAAOnI,SAAS46B,QAAS,CAC9C,IAAItkB,EAAc3f,OAAOY,KAAK2W,iBAC9B/Y,EAAOxL,KAAO2sB,EAAkB,KAKxC,IAAI2Q,EAASp9B,EAAKo9B,OAAS9xB,EAAO8xB,OAAS9xB,EAAO8xB,QAAUhgC,EAAE,WAAW+G,SAAS2kB,GAyFlF,OAxFA9oB,EAAKF,KAAOwL,EAAOxL,KAEnBE,EAAK42H,QAAQtrH,GAAQlD,KAAK,SAAUq9C,GAG3Bn6C,EAAOurH,YACRz5F,EAAOl7B,QAIXk7B,EAAOv7B,OAAO4jD,EAAK3jC,WAGnB1kB,EAAEqoD,EAAKqxE,aAAa9nG,aAAay2B,EAAK3jC,WAGtC9hB,EAAKylD,KAAOA,EACZzlD,EAAKylD,KAAKk4B,SAAS1gE,MAAOjd,EAAK+2H,UAAWh0G,OAAQ/iB,EAAKg3H,aAGvDj1H,WAAW,WACP/B,EAAK+2H,UAAY35H,EAAEkhB,QAAQrB,QAC3Bjd,EAAKg3H,WAAa55H,EAAEkhB,QAAQyE,SACxBzE,OAAOte,OAASse,OAAOwE,KACvB9iB,EAAKi3H,qBACV,KAGHxxE,EAAKsU,eAAe,iBAGpB/5D,EAAKkmC,QAAQ,6BAGblmC,EAAKk3H,iBAAiBzxE,EAAMroB,GAC5Bp9B,EAAKm3H,iBAAiB1xE,EAAMroB,GAC5Bp9B,EAAKo3H,qBAAqB3xE,EAAMroB,GAChCp9B,EAAKq3H,gBAAgB5xE,GACrBzlD,EAAKs3H,wBAAwB7xE,GAGzBn6C,EAAO44C,aACPuB,EAAK3jC,UAAUxgB,SAAS,0BAI5BwL,OAAOq4C,OAAOK,WAAW,aACzB14C,OAAOq4C,OAAOK,WAAW,kBACzB14C,OAAOq4C,OAAOK,WAAW,cACzB14C,OAAOq4C,OAAOK,WAAW,mBACzB14C,OAAOq4C,OAAOK,WAAW,WAGzB14C,OAAO23D,UAAUhmB,OAAOwqB,mBAGpBn8D,OAAOwkB,SAASimG,qBAChBv3H,EAAKsiD,MAAMmD,KAAOzlD,EAAKylD,KACvBzlD,EAAKsiD,MAAMg0E,kBAAkBlmH,QAAQpQ,EAAKylD,OAG9CzlD,EAAKs2H,kBAAkBlmH,QAAQpQ,EAAKylD,QAErCp1C,KAAK,SAAUsG,EAAS0tD,GAEvBjnE,EAAEqM,KAAKzJ,EAAK+iE,eACP36D,KAAK,SAAU26D,QAEW,IAAZpsD,GAAuC,KAAZA,IAClCA,EAAU7J,OAAOC,aAAaC,YAAY,yBAG9C,IAAIg8F,EAAgBjmC,EAAckmC,kBAAkB,cAEpD7rE,EAAOl7B,QACPk7B,EAAOv7B,OAAOzE,EAAE8/E,KAAK8rB,GACjBryF,QAASA,KAEb3W,EAAKkmC,QAAQ,8BAA+BvvB,GAC5C3W,EAAKo9B,OAAO28B,eAAe,YAAapjD,GAExC7J,OAAOq4C,OAAOK,WAAW,aACzB14C,OAAOq4C,OAAOK,WAAW,kBAEzBxlD,EAAKs2H,kBAAkB/jE,aAI5BvyD,EAAKs2H,kBAAkB9tH,WAKlC6I,MAAO,WACH,OAAOpR,KAAKq2H,kBAAkB9tH,WAMlCouH,QAAS,SAAUtrH,GACf,IAAItL,EAAOC,KACPyjB,EAAQ,IAAItmB,EAAE4S,SAGds2E,EAActmF,EAAKgjE,YAAYvf,YAAYn4C,GAE3C8xB,EAASp9B,EAAKo9B,QAAU9xB,EAAO8xB,OAuDnC,OArDAtwB,OAAO4rD,sBAAuB,EAE9Bt7D,EAAEqM,KAAK68E,EAAatmF,EAAK+iE,eACpB36D,KAAK,SAAUtK,EAAMilE,GAIlB,GAHAj2D,OAAO4rD,sBAAuB,EAG1B5rD,OAAOY,KAAKqT,QAAQjjB,GAGpB,OAFAkC,EAAKkmC,QAAQ,sBACbxiB,EAAMrT,OAIV,GAAIvS,GAAqB,UAAbA,EAAKoM,MACTu7C,EAAOzlD,EAAKylD,QAEZA,EAAKzjD,aACLyjD,EAAKpnB,WAGTjB,EAAO28B,eAAe,gBAEnB,GAAIj8D,GAAqB,aAAbA,EAAKoM,KAAqB,CACzC,IAAI8+F,EAAgBjmC,EAAcvT,YAAY,gBAC1C74C,EAAU7J,OAAOC,aAAaC,YAAY,yBAC9B5P,EAAE8/E,KAAK8rB,GACnBryF,QAASA,IAGHxS,SAASi5B,GAEnB1Z,EAAMrT,YAEH,GAAIvS,GAAqB,SAAbA,EAAKoM,KAAiB,CACjCoB,EAAOkM,eAAe,mBACtB1Z,EAAOkC,EAAKw3H,qBAAqB15H,IAC5B2nD,KAAK9yC,WAAWqyC,SAAW,SAGpCl4C,OAAOq4C,OAAOC,aAAa,aAC3B95C,EAAOpB,KAAQpM,EAAK2nD,MAAQ3nD,EAAK2nD,KAAK9yC,WAAWzI,MAASoB,EAAOpB,KACjE,IAAIu7C,EAAOzlD,EAAKy3H,YAAY35H,EAAK2nD,KAAMsd,EAAez3D,GAGtDoY,EAAMtT,QAAQq1C,QAGdzlD,EAAK03H,gBAAgB55H,EAAM4lB,KAEhCrT,KAAK,SAAU02B,GAClB/mC,EAAK03H,gBAAgB3wF,EAAcrjB,KAGhCA,EAAMlb,WAMjBgvH,qBAAsB,SAAU15H,GAC5B,IAAIkC,EAAOC,KACX,OAAY,MAARnC,EACOA,GAGPA,EAAK0Z,eAAe,SAAwB,QAAb1Z,EAAKoM,MACpCpM,EAAKP,GAAKO,EAAKP,GAAK,SACpBO,EAAK6nD,SAAW,QAChB7nD,EAAK8nD,YAAc,QACnB9nD,EAAK+nD,UAAY,QACjB/nD,EAAKgoD,cAAgB,QACrBhoD,EAAK6B,UAAY,QACjB7B,EAAKioD,YAAc,SAEnB3oD,EAAE0D,KAAKhD,EAAM,SAAUkD,EAAK6C,GACF,iBAAX,IACP/F,EAAKkD,GAAOhB,EAAKw3H,qBAAqB15H,EAAKkD,OAIhDlD,IAKX45H,gBAAiB,SAAU3wF,EAAcrjB,GACrC,IACI/M,EAAU,GACVghH,KACJ,IACIA,EAAmB/6G,KAAKhE,MAAMmuB,EAAa5K,cAC7C,MAAOjuB,GACLypH,GAAoBhhH,QAASowB,EAAa5K,aAAckoC,UAAW,gBAInEszD,EAAiBhhH,SACjBA,GAAW,mBAAqBghH,EAAiBtzD,UACjD1tD,GAAW,sBAAwBghH,EAAiBhhH,SAElB,+BAA9BghH,EAAiBtzD,YACjB1tD,GAAW,sBAAwB7J,OAAOC,aAAaC,YAAY,oBAKzC,gBAA9B2qH,EAAiBtzD,UACjB3gD,EAAM6uC,OAAO57C,EAASghH,EAAiBtzD,WAGvC3gD,EAAM6uC,OAAO57C,IAMrB8gH,YAAa,SAAU35H,EAAMilE,EAAez3D,GACxC,IAAIm6C,EAAOsd,EAAcjoB,aAAa19C,EAAEsJ,OAAO4E,GAC3CpB,KAAMoB,EAAOpB,MAAQ,OACrBpM,KAAMA,KAIV,GAAiC,oBAAtB85H,qBAC6B,OAA/BnyE,EAAK9yC,WAAW5O,aAA8C,OAAtB6zH,qBAAgCnyE,EAAKvmD,QAAQiG,OAAS,EAAG,CAClG,IAAI0yH,EAAcpyE,EAAKvmD,QAAQ,GAE/BumD,EAAKvmD,QAAQ4a,OAAO,EAAG,GACvB2rC,EAAKvmD,QAAQ2J,KAAKgvH,GAO1B,OAFApyE,EAAKhH,SAEEgH,GAKXge,OAAQ,SAAUv0D,GACHjP,KACFwlD,MADExlD,KAEFwlD,KAAKvgD,QAAQ,eAAgBgK,IAM1CgoH,iBAAkB,SAAUzxE,EAAMroB,GAC9B,IAAIp9B,EAAOC,KAGXwlD,EAAKxgD,KAAK,UAAW,SAAUs3D,EAAGwtC,GAG9B,IAAI1sE,EAASooB,EAAK3jC,UAAUub,SAExBza,GADJya,EAASvwB,OAAOY,KAAKkV,UAAUya,IACRza,YAEvBxlB,EAAE4C,EAAKylD,MAAMvgD,QAAQ,oBAGrBugD,EAAKpnB,QAAQ0rE,GACb3sE,EAAO06F,YACP,IAAIC,EAAe36F,EAAOC,SACtB06F,EAAax0H,KAAK,+BAA+B4B,OAAS,GAC1D4yH,EAAax0H,KAAK,+BAA+B9D,SAGjDO,EAAKs2H,mBAAqBt2H,EAAKs2H,kBAAkBjuH,OACX,YAAlCrI,EAAKs2H,kBAAkBjuH,UACvBrI,EAAKs2H,kBAAoBl5H,EAAE4S,YAInC,IAAI4wB,EAAa5gC,EAAKylD,KAAK5kB,YAgB3B,OAdAzjC,EAAEqM,KAAKzJ,EAAK8P,QAAQ1S,EAAEsJ,OAAOqjG,GACzB3sE,OAAQA,EACRy5F,YAAY,EACZ/wF,OAAQlF,EAAWkF,OACnBsU,YAAaxZ,EAAWwZ,gBACvBhyC,KAAK,WAGNrG,WAAW,WACPs7B,EAAOza,UAAUA,GACjBxlB,EAAE4C,EAAKylD,MAAMvgD,QAAQ,sBACtB,OAGAlF,EAAKs2H,kBAAkB9tH,aAMtC6uH,gBAAiB,SAAU5xE,GACvB,IAAIzlD,EAAOC,KAGXwlD,EAAKxgD,KAAK,eAAgB,SAAUs3D,EAAGrtD,GAGnC,GAFAA,EAAOA,OAEHlP,EAAKg4H,cAAT,CA0BAh4H,EAAKg4H,cAAgBj2H,WAxBN,WAEX,IAAIkb,EAAQ7f,EAAEkhB,QAAQrB,QAClB8F,EAAS3lB,EAAEkhB,QAAQyE,UACnB7T,EAAK+oH,aAAeh7G,GAASjd,EAAK+2H,aAGlCjqH,OAAOq4C,OAAOC,aAAa,UAG3BK,EAAKge,QACDxmD,MAAOA,EACP8F,OAAQA,IAEZ/iB,EAAK+2H,UAAY95G,EACjBjd,EAAKg3H,WAAaj0G,EAGlBjW,OAAOq4C,OAAOK,WAAW,UACzB14C,OAAOq4C,OAAOxkC,IAAI,WAGtB3gB,EAAKg4H,cAAgB,MAEiB,MAG9Ch4H,EAAKyjE,UAKT0zD,iBAAkB,SAAU1xE,EAAMroB,GAE9BqoB,EAAKxgD,KAAK,UAAW,SAAU2J,EAASspH,GAEpCzyE,EAAKpnB,UAGLjB,EAAO28B,eAAe,UAAWm+D,MAMzCZ,wBAAyB,SAAU7xE,GAC/B,IAAIzlD,EAAOC,KAGXwlD,EAAKxgD,KAAK,gBAAiB,SAAUs3D,EAAGrtD,GAEpC,OAAOlP,EAAKkmC,QAAQh3B,EAAK00D,UAAW10D,EAAKpR,SAMjDs5H,qBAAsB,SAAU3xE,EAAMroB,GAClC,IAAIp9B,EAAOC,KAEXwlD,EAAKxgD,KAAK,qBAAsB,SAAU0hB,EAAOogB,GAC7C3pC,EAAEqM,KAAKzJ,EAAK+iE,eACP36D,KAAK,SAAU26D,GACZ,IAAIpsD,EAAU,cAEdowB,EAAeA,EAAaniC,QAAQ,iBAAkB,IAEtD,IAAI+yH,EAAmB/6G,KAAKhE,MAAMmuB,GAC9B4wF,EAAiBhhH,UACjBA,GAAWghH,EAAiBhhH,QAC5BA,GAAW,mBAAqBghH,EAAiBtzD,WAErD,IAAI2kC,EAAgBjmC,EAAckmC,kBAAkB,cAEpD7rE,EAAOl7B,QACPk7B,EAAOv7B,OAAOzE,EAAE8/E,KAAK8rB,GACjBryF,QAASA,KAGb3W,EAAKo9B,OAAO28B,eAAe,YAAa,mBAExCjtD,OAAOq4C,OAAOK,WAAW,kBACzB14C,OAAOq4C,OAAOK,WAAW,kBAKzCnnB,QAAS,WACMp+B,KACFwlD,MADExlD,KAEFwlD,KAAKpnB,UAEdvxB,OAAOY,KAAK2wB,QAJDp+B,OAOfg3H,kBAAmB,WACf,GAAI75H,EAAE,0BAA0B+H,OAAS,GAA0C,SAArC2H,OAAOY,KAAK2W,iBAAiBna,KAAiB,CACxF,IAAIiuH,EAA8B/6H,EAAE,0BAA0B2lB,UAAY,EACtEq1G,EAAah7H,EAAE,8DACfi7H,EAAkBj7H,EAAE,8BAA+B,0BACnDk7H,EAAwBD,EAAgB1kH,eAAiB,EACzD4kH,EAAiBzrH,OAAOY,KAAK2W,iBAAiBk0G,gBAAkB,GAGpE,GAAsB,UAFtBA,EAAiBA,EAAe3zH,QAAQ,IAAK,KAEd,CAC3B,QAAuC,IAA3B5E,KAAsB,kBAAkB,CAChD,IAAIw4H,EAAep7H,EAAE,0BAA0B2lB,SAAW,IAAM,IAChE3lB,EAAE,kBAAkB2lB,OAAOy1G,GAC3Bp7H,EAAE,kBAAkBuH,IAAI,YAAa,eAClCvH,EAAE,0BAA0B2lB,OAAO3lB,EAAE,0BAA0B2lB,SAAW3lB,EAAE,+BAA+B2lB,SAAW,IAC7H3lB,EAAE,+BAA+BuH,IAAI,WAAY,YACjDvH,EAAE,+BAA+B+G,SAAS,0BACtC/G,EAAE,+BAA+B+H,OAAS,IAC1C/H,EAAE,qCAAqCgI,OACvCgzH,EAAWzzH,IAAI,YAAa,UAGhC0zH,EAAgBlzH,OAAS,GAEzBizH,EAAWr1G,OAAOo1G,EAA8B,GAAKG,GAEC,GAAtDl7H,EAAE,+BAA+BkG,WAAW6B,OAC5C/H,EAAE,kBAAkB2lB,OAAO3lB,EAAE,kBAAkB2lB,SAAWu1G,IAE1DD,EAAgBp7G,MAAM,QACtBo7G,EAAgB1zH,IAAI,aAAc,GAClC0zH,EAAgB1zH,IAAI,SAAU,QAEU,UAArCmI,OAAOY,KAAK2W,iBAAiBna,OACpC9M,EAAE,QAAQuH,IAAI,YAAa,UAC1BvH,EAAE,WAAW2lB,UAAYzE,OAAO4I,YAAc,EAAK9pB,EAAE,QAAQuH,IAAI,YAAa,UACzEvH,EAAE,QAAQuH,IAAI,YAAa,UACjCvH,EAAE,sBAAsB2lB,OAAO","sourcesContent":["/*\r\n *   Name: \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This widget will implement a custom grid for bizagi rendering module\r\n *\r\n *   Markup: <div></div>\r\n *\r\n *   Styles:\r\n *   - Desktop: css/bizagi/desktop/controls/bizagi.grid.css\r\n *   - Tablet: css/bizagi/tablet/controls/bizagi.grid.css\r\n */\r\n\r\n// TODO: Create templates\r\n\r\n(function ($) {\r\n    $.widget(\"ui.bizagi_grid\", {\r\n        options: {\r\n            id: \"no-id\",\r\n            columns: [],\r\n            sortBy: \"\",\r\n            sortType: \"asc\",\r\n            showSummary: false,\r\n            collapse: false,\r\n            collapseState: false,\r\n            data: {},\r\n            indexedData: {},\r\n            maxColumns: 0,\r\n            buttonsPst: false,\r\n            title: '',\r\n            tableCssClass: '', // Style for entire table              \r\n            headerStyles: '',\r\n            floatingHeader: false,\r\n            template: {\r\n                grid: \"\",\r\n                waiting: \"\",\r\n                table: \"\",\r\n                emptyTable: \"\",\r\n                column: \"\",\r\n                specialColumn: \"\",\r\n                row: \"\",\r\n                rowButtons: \"\",\r\n                cell: \"\",\r\n                specialCell: \"\",\r\n                pager: \"\",\r\n                buttons: \"\",\r\n                dynamicPager: \"\",\r\n                summary: \"\",\r\n                summaryCell: \"\"\r\n            },\r\n            actions: {\r\n                add: true,\r\n                edit: true,\r\n                remove: true,\r\n                details: true,\r\n                allowMore: false,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false\r\n            },\r\n            mode: \"execution\"\r\n        },\r\n        /*\r\n        *   Constructor\r\n        */\r\n        _init: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Set object variables\r\n            self.page = 1;\r\n            self.changes = {};\r\n            self.totalRows = 0;\r\n            self.totalPages = 0;\r\n            self.data = options.data;\r\n            self.selectedRow = 0;\r\n            self.components = {};\r\n            self.buttons = {};\r\n            self.asyncCells = {};\r\n            self.scrollableArea = options.scrollableArea || self;\r\n\r\n            // Build column indexes\r\n            self.columnByIndex = {};\r\n            self.columnByName = {};\r\n            self.columnKeyIndex = 0;\r\n            $.each(options.columns, function (i, column) {\r\n                // Fix non-present properties\r\n                column.key = typeof (column.key) !== \"undefined\" ? column.key : false;\r\n                column.label = typeof (column.label) !== \"undefined\" ? column.label : column.name;\r\n                column.sortType = \"asc\";\r\n                column.tooltip = typeof (column.tooltip) !== \"undefined\" ? column.tooltip : \"\";\r\n\r\n                // Index the column\r\n                self.columnByIndex[column.index] = column;\r\n                self.columnByName[column.name] = column;\r\n                if (column.key) {\r\n                    self.columnKeyIndex = column.index;\r\n                }\r\n            });\r\n\r\n            // Set sort options\r\n            options.sortBy = options.sortBy || self.columnByIndex[0].name;\r\n            if (self.columnByName[options.sortBy]) {\r\n                self.columnByName[options.sortBy].sortType = options.sortType;\r\n            } else {\r\n                if (self.columnByName[options.sortBy.split(\".\")[0]]) {\r\n                    self.columnByName[options.sortBy.split(\".\")[0]].sortType = options.sortType;\r\n                }\r\n            }\r\n\r\n            // Add base classes\r\n            element.addClass(\"ui-bizagi-grid-wrapper\");\r\n            element.attr(\"data-bizagi-id\", options.id);\r\n\r\n            // Calculate\r\n            self.calculateKeyIndex();\r\n\r\n            //collapse state\r\n            self.collapseState = options.collapseState;\r\n\r\n            // Start waiting signal \r\n            self.startLoading(false);\r\n        },\r\n        /*\r\n        *   Method to start loading for ajax data and update the ui\r\n        */\r\n        startLoading: function (bUseTimeout) {\r\n            var self = this;\r\n            bUseTimeout = typeof (bUseTimeout) !== \"undefined\" ? bUseTimeout : true;\r\n\r\n            if (self.options.mode !== \"execution\" || typeof self.options.sortBy === \"undefined\") {\r\n                return;\r\n            }\r\n\r\n            // Draw the waiting template when the endLoading delays more than 250ms\r\n            var waitingFn = function () {\r\n                var element = self.element;\r\n                var options = self.options;\r\n\r\n                // Set null to timeout\r\n                self.waitingTimeout = null;\r\n\r\n                element.append($.fasttmpl(options.template.waiting));\r\n            };\r\n\r\n            if (bUseTimeout) {\r\n                self.waitingTimeout = setTimeout(waitingFn, 250);\r\n            } else {\r\n                waitingFn();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Method to remove the loading message\r\n        */\r\n        endLoading: function () {\r\n            var self = this;\r\n            var element = self.element;\r\n\r\n            // Remove waiting timeout\r\n            if (self.waitingTimeout) {\r\n                clearTimeout(self.waitingTimeout);\r\n                self.waitingTimeout = null;\r\n            }\r\n\r\n            // Remove everything\r\n            element.empty();\r\n        },\r\n\r\n        /*\r\n        *   This method updates the data and refreshes the grid\r\n        */\r\n        setData: function (data) {\r\n            var self = this;\r\n\r\n            // Set internal data\r\n            self.data = data;\r\n            self.calculateKeyIndex();\r\n\r\n            // Call refresh\r\n            self.refresh();\r\n        },\r\n        /*\r\n        *   This method retrieves the actual data from the grid\r\n        */\r\n        getData: function () {\r\n            var self = this;\r\n\r\n            // Return internal data\r\n            return self.data;\r\n        },\r\n\r\n        /*\r\n        *   Calculate key index\r\n        */\r\n        calculateKeyIndex: function () {\r\n            var self = this;\r\n            var columns = self.options.columns;\r\n            var data = self.data;\r\n\r\n            indexedData = {};\r\n\r\n            if (data.rows) {\r\n                $.each(data.rows, function (i, row) {\r\n                    var key;\r\n                    var row\r\n                    $.each(columns, function (j, column) {\r\n                        if (column.key) key = row[j];\r\n                    });\r\n                    indexedData[key] = row;\r\n                });\r\n            }\r\n            self.indexedData = indexedData;\r\n        },\r\n\r\n        /*\r\n        *   This method retrieves the changes made by the user\r\n        */\r\n        getChanges: function () {\r\n        },\r\n\r\n        /*\r\n        *   This method refreshes the grid\r\n        */\r\n        refresh: function () {\r\n            var self = this;\r\n\r\n            // Cleans components\r\n            self._cleanComponents();\r\n            self._cleanButtons();\r\n\r\n            // Call the draw method\r\n            self.components = {};\r\n            self.draw();\r\n        },\r\n\r\n        /*\r\n        *   This method refreshes only the summary\r\n        */\r\n        refreshSummary: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var summary = self._getComponent(\"summary\");\r\n\r\n            // Do nothing if the component is drawing or there is no summary\r\n            if (self.drawing) return;\r\n            if (!summary) return;\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n\r\n                if (columnIndex) {\r\n                    // Refresh an specific summary\r\n                    self.refreshSummaryCell(columnIndex);\r\n\r\n                } else {\r\n                    // Clean and re-draw summary\r\n                    summary.empty();\r\n                    summary.append(self.drawSummary());\r\n\r\n                    // Execute post-render\r\n                    self.postRenderSummary(summary);\r\n                }\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Refresh a single summary cell\r\n        */\r\n        refreshSummaryCell: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var summary = self._getComponent(\"summary\");\r\n            var getCell = function (summary, columnIndex) {\r\n                var cells = summary.is(\"[data-bizagi-component=summary-cells]\") ? summary.children() : summary.find(\"[data-bizagi-component=summary-cells]\").children();\r\n                return $(cells[columnIndex]);\r\n            };\r\n            var cell = getCell(summary, columnIndex);\r\n\r\n            // Omit index key\r\n            var column = self.columnByIndex[columnIndex];\r\n            if (column.key) return; // Omit key column\r\n\r\n            // Clean and Execute render\r\n            var html = self.drawSummaryCell(column);\r\n            cell.replaceWith(html);\r\n\r\n            // Recalculate cell\r\n            cell = getCell(summary, columnIndex);\r\n\r\n            // Execute post-render\r\n            self.onCellReady(column, \"summary\", cell, false);\r\n        },\r\n\r\n        /*\r\n        *   This method changes a cell value in the grid\r\n        */\r\n        changeCellValue: function (key, columnIndex, value) {\r\n            var self = this;\r\n            if (self.indexedData[key]) {\r\n                self.indexedData[key][columnIndex] = value;\r\n            }\r\n        },\r\n\r\n        deleteCellExclusiveValues: function(columnIndex) {\r\n            var self = this;\r\n            if (self.indexedData) {\r\n                $.each(self.indexedData, function (key) {\r\n                    self.indexedData[key][columnIndex] = false;\r\n                });\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   This method draws the full grid associated with the data\r\n        */\r\n        draw: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Start global drawing flag\r\n            self.drawing = true;\r\n\r\n            // Ends waiting signal\r\n            self.endLoading();\r\n\r\n            if (options.orientation === \"rtl\") {\r\n\r\n                // Resolve grid template\r\n                var html = $.fasttmpl(options.template.gridRtl, {\r\n                    label: options.title,\r\n                    buttonsPst: options.buttonsPst,\r\n                    collapse: options.collapse,\r\n                    collapseState: self.collapseState,\r\n                    isDesign: (options.mode === \"design\")\r\n                });\r\n\r\n            } else {\r\n                // Resolve grid template\r\n                var html = $.fasttmpl(options.template.grid, {\r\n                    label: options.title,\r\n                    buttonsPst: options.buttonsPst,\r\n                    collapse: options.collapse,\r\n                    collapseState: self.collapseState,\r\n                    isDesign: (options.mode === \"design\")\r\n                });\r\n            }\r\n\r\n            // Call sub-drawers\r\n            html = self.drawTable(html);\r\n            self.grid = $(html).appendTo(element);\r\n\r\n            // Post render the grid\r\n            self.postRender(self.grid);\r\n\r\n            if (options.mode !== \"design\") {\r\n                // Attach paginator desktop\r\n                self.attachPaginator();\r\n\r\n                // Attach handlers\r\n                self.attachHandlers();\r\n            }\r\n\r\n            if (options.mode === \"execution\" && options.floatingHeader) {\r\n                var $tableContainer = self._getComponent(\"table\");\r\n                var $table = $(\"table\", $tableContainer);\r\n                var offset = parseInt($(self.scrollableArea).css(\"padding-top\").replace(/[^\\d.]/g, '')) || 0;\r\n\r\n                $table.stickyTableHeaders({\r\n                    fixedOffset: offset > 0 ? offset - 1 : offset,\r\n                    scrollableArea: self.scrollableArea,\r\n                    zIndex: 1000,\r\n                    cacheHeaderHeight: true\r\n                });\r\n                $tableContainer.bind(\"scroll\", function () {\r\n                    $table.trigger(\"resize.stickyTableHeaders\");\r\n                });\r\n            }\r\n\r\n            // Toggle visibility depending from row count\r\n            if (self.data.rows.length === 0) {\r\n                self._getComponent(\"table\").hide();\r\n                self._getComponent(\"pager\").hide();\r\n                self._getButton(\"remove\").hide();\r\n                self._getButton(\"edit\").hide();\r\n                self._getComponent(\"dynamicPager\").hide();\r\n                self._getComponent(\"emptyTable\").show();\r\n\r\n            } else {\r\n                self._getComponent(\"table\").show();\r\n                self._getButton(\"remove\").show();\r\n                self._getButton(\"edit\").show();\r\n                self._getComponent(\"emptyTable\").hide();\r\n\r\n                if (options.actions.allowMore) {\r\n                    self._getComponent(\"dynamicPager\").show();\r\n                    self._getComponent(\"pager\").hide();\r\n                } else {\r\n                    self._getComponent(\"pager\").show();\r\n                    self._getComponent(\"dynamicPager\").hide();\r\n                }\r\n\r\n                if (options.actions.edit) {\r\n                    self._getButton(\"edit\").show();\r\n                }\r\n\r\n                if (options.actions.enableXlsExport || options.actions.enablePdfExport) {\r\n                    self._getButton('show-grid-export-options').show();\r\n                } else {\r\n                    self._getButton('show-grid-export-options').css('display', 'none');\r\n                }\r\n\r\n            }          \r\n\r\n            // End global drawing flag\r\n            self.drawing = false;\r\n        },\r\n\r\n        attachPaginator: function () {\r\n        },\r\n\r\n        /*\r\n        *   This method draws the table associated with the data\r\n        */\r\n        drawTable: function (html) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve table template\r\n            var table = $.fasttmpl(options.template.table, {\r\n                showSummary: options.showSummary,\r\n                tableCssClass: options.tableCssClass\r\n            });\r\n            var emptyTable = $.fasttmpl(options.template.emptyTable);\r\n\r\n            // Resolve header\r\n            table = self._replaceElement(table, \"columns\", self.drawHeader());\r\n\r\n            // Resolve body\r\n            table = self._replaceElement(table, \"rows\", self.drawBody());\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n                table = self._replaceElement(table, \"summary\", self.drawSummary());\r\n            }\r\n\r\n            // Resolve pager\r\n            html = self._replaceElement(html, \"pager\", self.drawPager());\r\n\r\n            // Resolve buttons\r\n            html = self._replaceElement(html, \"buttons\", self.drawButtons());\r\n\r\n            //Resolve export options menu\r\n            html = self._replaceElement(html, \"gridExportOptions\", self.drawGridExportOptions());\r\n\r\n            // Resolve row buttons\r\n            html = self._replaceElement(html, \"rowButtons\", self.drawRowButtons());\r\n\r\n            // Resolve dynamic Pager\r\n            html = self._replaceElement(html, \"dynamicPager\", self.drawDynamicPager());\r\n\r\n            // Perform grid replaces\r\n            html = self._replaceElement(html, \"table\", table);\r\n            html = self._replaceElement(html, \"emptyTable\", emptyTable);\r\n            return html;\r\n        },\r\n        /*\r\n        * Find if a column has a exact match for sort it\r\n        */\r\n        isExactMatch: function () {\r\n            var self = this;\r\n            var columns = self.options.columns;\r\n            var sortBy = self.options.sortBy;\r\n            var i = 0, length = columns.length;\r\n            for (; i < length;) {\r\n                if (sortBy == columns[i++].name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the grid header\r\n        */\r\n        drawHeader: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve columns\r\n            var columns = \"\";\r\n\r\n            self.exactMatch = self.isExactMatch();\r\n\r\n            $.each(options.columns, function (i, column) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw normal column\r\n                        columns += self.drawColumn(column);\r\n                    }\r\n                } else {\r\n                    // Draw normal column\r\n                    columns += self.drawColumn(column);\r\n                }\r\n            });\r\n\r\n            if (self.options.maxColumns > 0 && self._canShowButtons()){\r\n                // Draw special column\r\n                columns += self.drawSpecialColumn();\r\n            }\r\n\r\n            return columns;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a column header\r\n        */\r\n        drawColumn: function (column) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            var columnProperties = column.bizAgiProperties || {}\r\n            var cssClass = columnProperties.cssclass ? columnProperties.cssclass : \"\";\r\n            var headerStyles = (options.headerStyles ? options.headerStyles.header : \"\");\r\n            headerStyles += (headerStyles !== \"\" ? \"; text-align:\" : \"text-align:\") + (columnProperties.columntitlealign ? columnProperties.columntitlealign : \"center\");\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.column, $.extend({}, column, {\r\n                isKey: column.key,\r\n                sortActive: column.name === options.sortBy ? column.name === options.sortBy : column.name === options.sortBy.split(\".\")[0] && !self.exactMatch ? column.name === options.sortBy.split(\".\")[0] : false,\r\n                sortType: options.sortOrder,\r\n                tooltip: column.tooltip || \"\",\r\n                columnCssClass: cssClass,\r\n                headerLabelStyles: options.headerStyles ? options.headerStyles.label : \"\",\r\n                headerStyles: headerStyles\r\n            }));\r\n        },\r\n        /*\r\n        *   This method draws a special column header that will be drawn when the grid can't show more columns\r\n        */\r\n        drawSpecialColumn: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.specialColumn);\r\n        },\r\n\r\n        drawDynamicPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.dynamicPager);\r\n        },\r\n\r\n        /*\r\n        *   This method draws the table body\r\n        */\r\n        drawBody: function () {\r\n            var self = this;\r\n\r\n            // Resolve rows\r\n            var rows = \"\";\r\n            $.each(self.data.rows, function (i, row) {\r\n                rows += self.drawRow(row);\r\n            });\r\n\r\n            return rows;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a grid row\r\n        */\r\n        drawRow: function (rowData, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var key = rowData[self.columnKeyIndex];\r\n            var newRow = isNewRow || false;\r\n            var rnd = Math.floor(Math.random() * 10000);\r\n            var row = $.fasttmpl(options.template.row, {\r\n                key: rnd,\r\n                isNewRow: isNewRow,\r\n                businessKey: key\r\n            });\r\n\r\n            // Resolve cells\r\n            var cells = \"\";\r\n            $.each(rowData, function (i, cell) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i < self.options.maxColumns + 1) {\r\n                        // Draw normal cell\r\n                        cells += self.drawCell(i, key, cell, newRow);\r\n                    } \r\n                } else {\r\n                    // Draw normal cell\r\n                    cells += self.drawCell(i, key, cell, newRow);\r\n                }\r\n            });\r\n\r\n            if (self.options.maxColumns > 0 && self._canShowRowButtons()){\r\n                // Draw special column\r\n                cells += self.drawSpecialCell(self.options.maxColumns + 1);\r\n            }\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the cells for summary\r\n        */\r\n        drawSummary: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var row = $.fasttmpl(options.template.summary);\r\n            var cells = \"\";\r\n\r\n            // Resolve summary cells\r\n            $.each(options.columns, function (i, column) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw summary column\r\n                        cells += self.drawSummaryCell(column);\r\n                    }\r\n                } else {\r\n                    // Draw summary column\r\n                    cells += self.drawSummaryCell(column);\r\n                }\r\n            });\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"summary-cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a single summary cell\r\n        */\r\n        drawSummaryCell: function (column) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            var columnProperties = column.bizAgiProperties || {};\r\n            var cellAlign = columnProperties.columnAlign ? columnProperties.columnAlign : \"center\";\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.summaryCell, {\r\n                hidden: column.hidden || false,\r\n                summarizeBy: column.summarizeBy,\r\n                cellAlign: cellAlign\r\n            });\r\n\r\n            var result = self.onDrawCell(column, \"summary\", self.calculateSummary(column), false);\r\n            result = (result != undefined && typeof (result) != \"number\") ? result.replace(\"summaryValue\", self.calculateSummary(column)) : result;\r\n\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = self._replaceElement(cell, \"cellContent\", self.resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = self._replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = self._replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            return cell;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the grid cell\r\n        */\r\n        drawCell: function (columnIndex, key, value, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            isNewRow = isNewRow || false;\r\n            var messageValidation = \"\";\r\n\r\n            // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            }\r\n\r\n            // Get message\r\n            if (columnIndex > 0) {\r\n                messageValidation = self.columnByIndex[columnIndex].bizAgiProperties && self.columnByIndex[columnIndex].bizAgiProperties.messageValidation;\r\n            }\r\n\r\n            var columnProperties = self.columnByIndex[columnIndex].bizAgiProperties || {};\r\n            var cssClass = (columnProperties.cssclass) ? columnProperties.cssclass : \"\";\r\n            var cellAlign = columnProperties.columnAlign ? columnProperties.columnAlign : \"center\";\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.cell, {\r\n                isKey: self.columnByIndex[columnIndex].key,\r\n                hidden: options.columns[columnIndex].hidden || false,\r\n                isDesign: (options.mode === \"design\"),\r\n                messageValidation: messageValidation,\r\n                columnCssClass: cssClass,\r\n                id: options.columns[columnIndex].bizAgiProperties ? options.columns[columnIndex].bizAgiProperties.id : undefined,\r\n                cellAlign: cellAlign\r\n            });\r\n\r\n            var result = self.onDrawCell(self.columnByIndex[columnIndex], key, value, isNewRow);\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = self._replaceElement(cell, \"cellContent\", self.resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = self._replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = self._replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            self.columnByIndex[columnIndex]['cell'] = $(cell);\r\n            return cell;\r\n        },\r\n        /*\r\n        *   Returns the resolved result from a promise when the promise has been executed already\r\n        */\r\n        resolveResult: function (promise) {\r\n            var result;\r\n\r\n            promise.done(function (data) {\r\n                result = data;\r\n            });\r\n\r\n            return result;\r\n        },\r\n        /*\r\n        *   This method draws a special cell that will be drawn when the grid can't show more columns\r\n        */\r\n        drawSpecialCell: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            /* // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            } */\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.specialCell);\r\n\r\n            return cell;\r\n        },\r\n        /*\r\n        *   This method draws a group header\r\n        */\r\n        drawGroupHeader: function () {\r\n            // TODO: Implement for PC version\r\n        },\r\n        /*\r\n        *   This method draws a footer\r\n        */\r\n        drawFooter: function () {\r\n            // TODO: Implement for PC version\r\n        },\r\n        /*\r\n        *   This method draws a grid pager\r\n        */\r\n        drawPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Calculate pages\r\n            var pages = [];\r\n            for (var i = 1; i <= self.data.total; i++) {\r\n                pages.push({\r\n                    number: i,\r\n                    active: (i == self.data.page)\r\n                });\r\n            }\r\n\r\n            // Resolve pager template\r\n            return $.fasttmpl(options.template.pager, {\r\n                page: self.data.page,\r\n                pages: pages,\r\n                records: self.data.records\r\n            });\r\n        },\r\n        /*\r\n        *   This method draws a grid button actions\r\n        */\r\n        drawButtons: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var tooltips = options.tooltips || {};\r\n\r\n            var parameters = $.extend(options.actions, tooltips);\r\n\r\n            if (self._canShowButtons()) {\r\n                // Resolve buttons template\r\n                if (options.orientation === \"rtl\") {\r\n                    return $.fasttmpl(options.template.buttonsRtl, parameters);\r\n                } else {\r\n                    return $.fasttmpl(options.template.buttons, parameters);\r\n                }\r\n            } else {\r\n                return \"\";\r\n            }\r\n        },\r\n\r\n        /*\r\n        * This method draws the export options menu\r\n        */\r\n        drawGridExportOptions: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var actions = options.actions;\r\n\r\n            tooltips = options.tooltips || {};\r\n\r\n            var parameters = $.extend({ \r\n                enableXlsExport: actions.enableXlsExport,\r\n                enablePdfExport: actions.enablePdfExport \r\n            }, tooltips);\r\n\r\n            return $.fasttmpl(options.template.exportOptions, parameters);\r\n        },\r\n\r\n        /*\r\n        *   This method draws a row buttons,\r\n        *   those buttons will be invisible, and will be activated when the user selects a row\r\n        */\r\n        drawRowButtons: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            if (self._canShowRowButtons()) {\r\n                // Resolve row buttons template\r\n                if (options.orientation === \"rtl\") {\r\n                    return $.fasttmpl(options.template.rowButtons.rtl, options.actions);\r\n                } else {\r\n                    return $.fasttmpl(options.template.rowButtons, options.actions);\r\n                }\r\n            } else {\r\n                return \"\";\r\n            }\r\n        },\r\n        /*\r\n        *   Execute post-renders in all the grid\r\n        */\r\n        postRender: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Get grid rows\r\n            var rows = self._getComponent(\"cells\");\r\n            if (rows) {\r\n                $.each(rows, function (i, row) {\r\n                    row = $(row);\r\n                    self.postRenderRow(row);\r\n                });\r\n            }\r\n\r\n            // Get summary row\r\n            if (options.showSummary) {\r\n                var summary = self._getComponent(\"summary\");\r\n                self.postRenderSummary(summary);\r\n            }\r\n\r\n            self._triggerHandler(\"gridControlReady\");\r\n        },\r\n\r\n        /*\r\n        *   Execute post-renders in each cell after the element has been created\r\n        */\r\n        postRenderRow: function (row) {\r\n            var self = this;\r\n            var key = row.attr(\"data-business-key\");\r\n            var isNewRow = row.attr(\"data-new-row\");\r\n            var cells = row.is(\"[data-bizagi-component=cells]\") ? row.children() : row.find(\"[data-bizagi-component=cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (typeof column == \"undefined\" || column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            self.onCellReady(column, key, cell, isNewRow);\r\n                        });\r\n                } else {\r\n                    self.onCellReady(column, key, $(cell), isNewRow);\r\n                }\r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Execute post-renders in each summary cell after the element has been created\r\n        */\r\n        postRenderSummary: function (summary) {\r\n            var self = this;\r\n            var cells = summary.is(\"[data-bizagi-component=summary-cells]\") ? summary.children() : summary.find(\"[data-bizagi-component=summary-cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            self.onCellReady(column, \"summary\", cell, false);\r\n                        });\r\n                } else {\r\n                    self.onCellReady(column, \"summary\", $(cell), false);\r\n                }\r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Method to attach any handler to the grid\r\n        */\r\n        attachHandlers: function () { },\r\n\r\n        //TODO IMPLEMENTANDO\r\n        selectDynamicPager: function () {\r\n            this.onDynamicPager();\r\n        },\r\n\r\n        /*\r\n        *   Changes the current page in the grid\r\n        */\r\n        changePage: function (page) {\r\n            var self = this;\r\n            var currentPage = Number(self.data.page);\r\n            var total = self.data.total;\r\n            var newPage = page;\r\n\r\n            // Process previous page\r\n            if (page === \"previous\") {\r\n                if (currentPage > 1) {\r\n                    newPage = currentPage - 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // Process next page\r\n            if (page === \"next\") {\r\n                if (currentPage < total) {\r\n                    newPage = currentPage + 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            //refresh components cells and rows\r\n            self._cleanComponents();\r\n\r\n            // Update internal options\r\n            self.page = Number(newPage);\r\n\r\n            // Execute handler\r\n            self.onPageRequested();\r\n        },\r\n\r\n        /*\r\n        *  Verify cells before sumitonchange\r\n        */\r\n        isValid: function () {\r\n            // Trigger handler\r\n            return this._triggerHandler(\"isValid\");\r\n        },\r\n\r\n        /*\r\n        *   Sort the grid by a column\r\n        */\r\n        sortBy: function (columnIndex, sortType) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var column = self.columnByIndex[columnIndex];\r\n\r\n            if (typeof options.sortBy === \"undefined\") {\r\n                return true;\r\n            }\r\n\r\n            // Set new sort type reversed to current, if the sort column has not changed\r\n            if (typeof (column.name) === \"undefined\") column.name = column.label;\r\n            if (column.name == options.sortBy) {\r\n                sortType = sortType || (options.sortOrder == \"asc\" ? \"desc\" : \"asc\");\r\n            } else {\r\n                if (column.name == options.sortBy.split(\".\")[0]) {\r\n                    sortType = sortType || (options.sortType == \"asc\" ? \"desc\" : \"asc\");\r\n                } else {\r\n                    sortType = sortType || options.sortType;\r\n                }\r\n            }\r\n\r\n            // Update internal options\r\n            if (options.sortBy.split(\".\").length > 1) {\r\n                if (options.sortBy.split(\".\")[0] != column.name) {\r\n                    options.sortBy = column.name;\r\n                } else {\r\n                    options.sortBy = column.name;\r\n                }\r\n            } else {\r\n                options.sortBy = column.name;\r\n            }\r\n\r\n            if (typeof (column.bizAgiProperties.sortAttribute) !== \"undefined\" && column.bizAgiProperties.type.indexOf(\"column\") !== -1) {\r\n                options.sortBy = column.name + \".\" + column.bizAgiProperties.sortAttribute;\r\n            }\r\n\r\n            options.sortColumn = column;\r\n            options.sortType = sortType;\r\n            options.sortOrder = sortType;\r\n\r\n            //refresh components cells and rows\r\n            self._cleanComponents();\r\n\r\n            // Execute handler\r\n            self.onSortRequested();\r\n        },\r\n\r\n        /*\r\n        *   Selects a row in the grid\r\n        */\r\n        selectRow: function (key, businessKey) {\r\n            var self = this;\r\n\r\n            if (self.selectedRow == key) {\r\n                // Invoke un-select handler\r\n                self.onRowUnselected();\r\n\r\n                // Update internal options\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            } else {\r\n                if (self.selectedRow != 0) {\r\n                    // Invoke un-select handler\r\n                    self.onRowUnselected();\r\n                }\r\n\r\n                // Update internal options\r\n                self.selectedRow = key;\r\n                self.selectedBusinessKey = businessKey;\r\n\r\n                // Invoke select handler\r\n                self.onRowSelected();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Unselects a row in the grid\r\n        */\r\n        unselectRow: function () {\r\n            var self = this;\r\n\r\n            if (self.selectedRow != 0) {\r\n                // Invoke un-select handler\r\n                self.onRowUnselected();\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Calculates the summary for a column given the data\r\n        */\r\n        calculateSummary: function (column) {\r\n            var self = this;\r\n            var operation = column.summarizeBy;\r\n\r\n            //Consider the default values in the operations\r\n            $.each(self.data.rows, function (i, value) {\r\n                if (typeof self.data.rows[i][column.index] !== \"undefined\" && self.data.rows[i][column.index] == null && column.bizAgiProperties.defaultvalue != null) {\r\n                    self.data.rows[i][column.index] = column.bizAgiProperties.defaultvalue;\r\n                }\r\n            });\r\n            var columnValues = $.map(self.data.rows, function (row, i) { return row[column.index]; });\r\n            var result;\r\n\r\n            // Don't calculate anything if there are no rows\r\n            if (columnValues.length == 0) return 0;\r\n\r\n            // Resolve operations\r\n            if (operation === \"sum\") {\r\n                result = 0;\r\n                $.each(columnValues, function (i, value) { if (value != null) result += Number(value); });\r\n\r\n            } else if (operation === \"min\") {\r\n                result = columnValues[0] || 0;\r\n                $.each(columnValues, function (i, value) { if (typeof (value) === \"number\" && value != null && (value < result)) result = Number(value); });\r\n                if (result === Math.max()) result = null;\r\n\r\n            } else if (operation === \"max\") {\r\n                result = columnValues[0] || 0;\r\n                $.each(columnValues, function (i, value) { if (typeof (value) === \"number\" && value != null && (value > result)) result = Number(value); });\r\n                if (result === Math.min()) result = null;\r\n\r\n            } else if (operation === \"avg\") {\r\n                result = 0;\r\n                $.each(columnValues, function (i, value) { if (value != null) result += Number(value); });\r\n                result = result / columnValues.length;\r\n\r\n            } else if (operation === \"count\") {\r\n                result = 0;\r\n                columnValues = self.data.rows;\r\n\r\n                for (i = 0; i < columnValues.length; i++) {\r\n                    var columnValue = columnValues[i][column.index];\r\n\r\n                    if (columnValue instanceof Array && columnValue.length > 0) {\r\n                        result += 1;\r\n                    }\r\n                    else if (!(columnValue instanceof Array) && columnValue !== null && columnValue !== \"\") {\r\n                        result += 1;\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        /*\r\n        *   Process an action in order to do something with the grid\r\n        */\r\n        processAction: function (action, params) {\r\n            var self = this;\r\n\r\n            var key = params && params.key ? params.key : self.selectedBusinessKey;\r\n            if (action === \"edit\") {\r\n                self.onEditRow(key);\r\n            }\r\n            if (action === \"remove\") {\r\n                self.onDeleteRow(key);\r\n            }\r\n            if (action === \"more\") {\r\n                self.onShowMore(key);\r\n            }\r\n            if (action === \"details\") {\r\n                self.onShowDetails(key);\r\n            }\r\n            if (action === \"add\") {\r\n                self.onAddRow();\r\n            }\r\n\r\n            if (action === \"show-grid-export-options\") {\r\n                self.onShowExportGridOptions();\r\n            }\r\n        },\r\n        /*\r\n        *   Executes the page requested handler\r\n        */\r\n        onPageRequested: function () {\r\n            var self = this;\r\n\r\n            // Start loading signal \r\n            self.startLoading();\r\n\r\n            // Trigger handler\r\n            return self._triggerHandler(\"pageRequested\", self._buildRefreshParameters());\r\n        },\r\n        /*\r\n        *   Executes the sort requested handler\r\n        */\r\n        onSortRequested: function () {\r\n            var self = this;\r\n\r\n            // Start loading signal \r\n            self.startLoading();\r\n\r\n            // Trigger handler\r\n            return self._triggerHandler(\"sortRequested\", self._buildRefreshParameters());\r\n        },\r\n        /*\r\n        *   Executes the row selected handler\r\n        */\r\n        onRowSelected: function () {\r\n            var self = this;\r\n\r\n            return self._triggerHandler(\"rowSelected\", { key: self.selectedBusinessKey });\r\n        },\r\n        /*\r\n        *   Executes the row un-selected handler\r\n        */\r\n        onRowUnselected: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"rowUnselected\", { key: self.selectedBusinessKey });\r\n        },\r\n\r\n        /*\r\n        * Executes collapse grid\r\n        */\r\n        onCollapseGrid: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"performCollapseGrid\");\r\n        },\r\n\r\n        //TODO:llamar\r\n        onDynamicPager: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"moreRows\", { key: self.selectedBusinessKey });\r\n        },\r\n\r\n        /*\r\n        *   Executes the on draw cell handler\r\n        */\r\n        onDrawCell: function (column, key, value, isNewRow) {\r\n            var self = this;\r\n            return self._triggerHandler(\"drawCell\", { \r\n                column: column,\r\n                key: key,\r\n                value: value,\r\n                isNewRow: isNewRow \r\n            });\r\n        },\r\n        /*\r\n        *   Executes on cell ready handler\r\n        */\r\n        onCellReady: function (column, key, cell, isNewRow) {\r\n            var self = this;\r\n            return self._triggerHandler(\"cellReady\", { \r\n                column: column,\r\n                key: key,\r\n                cell: cell,\r\n                isNewRow: isNewRow \r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Executes the on draw control handler\r\n        */\r\n        onDrawControl: function () {\r\n            //TODO: Implement this\r\n        },\r\n        /*\r\n        *   Executes the on draw group header handler\r\n        */\r\n        onDrawGroupHeader: function () {\r\n            //TODO: Implement this\r\n        },\r\n        /*\r\n        *   Executes the on add row handler\r\n        */\r\n        onAddRow: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"addRow\");\r\n        },\r\n        /*\r\n        *   Executes the on edit row handler\r\n        */\r\n        onEditRow: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"editRow\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on delete row handler\r\n        */\r\n        onDeleteRow: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"deleteRow\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on show more handler\r\n        */\r\n        onShowMore: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"showMore\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on show details handler\r\n        */\r\n        onShowDetails: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"showFormDetails\", { key: key });\r\n        },\r\n        /*\r\n        * Executes the on show export grid options \r\n        */\r\n        onShowExportGridOptions: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"showGridExportOptions\");\r\n        },\r\n\r\n        /*\r\n        *   Replaces a matched element in the container for the specified \"replace\" element\r\n        */\r\n        _replaceElement: function (html, element, replace) {\r\n            return html.replace(\"{{element \" + element + \"}}\", replace);\r\n        },\r\n\r\n        /*\r\n        *   Return the event handler parameters object\r\n        */\r\n        _buildRefreshParameters: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var sortColumn = (options.sortColumn != undefined) ? options.sortColumn.index : 1;\r\n            return { \r\n                page: self.page,\r\n                sortBy: options.sortBy,\r\n                sortType: options.sortOrder,\r\n                sortColumnIndex: sortColumn\r\n            };\r\n        },\r\n        /*\r\n        *   Calls directly to handler callback\r\n        */\r\n        _triggerHandler: function (type, data) {\r\n            var callback = this.options[type];\r\n            if (!callback) {\r\n                return null;\r\n            }\r\n            return callback.call(this.element[0], data);\r\n        },\r\n        /*\r\n        *   Gets the component\r\n        */\r\n        _getComponent: function (component) {\r\n            var self = this;\r\n            var element = self.element;\r\n            if (!self.components[component]) {\r\n                var foundComponent = $(\"[data-bizagi-component=\" + component + \"]\", element);\r\n                if (foundComponent != null && foundComponent.length > 0) {\r\n                    self.components[component] = foundComponent;\r\n                }\r\n            }\r\n            return self.components[component];\r\n        },\r\n        /*\r\n        *   Gets the specific Button\r\n        */\r\n        _getButton: function (button) {\r\n            var self = this;\r\n            var element = self.element;\r\n            if (!self.buttons[button])\r\n                self.buttons[button] = $(\"[data-action=\" + button + \"]\", element);\r\n            return self.buttons[button];\r\n        },\r\n        /*\r\n        * Cleans the components \r\n        */\r\n        _cleanComponents: function () {\r\n            var self = this;\r\n            self.components = {};\r\n        },\r\n        /*\r\n        * Cleans the buttons \r\n        */\r\n        _cleanButtons: function () {\r\n            var self = this;\r\n            self.buttons = {};\r\n        },\r\n        /*\r\n        *  Template method to check if buttons component must be rendered\r\n        */\r\n        _canShowButtons: function () {\r\n            return true;\r\n        },\r\n        /*\r\n        *  Template method to check if row buttons must be displayed when the row is selected\r\n        */\r\n        _canShowRowButtons: function(){\r\n            return true;\r\n        }\r\n\r\n    });\r\n})(jQuery);\r\n","/*\r\n*   Name: Bizagi Grid for Smartphone\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This widget will extend the bizagi grid widget to specialize into a smartPhone view\r\n*\r\n*   \r\n*\r\n*   Styles:\r\n*   - css/bizagi/smarpthone/controls/bizagi.grid.css\r\n*/\r\n\r\n(function ($) {\r\n    $.widget('ui.bizagi_grid_smartphone', $.ui.bizagi_grid, {\r\n\r\n        /*\r\n        *   Method to attach any handler to the grid\r\n        */\r\n        attachHandlers: function () {\r\n            var self = this;\r\n\r\n            // Add paging events\r\n            var pager = self._getComponent(\"pager\");\r\n            pager.on(\"click\", \"div.bz-btn-icn\", function () {\r\n                var pageNumber = $(this).attr(\"data-page-number\");\r\n                if (pageNumber && self.isValid()) {\r\n                    self.changePage(pageNumber);\r\n                }\r\n            });\r\n\r\n            pager.on(\"change\", \"input\", function () {\r\n                var page = this.value;\r\n                if (page && self.isValid()) {\r\n                    var _input = this;\r\n                    self.changePage(page, /*success*/function () { }, /*fail*/function () {\r\n                        _input.value = self.page;\r\n                    });\r\n                }\r\n            });\r\n\r\n            if (self._getComponent(\"buttons\") != undefined) {\r\n                var items = [];\r\n                if (self.options.actions.add) {\r\n                    items.push({\r\n                        name: bizagi.localization.getResource(\"render-grid-add-label\"),\r\n                        fn: function () {\r\n                            self.processAction(\"add\");\r\n                            self.unselectRow();\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (self.options.actions.hasTotalizer) {\r\n                    items.push({\r\n                        name: \"Totalizer\", // TODO: Add resource\r\n                        fn: function () {\r\n                            self.totalizer();\r\n                        }\r\n                    });\r\n                }\r\n\r\n                self._getComponent(\"buttons\").find(\".bz-btn-icn\").overflowMenu({ items: items });\r\n            }\r\n\r\n            // Bind special cell button action\r\n            var _row_buttons = self._getComponent(\"rowButtons\");\r\n            if (_row_buttons){\r\n                _row_buttons.on(\"click\", \"[data-action]\", function () {\r\n                    self.processAction($(this).attr(\"data-action\"), {});\r\n                });\r\n            } \r\n        },\r\n        /* popup Total\r\n         *\r\n         */\r\n        totalizer: function () {\r\n            var self = this;\r\n            self.options.totalData();\r\n        },\r\n\r\n        /*totalData\r\n         *   prepare totalizer\r\n        */\r\n        draw: function () {\r\n            var self = this;\r\n            self._super();\r\n            var verifyTotalizer = self.options.actions.totalizer;\r\n            if (self.data.rows.length == 0) {\r\n                var rowButtons =  self._getComponent(\"rowButtons\");\r\n                if (rowButtons){\r\n                    rowButtons.hide();\r\n                }\r\n                self.element.addClass(\"bz-mobile-grid--empty\");\r\n            }\r\n            //Verify totalizer to activate action sheet\r\n            if (verifyTotalizer) {\r\n                if (typeof self.actualActionSheet != \"undefined\" && !bizagi.util.isObjectEmpty(self.actualActionSheet)) {\r\n                    self.actualActionSheet.data(\"kendoMobileActionSheet\").destroy();\r\n                }\r\n\r\n                self.actualActionSheet = self.element.find(\"#ui-bizagi-menu-totalizer\").kendoMobileActionSheet();\r\n            }\r\n\r\n            //hide loader\r\n            bizagi.util.smartphone.stopLoading();\r\n        },\r\n\r\n        drawRow: function (rowData, isNewRow) {\r\n            this.selectedBusinessKey = rowData[this.columnKeyIndex];\r\n            return this._super(rowData, isNewRow);\r\n        },\r\n\r\n        changePage: function (page, success_callback, fail_callback) {\r\n            var self = this;\r\n            var currentPage = Number(self.data.page);\r\n            //in the smartphone the original  self.data.total is always 1  this change to self.data.records refers in this case a total pages\r\n            var total = self.data.records;\r\n            var newPage = page;\r\n\r\n            // Process previous page\r\n            if (page == \"previous\") {\r\n                if (currentPage > 1) newPage = currentPage - 1;\r\n                else {\r\n                    if (fail_callback) fail_callback();\r\n                    return;\r\n                }\r\n            }\r\n            // Process next page\r\n            if (page == \"next\") {\r\n                if (currentPage < total) newPage = currentPage + 1;\r\n                else {\r\n                    if (fail_callback) fail_callback();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (page !== \"next\" && page !== \"previous\" && typeof page === \"string\") {\r\n                try {\r\n                    newPage = Number(page);\r\n                }\r\n                catch (e) {\r\n                    if (fail_callback) fail_callback();\r\n                    return;\r\n                }\r\n                if (newPage == NaN || newPage > total || newPage < 0) {\r\n                    if (fail_callback) fail_callback();\r\n                    return;\r\n                };\r\n            }\r\n\r\n            //show loader\r\n            bizagi.util.smartphone.startLoading();\r\n            setTimeout(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            }, 1000);\r\n\r\n            // Update internal options\r\n            self.page = Number(newPage);\r\n\r\n            // Execute handler\r\n            self.onPageRequested();\r\n            if (success_callback) {\r\n                success_callback();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Executes the row selected handler\r\n        */\r\n        onRowSelected: function () {\r\n            var self = this;\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowSelected.apply(self, arguments);\r\n        },\r\n\r\n        /*\r\n        *   Executes the row un-selected handler\r\n        */\r\n        onRowUnselected: function () {\r\n            var self = this;\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowUnselected.apply(self, arguments);\r\n        },\r\n\r\n        /*\r\n        *  Template method to check if buttons component must be rendered\r\n        */\r\n        _canShowButtons: function () {\r\n            var self = this;\r\n            var actions = self.options.actions;\r\n            return actions[\"add\"] || actions[\"edit\"] || actions[\"remove\"]  || actions[\"details\"];\r\n        },\r\n\r\n        /*\r\n        *  Template method to check if row buttons must be displayed when the row is selected\r\n        */\r\n        _canShowRowButtons: function () {\r\n            var self = this;\r\n            var actions = self.options.actions;\r\n            return actions[\"edit\"] || actions[\"remove\"];\r\n        },\r\n\r\n        /*\r\n        *   Return the new created ids\r\n        */\r\n        getNewRowKeys: function () {\r\n            var self = this;\r\n            var rows = self._getComponent(\"rows\").find(\"[data-new-row]\");\r\n            return $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n        },\r\n\r\n\r\n        /*\r\n        *   Show the row buttons\r\n        */\r\n        _showRowButtons: function () {\r\n        },\r\n\r\n        /*\r\n        *   Hide the row buttons\r\n        */\r\n        _hideRowButtons: function () {\r\n        },\r\n\r\n        /**\r\n         * Replaces a matched element in the container for the specified \"replace\" element\r\n         * @param html\r\n         * @param element\r\n         * @param replace\r\n         * @returns {*}\r\n         * @private\r\n         */\r\n        _replaceElement: function (html, element, replace) {\r\n            return html.replace(new RegExp(\"{{element \" + element + \"}}\", 'g'), replace);\r\n        },\r\n        \r\n        /**\r\n         * Check if row its new\r\n         * @param {} businessKey\r\n         * @returns {}\r\n         */\r\n        isNewRecord: function (businessKey) {\r\n            var self = this;\r\n            var row = self._getComponent(\"rows\");\r\n\r\n            if (row) {\r\n                businessKey = row.find(\"[data-business-key='\" + businessKey + \"']\");\r\n                if ($(businessKey).data(\"new-row\")) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n    });\r\n\r\n})(jQuery);\r\n","/*\r\n *   Name: BizAgi Utils\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide misc helpers to all modules\r\n */\r\n\r\n// Create or Define BizAgi namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\nbizagi.util.smartphone = (typeof (bizagi.util.smartphone) !== \"undefined\") ? bizagi.util.smartphone : {};\r\nbizagi.util.tablet = (typeof (bizagi.util.tablet) !== \"undefined\") ? bizagi.util.tablet : {};\r\n\r\nvar DEVICES = {};\r\n\r\nDEVICES[DEVICES['desktop'] = 0] = 'desktop';\r\nDEVICES[DEVICES['smartphone'] = 1] = 'smartphone';\r\nDEVICES[DEVICES['tablet'] = 2] = 'tablet';\r\n\r\nbizagi.deviceEnum = DEVICES;\r\n\r\n/*\r\n *   Define mini-plugin to acceess iframe's boundaries\r\n */\r\n(function ($) {\r\n    $.fn.callInside = function (fx, args) {\r\n        if ($(this)[0].tagName.toLowerCase() != \"iframe\")\r\n            return null;\r\n        // Don't execute the code when the content window is not ready yet    \r\n        if ($(this)[0].contentWindow == null)\r\n            return null;\r\n        // Check if the iframe is cross domain\r\n        try {\r\n            // Evals the content\r\n            $(this)[0].contentWindow.args = args;\r\n        } catch (e) {\r\n            // If an exception is thrown here this is a cross domain access\r\n            return null;\r\n        }\r\n\r\n        if ($.browser.msie) {\r\n            return $(this)[0].contentWindow.execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        } else if ($.browser.webkit || $.browser.mozilla) {\r\n            return $(this)[0].contentWindow.eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        }\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n    $.fn.callInsidePopup = function (fx, args) {\r\n        // This is window here\r\n        var self = this;\r\n        $(document).ready(function () {\r\n            // Check if the iframe is cross domain\r\n            try {\r\n                // Evals the content\r\n                $(self)[0].args = args;\r\n            } catch (e) {\r\n                // If an exception is thrown here this is a cross domain access\r\n                return null;\r\n            }\r\n\r\n            if ($.browser.msie) {\r\n                return $(self)[0].execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            } else if ($.browser.webkit || $.browser.mozilla) {\r\n                return $(self)[0].eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            }\r\n\r\n        });\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n\r\n    // add support for CSS functions for \"setProperty\" in ie8\r\n    var isStyleFuncSupported = !!CSSStyleDeclaration.prototype.getPropertyValue;\r\n    if (!isStyleFuncSupported) {\r\n        CSSStyleDeclaration.prototype.getPropertyValue = function (a) {\r\n            return this.getAttribute(a);\r\n        };\r\n        CSSStyleDeclaration.prototype.setProperty = function (styleName, value, priority) {\r\n            this.setAttribute(styleName, value);\r\n            var priority = typeof priority != 'undefined' ? priority : '';\r\n            if (priority != '') {\r\n                // Add priority manually\r\n                var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*' + RegExp.escape(value) + '(\\\\s*;)?', 'gmi');\r\n                this.cssText = this.cssText.replace(rule, styleName + ': ' + value + ' !' + priority + ';');\r\n            }\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.removeProperty = function (a) {\r\n            return this.removeAttribute(a);\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.getPropertyPriority = function (styleName) {\r\n            var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*[^\\\\s]*\\\\s*!important(\\\\s*;)?', 'gmi');\r\n            return rule.test(this.cssText) ? 'important' : '';\r\n        };\r\n    }\r\n\r\n    // Escape regex chars with \\\r\n    RegExp.escape = function (text) {\r\n        return text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n    };\r\n\r\n    // The style function\r\n    jQuery.fn.style = function (styleName, value, priority) {\r\n        // DOM node\r\n        var node = this.get(0);\r\n        // Ensure we have a DOM node \r\n        if (typeof node == 'undefined') {\r\n            return;\r\n        }\r\n        // CSSStyleDeclaration\r\n        var style = this.get(0).style;\r\n        // Getter/Setter\r\n        if (typeof styleName != 'undefined') {\r\n            if (typeof value != 'undefined') {\r\n                // Set style property\r\n                var priority = typeof priority != 'undefined' ? priority : '';\r\n                // Hack to IE8\r\n                if (style.setProperty) {\r\n                    style.setProperty(styleName, value, priority);\r\n                } else {\r\n                    style.setAttribute(styleName, value, priority);\r\n                }\r\n            } else {\r\n                // Get style property\r\n\r\n                return style.getPropertyValue(styleName);\r\n            }\r\n        } else {\r\n            // Get CSSStyleDeclaration\r\n            return style;\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.nl2br = function (value) {\r\n        return value.replace(/(\\r\\n|\\n\\r|\\r|\\n|\\\\r\\\\n|\\\\n\\\\r|\\\\r|\\\\n)/g, \"<br>\");\r\n    };\r\n})(jQuery);\r\n\r\n\r\n\r\n(function ($) {\r\n    jQuery.br2nl = function (value) {\r\n        return value.replace(/\\r\\n|\\r|\\n/g, \"\\r\");\r\n    };\r\n})(jQuery);\r\n\r\n/**\r\n *   Can be compare control between their intance value and existing value\r\n */\r\n//TODO: DEPL- Please move this out of here, this is rendering logic, it must exists as a function for the render, and every erender could override its implementation\r\n(function ($) {\r\n    jQuery.controlValueIsChanged = function (control) {\r\n        var self = control;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (control.properties.type == \"grid\" && control.ready().state() == \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\", \"radio\", \"queryRadio\", \"queryState\", ].includes(properties.type) || /^cascadingcombo$/i.test(properties.type)) {\r\n            if (value && value.length !== undefined)\r\n                value = value[0];\r\n            if (compareValue && compareValue.length !== undefined)\r\n                compareValue = compareValue[0];\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            result = (compareValue == value) ? false : true;\r\n        } else if (properties.type == \"boolean\" || properties.type == \"queryBoolean\" || properties.type == \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (properties.type == \"searchNumber\") {\r\n\r\n            result = (value) ? true : false;\r\n        } else if (properties.type === \"date\") {\r\n            result = (new Date(compareValue).getTime()) !== (new Date(value).getTime());\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.getMaxZindex = function () {\r\n        var elm = $(\"*\");\r\n        var maxZindex = 1;\r\n\r\n        $.each(elm, function (key, value) {\r\n            var zindex = parseInt($(value).css(\"z-index\"));\r\n            if (zindex > maxZindex) {\r\n                maxZindex = zindex + 1;\r\n            }\r\n\r\n        });\r\n\r\n        return maxZindex;\r\n    }\r\n})(jQuery);\r\n\r\n/**\r\n * Set the same max height to multiples divs\r\n */\r\n(function ($) {\r\n    jQuery.equalizeHeights = function (selector) {\r\n        var heights = new Array();\r\n        // Loop to get all element heights\r\n        $(selector).each(function () {\r\n\r\n            // Need to let sizes be whatever they want so no overflow on resize\r\n            $(this).css('min-height', '0');\r\n            $(this).css('max-height', 'none');\r\n            $(this).css('height', 'auto');\r\n\r\n            // Then add size (no units) to array\r\n            heights.push($(this).outerHeight());\r\n        });\r\n\r\n        // Find max height of all elements\r\n        var max = Math.max.apply(Math, heights);\r\n\r\n        // Set all heights to max height\r\n        $(selector).each(function () {\r\n            $(this).css('height', max + 'px');\r\n        });\r\n    }\r\n})(jQuery);\r\n\r\n//TODO: DEPL - Move this to rendering\r\nbizagi.util.autoSave = function () {\r\n    var deferredSave = $.Deferred();\r\n\r\n    //if attr data-event exist trigger event auto-save or resolve the deferred\r\n    if (bizagi.util.detectDevice() !== \"desktop\") {\r\n        if ($(document).data('auto-save')) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    } else {\r\n        if ($._data($(document)[0], 'events')[\"save-form\"] && $._data($(document)[0], 'events')[\"save-form\"].length > 0) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    }\r\n    return deferredSave.promise();\r\n};\r\n//--  **Users Deleted** the name will fill on first reques in UsersPictures\r\nbizagi.util.anonymizedUserInformation = {\r\n    id: \"00000000-0000-0000-0000-000000000000\",\r\n    name: \"\",\r\n    username: \"\",\r\n    email: \"\",\r\n    domain: \"\",\r\n    picture: \"\",\r\n    isAnonymized: true\r\n};\r\n\r\n//-- **Resources for date picker**\r\nbizagi.util.datepickerResource=[];\r\n// taken  from https://github.com/jquery/jquery-ui/tree/master/ui/i18n\r\nbizagi.util.datepickerResource[\"en\"]={ closeText: \"Done\", prevText: \"Prev\",nextText: \"Next\",currentText: \"Today\",monthNames: [ \"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\" ],monthNamesShort: [ \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\" ],dayNames: [ \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\" ],dayNamesShort: [ \"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\" ],dayNamesMin: [ \"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\" ],weekHeader: \"Wk\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"es\"]={ closeText: \"Cerrar\", prevText: \"&#x3C;Ant\",nextText: \"Sig&#x3E;\",currentText: \"Hoy\",monthNames: [ \"enero\",\"febrero\",\"marzo\",\"abril\",\"mayo\",\"junio\",\"julio\",\"agosto\",\"septiembre\",\"octubre\",\"noviembre\",\"diciembre\" ],monthNamesShort: [ \"ene\",\"feb\",\"mar\",\"abr\",\"may\",\"jun\",\"jul\",\"ago\",\"sep\",\"oct\",\"nov\",\"dic\" ],dayNames: [ \"domingo\",\"lunes\",\"martes\",\"miércoles\",\"jueves\",\"viernes\",\"sábado\" ],dayNamesShort: [ \"dom\",\"lun\",\"mar\",\"mié\",\"jue\",\"vie\",\"sáb\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"X\",\"J\",\"V\",\"S\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ar\"]={ closeText: \"إغلاق\", prevText: \"&#x3C;السابق\",nextText: \"التالي&#x3E;\",currentText: \"اليوم\",monthNames: [ \"يناير\", \"فبراير\", \"مارس\", \"أبريل\", \"مايو\", \"يونيو\",\"يوليو\", \"أغسطس\", \"سبتمبر\", \"أكتوبر\", \"نوفمبر\", \"ديسمبر\" ],monthNamesShort: [ \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\" ],dayNames: [ \"الأحد\", \"الاثنين\", \"الثلاثاء\", \"الأربعاء\", \"الخميس\", \"الجمعة\", \"السبت\" ],dayNamesShort: [ \"أحد\", \"اثنين\", \"ثلاثاء\", \"أربعاء\", \"خميس\", \"جمعة\", \"سبت\" ],dayNamesMin: [ \"ح\", \"ن\", \"ث\", \"ر\", \"خ\", \"ج\", \"س\" ],weekHeader: \"أسبوع\",dateFormat: \"dd/mm/yy\",firstDay: 0,isRTL: true,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"cs\"]={ closeText: \"Zavřít\", prevText: \"&#x3C;Dříve\",nextText: \"Později&#x3E;\",currentText: \"Nyní\",monthNames: [ \"leden\",\"únor\",\"březen\",\"duben\",\"květen\",\"červen\",\"červenec\",\"srpen\",\"září\",\"říjen\",\"listopad\",\"prosinec\" ],monthNamesShort: [ \"led\",\"úno\",\"bře\",\"dub\",\"kvě\",\"čer\",\"čvc\",\"srp\",\"zář\",\"říj\",\"lis\",\"pro\" ],dayNames: [ \"neděle\", \"pondělí\", \"úterý\", \"středa\", \"čtvrtek\", \"pátek\", \"sobota\" ],dayNamesShort: [ \"ne\", \"po\", \"út\", \"st\", \"čt\", \"pá\", \"so\" ],dayNamesMin: [ \"ne\",\"po\",\"út\",\"st\",\"čt\",\"pá\",\"so\" ],weekHeader: \"Týd\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"de\"]={ closeText: \"Schließen\", prevText: \"&#x3C;Zurück\",nextText: \"Vor&#x3E;\",currentText: \"Heute\",monthNames: [ \"Januar\",\"Februar\",\"März\",\"April\",\"Mai\",\"Juni\",\"Juli\",\"August\",\"September\",\"Oktober\",\"November\",\"Dezember\" ],monthNamesShort: [ \"Jan\",\"Feb\",\"Mär\",\"Apr\",\"Mai\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Okt\",\"Nov\",\"Dez\" ],dayNames: [ \"Sonntag\",\"Montag\",\"Dienstag\",\"Mittwoch\",\"Donnerstag\",\"Freitag\",\"Samstag\" ],dayNamesShort: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],dayNamesMin: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],weekHeader: \"KW\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"fr\"]={ closeText: \"Fermer\", prevText: \"Précédent\",nextText: \"Suivant\",currentText: \"Aujourd'hui\",monthNames: [ \"janvier\", \"février\", \"mars\", \"avril\", \"mai\", \"juin\",\"juillet\", \"août\", \"septembre\", \"octobre\", \"novembre\", \"décembre\" ],monthNamesShort: [ \"janv.\", \"févr.\", \"mars\", \"avr.\", \"mai\", \"juin\", \"juil.\", \"août\", \"sept.\", \"oct.\", \"nov.\", \"déc.\" ],dayNames: [ \"dimanche\", \"lundi\", \"mardi\", \"mercredi\", \"jeudi\", \"vendredi\", \"samedi\" ],dayNamesShort: [ \"dim.\", \"lun.\", \"mar.\", \"mer.\", \"jeu.\", \"ven.\", \"sam.\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"M\",\"J\",\"V\",\"S\" ],weekHeader: \"Sem.\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"it\"]={ closeText: \"Chiudi\", prevText: \"&#x3C;Prec\",nextText: \"Succ&#x3E;\",currentText: \"Oggi\",monthNames: [ \"Gennaio\",\"Febbraio\",\"Marzo\",\"Aprile\",\"Maggio\",\"Giugno\",\"Luglio\",\"Agosto\",\"Settembre\",\"Ottobre\",\"Novembre\",\"Dicembre\" ],monthNamesShort: [ \"Gen\",\"Feb\",\"Mar\",\"Apr\",\"Mag\",\"Giu\",\"Lug\",\"Ago\",\"Set\",\"Ott\",\"Nov\",\"Dic\" ],dayNames: [ \"Domenica\",\"Lunedì\",\"Martedì\",\"Mercoledì\",\"Giovedì\",\"Venerdì\",\"Sabato\" ],dayNamesShort: [ \"Dom\",\"Lun\",\"Mar\",\"Mer\",\"Gio\",\"Ven\",\"Sab\" ],dayNamesMin: [ \"Do\",\"Lu\",\"Ma\",\"Me\",\"Gi\",\"Ve\",\"Sa\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ja\"]={ closeText: \"閉じる\", prevText: \"&#x3C;前\",nextText: \"次&#x3E;\",currentText: \"今日\",monthNames: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],monthNamesShort: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],dayNames: [ \"日曜日\",\"月曜日\",\"火曜日\",\"水曜日\",\"木曜日\",\"金曜日\",\"土曜日\" ],dayNamesShort: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],dayNamesMin: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],weekHeader: \"週\",dateFormat: \"yy/mm/dd\",firstDay: 0,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\nbizagi.util.datepickerResource[\"nl\"]={ closeText: \"Sluiten\", prevText: \"←\",nextText: \"→\",currentText: \"Vandaag\",monthNames: [ \"januari\", \"februari\", \"maart\", \"april\", \"mei\", \"juni\",\"juli\", \"augustus\", \"september\", \"oktober\", \"november\", \"december\" ],monthNamesShort: [ \"jan\", \"feb\", \"mrt\", \"apr\", \"mei\", \"jun\",\"jul\", \"aug\", \"sep\", \"okt\", \"nov\", \"dec\" ],dayNames: [ \"zondag\", \"maandag\", \"dinsdag\", \"woensdag\", \"donderdag\", \"vrijdag\", \"zaterdag\" ],dayNamesShort: [ \"zon\", \"maa\", \"din\", \"woe\", \"don\", \"vri\", \"zat\" ],dayNamesMin: [ \"zo\", \"ma\", \"di\", \"wo\", \"do\", \"vr\", \"za\" ],weekHeader: \"Wk\",dateFormat: \"dd-mm-yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"pt\"]={ closeText: \"Fechar\", prevText: \"Anterior\",nextText: \"Seguinte\",currentText: \"Hoje\",monthNames: [ \"Janeiro\",\"Fevereiro\",\"Março\",\"Abril\",\"Maio\",\"Junho\",\"Julho\",\"Agosto\",\"Setembro\",\"Outubro\",\"Novembro\",\"Dezembro\" ],monthNamesShort: [ \"Jan\",\"Fev\",\"Mar\",\"Abr\",\"Mai\",\"Jun\",\"Jul\",\"Ago\",\"Set\",\"Out\",\"Nov\",\"Dez\" ],dayNames: [\"Domingo\",\"Segunda-feira\",\"Terça-feira\",\"Quarta-feira\",\"Quinta-feira\",\"Sexta-feira\",\"Sábado\"],dayNamesShort: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],dayNamesMin: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],weekHeader: \"Sem\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ru\"]={ closeText: \"Закрыть\", prevText: \"&#x3C;Пред\",nextText: \"След&#x3E;\",currentText: \"Сегодня\",monthNames: [ \"Январь\",\"Февраль\",\"Март\",\"Апрель\",\"Май\",\"Июнь\",\"Июль\",\"Август\",\"Сентябрь\",\"Октябрь\",\"Ноябрь\",\"Декабрь\" ],monthNamesShort: [ \"Янв\",\"Фев\",\"Мар\",\"Апр\",\"Май\",\"Июн\",\"Июл\",\"Авг\",\"Сен\",\"Окт\",\"Ноя\",\"Дек\" ],dayNames: [ \"воскресенье\",\"понедельник\",\"вторник\",\"среда\",\"четверг\",\"пятница\",\"суббота\" ],dayNamesShort: [ \"вск\",\"пнд\",\"втр\",\"срд\",\"чтв\",\"птн\",\"сбт\" ],dayNamesMin: [ \"Вс\",\"Пн\",\"Вт\",\"Ср\",\"Чт\",\"Пт\",\"Сб\" ],weekHeader: \"Нед\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"zh\"]={ closeText: \"关闭\", prevText: \"&#x3C;上月\",nextText: \"下月&#x3E;\",currentText: \"今天\",monthNames: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],monthNamesShort: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],dayNames: [ \"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\" ],dayNamesShort: [ \"周日\",\"周一\",\"周二\",\"周三\",\"周四\",\"周五\",\"周六\" ],dayNamesMin: [ \"日\",\"一\",\"二\",\"三\",\"四\",\"五\",\"六\" ],weekHeader: \"周\",dateFormat: \"yy-mm-dd\",firstDay: 1,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\n\r\n//--  **Communication between Workportal and LiveProcesses**\r\n\r\n// Create new Live Process\r\nbizagi.util.liveProcessesEvents = bizagi.util.liveProcessesEvents || {};\r\nbizagi.util.liveProcessesEvents.newLiveProcess = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.newLiveProcess.initEvent('new-live-process', true, true);\r\n\r\n// Event for changing route inside LiveProcesses\r\nbizagi.util.liveProcessesEvents.routeEvents = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.routeEvents.initEvent('parent-route-events', true, true);\r\nbizagi.util.liveProcessesEvents.routeEvents.route = '/';\r\n\r\n// Verify save condition\r\nbizagi.util.liveProcessesEvents.saveEvent = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.saveEvent.initEvent('save-live', true, true);\r\nbizagi.util.liveProcessesEvents.saveEvent.lastWidget = '';\r\nbizagi.util.liveProcessesEvents.saveEvent.nextWidget = '';\r\n\r\nbizagi.util.liveSave = function (widgetName) {\r\n    bizagi.util.liveProcessesEvents.saveEvent.nextWidget = widgetName;\r\n    var deferredLiveSave = $.Deferred();\r\n    var indeX = 0;\r\n    // next try/catch avoids crossdomain messages in the middle of \"Next button\" execution\r\n    try {\r\n        indeX = $(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess');\r\n    }\r\n    catch (e) {\r\n        indeX = -1;\r\n    }\r\n    if (\r\n        (widgetName !== bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY || widgetName === bizagi.util.liveProcessesEvents.saveEvent.lastWidget) &&\r\n        $(document).find('iframe').length > 0 && (indeX > 0)\r\n    ) {\r\n        bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise = deferredLiveSave;\r\n        document.dispatchEvent(bizagi.util.liveProcessesEvents.saveEvent);\r\n    } else {\r\n        deferredLiveSave.resolve();\r\n    }\r\n    $.when(deferredLiveSave).done(function () { bizagi.util.liveProcessesEvents.saveEvent.lastWidget = widgetName })\r\n    return deferredLiveSave.promise();\r\n};\r\n\r\n/**\r\n * CryptoJS MD5\r\n * @param {} message\r\n * @returns {}\r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */\r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n/**\r\n * Replace all coincidences in a text, based on key value object\r\n *  @argument mapDataToReplace = {\"keyTofind\":\"valueToReplace\",...}\r\n */\r\nbizagi.util.multiReplace = function (text, mapDataToReplace) {\r\n    mapDataToReplace = mapDataToReplace || {};\r\n\r\n    for (var key in mapDataToReplace) {\r\n        var reg = new RegExp(key, \"g\");\r\n        text = text.replace(reg, mapDataToReplace[key]);\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Creates a replace all method that is left from the String Class\r\n */\r\nbizagi.util.replaceAll = function (text, pcFrom, pcTo) {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.replaceAll(text, pcFrom, pcTo);\r\n};\r\n/*\r\n *replaces global expressions regulars\r\n */\r\nbizagi.util.replaceAllGlobalRegExp = function (text, pcFrom, pcTo) {\r\n    var temp = text;\r\n\r\n    var re = new RegExp(pcFrom, \"g\");\r\n    temp = temp.replace(re, pcTo);\r\n\r\n    return temp.toString();\r\n};\r\n// Also append it to the string class\r\nString.prototype.replaceAll = function (pcFrom, pcTo) {\r\n    return bizagi.util.replaceAll(this, pcFrom, pcTo);\r\n};\r\n// Capitalize a string\r\nString.prototype.capitalize = function () {\r\n    return this.charAt(0).toUpperCase() + this.slice(1);\r\n};\r\n// Add this (Create an starts with function) to the string prototype\r\nString.prototype.startsWith = function (str) {\r\n    return this.slice(0, str.length) == str;\r\n};\r\n\r\n/**\r\n * get Initials of a string/name and if the name is empty return the anonymized icon\r\n */\r\nString.prototype.getInitials = function () {\r\n    var initials = \"\";\r\n    if (this.length===0) {\r\n        initials = '<svg  class=\"bz-icon bz-icon-24 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#icon-user-deactivated\"></use></svg>';\r\n    } else {\r\n        try {\r\n            var removeRepeatSpaces = this.replace(/  +/g, ' ');\r\n            var words = removeRepeatSpaces.split(' ');\r\n            for (var i = 0; i < words.length; i += 1) {\r\n                initials += words[i][0] || '';\r\n                if (initials.length == 2) {\r\n                    break;\r\n                }\r\n            }\r\n        } catch (e) { }\r\n    \r\n        initials = initials.toUpperCase();\r\n    }\r\n    return initials;\r\n};\r\n\r\nMath.sign = Math.sign || function (x) {\r\n    x = +x; // convert to a number\r\n    if (x === 0 || isNaN(x)) {\r\n        return x;\r\n    }\r\n    return x > 0 ? 1 : -1;\r\n}\r\n\r\n// Add a clone to the object prototype\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n// Measures the pixel size of a string\r\nbizagi.measureString = function (string, fontSize) {\r\n    var test = $(\"<span/>\").appendTo(\"body\");\r\n    test.text(string);\r\n    if (fontSize)\r\n        test.css(\"font-size\", fontSize);\r\n    var width = test.width();\r\n    test.detach();\r\n    return width;\r\n};\r\n/*\r\n *   Creates a trim method\r\n */\r\nbizagi.util.trim = function (text) {\r\n    if (typeof (text) === \"undefined\" || text == null)\r\n        return text;\r\n    // Call the method located in bizagi.loader\r\n    return text.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n};\r\n// Create an ends with function\r\nString.prototype.endsWith = function (suffix) {\r\n    return this.indexOf(suffix, this.length - suffix.length) !== -1;\r\n};\r\n\r\n/*\r\n * Method to detect IE7 visitors\r\n */\r\nbizagi.util.isIE7 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 7;\r\n};\r\n/*\r\n * Method to detect IE8 visitors\r\n */\r\nbizagi.util.isIE8 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 8;\r\n};\r\n/*\r\n * Method to detect IE9 visitors\r\n */\r\nbizagi.util.isIE9 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 9;\r\n};\r\n/*\r\n * Method to detect IE10 visitors\r\n */\r\nbizagi.util.isIE10 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 10;\r\n};\r\n/*\r\n * Method to detect IE11 visitors\r\n */\r\nbizagi.util.isIE11 = function () {\r\n    return !!navigator.userAgent.match(/Trident\\/7.0/) && !navigator.userAgent.match(/MSIE/i);\r\n};\r\n\r\n/*\r\n * Method to detect IE11 or lower\r\n */\r\nbizagi.util.isIE11OrLower = function () {\r\n    return bizagi.util.isIE11() || bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE10 or lower\r\n */\r\nbizagi.util.isIE10OrLower = function () {\r\n    return bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE12 or Edge(Windows 10) visitors\r\n */\r\nbizagi.util.isEdge = function () {\r\n    if (/Edge\\/*./i.test(navigator.userAgent)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n/*\r\n * Method to detect IE visitors\r\n */\r\nbizagi.util.isIE = function () {\r\n    return (navigator.appName.indexOf(\"Internet Explorer\") > 0 || !!navigator.userAgent.match(/Trident/));\r\n};\r\n/*\r\n * Get the specific version of IE \r\n */\r\nbizagi.util.getIEVersion = function () {\r\n    var sAgent = window.navigator.userAgent;\r\n    var indexMSIE = sAgent.indexOf(\"MSIE\");\r\n    var version = 0;\r\n    if (indexMSIE > 0) {\r\n        version = parseInt(sAgent.substring(indexMSIE + 5, sAgent.indexOf(\".\", indexMSIE)));\r\n    } else\r\n        if (!!navigator.userAgent.match(/Trident/) || window.navigator.userAgent.indexOf(\"Edge\") > -1) { // Condition Check IF IE 11 and or MS Edge\r\n            version = 11;\r\n        }\r\n    return version;\r\n};\r\n/*\r\n * Method to detect is chrome browser\r\n */\r\nbizagi.util.isChrome = function () {\r\n    return /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\r\n};\r\n/*\r\n * Method to detect is Firefox browser\r\n */\r\nbizagi.util.isFirefox = function(minVersion) {\r\n    function getVersion() {\r\n        var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || []; \r\n        if(/trident/i.test(M[1])){\r\n            tem=/\\brv[ :]+(\\d+)/g.exec(ua) || []; \r\n            return {name:'IE',version:(tem[1]||'')};\r\n            }   \r\n        if(M[1]==='Chrome'){\r\n            tem=ua.match(/\\bOPR|Edge\\/(\\d+)/)\r\n            if(tem!=null)   {return {name:'Opera', version:tem[1]};}\r\n            }   \r\n        M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];\r\n        if((tem=ua.match(/version\\/(\\d+)/i))!=null) {M.splice(1,1,tem[1]);}\r\n        return {\r\n          name: M[0],\r\n          version: M[1]\r\n        };   \r\n    }\r\n    return /Firefox/.test(navigator.userAgent) && (minVersion===undefined || minVersion<=getVersion().version);\r\n};\r\n/*\r\n * return the browser name this function can be modified if needs more browsers\r\n */\r\nbizagi.util.getBrowser = function() {\r\n    var bw=\"undetected\";\r\n    if(bizagi.util.isChrome()){\r\n        bw=\"chrome\";\r\n    }else if(bizagi.util.isFirefox()){\r\n        bw=\"firefox\";\r\n    }else if(bizagi.util.isEdge()){\r\n        bw=\"edge\";\r\n    }else if(bizagi.util.isIE11()){\r\n        bw=\"ie11\";\r\n    \r\n    }else if(bizagi.util.isIE10()){\r\n        bw=\"ie10\";\r\n    }\r\n    return bw;\r\n};\r\n\r\n/**\r\n * Empty Navigator Info\r\n */\r\nbizagi.util.emptyNavigatorInfo = function() {\r\n    if (bizagi.navigator && bizagi.navigator.info) {\r\n        bizagi.navigator.info={};\r\n    }\r\n};\r\n\r\n/**\r\n * Auto call setting the browser class for css specific selectors, etc..\r\n */\r\n$( document ).ready(function() {\r\n    $(\"html\").addClass(\"browser-\"+bizagi.util.getBrowser());\r\n    if (bizagi.language) {\r\n        var language=bizagi.language.split(\"-\");\r\n        if (language && language.length>0) {\r\n            $(\"html\").addClass(\"language-\"+language[0]);\r\n        }\r\n    }\r\n  });\r\n\r\n\r\n\r\n\r\n/**\r\n * Method to detect iOS version X and apply styles to that device \r\n */\r\nbizagi.util.setIphoneXOverrides = function () {\r\n    if (bizagi.util.isNativePluginSupported() && typeof (bizagiapp.isIphoneX) !== 'undefined') {\r\n        bizagiapp.isIphoneX(function (value) {\r\n            var flagIphoneX = value;\r\n            var styleIphoneX = \".bz-menu-home .bz-menu-carousel .bz-menu-carousel-seat{padding:0 16px 16px}.bz-home-header .km-navbar{padding:35px 16px 5px}#menuHome .bz-home-header .km-navbar{padding:30px 3px 0}#menuHome .km-navbar .km-rightitem{font-size:19px;right:.4em;top:32px}#menuHome .km-navbar .km-leftitem{font-size:24px;left:0;top:25px}#taskFeed .km-navbar .km-rightitem{font-size:19px;top:25px;right:0}#taskFeed .km-navbar .km-leftitem{font-size:24px;top:20px;left:0}#homePortal #menuHome .km-view-title .km-buttongroup{margin-left:0;top:2px}.bz-render-header,.search-container{padding-top:25px}#activity-search,.search-container .bz-wp-mu-button-search{padding-top:40px}#content-newCase-drawer{padding-top:25px}#menuHome{background:#EBEDF1!important}.km-flat .km-content{background-color:#fff} .k-loading-mask{top:0!important}\";\r\n\r\n            if (flagIphoneX === 'true') {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneXStyle\"></style>');\r\n                $('#iphoneXStyle').text(styleIphoneX);\r\n\r\n            } else if (bizagi.util.isiOSDevice()) {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneStyle\"></style>');\r\n                var paddingStyle = \"#homePortal .bz-home-header > div{padding-top:.8em}\";\r\n                $('#iphoneStyle').text(paddingStyle);\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isObject = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Object]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Array.isArray(value);\r\n};\r\nbizagi.util.isNull = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Null]\";\r\n};\r\nbizagi.util.isBoolean = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Boolean]\";\r\n};\r\n\r\n/*\r\n *   Method to detect IE version\r\n */\r\nbizagi.util.getInternetExplorerVersion = function () {\r\n    if (!bizagi.util.isIE())\r\n        return -1;\r\n    return Number(document.documentMode);\r\n};\r\n/*  \r\n *   Detect a device based on the width\r\n */\r\nbizagi.util.detectDevice = function () {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.detectDevice();\r\n};\r\n\r\n// Check if a string is number\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n// Check if a string is GUID\r\nbizagi.util.isGUID = function (n) {\r\n    return /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n);\r\n};\r\n// Throw not implemented exception\r\nbizagi.util.mustImplement = function (notImplementedMethod) {\r\n    try {\r\n        console.log(\"Not implemented exception: \" + notImplementedMethod);\r\n    } catch (exe) { //IE console variable not exist\r\n    }\r\n    //throw \"You must implement \" + notImplementedMethod;\r\n};\r\n// Encodes the xpath \r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath) || typeof xpath.replaceAll === \"undefined\")\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n// Parses a value to return the correct boolean value\r\nbizagi.util.parseBoolean = function (value) {\r\n    if (value === undefined) {\r\n        return null;\r\n    }\r\n\r\n    if (value === null) {\r\n        return null;\r\n    }\r\n\r\n    if (value === '') {\r\n        return null;\r\n    }\r\n\r\n    // Parse true values\r\n    if (value === true || value === 1 || value.toString() === \"true\" || value === \"1\") {\r\n        return true;\r\n    }\r\n    if (value.toString().toLowerCase() === \"true\") {\r\n        return true;\r\n    }\r\n\r\n    // Parse false values\r\n    if ((value !== null && value === false) || value === 0 || value.toString() === \"false\" || value === \"0\") {\r\n        return false;\r\n    }\r\n    if (value.toString().toLowerCase() === \"false\") {\r\n        return false;\r\n    }\r\n\r\n    return null;\r\n};\r\n/*\r\n *   Checks if a given string is empty\r\n */\r\nbizagi.util.isEmpty = function (value) {\r\n    if (value === 0)\r\n        return false;\r\n\r\n    if (value === undefined || value === null || value === \"\") {\r\n        return true;\r\n    }\r\n\r\n    if (typeof (value) === \"Array\") {\r\n        return value.length == 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") {\r\n        return value.length === 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        if ($.isEmptyObject(value)) {\r\n            return true;\r\n        } else {\r\n            return bizagi.util.isEmptyCombo(value);\r\n        }\r\n    }\r\n\r\n    // Side effect - I can't delete the last item in the multiselect and searchlist\r\n   /* if (value == \"{\\\"value\\\":[]}\"){\r\n        return true;\r\n    }  */\r\n\r\n    return false;\r\n};\r\n\r\nbizagi.util.isEmptyCombo = function (object) {\r\n    if (Object.prototype.toString.apply(object) === \"[object Object]\") {\r\n        var property, id = false,\r\n            value = false,\r\n            other = false;\r\n        for (property in object) {\r\n            if (object.hasOwnProperty(property)) {\r\n                if (property === \"id\") {\r\n                    id = true;\r\n                } else {\r\n                    if (property === \"value\") {\r\n                        value = true;\r\n                    } else {\r\n                        other = true;\r\n                    }\r\n                }\r\n                if (other) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        if (id) {\r\n            if (object[\"id\"] === \"\") {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * Decode data from encodeURI charset\r\n */\r\nbizagi.util.decodeURI = function (value) {\r\n    value = value || \"\";\r\n    var finishDecoded = false;\r\n    var decodedValue = value;\r\n    var infinityControl;\r\n\r\n    // Try to decode data value\r\n    while (!finishDecoded) {\r\n        try {\r\n            infinityControl = decodeURI(decodedValue);\r\n            if (bizagi.util.hasNonVisibleChars(infinityControl)) {\r\n                decodedValue = value;\r\n                break;\r\n            }\r\n            if (infinityControl == decodedValue) {\r\n                finishDecoded = true;\r\n            } else {\r\n                decodedValue = infinityControl;\r\n            }\r\n        } catch (e) {\r\n            finishDecoded = true;\r\n        }\r\n    }\r\n\r\n    return decodedValue;\r\n};\r\n\r\nbizagi.util.hasNonVisibleChars = function (value) {\r\n    value = value || \"\";\r\n    var length = value.length;\r\n    var i = 0,\r\n        result = false,\r\n        ch;\r\n    for (; i < length;) {\r\n        ch = value.charCodeAt(i++);\r\n        if (ch < 32 || ch > 126) {\r\n            result = true;\r\n            break;\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\n/* \r\n *   Converts a percent into a number\r\n */\r\nbizagi.util.percent2Number = function (value) {\r\n    return Number(String(value).replace(\"%\", \"\"));\r\n};\r\n/*\r\n *   Check if a object is empty\r\n */\r\nbizagi.util.isObjectEmpty = function (obj) {\r\n    if (obj.length > 0)\r\n        return false;\r\n    return true;\r\n};\r\n/*\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n/*\r\n *   Replaces a matched selector in the container for the specified \"replace\" element\r\n */\r\nbizagi.util.replaceSelector = function (container, selector, replace) {\r\n    // Replace children tag\r\n    var elementToReplace = $(selector, container);\r\n    if (elementToReplace.length > 0) {\r\n        elementToReplace.append(replace);\r\n        elementToReplace.children().unwrap();\r\n    }\r\n};\r\n/*\r\n *   Determines if a control as a scrollbar \r\n */\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n//TODO: DEPL - Rename this to areIdenticalObjects\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n/*\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\nbizagi.util.centerElementIntoScroll = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var actualScroll = layout.scrollTop();\r\n    var elementTop = $(elem).offset().top;\r\n    var elementHeight = $(elem).height();\r\n    var offset = 0;\r\n    if (elementTop > 0) {\r\n        offset = elementTop + elementHeight;\r\n    } else {\r\n        offset = elementTop - elementHeight;\r\n    }\r\n    var newTop = actualScroll + offset;\r\n    layout.scrollTop(newTop);\r\n};\r\n/*\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/*\r\n *   Encode a string as HTML\r\n */\r\nbizagi.util.decodeHtmlEntities = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&apos;/g, '\"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\\'');\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Read the location hash\r\n */\r\nbizagi.util.getHashParams = function () {\r\n    var params = window.location.hash.substring(1).split(\"#\");\r\n    return params;\r\n};\r\n/*\r\n *   Loads a file on-demand\r\n */\r\nbizagi.util.loadFile = function (params) {\r\n    var defer = new $.Deferred();\r\n    var url = params && params.src ? params.src : params;\r\n    var type = params && params.type ? params.type : null;\r\n\r\n    bizagi.loader.loadFile({ src: url, type: type })\r\n        .then(function () {\r\n            defer.resolve();\r\n        });\r\n\r\n    return defer.promise();\r\n};\r\n\r\n/*\r\n *   Initializes a webpart on-demand\r\n */\r\nbizagi.util.initWebpart = function (webpart, device) {\r\n    var defer = new $.Deferred();\r\n\r\n    device = device || bizagi.detectDevice();\r\n\r\n    if (webpart.initialized) {\r\n        // If already initialized resolve the deferred\r\n        defer.resolve();\r\n    } else {\r\n\r\n        if (webpart.initializing) {\r\n            $.when(webpart.loadingDeferred.promise())\r\n                .done(function () {\r\n                    defer.resolve();\r\n                });\r\n        } else {\r\n\r\n            webpart.loadingDeferred = new $.Deferred();\r\n            webpart.initializing = true;\r\n            bizagi.loader.initWebpart(webpart, device, function () {\r\n\r\n                // Resolve deferreds\r\n                webpart.loadingDeferred.resolve();\r\n                webpart.initializing = false;\r\n                defer.resolve();\r\n            });\r\n        }\r\n    }\r\n\r\n    return defer.promise();\r\n};\r\n/*\r\n *   Read the query string parameteres\r\n */\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = pairs.length - 1; i >= 0; i--) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n/*\r\n *   Extend querystring\r\n */\r\nbizagi.util.extendQueryString = function (url, additionalParams) {\r\n    var plainUrl = url.indexOf(\"?\") > 0 ? url.substring(0, url.indexOf(\"?\")) : url;\r\n    var existingParams = bizagi.util.getQueryString(url);\r\n    var newParams = $.extend({}, existingParams, additionalParams);\r\n    return plainUrl + \"?\" + $.param(newParams);\r\n};\r\nbizagi.util.getStackTrace = function () {\r\n    var callstack = [];\r\n    var isCallstackPopulated = false;\r\n    try {\r\n        i.dont.exist += 0; //doesn't exist- that's the point\r\n    } catch (e) {\r\n        if (e.stack) { //Firefox\r\n            var lines = e.stack.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    callstack.push(lines[i]);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        } else if (window.opera && e.message) { //Opera\r\n            var lines = e.message.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    var entry = lines[i];\r\n                    //Append next line also since it has the file info\r\n                    if (lines[i + 1]) {\r\n                        entry += ' at ' + lines[i + 1];\r\n                        i++;\r\n                    }\r\n                    callstack.push(entry);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        }\r\n    }\r\n    if (!isCallstackPopulated) { //IE and Safari\r\n        var currentFunction = arguments.callee.caller;\r\n        while (currentFunction) {\r\n            var fn = currentFunction.toString();\r\n            var fname = fn.substring(fn.indexOf(\"function\") + 8, fn.indexOf('')) || 'anonymous';\r\n            callstack.push(fname);\r\n            currentFunction = currentFunction.caller;\r\n        }\r\n    }\r\n    return callstack;\r\n};\r\n/*\r\n *\thighlight elements\r\n */\r\nbizagi.util.highLightElement = function (el) {\r\n    el.addClass('ui-highlight-control');\r\n    $.when(\r\n        setTimeout(function () {\r\n            el.addClass('ui-highlight-off-control');\r\n        }, 450)\r\n    ).done(\r\n        setTimeout(function () {\r\n            el.removeClass('ui-highlight-control ui-highlight-off-control');\r\n        }, 800));\r\n}\r\n/*\r\n *\tscroll to bottom\r\n */\r\nbizagi.util.autoScrollBottom = function (el) {\r\n    try {\r\n        var elScrollHeight;\r\n        elScrollHeight = el[0].scrollHeight;\r\n        el.scrollTop(elScrollHeight);\r\n    } catch (e) { }\r\n}\r\n\r\n/*create auto scroll with limit top and limit bottom */\r\nbizagi.util.autoScrollInterval = { init: false };\r\nbizagi.util.autoScroll = function (itemScroll, limitTop, limitBottom, idInterval) {\r\n    var outSide = false;\r\n    /* prevent a previous interval */\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval[idInterval] = 0;\r\n    bizagi.util.autoScrollInterval['init'] = true;\r\n    $('body').addClass('autoscroll');\r\n    $('body.autoscroll').mousemove(function (event) {\r\n        if (event.pageY < limitTop) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollTopInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else if (event.pageY > limitBottom) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollBottomInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else {\r\n            clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            outSide = false;\r\n        }\r\n    });\r\n}\r\n/*create auto scroll movement top */\r\nbizagi.util.autoScrollTopInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    if (itemScroll.scrollTop() == 0) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            if (itemScroll.scrollTop() > 0) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() - 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n/*create auto scroll movement bottom */\r\nbizagi.util.autoScrollBottomInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    var valueMaxScrollBottom = $(itemScroll)[0].scrollHeight - $(itemScroll).innerHeight();\r\n    if (itemScroll.scrollTop() >= valueMaxScrollBottom) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            bizagi.util.autoScrollBottom($('html'));\r\n            if (itemScroll.scrollTop() < valueMaxScrollBottom) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() + 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n};\r\n/*remove auto scroll*/\r\nbizagi.util.removeAutoScroll = function (classCSS, idInterval) {\r\n    $('body.' + classCSS).unbind('mousemove').removeClass(classCSS);\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval.init = false;\r\n};\r\n\r\nbizagi.util.getMaxZIndex = function (selector) {\r\n    selector = selector || $(\"div,span\");\r\n    return Math.max.apply(null, $(selector).map(function () {\r\n        var zIndex;\r\n        return isNaN(zIndex = parseInt($(this).css(\"z-index\"), 10)) ? 0 : zIndex;\r\n    }));\r\n};\r\n\r\n/*\r\n * Creates a native popup to open an url\r\n */\r\nbizagi.showPopup = function (url, params, callbackFn) {\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(url, \"\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    // Define args to call the function\r\n    window.BAPopupWindow = newWindow;\r\n    window.BAPopupCallback = callbackFn;\r\n    // Define BACLoseWindow in this context, so the external content calls window.opener.BACloseWindow\r\n    window.BACloseWindow = function (controls, submitForm) {\r\n        // Close dialog\r\n        window.BAPopupWindow.close();\r\n        // Executes the callback to assign values and submit form (if requested)\r\n        window.BAPopupCallback(controls, submitForm);\r\n    };\r\n};\r\n/**\r\n * Creates a native popup in quirks mode to open an url\r\n * \r\n * @param url string page to open into popup\r\n * @param params json {width,height,title,afterLoad}\r\n */\r\nbizagi.showQuirksModePopup = function (url, params) {\r\n    var quirksModePage = window.BIZAGI_PATH_TO_BASE + \"quirks.html\";\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(quirksModePage, \"bizagiPopup\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    window.BAQuirksPopupWindow = newWindow;\r\n    // Attempto to set a window title\r\n    setTimeout(function () {\r\n        try {\r\n            newWindow.document.title = params.title;\r\n        } catch (e) { }\r\n    }, 50);\r\n    // We use a hack to eval content inside the popup\r\n    $(newWindow).callInsidePopup(function (windowParams) {\r\n\r\n        var $ = windowParams.jQuery;\r\n        var popupWindow = windowParams.popupWindow;\r\n        popupWindow.quirksOnLoad = function () {\r\n            var loadedBody = $(\"body\", popupWindow.document);\r\n            var iframe = $(\"iframe\", loadedBody);\r\n            // Remove waiting\r\n            loadedBody.removeClass(\"ui-bizagi-loading-message\");\r\n            iframe.show();\r\n            // Hacks the iframe\r\n            // This event will fire each time the iframe change its location\r\n            var afterLoad = windowParams.userParams.afterLoad;\r\n            if (afterLoad && afterLoad != null) {\r\n                var callbackParams = $.extend(windowParams.userParams, {\r\n                    popupWindow: popupWindow\r\n                });\r\n                iframe.callInside(afterLoad, callbackParams);\r\n            }\r\n        };\r\n        var loadingFunction = function () {\r\n            var body = $(\"body\", popupWindow.document);\r\n            // Create the iframe inside the new window\r\n            if (body.length > 0) {\r\n                body.append(\"<iframe scrolling='yes' id='innerFrameContent' src='\" + windowParams.url + \"' style='width: 100%; height: 100%; display:none' frameborder='0' onload='quirksOnLoad();'></iframe>\");\r\n            } else {\r\n                // Try again\r\n                setTimeout(function () {\r\n                    loadingFunction();\r\n                }, 50);\r\n            }\r\n        };\r\n        // Execute loading function\r\n        loadingFunction();\r\n    }, {\r\n            jQuery: $,\r\n            userParams: params,\r\n            popupWindow: newWindow,\r\n            url: url\r\n        });\r\n};\r\n/*\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n/*\r\n *   Creates a popup using overlay style\r\n */\r\nbizagi.createPopup = function (params) {\r\n    var popupName = params.name,\r\n        onClose = params.onClose,\r\n        popupHeader;\r\n    var popupTitle = (params.title) ? params.title : '';\r\n    var overlay = $('<div class=\"ui-widget-overlay ' + popupName + '-overlay\" />');\r\n    var popup = $('<div class=\"' + popupName + '-popup  ui-popup-modal\"/>').appendTo(overlay);\r\n    var closeButton = $('<div class=\"' + popupName + '-btn-close biz-btn-close\"><i class=\"biz-icon ui-close-btn bz-studio bz-black bz-false_16x16_black\"></i></div>').appendTo(popup);\r\n    if (params.title) {\r\n        popupHeader = $('<div class=\"' + popupName + '-popup-header ui-popup-header\" ><h3>' + popupTitle + '</h3></div>').appendTo(popup);\r\n    }\r\n\r\n    var popupContent = $('<div class=\"' + popupName + '-popup-content\" />').appendTo(popup);\r\n    // Add to body\r\n    popup.hide();\r\n    if (params.additionalClass)\r\n        popup.addClass(params.additionalClass);\r\n    var container = params.container || \"body\";\r\n    overlay.appendTo($(container, document));\r\n\r\n    if (params.center) {\r\n        // Resize popup to the center\r\n        popup.css(\"top\", (overlay.height() - popup.height()) / 2);\r\n        popup.css(\"left\", (overlay.width() - popup.width()) / 2);\r\n    }\r\n    popup.show();\r\n    // Close handler\r\n    var closeHandler = function (params) {\r\n        overlay.detach();\r\n        if (onClose)\r\n            onClose(params);\r\n    };\r\n    closeButton.click(closeHandler);\r\n    // Return a full independent object\r\n    return {\r\n        fullPopup: popup,\r\n        overlay: overlay,\r\n        content: popupContent,\r\n        close: function (params) {\r\n            closeHandler(params);\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an Ok, Cancel popup using bizagi.createPopup()\r\n */\r\n\r\nbizagi.createOkCancelPopup = function (params) {\r\n    params.name = \"popup-ok-cancel\";\r\n    var onOk = params.onOk,\r\n        onCancel = params.onCancel;\r\n    var popup = bizagi.createPopup(params);\r\n    var container = $(\"<div></div>\").addClass(\"container-okcancel-popup\");\r\n    var message = $(\"<div></div>\").addClass(\"message-okcancel-popup ui-light-bevel-border biz-gradient-v\");\r\n    var buttonsContainer = $(\"<div></div>\").addClass(\"buttonsContainer-okcancel-popup biz-actions-bar\");\r\n    message.text(params.message);\r\n    message.appendTo(container);\r\n    var buttonOk = $(\"<span></span>\").addClass(\"ok-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    var buttonCancel = $(\"<span></span>\").addClass(\"cancel-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    buttonOk.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-ok\"));\r\n    buttonCancel.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-cancel\"));\r\n    buttonOk.appendTo(buttonsContainer);\r\n    buttonCancel.appendTo(buttonsContainer);\r\n    buttonsContainer.appendTo(container);\r\n    container.appendTo(popup.content);\r\n    var okHandler = function () {\r\n        popup.close();\r\n        if (typeof (onOk) == \"function\") {\r\n            onOk();\r\n        }\r\n    };\r\n    buttonOk.click(okHandler);\r\n    var cancelHandler = function () {\r\n        popup.close();\r\n        if (typeof (onCancel) == \"function\") {\r\n            onCancel();\r\n        }\r\n    };\r\n    buttonCancel.click(cancelHandler);\r\n    return {\r\n        close: function () {\r\n            popup.close();\r\n        },\r\n        ok: function () {\r\n            okHandler();\r\n        },\r\n        cancel: function () {\r\n            cancelHandler();\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an generic dialog\r\n */\r\nbizagi.dialog = function (params) {\r\n\r\n    var dialog = $(\"<div></div>\").addClass(\"biz-dialog\");\r\n    var msg = $(\"<p></p>\");\r\n    msg.text(params.message || \"\");\r\n    msg.appendTo(dialog);\r\n    dialog.appendTo($(\"body\", document));\r\n    dialog.dialog({\r\n        title: params.title,\r\n        modal: true,\r\n        buttons: params.buttons,\r\n        close: function () {\r\n            dialog.dialog(\"destroy\");\r\n        }\r\n    });\r\n};\r\n/*\r\n *   Close the quirks mode popup window\r\n */\r\nbizagi.closeQuirksModePopup = function () {\r\n    var quirksPopup = window.BAQuirksPopupWindow;\r\n    window.BAQuirksPopupWindow = null;\r\n    try {\r\n        if (quirksPopup)\r\n            quirksPopup.close();\r\n    } catch (e) { }\r\n};\r\n/**\r\n * Get css class definition to string\r\n */\r\nbizagi.getStyle = function (style) {\r\n    var pathName = location.href.replace(\"/default.aspx\", \"\");\r\n    var getFontFace = (style.match(/@/)) ? true : false;\r\n    var matchFontFace = \"@font-face\";\r\n    var getAllChildrens = (style.match(/\\*/)) ? true : false;\r\n    var matchStyles = new RegExp(style.replace(\"*\", \"\"), \"g\");\r\n    var stringCss = \"\";\r\n    var css;\r\n    if (style == \"\") {\r\n        return \"\";\r\n    }\r\n    var awesomeBrowser = function (style) {\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].rules || document.styleSheets[file].cssRules;\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (document.styleSheets[file].href != null && (document.styleSheets[file].href.match(/less.css/g) == null || BIZAGI_ENVIRONMENT == \"release\")) {\r\n\r\n                        var cssTextOriginal = (css[key].cssText) ? css[key].cssText : '';\r\n                        // Get all matches\r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n\r\n                                if ($.browser.webkit) {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"\");\r\n                                } else if ($.browser.msie && $.browser.version == \"8.0\") {\r\n                                    stringCss += css[key].style.cssText;\r\n                                } else {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"../../jquery/workportal/css/desktop\");\r\n                                }\r\n                            }\r\n                        } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                            stringCss += css[key].cssText;\r\n                        }\r\n\r\n                        // Get @font-face\r\n                        if (getFontFace) {\r\n                            if (css[key] != undefined && cssTextOriginal != undefined) {\r\n                                if (cssTextOriginal.indexOf(matchFontFace) != -1) {\r\n\r\n                                    if ($.browser.webkit) {\r\n                                        stringCss += cssTextOriginal.replace(/jquery\\/workportal\\/css\\/desktop\\//g, \"\").replace(/\\(path\\)/g, \"\");\r\n                                    } else {\r\n                                        stringCss += cssTextOriginal.replace(/\\(path\\)/g, \"../../\");\r\n                                    }\r\n\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var suckBrowser = function (style) {\r\n        if ($.browser.version == \"8.0\") {\r\n            // That is crazy, but it has the same document.styleSheets structure to chrome and mozilla\r\n            return awesomeBrowser(style);\r\n        }\r\n        var lastLevel;\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].cssRules || document.styleSheets[file].rules;\r\n\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (BIZAGI_ENVIRONMENT == \"release\") {\r\n                        // Get all matches \r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    } else if (css[key].href != null && css[key].href != undefined && css[key].href.match(/less.css/g) == null) {\r\n                        // Get all matches \r\n                        lastLevel = css[key].styleSheet.cssRules || [];\r\n                        for (var n = 0; n < lastLevel.length; n++) {\r\n                            if (getAllChildrens) {\r\n                                if ((lastLevel[n].selectorText != undefined || lastLevel[n].selectorText != null) && lastLevel[n].selectorText.match(matchStyles) != null) {\r\n                                    //stringCss += lastLevel[n].cssText;\r\n                                    stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                                }\r\n                            } else if (lastLevel[n].selectorText != undefined && lastLevel[n].selectorText == style) {\r\n                                // stringCss += lastLevel[n].cssText;\r\n                                stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var result = ($.browser.msie) ? suckBrowser(style) : awesomeBrowser(style);\r\n    return result;\r\n};\r\n/**\r\n * Set and retrieve Cookie\r\n */\r\nbizagi.cookie = function (key, value, options) {\r\n    // key and at least value given, set cookie...\r\n    if (arguments.length > 1 && String(value) !== \"[object Object]\") {\r\n        options = $.extend({}, options);\r\n        if (value === null || value === undefined) {\r\n            options.expires = -1;\r\n        }\r\n\r\n        if (typeof options.expires === 'number') {\r\n            var days = options.expires,\r\n                t = options.expires = new Date();\r\n            t.setDate(t.getDate() + days);\r\n        }\r\n\r\n        value = String(value);\r\n        return (document.cookie = [\r\n            encodeURIComponent(key), '=',\r\n            options.raw ? value : encodeURIComponent(value),\r\n            options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\r\n            options.path ? '; path=' + options.path : '',\r\n            options.domain ? '; domain=' + options.domain : '',\r\n            options.secure ? '; secure' : ''\r\n        ].join(''));\r\n    }\r\n\r\n    // key and possibly options given, get cookie...\r\n    options = value || {};\r\n    var result, decode = options.raw ? function (s) {\r\n        return s;\r\n    } : decodeURIComponent;\r\n    return (result = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? decode(result[1]) : null;\r\n};\r\n/**\r\n * Returns a random integer between min and max\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n * Set global context values\r\n * @param params onject\r\n * @param reset boolean\r\n */\r\nbizagi.util.setContext = function (params, reset) {\r\n    params = params || {};\r\n    reset = reset || false;\r\n    if (reset) {\r\n        bizagi.context = {};\r\n    }\r\n    $.each(params, function (key, value) {\r\n        bizagi.context[key] = value;\r\n    });\r\n\r\n    // Fix camel case in idWorkItem Property\r\n    bizagi.context[\"idWorkItem\"] = bizagi.context[\"idWorkitem\"];\r\n};\r\n\r\nbizagi.util.reloadCSS = function () {\r\n    var queryString = '?reload=' + new Date().getTime();\r\n    $('link[rel=\"stylesheet\"]').each(function () {\r\n        this.href = this.href.replace(/\\?.*|$/, queryString);\r\n    });\r\n}\r\n\r\n/**\r\n * Control recursive calls of setTimeout\r\n * @param params json {name:name of call,call: function call}\r\n * @return void\r\n */\r\nbizagi.util.setInterval = function (params) {\r\n    var _name = params.name || 'default';\r\n    var _call = params.call || function () { };\r\n    var _params = params.params || {};\r\n    var _singleton = params.singleton || false;\r\n    var _timeOut = params.timeout || 5000;\r\n    var _maxIterations = params.iterations || 1000;\r\n    var _context = params.context || \"true;\";\r\n    // If callback its diferent to context, remove from hash\r\n    var _killWhenExitContext = (params.hasOwnProperty('killWhenExitContext')) ? params.killWhenExitContext : true;\r\n    bizagi.timeOut = bizagi.timeOut || {};\r\n    if (bizagi.timeOut[_name] == undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n    // Check if singleton (run once)\r\n    if (_singleton && bizagi.timeOut[_name] != undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n\r\n    bizagi.timeOut[_name].push({\r\n        name: _name,\r\n        params: _params,\r\n        call: _call,\r\n        singleton: _singleton,\r\n        timeOut: _timeOut,\r\n        iterations: 0,\r\n        maxIterations: _maxIterations,\r\n        context: _context,\r\n        killWhenExitContext: _killWhenExitContext,\r\n        itsRunning: false,\r\n        timeInit: Math.round((new Date()).getTime())\r\n    });\r\n    var executeTimeOut = function () {\r\n        $.each(bizagi.timeOut, function (k, v) {\r\n            $.each(v, function (key, value) {\r\n                var now = Math.round((new Date()).getTime());\r\n                var actualIterations = Math.round((now - value.timeInit) / value.timeOut);\r\n                bizagi.timeOut[value.name][key]['iterations'] = actualIterations;\r\n                if (actualIterations < value.maxIterations) {\r\n                    // Check context\t\t\t\t\t\r\n                    if (eval(value.context)) {\r\n                        if (!value.itsRunning) {\r\n                            if (value.params)\r\n                                // Create a virtual function to IE\r\n                                if ($.browser.msie) {\r\n                                    var ieFunction = function () {\r\n                                        return value.call(value.params);\r\n                                    };\r\n                                }\r\n\r\n                            bizagi.timeOut[value.name][key]['pointer'] = ($.browser.msie) ? setInterval(ieFunction, value.timeOut, 'JavaScript') : setInterval(value.call, value.timeOut, value.params);\r\n                            bizagi.timeOut[value.name][key]['itsRunning'] = true;\r\n                        }\r\n                    } else if (value.killWhenExitContext) {\r\n                        bizagi.timeOut[value.name].splice(key, 1);\r\n                        clearTimeout(value.pointer);\r\n                    } else {\r\n                        bizagi.timeOut[value.name][key]['itsRunning'] = false;\r\n                        clearTimeout(value.pointer);\r\n                    }\r\n                } else {\r\n                    // Cancel timeout and remove call from hash\r\n                    clearTimeout(value.pointer);\r\n                    bizagi.timeOut[value.name].splice(key, 1);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    if (!bizagi.timeOutRunning) {\r\n        bizagi.timeOutRunning = true;\r\n        setInterval(executeTimeOut, 1000);\r\n    }\r\n};\r\nbizagi.util.isDate = function (value) {\r\n    // type A) dd/mm/aaaa \r\n    // type B) aaaa/mm/dd\r\n    // type C) aa/mm/dd\r\n\r\n    var dateRegEx_typeA = /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/,\r\n        dateRegEx_typeB = /^\\d{4}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        dateRegEx_typeC = /^\\d{1,2}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        timeRegEx = /^\\d{1,2}:\\d{2}(:\\d{2})?(\\s[aApP][mM])?$/,\r\n        result = false,\r\n        resultDate = false,\r\n        hasTime = false,\r\n        resultTime = false;\r\n\r\n    value = value || '';\r\n\r\n    var arrayDate = value.toString().split(\" \"),\r\n        dateField,\r\n        timeField;\r\n\r\n    dateField = arrayDate[0];\r\n\r\n    if (dateRegEx_typeA.test(dateField) || dateRegEx_typeB.test(dateField) || dateRegEx_typeC.test(dateField)) {\r\n        resultDate = true;\r\n    }\r\n\r\n    if (arrayDate.length > 1) {\r\n\r\n        timeField = arrayDate[1];\r\n\r\n        hasTime = true;\r\n\r\n        //Checks if AM/PM included in the time element\r\n        if (arrayDate.length == 3)\r\n            timeField = timeField + ' ' + arrayDate[2];\r\n\r\n        if (timeRegEx.test(timeField))\r\n            resultTime = true;\r\n    }\r\n\r\n    if (hasTime)\r\n        result = resultDate && resultTime;\r\n    else\r\n        result = resultDate;\r\n\r\n    return result;\r\n};\r\n/*\r\n *   Encodes unicode characters into html\r\n */\r\nbizagi.util.unicode2htmlencode = function (input) {\r\n    // Shorten\r\n    var natCCA = 'charCodeAt';\r\n    input = input.replace(/\\r\\n/g, '\\n');\r\n    var i, b1, hex,\r\n        len = input.length,\r\n        htmlHex = '';\r\n    for (i = 0; i < len; i++) {\r\n        b1 = input[natCCA](i);\r\n        hex = b1.toString(16);\r\n        htmlHex += '&#x' + hex + ';';\r\n    }\r\n    return htmlHex;\r\n};\r\n/*\r\n *   Gets the head element from the DOM\r\n */\r\nbizagi.util.getHeadElement = function () {\r\n    var hd = document.getElementsByTagName(\"head\")[0];\r\n    var docEl = document && document.documentElement;\r\n    if (!hd) {\r\n        hd = document.createElement(\"head\");\r\n        docEl.insertBefore(hd, docEl.firstChild);\r\n    }\r\n    // replace head so it runs fast next time.\r\n    bizagi.util.getHeadElement = function () {\r\n        return hd;\r\n    };\r\n    return hd;\r\n};\r\n/*\r\n *   Loads a css text into the current document\r\n */\r\nbizagi.util.loadStyle = function (styleText, layoutGuid) {\r\n\r\n    var element = document.getElementById(layoutGuid);\r\n\r\n    if (styleText && !element) { // less\r\n        var css = document.createElement(\"style\");\r\n        css.type = \"text/css\";\r\n        css.id = layoutGuid;\r\n        if (css.styleSheet) { // IE\r\n            css.styleSheet.cssText = styleText;\r\n        } else {\r\n            (function (node) {\r\n                if (css.childNodes.length) {\r\n                    if (css.firstChild.nodeValue !== node.nodeValue) {\r\n                        css.replaceChild(node, css.firstChild);\r\n                    }\r\n                } else {\r\n                    css.appendChild(node);\r\n                }\r\n            })(document.createTextNode(styleText));\r\n        }\r\n        bizagi.util.getHeadElement().appendChild(css);\r\n    }\r\n};\r\n\r\n/*\r\n *   Loads a css text of the icon widget into the current document\r\n */\r\nbizagi.util.loadIconStyle = function (icon, userfieldname) {\r\n    bizagi.log(\"bizagi.util.loadIconStyle\");\r\n    var css = document.createElement(\"style\");\r\n    css.type = \"text/css\";\r\n\r\n    var cssText = \".mtool-item-image-\" + userfieldname + \" { background:url(data:image/png;base64,\" + icon + \"); }\";\r\n    css.innerHTML = cssText;\r\n\r\n    bizagi.util.getHeadElement().appendChild(css);\r\n};\r\n\r\nbizagi.util.formatDecimalAndMoneyCell = function (tableData, externalMoneyFormat) {\r\n    var moneyFormat, decimalFormat, i, j;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: externalMoneyFormat.decimalSeparator,\r\n        digitGroupSymbol: externalMoneyFormat.groupSeparator,\r\n        roundToDecimalPlace: externalMoneyFormat.decimalDigits\r\n    };\r\n    var defaultMoneyFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n\r\n    moneyFormat = $.extend(defaultMoneyFormat, externalMoneyFormat);\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n\r\n    for (i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"FLOAT\" || tableData.columnTitle[i].type.toUpperCase() == \"REAL\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                var numberValue = bizagi.util.formatDecimal(tableData.rows[j].fields[i], decimalFormat);\r\n                //Gets rids of unnecessary zeros\r\n                if (bizagi.override.removeTrailingZeros === true) {\r\n                    var positive = true;\r\n                    if (numberValue.toString().indexOf(\")\") != -1) {\r\n                        positive = false;\r\n                        numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n                    }\r\n                    var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"$1\");\r\n                    re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"\");\r\n\r\n                    if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n                }\r\n                tableData.rows[j].fields[i] = numberValue;\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n};\r\n\r\n\r\nbizagi.util.formatBoolean = function (value) {\r\n    var self = this;\r\n    if (bizagi.util.parseBoolean(value) == true) {\r\n        return bizagi.localization.getResource(\"render-boolean-yes\");\r\n    } else if (bizagi.util.parseBoolean(value) == false) {\r\n        return bizagi.localization.getResource(\"render-boolean-no\");\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\nbizagi.util.formatInvariantBoolean = function (htmlContent) {\r\n    htmlContent = htmlContent || \"\";\r\n    $(\".formatBoolean\", htmlContent).not(\".formatted\").each(function (index, element) {\r\n        var $element = $(element);\r\n        var content = $element.html();\r\n        $element.addClass(\"formatted\");\r\n        try {\r\n            var formatBoolean = bizagi.util.formatBoolean(content);\r\n            $element.html(formatBoolean);\r\n        } catch (e) {\r\n            $element.html(content);\r\n        }\r\n    });\r\n};\r\n\r\nbizagi.util.formatDecimal = function (value, format) {\r\n    var i = $(\"<i/>\").text(value);\r\n    i.formatCurrency(format);\r\n    return i.text();\r\n};\r\n\r\n/*\r\n * Format monetary cells\r\n */\r\nbizagi.util.formatMonetaryCells = function (tableData, moneyFormat) {\r\n\r\n    var defaultFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n\r\n    moneyFormat = moneyFormat || defaultFormat;\r\n\r\n    for (var i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (var j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n\r\n};\r\n\r\n/*\r\n * Format monetary values, the format must have the structure of the next example:\r\n *\r\n * var defaultFormat = {\r\n *        symbol: \"€\",\r\n *        decimalSeparator: \",\",\r\n *        groupSeparator: \".\",\r\n *        decimalDigits: \"2\"\r\n *    };\r\n */\r\nbizagi.util.formatMoney = function (value, format) {\r\n    var result = \"\",\r\n        tmpResult = \"\",\r\n        intSection = \"\",\r\n        decimalSection = \"\",\r\n        decimalResult = \"\",\r\n        isNegative = (value < 0);\r\n\r\n    if (value == null) {\r\n        value = \"\";\r\n    }\r\n\r\n    value = value.toString();\r\n\r\n    if (value.length >= 1) {\r\n        var decimalDigitPosition = value.indexOf(\".\");\r\n\r\n        if (decimalDigitPosition > 0) {\r\n            value = bizagi.util.fixDecimalDigits(value, format.decimalDigits);\r\n            intSection = value.substring(0, decimalDigitPosition).replace(/\\D/g, '');\r\n        } else {\r\n            var zeroChar = \"0\";\r\n\r\n            for (var i = 0; i < format.decimalDigits; i++) {\r\n                decimalResult += zeroChar;\r\n            }\r\n            intSection = value.replace(/\\D/g, '');\r\n        }\r\n\r\n        //take only the number characters removing other characters\r\n        value = value.replace(/\\D/g, '');\r\n        //take the decimal section\r\n        if (format.decimalDigits > 0) {\r\n            decimalSection = decimalDigitPosition > 0 ? format.decimalSeparator + value.substring(value.length - format.decimalDigits, value.length) : format.decimalSeparator + decimalResult;\r\n        } else {\r\n            decimalSection = \"\";\r\n        }\r\n        //insert groupSeparators into int section\r\n        if (intSection.length > 3) {\r\n            var count = 0;\r\n\r\n            //insert separator from end to begin\r\n            for (var i = intSection.length - 1; i >= 0; i--) {\r\n                if (count == 3) {\r\n                    tmpResult += \".\";\r\n                    count = 0;\r\n                }\r\n                tmpResult += intSection[i];\r\n                count += 1;\r\n            }\r\n            //revert the string to get the result value\r\n            for (var i = tmpResult.length - 1; i >= 0; i--) {\r\n                result += tmpResult[i];\r\n            }\r\n        } else {\r\n            result = intSection;\r\n        }\r\n\r\n        //replace the correct group separator\r\n        result = result.replaceAll(\".\", format.groupSeparator);\r\n        //unify all sections and finish format\r\n        if (isNegative) {\r\n            var negativeFormat = bizagi.localization.getResource('numericFormat').negativeFormat;\r\n            result = negativeFormat.replace(\"%s\", format.symbol).replace(\"%n\", result + decimalSection);\r\n        } else {\r\n            result = format.symbol + result + decimalSection;\r\n        }\r\n\r\n        return result;\r\n    } else {\r\n        return value;\r\n    }\r\n\r\n\r\n};\r\n\r\n/**\r\n * Remove all characters except numbers\r\n */\r\nbizagi.util.getOnlyNumbersByString = function (stringValue) {\r\n    return stringValue.replace(/\\D/g, '');\r\n}\r\n\r\n/*\r\n    This method was created because the \"toFixed()\" JavaScript method in some cases round the numbers when it is not needed.\r\n    Can return string or number.\r\n*/\r\nbizagi.util.fixDecimalDigits = function (value, decimalDigits) {\r\n    var decimalDigitPosition,\r\n        intSection,\r\n        decimalSection;\r\n\r\n    decimalDigitPosition = value.indexOf('.');\r\n    intSection = value.substring(0, decimalDigitPosition);\r\n    decimalSection = value.substring(decimalDigitPosition + 1, value.length);\r\n\r\n    if (decimalDigits > decimalSection.length) {\r\n        for (var i = decimalSection.length; i < decimalDigits; i++) {\r\n            value += '0';\r\n        }\r\n    } else {\r\n        value = parseFloat(value).toFixed(decimalDigits);\r\n    }\r\n\r\n    return value;\r\n\r\n};\r\n\r\n/*\r\n * Format html  money\r\n */\r\nbizagi.util.formatInvariantMoney = function (htmlContent, moneyFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var defaultFormat = {\r\n        symbol: moneyFormat.symbol,\r\n        decimalSeparator: moneyFormat.decimalSeparator || \",\",\r\n        groupSeparator: moneyFormat.groupSeparator || \".\",\r\n        decimalDigits: moneyFormat.decimalDigits || \"2\"\r\n    };\r\n    if (moneyFormat.allowDecimals === false) {\r\n        defaultFormat.decimalDigits = \"0\";\r\n    }\r\n\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatMoney = bizagi.util.formatMoney(value, defaultFormat);\r\n                $(elem).html(formatMoney);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html  number\r\n */\r\nbizagi.util.formatInvariantNumber = function (htmlContent, numberFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var decimalDigits = \"2\";\r\n    if (numberFormat.decimalDigits == \"0\")\r\n        decimalDigits = \"0\";\r\n    else\r\n        decimalDigits = numberFormat.decimalDigits || \"2\";\r\n\r\n    var defaultFormat = {\r\n        symbol: \"\",\r\n        decimalSeparator: numberFormat.decimalSeparator || \",\",\r\n        groupSeparator: numberFormat.groupSeparator || numberFormat.thousands ? \".\" : \"\",\r\n        decimalDigits: decimalDigits\r\n    };\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var containsLetter = content.match(/[a-zA-Z]/);\r\n            var value = (containsLetter != null && containsLetter.length > 0) ? NaN : parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatNumber = bizagi.util.formatMoney(value, defaultFormat);\r\n                if (numberFormat.percentage) {\r\n                    formatNumber = formatNumber.toString() + \"%\";\r\n                }\r\n                $(elem).html(formatNumber);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html with invariant date\r\n */\r\nbizagi.util.formatInvariantDate = function (htmlContent, dateFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    dateFormat = dateFormat || \"MM/dd/yyyy hh:mm:ss\";\r\n    $(\".formatDate\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = new Date(content);\r\n            var dateTimeFormat = dateFormat;\r\n\r\n            if (bizagi.util.isValidDate(value))\r\n                dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n            var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat /*self.getResource(\"dateFormat\")*/);\r\n            $(elem).html(formatDate);\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Return format date with resources from string invariant date. It use the format specified\r\n * @param stringDateInvariant, string invariant date\r\n */\r\nbizagi.util.formatDateFromInvariantStringDate = function (stringInvariantDate) {\r\n    if (bizagi.util.isValidDate(stringInvariantDate)) {\r\n        var dateTimeFormat = bizagi.localization.getResource(\"dateFormat\") + ' ' + bizagi.localization.getResource(\"timeFormat\");\r\n        var value = new Date(stringInvariantDate);\r\n        dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n        var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat);\r\n        return formatDate;\r\n    }\r\n    return stringInvariantDate || \"\";\r\n};\r\n\r\nbizagi.util.getFormatDate = function (dateValue, defaultFormatDate) {\r\n    var dateTimeFormat = defaultFormatDate;\r\n\r\n    var H = dateValue.getHours();\r\n    var m = dateValue.getMinutes();\r\n    var s = dateValue.getSeconds();\r\n    var ms = dateValue.getMilliseconds();\r\n\r\n    //Don't show time when hour, minutes, seconds and milliseconds are 0\r\n    if (H === 0 && m === 0 && s === 0 && ms === 0)\r\n        dateTimeFormat = bizagi.localization.getResource(\"dateFormat\");\r\n\r\n    return dateTimeFormat;\r\n};\r\n\r\n/**\r\n * Format value by dataType\r\n */\r\n\r\nbizagi.util.formatValueByDataType = function (value, dataType) {\r\n    /**\r\n     * Types Definedin Backend\r\n     * None = 0,BigInt = 1,Int = 2,SmallInt = 3,TinyInt = 4,Boolean = 5,Decimal = 6,Numeric = 7,Money = 8,Float = 10,Real = 11,DateTime = 12,SmallDateTime = 13,\r\n     Char = 14,VarChar = 15,Text = 16,Binary = 17,VarBinary = 18,Image = 19,Guid = 20,NChar = 21,NVarChar = 22,NText = 23,MxMBidirectionalRelationship = 24,\r\n     MxMUnidirectionalRelationship = 25,EntityDisabled = 26,UserAuth = 27,MxMUnidirectionalRelationshipWithoutFilter = 28,OracleNumber = 29,\r\n     Stakeholder = 30,ActivityItems = 31\r\n     *\r\n     * */\r\n    var result = value;\r\n    switch (dataType) {\r\n        case \"NText\":\r\n        case 23:\r\n        case \"Char\":\r\n        case 14:\r\n        case \"VarChar\":\r\n        case 15:\r\n        case \"Text\":\r\n        case 16:\r\n            if (value && value.length > 30) {\r\n                result = bizagi.util.replaceLineBreak(value);\r\n            }\r\n            break;\r\n        case \"Boolean\":\r\n        case 5:\r\n        case \"Binary\":\r\n        case 17:\r\n            result = bizagi.util.formatBoolean(value);\r\n            break;\r\n        case \"Int\":\r\n        case 2:\r\n        case \"BigInt\":\r\n        case 1:\r\n        case \"SmallInt\":\r\n        case 3:\r\n        case \"TinyInt\":\r\n        case 4:\r\n        case \"Numeric\":\r\n        case 7:\r\n            result = (value === undefined || value === null) ? \"\" : value;\r\n            break;\r\n        case \"Money\":\r\n        case 8:\r\n            result = bizagi.util.formatMonetaryCell(value);\r\n            break;\r\n        case \"Float\":\r\n        case 10:\r\n        case \"Real\":\r\n        case 11:\r\n        case \"Decimal\":\r\n        case 6:\r\n            result = bizagi.util.formatDecimalCell(value);\r\n            break;\r\n        case \"DateTime\":\r\n        case 12:\r\n        case \"SmallDateTime\":\r\n        case 13:\r\n            result = bizagi.util.formatDateFromInvariantStringDate(value);\r\n            break;\r\n    }\r\n    if (result == null) {\r\n        result = \"\";\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Check if it is a valid date\r\n */\r\nbizagi.util.isValidDate = function (params) {\r\n    if (typeof (params) != \"undefined\" && params != null) {\r\n        var parseDate = new Date(params);\r\n        return !isNaN(parseDate.valueOf());\r\n    } else return false;\r\n};\r\n\r\n/*\r\n *   Defines a date time formatter that will be available globally\r\n */\r\nbizagi.util.monthNames = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\r\nbizagi.util.dayNames = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat');\r\n\r\nbizagi.util.dateFormatter = new function () {\r\n    this.LZ = function (x) {\r\n        return (x < 0 || x > 9 ? \"\" : \"0\") + x;\r\n    };\r\n    /*\r\n     *   isDate ( date_string, format_string )\r\n     *   Returns true if date string matches format of format string and\r\n     *   is a valid date. Else returns false.\r\n     *   It is recommended that you trim whitespace around the value before\r\n     *   passing it to this function, as whitespace is NOT ignored!\r\n     */\r\n    this.isDate = function (val, format) {\r\n        var date = this.getDateFromFormat(val, format);\r\n        if (date == 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    this.getRelativeTime = function (date, dateFormat, onlyUnitsTime) {\r\n\r\n        var self = this;\r\n        var now = new Date();\r\n        var time = (date instanceof Date) ? date : kendo.parseDate(date, dateFormat);\r\n        var diff = now.getTime() - time.getTime();\r\n        var timeDiff = getTimeDiffDescription(diff, 'year', 31536000000, onlyUnitsTime);\r\n\r\n        if (!timeDiff) {\r\n            timeDiff = getTimeDiffDescription(diff, 'month', 2628000000, onlyUnitsTime);\r\n            if (!timeDiff) {\r\n                timeDiff = getTimeDiffDescription(diff, 'week', 604800000, onlyUnitsTime);\r\n                if (!timeDiff) {\r\n                    timeDiff = getTimeDiffDescription(diff, 'day', 86400000, onlyUnitsTime);\r\n                    if (!timeDiff) {\r\n                        timeDiff = getTimeDiffDescription(diff, 'hour', 3600000, onlyUnitsTime);\r\n                        if (!timeDiff) {\r\n                            timeDiff = getTimeDiffDescription(diff, 'minute', 60000, onlyUnitsTime);\r\n                            if (!timeDiff) {\r\n                                if (onlyUnitsTime) {\r\n                                    if (diff === 0) {\r\n                                        timeDiff = getTimeDiffDescription(diff + 1, 'minute', 1, onlyUnitsTime);\r\n                                    } else {\r\n                                        timeDiff = getTimeDiffDescription(diff, 'minute', 1, onlyUnitsTime);\r\n                                    }\r\n                                } else {\r\n                                    timeDiff = getTimeDiffDescription(diff, 'second', 2000, onlyUnitsTime);\r\n                                    if (!timeDiff) {\r\n                                        timeDiff = bizagi.localization.getResource(\"workportal-relativetime-momentago\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return timeDiff;\r\n\r\n        /*\r\n         * Get Time Difference\r\n         */\r\n        function getTimeDiffDescription(diff, unit, timeDivisor, onlyUnitsTime) {\r\n            var unitAmount = (diff / timeDivisor).toFixed(0);\r\n\r\n            if (unitAmount > 0) {\r\n                if (onlyUnitsTime) {\r\n                    return (unitAmount == 1 ? bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount) : bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount));\r\n                } else {\r\n                    var resourceAgo = bizagi.localization.getResource(\"workportal-relativetime-ago\");\r\n                    return (unitAmount == 1 ? resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount)) : resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount)));\r\n                }\r\n\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     *   compareDates(date1,date1format,date2,date2format)\r\n     *   Compare two date strings to see which is greater.\r\n     *   Returns:\r\n     *   1 if date1 is greater than date2\r\n     *   0 if date2 is greater than date1 of if they are the same\r\n     *  -1 if either of the dates is in an invalid format\r\n     */\r\n    this.compareDates = function (date1, dateformat1, date2, dateformat2) {\r\n        var d1 = getDateFromFormat(date1, dateformat1);\r\n        var d2 = getDateFromFormat(date2, dateformat2);\r\n        if (d1 == 0 || d2 == 0) {\r\n            return -1;\r\n        } else if (d1 > d2) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    /*\r\n     *   getDifferenceBetweenDates(date1,date2, unit)\r\n     *   Compare two date objects to see difference between them. The number result by unit specified.\r\n     *\r\n     *   Returns:\r\n     *   Difference value between two dates.\r\n     *   Message string if either of the dates is in an invalid format\r\n     */\r\n    this.getDifferenceBetweenDates = function (date1, date2, unit) {\r\n        if (date1 instanceof Date && date1 instanceof Date) {\r\n            switch (unit) {\r\n                case \"seconds\":\r\n                    return (date2.getTime() - date1.getTime()) / 1000;\r\n                case \"milliseconds\":\r\n                    return (date2.getTime() - date1.getTime());\r\n                default:\r\n                    return \"unit is not Defined\";\r\n            }\r\n        } else {\r\n            return \"one param not is Date\";\r\n        }\r\n\r\n    };\r\n    /*\r\n     *   formatDate (date_object, format)\r\n     *   Returns a date in the output format specified.\r\n     *   The format string uses the same abbreviations as in getDateFromFormat()\r\n     */\r\n    this.formatDate = function (date, format, i18n) {\r\n        // Check if date is valid\r\n        if (!bizagi.util.isValidDate(date) || date == 0) {\r\n            return \"\";\r\n        }\r\n\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        format = format + \"\";\r\n        var result = \"\";\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var y = date.getFullYear() + \"\";\r\n        var M = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var E = date.getDay();\r\n        var H = date.getHours();\r\n        var m = date.getMinutes();\r\n        var s = date.getSeconds();\r\n        var f = date.getMilliseconds();\r\n        // Convert real date parts into formatted versions\r\n        var value = new Object();\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        if (y.length < 4 || (y.charAt(0) === \"-\" && y.length < 5)) {\r\n            y = \"\" + (y - 0 + 1900);\r\n        }\r\n        value[\"y\"] = \"\" + y;\r\n        value[\"yyyy\"] = y;\r\n        value[\"yy\"] = y.substring(2, 4);\r\n        value[\"M\"] = M;\r\n        value[\"MM\"] = this.LZ(M);\r\n        value[\"MMM\"] = monthNames[M + 11];\r\n        value[\"MMMM\"] = monthNames[M - 1];\r\n        value[\"NNN\"] = monthNames[M + 11];\r\n        value[\"d\"] = d;\r\n        value[\"dd\"] = this.LZ(d);\r\n        value[\"ddd\"] = dayNames[E + 7];\r\n        value[\"dddd\"] = dayNames[E];\r\n        value[\"E\"] = dayNames[E + 7];\r\n        value[\"EE\"] = dayNames[E];\r\n        value[\"H\"] = H;\r\n        value[\"HH\"] = this.LZ(H);\r\n        value[\"tt\"] = H < 12 ? \"am\" : \"pm\";\r\n        value[\"TT\"] = H < 12 ? \"AM\" : \"PM\";\r\n\r\n\r\n        if (H == 0) {\r\n            value[\"h\"] = 12;\r\n        } else if (H > 12) {\r\n            value[\"h\"] = H - 12;\r\n        } else {\r\n            value[\"h\"] = H;\r\n        }\r\n        value[\"hh\"] = this.LZ(value[\"h\"]);\r\n        if (H > 11) {\r\n            value[\"K\"] = H - 12;\r\n        } else {\r\n            value[\"K\"] = H;\r\n        }\r\n        value[\"k\"] = H + 1;\r\n        value[\"KK\"] = this.LZ(value[\"K\"]);\r\n        value[\"kk\"] = this.LZ(value[\"k\"]);\r\n        if (H > 11) {\r\n            value[\"a\"] = \"PM\";\r\n        } else {\r\n            value[\"a\"] = \"AM\";\r\n        }\r\n        value[\"m\"] = m;\r\n        value[\"mm\"] = this.LZ(m);\r\n        value[\"s\"] = s;\r\n        value[\"ss\"] = this.LZ(s);\r\n        value[\"FFF\"] = f;\r\n\r\n        while (i_format < format.length) {\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            if (value[token] != null) {\r\n                result = result + value[token];\r\n            } else {\r\n                result = result + token;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    /*\r\n     *   getDateFromFormat( date_string , format_string )\r\n     *\r\n     *   This function takes a date string and a format string. It matches\r\n     *   If the date string matches the format string, it returns the \r\n     *   getTime() of the date. If it does not match, it returns 0.\r\n     */\r\n    this.getDateFromFormat = function (val, format, i18n) {\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        val = val + \"\";\r\n        format = format + \"\";\r\n        var i_val = 0;\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var x = 0,\r\n            y = 0;\r\n        var now = new Date();\r\n        var year = now.getYear();\r\n        var month = now.getMonth() + 1;\r\n        var date = 1;\r\n        var hh = now.getHours();\r\n        var mm = now.getMinutes();\r\n        var ss = now.getSeconds();\r\n        var FFF = now.getMilliseconds();\r\n        var ampm = \"\";\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        while (i_format < format.length) {\r\n            // Get next token from format string\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            // Extract contents of value based on format token\r\n            if (token == \"yyyy\" || token == \"yy\" || token == \"y\") {\r\n                if (token == \"yyyy\") {\r\n                    x = 4;\r\n                    y = 4;\r\n                }\r\n                if (token == \"yy\") {\r\n                    x = 2;\r\n                    y = 2;\r\n                }\r\n                if (token == \"y\") {\r\n                    x = 2;\r\n                    y = 4;\r\n                }\r\n                year = _getInt(val, i_val, x, y);\r\n                if (year == null) {\r\n                    return 0;\r\n                }\r\n                i_val += year.length;\r\n                if (year.length == 2) {\r\n                    if (year > 70) {\r\n                        year = 1900 + (year - 0);\r\n                    } else {\r\n                        year = 2000 + (year - 0);\r\n                    }\r\n                }\r\n            } else if (token == \"MMMM\" || token == \"MMM\" || token == \"NNN\") {\r\n                month = 0;\r\n                for (var i = 0; i < monthNames.length; i++) {\r\n                    var month_name = monthNames[i];\r\n                    if (val.substring(i_val, i_val + month_name.length).toLowerCase() == month_name.toLowerCase()) {\r\n                        if (token == \"MMMM\" || token == \"MMM\" || (token == \"NNN\" && i > 11)) {\r\n                            month = i + 1;\r\n                            if (month > 12) {\r\n                                month -= 12;\r\n                            }\r\n                            i_val += month_name.length;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if ((month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n            } else if (token == \"dddd\" || token == \"EE\" || token == \"E\") {\r\n                for (var j = 0; j < dayNames.length; j++) {\r\n                    var day_name = dayNames[j];\r\n                    if (val.substring(i_val, i_val + day_name.length).toLowerCase() == day_name.toLowerCase()) {\r\n                        i_val += day_name.length;\r\n                        break;\r\n                    }\r\n                }\r\n            } else if (token == \"MM\" || token == \"M\") {\r\n                month = _getInt(val, i_val, 1, 2);\r\n                if (month == null || (month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += month.length;\r\n            } else if (token == \"dd\" || token == \"d\") {\r\n                date = _getInt(val, i_val, 1, 2);\r\n                if (date == null || (date < 1) || (date > 31)) {\r\n                    return 0;\r\n                }\r\n                i_val += date.length;\r\n            } else if (token == \"hh\" || token == \"h\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 23)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"KK\" || token == \"K\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 11)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"kk\" || token == \"k\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 24)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n                hh--;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                mm = _getInt(val, i_val, token.length, 2);\r\n                if (mm == null || (mm < 0) || (mm > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += mm.length;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                ss = _getInt(val, i_val, token.length, 2);\r\n                if (ss == null || (ss < 0) || (ss > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += ss.length;\r\n            } else if (token == \"FFF\") {\r\n                ff = _getInt(val, i_val, token.length, 3);\r\n                if (ff == null || (ff < 0) || (ff > 999)) {\r\n                    return 0;\r\n                }\r\n                i_val += ff.length;\r\n            } else if (token == \"a\" || token == \"tt\") {\r\n                if (val.substring(i_val, i_val + 2).toLowerCase() == \"am\") {\r\n                    ampm = \"AM\";\r\n                } else if (val.substring(i_val, i_val + 2).toLowerCase() == \"pm\") {\r\n                    ampm = \"PM\";\r\n                } else {\r\n                    return 0;\r\n                }\r\n                i_val += 2;\r\n            } else {\r\n                if (val.substring(i_val, i_val + token.length) != token) {\r\n                    return 0;\r\n                } else {\r\n                    i_val += token.length;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Is date valid for month?\r\n        if (month == 2) {\r\n            // Check for leap year\r\n            if (((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0)) { // leap year\r\n                if (date > 29) {\r\n                    return 0;\r\n                }\r\n            } else {\r\n                if (date > 28) {\r\n                    return 0;\r\n                }\r\n            }\r\n        }\r\n        if ((month == 4) || (month == 6) || (month == 9) || (month == 11)) {\r\n            if (date > 30) {\r\n                return 0;\r\n            }\r\n        }\r\n        // Correct hours value\r\n        if (hh < 12 && ampm == \"PM\") {\r\n            hh = hh - 0 + 12;\r\n        } else if (hh > 11 && ampm == \"AM\") {\r\n            hh -= 12;\r\n        }\r\n        var newdate = new Date(year, month - 1, date, hh, mm, ss);\r\n        return newdate;\r\n\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _isInteger(_val) {\r\n            var digits = \"1234567890\";\r\n            for (var k = 0; k < _val.length; k++) {\r\n                if (digits.indexOf(_val.charAt(k)) == -1) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _getInt(str, l, minlength, maxlength) {\r\n            for (var m = maxlength; m >= minlength; m--) {\r\n                var _token = str.substring(l, l + m);\r\n                if (_token.length < minlength) {\r\n                    return null;\r\n                }\r\n                if (_isInteger(_token)) {\r\n                    return _token;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    };\r\n    /*\r\n     * parseDate( date_string [, prefer_euro_format] )\r\n     *\r\n     * This function takes a date string and tries to match it to a\r\n     * number of possible date formats to get the value. It will try to\r\n     * match against the following international formats, in this order:\r\n     * y-M-d   MMM d, y   MMM d,y   y-MMM-d   d-MMM-y  MMM d\r\n     * M/d/y   M-d-y      M.d.y     MMM-d     M/d      M-d\r\n     * d/M/y   d-M-y      d.M.y     d-MMM     d/M      d-M\r\n     * A second argument may be passed to instruct the method to search\r\n     * for formats like d/M/y (european format) before M/d/y (American).\r\n     * Returns a Date object or null if no patterns match.\r\n     */\r\n    this.parseDate = function (val) {\r\n        var preferEuro = (arguments.length == 2) ? arguments[1] : false;\r\n        var generalFormats = new Array('y-M-d', 'MMM d, y', 'MMM d,y', 'y-MMM-d', 'd-MMM-y', 'MMM d');\r\n        var monthFirst = new Array('M/d/y', 'M-d-y', 'M.d.y', 'MMM-d', 'M/d', 'M-d');\r\n        var dateFirst = new Array('d/M/y', 'd-M-y', 'd.M.y', 'd-MMM', 'd/M', 'd-M');\r\n        var checkList = new Array(generalFormats, preferEuro ? dateFirst : monthFirst, preferEuro ? monthFirst : dateFirst);\r\n        var d;\r\n        for (var i = 0; i < checkList.length; i++) {\r\n            var l = window[checkList[i]];\r\n            for (var j = 0; j < l.length; j++) {\r\n                d = getDateFromFormat(val, l[j]);\r\n                if (d != 0) {\r\n                    return new Date(d);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    /*\r\n     *   Method to analyze a time format and checks separator, and hour format, and seconds\r\n     */\r\n    this.analyzeTimeFormat = function (timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            separator: \":\"\r\n        };\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else {\r\n                if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                    returnObj.separator = token;\r\n                }\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    };\r\n    this.getDateFromInvariant = function (value, showTime) {\r\n        value = (value == null) ? \"\" : value;\r\n        value = (typeof value != \"string\") ? value.toString() : value;\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" H:mm:ss\" : \"\");\r\n        if (showTime) {\r\n            if (value && (value.toLowerCase().indexOf(\"am\") > 0 || value.toLowerCase().indexOf(\"pm\") > 0)) {\r\n                INVARIANT_FORMAT = \"MM/dd/yyyy h:mm:ss a\";\r\n            }\r\n        }\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        } else if (date == 0 && showTime && value != null && value != \"\") {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n            date.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatInvariant = function (date, showTime) {\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, INVARIANT_FORMAT);\r\n        return formattedDate;\r\n    };\r\n    this.getDateFromISO = function (value, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        // If the date could not be parsed, try it out with seconds\r\n        if (date == 0 && showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        }\r\n\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd HH:mm\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            // If the date could not be parsed, try it out with seconds\r\n            if (date == 0) {\r\n                ISO_FORMAT = \"yyyy-MM-dd HH:mm:ss\";\r\n                date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            }\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatISO = function (date, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, ISO_FORMAT);\r\n        return formattedDate;\r\n    };\r\n\r\n    this.formatISO8601 = function (dateObject, restartTimeToMidnight) {\r\n        var restartTimeToMidnight = restartTimeToMidnight || false;\r\n        var ISO_FORMAT8601 = \"yyyy-MM-ddTHH:mm:ss\";\r\n        if (restartTimeToMidnight) {\r\n            dateObject.setHours(0, 0, 0, 0);\r\n        }\r\n        return bizagi.util.dateFormatter.formatDate(dateObject, ISO_FORMAT8601);\r\n    };\r\n\r\n    this.isFormatISO8601 = function (stringDate) {\r\n        var ISO_8601_WITH_TIME = /^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?$/i\r\n        return ISO_8601_WITH_TIME.test(stringDate);\r\n    };\r\n\r\n    this.sleep = function (delay) {\r\n        // Delay in miliseconds\r\n        var start = new Date().getTime();\r\n        while (new Date().getTime() < start + delay) {\r\n            // wait\r\n        }\r\n    };\r\n    this.getDateFormatByDatePickerJqueryUI = function () {\r\n        return bizagi.localization.getResource(\"dateFormat\").replace(\"yyyy\", \"yy\");\r\n    }\r\n};\r\n/*\r\n * Use localStorage in html5 verfiy supports and operations \r\n * http://dev.w3.org/html5/webstorage/#dom-storage-setitem\r\n */\r\n\r\nbizagi.util.browserSupportLocalStorage = function () {\r\n    try {\r\n        return 'localStorage' in window && window['localStorage'] !== null;\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n};\r\n/*\r\n *set the item  in the local storage\r\n */\r\nbizagi.util.setItemLocalStorage = function (key, value) {\r\n    if (bizagi.util.browserSupportLocalStorage()) {\r\n        localStorage.setItem(key, value);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n\r\nbizagi.util.getItemLocalStorage = function (key) {\r\n    return localStorage.getItem(key);\r\n};\r\n\r\nbizagi.util.removeItemLocalStorage = function (key) {\r\n    localStorage.removeItem(key);\r\n};\r\n\r\nbizagi.util.clearLocalStorage = function () {\r\n    if (bizagi.util.browserSupportLocalStorage())\r\n        localStorage.clear();\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n\r\n// Fix problem with console.log when we forgot to remove it\r\n(function () {\r\n    var environment = (typeof BIZAGI_ENVIRONMENT != \"undefined\") ? BIZAGI_ENVIRONMENT : \"release\";\r\n    if (environment == 'debug') {\r\n        if (typeof window.console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        }\r\n    } else {\r\n        if (typeof console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        } else if (bizagiConfig && !bizagiConfig.showConsoleLog) {\r\n            console.log = function (a) { /*Nothing to do*/ };\r\n        }\r\n    }\r\n})();\r\n\r\nbizagi.util.smartphone.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"bz-util-loading-container\"> <div class=\"ui-bizagi-loading-icon bz-util-loading\"></div>  </div>');\r\n};\r\nbizagi.util.smartphone.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".bz-util-loading-container\", elementToapply).remove();\r\n};\r\n\r\n\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n * \r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n\r\n    self.add = function (callback) {\r\n        queue.push({ callbacks: [callback] });\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (queue.length == 0) {\r\n            return self.add(callback);\r\n        }\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\") {\r\n                        var deferred = $.Deferred();\r\n                        $.when(callback()).done(function () {\r\n                            deferred.resolve();\r\n                        }).fail(function () {\r\n                            deferred.resolve();\r\n                        });\r\n                        return deferred.promise();\r\n                    }\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        }\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Calculate circular dependencies \r\n * \r\n * @example var a = new bizagi.circularDependencies(); a.addNode('name',obj);\r\n * a.resolve(node);\r\n * \r\n */\r\n//TODO: DEPL - Check this because we agreed to a much simpler solution\r\nbizagi.circularDependencies = function () {\r\n    var circularDependencies = new Function();\r\n    var self = circularDependencies.prototype;\r\n    self.list = []; //[{ name: \"root\", obj: {}, nodeObj: {}, childs: {} }];\r\n    self.lastNodeAdded; // Undefined reference\r\n\r\n    self.addNode = function (name, obj) {\r\n        var OBJ = JSON.encode(obj);\r\n        var foundObjChildNode = _search(name, OBJ);\r\n        if (foundObjChildNode) {\r\n            var lastNode = self.lastNodeAdded || self.list[self.list.length - 1];\r\n            lastNode.nodeObj.addChild(foundObjChildNode.nodeObj);\r\n            self.lastNodeAdded = foundObjChildNode;\r\n        } else {\r\n            var node = new _addNode(name, OBJ);\r\n            self.list.push({\r\n                name: name,\r\n                obj: OBJ,\r\n                nodeObj: node,\r\n                timeStamp: new Date().getTime()\r\n            });\r\n            return node;\r\n        }\r\n    };\r\n\r\n    self.resolve = function (node, resolved, seen) {\r\n        // if dont setted node variable, take the first one -> root\r\n        node = node || _getFirstNodeWithChilds() || self.list[0].nodeObj;\r\n        var resolveDependencies = new _resolve(node, resolved, seen);\r\n        return resolveDependencies;\r\n    };\r\n\r\n    var _resetList = function () {\r\n        self.list = [];\r\n    };\r\n\r\n    var _getFirstNodeWithChilds = function () {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].nodeObj.childs.length > 0) {\r\n                return self.list[i].nodeObj;\r\n            }\r\n        }\r\n        return (self.list.length > 0) ? self.list[0].nodeObj : {};\r\n    };\r\n\r\n    var _search = function (name, obj) {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].name == name) {\r\n                // remove tag element\r\n                var now = new Date().getTime();\r\n                var timeToKeep = 1000; //milliseconds\r\n                if ((self.list[i].timeStamp + timeToKeep) < now) {\r\n                    //remove element from the list\r\n                    self.list.splice(i, 1);\r\n                } else if (self.list[i].obj == obj) {\r\n                    return self.list[i];\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var _addNode = (function (name, obj) {\r\n        name = name || \"\";\r\n        obj = obj || {};\r\n        var node = function (name, obj) {\r\n            this.name = name;\r\n            this.obj = obj;\r\n            this.childs = [];\r\n        };\r\n        var self = node.prototype;\r\n\r\n        self.addChild = function (node) {\r\n            this.childs.push(node);\r\n        };\r\n\r\n        return node;\r\n    })();\r\n\r\n    var _resolve = (function (node, resolved, seen) {\r\n        var resolve = function (node, resolved, seen) {\r\n            this.node = node || {};\r\n            this.node.childs = this.node.childs || [];\r\n            this.resolved = resolved || [];\r\n            this.seen = seen || [];\r\n\r\n            this.seen.push(this.node);\r\n\r\n            for (var i = 0; i < this.node.childs.length; i++) {\r\n                if (!self.hasObject(this.node.childs[i], this.resolved)) {\r\n                    if (self.hasObject(this.node.childs[i], this.seen)) {\r\n                        //throw new _error(\"error node:\" + node.name + \" -> \" + node.childs[i].name);\r\n                        _resetList();\r\n                        var error = {\r\n                            dependencyFrom: this.node.name,\r\n                            dependencyFromObj: this.node.obj,\r\n                            dependencyTo: this.node.childs[i].name,\r\n                            dependencyToObj: this.node.childs[i].obj,\r\n                            path: this.seen\r\n                        };\r\n\r\n                        return {\r\n                            error: $.extend({\r\n                                standardError: {\r\n                                    status: \"error\",\r\n                                    responseText: JSON.encode({ message: self.makeErrorMessage(error), type: \"alert\" })\r\n                                },\r\n                                multiactionError: {\r\n                                    message: self.makeErrorMessage(error),\r\n                                    type: \"alert\"\r\n                                }\r\n                            }, error)\r\n                        };\r\n                    } else {\r\n                        return resolve(this.node.childs[i], this.resolved, this.seen);\r\n                    }\r\n                }\r\n            }\r\n            if (this.resolved) {\r\n                this.resolved.push(this.node);\r\n            }\r\n        };\r\n\r\n        var self = resolve.prototype;\r\n\r\n        self.hasObject = function (toSearch, collection) {\r\n\r\n            for (var i = 0; i < collection.length; i++) {\r\n                if (collection[i].name == toSearch.name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n\r\n        self.makeErrorMessage = function (error) {\r\n            var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n            return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n\r\n            /*  return {\r\n                  responseText: parsedMessage,\r\n                  message: parsedMessage,\r\n                  extraInfo: error\r\n              };*/\r\n        };\r\n\r\n        return resolve;\r\n    })();\r\n\r\n    return self;\r\n};\r\n\r\n/**\r\n * Apply css string style (one or more). It works to add or override a specific style even if it has !important\r\n * \r\n * @example bizagi.util.cssExtended($('.myClass'), 'display:none!important;color:red');\r\n * \r\n */\r\nbizagi.util.cssExtended = function (instance, options) {\r\n    var cssToAdd = options.split(\";\");\r\n\r\n    for (i = 0; i < cssToAdd.length; i++) {\r\n        if (cssToAdd[i] != \"\") {\r\n            bizagi.util.cssExtendedApplyChanges(instance, cssToAdd[i]);\r\n        }\r\n    }\r\n\r\n};\r\n\r\n/**\r\n * Apply the style change \r\n * \r\n */\r\nbizagi.util.cssExtendedApplyChanges = function (instance, option) {\r\n\r\n    for (var i = 0; i < instance.length; i++) {\r\n        var $this = $(instance[i]);\r\n        var attrToAdd = option.split(\":\")[0];\r\n\r\n        if ($this.attr('style')) {\r\n            var tmpStyle = $this.attr('style').split(\";\");\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            for (j = 0; j < tmpStyle.length; j++) {\r\n                var cssProperty = tmpStyle[j].split(\":\");\r\n\r\n                if ($.trim(cssProperty[0]) != attrToAdd && $.trim(cssProperty[0]) != \"\") {\r\n                    arrProperties.push(cssProperty[0] + \":\" + cssProperty[1] + \";\");\r\n                }\r\n                resultProperties = JSON.stringify(arrProperties).replace(/\\\",\"/g, ' ').replace(/\\[\"/g, ' ').replace(/\\\"]/g, ' ');\r\n            }\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        } else if ($this.css(attrToAdd)) {\r\n            var tmpStyle = $this.css(attrToAdd);\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            arrProperties.push(option + \";\");\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        }\r\n    }\r\n};\r\n\r\n/*\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n * Sort a JSON array by attribute and order type (ascendant or descendant)\r\n * example: data = [ {attr1:val1, attr2:val2} , {attr1:val3, attr2:val4 },... ]  , key = \"attr2\" , way = \"asc\"\r\n */\r\nbizagi.util.sortJSON = function (data, key, way) {\r\n    return data.sort(function (a, b) {\r\n        var x = a[key];\r\n        var y = b[key];\r\n        if (way === 'asc') {\r\n            return ((x < y) ? -1 : ((x > y) ? 1 : 0));\r\n        }\r\n        if (way === 'desc') {\r\n            return ((x > y) ? -1 : ((x < y) ? 1 : 0));\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Reducir formato numérico a notación abrevidad (K:1000 - M:1000000 - B:1000000000)\r\n */\r\nbizagi.util.shortNumber = function (number) {\r\n    var newNumber = number.toString();\r\n    var lenghtNumber = newNumber.length;\r\n\r\n    if (lenghtNumber >= 4 && lenghtNumber < 7) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'K';\r\n    } else if (lenghtNumber >= 7 && lenghtNumber < 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'M';\r\n    } else if (lenghtNumber >= 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'B';\r\n    }\r\n\r\n    return '&nbsp;&nbsp;&nbsp;' + newNumber;\r\n};\r\n\r\n/*\r\n * Aplicar formato salto de linea\r\n */\r\nbizagi.util.replaceLineBreak = function (string) {\r\n    return typeof string === \"string\" ? string.replace(/\\r\\n|\\r|\\n|<br>|<br\\/>/g, \"<br/>\") : string;\r\n};\r\n\r\n// http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\r\nbizagi.util.escapeHtml = function (str) {\r\n    var div = document.createElement('div');\r\n    div.appendChild(document.createTextNode(str));\r\n    return div.innerHTML;\r\n}\r\n\r\n\r\n/*\r\n * Aplicar formato Tipo moneda\r\n */\r\nbizagi.util.formatMonetaryCell = function (value) {\r\n    return bizagi.util.formatMoney(value, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n};\r\n\r\n/*\r\n * Aplicar formato tipo decimal\r\n */\r\nbizagi.util.formatDecimalCell = function (value) {\r\n    var decimalFormat;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,\r\n        digitGroupSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,\r\n        roundToDecimalPlace: BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n    var numberValue = bizagi.util.formatDecimal(value, decimalFormat);\r\n    if (bizagi.override.removeTrailingZeros === true) {\r\n        var positive = true;\r\n        if (numberValue.toString().indexOf(\")\") != -1) {\r\n            positive = false;\r\n            numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n        }\r\n        var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"$1\");\r\n        re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"\");\r\n\r\n\r\n        if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n    }\r\n    return numberValue;\r\n};\r\n\r\n/*\r\n * Crea notificacion de corta duracion, principalmente uilizada en para los procesos offline\r\n */\r\nbizagi.util.showNotification = function (params) {\r\n    var params = params || {};\r\n    var div_sync = $('<div id=\"sync-notification\" class=\"bz-cm-icon\"></div>').text(params.text || \"\");\r\n    div_sync.appendTo($('body'));\r\n    div_sync.fadeIn(1500, function () {\r\n        div_sync.stop();\r\n    });\r\n\r\n    div_sync.fadeOut(2000, function () {\r\n        div_sync.remove();\r\n    });\r\n};\r\n\r\n/*\r\n * Verificar el estado de la conexión\r\n */\r\nbizagi.util.isModeOnline = function () {\r\n    return typeof bizagi.context.isOfflineForm !== \"undefined\" && !bizagi.context.isOfflineForm;\r\n};\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        } else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        } else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        } else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        } else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    } else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) {\r\n                significantFlag = true;\r\n                from = i;\r\n            } else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') {\r\n                significantFlag = true;\r\n                to = j + 1;\r\n            } else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n\r\n        } else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    } else { return ''; }\r\n};\r\n\r\n/**\r\n * Remove all backslashes that represent scape of characters\r\n */\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/*\r\n * Validates if the text is a valid opening and closing tags, including classes\r\n */\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\nbizagi.util.resetData = function () {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, { isAuthenticate: \"false\" });\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\nbizagi.util.changeData = function (params) {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, params);\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR MOBILE DEVICE\r\n// ------------------------------------------------------------------------\r\n\r\nbizagi.util.isMobileDevice = function (device) {\r\n    device = device || bizagi.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\",\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/** \r\n * Verify mobile device type\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Tablet android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Tablet iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && !(device.indexOf(\"android\") === -1);\r\n};\r\n\r\n\r\n/**\r\n * Verify mobile device type\r\n * @returns {}\r\n */\r\nbizagi.util.isSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Smartphone android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Smartphone iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"ios\") !== -1);\r\n};\r\n\r\n/**\r\n * Check is offline form\r\n * @param {} container \r\n * @returns {} \r\n */\r\nbizagi.util.isOfflineForm = function (params) {\r\n    if (!bizagi.util.isMobileDevice() || typeof (params) === \"undefined\")\r\n        return false;\r\n\r\n    var context = params.context || null;\r\n    var container = params.container || null;\r\n\r\n    var formContainer = container !== null ?\r\n        container : (context !== null ? context.getFormContainer() : null);\r\n\r\n    if (formContainer === null)\r\n        return false;\r\n\r\n    var formParams = formContainer.getParams() || {};\r\n    var isOfflineForm = typeof (formParams.isOfflineForm) !== \"undefined\" &&\r\n        bizagi.util.parseBoolean(formParams.isOfflineForm);\r\n\r\n    return isOfflineForm;\r\n};\r\n\r\nbizagi.util.detectAndroidVersion = function () {\r\n    var indexAndroid = navigator.userAgent.toLowerCase().indexOf(\"android\");\r\n    var androidVersion = navigator.userAgent.toLowerCase().substring(indexAndroid + 8, indexAndroid + 13);\r\n    androidVersion = androidVersion.replaceAll(\".\", \"\");\r\n    return Number(androidVersion);\r\n};\r\n\r\nbizagi.util.getPathUrl = function (url) {\r\n    var solvedUrl = \"\";\r\n    var locationParts = location.pathname.split(\"/\");\r\n    var basePath = location.protocol + \"//\" + location.host;\r\n\r\n    if (BIZAGI_PATH_TO_BASE[0] == \"/\") {\r\n        solvedUrl = basePath + BIZAGI_PATH_TO_BASE + url;\r\n    } else {\r\n        var pathToBaseBackwards = BIZAGI_PATH_TO_BASE.split(\"../\").length;\r\n        for (var i = 0, l = locationParts.length; i < l - pathToBaseBackwards; i++) {\r\n            basePath += locationParts[i] + \"/\";\r\n        }\r\n\r\n        basePath = basePath[basePath.length - 1] === \"/\" ? basePath : basePath + \"/\";\r\n        solvedUrl = basePath + url;\r\n    }\r\n    return solvedUrl;\r\n};\r\n\r\n/**\r\n * Get Android version\r\n * @returns {} \r\n */\r\nbizagi.util.getAndroidVersion = function () {\r\n    var userAgent = navigator.userAgent.toLowerCase();\r\n    var match = userAgent.match(/android\\s([0-9\\.]*)/);\r\n\r\n    return match ? parseFloat(match[1]) : false;\r\n};\r\n\r\n/**\r\n * Get image path to android device\r\n * @param {} image \r\n * @returns {} \r\n */\r\nbizagi.util.mobileImagePath = function (image) {\r\n    var dataImage = image;\r\n    var version = bizagi.util.getAndroidVersion();\r\n\r\n    if (!version)\r\n        return dataImage;\r\n\r\n    if (dataImage.substring(0, 21) === \"content://com.android\" && version <= 4.4) {\r\n        var photoSplit = dataImage.split(\"%3A\");\r\n        if (photoSplit.length > 1) {\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[1];\r\n        } else {\r\n            photoSplit = dataImage.split(\"/\");\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[photoSplit.length - 1];\r\n        }\r\n    }\r\n\r\n    return dataImage;\r\n};\r\n\r\n/**\r\n * Validate resource \r\n * @param {} resource resource name\r\n * @returns {} \r\n */\r\nbizagi.util.isValidResource = function (resource) {\r\n    if (!bizagi.localization) return false;\r\n    return (bizagi.localization.getResource(resource) !== resource);\r\n};\r\n\r\n/***\r\n * Transform base64 image to blob\r\n * @b64Data \r\n * @contentType \r\n * @sliceSize \r\n */\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\n/**\r\n * Converts an string to a byte array, util in old browsers requests\r\n * @param str\r\n */\r\nbizagi.util.stringToByteArray = function (str) {\r\n    var byteArray = new Uint8Array(str.length);\r\n    for (var i = 0; i < str.length; i++) {\r\n        byteArray[i] = str.charCodeAt(i) & 0xff;\r\n    }\r\n    return byteArray;\r\n}\r\n\r\n// ------------------------------------------------------------------------\r\n// NATIVE-HYBRID ENVIRONMENT\r\n// ------------------------------------------------------------------------\r\n\r\n/** \r\n * Verify the offline forms is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.hasOfflineFormsEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_OFFLINE_FORMS) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_OFFLINE_FORMS) === true;\r\n};\r\n\r\n/**\r\n * \r\n * Verify the flat design is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isFlatDesignEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_FLAT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_FLAT) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isMobileGridEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_MOBILE_GRID) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_MOBILE_GRID) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeHeaderEnabled = function () {\r\n    return typeof (NATIVE_HEADER_ENABLE) !== \"undefined\" && bizagi.util.parseBoolean(NATIVE_HEADER_ENABLE) === true;\r\n};\r\n\r\n/**\r\n * Validate the Quick search is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isQuickSearchEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_QUICK_SEARCH) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_QUICK_SEARCH) === true;\r\n};\r\n\r\n/** \r\n * Verify the OAuth2 is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isOAuth2Enabled = function () {\r\n    return typeof (BIZAGI_AUTH_TYPE) !== \"undefined\" && BIZAGI_AUTH_TYPE === \"OAuth\";\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.getNativeComponent = function () {\r\n    return typeof (BIZAGI_NATIVE_COMPONENT) !== \"undefined\" ? BIZAGI_NATIVE_COMPONENT : \"\";\r\n};\r\n\r\n/**\r\n * Check server version\r\n * @returns {}\r\n */\r\nbizagi.util.isVersionSupported = function () {\r\n    var supported = true;\r\n\r\n    if (typeof (BIZAGI_SERVER_VERSION) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_VERSION)) {\r\n        var version = BIZAGI_SERVER_VERSION.match(/\\d+\\.\\d+/);\r\n        supported = version ? (parseFloat(version.shift()) >= 11.0) : true;\r\n    }\r\n\r\n    return supported;\r\n};\r\n\r\n/**\r\n * Cordova componet is supported\r\n * @returns {} \r\n */\r\nbizagi.util.isCordovaSupported = function () {\r\n    return typeof (cordova) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Native plugin of Cordova is supported \r\n * @returns {} \r\n */\r\nbizagi.util.isNativePluginSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Tablet native\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isTabletDevice();\r\n};\r\n\r\n/**\r\n * Smartphone native\r\n * @returns {} \r\n */\r\nbizagi.util.isSmartphoneNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isSmartphoneDevice();\r\n};\r\n\r\n/**\r\n * Enables accesory bar\r\n */\r\nif (bizagi.util.isNativePluginSupported() && window.cordova && window.cordova.plugins.Keyboard) {\r\n    cordova.plugins.Keyboard.hideKeyboardAccessoryBar(false);\r\n};\r\n\r\n/**\r\n * Verify real device\r\n * @returns {} \r\n */\r\nbizagi.util.detectRealDevice = function () {\r\n    var settedDevice = typeof (BIZAGI_DEFAULT_DEVICE) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEFAULT_DEVICE) ?\r\n        BIZAGI_DEFAULT_DEVICE : null;\r\n\r\n    BIZAGI_DEFAULT_DEVICE = \"\";\r\n    var device = bizagi.detectDevice();\r\n    BIZAGI_DEFAULT_DEVICE = settedDevice;\r\n\r\n    return device;\r\n};\r\n\r\n/**\r\n * Method to detect Android visitors\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroid = function () {\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\nbizagi.util.isAndroidDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") > -1;\r\n};\r\n\r\nbizagi.util.isiOSDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") === -1;\r\n};\r\n\r\n\r\n/**\r\n * Get server channel\r\n * @returns {}\r\n */\r\nbizagi.util.getChannelType = function () {\r\n    if (typeof (BIZAGI_SERVER_CHANNEL) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_CHANNEL)) {\r\n        return BIZAGI_SERVER_CHANNEL;\r\n    }\r\n    return bizagi.loader.channel || \"\";\r\n};\r\n\r\n/**\r\n * Check data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.isDataUrl = function (data) {\r\n    var regex = /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i;\r\n\r\n    try {\r\n        return !!(data.toString()).match(regex);\r\n    } catch (error) { }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Get valid data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.getDataUrl = function (properties) {\r\n    var currentUrl;\r\n\r\n    try {\r\n        if (typeof (properties.value) !== \"undefined\" && !bizagi.util.isEmpty(properties.value)) {\r\n            var data = properties.value;\r\n            var url = data.value || data;\r\n\r\n            if (Array.isArray(url)) {\r\n                var tempUrl = url.shift();\r\n                currentUrl = Array.isArray(tempUrl) ? tempUrl.join(\"\") : tempUrl;\r\n            } else {\r\n                currentUrl = url;\r\n            }\r\n        } else {\r\n            currentUrl = properties.url || \"\";\r\n        }\r\n\r\n        currentUrl = !bizagi.util.isEmpty(currentUrl) ? \"data:image/png;base64,\" + currentUrl.replace(/^data:.*;base64,/, \"\") : \"\";\r\n\r\n        if (currentUrl && currentUrl.indexOf(\"Invalid case id\") !== -1)\r\n            currentUrl = \"\";\r\n\r\n    } catch (error) {\r\n        currentUrl = \"\";\r\n    }\r\n\r\n    return currentUrl;\r\n};\r\n\r\n/**\r\n * Get response message of services\r\n * @param {} data\r\n * @returns {}\r\n */\r\nbizagi.util.processFailMessage = function (data) {\r\n    var message = data || {};\r\n\r\n    try {\r\n        message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n        message = message.responseText || (message.message || message);\r\n    } catch (e) {\r\n        message = data;\r\n    }\r\n\r\n    return message;\r\n};\r\n\r\n/**\r\n * Disable and enable workportal menu from live process\r\n */\r\nvar tmp_block_header = \"<div class='blockHeaderByLiveProcess'></div>\";\r\nbizagi.util.disableWorkPortalMenu = function () {\r\n    var blockHeight = $(\"body\").find(\"#ui-bizagi-wp-menu\").height();\r\n    $(tmp_block_header).prependTo(\"body\");\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").css({ \"position\": \"absolute\", \"width\": \"100%\", \"height\": blockHeight + \"px\", \"background\": \"gray\", \"opacity\": \"0.9\", \"z-index\": \"101\" });\r\n}\r\n\r\nbizagi.util.enableWorkPortalMenu = function () {\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").detach();\r\n}\r\n\r\n\r\nbizagi.util.downloadFile = function(url, completeuRL) {\r\n    var ua = window.navigator.userAgent;\r\n    var msie = ua.indexOf(\"MSIE \");\r\n    var ulrToDownload = \"\";\r\n    if(completeuRL){\r\n        ulrToDownload = url;\r\n    }else{\r\n        var arrayURL = url.split(\"/\");\r\n        ulrToDownload = (window.location.href.split(\"#\")[0]) + arrayURL.slice(arrayURL.indexOf(\"Api\"), arrayURL.length).join(\"/\");\r\n    }\r\n    \r\n    if (bizagi.util.isEdge() || msie > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./)) {\r\n        if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n            $(\"<iframe/>\").attr({\r\n                src: ulrToDownload,\r\n                style: \"visibility:hidden;display:none\",\r\n                id: \"iframe-download\"\r\n            }).appendTo('body');\r\n        }else{\r\n            $('#iframe-download').attr(\"src\", (ulrToDownload));\r\n        }\r\n    } else {\r\n        window.open(ulrToDownload);\r\n    }\r\n}\r\n\r\nbizagi.util.executeActionRoutingFromWorkportal = function (idCase, idWorkItem) {\r\n    bizagi.workportal.controllers.menu.prototype.publish(\"executeAction\", {\r\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n        idCase: idCase,\r\n        idWorkItem: idWorkItem\r\n    });\r\n}\r\n\r\n/**\r\n* Gets the final message when the user is offline or online (In Offline forms)\r\n* @param {} state \r\n* @returns {} The corresponding message depending on the case\r\n*/\r\n\r\nbizagi.util.getMessageFromNetworkState = function (state) {\r\n    if (state) {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline-userOnline\", \"The case has been created successfully, please wait until the server synchronizes\");\r\n    } else {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline\", \"Your offline case has been created successfully. It will synchronized as soon as you go online.\");\r\n    }\r\n};\r\n\r\nbizagi.util.sanitizeHTML = function (str) {\r\n\tvar temp = document.createElement('div');\r\n\ttemp.textContent = str;\r\n\treturn temp.innerHTML;\r\n};\r\n\r\nbizagi.util.arrayUnique = function (array) {\r\n    var items = array.concat();\r\n\r\n    for (var i = 0, length = items.length; i < length; ++i) {\r\n        for (var j = i + 1; j < length; ++j) {\r\n            if (items[i] === items[j]) {\r\n                items.splice(j -= 1, 1);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return items;\r\n};\r\n\r\n/**\r\n * Debounce\r\n * Taken from https://davidwalsh.name/javascript-debounce-function\r\n * Returns a function, that, as long as it continues to be invoked,\r\n * will not be triggered. The function will be called after it stops\r\n * being called for N(wait) milliseconds. If `immediate` is passed,\r\n * trigger the function on the leading edge, instead of the trailing.\r\n * \r\n * @param {} func, wait, immediate \r\n * @returns {} The function that that will be called back\r\n */\r\nbizagi.util.debounce = function (func, wait, immediate) {\r\n    var timeout;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        var later = function () {\r\n            timeout = null;\r\n            if (!immediate) func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) func.apply(context, args);\r\n    };\r\n};\r\n\r\n/**\r\n * Validate if the mobile image editor is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeImageEditorSupported = function () {\r\n    return bizagi.util.isNativePluginSupported() && bizagi.util.isiOSDevice() && bizagi.override.enableImageEditor;\r\n};\r\n/**\r\n * Error Message\r\n */\r\nbizagi.util.errorMessage  = function (message) {\r\n    return \"<div class=\\\"admin-stakeholder-message\\\"> \" +\r\n    \"<i class=\\\"bz-wp-empty__img\\\"></i> \" +\r\n    \"<p class=\\\"bz-wp-empty__info bz-wp-empty__info--first\\\"> \" +\r\n    message +\r\n    \"</p></div>\";\r\n};\r\n\r\n\r\n/**\r\n * Validate URL \r\n */\r\nbizagi.util.validateUrlWellFormed  = function (url) {\r\n    var patternToValidateUrl = /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/;\r\n    if(patternToValidateUrl.test(url)){\r\n        var patternToValidateHttp = /^((http|https):\\/\\/)/;\r\n        if(!patternToValidateHttp.test(url)) {\r\n            url = \"http://\" + url;\r\n        }\r\n        return url;\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Replace line breaks for html line breaks\r\n * @param data\r\n * @returns {string}\r\n */\r\nbizagi.util.decodedDisplayValue = function (data) {\r\n    var value = data || \"\";\r\n    var valueToDisplay = \"\";\r\n\r\n    if (typeof (value) === \"string\") {\r\n        var decodedDisplayValue = bizagi.util.decodeURI(value);\r\n\r\n        valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"$\", \"&#36;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n    }\r\n\r\n    return valueToDisplay;\r\n};\r\n\r\n/**\r\n * Set Caret position \r\n * Set the caret in specific position of an element type input\r\n * @param {} func, position, input element \r\n * @returns {} The function not return any value.\r\n */\r\nbizagi.util.setCaretPosition = function (pos, ctrl) {\r\n    var self = this;\r\n\r\n    // Modern browsers\r\n    if (ctrl.setSelectionRange) {\r\n        ctrl.focus();\r\n        ctrl.setSelectionRange(pos, pos);\r\n\r\n        // IE8 and below\r\n    } else if (ctrl.createTextRange) {\r\n        var range = ctrl.createTextRange();\r\n        range.collapse(true);\r\n        range.moveEnd('character', pos);\r\n        range.moveStart('character', pos);\r\n        range.select();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get position of caret\r\n * Get the position of caret in a specific element input\r\n * @param {} func, input element \r\n * @returns {} Return the position of caret in an element input\r\n */\r\nbizagi.util.getCaretPosition = function (oField) {\r\n\r\n    // Initialize\r\n    var iCaretPos = 0;\r\n\r\n    // IE Support\r\n    if (document.selection) {\r\n\r\n        // Set focus on the element\r\n        oField.focus();\r\n\r\n        // To get cursor position, get empty selection range\r\n        var oSel = document.selection.createRange();\r\n\r\n        // Move selection start to 0 position\r\n        oSel.moveStart('character', -oField.value.length);\r\n\r\n        // The caret position is selection length\r\n        iCaretPos = oSel.text.length;\r\n    } else if (oField.selectionStart || oField.selectionStart == '0') // Firefox support\r\n        iCaretPos = oField.selectionStart;\r\n\r\n    // Return results\r\n    return iCaretPos;\r\n};\r\n\r\n/**\r\n * To escape values\r\n * @param {} value \r\n * @returns {} \r\n */\r\nbizagi.util.escapeRegex = function (value) {\r\n    value = value || \"\";\r\n\r\n    return value.replace(/([\\^\\$\\(\\)\\[\\]\\{\\}\\*\\.\\+\\?\\|\\\\])/gi, \"\\\\$1\");\r\n};\r\n\r\n/**\r\n * Function to get a featureObject by path within the global bizagiConfig.features object. Example: \"userService.v1.enabled\"\r\n */\r\nbizagi.util.getFeatureObject = function (path) {\r\n    var arr = path.split('.');\r\n    this.featureObjectCache = this.featureObjectCache || {};\r\n\r\n    function getFeatureObjectIte(arr) {\r\n        var features = bizagi.util.getConfigFeatures();\r\n\r\n        if (typeof path !== \"string\" || typeof features == \"undefined\") return;\r\n\r\n        var pivot = features;\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            pivot = pivot[arr[i]];\r\n            if (typeof pivot === \"undefined\") return;\r\n        }\r\n        return pivot;\r\n    };\r\n    if (path in this.featureObjectCache) {\r\n        return this.featureObjectCache[path];\r\n    } else {\r\n        return this.featureObjectCache[path] = getFeatureObjectIte(arr);\r\n    }\r\n};\r\n\r\n/**\r\n * Load features from mobile\r\n */\r\nbizagi.util.getConfigFeatures = function () {\r\n    var bizagiConfiguration = window.bizagiConfig || bizagiConfig || {};\r\n\r\n    if(bizagi.util.isMobileDevice() && typeof(BIZAGI_MOBILE_FEATURES) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_MOBILE_FEATURES)) {\r\n        bizagiConfiguration.features = JSON.parse(BIZAGI_MOBILE_FEATURES || \"{}\")\r\n    }\r\n\r\n    return bizagiConfiguration.features;\r\n};\r\n\r\n/**\r\n * Reset features flag\r\n */\r\nbizagi.util.resetConfigFeatures = function () {\r\n    bizagi.util.featureObjectCache = undefined;\r\n};\r\n\r\n/**\r\n * Check fail request\r\n * @param result\r\n * @returns {*|boolean}\r\n */\r\nbizagi.util.isFailResponse = function (result) {\r\n    return result && ((result.type && result.type === \"error\") || (result.status && result.status === \"error\") || (result.code && result.code === \"UNKNOWN_ERROR\"));\r\n};\r\n\r\n/**\r\n * Formats value of each item\r\n * @param {string, boolean or array} value\r\n * @example\r\n * value = \"string\" => \"string\"\r\n * value = true => \"yes\" or \"si\", the localized value\r\n * value = false => \"no\", the localized value\r\n * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n * @returns {string}\r\n */\r\nbizagi.util.formatItem = function (value) {\r\n    if (value !== undefined && value !== null) {\r\n        if ($.isArray(value)) {\r\n\r\n            for (var i = 0, length = value.length; i < length; i++) {\r\n                if (value[i] != null && typeof (value[i]) == \"boolean\") {\r\n                    if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n\r\n                    } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                    }\r\n                }\r\n                value[i] = bizagi.util.sanitizeHTML(value[i]);\r\n            }\r\n\r\n            return value.join(\" - \");\r\n        } else {\r\n            return bizagi.util.sanitizeHTML(value);\r\n        }\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\n/**\r\n * Process response to highlight matches\r\n * @param {} item\r\n * @param term\r\n * @returns {}\r\n */\r\nbizagi.util.highlightMatches = function(item, term) {\r\n    var parseValue;\r\n\r\n    switch (typeof item.value) {\r\n        case \"number\":\r\n            parseValue = item.value;\r\n            break;\r\n        case \"object\":\r\n            parseValue = bizagi.util.formatItem(item.value);\r\n            break;\r\n        case \"string\":\r\n            var data = bizagi.util.escapeRegex(term).replaceAll(\"%\", \"\");\r\n            var regEx = new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + data + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\");\r\n\r\n            parseValue = bizagi.util.sanitizeHTML(item.value).replace(regEx, \"<strong>$1</strong>\");\r\n            break;\r\n        default:\r\n            parseValue = item.value;\r\n            break;\r\n    }\r\n\r\n    return parseValue;\r\n};\r\n\r\n/**\r\n * Calculate window resolution for Desktop\r\n * @returns {string}\r\n */\r\nbizagi.util.getDesktopResolution = function() {\r\n    var resolution = \"\";\r\n    var devicePixelRatio = 1;\r\n    var screenWidth = window.screen.width;\r\n    var screenHeight = window.screen.height;\r\n\r\n    if ('deviceXDPI' in screen) {\r\n        devicePixelRatio = screen.deviceXDPI / screen.logicalXDPI;\r\n    } else if ('devicePixelRatio' in window) {\r\n        devicePixelRatio = window.devicePixelRatio;\r\n    }\r\n\r\n    devicePixelRatio = Number(devicePixelRatio.toFixed(3));\r\n\r\n    if ((screenWidth && screenWidth > 0) && (screenHeight && screenHeight > 0)) {\r\n        resolution = (screenWidth * devicePixelRatio) + \"x\" + (screenHeight * devicePixelRatio);\r\n    }\r\n\r\n    return resolution;\r\n};\r\n\r\n/**\r\n * Get the market name for device\r\n * @returns {*|string}\r\n */\r\nbizagi.util.getDeviceCode = function () {\r\n    var deviceCode = \"\";\r\n\r\n    if (bizagi.util.isMobileDevice()) {\r\n        deviceCode = typeof (BIZAGI_DEVICE_MARKET_NAME) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEVICE_MARKET_NAME) ? BIZAGI_DEVICE_MARKET_NAME : \"\";\r\n    } else {\r\n        deviceCode = bizagi.util.getDesktopResolution();\r\n    }\r\n\r\n    return deviceCode;\r\n};\r\n\r\n/**\r\n * Get base name of the control\r\n * @param type\r\n * @returns {*}\r\n */\r\nbizagi.util.normalizeType = function(type) {\r\n    if (typeof (type) === \"undefined\") return type;\r\n\r\n    return type\r\n        .replace(/smartphone/, '')\r\n        .replace(/tablet/, '')\r\n        .replace(/offline/, '');\r\n};\r\n\r\n/**\r\n * Hide or show the X button in the show dialog method \r\n * \r\n */\r\nbizagi.util.hideOrShowXToCloseDialog = function(dialog, show) {\r\n    var selector = \".ui-dialog-titlebar-close\";\r\n    if (show) {\r\n        $(selector, dialog).show();\r\n    } else {\r\n        $(selector, dialog).hide();\r\n    }\r\n};\r\n\r\n/**\r\n * review if a feature key is enabled\r\n * @param {string} feature nombre de la llave del feature\r\n */\r\nbizagi.util.isEnableFeature = function(feature) {\r\n    return bizagi.features[feature]!==false;\r\n};\r\n\r\n/**\r\n * A function to get the scrolling parent of an html element.\r\n */\r\n(function ($) {\r\n\r\n    var parents = function (node, ps) {\r\n        if (node.parentNode === null) return ps;\r\n\r\n        return parents(node.parentNode, ps.concat([node]));\r\n    };\r\n\r\n    var style = function (node, prop) {\r\n        return getComputedStyle(node, null).getPropertyValue(prop);\r\n    };\r\n\r\n    var overflow = function (node) {\r\n        return style(node, \"overflow\") + style(node, \"overflow-y\") + style(node, \"overflow-x\");\r\n    };\r\n\r\n    var scroll = function (node) {\r\n        return /(auto|scroll)/.test(overflow(node));\r\n    };\r\n\r\n    // Get the closest ancestor element that is scrollable.\r\n    $.scrollerParent = function (node) {\r\n        if (!(node instanceof HTMLElement || node instanceof SVGElement)) return;\r\n\r\n        var ps = parents(node.parentNode, []);\r\n\r\n        for (var i = 0; i < ps.length; i += 1) {\r\n            if (scroll(ps[i])) return ps[i];\r\n        }\r\n\r\n        return document.scrollingElement || document.documentElement;\r\n    };\r\n})(jQuery);\r\n\r\nbizagi.util.startkendo = function (params) {\r\n    if (typeof (bizagi.kendoMobileApplication) === \"undefined\") {\r\n        bizagi.kendoMobileApplication = new kendo.mobile.Application($(\"body\"), {\r\n            skin: \"flat\",\r\n            browserHistory: false,\r\n            init: function (e) {\r\n                kendo.ui.progress($(\".km-flat\"), true);\r\n                params.started && params.started();\r\n            }\r\n        });\r\n\r\n        bizagi.kendoMobileApplication.bizagiNavigate = function (e, t) {\r\n            this.navigate(e, t);\r\n        };\r\n    } else {\r\n        params.started && params.started();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.isSharepointContext = function () {\r\n    return typeof (BIZAGI_SHAREPOINT_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_SHAREPOINT_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * Checks if a given value with format {id, value} is empty\r\n * @param value\r\n  * @returns {boolean}\r\n  */\r\nbizagi.util.isEmptyValue = function (value) {\r\n    if (value === 0) return false;\r\n    if (value === undefined || value === null || value === \"\") return true;\r\n    if (typeof (value) === \"Array\") return value.length === 0;\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") return value.length === 0;\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        for (var key in value) {\r\n            if (value.hasOwnProperty(key) && !bizagi.util.isEmptyValue(value[key])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n","bizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\n\r\n/**\r\n * Method to detect iPad visitors\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n\r\n/**\r\n *   Returns a boolean if there are two equal objects\r\n */\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n\r\n/**\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/**\r\n *   Encodes the xpath\r\n */\r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath))\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n\r\n/**\r\n *   Add a clone to the object prototype\r\n */\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n\r\n/**\r\n *   Generates a random guid\r\n */\r\nMath.guid = function () {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n};\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n *\r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n\r\n    self.add = function (callback) {\r\n        queue.push({ callbacks: [callback] });\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (queue.length == 0)\r\n            return self.add(callback);\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\")\r\n                        return callback();\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        };\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n};\r\n\r\n/**\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n\r\n/**\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n*   Read the query string parameteres\r\n*/\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = 0; i < pairs.length; i++) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n\r\n\r\n/*\r\n*   Info scenarios\r\n*/\r\nvar scenarioInfo = (function(params) {\r\n    var self = this;\r\n    var _state = {};\r\n\r\n    /**\r\n    * Return url where is located specific scenario\r\n    *\r\n    * @param params\r\n    * @returns {string}\r\n    */\r\n    self.getFileScenario = function(params) {\r\n        params = params || {};\r\n        var url = \"\";\r\n        var scenario = params.scenario.split(\".\") || [];\r\n        var category = scenario[0];\r\n\r\n        url = BIZAGI_SMARTPHONE_PATH + \"scenarios/\" + category + \"/\" + params.scenario + \".js\";\r\n\r\n        return url;\r\n    };\r\n\r\n    return {\r\n        getFileScenario: self.getFileScenario\r\n    };\r\n});\r\n\r\n/**\r\n *   Determines if parameter 'n' is numeric\r\n */\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n/**\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n/*\r\n * Method to detect Android visitors\r\n */\r\nbizagi.util.isAndroid = function(){\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\n/**\r\n * Functions to loading\r\n */\r\n(function ($) {\r\n    $.fn.startLoading = function (params) {\r\n        bizagi.util.smartphone.startLoading();\r\n    };\r\n\r\n    $.fn.endLoading = function () {\r\n        bizagi.util.smartphone.stopLoading();\r\n    };\r\n})(jQuery);\r\n\r\n/***\r\n * Removes the objects and dispose\r\n * @param obj\r\n */\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\n/**\r\n* Remove all backslashes that represent scape of characters\r\n*/\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/**\r\n * CryptoJS MD5 \r\n * @param {} message \r\n * @returns {} \r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */    \r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n\r\n/***\r\n* Transform base64 image to blob\r\n* @b64Data \r\n* @contentType \r\n* @sliceSize \r\n*/\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n/*\r\n* Validates if the text is a valid opening and closing tags, including classes\r\n*/\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\n\r\n/*\r\n*   Determines if a control as a scrollbar \r\n*/\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Convert String to Base64 Unicode\r\n * @param {} str \r\n * @returns {} \r\n */\r\nbizagi.util.b64EncodeUnicode = function(string) {\r\n    return btoa(encodeURIComponent(string).replace(/%([0-9A-F]{2})/g, function (match, p1) {\r\n        return String.fromCharCode(\"0x\" + p1);\r\n    }));\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        }\r\n        else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        }\r\n        else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        }\r\n        else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        }\r\n        else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    }\r\n    else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) { significantFlag = true; from = i; }\r\n            else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') { significantFlag = true; to = j + 1; }\r\n            else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            }\r\n            else { return '0'; }\r\n\r\n        }\r\n        else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    }\r\n    else { return ''; }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Array]\";\r\n};","/*\r\n* jQuery UI Mask @VERSION\r\n*\r\n* Copyright (c) 2009 AUTHORS.txt (http://jqueryui.com/about)\r\n* Dual licensed under the MIT (MIT-LICENSE.txt)\r\n* and GPL (GPL-LICENSE.txt) licenses.\r\n*\r\n* Based on the jquery.maskedinput.js plugin by Josh Bush (digitalbush.com)\r\n*\r\n* http://docs.jquery.com/UI/Mask\r\n*\r\n* Depends:\r\n*   ui.core.js\r\n*/\r\n(function ($) {    \r\n\r\n    var pasteEventName = (bizagi.util.isEventSupported('paste') ? 'paste' : 'input') + \".mask\";\r\n\r\n    $.widget(\"ui.mask\", {\r\n\r\n        _init: function () {\r\n\r\n            var options = this.options, self = this;\r\n\r\n            $.extend(this, { caret: function (begin, end) { return $.ui.mask.caret(self.element, begin, end); } });\r\n\r\n            if (!options.mask || !options.mask.length) { return; } //no mask pattern defined. no point in continuing.\r\n            if (!options.placeholder || !options.placeholder.length) {\r\n                options.placeholder = '_'; //in case the user decided to nix a placeholder. \r\n            }\r\n\r\n            this._prepareBuffer();\r\n            this._bindEvents();\r\n            this._checkVal((this.element.val().length && options.allowPartials)); //Perform initial check for existing values\r\n        },\r\n\r\n        destroy: function () {\r\n            this.element\r\n\t\t\t.unbind('.mask')\r\n\t\t\t.removeData('mask');\r\n        },\r\n\r\n        value: function () {\r\n            var input = this.element,\r\n\t\t\tself = this,\r\n\t\t\tres = $.map(self.buffer, function (c, i) { return self.tests[i] ? c : null; }).join(''),\r\n\t\t\tr = new RegExp('\\\\' + this.options.placeholder, 'gi');\r\n            return res.replace(r, '');\r\n        },\r\n\r\n        formatted: function () {\r\n            var r = new RegExp('\\\\' + this.options.placeholder, 'gi'),\r\n\t\t\tres = this.element.val();\r\n            return res.replace(r, '');\r\n        },\r\n\r\n        apply: function () {\r\n            this.element.trigger('apply.mask');\r\n        },\r\n\r\n        _setData: function (key, value) {\r\n\r\n            $.widget.prototype._setData.apply(this, arguments);\r\n            var options = this.options;\r\n\r\n            switch (key) {\r\n                case 'mask':\r\n                    //no mask pattern defined. no point in continuing.\r\n                    if (!options.mask || !options.mask.length) {\r\n                        this.element.unbind('.mask')\r\n                        break;\r\n                    }\r\n                case 'placeholder':\r\n                    if (!options.placeholder || !options.placeholder.length) {\r\n                        options.placeholder = '_'; //in case the user decided to nix a placeholder.\r\n                    }\r\n                    this.element.val('');\r\n                    this._prepareBuffer();\r\n                    !this.eventsBound && this._bindEvents();\r\n                    break;\r\n            }\r\n\r\n        },\r\n\r\n        _prepareBuffer: function () {\r\n\r\n            this._escapeMask();\r\n\r\n            var self = this,\r\n\t\t\tinput = this.element,\r\n\t\t\toptions = this.options,\r\n\t\t\tmask = options.mask,\r\n\t\t\tdefs = $.ui.mask.definitions,\r\n\t\t\ttests = [],\r\n\t\t\tpartialPosition = mask.length,\r\n\t\t\tfirstNonMaskPos = null,\r\n\t\t\tlen = mask.length;\r\n\r\n            //if we're applying the mask to an element which is not an input, it won't have a val() method. fake one for our purposes.\r\n            if (!input.is(':input')) input.val = input.html;\r\n\r\n            $.each(mask.split(\"\"), function (i, c) {\r\n                if (c == '?') {\r\n                    len--;\r\n                    partialPosition = i;\r\n                }\r\n                else if (defs[c]) {\r\n                    tests.push(new RegExp(defs[c]));\r\n                    if (firstNonMaskPos == null)\r\n                        firstNonMaskPos = tests.length - 1;\r\n                }\r\n                else {\r\n                    tests.push(null);\r\n                }\r\n            });\r\n\r\n            $.extend(this, {\r\n                buffer: $.map(mask.split(\"\"), function (c, i) {\r\n                    if (c != '?') {\r\n                        return defs[c] ? options.placeholder : c;\r\n                    }\r\n                }),\r\n                tests: tests,\r\n                firstNonMaskPos: firstNonMaskPos,\r\n                partialPosition: partialPosition\r\n            });\r\n\r\n            this.buffer = $.map(this.buffer, function (c, i) {\r\n                if (c == \"\\t\") {\r\n                    return self.maskEscaped[i];\r\n                }\r\n                return c;\r\n            });\r\n\r\n            this.options.mask = mask = this.maskEscaped;\r\n        },\r\n\r\n        _bindEvents: function () {\r\n\r\n            var self = this,\r\n\t\t\tinput = this.element,\r\n\t\t\tignore = false,  \t\t\t//Variable for ignoring control keys\r\n\t\t\tfocusText = input.val();\r\n\r\n            function keydownEvent(e) {\r\n                e = e || window.event;\r\n                var pos = self.caret(),\r\n\t\t\t\tk = e.keyCode,\r\n\t\t\t\tkeyCode = $.ui.keyCode;\r\n\r\n                ignore = (k < keyCode.SHIFT || (k > keyCode.SHIFT && k < keyCode.SPACE) || (k > keyCode.SPACE && k < 41));\r\n\r\n                //delete selection before proceeding\r\n                if ((pos.begin - pos.end) != 0 && (!ignore || k == keyCode.BACKSPACE || k == keyCode.DELETE))\r\n                    self._clearBuffer(pos.begin, pos.end);\r\n\r\n                //backspace, delete, and escape get special treatment\r\n                if (k == keyCode.BACKSPACE || k == keyCode.DELETE) {//backspace/delete\r\n                    self._shiftL(pos.begin + ((k == keyCode.DELETE || (k == keyCode.BACKSPACE && pos.begin != pos.end)) ? 0 : -1), Math.abs(pos.begin - pos.end));\r\n                    return false;\r\n                }\r\n                else if (k == keyCode.ESCAPE) {//escape\r\n                    input.val(focusText);\r\n                    self.caret(0, self._checkVal());\r\n                    return false;\r\n                }\r\n            };\r\n\r\n            function keypressEvent(e) {\r\n\r\n                e = e || window.event;\r\n\r\n                var k = e.charCode || e.keyCode || e.which,\r\n\t\t\t\tkeyCode = $.ui.keyCode,\r\n\t\t\t\tlen = self.options.mask.length;\r\n\r\n                if (ignore) {\r\n                    ignore = false;\r\n                    //Fixes Mac FF bug on backspace\r\n                    return (e.keyCode == keyCode.BACKSPACE) ? false : null;\r\n                }\r\n\r\n                var pos = self.caret();\r\n\r\n                if (e.ctrlKey || e.altKey || e.metaKey) {//Ignore\r\n                    return true;\r\n                }\r\n                else if ((k >= keyCode.SPACE && k <= 125) || k > 186) {//typeable characters\r\n                    var p = self._seekNext(pos.begin - 1);\r\n                    if (p < len) {\r\n                        var c = String.fromCharCode(k);\r\n                        if (self.tests[p] && self.tests[p].test(c)) {\r\n                            self._shiftR(p);\r\n                            self.buffer[p] = c;\r\n                            self._writeBuffer();\r\n                            var next = self._seekNext(p);\r\n                            self.caret(next);\r\n                            self.options.completed && next == len && self.options.completed.call(input);\r\n                        }\r\n                    }\r\n                }\r\n                return false;\r\n            };\r\n\r\n            if (!input.attr(\"readonly\")) {\r\n                input\r\n\t\t\t\t.bind(\"focus.mask\", function () {\r\n\t\t\t\t    focusText = input.val();\r\n\t\t\t\t    var pos = self._checkVal();\r\n\t\t\t\t    self._writeBuffer();\r\n\t\t\t\t    setTimeout(function () {\r\n\t\t\t\t        if (pos == self.options.mask.length)\r\n\t\t\t\t            self.caret(0, pos);\r\n\t\t\t\t        else\r\n\t\t\t\t            self.caret(pos);\r\n\t\t\t\t    }, 0);\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"blur.mask\", function () {\r\n\t\t\t\t    self._checkVal();\r\n\t\t\t\t    if (input.val() != focusText)\r\n\t\t\t\t        input.change();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"apply.mask\", function () { //changing the value of an input without keyboard input requires re-applying the mask.\r\n\t\t\t\t    focusText = input.val();\r\n\t\t\t\t    var pos = self._checkVal();\r\n\t\t\t\t    self._writeBuffer();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown.mask\", keydownEvent)\r\n\t\t\t\t.bind(\"keypress.mask\", keypressEvent)\r\n\t\t\t\t.bind(pasteEventName, function () {\r\n\t\t\t\t    setTimeout(function () { self.caret(self._checkVal(true)); }, 0);\r\n\t\t\t\t});\r\n                this.eventsBound = true;\r\n            }\r\n        },\r\n\r\n        _writeBuffer: function () {\r\n            return this.element.val(this.buffer.join('')).val();\r\n        },\r\n\r\n        _clearBuffer: function (start, end) {\r\n            var len = this.options.mask.length;\r\n            for (var i = start; i < end && i < len; i++) {\r\n                if (this.tests[i])\r\n                    this.buffer[i] = this.options.placeholder;\r\n            }\r\n        },\r\n\r\n        _seekNext: function (pos) {\r\n            var len = this.options.mask.length;\r\n            while (++pos <= len && !this.tests[pos]);\r\n            return pos;\r\n        },\r\n\r\n        _shiftR: function (pos) {\r\n            var len = this.options.mask.length;\r\n            for (var i = pos, c = this.options.placeholder; i < len; i++) {\r\n                if (this.tests[i]) {\r\n                    var j = this._seekNext(i);\r\n                    var t = this.buffer[i];\r\n                    this.buffer[i] = c;\r\n                    if (j < len && this.tests[j].test(t)) {\r\n                        c = t;\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        _shiftL: function (pos, length) {\r\n\r\n            while (!this.tests[pos] && --pos >= 0);\r\n\r\n            var originalPos = pos,\r\n\t\t\tlen = this.options.mask.length,\r\n\t\t\tplaceholder = this.options.placeholder;\r\n\r\n            for (var i = pos; i < len && (i >= 0 || length > 1); i++) {\r\n                if (this.tests[i]) {\r\n                    this.buffer[i] = placeholder;\r\n                    var j = this._seekNext(i);\r\n                    if (j < len && this.tests[i].test(this.buffer[j])) {\r\n                        this.buffer[pos] = this.buffer[j];\r\n                        this.buffer[j] = placeholder;\r\n                        pos++;\r\n                        while (!this.tests[pos]) pos++;\r\n                    }\r\n                }\r\n            }\r\n            this._writeBuffer();\r\n            this.caret(Math.max(this.firstNonMaskPos, originalPos));\r\n        },\r\n\r\n        _checkVal: function (allow) {\r\n            //try to place characters where they belong\r\n            var input = this.element,\r\n\t\t\ttest = input.val(),\r\n\t\t\tlen = this.options.mask.length,\r\n\t\t\tlastMatch = -1;\r\n\r\n            for (var i = 0, pos = 0; i < len; i++) {\r\n                if (this.tests[i]) {\r\n                    this.buffer[i] = this.options.placeholder;\r\n                    while (pos++ < test.length) {\r\n                        var c = test.charAt(pos - 1);\r\n                        if (this.tests[i].test(c)) {\r\n                            this.buffer[i] = c;\r\n                            lastMatch = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (pos > test.length)\r\n                        break;\r\n                }\r\n                else if (this.buffer[i] == test[pos] && i != this.partialPosition) {\r\n                    pos++;\r\n                    lastMatch = i;\r\n                }\r\n            }\r\n            if (!allow && lastMatch + 1 < this.partialPosition) {\r\n                if (!this.options.allowPartials || !this.value().length) {\r\n                    input.val(\"\");\r\n                    this._clearBuffer(0, len);\r\n                }\r\n                else //if we're allowing partial input/inital values, and the element we're masking isnt an input, then we need to allow the mask to apply.\r\n                    if (!input.is(':input')) this._writeBuffer();\r\n\r\n            }\r\n            else if (allow || lastMatch + 1 >= this.partialPosition) {\r\n                this._writeBuffer();\r\n                if (!allow) input.val(input.val().substring(0, lastMatch + 1));\r\n            }\r\n            return (this.partialPosition ? i : this.firstNonMaskPos);\r\n        },\r\n\r\n        _escapeMask: function () {\r\n            var mask = this.options.mask,\r\n\t\t\tliterals = [],\r\n\t\t\treplacements = [];\r\n\r\n            for (var i = 0; i < mask.length; i++) {\r\n                var c, temp = mask[i] || mask.charAt(i);\r\n                if (temp != \"\\\\\" || mask[i - 1] == \"\\\\\") {\r\n                    if (mask[i - 1] == \"\\\\\") {\r\n                        c = \"\\t\";\r\n                        replacements[literals.length] = temp;\r\n                    }\r\n                    else {\r\n                        c = temp;\r\n                    }\r\n                    literals[literals.length] = c;\r\n                }\r\n            }\r\n\r\n            this.options.mask = literals.join('');\r\n\r\n            for (var i = 0; i < literals.length; i++) {\r\n                if (replacements[i] !== undefined) {\r\n                    literals[i] = replacements[i];\r\n                }\r\n            }\r\n\r\n            this.maskEscaped = literals.join('');\r\n        }\r\n\r\n    });\r\n\r\n    $.extend($.ui.mask, {\r\n        version: \"@VERSION\",\r\n        getter: \"value formatted\",\r\n        defaults: {\r\n            mask: '',\r\n            placeholder: '_',\r\n            completed: null,\r\n            allowPartials: false\r\n        },\r\n        definitions: { //Predefined character definitions\r\n            '#': \"[\\\\d]\",\r\n            'a': \"[A-Za-z]\",\r\n            '*': \"[A-Za-z0-9]\"\r\n        },\r\n        caret: function (element, begin, end) {\t//Helper Function for Caret positioning\r\n            var input = element[0];\r\n            if (typeof begin == 'number') {\r\n                end = (typeof end == 'number') ? end : begin;\r\n                if (input.setSelectionRange) {\r\n                    input.focus();\r\n                    input.setSelectionRange(begin, end);\r\n                } else if (input.createTextRange) {\r\n                    var range = input.createTextRange();\r\n                    range.collapse(true);\r\n                    range.moveEnd('character', end);\r\n                    range.moveStart('character', begin);\r\n                    range.select();\r\n                }\r\n                return element;\r\n            } else {\r\n                if (input.setSelectionRange) {\r\n                    begin = input.selectionStart;\r\n                    end = input.selectionEnd;\r\n                }\r\n                else if (document.selection && document.selection.createRange) {\r\n                    var range = document.selection.createRange();\r\n                    begin = 0 - range.duplicate().moveStart('character', -100000);\r\n                    end = begin + range.text.length;\r\n                }\r\n                return { begin: begin, end: end };\r\n            }\r\n        }\r\n    });\r\n\r\n})(jQuery);","/*\r\n*\r\n* Copyright (c) 2006/2007 Sam Collett (http://www.texotela.co.uk)\r\n* Licensed under the MIT License:\r\n* http://www.opensource.org/licenses/mit-license.php\r\n* \r\n* Version 1.0\r\n* Demo: http://www.texotela.co.uk/code/jquery/numeric/\r\n*\r\n* $LastChangedDate: 2007-05-29 11:31:36 +0100 (Tue, 29 May 2007) $\r\n* $Rev: 2005 $\r\n*/\r\n\r\n/*\r\n* Allows only valid characters to be entered into input boxes.\r\n* Note: does not validate that the final text is a valid number\r\n* (that could be done by another script, or server-side)\r\n*\r\n* @name     numeric\r\n* @param    decimal      Decimal separator (e.g. '.' or ',' - default is '.')\r\n* @param    callback     A function that runs if the number is not valid (fires onblur)\r\n* @author   Sam Collett (http://www.texotela.co.uk)\r\n* @example  $(\".numeric\").numeric();\r\n* @example  $(\".numeric\").numeric(\",\");\r\n* @example  $(\".numeric\").numeric(null, callback);\r\n*\r\n*/\r\njQuery.fn.numeric = function (decimal, callback) {\r\n    decimal = decimal || \".\";\r\n    callback = typeof callback == \"function\" ? callback : function () { };\r\n    this.keypress(\r\n\t\tfunction (e) {\r\n\t\t    var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;\r\n\t\t    // allow enter/return key (only when in an input box)\r\n\t\t    if (key == 13 && this.nodeName.toLowerCase() == \"input\") {\r\n\t\t        return true;\r\n\t\t    }\r\n\t\t    else if (key == 13) {\r\n\t\t        return false;\r\n\t\t    }\r\n\t\t    var allow = false;\r\n\t\t    // allow Ctrl+A\r\n\t\t    if ((e.ctrlKey && key == 97 /* firefox */) || (e.ctrlKey && key == 65) /* opera */) return true;\r\n\t\t    // allow Ctrl+X (cut)\r\n\t\t    if ((e.ctrlKey && key == 120 /* firefox */) || (e.ctrlKey && key == 88) /* opera */) return true;\r\n\t\t    // allow Ctrl+C (copy)\r\n\t\t    if ((e.ctrlKey && key == 99 /* firefox */) || (e.ctrlKey && key == 67) /* opera */) return true;\r\n\t\t    // allow Ctrl+Z (undo)\r\n\t\t    if ((e.ctrlKey && key == 122 /* firefox */) || (e.ctrlKey && key == 90) /* opera */) return true;\r\n\t\t    // allow or deny Ctrl+V (paste), Shift+Ins\r\n\t\t    if ((e.ctrlKey && key == 118 /* firefox */) || (e.ctrlKey && key == 86) /* opera */\r\n\t\t\t|| (e.shiftKey && key == 45)) return true;\r\n\t\t    // if a number was not pressed\r\n\t\t    if (key < 48 || key > 57) {\r\n\t\t        /* '-' only allowed at start */\r\n\t\t        if (key == 45 && this.value.length == 0) return true;\r\n\t\t        /* only one decimal separator allowed */\r\n\t\t        if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) != -1) {\r\n\t\t            allow = false;\r\n\t\t        }\r\n\t\t        // check for other keys that have special purposes\r\n\t\t        if (\r\n\t\t\t\t\tkey != 8 /* backspace */ &&\r\n\t\t\t\t\tkey != 9 /* tab */ &&\r\n\t\t\t\t\tkey != 13 /* enter */ &&\r\n\t\t\t\t\tkey != 35 /* end */ &&\r\n\t\t\t\t\tkey != 36 /* home */ &&\r\n\t\t\t\t\tkey != 37 /* left */ &&\r\n\t\t\t\t\tkey != 39 /* right */ &&\r\n\t\t\t\t\tkey != 46 /* del */\r\n\t\t\t\t) {\r\n\t\t            allow = false;\r\n\t\t        }\r\n\t\t        else {\r\n\t\t            // for detecting special keys (listed above)\r\n\t\t            // IE does not support 'charCode' and ignores them in keypress anyway\r\n\t\t            if (typeof e.charCode != \"undefined\") {\r\n\t\t                // special keys have 'keyCode' and 'which' the same (e.g. backspace)\r\n\t\t                if (e.keyCode == e.which && e.which != 0) {\r\n\t\t                    allow = true;\r\n\t\t                }\r\n\t\t                // or keyCode != 0 and 'charCode'/'which' = 0\r\n\t\t                else if (e.keyCode != 0 && e.charCode == 0 && e.which == 0) {\r\n\t\t                    allow = true;\r\n\t\t                }\r\n\t\t            }\r\n\t\t        }\r\n\t\t        // if key pressed is the decimal and it is not already in the field\r\n\t\t        if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) == -1) {\r\n\t\t            allow = true;\r\n\t\t        }\r\n\t\t    }\r\n\t\t    else {\r\n\t\t        allow = true;\r\n\t\t    }\r\n\t\t    return allow;\r\n\t\t}\r\n\t)\r\n\t.blur(\r\n\t\tfunction () {\r\n\t\t    var val = jQuery(this).val();\r\n\t\t    if (val != \"\") {\r\n\t\t        var re = new RegExp(\"^\\\\d+$|\\\\d*\" + decimal + \"\\\\d+\");\r\n\t\t        if (!re.exec(val)) {\r\n\t\t            callback.apply(this);\r\n\t\t        }\r\n\t\t    }\r\n\t\t}\r\n\t);\r\n    return this;\r\n}\r\n\r\njQuery.fn.numericSN = function (decimal, exp) {\r\n    decimal = decimal || \".\";\r\n    exp = exp || \"e\";\r\n    var plus = '+';\r\n    var minus = '-';\r\n    callback = typeof callback == \"function\" ? callback : function () { };\r\n    this.keypress(\r\n        function (e) {\r\n            var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;\r\n            // allow enter/return key (only when in an input box)\r\n            if (key == 13 && this.nodeName.toLowerCase() == \"input\") {\r\n                return true;\r\n            }\r\n            else if (key == 13) {\r\n                return false;\r\n            }\r\n            var allow = false;\r\n            // allow Ctrl+A\r\n            if ((e.ctrlKey && key == 97 /* firefox */) || (e.ctrlKey && key == 65) /* opera */) return true;\r\n            // allow Ctrl+X (cut)\r\n            if ((e.ctrlKey && key == 120 /* firefox */) || (e.ctrlKey && key == 88) /* opera */) return true;\r\n            // allow Ctrl+C (copy)\r\n            if ((e.ctrlKey && key == 99 /* firefox */) || (e.ctrlKey && key == 67) /* opera */) return true;\r\n            // allow Ctrl+Z (undo)\r\n            if ((e.ctrlKey && key == 122 /* firefox */) || (e.ctrlKey && key == 90) /* opera */) return true;\r\n            // allow or deny Ctrl+V (paste), Shift+Ins\r\n            if ((e.ctrlKey && key == 118 /* firefox */) || (e.ctrlKey && key == 86) /* opera */\r\n                || (e.shiftKey && key == 45)) return true;\r\n            // if a number was not pressed\r\n            if (key < 48 || key > 57) {\r\n\r\n                /* only one decimal separator allowed */\r\n                if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) != -1) {\r\n                    allow = false;\r\n                }\r\n                /* only one e character allowed */\r\n                if (key == exp.charCodeAt(0) && this.value.indexOf(exp) != -1) {\r\n                    allow = false;\r\n                }\r\n\r\n\r\n                // check for other keys that have special purposes\r\n                if (\r\n                    key != 8 /* backspace */ &&\r\n                    key != 9 /* tab */ &&\r\n                    key != 13 /* enter */ &&\r\n                    key != 35 /* end */ &&\r\n                    key != 36 /* home */ &&\r\n                    key != 37 /* left */ &&\r\n                    key != 39 /* right */\r\n                    ) {\r\n                    allow = false;\r\n                }\r\n                else {\r\n                    // for detecting special keys (listed above)\r\n                    // IE does not support 'charCode' and ignores them in keypress anyway\r\n                    if (typeof e.charCode != \"undefined\") {\r\n                        // special keys have 'keyCode' and 'which' the same (e.g. backspace)\r\n                        if (e.keyCode == e.which && e.which != 0) {\r\n                            allow = true;\r\n                        }\r\n                        // or keyCode != 0 and 'charCode'/'which' = 0\r\n                        else if (e.keyCode != 0 && e.charCode == 0 && e.which == 0) {\r\n                            allow = true;\r\n                        }\r\n                    }\r\n                }\r\n                // if key pressed is the exp and it is not already in the field\r\n                if (key == exp.charCodeAt(0) && this.value.indexOf(exp) == -1) {\r\n                    allow = true;\r\n                }\r\n                 // if key pressed is the decimal and it is not already in the field\r\n                if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) == -1) {\r\n                    allow = true;\r\n                }\r\n\r\n                /* allow plus and minus keys*/\r\n                if (key == minus.charCodeAt(0) || key == plus.charCodeAt(0)) {\r\n                    allow = true;\r\n                }\r\n            }\r\n            else {\r\n                allow = true;\r\n            }\r\n            return allow;\r\n        }\r\n    )\r\n        .blur(\r\n        function () {\r\n            var val = jQuery(this).val();\r\n            if (val != \"\") {\r\n                var re = new RegExp(\"^\\\\d+$|\\\\d*\" + decimal + \"\\\\d+\");\r\n                if (!re.exec(val)) {\r\n                    callback.apply(this);\r\n                }\r\n            }\r\n        }\r\n    );\r\n    return this;\r\n}","//  This file is part of the jQuery formatCurrency Plugin.\r\n//\r\n//    The jQuery formatCurrency Plugin is free software: you can redistribute it\r\n//    and/or modify it under the terms of the GNU General Public License as published \r\n//    by the Free Software Foundation, either version 3 of the License, or\r\n//    (at your option) any later version.\r\n\r\n//    The jQuery formatCurrency Plugin is distributed in the hope that it will\r\n//    be useful, but WITHOUT ANY WARRANTY; without even the implied warranty \r\n//    of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n//    GNU General Public License for more details.\r\n//\r\n//    You should have received a copy of the GNU General Public License along with \r\n//    the jQuery formatCurrency Plugin.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n(function ($) {\r\n\r\n    $.formatCurrency = {};\r\n\r\n    $.formatCurrency.regions = [];\r\n\r\n    // default Region is en\r\n    $.formatCurrency.regions[''] = {\r\n        symbol: '$',\r\n        positiveFormat: '%s%n',\r\n        negativeFormat: '(%s%n)',\r\n        decimalSymbol: '.',\r\n        digitGroupSymbol: ',',\r\n        groupDigits: true\r\n    };\r\n\r\n    $.fn.formatCurrency = function (destination, settings) {\r\n\r\n        if (arguments.length == 1 && typeof destination !== \"string\") {\r\n            settings = destination;\r\n            destination = false;\r\n        }\r\n\r\n        // initialize defaults\r\n        var defaults = {\r\n            name: \"formatCurrency\",\r\n            colorize: false,\r\n            region: '',\r\n            global: true,\r\n            roundToDecimalPlace: 2, // roundToDecimalPlace: -1; for no rounding; 0 to round to the dollar; 1 for one digit cents; 2 for two digit cents; 3 for three digit cents; ...\r\n            eventOnDecimalsEntered: false\r\n        };\r\n        // initialize default region\r\n        defaults = $.extend(defaults, $.formatCurrency.regions['']);\r\n        // override defaults with settings passed in\r\n        settings = $.extend(defaults, settings);\r\n\r\n        // check for region setting\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n\r\n            // get number\r\n            var num = '0';\r\n            var multiCeroPattern = new RegExp(\"^(0+|-0+)\",\"g\");\r\n            num = $this[$this.is('input, select, textarea') ? 'val' : 'html']();\r\n\r\n            //identify '(123)' as a negative number\r\n            if (num.search('\\\\(') >= 0) {\r\n                num = '-' + num;\r\n            }\r\n\r\n            // Identify 0000 and -0000 pattern, and replace to 0\r\n            if (!num.match(/[1-9]/g))  num = num.replace(multiCeroPattern, 0);\r\n\r\n            if (num === '' || (num === '-' && settings.roundToDecimalPlace === -1)) {\r\n                return;\r\n            }\r\n\r\n            // if the number is valid use it, otherwise clean it\r\n            if (isNaN(num)) {\r\n                // clean number\r\n                num = num.replace(settings.regex, '');\r\n\r\n                if (num === '' || (num === '-' && settings.roundToDecimalPlace === -1)) {\r\n                    return;\r\n                }\r\n\r\n                if (settings.decimalSymbol != '.') {\r\n                    num = num.replace(settings.decimalSymbol, '.');  // reset to US decimal for arithmetic\r\n                }\r\n                if (isNaN(num)) {\r\n                    num = '0';\r\n                }\r\n            }\r\n\r\n            // evalutate number input\r\n            var numParts = String(num).split('.');\r\n            var isPositive = (num == Math.abs(num));\r\n            var hasDecimals = (numParts.length > 1);\r\n            var decimals = (hasDecimals ? numParts[1].toString() : '0');\r\n            var originalDecimals = decimals;\r\n\r\n            // format number\r\n            num = Math.abs(numParts[0]);\r\n            num = isNaN(num) ? 0 : num;\r\n            if (settings.roundToDecimalPlace >= 0) {\r\n                decimals = parseFloat('1.' + decimals); // prepend \"0.\"; (IE does NOT round 0.50.toFixed(0) up, but (1+0.50).toFixed(0)-1\r\n                decimals = decimals.toFixed(settings.roundToDecimalPlace); // round\r\n                if (decimals.substring(0, 1) == '2') {\r\n                    num = Number(num) + 1;\r\n                }\r\n                decimals = decimals.substring(2); // remove \"0.\"\r\n            }\r\n            num = String(num);\r\n\r\n            if (settings.groupDigits) {\r\n                for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++) {\r\n                    num = num.substring(0, num.length - (4 * i + 3)) + settings.digitGroupSymbol + num.substring(num.length - (4 * i + 3));\r\n                }\r\n            }\r\n\r\n            if ((hasDecimals && settings.roundToDecimalPlace == -1) || settings.roundToDecimalPlace > 0) {\r\n                num += settings.decimalSymbol + decimals;\r\n            }\r\n\r\n            // format symbol/negative\r\n            var format = isPositive ? settings.positiveFormat : settings.negativeFormat;\r\n            var money = format.replace(/%s/g, settings.symbol);\r\n            money = money.replace(/%n/g, num);\r\n\r\n            // setup destination\r\n            var $destination = $([]);\r\n            if (!destination) {\r\n                $destination = $this;\r\n            } else {\r\n                $destination = $(destination);\r\n            }\r\n            // set destination\r\n            $destination[$destination.is('input, select, textarea') ? 'val' : 'html'](money);\r\n\r\n            if (\r\n\t\t\t\thasDecimals &&\r\n\t\t\t\tsettings.eventOnDecimalsEntered &&\r\n\t\t\t\toriginalDecimals.length > settings.roundToDecimalPlace\r\n\t\t\t) {\r\n                $destination.trigger('decimalsEntered', originalDecimals);\r\n            }\r\n\r\n            // colorize\r\n            if (settings.colorize) {\r\n                $destination.css('color', isPositive ? 'black' : 'red');\r\n            }\r\n        });\r\n    };\r\n\r\n    // Remove all non numbers from text\r\n    $.fn.toNumber = function (settings) {\r\n        var defaults = $.extend({\r\n            name: \"toNumber\",\r\n            region: '',\r\n            global: true\r\n        }, $.formatCurrency.regions['']);\r\n\r\n        settings = jQuery.extend(defaults, settings);\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n\r\n        return this.each(function () {\r\n            var method = $(this).is('input, select, textarea') ? 'val' : 'html';\r\n            $(this)[method]($(this)[method]().replace('(', '(-').replace(settings.regex, ''));\r\n        });\r\n    };\r\n\r\n    // returns the value from the first element as a number\r\n    $.fn.asNumber = function (settings) {\r\n        var defaults = $.extend({\r\n            name: \"asNumber\",\r\n            region: '',\r\n            parse: true,\r\n            parseType: 'Float',\r\n            global: true\r\n        }, $.formatCurrency.regions['']);\r\n        settings = jQuery.extend(defaults, settings);\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n        settings.parseType = validateParseType(settings.parseType);\r\n\r\n        var method = $(this).is('input, select, textarea') ? 'val' : 'html';\r\n        var num = $(this)[method]();\r\n        num = num ? num : \"\";\r\n        num = num.replace('(', '(-');\r\n        num = num.replace(settings.regex, '');\r\n        if (!settings.parse) {\r\n            return num;\r\n        }\r\n\r\n        if (num.length == 0) {\r\n            num = '0';\r\n        }\r\n\r\n        if (settings.decimalSymbol != '.') {\r\n            num = num.replace(settings.decimalSymbol, '.');  // reset to US decimal for arthmetic\r\n        }\r\n\r\n        return window['parse' + settings.parseType](num);\r\n    };\r\n\r\n    function getRegionOrCulture(region) {\r\n        var regionInfo = $.formatCurrency.regions[region];\r\n        if (regionInfo) {\r\n            return regionInfo;\r\n        }\r\n        else {\r\n            if (/(\\w+)-(\\w+)/g.test(region)) {\r\n                var culture = region.replace(/(\\w+)-(\\w+)/g, \"$1\");\r\n                return $.formatCurrency.regions[culture];\r\n            }\r\n        }\r\n        // fallback to extend(null) (i.e. nothing)\r\n        return null;\r\n    }\r\n\r\n    function validateParseType(parseType) {\r\n        switch (parseType.toLowerCase()) {\r\n            case 'int':\r\n                return 'Int';\r\n            case 'float':\r\n                return 'Float';\r\n            default:\r\n                throw 'invalid parseType';\r\n        }\r\n    }\r\n\r\n    function generateRegex(settings) {\r\n        if (settings.symbol === '') {\r\n            return new RegExp(\"[^\\\\d\" + settings.decimalSymbol + \"-]\", \"g\");\r\n        }\r\n        else {\r\n            var symbol = settings.symbol.replace('$', '\\\\$').replace('.', '\\\\.');\r\n            return new RegExp(symbol + \"|[^\\\\d\" + settings.decimalSymbol + \"-]\", \"g\");\r\n        }\r\n    }\r\n\r\n})(jQuery);","(function (a) {\r\n    function k(b, c) {\r\n        function j() { var a = document.body, b = document.documentElement; return Math.max(a.scrollHeight, a.offsetHeight, b.clientHeight, b.scrollHeight, b.offsetHeight) } function u(b) { e = a(\"li.dw-v\", b).eq(0).index(); d = a(\"li.dw-v\", b).eq(-1).index(); f = i.height; F = m } function x(b) { var a = i.headerText; return a ? \"function\" == typeof a ? a.call(B, b) : a.replace(/{value}/i, b) : \"\" } function p() { m.temp = J && null !== m.val && m.val != b.val() || null === m.values ? i.parseValue(b.val() ? b.val() : \"\", m) : m.values.slice(0); m.setValue(!0) }\r\n        function z(b, c, e, u, f) { i.validate.call(B, y, e); a(\".dww ul\", y).each(function (u) { var i = a(this), d = a('li[data-val=\"' + m.temp[u] + '\"]', i), i = d.index(), g = d, d = i; if (!g.hasClass(\"dw-v\")) { for (var h = g, x = 0, j = 0; h.prev().length && !h.hasClass(\"dw-v\"); ) h = h.prev(), x++; for (; g.next().length && !g.hasClass(\"dw-v\"); ) g = g.next(), j++; j < x && j && 1 == !f || !x || !h.hasClass(\"dw-v\") || 1 == f ? d += j : (g = h, d -= x); m.temp[u] = g.data(\"val\") } if (i != d || u == e || void 0 === e) m.scroll(a(this), d, u == e ? b : 0, c, u) }); m.change(u) } function k() {\r\n            var b = 0, c = 0, u = a(window).width(),\r\ne = a(window).height(), d = a(window).scrollTop(), i = a(\".dwo\", y), f = a(\".dw\", y), g, h; a(\".dwc\", y).each(function () { g = a(this).outerWidth(!0); b += g; c = g > c ? g : c }); g = b > u ? c : b; f.width(g); g = f.outerWidth(); h = f.outerHeight(); f.css({ left: (u - g) / 2, top: d + (e - h) / 2 }); i.height(0).height(j())\r\n        } function w(b) { var a = +b.data(\"pos\") + 1; l(b, a > d ? e : a, 1) } function E(b) { var a = +b.data(\"pos\") - 1; l(b, a < e ? d : a, 2) } var m = this, B = b, b = a(B), M, i = a.extend({}, D), O, y, N = {}, P = {}, J = b.is(\"input\"), K = !1; m.enable = function () { i.disabled = !1; J && b.prop(\"disabled\", !1) };\r\n        m.disable = function () { i.disabled = !0; J && b.prop(\"disabled\", !0) }; m.scroll = function (b, a, c, u, e) {\r\n            var d = (O - a) * i.height; b.attr(\"style\", (c ? H + \"-transition:all \" + c.toFixed(1) + \"s ease-out;\" : \"\") + (I ? H + \"-transform:translate3d(0,\" + d + \"px,0);\" : \"top:\" + d + \"px;\")); if (c) {\r\n                var g = 0; clearInterval(N[e]); N[e] = setInterval(function () { g += 0.1; b.data(\"pos\", Math.round((a - u) * Math.sin(g / c * (Math.PI / 2)) + u)); g >= c && (clearInterval(N[e]), b.data(\"pos\", a)) }, 100); clearTimeout(P[e]); P[e] = setTimeout(function () {\r\n                    \"mixed\" == i.mode && !b.hasClass(\"dwa\") &&\r\nb.closest(\".dwwl\").find(\".dwwb\").fadeIn(\"fast\")\r\n                }, 1E3 * c)\r\n            } else b.data(\"pos\", a)\r\n        }; m.setValue = function (a, c, e) { var u = i.formatResult(m.temp); m.val = u; m.values = m.temp.slice(0); K && a && z(e); c && J && b.val(u).trigger(\"change\") }; m.validate = function (b, a, c, u) { z(b, a, c, !0, u) }; m.change = function (b) { var c = i.formatResult(m.temp); \"inline\" == i.display ? m.setValue(!1, b) : a(\".dwv\", y).html(x(c)); b && i.onChange.call(B, c, m) }; m.hide = function () {\r\n            if (!1 === i.onClose.call(B, m.val, m)) return !1; a(\".dwtd\").prop(\"disabled\", !1).removeClass(\"dwtd\");\r\n            b.blur(); y && y.remove(); K = !1; a(window).unbind(\".dw\")\r\n        }; m.show = function () {\r\n            if (i.disabled || K) return !1; var c = i.height, e = i.rows * c; p(); for (var d = '<div class=\"' + i.theme + '\">' + (\"inline\" == i.display ? '<div class=\"dw dwbg dwi\"><div class=\"dwwr\">' : '<div class=\"dwo\"></div><div class=\"dw dwbg\"><div class=\"dwwr\">' + (i.headerText ? '<div class=\"dwv\"></div>' : \"\")), f = 0; f < i.wheels.length; f++) {\r\n                var d = d + ('<div class=\"dwc' + (\"scroller\" != i.mode ? \" dwpm\" : \" dwsc\") + (i.showLabel ? \"\" : \" dwhl\") + '\"><div class=\"dwwc dwrc\"><table cellpadding=\"0\" cellspacing=\"0\"><tr>'),\r\nh; for (h in i.wheels[f]) {\r\n                    var d = d + ('<td><div class=\"dwwl dwrc\">' + (\"scroller\" != i.mode ? '<div class=\"dwwb dwwbp\" style=\"height:' + c + \"px;line-height:\" + c + 'px;\"><span>+</span></div><div class=\"dwwb dwwbm\" style=\"height:' + c + \"px;line-height:\" + c + 'px;\"><span>&ndash;</span></div>' : \"\") + '<div class=\"dwl\">' + h + '</div><div class=\"dww dwrc\" style=\"height:' + e + \"px;min-width:\" + i.width + 'px;\"><ul>'), x; for (x in i.wheels[f][h]) d += '<li class=\"dw-v\" data-val=\"' + x + '\" style=\"height:' + c + \"px;line-height:\" + c + 'px;\">' + i.wheels[f][h][x] +\r\n\"</li>\"; d += '</ul><div class=\"dwwo\"></div></div><div class=\"dwwol\"></div></div></td>'\r\n                } d += \"</tr></table></div></div>\"\r\n            } d += (\"inline\" != i.display ? '<div class=\"dwbc\"><span class=\"dwbw dwb-s\"><a href=\"#\" class=\"dwb\">' + i.setText + '</a></span><span class=\"dwbw dwb-c\"><a href=\"#\" class=\"dwb\">' + i.cancelText + \"</a></span></div>\" : '<div class=\"dwcc\"></div>') + \"</div></div></div>\"; y = a(d); z(); \"inline\" != i.display ? y.appendTo(\"body\") : b.is(\"div\") ? b.html(y) : y.insertAfter(b); K = !0; M.init(y, m); \"inline\" != i.display && (a(\".dwb-s a\",\r\ny).click(function () { m.setValue(!1, !0); m.hide(); i.onSelect.call(B, m.val, m); return !1 }), a(\".dwb-c a\", y).click(function () { m.hide(); i.onCancel.call(B, m.val, m); return !1 }), a(\"input,select\").each(function () { a(this).prop(\"disabled\") || a(this).addClass(\"dwtd\") }), a(\"input,select\").prop(\"disabled\", !0), k(), a(window).bind(\"resize.dw\", k)); y.delegate(\".dwwl\", \"DOMMouseScroll mousewheel\", function (b) {\r\n    if (!i.readonly) {\r\n        b.preventDefault(); var b = b.originalEvent, b = b.wheelDelta ? b.wheelDelta / 120 : b.detail ? -b.detail / 3 : 0, c = a(\"ul\",\r\nthis), d = +c.data(\"pos\"), d = Math.round(d - b); u(c); l(c, d, b < 0 ? 1 : 2)\r\n    } \r\n}).delegate(\".dwb, .dwwb\", G, function () { a(this).addClass(\"dwb-a\") }).delegate(\".dwwb\", G, function (b) { if (!i.readonly) { b.preventDefault(); b.stopPropagation(); var c = a(this).closest(\".dwwl\").find(\"ul\"); func = a(this).hasClass(\"dwwbp\") ? w : E; u(c); clearInterval(g); g = setInterval(function () { func(c) }, i.delay); func(c) } }).delegate(\".dwwl\", G, function (b) {\r\n    if (!r && i.mode != \"clickpick\" && !i.readonly) {\r\n        b.preventDefault(); r = true; s = a(\"ul\", this).addClass(\"dwa\"); i.mode ==\r\n\"mixed\" && a(\".dwwb\", this).fadeOut(\"fast\"); v = +s.data(\"pos\"); u(s); t = o(b); A = new Date; q = t; m.scroll(s, v)\r\n    } \r\n}); i.onShow.call(B, y, m)\r\n        }; m.init = function (c) {\r\n            M = a.extend({ defaults: {}, init: n }, a.scroller.themes[c.theme ? c.theme : i.theme]); a.extend(i, M.defaults, c); m.settings = i; O = Math.floor(i.rows / 2); var d = a.scroller.presets[i.preset]; b.unbind(\".dw\"); d && (d = d.call(B, m), a.extend(i, d, c), a.extend(C, d.methods)); void 0 !== b.data(\"dwro\") && (B.readOnly = h(b.data(\"dwro\"))); K && m.hide(); \"inline\" == i.display ? m.show() : (p(), J && i.showOnFocus &&\r\n(b.data(\"dwro\", B.readOnly), B.readOnly = !0, b.bind(\"focus.dw\", m.show)))\r\n        }; m.values = null; m.val = null; m.temp = null; m.init(c)\r\n    } function w(b) { for (var a in b) if (void 0 !== z[b[a]]) return !0; return !1 } function o(b) { return E ? b.originalEvent ? b.originalEvent.changedTouches[0].pageY : b.changedTouches[0].pageY : b.pageY } function h(b) { return !0 === b || \"true\" == b } function l(b, c, g, u, f) {\r\n        var h = b.closest(\".dwwr\").find(\"ul\").index(b), c = c > d ? d : c, c = c < e ? e : c, b = a(\"li\", b).eq(c); F.temp[h] = b.data(\"val\"); F.validate(u ? c == f ? 0.1 : Math.abs(0.1 * (c -\r\nf)) : 0, f, h, g)\r\n    } var j = {}, g, n = function () { }, f, e, d, F, p = (new Date).getTime(), r = !1, s = null, t, q, A, v, z = document.createElement(z).style, I = w([\"perspectiveProperty\", \"WebkitPerspective\", \"MozPerspective\", \"OPerspective\", \"msPerspective\"]) && \"webkitPerspective\" in document.documentElement.style, H = function () { var b = [\"Webkit\", \"Moz\", \"O\", \"ms\"], a; for (a in b) if (w([b[a] + \"Transform\"])) return \"-\" + b[a].toLowerCase(); return \"\" } (), E = \"ontouchstart\" in window, G = E ? \"touchstart\" : \"mousedown\", L = E ? \"touchend\" : \"mouseup\", D = { width: 70, height: 40,\r\n        rows: 3, delay: 300, disabled: !1, readonly: !1, showOnFocus: !0, showLabel: !0, wheels: [], theme: \"\", headerText: \"{value}\", display: \"modal\", mode: \"scroller\", preset: \"\", setText: \"Set\", cancelText: \"Cancel\", onShow: n, onClose: n, onSelect: n, onCancel: n, onChange: n, formatResult: function (b) { for (var a = \"\", d = 0; d < b.length; d++) a += (0 < d ? \" \" : \"\") + b[d]; return a }, parseValue: function (b, a) {\r\n            for (var d = a.settings.wheels, b = b.split(\" \"), e = [], f = 0, g = 0; g < d.length; g++) for (var h in d[g]) {\r\n                if (void 0 !== d[g][h][b[f]]) e.push(b[f]); else for (var j in d[g][h]) {\r\n                    e.push(j);\r\n                    break\r\n                } f++\r\n            } return e\r\n        }, validate: n\r\n    }, C = { init: function (b) { void 0 === b && (b = {}); return this.each(function () { this.id || (p += 1, this.id = \"scoller\" + p); j[this.id] = new k(this, b) }) }, enable: function () { return this.each(function () { var b = j[this.id]; b && b.enable() }) }, disable: function () { return this.each(function () { var b = j[this.id]; b && b.disable() }) }, isDisabled: function () { var b = j[this[0].id]; if (b) return b.settings.disabled }, option: function (b, a) {\r\n        return this.each(function () {\r\n            var d = j[this.id]; if (d) {\r\n                var e = {}; \"object\" === typeof b ?\r\ne = b : e[b] = a; d.init(e)\r\n            } \r\n        })\r\n    }, setValue: function (b, a, d) { return this.each(function () { var e = j[this.id]; e && (e.temp = b, e.setValue(!0, a, d)) }) }, getInst: function () { return j[this[0].id] }, getValue: function () { var b = j[this[0].id]; if (b) return b.values }, show: function () { var b = j[this[0].id]; if (b) return b.show() }, hide: function () { return this.each(function () { var b = j[this.id]; b && b.hide() }) }, destroy: function () {\r\n        return this.each(function () {\r\n            var b = j[this.id]; b && (b.hide(), a(this).unbind(\".dw\"), delete j[this.id], a(this).is(\"input\") &&\r\n(this.readOnly = h(a(this).data(\"dwro\"))))\r\n        })\r\n    } \r\n    }; a(document).bind(E ? \"touchmove\" : \"mousemove\", function (b) { r && (b.preventDefault(), q = o(b), b = v + (t - q) / f, b = b > d + 1 ? d + 1 : b, b = b < e - 1 ? e - 1 : b, F.scroll(s, b)) }); a(document).bind(L, function (b) { if (r) { b.preventDefault(); s.removeClass(\"dwa\"); var c = new Date - A, b = v + (t - q) / f, b = b > d + 1 ? d + 1 : b, b = b < e - 1 ? e - 1 : b; 300 > c ? (c = (q - t) / c, c = c * c / 0.0012, 0 > q - t && (c = -c)) : c = q - t; l(s, Math.round(v - c / f), 0, !0, Math.round(b)); r = !1; s = null } clearInterval(g); a(\".dwb-a\").removeClass(\"dwb-a\") }); a.fn.scroller = function (b) {\r\n        if (C[b]) return C[b].apply(this,\r\nArray.prototype.slice.call(arguments, 1)); if (\"object\" === typeof b || !b) return C.init.apply(this, arguments); a.error(\"Unknown method\")\r\n    }; a.scroller = { setDefaults: function (b) { a.extend(D, b) }, presets: {}, themes: {}}\r\n})(jQuery); (function (a) {\r\n    var k = new Date, w = { dateFormat: \"mm/dd/yy\", dateOrder: \"mmddy\", timeWheels: \"hhiiA\", timeFormat: \"hh:ii A\", startYear: k.getFullYear() - 100, endYear: k.getFullYear() + 1, monthNames: \"January,February,March,April,May,June,July,August,September,October,November,December\".split(\",\"), monthNamesShort: \"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec\".split(\",\"), dayNames: \"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday\".split(\",\"), dayNamesShort: \"Sun,Mon,Tue,Wed,Thu,Fri,Sat\".split(\",\"), shortYearCutoff: \"+10\",\r\n        monthText: \"Month\", dayText: \"Day\", yearText: \"Year\", hourText: \"Hours\", minuteText: \"Minutes\", secText: \"Seconds\", ampmText: \"&nbsp;\", stepHour: 1, stepMinute: 1, stepSecond: 1, separator: \" \"\r\n    }, k = function (o) {\r\n        function h(b, a, c) { return void 0 !== p[a] ? +b[p[a]] : void 0 !== c ? c : H[r[a]] ? H[r[a]]() : r[a](H) } function l(b, a) { return Math.floor(b / a) * a } function j(b) { var a = h(b, \"h\", 0); return new Date(h(b, \"y\"), h(b, \"m\"), h(b, \"d\"), h(b, \"ap\") ? a + 12 : a, h(b, \"i\", 0), h(b, \"s\", 0)) } var g = a(this), n; if (g.is(\"input\")) {\r\n            switch (g.attr(\"type\")) {\r\n                case \"date\": n =\r\n\"yy-mm-dd\"; break; case \"datetime\": n = \"yy-mm-ddTHH:ii:ssZ\"; break; case \"datetime-local\": n = \"yy-mm-ddTHH:ii:ss\"; break; case \"month\": n = \"yy-mm\"; w.dateOrder = \"mmyy\"; break; case \"time\": n = \"HH:ii:ss\"\r\n            } var f = g.attr(\"min\"), g = g.attr(\"max\"); f && (w.minDate = a.scroller.parseDate(n, f)); g && (w.maxDate = a.scroller.parseDate(n, g))\r\n        } var e = a.extend({}, w, o.settings), d = 0, f = [], k = [], p = {}, r = { y: \"getFullYear\", m: \"getMonth\", d: \"getDate\", h: function (b) { b = b.getHours(); b = z && 12 <= b ? b - 12 : b; return l(b, E) }, i: function (b) { return l(b.getMinutes(), G) },\r\n            s: function (b) { return l(b.getSeconds(), L) }, ap: function (b) { return v && 11 < b.getHours() ? 1 : 0 } \r\n        }, s = e.preset, t = e.dateOrder, q = e.timeWheels, A = t.match(/D/), v = q.match(/a/i), z = q.match(/h/), I = \"datetime\" == s ? e.dateFormat + e.separator + e.timeFormat : \"time\" == s ? e.timeFormat : e.dateFormat, H = new Date, E = e.stepHour, G = e.stepMinute, L = e.stepSecond, D = e.minDate, C = e.maxDate; n = n ? n : I; if (s.match(/date/i)) {\r\n            a.each([\"y\", \"m\", \"d\"], function (b, a) { b = t.search(RegExp(a, \"i\")); -1 < b && k.push({ o: b, v: a }) }); k.sort(function (b, a) { return b.o > a.o ? 1 : -1 });\r\n            a.each(k, function (b, a) { p[a.v] = b }); for (var g = {}, b = 0; 3 > b; b++) if (b == p.y) { d++; g[e.yearText] = {}; for (var c = D ? D.getFullYear() : e.startYear, Q = C ? C.getFullYear() : e.endYear; c <= Q; c++) g[e.yearText][c] = t.match(/yy/i) ? c : (c + \"\").substr(2, 2) } else if (b == p.m) { d++; g[e.monthText] = {}; for (c = 0; 12 > c; c++) g[e.monthText][c] = t.match(/MM/) ? e.monthNames[c] : t.match(/M/) ? e.monthNamesShort[c] : t.match(/mm/) && 9 > c ? \"0\" + (c + 1) : c + 1 } else if (b == p.d) { d++; g[e.dayText] = {}; for (c = 1; 32 > c; c++) g[e.dayText][c] = t.match(/dd/i) && 10 > c ? \"0\" + c : c } f.push(g)\r\n        } if (s.match(/time/i)) {\r\n            g =\r\n{}; if (q.match(/h/i)) { p.h = d++; g[e.hourText] = {}; for (c = 0; c < (z ? 12 : 24); c += E) g[e.hourText][c] = z && 0 == c ? 12 : q.match(/hh/i) && 10 > c ? \"0\" + c : c } if (q.match(/i/)) { p.i = d++; g[e.minuteText] = {}; for (c = 0; 60 > c; c += G) g[e.minuteText][c] = q.match(/ii/) && 10 > c ? \"0\" + c : c } if (q.match(/s/)) { p.s = d++; g[e.secText] = {}; for (c = 0; 60 > c; c += L) g[e.secText][c] = q.match(/ss/) && 10 > c ? \"0\" + c : c } v && (p.ap = d++, d = q.match(/A/), g[e.ampmText] = { \"0\": d ? \"AM\" : \"am\", 1: d ? \"PM\" : \"pm\" }); f.push(g)\r\n        } return { wheels: f, headerText: function () {\r\n            return a.scroller.formatDate(I, j(o.temp),\r\ne)\r\n        }, formatResult: function (b) { return a.scroller.formatDate(n, j(b), e) }, parseValue: function (b) { var c = new Date, d = []; try { c = a.scroller.parseDate(n, b, e) } catch (g) { } for (var f in p) d[p[f]] = c[r[f]] ? c[r[f]]() : r[f](c); return d }, validate: function (b, c) {\r\n            var d = o.temp, f = { m: 0, d: 1, h: 0, i: 0, s: 0, ap: 0 }, g = { m: 11, d: 31, h: l(z ? 11 : 23, E), i: l(59, G), s: l(59, L), ap: 1 }, j = !0, n = !0; a.each(D || C ? \"y,m,d,ap,h,i,s\".split(\",\") : c == p.y || c == p.m || void 0 === c ? [\"d\"] : [], function (c, l) {\r\n                if (void 0 !== p[l]) {\r\n                    var o = f[l], i = g[l], z = 31, k = h(d, l), s = a(\"ul\", b).eq(p[l]),\r\nq, x; \"d\" == l && (q = h(d, \"y\"), x = h(d, \"m\"), i = z = 32 - (new Date(q, x, 32)).getDate(), A && a(\"li\", s).each(function () { var b = a(this), c = b.data(\"val\"), d = (new Date(q, x, c)).getDay(); b.html(t.replace(/[my]/gi, \"\").replace(/dd/, 10 > c ? \"0\" + c : c).replace(/d/, c).replace(/DD/, e.dayNames[d]).replace(/D/, e.dayNamesShort[d])) })); j && D && (o = D[r[l]] ? D[r[l]]() : r[l](D)); n && C && (i = C[r[l]] ? C[r[l]]() : r[l](C)); if (\"y\" != l) {\r\n                        var F = a('li[data-val=\"' + o + '\"]', s).index(), w = a('li[data-val=\"' + i + '\"]', s).index(); a(\"li\", s).removeClass(\"dw-v\").slice(F, w + 1).addClass(\"dw-v\");\r\n                        \"d\" == l && a(\"li\", s).removeClass(\"dw-h\").slice(z).addClass(\"dw-h\"); k < o && (k = o); k > i && (k = i)\r\n                    } j && (j = k == o); n && (n = k == i); if (e.invalid && \"d\" == l) {\r\n                        var v = []; e.invalid.dates && a.each(e.invalid.dates, function (b, a) { a.getFullYear() == q && a.getMonth() == x && v.push(a.getDate() - 1) }); if (e.invalid.daysOfWeek) { var I = (new Date(q, x, 1)).getDay(); a.each(e.invalid.daysOfWeek, function (b, a) { for (var c = a - I; c < z; c = c + 7) c >= 0 && v.push(c) }) } e.invalid.daysOfMonth && a.each(e.invalid.daysOfMonth, function (b, a) {\r\n                            a = (a + \"\").split(\"/\"); a[1] ? a[0] - 1 == x && v.push(a[1] -\r\n1) : v.push(a[0] - 1)\r\n                        }); a.each(v, function (b, c) { a(\"li\", s).eq(c).removeClass(\"dw-v\") })\r\n                    } \r\n                } \r\n            })\r\n        }, methods: { getDate: function (b) { var c = a(this).scroller(\"getInst\"); if (c) return j(b ? c.temp : c.values) }, setDate: function (b, c, d) { void 0 == c && (c = !1); return this.each(function () { var e = a(this).scroller(\"getInst\"); if (e) { for (var f in p) e.temp[p[f]] = b[r[f]] ? b[r[f]]() : r[f](b); e.setValue(!0, c, d) } }) } }\r\n        }\r\n    }; a.scroller.presets.date = k; a.scroller.presets.datetime = k; a.scroller.presets.time = k; a.scroller.formatDate = function (o, h, l) {\r\n        if (!h) return null;\r\n        for (var l = a.extend({}, w, l), j = function (a) { for (var e = 0; d + 1 < o.length && o.charAt(d + 1) == a; ) e++, d++; return e }, g = function (a, d, e) { d = \"\" + d; if (j(a)) for (; d.length < e; ) d = \"0\" + d; return d }, n = function (a, d, e, f) { return j(a) ? f[d] : e[d] }, f = \"\", e = !1, d = 0; d < o.length; d++) if (e) \"'\" == o.charAt(d) && !j(\"'\") ? e = !1 : f += o.charAt(d); else switch (o.charAt(d)) {\r\n            case \"d\": f += g(\"d\", h.getDate(), 2); break; case \"D\": f += n(\"D\", h.getDay(), l.dayNamesShort, l.dayNames); break; case \"o\": f += g(\"o\", (h.getTime() - (new Date(h.getFullYear(), 0, 0)).getTime()) / 864E5,\r\n3); break; case \"m\": f += g(\"m\", h.getMonth() + 1, 2); break; case \"M\": f += n(\"M\", h.getMonth(), l.monthNamesShort, l.monthNames); break; case \"y\": f += j(\"y\") ? h.getFullYear() : (10 > h.getYear() % 100 ? \"0\" : \"\") + h.getYear() % 100; break; case \"h\": var k = h.getHours(), f = f + g(\"h\", 12 < k ? k - 12 : 0 == k ? 12 : k, 2); break; case \"H\": f += g(\"H\", h.getHours(), 2); break; case \"i\": f += g(\"i\", h.getMinutes(), 2); break; case \"s\": f += g(\"s\", h.getSeconds(), 2); break; case \"a\": f += 11 < h.getHours() ? \"pm\" : \"am\"; break; case \"A\": f += 11 < h.getHours() ? \"PM\" : \"AM\"; break; case \"'\": j(\"'\") ? f +=\r\n\"'\" : e = !0; break; default: f += o.charAt(d)\r\n        } return f\r\n    }; a.scroller.parseDate = function (k, h, l) {\r\n        var j = new Date; if (!k || !h) return j; for (var h = \"object\" == typeof h ? h.toString() : h + \"\", g = a.extend({}, w, l), l = j.getFullYear(), n = j.getMonth() + 1, f = j.getDate(), e = -1, d = j.getHours(), j = j.getMinutes(), F = 0, p = -1, r = !1, s = function (a) { (a = v + 1 < k.length && k.charAt(v + 1) == a) && v++; return a }, t = function (a) {\r\n            s(a); a = h.substr(A).match(RegExp(\"^\\\\d{1,\" + (\"@\" == a ? 14 : \"!\" == a ? 20 : \"y\" == a ? 4 : \"o\" == a ? 3 : 2) + \"}\")); if (!a) return 0; A += a[0].length; return parseInt(a[0],\r\n10)\r\n        }, q = function (a, d, e) { a = s(a) ? e : d; for (d = 0; d < a.length; d++) if (h.substr(A, a[d].length).toLowerCase() == a[d].toLowerCase()) return A += a[d].length, d + 1; return 0 }, A = 0, v = 0; v < k.length; v++) if (r) \"'\" == k.charAt(v) && !s(\"'\") ? r = !1 : A++; else switch (k.charAt(v)) {\r\n            case \"d\": f = t(\"d\"); break; case \"D\": q(\"D\", g.dayNamesShort, g.dayNames); break; case \"o\": e = t(\"o\"); break; case \"m\": n = t(\"m\"); break; case \"M\": n = q(\"M\", g.monthNamesShort, g.monthNames); break; case \"y\": l = t(\"y\"); break; case \"H\": d = t(\"H\"); break; case \"h\": d = t(\"h\"); break; case \"i\": j =\r\nt(\"i\"); break; case \"s\": F = t(\"s\"); break; case \"a\": p = q(\"a\", [\"am\", \"pm\"], [\"am\", \"pm\"]) - 1; break; case \"A\": p = q(\"A\", [\"am\", \"pm\"], [\"am\", \"pm\"]) - 1; break; case \"'\": s(\"'\") ? A++ : r = !0; break; default: A++\r\n        } 100 > l && (l += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (l <= g.shortYearCutoff ? 0 : -100)); if (-1 < e) { n = 1; f = e; do { g = 32 - (new Date(l, n - 1, 32)).getDate(); if (f <= g) break; n++; f -= g } while (1) } d = new Date(l, n - 1, f, -1 == p ? d : p && 12 > d ? d + 12 : !p && 12 == d ? 0 : d, j, F); if (d.getFullYear() != l || d.getMonth() + 1 != n || d.getDate() != f) throw \"Invalid date\"; return d\r\n    } \r\n})(jQuery); (function (a) {\r\n    var k = { inputClass: \"\" }; a.scroller.presets.select = function (w) {\r\n        var o = a.extend({}, k, w.settings), h = a(this), l = this.id + \"_dummy\"; a('label[for=\"' + this.id + '\"]').attr(\"for\", l); var j = a('label[for=\"' + l + '\"]'), j = j.length ? j.text() : h.attr(\"name\"), g = [], n = [{}]; n[0][j] = {}; var f = n[0][j]; a(\"option\", h).each(function () { var d = a(this).attr(\"value\"); f[d] = a(this).text(); a(this).prop(\"disabled\") && g.push(d) }); a(\"#\" + l).remove(); var e = a('<input type=\"text\" id=\"' + l + '\" value=\"' + f[h.val()] + '\" class=\"' + o.inputClass + '\" readonly />').insertBefore(h);\r\n        o.showOnFocus && e.focus(function () { w.show() }); h.hide().closest(\".ui-field-contain\").trigger(\"create\"); return { width: 200, wheels: n, headerText: !1, formatResult: function (a) { return f[a[0]] }, parseValue: function () { return [h.val()] }, validate: function (d) { a.each(g, function (e, f) { a('li[data-val=\"' + f + '\"]', d).removeClass(\"dw-v\") }) }, onSelect: function (a, f) { e.val(a); h.val(f.values[0]).trigger(\"change\") }, onChange: function (a, f) { \"inline\" == o.display && (e.val(a), h.val(f.temp[0]).trigger(\"change\")) }, onClose: function () { e.blur() } }\r\n    } \r\n})(jQuery); (function (a) { a.scroller.themes.android = { defaults: { dateOrder: \"Mddyy\", mode: \"clickpick\", height: 50}} })(jQuery); (function (a) { var k = { defaults: { dateOrder: \"Mddyy\", mode: \"mixed\", rows: 5, width: 70, showLabel: !1} }; a.scroller.themes[\"android-ics\"] = k; a.scroller.themes[\"android-ics light\"] = k })(jQuery); (function (a) { a.scroller.themes.ios = { defaults: { dateOrder: \"MMdyy\", rows: 5, height: 30, width: 55, headerText: !1, showLabel: !1}} })(jQuery); (function (a) {\r\n    a.scroller.themes.jqm = { defaults: { jqmBody: \"c\", jqmHeader: \"b\", jqmWheel: \"d\", jqmClickPick: \"c\", jqmSet: \"b\", jqmCancel: \"c\" }, init: function (k, w) {\r\n        var o = w.settings; a(\".dw\", k).removeClass(\"dwbg\").addClass(\"ui-overlay-shadow ui-corner-all ui-body-a\"); a(\".dwb-s a\", k).attr(\"data-role\", \"button\").attr(\"data-theme\", o.jqmSet); a(\".dwb-c a\", k).attr(\"data-role\", \"button\").attr(\"data-theme\", o.jqmCancel); a(\".dwwb\", k).attr(\"data-role\", \"button\").attr(\"data-theme\", o.jqmClickPick); a(\".dwv\", k).addClass(\"ui-header ui-bar-\" +\r\no.jqmHeader); a(\".dwwr\", k).addClass(\"ui-body-\" + o.jqmBody); a(\".dwpm .dww\", k).addClass(\"ui-body-\" + o.jqmWheel); \"inline\" != o.display && a(\".dw\", k).addClass(\"pop in\"); k.trigger(\"create\"); a(\".dwo\", k).click(function () { w.hide() })\r\n    } \r\n    }\r\n})(jQuery);\n","/* \r\n * Simple Pagination Control for Bizagi Mobile\r\n * @author: Richar Urbano <Richar.Urbano@Bizagi.com>\r\n */\r\n\r\n(function ($) {\r\n    $.fn.mobilePagination = function (options) {\r\n        // define options\r\n        options = options || {};\r\n\r\n        var defaultOptions = {\r\n            firstPage: 1,\r\n            totalPages: 1,\r\n            actualPage: 1,\r\n            pages: [],\r\n\r\n            // Controllers elements\r\n            listElement: $(\"ul\"),\r\n            first: '<spaz class=\"bz-mo-icon bz-grid-backwards-fast\"></span>',\r\n            firstClass: \"first\",\r\n            previous: '<spaz class=\"bz-mo-icon bz-grid-backwards\"></span>',\r\n            previousClass: 'previous',\r\n            next: '<spaz class=\"bz-mo-icon bz-grid-forward\"></span>',\r\n            nextClass: \"next\",\r\n            last: '<spaz class=\"bz-mo-icon bz-grid-forward-fast\"></span>',\r\n            lastClass: \"last\",\r\n            liClass: \"bz-page\",\r\n            arrowClass: \"bz-page-arrow\",\r\n\r\n            // Call back methods\r\n            clickCallBack: function () { }\r\n\r\n        };\r\n\r\n        if (options.actualPage > options.totalPages) {\r\n            options.actualPage = options.totalPages;\r\n        }\r\n\r\n        // Extend options\r\n        $.extend(defaultOptions, defaultOptions, options);\r\n\r\n        var pagination = {\r\n            previousPage: (defaultOptions.actualPage > 1) ? defaultOptions.actualPage - 1 : 1,\r\n            nextPage: (defaultOptions.actualPage < defaultOptions.totalPages) ? defaultOptions.actualPage + 1 : defaultOptions.totalPages\r\n        };\r\n\r\n        // Modalview template\r\n        var modalTemplate = \"<div data-role='modalview' class='bz-rn-modal-pagination' style='width: 50%; height: 65%;'>\" +\r\n            \"\t<div data-role='header' class='bz-rn-modal-pagination-header'>\" +\r\n            \"\t\t<div class='bz-rn-modal-pagination-header-navigation' data-role='navbar'>\" +\r\n            \"\t\t\t<div class='bz-rn-modal-pagination-header-title'>\" +\r\n            \"\t\t\t\t<span class='bz-rn-modal-pagination-header-title-text'>#=data.title#</span>\" +\r\n            \"\t\t\t\t<span class='bz-rn-modal-pagination-header-title-cancel bz-mo-icon bz-cancel'></span>\" +\r\n            \"\t\t\t</div>\" +\r\n            \"\t\t\t<div class='bz-rn-modal-pagination-header-search'>\" +\r\n            \"\t\t\t\t<input class='bz-rn-modal-pagination-header-filter' type='text' placeholder='Type page...' />\" +\r\n            \"\t\t\t\t<span class='bz-rn-modal-pagination-header-filter-search bz-mo-icon bz-search'></span>\" +\r\n            \"\t\t\t\t<span class='bz-rn-modal-pagination-header-filter-cancel bz-mo-icon bz-circle-cross-full'></span>\" +\r\n            \"\t\t\t</div>\" +\r\n            \"\t\t</div>\" +\r\n            \"\t</div>\" +\r\n            \"\t<div class='bz-rn-modal-pagination-content'>\" +\r\n            \"\t\t<ul class='bz-rn-modal-pagination-content-list'>\" +\r\n            \"\t\t\t# $.each (data.list, function (i, item) { #\" +\r\n            \"\t\t\t<li class='bz-rn-modal-pagination-content-list-item' data-page='#= item.id #'>#= item.value #</li>\" +\r\n            \"\t\t\t# }) #\" +\r\n            \"\t\t</ul>\" +\r\n            \"\t</div>\" +\r\n            \"\t<div data-role='footer' class='bz-rn-modal-pagination-footer'>\" +\r\n            \"\t\t<div class='bz-rn-modal-pagination-footer-navigation' data-role='navbar'>\" +\r\n            \"\t\t\t<a class='bz-rn-modal-pagination-footer-action' data-align='right' data-role='button'>#=data.action#</a>\" +\r\n            \"\t\t</div>\" +\r\n            \"\t</div>\" +\r\n            \"</div>\";\r\n\r\n        /**\r\n         * init\r\n         * @returns {} \r\n         */\r\n        function init() {\r\n            // Add control elements\r\n            if (defaultOptions.totalPages && defaultOptions.totalPages > 1) {\r\n\r\n                defaultOptions.pages = [];\r\n                for (var i = 1; i <= defaultOptions.totalPages; i++) {\r\n                    defaultOptions.pages.push({\r\n                        id: i,\r\n                        value: i,\r\n                        active: (i === defaultOptions.actualPage)\r\n                    });\r\n                }\r\n\r\n                renderControlsArrows();\r\n\r\n                // Add events\r\n                attachEvents();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Append control arrow to list\r\n         * @returns {} \r\n         */\r\n        function renderControlsArrows() {\r\n            // add prev arrow\r\n            defaultOptions.listElement.prepend(\"<li/>\").find(\"li:first\")\r\n                .addClass(defaultOptions.arrowClass + \" \" + defaultOptions.previousClass)\r\n                .data(\"page\", pagination.previousPage)\r\n                .html(defaultOptions.previous);\r\n\r\n            // add first arrow\r\n            defaultOptions.listElement.prepend(\"<li/>\").find(\"li:first\")\r\n                .addClass(defaultOptions.arrowClass + \" \" + defaultOptions.firstClass)\r\n                .data(\"page\", defaultOptions.firstPage)\r\n                .html(defaultOptions.first);\r\n\r\n            // add next arrow\r\n            defaultOptions.listElement.append(\"<li/>\").find(\"li:last\")\r\n                .addClass(defaultOptions.arrowClass + \" \" + defaultOptions.nextClass)\r\n                .data(\"page\", pagination.nextPage)\r\n                .html(defaultOptions.next);\r\n\r\n            // add last arrow\r\n            defaultOptions.listElement.append(\"<li/>\").find(\"li:last\")\r\n                .addClass(defaultOptions.arrowClass + \" \" + defaultOptions.lastClass)\r\n                .data(\"page\", defaultOptions.totalPages)\r\n                .html(defaultOptions.last);\r\n        }\r\n\r\n        /**\r\n         * Add events\r\n         * @returns {} \r\n         */\r\n        function attachEvents() {\r\n            // Click event for list element            \r\n            $(\"li.\" + defaultOptions.arrowClass, defaultOptions.listElement).click(function () {\r\n                var page = ($(this).hasClass(defaultOptions.lastClass)) ? defaultOptions.totalPages : Number($(this).data(\"page\"));\r\n\r\n                defaultOptions.clickCallBack({ page: page });\r\n            });\r\n\r\n            // Show popup pager\r\n            $(\"li.active .bz-page-index\", defaultOptions.listElement).click(function () {\r\n                showModalPage();\r\n            });\r\n        }\r\n\r\n        /**\r\n         * show modalview with pages\r\n         * @returns {} \r\n         */\r\n        function showModalPage() {\r\n            //var title = bizagi.localization.getResource(\"text-cancel\");\r\n            var title = \"Go to page\";\r\n            var placeholder = \"Type page...\";\r\n            var action = \"GO\";\r\n\r\n            var modalPagerTemplate = kendo.template(modalTemplate, { useWithBlock: false });\r\n            var modalPager = $(modalPagerTemplate({ list: defaultOptions.pages, title: title, placeholder: placeholder, action: action }).trim());\r\n\r\n            modalPager.kendoMobileModalView({\r\n                close: function() {\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            attachModalHandlers(modalPager);\r\n\r\n            // Add arrow on modal\r\n            modalPager.closest(\".km-modalview-wrapper\")\r\n                .addClass(\"bz-rn-modal-pagination-position\")\r\n                .addClass(\"bz-rn-modal-pagination-container\");\r\n\r\n            modalPager.kendoMobileModalView(\"open\");\r\n        }\r\n\r\n        /**\r\n         * Attach events to modalview\r\n         * @param {} modalContainer \r\n         * @returns {} \r\n         */\r\n        function attachModalHandlers(modalContainer) {\r\n\r\n            var listItems = modalContainer.find(\".bz-rn-modal-pagination-content-list li\");\r\n            var modalListContainer = modalContainer.find(\".bz-rn-modal-pagination-content-list\");\r\n\r\n            // Close modalview\r\n            modalContainer.on(\"click\", \".bz-rn-modal-pagination-header-title-cancel\", function () {\r\n                modalContainer.kendoMobileModalView(\"close\");\r\n            });\r\n\r\n            // Change to page selected\r\n            modalContainer.on(\"click\", \".bz-rn-modal-pagination-footer-action\", function () {\r\n                var itemSelected = modalListContainer.find(\".bz-rn-modal-pagination-content-list-item-selected\");\r\n\r\n                if (itemSelected && itemSelected.length > 0) {\r\n                    var page = Number(itemSelected.data(\"page\"));\r\n\r\n                    modalContainer.kendoMobileModalView(\"close\");\r\n                    defaultOptions.clickCallBack({ page: page });\r\n                }\r\n            });\r\n\r\n            // Filtering list\r\n            modalContainer.find(\".bz-rn-modal-pagination-header-filter\").keyup(function (event) {\r\n                var that = this;\r\n\r\n                if (event.which === 13) {\r\n                    search({ container: modalContainer, list: listItems, query: that.value, force: true });\r\n                } else {\r\n                    if (that.timeout)\r\n                        clearTimeout(that.timeout);\r\n\r\n                    that.timeout = setTimeout(function () {\r\n                        search({ container: modalContainer, list: listItems, query: that.value });\r\n                    }, 300);\r\n                }\r\n            });\r\n\r\n            // Cleaning list\r\n            modalContainer.find(\".bz-rn-modal-pagination-header-filter-cancel\").on(\"click\", function () {\r\n                search({ container: modalContainer, list: listItems, query: \"\", force: true });\r\n                modalContainer.find(\".bz-rn-modal-pagination-header-filter\").val(\"\");\r\n            });\r\n\r\n            // List Selectable\r\n            modalListContainer.on(\"click\", \"li\", function () {\r\n                var that = this;\r\n\r\n                modalListContainer\r\n                    .find(\".bz-rn-modal-pagination-content-list-item-selected\")\r\n                    .removeClass(\"bz-rn-modal-pagination-content-list-item-selected\");\r\n\r\n                $(that).addClass(\"bz-rn-modal-pagination-content-list-item-selected\");\r\n            });\r\n        }\r\n\r\n        /**\r\n         * filter pages\r\n         * @param {} params \r\n         * @returns {} \r\n         */\r\n        function search(params) {\r\n            var self = this;\r\n            var container = params.container;\r\n            var list = params.list;\r\n\r\n            if (params.query === self.lastProcessedValue && !params.force) {\r\n                return;\r\n            }\r\n\r\n            self.lastProcessedValue = params.query;\r\n\r\n            if (params.query !== \"\") {\r\n                if (container.find(\".bz-rn-modal-pagination-header-filter-cancel\").css(\"display\") === \"none\")\r\n                    container.find(\".bz-rn-modal-pagination-header-filter-cancel\").show(500);\r\n            } else {\r\n                container.find(\".bz-rn-modal-pagination-header-filter-cancel\").hide(500);\r\n            }\r\n\r\n            // List filter\r\n            var filter = new RegExp(params.query, \"i\");\r\n            list.filter(function () {\r\n                var that = this;\r\n                if (filter.test($(that).text())) {\r\n                    return $(that);\r\n                } else {\r\n                    $(that).hide();\r\n                }\r\n            }).show();\r\n        }\r\n\r\n        // Init plugin\r\n        init();\r\n    };\r\n})(jQuery);\r\n\r\n","/* \r\n * Simple Grid Control for Bizagi Mobile\r\n * @author: Richar Urbano <Richar.Urbano@Bizagi.com>\r\n */\r\n\r\n(function ($) {\r\n    $.fn.mobileGrid = function (options) {\r\n\r\n        var defaultOptions = {\r\n            id: \"no-id\",\r\n            columns: [],\r\n            sortBy: \"\",\r\n            sortType: \"asc\",\r\n            showSummary: false,\r\n            collapse: false,\r\n            collapseState: false,\r\n            data: {},\r\n            indexedData: {},\r\n            maxColumns: 0,\r\n            buttonsPst: false,\r\n            title: \"\",\r\n            tableCssClass: \"\",\r\n            headerStyles: \"\",\r\n            columnKeyStyle: \"bz-rn-grid-column-key\",\r\n            columnHiddenStyle: \"bz-rn-grid-column-hidden\",\r\n            template: {\r\n                grid: \"\",\r\n                waiting: \"\",\r\n                table: \"\",\r\n                emptyTable: \"\",\r\n                column: \"\",\r\n                specialColumn: \"\",\r\n                row: \"\",\r\n                rowButtons: \"\",\r\n                cell: \"\",\r\n                specialCell: \"\",\r\n                pager: \"\",\r\n                buttons: \"\",\r\n                dynamicPager: \"\",\r\n                summary: \"\",\r\n                summaryCell: \"\"\r\n            },\r\n            actions: {\r\n                add: true,\r\n                edit: true,\r\n                remove: true,\r\n                details: true\r\n            },\r\n            mode: \"execution\"\r\n        };\r\n\r\n        var self = this;\r\n        self.element = this;\r\n        self.options = $.extend(defaultOptions, options || {});        \r\n\r\n        // Init plugin\r\n        init();\r\n\r\n        return {\r\n            setData: setData,\r\n            getData: getData,\r\n            getNewRowKeys: getNewRowKeys,\r\n            changeCellValue: changeCellValue,\r\n            refreshSummary: refreshSummary,\r\n            getContainer: getContainer,\r\n            processAction: processAction\r\n        };\r\n\r\n        /**\r\n         * Constructor\r\n         * @returns {} \r\n         */\r\n        function init() {\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Set object variables\r\n            self.page = 1;\r\n            self.changes = {};\r\n            self.totalRows = 0;\r\n            self.totalPages = 0;\r\n            self.data = options.data;\r\n            self.selectedRow = 0;\r\n            self.components = {};\r\n            self.buttons = {};\r\n            self.asyncCells = {};\r\n\r\n            // Build column indexes\r\n            self.columnByIndex = {};\r\n            self.columnByName = {};\r\n            self.columnKeyIndex = 0;\r\n\r\n            $.each(options.columns, function (i, column) {\r\n                // Fix non-present properties\r\n                column.key = typeof (column.key) !== \"undefined\" ? column.key : false;\r\n                column.label = typeof (column.label) !== \"undefined\" ? column.label : column.name;\r\n                column.sortType = \"asc\";\r\n\r\n                // Index the column\r\n                self.columnByIndex[column.index] = column;\r\n                self.columnByName[column.name] = column;\r\n                if (column.key) {\r\n                    self.columnKeyIndex = column.index;\r\n                }\r\n            });\r\n\r\n            // Set sort options\r\n            options.sortBy = options.sortBy || self.columnByIndex[0].name;\r\n            if (self.columnByName[options.sortBy]) {\r\n                self.columnByName[options.sortBy].sortType = options.sortType;\r\n            } else {\r\n                if (self.columnByName[options.sortBy.split(\".\")[0]]) {\r\n                    self.columnByName[options.sortBy.split(\".\")[0]].sortType = options.sortType;\r\n                }\r\n            }\r\n\r\n            // Add base classes\r\n            //element.addClass(\"ui-bizagi-grid-wrapper\");\r\n            element.attr(\"data-bizagi-id\", options.id);\r\n\r\n            // Calculate\r\n            calculateKeyIndex();\r\n\r\n            //collapse state\r\n            self.collapseState = options.collapseState;\r\n\r\n            // Start waiting signal \r\n            //self.startLoading(false);\r\n        }        \r\n\r\n        /**\r\n         * Method to start loading for ajax data and update the ui\r\n         * @returns {} \r\n         */\r\n        function startLoading(bUseTimeout) {\r\n            bUseTimeout = typeof (bUseTimeout) !== \"undefined\" ? bUseTimeout : true;\r\n\r\n            if (self.options.mode != \"execution\" || typeof self.options.sortBy === \"undefined\") {\r\n                return;\r\n            }\r\n\r\n            // Draw the waiting template when the endLoading delays more than 250ms\r\n            var waitingFn = function () {\r\n                var element = self.element;\r\n                var options = self.options;\r\n\r\n                // Set null to timeout\r\n                self.waitingTimeout = null;\r\n\r\n                element.empty();\r\n                element.append($.kendoTmpl(options.template.waiting));\r\n            };\r\n\r\n            if (bUseTimeout) {\r\n                self.waitingTimeout = setTimeout(waitingFn, 250);\r\n            } else {\r\n                waitingFn();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Method to remove the loading message\r\n         * @returns {} \r\n         */\r\n        function endLoading() {\r\n            var element = self.element;\r\n\r\n            // Remove waiting timeout\r\n            if (self.waitingTimeout) {\r\n                clearTimeout(self.waitingTimeout);\r\n                self.waitingTimeout = null;\r\n            }\r\n\r\n            // Remove everything\r\n            element.empty();\r\n        }\r\n\r\n        /**\r\n         * This method updates the data and refreshes the grid\r\n         * @param {} data \r\n         * @returns {} \r\n         */\r\n        function setData(data) {\r\n            // Set internal data\r\n            self.data = data;\r\n            calculateKeyIndex();\r\n\r\n            // Call refresh\r\n            refresh();\r\n        }\r\n\r\n        /**\r\n         * This method retrieves the actual data from the grid\r\n         * @returns {} \r\n         */\r\n        function getData() {\r\n            // Return internal data\r\n            return self.data;\r\n        }\r\n\r\n        /**\r\n         * Calculate key index\r\n         * @returns {} \r\n         */\r\n        function calculateKeyIndex() {\r\n            var options = self.options;\r\n            var columns = options.columns;\r\n            var data = self.data;\r\n            var indexedData = {};\r\n\r\n            if (data.rows) {\r\n                $.each(data.rows, function (i, row) {\r\n                    var key;\r\n                    var row\r\n                    $.each(columns, function (j, column) {\r\n                        if (column.key) key = row[j];\r\n                    });\r\n\r\n                    indexedData[key] = row;\r\n                });\r\n            }\r\n            self.indexedData = indexedData;\r\n        }\r\n\r\n        /**\r\n         * This method refreshes the grid\r\n         * @returns {} \r\n         */\r\n        function refresh() {\r\n            // Cleans components\r\n            _cleanComponents();\r\n            //_cleanButtons();\r\n\r\n            // Call the draw method\r\n            self.components = {};\r\n            draw();\r\n        }\r\n\r\n        /**\r\n         * This method refreshes only the summary\r\n         * @param {} columnIndex \r\n         * @returns {} \r\n         */\r\n        function refreshSummary(columnIndex) {\r\n            //var self = this;\r\n            var options = self.options;\r\n            var summary = _getComponent(\"summary\");\r\n\r\n            // Do nothing if the component is drawing or there is no summary\r\n            if (self.drawing) return;\r\n            if (!summary) return;\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n\r\n                if (columnIndex) {\r\n                    // Refresh an specific summary\r\n                    refreshSummaryCell(columnIndex);\r\n\r\n                } else {\r\n                    // Clean and re-draw summary\r\n                    summary.empty();\r\n                    summary.append(drawSummary());\r\n\r\n                    // Execute post-render\r\n                    postRenderSummary(summary);\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * This method changes a cell value in the grid\r\n         * @param {} key \r\n         * @param {} columnIndex \r\n         * @param {} value \r\n         * @returns {} \r\n         */\r\n        function changeCellValue(key, columnIndex, value) {\r\n            if (self.indexedData[key]) {\r\n                self.indexedData[key][columnIndex] = value;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * This method draws the full grid associated with the data\r\n         * @returns {} \r\n         */\r\n        function draw() {\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Start global drawing flag\r\n            self.drawing = true;\r\n\r\n            // Ends waiting signal\r\n            endLoading();\r\n\r\n            // Resolve grid template\r\n            var html = $.kendoTmpl(options.template.grid, {\r\n                label: options.title,\r\n                buttonsPst: options.buttonsPst,\r\n                collapse: options.collapse,\r\n                collapseState: self.collapseState,\r\n                isDesign: (options.mode === \"design\")\r\n            });\r\n\r\n            // Call sub-drawers\r\n            html = drawTable(html);\r\n            self.grid = $(html).appendTo(element);\r\n\r\n            // Post render the grid\r\n            postRender(self.grid);\r\n\r\n            // Attach paginator desktop\r\n            attachPaginator();\r\n\r\n            // Attach handlers\r\n            attachHandlers();\r\n\r\n            // Toggle visibility depending from row count\r\n            if (self.data.rows.length === 0) {\r\n                _getComponent(\"table\").hide();\r\n                _getComponent(\"pager\").hide();\r\n\r\n                _getComponent(\"emptyTable\").show();\r\n\r\n            } else {\r\n                _getComponent(\"table\").show();\r\n                _getComponent(\"pager\").show();\r\n\r\n                //_getComponent(\"dynamicPager\").hide();\r\n                _getComponent(\"emptyTable\").hide();\r\n            }\r\n\r\n            // End global drawing flag\r\n            self.drawing = false;\r\n        }\r\n\r\n        /**\r\n         * This method draws the table associated with the data\r\n         * @param {} html \r\n         * @returns {} \r\n         */\r\n        function drawTable(html) {\r\n            var options = self.options;\r\n\r\n            // Resolve table template\r\n            var table = $.kendoTmpl(options.template.table, {\r\n                showSummary: options.showSummary,\r\n                tableCssClass: options.tableCssClass\r\n            });\r\n\r\n            var emptyTable = $.kendoTmpl(options.template.emptyTable);\r\n\r\n            // Resolve header\r\n            table = _replaceElement(table, \"columns\", drawHeader());\r\n\r\n            // Resolve body\r\n            table = _replaceElement(table, \"rows\", drawBody());\r\n\r\n            // Resolve pager\r\n            html = _replaceElement(html, \"pager\", drawPager());\r\n\r\n            // Perform grid replaces\r\n            html = _replaceElement(html, \"table\", table);\r\n            html = _replaceElement(html, \"emptyTable\", emptyTable);\r\n\r\n            return html;\r\n        }\r\n\r\n        /*\r\n        *   Execute post-renders in all the grid\r\n        */\r\n        function postRender() {\r\n            //var options = self.options;\r\n\r\n            // Get grid rows\r\n            var rows = _getComponent(\"cells\");\r\n            if (rows) {\r\n                $.each(rows, function (i, row) {\r\n                    row = $(row);\r\n                    postRenderRow(row);\r\n                });\r\n            }\r\n        }\r\n\r\n        /**\r\n        * Find if a column has a exact match for sort it\r\n        * @returns {} \r\n        */\r\n        function isExactMatch() {\r\n            var options = self.options;\r\n            var columns = options.columns;\r\n            var sortBy = options.sortBy;\r\n\r\n            var i = 0;\r\n            var length = columns.length;\r\n\r\n            for (; i < length;) {\r\n                if (sortBy === columns[i++].name) {\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        /**\r\n         * Execute post-renders in each cell after the element has been created\r\n         * @param {} row \r\n         * @returns {} \r\n         */\r\n        function postRenderRow(row) {\r\n            //var self = this;\r\n            var key = row.attr(\"data-business-key\");\r\n            var isNewRow = row.attr(\"data-new-row\");\r\n            var cells = row.is(\"[data-bizagi-component=cells]\") ? row.children() : row.find(\"[data-bizagi-component=cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            onCellReady(column, key, cell, isNewRow);\r\n                        });\r\n                } else {\r\n                    onCellReady(column, key, $(cell), isNewRow);\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         * This method draws the table body\r\n         * @returns {} \r\n         */\r\n        function drawBody() {\r\n            // Resolve rows\r\n            var rows = \"\";\r\n\r\n            $.each(self.data.rows, function (i, row) {\r\n                rows += drawRow(row);\r\n            });\r\n\r\n            return rows;\r\n        }\r\n\r\n        /**\r\n         * This method draws a grid row\r\n         * @param {} rowData \r\n         * @param {} isNewRow \r\n         * @returns {} \r\n         */\r\n        function drawRow(rowData, isNewRow) {\r\n            var options = self.options;\r\n            var key = rowData[self.columnKeyIndex];\r\n            var newRow = isNewRow || false;\r\n            var rnd = Math.floor(Math.random() * 10000);\r\n\r\n            var row = $.kendoTmpl(options.template.row, {\r\n                key: rnd,\r\n                isNewRow: isNewRow,\r\n                businessKey: key\r\n            });\r\n\r\n            // Resolve cells\r\n            var cells = \"\";\r\n            var bSpecialCellAdded = false;\r\n            $.each(rowData, function (i, cell) {\r\n                if (bSpecialCellAdded) {\r\n                    return;\r\n                }\r\n\r\n                if (options.maxColumns > 0) {\r\n                    if (i < options.maxColumns + 1) {\r\n                        // Draw normal cell\r\n                        cells += drawCell(i, key, cell, newRow);\r\n                    } else {\r\n                        // Draw special cell\r\n                        cells += drawSpecialCell(i, key, cell);\r\n                        bSpecialCellAdded = true;\r\n                    }\r\n                } else {\r\n                    // Draw normal cell\r\n                    cells += drawCell(i, key, cell, newRow);\r\n                }\r\n            });\r\n\r\n            // Resolve cells template\r\n            row = _replaceElement(row, \"cells\", cells);\r\n            return row;\r\n        }\r\n\r\n        /**\r\n         * This method draws the grid header\r\n         * @returns {} \r\n         */\r\n        function drawHeader() {\r\n            var options = self.options;\r\n\r\n            // Resolve columns\r\n            var columns = \"\";\r\n            var bSpecialColumnAdded = false;\r\n\r\n            self.exactMatch = isExactMatch();\r\n\r\n            $.each(options.columns, function (i, column) {\r\n                if (bSpecialColumnAdded) {\r\n                    return;\r\n                }\r\n\r\n                if (options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw normal column\r\n                        columns += drawColumn(column);\r\n                    } else {\r\n                        // Draw special column\r\n                        columns += drawSpecialColumn(column);\r\n                        bSpecialColumnAdded = true;\r\n                    }\r\n                } else {\r\n                    // Draw normal column\r\n                    columns += drawColumn(column);\r\n                }\r\n            });\r\n\r\n            return columns;\r\n        }\r\n\r\n        /**\r\n         * This method draws a column header\r\n         * @param {} column \r\n         * @returns {} \r\n         */\r\n        function drawColumn(column) {\r\n            var options = self.options;\r\n            var cssClass;\r\n\r\n            if (column.key) {\r\n                cssClass = options.columnKeyStyle;\r\n            } else {\r\n                if (column.hidden) {\r\n                    cssClass = options.columnHiddenStyle;\r\n                } else {\r\n                    cssClass = (typeof column.bizAgiProperties != \"undefined\" && column.bizAgiProperties.cssclass) ? column.bizAgiProperties.cssclass : \"\";\r\n                }\r\n            }\r\n\r\n            // Resolve column template\r\n            var sortActive = column.name === options.sortBy ? column.name === options.sortBy : column.name === options.sortBy.split(\".\")[0] && !self.exactMatch ? column.name === options.sortBy.split(\".\")[0] : false;\r\n\r\n            return $.kendoTmpl(options.template.column, $.extend({}, column, {\r\n                sortActive: sortActive,\r\n                sortType: options.sortOrder,\r\n                headerLabelStyles: options.headerStyles ? options.headerStyles.label : \"\",\r\n                headerStyles: options.headerStyles ? options.headerStyles.header : \"\",\r\n                columnCssClass: cssClass\r\n            }));\r\n        }\r\n\r\n        /**\r\n         * This method draws the grid cell\r\n         * @param {} columnIndex \r\n         * @param {} key \r\n         * @param {} value \r\n         * @param {} isNewRow \r\n         * @returns {} \r\n         */\r\n        function drawCell(columnIndex, key, value, isNewRow) {\r\n            var options = self.options;\r\n            var messageValidation = \"\";\r\n\r\n            isNewRow = isNewRow || false;\r\n\r\n            // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            }\r\n\r\n            // Get message\r\n            if (columnIndex > 0) {\r\n                messageValidation = self.columnByIndex[columnIndex].bizAgiProperties && self.columnByIndex[columnIndex].bizAgiProperties.messageValidation;\r\n            }\r\n\r\n            var isKey = self.columnByIndex[columnIndex].key;\r\n            var hidden = options.columns[columnIndex].hidden || false;\r\n            var cssClass;\r\n\r\n            if (isKey) {\r\n                cssClass = options.columnKeyStyle;\r\n            } else {\r\n                if (hidden) {\r\n                    cssClass = options.columnHiddenStyle;\r\n                } else {\r\n                    cssClass = (typeof self.columnByIndex[columnIndex].bizAgiProperties != \"undefined\" && self.columnByIndex[columnIndex].bizAgiProperties.cssclass) ? self.columnByIndex[columnIndex].bizAgiProperties.cssclass : \"\";\r\n                }\r\n            }\r\n\r\n            // Resolve cell template\r\n            var cell = $.kendoTmpl(options.template.cell, {\r\n                isKey: isKey,\r\n                hidden: hidden,\r\n                isDesign: (options.mode === \"design\"),\r\n                messageValidation: messageValidation,\r\n                columnCssClass: cssClass\r\n            });\r\n\r\n            var result = onDrawCell(self.columnByIndex[columnIndex], key, value, isNewRow);\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = _replaceElement(cell, \"cellContent\", resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = _replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = _replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            self.columnByIndex[columnIndex][\"cell\"] = $(cell);\r\n\r\n            return cell;\r\n        }\r\n\r\n        /**\r\n         * This method draws a grid pager\r\n         * @returns {} \r\n         */\r\n        function drawPager() {\r\n            var options = self.options;\r\n            var pagerData = {};\r\n\r\n            pagerData.hasPagination = self.data.total > 1 ? true : false;\r\n            pagerData.page = Number(self.data.page);\r\n\r\n            // Calculate pages\r\n            pagerData.pages = [];\r\n            for (var i = 1; i <= self.data.total; i++) {\r\n                pagerData.pages.push({\r\n                    number: i,\r\n                    active: (i === pagerData.page)\r\n                });\r\n            }\r\n\r\n            // Set style pagination            \r\n            pagerData.previousPage = (self.data.page > 1) ? self.data.page - 1 : 1;\r\n            pagerData.nextPage = (self.data.page < self.data.total) ? self.data.page + 1 : self.data.total;\r\n            pagerData.totalPages = self.data.total;\r\n\r\n            return $.kendoTmpl(options.template.pager, pagerData);\r\n        }\r\n\r\n        /**\r\n         * Returns the resolved result from a promise when the promise has been executed already\r\n         * @param {} promise \r\n         * @returns {} \r\n         */\r\n        function resolveResult(promise) {\r\n            var result;\r\n\r\n            promise.done(function (data) {\r\n                result = data;\r\n            });\r\n\r\n            return result;\r\n        }\r\n\r\n        /**\r\n         * Method to attach any handler to the pager grid\r\n         * @returns {} \r\n         */\r\n        function attachPaginator() {\r\n            if (self.data.total > 1) {\r\n\r\n                var pagerContainer = _getComponent(\"pager\").find(\"ul\");\r\n                var pagerOptions = {\r\n                    totalPages: self.data.total,\r\n                    actualPage: Number(self.data.page),\r\n                    listElement: pagerContainer,\r\n                    clickCallBack: function (options) {\r\n                        changePage(options.page);\r\n                    }\r\n                };\r\n\r\n                // Create pagination control \r\n                pagerContainer.mobilePagination(pagerOptions);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Method to attach any handler to the grid\r\n         * @returns {} \r\n         */\r\n        function attachHandlers() {\r\n\r\n            // Add selection events\r\n            _getComponent(\"rows\").find(\"tr\").on(\"click\", function () {\r\n                var key = $(this).attr(\"data-key\");\r\n                var businessKey = $(this).attr(\"data-business-key\");\r\n\r\n                selectRow(key, businessKey);\r\n            });\r\n\r\n            // Add sort events\r\n            _getComponent(\"columns\").find(\".bz-rn-grid-column\").on(\"click\", function () {\r\n                var columnIndex = $(this).attr(\"data-column-index\");\r\n\r\n                sortBy(columnIndex);\r\n            });\r\n\r\n            // ActionSheet to process actions\r\n            _getComponent(\"rows\").find(\"tr\").actionSheet({\r\n                actions: _showActions(),\r\n                titleLabel: \"Selected Row\",\r\n                setDataToShow: function (evt) {\r\n                    var that = this;\r\n                    var key = $(evt.target).closest(\"tr\").attr(\"data-key\");\r\n                    var businessKey = $(evt.target).closest(\"tr\").attr(\"data-business-key\");\r\n\r\n                    that.params = { key: key, businessKey: businessKey };\r\n                },\r\n                actionClicked: function (action) {\r\n                    var that = this;\r\n\r\n                    processAction(action.guid, that.params);\r\n                    unselectRow();\r\n                },\r\n                cancelClicked: function (event) {\r\n                    unselectRow();\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         *  Method to get the valid options to the grid\r\n         * @returns {} \r\n         */\r\n        function _showActions() {\r\n            var actions = [];\r\n            var options = self.options;\r\n            var tooltips = options.tooltips || {};\r\n            var parameters = $.extend(options.actions, tooltips);\r\n\r\n            if (parameters.edit) {\r\n                actions.push({ guid: \"edit\", displayName: parameters.editLabel });\r\n            }\r\n\r\n            if (parameters.remove) {\r\n                actions.push({ guid: \"remove\", displayName: parameters.deleteLabel });\r\n            }\r\n\r\n            if (parameters.details) {\r\n                actions.push({ guid: \"details\", displayName: parameters.detailLabel });\r\n            }\r\n\r\n            return actions;\r\n        }\r\n\r\n        /**\r\n         * Process an action in order to do something with the grid\r\n         * @param {} action \r\n         * @param {} params \r\n         * @returns {} \r\n         */\r\n        function processAction(action, params) {\r\n\r\n            if (action === \"edit\") {\r\n                onEditRow(params);\r\n            }\r\n\r\n            if (action === \"remove\") {\r\n                onDeleteRow();\r\n            }\r\n\r\n            if (action === \"details\") {\r\n                onShowDetails(params);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Changes the current page in the grid\r\n         * @param {} page \r\n         * @returns {} \r\n         */\r\n        function changePage(page) {\r\n            var currentPage = Number(self.data.page);\r\n            var total = self.data.total;\r\n            var newPage = page;\r\n\r\n            if (newPage === currentPage || newPage < 1 || newPage > total)\r\n                return;\r\n\r\n            //refresh components cells and rows\r\n            _cleanComponents();\r\n\r\n            // Update internal options\r\n            self.page = Number(newPage);\r\n\r\n            // Execute handler\r\n            onPageRequested();\r\n        }\r\n\r\n        /**\r\n         * Sort the grid by a column\r\n         * @param {} columnIndex \r\n         * @param {} sortType \r\n         * @returns {} \r\n         */\r\n        function sortBy(columnIndex, sortType) {\r\n            var options = self.options;\r\n            var column = self.columnByIndex[columnIndex];\r\n\r\n            if (typeof (options.sortBy) === \"undefined\") {\r\n                return;\r\n            }\r\n\r\n            // Set new sort type reversed to current, if the sort column has not changed\r\n            if (typeof (column.name) === \"undefined\") {\r\n                column.name = column.label;\r\n            }\r\n\r\n            if (column.name === options.sortBy) {\r\n                sortType = sortType || (options.sortOrder === \"asc\" ? \"desc\" : \"asc\");\r\n            } else {\r\n                if (column.name === options.sortBy.split(\".\")[0]) {\r\n                    sortType = sortType || (options.sortType === \"asc\" ? \"desc\" : \"asc\");\r\n                } else {\r\n                    sortType = sortType || options.sortType;\r\n                }\r\n            }\r\n\r\n            // Update internal options\r\n            if (options.sortBy.split(\".\").length > 1) {\r\n                if (options.sortBy.split(\".\")[0] !== column.name) {\r\n                    options.sortBy = column.name;\r\n                } else {\r\n                    options.sortBy = column.name;\r\n                }\r\n            } else {\r\n                options.sortBy = column.name;\r\n            }\r\n\r\n            options.sortColumn = column;\r\n            options.sortType = sortType;\r\n            options.sortOrder = sortType;\r\n\r\n            //refresh components cells and rows\r\n            _cleanComponents();\r\n\r\n            // Execute handler\r\n            onSortRequested();\r\n        }\r\n\r\n        /**\r\n         *  Selects a row in the grid\r\n         * @param {} key \r\n         * @param {} businessKey \r\n         * @returns {} \r\n         */\r\n        function selectRow(key, businessKey) {\r\n\r\n            if (self.selectedRow === key) {\r\n                // Invoke un-select handler\r\n                onRowUnselected();\r\n\r\n                // Update internal options\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            } else {\r\n                if (self.selectedRow !== 0) {\r\n                    // Invoke un-select handler\r\n                    onRowUnselected();\r\n                }\r\n\r\n                // Update internal options\r\n                self.selectedRow = key;\r\n                self.selectedBusinessKey = businessKey;\r\n\r\n                // Invoke select handler\r\n                onRowSelected();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Unselects a row in the grid\r\n         * @returns {} \r\n         */\r\n        function unselectRow() {\r\n            if (self.selectedRow !== 0) {\r\n                // Invoke un-select handler\r\n                onRowUnselected();\r\n\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Executes the on draw cell handler\r\n         * @param {} column \r\n         * @param {} key \r\n         * @param {} value \r\n         * @param {} isNewRow \r\n         * @returns {} \r\n         */\r\n        function onDrawCell(column, key, value, isNewRow) {\r\n            return _triggerHandler(\"drawCell\", { column: column, key: key, value: value, isNewRow: isNewRow });\r\n        }\r\n\r\n        /**\r\n         * Executes on cell ready handler\r\n         * @param {} column \r\n         * @param {} key \r\n         * @param {} cell \r\n         * @param {} isNewRow \r\n         * @returns {} \r\n         */\r\n        function onCellReady(column, key, cell, isNewRow) {\r\n            return _triggerHandler(\"cellReady\", { column: column, key: key, cell: cell, isNewRow: isNewRow });\r\n        }\r\n\r\n        /**\r\n         * Executes the row selected handle\r\n         * @returns {} \r\n         */\r\n        function onRowSelected() {\r\n            return _triggerHandler(\"rowSelected\", { key: self.selectedRow });\r\n        }\r\n\r\n        /**\r\n         * Executes the row un-selected handler\r\n         * @returns {} \r\n         */\r\n        function onRowUnselected() {\r\n            return _triggerHandler(\"rowUnselected\", { key: self.selectedRow });\r\n        }\r\n\r\n        /**\r\n         * Executes the on delete row handler\r\n         * @returns {} \r\n         */\r\n        function onDeleteRow() {\r\n            return _triggerHandler(\"deleteRow\", { key: self.selectedBusinessKey });\r\n        }\r\n\r\n        /**\r\n         * Executes the on show details handler\r\n         * @returns {} \r\n         */\r\n        function onShowDetails() {\r\n            return _triggerHandler(\"showFormDetails\", { key: self.selectedBusinessKey });\r\n        }\r\n\r\n        /**\r\n         * Executes the on edit row handler\r\n         * @returns {} \r\n         */\r\n        function onEditRow() {\r\n            return _triggerHandler(\"editRow\", { key: self.selectedBusinessKey });\r\n        }\r\n\r\n        /**\r\n         * Executes the page requested handler\r\n         * @returns {} \r\n         */\r\n        function onPageRequested() {\r\n            // Start loading signal \r\n            //startLoading();\r\n\r\n            // Trigger handler\r\n            return _triggerHandler(\"pageRequested\", _buildRefreshParameters());\r\n        }\r\n\r\n        /**\r\n         * Executes the sort requested handler\r\n         * @returns {} \r\n         */\r\n        function onSortRequested() {\r\n            // Start loading signal \r\n            //startLoading();\r\n\r\n\r\n            // Trigger handler\r\n            return _triggerHandler(\"sortRequested\", _buildRefreshParameters());\r\n        }\r\n\r\n        /**\r\n         * Calls directly to handler callback\r\n         * @param {} type \r\n         * @param {} data \r\n         * @returns {} \r\n         */\r\n        function _triggerHandler(type, data) {\r\n            var callback = options[type];\r\n\r\n            if (!callback) {\r\n                return null;\r\n            }\r\n            return callback.call(self.element, data);\r\n        }\r\n\r\n        /**\r\n         * Cleans the components \r\n         * @returns {} \r\n         */\r\n        function _cleanComponents() {\r\n            self.components = {};\r\n        }\r\n\r\n        /**\r\n         * Gets the component\r\n         * @param {} component \r\n         * @returns {} \r\n         */\r\n        function _getComponent(component) {\r\n            var element = self.element;\r\n\r\n            if (!self.components[component]) {\r\n                var foundComponent = $(\"[data-bizagi-component=\" + component + \"]\", element);\r\n                if (foundComponent != null && foundComponent.length > 0) {\r\n                    self.components[component] = foundComponent;\r\n                }\r\n            }\r\n            return self.components[component];\r\n        }\r\n\r\n        /**\r\n         * Replaces a matched element in the container for the specified \"replace\" element\r\n         * @param {} html \r\n         * @param {} element \r\n         * @param {} replace \r\n         * @returns {} \r\n         */\r\n        function _replaceElement(html, element, replace) {\r\n            return html.replace(\"{{element \" + element + \"}}\", replace);\r\n        }\r\n\r\n        /**\r\n         * Return the event handler parameters object\r\n         * @returns {} \r\n         */\r\n        function _buildRefreshParameters() {\r\n            var options = self.options;\r\n            var sortColumn = (options.sortColumn != undefined) ? options.sortColumn.index : 1;\r\n            return { page: self.page, sortBy: options.sortBy, sortType: options.sortOrder, sortColumnIndex: sortColumn };\r\n        }\r\n\r\n        /**\r\n         * Return the new created ids\r\n         * @returns {} \r\n         */\r\n        function getNewRowKeys() {\r\n            var rows = _getComponent(\"rows\").find(\"[data-new-row]\");\r\n\r\n            return $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Get current content \r\n         * @returns {} \r\n         */\r\n        function getContainer() {\r\n            return $(self.element);\r\n        }\r\n\r\n\r\n    }\r\n})(jQuery);","/**\r\n* Timeago is a jQuery plugin that makes it easy to support automatically\r\n* updating fuzzy timestamps (e.g. \"4 minutes ago\" or \"about 1 day ago\").\r\n*\r\n* @name timeago\r\n* @version 1.3.1\r\n* @requires jQuery v1.2.3+\r\n* @author Ryan McGeary\r\n* @license MIT License - http://www.opensource.org/licenses/mit-license.php\r\n*\r\n* For usage and examples, visit:\r\n* http://timeago.yarp.com/\r\n*\r\n* Copyright (c) 2008-2013, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)\r\n*/\r\n\r\n(function ($) {\r\n    $.timeago = function (timestamp) {\r\n        $t.settings = {\r\n            refreshMillis: 60000,\r\n            allowFuture: false,\r\n            localeTitle: false,\r\n            cutoff: 0,\r\n            strings: {\r\n                prefixAgo: null,\r\n                prefixFromNow: null,\r\n                suffixAgo: bizagi.localization.getResource(\"bizagi-editor-form-timeago-ago\"),\r\n                suffixFromNow: bizagi.localization.getResource(\"bizagi-editor-form-timeago-from-now\"),\r\n                seconds: bizagi.localization.getResource(\"bizagi-editor-form-timeago-seconds\"),\r\n                minute: bizagi.localization.getResource(\"bizagi-editor-form-timeago-minute\"),\r\n                minutes: bizagi.localization.getResource(\"bizagi-editor-form-timeago-minutes\"),\r\n                hour: bizagi.localization.getResource(\"bizagi-editor-form-timeago-hour\"),\r\n                hours: bizagi.localization.getResource(\"bizagi-editor-form-timeago-hours\"),\r\n                day: bizagi.localization.getResource(\"bizagi-editor-form-timeago-day\"),\r\n                days: bizagi.localization.getResource(\"bizagi-editor-form-timeago-days\"),\r\n                month: bizagi.localization.getResource(\"bizagi-editor-form-timeago-month\"),\r\n                months: bizagi.localization.getResource(\"bizagi-editor-form-timeago-months\"),\r\n                year: bizagi.localization.getResource(\"bizagi-editor-form-timeago-year\"),\r\n                years: bizagi.localization.getResource(\"bizagi-editor-form-timeago-years\"),\r\n                wordSeparator: \" \",\r\n                numbers: []\r\n            }\r\n        };\r\n\r\n        if (timestamp instanceof Date) {\r\n            return inWords(timestamp);\r\n        } else if (typeof timestamp === \"string\") {\r\n            timestamp = timestamp.replace(\".\", \"-\");\r\n            return inWords($.timeago.parse(timestamp));\r\n        } else if (typeof timestamp === \"number\") {\r\n            return inWords(new Date(timestamp));\r\n        } else {\r\n            return inWords($.timeago.datetime(timestamp));\r\n        }\r\n    };\r\n    var $t = $.timeago;\r\n\r\n    $.extend($.timeago, {\r\n\r\n        /*\r\n        *\r\n        */\r\n        inWords: function (distanceMillis) {\r\n            var $l = this.settings.strings;\r\n            var prefix = $l.prefixAgo;\r\n            var suffix = $l.suffixAgo;\r\n            if (this.settings.allowFuture) {\r\n                if (distanceMillis < 0) {\r\n                    prefix = $l.prefixFromNow;\r\n                    suffix = $l.suffixFromNow;\r\n                }\r\n            }\r\n\r\n            var seconds = Math.abs(distanceMillis) / 1000;\r\n            var minutes = seconds / 60;\r\n            var hours = minutes / 60;\r\n            var days = hours / 24;\r\n            var years = days / 365;\r\n\r\n            function substitute(stringOrFunction, number) {\r\n                var string = $.isFunction(stringOrFunction) ? stringOrFunction(number, distanceMillis) : stringOrFunction;\r\n                var value = ($l.numbers && $l.numbers[number]) || number;\r\n                return string.replace(/%d/i, value);\r\n            }\r\n\r\n            var words = seconds < 45 && substitute($l.seconds, Math.round(seconds)) ||\r\n                        seconds < 90 && substitute($l.minute, 1) ||\r\n                        minutes < 45 && substitute($l.minutes, Math.round(minutes)) ||\r\n                        minutes < 90 && substitute($l.hour, 1) ||\r\n                        hours < 24 && substitute($l.hours, Math.round(hours)) ||\r\n                        hours < 42 && substitute($l.day, 1) ||\r\n                        days < 30 && substitute($l.days, Math.round(days)) ||\r\n                        days < 45 && substitute($l.month, 1) ||\r\n                        days < 365 && substitute($l.months, Math.round(days / 30)) ||\r\n                        years < 1.5 && substitute($l.year, 1) ||\r\n                        substitute($l.years, Math.round(years));\r\n\r\n            var separator = $l.wordSeparator || \"\";\r\n            if ($l.wordSeparator === undefined) { separator = \" \"; }\r\n            return $.trim([prefix, words, suffix].join(separator));\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        parse: function (iso8601) {\r\n            var s = $.trim(iso8601);\r\n            s = s.replace(/\\.\\d+/, \"\"); // remove milliseconds\r\n            s = s.replace(/-/, \"/\").replace(/-/, \"/\");\r\n            s = s.replace(/T/, \" \").replace(/Z/, \" UTC\");\r\n            s = s.replace(/([\\+\\-]\\d\\d)\\:?(\\d\\d)/, \" $1$2\"); // -04:00 -> -0400\r\n            s = s.replace(/([\\+\\-]\\d\\d)$/, \" $100\"); // +09 -> +0900\r\n            return new Date(s);\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        datetime: function (elem) {\r\n            var iso8601 = $t.isTime(elem) ? $(elem).attr(\"datetime\") : $(elem).attr(\"title\");\r\n            return $t.parse(iso8601);\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        isTime: function (elem) {\r\n            // jQuery's `is()` doesn't play well with HTML5 in IE\r\n            return $(elem).get(0).tagName.toLowerCase() === \"time\"; // $(elem).is(\"time\");\r\n        }\r\n    });\r\n\r\n    function inWords(date) {\r\n        return $t.inWords(distance(date));\r\n    }\r\n\r\n    function distance(date) {\r\n        return (new Date().getTime() - date.getTime());\r\n    }\r\n\r\n})(jQuery);\r\n","/**\r\n * Name:\r\n *   Author: Bizagi Mobile team\r\n *   Comments:\r\n * Structure to applicate plugin\r\n *  <div class=\"bz-bizagi-container-tap-popup\"> //container\r\n    <div class=\"cell bz-container-items-tabs\"> // represent item of tab\r\n    <span >${displayName}</span>// the first span always is the title                                    \r\n    <span> ........</span> // after the span can place the items you want\r\n    <div> .........</div> // etc\r\n    </div> <!-- end cell-->\r\n    </div><!-- end bz-bizagi-container-tap-popup-->\r\n**/\r\n(function ($) {\r\n    $.fn.bztabs = function (params) {\r\n\r\n        var self = $(this);\r\n\r\n        params = params || {};\r\n        params.activeTab = params.activeTab || 0;\r\n        params.tabNumber = params.tabNumber || 1;\r\n\r\n\r\n        var activate = (params.activate && typeof params.activate === \"function\") ? params.activate : function () { };\r\n        var beforeActivate = (params.beforeActivate && typeof params.beforeActivate === \"function\") ? params.beforeActivate : function () { };\r\n\r\n        // PopUp control\r\n        var popUp = self.find(\">div.bz-bizagi-container-tap-popup\").hide();\r\n        // Depending on tabNumber a percentage will be in the width of each tab\r\n        var tabCountPopup = popUp.children().length;\r\n        // Base to build the header of tabs\r\n        var tabHeader = $(\"<div class='bz-header_select'></div>\");\r\n\r\n        var tabCountReal = (params.tabNumber > tabCountPopup) ? tabCountPopup : params.tabNumber;\r\n\r\n        // round down\r\n        var widthRow = Math.floor(100 / Number(tabCountReal));\r\n\r\n        // Duplicate the tabs to create the header\r\n        popUp.children().each(function (i, item) {\r\n            tabHeader.append(\r\n                \"<div class='bz-wp-tabs-ui bz-wp-tabs-item' data-index='\" + i + \"' data-reference-tab='\" +\r\n                item.getAttribute(\"data-reference-tab\") + \"'><span>\" +\r\n                item.textContent + \"</span></div>\");\r\n        });\r\n\r\n        tabHeader.find(\"> .bz-wp-tabs-ui\").css(\"width\", widthRow + \"%\");        \r\n        tabHeader.append(\"<div class='bz-wp-tabs-arrow-container'><div class='bz-cm-icon bz-mo-icon bz-plus'></div></div>\");\r\n\r\n        self.prepend(tabHeader);\r\n\r\n        var tabCurrent = self.find(\"> .bz-bizagi-container-tap-popup > .bz-container-items-tabs\").eq(params.activeTab);\r\n        var itemCurrent = $($(tabCurrent).data(\"reference-tab\"), self);\r\n\r\n        itemCurrent.addClass(\"childrenActive\");\r\n        tabCurrent.addClass(\"tabSelected\");\r\n\r\n        // Mark the selected tab in the header\r\n        var activeTab = $(\".bz-wp-tabs-ui:nth-child(\" + (params.activeTab + 1) + \")\", tabHeader).addClass(\"tabSelected\");\r\n\r\n        // The new width will be added to the tabSelected in order to complete the 100% on tabs\r\n        var widthTabSelected = widthRow + (100 - (widthRow * tabCountReal));\r\n        activeTab.css(\"width\", widthTabSelected + \"%\");\r\n\r\n        function updateTabSize() {\r\n            if (params.tabNumber < tabCountPopup) {\r\n                // Select the current tab\r\n                $(\".bz-wp-tabs-arrow-container\", self).first().addClass(\"show-pluss\");\r\n                tabHeader.addClass(\"show-pluss\");\r\n                activeTab.trigger(\"click\", { origin: \"popUp\" });\r\n            } else {\r\n                $(\".bz-wp-tabs-arrow-container\", self).removeClass(\"show-pluss\");\r\n                tabHeader.removeClass(\"show-pluss\");\r\n                tabHeader.find(\"> .bz-wp-tabs-ui:last\").addClass(\"bz-wp-no-border\");\r\n            }\r\n        }\r\n\r\n        // Reorder tabs\r\n        function reorderTabs(dataRef) {\r\n\r\n            var tempTabs = tabHeader.find(\".bz-wp-tabs-ui\");\r\n            var moveAtTheEnd = true;\r\n\r\n            tempTabs.each(function (i, item) {\r\n                if (dataRef !== item.getAttribute(\"data-reference-tab\") && moveAtTheEnd) {\r\n                    tabHeader.remove(\"[data-reference-tab='\" + dataRef + \"']\");\r\n                    tabHeader.append(item);\r\n                } else {\r\n                    moveAtTheEnd = false;\r\n                }\r\n            });\r\n        }\r\n\r\n        // Change tabs\r\n        function changeTab(e, params) {\r\n\r\n            params = params || {};\r\n            params.origin = params.origin || \"header\";\r\n\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n\r\n            if ($(this).hasClass(\"tabSelected\") && params.origin !== \"popUp\") {\r\n                return;\r\n            }\r\n\r\n            var dataRef = e.currentTarget.getAttribute(\"data-reference-tab\");\r\n            var tabChildren = $(dataRef, self);\r\n\r\n            activeTab = $(e.currentTarget);\r\n            // Changes the visibility of the contents of the tabs\r\n            self.find(\">div.childrenActive\").removeClass(\"childrenActive\");\r\n            tabChildren.addClass(\"childrenActive\");\r\n\r\n            // Add the normal width\r\n            tabHeader.find(\">div.tabSelected\").removeClass(\"tabSelected\").css(\"width\", widthRow + \"%\");\r\n\r\n            if (popUp.css(\"display\") === \"block\") {\r\n                popUp.toggle();\r\n            }\r\n\r\n            if (params.origin && params.origin === \"popUp\") {\r\n                activeTab = $(\"[data-reference-tab='\" + dataRef + \"']\", tabHeader);\r\n                reorderTabs(dataRef);\r\n            }\r\n\r\n            // Add the new width for tabSelected to complete the 100%\r\n            activeTab.addClass(\"tabSelected\").css(\"width\", widthTabSelected + \"%\");\r\n            activate(e, params);\r\n        }\r\n\r\n        if (typeof (params.domIncluded) !== \"undefined\") {\r\n            // Until the control is added to the DOM can be known widths to add the icon popup         \r\n            $.when(params.domIncluded).done(function () {\r\n                updateTabSize();\r\n            });\r\n        } else {\r\n            updateTabSize();\r\n        }\r\n\r\n        // Attach events\r\n        self.find(\".bz-wp-tabs-arrow-container\").first().bind(\"click\", function (event) {\r\n\r\n            // Determine if an item is visible or not\r\n            var headerWidth = (tabHeader.innerWidth() - 29);\r\n            var totalWidth = 0;\r\n\r\n            // Remove the visible elements\r\n            $(\".bz-container-items-tabs\", popUp).removeClass(\"show\");\r\n\r\n            tabHeader.find(\".bz-wp-tabs-ui\").each(function (i, item) {\r\n\r\n                totalWidth += $(\":first-child\", item).outerWidth();\r\n\r\n                // If \"true\" then it is a tab to display the popup\r\n                if (totalWidth > headerWidth) {\r\n\r\n                    popUp.children().each(function (j, pop) {\r\n                        if (pop.textContent === item.textContent) {\r\n                            $(pop).addClass(\"show\");\r\n                            $(\".cell.bz-container-items-tabs\").css(\"border-bottom\", \"\");\r\n                            $(\".cell.bz-container-items-tabs.show\").last().css(\"border-bottom\", \"none\");\r\n\r\n                            return;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n            popUp.toggle();\r\n        });\r\n\r\n        $(\">div.cell\", popUp).bind(\"click\", function (e) {\r\n            changeTab(e, { origin: \"popUp\" });\r\n        });\r\n\r\n        $(\".bz-wp-tabs-ui\", tabHeader).bind(\"click\", changeTab);\r\n\r\n        tabHeader.bind(\"resizeHeader\", function () {\r\n            updateTabSize();\r\n        });\r\n    };\r\n})(jQuery);","/**\r\n *\r\n * Created by RicardoPD on 8/11/2016.\r\n */\r\n\r\n(function ($) {\r\n    $.fn.helpText = function (options) {        \r\n        options = options || {};\r\n        options.helpText = options.helpText || \"\";\r\n        options.dir = typeof options.dir !== \"undefined\" && options.dir !== \"\" ? options.dir : \"inherit\";\r\n\r\n        var tmpl =\r\n            '<div class=\"bz-container-rn-helptext-overlay\">' +\r\n            '   <div class=\"bz-rn-helptext\" dir=\"#: data.dir #\">' +\r\n            '       <div class=\"bz-cancel-container\">' +\r\n            '           <a href=\"\\\\#\" style=\"opacity: 0; width: 0; height: 0\"></a>' +\r\n            '           <span class=\"bz-mo-icon bz-cancel\"></span>' +\r\n            '       </div>' +\r\n            '       <span class=\"bz-rn-helptext-text\">#= data.helpText #</span>' +\r\n            '   </div>' +\r\n            '</div>';\r\n\r\n        var template = kendo.template(tmpl, { useWithBlock: false });\r\n        var $html = $(template(options));\r\n\r\n        $(this).bind(\"click\", function () {\r\n            $(\"body\").append($html);\r\n            $(\"body\").css(\"position\", \"fixed\");\r\n            $(\"a\", $html).get(0).focus();\r\n            $(\".bz-cancel\", $html).bind(\"click\", function () {\r\n                $html.remove();\r\n                $(\"body\").css(\"position\", \"\");\r\n            });\r\n            $(\"a\", $html).bind(\"blur\", function () {\r\n                $(\".bz-cancel\", $html).click();\r\n            });\r\n            $html.addClass(\"active\");\r\n        });\r\n    };\r\n})(jQuery);","/*\r\n*   Name: BizAgi Services Rendering End Points\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\r\n\r\n// Create or define namespace\r\nbizagi.render = (typeof (bizagi.render) !== \"undefined\") ? bizagi.render : {};\r\nbizagi.render.services = (typeof (bizagi.render.services) !== \"undefined\") ? bizagi.render.services : {};\r\nbizagi.render.services.endPoints = [];\r\n\r\n// Creates a endpoint hash factory to resolve custom requirements\r\nbizagi.render.services.getEndPoints = function (params) {\r\n\r\n    var renderHandlerPathRest = \"Rest/Handlers/Render\";\r\n    var renderUploadHandlerPathRest = \"Rest/Handlers/Render/Upload\";\r\n    var renderFileHandlerPathRest = \"Rest/Handlers/RenderFile\";\r\n    var letterHandlerPathRest = \"Rest/Handlers/Letter\";\r\n    var multiActionHandlerPathRest = \"Rest/Handlers/MultiAction\";\r\n    var metadataHandlerPathRest = \"Rest/Handlers/Metadata\";\r\n    var metadataMultiactionHandlerPathRest = \"Rest/Handlers/MetadataMultiAction\";\r\n    // Default workportal end-points\r\n    if (params.context == \"workflow\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.proxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.proxyPrefix + metadataHandlerPathRest,\r\n            \"render-multiaction-metadata\": params.proxyPrefix + metadataMultiactionHandlerPathRest,\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.proxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.proxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.proxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"render-entity-layout-upload-files\": params.proxyPrefix + \"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}\",\r\n            \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\",\r\n            \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\",\r\n            \"admin-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsers\",\r\n            \"admin-getUsersList-FromPreferences\": params.proxyPrefix + \"Rest/Users/SearchUsersFromPreferences\",\r\n            \"admin-getUsersList-ForStakeholders\": params.proxyPrefix + \"Rest/Users/SearchUsersForStakeholders\",\r\n            \"admin-getUsersForAssignation\": params.proxyPrefix + \"Rest/Users/UsersForAssignation\",\r\n            \"admin-users-config\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\r\n            //users administration\r\n            \"admin-usersform\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\r\n            \"admin-sendUserEmail\": params.proxyPrefix + \"Rest/Users/SendUserEmail\"\r\n        };\r\n    }\r\n    // Sharepoint end-points (must be customized for each project)\r\n    if (params.context == \"sharepoint\" || params.context == \"portal\") {\r\n        if (typeof (params.sharepointProxyPrefix) === \"undefined\") alert(\"sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'\");\r\n        return {\r\n            \"form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.sharepointProxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.sharepointProxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.sharepointProxyPrefix + metadataHandlerPathRest,\r\n            \"render-grid-edit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": \"jquery/css/bizagi/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.sharepointProxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": \"jquery/css/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.sharepointProxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"case-handler-getCaseSummary\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/Summary\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.sharepointProxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getWorkItems\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"entitymanagement\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=entity\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"search\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=metadata\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    return {};\r\n};\r\n","/*\r\n*   Name: BizAgi Rendering Service Context Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\r\n\r\n$.Class.extend(\"bizagi.render.services.context\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        this.context = params.context;\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the given url for a specified service\r\n    */\r\n    getUrl: function (service) {\r\n        if (this.endPoints[service] == null) {\r\n            alert(\"No endpoint defined for: \" + service);\r\n        }\r\n        return this.endPoints[service];\r\n    },\r\n\r\n    setProxyPrefix: function(params){\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to rendering REST services\r\n */\r\n\r\n$.Class.extend(\"bizagi.render.services.service\",\r\n    {\r\n        // Statics\r\n        BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n        BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n        BA_PAGE_CACHE: \"pageCacheId\"\r\n    },\r\n    {\r\n        /*\r\n         *   Constructor\r\n         */\r\n        init: function(params) {\r\n            params = params || {};\r\n            params.context = params.context || \"workflow\";\r\n            params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n            this.serviceLocator = new bizagi.render.services.context(params);\r\n            this.multiactionService = new bizagi.render.services.multiactionservice(this);\r\n            this.guid = Math.guid();\r\n\r\n            if (bizagi.override.enableECMMetadataMultiaction) {\r\n                this.multiactionMetadataService = new bizagi.render.services.metadatamultiactionservice(this);\r\n            }\r\n\r\n            // Userfield definitions mini-cache\r\n            this.userfieldRequests = {};\r\n\r\n            this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone: (bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet: bizagi.deviceEnum.desktop));\r\n            this.deviceCode = bizagi.util.getDeviceCode();\r\n        },\r\n        /*\r\n         *   Return the multiaction-service\r\n         */\r\n        multiaction: function() {\r\n            return this.multiactionService;\r\n        },\r\n\r\n        metadataECMMultiaction: function () {\r\n            return bizagi.override.enableECMMetadataMultiaction ? this.multiactionMetadataService: this;\r\n        },\r\n        /*\r\n         *   SINGLE SERVICES METHODS\r\n         */\r\n\r\n        /*\r\n         *   Gets form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Check if the params contains mocked data\r\n            if (params && params.data) {\r\n                return params.data;\r\n            }\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action || \"LOADFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idProcess)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idProcess\"] = params.idProcess;\r\n            if (params.idForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            if (params.idEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idEntity\"] = params.idEntity;\r\n            if (params.surrogateKey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.requestedForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"requestedForm\"] = params.requestedForm;\r\n            if (params.recordXPath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordXPath\"] = params.recordXPath;\r\n            if (params.summaryForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"summaryForm\"] = params.summaryForm;\r\n            if (params.idCase)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            if (params.idWorkitem)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            if (params.idTask)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idTask\"] = params.idTask;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contextType)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contextType;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (!bizagi.util.isEmpty(params.isRefresh))\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isRefresh\"] = params.isRefresh;\r\n            if (params.isActionStartForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n            if (params.additionalXpaths)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            if (params.idStartScope)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            if (typeof params.readOnlyForm !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"readonlyform\"] = params.readOnlyForm;\r\n            if (typeof params.printversion !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"printForm\"] = params.printversion;\r\n            if (typeof params.recordXpath !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            if (params.guid)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guid\"] = params.guid;\r\n            if (params.downloadOfflineForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"downloadofflineform\"] = 1;\r\n\r\n            if (params.editable === false) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"DisplayFormAsReadOnly\"] = true;\r\n            }\r\n\r\n            // Support parameter from ui\r\n            // Parameters that affects all the same attributes of render\r\n            if (params.printversion) {\r\n                //Print limit grid rows\r\n                var BA_ALL_PARAMETER_PREFIX = \"all_\";\r\n\r\n                if (params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"]) {\r\n                    data[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"] = params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"];\r\n                }\r\n            }\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n\r\n            // Call ajax and returns promise\r\n            bizagi.chrono.initAndStart(\"data\");\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: params.action || \"LOAD\"\r\n            })\r\n                .pipe(function(response) {\r\n                    bizagi.chrono.stopAndLog(\"data\");\r\n\r\n                    // Transform data for read only version\r\n                    if (params.printversion) {\r\n                        try {\r\n                            response.form.properties.editable = \"False\";\r\n\r\n                            var transformGridDataToReadOnly = function(_data) {\r\n                                if (_data == null) {\r\n                                    return _data;\r\n                                }\r\n                                if (_data.hasOwnProperty('type') && _data.type == 'grid') {\r\n                                    _data.id = data.id + \"-print\";\r\n                                    _data.allowAdd = \"False\";\r\n                                    _data.allowDelete = \"False\";\r\n                                    _data.allowEdit = \"False\";\r\n                                    _data.allowGrouping = \"False\";\r\n                                    _data.allowMore = \"False\";\r\n                                    _data.allowSearch = \"False\";\r\n                                } else {\r\n                                    $.each(data, function(key, value) {\r\n                                        if (typeof (value) == 'object') {\r\n                                            _data[key] = transformGridDataToReadOnly(_data[key]);\r\n                                        }\r\n                                    });\r\n                                }\r\n                                return _data;\r\n                            };\r\n                            response = transformGridDataToReadOnly(response);\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n\r\n                    return response;\r\n                });\r\n        },\r\n        /*\r\n         *   Gets a search form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getSearchFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHFORM\";\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idSearchForm)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHFORM\"\r\n            });\r\n        },\r\n\r\n        processDataValues: function(data) {\r\n            var o;\r\n            data = $.extend(true, {}, data);\r\n            for (o in data) {\r\n                if (data.hasOwnProperty(o) && $.type(data[o]) == \"object\") {\r\n                    // for search\r\n                    if (data[o].hasOwnProperty(\"id\")) {\r\n                        data[o] = data[o].id;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Sends a form action to the server\r\n         */\r\n        submitData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            data = self.resolveData(params.data || {}, params.xpathContext);\r\n            data = self.processDataValues(data);\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action;\r\n\r\n            // Fill optional parameters\r\n            params = params || {};\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.transitions)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"transitions\"] = params.transitions;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.forcePlanCompletion)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"forcePlanCompletion\"] = params.forcePlanCompletion;\r\n\r\n            /* if (params.isActionStartForm)\r\n             data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n             */\r\n            var actionType = params.action.toString().toUpperCase();\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Data sent\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: actionType\r\n            });\r\n        },\r\n        /*\r\n         * Get data processing xpathcontext\r\n         */\r\n        resolveData: function(data, xpathContext) {\r\n            var name, newName, value;\r\n            if (!$.isEmptyObject(data) && xpathContext) {\r\n                if (xpathContext.search(/\\[id=\\d+\\]/) !== -1) {\r\n                    for (name in data) {\r\n                        if (name.search(/\\[id=\\d+\\]/) !== -1 && xpathContext == name.substr(0, name.search(/\\]/) + 1)) {\r\n                            newName = name.substr(name.search(/\\]/) + 2);\r\n                            value = data[name];\r\n                            data[newName] = value;\r\n                            delete data[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Fetch a property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   property\r\n         */\r\n        getPropertyData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n\r\n            if (params.sessionId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.guidentity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.pxpath)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpath\"] = params.pxpath;\r\n            if (params.prows)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.prows;\r\n            if (params.ppage)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.ppage;\r\n            if (params.pfilter != undefined && params.pfilter != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = params.pfilter;\r\n            /*else\r\n             data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = \"\";*/\r\n            if (params.psort != undefined && params.psort != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.psort;\r\n            if (params.porder)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.porder;\r\n            if (params.pcaseId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"caseId\"] = params.pcaseId;\r\n            if (params.pguidEntity)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidEntity\"] = params.pguidEntity;\r\n            if (params.psurrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.psurrogatedKey;\r\n            }\r\n            if (params.pactionXpath) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"actionXpath\"] = params.pactionXpath;\r\n            }\r\n            if (params.ptemplateGuid) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"templateGuid\"] = params.ptemplateGuid;\r\n            }\r\n            if (params.pparameters) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parameters\"] = params.pparameters;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         */\r\n        getData: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch search data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   term\r\n         */\r\n        getSearchData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"term\"] = params.term;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         * Refresh tha data property from the server\r\n         * Params:\r\n         *   -   collapsestate\r\n         */\r\n        getCollapseData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"collapseState\"] = params.collapseState;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"collapseState\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch grid data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   sort\r\n         *   -   page\r\n         *   -   rows\r\n         */\r\n        getGridData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.order;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        getGridDataExclusivesSelected: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathfilter\"] = params.xpathfilter;\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"exclusivesSelected\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload plugin cancel image\r\n         */\r\n        getUploadCancelImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-upload-cancel-image\");\r\n        },\r\n        /*\r\n         *   Returns the upload file url for each file\r\n         */\r\n        getUploadFileUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        getUploadFileEntityUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUETEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            if (params.isContextContainerWidgetRender) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathactions\"] = params.xpathActions;\r\n            } else {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            }\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddUrl: function() {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-add-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDFILE\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddFileUrl: function(isUserPreferences) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"form-submit-data-upload\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = (isUserPreferences === true) ? \"SAVEUSERIMAGE\" : \"savefile\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n\r\n        deleteImage: function(params) {\r\n            var self = this;\r\n\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"DELETEUSERIMAGE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing image '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        deleteUploadFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing file in upload '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n\r\n            });\r\n        },\r\n        /*\r\n         * Return file meta data\r\n         */\r\n        getECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            // Log submit data\r\n            bizagi.debug(\"Get file metadata '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        checkOutFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"checkOutFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * cancelCheckOut\r\n         **/\r\n        cancelCheckOut: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"cancelCheckOut\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        deleteECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"delete\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"delete file'\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update ECM file content\r\n         **/\r\n        updateECMFileContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMFileContent\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file content '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update file content\r\n         **/\r\n        updateECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file meta data '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getFileProperties: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getFileProperties\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Get file properties '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n        },\r\n        uploadECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"uploadECMFile\";\r\n            data.fileUpload = params.fileUpload; // Content of file\r\n            data.xPath = params.xPath;\r\n\r\n            data.idAttrib = params.idAttrib;\r\n            data.fileName = params.fileName;\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Upload ECM file '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getECMFileUrl: function(params) {\r\n            var self = this;\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"File\";\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data.action = \"viewECMFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.fileName = params.fileName;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            if (params.p_sessionId) {\r\n                data.p_sessionId = params.p_sessionId;\r\n            }\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"View uploaded file '\" + params.xPath + \"'\", data);\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n        /*\r\n         *\r\n         */\r\n        isFileOnECM: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = {};\r\n            data[\"action\"] = \"isFileOnECM\";\r\n            data[\"idUpload\"] = params.idUpload;\r\n\r\n            // Call ajax and returns promise\r\n            return $.read(self.serviceLocator.getUrl(\"render-ecm-upload-url\"), data);\r\n        },\r\n        /*\r\n         *   Start a grid record edition\r\n         */\r\n        editGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EDITRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending edit request for relation '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-edit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"EDITRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row, and sending the data at the same time\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecordData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATIONWITHDATA\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Build data to submit\r\n            var submitData = params.submitData || {};\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATIONWITHDATA\"\r\n            });\r\n        },\r\n        /*\r\n         *   Submits the grid record data to the server\r\n         */\r\n        saveGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disableServerGridValidations\"] = params.disableServerGridValidations || false;\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVERELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Deletes a grid record in the server\r\n         */\r\n        deleteGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending delete request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"REMOVERELATION\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Get association flipped status\r\n         */\r\n        getFlipAssociation: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.id;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"flipped\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"flipstate\"] = params.flipstate;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log request data\r\n            bizagi.debug(\"Sending request for flip association control '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"text\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    // Try to attempt to parse JSON\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    // If JSON is not valid we need to return the original text response\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Cancels an add or edit request for a grid\r\n         */\r\n        rollbackGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ROLLBACK\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-rollback-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ROLLBACK\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the search render default image\r\n         */\r\n        getSearchDefaultImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-search-default-image\");\r\n        },\r\n\r\n        processDataCriteria: function(criteria) {\r\n            var o;\r\n            criteria = $.extend(true, [], criteria);\r\n            for (o in criteria) {\r\n                if (criteria.hasOwnProperty(o) && criteria[o].hasOwnProperty(\"value\") && $.type(criteria[o].value) == \"object\") {\r\n                    // for search\r\n                    if (criteria[o].value.hasOwnProperty(\"id\") && criteria[o].value.hasOwnProperty(\"label\")) {\r\n                        criteria[o].value = criteria[o].value.id;\r\n                    }\r\n                }\r\n            }\r\n            return criteria;\r\n        },\r\n\r\n        /*\r\n         *   Perform entity search in the server\r\n         */\r\n        submitSearch: function(params) {\r\n            var self = this, criteria;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            var sort = params.sort && params.sort !== \"\" ? params.sort : \"\";\r\n\r\n            if (params.order && params.order !== \"\" && sort !== \"\")\r\n                sort += \" \" + params.order;\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHENTITYFORRENDER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"pageSize\"] = params.rows;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n\r\n            criteria = self.processDataCriteria(params.criteria);\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchCriteria\"] = JSON.encode(criteria);\r\n\r\n            // Optional search params\r\n            if (params.allowFullSearch)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"allowFullSearch\"] = params.allowFullSearch;\r\n            if (params.maxRecords)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxRowsAllowed\"] = params.maxRecords;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Performing advanced search\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-advanced-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHENTITYFORRENDER\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Submits the stakeholder associated\r\n         */\r\n        associateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            data[\"associatedUser\"] = params.associatedUser;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Refresh the stakeholder associated list\r\n         */\r\n        refreshAssociateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Gets the link to the letter\r\n         */\r\n        getLetterNotEditableUrl: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Call ajax and returns promise\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-letter-notEditable-url\");\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Gets the content for editable letters\r\n         */\r\n        getLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Get the can generate letter flag\r\n         */\r\n        getCanGenerateLetter: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CANGENERATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *   Saves the content for editable letters\r\n         */\r\n        saveLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"UPDATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Define content\r\n            var content = params.content || \"\";\r\n\r\n            // Define url\r\n            var url = params.url || (self.serviceLocator.getUrl(\"render-letter-save-url\"));\r\n            var fullUrl = url + \"?\" + jQuery.param(data);\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Save request for letter sent to: \" + fullUrl, content);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: fullUrl,\r\n                data: content,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the icons path for the letter plugin\r\n         */\r\n        getLetterEditorIconsPath: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-letter-content-icons\");\r\n        },\r\n        /*\r\n         *   Executes a button action in the server\r\n         */\r\n        executeButton: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"buttonRule\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Executes a fileprint action in the server\r\n         */\r\n        getFilePrintUrl: function(params) {\r\n\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n        /*\r\n         *   Saves the content of the link form\r\n         */\r\n        saveLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            //return this.saveGridRecord(params);\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVEFORMLINKRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVEFORMLINKRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Rollbacks the link form edition\r\n         */\r\n        rollbackLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.rollbackGridAction(params);\r\n        },\r\n        /*   Commit the link form edition\r\n         */\r\n        commitLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.commitGridAction(params);\r\n        },\r\n        /*   Sends schekpoint action\r\n         */\r\n        sendCheckpoint: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.sendCheckpointAction(params);\r\n        },\r\n        /*\r\n         *   Loads the userfield definition\r\n         */\r\n        getUserfieldDefinition: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Check in deferreds cache\r\n            if (self.userfieldRequests[params.userfield])\r\n                return self.userfieldRequests[params.userfield];\r\n\r\n            // Required params: idCase\r\n            self.userfieldRequests[params.userfield] = $.read(self.serviceLocator.getUrl(\"render-userfield-definition\"),\r\n                {\r\n                    guidUserfield: params.userfield,\r\n                    device: (params.device || \"desktop\")\r\n                }\r\n            );\r\n\r\n            // Return deferred\r\n            return self.userfieldRequests[params.userfield];\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshControl: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESH\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"PARTIALREFRESH\"\r\n            });\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshGridCell: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESHGRIDCELL\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidcolumn\"] = params.column;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n            (params.typeRender) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"typeRender\"] = params.typeRender : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Request to execute rule on server\r\n         * @param {object} params h_pageCacheId, guidrule\r\n         */\r\n        executeRule: function(params) {\r\n            var self = this;\r\n\r\n\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTERULE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidrule\"] = params.rule || \"\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute interface on server\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeInterface: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEINTERFACE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidinterface\"] = params.interface || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute SAP Connecor\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeSAPConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTESAP\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidsap\"] = params.guidsap || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute a Bizagi connector\r\n         * @param params\r\n         * @return {{}}\r\n         */\r\n        executeConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTECONNECTOR\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidConnector\"] = params.guidConnector || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        generateDocumentTemplate: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            params.append = params.append ? params.append : false;\r\n\r\n            return $.create(\r\n                self.serviceLocator.getUrl(\"render-document-generate\"),\r\n                {\r\n                    h_pageCacheId: params.idPageCache,\r\n                    contextXpath: params.xpathcontext,\r\n                    groupMappingId: params.groupMapping,\r\n                    xpathAttribute: params.xpath,\r\n                    append: params.append,\r\n                    controlId: params.id\r\n                }\r\n            );\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        getAllDocumentsDownloadUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-document-generateAllDocuments\");\r\n            var data = {};\r\n            data[\"h_pageCacheId\"] = params.idPageCache;\r\n            data[\"contextXpath\"] = params.xpathContext;\r\n            data[\"xpathAttribute\"] = params.xpath;\r\n            data[\"idCase\"] = params.idCase;\r\n            data[\"idWorkItem\"] = params.idWorkItem;\r\n            data[\"p_sessionId\"] = params.sessionId;\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        },\r\n\r\n\r\n        getCaseNumber: function(params) {\r\n            var self = this;\r\n            //this function use sendEMail\r\n            //and not possible use dat ain ajax\r\n            //this is workaround (rhonyp)\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getCaseSummary\").replace(\"{idCase}\", params.idCase) + \"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice=\" + bizagi.isMobile(),\r\n                type: \"GET\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        getCaseAssignees: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Required params: idCase\r\n            return $.read(\r\n                self.serviceLocator.getUrl(\"case-handler-getCaseAssignees\"), {\r\n                    idCase: params.idCase\r\n                }\r\n            ).pipe(function(response) {\r\n                    return response;\r\n                });\r\n        },\r\n\r\n        getWorkitems: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"case-handler-getWorkItems\"), {\r\n                idCase: params.idCase,\r\n                onlyUserWorkItems: params.onlyUserWorkItems || \"\"\r\n            });\r\n        },\r\n        /*\r\n         *   Executes a grid export action in the server\r\n         */\r\n        getGridExportUrl: function(params) {\r\n\r\n            var self = this,\r\n                url = this.serviceLocator.getUrl(\"render-upload-data-url\"),\r\n                data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.exportType; //\"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         * Executes a send email action in the server\r\n         */\r\n        sendEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"sendEmail\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n\r\n            // Email parameters\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"to\"] = params.to;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"subject\"] = params.subject;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"message\"] = params.message;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"selected\"] = JSON.encode(params.selected);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            var url = params.url || self.serviceLocator.getUrl(\"form-get-data\");\r\n\r\n            return $.create(url, data);\r\n        },\r\n\r\n        /*\r\n         * Request to invalidates page cache in server, since it is no needed anymore\r\n         */\r\n        invalidatePageCache: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"INVALIDATEPAGECACHE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"INVALIDATEPAGECACHE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersList: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersList\"), params);\r\n        },\r\n        /*\r\n         * Search users for preferences usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListFromPreferences: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-FromPreferences\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users for Stakeholders\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListForStakeholders: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForStakeholders\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersForAssignation: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersForAssignation\"), params);\r\n        },\r\n\r\n        /**\r\n         * Get Users Creation/Edition Form\r\n         */\r\n        getUsersForm: function(params) {\r\n            var self = this;\r\n            return $.create(self.serviceLocator.getUrl(\"admin-usersform\"), params);\r\n        },\r\n        /**\r\n         *   Return generate Data To Send By Email\r\n         */\r\n        generateDataToSendByEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"GenerateDataToSendByEmail\",\r\n                idUser: params.idUser,\r\n                password: params.password\r\n            };\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-GenerateDataToSendByEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Return generate Send user password Mail\r\n         */\r\n        sendUserEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"SendUserEmail\",\r\n                emailTo: params.eMailTo,\r\n                subject: params.subject,\r\n                body: params.body\r\n            };\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-sendUserEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get bizagi configuration\r\n         * @param {Function}   type callback function when the file load is succed\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getConfiguration: function() {\r\n            var self = this;\r\n            var url = self.serviceLocator.getUrl(\"admin-users-config\");\r\n\r\n            return $.read(url);\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyPathToBase: function(pathToBase, url) {\r\n\r\n            if (url.indexOf(\"http\") != -1 && pathToBase != \"\") {\r\n                return url;\r\n            } else {\r\n                return pathToBase + url;\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * Get template of entity\r\n         * @param params { guid, prepare}\r\n         */\r\n        getTemplate: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADTEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = \"entity\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guid;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isProcessData\"] = params.forcePersonalizedColumns;\r\n\r\n            if (params.templateType) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templatetype\"] = params.templateType;\r\n            }\r\n\r\n            if (params.templateGuid) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templateguid\"] = params.templateGuid;\r\n            }\r\n\r\n            if (params.isDefaultTemplate != undefined) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isDefaultTemplate\"] = params.isDefaultTemplate;\r\n            }\r\n\r\n            // Fix device type since on mobility there are tablet_ios, tablet_android, smartphone_ios, smartphone_ios\r\n            // and the service recives either tablet or smartphone\r\n            var deviceType = bizagi.util.detectDevice();\r\n            if (bizagi.util.isTabletDevice()) {\r\n                deviceType = \"tablet\";\r\n            } else if (bizagi.util.isSmartphoneDevice()) {\r\n                deviceType = \"mobile\";\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = deviceType;\r\n\r\n            // When prepare is true just return data, this feature is used by multiaction service\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-get-data\"), data);\r\n        },\r\n\r\n        /**\r\n         * Chek if an entity has startform\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        hasStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            if (params.guidWFClass) {\r\n                data.guidWFClass = params.guidWFClass;\r\n            }\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"render-processes-startform\"), data);\r\n        },\r\n\r\n        /**\r\n         * Get the start form of the case\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADSTARTFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidprocess\"] = params.guidprocess;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = true;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idCase) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            }\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idWorkitem) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            }\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n            if (params.surrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.surrogatedKey;\r\n            }\r\n            if (params.recordXpath) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            }\r\n            if (params.mappingstakeholders) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"mappingstakeholders\"] = params.mappingstakeholders;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                cache: true\r\n            });\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editActionForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.pmaxitems) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxitems\"] = params.pmaxitems;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Execute actions or constructors\r\n         * @param params\r\n         */\r\n        executeActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend({}, params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.pguidConstructor) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidConstructor\"] = params.pguidConstructor;\r\n            }\r\n\r\n            if (params.pguidAction) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidAction\"] = params.pguidAction;\r\n            }\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getPolymorphicActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Make a JSON tree of polymorphic constructors categories\r\n         * @param values\r\n         * @return {Array}\r\n         */\r\n        serializePolymorphicActions: function(values) {\r\n            // json serializer\r\n            var actions = [];\r\n            var GUID_ENTITY = 0, DISPLAY_NAME = 1, XPATHCONTEXT = 2, TYPE = 3, GUID_OBJECT = 4, GUID_CONSTRUCTOR = 5, GUID_PARENT_ENTITY = 6;\r\n\r\n            /**\r\n             * Get children by guid of entity\r\n             * @param guid\r\n             * @return {Array}\r\n             */\r\n            var getChildren = function(guid) {\r\n                var children = [];\r\n                guid = guid || \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_PARENT_ENTITY] == guid) {\r\n                        children.push(value);\r\n                    }\r\n                });\r\n                return children;\r\n            };\r\n\r\n            /**\r\n             * Get parents by action object\r\n             * @param node\r\n             * @return {string}\r\n             */\r\n            var getParents = function(node) {\r\n                node = node || {};\r\n                var parents = \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_ENTITY] == node[GUID_PARENT_ENTITY]) {\r\n                        parents += getParents(value) + value[DISPLAY_NAME] + \" > \";\r\n                    }\r\n                });\r\n                return parents;\r\n            };\r\n\r\n\r\n            /**\r\n             * Make a tree of actions\r\n             * @param list\r\n             * @param guid\r\n             * @return {*}\r\n             */\r\n            var fillTree = function(list, guid) {\r\n                var node;\r\n                var children = getChildren(guid);\r\n                $.each(children, function(key, value) {\r\n                    var child = fillTree([], value[GUID_ENTITY]);\r\n                    node = {\r\n                        \"guidEntity\": value[GUID_ENTITY],\r\n                        \"displayName\": value[DISPLAY_NAME],\r\n                        \"hasConstructor\": (value[GUID_CONSTRUCTOR]) ? true : false,\r\n                        \"type\": value[TYPE],\r\n                        \"guidObject\": value[GUID_OBJECT],\r\n                        \"guidConstructor\": value[GUID_CONSTRUCTOR],\r\n                        \"xpathContext\": value[XPATHCONTEXT],\r\n                        \"children\": child,\r\n                        \"parents\": getParents(value)\r\n                    };\r\n                    if (node.guidConstructor !== \"\" || node.children.length > 0) {\r\n                        list.push(node);\r\n                    }\r\n                });\r\n\r\n                return list;\r\n            };\r\n            fillTree(actions, \"\");\r\n            return actions;\r\n        },\r\n\r\n        /**\r\n         * Gets the image for an entity xpath\r\n         * @param params\r\n         */\r\n        getEntityImage64: function(params) {\r\n            var self = this,\r\n                data = {\r\n                    width: params.data,\r\n                    height: params.height,\r\n                    xpath: params.xpath\r\n                },\r\n                url = self.serviceLocator.getUrl(\"render-entity-layout-image64\").replace(\"{entity}\", params.entity).replace(\"{surrogateKey}\", params.surrogateKey);\r\n\r\n            return $.ajax({\r\n                url: url,\r\n                data: data\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get data files when user access from my stuff, because there is no scope\r\n         */\r\n        getFilesDataForLayoutUploadControl: function(params) {\r\n            var self = this;\r\n            return $.read(self.serviceLocator.getUrl(\"render-entity-layout-upload-files\"), params);\r\n        },\r\n\r\n        /**\r\n         * Process an upload file into the server\r\n         * @param {} params\r\n         * @returns {}\r\n         */\r\n        processUploadFile: function(params) {                \r\n            return $.ajax({\r\n                url: this.verifyMobilePathToBase(bizagi.services.ajax.pathToBase || \"\", params.url),\r\n                data: params.formData,\r\n                type: \"POST\",\r\n                contentType: false,\r\n                processData: false\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Commit an add or edit request for a grid\r\n         * @param params\r\n         * @returns {*}\r\n         */\r\n        commitGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"COMMIT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-commit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"COMMIT\"\r\n            });\r\n        },\r\n        /*\r\n         *   Commit an add or edit request for a grid\r\n         */\r\n        sendCheckpointAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CHECKPOINT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending checkpoint request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-checkpoint-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"CHECKPOINT\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyMobilePathToBase: function(pathToBase, url) {\r\n            return bizagi.util.isSharepointContext() ? (url || \"\").replaceAll(pathToBase, \"\"): url;                \r\n        }\r\n\r\n    });\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\n$.Class.extend(\"bizagi.render.services.multiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (service) {\r\n        this.service = service;\r\n        this.serviceLocator = service.serviceLocator;\r\n\r\n        // Multiaction - batch stuff\r\n        this.batch = {};\r\n        this.batchTimer = 50;\r\n        this.circularDependencies = new bizagi.circularDependencies();\r\n\r\n        // Create proxyed version of methods\r\n        this.replicateServiceMethods();\r\n    },\r\n\r\n    /*\r\n    *   Returns the internal service\r\n    */\r\n    getService: function () {\r\n        return this.service;\r\n    },\r\n\r\n    /*\r\n    *   Create a proxied multiaction version for service calls\r\n    */\r\n    replicateServiceMethods: function () {\r\n        var self = this;\r\n        for (var key in this.service.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"multiaction\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ return this.proxyMethod(this.getService().' + key + ', arguments);};tmp');\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Perform the proxy call for each service method\r\n    */\r\n    proxyMethod: function (method, arguments) {\r\n        var service = this.service;\r\n\r\n        // Check if has only one argument, else execute directly\r\n        if (!arguments || arguments.length != 1) {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        // Check if the argument is object, else execute directly\r\n        if (typeof (arguments[0]) != \"object\") {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        var params = arguments[0];\r\n\r\n        // If the caller is requesting a prepare call, just execute the method with the current arguments\r\n        if (params.prepare == true) return method.apply(service, arguments);\r\n\r\n        // Prepare the ajax instead of sending it\r\n        params.prepare = true;\r\n        var action = method.apply(service, arguments);\r\n\r\n        return this.add(action);\r\n    },\r\n\r\n    /**\r\n    * This method make a standard error message\r\n    */\r\n    makeCircularDependenciesError: function (error) {\r\n        var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n        return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Add an action to be performed in a multiaction, and be resolved later\r\n    *   returns a deferred\r\n    */\r\n    add: function (action) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        var name = action.h_action || \"unnamed\";\r\n\r\n        // Put here all actions to ignore in circular dependencies\r\n        var exceptionActions = [\"PROCESSPROPERTYVALUE\", \"LOADTEMPLATE\", \"ADDRELATIONWITHDATA\"];\r\n\r\n        if (exceptionActions.indexOf(name) < 0 && bizagi.override.detectCircularDependencies) {\r\n            self.circularDependencies.addNode(name, action);\r\n        }\r\n\r\n        // First clear previous timeout\r\n        clearTimeout(self.batchTimeout);\r\n        var tag = action.tag = Math.guid();\r\n        var singleAction = { action: action, deferred: deferred };\r\n        self.batch[tag] = singleAction;\r\n\r\n        // Start a new timeout\r\n        self.batchTimeout = setTimeout(function () {\r\n            var resolveDependencies = self.circularDependencies.resolve();\r\n\r\n            if (resolveDependencies.error) {\r\n                // Reset Queue\r\n                for (var i in self.batch) {\r\n                    var message = resolveDependencies.error.multiactionError;\r\n                    self.batch[i].deferred.reject(message);\r\n                }\r\n                self.batch = {};\r\n            } else {\r\n                self.fire();\r\n            }\r\n        }, self.batchTimer);\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Fires up the multiaction\r\n    */\r\n    fire: function () {\r\n        var self = this;\r\n        var batch = {};\r\n\r\n        // Prepare actions and clone batch manually\r\n        var actions = [];\r\n        $.each(self.batch, function (tag, item) {\r\n            actions.push(item.action);\r\n            batch[tag] = item;\r\n        });\r\n\r\n        // Reset batch\r\n        self.batch = {};\r\n\r\n        // Fire ajax \r\n        $.when(self.execute({ actions: actions, rejectDeferreds: false }))\r\n                .done(function (responses) {\r\n\r\n                    // Process each response\r\n                    $.each(responses, function (i, response) {\r\n                        var tag = response.tag;\r\n                        if (!response.error) {\r\n                            batch[tag].deferred.resolve(response.result);\r\n                        } else {\r\n                            batch[tag].deferred.reject(response.error, response, response.error.message);\r\n                        }\r\n\r\n                        // Remove paired tag from collection\r\n                        delete batch[tag];\r\n                    });\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: \"Operation didn't executed\" }, '', \"Operation didn't executed\");\r\n                    });\r\n                }).fail(function (xhr, type, error) {\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    var errorMessage = typeof (error) !== \"undefined\" ? error.message : (error || \"Operation didn't executed\");\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: errorMessage }, '', \"Operation didn't executed\");\r\n                    });\r\n                });\r\n    },\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Einer Perez\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\nbizagi.render.services.multiactionservice.extend(\"bizagi.render.services.metadatamultiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"h_pageCacheId\"\r\n}, {\r\n\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            if (action[self.Class.BA_PAGE_CACHE]) {\r\n                data[self.Class.BA_PAGE_CACHE] = action[self.Class.BA_PAGE_CACHE];\r\n            }\r\n            delete action[self.Class.BA_PAGE_CACHE];\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action metadata\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction-metadata\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Command controller \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for action and validation controllers\r\n */\r\n\r\n$.Class.extend(\"bizagi.command.controllers.controller\", {\r\n    /* \r\n    *   Set to true in order to debug\r\n    */\r\n    THROW_ERROR: true\r\n\r\n}, {\r\n    /*  \r\n    *   Constructor\r\n    */ \r\n    init: function (form) {\r\n        this.form = form;\r\n        this.dateFormat = form.getResource(\"dateFormat\");\r\n    },\r\n    /*\r\n    *   Returns the condition in JS\r\n    */\r\n    buildConditions: function (conditions, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var operator = conditions.expressions && conditions.expressions.length > 1 ? self.buildConditionOperator(conditions.operator) : conditions.operator;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        //  Validate trtue and false conditions\r\n        if (operator == \"true\")\r\n            return \"true\";\r\n        if (operator == \"false\")\r\n            return \"false\";\r\n\r\n        var sJsCondition = \"\";\r\n\r\n        for (var i = 0; i < conditions.expressions.length; i++) {\r\n            var expression = conditions.expressions[i];\r\n\r\n            if (expression.simple) {\r\n                var bGDetected = self.searchGridReferenceInCondition(expression.simple);\r\n                sJsCondition += self.buildSimpleCondition(expression.simple, bGDetected, bCheckEditability);\r\n\r\n            } else if (expression.complex) {\r\n                sJsCondition += \"(\" + self.buildConditions(expression.complex, bGridDetected, bCheckEditability) + \") \";\r\n            }\r\n\r\n            // Adds operator\r\n            sJsCondition += (i < conditions.expressions.length - 1 ? operator : \"\");\r\n        }\r\n\r\n        return sJsCondition;\r\n    },\r\n    /*\r\n    *   Builds the condition operator\r\n    */\r\n    buildConditionOperator: function (conditionsOperator) {\r\n        if (conditionsOperator == \"and\")\r\n            return \" && \";\r\n        if (conditionsOperator == \"or\")\r\n            return \" || \";\r\n        return conditionsOperator;\r\n    },\r\n    /*\r\n    *   Builds a simple condition\r\n    */\r\n    buildSimpleCondition: function (condition, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var sXpath;\r\n        var xpath;\r\n        var sArgument = \"\";\r\n        var operator = condition.operator;\r\n        var ensureValueJs = \"\";\r\n        var ensureEditable = \"\";\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        // List of controls excluded to editability validation\r\n        // Just keep empty the value of element\r\n        var excludeEditabilityRule = { \"boolean\": \"\" };\r\n        var control = condition.xpath || condition.renderId;\r\n\r\n        var detectedArgumentType = self.detectConditionArgumentType(control, condition.argumentType);\r\n\r\n        // Build xpath\r\n        sXpath = self.buildXpath(control, detectedArgumentType, bGridDetected);\r\n        if (detectedArgumentType != \"boolean\") {\r\n            ensureValueJs += \"!bizagi.util.isEmpty(\" + sXpath + \") && \";\r\n        }\r\n\r\n        // Check if the render is editable, only when the parameter is provided\r\n        if (bCheckEditability && control && control.length > 0 && !excludeEditabilityRule.hasOwnProperty(detectedArgumentType)) {\r\n            ensureEditable = \"self.isVisible('\" + control + \"') && self.isEditable('\" + control + \"') && \";\r\n        }\r\n\r\n        // Build argument\r\n        if (!bizagi.util.isEmpty(condition.argument)) {\r\n            sArgument = self.buildArgument(condition.argument, detectedArgumentType, bGridDetected);\r\n\r\n            // If the argument is xpath it must be filled to for some operators\r\n            if (detectedArgumentType == \"xpath\") {\r\n                ensureValueJs += \"!bizagi.util.isEmpty(\" + sArgument + \") && \";\r\n            }\r\n\r\n        } else if (condition.argument === \"\") {\r\n            // Also check the case when the argument is empty\r\n            sArgument = \"\\\"\\\"\";\r\n        }\r\n\r\n        // Build condition\r\n\r\n        if (operator == \"includes\") {\r\n            return ensureEditable + ensureValueJs + \"self.includes(\" + sXpath + \",\" + sArgument + \") \";\r\n        }\r\n        //if (operator == \"changes\") return \"true\";\r\n        if (operator == \"changes\") {\r\n            return \"self.isChanged(\" + sXpath + \", params.changed)\";\r\n        }\r\n        if (operator == \"equals\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" == \" + sArgument;\r\n        if (operator == \"not-equals\")\r\n            return ensureEditable + sXpath + \" != \" + sArgument;\r\n        if (operator == \"less-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" < \" + sArgument;\r\n        if (operator == \"less-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" <= \" + sArgument;\r\n        if (operator == \"greater-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" > \" + sArgument;\r\n        if (operator == \"greater-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" >= \" + sArgument;\r\n        if (operator == \"like\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"is-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" == 0 || bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-not-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"!bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" != 0 && !bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-true\")\r\n            return ensureEditable + \"( \" + sXpath + \" == true || \" + sXpath + \" == 'true' )\";\r\n        if (operator == \"is-false\")\r\n            return ensureEditable + \"( \" + sXpath + \" == false || \" + sXpath + \" == 'false' || \" + sXpath + \" == 'False' )\";\r\n        if (operator == \"does-not-contain\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") < 0 \";\r\n        if (operator == \"contains\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == true \";\r\n        if (operator == \"does-not-begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == false \";\r\n        if (operator == \"file-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"file-not-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"!self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"is-invalid-email\")\r\n            return ensureEditable + \"!self.isValidEmail(\" + sXpath + \") \";\r\n        if (operator == \"letter-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"letter-not-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"cell-change\")\r\n            return \"column == \" + sArgument;\r\n\r\n        if (operator == \"on-press\") {\r\n            if (bGridDetected) {\r\n                var id = self.buildXpath(control, \"id\", bGridDetected);\r\n                return \"self.isGridButtonPressed(\" + id + \", params.pressed)\";\r\n            } else {\r\n                return \"self.isButtonPressed('\" + control + \"', params.pressed)\";\r\n            }\r\n        }\r\n\r\n        // ondelete behavior on grid control  \r\n        if (operator == 'on-deleted-row') {\r\n            xpath = control || \"\";\r\n            return \"self.onDeletedGridRow('\" + xpath + \"', params.rowDeleted)\";\r\n        }\r\n\r\n        // If there is another operator code throw exception\r\n        throw new \"There is no implementation for operator code \" + operator;\r\n    },\r\n    /*\r\n    *   Detects the argument type based on the render\r\n    */\r\n    detectConditionArgumentType: function (control, argumentType) {\r\n        var self = this;\r\n\r\n        if (argumentType === undefined || argumentType == \"const\") {\r\n\r\n            // Search render\r\n            var form = self.form;\r\n            var render = form.getRender(control) || form.getRenderById(control);\r\n\r\n            // Check if exists the render\r\n            if (render == null) {\r\n                throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n            }\r\n\r\n            // Check if the render is a grid\r\n            if (render.properties.type == \"grid\") {\r\n                var gridXpath = self.processGridXpath(control);\r\n\r\n                if (gridXpath.remainingXpath === \"\") {\r\n                    // The target is the grid\r\n                    return \"xpath\";\r\n                } else {\r\n                    render = render.getColumn(gridXpath.remainingXpath);\r\n                    if (render == null) {\r\n                        throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n                    }\r\n                }\r\n            }\r\n\r\n            var dataType = render.properties.dataType;\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n\r\n            if (self.isRelatedEntityRender(renderType)) {\r\n                return 'entity';\r\n            }\r\n\r\n            // Number\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 6 || dataType == 7 || dataType == 10 || dataType == 11) {\r\n                return 'number';\r\n            }\r\n\r\n            // Money\r\n            if (dataType == 8) {\r\n                return 'money';\r\n            }\r\n\r\n            // Date\r\n            if (dataType == 12 || dataType == 13) {\r\n                if (render.properties.showTime == true) {\r\n                    return 'datetime';\r\n                } else {\r\n                    return 'date';\r\n                }\r\n            }\r\n\r\n            // Boolean\r\n            if (dataType == 5) {\r\n                return 'boolean';\r\n            }\r\n\r\n            // Button\r\n            if (renderType == \"button\") {\r\n                return \"button\";\r\n            }\r\n\r\n            // Default\r\n            return 'text';\r\n\r\n        } else if (argumentType == \"xpath\" || argumentType == \"function\" || argumentType == \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        // Default return text\r\n        return 'text';\r\n    },\r\n    /*\r\n    *   Detects if a render type must be binded to a xpath with related entity\r\n    */\r\n    isRelatedEntityRender: function (renderType) {\r\n        return [\"combo\", \"list\", \"radio\", \"search\", \"searchCombo\", \"columnCombo\"].includes(renderType) || /^cascadingcombo$/i.test(renderType);\r\n    },\r\n\r\n    buildXpath: function (xpath, argumentType, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if (argumentType == 'xpath' && !bGridDetected) {\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + self.detectConditionArgumentType(xpath, \"const\") + \"')\";\r\n        } else if (argumentType == 'id') {\r\n            return \"'\" + xpath + \"'\";\r\n        } else if (argumentType == 'function') {\r\n            var xpathArgumentType = self.detectConditionArgumentType(xpath, \"const\");\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + xpathArgumentType + \"')\";\r\n        } else if (bGridDetected){\r\n            return \"self.evalGridXpath(params, '\" + xpath + \"', '\" + argumentType + \"')\";      \r\n        }\r\n\r\n        return \"self.evalXpath('\" + xpath + \"', '\" + argumentType + \"')\";\r\n    },\r\n    buildArgument: function (argument, argumentType, bGridDetected, xpathContext) {\r\n        var self = this;\r\n        var number;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        if (argumentType == 'text') {\r\n            // Text\r\n            argument = (argument == null) ? \"\" : argument;\r\n            argument = (typeof argument != 'string') ? argument.toString() : argument;\r\n            if (argument.indexOf(\"'\") != -1)\r\n                argument = argument.replaceAll(\"'\", \"\\\\'\");\r\n\r\n            // Remove line breaks because they will fail with the eval command\r\n            if (argument.indexOf(\"\\n\") != -1)\r\n                argument = argument.replaceAll(\"\\n\", \"\");\r\n\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'boolean') {\r\n            // Boolean\r\n            if (typeof (argument) == \"string\") {\r\n                return (eval(argument.toLowerCase()) == true ? \"true\" : \"false\");\r\n            } else {\r\n                return (eval(argument) == true ? \"true\" : \"false\");\r\n            }\r\n        }\r\n        if (argumentType == 'number') {\r\n            // Number\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'money') {\r\n            // MONEY\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'date') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument);\r\n            if (!date || date == 0)\r\n                date = new Date(0);\r\n\r\n            // Remove time\r\n            date.setHours(0, 0, 0, 0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date) + \"').getTime()\";\r\n        }\r\n        if (argumentType == 'datetime') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument, true);\r\n            if (!date || date == 0) {\r\n                date = new Date(0);\r\n            }\r\n            \r\n            date.setSeconds(0);\r\n            date.setMilliseconds(0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date, true) + \"', true).getTime()\";\r\n        }\r\n        if (argumentType == 'color') {\r\n            // Color\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'entity') {\r\n\r\n            if (bizagi.util.isEmpty(argument)) {\r\n                return null;\r\n            }\r\n            try {\r\n                argument = typeof (argument) != \"object\" ? JSON.parse(argument) : argument;\r\n            } catch (e) {\r\n                argument = argument || {};\r\n            }\r\n\r\n\r\n            // Entity value\r\n            var result = argument.id || argument;\r\n            return JSON.stringify(result);\r\n        }\r\n        if (argumentType == 'xpath') {\r\n            // Xpath value\r\n            var xpath = argument.toString();\r\n\r\n            // Process grid xpaths\r\n            if (bGridDetected) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n\r\n            if (xpathContext) {\r\n                xpath = xpathContext + \".\" + xpath;\r\n            }\r\n\r\n            return self.buildXpath(xpath, argumentType, bGridDetected);\r\n        }\r\n        if (argumentType == 'json') {\r\n            // Xpath value\r\n            return JSON.encode(argument);\r\n        }\r\n        if (argumentType == 'function') {\r\n            if (argument == \"BANow\") {\r\n                return \"self.getCurrentDate()\";\r\n            }\r\n            // If there is another function type code throw exception\r\n            throw \"There is no implementation for function \" + argument;\r\n        }\r\n\r\n        if (argumentType == undefined) {\r\n            return null;\r\n        }\r\n\r\n        // If there is another argument type code throw exception\r\n        throw \"There is no implementation for argument type \" + argumentType;\r\n    },\r\n    /*\r\n    *   Evals if an xpath is editable\r\n    */\r\n    isEditable: function (xpath) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return render.properties.editable;\r\n    },\r\n\r\n    isVisible: function (xpath) {\r\n        var self = this;\r\n\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (render.properties.visible) {\r\n            return self.isParentVisible(render.parent);\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n            if (/^hidden$/i.test(renderType)) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    isParentVisible: function (render) {\r\n        var self = this;\r\n        if (render.parent) {\r\n            if (render.properties.visible) {\r\n                return self.isParentVisible(render.parent);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else {\r\n            return render.properties.visible;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalGridXpath: function(params, xpath, argumentType) {\r\n        var self = this;\r\n        \r\n        if (params === undefined){\r\n            return this.evalXpath(xpath, argumentType);\r\n        }\r\n\r\n        var grid = params.grid;\r\n\r\n        if (grid === undefined || grid === null){\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;    \r\n        }\r\n\r\n        // Grid renders\r\n        var gridXpath = self.processGridXpath(xpath);\r\n\r\n        // Return the value\r\n        var gridColumn = grid.getColumn(gridXpath.remainingXpath);\r\n\r\n        if (!gridColumn) {\r\n            return false;\r\n            //throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n        var cellValue = grid.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n        if (gridColumn.properties.type == \"columnRadio\") {\r\n            if (cellValue) {\r\n                if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                    cellValue = cellValue[0][0];\r\n                else\r\n                    cellValue = cellValue.id;\r\n            }\r\n            else\r\n                cellValue = 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnCombo\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnSearch\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        // Parse empty values\r\n        if (bizagi.util.isEmpty(cellValue)) {\r\n            // If the render is a boolean return false for actions\r\n            if (argumentType == \"boolean\") {\r\n                if (gridColumn.properties.display == \"check\") {\r\n                    return false;\r\n                } else {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Parse boolean and non-empty date types\r\n        if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n            return eval(self.buildArgument(cellValue, argumentType));\r\n        }\r\n\r\n        if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n            cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n        return cellValue;\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalXpath: function (xpath, argumentType) {\r\n        var self = this, i, renderToEval;\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length === 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        i = 0;\r\n        while (i < rendersToEval.length) {\r\n            renderToEval = rendersToEval[i++];\r\n            var bIsGrid = (renderToEval.properties.type == 'grid');\r\n            if (!bIsGrid) {\r\n                // Normal renders\r\n                var value = renderToEval.getValue();\r\n                var renderType = bizagi.util.normalizeType(renderToEval.properties.type || \"\");\r\n\r\n                if (argumentType === undefined || argumentType === \"undefined\") {\r\n                    return value;\r\n                }\r\n\r\n                // If the render is a combo and the value is null return 0 for validations and actions\r\n                if ([\"combo\", \"list\", \"search\", \"radio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n                    if (bizagi.util.isEmpty(value) || value.id == \"\") {\r\n                        value = 0;\r\n                    }\r\n                }\r\n\r\n                if (renderType === \"comboSelected\") {\r\n                    return (typeof value === \"string\") ? JSON.parse(value).value : value;\r\n                }\r\n\r\n                if (bizagi.util.isEmpty(value)) {\r\n                    // If the render is a check and the value is null return false for validations and actions\r\n                    if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                        return false;\r\n                    }\r\n\r\n                    if (bizagi.util.isEmpty(value)) {\r\n                        // If the render is a check and the value is null return false for validations and actions\r\n                        if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                            return false;\r\n                        }\r\n                    }\r\n\r\n                    return value;\r\n                }\r\n\r\n                if (argumentType === \"xpath\") {\r\n                    return eval(self.buildArgument(xpath, argumentType));\r\n                } else {\r\n                    return eval(self.buildArgument(value, argumentType));\r\n                }                \r\n            } else {\r\n\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n\r\n                // Return the value\r\n                var gridColumn = renderToEval.getColumn(gridXpath.remainingXpath);\r\n\r\n                if (!gridColumn) {\r\n                    continue;\r\n                }\r\n\r\n                var cellValue = renderToEval.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n                if (gridColumn.properties.type == \"columnRadio\") {\r\n                    if (cellValue) {\r\n                        if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                            cellValue = cellValue[0][0];\r\n                        else\r\n                            cellValue = cellValue.id;\r\n                    }\r\n                    else\r\n                        cellValue = 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnCombo\") {\r\n                    cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnSearch\") {\r\n                    cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n                }\r\n\r\n                // Parse empty values\r\n                if (bizagi.util.isEmpty(cellValue)) {\r\n                    // If the render is a boolean return false for actions\r\n                    if (argumentType == \"boolean\") {\r\n                        if (gridColumn.properties.display == \"check\") {\r\n                            return false;\r\n                        } else {\r\n                            return null;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Parse boolean and non-empty date types\r\n                if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n                    return eval(self.buildArgument(cellValue, argumentType));\r\n                }\r\n\r\n                if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n                    cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n                return cellValue;\r\n            }\r\n\r\n            throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Check if the upload render has any files uploaded\r\n    */\r\n    isFileUploaded: function (xpath) {\r\n        var self = this;\r\n\r\n        var value = self.evalXpath(xpath);\r\n\r\n        if (value && value.length) {\r\n            if (value.length > 0)\r\n                return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *   Check if a render has a valid email value\r\n    */\r\n    isValidEmail: function (value) {\r\n        var regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/gi;\r\n        if (value && value.match(new RegExp(regex))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var render = this.getRenderById(control);\r\n        var renderType = bizagi.util.normalizeType(render.properties.type);\r\n        if (render === null || !/^button$/i.test(renderType)) return false;\r\n\r\n        return pressed;\r\n    },\r\n    /*\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isGridButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var arrGridXpath = this.processGridXpath(control);\r\n        var gridXpath = arrGridXpath.gridXpath;\r\n        var render = this.getRender(gridXpath);\r\n        var column = arrGridXpath.remainingXpath || \"\";\r\n\r\n\r\n        if (pressed && render && render.columns) {\r\n            $.each(render.columns, function (key, value) {\r\n                if ((value.properties.xpath === column || value.properties.id === column) && value.properties.type === \"columnButton\") {\r\n                    pressed = true;\r\n                }\r\n            });\r\n        }\r\n        return pressed;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has been changed\r\n    */\r\n    isChanged: function (value, isChanged) {\r\n        if (value === undefined || value === null) {\r\n            return false;\r\n        }\r\n        return isChanged;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has the item\r\n    */\r\n    includes: function (value, argument) {\r\n        if (typeof value == \"undefined\" || value === null) {\r\n            return false;\r\n        }\r\n        if (typeof argument == \"undefined\" || argument === null) {\r\n            return false;\r\n        }\r\n        var inArray = $.grep(value, function (e) {\r\n            return e.id == argument;\r\n        });\r\n        if (inArray.length > 0) {\r\n            return true;\r\n        }\r\n        return false\r\n    },\r\n\r\n    /**\r\n    *  Check if the grid has been deleted a row\r\n    */\r\n    onDeletedGridRow: function (xpath, rowDeleted) {\r\n        var self = this;\r\n        var grid = self.getRender(xpath) || {};\r\n\r\n        if (grid && rowDeleted) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Wrapper for get renders, return null if no renders have been found\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this,\r\n            form = self.form,\r\n            regex = /id=([\\w-]+)/gi;\r\n        var renders = null;\r\n\r\n        // Check if the xpath is an id\r\n        var idMatches = regex.exec(xpath);\r\n        if (idMatches && idMatches.length > 1) {\r\n            var render = self.getRenderById(idMatches[1]);\r\n            if (render) {\r\n                if (render.length == 0)\r\n                    return null;\r\n                else {\r\n                    renders = [];\r\n                    renders.push(render);\r\n                    return renders;\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n\r\n        }\r\n\r\n        renders = form.getRenders(xpath);\r\n        if (renders.length == 0)\r\n            return null;\r\n        return renders;\r\n    },\r\n    /*\r\n    *   Wrapper for get only one editable render\r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRender(xpath);\r\n    },\r\n    /*\r\n    *   Wrapper to get a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRenderById(id);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showRenderNotFoundError: function (xpath) {\r\n        bizagi.debug(\"Cannot find render in DOM: \" + xpath);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showContainerNotFoundError: function (containerId) {\r\n        bizagi.debug(\"Cannot find container in DOM: \" + containerId);\r\n    },\r\n    /*\r\n    *   Returns the current date\r\n    */\r\n    getCurrentDate: function () {\r\n        var currentDate = new Date();\r\n\r\n        // Remove time\r\n        currentDate.setHours(0, 0, 0, 0);\r\n        return currentDate;\r\n    },\r\n    /*\r\n    *   Return the grid xpath parts\r\n    */\r\n    processGridXpath: function (xpath) {\r\n\r\n        // Eval using regular expressions\r\n        var regex = new RegExp(/([\\w\\.]*)\\[(\\d*)\\]\\.([\\w\\.|\\w-\\.]*)/g);\r\n        var matches = regex.exec(xpath);\r\n        var index, remainingXpath, gridXpath;\r\n        if (matches) {\r\n            gridXpath = matches[1];\r\n            index = matches[2];\r\n            remainingXpath = matches[3];\r\n        } else {\r\n            index = \"\";\r\n            remainingXpath = \"\";\r\n        }\r\n\r\n        return { xpath: xpath, index: index, remainingXpath: remainingXpath, gridXpath: gridXpath };\r\n    },\r\n    /*\r\n    *   Check if an action/validation contains reference to a grid\r\n    */\r\n    searchForGridReference: function (conditions, commands) {\r\n        var self = this;\r\n        var i;\r\n        // Check in conditions\r\n        if (conditions) {\r\n            return self.searchGridReferenceInCondition(conditions);\r\n        }\r\n\r\n        // Check in commands\r\n        if (commands) {\r\n            for (i in commands) {\r\n                var command = commands[i];\r\n                return self.searchForGridReferenceInCommand(command);\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n     *   Check if an action/validation contains reference to a grid\r\n     */\r\n    searchForGridReferenceInCommand: function(command){\r\n        if (command.xpath && command.xpath.indexOf(\"[]\") > 0) {\r\n            return command.xpath.substring(0, command.xpath.indexOf(\"[]\"));\r\n        }\r\n\r\n        // Check in argument if argumentType is xpath\r\n        if (command.argumentType == 'xpath') {\r\n            if (command.argument.indexOf(\"[]\") > 0) {\r\n                return command.argument.substring(0, command.argument.indexOf(\"[]\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Check if a condition contains reference to a grid\r\n    */\r\n    searchGridReferenceInCondition: function (condition) {\r\n        var self = this;\r\n        var bGridReferenceFound;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            for (i in condition.expressions) {\r\n                if(condition.expressions.hasOwnProperty(i)) {\r\n                    bGridReferenceFound = self.searchGridReferenceInCondition(condition.expressions[i]);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n                }\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridReferenceInCondition(condition.simple);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridReferenceInCondition(condition.complex);\r\n        } else {\r\n            // Looking for grid reference within xpath\r\n            if (condition.xpath || condition.renderId) {\r\n                // Check in condition.xpath\r\n                bGridReferenceFound = self.searchGridReferenceInXpath(condition.xpath) || self.searchGridReferenceInXpath(condition.renderId);\r\n                if (bGridReferenceFound)\r\n                    return bGridReferenceFound;\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType == 'xpath') {\r\n                    bGridReferenceFound = self.searchGridReferenceInXpath(condition.argument);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n    *   Check if a xpath contains a grid reference\r\n    */\r\n    searchGridReferenceInXpath: function (xpath) {\r\n        // Check in condition.xpath\r\n        if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n            return xpath.substring(0, xpath.indexOf(\"[]\"));\r\n        }\r\n        return null;\r\n    },\r\n    getGridControl: function (xpath, surrogateKey) {\r\n        var self = this;\r\n        var remainingXpath = self.processGridXpath(xpath).remainingXpath;\r\n        var grid = self.getRender(xpath);\r\n        var column = grid.getControlCell(surrogateKey, remainingXpath);\r\n\r\n        return column;\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.validation\", {}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, validations, mainForm) {\r\n        var self = this;\r\n\r\n        // Enable evalValidation function with console log trace\r\n        self.enableDebug = false;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        var container = mainForm != undefined ? mainForm.container : form.container;\r\n\r\n        var validationBox = $('<div />').appendTo(container);\r\n\r\n        //Notifies that a modal view appear/disappear\r\n        $.widget( \"ui.bizagi_notifications\", $.ui.bizagi_notifications, {\r\n            expand: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            collapse: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            },\r\n            hide: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n\r\n        // Apply plugin\r\n        validationBox.bizagi_notifications({\r\n            itemIcon: \"ui-icon-circle-close\",\r\n            minimized: false,\r\n            clearEnabled: false,\r\n            title: form.getResource(\"render-form-validations-header-text\"),\r\n            device: bizagi.util.detectDevice(),\r\n            orientation: form.properties.orientation\r\n\r\n        });\r\n\r\n        // Bind click\r\n        validationBox.bind(\"itemClick\", function (e, ui) {\r\n            self.onNotificationClick(ui.data);\r\n        });\r\n\r\n        // Build validations\r\n        if (validations)\r\n            self.buildValidations(validations);\r\n\r\n        // Keep references\r\n        self.validationBox = validationBox;\r\n        self.validations = validations || [];\r\n    },\r\n\r\n\r\n    /* \r\n    *   Method to incorporate automatic validation rules \r\n    */\r\n    buildValidations: function (validations) {\r\n        var self = this;\r\n        var fnValidations = self.buildAllValidations(validations);\r\n\t\r\n        self.form.bind(\"rendervalidate\", function () {\r\n            return fnValidations(self);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple error message in the validation box\r\n    */\r\n    showErrorMessage: function (message) {\r\n        bizagi.showErrorAlertDialog = false;\r\n        this.showValidationMessage(message, null, \"ui-icon-circle-close\", \"ui-state-error\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple alert message in the validation box\r\n    */\r\n    showAlertMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-alert\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple info message in the validation box\r\n    */\r\n    showInfoMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-info\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple validation message in the validation box\r\n    */\r\n    showValidationMessage: function (message, focus, icon, itemAdditionalClass, type, renderId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var render = null;\r\n\r\n        if (renderId) {\r\n            render = form.getRenderById(renderId) || null;\r\n        } else {\r\n            render = focus ? form.getRender(focus) : null;\r\n        }\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n\r\n        // Method to perform validations after the render has been changed, or the notifications has been clicked\r\n        var performValidationFn = function () {\r\n            // First hide and clear validation box\r\n            self.clearValidationMessages();\r\n\r\n            // Run validations\r\n            self.validating = true;\r\n            self.performValidations();\r\n            self.validating = false;\r\n\r\n            // Attempt to hide if there are no validations\r\n            if (self.countValidationMessages() == 0) {\r\n                self.hideValidationMessages();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            } else {\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            }\r\n\r\n            form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n        };\r\n\r\n        // Add message\r\n        self.validationBox.bizagi_notifications(\"addNotification\", message, focus, icon, itemAdditionalClass, performValidationFn, type, renderId);\r\n\r\n        if (render) {\r\n            // Add error message to render\r\n            render.setValidationMessage(message);\r\n\r\n            if (!bizagi.util.isIE8()) {\r\n\r\n                // Bind event when render change\r\n                if (!self.validating) render.one(\"rendervalidate\", performValidationFn);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Count the number of validation messages\r\n    */\r\n    countValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"count\");\r\n    },\r\n\r\n    /*\r\n    *   Remove all the validations\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var validationsBoxes = $(\".ui-bizagi-notifications-container\", \"body\").not(\".ui-bizagi-log-container\");\r\n\r\n        return validationsBoxes.bizagi_notifications(\"clearAll\", undefined, params);\r\n    },\r\n\r\n    /*\r\n    *   Hide the validation notifications box\r\n    */\r\n    hideValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"hide\");\r\n    },\r\n\r\n    /*\r\n    *   Show the validation notifications box\r\n    */\r\n    showValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"show\");\r\n    },\r\n\r\n    /*\r\n    *   Expand the notification box\r\n    */\r\n    expandNotificationBox: function (autofocus) {\r\n        // Select first error and expand notifications\r\n        if (autofocus !== false) this.validationBox.bizagi_notifications(\"autoFocusFirstError\");\r\n        return this.validationBox.bizagi_notifications(\"expand\");\r\n    },\r\n\r\n    isExpandedNotificationBox: function(){        \r\n        return this.validationBox.bizagi_notifications(\"isExpanded\") && this.validationBox.bizagi_notifications(\"isContentVisible\");\r\n    },\r\n\r\n    /*\r\n    *   Run all validation rules in the form container\r\n    */\r\n    performValidations: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.clearValidationMessages();\r\n        self.validationBox.bizagi_notifications(\"initBatch\");\r\n\r\n        // Run render validations\r\n        var bRendersValid = self.validateRenders(invalidElements);\r\n\r\n        // Run form validations\r\n        var bFormValid = self.validations.length > 0 ? self.form.triggerHandler(\"rendervalidate\") : true;\r\n        self.validationBox.bizagi_notifications(\"endBatch\");\r\n\r\n        // Show validations if invalid\r\n        if (!bFormValid || !bRendersValid) {\r\n            self.validationBox.bizagi_notifications(\"show\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /* PRIVATE METHODS */\r\n\r\n    /*  \r\n    *   Construct validations javascript rules\r\n    */\r\n    buildAllValidations: function (validations) {\r\n        var self = this;\r\n        var sJSCode = \"\";\r\n\r\n        for (var i = 0; i < validations.length; i++) {\r\n\r\n            var isEnabled = (validations[i].enabled != undefined ) ? validations[i].enabled : true;\r\n            if (isEnabled)\r\n            {\r\n                // If validation is not \"valid\" we can omit that instruction\r\n                try { sJSCode += self.buildValidation(validations[i].conditions, validations[i].validationCommand); } catch (e) {\r\n                    if (e.message != \"RenderNotFoundException\") {\r\n                        bizagi.logError(\"Validation cannot be parsed: \" + e.message, validations[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build final function\r\n        var sStatement = \"var baTmpFn = function(self, params){\\r\\n var bValid = true;\\r\\n \" + sJSCode + \"\\r\\n return bValid;}; baTmpFn\";\r\n\r\n        // Return interpreted function\r\n        return self.evalValidation(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   Build a single javascript validation rule\r\n    */\r\n    buildValidation: function (conditions, validationCommand) {\r\n        var self = this;\r\n        var sJsCondition = \"\";\r\n        var sJsValidation = \"\";\r\n\r\n        // Detect grid references\r\n        var gridReference = self.searchForGridReference(conditions);\r\n        var bGridDetected = (gridReference != null);\r\n\r\n        // Build Conditions\r\n        sJsCondition += \"( \" + self.buildConditions(conditions, bGridDetected, true) + \" )\";\r\n\r\n        // Fix message for quotes and break lines\r\n        validationCommand.message = validationCommand.message.replace(/'/g, \"\\\\'\");\r\n        validationCommand.message = validationCommand.message.replace(/\\n/g, \" \");\r\n        \r\n        // Build Message\r\n        var focus = validationCommand.focus || \"\";\r\n        if (bGridDetected) focus = gridReference;\r\n        if (validationCommand.tokens)\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"', JSON.parse('\" + JSON.encode(validationCommand.tokens) + \"')); bValid = false;\\r\\n\";\r\n        else\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"'); bValid = false;\\r\\n\";\r\n\r\n        // Build final statement\r\n        if (!bGridDetected) {\r\n\r\n\r\n            return \"if (\" + sJsCondition + \"){\\r\\n \" + sJsValidation + \" \\r\\n}\";\r\n        } else {\r\n            var sGridStatement = \"var grid = self.form.getRender('\" + gridReference + \"');\\r\\n\";\r\n            sGridStatement += \"if(grid === null) return true;\\r\\n\";\r\n            sGridStatement += \"var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"var bGridValid = true;\\r\\n\";\r\n            sGridStatement += \"$.each(data, function(_, i) {\\r\\n\";\r\n            sGridStatement += \"if (\" + sJsCondition + \"){\\r\\n bGridValid = false; \\r\\n}\";\r\n            sGridStatement += \"});\\r\\n\";\r\n            sGridStatement += \"if (bGridValid == false){\\r\\n \" + sJsValidation + \"\\r\\n}\";\r\n            return sGridStatement;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method triggered when the validation item has been clicked\r\n    */\r\n    onNotificationClick: function (data) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var xpath = data.focus;\r\n        var renderId = data.id;\r\n\r\n        if (xpath) {\r\n            var render = renderId ? form.getRenderById(renderId) : form.getRender(xpath);\r\n\r\n            if (render) {\r\n                render.focus();\r\n            }\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method to loop\r\n    */\r\n    validateRenders: function (invalidElements) {\r\n        var self = this;\r\n        invalidElements = invalidElements || [];\r\n\r\n        // Do a check\r\n        var bValid = self.form.isValid(invalidElements);\r\n        if (!bValid) {\r\n            invalidElements.forEach(function(element){\r\n                if( element.id ) {\r\n                    // Parameters: message, xpath, icon, itemAdditionalClass, type, renderId\r\n                    self.showValidationMessageById(element.message, element.xpath, element.id);\r\n                } else if (element.message || element.xpath) {\r\n                    self.showValidationMessage(element.message, element.xpath);\r\n                }\r\n            });            \r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n    *\tEval validation string, for debug purposes\r\n    */\r\n    evalValidation: function (command) {\r\n        var self = this;\r\n\r\n        if (self.enableDebug && console != undefined) {\r\n            console.log(command);\r\n        }\r\n\r\n        return eval(command);\r\n    },\r\n\r\n    /**\r\n     * Method to add a simple validation message in the validation box\r\n     * @param message\r\n     * @param xpath\r\n     * @param renderId\r\n     */\r\n    showValidationMessageById: function (message, xpath, renderId) {\r\n        this.showValidationMessage(message, xpath, undefined, false, undefined, renderId);\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.action\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, actions) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        // Set a new hash containing all the dependencies subscribing the events\r\n        self.globalDependencies = {};\r\n        self.initialCallFunctions = {};\r\n        self.initialCallFunctionsDeferred = new $.Deferred();\r\n\r\n        // Build actions\r\n        if (actions)\r\n            self.buildActions(actions);\r\n\r\n        // Keep references\r\n        self.actions = actions;\r\n        self.internalSubmitActions = {};\r\n\r\n        // Set initial timer to trigger initial functions using a setTimeout, and distributing them in differente timespans\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallIncrements = 25;\r\n        self.actionsHistory = {};\r\n        self.period = 50;\r\n    },\r\n    /*\r\n    *   Adds an internal submit action to be executed with all the given rules\r\n    */\r\n    processInternalSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n\r\n        // if the action is registered, don't add it again\r\n        // only one internal submit action is allowed per control\r\n        if (self.internalSubmitActions[xpath])\r\n            return;\r\n\r\n        // Add to hash and build it\r\n        self.internalSubmitActions[xpath] = action;\r\n        self.buildAction(action, true);\r\n    },\r\n\r\n    isSummaryOrGlobalForm: function () {\r\n        var self = this;\r\n        var result = false;\r\n\r\n        if (self.form.properties.typeForm === \"SummaryForm\" || self.form.properties.typeForm === \"GlobalForm\") result = true;\r\n        return result;\r\n    },\r\n\r\n    evalClientAction: function (action) {\r\n        var self = this, i = 0, serverCommand = false, command;\r\n        var commands = [].concat(action.commands, action.elseCommands);\r\n        var length = commands.length;\r\n\r\n        for (; i < length; i++) {\r\n            command = commands[i];\r\n            if (!self.isClientAction(command)) {\r\n                serverCommand = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (serverCommand) {\r\n            action.enabled = false;\r\n        }\r\n    },\r\n\r\n    /* Process all given  actions*/\r\n    buildActions: function (actions, dontExecute) {\r\n        var self = this, i, len;\r\n        var hashes = {};\r\n\r\n        var executeOnlyClientActions = self.isSummaryOrGlobalForm();\r\n\r\n        for (i = 0, len = actions.length; i < len; i++) {\r\n            // If action is not \"valid\" we can omit that instruction\r\n            try {\r\n                var action = actions[i];\r\n                var hash = bizagi.util.md5(JSON.stringify(action.conditions));\r\n                var hashC = bizagi.util.md5(JSON.stringify(action.commands));\r\n                if (hashes[hash]) {\r\n                    if (hashes[hash].indexOf(hashC) === -1) {\r\n                        // si la condicion es igual y los comandos diferentes\r\n                        executeOnlyClientActions && self.evalClientAction(action);\r\n                        self.buildAction(action, dontExecute);\r\n                        hashes[hash].push(hashC);\r\n                    }\r\n                } else {\r\n                    executeOnlyClientActions && self.evalClientAction(action);\r\n                    self.buildAction(action, dontExecute);\r\n                    hashes[hash] = [hashC];\r\n                }\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, actions[i]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Remove all current handlers\r\n    */\r\n    unbindActions: function () {\r\n        var self = this;\r\n\r\n        // Remove all previous handlers\r\n        $.each(self.globalDependencies, function (i, render) {\r\n            render.unbind(\"renderchange.action\");\r\n        });\r\n\r\n        self.globalDependencies = {};\r\n\r\n        // Reset timers and collections\r\n        $.each(self.initialCallFunctions, function (i, handle) {\r\n            clearTimeout(handle);\r\n        });\r\n        self.initialCallFunctions = {};\r\n    },\r\n    /* \r\n    *   Re-execute actions, cleaning the handlers first\r\n    */\r\n    refreshActions: function (newActions) {\r\n        var self = this;\r\n\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallFunctions = {};\r\n\r\n        newActions = newActions || [];\r\n\r\n        // Build the actions again\r\n        self.actions = self.actions.concat(newActions);\r\n        self.buildActions(self.actions, true);\r\n\r\n        // Build internal actions again\r\n        $.each(self.internalSubmitActions, function (_, action) {\r\n            try {\r\n                self.buildAction(action, false);\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, action);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* Process a single action*/\r\n    buildAction: function (action, dontExecute) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var dependencies = [];\r\n        var dependenciesId = [];\r\n\r\n        var isEnabled = (action.enabled != undefined) ? action.enabled : true;\r\n\r\n        if (!isEnabled) return;\r\n\r\n        // If the condition operator is true, we gotta dig in the actions to check if it modifies a grid\r\n        // To include an auto-dependency, so each time the grid is changed that condition will be executed\r\n        if (action.conditions && action.conditions.operator == \"true\") {\r\n            if (!action.dependencies)\r\n                action.dependencies = [];\r\n            $.each(action.commands, function (_, command) {\r\n                var gridReference = self.searchGridReferenceInXpath(command.xpath);\r\n                if (gridReference) {\r\n                    var dependencyAlreadyAdded = false, j, len;\r\n                    for (j = 0, len = action.dependencies; j < len; j++) {\r\n                        if (action.dependencies[j] == gridReference)\r\n                            dependencyAlreadyAdded = true;\r\n                    }\r\n                    if (!dependencyAlreadyAdded)\r\n                        action.dependencies.push(gridReference);\r\n                }\r\n            });\r\n        }\r\n\r\n        function isValidDependency(type) {\r\n            var notValid = [\"groupedgrid\", \"collectionnavigator\"];\r\n            if (notValid.indexOf(type) === -1) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n\r\n        // Find dependencies to attach triggers\r\n        if (action.dependencies) {\r\n            for (var i = 0; i < action.dependencies.length; i++) {\r\n                if (typeof action.dependencies[i] != \"undefined\") {\r\n                    var renders = form.getRenders(action.dependencies[i]);\r\n                    if (renders.length === 0) {\r\n                        var renderById = form.getRenderById(action.dependencies[i]);\r\n                        renders = (renderById) ? [renderById] : null;\r\n                    }\r\n\r\n                    if (renders) {\r\n                        $.each(renders, function (_, render) {\r\n                            if ($.inArray(render.properties.id, dependenciesId) < 0) {\r\n                                if (isValidDependency(render.properties.type)) {\r\n                                    dependenciesId.push(render.properties.id);\r\n                                    dependencies.push(render);\r\n                                }\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build anonymous function\r\n        var fn = self.buildFunction(action.conditions, action.commands, action.elseCommands);\r\n\r\n        // Attach handlers\r\n        $.each(dependencies, function (_, render) {\r\n            render.bind(\"renderchange.action\", function (ev, args) {\r\n                args = args || {};\r\n\r\n                // Default changed argument to true\r\n                args.changed = args.changed !== undefined ? args.changed : true;\r\n\r\n                // If a grid action has been performed, try to filter it by column, to avoid execute all grid actions each time                \r\n                if (args.column) {\r\n                    for (var j = 0; j < action.gridColumns.length; j++) {\r\n                        if (args.column == action.gridColumns[j]) {\r\n                            // Call function\r\n                            fn(self, args);\r\n                            return;\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Call function\r\n                    fn(self, args);\r\n                }\r\n            });\r\n\r\n            // Add to global dependencies hash\r\n            self.globalDependencies[render.properties.id] = render;\r\n\r\n            // If render is a grid ... trigger function at this point\r\n            if (render.properties.type === 'grid') {\r\n                dontExecute = true;\r\n\r\n                // Search column dependencies\r\n                action.gridColumns = [];\r\n                self.searchGridColumns(action.conditions, action.gridColumns);\r\n            }\r\n        });\r\n\r\n        // Check if it has to execute\r\n        if (dontExecute)\r\n            return;\r\n\r\n        // Execute the action because it must execute when the page loads with pre-defined value\r\n        // Create an async function to trigger it later\r\n        var asyncFn = function (self) {\r\n\r\n            var guid = Math.guid();\r\n            // Create the timeout\r\n            var handle = setTimeout(function () {\r\n                try {\r\n                    // TODO: Define render to set parameter to \"fn\" function\r\n                    fn(self);\r\n                    delete self.initialCallFunctions[guid];\r\n                } catch (e) {\r\n                }\r\n            }, self.initialCallTimeout);\r\n\r\n            // Save a reference\r\n            self.initialCallFunctions[guid] = handle;\r\n            self.initialCallTimeout += self.initialCallIncrements;\r\n        };\r\n\r\n        // Run it\r\n        asyncFn(self);\r\n    },\r\n    /*\r\n    * Creates the function to execute based on the action metadata\r\n    */\r\n    buildFunction: function (conditions, commands, elseCommands) {\r\n        var self = this;\r\n\r\n        var gridReference = self.searchForGridReference(conditions, commands);\r\n        var bGridDetected = (gridReference != null) ? gridReference : false;\r\n        var sJsCondition = \"\";\r\n        var sJsAction = \"\";\r\n        var sStatement;\r\n        var sJsElseAction = \"\";\r\n        var bAutomaticRestore = elseCommands ? false : true;\r\n        var bCondition = conditions ? true : false;\r\n        var i;\r\n\r\n        // Build Condition\r\n        if (bCondition) {\r\n            sJsCondition += self.buildConditions(conditions, bGridDetected);\r\n        }\r\n\r\n        // Build and execute actions\r\n        for (i = 0; i < commands.length; i++) {\r\n            // Parse command\r\n            var queueAction = self.isServerCommand(commands[i]) ? \"addParallel\" : \"add\";\r\n            var command = self.buildCommand(commands[i], bGridDetected);\r\n\r\n            // Check if command ending with semicolon and remove it\r\n            command = (command.indexOf(\";\") >= 1) ? command.replace(\";\", \"\") : command;\r\n            sJsAction += \"actionQueue.\" + queueAction + \"(function(){return \" + command + \" ;}); \\r\\n\";\r\n\r\n            if (bAutomaticRestore) {\r\n                sJsElseAction += self.buildRestoreCommand(commands[i], bGridDetected);\r\n            }\r\n        }\r\n\r\n        // Build non-automatic else commands\r\n        if (!bAutomaticRestore) {\r\n            sJsElseAction += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n            sJsElseAction += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n            for (i = 0; i < elseCommands.length; i++) {\r\n                var queueAction = self.isServerCommand(elseCommands[i]) ? \"addParallel\" : \"add\";\r\n                var elseCommand = self.buildCommand(elseCommands[i], bGridDetected);\r\n                // Check if command ending with semicolon and remove it\r\n                elseCommand = (elseCommand.indexOf(\";\") >= 1) ? elseCommand.replace(\";\", \"\") : elseCommand;\r\n                sJsElseAction += \"actionQueue.\" + queueAction + \"(function(){return \" + elseCommand + \" ;}); \\r\\n\";\r\n            }\r\n            sJsElseAction += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n            sJsElseAction += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n            sJsElseAction += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n        }\r\n\r\n        // Build final function\r\n        //sStatement = \"var baTmpFn = function(self, i, column){ \\r\\n\";\r\n        sStatement = \"var baTmpFn = function(self, params){ \\r\\n\";\r\n        sStatement += \"params = params || {};\\r\\n\";\r\n        if (bGridDetected) {\r\n            sStatement += \"var i = params.key;\\r\\n\";\r\n            sStatement += \"var column = params.column;\\r\\n\";\r\n        }\r\n        if (bCondition) {\r\n            sStatement += \"if (\" + sJsCondition + \"){ \\r\\n\";\r\n        }\r\n\r\n        // Creates defferreds\r\n        sStatement += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n        sStatement += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n        sStatement += sJsAction;\r\n        sStatement += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n        sStatement += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n        sStatement += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n\r\n        if (bCondition) {\r\n            sStatement += \"\\r\\n } \";\r\n            if (sJsElseAction.length > 0) {\r\n                sStatement += \"else { \\r\\n\" + sJsElseAction + \" }\\r\\n\";\r\n            }\r\n        }\r\n\r\n        sStatement += \"};\\r\\n\";\r\n\r\n\r\n        if (!bGridDetected) {\r\n            sStatement += \"baTmpFn\";\r\n        } else {\r\n            var sGridStatement = \"var baGridTmpFn = function(self, args){ \\r\\n\";\r\n            sGridStatement += \"args = args || {};\\r\\n\";\r\n            sGridStatement += \"\\t var grid = args.render || self.form.getRender('\" + gridReference + \"') || []; \\r\\n\";\r\n            sGridStatement += \"\\t grid = grid.grid ? grid : (self.form.getRender('\" + gridReference + \"') || []); \\r\\n\";\r\n            sGridStatement += \"\\t args.grid = grid; \\r\\n\";\r\n            sGridStatement += \"if(args.surrogateKey === undefined){\\r\\n\";\r\n            sGridStatement += \"\\t var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"\\t $.each(data, function(i, index) {\\r\\n\";\r\n            sGridStatement += \"\\t\\t args.key = index; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args);\\r\\n\";\r\n            sGridStatement += \"\\t });\\r\\n\";\r\n            sGridStatement += \"} else {\\r\\n\";\r\n            sGridStatement += \"\\t args.key = args.surrogateKey; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args ); \\r\\n\";\r\n            sGridStatement += \"}\\r\\n\";\r\n            sGridStatement += \"};\\r\\n\";\r\n            sStatement += sGridStatement;\r\n            sStatement += \"baGridTmpFn\";\r\n        }\r\n\r\n        // Return interpreted function\r\n        return eval(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   This method checks if a command must be performed by the client, or by the server\r\n    */\r\n    isServerCommand: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"refresh\", \"submit-data\", \"execute-rule\", \"execute-interface\", \"execute-sap\", \"execute-connector\", \"execute-excel-bot\"].includes(commandType);\r\n    },\r\n\r\n    isClientAction: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"background-color\", \"forecolor\", \"visible\", \"required\", \"collapse\", \"set-active\"].includes(commandType);\r\n    },\r\n\r\n    isRecentAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        if (self.actionsHistory[tag] != null) {\r\n            return true;\r\n        }\r\n        $.when(self.runAction(prefix, command)).done(function () {\r\n            delete self.actionsHistory[tag];\r\n            bizagi.log(\"resolve \" + tag);\r\n        });\r\n        return false;\r\n    },\r\n\r\n    runAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        self.actionsHistory[tag] = new $.Deferred();\r\n        setTimeout(self.actionsHistory[tag].resolve, self.period);\r\n        return self.actionsHistory[tag].promise();\r\n    },\r\n    /*\r\n    *   Builds the action JS\r\n    */\r\n    buildCommand: function (command, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        var gridReference = bGridDetected;\r\n\r\n        // Parse argument\r\n        var commandType = command.command;\r\n        var detectedArgumentType = self.detectCommandArgumentType(command.argumentType, commandType);\r\n        var argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected, command.xpathContext);\r\n        var xpath = command.xpath;\r\n\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected && xpath) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if ((command.xpath && command.xpath.length > 0) || (command.renderId && command.renderId.length > 0)) {\r\n            // Build render command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'forecolor':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'visible':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'readonly':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'required':\r\n                    return \"self.changeRenderRequired('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-value':\r\n                    // Check specific argument type\r\n                    if (bGridDetected && command.argumentType === \"xpath\" && !!command.xpathContext) {\r\n                        // When we are going to evaluate a xpath is necessary add a xpathcontext if it exist\r\n                        command.argument = command.xpathContext + \".\" + command.argument;\r\n                        argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected);\r\n                    }\r\n\r\n                    return \"self.changeRenderValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-min':\r\n                    return \"self.changeRenderMinValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-max':\r\n                    return \"self.changeRenderMaxValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'calculate':\r\n                    return \"self.executeCalculatedField('\" + xpath + \"');\";\r\n                    break;\r\n                case 'submit-value':\r\n                    return \"self.submitRender('\" + xpath + \"', '\" + argument + \"');\";\r\n                    break;\r\n                case 'clean-data':\r\n                    return \"self.cleanRenderData('\" + xpath + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    var commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n\r\n                    if (commandGridDetected) {\r\n                        return \"self.refreshGridCell('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    } else {\r\n                        return \"self.refreshControl('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"','\" + commandType + \"');\";\r\n                    }\r\n                    break;\r\n                case 'trigger-click':\r\n                    return \"self.triggerClick('\" + xpath + \"');\";\r\n                    break;\r\n\r\n            }\r\n        } else {\r\n            // Build container command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    return \"self.changeContainerBackground('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'visible':\r\n                    return \"self.changeContainerVisibility('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'collapse':\r\n                    return \"self.toogleContainer('\" + command.container + \"', \" + !bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n                case 'set-active':\r\n                    return \"self.changeActiveItem('\" + command.container + \"');\";\r\n                    break;\r\n                case 'readonly':\r\n                    return \"self.changeContainerEditability('\" + command.container + \"', \" + bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    // Set prepare parameter to multiaction purposes \r\n                    return \"self.refreshContainer('\" + command.container + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    break;\r\n            }\r\n        }\r\n\r\n        // Global  actions without specific target\r\n        if (commandType === 'submit-data') {\r\n            return \"self.submitFormData();\";\r\n        }\r\n\r\n        if (commandType === 'execute-rule') {\r\n            var ruleObj = command.argument || {};\r\n            var guidRule = \"\";\r\n            try {\r\n                guidRule = JSON.parse(ruleObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            var xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                var xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeRule('\" + guidRule + \"', printf('\" + xpathContextRow + \"',i) ,'\" + commandType + \"');\";\r\n            } else {\r\n                return \"self.executeRule('\" + guidRule + \"','\" + xpathContext + \"','\" + commandType + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-interface') {\r\n            var interfaceObj = command.argument || {};\r\n            var guidInterface = \"\";\r\n\r\n            try {\r\n                guidInterface = JSON.parse(interfaceObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeInterface('\" + guidInterface + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeInterface('\" + guidInterface + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-sap') {\r\n            var connectorObj = command.argument || {};\r\n            var guidsap = \"\";\r\n\r\n            try {\r\n                guidsap = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeSAPConnector('\" + guidsap + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeSAPConnector('\" + guidsap + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-connector' || commandType === 'execute-excel-bot') {\r\n            var connectorObj = command.argument || {};\r\n            var guidConnector = \"\";\r\n\r\n            try {\r\n                guidConnector = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeConnector('\" + guidConnector + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeConnector('\" + guidConnector + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return \"\";\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore automatically a command when condition is not met\r\n    */\r\n    buildRestoreCommand: function (command, bGridDetected) {\r\n        var xpath = command.xpath;\r\n        var commandType = command.command;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        // Build restore action\r\n        if (xpath && xpath.length > 0) {\r\n            return \"self.restoreRender('\" + xpath + \"', '\" + commandType + \"');\";\r\n        } else {\r\n            return \"self.restoreContainer('\" + command.container + \"', '\" + commandType + \"');\";\r\n        }\r\n    },\r\n    /* \r\n    *   Detect the command argument type based on the command type\r\n    */\r\n    detectCommandArgumentType: function (argumentType, commandType) {\r\n        if (argumentType === undefined) {\r\n            return argumentType;\r\n\r\n        } else if (argumentType == \"const\") {\r\n\r\n            if (commandType == 'background-color')\r\n                return 'color';\r\n            if (commandType == 'forecolor')\r\n                return 'color';\r\n            if (commandType == 'visible')\r\n                return 'boolean';\r\n            if (commandType == 'readonly')\r\n                return 'boolean';\r\n            if (commandType == 'required')\r\n                return 'boolean';\r\n            if (commandType == 'set-value')\r\n                return 'text';\r\n            if (commandType == 'collapse')\r\n                return 'boolean';\r\n            if (commandType == 'set-active')\r\n                return 'number';\r\n            if (commandType == 'set-min')\r\n                return 'text';\r\n            if (commandType == 'set-max')\r\n                return 'text';\r\n            if (commandType == 'calculate')\r\n                return undefined;\r\n            if (commandType == 'refresh')\r\n                return undefined;\r\n            if (commandType == 'submit-value')\r\n                return 'json';\r\n\r\n        } else if (argumentType === \"xpath\" || argumentType === \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return null;\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a render when condition is not met\r\n    */\r\n    restoreRender: function (xpath, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            var properties = render.originalProperties;\r\n            var textFormat = properties.textFormat || {};\r\n            if (commandType == 'background-color')\r\n                self.changeRenderBackground(xpath, textFormat.background || '');\r\n            if (commandType == 'forecolor')\r\n                self.changeRenderForeground(xpath, textFormat.color || 'none');\r\n            if (commandType == 'visible')\r\n                self.changeRenderVisibility(xpath, properties.visible != undefined ? properties.visible : true);\r\n            if (commandType == 'readonly')\r\n                self.changeRenderEditability(xpath, properties.editable != undefined ? properties.editable : true);\r\n            if (commandType == 'required')\r\n                self.changeRenderRequired(xpath, properties.required != undefined ? properties.required : false);\r\n            // NOte: Command 6 does not have restoration\r\n        });\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a container when condition is not met\r\n    */\r\n    restoreContainer: function (containerId, commandType) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        var properties = container.originalProperties;\r\n        if (commandType == 'background-color')\r\n            self.changeContainerBackground(containerId, properties.backgroundColor || 'none');\r\n        if (commandType == 'visible')\r\n            self.changeContainerVisibility(containerId, properties.visible != undefined ? properties.visible : true);\r\n        if (commandType == 'collapse')\r\n            self.toogleContainer(containerId, true);\r\n        // NOte: Command 8 does not have restoration\r\n        if (commandType == 'readonly')\r\n            self.changeContainerEditability(containerId, properties.editable != undefined ? properties.editable : true);\r\n    },\r\n    /* \r\n    *   Sets a new color for the background of the render\r\n    *   Applies also to grid cells!\r\n    */\r\n    changeRenderBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeBackgroundColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellBackgroundColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellBackgroundColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the background of the button\r\n     *   Applies also to grid cells!\r\n     */\r\n    changeButtonBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n\r\n        element.css(\"background-image\", \"none\");\r\n        element.addClass(\"ui-fast-transition\");\r\n\r\n        if (typeof (element[0]) !== \"undefined\") {\r\n            element[0].style.setProperty(\"background-color\", argument, \"important\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Sets a new color for the foreground of the render\r\n    */\r\n    changeRenderForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the foreground of the render\r\n     */\r\n    changeButtonForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.css(\"color\", argument, \"!important\");\r\n    },\r\n    /* \r\n    *   Changes the visibility of the render\r\n    */\r\n    changeRenderVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.changeVisibility(argument);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellVisibility(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellVisibility(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Changes the visibility of the button\r\n     */\r\n    changeButtonVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.show();\r\n            element.css(\"display\", \"\");\r\n        } else {\r\n            element.hide();\r\n        }\r\n    },\r\n    /* \r\n    *   Changes the editability of the render\r\n    */\r\n    changeRenderEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeEditability(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellEditability(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellEditability(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the editability of the button\r\n     */\r\n    changeButtonEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.removeAttr(\"disabled\");\r\n        } else {\r\n            element.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n    /*\r\n     *  trigger Click button\r\n     */\r\n    triggerClick: function (xpath) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.trigger(\"click\");\r\n    },\r\n\r\n    /* \r\n    *   Changes the required value of the render\r\n    */\r\n    changeRenderRequired: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var rendersToEval = [];\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            if (bizagi.util.parseBoolean(render.properties.editable)) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        if (rendersToEval.length === 0) {\r\n            rendersToEval = renders;\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeRequired(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellRequired(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellRequired(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render internal value\r\n    */\r\n    changeRenderValue: function (xpath, argument) {\r\n        var self = this;\r\n\r\n        if (argument != null && typeof argument === \"object\" ){\r\n            argument = $.extend(argument, {fromAction: true});\r\n        }\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    if (render.asyncRenderDeferred) {\r\n                        $.when(render.asyncRenderDeferred).done(function () {\r\n                            render.setDisplayValue(argument);\r\n                        });\r\n                    } else {\r\n                        render.setDisplayValue(argument);\r\n                    }\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render minimum value\r\n    */\r\n    changeRenderMinValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    var renderType = render.properties.type;\r\n                    if (renderType === \"number\" || renderType === \"date\" || renderType === \"money\") {\r\n                        render.changeMinValue(argument);\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMinValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMinValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    changeRenderMaxValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeMaxValue(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMaxValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMaxValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    executeCalculatedField: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            $.when(render.ready()).done(function () {\r\n                render.runFormula();\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshControl: function (xpath, xpathContext, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n        var queue = new bizagiQueue();\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process matching renders\r\n        $.each(renders, function (i, render) {\r\n            queue.add(render.ready().pipe(function () {\r\n                return render.refreshControl({xpath: xpath, xpathContext: xpathContext});\r\n            }));\r\n        });\r\n\r\n        // Return queue deferred\r\n        return queue.execute();\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshContainer: function (containerId, xpathContext) {\r\n        var self = this;\r\n        var container = self.form.getContainer(containerId);\r\n\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return $.when(container.ready())\r\n            .pipe(function () {\r\n                return container.refreshContainer({xpathContext: xpathContext});\r\n            });\r\n    },\r\n    /**\r\n     * Refresh a cell of grid\r\n     */\r\n    refreshGridCell: function (xpath, xpathContext) {\r\n        var self = this;\r\n        var queue = new bizagiQueue();\r\n        var def = new $.Deferred();\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            });\r\n        }\r\n\r\n        if (rendersToEval.length === 0) {\r\n            return;\r\n        }\r\n\r\n        // Check xpathContext of the form (addForm or editForm)\r\n        if (self.form && self.form.properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? self.form.properties.xpathContext + \".\" + xpathContext : self.form.properties.xpathContext;\r\n        }\r\n\r\n        queue.add(def.promise());\r\n\r\n        $.when.apply($, $.map(rendersToEval, function (grid) {\r\n            grid.ready();\r\n        }))\r\n            .done(function () {\r\n                var len = rendersToEval.length;\r\n                var internalQueue = new bizagiQueue();\r\n                for (var i = 0; i < len; i++) {\r\n                    var grid = rendersToEval[i];\r\n\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        // Process a specific row\r\n                        internalQueue.add(grid.refreshCell({\r\n                            key: gridXpath.index,\r\n                            column: gridXpath.remainingXpath,\r\n                            xpathContext: xpathContext\r\n                        }));\r\n                    } else {\r\n                        // Process all rows\r\n                        var indexes = grid.getIndexes();\r\n                        var lenIndex = indexes.length;\r\n                        for (var j = 0; j < lenIndex; j++) {\r\n                            internalQueue.addParallel(grid.refreshCell({\r\n                                key: indexes[j],\r\n                                column: gridXpath.remainingXpath,\r\n                                xpathContext: xpathContext\r\n                            }));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $.when(internalQueue.execute())\r\n                    .done(function () {\r\n                        def.resolve();\r\n                    });\r\n            });\r\n\r\n\r\n        return queue.execute();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitFormData: function (params) {\r\n        var self = this;\r\n\r\n        // For the submit action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.submitData(params);\r\n            });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (rule, xpathContext, commandType) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n        var prefix = rule + \".\" + xpathContext;\r\n        if (self.isRecentAction(prefix, commandType)) {\r\n            return;\r\n        } else {\r\n            // Process the action\r\n            return $.when(form.ready())\r\n                .pipe(function () {\r\n                    return form.executeRule({rule: rule, xpathContext: xpathContext});\r\n                });\r\n        }\r\n    },\r\n    executeInterface: function (interface, xpathContext) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.executeInterface({interface: interface, xpathContext: xpathContext});\r\n            });\r\n    },\r\n\r\n\r\n    executeSAPConnector: function (guidsap, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeSAPConnector({guidsap: guidsap, xpathContext: xpathContext});\r\n        });\r\n    },\r\n\r\n    executeConnector: function (guidConnector, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeConnector({guidConnector: guidConnector, xpathContext: xpathContext});\r\n        });\r\n    },\r\n    /*\r\n    *   Submit the given render and refresh dependencies after that\r\n    */\r\n    submitRender: function (xpath, argument) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process the action in the render\r\n        return $.when(render.ready()).pipe(function () {\r\n            return render.submitOnChange();\r\n        });\r\n    },\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanRenderData: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.cleanData();\r\n                        self.changeRenderRequired(xpath, render.properties.required != undefined ? render.properties.required : false);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.cleanCellData(gridXpath.index, gridXpath.remainingXpath);\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.cleanCellData(indexes[j], gridXpath.remainingXpath);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container background color\r\n    */\r\n    changeContainerBackground: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeBackgroundColor(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Shows or hides a container\r\n    */\r\n    changeContainerVisibility: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready(true)).done(function () {\r\n            $.when(container.renderingDeferred).done(function () {\r\n                container.changeVisibility(argument);\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Expand or collapse a group container\r\n    */\r\n    toogleContainer: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type !== \"group\")\r\n            return;\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.toogleContainer(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Select a determinate sub-container in a tab or an accordion\r\n    */\r\n    changeActiveItem: function (containerId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type === \"tabItem\" && container.loadingDeferred) {\r\n            container.loadingDeferred.resolve();\r\n        }\r\n        $.when(container.ready()).done(function () {\r\n            container.setAsActiveContainer();\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container editability\r\n    */\r\n    changeContainerEditability: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeEditability(argument);\r\n        });\r\n    },\r\n    /*\r\n    *   Search for grid columns\r\n    */\r\n    searchGridColumns: function (condition, gridColumns) {\r\n        var self = this;\r\n        var column;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            var j, lenIndex;\r\n            for (j = 0, lenIndex = condition.expressions.length; j < lenIndex; j++) {\r\n                self.searchGridColumns(condition.expressions[j], gridColumns);\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridColumns(condition.simple, gridColumns);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridColumns(condition.complex, gridColumns);\r\n        } else {\r\n            var xpath = condition.xpath || condition.renderId;\r\n            if (xpath) {\r\n                // Check in condition.xpath\r\n                if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n                    column = xpath.substring(xpath.indexOf(\"[]\") + 3);\r\n                    gridColumns.push(column);\r\n                }\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType === 'xpath') {\r\n                    if (condition.argument.indexOf(\"[]\") > 0) {\r\n                        column = condition.argument.substring(condition.argument.indexOf(\"[]\") + 3);\r\n                        gridColumns.push(column);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /**/\r\n\r\n    isGridComponent: function (render, xpath) {\r\n        var renderType = bizagi.util.normalizeType(render.properties.type);\r\n        return (/^grid$/i.test(renderType) && xpath.indexOf('[') >= 0);\r\n    },\r\n    /**/\r\n\r\n    isValidRender: function (render) {\r\n        var notValid = [\"collectionnavigator\"];\r\n\r\n        return notValid.indexOf(render.properties.type) === -1;\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability. TODO: Apply to mobile with formButtons\r\n     * @param {} xpath\r\n     * @param {} status\r\n     * @returns {}\r\n     */\r\n    changeFormButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n        var navigation = form.getNavigation();\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n});","/*\r\n *   Name: Bizagi Rendering Validation controller \r\n *   Author: Richar Urbano <Richar.Urbano@Bizagi.com\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\n// Override to support the change of the visibility and editability over forms buttons\r\nbizagi.command.controllers.action.extend(\"bizagi.command.controllers.action\", {}, {\r\n\r\n    /**\r\n     * Sets a new color for the background of the button\r\n     * Applies also to grid cells!\r\n     * @param {} xpath \r\n     * @param {} color \r\n     * @returns {} \r\n     */\r\n    changeButtonBackground: function(xpath, color) {       \r\n        if (this.form && !this.form.isFloatingButtonsEnabled())\r\n            this._super(xpath, color);\r\n    },\r\n\r\n    /**\r\n     * Sets a new color for the foreground of the render\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonForeground: function(xpath, color) {                           \r\n        if (this.form && !this.form.isFloatingButtonsEnabled())\r\n            this._super(xpath, color);\r\n    },\r\n\r\n    /**\r\n     * Changes the visibility of the button\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonVisibility: function(xpath, status) {\r\n        var self = this;        \r\n\r\n        if (self.form && !self.form.isFloatingButtonsEnabled()) {\r\n            self._super(xpath, status);\r\n        } else {\r\n            self.changeFloatingButtonVisibility(xpath, status)\r\n        }\r\n    },\r\n\r\n    /**     \r\n     * Changes the editability of the button\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonEditability: function (xpath, status) {\r\n        var self = this;\r\n\r\n        if (self.form && !self.form.isFloatingButtonsEnabled()) {\r\n            self._super(xpath, status);\r\n        } else {\r\n            self.changeFloatingButtonVisibility(xpath, status)\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability\r\n     * @param {} xpath \r\n     * @param {} status \r\n     * @returns {} \r\n     */\r\n    changeFloatingButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n        var navigation = form.getNavigation();\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Element Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class with common stuff related to all renders and containers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.element\", {\r\n    ELEMENT_TYPE_CONTAINER: 1,\r\n    ELEMENT_TYPE_RENDER: 2,\r\n    ELEMENT_TYPE_COLUMN: 3\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Set render factory\r\n        this.renderFactory = params.renderFactory;\r\n\r\n        // Set data service\r\n        this.dataService = params.dataService;\r\n\r\n        // Set reference to parent\r\n        this.parent = params.parent;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set the observable element\r\n        this.observableElement = $(\"<div />\");\r\n\r\n        // Set the dispose flag\r\n        this.disposed = false;\r\n\r\n        // Update data\r\n        this.initializeData(params.data);\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Set the internal data\r\n        this.properties = {};\r\n        if (data && data.properties) this.properties = data.properties;\r\n\r\n        // Set xpath context\r\n        this.properties.xpathContext = this.getXpathContext();\r\n\r\n        // Set page cache\r\n        this.properties.idPageCache = this.getPageCache();\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        // By default return parent's xpath context\r\n        // This method is overriden in form container which contains the real xpath context\r\n\r\n        return (this.parent != undefined && typeof this.parent.getXpathContext == \"function\") ? this.parent.getXpathContext() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache for the current element\r\n    */\r\n    getPageCache: function () {\r\n        // By default return parent's page cache\r\n        // This method is overriden in form container which contains the real page cache\r\n\r\n        return (this.parent != undefined && typeof this.parent.getPageCache == \"function\") ? this.parent.getPageCache() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        // By default return parent's form container\r\n        // This method is overriden in form container which returns itself\r\n        if (typeof (this.parent) != \"undefined\")\r\n        return this.parent.getFormContainer();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the mapped resource\r\n    */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () { },\r\n\r\n    /* \r\n    *   Resizes the element \r\n    */\r\n    resize: function (size) {\r\n\r\n    },\r\n\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function () {\r\n\r\n        if (this.properties.required) {\r\n            var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n            // Check if element is visible into scroll\r\n            if (!bizagi.util.isScrolledIntoView(this.element, layout)) {\r\n                $(this.element).attr('tabindex', -1).focus();\r\n            }\r\n            if (this.element) {\r\n                this.element.effect('highlight', 2000);\r\n            }\r\n        }\r\n\r\n        //Check if the element has parent\r\n        if (this.parent && typeof this.parent.focus == 'function') {\r\n            this.parent.focus();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.parent) return this.parent.triggerGlobalHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.trigger(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.triggerHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.bind(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Un-binds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.unbind(eventType, fn);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds a one time event\r\n    */\r\n    one: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.one(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () { },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        if (this.parent) return this.parent.getMode();\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering params\r\n    */\r\n    getParams: function () {\r\n        if (this.parent) return this.parent.getParams();\r\n    },\r\n\r\n    /*\r\n    * Get current form type (ex. queryform, form)\r\n    */\r\n    getFormType: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        return form.properties.type || \"form\";\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () { },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () { },\r\n\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n        self.disposed = true;\r\n\r\n        setTimeout(function () {\r\n            if (self.subscribers != null) {\r\n                // Remove all subcriptions\r\n                $.each(self.subscribers, function (i, item) {\r\n                    self.unbind(item.event);\r\n                });\r\n            }\r\n            delete self.subscribers;\r\n\r\n            if (self.observableElement) self.observableElement.off();\r\n            bizagi.util.dispose(self);\r\n        }, bizagi.override.disposeTime || 50);\r\n    },\r\n\r\n    /*\r\n    *   Check if the current object is disposed\r\n    */\r\n    isDisposed: function () {\r\n        return this.disposed;\r\n    },\r\n\r\n    /*\r\n    *   This method process the error or alert messages coming from the server, and adds them to the validation controller\r\n    */\r\n    processFailMessage: function(message) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (message.errorType === \"CustomMessageException\") {\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            var error = bizagi.localization.getResource(message.message);\r\n            form.validationController.showErrorMessage(error);\r\n        } else if (message.errorType === \"InvalidCaseStateException\") {\r\n            var params = form.getParams()\r\n\r\n            form.validationController.clearValidationMessages();\r\n           \r\n            // Redirection Here\r\n            form.container.trigger(\"routing\", { idCase: params.idCase || bizagi.context.idCase });\r\n        } else {\r\n            var message = message || {};\r\n            message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n            var type = message.type || \"error\";\r\n            var code = message.code || \"code\";\r\n            message = message.responseText || (message.message || message);\r\n\r\n            // Omit processing when the ajax didn't process\r\n            if (type === \"not-processed\") return;\r\n            if (type === \"not-shown\") return;\r\n            if (isOfflineForm && code === \"AUTH_ERROR\") return;\r\n\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            if (type == \"alert\") {\r\n                form.validationController.showAlertMessage(message);\r\n            } else {\r\n                form.validationController.showErrorMessage(message);\r\n            }\r\n        }\r\n\r\n        return message;\r\n    },\r\n\r\n    /*\r\n    *   Sets a waiting overlay above the current element\r\n    */\r\n    startLoading: function () {  /* Override in implementations */ },\r\n\r\n    /*\r\n    *   Removes the waiting overlay\r\n    */\r\n    endLoading: function () { /* Override in implementations */ },\r\n\r\n    /**\r\n    *   Prepare control to remove it from the render, that allows to\r\n    *   clean all elements of the control or to do any stuff before to remove\r\n    */\r\n    beforeToRefresh: function () { /* Implement in each render and container if you need */ },\r\n\r\n    /**\r\n    *   Run before that the control has been refreshed\r\n    */\r\n    afterToRefresh: function () { /* Implement in each render and container if you need */ }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base container class with common stuff related to all containers\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.container\", {\r\n    TYPE_QUERY_FORM: \"queryForm\"\r\n}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n\r\n        if (data.elements) {\r\n            $.each(data.elements, function(i, element) {\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                } else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                } else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates a render element\r\n    */\r\n    createRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalElement;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.render.properties.editable = properties.editable;\r\n            if (element.render.properties.type == \"grid\")\r\n                element.render.properties.inlineEdit = false;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.render.properties.required = properties.required;\r\n        }\r\n\r\n        //clone originalElement to apply duplicate render properties correctly\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            originalElement = bizagi.clone(element);\r\n        }\r\n\r\n        var render = self.renderFactory.getRender({\r\n            type: element.render.properties.type,\r\n            data: element.render,\r\n            dataService: self.dataService,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Add to children\r\n        self.children.push(render);\r\n\r\n        // Check for duplicate\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            self.processDuplicateRender(render, originalElement);\r\n        }\r\n\r\n        //TODO: at this point not posible add the retype double at this point not exist input\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(render);\r\n    },\r\n    /*\r\n    *   Creates a container element\r\n    */\r\n    createContainerElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.container.properties.required = properties.required;\r\n        }\r\n\r\n        var container = self.renderFactory.getContainer({\r\n            type: element.container.properties.type,\r\n            data: element.container,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode(),\r\n            isDesign: self.getMode() === \"design\"\r\n        });\r\n\r\n        self.children.push(container);\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(container);\r\n    },\r\n    /*\r\n    *   Creates a form element\r\n    */\r\n    createFormElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        var form = self.renderFactory.getContainer({\r\n            type: (element.form.properties.type || \"form\"),\r\n            data: element.form,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode()\r\n        });\r\n        self.children.push(form);\r\n    },\r\n    /* \r\n    *   Gets the current container \r\n    */\r\n    getElement: function () {\r\n        var self = this;\r\n        return self.container;\r\n    },\r\n    /* \r\n    *   Gets a collection for all elements matching a type \r\n    */\r\n    getElementsByType: function (type, elements) {\r\n        elements = elements || [];\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.type == type) {\r\n                elements.push(child);\r\n            }\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.getElementsByType(type, elements);\r\n            }\r\n        });\r\n\r\n        return elements;\r\n    },\r\n    /*\r\n    *   Process renders with duplicate property\r\n    */\r\n    processDuplicateRender: function (render, element) {\r\n        var self = this;\r\n        var clonedElement = JSON.parse(JSON.encode(element.render));\r\n\r\n        // Changes properties\r\n        clonedElement.properties.displayName = clonedElement.properties.displayName + \" \" + self.getResource(\"render-text-duplicate-label-sufix\");\r\n        clonedElement.properties.xpath = clonedElement.properties.xpath + \".clone\";\r\n        clonedElement.properties.isClone = true;\r\n\r\n        // Creates clone\r\n        var clone = self.renderFactory.getRender({\r\n            type: clonedElement.properties.type,\r\n            data: clonedElement,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Associates with main render\r\n        render.cloneRender = clone;\r\n\r\n        // Add to collection\r\n        self.children.push(clone);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_CONTAINER;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    render: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            result;\r\n\r\n        // Render container\r\n        result = self.internalRender();\r\n\r\n        // Apply container defaults\r\n        self.applyContainerDefaults();\r\n\r\n        // Add container id\r\n        result.attr(\"data-container-id\", self.properties.id);\r\n\r\n        //Add container tag property\r\n        if (self.properties.tag) {\r\n            result.attr(\"data-tag\", self.properties.tag);\r\n        }\r\n\r\n        //Add class to the requested form, to specify if is add form, edit form, or detail form\r\n        if (self.params)\r\n            if (self.params.requestedForm)\r\n                result.addClass(self.params.requestedForm);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Internal  rendering\r\n    */\r\n    internalRender: function () {\r\n        var self = this;\r\n\r\n        // Render the container\r\n        var html = self.renderContainerHtml();\r\n\r\n        // Convert html string to jquery object\r\n        var container = self.container = $(html);\r\n\r\n        // Post-render\r\n        self.postRenderContainer(container);\r\n\r\n        return self.container;\r\n    },\r\n    /*\r\n    *   Renders container html\r\n    */\r\n    renderContainerHtml: function () {\r\n        var self = this;\r\n        // Start rendering deferred\r\n        self.renderingDeferred = self.renderingDeferred || new $.Deferred();\r\n\r\n        return this.renderContainer();\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred)\r\n            return false;\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.container))\r\n            alert(\"container hasn't been rendered!\");\r\n\r\n        return this.container;\r\n    },\r\n    /* \r\n    *   Set container defaults\r\n    */\r\n    applyContainerDefaults: function () {\r\n        var self = this,\r\n                properties = self.properties;\r\n\r\n        // Set customizations\r\n        if (properties.backgroundColor)\r\n            self.changeBackgroundColor(properties.backgroundColor);\r\n\r\n        // Set editability and visiblity\r\n        if (!properties.visible)\r\n            self.changeVisibility(properties.visible);\r\n    },\r\n    /* \r\n    *  Changes background color \r\n    */\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.backgroundColor = color;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeBackgroundColor(color);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeBackgroundColor(color);\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        // Hide - show the render\r\n        if (properties.visible) {\r\n            self.container.show();\r\n\r\n        } else {\r\n            self.container.hide();\r\n        }\r\n    },\r\n    /* Changes editability */\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeEditability(argument);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeEditability(argument);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Replaces a <x/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceTag: function (container, tag, replace) {\r\n        bizagi.util.replaceSelector(container, tag, replace);\r\n    },\r\n    /*\r\n    *   Replaces a <children/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceChildrenTag: function (container, replace) {\r\n        this.replaceTag(container, \".children\", replace);\r\n    },\r\n    /*\r\n    *   Replaces a {{children}} string in the specified element\r\n    */\r\n    replaceChildrenHtml: function (html, replace) {\r\n        return html.replace(\"{{children}}\", replace);\r\n    },\r\n    /*\r\n    *   Template method to render the container layout, returns a string with all the builded html,\r\n    *   must be overriden in all children\r\n    */\r\n    renderContainer: function () {\r\n    },\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred)\r\n            self.renderingDeferred.resolve();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        self.executeChildrenPostRender(container);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n            self.applyPlaceHolderPolyfill();\r\n\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    applyPlaceHolderPolyfill: function () {\r\n        var self = this;\r\n        var config = window.placeHolderConfig || {};\r\n        if (('placeholder' in $('<input>')[0] || 'placeHolder' in $('<input>')[0]) && !config.forceApply) {\r\n            // don't run the polyfill when the browser has native support\r\n            return;\r\n        }\r\n        Placeholders.enable();\r\n    },\r\n    /*\r\n    *   Process container children\r\n    */\r\n    executeChildrenPostRender: function (container) {\r\n        var self = this;\r\n        var childrenElements = container.children();\r\n\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                        child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                        child.postRenderContainer(childElement);\r\n                }\r\n            } else {\r\n                self.executeChildrenPostRender(childElement);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n\r\n    },\r\n    /**\r\n    *   Renders all children html\r\n    */\r\n    renderChildrenHtml: function () {\r\n        var self = this;\r\n        var temp = \"\";\r\n\r\n        $.each(self.children, function (i, child) {\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                temp += child.renderElement();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                temp += child.renderContainerHtml();\r\n            self.childrenHash[child.properties.uniqueId] = child;\r\n        });\r\n\r\n        return temp;\r\n    },\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    */\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.collectRenderValues(renderValues);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Check if the render can be sent to the server\r\n                    if (child.canBeSent()) {\r\n                        child.collectData(renderValues);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders and check if has changed\r\n    */\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        result = result || [];\r\n\r\n        if (!result.length) {\r\n            if(self.children){\r\n                $.each(self.children, function (i, child) {\r\n                    if (result.length || child.hasChanged(result)) {\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            return result;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *    Creates a json array parameters to search result\r\n    */\r\n    collectRenderValuesQueryForm: function (renderValues) {\r\n        var self = this;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValuesQueryForm(renderValues);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSentQueryForm()) {\r\n                    child.collectDataQueryForm(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Gets the first child\r\n    */\r\n    firstChild: function () {\r\n        return this.children[0];\r\n    },\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath, renders) {\r\n        var self = this;\r\n\r\n        renders = renders || [];\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath.indexOf(\"[\") > 0) {\r\n            xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n        }\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.getRenders(xpath, renders);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (xpath == child.properties.xpath) {\r\n                    renders.push(child);\r\n                }\r\n            }\r\n        });\r\n\r\n        return renders;\r\n    },\r\n    /* \r\n    *   Gets the first editable render \r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var result = null;\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                if (result == null)\r\n                    result = render;\r\n            }\r\n        });\r\n\r\n        // if no render has been found, skip editable condition\r\n        if (result == null) {\r\n            $.each(renders, function (i, render) {\r\n                result = render;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Gets all renders by xpath\r\n     */\r\n    getRendersByXpath: function (xpath) {\r\n        var self = this;\r\n        return self.getRenders(xpath);\r\n    },\r\n\r\n    /* \r\n    *   Gets a container by the id\r\n    */\r\n    getContainer: function (id) {\r\n        var self = this;\r\n\r\n        if (self.properties.id == id)\r\n            return this;\r\n\r\n        var result;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                var o = child.getContainer(id);\r\n                if (o != null) {\r\n                    result = o;\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n    /* \r\n    *   Validate all renders in the container \r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.isValid(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n\r\n        /*\r\n       *   Validate all grids in the container\r\n       */\r\n    hasValidGrids: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.hasValidGrids(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER && typeof (child.grid) != \"undefined\") {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n        var childrenPromises = $.map(self.children, function (child) {\r\n            return child.isReadyToSave();\r\n        });\r\n        return $.when.apply($, childrenPromises);\r\n    },\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                var result = child.getFocus();\r\n                if (!bizagi.util.isEmpty(result)) {\r\n                    focus = result;\r\n                }\r\n            }\r\n        });\r\n\r\n        return focus;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n    },\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        setTimeout(function () {\r\n            if (self.children) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current container\r\n    */\r\n    refreshContainer: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (data) {\r\n\r\n            if (!self.isDisposed()) {\r\n\r\n                // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n                self.unregisterChildren();\r\n                delete self.children;\r\n                delete self.childrenHash;\r\n\r\n                self.getFormContainer().removeActions();\r\n\r\n                // update editable\r\n                if (self.properties.editable === false) {\r\n                    data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n                }\r\n\r\n                // Update the data\r\n                self.initializeData(data.container);\r\n\r\n                // Render the container again\r\n                var currentContainer = self.container;\r\n                var result = self.render();\r\n\r\n                if (self.properties.type == \"tabItem\") {\r\n                    $(result).addClass(\"childrenActive\");\r\n                }\r\n\r\n                currentContainer.replaceWith(result);\r\n\r\n                // Rebind the actions\r\n                var actions = data.container && data.container.actions ? data.container.actions : [];\r\n                self.getFormContainer().refreshActions(actions);\r\n\r\n                self.triggerChildrenActions();\r\n\r\n                // Execute personalized stuff after to refresh it\r\n                self.afterToRefresh();\r\n\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the current container\r\n     */\r\n    refreshDesignContainer: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh(data);\r\n        //self.setActiveTab(data.elements);\r\n\r\n        $.extend(data.properties, {\r\n            editable: properties.editable,\r\n            contexttype: (properties.contexttype || \"\"),\r\n            idPageCache: properties.idPageCache,\r\n            idRender: properties.id,\r\n            messageValidation: properties.messageValidation,\r\n            uniqueId: properties.uniqueId,\r\n            visible:properties.visible,\r\n            xpath: properties.xpath,\r\n            mode: \"design\",\r\n            xpathContext: properties.xpathContext || \"\"\r\n        });\r\n\r\n\r\n        if (!self.isDisposed()) {\r\n            // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n            self.unregisterChildren();\r\n            delete self.children;\r\n            delete self.childrenHash;\r\n\r\n            // update editable\r\n            if (self.properties.editable === false) {\r\n                data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n            }\r\n\r\n            // Update the data\r\n            self.initializeData(data.container);\r\n\r\n            // Render the container again\r\n            var currentContainer = self.container;\r\n            var result = self.render();\r\n\r\n            if (self.properties.type == \"tabItem\") {\r\n                $(result).addClass(\"childrenActive\");\r\n            }\r\n\r\n            currentContainer && currentContainer.replaceWith(result);\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh();\r\n        }\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].beforeToRefresh();\r\n        }\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].afterToRefresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-execute children actions\r\n    */\r\n    triggerChildrenActions: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.triggerChildrenActions();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.triggerRenderChange({ changed: false });\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * register actions container\r\n    */\r\n    registerActions: function (actions) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (actions) {\r\n            form.actionController.buildActions(actions);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * unregister children container\r\n    */\r\n    unregisterChildren: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.unregisterChildren();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                form.unregisterRender(child);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Replace child\r\n    */\r\n    replaceChild: function (element) {\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.uniqueId == element.properties.uniqueId) {\r\n                children.splice(i, 1);\r\n                children.splice(i, 0, element);\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Gets child\r\n    */\r\n    getChildById: function (id) {\r\n\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.id == id) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.container\", {}, {\r\n    getMenu: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.menu;\r\n    },\r\n\r\n    /*\r\n     *   Starts waiting signal for async stuff\r\n     */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.container;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Ends waiting for async stuff\r\n     */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.container;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    }\r\n    \r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Render Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.render\", {\r\n    postRenderTimeout: 0,\r\n    maxRendersPerScreen: 50,\r\n    rendersExecuted: 0,\r\n    renderOptimization: false,\r\n    TYPE_QUERY_FORM: \"queryForm\",\r\n    startOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 500;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        // Cancelled optimization temporally, because its on experimental stage\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    },\r\n    stopOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 0;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    }\r\n}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.included = (typeof properties.included != \"undefined\") ? bizagi.util.parseBoolean(properties.included) : false;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.displayName = properties.displayName || \"\";\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.includedInResult = (typeof properties.includedInResult != \"undefined\") ? bizagi.util.parseBoolean(properties.includedInResult) : false;\r\n\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n        if (/^hidden$/i.test(renderType)) {\r\n            properties.visible = false;\r\n        }\r\n\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.maxLength = properties.maxLength || 0;\r\n        properties.helpText = bizagi.util.trim(properties.helpText) || \"\";\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.valueFormat = properties.valueFormat || {};\r\n        properties.isHidden = (typeof properties.isHidden != \"undefined\") ? bizagi.util.parseBoolean(properties.isHidden) : false;\r\n        properties.visible = (properties.isHidden) ? false : properties.visible;\r\n\r\n        // Old color and background color\r\n        if (properties.color) {\r\n            properties.textFormat.color = properties.color;\r\n        }\r\n\r\n        if (properties.backgroundColor) {\r\n            properties.textFormat.backgroundColor = properties.backgroundColor;\r\n        }\r\n\r\n        // Non-editable fields cannot be required\r\n        properties.required = properties.editable ? properties.required : false;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Check contexttype\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n\r\n        // Save original properties\r\n        self.originalProperties = {\r\n            textFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            valueFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            visible: properties.visible,\r\n            editable: properties.editable,\r\n            required: properties.required,\r\n            labelAlign: properties.labelAlign,\r\n            valueAlign: properties.valueAlign\r\n        };\r\n\r\n        // Create value property\r\n        self.value = typeof (properties.value) !== \"undefined\" ? properties.value : null;\r\n\r\n        // Register original value property\r\n        self.properties.originalValue = self.value;\r\n        self.properties.previousValue = self.value;\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n    /*\r\n    *   Calculate aligns, display types, rtl and widths\r\n    */\r\n    calculateInitialLayoutProperties: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set visual defaults\r\n        properties.displayType = properties.displayType || \"normal\";\r\n        properties.labelAlign = properties.labelAlign || self.getDefaultLabelAlign(properties.displayType);\r\n        properties.valueAlign = properties.valueAlign || self.getDefaultValueAlign(properties.displayType);\r\n\r\n        // Check rtl orientation\r\n        if (properties.orientation === \"rtl\") {\r\n            properties.labelAlign = self.getRTLAlign(properties.labelAlign);\r\n            properties.valueAlign = self.getRTLAlign(properties.valueAlign);\r\n        }\r\n\r\n        // Calculate render with\r\n        var renderWidth = self.calculateRenderWidth(properties.labelWidth, properties.valueWidth, properties.displayType);\r\n        properties.labelWidth = renderWidth.label;\r\n        properties.valueWidth = renderWidth.control;\r\n\r\n        if (properties.layoutType === \"percentage\") {\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.labelWidth == 0) {\r\n            properties.displayType = \"value\";\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.valueWidth == 0) {\r\n            properties.displayType = \"label\";\r\n        }\r\n\r\n        if (properties.type === \"userfield\") {\r\n            if (properties.displayType === \"both\") {\r\n                properties.valueWidth = properties.valueWidth || 50;\r\n                properties.labelWidth = properties.labelWidth || 50;\r\n            } else if (properties.displayType === \"vertical\") {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 100;\r\n            } else {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 0;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_RENDER;\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    render: function (renderTemplateName) {\r\n        return this.renderElement(renderTemplateName);\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    renderElement: function (renderTemplateName) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        // Start rendering deferred\r\n        self.renderingDeferred = new $.Deferred();\r\n\r\n        // Set render template\r\n        renderTemplateName = renderTemplateName || \"render\";\r\n        var renderTemplate = self.renderFactory.getTemplate(renderTemplateName);\r\n\r\n        // Resolve render label\r\n        var label = properties.displayName;\r\n        if (typeof label == \"string\") {\r\n            label = label.replaceAll(\"&\", \"&amp;\");\r\n            label = label.replaceAll(\"$\", \"&#36;\");\r\n            label = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            label = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n            label = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n            label = label.replaceAll(\"\\n\", \"<br/>\");\r\n        }\r\n\r\n        var isFullRender = bizagi.util.detectDevice() !== \"desktop\" && (properties.type === \"association\" || properties.type === \"uploadecm\" || ((properties.type === \"actionLauncher\" || properties.type === \"polymorphicLauncher\") && bizagi.util.isTabletDevice()) || (properties.type === \"grid\" && !bizagi.util.isTabletDevice()));\r\n        var labelWidth = parseFloat(properties.labelWidth);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(renderTemplate, {\r\n            label: label, helpText: properties.helpText,\r\n            editable: properties.editable,\r\n            isExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            tag: properties.tag,\r\n            displayType: properties.displayType,\r\n            displayOptionClass: self.getDisplayOptionClass(properties.displayType),\r\n            labelAlignClass: self.getAlignClass(properties.labelAlign),\r\n            valueAlignClass: self.getAlignClass(properties.valueAlign),\r\n            labelWidth: labelWidth,\r\n            stringLabelWidth: labelWidth + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            valueWidth: parseFloat(properties.valueWidth),\r\n            stringValueWidth: parseFloat(properties.valueWidth) + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            layoutType: properties.layoutType,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            printVersion: form.params.printversion,\r\n            cssClass: properties.cssclass || \"\",\r\n            includedInResult: properties.includedInResult,\r\n            included: properties.included,\r\n            type: properties.type,\r\n            showFullRender: isFullRender,\r\n            required: properties.required,\r\n            helpText: properties.helpText\r\n        });\r\n\r\n        // Render internal control html\r\n        var result = self.internalRenderControl();\r\n        if (!result) {\r\n            result = \"\";\r\n        }\r\n\r\n        // Check if this is an async element or not\r\n        var async = typeof (result) === \"object\" && result.done;\r\n        if (!async) {\r\n            html = self.replaceControlHtml(html, result);\r\n\r\n        } else {\r\n            if (result.state() === \"resolved\") {\r\n                // Fetch resolved result\r\n                html = self.replaceControlHtml(html, self.resolveResult(result));\r\n                self.asyncRenderDeferred = null;\r\n            } else {\r\n                // Wait for result\r\n                self.asyncRenderDeferred = result;\r\n                html = self.replaceControlHtml(html, \"\");\r\n            }\r\n        }\r\n\r\n        return html;\r\n    },\r\n    /*\r\n    *   Returns the resolved result from a promise when the promise has been executed already\r\n    */\r\n    resolveResult: function (promise) {\r\n        return bizagi.resolveResult(promise);\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred) {\r\n            return false;\r\n        }\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Renders the control html\r\n    */\r\n    internalRenderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.control = null;\r\n\r\n        if (self.renderFactory.printVersion) {\r\n            properties.editable = false;\r\n            return self.renderControl();\r\n        } else if (properties.editable) {\r\n            return self.renderControl();\r\n        }\r\n\r\n        return self.renderReadOnly();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set element variable\r\n        self.element = element;\r\n\r\n        if (properties.submitOnChange)\r\n            self.configureSubmitOnChange();\r\n\r\n        // Process internal layout\r\n        isLabelFormat = true;\r\n\r\n        var executePostRender = function (_element) {\r\n            if (bizagi.rendering.render.renderOptimization &&\r\n                bizagi.rendering.render.rendersExecuted > bizagi.rendering.render.maxRendersPerScreen) {\r\n\r\n                // Execute post-render control\r\n                setTimeout(function () {\r\n                    self.internalPostRender(_element);\r\n                    bizagi.rendering.render.postRenderTimeout += 50;\r\n                }, bizagi.rendering.render.postRenderTimeout);\r\n\r\n            } else {\r\n                self.internalPostRender(_element);\r\n            }\r\n            bizagi.rendering.render.rendersExecuted++;\r\n        };\r\n\r\n        if (self.asyncRenderDeferred) {\r\n            // Wait for async result\r\n            $.when(self.asyncRenderDeferred)\r\n                .done(function (html) {\r\n                    var control = self.getControl();\r\n                    if (typeof self.emptyControlByAsyncRenderDeferred == \"function\") {\r\n                        self.emptyControlByAsyncRenderDeferred();\r\n                    }\r\n                    control.append(html);\r\n\r\n                    // Execute post-render control\r\n                    executePostRender(element);\r\n                    self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n                });\r\n        } else {\r\n            // Execute post-render control\r\n            executePostRender(element);\r\n        }\r\n    },\r\n    /*\r\n    *   Executes the post render handlers\r\n    */\r\n    internalPostRender: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        self.control = self.getControl();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred) {\r\n            self.renderingDeferred.resolve();\r\n        }\r\n\r\n        // Execute post-renders\r\n        if (properties.editable) {\r\n            // Post-render editable version\r\n            if (self.renderFactory.printVersion && self.postRenderPrintVersion) {\r\n                self.postRenderPrintVersion();\r\n            } else {\r\n                self.postRender();\r\n            }\r\n\r\n        } else {\r\n            // Post-render readonly version\r\n            self.postRenderReadOnly(element);\r\n        }\r\n\r\n        // Perform execution mode methods\r\n        if (mode == \"execution\") {\r\n            self.performExecutionModeMethods();\r\n        } else {\r\n            self.performDesignModeMethods();\r\n        }\r\n\r\n        self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n        self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n    },\r\n    /*\r\n    *   Execute runtime only methods\r\n    */\r\n    performExecutionModeMethods: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (self.getFormType() == self.Class.TYPE_QUERY_FORM) {\r\n            self.configureHandlersQueryForm();\r\n        }\r\n\r\n        // Apply handlers\r\n        if (properties.editable) {\r\n            self.configureHandlers();\r\n        } else {\r\n            self.configureHandlersReadOnly();\r\n        }\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        var self = this;\r\n\r\n        // Execute custom code for each render\r\n        self.configureDesignView();\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /*\r\n    *   Replaces a {{control}} string in the specified element\r\n    */\r\n    replaceControlHtml: function (html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n        return html.replace(\"{{control}}\", replace);\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.element)) {\r\n            bizagi.log(\" render hasn't been rendered!\", this, \"error\");\r\n        }\r\n\r\n        return this.element;\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.internalSetInitialValueFlag = true;\r\n\r\n        // Set the initial value\r\n        if (properties.editable) {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        } else {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        }\r\n        self.internalSetInitialValueFlag = false;\r\n    },\r\n    /*\r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var inlineAdd = self.grid && self.grid.properties && self.grid.properties.inlineAdd;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false && !inlineAdd) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            var form = self.getFormContainer();\r\n            var hasValue = false;\r\n            var renders = self.grid ? [self] : form.getRenders(properties.xpath);\r\n            var isQueryForm = /^query/i.test(properties.type);\r\n\t               \r\n            renders.filter(function (render) {\r\n                return render.properties.id == properties.id;\r\n            }).forEach(function (render) {\r\n                if (render.hasValue() && (render.properties.editable || inlineAdd)) {\r\n                    hasValue = true;\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            if (!hasValue && !self.properties.isClone) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                var messageData = {xpath: properties.xpath, message: message};\r\n\r\n                if (isQueryForm) {\r\n                    messageData = $.extend({}, messageData, {\r\n                        id: properties.id,\r\n                        isQuery: isQueryForm\r\n                    });\r\n                }\r\n\r\n                invalidElements.push(messageData);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Check retypes\r\n        if (properties.retype == \"duplicate\") {\r\n            // Don't process cloned renders, just originals\r\n            if (self.cloneRender) {\r\n                if (self.cloneRender.getValue() != self.getValue()) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        } else if (properties.retype == \"double\") {\r\n            var control = $(\"input\", self.element);\r\n\r\n            //Waits until the control has the second value written\r\n            if (control && control.data(\"oldValue\")) {\r\n                if (control.val() === \"\") {\r\n\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({\r\n                        xpath: properties.xpath,\r\n                        message: message\r\n                    });\r\n\r\n                    return false;\r\n                } else if (control.val() != control.data(\"oldValue\")) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check maxlength\r\n        var columnEditable = self.grid && self.grid.getColumn ? self.grid.getColumn(self.properties.xpath).properties.editable : true;\r\n        if (properties.type !== \"userPassword\" && properties.maxLength !== undefined && properties.maxLength > 0 && bizagi.util.isNumeric(properties.maxLength)) {\r\n            if (columnEditable || (!columnEditable && self.controlValueIsChanged())) {\r\n                var maxLength = new Number(properties.maxLength);\r\n                var value = self.getValue();\r\n\r\n                if (value && value.toString().length > maxLength) {\r\n                    message = self.getResource(\"render-text-maxLength-error\").replaceAll(\"#maxLength#\", maxLength);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        // Next line decides if only spaces are accepted as valid texts or not. Anyway the spaces are still saved as self.value has not changed\r\n        var value = self.getValue();\r\n        value = (value && self.properties.type === \"text\") ? value.trim() : value;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {       \r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n    */\r\n    configureHandlersReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.getControl() == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        if (format.color) {\r\n            self.changeColor(format.color, isLabelFormat);\r\n        }\r\n        if (format.background) {\r\n            self.changeBackgroundColor(format.background);\r\n        }\r\n        //if bold is true in modeler, we receive nothing in execution (!formal.bold)\r\n        if (format.bold || !format.bold || !isLabelFormat) {\r\n            self.changeFontBold(format.bold, isLabelFormat);\r\n        }\r\n        if (format.italic) {\r\n            self.changeFontItalic(format.italic, isLabelFormat);\r\n        }\r\n        if (format.underline) {\r\n            self.changeFontUnderline(format.underline, isLabelFormat);\r\n        }\r\n        if (format.strikethru) {\r\n            self.changeFontStrikethru(format.strikethru, isLabelFormat);\r\n        }\r\n        if (format.size) {\r\n            self.changeFontSize(format.size, isLabelFormat);\r\n        }\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n        if (!visible) {\r\n            self.changeVisibility(visible);\r\n        }\r\n    },\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (!(bizagi.util.identicalObjects(value, self.value))) {\r\n            // set previous value\r\n            self.properties.previousValue = self.properties.originalValue = self.value;\r\n\r\n            // Change internal value\r\n            self.value = self.properties.value = value;\r\n            if (self.properties.required && self.getMode() == \"execution\") {\r\n\r\n                if (self.checkRequired([])) {\r\n                    self.changeRequiredLabel(false);\r\n                } else {\r\n                    self.changeRequiredLabel(true);\r\n                }\r\n            }\r\n\r\n            // Trigger events\r\n            if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n                self.triggerRenderChange();\r\n                self.triggerRenderValidate();\r\n            }\r\n        }\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (!self.hasValue()) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    validateInputRetype: function () {\r\n        var self = this;\r\n        if (self.properties.retype && self.cloneRender) {\r\n            return self.getValue() == self.cloneRender.getValue();\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Triggers the render change event\r\n    */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.changed = params.changed !== undefined ? params.changed : true;\r\n        self.triggerHandler(\"renderchange\", {render: self, changed: params.changed});\r\n    },\r\n    /*\r\n    *   Triggers the render validate event\r\n    */\r\n    triggerRenderValidate: function () {\r\n        var self = this;\r\n        self.triggerHandler(\"rendervalidate\", {render: self});\r\n    },\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable && (self.properties.display !== \"check\" || (self.properties.display === \"check\" && bizagi.override.enableCheck === true))) {\r\n            // Render as simple value\r\n            var displayValue = self.getDisplayValue(value);\r\n            if (typeof (displayValue) == \"string\" || typeof (displayValue) == \"number\") {\r\n                displayValue = bizagi.util.sanitizeHTML(displayValue);\r\n                $(control).html(\"<label class='readonly-control'>\" + displayValue + \"</label>\");\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the internal value\r\n    */\r\n    getValue: function () {\r\n        return this.value;\r\n    },\r\n    /*\r\n    *   Returns the value to display, ex. non-editable renders\r\n    */\r\n    getDisplayValue: function () {\r\n        return this.getValue();\r\n    },\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        bizagi.util.mustImplement(\"getLabel\");\r\n    },\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        bizagi.util.mustImplement(\"getControl\");\r\n    },\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        bizagi.util.mustImplement(\"getControlFiller\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n    },\r\n    /*\r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        this.validationMessage = message;\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var result = this.getValue();\r\n        var readOnlyValue = \"\";\r\n\r\n        if (bizagi.util.isObject(result) && typeof (result.value) !== \"undefined\") {\r\n            readOnlyValue = bizagi.util.sanitizeHTML(result.value);\r\n        } else if (!bizagi.util.isEmpty(result)) {\r\n            if (bizagi.util.isString(result)) {\r\n                readOnlyValue = bizagi.util.decodedDisplayValue(result);\r\n            } else {\r\n                readOnlyValue = result;\r\n            }\r\n        }\r\n\r\n        return readOnlyValue;\r\n    },\r\n\r\n    /*\r\n    *  Method to render print version\r\n    */\r\n    postRenderPrintVersion: function () {\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        this.properties.displayType = displayType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        this.properties.labelAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        this.properties.valueAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label and value width\r\n    */\r\n    customizeRenderWidth: function () {\r\n    },\r\n\r\n    /* Customizes render color*/\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    if (self.properties.type == \"grid\") {\r\n                        self.getControl().find(\".bz-mobile-grid__header-title\").each(function () {\r\n                            this.style.setProperty('color', color, 'important');\r\n                        });\r\n                    }\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n                    if (self.properties.editable === false) {\r\n                        self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                        self.getElementsToStylize($(\"label\", self.getControl()).css(\"color\", color, \"!important\"));\r\n                    }\r\n                }\r\n            } else {\r\n                self.element.css(\"color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"color\", \"\");\r\n                self.getControl().css(\"color\", \"\");\r\n\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    self.getElementsToStylize(element).css(\"color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes render background color*/\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                self.element.each(function () {\r\n                    this.style.setProperty('background-color', color, 'important');\r\n                });\r\n\r\n                if (typeof (label.find('label').style) !== \"undefined\") {\r\n                    self.getLabel().find(\"label\").style(\"background-color\", color, \"important\");\r\n                } else {\r\n                    self.getLabel().find(\"label\").css(\"background-color\", color, \"!important\");\r\n                }\r\n\r\n                var currentStyle = self.getLabel().attr(\"style\");\r\n                currentStyle += \"; background-color:\" + color + \"!important\";\r\n                self.getLabel().attr(\"style\", currentStyle);\r\n            } else {\r\n                self.element.css(\"background-color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"background-color\", \"\");\r\n                self.getControl().css(\"background-color\", \"\");\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    $(element).css(\"background-color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Returns the formatting label to be used for bold, italic, underline, strikethrough and size*/\r\n    getFormattingLabel: function () {\r\n        var self = this;\r\n        return self.getLabel().find(\"label\");\r\n    },\r\n\r\n    /* Customizes the font weight */\r\n    changeFontBold: function (bold, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(bold) != false && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"font-weight\", \"bold\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n            });\r\n\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"font-weight\", \"normal\", \"!important\");\r\n        }\r\n        if (!isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(bold) == true) {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n                });\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"normal\", \"!important\");\r\n                });\r\n                self.getControl().css(\"font-weight\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n        var result = true;\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (renderType === \"grid\" && self.ready().state() === \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\",\"radio\", \"queryRadio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n            if (value && value.length !== undefined) {\r\n                value = value[0];\r\n            }\r\n            if (compareValue && compareValue.length !== undefined) {\r\n                compareValue = compareValue[0];\r\n            }\r\n            if (baseValue && baseValue.length !== undefined) {\r\n                baseValue = baseValue[0];\r\n            }\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            baseValue = baseValue && baseValue.id ? baseValue.id : baseValue;\r\n            if (typeof baseValue != \"undefined\" && baseValue != null) {\r\n                result = (compareValue == value) && (compareValue != baseValue) ? false : true;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"boolean\" || renderType === \"queryBoolean\" || renderType === \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (renderType === \"searchNumber\") {\r\n            result = !!(value);\r\n        } else if (renderType === \"number\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"text\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"date\") {\r\n            if (!compareValue && !value) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"actionLauncher\") {\r\n            //Object must be an array\r\n            result = false;\r\n            var compareValueObj = [];\r\n            try {\r\n                if (typeof compareValue === \"string\") {\r\n                    compareValueObj = JSON.parse(compareValue);\r\n                } else {\r\n                    compareValueObj = compareValue;\r\n                }\r\n            } catch (e) {\r\n            }\r\n\r\n            var _findAction = function (guid, targetObj) {\r\n                guid = guid || \"\";\r\n                targetObj = targetObj || [];\r\n                var result = false;\r\n                for (var i = 0, l = targetObj.length; i < l; i++) {\r\n                    if (targetObj[i].guidAction == guid) {\r\n                        result = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n\r\n            if (compareValueObj.length == value.length) {\r\n                for (var i = 0, l = compareValueObj.length; i < l; i++) {\r\n                    if (!_findAction(compareValueObj[i].guidAction, value)) {\r\n                        result = true;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"polymorphicLauncher\" || renderType === \"entityTemplate\") {\r\n            //Object must be an array\r\n            if (compareValue.length != value.length) {\r\n                result = true;\r\n            } else {\r\n                result = (JSON.encode(value) == JSON.encode(compareValue)) ? false : true;\r\n            }\r\n        } else if (renderType === \"image\") {\r\n            if (compareValue == null && value.indexOf(true) < 0) {\r\n                result = false;\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"searchList\") {\r\n            var objectValue = {};\r\n            try {\r\n                objectValue = JSON.parse(value);\r\n            } catch (e) {\r\n                console.log(\"Error when detect change value on searchList control\")\r\n            }\r\n            result = (JSON.encode(compareValue) == JSON.encode(objectValue.value)) ? false : true;\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /* Customizes the font italic style */\r\n    changeFontItalic: function (italic, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"italic\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"italic\", \"!important\");\r\n                }\r\n            } else {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"normal\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"normal\", \"!important\");\r\n                }\r\n            }\r\n        } else {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n            } else {\r\n                self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font underline */\r\n    changeFontUnderline: function (underline, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var strikethru = bizagi.util.parseBoolean(textFormat.strikethru) ? \"line-through \" : \"\";\r\n        var valuestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(underline) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", strikethru + \"underline\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                self.getElementsToStylize(element).css(\"text-decoration\", strikethru + \"underline\");\r\n            });\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", strikethru, \"!important\");\r\n        }\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(underline) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font Strikethrough property */\r\n    changeFontStrikethru: function (strikethru, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var underline = bizagi.util.parseBoolean(textFormat.underline) ? \"underline \" : \"\";\r\n        var valueunderline = bizagi.util.parseBoolean(valueFormat.underline) ? \"underline \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(strikethru) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", underline + \"line-through\", \"!important\");\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", underline, \"!important\");\r\n        }\r\n\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(strikethru) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                }\r\n            } else {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline, \"!important\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font size property */\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (size != \"0\") {\r\n            var label = self.getFormattingLabel();\r\n            var newFontSize = (100 + Number(size) * 10) + \"%\";\r\n            if (isLabelFormat) {\r\n                label.css(\"font-size\", newFontSize, \"!important\");\r\n            }\r\n            if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n                var control = self.getControl();\r\n                if (typeof control.children() == \"object\" && control.children().length > 0) {\r\n                    self.getElementsToStylize(control.children()).css(\"font-size\", newFontSize, \"!important\");\r\n                } else {\r\n                    self.getElementsToStylize(control).css(\"font-size\", newFontSize, \"!important\");\r\n                    // Next line applies to Cascading combo and combo in order to increase the control space with large value fonts\r\n                    if (self.properties.type.indexOf(\"ombo\") != -1 && size > 4) (\".ui-selectmenu\", control).children(0).height(2 * size + 20);\r\n                }\r\n\r\n                self.getElementsToStylize(control.find(\".ui-bizagi-render-date\")).css(\"line-height\", \"normal\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * in mobiles, don't apply styles to icon's elements\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(context);\r\n    },\r\n\r\n    /* Changes the render visibility*/\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            if (properties.type !== \"hidden\") {\r\n                self.element.show();\r\n                self.element.css(\"display\", \"\");\r\n\r\n                if (properties.required) {\r\n                    if (!self.hasValue()) {\r\n                        self.changeRequiredLabel(true);\r\n                    }\r\n                }\r\n            }\r\n        } else if (self.element) {\r\n            self.element.hide();\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n    /* Changes the render editability*/\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Renders again\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Clears control\r\n        control.empty();\r\n\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (typeof self.emptyControlByChangeEditability == \"function\")\r\n                    self.emptyControlByChangeEditability();\r\n                if (!self.asyncRenderDeferred)\r\n                    control.append(html);\r\n                self.postRenderElement(self.element);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * change cell editability and attach bindings\r\n    */\r\n    changeEditabilityCellControl: function (argument, key, xpath) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        var renderColumn = self.grid.getColumn(xpath);\r\n        var decorated = renderColumn.getDecorated(key);\r\n\r\n        // Renders again\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Clears control\r\n        control.empty();\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (!self.asyncRenderDeferred) {\r\n                    control.append(html);\r\n                }\r\n\r\n                self.postRenderElement(self.element);\r\n\r\n                if (properties.editable) {\r\n\r\n                    renderColumn.bind(\"rendered\", function () {\r\n                        renderColumn.readyDeferred.resolve();\r\n                    });\r\n\r\n                    decorated.unbind(\"renderchange\");\r\n\r\n                    // If the render changes set the flag on\r\n                    decorated.bind(\"renderchange\", function (render, args) {\r\n                        renderColumn.changed = true;\r\n                        self.grid.onCellChange(renderColumn, null, key, args);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (self.getMode() == \"execution\" && self.checkRequired([])) {\r\n            self.changeRequiredLabel(false);\r\n        } else if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * Does't change internal value of control, if you need it\r\n     * please use changeRequired method\r\n     *\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /*\r\n    *   Refresh the control with a new data\r\n    */\r\n    refreshControl: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalValue = self.value;\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id || \"\";\r\n\r\n        args = args || {};\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the ajax service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            idForm: idForm\r\n        })).pipe(function (data) {\r\n            // Clear variables\r\n            self.control = self.controlFiller = self.label = null;\r\n\r\n            // Update properties data\r\n            var currentElement = self.element;\r\n            self.initializeData(data.render);\r\n\r\n            // Render the control again\r\n            return $.when(self.render()).pipe(function (html) {\r\n                var result = $(html);\r\n                //Dont remove unused rendered var\r\n                var rendered = self.postRenderElement(result);\r\n                self.properties.originalValue = self.value;\r\n                return result;\r\n            }).pipe(function (result) {\r\n                // When the content has been post-renderized, replace it\r\n                currentElement.replaceWith(result);\r\n\r\n                // Prevent multiple refresh on grid\r\n                if (!self.grid) {\r\n                    self.triggerRenderChange({changed: false});\r\n                }\r\n\r\n                // Execute personalized stuff before to refresh it\r\n                self.afterToRefresh();\r\n            });\r\n\r\n        }).fail(function (message) {\r\n            var message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the control with a new data\r\n     */\r\n    refreshDesignControl: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Clear variables\r\n        self.control = self.controlFiller = self.label = null;\r\n\r\n        $.extend(data.render.properties, {\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: (properties.xpathContext || \"form\"),\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        // Update properties data\r\n        var currentElement = self.element;\r\n        self.initializeData(data.render);\r\n\r\n        // Render the control again\r\n        return $.when(self.render()).pipe(function (html) {\r\n            var result = $(html);\r\n            //Dont remove unused rendered var\r\n            var rendered = self.postRenderElement(result);\r\n            self.properties.originalValue = self.value;\r\n            return result;\r\n        }).pipe(function (result) {\r\n            // When the content has been post-renderized, replace it\r\n            currentElement.replaceWith(result);\r\n            self.triggerRenderChange();\r\n\r\n            // Execute personalized stuff before to refresh it\r\n            self.beforeToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(\"\");\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else if (self.properties.editable === false) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Updates original value for some comparisons\r\n    */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value;\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[properties.xpath] = value;\r\n                } else if (value === \"\" || value === null) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, otherwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Configure aditional Handlers for queryForm type\r\n    */\r\n    configureHandlersQueryForm: function () {\r\n        var self = this;\r\n        var checkIncluded = self.element.find(\".ui-bizagi-render-control-included\");\r\n        checkIncluded.change(function () {\r\n            self.properties.included = $(this).is(\":checked\");\r\n        });\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var queryValue = null;\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\") {\r\n                var isObject = typeof (value.id) !== \"undefined\";\r\n                if (isObject) {\r\n                    queryValue = (!bizagi.util.isEmpty(value.id)) ? [value] : null;\r\n                } else {\r\n                    queryValue = (value !== \"\") ? value : null;\r\n                }\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n\r\n                if (!(properties.display == \"check\" && properties.value == false)) {\r\n\r\n                    var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                    searchType = searchType.toUpperCase();\r\n                    var newParameter = {\r\n                        \"value\": queryValue,\r\n                        \"included\": self.properties.included,\r\n                        \"xpath\": properties.xpath,\r\n                        \"searchType\": searchType,\r\n                        \"orderType\": \"NONE\"\r\n                    };\r\n                    if (typeof properties.displayXpath !== \"undefined\" && properties.displayXpath !== \"\") {\r\n                        //newParameter.displayXpath= properties.xpath+\".\"+properties.displayXpath;\r\n                        newParameter.displayXpath = properties.displayXpath;\r\n                    }\r\n                    renderValues.push(newParameter);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n        var editable = properties.editable;\r\n\r\n        // The render can be sent if it is editable and is not \"display only\"\r\n        if (!displayOnly && editable) {\r\n            return true;\r\n        }\r\n\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n\r\n        if (properties.xpath) {\r\n            var form = self.getFormContainer();\r\n            if (form.getRenders(properties.xpath).length == 1) {\r\n                force = $.forceCollectData ? $.forceCollectData.toString() : false;\r\n                $.forceCollectData = force ? undefined : $.forceCollectData;\r\n                if (self.controlValueIsChanged()) {\r\n                    $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n                    return true;\r\n                }\r\n                $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *  Method to determine if the render value can be sent to search\r\n    */\r\n    canBeSentQueryForm: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function (time) {\r\n        var self = this;\r\n\r\n        // Focus is only allowed when the render is visible\r\n        if (!self.properties.visible) return;\r\n\r\n        // Call base\r\n        this._super();\r\n        var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n\r\n        // Configures effect\r\n        var effect = function () {\r\n            var control = self.getControl();\r\n            var defaultControl = (self.properties.type != \"grid\") ? $(\"input, select, option, textarea\", control) : $(\"input, select, option, textarea\", control).first();\r\n            if (defaultControl.length > 0) {\r\n\r\n                // Focus control\r\n                $.each(defaultControl, function (i) {\r\n                    var innerControl = defaultControl[i];\r\n                    if ($(innerControl).attr(\"type\") != \"hidden\" && $(innerControl).css(\"display\") != \"none\" && $(innerControl).css(\"visibility\") != \"hidden\") {\r\n\r\n                        try {\r\n                            if (!bizagi.util.isIE()) {\r\n                                bizagi.util.autoScrollBottom(layout);\r\n                            }\r\n                            innerControl.focus();\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // Wait until the render is ready to apply the focus effect\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Run effect\r\n                if (time > 0) {\r\n                    setTimeout(effect, time);\r\n                } else {\r\n                    effect();\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Resolves default align for each display type\r\n    */\r\n    getDefaultLabelAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n\r\n    /*\r\n    *   Resolves default value align for each display type\r\n    */\r\n    getDefaultValueAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n    /*\r\n    *   Transform the align type when using RTL orientation\r\n    */\r\n    getRTLAlign: function (align) {\r\n        /* if (align === \"default\"){ \r\n            return \"right\";\r\n        } */\r\n        return align;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = \"\";\r\n\r\n        if (!properties.editable) return;\r\n\r\n        // Build action\r\n        properties.dependencies = properties.dependencies || 'all';\r\n\r\n        if (properties.xpath) {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.xpath;\r\n            } else {\r\n                xpath = properties.xpath;\r\n            }\r\n        } else {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.id;\r\n            } else {\r\n                xpath = properties.id;\r\n            }\r\n        }\r\n\r\n        var action = {\r\n            \"conditions\": {\r\n                \"expressions\": [\r\n                    {\r\n                        \"simple\": {\r\n                            \"xpath\": xpath,\r\n                            \"operator\": \"changes\",\r\n                            \"argumentType\": \"const\"\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            \"commands\": [\r\n                {\r\n                    \"xpath\": xpath,\r\n                    \"command\": 'submit-value',\r\n                    \"argument\": properties.dependencies\r\n                }\r\n            ],\r\n            \"dependencies\": [xpath],\r\n            \"elseCommands\": []\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready()).done(function () {\r\n            var form = self.getFormContainer();\r\n            form.addSubmitAction(xpath, action);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    submitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Add context parameter\r\n        if (self.properties.contexttype != \"\" && data) {\r\n            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = self.properties.contexttype;\r\n        }\r\n\r\n        $.when(self.isReadyToSave()).done(function () {\r\n            self.internalSubmitOnChange(data, bRefreshForm, notCollect).done(function () {\r\n                defer.resolve();\r\n            }).fail(function () {\r\n                defer.reject();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getCacheIdCase: function () {\r\n        var self = this;\r\n        var idCase = self.getParams().idCase;\r\n\r\n        if (bizagi.cache === undefined) {\r\n            bizagi.cache = {};\r\n            bizagi.cache.idCaseObject = {\r\n                idCase: idCase !== undefined ? idCase : (bizagi.cache.idCase !== undefined ? bizagi.cache.idCase : undefined)\r\n            };\r\n        } else {\r\n            if (idCase !== undefined && bizagi.cache.idCaseObject !== undefined) {\r\n                bizagi.cache.idCaseObject.idCase = idCase;\r\n            } else {\r\n                if (idCase !== undefined && bizagi.cache.idCaseObject === undefined) {\r\n                    bizagi.cache.idCaseObject = {};\r\n                    bizagi.cache.idCaseObject.idCase = idCase;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (idCase === undefined) {\r\n            if (bizagi.cache.idCaseObject === undefined) {\r\n                idCase = undefined;\r\n            } else {\r\n                idCase = bizagi.cache.idCaseObject.idCase;\r\n            }\r\n        } else {\r\n            idCase = idCase;\r\n        }\r\n\r\n        return idCase;\r\n    },\r\n    /*\r\n    *   Internal method\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    internalSubmitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n        var parameters = {\r\n            data: data,\r\n            bRefreshForm: bRefreshForm,\r\n            notCollect: notCollect,\r\n            properties: {\r\n                idCase: self.getCacheIdCase(),\r\n                id: properties.id,\r\n                xpath: properties.xpath,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }\r\n        }\r\n\r\n        return form.internalSubmitOnChange(parameters);\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Calculates render label and value width\r\n    */\r\n    calculateRenderWidth: function (labelWidth, valueWidth, displayType) {\r\n        var self = this;\r\n        // Read values\r\n        // If the label width or the value width are 0, the BAS means that no value is used, so we need to adjust them to 50%\r\n        if (valueWidth == \"100\" && typeof labelWidth === \"undefined\") {\r\n            labelWidth = \"0\";\r\n        } else {\r\n            labelWidth = labelWidth ? (labelWidth != \"0\" ? labelWidth : \"50\") : \"50%\";\r\n        }\r\n        valueWidth = valueWidth ? (valueWidth != \"0\" ? valueWidth : \"50\") : \"50%\";\r\n\r\n        if (displayType == \"normal\" || displayType == \"both\" || displayType == \"reversed\") {\r\n\r\n            // Special case with lower values, so they want both fields in \"auto\" width\r\n            if (labelWidth && bizagi.util.percent2Number(labelWidth) < 5 &&\r\n                valueWidth && bizagi.util.percent2Number(valueWidth) < 5) {\r\n                return {label: 0, control: 100};\r\n            }\r\n            // Normalize percentages\r\n            if (labelWidth && !valueWidth) {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = 100 - labelWidth;\r\n\r\n            } else if (!labelWidth && valueWidth) {\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n                labelWidth = 100 - valueWidth;\r\n            } else {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n\r\n                // Check 100% percentage\r\n                if ((labelWidth + valueWidth) != 100 && typeof (self.properties) != \"undefined\" && self.properties.layoutType != \"pixels\") {\r\n                    valueWidth = 100 - labelWidth;\r\n                }\r\n            }\r\n        } else {\r\n            labelWidth = 100;\r\n            valueWidth = 100;\r\n        }\r\n\r\n        return {label: labelWidth, control: valueWidth};\r\n    },\r\n    /*\r\n    *   Get param value idCase\r\n    */\r\n    getIdCase: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idCase || bizagi.context.idCase;\r\n    },\r\n    /*\r\n    *   Get param value idWorkitem\r\n    */\r\n    getIdWorkitem: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idWorkitem || bizagi.context.idWorkitem;\r\n    },\r\n    /*\r\n    *   Get param value idTask\r\n    */\r\n    getidTask: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idTask || bizagi.context.idTask;\r\n    },\r\n    /*\r\n    *   Get param value sessionId\r\n    */\r\n    getSessionId: function () {\r\n        var self = this;\r\n        return self.getFormContainer().properties.sessionId;\r\n    },\r\n\r\n    /*\r\n    *   CELL STUFF\r\n    *   TODO: Move to other place\r\n    */\r\n\r\n    /* Customizes cell color*/\r\n    changeCellColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (control) {\r\n            if (color != 'none') {\r\n                control.css(\"color\", color);\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", color);\r\n                });\r\n            } else {\r\n                control.css(\"color\", \"\");\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", \"\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Customizes cell background color\r\n     * @param color\r\n     */\r\n    changeCellBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var backgroundColor = \"\";\r\n        var backgroundImage = \"\";\r\n\r\n        if (control) {\r\n            if (color != 'none') {\r\n                backgroundColor = color;\r\n                backgroundImage = \"none\";\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                var needBGPaint = false;\r\n\r\n                control.find(\"input, textarea, .ui-selectmenu\").each(function (i, element) {\r\n\r\n                    if (((element.type == \"text\") || (element.type == \"textarea\")) && !($(element).hasClass('ui-select-data')))\r\n                        needBGPaint = true;\r\n\r\n                    $(element).css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n\r\n                if (!needBGPaint) {\r\n                    control.closest(\"td\").each(function (i, element) {\r\n                        $(element).css({\r\n                            \"background-color\": backgroundColor,\r\n                            \"background-image\": backgroundImage\r\n                        });\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                control.each(function (i, element) {\r\n                    //TODO: Validar si se aplican los estilos en tablet aun sin esta linea, cuidado con desktop\r\n                    var item = ($(element).hasClass(\"ui-bizagi-cell-readonly\")) ? control.closest(\"td\") : $(element);\r\n                    item.css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * Changes the cell visibility\r\n     * @param argument\r\n     */\r\n    changeCellVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Hide - show the render\r\n            if (bizagi.util.parseBoolean(argument) == true) {\r\n                //control.show();\r\n                control.css(\"visibility\", \"visible\");\r\n                control.css(\"display\", \"\");\r\n\r\n                self.element && self.element.show();\r\n            } else {\r\n                //control.hide();\r\n                control.css(\"visibility\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n\r\n    /**\r\n     * Changes the cell required\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Check if argument is true and control donot have any value\r\n            if (bizagi.util.parseBoolean(argument) == true && bizagi.util.isEmpty(self.value)) {\r\n                control.addClass('control-required');\r\n                control.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            } else {\r\n                control.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", control).remove();\r\n            }\r\n            // Update properties\r\n            properties.required = argument;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to create deferred at the moment to start multiaction\r\n     */\r\n    startActionExecution: function () {\r\n        var self = this;\r\n        self.startLoading();\r\n        self.actionExecutionDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * method to resolve the deferred when multiaction finish\r\n     */\r\n    endActionExecution: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n        if (self.actionExecutionDeferred) self.actionExecutionDeferred.resolve();\r\n        delete self.actionExecutionDeferred;\r\n    },\r\n\r\n    /**\r\n     * Method to return the promise to anyone that needs to know if multiaction ended\r\n     * @returns {*}\r\n     */\r\n    readyActionExecution: function () {\r\n        var self = this;\r\n        if (!self.actionExecutionDeferred) return $.when(true);\r\n        return self.actionExecutionDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Verifies is the elements was inside a new row in a grid\r\n     * @returns {boolean}\r\n     */\r\n    isFromCreatedRow: function () {\r\n        var self = this;\r\n\r\n        if (self.grid) {\r\n            var i = self.grid.columns.length;\r\n\r\n            while (i-- > 0) {\r\n                if (self.grid.columns[i].properties.xpath == self.properties.xpath) {\r\n                    if (self.grid.columns[i].isNewRow == true) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Submits a invalidate page cache request\r\n     * @param params\r\n     */\r\n    submitInvalidatePageCacheRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var pageCacheToInvalidate = params ? params.idPageCache : properties.idPageCache;\r\n\r\n\r\n        self.dataService.invalidatePageCache({idPageCache: pageCacheToInvalidate});\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isDesignMode: function () {\r\n        return this.getMode() === \"design\";\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isExecutionMode: function () {\r\n        return this.getMode() === \"execution\";\r\n    },\r\n\r\n    /***/\r\n    preventDefaultForAnchorTag: function(){        \r\n        if (bizagi.util.isSharepointContext()){\r\n            $(\"a\", this.getControl()).click(function(ev){\r\n                ev.preventDefault();          \r\n            });\r\n        }    \r\n    }\r\n});","/*\r\n *   Name: Bizagi Render Base Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.render.base\", {}, {\r\n\r\n    /**\r\n     * Method to process the render the layout\r\n     * @param {boolean} isLabelFormat\r\n     * @param {string} format\r\n     */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var properties = this.properties;\r\n\r\n        if (typeof isLabelFormat !== \"boolean\") {\r\n            console.warm(\"error calling processLayout, 'isLabelFormat' is not boolean\");\r\n            return;\r\n        }\r\n\r\n        if (isLabelFormat) {\r\n            this.processLabelLayout(format);\r\n        } else {\r\n            this.processControlLayout(format);\r\n\r\n            // Set required and visiblity\r\n            properties.required = typeof (properties.required) !== \"undefined\" ? bizagi.util.parseBoolean(properties.required) : false;\r\n            var visible = typeof (properties.visible) !== \"undefined\" ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n            if (properties.required) {\r\n                this.changeRequired(properties.required);\r\n            }\r\n\r\n            if (!visible) {\r\n                this.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to process the label in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processLabelLayout: function (format) {\r\n        var $label = this.getLabel();\r\n        if ($label == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n        if (typeof format.bold === \"undefined\") {\r\n            format.bold = true; // Default value\r\n        }\r\n\r\n        this.changeBackgroundColor(format.background)\r\n            .changeFontColor($label, format.color)\r\n            .changeFontBold($label, format.bold)\r\n            .changeFontSize($label, format.size)\r\n            .changeFontItalic($label, format.italic)\r\n            .changeTextDecoration($label, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Method to process the control in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processControlLayout: function (format) {\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        this.changeFontColor($elements, format.color)\r\n            .changeFontBold($elements, format.bold)\r\n            .changeFontItalic($elements, format.italic)\r\n            .changeFontSize($elements, format.size)\r\n            .changeTextDecoration($elements, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeColor: function (color) {\r\n        var $label = this.getLabel();\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        return this\r\n            .changeFontColor($label, color)\r\n            .changeFontColor($elements, color);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} $element\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeFontColor: function ($element, color) {\r\n        if ($element === undefined) return this;\r\n        if (color === undefined) return this;\r\n\r\n        var style = color !== \"none\" ? color : \"\";\r\n        $element.css(\"color\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font size property\r\n     * @param {} $element\r\n     * @param {} size\r\n     * @returns {}\r\n     */\r\n    changeFontSize: function ($element, size) {\r\n        if (size === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        if (size !== \"0\") {\r\n            var newFontSize = 100 + Number(size) * 10 + \"%\";\r\n            $element.css(\"font-size\", newFontSize);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font Strikethrough or underline property\r\n     * @param {} $element\r\n     * @param {} textDecoration\r\n     * @returns {}\r\n     */\r\n    changeTextDecoration: function ($element, textDecoration) {\r\n        if (textDecoration === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        textDecoration && $element.css(\"text-decoration\", textDecoration);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font italic style\r\n     * @param {} $element\r\n     * @param {} italic\r\n     * @returns {}\r\n     */\r\n    changeFontItalic: function ($element, italic) {\r\n        var style = bizagi.util.parseBoolean(italic) ? \"italic\" : \"normal\";\r\n\r\n        $element.css(\"font-style\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font weight\r\n     * @param {} $label\r\n     * @param {} bold\r\n     * @returns {}\r\n     */\r\n    changeFontBold: function ($label, bold) {\r\n        var style = bizagi.util.parseBoolean(bold) ? \"bold\" : \"normal\";\r\n\r\n        $label.css(\"font-weight\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes render background color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.element.css(\"background-color\", color);\r\n        } else {\r\n            this.element.css(\"background-color\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function () {\r\n    },\r\n\r\n    /**\r\n     * Change cell required and attach bindings\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * \r\n     */\r\n    getRTLAlign: function (align) {\r\n        if (typeof align == \"undefined\" || align == \"\") {\r\n            return \"default\";\r\n        }\r\n        return align;\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultLabelAlign: function(){\r\n        return \"default\";\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultValueAlign: function(){\r\n        return \"default\";\r\n    }\r\n});","/**\r\n *   Name: BizAgi Smartphone Render Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the render class to adjust to smartphone devices\r\n */\r\n\r\nbizagi.rendering.render.extend(\"bizagi.rendering.render\", {}, {\r\n    getMenu: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.menu;\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        bizagi.log(\" post render smartphone  edit\", this, \"error\");\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.configureHelpText();\r\n\r\n        self.checkListGroup = $(\".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item\", control);\r\n\r\n        if (typeof (properties.textFormat) !== \"undefined\" && typeof (properties.textFormat.background) !== \"undefined\") {\r\n            self.changeBackgroundColor(properties.textFormat.background);\r\n        }\r\n\r\n        if (typeof (properties.textFormat) !== \"undefined\" && typeof (properties.textFormat.color) !== \"undefined\") {\r\n            self.getControl().parent().css(\"color\", properties.textFormat.color);\r\n            self.element.find(\"input\").css(\"color\", properties.textFormat.color);\r\n\r\n            // Not apply for radio control\r\n            if (properties.type !== \"radio\") {\r\n                self.element.find(\".ui-bizagi-render-control > span\").css(\"color\", properties.textFormat.color);\r\n            }\r\n        }\r\n\r\n        if (typeof (properties.valueFormat) !== \"undefined\" && typeof (properties.valueFormat.color) !== \"undefined\") {\r\n            self.element.find(\".ui-bizagi-render-control > span\").css(\"color\", properties.valueFormat.color);\r\n\r\n            // Not apply for radio control | properties.valueFormat.color\r\n            if (properties.type !== \"radio\") {\r\n                self.element.find(\"input\").css(\"color\", properties.valueFormat.color);\r\n            }\r\n        }\r\n\r\n        // Not apply renderEdition\r\n        if ($(self.element).hasClass(\"bz-command-edit-inline\") || $(self.element).hasClass(\"bz-command-not-edit\") || $(self.element).hasClass(\"bz-rn-non-editable\")) {\r\n            return true;\r\n        }\r\n\r\n        var contextEdition = self.element;\r\n\r\n        if (self.properties.type === \"image\" || self.properties.type === \"columnImage\") {\r\n            /**\r\n             * If this is an image, we should show a preview of it\r\n             * but only when click right into the img tag\r\n             */\r\n            contextEdition = $(self.element).find(\"img\");\r\n            if (contextEdition.length === 0) {\r\n                /**\r\n                 * There is no image so, there is nothing to show/do\r\n                 */\r\n                return;\r\n            }\r\n        }\r\n\r\n        $(contextEdition).bind(\"click\", function () {\r\n            $.when(self.renderEdition())\r\n                .then(function () {\r\n\r\n                    self.endLoading();\r\n                    self.postRenderEdit();\r\n\r\n                    if (!bizagi.util.isEmpty(self.value)) {\r\n                        if (self.value !== false) {\r\n                            // Encode html to avoid html tags\r\n                            self.setDisplayValueEdit(self.value);\r\n                        } else {\r\n                            // Special case when the value is false for boolean renders\r\n                            self.setDisplayValueEdit(self.value);\r\n                        }\r\n                    }\r\n                });\r\n        });\r\n    },\r\n\r\n    postRenderEdit: function () {\r\n\r\n        var self = this;\r\n        var context = self.getFormContainer().container;\r\n        var properties = self.properties;\r\n        var actualscroll = $(\"body\").scrollTop();\r\n\r\n        if (self.getParams() && self.getParams().postRenderEdit) {\r\n            return self.getParams().postRenderEdit(self);\r\n        }\r\n\r\n        $(\"#container-items-edit\", context).find(\".ui-bizagi-container-inputs\").remove();\r\n        var fordwardActionCommon = function () {\r\n            $(\".ui-bizagi-container-children-form\", context).hide();\r\n            $(\"#container-items-edit\", context).empty();\r\n            $(\"#container-items-edit\", context).show();\r\n            $(\".ui-bizagi-button-container\", context).hide();\r\n        };\r\n\r\n        fordwardActionCommon();\r\n        $(\"#container-items-edit\", context).append($.kendoTmpls(self.renderFactory.getTemplate(\"editRender\"), {\r\n            \"label\": properties.displayName\r\n        }));\r\n\r\n        $(\"#container-items-edit\", context).find(\".ui-bizagi-container-inputs\").html(self.inputEdition);\r\n\r\n        var contexttmp = self.contextEdit = $(context).find(\"#container-items-edit\");\r\n        var backActionCommon = function () {\r\n            $(\".ui-bizagi-container-children-form\", context).show();\r\n            $(\"#container-items-edit\", context).hide();\r\n            $(\".ui-bizagi-button-container\", context).show();\r\n\r\n            setTimeout(function () {\r\n                window.scrollTo(0, actualscroll);\r\n            }, 10);\r\n        };\r\n\r\n        $(\".ui-bizagi-container-button-edit .ui-bizagi-save-btn\", contexttmp).bind(\"click\", function () {\r\n            backActionCommon();\r\n            $.when(self.actionSave())\r\n                .done(function () {\r\n                    if (self.properties.submitOnChange) {\r\n                        self.submitOnChange();\r\n                    }\r\n                });\r\n        });\r\n\r\n        $(\".ui-bizagi-container-button-edit .ui-bizagi-cancel-btn\", contexttmp).bind(\"click\", function () {\r\n            backActionCommon();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Template method to get the label element\r\n     */\r\n    getLabel: function () {\r\n        var self = this;\r\n        if (!self.label) {\r\n            var label = $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n            if (label.length > 0) {\r\n                self.label = label;\r\n            }\r\n            return label;\r\n        }\r\n        return self.label;\r\n    },\r\n    \r\n    getContainerRender: function () {\r\n        var self = this;\r\n        return $(self.element);\r\n    },\r\n\r\n    getArrowContainer: function () {\r\n        var self = this;\r\n\r\n        if (!self.arrow) {\r\n            self.arrow = $(\".bz-container-render-cell1 >.ui-bizagi-render-edition-arrow \", self.element || self.observableElement);\r\n        }\r\n\r\n        return self.arrow;\r\n    },\r\n\r\n    /*\r\n     *   Return the right align class\r\n     */\r\n    getAlignClass: function (alignType) {\r\n        return alignType;\r\n    },\r\n\r\n    getArrow: function () {\r\n        var self = this;\r\n\r\n        self.arrow = $(\".bz-container-render-cell1 >.ui-bizagi-render-edition-arrow > .bz-cm-icon  \", self.element || self.observableElement);\r\n        return self.arrow;\r\n\r\n    },\r\n    /*\r\n     *   Template method to get the control element\r\n     */\r\n    getControl: function () {\r\n        var self = this;\r\n\r\n        if (!self.control || self.control.length === 0) {\r\n            self.control = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n\r\n        return self.control;\r\n    },\r\n\r\n\r\n    /*\r\n     *   Template method to get the control element\r\n     */\r\n    getContainerHelpText: function () {\r\n        var self = this;\r\n\r\n        if (!self.containerHelpText) {\r\n            self.containerHelpText = $(\".bz-container-rn-helptext\", self.element || self.observableElement);\r\n        }\r\n\r\n        if (!self.containerHelpText || self.containerHelpText.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        return self.containerHelpText;\r\n    },\r\n\r\n    /*\r\n     *   Template method to get the control filler element\r\n     */\r\n    getControlFiller: function () {\r\n        var self = this;\r\n        if (!self.controlFiller) {\r\n            self.controlFiller = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n\r\n        return self.controlFiller;\r\n    },\r\n\r\n    getContainerMessage: function () {\r\n        var self = this;\r\n        if (!self.containerMessage) {\r\n            self.containerMessage = $(\".bz-rn-messages\", self.element || self.observableElement);\r\n        }\r\n\r\n        return self.containerMessage;\r\n    },\r\n\r\n    getContextEdit: function () {\r\n        return this.contextEdit;\r\n    },\r\n\r\n    /*\r\n     * Customizes render display type with custom css classes\r\n     *   - Type: normal, value, invert\r\n     */\r\n    changeDisplayOption: function (dspType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayType = dspType || (properties.displayType || \"normal\");\r\n        var orientation = properties.orientation || \"\";\r\n        var control = self.getControl();\r\n\r\n        var excludeControls = [\"image\", \"columnImage\", \"activityCheckList\", \"userfield\", \"date\", \"columnDate\", \"searchDate\", \"list\", \"columnList\", \"link\", \"columnLink\", \"fileprint\", \"searchList\", \"geolocation\", \"money\", \"multiSelect\"];\r\n\r\n        // Enable new mobile grid\r\n        if (bizagi.util.isMobileGridEnabled()) {\r\n            excludeControls.push(\"columnUpload\", \"columnImage\");\r\n        }\r\n\r\n        if (!$(self.element).hasClass(\"bz-command-edit-inline\") && excludeControls.indexOf(properties.type) !== -1) {\r\n            $(self.element).addClass(\"bz-command-edit-inline\");\r\n        }\r\n\r\n        if (displayType == \"value\") {\r\n            if (control) {\r\n                control.addClass(\"bz-rn-display-value\");\r\n            }\r\n\r\n            self.getLabel().hide();\r\n        }\r\n\r\n        // o rtl //ltr\r\n        if (displayType === \"reversed\" || orientation === \"rtl\") {\r\n\r\n            control.addClass(\"bz-control-reversed\");\r\n            control.find(\"input\").addClass(\"bz-render-reversed\");\r\n\r\n            if (!control.children().hasClass(\"bz-render-reversed\")) {\r\n                control.children().addClass(\"bz-render-reversed\");\r\n            }\r\n\r\n            self.getLabel().addClass(\"bz-label-reversed\");\r\n        }\r\n\r\n        if (displayType == \"label\" && properties.type !== \"layoutLabel\") {\r\n            control.hide();\r\n            self.getLabel().show();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Customizes render label align\r\n     */\r\n    changeLabelAlign: function (alignType) {\r\n    },\r\n\r\n    /*\r\n     *   Customizes render value align\r\n     */\r\n    changeValueAlign: function (alignType) {\r\n    },\r\n\r\n    /*\r\n     *   Customizes render label and value width\r\n     */\r\n    customizeRenderWidth: function () {\r\n\r\n    },\r\n\r\n    /*\r\n     *   Sends all the info to the server then refreshes the form\r\n     *   Returns a deferred\r\n     */\r\n    submitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        $.when(self.isReadyToSave())\r\n            .done(function () {\r\n                $.when(self.internalSubmitOnChange(data, bRefreshForm))\r\n                    .done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    }).always(function () {\r\n                        bizagi.util.smartphone.stopLoading();\r\n                    });\r\n            });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     *   Adds a validation message to the render\r\n     */\r\n    setValidationMessage: function (message) {\r\n        var self = this;\r\n        self._super(message);\r\n\r\n        if (message && message.length > 0) {\r\n            message = message.replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\r\n            var element;\r\n            self.getContainerMessage().html(element = $(\"<span class=\\\"bz-rn-err\\\"></span>\"));\r\n            element.attr(\"data-error\", message);\r\n        } else {\r\n            self.getContainerMessage().html(\"\");\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Defines virtual method to extend in each render\r\n     */\r\n    renderSingle: function () {\r\n    },\r\n\r\n    /*\r\n     *   Defines virtual method to extend in each render\r\n     */\r\n    renderEdition: function () {\r\n    },\r\n\r\n    /*\r\n     *   Override internal rendering in order to apply new smartphone layout\r\n     */\r\n    internalPostRender: function () {\r\n        var self = this;\r\n        // Treat result as a promise, so if the render control returns a promise we can wait until it is done\r\n        // If not, it will be resolved automatically\r\n        $.when(self.renderSingle())\r\n            .then(function () {\r\n\r\n                // Remove loading status\r\n                self.endLoading();\r\n                self.changeDisplayOption();\r\n\r\n                // Post-render method\r\n                self.postRenderSingle();\r\n\r\n                // Resolve rendering deferred\r\n                if (self.renderingDeferred) {\r\n                    self.renderingDeferred.resolve();\r\n                }\r\n\r\n                // Set the initial value\r\n                if (!bizagi.util.isEmpty(self.value)) {\r\n                    if (self.value !== false) {\r\n                        // Encode html to avoid html tags\r\n                        self.setDisplayValue(self.value);\r\n                    } else {\r\n                        // Special case when the value is false for boolean renders\r\n                        self.setDisplayValue(self.value);\r\n                    }\r\n                }\r\n\r\n                self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n                self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n            });\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        // Render as simple value\r\n        var displayValue = self.getDisplayValue(value);\r\n\r\n        if (typeof (displayValue) == \"string\") {\r\n            control.html(displayValue);\r\n        }\r\n    },\r\n\r\n    setPlaceHolder: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (properties.editable) {\r\n            control.find(\".bz-rn-text\").attr(\"placeholder\", (properties.required) ? \"Required\" : \"Optional\");\r\n        }\r\n    },\r\n\r\n    /* Changes the render editability*/\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var editable = bizagi.util.parseBoolean(argument);\r\n        var renderedElement;\r\n\r\n        self._super(argument);\r\n\r\n        renderedElement = self.getRenderedElement();\r\n        if (renderedElement) {\r\n            renderedElement.toggleClass(\"bz-rn-non-editable\", !editable).toggleClass(\"bz-rn-read-only\", !editable);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered controlEdit\r\n     */\r\n    setDisplayValueEdit: function (value) {\r\n    },\r\n\r\n    actionSave: function () {\r\n        var self = this;\r\n        self.setValue(self.inputEdition.val(), false);\r\n    },\r\n\r\n    changeRequiredLabel: function () {\r\n        var self = this;\r\n        if (self.properties.displayType == \"value\") {\r\n            self.changeRequiredLabelByVal();\r\n            return;\r\n        }\r\n\r\n        var properties = self.properties;\r\n\r\n        if (properties.required) {\r\n            if (!self.checkRequired([])) {\r\n                $(\"div.bz-rn-required\", self.getLabel()).show();\r\n\r\n            } else {\r\n                $(\"div.bz-rn-required\", self.getLabel()).hide();\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * Shows or hides the required icon if the control is configured to show only the value.\r\n     */\r\n    changeRequiredLabelByVal: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.required) {\r\n\r\n            if (!self.checkRequired([])) {\r\n                $(\"div.bz-rn-required\", self.getControl()).show();\r\n\r\n            } else {\r\n                $(\"div.bz-rn-required\", self.getControl()).hide();\r\n            }\r\n        }\r\n    },\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        if (self.properties.displayType == \"value\") {\r\n            self.changeRequiredControl(argument);\r\n            return;\r\n        }\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        //Remove the required div from the dom in order to have only one any time\r\n        self.getLabel().find(\".bz-rn-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            labelElement.text((properties.displayName || \"\") + \" \");\r\n\r\n            if (!self.hasValue()) {\r\n                labelElement.before(\"<div class='bz-rn-required'></div>\");\r\n            } else {\r\n                labelElement.before(\"<div class='bz-rn-required' style='display: none'></div>\");\r\n            }\r\n\r\n            self.setPlaceHolder();\r\n        } else {\r\n            labelElement.text((properties.displayName || \"\")); //+ ' :'\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        var self = this;\r\n        //Remove the required div from the dom in order to have only one any time\r\n        var control = self.getControl();\r\n        control.find(\".bz-rn-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (!self.hasValue()) {\r\n                control.prepend(\"<div class='bz-rn-required'></div>\");\r\n            } else {\r\n                control.prepend(\"<div class='bz-rn-required' style='display: none'></div>\");\r\n            }\r\n\r\n            self.setPlaceHolder();\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    configureLabel: function () {\r\n        return this.properties.displayName;\r\n    },\r\n\r\n    configureHelpText: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties && properties.helpText && properties.helpText !== \"\") {\r\n            var containerHelp = self.getContainerHelpText();\r\n\r\n            if (containerHelp) {\r\n                $(containerHelp).helpText({ helpText: properties.helpText, dir: properties.orientation });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Starts waiting signal for async stuff\r\n     */\r\n    startLoading: function () {\r\n    },\r\n\r\n    /**\r\n     * in mobiles, don't apply styles to icon's elements\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        context = $(\"*:not(.bz-mo-icon):not(.bz-rn-container-control-icon):not(.bz-rn-upload-show-menu):not(.bz-rn-yesno)\", $(context));\r\n        return context;\r\n    },\r\n\r\n    /**\r\n     *   Ends waiting for async stuff\r\n     */\r\n    endLoading: function () {\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        if (color && color !== \"none\") {\r\n            self.getControl().closest(\".ui-bizagi-render\").css(\"background-color\", color);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\").filter(function (index, ele) {\r\n            return ele.type !== \"file\" && ele.type !== \"radio\" && ele.type !== \"checkbox\"\r\n        });\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else {\r\n            self.setDisplayValue(\"\");\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Form Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a form container class that defines basic stuff regarding the device\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.form\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n        var device = bizagi.util.detectDevice();\r\n\r\n        // Creates a hashtable to maintain references by id\r\n        self.rendersById = {};\r\n        self.rendersByXpath = {};\r\n        self.rendersByType = {};\r\n\r\n        // Set page cache id\r\n        self.idPageCache = data.pageCacheId;\r\n\r\n        // Set default mode\r\n        self.mode = params.mode || \"execution\";\r\n        self.focus = params.focus;\r\n\r\n        // Set rendering params\r\n        self.params = params;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Define confirmation message \r\n        var message = \"\";\r\n\r\n        if (device !== \"desktop\") {\r\n            message = this.getResource(\"render-form-user-confirmation-message\").replace(/<br(\\/| \\/)>/g, \"\\n\");\r\n        } else {\r\n            message = this.getResource(\"render-form-user-confirmation-message\");\r\n        }\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.sessionId = data.sessionId;\r\n        properties.displayAsReadOnly = bizagi.util.parseBoolean(data.displayAsReadOnly) || false;\r\n        properties.userConfirmationMessage = properties.userConfirmationMessage || message;\r\n        properties.orientation = properties.orientation || \"ltr\";\r\n        properties.hasRule = bizagi.util.parseBoolean(properties.hasRule) || false;\r\n        properties.contexttype = params.contexttype || \"\";\r\n        properties.paramsRender = params.paramsRender || {};\r\n        properties.processPath = params.data.processPath ? params.data.processPath.replaceAll(\"|/|\", \"  &rsaquo;  \") : \"\";\r\n        properties.breadCrumb = params.data.processPath ? params.data.processPath.split(\"|/|\") : [];\r\n\r\n        // Set validations & actions\r\n        this.validations = data.validations;\r\n        this.actions = data.actions;\r\n\r\n        // Enable the \"Validate and Save\" action for Form Buttons\r\n        self.allowValidateAndSaveAction = bizagi.override && bizagi.override.enableActionValidateAndSave === true;\r\n\r\n        // Initialize buttons\r\n        self.initializeButtons(data);\r\n\r\n        // Define transitions to Complex Gateway\r\n        if (data.transitions) {\r\n            self.transitions = data.transitions;\r\n        }\r\n\r\n        this.originalProcessButton = this.processButton;\r\n\r\n        //Custom behaviour for application parent activated.\r\n        self.isRoutingDisabled = false;\r\n        if (params.applicationParent) {\r\n            switch (params.applicationParent) {\r\n                case 'NEWWORKPORTAL':\r\n                    self.isRoutingDisabled = true;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        self.isOfflineFormsV2Supported =  bizagi.util.isMobileDevice() && bizagi.util.isOfflineFormsV2Supported();\r\n\r\n    },\r\n    /*\r\n    *   Initializes button metadata\r\n    */\r\n    initializeButtons: function (data) {\r\n        var self = this;\r\n\r\n        self.buttons = [];\r\n\r\n        // Process buttons\r\n        if (data.buttons) {\r\n            $.each(data.buttons, function (i, item) {\r\n                var button = item.button.properties;\r\n\r\n                // Process caption\r\n                button.caption = !bizagi.util.isEmpty(button.caption) && self.getResource(button.caption) != button.caption ? self.getResource(button.caption) : button.caption;\r\n\r\n                // Process actions\r\n                if (button.actions) {\r\n                    $.each(button.actions, function (i, action) {\r\n                        button[action] = true;\r\n                    });\r\n                }\r\n\r\n                // Add other properties\r\n                button.ordinal = i;\r\n                button.action = button.next ? \"next\" :\r\n                    button.nextWithoutValidations ? \"nextWithoutValidations\" :\r\n                        button.submitData ? \"save\" :\r\n                            button.cancel ? \"cancel\" :\r\n                                button.back ? \"back\" :\r\n                                    button.createnewcase ? \"createnewcase\" :\r\n                                        button.validate ? \"validate\" : \"\";\r\n\r\n                // Explicit add save operation\r\n                button.save = (button.action === \"save\");\r\n\r\n                // Add inherent behaviours\r\n                if (button.next || button.back || button.nextWithoutValidations) {\r\n                    button.routing = true;\r\n                }\r\n\r\n                if (button.hasRule) {\r\n                    button.executeRule = true;\r\n                }\r\n\r\n                if (self.allowValidateAndSaveAction && button.validate) {\r\n                    button.submitData = true;\r\n                    button.refresh = true;\r\n                    button.save = true;\r\n                    if (button.action === \"next\" || button.action === \"createnewcase\") {\r\n                        button.refresh = false;\r\n                    }\r\n                }\r\n\r\n                // Prepare button style\r\n                button.style = self.buildButtonStyle(button);\r\n\r\n                // Add to button array\r\n                if (self.properties.orientation === \"rtl\" && !self.properties.useCustomButtons) {\r\n                    self.buttons.unshift(button);\r\n                } else {\r\n                    self.buttons.push(button);\r\n                }\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get the original params used to fetch the form\r\n    */\r\n    getParams: function () {\r\n        return this.params;\r\n    },\r\n\r\n    setParam: function (property, value) {\r\n        if (this.params) {\r\n            this.params[property] = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        return this.mode;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        if (self.params) {\r\n            return self.params.customHandlers;\r\n        }\r\n    },\r\n    /*\r\n    * Method to index renders\r\n    */\r\n    registerRender: function (render) {\r\n        var self = this;\r\n\r\n        self.rendersById[render.properties.id] = render;\r\n        if (render.properties.xpath) {\r\n            if (!self.rendersByXpath[render.properties.xpath]) {\r\n                self.rendersByXpath[render.properties.xpath] = [];\r\n            }\r\n            self.rendersByXpath[render.properties.xpath].push(render);\r\n        }\r\n\r\n        if (!self.rendersByType[render.properties.type]) {\r\n            self.rendersByType[render.properties.type] = [];\r\n        }\r\n        self.rendersByType[render.properties.type].push(render);\r\n    },\r\n    /*\r\n    * Method to unregister render\r\n    */\r\n    unregisterRender: function (render) {\r\n        var self = this;\r\n\r\n        if (self.rendersById[render.properties.id]) {\r\n            delete self.rendersById[render.properties.id];\r\n        }\r\n\r\n        if (render.properties.xpath) {\r\n            if ($.isArray(self.rendersByXpath[render.properties.xpath])\r\n                && self.rendersByXpath[render.properties.xpath].length > 1) {\r\n                for (var i = 0, l = self.rendersByXpath[render.properties.xpath].length; i < l; i++) {\r\n                    var element = self.rendersByXpath[render.properties.xpath][i];\r\n                    if (element.properties.id === render.properties.id) {\r\n                        self.rendersByXpath[render.properties.xpath].splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                delete self.rendersByXpath[render.properties.xpath];\r\n            }\r\n        }\r\n\r\n        // Unregister from renders by type\r\n        if (render.properties.type) {\r\n            var listRendesByType = self.getRenderByType(render.properties.type);\r\n            var listRendesByTypeLength = listRendesByType.length;\r\n            var renderKey = render.properties.id || render.properties.xpath;\r\n\r\n            for (var i = 0; i < listRendesByTypeLength; i++) {\r\n                var listRender = listRendesByType[i];\r\n                if ((typeof listRender.properties.id != \"undefined\" && listRender.properties.id == renderKey) ||\r\n                    (typeof listRender.properties.xpath != \"undefined\" && listRender.properties.xpath == renderKey)) {\r\n                    // Unregister element\r\n                    self.rendersByType[render.properties.type].splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Method to access a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this;\r\n\r\n        return self.rendersById[id];\r\n    },\r\n\r\n    getGridByColumn: function (id) {\r\n        var self = this;\r\n        var grids = self.getRenderByType('grid');\r\n        var i = 0, columnIndex;\r\n\r\n        for (; i < grids.length; i++) {\r\n            columnIndex = grids[i].columnsIds.indexOf(id);\r\n            if (columnIndex != -1) {\r\n                return grids[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this;\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath && xpath.indexOf)\r\n            if (xpath.indexOf(\"[\") > 0) {\r\n                xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n            }\r\n\r\n        return self.rendersByXpath[xpath] ? self.rendersByXpath[xpath] : [];\r\n    },\r\n    /**\r\n     * Get all render with the same type\r\n     */\r\n    getRenderByType: function (type) {\r\n        var self = this;\r\n\r\n        // Check that type is defined\r\n        if (typeof type == \"string\" && type.length > 0) {\r\n            // Search controls by type\r\n            return (self.rendersByType[type]) ? self.rendersByType[type] : [];\r\n        }\r\n        return [];\r\n    },\r\n\r\n    /*\r\n    *   Build the container html\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.fasttmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (form) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Add a mode class\r\n        form.addClass(\"ui-bizagi-rendering-mode-\" + mode);\r\n\r\n        // Call base\r\n        this._super(form);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form).each(function () {\r\n                if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                    complexGatewayContainer = this;\r\n                }\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".ui-bizagi-container-complexgateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function (e, mainForm) {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations, mainForm);\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Set events for complex gateway interface\r\n        $(complexGatewayContainer).find(\".ui-checkbox\").bind(\"click\", function () {\r\n            var checkboxLabel = $(\"label\", this);\r\n\r\n            var transitionId = checkboxLabel.data(\"value\") || \"\";\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(checkboxLabel.data(\"checked\"))) {\r\n                // Uncheck element\r\n                checkboxLabel.removeClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                checkboxLabel.addClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n    },\r\n    /*\r\n    *   Format form buttons to allow further customization\r\n    */\r\n    buildButtonStyle: function (button) {\r\n\r\n        var style = {};\r\n        if (button.format) {\r\n            if (button.format.size) {\r\n                if (button.format.size != \"0\") {\r\n                    var newFontSize = (100 + Number(button.format.size) * 10) + \"%\";\r\n                    style[\"font-size\"] = newFontSize + \" !important\";\r\n                }\r\n            }\r\n            if (button.format.bold) {\r\n                style[\"font-weight\"] = \"bold !important\";\r\n                if (bizagi.util.isIE()) {\r\n                    style[\"font-family\"] = \"'Open Sans', 'Helvetica Neue', Arial, Helvetica, sans-serif !important\";\r\n                }\r\n            }\r\n            if (button.format.italic) {\r\n                style[\"font-style\"] = \"italic !important\";\r\n            }\r\n            if (button.format.underline || button.format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(button.format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(button.format.underline) ? \"underline \" : \"\";\r\n                style[\"text-decoration\"] = strikethru + underline + \" !important\";\r\n            }\r\n            if (button.format.background) {\r\n                style[\"background-color\"] = button.format.background + \" !important\";\r\n                style[\"background-image\"] = \"none !important\";\r\n            }\r\n            if (button.format.color) {\r\n                style[\"color\"] = button.format.color + \" !important\";\r\n            }\r\n        }\r\n\r\n        var strStyle = \"\";\r\n        for (key in style) {\r\n            strStyle += key + \":\" + style[key] + \";\";\r\n        }\r\n        return strStyle;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   Returns a promise\r\n    */\r\n    render: function () {\r\n        var self = this;\r\n\r\n        // Creates a deferred, so we can check when form has been included in dom\r\n        if (!self.readyDeferred)\r\n            self.readyDeferred = new $.Deferred();\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Sets a promise that the form will be included in the DOM\r\n    *   so we can apply some tedious plugins that require that\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n\r\n        return self.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n    /*\r\n    *  Return context type, when the parent form is entity\r\n    */\r\n    getContextType: function () {\r\n        return this.properties.contexttype || \"\";\r\n    },\r\n\r\n    /*\r\n    * Return the endpoint action, when the form will be refresh\r\n    */\r\n    getEndPointAction: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        if (properties.formtype == \"startform\")\r\n            return \"LOADSTARTFORM\";\r\n\r\n        return undefined;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache id for the element\r\n    */\r\n    getPageCache: function () {\r\n        return this.idPageCache;\r\n    },\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        return this;\r\n    },\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.on(\"click\", function (e) {\r\n            e.preventDefault();\r\n            e.stopImmediatePropagation();\r\n\r\n            self.startLoading();\r\n\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            self.lastActionButton = buttonProperties;\r\n            if (buttonProperties.action === \"next\") {\r\n                buttonProperties.routingDisabled = self.isRoutingDisabled;\r\n            }\r\n\r\n            button.prop(\"disabled\", true); //disable button to prevent multiple click actions\r\n\r\n            if(button.hasOwnProperty('disabled')) {\r\n                button.button(\"disable\"); //Setting styles\r\n            }\r\n\r\n            // External Events\r\n            self.propagateExternalEvents(e);\r\n\r\n            // Execute button\r\n            //QAF-1418 - add setTimeout\r\n            setTimeout(function () {\r\n                $.when(self.processButton(buttonProperties)).always(function () {\r\n                    self.processDefer = undefined;\r\n                    self.endLoading();\r\n                    if ($.contains(document.documentElement, button.get(0))) { //check if button is still in DOM\r\n                        button.prop(\"disabled\", false);  //enable button\r\n\r\n                        if(button.hasOwnProperty('enable')) {\r\n                            button.button(\"enable\"); //Setting styles\r\n                        }\r\n                    }\r\n                });\r\n            }, 100);\r\n        });\r\n    },\r\n    /*\r\n    * Execute codes just before sending information to server\r\n    */\r\n    preProcessButton: function (buttonProperties) {\r\n        return true;\r\n    },\r\n    /*\r\n    * Execute codes just after sending information to server\r\n    */\r\n    postProcessButton: function (responses, buttonProperties) {\r\n        return true; // true means continue\r\n    },\r\n\r\n    setLoaderDeferred: function() {\r\n        var self = this;\r\n\r\n        self.loaderDeferred = $.Deferred().resolve();\r\n    },\r\n\r\n    deleteLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function() {\r\n                delete self.loaderDeferred;\r\n            });\r\n        }\r\n    },\r\n\r\n    useOrSetLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            self.setLoaderDeferred();\r\n        }\r\n    },\r\n\r\n    getLoaderPromise: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            return self.loaderDeferred.promise();\r\n        } else {\r\n            return;\r\n        }\r\n    },\r\n\r\n    isLoaderDeferredSet: function () {\r\n        var self = this;\r\n\r\n        if (self.loaderDeferred) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    appendWaitForLoader: function (params) {\r\n        var self = this;\r\n        var promise = params.promise;\r\n        var create = params.create || false;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            if (create) {\r\n                self.setLoaderDeferred();\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n\r\n        self.loaderDeferred = self.loaderDeferred.then(function () {\r\n            return (function () {\r\n                return promise;\r\n            })();\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Executes a single button action\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var properties = self.properties;\r\n        if (!buttonProperties.routing) {\r\n            bizagi.chrono.initAndStart(\"submitForm\");\r\n        }\r\n        bizagi.chrono.init(\"waiting\");\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Resolve asynchronous tabItems\r\n        var form = self.getFormContainer();\r\n        var getAllTabs = form.getRenderByType(\"tabItem\");\r\n        var getAllTabsLength = getAllTabs.length;\r\n\r\n        form.innerTabsLoading = true;\r\n\r\n\r\n        self.useOrSetLoaderDeferred();\r\n\r\n        // Check\r\n        for (var i = 0; i < getAllTabsLength; i++) {\r\n            var render = getAllTabs[i];\r\n            // Resolve internal deferred\r\n            if (render.loadingDeferred && render.parent.container) {\r\n                render.loadingDeferred.resolve();\r\n            }\r\n        }\r\n\r\n        delete form.innerTabsLoading;\r\n\r\n        $.when(self.ready(), self.getLoaderPromise()).done(function () {\r\n            self.deleteLoaderDeferred();\r\n            // Validate the form\r\n            var valid = bizagi.util.parseBoolean(buttonProperties.validate) ? self.validationController.performValidations() : true;\r\n            if (valid) {\r\n\r\n                if ([\"save\", \"next\", \"back\", \"createnewcase\", \"nextWithoutValidations\"].includes(buttonProperties.action)) {\r\n                    $(document).data('auto-save', '');\r\n                }\r\n\r\n                // Check for user confirmation if configured and the button is configured to enroute\r\n                if (bizagi.util.parseBoolean(self.properties.needsUserConfirmation) && bizagi.util.parseBoolean(buttonProperties.routing)) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, null, false)).done(function () {\r\n                        // Submits the form\r\n                        if (self.preProcessButton(buttonProperties)) {\r\n                            //Trigger the event after ProcessButton\r\n                            self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                            $.when(self.submitForm(buttonProperties)).done(function () {\r\n                                defer.resolve();\r\n                            }).fail(function() {\r\n                                defer.reject(arguments);\r\n                            });\r\n                        }\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n\r\n                } else {\r\n                    if (self.preProcessButton(buttonProperties)) {\r\n                        //Trigger the event after ProcessButton\r\n                        self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                        $.when(self.submitForm(buttonProperties)).done(function () {\r\n                            $(document).trigger(\"FORMACTION\", buttonProperties);\r\n                            defer.resolve();\r\n                        }).fail(function () {\r\n                            defer.reject(arguments);\r\n                        });\r\n                    }\r\n                }\r\n\r\n            } else {\r\n\r\n                self.endLoading();\r\n                if (buttonProperties.submitData) {\r\n                    $.when(self.submitData()).done(function () {\r\n                        defer.reject();\r\n                    });\r\n                }\r\n                else {\r\n                    defer.reject();\r\n                }\r\n\r\n                self.validationController.expandNotificationBox();\r\n            }\r\n\r\n            var customHandler = self.getCustomHandler(\"afterFormButtonClick\");\r\n            if (customHandler) {\r\n                customHandler(buttonProperties);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    validateForm: function () {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Validate the form\r\n        return self.validationController.performValidations();\r\n    },\r\n    /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n\r\n            // Submit the form\r\n            return $.when(self.dataService.submitData({\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            })).always(function () {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Creates a json array with key values to send to the server\r\n    */\r\n    submitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        $.when(self.isReadyToSave())\r\n            .done(function () {\r\n                if (isOfflineForm) {\r\n                    self.internalSubmitFormOffline(buttonProperties);\r\n                    return;\r\n                }\r\n                $.when(self.internalSubmitForm(buttonProperties)).done(function () {\r\n                    defer.resolve();\r\n                }).fail(function () {\r\n                    defer.reject(arguments);\r\n                });\r\n\r\n            }).fail(function () {\r\n            self.endLoading();\r\n            bizagi.log(\"The form is not saved, no changes were found\");\r\n            defer.reject();\r\n        });\r\n        return defer.promise();\r\n    },\r\n    checkWidgetsData: function () {\r\n        //\r\n    },\r\n    isComplexGatewayPainted: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Get last action button\r\n     * @returns {*}\r\n     */\r\n    getLastActionButton: function () {\r\n        var self = this;\r\n        return self.lastActionButton;\r\n    },\r\n\r\n    /**\r\n     * Internal - Creates a json array with key values to send to the database\r\n     * @param {} buttonProperties\r\n     * @returns {}\r\n     */\r\n    internalSubmitFormOffline: function (buttonProperties) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var data;\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        if (self.transitions) {\r\n            var transitions = [];\r\n            $.each(this.activeTransitions, function (key, value) {\r\n                (value) ? transitions.push(key) : \"\";\r\n            });\r\n\r\n            if (bizagi.util.countProps(transitions) == 0) {\r\n                bizagi.showMessageBox(\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-path\"),\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false\r\n                );\r\n                self.endLoading();\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        $.when(self.dataService.submitData({\r\n            action: buttonProperties.action,\r\n            data: data,\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            idForm: self.properties.id,\r\n            prepare: true,\r\n            transitions: transitions || \"\",\r\n            idCase: self.params.idCase,\r\n            idWorkitem: self.params.idWorkitem,\r\n            isOfflineForm: isOfflineForm || false,\r\n            offlineType: self.params.offlineType || \"\"\r\n        })).done(function (responses) {\r\n\r\n            if (!self.postProcessButton(responses, buttonProperties)) {\r\n                return;\r\n            }\r\n\r\n            if (buttonProperties.routing) {\r\n                var waitForOnlineResponse = false;\r\n                if(isOfflineForm && self.isOfflineFormsV2Supported && self.params.online) {\r\n                    waitForOnlineResponse = true;\r\n                    var tryPushResponsePromise = new $.Deferred();\r\n                    self.params.responsePromise = tryPushResponsePromise;\r\n                    $(document).trigger(\"tryPushCase.offline\", self.params);\r\n                }\r\n                else if( isOfflineForm && !self.isOfflineFormsV2Supported){\r\n                    $(document).trigger(\"tryPushData.offline\");\r\n                }\r\n\r\n                if(!waitForOnlineResponse){\r\n                    self.triggerHandler(\"routing\", {\r\n                        offlineAction: buttonProperties.action,\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem\r\n                    });\r\n                }\r\n                else {\r\n                    $.when(tryPushResponsePromise)\r\n                    .then( function(result){\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: result.IdCase,\r\n                            caseNumber: result.CaseNumber\r\n                        });\r\n                    })\r\n                    .fail( function(error){\r\n                        self.failHandler(error);\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                message = bizagi.util.isValidResource(\"workportal-mobile-offline-form-successful\")\r\n                    ? bizagi.localization.getResource(\"workportal-mobile-offline-form-successful\")\r\n                    : \"Saved\";\r\n\r\n                bizagi.util.showNotification({ text: message, type: \"success\" });\r\n            }\r\n\r\n        }).fail(function (error) {\r\n            message = bizagi.util.isValidResource(\"workportal-mobile-offline-successful-fail\")\r\n                ? bizagi.localization.getResource(\"workportal-mobile-offline-successful-fail\")\r\n                : \"Not saved\";\r\n\r\n            bizagi.util.showNotification({ text: message, type: \"error\" });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Internal - Creates a json array with key values to send to the server\r\n    */\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var data;\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\r\n        });\r\n\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var waitingDeferreds = [];\r\n        var deferredsToWait = null;\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {  // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase || buttonProperties.nextWithoutValidations) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-widget-complexgateway-path\"), bizagi\r\n                        .localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: self.getButtonAction(buttonProperties.action),\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        // Assemble the actions\r\n        var actions = [];\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n            actions.push(checkpointAction);\r\n            actions.push(executeButtonAction);\r\n            actions.push(commitAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        // Execute the batch\r\n        bizagi.chrono.initAndStart(\"submitForm-ajax\");\r\n\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                })\r\n                .fail(function () {\r\n                    flowControlDeferred.reject();\r\n                    console.log(\"Error: It was not possible resolve async actions on form \")\r\n                })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        waitingDeferreds.push(flowControlDeferred);\r\n\r\n        $.when.apply($, waitingDeferreds).done(function() {\r\n            $.when(self.dataService.multiaction().execute({ actions: actions })).done(function (responses) {\r\n                bizagi.chrono.stop(\"submitForm-ajax\");\r\n                // End asynchronous operation\r\n                self.endLoading();\r\n                // Find validations\r\n                var bHasValidations;\r\n                var alertMessage = \"\";\r\n                $.each(responses, function (i, response) {\r\n\r\n                    var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                    bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                    alertMessage = propertiesToDisplayMessages.alertMessage;\r\n\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties)) {\r\n                        return;\r\n                    }\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh) {\r\n                        self.refreshForm();\r\n                    }\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: self.params.idCase,\r\n                            routingDisabled: buttonProperties.routingDisabled\r\n                        });\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    if(alertMessage !== \"\"){ /*If there is an alertMessage show in a modal error*/\r\n                        bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                    }\r\n                    if (buttonProperties.executeRule) {\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                    }\r\n                }\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                if (buttonProperties.executeRule) {\r\n                    self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                if (response && response.error && (response.error.errorType === \"WaitForCompletionPlanException\" ||\r\n                    response.error.errorType === \"InvalidPlanStateException\" || response.error.errorType === \"CustomMessageException\")) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(response.error.message), null, false)).then(function () {\r\n                        return $.when(self.internalSubmitForm($.extend({}, buttonProperties, { forcePlanCompletion: true })));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    self.failHandler(response);\r\n                    defer.reject(response);\r\n                }\r\n            });\r\n        });\r\n        return defer.promise();\r\n    },\r\n    validationToDisplayMessages: function(bHasValidations, messageType, message, alertMessage){\r\n        var self = this;\r\n\r\n        if (messageType == \"validationMessages\") {\r\n            // Something went wrong, we gotta display messages in notifications grid\r\n            self.addValidationMessage(message);\r\n            bHasValidations = true;\r\n        }\r\n        if(bizagi.detectDevice() == \"desktop\" && messageType == \"alertMessages\"){\r\n            // Something went wrong, we gotta display alert message\r\n            if(alertMessage === \"\"){\r\n                alertMessage = message;\r\n            }else{\r\n                alertMessage = alertMessage + \"\\n\\n\" + message;\r\n            }\r\n\r\n            bHasValidations = true;\r\n        }\r\n\r\n        return {\"bHasValidations\": bHasValidations, \"alertMessage\": alertMessage};\r\n    },\r\n\r\n    /*\r\n    *   Add a validation message to the form\r\n    */\r\n    addValidationMessage: function (validationMessage, focus, icon, itemAdditionalClass, autofocus, type) {\r\n        var self = this;\r\n\r\n        if (!self.validationController) {\r\n            self.validationController = new bizagi.command.controllers.validation(self);\r\n        }\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage, focus, icon, itemAdditionalClass, type);\r\n        } else {\r\n            $.each(validationMessage, function (i, message) {\r\n                self.validationController.showValidationMessage(message, focus, icon, itemAdditionalClass, type);\r\n            });\r\n        }\r\n        self.validationController.expandNotificationBox(autofocus);\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        if (self.validationController) {\r\n            self.validationController.clearValidationMessages(params);\r\n        }\r\n\r\n    },\r\n    /*\r\n    *   Add an error message to the form\r\n    */\r\n    addErrorMessage: function (errorMessage) {\r\n        var self = this;\r\n\r\n        self.validationController.showErrorMessage(errorMessage);\r\n        self.validationController.expandNotificationBox();\r\n    },\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var deferred = $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        // Normalize new focus structure if not present\r\n        if (focus && !focus.id) {\r\n            focus = {\r\n                id: focus\r\n            };\r\n        }\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            isRefresh: true,\r\n            contextType: self.getContextType() || \"\",\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\"\r\n        };\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            self.endLoading();\r\n            deferred.resolve();\r\n        }).fail(function () {\r\n            self.endLoading();\r\n            deferred.reject();\r\n        });\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Get opened tabs configuration\r\n    */\r\n    getSelectedTabs: function () {\r\n        var self = this;\r\n        var tabContainers = self.getElementsByType(\"tab\");\r\n        var tabs = $.map(tabContainers, function (tabContainer) {\r\n            return { tab: tabContainer.properties.id, selected: tabContainer.activeTab };\r\n        });\r\n        var selectedTabs = {};\r\n        for (var i = 0, length = tabs.length; i < length; i++) {\r\n            selectedTabs[tabs[i].tab] = tabs[i].selected;\r\n        }\r\n        return selectedTabs;\r\n    },\r\n    /*\r\n    *   Template method to get the buttons objects\r\n    */\r\n    getButtons: function () {\r\n    },\r\n    /*\r\n    *   Adds an action on the fly to process the submit on change\r\n    */\r\n    addSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n        self.actionController.processInternalSubmitAction(xpath, action);\r\n    },\r\n    /**\r\n     *   Adds an overlay to the form, and sets a waiting message\r\n     *\r\n     *   @argument {bool} delay Apply delay\r\n     */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        // This hack is only for desktop\r\n        if (!bizagi.util.isTabletDevice()) {\r\n            // Detect canvas parent with scroll\r\n            var isSharePoint = self.params.context === \"sharepoint\";\r\n            var canvas = self.params.canvas;\r\n            if (isSharePoint) {\r\n                canvas = bizagi.util.scrollTop(canvas);\r\n\r\n                if (!!!canvas.context) {\r\n                    canvas = $(\"body\", $(document));\r\n                }\r\n            } else {\r\n                canvas = $(\"body\", $(document));\r\n            }\r\n\r\n            // Configures overlay\r\n            var size = this.getSize();\r\n            var position = this.getOffset();\r\n            if (size.height == $(window).height()) {\r\n                position.top = 0;\r\n            }\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(canvas);\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(canvas);\r\n            self.waitingOverlay.css({\r\n                \"height\": \"100%\",\r\n                \"width\": \"100%\",\r\n                \"min-height\": size.height,\r\n                \"min-width\": size.width\r\n            });\r\n            self.waitingMessage.css({\r\n                \"top\": (position.top + Math.ceil((size.height - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n                \"left\": (Math.ceil((size.width - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n            });\r\n            canvas.css(\"position\", \"relative\");\r\n\r\n        } else {\r\n            // Configures overlay\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(\"body\", $(document));\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(\"body\", $(document));\r\n        }\r\n    },\r\n    /*\r\n    *   Removes the overlay and restores the form edition\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n        if (self.waitingOverlay && self.waitingMessage) {\r\n            self.waitingOverlay.remove();\r\n            self.waitingMessage.remove();\r\n            self.waitingOverlay = null;\r\n            self.waitingMessage = null;\r\n\r\n            var canvas = self.params.canvas;\r\n\r\n            if (canvas != undefined)\r\n                canvas.css(\"position\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Get the focused render in the current request\r\n    */\r\n    getFocusedElement: function () {\r\n        var self = this;\r\n        return self.focus;\r\n    },\r\n    /*\r\n    *   Set the focused render in the current request\r\n    */\r\n    setFocusedElement: function (focus) {\r\n        var self = this;\r\n        self.focus = focus;\r\n    },\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        return this.triggerHandler(\"globalHandler\", { eventType: eventType, data: data });\r\n    },\r\n    /*\r\n    *   Generic handler to attach fail workflow for some operations\r\n    */\r\n    failHandler: function (error) {\r\n        var self = this;\r\n\r\n        // Check if the error is in multiaction format\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n        }\r\n\r\n        //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n        if (error & error.length && error.length > 1) error = error[0];\r\n        if (error.error) error = error.error;\r\n        if (error.error) error = error.error;\r\n\r\n        // Handle normal messages\r\n        if (typeof error == \"object\" && error.message) {\r\n            if (error.errorType === \"WaitForCompletionPlanException\" || error.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                error = bizagi.localization.getResource(error.message);\r\n            }\r\n            else {\r\n                error = error.message;\r\n            }\r\n\r\n        } else if (typeof error == \"string\") {\r\n            // Parse to json\r\n            try {\r\n                var errorJson = JSON.parse(error);\r\n                if (errorJson.errorType === \"WaitForCompletionPlanException\" || errorJson.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                    errorJson.message = bizagi.localization.getResource(errorJson.message);\r\n                }\r\n                error = errorJson.message;\r\n            } catch (e) {\r\n            }\r\n        }\r\n\r\n        // Workflow engine error, we gotta show it with error\r\n        self.addErrorMessage(error);\r\n        self.endLoading();\r\n    },\r\n    /* \r\n    *   Resizes the element\r\n    */\r\n    resize: function (size) {\r\n        // Just save the size, for reference\r\n        this.setSize(size);\r\n    },\r\n    /*\r\n    *   Sets the internal size for the form\r\n    */\r\n    setSize: function (size) {\r\n        this.size = size;\r\n    },\r\n    /*\r\n    *   Gets the internal size for the form\r\n    */\r\n    getSize: function () {\r\n        if (this.size) {\r\n            return this.size;\r\n        }\r\n        var canvas = (this.params.canvas) ? this.params.canvas : this.getFormContainer().container;\r\n\r\n        var canvasWidth = canvas.width();\r\n        var canvasHeight = canvas.height();\r\n\r\n        return {\r\n            width: canvasWidth,\r\n            height: canvasHeight\r\n        };\r\n    },\r\n    getOffset: function () {\r\n        var canvas = this.getFormContainer().container;\r\n\r\n        return canvas.offset();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitData: function (args) {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        // Don't do anything if there is no data\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        }\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().submitData({\r\n            action: \"SUBMITDATA\",\r\n            data: data,\r\n            idPageCache: self.properties.idPageCache,\r\n            xpathContext: self.properties.xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeRule({\r\n            idPageCache: properties.idPageCache,\r\n            rule: args.rule,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages({ clearOnlyServer: true });\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage.apply(self, [message.messages, undefined, undefined, undefined, false, \"serverMessage\"]);\r\n            }\r\n            if(bizagi.detectDevice() == \"desktop\" && message.type == \"alertMessages\"){\r\n                bizagi.modalError.show(message.messages.join(\"\\n\\n\"), 'workportal-general-word-information', false);\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute an interface\r\n     */\r\n    executeInterface: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeInterface({\r\n            idPageCache: properties.idPageCache,\r\n            interface: args.interface,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    executeSAPConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeSAPConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidsap: args.guidsap,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    executeConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties\r\n                .xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidConnector: args.guidConnector,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    refreshActions: function (actions) {\r\n        var self = this;\r\n        self.actionController.refreshActions(actions);\r\n    },\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    removeActions: function () {\r\n        var self = this;\r\n        self.actionController.unbindActions();\r\n    },\r\n    /*\r\n    *   Iterate through all renders and collect the data to send, then update original values for each render\r\n    */\r\n    collectRenderValuesForSubmit: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n\r\n        // Collect data\r\n        self.collectRenderValues(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params {data, bRefreshForm,properties}\r\n     * @returns {*}\r\n     */\r\n    internalSubmitOnChange: function (params) {\r\n        params = params || {};\r\n        var self = this, idCase;\r\n        var properties = params.properties;\r\n        // var form = self.getFormContainer();\r\n        var defer = new $.Deferred();\r\n        var data = params.data || {};\r\n        var bRefreshForm = typeof (params.bRefreshForm) != \"undefined\" ? params.bRefreshForm : true;\r\n        var notCollect = params.notCollect ? params.notCollect : undefined;\r\n\r\n        // Collect data\r\n        if (!(notCollect && !$.isEmptyObject(data))) {\r\n            self.collectRenderValuesForSubmit(data);\r\n        }\r\n        self.startLoading();\r\n\r\n        //idCase = self.getCacheIdCase();\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function () {\r\n            // Submit the form\r\n            self.dataService.submitData({\r\n                action: \"SUBMITONCHANGE\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }).done(function (response) {\r\n                // Cancel previous multiactions and process property value\r\n                self.cancelPreviousRequest();\r\n                // After successfully response refresh the form\r\n                self.endLoading();\r\n                // If response message has error in validation, do not refresh the form\r\n                // and show validation message\r\n                if (response && response.type == \"validationMessages\") {\r\n                    if (typeof self.clearValidationMessages == \"function\") {\r\n                        self.clearValidationMessages();\r\n                    }\r\n\r\n                    self.addValidationMessage(response.messages);\r\n                    defer.resolve();\r\n                } else if (bRefreshForm) {\r\n                    var focusIdentifier = {\r\n                        id: properties.id,\r\n                        xpath: properties.xpath\r\n                    };\r\n                    if (properties.idCase !== undefined) {\r\n                        $.extend(focusIdentifier, {\r\n                            idCaseObject: bizagi.cache.idCaseObject\r\n                        });\r\n                    }\r\n                    if (response.IdScope) {\r\n                        self.properties.idStartScope = response.IdScope;\r\n                    }\r\n                    $.when(self.refreshForm(focusIdentifier)).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.resolve();\r\n                    });\r\n                } else {\r\n                    defer.resolve();\r\n                }\r\n            }).fail(function (message) {\r\n                self.endLoading();\r\n                var objMessage = JSON.parse((typeof message == 'object' && message.responseText) ? message.responseText : {}) || {};\r\n                var strMessage = objMessage.message || message;\r\n                // Clear previous validations\r\n                self.validationController.clearValidationMessages();\r\n                if (objMessage.type == \"alert\") {\r\n                    self.validationController.showAlertMessage(strMessage);\r\n                } else {\r\n                    self.validationController.showErrorMessage(strMessage);\r\n                }\r\n                defer.resolve();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    cancelPreviousRequest: function () {\r\n        if (bizagi.multiactionConnection && bizagi.multiactionConnection.length) {\r\n            var length = bizagi.multiactionConnection.length;\r\n            var i = 0, connection;\r\n            for (; i < length; i++) {\r\n                connection = bizagi.multiactionConnection.pop();\r\n                if (connection && connection.abort) {\r\n                    bizagi.showErrorAlertDialog = false;\r\n                    connection.abort();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    prepareCheckpointAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var checkpointAction = self.dataService.sendCheckpoint({\r\n            url: self.properties.checkpointUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        checkpointAction.tag = \"checkpoint\";\r\n\r\n        return checkpointAction;\r\n    },\r\n\r\n    prepareCommitAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var commitAction = self.dataService.commitLinkForm({\r\n            url: self.properties.commitUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        commitAction.tag = \"commit\";\r\n\r\n        return commitAction;\r\n    },\r\n\r\n    sendRollbackAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        self.dataService.rollbackLinkForm({\r\n            url: self.properties.rollbackUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n\r\n        setTimeout(function () {\r\n            if (self.params) {\r\n                delete self.params.canvas;\r\n            }\r\n            delete self.params;\r\n            delete self.control;\r\n            if (self.validationController) {\r\n                self.unbind(\"rendervalidate\");\r\n                delete self.validationController;\r\n            }\r\n\r\n            if (self.actionController) {\r\n                self.actionController.unbindActions();\r\n                delete self.actionController;\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    getButton: function (guid) {\r\n        return $(\".ui-bizagi-button[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    getFloatingButton: function (guid) {\r\n        return $(\"li[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    propagateExternalEvents: function (evt) {\r\n        // Menu-Overflow\r\n        var $menuOverflow = $(\".bz-overflow-menu\");\r\n        if ($menuOverflow)\r\n            $(document).trigger('click.overflow');\r\n\r\n        // ECM with preview image\r\n        var zoomIsOpen = $(\".jquery-image-zoom\") && $(\".jquery-image-zoom\").css(\"display\") == \"block\";\r\n\r\n        if (zoomIsOpen)\r\n            $(\"div.jquery-image-zoom a\").click();\r\n    },\r\n\r\n    getButtonAction: function (action) {\r\n        return this.allowValidateAndSaveAction && action === \"validate\" ? \"save\" : action;\r\n    }\r\n\r\n});\r\n","/**\r\n * Render a new type of form called template\r\n *\r\n * @author Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.formTemplate\", {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        this._super(params);\r\n        if(params.paramsRender && params.paramsRender.contextEvent){\r\n            self.contextEvent = params.paramsRender.contextEvent;\r\n        }\r\n    },\r\n\r\n\t/**\r\n\t * Process controls on template\r\n\t * @param template\r\n\t * @param controls\r\n\t * @return {*}\r\n\t */\r\n\tprocessTemplate: function(template, controls) {\r\n\t    var regexControl = /\\{\\{([\\w:]*)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\})\\}\\}/g;\r\n\t\tvar regexRepeater = /\\{\\{(((repeater)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\}))|([\\/repeater]+:item)|(\\/repeater)|(repeater)|(separator))\\}\\}/g;\r\n\r\n\t\t// Remove all repeaters key words\r\n\t\tvar processedTemplate = template.replace(regexRepeater, \"\");\r\n\r\n\t\t// replace controls\r\n\t\tprocessedTemplate = processedTemplate.replace(regexControl, function(match, g1, g2, offset, string) {\r\n\t\t    var parameters = JSON.parse(g2);\r\n            \r\n\t\t\treturn controls[parameters.id] || '';\r\n\t\t});\r\n\r\n\t    processedTemplate = processedTemplate.replace(/{{([\\w:]*)\\s*}}/g, function() {\r\n\t        return '';\r\n\t    });\r\n\r\n\r\n\t\treturn processedTemplate;\r\n\t},\r\n\r\n\t/**\r\n\t * Render layout container\r\n\t * @return {*}\r\n\t */\r\n\trenderContainer: function() {\r\n\t\tvar self = this;\r\n\t\tvar layoutCollection = self.getRenderByType(\"layout\");\r\n\t\tvar layout = (layoutCollection.length > 0) ? layoutCollection[0] : {};\r\n\t\tvar template = (typeof layout.getTemplate == \"function\") ? layout.getTemplate() : \"\";\r\n\t\tvar css = (typeof layout.getCss == \"function\") ? layout.getCss() : \"\";\r\n\t\tvar mode = self.getMode();\r\n\t\tvar layoutGuid = self.properties.layoutguid || Math.guid();\r\n\r\n\t\tvar controls = {};\r\n\r\n\t\t/**\r\n\t\t * Render all elements within first layout container\r\n\t\t */\r\n\t\tif(layout.children) {\r\n\t\t\t$.each(layout.children, function(i, child) {\r\n\t\t\t    // ignore layoutPlaceholder control in execution\r\n\t\t\t    if (!(mode == 'execution' && child.properties.type == 'layoutPlaceholder')) {\r\n\r\n\t\t\t        var type = child.getElementType();\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n\t\t\t            controls[child.properties.id] = child.renderElement();\r\n\t\t\t        }\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n\t\t\t            controls[child.properties.id] = child.renderContainerHtml();\r\n\t\t\t        }\r\n\t\t\t        self.childrenHash[child.properties.uniqueId] = child;\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Load css\r\n\t\tbizagi.util.loadStyle(css, layoutGuid);\r\n\r\n\t\treturn self.processTemplate(template, controls);\r\n\t},\r\n\r\n    /**\r\n     * Get the context in which loads the formTemplate\r\n     *\r\n     */\r\n    getContextEvent: function(){\r\n        return self.contextEvent;\r\n    }\r\n});\r\n","$.Class.extend(\"bizagi.rendering.layout\", {}, {\r\n\r\n\t/**\r\n\t * Get html template\r\n\t * @return {*}\r\n\t */\r\n\tgetTemplate: function() {\r\n\t    var self = this;\r\n\t    var mode = self.getMode();\r\n\t    var html = self.properties.html || \"\";\r\n\r\n        // Add a container, this is important in design to calculate the scroll \r\n\t    if (mode == 'design' && html) {\r\n            html = \"<div class='bz-design-template'>\" + html + \"</div>\"\r\n\t    }\r\n\t\t\r\n\t\treturn bizagi.util.stripslashes(html);\r\n\t},\r\n\r\n\t/**\r\n\t * Get string css of layout container\r\n\t * @return {*}\r\n\t */\r\n\tgetCss: function() {\r\n\t    var self = this;\r\n\t\tvar css = self.properties.css || \"\";\r\n\r\n\t\tvar mode = self.getMode();\r\n\t\tif (mode == \"design\") {\r\n\t\t    css = css && css.desktop;\r\n\t\t}\r\n\r\n\t\treturn bizagi.util.stripslashes(css);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t *   Template method to process each jquery object\r\n\t *   must be overriden in each container\r\n\t */\r\n\tpostRenderContainer: function(container) {\r\n\t\tvar self = this;\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\t// Resolve rendering deferred\r\n\t\tif(self.renderingDeferred)\r\n\t\t\tself.renderingDeferred.resolve();\r\n\r\n\t\t// Process children elements\r\n\t\tself.container = container;\r\n\t\tself.executeChildrenPostRender(container);\r\n\r\n\t\tif(mode == \"execution\") {\r\n\t\t\t// Apply handlers\r\n\t\t\tself.configureHandlers();\r\n\t\t}\r\n\t\tif(mode == \"design\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t}\r\n\t\tif(mode == \"layout\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t\tself.configureLayoutView();\r\n\t\t}\r\n\t}\r\n});","/*\r\n*   Name: BizAgi Accordion Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordion\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Enumerate the children appending a property\r\n        $.each(self.children, function (i, child) {\r\n            child.properties.ordinal = i;\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordion\");\r\n\r\n        // Render the accordion\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Accordion Item Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion item class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordionItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordionItem\");\r\n\r\n        // Render the accordionItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            ordinal: properties.ordinal,\r\n            displayName: properties.displayName,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Fires when the accordionItem is selected \r\n    */\r\n    activate: function () {\r\n        var self = this;\r\n        self.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render CollectionNavigator\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for collection navigator renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.collectionnavigator\", {}, {\r\n\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        self._super(params);\r\n\r\n        var properties = self.properties;\r\n        properties.allowAdd = (typeof properties.allowAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.withAddForm = properties.withAddForm && properties.allowAdd;\r\n        properties.allowEdit = (typeof properties.allowEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.withEditForm = properties.withEditForm && properties.allowEdit;\r\n        properties.allowDetail = (typeof properties.allowDetail != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n        properties.inlineAdd = (typeof properties.inlineAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineAdd) : true;\r\n        properties.inlineAdd = properties.inlineAdd && properties.allowAdd;\r\n        properties.inlineEdit = (typeof properties.inlineEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.inlineEdit = properties.inlineEdit && properties.allowEdit;\r\n        properties.allowDelete = (typeof properties.allowDelete != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        self.orientation = self.properties.orientation || \"ltr\",\r\n        self.data = self.properties.data;\r\n        self.keys = self.data ? self.getKeys(self.data.rows) : [];\r\n        self.pointer = 0;\r\n        self.totalRows = 0;\r\n        self.inlineAddRecords = [];\r\n\r\n        if (self.data) {\r\n            self.totalRows = self.data.rows.length;\r\n        }\r\n    },\r\n    /*\r\n    * Normalize keys\r\n    */\r\n    getKeys: function (rows) {\r\n        rows = rows || [];\r\n        var keys = [];\r\n\r\n        for (var i = 0, l = rows.length; i < l; i++) {\r\n            var row = rows[i];\r\n            keys.push(row[0]);\r\n        }\r\n        return keys;\r\n    },\r\n\r\n    /*\r\n    *   Render the control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var templateItem = \"collectionnavigator\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var mode = self.getMode();\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId,\r\n            displayName: properties.displayName ? properties.displayName : \"\",\r\n            id: properties.id,\r\n            guid: properties.guid,\r\n            showPreview: self.showPreview(),\r\n            mode: mode,\r\n            orientation: self.getFormContainer().properties.orientation\r\n        });\r\n\r\n        html = self.drawControls(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Render version readonly of control\r\n    */\r\n    renderReadOnly: function () {        \r\n        return this.renderControl();\r\n    },\r\n\r\n    /*\r\n    * Draw navigation controls\r\n    */\r\n    drawControls: function (html) {\r\n\r\n    },\r\n\r\n    /*\r\n    *  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw a preview views, it will be show when the collection hasn't records\r\n    */\r\n    drawPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var templateItem = (mode === \"execution\") ? \"collectionnavigator-execution\" : \"collectionnavigator-preview\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var html = $.tmpl(template);\r\n\r\n        self.canvas.append(html);\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns true if the collection has data\r\n    */\r\n    hasData: function () {        \r\n        return this.getTotalRows() > 0;\r\n    },\r\n\r\n    /*\r\n    * Returns the key of current row\r\n    */\r\n    getRow: function () {        \r\n        return this.keys[this.pointer];\r\n    },\r\n\r\n    /*\r\n    * Returns the key of next row\r\n    */\r\n    getNextRow: function () {\r\n        var self = this;\r\n\r\n        if (self.getTotalRows() > (self.pointer + 1))\r\n            self.pointer += 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of previous row\r\n    */\r\n    getPreviousRow: function() {\r\n        var self = this;\r\n\r\n        if (self.pointer > 0)\r\n            self.pointer -= 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of first row\r\n    */\r\n    getFirstRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = 0;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of last row\r\n    */\r\n    getLastRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = self.keys.length - 1;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the total numbers of rows in collection\r\n    */\r\n    getTotalRows: function () {        \r\n        return this.keys.length;\r\n    },\r\n\r\n    getIndexes: function () {        \r\n        return this.properties.data.rows;\r\n    },\r\n\r\n    /*\r\n    * Sets the pointer to a specific position\r\n    */\r\n    setPointer: function (index) {        \r\n        this.pointer = index - 1;\r\n    },\r\n\r\n    /*\r\n    * Returns true is there is a inline row pending to save\r\n    */\r\n    isTherePendingInlineRow: function() {\r\n        return this.inlineAddRecords.length > 0;\r\n    },\r\n\r\n    /*\r\n    * Adds new row to collection\r\n    */\r\n    addKey: function (newId) {        \r\n        this.keys.push(newId);\r\n    },\r\n\r\n    /*\r\n    * Removes row in collection\r\n    */\r\n    removeKey: function () {\r\n        var self = this;\r\n        var index = self.pointer;\r\n\r\n        if (index >= 0) {\r\n            self.keys.splice(index, 1);\r\n\r\n            var totalRows = self.getTotalRows();\r\n            if (totalRows > 0 && index >= totalRows) {\r\n                self.setPointer(totalRows);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns true if the control should show the preview view\r\n    * ex. if the collection is empty \r\n    */\r\n    showPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode == \"execution\") {\r\n            return !self.hasData();\r\n        } else {\r\n            return !bizagi.util.parseBoolean(properties.navigationform);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the parameters needed for the request\r\n    */\r\n    getParameters: function (params) {\r\n        var self = this;\r\n\r\n        var parameters = {};\r\n        var properties = self.properties;\r\n        var recordXpath = properties.xpath + \"[id=\" + params.id + \"]\";\r\n\r\n        parameters.idRender = properties.id;\r\n        parameters.recordXPath = recordXpath;\r\n        parameters.xpathContext = properties.xpathContext;\r\n        parameters.idPageCache = properties.idPageCache;\r\n        parameters.requestedForm = params.requestedForm;\r\n        parameters.contextType = properties.contextType || properties.contexttype;\r\n        parameters.url = params.url;\r\n        parameters.editable = params.editable;\r\n        orientation: properties.orientation || \"ltr\";\r\n\r\n\r\n        return parameters;\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator add record request\r\n    *   Returns a deferred when done, the server returns an id for the new record\r\n    */\r\n    submitAddRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype || '',\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({ message: message });\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + \"[id=\" + id + \"]\" : properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function() {\r\n\r\n            self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                contexttype: properties.contextType || properties.contexttype || \"\",\r\n                submitData: data\r\n            }).done(function(response) {\r\n                defer.resolve(response);\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n    \r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator rollback request\r\n    *   Returns a deferred when done\r\n    */\r\n    submitRollbackRequest: function (error) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: error.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache\r\n\r\n        });\r\n\r\n        return self.dataService.getData(params);\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var form = this.form;\r\n\r\n        if (typeof (form) !== \"undefined\") {\r\n            (form.children || []).forEach(function (child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        if (!child.isValid(invalidElements)) {\r\n                            var content = invalidElements[invalidElements.length - 1];\r\n                            invalidElements[invalidElements.length - 1] = $.extend(content, {\r\n                                id: child.properties.id\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length === 0;\r\n    },\r\n\r\n    validateControls: function(invalidElements) {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations(invalidElements);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Group Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a group container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.group\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property \r\n        properties.cssclass = properties.cssclass || \"cssClassContainer\";\r\n\r\n        properties.collapse = (typeof properties.collapse != \"undefined\" && bizagi.util.parseBoolean(properties.collapse)) ? true : false;\r\n    },\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"group\");\r\n\r\n        // Define icons\r\n        self.expandedIcon = self.getExpandedIcon();\r\n        self.collapsedIcon = self.getCollapsedIcon();\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            expandedClassIcon: self.expandedIcon,\r\n            displayName: properties.displayName,\r\n            editable: properties.editable,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            collapse: properties.collapse,\r\n            isDesign: (self.getMode() !== \"execution\"),            \r\n            messageValidation: properties.messageValidation,\r\n            cssclass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Returns the expanded icon\r\n    */\r\n    getExpandedIcon: function () { },\r\n\r\n    /*\r\n    *   Returns the collapsed icon\r\n    */\r\n    getCollapsedIcon: function () { },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument, bImmediate) { }\r\n\r\n});","/*\r\n*   Name: BizAgi Horizontal Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a tab item class for all devices\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.horizontal\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"horizontal\");\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.panel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"panel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            loading: properties.loading,\r\n            message: properties.message,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssClass: properties.cssclass\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function(panel) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set height\r\n        if (properties.height) {\r\n            panel.height(properties.height);\r\n        }\r\n\r\n        // Call base\r\n        self._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.contentPanel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"contentPanel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            mode: self.getMode(),\r\n            uniqueId: properties.uniqueId,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            cssClass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (panel) {\r\n        // Call base\r\n        this._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchForm\");\r\n\r\n\r\n        if (properties.contexttype != \"entity\" && self.parent) {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        } \r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n\r\n        // Render result\r\n        html = html.replace(\"{{result}}\", self.renderResult());\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Perform a search and render the results\r\n    */\r\n    performSearch: function (searchParams) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set parameter to search\r\n        properties.searchParams = searchParams;\r\n\r\n        // Submit the search to the server\r\n        self.submitSearch();\r\n    },\r\n\r\n    /*\r\n    *   Submits the query to the server\r\n    */\r\n    submitSearch: function () {\r\n        var self = this;\r\n\r\n        // Makes the results to update its contents\r\n        self.refreshResults();\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return self.parent.ready();\r\n    },\r\n\r\n    /*\r\n    *   Method to fill the result data\r\n    *   (THIS IS CALLED WITHIN GRID RENDER SCOPE)\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Collect data\r\n        var data = self.collectSearchValues();\r\n\r\n        if (bizagi.util.isMapEmpty(data)) {\r\n            bizagi.showMessageBox(this.getResource(\"render-search-advanced-no-filters\"), this.getResource(\"render-form-dialog-box-search\"), \"error\");\r\n            return null;\r\n        }\r\n\r\n        params.rows = (properties.searchParams && properties.searchParams.maxRecords && properties.searchParams.maxRecords > 0) ? properties.searchParams.maxRecords : params.rows;\r\n\r\n        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)         \r\n        if (properties.searchParams && typeof(properties.searchParams.maxRows) !== \"undefined\") {\r\n            params.rows = properties.searchParams.maxRows || params.rows;\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.submitSearch($.extend(params, {\r\n            url: properties.dataUrl,\r\n            idRender: properties.idRender,\r\n            idPageCache: properties.idPageCache,\r\n            idSearchForm: properties.id,\r\n            allowFullSearch: (properties.searchParams.allowFullSearch ? properties.searchParams.allowFullSearch : null),\r\n            maxRecords: (properties.searchParams.maxRecords > 0 ? properties.searchParams.maxRecords : null),\r\n            criteria: data\r\n\r\n        })).done(function (response) {\r\n\r\n            // Resolve with fetched data    \r\n            properties.page = response.page;\r\n            properties.records = response.records;\r\n            properties.totalPages = response.totalPages || 0;\r\n\r\n            //In tablets are allowed about 10000 records as maximum\r\n            if (response.records > 10000) {\r\n                properties.deviceMaxRecordsExceeded = true;\r\n                response.deviceMaxRecordsExceeded = true;\r\n            } else {\r\n                delete properties.deviceMaxRecordsExceeded;\r\n            }\r\n            \r\n            defer.resolve(response);\r\n\r\n            // Call virtual method\r\n            self.onSearchFinished();\r\n        }).fail(function (errorObject) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            if (errorObject.responseText) {\r\n                try {\r\n                    var message = JSON.parse(errorObject.responseText).message;\r\n                    bizagi.showMessageBox(message, \"\", \"error\");\r\n                } catch (e) { }\r\n            }\r\n            defer.reject();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    *   - Overriden because server needs this in array\r\n    */\r\n    collectSearchValues: function () {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = {};\r\n        this.collectRenderValues(data);\r\n\r\n        // Changes to array\r\n        var submitArray = [];\r\n        for (key in data) {\r\n            var xpath = key;\r\n            var value = data[key];\r\n            var operation = self.getCriteriaOperation(self.getRender(xpath));\r\n            var criteriaData = {};\r\n            if (!bizagi.util.isEmpty(value)) {\r\n                criteriaData[\"xpath\"] = xpath;\r\n                criteriaData[\"value\"] = value;\r\n                criteriaData[\"operation\"] = operation;\r\n                submitArray.push(criteriaData);\r\n            }\r\n        }\r\n\r\n        return submitArray;\r\n    },\r\n\r\n    /*\r\n    *   This method find out the criterial operation to be executed according to\r\n    *   data type. Text renders use LIKE operation, but other data types such like\r\n    *   numerics use exact match operatiors\r\n    */\r\n    getCriteriaOperation: function (render) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var operation = \"EQUALS\";\r\n        if (render.properties.dataType == \"15\") {\r\n            if (typeof render.properties.typeSearch === \"undefined\" || render.properties.typeSearch === \"approx\"){\r\n                if (properties.allowFullSearch) {\r\n                    operation = \"FULLLIKE\";\r\n                }\r\n                else {\r\n                    operation = \"LIKE\";\r\n                }\r\n            }\r\n        }\r\n        return operation;\r\n    },\r\n\r\n    /*\r\n    *   Render the result controls for the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () { },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () { },\r\n\r\n    /*\r\n    *   Function to parse the dataType\r\n    */\r\n    parseAdditionalProperties: function (dataType) {\r\n\r\n        // Number\r\n        if (dataType == 1 || dataType == 2 || dataType == 3 ||\r\n            dataType == 4 || dataType == 6 || dataType == 7 ||\r\n            dataType == 10 || dataType == 11 ) {\r\n\r\n            return { type: \"columnNumber\" };\r\n        }\r\n\r\n\r\n        // Oracle Number\r\n        if (dataType == 29) {\r\n\r\n            return { type: \"columnNumberScientificNotation\" };\r\n        }\r\n\r\n        // Money\r\n        if (dataType == 8) {\r\n\r\n            return { type: \"columnMoney\" };\r\n        }\r\n\r\n        // Date\r\n        if (dataType == 12 || dataType == 13) {\r\n\r\n            return { type: \"columnDate\" };\r\n        }\r\n\r\n        // Boolean\r\n        if (dataType == 5) {\r\n\r\n            return { type: \"columnBoolean\" };\r\n        }\r\n\r\n        // Text\r\n        return { type: \"columnText\" };\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    onSearchFinished: function () {\r\n        // Empty function, overrided for Tablet version for now\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Tab Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a tab container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tab\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property\r\n        properties.cssclass = properties.cssclass || \"\";\r\n    },\r\n\r\n    /*\r\n     *   Render the container layout\r\n     */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var tabItems = $.map(self.children, function(child, key) {\r\n            child.properties.counter = key;\r\n            child.properties.tooltip =  child.properties.tooltip || child.properties.displayName || \"\";\r\n            return child.properties;\r\n        });\r\n        var template = self.renderFactory.getTemplate(\"tab\");\r\n        var mode = self.getMode();\r\n\r\n        // Render the tab\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            tabs: tabItems,\r\n            mode: mode,\r\n            isDesign: (self.getMode() !== \"execution\"),\r\n            editable: properties.editable,\r\n            tabOrientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssclass: properties.cssclass\r\n        });\r\n\r\n        // Get active container based on focus\r\n        var activeTab = self.activeTab = self.getActiveTab();\r\n\r\n        // Render children\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            self.children[i].properties.loadOnDemand = (i != activeTab);\r\n        }\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Return the active tab containing the focus, or the first tab\r\n     */\r\n    getActiveTab: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = this.getFormContainer().getParams();\r\n        var mode = self.getMode();\r\n\r\n        if (mode === \"execution\") {\r\n            if (!formParams.isRefresh && properties.activeTab) {\r\n                self.getFormContainer().setFocusedElement(properties.activeTab);\r\n            }\r\n        }\r\n\r\n        var selectedTabs = formParams && formParams.selectedTabs ? formParams.selectedTabs : {};\r\n\r\n        // Fetch from selected tabs collection\r\n        if (selectedTabs[self.properties.id] >= 0) {\r\n            return selectedTabs[self.properties.id];\r\n        }\r\n\r\n        // Check for focused elements\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            if (self.children[i].containsFocusedElement()) return i;\r\n        }\r\n        return 0;\r\n    },\r\n\r\n    /**\r\n     * Update position of tab\r\n     * @param index\r\n     */\r\n    setActiveTab: function (index) {\r\n        var self = this;\r\n\r\n        self.triggerHandler(\"selected\", { index: index, tab: self.children[index] });\r\n\r\n        if (self.children[index]) {\r\n            var form = self.getFormContainer();\r\n\r\n            self.children[index].activate();\r\n            self.activeTab = index;\r\n\r\n            var selectedTab = {};\r\n            selectedTab[self.children[index].parent.properties.id] = index;\r\n            form.setParam(\"selectedTabs\", selectedTab);\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Tab Item Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a tab item class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"tabItem\");\r\n\r\n        // Render the tabItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            uniqueId: properties.uniqueId,\r\n            counter: properties.counter,\r\n            isDesign: (self.getMode() !== \"execution\")\r\n        });\r\n\r\n        // Render content\r\n        html = self.renderTabContent(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        // Render children\r\n        return this.replaceChildrenHtml(html, this.renderChildrenHtml());\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected \r\n    */\r\n    activate: function () {\r\n        this.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    },\r\n\r\n    /*\r\n    *   Return true if this tab contains the active focused element\r\n    */\r\n    containsFocusedElement: function () {\r\n        var self = this;\r\n        var focus = self.getFormContainer().getFocusedElement();\r\n\r\n        if (focus) {\r\n\r\n            // Locate element\r\n            if (focus.xpath) {\r\n                // Search by xpath and id\r\n                var elements = self.getFormContainer().getRenders(focus.xpath);\r\n                var element;\r\n\r\n                $.each(elements, function (i, item) {\r\n                    // Just select editable control\r\n                    if (item.properties.id == focus.id && item.properties.editable) {\r\n                        element = item;\r\n                    }\r\n                });\r\n            } else {\r\n                // Search just using id\r\n                var element = self.getFormContainer().getContainer(focus) || self.getFormContainer().getRenderById(focus);\r\n            }\r\n\r\n            // Search element parent\r\n            if (element) {\r\n                while (element.parent) {\r\n                    if (element.properties.id == self.properties.id || element.parent.properties.id == self.properties.id) return true;\r\n                    element = element.parent;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Nested Form Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a nested form container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.nestedForm\", {}, {\r\n\r\n});","/**\r\n * Base definition of Action Launcher and Entity template controls\r\n *\r\n * @author: Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n        this.typeForm = form.properties.typeForm || \"\";\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        if (mode == \"execution\") {\r\n            self.engine = new bizagi.templateEngine({\r\n                renderFactory: self.renderFactory,\r\n                cache: true,\r\n                autoGenerateData: false,\r\n                templateGuid: properties.selecttemplate\r\n            });\r\n        }\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"ptags\": self.properties.tagslist || [],\r\n            \"pmaxitems\": self.properties.maxItems,\r\n            \"pactionXpath\": self.properties.xpathActions\r\n        };\r\n\r\n        self.processPropertyValueDataTmplArgs = {\r\n            \"pactionXpath\": self.properties.xpathActions,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"ptemplateGuid\": properties.selecttemplate,\r\n            \"property\": \"dataTemplate\",\r\n            \"xpathActions\": self.properties.xpathActions\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        var defaultAllowActions = data.properties.type === \"entityTemplate\" ? false : true;\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\")\r\n            ? defaultAllowActions : data.properties.allowactions;\r\n        self.properties.isHorizontal = (typeof data.properties.isHorizontal == \"undefined\")\r\n            ? true : data.properties.isHorizontal;\r\n        self.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\")\r\n            ? false : data.properties.allowSearch;\r\n        self.properties.selecttemplate = (typeof data.properties.selecttemplate == \"undefined\")\r\n            ? \"\" : data.properties.selecttemplate;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\")\r\n            ? properties.templatetype : 'none';\r\n\r\n        self.properties.sessionId = form.params.data.sessionId;\r\n\r\n        if (!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n            self.properties.originalValue = [];\r\n        } else if (typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Send processpropertyvalue in order to execute an Action\r\n     * This method is used when this control stay in Summary form or Global form\r\n     * @param action\r\n     */\r\n    executeActionImmediately: function (action) {\r\n        var self = this;\r\n        //Execute action immediately\r\n        var form = self.getFormContainer();\r\n\r\n        var processPropertyValueExecuteAction = {\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"executeAction\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"pguidAction\": action.guidAction,\r\n            \"pparameters\": JSON.encode({\r\n                \"idStartScope\": action.idStartScope,\r\n                \"pactionXpath\": self.properties.xpathActions,\r\n                \"idPageCache\": action.idPageCache\r\n            })\r\n        };\r\n\r\n        self.dataService.executeActions(processPropertyValueExecuteAction).done(function (data) {\r\n            self.notifyExecution(data, action);\r\n        }).fail(function (error) {\r\n            // TODO: Create generic mechanism to send notifications\r\n            self.notifyExecution(\"Error\", action);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * notify action execution status\r\n     * @param response\r\n     * @param actionName\r\n     */\r\n    notifyExecution: function (response, actionName) {\r\n        // To override in each device\r\n    },\r\n\r\n    /**\r\n     * Render control in read only mode: properties.editable = false\r\n     * @return {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Make a postrender of readonly control\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.properties.readOnly = true;\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @return {string}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher-design\");\r\n            var params = {\r\n                type: properties.type,\r\n                isHorizontal: properties.isHorizontal,\r\n                allowSearch: properties.allowSearch,\r\n                templateDefined: properties.templatetype != 'none',\r\n                allowactions: properties.allowactions\r\n            };\r\n            html = $.fasttmpl(template, params);\r\n        } else if (properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher\");\r\n            html = $.fasttmpl(template, { allowactions: self.properties.allowactions });\r\n        }\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @return {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var value = self.getValue();\r\n        var bValid = false;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) {\r\n            return true;\r\n        }\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.value) {\r\n                if (self.value.length > 0)\r\n                    return true;\r\n                message = self.getResource(\"render-required-register-action\");\r\n                invalidElements.push({ xpath: properties.xpath, message: message });\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Process an action\r\n     * @param action\r\n     */\r\n    actionManager: function (action) {\r\n        var self = this;\r\n        var guidProcess = action.guidProcess || \"\";\r\n        var def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n        /**\r\n         * Check if action is a process\r\n         */\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                // Verify if case has startform\r\n                var params = {\r\n                    guidWFClass: guidProcess\r\n                };\r\n\r\n                $.when(self.dataService.hasStartForm(params)).done(function (result) {\r\n                    if (result.hasStartForm) {\r\n                        // Open a dialog with startform and wait for Scope\r\n                        $.when(self.processStartForm({\r\n                            guidprocess: guidProcess,\r\n                            title: action.displayName,\r\n                            recordXpath: action.recordXpath\r\n                        })).done(function (idStartScope) {\r\n                            action.idStartScope = idStartScope;\r\n                            def.resolve(action);\r\n                        });\r\n                    } else {\r\n                        // Just add action to queue to be executed on nextEvent\r\n                        def.resolve(action);\r\n                    }\r\n                });\r\n\r\n                break;\r\n            case \"Rule\":\r\n                // Just add action to queue to be executed on nextEvent\r\n                def.resolve(action);\r\n                break;\r\n            case \"Form\":\r\n                // If it has additional xpath this action is a form of collection\r\n                if (action.xpathContext) {\r\n                    $.when(self.processActionFormCollection(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                } else {\r\n\r\n                    if (action.actionType === \"Form\") {\r\n                        action.xpathContext = undefined;\r\n                        action.contextType = \"entitytemplate\";\r\n                        action.guidEntity = action.guidEntity || self.properties.guidEntity;\r\n                    }\r\n\r\n                    $.when(self.processActionForm(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                }\r\n                break;\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add actions within value object\r\n     * @param action\r\n     */\r\n    addActionToQueue: function (action) {\r\n        var self = this;\r\n        var actionsList = self.getValue();\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        action.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n            case \"Form\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    entityXpath: self.properties.xpathActions,\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    idEntity: action.idEntity\r\n                };\r\n                break;\r\n            case \"Rule\":\r\n                action.params = {\r\n                    xpathActions: action.xpathActions || \"\",\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n        }\r\n\r\n        var newValueActionsList = bizagi.clone(actionsList);\r\n        newValueActionsList.push(action);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n\r\n    /**\r\n     * Remove action within value object\r\n     * @param index\r\n     */\r\n    removeActionToQueue: function (index) {\r\n        var self = this;\r\n        var newValueActionsList = bizagi.clone(self.getValue());\r\n        newValueActionsList.splice(index, 1);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            var properties = self.properties;\r\n            var xpath = properties.xpath;\r\n            var controlValue = self.getValue();\r\n            var actions = [];\r\n            $.each(controlValue, function (index, value) {\r\n                var action = {};\r\n                action.params = value.params || {};\r\n                action.guidAction = value.guidAction;\r\n\r\n                actions.push(action);\r\n            });\r\n            renderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Util to count how many actions are there\r\n     * @param action\r\n     * @return {number}\r\n     */\r\n    countSameActions: function (action) {\r\n        var self = this;\r\n        var value = self.getValue();\r\n        var count = 0;\r\n        $.each(value, function (key, value) {\r\n            if (value.guidAction == action.guidAction) {\r\n                count++;\r\n            }\r\n        });\r\n        return count;\r\n    },\r\n\r\n    /**\r\n    * Normalize action launcher control properties\r\n    * @param actionsLaucher\r\n    * @returns {*}\r\n    */\r\n    getPropertiesActionLaucher: function (actionsLaucher) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        /**\r\n         * The properties of actionLaucher have to 7 properties mandatory\r\n         * 0: guidProcess\r\n         * 1: displayName\r\n         * 2: title\r\n         * 3: actionType\r\n         * 4: guidaction\r\n         * 5: xpathContext\r\n         * 6: readOnlyForm: default: false\r\n         */\r\n        for (var i = 0, length = actionsLaucher.length, j = length; i < j; i += 1) {\r\n            //some ocassions server return 6 or 7 items\r\n            //return 6 properties when launch form action from action launcher control.\r\n            //in this case dont return xpathContext.\r\n            // So, add item position 5, simulate xpathContext empty.\r\n            if (actionsLaucher[i].length === 6) {\r\n                actionsLaucher[i].splice(5, 0, \"\");\r\n\r\n                if (actionsLaucher[i][3] == \"Process\" && form.properties.xpathContext) {\r\n                    actionsLaucher[i][5] = form.properties.xpathContext;\r\n                }\r\n            }\r\n        }\r\n\r\n        return actionsLaucher;\r\n    }\r\n});\r\n","/**\r\n * Base definition of entity template\r\n *\r\n * @author: Andres Fernando Muñoz\r\n * based on action launcher control\r\n */\r\n$.Class.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\") ? true : data.properties.allowactions;\r\n\r\n        if(!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n        } else if(typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate-design\");\r\n            html = $.fasttmpl(template, {});\r\n        }\r\n        else if(self.properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate\");\r\n            html = $.fasttmpl(template, {allowactions: self.properties.allowactions});\r\n        }\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        // TODO: write functionality\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n});","/**\r\n * Base definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n\t/*\r\n\t * Constructor\r\n\t */\r\n\tinit: function(params) {\r\n\t\t// Call base\r\n\t\tthis._super(params);\r\n\t},\r\n\r\n\t/*\r\n\t * Initialize the control with data provided\r\n\t */\r\n\tinitializeData: function(data) {\r\n\t\tvar self = this;\r\n\t\t// Call base\r\n\t\tthis._super(data);\r\n\t\tvar form = self.getFormContainer();\r\n\t\tthis.typeForm = form.properties.typeForm || \"\";\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\tself.deferredActions = new $.Deferred();\r\n\t\tself.deferredActions.promise();\r\n\r\n\t\tself.properties.valueWidth = 100;\r\n\t\tself.properties.displayType = \"value\";\r\n\t\tself.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\") ? false : data.properties.allowSearch;\r\n\t\tself.properties.additionalXpath = self.properties.additionalXpath || [];\r\n\r\n\t\tif(!self.properties.value) {\r\n\t\t\tself.properties.value = self.value = [];\r\n\t\t\tself.properties.originalValue = [];\r\n\t\t} else if(typeof self.properties.value == \"string\") {\r\n\t\t\tself.properties.value = self.value = JSON.parse(self.properties.value);\r\n\t\t}\r\n\r\n\t\t// Data of get process property value\r\n\t\tself.processPropertyValueArgs = {\r\n\t\t\t\"pcaseId\": self.getIdCase(),\r\n\t\t\t\"pguidEntity\": self.properties.guidEntity,\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"data\",\r\n\t\t\t\"ptags\": self.getTagList(self.properties.tagslist),\r\n\t\t\t\"additionalXpaths\": self.properties.additionalXpath\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Send processpropertyvalue in order to execute an Action\r\n\t * This method is used when this control stay in Summary form or Global form\r\n\t * @param action\r\n\t */\r\n\texecuteActionImmediately: function(action) {\r\n\t\tvar self = this;\r\n\t\t//Execute action immediately\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\tvar processPropertyValueExecuteConstructor = {\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"executeConstructor\",\r\n\t\t\t\"psurrogatedKey\": self.properties.surrogatedKey,\r\n\t\t\t\"pguidConstructor\": action.guidConstructor,\r\n\t\t\t\"pparameters\": JSON.encode({\r\n\t\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\t\"pactionXpath\": self.properties.xpathActions,\r\n\t\t\t\t\"idPageCache\": action.idPageCache\r\n\t\t\t})\r\n\t\t};\r\n\r\n\t\tself.dataService.executeActions(processPropertyValueExecuteConstructor).done(function(data) {\r\n\t\t\tself.notifyExecution(data.response, action);\r\n\t\t}).fail(function(error) {\r\n\t\t\t// TODO: Create generic mechanism to send notifications\r\n\t\t\tself.notifyExecution(\"Error\", action);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * notify action execution status\r\n\t * @param response\r\n\t */\r\n\tnotifyExecution: function(response, actionName) {\r\n\t\t// To override in each device\r\n\t},\r\n\r\n\t/**\r\n\t * Render control in read only mode: properties.editable = false\r\n\t * @return {*}\r\n\t */\r\n\trenderReadOnly: function() {\r\n\t\treturn this.renderControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Make a postrender of readonly control\r\n\t */\r\n\tpostRenderReadOnly: function() {\r\n\t\tthis.properties.readOnly = true;\r\n\t\tthis.postRender();\r\n\t},\r\n\r\n\t/**\r\n\t * Template method to implement in each children to customize each control\r\n\t * @return {string}\r\n\t */\r\n\trenderControl: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar template;\r\n\t\tvar html = \"\";\r\n\r\n\t\t// Render template\r\n\t\tif(mode == \"design\") {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-design\");\r\n\t\t\tvar params = {\r\n\t\t\t\ttype: properties.type,\r\n\t\t\t\tallowSearch: properties.allowSearch\r\n\t\t\t};\r\n\t\t\thtml = $.fasttmpl(template, params);\r\n\t\t} else if(properties.surrogatedKey) {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher\");\r\n\t\t\thtml = $.fasttmpl(template);\r\n\t\t}\r\n\t\treturn html;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Public method to determine if a value is valid or not\r\n\t * @param invalidElements\r\n\t * @return {*}\r\n\t */\r\n\tisValid: function(invalidElements) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\t\t// Call base\r\n\t\tvar bValid = this._super(invalidElements);\r\n\t\tvar value = self.getValue();\r\n\t\t// TODO: write functionality\r\n\t\treturn bValid;\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the value in the rendered control\r\n\t * @param value\r\n\t */\r\n\tsetDisplayValue: function(value) {\r\n\t\tvar self = this;\r\n\t\t// Set internal value\r\n\t\tself.setValue(value, false);\r\n\t},\r\n\r\n\t/**\r\n\t * Process an action\r\n\t * @param action\r\n\t */\r\n\tactionManager: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar guidProcess = action.guidObject || \"\";\r\n\t\tvar def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n\t\t/**\r\n\t\t/**\r\n\t\t * Check if action is a process\r\n\t\t */\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\t// Verify if case has startform\r\n\t\t\t\tvar params = {\r\n\t\t\t\t\tguidWFClass: guidProcess\r\n\t\t\t\t};\r\n\r\n\t\t\t\t$.when(self.dataService.hasStartForm(params)).done(function(result) {\r\n\t\t\t\t\tif(result.hasStartForm) {\r\n\t\t\t\t\t\t// Open a dialog with startform and wait for Scope\r\n\t\t\t\t\t\t$.when(self.processStartForm({\r\n\t\t\t\t\t\t\tguidprocess: guidProcess,\r\n\t\t\t\t\t\t\ttitle: action.displayNamee,\r\n                            recordXpath: action.recordXpath\r\n\t\t\t\t\t\t})).done(function(idStartScope) {\r\n\t\t\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\tdef.resolve(action);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\t$.when(self.processActionForm(action)).done(function(idStartScope) {\r\n\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Add actions within value object\r\n\t * @param action\r\n\t */\r\n\taddActionToQueue: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar actionsList = self.getValue();\r\n\t\tvar formParams = self.getFormContainer().getParams();\r\n\t\t\r\n\t\taction.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n\t\t\t\t};\r\n                if (typeof action.idStartScope !== \"undefined\") {\r\n                    action.params.idStartScope = action.idStartScope;\r\n                }\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tidStartScope: action.idStartScope,\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tentityXpath: self.properties.xpathActions,\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n\t\t\t\t\tidEntity: action.idEntity,\r\n\t\t\t\t\tguidEntity: action.guidEntity\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t//TODO\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tactionsList.push(action);\r\n\t\tself.setValue(actionsList);\r\n\t\tself.setDisplayValue(actionsList);\r\n\t},\r\n\r\n\t/**\r\n\t * Remove action within value object\r\n\t * @param index\r\n\t */\r\n\tremoveActionToQueue: function(index) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvalue.splice(index, 1);\r\n\t\tself.setValue(value);\r\n\t\tself.setDisplayValue(value);\r\n\t},\r\n\t/**\r\n\t * Add the render data to the given collection in order to send data to the server\r\n\t * @param renderValues\r\n\t */\r\n\tcollectData: function(renderValues) {\r\n\t\tvar self = this;\r\n\t\tif(self.controlValueIsChanged()) {\r\n\t\t\tvar properties = self.properties;\r\n\t\t\tvar xpath = properties.xpath;\r\n\t\t\tvar controlValue = self.getValue();\r\n\t\t\tvar actions = [];\r\n\t\t\t$.each(controlValue, function(index, value) {\r\n\t\t\t\tvar action = {};\r\n\t\t\t\taction.params = value.params || {};\r\n\t\t\t\taction.guidAction = value.guidObject || value.guidAction;\r\n\t\t\t\taction.displayName = value.displayName;\r\n\t\t\t\taction.guidConstructor = value.guidConstructor;\r\n\t\t\t\taction.actionType = value.actionType;\r\n\t\t\t\taction.xpathContext = value.xpathContext;\r\n\t\t\t\taction.guidEntity = value.guidEntity;\r\n\t\t\t\tactions.push(action);\r\n\t\t\t});\r\n\t\t\trenderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Util to count how many actions are there\r\n\t * @param action\r\n\t * @return {number}\r\n\t */\r\n\tcountSameActions: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvar count = 0;\r\n\t\t$.each(value, function(key, value) {\r\n\t\t\tif(value.guidAction == action.guidAction) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn count;\r\n\t},\r\n\r\n\t/**\r\n\t * Get list of tags\r\n\t * @param taglist\r\n\t * @return {Array}\r\n\t */\r\n\tgetTagList: function(taglist) {\r\n\t\ttaglist = taglist || [];\r\n\t\tvar result = [];\r\n\r\n\t\tfor(var i = taglist.length; i > 0; i--) {\r\n\t\t\tresult.push(taglist[i - 1].value);\r\n\t\t}\r\n\t\treturn (result.length > 0) ? result : \"\";\r\n\t}\r\n});","/**\r\n *   Name: Bizagi Render Combo Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for combo renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.hasLocalData = properties.data || false;\r\n        // TODO: Review additional value in radio control\r\n        properties.value = properties.value && properties.value.length > 0 ? properties.value[0] : (properties.defaultValue && properties.defaultValue.length > 0 ? properties.defaultValue[0] : null);\r\n\r\n        if (typeof (properties.enableTyping) === \"undefined\") properties.enableTyping = true;\r\n        if (properties.value && properties.value.id === undefined) properties.value = null;\r\n        this.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData) {\r\n            properties.data = this.complementData(properties.data);\r\n        }\r\n\r\n        // This line is to set a flag to fetch the data when rendering, or on demand, by default is false, overriding it on desktop implementation\r\n        properties.loadOnDemand = false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var params = {};\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n\r\n        if (self.isDependant && self.properties && /^cascadingcombo$/i.test(renderType) && self.getParentCombo) {\r\n            var valueControl = self.getParentCombo().getValue();\r\n            if (valueControl && valueControl.id) {\r\n                params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = valueControl.id;\r\n            }\r\n        }\r\n\r\n        return self.renderCombo(params);\r\n    },\r\n\r\n    /*\r\n    *   Renders the combo\r\n    */\r\n    renderCombo: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.loadOnDemand) {\r\n            // Render the combo without data\r\n            var html = self.renderComboTemplate();\r\n            return html;\r\n        } else {\r\n\r\n            // Set data promise \r\n            var defer = new $.Deferred();\r\n            var dataPromise = self.getData(params);\r\n\r\n            // Attach callback \r\n            $.when(dataPromise).done(function (data) {\r\n                // Render combo\r\n                var html = self.renderComboTemplate(data);\r\n                self.properties.data = data;\r\n                defer.resolve(html);\r\n\r\n            }).fail(function (data) {\r\n                var html = self.renderComboTemplate({});\r\n                defer.resolve(html);\r\n            });\r\n\r\n            // Returns a promise so we can hold post-render method until this is done\r\n            return defer.promise();\r\n        }\r\n    },\r\n\r\n    renderComboTemplate: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var emptyValue = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n        var value = properties.value ? \"\" : emptyValue;\r\n        data = data || self.properties.data || {};\r\n\r\n        if (self.properties.type === \"columnCombo\" && value === \"\" && typeof properties.value === \"object\" && properties.value.id === \"\" && (properties.value.value === \"\" || properties.value.value === self.getResource(\"render-combo-empty-value\"))) {\r\n            value = self.getResource(\"render-combo-empty-selection\");\r\n        }\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: data,\r\n            align: properties.valueAlign,\r\n            value: value,\r\n            editable: properties.editable\r\n        }));\r\n\r\n\r\n        return html;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n        var item = self.getValue();\r\n        var control = self.getControl();\r\n\r\n        if (self.control && self.control.parent()) {\r\n            self.control.parent().addClass(\"ui-bizagi-noneditable-\" + self.properties.displayType);\r\n        }\r\n        if (item) {\r\n\r\n            if (item.value != null && typeof (item.value) === \"boolean\") {\r\n                if (bizagi.util.parseBoolean(item.value) === true) {\r\n                    item.value = this.getResource(\"render-boolean-yes\");\r\n\r\n                } else if (bizagi.util.parseBoolean(item.value) == false) {\r\n                    item.value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n\r\n            // Returns the cached value from the properties to avoid server side fetching\r\n            if (self.getResource(\"render-combo-empty-value\") === item.value || self.getResource(\"render-combo-empty-selection\") === item.value) {\r\n                control.text(\"\");\r\n            } else {\r\n                control.html(\"<label class='readonly-control'>\" + self.formatItem(item.value) + \"</label>\");\r\n            }\r\n        } else {\r\n            // Render empty \r\n            control.text(\"\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the template used by the combo render\r\n    *   can be overriden in subclasses to reuse logic and just change the template\r\n    */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the empty node or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showEmpty: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode !== \"execution\") return self.getDummyData();\r\n\r\n        if (properties.hasLocalData) {\r\n\r\n            // Resolve with local data    \r\n            defer.resolve(properties.data);\r\n\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n            // Check if the data has been cached\r\n            if (properties.remoteDataLoaded && !(/^cascadingcombo$/i.test(renderType))) {\r\n                defer.resolve(properties.data);\r\n            } else {\r\n                // Go to server\r\n                self.dataService.multiaction().getData({\r\n                    url: properties.dataUrl,\r\n                    xpath: properties.xpath,\r\n                    idRender: properties.id,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    extra: params,\r\n                    contexttype: self.properties.contexttype || null\r\n                }).done(function (data) {\r\n\r\n                    // Resolve the data\r\n                    if (!properties.recalculate) {\r\n                        properties.remoteDataLoaded = true;\r\n                    }\r\n                    properties.data = self.complementData(data);\r\n                    defer.resolve(properties.data);\r\n\r\n                }).fail(function (data) {\r\n\r\n                    if (data.type === \"not-processed\")\r\n                        return;\r\n\r\n                    // Show error from server\r\n                    var form = self.getFormContainer();\r\n                    var msgObj = self.properties.displayName + \": \";\r\n\r\n                    if (typeof data === \"string\") {\r\n                        var auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n                    } else {\r\n                        var auxMsg = data;\r\n                    }\r\n\r\n                    msgObj += auxMsg.message;\r\n\r\n                    form.addValidationMessage(msgObj);\r\n\r\n                    defer.reject(data);\r\n                });\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n    */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            properties.data = [];\r\n            properties.data = self.complementData(properties.data);\r\n\r\n            // Add another data\r\n            properties.data.push({id: \"\", value: \"Item 1\"});\r\n            properties.data.push({id: \"\", value: \"Item 2\"});\r\n\r\n            return properties.data;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Resets the data in order to fetch it again when needed\r\n    */\r\n    resetData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = null;\r\n        properties.remoteDataLoaded = false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n\r\n        if (self.combo && self.combo.length > 0) {\r\n            // When there is a combo painted, we fetch the selected value from it\r\n            return self.getSelectedValue();\r\n        } else {\r\n            var displayValue = \"\";\r\n            var item = self.getValue();\r\n\r\n            if (item) {\r\n                // Check on cached propert from server first if the key exists\r\n                displayValue = self.formatItem(item.value);\r\n            }\r\n\r\n            return displayValue;\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n    },\r\n\r\n    /*\r\n    *   Adds custom parameters to process the template\r\n    */\r\n    getTemplateParams: function () {\r\n        return {};\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n\r\n        if (value !== undefined && value !== null) {\r\n            if ($.isArray(value)) {\r\n\r\n                for (var i = 0, length = value.length; i < length; i++) {\r\n                    if (value[i] != null && typeof (value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                            value[i] = this.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                            value[i] = this.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n                return value.join(\" - \");\r\n            } else {\r\n                return value;\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos        \r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) === \"object\" && (value.id === undefined || value.id === \"\")) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                } else {\r\n                    // Add the value to the server\r\n                    renderValues[properties.xpath] = typeof (value.id) !== \"undefined\" ? value.id : \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentValue = self.getValue();\r\n        var originalValue = properties.originalValue;\r\n        var defaultValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if ($.forceCollectData) {\r\n            return result;\r\n        }\r\n\r\n        currentValue = currentValue && currentValue.length !== undefined ? currentValue[0] : currentValue;\r\n        originalValue = originalValue && originalValue.length !== undefined ? originalValue[0] : originalValue;\r\n        defaultValue = defaultValue && defaultValue.length !== undefined ? defaultValue[0] : defaultValue;\r\n\r\n        currentValue = currentValue && currentValue.id !== undefined ? currentValue.id : currentValue;\r\n        originalValue = originalValue && originalValue.id !== undefined ? originalValue.id : originalValue;\r\n        defaultValue = defaultValue && defaultValue.id !== undefined ? defaultValue.id : defaultValue;\r\n\r\n        if (defaultValue !== undefined) {\r\n            if (defaultValue != originalValue || defaultValue != currentValue) {\r\n                result = true;\r\n            } else {\r\n                result = false;\r\n            }\r\n        } else {\r\n            result = currentValue != originalValue ? true : false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Parses additional values info in order to format them correctly\r\n    */\r\n    parseAdditionalValues: function (data) {\r\n        var self = this;\r\n\r\n        return $.map(data, function (item) {\r\n            var value = item.value ? self.formatItem(item.value) : item;\r\n            var newItem = {id: item.id, value: value};\r\n\r\n            if (item.hidden) newItem.hidden = true;\r\n            return item;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Complement data from server before control implementation\r\n    */\r\n    complementData: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var bCurrentDataFound = false;\r\n        $.each(data, function (i, item) {\r\n\r\n            if (item.value !== undefined && item.value !== null) {\r\n                item.value = self.formatItem(item.value);\r\n                if (properties.value) {\r\n                    if (item.id == properties.value.id) {\r\n                        bCurrentDataFound = true;\r\n                    }\r\n                }\r\n            } else {\r\n                item.value = \"\";\r\n            }\r\n        });\r\n\r\n        // Add empty node if configured\r\n        if (self.showEmpty()) {\r\n            var emptyFound = false;\r\n            for (var i = 0, length = data.length; i < length; i++) {\r\n                if (data[i].id === \"\") {\r\n                    emptyFound = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!emptyFound) {\r\n                var dataValue = bizagi.override.emptyLabelForCombo || bizagi.localization.getResource(\"render-combo-empty-value\")\r\n                data.unshift({id: \"\", value: dataValue});\r\n            }\r\n        }\r\n\r\n        if (properties.value) {\r\n            if (!bCurrentDataFound && self.showCurrentData()) {\r\n                data.unshift({id: properties.value.id, value: properties.value.value, hidden: true});\r\n            }\r\n        }\r\n\r\n        // Add additional value\r\n        return self.parseAdditionalValues(data);\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        var currentValue = self.getValue();\r\n\r\n        if (bizagi.util.isEmpty(currentValue)) return false;\r\n        if (Object.prototype.toString.apply(currentValue) === \"[object Object]\" && (bizagi.util.isEmpty(currentValue.id) || currentValue.id == 0)) return false;\r\n\r\n        // Else\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    * Cleans current data\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        this.column && !this.column.comboData && this.getData();\r\n    },\r\n\r\n    isExtraItem: function () {\r\n        var self = this;\r\n        var data = self.value || {};\r\n        var value = data.value || \"\";\r\n\r\n        return value === \"\" || value === self.getResource(\"render-combo-empty-selection\") || value === self.getResource(\"render-combo-empty-value\");\r\n    },\r\n\r\n    escapeValue: function (value) {\r\n        if (bizagi.util.isString(value)) {\r\n            var valueToReturn = value.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            return valueToReturn;\r\n        } else {\r\n            return value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Maps the value, when this one comes from actions\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    validateValue: function (value) {\r\n        if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id !== null) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id\r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function (e) {\r\n            return e.id == id;\r\n        });\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Check Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for check renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.check\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n\r\n        properties.showLetters = (bizagi.override && bizagi.override.enableCheck === true) && !properties.editable;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"check\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmpty(value)) return false;\r\n\r\n        var booleanValue = bizagi.util.parseBoolean(value);\r\n\r\n        return !(booleanValue === false && this.properties.required);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Number Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.number\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = (typeof (properties.allowDecimals) !== \"undefined\") ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.setGroupDigits();\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n        properties.dataTypeMinValue = this.calculateMinValue(properties.dataType);\r\n        properties.dataTypeMaxValue = this.calculateMaxValue(properties.dataType);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"number\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            editable: self.properties.editable,\r\n            value: bizagi.isMobile() ? self.getDisplayValue() : \"\", // Only apply to mobile because in the template value is required (Bug: 11624)\r\n            type: bizagi.util.isAndroidDevice() ? \"tel\" : \"text\", // Change type control for android device\r\n            isDesign: self.getMode() !== \"execution\"\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = control.find(\"input\");\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numeric(self.properties.decimalSymbol);\r\n\r\n        // Attach event for retype double\r\n        if (properties.retype === \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        // Attach Format Currency Plugin to format the input\r\n        this.attachFormatCurrency();\r\n    },\r\n\r\n    /**\r\n     * Removes Validation Messages\r\n     */\r\n    removeValidations: function () {\r\n        var form = this.getFormContainer().parent || this.getFormContainer();\r\n\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,smartphone...).\r\n     * @returns {}\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Adds the format currency plugin\r\n     * @returns {}\r\n     */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message = bizagi.localization.getResource(\"render-number-retype-fail\");\r\n        self.isValidRender = self.isValidRender || true;\r\n\r\n        // Extend formatCurrency language\r\n        if ($.formatCurrency.regions[bizagi.language] == null)\r\n            $.formatCurrency.regions[bizagi.language] = this.getResource(\"numericFormat\");\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n            var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n            var decimalSeparator = \".\";\r\n            var digitGroupSeparator = \",\";\r\n            if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) == \"undefined\") {\r\n                decimalSeparator = self.getResource(\"numericFormat\").decimalSymbol || \".\";\r\n                digitGroupSeparator = self.getResource(\"numericFormat\").digitGroupSymbol || \",\";\r\n            }\r\n            else {\r\n                decimalSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator;\r\n                digitGroupSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator;\r\n            }\r\n\r\n            var minValue = self.getMinValue();\r\n            var maxValue = self.getMaxValue();\r\n\r\n            if(properties.percentage)self.numericInput.val(self.numericInput.val().replace(\"%\", \"\"));\r\n            var inputValue = self.numericInput.val();\r\n            inputValue = (decimalSeparator == \",\") ? inputValue.replace(/\\,0+$/, '') : inputValue.replace(/\\.0+$/, '');\r\n            inputValue = inputValue.replace(properties.symbol, \"\");\r\n            //Replace all the ocurrences of the digitGroupSeparator\r\n            inputValue = bizagi.util.replaceAll(inputValue, digitGroupSeparator, \"\");\r\n            if (inputValue.toString().indexOf(decimalSeparator) != -1) {\r\n                if (decimalSeparator == \",\") inputValue = inputValue.replace(/([0-9]+(\\,[0-9]+[1-9])?)(\\,?0+$)/, '$1');\r\n                if (decimalSeparator == \".\") inputValue = inputValue.replace(/([0-9]+(\\.[0-9]+[1-9])?)(\\.?0+$)/, '$1');\r\n            }\r\n\r\n            if (inputValue != undefined && inputValue.length > 0) self.numericInput.val(inputValue);\r\n\r\n            if (/(.+)-$/.test(inputValue)) {\r\n                inputValue = inputValue.replace(/(.+)-$/, '-$1');\r\n                self.numericInput.val(inputValue);\r\n            }\r\n\r\n            var inputLength = inputValue.replace(/[^0-9]+/g, \"\").length;\r\n            var xPath = self.properties.xpath;\r\n            var oldVal = self.numericInput.val();\r\n\r\n\r\n            if ((self.isInvalidFormat != null && self.isInvalidFormat == true)\r\n                || (inputValue != \"\" && [\"$\", \"£\", \"€\", \"¥\", properties.symbol].indexOf(inputValue) != -1)) {\r\n                self.setValue(\"\");\r\n                self.getControl().find(\"input\").val(\"\");\r\n                self.numericInput.val(\"\");\r\n                return;\r\n            }\r\n\r\n            if (bizagi.util.trim(inputValue) == \"\") {\r\n                self.setValue(\"\");\r\n                return;\r\n            }\r\n\r\n            //The \",\" is changed to \".\" For the correct operation of \"parseFloat ()\"\r\n            var tempValue = parseFloat(inputValue.replace(\",\", \".\"));\r\n            if (isNaN(tempValue)) {\r\n                tempValue = self.numericInput.asNumber();\r\n            }\r\n\r\n            if (minValue !== undefined && minValue != null && tempValue < minValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-minimum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#minValue#\", minValue.toString());\r\n            }\r\n            else if (maxValue !== undefined && maxValue !== null && tempValue > maxValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-maximum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#maxValue#\", maxValue.toString());\r\n            } else\r\n                message = message + \" \" + oldVal + \"\";\r\n\r\n\r\n            // Do datatype validations\r\n            if (\r\n                (minValue !== undefined && minValue !== null && tempValue < minValue)\r\n                || (maxValue !== undefined && maxValue !== null && tempValue > maxValue)\r\n                || (self.properties.dataType == 10 && inputLength > 15)\r\n                || (self.properties.dataType == 1 && inputLength > 19)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (oldVal.match(/[^$£€¥,-.()\\d]/))\r\n            ) {\r\n                if (typeof validationController != \"undefined\" && validationController != null) {\r\n                    self.removeValidations();\r\n\r\n                    var messageToShow = message;\r\n                    if(messageToShow.indexOf(oldVal) === -1){\r\n                        messageToShow = message + \" \" + oldVal + \"\";\r\n                    }\r\n\r\n                    validationController.showValidationMessage(messageToShow, xPath);\r\n                    self.isValidRender = false;\r\n                    self.isValidRenderMessage = messageToShow;\r\n                }\r\n                message = message.replace(oldVal, \"\");\r\n                return;\r\n            }\r\n            else {\r\n                self.isValidRender = true;\r\n                self.isValidRenderMessage = \"\";\r\n            }\r\n\r\n            // Fix decimals specially when it starts with 0 (0000234 -> 234, 00000 -> 0)\r\n            if (this.value.toString().length > 0 && !properties.allowDecimals && !properties.groupDigits) {\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (properties.symbol.length > 0) this.value = this.value.toString().replace(properties.symbol + \"0\", properties.symbol);\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (this.value.replaceAll('0', '').length == 0)\r\n                    this.value = properties.symbol + \"0\";\r\n                else if (this.value.toString() == parseInt(this.value)) this.value = properties.symbol + this.value;\r\n            } else {\r\n                //Fix type money when number start with 0 (0000234 -> 234, 00000 -> 0)\r\n                if(self.properties.type === \"money\" || self.properties.type === \"number\" || self.properties.type === \"columnMoney\" || self.properties.type === \"columnNumber\"){\r\n                    this.value = this.value.toString().replace(/^0+/, '');\r\n                    if(this.value === \"\"){\r\n                        this.value = 0;\r\n                    }\r\n                }\r\n            }\r\n            self.executeFormatCurrencyPlugin();\r\n\r\n            // Updates internal value\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n\r\n            if (properties.percentage) {\r\n                if (self.numericInput && self.numericInput.val().indexOf(\"%\") == -1)\r\n                    self.numericInput.val(self.numericInput.val() + '%');\r\n            }\r\n            message = message.replace(oldVal, \"\");\r\n        })\r\n\r\n        // Avoiding pasting invalid characters\r\n            .bind('paste', function (e) {\r\n                try {\r\n                    var tmpData = (bizagi.util.isIE() || bizagi.util.isIE11()) ? window.clipboardData.getData(\"text\") : e.originalEvent.clipboardData.getData(\"Text\");\r\n\r\n\r\n\r\n                    // Next lines checks if there is something different to numbers symbol, decimalSymbol and digitGroupSybol\r\n                    var totalVal = \"/[^0-9\";\r\n                    if (properties.decimalSymbol.length > 0) {\r\n                        totalVal += properties.decimalSymbol;\r\n                    }\r\n                    // Next lines only for currency type\r\n                    if (properties.dataType == 8) {\r\n                        if (properties.symbol.length > 0) {\r\n                            totalVal += properties.symbol;\r\n                        }\r\n                        if (properties.digitGroupSymbol.length > 0) {\r\n                            totalVal += properties.digitGroupSymbol;\r\n                        }\r\n                    }\r\n                    totalVal += \"\\\\-\\\\s]/gi\";\r\n                    try {\r\n                        if (tmpData.replace(eval(totalVal), '').length != tmpData.length)\r\n                            e.preventDefault();\r\n                    }\r\n                    catch (e) {\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    bizagi.log(\"Error to pasting content\");\r\n                    self.isInvalidFormat = true;\r\n                }\r\n            })\r\n            // Now we implement keydown instead of keyup in order to include preventDefault\r\n            .keydown(function (e) {\r\n                self.previousValue = this.value;\r\n                e = (window.event && window.event.preventDefault) ? window.event : e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                // Validation for currency info\r\n                if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) != \"undefined\")\r\n                    if (BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits == 0) properties.allowDecimals = false;\r\n                if (properties.dataType < 5 || (properties.dataType == 8 && properties.allowDecimals == false))\r\n                    if (keyUnicode == 188 || keyUnicode == 190 || keyUnicode == 110)\r\n                        e.preventDefault();\r\n                if (this.value)\r\n                    if (e !== undefined && this.value.length > 0 && (properties.dataType == 8 || properties.dataType == 10)) {\r\n                        // Just numbers\r\n                        if (keyUnicode > 47 && keyUnicode < 58) {\r\n                            if (self.formatTimeout) {\r\n                                clearTimeout(self.formatTimeout);\r\n                            }\r\n\r\n                            var floatPart = this.value + \"\";\r\n                            //var  floatPart = stringPart.replaceAll(properties.digitGroupSymbol, \"\").replaceAll(properties.symbol,\"\").trim().replaceAll(properties.decimalSymbol,\".\");\r\n                            if (properties.digitGroupSymbol && properties.digitGroupSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.digitGroupSymbol, \"\");\r\n                            }\r\n                            if (properties.symbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.symbol, \"\");\r\n                            }\r\n\r\n                            floatPart = $.trim(floatPart);\r\n                            if (properties.decimalSymbol && properties.decimalSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.decimalSymbol, \".\");\r\n                            }\r\n                            // If increasing one digit (x10) will overtake the maxValue\r\n                            if (floatPart * 10 > properties.dataTypeMaxValue) {\r\n                                e.preventDefault();\r\n                            }\r\n                        }                  \r\n                        else if (keyUnicode == 109 || keyUnicode == 189) {\r\n                            if (this.selectionStart != 0 || this.selectionEnd != this.value.length) {\r\n                                var currentPosition = this.selectionEnd;\r\n                                this.value = properties.symbol + \"-\" + this.value.replace(properties.symbol, \"\");\r\n                                this.selectionStart = this.selectionEnd = currentPosition + 1;\r\n                            } else if (this.selectionStart == 0 && this.selectionEnd == this.value.length) {\r\n                                this.value = \"-\";\r\n                                this.selectionStart = this.selectionEnd = this.value.length;\r\n                            }\r\n                        }\r\n                    }                    \r\n            })\r\n\r\n            .keyup(function (e) {\r\n                e = window.event || e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                if (e !== undefined) {\r\n                    switch (keyUnicode) {\r\n                        case 16:\r\n                            break; // Shift\r\n                        case 17:\r\n                            break; // Ctrl\r\n                        case 13:\r\n                            break; // Intro\r\n                        case 18:\r\n                            break; // Alt\r\n                        case 27:\r\n                            this.value = '';\r\n                            break; // Esc: clear entry\r\n                        case 35:\r\n                            break; // End\r\n                        case 36:\r\n                            break; // Home\r\n                        case 37:\r\n                            break; // cursor left\r\n                        case 38:\r\n                            break; // cursor up\r\n                        case 39:\r\n                            break; // cursor right\r\n                        case 40:\r\n                            break; // cursor down\r\n                        case 78:\r\n                            break; // N (Opera 9.63+ maps the \".\" from the number key section to the \"N\" key too!) (See: http://unixpapa.com/js/key.html search for \". Del\")\r\n                        case 110:\r\n                            break; // . number block (Opera 9.63+ maps the \".\" from the number block to the \"N\" key (78) !!!)\r\n                        case 188:\r\n                            break; // , comma\r\n                        case 190:\r\n                            break; // .\r\n                        default:\r\n                        {\r\n\r\n                        }\r\n                    }\r\n                }                \r\n            }).keypress(function (e) {\r\n            e = (window.event && window.event.preventDefault) ? window.event : e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (typeof (e) !== \"undefined\") {\r\n                if (keyUnicode == 35 || keyUnicode == 37 || keyUnicode == 39) {\r\n                    e.preventDefault();\r\n                } else if (properties.dataType != 8 && keyUnicode == 36) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                // When no decimals are permited\r\n                var character = String.fromCharCode(keyUnicode);\r\n                if (properties.allowDecimals === false && properties.numDecimals === 0 && character === properties.decimalSymbol)\r\n                    e.preventDefault();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.numericInput) {\r\n            self.numericInput.formatCurrency({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits,\r\n                roundToDecimalPlace: properties.numDecimals,\r\n                colorize: properties.colorize\r\n            });\r\n        }\r\n\r\n        if (properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            var value = self.numericInput.val();\r\n            var positive = true;\r\n\r\n            if (value.indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\")\r\n            }\r\n\r\n            var regExp = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(regExp, \"$1\")\r\n\r\n            regExp = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(regExp, \"\");\r\n            self.numericInput.val(value);\r\n\r\n            if (!positive) self.numericInput.val(\"(\" + value + \")\");\r\n        }\r\n\r\n        if (properties.percentage)\r\n            self.numericInput.val(self.numericInput.val() + '%');\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     * @returns {*}\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var value = self.getValue() !== undefined ? self.getValue() : $(\"input\", control).val() || \"\";\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        if (properties.percentage)\r\n            label = $('<label/>').html(label.text() + '%');\r\n\r\n        // Removing unrequired zeros as requested by BA26331\r\n        if (!properties.editable && properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            value = label.text();\r\n            var positive = true;\r\n\r\n            if (value.toString().indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\");\r\n            }\r\n\r\n            var re = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(re, \"$1\");\r\n\r\n            re = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(re, \"\");\r\n\r\n            if (!positive) value = \"(\" + value + \")\";\r\n            return value;\r\n        }\r\n\r\n        return label.text();\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var message;\r\n        var minValue = self.getMinValue();\r\n        var maxValue = self.getMaxValue();\r\n\r\n        if (typeof (value) == \"string\" && value != \"\") {\r\n            value = Number(value);\r\n        }\r\n\r\n        // Check min value\r\n        if (self.hasValue()) {\r\n            if (!bizagi.util.isEmpty(minValue)) {\r\n                if (value < minValue) {\r\n                    message = this.getResource(\"render-numeric-minimum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#minValue#\", minValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n            // Check max value\r\n            if (!bizagi.util.isEmpty(maxValue)) {\r\n                if (value > maxValue) {\r\n                    message = this.getResource(\"render-numeric-maximum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#maxValue#\", maxValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (self.isValidRender === false && !(bValid && bizagi.util.isMobileDevice())) {\r\n            bValid = false;\r\n            var validMessage = self.isValidRenderMessage ? self.isValidRenderMessage : \"error\";\r\n            invalidElements.push({xpath: properties.xpath, message: validMessage});\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Get minimum value\r\n     * @returns {*}\r\n     */\r\n    getMinValue: function () {\r\n        var minValue = this.properties.minValue;\r\n\r\n        if (minValue !== undefined && minValue !== null)\r\n            return minValue;\r\n\r\n        return this.properties.dataTypeMinValue;\r\n    },\r\n\r\n    /**\r\n     * Get maximum value\r\n     * @returns {*}\r\n     */\r\n    getMaxValue: function () {\r\n        var maxValue = this.properties.maxValue;\r\n\r\n        if (maxValue !== undefined && maxValue !== null)\r\n            return maxValue;\r\n\r\n        return this.properties.dataTypeMaxValue;\r\n    },\r\n\r\n    /**\r\n     * Return the allow decimals default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n            // Decimal and money data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Return the group digits default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n\r\n            // Decimal data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Return the group digits default property based on digitGroupSymbol\r\n     * @returns {*}\r\n     */\r\n    setGroupDigits: function () {\r\n        var self = this;\r\n        if (typeof (self.properties.thousands) !== \"undefined\") {\r\n            if (self.properties.digitGroupSymbol) { //some cultures\r\n                return bizagi.util.parseBoolean(self.properties.thousands);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else if (self.properties.digitGroupSymbol) { //some cultures\r\n            return this.getDefaultGroupDigits(self.properties.dataType);\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Calculate Minimum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMinValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return -922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 0; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return -32768; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return -2147483648; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return -999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Calculate Maximum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMaxValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return 922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 255; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return 32767; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return 2147483647; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return 999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var newValue = Number(value);\r\n\r\n        self.properties.minValue = self.properties.dataTypeMinValue = Number.isNaN(newValue) ? self.calculateMinValue(self.properties.dataType) : newValue;\r\n    },\r\n\r\n    changeMaxValue: function (value) {\r\n        var newValue = Number(value);\r\n\r\n        this.properties.maxValue = this.properties.dataTypeMaxValue = Number.isNaN(newValue) ? this.calculateMaxValue(this.properties.dataType) : newValue;\r\n    },\r\n\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    }\r\n});\r\n\r\n","\r\n/*\r\n*   Name: Bizagi Render Number Scientific notation Class\r\n*   Author: Laura Ariza\r\n*   Comments:\r\n*   -   This script will define basic stuff for scientific notation numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.numberScientificNotation\", {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\"\r\n            ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n    },\r\n\r\n    renderControl: function() {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"numberScientificNotation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.numericInput = control.find(\"input\");\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n    },\r\n\r\n    getDisplayValue: function() {\r\n        var self = this;\r\n        return self.getValue().replace('.', self.properties.decimalSymbol);\r\n    },\r\n\r\n    setValue: function(value) {\r\n        var self = this;\r\n        value = (value || '').toString().replace(self.properties.decimalSymbol, '.');\r\n        self._super(value);\r\n    },\r\n    controlValueIsChanged: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue() || \"\";\r\n        var compareValue = properties.originalValue || \"\";\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n        result = (compareValue.toLowerCase() == value.toLowerCase()) ? false : true;\r\n        return result;\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Date Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for date renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.date\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                // Value must always hold the value with invariant format\r\n                self.value = properties.value;\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            } else {\r\n                self.value = null;\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"date\");\r\n        var indexDateTimeSeparation = properties.dateFormat.substring(0, properties.dateFormat.indexOf(\":\")).lastIndexOf(\" \");\r\n        var dateFormat = (indexDateTimeSeparation > 0) ? properties.dateFormat.substring(0, indexDateTimeSeparation) : properties.dateFormat;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            showTime: properties.showTime,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            dateFormat: bizagi.override && bizagi.override.uppercaseDatePlaceholder === true ? dateFormat.toUpperCase() : dateFormat,\r\n            timeFormat: (properties.showTime && indexDateTimeSeparation > 0) ? properties.dateFormat.substring(indexDateTimeSeparation) : \"\",\r\n            rtl: (properties.orientation == \"rtl\")\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function (intHandler, isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set control references\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        // Set mask\r\n        if (properties.mask) {\r\n            dateControl.mask({\r\n                mask: properties.mask\r\n            });\r\n        }\r\n\r\n        // Attach change event\r\n        dateControl.bind(\"change\", function () {\r\n            self.onChangeHandler();\r\n        });\r\n        if (properties.showTime) {\r\n            timeControl.bind(\"change\", function (e, isNow) {\r\n                if (self.updatingTime) {\r\n                    delete self.updatingTime;\r\n                    return;\r\n                }\r\n                self.onChangeHandler(isNow);\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function () {\r\n    },\r\n\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        if (!properties.displayValue && value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n        } else {\r\n            displayValue = \"\";\r\n        }\r\n\r\n        // We can return the display value isntance\r\n        return properties.displayValue || displayValue || \"\";\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    // Formats the value in full invariant (with time) in order to send to the server\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                    if (typeof (date) != \"undefined\")\r\n                        if (date !== 0) {\r\n                            if (!properties.showTime) {\r\n                                date.setHours(0, 0, 0, 0);\r\n                            }\r\n                            renderValues[properties.xpath] = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                        }\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n    getDateControl: function () { },\r\n\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n    getTimeControl: function () { },\r\n\r\n    /* \r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n        properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                var message;\r\n\r\n                // Check that we have a valid data\r\n                if (value != 0) {\r\n                    // Clear seconds and milliseconds for validations\r\n                    value.setSeconds(0);\r\n                    value.setMilliseconds(0);\r\n\r\n                    // Check min value\r\n                    if (properties.minValue && (typeof properties.minValue === 'string' || typeof properties.minValue == 'number')) {\r\n                        var minValue = typeof properties.minValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.minValue, properties.showTime) : new Date(properties.minValue);\r\n                        minValue.setSeconds(0);\r\n                        minValue.setMilliseconds(0);\r\n\r\n                        if (value < minValue) {\r\n                            message = this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", bizagi.util.dateFormatter.formatDate(minValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n\r\n                    // Check max value\r\n                    if (properties.maxValue && (typeof properties.maxValue == 'string' || typeof properties.maxValue == 'number')) {\r\n                        var maxValue = typeof properties.maxValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.maxValue, properties.showTime) : new Date(properties.maxValue);\r\n                        maxValue.setSeconds(0);\r\n                        maxValue.setMilliseconds(0);\r\n\r\n                        if (value > maxValue) {\r\n                            message = this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", bizagi.util.dateFormatter.formatDate(maxValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check that both controls (data and time) are filled out\r\n        if (properties.showTime) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                // Check required\r\n                if (properties.required && self.hasValue()) {\r\n\r\n                    // Check both controls\r\n                    var dateControl = self.getDateControl();\r\n                    var timeControl = self.getTimeControl();\r\n\r\n                    // If date is filled but time is not ... show validation\r\n                    if (dateControl.length > 0 && timeControl.length > 0) {\r\n                        if (dateControl.val().length > 0 && timeControl.val().length == 0) {\r\n                            message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.extendedText\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        this.hasMaxLines = this.properties.maxLines ? true : false;\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Fill default properties\r\n        properties.maxLines = this.properties.maxLines || 6;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || self.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"extendedText\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.textarea = control.find(\"textarea\");\r\n\r\n        // If is textarea, then enable resize element.\r\n        if (self.textarea) {\r\n            self.textarea.css({resize: \"both\"});\r\n        } else {\r\n            self.textarea.css({resize: \"none\"});\r\n        }\r\n\r\n        // Attach event for retype double\r\n        if (self.properties.retype === \"double\")\r\n            self.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set the default maxlength for the input if is 0 or undefined set to infinity\r\n        // this resolve issue with scope strings that don't have maxlength\r\n        if (properties.maxLength)\r\n            self.textarea.prop('maxlength', properties.maxLength);\r\n\r\n        if (properties.maxLines) {\r\n            self.textarea.prop('rows', properties.maxLines)\r\n        } else {\r\n            self.textarea.prop('rows', 6);\r\n        }\r\n\r\n        // Attach change event\r\n        self.textarea.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.textarea.val(), true);\r\n                } else {\r\n                    // Set error message\r\n                    var message = validationMessages[0].message;\r\n                    bizagi.showMessageBox(message, \"Bizagi\", \"error\");\r\n                }\r\n            }\r\n        });\r\n\r\n        // Attach blur event\r\n        self.textarea.bind(\"blur\", function () {\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var regEx = new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\");\r\n\r\n        // Offline capability\r\n        if (this.isOfflineForm && bizagi.util.isMobileDevice()) {\r\n            value = value && typeof (value) === \"object\" && value.value ? value.value : value;\r\n        }\r\n\r\n        // Check regular expression\r\n        if (properties.regularExpression) {\r\n\r\n            if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression)) && (self.properties && self.properties.xpath === \"userName\")))) {\r\n                message = properties.regularExpression.message;\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                bValid = false;\r\n            } else {\r\n                if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression))))) {\r\n                    message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        } else {\r\n            if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                if (properties.editable) {\r\n                    message = this.getResource(\"render-text-regular-expression-default-message\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (self.properties.editable == false) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(valueToDisplay);\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param {} renderValues\r\n     * @returns {}\r\n     */\r\n    collectData: function (renderValues) {\r\n        // Call base\r\n        this._super(renderValues);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setValue: function (value) {\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        this._super(decodedValue);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n});\r\n","/*\r\n *   Name: Bizagi Render Grid Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for grids\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.grid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self.originalData = bizagi.clone(data.properties);\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        self.initProperties();\r\n\r\n        // Set columns\r\n        var areThereEditableColumns;\r\n        var areThereTotalizedColumns;\r\n        self.columns = [];\r\n        self.columnsIds = [];\r\n        self.enabledChecks = {};\r\n        self.exclusiveChanges = {};\r\n        self.originalEnabledChecks = [];\r\n        $.each(data.elements, function (i, column) {\r\n            var columnProperties = column.render.properties;\r\n\r\n            // the groupby property is taken of column\r\n            if (columnProperties.groupBy) {\r\n                properties.groupBy = columnProperties.xpath || \"\";\r\n                properties.allowGrouping = !bizagi.util.isEmpty(properties.groupBy) ? true : false;\r\n            }\r\n            if (columnProperties.type === \"columnLabel\") {\r\n                self.spliceRowData(data.properties.data, i + 1);\r\n            }\r\n\r\n            if (columnProperties.type === \"columnBoolean\" && columnProperties.isExclusive) {\r\n                var params = {\r\n                    xpath: columnProperties.xpath\r\n                };\r\n                if (data.properties.data) {\r\n                    self.enabledChecks[columnProperties.xpath] = [];\r\n                    for (var j = 0; j < data.properties.data.rows.length; j++) {\r\n                        var row = data.properties.data.rows[j];\r\n                        var item = row[i + 1];\r\n                        if (item) {\r\n                            self.originalEnabledChecks.push(row[0]);\r\n                            self.enabledChecks[columnProperties.xpath].push([row[0], item]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // If inlineEdit is false then all columns must be read only\r\n            if (!self.properties.inlineEdit) {\r\n                column.render.properties.editable = false;\r\n            }\r\n\r\n            // Create renderColumns\r\n            var columnRender = self.renderFactory.getColumn({\r\n                type: columnProperties.type,\r\n                data: column.render,\r\n                parent: self,\r\n                singleInstance: properties.singleInstance\r\n            });\r\n\r\n            self.columns.push(columnRender);\r\n            self.columnsIds.push(column.render.properties.id);\r\n\r\n            if (columnProperties.editable) {\r\n                areThereEditableColumns = true;\r\n            }\r\n\r\n            if (columnProperties.totalize && columnProperties.totalize.operation) {\r\n                areThereTotalizedColumns = true;\r\n\r\n                // Default summary format\r\n                columnProperties.totalize.format = columnProperties.totalize.format || {};\r\n                columnProperties.totalize.format.bold = columnProperties.totalize.format.bold !== undefined ? columnProperties.totalize.format.bold : true;\r\n            }\r\n        });\r\n\r\n        // Reverse columns when using right to left orientation\r\n        if (properties.orientation === \"rtl\")\r\n            self.columns = self.columns.reverse();\r\n\r\n        // Turn off inline edit if there are any editable columns        \r\n        if (properties.inlineEdit && !areThereEditableColumns) {\r\n            properties.inlineEdit = false;\r\n            properties.allowEdit = false;\r\n        }\r\n\r\n        // Check if the grid has totalizers\r\n        if (areThereTotalizedColumns) {\r\n            properties.showSummary = true;\r\n            properties.rowsPerPage = 0;\r\n        }\r\n    },\r\n\r\n    initProperties: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        /** Edit properties\r\n         * @default editable true\r\n         */\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowEdit = bizagi.util.parseBoolean(properties.allowEdit) != null ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.inlineEdit = bizagi.util.parseBoolean(properties.inlineEdit) != null ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.withEditForm = bizagi.util.parseBoolean(properties.withEditForm) != null ? bizagi.util.parseBoolean(properties.withEditForm) : false;\r\n\r\n        /** Add properties\r\n         * @default  allowAdd true\r\n         */\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) != null ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.inlineAdd = (properties.allowAdd) ? (bizagi.util.parseBoolean(properties.inlineAdd) != null) ? bizagi.util.parseBoolean(properties.inlineAdd) : true : false;\r\n\r\n        /* Define Delete properties */\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) != null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        /* Define details properties*/\r\n        properties.allowDetail = bizagi.util.parseBoolean(properties.allowDetail) != null ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n\r\n        /* Define general properties */\r\n        properties.keyColumn = \"\";\r\n        properties.data = properties.data || null;\r\n        properties.displayType = \"value\";\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        properties.allowMore = bizagi.util.parseBoolean(properties.allowMore) || false;\r\n        properties.allowFilter = bizagi.util.parseBoolean(properties.allowFilter) || false;\r\n        properties.allowGrouping = false;\r\n        properties.groupBy = \"\";\r\n        properties.groupSummary = properties.groupSummary || null;\r\n        properties.groupText = this.getResource(\"render-grid-group-text\");\r\n        properties.groupCollapsed = bizagi.util.parseBoolean(properties.groupCollapsed) || false;\r\n        properties.groupOrder = properties.groupOrder || \"asc\";\r\n        properties.formShowMode = bizagi.util.parseBoolean(properties.formShowMode) || \"popup\";\r\n        properties.floatingHeader = bizagi.util.parseBoolean(properties.floatingHeader) || false;\r\n\r\n        properties.sortBy = properties.sortBy ? properties.sortBy : properties.data && properties.data.sort ? properties.data.sort : properties.keyColumn;\r\n        properties.sortOrder = properties.sortOrder !== undefined && properties.sortOrder !== null ? (properties.sortOrder === \"True\" ? \"asc\" : \"desc\") : properties.data && properties.data.order ? properties.data.order : \"asc\";\r\n        properties.sort = properties.sortBy + \" \" + properties.sortOrder;\r\n\r\n        properties.rowsPerPage = properties.allowGrouping ? 1000 : (properties.rowsPerPage || 20);\r\n        properties.page = 1;\r\n        properties.records = 0;\r\n        properties.totalPages = 0;\r\n\r\n        properties.addLabel = properties.addLabel || this.getResource(\"render-grid-add-label\") + properties.displayName;\r\n        properties.editLabel = properties.editLabel || $.trim(this.getResource(\"render-grid-edit-label\")) + \" \" + properties.displayName;\r\n        properties.deleteLabel = properties.deleteLabel || this.getResource(\"render-ecm-confirm-bt-delete\") + \" \" + properties.displayName;\r\n        properties.exportOptionsLabel = properties.exportOptionsLabel || this.getResource(\"render-grid-export-options-label\") + properties.displayName;\r\n        properties.detailLabel = properties.detailLabel || this.getResource(\"render-collection-navigator-details-form\");\r\n\r\n\r\n        // Apply style to entire table\r\n        properties.tableCssClass = properties.cssClass || \"\";\r\n\r\n        properties.alreadySaved = false;\r\n\r\n        // When grid open in modal window and the parent is entity\r\n        if (properties.contexttype != \"entity\") {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Define if it is editable or not        \r\n        /* This part change all cells in the table to no editable,\r\n         * you must use it when the parent container has noeditable property,\r\n         * so this table is noeditable too.\r\n         */\r\n        try {\r\n            if ((self.parent && typeof self.parent.properties.editable == \"boolean\" && !self.parent.properties.editable) || !properties.editable) {\r\n                properties.allowAdd = false;\r\n                properties.allowEdit = false;\r\n                properties.allowDelete = false;\r\n                properties.inlineEdit = false;\r\n                properties.inlineAdd = false;\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n\r\n        // If grid has not allowEdit property in true, all fields within the grid\r\n        // must be no editables, so these lines changes this behavior\r\n        if (!properties.allowEdit || (!properties.inlineEdit && !properties.withEditForm)) {\r\n            properties.editable = false;\r\n        }\r\n\r\n        // Calculate render width\r\n        properties.labelWidth = 0;\r\n        properties.valueWidth = \"100%\";\r\n\r\n        // This property will be used to make custom grids with another data source\r\n        properties.overrideGetRemoteData = properties.overrideGetRemoteData || undefined;\r\n        //this property use to create a single decorated or a array of decorated\r\n        properties.singleInstance = bizagi.util.isEmpty(properties.singleInstance) ? true : properties.singleInstance;\r\n\r\n        // Check if the grid its opened whitin dialog form and has contextType\r\n        properties.contextType = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : null;\r\n\r\n        // Create a collection to collect changes\r\n        self.changes = {};\r\n\r\n        // Create a collection to override properties per cell\r\n        self.cellOverrides = {};\r\n\r\n\r\n        // Check orientation and change order of data if its necesary (rtl)\r\n        if (self.isRTL() && properties.data != null) {\r\n            properties.data.rows = self.changeOrderData(properties.data.rows);\r\n        }\r\n    },\r\n\r\n    /*\r\n   *   Check if a render has no value for required validation\r\n   */\r\n    hasValue: function () {\r\n        return this.properties.data && this.properties.data.rows.length > 0;\r\n    },\r\n\r\n    isRTL: function () {\r\n        var properties = this.properties;\r\n        if (!properties) return true;\r\n        return (typeof properties.orientation == \"string\" && properties.orientation.toUpperCase() == \"RTL\") ? true : false;\r\n    },\r\n    changeOrderData: function (data) {\r\n        var reverseDataRows = [];\r\n        var rows = data || [];\r\n        var rowKey;\r\n\r\n        $.each(rows, function (key, value) {\r\n            // Extract row key\r\n            rowKey = value.shift();\r\n            reverseDataRows = value.reverse();\r\n            // add element in the start\r\n            reverseDataRows.unshift(rowKey);\r\n\r\n            rows[key] = reverseDataRows;\r\n        });\r\n\r\n        return rows;\r\n    },\r\n\r\n    /**\r\n     * Specific fix RTL with localizated\r\n     * @param data\r\n     * @returns {*|Array}\r\n     */\r\n    removeRemainingColumns: function (data, numColumns) {\r\n        var rows = data || [];\r\n        var remainingColumns = 0;\r\n        if (rows.length > 0) {\r\n            // \"- 1\" because the first column represent id row\r\n            remainingColumns = rows[0].length - numColumns - 1;\r\n        }\r\n        if (remainingColumns > 0) {\r\n            $.each(rows, function (key, value) {\r\n                // Remove remaining columns\r\n                for (var i = 0; i < remainingColumns; i++) {\r\n                    value.pop();\r\n                }\r\n            });\r\n        }\r\n        return rows;\r\n    },\r\n\r\n    /* \r\n     *   Gets a column definition by xpath\r\n     */\r\n    getColumn: function (xpath) {\r\n        var self = this;\r\n        var result = null;\r\n        $.each(self.columns, function (i, column) {\r\n            if (column.properties.xpath == xpath || column.properties.id == xpath) {\r\n                result = column;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getColumnType: function (id) {\r\n        var self = this;\r\n        var columnIndex = self.columnsIds.indexOf(id);\r\n\r\n        if (columnIndex != -1) {\r\n            return self.columns[columnIndex].properties.type;\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set dummy data when not in execution mode\r\n        var mode = self.getMode();\r\n        if (mode !== \"execution\") {\r\n            properties.data = self.getDummyData();\r\n        }\r\n\r\n        var template = self.getGridTemplate();\r\n\r\n        // Render template\r\n        var html = self.applyTemplate(template);\r\n\r\n        // Initialize columns\r\n        var columnInitializers = [];\r\n        $.each(self.columns, function (i, column) {\r\n\r\n            // Add to column initializer array so we can synch out the promises\r\n            var result = column.initialize();\r\n            if (result)\r\n                columnInitializers.push(result);\r\n        });\r\n\r\n        // Resolve when all columns has been loaded\r\n        $.when.apply($, columnInitializers).done(function () {\r\n            defer.resolve(html);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Make control to behave as a block container\r\n        // TODO: Move to instances. This does not apply to mobiles\r\n        control.addClass(\"ui-bizagi-render-grid-container\")\r\n            .addClass(\"ui-bizagi-render-display-block\");\r\n    },\r\n\r\n    /*\r\n     *   Returns the grid template to be used\r\n     */\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid\");\r\n    },\r\n\r\n    /*\r\n     *   Applies the template to the render and returns the resolved element\r\n     */\r\n    applyTemplate: function (template) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        orientation = self.properties.orientation;\r\n\r\n        return $.fasttmpl(template, {\r\n            id: bizagi.util.encodeXpath(properties.xpath),\r\n            displayName: bizagi.util.encodeXpath(properties.displayName),\r\n            allowAdd: properties.allowAdd,\r\n            addLabel: properties.addLabel\r\n        });\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Override read-only presets\r\n        //  properties.allowAdd = false;\r\n        // Render the same, just change some presets\r\n        return self.renderControl();\r\n    },\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sortBy,\r\n            order: properties.sortType,\r\n            page: properties.page,\r\n            rows: properties.rowsPerPage,\r\n            searchFilter: properties.searchFilter,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            return properties.overrideGetRemoteData(params);\r\n        } else {\r\n            // Resolve with remote data\r\n            return self.dataService.multiaction().getGridData(params).then(function (data) {\r\n                self.originalData = self.originalData || {};\r\n                self.originalData.data = bizagi.clone(data);\r\n\r\n                // Resolve with fetched data\r\n                properties.page = data.page;\r\n                properties.records = data.records;\r\n                properties.totalPages = data.totalPages;\r\n\r\n                return data;\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     insert a blank item in the selected column in the data matrix\r\n     */\r\n    spliceRowData: function (data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.rows)) {\r\n            $.each(data.rows, function (key, value) {\r\n                var spliceIndex = index || data.rows[key].length;\r\n                data.rows[key].splice(spliceIndex, 0, \"\");\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataVisible: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.visible)) {\r\n            $.each(data.visible, function (key, value) {\r\n                var spliceIndex = index || data.visible[key].length;\r\n                data.visible[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataEditable: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.editable)) {\r\n            $.each(data.editable, function (key, value) {\r\n                var spliceIndex = index || data.editable[key].length;\r\n                data.editable[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n     */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            var rowTemplate = [\"1\"];\r\n\r\n            // Add a value for each column\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                rowTemplate.push(\"\");\r\n            }\r\n\r\n            var data = {\r\n                \"page\": 1,\r\n                \"total\": 1,\r\n                \"records\": 1,\r\n                \"rows\": [rowTemplate]\r\n            };\r\n\r\n            return data;\r\n        }\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitEditRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + self.buildCellXpathFilter(id) : properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            return self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                submitData: data,\r\n                contexttype: properties.contextType,\r\n                disableServerGridValidations: data.disableServerGridValidations || false\r\n            }).pipe(function (dataResp) {\r\n                self.endLoading();\r\n                return dataResp;\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n\r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid delete record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({message: message});\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid add record request\r\n     *   Returns a deferred when done, the server returns an id for the new record\r\n     */\r\n    submitAddRequest: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n    /*\r\n     *   Submits a grid rollback request\r\n     *   Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: params ? params.idPageCache : properties.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n     *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n     */\r\n    collectGridChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n        var isPressed = params.pressed || false;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n\r\n        if (trigger)\r\n            self.triggerRenderChange({key: id, column: xpath, pressed: isPressed});\r\n    },\r\n    /*\r\n     *   Configures a column to perform a submit on change when the user changes a cell\r\n     */\r\n    configureColumnSubmitOnChange: function (xpath) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build action\r\n        var action = {\r\n            commands: [{\r\n                xpath: properties.xpath,\r\n                command: 'submit-value',\r\n                argument: 'all'\r\n            }],\r\n            conditions: {\r\n                operator: 'and',\r\n                expressions: [\r\n                    {\r\n                        simple: {\r\n                            operator: 'cell-change',\r\n                            xpath: properties.xpath + '[].' + xpath,\r\n                            argumentType: 'text',\r\n                            argument: xpath\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            dependencies: [properties.xpath]\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                var form = self.getFormContainer();\r\n                form.addSubmitAction(xpath, action);\r\n            });\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var keysToDelete = [];\r\n\r\n        for (var id in self.changes) {\r\n            // Dont collect data from totalizers \r\n            if (id != \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var columnSimpleXpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + (columnXpath.substr(columnXpath.lastIndexOf('.') + 1, columnXpath.length) || columnXpath);\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Clean changes \r\n            keysToDelete.push(id);\r\n\r\n        }\r\n\r\n        if (self.exclusiveChanges) {\r\n            for (var id in self.exclusiveChanges) {\r\n\r\n                var columnExclusiveChanges = self.exclusiveChanges[id];\r\n                var columnEnabledChecks = self.enabledChecks[id];\r\n                var lengthEnabledChecks = columnEnabledChecks.length;\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    for (var i = 0; i < lengthEnabledChecks; i++) {\r\n                        var columnSimpleXpathEnabled = properties.xpath + self.buildCellXpathFilter(self.enabledChecks[id].shift()[0]) + \".\" + id;\r\n                        renderValues[columnSimpleXpathEnabled] = false;\r\n                    }\r\n\r\n                    var columnSimpleXpath = properties.xpath + self.buildCellXpathFilter(columnExclusiveChanges.key) + \".\" + columnExclusiveChanges.xpath;\r\n                    renderValues[columnSimpleXpath] = columnExclusiveChanges.value;\r\n\r\n                }\r\n            }\r\n        }\r\n\r\n        // Clean changes array in order to prevent duplicate data\r\n        // when execute SUBMITDATA in multiaction, that make and error\r\n        // in circular dependencies, specially when we add inline record\r\n        $.each(keysToDelete, function (key, v) {\r\n            delete self.changes[v];\r\n        });\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (!$.isEmptyObject(self.changes)) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            if (!$.isEmptyObject(self.exclusiveChanges)) {\r\n                result.push(true);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Check if a column data can be sent to the server\r\n     */\r\n    canColumnBeSent: function (id, columnXpath) {\r\n        var self = this, i, j, xpath;\r\n        for (i in self.columns) {\r\n            if (self.columns.hasOwnProperty(i)) {\r\n                var column = self.columns[i];\r\n                if (column.properties.type !== \"columnUserfield\") {\r\n                    if (column.properties.xpath == columnXpath) {\r\n                        var cellOverride = self.getCellOverride(id, column.columnIndex - 1);\r\n                        return column.canBeSent(id, cellOverride);\r\n                    }\r\n                } else {\r\n                    for (j in column.properties) {\r\n                        if (column.properties.hasOwnProperty(j)) {\r\n                            if (Object.prototype.toString.apply(column.properties[j]) === \"[object String]\") {\r\n                                xpath = column.properties[j].substr(column.properties[j].lastIndexOf(\".\") + 1);\r\n                                if (xpath === columnXpath) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /* \r\n     *  Method to determine if the render value can be sent to the server or not\r\n     */\r\n    canBeSent: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n\r\n        // The render can be sent if it is \"display only\" and inline Edit is available\r\n        if (!displayOnly && (properties.inlineEdit || properties.inlineAdd || !$.isEmptyObject(self.changes))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the value for a requested cell\r\n     */\r\n    getCellValue: function (key, xpath) {\r\n        var self = this;\r\n        var data = self.properties.data.rows;\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i][0] == key) {\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        var result = data[i][j + 1];\r\n                        return result;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    getCellCurrentValue: function (key, xpath) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control && typeof control.getValue === \"function\") {\r\n            return control.getValue();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *   Gets control\r\n     */\r\n    getControlCell: function (key, xpath) {\r\n        var self = this;\r\n        var control = null;\r\n        if (typeof (self.columns) != \"undefined\")\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath || self.columns[j].properties.id == xpath) {\r\n                    control = self.columns[j].getDecorated(key);\r\n                    break;\r\n                }\r\n            }\r\n\r\n\r\n        return control;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n     *   Fetch the data again and updates the content\r\n     */\r\n    refresh: function () {\r\n    },\r\n    /*\r\n     *   Sets an error on the cell\r\n     */\r\n    setError: function (key, columnXpath) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the visibility for a cell\r\n     */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the editability for a cell\r\n     */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Changes the required for cell\r\n     */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Refresh behaviors of cell\r\n     */\r\n    changeCellProperties: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Clean data of cell\r\n     */\r\n    cleanCellData: function (key, xpath) {\r\n    },\r\n\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.saveGrid().done(function () {\r\n\r\n            // Renders again\r\n            var properties = {properties: $.extend({editable: bizagi.util.parseBoolean(argument)}, self.originalData)};\r\n\r\n            // Clears control\r\n            control.empty();\r\n\r\n            bizagi.rendering.render.prototype.initializeData.apply(self, [properties]);\r\n\r\n            self.initProperties();\r\n            self.changeColumnsEditability(argument);\r\n\r\n            if (typeof self.internalRenderControl == \"function\") {\r\n                $.when(self.internalRenderControl()).done(function (html) {\r\n                    control.append(html);\r\n                    self.postRenderElement(self.element);\r\n                });\r\n\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    saveGrid: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        var rows = $(\"[data-bizagi-component=rows]\", self.element).find(\"[data-new-row=true]\");\r\n        if (rows.length > 0) {\r\n            rows = $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n            self.saveInlineAddedRows(rows).done(function () {\r\n                defer.resolve();\r\n            });\r\n        } else {\r\n            defer.resolve();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    changeColumnsEditability: function (value) {\r\n        var self = this;\r\n        var columns = self.columns || [];\r\n\r\n        $.each(columns, function (i, column) {\r\n            column.properties.editable = value;\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Refresh behaviors of cell\r\n     */\r\n    refreshCell: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var key = params.key;\r\n        var column = params.column;\r\n        var xpathContext = (params.xpathContext !== \"\") ? params.xpathContext + \".\" + self.properties.xpath + self.buildCellXpathFilter(key) : self.properties.xpath + self.buildCellXpathFilter(key);\r\n        var cell = self.getControlCell(key, params.column);\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id;\r\n\r\n        if (!cell) {\r\n            return;\r\n        }\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        cell.beforeToRefresh();\r\n\r\n        // Call service\r\n        return $.when(self.dataService.multiaction().refreshGridCell({\r\n            idRender: properties.id,\r\n            column: cell.properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: xpathContext,\r\n            idForm: idForm,\r\n            typeRender: cell.properties.type\r\n        })).done(function (data) {\r\n            // Extract values\r\n            var getDepthData = function (target) {\r\n                if (target && typeof target == \"object\" && target.length >= 1) {\r\n                    return (target[0].length >= 1) ? target[0][0] : target[0];\r\n                }\r\n                return \"\";\r\n            };\r\n            var newValue = getDepthData(data.rows);\r\n            var editable = getDepthData(data.editable);\r\n            if (!bizagi.util.isBoolean(editable)) {\r\n                editable = editable || true;\r\n            }\r\n            var visible = getDepthData(data.visible);\r\n            if (!bizagi.util.isBoolean(visible)) {\r\n                visible = visible || true;\r\n            }\r\n            \r\n            // Change Visibility & Editability\r\n            self.changeCellVisibility(key, column, visible);\r\n            self.changeCellEditability(key, column, editable);\r\n\r\n            // Change control value\r\n            cell.setValue(newValue);\r\n            cell.setDisplayValue(newValue);\r\n\r\n            // Trigger grid change\r\n            self.triggerRenderChange({key: key, column: column, changed: false});\r\n\r\n            // Update the affected cell manually after a refresh\r\n            //TODO:temporary solution\r\n            //review the DRAGON-5982 \r\n            if (cell.column != undefined && bizagi.util.detectDevice() == \"desktop\") {\r\n                self.updateAffectedCellManually(key, newValue, cell.column.columnIndex);\r\n            }\r\n\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            cell.afterToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Triggers the render change event\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Property to verify exporting updated grids\r\n        if (!bizagi.util.isEmpty(params) && params.changed != false)\r\n            self.properties.canBeExported = false;\r\n        self.triggerHandler(\"renderchange\", {\r\n            render: self,\r\n            surrogateKey: params.key,\r\n            column: params.column,\r\n            changed: params.changed,\r\n            rowDeleted: params.rowDeleted,\r\n            pressed: params.pressed\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Validate the grid\r\n     */\r\n    validate: function () {\r\n        this.isValid([]);\r\n    },\r\n    /* \r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.hasErrors = false;\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check for required columns and null values\r\n        if (self.properties.data && self.properties.data.rows) {\r\n            var newRows = self.getDataNewRows();\r\n            // Preserve elements in data.rows\r\n            // Check required\r\n            if (newRows.length == 0 && bizagi.util.parseBoolean(self.properties.required)) {\r\n                if (!self.hasValue()) {\r\n                    message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({\r\n                        xpath: self.properties.xpath,\r\n                        message: message\r\n                    });\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n            var data = $.merge($.merge([], self.properties.data.rows), newRows);\r\n\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                var messages = [];\r\n                var uniqueMessages = {};\r\n\r\n                for (var j = 0; j < data.length; j++) {\r\n                    var value = data[j][i + 1];\r\n                    var key = data[j][0];\r\n                    var xpath = self.columns[i].properties.xpath;\r\n                    if (self.changes[key] !== undefined && self.changes[key][self.columns[i].properties.xpath] !== undefined) {\r\n                        value = self.changes[key][self.columns[i].properties.xpath];\r\n                    }\r\n\r\n                    // Check if the column is valid\r\n                    var valueValid = self.columns[i].isValueValid(key, value, messages, self.getCellOverride(key, i));\r\n                    if (!valueValid) {\r\n                        bValid = false;\r\n\r\n                        self.hasErrors = true;\r\n                        self.setError(key, self.columns[i].properties.xpath);\r\n                    }\r\n                }\r\n                for (var k = 0, messagesLength = messages.length; k < messagesLength; k++) {\r\n                    if (uniqueMessages[messages[k]] == null) {\r\n                        uniqueMessages[messages[k]] = messages[k];\r\n                    }\r\n                }\r\n\r\n                if (messages.length > 0) {\r\n                    var gridValidationMessage = self.getResource(\"render-grid-validation\").replaceAll(\"#grid#\", self.properties.displayName);\r\n                    for (key in uniqueMessages) {\r\n                        invalidElements.push({\r\n                            xpath: self.properties.xpath,\r\n                            message: gridValidationMessage + \" \" + key\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n    /*\r\n     *   Enables submit on change feature for the current render\r\n     */\r\n    configureSubmitOnChange: function () {\r\n        // Don't do anything we will trigger submit on change manually only when the grid add or edit form has been edited   \r\n    },\r\n    /*\r\n     *   Get cell override\r\n     */\r\n    getCellOverride: function (key, column) {\r\n        var self = this;\r\n\r\n        // Convert to numbers\r\n        key = Number(key);\r\n        column = Number(column);\r\n\r\n        // Find overrides\r\n        var columnProperties = self.columns[column].properties;\r\n        if (!self.cellOverrides[key])\r\n            self.cellOverrides[key] = {};\r\n        if (!self.cellOverrides[key][column]) {\r\n            self.cellOverrides[key][column] = {\r\n                visible: columnProperties.visible,\r\n                editable: columnProperties.editable,\r\n                required: columnProperties.required\r\n            };\r\n        }\r\n\r\n        return self.cellOverrides[key][column];\r\n    },\r\n\r\n    /*\r\n     * Set cell overrides based on the data\r\n     */\r\n    setCellOverrides: function (data, columns) {\r\n        var self = this;\r\n        var key;\r\n\r\n        // Init visibility overrides\r\n        if (data.visible) {\r\n            for (var i = 0, len = data.visible.length; i < len; i++) {\r\n                key = data.visible[i][0];\r\n                for (var j = 0, len_v = data.visible[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).visible = bizagi.util.parseBoolean(data.visible[i][j]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init editability overrides\r\n        if (data.editable) {\r\n            for (var i = 0, len = data.editable.length; i < len; i++) {\r\n                key = data.editable[i][0];\r\n                for (var j = 0, len_v = data.editable[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0) {\r\n                        var columnEditable = columns ? bizagi.util.parseBoolean(columns[j - 1].properties.editable) : true;\r\n                        self.getCellOverride(key, j - 1).editable = columnEditable ? bizagi.util.parseBoolean(data.editable[i][j]) : false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init required overrides\r\n        if (data.required) {\r\n            for (var i = 0, len = data.required.length; i < len; i++) {\r\n                key = data.required[i][0];\r\n                for (var j = 0, len_v = data.required[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).required = bizagi.util.parseBoolean(data.required[i][j]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the row indexes for the data\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.properties.data.rows, self.getDataNewRows());\r\n        return $.map(data, function (item, i) {\r\n            return item[0];\r\n        });\r\n    },\r\n    /**\r\n     *  Return object with value of all new records unsaved within the grid\r\n     *  @return {object} all new records\r\n     */\r\n    getDataNewRows: function () {\r\n        var self = this;\r\n        var newRows = [];\r\n\r\n        if (typeof self.newRecords == \"object\" && !$.isEmptyObject(self.newRecords)) {\r\n            $.each(self.newRecords, function (rowKey) {\r\n                var cellValue = [];\r\n                cellValue.push(Number(rowKey));\r\n                for (var i = 0, length = self.columns.length; i < length; i++) {\r\n                    cellValue.push(self.getCellCurrentValue(rowKey, self.columns[i].properties.xpath));\r\n                }\r\n                // Add cell value row to new rows\r\n                newRows.push(cellValue);\r\n            });\r\n        }\r\n        return newRows;\r\n    },\r\n\r\n    /*\r\n     * Return the object with the required url to access the exported grid to the desired format\r\n     *  @return {object} render attributes, including id, xpathContext, idPagecache, disposition (inline or attachment), and exportType (XLS or PDF)\r\n     */\r\n    getGridExportUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getGridExportUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: params.disposition,\r\n            exportType: params.exportType,\r\n            sort: properties.sort,\r\n            sessionId: self.getSessionId(),\r\n            idForm: self.getFormContainer().properties.id\r\n\r\n        });\r\n    },\r\n\r\n    submitForGridChange: function () {\r\n        var self = this;\r\n        return self.submitOnChange(null, false);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.columns) {\r\n                $.each(self.columns, function (i, column) {\r\n                    column.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    getEnabledChecks: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            rows: properties.rowsPerPage,\r\n            xpathfilter: params.xpath\r\n        });\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridDataExclusivesSelected(params).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.page = data.page;\r\n            properties.records = data.records;\r\n            properties.totalPages = data.totalPages;\r\n\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n            defer.resolve(data);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    buildCellXpathFilter: function (key) {\r\n        if (bizagi.util.isNumeric(key)) return \"[id=\" + key + \"]\";\r\n        return \"[id='\" + key + \"']\";\r\n    },\r\n\r\n    cleanNewRecords: function () {\r\n        // Mark it as saved\r\n        this.newRecords = {};\r\n    },\r\n\r\n    /**\r\n     *\r\n     * Customizes render background color\r\n     *\r\n     * This method is called when the backgroud color is setted by Form Designer\r\n     *\r\n     * @param color\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        this._super(color);\r\n\r\n        var control = this.getControl();\r\n        control.find(\".bz-rn-grid-header-title\").css(\"background-color\", color, \"!important\");\r\n        control.find(\".bz-rn-grid-container-foother\").css(\"background-color\", color, \"!important\");\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Check has header format\r\n     * @returns {boolean}\r\n     */\r\n    hasColorHeader: function () {\r\n        var headerFormat = this.properties.headerFormat || {};\r\n\r\n        return headerFormat ? !bizagi.util.isEmpty(headerFormat.color) : false;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Hidden Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for hiddens\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.hidden\", {}, {\r\n\r\n    /**\r\n     * Returns the in-memory processed element\r\n     */\r\n    renderControl: function () {\r\n        if (this.getMode() === \"design\") {\r\n            return \"<div>\" + bizagi.localization.getResource(\"render-hidden-displayName\") + \"</div>\";\r\n        } else {\r\n            return \"<div />\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var properties = this.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Set the initial value\r\n        if (properties.value !== undefined) {\r\n            this.setDisplayValue(properties.value);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Label Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels\r\n */\r\n$.Class.extend(\"bizagi.rendering.label\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // A label itself is never \"required\" as other controls\r\n        var properties = self.properties;\r\n        properties.required = false;\r\n\r\n        // Set properties\r\n        self.properties.displayType = \"label\";\r\n        //self.properties.labelAlign = self.originalProperties.labelAlign || \"left\";\r\n        self.properties.displayName = data.properties.displayName || \"\";\r\n\r\n        if (bizagi.util.parseBoolean(self.properties.allowDinamiclabel)) {\r\n            this.properties.displayName = data.properties.displayName || bizagi.localization.getResource(\"render-label-default-display-name\");\r\n        }\r\n\r\n        self.bindingValue();\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        //this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n\r\n        if (typeof this.configureHelpText == \"function\")\r\n            this.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required label\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    bindingValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.allowDinamiclabel && self.properties.value) {\r\n            if (typeof (self.properties.value) === \"object\" && self.properties.value[0]) {\r\n                self.properties.displayName = self.properties.value[0].value;\r\n            } else if (typeof (self.properties.value) === \"string\" && self.properties.value !== \"\") {\r\n                self.properties.displayName = self.properties.value;\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function(){\r\n        //Labels never change\r\n        return false;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Render Search Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for search renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.search\", {}, {\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.searchForms = properties.searchForms || [];\r\n\r\n        // Default maxRecords is 20\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.advancedSearch = (bizagi.util.parseBoolean(properties.advancedSearch) === null) ? false : bizagi.util.parseBoolean(properties.advancedSearch);\r\n        properties.allowSuggest = bizagi.util.parseBoolean(properties.allowSuggest) !== null ? bizagi.util.parseBoolean(properties.allowSuggest) : false;\r\n        properties.allowFullSearch = properties.allowFullSearch || false;\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) || false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowTyping) !== null ? bizagi.util.parseBoolean(properties.allowTyping) : false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowSuggest) ? true : properties.allowTyping;\r\n        properties.allowClear = bizagi.util.parseBoolean(properties.allowClear) !== null ? bizagi.util.parseBoolean(properties.allowClear) : false;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // This length defines the behavior of the suggest, 2 characters are used by default meaning after 2 characters are written the search will take place\r\n        properties.searchLength = properties.searchLength || 2;\r\n\r\n        // Expire local storage cache\r\n        properties.enableLocalStorage = false;\r\n        properties.expireCache = 1000 * 60 * 15; // 15 minutes\r\n\r\n        // QAF-3297 - Compatibility for old versions of advanced search where the \"submitOnChange\" property default is true\r\n        // New \"submitVersion\" property default is 2\r\n        if (properties.advancedSearch && self.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            allowTyping: properties.allowTyping,\r\n            advancedSearch: properties.advancedSearch,\r\n            allowSuggest: properties.allowSuggest,\r\n            editable: properties.editable,\r\n            allowClear: properties.allowClear,\r\n            hasValue: self.hasValue(),\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        params.h_contexttype = self.properties.enableQuerySuggestBehavior ? \"metadata\" : params.h_contexttype;\r\n\r\n        // QA-471 When the contexttype is metadata it does not send xpathcontext\r\n        if (params && params.h_contexttype && params.h_contexttype === 'metadata') {\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // BA35025 - JFA\r\n        if (properties.term.indexOf(\"\\'\") > -1) {\r\n            var regexC = new RegExp(\"\\'\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\\'\\\\'\");\r\n        }\r\n\r\n        // QAF-6448 - JFA\r\n        if (properties.term.indexOf(\"\\\"\") > -1) {\r\n            var regexC = new RegExp(\"\\\"\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\"\");\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype: params.h_contexttype,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value\r\n     * @param {} triggerEvents\r\n     * @returns {}\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        self._super(value, triggerEvents);\r\n\r\n        if (value != undefined) {\r\n            this.value = value;\r\n            this.selectedValue = value.label;\r\n        } else {\r\n            this.value = null;\r\n            this.selectedValue = null;\r\n        }\r\n    },\r\n\r\n    /* Maps the value, when this one comes from actions*/\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var xpath = self.properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos\r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) == \"object\" && value.id === undefined)\r\n                    return;\r\n                // Add the value to the server\r\n                renderValues[xpath] = value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {}\r\n     */\r\n    submitData: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        // Add current data\r\n        if (!self.grid) {\r\n            data[self.properties.xpath] = self.getValue();\r\n        }\r\n\r\n        // Executes submit on change\r\n        self.submitOnChange(data, undefined, false);\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (typeof (value) == \"undefined\" || value == null) return false;\r\n\r\n        if (typeof value === \"object\" && value.id !== \"\" && typeof (value.id) !== \"undefined\") return true;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.text\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\");\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"text\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            value: this.properties.value,\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            helpText: this.properties.helpText,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"text-read-only\");\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isString(value)) {\r\n            value = value.replaceAll(\"`\", \"&#96;\");\r\n        }\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value, editable: this.properties.editable});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = this.getControl().find(\"input\");\r\n\r\n        //Attach event for retype double\r\n        if (this.properties.retype === \"double\")\r\n            this.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check mask property\r\n        if (properties.mask)\r\n            self.input.mask({mask: properties.mask});\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.input.val(), false);\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.input.val(), true);\r\n                }\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        // When the form have big data, block browser executing RegExp. QAF-1418.\r\n        // Check regular expression\r\n        if (typeof value == \"string\") {\r\n            if (properties.regularExpression) {\r\n                var regex = new RegExp(\"\");\r\n                try {\r\n                    regex = new RegExp(properties.regularExpression.expression);\r\n                } catch (e) {\r\n                    if (bizagi.override.showDesignValidations) {\r\n                        bizagi.log(e);\r\n                        invalidElements.push({xpath: properties.xpath, message: e.message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n\r\n                if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex) && self.properties && self.properties.xpath === \"userName\"))) {\r\n                    var message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                } else {\r\n                    if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex)))) {\r\n                        var message = properties.regularExpression.message;\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            } else {\r\n                // Strange behavior on IE. When matchs are united on IE have is very slow\r\n                // solution, divide matchs\r\n                //.*? means for more information search: \"Lazy matching regexp\"\r\n                if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                    if (properties.editable) {\r\n                        var message = this.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (!bizagi.util.parseBoolean(self.properties.editable)) {\r\n            // Render as simple value\r\n            if (typeof (value) === \"string\") {\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(\"<label class='readonly-control'>\" + valueToDisplay + \"</label>\");\r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    control.html(\"\");\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * @param value\r\n     */\r\n    setValue: function (value) {\r\n        this._super(value);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n\r\n});","/**\r\n *   Name: Bizagi Render Button Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for button renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.button\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = properties.caption || \"\";\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n\r\n        // This flag enable/disable default behaviors of buttons\r\n        // auto save and execute rule\r\n        properties.preventDefault = properties.preventDefault || false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"button\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            caption: self.properties.caption,\r\n            cssClass: self.properties.cssclass || \"\",\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render behaviour after to be processed\r\n     */\r\n    postRender: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     * @returns {}\r\n     */\r\n    saveForm: function () {\r\n        var form = this.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Executes the button action\r\n     * @returns {}\r\n     */\r\n    executeButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = properties.xpathContext || \"\";\r\n\r\n        if (properties.submitOnChangexpathContextRow) {\r\n            xpathContext = xpathContext ? xpathContext + \".\" + properties.submitOnChangexpathContextRow : properties.submitOnChangexpathContextRow;\r\n        }\r\n\r\n        // Set the loading feedback\r\n        self.getFormContainer().startLoading();\r\n\r\n        return self.dataService.multiaction().executeButton({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath || \"\",\r\n            xpathContext: xpathContext || \"\",\r\n            idPageCache: properties.idPageCache\r\n        }).always(function () {\r\n            self.getFormContainer().endLoading();\r\n            return arguments ? arguments[0] : undefined;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh the current form\r\n     * @returns {}\r\n     */\r\n    refreshForm: function () {\r\n        var form = this.getFormContainer();\r\n        form.refreshForm(this.properties.id);\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            // Save the form prior opening the dialog\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the render change event\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        var pressed = params.pressed || false;\r\n\r\n        self.triggerHandler(\"renderchange\", {render: self, pressed: pressed});\r\n    },\r\n\r\n    /**\r\n     * Run button actions\r\n     * @returns {}\r\n     */\r\n    runButtonAction: function () {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function () {\r\n            return self.executeButton();\r\n        }).done(function (result) {\r\n\r\n            if (result == null || result == true || result.result === \"success\" || result.type === \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type === \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages\r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                    // bizagi.showMessageBox(result.messages, \"Error\"); // TODO\r\n                }\r\n            }\r\n        }).fail(function (a, b, message) {\r\n            // Add error messages\r\n            try {\r\n                self.getFormContainer().addErrorMessage(message);\r\n            } catch (e) {\r\n                // bizagi.showMessageBox(message, \"Error\"); // TODO\r\n            }\r\n        });\r\n    },\r\n\r\n    processLayout: function (isLabelFormat, format) {\r\n        if (isLabelFormat) {\r\n            this.changeBackgroundColor(format.background);\r\n            this._super(!isLabelFormat, format);\r\n        }\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.getElementsToStylize(this.getControl()).style(\"background\", color, \"important\");\r\n        } else {\r\n            this.getElementsToStylize(this.getControl()).css(\"background\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return $(\"input\", $context);\r\n    },\r\n\r\n    /**\r\n     *  Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Fileprint Class\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will define basic stuff for fileprint renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.fileprint\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = (properties.caption && properties.caption != \" \")? properties.caption : \"render-fileprint-property-caption\";\r\n        properties.filesCount = properties.filesCount ? properties.filesCount : 0;\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"fileprint\");\r\n\r\n        return $.fasttmpl(template, {\r\n            caption: properties.caption\r\n        });\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n    *   get the fileprint url\r\n    */\r\n    getFilePrintUrl: function (disposition) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getFilePrintUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: disposition,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n     /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Simple Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.link\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n        properties.required = false;\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"link\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            displayName: self.properties.displayName,\r\n            align: self.properties.valueAlign,\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Do nothing\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Radio Class\r\n *   Author: Ivan Ricardo Taimal Narvaez\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n        self.setValue(properties.items);\r\n        self.updateOriginalValue();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n        self.checkListGroup = $(\".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item\", control);\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var items = self.properties.items || [];\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: items\r\n        }));\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Gets the template used by the combo render\r\n     *   can be overriden in subclasses to reuse logic and just change the template\r\n     */\r\n    getTemplateName: function () {\r\n        return \"checkList\";\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the empty node or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the current data regardless if it belongs to data or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Adds custom parameters to process the template\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal\r\n        };\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n\r\n    },\r\n\r\n    setValue: function (value) {;\r\n        this.value = bizagi.clone(value);\r\n    },\r\n\r\n    getValue: function (data) {;\r\n        return this.value || [];\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Layout Render Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define a base layout render class with common stuff related to all renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutRender\", {}, {\r\n\t/*\r\n\t *   Returns the html templated element\r\n\t */\r\n\trenderElement: function (template) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\t// Start rendering deferred\r\n\t\tself.renderingDeferred = new $.Deferred();\r\n\r\n\t\t// Set render template\r\n\t\ttemplate = template || \"render-layout\";\r\n\t\tvar renderTemplate = self.renderFactory.getTemplate(template);\r\n\r\n\t\t// Resolve render label\r\n\t\tvar label = properties.displayName;\r\n\t\tif (typeof label == \"string\") {\r\n\t\t\tlabel = label.replaceAll(\"&\", \"&amp;\");\r\n\t\t\tlabel = label.replaceAll(\"$\", \"&#36;\");\r\n\t\t\tlabel = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n\t\t\tlabel = label.replaceAll(\"\\n\", \"<br/>\");\r\n\t\t}\r\n\r\n\t\t// Render template\r\n\t\tvar html = $.fasttmpl(renderTemplate, {\r\n\t\t\tlabel: label,\r\n\t\t\tisExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n\t\t\torientation: properties.orientation,\r\n\t\t\tuniqueId: properties.uniqueId,\r\n\t\t\tid: properties.id,\r\n\t\t\tisDesign: self.getMode() === \"design\",\r\n\t\t\tmessageValidation: properties.messageValidation,\r\n\t\t\tprintVersion: form.params.printversion,\r\n\t\t\tcssClass: properties.cssclass || \"\",\r\n\t\t\thide: properties.hide\r\n\t\t});\r\n\r\n\t\t// Render internal control html\r\n\t\tvar result = self.internalRenderControl();\r\n\t\tif (!result) {\r\n\t\t\tresult = \"\";\r\n\t\t}\r\n\r\n\t\t// Check if this is an async element or not\r\n\t\tvar async = typeof (result) === \"object\" && result.done;\r\n\t\tif (!async) {\r\n\t\t\thtml = self.replaceControlHtml(html, result);\r\n\r\n\t\t} else {\r\n\t\t\tif (result.state() === \"resolved\") {\r\n\t\t\t\t// Fetch resolved result\r\n\t\t\t\thtml = self.replaceControlHtml(html, self.resolveResult(result));\r\n\t\t\t\tself.asyncRenderDeferred = null;\r\n\t\t\t} else {\r\n\t\t\t\t// Wait for result\r\n\t\t\t\tself.asyncRenderDeferred = result;\r\n\t\t\t\thtml = self.replaceControlHtml(html, \"\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn html;\r\n\t},\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n\tgetControl: function () {\r\n\t\tvar self = this;\r\n\t\tif (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n\t\t\tself.control = self.element;\r\n\t\t}\r\n\t\tif (!self.control || self.control.length == 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn self.control;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font italic style *\r\n    */\r\n\tchangeFontItalic: function (italic) {\r\n\t\tif (bizagi.util.parseBoolean(italic)) {\r\n\t\t\tthis.getControl().css(\"font-style\", \"italic\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().css(\"font-style\", \"normal\", \"!important\");\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font underline\r\n    */\r\n\tchangeFontUnderline: function (underline) {\r\n\t\tvar valueFormat = this.properties.valueFormat || {},\r\n\t\t\tvaluestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n\r\n\t\tif (bizagi.util.parseBoolean(underline)) {\r\n\t\t\tthis.getControl().css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().find(\"*\").each(function (i, element) {\r\n\t\t\t\t$(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n});","/*\r\n*   Name: BizAgi render layout Image Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for non editable image control inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutImage\", { }, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            useDefaultImage = false,\r\n            valueObj = self.properties.value || {},\r\n            uri= \"\";\r\n\r\n        //\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n\r\n        //Solucion temporal mientras se ajusta la respuesta del servicio cambiar despues de demo de 21/07/2015\r\n        /*if (value.value && value.value !== \"\" && value.value.length > 100){\r\n            var template64 = self.renderFactory.getTemplate(\"layout-image64\");\r\n            return $.fasttmpl(template64, { url: value.value, useDefaultImage: useDefaultImage });\r\n        }*/\r\n\r\n        /* if (mode === 'execution' && valueObj.value && valueObj.value.length > 0) {\r\n            uri = self.getImageUri();\r\n        }\r\n        else{\r\n            useDefaultImage = true;\r\n        } */\r\n\r\n        return $.fasttmpl(templateUri, {useDefaultImage: true });\r\n    },\r\n\r\n    /**\r\n     * Gets the base 64 image, specify in each device in order to change the size\r\n     */\r\n    getImage64: function () {\r\n        var self = this;\r\n        //Gets the real value of the image\r\n        var params = {\r\n            xpath: self.properties.xpath,\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            width: 96,\r\n            height: 96\r\n        };\r\n\r\n        return self.dataService.getEntityImage64(params);\r\n    },\r\n\r\n    /**\r\n     * Gets the url to get the array image, specify in each device in order to change the size\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Andrés Fernando Muñoz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-link\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {displayName: self.properties.displayName});\r\n        return html;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.properties.required = false;\r\n\r\n        // Set properties\r\n        this.properties.displayType = \"label\";\r\n        this.properties.labelAlign = this.originalProperties.labelAlign || \"left\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-label\");\r\n        var value = self.properties.displayName || self.properties.value || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutText\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        //properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-text\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value,editable: self.properties.editable});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Upload Class\r\n *   Author: Elkin Fernando Siabato Cruz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable upload renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutUpload\", {\r\n   // Statics\r\n   BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n   BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n   BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n   /**\r\n    * Constructor\r\n    */\r\n   init: function (params) {\r\n      // Call base\r\n      this._super(params);\r\n   },\r\n\r\n   /**\r\n    *   Update or init the element data\r\n    */\r\n   initializeData: function (data) {\r\n      var self = this;\r\n      // Call base\r\n      this._super(data);\r\n\r\n      var form = self.getFormContainer();\r\n\r\n      // Fill default properties\r\n      var properties = this.properties;\r\n\r\n      properties.editable = true;\r\n      properties.allowDelete = true;\r\n\r\n      properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n      properties.allowSendInMail = properties.allowSendInMail || false;\r\n   },\r\n\r\n   /**\r\n    * Get value files by data\r\n    */\r\n   getValueFilesByData: function(properties){\r\n      var self = this;\r\n      var defer = $.Deferred();\r\n      var dataFiles;\r\n      if (properties.value.value) {//Normal entityTemplate in form QAF-2319\r\n          dataFiles = properties.value.value;\r\n      }\r\n      else {//QAF-2210\r\n          dataFiles = properties.value;\r\n      }\r\n      var valueAuxFiles;\r\n      try{\r\n         if(self.isContextContainerWidgetRender()){\r\n            valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + dataFiles  + \"}\");\r\n            defer.resolve(properties, valueAuxFiles);\r\n         }\r\n         else{//context: my stuff\r\n            $.when(self.getDataFilesWithoutScope()).done(function(valueResult){\r\n               valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + valueResult  + \"}\");\r\n               defer.resolve(properties, valueAuxFiles);\r\n            });\r\n         }\r\n      }\r\n      catch(err){\r\n         valueAuxFiles = JSON.parse(\"{ \\\"files\\\": []}\");\r\n         defer.resolve(properties, valueAuxFiles);\r\n         console.warn(\"Exception converting data files. Error: \", err);\r\n      }\r\n      return defer.promise();\r\n   },\r\n\r\n   isContextContainerWidgetRender: function(){\r\n      var self = this;\r\n\r\n      var formContainer = self.getFormContainer();\r\n      return formContainer.params.paramsRender && formContainer.params.paramsRender.idRender;\r\n   },\r\n\r\n\r\n   /**\r\n    * Get data files when access from My stuff\r\n    */\r\n   getDataFilesWithoutScope: function(){\r\n      var self = this;\r\n      //Gets the real value of the image\r\n      var params = {\r\n         xpath: self.properties.xpath,\r\n         entity: self.value.guid,\r\n         surrogateKey: self.value.surrogateKey\r\n      };\r\n\r\n      return self.dataService.getFilesDataForLayoutUploadControl(params);\r\n   },\r\n\r\n   /**\r\n    *   Returns the internal value\r\n    */\r\n   getValue: function () {\r\n      return this.files;\r\n   },\r\n\r\n   /**\r\n    *   Returns the xpath to be used\r\n    */\r\n   getUploadXpath: function () {\r\n      return this.properties.xpath;\r\n   }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutBoolean\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-boolean\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: this.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        if(value === null || value === \"\"){\r\n            this.properties.value = \"\";\r\n        }\r\n        else if (value.toString().toLowerCase() === \"true\" || value.toString().toLowerCase() === \"false\"){\r\n            this.properties.value = bizagi.util.parseBoolean(value) ? this.getResource(\"render-boolean-yes\") : this.getResource(\"render-boolean-no\");\r\n        }\r\n        this._super(this.properties.value, triggerEvents);\r\n    }\r\n});","/**\r\n * Name: BizAgi Render Layout DateTime Class\r\n * Author: Andres Fernando Muñoz\r\n * Comments:\r\n * - This script will define basic stuff for text renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var dateFormat = self.getResource(\"dateFormat\");\r\n        var timeFormat = self.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n        else{\r\n            var indexHour = properties.fullFormat.search(/[h|H]+/ig);\r\n            if (indexHour !== -1) {\r\n                properties.fullFormat = properties.fullFormat.substring(0, indexHour - 1);\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                self.value = properties.value; // Value must always hold the value with invariant format\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            }\r\n            else {\r\n                self.value = null;\r\n            }\r\n        }\r\n        else {\r\n            self.value = null;\r\n            properties.value = \"\";\r\n            properties.displayValue = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-date-time\");\r\n        var value = (self.properties.value === null || self.properties.value === \"\") ?  \"\" : self.properties.value;\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value});\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this, dateObj;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        if (value.length == INVARIANT_FORMAT.length || value.length == (INVARIANT_FORMAT.length + 1)) {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        }\r\n        else {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n            if (dateObj && !isNaN(Date.parse(dateObj)) && !$.isNumeric(dateObj)) {\r\n                dateObj.setHours(0, 0, 0, 0);\r\n            }\r\n\r\n        }\r\n        // Set value in input\r\n        if (value && !isNaN(Date.parse(value))) {\r\n            var formattedDateTime = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            dateControl.text(formattedDateTime);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Gets the date control\r\n     */\r\n    getDateControl: function () {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date-time\", self.getControl());\r\n        return self.dateControl;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout number Class\r\n*   Author: Andres Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = typeof (properties.allowDecimals) !== \"undefined\" ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.getDefaultGroupDigits(properties.dataType);\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-number\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n     *   Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n        var regExp2 = /[\\u20AC \\u0024\\u00A3]/;\r\n        if (!value.toString().match(regExp2)) {\r\n            label.formatCurrency(\r\n                {\r\n                    symbol: properties.symbol,\r\n                    positiveFormat: properties.positiveFormat,\r\n                    negativeFormat: properties.negativeFormat,\r\n                    decimalSymbol: properties.decimalSymbol,\r\n                    digitGroupSymbol: properties.digitGroupSymbol,\r\n                    groupDigits: properties.groupDigits,\r\n                    roundToDecimalPlace: properties.numDecimals,\r\n                    colorize: properties.colorize\r\n                });\r\n        }\r\n        return label.text();\r\n    },\r\n\r\n    /*\r\n     *   Return the allow decimals default property based on the datatype\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the group digits default property based on the datatype\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Money Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for money renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol :\r\n                (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol);\r\n        }\r\n        else {\r\n            properties.symbol = \"\";\r\n        }\r\n        properties.groupDigits = true;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutPlaceholder\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n                \r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n             \r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-placeholder\");\r\n        var value = self.properties.value || self.properties.displayName || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for geolocation renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {} data\r\n     */\r\n    init: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        this.geolocation = window.navigator.geolocation;\r\n\r\n        var properties = this.properties;\r\n        properties.allowUpdate = bizagi.util.parseBoolean(properties.allowUpdate) === true;\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"geolocation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, self.properties);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Call base\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} succes_callback\r\n     * @param {} fail_callback\r\n     */\r\n    getCurrentPosition: function (succes_callback, fail_callback) {\r\n        var self = this;\r\n\r\n        if (typeof (self.geolocation) === \"undefined\") {\r\n            if (fail_callback)\r\n                fail_callback(bizagi.localization.getResource(\"render-control-unsuported-by-browser\").replace(\"{0}\", self.properties.type));\r\n            return;\r\n        }\r\n\r\n        var onSuccess = function (position) {\r\n            if (succes_callback)\r\n                succes_callback(position);\r\n        };\r\n\r\n        var onError = function (error) {\r\n            var strMessage = self.getErrorMessage(error);\r\n\r\n            if (fail_callback)\r\n                fail_callback(strMessage);\r\n        };\r\n\r\n        return self.geolocation.getCurrentPosition(onSuccess, onError);\r\n    },\r\n\r\n    /**\r\n     * Get message of error\r\n     * @param error\r\n     * @returns {*|string}\r\n     */\r\n    getErrorMessage: function (error) {\r\n        var strMessage = \"\";\r\n\r\n        // Check for known errors\r\n        switch (error.code) {\r\n            case error.PERMISSION_DENIED:\r\n            case 1:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n            case error.POSITION_UNAVAILABLE:\r\n            case 2:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-position-unavailable\");\r\n                break;\r\n            case error.TIMEOUT:\r\n            case 3:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-timeout\");\r\n                break;\r\n            default:\r\n                strMessage = \"WD: \" + bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n        }\r\n\r\n        return strMessage;\r\n    },\r\n\r\n    /**\r\n     * Change precision number of coordinates\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    performPrecision: function (data) {\r\n        var geolocation = data.split(\" \") || \"\";\r\n\r\n        if (!geolocation) return data;\r\n\r\n        try {\r\n            var latitude = parseFloat(geolocation[0].trim());\r\n            var longitude = parseFloat(geolocation[1].trim());\r\n\r\n            return latitude.toPrecision(10) + \" \" + longitude.toPrecision(10);\r\n        } catch (e) {\r\n            return data;\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Association Class\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define basic stuff for association renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.association\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var properties = self.properties;\r\n\r\n        // Fill default properties\r\n        properties.property = \"flipped\";\r\n        properties.idRender = self.properties.id;\r\n        properties.allowFlip = (typeof properties.allowFlip != \"undefined\") ? bizagi.util.parseBoolean(properties.allowFlip) : true;\r\n        properties.flipped = (typeof properties.flipped != \"undefined\") ? bizagi.util.parseBoolean(properties.flipped) : false;\r\n        properties.flipstate = properties.flipped;\r\n\r\n\r\n        // data of entities (left and right)\r\n        properties.leftData = properties.leftData || [];\r\n        properties.rightData = properties.rightData || [];\r\n\r\n        if (properties.value) {\r\n            self.processPropertyValue();\r\n        }\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation())\r\n            .done(function (flip) {\r\n\r\n                // Make json base, create self.properties.formatJson\r\n                self.makeJsonBase();\r\n\r\n                self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n                var html = $.fasttmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                });\r\n\r\n                /* by default need set self.properties.formatJson */\r\n                self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n                def.resolve(html);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    * Returns the flip state\r\n    */\r\n    getFlipAssociation: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode == \"execution\")\r\n            return self.dataService.getFlipAssociation(self.properties);\r\n\r\n        return false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var value = self.getValue();\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Get the template \r\n    */\r\n    getTemplateName: function () {\r\n        return \"association\";\r\n    },\r\n\r\n\r\n    /**\r\n    * Get Left Data, verify if flipper flags sets true\r\n    * \r\n    * @param column {'0'||'1'}\r\n    */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var data = [];\r\n        var associationData = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(associationData, function(key, item) {\r\n            data.push({ id: item.id, value: item.value });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n    * Association of right elements\r\n    */\r\n    getRightAssociation: function (leftId) {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var association = [];\r\n\r\n\r\n        var isChecked = function (leftId, idRight) {\r\n            var checked = false;\r\n            $.each(properties.formatJson.value, function (key, value) {\r\n                if (!checked && value.id == leftId && value.value.indexOf(idRight) >= 0) {\r\n                    checked = true;\r\n                }\r\n            });\r\n\r\n            return checked;\r\n        };\r\n\r\n        // create association and check element\r\n        if (properties.flipped) {\r\n            // left element\r\n            $.each(properties.leftData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(data.id, leftId)\r\n                });\r\n\r\n            });\r\n        } else {\r\n            $.each(properties.rightData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(leftId, data.id)\r\n                });\r\n            });\r\n        }\r\n\r\n        return association;\r\n    },\r\n\r\n\r\n    removeElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Remove right element from left panel\r\n                    $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                        if (leftId == removeValue) {\r\n                            // Splice from array\r\n                            self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                        }\r\n                    });\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Remove right element from left panel\r\n                $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                    if (rightId == removeValue) {\r\n                        // Splice from array\r\n                        self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n\r\n    addElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Add right element to left panel\r\n                    self.properties.formatJson.value[key][\"value\"].push(leftId);\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Add right element to left panel\r\n                self.properties.formatJson.value[key][\"value\"].push(rightId);\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n    makeJsonBase: function () {\r\n        var self = this;\r\n        self.properties.formatJson = self.properties.formatJson || {\r\n            leftXpath: self.properties.leftXpath,\r\n            rightXpath: self.properties.rightXpath,\r\n            leftFactName: self.properties.leftFactName,\r\n            rightFactName: self.properties.rightFactName,\r\n            value: self.properties.value\r\n        };\r\n    },\r\n\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.formatJson) {\r\n            var values = self.properties.formatJson.value;\r\n        } else {            \r\n            values = self.properties.value;\r\n        }\r\n       \r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var data = values[i];\r\n            if (data && data.value.length > 0) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    * This method process the value.\r\n    * changes the format to send request\r\n    */\r\n    processPropertyValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var values = properties.value;\r\n        var result = [];\r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var value = values[i];\r\n            result.push({ id: value[0], value: value[1] });\r\n        }\r\n\r\n        properties.value = result;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Upload Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for uploads\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.upload\", {}, {\r\n    /***\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        var maxFileSizeOfProperty = Number(properties.maxSize) || 0;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 4091904;\r\n\r\n        properties.maxSize = maxFileSizeOfProperty || maxFileSizeOfUser;\r\n        properties.maxfiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n            var defExtensions = [];\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length > 0) {\r\n                    defExtensions.push(\"*.\" + singleExtensions[i]);\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = defExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowDelete = (bizagi.util.parseBoolean(properties.allowDelete) !== null && properties.editable) ? bizagi.util.parseBoolean(properties.allowDelete) : false;\r\n\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n        properties.allowSendInMail = properties.allowSendInMail || false;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount !== 0,\r\n            noFiles: self.filesCount === 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var itemTemplate = self.getTemplateItemName();\r\n        var template = self.renderFactory.getTemplate(itemTemplate);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = !self.isExecutionMode() ? \"\" : self.buildItemUrl(file); // TODO: Review if need it: javascript:void(0);\r\n\r\n        var html = $.fasttmpl(template, {\r\n            id: file.id,\r\n            mode: mode,\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getUploadXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: form.properties.sessionId,\r\n            contexttype: properties.contexttype\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the upload control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = self.getUploadXpath() + (bizagi.util.isNumeric(fileId) ? \"[id=\" + fileId + \"]\" : \"[id='\" + fileId + \"']\");\r\n\r\n        return self.dataService.deleteUploadFile({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contexttype\r\n        }).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n\r\n        // Set files property\r\n        self.files = value || []; // Dont remove this line\r\n        self.filesCount = self.files.length;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*}\r\n     */\r\n    getValue: function () {\r\n        return this.files;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && properties.editable) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (self.filesCount <= 0 && !newRow) {\r\n                var inlineEdit = self.grid ? self.grid.properties.inlineEdit : true;\r\n\r\n                if (inlineEdit) {\r\n                    message = self.getResource(\"render-required-upload\").replaceAll(\"#label#\", properties.displayName);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        data[prefix + \"xpath\"] = self.getUploadXpath();\r\n        data[prefix + \"idRender\"] = properties.id;\r\n        data[prefix + \"xpathContext\"] = properties.xpathContext;\r\n        data[prefix + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[prefix + \"contexttype\"] = properties.contexttype;\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (self.grid && self.grid.properties.inlineAdd === true) {\r\n                if (!self.hasValue() && !(self.getControl().parents(\"tr\").data(\"new-row\"))) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (!self.hasValue()) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    setRenderRequired: function (invalidElements, properties) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n        invalidElements.push({xpath: properties.xpath, message: message});\r\n    },\r\n\r\n    /**\r\n     * Templates\r\n     */\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render ECM upload control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for ECM Control\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.ecm\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=uploadECMFile\";\r\n        properties.editUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=updateECMFileContent\";\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(properties.xpath);\r\n        properties.showMetadata = properties.showMetadata === undefined || properties.showMetadata === null ? true : bizagi.util.parseBoolean(properties.showMetadata);\r\n\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param listControl\r\n     * @param fileProperties\r\n     * @returns {*}\r\n     */\r\n    renderControl: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"ecm\");\r\n        var mode = self.getMode();\r\n        var defer = new $.Deferred();\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n        var html = $.fasttmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage\r\n        });\r\n\r\n        if (self.properties.value != undefined) {\r\n\r\n            var lengthValues = self.properties.value.length;\r\n\r\n            if (lengthValues === 0) {\r\n                defer.resolve(html);\r\n            }\r\n\r\n            $.each(self.properties.value, function (key, value) {\r\n                var data = {};\r\n\r\n                data.idFileUpload = value[0];\r\n                data.fileName = value[1];\r\n                data.idPageCache = self.properties.idPageCache;\r\n                data.xpathContext = self.getXpathContext();\r\n                data.xPath = self.properties.xpath;\r\n                data.editable = self.properties.editable;\r\n                data.idAttrib = self.properties.idAttrib;\r\n\r\n                var form = self.getFormContainer();\r\n                if (form && form.properties && form.properties.sessionId) {\r\n                    data.sessionId = form.properties.sessionId;\r\n                }\r\n\r\n                if (mode === \"execution\") {\r\n                    $.when(self.renderFileLayout(data, fileProperties)).done(function (item) {\r\n                        lengthValues--;\r\n\r\n                        if (bizagi.loader.productBuildToAbout && bizagi.loader.productBuildToAbout.indexOf(\"10.4\") === 0) {\r\n                            item = item.replaceAll(\"Handlers/MetadataFile\", \"Handlers/Metadata\");\r\n                        }\r\n\r\n                        html = self.replaceItemHtml(html, self.properties.id + \"-\" + data.idFileUpload, item);\r\n                        if (lengthValues === 0) {\r\n                            defer.resolve(html);\r\n                        }\r\n                    });\r\n\r\n                }\r\n            });\r\n        } else {\r\n            defer.resolve(html);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    replaceItemHtml: function (html, id, replace) {\r\n        return html.replace(\"{{\" + id + \"}}\", replace);\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            var html = $.fasttmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return (image.indexOf(extension.toUpperCase()) > -1) ? true : false;\r\n    },\r\n\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var p_sessionId = bizagi.cookie(\"JSESSIONID\");\r\n\r\n        if(!file.data) {\r\n            file.data = {fileName: file.fileName, idAttrib: file.idAttrib}\r\n        }\r\n\r\n        return self.dataService.getECMFileUrl({\r\n            idFileUpload: file.idFileUpload,\r\n            xPath: file.xpath || file.xPath,\r\n            xpathContext: file.xpathContext,\r\n            idAttrib: file.data.idAttrib,\r\n            idPageCache: self.properties.idPageCache,\r\n            fileName: file.data.fileName.replace(/ /g, \"_\"),\r\n            p_sessionId: p_sessionId,\r\n            sessionId: file.data.sessionId || \"\"\r\n        });\r\n    },\r\n\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        // data.fileExt = properties.validExtensions;\r\n        // data.fileDesc = properties.validExtensions ? self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions : \"\";\r\n        data.xPath = properties.xpath;\r\n        data.idAttrib = properties.idAttrib;\r\n        data.xpathContext = properties.xpathContext;\r\n        data.metaValues = [];\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Get name of file extension\r\n     * @param fileName\r\n     * @returns {*}\r\n     */\r\n    getFileExtension: function (fileName) {\r\n        fileName = fileName || \"\";\r\n        return fileName.split(\".\").pop();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = (self.files.length) ? self.files.length : properties.value;\r\n    },\r\n\r\n    /**\r\n     * Gets xpath context\r\n     * @returns {*|string}\r\n     */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.deleteECMFile(params).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Lock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    lockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.checkOutFile(params);\r\n    },\r\n\r\n    /**\r\n     * Unlock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    unlockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.cancelCheckOut(params);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Yes-no Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for yes-no renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.yesno\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"yesno\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmptyValue(value)) return false;\r\n        return bizagi.util.parseBoolean(value) !== null;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Letter Class\r\n*   Author: Diego Parra\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for letter renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.letter\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a variable to check if the letter has been opened when editable\r\n        this.letterOpened = false;\r\n    },\r\n\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter.readonly\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getLetterContent: function () {\r\n        // Set flag to true\r\n        this.letterOpened = true;\r\n\r\n        return this.dataService.getLetterContent({\r\n            url: this.properties.getUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sends the content to the server in order to save\r\n     * @param {} content\r\n     */\r\n    saveLetterContent: function (content) {\r\n        return this.dataService.saveLetterContent({\r\n            url: this.properties.saveUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache,\r\n            content: content\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getCanGenerateLetter: function () {\r\n        return this.dataService.getCanGenerateLetter({\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) return true;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) return true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.letterOpened == false) {\r\n                message = self.getResource(\"render-letter-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the current xpath\r\n     */\r\n    getXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the current context xpath\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Form Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.formLink\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n\r\n        properties.displayType = \"value\";\r\n        properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"formLink\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            align: properties.valueAlign,\r\n            displayName: properties.displayName,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            likeButton: bizagi.util.parseBoolean(properties.likeButton) || false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Submits a edit request for a link display form\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitEditRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        return self.dataService.editLinkForm({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: self.getFormLinkXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        }).done(function (response) {\r\n            var executeSubmitOnChange = true;\r\n\r\n            if (response && response.type === \"validationMessages\")\r\n                executeSubmitOnChange = false;\r\n\r\n            if (executeSubmitOnChange)\r\n                self.submitOnChange({});\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a rollback request\r\n     * @param params\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            }\r\n            else{\r\n                return self.dataService.rollbackLinkForm({\r\n                    url: properties.rollbackUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: params ? params.idPageCache : properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a commit request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCommitRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.commitLinkForm({\r\n                    url: properties.commitUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a checkpoint request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCheckpointRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.sendCheckpoint({\r\n                    url: properties.checkpointUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a submitData request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitDataRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function () {\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value) {\r\n                return null;\r\n            } else {\r\n\r\n\r\n                return self.dataService.submitData({\r\n                    url: properties.checkpointUrl,\r\n                    action: \"SUBMITDATA\",\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Get Form Link xpath to use\r\n     * @returns {*}\r\n     */\r\n    getFormLinkXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Don't do anything\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render Cascading Combo Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for cascading combo renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Create dependency collection\r\n        self.dependants = [];\r\n        self.isDependant = false;\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.hasLocalData = bizagi.util.isEmpty(properties.parentCombo) ? properties.hasLocalData : false;\r\n\r\n        if (properties.value && properties.value.id === undefined)\r\n            properties.value = null;\r\n\r\n        self.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData)\r\n            properties.data = self.complementData(properties.data);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo != null) {\r\n            var renderType = bizagi.util.normalizeType(parentCombo.properties.type);\r\n\r\n            if (/^cascadingcombo$/i.test(renderType)) {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n\r\n    configureReadOnlyHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n    /*\r\n    *   Refresh the combo, after it has been painted\r\n    */\r\n    refresh: function (params, isInitialValue) {\r\n        var self = this;\r\n\r\n        // Wait until current element is rendered\r\n        $.when(self.isRendered()).done(function () {\r\n\r\n            // Unbind previous handler\r\n            // self.parentCombo.unbindDependantCombo(self);\r\n\r\n            // Clear current control\r\n            var control = self.getControl();\r\n            var mode = self.getMode();\r\n            control.empty();\r\n\r\n            // Render combo again\r\n            $.when(self.renderCombo(params)).then(function (html) {\r\n                // Append new element\r\n                control.html(html);\r\n\r\n                // Post-render method\r\n                self.postRender();\r\n\r\n                if (mode == \"execution\") {\r\n                    self.configureHandlers();\r\n                }\r\n\r\n                // Set current value\r\n                if (self.getValue() !== undefined) {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n\r\n                if (self.deferredVisible) {\r\n                    self.deferredVisible.resolve();\r\n                }\r\n\r\n                self.trigger(\"select\", [self.value, isInitialValue]);\r\n\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode != \"execution\") return self.getDummyData();\r\n\r\n        // Do not load dependant combos when there are no parent id\r\n        if (self.isDependant) {\r\n            if (self.parentCombo && params) {\r\n                self.properties.remoteDataLoaded = false;\r\n            }\r\n\r\n            // Return an empty array when there are no parent defined when the combo is dependant\r\n\r\n            var parentValue = (self.parentCombo.selectedValue) ? self.parentCombo.selectedValue.id : '';\r\n\r\n            if (parentValue != '') {\r\n                return this._super(params);\r\n            } else {\r\n                return [];\r\n            }\r\n        }\r\n\r\n        return this._super(params);\r\n    },\r\n\r\n\r\n    /* \r\n    *   Bind the combos to create the cascading feature\r\n    */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var renderType = bizagi.util.normalizeType(dependantCombo.properties.type);\r\n\r\n        // Check it is a cascading combo\r\n        if (/^cascadingcombo$/i.test(renderType)) {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n                self.refreshDependantCombo(dependantCombo, item.id, self.focusDependant, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (self.properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    isEventBinded: function (event) {\r\n        if (typeof $._data(this.observableElement.get(0), \"events\") === \"undefined\") {\r\n            return false;\r\n        } else {\r\n            if (typeof $._data(this.observableElement.get(0), \"events\")[event] === \"undefined\") {\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /* \r\n    *   Unbind the combos that are being redrawn\r\n    */\r\n    unbindDependantCombo: function (dependantCombo) {\r\n        // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n        this.unbind(\"select\", dependantCombo.onChangeFunction);\r\n    },\r\n\r\n    /*\r\n    *   Fills the next dependant combo based on the given value\r\n    */\r\n    refreshDependantCombo: function (dependant, parentValue, focus, isInitialValue) {\r\n        var self = this;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue;\r\n\r\n        dependant.deferredVisible = $.Deferred();\r\n\r\n        if (!isInitialValue) {\r\n            // Clear dependant value\r\n            dependant.setValue(\"\", false);\r\n        }\r\n\r\n        dependant.refresh(params, isInitialValue);\r\n\r\n        if (focus) {\r\n            $.when(dependant.deferredVisible.promise()).done(function () {\r\n                dependant.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Empty html when render from action\r\n     */\r\n\r\n    emptyControlByChangeEditability: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    },\r\n\r\n    /* \r\n    *   Cleans the combo value\r\n    */\r\n    cleanInput: function () {\r\n        this.triggerHandler(\"select\", {id: 0});\r\n    },\r\n\r\n    /*\r\n    *   Search for the other cascading combo refering this one, by idRender\r\n    */\r\n    getParentCombo: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check if parentCombo is defined\r\n        if (properties.parentCombo === undefined)\r\n            return null;\r\n\r\n        // Get form reference\r\n        var form = self.getFormContainer();\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n        var controls = /^cascadingcombo$/i.test(renderType) ? form.getRenderByType(properties.type) : [];\r\n\r\n        var i = 0;\r\n        var j = 0;\r\n        var parents = [];\r\n\r\n        var control = null;\r\n\r\n        for (; i < controls.length; i++) {\r\n            if (properties.parentCombo === controls[i].properties.id) {\r\n                parents.push({control: controls[i], index: i});\r\n            }\r\n        }\r\n\r\n        if (parents.length > 1) {\r\n            var parentLength, parent, xpathParent, parentArray;\r\n\r\n            for (; j < parents.length; j++) {\r\n                parent = parents[j].control;\r\n                xpathParent = parent.properties.xpath;\r\n                parentArray = xpathParent.split(\".\");\r\n                parentLength = parentArray.length;\r\n                xpathParent = parentArray.slice(0, parentLength - 1).join(\".\");\r\n\r\n                if (xpathParent === properties.xpath) {\r\n                    control = controls[parents[j].index];\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            control = form.getRenderById(properties.parentCombo);\r\n        }\r\n\r\n        // Return parent combo\r\n        return control;\r\n    },\r\n\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this;\r\n\r\n        // If the render has dependants we can't send to the server\r\n        return self._super() && bizagi.util.isMapEmpty(self.dependants);\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        var mode = this.getMode();\r\n\r\n        if (mode != \"execution\") return true;\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n\r\n        if (!self.configured) {\r\n            // Call super\r\n            self._super();\r\n            self.configured = true;\r\n        }\r\n    },\r\n\r\n    internalSubmitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (self.isDependant && self.canBeSent() && self.itemSelected !== undefined)\r\n            return self._super(data, bRefreshForm);\r\n        return defer.resolve();\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        // Call original method\r\n        self._super();\r\n\r\n        if (self.value && self.isDependant == false) {\r\n            self.internalSetInitialValueFlag = true;\r\n            self.trigger(\"select\", [self.value, true]);\r\n        }\r\n\r\n        self.internalSetInitialValueFlag = false;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render List Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for list renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.list\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {      \r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.listSize = properties.listSize || 0;\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render can be overriden in subclasses\r\n     * to reuse logic and just change the template\r\n     * @returns {} \r\n     */\r\n    getTemplateName: function() {\r\n        return \"list\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs\r\n     * to data or not Can be overriden to change behaviour    \r\n     * @returns {} \r\n     */\r\n    showCurrentData: function() {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: Bizagi Render MultiSelect Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for multiselect renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.multiSelect\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var properties = this.properties;\r\n\r\n        // Go to server\r\n        self.dataService.multiaction().getData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype || null,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (data) {\r\n\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n\r\n        }).fail(function (data) {\r\n            if (data.type === \"not-processed\")\r\n                return;\r\n\r\n            // Show error from server\r\n            var auxMsg = \"\";\r\n            var form = self.getFormContainer();\r\n            var msgObj = self.properties.displayName + \": \";\r\n\r\n            if (typeof data == \"string\") {\r\n                auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n            } else {\r\n                auxMsg = data;\r\n            }\r\n\r\n            msgObj += auxMsg.message;\r\n\r\n            form.addValidationMessage(msgObj);\r\n\r\n            defer.reject(data);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        value = JSON.encode({\"value\": value});\r\n\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.value || [];\r\n    },\r\n\r\n    /**\r\n     * Get list of data\r\n     * @returns {*|Array}\r\n     */\r\n    getDataValue: function () {\r\n        var list;\r\n\r\n        try {\r\n            list = JSON.parse(this.value);\r\n\r\n            return list.value || [];\r\n        } catch (e) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {*|Array|boolean}\r\n     */\r\n    hasValue: function () {\r\n        var values = this.getDataValue();\r\n\r\n        return values && values.length > 0;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".bz-multiselect .bz-multiselect__tag:not(.bz-multiselect__plus)\", context);\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value\r\n     */\r\n    addElement: function (value) {\r\n        var newValue = this.getDataValue();\r\n\r\n        newValue.push(value);\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value\r\n     */\r\n    removeElement: function (value) {\r\n        var idToRemove = value.id;\r\n        var newValue = this.getDataValue()\r\n            .filter(function (item) {\r\n                return item.id !== idToRemove;\r\n            });\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Submit the selected data to the server in order to be saved\r\n     */\r\n    submitData: function () {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Mark a item how checked\r\n     * @param id\r\n     * @returns {*}\r\n     */\r\n    markAsChecked: function (id) {\r\n        var self = this;\r\n\r\n        return self.selected.some(function (item, index) {\r\n            var found = item.id === id;\r\n\r\n            if (found) self.selected.splice(index, 1);\r\n            return found;\r\n        });\r\n    },\r\n\r\n    isChecked: function (values, id) {\r\n        return values.some(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to verify if can add more items\r\n     * @param $tagsContainer\r\n     * @returns {boolean}\r\n     */\r\n    canAddMoreItems: function ($tagsContainer) {\r\n        var self = this;\r\n        var containerWidth = parseInt($tagsContainer.css(\"width\"));\r\n        var $children = $tagsContainer.children();\r\n\r\n        var childrenWidth = $children\r\n            .toArray()\r\n            .reduce(function (acc, child) {\r\n                acc += self.getElementWidth(child);\r\n                return acc;\r\n            }, 0);\r\n\r\n        return containerWidth > (childrenWidth + self.Class.MORE_OPTION_WIDTH)\r\n\r\n    },\r\n\r\n    /**\r\n     * getElementWidth\r\n     * @param element\r\n     * @returns {*}\r\n     */\r\n    getElementWidth: function (element) {\r\n        var styles = window.getComputedStyle(element);\r\n        var outerWidth = $(element).outerWidth();\r\n        return outerWidth + [\r\n            \"padding-left\",\r\n            \"padding-right\",\r\n            \"margin-left\",\r\n            \"margin-right\"\r\n        ].reduce(function (acc, property) {\r\n            acc += parseInt(styles[property]);\r\n            return acc;\r\n        }, 0);\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * @param query\r\n     * @param $container\r\n     */\r\n    filterList: function (query, $container) {\r\n\r\n        $container.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = query.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n    },\r\n\r\n    /**\r\n     * Find item by id\r\n     * @param id\r\n     * @returns {[]}\r\n     */\r\n    findItemById: function (id) {\r\n        return (this.properties.data || []).find(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render Search List Control\r\n*   Author: UI Forms Team\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchList\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // Set value\r\n        self.setValue(properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {} \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            allowTyping: properties.allowTyping,\r\n            items: properties.value,\r\n            hasSearchForm: properties.searchForms ? true : false,\r\n            editable: properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function() {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setValue: function(value) {\r\n        this.value = JSON.encode({ \"value\": value });\r\n        this.triggerRenderChange();\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value = { id:integer,value:[string || array] }\r\n     * @returns {} \r\n     */\r\n    addElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n\r\n        list.value.push(value);\r\n\r\n        this.setValue(list.value);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value = { id:integer }\r\n     * @returns {} \r\n     */\r\n    removeElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n        var result = [];\r\n\r\n        $.each(list.value, function(key, val) {\r\n            if (val.id != value.id) {\r\n                result.push({ id: val.id, value: val.value });\r\n            }\r\n        });\r\n\r\n        this.setValue(result);\r\n    },\r\n\r\n    /**\r\n     * Remove last element to global value\r\n     * @returns {} \r\n     */\r\n    removeLastElement: function() {\r\n        var list = JSON.parse(this.value);\r\n\r\n        if (list.value.length > 0) {\r\n            list.value.pop();\r\n            this.setValue(list.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getData: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.getSearchData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: properties.term,\r\n            extra: params\r\n        }).done(function(data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function(data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {} \r\n     */\r\n    submitData: function() {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {} \r\n     */\r\n    canBeSent: function() {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Check if the control has value\r\n     * @returns {} \r\n     */\r\n    hasValue: function() {\r\n        var list = this.getListItems();\r\n\r\n        return list.length > 0;\r\n    },\r\n\r\n    getListItems: function(){\r\n        var value = this.getValue();\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        return finalValue || [];\r\n    },\r\n    \r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Money Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for money numbers\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            var symbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol;\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol : symbol;\r\n        } else {\r\n            properties.symbol = \"\";\r\n        }\r\n\r\n        properties.groupDigits = true;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Radio Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.radio\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n\r\n        // Set a random identifier to fix a problem when using radio buttons inside grids and the plugin mismatch the elements because all of them have the same name\r\n        properties.unique = bizagi.util.randomNumber(1000, 1000000);\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render\r\n     * Can be overridden in subclasses to reuse logic and just change the template\r\n     * @returns {string}\r\n     */\r\n    getTemplateName: function () {\r\n        return \"radio\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the empty node or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs to data or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Adds custom parameters to process the template\r\n     * @returns {{vertical: boolean}}\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal,\r\n            horizontal: properties.horizontal\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n        var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Check value of control is changed\r\n     * @returns {boolean}\r\n     */\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if (value && value.length !== undefined) {\r\n            value = value[0];\r\n        }\r\n        if (compareValue && compareValue.length !== undefined) {\r\n            compareValue = compareValue[0];\r\n        }\r\n        if (baseValue && baseValue.length !== undefined) {\r\n            baseValue = baseValue[0];\r\n        }\r\n\r\n        value = value && value.id !== undefined ? value.id : value;\r\n        compareValue = compareValue && compareValue.id !== undefined ? compareValue.id : compareValue;\r\n        baseValue = baseValue && baseValue.id !== undefined ? baseValue.id : baseValue;\r\n\r\n        if (baseValue !== undefined) {\r\n            if ((baseValue == value) && (value == compareValue)) {\r\n                result = false;\r\n            } else {\r\n                if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                    result = false;\r\n                } else {\r\n                    result = (compareValue == value) ? false : true;\r\n                }\r\n            }\r\n        } else {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Render Image Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for image control\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var maxSize = 4091904;\r\n\r\n        if(properties.maxSize) {\r\n            maxSize = Number(properties.maxSize);\r\n        } else if (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\") {\r\n            maxSize = Number(BIZAGI_SETTINGS.UploadMaxFileSize);\r\n        }\r\n\r\n        properties.maxSize = maxSize;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) === true;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length != 0) {\r\n                    singleExtensions[i] = \"*.\" + singleExtensions[i].replaceAll(\" \", \"\");\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddFileUrl(properties.isUserPreference);\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null\r\n\r\n        properties.isAutoWidth = false;\r\n        properties.isAutoHeight = false;\r\n\r\n        if (properties.width === -1) {\r\n            properties.width = \"100%\";\r\n            properties.isAutoWidth = true;\r\n        } else {\r\n            properties.width = properties.width + \"px\";\r\n        }\r\n\r\n        if (properties.height === -1) {\r\n            properties.height = \"auto\";\r\n            properties.isAutoHeight = true;\r\n        } else {\r\n            properties.height = properties.height + \"px\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var def = new $.Deferred(); //design\r\n        var template = self.renderFactory.getTemplate(\"image\");        \r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = dataUrl !== \"\" ? dataUrl : \"\";\r\n                self.properties.value = self.value = self.properties.url.length > 0 ? [self.properties.url] : null;\r\n                self.setValue(self.properties.value);                \r\n\r\n                var html = $.fasttmpl(template, { url: self.properties.url });\r\n                def.resolve(html);\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"image-readonly\");\r\n        var html = $.fasttmpl(template);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * This method return the name of template of items, please make a override in each device\r\n     * @returns {*}\r\n     */\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();        \r\n        var def = new $.Deferred();\r\n        var template = self.getTemplateItem();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            var url = dataUrl || \"\";\r\n\r\n            var html = $.fasttmpl(template, {\r\n                url: url,\r\n                allowDelete: self.properties.allowDelete,\r\n                editable: self.properties.editable,\r\n                mode: mode,                \r\n            });\r\n\r\n            self.properties.url = url;\r\n            self.properties.value = url.length > 0 ? [url] : null;\r\n\r\n            def.resolve(html);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n        var url = \"\";\r\n\r\n        if (!this.isExecutionMode()) {\r\n            url = \"\"; // TODO: Review the use of \"javascript:void(0);\";\r\n            def.resolve(url);\r\n        } else {\r\n            var parameters = {\r\n                url: properties.dataUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                property: params && params.property ? params.property : \"fileContent\",\r\n                dataType: \"text\"\r\n            };\r\n\r\n            if (properties.contexttype) {\r\n                parameters.contexttype = properties.contexttype;\r\n            }\r\n\r\n            if (properties.isUserPreference) {\r\n                self.currentUser = bizagi.currentUser.idUser;\r\n                parameters.xpathContext = \"@Context.Users[id == \" + self.currentUser + \"]\";\r\n                parameters.contexttype = \"entity\";\r\n                parameters.surrogatekey = self.currentUser;\r\n            }\r\n\r\n            self.dataService.multiaction().getPropertyData(parameters, \"text\")\r\n                .done(function (data) {\r\n                    if (data.charAt(0) === \"\\\"\") {\r\n                        data = data.slice(1, -1);\r\n                    }\r\n\r\n                    if (data !== \"\") {\r\n                        url = \"data:image/png;base64,\" + data;\r\n                    }\r\n\r\n                    def.resolve(url);\r\n                });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    buildItemUrlOffline: function(parameters){\r\n        var def = new $.Deferred();\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getFormParams();\r\n        var parameters = {\r\n            idCase: formParams.idCase,\r\n            idWorkitem: formParams.idWorkitem,\r\n            id: properties.xpath,\r\n            offlineType: formParams.offlineType\r\n        }\r\n        $.when(self.dataService.getOfflineImage(parameters, \"base64\"))\r\n        .done( function(imageValue){\r\n            properties.value = imageValue;\r\n            def.resolve(bizagi.util.getDataUrl(properties));\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param path File in Browser or Path in Mobile Devices\r\n     * @param promise Promise to be resolved when save is completed\r\n     */\r\n    saveImageOffline: function (path, promise) {\r\n        var self = this;        \r\n        var blobPromise = new $.Deferred();\r\n\r\n        if(self.isNative){\r\n            var fileName = self.fileProperties.name;            \r\n            if (!bizagi.util.isAndroidDevice()) {\r\n                path = bizagi.util.media.normalizeIOSFilePath(path);\r\n            }\r\n            else{\r\n                // Fix android 4.4 getting images from recent folder\r\n                path = bizagi.util.media.getImagePath(path);\r\n            }\r\n            \r\n            var errorHandler = function (error) {\r\n                bizagi.log('error converting path to blob', error);  \r\n                blobPromise.reject(error);\r\n            };\r\n    \r\n            window.resolveLocalFileSystemURL(path, function (fileEntry) {\r\n                fileEntry.file(function (file) {    \r\n                    var reader = new FileReader();\r\n                    reader.onloadend = function () {\r\n                        var blob = new Blob([this.result], {type: file.type});\r\n                        blob.name = fileName;\r\n                        blobPromise.resolve(blob);\r\n                    }    \r\n                    reader.readAsArrayBuffer(file);\r\n                }, errorHandler);\r\n            }, errorHandler);\r\n        }\r\n        else {\r\n            blobPromise.resolve(path);\r\n        }        \r\n\r\n        $.when(blobPromise)\r\n        .done( function(blobImage) {\r\n            // Save the image as attachment \r\n            var formParams = self.getFormParams();\r\n            var parameters = {\r\n                idCase: formParams.idCase,\r\n                idWorkitem: formParams.idWorkitem,\r\n                id: self.properties.xpath,\r\n                operationType: \"edition\",\r\n                offlineType: formParams.offlineType\r\n            }\r\n\r\n            $.when(self.dataService.saveOfflineImage(parameters, blobImage))\r\n            .done( function() {\r\n                promise.resolve();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url in real size\r\n     * @returns {*}\r\n     */\r\n    buildFullItemUrl: function () {\r\n        var def = new $.Deferred();\r\n\r\n        $.when(this.buildItemUrl({\"property\": \"fileFullContent\"}))\r\n            .done(function (dataUrl) {\r\n                def.resolve(dataUrl);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        // Call base\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.properties.value || [];\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.visible) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Don't check non- editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (self.properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (!newRow) {\r\n                var value = self.getValue();\r\n\r\n                if (value.length === 0) {\r\n                    var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({ xpath: self.properties.xpath, message: message });\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = self.getUploadXpath();\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = properties.id;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = properties.xpathContext;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = 'savefile';\r\n\r\n        if (properties.contexttype) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contexttype;\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId;\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var $control = this.getControl();\r\n        $control.empty();\r\n    }\r\n});","/*\r\n*   Name: BizAgi User field render\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behavior for userfields\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldDefinition\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* Private section of the userfield                          */\r\n    /*************************************************************/\r\n\r\n    /*\r\n    *   Method to be overriden by userfields in order to ensure that custom files are loaded before the execution\r\n    */\r\n    getFileDependencies: function () {\r\n        return null;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var defer = $.Deferred();\r\n        var fileDependencies = self.getFileDependencies();\r\n        if (fileDependencies && fileDependencies.length > 0) {\r\n            bizagi.loader.loadFile(fileDependencies)\r\n\t\t\t.then(function () {\r\n\t\t\t    // After all dependencies has been resolved\r\n\t\t\t    self.internalRenderControl();\r\n\t\t\t    defer.resolve();\r\n\t\t\t});\r\n\r\n        } else {\r\n            $.when( self.renderUserfieldControl()).done(function () {\r\n                defer.resolve();\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    renderUserfieldControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n\r\n        var loadUserfield = function () {\r\n            var userEditableControl = self.getEditableControl();\r\n            if (userEditableControl) {\r\n                self.input = control.html(userEditableControl);\r\n            }\r\n            self.renderComplex();\r\n            def.resolve();\r\n        };\r\n\r\n        \r\n            loadUserfield();\r\n    \r\n        \r\n        return def.promise();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n        var loadUserfieldReadOnly = function () {\r\n            try {\r\n                var userReadOnlyControl = self.getReadonlyControl();\r\n                if (userReadOnlyControl) {\r\n                    self.input = control.html(userReadOnlyControl);\r\n                }                                                 \r\n                self.renderComplex();\r\n                \r\n            } catch (error) {\r\n                var displayName = self.properties.displayName || \"Widget\";\r\n                control.html(\"<h6>\" + displayName  + \"</h6>\")\r\n            }\r\n            \r\n        };\r\n\r\n        if (self.ready) {\r\n            self.ready().done(function () {\r\n                loadUserfieldReadOnly();\r\n            });\r\n        } else {\r\n            loadUserfieldReadOnly();\r\n        }\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return self.getReadonlyValue();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control \r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n\r\n        // Set editable value in control\r\n        self.setEditableValue(value);\r\n    },\r\n\r\n    getValue: function () {\r\n        var self = this;\r\n        return self.getEditableValue();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type == \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderElements: function (xpath) {\r\n        var self = this;\r\n        var result = $();\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        $.each(controls, function (i, item) {\r\n            result = result.add($(item.element));\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getServerResourceURL: function (resource) {\r\n        var self = this;\r\n        var url = \"Rest/Userfields/{0}/resource/{1}/{2}\";\r\n        url = url.replace(\"{0}\", self.properties.userfieldGuid);\r\n        resource = resource.replace(\"\\\\\", \"__\").replace(\"/\", \"__\");\r\n        var device = bizagi.util.detectDevice();\r\n        url = url.replace(\"{1}\", device);\r\n        url = url.replace(\"{2}\", resource);\r\n        //Rest/Userfields/{0}/resource/desktop/{1}\r\n        return url;\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderValue: function (xpath) {\r\n        var self = this;\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        var control;\r\n        $.each(controls, function (index, item) {\r\n            if (!control || item.properties.editable) {\r\n                control = item;\r\n            }\r\n        });\r\n        if (control) {\r\n            return control.getValue();\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n    /*\r\n    * Shows a jquery dialog\r\n    */\r\n    showDialog: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showDialog method\");\r\n    },\r\n\r\n    /*\r\n    *   Shows a browser popup\r\n    */\r\n    showPopup: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showPopup method\");\r\n    },\r\n\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value = self.properties.value;\r\n    }\r\n\r\n\r\n});\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* methods to be overriden by the implementations            */\r\n    /*************************************************************/\r\n    getEditableControl: function () {\r\n    },\r\n\r\n    renderComplex: function () {\r\n    },\r\n\r\n    // Returns the value of the control\r\n    getEditableValue: function () {\r\n        return bizagi.rendering.render.prototype.getValue.apply(this, arguments);\r\n    },\r\n\r\n    // \r\n    setEditableValue: function (value) {\r\n        return bizagi.rendering.render.prototype.setValue.apply(this, arguments);\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n    },\r\n\r\n    getReadonlyValue: function () {\r\n        // if the method is not overriden then call the parent method \r\n        return bizagi.rendering.render.prototype.getDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n\r\n});\r\n\r\n/*\r\n*   This control will wrap any userfield in order to load the code remotely, \r\n*   when executing renderControl, which is an async method\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldWrapper\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n        // Save userfield guid and name\r\n        self.initialParams = params;\r\n        self.userfieldGuid = this.properties.userfieldGuid;\r\n        self.userfieldName = this.properties.control;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    internalPostRender: function () {\r\n        var self = this;\r\n        $.when(self.getUserfieldControl())\r\n        .done(function (control) {\r\n            control.element = self.element;\r\n\r\n            // Add grid and surrogatekey properties if the userfield is a column userfield\r\n            if (self.column) {\r\n                control.isColumn = true;\r\n                control.grid = self.grid;\r\n                control.surrogateKey = self.surrogateKey;\r\n                control.properties.xpathContext = self.getControlXpathContext(control);\r\n                control.getControl = self.column.getControl;\r\n            }\r\n\r\n            return control.internalPostRender();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Helper for userfields to fetch the xpathContext\r\n    */\r\n    getControlXpathContext: function (control) {\r\n        var self = this;\r\n        var properties = control.properties;\r\n\r\n        if (control.isColumn) {\r\n            return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\" : control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\";\r\n        }\r\n\r\n        return properties.xpathContext;\r\n    },\r\n\r\n\r\n    getUserFieldInstance: function(params){\r\n        console.log(\"not implemented\");\r\n    },\r\n\r\n    /*\r\n    *   Replicate all userfield methods to this instance in order to create a proxy\r\n    */\r\n    replicateUserfieldMethods: function (control) {\r\n        var self = this;\r\n        for (var key in control.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"subscribe\" || key == \"unsubscribe\" ||\r\n                key == \"publish\" || key == \"render\" || key == \"triggerHandler\" || key == \"dispose\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ if (this.userfieldInstance) return this.userfieldInstance.' + key + '.apply(this.userfieldInstance, arguments); return null;};tmp');\r\n        }\r\n\r\n        // Replicate properties and value\r\n        control.properties = self.properties;\r\n        control.value = self.value;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.userfieldInstance) {\r\n                self.userfieldInstance.unbind(\"renderchange\");\r\n                self.userfieldInstance.dispose();\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Render Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Columns\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.columns.column\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.decoratedClass = params.decorated;\r\n        this.data = params.data;\r\n        if (params.singleInstance) {\r\n            this.decorated = new this.decoratedClass({\r\n                data: this.data,\r\n                parent: this.parent,\r\n                renderFactory: this.renderFactory,\r\n                dataService: this.dataService\r\n            });\r\n            this.decorated.getControl = this.getControl;\r\n            params.decorated = this.decorated;\r\n            this.decorated.properties.isColumn = true;\r\n        } else {\r\n            this.decorateRenders = [];\r\n        }\r\n        this.grid = params.parent;\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.columnVisible = bizagi.util.parseBoolean(properties.columnVisible) != null ? bizagi.util.parseBoolean(properties.columnVisible) : true;\r\n        properties.align = properties.align || 'center';\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.singleInstance = params.singleInstance;\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.showColumn = (typeof properties.showColumn != \"undefined\") ? bizagi.util.parseBoolean(properties.showColumn) : true;\r\n\r\n        // Define if it is editable or not        \r\n        try {\r\n            if (params.parent && typeof params.parent.properties.editable == \"boolean\" && !params.parent.properties.editable) {\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n        // Define if the column is readonly\r\n        this.readonly = properties.readonly !== undefined ? properties.readonly : false;\r\n        if (this.readonly) properties.editable = required = false;\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to retrieve the decorated control\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        return $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n    },\r\n    /*\r\n    *   Returns the decorated cell instance to use\r\n    */\r\n    getDecorated: function (surrogateKey) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.singleInstance) {\r\n            return self.decorated;\r\n        }\r\n        else {\r\n            var decorated = self.decorateRenders[surrogateKey];\r\n            if (decorated == undefined) {\r\n                if (typeof self.decorateRenders != \"object\") {\r\n                    self.decorateRenders = [];\r\n                }\r\n                var instanceDecoratedClass = new this.decoratedClass({\r\n                    data: bizagi.clone(this.data),\r\n                    parent: this.parent,\r\n                    renderFactory: this.renderFactory,\r\n                    dataService: this.dataService\r\n                });\r\n                decorated = instanceDecoratedClass;\r\n                self.decorateRenders[surrogateKey] = instanceDecoratedClass;\r\n\r\n                // Set surrogate key to all controls\r\n                decorated.surrogateKey = surrogateKey;\r\n\r\n                // Execute decorated overrides\r\n                self.applyOverrides(decorated);\r\n\r\n                // Also override setDisplayValue on summary row for non numeric columns\r\n                if (surrogateKey == \"summary\" && decorated.properties.type != \"columnMoney\" && decorated.properties.type != \"columnNumber\") {\r\n\r\n                    decorated.setDisplayValue = function (value) {\r\n                        var control = this.getControl();\r\n\r\n                        // Replace line breaks for html line breaks\r\n                        control.html(value);\r\n                    };\r\n                }\r\n            }\r\n            return decorated;\r\n        }\r\n    },\r\n    /*\r\n    *   Set a ready function to execute when the render has been inserted in the dom\r\n    */\r\n    ready: function () {\r\n        return this.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Load stuff needed for the column\r\n    *   It could return a promise if the column need to load async stuff\r\n    */\r\n    initialize: function () {\r\n        // Override to do any stuff needed here\r\n    },\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function (surrogateKey, cellOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (cellOverrides) {\r\n            decorated.properties.visible = cellOverrides.visible;\r\n            decorated.properties.editable = cellOverrides.editable;\r\n        }\r\n        return decorated.canBeSent() || (!self.properties.editable && self.hasChanged()) || (!decorated.properties.editable && self.hasChanged());\r\n    },\r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function (surrogateKey, value, messages, propertyOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var invalidElements = [];\r\n\r\n        if (propertyOverrides.visible) {\r\n            self.setValue(surrogateKey, value);\r\n\r\n            // Override properties\r\n            decorated.properties = $.extend(decorated.properties, propertyOverrides);\r\n\r\n            if (self.grid && typeof(decorated.grid) === \"undefined\") {\r\n                decorated.grid = self.grid;\r\n            }\r\n\r\n            // Validate field\r\n            decorated.isValid(invalidElements);\r\n        }\r\n\r\n        if (invalidElements.length > 0) {\r\n            $.each(invalidElements, function (i, invalidElement) {\r\n                messages.push(invalidElement.message);\r\n            });\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        //Fix: Uncaught RangeError: Maximum call stack size exceeded\r\n        if (!properties.editable && arguments[3] !== \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\")\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.postRenderElement(cell);\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Changes editable to false to render read-only\r\n        decorated.properties.editable = false;\r\n\r\n        // Perform the internal render\r\n        self.readyDeferred = new $.Deferred();\r\n        var result = decorated.render(\"cell.readonly\");\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *  Returns the html template to draw the summary cell\r\n    */\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        var result = self.renderFactory.getTemplate(\"cell.summary\")\r\n        return $.tmpl(result).html();\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var editable = self.properties.editable;\r\n        decorated.properties.editable = false;\r\n        if (self.properties.singleInstance) {\r\n            decorated.element = cell;\r\n        }\r\n        decorated.postRenderElement(cell);\r\n        decorated.properties.editable = editable;\r\n    },\r\n\r\n    /*\r\n    * Return false to all columns that doesn't need special treatment (like number or currency)\r\n    */\r\n    postRenderSummary: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    getCell: function () {\r\n        return this.decorated.getDisplayValue();\r\n    },\r\n    /*\r\n    *   Sets the surrogate key for this row\r\n    */\r\n    setSurrogateKey: function (key) {\r\n        this.surrogateKey = key;\r\n    },\r\n    /*\r\n    *   Sets the internal value, only must be called internally\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n            if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    },\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        return decorated.getValue();\r\n    },\r\n    /*\r\n    *   Gets the composite value (applies for non-standard render values)\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        return this.getValue(surrogateKey);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_COLUMN;\r\n    },\r\n    /*\r\n    *   Determines if a render has changed its value\r\n    */\r\n    hasChanged: function () {\r\n        return this.changed;\r\n    },\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.trigger(eventType, data);\r\n    },\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.triggerHandler(eventType, data);\r\n    },\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.bind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Unbinds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.unbind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Override decorated properties\r\n    */\r\n    overrideDecoratedRenderProperties: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Override decorated control properties\r\n        decorated.properties.editable = this.properties.editable;\r\n        decorated.properties.visible = this.properties.visible;\r\n        decorated.properties.required = this.properties.required;\r\n    },\r\n\r\n    overrideProperties: function (properties) {\r\n        var self = this;\r\n\r\n        self.properties.editable = properties.editable || self.properties.editable;\r\n        self.properties.visible = properties.visible || self.properties.visible;\r\n        self.properties.required = properties.required || self.properties.required;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath used to sort the grid\r\n    */\r\n    getSortName: function () {\r\n        var self = this;\r\n\r\n        // Check if there is an override for the default behaviour \r\n        var decorated = self.getAnyDecoratedInstance();\r\n        if (decorated && decorated.getSortColumn) {\r\n            return decorated.getSortColumn();\r\n        }\r\n\r\n        // Default behaviour\r\n        return self.properties.xpath;\r\n    },\r\n\r\n    /*\r\n    *   Returns any of the decorated instances, if there are none, return null\r\n    */\r\n    getAnyDecoratedInstance: function () {\r\n        var self = this;\r\n        var first;\r\n\r\n        // Get the first key for the hash\r\n        for (first in this.decorateRenders) break;\r\n\r\n        // Return the first decorated render\r\n        if (first) return this.decorateRenders[first];\r\n\r\n        return null;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.decorated) {\r\n                self.decorated.unbind(\"renderchange\");\r\n                self.decorated.dispose();\r\n            }\r\n        \r\n            if (self.decorateRenders) {\r\n                bizagi.util.arrayEach(self.decorateRenders, function (key, render) {\r\n                    if (render) {\r\n                        render.unbind(\"renderchange\");\r\n                        render.dispose();\r\n                    }\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n        \r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Render Column ReadOnlyDecorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for readonly-columns\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.columns.readonly\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        // Define the column as readonly\r\n        properties.editable = required = false;\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        if (typeof value === \"string\") {\r\n            var valueToDisplay = value.replaceAll(\"\\\\n\", \"<br/>\");\r\n            valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n            return valueToDisplay;\r\n        }\r\n        else if (value === null){\r\n            return \"\";\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        return this.render(surrogateKey, value);\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n    \r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function () {\r\n        // It is always valid because the column is readonly\r\n        return true;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.recalculate = bizagi.util.parseBoolean(properties.recalculate) || false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var properties = this.properties;\r\n\r\n        this._super(decorated);\r\n\r\n        if (!properties.recalculate) {\r\n            decorated.originalGetData = decorated.getData;\r\n            decorated.getData = this.getDataForAllCells;\r\n            decorated.findDataById = this.findDataById;\r\n        }\r\n    },\r\n\r\n    findDataById: function (id) {\r\n        var self = this;\r\n        var result = {};\r\n        if (this.column && this.column.comboData) {\r\n            $.each(this.column.comboData, function (key, value) {\r\n                if (value.id == id) {\r\n                    result = value;\r\n                }\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Single data fetch for all the cells\r\n    */\r\n    getDataForAllCells: function (params) {\r\n        var column = this.column;\r\n        if (column.comboData) return column.comboData;\r\n        if (column.fetchingData) return column.dataPromise;\r\n\r\n        // Start fetching\r\n        column.fetchingData = true;\r\n        column.dataPromise = $.when(this.originalGetData(params))\r\n        .pipe(function (result) {\r\n            column.comboData = result;\r\n            column.fetchingData = false;\r\n            return result;\r\n        });\r\n\r\n        return column.dataPromise;\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function(surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && bizagi.util.isString(value)) {        \r\n            self._super(surrogateKey, value);\r\n        } else if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function(item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (self.properties.type == \"columnRadio\") {\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = value;\r\n        } else if (value && typeof (value) == \"number\") {\r\n            self._super(surrogateKey, value);\r\n        } else {\r\n            // Set null values when the entry array is null\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        var label = decorated.getSelectedValue();\r\n\r\n        // Build value for grid data\r\n        var valueForGrid = [];\r\n        if (value && (value.id > 0 || bizagi.util.isString(value.id))) {\r\n            valueForGrid.push([]);\r\n            valueForGrid[0].push(value.id);\r\n            valueForGrid[0].push(label);\r\n        } else {\r\n            valueForGrid.push([]);\r\n        }\r\n\r\n        return valueForGrid;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value) return value.id;\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    renderReadOnly: function (key, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(key);\r\n        var properties = self.properties;\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + key + \"]\" : self.grid.properties.xpath + \"[id=\" + key + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(key, value);\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Date Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Date Columns\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) return;\r\n\r\n        self._super(surrogateKey, value);\r\n        if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined) {\r\n            value = self.setDefaultValue(surrogateKey, decorated);\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey === \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value == null) {\r\n            decorated.setValue(value, false);\r\n            decorated.properties.displayValue = \"\";\r\n        }\r\n\r\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime);\r\n\r\n        if (date === 0) {\r\n            // force another attempt in order to check invariant format for the value with time or without time (reverse option)\r\n            date = bizagi.util.dateFormatter.getDateFromInvariant(value, !decorated.properties.showTime);\r\n        }\r\n        // Format date to current format\r\n        if (date !== 0) {\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            var formattedDate = bizagi.util.dateFormatter.formatDate(date, decorated.properties.fullFormat, datePickerRegional);\r\n\r\n            // Set formatted value in display value property\r\n            decorated.properties.displayValue = formattedDate;\r\n\r\n            // Send original value to decorated control, because it must be with invariant format\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n\r\n        value = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime || false);\r\n\r\n        value = bizagi.util.dateFormatter.formatInvariant(value, true);\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.search\", {}, {\r\n\r\n\t/*\r\n\t*   Constructor\r\n\t*/\r\n\tinit: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        if (properties.advancedSearch && this.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n\t/*\r\n\t*   Returns the in-memory processed element \r\n\t*   so the caller could append it to any place\r\n\t*/\r\n\trender: function (surrogateKey, value, tableCell) {\r\n\t\tvar self = this;\r\n\t\tvar decorated = self.getDecorated(surrogateKey);\r\n\t\tvar properties = self.properties;\r\n\r\n\t\t// If the control needs to recalculate data, reset it on the decorated render\r\n\t\tif (properties.recalculate) {\r\n\t\t\tdecorated.resetData();\r\n\t\t}\r\n\r\n\t\t// Change the xpath context\r\n\t\tvar xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n\t\t// Render the control\r\n\t\tvar result = this._super(surrogateKey, value, tableCell);\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n    \tvar decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value && typeof(value) == \"object\" ) return value.id;\r\n        \t\r\n    \treturn value;\r\n    },\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) { return; }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function (item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if(value && value.id && value.label){\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.label;\r\n        }\r\n        else{\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Document Generator\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for document generator render\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.document\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var properties = this.properties;\r\n\r\n        properties.validate = bizagi.util.parseBoolean(properties.validate) != null ? bizagi.util.parseBoolean(properties.validate) : false;\r\n        properties.downloadalldocuments = properties.downloadalldocuments ? properties.downloadalldocuments : false;\r\n        properties.allowGenerate = properties.allowGenerate !== undefined ? properties.allowGenerate : true;\r\n        properties.append = properties.append ? properties.append : false;\r\n\r\n        if (properties.caption) {\r\n            properties.caption = bizagi.util.trim(properties.caption);\r\n\r\n            if (properties.caption.length === 0) {\r\n                properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n            }\r\n        } else {\r\n            properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n\r\n        self.preRenderControl();\r\n\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var downloadAllDocuments = properties.downloadalldocuments;\r\n        var allowGenerate = properties.allowGenerate;\r\n        var template = self.renderFactory.getTemplate(self.getTemplate());\r\n        var documents = properties.value || [];\r\n        var noFiles = documents ? (documents.length === 0) : true;\r\n\r\n        // Render template\r\n        var html = self.getControlHtml(template, mode, downloadAllDocuments, allowGenerate, properties, noFiles);\r\n\r\n        // Render current children\r\n        var items = this.renderDocumentsHtml(documents);\r\n        items += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadAllDocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*|jQuery}\r\n     */\r\n    getControlHtml: function (template, mode, downloadAllDocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n\r\n        return $.fasttmpl(template, {\r\n            noActivateButton: false,\r\n            editable: mode !== \"execution\",\r\n            mode: mode,\r\n            downloadalldocuments: downloadAllDocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {boolean}\r\n     */\r\n    activateButton: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    },\r\n\r\n    /**\r\n     * Renders a single document item\r\n     * @param file\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderDocumentItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            editable: self.properties.editable,\r\n            joined: false\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: self.getSessionId()\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the download all items item url\r\n     * @returns {*}\r\n     */\r\n    buildAllDocumentsUrl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var returnLink = self.dataService.getAllDocumentsDownloadUrl({\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            idCase: properties.caseId,\r\n            idWorkItem: properties.workitemId,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n        return returnLink;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @returns {string}\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        return \"<div></div>\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode !== \"design\") {\r\n            var control = self.getControl();\r\n            var htmlControl = self.renderControl();\r\n\r\n            control.append(htmlControl);\r\n\r\n            self.updateControlForPrintMode(control);\r\n\r\n            // Execute the same as post-render\r\n            self.postRender();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    validateContainer: function () {\r\n        // Check if the form is valid, then generate\r\n        var form = this.getFormContainer();\r\n        return form.validateForm();\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    save: function () {\r\n        var form = this.getFormContainer();\r\n\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{actions}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceActionsHtml: function (html, replace) {\r\n        return html.replace(\"{{actions}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && !properties.buttonExecuted) {\r\n            if (self.value) {\r\n                if (self.value.length > 0) return true;\r\n                message = self.getResource(\"render-document-required-text\");\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Attach handler\r\n        var generateLink = $(\".ui-bizagi-button-documentgenerator\", control);\r\n        if (mode === \"execution\") {\r\n            generateLink.click(function (e) {\r\n                if (e.isPropagationStopped()) return;\r\n                e.stopPropagation();\r\n\r\n                self.properties.buttonExecuted = true;\r\n\r\n                if (self.properties.validate) {\r\n                    // Check if the form is valid, then generate\r\n                    var isValid = self.validateContainer();\r\n                    if (isValid) {\r\n                        self.documentTemplateGenerate();\r\n                    }\r\n                } else {\r\n                    // Just generate the form\r\n                    self.documentTemplateGenerate();\r\n                }\r\n\r\n                self.properties.buttonExecuted = false;\r\n            });\r\n        }\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-document-preview\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.showDocumentPreview($(this).data(\"url\"), $(this).data(\"filename\"));\r\n        });\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-container-documents-item-delete\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.deleteDocumentTemplate($(this).data(\"filename\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var params = {\r\n            xpath: self.properties.xpath + \"[fileName='\" + filename + \"']\",\r\n            idRender: self.properties.id,\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.dataService.deleteUploadFile(params))\r\n            .done(function () {\r\n                $.when(self.dataService.multiaction().getPropertyData({\r\n                    xpath: self.properties.xpath,\r\n                    idRender: self.properties.id,\r\n                    xpathContext: self.getContextXpath(),\r\n                    idPageCache: self.properties.idPageCache,\r\n                    property: \"value\"\r\n                })).done(function (documents) {\r\n                    self.resolveDeleteDocumentTemplate(documents, false, self.properties.downloadalldocuments);\r\n\r\n                    // Finish loading\r\n                    self.endLoading();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.startLoading();\r\n\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        self.save().done(function () {\r\n\r\n            bizagi.showErrorAlertDialog = false;\r\n\r\n            $.when(self.dataService.generateDocumentTemplate(properties))\r\n                .done(function () {\r\n\r\n                    // Fetch again the value property\r\n                    $.when(self.dataService.multiaction().getPropertyData({\r\n                        xpath: properties.xpath,\r\n                        idRender: properties.id,\r\n                        xpathContext: self.getContextXpath(),\r\n                        idPageCache: properties.idPageCache,\r\n                        property: \"value\"\r\n                    })).done(function (documents) {\r\n                        self.resolveDocumentTemplateGenerate(documents, false, properties.downloadalldocuments);\r\n\r\n                        // Finish loading\r\n                        self.endLoading();\r\n                    });\r\n\r\n                }).fail(function (error) {\r\n                self.endLoading();\r\n\r\n                // Add error messages\r\n                self.showErrorMessage(error);\r\n            });\r\n        }).fail(function (message) {\r\n            self.endLoading();\r\n\r\n            // Add error messages\r\n            self.showErrorMessage(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show the error message when something went wrong with the service.\r\n     * @param error\r\n     */\r\n    showErrorMessage: function (error) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var messageText = self.resources.getResource('render-upload-alert-maxsize').replace(\"{0}\", BIZAGI_SETTINGS.UploadMaxFileSize);\r\n\r\n        try {\r\n            messageText = error && typeof (error.responseText) !== \"undefined\" ? JSON.parse(error.responseText).message : error;\r\n        } catch (e) {\r\n        }\r\n\r\n        form.addErrorMessage(messageText);\r\n        form.endLoading();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set. (virtual Function)\r\n     */\r\n    autoOpenDocuments: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n    },\r\n\r\n    /**\r\n     * Identifies the extension of the file in a simpler way that ECM does\r\n     * @param file\r\n     * @returns {string}\r\n     */\r\n    returnCssTypeFile: function (file) {\r\n\r\n        if (file == undefined || file.lenght === 0) {\r\n            return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n\r\n        var extension = file.substr((file.lastIndexOf('.') + 1));\r\n\r\n        switch (extension) {\r\n            case 'docx':\r\n                return \"ui-bizagi-document-upload-item-doc\";\r\n            case 'pdf':\r\n                return \"ui-bizagi-document-upload-item-pdf\";\r\n            case 'xlsx':\r\n                return \"ui-bizagi-document-upload-item-xls\";\r\n            default:\r\n                return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadAllDocuments) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var html = \"\";\r\n        var documentContainer = $(\"[data-component='files']\", control);\r\n\r\n        // Clear current links\r\n        documentContainer.empty();\r\n\r\n        // Draw links again\r\n        html += this.renderDocumentsHtml(documents);\r\n\r\n        // Check if there are documents and the flag to download all are available to show the link.\r\n        html += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        documentContainer.append(html);\r\n\r\n        //Set value\r\n        self.setValue(documents);\r\n    },\r\n\r\n    /**\r\n     * This method must be implemented by the specific class of each device. (Virtual method)\r\n     * @param file\r\n     * @returns {*|*|*}\r\n     */\r\n    renderAllDocumentDownload: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildAllDocumentsUrl();\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            joined: true\r\n        });\r\n\r\n        return self.removeDeleteButton(html);\r\n    },\r\n\r\n    /**\r\n     * removeDeleteButton\r\n     * @param html\r\n     * @returns {*}\r\n     */\r\n    removeDeleteButton: function (html) {\r\n        var startIndex = html.indexOf(\"<span class=\\\"ui-bizagi-container-documents-item-delete\");\r\n\r\n        if (startIndex > 0) {\r\n            var restOfWord = html.substring(startIndex);\r\n            var finishIndex = restOfWord.indexOf(\"</span>\") + 7;\r\n\r\n            return html.substring(0, startIndex) + restOfWord.substring(finishIndex);\r\n        } else {\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process request of DeleteDocumentTemplate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDocumentTemplateGenerate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.autoOpenDocuments();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Process request of DocumentTemplateGenerate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDeleteDocumentTemplate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Method to renders the documents\r\n     * @param documents\r\n     * @returns {string}\r\n     */\r\n    renderDocumentsHtml: function (documents) {\r\n        var items = \"\";\r\n\r\n        for (var i = 0; i < documents.length; i++) {\r\n            var document = {id: documents[i][0], fileName: documents[i][1]};\r\n            var item = this.renderDocumentItem(document);\r\n\r\n            items += item;\r\n        }\r\n\r\n        return items;\r\n    },\r\n\r\n    /**\r\n     * Methos to renders action of document\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     * @returns {string}\r\n     */\r\n    renderActionsHtml: function (documents, noFiles, downloadAllDocuments) {\r\n        var actions = \"\";\r\n\r\n        if (downloadAllDocuments && (!noFiles && documents.length > 0)) {\r\n            var downloadAllDocumentsLink = {fileName: this.getResource(\"render-document-downloadalldocuments\")};\r\n            var action = this.renderAllDocumentDownload(downloadAllDocumentsLink);\r\n\r\n            actions += action;\r\n        }\r\n\r\n        return actions;\r\n    },\r\n\r\n    getTemplate: function () {\r\n        return \"document\";\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-item\";\r\n    },\r\n\r\n    getErrorTemplate: function () {\r\n        return \"form-error\";\r\n    },\r\n\r\n    getTemplateDownload: function () {\r\n        return \"document-download\";\r\n    },\r\n\r\n    getTemplateReadonly: function () {\r\n        return \"document-readonly\";\r\n    }\r\n\r\n});","/**\r\n * Base definition of a range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.range\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function() {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        template = self.renderFactory.getTemplate(\"render-range\");\r\n        html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n    /**\r\n     * Sets the range controls in DOM\r\n     * @param minControl: min range control\r\n     * @param maxControl: max range control\r\n     */\r\n    setRanageControls: function (minControl, maxControl){\r\n        var self = this;\r\n        self.minControl = minControl || null;\r\n        self.maxControl = maxControl || null;\r\n        var control = self.getControl();\r\n\r\n        var $maxCanvas = $(\".bz-range-maximum\", control);\r\n        var $minCanvas = $(\".bz-range-minimum\", control);\r\n\r\n        //var $maxCanvas = $('<div>hola</div>');\r\n        //var $minCanvas = $('<div>hola</div>');\r\n\r\n        self.renderRangeControl($minCanvas, minControl);\r\n        self.renderRangeControl($maxCanvas, maxControl);\r\n    },\r\n\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        var self = this;\r\n        var minValue = self.minControl.getValue();\r\n        var maxValue = self.maxControl.getValue();\r\n\r\n        var value = {\r\n            min: minValue,\r\n            max: maxValue\r\n        };\r\n        return value;\r\n    },\r\n\r\n    renderRangeControl: function ($canvas, control){\r\n        $.when(control.render(\"render\")).done(function (html) {\r\n            $canvas.empty().append(html);\r\n            control.postRenderElement($canvas);\r\n        });\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Defines de min date an de max date to the range control\r\n     */\r\n    defineRangeControl: function (params) {\r\n        var self = this;\r\n\r\n        var dateMin = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var dateMax = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n\r\n        var minControl = new dateMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new dateMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n    getRenderProperties: function (typeRangeControl) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        if (typeRangeControl === \"min\") {\r\n            renderProperties.data.properties.displayName = \"From\";\r\n        } else {\r\n            renderProperties.data.properties.displayName = \"To\";\r\n        }\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n    \r\n    /**\r\n     * Defines de min money an de max money to the range control\r\n     */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var moneyMin = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var moneyMax = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new moneyMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new moneyMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n $.Class.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n    /**\r\n    * Defines de min number an de max number to the range control\r\n    */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var numberMin = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var numberMax = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new numberMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new numberMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Form Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.form.extend(\"bizagi.rendering.form\", {\r\n\r\n    init: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed   \r\n     */\r\n    postRenderContainer: function(container) {\r\n        var self = this;\r\n\r\n        self._super(container);\r\n\r\n        //Set button length\r\n        var buttons = self.getButtons();\r\n        var lengthButtons = (buttons) ? buttons.length : 0;\r\n\r\n        if (lengthButtons) {\r\n\r\n            $(document).data(\"auto-save\", \"auto-save\");\r\n\r\n            //bind event auto-save\r\n            $(document).unbind(\"save-form\").bind(\"save-form\", function(e, deferredSave) {\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            $(window).unbind(\"beforeunload\").bind(\"beforeunload\", function(e) {\r\n\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data(\"auto-save\")) {\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");\r\n                }\r\n\r\n                return;\r\n\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        $(form.children()).each(function() {\r\n            if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                complexGatewayContainer = this;\r\n            }\r\n        });\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function() {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        //Event to notify the native code the form will be showing a modal view \r\n        self.bind(\"modalViewDidAppear\", function() {\r\n            self.params.navigation.modalViewDidAppear();\r\n        });\r\n\r\n        //Event to notify the native code the form will be hiding a modal view \r\n        self.bind(\"modalViewDidDisappear\", function() {\r\n            self.params.navigation.modalViewDidDisappear();\r\n        });\r\n\r\n        // Set events for complex gateway interface\r\n        $(\".bz-rn-cg-checkbox\", complexGatewayContainer).bind(\"click\", function() {\r\n            var selectedElement = $(this).find(\"label\");\r\n            var transitionId = selectedElement.data(\"value\") || \"\";\r\n\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(selectedElement.data(\"checked\"))) {\r\n                // Uncheck element\r\n                selectedElement.removeClass(\"ui-checkbox-state-checked\");\r\n                selectedElement.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                selectedElement.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                selectedElement.addClass(\"ui-checkbox-state-checked\");\r\n                selectedElement.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                selectedElement.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Auto Save Events\r\n    */\r\n    autoSaveEvents: function(deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        self.collectRenderValues(data);\r\n\r\n        if (!$.isEmptyObject(data)) {\r\n            var isStartForm = self.properties.formtype === \"startform\";\r\n            var message = isStartForm ? bizagi.localization.getResource(\"confirmation-savebox-message4\") : bizagi.localization.getResource(\"confirmation-savebox-message1\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"warning\")).done(function () {\r\n                if (!isStartForm)\r\n                    self.saveForm();\r\n\r\n                deferredSave.resolve();\r\n            }).fail(function () {\r\n                if (isStartForm) {\r\n                    deferredSave.reject();\r\n                } else {\r\n                    deferredSave.resolve();\r\n                }\r\n            });\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    internalSubmitForm: function(buttonProperties) {\r\n        var self = this;\r\n        // Assemble the actions\r\n        var actions = [];\r\n        var defer = $.Deferred();\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var data;\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function() {\r\n            $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\r\n        });\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {\r\n            // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function(key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    var messageComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-path\");\r\n                    var errorComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-error\");\r\n\r\n                    bizagi.showMessageBox(messageComplexGateway, errorComplexGateway, \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: buttonProperties.action,\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n\r\n            //Validates if the method CHECKPOINT is supported\r\n            if (checkpointAction) {\r\n                actions.push(checkpointAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n\r\n            //Validates if the method COMMIT is supported\r\n            if (commitAction) {\r\n                actions.push(commitAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds).done(function(response) {\r\n                flowControlDeferred.resolve(response);\r\n            }).fail(function() {\r\n                console.log(\"Error: It was not possible resolve async actions on form \")\r\n                flowControlDeferred.reject();\r\n            })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        $.when(flowControlDeferred).done(function() {\r\n            bizagi.util.smartphone.startLoading();\r\n\r\n            $.when(self.dataService.multiaction().execute({ actions: actions }))\r\n                .done(function(responses) {\r\n                    // End asynchronous operation\r\n                    self.endLoading();\r\n                    // Find validations\r\n                    var bHasValidations;\r\n                    $.each(responses, function(i, response) {\r\n                        if (response.result.type == \"validationMessages\") {\r\n                            // Something went wrong, we gotta display messages in notifications grid\r\n                            self.addValidationMessage(response.result.messages);\r\n                            bHasValidations = true;\r\n                        }\r\n                    });\r\n\r\n                    if (!bHasValidations) {\r\n                        // Everything went ok .. succesfully response from the server\r\n                        if (!self.postProcessButton(responses, buttonProperties)) {\r\n                            return;\r\n                        }\r\n\r\n                        // After successfully response refresh the form\r\n                        if (buttonProperties.refresh) {\r\n                            self.refreshForm();\r\n                        }\r\n\r\n                        // If needs routing publish an event\r\n                        if (buttonProperties.routing) {\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: self.params.idCase\r\n                            });\r\n                        }\r\n\r\n                        // Create case\r\n                        if (buttonProperties.createnewcase) {\r\n                            if (responses.length > 0) {\r\n                                self.triggerHandler(\"routing\", {\r\n                                    idCase: responses[0].result.IdCase,\r\n                                    caseNumber: responses[0].result.CaseNumber\r\n                                });\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (buttonProperties.executeRule) {\r\n                            self.sendRollbackAction(buttonProperties.id);\r\n                        }\r\n                    }\r\n\r\n                    //Removes the nonSupportedMethods to prevent further iterations\r\n                    delete self.nonSupportedMethods;\r\n\r\n                    defer.resolve();\r\n                }).fail(function(_, _, response) {\r\n                    var messageError = \"\";\r\n                    var errorTypeList = [\r\n                        \"WaitForCompletionPlanException\", \"InvalidPlanStateException\", \"CustomMessageException\"\r\n                    ];\r\n\r\n                    if (buttonProperties.executeRule)\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n\r\n                    if (response && response.error && errorTypeList.indexOf(response.error.errorType) !== -1) {\r\n                        messageError = bizagi.localization.getResource(response.error.message);\r\n                        self.endLoading();\r\n                        $.when(bizagi.showConfirmationBox(messageError, null, false)).then(function() {\r\n                            var _params = $.extend({}, buttonProperties, { forcePlanCompletion: true });\r\n\r\n                            return $.when(self.internalSubmitForm(_params));\r\n                        }).done(function() {\r\n                            defer.resolve();\r\n                        }).fail(function() {\r\n                            defer.reject();\r\n                        });\r\n                    } else {\r\n                        messageError = typeof (response) === \"undefined\" ? bizagi.localization.getResource(\"workportal-general-error\") : response;\r\n                        self.failHandler({ \"error\": messageError });\r\n                        defer.reject(response);\r\n                    }\r\n                }).always(function() {\r\n                    bizagi.util.smartphone.stopLoading();\r\n                });\r\n        }).always(function() {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    prepareCheckpointAction: function(id) {\r\n        return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\r\n    },\r\n\r\n    prepareCommitAction: function(id) {\r\n        return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\r\n    },\r\n\r\n    /**\r\n   *  TEMPLATE METHOD TO GET THE BUTTONS OBJECTS      \r\n   */\r\n    getButtons: function() {\r\n        var self = this;\r\n\r\n        if (self.getParams() && (handler = self.getParams().getButtons))\r\n            handler(self);\r\n\r\n        return $(\".ui-bizagi-button-container .action-button\", self.container);\r\n    },\r\n\r\n    processButtons: function() {\r\n        var self = this;\r\n        var params = self.getParams();\r\n\r\n        if (params && params.processButtons) {\r\n            var handler = params.processButtons;\r\n            handler(self);\r\n        }\r\n\r\n        var properties = self.properties;\r\n        properties.buttons = self.buttons;\r\n\r\n        // To cache a submit Data Buttom if exist\r\n        self.saveButton = null;\r\n        self.nextButton = null;\r\n\r\n        // Set saveButton and nextButton if exist\r\n        for (var i = 0, length = properties.buttons.length; i < length; i++) {\r\n            if (properties.buttons[i].action === \"save\") {\r\n                self.saveButton = properties.buttons[i];\r\n            } else if (properties.buttons[i].action === \"next\") {\r\n                self.nextButton = properties.buttons[i];\r\n            }\r\n        }\r\n\r\n        var navigation = self.getNavigation();\r\n\r\n        if (typeof (navigation) !== \"undefined\") {\r\n            //si tiene un viewContainer sera porque es una forma dentro de container de edicion\r\n            var view_container = self.getViewContainer();\r\n\r\n            if (typeof view_container !== \"undefined\") {\r\n                view_container.setNavigationButtons(self);\r\n            } else {\r\n                navigation.setNavigationButtons(self);\r\n            }\r\n        }\r\n\r\n        // bind de touch events\r\n        self.bindTouchEvents(self.getButtons());\r\n    },\r\n\r\n    bindTouchEvents: function(buttons) {\r\n        var self = this;\r\n        var touchMoveStart = 0;\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length === 0) return;\r\n\r\n        buttons.bind(\"touchstart\", function(event) {\r\n            event.preventDefault();\r\n\r\n            var pointer = event.originalEvent.targetTouches ? event.originalEvent.targetTouches[0] : event;\r\n            touchMoveStart = pointer.pageY;\r\n        });\r\n\r\n        buttons.bind(\"touchend , click\", function(event) {\r\n            event.preventDefault();\r\n\r\n            // Trigger the blur of the focused element in order to catch the render Change in the last changed control\r\n            $(\":focus\", self.container).blur();\r\n            var pointer = event.originalEvent && event.originalEvent.changedTouches ? event.originalEvent.changedTouches[0] : event;\r\n            var currentPositionY = pointer.pageY;\r\n\r\n            self.startLoading();\r\n\r\n            // If the finger is too far from the button when you stop touching the screen, then do nothing\r\n            if (event.type !== \"click\" && currentPositionY > touchMoveStart + 40 || currentPositionY < touchMoveStart - 40) {\r\n                self.endLoading();\r\n            } else {\r\n                var button = $(this);\r\n                var ordinal = button.attr(\"ordinal\");\r\n                var buttonProperties = self.buttons[ordinal];\r\n\r\n                // Execute button\r\n                $.when(self.processButton(buttonProperties)).always(function() {\r\n                    self.endLoading();\r\n                });\r\n            }\r\n        });\r\n\r\n        return;\r\n    },\r\n\r\n    refreshForm: function(focus) {\r\n        var self = this;\r\n        var params = self.getParams();\r\n        var defer = new $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            isRefresh: true,\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\",\r\n            navigation: params.navigation,\r\n            view_container: params.view_container\r\n        };\r\n\r\n        if (params.postRenderEdit || params.processButtons) {\r\n            options.postRenderEdit = params.postRenderEdit;\r\n            options.processButtons = params.processButtons;\r\n            options.originalParams = params.originalParams || {};\r\n            options.getButtons = params.getButtons;\r\n        }\r\n\r\n        $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"inherit\");\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function() {\r\n            defer.resolve();\r\n            setTimeout(function() {\r\n                $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"touch\");\r\n            }, 1000);\r\n        }).fail(function() {\r\n            defer.reject();\r\n        }).always(function() {\r\n            self.endLoading();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getSelectedTabs: function() {\r\n        var self = this,\r\n            tabContainers = self.getElementsByType(\"tab\");\r\n\r\n        var tabs = $.map(tabContainers, function(tabContainer) {\r\n            return { tab: tabContainer.properties.id, selected: tabContainer.activeTab };\r\n        });\r\n\r\n        var selectedTabs = {};\r\n        var i = tabs.length;\r\n\r\n        while (i-- > 0) {\r\n            selectedTabs[tabs[i].tab] = tabs[i].selected;\r\n        }\r\n\r\n        return selectedTabs;\r\n    },\r\n\r\n    getNavigation: function() {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.navigation;\r\n    },\r\n\r\n    getViewContainer: function() {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.view_container;\r\n    },\r\n\r\n    isFloatingButtonsEnabled: function () {\r\n        var navigation = this.getNavigation();\r\n        return navigation && navigation.isFloatingButtonsEnabled();\r\n    },\r\n\r\n    isFormButtonsEnabled: function () {\r\n        var navigation = this.getNavigation();\r\n        return navigation && navigation.isFormButtonsEnabled();\r\n    },\r\n\r\n    /*\r\n    * Add a validation message to the form\r\n    */\r\n    addValidationMessage: function(validationMessage) {\r\n        var self = this;\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage);\r\n        } else {\r\n            $.each(validationMessage, function(i, message) {\r\n                self.validationController.showValidationMessage(message);\r\n            });\r\n        }\r\n\r\n        self.validationController.expandNotificationBox();\r\n\r\n        // TODO: Review function\r\n        var navigation = self.getNavigation();\r\n        if (navigation && navigation.hasOwnProperty(\"undoRemoveLastSuscriber\")) {\r\n            self.getNavigation().undoRemoveLastSuscriber();\r\n        }\r\n    },\r\n\r\n    startLoading: function(delay) {\r\n        bizagi.util.smartphone.startLoading();\r\n    },\r\n\r\n    endLoading: function() {\r\n        bizagi.util.smartphone.stopLoading();\r\n    },\r\n\r\n    dispose: function(params) {\r\n        var self = this;\r\n\r\n        // Active refresh on smartphone\r\n        if (typeof (params) === \"undefined\" || (typeof (params.isRefresh) === \"undefined\" || params.isRefresh == false)) {\r\n            self._super();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Publish a global event that the facade will replicate, also will be triggered in the form\r\n     */\r\n    triggerGlobalHandler: function(eventType, data) {\r\n        this._super(eventType, data);\r\n        if (!this.parent) {\r\n            if (this.observableElement) {\r\n                return this.observableElement.trigger(eventType, data);\r\n            } else {\r\n                return null;\r\n            }\r\n        } else {\r\n            return this.parent.triggerGlobalHandler(eventType, data);\r\n        }\r\n    },\r\n\r\n    failHandler: function(error) {\r\n        var self = this;\r\n        self._super(error);\r\n\r\n        var error_obj = {};\r\n        try {\r\n            error_obj = JSON.parse(error) || {};\r\n        } catch (e) {\r\n            error_obj = (error.length && error.length > 1) ? error[0] : error;\r\n        } finally {\r\n\r\n            //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n\r\n            //trigger the routing event in order to refresh the case\r\n            if (typeof error_obj.code !== \"undefined\" && error_obj.code == \"AUTH_ERROR\") {\r\n\r\n                $.notifier.add({\r\n                    class_name: \"error\",\r\n                    title: \"Error\",\r\n                    text: bizagi.localization.getResource(\"render-idle-expired-error\", \"Idle timer expired. For safety reasons this view will be refreshed automatically in 5 seconds. Note that any unsaved data is lost.\").replace(\"%s\", \"5\"),\r\n                    sticky: false,\r\n                    time: 5000\r\n                });\r\n\r\n                setTimeout(function() {\r\n                    self.triggerHandler(\"routing\", {\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem\r\n                    });\r\n                }, 5000);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Build the container html\r\n    */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.kendoTmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        return self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.panel.extend(\"bizagi.rendering.panel\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Panel Extension\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.contentPanel.extend(\"bizagi.rendering.contentPanel\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Tab Container Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to Smartphone devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.tab.extend(\"bizagi.rendering.tab\", {\r\n    VISIBLE_TABS: 2\r\n}, {\r\n\r\n    /* POST RENDER CONTAINER ACTIONS\r\n    =================================================*/\r\n    postRenderContainer: function (tab) {\r\n        var self = this;\r\n        self._super(tab);\r\n\r\n        // Apply any plugin or custom code to implement smartphone tabs\r\n        self.suscribeMethods();\r\n    },\r\n\r\n    suscribeMethods: function () {\r\n        var self = this;\r\n        var tab = self.container;\r\n\r\n        //tabs\r\n        $(tab).bztabs({\r\n            activeTab: (self.activeTab !== undefined && self.activeTab !== null) ? self.activeTab : 0,\r\n            tabNumber: self.Class.VISIBLE_TABS,\r\n            domIncluded: self.ready(),\r\n            activate: function (event, ui) {\r\n                self.activeTab = $(event.currentTarget) ? $(event.currentTarget).data(\"index\") : 0;\r\n\r\n                var index = self.activeTab;\r\n                var form = self.getFormContainer();\r\n                var selectedTab = {};\r\n                selectedTab[self.children[index].parent.properties.id] = index;\r\n                form.setParam(\"selectedTabs\", selectedTab);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Checks the visibility of the plus icon after partial refresh of itemTabs\r\n     */\r\n    checkPlusVisibility: function () {\r\n        var self = this;\r\n        var visible_tabs = $(\".bz-header_select > .bz-wp-tabs-ui:not(:hidden)\", self.container);\r\n        if(visible_tabs.length <= self.Class.VISIBLE_TABS){\r\n            $(\".bz-header_select\", self.container).removeClass(\"show-pluss\");\r\n        }\r\n        else{\r\n            $(\".bz-header_select\", self.container).addClass(\"show-pluss\");\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Panel Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to Smartphone devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.tabItem.extend(\"bizagi.rendering.tabItem\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set tab ready deferred\r\n        self.tabReadyDeferred = new $.Deferred();\r\n        self.loadingDeferred = new $.Deferred();\r\n        self.tabActiveDeferred = new $.Deferred();\r\n    },\r\n    /**\r\n     * Change selected item\r\n     *\r\n     * @param {} argument\r\n     * @returns {}\r\n     */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            // Changes item\r\n            var tabContainer = self.parent;\r\n            if (tabContainer && tabContainer.container.tabs.hasOwnProperty(\"option\")) {\r\n                tabContainer.container.tabs(\"option\", \"active\", self.container.data(\"tab-counter\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Focus on container\r\n     *\r\n     * @returns {}\r\n     */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n        // Set this tab as an active container\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n    *  Hides / Show container\r\n    *\r\n    * @param {} argument\r\n    * @returns {}\r\n    */\r\n    changeVisibility: function (argument) {\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var tabContainer = self.parent.container;\r\n        var activeTab = self.parent.getActiveTab();\r\n\r\n        var id = \"ui-bizagi-tab-\" + properties.id;\r\n        var header = $(\".bz-wp-tabs-item[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Hide - show the render\r\n                if (properties.visible) {\r\n                    self.container.css(\"display\", \"\");\r\n\r\n                    self.setAsActiveContainer();\r\n\r\n                    if (header && header.css(\"display\", \"none\")) {\r\n                        var headerShow = $(\"div[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n                        headerShow && headerShow.css(\"display\", \"\");\r\n                    }\r\n                } else {\r\n                    self.container.hide();\r\n                    if (header && header.css(\"display\", \"block\")) {\r\n                        var headerHide = $(\"div[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n                        headerHide && headerHide.hide();\r\n                    }\r\n                }\r\n\r\n            }).always(function () {\r\n                if (tabContainer && tabContainer.tabs.hasOwnProperty(\"option\")) {\r\n                    tabContainer.tabs(\"option\", \"active\", activeTab);\r\n                }\r\n                self.parent.checkPlusVisibility();\r\n            });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Horizontal Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.horizontal.extend(\"bizagi.rendering.horizontal\", {}, {\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Smartphones Group Extension\r\n *   Author: oscar osorio\r\n *   Comments:\r\n *   -   This script will redefine the group class to adjust to smartphones devices\r\n */\r\n\r\n// Auto extend\r\nbizagi.rendering.group.extend(\"bizagi.rendering.group\", {}, {\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (group) {\r\n        var self = this;        \r\n\r\n        // Call base\r\n        self._super(group);\r\n        self.subscribeOnTouch();\r\n    },\r\n\r\n    /* \r\n    *   Expands group container \r\n    */\r\n    expand: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n    },\r\n\r\n    /* \r\n    *   Collapses group container \r\n    */\r\n    collapse: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n    },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument) {\r\n        var self = this;\r\n\r\n        if (argument) {\r\n            self.expand();\r\n        } else {\r\n            self.collapse();\r\n        }\r\n    },\r\n\r\n    subscribeOnTouch: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        $(group).find(\">div.headertitle\").bind(\"click\", function () {\r\n            $(group).toggleClass(\"collapsed\");\r\n        });\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Smartphone Search Form Extension\r\n *   Author: Oscar O\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to tablet devices\r\n */\r\n\r\n// Auto extend\r\nbizagi.rendering.searchForm.extend(\"bizagi.rendering.searchForm\", {}, {\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: \"grid\",\r\n            xpath: \"searchForm\" + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function (params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function (i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0)\r\n                column.render.properties.columnVisible = false;\r\n\r\n            // if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8)\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n\r\n            // if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11)\r\n                column.render.properties.allowDecimals = true;\r\n\r\n            // if column is date push showtime property\r\n            if (columns[i].dataType == 12)\r\n                column.render.properties.showTime = columns[i].showTime;\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        grid.properties.allowAdd = false;\r\n        grid.properties.allowEdit = false;\r\n        grid.properties.allowDelete = false;\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n    \tvar self = this;\r\n        self._super(container);\r\n\r\n        var results = container.find(\".ui-bizagi-container-search-results\");\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".ui-bizagi-container-search-criteria\", self.container);\r\n        self.resultsContainer = $(\".ui-bizagi-container-search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function(e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty(\"multiSelect\")) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function() {\r\n        var self = this;\r\n        self.trigger(\"instancerefresh\");\r\n\r\n        return $.when(self.resultsGrid.refresh()).done(function() {\r\n            self.trigger(\"instancerefreshdone\");\r\n            if (self.resultsGrid.properties.data && self.resultsGrid.properties.data.records == 0 &&\r\n                self.resultsGrid.properties.data.rows.length == 0) {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-general-no-records-found\"),\r\n                    bizagi.localization.getResource(\"render-dialog-sendemail-message\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Publish a global event that the facade will replicate, also will be triggered by the principal form\r\n     */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        var self = this;\r\n\r\n        self._super(eventType, data);\r\n\r\n        if (!self.parent) {\r\n            if (self.observableElement) {\r\n                return self.observableElement.trigger(eventType, data);\r\n            } else {\r\n                return null;\r\n            }\r\n        } else {\r\n            return self.parent.triggerGlobalHandler(eventType, data);\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Smartphone Search Slide Implementation\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will shows a  search form\r\n */\r\n$.Class.extend(\"bizagi.rendering.smartphone.helpers.searchForm\", {}, {\r\n  /*\r\n   *   Constructor\r\n   */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, searchFormParams) {        \r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.searchForms = searchForms;\r\n        this.searchParams = searchParams;\r\n        this.searchFormParams = searchFormParams;\r\n        this.searchFormDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * Render the edition form,... if is an addform, then show the currentAddForm view\r\n     * */\r\n    renderEdition: function (params) {\r\n        var self = this;\r\n        self.properties = params;\r\n\r\n        //Render the search form\r\n        self.renderSearchForm(params);\r\n\r\n        // Return promise\r\n        return self.searchFormDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * get the searchform and render it!\r\n     * */\r\n    renderSearchForm: function(params) {\r\n        var self = this;\r\n\r\n        // Creates a container, be careful you must destroy it later\r\n        var container = self.searchFormParams.navigation.createRenderContainer({ title: params.displayName });\r\n        $.when(self.getSearchContainerData(params))\r\n            .then(function(data) {\r\n                if (params.editable === false) {\r\n                    data.form.properties.editable = false;\r\n                }\r\n\r\n                if (data.form.properties) {\r\n                    data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n                }\r\n\r\n                var form = self.renderFactory.getContainer($.extend({}, self.searchFormParams, {\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.searchFormParams.navigation,\r\n                    view_container: container\r\n                }));\r\n\r\n                self.form = form;\r\n\r\n                var keys = Object.keys(form.children);\r\n                keys.map(function(key) {\r\n                    form.children[key].params = $.extend({}, form.children[key].params, self.searchFormParams);\r\n                });\r\n\r\n                return form.render();\r\n\r\n            }, function(message) {\r\n                var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n                $.kendoTmpls(errorTemplate, { message: message }).appendTo(slideForm.find(\".scroll-content\"));\r\n            }).done(function(element) {\r\n                var tabContainer = self.form.firstChild().properties.type === \"tab\" ? self.form.firstChild() : null;\r\n                if (tabContainer) {\r\n                    // Bind select tab event\r\n                    tabContainer.bind(\"selected\", function(e, ui) {\r\n                        var searchForm = self.searchForms[ui.index];\r\n                        $.when(self.loadSearchTab(params, ui.tab, searchForm))\r\n                            .done(function() {\r\n                                // Set currents search form\r\n                                self.currentSearchForm = ui.tab.firstChild();\r\n                                self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n                            });\r\n                    });\r\n\r\n                    tabContainer.container.tabs(\"select\", 0);\r\n                    self.currentSearchForm = tabContainer.firstChild().firstChild();\r\n\r\n                    if (!self.currentSearchForm.readyDeferred)\r\n                        self.currentSearchForm.readyDeferred = new $.Deferred();\r\n\r\n                    self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n                } else {\r\n                    // Set currents search form\r\n                    self.currentSearchForm = self.form.firstChild();\r\n\r\n                    if (!self.currentSearchForm.readyDeferred)\r\n                        self.currentSearchForm.readyDeferred = new $.Deferred();\r\n\r\n                    self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n                }\r\n\r\n                container.element.html(element);\r\n                self.searchFormParams.navigation.navigate(container.id);\r\n\r\n                self.containerGridResults = self.currentSearchForm.container.find(\".ui-bizagi-container-search-results\");\r\n                self.containerSearchCriteria =\r\n                    self.currentSearchForm.container.find(\".ui-bizagi-container-search-criteria\");\r\n                self.applyButtons(container);\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Get the addform and show it\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    renderAddForm: function(params){\r\n        var self = this;\r\n        params = params || {};\r\n        var properties = self.properties;\r\n\r\n        if (typeof self.addContainer === \"undefined\") {\r\n            var message = bizagi.localization.getResource(\"render-dialog-entity\");\r\n            self.addContainer = self.searchFormParams.navigation.createRenderContainer({ title: message });\r\n\r\n            // Binds the view close event, and send the RollBack\r\n            self.addContainer.element.bind(\"close\", function(){\r\n                delete self.addContainer;\r\n            });\r\n        }\r\n\r\n        var isRefresh = params.isRefresh || false;\r\n\r\n        var getFormParams = {\r\n            idPageCache: params.idPageCache,\r\n            guidEntity: properties.entity,\r\n            contextType: \"entity\"\r\n        };\r\n\r\n        if (isRefresh) {\r\n            getFormParams.isRefresh = true;\r\n            getFormParams.idStartScope = params.idStartScope;\r\n        }\r\n        else {\r\n            getFormParams.idRender = properties.idRender;\r\n            getFormParams.requestedForm = \"addForm\";\r\n        }\r\n\r\n        // Get the addform\r\n        $.when(self.dataService.getFormData(getFormParams)).then(function(data){\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            if (typeof (data.form.properties) !== \"undefined\"){\r\n                data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n            }\r\n\r\n            data.form.contextType = \"entity\";\r\n\r\n            var form = self.renderFactory.getContainer($.extend({}, self.addFormParams, {\r\n                type: \"form\",\r\n                data: data.form,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: isRefresh,\r\n                requestedForm: params.requestedForm,\r\n                navigation: self.searchFormParams.navigation,\r\n                view_container: self.addContainer\r\n            }));\r\n\r\n            form.buttons = [\r\n                $.extend(\r\n                    form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            // When the data is saved then\r\n                            return self.saveDataAddForm(form).done(function () {\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n\r\n                                // Force a search after a new item is created!\r\n                                self.searchParams.maxRows = 1;\r\n                                self.currentSearchForm.performSearch(self.searchParams);\r\n                            });\r\n                        }\r\n                    }),\r\n                $.extend(\r\n                    form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\"\r\n                    },\r\n                    {\r\n                        // This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            self.addContainer.destroy();\r\n                            delete self.addContainer;\r\n                        }\r\n                    })\r\n            ];\r\n\r\n            $.extend(form, {\r\n                processButtons: function() {\r\n                    // Not send information set in memory and save\r\n                    $.each(form.buttons, function(index, element) {\r\n                        switch (element[\"ordinal\"]) {\r\n                            case 1: //next button will behave as a cancel button\r\n                                $(form.getButtons()[index]).click(function() {\r\n                                    self.addContainer.destroy();\r\n                                    delete self.addContainer;\r\n                                });\r\n\r\n                                form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                form.buttons[index].action = \"back\";\r\n                                break;\r\n\r\n                            default:\r\n                                $(form.getButtons()[index]).click(function() {\r\n                                    self.saveDataAddForm(form);\r\n                                    self.addContainer.destroy();\r\n                                    delete self.addContainer;\r\n                                });\r\n                                break;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            for (var indicator in form.children) {\r\n                form.children[indicator].params = $.extend({}, form.children[indicator].params, self.addFormParams);\r\n            }\r\n\r\n            return $.when(form.render()).done(function(element){\r\n                // Set currents search form\r\n                self.currentAddForm = form.firstChild();\r\n                self.addContainer.element.html(element);\r\n\r\n                if (!isRefresh){\r\n                    self.searchFormParams.navigation.navigate(self.addContainer.id);\r\n                }\r\n\r\n                self.addContainer.setNavigationButtons(form);\r\n\r\n                form.triggerHandler(\"ondomincluded\");\r\n\r\n                // if is any modal view displayed, hide it to allow this search form been displayed\r\n                self.handleSearchFormZindex(\"show\");\r\n\r\n                form.bind(\"refresh\", function (_, refreshParams) {\r\n                    refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                    refreshParams = $.extend({\r\n                        focus: focus,\r\n                        selectedTabs: self.form.getSelectedTabs(),\r\n                        isRefresh: true,\r\n                        contextType: self.properties.contextType || \"\",\r\n                        navigation: self.searchFormParams.navigation,\r\n                        view_container: self.addContainer\r\n                    }, refreshParams);\r\n\r\n                    return self.renderAddForm(refreshParams);\r\n                });\r\n            });\r\n        }).fail(function(){\r\n            self.addContainer.destroy();\r\n            delete self.addContainer;\r\n            console.log(\"there was an error :(\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Save data to add form\r\n     * @param {} form\r\n     * @returns {}\r\n     */\r\n    saveDataAddForm: function (form) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n\r\n        if (form.validateForm()) {\r\n            var data = {};\r\n            $.forceCollectData = true;\r\n\r\n            form.collectRenderValues(data);\r\n            data.idPageCache = form.idPageCache;\r\n\r\n            var params = {\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idPageCache: data.idPageCache,\r\n                guidEntity: form.properties.entity,\r\n                contexttype: \"entity\",\r\n            };\r\n\r\n            // Check if the add form has data\r\n            var formData = {};\r\n\r\n            form.collectRenderValuesForSubmit(formData);\r\n\r\n            // Turn off flag\r\n            $.forceCollectData = false;\r\n\r\n            if (!bizagi.util.isMapEmpty(formData)) {\r\n                $.when(self.dataService.submitData(params))\r\n                    .done(function (response) {\r\n                        function dataHasXpath(xpath) {\r\n                            var render = self.currentSearchForm.getRender(xpath);\r\n\r\n                            if (typeof render === \"object\" && render !== null)\r\n                                return { \"found\": true, \"obj\": render };\r\n                            return { \"found\": false, \"obj\": {} };\r\n                        }\r\n\r\n                        for (var i in formData) {\r\n                            var mapping = dataHasXpath(i);\r\n                            if (mapping.found) {\r\n                                mapping.obj.setValue(formData[i]);\r\n                                self.setDisplayValueToControl(mapping.obj, form, i, formData);\r\n                            }\r\n                        }\r\n\r\n                        defer.resolve();\r\n                    })\r\n                    .fail(function (jqXHR, type, message) {\r\n                        form.addValidationMessage(message.message);\r\n                        defer.reject();\r\n                    });\r\n            } else {\r\n                // Form has not data\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\r\n                defer.reject();\r\n            }\r\n        }\r\n        else {\r\n            defer.reject();\r\n        }\r\n        return defer;\r\n    },\r\n\r\n    /***\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function(renderControlSearchForm, addForm, xpath, formData) {\r\n        if (renderControlSearchForm.properties.type === \"searchSuggest\") {\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        } else {\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * configure searchform buttons\r\n     * */\r\n    applyButtons: function (container) {\r\n        var self = this;\r\n\r\n        self.displayBottomButtons(container);\r\n\r\n        container.element.bind(\"close\", function () {\r\n            self.searchFormDeferred.reject();\r\n        });\r\n    },\r\n\r\n    loadSearchTab: function (params, tab, searchForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If the tab has children it is loaded already\r\n        if (tab.children.length > 0)\r\n            return null;\r\n\r\n        // Load search form data\r\n        $.when(self.getSearchFormData(params, searchForm))\r\n            .pipe(function (data) {\r\n                // Render data inside selected tab\r\n                var searchFormContainer = self.renderFactory.getContainer({\r\n                    type: \"searchForm\",\r\n                    data: data.form\r\n                });\r\n\r\n                tab.children.push(searchFormContainer);\r\n                return searchFormContainer.render();\r\n            })\r\n            .done(function (element) {\r\n                // Remove button container\r\n                $(\".ui-bizagi-button-container\", element).detach();\r\n                tab.container.append(element);\r\n                defer.resolve();\r\n            });\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the search dialog sub-containers\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: {\r\n                properties: {},\r\n                elements: []\r\n            }\r\n        };\r\n\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n            var tabContainer = {};\r\n            tabContainer.properties = {\r\n                type: \"tab\"\r\n            };\r\n\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: \"tabItem\",\r\n                    displayName: searchForm.caption\r\n                };\r\n                tab.elements = [];\r\n                // Append children\r\n                if (isDefault) {\r\n                    tabContainer.elements.push({\r\n                        container: tab\r\n                    });\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n                } else {\r\n                    otherElements.push({\r\n                        container: tab\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad))\r\n            .done(function (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n                container.properties.id = Math.guid();\r\n\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            });\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Loads a search form\r\n     * @param {} params\r\n     * @param {} searchForm\r\n     * @returns {}\r\n     */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n            return data;\r\n        });\r\n    },\r\n\r\n    displayBottomButtons: function (container) {\r\n        var self = this;\r\n        var containerButtons = self.currentSearchForm.container.find(\".ui-bizagi-container-button-edit\").empty().show();\r\n        var templateBtn = \"<button class='ui-bizagi-form-button #= data.name #'> #= data.text # </button>\";\r\n        var btnSearch = $.kendoTmpls(templateBtn, { name: \"bz-btn-search\", text: bizagi.localization.getResource(\"render-form-dialog-box-search\") }).appendTo(containerButtons);\r\n        var btnSelect = $.kendoTmpls(templateBtn, { name: \"bz-btn-select\", text: bizagi.localization.getResource(\"render-search-advanced-results-button\") }).appendTo(containerButtons);\r\n        var btnAdd = $.kendoTmpls(templateBtn, { name: \"bz-btn-add\", text: bizagi.localization.getResource(\"render-form-dialog-box-add\") }).appendTo(containerButtons);\r\n        var btnCancel = $.kendoTmpls(templateBtn, { name: \"bz-btn-cancel\", text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\") }).appendTo(containerButtons);\r\n\r\n        container.element.bind(\"close\", function (e) {\r\n            //If the view results is in front, shouldn't go back, but change the showed panel\r\n            if (self.containerSearchCriteria.css(\"display\") === \"none\"){\r\n                e.preventDefault();\r\n                setSearchState();\r\n            }\r\n        });\r\n\r\n        var setSearchState = function setSearchButtons() {\r\n            // List posible buttons for search\r\n            var buttons = [\r\n                {\r\n                    \"ordinal\": 1,\r\n                    \"action\": \"search\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                    \"callback\": function () {\r\n                        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\r\n                        self.searchParams.maxRows = 1;\r\n                        return self.currentSearchForm.performSearch(self.searchParams);\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 2,\r\n                    \"action\": \"cancel\",\r\n                    \"caption\": \"cancel\",\r\n                    \"callback\": function () {\r\n                        self.searchFormDeferred.reject();\r\n                        container.destroy();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 3,\r\n                    \"action\": \"add\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                    \"callback\": function () {\r\n                        var params = {\r\n                            \"idCase\": self.searchFormParams.idCase,\r\n                            \"idRender\": self.properties.idRender,\r\n                            \"displayName\": self.properties.displayName,\r\n                            \"idPageCache\": self.properties.idPageCache,\r\n                        };\r\n\r\n                        self.renderAddForm(params);\r\n                    },\r\n                },\r\n            ];\r\n\r\n            self.containerSearchCriteria.show();\r\n            self.containerGridResults.hide();\r\n\r\n            // Add only seen when allowed\r\n            $(btnAdd).toggle(self.searchParams.allowNew);\r\n            btnSearch.show();\r\n            btnSelect.hide();\r\n\r\n            if(!self.searchParams.allowNew) {\r\n                buttons.pop();\r\n            }\r\n\r\n            self.form.buttons = buttons;\r\n            delete self.form.properties.virtual;\r\n            container.setNavigationButtons(self.form);\r\n        };\r\n\r\n        var setResultState = function setSearchButtons() {\r\n\r\n            // List posible buttons for result\r\n            var buttons = [\r\n                {\r\n                    \"ordinal\": 4,\r\n                    \"action\": \"select\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-search-advanced-results-button\"),\r\n                    \"callback\": function () {\r\n                        self.searchFormDeferred.resolve(container.element.find(\".ui-bizagi-container-search-results [data-key]\").data(\"business-key\"));\r\n                        container.destroy();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 5,\r\n                    \"action\": \"cancel\",\r\n                    \"caption\": \"cancel\",\r\n                    \"callback\": function () {\r\n                        setSearchState();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 3,\r\n                    \"action\": \"add\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                    \"callback\": function () {\r\n                        var params = {\r\n                            \"idCase\": self.searchFormParams.idCase,\r\n                            \"idRender\": self.properties.idRender,\r\n                            \"displayName\": self.properties.displayName,\r\n                            \"idPageCache\": self.properties.idPageCache,\r\n                        };\r\n\r\n                        self.renderAddForm(params);\r\n                    },\r\n                },\r\n            ];\r\n\r\n            self.containerSearchCriteria.hide();\r\n            self.containerGridResults.show();\r\n\r\n            // Add only seen when allowed\r\n            $(btnAdd).toggle(self.searchParams.allowNew);\r\n            btnSearch.hide();\r\n            btnSelect.show();\r\n\r\n            if(!self.searchParams.allowNew) {\r\n                buttons.pop();\r\n            }\r\n\r\n            self.form.buttons = buttons;\r\n            self.form.properties.virtual = true;\r\n            container.setNavigationButtons(self.form);\r\n        };\r\n\r\n        btnSearch.bind(\"click\", function () {\r\n            // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\r\n            self.searchParams.maxRows = 1;\r\n            self.currentSearchForm.performSearch(self.searchParams);\r\n        });\r\n\r\n        btnAdd.bind(\"click\", function () {\r\n            var params = {\r\n                \"idCase\": self.searchFormParams.idCase,\r\n                \"idRender\": self.properties.idRender,\r\n                \"displayName\": self.properties.displayName,\r\n                \"idPageCache\": self.properties.idPageCache\r\n            };\r\n\r\n            self.renderAddForm(params);\r\n        });\r\n\r\n        btnCancel.bind(\"click\", function () {\r\n            self.searchFormDeferred.reject();\r\n            container.destroy();\r\n        });\r\n\r\n        btnSelect.bind(\"click\", function () {\r\n            self.searchFormDeferred.resolve(container.element.find(\".ui-bizagi-container-search-results [data-key]\").data(\"business-key\"));\r\n            container.destroy();\r\n        });\r\n\r\n        self.currentSearchForm.bind(\"instancerefreshdone\", function () {\r\n            // Show search results container\r\n            if (self.currentSearchForm.resultsGrid.properties.data !== null &&\r\n                !jQuery.isEmptyObject(self.currentSearchForm.resultsGrid.properties.data.rows ) &&\r\n                self.currentSearchForm.resultsGrid.properties.data.rows.length > 0\r\n            ) {\r\n                setResultState();\r\n            }\r\n            else {\r\n                setSearchState();\r\n            }\r\n        });\r\n\r\n        setSearchState();\r\n    },\r\n\r\n    renderEditionAddForm: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = $(params.id + \" .inputEditionContent\");\r\n        var canvas = $(params.id + \" .inputEditionContent\");\r\n        var kendoView = $(params.id, \"body\");\r\n\r\n        self.viewContainer = params.viewContainer;\r\n\r\n        self.addFormParams = {\r\n            container: container,\r\n            canvas: canvas,\r\n            kendoView: kendoView,\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords,\r\n            allowNew: false\r\n        };\r\n\r\n        self.renderEdition({\r\n            \"idRender\": properties.idRender,\r\n            \"requestedForm\": \"addForm\",\r\n            \"xpathContext\": properties.xpathContext,\r\n            \"idPageCache\": properties.idPageCache,\r\n            \"isAddForm\": true,\r\n            \"contextType\": \"entity\"\r\n        }).done(function() {\r\n            if (self.form.validateForm()) {\r\n                var data = {};\r\n                $.forceCollectData = true;\r\n\r\n                self.form.collectRenderValues(data);\r\n                data.idPageCache = self.form.idPageCache;\r\n                var defer = $.Deferred();\r\n\r\n                var params = {\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    idPageCache: data.idPageCache,\r\n                    guidEntity: self.form.properties.entity,\r\n                    contexttype: \"entity\"\r\n                };\r\n\r\n                // Check if the add form has data\r\n                var formData = {};\r\n\r\n                self.form.collectRenderValuesForSubmit(formData);\r\n\r\n                // Turn off flag\r\n                $.forceCollectData = false;\r\n\r\n                if (!bizagi.util.isMapEmpty(formData)) {\r\n                    self.pane.navigate(\"#:back\");\r\n                    $.when(self.dataService.submitData(params)).done(function(response) {\r\n                        function dataHasXpath(xpath) {\r\n                            var render = self.currentSearchForm.getRender(xpath);\r\n\r\n                            if (typeof render == \"object\" && render !== null) {\r\n                                return { \"found\": true, \"obj\": render };\r\n                            }\r\n\r\n                            return { \"found\": false, \"obj\": {} };\r\n                        }\r\n\r\n                        for (var i in formData) {\r\n                            var mapping = dataHasXpath(i);\r\n                            if (mapping.found) {\r\n                                var value = data[i];\r\n                                mapping.obj.setValue(value);\r\n                                mapping.obj.setDisplayValue(value);\r\n\r\n                                if (self.currentSearchForm.resultsGrid.properties.data !== null &&\r\n                                    !jQuery.isEmptyObject(self.currentSearchForm.resultsGrid.properties.data.rows) &&\r\n                                    self.currentSearchForm.resultsGrid.properties.data.rows.length > 0) {\r\n                                    self.containerSearchCriteria.show();\r\n                                    self.currentSearchForm.container.find(\".bz-btn-search\").show();\r\n                                    self.currentSearchForm.container.find(\".bz-btn-select\").hide();\r\n                                    self.containerGridResults.hide();\r\n                                }\r\n                            }\r\n                        }\r\n                    }).fail(function(jqXHR, type, message) {\r\n                        if (type === \"parsererror\") {\r\n                            defer.resolve({ type: \"error\", message: message.message });\r\n                        } else {\r\n                            defer.reject(arguments);\r\n                        }\r\n                    });\r\n                } else {\r\n                    // Form has not data\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\r\n                }\r\n            }\r\n        }).fail(function() {\r\n            self.pane.navigate(\"#:back\");\r\n        });\r\n\r\n        self.pane.navigate(params.id);\r\n    },\r\n\r\n    handleSearchFormZindex: function(option) {\r\n        var self = this;\r\n\r\n        //if there is an open modal, change z-index to make searchForm visible\r\n        var modalViewDisplayed = jQuery.grep($(\".km-modalview-root\"), function(n, i) {\r\n            return ($(n).css(\"display\") == \"block\");\r\n        });\r\n\r\n        if (modalViewDisplayed.length > 0) {\r\n            if (option == \"show\") {\r\n                $(modalViewDisplayed).css(\"z-index\", 0);\r\n            } else {\r\n                $(modalViewDisplayed).css(\"z-index\", 10001);\r\n            }\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Tablet slide form implementation\r\n *   Author: Andres Valencia\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.smartphone.startForm\", {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function(dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container    \t\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Handlers de la vista de kendo\r\n     */\r\n    configureViewHandlers: function() {\r\n    },\r\n\r\n    /**\r\n     * go back and destroy\r\n     */\r\n    goBack: function() {\r\n        var self = this;\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /*\r\n     *   Render the form\r\n     *   The params are the same that will be send to the ajax service\r\n     *   Returns a deferred\r\n     */\r\n    render: function(params) {\r\n        var self = this;\r\n        // Fill content\r\n        self.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function(params) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getStartForm(params)).then(function(data) {\r\n            /*** SUCCESS FILTER **/\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Render dialog template\r\n            var formClass = bizagi.rendering.form.extend({\r\n                submitForm: function() {\r\n                    if (self.form) {\r\n                        this.endLoading();\r\n                        // Perform validations\r\n                        if (self.form.validateForm()) {\r\n                            // Collect data\r\n                            var data = {};\r\n                            self.form.collectRenderValues(data);\r\n                            // Add page cache for this form\r\n                            data.idPageCache = self.form.getPageCache();\r\n                            // Call user callback\r\n                            if (self.slideFormParams.onSave) {\r\n                                $.when(self.slideFormParams.onSave(data))\r\n                                    .done(function(result) {\r\n                                        if (result === null || result === true || result.type === \"success\") {\r\n                                            defer.resolve();\r\n                                            self.goBack();\r\n                                        } else if (result.type === \"validationMessages\") {\r\n                                            // Add validation messages\r\n                                            self.form.addValidationMessage(result.messages);\r\n                                            // Update original value to use as reference to other futures changes in the dialogBox\r\n                                            $.each(data, function(key) {\r\n                                                var renders = self.form.getRenders(key);\r\n                                                $.each(renders, function(i, render) {\r\n                                                    render.updateOriginalValue();\r\n                                                });\r\n                                            });\r\n                                        } else if (result.type === \"error\") {\r\n                                            // Add error messages\r\n                                            self.form.addErrorMessage(result.message);\r\n                                        }\r\n                                    });\r\n\r\n                            } else {\r\n                                defer.resolve();\r\n                                self.goBack();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            var containerParams = $.extend({\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.slideFormParams.navigation,\r\n                    view_container: self.slideContainer\r\n                },\r\n                {\r\n                    renderFactory: self.renderFactory,\r\n                    dataService: self.renderFactory.dataService\r\n                });\r\n            self.form = new formClass(containerParams);\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function(_, refreshParams) {\r\n                refreshParams = $.extend({\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true\r\n                }, params, refreshParams, { idStartScope: self.form.properties.idStartScope });\r\n\r\n                self.renderSlideForm(refreshParams);\r\n            });\r\n            // Return rendering promise\r\n\r\n            self.form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": self.slideFormParams.saveButtonLabel,\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function() {\r\n                            // When the data is saved then\r\n                            self.form.submitForm();\r\n                        },\r\n                    }),\r\n                $.extend(\r\n                    self.form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function() {\r\n                            if (self.slideFormParams.onCancel) {\r\n                                self.slideFormParams.onCancel();\r\n                            }\r\n                            self.goBack();\r\n                        },\r\n                    }),\r\n            ];\r\n\r\n            return self.form.render();\r\n        }).done(function(element) {\r\n            var saveButtonLabel = (self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\"));\r\n            var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n\r\n            if (!params.isRefresh) {\r\n                self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n            }\r\n\r\n            $(\".ui-bizagi-button-container div\", self.form.container).remove();\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal='0' id='formButton0' class='action-button ui-bizagi-form-button'>\" +\r\n                    saveButtonLabel + \"</div>\").delegate(\"div[ordinal='0']\", \"click\", function() {\r\n                    self.form.submitForm();\r\n                });\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal='1' id='formButton1' class='action-button ui-bizagi-form-button'>\" +\r\n                    cancelButtonLabel + \"</div>\").delegate(\"div[ordinal='1']\", \"click\", function() {\r\n                    self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                    self.goBack();\r\n                });\r\n\r\n            //self.view.scroller.reset();\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n        }).fail(function(xhr, errorType, message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet slide form implementation\r\n *   Author: Andres Valencia\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n$.Class.extend(\"bizagi.rendering.smartphone.slide.form\", {}, {\r\n    init: function(dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * go back and destroy\r\n     */\r\n    goBack: function() {        \r\n        this.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Handlers de la vista de kendo\r\n     */\r\n    configureViewHandlers: function() {\r\n    },\r\n\r\n    /*\r\n     *   Render the form\r\n     *   The params are the same that will be send to the ajax service\r\n     *   Returns a deferred\r\n     */\r\n    render: function(params) {        \r\n        this.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function(params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params))\r\n            .pipe(function(data) {\r\n                /*** SUCCESS FILTER **/\r\n                // Apply editable param\r\n                if (params.editable === false) {\r\n                    data.form.properties.editable = false;\r\n                }\r\n\r\n                // Render dialog template\r\n                var formClass = bizagi.rendering.form.extend({\r\n                    submitForm: function(arguments) {\r\n                        if (self.form) {\r\n                            this.endLoading();\r\n                            // Perform validations\r\n                            if (self.form.validateForm()) {\r\n                                // Collect data\r\n                                var data = {};\r\n                                self.form.collectRenderValues(data);\r\n                                // Add page cache for this form\r\n                                data.idPageCache = self.form.getPageCache();\r\n                                // Call user callback\r\n                                if (self.slideFormParams.onSave) {\r\n                                    $.when(self.slideFormParams.onSave(data))\r\n                                        .done(function(result) {\r\n                                            if (result === null || result === true || result.type === \"success\") {\r\n                                                defer.resolve();\r\n                                                self.goBack();\r\n                                            } else if (result.type === \"validationMessages\") {\r\n                                                // Add validation messages\r\n                                                self.form.addValidationMessage(result.messages);\r\n                                                // Update original value to use as reference to other futures changes in the dialogBox\r\n                                                $.each(data, function(key, value) {\r\n                                                    var renders = self.form.getRenders(key);\r\n                                                    $.each(renders, function(i, render) {\r\n                                                        render.updateOriginalValue();\r\n                                                    });\r\n                                                });\r\n                                            } else if (result.type === \"error\") {\r\n                                                // Add error messages\r\n                                                self.form.addErrorMessage(result.message);\r\n                                            }\r\n                                        });\r\n\r\n                                } else {\r\n                                    defer.resolve();\r\n                                    self.goBack();\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n                var containerParams = $.extend({\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.slideFormParams.navigation,\r\n                    view_container: self.slideContainer\r\n                }, {\r\n                    renderFactory: self.renderFactory,\r\n                    dataService: self.renderFactory.dataService\r\n                });\r\n                self.form = new formClass(containerParams);\r\n\r\n                self.form.buttons = [\r\n                    $.extend(\r\n                        self.form.buttons[0] || {},\r\n                        {\r\n                            \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                            \"actions\": [\"submitData\", \"refresh\"],\r\n                            \"submitData\": true,\r\n                            \"refresh\": true,\r\n                            \"ordinal\": 0,\r\n                            \"action\": \"save\",\r\n                            \"save\": true,\r\n                            \"style\": \"\",\r\n                        },\r\n                        {\r\n                            //This callback avoid to call the default processButton in the form\r\n                            callback: function () {\r\n                                // When the data is saved then\r\n                                self.form.submitForm();\r\n                            },\r\n                        }),\r\n                    $.extend(\r\n                        self.form.buttons[1] || {},\r\n                        {\r\n                            \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                            \"actions\": [\"submitData\", \"refresh\"],\r\n                            \"submitData\": true,\r\n                            \"refresh\": true,\r\n                            \"ordinal\": 1,\r\n                            \"action\": \"back\",\r\n                            \"save\": true,\r\n                            \"style\": \"\",\r\n                        },\r\n                        {\r\n                            //This callback avoid to call the default processButton in the form\r\n                            callback: function () {\r\n                                if (self.slideFormParams.onCancel) {\r\n                                    self.slideFormParams.onCancel();\r\n                                }\r\n                                self.goBack();\r\n                            },\r\n                        }),\r\n                ];\r\n\r\n                // Return rendering promise\r\n                return self.form.render();\r\n            }).done(function(element) {\r\n            var saveButtonLabel = (self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"));\r\n            var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n\r\n            $(\".ui-bizagi-button-container div\", self.form.container).remove();\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal=\\\"0\\\" id=\\\"formButton0\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\r\n                    saveButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"0\\\"]\", \"click\", function() {\r\n                self.form.submitForm();\r\n            });\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal=\\\"1\\\" id=\\\"formButton1\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\r\n                    cancelButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"1\\\"]\", \"click\", function() {\r\n                self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                self.goBack();\r\n            });\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function() {\r\n                self.renderSlideForm(params);\r\n            });\r\n        }).fail(function(message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/**\r\n * Tablet definition of Action Launcher\r\n *\r\n * @author: Ricardo Pérez\r\n */\r\n\r\nbizagi.rendering.actionLauncher.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template;\r\n        var def = new $.Deferred();\r\n\r\n        self.actions = [];\r\n        self.configureQueueVisibility();\r\n        self.startLoading();\r\n\r\n        // Define params to get list of actions        \r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n            .then(function (response) {\r\n                response = self.getPropertiesActionLaucher(response);\r\n                self.actions = response;\r\n                self.deferredActions.resolve(response);\r\n\r\n                if (properties.isHorizontal) {\r\n                    if (properties.templatetype != \"none\") {\r\n                        return self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n                            .then(function (templateData) {\r\n                                return self.engine.render($.extend(templateData, {\r\n                                    isDefaultTemplate: properties.templatetype === \"default\",\r\n                                    sessionId: self.properties.sessionId\r\n                                }), $.extend({}, self.processPropertyValueDataTmplArgs, {formParams: self.getFormParams(self.getFormContainer())}));\r\n                            }).then(function (tmpl) {\r\n                                template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                var html = $($.kendoTmpl(template, {\r\n                                    actions: self.actions,\r\n                                    template: true\r\n                                }));\r\n\r\n                                $(\".template-container\", html.wrap(\"<div>\").parent()).append(tmpl);\r\n                                return html;\r\n                            });\r\n                    } else {\r\n                        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        return $.kendoTmpl(template, {\r\n                            actions: self.actions\r\n                        });\r\n                    }\r\n                } else {\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                    return $.kendoTmpl(template, {\r\n                        actions: self.actions,\r\n                        allowSearch: properties.allowSearch,\r\n                        maxItems: properties.maxItems\r\n                    });\r\n                }\r\n\r\n            }).done(function (html) {\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\r\n                self.endLoading();\r\n\r\n                actionsContainer.append(html);\r\n                self.configureHandlers();\r\n\r\n                self.configureTemplateHandlers();\r\n\r\n                def.resolve(actionsContainer);\r\n            }).fail(function (error) {\r\n                self.endLoading();\r\n                def.fail(error);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * \r\n    */\r\n    getFormParams: function (form) {\r\n        if (form.parent){\r\n            return this.getFormParams(form.parent.getFormContainer());\r\n        }\r\n        else{\r\n            return form.getParams();\r\n        }\r\n        \r\n    },\r\n\r\n    /**\r\n     * Validates if the action launcher control contains a valid value\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n        return typeof value !== \"undefined\" && value !== null && value.length > 0;\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionLauncherControls = $(\".action-launcher-control\", control);\r\n\r\n        //Binding for click action on buttons\r\n        actionLauncherControls.on(\"click\", function () {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\r\n                readOnlyForm: item[6] || false,\r\n                guidEntity: self.properties.guidEntity,\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            self.processAction(action);\r\n        });\r\n\r\n        var actions = [];\r\n        for (var i = 0, length = self.actions.length; i < length; i++) {\r\n            actions.push({\r\n                guid: self.actions[i][0],\r\n                displayName: self.actions[i][1]\r\n            });\r\n        }\r\n\r\n\r\n        //Binding for click action sheet\r\n        $(\".wp-action-more\", control).actionSheet({\r\n            actions: actions,\r\n            actionClicked: function (action) {\r\n                var item = self.actions.find(function (element) {\r\n                    return element[0] == action.guid;\r\n                });\r\n\r\n                self.processAction({\r\n                    guidProcess: item[0],\r\n                    guidAction: item[4],\r\n                    displayName: item[1],\r\n                    actionType: item[3],\r\n                    xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\r\n                    readOnlyForm: item[6] || false,\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                });\r\n            }\r\n        });\r\n\r\n        //Catch the typed text in the search field and filter the action list\r\n        $.expr[\":\"].FilterAction = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) {\r\n                return false;\r\n            }\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".action-launcher-control\", control).show();\r\n            if (search) {\r\n                $(\".action-launcher-control\", control)\r\n                    .not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     */\r\n    configureTemplateHandlers: function () {\r\n        var self = this;\r\n\r\n        //Catch the event from the layout link\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\r\n            params.filters = [];\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     */\r\n    processAction: function (action) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties.multipleSelection;\r\n\r\n        if (multipleSelection) {\r\n            // If this is a form and has been queued, so open it\r\n            if (action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                //Open action\r\n                $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        } else if (self.getValue().length > 0) {\r\n            self.showConfirmationDialog(action);\r\n        } else {\r\n            $.when(self.actionManager(action)).done(function (act) {\r\n                self.executeAction(act);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @param action\r\n     */\r\n    notifyExecution: function (data, action) {\r\n        var self = this;\r\n\r\n        if (data.response == \"success\") {\r\n            $.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        } else {\r\n            $.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionForm: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getParams();\r\n\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    if (!action.editMode && self.countSameActions(action) === 0) {\r\n                        action.idStartScope = savedData.IdScope;                        \r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        var renderParams = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        };\r\n\r\n        if (action.actionType === \"Form\") {\r\n            renderParams.contextType = \"entitytemplate\";\r\n            renderParams.xpathContext = undefined;\r\n            renderParams.guidEntity = action.guidEntity;\r\n            renderParams.rewriteContextType = true;\r\n        }\r\n\r\n        slideForm.render(renderParams);\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionFormCollection: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext !== \"\") ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext !== \"\") ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\r\n        var formParams = form.getParams();\r\n\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                if (action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).done(function (savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).done(function (savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": formParams.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function (args) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        // Show dialog\r\n        var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\r\n            title: args.title || \"\",\r\n            navigation: formParams.navigation,\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\")\r\n                ? bizagi.localization.getResource(\"render-form-button-create\")\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n        // Render the search form\r\n        slideForm.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     */\r\n    executeAction: function (action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function () {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the confirmation dialog\r\n     * bizagi.createOkCancelPopup\r\n     * @param action\r\n     * */\r\n    showConfirmationDialog: function (action) {\r\n        var self = this;\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\r\n        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n            .done(function () {\r\n                self.setValue([]);\r\n\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        $.when(self.deferredActions).done(function (listOfActions) {\r\n            var getMappingAction = function (guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function (key, value) {\r\n                    if (value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n\r\n                return mapping;\r\n\r\n            };\r\n\r\n            $.each(data, function (key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if (data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if (data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if (data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n\r\n            $.when($.kendoTmpl(template, { actions: data })).done(function (html) {\r\n                actionsToExecuteContainer.empty();\r\n                actionsToExecuteContainer.append(html);\r\n\r\n                var removeActionSelector = $(\".action-to-execute-control .delete-action\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n\r\n                removeActionSelector.on(\"click\", function () {\r\n                    var index = $(this).parent().data(\"index\");\r\n                    self.removeActionToQueue(index);\r\n                });\r\n\r\n                openActionSelector.on(\"click\", function () {\r\n                    var target = $(this).parent();\r\n                    var type = target.data(\"actiontype\");\r\n                    var guidprocess = target.data(\"guidprocess\");\r\n                    var idStartScope = target.data(\"idstartscope\");\r\n                    var title = target.data(\"title\");\r\n                    // When undefined return string \"undefined\" instead of type \"undefined\"\r\n                    var xpathContext = target.data(\"xpathcontext\");\r\n                    var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                    var idEntity = target.data(\"identity\") || \"\";\r\n                    var guidAction = target.data(\"guidaction\");\r\n                    var recordXpath = xpathContext || self.properties.xpathContext;\r\n                    switch (type) {\r\n                        case \"Process\":\r\n                            if (idStartScope) {\r\n                                self.processStartForm({\r\n                                    guidprocess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    title: title,\r\n                                    xpathContext: xpathContext,\r\n                                    recordXpath: recordXpath\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"Form\":\r\n                            var action = {\r\n                                guidProcess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                editMode: true,\r\n                                xpathContext: xpathContext,\r\n                                readOnlyForm: readOnlyForm,\r\n                                idEntity: idEntity,\r\n                                recordXpath: recordXpath\r\n                            };\r\n\r\n                            if (action.xpathContext) {\r\n                                self.processActionFormCollection(action);\r\n                            } else {\r\n                                // Convert string \"undefined\" into type \"undefined\"\r\n                                action.xpathContext = undefined;\r\n\r\n                                // Add parameters if action form\r\n                                var extraParams = {};\r\n                                var dataAction = self.value.filter(function (item) {\r\n                                    return item.guidAction == guidAction;\r\n                                });\r\n\r\n                                if (dataAction.length > 0) {\r\n                                    extraParams = {\r\n                                        actionType: \"Form\",\r\n                                        contextType: \"entitytemplate\",\r\n                                        guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                    }\r\n                                }\r\n\r\n                                self.processActionForm($.extend(action, extraParams));\r\n                            }\r\n                            break;\r\n                        case \"Rule\":\r\n                            // Rules dont have forms or something like that\r\n                            break;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".action-to-execute-label\", control);\r\n\r\n        if (self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/**\r\n * Tablet definition of entity template\r\n *\r\n * @author: Ricardo Pérez\r\n */\r\n\r\nbizagi.rendering.actionLauncher.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for smartphone device\r\n     */\r\n    postRenderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        self.actions = [];\r\n\r\n        self.getArrowContainer().hide();\r\n        self.configureQueueVisibility();\r\n\r\n        self.startLoading();\r\n\r\n        // Define params to get template               \r\n        self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n            .then(function(templateData) {\r\n                return self.engine.render(templateData, self.processPropertyValueDataTmplArgs)\r\n                    .then(function(tmpl) {\r\n                        var template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        if (properties.allowactions) {\r\n                            return self.dataService.multiaction().getActions(self.processPropertyValueArgs)\r\n                                .then(function(response) {\r\n                                    self.deferredActions.resolve(response);\r\n                                    self.actions = response;\r\n\r\n                                    var htmlTemplate = $($.kendoTmpl(template, {\r\n                                        actions: self.actions,\r\n                                        template: true\r\n                                    }));\r\n\r\n                                    $(\".template-container\", htmlTemplate.wrap(\"<div>\").parent()).append(tmpl);\r\n\r\n                                    return htmlTemplate;\r\n                                });\r\n                        } else {\r\n                            var htmlTemplate = $($.kendoTmpl(template, { template: true }));\r\n                            $(\".template-container\", htmlTemplate.wrap(\"<div>\").parent()).append(tmpl);\r\n\r\n                            return htmlTemplate;\r\n                        }\r\n                    });\r\n\r\n            }).done(function(html) {\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\r\n                self.endLoading();\r\n\r\n                actionsContainer.append(html);\r\n                self.configureHandlers();\r\n                self.configureTemplateHandlers();\r\n\r\n                def.resolve(actionsContainer);\r\n            }).fail(function(error) {\r\n                self.endLoading();\r\n                def.fail(error);\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n        /**\r\n         * Binding for click action on buttons\r\n         */\r\n        entityTemplateControls.on(\"click\", function() {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\"),\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            if (action.actionType === \"Form\") {\r\n                action.xpathContext = undefined;\r\n                action.contextType = \"entitytemplate\";\r\n                action.guidEntity = self.properties.guidEntity;\r\n            }\r\n\r\n            self.processAction(action);\r\n        });\r\n\r\n        var actions = [];\r\n        for (var i = 0, len = self.actions.length; i < len; i++) {\r\n            actions.push({\r\n                guid: self.actions[i][0],\r\n                displayName: self.actions[i][1]\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Binding for click action sheet\r\n         */\r\n        $(\".wp-action-more\", control).actionSheet({\r\n            actions: actions,\r\n            actionClicked: function(action) {\r\n                var item = self.actions.find(function(e) {\r\n                    return e[0] == action.guid;\r\n                });\r\n                self.processAction({\r\n                    guidProcess: item[0],\r\n                    guidAction: item[4],\r\n                    displayName: item[1],\r\n                    actionType: item[3],\r\n                    xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\")\r\n                });\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    configureTemplateHandlers: function() {\r\n        var self = this;\r\n        /**\r\n         * Catch the event from the layout link\r\n         */\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function(ev, params) {\r\n            params.filters = [];\r\n            params.calculateFilters = params.calculateFilters || true;\r\n\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Andres Felipe Arenas\r\n */\r\n\r\nbizagi.rendering.polymorphicLauncher.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Smartphone device\r\n     */\r\n    postRenderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n\r\n        if (mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        /**\r\n         * Define params to get list of actions\r\n         */\r\n        return $.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs))\r\n            .done(function(response) {\r\n                // Convert default response to tree data structure\r\n                response = self.dataService.serializePolymorphicActions(response);\r\n                self.totalActions = bizagi.clone(response);\r\n                var actions = bizagi.clone(response);\r\n                self.lessActions = bizagi.clone(actions);\r\n\r\n                // NOTE: Code extracted\r\n                var templateArguments = {\r\n                    actions: actions,\r\n                    allowSearch: properties.allowSearch,\r\n                    treeActionsList: self.getTreeItems(actions)\r\n                };\r\n                template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-polymorphic-launcher-constructors-container\", control);\r\n                actionsContainer.append($.kendoTmpl(template, templateArguments));\r\n                self.bindHandlers();\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Get rendered html of each node of constructors\r\n     * @param actions\r\n     * @param level\r\n     * @return {string}\r\n     */\r\n    getTreeItems: function (actions, level) {\r\n        var self = this;\r\n        var item = \"<ul>\";\r\n        var templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n        actions = actions || {};\r\n        level = level || 1;\r\n\r\n        $.each(actions, function (key, value) {\r\n            item += $.kendoTmpl(templateTreeItem, value);\r\n\r\n            if (value.children) {\r\n                item += self.getTreeItems(value.children, level + 1);\r\n            }\r\n        });\r\n        item += \"</ul>\";\r\n        return item;\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    bindHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionLauncherControls = $(\".bz-polymorphic-launcher-constructors-container li span\", control);\r\n\r\n        //Binding for click action on buttons\r\n        actionLauncherControls.on(\"click\", function () {\r\n            var $targetData = $(this).parent();\r\n            var action = {\r\n                guidEntity: $targetData.data(\"guidentity\"),\r\n                guidObject: $targetData.data(\"guidobject\"),\r\n                guidConstructor: $targetData.data(\"guidconstructor\"),\r\n                displayName: $targetData.data(\"display-name\"),\r\n                actionType: $targetData.data(\"action-type\"),\r\n                xpathContext: $targetData.data(\"xpathcontext\")\r\n            };\r\n            self.onActionClicked(action);\r\n        });\r\n        //Catch the typed text in the search field and filter the action list\r\n        $.expr[\":\"].FilterAction = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) {\r\n                return false;\r\n            }\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".bz-polymorphic-launcher-constructors-container li\", control).show();\r\n            if (search) {\r\n                $(\".bz-polymorphic-launcher-constructors-container li\", control).not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n\r\n    },\r\n    /**\r\n     * Execute an Action\r\n     * @param action\r\n     */\r\n    onActionClicked: function (action) {\r\n        var self = this;\r\n\r\n        $.when(self.actionManager(action)).done(function (act) {\r\n            self.executeAction(act);\r\n        });\r\n    },\r\n    /**\r\n     * Show a message when action has been executed\r\n     * @param status\r\n     * @param action\r\n     */\r\n    notifyExecution: function (status, action) {\r\n        var self = this;\r\n        if (status == \"success\") {\r\n            $.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n\r\n        } else {\r\n            $.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Show a dialog with a form\r\n     * @param action\r\n     * @return {*}\r\n     */\r\n    processActionForm: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = action.xpathContext || \"\";\r\n        var formParams = form.getParams();\r\n\r\n        var recordXpath = self.properties.recordXpath;\r\n\r\n        // Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                var pageCache = data.idPageCache;\r\n                data.idPageCache = null;\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext, //self.properties.xpathContext,\r\n                    idPageCache: pageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    if (!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            \"idForm\": action.guidObject,\r\n            \"contextType\": \"entity\",\r\n            \"guidEntity\": action.guidEntity,\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            //\"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"recordXpath\": recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var def = new $.Deferred();\r\n        var formParams = form.getParams();\r\n        args = args || {};\r\n\r\n\r\n        var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\r\n            //showSaveButton: properties.editable,\r\n            maximized: properties.maximized,\r\n            title: args.title || \"\",\r\n            navigation: formParams.navigation,\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\")\r\n                ? bizagi.localization.getResource(\"render-form-button-create\")\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function (data) {\r\n                form.startLoading();\r\n\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    form.endLoading();\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Execute and action if a form is global form or summary, or send to queue\r\n     * @param action\r\n     */\r\n    executeAction: function (action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\t    \r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function () {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function (action) {\r\n        var self = this;\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\t\r\n\r\n        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n            .done(function () {\r\n                self.setValue([]);\r\n\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n        self.configureQueueVisibility();\r\n\r\n        $.when($.kendoTmpl(template, { actions: data })).done(function (html) {\r\n            actionsToExecuteContainer.empty();\r\n            actionsToExecuteContainer.append(html);\r\n            var removeActionSelector = $(\".action-to-execute-control .delete-action\", actionsToExecuteContainer);\r\n            var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n            removeActionSelector.on(\"click\", function () {\r\n                var index = $(this).parent().data(\"index\");\r\n                self.removeActionToQueue(index);\r\n            });\r\n            openActionSelector.bind(\"click\", function () {\r\n                var $target = $(this).parent();\r\n                var type = $target.data(\"actiontype\");\r\n                var guidprocess = $target.data(\"guidprocess\");\r\n                var idStartScope = $target.data(\"idstartscope\");\r\n                var title = $target.data(\"title\");\r\n                var xpathContext = $target.data(\"xpathcontext\");\r\n                var idEntity = $target.data(\"identity\") || \"\";\r\n                var guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n                switch (type) {\r\n                    case \"Process\":\r\n                        if (idStartScope) {\r\n                            self.processStartForm({\r\n                                guidprocess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                title: title,\r\n                                xpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n                            });\r\n                        }\r\n                        break;\r\n                    case \"Form\":\r\n                        var action = {\r\n                            guidProcess: guidprocess,\r\n                            idStartScope: idStartScope,\r\n                            editMode: true,\r\n                            xpathContext: xpathContext,\r\n                            idEntity: idEntity,\r\n                            guidEntity: guidEntity,\r\n                            guidObject: guidprocess\r\n                        };\r\n\r\n                        self.processActionForm(action);\r\n                        break;\r\n                    case \"Rule\":\r\n                        // Rules dont have forms or something like that\r\n                        break;\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n        if (self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Text Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the text render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.text.extend(\"bizagi.rendering.text\", {}, {\r\n    /**\r\n     *\r\n     */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        self.input = (control.find(\"input\").length != 0) ? control.find(\"input\") : control.find(\".bz-rn-non-editable\");\r\n\r\n        // Define max length of element\r\n        if (properties.maxLength > 0) {\r\n            self.input.attr(\"maxlength\", properties.maxLength);\r\n        }\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            self.input.attr(\"readonly\", \"readonly\");\r\n        } else {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.input.removeAttr(\"readonly\");\r\n            self.configureHandlers();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Creates the markup for the readonly text field\r\n     * Comment: includes the default value in the markup\r\n     * @returns {html}\r\n     */\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * Readonly\r\n     * @returns {} \r\n     */\r\n    postRenderSingle: function () {\r\n        //Attach event for retype double\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._super();\r\n\r\n        if (properties.retype == \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n\r\n        // Implement maxlength behaviour (in android lets you write more chars than allowed)\r\n\r\n        var element = self.element;\r\n        var input = $(\"input\", element);\r\n\r\n        if (!input || input.length === 0) return;\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        self.setValue(value, false);\r\n\r\n        // This is temporal\r\n        if (typeof (value) == \"object\") return;\r\n        value = typeof (value) == \"boolean\" ? value.toString() : value;\r\n\r\n        if (typeof (value) === \"string\") {\r\n            value = value.replaceAll(\"\\\\n\", \" \").replaceAll(\"\\n\", \" \");\r\n            value = value.replaceAll(\"&amp;\", \"&\");\r\n\r\n            if (self.properties.editable) {\r\n                self.input.first().html(value);\r\n                self.input.first().val(value);\r\n            } else {\r\n                self.input.text(value);\r\n            }\r\n        }\r\n    },\r\n\r\n    setDisplayValueEdit: function (value) {\r\n        var self = this;\r\n        self.inputEdition.val(value);\r\n    },\r\n\r\n    actionSave: function () {\r\n        var self = this;\r\n        var value = self.inputEdition.val();\r\n\r\n        self.setValue(value, false);\r\n        self.input.html(value);\r\n        self.input.val(value);\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"text\";\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            if ($(control).attr(\"type\") !== \"hidden\" &&\r\n                $(control).css(\"display\") !== \"none\" &&\r\n                $(control).css(\"visibility\") !== \"hidden\") {\r\n\r\n                if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                    // Check that there is something in the value\r\n                    // Check if a value has already been set\r\n                    if (control.val() === \"\" || control.val() === control.attr(\"newValue\"))\r\n                        return;\r\n\r\n                    control.data(\"oldValue\", control.val());\r\n                    control.val(\"\");\r\n\r\n                    try {\r\n                        // Create new tooltip\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n                    }\r\n\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype\")); //\"Re-escriba el valor\"\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n\r\n                    // Focus after 100ms to avoid bubbling\r\n                    setTimeout(function () {\r\n                        control.focus();\r\n                        input.focus();\r\n                    }, 100);\r\n                } else {\r\n                    if (control.val() !== control.data(\"oldValue\")) {\r\n                        self.setValue(\"\");\r\n                        control.val(\"\");\r\n                        control.data(\"oldValue\", \"\");\r\n                        control.tooltip(\"destroy\");\r\n                        control.attr(\"title\", self.getResource(\"render-text-retype-error\"));\r\n                        control.tooltip();\r\n                        control.tooltip(\"open\");\r\n\r\n                        setTimeout(function () {\r\n                            control.focus();\r\n                        }, 100);\r\n                    } else {\r\n                        control.data(\"newValue\", control.val());\r\n                        control.data(\"oldValue\", \"\");\r\n\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: BizAgi Tablet Render Text Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments: Extended text implementation\r\n */\r\nbizagi.rendering.extendedText.extend(\"bizagi.rendering.extendedText\", {\r\n    TEXTAREA_LINE_HEIGHT: 14\r\n}, {\r\n    /**\r\n     * Creates the markup for the readonly extendedText field\r\n     * Comment: includes the default value in the markup\r\n     * @returns {html}\r\n     */\r\n    renderReadOnly: function() {\r\n        var template = this.renderFactory.getTemplate(\"readonlyExtendedText\");\r\n        // Render template\r\n        return $.kendoTmpl(template);\r\n    },\r\n\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        self.element = container;\r\n\r\n        if (!properties.editable) {\r\n            self.input = container.find(\".bz-rn-text-extended pre\");\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            self.input = container.find(\".bz-rn-text-extended\");\r\n            container.addClass(\"bz-command-edit-inline\");\r\n\r\n            $(self.input).bind(\"keyup\", function() {\r\n                self.calculateHeight(this);\r\n                self.setValue(self.input.val(), false);\r\n            });\r\n        }\r\n    },\r\n\r\n    postRenderSingle: function() {\r\n        //Attach event for retype double\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.textarea = control.find(\"textarea\");\r\n\r\n        // Set the default maxlenght for the input if is 0 or undefined set to infinity\r\n        // this resolve issue with scope strings that don't have maxlength\r\n        if (properties.maxLength > 0)\r\n            self.textarea.prop(\"maxlength\", properties.maxLength);\r\n\r\n        if (properties.maxLines) {\r\n            self.hasMaxLines = true;\r\n            self.textarea.prop(\"rows\", properties.maxLines);\r\n        } else {\r\n            self.hasMaxLines = false;\r\n            self.textarea.prop(\"rows\", 6);\r\n        }\r\n\r\n        self._super();\r\n    },\r\n\r\n    /**\r\n     *  SET DISPLAY VALUE\r\n     *\r\n     */\r\n    setDisplayValue: function(value) {\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = typeof decodedValue == \"string\" ? decodedValue : \"\";\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (value && properties.editable) {\r\n            var resolvedValue = $.br2nl(value);\r\n            self.textarea.val(resolvedValue);\r\n\r\n            if (!self.hasMaxLines) {\r\n                var rows = self.input.val().split(\"\\n\");\r\n                self.input.prop(\"rows\", rows.length + 1);\r\n            }\r\n        }\r\n    },\r\n\r\n    renderEdition: function () {\r\n    },\r\n\r\n    setDisplayValueEdit: function (value) {\r\n    },\r\n\r\n    actionSave: function () {\r\n    },\r\n\r\n    calculateHeight: function(input) {\r\n        var self = this;\r\n        var textarea = input;\r\n        var newHeight = textarea.scrollHeight;\r\n        var currentHeight = textarea.clientHeight;\r\n\r\n        if (newHeight > currentHeight && !self.hasMaxLines) {\r\n            $(textarea).css(\"height\", newHeight + 2 * self.Class.TEXTAREA_LINE_HEIGHT + \"px\");\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Smartphone Render Label Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.label.extend(\"bizagi.rendering.label\", {}, {\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        properties.editable = false;\r\n        self.getArrowContainer().hide();\r\n\r\n        if (!self.properties.editable)\r\n            self.getContainerRender().addClass(\"bz-rn-non-editable\");\r\n\r\n        container.addClass(\"ui-bz-rn-label-only\");\r\n\r\n        this._super();\r\n    }\r\n});","/*\r\n*   Name: Bizagi smartphone Render Number Extension\r\n*   Author: Bizagi Mobile Team \r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.number.extend(\"bizagi.rendering.number\", {}, {\r\n \r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonlyNumber\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n    \r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        if (!properties.editable) {\r\n            self.numericInput = self.input = control.find(\".ui-bizagi-render-numeric\");\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            container.find(\"i\").addClass(\"bz-rn-icon-readonly\").addClass(\"bz-mo-icon\").addClass(\"bz-number-icon\");\r\n        } else {\r\n            self.numericInput = self.input = control.find(\"input\");\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.input.removeAttr(\"readonly\");\r\n\r\n            //Adjust the input in order to accept the comma input as decimal for certain language standars\r\n            if(properties.decimalSymbol == ',') {\r\n                self.input.attr(\"lang\", \"en-150\");\r\n            }\r\n\r\n            self.configureHandlers();\r\n        }\r\n    },\r\n    \r\n    postRenderSingle: function () {\r\n        var self = this;        \r\n\r\n        self._super();\r\n\r\n        //Attach event for retype double\r\n        if (self.properties.retype === \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n    },\r\n  \r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._super();\r\n\r\n        if (!properties.editable && properties.percentage) {\r\n            self.numericInput.text(self.input.text() + \"%\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;        \r\n\r\n        self.setValue(value, false);\r\n        \r\n        if (!self.properties.editable) {\r\n            self.input.text(self.getDisplayValue());\r\n        } else {\r\n            self.input.html(value);\r\n            self.input.val(value);\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }        \r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var input = self.input;\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = input;\r\n        self.attachFormatCurrency();\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.input.numeric(self.properties.decimalSymbol);\r\n\r\n        self.input.blur(function () {\r\n            var inputValue = self.input.val();\r\n\r\n            if (inputValue === \"\" || !bizagi.util.isNumeric(inputValue) && self.properties.value === 0) {\r\n                self.setValue(\"\", false);\r\n\r\n                self.input.html(\"\");\r\n                self.input.val(\"\");\r\n            }\r\n        });\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n        var input = $(\"input\", element);\r\n\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n\r\n        if ($(control).attr(\"type\") !== \"hidden\" &&\r\n                $(control).css(\"display\") !== \"none\" &&\r\n                $(control).css(\"visibility\") !== \"hidden\") {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or \r\n                // if a value has already been set\r\n                if (control.val() === \"\" || control.val() === control.attr(\"newValue\"))\r\n                    return;\r\n\r\n                // Create new tooltip\r\n                control.data(\"oldValue\", control.val());\r\n                control.val(\"\");\r\n\r\n                try {\r\n                    control.tooltip(\"destroy\");\r\n                } catch (e) { }\r\n\r\n                // Re-type value\r\n                control.attr(\"title\", self.getResource(\"render-number-retype\"));\r\n\r\n                // Setup tooltip\r\n                control.tooltip();\r\n                control.tooltip(\"open\");\r\n\r\n                // Focus after 100ms to avoid bubbling\r\n                setTimeout(function () {\r\n                    control.focus();\r\n                }, 100);\r\n\r\n            } else {\r\n\r\n                // Check that there is something in the value\r\n                if (control.val() === \"\") {\r\n                    return;\r\n                }\r\n\r\n                if (control.val() !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    control.val(\"\");\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype-fail\"));\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n\r\n                    setTimeout(function () {\r\n                        control.focus();\r\n                    }, 100);\r\n\r\n                } else {\r\n                    control.data(\"newValue\", control.val());\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n                }\r\n            }\r\n        }\r\n    }\r\n});","/*\r\n*   Name: Bizagi Rendering Smartphone numberScientificNotation\r\n*   Author: Luis Cabarique - LuisCE\r\n*   Comments:\r\n*   -   This script will define a base class to define the Scientific number notation\r\n*/\r\n\r\nbizagi.rendering.numberScientificNotation.extend(\"bizagi.rendering.numberScientificNotation\", {}, {\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        self.inputDisplay = $(\"input\", control).first();\r\n        self.numericInput = self.input = (control.find(\"input\").length > 1) ? $(\"input\", control).last() : control.append(\"<span class=\\\"bz-rn-non-editable bz-rn-align-class bz-rn-text\\\"></span>\").find(\"span\");\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n        // Attach Format Currency Plugin to format the input\r\n        self.attachFormatSientificNotation();\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            self.numericInput.addClass(\"bz-rn-icon-readonly\").addClass(\"bz-mo-icon\").addClass(\"bz-specialnumbers-input\");\r\n            self.numericInput.attr(\"readonly\", \"readonly\");\r\n            self.inputDisplay.attr(\"readonly\", \"readonly\");\r\n        } else {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.numericInput.removeAttr(\"readonly\");\r\n            self.inputDisplay.removeAttr(\"readonly\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = bizagi.util.scientificNotationFormat(value, properties.decimalSymbol, 38);\r\n        var displayValue = bizagi.util.scientificNotationFormat(value, properties.decimalSymbol, 15);\r\n\r\n        // Set value in input\r\n        self.numericInput.val(value);\r\n        self.inputDisplay.val(displayValue);\r\n        self.numericInput.html(displayValue);\r\n        self.value = self.properties.value = value;\r\n    },\r\n\r\n    attachFormatSientificNotation: function () {\r\n        var self = this;\r\n\r\n        self.inputDisplay.focus(function () {\r\n            $(this).val(self.getDisplayValue());\r\n        });\r\n\r\n        // Attach events\r\n        self.inputDisplay.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n\r\n            var scientificNotationNumber = bizagi.util.scientificNotationFormat(self.inputDisplay.val(), self.properties.decimalSymbol, 38);\r\n            var scientificNotationNumberDisplay = bizagi.util.scientificNotationFormat(self.inputDisplay.val(), self.properties.decimalSymbol, 15);\r\n\r\n            self.numericInput.val(scientificNotationNumber);\r\n            self.inputDisplay.val(scientificNotationNumberDisplay);\r\n\r\n            // Updates internal value\r\n            self.setValue(scientificNotationNumber);\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi smartphone Render Money Extension\r\n*   Author: OscarO\r\n*   Comments:\r\n*   -   This script will redefine the money render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.money.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var value = self._super();\r\n        var template = self.renderFactory.getTemplate(\"readonlyNumber\");\r\n        var tmpl = $($.kendoTmpl(template, {value: value}));\r\n        $(\".bz-rn-icon\", tmpl).removeClass(\"bz-rn-icon-number\").removeClass(\"bz-number-icon\").addClass(\"bz-coin-input\").addClass(\"bz-rn-icon-coin\");\r\n\r\n        return tmpl.get(0).outerHTML;\r\n    },\r\n\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        if (!properties.editable) {\r\n            self.numericInput = self.input = control.find(\".ui-bizagi-render-numeric\");\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            self.numericIcon = $(\"span\", control);\r\n            self.numericIcon.removeClass(\"bz-number-icon\").addClass(\"bz-coin-input\");\r\n\r\n            self.numericInput = self.input = control.find(\"input\");\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.input.removeAttr(\"readonly\");\r\n\r\n            //Adjust the input in order to accept the comma input as decimal for certain language standars\r\n            if(properties.decimalSymbol == ',') {\r\n                self.input.attr(\"lang\", \"en-150\");\r\n            }\r\n\r\n            self.configureHandlers();\r\n        }\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        self._super();\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.setValue(value, false);\r\n        \r\n        if (!properties.editable) {\r\n            self.input.text(value);\r\n        } else {\r\n            self.input.html(value);\r\n            self.input.val(value);\r\n        }\r\n\r\n        self.executeFormatCurrencyPlugin();\r\n    },\r\n\r\n    // override\r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.input.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var input = self.input;\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = input;\r\n        self.attachFormatCurrency();\r\n        self.executeFormatCurrencyPlugin();\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.input.numeric(self.properties.decimalSymbol);\r\n\r\n        self.input.blur(function () {\r\n            var inputValue = self.input.val();\r\n            if (inputValue === \"\" || !bizagi.util.isNumeric(inputValue) && self.properties.value === 0) {\r\n                self.setValue(0, false);\r\n                self.input.html(0);\r\n                self.input.val(0);\r\n                self.executeFormatCurrencyPlugin();\r\n            }\r\n        });\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"text\";\r\n    }\r\n});","/**\r\n *   Name: Bizagi smartphone Render Date Extension\r\n *   Author: Cristian Olaya\r\n *   Date: 2015-sep-23\r\n */\r\nbizagi.rendering.date.extend(\"bizagi.rendering.date\", {\r\n    DEFAULT_PROPERTIES: { \"maxYearsToDisplay\": 100 }\r\n}, {\r\n    /**\r\n     *  Rendering the control\r\n     * */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        if (!properties.editable) {\r\n            // If isn't a editable control, then show a non editable span\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            // Getting the input\r\n            self.input = control.find(\"span\").addClass(\"bz-rn-date-control\");\r\n        } else {\r\n            // Getting the input\r\n            self.input = self.getDateControl();\r\n        }\r\n    },\r\n\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * To configure the mobiscroll plugin\r\n     * */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n\r\n        //Call Base\r\n        self._super();\r\n\r\n        var inputControl = self.getDateControl();\r\n        var controlElements = self.properties.showTime ? [\"calendar\", \"time\"] : [\"calendar\"];\r\n        var defaultDateControl = self.getFormattedDate(self.properties.value, self.properties.showTime, true);\r\n        var minDateControl = self.getFormattedDate(self.properties.minValue, self.properties.showTime, false);\r\n        var maxDateControl = self.getFormattedDate(self.properties.maxValue, self.properties.showTime, false);\r\n        var timeFormat = self.properties.showTime ? self.getTimeFormat() : \"\";\r\n\r\n        //Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(minDateControl))) {\r\n            minDateControl = new Date();\r\n            minDateControl.setFullYear(minDateControl.getFullYear() - self.Class.DEFAULT_PROPERTIES.maxYearsToDisplay);\r\n            minDateControl.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        //Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(maxDateControl))) {\r\n            maxDateControl = new Date();\r\n            maxDateControl.setFullYear(maxDateControl.getFullYear() + self.Class.DEFAULT_PROPERTIES.maxYearsToDisplay);\r\n            maxDateControl.setHours(23, 59, 59);\r\n        }\r\n\r\n        $(\".bz-calendar-input\", self.control).click(function () {\r\n            inputControl.click();\r\n        });\r\n\r\n        if (!self.isValidMinMaxValue()) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            self.properties.displayValue = \"\";\r\n        }\r\n\r\n        inputControl.mobiscroll().calendar({\r\n            mode: \"mixed\", // Specify scroller mode like: mode: 'mixed' or omit setting to use default\r\n            display: \"bottom\", // Specify display mode like: display: 'bottom' or omit setting to use default\r\n            controls: controlElements,\r\n            min: minDateControl,\r\n            max: maxDateControl,\r\n            defaultValue: defaultDateControl,\r\n            timeFormat: timeFormat,\r\n            showScrollArrows: true,\r\n            lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n            buttons: [\r\n            \"set\",\r\n            {\r\n                text: this.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n                handler: function (e, inst) {\r\n                    self.date = undefined;\r\n                    self.time = undefined;\r\n                    self.timeS = undefined;\r\n                    self.onChangeHandler(true);\r\n                    inst.clear();\r\n                }\r\n            },\r\n            \"cancel\"\r\n            ],\r\n            onSet: function (valueText, inst) {\r\n                var data = inst.getVal();\r\n                self.date = { \"day\": data.getDate(), \"month\": data.getMonth(), \"year\": data.getFullYear() };\r\n\r\n                //Checks if its has time, and included it\r\n                if (self.properties.showTime) {\r\n                    self.time = { \"hours\": data.getHours(), \"minutes\": data.getMinutes() };\r\n                    if (!self.is24h) {\r\n                        self.timeS = data.getHours() < 12 ? \"am\" : \"pm\";\r\n                    }\r\n                }\r\n\r\n                self.onChangeHandler();\r\n            },\r\n            onBeforeShow: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n\r\n                //TODO temporal fix in ios smartphone when a notification container is already displayed (QAF-6385 / MOB-171), review mobiscroll.min versions\r\n                if (bizagi.util.isiOSDevice()) {\r\n                    $(\".ui-bizagi-notifications-container\").css(\"display\", \"none\");\r\n                }\r\n            },\r\n            onClose: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"auto\");\r\n            },\r\n            onShow: function (event, inst) {\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"hidden\");\r\n            }\r\n        });\r\n\r\n        // Bind event for change value\r\n        inputControl.on(\"focus\", function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isAndroidDevice()) {\r\n                cordova.plugins.Keyboard.disableScroll(true);\r\n                cordova.plugins.Keyboard.close();\r\n            }\r\n        });\r\n\r\n        //Set input displayValue if it has default value\r\n        if (self.properties.displayValue === \"\" && self.properties.value) {\r\n            var date = self.getFormattedDate(self.properties.value, self.properties.showTime, true, false);\r\n            var displayValue = bizagi.util.dateFormatter.formatDate(date, self.properties.fullFormat);\r\n            self.input.prop(\"value\", displayValue);\r\n        }\r\n\r\n        inputControl.attr(\"keyboard\", \"disable\");\r\n    },\r\n\r\n    /**\r\n     * Configure the timeformat\r\n     * */\r\n    getTimeFormat: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.timeFormat.indexOf(\"H\") !== -1 || self.properties.timeFormat.indexOf(\"HH\") !== -1) {\r\n            self.is24h = true;\r\n            return \"HH:ii\";\r\n        } else {\r\n            self.is24h = false;\r\n            return \"hh:ii A\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date whit the Invariant and ISO Format applied.\r\n     * */\r\n    getFormattedDate: function (date, showTime, initializer) {\r\n        var self = this;\r\n\r\n        if (!date || bizagi.util.isObjectEmpty(date)) return;\r\n\r\n        //There are some dates that haven't time,... actions and validations for example or when we have to put a initial value (default value without time),\r\n        //in that cases we should identify the case and if the date haven't the time value, we have to add (00:00:00) it to can apply the format (getDateFromInvariant).\r\n        var time = (showTime && (self.getTime() === \"0:0\" || initializer)) ? \" \" +\r\n        date.substr(date.length - 8, date.length) : \"\";\r\n        date = bizagi.util.dateFormatter.getDateFromInvariant(((initializer && showTime && time.split(\"/\").length > 1) || (date.split(\":\").length === 1)) ?\r\n        date += \" 00:00:00\" : date, showTime);\r\n\r\n        var fullDateFormated = self.setHour(self.getFullFormatedDate(date, showTime ? time !== \"\" ? time : \" \" + self.getTime() : \" 00:00\"));\r\n        fullDateFormated = bizagi.util.dateFormatter.getDateFromISO(fullDateFormated, true);\r\n\r\n        return fullDateFormated;\r\n    },\r\n\r\n    /*\r\n     *   Changes the render min value\r\n     */\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', { min: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', { min: bizagi.util.dateFormatter.getDateFromInvariant(value, true) });\r\n            }\r\n\r\n            properties.minValue = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the render max value\r\n     */\r\n    changeMaxValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', { max: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', { max: bizagi.util.dateFormatter.getDateFromInvariant(value, true) });\r\n            }\r\n\r\n            properties.maxValue = value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Set the display value on input\r\n     * */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var date = self.getFormattedDate(value, properties.showTime, false);\r\n        var displayValue = self.preprocessDateValue(date);\r\n\r\n        if (properties.editable) {\r\n            self.input.html(displayValue);\r\n            self.input.prop(\"value\", displayValue);\r\n        } else {\r\n            self.input.text(displayValue);\r\n        }\r\n    },\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.date = undefined;\r\n        self.time = undefined;\r\n        self.timeS = undefined;\r\n        self.onChangeHandler(true);\r\n        self.setDisplayValue('');\r\n    },\r\n\r\n    /**\r\n     * Get the DOM Control\r\n     * */\r\n    getDateControl: function () {\r\n        var self = this;\r\n\r\n        return $(\"input.bz-rn-date-control\", self.getControl());\r\n    },\r\n\r\n    /**\r\n     * Get Time from mobiscroll\r\n     */\r\n    getTime: function () {\r\n        var self = this;\r\n\r\n        //Converting the time in 24h format.\r\n        if (self.properties.showTime && (self.time && self.time[\"minutes\"] !== \"\")) {\r\n            var time = self.time[\"hours\"] + \":\" + self.time[\"minutes\"];\r\n            time += self.timeS;\r\n\r\n            if (time.indexOf(\"am\") != -1 && self.time[\"hours\"] == 12) {\r\n                time = time.replace(\"12\", \"0\");\r\n            }\r\n\r\n            if (time.indexOf(\"pm\") != -1 && self.time[\"hours\"] < 12) {\r\n                time = time.replace(self.time[\"hours\"], (parseInt(self.time[\"hours\"]) + 12));\r\n            }\r\n\r\n            return time.replace(/(am|pm)/, '');\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date from mobiscroll\r\n     * */\r\n    getDate: function () {\r\n        var self = this;\r\n        return (self.date && self.date[\"month\"] !== \"\") ? self.date[\"year\"] + \"-\" + (parseInt(self.date[\"month\"]) + 1) + \"-\" + self.date[\"day\"] : \"\";\r\n    },\r\n\r\n    /**\r\n     * Set the control value when the control change\r\n     */\r\n    onChangeHandler: function (isClearButton) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentDate = self.getDate();\r\n        var currentTime = (properties.showTime) ? \" \" + self.getTime() : \" 0:00\";\r\n\r\n        // If curren date is empty reset actual value\r\n        if ((currentDate === \"\" && !properties.showTime) || (currentDate === \"\" && currentTime === \"\") || (isClearButton)) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            properties.displayValue = \"\";\r\n        } else {\r\n            var displayValue;\r\n            var formattedDate = self.setHour(self.getFullFormatedDate(currentDate, currentTime));\r\n            var fullFormattedDate = bizagi.util.dateFormatter.getDateFromISO(formattedDate, true);\r\n\r\n            if (!fullFormattedDate || fullFormattedDate === 0) return;\r\n\r\n            // Set date value\r\n            self.setNewDateValue(fullFormattedDate, properties.showTime);\r\n\r\n            displayValue = self.preprocessDateValue(fullFormattedDate);\r\n            properties.displayValue = displayValue;\r\n            self.input.prop('value', self.properties.displayValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply the final format that will be showed on the input\r\n     * */\r\n    getFullFormatedDate: function (currentDate, currentTime) {\r\n        var fullDate = \"\";\r\n\r\n        if (currentDate.length > 0) {\r\n            fullDate = currentDate;\r\n        } else if (currentDate !== undefined) {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(currentDate, false);\r\n        } else {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(new Date(), false);\r\n        }\r\n\r\n        fullDate += currentTime;\r\n        var dateFromFormat = bizagi.util.dateFormatter.getDateFromFormat(fullDate, \"yyyy-MM-dd H:m\");\r\n\r\n        return bizagi.util.dateFormatter.formatDate(dateFromFormat !== 0 ? dateFromFormat : currentDate, \"yyyy-MM-dd H:mm:ss\");\r\n    },\r\n\r\n    /**\r\n     * Set the control value\r\n     * */\r\n    setNewDateValue: function (formatedFullDate, showTime) {\r\n        var self = this;\r\n        var value = formatedFullDate != \"\" ? bizagi.util.dateFormatter.formatInvariant(formatedFullDate, showTime) : \"\";\r\n        self.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Removing the time when be necesary\r\n     * */\r\n    applyDateFormat: function (date, showTime) {\r\n        if (!showTime) {\r\n            var initIndexTime = null;\r\n            if (date.indexOf(\"00:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"00:00\");\r\n            } else if (date.indexOf(\"0:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"0:00\");\r\n            } else if (date.indexOf(\"12:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"12:00\");\r\n            } else {\r\n                initIndexTime = \"-1\";\r\n            }\r\n\r\n            var endIndexTime = initIndexTime + 8;\r\n            date = initIndexTime === -1 ? date : date.replace(date.substring(initIndexTime, endIndexTime), \"\").replace(\" am\", \"\").replace(\" pm\", \"\");\r\n        }\r\n\r\n        return date;\r\n    },\r\n\r\n    /*\r\n     *  Checks if the date could be localized using site language\r\n     * */\r\n    preprocessDateValue: function (date) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat);\r\n\r\n        return displayValue;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable)) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n                if (value != 0) {\r\n                    // Clear time for validations\r\n                    value.setHours(0, 0, 0, 0);\r\n\r\n                    // Check min value and max value\r\n                    if (properties.minValue && typeof (properties.minValue) === 'string') {\r\n                        bValid = self.validateMinAndMaxValue(value, true, properties, invalidElements) ? false : bValid;\r\n                    }\r\n\r\n                    if (properties.maxValue && typeof (properties.maxValue) === 'string') {\r\n                        bValid = self.validateMinAndMaxValue(value, false, properties, invalidElements) ? false : bValid;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(properties.editable)) {\r\n            // Check required\r\n            if (properties.required && self.hasValue()) {\r\n                var control = self.getDateControl();\r\n\r\n                if (control.length > 0 && control.val().length <= 0) {\r\n                    bValid = self.showMandatoryMessage(properties, invalidElements);\r\n                }\r\n            } else if (properties.required && !self.hasValue()) {\r\n                self.showMandatoryMessage(properties, invalidElements);\r\n            }\r\n        }\r\n\r\n        if (bValid) {\r\n            // Clear error message\r\n            self.setValidationMessage(\"\");\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * To validate the min and max values\r\n     */\r\n    validateMinAndMaxValue: function (value, isMinValue, properties, invalidElements) {\r\n        var vValue = bizagi.util.dateFormatter.getDateFromInvariant(isMinValue ? properties.minValue : properties.maxValue);\r\n        vValue.setHours(0, 0, 0, 0);\r\n\r\n        if ((isMinValue && value < vValue) || (!isMinValue && value > vValue)) {\r\n            var message = isMinValue ?\r\n            this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat))\r\n            : this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat));\r\n\r\n            invalidElements.push({\r\n                xpath: properties.xpath,\r\n                message: message\r\n            });\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * To show the mandatory values message\r\n     * */\r\n    showMandatoryMessage: function (properties, invalidElements) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n\r\n        invalidElements.push({ xpath: properties.xpath, message: message });\r\n\r\n        return false;\r\n    },\r\n\r\n    setHour: function (date) {\r\n        return date.replace(\" 0:\", \" 00:\").replace(\" 1:\", \" 01:\").replace(\" 2:\", \" 02:\").replace(\" 3:\", \" 03:\").replace(\" 4:\", \" 04:\").replace(\" 5:\", \" 05:\").replace(\" 6:\", \" 06:\").replace(\" 7:\", \" 07:\").replace(\" 8:\", \" 08:\").replace(\" 9:\", \" 09:\");\r\n    },\r\n\r\n    isValidMinMaxValue: function () {\r\n        var self = this;\r\n        var isValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n            if (value !== 0) {\r\n                // Clear time for validations\r\n                value.setHours(0, 0, 0, 0);\r\n\r\n                // Check min value and max value\r\n                if (self.properties.minValue && typeof (self.properties.minValue) === 'string')\r\n                    isValid = self.validateMinAndMaxValue(value, true);\r\n\r\n                if (self.properties.maxValue && typeof (self.properties.maxValue) === 'string')\r\n                    isValid = self.validateMinAndMaxValue(value, false);\r\n            }\r\n        }\r\n\r\n        return isValid;\r\n    },\r\n\r\n    validateMinAndMaxValue: function (currentDate, isMinValue) {\r\n        var self = this;\r\n        var date = isMinValue ? self.properties.minValue : self.properties.maxValue;\r\n        var formattedDate = bizagi.util.dateFormatter.getDateFromInvariant(date);\r\n\r\n        formattedDate.setHours(0, 0, 0, 0);\r\n\r\n        return !((isMinValue && currentDate < formattedDate) || (!isMinValue && currentDate > formattedDate));\r\n\r\n    }\r\n});","/**\r\n*   Name: BizAgi Smartphone Render Yes-No Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the Yes-No render class to adjust to smartphone devices\r\n*/\r\nbizagi.rendering.yesno.extend(\"bizagi.rendering.yesno\", {}, {\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        if (properties.editable) {\r\n            if ((self.value == null || self.value === undefined) && (self.properties.value != null)) {\r\n                self.value = properties.value;\r\n            }\r\n\r\n            self.input = self.getControl().find(\"> div\");\r\n            container.addClass(\"bz-command-edit-inline\");\r\n\r\n            self.input.change(function() {\r\n                var selectedRadio = self.input.find(\"input:radio:checked\");\r\n                var nValue = selectedRadio.prop(\"value\");\r\n\r\n                if (self.value !== nValue) {\r\n                    self.setValue(nValue);\r\n                    self.setDisplayValue(nValue);\r\n\r\n                    if (self.properties.submitOnChange) {\r\n                        self.submitOnChange();\r\n                    }\r\n                }\r\n            });\r\n\r\n        } else {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            self.input = control.append(\"<span class=\\\"bz-rn-non-editable bz-rn-align-class bz-rn-text\\\"></span>\").find(\"span\");\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function(context) {\r\n        return this.properties.editable ? $(\".bz-rn-yesno\", context) : $(context);\r\n    },\r\n\r\n    /**\r\n     * set the display value en the rendered control\r\n     * */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.setValue(value.toString().toLowerCase(), false);\r\n\r\n        if (properties.editable) {\r\n            var parsedValue = bizagi.util.parseBoolean(value);\r\n            self.input.find(\".bz-radio-true\")\r\n                .prop(\"checked\", parsedValue === true)\r\n                .toggleClass(\"bz-unchecked\", parsedValue !== true)\r\n                .toggleClass(\"bz-check\", parsedValue === true);\r\n\r\n            self.input.find(\".bz-radio-false\")\r\n                .prop(\"checked\", parsedValue === false)\r\n                .toggleClass(\"bz-unchecked\", parsedValue !== false)\r\n                .toggleClass(\"bz-check\", parsedValue === false);\r\n        } else {\r\n            this._super(value);\r\n        }\r\n    }\r\n});","/**\r\n*   Name: BizAgi Smartphone Render Check\r\n*   Author: Bizagi Mobile Team\r\n*   Comments: Check implementation for smartphone\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.check.extend(\"bizagi.rendering.check\", {}, {\r\n    postRenderSingle: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        self.configureHelpText();\r\n\r\n        //self.getArrowContainer().hide();\r\n        // Personalize display of render\r\n        self.element.find(\".bz-container-render-cell > .ui-bizagi-render-control\").addClass(\"bz-check-control\");\r\n        self.element.find(\".bz-container-render-cell > .ui-bizagi-label\").addClass(\"bz-check-label\");\r\n        self.element.find(\".bz-container-render-cell > .ui-bizagi-render-control\").insertBefore(self.element.find(\".bz-container-render-cell > .ui-bizagi-label\"));\r\n        self.input = self.getControl().find(\"input\");\r\n\r\n        if (properties.editable) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n\r\n            self.input.bind(\"click\", function() {\r\n                var isChecked = self.input.is(\":checked\");\r\n\r\n                self.setValue(isChecked, true);\r\n                isChecked ? self.input.removeClass(\"bz-unchecked\").addClass(\"bz-check\") : self.input.addClass(\"bz-unchecked\").removeClass(\"bz-check\");\r\n\r\n                if (self.properties.submitOnChange) {\r\n                    self.submitOnChange();\r\n                }\r\n\r\n                if(self.properties.required && !isChecked){\r\n                    var requiredElement = self.element.find(\".ui-bizagi-label .bz-rn-required\");\r\n                    requiredElement.length > 0 ? requiredElement.show() : self.element.find(\".ui-bizagi-label\").prepend('<div class=\"bz-rn-required\"></div>');\r\n                }\r\n            });\r\n        } else {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        }\r\n    },\r\n\r\n    /* SET DISPLAY VALUE\r\n    ======================================================*/\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        \r\n        self.setValue(value, false);\r\n\r\n        var parsedValue = \"\";\r\n        if (properties.editable) {\r\n            parsedValue = bizagi.util.parseBoolean(value);\r\n        } else {\r\n            parsedValue = bizagi.util.parseBoolean(self.properties.value);\r\n        }\r\n\r\n        self.input.prop(\"checked\", parsedValue === true);\r\n        self.input.toggleClass(\"bz-check\", parsedValue === true).toggleClass(\"bz-unchecked\", parsedValue !== true);\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Tablet Render list Extension\r\n *   Author: Cristian O\r\n *   Date: 2015 - Oct - 10\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base list \r\nbizagi.rendering.list.extend(\"bizagi.rendering.list\", {}, {\r\n    \r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"readonly\");\r\n        var value = self.properties.value && self.hasValue() ? self.properties.value.value : \"- -\";\r\n\r\n        return $.kendoTmpl(template, { value: value });\r\n    },\r\n\r\n    renderSingle: function () {\r\n        // Call combo postRender\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        if (!self.properties.editable) {\r\n            // If isn't a editable control, then show a non editable span\r\n            container.addClass(\"bz-rn-non-editable\");\r\n\t    \r\n            // Getting the input\r\n            self.list = control.find(\"span\");\r\n\r\n            self.list.attr(\"readonly\", \"readonly\");\r\n        } else {\r\n            // Apply plugin\r\n            self.list = $(\".ui-bizagi-render-list\", control);\r\n        }\r\n\r\n        self.configureListHandlers();\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        // Show clear icon\r\n        $.when(self.ready()).done(function () {\r\n            if (!self.hasValue()) {\r\n                self.getControl().find(\".bz-rn-input-selected\").html(\"-------------\");\r\n                self.getControl().find(\".bz-wp-list-clear-icon-list\").hide(500);\r\n            } else {\r\n                self.getControl().find(\".bz-wp-list-clear-icon-list\").show(500);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Setting the control events\r\n     * */\r\n    configureListHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.list.find(\".see-more-icon\").bind(\"click\", function() {\r\n            var template = self.renderFactory.getTemplate(\"listModalView\");\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                \"items\": self.properties.data,\r\n                \"displayName\": self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n            var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView(\"open\");\r\n        });\r\n\r\n        // Setting the initial selected display value\r\n        self.list.on(\"click\", \".bz-rn-regular-element\", function() {\r\n            var val = $(this).data(\"value\");\r\n            var label = $(this).text();\r\n\r\n            var newValue = { \"id\": val, \"value\": label };\r\n            self.selectedValue = newValue.value;\r\n            self.setValue(newValue);\r\n            self.setDisplayValue(newValue);\r\n        });\r\n\r\n        // Set clear event\r\n        control.find(\".bz-rn-first-element-container\").on(\"click\", \".bz-wp-list-clear-icon-list\", function() {\r\n            var val = \"\";\r\n            var label = \"-------------\";\r\n\r\n            var newValue = { \"id\": val, \"value\": label };\r\n            self.setValue(newValue);\r\n            self.selectedValue = newValue.value;\r\n            self.setDisplayValue(newValue);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //getting combo list elements\r\n        var container = inputContainer.find(\".ui-bizagi-render-list-elements li\");\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        //Closing modalview\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Filtering list\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind(\"change keypress keyup change\", function () {\r\n            self.filterList(this.value, container, inputContainer);\r\n        });\r\n\r\n        //Cleaning list\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind(\"click\", function () {\r\n            self.filterList(\"\", container, inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //Configuring list as a selectable element\r\n        self.modalViewList = $(\".ui-bizagi-render-list-elements\", inputContainer);\r\n        self.setModalViewDisplayValue();\r\n\r\n        //Setting the initial selected display value\r\n        self.modalViewList.on(\"click\", \"li\", function () {\r\n            self.modalViewList.find(\"li\").filter(function () {\r\n                if ($(this).hasClass(\"ui-selected\")) {\r\n                    return $(this);\r\n                }\r\n            }).removeClass(\"ui-selected\");\r\n\r\n            $(this).addClass(\"ui-selected\");\r\n            $(\".bz-wp-modalview-header-input-search\", inputContainer).blur();\r\n        });\r\n\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            var selected = $(\"li.ui-selected\", self.modalViewList);\r\n            var _value = $(selected).data(\"value\");\r\n            var label = $(selected).text();\r\n\r\n            //Update internal value\r\n            if (typeof _value !== \"undefined\") {\r\n                var newValue = { \"id\": _value, \"value\": label };\r\n                self.setValue(newValue);\r\n                self.selectedValue = newValue.value;\r\n                self.setDisplayValue(newValue);\r\n            }\r\n        }).fail(function () {\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * */\r\n    filterList: function (search, $li, inputContainer) {\r\n        if (search !== \"\") {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n        } else {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n        }\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n     =====================================================*/\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;        \r\n        var control = self.getControl();\r\n\r\n        if (self.properties.editable) {\r\n            if (typeof (value) !== \"undefined\") {\r\n                control.find(\".bz-rn-input-selected\").html(value.value);\r\n\r\n                if (value.value === \"-------------\" || value.value === \"\") {\r\n                    control.find(\".bz-wp-list-clear-icon-list\").hide(500);\r\n                } else {\r\n                    control.find(\".bz-wp-list-clear-icon-list\").show(500);\r\n                }\r\n            }\r\n        } else {\r\n            self.list.text(value.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function(){\r\n        var self = this;\r\n        var value = {id:\"\", value:\"\"};\r\n        var control = self.getControl();\r\n\r\n        self.setValue(value);\r\n        self.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Setting the selected element.\r\n     * */\r\n    setModalViewDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.list && properties.editable &&\r\n            self.properties.value && typeof(self.properties.value) !== \"undefined\" &&\r\n            self.properties.value.id !== \"\") {\r\n            $(\"#ui-bizagi-list-\" + self.properties.value.id, self.modalViewList).addClass(\"ui-selected\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n        // Nothing todo, all events apply in selectable plugin\r\n    },\r\n\r\n    /**\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function () {\r\n        var self = this;\r\n        return self.selectedValue;\r\n    }\r\n});","/*\r\n *   Name: Bizagi Smartphone Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the MultiSelect render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.multiSelect.extend(\"bizagi.rendering.multiSelect\", bizagi.rendering.render.base.prototype);\r\n// Extends itself\r\nbizagi.rendering.multiSelect.extend(\"bizagi.rendering.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40,\r\n    SEARCH_MIN_LENGTH: 1,\r\n    temporalElements: {}\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    renderSingle: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        if (this.properties.editable) {\r\n            this.configureHandlers();\r\n        } else {\r\n            this.configureHandlersReadOnly();\r\n        }\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var $control = this.getControl();\r\n        $(\".bz-multiselect__arrow\", $control)\r\n            .on(\"click\", this.openModalView.bind(this));\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li div.bz-btn-icn\", this.onUnselectElement.bind(this))\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    onUnselectElement: function (ev) {\r\n        var $element = $(ev.target);\r\n        var idToRemove = $element.data(\"id\");\r\n\r\n        // Remove element\r\n        this.removeElement({id: idToRemove});\r\n        this.addSelectedElements();\r\n    },\r\n\r\n    onShowSelectedElements: function (ev) {\r\n        var self = this;\r\n        var $element = $(ev.currentTarget);\r\n        var index = $element.data('index');\r\n        var values = self.getDataValue();\r\n        var valuesToShow = (values || []).slice(index);\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tags\");\r\n        var $listView = this.showFloatListView(template, {\r\n            datasource: valuesToShow,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        var $tagElements = $('ul.bz-multiselect__tags', $listView);\r\n\r\n        $tagElements.on(\"click, mousedown\", \"li div.bz-btn-icn\", function (ev) {\r\n            self.onUnselectElement(ev);\r\n            $listView.remove();\r\n        });\r\n\r\n        $listView.on(\"closeView\", function () {\r\n            $tagElements.off(\"click\", \"li div.bz-btn-icn\", self.onUnselectElement.bind(self))\r\n            $listView.remove();\r\n        });\r\n    },\r\n\r\n    openModalView: function () {\r\n        //Creating modal view\r\n        var self = this;\r\n        //Reset the temporal array\r\n        self.Class.temporalElements = {};\r\n        var template = self.renderFactory.getTemplate('multiselectModalView');\r\n        var values = self.getDataValue();\r\n        var options = {\r\n            selected: values,\r\n            isChecked: function (id) {\r\n                return self.markAsChecked.call(this, id);\r\n            }\r\n        };\r\n\r\n        this.getData().done(function (result) {\r\n            var data = {\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation,\r\n                \"datasource\": result,\r\n                \"options\": options\r\n            };\r\n            try {\r\n                var modalViewTemplate = kendo.template(template, {useWithBlock: false});\r\n                for (var i = 0, length = values.length; i < length; i++) {\r\n                    self.Class.temporalElements[values[i].id] = values[i];\r\n                }\r\n                var modalView = $($.trim(modalViewTemplate(data)));\r\n                self.modalListHandlers(modalView);\r\n\r\n                modalView.kendoMobileModalView({\r\n                    close: function () {\r\n                        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                        this.destroy();\r\n                        this.element.remove();\r\n                    },\r\n                    useNativeScrolling: true,\r\n                    modal: false\r\n                });\r\n\r\n                self.configureModalViewHandlers(modalView);\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                modalView.kendoMobileModalView('open');\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n        var $listContainer = inputContainer.find(\".bz-multiselect__list li\");\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Showing found results\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('keypress keyup', function () {\r\n            if (this.value !== \"\") {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n            } else {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n                $(\"#ui-bizagi-wp-filter-results-multiselect-wrapper ul li\", inputContainer).show();\r\n            }\r\n\r\n            // Getting and showing the data\r\n            self.filterList(this.value, $listContainer);\r\n        }).focus(function () {\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").addClass(\"searching\");\r\n        }).blur(function () {\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").removeClass(\"searching\");\r\n        });\r\n\r\n        //Cleaning search\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function () {\r\n            $(\"#ui-bizagi-wp-filter-results-multiselect-wrapper ul li\", inputContainer).show();\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //when click on apply button\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Trigger delete event for tags\r\n        inputContainer.find(\".filter-searchlist-modal-view-tags\").on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this), true);\r\n\r\n            var term = inputContainer.find(\".bz-wp-modalview-header-input-search\").val();\r\n\r\n            // Getting and showing the data\r\n            self.filterList(term, $listContainer);\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            self.addNewValuesToInput();\r\n            self.Class.temporalElements = {};\r\n        }).fail(function () {\r\n            self.Class.temporalElements = {};\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Adding new values to input\r\n     * */\r\n    addNewValuesToInput: function () {\r\n        var self = this;\r\n\r\n        //Create a temporal array\r\n        var tempArray = [];\r\n\r\n        $.each(self.Class.temporalElements, function (i, ele) {\r\n            tempArray.push(ele);\r\n        });\r\n\r\n        self.setValue(tempArray);\r\n        self.addSelectedElements();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var values = self.getDataValue();\r\n        var totalValues = values.length;\r\n        var $tagsContainer = $('ul.bz-multiselect__tags', $control);\r\n        var editable = this.properties.editable;\r\n        $tagsContainer.empty();\r\n\r\n        if (totalValues > 0) {\r\n\r\n            var template = this.renderFactory.getTemplate(\"list-multiselect-tag\");\r\n\r\n            for (var i = 0; i < totalValues; i++) {\r\n                var item = values[i];\r\n                var data = {id: item.id, value: item.value, editable: editable};\r\n                var elementTemplate = kendo.template(template, {useWithBlock: false});\r\n                var $ChildToAdd = $($.trim(elementTemplate(data)));\r\n\r\n                $tagsContainer.append($ChildToAdd);\r\n\r\n                // Process the control in the layout\r\n                this.processControlLayout(this.properties.valueFormat || {});\r\n\r\n                if (!this.canAddMoreItems($tagsContainer)) {\r\n                    // Remove last item added\r\n                    $tagsContainer\r\n                        .children()\r\n                        .last()\r\n                        .remove();\r\n\r\n                    // Add the view mode item\r\n                    var data = {\r\n                        'value': totalValues - i,\r\n                        'index': i\r\n                    };\r\n\r\n                    var viewMoreTemplate = kendo.template(this.renderFactory.getTemplate(\"list-multiselect-view-more\"), {useWithBlock: false})\r\n                    var $viewMore = $($.trim(viewMoreTemplate(data)));\r\n                    $tagsContainer.append($viewMore);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    modalListHandlers: function ($floatListContext) {\r\n        var self = this;\r\n        var $listContainer = $floatListContext.find(\".bz-multiselect__list li\");\r\n        var checkbox = $listContainer.find(\"input[type=checkbox]\");\r\n\r\n        $floatListContext.find(\".bz-multiselect__search_input\").bind(\"change keypress keyup mousedown\", function (evt) {\r\n            evt.stopPropagation();\r\n\r\n            self.filterList(this.value, $listContainer);\r\n        });\r\n\r\n        checkbox.change(function () {\r\n            var $context = $(this);\r\n            var isChecked = $context.is(\":checked\");\r\n            var newValue = {id: $context.data(\"id\"), value: $context.data(\"value\")};\r\n\r\n            if (isChecked) {\r\n                self.addTemporalElement(newValue, false);\r\n            } else {\r\n                self.addTemporalElement(newValue, true);\r\n            }\r\n        });\r\n\r\n        $floatListContext.on(\"closeView\", function () {\r\n            self.closeFloatView();\r\n\r\n            $(document).unbind(\"mousedown.multiselect\");\r\n        });\r\n    },\r\n\r\n    addTemporalElement: function (element, elementToRemove) {\r\n        var self = this;\r\n        if (elementToRemove) {\r\n            delete self.Class.temporalElements[element.id];\r\n        } else {\r\n            self.Class.temporalElements[element.id] = element;\r\n        }\r\n    },\r\n\r\n    showFloatListView: function (template, data) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        var $containerControl = $control.closest(\".ui-bizagi-render-control\");\r\n        var modalViewTemplate = kendo.template(template, {useWithBlock: false});\r\n        var $floatList = $($.trim(modalViewTemplate(data))); //$.tmpl(template, data, options);\r\n        var widthControl = multiSelect.width();\r\n\r\n        $containerControl.append($floatList);\r\n\r\n        $floatList.width(widthControl);\r\n\r\n        $floatList.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: multiSelect,\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        // Display view\r\n        $floatList.show();\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $floatList.on(\"mousedown\", function (ev) {\r\n            ev.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        // Add global handler to close the float view\r\n        $(document).one(\"mousedown.multiselect\", function (evt) {\r\n            $floatList.trigger('closeView');\r\n        });\r\n\r\n        return $floatList;\r\n    }\r\n\r\n});\r\n","/*  \r\n *   Name: BizAgi Smartphone Render list Extension\r\n*   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.radio.extend(\"bizagi.rendering.radio\", {}, {\r\n\r\n    /* POSTRENDER\r\n    ======================================================*/\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var deferred = $.Deferred();\r\n\r\n        self.getArrowContainer().hide();\r\n        $.when(self.renderControl()).done(function() {\r\n            self.input = self.combo = $(\".ui-bz-render-radio\", self.getControl());\r\n\r\n            if (self.value)\r\n                self.setValue(self.value, false);\r\n\r\n            if (properties.editable) {\r\n                container.addClass(\"bz-command-edit-inline\");\r\n\r\n                self.input.change(function() {\r\n                    var selectedRadio = self.input.find(\"input:radio:checked\");\r\n                    self.input.find(\".checked\").removeClass(\"checked\");\r\n                    self.input.find(\".bz-check\").addClass(\"bz-unchecked\").removeClass(\"bz-check\");\r\n\r\n                    selectedRadio.closest(\"div\").addClass(\"checked\");\r\n                    selectedRadio.addClass(\"bz-check\");\r\n                    selectedRadio.removeClass(\"bz-unchecked\");\r\n\r\n                    var newValue = { id: selectedRadio.prop(\"value\"), value: selectedRadio.parent().text() };\r\n                    self.setValue(newValue);\r\n\r\n                    /*if (self.properties.submitOnChange) {\r\n                        self.submitOnChange();\r\n                    }*/\r\n                });\r\n            } else {\r\n                container.addClass(\"bz-rn-non-editable\");\r\n                self.input = self.combo = self.getControl().html(\"<span class=\\\"bz-rn-non-editable bz-rn-align-class bz-rn-text\\\"></span>\").find(\"span\");\r\n            }\r\n\r\n            deferred.resolve();\r\n\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /* SETS DISPLAY VALUE\r\n    ======================================================*/\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (value !== undefined && value.id != null) {\r\n            if (properties.editable) {\r\n                // Find the control to check where value is\r\n                var radioItem = self.input.find(\"input[type='radio'][value='\" + value.id + \"']\");\r\n                radioItem.prop(\"checked\", \"checked\");\r\n                radioItem.closest(\"div\").addClass(\"checked\");\r\n                radioItem.addClass(\"bz-check\").removeClass(\"bz-unchecked\");\r\n            } else {\r\n                // Find the control to check where value is\r\n                self.input.html((value.value ? value.value.toString() : \"\"));\r\n                self.input.attr(\"id\", value.id);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = { id: \"\", label: \"\" };\r\n        var selectedItem = self.element.find(\".checked\").removeClass(\"checked\");\r\n\r\n        selectedItem.find(\".bz-rn-radio-item\").prop(\"checked\", false).removeClass(\"bz-check\").addClass(\"bz-unchecked\");\r\n        self.setValue(value, false);\r\n        self.setDisplayValue(value);\r\n    }\r\n});","/**\r\n *   Name: BizAgi Smartphone Render Cascading combo Extension\r\n *   Author: Oscar O\r\n *   Comments:\r\n *   -   This script will redefine the cascading combo render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base cascading combo, then apply tablet combo stuff\r\nbizagi.rendering.cascadingCombo.extend(\"bizagi.rendering.cascadingCombo\", {}, {\r\n\r\n    init: function(params){\r\n        var self = this;\r\n        self._super(params);\r\n        this.properties.data = this.properties.data || [];\r\n\r\n        self.bind(\"select\", function (ex, value) {\r\n            self.onComboChange(value);\r\n        });\r\n    },\r\n    /*\r\n    *\r\n    * */\r\n    renderReadOnly: function() {\r\n        return bizagi.rendering.combo.prototype.renderReadOnly.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n     * Initilizing the combo control\r\n     * */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var parentCombo = self.getParentCombo();\r\n        \r\n        if (parentCombo !== null && parentCombo.properties.type == \"cascadingCombo\") {\r\n            self.isDependant = true;\r\n            parentCombo.dependants.push(self);\r\n            if (self.getValue() != null) {\r\n                self.properties.parentComboValue = self.getValue().id;\r\n            } else {\r\n                self.initializingCascadingCombo = true;\r\n            }\r\n        }\r\n\r\n        self.initialValueSet = true;\r\n        $.when(bizagi.rendering.combo.prototype.renderSingle.apply(self, arguments))\r\n            .done(function () {\r\n                if (self.value && self.isDependant == false){\r\n                    self.triggerHandler(\"select\", self.value);\r\n                }\r\n                self.initialValueSet = false;\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRenderSingle: function () {\r\n        bizagi.rendering.combo.prototype.postRenderSingle.apply(this, arguments);\r\n    },\r\n\r\n    renderEdition: function () {\r\n        bizagi.rendering.combo.prototype.renderEdition.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n     * Setting the combo's handlers\r\n     * */\r\n    configureCombo: function () {\r\n        bizagi.rendering.combo.prototype.configureCombo.apply(this, arguments);\r\n    },\r\n\r\n    configureModalViewHandlers: function () {\r\n        bizagi.rendering.combo.prototype.configureModalViewHandlers.apply(this, arguments);\r\n    },\r\n\r\n    filterList: function () {\r\n        bizagi.rendering.combo.prototype.filterList.apply(this, arguments);\r\n    },\r\n\r\n    setModalViewDisplayValue: function () {\r\n        bizagi.rendering.combo.prototype.setModalViewDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function () {\r\n        bizagi.rendering.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (value === \"\") {\r\n            value = { id: \"\", value: \"\" };\r\n        }\r\n\r\n        if (!!value) {\r\n            if (self.value === null || self.value.id !== value.id){\r\n                self.triggerHandler(\"select\", value);\r\n            }\r\n\r\n            this._super(value, triggerEvents);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id \r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function(e) {\r\n            return e.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * cleans the control's data\r\n     * */\r\n    cleanData: function() {\r\n        bizagi.rendering.combo.prototype.cleanData.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n     * cleans the control's data\r\n     * */\r\n    resetData: function() {\r\n        bizagi.rendering.combo.prototype.resetData.apply(this, arguments);\r\n    },\r\n\r\n    processComboData: function(data){\r\n        bizagi.rendering.combo.prototype.processComboData.apply(this, arguments);\r\n    },\r\n\r\n    validateValue: function(value){\r\n        bizagi.rendering.combo.prototype.validateValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function () {\r\n        return bizagi.rendering.combo.prototype.getSelectedValue.call(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Handler for combo change\r\n     */\r\n    onComboChange: function (newValue) {\r\n        var self = this;\r\n        self.selectedValue = newValue.value;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = newValue.id;\r\n\r\n        $.each(this.dependants, function(key, dependant){\r\n            dependant.properties.params = params;\r\n            dependant.properties.parentComboValue = newValue.id;\r\n\r\n            if (newValue.id == \"\"){\r\n                dependant.resetData();\r\n                dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n            }else{\r\n                $.when(dependant.getData(params)).done(function (data) {\r\n                    dependant.properties.data = data;\r\n                    if (dependant.value !== null){\r\n                        var selected = dependant.findDataValueById(dependant.value.id);\r\n                        if (selected){\r\n                            if (selected.id == \"\" && (self.value && self.value.value == \"\")){\r\n                                dependant.resetData();\r\n                                dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n                            }else{\r\n                                dependant.triggerHandler(\"select\", selected);\r\n                            }\r\n                        }\r\n                        else{\r\n                            dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n                            dependant.triggerHandler(\"select\", { id: \"\", value: \"\" });\r\n                        }\r\n                    }else{\r\n                        dependant.triggerHandler(\"select\", { id: \"\", value: \"\" });\r\n                    }\r\n\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi smartphone Render option select\r\n *   Author: CristianO\r\n *   Date: 29/10/2015\r\n *   Comments:\r\n *   -   Render a single input with a modal view, this modal view contain a\r\n *       selectable list.\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.combo.extend(\"bizagi.rendering.combo\", {\r\n}, {\r\n\r\n    /*\r\n    *\r\n    * */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var result = self._super();\r\n        var template = self.renderFactory.getTemplate(\"readonlyCombo\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * Initilizing the combo control\r\n     * */\r\n    renderSingle: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n        var params = {};\r\n\r\n        // Flag to set or not the display value on cascading combos.\r\n        self.showDisplayValue = false;\r\n\r\n        // Getting the input\r\n        self.input = $(\".bz-rn-combo-control\", control);\r\n        if (properties.parentComboValue && properties.parentComboValue != null) {\r\n            params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = properties.parentComboValue;\r\n\r\n            //If is a cascading combo, and has a parent and has its own value, then set the display value.\r\n            self.showDisplayValue = self.parentCombo && self.parentCombo.value && self.parentCombo.value.value !== \"\" && self.properties.value && self.properties.value.value;\r\n        }\r\n\r\n        if (!properties.editable) {\r\n            self.inputSpan = $('.bz-rn-text', control);\r\n            container.addClass(\"bz-rn-non-editable bz-command-edit-inline\");\r\n\r\n            if (self.value != null) {\r\n                self.inputSpan.text(self.value.value || self.value.id);\r\n            }\r\n        } else {\r\n            if (typeof self.initialValueSet !== \"undefined\" && !self.initialValueSet) {\r\n                $.when(self.renderCombo(params)).done(function (html) {\r\n                    self.getControl().html(html);\r\n                    self.input = self.combo = self.getControl();\r\n                    self.configureCombo();\r\n                    self.processLayout(false, self.properties.valueFormat || {});\r\n                });\r\n            } else {\r\n                self.configureCombo();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        if (properties.editable) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n        }\r\n\r\n        self._super();\r\n    },\r\n\r\n    renderEdition: function () { },\r\n\r\n    /**\r\n     * Setting the combo's handlers\r\n     * */\r\n    configureCombo: function() {\r\n        var self = this;\r\n\r\n        self.inputSpan = self.input.find(\".bz-rn-cm-text-label\");\r\n        self.inputSpan.html($(\"option:selected\", self.input).text());\r\n        self.inputSpan.val($(\"option:selected\", self.input).text());\r\n\r\n        $(\".bz-rn-container-combo\", self.getControl()).unbind().bind(\"click\", function() {\r\n            //After click on input combo, remove focus of it.\r\n            self.input.find(\".bz-rn-combo-control\").blur();\r\n            $(self.input).blur();\r\n\r\n            self.input.attr(\"keyboard\", \"disable\");\r\n\r\n            //Creating modal view\r\n            self.processComboData(self.properties.data);\r\n            var template = self.renderFactory.getTemplate('comboModalView');\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                'items': self.properties.data,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n\r\n            var modalView = $($.trim(modalViewTemplate(data)))\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView(\"open\");\r\n        });\r\n    },\r\n\r\n    processComboData: function(data){\r\n        var self = this;\r\n\r\n        data.forEach(function(value){\r\n            self.validateValue(value);\r\n        });\r\n    },\r\n\r\n    validateValue: function(value){\r\n        var self = this;\r\n\r\n        if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id !== null) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n            var translated = false;//When the parametric entity have a boolean attribute\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //getting combo list elements\r\n        var container = inputContainer.find(\".bz-wp-modalview-results-list li\");\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Filtering list\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('change keypress  keyup change', function () {\r\n            self.filterList(this.value, container, inputContainer);\r\n        });\r\n\r\n        //Cleaning list\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind(\"click\", function () {\r\n            self.filterList(\"\", container, inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //Configuring list as a selectable element\r\n        self.list = $(\".bz-wp-modalview-results-list\", inputContainer);\r\n        self.setModalViewDisplayValue(self.properties.value || false);\r\n\r\n        self.inputSpan = inputContainer.find(\".bz-rn-cm-text-label\");\r\n        self.inputSpan.html($(\"li.ui-selected\", self.list).text());\r\n        self.inputSpan.val($(\"li.ui-selected\", self.list).text());\r\n\r\n        self.list.find(\"li\").bind(\"click\", function () {\r\n            self.list.find(\"li\").filter(function () {\r\n                if ($(this).hasClass(\"ui-selected\")) {\r\n                    return $(this);\r\n                }\r\n            }).removeClass(\"ui-selected\");\r\n\r\n            $(this).addClass(\"ui-selected\");\r\n            self.input.blur();\r\n            $(\".bz-wp-modalview-header-input-search\", inputContainer).blur();\r\n        });\r\n\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            var selected = $(\"li.ui-selected\", self.list);\r\n            var value = $(selected).data(\"value\");\r\n            var label = $(selected).text();\r\n\r\n            //Update internal value\r\n            var newValue = { id: value, value: label };\r\n            self.selectedValue = newValue.value;\r\n            self.setDisplayValue(newValue);\r\n\r\n        }).fail(function () {\r\n            //console.warn(\"combo error\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * */\r\n    filterList: function (search, $li, inputContainer) {\r\n        if (search !== \"\") {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n        } else {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n        }\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    /**\r\n     * Setting the selected element.\r\n     * */\r\n    setModalViewDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable && (value && typeof (value) !== \"undefined\" && value !== null) && value.id !== \"\") {\r\n            self.list.find(\"#ui-bizagi-list-\" + value.id).addClass(\"ui-selected\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Setting the display value, always you call a setDisplayValue yor are performinng a setValue under the hood.\r\n     * */\r\n    setDisplayValue: function (value) {\r\n          if (value && (typeof value === \"object\" && typeof value.label !== \"undefined\")) {\r\n              var comboValue = (value.label != \"\" && !bizagi.util.isNumeric(value.label)) ? value.label : ( this.findDataValueById(value.value).value || \"\" );\r\n              \r\n              if ($.isArray(comboValue)) {\r\n              comboValue = comboValue.join(\" - \");\r\n              }\r\n              \r\n              value = ({ id: value.value, value: comboValue });\r\n          }\r\n\r\n        var control = this.getControl();\r\n        $(\"input\", control).val(this.formatItem(value.value));\r\n\r\n        //Set Value\r\n        this.setValue(value);\r\n    },\r\n\r\n    resetData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = [];\r\n        properties.remoteDataLoaded = false;\r\n\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function () {\r\n        var value = {id:\"\", value:\"\"};\r\n        this.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Getting the templates\r\n     * */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    }\r\n});","/*\r\n*   Name: BizAgi Smartphone Collection Navigator Extension\r\n*   Author: Bizagi Bizagi Team\r\n*   Comments:\r\n*   -   This script will redefine the collection Navigator class to adjust to smartphone devices\r\n*/\r\n\r\nbizagi.rendering.collectionnavigator.extend(\"bizagi.rendering.collectionnavigator\", {}, {\r\n \r\n  renderSingle: function () {\r\n\r\n        var self = this;        \r\n        var container = self.getContainerRender();\r\n\r\n        container.addClass(\"bz-command-not-edit\");\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi smartphones Render Hidden Extension\r\n*   Author: RicharU based on Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the hidden render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.hidden.extend(\"bizagi.rendering.hidden\", {}, {\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {} \r\n     */\r\n    render: function () {\r\n        var self = this;\r\n\r\n        return self.renderSingle();\r\n    },\r\n\r\n    /**\r\n     * Returns the in-memory processed element\r\n     * @returns {} \r\n     */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        if (self.getMode() === \"design\") {\r\n            return \"<div>\" + bizagi.localization.getResource(\"render-hidden-displayName\") + \"</div>\";\r\n        } else {\r\n            return \"<div />\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {} \r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set the initial value\r\n        if (properties.value !== undefined) {\r\n            self.setDisplayValue(properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        self.setValue(value, false);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi smartphone Render Upload Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class to adjust to smartphones devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.upload.extend(\"bizagi.rendering.upload\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // limit: The maximum number of multimedia files in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"]\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n        var allow_upload = true;\r\n\r\n        self.checkExtensions();\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            allow_upload = self.validOptions && (self.validOptions.image || self.validOptions.video);\r\n        }\r\n\r\n        // Render template\r\n        var html = $.kendoTmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: self.properties.editable && allow_upload,\r\n            noFiles: (self.filesCount === 0),\r\n            allow_upload: allow_upload,\r\n            nonSupportedExtension: self.nonSupportedExtension,\r\n            uploadOptions: self.upload_options,\r\n            allowSendInMail: self.properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0, filesCount = self.filesCount; i < filesCount; i++) {\r\n            var file = { id: self.files[i][0], fileName: self.files[i][1] };\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param {} file\r\n     * @returns {}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var image = self.checkImageFile(file.fileName);\r\n        var template = self.renderFactory.getTemplate(\"uploadItem\");\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = mode !== \"execution\" ? \"javascript:void(0);\" : self.buildItemUrl(file);\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            url: url,\r\n            image: image,\r\n            allowDelete: self.properties.allowDelete,\r\n            editable: self.properties.editable,\r\n            filename: file.fileName,\r\n            id: file.id,\r\n            mode: mode,\r\n            isCordovaSupported: bizagi.util.isCordovaSupported()\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var containerRender = self.getContainerRender();\r\n\r\n        self.configureHelpText();\r\n\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", self.getControl());\r\n\r\n        if (!self.properties.editable || self.itIsMaxNumberFilesReached() || (!bizagi.util.isCordovaSupported() && !bizagi.util.media.fileAPISupported())) {\r\n            self.itemAddfile.hide();\r\n        }\r\n\r\n        if (!self.properties.editable || (!bizagi.util.isCordovaSupported() && !bizagi.util.media.fileAPISupported())) {\r\n            containerRender.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            containerRender.addClass(\"bz-command-edit-inline\");\r\n            self.buildUploadControl();\r\n        }\r\n\r\n        self.addInteractions();\r\n    },\r\n\r\n    buildUploadControl: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n        var fileInput = $(\".bz-rn-upload-web\", container);\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            // Upload image\r\n            $(self.itemAddfile).actionSheet({\r\n                actions: self.upload_options,\r\n                actionClicked: function (action) {\r\n                    // Action for web file upload\r\n                    if (action.guid === 5) {\r\n                        fileInput.click();\r\n                    } else {\r\n                        self.handlerUploadImage(action.guid);\r\n                    }\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n\r\n            // Resolution image\r\n            $(\".bz-rn-upload-resolution-container\", container).actionSheet({\r\n                actions: bizagi.util.media.getImageResolutionItems(),\r\n                actionClicked: function (action) {\r\n                    bizagi.loading.start();\r\n                    $.when(self.handlerResolutionUpload(action.guid)).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n        } else {\r\n            $(self.itemAddfile).click(function () {\r\n                fileInput.click();\r\n            });\r\n        }\r\n\r\n        fileInput.on(\"click\", function (e) {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        // Attach event to web upload-control\r\n        fileInput.on(\"change\", function () {\r\n            var that = this;\r\n            var dataFile = that.files[0];\r\n            var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSAUDIO, self.Class.EXTENSIONSVIDEO);\r\n\r\n            dataFile.fullPath = that.value;\r\n\r\n            bizagi.loading.start();\r\n\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.processUploadFile(dataFile))\r\n                    .then(function (result) {\r\n                        self.onUploadFileCompleted(self, JSON.parse(decodeURIComponent(result)));\r\n                    }).fail(function (error) {\r\n                        if (error.statusText !== \"Unauthorized\" || error.statusText.toLowerCase() !== \"ok\") {\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n                        }\r\n                    }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n\r\n            // Clearing input Values\r\n            $(that).val(\"\");\r\n        });\r\n\r\n        // Check files number\r\n        self.checkMaxFiles();\r\n\r\n        // Attach delete option\r\n        self.attachDeleteHandler();\r\n    },\r\n\r\n    /**\r\n     * Add the interactions to the upload control items\r\n     * @return {}\r\n     */\r\n    addInteractions: function () {\r\n        var self = this;\r\n\r\n        // Handler to download the file\r\n        $(\"ul.files\", self.getControl()).on(\"click\", \".ui-bizagi-render-link.button\", function () {\r\n            bizagi.loading.start();\r\n            $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Handler of delete action\r\n     * @returns {}\r\n     */\r\n    attachDeleteHandler: function () {\r\n        var self = this;\r\n\r\n        $(\".bz-rn-upload-delete-icon\", self.getControl()).on(\"click\", function () {\r\n            var item = $(this).parent(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n            $.when(self.deleteUploadItem(item, file.id))\r\n                .done(function () {\r\n                    // Remove item\r\n                    item.hide();\r\n                    item.remove();\r\n\r\n                    // Update value\r\n                    self.setValue(self.files, false);\r\n\r\n                    // Check maxFiles\r\n                    self.checkMaxFiles();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Handler of upload image\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerUploadImage: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        switch (actionSelected) {\r\n            case 2:\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    self.dataImage = dataImage;\r\n                    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            //Gets the real properties for the file\r\n                            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage))\r\n                                .then(function (fileData) {\r\n                                    self.fileProperties = fileData;\r\n                                    if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\r\n                                        if (!bizagi.util.isAndroid()) {\r\n                                            return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\r\n                                                    if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                        return self.handlerResolutionUpload(buttonIndex);\r\n                                                    }\r\n                                                });\r\n\r\n                                        } else {\r\n                                            // force click to show actionsheet menu\r\n                                            $(\".bz-rn-upload-resolution-container\", self.getContainerRender()).click();\r\n                                        }\r\n                                    }\r\n                                });\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                }, self.onFail.bind(self), {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY\r\n                });\r\n                break;\r\n            case 1:\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    bizagi.loading.start();\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                                self.fileProperties = fileData;\r\n                                return self.saveImage(self, dataImage);\r\n                            });\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                },\r\n                    self.onFail.bind(self),\r\n                    {\r\n                        quality: self.Class.QUALITY_PICTURE,\r\n                        sourceType: navigator.camera.PictureSourceType.CAMERA,\r\n                        mediaType: navigator.camera.MediaType.PICTURE,\r\n                        destinationType: Camera.DestinationType.FILE_URI,\r\n                        correctOrientation: true,\r\n                        targetWidth: 1280,\r\n                        targetHeight: 960\r\n                    });\r\n                break;\r\n            case 3:\r\n                navigator.device.capture.captureVideo(function (dataVideo) {\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSizeVideo(dataVideo, self.properties))\r\n                        .then(function () {\r\n                            return self.saveVideo(self, dataVideo);\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                }, self.onFail.bind(self), { limit: self.Class.LIMIT });\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler of resolution upload\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerResolutionUpload: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        //if original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return self.saveImage(self, self.dataImage);\r\n        } else {\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution))\r\n                .then(function (result) {\r\n                    self.editedImageURL = result.localUrl;\r\n                    self.properties.url = result.base64Image;\r\n                    return self.saveImage(self, self.dataImage);\r\n                });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\"); self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * CheckImageFile\r\n     * @param {} fileName\r\n     * @returns {}\r\n     */\r\n    checkImageFile: function (fileName) {\r\n        var self = this;\r\n        var validExtensions = self.Class.EXTENSIONSIMG;\r\n\r\n        if (!fileName || bizagi.util.isObjectEmpty(fileName)) return false;\r\n\r\n        for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n            var image = fileName.indexOf(\".\" + validExtensions[i]);\r\n\r\n            if (image >= 0) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Templates\r\n     * @returns {}\r\n     */\r\n    getTemplateName: function () {\r\n        return \"upload\";\r\n    },\r\n\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    },\r\n\r\n    /**\r\n     * Send image using HTTP\r\n     * @param {} context\r\n     * @param {} dataImage\r\n     * @returns {}\r\n     */\r\n    saveImage: function (context, dataImage) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        var fileName = self.fileProperties.name;\r\n\r\n        if (self.editedImageURL) {\r\n            params.dataFile = self.editedImageURL;\r\n        } else if (self.fileProperties) {\r\n            params.dataFile = self.fileProperties.url;\r\n        }\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.mimeType = \"image/jpeg\";\r\n        params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n\r\n        //Cleans variables related previous uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).then(function (r) {\r\n            var response = JSON.parse(decodeURIComponent(r.response));\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(context, response);\r\n            }\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * saveVideo\r\n     * @param {} context\r\n     * @param {} dataVideo\r\n     * @returns {}\r\n     */\r\n    saveVideo: function (context, dataVideo) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileName = dataVideo[0].name;\r\n        params.options.mimeType = \"video/quicktime\";\r\n        params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataVideo[0].fullPath;\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).then(function (r) {\r\n            var response = JSON.parse(decodeURIComponent(r.response));\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(context, response);\r\n            }\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        })\r\n    },\r\n\r\n    /**\r\n     * Management fail messages\r\n     */\r\n    onFail: function (error) {\r\n        var messageError = bizagi.util.processFailMessage(error);\r\n\r\n        bizagi.loading.stop();\r\n\r\n        if (typeof (messageError) == \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\r\n            var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\r\n            var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\r\n\r\n            bizagi.showMessageBox(message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * onUploadFileCompleted\r\n     * @param {} context\r\n     * @param {} response\r\n     * @returns {}\r\n     */\r\n    onUploadFileCompleted: function (context, result) {\r\n        var self = context;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".ui-bizagi-render-upload-container .files\", control);\r\n\r\n        if (result.id && result.fileName) {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem(result);\r\n            uploadWrapper.append(newItem);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Update value\r\n            self.setValue(files, true);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            if (self.properties.allowDelete && self.properties.editable) {\r\n                self.attachDeleteHandler();\r\n            }\r\n\r\n            self.editedImageURL = null;\r\n        } else {\r\n            bizagi.showMessageBox(result.message, \"Error\");\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Checks if the control data is valid\r\n    * @returns Boolean\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        //Call Base\r\n        var bValid = self._super(invalidElements);\r\n\r\n        if (bValid) {\r\n            // Clear error message\r\n            self.setValidationMessage(\"\");\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Check maximum number of files\r\n     * @returns {}\r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var maxFiles = properties.maxfiles;\r\n\r\n        var actualFiles = properties.value ? properties.value.length : 0;\r\n\r\n        if (properties.editable) {\r\n            if (maxFiles !== 0 && ((self.filesCount >= maxFiles && actualFiles >= maxFiles))) {\r\n                self.itemAddfile.hide();\r\n            } else {\r\n                self.itemAddfile.show();\r\n            }\r\n        } else {\r\n            //Checks if the files count is equals to 0, to show the no files dialog\r\n            if (self.filesCount == 0) {\r\n                $(\"#no-files\", control).show();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check allow extensions and define possible choices\r\n     * @returns {}\r\n     */\r\n    checkExtensions: function () {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        self.validOptions = { audio: false, video: false, image: false, file: false };\r\n\r\n        // Preprocess the extensions string\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n\r\n        //Helps to get the non-supported extensions for mobile\r\n        var nonSupportedExtensionsArr = [];\r\n\r\n        // Initizalice the nonSupportedExtension element\r\n        self.nonSupportedExtension = \"\";\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions === \"\") {\r\n            self.validOptions = {\r\n                video: true,\r\n                image: true,\r\n                file: true\r\n            };\r\n        } else {\r\n            validExtensions = validExtensions.split(\";\");\r\n\r\n            if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n                self.validOptions.video = true;\r\n                self.validOptions.image = true;\r\n            } else {\r\n                for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n                    validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n                    if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.file = true;\r\n                    } else if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.image = true;\r\n                    } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.video = true;\r\n                    } else {\r\n                        //If the extension is not part or any category, it is stored in nonSupportedExtensions array\r\n                        nonSupportedExtensionsArr.push(validExtensions[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!self.validOptions.file && !self.validOptions.image && !self.validOptions.video) {\r\n            if (typeof (self.itemAddfile) !== \"undefined\") {\r\n                self.itemAddfile.hide();\r\n            }\r\n        }\r\n\r\n        // Get upload options\r\n        self.getUploadChoices();\r\n\r\n        // Adjust file extension, in order to make it multiline & Stores the non-supported extensions\r\n        self.nonSupportedExtension = nonSupportedExtensionsArr.join(\", \") || \"\";\r\n    },\r\n\r\n    /**\r\n     * Check if the maximun number of files than can be uploaded has been reached\r\n     * @returns {}\r\n     */\r\n    itIsMaxNumberFilesReached: function () {\r\n        var maxFiles = this.properties.maxfiles;\r\n        var actualFiles = this.properties.value ? this.properties.value.length : 0;\r\n\r\n        return maxFiles !== 0 && (actualFiles >= maxFiles);\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(prefix + \"xpath\", self.getUploadXpath());\r\n        formData.append(prefix + \"idRender\", self.properties.id);\r\n        formData.append(prefix + \"xpathContext\", self.properties.xpathContext || this.getXpathContext());\r\n        formData.append(prefix + self.Class.BA_PAGE_CACHE, self.properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(self.properties.xpath, dataFile);\r\n\r\n        if (self.properties.contexttype) {\r\n            formData.append(prefix + \"contexttype\", self.properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    },\r\n\r\n    /**\r\n     * Get the XpathContext in a grid\r\n     */\r\n    getXpathContext: function() {\r\n        var self = this;\r\n        if(self.grid) {\r\n            var surrogateKey = this.surrogateKey || \"\";\r\n            var self = this;\r\n            return self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @param {} context\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    processUploadFile: function (dataFile) {\r\n        var data = { url: this.properties.addUrl, formData: this.buildAddFileParams(dataFile) };\r\n        return this.dataService.processUploadFile(data);\r\n    },\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var items = $(\".ui-bizagi-render-upload-item\", self.getControl());\r\n\r\n        items.each(function (index, item) {\r\n            item = $(item);\r\n            var file = item.data();\r\n\r\n            $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                // Remove item\r\n                item.hide();\r\n                item.remove();\r\n\r\n                // Update value\r\n                self.setValue(self.files, false);\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n            });\r\n        })\r\n    },\r\n\r\n    getUploadChoices: function () {\r\n        var self = this;\r\n        var itemsUpload = [];\r\n\r\n        // Add upload options\r\n        if (self.validOptions.file && bizagi.util.media.fileAPISupported() && (bizagi.util.isAndroidDevice() && !bizagi.util.isCordovaSupported())) {\r\n            // Upload any file\r\n            itemsUpload.push({ \"guid\": 5, \"displayName\": bizagi.localization.getResource(\"render-upload-link-label\") });\r\n        }\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            if (self.validOptions.image) {\r\n                // Take photo, Choose photo\r\n                itemsUpload.push({\r\n                    \"guid\": 1,\r\n                    \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\")\r\n                });\r\n                itemsUpload.push({\r\n                    \"guid\": 2,\r\n                    \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\")\r\n                });\r\n            }\r\n\r\n            if (self.validOptions.video) {\r\n                // Take video\r\n                itemsUpload.push({\r\n                    \"guid\": 3,\r\n                    \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\")\r\n                });\r\n            }\r\n        }\r\n\r\n        // Stores the upload options\r\n        self.upload_options = [].concat(itemsUpload);\r\n    }\r\n\r\n});","/**\r\n*   Name: BizAgi smartphone Render ECM Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the ecm render class to adjust to smartphones devices\r\n*/\r\n\r\n\r\n// Extends itself\r\nbizagi.rendering.ecm.extend(\"bizagi.rendering.ecm\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, //limit: The maximum number of audio clips,videoclips, etc in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\"]\r\n}, {\r\n    renderControl: function (listControl, fileProperties) {\r\n        var self = this;\r\n\r\n        return $.when(self._super(listControl, fileProperties)).done(function (html) {\r\n            return html;\r\n        }).fail(function () {\r\n            return \"Error\";\r\n        }).always(function (html) {\r\n            self.stopLoading();\r\n            return html;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Override because of the required element\r\n     * @override\r\n     * @param argument\r\n     */\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        //Remove the required div from the dom in order to have only one any time\r\n        var control = self.getControl();\r\n        control.find(\".bz-rn-ecm-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (!self.hasValue()) {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\"></div>\");\r\n            } else {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\" style=\\\"display: none\\\"></div>\");\r\n            }\r\n\r\n            self.setPlaceHolder();\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * Override because of the required element\r\n     * @override\r\n     */\r\n    changeRequiredLabel: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        control.find(\".bz-rn-ecm-required\").remove();\r\n\r\n        var properties = self.properties;\r\n\r\n        if (properties.required) {\r\n\r\n            if (!self.checkRequired([])) {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\"></div>\");\r\n\r\n            } else {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\" style=\\\"display: none\\\"></div>\");\r\n            }\r\n        }\r\n    },\r\n\r\n    replaceControlHtml: function (html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n\r\n        var respString = $(html.replace(\"{{control}}\", replace));\r\n\r\n        if (replace === \"\") {\r\n            this.startLoading(respString);\r\n        }\r\n\r\n        return respString.get(0).outerHTML;\r\n    },\r\n\r\n    startLoading: function (holder) {\r\n        holder = holder || this.getRenderedElement();\r\n        $(\".ui-bizagi-render-control\", holder).prepend(\"<div class=\\\"innerLoader\\\"></div>\").addClass(\"bz-rn-ecm-control\");\r\n    },\r\n\r\n    stopLoading: function () {\r\n        $(\".innerLoader\", this.getControl()).remove();\r\n    },\r\n\r\n    startWaiting: function ($button) {\r\n        var $control = $button.closest(\".bz-rn-ecm-metadata\");\r\n        $button.addClass(\"loading\");\r\n        $control.find(\"input, a\").css(\"opacity\", 0.6);\r\n        $control.find(\".ui-bizagi-render-button, button, input\").prop(\"disabled\", \"disabled\");\r\n        $control.find(\"input\").prop(\"readonly\", \"readonly\");\r\n    },\r\n\r\n    stopWaiting: function ($button) {\r\n        var $control = $button.closest(\".bz-rn-ecm-metadata\");\r\n        $control.find(\"input, a\").css(\"opacity\", 1);\r\n        $control.find(\".ui-bizagi-render-button, button, input\").prop(\"disabled\", false);\r\n        $control.find(\"input\").prop(\"readonly\", false);\r\n        $control.find(\".loading\").removeClass(\"loading\");\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getControl();\r\n        var containerRender = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        self.itemAddfile = $(\".bz-rn-ecm-upload\", container);\r\n        self.$inputFile = $(\".bz-rn-upload-files-web\", control);\r\n\r\n\r\n        container.addClass(\"bz-command-edit-inline\");\r\n\r\n        setTimeout(function () {\r\n            control.parent().find(\".ui-bizagi-label\").hide();\r\n        }, 100);\r\n\r\n        if (control.find(\".bz-rn-ecm-url a\").length > 0) {\r\n            var adjustUrl = control.find(\".bz-rn-ecm-url a\").attr(\"onclick\").replace(\"../../\", \"\");\r\n            control.find(\".bz-rn-ecm-url a\").attr(\"onclick\", adjustUrl);\r\n        }\r\n\r\n        // ios native behaviour, should open files through a webview\r\n        if (bizagi.util.isNativePluginSupported()) {\r\n            var filesLinkElements = control.find(\".bz-rn-ecm-url a\");\r\n\r\n            filesLinkElements.removeAttr(\"onclick\");\r\n\r\n            filesLinkElements.on(\"click\", function () {\r\n                bizagi.loading.start();\r\n                $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function (error) {\r\n                    if (error.responseText) {\r\n                        self.getFormContainer().failHandler(error.responseText);\r\n                    }\r\n                }).always(function () {\r\n                    bizagi.loading.start();\r\n                });\r\n            });\r\n        }\r\n\r\n        self.configureHelpText();\r\n        self.closeAccordionSection();\r\n\r\n        if (!properties.editable) {\r\n            containerRender.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            containerRender.addClass(\"bz-command-edit-inline\");\r\n        }\r\n\r\n        $(\".bz-rn-ecm-activate-menu\", control).bind(\"click\", function () {\r\n            var elementBase = $(this);\r\n            var parents = elementBase.parents(\".bz-rn-ecm-metadata\");\r\n            var menu = $(\".bz-rn-ecm-menu-container\", parents);\r\n\r\n            if (!$(this).is(\".active\") && !$(\".bz-rn-ecm-metadata-container\", parents).is(\".active\")) {\r\n                self.closeAccordionSection();\r\n                $(this).addClass(\"active\");\r\n                menu.addClass(\"showMenu\");\r\n            } else if (!$(\".bz-rn-ecm-metadata-container\", parents).is(\".active\")) {\r\n                $(this).removeClass(\"active\");\r\n                self.closeAccordionSection();\r\n            }\r\n\r\n            var tmpidElement = elementBase.parent().data(\"idfileupload\") || \"\";\r\n            self.elementsEvent = {\r\n                \"menu\": menu,\r\n                \"lock\": $(\".bz-ecm-lock\", menu),\r\n                \"unlock\": $(\".bz-ecm-unlock\", menu),\r\n                \"del\": $(\".bz-ecm-delete\", menu),\r\n                \"edit\": $(\".bz-ecm-edit\", menu),\r\n                \"element\": { \"id\": tmpidElement, \"filename\": elementBase.parent().attr(\"title\") || \"\", elementReference: this },\r\n                \"params\": { idFileUpload: tmpidElement, xPath: self.properties.xpath, idAttrib: self.properties.idAttrib, idPageCache: self.properties.idPageCache, xpathContext: self.getXpathContext() },\r\n                \"panelMetadata\": $(\".bz-rn-ecm-metadata-container\", parents),\r\n                \"btnCancel\": $(\".ecm-btn-cancel\", parents),\r\n                \"btnSave\": $(\".ecm-btn-save\", parents)\r\n            };\r\n\r\n            if (menu.is(\":visible\")) {\r\n                self.addEventsEcm();\r\n            } else {\r\n                self.removeEventsEcm();\r\n            }\r\n        });\r\n\r\n        if (!properties.editable) {\r\n            self.itemAddfile.hide();\r\n            return;\r\n        }\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            // Upload items\r\n            var itemsUpload = self.checkExtensions();\r\n\r\n            // Upload image\r\n            $(self.itemAddfile).actionSheet({\r\n                actions: itemsUpload,\r\n                actionClicked: function (action) {\r\n                    self.handlerUploadImage(action.guid);\r\n                }\r\n            });\r\n\r\n            self.checkMaxFiles();\r\n        }\r\n        else {\r\n            if (bizagi.util.media.fileAPISupported()) {\r\n                $(self.itemAddfile).off(\"click\").click(function () {\r\n                    self.$inputFile.click();\r\n                });\r\n            } else {\r\n                // Bloquea la acción de carga de archivos\r\n                self.itemAddfile.hide();\r\n            }\r\n\r\n            // Just in case\r\n            self.$inputFile.off(\"click\").on(\"click\", function (e) { e.stopPropagation(); });\r\n\r\n            // Image change (Web only)\r\n            self.$inputFile.off(\"click\").on(\"change\", function () {\r\n                var dataFile = self.$inputFile[0].files[0];\r\n                dataFile.fullPath = self.$inputFile[0].value;\r\n                var extensions = [].concat(self.Class.EXTENSIONSIMG, self.Class.EXTENSIONSVIDEO, self.Class.EXTENSIONSAUDIO);\r\n\r\n                self.startLoading();\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                    $.when(self.uploadFile(dataFile)).done(function (result) {\r\n                        if (typeof result !== \"object\") {\r\n                            // onUploadFileCompleted 2nd param needs to be a response object\r\n                            result = {\r\n                                response: result\r\n                            };\r\n                        }\r\n                        self.onUploadFileCompleted(self, result);\r\n                    }).fail(function (error) {\r\n                        self.stopLoading();\r\n\r\n                        if (error.statusText !== \"Unauthorized\") {\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n                        }\r\n\r\n                        if (error.code === 3) {\r\n                            bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n                        } else {\r\n                            bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n                        }\r\n                        bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n                    });\r\n\r\n                } else {\r\n                    self.stopLoading();\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    closeAccordionSection: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var menuItem = $(\".bz-rn-ecm-activate-menu\", control);\r\n        var menu = $(\".bz-rn-ecm-menu-container\", control);\r\n        var metadata = $(\".bz-rn-ecm-metadata-container\", control);\r\n\r\n        menuItem.removeClass(\"active\");\r\n        menu.removeClass(\"showMenu\");\r\n\r\n        metadata.removeClass(\"active\");\r\n        metadata.slideUp(300).removeClass(\"open\");\r\n    },\r\n\r\n    addEventsEcm: function () {\r\n        var self = this;\r\n        self.removeEventsEcm();\r\n\r\n        self.getControl().find(\".bz-rn-ecm-header .bz-mo-icon.bz-plus[data-action=\\\"add\\\"]\").click(function (event) {\r\n            event.preventDefault();\r\n        });\r\n\r\n        self.elementsEvent.lock.click(function () {\r\n            $.when(self.dataService.checkOutFile(self.elementsEvent.params)).done(function () {\r\n                self.elementsEvent.lock.removeClass(\"bz-ecm-item-menu-enable\");\r\n                self.elementsEvent.unlock.addClass(\"bz-ecm-item-menu-enable\");\r\n\r\n            });\r\n        });\r\n        self.elementsEvent.unlock.click(function () {\r\n            $.when(self.dataService.cancelCheckOut(self.elementsEvent.params)).done(function () {\r\n                self.elementsEvent.unlock.removeClass(\"bz-ecm-item-menu-enable\");\r\n                self.elementsEvent.lock.addClass(\"bz-ecm-item-menu-enable\");\r\n            });\r\n        });\r\n\r\n        var nTimeoutAccordionSection = null;\r\n\r\n        self.elementsEvent.del.bind(\"click\", function () {\r\n            // To avoid to be triggered more than once\r\n            clearTimeout(nTimeoutAccordionSection);\r\n            self.closeAccordionSection();\r\n            self.startLoading();\r\n\r\n            $(self.elementsEvent.element.elementReference).closest(\".bz-rn-ecm-metadata\").css(\"opacity\", 0.5);\r\n\r\n            $.when(self.dataService.deleteECMFile(self.elementsEvent.params)).done(function () {\r\n                self.removeEventsEcm();\r\n                $(self.elementsEvent.element.elementReference).parents(\".bz-rn-ecm-metadata\").remove();\r\n\r\n                //Set files in a temporal array\r\n                var files = [].concat(self.files);\r\n\r\n                //Remove element form files array\r\n                for (var i = 0; i < files.length; i++) {\r\n                    if (files[i][0] === self.elementsEvent.params.idFileUpload) {\r\n                        files.splice(i, 1);\r\n                    }\r\n                }\r\n\r\n                //Set Value\r\n                self.setValue(files);\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n            }).always(function () {\r\n                $(self.elementsEvent.element.elementReference).closest(\".bz-rn-ecm-metadata\").css(\"opacity\", 1);\r\n                self.stopLoading();\r\n            });\r\n        });\r\n\r\n        self.setMobiscroll();\r\n\r\n        self.elementsEvent.edit.click(function () {\r\n            // To avoid to be triggered more than once\r\n            clearTimeout(nTimeoutAccordionSection);\r\n            self.closeAccordionSection();\r\n\r\n            if (!self.elementsEvent.panelMetadata.is(\".active\")) {\r\n                self.elementsEvent.panelMetadata.addClass(\"active\");\r\n                nTimeoutAccordionSection = setTimeout(function () {\r\n                    self.elementsEvent.panelMetadata.stop().slideDown(300).addClass(\"open\");\r\n                }, 200);\r\n            }\r\n        });\r\n\r\n        self.elementsEvent.btnSave.click(function () {\r\n            var properties = self.properties;\r\n            var elementsToCheck = $(\".bz-rn-ecm-metadata-value\", self.elementsEvent.panelMetadata);\r\n            var metadata = [];\r\n            var isInvalid = false;\r\n            var $button = $(this);\r\n\r\n            // To avoid to be triggered more than once\r\n            clearTimeout(nTimeoutAccordionSection);\r\n            //self.closeAccordionSection();\r\n            //self.startLoading( );\r\n            self.startWaiting($button);\r\n\r\n            for (var metadataelement = 0; metadataelement < elementsToCheck.length; metadataelement++) {\r\n                var tmpElement = elementsToCheck[metadataelement];\r\n                var oldValue = $(tmpElement).data(\"value\");\r\n                var type = $(tmpElement).data(\"metadatatype\");\r\n                var required = $(tmpElement).data(\"required\");\r\n                var readonly = $(tmpElement).data(\"readonly\");\r\n                var description = $(tmpElement).data(\"description\");\r\n                var idmetadata = $(tmpElement).data(\"idmetadata\");\r\n                var actualValue = null;\r\n\r\n                if (readonly) {\r\n                    self.stopLoading();\r\n                    self.stopWaiting($button);\r\n                    return true;\r\n                }\r\n\r\n                if (type === \"STRING\" || type === \"DECIMAL\") {\r\n                    actualValue = $(\"input\", tmpElement).val();\r\n                } else if (type === \"BOOL\") {\r\n                    actualValue = $(\"input[name=ecm-radio]:checked\", tmpElement).val();\r\n                } else if (type === \"DATETIME\") {\r\n                    var format = (self.properties.fullFormat ? self.properties.fullFormat : (self.getResource(\"fullFormat\") != \"fullFormat\" ? self.getResource(\"fullFormat\") : \"yyyy-MM-dd HH:mm:ss\"));\r\n                    actualValue = bizagi.util.dateFormatter.formatDate(bizagi.util.dateFormatter.getDateFromISO($(\"input\", tmpElement).attr(\"value\"), false), format);\r\n                }\r\n\r\n                if (required && (actualValue === \"\" || actualValue === null)) {\r\n                    bizagi.showMessageBox(description + \": \" + self.getResource(\"render-ecm-tooltip-mandatory\"), \"Error\");\r\n                    isInvalid = true;\r\n                }\r\n\r\n                if (!isInvalid && actualValue != oldValue) {\r\n                    metadata.push({\r\n                        idMetadata: idmetadata,\r\n                        value: actualValue\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (!isInvalid) {\r\n                var params = self.buildAddParams();\r\n                params.fileName = self.elementsEvent.element.filename;\r\n                params.idFileUpload = self.elementsEvent.element.id;\r\n                params.idPageCache = properties.idPageCache;\r\n                params.metaValues = JSON.encode({\r\n                    metadataValues: metadata\r\n                });\r\n\r\n                $.when(self.dataService.updateECMMetadata(params)).done(function () {\r\n                    self.stopLoading();\r\n                    self.stopWaiting($button);\r\n                });\r\n            }\r\n            else {\r\n                self.stopLoading();\r\n                self.stopWaiting($button);\r\n            }\r\n        });\r\n\r\n        self.elementsEvent.btnCancel.click(function () {\r\n            self.closeAccordionSection();\r\n            self.removeEventsEcm();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the date picker for the DOM.bz-ecm-metadata-date elements\r\n     */\r\n    setMobiscroll: function () {\r\n        var self = this;\r\n        var metadataElements = self.elementsEvent.panelMetadata.find(\".bz-ecm-metadata-date\");\r\n        metadataElements.each(function (index, input) {\r\n            var $input = $(input);\r\n            var value = $input.attr(\"value\");\r\n            var now = new Date();\r\n            var valueDate = (value ? new Date(value) : now);\r\n            var minDate = (now.getTime() < valueDate.getTime() ? now : valueDate);\r\n\r\n            minDate.setFullYear(minDate.getFullYear() - 2);\r\n\r\n            $input.mobiscroll().calendar({\r\n                mode: \"mixed\", // Specify scroller mode like: mode: \"mixed\" or omit setting to use default\r\n                display: \"bottom\", // Specify display mode like: display: \"bottom\" or omit setting to use default\r\n                controls: [\"calendar\"],\r\n                min: minDate,\r\n                defaultValue: valueDate,\r\n                lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n                onSet: function (valueText) {\r\n                    // It seems like the plugin doesn't sets the value\r\n                    $input.attr(\"value\", valueText);\r\n                    $input.closest(\".bz-rn-ecm-metadata-item\").find(\".bz-rn-ecm-meta-required\").removeClass(\"bz-rn-ecm-meta-required\");\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    removeEventsEcm: function () {\r\n        var self = this;\r\n\r\n        self.elementsEvent.lock.unbind(\"click\");\r\n        self.elementsEvent.unlock.unbind(\"click\");\r\n        self.elementsEvent.del.unbind(\"click\");\r\n        self.elementsEvent.edit.unbind(\"click\");\r\n        self.elementsEvent.btnSave.unbind(\"click\");\r\n        self.elementsEvent.btnCancel.unbind(\"click\");\r\n    },\r\n\r\n    handlerUploadImage: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        bizagi.loading.start();\r\n\r\n        if (actionSelected === 2) {\r\n            // Select picture\r\n            navigator.camera.getPicture(function (dataImage) {\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function () {\r\n                    $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                        self.fileProperties = fileData;\r\n                        self.saveImage(self, dataImage);\r\n                    });\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                sourceType: Camera.PictureSourceType.PHOTOLIBRARY\r\n            });\r\n        } else if (actionSelected === 1) {\r\n            // Take picture\r\n            navigator.camera.getPicture(function (dataImage) {\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function () {\r\n                    $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                        self.fileProperties = fileData;\r\n                        self.saveImage(self, dataImage);\r\n                    });\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            },\r\n            self.onFail,\r\n            {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                sourceType: navigator.camera.PictureSourceType.CAMERA,\r\n                mediaType: navigator.camera.MediaType.PICTURE,\r\n                destinationType: Camera.DestinationType.FILE_URI,\r\n                correctOrientation: true\r\n\r\n            });\r\n        } else if (actionSelected === 3) {\r\n            // Capture video\r\n            navigator.device.capture.captureVideo(function (dataImage) {\r\n                $.when(bizagi.util.media.checkMaxSizeVideo(dataImage, self.properties)).done(function () {\r\n                    self.saveVideo(self, dataImage);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, { limit: self.Class.LIMIT });\r\n        } else if (actionSelected === 4) {\r\n            // Capture audio\r\n            navigator.device.capture.captureAudio(function (mediaFiles) {\r\n                var audioUrl = mediaFiles[0].localURL;\r\n                $.when(bizagi.util.media.checkMaxSize(audioUrl, self.properties)).done(function () {\r\n                    self.saveAudio(self, mediaFiles);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, { limit: self.Class.LIMIT });\r\n        }\r\n    },\r\n\r\n    renderUploadItem: function (file) {\r\n        return this._super(file);\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function (dataFile) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n            bizagi.util.media.checkFileTypes(dataFile, self.properties, [].concat(self.Class.EXTENSIONSIMG, self.Class.EXTENSIONSVIDEO, self.Class.EXTENSIONSAUDIO))) {\r\n\r\n            // Get form data for POSTing\r\n            var formData = new FormData();\r\n            var form = self.getFormContainer();\r\n            var data = self.buildAddParams();\r\n\r\n            var keys = Object.keys(data);\r\n            keys.map(function (key) {\r\n                formData.append(key, data[key]);\r\n            });\r\n\r\n            formData.append(\"Filedata\", dataFile);\r\n            // It seems like some OS uses \\ instead of / so ...\r\n            formData.append(\"Filename\", dataFile.name.substr(dataFile.name.replace(/([\\\\\\/]+)/g, \"/\").lastIndexOf(\"/\") + 1));\r\n\r\n            if (self.properties.contexttype) {\r\n                formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", self.properties.contexttype);\r\n            }\r\n\r\n            try {\r\n                if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                    formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n                } else {\r\n                    formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n                }\r\n            } catch (e) {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n\r\n            self.dataService.processUploadFile({\r\n                url: self.properties.addUrl,\r\n                formData: formData\r\n            }).done(function (response) {\r\n                defer.resolve(response);\r\n            }).fail(function (error) {\r\n                defer.reject(error);\r\n            });\r\n\r\n        } else {\r\n            bizagi.loading.stop();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    saveImage: function (context, dataImage) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        var fileName = self.fileProperties.name;\r\n\r\n        if (self.editedImageURL) {\r\n            params.dataFile = self.editedImageURL;\r\n        } else if (self.fileProperties) {\r\n            params.dataFile = self.fileProperties.url;\r\n        }\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.mimeType = \"image/jpeg\";\r\n        params.options.uploadKey = { key: addParams[\"xPath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n\r\n        //Cleans variables related previous uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function (error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function () {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    saveAudio: function (context, dataAudio) {\r\n        var self = context;\r\n        var params = {};\r\n        var fileName = dataAudio[0].name;\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.uploadKey = { key: addParams[\"xPath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataAudio[0].fullPath;\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function (error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function () {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    saveVideo: function (context, dataVideo) {\r\n        var self = context;\r\n        var params = {};\r\n        var fileName = dataVideo[0].name;\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.uploadKey = { key: addParams[\"xPath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataVideo[0].fullPath;\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function (error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function () {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    onFail: function (error) {\r\n        bizagi.log(\"Error code: \" + error.code);\r\n    },\r\n\r\n    onUploadFileCompleted: function (context, response) {\r\n        var self = this;\r\n\r\n        try {\r\n            response = JSON.parse(decodeURI(response.response));\r\n\r\n            if (response.idFileUpload != \"undefined\" && response.idFileUpload !== null) {\r\n\r\n                //self.submitOnChange();\r\n                var control = self.getControl();\r\n\r\n                //Increment counter\r\n                self.filesCount = self.filesCount + 1;\r\n                var files = [].concat(self.files);\r\n                files.push([response.idFileUpload, response.fileName]);\r\n\r\n                //Set Value\r\n                self.setValue(files, false);\r\n\r\n                $.when(self.renderControl(null, null)).done(function (result) {\r\n                    control.html(result);\r\n                    self.postRenderSingle();\r\n                });\r\n            } else {\r\n                throw \"not present idFileUpload\";\r\n            }\r\n\r\n        } catch (e) {\r\n            bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            bizagi.log(\"Error ECM:\");\r\n            bizagi.log(e);\r\n        }\r\n    },\r\n\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var maxFiles = properties.maxfiles;\r\n        var actualFiles = properties.value.length;\r\n\r\n        if (maxFiles !== 0 && (actualFiles >= maxFiles)) {\r\n            self.itemAddfile.hide();\r\n        }\r\n    },\r\n\r\n    checkExtensions: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var validExtensions = properties.validExtensions;\r\n\r\n        var enableVideo = false;\r\n        var enableAudio = false;\r\n        var enableImage = false;\r\n\r\n        var itemsUpload = [];\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions === \"\") {\r\n            enableVideo = enableAudio = enableImage = true;\r\n        } else {\r\n            validExtensions = validExtensions.split(\";\");\r\n\r\n            if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n                enableVideo = enableAudio = enableImage = true;\r\n            } else {\r\n                for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n                    validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n                    if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        enableImage = true;\r\n                    }\r\n\r\n                    if (self.Class.EXTENSIONSAUDIO.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        enableAudio = true;\r\n                    }\r\n\r\n                    if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        enableVideo = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!enableAudio && !enableImage && !enableVideo) {\r\n            self.itemAddfile.hide();\r\n        }\r\n\r\n        // Add image options\r\n        if (enableImage) {\r\n            itemsUpload.push({ \"guid\": 1, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\") });\r\n            itemsUpload.push({ \"guid\": 2, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\") });\r\n        }\r\n\r\n        // Audio & Video options will be disabled for a while\r\n        /*\r\n        // Add video options\r\n        if (enableVideo) {\r\n            itemsUpload.push({ \"guid\": 3, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\") });\r\n        }\r\n    \r\n        // Add audio options\r\n        if (enableAudio) {\r\n            itemsUpload.push({ \"guid\": 4, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-record-audio\") });\r\n        }\r\n        */\r\n\r\n        return itemsUpload;\r\n    },\r\n\r\n    validateFileExtensions: function (nameArchivo) {\r\n        var validExtensions = /(.jpg|.gif|.png|.bmp|.jpeg|.mov|.avi|.mpg|.mpeg|.3gp|.asf|.wmv|.flv|.mp4)$/i;\r\n\r\n        return (validExtensions.test(nameArchivo));\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            if (metaData[0].metadata && metaData[0].metadata.length) {\r\n                metaData[0].metadata.map(function shapeMetadataValues(meta) {\r\n                    if (meta.metadataType === \"DATETIME\") {\r\n                        // Format the actual date to ISO, so mobiscroll can useit\r\n                        // Before save the value it has to go back to the original format (cause service will accept any format)\r\n                        meta.dateFormat = (self.getResource(\"fullFormat\") !== \"fullFormat\" ? self.getResource(\"fullFormat\") : (self.properties.fullFormat ? self.properties.fullFormat : \"yyyy-MM-dd HH:mm:ss\"));\r\n                        meta.value = (meta.value ? bizagi.util.dateFormatter.formatDate(bizagi.util.dateFormatter.getDateFromFormat(meta.value, meta.dateFormat), \"yyyy-MM-dd\") : \"\");\r\n                    }\r\n                });\r\n            }\r\n\r\n            var html = $.kendoTmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*Check if all meta data fields that's right */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            control = self.getControl(),\r\n            message = [],\r\n            error = false,\r\n            properties = self.properties;\r\n\r\n\r\n        var bValid = true;\r\n\r\n        if (properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n            // Call base\r\n            bValid = newRow ? true : this._super(invalidElements);\r\n\r\n            if (self.filesCount === 0 && bValid) {\r\n\r\n                invalidElements.push({\r\n                    xPath: properties.xpath,\r\n                    message: self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName)\r\n                });\r\n                bValid = false;\r\n            }\r\n        }\r\n\r\n        if (properties.editable) {\r\n            var $arrayEcmControls = $(\".bz-rn-ecm-container:visible\", control).find(\".bz-rn-ecm-metadata-value[data-required='true']\");\r\n            $.each($arrayEcmControls, function (key, value) {\r\n                if ($(\"input\", value).val() === \"\") {\r\n                    message.push($(value).data(\"description\"));\r\n                    error = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        if (error) {\r\n            var errorMessage = self.getResource(\"render-required-text\").replaceAll(\"#label#\", message.join(\", \"));\r\n            invalidElements.push({\r\n                xPath: properties.xpath,\r\n                message: errorMessage\r\n            });\r\n\r\n            // If it has error, enable editable view.\r\n            // open popup\r\n\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(null);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var arrayItems = control.find(\".bz-rn-ecm-file-container\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.idfileupload)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.searchList.extend(\"bizagi.rendering.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2,\r\n    temporalElements: {}\r\n}, {\r\n    /**\r\n     * RenderSingle Method\r\n     * */\r\n    renderSingle: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n\r\n        //Show the combo icon\r\n        self.getArrow().remove();\r\n\r\n        //Getting all aux templates\r\n        self.modalViewTemplates = kendo.template(self.renderFactory.getTemplate('searchListModalViewAuxTemplates'), { useWithBlock: false });\r\n        self.inputTemplates = kendo.template(self.renderFactory.getTemplate('searchListInputAuxTemplates'), { useWithBlock: false });\r\n\r\n        //Getting the input\r\n        self.input = $(\".bz-rn-container-searchlist\", control);\r\n\r\n        self.configureListHandlers();\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        if (!self.properties.editable) {\r\n            //Add styles class\r\n            self.configureReadOnly();\r\n        }\r\n\r\n        //trigger click event on remove tag\r\n        self.input.on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Setting the control events\r\n     * */\r\n    configureListHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            if (self.properties.value.length > 0) {\r\n                self.configureModalView(\".bz-rn-last-child\");\r\n            } else {\r\n                self.configureModalView(\"ul\");\r\n                self.configureModalView(\".bz-rn-last-child\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure the modal view to select values\r\n     * */\r\n    configureModalView: function(selector) {\r\n        var self = this;\r\n        var inputContainer = (selector === \"\") ? self.input : $(selector, self.input);\r\n\r\n        inputContainer.unbind().bind(\"click\", function() {\r\n            //Getting the values to show\r\n            var elements = $(\"ul li.bz-rn-regular-element\", self.input);\r\n            var values = [];\r\n\r\n            //Reset the temporal array\r\n            self.Class.temporalElements = {};\r\n\r\n            for (var i = 0, length = elements.length; i < length; i++) {\r\n                var id = $(elements[i]).data(\"id\");\r\n                var value = $(\"label\", $(elements[i])).text();\r\n                var newElement = { 'id': id, 'value': value };\r\n\r\n                values.push(newElement);\r\n\r\n                //Add element to temporal context array\r\n                self.addTemporalElement(id, value, false);\r\n            }\r\n\r\n            //Creating modal view\r\n            var template = self.renderFactory.getTemplate('searchListModalView');\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                'items': values,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n            var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView('open');\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        //Showing found results\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('keypress keyup', function () {\r\n            if (this.value !== \"\") {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n            } else {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n            }\r\n\r\n            //Show splash loader\r\n            bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n\r\n            //Getting and showing the data\r\n            $.when(self.showResults(this.value, inputContainer)).always(function () {\r\n                bizagi.loading.stop({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n            });\r\n        }).focus(function(){\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").addClass(\"searching\");\r\n        }).blur(function(){\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").removeClass(\"searching\");\r\n        });\r\n\r\n        //Cleaning search\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function () {\r\n            self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //when click on apply button\r\n        inputContainer.delegate(\".ui-bizagi-apply-button-searchlist\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Trigger delete event for tags\r\n        inputContainer.find(\".filter-searchlist-modal-view-tags\").on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this), true);\r\n\r\n            var term = inputContainer.find(\".bz-wp-modalview-header-input-search\").val();\r\n\r\n            //Show splash loader\r\n            bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n\r\n            //Getting and showing the data\r\n            $.when(self.showResults(term, inputContainer)).always(function () {\r\n                bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n            });\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            self.addNewValuesToInput();\r\n            self.Class.temporalElements = {};\r\n        }).fail(function () {\r\n            self.Class.temporalElements = {};\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show finded results\r\n     * */\r\n    showResults: function (value, inputContainer) {\r\n        var self = this;\r\n\r\n        return $.when(self.processRequest({ 'term': value })).done(function (suggestions) {\r\n            if (suggestions.length === 0) {\r\n                self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n            } else {\r\n                //Hide current results\r\n                $(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul li\", inputContainer).remove();\r\n\r\n                //Add new results to list\r\n                var newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"sugestions\", 'items': suggestions }))));\r\n                newElement.appendTo($(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul\", inputContainer));\r\n\r\n                //Get list of elements\r\n                self.modalViewList = $(\".ui-bizagi-render-list-elements\", inputContainer);\r\n\r\n                //Setting the initial selected display value\r\n                self.modalViewList.find(\"li\").unbind().bind(\"click\", function () {\r\n                    //add new element to data control\r\n                    self.appendFoundItem(this, $(\".filter-searchlist-modal-view-tags\", inputContainer));\r\n\r\n                    if ($(this).siblings().length === 0) {\r\n                        self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n                    }\r\n\r\n                    $(this).remove();\r\n                });\r\n            }\r\n        }).fail(function (response) {\r\n            self.showNoResultsMessage(response, inputContainer);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Adding new values to input\r\n     * */\r\n    addNewValuesToInput: function () {\r\n        var self = this;\r\n\r\n        //Create a temporal array\r\n        var tempArray = [];\r\n\r\n        $.each(self.Class.temporalElements, function (i, ele) {\r\n            tempArray.push(ele.obj);\r\n        });\r\n\r\n        self.setValue(tempArray);\r\n\r\n        //Clear the input\r\n        $(\"ul li\", self.input).remove();\r\n\r\n        //Get the input content\r\n        var inputContainer = $(\"li\", $(bizagi.util.trim(self.inputTemplates({ 'template': \"inputContainer\", 'value': tempArray }))));\r\n\r\n        //Add the input container\r\n        inputContainer.appendTo($(\"ul\", self.input));\r\n\r\n        //unbind current events\r\n        $(\"ul\", self.input).unbind();\r\n        $(\".bz-rn-last-child\", self.input).unbind();\r\n\r\n        //Trigger click event\r\n        if (tempArray.length > 0) {\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        } else {\r\n            self.configureModalView(\"ul\");\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   check if the control has value\r\n     */\r\n    hasValue: function () {\r\n        var self = this;\r\n        return JSON.parse(self.getValue()).value.length > 0;\r\n    },\r\n\r\n    /*\r\n     *   Sets the internal value\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        // Change internal value\r\n        self.value = JSON.encode({\"value\": value});\r\n\r\n        self.changeRequiredLabel();\r\n        // Trigger events\r\n        if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n            self.triggerRenderChange();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the correct message if there are elements to show\r\n     * */\r\n    showNoResultsMessage: function (message, inputContainer) {\r\n        var self = this;\r\n        $(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul li\", inputContainer).remove();\r\n        var newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"modalViewDefaultMessage\", 'message': message }))));\r\n        newElement.appendTo($(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul\", inputContainer));\r\n    },\r\n\r\n    /**\r\n     * Append founded item\r\n     * */\r\n    appendFoundItem: function (item, container) {\r\n        var self = this;\r\n\r\n        // Map the ids of the elements to an array\r\n        var uniqueIds = $.map($('li', container), function (val) {\r\n            return $(val).data('id');\r\n        });\r\n\r\n        // Avoid appending duplicated items\r\n        if (uniqueIds.indexOf($(item).data(\"id\")) == -1) {\r\n            var id = $(item).data(\"id\");\r\n            var value = $(\"label\", item).text();\r\n            var $newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"fullElement\", 'id': id, 'value': value }))));\r\n\r\n            // Get the latest item on list to append new li with match word\r\n            var lastElement = $('li:last', container);\r\n            if (lastElement.hasClass(\"bz-rn-any-element\")) {\r\n                lastElement.remove();                \r\n                $('ul', container).prepend($newElement);\r\n            } else {                \r\n                $('ul', container).prepend($newElement);\r\n            }\r\n\r\n            self.addTemporalElement($(item).data(\"id\"), $(\"label\", item).text(), false);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Removen a item from the list\r\n     * */\r\n    removeItem: function (element, isModalViewContainer) {\r\n        var self = this;\r\n        var li = element.parent();\r\n        var container = element.closest(\".bz-rn-container-searchlist\");\r\n\r\n        if (container.length === 0) {\r\n            container = element.closest(\".filter-searchlist-modal-view-tags\");\r\n        }\r\n\r\n        if (!isModalViewContainer) {\r\n            // Remove from main memory and set the new value\r\n            self.removeElement({ id: li.data(\"id\") });\r\n        } else {\r\n            delete self.Class.temporalElements[li.data(\"id\")];\r\n        }\r\n\r\n        // Remove list element\r\n        li.remove();\r\n\r\n        if (container.find(\"li\").length <= 1 && !isModalViewContainer) {\r\n            $(\".bz-rn-click-to-add-span\", container).removeClass(\"hidden\");\r\n            self.configureModalView(\"ul\");\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        } else if (container.find(\"li\").length === 0 && isModalViewContainer) {\r\n            var defaultElement = $(bizagi.util.trim(self.modalViewTemplates({ \"template\": \"modalViewDefaultValue\" })));\r\n            $(\"li\", defaultElement).appendTo($(\"ul\", container));\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Process the request data for the autocomplete control\r\n     */\r\n    processRequest: function (req) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n        var defer = new $.Deferred();\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            this.getData()\r\n                    .done(function (data) {\r\n\r\n                        // Process response to highlight matches\r\n                        $.each(data, function (i, val) {\r\n                            var parseValue;\r\n                            switch (typeof val.value) {\r\n                                case \"number\":\r\n                                    parseValue = val.value;\r\n                                    break;\r\n                                case \"object\":\r\n                                    parseValue = val.value.toString();\r\n                                    break;\r\n                                case \"string\":\r\n                                    parseValue = val.value.replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + req.term + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"), \"<strong>$1</strong>\");\r\n                                    break;\r\n                                default:\r\n                                    parseValue = val.value;\r\n                                    break;\r\n                            }\r\n\r\n                            if (typeof self.Class.temporalElements[val.id] === \"undefined\") {\r\n                                suggestions.push({\r\n                                    id: val.id,\r\n                                    label: parseValue,\r\n                                    value: val.value\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                        defer.resolve(suggestions);\r\n                    });\r\n        } else {\r\n            defer.reject(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"));\r\n        }\r\n\r\n        return defer;\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        // Set internal value\r\n        self.setValue(finalValue);\r\n\r\n        if (value !== undefined) {\r\n            if (properties.editable) {\r\n                self.input.val(value.label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * When the render isn't editable\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.kendoTmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            editable: false\r\n        });\r\n    },\r\n\r\n    configureReadOnly: function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Remove click event\r\n        $(\".bz-rn-last-child\", control).unbind(\"click\");\r\n        $(\".bz-rn-searchlist-search-icon\", control).unbind(\"click\");\r\n\r\n        //hide all elements\r\n        $(\".bz-rn-click-to-add-span\", control).remove();\r\n\r\n        // Remove \"x\" icon from each element on the list\r\n        $(\".bz-rn-remove-tag-on-search-list\", control).remove();\r\n\r\n        self.input.addClass(\"searchListNonEditable\");\r\n    },\r\n\r\n    /**\r\n     * Add new element to the temporal array\r\n     * */\r\n    addTemporalElement: function (id, value, elementToRemove) {\r\n        var self = this;\r\n\r\n        if (self.Class.temporalElements[id]) {\r\n            delete self.Class.temporalElements[id];\r\n        }\r\n\r\n        self.Class.temporalElements[id] = { \"obj\": { \"id\": id, \"value\": value }, \"remove\": elementToRemove };\r\n    }\r\n});","/*\r\n*   Name: Bizagi Smartphone Render Grid Extension\r\n*   Author: Richar Urbano <Richar.Urbano@Bizagi.com>\r\n*   Comments:\r\n*   -   This script will redefine the grid render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.render.extend(\"bizagi.rendering.grid.beta\", {}, {\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        self.params = params;\r\n\r\n        // Call base\r\n        self._super(params);\r\n    },\r\n\r\n    /**\r\n     * Returns the grid template to be used\r\n     * @returns {} \r\n     */\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid-control\");\r\n    },\r\n\r\n    /**\r\n     * Applies the template to the render and returns the resolved element\r\n     * @param {} template \r\n     * @returns {} \r\n     */\r\n    applyTemplate: function (template) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var orientation = self.properties.orientation;\r\n\r\n        // TODO: helptext\r\n        return $.kendoTmpl(template, {\r\n            id: bizagi.util.encodeXpath(properties.xpath),\r\n            displayName: bizagi.util.encodeXpath(properties.displayName),\r\n            orientation: orientation\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {} Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var template = self.getGridTemplate();\r\n\r\n        // Render template\r\n        var html = self.applyTemplate(template);\r\n        defer.resolve(html);\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var container = self.getContainerRender();\r\n\r\n        container.addClass(\"bz-command-edit-inline\");\r\n        container.find(\".ui-bizagi-label\").hide();\r\n        self.getArrowContainer().hide();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Render Edition       \r\n        $(self.element).on(\"click\", function (e) {\r\n            bizagi.loading.start();\r\n            setTimeout(function () {\r\n                $.when(self.renderEdition())\r\n                .then(function (gridView) {\r\n                    gridView.postRenderSingle();\r\n                });\r\n            }, 1);\r\n\r\n        });\r\n    },\r\n\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var deferred = $.Deferred();\r\n\r\n        self.params.pane = control.closest('div[data-role=\"pane\"]');\r\n\r\n        // Render grid view        \r\n        var grid = new bizagi.rendering.smartphone.helpers.grid(self.params);\r\n        deferred.resolve(grid);\r\n\r\n        return deferred.promise();\r\n    }\r\n\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi smartphone view form implementation\r\n *   Author: Richar Urbano <Richar.Urbano@Bizagi.com>\r\n *   Comments:\r\n *   -   Serves as a view form that can render a inner grid form\r\n */\r\nbizagi.rendering.grid.extend(\"bizagi.rendering.smartphone.helpers.grid\", {\r\n  GRID_PAGE_SIZE: 10\r\n}, {\r\n\r\n  /**\r\n   * init\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  init: function(params) {\r\n      var self = this;\r\n      var data = params.data;\r\n\r\n      if (typeof (params.pane) !== \"undefined\") {\r\n          self.pane = params.pane;\r\n          //self.pane = params.pane.data(\"kendoMobilePane\");\r\n      } else {\r\n          console.warn(\"Es necesario asignar un pane a la forma {pane: $pane} para evitar problemas de navegación entre vistas de Kendo\");\r\n      }\r\n\r\n      // Create a single instance for each cell\r\n      data.properties.singleInstance = false;\r\n\r\n      // Call base\r\n      self._super(params);\r\n\r\n      // Create a data-structure to keep track of each cell properties\r\n      self.cellMetadata = {};\r\n\r\n      // Fill default properties\r\n      var properties = self.properties;\r\n      //var form = self.getFormContainer();\r\n\r\n      // Just apply display-type: vertical, align it to the left\r\n      properties.displayType = \"vertical\";\r\n      properties.labelAlign = \"left\";\r\n\r\n      // Editable property\r\n      // Revisar base para mejorar comportamiento cuando esta en false los elementos\r\n      $.each(self.columns, function() {\r\n          if (self.properties && self.properties.editable) {\r\n              self.properties.editable = (properties.allowEdit === true);\r\n          }\r\n      });\r\n\r\n      // Create container & Render template\r\n      var template = self.getViewTemplate();\r\n      self.gridView = $(self.applyTemplate(template));\r\n      self.pane.append(self.gridView);\r\n\r\n      // <stretch> If set to true, the view will stretch its child contents to occupy the entire view,\r\n      // while disabling kinetic scrolling. Useful if the view contains an image or a map.\r\n      // <useNativeScrolling> If set to true, the view will use the native scrolling available in the current platform\r\n      self.view = new kendo.mobile.ui.View(self.gridView, {\r\n          \"useNativeScrolling\": false,\r\n          stretch: true,\r\n          init: function() {\r\n              self.attachHandlers();\r\n          }\r\n\r\n      });\r\n\r\n      self.scrollContent = $(\"#\" + bizagi.util.encodeXpath(properties.xpath), self.view.contentElement());\r\n  },\r\n\r\n  /**\r\n   * Update or init the element data\r\n   * @param {} data\r\n   * @returns {}\r\n   */\r\n  initializeData: function (data) {\r\n    var self = this;\r\n\r\n    // Create a single instance for each cell\r\n    data.properties.singleInstance = false;\r\n\r\n    // Call base\r\n    self._super(data);\r\n  },\r\n\r\n  /**\r\n   * Returns the view template to be used\r\n   * @returns {}\r\n   */\r\n  getViewTemplate: function () {\r\n    return this.renderFactory.getTemplate(\"grid-view\");\r\n  },\r\n\r\n  /**\r\n   * Applies the template to the render and returns the resolved element\r\n   * @param {} template\r\n   * @returns {}\r\n   */\r\n  applyTemplate: function(template) {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    // id + other column\r\n    var allowFilter = self.columns.length > 2;\r\n\r\n    // Localstorage filter\r\n    bizagi.util.removeItemLocalStorage(\"grid.filter.\" + properties.id);\r\n    bizagi.util.setItemLocalStorage(\"grid.filter.\" + properties.id, null);\r\n\r\n    return $.kendoTmpl(template, {\r\n      id: bizagi.util.encodeXpath(properties.xpath),\r\n      title: properties.displayName,\r\n      allowAdd: properties.allowAdd,\r\n      allowFilter: allowFilter\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Method to attach any handler to the view\r\n   * @returns {}\r\n   */\r\n  attachHandlers: function () {\r\n    var self = this;\r\n\r\n    $(\".bz-rn-view-options\", self.gridView).on(\"click\", function (evt) {\r\n      evt.stopPropagation();\r\n\r\n      self.processAction($(this).attr(\"data-action\"));\r\n    });\r\n  },\r\n\r\n  /**\r\n   *  Process an action in order to do something with the view\r\n   * @param {} action\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  processAction: function (action, params) {\r\n    var self = this;\r\n\r\n    if (action === \"close\") {\r\n      self.onClose();\r\n    }\r\n\r\n    if (action === \"add\") {\r\n      self.addRow();\r\n    }\r\n\r\n    if (action === \"filter\") {\r\n      self.onFilterRow();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Go back and destroy\r\n   * @returns {}\r\n   */\r\n  onClose: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    // Localstorage filter\r\n    bizagi.util.removeItemLocalStorage(\"grid.filter.\" + properties.id);\r\n\r\n    self.pane.data(\"kendoMobilePane\").navigate(\"#:back\");\r\n    self.view.destroy();\r\n    self.view.element.remove();\r\n  },\r\n\r\n  onFilterRow: function() {\r\n    var self = this;\r\n\r\n    var title = \"Column settings\";\r\n    var action = \"FILTER\";\r\n    var modalTemplate = self.renderFactory.getTemplate(\"grid-modal-filter\");\r\n    var columnFilter = self.buildColumnFilter();    \r\n    var modalFilterTemplate = kendo.template(modalTemplate, { useWithBlock: false });\r\n    var modalFilter = $(modalFilterTemplate({ list: columnFilter, title: title, action: action }).trim());\r\n\r\n    modalFilter.kendoMobileModalView({\r\n      close: function() {\r\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n        this.destroy();\r\n        this.element.remove();\r\n      },\r\n      useNativeScrolling: true,\r\n      modal: false\r\n    });\r\n\r\n    self.attachModalFilterHandlers(modalFilter);\r\n    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n    modalFilter.kendoMobileModalView(\"open\");\r\n  },\r\n\r\n  /**\r\n   * Creates the column filter\r\n   * @returns {}\r\n   */\r\n  buildColumnFilter: function() {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var columnFilter = [];\r\n\r\n    // Localstorage filter\r\n    var localstorage = bizagi.util.getItemLocalStorage(\"grid.filter.\" + properties.id) ? JSON.parse(bizagi.util.getItemLocalStorage(\"grid.filter.\" + properties.id)) : null;\r\n    var columns = localstorage ? localstorage : self.buildColumns;\r\n\r\n    $.each(columns, function(index, column) {\r\n      if (!column.key && !column.hidden) {\r\n        column.active = typeof (column.active) !== \"undefined\" ? column.active : true;\r\n        columnFilter.push(column);\r\n      }\r\n    });\r\n\r\n    bizagi.util.setItemLocalStorage(\"grid.filter.\" + properties.id, JSON.stringify(columnFilter));\r\n\r\n    return columnFilter;\r\n  },\r\n\r\n  /**\r\n   * Attach events to modalview\r\n   * @param {} modalContainer\r\n   * @returns {}\r\n   */\r\n  attachModalFilterHandlers: function(modalContainer) {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    var modalListContainer = modalContainer.find(\".bz-rn-modal-filter-content-list\");\r\n\r\n    // Close modalview\r\n    modalContainer.on(\"click\", \".bz-rn-modal-filter-header-title-cancel\", function() {\r\n      modalContainer.kendoMobileModalView(\"close\");\r\n    });\r\n\r\n    modalContainer.on(\"click\", \".bz-rn-modal-filter-footer-action\", function() {\r\n      var localstorage = bizagi.util.getItemLocalStorage(\"grid.filter.\" + properties.id) ? JSON.parse(bizagi.util.getItemLocalStorage(\"grid.filter.\" + properties.id)) : null;\r\n      //bizagi.util.setItemLocalStorage(\"grid.filter.\" + properties.id, JSON.stringify(columnFilter));\r\n\r\n      //var items = modalListContainer.find(\"input:checkbox:checked\");\r\n      var showHeaders = modalListContainer.find(\"input\").map(function() {\r\n        var that = this;\r\n        return { index: $(that).data(\"index\"), active: that.checked };\r\n      });\r\n\r\n      $.each(showHeaders, function(index, item) {\r\n        var cssIndex = item.index + 1;\r\n\r\n        localstorage[index].active = item.active;\r\n\r\n        var tags = $(\".bz-rn-grid-table th:nth-child(\" + cssIndex + \"), .bz-rn-grid-table td:nth-child(\" + cssIndex + \")\");\r\n        if (item.active) {\r\n          tags.show();\r\n        } else {\r\n          tags.hide();\r\n        }\r\n      });\r\n\r\n      bizagi.util.setItemLocalStorage(\"grid.filter.\" + properties.id, JSON.stringify(localstorage));\r\n      modalContainer.kendoMobileModalView(\"close\");\r\n    });\r\n\r\n    modalListContainer.on(\"click\", \"input\", function() {\r\n      var that = this;\r\n\r\n      if (modalListContainer.find(\"input:checkbox:checked\").length > 0) {\r\n        var radioSelected = $(that).is(\":checked\");\r\n\r\n        radioSelected ?\r\n          $(that).removeClass(\"bz-full-ball\").addClass(\"bz-check\") :\r\n          $(that).addClass(\"bz-full-ball\").removeClass(\"bz-check\");\r\n      } else {\r\n        $(that).prop(\"checked\", true);\r\n      }\r\n    });\r\n  },\r\n\r\n    /* RENDERS GRID\r\n     =====================================================*/\r\n\r\n  /**\r\n   * postRenderSingle\r\n   * @returns {}\r\n   */\r\n  postRenderSingle: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var container = self.getContainerRender();\r\n    var control = self.getControl();\r\n\r\n    container.addClass(\"bz-command-edit-inline\");\r\n\r\n    if (self.properties.helpText !== \"\") {\r\n      control.addClass(\"bz-rn-grid-contains-help-text\");\r\n    }\r\n\r\n    // Hide the standar label\r\n    self.getContainerRender().find(\".ui-bizagi-label\").hide();\r\n    self.getArrowContainer().hide();\r\n\r\n    // Call base\r\n    self._super();\r\n\r\n    // Apply plugin\r\n    self.applyGridPlugin();\r\n\r\n    // Set initial data\r\n    properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n\r\n    if (!properties.skipInitialLoad) {\r\n      if (properties.data) {\r\n        if (properties.data === \"\" || (properties.data.rows).length === 0 && properties.data.page > 1) {\r\n          self.fetchData(undefined, self.sortBy, self.sortType);\r\n        } else {\r\n          self.updateData(properties.data);\r\n\r\n          // Trigger change in order to start up the actions when the controls is ready\r\n          $.when(self.ready())\r\n            .done(function () {\r\n              self.triggerRenderChange({ changed: false });\r\n              self.pane.data(\"kendoMobilePane\").navigate(self.view.id);\r\n\r\n              self.configureHeaderAndFooterFixed();\r\n              self.attachScrollHandler();\r\n              self.endLoading();\r\n            });\r\n        }\r\n      } else {\r\n        self.fetchData(properties.page, properties.sortBy, properties.sortOrder);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Method to attach any handler to the Scroller\r\n   * @returns {}\r\n   */\r\n  attachScrollHandler: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var scrollLeft = 0;\r\n    var scrollTop = 0;\r\n\r\n\r\n      if (properties.data && properties.data.records === 0) {\r\n      return;\r\n    }\r\n\r\n    var scroller = self.view.content.find(\".bz-rn-grid-scroll-content\").data(\"kendoMobileScroller\");\r\n\r\n    if (scroller) {\r\n      scroller.reset();\r\n    }\r\n\r\n    var tableLeft = self.view.content.find(\".left-table\").get(0);\r\n    var scrollHeader = self.view.content.find(\".bz-rn-grid-scroll-header\").get(0);\r\n\r\n    scroller.bind(\"scroll\", function (event) {\r\n      var left = event.scrollLeft;\r\n      var top = event.scrollTop;\r\n\r\n      if (left !== scrollLeft) {\r\n        var transformLeft = \"translateX(\" + (left) * (-1) + \"px)\";\r\n        scrollHeader.style.transform = transformLeft;\r\n        scrollHeader.style.webkitTransform = transformLeft;\r\n        scrollHeader.style.OTransform = transformLeft;\r\n\r\n        scrollLeft = left;\r\n      }\r\n\r\n      if (top !== scrollTop) {\r\n        var transformTop = \"translateY(\" + (top) * (-1) + \"px)\";\r\n        tableLeft.style.transform = transformTop;\r\n        tableLeft.style.webkitTransform = transformTop;\r\n        tableLeft.style.OTransform = transformTop;\r\n\r\n        scrollTop = top;\r\n      }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * configureFixedHeaders\r\n   * @returns {}\r\n   */\r\n  configureHeaderAndFooterFixed: function () {\r\n    var self = this;\r\n\r\n    var pivot;\r\n    var i = -1;\r\n    var properties = self.properties;\r\n\r\n    if (properties.data && properties.data.records === 0) return;\r\n\r\n    var tbody = self.scrollContent.find(\".bz-rn-grid-body\");\r\n    var cols = $(\"tr:first-child td\", tbody);\r\n    var colgroup = $(\"<colgroup></colgroup>\");\r\n\r\n    while (pivot = cols[++i]) {\r\n      var col = document.createElement(\"col\");\r\n      col.style.width = pivot.offsetWidth + \"px\";\r\n      colgroup.append(col);\r\n    }\r\n\r\n    var rows = $(\"tr\", tbody) ? $(\"tr\", tbody).length : 0;\r\n    var tbodyLeftTable = $(\"<table class='left-table'>\");\r\n\r\n    for (var j = 0; j < rows; j++) {\r\n      var row = $(\"<tr><td>\" + (j + 1) + \"</td></tr>\");\r\n      tbodyLeftTable.append(row);\r\n    }\r\n\r\n    // Clean content\r\n    self.view.content.find(\".bz-rn-grid-counter-column\").empty();\r\n    self.view.content.find(\".bz-rn-grid-scroll-header\").empty();\r\n\r\n    // Column counter\r\n    self.view.content.find(\".bz-rn-grid-counter-column\").append(tbodyLeftTable);\r\n\r\n    // Column group\r\n    self.view.content.find(\".bz-rn-grid-table\").prepend(colgroup.clone());\r\n\r\n    // Header\r\n    var header = self.scrollContent.find(\".bz-rn-grid-header\");\r\n    self.view.content.find(\".bz-rn-grid-scroll-header\")\r\n      .append($(\"<table class='bz-rn-grid-table'></table>\")\r\n        .append(colgroup).append(header));\r\n\r\n    // Footer\r\n    self.view.footer.empty();\r\n    var pager = self.scrollContent.find(\".bz-rn-grid-container-pager\");\r\n    self.view.footer.append(pager);\r\n  },\r\n\r\n  /**\r\n   * Render the grid\r\n   * @returns {}\r\n   */\r\n  applyGridPlugin: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var scrollContainer = self.view.content.find(\".bz-rn-grid-scroll-content\").data(\"kendoMobileScroller\");\r\n\r\n    self.buildColumns = self.buildColumnModel();\r\n\r\n    self.currentGrid = $(scrollContainer.scrollElement).mobileGrid({\r\n      columns: self.buildColumns,\r\n      title: properties.displayName,\r\n      mode: self.getMode(),\r\n      sortBy: properties.sortBy || \"\",\r\n      sortOrder: properties.sortOrder || \"\",\r\n      sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n      template: {\r\n        grid: self.renderFactory.getTemplate(\"grid\"),\r\n        table: self.renderFactory.getTemplate(\"grid-table\"),\r\n        emptyTable: self.renderFactory.getTemplate(\"grid-table-empty\"),\r\n        column: self.renderFactory.getTemplate(\"grid-table-column\"),\r\n        specialColumn: self.renderFactory.getTemplate(\"grid-table-column-special\"),\r\n        row: self.renderFactory.getTemplate(\"grid-table-row\"),\r\n        cell: self.renderFactory.getTemplate(\"grid-table-cell\"),\r\n        specialCell: self.renderFactory.getTemplate(\"grid-table-cell-special\"),\r\n        pager: self.renderFactory.getTemplate(\"grid-table-pager\"),\r\n        waiting: \"\"\r\n      },\r\n      actions: {\r\n        add: properties.allowAdd,\r\n        edit: properties.allowEdit && properties.withEditForm,\r\n        remove: properties.allowDelete,\r\n        details: properties.allowDetail\r\n      },\r\n      tooltips: {\r\n        addLabel: $.trim(bizagi.localization.getResource(\"render-grid-add-label\")), //properties.addLabel,\r\n        editLabel: $.trim(bizagi.localization.getResource(\"render-grid-edit-label\")), //properties.editLabel,\r\n        deleteLabel: $.trim(bizagi.localization.getResource(\"render-ecm-confirm-bt-delete\")), //properties.deleteLabel,\r\n        detailLabel: $.trim(bizagi.localization.getResource(\"render-collection-navigator-details-form\")), //properties.detailLabel\r\n      },\r\n      drawCell: function (params) {\r\n        return self.drawCell(params.column, params.key, params.value, params.isNewRow);\r\n      },\r\n      cellReady: function (params) {\r\n        return self.onCellReady(params.column, params.key, params.cell, params.isNewRow);\r\n      },\r\n      rowSelected: function (params) {\r\n        self.rowSelected(params.key);\r\n      },\r\n      rowUnselected: function (params) {\r\n        self.rowUnselected(params.key);\r\n      },\r\n      editRow: function (params) {\r\n        self.editRow(params.key);\r\n      },\r\n      deleteRow: function (params) {\r\n        self.deleteRow(params.key);\r\n      },\r\n      showFormDetails: function (params) {\r\n        self.showFormDetails(params.key);\r\n      },\r\n      pageRequested: function (params) {\r\n        self.pageRequested(params);\r\n      },\r\n      sortRequested: function (params) {\r\n        self.fetchData(params.page, params.sortBy, params.sortType);\r\n      }\r\n    });\r\n  },\r\n\r\n    /*\r\n     *   Triggers the grid plugin event\r\n     */\r\n  triggerGridPluginHandler: function () {\r\n    var self = this;\r\n    var args = Array.prototype.slice.call(arguments, 0);\r\n    //return self.grid.apply(self.grid, args);\r\n  },\r\n\r\n  /**\r\n   * rowSelected\r\n   * @param {} key\r\n   * @returns {}\r\n   */\r\n  rowSelected: function (key) {\r\n    var self = this;\r\n    var grid = self.currentGrid;\r\n    var element = grid.getContainer();\r\n\r\n    // Add selected style to row\r\n    var rowSeleted = element.find(\"[data-bizagi-component=rows] tr[data-key=\" + key + \"]\");\r\n    rowSeleted.addClass(\"bz-rn-grid-state-selected\");\r\n  },\r\n\r\n  /**\r\n   * rowUnselected\r\n   * @param {} key\r\n   * @returns {}\r\n   */\r\n  rowUnselected: function (key) {\r\n    var self = this;\r\n    var grid = self.currentGrid;\r\n    var element = grid.getContainer();\r\n\r\n    var tr = element.find(\"[data-bizagi-component=rows] tr[data-key=\" + key + \"]\");\r\n    tr.removeClass(\"bz-rn-grid-state-selected\");\r\n  },\r\n\r\n  /**\r\n   * Method overrrides from base or virtual\r\n   * @param {} value\r\n   * @returns {}\r\n   */\r\n  setDisplayValue: function (value) { },\r\n\r\n  /**\r\n   * setDisplayValueEdit\r\n   * @param {} value\r\n   * @returns {}\r\n   */\r\n  setDisplayValueEdit: function (value) { },\r\n\r\n  /**\r\n   * actionSave\r\n   * @returns {}\r\n   */\r\n  actionSave: function () { },\r\n\r\n  /**\r\n   * Updates manually the affected cell\r\n   * @returns {}\r\n   */\r\n  updateAffectedCellManually: function () { },\r\n\r\n  /**\r\n   * Get the row index using the key as a reference\r\n   * @returns {}\r\n   */\r\n  getRowIndexByKey: function () { },\r\n\r\n  /**\r\n   * Shows more info about a grid row in smartphones not implemented\r\n   * @param {} id\r\n   * @returns {}\r\n   */\r\n  showMore: function (id) { },\r\n\r\n  /**\r\n   * getHeaderStyles\r\n   * @returns {}\r\n   */\r\n  getHeaderStyles: function () { },\r\n\r\n  /**\r\n   * Creates the column model required to initialize the grid plugin\r\n   * @returns {}\r\n   */\r\n  buildColumnModel: function () {\r\n    var self = this;\r\n    var columns = self.columns;\r\n\r\n    // Create id column first\r\n    var keyColumn = {\r\n      name: \"id\",\r\n      index: 0,\r\n      label: \"id\",\r\n      hidden: true,\r\n      align: \"center\",\r\n      key: true\r\n    };\r\n\r\n    // Add to column model\r\n    var columnModel = [];\r\n    columnModel.push(keyColumn);\r\n\r\n    $.each(columns, function (index, column) {\r\n      // Set grid column\r\n      column.columnIndex = index + 1;\r\n      var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n      var gridColumn = {\r\n        name: column.properties.xpath,\r\n        index: index + 1,\r\n        label: columnLabel,\r\n        key: false,\r\n        hidden: (!column.properties.visible || column.properties.type == \"columnHidden\" || column.properties.columnVisible === false),\r\n        summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n        bizAgiProperties: column.properties\r\n      };\r\n      columnModel.push(gridColumn);\r\n    });\r\n\r\n    return columnModel;\r\n  },\r\n\r\n  /**\r\n   * Makes the grid to refresh\r\n   * @returns {}\r\n   */\r\n  refresh: function () {\r\n    var self = this;\r\n    var deferred = $.Deferred();\r\n\r\n    $.when(self.fetchData()).done(function () {\r\n      deferred.resolve();\r\n    });\r\n\r\n    return deferred.promise();\r\n  },\r\n\r\n  /**\r\n   * Holds the execution until the grid data is ready after a load operation\r\n   * @returns {}\r\n   */\r\n  dataReady: function () {\r\n    var self = this;\r\n\r\n    return self.dataReadyDeferred != null ? self.dataReadyDeferred.promise() : null;\r\n  },\r\n\r\n  /**\r\n   * Method to set data and update the grid\r\n   * @param {} data\r\n   * @returns {}\r\n   */\r\n  updateData: function (data) {\r\n    var self = this;\r\n    var grid = self.currentGrid;\r\n\r\n    if (!data.records || (data.records && data.records === 0)) {\r\n      self.view.content.find(\".bz-rn-grid-top-content, .bz-rn-grid-counter-column\").hide();\r\n      self.view.content.find(\".bz-rn-grid-scroll-content\").css(\"width\", \"100%\");\r\n    } else {\r\n      if (self.view.content.find(\".bz-rn-grid-top-content\").css(\"display\") === \"none\") {\r\n        self.view.content.find(\".bz-rn-grid-top-content, .bz-rn-grid-counter-column\").show();\r\n      }\r\n    }\r\n\r\n    // Set value in control\r\n    if (data && self.properties) {\r\n      self.properties.data = data;\r\n      self.setCellOverrides(data);\r\n      grid.setData(data);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Method to fetch data from the server and then update the data\r\n   * @param {} page\r\n   * @param {} sortBy\r\n   * @param {} sortType\r\n   * @returns {}\r\n   */\r\n  fetchData: function (page, sortBy, sortType) {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    self.dataReadyDeferred = $.Deferred();\r\n    self.sortBy = sortBy;\r\n    self.sortType = sortType;\r\n\r\n    // Define defaults\r\n    page = page || 1;\r\n    sortBy = sortBy || (properties.sortBy || \"id\");\r\n    sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n    // Update control properties\r\n    properties.page = page;\r\n    properties.sortBy = sortBy;\r\n    properties.sortType = sortType;\r\n    properties.sort = sortBy + \" \" + sortType;\r\n\r\n    // Start loading to avoid multiple calls to the server\r\n    self.startLoading();\r\n\r\n    $.when(self.getRemoteData())\r\n      .then(function (data) {\r\n        self.endLoading();\r\n\r\n        if (data) {\r\n          if (data.deviceMaxRecordsExceeded) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-maximum-records-allowed\"));\r\n            self.dataReadyDeferred.resolve();\r\n          } else {\r\n            $.when(self.updateData(data))\r\n              .done(function () {\r\n                // Attach handlers\r\n                self.configureHeaderAndFooterFixed();\r\n                self.attachScrollHandler();\r\n\r\n                self.triggerRenderChange({ changed: false });\r\n                self.dataReadyDeferred.resolve();\r\n              });\r\n          }\r\n        }\r\n      });\r\n\r\n    return self.dataReadyDeferred.promise();\r\n  },\r\n\r\n  /**\r\n   * Fetch Sum Data\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  fetchTotalData: function (params) {\r\n  },\r\n\r\n  /**\r\n   * Add the render data to the given collection in order to send data to the server\r\n   * @param {} renderValues\r\n   * @returns {}\r\n   */\r\n  collectData: function (renderValues) { },\r\n\r\n  /**\r\n   * onPageRequested\r\n   * @param {} ui\r\n   * @returns {}\r\n   */\r\n  pageRequested: function (params) {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var data = {};\r\n\r\n    if (!jQuery.isEmptyObject(data)) {\r\n\r\n      self.dataService.submitData({\r\n        action: \"SUBMITDATA\",\r\n        data: data,\r\n        idRender: properties.id,\r\n        xpath: properties.xpath,\r\n        xpathContext: properties.xpathContext,\r\n        idPageCache: properties.idPageCache\r\n      });\r\n\r\n    }\r\n\r\n    self.fetchData(params.page, params.sortBy, params.sortType);\r\n  },\r\n\r\n  /**\r\n   * onTotalData\r\n   * @param {} ui\r\n   * @returns {}\r\n   */\r\n  onTotalData: function (ui) { },\r\n\r\n  /**\r\n   * showTotals\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  showTotals: function (params) { },\r\n\r\n  /**\r\n   *  Customizes the content drawing inside the cell\r\n   * @param {} column\r\n   * @param {} key\r\n   * @param {} value\r\n   * @param {} isNewRow\r\n   * @returns {}\r\n   */\r\n  drawCell: function (column, key, value, isNewRow) {\r\n    var self = this;\r\n\r\n    if (column.key) return value;\r\n\r\n    self.newRecords = self.newRecords || {};\r\n\r\n    // Get render column\r\n    var columnIndex = column.index - 1;\r\n    var renderColumn = self.columns[columnIndex];\r\n\r\n    if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n    if (!self.cellMetadata[key][columnIndex]) {\r\n      self.cellMetadata[key][columnIndex] = {};\r\n    }\r\n\r\n    var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n    var visible = properties.visible !== undefined ? properties.visible : true;\r\n    var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n    // Not display\r\n    properties.editable = false;\r\n    renderColumn.properties.displayType = 'value';\r\n\r\n    renderColumn.setValue(key, value);\r\n    renderColumn.setSurrogateKey(key);\r\n\r\n    if (visible) {\r\n      var defer = new $.Deferred();\r\n      renderColumn.properties = properties;\r\n\r\n      $.when(renderColumn.renderReadOnly(key, value)).done(function (cell) {\r\n        // Register array with new records\r\n        for (var j = 0; j < self.columns.length; j++) {\r\n          self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n          self.getCellOverride(key, j).visible = true;\r\n        }\r\n        defer.resolve(cell);\r\n      });\r\n\r\n      return defer.promise();\r\n\r\n    } else {\r\n      return \"\";\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Executes when the cell is ready and inserted into the DOM\r\n   * @param {} column\r\n   * @param {} key\r\n   * @param {} cell\r\n   * @param {} isNewRow\r\n   * @returns {}\r\n   */\r\n  onCellReady: function (column, key, cell, isNewRow) {\r\n    var self = this;\r\n\r\n    // Get render column\r\n    var columnIndex = column.index - 1;\r\n    var renderColumn = self.columns[columnIndex];\r\n    var properties = ((self.cellMetadata[key][columnIndex] != undefined) ? self.cellMetadata[key][columnIndex].properties : undefined) || renderColumn.originalProperties;\r\n    var visible = properties.visible !== undefined ? properties.visible : true;\r\n    var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n    // Show editable cell when we are performing inline add operation\r\n    if (isNewRow) {\r\n      editable = true;\r\n    } else {\r\n      editable = false;\r\n    }\r\n\r\n    if (visible) {\r\n      var control;\r\n      if (editable) {\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = editable;\r\n\r\n        // Set xpath context for submitonchange action\r\n        if (renderColumn.properties.submitOnChange) {\r\n          control = renderColumn.getDecorated(key);\r\n          if (control) {\r\n            control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n          }\r\n        }\r\n\r\n        // Execute cell post render\r\n        renderColumn.postRender(key, cell);\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n      } else {\r\n        renderColumn.postRenderReadOnly(key, cell);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Returns a promise that will resolve when the element is ready\r\n   * @returns {}\r\n   */\r\n  ready: function () {\r\n    var self = this;\r\n    var parentPromise = self._super();\r\n\r\n    return $.when(parentPromise);\r\n  },\r\n\r\n  /**\r\n   * Adds a row to the grid\r\n   * @returns {}\r\n   */\r\n  addRow: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    var container = self.getFormContainer().container;\r\n    var dataservice = self.dataService;\r\n    var renderFactory = self.renderFactory;\r\n\r\n    self.startLoading();\r\n\r\n    $.when(self.submitAddRequest())\r\n      .done(function (newId) {\r\n        var recordXpath = properties.xpath + \"[id=\" + newId + \"]\";\r\n\r\n        var propertiesGridForm = {\r\n          idRender: properties.id,\r\n          \"recordXPath\": recordXpath,\r\n          url: properties.addPage,\r\n          xpathContext: properties.xpathContext,\r\n          idPageCache: properties.idPageCache,\r\n          xpath: recordXpath,\r\n          editable: true,\r\n          requestedForm: \"addForm\",\r\n          displayName: properties.addLabel,\r\n          idAsigned: newId,\r\n          enableEditSubmitRequest: false,\r\n          hideLabel: true,\r\n          withAddForm: true\r\n        };\r\n\r\n        var argumentsGrid = {\r\n          \"renderFactory\": renderFactory,\r\n          \"dataService\": dataservice,\r\n          \"parent\": self,\r\n          \"data\": {\r\n            properties: propertiesGridForm\r\n          }\r\n        };\r\n\r\n        var formlink = new bizagi.rendering.formLink(argumentsGrid);\r\n\r\n        $.extend(formlink, {\r\n          contextEdit: $(container).find(\"#container-items-edit\"),\r\n          element: self.element,\r\n          actionSave: self.actionSaveNewRow,\r\n          actionCancel: self.actionCancelRow,\r\n          _sendRelation: function () {\r\n            return true;\r\n          },\r\n          _getData: self.dataService.getFormData,\r\n          _params: propertiesGridForm\r\n        });\r\n\r\n        self._InternalRenderLinkForm(formlink);\r\n        self.endLoading();\r\n\r\n      }).fail(function (error) {\r\n      self.endLoading();\r\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-no-records\"), \"Error\");\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Edit form in the grid\r\n   * @param {} id\r\n   * @returns {}\r\n   */\r\n  editRow: function (id) {\r\n    var self = this;\r\n\r\n    //save form in case the user has made changes in the inline row\r\n    var containerForm = self.getFormContainer();\r\n    containerForm.saveForm();\r\n\r\n    var properties = self.properties;\r\n    var container = self.getFormContainer().container;\r\n    var dataservice = self.dataService;\r\n    var renderFactory = self.renderFactory;\r\n    var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n    var propertiesGridForm = {\r\n      idRender: properties.id,\r\n      id: properties.id,\r\n      xpathContext: properties.xpathContext,\r\n      idPageCache: properties.idPageCache,\r\n      recordXPath: recordXpath,\r\n      xpath: recordXpath,\r\n      editable: true,\r\n      url: properties.editPage,\r\n      requestedForm: \"editForm\",\r\n      displayName: properties.editLabel,\r\n      idAsigned: id\r\n    };\r\n\r\n    var argumentsGrid = {\r\n      \"renderFactory\": renderFactory,\r\n      \"dataService\": dataservice,\r\n      \"parent\": self,\r\n      \"data\": {\r\n        properties: propertiesGridForm\r\n      }\r\n    };\r\n\r\n    var formlink = new bizagi.rendering.formLink(argumentsGrid);\r\n\r\n    $.extend(formlink, {\r\n      contextEdit: $(container).find(\"#container-items-edit\"),\r\n      element: self.element,\r\n      actionSave: self.actionSaveNewRow,\r\n      actionCancel: self.actionCancelRow,\r\n      _sendRelation: formlink.submitEditRequest,\r\n      _getData: self.dataService.getFormData,\r\n      _params: propertiesGridForm\r\n    });\r\n\r\n    self._InternalRenderLinkForm(formlink);\r\n  },\r\n\r\n  /**\r\n   * Deletes  a row to the grid\r\n   * @param {} id\r\n   * @returns {}\r\n   */\r\n  deleteRow: function (id) {\r\n    var self = this;\r\n\r\n    if (id === 0) {\r\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n      return;\r\n    }\r\n\r\n    bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n      .done(function () {\r\n        //Do a grid record deletion\r\n        $.when(self.submitDeleteRequest(id))\r\n          .done(function (data) {\r\n            // Reload grid\r\n            self.fetchData();\r\n\r\n            if (data.type === \"success\") {\r\n              // Trigger the event\r\n              //'key' must be included to trigger a single call to actions and validations\r\n              self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\r\n            }\r\n          });\r\n      });\r\n  },\r\n\r\n  /**\r\n   * Details form in the grid\r\n   * @param {} id\r\n   * @returns {}\r\n   */\r\n  showFormDetails: function (id) {\r\n    var self = this;\r\n\r\n    if (id === 0 || id == undefined) {\r\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n      return;\r\n    }\r\n\r\n    //save form in case the user has made changes in the inline row\r\n    //var containerForm = self.getFormContainer();\r\n    //containerForm.saveForm();\r\n\r\n    var properties = self.properties;\r\n    var container = self.getFormContainer().container;\r\n    var dataservice = self.dataService;\r\n    var renderFactory = self.renderFactory;\r\n    var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n    var propertiesGridForm = {\r\n      idRender: properties.id,\r\n      id: properties.id,\r\n      xpathContext: properties.xpathContext,\r\n      idPageCache: properties.idPageCache,\r\n      recordXPath: recordXpath,\r\n      xpath: recordXpath,\r\n      editable: false,\r\n      url: properties.editPage,\r\n      requestedForm: \"detailForm\",\r\n      displayName: properties.detailLabel,\r\n      idAsigned: id,\r\n      hideSaveButton: true\r\n    };\r\n\r\n    var argumentsGrid = {\r\n      \"renderFactory\": renderFactory,\r\n      \"dataService\": dataservice,\r\n      \"parent\": self,\r\n      \"data\": {\r\n        properties: propertiesGridForm\r\n      }\r\n    };\r\n\r\n    var formlink = new bizagi.rendering.formLink(argumentsGrid);\r\n\r\n    $.extend(formlink, {\r\n      contextEdit: $(container).find(\"#container-items-edit\"),\r\n      element: self.element,\r\n      //disable if you want only save at the end (submit the form)\r\n      //actionCancel: self.actionCancelRow,\r\n      _sendRelation: formlink.submitEditRequest,\r\n      _getData: self.dataService.getFormData,\r\n      _params: propertiesGridForm\r\n    });\r\n\r\n    self._InternalRenderLinkForm(formlink);\r\n  },\r\n\r\n  /**\r\n   * actionCancelRow\r\n   * @returns {}\r\n   */\r\n  actionCancelRow: function () {\r\n    var self = this;\r\n    var deferred = $.Deferred();\r\n\r\n    $.when(self.submitRollbackRequest()).done(function () {\r\n      deferred.resolve();\r\n    });\r\n\r\n    return deferred.promise();\r\n  },\r\n\r\n  /**\r\n   * actionSaveNewRow\r\n   * @returns {}\r\n   */\r\n  actionSaveNewRow: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var deferred = $.Deferred();\r\n    var data = {};\r\n\r\n    if (self.form.validateForm() === true) {\r\n      $.when(\r\n        self.form.collectRenderValues(data),\r\n        data.idPageCache = self.form.getPageCache()\r\n      ).then(function () {\r\n        $.when(\r\n          self.parent.submitSaveRequest(properties.idAsigned, data)).done(function (resp) {\r\n          if (resp.type == \"validationMessages\") {\r\n            self.form.addValidationMessage(resp.messages);\r\n            properties.submitOnChange = false;\r\n            deferred.reject(resp.messages);\r\n          } else {\r\n            self.parent.fetchData();\r\n            if (!properties.submitOnChange) {\r\n              properties.submitOnChange = true;\r\n            }\r\n            self.submitOnChange({}, true);\r\n            deferred.resolve();\r\n          }\r\n        });\r\n\r\n      });\r\n    } else {\r\n      deferred.reject({ noAction: true });\r\n    }\r\n\r\n    return deferred.promise();\r\n  },\r\n\r\n  /**\r\n   * _InternalRenderLinkForm\r\n   * @param {} formlink\r\n   * @returns {}\r\n   */\r\n  _InternalRenderLinkForm: function (formlink) {\r\n    var self = this;\r\n\r\n    $.when(formlink.renderEdition()).done(\r\n      function () {\r\n        formlink.endLoading();\r\n        formlink.postRenderEdit();\r\n\r\n        formlink.form.one(\"refresh\", function (_, refreshParams) {\r\n          if (formlink.kendoView) {\r\n            var id = formlink.kendoView.data(\"kendoMobileView\").id;\r\n            if (id.substring(1, id.length) === kendo.history.current) {\r\n              refresh.apply(self);\r\n            } else {\r\n              formlink.kendoView.data(\"kendoMobileView\").bind(\"afterShow\", refresh.bind(self));\r\n            }\r\n\r\n            function refresh() {\r\n              self = this;\r\n              bizagi.kendoMobileApplication.navigate(\"#:back\");\r\n              formlink.kendoView.data(\"kendoMobileView\").destroy();\r\n              self._InternalRenderLinkForm(formlink);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    );\r\n  },\r\n\r\n  /**\r\n   * applyActionUpdateGrid\r\n   * @param {} column\r\n   * @param {} context\r\n   * @returns {}\r\n   */\r\n  applyActionUpdateGrid: function (column, context) { },\r\n\r\n  /**\r\n   * collectRenderValues\r\n   * @param {} renderValues\r\n   * @returns {}\r\n   */\r\n  collectRenderValues: function (renderValues) { },\r\n\r\n\r\n    /*   Sets an error on the cell\r\n     */\r\n  setError: function (key, xpath) { },\r\n\r\n  /**\r\n   * Changes the required for cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellValue: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   * Changes the background for a cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellBackgroundColor: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   *  Changes the background for a cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellColor: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   *  Changes the visibility for a cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellVisibility: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   *  Changes the editability for a cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellEditability: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   * cleanCellData\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @returns {}\r\n   */\r\n  cleanCellData: function (key, xpath) { },\r\n\r\n  /**\r\n   * Method to start loading for ajax data and update the ui\r\n   * @param {} bUseTimeout\r\n   * @returns {}\r\n   */\r\n  startLoading: function () {\r\n    bizagi.loading.start();\r\n  },\r\n\r\n  /**\r\n   * Method to remove the loading message\r\n   * @returns {}\r\n   */\r\n  endLoading: function () {\r\n    bizagi.loading.stop();\r\n  }\r\n});\r\n","/**\r\n *  Name: BizAgi Smartphone Render Grid Extension\r\n *  Author: Oscar o\r\n *  Comments:\r\n *  -   This script will redefine the grid render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.grid.extend(\"bizagi.rendering.grid\", {}, {\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n\r\n        data.properties.singleInstance = false;\r\n        data.properties.rowsPerPage = 1;\r\n        data.properties.labelAlign = \"left\";\r\n        data.properties.displayType = \"vertical\";\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n        properties.rowsPerPage = 1;\r\n\r\n        //Totalizer validation\r\n        if (properties.data && properties.data.rows)\r\n            self.allRows = [].concat(properties.data.rows);\r\n\r\n        //revisar base para mejorar comportamiento cuando esta en false los elementos\r\n        $.each(self.columns, function (index, value) {\r\n            if (this.properties && this.properties.editable) {\r\n                this.properties.editable = (properties.allowEdit === true) ? true : false;\r\n            }\r\n        });\r\n\r\n        // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\r\n        if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\r\n            properties.data.rows = [].concat([properties.data.rows[0]]);\r\n        }\r\n    },\r\n\r\n    /* method overrrides\r\n     *  from base or virtual\r\n     */\r\n    setDisplayValue: function (value) { },\r\n    setDisplayValueEdit: function (value) { },\r\n    actionSave: function () { },\r\n    /*\r\n     * Updates manually the affected cell\r\n     */\r\n    updateAffectedCellManually: function () { },\r\n\r\n    /*\r\n     * Get the row index using the key as a reference\r\n     */\r\n    getRowIndexByKey: function () { },\r\n    /**\r\n     *  Shows more info about a grid row\r\n     * in smartphones not implemented\r\n     */\r\n    showMore: function (id) { },\r\n\r\n\r\n    /**\r\n     * Returns the indexes of all elements in the grid\r\n     * @returns {*}\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.allRows, self.getDataNewRows());\r\n\r\n        return data.reduce(function (acum, current) {\r\n            if (typeof acum.find(function (el) { return el[0] == current[0]; }) === 'undefined') {\r\n                acum.push(current);\r\n            }\r\n            return acum;\r\n        }, []).map(function (item) {\r\n            return item[0];\r\n        });\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        properties.rowsPerPage = 1;\r\n\r\n        container.addClass(\"bz-command-edit-inline\");\r\n        if (self.properties.helpText !== \"\") {\r\n            control.addClass(\"bz-rn-grid-contains-help-text\");\r\n        }\r\n\r\n        //hide the standar label\r\n        //TODO: en tablet se realizae como getLabel\r\n        self.getContainerRender().find(\".ui-bizagi-label\").hide();\r\n        self.getArrowContainer().hide();\r\n\r\n        // Call base\r\n        this._super();\r\n        var grid = self.inputEdition = self.input = self.grid = control.find(\"#\" + bizagi.util.encodeXpath(properties.xpath)).addClass(\"bz-cn-grid\");\r\n        var mode = self.getMode();\r\n        var columns = self.buildColumnModel();\r\n\r\n        var columnsTotalizers = jQuery.grep(columns, function (a) {\r\n            return (a.summarizeBy);\r\n        });\r\n\r\n        //bizagi_grid_tablet\r\n        grid.bizagi_grid_smartphone({\r\n            columns: columns,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                totalizer: self.renderFactory.getTemplate(\"bizagi.grid.totalizer\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: false,\r\n                totalizer: properties.showSummary,\r\n                hasTotalizer: columnsTotalizers.length > 0 && properties.data.rows.length > 0 ? true : false\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.onPageRequested(ui);\r\n            },\r\n            totalData: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.onTotalData();\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            isValid: function (invalidElements) {\r\n                return self.isValidGrid(invalidElements);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                //self.triggerHandler(\"rowSelected\", { id: ui.key });\r\n            },\r\n            gridControlReady: function () {\r\n                self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n                self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n            },\r\n            addRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.addRow();\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            showMore: function (ui) {\r\n                self.showMore(ui.key);\r\n            },\r\n            showFormDetails: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.showDetail(ui.key);  \r\n            }\r\n        });\r\n\r\n        // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\r\n        if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\r\n            properties.data.rows = [].concat([properties.data.rows[0]]);\r\n        }\r\n\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        // Set initial data\r\n        if (!properties.skipInitialLoad) {\r\n            if (properties.data) {\r\n                self.updateData(properties.data);\r\n\r\n                // Trigger change in order to start up the actions when the controls is ready\r\n                $.when(self.ready())\r\n                    .done(function () {\r\n                        self.triggerRenderChange({ changed: false });\r\n                    });\r\n            } else {\r\n                self.fetchData(properties.page, properties.sortBy, properties.sortOrder);\r\n            }\r\n        }\r\n    },\r\n\r\n    getHeaderStyles: function () {\r\n        var self = this;\r\n        var label = \"\";\r\n        var header = \"\";\r\n        var properties = self.properties;\r\n\r\n        if (properties.headerFormat) {\r\n            var format = properties.headerFormat;\r\n\r\n            if (format.color) {\r\n                label += \"color: \" + format.color + \";\";\r\n            }\r\n\r\n            if (format.background) {\r\n                header += \"background-color: \" + format.background + \";\";\r\n            }\r\n\r\n            if (format.bold) {\r\n                label += \"font-weight: bold; \";\r\n            }\r\n\r\n            if (format.italic) {\r\n                label += \"font-style: italic; \";\r\n            }\r\n\r\n            if (format.underline || format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\r\n\r\n                label += \"text-decoration: \" + strikethru + underline + \";\";\r\n            }\r\n\r\n            if (format.size && format.size != \"0\") {\r\n                var newFontSize = (100 + Number(format.size) * 10) + \"%\";\r\n                label += \"font-size: \" + newFontSize + \";\";\r\n            }\r\n        }\r\n\r\n        return { label: label, header: header };\r\n    },\r\n\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            align: \"center\",\r\n            key: true\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                hidden: (!column.properties.visible || column.properties.type === \"columnHidden\" || column.properties.columnVisible === false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n\r\n    /**\r\n     * Makes the grid to refresh\r\n     */\r\n    refresh: function () {\r\n        var self = this;\r\n\r\n        return $.when(self.fetchData());\r\n    },\r\n\r\n    /*\r\n     *   Holds the execution until the grid data is ready after a load operation\r\n     */\r\n    dataReady: function () {\r\n        var self = this;\r\n\r\n        return self.dataReadyDeferred != null ? self.dataReadyDeferred.promise() : null;\r\n    },\r\n\r\n    /*\r\n     *   Method to set data and update the grid\r\n     */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data && self.properties) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n\r\n            self.triggerGridPluginHandler(\"setData\", data);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Method to fetch data from the server and then update the data\r\n     */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Define defaults\r\n        page = page || 1;\r\n        sortBy = sortBy || \"\";\r\n        sortType = sortType || \"asc\";\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        return $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n\r\n                if (data) {\r\n                    return $.when(\r\n                        self.updateData(data)\r\n                    ).done(function () {\r\n                        self.triggerRenderChange({ changed: false });\r\n                    });\r\n                }\r\n            }).always(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            });\r\n    },\r\n    /*\r\n     * Fetch Sum Data\r\n     */\r\n    fetchTotalData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sort,\r\n            page: 1,\r\n            rows: self.properties.data.records,\r\n            searchFilter: properties.searchFilter\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            var result = properties.overrideGetRemoteData(params);\r\n            return result != null ? result.promise() : null;\r\n        }\r\n\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridData(params).done(function (data) {\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n\r\n            defer.resolve(data);\r\n        }).fail(function (fail) {\r\n\r\n            defer.reject(fail);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n\r\n        // Remove changes for inline added rows\r\n        if (self.properties.inlineAdd) {\r\n            var omitKeys = grid.bizagi_grid_smartphone.hasOwnProperty(\"getNewRowKeys\") ? grid.bizagi_grid_smartphone(\"getNewRowKeys\") : [];\r\n            for (var i = 0, length = omitKeys.length; i < length; i++) {\r\n                if (self.changes[omitKeys[i]]) {\r\n                    delete self.changes[omitKeys[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        self._super(renderValues);\r\n    },\r\n\r\n    onPageRequested: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        if (!jQuery.isEmptyObject(data)) {\r\n\r\n            self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache\r\n            });\r\n        }\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n    },\r\n\r\n    onTotalData: function (ui) {\r\n\r\n        var self = this;\r\n        var containerForm = self.getFormContainer();\r\n        containerForm.saveForm();\r\n\r\n        //defered que retorne la respuesta del servidor\r\n        bizagi.util.smartphone.startLoading();\r\n        $.when(self.fetchTotalData()).done(function (data) {\r\n            var rows = data.rows;\r\n            var rowsLength = rows.length;\r\n\r\n            //calcula los totalizadores y crea el html\r\n            var showTotal = [];\r\n\r\n            var columnsModel = self.buildColumnModel();\r\n            var result;\r\n\r\n            var operationState;\r\n\r\n            columnsModel.forEach(function callback(column, columnIndex) {\r\n                if (column.bizAgiProperties) {\r\n                    operationState = column.bizAgiProperties.totalize.operation;\r\n\r\n                    switch (operationState) {\r\n                        case \"sum\":\r\n                            result = rows.sum(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value)\r\n                            }, columnIndex);\r\n                            break;\r\n\r\n                        case \"count\":\r\n                            result = rows.count(function (row) {\r\n                                //Checks if there is a DefaultValue, so assign it to the returnedvalu in case it doesn't have value\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n\r\n                                if (!bizagi.util.isArray(return_value)) {\r\n                                    return return_value;\r\n                                }\r\n\r\n                                if (bizagi.util.isArray(return_value) && return_value.length > 0) {\r\n                                    return return_value; //If the returned value is not undefined, neither null, it will count +1\r\n                                }\r\n                            }, column, columnIndex);\r\n\r\n                            break;\r\n\r\n                        case \"max\":\r\n                            result = rows.max(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value)\r\n                            }, columnIndex);\r\n\r\n                            break;\r\n\r\n                        case \"min\":\r\n                            result = rows.min(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value);\r\n                            }, columnIndex);\r\n                            break;\r\n\r\n                        case \"avg\":\r\n                            result = rows.avg(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value);\r\n                            }, columnIndex);\r\n\r\n                            result = result.toFixed(2);\r\n                            break;\r\n                    }\r\n\r\n                    if (operationState) {\r\n                        result = self.formatTotalizedResult(operationState, column.bizAgiProperties.type, result);\r\n                        showTotal.push({ label: column.label, total: result });\r\n                    }\r\n                }\r\n            });\r\n\r\n            self.showTotals(showTotal);\r\n        }).fail(function (error) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-no-records\"), \"Error\");\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n    },\r\n\r\n    formatTotalizedResult: function (operation, controlType, value) {\r\n        switch (operation) {\r\n            case 'sum':\r\n            case 'avg':\r\n            case 'min':\r\n            case 'max':\r\n                if (controlType == \"columnMoney\" || controlType == \"money\") {\r\n                    return bizagi.util.formatMonetaryCell(value);\r\n                }\r\n                break;\r\n        }\r\n\r\n        return value || 0;\r\n    },\r\n\r\n    showTotals: function (params) {\r\n        var self = this;\r\n        var modalViewTemplate = kendo.template(self.renderFactory.getTemplate('bizagi.grid.totalizer'), { useWithBlock: false });\r\n        var data = $.extend(params, { \"orientation\": self.properties.orientation });\r\n        var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n        $(\".bz-rn-grid-totalize-container\").remove();\r\n\r\n        modalView.kendoMobileModalView({\r\n            close: function () {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                this.destroy();\r\n                this.element.remove();\r\n            },\r\n            useNativeScrolling: true\r\n        });\r\n\r\n        modalView.delegate(\".bz-rn-grid-totalize-close-btn\", \"click\", function () {\r\n            modalView.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n        modalView.kendoMobileModalView(\"open\");\r\n    },\r\n\r\n    /*\r\n     *   Customizes the content drawing inside the cell\r\n     */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        //revisar ya que en las demas implementacion en desktop y tablet utilizan una validacion para edicion en linea o no\r\n        var self = this;\r\n        self.newRecords = {};\r\n\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        renderColumn.properties.displayType = 'normal';\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n\r\n        if (cellOverride) {\r\n            visible = cellOverride.visible;\r\n            editable = (properties.editable) ? cellOverride.editable : false;\r\n        }\r\n\r\n        if (visible) {\r\n            if (editable) {\r\n                var defer = new $.Deferred();\r\n\r\n                $.when(renderColumn.render(key, value)).done(function (cell) {\r\n\r\n                    if (cell && $(cell).css(\"display\") !== \"none\") {\r\n                        var headerStyles = self.getHeaderStyles();\r\n\r\n                        cell = cell.replace(\"headerStyles\", headerStyles.header);\r\n                        cell = cell.replace(\"headerLabelStyles\", headerStyles.label);\r\n                    }\r\n\r\n                    // Register array with new records\r\n                    if (isNewRow && !self.newRecords[key]) {\r\n                        self.newRecords[key] = {};\r\n                    }\r\n\r\n                    for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                        self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                        self.getCellOverride(key, j).visible = true;\r\n                    }\r\n\r\n                    self.bindRenderChange(renderColumn, key, true);\r\n\r\n                    defer.resolve(cell);\r\n                });\r\n                return defer.promise();\r\n            } else {\r\n                /* return renderColumn.renderReadOnly(key, value); */\r\n                return $.when(renderColumn.renderReadOnly(key, value)).then(function (cell) {\r\n\r\n                    if (cell && $(cell).css(\"display\") !== \"none\") {\r\n                        var headerStyles = self.getHeaderStyles();\r\n                        var item = $(cell);\r\n\r\n                        $('.ui-bizagi-label', item).attr('style', headerStyles.header);\r\n                        $('label', item).attr('style', headerStyles.label);\r\n\r\n                        if (typeof (self.properties.textFormat) !== \"undefined\") {\r\n\r\n                            if (typeof (self.properties.textFormat.color) !== \"undefined\") {\r\n                                $('label', item).css('color', self.properties.textFormat.color);\r\n                            }\r\n\r\n                            if ((typeof (self.properties.textFormat.size) !== \"undefined\") && (self.properties.textFormat.size > 0)) {\r\n                                var newFontSize = (100 + Number(self.properties.textFormat.size) * 10) + \"%\";\r\n                                $('label', item).css('font-size', newFontSize);\r\n                            }\r\n                        }\r\n\r\n                        cell = item[0].outerHTML;\r\n                    }\r\n\r\n                    return cell;\r\n                });\r\n            }\r\n\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Executes when the cell is ready and inserted into the DOM\r\n     */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = ((self.cellMetadata[key][columnIndex] != undefined) ? self.cellMetadata[key][columnIndex].properties : undefined) || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        $(\".bz-rn-messages\", cell).toggleClass(\"bz-rn-messages\", \"bz-rn-messages-grid\");\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n            if (editable) {\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n            } else {\r\n\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                renderColumn.postRender(key, cell);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    bindRenderChange: function (renderColumn, key, isBinding) {\r\n        if (isBinding) {\r\n            var self = this;\r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\r\n\r\n                var value = renderColumn.getValue(args.render.surrogateKey);\r\n                var compositeValue = renderColumn.getCompositeValue(args.render.surrogateKey);\r\n\r\n                if (renderColumn.properties.type == \"columnDate\") {\r\n                    if (!bizagi.util.isEmpty(value)) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, args.render.properties.showTime || false);\r\n                        value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    } else if (value === \"\") {\r\n                        value = \"\";\r\n                    }\r\n                }\r\n                self.collectGridChange($.extend(args, {\r\n                    id: args.render.surrogateKey,\r\n                    xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                    value: value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: renderColumn.columnIndex\r\n                }));\r\n\r\n                // Update change in grid's component data\r\n                self.grid.bizagi_grid_smartphone(\"changeCellValue\", args.render.surrogateKey, renderColumn.columnIndex, value);\r\n\r\n                // If the column has totalizers then we need to refresh the summary\r\n                if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n                    self.grid.bizagi_grid_smartphone(\"refreshSummary\", renderColumn.columnIndex);\r\n                }\r\n            });\r\n        } else {\r\n            renderColumn.getDecorated(key).unbind(\"renderchange\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    addRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var container = self.getFormContainer().container;\r\n        var dataservice = self.dataService;\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n                var propertiesGridForm = {\r\n                    idRender: properties.id,\r\n                    \"recordXPath\": recordXpath,\r\n                    url: properties.addPage,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    xpath: recordXpath,\r\n                    editable: true,\r\n                    requestedForm: \"addForm\",\r\n                    displayName: properties.addLabel,\r\n                    idAsigned: newid,\r\n                    enableEditSubmitRequest: false,\r\n                    hideLabel: true,\r\n                    disableProcessButons: true\r\n                };\r\n\r\n                var argumentsfl = {\r\n                    \"renderFactory\": self.renderFactory,\r\n                    \"dataService\": dataservice,\r\n                    \"parent\": self,\r\n                    \"data\": {\r\n                        properties: propertiesGridForm\r\n                    }\r\n                };\r\n\r\n                var formlink = new bizagi.rendering.formLink(argumentsfl);\r\n\r\n                jQuery.extend(formlink, {\r\n                    contextEdit: $(container).find(\"#container-items-edit\"),\r\n                    element: self.element,\r\n                    actionSave: self.actionSaveNewRow,\r\n                    actionCancel: self.actionCancelRow,\r\n                    _sendRelation: function () {\r\n                        return true;\r\n                    },\r\n                    _getData: self.dataService.getFormData,\r\n                    _params: propertiesGridForm\r\n                });\r\n\r\n                self._InternalRenderLinkForm(formlink);\r\n                bizagi.util.smartphone.stopLoading();\r\n            }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n    },\r\n\r\n    /* edit form in the grid*/\r\n    editRow: function (id) {\r\n        var self = this;\r\n\r\n        //save form in case the user has made changes in the inline row\r\n        var containerForm = self.getFormContainer();\r\n        containerForm.saveForm();\r\n\r\n        var properties = self.properties;\r\n        var container = self.getFormContainer().container;\r\n        var dataservice = self.dataService;\r\n\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n        $.when(containerForm.saveForm()).done(function () {\r\n            var propertiesGridForm = {\r\n                idRender: properties.id,\r\n                id: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                recordXPath: recordXpath,\r\n                xpath: recordXpath,\r\n                editable: true,\r\n                url: properties.editPage,\r\n                requestedForm: \"editForm\",\r\n                displayName: properties.editLabel,\r\n                idAsigned: id,\r\n                disableProcessButons: true\r\n            };\r\n\r\n            var argumentsfl = {\r\n                \"renderFactory\": self.renderFactory,\r\n                \"dataService\": dataservice,\r\n                \"parent\": self,\r\n                \"data\": {\r\n                    properties: propertiesGridForm\r\n                }\r\n            };\r\n\r\n            var formlink = new bizagi.rendering.formLink(argumentsfl);\r\n\r\n            jQuery.extend(formlink, {\r\n                contextEdit: $(container).find(\"#container-items-edit\"),\r\n                element: self.element,\r\n                //disable if you want only save at the end (submit the form)\r\n                actionSave: self.actionSaveNewRow,\r\n                actionCancel: self.actionCancelRow,\r\n                _sendRelation: formlink.submitEditRequest,\r\n                _getData: self.dataService.getFormData,\r\n                _params: propertiesGridForm\r\n            });\r\n\r\n            self._InternalRenderLinkForm(formlink);\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n    },\r\n\r\n    _InternalRenderLinkForm: function (formlink) {\r\n        $.when(formlink.renderEdition()).done(\r\n            function () {\r\n                formlink.endLoading();\r\n            }\r\n        );\r\n    },\r\n\r\n    /**\r\n     *  Deletes  a row to the grid\r\n     */\r\n    deleteRow: function (id) {\r\n        var self = this;\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n                // Do a grid record deletion\r\n                $.when(self.submitDeleteRequest(id))\r\n                    .done(function (data) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n                        if (data.type == \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\r\n                        }\r\n                    }).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     *  Shows detail form\r\n     */\r\n    showDetail: function (id) {\r\n        var self = this;\r\n        self.executeSubmitShowDetailRequest(id);\r\n    },\r\n\r\n    /**\r\n     * Execute the request for details. \r\n     */\r\n    executeSubmitShowDetailRequest: function(id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n        var dataservice = self.dataService;\r\n        var renderFactory = self.renderFactory;\r\n        var formView = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: self.getParams().navigation,\r\n            container: self.getFormContainer().container,\r\n            showSaveButton: false\r\n        });\r\n\r\n        formView.render({\r\n            idRender: properties.id,\r\n            recordXPath: recordXpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            requestedForm: \"detailForm\",\r\n            editable: false\r\n        })\r\n    },\r\n\r\n    actionCancelRow: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.submitRollbackRequest()).done(function () {\r\n            deferred.resolve();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     * Save data in the form link related\r\n     * parameter: data data collected in the related form link\r\n     */\r\n    actionSaveNewRow: function (data) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        if (self.form.validateForm() === true) {\r\n            var properties = self.properties;\r\n\r\n            if (!data) {\r\n                self.form.collectRenderValues(data);\r\n            }\r\n\r\n            data.idPageCache = self.form.getPageCache();\r\n\r\n            $.when(\r\n                self.parent.submitSaveRequest(properties.idAsigned, data)).done(function (resp) {\r\n                if (resp.type == \"validationMessages\") {\r\n                    self.form.addValidationMessage(resp.messages);\r\n                    properties.submitOnChange = false;\r\n                    deferred.reject(resp.messages);\r\n                } else {\r\n                    self.parent.fetchData();\r\n                    if (!properties.submitOnChange) {\r\n                        properties.submitOnChange = true;\r\n                    }\r\n                    self.submitOnChange({}, true);\r\n                    deferred.resolve();\r\n                }\r\n            });\r\n        } else {\r\n            deferred.reject();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    applyActionUpdateGrid: function (column, context) {\r\n        var self = context;\r\n        var originalMethod = column.decorated.actionSave;\r\n\r\n        jQuery.extend(column.decorated, {\r\n            actionSave: function () {\r\n                var selfIntern = this;\r\n                $.when(originalMethod.apply(selfIntern, arguments)).done(function () {\r\n                    var data = {};\r\n                    self.collectRenderValues(data);\r\n\r\n                    $.when(self.submitSaveRequest(selfIntern.surrogateKey, data)).done(function () {\r\n                        self.fetchData();\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n\r\n        $.each(self.columns, function (i, child) {\r\n            child = child.decorated;\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValues(renderValues);\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSent()) {\r\n                    child.collectData(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Returns a promise that will resolve when the element is ready\r\n     */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*   Sets an error on the cell\r\n     */\r\n    setError: function (key, xpath) {\r\n        var self = this;\r\n    },\r\n\r\n    /*\r\n     *  Changes the required for cell\r\n     */\r\n    changeCellValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control) {\r\n            if (argument != null)\r\n                control.setDisplayValue(argument);\r\n\r\n            //ISUPP 3866\r\n            var _value = control.column.getValue(key);\r\n            var compositeValue = control.column.getCompositeValue(key);\r\n\r\n            if (argument != null)\r\n                control.setDisplayValue(argument);\r\n\r\n            var trigger = false;\r\n            self.collectGridChange({ id: key, xpath: xpath, value: _value, compositeValue: compositeValue, columnIndex: control.column, trigger: trigger });\r\n        }\r\n    },\r\n\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control) {\r\n            control.changeCellBackgroundColor(argument);\r\n\r\n            // Exclusive for complex elements such as checkboxes, and list\r\n            if (control.element) {\r\n                control.element.find(\".bz-container-render-cell1, .ui-bizagi-render-control\").css({\r\n                    \"background-color\": argument,\r\n                    \"background-image\": argument\r\n                });\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeCellColor(argument);\r\n        }\r\n    },\r\n    /*\r\n     *   Changes the visibility for a cell\r\n     */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeCellVisibility(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).visible = argument;\r\n\r\n            // Bind/Ubind the render change, so it can works with actions and validations as needed\r\n            if (control.properties.editable && argument) {\r\n                self.bindRenderChange(self.getColumn(xpath), key, true);\r\n            } else {\r\n                self.bindRenderChange(self.getColumn(xpath), key, false);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the editability for a cell\r\n     */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeEditability(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).editable = argument;\r\n\r\n            // Bind/Unbind the render change, so it can works with actions and validations as neededn\r\n            if (control.properties.visible && argument) {\r\n                self.bindRenderChange(self.getColumn(xpath), key, true);\r\n            } else {\r\n                self.bindRenderChange(self.getColumn(xpath), key, false);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeMinValue(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).minValue = argument;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeMaxValue(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).maxValue = argument;\r\n        }\r\n    },\r\n\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.cleanData();\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            var rows = self.properties.data.rows, i = 0, rowLength = rows.length;\r\n            for (; i < rowLength; i++) {\r\n                if (Number(key) === rows[i][0]) {\r\n                    rows[i][j + 1] = [[\"\", \"\"]];\r\n                    break;\r\n                }\r\n            }\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).value = null;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the grid plugin event\r\n     * @returns {}\r\n     */\r\n    triggerGridPluginHandler: function () {\r\n        var self = this;\r\n        var args = Array.prototype.slice.call(arguments, 0);\r\n\r\n        return self.grid.bizagi_grid_smartphone.apply(self.grid, args);\r\n    },\r\n\r\n    isValidGrid: function (invalidElements) {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof (form.validationController) !== \"undefined\")\r\n            form.validationController.clearValidationMessages();\r\n\r\n        self.isValid(errorsMessage);\r\n\r\n        if (errorsMessage.length > 0) {\r\n            if (typeof (form.validationController) !== \"undefined\") {\r\n                for (var i = 0, length = errorsMessage.length; i < length; i++) {\r\n                    // Show validation message\r\n                    form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                }\r\n            }\r\n\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    },\r\n\r\n    getLabel: function () {\r\n        var self = this;\r\n        return $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        self._super(color);\r\n\r\n        var control = self.getControl();\r\n        control.find(\".bz-rn-grid-cn-header\").css(\"background-color\", color, \"!important\");\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    startLoading: function() {\r\n        bizagi.loading.start();\r\n    },\r\n    endLoading: function() {\r\n        bizagi.loading.stop();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Smartphone Render Join Aearch Dialog Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the Join Search Dialog render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.search.extend(\"bizagi.rendering.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    SEARCH_MIN_LENGTH: 3,\r\n    SEARCH_DELAY: 750\r\n}, {\r\n   \r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"readonlySearch\");\r\n        var value = self.properties.value && self.hasValue() ? self.properties.value.label : \"\";\r\n\r\n        return $.kendoTmpl(template, {value: value});\r\n    },\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        //Getting the control content\r\n        self.input = $(\".bz-rn-container-search\", control);\r\n        self.inputText = self.input.find(\".bz-rn-input-search-text\");\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            self.inputText = $('.bz-rn-text', control);\r\n        }\r\n\r\n        if (properties.allowSuggest) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            if (properties.editable) {\r\n                self._simplySearch();\r\n            }\r\n        }\r\n\r\n        self.configureHandlers();\r\n    },\r\n\r\n    configureHandlers: function(){\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        if (self.properties.advancedSearch && properties.editable) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.input.bind(\"click\", function () {\r\n                self.renderSearchForm();\r\n            });\r\n        }\r\n\r\n        if(properties.editable){\r\n            self.input.on(\"click\", \".bz-rn-search-control-icons-clear\", function(e){\r\n                e.stopPropagation();\r\n                self.setValue({id: \"\"});\r\n                self.inputText.prop(\"value\", \"\");\r\n                $(this).addClass(\"hidden\");\r\n                self.inputText.removeClass(\"hasValue\");\r\n            });\r\n        }\r\n    },\r\n\r\n    hasValue: function(){\r\n        var self = this;\r\n        return self.getValue() != null && self.getValue().id !== \"\" && typeof self.getValue().id !== \"undefined\";\r\n    },\r\n\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n        var params = {\r\n            allowSuggest: properties.allowSuggest,\r\n            editable: properties.editable,\r\n            allowClear: properties.allowClear,\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            hasValue: self.hasValue(),\r\n            allowTyping: properties.allowTyping,\r\n            advancedSearch: properties.advancedSearch,\r\n            hasMozillaHelpText: ($.browser && $.browser.mozilla && properties.helpText !== null && properties.helpText != \"\") ? true : false\r\n        };\r\n\r\n        return $.kendoTmpl(template, params);\r\n    },\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n\r\n        // Filter by valid xpaths and valid values\r\n        // Remove empty validation for value for combos\r\n        if (!compareValue || compareValue.id !== value.id || $.forceCollectData) { //if original value is equal to value\r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) == \"object\" && value.id === undefined)\r\n                    return;\r\n                // Add the value to the server\r\n                renderValues[properties.xpath] = value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value to show and calls the method to sets the control value\r\n     * @param {object} value\r\n     * @param {int} value.id\r\n     * @param {string} value.label\r\n     * @param {string=} value.additionallabel\r\n     * @example\r\n     *   value = {\r\n     *     id: 123,\r\n     *     label: \"xx\",\r\n     *     additionallabel: \"yyyy\"\r\n     *   }\r\n    */\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var label = \"\";\r\n        value = self.mapValue(value);\r\n\r\n        if (value !== null && typeof value !== \"undefined\" && typeof value.id !== \"undefined\") {\r\n            if (value.additionallabel && value.label) {\r\n                label = value.label + \", \" + value.additionallabel;\r\n            } else if (value.label) {\r\n                label = value.label;\r\n            } else {\r\n                label = \"\";\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                self.setValue(value, true);\r\n                self.inputText.val(label);\r\n                self.inputText.attr(\"id\", value.id);\r\n                self.inputText.html(label);\r\n\r\n                if(typeof value !== \"undefined\"){\r\n                    self.inputText.addClass(\"hasValue\");\r\n                }else{\r\n                    self.inputText.removeClass(\"hasValue\");\r\n                }\r\n            } else {\r\n                self.inputText.text(label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = { id: \"\", value: \"\" };\r\n        self.setValue(value);\r\n        self.setDisplayValue(value);\r\n    },\r\n\r\n    _simplySearch: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.inputText.on(\"click keyup\", function () {\r\n            self.autoCompleteSearchResults();\r\n        });\r\n\r\n        control.on(\"click mousedown\", \"li\", function () {\r\n            var elemObject = $.data(this).itemautocomplete;\r\n            var label = Array.isArray(elemObject.value) ? elemObject.value.join(\",\") : elemObject.value;\r\n            self.setDisplayValue({ id: elemObject.id, label: label });\r\n            $(this).parent().hide();\r\n            self.input.find(\".bz-rn-search-control-icons-clear\").removeClass(\"hidden\");\r\n            self.inputText.addClass(\"hasValue\");\r\n        });\r\n\r\n        control.on(\"focusout\", \"input\", function () {\r\n            control.find(\"ul\").hide();\r\n            self.inputText.parent().find(\".bz-rn-autocomplete-wrapper\").addClass(\"hidden\");\r\n        });\r\n    },\r\n\r\n    /* Apply autocomplete capabilities to a single input*/\r\n    autoCompleteSearchResults: function () {\r\n        var self = this;\r\n        var currentValue = self.inputText.val();\r\n        if(currentValue === \"\"){\r\n            self.input.find(\".bz-rn-search-control-icons-clear\").addClass(\"hidden\");\r\n        }\r\n\r\n        $.when(\r\n            self.processRequest({ term: currentValue }, function () { })\r\n        ).done(function (resp) {\r\n            var wrapper = self.inputText.parent().find(\".bz-rn-autocomplete-wrapper\");\r\n            if(resp.length > 0){\r\n                wrapper.removeClass(\"hidden\");\r\n            } else {\r\n                if (!wrapper.hasClass(\"hidden\")) {\r\n                    wrapper.addClass(\"hidden\");\r\n                }\r\n            }\r\n\r\n            var elementUl = self.inputText.parent().find(\"ul\");\r\n            elementUl.find(\"li\").remove();\r\n\r\n            elementUl.css({\r\n                display: \"inline-block\",\r\n                left: self.inputText.position().left,\r\n                top: self.inputText.position().top + 15,\r\n                width: self.inputText.css(\"width\")\r\n            });\r\n\r\n            for (var i = 0, length = resp.length ; i < length; i++) {\r\n                var searchItem = self.renderSearchItem(resp[i]);\r\n                $(searchItem).addClass(\"bz-rn-autocomplete-item\");\r\n                searchItem.appendTo(elementUl);\r\n            }\r\n        });\r\n    },\r\n\r\n    renderSearchForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var formSearchParams = $.extend({}, self.getParams(), {\r\n            navigation: self.getFormContainer().getNavigation()\r\n        });\r\n\r\n        var searchForm = new bizagi.rendering.smartphone.helpers.searchForm(self.dataService, self.renderFactory, properties.searchForms, {\r\n                allowFullSearch: properties.allowFullSearch,\r\n                maxRecords: properties.maxRecords,\r\n                allowNew: properties.allowNew || false,\r\n                orientation: properties.orientation || \"ltr\"\r\n            },\r\n            formSearchParams\r\n        );\r\n\r\n        searchForm.renderEdition({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            displayName: properties.displayName,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (itemId) {\r\n            self.setValue({ id: itemId });\r\n\r\n            //send the item selected\r\n            properties.submitOnChange = true;\r\n\r\n            self.submitData();\r\n        });\r\n    },\r\n\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var searchItem = $.kendoTmpls(self.renderFactory.getTemplate(\"edition.search.item\"), {\r\n            id: item.id,\r\n            label: item.label,\r\n            value: item.value\r\n        });\r\n\r\n        searchItem.data(\"itemautocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Create array for response objects   \r\n        var suggestions = [];\r\n\r\n        // Add to suggestions function                \r\n        function addToSuggestions(alSuggestions) {\r\n\r\n            // Add the clear option             \r\n            /*\r\n             // TODO: To implement allowClear\r\n             if (properties.allowClear && (self.value !== undefined)) {\r\n             alSuggestions.push({ id: self.Class.CLEAR_SEARCH_ID, label: \"\", value: \"\" });\r\n             }*/\r\n            // Add additional option if advanced search is on\r\n            if (properties.advancedSearch) {\r\n                alSuggestions.push({ id: self.Class.ADVANCED_SEARCH_ID, label: \"\", value: \"\" });\r\n            }\r\n            // Add additional option if allow addition is on\r\n            if (properties.allowAdd) {\r\n                alSuggestions.push({ id: self.Class.ADVANCED_ADDITION_ID, label: \"\", value: \"\" });\r\n            }\r\n\r\n            // Pass array to callback   \r\n            defer.resolve(alSuggestions);\r\n\r\n        }\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            this.getData()\r\n                .done(function (data) {\r\n                    // Process response to highlight matches\r\n\r\n                    var i = -1;\r\n                    var a;\r\n                    while (a = data[++i] && properties.maxRecords > i && i < 10) {\r\n                        suggestions.push({\r\n                            id: data[i].id,\r\n                            label: data[i].value.toString().replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + $.ui.autocomplete.escapeRegex(req.term) + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"), \"<strong>$1</strong>\"),\r\n                            value: data[i].value\r\n                        });\r\n                    }\r\n\r\n                    addToSuggestions(suggestions);\r\n\r\n                }).fail(function () {\r\n                //fail\r\n                defer.reject();\r\n            });\r\n\r\n        } else {\r\n            addToSuggestions(suggestions);\r\n        }\r\n\r\n        /* \r\n         *   Method to add the special items to the suggestions\r\n         */\r\n        return defer.promise();\r\n    },\r\n\r\n    setDisplayValueEdit: function (value) {\r\n        var self = this;\r\n\r\n        self.inputEdition.find(\".ui-bizagi-render-search\").val(self.selectedValue);\r\n    },\r\n\r\n    //on the desktop only sends the id to submit \r\n    //in the smartphone it send the id and the value\r\n    submitData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add current data\r\n        var data = {};\r\n\r\n        data[properties.xpath] = self.getValue();\r\n\r\n        // Executes submit on change\r\n        if (properties.submitOnChange && data[properties.xpath].id != undefined)\r\n            self.submitOnChange(data, true);\r\n    },\r\n\r\n    actionSave: function () {\r\n        var self = this;\r\n\r\n        self.inputText.html(self.value.value || self.value.label);\r\n        self.inputText.val(self.value.value || self.value.label);\r\n        self.inputText.attr(\"id\", self.value.id);\r\n    }\r\n});","/*\r\n*   Name: BizAgi smartphone Render Letter Extension\r\n*   Author: oscaro\r\n*   Comments:\r\n*   -   This script will redefine the letter render class to adjust to smartphones devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.letter.extend(\"bizagi.rendering.letter\", {}, {\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.editable = false;\r\n    }\r\n});\r\n","/**\r\n*   Name: Bizagi Smartphone Render Button Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the button render class to adjust to smartphone devices\r\n*/\r\n\r\nbizagi.rendering.button.extend(\"bizagi.rendering.button\", {}, {\r\n\r\n    /**\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        $.when(self.renderControl()).done(function() {\r\n            self.input = $(\":button\", control).click(function() {\r\n                self.processButton();\r\n            });\r\n        }).always(function() {\r\n            if (properties.editable)\r\n                container.addClass(\"bz-command-edit-inline\");\r\n            else {\r\n                container.addClass(\"bz-rn-non-editable\");\r\n                self.input.prop(\"disabled\", true);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    *   Process the button actions workflow\r\n    */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            // Check if action need conformation\r\n            if (properties.needsUserConfirmation) {\r\n                $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, \"Bizagi\", \"warning\"))\r\n                    .done(function () {\r\n                        // Trigger change\r\n                        self.triggerRenderChange({ pressed: true });\r\n                    });\r\n            } else {\r\n                if (!properties.preventDefault) {\r\n                    self.runButtonAction();\r\n                }\r\n                // Trigger change\r\n                self.triggerRenderChange({ pressed: true });\r\n            }\r\n        }\r\n    },\r\n\r\n    runButtonAction: function () {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function () {\r\n            return self.executeButton();\r\n        }).done(function (result) {\r\n            if (result == null || result == true || result.result == \"success\" || result.type == \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type == \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages \r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                    bizagi.showMessageBox(result.messages, \"Error\");\r\n                }\r\n            }\r\n        }).fail(function (a, b, message) {\r\n            // Add error messages\r\n            try {\r\n                self.getFormContainer().addErrorMessage(message);\r\n            } catch (e) {\r\n                bizagi.showMessageBox(message, \"Error\");\r\n            }\r\n        });\r\n    },\r\n\r\n    // rewrite method to prevent the button on the tablet be affected when customizing on other platforms\r\n    processLayout: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n\r\n        if (!visible) {\r\n            self.changeVisibility(visible);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render fileprint Extension\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.fileprint.extend(\"bizagi.rendering.fileprint\", {}, {\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        self.getControl().parent().hide();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi smartphone Render Link Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to tablet devices\r\n */\r\nbizagi.rendering.link.extend(\"bizagi.rendering.link\", {}, {\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        self.input = control.find(\"a\");\r\n        self.getArrowContainer().hide();\r\n\r\n        if (self.properties.value) {\r\n            self.configureHandlers();\r\n        } else {\r\n            link.addClass(\"ui-state-disabled\");\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     *\r\n     * @param {String} value The control's value that is needed to be displayed\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        if (self.isValidValue(value)) {\r\n            //Get the decoded version of the URL\r\n            value = getFullyDecodedURI($.trim(value));\r\n            self.input.attr(\"href\", value);\r\n        }\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.input.on(\"click\", function (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n            if (self.isValidValue(properties.value)) {\r\n                var linkEncode = encodeURI(this.getAttribute(\"href\"));\r\n\r\n                if (properties.linktarget === \"newwindow\" || bizagi.util.isCordovaSupported()) {\r\n                    window.open(linkEncode, \"_system\", \"location=yes\");\r\n                } else {\r\n                    window.open(linkEncode, \"_system\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     *\r\n     * @param {String} value Stored value in the control\r\n     */\r\n    isValidValue: function (value) {\r\n        return (value && $.trim(value + \"\").toLowerCase().match(/^(http|https):\\/\\//) !== null) || false;\r\n    }\r\n});","/**\r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.checkList.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base \r\n        this._super();\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n        // Apply plugin\r\n        //$(\".ui-bizagi-render-checkList-label\", self.checkListGroup).check();\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n            var itemId = $(this).data(\"item-guid\");\r\n            var checked = false;\r\n            if ($(this).hasClass(\"bz-check\")) {\r\n                $(this).removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checked = false;\r\n            } else {\r\n                $(this).removeClass(\"bz-full-ball\").addClass(\"bz-check\");\r\n                checked = true;\r\n            }\r\n\r\n            self.onCheckListGroupChange(itemId, checked);\r\n        });\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        $(\"input[type=checkbox]\", self.checkListGroup).removeAttr(\"checked\");\r\n    },\r\n\r\n    setDisplayValue : function (value){\r\n        var self = this;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.checkList.extend(\"bizagi.rendering.activityCheckList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n        self.header = $(\".ui-bizagi-render-checkList-activity-work\", self.element);\r\n        self.addButton = $(\".ui-bizagi-render-checkList-add-item\", self.control);\r\n        self.newItemName = $(\".ui-bizagi-render-checkList-input-name\", self.control);\r\n        self.separator = $(\".ui-bizagi-render-checkList-separator\", self.element);\r\n        self.goalActivity = $(\".ui-bizagi-render-checkList-goal-activity\", self.element);\r\n        self.addEditButton = $(\".add-edit-item-button-checklist\", self.control);\r\n        self.cancelEditButton = $(\".cancel-edit-item-button-checklist\", self.control);\r\n        self.additionalElements();\r\n        self.configureHandlers();\r\n        $(\".ui-bizagi-render-edition-arrow\", self.getControl().parent()).hide();\r\n\r\n        self.notifyLoadItems();        \r\n    },\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            var resolvedItems = self.properties.items.filter(function(i){\r\n                return i.resolved\r\n            }).length;\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': true,\r\n                'idActivity': self.properties.idActivity,\r\n                'itemsResolved': resolvedItems,\r\n                'items': self.properties.items,\r\n                'progress': self.properties.activityWork\r\n            }));\r\n\r\n            bizagi.webpart.publish(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var activityWorkTitle = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        var activityFormTitle = this.getResource(\"render-activity-check-list-form\");\r\n        if (!(self.header && self.header.length > 0)) {\r\n            self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-activity-work\").append($(\"<span/>\").text(bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\"))));\r\n        }\r\n        if (!(self.goalActivity && self.goalActivity.length > 0)) {\r\n            if(self.properties.activityDescription && self.properties.activityDescription !== \"\"){\r\n                self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-goal-activity\").append(\"<h4><span class='ui-bizagi-wp-bold'>\" +\r\n                bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") +\r\n                \": </span><span>\" + self.properties.activityDescription  + \"</span></h4>\"));\r\n            }\r\n        }\r\n        if (!(self.addButton && self.addButton.length > 0)) {\r\n            self.control.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-add-item\").append($(\"<button/>\").text(\"+\")));\r\n        }\r\n        if (!(self.separator && self.separator.length > 0)) {\r\n            self.element.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-separator\").append($(\"<span/>\").text(activityFormTitle)));\r\n        }\r\n        if (self.addEditButton && self.addEditButton.length > 0) {\r\n            self.addEditButton.hide();\r\n        }\r\n        if (self.cancelEditButton && self.cancelEditButton.length > 0) {\r\n            self.cancelEditButton.hide();\r\n        }\r\n        control.parent().addClass(\"render-activity-check\");\r\n    },\r\n\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n        $(\".ui-bizagi-render-checkList-add-item button\", control).unbind(\"click\").click(function() {\r\n            var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".ui-bizagi-render-checkList-input-name\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\".delete-item-from-activity\", self.control).bind(\"click\", function() {\r\n            var that = this;\r\n            var message = bizagi.localization.getResource(\"workportal-widget-reports-confirm\");\r\n            var contentHolder = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n\r\n            contentHolder.addClass(\"ui-bizagi-to-remove\");\r\n           \r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function() {\r\n\r\n                    var itemId = $(that).closest(\".ui-bizagi-render-checkList-item\").data(\"item-guid\");\r\n\r\n                    self.deleteItem(itemId);\r\n                    self.addButton.show();\r\n\r\n                }).fail(function() {\r\n                    contentHolder.removeClass(\"ui-bizagi-to-remove\");\r\n                });\r\n        });\r\n\r\n        $(\".activity-work-items\", self.control).bind(\"click\", function() {\r\n            var element = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemId = element.data(\"item-guid\");\r\n            var itemPosition = element.data(\"item-position\");\r\n\r\n            self.selectItem(itemId, itemPosition);\r\n        });\r\n    },\r\n\r\n    selectItem: function(itemId) {\r\n        var self = this;\r\n\r\n        for (var i = 0, length = self.properties.items.length; i < length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items[i].selected = true;\r\n            } else {\r\n                self.properties.items[i].selected = false;\r\n            }\r\n        }\r\n\r\n        self.repaintControl();\r\n\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\");\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n        self.addButton.hide();\r\n\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function(itemId) {\r\n        var self = this;\r\n\r\n        for (var i = 0, length = self.properties.items.length; i < length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.addButton.hide();\r\n        self.newItemName.focus();\r\n\r\n        self.newItemName.blur(function () {\r\n             var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n             var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n             var valueInput = itemSelectedName.val();\r\n\r\n             if(valueInput === \"\" && self.properties.items && self.properties.items.length >= 1\r\n                    && self.properties.items.slice(-1)[0].name === \"\"){\r\n                self.properties.items.pop();\r\n             }\r\n         });\r\n        self.addSelectedHandlers();\r\n        self.newItemName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                self.addItem();\r\n                self.prepareNewItem();\r\n            }\r\n        });\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        itemSelectedName.focus();\r\n        $(\".add-item-button-checklist\", itemSelected).bind(\"click\", function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n        });\r\n        $(\".cancel-item-button-checklist\", itemSelected).bind(\"click\", function (e) {\r\n            var newItemName = itemSelectedName.val();\r\n            var element = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemPosition = element.data(\"item-position\");\r\n            var guidItem = element.data(\"item-guid\");\r\n\r\n            if (newItemName && newItemName !== \"\" && self.properties.items[itemPosition].name !== \"\") {\r\n                self.properties.items[itemPosition].selected = false;\r\n            }\r\n            if (newItemName === \"\" || self.properties.items[itemPosition].name === \"\") {\r\n                self.deleteItem(guidItem);\r\n            }\r\n            self.addButton.show();\r\n            self.repaintControl();\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.addButton.show();\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var checkListHtml = self.renderControl();\r\n        $(\".ui-bizagi-render-checkList\", self.control).replaceWith(checkListHtml);\r\n        self.postRenderSingle();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            control = self.getControl(),\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 100;\r\n        }\r\n\r\n        self.notifyLoadItems();\r\n    },\r\n\r\n    getValue: function (data) {\r\n        var self = this;\r\n\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    renderValues[properties.xpath] = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }else{\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': false\r\n            }));\r\n        }\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                break;\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Render Layout Image Class\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable image control inside templates\r\n *   -   This control is based on the image no flash render control\r\n */\r\n\r\nbizagi.rendering.layoutImage.extend(\"bizagi.rendering.layoutImage\", {\r\n\r\n}, {\r\n    renderControl: function () {\r\n        var self = this;\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n        self.control = self.getControl();\r\n        return $.kendoTmpl(templateUri, {});\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.media.byteArrayToBlob(bizagi.util.media.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    \r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n        var templateControl = self.parent.parent;\r\n        var renderParams = templateControl.properties.paramsRender || {};\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value,\r\n            idcase: renderParams.idRender ? renderParams.formParams.idCase : \"_\",\r\n            idworkitem: renderParams.idRender ? renderParams.formParams.idWorkitem : \"_\",\r\n            contextxpath: renderParams.idRender ? renderParams.xpathActions : \"_\"\r\n        };\r\n        \r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return [self.value];\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n *   -   This control is based on the link render control\r\n */\r\n\r\nbizagi.rendering.layoutLink.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var container = self.getContainerRender();\r\n        container.addClass(\"bz-command-not-edit\");\r\n        self.value = undefined;\r\n    },\r\n\r\n    postRenderSingle: function(){\r\n        var self= this;\r\n        var element = self.element;\r\n        if (element){\r\n            element.on(\"click\", $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n\r\n    onClickElement: function(){\r\n        var self = this,\r\n            params = {\r\n                \"displayName\": self.properties.displayName,\r\n                \"navigateFromRender\": false,\r\n                \"reference\": self.properties.reference,\r\n                \"referenceType\": self.properties.referenceType,\r\n                \"xpath\": self.properties.xpath\r\n            };\r\n        if (bizagi.kendoMobileApplication && bizagi.kendoMobileApplication.view().id == \"#renderSplitView\"){\r\n            params.navigateFromRender = true;\r\n        }\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", params);\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Label Class\r\n*   Author: Ricardo Pérez\r\n*   Comments:\r\n*   -   This script will define basic stuff for labels inside templates\r\n*/\r\n\r\nbizagi.rendering.layoutLabel.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n\r\n    setValue: function(val,triggerEvents) {\r\n        var self = this;\r\n        self.properties.displayName = val;\r\n        this._super(val, triggerEvents);\r\n        var control = self.getControl();\r\n        if(control) {\r\n            $(\".ui-bizagi-render-label\", control).text(val);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Ricardo Pérez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\nbizagi.rendering.layoutText.extend(\"bizagi.rendering.layoutText\", {}, {\r\n    setDisplayValue: function (value) {\r\n    }\r\n});","/*\r\n*   Name: BizAgi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutDateTime.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template number Extension\r\n *   Author: Mauricio Sanchez\r\n *   Comments:\r\n *   -   This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutNumber.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        val = (typeof val === \"undefined\" || val === null) ?  \"\" : self.getDisplayValue(val);\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var label = $('<label/>').html(value); // To get the display value by the format currency plugin, because it requires a control\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        return [label.text()];\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template Money Extension\r\n *   Author: Andres Fernando Muñoz\r\n *   Comments:\r\n *   -   This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutMoney.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n\tvar self = this;\r\n\tvar control = self.getControl();\r\n\r\n\tval = (typeof val === \"undefined\" || val === null) ?  \"\" : self.getDisplayValue(val);\r\n\tself.properties.displayName = val;\r\n\r\n\tthis._super(val, triggerEvents);\r\n\tif(control) {\r\n\t    $(\".ui-bizagi-render-number\", control).text(val);\r\n\t}\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\nbizagi.rendering.layoutUpload.extend(\"bizagi.rendering.layoutUpload\", {}, {\r\n\t/**\r\n\t *   Template method to implement in each children to customize each control\r\n\t */\r\n\trenderControl: function () {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties,\r\n\t\t\tdefer = $.Deferred();\r\n\r\n\t\t$.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n\t\t\tself.properties = properties;\r\n\t\t\tself.files = valueResult.files;\r\n\t\t\tdefer.resolve(self.getHTMLFiles());\r\n\t\t});\r\n\r\n\t\treturn defer.promise();\r\n\t},\r\n\r\n\tpostRenderSingle: function() {\r\n\t    var self = this;\r\n\t    var control = self.getControl();\r\n\t    var filesLinkElements = control.find(\".ui-bizagi-render-upload-item a\");\r\n\r\n\t    filesLinkElements.on(\"click\", function() {\r\n\t        bizagi.loading.start();\r\n\t        $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function(error) {\r\n\t            if (error.responseText) {\r\n\t                self.getFormContainer().failHandler(error.responseText);\r\n\t            }\r\n\t        }).always(function() {\r\n\t            bizagi.loading.stop();\r\n\t        });\r\n\t    });\r\n\t},\r\n\r\n\tgetHTMLFiles: function(){\r\n\t\tvar self = this;\r\n\t\tvar files = $.map(self.files, function(el){\r\n\t\t\tvar file = {\"id\": el[0], \"filename\": el[1]};\r\n\t\t\tfile.url =  self.buildItemUrl(file);\r\n\t\t\treturn file;\r\n\t\t});\r\n\r\n\t\tvar template = self.renderFactory.getTemplate(\"layout-upload\");\r\n\t\treturn $.kendoTmpl(template, {\"files\": files});\r\n\t},\r\n\r\n\t/**\r\n\t *   Builds the upload item url\r\n\t */\r\n\tbuildItemUrl: function (file) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\treturn self.dataService.getUploadFileEntityUrl({\r\n\t\t\tisContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n\t\t\txpath: self.getUploadXpath(),\r\n\t\t\tfileId: file.id,\r\n\t\t\tidRender: form.properties.paramsRender.idRender || \"undefined\",\r\n\t\t\txpathContext: properties.xpathContext,\r\n\t\t\tidPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n\t\t\txpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n\t\t\tsessionId: form.properties.sessionId,\r\n\t\t\tsurrogatekey: self.properties.value.surrogateKey,\r\n\t\t\tguidentity: self.properties.value.guid\r\n\t\t});\r\n\t}\r\n});","/*\r\n *   Name: BizAgi Render Image Class\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to smathphone devices\r\n */\r\n\r\n// Extends itself\r\n//noinspection JSValidateTypes\r\nbizagi.rendering.image.extend(\"bizagi.rendering.image\", {\r\n    QUALITY_PICTURE: 50,\r\n    EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"]\r\n}, {\r\n    /**\r\n     * Just listing the order of function calls (bizagi.rendering.render)\r\n     * 1. renderControl (found it on bizagi.rendering.image)\r\n     * 2. postRender / postRenderReadOnly / postRenderPrintVersion\r\n     * 3. configureHandlers / configureHandlersReadOnly\r\n     *\r\n     * Other functions are just local implementation\r\n     *\r\n     */\r\n\r\n    /**\r\n     * DOM elements to use as an ADD option button\r\n     * @var $actionImage jQuery DOM\r\n     */\r\n    $addImage: null,\r\n    /**\r\n     * DOM elements to use as a REMOVE option button\r\n     * @var $actionImage jQuery DOM\r\n     */\r\n    $deleteImage: null,\r\n    /**\r\n     * DOM input to handle HTML uploads\r\n     * @var $inputFile jQuery DOM\r\n     */\r\n    $inputFile: null,\r\n    /**\r\n     * Whether or not is a native device 'Just a shortcut\r\n     * @var isNative boolean\r\n     */\r\n    isNative: false,\r\n    /**\r\n     * Whether or not we are offline 'Just a shortcut\r\n     * @var isOfflineForm boolean\r\n     */\r\n    isOfflineForm: false,\r\n\r\n    /**\r\n     * This method tries to get the HTML template an render the current object inside\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        /**\r\n         * Check if this is an offline form\r\n         * It doesn't validate if the device goes offline so.. (but smartphone)\r\n         */\r\n        //this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\r\n        this.isOfflineForm = false;\r\n        this.isNative = bizagi.util.isCordovaSupported();\r\n\r\n        var template = self.renderFactory.getTemplate(\"image\");\r\n\r\n        var allowDelete = self.isOfflineForm ? false : properties.allowDelete && properties.editable;\r\n        return $.kendoTmpl(template, {\r\n            url: \"\",\r\n            allowDelete: allowDelete,\r\n            editable: properties.editable\r\n        });\r\n    },\r\n\r\n    getElementsToStylize: function(context) {\r\n        return $({});\r\n    },\r\n\r\n    /**\r\n     * There is no difference when rendering a readonly image, so ...\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderReadOnly: function() {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * After rendering element\r\n     */\r\n    postRender: function() {\r\n    },\r\n\r\n    /**\r\n     * After rendering a readonly element\r\n     */\r\n    postRenderReadOnly: function() {\r\n        // Just a little colors\r\n        this.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n    },\r\n\r\n    /**\r\n     * Add action handlers\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var version = bizagi.util.getAndroidVersion();\r\n        var resolutionUpload = [];\r\n\r\n        this.$addImage = $(\".bz-rn-image-actions-add\", this.getControl());\r\n        this.$deleteImage = $(\".bz-rn-image-actions-delete\", this.getControl());\r\n        this.$inputFile = $(\".bz-rn-upload-image-web\", this.getControl());\r\n\r\n        this._super();\r\n\r\n        if (this.isNative) {\r\n            // Upload Image Options\r\n            this.$addImage.off(\"click\").actionSheet({\r\n                actions: [\r\n                    {\r\n                        \"guid\": 1,\r\n                        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\")\r\n                    },\r\n                    {\r\n                        \"guid\": 2,\r\n                        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\")\r\n                    }\r\n                ],\r\n                actionClicked: function(action) {\r\n                    switch (action.guid) {\r\n                    case 1:\r\n                        self.imageAdd();\r\n                        break;\r\n                    case 2:\r\n                        self.imageAdd(true);\r\n                        break;\r\n                    default:\r\n                    }\r\n                },\r\n                appear: function(action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function(action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n        } else {\r\n            if (bizagi.util.media.fileAPISupported()) {\r\n                this.$addImage.off(\"click\").click(function() {\r\n                    self.$inputFile.click();\r\n                });\r\n            } else {\r\n                this.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n                this.$addImage.removeClass(\"bz-plus\").addClass(\"bz-rn-read-only\");\r\n            }\r\n        }\r\n\r\n        // remove Image\r\n        this.$deleteImage.off(\"click\").click(function() { self.imageDelete(); });\r\n        // Image change (Hybrid only)\r\n        this.$inputFile.off(\"change\").on(\"change\", function() {\r\n            self.imageAdd();\r\n            this.value = \"\";\r\n        });\r\n\r\n        // Just in case\r\n        this.$inputFile.off(\"click\").on(\"click\", function(e) { e.stopPropagation(); });\r\n\r\n        // Resolution upload menu\r\n        // If android version is less than 4.4 avoid to show upload sizes due to compatibility with blob files\r\n        if (version && version <= 4.4) {\r\n            resolutionUpload = [\r\n                { \"guid\": 4, \"displayName\": bizagi.localization.getResource(\"workportal-size-original\") }\r\n            ];\r\n        } else {\r\n            resolutionUpload = bizagi.util.media.getImageResolutionItems();\r\n        }\r\n\r\n        $(\".bz-resolution-container\", self.getControl()).off(\"click\").actionSheet({\r\n            actions: resolutionUpload,\r\n            actionClicked: function(action) {\r\n                bizagi.loading.start();\r\n                $.when(self.resolutionButtonHandler(action.guid))\r\n                    .always(function() {\r\n                        bizagi.loading.stop();\r\n                    });\r\n            },\r\n            appear: function(action) {\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            cancelClicked: function(action) {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n    },\r\n\r\n    clearDisplayValue: function() {\r\n        this.$deleteImage.click();\r\n    },\r\n\r\n    /**\r\n     * Add an image\r\n     * @param useCamera boolean Whether or not to use device's camera\r\n     */\r\n    imageAdd: function(useCamera) {\r\n\r\n        var self = this;\r\n\r\n        if (!this.isNative) {\r\n            var dataFile = this.$inputFile[0].files[0];\r\n            dataFile.fullPath = this.$inputFile[0].value;\r\n            var extensions = this.Class.EXTENSIONSIMG;\r\n\r\n            bizagi.loading.start();\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media\r\n                .checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.uploadFile(dataFile)).done(function(result) {\r\n                    self.uploadFileCompleted(self);\r\n                }).fail(function(error) {\r\n                    self.executeFormFailHandler(error);\r\n                }).always(function() {\r\n                    bizagi.loading.stop();\r\n                });\r\n\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n        } else {\r\n\r\n            var options = {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                targetWidth: 1280,\r\n                targetHeight: 960,\r\n                correctOrientation: true\r\n            };\r\n\r\n            if (!useCamera) {\r\n                var coordinates = self.getControl()[0].getBoundingClientRect();\r\n                //noinspection JSUnresolvedVariable,JSUnresolvedFunction\r\n                options = {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    popoverOptions: new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4),\r\n                    destinationType: navigator.camera.DestinationType.FILE_URI,\r\n                    correctOrientation: true\r\n                };\r\n            }\r\n\r\n            //noinspection JSUnresolvedFunction,JSUnresolvedVariable\r\n            navigator.camera.getPicture(function(dataImage) {\r\n\r\n                bizagi.loading.start();\r\n\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function() {\r\n                    return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function(fileData) {\r\n                        if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\r\n                            self.dataImage = dataImage;\r\n                            self.fileProperties = fileData;\r\n                            // \"new Blob\" constructor is not supported in android version 4.2.2\r\n                            var version = bizagi.util.getAndroidVersion();\r\n                            if ((version && version <= 4.2) || self.isOfflineForm) {\r\n                                return $.when(self.uploadFile(self.dataImage)).done(function(result) {\r\n                                    self.uploadFileCompleted(self);\r\n                                }).fail(function(error) {\r\n                                    self.executeFormFailHandler(error);\r\n                                }).always(function() {\r\n                                    bizagi.loading.stop();\r\n                                });\r\n\r\n                            } else {\r\n\r\n                                if (!bizagi.util.isAndroid()) {\r\n                                    return $.when(bizagi.util.media.modalResolutionUpload()).then(\r\n                                        function(buttonIndex) {\r\n                                            if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                return self.resolutionButtonHandler(buttonIndex);\r\n                                            }\r\n                                        });\r\n\r\n                                } else {\r\n                                    // force click to show actionsheet menu\r\n                                    $(\".bz-resolution-container\", self.getControl()).click();\r\n                                }\r\n\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                }).always(function() {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, options);\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * onFail\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    onFail: function(error) {\r\n        bizagi.util.smartphone.stopLoading();\r\n    },\r\n\r\n    /**\r\n     * Remove the current image\r\n     */\r\n    imageDelete: function() {\r\n        var self = this;\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function() {\r\n                bizagi.loading.start();\r\n                $.when(self.dataService.deleteImage({\r\n                    url: self.properties.deleteUrl,\r\n                    idRender: self.properties.id,\r\n                    xpath: self.properties.xpath,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: self.properties.idPageCache,\r\n                    contexttype: self.properties.contexttype\r\n                })).done(function() {\r\n                    self.uploadFileCompleted(self);\r\n                }).fail(function(msg) {\r\n                    var message;\r\n                    var responseText = msg.responseText;\r\n\r\n                    try {\r\n                        message = JSON.parse(responseText);\r\n                        message = message.message || responseText;\r\n                    } catch (e) {\r\n                        message = responseText;\r\n                    }\r\n                    bizagi.showMessageBox(message, \"Error\");\r\n\r\n                }).always(function() {\r\n                    bizagi.loading.stop();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function(dataFile) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (!this.isOfflineForm) {\r\n\r\n            // Fix android 4.4 getting images from recent folder\r\n            if (this.isNative) {\r\n\r\n                //noinspection JSUnresolvedFunction\r\n                var params = {};\r\n                var addParams = self.buildAddParams();\r\n                var fileName = self.fileProperties.name;;\r\n\r\n                if (self.editedImageURL) {\r\n                    params.dataFile = self.editedImageURL;\r\n                } else if (self.fileProperties) {\r\n                    params.dataFile = self.fileProperties.url;\r\n                }\r\n\r\n                addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n                params.data = addParams;\r\n                params.options = new FileUploadOptions();\r\n                params.options.fileKey = \"file\";\r\n                params.options.fileName = fileName;\r\n                params.options.mimeType = \"image/jpeg\";\r\n                params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n                params.options.addUrl = self.properties.addUrl;\r\n\r\n                //Cleans variables related previous uploads\r\n                self.editedImageURL = null;\r\n                self.fileProperties = null;\r\n\r\n                // Fix android 4.4 getting images from recent folder\r\n                params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n                $.when(bizagi.util.media.uploadFile(params)).done(function(r) {\r\n                    var response = JSON.parse(decodeURIComponent(r.response));\r\n                    if (response.type === \"error\") {\r\n                        defer.reject(response);\r\n                    } else {\r\n                        defer.resolve(response);\r\n                    }\r\n                }).fail(function(error) {\r\n                    defer.reject(error);\r\n                });\r\n            } else {\r\n\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, self.Class.EXTENSIONSIMG)) {\r\n\r\n                    self.dataService.processUploadFile({\r\n                        url: self.properties.addUrl,\r\n                        formData: self.buildAddFileParams(dataFile)\r\n                    }).done(function(response) {\r\n                        defer.resolve(response);\r\n                    }).fail(function(error) {\r\n                        defer.reject(error);\r\n                    });\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n            }\r\n        } else {\r\n            // Load image\r\n            self.saveImageOffline(self, dataFile, function(dataUrl) {\r\n                self.setValue(dataUrl);\r\n                defer.resolve();\r\n            });\r\n\r\n            // Enables canbesent on offline mode\r\n            self.canBeSent = function() {\r\n                return true;\r\n            };\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * File upload is done\r\n     * @param context\r\n     */\r\n    uploadFileCompleted: function(context) {\r\n        var self = context;\r\n\r\n        try {\r\n            self.showAsyncImage();\r\n            self.editedImageURL = null;\r\n        } catch (error) {\r\n            self.getFormContainer().refreshForm();\r\n        }\r\n    },\r\n    /**\r\n     * Show async image\r\n     * */\r\n    showAsyncImage: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        $.when(self.buildItemUrl()).done(function(dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = (dataUrl !== \"\") ? dataUrl : \"\";\r\n                self.properties.value = self.properties.url.length > 0 ? [self.properties.url] : null;\r\n                self.setValue(self.properties.value);\r\n\r\n                if (self.isOfflineForm && dataUrl.indexOf(\"Invalid case id\") !== -1) {\r\n                    self.properties.url = \"\";\r\n                }\r\n\r\n                control.find(\".bz-rn-image-container\").off(\"click\").toggleClass(\"bz-rn-image-actions-add\",\r\n                    self.properties.editable && self.properties.url === \"\");\r\n\r\n                if (self.properties.url !== \"\") {\r\n                    control.find(\".bz-rn-image-container img\").css(\"display\", \"inherit\")\r\n                        .attr(\"src\", self.properties.url);\r\n                    control.find(\".bz-rn-image-container img\").off(\"click\").click(function() { self.renderEdition(); });\r\n                    control.find(\".bz-rn-image-actions-add\").toggle(self.properties.editable);\r\n                    control.find(\".bz-rn-image-actions-delete\")\r\n                        .toggle(self.properties.allowDelete && self.properties.editable);\r\n                } else {\r\n                    control.find(\".bz-rn-image-container img\").css(\"display\", \"none\");\r\n                    control.find(\".bz-rn-image-actions-add.bz-upload\").hide();\r\n                    control.find(\".bz-rn-image-actions-delete\").hide();\r\n                }\r\n                self.configureHandlers();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param context\r\n     * @param url\r\n     * @param callback\r\n     */\r\n    saveImageOffline: function(context, url, callback) {\r\n        var control = this.getControl();\r\n        var image = new Image();\r\n\r\n        image.onload = function() {\r\n            var canvas = document.createElement(\"canvas\");\r\n            canvas.width = this.width;\r\n            canvas.height = this.height;\r\n\r\n            canvas.getContext(\"2d\").drawImage(this, 0, 0);\r\n\r\n            // Get raw image data\r\n            var dataUrl = canvas.toDataURL(\"image/png\");\r\n            callback(dataUrl.replace(/^data:image\\/(png|jpg|jpeg);base64,/, \"\"));\r\n        };\r\n\r\n        image.src = url;\r\n        control.find(\"img\").replaceWith(image);\r\n        control.find(\".bz-cm-icon.image-file\").replaceWith(image);\r\n    },\r\n\r\n    /**\r\n     * resolutionButtonHandler\r\n     * @param buttonOrdinal\r\n     */\r\n    resolutionButtonHandler: function(ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n\r\n            return $.when(self.uploadFile(self.dataImage)).done(function(result) {\r\n                self.uploadFileCompleted(self);\r\n            }).fail(function(error) {\r\n                self.executeFormFailHandler(error);\r\n            });\r\n\r\n        } else {\r\n\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution))\r\n                .then(function(result) {\r\n\r\n                    self.editedImageURL = result.localUrl;\r\n                    self.properties.url = result.base64Image;\r\n\r\n                    return $.when(self.uploadFile(self.dataImage))\r\n                        .done(function(result) {\r\n                            self.uploadFileCompleted(self);\r\n                        }).fail(function(error) {\r\n                            self.executeFormFailHandler(error);\r\n                        });\r\n\r\n                });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function(error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText\r\n            : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * Smartphone compatibility mode\r\n     */\r\n    postRenderSingle: function() {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        self.configureHandlers();\r\n        self.configureHelpText();\r\n\r\n        // Some compat for the smartphone weird behavior\r\n        if (!self.properties.editable) {\r\n            self.postRenderReadOnly();\r\n        }\r\n\r\n        self.showAsyncImage();\r\n    },\r\n\r\n    /**\r\n     * Render edition view\r\n     * @returns {}\r\n     */\r\n    renderEdition: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // TODO Creates a container, be careful you must destroy it later\r\n        var baseParams = self.getParams();\r\n        var container = baseParams.navigation.createRenderContainer(\r\n            {\r\n                title: properties.displayName,\r\n                view: {\r\n                    zoom: true,\r\n                    useNativeScrolling: false\r\n                }\r\n            }\r\n        );\r\n\r\n        var img = $.kendoTmpls(self.renderFactory.getTemplate(\"image-preview\"),\r\n            { \"url\": (self.value && self.value[0] !== \"\" ? self.value[0] : \"\") });\r\n        container.element.css(\"display\", \"none\");\r\n        self.inputEdition = container.element.html(img);\r\n        baseParams.navigation.navigate(container.id);\r\n\r\n        bizagi.loading.start();\r\n\r\n        //TODO review fail scenario, should it call the forms.failHandler method?\r\n        $.when(self.buildFullItemUrl()).done(function(dataUrl) {\r\n            container.element.css(\"display\", \"block\");\r\n\r\n            if (dataUrl.indexOf(\"error\") < 0) {\r\n                var $preview = $(\".bz-rn-image-render-preview:first\", container.element).attr(\"src\", dataUrl);\r\n                var originalImageWidth = $preview.css(\"width\");\r\n                originalImageWidth = Number(originalImageWidth.substring(0, originalImageWidth.length - 2));\r\n\r\n                if (self.properties.width !== -1 && self.properties.width < originalImageWidth) {\r\n                    $preview.css(\"width\", \"100%\");\r\n                }\r\n            }\r\n        }).always(function() {\r\n            bizagi.loading.stop();\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n    * Build add params to send to the server\r\n    * @param {} dataFile\r\n    * @returns {}\r\n    */\r\n    buildAddFileParams: function(dataFile) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", properties.xpath);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", properties.id);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", properties.xpathContext);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE, properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", \"savefile\");\r\n        formData.append(self.properties.xpath, dataFile);\r\n\r\n        if (properties.contexttype) {\r\n            formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n\r\n    },\r\n\r\n    /**\r\n     * postRenderEdition\r\n     */\r\n    postRenderEdit: function() {\r\n        //Override the super behavior and do nothing, it is ok to do this don't remove.\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet Render Form Link Extension\r\n *   Author: Oscar O\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.formLink.extend(\"bizagi.rendering.formLink\", {\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, {\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n        params.context = params.context || \"workflow\";\r\n        var paramsRender = $.extend({}, this._params, { \"proxyPrefix\": this.dataService.serviceLocator.proxyPrefix, \"context\": this.dataService.serviceLocator.context });\r\n        this.serviceLocator = new bizagi.render.services.context(paramsRender);\r\n    },\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        self.getArrowContainer().hide();\r\n\r\n        if (properties.displayType === \"value\") {\r\n            self.changeDisplayOption(properties.displayType);\r\n        }\r\n        self.originalElement = self.element;\r\n        properties.orgiginalDisplayType = properties.displayType;\r\n        properties.displayType = \"normal\";\r\n        self.input = self.element = control.find(\"a\");\r\n\r\n        self._sendRelation = self.submitEditRequest;\r\n        self._getData = self.dataService.getFormData;\r\n        self._isRefreshForm = false;\r\n        self._params = {\r\n            idRender: properties.id,\r\n            xpathContext: self.getFormLinkXpathContext(),\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            url: properties.editPage\r\n        };\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n        }\r\n    },\r\n\r\n    //para la grilla lo que se debe hacer es sobreescribir o crear los metodos params,sendrelation,getData\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.container = self.getParams().navigation.createRenderContainer({ title: properties.displayName });\r\n        self.inputEdition = self.container.element;\r\n\r\n        if(self.properties.hasentryrule) {\r\n            var form = self.getFormContainer();\r\n            $.when(form.saveForm()).done(function () {\r\n                self.resolveCheckpointRequest().done(function () {\r\n                    return self.openLinkRule(\"entryrule\");\r\n                }).fail(function (error) {\r\n                    bizagi.log(\"Error: \" + err.code);\r\n                });\r\n            });\r\n        } else {\r\n            return self.openLink();\r\n        }\r\n    },\r\n\r\n    openLink: function () {\r\n        var self = this;\r\n\r\n        //Renderiza de nuevo la forma, a travez de una promesa, asignandole el metodo Rollback en caso de cancelar la ultima transación\r\n        return $.when(self._sendRelation.apply(self)).done(function () {\r\n            bizagi.util.smartphone.startLoading();\r\n            $.when(self.paintFormLink()).done(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            }).fail(function () { //Executes Rollback action\r\n                bizagi.util.smartphone.startLoading();\r\n                self.rollbackForm();\r\n            }).always(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            });\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n    },\r\n\r\n    openLinkRule: function (property) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n                if (dataRuleResp.messages) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n                    form.validationController.showErrorMessage(message);\r\n                    def.reject();\r\n                } else {\r\n                    if (property === \"entryrule\") {\r\n                        self.openLink();\r\n                    }\r\n                }\r\n                def.resolve();\r\n            }).fail(function(){\r\n            def.reject();\r\n        })\r\n            .always(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type === \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                var form = self.getFormContainer();\r\n                form.validationController.showErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            // Add error messages\r\n            var form = self.getFormContainer();\r\n            form.validationController.showErrorMessage(jqXHR.message);\r\n\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * postRenderEdition\r\n     */\r\n    postRenderEdit: function () {\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    paintFormLink: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        $.extend(self._params, { \"proxyPrefix\": self.serviceLocator.proxyPrefix });\r\n\r\n        $.when(self._getData.call(self, self._params)).pipe(function (data) {\r\n            if (self._params.recordXPath) {\r\n                data.form.properties.recordXpath = self._params.recordXPath;\r\n            }\r\n\r\n            if (self._params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Grid\r\n            if (self._params.hasOwnProperty(\"withAddForm\") && self._params.withAddForm) {\r\n                if (!data.form.elements || (data.form.elements && data.form.elements.length === 0)) {\r\n                    self._params.hideSaveButton = true;\r\n                }\r\n            }\r\n\r\n            /**\r\n             * This creation of form on every action like refresh or save\r\n             * is driving nuts the listeners in native apps\r\n             */\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.getParams().navigation,\r\n                wiew_container: self.container\r\n            });\r\n\r\n            self.form.params = self.getFormContainer().getParams();\r\n\r\n            self.form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                        // This callback avoid to call the default processButton in the form\r\n                        callback: function(){\r\n                            // When the data is saved then\r\n                            return self.saveRecord().then(function() {\r\n                                self.container.destroy();\r\n                            }).fail(function(error){\r\n                                if (error && error.error_code && error.error_code == 1){\r\n                                    //if doesn't support commit, rollback, etc.\r\n                                    $.when(self.actionSave(error.data)).then(function(){\r\n                                        self.container.destroy();\r\n                                    });\r\n                                } else if (error && error.type == \"validationMessages\") {\r\n                                    self.form.addValidationMessage(error.messages);\r\n                                } else if(error && error.responseText) {\r\n                                    bizagi.showMessageBox(error.responseText || \"Error\", \"Error\");\r\n                                }\r\n                            });\r\n                        }\r\n                    }),\r\n                $.extend(\r\n                    self.form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            self.container.destroy();\r\n                            deferred.reject();\r\n                        }\r\n                    })\r\n            ];\r\n\r\n            $.extend(self.form, {\r\n                processButtons: function () {\r\n                    //not send information set in memory and save\r\n                    $.each(self.form.buttons, function (index, element) {\r\n                        switch (element[\"ordinal\"]) {\r\n                            case 1: //next button will behave as a cancel button\r\n                                $(self.form.getButtons()[index]).click(function () {\r\n                                    self.container.destroy();\r\n                                    deferred.reject();\r\n                                });\r\n\r\n                                self.form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n\r\n                                self.form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                self.form.buttons[index].action = \"back\";\r\n                                break;\r\n\r\n                            default:\r\n                                $(self.form.getButtons()[index]).click(function () {\r\n                                    if (self._params.hideSaveButton) {\r\n                                        $(self.form.getButtons()[index]).hide();\r\n                                    }\r\n\r\n                                    return self.saveRecord().then(function () {\r\n                                        self.container.destroy();\r\n                                    }).fail(function(error){\r\n                                        if (error && error.error_code && error.error_code == 1){\r\n                                            //if doesn't support commit, rollback, etc.\r\n                                            $.when(self.actionSave(error.data)).then(function(){\r\n                                                self.container.destroy();\r\n                                            });\r\n                                        }\r\n                                        else{\r\n                                            bizagi.showMessageBox(error.responseText || \"Error\", \"Error\");\r\n                                        }\r\n                                    });\r\n                                });\r\n                                break;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            return self.form.render();\r\n\r\n        }, function (message) {\r\n            // FAIL FILTER\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            $.kendoTmpls(errorTemplate, { message: message }).appendTo(self.inputEdition);\r\n\r\n            deferred.reject();\r\n        }).done(function (element) {\r\n            // Remove button container\r\n\r\n            self.inputEdition.html(element);\r\n            if (!self._isRefreshForm) {\r\n                self.getParams().navigation.navigate(self.container.id);\r\n            }\r\n            \r\n            self.container.setNavigationButtons(self.form);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function () {\r\n                //TODO the parent who call this class implement redraw. see smartphone.grid _InternalRenderLinkForm\r\n                self.inputEdition.empty();\r\n                self._isRefreshForm = true;\r\n\r\n                //Adds the events to capture the\r\n                $.when(self.paintFormLink()).done(function () { })\r\n                    .fail(function () {\r\n                        self.submitRollbackRequest();\r\n                    });\r\n            });\r\n\r\n            //Binds the view close event, and send the RollBack\r\n            self.container.element.bind(\"close\", function(){\r\n                self.rollbackForm();\r\n            });\r\n\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    hideHeadersButtonEdit: function () {\r\n        var self = this;\r\n        var context = self.getContextEdit();\r\n        var properties = self.properties;\r\n\r\n        if (properties.hideLabel) {\r\n            context.find(\".bz-cn-label\").hide();\r\n        }\r\n    },\r\n\r\n    setDisplayValueEdit: function () { },\r\n\r\n    /*\r\n     *\r\n     */\r\n    rollbackForm: function () {\r\n        var self = this;\r\n\r\n        $.when(self.submitRollbackRequest()).done(function () {\r\n            //Sends additional rollback request to delete checkpoint from entry rule\r\n            if (self.properties.hasentryrule) {\r\n                self.submitRollbackRequest();\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    saveRecord: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n        var properties = self.properties;\r\n\r\n        if (self.form.validateForm()) {\r\n            var data = {};\r\n            self.form.collectRenderValues(data);\r\n            // Add page cache for this form\r\n            data.idPageCache = self.form.getPageCache();\r\n\r\n            $.when(self.submitSaveRequest(data)).done(function (result) {\r\n                try {\r\n                    var executeSubmitOnChange = true;\r\n                    if (result && result.type == \"validationMessages\") {\r\n                        executeSubmitOnChange = false;\r\n                        deferred.reject(result);\r\n                    }\r\n                    if (properties.hasexitrule) {\r\n                        self.closeExitRule().done(function () {\r\n                            if (executeSubmitOnChange) {\r\n                                self.resolveSubmitCommitRequest().then(function () {\r\n                                    self.submitOnChange({}).then(function(){\r\n                                        deferred.resolve(result);\r\n                                        if (properties.hasentryrule){\r\n                                            self.resolveSubmitCommitRequest();\r\n                                        }\r\n                                    });\r\n                                });\r\n                            } else {\r\n                                deferred.reject();\r\n                            }\r\n                        }).fail(function () {\r\n                            deferred.reject();\r\n                        });\r\n                    } else if (executeSubmitOnChange) {\r\n                        self.resolveSubmitCommitRequest().then( function() {\r\n                            if (properties.hasentryrule) {\r\n                                self.resolveSubmitCommitRequest().done( function() {\r\n                                    self.submitOnChange({}).then(function(){\r\n                                        deferred.resolve(result);\r\n                                    });\r\n                                });\r\n                            } else {\r\n                                self.submitOnChange({}).then(function(){\r\n                                    deferred.resolve(result);\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        deferred.reject();\r\n                    }\r\n                } catch (ex) {\r\n                    deferred.reject();\r\n                }\r\n            }).fail( function(error) {\r\n                var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n                if (err.code == \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1\r\n                    && err.message.indexOf(\"was not found\") !== -1){\r\n                    deferred.reject({error_code: 1, data: data});\r\n                } else {\r\n                    deferred.reject(error);\r\n                }\r\n            });\r\n        } else {\r\n            deferred.reject();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (properties.editable === false && !properties.value) {\r\n            return null;\r\n        }\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n\r\n        //saveGridRecord\r\n        return self.dataService.saveGridRecord({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext === undefined || properties.xpathContext === \"\" ? xpath : (xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext),\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    resolveSubmitCommitRequest: function () {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        self.submitCommitRequest().done(function () {\r\n            def.resolve();\r\n        }).fail(function(error) {\r\n            var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n            if (err.code == \"UNKNOWN_ERROR\") {\r\n                def.resolve();\r\n            } else {\r\n                def.reject();\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    resolveCheckpointRequest: function () {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        self.submitCheckpointRequest().done(function () {\r\n            def.resolve();\r\n        }).fail(function(error) {\r\n            var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n            if (err.code == \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1\r\n                && err.message.indexOf(\"was not found\") !== -1) {\r\n                def.resolve();\r\n            } else {\r\n                def.reject();\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    closeExitRule: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.hasexitrule) {\r\n            $.when(self.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function(){\r\n                def.reject();\r\n            });\r\n        } else {\r\n            def.resolve();\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var self = this;\r\n        var xpathContext = self.properties.xpathContext;\r\n        var parentXpathContext = self.getXpathContext();\r\n        if (parentXpathContext && xpathContext) {\r\n            if (xpathContext.indexOf(parentXpathContext) === 0) {\r\n                return xpathContext;\r\n            } else {\r\n                return parentXpathContext + \".\" + xpathContext;\r\n            }\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    }\r\n});","/**\r\n*   Name: Bizagi Render Geolocation control\r\n*   Author: Ricardo Perez\r\n*   Comments:\r\n*   -   This script will define basic stuff for form link renders\r\n*/\r\n\r\nbizagi.rendering.geolocation.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n\r\n        container.addClass(\"bz-rn-non-editable\");\r\n\r\n        self.cordinate = $(\".bz-rn-geolocation-coordinate\", control);\r\n    },\r\n\r\n    /**\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"geolocation\");\r\n        return $.kendoTmpl(template, self.properties);\r\n    },\r\n\r\n    /**\r\n    * Template method to implement in each device to customize each render after processed \r\n    */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n\r\n        // Call base \r\n        self._super();\r\n        self.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers \r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.getMode() === \"execution\" && self.properties.editable) {\r\n\r\n            //If the control doesn't have a value set the position\r\n            if (self.value == null)\r\n                self.updateDisplayValue();\r\n\r\n            $(\".bz-rn-geolocation-selector\", self.getControl()).on(\"click\", function () {\r\n                self.cordinate.empty();\r\n\r\n                // This retun a promise if is usefull\r\n                self.updateDisplayValue();\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control \r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            if (!self.cordinate)\r\n                self.cordinate = self.getControl();\r\n\r\n            self.cordinate.html(value);\r\n\r\n            // Set internal value \r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n\r\n            var onSuccess = function (position) {\r\n                var latitude = position.coords.latitude.toString();\r\n                var longitude = position.coords.longitude.toString();\r\n                var cordinate = latitude + \" \" + longitude;\r\n\r\n                self.cordinate.html(cordinate);\r\n\r\n                // Set internal value \r\n                self.setValue(cordinate, false);\r\n                def.resolve();\r\n            };\r\n\r\n            // onError Callback receives a PositionError object\r\n            var onError = function (message) {\r\n                var strMessage = message;\r\n\r\n                if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                    strMessage = self.getErrorMessage(message)\r\n                }\r\n\r\n                def.reject(strMessage);\r\n            };\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                navigator.geolocation.getCurrentPosition(onSuccess, onError);\r\n            } else {\r\n                self.getCurrentPosition(onSuccess, onError);\r\n            }\r\n\r\n        }\r\n\r\n        return def.promise();\r\n\r\n    },\r\n\r\n    updateDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.setDisplayValue().then(function () { }).fail(function (message) {\r\n            self.cordinate.val(\"\");\r\n            self.cordinate.html(\"<span style='color: red'>\" + message + \"</span>\");\r\n        });\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Smartphone Render Association\r\n *   Author: RicharU (based on Edward Morales)\r\n *   Comments: Defines the association control\r\n */\r\n\r\nbizagi.rendering.association.extend('bizagi.rendering.association', {}, {\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * \r\n     * @returns {} \r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation()).done(function (flip) {\r\n            // Make json base, create self.properties.formatJson\r\n            self.makeJsonBase();\r\n\r\n            self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n            var columnData = self.getColumnData();\r\n\r\n            var html = $.kendoTmpl(template, $.extend(self.properties, { columnData: columnData }), {\r\n                getColumnData: self.getColumnData,\r\n                getRightAssociation: self.getRightAssociation\r\n            });\r\n\r\n            /* by default need set self.properties.formatJson */\r\n            self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n            def.resolve(html);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /**\r\n     * Get Left Data, verify if flipper flags sets true\r\n     *\r\n     * @param column {'0'||'1'}\r\n     */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = [];\r\n\r\n        self.data = properties;\r\n\r\n        var dataAssociation = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(dataAssociation, function (key, item) {\r\n            data.push({\r\n                id: item.id,\r\n                value: item.value,\r\n                association: self.getRightAssociation(item.id)\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Cache control\r\n        self.association = $(\".bz-rn-association-control\", control);\r\n        self.getArrowContainer().css(\"visibility\", \"hidden\");\r\n        self.getArrowContainer().hide();\r\n\r\n        // Add Events at Association Control\r\n        self.addEventControl();\r\n\r\n        if (!self.properties.editable) {\r\n            self.association.find(\"input:checkbox\").hide();\r\n            self.association.find(\".ui-bz-rn-check-item label\").addClass(\"bz-rn-association-non-editable\");\r\n        }\r\n\r\n        self.showDefaultContainer();\r\n    },\r\n\r\n    showDefaultContainer: function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var associations = $('.bz-rn-association-group-container .bz-rn-association-header', control);\r\n\r\n        if(associations.length > 0){\r\n            var defaultHeader = $($('.bz-rn-association-group-container .bz-rn-association-header', control)[0]);\r\n            var defaultContainer = $($('.bz-rn-association-group-container .bz-rn-association-items', control)[0]);\r\n\r\n            self.closeAccordionSection(true);\r\n            defaultHeader.addClass('active');\r\n            defaultContainer.slideDown(300).addClass('open');\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Add event to control\r\n     * @returns {} \r\n     */\r\n    addEventControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Bind check toggle\r\n        self.association.delegate(\"input:checkbox\", \"change\", function () {\r\n            var contextElement = $(this);\r\n\r\n            if (contextElement.prop(\"checked\")) {\r\n                // Associate item\r\n                contextElement.addClass(\"bz-check\");\r\n                self.associateElement(contextElement);\r\n            } else {\r\n                // Dissociate item\r\n                contextElement.removeClass(\"bz-check\");\r\n                self.dissociateElement(contextElement);\r\n            }\r\n        });\r\n\r\n        // Bind flip actions\r\n        self.association.delegate(\".bz-rn-association-flip-button\", \"click\", function () {\r\n            $(control).empty();\r\n\r\n            // Define flipped\r\n            self.properties.flipped = !self.properties.flipped;\r\n\r\n            // Send flip data to server\r\n            self.properties.flipstate = self.properties.flipped;\r\n\r\n            self.dataService.getFlipAssociation(self.properties);\r\n\r\n            var columnData = self.getColumnData();\r\n\r\n            // Render template\r\n            $.kendoTmpls(template, $.extend(self.properties, { columnData: columnData }), {\r\n                getColumnData: self.getColumnData,\r\n                getRightAssociation: self.getRightAssociation\r\n            }).appendTo(control);\r\n\r\n            self.postRenderSingle();\r\n        });\r\n\r\n        self.association.delegate(\".bz-rn-association-container .bz-rn-association-header\", \"click\", function(){\r\n            if(!$(this).is('.active')) {\r\n                self.closeAccordionSection();\r\n                $(this).addClass('active');\r\n                $(this).siblings().slideDown(300).addClass('open');\r\n            }\r\n        });\r\n    },\r\n\r\n    closeAccordionSection: function(active){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var headers = $('.bz-rn-association-group-container .bz-rn-association-header', control);\r\n        var contents = $('.bz-rn-association-group-container .bz-rn-association-items', control);\r\n\r\n        if(active){\r\n            headers = headers.not(':first').removeClass('active');\r\n            contents = contents.not(':first').slideUp(300).removeClass('open');\r\n        }\r\n\r\n        headers.removeClass('active');\r\n        contents.slideUp(300).removeClass('open');\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        return self.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Render for readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var columnData = self.getColumnData();\r\n\r\n        // Render template  \r\n        $.kendoTmpls(template, $.extend(self.properties, { columnData: columnData }), {\r\n            getColumnData: self.getColumnData,\r\n            getRightAssociation: self.getRightAssociation\r\n        }).appendTo(control);\r\n\r\n        // Cache control\r\n        self.association = $(\".bz-rn-association-control\", control);\r\n        self.getArrowContainer().css(\"visibility\", \"hidden\");\r\n\r\n        // Bind event for flip botton\r\n        self.association.delegate(\".bz-rn-association-flip-button\", \"click\", function () {\r\n            $(control).empty();\r\n            // Define flipped\r\n            self.properties.flipped = !self.properties.flipped;\r\n\r\n            self.postRenderReadOnly();\r\n        });\r\n    },\r\n    /**\r\n     * Associate the left item with the active parent\r\n     * @param {} element \r\n     * @returns {} \r\n     */\r\n    associateElement: function (element) {\r\n        var self = this;\r\n        var context = self.getControl();\r\n\r\n        // Get the parent id\r\n        var parentId = $(element.parents(\"ul\"), context).data(\"parent-id\");\r\n        var itemAdd = element.data(\"id\");\r\n\r\n        // Update JSON object\r\n        self.addElement(parentId, itemAdd);\r\n    },\r\n\r\n    /**\r\n     * Dissociates an item from the active collection\r\n     * @param {} element \r\n     * @returns {} \r\n     */\r\n    dissociateElement: function (element) {\r\n        var self = this;\r\n        var context = self.getControl();\r\n\r\n        // Get the parent id\r\n        var parentId = $(element.parents(\"ul\"), context).data(\"parent-id\");\r\n        var itemRemove = element.data(\"id\");\r\n\r\n        // Update JSON object\r\n        self.removeElement(parentId, itemRemove);\r\n    },\r\n\r\n    /* SET-DISPLAY-VALUE\r\n     =====================================================*/\r\n    setDisplayValue: function (value) {        \r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    }\r\n});","/*\r\n*   Name: BizAgi User Field render tablet Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will define the basic behaviour for userfields    \r\n*/\r\n\r\n// Auto-extension\r\nbizagi.rendering.basicUserField.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n    renderSingle: function () {\r\n        var self = this;\r\n\r\n        // Hide arrow\r\n        $(\".ui-bizagi-render-edition-arrow\", self.getControl().parent()).hide();\r\n\r\n        return self.postRender();\r\n\r\n    },\r\n\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        $.when(self.postRender()).done(function () {\r\n            $.when(self.renderUserfieldControl()).done(function () {\r\n                self.inputEdition = self.input;\r\n                defer.resolve();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getEditableControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getEditableControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getReadonlyControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n    isSupported: function () {\r\n        return true;\r\n    }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.basicUserField.extend(\"bizagi.rendering.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n        var properties = self.properties;\r\n        var controlName = properties.control.replace(/column/g, \"\");\r\n\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n        self.input.addClass(\"ui-bizagi-render-userfield-notSupported\");\r\n        container.addClass(\"bz-rn-non-editable\");\r\n\r\n        return self.input;\r\n    },\r\n\r\n    /*\r\n    *  Dont send the data to the server\r\n    */\r\n    collectData: function(renderValues) {\r\n    },\r\n\r\n    getDisplayValue: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n\r\n        return \"Userfield: \" + controlName + \" not found\";\r\n    },\r\n\r\n    getReadonlyControl: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n\r\n        return mycontrol;\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated && decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n            decorated.properties.displayType = \"normal\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function() {\r\n        var self = this;\r\n        var result = this._super();\r\n\r\n        if (!result || result.length === 0) {\r\n            var selector = bizagi.util.isMobileGridEnabled() ? \".bz-rn-grid-cell-readonly\" : \".ui-bizagi-cell-readonly\";\r\n            result = $(selector, self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        element = $(element);\r\n\r\n        // Set cell alignment\r\n        element.css(\"-webkit-box-pack\", properties.align);\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    },\r\n    /*\r\n*   Post process the element after it has been rendered\r\n*/\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base        \r\n        this._super(surrogateKey, cell);\r\n\r\n        // Just draw render if the cell layout has been filled\r\n        if (cell && cell.length > 0) {\r\n            var cellIcon;\r\n\r\n            if (bizagi.util.isMobileGridEnabled()) {\r\n                cellIcon = $(\".bz-mo-icon\", cell);\r\n                if ($(self.element).hasClass(\"bz-command-edit-inline\")) {\r\n                    $(self.element).toggleClass(\"bz-command-edit-inline\");\r\n                }\r\n\r\n                if (!properties.editable) {\r\n                    cellIcon.removeClass(\"bz-mo-icon\");\r\n                    cellIcon.removeClass(\"bz-coin-input bz-number-icon bz-calendar-input\");\r\n                }\r\n            } else {\r\n                cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n                if (properties.align == \"left\") {\r\n                    cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n                }\r\n\r\n                if (!properties.editable) {\r\n                    cellIcon.detach();\r\n                }\r\n            }\r\n\r\n            // Apply styles to cell\r\n            self.applyColumnStyles(cell);\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n\r\n    applyOverrides: function (decorated) {\r\n        // Hacks the getControl method in the decorated render to add features\r\n        var self = this;\r\n        self._super(decorated);\r\n        if (decorated && decorated.getControl) {\r\n            self.originalGetControl = decorated.getControl;\r\n            decorated.getControl = self.getControl;\r\n            decorated.properties.displayType = \"normal\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = self._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Render Document Generator Extension\r\n*   Author: Mauricio Gonzalez\r\n*   Comments:\r\n*   -   This script will redefine the document generator render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.document\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        decorated.getControlHtml = self.getControlHtml;\r\n\r\n        if (mode != \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates the event of generation of templates.\r\n    */\r\n    documentTemplateGenerate: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.startLoading();\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        var grid = self.parent;\r\n\r\n        $.when(grid.submitOnChange(\"\", false))\r\n            .done(function() {\r\n                $.when(self.dataService.generateDocumentTemplate(properties))\r\n                    .done(function(response) {\r\n                        $.when(grid.refresh())\r\n                            .done(function() {\r\n                                self.autoOpenDocuments();\r\n                            });\r\n\r\n                        self.endLoading();\r\n                    }).fail(function() {\r\n                        self.showErrorMessage();\r\n                        self.endLoading();\r\n                    });\r\n            }).fail(function(message) {\r\n                // Add error messages \r\n                self.getFormContainer().addErrorMessage(message);\r\n                self.endLoading();\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    getControlHtml: function(template, mode, downloadalldocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n        var isInlineRow = true;\r\n\r\n        for (var i = 0; i < self.parent.properties.data.rows.length; i++) {\r\n            if (self.parent.properties.data.rows[i][0] == self.surrogateKey) {\r\n                isInlineRow = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            noActivateButton: isInlineRow,\r\n            editable: mode != \"execution\",\r\n            downloadalldocuments: downloadalldocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append ? properties.append : false,\r\n            caption: properties.caption,\r\n            noFiles: noFiles\r\n        });\r\n\r\n        return html.replace(\"ui-bizagi-document-upload-item-design\", \"ui-bizagi-document-upload-item-design-column\");\r\n    },\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    getXpath: function(xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getDocumentXpath: function(xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function(surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getContextXpath: function() {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi tablet Date Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.date\", {}, {\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated) {\r\n            decorated.showTime = false;\r\n\r\n            if (mode === \"execution\") {\r\n                decorated.changeMinValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {                        \r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)                            \r\n                            dateControl.mobiscroll('option', { min: calculateValue }); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.minValue = value; // Invarian date   \r\n                        decorated.properties.minValue = calculateValue;\r\n                    }\r\n                };\r\n\r\n                decorated.changeMaxValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {\r\n\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.mobiscroll('option', { max: calculateValue }); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.maxValue = value; // Invarian date       \r\n                        decorated.properties.maxValue = calculateValue;\r\n                    }\r\n                };\r\n            }\r\n        }\r\n    },\r\n\r\n    resolveValue: function(context, value) {\r\n        var result = \"\";\r\n\r\n        if (bizagi.util.isString(value) || bizagi.util.isNumeric(value)) {\r\n            result = value;\r\n        }\r\n\r\n        if (bizagi.util.isArray(value)) {\r\n            var indexes = context.grid.getIndexes();\r\n            var surrogateKey = context.surrogateKey;\r\n            var index = indexes.indexOf(surrogateKey);\r\n            if (index !== -1) {\r\n                result = value[index];\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.text\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    }\r\n\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Number Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.number\", {}, {\r\n    \r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi smartphone Column Decorator Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.image\", {}, {\r\n\r\n    applyOverrides: function(decorated) {\r\n        var properties = this.properties;\r\n        this._super(decorated);\r\n\r\n        decorated.getXpathContext = this.getImageXpathContext;\r\n\r\n        decorated.setDisplayValue = function () {\r\n            return true;\r\n        };\r\n\r\n        // Change xpath context\r\n        // Taken from desktop version to fix non existence of \"xpathContext\" property\r\n        if ( this.getMode() === \"execution\") {\r\n            decorated.properties.xpathContext = ( properties.xpathContext ? properties.xpathContext + \".\" : \"\" ) + this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        }\r\n    },\r\n\r\n    getImageXpathContext: function () {\r\n        return ( this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" : \"\" ) + this.column.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi smartphone Text Column Decorator Extension\r\n*   Author: OscarO\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to smartphones devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.upload\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n        var self = this,\r\n            mode = self.getMode();\r\n\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n\r\n            decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n            decorated.getXpathContext = function () {\r\n\r\n                var surrogateKey = this.surrogateKey || \"\",\r\n                    properties = self.properties,\r\n                    columnXpath = self.getUploadXpath(decorated),\r\n                    columnXpathSplit = columnXpath.split(\".\"),\r\n                    nameFile = columnXpathSplit[columnXpathSplit.length - 1],\r\n                    xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n\r\n                return { xpathContext: xpathContext, nameFile: nameFile };\r\n            };\r\n\r\n\r\n\r\n            decorated.buildItemUrl = function (file) {\r\n                var selfIntern = this;\r\n                var properties = selfIntern.properties;\r\n\r\n                var form = selfIntern.getFormContainer();\r\n                var context = selfIntern.getXpathContext();\r\n\r\n                return selfIntern.dataService.getUploadFileUrl({\r\n                    idRender: properties.id,\r\n                    xpath: context.nameFile,\r\n                    xpathContext: context.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: properties.contexttype\r\n                });\r\n            };\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function (decorated) {\r\n        return (decorated || this).grid.properties.xpath + \"[id=\" + (decorated || this).surrogateKey + \"].\" + (decorated || this).properties.xpath;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet Link Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the link column decorator class to adjust to tablet devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.link\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        var self = this,\r\n            mode = self.getMode();\r\n\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n            decorated.getXpath = this.getXpath;\r\n\r\n            decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) == -1)\r\n                decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n\r\n        }\r\n        if (decorated.properties.type == \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath,\r\n            index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /*\r\n     *   Get Form Link xpath to use\r\n     */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath){\r\n            return;\r\n        }\r\n        return this.properties.xpath;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.search.extend(\"bizagi.rendering.columns.search\", {}, {\r\n\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    },\r\n\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        if (value.length > 0) {\r\n            value = [].concat(value[0]);\r\n            return self._super(surrogateKey, {\r\n                id: value[0],\r\n                label: value[1],\r\n                additionallabel: value[2] || undefined\r\n            });\r\n        }\r\n        else {\r\n            return self._super(surrogateKey, value);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop ECM Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.uploadecm\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        decorated.getXpathContext = this.getECMXpathContext;\r\n\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.buildItemUrl = function (file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n\r\n            var form = self.getFormContainer();\r\n\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.buildAddParams = function () {\r\n            var properties = this.properties,\r\n                form = this.getFormContainer();\r\n\r\n            return {\r\n                url: properties.addUrl,\r\n                h_xpath: properties.xpath,\r\n                idAttrib: properties.idAttrib,\r\n                xpathContext: this.getXpathContext(this.surrogateKey),\r\n                xPath: properties.xpath,\r\n                p_sessionId: form.properties.sessionId,\r\n                h_contexttype: \"entity\",\r\n                h_pageCacheId: properties.idPageCache\r\n            };\r\n\r\n        };\r\n\r\n    },\r\n \r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n   \r\n    getUploadXpath: function (surrogateKey) {\r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        return this.grid.properties.xpath + \"[id=\" + surrogateKey + \"].\" + this.properties.xpath;\r\n    },\r\n\r\n\r\n    getECMXpathContext: function () {\r\n        return ( this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" : \"\" ) + this.column.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    }\r\n});\r\n","/**\r\n* Grid control Column Button\r\n*\r\n* @author Ricardo Pérez\r\n*/\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.button\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    }\r\n});","/*\r\n *   Name: Bizagi Column Rendering Smartphone numberScientificNotation\r\n *   Author: Luis Cabarique - LuisCE\r\n *   Comments:\r\n *   -   This script will define a base class to define the Column Scientific number notation\r\n */\r\n\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.numberScientificNotation\", {}, {\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Smartphone Radio Column Decorator Extension\r\n*   Author: Richar Urbano\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.radio\", {}, {\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: RicharU\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.list\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi tablet Date Column Decorator Extension\r\n*   Author: RicharU\r\n*   Comments:\r\n*   -   This script will redefine the check column to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.exclusiveCheck\", {}, {\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n\r\n        var self = this;\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n\r\n        var mode = self.getMode();\r\n\r\n        if (self.grid.exclusiveChanges[self.properties.xpath]) {\r\n            if (self.grid.exclusiveChanges[self.properties.xpath].key === surrogateKey) {\r\n                self.setValue(surrogateKey, self.grid.exclusiveChanges[self.properties.xpath].value);\r\n            }\r\n            else {\r\n                self.setValue(surrogateKey, false);\r\n            }\r\n        }\r\n        else {\r\n            var enabledChecks = self.grid.enabledChecks[self.properties.xpath];\r\n            self.setValue(surrogateKey, value);\r\n        }\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        if (!properties.editable)\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n            var lastKey = self.grid.exclusiveChanges[self.properties.xpath] ? self.grid.exclusiveChanges[self.properties.xpath].key : -1;\r\n            if (lastKey !== surrogateKey) {\r\n                var simpleXpathArray = self.properties.xpath.split(\".\");\r\n                self.grid.exclusiveChanges[self.properties.xpath] = {\r\n                    xpath: self.properties.xpath,\r\n                    simpleXpath: simpleXpathArray[simpleXpathArray.length - 1],\r\n                    value: self.getValue(surrogateKey),\r\n                    key: surrogateKey\r\n                };\r\n                self.clearOtherRows(surrogateKey, value);\r\n            }\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        \r\n        this._super(surrogateKey, cell);\r\n/*\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show a disabled check box\r\n                control.html('<input type=\"checkbox\" name=\"exclusiveCheck\" title=\"' + bizagi.localization.getResource('render-grid-column-button-mandatory-key') + '\" disabled=\"disabled\" style=\"width:16.5px;height:16.5px;\">');\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }*/\r\n    },\r\n\r\n    clearOtherRows: function (surrogateKey, value) {\r\n        var self = this;\r\n        for (var j = 0, rowsNumber = self.grid.properties.data.rows.length; j < rowsNumber; j++) {\r\n            var rowIndex = self.grid.properties.data.rows[j][0];\r\n            if (rowIndex !== surrogateKey) {\r\n                var decorated = self.getDecorated(rowIndex);\r\n                decorated.setDisplayValue(false);\r\n                self.setValue(rowIndex, false);\r\n            }\r\n        }\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Smartphone Render Document Generator Extension\r\n *   Author: Dario Estupiñan\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.document.extend(\"bizagi.rendering.document\", {}, {\r\n    /*\r\n    * Put formating to the documents that are generated by the control\r\n    */\r\n    applyDocumentTemplatesFormat: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.getArrowContainer().hide();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n\r\n        // Resolve the type of the document based on the extension and put the icon to acconding to it\r\n        var documentList = $(\".ui-bizagi-document-upload-item\", control);\r\n\r\n        $.each(documentList, function (index, value) {\r\n            $(\".ui-bizagi-document-type\", value).addClass(\"ui-bizagi-document-extension\");\r\n\r\n            // add the tooltip to the document preview icon        \r\n            var previewTooltip = $(\".ui-bizagi-document-preview\", value);\r\n            previewTooltip.attr(\"title\", self.resources.getResource('render-document-preview-tooltip'));\r\n            previewTooltip.tooltip();\r\n\r\n            // Add file extension\r\n            var returnType = self.returnCssTypeFile($(\"span > span\", value).html());\r\n            $(\".ui-bizagi-document-type\", value).addClass(returnType);\r\n\r\n            // Disable preview\r\n            $(\".ui-bizagi-button\", value).remove();\r\n            $(\".ui-bizagi-document-preview\", value).attr(\"display\", \"none\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Identifies the extension of the file in a simpler way that ECM does\r\n     * @param {} file \r\n     * @returns {} \r\n     */\r\n    returnCssTypeFile: function (file) {\r\n\r\n        if (file == undefined || file.lenght === 0) {\r\n            return \"ui-bizagi-document-upload-item-generic-file bz-file-text\";\r\n        }\r\n\r\n        var extension = file.substr((file.lastIndexOf(\".\") + 1));\r\n\r\n        switch (extension) {\r\n            case \"docx\":\r\n                return \"ui-bizagi-document-upload-item-doc bz-file-word\";\r\n            case \"pdf\":\r\n                return \"ui-bizagi-document-upload-item-pdf bz-file-pdf\";\r\n            case \"xlsx\":\r\n                return \"ui-bizagi-document-upload-item-xls bz-file-excel\";\r\n            default:\r\n                return \"ui-bizagi-document-upload-item-generic-file bz-file-text\";\r\n        }\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        self.configureHelpText();\r\n        self.applyDocumentTemplatesFormat();\r\n        self.configureHandlers();\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n        }\r\n    },\r\n    /*\r\n    * Template method to implement in each device to customize the render's\r\n    * behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        // Attach handler\r\n        var generateLink = $(\".ui-bizagi-button-documentgenerator\", control);\r\n        if (mode == \"execution\") {\r\n            generateLink.click(function (e) {\r\n                if (e.isPropagationStopped())\r\n                    return;\r\n                e.stopPropagation();\r\n\r\n                self.properties.buttonExecuted = true;\r\n\r\n                if (self.properties.validate) {\r\n                    // Check if the form is valid, then generate\r\n                    var isValid = self.validateContainer();\r\n                    if (isValid) {\r\n                        self.documentTemplateGenerate();\r\n                    }\r\n                } else {\r\n                    // Just generate the form\r\n                    self.documentTemplateGenerate();\r\n                }\r\n\r\n                self.properties.buttonExecuted = false;\r\n            });\r\n        }\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-document-upload-item > .ui-bizagi-document-upload-element\", control).click(function (e) {\r\n            self.showDocumentPreview($(this).data(\"url\"), $(this).attr(\"title\"));\r\n        });\r\n\r\n        // Configure delete handler\r\n        $(\".bz-rn-document-delete-icon\", control).click(function (e) {\r\n            if (e.isPropagationStopped())\r\n                return;\r\n            e.stopPropagation();\r\n\r\n            self.deleteDocumentTemplate($(this).parent().data(\"filename\"));\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Redraw documents when needed\r\n    */\r\n    redrawDocuments: function (documents, noFiles, downloadalldocuments) {\r\n        var self = this;\r\n\r\n        self._super(documents, noFiles, downloadalldocuments);\r\n        // Add icons\r\n        self.applyDocumentTemplatesFormat();\r\n    },\r\n\r\n    /*\r\n    * Shows the document if the flag is set.\r\n    */\r\n    autoOpenDocuments: function () {\r\n    },\r\n\r\n    updateControlForPrintMode: function () {\r\n    },\r\n\r\n    showDocumentPreview: function(url, title) {\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.downloadFile(url, title)).fail(function (error) {\r\n            if (error.responseText){\r\n                self.getFormContainer().failHandler(error.responseText);\r\n            }\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    }\r\n});","/**\r\n * Smartphone definition of range date control\r\n *\r\n * @author: Ricardo Perez\r\n */\r\n\r\nbizagi.rendering.rangeDate.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        self.getArrow().hide();\r\n\r\n        self.defineRangeControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range money control\r\n *\r\n * @author: Andr�s Fernando Mu�oz\r\n */\r\n\r\nbizagi.rendering.rangeMoney.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRenderSingle: function() {\r\n        var self = this;\r\n        self.getArrow().hide();\r\n        self.defineRangeControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range number control\r\n *\r\n * @author: Andr�s Fernando Mu�oz\r\n */\r\n\r\nbizagi.rendering.rangeNumber.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRenderSingle: function() {\r\n\t\tvar self = this;\r\n        self.getArrow().hide();\r\n        self.defineRangeControl();\r\n\t}\r\n});","/*\r\n *   Name: Bizagi Base Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define an abstract render factory in order to do common stuff for all device factories\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.base.factory\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService) {\r\n        this.templates = {};\r\n        this.dataService = dataService;        \r\n    },\r\n\r\n    /**\r\n    * Load client resources in order to override a default behavior\r\n    */\r\n    loadOverrides: function () {\r\n    },\r\n    /*\r\n    *   This function will load asynchronous stuff needed in the module\r\n    */\r\n    initAsyncStuff: function() {\r\n        return $.when.apply($, [this.loadOverrides(), this.loadTemplates()]);\r\n    },\r\n    /*\r\n    *   Load all the templates used for rendering\r\n    */\r\n    loadTemplates: function () {\r\n    },\r\n    /*\r\n    *   Load one template and save it internally\r\n    */\r\n    loadTemplate: function(template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return bizagi.templateService.getTemplate(templateDestination, template)\r\n                .done(function (resolvedTemplate) {\r\n                self.templates[template] = resolvedTemplate;\r\n            });\r\n    },\r\n    /*\r\n    * Returns a common  used template for the framework\r\n    */\r\n    getCommonTemplate: function (template) {        \r\n        return this.templates[template];\r\n    },\r\n    /*\r\n    *   Returns the appropiate container based on the container type\r\n    */\r\n    getContainer: function (params) {\r\n        // TODO: REMOVE IMPLEMENTATION\r\n\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.form(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type.toLowerCase() == \"nestedform\") {\r\n            return new bizagi.rendering.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.group(containerParams);\r\n        }\r\n\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.searchForm(containerParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate render based on the render type\r\n    */\r\n    getRender: function (params) {\r\n\r\n        // TODO: REMOVE IMPLEMENTATION\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type == \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(renderParams);\r\n        }\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        if (type == \"association\") {\r\n            return new bizagi.rendering.association(renderParams);\r\n        }\r\n\r\n        if (type == \"label\") {\r\n            return new bizagi.rendering.label(renderParams);\r\n        }\r\n\r\n        if (type == \"hidden\") {\r\n            return new bizagi.rendering.hidden(renderParams);\r\n        }\r\n\r\n        if (type == \"number\") {\r\n            return new bizagi.rendering.number(renderParams);\r\n        }\r\n\r\n        if (type == \"money\") {\r\n            return new bizagi.rendering.money(renderParams);\r\n        }\r\n\r\n        if (type == \"date\") {\r\n            return new bizagi.rendering.date(renderParams);\r\n        }\r\n\r\n        if (type == \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(renderParams);\r\n        }\r\n\r\n        if (type == \"combo\") {\r\n            return new bizagi.rendering.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"list\") {\r\n            return new bizagi.rendering.list(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"radio\") {\r\n            return new bizagi.rendering.radio(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            // Override for test purposes\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.ecm(renderParams);\r\n        }\r\n\r\n        if (type == \"upload\") {\r\n            return new bizagi.rendering.upload(renderParams);\r\n        }\r\n        if (type == \"grid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"groupedgrid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"search\") {\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"searchList\") {\r\n            return new bizagi.rendering.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"letter\") {\r\n            return new bizagi.rendering.letter(renderParams);\r\n        }\r\n\r\n        if (type == \"button\") {\r\n            return new bizagi.rendering.button(renderParams);\r\n        }\r\n\r\n        if (type == \"formLink\") {\r\n            return new bizagi.rendering.formLink(renderParams);\r\n        }\r\n\r\n        if (type == \"link\") {\r\n            return new bizagi.rendering.link(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutImage\") {\r\n            return new bizagi.rendering.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLink\") {\r\n            return new bizagi.rendering.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLabel\") {\r\n            return new bizagi.rendering.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutText\") {\r\n            return new bizagi.rendering.layoutText(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutDateTime\") {\r\n            return new bizagi.rendering.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutNumber\") {\r\n            return new bizagi.rendering.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutMoney\") {\r\n            return new bizagi.rendering.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type == \"actionLauncher\") {\r\n            return new bizagi.rendering.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutBoolean\") {\r\n            return new bizagi.rendering.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutUpload\") {\r\n            return new bizagi.rendering.layoutUpload(renderParams);\r\n        }\r\n\r\n        if (type == \"entityTemplate\") {\r\n            return new bizagi.rendering.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type == \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"userfield\") {\r\n            return new bizagi.rendering.userfieldWrapper(renderParams);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") == 0) {\r\n            return this.getSearchRender(params);\r\n        }\r\n\r\n        if (type.indexOf(\"query\") == 0) {\r\n            return this.getQueryRender(params);\r\n        }\r\n\r\n        if (type == \"document\") {\r\n            return new bizagi.rendering.document(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"fileprint\") {\r\n            return new bizagi.rendering.fileprint(renderParams);\r\n        }\r\n        if (type == \"geolocation\") {\r\n            return new bizagi.rendering.geolocation(renderParams);\r\n        }\r\n\r\n        if (type == \"collectionnavigator\") {\r\n            return new bizagi.rendering.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type == \"getUser\") {\r\n            return new bizagi.rendering.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeDate\") {\r\n            return new bizagi.rendering.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeMoney\") {\r\n            return new bizagi.rendering.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeNumber\") {\r\n            return new bizagi.rendering.rangeNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"activityCheckList\") {\r\n            return new bizagi.rendering.activityCheckList(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate column based on the render type\r\n    */\r\n    getColumn: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type == \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.text;\r\n            }\r\n            return new bizagi.rendering.columns.text(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.searchList;\r\n            return new bizagi.rendering.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type == \"columnNumber\") {\r\n            columnParams.decorated = bizagi.rendering.number;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.money;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.date;\r\n            return new bizagi.rendering.columns.date(columnParams);\r\n        }\r\n\r\n        if (type == \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.yesno;\r\n            }\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.combo;\r\n            return new bizagi.rendering.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type == \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.radio;\r\n            return new bizagi.rendering.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type == \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.list;\r\n            return new bizagi.rendering.columns.list(columnParams);\r\n        }\r\n\r\n        if (type == \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.hidden;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.upload;\r\n            return new bizagi.rendering.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type == \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.image;\r\n            return new bizagi.rendering.columns.image(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.ecm;\r\n            return new bizagi.rendering.columns.uploadecm(columnParams);\r\n        }\r\n        if (type == \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.link;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.formLink;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.userfieldWrapper;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.search;\r\n            return new bizagi.rendering.columns.search(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.document;\r\n            return new bizagi.rendering.columns.document(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.letter;\r\n            return new bizagi.rendering.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type == \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.button;\r\n            return new bizagi.rendering.columns.button(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                //Creates a Scientific Notation render\r\n                return new bizagi.rendering.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.queryExtendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.queryText(searchParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.queryCheck(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.queryYesNo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.queryNumber(searchParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.queryMoney(searchParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.queryDate(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.queryCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.queryCascadingCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.querySuggest(searchParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.queryLabel(searchParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.queryList(searchParams);\r\n        }\r\n        \r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.queryMultiSelect(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.querySearch(searchParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.queryRadio(searchParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.queryState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.queryCaseState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.queryProcess(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.querySearchUser(searchParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.hidden(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Method to fetch templates from a private dictionary\r\n    */\r\n    getTemplate: function (template) {\r\n        var self = this;\r\n        return self.templates[template];\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Render Factory\r\n*   Author: Oscar O\r\n*   Comments:\r\n*   -   This script will define a render factory to create smartphone versions of each render type\r\n*/\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.smartphone.factory\", {}, {\r\n\r\n    init: function(dataService) {\r\n        var self = this;\r\n\r\n        self._super(dataService);\r\n\r\n        if (bizagi.override.enableMSF) {\r\n            if (bizagi.hasOwnProperty(\"kendo\")) {\r\n                self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n            } else {\r\n                self.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n            }\r\n        } else {\r\n            self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        }\r\n    },\r\n\r\n  loadTemplate: function(template, templateDestination) {\r\n      var self = this;\r\n\r\n      // Go fetch the template\r\n      return self.templateService.getTemplate(templateDestination, template)\r\n          .done(function (resolvedRemplate) {\r\n              self.templates[template] = resolvedRemplate;\r\n          });\r\n  },\r\n\r\n  /*\r\n  *   Load all the templates used for rendering\r\n  */\r\n  loadTemplates: function () {\r\n    var self = this;\r\n    var defer = new $.Deferred();\r\n\r\n    $.when(\r\n       // Icons\r\n      self.loadTemplate(\"icons\", bizagi.getTemplate(\"common.bizagi.rendering.icons\")),\r\n      // Containers\r\n      self.loadTemplate(\"form\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.form\") + \"#ui-bizagi-render-form\"),\r\n      self.loadTemplate(\"complexgateway\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.form\") + \"#ui-bizagi-render-complexGateway\"),\r\n      self.loadTemplate(\"panel\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.panel\")),\r\n      self.loadTemplate(\"tab\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.tab\")),\r\n      self.loadTemplate(\"tabItem\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.tabItem\")),\r\n      self.loadTemplate(\"horizontal\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.horizontal\")),\r\n      self.loadTemplate(\"group\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.group\")),\r\n      self.loadTemplate(\"editRender\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edit\")),\r\n      self.loadTemplate(\"searchForm\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchForm\")),\r\n      self.loadTemplate(\"accordion\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.accordion\")),\r\n      self.loadTemplate(\"accordionItem\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.accordionItem\")),\r\n      self.loadTemplate(\"contentPanel\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.contentPanel\")),\r\n\r\n      // Renders\r\n      self.loadTemplate(\"render\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.render\")),\r\n      self.loadTemplate(\"render-layout\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.render.layout\")),\r\n      self.loadTemplate(\"combo\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.combo\") + \"#ui-bz-mobile-combo-control\"),\r\n      self.loadTemplate(\"readonlyCombo\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.combo\") + \"#ui-bz-mobile-readonly-combo-control\"),\r\n      self.loadTemplate(\"comboModalView\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.combo\") + \"#ui-bz-wp-popup-combo-control\"),\r\n      self.loadTemplate(\"date\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.date\") + \"#bz-rn-date\"),\r\n      self.loadTemplate(\"text\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.text\")),\r\n      self.loadTemplate(\"number\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.number\") + \"#ui-bz-mobile-number-control\"),\r\n      self.loadTemplate(\"readonlyNumber\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.number\") + \"#ui-bz-mobile-readonly-number-control\"),\r\n      self.loadTemplate(\"numberScientificNotation\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.numberScientificNotation\")),\r\n      self.loadTemplate(\"extendedText\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.extendedText\") + \"#ui-bz-mobile-extended-text-control\"),\r\n      self.loadTemplate(\"readonlyExtendedText\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.extendedText\") + \"#ui-bz-mobile-readonly-extended-text-control\"),\r\n      self.loadTemplate(\"yesno\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.yesno\")),\r\n      self.loadTemplate(\"check\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.check\")),\r\n      self.loadTemplate(\"button\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.button\")),\r\n      self.loadTemplate(\"link\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.link\")),\r\n      self.loadTemplate(\"list\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.list\") + \"#ui-bz-mobile-list-control\"),\r\n      self.loadTemplate(\"listModalView\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.list\") + \"#ui-bz-wp-popup-list-control\"),\r\n      self.loadTemplate(\"geolocation\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.geolocation\")),\r\n      self.loadTemplate(\"radio\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.radio\")),\r\n      self.loadTemplate(\"search\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.search\") + \"#ui-bz-mobile-search-control\"),\r\n      self.loadTemplate(\"readonlySearch\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.search\") + \"#ui-bz-mobile-readonly-search-control\"),\r\n      self.loadTemplate(\"searchList\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchList\") + \"#ui-bz-mobile-searchlist-control\"),\r\n      self.loadTemplate(\"searchListModalView\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchList\") + \"#ui-bz-wp-popup-searchlist-control\"),\r\n      self.loadTemplate(\"searchListModalViewAuxTemplates\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchList\") + \"#ui-bz-wp-searchlist-control-modalview-auxiliary-templates\"),\r\n      self.loadTemplate(\"searchListInputAuxTemplates\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchList\") + \"#ui-bz-wp-searchlist-control-input-auxiliary-templates\"),\r\n      self.loadTemplate(\"upload\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.upload\") + \"#bz-rn-upload-container\"),\r\n      self.loadTemplate(\"uploadItem\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.upload\") + \"#bz-rn-upload-item\"),\r\n      self.loadTemplate(\"association\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.association\")),\r\n      self.loadTemplate(\"ecm\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.ecm\") + \"#bz-rn-ecm-view-default-item\"),\r\n      self.loadTemplate(\"ecm-metadata\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.ecm\") + \"#bz-rn-ecm-metadata\"),\r\n      self.loadTemplate(\"checkList\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.checkList\")),\r\n      self.loadTemplate(\"image\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.image\") + \"#ui-bizagi-render-image\"),\r\n      self.loadTemplate(\"image-item\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.image\") + \"#ui-bizagi-render-image-item\"),\r\n      self.loadTemplate(\"image-preview\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.image\") + \"#bz-rd-upload-render-edition\"),\r\n      self.loadTemplate(\"document\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.document\") + \"#bz-document-generator\"),\r\n      self.loadTemplate(\"document-item\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.document\") + \"#bz-document-generator-item\"),\r\n      self.loadTemplate(\"render-range\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.range\")),\r\n      self.loadTemplate(\"readonly\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.readonly\")),\r\n      self.loadTemplate(\"list-multiselect\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#ui-bz-mobile-multiselect-control\"),\r\n      self.loadTemplate(\"list-multiselect-tag\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#ui-bz-mobile-multiselect-tag\"),\r\n      self.loadTemplate(\"list-multiselect-tags\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#bz-list-multiselect-tags\"),\r\n      self.loadTemplate(\"list-multiselect-view-more\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#ui-bz-mobile-multiselect-view-more\"),\r\n      self.loadTemplate(\"multiselectModalView\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#ui-bz-wp-popup-multiselect-control\"),\r\n\r\n      //action launcher helpers\r\n      self.loadTemplate(\"render-slide-view\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.slide.view\")),\r\n\r\n      //action launcher\r\n      self.loadTemplate(\"render-actionLauncher\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n      self.loadTemplate(\"render-actionLauncher-horizontal\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n      self.loadTemplate(\"render-actionLauncher-vertical\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n      self.loadTemplate(\"render-actionLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n\r\n      //polymorphic launcher\r\n      self.loadTemplate(\"render-polymorphicLauncher\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n      self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n      self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n      self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n      self.loadTemplate(\"render-polymorphicLauncher-confirm\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n\r\n      //Renders Edition\r\n      self.loadTemplate(\"edition.number\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.number\")),\r\n      self.loadTemplate(\"edition.search.add\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.search\") + \"#bz-rn-search-add\"),\r\n      self.loadTemplate(\"edition.search.item\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.search\") + \"#bz-rn-search-item\"),\r\n      self.loadTemplate(\"edition.link\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.link\")),\r\n      self.loadTemplate(\"edition.letter\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.letter\")),      \r\n\r\n      //Renders Layouts\r\n      self.loadTemplate(\"layout-image\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n      self.loadTemplate(\"layout-image64\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n      self.loadTemplate(\"layout-label\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.label\")),\r\n      self.loadTemplate(\"layout-link\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.link\")),\r\n      self.loadTemplate(\"layout-text\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.text\")),\r\n      self.loadTemplate(\"layout-date-time\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.dateTime\")),\r\n      self.loadTemplate(\"layout-money\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.money\")),\r\n      self.loadTemplate(\"layout-number\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.number\")),\r\n      self.loadTemplate(\"layout-upload\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.upload\")),\r\n\r\n      //Renders commons\r\n      self.loadTemplate(\"form-error\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.form-error\")),\r\n      self.loadTemplate(\"form-waiting\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.form-waiting\")),\r\n\r\n      self.getGridTemplates()\r\n    ).done(function () {\r\n      var tmplIcons = self.getTemplate(\"icons\");\r\n      var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n      if (svgStoreCounter === 0) {\r\n          $(\"head\").append(tmplIcons);\r\n      }\r\n      // Resolve when all templates are loaded\r\n      defer.resolve();\r\n    });\r\n\r\n    return defer.promise();\r\n  },\r\n\r\n  /**\r\n   * Load javascripts after render has been rendered\r\n   */\r\n  loadOverrides: function () {\r\n      // Load custom javascript overrides\r\n      if (bizagi.enableCustomizations) {\r\n          return bizagi.util.loadFile({\r\n              src: bizagi.getJavaScript(\"bizagi.workportal.smartphone.overrides\"),\r\n              type: \"js\"\r\n          });\r\n      }\r\n\r\n      return;\r\n  },\r\n\r\n  /**\r\n   * Returns the appropiate render based on the render type\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  getRender: function (params) {\r\n    var self = this;\r\n    var type = params.type;\r\n    var data = params.data;\r\n\r\n    var renderParams = $.extend(params, {\r\n      renderFactory: this,\r\n      dataService: params.dataService || this.dataService\r\n    });\r\n\r\n    if (type === \"number\") {\r\n      var properties = data.properties;\r\n      if (properties && properties.dataType === 29) {\r\n        return new bizagi.rendering.numberScientificNotation(renderParams);\r\n      }\r\n    }\r\n\r\n    // Grid Beta\r\n    if (bizagi.util.isMobileGridEnabled() && type === \"grid\") {\r\n      return new bizagi.rendering.grid.beta(renderParams);\r\n    }\r\n\r\n    return self._super(params);\r\n  },\r\n\r\n  /**\r\n   * Returns the appropiate column based on the render type\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  getColumn: function (params) {\r\n    var self = this;\r\n    var type = params.type;\r\n    var columnParams = $.extend(params, {\r\n      renderFactory: this,\r\n      dataService: params.dataService || this.dataService,\r\n      singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n    });\r\n\r\n    if (type === \"columnNumber\") {\r\n      var data = params.data;\r\n      var properties = data.properties;\r\n      if (properties && properties.dataType === 29) {\r\n        columnParams.decorated = bizagi.rendering.numberScientificNotation;\r\n        return new bizagi.rendering.columns.numberScientificNotation(columnParams);\r\n      }\r\n    }\r\n\r\n    // Call base\r\n    return self._super(params);\r\n  },\r\n\r\n  /**\r\n   * Get template by type\r\n   * @returns {}\r\n   */\r\n  getGridTemplates: function () {\r\n    var self = this;\r\n    var deferred = new $.Deferred();\r\n\r\n    if (bizagi.util.isMobileGridEnabled()) {\r\n      $.when(\r\n        //Grid helper\r\n        self.loadTemplate(\"grid-view\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.helpers\")),\r\n\r\n        //Grid Smartphone\r\n        self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid\"),\r\n        self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-cell\"),\r\n        self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-cell-readonly\"),\r\n\r\n        //Grid items\r\n        self.loadTemplate(\"grid-control\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-control\"),\r\n        self.loadTemplate(\"grid-table\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table\"),\r\n        self.loadTemplate(\"grid-table-empty\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-empty\"),\r\n        self.loadTemplate(\"grid-table-column\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-column\"),\r\n        self.loadTemplate(\"grid-table-column-special\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-column-special\"),\r\n        self.loadTemplate(\"grid-table-row\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-row\"),\r\n        self.loadTemplate(\"grid-table-cell\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-cell\"),\r\n        self.loadTemplate(\"grid-table-cell-special\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-cell-special\"),\r\n        self.loadTemplate(\"grid-table-pager\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-pager\"),\r\n        //Modal filter\r\n        self.loadTemplate(\"grid-modal-filter\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-filter\"))\r\n        .done(function () {\r\n          deferred.resolve();\r\n        });\r\n    } else {\r\n      $.when(\r\n        //Grid Smartphone\r\n        self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid\")),\r\n        self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.cell\")),\r\n        self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.cell.readonly\")),        \r\n\r\n        // Grid items\r\n        self.loadTemplate(\"bizagi.grid.grid\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid\"),\r\n        self.loadTemplate(\"bizagi.grid.waiting\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-waiting\"),\r\n        self.loadTemplate(\"bizagi.grid.table\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table\"),\r\n        self.loadTemplate(\"bizagi.grid.table.empty\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table-empty\"),\r\n        self.loadTemplate(\"bizagi.grid.column\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column\"),\r\n        self.loadTemplate(\"bizagi.grid.column.special\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column-special\"),\r\n        self.loadTemplate(\"bizagi.grid.row\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row\"),\r\n        self.loadTemplate(\"bizagi.grid.row.buttons\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row-buttons\"),\r\n        self.loadTemplate(\"bizagi.grid.cell\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell\"),\r\n        self.loadTemplate(\"bizagi.grid.cell.special\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell-special\"),\r\n        self.loadTemplate(\"bizagi.grid.pager\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-pager\"),\r\n        self.loadTemplate(\"bizagi.grid.buttons\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-buttons\"),\r\n        self.loadTemplate(\"bizagi.grid.totalizer\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-totalizer\"))\r\n        .done(function () {\r\n          deferred.resolve();\r\n        });\r\n    }\r\n\r\n    return deferred.promise();\r\n  }\r\n});\r\n","/*\r\n*   Name: Bizagi Device Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropriate factory on demand\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.device.factory\", {}, {\r\n\r\n    /**\r\n     * Constructor, detects the device\r\n     * @param params\r\n     */\r\n    init: function (params) {\r\n        this.execution_device = bizagi.util.detectDevice();\r\n        this.cachedFactory = {};\r\n    },\r\n\r\n    /**\r\n     * Returns the appropriate render factory based on the device detection\r\n     * Because it loads the scripts on demand it must return a promise\r\n     * @param dataService\r\n     * @param device\r\n     * @returns {*}\r\n     */\r\n    getRenderFactory: function (dataService, device) {\r\n        var self = this;\r\n        device = device || \"desktop\";\r\n        var defer = new $.Deferred();\r\n\r\n        if (typeof self.cachedFactory[device] !== \"undefined\") {\r\n            // Reset print version value\r\n            self.cachedFactory[device].printVersion = false;\r\n            // Resolve with cached factory                \r\n            defer.resolve(self.cachedFactory[device]);\r\n        } else {\r\n            // If factory is not cached then build it\r\n            if (device === \"print\") {\r\n\r\n                // Load print version references\r\n                self.cachedFactory[device] = new bizagi.rendering.print.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (device === \"desktop\") {\r\n\r\n                // Load desktop references\r\n                self.cachedFactory[device] = new bizagi.rendering.desktop.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (bizagi.util.isTabletDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.tablet.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else if (bizagi.util.isSmartphoneDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.smartphone.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else {\r\n                // if no device suuported\r\n                bizagi.showMessageBox(\"Not supported device: \" + device);\r\n                defer.reject(\"Not supported device: \" + device);\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Returns the current data service being used\r\n     * @returns {*}\r\n     */\r\n    getDataService: function () {\r\n        return this.dataService;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will process a rendering page by calling an ajax service to retrieve the model,\r\n *       and then process it to create base layout, and then call the device render factory\r\n */\r\n\r\n// Define BizAgi Rendering namespace\r\nbizagi.rendering = bizagi.rendering || {};\r\n\r\n/*\r\n *   This class will define a method to process the page\r\n *   1. Fetch the data\r\n *   2. Call the device factory to appropriately render the content\r\n */\r\n$.Class.extend(\"bizagi.rendering.facade\", {\r\n    form: undefined,\r\n    executionDeferred: new $.Deferred()\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        params = params || {};\r\n\r\n        // Set observable element\r\n        this.observableElement = $({});\r\n\r\n        // Injection of Device, only for print version purpose\r\n        var device = params.device || \"\";\r\n\r\n        // Defines a device factory for all rendering\r\n        this.deviceFactory = new bizagi.rendering.device.factory();\r\n\r\n        // Creates a data service instance\r\n        this.dataService = new bizagi.render.services.service(params);\r\n\r\n        // Retrieves the render factory\r\n        this.renderFactory = this.deviceFactory.getRenderFactory(this.dataService, device);\r\n    },\r\n    getFactory: function () {\r\n        var self = this;\r\n        return {\r\n            deviceFactory: self.deviceFactory,\r\n            dataService: self.dataService,\r\n            renderFactory: self.renderFactory\r\n        };\r\n    },\r\n    /*\r\n    *   Subscribe method\r\n    */\r\n    subscribe: function () {\r\n        this.observableElement.bind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Unsubscribe method\r\n    */\r\n    unsubscribe: function () {\r\n        this.observableElement.unbind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Publish method\r\n    */\r\n    publish: function () {\r\n        return this.observableElement.triggerHandler.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   This method will re-execute the process\r\n    */\r\n    update: function (params) {\r\n        var self = this;\r\n\r\n        // Update rendering mode\r\n        if (params.mode)\r\n            self.mode = params.mode;\r\n\r\n        // Enable form buttons on desktop view\r\n        return self.execute($.extend({\r\n            canvas: self.canvas,\r\n            mode: self.mode\r\n        }, params));\r\n    },\r\n    /*\r\n    *   Start point method to use in the main javascript pages\r\n    *   This method will process everything and attach the html directly to the dom\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n        var doc = this.ownerDocument;\r\n        var body = $(\"body\", doc);\r\n        params = params || {};\r\n\r\n        // Creates ready deferred\r\n        if (self.executionDeferred && self.executionDeferred.state) {\r\n            if (self.executionDeferred.state() == \"resolved\") {\r\n                self.executionDeferred = $.Deferred();\r\n            }\r\n        } else {\r\n            self.executionDeferred = $.Deferred();\r\n        }\r\n\r\n        // Performance measurement stuff\r\n        bizagi.chrono.initAndStart(\"rendering+data\", true);\r\n        bizagi.rendering.render.startOptimization();\r\n\r\n        // Override mode\r\n        if (typeof (params.mode) === \"undefined\") {\r\n            if (!bizagi.util.isEmpty(window.location.search)) {\r\n                var queryString = bizagi.util.getQueryString();\r\n                params.mode = queryString[\"mode\"];\r\n            }\r\n        }\r\n\r\n        // If the canvas is not given, we need to create one\r\n        var canvas = self.canvas = params.canvas = params.canvas || $(\"<div />\").appendTo(body);\r\n        self.mode = params.mode;\r\n\r\n        self.process(params).done(function (form) {\r\n\r\n            // Clear canvas    \r\n            if (!params.refreshing) {\r\n                canvas.empty();\r\n            }\r\n\r\n            // Append content\r\n            canvas.append(form.container);\r\n\r\n            // Include process path\r\n            $(form.pathProcess).insertBefore(form.container);\r\n\r\n            // Keep reference in class\r\n            self.form = form;\r\n            self.form.setSize({width: self.lastWidth, height: self.lastHeight});\r\n\r\n            // Save window size variables\r\n            setTimeout(function () {\r\n                self.lastWidth = $(window).width();\r\n                self.lastHeight = $(window).height();\r\n                if (window.self !== window.top)\r\n                    self.resizeInPopUpHTML();\r\n            }, 2000);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Notify to module users that the form has been rendered\r\n            self.publish(\"rendering-formRendered\", {});\r\n\r\n            // Configure handlers\r\n            self.configureRefresh(form, canvas);\r\n            self.configureRouting(form, canvas);\r\n            self.configureRenderError(form, canvas);\r\n            self.configureResize(form);\r\n            self.configureGlobalHandlers(form);\r\n\r\n            // Check if it is a summary form\r\n            if (params.summaryForm) {\r\n                form.container.addClass(\"ui-bizagi-summary-form\");\r\n            }\r\n\r\n            // Ends main timer and log everything\r\n            bizagi.chrono.stopAndLog(\"rendering\");\r\n            bizagi.chrono.stopAndLog(\"rendering+data\");\r\n            bizagi.chrono.stopAndLog(\"submitForm\");\r\n            bizagi.chrono.stopAndLog(\"submitForm-ajax\");\r\n            bizagi.chrono.stopAndLog(\"waiting\");\r\n\r\n            // Resolves deferred\r\n            bizagi.rendering.render.stopOptimization();\r\n\r\n            // Expose public reference of form\r\n            if (bizagi.override.enableE2EInterface) {\r\n                self.Class.form = self.form;\r\n                self.Class.executionDeferred.resolve(self.form);\r\n            }\r\n\r\n            self.executionDeferred.resolve(self.form);\r\n\r\n        }).fail(function (message, errorType) {\r\n\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n\r\n                    if (typeof message === \"undefined\" || message === \"\") {\r\n                        message = bizagi.localization.getResource(\"render-error-unknown\");\r\n                    }\r\n\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    self.publish(\"rendering-formRenderedError\", message);\r\n                    self.canvas.triggerHandler(\"errorform\", message);\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n\r\n                    self.executionDeferred.reject();\r\n                });\r\n        });\r\n\r\n        return self.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the execution deferred to determine if the component is ready or not\r\n    */\r\n    ready: function () {\r\n        return this.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Loads data and render factory in order to process the form\r\n    *   Returns a deferred to set callbacks when the process is done\r\n    */\r\n    process: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Call get form data service\r\n        var dataPromise = self.dataService.getFormData(params);\r\n\r\n        var canvas = self.canvas || params.canvas;\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n        // Set callback when requests have been done\r\n        $.when(dataPromise, self.renderFactory)\r\n            .done(function (data, renderFactory) {\r\n                bizagi.showErrorAlertDialog = true;\r\n\r\n                // When there is no data trigger an event\r\n                if (bizagi.util.isEmpty(data)) {\r\n                    self.publish(\"no-data-found\");\r\n                    defer.fail();\r\n                    return;\r\n                }\r\n\r\n                if (data && data.type == \"reload\") {\r\n                    var form = self.form;\r\n                    if (form) {\r\n                        form.endLoading();\r\n                        form.dispose();\r\n                    }\r\n                    // Trigger handler on canvas\r\n                    canvas.triggerHandler(\"routing\");\r\n\r\n                } else if (data && data.type == \"suspended\") {\r\n                    var errorTemplate = renderFactory.getTemplate(\"info-message\");\r\n                    var message = bizagi.localization.getResource(\"render-case-suspended\");\r\n                    var errorHtml = $.tmpl(errorTemplate, {\r\n                        message: message\r\n                    });\r\n                    // Remove loading icon from summary container\r\n                    errorHtml.appendTo(canvas);\r\n\r\n                    defer.fail();\r\n\r\n                } else if (data && data.type != \"error\") {\r\n                    if (params.hasOwnProperty('printversion')) {\r\n                        data = self.transformGridControl(data);\r\n                        data.form.properties.editable = \"False\";\r\n                    }\r\n\r\n                    bizagi.chrono.initAndStart(\"rendering\");\r\n                    params.type = (data.form && data.form.properties.type) || params.type;\r\n                    var form = self.processForm(data.form, renderFactory, params);\r\n\r\n                    // Resolve deferred\r\n                    defer.resolve(form);\r\n\r\n                } else {\r\n                    self.getFailDeferred(data, defer);\r\n                }\r\n            }).fail(function (errorMessage) {\r\n            self.getFailDeferred(errorMessage, defer);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /**\r\n     * In the print version widget when grid control was rendered, the main render has broken\r\n     * Is necesary change id of grid control to fixed these  problems\r\n     */\r\n    transformGridControl: function (data) {\r\n        var self = this;\r\n        if (data == null) {\r\n            return data;\r\n        }\r\n\r\n        if (data.hasOwnProperty('type') && data.type == 'grid') {\r\n            data.id = data.id + \"-print\";\r\n            data.allowAdd = \"False\";\r\n            data.allowDelete = \"False\";\r\n            data.allowEdit = \"False\";\r\n            data.allowGrouping = \"False\";\r\n            data.allowMore = \"False\";\r\n            data.allowSearch = \"False\";\r\n        } else {\r\n            $.each(data, function (key, value) {\r\n                if (typeof (value) == 'object') {\r\n                    data[key] = self.transformGridControl(data[key]);\r\n                }\r\n            });\r\n        }\r\n        return data;\r\n    },\r\n    /**\r\n     * Resolve deferred\r\n     */\r\n    getFailDeferred: function (errorMessage, defer) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var jsonErrorMessage = {};\r\n        try {\r\n            jsonErrorMessage = JSON.parse(errorMessage.responseText);\r\n        } catch (e) {\r\n            jsonErrorMessage = {message: errorMessage.responseText, errorType: \"ERRORUNKNOWN\"};\r\n        }\r\n\r\n\r\n        if (jsonErrorMessage.message) {\r\n            message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n            message += \"<br>Error Message: \" + jsonErrorMessage.message;\r\n        } else {\r\n            if (jsonErrorMessage.errorType == \"JSharpNotSupportedException\") {\r\n                message += \"<br>Error Message: \" + bizagi.localization.getResource(\"jsharp-required\");\r\n            }\r\n        }\r\n\r\n        // Error in metadata InvalidFormMetadata\r\n        if (jsonErrorMessage.errorType == 'ERRORUNKNOWN') {\r\n            defer.reject(message, jsonErrorMessage.errorType);\r\n        } else {\r\n\r\n            defer.reject(message);\r\n        }\r\n    },\r\n    /*\r\n    *   Process the form\r\n    */\r\n    processForm: function (data, renderFactory, params) {\r\n        var form = renderFactory.getContainer($.extend(params, {\r\n            type: params.type || \"form\",\r\n            data: data\r\n        }));\r\n\r\n        //Orientation RTL - OrderButtons\r\n        if (typeof BIZAGI_ORIENTATION != \"undefined\") {\r\n            if ((form.properties.orientation == \"rtl\" || BIZAGI_ORIENTATION == 'rtl') && form.buttons.length > 0) {\r\n                var buttonsForm = form.buttons[0];\r\n\r\n                form.buttons.splice(0, 1);\r\n                form.buttons.push(buttonsForm);\r\n            }\r\n        }\r\n\r\n        // Render the full form\r\n        form.render();\r\n\r\n        return form;\r\n    },\r\n    /*\r\n    *   Performs a resize\r\n    */\r\n    resize: function (args) {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.trigger(\"renderresize\", args);\r\n        }\r\n    },\r\n    /*\r\n    *   Binds a refresh handler to detect when the whole form needs to fetch all data from server\r\n    */\r\n    configureRefresh: function (form, canvas) {\r\n        var self = this;\r\n\r\n        // Attach a refresh handler to recreate all the form\r\n        form.bind(\"refresh\", function (_, refreshParams) {\r\n\r\n            // Find the scroll top\r\n            var parent = form.container.parent();\r\n            parent = bizagi.util.scrollTop(parent);\r\n            var scrollTop = parent.scrollTop();\r\n\r\n            $(self.form).trigger(\"onRefreshStarted\");\r\n\r\n            //Dispose current form\r\n            form.dispose(refreshParams);\r\n            canvas.fastEmpty();\r\n            var canvasParent = canvas.parent();\r\n            if (canvasParent.find(\".ui-bizagi-button-container\").length > 0) {\r\n                canvasParent.find(\".ui-bizagi-button-container\").remove();\r\n            }\r\n\r\n            if (self.executionDeferred && self.executionDeferred.state) {\r\n                if (self.executionDeferred.state() == \"resolved\") {\r\n                    self.executionDeferred = $.Deferred();\r\n                }\r\n            }\r\n\r\n            var formParams = self.form.getParams();\r\n            // Re-execute process\r\n            $.when(self.execute($.extend(refreshParams, {\r\n                canvas: canvas,\r\n                refreshing: true,\r\n                idCase: formParams.idCase,\r\n                displayName: formParams.displayName\r\n            }))).done(function () {\r\n\r\n                // Restore scroll at same position\r\n                setTimeout(function () {\r\n                    parent.scrollTop(scrollTop);\r\n                    $(self.form).trigger(\"onRefreshFinished\");\r\n                }, 100);\r\n            });\r\n\r\n            return self.executionDeferred.promise();\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a resize hanlder to configure the resize behaviour\r\n    */\r\n    configureResize: function (form) {\r\n        var self = this;\r\n\r\n        // Attach resize handler\r\n        form.bind(\"renderresize\", function (_, args) {\r\n            args = args || {};\r\n            // Just allow one resize at a time\r\n            if (self.resizeTimeout)\r\n                return;\r\n            var resizeFn = function () {\r\n                // Call resize event in form\r\n                var width = $(window).width();\r\n                var height = $(window).height();\r\n                if (args.forceResize || width != self.lastWidth) {\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.initAndStart(\"resize\");\r\n\r\n                    // Perform resize\r\n                    form.resize({\r\n                        width: width,\r\n                        height: height\r\n                    });\r\n                    self.lastWidth = width;\r\n                    self.lastHeight = height;\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.stopAndLog(\"resize\");\r\n                    bizagi.chrono.log(\"resize\");\r\n                }\r\n\r\n                self.resizeTimeout = null;\r\n            };\r\n            self.resizeTimeout = setTimeout(resizeFn, 0);\r\n\r\n        });\r\n        self.resize();\r\n    },\r\n    /*\r\n    *   Binds a routing handler to detect when the workportal need to enroute the case\r\n    */\r\n    configureRouting: function (form, canvas) {\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"routing\", function (context, triggerParams) {\r\n            //Dispose current form\r\n            form.dispose();\r\n\r\n            // Trigger handler on canvas\r\n            canvas.triggerHandler(\"routing\", triggerParams);\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a generic handler that will be replicated to facade instantiators\r\n    */\r\n    configureGlobalHandlers: function (form) {\r\n        var self = this;\r\n\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"globalHandler\", function (_, args) {\r\n            // Trigger handler on canvas\r\n            return self.publish(args.eventType, args.data);\r\n        });\r\n    },\r\n    /*\r\n    * Binds error form handler to detect when the render element nop posible get information or error in server\r\n    */\r\n    configureRenderError: function (form, canvas) {\r\n        var self = this;\r\n\r\n        form.bind(\"formRenderingError\", function (event, errorMessage) {\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n                    var message = \"<br>Error: \";\r\n\r\n                    errorMessage = errorMessage.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n\r\n                    var jsonErrorMessage = JSON.parse(errorMessage);\r\n                    if (jsonErrorMessage.message) {\r\n                        message += jsonErrorMessage.message;\r\n                        message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n                    }\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    //send the type error to differentiate between a form and an item for render\r\n                    self.canvas.triggerHandler(\"errorform\", \"renderItemError\");\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                });\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.dispose();\r\n        }\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    resizeInPopUpHTML: function () {\r\n        if ($(\".activitiFormContainer\").length > 0 && bizagi.util.getQueryString().type != \"cases\") {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var heightButtonContainer = buttonContainer.outerHeight() || 0;\r\n            var renderBehavior = bizagi.util.getQueryString().renderBehavior || \"\";\r\n            renderBehavior = renderBehavior.replace(\"#\", \"\");\r\n\r\n            if (renderBehavior == \"PopUp\") {\r\n                if (typeof (self.postMessageSocket) == \"undefined\") {\r\n                    var heightCanvas = $(\".activitiFormContainer\").height() - 50 || 396;\r\n                    $(\"#render-canvas\").height(heightCanvas);\r\n                    $(\"#render-canvas\").css(\"overflowY\", \"scroll\");\r\n                } else $(\".activitiFormContainer\").height($(\".activitiFormContainer\").height() + $(\".ui-bizagi-button-container\").height() + 30);\r\n                $(\".ui-bizagi-button-container\").css(\"position\", \"absolute\");\r\n                $(\".ui-bizagi-button-container\").appendTo(\".activitiFormContainer\");\r\n                if ($(\".ui-bizagi-button-container\").length > 1) {\r\n                    $(\".ui-bizagi-button-container:first\").hide();\r\n                    renderForm.css(\"marginTop\", \"-17px\");\r\n                }\r\n            }\r\n            if (buttonContainer.length > 0) {\r\n                //display buttons\r\n                renderForm.height(heightActivitiFormContainer - 97 - heightButtonContainer);\r\n            }\r\n            if ($(\".ui-bizagi-button-container\").children().length == 0)\r\n                $(\"#render-canvas\").height($(\"#render-canvas\").height() + heightButtonContainer);\r\n            else {\r\n                buttonContainer.width(\"100%\");\r\n                buttonContainer.css(\"marginLeft\", 0);\r\n                buttonContainer.css(\"bottom\", 0);\r\n            }\r\n        } else if (bizagi.util.getQueryString().type == \"render\") {\r\n            $(\"html\").css(\"overflowX\", \"hidden\");\r\n            ($(\"#render\").height() <= window.innerHeight + 5) ? $(\"html\").css(\"overflowY\", \"hidden\")\r\n                : $(\"html\").css(\"overflowY\", \"scroll\");\r\n            $(\".ui-widget-overlay\").height(650);\r\n        }\r\n    }\r\n\r\n});"]}