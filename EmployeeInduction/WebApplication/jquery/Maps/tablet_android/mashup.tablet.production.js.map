{"version":3,"sources":["jquery/common/bizagi/js/services/bizagi.template.services.service.kendo.js","jquery/common/bizagi/js/bizagi.util.js","jquery/mashup/js/services/bizagi.mashup.services.ajax.js","jquery/mashup/js/services/bizagi.mashup.services.ajax.autologin.js","jquery/workportalflat/common/services/bizagi.workportal.services.endPoints.js","jquery/workportalflat/common/services/bizagi.workportal.services.context.js","jquery/workportalflat/common/services/bizagi.workportal.services.service.js","jquery/workportalflat/common/services/bizagi.workportal.services.routing.js","jquery/mashup/js/bizagi.mashup.facade.js","jquery/mashup/js/services/authentication/bizagi.mashup.authentication.js","jquery/mashup/js/services/authentication/bizagi.mashup.authentication.basic.js","jquery/mashup/js/services/authentication/bizagi.mashup.authentication.bizagi.js","jquery/mashup/js/services/authentication/bizagi.mashup.authentication.oauth.js","jquery/mashup/js/bizagi.mashup.device.factory.js","jquery/mashup/js/tablet/bizagi.mashup.tablet.facade.js","jquery/mashup/js/controllers/bizagi.mashup.controllers.controller.js","jquery/mashup/js/controllers/action/bizagi.mashup.action.routing.js","jquery/mashup/js/controllers/base/bizagi.mashup.controllers.main.js","jquery/mashup/js/controllers/base/dialog/bizagi.mashup.controllers.dialog.js","jquery/mashup/js/controllers/base/render/bizagi.mashup.controllers.render.navigation.js","jquery/mashup/js/controllers/base/render/bizagi.mashup.controllers.render.routing.js","jquery/mashup/js/controllers/base/render/bizagi.mashup.controllers.render.async.js","jquery/mashup/js/controllers/base/render/bizagi.mashup.controllers.render.js","jquery/mashup/js/controllers/base/caseSummary/bizagi.mashup.controllers.caseSummary.js","jquery/mashup/js/controllers/base/newCase/bizagi.mashup.controllers.newCase.js","jquery/mashup/js/controllers/base/startForm/bizagi.mashup.controllers.startForm.js","jquery/mashup/js/controllers/base/entityTemplates/bizagi.mashup.controllers.entityTemplates.js","jquery/mashup/js/controllers/tablet/render/bizagi.mashup.controllers.tablet.render.js","jquery/mashup/js/controllers/tablet/caseSummary/bizagi.mashup.controllers.tablet.caseSummary.js","jquery/mashup/js/controllers/tablet/startForm/bizagi.mashup.controllers.tablet.startForm.js","jquery/mashup/js/controllers/tablet/entityTemplates/bizagi.mashup.controllers.tablet.entityTemplates.js"],"names":["$","Class","extend","customTemplateFile","bizagi","loader","getResource","detectDevice","cachedFiles","cachedTemplates","customTemplates","init","localization","this","cssRegex","loadingFileDeferred","loadCustomTemplates","self","defer","Deferred","when","getTemplateFile","done","response","temp","html","responseParts","each","i","responsePart","attr","resolve","promise","getTemplate","template","id","isCustomTemplate","replace","enableCustomizations","hash","getHash","environment","internalGetTemplate","pipe","resolvedTemplate","getTemplateForRelease","getTemplateWidget","then","getTemplateWebpart","url","containsHash","getUrlWithoutHashes","processAndReturnTemplate","loadTemplateFileForRelease","ajax","dataType","ready","index","valueTemplate","translatedTemplate","reject","JSON","parse","hasOwnProperty","translate","cachedTemplate","getTemplatePart","templateUrl","loadingTemplatePartExecution","loadingTemplatePart","BIZAGI_ENVIRONMENT","length","console","warn","matches","match","cssFile","loadFile","src","type","outerHTML","indexOf","substring","override","enableMSF","jQuery","fn","fastEmpty","kendoTmplEmpty","fasttmpl","tmpl","data","kendoTmpl","cacheTemplate","cacheKendoTemplate","children","remove","element","hasClass","loadingMessage","kendo","useWithBlock","tempTmpl","trim","kendoTmpls","templates","services","service","util","context","smartphone","tablet","DEVICES","printf","msg","arg","args","Array","prototype","slice","call","arguments","a","val","undefined","shift","charCodeAt","Math","round","String","bizagiQueue","queue","add","callback","push","callbacks","addParallel","execute","starter","queueLength","apply","map","deferred","fail","deviceEnum","callInside","fx","tagName","toLowerCase","contentWindow","e","browser","msie","execScript","toString","webkit","mozilla","eval","callInsidePopup","document","CSSStyleDeclaration","getPropertyValue","getAttribute","setProperty","styleName","value","priority","setAttribute","rule","RegExp","escape","cssText","removeProperty","removeAttribute","getPropertyPriority","test","text","style","get","nl2br","br2nl","controlValueIsChanged","control","properties","getValue","compareValue","originalValue","result","forceCollectData","state","includes","parseBoolean","Date","getTime","getMaxZindex","elm","maxZindex","key","zindex","parseInt","css","equalizeHeights","selector","heights","outerHeight","max","autoSave","deferredSave","trigger","_data","anonymizedUserInformation","name","username","email","domain","picture","isAnonymized","datepickerResource","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","liveProcessesEvents","newLiveProcess","createEvent","initEvent","routeEvents","route","saveEvent","lastWidget","nextWidget","liveSave","widgetName","deferredLiveSave","indeX","find","location","href","workportal","widgets","widget","BIZAGI_WORKPORTAL_WIDGET_PROFLY","saveLivePromise","dispatchEvent","md5","message","CryptoJS","s","p","m","l","lib","n","r","Base","b","h","mixIn","$super","create","clone","q","WordArray","words","sigBytes","t","stringify","concat","j","clamp","g","ceil","random","v","enc","Hex","k","join","substr","Latin1","fromCharCode","u","Utf8","decodeURIComponent","Error","unescape","encodeURIComponent","BufferedBlockAlgorithm","reset","_nDataBytes","_append","_process","blockSize","_minBufferSize","min","_doProcessBlock","splice","Hasher","cfg","_doReset","update","finalize","_doFinalize","_createHelper","_createHmacHelper","HMAC","algo","abs","sin","MD5","_hash","w","f","x","y","z","A","B","C","D","c","d","floor","HmacMD5","multiReplace","mapDataToReplace","reg","replaceAll","pcFrom","pcTo","replaceAllGlobalRegExp","re","capitalize","charAt","toUpperCase","startsWith","str","getInitials","initials","split","sign","isNaN","obj","encode","measureString","string","fontSize","appendTo","width","detach","endsWith","suffix","isIE7","isIE","documentMode","isIE8","isIE9","isIE10","isIE11","navigator","userAgent","isIE11OrLower","isIE10OrLower","isEdge","appName","getIEVersion","sAgent","window","indexMSIE","version","isChrome","vendor","isFirefox","minVersion","ua","M","tem","exec","appVersion","getBrowser","bw","emptyNavigatorInfo","info","addClass","language","setIphoneXOverrides","isNativePluginSupported","bizagiapp","isIphoneX","append","isiOSDevice","isString","Object","isObject","isArray","isNull","isBoolean","getInternetExplorerVersion","Number","isNumeric","parseFloat","isFinite","isGUID","mustImplement","notImplementedMethod","log","exe","encodeXpath","xpath","isEmpty","isEmptyObject","isEmptyCombo","object","property","other","decodeURI","infinityControl","finishDecoded","decodedValue","hasNonVisibleChars","ch","percent2Number","isObjectEmpty","isMapEmpty","replaceSelector","container","elementToReplace","unwrap","hasScroll","el","direction","identicalObjects","obj1","obj2","countProps","count","isScrolledIntoView","elem","layout","scrollTop","elemTop","offset","top","height","centerElementIntoScroll","actualScroll","elementTop","elementHeight","newTop","encodeHtml","decodeHtmlEntities","getHashParams","params","initWebpart","webpart","device","initialized","initializing","loadingDeferred","getQueryString","pairs","pos","argname","extendQueryString","additionalParams","plainUrl","existingParams","newParams","param","getStackTrace","callstack","isCallstackPopulated","dont","exist","stack","lines","len","opera","entry","currentFunction","callee","caller","fname","highLightElement","setTimeout","removeClass","autoScrollBottom","elScrollHeight","scrollHeight","autoScrollInterval","autoScroll","itemScroll","limitTop","limitBottom","idInterval","outSide","clearInterval","mousemove","event","pageY","autoScrollTopInterval","autoScrollBottomInterval","classCSS","setInterval","valueMaxScrollBottom","innerHeight","removeAutoScroll","unbind","getMaxZIndex","zIndex","showPopup","callbackFn","left","newWindow","open","BAPopupWindow","BAPopupCallback","BACloseWindow","controls","submitForm","close","showQuirksModePopup","quirksModePage","BIZAGI_PATH_TO_BASE","BAQuirksPopupWindow","title","windowParams","popupWindow","quirksOnLoad","loadedBody","iframe","show","afterLoad","userParams","callbackParams","loadingFunction","body","resolveResult","createPopup","popupName","onClose","popupTitle","overlay","popup","closeButton","popupContent","hide","additionalClass","center","closeHandler","click","fullPopup","content","createOkCancelPopup","onOk","onCancel","buttonsContainer","buttonOk","buttonCancel","okHandler","cancelHandler","ok","cancel","dialog","modal","buttons","closeQuirksModePopup","quirksPopup","getStyle","pathName","getFontFace","getAllChildrens","matchStyles","stringCss","awesomeBrowser","file","styleSheets","rules","cssRules","cssTextOriginal","selectorText","lastLevel","styleSheet","suckBrowser","cookie","options","expires","days","setDate","getDate","raw","toUTCString","path","secure","decode","randomNumber","setContext","reloadCSS","queryString","_name","_call","_params","_singleton","singleton","_timeOut","timeout","_maxIterations","iterations","_context","_killWhenExitContext","killWhenExitContext","timeOut","maxIterations","itsRunning","timeInit","executeTimeOut","now","actualIterations","ieFunction","clearTimeout","pointer","timeOutRunning","isDate","dateField","timeField","resultDate","hasTime","resultTime","arrayDate","unicode2htmlencode","input","htmlHex","getHeadElement","hd","getElementsByTagName","docEl","documentElement","createElement","insertBefore","firstChild","loadStyle","styleText","layoutGuid","node","getElementById","createTextNode","childNodes","nodeValue","replaceChild","appendChild","loadIconStyle","icon","userfieldname","innerHTML","formatDecimalAndMoneyCell","tableData","externalMoneyFormat","moneyFormat","decimalFormat","externalDecimalFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","roundToDecimalPlace","decimalDigits","symbol","colorize","groupDigits","negativeFormat","positiveFormat","columnTitle","rows","fields","formatMoney","numberValue","formatDecimal","removeTrailingZeros","positive","BIZAGI_DEFAULT_CURRENCY_INFO","formatBoolean","formatInvariantBoolean","htmlContent","not","$element","format","formatCurrency","formatMonetaryCells","tmpResult","intSection","decimalSection","decimalResult","isNegative","decimalDigitPosition","fixDecimalDigits","getOnlyNumbersByString","stringValue","toFixed","formatInvariantMoney","defaultFormat","allowDecimals","formatInvariantNumber","numberFormat","thousands","containsLetter","NaN","formatNumber","percentage","formatInvariantDate","dateTimeFormat","isValidDate","getFormatDate","formatDate","dateFormatter","formatDateFromInvariantStringDate","stringInvariantDate","dateValue","defaultFormatDate","H","getHours","getMinutes","getSeconds","ms","getMilliseconds","formatValueByDataType","replaceLineBreak","formatMonetaryCell","formatDecimalCell","parseDate","valueOf","LZ","getDateFromFormat","getRelativeTime","date","onlyUnitsTime","time","diff","timeDiff","getTimeDiffDescription","unit","timeDivisor","unitAmount","resourceAgo","compareDates","date1","dateformat1","date2","dateformat2","d1","d2","getDifferenceBetweenDates","i18n","token","i_format","getFullYear","getMonth","E","getDay","isValidResource","months","i_val","year","getYear","month","hh","mm","ss","ampm","_getInt","month_name","day_name","ff","_isInteger","_val","minlength","maxlength","_token","preferEuro","generalFormats","monthFirst","dateFirst","checkList","analyzeTimeFormat","timeFormat","returnObj","show24Hours","showSeconds","separator","lastToken","getDateFromInvariant","showTime","INVARIANT_FORMAT","setHours","formatInvariant","getDateFromISO","ISO_FORMAT","formatISO","formatISO8601","dateObject","restartTimeToMidnight","isFormatISO8601","stringDate","sleep","delay","start","getDateFormatByDatePickerJqueryUI","browserSupportLocalStorage","setItemLocalStorage","localStorage","setItem","getItemLocalStorage","getItem","removeItemLocalStorage","removeItem","clearLocalStorage","clear","bizagiConfig","showConsoleLog","startLoading","stopLoading","elementToapply","isEventSupported","eventName","isSupported","needsFallback","circularDependencies","Function","list","lastNodeAdded","addNode","OBJ","foundObjChildNode","_search","_addNode","nodeObj","timeStamp","addChild","resolved","seen","_getFirstNodeWithChilds","_resolve","childs","hasObject","error","dependencyFrom","dependencyFromObj","dependencyTo","dependencyToObj","standardError","status","responseText","makeErrorMessage","multiactionError","toSearch","collection","cssExtended","instance","cssToAdd","cssExtendedApplyChanges","option","$this","attrToAdd","tmpStyle","arrProperties","resultProperties","cssProperty","canvas","parent","sortJSON","way","sort","shortNumber","number","newNumber","lenghtNumber","escapeHtml","div","showNotification","div_sync","fadeIn","stop","fadeOut","isModeOnline","isOfflineForm","dispose","arrayEach","array","getStandardNotation","tmp","decimalNumber","exponentialNumber","scientificNotationFormat","sdLimit","expMinLimit","expMaxLimit","sNregex","sNFormat","exp","prefix","originalPointIndex","tempParts","significantDigits","intPart","from","to","significantFlag","firstDigit","restDigits","stripslashes","isHTMLValidText","resetData","sessionStorage","isAuthenticate","changeData","isMobileDevice","isTabletDevice","isAndroidTabletDevice","isiOSTabletDevice","isSmartphoneDevice","isAndroidSmartphoneDevice","isiOSSmartphoneDevice","formContainer","getFormContainer","formParams","getParams","detectAndroidVersion","indexAndroid","androidVersion","getPathUrl","solvedUrl","locationParts","pathname","basePath","protocol","host","pathToBaseBackwards","getAndroidVersion","mobileImagePath","image","dataImage","photoSplit","resource","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","byteNumbers","byteArray","Uint8Array","Blob","stringToByteArray","hasOfflineFormsEnabled","BIZAGI_ENABLE_OFFLINE_FORMS","isFlatDesignEnabled","BIZAGI_ENABLE_FLAT","isMobileGridEnabled","BIZAGI_ENABLE_MOBILE_GRID","isNativeHeaderEnabled","NATIVE_HEADER_ENABLE","isQuickSearchEnabled","BIZAGI_ENABLE_QUICK_SEARCH","isOAuth2Enabled","BIZAGI_AUTH_TYPE","getNativeComponent","BIZAGI_NATIVE_COMPONENT","isVersionSupported","supported","BIZAGI_SERVER_VERSION","isCordovaSupported","isTabletNativeSupported","isSmartphoneNativeSupported","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","detectRealDevice","settedDevice","BIZAGI_DEFAULT_DEVICE","isAndroid","isAndroidDevice","getChannelType","BIZAGI_SERVER_CHANNEL","channel","isDataUrl","getDataUrl","currentUrl","tempUrl","processFailMessage","tmp_block_header","disableWorkPortalMenu","blockHeight","prependTo","position","background","opacity","z-index","enableWorkPortalMenu","downloadFile","completeuRL","ulrToDownload","arrayURL","executeActionRoutingFromWorkportal","idCase","idWorkItem","controllers","menu","publish","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","getMessageFromNetworkState","sanitizeHTML","textContent","arrayUnique","items","debounce","func","wait","immediate","callNow","isNativeImageEditorSupported","enableImageEditor","errorMessage","validateUrlWellFormed","decodedDisplayValue","valueToDisplay","setCaretPosition","ctrl","setSelectionRange","focus","createTextRange","range","collapse","moveEnd","moveStart","select","getCaretPosition","oField","iCaretPos","selection","oSel","createRange","selectionStart","escapeRegex","getFeatureObject","arr","featureObjectCache","features","getConfigFeatures","pivot","getFeatureObjectIte","bizagiConfiguration","BIZAGI_MOBILE_FEATURES","resetConfigFeatures","isFailResponse","code","formatItem","highlightMatches","item","term","parseValue","regEx","getDesktopResolution","resolution","devicePixelRatio","screenWidth","screen","screenHeight","deviceXDPI","logicalXDPI","getDeviceCode","BIZAGI_DEVICE_MARKET_NAME","normalizeType","hideOrShowXToCloseDialog","isEnableFeature","feature","parents","ps","parentNode","prop","getComputedStyle","scroll","scrollerParent","HTMLElement","SVGElement","scrollingElement","startkendo","kendoMobileApplication","mobile","Application","skin","browserHistory","ui","progress","started","bizagiNavigate","navigate","isSharepointContext","BIZAGI_SHAREPOINT_CONTEXT","isEmptyValue","assert","useAbsolutePath","BIZAGI_USE_ABSOLUTE_PATH","pathToBase","getLocationPrefix","loginPage","errorPage","rpcEnabled","rpcHandler","logEnabled","logSuccess","logSubmits","logFail","batch","batchCount","batchTimer","batchTimeoutInstance","parseJSON","ex","errorCode","ajaxSetup","converters","text json","beforeSend","jqXHR","settings","batchRequest","_loading","loading","complete","responseJSON","validationMethod","redirectToLoginPage","startPageMaintenance","jqAutoLogin","user","intercept","refreshing","buffer","currentRequests","_resetOptions","_setupInterceptor","_resetData","logout","_deactivateInterceptor","_fireEvent","login","setUserData","_activateInterceptor","password","_addToBuffer","_clearBuffer","_fireBuffer","promises","refreshRetry","_setRefreshingFlag","eventType","_hasEvent","events","bufferInterval","bufferWaitLimit","newFlag","ajaxPrefilter","originalOptions","jqxhr","always","inArray","waited","interval","rejectWith","endPoints","getEndPoints","user-handler","proxyPrefix","process-handler","query-handler","case-handler","query-form","query-form-edit","query-form-delete","query-form-delete-cube","favorites-handler","file-handler","login-handler","login-handlerv10","logoff-handler","logoff-handlerv1","authorization-handler-getMenuAuthorization","authorization-handler-isCaseCreationAuthorized","case-handler-getCaseSummary","case-handler-releaseActivity","case-handler-getCasesList","case-handler-getActivityList","offline-getProcessTree","offline-tasks","offline-getForms","offline-sendForm","case-handler-getCaseTasks","case-handler-getCaseEvents","case-handler-getCaseSubprocesses","case-handler-getTaskAssignees","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getAsynchExecutionState","case-handler-addNewCase","case-handler-startProcess","handler-execute-action-start","case-handler-supportedLogTypes","case-handler-getActivityLog","case-handler-getActivityDetailLog","case-handler-getEntityLog","case-handler-getEntityDetailLog","case-handler-getUserLog","case-handler-getUserDetailLog","case-handler-getAdminLog","case-handler-getCaseFormsRenderVersion","case-handler-validateHasStartForm","favorites-handler-saveFavorite","favorites-handler-deleteFavorite","process-getIcon","collections-getIcon","bamAnalytics-handler-getAnalisysQueries","bamAnalytics-handler-updateQuery","inbox-handler-getInboxSummary","MessageHandler-NewComment","MessageHandler-GetComments","MessageHandler-SetCategoryToComment","MessageHandler-RemoveComment","MessageHandler-ReplyComment","MessageHandler-RemoveReply","MessageHandler-GetCategoryColors","MessageHandler-RenameCategoryColor","MessageHandler-CountNewComments","process-handler-getAllProcesses","process-handler-getFavourites","process-handler-getFavouriteCases","process-handler-getCustomizedColumnsData","process-handler-getCategory","process-handler-getRecentProcesses","process-handler-getCustomizedColumnsDataInfo","process-handler-getOrganizations","process-handler-getMyStuff","process-handler-getIdCasesOfProcessEntities","templates-handler-getCollectionData","data-navigation-handler-collection","data-navigation-handler-entity","data-navigation-handler-entity-filters","action-handler-getProcessAddAction","my-search-getSearchLists","my-search-getFilters","my-search-getFiltersData","my-search-getData","templates-handler-getVirtualCollectionData","templates-handler-getMultipleActions","process-handler-getMapping","process-handler-getForm","process-handler-startform","process-handler-rule","process-action-execute","process-handler-getActivitiesData","process-handler-getPendingsData","entities-handler-getActions","entities-handler-getUsersAndEvents","entities-handler-getUsers","entities-handler-getEvents","entities-handler-getUsersImages","entities-handler-getShotCuts","query-handler-getqueries","query-handler-getQueryForm","user-handler-getCurrentUser","old-render","Reports","reports-handler-deleteQueries","folders-handler-getUserQueries","folders-associate-deleteSmartFolder","folders-handler","folders-associate","smartfolders-integration","AlarmAdmin","AnalyticsProcess","AnalyticsSensor","AnalyticsTask","AsynchronousWorkitemRetries","AuthenticationLogQuery","BAMProcess","BAMTask","BusinessPolicies","CaseAdmin","adminReassignCases","asyncECMUpload","CasesMonitor","Closed","CurrentUser","EncryptionAdmin","MobileUpdatesAdmin","EntityAdmin","LocationResources","NewCase","Pending","Profiles","Search","UserAdmin","UserDefaultAssignation","UserPendingRequests","ListPreferences","UserPreferencesUrl","GRDimensionAdmin","Licenses","AnalysisQueries","DocumentTemplates","ProcessAdmin","ResourceBAM","WorkPortalVersion","entities-administration","theme-handler-getLogoImagePath","logoutDotNet","authenticationConfig","logout-oauth2","FederateLogoffUrl","oauth2AuthenticationConfig","massive-activity-assignments-getOrganizationInfo","massive-activity-assignments-getCasesByOrganization","massive-activity-assignments-reassignCases","massive-activity-assignments-searchUsers","async-ecm-upload-baseService","domains","getCurrentTheme","admin-getAuthenticationLog","admin-getAuthenticationDomains","admin-getAuthenticationEventsTypes","admin-getAuthenticationEventSubTypes","admin-EncryptString","admin-UserPendingRequests","admin-UserAuthenticationInfo","admin-updateUserAuthenticationInfo","admin-generateRandomPassword","admin-GenerateDataToSendByEmail","admin-sendEmail","admin-getApplicationList","admin-getApplicationProcesses","admin-getProcessVersion","admin-getProcessTasks","admin-getTaskAlarms","admin-getLapseMode","admin-getRecurrMode","admin-getScheduleType","admin-getBossList","admin-addAlarm","admin-editAlarm","admin-deleteAlarm","admin-alarmRecipients","admin-deleteAlarmRecipients","admin-recipientToAlarm","admin-enableAlarm","admin-getCategoriesList","admin-getCasesList","admin-abortItems","admin-reassignItems","admin-getDefaultAssignationUserToAllProcess","admin-getDefaultAssignationUserToProcess","admin-setDefaultAssignationUserToProcess","admin-getProfilesTypes","admin-searchProfiles","admin-getUsersByProfile","admin-removeUserFromProfile","admin-addUserToProfile","admin-async-activities-get-activities","admin-async-activities-get-retry-now","admin-async-activities-get-activities-by-task","admin-async-activities-enable-execution","admin-async-activities-enable-multiple","admin-async-activities-async-execution","admin-async-activities-async-execution-log","admin-Licenses","admin-GetDimensions","admin-EditDimension","admin-CreateAdministrableDimension","admin-DeleteDimension","admin-EntityPathChildNodesAction","admin-GetActiveWFClasses","admin-document-templates-storeDocumentTemplates","admin-document-templates-restoreDocumentTemplates","admin-document-templates-uploadDocumentTemplate","admin-processes-workflowClasses","admin-processes-tasksByWorkflow","admin-processes-modifyProcessDuration","admin-processes-modifyTaskDuration","admin-language-resource","admin-language-languages","bam-resourcemonitor-myteam","reports-analysisquery","reports-analysisquery-update","reports-analysisquery-delete","processviewer-processdefinition","processviewer-processgraphicinfo","mobile-getLastUpdate","discussion-case","discussion-case-v1","get-users","new-discussion","count-comments","comment-case","new-comment","new-comment-attach","get-list-files","get-list-files-v1","project-resource-action","thumbnail-file","get-attachment","get-mobile-attachment","project-files-upload","count-files","count-files-v1","remove-comment","time-schemas-effectiveduration","project-users-get","project-plan-get","project-plan-activities","project-plan-workitems","project-plan-transitions-get","project-plan-activity-edit","project-plan-get-by-parent","project-plan-parent","project-plan-update","project-plan-execute","project-plan-close","project-plan-delete","project-plan-first-parent-plan","getUrl","setProxyPrefix","BA_CONTEXT_PARAMETER_PREFIX","ENTITIES_QUERY_PAGE_SIZE","normalizeUrl","RPproxyPrefix","sharepointProxyPrefix","serviceLocator","pageSize","deviceType","desktop","deviceCode","BIZAGI_INBOX_ROWS_PER_PAGE","endPoint","getOverrides","overrides","valueUppercase","read","authenticatedUser","urlSend","userName","BIZAGI_USER","BIZAGI_PASSWORD","BIZAGI_DOMAIN","logoutUser","logOffUser","getCurrentUser","getInboxSummary","getAllProcesses","taskState","onlyFavorites","myActivities","myPendings","smartfoldersParameters","isMobile","skipAggrupate","responseData","categories","allProcesses","allCases","category","isFavorite","guidFavorite","idworkflow","guidWFClass","workflows","workflow","getFavourites","getMyStuff","getFavouriteCases","page","getCasesList","numberOfFields","idWfClass","elementToHtml","overdue","today","tomorrow","upcoming","totalPages","actualDate","actualMonth","actualDay","actualYear","lengthData","elements","counter","tmpElement","tmpdate","tmpDay","tmpMonth","tmpYear","getCasesListBeta","getMobileCasesList","groupedData","advanceSearch","statusFunction","defineActivityStateByTaskState","defineActivityStateByDate","taskstate","tmpEndDate","endDate","idworkitem","idwfclass","validateFeatureSupport","radNumber","urlMobile","resp","row","field","tempElement","headers","fieldName","displayName","serializeActivity","currentPage","activityDate","group","shortEndDate","isEvent","dataChangeset","getCurrentActivities","processActivitiesResponse","highlight","process_filter","processes","highlightedNumber","highlightsString","processname","active","expresion","getDiscussionCase","globalParent","editDiscussion","getUsersDiscussion","getEffectiveDuration","getUsersData","createNewDiscussion","createNewComment","updateProjectFile","createProjectFile","getFilesCount","getCommentCase","getCommentsByParent","getFilesList","deleteFile","destroy","getFilesThumbnail","getAttachment","guidAttachment","idAttachment","getMobileAttachment","getAllAdministrableEntities","kind","entities","getEntitiesList","getCasesByWorkflow","idWorkflow","keyvalue","radnumber","idcase","cases","newFieldsValue","fieldsKey","fieldsValue","isRadNumber","Value","DisplayName","workitems","getOrganizationsList","getCustomizedColumnsData","orderFieldName","orderType","order","idTask","getCustomizedColumnsDataBeta","lstIdCases","noResults","getCategories","idCategory","idApp","groupByApp","getRecentProcesses","getCaseSummary","eventAsTasks","onlyUserWorkItems","mobileDevice","serviceType","getCaseAssignees","getCaseTasks","getCaseEvents","getCaseSubprocesses","getCaseFormsRenderVersion","getCaseFormsRenderVersionDataContent","getTaskAssignees","getWorkitems","fromTask","fromWorkItemId","getQueries","hashQueries","idElement","processQueries","query","queries","idParent","nodes","createNewCase","caseData","idOrganization","validateHasStartForm","processId","startProcess","idProcess","entityMapping","mapping","idParentCase","oldParams","oldVersion","actionCreateCase","guidProcess","parentCaseId","getFirstParentPlan","searchCases","h_action","onlyUserCases","queryCases","filter","outputxpath","queryEntities","idEntity","getMenuAuthorization","isCaseCreationAuthorized","getAsynchExecutionState","idAsynchWorkitem","supportedLogTypes","getActivityLog","orden","idActualPage","getActivityDetailLog","idWorkItemFrom","getEntityLog","getEntityDetailLog","userFullName","attribDisplayName","getUserLog","getUserDetailLog","idUser","entDisplayName","getAdminLog","addFavorite","idObject","favoriteType","delFavorite","summaryAssigness","def","baseAssignees","assignees","assigneesLength","assigneesFix","showAssignees","activities","assigneesEvents","assigneesActivities","assigneesEventsList","assigneesActivitiesList","Name","summarySubProcess","subprocess","summaryCaseEvents","summaryCaseDetails","idWorkitem","getCaseSummaryDataContent","currentState","dataCurrentStateLength","showEvents","countEvents","showParentProcess","parentProcess","parentDisplayName","isClosedForAllUsers","isClosed","isOpen","countAssigness","showSubProcess","countSubProcesses","showForm","hasGlobalForm","allowsReassign","currentStateTypes","assignToCurrentUser","showActivities","releaseActivity","summaryActivities","icoTaskState","process","createdBy","createdByName","createdByUserName","caseDescription","processPath","showWorkOnIt","getSmartFolders","idFolder","searchFolders","deleteSmartFolder","idSmartFolder","getFolders","folders","getCasesByFolder","cache","makeFolder","folderName","idParentFolder","updateFolder","associateCaseToFolder","idCustomFolder","dissasociateCaseFromFolder","deleteFolder","getFile","uploadId","entityId","entityKey","getComments","encodeURI","idColorCategory","pag","pagSize","comments","users","Id","Picture","makeNewComment","comment","makeNewReply","idComment","Replies","removeMobileComment","removeComment","removeReply","idReply","renameCommentCategory","colorName","setCommentCategory","getCommentsCategories","getNewComments","getAnalisysQueries","updateQueries","idQuery","queryName","queryDescription","deleteQueries","queryId","QueryId","getConfiguration","javaLogout","reload","logoutMobile","logoutData","sourceLogout","redirectErrorPage","authenticationType","logOffURL","federationLogoutBindingProtocol","authenticationSubType","res","federateLogoffUrl","write","nativeAjax","jsonResponse","samlUrlRedirect","on","logoutUrl","callbackUrl","homeUrl","getOrganizationInfo","getCasesByOrganization","roles","skills","locations","reassignCases","searchUsers","fullName","getDomainList","getEcmAllScheduledJobs","retryECMPendingScheduledJob","getWorkPortalVersion","productBuild","getAuthenticationLogData","getAuthenticationLogResult","dtFrom","dtTo","eventSubType","encryptString","userPendingRequests","userAuthenticationInfo","updateUserAuthenticationInfo","enable","expired","locked","generateRandomPassword","generateDataToSendByEmail","sendEmail","emailTo","subject","getApplicationCategoriesList","filterStartEvent","getAdminCasesList","getApplicationProcesses","getProcessVersion","getProcessTasks","getTaskAlarms","getLapseMode","getRecurrMode","getScheduleType","getBossList","addAlarm","editAlarm","deleteAlarm","getAlarmRecipients","addRecipientToAlarm","deleteRecipientsFromAlarm","enableAlarm","abortReassignItems","asyncActivitiesServices","getDefaultAssignationUserToAllProcess","serviceAction","getDefaultAssignationUserToProcess","idWFClass","setDefaultAssignationUserToProcess","getProcessIcon","getCollectionIcon","collectionId","getProfilesTypes","searchProfiles","getUsersByProfile","removeUserFromProfile","addUserToProfile","licenses","getDimensions","editDimension","entityPath","description","createAdministrableDimension","deleteDimension","administrable","entityPathChildNodesAction","nodeType","idNode","nodeDisplayPath","nodePath","getActiveWFClasses","storeDocumentTemplates","restoreDocumentTemplates","Guid","getWorkFlowClasses","getTaskByWorkFlow","modifyProcessDuration","duration","modifyTaskDuration","getDataForMyTeam","getReporstAnalysisQuery","updateReportData","deleteReportData","getStoreLanguageTemplates","justActives","getLanguageTemplate","cultureName","processDefinition","graphicInfo","getLastUpdateByMobile","getCollectionData","idFact","filters","getVirtualCollectionData","guidVirtualCollection","getSearchData","guidSearch","calculateFilters","serializeEntityData","getCollectionEntityData","templateType","referenceType","surrogateKey","defaultFilterApplied","reference","guidEntityCurrent","getFiltersEntityData","getProcessAddAction","getMultipleActions","getMapping","getForm","hasStartForm","guid","executeAction","surrogatedKey","ruleId","actionRule","getActivitiesData","pagsize","getPendingsData","getActionsData","getUsersAndEvents","idCases","getUsers","caseId","getEvents","getUsersImages","userIds","square","getShortCuts","getSearchLists","getIdCasesOfProcessEntities","ids","server","lessThanOrEqualsTo","getQueryForm","defineFilterObject","filterObject","rangeQuery","searchType","typeSearch","values","setValues","isDefaultFilter","defaultFilter","getPlan","getActivities","updatePlan","putExecutePlan","deletePlan","closePlan","getWorkitemsPlan","getTransitionsByPlan","editActivityPlan","activity","idPlan","getPlanByParent","getItemsByActivity","getPlanParent","serializedData","_buildNewObject","header","newObject","guidEntity","timestamp","columns","rowData","kRow","iCell","cells","kReturnObject","BIZAGI_WORKPORTAL_WIDGET_START_FORM","dataService","modules","render","oldRender","async","activitySelector","renderVersion","resetRouteInformation","module","moduleParams","setRenderParams","getRenderParams","renderParams","formsRenderVersion","referrer","isComplex","skipSubprocessGlobalForm","BIZAGI_SETTINGS","getRoute","getRenderVersion","getWorkItems","workItems","hasWorkItems","setRenderModuleName","getRenderModuleName","searchIdTask","idWorkFlow","listAsyncWorkItems","checkAsyncWorkItems","msgTask","routeToMessageForm","routeToGlobalForm","routeToGlobalFormWithoutData","workItemIndex","workitemCounter","isAsynch","checkProcess","subProcesses","checkWorkItems","xhr","errorType","renderName","workItemsList","workItemToSearch","idCaseForGlobalForm","withOutGlobalForm","messageForm","formsVersion","config","defaultParams","authentication","deviceFactory","mashup","factory","authenticator","oauth","basic","routing","executionDeferred","deviceFacade","getMashupFacade","mashupFacade","controller","getMainController","layoutHeader","showHeader","transition","renderCase","onRender","hideInternalHeader","getUser","showInternalHeader","authenticateUser","auth","setAccessToken","accessToken","showSummaryCase","onError","renderCaseSummary","facade","creationParams","currentUser","userProperty","userProperties","sUserProperties","_super","autologin","sessionExpiration","crossDomain","loginOption","refreshTokenCallback","oauth2","jqOAuth","tokenName","tokenExpiration","refreshToken","hasAccessToken","cachedFacade","initializeTemplates","initAsyncStuff","alert","getDataService","setMobileMetaTags","templateService","rel","loadTemplates","getStyleSheet","getJavaScript","loadTemplate","configureHomeHandlers","templateDestination","getAction","main","loadTemplateWebpart","resolvedRemplate","resources","componentContainers","subscribers","disposed","triggerHandler","subscribe","docEventName","handler","bind","subscribeOneTime","one","unsubscribe","templatesDeferred","internalRender","configureHandlers","renderContent","postRender","tmplPromises","useNewEngine","getContent","getComponentSelector","component","getComponentContainer","componentElement","is","actionName","actionParams","resizeLayout","performResizeLayout","disposeTime","parameters","isThereAsync","asyncWidget","modalParameters","wi","componentRegex","BIZAGI_WORKPORTAL_WIDGET_INBOX","BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID","setWidget","renderController","renderRoutingDialog","pushWidget","onRenderAction","renderWorkarea","caseSummaryController","caseSummary","startFormController","startForm","entityTemplatesController","entityTemplates","newCaseController","newCase","mashup-dialog","dialogTmpl","kendoMobileModalView","useNativeScrolling","modalView","PRIORITY_UNDEFINED","PRIORITY_PRIMARY","PRIORITY_SECONDARY","PRIORITY_LIST","view","$pane","wrapper","closest","pane","navBar","containersQueue","resetParams","createRenderContainer","zoom","Boolean","$view","viewId","setContainerParams","viewItem","View","tmplView","previousViewId","scrollElement","scroller","currentScrollY","returnObject","contentElement","setNavigationButtons","form","hasButtons","changeButtonVisibilityByContainer","dynamic","initFormButton","modalViewDidAppear","modalViewDidDisappear","buttonsToShow","visible","additional","label","caption","ordinal","ranked","formButtons","getListWithPriority","processButton","indexNext","findPriorityAction","indexSave","forEach","actionsList","findIndex","button","btn","routingTmpl","showWorkitem","taskName","ASYNC_CHECK_TIMER","executeAsync","$template","ModalView","checkAsycnExecutionState","prepend","navigation","summaryForm","renderForm","routingParameters","rendering","empty","toggle","rfParams","renderContainer","infoTemplate","online","paramsFacade","triggerparams","navbar","drawer","Drawer","swipeToOpen","delegate","preventDefault","routingExecute","renderCurrentTab","currentTab","idLastComment","COMMENT_SIZE","totalRecords","getTimeAgo","release","defered","showConfirmationBox","showMessageBox","mashup-newcase-modal-multiorganization","isMultiOrganization","createOrganizationList","notification","isBatch","createNewCaseNotification","newCaseParams","dataCase","categoryName","createCase","resultData","buildCaseParameters","isShortcut","startShortcutProcess","caseResponse","assignessResponse","navigateProcess","notifier","isAdjusted","multiorganizationModal","multiorganizationTemplate","isAdhocProcess","getKendoMobileModalView","configureModalHandlers","adjustSize","maxHeight","listHeight","maxWidth","popupHeight","windowHeightSize","windowWidthSize","innerWidth","orientation","addEventListener","showProcess","isMultiInstance","caseInfo","caseNumber","sticky","class_name","target","stopPropagation","modalContext","_back","_navigateProcess","_refreshTemplate","original_params","_type","_origin","origin","_renderParams","h_idParentCase","h_guidprocess","h_mappingstakeholders","h_idProcess","h_contexttype","h_guidEntity","entityGuid","h_guidForm","formGuid","h_showDisabled","h_readonlyform","readonlyform","entitySurrogateKey","h_surrogateKey","h_mapping","_form","changeButtons","startFormFacade","originalParams","postRenderEdit","originalProcessButton","buttonProperties","endLoading","contextType","validateForm","refreshTemplate","accumulatedContext","homePortalFramework","what","preventNavigate","acumContext","entityDataSource","DataSource","transport","listParams","getEntities","dataCalled","success","schema","total","serverFiltering","serverPaging","templateLoaderPush","templateLoaderRefresh","entityList","kendoMobileCustomListView","autoBind","loadMore","messages","pullTemplate","releaseTemplate","loadMoreText","dataSource","pullToRefresh","itemBind","getKendoMobileCustomListView","engineReady","engine","ev","getData","entityData","getEntityTemplates","_referenceType","processEntities","entity","isDefaultTemplate","guidTemplate","renderedTemplate","mashup-render-view","mashup-render-layout","mashup-render-edition-view","mashup-info-message","mashup-routing","mashup-async","mashup-summary-view","mashup-summary-main","mashup-summary-subprocess","mashup-summary-comments","mashup-summary-assigness","mashup-summary-activities","mashup-summary-events","renderSummary","estimatedSolutionDate","solutionDate","getStatusTimeLabel","creationDate","mainTemplate","bztabs","activate","currentTarget","tabNumber","allowReleaseActivity","mashup-start-form","mashup-entity-templates","mashup-entity-templates-item","mashup-entity-templates-item-actions","mashup-entity-templates-pull-loader","mashup-entity-templates-refresh-loader","templateDataService","renderFactory","templateEngine","forcePersonalizedColumns"],"mappings":"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","sourcesContent":["/*\r\n*   Name: Bizagi Template Services\r\n*   Author: Bizagi UI Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to all templates available on bizagi\r\n*/\r\n\r\n$.Class.extend(\"bizagi.kendo.templates.services.service\", {\r\n    // Static templates\r\n    customTemplateFile: bizagi.loader.getResource(\"tmpl\", \"bizagi.overrides.\" + bizagi.detectDevice() + \".custom.templates\"),\r\n    cachedFiles: {},\r\n    cachedTemplates: {},\r\n    customTemplates: {}\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (localization) {\r\n        this.localization = localization;\r\n        this.cssRegex = /{{css \"(.+)\"}}/g;\r\n        this.loadingFileDeferred = {};\r\n    },\r\n\r\n    /*\r\n    *   Load custom templates info in order to override framework stuff\r\n    */\r\n    loadCustomTemplates: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(this.getTemplateFile(this.Class.customTemplateFile))\r\n        .done(function (response) {\r\n            var temp = $(\"<div />\").html(response);\r\n            var responseParts = $(\"script\", temp);\r\n\r\n            $.each(responseParts, function (i, responsePart) {\r\n                responsePart = $(responsePart);\r\n                self.Class.customTemplates[responsePart.attr(\"id\")] = responsePart.html();\r\n            });\r\n\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Returns the template from cache or from ajax\r\n    *   Must return a deferred\r\n    */\r\n    getTemplate: function (template, id) {\r\n        var self = this;\r\n        var isCustomTemplate = false;\r\n\r\n        // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\r\n        template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\r\n\r\n        // If the template contains the hash before the question mark, we need to exchange them\r\n        template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\r\n\r\n        if (bizagi.enableCustomizations) {\r\n            var hash = self.getHash(template);\r\n\r\n            // Check if a custom template has been given in order to override it\r\n            if (self.Class.customTemplates[hash]) {\r\n                isCustomTemplate = true;\r\n            }\r\n        }\r\n\r\n        if (isCustomTemplate || (bizagi.loader.environment !== \"release\")) {\r\n            return this.internalGetTemplate(template, id)\r\n                .pipe(function (resolvedTemplate) {\r\n                    // Creates a in-memory element to hold the template\r\n                    return resolvedTemplate;\r\n                });\r\n        } else {\r\n            return this.getTemplateForRelease(template, id)\r\n                .pipe(function (resolvedTemplate) {\r\n                    return resolvedTemplate;\r\n                });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Returns the template from cache or from ajax\r\n     *   Must return a deferred\r\n     */\r\n    getTemplateWidget: function (template, id) {\r\n        var self = this;\r\n        var isCustomTemplate = false;\r\n\r\n        // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\r\n        template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\r\n\r\n        // If the template contains the hash before the question mark, we need to exchange them\r\n        template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\r\n\r\n        if (bizagi.enableCustomizations) {\r\n            var hash = self.getHash(template);\r\n\r\n            // Check if a custom template has been given in order to override it\r\n            if (self.Class.customTemplates[hash]) {\r\n                isCustomTemplate = true;\r\n            }\r\n        }\r\n\r\n        if (isCustomTemplate || (bizagi.loader.environment !== \"release\")) {\r\n            return this.internalGetTemplate(template, id)\r\n                .pipe(function (resolvedTemplate) {\r\n                    // Creates a in-memory element to hold the template\r\n                    return resolvedTemplate;\r\n                });\r\n        } else {\r\n            return this.getTemplateForRelease(template, id).then(function (resolvedTemplate) {\r\n                return resolvedTemplate;\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns the template from cache or from ajax\r\n    *   Must return a deferred\r\n    */\r\n    getTemplateWebpart: function (template, id) {\r\n        // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\r\n        template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\r\n\r\n        // If the template contains the hash before the question mark, we need to exchange them\r\n        template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\r\n        return this.internalGetTemplate(template, id)\r\n            .pipe(function (resolvedTemplate) {\r\n                // Creates a in-memory element to hold the template\r\n                return resolvedTemplate;\r\n            });\r\n    },\r\n\r\n    /*\r\n    * Load the production template and return requested template\r\n    */\r\n    getTemplateForRelease: function (template, id) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var url;\r\n        var hash;\r\n\r\n        // extract url\r\n        if (self.containsHash(template)) {\r\n            url = self.getUrlWithoutHashes(template);\r\n            hash = self.getHash(template);\r\n        } else {\r\n            url = template;\r\n            hash = \"\";\r\n        }\r\n\r\n        var cachedTemplate = self.Class.cachedTemplates[url];\r\n\r\n        if (!cachedTemplate) {\r\n            $.when(self.loadTemplateFileForRelease(url))\r\n            .done(function () {\r\n                defer.resolve(self.processAndReturnTemplate(url, hash, id));\r\n            });\r\n\r\n        } else {\r\n            defer.resolve(self.processAndReturnTemplate(url, hash, id));\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    loadTemplateFileForRelease: function (url) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Check in cache\r\n        if (self.Class.cachedTemplates[url]) {\r\n            return self.Class.cachedTemplates[url];\r\n        }\r\n\r\n        // Check if it is already being loaded\r\n        if (self.loadingFileDeferred[url]) {\r\n            $.when(self.loadingFileDeferred[url])\r\n                .done(function () {\r\n                    // Resolve with cached content\r\n                    defer.resolve(self.Class.cachedTemplates[url]);\r\n                });\r\n            return defer.promise();\r\n        }\r\n\r\n        // Load file via ajax\r\n        self.loadingFileDeferred[url] = $.Deferred();\r\n        $.when($.ajax({ url: url, dataType: \"text\" }), self.localization.ready())\r\n            .done(function (response) {\r\n                if (!response)\r\n                    defer.reject(\"\");\r\n\r\n                // response is an object\r\n                if (typeof (response) != \"string\")\r\n                    response = JSON.parse(response[0]);\r\n\r\n                self.Class.cachedTemplates[url] = response;\r\n\r\n                // process templates for translate, remove CSS and generate global function template\r\n                var index;\r\n                var valueTemplate;\r\n                var translatedTemplate;\r\n\r\n                for (index in response) {\r\n                    if (response.hasOwnProperty(index)) {\r\n                        valueTemplate = response[index];\r\n                        translatedTemplate = self.localization.translate(valueTemplate);\r\n\r\n                        // Remove css tags\r\n                        translatedTemplate = translatedTemplate.replace(self.cssRegex, \"\");\r\n                        self.Class.cachedTemplates[url][index] = translatedTemplate;\r\n                    }\r\n                }\r\n\r\n                self.loadingFileDeferred[url].resolve();\r\n                defer.resolve(response);\r\n            });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    * Return hashed template\r\n    */\r\n    processAndReturnTemplate: function (url, hash, id) {\r\n        var self = this;\r\n        var template = self.Class.cachedTemplates[id];\r\n\r\n        if (!template) {\r\n            template = self.Class.cachedTemplates[url][hash];\r\n\r\n            if (!template) {\r\n                throw \"template \" + template + \"doesn't exist\";\r\n            } else {\r\n                self.Class.cachedTemplates[id] = template;\r\n            }\r\n        }\r\n\r\n        return template;\r\n    },\r\n\r\n    /*\r\n    *   Returns the template from cache or from ajax\r\n    *   Must return a deferred\r\n    */\r\n    internalGetTemplate: function (template, id) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var cachedTemplate = this.Class.cachedTemplates[id];\r\n\r\n        if (!cachedTemplate) {\r\n\r\n            // Check if the template has a hash\r\n            if (self.containsHash(template)) {\r\n                var url = self.getUrlWithoutHashes(template);\r\n                var hash = self.getHash(template);\r\n\r\n                // Check if a custom template has been given in order to override it\r\n                if (self.Class.customTemplates[url]) {\r\n                    // Resolve deferred\r\n                    if (self.Class.customTemplates[url][id]) {\r\n                        defer.resolve(self.Class.customTemplates[hash]);\r\n                        return defer.promise();\r\n                    }\r\n                }\r\n\r\n                $.when(self.getTemplatePart(url, hash, id))\r\n                    .done(function (response) {\r\n                        // Set in cache\r\n                        self.Class.cachedTemplates[id] = response;\r\n\r\n                        // Resolve deferred\r\n                        defer.resolve(response);\r\n                    });\r\n\r\n            } else {\r\n                // Gets the full template\r\n                $.when(self.getTemplateFile(template))\r\n                    .done(function (response) {\r\n                        self.Class.cachedTemplates[id] = response;\r\n                        // Resolve deferred\r\n                        defer.resolve(response);\r\n                    });\r\n            }\r\n        } else {\r\n            defer.resolve(cachedTemplate);\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Gets a template part from a composite template file\r\n    *   Just load one template at a time to avoid multiple loadings of the same file\r\n    */\r\n    getTemplatePart: function (templateUrl, hash) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If it is already loading a template set a timeout to check later\r\n        $.when(self.loadingTemplatePartExecution)\r\n        .done(function () {\r\n            // Set a async flag to synchronize this method\r\n            self.loadingTemplatePart = true;\r\n            self.loadingTemplatePartExecution = new $.Deferred();\r\n\r\n            // Load template file\r\n            $.when(self.getTemplateFile(templateUrl))\r\n            .done(function (response) {\r\n                var temp = $(\"<div />\").html(response);\r\n                var responsePart = $(\"#\" + hash, temp);\r\n\r\n                // Assertion to check that hash exists inside the main template                \r\n                if (BIZAGI_ENVIRONMENT === \"debug\" && responsePart.length === 0) {\r\n                    console.warn(\"No template part (\" + hash + \") found in content for:\" + templateUrl);\r\n                }\r\n\r\n                // Set response\r\n                response = responsePart.html();\r\n\r\n                // Free async flag\r\n                self.loadingTemplatePartExecution.resolve();\r\n                self.loadingTemplatePart = true;\r\n\r\n                // Resolve main deferred\r\n                defer.resolve(response);\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Loads a full template file and keeps it on cache\r\n    */\r\n    getTemplateFile: function (template) {\r\n        var self = this;\r\n        var cachedTemplate = this.Class.cachedFiles[template];\r\n\r\n        if (cachedTemplate) return cachedTemplate;\r\n\r\n        // Not found in cache, fetch it with ajax\r\n        return $.when($.ajax({ url: template, dataType: \"text\" }), self.localization.ready())\r\n            .pipe(function (response) {\r\n                // if no response has been found in the source file return an empty template\r\n                if (!response) return \"\";\r\n\r\n                if (typeof (response) != \"string\")\r\n                    response = response[0];\r\n\r\n                // Translate template\r\n                var translatedTemplate = self.localization.translate(response);\r\n\r\n                // Find css and import them\r\n                var matches = translatedTemplate.match(self.cssRegex);\r\n\r\n                if (matches) {\r\n                    $.each(matches, function (i, match) {\r\n                        var cssFile = match.replace(self.cssRegex, \"$1\");\r\n\r\n                        bizagi.loader.loadFile({ src: cssFile, type: \"css\", environment: \"debug\" });\r\n                    });\r\n                }\r\n                // Remove css tags\r\n                translatedTemplate = translatedTemplate.replace(self.cssRegex, \"\");\r\n\r\n                // Set in cache\r\n                self.Class.cachedFiles[template] = typeof (translatedTemplate) === \"string\" ? translatedTemplate\r\n                    : translatedTemplate[0].outerHTML;\r\n\r\n                return translatedTemplate;\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Check if a url contains hashes\r\n    */\r\n    containsHash: function (url) {\r\n        return url.indexOf(\"#\") !== -1;\r\n    },\r\n\r\n    /*\r\n    *   Get url hash\r\n    */\r\n    getHash: function (url) {\r\n        return url.substring(url.indexOf(\"#\") + 1, url.length);\r\n    },\r\n\r\n    /*\r\n    *   Get url without hashes\r\n    */\r\n    getUrlWithoutHashes: function (url) {\r\n        return url.substring(0, url.indexOf(\"#\"));\r\n    }\r\n});\r\n\r\nif (!bizagi.override.enableMSF) {\r\n\r\n    jQuery.fn.fastEmpty = function () {\r\n        $(this).kendoTmplEmpty();\r\n    };\r\n\r\n    jQuery.fasttmpl = function (tmpl, data) {\r\n        return jQuery.kendoTmpl(tmpl, data);\r\n    };\r\n\r\n    //jQuery.tmpl = function (tmpl, data) {\r\n    //    return jQuery.kendoTmpls(tmpl, data);\r\n    //};\r\n\r\n    jQuery.cacheTemplate = function (tmpl, data) {\r\n        jQuery.cacheKendoTemplate(tmpl, data);\r\n    };\r\n\r\n}\r\n// KENDO TEMPLATES\r\n\r\n/**\r\n *   Overrides detach method to apply custom stuff\r\n */\r\njQuery.fn.kendoTmplEmpty = function () {\r\n    this.children().remove();\r\n\r\n    // Check if it has loading property to apply plugin\r\n    var element = $(this);\r\n    if (element.hasClass(\"ui-bizagi-component-loading\")) {\r\n        element.loadingMessage();\r\n    }\r\n};\r\n\r\n/**\r\n *   JQuery tmpl extension\r\n */\r\njQuery.kendoTmpl = function (tmpl, data) {\r\n    if (typeof tmpl === \"undefined\") return \"\";\r\n\r\n    tmpl = tmpl.replace(/(\\n*)|(\\r*)|(\\t*)/g, \"\");\r\n    tmpl = tmpl.replace(/\\s+/g, \" \");\r\n\r\n    var tempTmpl = kendo.template(tmpl, { useWithBlock: false });\r\n    var html = tempTmpl(data);\r\n\r\n    return $.trim(html.replace(/>\\s*</g, \"><\"));\r\n};\r\n\r\njQuery.kendoTmpls = function (tmpl, data) {\r\n    return $(jQuery.kendoTmpl(tmpl, data));\r\n};\r\n\r\njQuery.cacheKendoTemplate = function(tmpl, data) {\r\n    var tempTmpl = bizagi.kendo.templates.services.service.cachedTemplates[tmpl];\r\n    return jQuery.kendoTmpl(tempTmpl, data);\r\n};\r\n","/*\r\n *   Name: BizAgi Utils\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide misc helpers to all modules\r\n */\r\n\r\n// Create or Define BizAgi namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\nbizagi.util.smartphone = (typeof (bizagi.util.smartphone) !== \"undefined\") ? bizagi.util.smartphone : {};\r\nbizagi.util.tablet = (typeof (bizagi.util.tablet) !== \"undefined\") ? bizagi.util.tablet : {};\r\n\r\nvar DEVICES = {};\r\n\r\nDEVICES[DEVICES['desktop'] = 0] = 'desktop';\r\nDEVICES[DEVICES['smartphone'] = 1] = 'smartphone';\r\nDEVICES[DEVICES['tablet'] = 2] = 'tablet';\r\n\r\nbizagi.deviceEnum = DEVICES;\r\n\r\n/*\r\n *   Define mini-plugin to acceess iframe's boundaries\r\n */\r\n(function ($) {\r\n    $.fn.callInside = function (fx, args) {\r\n        if ($(this)[0].tagName.toLowerCase() != \"iframe\")\r\n            return null;\r\n        // Don't execute the code when the content window is not ready yet    \r\n        if ($(this)[0].contentWindow == null)\r\n            return null;\r\n        // Check if the iframe is cross domain\r\n        try {\r\n            // Evals the content\r\n            $(this)[0].contentWindow.args = args;\r\n        } catch (e) {\r\n            // If an exception is thrown here this is a cross domain access\r\n            return null;\r\n        }\r\n\r\n        if ($.browser.msie) {\r\n            return $(this)[0].contentWindow.execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        } else if ($.browser.webkit || $.browser.mozilla) {\r\n            return $(this)[0].contentWindow.eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        }\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n    $.fn.callInsidePopup = function (fx, args) {\r\n        // This is window here\r\n        var self = this;\r\n        $(document).ready(function () {\r\n            // Check if the iframe is cross domain\r\n            try {\r\n                // Evals the content\r\n                $(self)[0].args = args;\r\n            } catch (e) {\r\n                // If an exception is thrown here this is a cross domain access\r\n                return null;\r\n            }\r\n\r\n            if ($.browser.msie) {\r\n                return $(self)[0].execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            } else if ($.browser.webkit || $.browser.mozilla) {\r\n                return $(self)[0].eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            }\r\n\r\n        });\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n\r\n    // add support for CSS functions for \"setProperty\" in ie8\r\n    var isStyleFuncSupported = !!CSSStyleDeclaration.prototype.getPropertyValue;\r\n    if (!isStyleFuncSupported) {\r\n        CSSStyleDeclaration.prototype.getPropertyValue = function (a) {\r\n            return this.getAttribute(a);\r\n        };\r\n        CSSStyleDeclaration.prototype.setProperty = function (styleName, value, priority) {\r\n            this.setAttribute(styleName, value);\r\n            var priority = typeof priority != 'undefined' ? priority : '';\r\n            if (priority != '') {\r\n                // Add priority manually\r\n                var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*' + RegExp.escape(value) + '(\\\\s*;)?', 'gmi');\r\n                this.cssText = this.cssText.replace(rule, styleName + ': ' + value + ' !' + priority + ';');\r\n            }\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.removeProperty = function (a) {\r\n            return this.removeAttribute(a);\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.getPropertyPriority = function (styleName) {\r\n            var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*[^\\\\s]*\\\\s*!important(\\\\s*;)?', 'gmi');\r\n            return rule.test(this.cssText) ? 'important' : '';\r\n        };\r\n    }\r\n\r\n    // Escape regex chars with \\\r\n    RegExp.escape = function (text) {\r\n        return text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n    };\r\n\r\n    // The style function\r\n    jQuery.fn.style = function (styleName, value, priority) {\r\n        // DOM node\r\n        var node = this.get(0);\r\n        // Ensure we have a DOM node \r\n        if (typeof node == 'undefined') {\r\n            return;\r\n        }\r\n        // CSSStyleDeclaration\r\n        var style = this.get(0).style;\r\n        // Getter/Setter\r\n        if (typeof styleName != 'undefined') {\r\n            if (typeof value != 'undefined') {\r\n                // Set style property\r\n                var priority = typeof priority != 'undefined' ? priority : '';\r\n                // Hack to IE8\r\n                if (style.setProperty) {\r\n                    style.setProperty(styleName, value, priority);\r\n                } else {\r\n                    style.setAttribute(styleName, value, priority);\r\n                }\r\n            } else {\r\n                // Get style property\r\n\r\n                return style.getPropertyValue(styleName);\r\n            }\r\n        } else {\r\n            // Get CSSStyleDeclaration\r\n            return style;\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.nl2br = function (value) {\r\n        return value.replace(/(\\r\\n|\\n\\r|\\r|\\n|\\\\r\\\\n|\\\\n\\\\r|\\\\r|\\\\n)/g, \"<br>\");\r\n    };\r\n})(jQuery);\r\n\r\n\r\n\r\n(function ($) {\r\n    jQuery.br2nl = function (value) {\r\n        return value.replace(/\\r\\n|\\r|\\n/g, \"\\r\");\r\n    };\r\n})(jQuery);\r\n\r\n/**\r\n *   Can be compare control between their intance value and existing value\r\n */\r\n//TODO: DEPL- Please move this out of here, this is rendering logic, it must exists as a function for the render, and every erender could override its implementation\r\n(function ($) {\r\n    jQuery.controlValueIsChanged = function (control) {\r\n        var self = control;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (control.properties.type == \"grid\" && control.ready().state() == \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\", \"radio\", \"queryRadio\", \"queryState\", ].includes(properties.type) || /^cascadingcombo$/i.test(properties.type)) {\r\n            if (value && value.length !== undefined)\r\n                value = value[0];\r\n            if (compareValue && compareValue.length !== undefined)\r\n                compareValue = compareValue[0];\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            result = (compareValue == value) ? false : true;\r\n        } else if (properties.type == \"boolean\" || properties.type == \"queryBoolean\" || properties.type == \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (properties.type == \"searchNumber\") {\r\n\r\n            result = (value) ? true : false;\r\n        } else if (properties.type === \"date\") {\r\n            result = (new Date(compareValue).getTime()) !== (new Date(value).getTime());\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.getMaxZindex = function () {\r\n        var elm = $(\"*\");\r\n        var maxZindex = 1;\r\n\r\n        $.each(elm, function (key, value) {\r\n            var zindex = parseInt($(value).css(\"z-index\"));\r\n            if (zindex > maxZindex) {\r\n                maxZindex = zindex + 1;\r\n            }\r\n\r\n        });\r\n\r\n        return maxZindex;\r\n    }\r\n})(jQuery);\r\n\r\n/**\r\n * Set the same max height to multiples divs\r\n */\r\n(function ($) {\r\n    jQuery.equalizeHeights = function (selector) {\r\n        var heights = new Array();\r\n        // Loop to get all element heights\r\n        $(selector).each(function () {\r\n\r\n            // Need to let sizes be whatever they want so no overflow on resize\r\n            $(this).css('min-height', '0');\r\n            $(this).css('max-height', 'none');\r\n            $(this).css('height', 'auto');\r\n\r\n            // Then add size (no units) to array\r\n            heights.push($(this).outerHeight());\r\n        });\r\n\r\n        // Find max height of all elements\r\n        var max = Math.max.apply(Math, heights);\r\n\r\n        // Set all heights to max height\r\n        $(selector).each(function () {\r\n            $(this).css('height', max + 'px');\r\n        });\r\n    }\r\n})(jQuery);\r\n\r\n//TODO: DEPL - Move this to rendering\r\nbizagi.util.autoSave = function () {\r\n    var deferredSave = $.Deferred();\r\n\r\n    //if attr data-event exist trigger event auto-save or resolve the deferred\r\n    if (bizagi.util.detectDevice() !== \"desktop\") {\r\n        if ($(document).data('auto-save')) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    } else {\r\n        if ($._data($(document)[0], 'events')[\"save-form\"] && $._data($(document)[0], 'events')[\"save-form\"].length > 0) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    }\r\n    return deferredSave.promise();\r\n};\r\n//--  **Users Deleted** the name will fill on first reques in UsersPictures\r\nbizagi.util.anonymizedUserInformation = {\r\n    id: \"00000000-0000-0000-0000-000000000000\",\r\n    name: \"\",\r\n    username: \"\",\r\n    email: \"\",\r\n    domain: \"\",\r\n    picture: \"\",\r\n    isAnonymized: true\r\n};\r\n\r\n//-- **Resources for date picker**\r\nbizagi.util.datepickerResource=[];\r\n// taken  from https://github.com/jquery/jquery-ui/tree/master/ui/i18n\r\nbizagi.util.datepickerResource[\"en\"]={ closeText: \"Done\", prevText: \"Prev\",nextText: \"Next\",currentText: \"Today\",monthNames: [ \"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\" ],monthNamesShort: [ \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\" ],dayNames: [ \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\" ],dayNamesShort: [ \"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\" ],dayNamesMin: [ \"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\" ],weekHeader: \"Wk\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"es\"]={ closeText: \"Cerrar\", prevText: \"&#x3C;Ant\",nextText: \"Sig&#x3E;\",currentText: \"Hoy\",monthNames: [ \"enero\",\"febrero\",\"marzo\",\"abril\",\"mayo\",\"junio\",\"julio\",\"agosto\",\"septiembre\",\"octubre\",\"noviembre\",\"diciembre\" ],monthNamesShort: [ \"ene\",\"feb\",\"mar\",\"abr\",\"may\",\"jun\",\"jul\",\"ago\",\"sep\",\"oct\",\"nov\",\"dic\" ],dayNames: [ \"domingo\",\"lunes\",\"martes\",\"miércoles\",\"jueves\",\"viernes\",\"sábado\" ],dayNamesShort: [ \"dom\",\"lun\",\"mar\",\"mié\",\"jue\",\"vie\",\"sáb\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"X\",\"J\",\"V\",\"S\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ar\"]={ closeText: \"إغلاق\", prevText: \"&#x3C;السابق\",nextText: \"التالي&#x3E;\",currentText: \"اليوم\",monthNames: [ \"يناير\", \"فبراير\", \"مارس\", \"أبريل\", \"مايو\", \"يونيو\",\"يوليو\", \"أغسطس\", \"سبتمبر\", \"أكتوبر\", \"نوفمبر\", \"ديسمبر\" ],monthNamesShort: [ \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\" ],dayNames: [ \"الأحد\", \"الاثنين\", \"الثلاثاء\", \"الأربعاء\", \"الخميس\", \"الجمعة\", \"السبت\" ],dayNamesShort: [ \"أحد\", \"اثنين\", \"ثلاثاء\", \"أربعاء\", \"خميس\", \"جمعة\", \"سبت\" ],dayNamesMin: [ \"ح\", \"ن\", \"ث\", \"ر\", \"خ\", \"ج\", \"س\" ],weekHeader: \"أسبوع\",dateFormat: \"dd/mm/yy\",firstDay: 0,isRTL: true,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"cs\"]={ closeText: \"Zavřít\", prevText: \"&#x3C;Dříve\",nextText: \"Později&#x3E;\",currentText: \"Nyní\",monthNames: [ \"leden\",\"únor\",\"březen\",\"duben\",\"květen\",\"červen\",\"červenec\",\"srpen\",\"září\",\"říjen\",\"listopad\",\"prosinec\" ],monthNamesShort: [ \"led\",\"úno\",\"bře\",\"dub\",\"kvě\",\"čer\",\"čvc\",\"srp\",\"zář\",\"říj\",\"lis\",\"pro\" ],dayNames: [ \"neděle\", \"pondělí\", \"úterý\", \"středa\", \"čtvrtek\", \"pátek\", \"sobota\" ],dayNamesShort: [ \"ne\", \"po\", \"út\", \"st\", \"čt\", \"pá\", \"so\" ],dayNamesMin: [ \"ne\",\"po\",\"út\",\"st\",\"čt\",\"pá\",\"so\" ],weekHeader: \"Týd\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"de\"]={ closeText: \"Schließen\", prevText: \"&#x3C;Zurück\",nextText: \"Vor&#x3E;\",currentText: \"Heute\",monthNames: [ \"Januar\",\"Februar\",\"März\",\"April\",\"Mai\",\"Juni\",\"Juli\",\"August\",\"September\",\"Oktober\",\"November\",\"Dezember\" ],monthNamesShort: [ \"Jan\",\"Feb\",\"Mär\",\"Apr\",\"Mai\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Okt\",\"Nov\",\"Dez\" ],dayNames: [ \"Sonntag\",\"Montag\",\"Dienstag\",\"Mittwoch\",\"Donnerstag\",\"Freitag\",\"Samstag\" ],dayNamesShort: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],dayNamesMin: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],weekHeader: \"KW\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"fr\"]={ closeText: \"Fermer\", prevText: \"Précédent\",nextText: \"Suivant\",currentText: \"Aujourd'hui\",monthNames: [ \"janvier\", \"février\", \"mars\", \"avril\", \"mai\", \"juin\",\"juillet\", \"août\", \"septembre\", \"octobre\", \"novembre\", \"décembre\" ],monthNamesShort: [ \"janv.\", \"févr.\", \"mars\", \"avr.\", \"mai\", \"juin\", \"juil.\", \"août\", \"sept.\", \"oct.\", \"nov.\", \"déc.\" ],dayNames: [ \"dimanche\", \"lundi\", \"mardi\", \"mercredi\", \"jeudi\", \"vendredi\", \"samedi\" ],dayNamesShort: [ \"dim.\", \"lun.\", \"mar.\", \"mer.\", \"jeu.\", \"ven.\", \"sam.\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"M\",\"J\",\"V\",\"S\" ],weekHeader: \"Sem.\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"it\"]={ closeText: \"Chiudi\", prevText: \"&#x3C;Prec\",nextText: \"Succ&#x3E;\",currentText: \"Oggi\",monthNames: [ \"Gennaio\",\"Febbraio\",\"Marzo\",\"Aprile\",\"Maggio\",\"Giugno\",\"Luglio\",\"Agosto\",\"Settembre\",\"Ottobre\",\"Novembre\",\"Dicembre\" ],monthNamesShort: [ \"Gen\",\"Feb\",\"Mar\",\"Apr\",\"Mag\",\"Giu\",\"Lug\",\"Ago\",\"Set\",\"Ott\",\"Nov\",\"Dic\" ],dayNames: [ \"Domenica\",\"Lunedì\",\"Martedì\",\"Mercoledì\",\"Giovedì\",\"Venerdì\",\"Sabato\" ],dayNamesShort: [ \"Dom\",\"Lun\",\"Mar\",\"Mer\",\"Gio\",\"Ven\",\"Sab\" ],dayNamesMin: [ \"Do\",\"Lu\",\"Ma\",\"Me\",\"Gi\",\"Ve\",\"Sa\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ja\"]={ closeText: \"閉じる\", prevText: \"&#x3C;前\",nextText: \"次&#x3E;\",currentText: \"今日\",monthNames: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],monthNamesShort: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],dayNames: [ \"日曜日\",\"月曜日\",\"火曜日\",\"水曜日\",\"木曜日\",\"金曜日\",\"土曜日\" ],dayNamesShort: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],dayNamesMin: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],weekHeader: \"週\",dateFormat: \"yy/mm/dd\",firstDay: 0,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\nbizagi.util.datepickerResource[\"nl\"]={ closeText: \"Sluiten\", prevText: \"←\",nextText: \"→\",currentText: \"Vandaag\",monthNames: [ \"januari\", \"februari\", \"maart\", \"april\", \"mei\", \"juni\",\"juli\", \"augustus\", \"september\", \"oktober\", \"november\", \"december\" ],monthNamesShort: [ \"jan\", \"feb\", \"mrt\", \"apr\", \"mei\", \"jun\",\"jul\", \"aug\", \"sep\", \"okt\", \"nov\", \"dec\" ],dayNames: [ \"zondag\", \"maandag\", \"dinsdag\", \"woensdag\", \"donderdag\", \"vrijdag\", \"zaterdag\" ],dayNamesShort: [ \"zon\", \"maa\", \"din\", \"woe\", \"don\", \"vri\", \"zat\" ],dayNamesMin: [ \"zo\", \"ma\", \"di\", \"wo\", \"do\", \"vr\", \"za\" ],weekHeader: \"Wk\",dateFormat: \"dd-mm-yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"pt\"]={ closeText: \"Fechar\", prevText: \"Anterior\",nextText: \"Seguinte\",currentText: \"Hoje\",monthNames: [ \"Janeiro\",\"Fevereiro\",\"Março\",\"Abril\",\"Maio\",\"Junho\",\"Julho\",\"Agosto\",\"Setembro\",\"Outubro\",\"Novembro\",\"Dezembro\" ],monthNamesShort: [ \"Jan\",\"Fev\",\"Mar\",\"Abr\",\"Mai\",\"Jun\",\"Jul\",\"Ago\",\"Set\",\"Out\",\"Nov\",\"Dez\" ],dayNames: [\"Domingo\",\"Segunda-feira\",\"Terça-feira\",\"Quarta-feira\",\"Quinta-feira\",\"Sexta-feira\",\"Sábado\"],dayNamesShort: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],dayNamesMin: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],weekHeader: \"Sem\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ru\"]={ closeText: \"Закрыть\", prevText: \"&#x3C;Пред\",nextText: \"След&#x3E;\",currentText: \"Сегодня\",monthNames: [ \"Январь\",\"Февраль\",\"Март\",\"Апрель\",\"Май\",\"Июнь\",\"Июль\",\"Август\",\"Сентябрь\",\"Октябрь\",\"Ноябрь\",\"Декабрь\" ],monthNamesShort: [ \"Янв\",\"Фев\",\"Мар\",\"Апр\",\"Май\",\"Июн\",\"Июл\",\"Авг\",\"Сен\",\"Окт\",\"Ноя\",\"Дек\" ],dayNames: [ \"воскресенье\",\"понедельник\",\"вторник\",\"среда\",\"четверг\",\"пятница\",\"суббота\" ],dayNamesShort: [ \"вск\",\"пнд\",\"втр\",\"срд\",\"чтв\",\"птн\",\"сбт\" ],dayNamesMin: [ \"Вс\",\"Пн\",\"Вт\",\"Ср\",\"Чт\",\"Пт\",\"Сб\" ],weekHeader: \"Нед\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"zh\"]={ closeText: \"关闭\", prevText: \"&#x3C;上月\",nextText: \"下月&#x3E;\",currentText: \"今天\",monthNames: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],monthNamesShort: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],dayNames: [ \"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\" ],dayNamesShort: [ \"周日\",\"周一\",\"周二\",\"周三\",\"周四\",\"周五\",\"周六\" ],dayNamesMin: [ \"日\",\"一\",\"二\",\"三\",\"四\",\"五\",\"六\" ],weekHeader: \"周\",dateFormat: \"yy-mm-dd\",firstDay: 1,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\n\r\n//--  **Communication between Workportal and LiveProcesses**\r\n\r\n// Create new Live Process\r\nbizagi.util.liveProcessesEvents = bizagi.util.liveProcessesEvents || {};\r\nbizagi.util.liveProcessesEvents.newLiveProcess = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.newLiveProcess.initEvent('new-live-process', true, true);\r\n\r\n// Event for changing route inside LiveProcesses\r\nbizagi.util.liveProcessesEvents.routeEvents = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.routeEvents.initEvent('parent-route-events', true, true);\r\nbizagi.util.liveProcessesEvents.routeEvents.route = '/';\r\n\r\n// Verify save condition\r\nbizagi.util.liveProcessesEvents.saveEvent = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.saveEvent.initEvent('save-live', true, true);\r\nbizagi.util.liveProcessesEvents.saveEvent.lastWidget = '';\r\nbizagi.util.liveProcessesEvents.saveEvent.nextWidget = '';\r\n\r\nbizagi.util.liveSave = function (widgetName) {\r\n    bizagi.util.liveProcessesEvents.saveEvent.nextWidget = widgetName;\r\n    var deferredLiveSave = $.Deferred();\r\n    var indeX = 0;\r\n    // next try/catch avoids crossdomain messages in the middle of \"Next button\" execution\r\n    try {\r\n        indeX = $(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess');\r\n    }\r\n    catch (e) {\r\n        indeX = -1;\r\n    }\r\n    if (\r\n        (widgetName !== bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY || widgetName === bizagi.util.liveProcessesEvents.saveEvent.lastWidget) &&\r\n        $(document).find('iframe').length > 0 && (indeX > 0)\r\n    ) {\r\n        bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise = deferredLiveSave;\r\n        document.dispatchEvent(bizagi.util.liveProcessesEvents.saveEvent);\r\n    } else {\r\n        deferredLiveSave.resolve();\r\n    }\r\n    $.when(deferredLiveSave).done(function () { bizagi.util.liveProcessesEvents.saveEvent.lastWidget = widgetName })\r\n    return deferredLiveSave.promise();\r\n};\r\n\r\n/**\r\n * CryptoJS MD5\r\n * @param {} message\r\n * @returns {}\r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */\r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n/**\r\n * Replace all coincidences in a text, based on key value object\r\n *  @argument mapDataToReplace = {\"keyTofind\":\"valueToReplace\",...}\r\n */\r\nbizagi.util.multiReplace = function (text, mapDataToReplace) {\r\n    mapDataToReplace = mapDataToReplace || {};\r\n\r\n    for (var key in mapDataToReplace) {\r\n        var reg = new RegExp(key, \"g\");\r\n        text = text.replace(reg, mapDataToReplace[key]);\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Creates a replace all method that is left from the String Class\r\n */\r\nbizagi.util.replaceAll = function (text, pcFrom, pcTo) {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.replaceAll(text, pcFrom, pcTo);\r\n};\r\n/*\r\n *replaces global expressions regulars\r\n */\r\nbizagi.util.replaceAllGlobalRegExp = function (text, pcFrom, pcTo) {\r\n    var temp = text;\r\n\r\n    var re = new RegExp(pcFrom, \"g\");\r\n    temp = temp.replace(re, pcTo);\r\n\r\n    return temp.toString();\r\n};\r\n// Also append it to the string class\r\nString.prototype.replaceAll = function (pcFrom, pcTo) {\r\n    return bizagi.util.replaceAll(this, pcFrom, pcTo);\r\n};\r\n// Capitalize a string\r\nString.prototype.capitalize = function () {\r\n    return this.charAt(0).toUpperCase() + this.slice(1);\r\n};\r\n// Add this (Create an starts with function) to the string prototype\r\nString.prototype.startsWith = function (str) {\r\n    return this.slice(0, str.length) == str;\r\n};\r\n\r\n/**\r\n * get Initials of a string/name and if the name is empty return the anonymized icon\r\n */\r\nString.prototype.getInitials = function () {\r\n    var initials = \"\";\r\n    if (this.length===0) {\r\n        initials = '<svg  class=\"bz-icon bz-icon-24 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#icon-user-deactivated\"></use></svg>';\r\n    } else {\r\n        try {\r\n            var removeRepeatSpaces = this.replace(/  +/g, ' ');\r\n            var words = removeRepeatSpaces.split(' ');\r\n            for (var i = 0; i < words.length; i += 1) {\r\n                initials += words[i][0] || '';\r\n                if (initials.length == 2) {\r\n                    break;\r\n                }\r\n            }\r\n        } catch (e) { }\r\n    \r\n        initials = initials.toUpperCase();\r\n    }\r\n    return initials;\r\n};\r\n\r\nMath.sign = Math.sign || function (x) {\r\n    x = +x; // convert to a number\r\n    if (x === 0 || isNaN(x)) {\r\n        return x;\r\n    }\r\n    return x > 0 ? 1 : -1;\r\n}\r\n\r\n// Add a clone to the object prototype\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n// Measures the pixel size of a string\r\nbizagi.measureString = function (string, fontSize) {\r\n    var test = $(\"<span/>\").appendTo(\"body\");\r\n    test.text(string);\r\n    if (fontSize)\r\n        test.css(\"font-size\", fontSize);\r\n    var width = test.width();\r\n    test.detach();\r\n    return width;\r\n};\r\n/*\r\n *   Creates a trim method\r\n */\r\nbizagi.util.trim = function (text) {\r\n    if (typeof (text) === \"undefined\" || text == null)\r\n        return text;\r\n    // Call the method located in bizagi.loader\r\n    return text.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n};\r\n// Create an ends with function\r\nString.prototype.endsWith = function (suffix) {\r\n    return this.indexOf(suffix, this.length - suffix.length) !== -1;\r\n};\r\n\r\n/*\r\n * Method to detect IE7 visitors\r\n */\r\nbizagi.util.isIE7 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 7;\r\n};\r\n/*\r\n * Method to detect IE8 visitors\r\n */\r\nbizagi.util.isIE8 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 8;\r\n};\r\n/*\r\n * Method to detect IE9 visitors\r\n */\r\nbizagi.util.isIE9 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 9;\r\n};\r\n/*\r\n * Method to detect IE10 visitors\r\n */\r\nbizagi.util.isIE10 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 10;\r\n};\r\n/*\r\n * Method to detect IE11 visitors\r\n */\r\nbizagi.util.isIE11 = function () {\r\n    return !!navigator.userAgent.match(/Trident\\/7.0/) && !navigator.userAgent.match(/MSIE/i);\r\n};\r\n\r\n/*\r\n * Method to detect IE11 or lower\r\n */\r\nbizagi.util.isIE11OrLower = function () {\r\n    return bizagi.util.isIE11() || bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE10 or lower\r\n */\r\nbizagi.util.isIE10OrLower = function () {\r\n    return bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE12 or Edge(Windows 10) visitors\r\n */\r\nbizagi.util.isEdge = function () {\r\n    if (/Edge\\/*./i.test(navigator.userAgent)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n/*\r\n * Method to detect IE visitors\r\n */\r\nbizagi.util.isIE = function () {\r\n    return (navigator.appName.indexOf(\"Internet Explorer\") > 0 || !!navigator.userAgent.match(/Trident/));\r\n};\r\n/*\r\n * Get the specific version of IE \r\n */\r\nbizagi.util.getIEVersion = function () {\r\n    var sAgent = window.navigator.userAgent;\r\n    var indexMSIE = sAgent.indexOf(\"MSIE\");\r\n    var version = 0;\r\n    if (indexMSIE > 0) {\r\n        version = parseInt(sAgent.substring(indexMSIE + 5, sAgent.indexOf(\".\", indexMSIE)));\r\n    } else\r\n        if (!!navigator.userAgent.match(/Trident/) || window.navigator.userAgent.indexOf(\"Edge\") > -1) { // Condition Check IF IE 11 and or MS Edge\r\n            version = 11;\r\n        }\r\n    return version;\r\n};\r\n/*\r\n * Method to detect is chrome browser\r\n */\r\nbizagi.util.isChrome = function () {\r\n    return /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\r\n};\r\n/*\r\n * Method to detect is Firefox browser\r\n */\r\nbizagi.util.isFirefox = function(minVersion) {\r\n    function getVersion() {\r\n        var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || []; \r\n        if(/trident/i.test(M[1])){\r\n            tem=/\\brv[ :]+(\\d+)/g.exec(ua) || []; \r\n            return {name:'IE',version:(tem[1]||'')};\r\n            }   \r\n        if(M[1]==='Chrome'){\r\n            tem=ua.match(/\\bOPR|Edge\\/(\\d+)/)\r\n            if(tem!=null)   {return {name:'Opera', version:tem[1]};}\r\n            }   \r\n        M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];\r\n        if((tem=ua.match(/version\\/(\\d+)/i))!=null) {M.splice(1,1,tem[1]);}\r\n        return {\r\n          name: M[0],\r\n          version: M[1]\r\n        };   \r\n    }\r\n    return /Firefox/.test(navigator.userAgent) && (minVersion===undefined || minVersion<=getVersion().version);\r\n};\r\n/*\r\n * return the browser name this function can be modified if needs more browsers\r\n */\r\nbizagi.util.getBrowser = function() {\r\n    var bw=\"undetected\";\r\n    if(bizagi.util.isChrome()){\r\n        bw=\"chrome\";\r\n    }else if(bizagi.util.isFirefox()){\r\n        bw=\"firefox\";\r\n    }else if(bizagi.util.isEdge()){\r\n        bw=\"edge\";\r\n    }else if(bizagi.util.isIE11()){\r\n        bw=\"ie11\";\r\n    \r\n    }else if(bizagi.util.isIE10()){\r\n        bw=\"ie10\";\r\n    }\r\n    return bw;\r\n};\r\n\r\n/**\r\n * Empty Navigator Info\r\n */\r\nbizagi.util.emptyNavigatorInfo = function() {\r\n    if (bizagi.navigator && bizagi.navigator.info) {\r\n        bizagi.navigator.info={};\r\n    }\r\n};\r\n\r\n/**\r\n * Auto call setting the browser class for css specific selectors, etc..\r\n */\r\n$( document ).ready(function() {\r\n    $(\"html\").addClass(\"browser-\"+bizagi.util.getBrowser());\r\n    if (bizagi.language) {\r\n        var language=bizagi.language.split(\"-\");\r\n        if (language && language.length>0) {\r\n            $(\"html\").addClass(\"language-\"+language[0]);\r\n        }\r\n    }\r\n  });\r\n\r\n\r\n\r\n\r\n/**\r\n * Method to detect iOS version X and apply styles to that device \r\n */\r\nbizagi.util.setIphoneXOverrides = function () {\r\n    if (bizagi.util.isNativePluginSupported() && typeof (bizagiapp.isIphoneX) !== 'undefined') {\r\n        bizagiapp.isIphoneX(function (value) {\r\n            var flagIphoneX = value;\r\n            var styleIphoneX = \".bz-menu-home .bz-menu-carousel .bz-menu-carousel-seat{padding:0 16px 16px}.bz-home-header .km-navbar{padding:35px 16px 5px}#menuHome .bz-home-header .km-navbar{padding:30px 3px 0}#menuHome .km-navbar .km-rightitem{font-size:19px;right:.4em;top:32px}#menuHome .km-navbar .km-leftitem{font-size:24px;left:0;top:25px}#taskFeed .km-navbar .km-rightitem{font-size:19px;top:25px;right:0}#taskFeed .km-navbar .km-leftitem{font-size:24px;top:20px;left:0}#homePortal #menuHome .km-view-title .km-buttongroup{margin-left:0;top:2px}.bz-render-header,.search-container{padding-top:25px}#activity-search,.search-container .bz-wp-mu-button-search{padding-top:40px}#content-newCase-drawer{padding-top:25px}#menuHome{background:#EBEDF1!important}.km-flat .km-content{background-color:#fff} .k-loading-mask{top:0!important}\";\r\n\r\n            if (flagIphoneX === 'true') {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneXStyle\"></style>');\r\n                $('#iphoneXStyle').text(styleIphoneX);\r\n\r\n            } else if (bizagi.util.isiOSDevice()) {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneStyle\"></style>');\r\n                var paddingStyle = \"#homePortal .bz-home-header > div{padding-top:.8em}\";\r\n                $('#iphoneStyle').text(paddingStyle);\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isObject = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Object]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Array.isArray(value);\r\n};\r\nbizagi.util.isNull = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Null]\";\r\n};\r\nbizagi.util.isBoolean = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Boolean]\";\r\n};\r\n\r\n/*\r\n *   Method to detect IE version\r\n */\r\nbizagi.util.getInternetExplorerVersion = function () {\r\n    if (!bizagi.util.isIE())\r\n        return -1;\r\n    return Number(document.documentMode);\r\n};\r\n/*  \r\n *   Detect a device based on the width\r\n */\r\nbizagi.util.detectDevice = function () {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.detectDevice();\r\n};\r\n\r\n// Check if a string is number\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n// Check if a string is GUID\r\nbizagi.util.isGUID = function (n) {\r\n    return /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n);\r\n};\r\n// Throw not implemented exception\r\nbizagi.util.mustImplement = function (notImplementedMethod) {\r\n    try {\r\n        console.log(\"Not implemented exception: \" + notImplementedMethod);\r\n    } catch (exe) { //IE console variable not exist\r\n    }\r\n    //throw \"You must implement \" + notImplementedMethod;\r\n};\r\n// Encodes the xpath \r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath) || typeof xpath.replaceAll === \"undefined\")\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n// Parses a value to return the correct boolean value\r\nbizagi.util.parseBoolean = function (value) {\r\n    if (value === undefined) {\r\n        return null;\r\n    }\r\n\r\n    if (value === null) {\r\n        return null;\r\n    }\r\n\r\n    if (value === '') {\r\n        return null;\r\n    }\r\n\r\n    // Parse true values\r\n    if (value === true || value === 1 || value.toString() === \"true\" || value === \"1\") {\r\n        return true;\r\n    }\r\n    if (value.toString().toLowerCase() === \"true\") {\r\n        return true;\r\n    }\r\n\r\n    // Parse false values\r\n    if ((value !== null && value === false) || value === 0 || value.toString() === \"false\" || value === \"0\") {\r\n        return false;\r\n    }\r\n    if (value.toString().toLowerCase() === \"false\") {\r\n        return false;\r\n    }\r\n\r\n    return null;\r\n};\r\n/*\r\n *   Checks if a given string is empty\r\n */\r\nbizagi.util.isEmpty = function (value) {\r\n    if (value === 0)\r\n        return false;\r\n\r\n    if (value === undefined || value === null || value === \"\") {\r\n        return true;\r\n    }\r\n\r\n    if (typeof (value) === \"Array\") {\r\n        return value.length == 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") {\r\n        return value.length === 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        if ($.isEmptyObject(value)) {\r\n            return true;\r\n        } else {\r\n            return bizagi.util.isEmptyCombo(value);\r\n        }\r\n    }\r\n\r\n    // Side effect - I can't delete the last item in the multiselect and searchlist\r\n   /* if (value == \"{\\\"value\\\":[]}\"){\r\n        return true;\r\n    }  */\r\n\r\n    return false;\r\n};\r\n\r\nbizagi.util.isEmptyCombo = function (object) {\r\n    if (Object.prototype.toString.apply(object) === \"[object Object]\") {\r\n        var property, id = false,\r\n            value = false,\r\n            other = false;\r\n        for (property in object) {\r\n            if (object.hasOwnProperty(property)) {\r\n                if (property === \"id\") {\r\n                    id = true;\r\n                } else {\r\n                    if (property === \"value\") {\r\n                        value = true;\r\n                    } else {\r\n                        other = true;\r\n                    }\r\n                }\r\n                if (other) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        if (id) {\r\n            if (object[\"id\"] === \"\") {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * Decode data from encodeURI charset\r\n */\r\nbizagi.util.decodeURI = function (value) {\r\n    value = value || \"\";\r\n    var finishDecoded = false;\r\n    var decodedValue = value;\r\n    var infinityControl;\r\n\r\n    // Try to decode data value\r\n    while (!finishDecoded) {\r\n        try {\r\n            infinityControl = decodeURI(decodedValue);\r\n            if (bizagi.util.hasNonVisibleChars(infinityControl)) {\r\n                decodedValue = value;\r\n                break;\r\n            }\r\n            if (infinityControl == decodedValue) {\r\n                finishDecoded = true;\r\n            } else {\r\n                decodedValue = infinityControl;\r\n            }\r\n        } catch (e) {\r\n            finishDecoded = true;\r\n        }\r\n    }\r\n\r\n    return decodedValue;\r\n};\r\n\r\nbizagi.util.hasNonVisibleChars = function (value) {\r\n    value = value || \"\";\r\n    var length = value.length;\r\n    var i = 0,\r\n        result = false,\r\n        ch;\r\n    for (; i < length;) {\r\n        ch = value.charCodeAt(i++);\r\n        if (ch < 32 || ch > 126) {\r\n            result = true;\r\n            break;\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\n/* \r\n *   Converts a percent into a number\r\n */\r\nbizagi.util.percent2Number = function (value) {\r\n    return Number(String(value).replace(\"%\", \"\"));\r\n};\r\n/*\r\n *   Check if a object is empty\r\n */\r\nbizagi.util.isObjectEmpty = function (obj) {\r\n    if (obj.length > 0)\r\n        return false;\r\n    return true;\r\n};\r\n/*\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n/*\r\n *   Replaces a matched selector in the container for the specified \"replace\" element\r\n */\r\nbizagi.util.replaceSelector = function (container, selector, replace) {\r\n    // Replace children tag\r\n    var elementToReplace = $(selector, container);\r\n    if (elementToReplace.length > 0) {\r\n        elementToReplace.append(replace);\r\n        elementToReplace.children().unwrap();\r\n    }\r\n};\r\n/*\r\n *   Determines if a control as a scrollbar \r\n */\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n//TODO: DEPL - Rename this to areIdenticalObjects\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n/*\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\nbizagi.util.centerElementIntoScroll = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var actualScroll = layout.scrollTop();\r\n    var elementTop = $(elem).offset().top;\r\n    var elementHeight = $(elem).height();\r\n    var offset = 0;\r\n    if (elementTop > 0) {\r\n        offset = elementTop + elementHeight;\r\n    } else {\r\n        offset = elementTop - elementHeight;\r\n    }\r\n    var newTop = actualScroll + offset;\r\n    layout.scrollTop(newTop);\r\n};\r\n/*\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/*\r\n *   Encode a string as HTML\r\n */\r\nbizagi.util.decodeHtmlEntities = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&apos;/g, '\"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\\'');\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Read the location hash\r\n */\r\nbizagi.util.getHashParams = function () {\r\n    var params = window.location.hash.substring(1).split(\"#\");\r\n    return params;\r\n};\r\n/*\r\n *   Loads a file on-demand\r\n */\r\nbizagi.util.loadFile = function (params) {\r\n    var defer = new $.Deferred();\r\n    var url = params && params.src ? params.src : params;\r\n    var type = params && params.type ? params.type : null;\r\n\r\n    bizagi.loader.loadFile({ src: url, type: type })\r\n        .then(function () {\r\n            defer.resolve();\r\n        });\r\n\r\n    return defer.promise();\r\n};\r\n\r\n/*\r\n *   Initializes a webpart on-demand\r\n */\r\nbizagi.util.initWebpart = function (webpart, device) {\r\n    var defer = new $.Deferred();\r\n\r\n    device = device || bizagi.detectDevice();\r\n\r\n    if (webpart.initialized) {\r\n        // If already initialized resolve the deferred\r\n        defer.resolve();\r\n    } else {\r\n\r\n        if (webpart.initializing) {\r\n            $.when(webpart.loadingDeferred.promise())\r\n                .done(function () {\r\n                    defer.resolve();\r\n                });\r\n        } else {\r\n\r\n            webpart.loadingDeferred = new $.Deferred();\r\n            webpart.initializing = true;\r\n            bizagi.loader.initWebpart(webpart, device, function () {\r\n\r\n                // Resolve deferreds\r\n                webpart.loadingDeferred.resolve();\r\n                webpart.initializing = false;\r\n                defer.resolve();\r\n            });\r\n        }\r\n    }\r\n\r\n    return defer.promise();\r\n};\r\n/*\r\n *   Read the query string parameteres\r\n */\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = pairs.length - 1; i >= 0; i--) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n/*\r\n *   Extend querystring\r\n */\r\nbizagi.util.extendQueryString = function (url, additionalParams) {\r\n    var plainUrl = url.indexOf(\"?\") > 0 ? url.substring(0, url.indexOf(\"?\")) : url;\r\n    var existingParams = bizagi.util.getQueryString(url);\r\n    var newParams = $.extend({}, existingParams, additionalParams);\r\n    return plainUrl + \"?\" + $.param(newParams);\r\n};\r\nbizagi.util.getStackTrace = function () {\r\n    var callstack = [];\r\n    var isCallstackPopulated = false;\r\n    try {\r\n        i.dont.exist += 0; //doesn't exist- that's the point\r\n    } catch (e) {\r\n        if (e.stack) { //Firefox\r\n            var lines = e.stack.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    callstack.push(lines[i]);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        } else if (window.opera && e.message) { //Opera\r\n            var lines = e.message.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    var entry = lines[i];\r\n                    //Append next line also since it has the file info\r\n                    if (lines[i + 1]) {\r\n                        entry += ' at ' + lines[i + 1];\r\n                        i++;\r\n                    }\r\n                    callstack.push(entry);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        }\r\n    }\r\n    if (!isCallstackPopulated) { //IE and Safari\r\n        var currentFunction = arguments.callee.caller;\r\n        while (currentFunction) {\r\n            var fn = currentFunction.toString();\r\n            var fname = fn.substring(fn.indexOf(\"function\") + 8, fn.indexOf('')) || 'anonymous';\r\n            callstack.push(fname);\r\n            currentFunction = currentFunction.caller;\r\n        }\r\n    }\r\n    return callstack;\r\n};\r\n/*\r\n *\thighlight elements\r\n */\r\nbizagi.util.highLightElement = function (el) {\r\n    el.addClass('ui-highlight-control');\r\n    $.when(\r\n        setTimeout(function () {\r\n            el.addClass('ui-highlight-off-control');\r\n        }, 450)\r\n    ).done(\r\n        setTimeout(function () {\r\n            el.removeClass('ui-highlight-control ui-highlight-off-control');\r\n        }, 800));\r\n}\r\n/*\r\n *\tscroll to bottom\r\n */\r\nbizagi.util.autoScrollBottom = function (el) {\r\n    try {\r\n        var elScrollHeight;\r\n        elScrollHeight = el[0].scrollHeight;\r\n        el.scrollTop(elScrollHeight);\r\n    } catch (e) { }\r\n}\r\n\r\n/*create auto scroll with limit top and limit bottom */\r\nbizagi.util.autoScrollInterval = { init: false };\r\nbizagi.util.autoScroll = function (itemScroll, limitTop, limitBottom, idInterval) {\r\n    var outSide = false;\r\n    /* prevent a previous interval */\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval[idInterval] = 0;\r\n    bizagi.util.autoScrollInterval['init'] = true;\r\n    $('body').addClass('autoscroll');\r\n    $('body.autoscroll').mousemove(function (event) {\r\n        if (event.pageY < limitTop) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollTopInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else if (event.pageY > limitBottom) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollBottomInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else {\r\n            clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            outSide = false;\r\n        }\r\n    });\r\n}\r\n/*create auto scroll movement top */\r\nbizagi.util.autoScrollTopInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    if (itemScroll.scrollTop() == 0) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            if (itemScroll.scrollTop() > 0) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() - 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n/*create auto scroll movement bottom */\r\nbizagi.util.autoScrollBottomInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    var valueMaxScrollBottom = $(itemScroll)[0].scrollHeight - $(itemScroll).innerHeight();\r\n    if (itemScroll.scrollTop() >= valueMaxScrollBottom) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            bizagi.util.autoScrollBottom($('html'));\r\n            if (itemScroll.scrollTop() < valueMaxScrollBottom) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() + 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n};\r\n/*remove auto scroll*/\r\nbizagi.util.removeAutoScroll = function (classCSS, idInterval) {\r\n    $('body.' + classCSS).unbind('mousemove').removeClass(classCSS);\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval.init = false;\r\n};\r\n\r\nbizagi.util.getMaxZIndex = function (selector) {\r\n    selector = selector || $(\"div,span\");\r\n    return Math.max.apply(null, $(selector).map(function () {\r\n        var zIndex;\r\n        return isNaN(zIndex = parseInt($(this).css(\"z-index\"), 10)) ? 0 : zIndex;\r\n    }));\r\n};\r\n\r\n/*\r\n * Creates a native popup to open an url\r\n */\r\nbizagi.showPopup = function (url, params, callbackFn) {\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(url, \"\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    // Define args to call the function\r\n    window.BAPopupWindow = newWindow;\r\n    window.BAPopupCallback = callbackFn;\r\n    // Define BACLoseWindow in this context, so the external content calls window.opener.BACloseWindow\r\n    window.BACloseWindow = function (controls, submitForm) {\r\n        // Close dialog\r\n        window.BAPopupWindow.close();\r\n        // Executes the callback to assign values and submit form (if requested)\r\n        window.BAPopupCallback(controls, submitForm);\r\n    };\r\n};\r\n/**\r\n * Creates a native popup in quirks mode to open an url\r\n * \r\n * @param url string page to open into popup\r\n * @param params json {width,height,title,afterLoad}\r\n */\r\nbizagi.showQuirksModePopup = function (url, params) {\r\n    var quirksModePage = window.BIZAGI_PATH_TO_BASE + \"quirks.html\";\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(quirksModePage, \"bizagiPopup\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    window.BAQuirksPopupWindow = newWindow;\r\n    // Attempto to set a window title\r\n    setTimeout(function () {\r\n        try {\r\n            newWindow.document.title = params.title;\r\n        } catch (e) { }\r\n    }, 50);\r\n    // We use a hack to eval content inside the popup\r\n    $(newWindow).callInsidePopup(function (windowParams) {\r\n\r\n        var $ = windowParams.jQuery;\r\n        var popupWindow = windowParams.popupWindow;\r\n        popupWindow.quirksOnLoad = function () {\r\n            var loadedBody = $(\"body\", popupWindow.document);\r\n            var iframe = $(\"iframe\", loadedBody);\r\n            // Remove waiting\r\n            loadedBody.removeClass(\"ui-bizagi-loading-message\");\r\n            iframe.show();\r\n            // Hacks the iframe\r\n            // This event will fire each time the iframe change its location\r\n            var afterLoad = windowParams.userParams.afterLoad;\r\n            if (afterLoad && afterLoad != null) {\r\n                var callbackParams = $.extend(windowParams.userParams, {\r\n                    popupWindow: popupWindow\r\n                });\r\n                iframe.callInside(afterLoad, callbackParams);\r\n            }\r\n        };\r\n        var loadingFunction = function () {\r\n            var body = $(\"body\", popupWindow.document);\r\n            // Create the iframe inside the new window\r\n            if (body.length > 0) {\r\n                body.append(\"<iframe scrolling='yes' id='innerFrameContent' src='\" + windowParams.url + \"' style='width: 100%; height: 100%; display:none' frameborder='0' onload='quirksOnLoad();'></iframe>\");\r\n            } else {\r\n                // Try again\r\n                setTimeout(function () {\r\n                    loadingFunction();\r\n                }, 50);\r\n            }\r\n        };\r\n        // Execute loading function\r\n        loadingFunction();\r\n    }, {\r\n            jQuery: $,\r\n            userParams: params,\r\n            popupWindow: newWindow,\r\n            url: url\r\n        });\r\n};\r\n/*\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n/*\r\n *   Creates a popup using overlay style\r\n */\r\nbizagi.createPopup = function (params) {\r\n    var popupName = params.name,\r\n        onClose = params.onClose,\r\n        popupHeader;\r\n    var popupTitle = (params.title) ? params.title : '';\r\n    var overlay = $('<div class=\"ui-widget-overlay ' + popupName + '-overlay\" />');\r\n    var popup = $('<div class=\"' + popupName + '-popup  ui-popup-modal\"/>').appendTo(overlay);\r\n    var closeButton = $('<div class=\"' + popupName + '-btn-close biz-btn-close\"><i class=\"biz-icon ui-close-btn bz-studio bz-black bz-false_16x16_black\"></i></div>').appendTo(popup);\r\n    if (params.title) {\r\n        popupHeader = $('<div class=\"' + popupName + '-popup-header ui-popup-header\" ><h3>' + popupTitle + '</h3></div>').appendTo(popup);\r\n    }\r\n\r\n    var popupContent = $('<div class=\"' + popupName + '-popup-content\" />').appendTo(popup);\r\n    // Add to body\r\n    popup.hide();\r\n    if (params.additionalClass)\r\n        popup.addClass(params.additionalClass);\r\n    var container = params.container || \"body\";\r\n    overlay.appendTo($(container, document));\r\n\r\n    if (params.center) {\r\n        // Resize popup to the center\r\n        popup.css(\"top\", (overlay.height() - popup.height()) / 2);\r\n        popup.css(\"left\", (overlay.width() - popup.width()) / 2);\r\n    }\r\n    popup.show();\r\n    // Close handler\r\n    var closeHandler = function (params) {\r\n        overlay.detach();\r\n        if (onClose)\r\n            onClose(params);\r\n    };\r\n    closeButton.click(closeHandler);\r\n    // Return a full independent object\r\n    return {\r\n        fullPopup: popup,\r\n        overlay: overlay,\r\n        content: popupContent,\r\n        close: function (params) {\r\n            closeHandler(params);\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an Ok, Cancel popup using bizagi.createPopup()\r\n */\r\n\r\nbizagi.createOkCancelPopup = function (params) {\r\n    params.name = \"popup-ok-cancel\";\r\n    var onOk = params.onOk,\r\n        onCancel = params.onCancel;\r\n    var popup = bizagi.createPopup(params);\r\n    var container = $(\"<div></div>\").addClass(\"container-okcancel-popup\");\r\n    var message = $(\"<div></div>\").addClass(\"message-okcancel-popup ui-light-bevel-border biz-gradient-v\");\r\n    var buttonsContainer = $(\"<div></div>\").addClass(\"buttonsContainer-okcancel-popup biz-actions-bar\");\r\n    message.text(params.message);\r\n    message.appendTo(container);\r\n    var buttonOk = $(\"<span></span>\").addClass(\"ok-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    var buttonCancel = $(\"<span></span>\").addClass(\"cancel-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    buttonOk.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-ok\"));\r\n    buttonCancel.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-cancel\"));\r\n    buttonOk.appendTo(buttonsContainer);\r\n    buttonCancel.appendTo(buttonsContainer);\r\n    buttonsContainer.appendTo(container);\r\n    container.appendTo(popup.content);\r\n    var okHandler = function () {\r\n        popup.close();\r\n        if (typeof (onOk) == \"function\") {\r\n            onOk();\r\n        }\r\n    };\r\n    buttonOk.click(okHandler);\r\n    var cancelHandler = function () {\r\n        popup.close();\r\n        if (typeof (onCancel) == \"function\") {\r\n            onCancel();\r\n        }\r\n    };\r\n    buttonCancel.click(cancelHandler);\r\n    return {\r\n        close: function () {\r\n            popup.close();\r\n        },\r\n        ok: function () {\r\n            okHandler();\r\n        },\r\n        cancel: function () {\r\n            cancelHandler();\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an generic dialog\r\n */\r\nbizagi.dialog = function (params) {\r\n\r\n    var dialog = $(\"<div></div>\").addClass(\"biz-dialog\");\r\n    var msg = $(\"<p></p>\");\r\n    msg.text(params.message || \"\");\r\n    msg.appendTo(dialog);\r\n    dialog.appendTo($(\"body\", document));\r\n    dialog.dialog({\r\n        title: params.title,\r\n        modal: true,\r\n        buttons: params.buttons,\r\n        close: function () {\r\n            dialog.dialog(\"destroy\");\r\n        }\r\n    });\r\n};\r\n/*\r\n *   Close the quirks mode popup window\r\n */\r\nbizagi.closeQuirksModePopup = function () {\r\n    var quirksPopup = window.BAQuirksPopupWindow;\r\n    window.BAQuirksPopupWindow = null;\r\n    try {\r\n        if (quirksPopup)\r\n            quirksPopup.close();\r\n    } catch (e) { }\r\n};\r\n/**\r\n * Get css class definition to string\r\n */\r\nbizagi.getStyle = function (style) {\r\n    var pathName = location.href.replace(\"/default.aspx\", \"\");\r\n    var getFontFace = (style.match(/@/)) ? true : false;\r\n    var matchFontFace = \"@font-face\";\r\n    var getAllChildrens = (style.match(/\\*/)) ? true : false;\r\n    var matchStyles = new RegExp(style.replace(\"*\", \"\"), \"g\");\r\n    var stringCss = \"\";\r\n    var css;\r\n    if (style == \"\") {\r\n        return \"\";\r\n    }\r\n    var awesomeBrowser = function (style) {\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].rules || document.styleSheets[file].cssRules;\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (document.styleSheets[file].href != null && (document.styleSheets[file].href.match(/less.css/g) == null || BIZAGI_ENVIRONMENT == \"release\")) {\r\n\r\n                        var cssTextOriginal = (css[key].cssText) ? css[key].cssText : '';\r\n                        // Get all matches\r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n\r\n                                if ($.browser.webkit) {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"\");\r\n                                } else if ($.browser.msie && $.browser.version == \"8.0\") {\r\n                                    stringCss += css[key].style.cssText;\r\n                                } else {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"../../jquery/workportal/css/desktop\");\r\n                                }\r\n                            }\r\n                        } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                            stringCss += css[key].cssText;\r\n                        }\r\n\r\n                        // Get @font-face\r\n                        if (getFontFace) {\r\n                            if (css[key] != undefined && cssTextOriginal != undefined) {\r\n                                if (cssTextOriginal.indexOf(matchFontFace) != -1) {\r\n\r\n                                    if ($.browser.webkit) {\r\n                                        stringCss += cssTextOriginal.replace(/jquery\\/workportal\\/css\\/desktop\\//g, \"\").replace(/\\(path\\)/g, \"\");\r\n                                    } else {\r\n                                        stringCss += cssTextOriginal.replace(/\\(path\\)/g, \"../../\");\r\n                                    }\r\n\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var suckBrowser = function (style) {\r\n        if ($.browser.version == \"8.0\") {\r\n            // That is crazy, but it has the same document.styleSheets structure to chrome and mozilla\r\n            return awesomeBrowser(style);\r\n        }\r\n        var lastLevel;\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].cssRules || document.styleSheets[file].rules;\r\n\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (BIZAGI_ENVIRONMENT == \"release\") {\r\n                        // Get all matches \r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    } else if (css[key].href != null && css[key].href != undefined && css[key].href.match(/less.css/g) == null) {\r\n                        // Get all matches \r\n                        lastLevel = css[key].styleSheet.cssRules || [];\r\n                        for (var n = 0; n < lastLevel.length; n++) {\r\n                            if (getAllChildrens) {\r\n                                if ((lastLevel[n].selectorText != undefined || lastLevel[n].selectorText != null) && lastLevel[n].selectorText.match(matchStyles) != null) {\r\n                                    //stringCss += lastLevel[n].cssText;\r\n                                    stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                                }\r\n                            } else if (lastLevel[n].selectorText != undefined && lastLevel[n].selectorText == style) {\r\n                                // stringCss += lastLevel[n].cssText;\r\n                                stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var result = ($.browser.msie) ? suckBrowser(style) : awesomeBrowser(style);\r\n    return result;\r\n};\r\n/**\r\n * Set and retrieve Cookie\r\n */\r\nbizagi.cookie = function (key, value, options) {\r\n    // key and at least value given, set cookie...\r\n    if (arguments.length > 1 && String(value) !== \"[object Object]\") {\r\n        options = $.extend({}, options);\r\n        if (value === null || value === undefined) {\r\n            options.expires = -1;\r\n        }\r\n\r\n        if (typeof options.expires === 'number') {\r\n            var days = options.expires,\r\n                t = options.expires = new Date();\r\n            t.setDate(t.getDate() + days);\r\n        }\r\n\r\n        value = String(value);\r\n        return (document.cookie = [\r\n            encodeURIComponent(key), '=',\r\n            options.raw ? value : encodeURIComponent(value),\r\n            options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\r\n            options.path ? '; path=' + options.path : '',\r\n            options.domain ? '; domain=' + options.domain : '',\r\n            options.secure ? '; secure' : ''\r\n        ].join(''));\r\n    }\r\n\r\n    // key and possibly options given, get cookie...\r\n    options = value || {};\r\n    var result, decode = options.raw ? function (s) {\r\n        return s;\r\n    } : decodeURIComponent;\r\n    return (result = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? decode(result[1]) : null;\r\n};\r\n/**\r\n * Returns a random integer between min and max\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n * Set global context values\r\n * @param params onject\r\n * @param reset boolean\r\n */\r\nbizagi.util.setContext = function (params, reset) {\r\n    params = params || {};\r\n    reset = reset || false;\r\n    if (reset) {\r\n        bizagi.context = {};\r\n    }\r\n    $.each(params, function (key, value) {\r\n        bizagi.context[key] = value;\r\n    });\r\n\r\n    // Fix camel case in idWorkItem Property\r\n    bizagi.context[\"idWorkItem\"] = bizagi.context[\"idWorkitem\"];\r\n};\r\n\r\nbizagi.util.reloadCSS = function () {\r\n    var queryString = '?reload=' + new Date().getTime();\r\n    $('link[rel=\"stylesheet\"]').each(function () {\r\n        this.href = this.href.replace(/\\?.*|$/, queryString);\r\n    });\r\n}\r\n\r\n/**\r\n * Control recursive calls of setTimeout\r\n * @param params json {name:name of call,call: function call}\r\n * @return void\r\n */\r\nbizagi.util.setInterval = function (params) {\r\n    var _name = params.name || 'default';\r\n    var _call = params.call || function () { };\r\n    var _params = params.params || {};\r\n    var _singleton = params.singleton || false;\r\n    var _timeOut = params.timeout || 5000;\r\n    var _maxIterations = params.iterations || 1000;\r\n    var _context = params.context || \"true;\";\r\n    // If callback its diferent to context, remove from hash\r\n    var _killWhenExitContext = (params.hasOwnProperty('killWhenExitContext')) ? params.killWhenExitContext : true;\r\n    bizagi.timeOut = bizagi.timeOut || {};\r\n    if (bizagi.timeOut[_name] == undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n    // Check if singleton (run once)\r\n    if (_singleton && bizagi.timeOut[_name] != undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n\r\n    bizagi.timeOut[_name].push({\r\n        name: _name,\r\n        params: _params,\r\n        call: _call,\r\n        singleton: _singleton,\r\n        timeOut: _timeOut,\r\n        iterations: 0,\r\n        maxIterations: _maxIterations,\r\n        context: _context,\r\n        killWhenExitContext: _killWhenExitContext,\r\n        itsRunning: false,\r\n        timeInit: Math.round((new Date()).getTime())\r\n    });\r\n    var executeTimeOut = function () {\r\n        $.each(bizagi.timeOut, function (k, v) {\r\n            $.each(v, function (key, value) {\r\n                var now = Math.round((new Date()).getTime());\r\n                var actualIterations = Math.round((now - value.timeInit) / value.timeOut);\r\n                bizagi.timeOut[value.name][key]['iterations'] = actualIterations;\r\n                if (actualIterations < value.maxIterations) {\r\n                    // Check context\t\t\t\t\t\r\n                    if (eval(value.context)) {\r\n                        if (!value.itsRunning) {\r\n                            if (value.params)\r\n                                // Create a virtual function to IE\r\n                                if ($.browser.msie) {\r\n                                    var ieFunction = function () {\r\n                                        return value.call(value.params);\r\n                                    };\r\n                                }\r\n\r\n                            bizagi.timeOut[value.name][key]['pointer'] = ($.browser.msie) ? setInterval(ieFunction, value.timeOut, 'JavaScript') : setInterval(value.call, value.timeOut, value.params);\r\n                            bizagi.timeOut[value.name][key]['itsRunning'] = true;\r\n                        }\r\n                    } else if (value.killWhenExitContext) {\r\n                        bizagi.timeOut[value.name].splice(key, 1);\r\n                        clearTimeout(value.pointer);\r\n                    } else {\r\n                        bizagi.timeOut[value.name][key]['itsRunning'] = false;\r\n                        clearTimeout(value.pointer);\r\n                    }\r\n                } else {\r\n                    // Cancel timeout and remove call from hash\r\n                    clearTimeout(value.pointer);\r\n                    bizagi.timeOut[value.name].splice(key, 1);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    if (!bizagi.timeOutRunning) {\r\n        bizagi.timeOutRunning = true;\r\n        setInterval(executeTimeOut, 1000);\r\n    }\r\n};\r\nbizagi.util.isDate = function (value) {\r\n    // type A) dd/mm/aaaa \r\n    // type B) aaaa/mm/dd\r\n    // type C) aa/mm/dd\r\n\r\n    var dateRegEx_typeA = /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/,\r\n        dateRegEx_typeB = /^\\d{4}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        dateRegEx_typeC = /^\\d{1,2}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        timeRegEx = /^\\d{1,2}:\\d{2}(:\\d{2})?(\\s[aApP][mM])?$/,\r\n        result = false,\r\n        resultDate = false,\r\n        hasTime = false,\r\n        resultTime = false;\r\n\r\n    value = value || '';\r\n\r\n    var arrayDate = value.toString().split(\" \"),\r\n        dateField,\r\n        timeField;\r\n\r\n    dateField = arrayDate[0];\r\n\r\n    if (dateRegEx_typeA.test(dateField) || dateRegEx_typeB.test(dateField) || dateRegEx_typeC.test(dateField)) {\r\n        resultDate = true;\r\n    }\r\n\r\n    if (arrayDate.length > 1) {\r\n\r\n        timeField = arrayDate[1];\r\n\r\n        hasTime = true;\r\n\r\n        //Checks if AM/PM included in the time element\r\n        if (arrayDate.length == 3)\r\n            timeField = timeField + ' ' + arrayDate[2];\r\n\r\n        if (timeRegEx.test(timeField))\r\n            resultTime = true;\r\n    }\r\n\r\n    if (hasTime)\r\n        result = resultDate && resultTime;\r\n    else\r\n        result = resultDate;\r\n\r\n    return result;\r\n};\r\n/*\r\n *   Encodes unicode characters into html\r\n */\r\nbizagi.util.unicode2htmlencode = function (input) {\r\n    // Shorten\r\n    var natCCA = 'charCodeAt';\r\n    input = input.replace(/\\r\\n/g, '\\n');\r\n    var i, b1, hex,\r\n        len = input.length,\r\n        htmlHex = '';\r\n    for (i = 0; i < len; i++) {\r\n        b1 = input[natCCA](i);\r\n        hex = b1.toString(16);\r\n        htmlHex += '&#x' + hex + ';';\r\n    }\r\n    return htmlHex;\r\n};\r\n/*\r\n *   Gets the head element from the DOM\r\n */\r\nbizagi.util.getHeadElement = function () {\r\n    var hd = document.getElementsByTagName(\"head\")[0];\r\n    var docEl = document && document.documentElement;\r\n    if (!hd) {\r\n        hd = document.createElement(\"head\");\r\n        docEl.insertBefore(hd, docEl.firstChild);\r\n    }\r\n    // replace head so it runs fast next time.\r\n    bizagi.util.getHeadElement = function () {\r\n        return hd;\r\n    };\r\n    return hd;\r\n};\r\n/*\r\n *   Loads a css text into the current document\r\n */\r\nbizagi.util.loadStyle = function (styleText, layoutGuid) {\r\n\r\n    var element = document.getElementById(layoutGuid);\r\n\r\n    if (styleText && !element) { // less\r\n        var css = document.createElement(\"style\");\r\n        css.type = \"text/css\";\r\n        css.id = layoutGuid;\r\n        if (css.styleSheet) { // IE\r\n            css.styleSheet.cssText = styleText;\r\n        } else {\r\n            (function (node) {\r\n                if (css.childNodes.length) {\r\n                    if (css.firstChild.nodeValue !== node.nodeValue) {\r\n                        css.replaceChild(node, css.firstChild);\r\n                    }\r\n                } else {\r\n                    css.appendChild(node);\r\n                }\r\n            })(document.createTextNode(styleText));\r\n        }\r\n        bizagi.util.getHeadElement().appendChild(css);\r\n    }\r\n};\r\n\r\n/*\r\n *   Loads a css text of the icon widget into the current document\r\n */\r\nbizagi.util.loadIconStyle = function (icon, userfieldname) {\r\n    bizagi.log(\"bizagi.util.loadIconStyle\");\r\n    var css = document.createElement(\"style\");\r\n    css.type = \"text/css\";\r\n\r\n    var cssText = \".mtool-item-image-\" + userfieldname + \" { background:url(data:image/png;base64,\" + icon + \"); }\";\r\n    css.innerHTML = cssText;\r\n\r\n    bizagi.util.getHeadElement().appendChild(css);\r\n};\r\n\r\nbizagi.util.formatDecimalAndMoneyCell = function (tableData, externalMoneyFormat) {\r\n    var moneyFormat, decimalFormat, i, j;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: externalMoneyFormat.decimalSeparator,\r\n        digitGroupSymbol: externalMoneyFormat.groupSeparator,\r\n        roundToDecimalPlace: externalMoneyFormat.decimalDigits\r\n    };\r\n    var defaultMoneyFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n\r\n    moneyFormat = $.extend(defaultMoneyFormat, externalMoneyFormat);\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n\r\n    for (i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"FLOAT\" || tableData.columnTitle[i].type.toUpperCase() == \"REAL\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                var numberValue = bizagi.util.formatDecimal(tableData.rows[j].fields[i], decimalFormat);\r\n                //Gets rids of unnecessary zeros\r\n                if (bizagi.override.removeTrailingZeros === true) {\r\n                    var positive = true;\r\n                    if (numberValue.toString().indexOf(\")\") != -1) {\r\n                        positive = false;\r\n                        numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n                    }\r\n                    var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"$1\");\r\n                    re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"\");\r\n\r\n                    if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n                }\r\n                tableData.rows[j].fields[i] = numberValue;\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n};\r\n\r\n\r\nbizagi.util.formatBoolean = function (value) {\r\n    var self = this;\r\n    if (bizagi.util.parseBoolean(value) == true) {\r\n        return bizagi.localization.getResource(\"render-boolean-yes\");\r\n    } else if (bizagi.util.parseBoolean(value) == false) {\r\n        return bizagi.localization.getResource(\"render-boolean-no\");\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\nbizagi.util.formatInvariantBoolean = function (htmlContent) {\r\n    htmlContent = htmlContent || \"\";\r\n    $(\".formatBoolean\", htmlContent).not(\".formatted\").each(function (index, element) {\r\n        var $element = $(element);\r\n        var content = $element.html();\r\n        $element.addClass(\"formatted\");\r\n        try {\r\n            var formatBoolean = bizagi.util.formatBoolean(content);\r\n            $element.html(formatBoolean);\r\n        } catch (e) {\r\n            $element.html(content);\r\n        }\r\n    });\r\n};\r\n\r\nbizagi.util.formatDecimal = function (value, format) {\r\n    var i = $(\"<i/>\").text(value);\r\n    i.formatCurrency(format);\r\n    return i.text();\r\n};\r\n\r\n/*\r\n * Format monetary cells\r\n */\r\nbizagi.util.formatMonetaryCells = function (tableData, moneyFormat) {\r\n\r\n    var defaultFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n\r\n    moneyFormat = moneyFormat || defaultFormat;\r\n\r\n    for (var i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (var j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n\r\n};\r\n\r\n/*\r\n * Format monetary values, the format must have the structure of the next example:\r\n *\r\n * var defaultFormat = {\r\n *        symbol: \"€\",\r\n *        decimalSeparator: \",\",\r\n *        groupSeparator: \".\",\r\n *        decimalDigits: \"2\"\r\n *    };\r\n */\r\nbizagi.util.formatMoney = function (value, format) {\r\n    var result = \"\",\r\n        tmpResult = \"\",\r\n        intSection = \"\",\r\n        decimalSection = \"\",\r\n        decimalResult = \"\",\r\n        isNegative = (value < 0);\r\n\r\n    if (value == null) {\r\n        value = \"\";\r\n    }\r\n\r\n    value = value.toString();\r\n\r\n    if (value.length >= 1) {\r\n        var decimalDigitPosition = value.indexOf(\".\");\r\n\r\n        if (decimalDigitPosition > 0) {\r\n            value = bizagi.util.fixDecimalDigits(value, format.decimalDigits);\r\n            intSection = value.substring(0, decimalDigitPosition).replace(/\\D/g, '');\r\n        } else {\r\n            var zeroChar = \"0\";\r\n\r\n            for (var i = 0; i < format.decimalDigits; i++) {\r\n                decimalResult += zeroChar;\r\n            }\r\n            intSection = value.replace(/\\D/g, '');\r\n        }\r\n\r\n        //take only the number characters removing other characters\r\n        value = value.replace(/\\D/g, '');\r\n        //take the decimal section\r\n        if (format.decimalDigits > 0) {\r\n            decimalSection = decimalDigitPosition > 0 ? format.decimalSeparator + value.substring(value.length - format.decimalDigits, value.length) : format.decimalSeparator + decimalResult;\r\n        } else {\r\n            decimalSection = \"\";\r\n        }\r\n        //insert groupSeparators into int section\r\n        if (intSection.length > 3) {\r\n            var count = 0;\r\n\r\n            //insert separator from end to begin\r\n            for (var i = intSection.length - 1; i >= 0; i--) {\r\n                if (count == 3) {\r\n                    tmpResult += \".\";\r\n                    count = 0;\r\n                }\r\n                tmpResult += intSection[i];\r\n                count += 1;\r\n            }\r\n            //revert the string to get the result value\r\n            for (var i = tmpResult.length - 1; i >= 0; i--) {\r\n                result += tmpResult[i];\r\n            }\r\n        } else {\r\n            result = intSection;\r\n        }\r\n\r\n        //replace the correct group separator\r\n        result = result.replaceAll(\".\", format.groupSeparator);\r\n        //unify all sections and finish format\r\n        if (isNegative) {\r\n            var negativeFormat = bizagi.localization.getResource('numericFormat').negativeFormat;\r\n            result = negativeFormat.replace(\"%s\", format.symbol).replace(\"%n\", result + decimalSection);\r\n        } else {\r\n            result = format.symbol + result + decimalSection;\r\n        }\r\n\r\n        return result;\r\n    } else {\r\n        return value;\r\n    }\r\n\r\n\r\n};\r\n\r\n/**\r\n * Remove all characters except numbers\r\n */\r\nbizagi.util.getOnlyNumbersByString = function (stringValue) {\r\n    return stringValue.replace(/\\D/g, '');\r\n}\r\n\r\n/*\r\n    This method was created because the \"toFixed()\" JavaScript method in some cases round the numbers when it is not needed.\r\n    Can return string or number.\r\n*/\r\nbizagi.util.fixDecimalDigits = function (value, decimalDigits) {\r\n    var decimalDigitPosition,\r\n        intSection,\r\n        decimalSection;\r\n\r\n    decimalDigitPosition = value.indexOf('.');\r\n    intSection = value.substring(0, decimalDigitPosition);\r\n    decimalSection = value.substring(decimalDigitPosition + 1, value.length);\r\n\r\n    if (decimalDigits > decimalSection.length) {\r\n        for (var i = decimalSection.length; i < decimalDigits; i++) {\r\n            value += '0';\r\n        }\r\n    } else {\r\n        value = parseFloat(value).toFixed(decimalDigits);\r\n    }\r\n\r\n    return value;\r\n\r\n};\r\n\r\n/*\r\n * Format html  money\r\n */\r\nbizagi.util.formatInvariantMoney = function (htmlContent, moneyFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var defaultFormat = {\r\n        symbol: moneyFormat.symbol,\r\n        decimalSeparator: moneyFormat.decimalSeparator || \",\",\r\n        groupSeparator: moneyFormat.groupSeparator || \".\",\r\n        decimalDigits: moneyFormat.decimalDigits || \"2\"\r\n    };\r\n    if (moneyFormat.allowDecimals === false) {\r\n        defaultFormat.decimalDigits = \"0\";\r\n    }\r\n\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatMoney = bizagi.util.formatMoney(value, defaultFormat);\r\n                $(elem).html(formatMoney);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html  number\r\n */\r\nbizagi.util.formatInvariantNumber = function (htmlContent, numberFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var decimalDigits = \"2\";\r\n    if (numberFormat.decimalDigits == \"0\")\r\n        decimalDigits = \"0\";\r\n    else\r\n        decimalDigits = numberFormat.decimalDigits || \"2\";\r\n\r\n    var defaultFormat = {\r\n        symbol: \"\",\r\n        decimalSeparator: numberFormat.decimalSeparator || \",\",\r\n        groupSeparator: numberFormat.groupSeparator || numberFormat.thousands ? \".\" : \"\",\r\n        decimalDigits: decimalDigits\r\n    };\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var containsLetter = content.match(/[a-zA-Z]/);\r\n            var value = (containsLetter != null && containsLetter.length > 0) ? NaN : parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatNumber = bizagi.util.formatMoney(value, defaultFormat);\r\n                if (numberFormat.percentage) {\r\n                    formatNumber = formatNumber.toString() + \"%\";\r\n                }\r\n                $(elem).html(formatNumber);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html with invariant date\r\n */\r\nbizagi.util.formatInvariantDate = function (htmlContent, dateFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    dateFormat = dateFormat || \"MM/dd/yyyy hh:mm:ss\";\r\n    $(\".formatDate\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = new Date(content);\r\n            var dateTimeFormat = dateFormat;\r\n\r\n            if (bizagi.util.isValidDate(value))\r\n                dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n            var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat /*self.getResource(\"dateFormat\")*/);\r\n            $(elem).html(formatDate);\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Return format date with resources from string invariant date. It use the format specified\r\n * @param stringDateInvariant, string invariant date\r\n */\r\nbizagi.util.formatDateFromInvariantStringDate = function (stringInvariantDate) {\r\n    if (bizagi.util.isValidDate(stringInvariantDate)) {\r\n        var dateTimeFormat = bizagi.localization.getResource(\"dateFormat\") + ' ' + bizagi.localization.getResource(\"timeFormat\");\r\n        var value = new Date(stringInvariantDate);\r\n        dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n        var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat);\r\n        return formatDate;\r\n    }\r\n    return stringInvariantDate || \"\";\r\n};\r\n\r\nbizagi.util.getFormatDate = function (dateValue, defaultFormatDate) {\r\n    var dateTimeFormat = defaultFormatDate;\r\n\r\n    var H = dateValue.getHours();\r\n    var m = dateValue.getMinutes();\r\n    var s = dateValue.getSeconds();\r\n    var ms = dateValue.getMilliseconds();\r\n\r\n    //Don't show time when hour, minutes, seconds and milliseconds are 0\r\n    if (H === 0 && m === 0 && s === 0 && ms === 0)\r\n        dateTimeFormat = bizagi.localization.getResource(\"dateFormat\");\r\n\r\n    return dateTimeFormat;\r\n};\r\n\r\n/**\r\n * Format value by dataType\r\n */\r\n\r\nbizagi.util.formatValueByDataType = function (value, dataType) {\r\n    /**\r\n     * Types Definedin Backend\r\n     * None = 0,BigInt = 1,Int = 2,SmallInt = 3,TinyInt = 4,Boolean = 5,Decimal = 6,Numeric = 7,Money = 8,Float = 10,Real = 11,DateTime = 12,SmallDateTime = 13,\r\n     Char = 14,VarChar = 15,Text = 16,Binary = 17,VarBinary = 18,Image = 19,Guid = 20,NChar = 21,NVarChar = 22,NText = 23,MxMBidirectionalRelationship = 24,\r\n     MxMUnidirectionalRelationship = 25,EntityDisabled = 26,UserAuth = 27,MxMUnidirectionalRelationshipWithoutFilter = 28,OracleNumber = 29,\r\n     Stakeholder = 30,ActivityItems = 31\r\n     *\r\n     * */\r\n    var result = value;\r\n    switch (dataType) {\r\n        case \"NText\":\r\n        case 23:\r\n        case \"Char\":\r\n        case 14:\r\n        case \"VarChar\":\r\n        case 15:\r\n        case \"Text\":\r\n        case 16:\r\n            if (value && value.length > 30) {\r\n                result = bizagi.util.replaceLineBreak(value);\r\n            }\r\n            break;\r\n        case \"Boolean\":\r\n        case 5:\r\n        case \"Binary\":\r\n        case 17:\r\n            result = bizagi.util.formatBoolean(value);\r\n            break;\r\n        case \"Int\":\r\n        case 2:\r\n        case \"BigInt\":\r\n        case 1:\r\n        case \"SmallInt\":\r\n        case 3:\r\n        case \"TinyInt\":\r\n        case 4:\r\n        case \"Numeric\":\r\n        case 7:\r\n            result = (value === undefined || value === null) ? \"\" : value;\r\n            break;\r\n        case \"Money\":\r\n        case 8:\r\n            result = bizagi.util.formatMonetaryCell(value);\r\n            break;\r\n        case \"Float\":\r\n        case 10:\r\n        case \"Real\":\r\n        case 11:\r\n        case \"Decimal\":\r\n        case 6:\r\n            result = bizagi.util.formatDecimalCell(value);\r\n            break;\r\n        case \"DateTime\":\r\n        case 12:\r\n        case \"SmallDateTime\":\r\n        case 13:\r\n            result = bizagi.util.formatDateFromInvariantStringDate(value);\r\n            break;\r\n    }\r\n    if (result == null) {\r\n        result = \"\";\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Check if it is a valid date\r\n */\r\nbizagi.util.isValidDate = function (params) {\r\n    if (typeof (params) != \"undefined\" && params != null) {\r\n        var parseDate = new Date(params);\r\n        return !isNaN(parseDate.valueOf());\r\n    } else return false;\r\n};\r\n\r\n/*\r\n *   Defines a date time formatter that will be available globally\r\n */\r\nbizagi.util.monthNames = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\r\nbizagi.util.dayNames = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat');\r\n\r\nbizagi.util.dateFormatter = new function () {\r\n    this.LZ = function (x) {\r\n        return (x < 0 || x > 9 ? \"\" : \"0\") + x;\r\n    };\r\n    /*\r\n     *   isDate ( date_string, format_string )\r\n     *   Returns true if date string matches format of format string and\r\n     *   is a valid date. Else returns false.\r\n     *   It is recommended that you trim whitespace around the value before\r\n     *   passing it to this function, as whitespace is NOT ignored!\r\n     */\r\n    this.isDate = function (val, format) {\r\n        var date = this.getDateFromFormat(val, format);\r\n        if (date == 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    this.getRelativeTime = function (date, dateFormat, onlyUnitsTime) {\r\n\r\n        var self = this;\r\n        var now = new Date();\r\n        var time = (date instanceof Date) ? date : kendo.parseDate(date, dateFormat);\r\n        var diff = now.getTime() - time.getTime();\r\n        var timeDiff = getTimeDiffDescription(diff, 'year', 31536000000, onlyUnitsTime);\r\n\r\n        if (!timeDiff) {\r\n            timeDiff = getTimeDiffDescription(diff, 'month', 2628000000, onlyUnitsTime);\r\n            if (!timeDiff) {\r\n                timeDiff = getTimeDiffDescription(diff, 'week', 604800000, onlyUnitsTime);\r\n                if (!timeDiff) {\r\n                    timeDiff = getTimeDiffDescription(diff, 'day', 86400000, onlyUnitsTime);\r\n                    if (!timeDiff) {\r\n                        timeDiff = getTimeDiffDescription(diff, 'hour', 3600000, onlyUnitsTime);\r\n                        if (!timeDiff) {\r\n                            timeDiff = getTimeDiffDescription(diff, 'minute', 60000, onlyUnitsTime);\r\n                            if (!timeDiff) {\r\n                                if (onlyUnitsTime) {\r\n                                    if (diff === 0) {\r\n                                        timeDiff = getTimeDiffDescription(diff + 1, 'minute', 1, onlyUnitsTime);\r\n                                    } else {\r\n                                        timeDiff = getTimeDiffDescription(diff, 'minute', 1, onlyUnitsTime);\r\n                                    }\r\n                                } else {\r\n                                    timeDiff = getTimeDiffDescription(diff, 'second', 2000, onlyUnitsTime);\r\n                                    if (!timeDiff) {\r\n                                        timeDiff = bizagi.localization.getResource(\"workportal-relativetime-momentago\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return timeDiff;\r\n\r\n        /*\r\n         * Get Time Difference\r\n         */\r\n        function getTimeDiffDescription(diff, unit, timeDivisor, onlyUnitsTime) {\r\n            var unitAmount = (diff / timeDivisor).toFixed(0);\r\n\r\n            if (unitAmount > 0) {\r\n                if (onlyUnitsTime) {\r\n                    return (unitAmount == 1 ? bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount) : bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount));\r\n                } else {\r\n                    var resourceAgo = bizagi.localization.getResource(\"workportal-relativetime-ago\");\r\n                    return (unitAmount == 1 ? resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount)) : resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount)));\r\n                }\r\n\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     *   compareDates(date1,date1format,date2,date2format)\r\n     *   Compare two date strings to see which is greater.\r\n     *   Returns:\r\n     *   1 if date1 is greater than date2\r\n     *   0 if date2 is greater than date1 of if they are the same\r\n     *  -1 if either of the dates is in an invalid format\r\n     */\r\n    this.compareDates = function (date1, dateformat1, date2, dateformat2) {\r\n        var d1 = getDateFromFormat(date1, dateformat1);\r\n        var d2 = getDateFromFormat(date2, dateformat2);\r\n        if (d1 == 0 || d2 == 0) {\r\n            return -1;\r\n        } else if (d1 > d2) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    /*\r\n     *   getDifferenceBetweenDates(date1,date2, unit)\r\n     *   Compare two date objects to see difference between them. The number result by unit specified.\r\n     *\r\n     *   Returns:\r\n     *   Difference value between two dates.\r\n     *   Message string if either of the dates is in an invalid format\r\n     */\r\n    this.getDifferenceBetweenDates = function (date1, date2, unit) {\r\n        if (date1 instanceof Date && date1 instanceof Date) {\r\n            switch (unit) {\r\n                case \"seconds\":\r\n                    return (date2.getTime() - date1.getTime()) / 1000;\r\n                case \"milliseconds\":\r\n                    return (date2.getTime() - date1.getTime());\r\n                default:\r\n                    return \"unit is not Defined\";\r\n            }\r\n        } else {\r\n            return \"one param not is Date\";\r\n        }\r\n\r\n    };\r\n    /*\r\n     *   formatDate (date_object, format)\r\n     *   Returns a date in the output format specified.\r\n     *   The format string uses the same abbreviations as in getDateFromFormat()\r\n     */\r\n    this.formatDate = function (date, format, i18n) {\r\n        // Check if date is valid\r\n        if (!bizagi.util.isValidDate(date) || date == 0) {\r\n            return \"\";\r\n        }\r\n\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        format = format + \"\";\r\n        var result = \"\";\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var y = date.getFullYear() + \"\";\r\n        var M = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var E = date.getDay();\r\n        var H = date.getHours();\r\n        var m = date.getMinutes();\r\n        var s = date.getSeconds();\r\n        var f = date.getMilliseconds();\r\n        // Convert real date parts into formatted versions\r\n        var value = new Object();\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        if (y.length < 4 || (y.charAt(0) === \"-\" && y.length < 5)) {\r\n            y = \"\" + (y - 0 + 1900);\r\n        }\r\n        value[\"y\"] = \"\" + y;\r\n        value[\"yyyy\"] = y;\r\n        value[\"yy\"] = y.substring(2, 4);\r\n        value[\"M\"] = M;\r\n        value[\"MM\"] = this.LZ(M);\r\n        value[\"MMM\"] = monthNames[M + 11];\r\n        value[\"MMMM\"] = monthNames[M - 1];\r\n        value[\"NNN\"] = monthNames[M + 11];\r\n        value[\"d\"] = d;\r\n        value[\"dd\"] = this.LZ(d);\r\n        value[\"ddd\"] = dayNames[E + 7];\r\n        value[\"dddd\"] = dayNames[E];\r\n        value[\"E\"] = dayNames[E + 7];\r\n        value[\"EE\"] = dayNames[E];\r\n        value[\"H\"] = H;\r\n        value[\"HH\"] = this.LZ(H);\r\n        value[\"tt\"] = H < 12 ? \"am\" : \"pm\";\r\n        value[\"TT\"] = H < 12 ? \"AM\" : \"PM\";\r\n\r\n\r\n        if (H == 0) {\r\n            value[\"h\"] = 12;\r\n        } else if (H > 12) {\r\n            value[\"h\"] = H - 12;\r\n        } else {\r\n            value[\"h\"] = H;\r\n        }\r\n        value[\"hh\"] = this.LZ(value[\"h\"]);\r\n        if (H > 11) {\r\n            value[\"K\"] = H - 12;\r\n        } else {\r\n            value[\"K\"] = H;\r\n        }\r\n        value[\"k\"] = H + 1;\r\n        value[\"KK\"] = this.LZ(value[\"K\"]);\r\n        value[\"kk\"] = this.LZ(value[\"k\"]);\r\n        if (H > 11) {\r\n            value[\"a\"] = \"PM\";\r\n        } else {\r\n            value[\"a\"] = \"AM\";\r\n        }\r\n        value[\"m\"] = m;\r\n        value[\"mm\"] = this.LZ(m);\r\n        value[\"s\"] = s;\r\n        value[\"ss\"] = this.LZ(s);\r\n        value[\"FFF\"] = f;\r\n\r\n        while (i_format < format.length) {\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            if (value[token] != null) {\r\n                result = result + value[token];\r\n            } else {\r\n                result = result + token;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    /*\r\n     *   getDateFromFormat( date_string , format_string )\r\n     *\r\n     *   This function takes a date string and a format string. It matches\r\n     *   If the date string matches the format string, it returns the \r\n     *   getTime() of the date. If it does not match, it returns 0.\r\n     */\r\n    this.getDateFromFormat = function (val, format, i18n) {\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        val = val + \"\";\r\n        format = format + \"\";\r\n        var i_val = 0;\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var x = 0,\r\n            y = 0;\r\n        var now = new Date();\r\n        var year = now.getYear();\r\n        var month = now.getMonth() + 1;\r\n        var date = 1;\r\n        var hh = now.getHours();\r\n        var mm = now.getMinutes();\r\n        var ss = now.getSeconds();\r\n        var FFF = now.getMilliseconds();\r\n        var ampm = \"\";\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        while (i_format < format.length) {\r\n            // Get next token from format string\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            // Extract contents of value based on format token\r\n            if (token == \"yyyy\" || token == \"yy\" || token == \"y\") {\r\n                if (token == \"yyyy\") {\r\n                    x = 4;\r\n                    y = 4;\r\n                }\r\n                if (token == \"yy\") {\r\n                    x = 2;\r\n                    y = 2;\r\n                }\r\n                if (token == \"y\") {\r\n                    x = 2;\r\n                    y = 4;\r\n                }\r\n                year = _getInt(val, i_val, x, y);\r\n                if (year == null) {\r\n                    return 0;\r\n                }\r\n                i_val += year.length;\r\n                if (year.length == 2) {\r\n                    if (year > 70) {\r\n                        year = 1900 + (year - 0);\r\n                    } else {\r\n                        year = 2000 + (year - 0);\r\n                    }\r\n                }\r\n            } else if (token == \"MMMM\" || token == \"MMM\" || token == \"NNN\") {\r\n                month = 0;\r\n                for (var i = 0; i < monthNames.length; i++) {\r\n                    var month_name = monthNames[i];\r\n                    if (val.substring(i_val, i_val + month_name.length).toLowerCase() == month_name.toLowerCase()) {\r\n                        if (token == \"MMMM\" || token == \"MMM\" || (token == \"NNN\" && i > 11)) {\r\n                            month = i + 1;\r\n                            if (month > 12) {\r\n                                month -= 12;\r\n                            }\r\n                            i_val += month_name.length;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if ((month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n            } else if (token == \"dddd\" || token == \"EE\" || token == \"E\") {\r\n                for (var j = 0; j < dayNames.length; j++) {\r\n                    var day_name = dayNames[j];\r\n                    if (val.substring(i_val, i_val + day_name.length).toLowerCase() == day_name.toLowerCase()) {\r\n                        i_val += day_name.length;\r\n                        break;\r\n                    }\r\n                }\r\n            } else if (token == \"MM\" || token == \"M\") {\r\n                month = _getInt(val, i_val, 1, 2);\r\n                if (month == null || (month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += month.length;\r\n            } else if (token == \"dd\" || token == \"d\") {\r\n                date = _getInt(val, i_val, 1, 2);\r\n                if (date == null || (date < 1) || (date > 31)) {\r\n                    return 0;\r\n                }\r\n                i_val += date.length;\r\n            } else if (token == \"hh\" || token == \"h\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 23)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"KK\" || token == \"K\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 11)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"kk\" || token == \"k\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 24)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n                hh--;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                mm = _getInt(val, i_val, token.length, 2);\r\n                if (mm == null || (mm < 0) || (mm > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += mm.length;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                ss = _getInt(val, i_val, token.length, 2);\r\n                if (ss == null || (ss < 0) || (ss > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += ss.length;\r\n            } else if (token == \"FFF\") {\r\n                ff = _getInt(val, i_val, token.length, 3);\r\n                if (ff == null || (ff < 0) || (ff > 999)) {\r\n                    return 0;\r\n                }\r\n                i_val += ff.length;\r\n            } else if (token == \"a\" || token == \"tt\") {\r\n                if (val.substring(i_val, i_val + 2).toLowerCase() == \"am\") {\r\n                    ampm = \"AM\";\r\n                } else if (val.substring(i_val, i_val + 2).toLowerCase() == \"pm\") {\r\n                    ampm = \"PM\";\r\n                } else {\r\n                    return 0;\r\n                }\r\n                i_val += 2;\r\n            } else {\r\n                if (val.substring(i_val, i_val + token.length) != token) {\r\n                    return 0;\r\n                } else {\r\n                    i_val += token.length;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Is date valid for month?\r\n        if (month == 2) {\r\n            // Check for leap year\r\n            if (((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0)) { // leap year\r\n                if (date > 29) {\r\n                    return 0;\r\n                }\r\n            } else {\r\n                if (date > 28) {\r\n                    return 0;\r\n                }\r\n            }\r\n        }\r\n        if ((month == 4) || (month == 6) || (month == 9) || (month == 11)) {\r\n            if (date > 30) {\r\n                return 0;\r\n            }\r\n        }\r\n        // Correct hours value\r\n        if (hh < 12 && ampm == \"PM\") {\r\n            hh = hh - 0 + 12;\r\n        } else if (hh > 11 && ampm == \"AM\") {\r\n            hh -= 12;\r\n        }\r\n        var newdate = new Date(year, month - 1, date, hh, mm, ss);\r\n        return newdate;\r\n\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _isInteger(_val) {\r\n            var digits = \"1234567890\";\r\n            for (var k = 0; k < _val.length; k++) {\r\n                if (digits.indexOf(_val.charAt(k)) == -1) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _getInt(str, l, minlength, maxlength) {\r\n            for (var m = maxlength; m >= minlength; m--) {\r\n                var _token = str.substring(l, l + m);\r\n                if (_token.length < minlength) {\r\n                    return null;\r\n                }\r\n                if (_isInteger(_token)) {\r\n                    return _token;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    };\r\n    /*\r\n     * parseDate( date_string [, prefer_euro_format] )\r\n     *\r\n     * This function takes a date string and tries to match it to a\r\n     * number of possible date formats to get the value. It will try to\r\n     * match against the following international formats, in this order:\r\n     * y-M-d   MMM d, y   MMM d,y   y-MMM-d   d-MMM-y  MMM d\r\n     * M/d/y   M-d-y      M.d.y     MMM-d     M/d      M-d\r\n     * d/M/y   d-M-y      d.M.y     d-MMM     d/M      d-M\r\n     * A second argument may be passed to instruct the method to search\r\n     * for formats like d/M/y (european format) before M/d/y (American).\r\n     * Returns a Date object or null if no patterns match.\r\n     */\r\n    this.parseDate = function (val) {\r\n        var preferEuro = (arguments.length == 2) ? arguments[1] : false;\r\n        var generalFormats = new Array('y-M-d', 'MMM d, y', 'MMM d,y', 'y-MMM-d', 'd-MMM-y', 'MMM d');\r\n        var monthFirst = new Array('M/d/y', 'M-d-y', 'M.d.y', 'MMM-d', 'M/d', 'M-d');\r\n        var dateFirst = new Array('d/M/y', 'd-M-y', 'd.M.y', 'd-MMM', 'd/M', 'd-M');\r\n        var checkList = new Array(generalFormats, preferEuro ? dateFirst : monthFirst, preferEuro ? monthFirst : dateFirst);\r\n        var d;\r\n        for (var i = 0; i < checkList.length; i++) {\r\n            var l = window[checkList[i]];\r\n            for (var j = 0; j < l.length; j++) {\r\n                d = getDateFromFormat(val, l[j]);\r\n                if (d != 0) {\r\n                    return new Date(d);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    /*\r\n     *   Method to analyze a time format and checks separator, and hour format, and seconds\r\n     */\r\n    this.analyzeTimeFormat = function (timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            separator: \":\"\r\n        };\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else {\r\n                if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                    returnObj.separator = token;\r\n                }\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    };\r\n    this.getDateFromInvariant = function (value, showTime) {\r\n        value = (value == null) ? \"\" : value;\r\n        value = (typeof value != \"string\") ? value.toString() : value;\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" H:mm:ss\" : \"\");\r\n        if (showTime) {\r\n            if (value && (value.toLowerCase().indexOf(\"am\") > 0 || value.toLowerCase().indexOf(\"pm\") > 0)) {\r\n                INVARIANT_FORMAT = \"MM/dd/yyyy h:mm:ss a\";\r\n            }\r\n        }\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        } else if (date == 0 && showTime && value != null && value != \"\") {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n            date.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatInvariant = function (date, showTime) {\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, INVARIANT_FORMAT);\r\n        return formattedDate;\r\n    };\r\n    this.getDateFromISO = function (value, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        // If the date could not be parsed, try it out with seconds\r\n        if (date == 0 && showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        }\r\n\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd HH:mm\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            // If the date could not be parsed, try it out with seconds\r\n            if (date == 0) {\r\n                ISO_FORMAT = \"yyyy-MM-dd HH:mm:ss\";\r\n                date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            }\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatISO = function (date, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, ISO_FORMAT);\r\n        return formattedDate;\r\n    };\r\n\r\n    this.formatISO8601 = function (dateObject, restartTimeToMidnight) {\r\n        var restartTimeToMidnight = restartTimeToMidnight || false;\r\n        var ISO_FORMAT8601 = \"yyyy-MM-ddTHH:mm:ss\";\r\n        if (restartTimeToMidnight) {\r\n            dateObject.setHours(0, 0, 0, 0);\r\n        }\r\n        return bizagi.util.dateFormatter.formatDate(dateObject, ISO_FORMAT8601);\r\n    };\r\n\r\n    this.isFormatISO8601 = function (stringDate) {\r\n        var ISO_8601_WITH_TIME = /^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?$/i\r\n        return ISO_8601_WITH_TIME.test(stringDate);\r\n    };\r\n\r\n    this.sleep = function (delay) {\r\n        // Delay in miliseconds\r\n        var start = new Date().getTime();\r\n        while (new Date().getTime() < start + delay) {\r\n            // wait\r\n        }\r\n    };\r\n    this.getDateFormatByDatePickerJqueryUI = function () {\r\n        return bizagi.localization.getResource(\"dateFormat\").replace(\"yyyy\", \"yy\");\r\n    }\r\n};\r\n/*\r\n * Use localStorage in html5 verfiy supports and operations \r\n * http://dev.w3.org/html5/webstorage/#dom-storage-setitem\r\n */\r\n\r\nbizagi.util.browserSupportLocalStorage = function () {\r\n    try {\r\n        return 'localStorage' in window && window['localStorage'] !== null;\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n};\r\n/*\r\n *set the item  in the local storage\r\n */\r\nbizagi.util.setItemLocalStorage = function (key, value) {\r\n    if (bizagi.util.browserSupportLocalStorage()) {\r\n        localStorage.setItem(key, value);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n\r\nbizagi.util.getItemLocalStorage = function (key) {\r\n    return localStorage.getItem(key);\r\n};\r\n\r\nbizagi.util.removeItemLocalStorage = function (key) {\r\n    localStorage.removeItem(key);\r\n};\r\n\r\nbizagi.util.clearLocalStorage = function () {\r\n    if (bizagi.util.browserSupportLocalStorage())\r\n        localStorage.clear();\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n\r\n// Fix problem with console.log when we forgot to remove it\r\n(function () {\r\n    var environment = (typeof BIZAGI_ENVIRONMENT != \"undefined\") ? BIZAGI_ENVIRONMENT : \"release\";\r\n    if (environment == 'debug') {\r\n        if (typeof window.console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        }\r\n    } else {\r\n        if (typeof console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        } else if (bizagiConfig && !bizagiConfig.showConsoleLog) {\r\n            console.log = function (a) { /*Nothing to do*/ };\r\n        }\r\n    }\r\n})();\r\n\r\nbizagi.util.smartphone.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"bz-util-loading-container\"> <div class=\"ui-bizagi-loading-icon bz-util-loading\"></div>  </div>');\r\n};\r\nbizagi.util.smartphone.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".bz-util-loading-container\", elementToapply).remove();\r\n};\r\n\r\n\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n * \r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n\r\n    self.add = function (callback) {\r\n        queue.push({ callbacks: [callback] });\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (queue.length == 0) {\r\n            return self.add(callback);\r\n        }\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\") {\r\n                        var deferred = $.Deferred();\r\n                        $.when(callback()).done(function () {\r\n                            deferred.resolve();\r\n                        }).fail(function () {\r\n                            deferred.resolve();\r\n                        });\r\n                        return deferred.promise();\r\n                    }\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        }\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Calculate circular dependencies \r\n * \r\n * @example var a = new bizagi.circularDependencies(); a.addNode('name',obj);\r\n * a.resolve(node);\r\n * \r\n */\r\n//TODO: DEPL - Check this because we agreed to a much simpler solution\r\nbizagi.circularDependencies = function () {\r\n    var circularDependencies = new Function();\r\n    var self = circularDependencies.prototype;\r\n    self.list = []; //[{ name: \"root\", obj: {}, nodeObj: {}, childs: {} }];\r\n    self.lastNodeAdded; // Undefined reference\r\n\r\n    self.addNode = function (name, obj) {\r\n        var OBJ = JSON.encode(obj);\r\n        var foundObjChildNode = _search(name, OBJ);\r\n        if (foundObjChildNode) {\r\n            var lastNode = self.lastNodeAdded || self.list[self.list.length - 1];\r\n            lastNode.nodeObj.addChild(foundObjChildNode.nodeObj);\r\n            self.lastNodeAdded = foundObjChildNode;\r\n        } else {\r\n            var node = new _addNode(name, OBJ);\r\n            self.list.push({\r\n                name: name,\r\n                obj: OBJ,\r\n                nodeObj: node,\r\n                timeStamp: new Date().getTime()\r\n            });\r\n            return node;\r\n        }\r\n    };\r\n\r\n    self.resolve = function (node, resolved, seen) {\r\n        // if dont setted node variable, take the first one -> root\r\n        node = node || _getFirstNodeWithChilds() || self.list[0].nodeObj;\r\n        var resolveDependencies = new _resolve(node, resolved, seen);\r\n        return resolveDependencies;\r\n    };\r\n\r\n    var _resetList = function () {\r\n        self.list = [];\r\n    };\r\n\r\n    var _getFirstNodeWithChilds = function () {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].nodeObj.childs.length > 0) {\r\n                return self.list[i].nodeObj;\r\n            }\r\n        }\r\n        return (self.list.length > 0) ? self.list[0].nodeObj : {};\r\n    };\r\n\r\n    var _search = function (name, obj) {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].name == name) {\r\n                // remove tag element\r\n                var now = new Date().getTime();\r\n                var timeToKeep = 1000; //milliseconds\r\n                if ((self.list[i].timeStamp + timeToKeep) < now) {\r\n                    //remove element from the list\r\n                    self.list.splice(i, 1);\r\n                } else if (self.list[i].obj == obj) {\r\n                    return self.list[i];\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var _addNode = (function (name, obj) {\r\n        name = name || \"\";\r\n        obj = obj || {};\r\n        var node = function (name, obj) {\r\n            this.name = name;\r\n            this.obj = obj;\r\n            this.childs = [];\r\n        };\r\n        var self = node.prototype;\r\n\r\n        self.addChild = function (node) {\r\n            this.childs.push(node);\r\n        };\r\n\r\n        return node;\r\n    })();\r\n\r\n    var _resolve = (function (node, resolved, seen) {\r\n        var resolve = function (node, resolved, seen) {\r\n            this.node = node || {};\r\n            this.node.childs = this.node.childs || [];\r\n            this.resolved = resolved || [];\r\n            this.seen = seen || [];\r\n\r\n            this.seen.push(this.node);\r\n\r\n            for (var i = 0; i < this.node.childs.length; i++) {\r\n                if (!self.hasObject(this.node.childs[i], this.resolved)) {\r\n                    if (self.hasObject(this.node.childs[i], this.seen)) {\r\n                        //throw new _error(\"error node:\" + node.name + \" -> \" + node.childs[i].name);\r\n                        _resetList();\r\n                        var error = {\r\n                            dependencyFrom: this.node.name,\r\n                            dependencyFromObj: this.node.obj,\r\n                            dependencyTo: this.node.childs[i].name,\r\n                            dependencyToObj: this.node.childs[i].obj,\r\n                            path: this.seen\r\n                        };\r\n\r\n                        return {\r\n                            error: $.extend({\r\n                                standardError: {\r\n                                    status: \"error\",\r\n                                    responseText: JSON.encode({ message: self.makeErrorMessage(error), type: \"alert\" })\r\n                                },\r\n                                multiactionError: {\r\n                                    message: self.makeErrorMessage(error),\r\n                                    type: \"alert\"\r\n                                }\r\n                            }, error)\r\n                        };\r\n                    } else {\r\n                        return resolve(this.node.childs[i], this.resolved, this.seen);\r\n                    }\r\n                }\r\n            }\r\n            if (this.resolved) {\r\n                this.resolved.push(this.node);\r\n            }\r\n        };\r\n\r\n        var self = resolve.prototype;\r\n\r\n        self.hasObject = function (toSearch, collection) {\r\n\r\n            for (var i = 0; i < collection.length; i++) {\r\n                if (collection[i].name == toSearch.name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n\r\n        self.makeErrorMessage = function (error) {\r\n            var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n            return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n\r\n            /*  return {\r\n                  responseText: parsedMessage,\r\n                  message: parsedMessage,\r\n                  extraInfo: error\r\n              };*/\r\n        };\r\n\r\n        return resolve;\r\n    })();\r\n\r\n    return self;\r\n};\r\n\r\n/**\r\n * Apply css string style (one or more). It works to add or override a specific style even if it has !important\r\n * \r\n * @example bizagi.util.cssExtended($('.myClass'), 'display:none!important;color:red');\r\n * \r\n */\r\nbizagi.util.cssExtended = function (instance, options) {\r\n    var cssToAdd = options.split(\";\");\r\n\r\n    for (i = 0; i < cssToAdd.length; i++) {\r\n        if (cssToAdd[i] != \"\") {\r\n            bizagi.util.cssExtendedApplyChanges(instance, cssToAdd[i]);\r\n        }\r\n    }\r\n\r\n};\r\n\r\n/**\r\n * Apply the style change \r\n * \r\n */\r\nbizagi.util.cssExtendedApplyChanges = function (instance, option) {\r\n\r\n    for (var i = 0; i < instance.length; i++) {\r\n        var $this = $(instance[i]);\r\n        var attrToAdd = option.split(\":\")[0];\r\n\r\n        if ($this.attr('style')) {\r\n            var tmpStyle = $this.attr('style').split(\";\");\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            for (j = 0; j < tmpStyle.length; j++) {\r\n                var cssProperty = tmpStyle[j].split(\":\");\r\n\r\n                if ($.trim(cssProperty[0]) != attrToAdd && $.trim(cssProperty[0]) != \"\") {\r\n                    arrProperties.push(cssProperty[0] + \":\" + cssProperty[1] + \";\");\r\n                }\r\n                resultProperties = JSON.stringify(arrProperties).replace(/\\\",\"/g, ' ').replace(/\\[\"/g, ' ').replace(/\\\"]/g, ' ');\r\n            }\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        } else if ($this.css(attrToAdd)) {\r\n            var tmpStyle = $this.css(attrToAdd);\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            arrProperties.push(option + \";\");\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        }\r\n    }\r\n};\r\n\r\n/*\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n * Sort a JSON array by attribute and order type (ascendant or descendant)\r\n * example: data = [ {attr1:val1, attr2:val2} , {attr1:val3, attr2:val4 },... ]  , key = \"attr2\" , way = \"asc\"\r\n */\r\nbizagi.util.sortJSON = function (data, key, way) {\r\n    return data.sort(function (a, b) {\r\n        var x = a[key];\r\n        var y = b[key];\r\n        if (way === 'asc') {\r\n            return ((x < y) ? -1 : ((x > y) ? 1 : 0));\r\n        }\r\n        if (way === 'desc') {\r\n            return ((x > y) ? -1 : ((x < y) ? 1 : 0));\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Reducir formato numérico a notación abrevidad (K:1000 - M:1000000 - B:1000000000)\r\n */\r\nbizagi.util.shortNumber = function (number) {\r\n    var newNumber = number.toString();\r\n    var lenghtNumber = newNumber.length;\r\n\r\n    if (lenghtNumber >= 4 && lenghtNumber < 7) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'K';\r\n    } else if (lenghtNumber >= 7 && lenghtNumber < 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'M';\r\n    } else if (lenghtNumber >= 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'B';\r\n    }\r\n\r\n    return '&nbsp;&nbsp;&nbsp;' + newNumber;\r\n};\r\n\r\n/*\r\n * Aplicar formato salto de linea\r\n */\r\nbizagi.util.replaceLineBreak = function (string) {\r\n    return typeof string === \"string\" ? string.replace(/\\r\\n|\\r|\\n|<br>|<br\\/>/g, \"<br/>\") : string;\r\n};\r\n\r\n// http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\r\nbizagi.util.escapeHtml = function (str) {\r\n    var div = document.createElement('div');\r\n    div.appendChild(document.createTextNode(str));\r\n    return div.innerHTML;\r\n}\r\n\r\n\r\n/*\r\n * Aplicar formato Tipo moneda\r\n */\r\nbizagi.util.formatMonetaryCell = function (value) {\r\n    return bizagi.util.formatMoney(value, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n};\r\n\r\n/*\r\n * Aplicar formato tipo decimal\r\n */\r\nbizagi.util.formatDecimalCell = function (value) {\r\n    var decimalFormat;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,\r\n        digitGroupSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,\r\n        roundToDecimalPlace: BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n    var numberValue = bizagi.util.formatDecimal(value, decimalFormat);\r\n    if (bizagi.override.removeTrailingZeros === true) {\r\n        var positive = true;\r\n        if (numberValue.toString().indexOf(\")\") != -1) {\r\n            positive = false;\r\n            numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n        }\r\n        var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"$1\");\r\n        re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"\");\r\n\r\n\r\n        if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n    }\r\n    return numberValue;\r\n};\r\n\r\n/*\r\n * Crea notificacion de corta duracion, principalmente uilizada en para los procesos offline\r\n */\r\nbizagi.util.showNotification = function (params) {\r\n    var params = params || {};\r\n    var div_sync = $('<div id=\"sync-notification\" class=\"bz-cm-icon\"></div>').text(params.text || \"\");\r\n    div_sync.appendTo($('body'));\r\n    div_sync.fadeIn(1500, function () {\r\n        div_sync.stop();\r\n    });\r\n\r\n    div_sync.fadeOut(2000, function () {\r\n        div_sync.remove();\r\n    });\r\n};\r\n\r\n/*\r\n * Verificar el estado de la conexión\r\n */\r\nbizagi.util.isModeOnline = function () {\r\n    return typeof bizagi.context.isOfflineForm !== \"undefined\" && !bizagi.context.isOfflineForm;\r\n};\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        } else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        } else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        } else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        } else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    } else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) {\r\n                significantFlag = true;\r\n                from = i;\r\n            } else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') {\r\n                significantFlag = true;\r\n                to = j + 1;\r\n            } else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n\r\n        } else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    } else { return ''; }\r\n};\r\n\r\n/**\r\n * Remove all backslashes that represent scape of characters\r\n */\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/*\r\n * Validates if the text is a valid opening and closing tags, including classes\r\n */\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\nbizagi.util.resetData = function () {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, { isAuthenticate: \"false\" });\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\nbizagi.util.changeData = function (params) {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, params);\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR MOBILE DEVICE\r\n// ------------------------------------------------------------------------\r\n\r\nbizagi.util.isMobileDevice = function (device) {\r\n    device = device || bizagi.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\",\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/** \r\n * Verify mobile device type\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Tablet android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Tablet iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && !(device.indexOf(\"android\") === -1);\r\n};\r\n\r\n\r\n/**\r\n * Verify mobile device type\r\n * @returns {}\r\n */\r\nbizagi.util.isSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Smartphone android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Smartphone iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"ios\") !== -1);\r\n};\r\n\r\n/**\r\n * Check is offline form\r\n * @param {} container \r\n * @returns {} \r\n */\r\nbizagi.util.isOfflineForm = function (params) {\r\n    if (!bizagi.util.isMobileDevice() || typeof (params) === \"undefined\")\r\n        return false;\r\n\r\n    var context = params.context || null;\r\n    var container = params.container || null;\r\n\r\n    var formContainer = container !== null ?\r\n        container : (context !== null ? context.getFormContainer() : null);\r\n\r\n    if (formContainer === null)\r\n        return false;\r\n\r\n    var formParams = formContainer.getParams() || {};\r\n    var isOfflineForm = typeof (formParams.isOfflineForm) !== \"undefined\" &&\r\n        bizagi.util.parseBoolean(formParams.isOfflineForm);\r\n\r\n    return isOfflineForm;\r\n};\r\n\r\nbizagi.util.detectAndroidVersion = function () {\r\n    var indexAndroid = navigator.userAgent.toLowerCase().indexOf(\"android\");\r\n    var androidVersion = navigator.userAgent.toLowerCase().substring(indexAndroid + 8, indexAndroid + 13);\r\n    androidVersion = androidVersion.replaceAll(\".\", \"\");\r\n    return Number(androidVersion);\r\n};\r\n\r\nbizagi.util.getPathUrl = function (url) {\r\n    var solvedUrl = \"\";\r\n    var locationParts = location.pathname.split(\"/\");\r\n    var basePath = location.protocol + \"//\" + location.host;\r\n\r\n    if (BIZAGI_PATH_TO_BASE[0] == \"/\") {\r\n        solvedUrl = basePath + BIZAGI_PATH_TO_BASE + url;\r\n    } else {\r\n        var pathToBaseBackwards = BIZAGI_PATH_TO_BASE.split(\"../\").length;\r\n        for (var i = 0, l = locationParts.length; i < l - pathToBaseBackwards; i++) {\r\n            basePath += locationParts[i] + \"/\";\r\n        }\r\n\r\n        basePath = basePath[basePath.length - 1] === \"/\" ? basePath : basePath + \"/\";\r\n        solvedUrl = basePath + url;\r\n    }\r\n    return solvedUrl;\r\n};\r\n\r\n/**\r\n * Get Android version\r\n * @returns {} \r\n */\r\nbizagi.util.getAndroidVersion = function () {\r\n    var userAgent = navigator.userAgent.toLowerCase();\r\n    var match = userAgent.match(/android\\s([0-9\\.]*)/);\r\n\r\n    return match ? parseFloat(match[1]) : false;\r\n};\r\n\r\n/**\r\n * Get image path to android device\r\n * @param {} image \r\n * @returns {} \r\n */\r\nbizagi.util.mobileImagePath = function (image) {\r\n    var dataImage = image;\r\n    var version = bizagi.util.getAndroidVersion();\r\n\r\n    if (!version)\r\n        return dataImage;\r\n\r\n    if (dataImage.substring(0, 21) === \"content://com.android\" && version <= 4.4) {\r\n        var photoSplit = dataImage.split(\"%3A\");\r\n        if (photoSplit.length > 1) {\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[1];\r\n        } else {\r\n            photoSplit = dataImage.split(\"/\");\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[photoSplit.length - 1];\r\n        }\r\n    }\r\n\r\n    return dataImage;\r\n};\r\n\r\n/**\r\n * Validate resource \r\n * @param {} resource resource name\r\n * @returns {} \r\n */\r\nbizagi.util.isValidResource = function (resource) {\r\n    if (!bizagi.localization) return false;\r\n    return (bizagi.localization.getResource(resource) !== resource);\r\n};\r\n\r\n/***\r\n * Transform base64 image to blob\r\n * @b64Data \r\n * @contentType \r\n * @sliceSize \r\n */\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\n/**\r\n * Converts an string to a byte array, util in old browsers requests\r\n * @param str\r\n */\r\nbizagi.util.stringToByteArray = function (str) {\r\n    var byteArray = new Uint8Array(str.length);\r\n    for (var i = 0; i < str.length; i++) {\r\n        byteArray[i] = str.charCodeAt(i) & 0xff;\r\n    }\r\n    return byteArray;\r\n}\r\n\r\n// ------------------------------------------------------------------------\r\n// NATIVE-HYBRID ENVIRONMENT\r\n// ------------------------------------------------------------------------\r\n\r\n/** \r\n * Verify the offline forms is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.hasOfflineFormsEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_OFFLINE_FORMS) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_OFFLINE_FORMS) === true;\r\n};\r\n\r\n/**\r\n * \r\n * Verify the flat design is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isFlatDesignEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_FLAT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_FLAT) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isMobileGridEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_MOBILE_GRID) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_MOBILE_GRID) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeHeaderEnabled = function () {\r\n    return typeof (NATIVE_HEADER_ENABLE) !== \"undefined\" && bizagi.util.parseBoolean(NATIVE_HEADER_ENABLE) === true;\r\n};\r\n\r\n/**\r\n * Validate the Quick search is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isQuickSearchEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_QUICK_SEARCH) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_QUICK_SEARCH) === true;\r\n};\r\n\r\n/** \r\n * Verify the OAuth2 is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isOAuth2Enabled = function () {\r\n    return typeof (BIZAGI_AUTH_TYPE) !== \"undefined\" && BIZAGI_AUTH_TYPE === \"OAuth\";\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.getNativeComponent = function () {\r\n    return typeof (BIZAGI_NATIVE_COMPONENT) !== \"undefined\" ? BIZAGI_NATIVE_COMPONENT : \"\";\r\n};\r\n\r\n/**\r\n * Check server version\r\n * @returns {}\r\n */\r\nbizagi.util.isVersionSupported = function () {\r\n    var supported = true;\r\n\r\n    if (typeof (BIZAGI_SERVER_VERSION) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_VERSION)) {\r\n        var version = BIZAGI_SERVER_VERSION.match(/\\d+\\.\\d+/);\r\n        supported = version ? (parseFloat(version.shift()) >= 11.0) : true;\r\n    }\r\n\r\n    return supported;\r\n};\r\n\r\n/**\r\n * Cordova componet is supported\r\n * @returns {} \r\n */\r\nbizagi.util.isCordovaSupported = function () {\r\n    return typeof (cordova) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Native plugin of Cordova is supported \r\n * @returns {} \r\n */\r\nbizagi.util.isNativePluginSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Tablet native\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isTabletDevice();\r\n};\r\n\r\n/**\r\n * Smartphone native\r\n * @returns {} \r\n */\r\nbizagi.util.isSmartphoneNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isSmartphoneDevice();\r\n};\r\n\r\n/**\r\n * Enables accesory bar\r\n */\r\nif (bizagi.util.isNativePluginSupported() && window.cordova && window.cordova.plugins.Keyboard) {\r\n    cordova.plugins.Keyboard.hideKeyboardAccessoryBar(false);\r\n};\r\n\r\n/**\r\n * Verify real device\r\n * @returns {} \r\n */\r\nbizagi.util.detectRealDevice = function () {\r\n    var settedDevice = typeof (BIZAGI_DEFAULT_DEVICE) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEFAULT_DEVICE) ?\r\n        BIZAGI_DEFAULT_DEVICE : null;\r\n\r\n    BIZAGI_DEFAULT_DEVICE = \"\";\r\n    var device = bizagi.detectDevice();\r\n    BIZAGI_DEFAULT_DEVICE = settedDevice;\r\n\r\n    return device;\r\n};\r\n\r\n/**\r\n * Method to detect Android visitors\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroid = function () {\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\nbizagi.util.isAndroidDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") > -1;\r\n};\r\n\r\nbizagi.util.isiOSDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") === -1;\r\n};\r\n\r\n\r\n/**\r\n * Get server channel\r\n * @returns {}\r\n */\r\nbizagi.util.getChannelType = function () {\r\n    if (typeof (BIZAGI_SERVER_CHANNEL) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_CHANNEL)) {\r\n        return BIZAGI_SERVER_CHANNEL;\r\n    }\r\n    return bizagi.loader.channel || \"\";\r\n};\r\n\r\n/**\r\n * Check data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.isDataUrl = function (data) {\r\n    var regex = /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i;\r\n\r\n    try {\r\n        return !!(data.toString()).match(regex);\r\n    } catch (error) { }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Get valid data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.getDataUrl = function (properties) {\r\n    var currentUrl;\r\n\r\n    try {\r\n        if (typeof (properties.value) !== \"undefined\" && !bizagi.util.isEmpty(properties.value)) {\r\n            var data = properties.value;\r\n            var url = data.value || data;\r\n\r\n            if (Array.isArray(url)) {\r\n                var tempUrl = url.shift();\r\n                currentUrl = Array.isArray(tempUrl) ? tempUrl.join(\"\") : tempUrl;\r\n            } else {\r\n                currentUrl = url;\r\n            }\r\n        } else {\r\n            currentUrl = properties.url || \"\";\r\n        }\r\n\r\n        currentUrl = !bizagi.util.isEmpty(currentUrl) ? \"data:image/png;base64,\" + currentUrl.replace(/^data:.*;base64,/, \"\") : \"\";\r\n\r\n        if (currentUrl && currentUrl.indexOf(\"Invalid case id\") !== -1)\r\n            currentUrl = \"\";\r\n\r\n    } catch (error) {\r\n        currentUrl = \"\";\r\n    }\r\n\r\n    return currentUrl;\r\n};\r\n\r\n/**\r\n * Get response message of services\r\n * @param {} data\r\n * @returns {}\r\n */\r\nbizagi.util.processFailMessage = function (data) {\r\n    var message = data || {};\r\n\r\n    try {\r\n        message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n        message = message.responseText || (message.message || message);\r\n    } catch (e) {\r\n        message = data;\r\n    }\r\n\r\n    return message;\r\n};\r\n\r\n/**\r\n * Disable and enable workportal menu from live process\r\n */\r\nvar tmp_block_header = \"<div class='blockHeaderByLiveProcess'></div>\";\r\nbizagi.util.disableWorkPortalMenu = function () {\r\n    var blockHeight = $(\"body\").find(\"#ui-bizagi-wp-menu\").height();\r\n    $(tmp_block_header).prependTo(\"body\");\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").css({ \"position\": \"absolute\", \"width\": \"100%\", \"height\": blockHeight + \"px\", \"background\": \"gray\", \"opacity\": \"0.9\", \"z-index\": \"101\" });\r\n}\r\n\r\nbizagi.util.enableWorkPortalMenu = function () {\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").detach();\r\n}\r\n\r\n\r\nbizagi.util.downloadFile = function(url, completeuRL) {\r\n    var ua = window.navigator.userAgent;\r\n    var msie = ua.indexOf(\"MSIE \");\r\n    var ulrToDownload = \"\";\r\n    if(completeuRL){\r\n        ulrToDownload = url;\r\n    }else{\r\n        var arrayURL = url.split(\"/\");\r\n        ulrToDownload = (window.location.href.split(\"#\")[0]) + arrayURL.slice(arrayURL.indexOf(\"Api\"), arrayURL.length).join(\"/\");\r\n    }\r\n    \r\n    if (bizagi.util.isEdge() || msie > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./)) {\r\n        if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n            $(\"<iframe/>\").attr({\r\n                src: ulrToDownload,\r\n                style: \"visibility:hidden;display:none\",\r\n                id: \"iframe-download\"\r\n            }).appendTo('body');\r\n        }else{\r\n            $('#iframe-download').attr(\"src\", (ulrToDownload));\r\n        }\r\n    } else {\r\n        window.open(ulrToDownload);\r\n    }\r\n}\r\n\r\nbizagi.util.executeActionRoutingFromWorkportal = function (idCase, idWorkItem) {\r\n    bizagi.workportal.controllers.menu.prototype.publish(\"executeAction\", {\r\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n        idCase: idCase,\r\n        idWorkItem: idWorkItem\r\n    });\r\n}\r\n\r\n/**\r\n* Gets the final message when the user is offline or online (In Offline forms)\r\n* @param {} state \r\n* @returns {} The corresponding message depending on the case\r\n*/\r\n\r\nbizagi.util.getMessageFromNetworkState = function (state) {\r\n    if (state) {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline-userOnline\", \"The case has been created successfully, please wait until the server synchronizes\");\r\n    } else {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline\", \"Your offline case has been created successfully. It will synchronized as soon as you go online.\");\r\n    }\r\n};\r\n\r\nbizagi.util.sanitizeHTML = function (str) {\r\n\tvar temp = document.createElement('div');\r\n\ttemp.textContent = str;\r\n\treturn temp.innerHTML;\r\n};\r\n\r\nbizagi.util.arrayUnique = function (array) {\r\n    var items = array.concat();\r\n\r\n    for (var i = 0, length = items.length; i < length; ++i) {\r\n        for (var j = i + 1; j < length; ++j) {\r\n            if (items[i] === items[j]) {\r\n                items.splice(j -= 1, 1);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return items;\r\n};\r\n\r\n/**\r\n * Debounce\r\n * Taken from https://davidwalsh.name/javascript-debounce-function\r\n * Returns a function, that, as long as it continues to be invoked,\r\n * will not be triggered. The function will be called after it stops\r\n * being called for N(wait) milliseconds. If `immediate` is passed,\r\n * trigger the function on the leading edge, instead of the trailing.\r\n * \r\n * @param {} func, wait, immediate \r\n * @returns {} The function that that will be called back\r\n */\r\nbizagi.util.debounce = function (func, wait, immediate) {\r\n    var timeout;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        var later = function () {\r\n            timeout = null;\r\n            if (!immediate) func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) func.apply(context, args);\r\n    };\r\n};\r\n\r\n/**\r\n * Validate if the mobile image editor is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeImageEditorSupported = function () {\r\n    return bizagi.util.isNativePluginSupported() && bizagi.util.isiOSDevice() && bizagi.override.enableImageEditor;\r\n};\r\n/**\r\n * Error Message\r\n */\r\nbizagi.util.errorMessage  = function (message) {\r\n    return \"<div class=\\\"admin-stakeholder-message\\\"> \" +\r\n    \"<i class=\\\"bz-wp-empty__img\\\"></i> \" +\r\n    \"<p class=\\\"bz-wp-empty__info bz-wp-empty__info--first\\\"> \" +\r\n    message +\r\n    \"</p></div>\";\r\n};\r\n\r\n\r\n/**\r\n * Validate URL \r\n */\r\nbizagi.util.validateUrlWellFormed  = function (url) {\r\n    var patternToValidateUrl = /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/;\r\n    if(patternToValidateUrl.test(url)){\r\n        var patternToValidateHttp = /^((http|https):\\/\\/)/;\r\n        if(!patternToValidateHttp.test(url)) {\r\n            url = \"http://\" + url;\r\n        }\r\n        return url;\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Replace line breaks for html line breaks\r\n * @param data\r\n * @returns {string}\r\n */\r\nbizagi.util.decodedDisplayValue = function (data) {\r\n    var value = data || \"\";\r\n    var valueToDisplay = \"\";\r\n\r\n    if (typeof (value) === \"string\") {\r\n        var decodedDisplayValue = bizagi.util.decodeURI(value);\r\n\r\n        valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"$\", \"&#36;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n    }\r\n\r\n    return valueToDisplay;\r\n};\r\n\r\n/**\r\n * Set Caret position \r\n * Set the caret in specific position of an element type input\r\n * @param {} func, position, input element \r\n * @returns {} The function not return any value.\r\n */\r\nbizagi.util.setCaretPosition = function (pos, ctrl) {\r\n    var self = this;\r\n\r\n    // Modern browsers\r\n    if (ctrl.setSelectionRange) {\r\n        ctrl.focus();\r\n        ctrl.setSelectionRange(pos, pos);\r\n\r\n        // IE8 and below\r\n    } else if (ctrl.createTextRange) {\r\n        var range = ctrl.createTextRange();\r\n        range.collapse(true);\r\n        range.moveEnd('character', pos);\r\n        range.moveStart('character', pos);\r\n        range.select();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get position of caret\r\n * Get the position of caret in a specific element input\r\n * @param {} func, input element \r\n * @returns {} Return the position of caret in an element input\r\n */\r\nbizagi.util.getCaretPosition = function (oField) {\r\n\r\n    // Initialize\r\n    var iCaretPos = 0;\r\n\r\n    // IE Support\r\n    if (document.selection) {\r\n\r\n        // Set focus on the element\r\n        oField.focus();\r\n\r\n        // To get cursor position, get empty selection range\r\n        var oSel = document.selection.createRange();\r\n\r\n        // Move selection start to 0 position\r\n        oSel.moveStart('character', -oField.value.length);\r\n\r\n        // The caret position is selection length\r\n        iCaretPos = oSel.text.length;\r\n    } else if (oField.selectionStart || oField.selectionStart == '0') // Firefox support\r\n        iCaretPos = oField.selectionStart;\r\n\r\n    // Return results\r\n    return iCaretPos;\r\n};\r\n\r\n/**\r\n * To escape values\r\n * @param {} value \r\n * @returns {} \r\n */\r\nbizagi.util.escapeRegex = function (value) {\r\n    value = value || \"\";\r\n\r\n    return value.replace(/([\\^\\$\\(\\)\\[\\]\\{\\}\\*\\.\\+\\?\\|\\\\])/gi, \"\\\\$1\");\r\n};\r\n\r\n/**\r\n * Function to get a featureObject by path within the global bizagiConfig.features object. Example: \"userService.v1.enabled\"\r\n */\r\nbizagi.util.getFeatureObject = function (path) {\r\n    var arr = path.split('.');\r\n    this.featureObjectCache = this.featureObjectCache || {};\r\n\r\n    function getFeatureObjectIte(arr) {\r\n        var features = bizagi.util.getConfigFeatures();\r\n\r\n        if (typeof path !== \"string\" || typeof features == \"undefined\") return;\r\n\r\n        var pivot = features;\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            pivot = pivot[arr[i]];\r\n            if (typeof pivot === \"undefined\") return;\r\n        }\r\n        return pivot;\r\n    };\r\n    if (path in this.featureObjectCache) {\r\n        return this.featureObjectCache[path];\r\n    } else {\r\n        return this.featureObjectCache[path] = getFeatureObjectIte(arr);\r\n    }\r\n};\r\n\r\n/**\r\n * Load features from mobile\r\n */\r\nbizagi.util.getConfigFeatures = function () {\r\n    var bizagiConfiguration = window.bizagiConfig || bizagiConfig || {};\r\n\r\n    if(bizagi.util.isMobileDevice() && typeof(BIZAGI_MOBILE_FEATURES) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_MOBILE_FEATURES)) {\r\n        bizagiConfiguration.features = JSON.parse(BIZAGI_MOBILE_FEATURES || \"{}\")\r\n    }\r\n\r\n    return bizagiConfiguration.features;\r\n};\r\n\r\n/**\r\n * Reset features flag\r\n */\r\nbizagi.util.resetConfigFeatures = function () {\r\n    bizagi.util.featureObjectCache = undefined;\r\n};\r\n\r\n/**\r\n * Check fail request\r\n * @param result\r\n * @returns {*|boolean}\r\n */\r\nbizagi.util.isFailResponse = function (result) {\r\n    return result && ((result.type && result.type === \"error\") || (result.status && result.status === \"error\") || (result.code && result.code === \"UNKNOWN_ERROR\"));\r\n};\r\n\r\n/**\r\n * Formats value of each item\r\n * @param {string, boolean or array} value\r\n * @example\r\n * value = \"string\" => \"string\"\r\n * value = true => \"yes\" or \"si\", the localized value\r\n * value = false => \"no\", the localized value\r\n * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n * @returns {string}\r\n */\r\nbizagi.util.formatItem = function (value) {\r\n    if (value !== undefined && value !== null) {\r\n        if ($.isArray(value)) {\r\n\r\n            for (var i = 0, length = value.length; i < length; i++) {\r\n                if (value[i] != null && typeof (value[i]) == \"boolean\") {\r\n                    if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n\r\n                    } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                    }\r\n                }\r\n                value[i] = bizagi.util.sanitizeHTML(value[i]);\r\n            }\r\n\r\n            return value.join(\" - \");\r\n        } else {\r\n            return bizagi.util.sanitizeHTML(value);\r\n        }\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\n/**\r\n * Process response to highlight matches\r\n * @param {} item\r\n * @param term\r\n * @returns {}\r\n */\r\nbizagi.util.highlightMatches = function(item, term) {\r\n    var parseValue;\r\n\r\n    switch (typeof item.value) {\r\n        case \"number\":\r\n            parseValue = item.value;\r\n            break;\r\n        case \"object\":\r\n            parseValue = bizagi.util.formatItem(item.value);\r\n            break;\r\n        case \"string\":\r\n            var data = bizagi.util.escapeRegex(term).replaceAll(\"%\", \"\");\r\n            var regEx = new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + data + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\");\r\n\r\n            parseValue = bizagi.util.sanitizeHTML(item.value).replace(regEx, \"<strong>$1</strong>\");\r\n            break;\r\n        default:\r\n            parseValue = item.value;\r\n            break;\r\n    }\r\n\r\n    return parseValue;\r\n};\r\n\r\n/**\r\n * Calculate window resolution for Desktop\r\n * @returns {string}\r\n */\r\nbizagi.util.getDesktopResolution = function() {\r\n    var resolution = \"\";\r\n    var devicePixelRatio = 1;\r\n    var screenWidth = window.screen.width;\r\n    var screenHeight = window.screen.height;\r\n\r\n    if ('deviceXDPI' in screen) {\r\n        devicePixelRatio = screen.deviceXDPI / screen.logicalXDPI;\r\n    } else if ('devicePixelRatio' in window) {\r\n        devicePixelRatio = window.devicePixelRatio;\r\n    }\r\n\r\n    devicePixelRatio = Number(devicePixelRatio.toFixed(3));\r\n\r\n    if ((screenWidth && screenWidth > 0) && (screenHeight && screenHeight > 0)) {\r\n        resolution = (screenWidth * devicePixelRatio) + \"x\" + (screenHeight * devicePixelRatio);\r\n    }\r\n\r\n    return resolution;\r\n};\r\n\r\n/**\r\n * Get the market name for device\r\n * @returns {*|string}\r\n */\r\nbizagi.util.getDeviceCode = function () {\r\n    var deviceCode = \"\";\r\n\r\n    if (bizagi.util.isMobileDevice()) {\r\n        deviceCode = typeof (BIZAGI_DEVICE_MARKET_NAME) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEVICE_MARKET_NAME) ? BIZAGI_DEVICE_MARKET_NAME : \"\";\r\n    } else {\r\n        deviceCode = bizagi.util.getDesktopResolution();\r\n    }\r\n\r\n    return deviceCode;\r\n};\r\n\r\n/**\r\n * Get base name of the control\r\n * @param type\r\n * @returns {*}\r\n */\r\nbizagi.util.normalizeType = function(type) {\r\n    if (typeof (type) === \"undefined\") return type;\r\n\r\n    return type\r\n        .replace(/smartphone/, '')\r\n        .replace(/tablet/, '')\r\n        .replace(/offline/, '');\r\n};\r\n\r\n/**\r\n * Hide or show the X button in the show dialog method \r\n * \r\n */\r\nbizagi.util.hideOrShowXToCloseDialog = function(dialog, show) {\r\n    var selector = \".ui-dialog-titlebar-close\";\r\n    if (show) {\r\n        $(selector, dialog).show();\r\n    } else {\r\n        $(selector, dialog).hide();\r\n    }\r\n};\r\n\r\n/**\r\n * review if a feature key is enabled\r\n * @param {string} feature nombre de la llave del feature\r\n */\r\nbizagi.util.isEnableFeature = function(feature) {\r\n    return bizagi.features[feature]!==false;\r\n};\r\n\r\n/**\r\n * A function to get the scrolling parent of an html element.\r\n */\r\n(function ($) {\r\n\r\n    var parents = function (node, ps) {\r\n        if (node.parentNode === null) return ps;\r\n\r\n        return parents(node.parentNode, ps.concat([node]));\r\n    };\r\n\r\n    var style = function (node, prop) {\r\n        return getComputedStyle(node, null).getPropertyValue(prop);\r\n    };\r\n\r\n    var overflow = function (node) {\r\n        return style(node, \"overflow\") + style(node, \"overflow-y\") + style(node, \"overflow-x\");\r\n    };\r\n\r\n    var scroll = function (node) {\r\n        return /(auto|scroll)/.test(overflow(node));\r\n    };\r\n\r\n    // Get the closest ancestor element that is scrollable.\r\n    $.scrollerParent = function (node) {\r\n        if (!(node instanceof HTMLElement || node instanceof SVGElement)) return;\r\n\r\n        var ps = parents(node.parentNode, []);\r\n\r\n        for (var i = 0; i < ps.length; i += 1) {\r\n            if (scroll(ps[i])) return ps[i];\r\n        }\r\n\r\n        return document.scrollingElement || document.documentElement;\r\n    };\r\n})(jQuery);\r\n\r\nbizagi.util.startkendo = function (params) {\r\n    if (typeof (bizagi.kendoMobileApplication) === \"undefined\") {\r\n        bizagi.kendoMobileApplication = new kendo.mobile.Application($(\"body\"), {\r\n            skin: \"flat\",\r\n            browserHistory: false,\r\n            init: function (e) {\r\n                kendo.ui.progress($(\".km-flat\"), true);\r\n                params.started && params.started();\r\n            }\r\n        });\r\n\r\n        bizagi.kendoMobileApplication.bizagiNavigate = function (e, t) {\r\n            this.navigate(e, t);\r\n        };\r\n    } else {\r\n        params.started && params.started();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.isSharepointContext = function () {\r\n    return typeof (BIZAGI_SHAREPOINT_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_SHAREPOINT_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * Checks if a given value with format {id, value} is empty\r\n * @param value\r\n  * @returns {boolean}\r\n  */\r\nbizagi.util.isEmptyValue = function (value) {\r\n    if (value === 0) return false;\r\n    if (value === undefined || value === null || value === \"\") return true;\r\n    if (typeof (value) === \"Array\") return value.length === 0;\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") return value.length === 0;\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        for (var key in value) {\r\n            if (value.hasOwnProperty(key) && !bizagi.util.isEmptyValue(value[key])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n","/**\r\n * Created by RicardoPD on 4/6/2016.\r\n */\r\n\r\n// Create or define namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.services = (typeof (bizagi.services) !== \"undefined\") ? bizagi.services : {};\r\nbizagi.services.ajax = (typeof (bizagi.services.ajax) !== \"undefined\") ? bizagi.services.ajax : {};\r\nbizagi.log = bizagi.log || function () { };\r\nbizagi.assert = bizagi.assert || function () { };\r\n// Global variables\r\nbizagi.services.ajax.useAbsolutePath = typeof (BIZAGI_USE_ABSOLUTE_PATH) !== \"undefined\" ? BIZAGI_USE_ABSOLUTE_PATH : false;\r\nbizagi.services.ajax.pathToBase = bizagi.services.ajax.useAbsolutePath ? (bizagi.loader.getLocationPrefix()) : (typeof (BIZAGI_PATH_TO_BASE) !== \"undefined\" ? BIZAGI_PATH_TO_BASE : \"\");\r\nbizagi.services.ajax.loginPage = bizagi.services.ajax.pathToBase || \"default.htm\";\r\nbizagi.services.ajax.errorPage = bizagi.services.ajax.pathToBase + \"error.html\";\r\nbizagi.services.ajax.rpcEnabled = false;\r\nbizagi.services.ajax.rpcHandler = \"RestServices/JsonRpcHandler.ashx\";\r\nbizagi.services.ajax.logEnabled = true;\r\nbizagi.services.ajax.logSuccess = true;\r\nbizagi.services.ajax.logSubmits = true;\r\nbizagi.services.ajax.logFail = true;\r\nbizagi.services.ajax.batch = {};\r\nbizagi.services.ajax.batchCount = 0;\r\nbizagi.services.ajax.batchTimer = 100;\r\nbizagi.services.ajax.batchTimeoutInstance = null;\r\n\r\nbizagi.services.ajax.parseJSON = function (data) {\r\n    var result = {};\r\n    // Remove break line\r\n    data = data.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n    \r\n    try {\r\n        result = $.parseJSON(data);\r\n    } catch (e) {\r\n        try {\r\n            // Try to fix some known problems regarding rare ascii characters\r\n            result = $.parseJSON(data.replace(/\\x1d/g, \".\"));\r\n        } catch (ex) {\r\n            result.type = \"error\";\r\n            result.code = e.errorCode;\r\n            result.message = data;\r\n            //Throw exception in next layer\r\n        }\r\n    }\r\n\r\n    if ((result.type && result.type == \"error\") || (result.status && result.status == \"error\")) {\r\n        if (result.code == \"AUTH_ERROR\" || result.code == \"AUTHENTICATION_ERROR\") {\r\n            // Redirect to login page\r\n            /*if (typeof bizagi.services.ajax.loginPage === \"string\") {\r\n             // Remove session storage of authentication data\r\n             sessionStorage.removeItem(\"bizagiAuthentication\");\r\n             if (localStorage.getItem(\"clientLog\") != \"true\") {\r\n             // Reload page\r\n             //window.location = bizagi.services.ajax.loginPage;\r\n             console.warn(\"Debe autenticarse\");\r\n             }\r\n             } else {\r\n             bizagi.services.ajax.loginPage();\r\n             }*/\r\n\r\n        } else if (result.code == \"FED_AUTHENTICATION_ERROR\") {\r\n            /*if (typeof bizagi.services.ajax.loginPage === \"string\") {\r\n             sessionStorage.setItem(\"FED_AUTHENTICATION_ERROR\", true);\r\n             window.location = result.message;\r\n             } else {\r\n             bizagi.services.ajax.loginPage();\r\n             }*/\r\n        }\r\n\r\n        if (result.code == \"licenseError\") {\r\n            window.location = bizagi.services.ajax.errorPage + \"?message=\" + result.message + \"&type=\" + result.type;\r\n        }\r\n        \r\n        var message = (result.code ? result.code : \"\") + (result.message ? \"\" + result.message : \"\");\r\n        jQuery.error(message);\r\n    }\r\n    localStorage.setItem(\"clientLog\", \"false\");\r\n    return result;\r\n}\r\n\r\n$.ajaxSetup({\r\n    converters: {\r\n        \"text json\": bizagi.services.ajax.parseJSON\r\n    },\r\n    beforeSend: function (jqXHR, settings) {\r\n\t\tif (settings.dataType == \"json\" && !settings.batchRequest) {\r\n\t\t\tjqXHR._loading = true;\r\n\t\t\tbizagi && bizagi.loading && bizagi.loading.start();\r\n\r\n\t\t}\r\n\t},\r\n\tcomplete: function (jqXHR) {\r\n\t\tif (jqXHR._loading) {\r\n\t\t\tbizagi && bizagi.loading && bizagi.loading.stop();\r\n\t\t}\r\n\t\tif (jqXHR.status === 401) {\r\n\t\t\tif (jqXHR.responseJSON && jqXHR.responseJSON.validationMethod === \"implicitPrincipalInjection\") {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tbizagi.services.redirectToLoginPage();\r\n\t\t}else  if(jqXHR.status === 503 && typeof(cordova) === \"undefined\") {\r\n\t\t\tbizagi.loader.startPageMaintenance();\r\n\t\t}\r\n\t}\r\n});\r\nvar jqAutoLogin = function jqAutoLogin(options) {\r\n    this.options = {};\r\n    this.user = {};\r\n    this.intercept = false;\r\n    this.refreshing = false;\r\n    this.buffer = [];\r\n    this.currentRequests = [];\r\n\r\n    this._resetOptions();\r\n    this._setupInterceptor();\r\n\r\n    $.extend(this.options, options);\r\n\r\n    this._resetData();\r\n}\r\n\r\n// Public methods\r\n\r\njqAutoLogin.prototype.logout = function logout() {\r\n    this._resetData();\r\n    this._deactivateInterceptor();\r\n    this._fireEvent(\"logout\");\r\n};\r\n\r\njqAutoLogin.prototype.login = function login(user) {\r\n    this.setUserData(user);\r\n    this._activateInterceptor();\r\n    this._fireEvent(\"login\");\r\n};\r\n\r\njqAutoLogin.prototype.setUserData = function setUserData(user){\r\n    this.user = {\r\n        user: user.user || null,\r\n        password: user.password || null,\r\n        domain: user.domain || null\r\n    };\r\n}\r\n\r\n// Private methods\r\n\r\njqAutoLogin.prototype._activateInterceptor = function _activateInterceptor() {\r\n    this.intercept = true;\r\n};\r\n\r\njqAutoLogin.prototype._addToBuffer = function _addToBuffer(settings, deferred) {\r\n    this.buffer.push({\r\n        deferred: deferred,\r\n        settings: settings\r\n    });\r\n};\r\n\r\njqAutoLogin.prototype._clearBuffer = function _clearBuffer() {\r\n    this.buffer = [];\r\n};\r\n\r\njqAutoLogin.prototype._deactivateInterceptor = function _deactivateInterceptor() {\r\n    this.intercept = false;\r\n};\r\n\r\njqAutoLogin.prototype._fireBuffer = function _fireBuffer() {\r\n    var self = this;\r\n    var deferred;\r\n    var promises = [];\r\n\r\n    for(var i in this.buffer) {\r\n        deferred = this.buffer[i].deferred;\r\n\r\n        this.buffer[i].settings.refreshRetry = true;\r\n\r\n        promises.push($.ajax(this.buffer[i].settings).then(deferred.resolve, deferred.reject));\r\n    }\r\n\r\n    this._clearBuffer();\r\n\r\n    $.when.apply($, promises)\r\n        .done(function() {\r\n            self._setRefreshingFlag(false);\r\n        })\r\n        .fail(function(){\r\n            self._setRefreshingFlag(false);\r\n            self.logout();\r\n        });\r\n};\r\n\r\njqAutoLogin.prototype._fireEvent = function _fireEvent(eventType) {\r\n    if (this._hasEvent(eventType)) {\r\n        return this.options.events[eventType]();\r\n    }\r\n};\r\n\r\njqAutoLogin.prototype._hasEvent = function _hasEvent(eventType) {\r\n    return this.options.events[eventType] !== undefined && typeof this.options.events[eventType] === \"function\";\r\n};\r\n\r\njqAutoLogin.prototype._resetData = function _resetData() {\r\n    this.user = {\r\n        user: null,\r\n        password: null,\r\n        domain: null\r\n    };\r\n};\r\n\r\njqAutoLogin.prototype._resetOptions = function _resetOptions() {\r\n    this.options = {\r\n        bufferInterval: 25,\r\n        bufferWaitLimit: 500,\r\n        events: {}\r\n    };\r\n};\r\n\r\njqAutoLogin.prototype._setRefreshingFlag = function _setRefreshingFlag(newFlag) {\r\n    this.refreshing = newFlag;\r\n};\r\n\r\njqAutoLogin.prototype._setupInterceptor = function _setupInterceptor() {\r\n    var self = this;\r\n\r\n    // Credits to gnarf @ http://stackoverflow.com/a/12446363/602488\r\n    $.ajaxPrefilter(function(options, originalOptions, jqxhr) {\r\n        if (options.refreshRetry === true) {\r\n            return;\r\n        }\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        self.currentRequests.push(options.url);\r\n        jqxhr.always(function(){\r\n            self.currentRequests.splice($.inArray(options.url, self.currentRequests), 1);\r\n        });\r\n        jqxhr.done(deferred.resolve);\r\n        jqxhr.fail(function() {\r\n            var args = Array.prototype.slice.call(arguments);\r\n\r\n            if (self.intercept && jqxhr.status === 401 && self._hasEvent(\"sessionExpiration\")) {\r\n                self._addToBuffer(options, deferred);\r\n\r\n                if (!self.refreshing) {\r\n                    self._setRefreshingFlag(true);\r\n                    self._fireEvent(\"sessionExpiration\")\r\n                        .done(function () {\r\n                            // Setup buffer interval that waits for all sent requests to return\r\n                            var waited   = 0;\r\n                            self.interval = setInterval(function(){\r\n                                waited += self.options.bufferInterval;\r\n\r\n                                // All requests have returned 401 and have been buffered\r\n                                if (self.currentRequests.length === 0 || waited >= self.options.bufferWaitLimit) {\r\n                                    clearInterval(self.interval);\r\n                                    self._fireBuffer();\r\n                                }\r\n                            }, self.options.bufferInterval);\r\n                        })\r\n                        .fail(function () {\r\n                            self.logout();\r\n                        });\r\n                }\r\n            } else {\r\n                deferred.rejectWith(jqxhr, args);\r\n            }\r\n        });\r\n\r\n        return deferred.promise(jqxhr);\r\n    });\r\n};\r\n","var jqAutoLogin = function jqAutoLogin(options) {\r\n    this.options = {};\r\n    this.user = {};\r\n    this.intercept = false;\r\n    this.refreshing = false;\r\n    this.buffer = [];\r\n    this.currentRequests = [];\r\n\r\n    this._resetOptions();\r\n    this._setupInterceptor();\r\n\r\n    $.extend(this.options, options);\r\n\r\n    this._resetData();\r\n}\r\n\r\n// Public methods\r\n\r\njqAutoLogin.prototype.logout = function logout() {\r\n    this._resetData();\r\n    this._deactivateInterceptor();\r\n    this._fireEvent(\"logout\");\r\n};\r\n\r\njqAutoLogin.prototype.login = function login(user) {\r\n    this.setUserData(user);\r\n    this._activateInterceptor();\r\n    this._fireEvent(\"login\");\r\n};\r\n\r\njqAutoLogin.prototype.setUserData = function setUserData(user){\r\n    this.user = {\r\n        user: user.user || null,\r\n        password: user.password || null,\r\n        domain: user.domain || null\r\n    };\r\n}\r\n\r\n// Private methods\r\n\r\njqAutoLogin.prototype._activateInterceptor = function _activateInterceptor() {\r\n    this.intercept = true;\r\n};\r\n\r\njqAutoLogin.prototype._addToBuffer = function _addToBuffer(settings, deferred) {\r\n    this.buffer.push({\r\n        deferred: deferred,\r\n        settings: settings\r\n    });\r\n};\r\n\r\njqAutoLogin.prototype._clearBuffer = function _clearBuffer() {\r\n    this.buffer = [];\r\n};\r\n\r\njqAutoLogin.prototype._deactivateInterceptor = function _deactivateInterceptor() {\r\n    this.intercept = false;\r\n};\r\n\r\njqAutoLogin.prototype._fireBuffer = function _fireBuffer() {\r\n    var self = this;\r\n    var deferred;\r\n    var promises = [];\r\n\r\n    for(var i in this.buffer) {\r\n        deferred = this.buffer[i].deferred;\r\n\r\n        this.buffer[i].settings.refreshRetry = true;\r\n\r\n        promises.push($.ajax(this.buffer[i].settings).then(deferred.resolve, deferred.reject));\r\n    }\r\n\r\n    this._clearBuffer();\r\n\r\n    $.when.apply($, promises)\r\n        .done(function() {\r\n            self._setRefreshingFlag(false);\r\n        })\r\n        .fail(function(){\r\n            self._setRefreshingFlag(false);\r\n            self.logout();\r\n        });\r\n};\r\n\r\njqAutoLogin.prototype._fireEvent = function _fireEvent(eventType) {\r\n    if (this._hasEvent(eventType)) {\r\n        return this.options.events[eventType]();\r\n    }\r\n};\r\n\r\njqAutoLogin.prototype._hasEvent = function _hasEvent(eventType) {\r\n    return this.options.events[eventType] !== undefined && typeof this.options.events[eventType] === \"function\";\r\n};\r\n\r\njqAutoLogin.prototype._resetData = function _resetData() {\r\n    this.user = {\r\n        user: null,\r\n        password: null,\r\n        domain: null\r\n    };\r\n};\r\n\r\njqAutoLogin.prototype._resetOptions = function _resetOptions() {\r\n    this.options = {\r\n        bufferInterval: 25,\r\n        bufferWaitLimit: 500,\r\n        events: {}\r\n    };\r\n};\r\n\r\njqAutoLogin.prototype._setRefreshingFlag = function _setRefreshingFlag(newFlag) {\r\n    this.refreshing = newFlag;\r\n};\r\n\r\njqAutoLogin.prototype._setupInterceptor = function _setupInterceptor() {\r\n    var self = this;\r\n\r\n    // Credits to gnarf @ http://stackoverflow.com/a/12446363/602488\r\n    $.ajaxPrefilter(function(options, originalOptions, jqxhr) {\r\n        if (options.refreshRetry === true) {\r\n            return;\r\n        }\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        self.currentRequests.push(options.url);\r\n        jqxhr.always(function(){\r\n            self.currentRequests.splice($.inArray(options.url, self.currentRequests), 1);\r\n        });\r\n        jqxhr.done(deferred.resolve);\r\n        jqxhr.fail(function() {\r\n            var args = Array.prototype.slice.call(arguments);\r\n            var code = \"OLD_SUPPORT\";\r\n            try{\r\n                var response = JSON.parse(jqxhr.responseText);\r\n                code = response.code;\r\n            }\r\n            catch(e){}\r\n\r\n            if (self.intercept && (jqxhr.status === 401 || code === \"AUTHENTICATION_ERROR\") && self._hasEvent(\"sessionExpiration\")) {\r\n                self._addToBuffer(options, deferred);\r\n\r\n                if (!self.refreshing) {\r\n                    self._setRefreshingFlag(true);\r\n                    self._fireEvent(\"sessionExpiration\")\r\n                        .done(function () {\r\n                            // Setup buffer interval that waits for all sent requests to return\r\n                            var waited   = 0;\r\n                            self.interval = setInterval(function(){\r\n                                waited += self.options.bufferInterval;\r\n\r\n                                // All requests have returned 401 and have been buffered\r\n                                if (self.currentRequests.length === 0 || waited >= self.options.bufferWaitLimit) {\r\n                                    clearInterval(self.interval);\r\n                                    self._fireBuffer();\r\n                                }\r\n                            }, self.options.bufferInterval);\r\n                        })\r\n                        .fail(function () {\r\n                            self.logout();\r\n                        });\r\n                }\r\n            } else {\r\n                deferred.rejectWith(jqxhr, args);\r\n            }\r\n        });\r\n\r\n        return deferred.promise(jqxhr);\r\n    });\r\n};\r\n\r\n","/*\r\n*   Name: BizAgi Services WorkPortal End Points\r\n*   Author: Diego Parra (based on Edward Morales version)\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\r\n\r\n// Create or define namespace\r\nbizagi.workportal = (typeof (bizagi.workportal) !== \"undefined\") ? bizagi.workportal : {};\r\nbizagi.workportal.services = (typeof (bizagi.workportal.services) !== \"undefined\") ? bizagi.workportal.services : {};\r\nbizagi.workportal.services.endPoints = [];\r\n\r\n// Creates a endpoint hash factory to resolve custom requirements\r\nbizagi.workportal.services.getEndPoints = function (params) {\r\n    // Default workportal end-points\r\n    if (params.context == \"workportal\") {\r\n        var endPoints = {\r\n            \"user-handler\": params.proxyPrefix + \"RestServices/UserHandler.ashx\",\r\n            \"process-handler\": params.proxyPrefix + \"RestServices/ProcessHandler.ashx\",\r\n            \"query-handler\": params.proxyPrefix + \"Rest/Handlers/Query\",\r\n            \"case-handler\": params.proxyPrefix + \"RestServices/CaseHandler.ashx\",\r\n            \"query-form\": params.proxyPrefix + \"App/ListaDetalle/QueryForm.aspx\",\r\n            \"query-form-edit\": params.proxyPrefix + \"App/ListaDetalle/SaveQuery.aspx\",\r\n            \"query-form-delete\": params.proxyPrefix + \"App/ListaDetalle/QueryForm.aspx\",\r\n            \"query-form-delete-cube\": params.proxyPrefix + \"Rest/Queries/Cubes/{idCube}\",\r\n            \"favorites-handler\": params.proxyPrefix + \"RestServices/FavoritesHandler.ashx\",\r\n            \"file-handler\": params.proxyPrefix + \"RestServices/EntityHandler.ashx\",\r\n            \"login-handler\": params.proxyPrefix + \"Rest/Users/UserAuthentication\",\r\n            \"login-handlerv10\": params.proxyPrefix + \"RestServices/UserHandler.ashx?action=authenticateUser&userName={0}&password={1}&domain={2}\",\r\n            \"logoff-handler\": params.proxyPrefix + \"RestServices/UserHandler.ashx?action=logOff\",\r\n            \"logoff-handlerv1\": params.proxyPrefix + \"Rest/Users/LogOff\",\r\n\r\n            // Rest Services\r\n            \"authorization-handler-getMenuAuthorization\": params.proxyPrefix + \"Rest/Authorization/MenuAuthorization\",\r\n            \"authorization-handler-isCaseCreationAuthorized\": params.proxyPrefix + \"Rest/Authorization/Processes/{0}/IsCaseCreationAuthorized\",\r\n            \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/Summary\",\r\n\r\n            //ReleaseActivityResponse\r\n            \"case-handler-releaseActivity\": params.proxyPrefix + \"Rest/Cases/{idCase}/ReleaseActivity\",\r\n\r\n            //mobile beta services\r\n            \"case-handler-getCasesList\": params.proxyPrefix + \"Rest/Processes/SearchCases\",\r\n            \"case-handler-getActivityList\": params.proxyPrefix + \"Api/Cases/Activities\",\r\n        \r\n            // Services to Offline capability\r\n            \"offline-getProcessTree\": params.proxyPrefix + \"Rest/Processes/OfflineProcessTree\",\r\n\r\n            //\"offline-getForms\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"offline-tasks\": params.proxyPrefix + \"Api/Cases/GetOfflineTasks\",\r\n            \"offline-getForms\": params.proxyPrefix + \"Rest/RenderForm/offlineForms\",\r\n            \"offline-sendForm\": params.proxyPrefix + \"Rest/Cases/SaveAsynchWorkItemOffLine\",\r\n\r\n            // StartProcess\r\n            \"case-handler-getCaseTasks\": params.proxyPrefix + \"Rest/Cases/{idCase}/Tasks\",\r\n            \"case-handler-getCaseEvents\": params.proxyPrefix + \"Rest/Cases/{idCase}/Events\",\r\n            \"case-handler-getCaseSubprocesses\": params.proxyPrefix + \"Rest/Cases/{idCase}/Subprocesses\",\r\n            \"case-handler-getTaskAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Tasks/{idTask}/Assignees\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Assignees\",\r\n            \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getAsynchExecutionState\": params.proxyPrefix + \"Rest/Cases/{idCase}/AsynchExecutionState\",\r\n            \"case-handler-addNewCase\": params.proxyPrefix + \"Rest/Cases\",\r\n            \"case-handler-startProcess\": params.proxyPrefix + \"Rest/Processes/StartProcess/{idProcess}\",\r\n            \"handler-execute-action-start\": params.proxyPrefix + \"Api/Cases/{processId}/Start\",\r\n            \"case-handler-supportedLogTypes\": params.proxyPrefix + \"Rest/Cases/SupportedLogsTypes\",\r\n            \"case-handler-getActivityLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/ActivityLog\",\r\n            \"case-handler-getActivityDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/{idWorkItemFrom}/ActivityDetailLog\",\r\n            \"case-handler-getEntityLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/EntityLog\",\r\n            \"case-handler-getEntityDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/EntityDetailLog\",\r\n            \"case-handler-getUserLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/UserLog\",\r\n            \"case-handler-getUserDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/{idUser}/UserDetailLog\",\r\n            \"case-handler-getAdminLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/AdminLog\",\r\n            \"case-handler-getCaseFormsRenderVersion\": params.proxyPrefix + \"Rest/Cases/{idCase}/FormsRenderVersion\",\r\n            \"case-handler-validateHasStartForm\": params.proxyPrefix + \"Api/Processes/{processId}/StartContext\",\r\n\r\n            //Favorites Restful\r\n            \"favorites-handler-saveFavorite\": params.proxyPrefix + \"Rest/Favorites\",\r\n            \"favorites-handler-deleteFavorite\": params.proxyPrefix + \"Rest/Favorites/{guidFavorite}\",\r\n\r\n            //ICONS && IMAGES\r\n            \"process-getIcon\": params.proxyPrefix + \"Api/Processes/{processId}/Icon\",\r\n            \"collections-getIcon\": params.proxyPrefix + \"Api/CurrentUser/Collections/{collectionId}/Icon\",\r\n\r\n            //BAMAnalytics Restful\r\n            \"bamAnalytics-handler-getAnalisysQueries\": params.proxyPrefix + \"Rest/BAMAnalytics/AnalisysQueries\",\r\n            \"bamAnalytics-handler-updateQuery\": params.proxyPrefix + \"Rest/BAMAnalytics/Reports/Ids/{idQuery}\",\r\n\r\n            //Inbox Restful\r\n            \"inbox-handler-getInboxSummary\": params.proxyPrefix + \"Rest/Inbox/Summary\",\r\n\r\n            //Messages Restful\r\n            \"MessageHandler-NewComment\": params.proxyPrefix + \"Rest/Cases/Comments\",\r\n            \"MessageHandler-GetComments\": params.proxyPrefix + \"Rest/Cases/Comments\",\r\n            \"MessageHandler-SetCategoryToComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}\",\r\n            \"MessageHandler-RemoveComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}\",\r\n            \"MessageHandler-ReplyComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/Replies\",\r\n            \"MessageHandler-RemoveReply\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/Replies/{idReply}\",\r\n            \"MessageHandler-GetCategoryColors\": params.proxyPrefix + \"Rest/Cases/Comments/CategoryColors\",\r\n            \"MessageHandler-RenameCategoryColor\": params.proxyPrefix + \"Rest/Cases/Comments/CategoryColors/{idColorCategory}\",\r\n            \"MessageHandler-CountNewComments\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/NewComments/Count\",\r\n\r\n            //Processes Restful\r\n            \"process-handler-getAllProcesses\": params.proxyPrefix + \"Rest/Processes\",\r\n            \"process-handler-getFavourites\": params.proxyPrefix + \"Rest/Home/MyFavorites/Count\",\r\n            \"process-handler-getFavouriteCases\": params.proxyPrefix + \"Rest/Home/MyFavorites\",\r\n            \"process-handler-getCustomizedColumnsData\": params.proxyPrefix + \"Rest/Processes/CustomizedColumnsData\",\r\n            \"process-handler-getCategory\": params.proxyPrefix + \"Rest/Processes/Categories\",\r\n            \"process-handler-getRecentProcesses\": params.proxyPrefix + \"Rest/Processes/RecentProcesses\",\r\n            \"process-handler-getCustomizedColumnsDataInfo\": params.proxyPrefix + \"Rest/Processes/CustomizedColumnsDataInfo\",\r\n            \"process-handler-getOrganizations\": params.proxyPrefix + \"Rest/Profile/Organizations\",                                              \r\n\r\n            //workportal\r\n            \"process-handler-getMyStuff\": params.proxyPrefix + \"Api/CurrentUser/Collections\",\r\n            \"process-handler-getIdCasesOfProcessEntities\": params.proxyPrefix + \"Api/Entities/Cases\",\r\n\t        \"templates-handler-getCollectionData\": params.proxyPrefix + \"Api/Collection/{idFact}/Data\",\r\n            //\"data-navigation-handler\": params.proxyPrefix + \"Api/Entities/{guidLeftEntity}/Data/{surrogateKeyLeftEntity}\",\r\n            \"data-navigation-handler-collection\": params.proxyPrefix + \"Api/CurrentUser/Collections/{reference}/Data/{surrogateKey}\",\r\n            \"data-navigation-handler-entity\": params.proxyPrefix + \"Api/CurrentUser/Entities/{reference}/Data/{surrogateKey}/{xpath}\",\r\n            \"data-navigation-handler-entity-filters\": params.proxyPrefix + \"Api/CurrentUser/Entities/{reference}/Filters/{surrogateKey}/{xpath}\",\r\n\r\n            //\"action-handler-getProcessAddAction\": params.proxyPrefix + \"Api/Entities/{guidLeftEntity}/Collection/{guidFact}/Actions\",\r\n            \"action-handler-getProcessAddAction\": params.proxyPrefix + \"Api/CurrentUser/Collections/{reference}/{surrogateKey}/Actions\",\r\n\r\n            //My Searches\r\n            'my-search-getSearchLists': params.proxyPrefix + \"Api/CurrentUser/Searches\",\r\n            'my-search-getFilters': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/Filters\",\r\n            'my-search-getFiltersData': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/FilterData\",\r\n            'my-search-getData': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/Data\",\r\n\r\n            \"templates-handler-getVirtualCollectionData\" : params.proxyPrefix + \"Api/Collection/{guidVirtualCollection}/VirtualData\",\r\n            \"templates-handler-getMultipleActions\" : params.proxyPrefix + \"Rest/Entities/multipleInstancesActions\",\r\n            \r\n            \"process-handler-getMapping\" : params.proxyPrefix + \"Rest/Entities/Mapping\",\r\n            \"process-handler-getForm\" : params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"process-handler-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            //\"process-handler-rule\": params.proxyPrefix + \"Rest/Action/Rule\",\r\n            \"process-handler-rule\": params.proxyPrefix + \"Api/Rules/{ruleId}/Execute\",\r\n            //\"process-action-execute\" : params.proxyPrefix + \"Api/Action/Execute\",\r\n            \"process-action-execute\": params.proxyPrefix + \"Api/Rules/{ruleId}/ExecuteMultiple\",\r\n            \"process-handler-getActivitiesData\": params.proxyPrefix + \"Api/Processes/CasesData/MyActivities\",\r\n            \"process-handler-getPendingsData\": params.proxyPrefix + \"Api/Processes/CasesData/MyPendings\",\r\n            \r\n            //\"entities-handler-getActions\" : params.proxyPrefix + \"Rest/Entities/Actions\",\r\n            \"entities-handler-getActions\": params.proxyPrefix + \"Api/Entities/{guidEntity}/{surrogateKey}/actions\",\r\n            \"entities-handler-getUsersAndEvents\" : params.proxyPrefix + \"Rest/Processes/CasesData/UsersAndEvents\",\r\n            \"entities-handler-getUsers\" : params.proxyPrefix + \"Api/Cases/{caseId}/Users\",\r\n            \"entities-handler-getEvents\" : params.proxyPrefix + \"Api/Cases/{caseId}/CurrentEvents\",\r\n            \"entities-handler-getUsersImages\" : params.proxyPrefix + \"Rest/Users/UserPictures\",\r\n            \"entities-handler-getShotCuts\" : params.proxyPrefix + \"Api/CurrentUser/Shortcuts\",\r\n            \r\n            //Queries Restful\r\n            \"query-handler-getqueries\": params.proxyPrefix + \"Rest/Queries\",\r\n            \"query-handler-getQueryForm\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n\r\n            //Users Restful\r\n            \"user-handler-getCurrentUser\": params.proxyPrefix + \"Rest/Users/CurrentUser\",\r\n\r\n            // Old render integration, readonly\r\n            \"old-render\": params.proxyPrefix + \"App/ListaDetalle/Detalle.aspx\",\r\n\r\n            //Service locator for reports\r\n            \"Reports\": params.proxyPrefix + \"RestServices/BAMAnalyticsHandler.ashx\",\r\n            \"reports-handler-deleteQueries\": params.proxyPrefix + \"Rest/BAMAnalytics/Reports/{QueryId}\",\r\n\r\n            //Service locator for bizagi folders\r\n            \"folders-handler-getUserQueries\": params.proxyPrefix + \"Rest/SmartFolders\",\r\n            \"folders-associate-deleteSmartFolder\": params.proxyPrefix + \"Rest/SmartFolders/{idSmartFolder}\",\r\n            \"folders-handler\": params.proxyPrefix + \"RestServices/SmartFoldersHandler.ashx\",\r\n            \"folders-associate\": params.proxyPrefix + \"App/Ajax/AJAXGateway.aspx\",\r\n            \"smartfolders-integration\": params.proxyPrefix + \"App/WorkPortal/ConfigureFilteredFolder.aspx\",\r\n\r\n            //Service locator for menu\r\n            \"AlarmAdmin\": params.proxyPrefix + \"App/Admin/AlarmsAdmin.aspx\",\r\n            \"AnalyticsProcess\": params.proxyPrefix + \"App/Cockpit/AnalyticsProcess.aspx\",\r\n            \"AnalyticsSensor\": params.proxyPrefix + \"App/Cockpit/AnalyticsSensor.aspx\",\r\n            \"AnalyticsTask\": params.proxyPrefix + \"App/Cockpit/AnalyticsTask.aspx\",\r\n            \"AsynchronousWorkitemRetries\": params.proxyPrefix + \"App/Admin/AsynchDisabledWorkitems.aspx\",\r\n            \"AuthenticationLogQuery\": params.proxyPrefix + \"App/Admin/AuthLogQuery.aspx\",\r\n            \"BAMProcess\": params.proxyPrefix + \"App/Cockpit/BAMProcess.aspx\",\r\n            \"BAMTask\": params.proxyPrefix + \"App/Cockpit/BAMTask.aspx\",\r\n            \"BusinessPolicies\": params.proxyPrefix + \"App/Admin/BusinessPolicies/BusinessPoliciesSelector.aspx\",\r\n            \"CaseAdmin\": params.proxyPrefix + \"App/Admin/CaseSearch.aspx\",\r\n            \"adminReassignCases\": \"CaseAdmin\", // Open workportal module called 'adminCases'\r\n            \"asyncECMUpload\": \"asyncECMUpload\", // Open workportal module called 'asyncECMUpload'\r\n            \"CasesMonitor\": params.proxyPrefix + \"App/Admin/CasesMonitor.aspx\",\r\n            \"Closed\": params.proxyPrefix + \"App/ListaDetalle/listaitems.aspx?h_Location=Cerrados&I_ProcessState=Completed\",\r\n            \"CurrentUser\": params.proxyPrefix + \"App/Admin/CurrentUser.aspx\",\r\n            \"EncryptionAdmin\": params.proxyPrefix + \"App/Admin/Encrypt.aspx\",\r\n            \"MobileUpdatesAdmin\": params.proxyPrefix + \"App/MobileUpdates/default.aspx\",\r\n            \"EntityAdmin\": params.proxyPrefix + \"App/Admin/Entity.aspx\",\r\n            \"LocationResources\": params.proxyPrefix + \"App/Admin/AdminLocResources.aspx\",\r\n            \"NewCase\": params.proxyPrefix + \"App/Radicar/application.aspx\",\r\n            \"Pending\": params.proxyPrefix + \"App/ListaDetalle/listaitems.aspx?h_Location=Pendientes&I_processState=Running\",\r\n            \"Profiles\": params.proxyPrefix + \"App/Admin/ProfilesAdminSearch.aspx\",\r\n            \"Search\": params.proxyPrefix + \"App/ListaDetalle/Search.aspx\",\r\n            \"UserAdmin\": params.proxyPrefix + \"App/Admin/ListUsers.aspx\",\r\n            \"UserDefaultAssignation\": params.proxyPrefix + \"App/Admin/DefaultAssignationUser.aspx?h_AdminDefaultAssign=1\",\r\n            \"UserPendingRequests\": params.proxyPrefix + \"App/Admin/UserPendingRequests.aspx\",\r\n            \"ListPreferences\": (bizagi.UserPreferencesUrl !== \"\") ? params.proxyPrefix + bizagi.UserPreferencesUrl : params.proxyPrefix + \"App/Admin/CurrentUser.aspx\",\r\n            \"GRDimensionAdmin\": params.proxyPrefix + \"App/Cockpit/DimensionEdit.aspx\",\r\n            \"Licenses\": params.proxyPrefix + \"App/Admin/Licenses.aspx\",\r\n            \"AnalysisQueries\": params.proxyPrefix + \"App/Inicio/WPAnalysisQuery.aspx\",\r\n            \"DocumentTemplates\": params.proxyPrefix + \"App/Admin/AdminDocumentTemplates.aspx\",\r\n            \"ProcessAdmin\": params.proxyPrefix + \"App/Admin/AdminProcess.aspx\",\r\n            \"ResourceBAM\": params.proxyPrefix + \"App/Cockpit/BAMResourceMonitor.aspx\",\r\n            \"WorkPortalVersion\": params.proxyPrefix + \"Rest/Util/Version\",\r\n\r\n            // entities administration\r\n            \"entities-administration\": \"RestServices/EntityHandler.ashx\",\r\n\r\n            //Theme Rest Service Handler\r\n            \"theme-handler-getLogoImagePath\": params.proxyPrefix + \"Rest/Theme/LogoImage\",\r\n\r\n            // Logout Service, already implemented on java environment\r\n            \"logout\": params.proxyPrefix + \"Rest/Authentication/logout\",\r\n            \"logoutDotNet\": params.proxyPrefix + \"App/Inicio/LogOff.aspx\",            \r\n            \"authenticationConfig\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\r\n            \"logout-oauth2\": params.proxyPrefix + \"Api/Authentication/OAuth2/IdentityProvider/Server/Logout\",\r\n            \"FederateLogoffUrl\": params.proxyPrefix + \"Api/Authentication/FederateLogoffUrl\",\r\n            \"oauth2AuthenticationConfig\": params.proxyPrefix + \"Api/Authentication/OAuth2/OAuth2AuthenticationConfig\",\r\n\r\n            //Massive Activity Asigments\r\n            \"massive-activity-assignments-getOrganizationInfo\": params.proxyPrefix + \"Rest/Users/OrganizationInfo\",\r\n            \"massive-activity-assignments-getCasesByOrganization\": params.proxyPrefix + \"Rest/Queries/GetCasesByOrganization\",\r\n            \"massive-activity-assignments-reassignCases\": params.proxyPrefix + \"Rest/Cases/ReassignCases\",\r\n            \"massive-activity-assignments-searchUsers\": params.proxyPrefix + \"Rest/Users/\",\r\n\r\n            //Asynchronous ECM Upload\r\n            \"async-ecm-upload-baseService\": params.proxyPrefix + \"Rest/Handlers/Metadata\",\r\n\r\n            // Workportal\r\n            \"domains\": params.proxyPrefix + \"Rest/Authentication/Domains\",\r\n\r\n            // Theme Builder\r\n            //\"ThemeBuilder\": params.proxyPrefix + \"ThemeBuilder/index.html?language=\" + bizagi.localization.language,\r\n            \"getCurrentTheme\": params.proxyPrefix + \"Api/Theme/Current\",\r\n\r\n            //Frankenstein\r\n            \"admin-getAuthenticationLog\": params.proxyPrefix + \"Rest/Users/AuthLog\",\r\n            \"admin-getAuthenticationDomains\": params.proxyPrefix + \"Rest/Users/Domains\",\r\n            \"admin-getAuthenticationEventsTypes\": params.proxyPrefix + \"Rest/Users/EventTypes\",\r\n            \"admin-getAuthenticationEventSubTypes\": params.proxyPrefix + \"Rest/Users/EventSubTypes\",\r\n            \"admin-EncryptString\": params.proxyPrefix + \"Rest/Util/EncryptString\",\r\n            \"admin-UserPendingRequests\": params.proxyPrefix + \"Rest/Users/UserPendingRequests\",\r\n            \"admin-UserAuthenticationInfo\": params.proxyPrefix + \"Rest/Users/UserAuthenticationInfo\",\r\n            \"admin-updateUserAuthenticationInfo\": params.proxyPrefix + \"Rest/Users/UpdateUserAuthenticationInfo\",\r\n            \"admin-generateRandomPassword\": params.proxyPrefix + \"Rest/Util/GenerateRandomPassword\",\r\n            \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\r\n            \"admin-sendEmail\": params.proxyPrefix + \"Rest/Util/SendEmail/\",\r\n            \"admin-getApplicationList\": params.proxyPrefix + \"Rest/Application\",\r\n            \"admin-getApplicationProcesses\": params.proxyPrefix + \"Rest/Application/{idApp}/Process\",\r\n            \"admin-getProcessVersion\": params.proxyPrefix + \"Rest/Processes/Version\",\r\n            \"admin-getProcessTasks\": params.proxyPrefix + \"Rest/Processes/Version/{version}/Tasks\",\r\n\r\n            //servicios alarmas\r\n            \"admin-getTaskAlarms\": params.proxyPrefix + \"Rest/Alarm/TaskAlarms\",\r\n            \"admin-getLapseMode\": params.proxyPrefix + \"Rest/Alarm/LapseMode\",\r\n            \"admin-getRecurrMode\": params.proxyPrefix + \"Rest/Alarm/RecurrMode\",\r\n            \"admin-getScheduleType\": params.proxyPrefix + \"Rest/Alarm/ScheduleType\",\r\n            \"admin-getBossList\": params.proxyPrefix + \"Rest/Alarm/Boss\",\r\n            \"admin-addAlarm\": params.proxyPrefix + \"Rest/Alarm\",\r\n            \"admin-editAlarm\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}\",\r\n            \"admin-deleteAlarm\": params.proxyPrefix + \"Rest/Alarm\",\r\n            \"admin-alarmRecipients\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}/Recipient\",\r\n            \"admin-deleteAlarmRecipients\": params.proxyPrefix + \"Rest/Alarm/Recipient\",\r\n            \"admin-recipientToAlarm\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}/Recipient/{idRecipient}\",\r\n            \"admin-enableAlarm\": params.proxyPrefix + \"Rest/Alarm/Task/{idTask}/ToggleAlarm\",\r\n            \"admin-getCategoriesList\": params.proxyPrefix + \"Rest/Application/Category\",\r\n            \"admin-getCasesList\": params.proxyPrefix + \"Rest/Queries/SearchCases\",\r\n            \"admin-abortItems\": params.proxyPrefix + \"Rest/Cases/Abort\",\r\n            \"admin-reassignItems\": params.proxyPrefix + \"Rest/Cases/Reassign\",\r\n            \"admin-getDefaultAssignationUserToAllProcess\": params.proxyPrefix + \"Rest/Users/{serviceAction}/\",\r\n            \"admin-getDefaultAssignationUserToProcess\": params.proxyPrefix + \"Rest/Users/Process/{process}/AssignationUser\",\r\n            \"admin-setDefaultAssignationUserToProcess\": params.proxyPrefix + \"Rest/Users/Process/{process}/AssignationUser\",\r\n            \"admin-getProfilesTypes\": params.proxyPrefix + \"Rest/Profile/Types\",\r\n            \"admin-searchProfiles\": params.proxyPrefix + \"Rest/Profile\",\r\n            \"admin-getUsersByProfile\": params.proxyPrefix + \"Rest/Users/Profile/{type}/{id}\",\r\n            \"admin-removeUserFromProfile\": params.proxyPrefix + \"Rest/Profile/{type}/{id}/User/{idUser}/\",\r\n            \"admin-addUserToProfile\": params.proxyPrefix + \"Rest/Profile/{type}/{id}/User/{idUser}/\",\r\n            \"admin-async-activities-get-activities\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Activities\",\r\n            \"admin-async-activities-get-retry-now\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idworkItem}/RetryNow\",\r\n            \"admin-async-activities-get-activities-by-task\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Activities/Task\",\r\n            \"admin-async-activities-enable-execution\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Enable\",\r\n            \"admin-async-activities-enable-multiple\": params.proxyPrefix + \"Rest/Cases/Asynchronous/EnableMultiple\",\r\n            \"admin-async-activities-async-execution\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idWorkitem}/AsynchExecution\",\r\n            \"admin-async-activities-async-execution-log\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idworkItem}/AsynchExecutionLog\",\r\n            \"admin-Licenses\": params.proxyPrefix + \"Rest/Licenses\",\r\n            \"admin-GetDimensions\": params.proxyPrefix + \"Rest/Dimensions\",\r\n            \"admin-EditDimension\": params.proxyPrefix + \"Rest/Dimensions/{id}\",\r\n            \"admin-CreateAdministrableDimension\": params.proxyPrefix + \"Rest/Dimensions/Administrable\",\r\n            \"admin-DeleteDimension\": params.proxyPrefix + \"Rest/Dimensions/{id}?isAdministrable={administrable}\",\r\n            \"admin-EntityPathChildNodesAction\": params.proxyPrefix + \"Rest/Dimensions/EntityChildNodes\",\r\n            \"admin-GetActiveWFClasses\": params.proxyPrefix + \"Rest/Dimensions/ActiveProcess\",\r\n            \"admin-document-templates-storeDocumentTemplates\": params.proxyPrefix + \"Rest/DocumentTemplates/StoreDocumentTemplates\",\r\n            \"admin-document-templates-restoreDocumentTemplates\": params.proxyPrefix + \"Rest/DocumentTemplates/RestoreDocumentTemplate\",\r\n            \"admin-document-templates-uploadDocumentTemplate\": params.proxyPrefix + \"Rest/DocumentTemplates/UploadDocumentTemplate\",\r\n            \"admin-processes-workflowClasses\": params.proxyPrefix + \"Rest/Processes/WorkflowClasses\",\r\n            \"admin-processes-tasksByWorkflow\": params.proxyPrefix + \"Rest/Processes/TasksByWorkflow\",\r\n            \"admin-processes-modifyProcessDuration\": params.proxyPrefix + \"Rest/Processes/{idWorkflow}/Duration/\",\r\n            \"admin-processes-modifyTaskDuration\": params.proxyPrefix + \"Rest/Processes/Task/{idTask}/Duration/\",\r\n            \"admin-language-resource\": params.proxyPrefix + \"Rest/Multilanguage/Resource\",\r\n            \"admin-language-languages\": params.proxyPrefix + \"Rest/Multilanguage/Languages\",\r\n            \"bam-resourcemonitor-myteam\": params.proxyPrefix + \"Rest/Reports/BAM/Resources/MyTeam\",\r\n            \"reports-analysisquery\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\r\n            \"reports-analysisquery-update\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\r\n            \"reports-analysisquery-delete\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\r\n            \"processviewer-processdefinition\": params.proxyPrefix + \"Rest/Reports/Components/ProcessDefinition\",\r\n            \"processviewer-processgraphicinfo\": params.proxyPrefix + \"Rest/Reports/Components/ProcessGraphicInfo\",\r\n            \r\n             // Mobile Updates\r\n            \"mobile-getLastUpdate\": params.proxyPrefix + \"Rest/Util/mobileUpdates\",\r\n\r\n            //discussionCase\r\n            \"discussion-case\": params.proxyPrefix + \"Api/CaseResource/Discussion?globalParent={globalParent}\",\r\n            \"discussion-case-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/Discussion\",\r\n            \"get-users\": params.proxyPrefix + \"Rest/Users/UserPictures\",\r\n            \"new-discussion\": params.proxyPrefix + \"Api/CaseResource/Discussion\",\r\n            \"count-comments\": params.proxyPrefix + \"Api/CaseResource/{idParent}/Comment/Count\",\r\n            \"comment-case\": params.proxyPrefix + \"Api/CaseResource/{idParent}/Comment\",\r\n            \"new-comment\": params.proxyPrefix + \"Api/CaseResource/Comment\",\r\n            \"new-comment-attach\": params.proxyPrefix + \"Api/CaseResource/Attachment\",\r\n            \"get-list-files\": params.proxyPrefix + \"Api/CaseResource/File?globalParent={globalParent}\",\r\n            \"get-list-files-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/File\",\r\n            \"project-resource-action\": params.proxyPrefix + \"Api/CaseResource/{typeResource}\",\r\n            \"thumbnail-file\": params.proxyPrefix + \"Api/CaseResource/File/Thumbnails\",\r\n            \"get-attachment\": params.proxyPrefix + \"Api/CaseResource/Attachment/{idAttachment}\",\r\n            \"get-mobile-attachment\": params.proxyPrefix + \"Api/CaseResource/Mobile/Attachment/{idAttachment}\",\r\n\r\n            //Files and Attachments\r\n            \"project-files-upload\": params.proxyPrefix + \"Api/CaseResource/File\",\r\n            \"count-files\": params.proxyPrefix + \"Api/CaseResource/File/Count?globalParent={globalParent}\",\r\n            \"count-files-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/File/Count\",\r\n            \"remove-comment\": params.proxyPrefix + \"Api/CaseResource/Comment\",\r\n\r\n            //Mobile CaseSummary\r\n            \"time-schemas-effectiveduration\": params.proxyPrefix + \"Api/WorkingTimeSchema/EffectiveDuration?idUser={idUser}&fromDate={fromDate}&toDate={toDate}\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Assignees\",\r\n            \"project-users-get\": params.proxyPrefix + \"Rest/Users/UserPictures\",\r\n\r\n            //Mobile plans\r\n            \"project-plan-get\": params.proxyPrefix + \"Api/Plans/{idPlan}\",\r\n            \"project-plan-activities\": params.proxyPrefix + \"Api/Plans/{idPlan}/Activities\",\r\n            \"project-plan-workitems\": params.proxyPrefix + \"Api/Plans/{idPlan}/WorkItems\",\r\n            \"project-plan-transitions-get\": params.proxyPrefix + \"Api/Plans/{idPlan}/Activities/Transitions\",\r\n            \"project-plan-activity-edit\": params.proxyPrefix + \"Api/Plans/{idPlan}/Activities/{id}\",\r\n            \"project-plan-get-by-parent\": params.proxyPrefix + \"Api/Plans?parentWorkItem={parentWorkItem}\",\r\n            \"project-plan-parent\": params.proxyPrefix + \"Api/Plans/{idPlan}/ParentCase\",\r\n            \"project-plan-update\": params.proxyPrefix + \"Api/Plans/{idPlan}\",\r\n            \"project-plan-execute\": params.proxyPrefix + \"Api/Plans/Execute\",\r\n            \"project-plan-close\": params.proxyPrefix + \"Api/Plans/Close\",\r\n            \"project-plan-delete\": params.proxyPrefix + \"Api/Plans/{idPlan}\",\r\n            \"project-plan-first-parent-plan\": params.proxyPrefix + \"Api/Plans/{idPlan}/FirstParentPlan\"\r\n        };\r\n\r\n        var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\r\n        if (newUserServices) {\r\n\r\n            endPoints[\"user-handler-getCurrentUser\"] = params.proxyPrefix + \"Rest/Users/CurrentUserGuid\";\r\n            endPoints[\"get-users\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\r\n            endPoints[\"entities-handler-getUsersImages\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\r\n            endPoints[\"project-users-get\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\r\n            \r\n            endPoints[\"entities-handler-getUsers\"] = params.proxyPrefix + \"Api/Cases/{caseId}/UsersGuid\";\r\n            //endPoints[\"case-handler-getWorkItems\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItemsGuid\";\r\n            endPoints[\"case-handler-getCaseSummary\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\";\r\n            endPoints[\"case-handler-getCaseAssignees\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\";\r\n\r\n            endPoints[\"discussion-case\"] = params.proxyPrefix + \"Api/CaseResource/DiscussionGuid?globalParent={globalParent}\";\r\n            //endPoints[\"discussion-case-v1\"] = params.proxyPrefix + \"Api/CaseResource/{globalParent}/DiscussionGuid\";\r\n            endPoints[\"new-discussion\"] = params.proxyPrefix + \"Api/CaseResource/DiscussionGuid\";\r\n            \r\n            endPoints[\"comment-case\"] = params.proxyPrefix + \"Api/CaseResource/{idParent}/CommentGuid\";\r\n            endPoints[\"new-comment\"] = params.proxyPrefix + \"Api/CaseResource/CommentGuid\";\r\n\r\n            endPoints[\"project-files-upload\"] = params.proxyPrefix + \"Api/CaseResource/FileGuid\";\r\n            endPoints[\"get-list-files\"] = params.proxyPrefix + \"Api/CaseResource/FileGuid?globalParent={globalParent}\";\r\n      \r\n            //Mobile case summary\r\n            endPoints[\"time-schemas-effectiveduration\"] = params.proxyPrefix + \"Api/WorkingTimeSchema/EffectiveDurationGuid?idUser={idUser}&fromDate={fromDate}&toDate={toDate}\";\r\n            //Mobile plans\r\n            endPoints[\"project-plan-get\"] = params.proxyPrefix + \"Api/Plans/Guid/{idPlan}\";\r\n            endPoints[\"project-plan-update\"] = params.proxyPrefix + \"Api/Plans/Guid/{idPlan}\";\r\n            endPoints[\"project-plan-activities\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/ActivitiesGuid\";\r\n            endPoints[\"project-plan-workitems\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/WorkItemsGuid\";\r\n            endPoints[\"project-plan-first-parent-plan\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/FirstParentPlanGuid\";\r\n            endPoints[\"project-plan-activity-edit\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/ActivitiesGuid/{id}\";      \r\n        }\r\n\r\n        return endPoints;\r\n    }\r\n    return {};\r\n};","/*\r\n*   Name: BizAgi Work Portal Service Context Factory\r\n*   Author: Diego Parra (based on Edward Morales version)\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\r\n\r\n$.Class.extend(\"bizagi.workportal.services.context\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        this.context = params.context;\r\n        this.endPoints = bizagi.workportal.services.getEndPoints(params);\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the given url for a specified service\r\n    */\r\n    getUrl: function (service) {\r\n        if (typeof this.endPoints[service] === 'undefined') {\r\n            bizagi.log(\"Url not found\",\"No endpoint defined for: \" + service);\r\n        }\r\n        return this.endPoints[service];\r\n    },\r\n\r\n    setProxyPrefix: function (params) {\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        this.endPoints = bizagi.workportal.services.getEndPoints(params);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra (based on Edward Morales version)\r\n *   Comments:\r\n *   -   This class will provide a facade to access to workportal REST services\r\n */\r\n\r\n$.Class.extend(\"bizagi.workportal.services.service\", {\r\n    // Statics\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    ENTITIES_QUERY_PAGE_SIZE: 10\r\n}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        var self = this;\r\n        params = typeof (params) == \"object\" ? params : {};\r\n        params.context = !bizagi.util.isEmpty(params.context) ? params.context : \"workportal\";\r\n\r\n        params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        params.proxyPrefix = this.normalizeUrl(params.proxyPrefix);\r\n        bizagi.RPproxyPrefix = params.proxyPrefix;\r\n\r\n\r\n        params.sharepointProxyPrefix = !bizagi.util.isEmpty(params.sharepointProxyPrefix) ? params.sharepointProxyPrefix : \"\";\r\n        params.sharepointProxyPrefix = this.normalizeUrl(params.sharepointProxyPrefix);\r\n\r\n        this.serviceLocator = new bizagi.workportal.services.context(params);\r\n\r\n        // Define default value of number of records to show\r\n        this.pageSize = 10;\r\n\r\n        this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone: (bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet: bizagi.deviceEnum.desktop));\r\n        this.deviceCode = bizagi.util.getDeviceCode();\r\n\r\n        // Get override for pageSize, use BIZAGI_INBOX_ROWS_PER_PAGE constant within config file\r\n        if (typeof BIZAGI_INBOX_ROWS_PER_PAGE !== \"undefined\") {\r\n            this.pageSize = ($.isNumeric(BIZAGI_INBOX_ROWS_PER_PAGE)) ? BIZAGI_INBOX_ROWS_PER_PAGE : this.pageSize;\r\n        }\r\n    },\r\n    /**\r\n     * This method will return the url defined as endPoint using the parameter 'endPoint' name\r\n     */\r\n    getUrl: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(params.endPoint);\r\n        return url;\r\n    },\r\n    /**\r\n     * This method will return the url normalized\r\n     */\r\n    normalizeUrl: function (url) {\r\n        if (url !== \"\") {\r\n            if (url[url.length - 1] != \"/\") {\r\n                url = url.concat(\"/\");\r\n            }\r\n\r\n            if (url.indexOf(\"http://\") == -1 && url.indexOf(\"https://\") == -1) {\r\n                url = \"http://\" + url;\r\n            }\r\n        }\r\n        return url;\r\n    },\r\n\r\n    /**\r\n     * This service get all overrides keys within configuration project\r\n     *\r\n     * @return {json}\r\n     */\r\n    getOverrides: function () {\r\n        var self = this;\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"overrides\")\r\n        }).pipe(function (overrides) {\r\n            overrides = overrides || {};\r\n\r\n            $.each(overrides, function (key, value) {\r\n                var valueUppercase = value.toUpperCase();\r\n                if (valueUppercase == \"TRUE\" || valueUppercase == \"FALSE\") {\r\n                    overrides[key] = bizagi.util.parseBoolean(value);\r\n                }\r\n            });\r\n\r\n            return overrides;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * This service get json of theme definition\r\n     *@return {json} theme definition\r\n     */\r\n    getCurrentTheme: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('getCurrentTheme');\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n    /**\r\n     * This method will return the response of the user information login is correct\r\n     * this method is use for native smartphone\r\n     **/\r\n    authenticatedUser: function (params) {\r\n        var self = this;\r\n        var urlSend = self.serviceLocator.getUrl(\"login-handler\");\r\n\r\n        return $.read({\r\n            url: urlSend,\r\n            data: {\r\n                \"userName\": BIZAGI_USER,\r\n                \"password\": BIZAGI_PASSWORD,\r\n                \"domain\": BIZAGI_DOMAIN\r\n            }\r\n        }).pipe(\r\n            function (response) {\r\n                return response;\r\n            },\r\n            function (data) {\r\n                urlSend = self.serviceLocator.getUrl('login-handlerv10');\r\n                urlSend = urlSend.replace('{0}', BIZAGI_USER || '');\r\n                urlSend = urlSend.replace('{1}', BIZAGI_PASSWORD || '');\r\n                urlSend = urlSend.replace('{2}', BIZAGI_DOMAIN || '');\r\n                return $.ajax({\r\n                    url: urlSend,\r\n                    type: 'GET',\r\n                    dataType: 'json'\r\n                });\r\n            }\r\n        );\r\n    },\r\n\r\n    /**\r\n     *\r\n     * this method is use for native smartphone\r\n     **/\r\n    logoutUser: function (params) {\r\n        var self = this;\r\n        var urlSend = self.serviceLocator.getUrl('logoff-handlerv1');\r\n        return $.read({\r\n            url: urlSend\r\n        });\r\n    },\r\n    /*\r\n     *   Logoff the current user\r\n     */\r\n    logOffUser: function (params) {\r\n        var self = this;\r\n        var urlSend = self.serviceLocator.getUrl(\"logoff-handler\");\r\n        return $.read({\r\n            url: urlSend\r\n        });\r\n    },\r\n    /*\r\n     *   Gets the current working user\r\n     */\r\n    getCurrentUser: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl(\"user-handler-getCurrentUser\"));\r\n    },\r\n    /*\r\n     *   Gets the inbox summary for the current logged user\r\n     *   Returns a promise of the data being retrieved\r\n     */\r\n    getInboxSummary: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl(\"inbox-handler-getInboxSummary\"))\r\n            .pipe(function (response) {\r\n                // Extract inboxSummary property\r\n                return response[\"inboxSummary\"];\r\n            });\r\n    },\r\n    /*\r\n     *   Return all the available processes in bizagi\r\n     */\r\n    getAllProcesses: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl('process-handler-getAllProcesses');\r\n\r\n        if (params.taskState != undefined) {\r\n            data['taskState'] = params.taskState;\r\n        }\r\n\r\n        if (params.onlyFavorites != undefined && params.onlyFavorites != '') {\r\n            data['onlyFavorites'] = params.onlyFavorites;\r\n        }\r\n\r\n        if (params.myActivities != undefined && params.myActivities != \"\") {\r\n            data[\"myActivities\"] = params.myActivities;\r\n        }\r\n\r\n        if (params.myPendings != undefined && params.myPendings != \"\") {\r\n            data[\"myPendings\"] = params.myPendings;\r\n        }\r\n\r\n        if (params.smartfoldersParameters) {\r\n            url = url + '?' + params.smartfoldersParameters;\r\n        }\r\n\r\n        if (bizagi.isMobile()) {\r\n            data['mobileDevice'] = true;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                // !! (double Not) (bang bang) <-- For Boolean Type Casting http://jibbering.com/faq/notes/type-conversion/#tcBool\r\n                if (!!params.skipAggrupate)\r\n                    return response;\r\n                // Aggrupate workflows by categories\r\n                var responseData = {};\r\n                var categories = {};\r\n                var allProcesses = bizagi.localization.getResource('workportal-widget-inbox-all-processes');\r\n                var allCases = {\r\n                    name: bizagi.localization.getResource('workportal-widget-inbox-all-cases'),\r\n                    path: '',\r\n                    category: allProcesses,\r\n                    isFavorite: (params.onlyFavorites || false),\r\n                    guidFavorite: '',\r\n                    idworkflow: '',\r\n                    guidWFClass: '',\r\n                    count: 0\r\n                };\r\n\r\n                // Create a default category\r\n                categories[allProcesses] = [];\r\n                categories[allProcesses].workflows = [];\r\n                categories[allProcesses].workflows.push(allCases);\r\n                if (response.workflows) {\r\n                    $.each(response.workflows.workflow, function (i, workflow) {\r\n                        // Creates the category if it doesn't exist\r\n                        if (!categories[workflow.category]) {\r\n                            categories[workflow.category] = [];\r\n                            categories[workflow.category].workflows = [];\r\n                        }\r\n\r\n                        // Push the workflow\r\n                        categories[workflow.category].workflows.push(workflow);\r\n\r\n                        // Sum the cases count\r\n                        //  if (bizagi.util.isEmpty(params.onlyFavorites) || params.onlyFavorites == false) {\r\n                        allCases.count += Number(workflow.count);\r\n                        // }\r\n                    });\r\n                }\r\n\r\n                // Build result array once grouped\r\n                responseData.categories = [];\r\n                for (key in categories) {\r\n                    responseData.categories.push({\r\n                        name: key,\r\n                        workflows: categories[key].workflows\r\n                    });\r\n                }\r\n\r\n                return responseData;\r\n            });\r\n    },\r\n    /*\r\n     *   Return my favourites count\r\n     */\r\n    getFavourites: function () {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"process-handler-getFavourites\");\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Return my favourites count\r\n     */\r\n    getMyStuff: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"process-handler-getMyStuff\");\r\n\r\n        if (typeof params.icon !== \"undefined\" && params.icon) {\r\n            data.icon = true;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data);\r\n    },\r\n    /*\r\n     *   Return my favourites cases\r\n     */\r\n    getFavouriteCases: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"process-handler-getFavouriteCases\");\r\n\r\n        data[\"pageSize\"] = params.pageSize || self.pageSize;\r\n        data[\"page\"] = params.page || 1;\r\n\r\n        if (bizagi.isMobile()) {\r\n            data[\"mobileDevice\"] = true;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Return all the available cases in bizagi and thinking for mobile response\r\n     */\r\n    getCasesList: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"case-handler-getCasesList\");\r\n\r\n        params = params || {};\r\n\r\n        data[\"pageSize\"] = params.pageSize || 10;\r\n        data[\"page\"] = params.page || 1;\r\n        data[\"numberOfFields\"] = params.numberOfFields || \"-1\"; //1;\r\n        data[\"idWfClass\"] = params.idWfClass || \"-1\";\r\n\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                var elementToHtml = {\r\n                    overdue: [],\r\n                    today: [],\r\n                    tomorrow: [],\r\n                    upcoming: [],\r\n                    page: response.page,\r\n                    totalPages: response.totalPages\r\n                };\r\n                var actualDate = new Date();\r\n                var actualMonth = actualDate.getMonth();\r\n                var actualDay = actualDate.getDate();\r\n                var actualYear = actualDate.getYear();\r\n                var lengthData = typeof response.elements !== \"undefined\" ? response.elements.length : 0;\r\n\r\n                for (var counter = 0; lengthData > counter; counter++) {\r\n                    var tmpElement = response.elements[counter];\r\n                    var tmpdate = new Date(tmpElement[3]);\r\n                    var tmpDay = tmpdate.getDate();\r\n                    var tmpMonth = tmpdate.getMonth();\r\n                    var tmpYear = tmpdate.getYear();\r\n\r\n                    if (actualDay > tmpDay || (actualMonth > tmpMonth || actualYear > tmpYear)) {\r\n                        tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"dd MMM yyyy\");\r\n                        elementToHtml.overdue.push(tmpElement);\r\n                    } else {\r\n                        if (actualDay == tmpDay) {\r\n                            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm\");\r\n                            elementToHtml.today.push(tmpElement);\r\n\r\n                        } else if ((actualDay + 1) == tmpDay) {\r\n                            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm\");\r\n                            elementToHtml.tomorrow.push(tmpElement);\r\n\r\n                        } else {\r\n                            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"dd MMM yyyy\");\r\n                            elementToHtml.upcoming.push(tmpElement);\r\n                        }\r\n                    }\r\n                }\r\n                return elementToHtml;\r\n            });\r\n\r\n    },\r\n\r\n    /*\r\n     *   Return all the available cases in bizagi and thinking for mobile response\r\n     */\r\n    getCasesListBeta: function (params) {\r\n        var self = this;\r\n\r\n        return self.getMobileCasesList(params)\r\n            .then(function (response) {                \r\n                var groupedData = {\r\n                    elements: [],\r\n                    page: response.page,\r\n                    totalPages: response.totalPages,\r\n                    advanceSearch: response.advanceSearch || false\r\n                };\r\n\r\n                var actualDate = new Date();\r\n                var statusFunction = response.advanceSearch ? self.defineActivityStateByTaskState :self.defineActivityStateByDate;\r\n\r\n                for (var counter = 0; response.elements.length > counter; counter++) {\r\n                    var tmpElement = response.elements[counter];\r\n                    var status = {};\r\n\r\n                    status = statusFunction(tmpElement[3], tmpElement.taskstate);\r\n\r\n                    // Time to atRiskTimeDelta\r\n                    if (tmpElement.length >= 10 && parseInt(tmpElement[11], 10) > 0) {\r\n                        var tmpEndDate = new Date(tmpElement[3]);\r\n\r\n                        if (actualDate.getTime() > tmpEndDate.getTime()) {\r\n                            status.state = \"red\";\r\n                        } else {\r\n                            if (actualDate.getTime() > (tmpEndDate.getTime() - (parseInt(tmpElement[11], 10) * 60000))) {\r\n                                status.state = \"yellow\";\r\n                            } else {\r\n                                status.state = \"green\";\r\n                            }\r\n                        }\r\n                    }\r\n                \r\n                    groupedData.elements.push($.extend({}, tmpElement, status, {\r\n                        \"endDate\": tmpElement[3],\r\n                        \"idworkitem\": tmpElement[1],\r\n                        \"idwfclass\": !bizagi.util.validateFeatureSupport(\"advancedSearch\") ? tmpElement[7] : tmpElement[10]\r\n                    }));\r\n                }                               \r\n                return groupedData;\r\n            });\r\n    },\r\n   \r\n    getMobileCasesList: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        params = params || {};\r\n\r\n        if (typeof params.radNumber !== \"undefined\") {\r\n            data[\"radNumber\"] = params.radNumber;\r\n        }\r\n\r\n        data[\"pageSize\"] = params.pageSize || 10;\r\n        data[\"page\"] = params.page || 1;\r\n\r\n        var urlMobile = self.serviceLocator.getUrl(\"case-handler-getActivityList\");\r\n\r\n        //if server version is less than server version where the new service was implemented, then call last version of service\r\n        if (!bizagi.util.validateFeatureSupport(\"advancedSearch\")) {\r\n            urlMobile = self.serviceLocator.getUrl(\"case-handler-getCasesList\");\r\n            data[\"numberOfFields\"] = params.numberOfFields || \"-1\"; //1;\r\n            data[\"idWfClass\"] = params.idWfClass || \"-1\";\r\n            return $.read(urlMobile, data);\r\n        }\r\n\r\n        return $.read(urlMobile, data).then(function (resp) {\r\n            var response = {elements: [], rows: []};\r\n            var row, i = -1;\r\n            while ((row = resp.rows[++i])) {\r\n                var tempElement = {}, el = [\"\", \"\", \"\", \"\", \"\", \"\", [], \"\", \"\", \"\", \"\",\"\",\"\"];\r\n                var field, j = -1;\r\n                while ((field = resp.headers[++j])) {\r\n                    tempElement[field.fieldName.toLowerCase()] = {\r\n                        \"displayName\": field.displayName,\r\n                        \"value\": row[j]\r\n                    };\r\n                    self.serializeActivity(el, field.fieldName.toLowerCase(), tempElement[field.fieldName.toLowerCase()]);\r\n                }\r\n\r\n                response.elements.push(el);\r\n                response.rows.push(tempElement);\r\n            }\r\n            return {\r\n                \"page\": resp.page || resp.currentPage,\r\n                \"totalPages\": resp.totalPages,\r\n                \"elements\": response.elements,\r\n                \"rows\": response.rows,\r\n                \"advanceSearch\": true\r\n            };\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns the activity status based on the end date and the risk\r\n     * @param {String} endDate ISO representation of a date\r\n     * @returns {{}}\r\n     */\r\n    defineActivityStateByDate: function (endDate) {\r\n        var status = {};\r\n\r\n        if ( endDate ) {\r\n            var activityDate = new Date( endDate );\r\n            var now = new Date();\r\n            var today = new Date( now.getFullYear(), now.getMonth(), now.getDate() );\r\n            var second = 1000;\r\n            var minute = 60 * second;\r\n            var day = 24 * 60 * minute;\r\n\r\n            // Before today\r\n            if( activityDate.getTime( ) < today.getTime( ) - second ) {\r\n                status = { group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"), state: \"red\",  type: \"overdue\", icon: \"overdue\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")};\r\n            }\r\n            // Today but before now\r\n            else if( activityDate.getTime( ) < now.getTime( ) + minute - second ) {\r\n                status = { group: \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\"), state: \"red\", type: \"today\", icon: \"overdue\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")};\r\n            }\r\n            // Today but after now\r\n            else if( activityDate.getTime( ) < today.getTime( ) + day - second ) {\r\n                status = { group: \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\"), state: \"yellow\", type: \"today\", icon: \"ontime\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\") };\r\n            }\r\n            // Tomorrow\r\n            else if( activityDate.getTime( ) < today.getTime( ) + 2 * day - second ) {\r\n                status = { group: \"3|\" + bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\"), state: \"green\", type: \"tomorrow\" , icon: \"upcoming\", shortEndDate:  bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")};\r\n            }\r\n            // After tomorrow\r\n            else {\r\n                status = { group: \"4|\" + bizagi.localization.getResource(\"workportal-taskfeed-upcomming\"), state: \"green\", type: \"upcoming\" , icon: \"upcoming\", shortEndDate:  bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")};\r\n            }\r\n        } else {\r\n            status = { group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"), state: \"red\", type: \"overdue\", shortEndDate : \"--\" ,  icon: \"overdue\"};\r\n        }\r\n\r\n        return status;\r\n    },\r\n\r\n    /**\r\n     * Returns the activity status based on the taskstate property\r\n     * @param {String} endDate ISO representation of a date\r\n     * @param {String} taskstate Color name\r\n     * @returns {{}}\r\n     */\r\n    defineActivityStateByTaskState: function(endDate, taskstate) {\r\n        var status = {\r\n            group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"),\r\n            state: taskstate,\r\n            type: \"overdue\",\r\n            shortEndDate : \"--\",\r\n            icon: \"overdue\"\r\n        };\r\n\r\n        if ( endDate && taskstate ) {\r\n            var activityDate = new Date( endDate );\r\n            var now = new Date();\r\n            var today = new Date( now.getFullYear(), now.getMonth(), now.getDate() );\r\n            var second = 1000;\r\n            var minute = 60 * second;\r\n            var day = 24 * 60 * minute;\r\n\r\n            status = {\r\n                group: \"\",\r\n                state: taskstate,\r\n                type: \"\",\r\n                icon: \"\",\r\n                shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")\r\n            };\r\n            // Before today\r\n            if( activityDate.getTime( ) < today.getTime( ) - second ) {\r\n                status.group = \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\r\n                status.type = \"overdue\";\r\n            }\r\n            // Today\r\n            else if( activityDate.getTime( ) < today.getTime( ) + day - second ) {\r\n                status.group = \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\");\r\n                status.type = \"today\";\r\n            }\r\n            // Tomorrow\r\n            else if( activityDate.getTime( ) < today.getTime( ) + 2 * day - second ) {\r\n                status.group = \"3|\" + bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\r\n                status.type = \"tomorrow\";\r\n            }\r\n            // After tomorrow\r\n            else {\r\n                status.group = \"4|\" + bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\r\n                status.type = \"upcoming\";\r\n            }\r\n\r\n            switch( taskstate ) {\r\n                case \"green\":\r\n                    status.icon = \"upcoming\";\r\n                    break;\r\n                case \"yellow\":\r\n                    status.icon = \"ontime\";\r\n                    break;\r\n                case \"red\":\r\n                default:\r\n                    status.icon = \"overdue\";\r\n                    break;\r\n            }\r\n        }\r\n        return status;\r\n    },\r\n\r\n    serializeActivity: function (el, fieldName, element) {\r\n        switch (fieldName) {\r\n            case \"radnumber\":\r\n                el[6].push([element.displayName, element.value]);\r\n                break;\r\n            //Proceso\r\n            case \"wfclsdisplayname\":\r\n                el[4] = element.value !== null ? element.value.toString() : bizagi.localization.getResource(\"workportal-project-activity-plan\");\r\n                break;\r\n            //Actividad\r\n            case \"currenttask\":\r\n                el[5] = element.value !== null ? element.value.toString() : bizagi.localization.getResource(\"workportal-project-casedashboard-activity\");\r\n                break;\r\n            //Fecha creación caso\r\n            case \"cascreationdate\":\r\n                el[12] = element.value;\r\n                break;\r\n            // Actividad vence en\r\n            case \"wiestimatedsolutiondate\":\r\n                el[3] = element.value;\r\n                break;\r\n            //Fecha Solución caso\r\n            case \"cassolutiondate\":\r\n                //el[6] = [\"\"];\r\n                break;\r\n            // Id de caso\r\n            case \"idcase\":\r\n                el[0] = element.value;\r\n                break;\r\n            // idWorkItem\r\n            case \"idworkitem\":\r\n                el[1] = element.value.toString();\r\n                break;\r\n            //Fecha de entrada al estado\r\n            case \"wientrydate\":\r\n                //el[6] = [\"\"];\r\n                break;\r\n            case \"taskid\":\r\n                el[2] = element.value;\r\n                break;\r\n            case \"taskstate\":\r\n                el.taskstate = ( element.value ? ( \"\" + element.value ).toLowerCase() : \"\" );\r\n                break;\r\n            //idWorkflow\"\r\n            case \"idwfclass\":\r\n                el[10] = el.idwfclass = element.value;\r\n                break;\r\n            //Is Favorite\r\n            case \"isfavorite\":\r\n                el[9] = element.value;\r\n                break;\r\n            case \"atrisktime\":\r\n                el[11] = element.value;\r\n                break;\r\n            case \"guidfavorite\":\r\n                el[8] = element.value;\r\n                break;\r\n            case \"isevent\":\r\n                el.isEvent = element.value;\r\n                break;\r\n            case \"datachangesetversion\":\r\n                el.dataChangeset = element.value;\r\n                break;                \r\n        }\r\n    },\r\n\r\n    /**\r\n     * Obtiene la lista de actividades para el usuario actual con filtros\r\n     * Version: 2, Llamado al servicio con todas las prestaciones de filtrado\r\n     */\r\n    getCurrentActivities: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        params = params || {};\r\n\r\n        data[\"page\"] = params.page || 1;\r\n        data[\"pageSize\"] = params.pageSize || 10;\r\n\r\n        if (typeof params.radNumber !== \"undefined\") {\r\n            data[\"radNumber\"] = params.radNumber;\r\n        }\r\n\r\n        var url = self.serviceLocator.getUrl('case-handler-getActivityList');\r\n        return $.read(url, data).then(function (resp) {\r\n            return self.processActivitiesResponse(resp);\r\n        });\r\n    },\r\n\r\n    processActivitiesResponse: function (resp, highlight, process_filter) {\r\n        var self = this;\r\n        var row;\r\n        var i = -1;\r\n\r\n        resp.elements = [];\r\n        resp.processes = [];\r\n\r\n        while ((row = resp.rows[++i])) {\r\n            var tempElement = {};\r\n            var field, j = -1;\r\n            while ((field = resp.headers[++j])) {\r\n                tempElement[\"o_\" + field.fieldName.toLowerCase()] = {\"displayName\": field.displayName, \"value\": row[j]};\r\n                tempElement[field.fieldName.toLowerCase()] = row[j];\r\n            }\r\n            $.extend(tempElement, self.defineActivityStateByDate(tempElement[\"wiestimatedsolutiondate\"]), {highlightedNumber: self.highlightsString(tempElement[\"radnumber\"], highlight)});\r\n            resp.elements.push(tempElement);\r\n\r\n            var process = resp.processes.find(function (el) {\r\n                return el.processname == tempElement[\"wfclsdisplayname\"];\r\n            });\r\n\r\n            if (typeof process === \"undefined\") {\r\n                resp.processes.push({\r\n                    processname: tempElement[\"wfclsdisplayname\"],\r\n                    idwfclass: tempElement[\"idwfclass\"],\r\n                    active: (process_filter || false) ? \"active\" : \"\"\r\n                });\r\n            }\r\n        }\r\n        return resp;\r\n    },\r\n\r\n    highlightsString: function (string, highlight) {\r\n        if (typeof string !== \"string\" || typeof highlight !== \"string\") {\r\n            return string;\r\n        }\r\n\r\n        var expresion = new RegExp(highlight, \"gi\");\r\n        return string.replace(expresion, function (match, offset) {\r\n            return \"<strong>\" + match + \"</strong>\";\r\n        });\r\n    },\r\n\r\n    getDiscussionCase: function (params) {\r\n        var self = this;\r\n        var data = data || {};\r\n        data['globalParent'] = params.globalParent;\r\n        var url = bizagi.util.validateFeatureSupport(\"discussionCase\") ? self.serviceLocator.getUrl('discussion-case') : self.serviceLocator.getUrl('discussion-case-v1');\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    editDiscussion: function (data) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"new-discussion\");\r\n        return $.update({\r\n            url: url,\r\n            data: JSON.stringify(data),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getUsersDiscussion: function (params) {\r\n        var self = this;\r\n        var data = data || {};\r\n        data[\"userIds\"] = params;\r\n        data[\"width\"] = 50;\r\n        data[\"height\"] = 50;\r\n        var url = self.serviceLocator.getUrl(\"get-users\");\r\n\r\n        var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\r\n        if (newUserServices) {\r\n            return $.ajax({\r\n                url: url, \r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        } else {    \r\n            return $.read(url, data)\r\n                .pipe(function (response) {\r\n                    return response;\r\n                });\r\n        }        \r\n    },\r\n\r\n    getEffectiveDuration: function (data) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"time-schemas-effectiveduration\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getUsersData: function (data) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-users-get\");\r\n        var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\r\n        if (newUserServices) {\r\n            return $.ajax({\r\n                url: url, \r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        } else {    \r\n            return $.read({\r\n                url: url,\r\n                data: data,\r\n                dataType: \"json\"\r\n            });\r\n        }   \r\n\r\n        \r\n    },\r\n\r\n    createNewDiscussion: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"new-discussion\");\r\n\r\n        params = params || {};\r\n\r\n        return $.create({\r\n            url: url,\r\n            data: JSON.stringify(params),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    createNewComment: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var data = params.data || {};\r\n        var url = self.serviceLocator.getUrl(\"new-comment\");\r\n\r\n        return $.create({\r\n            url: url.replace(\"{typeResource}\", \"Comment\"),\r\n            data: JSON.stringify(data),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Update Project File\r\n     */\r\n    updateProjectFile: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-files-upload\");\r\n\r\n        return $.update({\r\n            url: url,\r\n            data: JSON.stringify(params),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Update Project File\r\n     */\r\n    createProjectFile: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-files-upload\");\r\n\r\n        return $.create({\r\n            url: url,\r\n            data: JSON.stringify(params),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Count the files number\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getFilesCount: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var url = bizagi.util.validateFeatureSupport(\"filesCount\") ? self.serviceLocator.getUrl(\"count-files\") : self.serviceLocator.getUrl(\"count-files-v1\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    getCommentCase: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n\r\n        var url = self.serviceLocator.getUrl(\"comment-case\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    getCommentsByParent: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var url = self.serviceLocator.getUrl(\"count-comments\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    getFilesList: function (params) {\r\n        var self = this;\r\n        var url = bizagi.util.validateFeatureSupport(\"filesList\") ? self.serviceLocator.getUrl(\"get-list-files\") : self.serviceLocator.getUrl(\"get-list-files-v1\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    deleteFile: function(data){\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-resource-action\");\r\n        return $.destroy({\r\n            url: url.replace(\"{typeResource}\", \"Attachment\"),\r\n            data: JSON.stringify(data),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getFilesThumbnail: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n        var url = self.serviceLocator.getUrl(\"thumbnail-file\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    getAttachment: function (guidAttachment) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl(\"get-attachment\");\r\n        url = url.replace(\"{idAttachment}\", guidAttachment.idAttachment);\r\n        return url;\r\n    },\r\n\r\n    getMobileAttachment: function (guidAttachment) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl(\"get-mobile-attachment\");\r\n        url = url.replace(\"{idAttachment}\", guidAttachment.idAttachment);\r\n        return url + \"?sessionId=\";\r\n    },\r\n\r\n    /*\r\n     *   Return all the available processes in bizagi\r\n     */\r\n    getAllAdministrableEntities: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data[\"action\"] = \"entitiesList\";\r\n        data[\"kind\"] = \"administrable\";\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"entities-administration\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\"\r\n        }).pipe(function (data) {\r\n            var result = {\r\n                entities: []\r\n            };\r\n            $.each(data, function (i, item) {\r\n                result.entities.push(item);\r\n            });\r\n            return result;\r\n        });\r\n    },\r\n    /*\r\n     *   Return all the available processes in bizagi\r\n     */\r\n    getEntitiesList: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        params[\"action\"] = \"entitiesList\";\r\n        params[\"kind\"] = \"entitiesData\";\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"entities-administration\"),\r\n            data: params,\r\n            type: \"POST\",\r\n            dataType: \"json\"\r\n        });\r\n    },\r\n    /*\r\n     *   Returns all the cases for the current user filtered by a workflow\r\n     */\r\n    getCasesByWorkflow: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl('process-handler-getCustomizedColumnsDataInfo');\r\n\r\n\r\n        // Required params\r\n        if (!bizagi.util.isEmpty(params.taskState))\r\n            data['taskState'] = params.taskState;\r\n        if (!bizagi.util.isEmpty(params.idWorkflow))\r\n            data['idWorkflow'] = params.idWorkflow;\r\n\r\n        // Special case to search all favorite cases for all processes\r\n        if (params.onlyFavorites == true) {\r\n            data['onlyFavorites'] = true;\r\n            data['taskState'] = 'all';\r\n        }\r\n\r\n        // Optional params\r\n        data['pageSize'] = params.pageSize || self.pageSize;\r\n        data['page'] = params.page || 1;\r\n\r\n        if (bizagi.isMobile()) {\r\n            data['mobileDevice'] = true;\r\n        }\r\n\r\n        if (params.smartfoldersParameters) {\r\n            var param = params.smartfoldersParameters.split('&');\r\n            $.each(param, function (k, v) {\r\n                var keyvalue = v.split('=');\r\n                data[keyvalue[0]] = keyvalue[1];\r\n            });\r\n        }\r\n\r\n        if (params.radnumber || params.radNumber) {\r\n            data['radNumber'] = params.radNumber ? params.radNumber : params.radnumber;\r\n        }\r\n\r\n        if ((params.idcase || params.idCase) && bizagi.util.isNumeric(params.idcase || params.idCase)) {\r\n            data['idCase'] = params.idCase ? params.idCase : params.idcase;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                $.each(response.cases.rows, function (key, value) {\r\n                    var newFieldsValue = [];\r\n\r\n                    //  Set id of case to radnumber\r\n                    response.cases.rows[key]['radnumber'] = value.id;\r\n                    $.each(value.fields, function (fieldsKey, fieldsValue) {\r\n                        // when delete element from fields array, each function lose key value\r\n                        if (fieldsValue != undefined) {\r\n                            // Radnumber\r\n                            try {\r\n                                if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == 'true') {\r\n                                    response.cases.rows[key]['radnumber'] = fieldsValue.Value;\r\n                                    response.cases.rows[key]['casenumberdisplayname'] = fieldsValue.DisplayName;\r\n                                } else if (fieldsValue.workitems != undefined) {\r\n                                    response.cases.rows[key]['workitems'] = fieldsValue.workitems;\r\n                                } else {\r\n                                    newFieldsValue.push(fieldsValue);\r\n                                }\r\n                            } catch (e) { }\r\n                        }\r\n                    });\r\n\r\n                    // Update Fields\r\n                    response.cases.rows[key]['fields'] = newFieldsValue;\r\n                });\r\n                return response.cases;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Organization List\r\n     */\r\n    getOrganizationsList: function () {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('process-handler-getOrganizations');\r\n        var data = {};\r\n        data['type'] = 12;\r\n        data['name'] = '';\r\n\r\n        return $.read(url, data);\r\n    },\r\n    /*\r\n     *   Returns the data for the inbox grid view\r\n     */\r\n    getCustomizedColumnsData: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"process-handler-getCustomizedColumnsData\");\r\n        data[\"pageSize\"] = params.pageSize || self.pageSize;\r\n        data[\"page\"] = params.page || 1;\r\n\r\n        // data for sort columns\r\n        data[\"orderFieldName\"] = params.orderFieldName || \"\";\r\n        data[\"orderType\"] = params.orderType || \"0\";\r\n        data[\"order\"] = params.order || \"\";\r\n\r\n        if (bizagi.isMobile()) {\r\n            data[\"mobileDevice\"] = true;\r\n        }\r\n\r\n        // Fixes stuff\r\n        // TODO: this must be fixed in the server\r\n        params.taskState = params.taskState || 'all';\r\n        if (params.taskState.toString().toLowerCase() === '')\r\n            params.taskState = 'all';\r\n        if (params.taskState.toString().toLowerCase() === 'red')\r\n            params.taskState = 'Red';\r\n        if (params.taskState.toString().toLowerCase() === 'yellow')\r\n            params.taskState = 'Yellow';\r\n        if (params.taskState.toString().toLowerCase() === 'green')\r\n            params.taskState = 'Green';\r\n\r\n        data.taskState = params.taskState;\r\n        // Required params\r\n        if (!bizagi.util.isEmpty(params.idWorkflow)) {\r\n            data['idWorkflow'] = params.idWorkflow;\r\n        }\r\n        if (!bizagi.util.isEmpty(params.idTask)) {\r\n            data['idTask'] = params.idTask;\r\n        }\r\n\r\n        if (!bizagi.util.isEmpty(params.radNumber)) {\r\n            data['radNumber'] = params.radNumber;\r\n        }\r\n\r\n        // Special case to search all favorite cases for all processes\r\n        if (params.onlyFavorites == true) {\r\n            data['onlyFavorites'] = true;\r\n            data['taskState'] = 'all';\r\n        }\r\n\r\n        if (params.smartfoldersParameters) {\r\n            var param = params.smartfoldersParameters.split('&');\r\n            $.each(param, function (k, v) {\r\n                var keyvalue = v.split('=');\r\n                data[keyvalue[0]] = keyvalue[1];\r\n            });\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *   Returns the data for the inbox grid view\r\n     */\r\n    getCustomizedColumnsDataBeta: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl('process-handler-getCustomizedColumnsData');\r\n\r\n        data['pageSize'] = params.pageSize || self.pageSize;\r\n        data['page'] = params.page || 1;\r\n\r\n        // data for sort columns\r\n        data['orderFieldName'] = params.orderFieldName || '';\r\n        data['orderType'] = params.orderType || '0';\r\n        data['order'] = params.order || '';\r\n        data['mobileDevice'] = bizagi.isMobile() ? true : false;\r\n\r\n        // Fixes stuff\r\n        // TODO: this must be fixed in the server\r\n        params.taskState = params.taskState || 'all';\r\n        if (params.taskState.toString().toLowerCase() === '')\r\n            params.taskState = 'all';\r\n        if (params.taskState.toString().toLowerCase() === 'red')\r\n            params.taskState = 'Red';\r\n        if (params.taskState.toString().toLowerCase() === 'yellow')\r\n            params.taskState = 'Yellow';\r\n        if (params.taskState.toString().toLowerCase() === 'green')\r\n            params.taskState = 'Green';\r\n\r\n        data.taskState = params.taskState;\r\n        // Required params\r\n        if (!bizagi.util.isEmpty(params.idWorkflow)) {\r\n            data['idWorkflow'] = params.idWorkflow;\r\n        }\r\n        if (!bizagi.util.isEmpty(params.idTask)) {\r\n            data['idTask'] = params.idTask;\r\n        }\r\n\r\n        if (!bizagi.util.isEmpty(params.radNumber)) {\r\n            data['radNumber'] = params.radNumber;\r\n        }\r\n\r\n        // Special case to search all favorite cases for all processes\r\n        if (params.onlyFavorites == true) {\r\n            data['onlyFavorites'] = true;\r\n            data['taskState'] = 'all';\r\n        }\r\n\r\n        if (params.smartfoldersParameters) {\r\n            var param = params.smartfoldersParameters.split('&');\r\n            $.each(param, function (k, v) {\r\n                var keyvalue = v.split('=');\r\n                data[keyvalue[0]] = keyvalue[1];\r\n            });\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        //return $.read(url, data);\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n\r\n                var groupedData = {\r\n                    columnTitle: [],\r\n                    lstIdCases: [],\r\n                    elements: [],\r\n                    page: response.page,\r\n                    totalPages: response.totalPages\r\n                };\r\n\r\n                var actualDate = new Date();\r\n                var actualMonth = actualDate.getMonth();\r\n                var actualDay = actualDate.getDate();\r\n                var actualYear = actualDate.getYear();\r\n\r\n                groupedData.columnTitle = response.cases.columnTitle;\r\n                groupedData.lstIdCases = response.cases.lstIdCases;\r\n                groupedData.page = response.cases.page;\r\n                groupedData.totalPages = response.cases.totalPages;\r\n\r\n                for (var counter = 0, length = response.cases.rows.length; counter < length; counter++) {\r\n                    var tmpElement = response.cases.rows[counter];\r\n\r\n                    var tmpdate = new Date(tmpElement.fields[3]);\r\n                    var tmpDay = tmpdate.getDate();\r\n                    var tmpMonth = tmpdate.getMonth();\r\n                    var tmpYear = tmpdate.getYear();\r\n\r\n                    if (actualDay > tmpDay || (actualMonth > tmpMonth || actualYear > tmpYear)) {\r\n                        tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'dd MMM'); // 'dd MMM hh:mm'\r\n                        groupedData.elements.push($.extend({}, tmpElement, {'group': 'overdue'}));\r\n\r\n                    } else {\r\n                        if (actualDay == tmpDay) {\r\n                            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'hh:mm');\r\n                            groupedData.elements.push($.extend({}, tmpElement, {'group': 'today'}));\r\n\r\n                        } else if ((actualDay + 1) == tmpDay) {\r\n                            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'hh:mm');\r\n                            groupedData.elements.push($.extend({}, tmpElement, {'group': 'tomorrow'}));\r\n\r\n                        } else {\r\n                            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'dd MMM');\r\n                            groupedData.elements.push($.extend({}, tmpElement, {'group': 'upcoming'}));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // No data items\r\n                if (typeof (groupedData.elements) === 'undefined' || (typeof (groupedData.elements) !== 'undefined' && groupedData.elements.length === 0)) {\r\n                    groupedData.elements.push({ noResults: true, message: bizagi.localization.getResource('workportal-menu-search-found-no-cases') });\r\n                }\r\n\r\n                return groupedData;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the available categories filtered by a parent category\r\n     *   If not parent category is sent, it will return the base categories\r\n     */\r\n    getCategories: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n\r\n        // Required params\r\n        if (params.idCategory)\r\n            data['idCategory'] = params.idCategory;\r\n        if (params.idApp)\r\n            data['idApp'] = params.idApp;\r\n\r\n        if (bizagi.isMobile()) {\r\n            data['mobileDevice'] = true;\r\n        }\r\n\r\n\r\n        data['groupByApp'] = params.groupByApp || false;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('process-handler-getCategory'), data);\r\n    },\r\n    /*\r\n     *   Returns the recent process\r\n     */\r\n    getRecentProcesses: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('process-handler-getRecentProcesses'), params);\r\n    },\r\n\r\n    /*\r\n     *   Returns the summary for a case\r\n     */\r\n    getCaseSummary: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('case-handler-getCaseSummary'),\r\n            data: {\r\n                idCase: params.idCase,\r\n                eventAsTasks: params.eventAsTasks || \"false\",\r\n                onlyUserWorkItems: params.onlyUserWorkItems || \"true\",\r\n                mobileDevice: bizagi.isMobile() || \"false\"\r\n            },\r\n            serviceType: \"GETSUMMARY\"\r\n        }).pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /*\r\n     *   Returns the assigness for a case (all users assigned to any task of this case)\r\n     */\r\n    getCaseAssignees: function(params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(self.serviceLocator.getUrl('case-handler-getCaseAssignees'), {\r\n            idCase: params.idCase\r\n        }).pipe(function(response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Returns all the tasks belonging to a process, aditionally return if it has an active workitem or not\r\n     */\r\n    getCaseTasks: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getCaseTasks'), {\r\n                idCase: params.idCase\r\n            }\r\n        );\r\n    },\r\n    /*\r\n     *   Returns all the events available for a case\r\n     */\r\n    getCaseEvents: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('case-handler-getCaseEvents'),\r\n            data: {\r\n                idCase: params.idCase\r\n            },\r\n            serviceType: 'GETEVENTS'\r\n        })\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns all the available subprocesses for a case\r\n     */\r\n    getCaseSubprocesses: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('case-handler-getCaseSubprocesses'),\r\n            data: {\r\n                idCase: params.idCase\r\n            },\r\n            serviceType: 'GETSUBPROCESSES'\r\n        })\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns forms render version for a case\r\n     */\r\n    getCaseFormsRenderVersion: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getCaseFormsRenderVersion'), {\r\n                idCase: params.idCase\r\n            }\r\n        );\r\n    },\r\n    /**\r\n     *  Get json from forms render version service\r\n     */\r\n    getCaseFormsRenderVersionDataContent: function (options) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(self.getCaseFormsRenderVersion(options))\r\n            .done(function (data) {\r\n                // return json content\r\n                defer.resolve(data);\r\n            });\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Returns all the assignees belonging to a workitem (case - task combination)\r\n     */\r\n    getTaskAssignees: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase, idTask\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getTaskAssignees'), {\r\n                idCase: params.idCase,\r\n                idTask: params.idTask\r\n            }\r\n        );\r\n    },\r\n    /*\r\n     *   Returns the available workitems for a case (Routing service)\r\n     */\r\n    getWorkitems: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        params = params || {};\r\n\r\n        data.idCase = params.idCase;\r\n        data.fromTask = params.fromTask;\r\n        data.fromWorkItemId = params.fromWorkItemId;\r\n        data.mobileDevice = bizagi.isMobile();\r\n\r\n        params.eventAsTasks ? (data.eventAsTasks = params.eventAsTasks) : \"\";\r\n\r\n        if (typeof params.onlyUserWorkItems !== \"undefined\") {\r\n            data.onlyUserWorkItems = params.onlyUserWorkItems;\r\n        }\r\n\r\n        // Required params: idCase\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('case-handler-getWorkItems'),\r\n            data: data,\r\n            serviceType: 'GETWORKITEMS'\r\n        });\r\n    },\r\n    /*\r\n     *   Returns the available workitems for a case (Routing service)\r\n     */\r\n    getQueries: function (params) {\r\n        var self = this;\r\n\r\n        if (self.hashQueries && params.idElement) {\r\n            return self.hashQueries[params.idElement];\r\n        } else {\r\n            var defer = new $.Deferred();\r\n\r\n            // Call ajax and returns promise\r\n            $.read(self.serviceLocator.getUrl('query-handler-getqueries'))\r\n                .done(function (response) {\r\n                    self.hashQueries = {};\r\n                    self.hashQueries[0] = {};\r\n\r\n                    // Process the full response converting it into small entries inside a hashtable\r\n                    self.processQueries(response.query);\r\n                    defer.resolve(self.hashQueries['-1']);\r\n                });\r\n            return defer.promise();\r\n        }\r\n    },\r\n    /*\r\n     *   Creates a hash of queries to simulate each category request\r\n     */\r\n    processQueries: function (queries) {\r\n        var self = this;\r\n        $.each(queries, function (i, query) {\r\n            if (!self.hashQueries[query.idParent]) {\r\n                self.hashQueries[query.idParent] = [];\r\n            }\r\n            self.hashQueries[query.idParent].push(query);\r\n            if (query.nodes) {\r\n                self.processQueries(query.nodes);\r\n            } else {\r\n                query.nodes = {};\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Creates a new case in BizAgi\r\n     */\r\n    createNewCase: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.create({\r\n            url: self.serviceLocator.getUrl('case-handler-addNewCase'),\r\n            data: {\r\n                idWfClass: params.idWfClass,\r\n                caseData: params.caseData ? JSON.stringify(params.caseData) : null,\r\n                idOrganization: params.idOrganization ? params.idOrganization : null\r\n            },\r\n            serviceType: 'NEWCASE'\r\n        });\r\n    },\r\n\r\n    /*\r\n     * La idea con este servicio es por ahora quitar el hatStartForm del servicio de Shortcuts y de acciones\r\n     * retorna si tiene forma de inicio y el guid de la entidad de proceso\r\n     */\r\n    validateHasStartForm: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            processId: params.processId\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"case-handler-validateHasStartForm\"),\r\n            data: data,\r\n            batchRequest: true\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n     *   Start process in Bizagi\r\n     */\r\n    startProcess: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        var data = {\r\n            idProcess: params.idProcess,\r\n            entityMapping: params.mapping ? JSON.stringify(params.mapping) : {}\r\n        };\r\n\r\n        if (typeof params.idParentCase !== \"undefined\") {\r\n            data.idParentCase = params.idParentCase;\r\n        }\r\n\r\n        var defer = $.Deferred();\r\n\r\n        $.create({\r\n            url: self.serviceLocator.getUrl(\"case-handler-startProcess\"),\r\n            data: data,\r\n            serviceType: \"STARTPROCESS\"\r\n        }).fail(function (error) {\r\n            var response = $.parseJSON(error.responseText);\r\n            if (response.status === \"error\" && !bizagi.util.isVersionSupported()) {\r\n                var oldParams = {\r\n                    idWfClass: params.idProcess || params.idWfClass,\r\n                    idOrganization: params.idOrganization || null\r\n                };\r\n\r\n                self.createNewCase(oldParams)\r\n                    .then(function (result) {\r\n                        result.oldVersion = true;\r\n\r\n                        defer.resolve(result);\r\n                    }).fail(function (error) {\r\n                    defer.reject(error);\r\n                });\r\n            } else {\r\n                defer.reject(error);\r\n            }\r\n        }).done(function (data) {\r\n            defer.resolve(data);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     *   Start process in BizAgi\r\n     */\r\n    actionCreateCase: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            processId: (typeof params.idProcess !== \"undefined\") ? params.idProcess : params.guidProcess\r\n        }\r\n        // When the proccess is a shortcut it does not have mapping and parentCaseId,\r\n        // but when the process is not a shortcut, it has a context, so it comes with mapping and parentCaseId\r\n        if (typeof params.parentCaseId !== \"undefined\") {\r\n            data.parentCaseId = params.parentCaseId;\r\n        }\r\n        if (typeof params.mapping !== \"undefined\") {\r\n            data.entityMapping = params.mapping ? JSON.stringify(params.mapping) : {};\r\n        }\r\n\r\n        return $.create({\r\n            url: self.serviceLocator.getUrl(\"handler-execute-action-start\"),\r\n            data: data,\r\n            serviceType: \"STARTPROCESS\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get the first parent plan on not contextualizeds plans\r\n     * */\r\n    getFirstParentPlan: function (data) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"project-plan-first-parent-plan\");\r\n        var defer = $.Deferred();\r\n        $.when($.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\"\r\n        })).done(function (response) {\r\n            defer.resolve(response);\r\n        }).fail(function () {\r\n            defer.resolve(null);\r\n        });\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Search cases with radNumber\r\n     */\r\n    searchCases: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n\r\n        data['h_action'] = 'SEARCHCASES';\r\n        data['onlyUserCases'] = false;\r\n        data['active'] = false;\r\n        data['page'] = params.page || 1;\r\n        if (params.radNumber)\r\n            data['radNumber'] = $.trim(params.radNumber);\r\n        data['pageSize'] = params.pageSize || self.pageSize;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('query-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Search cases with radNumber\r\n     */\r\n    queryCases: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n\r\n        data.h_action = 'QUERYCASES';\r\n        data.onlyUserCases = params.onlyUserCases || false;\r\n        data.active = params.active && true;\r\n        data.page = params.page || 1;\r\n        if (params.radNumber)\r\n            data.radNumber = $.trim(params.radNumber);\r\n        data.pageSize = params.pageSize || self.pageSize;\r\n\r\n        data.filter = params.filter;\r\n        data.outputxpath = params.outputxpath;\r\n\r\n        // data for sort columns\r\n        data.orderFieldName = params.orderFieldName || '';\r\n        data.orderType = (params.orderType == 'asc' || params.orderType == 1) ? 1 : 0;\r\n        data.order = params.order || '';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('query-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Search entities service\r\n     */\r\n    queryEntities: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n\r\n        data.h_action = 'QUERYENTITIES';\r\n        data.page = params.page || 1;\r\n        data.pageSize = self.Class.ENTITIES_QUERY_PAGE_SIZE;\r\n\r\n        // Query parameters\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + 'idEnt'] = params.idEntity;\r\n        data.filter = params.filter;\r\n        data.outputxpath = params.outputxpath;\r\n\r\n        // Data to sort columns\r\n        data.orderFieldName = params.orderFieldName || '';\r\n        data.orderType = params.orderType || '';\r\n        data.order = params.order || '';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('query-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *  Get Menu Authorization\r\n     */\r\n    getMenuAuthorization: function () {\r\n        var self = this;\r\n\r\n        return $.read(\r\n            self.serviceLocator.getUrl('authorization-handler-getMenuAuthorization')\r\n        );\r\n    },\r\n    /*\r\n     *  The user have permissions to excecute this Case\r\n     */\r\n    isCaseCreationAuthorized: function (params) {\r\n        var self = this;\r\n        var urlSend = self.serviceLocator.getUrl('authorization-handler-isCaseCreationAuthorized');\r\n        urlSend = urlSend.replace('{0}', params.idWfClass || '');\r\n\r\n        return $.read({\r\n            url: urlSend //,\r\n            //data: { 'idWfClass': params.idWfClass }\r\n            //data: { 'userName': BIZAGI_USER, 'password': BIZAGI_PASSWORD, 'domain': BIZAGI_DOMAIN }\r\n        });\r\n    },\r\n    /*\r\n     *   Returns the execution state of an async workitem\r\n     */\r\n    getAsynchExecutionState: function(params) {\r\n        var self = this;\r\n        var idAsynchWorkitem;\r\n        params = params || {};\r\n\r\n        if (params.idCase != -1) {\r\n            return $.read({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getAsynchExecutionState\"),\r\n                data: {\r\n                    idCase: params.idCase,\r\n                    idAsynchWorkitem: params.idAsynchWorkitem\r\n                },\r\n                serviceType: \"ASYNCHEXECUTION\"\r\n            });\r\n        } else {\r\n            return $.read({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getAsynchExecutionState\"),\r\n                data: {\r\n                    idCase: params.idCase,\r\n                    idAsynchWorkitem: params.idAsynchWorkitem\r\n                },\r\n                serviceType: \"ASYNCHEXECUTION\"\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *  Returns the supported log types\r\n     */\r\n    supportedLogTypes: function () {\r\n        var self = this;\r\n\r\n        return $.read(self.serviceLocator.getUrl('case-handler-supportedLogTypes'));\r\n    },\r\n    /*\r\n     *   Returns the Activity Log for a case\r\n     */\r\n    getActivityLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getActivityLog'), {\r\n                idCase: params.idCase,\r\n                orden: params.sort || 0,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Activity Detail Log for a case\r\n     */\r\n    getActivityDetailLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idWorkItemFrom\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getActivityDetailLog'), {\r\n                idCase: params.idCase,\r\n                idWorkItemFrom: params.idWorkItemFrom,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Entity Log for a case\r\n     */\r\n    getEntityLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getEntityLog'), {\r\n                idCase: params.idCase,\r\n                orden: params.sort || 0,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Entity Detail Log for a case\r\n     */\r\n    getEntityDetailLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getEntityDetailLog'), {\r\n                idCase: params.idCase,\r\n                idEntity: params.idEntity || -1,\r\n                userFullName: params.userFullName || '',\r\n                attribDisplayName: params.attribDisplayName || '',\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the User Log for a case\r\n     */\r\n    getUserLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getUserLog'), {\r\n                idCase: params.idCase,\r\n                orden: params.sort || 0,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the User Detail Log for a case\r\n     */\r\n    getUserDetailLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase , idUser\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getUserDetailLog'), {\r\n                idCase: params.idCase,\r\n                idUser: params.idUser,\r\n                entDisplayName: params.entDisplayName || '',\r\n                attribDisplayName: params.attribDisplayName || '',\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Admin Log for a case\r\n     */\r\n    getAdminLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getAdminLog'), {\r\n                idCase: params.idCase,\r\n                orden: params.sort || 0,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Adds a New Favorite\r\n     */\r\n    addFavorite: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n\r\n        return $.create(\r\n            self.serviceLocator.getUrl('favorites-handler-saveFavorite'), {\r\n                idObject: params.idObject,\r\n                favoriteType: params.favoriteType\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Favorites service\r\n     */\r\n    delFavorite: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n\r\n        // Required params: guidFavorite\r\n        return $.destroy(\r\n            self.serviceLocator.getUrl('favorites-handler-deleteFavorite'), {\r\n                guidFavorite: params.idObject\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    // Data Transformations for Summary Widget\r\n    /*\r\n     * Render Assigness\r\n     */\r\n    summaryAssigness: function (options) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        var idCase = options.idCase || \"\";\r\n\r\n        $.when(\r\n            self.getCaseAssignees({\r\n                idCase: idCase\r\n            })\r\n        ).done(function (baseAssignees) {\r\n\r\n            var assignees = baseAssignees.assignees || [];\r\n            var assigneesLength = assignees.length;\r\n            var assigneesFix = {\r\n                showAssignees: (bizagi.override.showAssignees && assignees.length > 0) ? true : false,\r\n                assignees: {},\r\n                events: \"\",\r\n                activities: \"\"\r\n            };\r\n\r\n            var assigneesEvents = \"\";\r\n            var assigneesActivities = \"\";\r\n            var assigneesEventsList = [];\r\n            var assigneesActivitiesList = [];\r\n\r\n            for (var i = 0; i < assigneesLength; i++) {\r\n                if (bizagi.util.parseBoolean(assignees[i].isEvent)) {\r\n                    if (assigneesEventsList.indexOf(assignees[i].idUser) == -1) {\r\n                        assigneesEventsList.push(assignees[i].idUser);\r\n                        assigneesEvents += assignees[i].Name + \", \";\r\n                    }\r\n                } else {\r\n                    if (assigneesActivitiesList.indexOf(assignees[i].idUser) == -1) {\r\n                        assigneesActivitiesList.push(assignees[i].idUser);\r\n                        assigneesActivities += assignees[i].Name + \", \";\r\n                    }\r\n                }\r\n            }\r\n            //join assignees to event and activities\r\n            assigneesFix.events = assigneesEvents.substring(0, assigneesEvents.length - 2);\r\n            assigneesFix.activities = assigneesActivities.substring(0, assigneesActivities.length - 2);\r\n\r\n\r\n            def.resolve(assigneesFix);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /*\r\n     * Render Assigness\r\n     */\r\n    summarySubProcess: function (options) {\r\n        var self = this;\r\n        var def = $.Deferred();\r\n        var idCase = options.idCase || '';\r\n\r\n        $.when(\r\n            self.getCaseSubprocesses({\r\n                idCase: idCase\r\n            })\r\n        ).done(function (subprocess) {\r\n            subprocess['showSubProcess'] = (subprocess['subProcesses'].length >= 1) ? true : false;\r\n            subprocess['showSubProcesColumns'] = (subprocess['CustFields'][0] !== undefined && subprocess['CustFields'][0][0].length >= 1) ? true : false;\r\n\r\n            // Prepare json for subprocess\r\n            if (subprocess['showSubProcesColumns']) {\r\n                subprocess['subProcPersonalized'] = {};\r\n                var len;\r\n                for (var n = 0; n < subprocess['CustFields'].length; n++) {\r\n                    len = 0;\r\n                    for (var i = 0; i < subprocess['subProcesses'].length; i++) {\r\n                        if (subprocess['subProcesses'][i]['idCustData'] == n) {\r\n                            subprocess['subProcPersonalized'][n] = subprocess['subProcPersonalized'][n] || {};\r\n                            subprocess['subProcPersonalized'][n]['subProcesses'] = subprocess['subProcPersonalized'][n]['subProcesses'] || {};\r\n                            subprocess['subProcPersonalized'][n]['subProcesses'][len++] = subprocess['subProcesses'][i];\r\n                        }\r\n                    }\r\n\r\n                    if (subprocess[\"subProcesses\"][n][\"idCustData\"] != -1 && subprocess[\"subProcPersonalized\"][n] != undefined) {\r\n                        subprocess[\"subProcPersonalized\"][n][\"CustFields\"] = subprocess[\"CustFields\"][n];\r\n                        subprocess[\"subProcPersonalized\"][n][\"idCase\"] = subprocess[\"idCase\"];\r\n                    }\r\n                }\r\n            }\r\n\r\n            def.resolve(subprocess);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /*\r\n     * Render Case Events\r\n     */\r\n    summaryCaseEvents: function (options) {\r\n        var self = this;\r\n        var def = $.Deferred();\r\n        var idCase = options.idCase || '';\r\n\r\n        $.when(\r\n            self.getCaseEvents({\r\n                idCase: idCase\r\n            })\r\n        ).done(function (events) {\r\n            events['showEvents'] = (events['events'].length >= 1) ? true : false;\r\n            def.resolve(events);\r\n        }).fail(function(error){\r\n            def.reject();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /*\r\n     * Render Details\r\n     * @param idWorkitem\r\n     */\r\n    summaryCaseDetails: function (options) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        var idWorkitem = options.idWorkitem || 0;\r\n\r\n        $.when(\r\n            self.getCaseSummaryDataContent(options)\r\n        ).done(function (data) {\r\n            data.currentState = data.currentState || [];\r\n            var dataCurrentStateLength = data.currentState.length;\r\n            // Show or hide tabs\r\n            data.showEvents = (data.countEvents >= 1) ? true : false;\r\n            data.showParentProcess = (data.idParentCase >= 1) ? true : false;\r\n            data.parentProcess = {\r\n                \"displayName\": data.parentDisplayName,\r\n                \"idCase\": data.idParentCase\r\n            };\r\n\r\n            //data.isOpen: if request have onlyUserWorkItems = true, so verify workitems of current user\r\n            //data.isClosed: if request have onlyUserWorkItems = false, not verify workitems of current user\r\n            data.isClosedForAllUsers = bizagi.util.parseBoolean(data.isClosed);\r\n            data.isClosed = (bizagi.util.parseBoolean(data.isOpen)) ? false : true;\r\n            data.showAssignees = (bizagi.override.showAssignees && data.countAssigness > 0) ? true : false;\r\n            data.showSubProcess = (data.countSubProcesses > 0) ? true : false;\r\n            data.showForm = (bizagi.util.parseBoolean(data.hasGlobalForm)) ? true : false;\r\n            data.allowsReassign = \"false\";\r\n\r\n            for (i = 0; i < dataCurrentStateLength; i++) {\r\n                if (data.currentState[i].idWorkItem == idWorkitem) {\r\n                    data.allowsReassign = data.currentState[i].allowsReassign;\r\n                }\r\n            }\r\n\r\n            // edit original data, no show events in activities tab\r\n            var currentStateTypes = [];\r\n            var m = 0; // counter for new activities array\r\n            for (i = 0; i < dataCurrentStateLength; i++) {\r\n                if (!bizagi.util.parseBoolean(data.currentState[i].isEvent) && bizagi.util.parseBoolean(data\r\n                        .currentState[i].assignToCurrentUser) && data.currentState[i].idWorkItem != idWorkitem) {\r\n                    currentStateTypes[m++] = data.currentState[i];\r\n                }\r\n            }\r\n\r\n            data.currentStateTypes = currentStateTypes;\r\n            data.showActivities = (currentStateTypes.length > 0) ? true : false;\r\n\r\n            def.resolve(data);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    releaseActivity: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"case-handler-releaseActivity\");\r\n        url = url.replace(\"{idCase}\", params.idCase);\r\n        var data = {};\r\n        // Define data\r\n        if (params) {\r\n            data[\"idCase\"] = params.idCase;\r\n            data[\"idWorkItem\"] = params.idWorkItem;\r\n        }\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: url,\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\"\r\n        });\r\n\r\n    },\r\n    /**\r\n     *\r\n     * Segment Activities for summary in render module\r\n     * @param options {data,idWorkItem}\r\n     */\r\n    summaryActivities: function (options) {\r\n        var activities = {};\r\n        var data = options['data'] || {};\r\n        var idWorkItem = idWorkItem || options['idWorkitem'] || 0;\r\n\r\n        try {\r\n            activities['showActivities'] = (data['currentStateTypes'].length >= 1) ? true : false;\r\n            activities['currentState'] = data['currentStateTypes'];\r\n            activities['globalIdWorkitem'] = idWorkItem;\r\n            activities['creationDate'] = data['creationDate'];\r\n        } catch (e) { }\r\n\r\n        return activities;\r\n    },\r\n    /**\r\n     *  Get json from cases service\r\n     */\r\n    getCaseSummaryDataContent: function (options) {\r\n        var self = this;\r\n        var promise = new $.Deferred();\r\n\r\n        $.when(self.getCaseSummary(options))\r\n            .done(function (data) {\r\n                // Completes data\r\n                data.taskState = self.icoTaskState;\r\n                data.process = data.process ? data.process : \"\";\r\n\r\n                if (data.createdBy) {\r\n                    data.createdByName = data.createdBy.Name;\r\n                    data.createdByUserName = data.createdBy.userName;\r\n                    data.caseDescription = (data.caseDescription == \"\" ? \"\" : data.caseDescription);\r\n                    data.processPath = data.processPath.replace(/\\//g, \" > \") + data.process;\r\n                    data.showWorkOnIt = true;\r\n                }\r\n\r\n                // return json content\r\n                promise.resolve(data);\r\n            });\r\n\r\n        return promise.promise();\r\n    },\r\n    /**\r\n     * Definition service for bizagi smart folders\r\n     *\r\n     * @param id optional with filter purpose\r\n     */\r\n    getSmartFolders: function (id) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.idFolder = id || '';\r\n        // Call read and returns promise\r\n        return $.read(self.serviceLocator.getUrl('folders-handler-getUserQueries'), data).pipe(function (response) {\r\n            if (id == -1 || id == '') {\r\n                return response;\r\n            } else {\r\n                return self.searchFolders(id, response) || [];\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Delete smart folder\r\n     * @param options {idSmartFolder,idUser}\r\n     */\r\n    deleteSmartFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = '6';\r\n        options = options || {};\r\n\r\n        data.idSmartFolder = options.idSmartFolder || '';\r\n        data.idUser = options.idUser || '';\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('folders-associate-deleteSmartFolder'), data);\r\n    },\r\n    /**\r\n     * Definition service for bizagi folders\r\n     *\r\n     * @param id optional with filter purpose\r\n     */\r\n    getFolders: function (id) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = 'getUserFolder';\r\n        data.idFolder = id || '';\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-handler'),\r\n            type: 'POST',\r\n            data: data,\r\n            dataType: 'json'\r\n        }).pipe(function (response) {\r\n            if (id == '') {\r\n                var folders = {\r\n                    folders: [{\r\n                        name: bizagi.localization.getResource('workportal-widget-folders'),\r\n                        id: '-1',\r\n                        idParent: 0,\r\n                        childs: response\r\n                    }]\r\n                };\r\n                return folders;\r\n            } else if (id == -1) {\r\n                return response;\r\n            } else {\r\n                return self.searchFolders(id, response) || [];\r\n            }\r\n        });\r\n    },\r\n    searchFolders: function (idFolder, data) {\r\n        for (var i = 0; i < data.folders.length; i++) {\r\n            var value = data.folders[i];\r\n            if (value.id == idFolder) {\r\n                return data.folders[i]['childs'];\r\n                break;\r\n            }\r\n        }\r\n        return undefined;\r\n    },\r\n    getCasesByFolder: function (query) {\r\n        query = query || '';\r\n\r\n        return $.ajax({\r\n            cache: true,\r\n            url: 'RestServices/' + query,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    makeFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = 'CreateUpdateFolder';\r\n        data.folderName = options.folderName || 'No Name';\r\n\r\n        // Make folder under subcategory\r\n        if (options.idParentFolder != undefined && options.idParentFolder > 1) {\r\n            data.idParentFolder = options.idParentFolder;\r\n        }\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    updateFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n        options = options || {};\r\n\r\n        data.action = 'CreateUpdateFolder';\r\n        // Define idFolder\r\n        data.idFolder = options.idFolder || '';\r\n\r\n        // Update name\r\n        if (options.folderName) {\r\n            data.folderName = options.folderName;\r\n        }\r\n\r\n        // Update path\r\n        if (options.idParentFolder) {\r\n            data.idParentFolder = options.idParentFolder;\r\n        }\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /**\r\n     * Associate cases to folders\r\n     *\r\n     * @param options {idcase,idCustomFolder}\r\n     */\r\n    associateCaseToFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = '4';\r\n        options = options || {};\r\n\r\n        data.idCase = options.idCase || '';\r\n        data.idCustomFolder = options.idCustomFolder;\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-associate'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     * Dissasociate cases to folder\r\n     *\r\n     * @param options {idFolder, idCase}\r\n     */\r\n    dissasociateCaseFromFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = 'DeleteCaseFromFolder';\r\n        options = options || {};\r\n\r\n        data.idFolder = options.idFolder;\r\n        data.idCase = options.idCase;\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /**\r\n     * Delete folder\r\n     * @param options {idCustomFolder}\r\n     */\r\n    deleteFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = '5';\r\n        options = options || {};\r\n\r\n        data.idCustomFolder = options.idCustomFolder || '';\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-associate'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /**\r\n     * Gets a file binary from the server\r\n     * @param options {fileId}\r\n     */\r\n    getFile: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = this.serviceLocator.getUrl('file-handler');\r\n        options = options || {};\r\n\r\n        data.action = 'getFileContent';\r\n        data.uploadId = options.uploadId || '';\r\n        data.entityId = options.entityId || '';\r\n        data.entityKey = options.entityKey || '';\r\n\r\n        return bizagi.services.ajax.pathToBase + url + '?' + jQuery.param(data);\r\n    },\r\n    /**\r\n     * Get Comments per case\r\n     * @param params {idCase=int&idColorCategory=int&pag=int&pagSize=int}\r\n     * @return json\r\n     */\r\n    getComments: function (params) {\r\n        //params.idCase = params.idCase || 0;\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        return $.read(encodeURI(self.serviceLocator.getUrl('MessageHandler-GetComments')), {\r\n            idCase: params.idCase || '',\r\n            idColorCategory: (typeof params.idColorCategory == 'number') ? params.idColorCategory : '',\r\n            pag: params.pag || 1,\r\n            pagSize: params.pagSize || 10\r\n        })\r\n            .pipe(function (result) {\r\n                var def = new $.Deferred();\r\n                var picture = 'iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJwSURBVHhe7Vt5UJPnuj+ddvSqdcpotQougCyGRfY9QCQQwhKIrAqurUtbbbVV1KO2UrXH46lL1aOOdWvrcl3QuosIBUSGongA5bLXqLjCVbarrX/97vO8SSAieLRVJ86czPwmX0L8vve3PM/7vp/JX/7yn8d/FHhVCkykC+144403NL16vQ1TU1MtBpqiR48eoL8VE9YQnF/VgF7VdVLffPPNRkdHJ0SER0CpDIdCEYqQkBAtgvlZgdDQUHh5ecHMzIzFyCbIXtUAX9Z12MliN1c3JCcnIzkpGWp1jCBrSD6YBAgODoZczpALBMmCYGFhwULsIJi8rAG+zPM6s+vseGLiaMTFxSM2JlaQl8lkAoGBgQgMCERAQAD8/f0hlfrDz88Pfr5+8PX1FXByctKXxmslgiAfEqxAdFQ0VKooqCJVwnVvb1+Ct4i6l6cXPDw8CR5wd3OHm5sbXF1d4ezMcIYTlQwLYGNjoxfhZRr2ws7NTmm8vLwRSnWuIMelflK46kkRISbl6OAIB4K9vT3s7ewhkdgRJLC1sRWEra2tYWVlhWHDhonnPn36sAjcII3+kWplZQ0Pd08RYXt7Bx0pW0FKT8xqmBUsLYfB0sISFkMtMHToUAwZPASDBw8WTdDU1AwDBw4UGDBggAClikUwN2YFTLp37y5izvFlId7t+y4G9B8gSGmJaae9gQO0xPr3649+/fqJz/UlsNN9TPrAxMRE4J133hGf43RwEnRN0Wg1mMVR5q5vQc72pLl99sfj0b3bW3j77beJYF8t+vRtI9qjR0+80/sdIqoly8e9e/d+DJaWlrC1tRXlwn8z5lmh2MvTm2rYFt26dcOSeTNQnn8U2Ue2w8pyCHp076EjTwIIl/vgrbfeYkKCGAvQ+ykCcAq4VOjzE40xAiYm5CIvdvpRrHv26I6a8+nQXMxAbdFpFGcfxJTx8YIsk9fHnB3n9xicho7uc3K4D3ACGNxDjLUZyrh+hwwZSvXcD3J/T1wrPYNrJRkC10uzUPFLOnZvWQ13Zwf06tVL29yoPzBJqZc7fD2cRaN7913qG/Q3fuY+wKLwbMACGKwSjS4EsoHU3MzMBoOTwLVfV5pJOCNw41I2bpadxbVLubiUn46VyxZhYP9+QghujBx/pVyKr+d/goH9+gpRWAR2n4Xg1wwWmfcSRsee65IF4O7OdTxn+gTcvJyFm5cyBW6V5eB2xTncrvoFd2qKoLmcj5L8DHy37hsE+HmR828xMVgOMcWejcsw98MkSN3tRY/gBOgF4EToSsbo+oBMTG0UaRZg/fL5uFOWTcgSuFuRi7uV+aivKUTDlYtouFqKe9fLUVddgrLCLGQc/hGLPp+GQF83mPZ/F9tXzkPegfU4vHkJUmeOx9houSCuE4B3jWpjS4GMu3p/FuDtXqgsOIr6ihzUl2cLNFSeRUN1Ae7VXsD9qyVovH4JTTcq0XyrBo115bhbfQG1FzJQmrUfpWd24VbREdwpOoTrBftQkfk9StO3GApglCtCE65nruUFMz8gwrm4V0WozCHkorEmH02a82i5XoLWG5fx8E4VHt6txcP6q3hwuwotdaVovHIe96vO4l7ZGTSUHkd98WHUXzxEOIj6ojT4eziAF1rkfKqxuS/G06vHfzXy9HZo+2oikovmmjy01BKunEPr1UI8uF6EhzdK8dvtcvx2txq/37uKR/ev47f6WvHew7pitF4pQFNlFu5dOoF7JUcIh3Gv+BDukQiBXo7o2bMnkiOkvEU2rsepTYsmTklQigXQ0R/XoonIN1ZRCVzOQF3RUdy4eAI3S07jFs0It2hGaL5eSgJo8KhRJ8CtMjRQn7hRdBx1hRT9/L24lrcL1wm3C/eRAGmQ+7qKafIfcyfjxIZFxtUDTmxamHpwy3JRp0d/WIP6skxcPX8ENXn7tTiXhqqzB1CZewDl2VTXOQdwX1NCCbhGCagRopRn7iLsRGXWTlRR3ddkfY/abC2uZG+Hr6stYkOlyNi9Fic3LphlVBFgRzL3rINc6o7D36+ixpeJO5cycLs0nVxnZBDJLJoOc2k9kIfawpO4XpzZJoCm8DiuFaWjrphw4QjqqPnV5e/GDcJNwp3CvVi9YDLy9qxC5u7VOLVpocyoBDi1abH52X1ryZ3VKCMn66mRNVVlaxtaWQYayrNoVshFfRVNhdWFtCYowNWiDDy6RwmgfnC7/BzulucK0e4UH8edC2m4c36fQP2FfWgsPoCajC24eHQT8ug6P61ZbGJUAvBgzmxdqrlB7p3bv0643lKdQ6B6r8pCU3Uu9QWaCa4UounqRTReLUZFbppohCwAv3e/Oh/3K7Jx/3K6aH73i9MEGhkXqXRObsSVvL04tflLXgcY34PLoOjwP5Gz8x+4UXyCunkmWog8o5Vmg1bNLzQTXMRvNBM0XrlgIECVeO/htfNorTmLlvIMNJUeQWPJwTbyjRf345e934DPb3QN0NAKHtzhdXM1tef2o+HyaTSTCM1VmYJYq6YAD64VCbL1tCoUCWjQUAJ0AtBU2UpJaSk/TQIcfox8w/k9OLFxocaoyeuFOLouRV14aANulxwnAc4IEVprcmmOzycBLtB8X4o62iZX5OgEuFOpTYCGBchBc5lOAIo9O8+ozviOGt8io1v/d1mHxzYs1Fw7fwjNFRlCBCbWWnsOD66eJwFKUJ13SEyFIgFCgBI8oBJpocbZXJaOppJDbeRZgPzdf2/8aYcRNr6uFDi4NiW1NH0bLWlPCBFaqRlqBShEMy159WuB3xuuCAFYlAdUIkKAyydJAKp/nfvXcraT+18a5fq/ywTwNJW+dUljXeFBNFNTa9U1wgcU84fXi2lKzKOF0SFKAAlwu0IrAC2DW2gZ3HyZGqiBAOQ+Tu1Ybm58bf/fjIhTUHhwPRrJ0RbRB86KmD/kmeDmJXK+Cr/XswC0DyBRHlCP6CgAu396y1fGufl5FkfSVqdoNDR3t3AfoEbILrcLUEkC6DZCJEpHAbjzZ21bguzXqfY7inJk/bzU01uXUC84KRohk3yomwq59oUAtBFiUToKUHKI1vybv+D9xev7OLBqdmpe2gZcOLIJTRVZbQJot8UsQE2nAlRnbEPe7hU4s33p6y3AwbVzf6osPIHMXatQcnIbWmib/OAqrQWEABWdClCbsxOZ25eh/DSt/SkFp79b7PzaRuDExkXZdbQLrCg4JkS4cGwrmmupD9BiqDMBanL3kOvLaNOzgTZB+3Hp2Aac2rLYuHZ+z+PGqiUp2Q/qLtJuLwdVdJ/wwvFtyPh+BYpP78QN+r8C3gXepnsB1WfTkLNrJU5Sv/jl0HrcKNgjFkNHvluKxTMnvz4rQBYnOjraPDIycs1IpVrj6S9HQcY+tNISuJlmgJt0X6A0ay/O7F2Hw0Ru/7qF+OGbFPy4ai69XoJ8mjYr6WYI3wW6SSKMT1TDL3oilFHxGpVKlcrnfh4DXulnaYATw1SjsmWxk+GS/CXsx6+Ac9znUCpCsHPzSnFfkPcDfHOk/Ox+nDv8HY5uX4E9//wSaXT7+wwl4PyRjUIAvgs8LoHIK+NgN26FOBefk8/N1+BrvVJyXV2MHWFnFOrRjd6jZ8Nx3NdisIbwSPgMsuBQxKhV2LlpBUqz9wsBCqgfnPxxVZsAx7b9DdtWzkfK9IniuwU+ihjYJS974nx8Db5WaFR8oy4VJq9cDF3Md4SMGgv3pAVPDLKjCE5jl0AaMxUjQ1Xi+0BMcNzoWIyJi0K8OgKhIXLx/SD+3pBvRBJcEufDTgj5d9iPM8Ryek0Yuxx2BLfR8xE8KhlUcjteSXnQRUxY9Wcl3lEIJuSS9AU8ElPgE/shvEZNE3CLm0mk5wlSdmP/pkUy42sDLINdkh5L6ZgwZikkBNeEFMjVSS83EeHh4c4RqlGaJx0nh/6NU12SaiPExLSE9KQkY5YQOcJoxlftSEyFpA2LIUnQYjjBPXYm94hiHusLLQs+oUKd2OiYTAPUxe+FkUokck8hNTzhSwyPZ3zxOOIWYXgbFmJ4rBZ2sfMQokpofGEicOzDyXmHMam6CHblkoFTTyVFZDojFUcEuyBlG7sAAjGMvz6OUfNhKzBPC/U8SNRzKAnqF3PzlOd01/g5HVziGLZHTxB6UaRGEcFOSDExG/VcLaIZKe2IouOoOTrMpufZcFVNo+8oqv7cVppjFKQeB4lBBG05ap04xe936VQbocedsnkqKT0hfiZSqnZYqz6HdaQen9GxFlbhn8I6YlYbRqpG40/NDqRgtnM8RSquPX7Dwj/RRvAFkrImcl2RMiRkHTET1uHtYMJWYYxPBCxDpmFY6HRYKWfAOmwGHCI+FlPkH2qIERERsqBRE+AQvwCSmPlt8bMImdohfp07JQh15lTEZ1i3Ox38SJ6/ntzqQKgDKUFOyZhhACLJRHUYFvoxhik+hqV8MsxHTqLjj2BN7w0PnwGZaswfSwG5/5M71b5j7HxqKlRjOpcGS8c8GT+D2GkdezqpdbtOagWYu7ZTUoKQjhSTaUMIHYd82I5gcrwNU2FB5If4jSEhpsCa0jBc+RGcwqc9fwq4buRU+y7x8+EYkwJJ1OewIWIWwVMwyDtO1FrH+GmdMnSJjzu4pCO1dudxIUDSnNXwSpiDUdO/hrN6lpaYASnL4KkQkDOmtCOIjoMm6/ABLEdqMVSaDDP3aDp+H9aUBoliGhzCPoI8MuH5UsCd3yd2BlxiU+Co/hwSFblKNTVEmgQzrxhRaxy/rp0ycKkTUmt/OCoE+HHPfvz888/49ddf8ejRI6Sl58M5imo5qJ0UE7MgQhYyPSbRsQ6BE2HRhgkY4pOIAU6hsAycAOugSZCETIaDciq8wyfwjDDrmXtBuCpW4xGfApcY2uBEzYIk4hNRU4O8YmHmqYYFDdAweu0uGTj1mEvsVjupb78/IgRYunIjZi5eg282/zf+936TeC8j71+PkbIImAA9zAPGw9xfj3F0rIN0LMwJg73i8J6DHOa+o2EtmwCJfBIcFZPhpJwCZYT62b5ep5/6PGJnw4Vi6Rj5CSRhH8Oa4jTQOUxEjFXXRtDQKXKoM6cec4kdm4Bvd/wkyI7+dDn0pEaEfYjm1gfifWn8Z4JQO5Jh7qdHEob6EXwZY9rhMwaDPWLwnn0QhnrGwDpgLCQjJ8AxZBJclJMRGJaAZ1od8uJBGvMhPGJmwSXqUzjSVCIJnQZrqn8+uambSijfHj0iZeCSBbvUmVMGhNZsOyiITv3rah0xLamCf5WL9xOnL9ESI1JDfUa3wzsRQ9uQgCFeesTTcTwGuUXjPYkMg8goG/8xkMjGwlE+AS6KSfBUJD9TGXQjlU66Rc2Ah/pTuKimw5GcsVNQVw16H/1s/WDqEikGK+L3mEvkWJtL7JbepY5OjcZX3/4giBZc/J82QmHj5rYlwFc9XRAS8NQjjo518IjFkDbEYLC7FoNcVHhveCAGjQiBjV8iJAFJGBE0Fi4hE+AUNI6325upDwwjvNlVP3DkD/lEvg/P6OlwjfgII6iJ2AW/Dyv/JPRnAUhd4cpj8TNwif9m4NJQ7yedciBX6m7VCxH4mYVobvk/8XrrnmNErp3UYPdRRI7gxlAbIBqDXQ0RBTOncAwY7o+BBBvfOEj8EzFCRvcX5OMgVSbS75KkK4m4G0HSlQBu9J1+mUKhyB6pSoZb+GSMUHwAuyCqee8Y9LfxhamTUufO4/HTOmXgEh8buNSRlI9qKgqKLgvS/GABtu4++gSpQS5R5CxDpYUzI7IdThEYpIOZoxIDbKUYaOMDGxqvnV88nAMTEUi31pgTc9MJwCJ0+uiv/wD9tmeqUqnMDoqIp/qhxY831Red2NRRIZoNE3p+p6KIoJ6QISkDQkzOgNQgcpVhNoJBTZjhqIeSjnVwCIWZfQgG2PhhkK0PPGVqyJVq+p2iMpu5GBBn8n2fNiX21tUJf1AkwsfHJ5V+23csSBF5y1sWCSf/aEh89PH7g6QEoY6kDAgxMSbVBgURVMBUIKQddiGwdQuFs68SvrJwjJSH3eKx8pg7OM58zAndnnU9wI2CleJ/5KhXkE/KinKv4AvJFcoiaVDErYDgSHgERMKdYO8dgeGe4QJWbkRS79JzkDK1C4aVi0KQs3VTwM4jFO7SMAH/oHBIRypvyYNDi+iHlnt4LDymTgjzuHn8zKPLxvesgrByJgRTXUJsOsRKpIUHwmAHeGCG4DqkSBY9DSxqx39Hvy2crT9vJyRFUgk8Hu7wPD4e5zM7/awCdPU5VpbLhsE9hAdgKBIPTA/njqJ18Zo/Z/jvDMnxufk6+mv+qfH/Pz9r9qvYcZe2AAAAAElFTkSuQmCC';\r\n                if (!result.comments) {\r\n                    result.comments = [];\r\n                } else {\r\n                    // Add CategoryColor for each comment\r\n                    $.each(result.comments, function (key, value) {\r\n                        if (!result.comments[key].hasOwnProperty('CategoryColor')) {\r\n                            result.comments[key]['CategoryColor'] = '';\r\n                        }\r\n                    });\r\n                }\r\n                if (!result.users) {\r\n                    $.when(self.getCurrentUser())\r\n                        .done(function (user) {\r\n                            result.users = [];\r\n                            result.users.push({\r\n                                Id: user.idUser,\r\n                                Name: user.user,\r\n                                DisplayName: user.userName,\r\n                                Picture: picture\r\n                            });\r\n                        });\r\n                } else {\r\n                    $.each(result.users, function (key, value) {\r\n                        // Add picture to all users\r\n                        result.users[key]['Picture'] = (result.users[key]['Picture'] === '') ? picture : result.users[key]['Picture'];\r\n                    });\r\n                }\r\n                def.resolve(result);\r\n                return def.promise();\r\n            });\r\n    },\r\n    /**\r\n     * This function allow create new comment into the activity\r\n     *\r\n     * @param options {idCase,comment}\r\n     * @return json\r\n     */\r\n    makeNewComment: function (options) {\r\n        var self = this;\r\n        var picture = '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';\r\n        return $.create(self.serviceLocator.getUrl('MessageHandler-NewComment'), {\r\n            idCase: options.idCase || '',\r\n            comment: options.comment.replace(/\\n/g, '<br>') || ''\r\n        })\r\n            .pipe(function (result) {\r\n                if (result.comments) {\r\n                    var comments = [result.comments];\r\n                    $.each(comments, function (key, value) {\r\n                        // Add CategoryColor for each comment\r\n                        comments[key]['CategoryColor'] = '';\r\n                    });\r\n                    result.comments = comments;\r\n                }\r\n\r\n                if (result.users) {\r\n                    var users = [result.users];\r\n                    $.each(users, function (key, value) {\r\n                        // Add picture to all users\r\n                        users[key]['Picture'] = (users[key]['Picture'] == '') ? picture : users[key]['Picture'];\r\n                    });\r\n                    result.users = users;\r\n                }\r\n\r\n                return result;\r\n            });\r\n    },\r\n    /**\r\n     * This function allow create new replies into the comment\r\n     *\r\n     * @param options {idCase=int&idComment=int&comment=string}\r\n     * @return json\r\n     */\r\n    makeNewReply: function (options) {\r\n        var self = this;\r\n        var picture = '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';\r\n\r\n        options = options || {};\r\n\r\n        return $.create(self.serviceLocator.getUrl('MessageHandler-ReplyComment'), {\r\n            idCase: options.idCase || '',\r\n            idComment: options.idComment || '',\r\n            comment: options.comment.replace(/\\n/g, '<br>') || ''\r\n        })\r\n            .pipe(function (result) {\r\n                if (result.comments) {\r\n                    result.Replies = [result.comments];\r\n                }\r\n\r\n                if (result.users) {\r\n                    var users = [result.users];\r\n                    $.each(users, function (key, value) {\r\n                        // Add picture to all users\r\n                        users[key]['Picture'] = (users[key]['Picture'] == '') ? picture : users[key]['Picture'];\r\n                    });\r\n                    result.users = users;\r\n                }\r\n\r\n                return result;\r\n            });\r\n    },\r\n    /**\r\n     * Remove one comment from the list in mobiles\r\n     *\r\n     * @param options {content:{guid:\"...\"},attachmentsToDelete:[\"...\", \"...\", ...]};\r\n     * @return json {action:true|false, message:'if error, explain why'}\r\n     */\r\n    removeMobileComment: function (options) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('remove-comment');\r\n\r\n        options = options || {};\r\n\r\n        return $.destroy({\r\n            url: url,\r\n            data: JSON.stringify(options),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Remove one comment from the list\r\n     *\r\n     * @param options {idCase=int&idComment=int}\r\n     * @return json {action:true|false, message:'if error, explain why'}\r\n     */\r\n    removeComment: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('MessageHandler-RemoveComment'), {\r\n            idCase: options.idCase || '',\r\n            idComment: options.idComment || ''\r\n        });\r\n    },\r\n    /**\r\n     * Remove one replies from the list\r\n     *\r\n     * @param options {idCase=int&idComment=int&idReply=int}\r\n     * @return json {action:true|false, message:'if error, explain why'}\r\n     */\r\n    removeReply: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('MessageHandler-RemoveReply'), {\r\n            idCase: options.idCase || '',\r\n            idComment: options.idComment || '',\r\n            idReply: options.idReply || ''\r\n        });\r\n\r\n    },\r\n    /**\r\n     * Rename category\r\n     *\r\n     * @param options {idColorCategory=int&colorName=string}\r\n     * @return json\r\n     */\r\n    renameCommentCategory: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.update(self.serviceLocator.getUrl('MessageHandler-RenameCategoryColor'), {\r\n            idColorCategory: (options.idColorCategory >= 0) ? options.idColorCategory : '',\r\n            colorName: options.colorName || ''\r\n        });\r\n    },\r\n    /**\r\n     * @param options {idCase=int&idComment=int&idColorCategory={0-5}}\r\n     * return json\r\n     */\r\n    setCommentCategory: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.update(self.serviceLocator.getUrl('MessageHandler-SetCategoryToComment'), {\r\n            idCase: options.idCase || '',\r\n            idComment: options.idComment || '',\r\n            idColorCategory: (typeof options.idColorCategory == 'number') ? options.idColorCategory : ''\r\n        });\r\n    },\r\n    /**\r\n     * @return json Definition of all categories of message\r\n     */\r\n    getCommentsCategories: function () {\r\n        var self = this;\r\n\r\n        return $.read(self.serviceLocator.getUrl('MessageHandler-GetCategoryColors'))\r\n            .pipe(function (result) {\r\n                if (result.length > 1 && result[0]['categories']) {\r\n                    return result[0];\r\n                } else {\r\n                    return result;\r\n                }\r\n            });\r\n    },\r\n    /**\r\n     * This service can be define number of new comments based on idComment\r\n     * @param json  options {idCase=int, idLastComment=int}\r\n     * @return int\r\n     */\r\n    getNewComments: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.read(encodeURI(self.serviceLocator.getUrl('MessageHandler-CountNewComments')), {\r\n            idCase: options.idCase || 0,\r\n            idComment: options.idComment || 0\r\n        });\r\n    },\r\n    /**\r\n     * Get all analisys queries\r\n     * @return json\r\n     */\r\n    getAnalisysQueries: function () {\r\n        var self = this;\r\n\r\n        return $.read(self.serviceLocator.getUrl('bamAnalytics-handler-getAnalisysQueries'));\r\n    },\r\n    /**\r\n     * Update name and comment\r\n     *\r\n     * @param options json {queryName,queryDescription,idQuery }\r\n     * @return json  {response:true}\r\n     */\r\n    updateQueries: function (options) {\r\n        var self = this;\r\n\r\n        return $.update(self.serviceLocator.getUrl('bamAnalytics-handler-updateQuery'), {\r\n            idQuery: (options.idQuery >= 0) ? options.idQuery : '',\r\n            queryName: options.queryName || '',\r\n            queryDescription: options.queryDescription || ''\r\n        });\r\n    },\r\n    /**\r\n     * Delete query\r\n     *\r\n     * @param queryId integer\r\n     * @return json  {response:true}\r\n     */\r\n    deleteQueries: function (queryId) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = '1612';\r\n        data.QueryId = queryId || '';\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('reports-handler-deleteQueries'), data);\r\n    },\r\n    /**\r\n     * Get bizagi configuration\r\n     * @param {Function}   type    callback function when the file load is succed\r\n     * @return {deferred} ajax object with JSON content\r\n     */\r\n    getConfiguration: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"authenticationConfig\");\r\n\r\n        return $.read(url);\r\n    },\r\n    /**\r\n     * Logout Service\r\n     */\r\n    logout: function () {\r\n        var self = this;\r\n        // Remove session storage of authentication data\r\n        sessionStorage.removeItem('bizagiAuthentication');\r\n\r\n        //Call to the restfull service for domain list\r\n        try {\r\n            var javaLogout = $.create(self.serviceLocator.getUrl('logout'));\r\n\r\n            $.when(javaLogout).done(function () {\r\n                location.reload();\r\n            }).fail(function () {\r\n                bizagi.log('Error logging out');\r\n            });\r\n        } catch (e) { }\r\n    },\r\n\r\n    /**\r\n     * Logout from different types of services\r\n     * This method can reload the page after calling the logout service required\r\n     */\r\n    logoutMobile: function() {\r\n        var self = this;\r\n        var logoutData = { sourceLogout: \"user\" };\r\n\r\n        // Remove session storage of authentication data\r\n        sessionStorage.removeItem(\"bizagiAuthentication\");\r\n\r\n        // Hybrid will use normal system\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            var url = self.serviceLocator.getUrl(\"logout\");\r\n            return $.create(url);\r\n        } else {\r\n            // Call to the restfull service for domain list\r\n            try {\r\n\r\n                $.when(self.getConfiguration()).done(function (data) {\r\n                    if (data.redirectErrorPage) {\r\n                        window.location.href = data.redirectErrorPage;\r\n                        return;\r\n                    }\r\n\r\n                    var authenticationType = data.authenticationType;\r\n                    switch (authenticationType) {\r\n                        case \"Federate\":\r\n                        var logOffURL = data.logOffURL;\r\n                        var federationLogoutBindingProtocol = data.federationLogoutBindingProtocol;\r\n\r\n                        if (authenticationSubType === 'WSFederated') {\r\n                            $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\r\n                                location.href = logOffURL;\r\n                            }).fail(function () {\r\n                                bizagi.log(\"Error logging out\");\r\n                            }).always(function () {\r\n                                location.href = data.logOffURL;\r\n                            });\r\n                        }\r\n                        else if (authenticationSubType === 'Saml') {\r\n                            var param = {};\r\n                            $.when($.read(self.serviceLocator.getUrl(\"FederateLogoffUrl\"), param)).done(function (res) {\r\n                                if (res.federateLogoffUrl) {\r\n                                    logOffURL = res.federateLogoffUrl;\r\n                                }\r\n\r\n                                $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\r\n                                    if (federationLogoutBindingProtocol === 'POST') {\r\n                                        window.document.open('text/html');\r\n                                        window.document.write(logOffURL);\r\n                                        window.document.close();\r\n                                    }\r\n                                    else {\r\n                                        window.location.href = logOffURL;\r\n                                    }\r\n                                }).fail(function () {\r\n                                    bizagi.log(\"Error logging out\");\r\n                                }).always(function () {\r\n                                });\r\n\r\n                            }).fail(function () {\r\n                                bizagi.log(\"Error logging out\");\r\n                            }).always(function () {\r\n                            });\r\n                        }\r\n                        break;\r\n                    case \"SAML\":\r\n                        loader.nativeAjax(loader.getPathUrl(self.serviceLocator.getUrl(\"logout\"), logoutData),\r\n                            function(response) {\r\n                                var jsonResponse = JSON.parse(response.responseText);\r\n\r\n                                if (jsonResponse.logout === true) {\r\n                                    if (typeof jsonResponse.samlUrlRedirect != \"undefined\") {\r\n                                        var url = decodeURI(jsonResponse.samlUrlRedirect);\r\n                                        var iframe = document.createElement(\"iframe\");\r\n\r\n                                        document.getElementsByTagName(\"body\")[0].appendChild(iframe);\r\n\r\n                                        $(iframe).on(\"load\", function() {\r\n                                            var iframeContent = bizagi.util.isIE8() ?\r\n                                                $(this.contentWindow.document.body) :\r\n                                                $(this.contentWindow.eval(\"document.body\"));\r\n                                            var rawResponse = iframeContent.text();\r\n\r\n                                            location.reload();\r\n                                        });\r\n\r\n                                        iframe.src = url;\r\n\r\n                                    } else {\r\n                                        location.reload();\r\n                                    }\r\n                                } else {\r\n                                    bizagi.log(\"Error logging out\");\r\n                                }\r\n                            });\r\n                        break;\r\n                    case \"OAuth2\":\r\n                        $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function() {\r\n                            $.when($.read(self.serviceLocator.getUrl(\"oauth2AuthenticationConfig\")))\r\n                                .done(function(response) {\r\n                                    if (response.logoutUrl && response.logoutUrl != \"\") {\r\n                                        var logoutUrl = response.logoutUrl;\r\n                                        var callbackUrl = response.homeUrl;\r\n\r\n                                        logoutUrl = logoutUrl.replace(/post_logout_redirect_uri=[^&]*/,\r\n                                            \"post_logout_redirect_uri=\" + callbackUrl);\r\n                                        location.href = logoutUrl;\r\n                                    } else {\r\n                                        location.reload();\r\n                                    }\r\n\r\n                                }).fail(function() {\r\n                                    bizagi.log(\"Error logging out\");\r\n                                });\r\n                        }).fail(function() {\r\n                            bizagi.log(\"Error logging out\");\r\n                        });\r\n                        break;\r\n                    default:\r\n                        //Normal\r\n                        $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData))\r\n                            .done(function() {\r\n                                window.location = bizagi.services.ajax.loginPage;\r\n                            }).fail(function() {\r\n                                bizagi.log(\"Error logging out\");\r\n                            });\r\n                        break;\r\n                    }\r\n                }).fail(function(message) {\r\n                    bizagi.log(message);\r\n                });\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Services for Massive Activity Assignment\r\n     */\r\n\r\n    /*\r\n     * Obtain the organization info, such as roles, skills or locations. One of this options\r\n     * must be specified as a parameter\r\n     * @param object  {objectType=Roles|Skills|Locations}\r\n     * @return json\r\n     */\r\n    getOrganizationInfo: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n        data['objectType'] = params;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('massive-activity-assignments-getOrganizationInfo'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Get Cases By Organization, using parameters suchs as roles, skills and locations\r\n     * @param object  {roles=(string),roles=(skills), locations=(string)}\r\n     * @return json\r\n     */\r\n    getCasesByOrganization: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n\r\n        data['roles'] = (params.roles) ? '[' + params.roles.toString() + ']' : '[]';\r\n\r\n        data['skills'] = (params.skills) ? '[' + params.skills.toString() + ']' : '[]';\r\n\r\n        data['locations'] = (params.locations) ? '[' + params.locations.toString() + ']' : '[]';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('massive-activity-assignments-getCasesByOrganization'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Get Cases By Organization, using parameters suchs as roles, skills and locations\r\n     * @param object  {user=[array], roles=(string),roles=(skills), locations=(string)}\r\n     */\r\n    reassignCases: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n        data['users'] = (params.user) ? '[' + params.user.toString() + ']' : '[]';\r\n        data['roles'] = (params.roles) ? '[' + params.roles.toString() + ']' : '[]';\r\n        data['skills'] = (params.skills) ? '[' + params.skills.toString() + ']' : '[]';\r\n        data['locations'] = (params.locations) ? '[' + params.locations.toString() + ']' : '[]';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('massive-activity-assignments-reassignCases'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     * Search the users inside the Organization, using parameters suchs as userName, full name, domain, roles, skills and locations\r\n     * All parameters are optional\r\n     * @param object  {userName=(string), fullName=(string), domain=(string), roles=(string),roles=(skills), locations=(string)}\r\n     * @return json\r\n     */\r\n    searchUsers: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n        data['userName'] = params.userName || '';\r\n\r\n        data['fullName'] = params.fullName || '';\r\n\r\n        data['domain'] = params.domain || '';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('massive-activity-assignments-searchUsers'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /**\r\n     * Get json with bizagi domains list\r\n     * @return {deferred} ajax object with JSON content\r\n     */\r\n    getDomainList: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('domains');\r\n\r\n        return $.read(url);\r\n    },\r\n    /**\r\n     * Services for Asynchronous ECM Upload\r\n     */\r\n\r\n    /* Get the ECM Pending Scheduled Jobs\r\n     * @return {deferred} ajax object with JSON content\r\n     */\r\n    getEcmAllScheduledJobs: function () {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        data['action'] = 'getEcmAllScheduledJobs';\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('async-ecm-upload-baseService'), data);\r\n    },\r\n    /* Retries an especific ECM Pending Scheduled Job\r\n     * @param object  {jobId=(string)} //The id of the job wich is going to be retried\r\n     * @return {deferred} ajax object with JSON content\r\n     */\r\n    retryECMPendingScheduledJob: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        data['action'] = 'retryECMPendingScheduledJob';\r\n        data['idJob'] = params;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('async-ecm-upload-baseService'), data);\r\n    },\r\n    /*\r\n     *   Returns the current workportal version\r\n     */\r\n    getWorkPortalVersion: function () {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('WorkPortalVersion'),\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        }).always(function (data) {\r\n            // Compatibility with java version\r\n            data = data || {};\r\n\r\n            if (data.version == '') {\r\n                // Take the build version\r\n                data.version = bizagi.loader.productBuild || '';\r\n            }\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n     *   Returns the combo's data to authentication log depending of the params\r\n     */\r\n    getAuthenticationLogData: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var url = '';\r\n\r\n        if (params['dataType'] == 'domains') {\r\n            url = 'admin-getAuthenticationDomains';\r\n        } else if (params['dataType'] == 'events') {\r\n            url = 'admin-getAuthenticationEventsTypes';\r\n        } else {\r\n            url = 'admin-getAuthenticationEventSubTypes';\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(url),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Get the search result of authentication log\r\n     */\r\n    getAuthenticationLogResult: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n        data['action'] = params.action;\r\n        data['domain'] = params.domain;\r\n        data['userName'] = params.userName;\r\n        data['dtFrom'] = params.dtFrom;\r\n        data['dtTo'] = params.dtTo;\r\n        data['eventSubType'] = params.eventSubType;\r\n        data['eventType'] = params.eventType;\r\n        data['pag'] = params.pag;\r\n        data['pagSize'] = params.pagSize;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-getAuthenticationLog'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Return the password encrypted\r\n     */\r\n    encryptString: function (params) {\r\n        var self = this;\r\n\r\n        var data = {};\r\n\r\n        // Define data\r\n        params = params || {};\r\n\r\n        data.entry = params.entry;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-EncryptString'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return the users requests\r\n     */\r\n    userPendingRequests: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            pag: params.pag,\r\n            pagSize: params.pagSize\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl(\"admin-UserPendingRequests\"), data);\r\n    },\r\n\r\n    /*\r\n     *   Return the User Authentication Info\r\n     */\r\n    userAuthenticationInfo: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('admin-UserAuthenticationInfo'), {\r\n            idUser: params.idUser\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return Update User Authentication Info\r\n     */\r\n    updateUserAuthenticationInfo: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.create(self.serviceLocator.getUrl('admin-updateUserAuthenticationInfo'), {\r\n            idUser: params.idUser,\r\n            password: params.password,\r\n            enable: params.enable,\r\n            expired: params.expired,\r\n            locked: params.locked\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return generate Data To Send By Email\r\n     */\r\n    generateRandomPassword: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        params['action'] = 'generateRandomPassword';\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-generateRandomPassword'),\r\n            data: params,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return generate Data To Send By Email\r\n     */\r\n    generateDataToSendByEmail: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['action'] = 'GenerateDataToSendByEmail';\r\n        data['idUser'] = params.idUser;\r\n        data['password'] = params.password;\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-GenerateDataToSendByEmail'),\r\n            data: params,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return generate Send Mail\r\n     */\r\n    sendEmail: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['action'] = 'sendEmail';\r\n        data['emailTo'] = params.emailTo;\r\n        data['subject'] = params.subject;\r\n        data['body'] = params.body;\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-sendEmail'),\r\n            data: params,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return Applications, Categories or processes list\r\n     */\r\n    getApplicationCategoriesList: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = '';\r\n\r\n        if (params.action == 'Applications') {\r\n            url = 'admin-getApplicationList';\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(url),\r\n                type: 'GET',\r\n                dataType: 'json'\r\n            });\r\n        } else {\r\n            url = 'admin-getCategoriesList';\r\n            data.idApp = params.idApp;\r\n            data.idCategory = params.idCategory;\r\n            if (data.idCategory == '') {\r\n                data.idCategory = -1;\r\n            }\r\n\r\n            if (typeof (params.filterStartEvent) !== 'undefined') {\r\n                data.filterStartEvent = params.filterStartEvent;\r\n            }\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(url),\r\n                data: data,\r\n                type: 'GET',\r\n                dataType: 'json'\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Return the list of all cases that matched the filters\r\n     */\r\n    getAdminCasesList: function (params) {\r\n        var self = this;\r\n        var data = params || {};\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            //eliminar esto con el servicio restfull\r\n            cache: true,\r\n            url: self.serviceLocator.getUrl('admin-getCasesList'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     *   Return the application's processes\r\n     */\r\n    getApplicationProcesses: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getApplicationProcesses');\r\n\r\n        var data = {};\r\n\r\n        data['idApp'] = params['idApp'] ? params['idApp'] : -1;\r\n\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *   Return the application's processes\r\n     */\r\n    getProcessVersion: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getProcessVersion');\r\n\r\n        var data = {};\r\n\r\n        data['idWfClass'] = params['idWFClass'];\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *   Return the the workflow's versions task\r\n     */\r\n    getProcessTasks: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getProcessTasks');\r\n\r\n        var data = {};\r\n\r\n        data['idWfClass'] = params['idWFClass'];\r\n        data['version'] = params['version'] ? params['version'] : undefined;\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     * Retrieves the alarms from an specific task\r\n     */\r\n    getTaskAlarms: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getTaskAlarms');\r\n\r\n        var data = {};\r\n\r\n        data['idTask'] = params['idTask'];\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     * Retrieves each kind of alarm lapse\r\n     */\r\n    getLapseMode: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getLapseMode');\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     * Retrieves each kind of alarm recurrence\r\n     */\r\n    getRecurrMode: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getRecurrMode');\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n\r\n    /*\r\n     * Retrieves each kind of alarm recurrence\r\n     */\r\n    getScheduleType: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getScheduleType');\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     *   Retrieves the boss list\r\n     */\r\n    getBossList: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getBossList');\r\n        return $.read(url);\r\n    },\r\n\r\n    /**\r\n     *   Add a new alarm\r\n     */\r\n    addAlarm: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-addAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idTask'] = params['idTask'];\r\n        data['idRecurrMode'] = params['idRecurrMode'];\r\n        data['idLapseMode'] = params['idLapseMode'];\r\n        data['scheduleType'] = params['scheduleType'];\r\n        data['alarmTime'] = params['alarmTime'];\r\n        data['alarmRecurrTime'] = params['alarmRecurrTime'];\r\n        data['sendToCurrentAssignee'] = params['sendToCurrentAssignee'];\r\n\r\n        return $.update(url, data);\r\n        /*\r\n         return $.ajax({\r\n         url: self.serviceLocator.getUrl('admin-addAlarm'),\r\n         data: data,\r\n         type: 'PUT',\r\n         dataType: 'json'\r\n         });\r\n         */\r\n    },\r\n\r\n    /*\r\n     *   Edits an existin alarm\r\n     */\r\n    editAlarm: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-editAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idTask'] = params['idTask'];\r\n        data['idAlarm'] = params['idAlarm'];\r\n        data['idRecurrMode'] = params['idRecurrMode'];\r\n        data['idLapseMode'] = params['idLapseMode'];\r\n        data['scheduleType'] = params['scheduleType'];\r\n        data['alarmTime'] = params['alarmTime'];\r\n        data['alarmRecurrTime'] = params['alarmRecurrTime'];\r\n        data['sendToCurrentAssignee'] = params['sendToCurrentAssignee'];\r\n\r\n\r\n        return $.update(url, data);\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     *   Delete an alarm\r\n     */\r\n    deleteAlarm: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-deleteAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idAlarm'] = params['idAlarm'];\r\n\r\n        return $.destroy(url, params);\r\n\r\n    },\r\n\r\n    /*\r\n     * Returns the Alarm Recipients\r\n     * @param param: idAlarm : the alarm id to get the related recipients\r\n     */\r\n    getAlarmRecipients: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-alarmRecipients');\r\n\r\n        var data = {};\r\n\r\n        data['idAlarm'] = params['idAlarm'];\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     * Adds a new Alarm Recipient to the current alam\r\n     * @param param: idAlarm : the alarm id to get the related recipients\r\n     * @param param: idRecipient : the recipient id\r\n     */\r\n    addRecipientToAlarm: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-recipientToAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idAlarm'] = params['idAlarm'];\r\n        data['idRecipient'] = params['idRecipient'];\r\n\r\n        return $.update(url, data);\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Delete/s the alarm recipient/s from the current task\r\n     * @param param: idRecipient : the recipient id/s who is going to be deleted\r\n     */\r\n    deleteRecipientsFromAlarm: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-deleteAlarmRecipients');\r\n\r\n        var data = {};\r\n\r\n        data['idRecipients'] = params['idRecipients'];\r\n\r\n        return $.destroy(url, data);\r\n    },\r\n\r\n    /*\r\n     * Send the action to toggle the alarms state: enable or disable\r\n     * @param param: idTask : the task id who is going to be actvidated/deactivaded his alarms\r\n     */\r\n    enableAlarm: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-enableAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idTask'] = params['idTask'];\r\n\r\n        return $.create(url, data);\r\n    },\r\n\r\n    /*\r\n     * Invalidate or Reassign a set of cases\r\n     */\r\n    abortReassignItems: function (params) {\r\n        var self = this;\r\n        var data = params || {};\r\n        var url = params.action == 'abort' ? 'admin-abortItems' : 'admin-reassignItems';\r\n        // Call ajax and returns promise\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(url),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     * Services for Asynchronous Activities\r\n     */\r\n    asyncActivitiesServices: function (params) {\r\n        var self = this;\r\n        var data = params;\r\n        var url = '';\r\n        var type = 'GET';\r\n        if (params.action == 'getActivities') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-get-activities');\r\n        } else if (params.action == 'retryNow') {\r\n            type = 'POST';\r\n            url = self.serviceLocator.getUrl('admin-async-activities-get-retry-now');\r\n            url = url.replace('{idCase}', params.idCase);\r\n            url = url.replace('{idworkItem}', params.idWorkitem);\r\n            url = url.replace(\"{idAsynchWorkitem}\", params.idAsynchWorkitem);\r\n        } else if (params.action == 'getActivitiesByTask') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-get-activities-by-task');\r\n        } else if (params.action == 'enableExecution') {\r\n            type = 'POST';\r\n            url = self.serviceLocator.getUrl('admin-async-activities-enable-execution');\r\n        } else if (params.action == 'enableMultiple') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-enable-multiple');\r\n            type = 'POST';\r\n        } else if (params.action == 'asyncExecution') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-async-execution');\r\n        } else if (params.action == 'asyncExecutionLog') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-async-execution-log');\r\n            url = url.replace('{idCase}', params.idCase);\r\n            url = url.replace('{idworkItem}', params.idWorkItem);\r\n            url = url.replace(\"{idAsynchWorkitem}\", params.idAsynchWorkitem);\r\n        } else if (params.action == 'getAsyncExecution') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-async-get-current-execution-log');\r\n        }\r\n        // Call ajax and returns promise\r\n        var response = $.ajax({\r\n            url: url,\r\n            data: data,\r\n            type: type,\r\n            dataType: 'json'\r\n        });\r\n\r\n        return response;\r\n    },\r\n\r\n    /*\r\n     *  Return generate Default Assignation To all Process\r\n     */\r\n    getDefaultAssignationUserToAllProcess: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('admin-getDefaultAssignationUserToAllProcess'), {\r\n            serviceAction: 'getDefaultAssignationUserToAllProcess'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *  Return generate Default Assignation To Process\r\n     */\r\n    getDefaultAssignationUserToProcess: function (params) {\r\n        var self = this;\r\n        var process;\r\n        // Call ajax and returns promise\r\n        if (params.idWFClass == '') {\r\n            process = -1\r\n        } else {\r\n            process = params.idWfClass\r\n        }\r\n        return $.read(self.serviceLocator.getUrl('admin-getDefaultAssignationUserToProcess'), {\r\n            serviceAction: 'getDefaultAssignationUserToProcess',\r\n            process: process\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Return Assignation Process\r\n     */\r\n    setDefaultAssignationUserToProcess: function (params) {\r\n        var self = this;\r\n        if (params.idWFClass == '') {\r\n            process = -1\r\n        } else {\r\n            process = params.idWfClass\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.create(self.serviceLocator.getUrl('admin-setDefaultAssignationUserToProcess'), {\r\n            serviceAction: 'setDefaultAssignationUserToProcess',\r\n            process: process,\r\n            idUser: params.idUser\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get the icon of a given process\r\n     * @param params\r\n     */\r\n    getProcessIcon: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            processId: params.processId\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"process-getIcon\"),\r\n            data: data,\r\n            batchRequest: true\r\n        });\r\n    },\r\n    /**\r\n     * Get the icon of a given collection\r\n     * @param params\r\n     */\r\n    getCollectionIcon: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            collectionId: params.collectionId\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"collections-getIcon\"),\r\n            data: data,\r\n            batchRequest: true\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Returns the combo's data to Type Profiles depending of the params\r\n     */\r\n    getProfilesTypes: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('admin-getProfilesTypes'));\r\n    },\r\n\r\n    /*\r\n     *  Return generate Search Profiles\r\n     */\r\n    searchProfiles: function (params) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('admin-searchProfiles');\r\n        var data = {};\r\n        data['type'] = params['profileType'];\r\n        data['name'] = params['profileName'];\r\n\r\n        data[\"orgId\"] = params[\"orgId\"] ? params[\"orgId\"] : null;\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *  Return Users By Profiles\r\n     */\r\n    getUsersByProfile: function (params) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('admin-getUsersByProfile');\r\n        var data = {};\r\n        data['type'] = params['profileType'];\r\n        data['id'] = params['idProfile'];\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *  Remove User Profiles\r\n     */\r\n    removeUserFromProfile: function (params) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('admin-removeUserFromProfile');\r\n        var data = {};\r\n        data['type'] = params['profileType'];\r\n        data['id'] = params['idProfile'];\r\n        data['idUser'] = params['idUser'];\r\n\r\n        return $.destroy(url, data);\r\n    },\r\n\r\n    /*\r\n     *  Add Users Profiles\r\n     */\r\n    addUserToProfile: function (params) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('admin-addUserToProfile');\r\n        var data = {};\r\n        data['type'] = params['profileType'];\r\n        data['id'] = params['idProfile'];\r\n        data['idUser'] = params['idUser'];\r\n\r\n        return $.update(url, data);\r\n    },\r\n    /*\r\n     *  Display Licenses\r\n     */\r\n    licenses: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-Licenses');\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     *   Return Dimensions List\r\n     */\r\n    getDimensions: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-GetDimensions');\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     *   Edit Dimensions\r\n     */\r\n    editDimension: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['id'] = params.id;\r\n        data['displayName'] = params.displayName;\r\n        data['name'] = params.name;\r\n        data['idWfClass'] = params.idWfClass;\r\n        data['entityPath'] = params.entityPath;\r\n        data['description'] = params.description;\r\n        var url = self.serviceLocator.getUrl('admin-EditDimension');\r\n        // Call ajax and returns promise\r\n        return $.create(url, data);\r\n        /*return $.ajax({\r\n         url: self.serviceLocator.getUrl('admin-EditDimension'),\r\n         data: params,\r\n         type: 'POST',\r\n         dataType: 'json'\r\n         });*/\r\n    },\r\n\r\n    /*\r\n     *   Create Dimensions\r\n     */\r\n    createAdministrableDimension: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['displayName'] = params.displayName;\r\n        data['name'] = params.name;\r\n        data['idWfClass'] = params.idWfClass;\r\n        data['entityPath'] = params.entityPath;\r\n        data['Description'] = params.description;\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-CreateAdministrableDimension'),\r\n            data: params,\r\n            type: 'PUT',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Delete manageable dimensions\r\n     */\r\n    deleteDimension: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-DeleteDimension');\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['id'] = params.id;\r\n        data['idDimension'] = params.id;\r\n        data['administrable'] = params.administrable;\r\n        // Call ajax and returns promise\r\n        return $.destroy(url, data);\r\n    },\r\n\r\n    /*\r\n     *   Dimensions Process Tree\r\n     */\r\n    entityPathChildNodesAction: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['pathNodeType'] = params.nodeType;\r\n        data['idNode'] = params.idNode;\r\n        data['nodeDisplayPath'] = params.nodeDisplayPath;\r\n        data['nodePath'] = params.nodePath;\r\n        data['idWfClass'] = params.idWfClass;\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-EntityPathChildNodesAction'),\r\n            data: params,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return list of available processes\r\n     */\r\n    getActiveWFClasses: function (params) {\r\n        var self = this;\r\n        var data = params || {};\r\n\r\n        // Call ajax and returns promise\r\n\r\n        return $.ajax({\r\n            //eliminar esto con el servicio restfull\r\n            cache: true,\r\n            url: self.serviceLocator.getUrl('admin-GetActiveWFClasses'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Resturn the list of Stored Document Templates\r\n     */\r\n    storeDocumentTemplates: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-document-templates-storeDocumentTemplates');\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     * Restore an selected document template using his Guid as parameter\r\n     * @param params {Object} Guid: the associated Guid from the desired document template\r\n     */\r\n    restoreDocumentTemplates: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-document-templates-restoreDocumentTemplates');\r\n\r\n        url += '?Guid=' + params.Guid;\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     * Retreieves the workflow from the actual processes\r\n     */\r\n    getWorkFlowClasses: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-processes-workflowClasses');\r\n        return $.read(url);\r\n    },\r\n\r\n\r\n    /*\r\n     * Retreives the task from a desired workflow\r\n     * @param params {Object} idWorkFlow: the desired workflow id\r\n     */\r\n    getTaskByWorkFlow: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-processes-tasksByWorkflow');\r\n\r\n        var data = {};\r\n        data['idWorkflow'] = params.idWorkflow;\r\n\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     * Modifies the process durationworkflow\r\n     * @param params {Object} idWorkflow: the desired process id to modify\r\n     * @param params {Object} duration: the duracion, converted in minutes\r\n     */\r\n    modifyProcessDuration: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-processes-modifyProcessDuration');\r\n\r\n        var data = {};\r\n        data['idWorkflow'] = params.idWorkflow;\r\n        data['duration'] = params.duration;\r\n\r\n        return $.create(url, data);\r\n    },\r\n\r\n    /*\r\n     * Modifies the task duration form a desired workflow\r\n     * @param params {Object} idTask: the desired task id to modifie\r\n     * @param params {Object} duration: the duracion, converted in minutes\r\n     */\r\n    modifyTaskDuration: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-processes-modifyTaskDuration');\r\n\r\n        var data = {};\r\n        data['idTask'] = params.idTask;\r\n        data['duration'] = params.duration;\r\n\r\n        return $.create(url, data);\r\n    },\r\n\r\n    /*\r\n     * this retrive data for the report my team\r\n     */\r\n    getDataForMyTeam: function () {\r\n\r\n        var self = this;\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('bam-resourcemonitor-myteam'),\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Retrive data for reports\r\n     */\r\n    getReporstAnalysisQuery: function () {\r\n\r\n        var self = this;\r\n\r\n        return $.read(self.serviceLocator.getUrl('reports-analysisquery'));\r\n    },\r\n\r\n    /*\r\n     * Update report data\r\n     */\r\n    updateReportData: function (params) {\r\n\r\n        var self = this;\r\n\r\n        return $.update(self.serviceLocator.getUrl('reports-analysisquery-update'), params);\r\n    },\r\n\r\n    /*\r\n     * Delete report data\r\n     */\r\n    deleteReportData: function (params) {\r\n\r\n        var self = this;\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('reports-analysisquery-delete') + '?' + params);\r\n    },\r\n    /*\r\n     *Entrega la lista de idiomas soportados\r\n     */\r\n    getStoreLanguageTemplates: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-language-languages');\r\n        var data = {justActives: false};\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *Download template language list\r\n     */\r\n    getLanguageTemplate: function (params) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var url = self.serviceLocator.getUrl('admin-language-resource') + '?cultureName=' + params.cultureName;\r\n        defer.resolve('OK');\r\n        window.location.href = url;\r\n        /*\r\n         var response=  $.ajax({\r\n         type: 'GET',\r\n         url: url\r\n         });\r\n         response.always(function(response, status, xhr) {\r\n         if(response.responseText.indexOf('error') >= 0){\r\n         defer.reject('Download error');\r\n         }else{\r\n         defer.resolve('OK');\r\n         window.location.href=url;\r\n         }\r\n         });*/\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     * Process definition service for process viewer\r\n     */\r\n    processDefinition: function (params) {\r\n        var self = this;\r\n        return $.read(self.serviceLocator.getUrl('processviewer-processdefinition'), params);\r\n    },\r\n\r\n    /*\r\n     * Graphic info for process viewer\r\n     */\r\n    graphicInfo: function (params) {\r\n        var self = this;\r\n        return $.read(self.serviceLocator.getUrl('processviewer-processgraphicinfo'), params);\r\n    },\r\n\r\n    /**\r\n     * This service get the last version of BizagiBPM\r\n     *\r\n     * @return {json}\r\n     */\r\n    getLastUpdateByMobile: function () {\r\n        var self = this;\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"mobile-getLastUpdate\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getCollectionData: function (params) {\r\n        var self = this,\r\n            data = {},\r\n            url = self.serviceLocator.getUrl('templates-handler-getCollectionData');\r\n\r\n        data.idFact = params.idFact;\r\n        data.pag = params.page || 1;\r\n        data.pagSize = params.pageSize || 10;\r\n        data.filters = params.filters ? ((!Array.isArray(params.filters)) ? JSON.stringify(params.filters) : undefined) : undefined;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getVirtualCollectionData: function (params) {\r\n        var self = this,\r\n            data = {},\r\n            url = self.serviceLocator.getUrl('templates-handler-getVirtualCollectionData');\r\n\r\n        data.guidVirtualCollection = params.guidVirtualCollection;\r\n        data.pag = params.page || 1;\r\n        data.pagSize = params.pageSize || 10;\r\n        data.filters = params.filters ? ((!Array.isArray(params.filters)) ? JSON.stringify(params.filters) : undefined) : undefined;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getSearchData: function (params) {\r\n        var self = this;\r\n        // Call ajax and returns promise\r\n        var urlSend = self.serviceLocator.getUrl(\"my-search-getData\");\r\n        urlSend = urlSend.replace(\"{guidSearch}\", params.guidSearch);\r\n        var filters = params.filters || [];\r\n\r\n        var data = {\r\n            filters: JSON.stringify(filters),\r\n            pag: params.page || 1,\r\n            calculateFilters: params.calculateFilters || false,\r\n            pagSize: params.pageSize || 10\r\n        };\r\n        return $.read(urlSend, data).then(function (data) {\r\n            return self.serializeEntityData(data);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Return an array with the collections or entity related to stakeholder entities\r\n     * @param params\r\n     */\r\n    getCollectionEntityData: function (params) {\r\n        var self = this, url;\r\n        params = params || {};\r\n        var data = {\r\n            templateType: (params.referenceType === \"VIRTUAL\" || params.referenceType === \"FACT\") ? \"List\" : \"Content\",\r\n            surrogateKey: params.surrogateKey,\r\n            pag: params.page || 1,\r\n            pagSize: params.pageSize || 10,\r\n            defaultFilterApplied: params.defaultFilterApplied,\r\n            filters: JSON.stringify(params.filters)\r\n        };\r\n\r\n        // VIRTUAL\r\n        if (params.referenceType === \"VIRTUAL\") {\r\n            url = self.serviceLocator.getUrl('data-navigation-handler-collection');\r\n            data.reference = params.reference;\r\n        }\r\n        // ENTITY AND FACTS\r\n        else {\r\n            url = self.serviceLocator.getUrl('data-navigation-handler-entity');\r\n            data.reference = params.guidEntityCurrent;\r\n            data.xpath = params.xpath;\r\n            data.collectionId = params.reference;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data).then(function (response) {\r\n            return self.serializeEntityData(response);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     */\r\n    getFiltersEntityData: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var data = {\r\n            reference: params.guidEntityCurrent,\r\n            collectionId: params.reference,\r\n            surrogateKey: params.surrogateKey,\r\n            xpath: params.xpath,\r\n            templateType: \"List\",\r\n            defaultFilterApplied: params.defaultFilterApplied,\r\n            filters: JSON.stringify(params.filters)\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"data-navigation-handler-entity-filters\"),\r\n            data: data\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getProcessAddAction: function (params) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"action-handler-getProcessAddAction\");\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, params)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getMultipleActions: function (params) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"templates-handler-getMultipleActions\");\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, params)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getMapping: function (params) {\r\n        var self = this;\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"process-handler-getMapping\"),\r\n            data: params,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    getForm: function (data) {\r\n        var self = this;\r\n\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"process-handler-getForm\"),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Chek if an entity has startform\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    hasStartForm: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (params.guid) {\r\n            data.guidWFClass = params.guid;\r\n        }\r\n\r\n        return $.read(self.serviceLocator.getUrl(\"process-handler-startform\"), data);\r\n    },\r\n\r\n    /**\r\n     * Executes the action\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    executeAction: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            surrogateKey: JSON.stringify(params.surrogatedKey),\r\n            entityId: params.entityId,\r\n            ruleId: params.processId\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.create({\r\n            url: self.serviceLocator.getUrl(\"process-action-execute\"),\r\n            data: data\r\n        });\r\n    },\r\n\r\n    /**\r\n     * executes a rule\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    actionRule: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            surrogateKey: params.surrogateKey,\r\n            entityId: params.entityId,\r\n            ruleId: params.processId\r\n        }\r\n\r\n        return $.create({\r\n            url: self.serviceLocator.getUrl(\"process-handler-rule\"),\r\n            data: data,\r\n            batchRequest: false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get following cases\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getActivitiesData: function (params) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"process-handler-getActivitiesData\");\r\n        params = params || {};\r\n        var data = {\r\n            page: params.page || 1,\r\n            pagsize: params.pageSize || 10\r\n        };\r\n\r\n        if (typeof (params.idworkflow) !== \"undefined\" && params.idworkflow ||\r\n            typeof (params.idWorkflow) !== \"undefined\" && params.idWorkflow) {\r\n            data.idWorkflow = params.idworkflow || params.idWorkflow;\r\n        }\r\n        if (typeof params.idCase !== \"undefined\" && params.idCase) {\r\n            data.idCase = params.idCase;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data).then(function (response) {\r\n            return self.serializeEntityData(response);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Return an array with the collections related to stakeholder entities\r\n     */\r\n    getPendingsData: function (params) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"process-handler-getPendingsData\");\r\n        params = params || {};\r\n        var data = {\r\n            page: params.page || 1,\r\n            pagsize: params.pageSize || 10\r\n        };\r\n\r\n        if (typeof (params.idworkflow) !== \"undefined\" && params.idworkflow ||\r\n            typeof (params.idWorkflow) !== \"undefined\" && params.idWorkflow) {\r\n            data.idWorkflow = params.idworkflow || params.idWorkflow;\r\n        }\r\n        if (typeof params.idCase !== \"undefined\" && params.idCase) {\r\n            data.idCase = params.idCase;\r\n        }\r\n        if (typeof params.taskState !== \"undefined\" && params.taskState) {\r\n            data.taskState = params.taskState;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data).then(function (response) {\r\n            return self.serializeEntityData(response);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get actions\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getActionsData: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('entities-handler-getActions'),\r\n            data: params,\r\n            batchRequest: true\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get Users, assignees and events from cases\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getUsersAndEvents: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (params.idCases && params.idCases.length > 0) {\r\n            data.idCases = params.idCases.toString();\r\n        }\r\n\r\n        return $.read(self.serviceLocator.getUrl(\"entities-handler-getUsersAndEvents\"), data);\r\n    },\r\n\r\n    /**\r\n     * Get Users, assignees and events from cases\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getUsers: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            caseId: params.caseId\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"entities-handler-getUsers\"),\r\n            data: params,\r\n            batchRequest: true\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get Users, assignees and events from cases\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getEvents: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            caseId: params.caseId\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"entities-handler-getEvents\"),\r\n            data: params,\r\n            batchRequest: true\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get Users images\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getUsersImages: function (params, userIds) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"entities-handler-getUsersImages\");\r\n\r\n        if (userIds && userIds.length > 0) {\r\n            data.userIds = userIds.toString();\r\n        }\r\n\r\n        data.width = params.width;\r\n        data.height = params.height;\r\n        data.square = params.square;\r\n\r\n        var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\r\n        if (newUserServices) {\r\n            return $.ajax({\r\n                url: url, \r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        } else {    \r\n            return $.read({\r\n                url: url,\r\n                data: data,\r\n                dataType: \"json\"\r\n            });\r\n        }  \r\n    },\r\n\r\n    /**\r\n     * Get stakeholder shortCurts\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getShortCuts: function (params) {\r\n        var self = this,\r\n            data = {},\r\n            url = self.serviceLocator.getUrl(\"entities-handler-getShotCuts\");\r\n\r\n        if (typeof params.icon !== \"undefined\" && params.icon) {\r\n            data.icon = true;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /**\r\n     *   Returns the available list of searches\r\n     */\r\n    getSearchLists: function () {\r\n        var self = this;\r\n        return $.read(self.serviceLocator.getUrl(\"my-search-getSearchLists\"), {});\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     */\r\n    getIdCasesOfProcessEntities: function (params) {\r\n        params = params || {};\r\n        var self = this;\r\n        var ids = {\r\n            ids: JSON.stringify(params)\r\n        };\r\n\r\n        // TODO: Validate compatibility\r\n        if (bizagi.version.server.lessThanOrEqualsTo(\"11.0.0.2608\")) {\r\n            // Call ajax and returns promise\r\n            return $.read({\r\n                url: self.serviceLocator.getUrl(\"process-handler-getIdCasesOfProcessEntities\"),\r\n                data: ids\r\n            });\r\n\r\n        }else{\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"process-handler-getIdCasesOfProcessEntities\"),\r\n                data: ids,\r\n                type: \"POST\"\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Retuns query form to searches\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getQueryForm: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"query-handler-getQueryForm\"),\r\n            data: params,\r\n            type: \"POST\",\r\n            dataType: params.dataType || \"json\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns an object with the filter to send to the server\r\n     * @param params\r\n     * @param filterObject\r\n     * @param callback is called when a filter is added to the array\r\n     */\r\n    defineFilterObject: function (params, filterObject, callback) {\r\n        var properties = params.properties;\r\n        var xpath = properties.xpath.split('@')[0];\r\n\r\n        var filter = filterObject.find(function (el) {\r\n            return el.xpath == xpath;\r\n        });\r\n\r\n        //if the control exists is because it is a range\r\n        if (filter) {\r\n            if (properties.rangeQuery == \"from\") {\r\n                filter.value = filter.value || {};\r\n                filter.searchType = 'range';\r\n                filter.value.min = params.value;\r\n            }\r\n            else if (properties.rangeQuery == \"to\") {\r\n                filter.value = filter.value || {};\r\n                filter.searchType = 'range';\r\n                filter.value.max = params.value;\r\n            }\r\n            else {\r\n                params.properties.typeSearch = filter.searchType;\r\n                var values = setValues(params);\r\n                $.extend(filter, values);\r\n            }\r\n\r\n            if (properties.orderType) {\r\n                filter.orderType = properties.orderType;\r\n            }\r\n            if (callback) {\r\n                callback(bizagi.clone(filter));\r\n            }\r\n        }\r\n        else {\r\n            var isDefaultFilter = properties.defaultFilter || false;\r\n            filter = setValues(params);\r\n\r\n            if (properties.orderType) {\r\n                filter.orderType = properties.orderType;\r\n            }\r\n\r\n            if (typeof filter.value != 'undefined' || filter.orderType || isDefaultFilter) {\r\n                filterObject.push(filter);\r\n                if (callback) {\r\n                    callback(bizagi.clone(filter));\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        function setValues(params) {\r\n            var properties = params.properties;\r\n            var searchType = properties.typeSearch;\r\n            var value = params.value;\r\n\r\n            //Identifing the type control in order to define search type\r\n            if (properties.type == \"boolean\") {\r\n                if (value.toLowerCase() === \"null\") {\r\n                    value = null;\r\n                    searchType = \"Nullable\"\r\n                }\r\n                else {\r\n                    value = bizagi.util.parseBoolean(value);\r\n                    searchType = \"exact\"\r\n                }\r\n            }\r\n\r\n            if (properties.type == \"number\" || properties.type == \"money\" || properties.type == \"date\") {\r\n                searchType = \"exact\"\r\n            }\r\n\r\n            if (typeof params.value == 'object') {\r\n                value = [];\r\n                if (Array.isArray(params.value)) {\r\n                    for (var i = 0, len = params.value.length; i < len; i++) {\r\n                        var val = parseInt(params.value[i].id);\r\n                        if (!isNaN(val)) {\r\n                            value.push(val);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    var val = parseInt(params.value.id);\r\n                    if (!isNaN(val)) {\r\n                        value.push(val);\r\n                    }\r\n                }\r\n                searchType = \"exact\";\r\n                value = value.length > 0 ? value : undefined;\r\n            }\r\n\r\n            if (properties.rangeQuery && properties.rangeQuery !== \"none\") {\r\n                value = {\r\n                    min: params.value,\r\n                    max: params.value\r\n                };\r\n                searchType = \"range\";\r\n            }\r\n\r\n            searchType = searchType || \"approx\";\r\n\r\n            var filter = {\r\n                xpath: xpath,\r\n                searchType: searchType\r\n            };\r\n\r\n            if (typeof value !== 'undefined') {\r\n                filter.value = value;\r\n            }\r\n\r\n            return filter;\r\n        }\r\n    },\r\n\r\n    /*PLAN*/\r\n    getPlan: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-get\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getActivities: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-activities\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    updatePlan: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-update\");\r\n        return $.update({\r\n            url: url.replace(\"{idPlan}\", params.id),\r\n            data: JSON.stringify(params),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    putExecutePlan: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-execute\");\r\n\r\n        return $.create({\r\n            url: url,\r\n            data: params,\r\n            contentType: \"application/x-www-form-urlencoded\"\r\n        });\r\n    },\r\n\r\n    deletePlan: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-delete\");\r\n\r\n        return $.destroy({\r\n            url: url.replace(\"{idPlan}\", params.id),\r\n            data: params,\r\n            contentType: \"application/x-www-form-urlencoded\"\r\n        });\r\n    },\r\n\r\n    closePlan: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-close\");\r\n\r\n        return $.create({\r\n            url: url,\r\n            data: params,\r\n            contentType: \"application/x-www-form-urlencoded\"\r\n        });\r\n    },\r\n\r\n    getWorkitemsPlan: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-workitems\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getTransitionsByPlan: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-transitions-get\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    editActivityPlan: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (params.activity) {\r\n            data = params.activity;\r\n            data.items = params.items;\r\n        } else {\r\n            data = params;\r\n        }\r\n\r\n        var url = self.serviceLocator.getUrl(\"project-plan-activity-edit\").replace(\"{idPlan}\", data.idPlan).replace(\"{id}\", data.id);\r\n\r\n        return $.update({\r\n            url: url,\r\n            data: JSON.stringify(data),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getPlanByParent: function (data) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-get-by-parent\");\r\n        var def = $.Deferred();\r\n\r\n        $.when($.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        })).done(function (response) {\r\n            def.resolve(response);\r\n        });\r\n\r\n        return def.promise();\r\n\r\n    },\r\n\r\n    getItemsByActivity: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-activity-tasks-get\");\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getPlanParent: function (data) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"project-plan-parent\");\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\"\r\n        });\r\n    },\r\n    /**\r\n     * Serializador de servicio de entitiData\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    serializeEntityData: function (data) {\r\n        var serializedData = data;\r\n        serializedData.entities = [];\r\n\r\n        /**\r\n         * build the return object.\r\n         * @param header\r\n         * @param row\r\n         * @returns {{data: {}, guid: *, surrogateKey: *, timestamp: *}}\r\n         * @private\r\n         */\r\n        function _buildNewObject(header, row) {\r\n            var newObject = {\r\n                    data: {},\r\n                    guid: row.guidEntity,\r\n                    timestamp: header.timestamp\r\n                },\r\n                columns = header.columns,\r\n                rowData = row.row;\r\n\r\n            for (name in row) {\r\n                if (row.hasOwnProperty(name) && name.toString() !== \"row\" && name.toString() !== \"id\") {\r\n                    newObject[name] = row[name];\r\n                }\r\n            }\r\n\r\n            for (var i = 0, len = columns.length; i < len; i += 1) {\r\n                newObject.data[columns[i]] = rowData[i];\r\n            }\r\n\r\n            return newObject;\r\n        };\r\n\r\n        var k = -1, kRow;\r\n        while (kRow = data.rows[++k]) {\r\n            var i = -1, iCell;\r\n            while (iCell = data.cells[++i]) {\r\n                if (iCell.id === kRow.id) {\r\n                    var kReturnObject = _buildNewObject(iCell, kRow);\r\n                    serializedData.entities.push(kReturnObject);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return serializedData;\r\n    },\r\n\r\n  \r\n});","\r\n/**\r\n* Routing service\r\n*\r\n* @author Edward J Morales\r\n* @description This class has been created based on jira story DRAGON-4943\r\n*/\r\n\r\n$.Class.extend(\"bizagi.workportal.services.routing\",\r\n{\r\n    BIZAGI_WORKPORTAL_WIDGET_START_FORM: \"startForm\"\r\n},\r\n{\r\n    /**\r\n    * Main method\r\n    *\r\n    * @param params <object> json with parameters to route\r\n    * @return object deferred\r\n    */\r\n    init: function (args) {\r\n        var self = this;\r\n        args = args || {};\r\n        self.params = args.params || {};\r\n        self.dataService = args.dataService || {};\r\n        self.modules = {\r\n            render: \"activityform\",\r\n            oldRender: \"oldrenderintegration\",\r\n            async: \"async\",\r\n            activitySelector: \"routing\"\r\n        };\r\n\r\n        // By default render version is Bizagi GO\r\n        self.renderVersion = 2;\r\n\r\n        self.resetRouteInformation();\r\n    },\r\n\r\n    resetRouteInformation: function () {\r\n        var self = this;\r\n        self.route = {\r\n            module: \"\", // Name of module to route\r\n            moduleParams: {} // parameters of module\r\n        };\r\n    },\r\n\r\n    setRenderParams: function (params) {\r\n        var self = this;\r\n        self.params = self.getRenderParams(params);\r\n    },\r\n\r\n    /**\r\n    * Parse a format incoming parameters\r\n    * @param params object\r\n    * @return object json with render parameters\r\n    */\r\n    getRenderParams: function (params) {\r\n        var self = this;\r\n\r\n        var renderParams = {\r\n            idCase: parseInt(params.idCase || 0),\r\n            idWorkflow: parseInt(params.idWorkflow || 0),\r\n            idWorkitem: params.idWorkitem || params.idWorkItem || 0,\r\n            idTask: parseInt(params.idTask || 0),\r\n            eventAsTasks: params.eventAsTasks || false,\r\n            onlyUserWorkItems: params.onlyUserWorkItems || \"true\",\r\n            formsRenderVersion: params.formsRenderVersion || 0,\r\n            referrer: params.referrer || \"\",\r\n            isComplex: (params.isComplex !== undefined) ? true : false,\r\n            formsRenderVersion: 2,\r\n            onClose: params.onClose || \"\",\r\n            isOfflineForm: params.isOfflineForm || false,\r\n            radNumber: params.radNumber || null\r\n        };\r\n\r\n        var skipSubprocessGlobalForm = true;\r\n        try {\r\n            skipSubprocessGlobalForm = BIZAGI_SETTINGS[\"skipSubprocessGlobalForm\"] || true;\r\n        } catch (e) {\r\n        }\r\n\r\n        self.skipSubprocessGlobalForm = (skipSubprocessGlobalForm == \"true\");\r\n\r\n        return renderParams;\r\n    },\r\n    /**\r\n    * Define the next route to take\r\n    * @param params object\r\n    * @return deferred with specific path\r\n    */\r\n    getRoute: function (params) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Params Override\r\n        self.params = (params) ? params : self.params;\r\n\r\n        var fromTask = params.fromTask || params.idTask || \"\";\r\n        var fromWorkItemId = params.fromWorkItemId || params.idWorkitem || params.idWorkItem || \"\";\r\n\r\n        /**\r\n        * Get form version\r\n        */\r\n        $.when(self.getRenderVersion(self.params))\r\n            .done(function (renderVersion) {\r\n                self.renderVersion = renderVersion;\r\n                self.route.moduleParams = self.getRenderParams(self.params);\r\n\r\n                // Looking for workitems\r\n                $.when(self.dataService.getWorkitems({\r\n                    idCase: self.params.idCase,\r\n                    onlyUserWorkItems: self.params.onlyUserWorkItems,\r\n                    isOfflineForm: self.params.isOfflineForm,\r\n                    fromTask: fromTask,\r\n                    fromWorkItemId: fromWorkItemId\r\n                })).done(function (getWorkItems) {\r\n                    var workItems = getWorkItems.workItems.length;\r\n\r\n                    /**\r\n                    * If routing has been called with idCase and idWorkitem\r\n                    * then go to the render\r\n                    */\r\n                    self.route.moduleParams.hasWorkItems = workItems ? true : false;\r\n                    self.route.moduleParams.isEvent = self.params.isEvent || false;\r\n                    self.route.moduleParams.hasGlobalForm = bizagi.util.parseBoolean(getWorkItems.hasGlobalForm);\r\n\r\n                    if (self.route.moduleParams.idWorkitem > 0) {\r\n                        self.setRenderModuleName(self.getRenderModuleName(renderVersion));\r\n\r\n                        if (self.route.moduleParams.idTask === 0) {\r\n                            // Try to found idTask\r\n                            self.route.moduleParams.idTask = self.searchIdTask(self.route.moduleParams.idWorkitem);\r\n                        }\r\n\r\n                        // We have enough information to instance the render\r\n                        self.route.moduleParams.radNumber = getWorkItems.radNumber || \"\";\r\n                        self.route.moduleParams.idWorkflow = getWorkItems.idWorkFlow || \"\";\r\n\r\n                        if (!self.route.moduleParams.displayName && !self.params.displayName) {\r\n                            var item = getWorkItems.workItems.find(function (el) {\r\n                                return Number(el.idWorkItem) === Number(self.route.moduleParams.idWorkitem);\r\n                            })\r\n\r\n                            if (typeof item !== \"undefined\" && item.displayName) {\r\n                                self.route.moduleParams.displayName = item.displayName;\r\n                            }\r\n                        }\r\n\r\n                        // Resolve the promise\r\n                        def.resolve(self.route);\r\n                        self.resetRouteInformation();\r\n                    } else {\r\n\r\n                        var listAsyncWorkItems = self.checkAsyncWorkItems(getWorkItems);\r\n\r\n                        // Check if case has workItems\r\n                        if (workItems === 0) {\r\n\r\n                            self.route.moduleParams.idWorkflow = getWorkItems.idWorkFlow || \"\";\r\n                            self.route.moduleParams.radNumber = getWorkItems.radNumber || \"\";\r\n\r\n                            if ($.trim(getWorkItems.msgTask) !== \"\") {\r\n                                def.resolve(self.routeToMessageForm(getWorkItems.msgTask));\r\n                            } else if (bizagi.util.parseBoolean(getWorkItems.hasGlobalForm)) {\r\n                                // hasn't work items, show global form\r\n                                // Resolve route -> Global Form\r\n                                self.route.moduleParams.displayName = null;\r\n                                def.resolve(self.routeToGlobalForm(getWorkItems));\r\n                            } else {\r\n                                // Resolve route -> Global form without data\r\n                                def.resolve(self.routeToGlobalFormWithoutData());\r\n                            }\r\n                        } else if (workItems === 1 || listAsyncWorkItems.length > 0) {\r\n                            // it has one workItem\r\n                            // Check if it is asyncronous activity\r\n                            var workItemIndex = 0;\r\n                            if (listAsyncWorkItems.length > 0) {\r\n                                for (var workitemCounter = 0; workitemCounter < workItems; workitemCounter++) {\r\n\r\n                                    if (getWorkItems.workItems[workitemCounter].isAsynch == \"true\") {\r\n                                        workItemIndex = workitemCounter;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            // Change idCase\r\n                            self.route.moduleParams.idCase = getWorkItems.workItems[workItemIndex].idCase;\r\n                            self.route.moduleParams.idTask = getWorkItems.workItems[workItemIndex].idTask;\r\n                            self.route.moduleParams.fromTask = getWorkItems.workItems[workItemIndex].idTask;\r\n                            self.route.moduleParams.idWorkitem = getWorkItems.workItems[workItemIndex].idWorkItem;\r\n                            self.route.moduleParams.idWorkflow = getWorkItems.workItems[workItemIndex].idWorkFlow;\r\n                            self.route.moduleParams.displayName = getWorkItems.workItems[workItemIndex].displayName\r\n                                ? getWorkItems.workItems[workItemIndex].displayName : \"\";\r\n                            self.route.moduleParams.radNumber = getWorkItems.radNumber || \"\";\r\n\r\n                            if (listAsyncWorkItems.length > 0) {\r\n                                // Resolve asynchronous activity\r\n                                self.setRenderModuleName(self.modules.async);\r\n                            } else {\r\n                                // Resolve render\r\n                                self.setRenderModuleName(self.getRenderModuleName(renderVersion));\r\n                            }\r\n\r\n                            def.resolve(self.route);\r\n                            self.resetRouteInformation();\r\n                        } else {\r\n\r\n                            // it has many workItems or subprocess\r\n                            // show routing window\r\n                            getWorkItems.checkProcess = getWorkItems.subProcesses.length > 0\r\n                                && self.skipSubprocessGlobalForm ? true : false;\r\n                            getWorkItems.checkWorkItems = workItems > 1 ? true : false;\r\n\r\n                            getWorkItems[\"fromSearchWidget\"] = self.params.referrer == \"search\" ? true : false;\r\n                            self.setRenderModuleName(self.modules.activitySelector);\r\n                            self.route.moduleParams.data = getWorkItems;\r\n\r\n                            def.resolve(self.route);\r\n                            self.resetRouteInformation();\r\n                        }\r\n                    }\r\n                }).fail(function (error) {\r\n                    var msgTask = bizagi.localization.getResource(\"workportal-menu-search-found-no-cases\");\r\n                    def.resolve(self.routeToMessageForm(msgTask));\r\n                });\r\n        }).fail(function (xhr, errorType, message) {\r\n            def.reject();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n    * Set name of module to instance\r\n    * @param renderName\r\n    */\r\n    setRenderModuleName: function (renderName) {\r\n        var self = this;\r\n\r\n        self.route.module = renderName;\r\n        self.route.moduleParams.widgetName = renderName;\r\n    },\r\n    /**\r\n    * Get render module\r\n    * @param renderVersion integer 1 || 2\r\n    * @returns boolean\r\n    */\r\n    getRenderModuleName: function (renderVersion) {\r\n        var self = this;\r\n        return (renderVersion == 1) ? self.modules.oldRender : self.modules.render;\r\n    },\r\n    /**\r\n    * Search idTask from workItems object\r\n    * @return {number} idTask\r\n    * @param workItemsList\r\n    * @param workItemToSearch\r\n    */\r\n    searchIdTask: function (workItemsList, workItemToSearch) {\r\n        var idTask = 0;\r\n        workItemsList = workItemsList || [];\r\n\r\n        for (var i = 0, length = workItemsList.length; i < length; i++) {\r\n            //search idTask\r\n            if (parseInt(workItemsList[i][\"idWorkItem\"]) == parseInt(workItemToSearch)) {\r\n                idTask = parseInt(workItemsList[i][\"idTask\"]);\r\n                break;\r\n            }\r\n        }\r\n        return idTask;\r\n    },\r\n\r\n    /**\r\n    * Check if workitems has asynchronous activities\r\n    * @param data\r\n    * @returns {Array}\r\n    */\r\n    checkAsyncWorkItems: function (data) {\r\n        var result = [];\r\n\r\n        $.each(data[\"workItems\"], function (key) {\r\n            if (data[\"workItems\"][key][\"isAsynch\"] == \"true\") {\r\n                result.push({\r\n                    idCase: data[\"idCase\"],\r\n                    idWorkitem: data.workItems[key].idWorkItem,\r\n                    idTask: data.workItems[key].idTask\r\n                });\r\n            }\r\n        });\r\n        return result;\r\n    },\r\n\r\n\r\n    /**\r\n    * Resolve global form route\r\n    * @param getWorkitems\r\n    * @returns {{module: string, moduleParams: {}}|*}\r\n    */\r\n    routeToGlobalForm: function (getWorkitems) {\r\n        var self = this;\r\n\r\n        // Override idCase and idWorkflow\r\n        self.route.moduleParams.idCase = ($.isNumeric(getWorkitems.idCaseForGlobalForm) && getWorkitems\r\n                .idCaseForGlobalForm > 0)\r\n            ? getWorkitems.idCaseForGlobalForm : self.route.moduleParams.idCase;\r\n\r\n        self.route.moduleParams.idWorkflow = parseInt(getWorkitems.idWorkFlow || 0);\r\n\r\n        if (self.renderVersion == 1) {\r\n            // Old render\r\n            var urlTemplate = self.dataService.serviceLocator.getUrl(\"old-render\") +\r\n                \"?PostBack=1&idCase=%s&idWorkitem=%s&idTask=%s\";\r\n            var idCase = self.route.moduleParams.idCase || \"\";\r\n            var idWorkitem = self.route.moduleParams.idWorkitem || \"\";\r\n            var idTask = self.route.moduleParams.idTask || \"\";\r\n            var url = printf(urlTemplate, idCase, idWorkitem, idTask);\r\n\r\n            self.route.moduleParams.onlyUserWorkItems = self.route.moduleParams.idCase || \"\";\r\n\r\n            self.setRenderModuleName(self.modules.oldRender);\r\n            self.route.moduleParams.url = url;\r\n        } else {\r\n            // Bizagi\r\n            self.setRenderModuleName(self.modules.render);\r\n        }\r\n\r\n        return self.route;\r\n    },\r\n    /**\r\n    * Resolve global form\r\n    * @returns {{module: string, moduleParams: {}}|*}\r\n    */\r\n    routeToGlobalFormWithoutData: function () {\r\n        var self = this;\r\n\r\n        self.setRenderModuleName(self.modules.render);\r\n        self.route.moduleParams.withOutGlobalForm = true;\r\n\r\n        return self.route;\r\n    },\r\n\r\n    /**\r\n    * Resolve Render with personalized message\r\n    * @param message\r\n    * @returns {{module: string, moduleParams: {}}|*|bizagi.workportal.services.routing.route}\r\n    */\r\n    routeToMessageForm: function (message) {\r\n        var self = this;\r\n        message = message || \"\";\r\n\r\n        self.setRenderModuleName(self.modules.render);\r\n        self.route.moduleParams.withOutGlobalForm = true;\r\n        self.route.moduleParams.messageForm = message;\r\n\r\n        return self.route;\r\n    },\r\n\r\n    /**\r\n    * Return the forms render version from parameters or service\r\n    * @param params object\r\n    * @returns {integer}\r\n    */\r\n    getRenderVersion: function (params) {\r\n        var self = this, defer = new $.Deferred();\r\n\r\n        // Try get from parameters\r\n        var formsVersion = params.formsRenderVersion || 0;\r\n        if (formsVersion != 0) {\r\n            // Response from parameters\r\n            defer.resolve(formsVersion);\r\n        } else {\r\n\r\n            // Get from service\r\n            $.when(self.dataService.getCaseFormsRenderVersion({\r\n                idCase: params.idCase\r\n            })).done(function (data) {\r\n                formsVersion = parseInt(data.formsRenderVersion);\r\n                defer.resolve(formsVersion);\r\n            }).fail(function (xhr, errorType, message) {\r\n                defer.reject();\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    }\r\n});","/**\r\n *   Name: BizAgi Mashups SDK\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will process a mashups page using a device factory to use the adequate rendering\r\n *       to create the layout\r\n */\r\n\r\n/**\r\n * Creates a new facade object to interact with all Bizagi's SDK capabilities.\r\n * @module facade\r\n * @class bizagi.mashup.facade\r\n * @summary\r\n * Creates an interaction facade instance 'new bizagi.mashup.facade(config)'\r\n * @param {object}   config                         Object configuration parameters.\r\n * @param {object}   [config.authentication={}]     Object for authentication configuration parameters.\r\n * @param {string}   [config.authentication.type=\"OAuth\"]    Currently supported: \"OAuth\" | \"Bizagi\".\r\n * @param {callback} [config.authentication.refreshTokenCallback] Function callable on every refresh token needed for the App, just optional for\r\n * Bizagi's authentication, in OAUth authentication is required in order to keep synchronized the access token.\r\n * @param {boolean} [config.authentication.autologin=true] Only will have effect for OAuth authentication, and indicates the Bizagi's SDK will try to\r\n * login the user again when the se session is lost.\r\n * @param {callback} [config.onError]               Event callback indicating errors in the App, (e) shows the detailed error.\r\n * @param {callback} [config.onClose]               Event callback indicating the user wants to go back (from the internal header).\r\n * @param {callback} [config.onRenderAction]        Event callback indicating actions performed in the form.\r\n *      actions [\"validate, \"refresh\", \"submitOnChange\", \"next\", \"routing\", \"release\"];\r\n *      {@linkcode validate->} Indicating the form performed the modeled validations, for instance:  required fields, valid ranges,.. etc.\r\n *      {@linkcode refresh->} Indicating the form performed a repaint.\r\n *      {@linkcode submitOnChange->} Indicating the form did save the new data.\r\n *      {@linkcode next->} Indicating the form performed a request to advance the activity.\r\n *      {@linkcode routing->} Indicating the form try to perform a routing to the activity it must show.\r\n *      {@linkcode release->} the form indicates, that the current user has released the current activity.\r\n * @param {string}   [config.proxyPrefix='']       URL prefix for the render services.\r\n * @param {boolean}  [config.showHeader=false]     Flag to define if the component must shows the internal header at the beginning\r\n * @example\r\n *  const mashup = new bizagi.mashup.facade({\r\n *      proxyPrefix: \"http://myhost.com/for/services\",\r\n *      authentication: {\r\n *          type: \"OAuth\",\r\n *          refreshTokenCallback: function (successCallback, errorCallback) { ... }\r\n *      },\r\n *      onClose: function () {},\r\n *      onError: function(e){console.log(\"error\", e);},\r\n *      onRenderAction: function(e){console.log(\"actions\", e);},\r\n *      showHeader: true\r\n *  });\r\n *\r\n */\r\n$.Class.extend(\"bizagi.mashup.facade\", {},\r\n    /** @lends bizagi.mashup.facade.prototype */\r\n    {\r\n        init: function (config) {\r\n            // Set default config\r\n\r\n            bizagi.loading.start();\r\n            this.initialized = false;\r\n            this.defaultParams = config || {};\r\n            this.defaultParams.authentication = this.defaultParams.authentication || {};\r\n            this.defaultParams.authentication.type = this.defaultParams.authentication.type || \"OAuth\";\r\n\r\n            // Defines a device factory for all rendering\r\n            this.deviceFactory = new bizagi.mashup.device.factory(this, config);\r\n\r\n            // Creates a data service instance\r\n            this.dataService = new bizagi.workportal.services.service(config);\r\n\r\n            // Creates authentication instance\r\n            switch (this.defaultParams.authentication.type) {\r\n                case \"OAuth\":\r\n                    this.authenticator = new bizagi.mashup.authentication.oauth(this, this.defaultParams.authentication);\r\n                    break;\r\n                case \"Basic\":\r\n                    this.authenticator = new bizagi.mashup.authentication.basic(this, this.defaultParams.authentication);\r\n                    break;\r\n                default:\r\n                    this.authenticator = new bizagi.mashup.authentication.bizagi(this, this.defaultParams.authentication);\r\n                    break;\r\n            }\r\n\r\n            // Create instance of routing service\r\n            this.dataService.routing = new bizagi.workportal.services.routing({dataService: this.dataService});\r\n\r\n            this.execute().then(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Start point method to use in the main javascript pages.\r\n         * This method will process everything and attach the HTML directly to the DOM.\r\n         * @summary Start the execution.\r\n         * @ignore\r\n         * @private\r\n         * @access private\r\n         */\r\n        execute: function () {\r\n            var self = this;\r\n            var canvas = self.defaultParams.canvas || $(\"body\");\r\n\r\n            if (self.initialized) {\r\n                return self.ready();\r\n            }\r\n            // Creates ready deferred\r\n            self.executionDeferred = new $.Deferred();\r\n\r\n            // Create a workportal facade\r\n            this.deviceFacade = self.deviceFactory.getMashupFacade(self.dataService);\r\n\r\n            // Set callback when requests have been done\r\n            return this.deviceFacade.then(function (mashupFacade) {\r\n                // Creates workportal component\r\n                self.mashupFacade = mashupFacade;\r\n\r\n                // Get main controller\r\n                self.controller = mashupFacade.getMainController({\r\n                    canvas: canvas,\r\n                    layoutHeader: self.defaultParams.showHeader || false\r\n                });\r\n\r\n                // Render the full content\r\n                return self.controller.render().then(function () {\r\n\r\n                    //Resolves promise\r\n                    self.initialized = true;\r\n                    self.executionDeferred.resolve();\r\n\r\n                });\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Returns the execution deferred to determine whether the component is ready or not.\r\n         * @summary Whether or not the component is ready.\r\n         * @public\r\n         * @returns {object} Promise\r\n         */\r\n        ready: function () {\r\n            return this.executionDeferred.promise();\r\n        },\r\n\r\n        /**\r\n         * Navigates to the desired view identified by \"id\" with a \"transition\".\r\n         * @summary View a specific element.\r\n         * @private\r\n         * @param {int|string} id       The viewId to navigate to, usually a render.\r\n         * @param {string} transition   The animation type for transitions like: slide, zoom, overlay, ...\r\n         * @ignore\r\n         * @example\r\n         * mashup.navigate(10001, 'slide:up');\r\n         */\r\n        navigate: function (id, transition) {\r\n            var self = this;\r\n            $.when(self.executionDeferred).then(function () {\r\n                self.mashupFacade.navigate(id, transition, true);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Generates the visual elements for the requested case.\r\n         * @summary View case.\r\n         * @public\r\n         * @param {object}  params              Object parameters\r\n         * @param {int}     params.idCase       Case identifier.\r\n         * @param {int}     params.idworkitem   WorkItem identifier.\r\n         * @example\r\n         * mashup.renderCase({\"idCase\": 110});\r\n         * @example\r\n         * mashup.renderCase({\"idCase\": 110, idWorkitem: 120});\r\n         */\r\n        renderCase: function (params) {\r\n            var self = this;\r\n            //if (typeof self.authenticator.getUser() !== \"undefined\") {\r\n                self.ready().then(function () {\r\n                    if (typeof self.controller !== \"undefined\") {\r\n                        self.controller.publish(\"renderCase\", params);\r\n                        self.navigate(\"#render\");\r\n\r\n                        if (typeof self.defaultParams.onRender == \"function\") {\r\n                            self.defaultParams.onRender.apply(this, arguments);\r\n                        }\r\n\r\n                    } else {\r\n                        bizagi.log(\"Sorry we're not ready yet, please try again\");\r\n                    }\r\n                });\r\n            /*} else {\r\n                if (typeof self.defaultParams.onError === \"function\") {\r\n                    self.defaultParams.onError(\"You must log in to complete the action\");\r\n                }\r\n            }*/\r\n        },\r\n\r\n        /**\r\n         * By default Bizagi's SDK deliver a an integrated header in the rendered view\r\n         * @summary Hides the default view header\r\n         * @public\r\n         * @example\r\n         * mashup.hideInternalHeader();\r\n         */\r\n        hideInternalHeader: function () {\r\n            var self = this;\r\n            self.ready().then(function () {\r\n                if (typeof self.controller !== \"undefined\") {\r\n                    self.controller.publish(\"toggleHeader\", {showHeader: false});\r\n                } else {\r\n                    bizagi.log(\"Sorry we're not ready yet, please try again\");\r\n                }\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Ends the session of the authenticated user.\r\n         * @summary close the user's session\r\n         * @public\r\n         * @example\r\n         * mashup.logoutUser();\r\n         */\r\n        logoutUser: function () {\r\n            var self = this;\r\n            if (typeof self.authenticator.getUser() !== \"undefined\") {\r\n                self.authenticator.logout();\r\n            } else {\r\n                console.log(\"there's not a user authenticated\");\r\n            }\r\n        },\r\n\r\n        /**\r\n         * By default Bizagi's SDK deliver a an integrated header in the rendered view\r\n         * @summary Shows the default view header.\r\n         * @public\r\n         * @example\r\n         * mashup.showInternalHeader();\r\n         */\r\n        showInternalHeader: function () {\r\n            var self = this;\r\n            self.ready().then(function () {\r\n                if (typeof self.controller !== \"undefined\") {\r\n                    self.controller.publish(\"toggleHeader\", {showHeader: true});\r\n                } else {\r\n                    bizagi.log(\"Sorry we're not ready yet, please try again\");\r\n                }\r\n            });\r\n        },\r\n\r\n        /**\r\n         * This method tries to get user access to Bizagi using the authentication credentials passed as arguments.\r\n         * Depending on the actual method/type of authentication it will use different properties of the \"auth\" object.\r\n         * @public\r\n         * @summary\r\n         * Authenticates the user\r\n         * @param {object} auth                 Object parameters.\r\n         *\r\n         * @param {string} auth.user            Username or email (Bizagi Auth Only)\r\n         * @param {string} auth.password        User's password (Bizagi Auth Only)\r\n         * @param {string} auth.domain          User's domain when needed (Bizagi Auth Only)\r\n         *\r\n         * @param {string} auth.accessToken     User's OAuth access token (OAuth Only)\r\n\r\n         * @returns {promise}                    Returns a promise with user's data.\r\n         * @example <caption>Authentication sample returning user's data</caption>\r\n         * mashup.authenticateUser({\r\n         *  accessToken: access_token\r\n         *  }).then(function(user){...});\r\n         * // OR\r\n         * mashup.authenticateUser({\r\n         *  user: 'user1',\r\n         *  password: '1234',\r\n         *  domain: 'domain'\r\n         * }).then(function(user){...});\r\n         **/\r\n        authenticateUser: function (auth) {\r\n            return this.authenticator.authenticateUser(auth);\r\n        },\r\n\r\n        /**\r\n         * This method allows to update the Bizagi's SDK access token, when client access token has been refreshed in order\r\n         * to synchronize the access token on both sides\r\n         * @public\r\n         * @summary\r\n         * Sets the authentication access token\r\n         * @param {string} accessToken        User access token\r\n         * @example\r\n         * mashup.setAccessToken(access_token);\r\n         **/\r\n        setAccessToken: function (accessToken) {\r\n            if (this.defaultParams.authentication.type == \"OAuth\") {\r\n                this.authenticator.setAccessToken({accessToken: accessToken});\r\n            } else {\r\n                console.log(\"this call will not have any effect\");\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Shows a summary data for the last or actual case opened.\r\n         * @summary Shows a summary case.\r\n         * @public\r\n         * @example\r\n         * mashup.showSummaryCase();\r\n         */\r\n        showSummaryCase: function (params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            if (typeof self.authenticator.getUser() !== \"undefined\") {\r\n                self.ready().then(function () {\r\n                    if (typeof self.controller !== \"undefined\") {\r\n                        self.controller.publish(\"showSummary\", params);\r\n                    } else {\r\n                        bizagi.log(\"No se ha ejecutado el mashup facade.\");\r\n                    }\r\n                });\r\n            } else {\r\n                if (typeof self.defaultParams.onError === \"function\") {\r\n                    self.defaultParams.onError(\"You must login to complete the action.\");\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Creates a brand new case with the provided configuration, if server version is older then 11.0, call\r\n         * method with the param idWFClass, for server version greater than or equals call the method with the param\r\n         * idProcess.\r\n         * @summary Create a new case.\r\n         * @param {object}  params                 Object parameters.\r\n         *\r\n         * @param {int}     params.idWFClass       Id of the WFClass or process for (For server versions lower than 11.0).\r\n         * @param {int}     params.idProcess       Id of the process (For server versions 11.0 and higher).\r\n         * @example\r\n         * mashup.createNewCase({\"idWFClass\": 1});\r\n         * //OR\r\n         * mashup.createNewCase({\"idProcess\": 1});\r\n         */\r\n        createNewCase: function (params) {\r\n            var self = this;\r\n\r\n            if (typeof self.authenticator.getUser() !== \"undefined\") {\r\n                self.ready().then(function () {\r\n                    if (self.controller) {\r\n                        self.controller.publish(\"createNewCase\", params);\r\n                    } else {\r\n                        bizagi.log(\"No se ha ejecutado el mashup facade.\");\r\n                    }\r\n                });\r\n            } else {\r\n                if (typeof self.defaultParams.onError === \"function\") {\r\n                    self.defaultParams.onError(\"You must login to complete the action.\");\r\n                }\r\n            }\r\n        },\r\n\r\n        renderCaseSummary: function (params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            self.ready().then(function () {\r\n                if (typeof self.controller !== \"undefined\") {\r\n                    self.controller.publish('renderSummaryCase', params);\r\n                } else {\r\n                    bizagi.log(\"No se ha ejecutado el mashup facade\");\r\n                }\r\n            });\r\n        }\r\n\r\n    }\r\n);\r\n","/*\r\n *   Name: BizAgi Mashups\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will allow to configure the user authentication\r\n */\r\n\r\n$.Class.extend(\"bizagi.mashup.authentication\", {}, {\r\n\r\n\r\n    /**\r\n     * Authentication class constructor\r\n     * @param facade\r\n     * @param params\r\n     */\r\n    init: function (facade, params) {\r\n        this.facade = facade;\r\n        this.dataService = facade.dataService;\r\n        this.creationParams = params;\r\n    },\r\n\r\n    authenticateUser: function () {\r\n    },\r\n    \r\n    logout: function () {\r\n    },\r\n\r\n    /**\r\n     * fethc the current user information form bizagi platform \r\n     * @returns {*}\r\n     */\r\n    getCurrentUser: function () {\r\n        var self = this;\r\n\r\n        return self.dataService.getCurrentUser().then(\r\n            function (currentUser) {\r\n                // Sacar de este lugar cuando se adicione el security al currentUser\r\n                currentUser.userProperties = {};\r\n                var userProperty;\r\n                var i = -1;\r\n\r\n                while ((userProperty = currentUser.sUserProperties[++i])) {\r\n                    currentUser.userProperties[userProperty.key] = userProperty.value;\r\n                }\r\n\r\n                self.currentUser = bizagi.currentUser = currentUser;\r\n                \r\n                return currentUser;\r\n            });\r\n    },\r\n\r\n    getUser: function () {\r\n        return this.currentUser;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Mashups\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will allow to configure the user authentication\r\n */\r\n\r\nbizagi.mashup.authentication.extend(\"bizagi.mashup.authentication.basic\", {}, {\r\n    /**\r\n     * Authentication class constructor\r\n     * @param facade\r\n     * @param params\r\n     */\r\n    init: function (facade, params) {\r\n        this._super(facade, params);\r\n    },\r\n\r\n    authenticateUser: function () {\r\n    }\r\n});","/*\r\n *   Name: BizAgi Mashups\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will allow to configure the user authentication\r\n */\r\n\r\nbizagi.mashup.authentication.extend(\"bizagi.mashup.authentication.bizagi\", {}, {\r\n    /**\r\n     * Authentication class constructor\r\n     * @param facade\r\n     * @param params\r\n     */\r\n    init: function (facade, params) {\r\n        var self = this;\r\n\r\n        self._super(facade, params);\r\n\r\n        self.autologin = new jqAutoLogin({\r\n            events: {\r\n                logout: function () {\r\n                },\r\n                login: function () {\r\n                },\r\n                sessionExpiration: function () {\r\n                    return $.ajax({\r\n                        url: bizagiConfig.proxyPrefix + \"Api/Authentication/User\",\r\n                        crossDomain: true,\r\n                        type: \"POST\",\r\n                        dataType: \"json\",\r\n                        //timeout: 6000,\r\n                        data: self.data\r\n                    }).fail(function (fail) {\r\n                        if (self.facade.defaultParams.onError) {\r\n                            self.facade.defaultParams.onError(fail);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    authenticateUser: function (params) {\r\n        var self = this;\r\n        self.data = {\r\n            \"user\": params.user,\r\n            \"password\": params.password,\r\n            \"domain\": params.domain,\r\n            \"loginOption\": \"AlwaysAsk\"\r\n        };\r\n\r\n        return $.ajax({\r\n            url: bizagiConfig.proxyPrefix + \"Api/Authentication/User\",\r\n            crossDomain: true,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            //timeout: 6000,\r\n            data: self.data\r\n        }).then(function (resp) {\r\n            //console.log(resp);\r\n            if (resp.isAuthenticate === \"true\"){\r\n                self.autologin.login(self.data);\r\n                return self.getCurrentUser();\r\n            }\r\n            throw \"Authentication error\";\r\n        });\r\n    },\r\n\r\n    logout: function () {\r\n        var self = this;\r\n        return $.ajax({\r\n            url: bizagiConfig.proxyPrefix + \"Rest/Authentication/logout\",\r\n            crossDomain: true,\r\n            type: \"POST\",\r\n            dataType: \"json\"\r\n        }).then(function (resp) {\r\n            self.autologin.logout();\r\n            delete self.currentUser;\r\n            return \"Success logout\";\r\n        });\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Mashups\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will allow to configure the user authentication\r\n */\r\n\r\nbizagi.mashup.authentication.extend(\"bizagi.mashup.authentication.oauth\", {}, {\r\n    /**\r\n     * Authentication class constructor\r\n     * @param facade\r\n     * @param params\r\n     */\r\n    init: function (facade, params) {\r\n        var self = this;\r\n        self._super(facade, params);\r\n\r\n\r\n        if (typeof params.refreshTokenCallback === \"undefined\") {\r\n            if (self.facade.defaultParams.onError) {\r\n                self.facade.defaultParams.onError(\"you should define a refresh callback to oauth authentication\");\r\n            }\r\n            return;\r\n        }\r\n\r\n        self.refreshTokenCallback = params.refreshTokenCallback;\r\n\r\n        self.oauth2 = new jqOAuth({\r\n            tokenName: \"bizagi.mashup.token\",\r\n            events: {\r\n                logout: function () {\r\n                },\r\n                login: function () {\r\n                },\r\n                tokenExpiration: function () {\r\n                    var def = new $.Deferred();\r\n\r\n                    self.refreshTokenCallback(function(accessToken){\r\n\r\n                        var refreshToken = \"\";\r\n                        self.oauth2.setAccessToken(accessToken, refreshToken);\r\n                        def.resolve(accessToken);\r\n\r\n                    }, function(error){\r\n                        if (self.facade.defaultParams.onError) {\r\n                            self.facade.defaultParams.onError(error);\r\n                        }\r\n                        def.reject(error);\r\n                    });\r\n\r\n                    return def.promise();\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    authenticateUser: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.refreshToken = params.refreshToken || \"\";\r\n        params.accessToken = params.accessToken || \"\";\r\n\r\n        self.oauth2.login(params.accessToken, params.refreshToken);\r\n        return self.getCurrentUser();\r\n\r\n    },\r\n\r\n    setAccessToken: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.refreshToken = params.refreshToken || \"\";\r\n        params.accessToken = params.accessToken || \"\";\r\n\r\n        if (self.oauth2.hasAccessToken()) {\r\n            self.oauth2.setAccessToken(params.accessToken, params.refreshToken);\r\n        }\r\n        else {\r\n            console.log(\"It's necessary call the authenticateUser method before set a new Access Token\");\r\n        }\r\n\r\n    },\r\n\r\n    logout: function () {\r\n        var self = this;\r\n        self.oauth2.logout();\r\n        delete self.currentUser;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Device Render Factory\r\n*   Author: Ricardo P�rez\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropiate factory on demand\r\n*/\r\n\r\n$.Class.extend(\"bizagi.mashup.device.factory\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param mashup\r\n     */\r\n    init: function (mashup, params) {\r\n        this.device = params.device || bizagi.detectDevice();\r\n        this.mashup = mashup;\r\n        this.cachedFacade = null;\r\n    },\r\n\r\n\r\n    /**\r\n     * Returns the appropiate mashup facade based on the device detection\r\n     * Because it loads the scripts on demand it must return a promise\r\n     * @param dataService\r\n     * @param initializeTemplates\r\n     * @returns {*}\r\n     */\r\n     getMashupFacade: function (dataService, initializeTemplates) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        initializeTemplates = typeof(initializeTemplates) !== \"undefined\" ? initializeTemplates : true;\r\n\r\n        if (self.cachedFacade != null) {\r\n            // Resolve with cached factory                \r\n            defer.resolve(self.cachedFacade);\r\n\r\n        } else {\r\n            if (bizagi.util.isTabletDevice()) {\r\n\r\n                self.cachedFacade = new bizagi.mashup.tablet.facade(this.mashup, dataService);\r\n\r\n                // Chain template loading\r\n                $.when(self.cachedFacade.initAsyncStuff({\r\n                    device:this.device\r\n                }))\r\n                    .done(function() {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFacade);\r\n                    });\r\n\r\n                return defer.promise();\r\n            } else if (bizagi.util.isSmartphoneDevice()) {\r\n                \r\n                self.cachedFacade = new bizagi.mashup.smartphone.facade(this.mashup, dataService);\r\n\r\n                // Chain template loading\r\n                $.when(self.cachedFacade.initAsyncStuff({\r\n                    device: this.device\r\n                }))\r\n                .done(function () {\r\n                    // Resolve operation\r\n                    defer.resolve(self.cachedFacade);\r\n                });\r\n                \r\n                return defer.promise();\r\n            } else {\r\n                // If no device suuported\r\n                alert(\"Not supported device: \" + this.device);\r\n                defer.resolve(\"\");\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Returns the current data service being used\r\n    */\r\n    getDataService: function () {\r\n        return this.dataService;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet mashup Facade\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a workportal facade to access to all components\r\n */\r\n\r\n\r\n$.Class.extend(\"bizagi.mashup.tablet.facade\", {\r\n}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (mashup, dataService) {\r\n        var self = this;\r\n        this.mashup = mashup;\r\n        this.templates = {};\r\n        this.dataService = dataService;\r\n        self.device = bizagi.detectDevice();\r\n\r\n        // Add meta to head in order to disable zoom\r\n        this.setMobileMetaTags();\r\n        if (bizagi.override.enableMSF) {\r\n            if (bizagi.hasOwnProperty(\"kendo\")) {\r\n                self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n            } else {\r\n                self.templateService = new bizagi.templates.services.service(bizagi.localization);\r\n            }\r\n        } else {\r\n            self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        }\r\n    },\r\n\r\n    /* SETS Mobile META TAGS\r\n     =====================================================*/\r\n    setMobileMetaTags: function () {\r\n\r\n        // Removes iPad address bar when launched from home screen // temporarily disabled\r\n        /*\r\n         $('<meta>', {\r\n         name : \"apple-mobile-web-app-capable\",\r\n         content : \"yes\"\r\n         }).appendTo('head');\r\n         */\r\n        // Disables safari zooming on iPad when running as web app\r\n        $(\"<meta>\", {\r\n            name : \"viewport\",\r\n            content : \"width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no\"\r\n        }).appendTo(\"head\");\r\n\r\n        $(\"<link>\", {\r\n            rel : \"apple-touch-icon-precomposed\",\r\n            href : \"jquery/css/bizagi/tablet/images/BizAgi_logo.png\"\r\n        }).appendTo(\"head\");\r\n\r\n        /*$('<link>', {\r\n         rel: 'apple-touch-startup-image',\r\n         href: 'jquery/css/bizagi/tablet/images/splash-screen-landscape.png',\r\n         media: '(orientation:landscape)'\r\n         }).appendTo('head');\r\n\r\n         $('<link>', {\r\n         rel: 'apple-touch-startup-image',\r\n         href: 'jquery/css/bizagi/tablet/images/splash-screen-portrait.png',\r\n         media: '(orientation:portrait)'\r\n         }).appendTo('head');*/\r\n    },\r\n\r\n    /*\r\n     *   This function will load asynchronous stuff needed in the module\r\n     */\r\n    initAsyncStuff: function (params) {\r\n        params = params || {};\r\n        var self = this;\r\n        var device = params.device || bizagi.detectDevice();\r\n        //TODO BUG IN ANDROID;\r\n        //bizagi.enableCustomizations = true;\r\n\r\n        if (bizagi.enableCustomizations) {\r\n            return $.when(\r\n                // Load custom templates\r\n                bizagi.templateService.loadCustomTemplates()\r\n                    .then(function() {\r\n                        // Load default templates\r\n                        return self.loadTemplates();\r\n                    }),\r\n                // Load Custom styles\r\n                bizagi.util.loadFile({\r\n                    src: bizagi.getStyleSheet(\"bizagi.overrides.\" + device + \".custom.styles\"),\r\n                    type: \"css\"\r\n                }),\r\n                // Load custom javascript overrides\r\n                bizagi.util.loadFile({\r\n                    src: bizagi.getJavaScript(\"bizagi.mashup.\" + device + \".overrides\"),\r\n                    type: \"js\"\r\n                })\r\n            );\r\n        } else {\r\n            return self.loadTemplates()\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Load all the templates used in the workportal\r\n     */\r\n    loadTemplates: function() {\r\n        var self = this;\r\n        // var defer = new $.Deferred();\r\n\r\n        return $.when(self.loadTemplate(\"home\", bizagi.getTemplate(\"bizagi.mashup.common.home\")))\r\n            .then(function () {\r\n                var def = new $.Deferred();\r\n\r\n                // Resolve when all templates are loaded\r\n                $(\"body\").append(self.getTemplate(\"home\"));\r\n\r\n                bizagi.util.startkendo({\r\n                    started: function () {\r\n                        self.configureHomeHandlers();\r\n                        def.resolve();\r\n                    }\r\n                });\r\n\r\n                return def.promise();\r\n            });\r\n    },\r\n\r\n    configureHomeHandlers: function () {\r\n        var self = this;\r\n        $(\".bz-home-back\" ,\"#home\").click(function (e) {\r\n            self.close();\r\n        });\r\n    },\r\n\r\n    navigate: function(id, transition, replace){\r\n        if (typeof replace !== \"undefined\" && replace){\r\n            bizagi.kendoMobileApplication.replace(id, transition);\r\n        }\r\n        else {\r\n            bizagi.kendoMobileApplication.navigate(id, transition);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Close the render view & call callback\r\n     */\r\n    close: function(){\r\n        if(typeof this.mashup.defaultParams.onClose !== \"undefined\"){\r\n            this.mashup.defaultParams.onClose();\r\n        }\r\n        //this.navigate(\"#:back\");\r\n    },\r\n\r\n    /*\r\n     *   Load one template and save it internally\r\n     */\r\n    loadTemplate: function (template, templateDestination) {\r\n        var self = this;\r\n        // Go fetch the template\r\n        return self.templateService.getTemplate(templateDestination, template)\r\n            .done(function (resolvedTemplate) {\r\n                if (typeof resolvedTemplate === \"string\") {\r\n                    self.templates[template] = $.trim(resolvedTemplate.replace(/\\n/g, \"\"));\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n     *   Returns the desired action\r\n     */\r\n    getAction: function (action, params) {\r\n        if (action == \"routing\") {\r\n            return new bizagi.mashup.actions.routing(this, this.dataService, params);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(action + \" action not supported\", params, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Method to fetch templates from a private dictionary\r\n     */\r\n    getTemplate: function (template) {\r\n        var self = this;\r\n        return self.templates[template];\r\n    },\r\n\r\n    /*\r\n     *   Returns the main controller to be used\r\n     */\r\n    getMainController: function (params) {\r\n        return new bizagi.mashup.controllers.main(this, this.dataService, params);\r\n    },\r\n    /*\r\n    *   Load one template and save it internally\r\n    */\r\n    loadTemplateWebpart: function (template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return self.templateService.getTemplateWebpart(templateDestination, template)\r\n            .done(function (resolvedRemplate) {\r\n                self.templates[template] = $.trim(resolvedRemplate.replace(/\\n/g, \"\"));\r\n            });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Workportal Main Controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n */\r\n\r\n$.Class.extend(\"bizagi.mashup.controllers.controller\", {}, {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        // Set mashup facade\r\n        this.mashupFacade = mashupFacade;\r\n\r\n        // Set data service\r\n        this.dataService = dataService;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set a component container hash to use with templates\r\n        this.componentContainers = {};\r\n\r\n        // Define an object to hold the templates used in the widget\r\n        this.tmpl = {};\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n\r\n        // Flag to check if the element is disposed\r\n        this.disposed = false;\r\n\r\n        this.creationParams = params || {};\r\n\r\n        this.canvas = this.creationParams.canvas || $(\"<div />\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param id\r\n     * @param transition\r\n     */\r\n    navigate: function(id, transition, replace){\r\n        var self = this;\r\n        self.mashupFacade.navigate(id, transition, replace);\r\n    },\r\n\r\n    /**\r\n     *   Publish an event so any controller can subscribe to it\r\n     */\r\n    publish: function (eventName, params) {\r\n        if (this.disposed) return null;\r\n        return $(document).triggerHandler(eventName, params);\r\n    },\r\n\r\n    /**\r\n     *   Subscribe to an event that any controller could trigger\r\n     */\r\n    subscribe: function(eventName, callback) {\r\n        if (this.disposed) return null;\r\n\r\n        var docEvents = jQuery._data(document, \"events\");\r\n        var docEventName = docEvents[eventName];\r\n        if (docEventName) {\r\n            var length = docEventName.length;\r\n\r\n            for (var i = 0, len = length; i < len; i++) {\r\n                if (docEventName[i].handler.toString() === callback.toString()) {\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        $(document).bind(eventName, callback);\r\n        this.subscribers.push({ event: eventName });\r\n    },\r\n\r\n    /**\r\n     *   Subscribe to one time event that any controller could trigger\r\n     */\r\n    subscribeOneTime: function (eventName, callback) {\r\n        if (this.disposed) return null;\r\n        $(document).one(eventName, callback);\r\n        this.subscribers.push({ event: eventName });\r\n    },\r\n\r\n    /**\r\n     *   Un Subscribe to an event that any controller could trigger in this document\r\n     */\r\n    unsubscribe: function (eventName, callback) {\r\n        if (this.disposed) return null;\r\n        if (callback) {\r\n            $(document).unbind(eventName, callback);\r\n        }\r\n        else { $(document).unbind(eventName); }\r\n    },\r\n\r\n    /**\r\n     *   Makes the base processing of the layout (mix templates + data)\r\n     *   after all that processing will call a post-render method to\r\n     *   be implemented in each device to apply custom plugins\r\n     *   Returns a promise because the rendering could be asynchronous\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (typeof self.templatesDeferred !== \"undefined\") {\r\n            self.templatesDeferred.then(function () {\r\n                // Render content\r\n                self.internalRender(params).done(function (content) {\r\n                    defer.resolve(content);\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            self.internalRender(params).done(function (content) {\r\n                defer.resolve(content);\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * to implement in each device\r\n     * @param params\r\n     */\r\n    configureHandlers: function (params) {},\r\n\r\n    /**\r\n     *\r\n     * @returns {*}\r\n     */\r\n    internalRender: function (params) {\r\n        var self = this;\r\n        return $.when(self.renderContent(params))\r\n            .then(function (content) {\r\n                self.content = content || \"\";\r\n\r\n                self.canvas.append(content);\r\n                // Call post-render method\r\n                self.postRender();\r\n                // Resolve deferred\r\n                return self.content;\r\n            });\r\n    },\r\n\r\n\r\n    /**\r\n     * Allows load templates\r\n     * @param templates\r\n     * @returns promise of load templates excecutions\r\n     */\r\n    loadTemplates: function (templates) {\r\n        var self = this,\r\n            def = self.templatesDeferred = new $.Deferred(),\r\n            tmplPromises = [];\r\n\r\n        var useNewEngine = (templates.useNewEngine != undefined) ?  templates.useNewEngine : true;\r\n\r\n        for (var name in templates) {\r\n            if (name != \"useNewEngine\") {\r\n                tmplPromises.push(\r\n                    self.loadTemplate({\r\n                        \"name\" : name,\r\n                        \"path\" : templates[name],\r\n                        \"useNewEngine\" :useNewEngine\r\n                    })\r\n                );\r\n            }\r\n        }\r\n\r\n        $.when.apply($, tmplPromises)\r\n            .done(function () {\r\n                def.resolve();\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n     * Loads template\r\n     */\r\n    loadTemplate: function (data) {\r\n        var self = this;\r\n\r\n        if (self.tmpl[data.name]) {\r\n            return self.tmpl[data.name];\r\n        } else {\r\n            if (data.useNewEngine){\r\n                return bizagi.templateService.getTemplateWidget(data.path, data.name)\r\n                    .done(function (tmpl) {\r\n                        self.tmpl[data.name] = tmpl;\r\n                    });\r\n            }\r\n\r\n            return self.templateService.getTemplate(data.path, data.name)\r\n                .done(function (tmpl) {\r\n                    self.tmpl[data.name] = tmpl;\r\n                });\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Gets template\r\n     */\r\n    getTemplate: function (name) {\r\n        if (this.tmpl.hasOwnProperty(name)) {\r\n            return this.tmpl[name];\r\n        }\r\n        return null;\r\n\r\n    },\r\n\r\n    /*\r\n     *   Returs the rendered content\r\n     */\r\n    getContent: function () {\r\n        return this.content;\r\n    },\r\n\r\n    /*\r\n     *   Returns the mapped resource\r\n     */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n     *   Renders the content for the current controller\r\n     *\r\n     */\r\n    renderContent: function () {\r\n        // Override on implementations\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function () { },\r\n\r\n    /*\r\n     *   Returns the component replaced tag selector\r\n     */\r\n    getComponentSelector: function (component) {\r\n        return \"[data-bizagi-component=\" + component + \"]\";\r\n    },\r\n\r\n    /*\r\n     *   Returns the component replaced tag selector\r\n     */\r\n    getComponentContainer: function (component) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content || content.length == 0) return null;\r\n\r\n        // Find component parent and cache it\r\n        var componentElement = self.componentContainers[component];\r\n        if (componentElement == null) {\r\n            // Find the component inside the main content\r\n            componentElement = $(self.getComponentSelector(component), content);\r\n\r\n            // If still not found, try to check if content element is the component\r\n            if (componentElement.length == 0 && content.is(self.getComponentSelector(component))) {\r\n                componentElement = content;\r\n            }\r\n\r\n            // Cache the component\r\n            self.componentContainers[component] = componentElement;\r\n        }\r\n        return self.componentContainers[component];\r\n    },\r\n\r\n    /*\r\n     *   Executes a mashup action\r\n     */\r\n    executeAction: function (actionName, params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var actionParams = $.extend(params, {\r\n            action: actionName\r\n        });\r\n\r\n        var actionController = self.mashupFacade.getAction(actionParams.action);\r\n\r\n        // Executes the action\r\n        actionController.execute(actionParams);\r\n    },\r\n\r\n    /*\r\n     *   Asks for a full resize\r\n     */\r\n    resizeLayout: function () {\r\n        this.publish(\"resizeLayout\");\r\n    },\r\n\r\n    /*\r\n     * Do stuff when a resize has been triggered\r\n     */\r\n    performResizeLayout: function () { },\r\n\r\n    /*\r\n     *   Disposes the widget\r\n     */\r\n    dispose: function () {\r\n        var self = this;\r\n        self.disposed = true;\r\n\r\n        setTimeout(function () {\r\n            if (self.subscribers != null) {\r\n                // Remove all subcriptions\r\n                $.each(self.subscribers, function (i, item) {\r\n                    self.unsubscribe(item.event);\r\n                });\r\n            }\r\n            bizagi.util.dispose(self);\r\n        }, bizagi.override.disposeTime || 50);\r\n    }\r\n\r\n});\r\n","/**\r\n * Created by RicardoPD on 4/8/2016.\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.actions.routing\", {}, {\r\n\r\n    /*\r\n     *   Executes the action\r\n     *   Could return a deferred\r\n     */\r\n    execute: function (params) {\r\n        var self = this;\r\n        self.params = params || {};\r\n        /* New implementation of routing*/\r\n\r\n        $.when(self.dataService.routing.getRoute(params)).done(function (route) {\r\n            route = route || {};\r\n\r\n            var isOfflineForm = false;\r\n            if (typeof (self.params) != \"undefined\") {\r\n                isOfflineForm = typeof (self.params.isOfflineForm) !== \"undefined\"\r\n\t\t\t\t\t&& bizagi.util.parseBoolean(self.params.isOfflineForm);\r\n            }\r\n\r\n            if (isOfflineForm) {\r\n                route.moduleParams = $.extend(route.moduleParams,\r\n                {\r\n                    formsRenderVersion: self.params.formsRenderVersion,\r\n                    isOfflineForm: isOfflineForm,\r\n                    idCase: self.params.idCase,\r\n                    idWorkitem: self.params.idWorkitem\r\n                }) || {};\r\n            } else {\r\n                route.moduleParams = route.moduleParams || {};\r\n            }\r\n\r\n            switch (route.module) {\r\n                case \"activityform\":\r\n                    self.publish(\"renderCase\", route.moduleParams);\r\n                    break;\r\n                case \"oldrenderintegration\":\r\n                    self.publish(\"renderCase\", route.moduleParams);\r\n                    break;\r\n                case \"async\":\r\n                    self.publish(\"render-async\", route.moduleParams);\r\n                    break;\r\n                case \"routing\":\r\n                    var parameters = {\r\n                        title: self.getResource(\"workportal-widget-routing-window-selector\"),\r\n                        onClose: route.moduleParams.onClose\r\n                    };\r\n\r\n                    if (self.isThereAsync(route.moduleParams.data)) {\r\n                        self.asyncWidget(route.moduleParams);\r\n                    } else {\r\n                        self.publish(\"showDialog\", {\r\n                            widgetName: \"routing\",\r\n                            data: route.moduleParams.data,\r\n                            modalParameters: parameters,\r\n                            onClose: parameters.onClose\r\n                        });\r\n                    }\r\n                    break;\r\n            }\r\n\r\n        }).fail(function (error){\r\n            self.publish(\"error\", error);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Search for async workitems\r\n     */\r\n    isThereAsync: function (data) {\r\n        var workitems = data.workItems, wi, index = 0;\r\n        var length = workitems.length, result = false;\r\n        if (length > 0) {\r\n            for (; index < length; ) {\r\n                wi = workitems[index++];\r\n                if (wi.isAsynch === \"true\") {\r\n                    result = result || [];\r\n                    result.push(wi);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    asyncWidget: function (params) {\r\n        var self = this;\r\n        params.widgetName = \"async\";\r\n        self.publish(\"changeWidget\", params);\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Workportal Main Controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.main\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Define regex to apply to templates\r\n        self.componentRegex = /{{component (\\w+)}}/g;\r\n\r\n        // Call base\r\n        this._super(mashupFacade, dataService, params);\r\n\r\n        // Subscribe to change widget event\r\n        this.subscribe(\"changeWidget\", function (e, params) {\r\n\r\n            $.when(bizagi.util.autoSave()).done(function () {\r\n\r\n                $(document).data('auto-save', '');\r\n\r\n                if (params.widgetName == bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX || params.widgetName == bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID) {\r\n                    bizagi.cookie(\"bizagiDefaultWidget\", params.widgetName, { expires: 30 });\r\n                }\r\n\r\n                bizagi.util.setContext({\r\n                    widget: params.widgetName\r\n                }, true);\r\n\r\n                self.setWidget(params);\r\n\r\n            });\r\n\r\n        });\r\n\r\n        // Subscribe to pop widget event\r\n        this.subscribe(\"showDialog\", function (e, params) {\r\n            // Shows a pop a widget\r\n            switch (params.widgetName){\r\n                case \"routing\":\r\n                    self.renderController.renderRoutingDialog(params);\r\n                    break;\r\n                default: \r\n                    break;\r\n            }\r\n        });\r\n\r\n\r\n        // Subscribe to push widget event\r\n        this.subscribe(\"pushWidget\", function (e, params) {\r\n            // Shows a push a widget\r\n            self.pushWidget(params);\r\n        });\r\n\r\n        // Subscribe to execute action event\r\n        this.subscribe(\"executeAction\", function (e, params) {\r\n            // Executes the action\r\n            self.executeAction(params);\r\n        });\r\n        /**\r\n         * subscribe the error\r\n         */\r\n        this.subscribe(\"renderActionButton\", function (e, params) {\r\n            // Executes the action\r\n            if (typeof self.mashupFacade.mashup.defaultParams.onRenderAction !== \"undefined\"){\r\n                self.mashupFacade.mashup.defaultParams.onRenderAction(params);\r\n            }\r\n        });\r\n        \r\n        \r\n        this.subscribe(\"error\", function (e, params) {\r\n            // attach the widget to a given element\r\n            if (typeof self.mashupFacade.mashup.defaultParams.onError !== \"undefined\"){\r\n                var result = {};\r\n                try {\r\n                    result = $.parseJSON(params.responseText);\r\n                } catch (e) {\r\n                    try {\r\n                        // Try to fix some known problems regarding rare ascii characters\r\n                        result = $.parseJSON(data.replace(/\\x1d/g, \".\"));\r\n                    } catch (ex) {\r\n                        result.type = \"error\";\r\n                        result.code = e.errorCode;\r\n                        result.message = params ? params.responseText : \"\";\r\n                        //Throw exception in next layer\r\n                    }\r\n                }\r\n                \r\n                self.mashupFacade.mashup.defaultParams.onError(result);\r\n            }\r\n            //self.mashupFacade.navigate(\"#home\");\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     *   Renders the content for the current controller\r\n     *\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        // render workarea\r\n        return self.renderWorkarea();\r\n    },\r\n\r\n    /*\r\n     *   Renders the workarea based on the current widget\r\n     */\r\n    renderWorkarea: function () {\r\n        var self = this;\r\n        // clean widgets\r\n        //TODO Implementacion de un factory de controllers\r\n\r\n        self.renderController = new bizagi.mashup.controllers.render(self.mashupFacade, self.dataService, {canvas : self.canvas, layoutHeader: self.creationParams.layoutHeader || false});\r\n        self.caseSummaryController = new bizagi.mashup.controllers.caseSummary(self.mashupFacade, self.dataService, {canvas : self.canvas});\r\n        self.startFormController = new bizagi.mashup.controllers.startForm(self.mashupFacade, self.dataService, {canvas : self.canvas});\r\n        self.entityTemplatesController = new bizagi.mashup.controllers.entityTemplates(self.mashupFacade, self.dataService, {canvas : self.canvas, layoutHeader: self.creationParams.layoutHeader || false});\r\n\r\n        //starts non visual controllers\r\n\r\n        self.newCaseController = new bizagi.mashup.controllers.newCase(self.mashupFacade, self.dataService, {canvas : self.canvas, layoutHeader: self.creationParams.layoutHeader || false});\r\n\r\n        return $.when(self.renderController.render(),\r\n            self.caseSummaryController.render(),\r\n            self.newCaseController.render(),\r\n            self.startFormController.render(),\r\n            self.entityTemplatesController.render()\r\n        );\r\n    }\r\n});\r\n","/**\r\n * Controlador de dialogos de bizagi, este controlador esta hecho especificamente para kendo, si se usa otro framework \r\n * debe escribir una clase que sobreescriba esta o sobre escribir los metodos aqui consignados de nuevo.\r\n * Created by RicardoPD on 4/18/2016.\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.dialog\", {}, {\r\n    init: function(mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n\r\n        self.loadTemplates({\r\n            \"mashup-dialog\": bizagi.getTemplate(\"bizagi.mashup.common.dialog\").concat(\"#mashup-dialog\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render the Dialog\r\n     * @param params\r\n     */\r\n    renderContent: function(params) {\r\n        var self = this;\r\n        var dialogTmpl = self.getTemplate(\"mashup-dialog\");\r\n        var now = $.now();\r\n        self.id = \"modal-\" + now;\r\n        var content = $.kendoTmpls(bizagi.util.trim(dialogTmpl), { id: self.id }).clone();\r\n        content.html(params.content);\r\n        return content;\r\n    },\r\n\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        self.content.kendoMobileModalView({\r\n            close: function() {\r\n                this.destroy();\r\n                this.element.remove();\r\n            },\r\n            useNativeScrolling: true,\r\n            modal: self.creationParams.modal || true\r\n        });\r\n\r\n        self.modalView = self.content.data(\"kendoMobileModalView\");\r\n\r\n        self.modalView.open();\r\n    },\r\n\r\n    close: function() {\r\n        if (typeof this.modalView !== \"undefined\") {\r\n            this.modalView.close();\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *\r\n * Created by RicardoPD on 4/13/2016.\r\n */\r\n\r\n// Auto extend\r\n$.Class.extend(\"bizagi.mashup.controller.navigation\", {\r\n    PRIORITY_UNDEFINED: -1,\r\n    PRIORITY_PRIMARY: 1,\r\n    PRIORITY_SECONDARY: 2,\r\n    PRIORITY_LIST: [\"next\", \"save\", \"validate\", \"nextWithoutValidations\", \"createnewcase\", \"search\", \"select\", \"add\", \"\"]\r\n}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param params\r\n     */\r\n    init: function (controller) {\r\n        var self = this;\r\n        self.controller = controller;\r\n        self.view = self.controller.view;\r\n        self.$pane = self.view.wrapper.closest(\"[data-role='pane']\");\r\n        self.pane = self.$pane.data(\"kendoMobilePane\");\r\n        self.navBar = $(\".km-navbar\", self.view.header).data(\"kendoMobileNavBar\");\r\n\r\n        //Will contains all the dinamic views created\r\n        self.containersQueue = [];\r\n    },\r\n\r\n    resetParams: function () {\r\n        var self = this;\r\n        if (typeof self.navBar !== \"undefined\") {\r\n            self.navBar.title(\"\");\r\n            $(\".bz-render-dynamic\", self.navBar.element).hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * creates a container to paint a new render form\r\n     */\r\n    createRenderContainer: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.view = params.view || {};\r\n        var now = $.now();\r\n        var id = \"render-edition-\" + now;\r\n        var zoom = typeof params.view.zoom !== \"undefined\" ? (Boolean(params.view.zoom)) : false;\r\n        var useNativeScrolling = typeof params.view.useNativeScrolling !== \"undefined\" ? (Boolean(params.view.useNativeScrolling)) : true;\r\n\r\n        var $view = $.kendoTmpls(self.controller.getTemplate(\"mashup-render-edition-view\"), {\r\n            \"viewId\": id,\r\n            \"title\": params.title || \"\"\r\n        });\r\n\r\n        self.setContainerParams(params);\r\n\r\n        self.$pane.append($view);\r\n        var viewItem = new kendo.mobile.ui.View($view,\r\n            {\r\n                \"zoom\": zoom,\r\n                \"useNativeScrolling\": useNativeScrolling,\r\n                \"destroy\": function () {\r\n                    var tmplView = this;\r\n                    var el = self.containersQueue.find(function (el) {\r\n                        return \"#\".concat(el.id) === tmplView.id;\r\n                    });\r\n                    var index = self.containersQueue.indexOf(el);\r\n                    self.containersQueue.splice(index, 1);\r\n                    self.controller.navigate(el.previousViewId, \"\", true);\r\n                    this.element.remove();\r\n\r\n                    //IMPORTANT\r\n                    //This block of code helps to fix an issue with mashups inside iframe for Sharepoint Projects.\r\n                    //After the user opens an formlink and then close it, the scroll from the parent container is affected\r\n                    //and does not let scroll the page again. Moving the scroll helps to readjust the focus\r\n                    var view = self.pane.view();\r\n                    var scrollElement = view.scroller.scrollElement;\r\n\r\n                    if (scrollElement) {\r\n                        var currentScrollY = scrollElement.scrollTop();\r\n                        $(scrollElement).scrollTop(currentScrollY - 1).scrollTop(currentScrollY + 1);\r\n                    }\r\n                }\r\n            }\r\n        );\r\n\r\n        var returnObject = {\r\n            id: id,\r\n            element: viewItem.contentElement(),\r\n            destroy: function () {\r\n                viewItem.destroy();\r\n            },\r\n            setNavigationButtons: function (form) {\r\n                self.setNavigationButtons(form, this.id);\r\n            }\r\n        };\r\n\r\n        $(\".bz-render-back\", viewItem.header).bind(\"click\", function () {\r\n            returnObject.element.trigger(\"close\", {});\r\n            viewItem.destroy();\r\n        });\r\n\r\n        self.containersQueue.push($.extend(returnObject, {view: viewItem}));\r\n\r\n        return returnObject;\r\n    },\r\n\r\n    navigate: function (id) {\r\n        var self = this;\r\n        var view = self.containersQueue.find(function (el) {\r\n            return el.id === id;\r\n        });\r\n\r\n        if (typeof view !== \"undefined\") {\r\n            view.previousViewId = bizagi.kendoMobileApplication.view().id;\r\n            self.controller.navigate(view.id, \"\", true);\r\n        }\r\n    },\r\n\r\n    setNavigationButtons: function (form) {\r\n        var self = this;\r\n        var buttons,\r\n            hasButtons = false,\r\n            properties = {};\r\n\r\n        if (form && form.buttons && form.buttons.length > 0) {\r\n            buttons = form.buttons;\r\n            hasButtons = true;\r\n            properties = form.properties;\r\n        }\r\n\r\n        self.changeButtonVisibilityByContainer(form);\r\n\r\n        if (hasButtons && typeof self.navBar !== \"undefined\") {\r\n            var dynamic = (properties.buttons || buttons);\r\n\r\n            self.initFormButton(form, dynamic);\r\n            /*$(\".bz-render-dynamic\", self.navBar.element).show().actionSheet({\r\n                setDataToShow: function () {\r\n                    var buttonsToShow = [];\r\n                    for (var i = 0; i < dynamic.length; i++) {\r\n                        dynamic[i].guid = dynamic[i].ordinal;\r\n                        dynamic[i].displayName = dynamic[i].caption;\r\n\r\n                        buttonsToShow.push(dynamic[i]);\r\n                    }\r\n                    return buttonsToShow;\r\n                },\r\n                actionClicked: function (action) {\r\n                    // Default back/close if not ordinal\r\n                    var buttonProperties = form.buttons[action.guid];\r\n                    form.processButton(buttonProperties);\r\n                }\r\n            });*/\r\n        }\r\n    },\r\n\r\n    modalViewDidAppear: function () {\r\n    },\r\n\r\n    modalViewDidDisappear: function () {\r\n    },\r\n\r\n    setContainerParams: function (params) {\r\n    },\r\n\r\n    initFormButton: function (form, dynamic) {\r\n        var self = this;\r\n        var buttonsToShow = dynamic.filter(function (item) {\r\n            return (![\"back\", \"cancel\"].includes(item.action) && bizagi.util.parseBoolean(item.visible) !== false);\r\n        }).map(function (item) {\r\n            return {\r\n                id: item.id,\r\n                action: item.action,\r\n                additional: false,\r\n                label: item.caption,\r\n                ordinal: item.ordinal,\r\n                priority: self.Class.PRIORITY_SECONDARY,\r\n                visible: bizagi.util.parseBoolean(item.visible) !== false,\r\n                ranked: false\r\n            };\r\n        });\r\n\r\n        if (buttonsToShow.length > 0) {\r\n            $(form.container).formButtons({\r\n                buttons: self.getListWithPriority(buttonsToShow),\r\n                click: function (element, params) {\r\n                    self.processButton(params.ordinal, form);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    changeButtonVisibilityByContainer: function (form) {\r\n        if (form && form.container) {\r\n            $(\".ui-bizagi-container-children-form\", form.container).addClass(\"ui-bizagi-form-no-buttons\");\r\n            $(\".ui-bizagi-button-container, .ui-bizagi-container-button-edit\", form.container).hide();\r\n        }\r\n    },\r\n\r\n    getListWithPriority: function (buttonsToShow) {\r\n        var self = this;\r\n        var list = bizagi.clone(buttonsToShow);\r\n        var counter = 0;\r\n\r\n        var indexNext = self.findPriorityAction(list, 0);\r\n        if (indexNext !== self.Class.PRIORITY_UNDEFINED) {\r\n            list[indexNext].priority = self.Class.PRIORITY_PRIMARY;\r\n            list[indexNext].ranked = true;\r\n            counter++;\r\n        }\r\n\r\n        // Only has one action\r\n        if (list.length === 1) return list;\r\n\r\n        var indexSave = self.findPriorityAction(list, 0);\r\n        if (indexSave !== self.Class.PRIORITY_UNDEFINED) {\r\n            list[indexSave].priority = self.Class.PRIORITY_SECONDARY;\r\n            list[indexSave].ranked = true;\r\n            counter++;\r\n        }\r\n\r\n        list.forEach(function (item) {\r\n            if (!item.ranked) {\r\n                item.priority = counter++;\r\n                item.ranked = true;\r\n                item.additional = true;\r\n\r\n            }\r\n        });\r\n\r\n        // The list was ordered\r\n        bizagi.util.sortJSON(list, \"priority\", \"desc\");\r\n\r\n        return list;\r\n    },\r\n\r\n    findPriorityAction: function (list, index) {\r\n        var actionsList = this.Class.PRIORITY_LIST;\r\n\r\n        var indexNext = list.findIndex(function (item) {\r\n            return (item.action === actionsList[index] && !item.ranked);\r\n        });\r\n\r\n        if (indexNext !== this.Class.PRIORITY_UNDEFINED) return indexNext;\r\n        return this.findPriorityAction(list, ++index);\r\n    },\r\n\r\n    /**\r\n     * process the button for principal form or form whit callback in form-edition\r\n     * @param button\r\n     * @param form\r\n     */\r\n    processButton: function (ordinal, form) {\r\n        var button = form.buttons.find(function (btn) {\r\n            return btn.ordinal === ordinal;\r\n        });\r\n\r\n        if (button.callback) {\r\n            button.callback();\r\n        } else {\r\n            form.processButton(button);\r\n        }\r\n    },\r\n\r\n\r\n\r\n});","/**\r\n *\r\n * Created by RicardoPD on 4/18/2016.\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.routing\", {\r\n}, {\r\n\r\n    renderContent: function (params) {        \r\n        var routingTmpl = this.creationParams.routingTmpl || \"\";\r\n        return $.kendoTmpls(routingTmpl, params);\r\n    },\r\n\r\n    /*\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var dialog = new bizagi.mashup.controllers.dialog(self.dataService, self.mashupFacade);\r\n\r\n        dialog.render({ content: self.content }).done(function() {\r\n\r\n            // Assing even style\r\n            $(\"tr:nth-child(even)\", self.content).addClass(\"event\");\r\n\r\n            $(\"#ui-bizagi-wp-app-routing-activity-wf .bz-wp-routing-action\", self.content).on(\"click\", function() {\r\n                var item = $(this).closest(\".bz-wp-routing-item\").data(\"item\");\r\n\r\n                self.showWorkitem({\r\n                    idCase: item.idCase || 0,\r\n                    idWorkitem: item.idWorkItem || 0,\r\n                    idTask: item.idTask || 0,\r\n                    taskName: item.displayName || \"\",\r\n                    radNumber: item.radNumber || 0\r\n                });\r\n\r\n                // close dialog\r\n                dialog.close();\r\n            });\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Shows the rendering widget\r\n     */\r\n    showWorkitem: function (params) {\r\n        var self = this;\r\n        // Shows render widget\r\n\r\n        self.publish(\"renderCase\", {\r\n            idCase: params.idCase,\r\n            idWorkitem: params.idWorkitem,\r\n            idTask: params.idTask,\r\n            taskName: params.taskName,\r\n            radNumber: params.radNumber\r\n        });\r\n    }\r\n});","/**\r\n *\r\n * Created by RicardoPD on 6/7/2016.\r\n */\r\n\r\n// Auto extend\r\n$.Class.extend(\"bizagi.mashup.controllers.async\", {\r\n    ASYNC_CHECK_TIMER: 3000\r\n}, {\r\n\r\n    init: function (renderController) {\r\n        var self = this;\r\n        self.renderController = renderController;\r\n        self.configureHandlers();\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var async = this;\r\n        async.renderController.subscribe(\"render-async\", function (e, params) {\r\n            async.executeAsync(params).done(function () {\r\n                async.renderController.publish(\"renderCase\", {\r\n                    action: \"routing\",\r\n                    idCase: params.idCase\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    executeAsync: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var $template = $.tmpl(self.renderController.getTemplate(\"mashup-async\"), params);\r\n        self.modal =  new kendo.mobile.ui.ModalView($template,\r\n            {\r\n                close: function () {\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                modal: true\r\n            });\r\n\r\n        $(\".render-async-close\", self.modal.element).bind(\"click\", function () {\r\n            self.modal.close();\r\n        });\r\n\r\n        self.modal.open();\r\n        \r\n        self.checkAsycnExecutionState(defer, params);\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    checkAsycnExecutionState: function (defer, params) {\r\n        var self = this.renderController;\r\n        var async = this;\r\n        $.when(self.dataService.getAsynchExecutionState({\r\n            idCase: params.idCase\r\n        })).done(function (response) {\r\n            // verify errors in response\r\n            if (response.state == \"Error\" && response.errorMessage !== undefined) {\r\n                $(\"#modalview-async-message\", self.modal.element).height(130);\r\n                // Change default error\r\n                $(\".ui-bizagi-wp-async-error\", self.modal.element).show();\r\n                $(\".ui-bizagi-wp-waiting-message\", self.modal.element).hide();\r\n                $(\".ui-bizagi-wp-async-error-txt\", self.modal.element).html(response.errorMessage || bizagi.localization.getResource(\"render-async-error\"));\r\n            }\r\n\r\n            // Check for finish signal\r\n            if (response.state == \"Processing\") {\r\n                // Check for non-error message\r\n                if (response.errorMessage.length === 0) {\r\n                    setTimeout(function () {\r\n                        // Refresh widget after a timer\r\n                        async.checkAsycnExecutionState(defer, params);\r\n                    }, bizagi.mashup.controllers.async.ASYNC_CHECK_TIMER);\r\n                }\r\n\r\n            } else if (response.state == \"Finished\") {\r\n                // Resolve main deferred\r\n                async.modal.close();\r\n                defer.resolve();\r\n            }\r\n        });\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Workportal Main Controller\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.render\", {}, {\r\n\r\n    init: function(mashupFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n    },\r\n\r\n/*    loadTemplate: function(template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return self.templateService.getTemplate(templateDestination, template)\r\n            .done(function (resolvedTemplate) {\r\n                self.templates[template] = resolvedTemplate;\r\n            });\r\n    },*/\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mashup-render-view\");\r\n        // Render content\r\n        return $.kendoTmpls(template, {});\r\n    },\r\n\r\n    postRender: function(){\r\n        var self = this;\r\n\r\n        var template = self.getTemplate(\"mashup-render-layout\");\r\n        self.content.prepend($.kendoTmpls(template, {}));\r\n\r\n\r\n        self.view = new kendo.mobile.ui.View(self.content,\r\n            {\r\n                \"useNativeScrolling\": true\r\n            }\r\n        );\r\n\r\n        if (!self.creationParams.layoutHeader){\r\n            self.view.header.hide();\r\n        }\r\n\r\n        self.navigation = new bizagi.mashup.controller.navigation(self);\r\n        self.async = new bizagi.mashup.controllers.async(self);\r\n        self.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Configures all handlers and subscribers for this controller\r\n     *\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.subscribe(\"renderCase\", function (e, params) {\r\n            //First tell to navigator, to reset params\r\n            self.navigation.resetParams();\r\n\r\n            // Check if the required params are filled\r\n            if (bizagi.util.isEmpty(params.idCase)) {\r\n                bizagi.log(\"Se requiere el id del caso 'idCase' para poder renderizar la forma\");\r\n                return null;\r\n            }\r\n\r\n            if (!bizagi.util.isEmpty(params.summaryForm)) {\r\n                self.renderForm(params);\r\n                return null;\r\n            }\r\n\r\n            // Check if the required params are filled\r\n            if (bizagi.util.isEmpty(params.idWorkitem)) {\r\n                var routingParameters = {};\r\n                routingParameters.idCase = params.idCase;\r\n                if(params.summaryForm){\r\n                    routingParameters.summaryForm = true;\r\n                }\r\n                self.executeAction(\"routing\", routingParameters);\r\n                return null;\r\n            }\r\n\r\n            self.renderForm(params);\r\n        });\r\n\r\n        self.subscribe(\"refreshProxyPrefix\", function (e, params) {\r\n            if (typeof self.rendering !== \"undefined\") {\r\n                self.rendering.dataService.serviceLocator.setProxyPrefix(params);\r\n            }\r\n        });\r\n\r\n        $(\".bz-render-back\", self.view.header).bind(\"click\", function () {\r\n            self.view.contentElement().empty();\r\n            self.mashupFacade.close();\r\n        });\r\n\r\n        self.subscribe(\"toggleHeader\", function (e, params) {\r\n            if (typeof params.showHeader !== \"undefined\"){\r\n                if (params.showHeader) {\r\n                    self.view.header.show();\r\n                }\r\n                else {\r\n                    self.view.header.hide();\r\n                }\r\n            }\r\n            else{\r\n                self.view.header.toggle();\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n     * Shows complex gateway inside a modal dialog\r\n     * @param data\r\n     * @returns {bizagi.dialog|dialog|bizagi.rendering.dialog.form}\r\n     */\r\n    renderRoutingDialog: function(params){\r\n        var self = this;\r\n        //show Loading\r\n\r\n        var routing = new bizagi.mashup.controllers.routing(self.dataService, self.mashupFacade,\r\n            {\r\n                routingTmpl: self.getTemplate(\"mashup-routing\")\r\n            }\r\n        );\r\n\r\n        routing.render(params.data).done(function () {\r\n            //hide Loading\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Defines a method to render the form\r\n     * @param params\r\n     */\r\n    renderForm: function(params) {\r\n        var self = this;\r\n        var rfParams = params;\r\n        var renderContainer = self.view.contentElement();\r\n        renderContainer.empty();\r\n\r\n        if (!params.withOutGlobalForm) {\r\n            if (typeof self.rendering === \"undefined\") {\r\n                var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) !== \"undefined\")\r\n                    ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n\r\n                var paramsFacade = { \"proxyPrefix\": proxyPrefix, device: bizagi.util.detectDevice() };\r\n\r\n                // Load render page\r\n                self.rendering = new bizagi.rendering.facade(paramsFacade);\r\n\r\n                // Attach handler to render container to subscribe for routing events\r\n                renderContainer.bind(\"routing\", function (context, triggerparams) {\r\n                    // Executes routing action\r\n                    var parameters = {\r\n                        idCase: rfParams.idCase,\r\n                        fromTask: rfParams.fromTask || rfParams.idTask,\r\n                        fromWorkItemId: rfParams.fromWorkItemId || rfParams.idWorkitem,\r\n                        isOfflineForm: rfParams.isOfflineForm || false,\r\n                        formsRenderVersion: rfParams.formsRenderVersion\r\n                    };\r\n\r\n                    parameters = $.extend(parameters, triggerparams);\r\n                    self.executeAction(\"routing\", parameters);\r\n                });\r\n\r\n                //Binds rendering error form\r\n                renderContainer.bind(\"errorform\", function (error) {\r\n                    //trigger error form to notify the facade\r\n                    self.publish(\"error\", error);\r\n                });\r\n\r\n                self.rendering.subscribe(\"renderActionButton\", function (e, data) {\r\n                    self.publish(\"renderActionButton\", {\r\n                        actions: data.actions,\r\n                        data: {\r\n                            idCase: rfParams.idCase,\r\n                            idWorkitem: rfParams.idWorkitem,\r\n                            idTask: rfParams.idTask,\r\n                            idWorkflow: rfParams.idWorkflow\r\n                        }\r\n                    });\r\n                });\r\n\r\n                /* Data navigation communication*/\r\n                this.rendering.subscribe(\"dataNavigation\", function (e, params) {\r\n                    self.publish(\"dataNavigation\", params);\r\n                   /* var etController = new bizagi.mashup.controllers.entityTemplates(self.mashupFacade, self.dataService, {canvas : self.canvas, navigation: self.navigation, data: params});\r\n                    etController.render({title: params.data.displayName});*/\r\n                });\r\n            }\r\n\r\n            // Executes rendering into render container\r\n            bizagi.loading.start(); //Init loading\r\n            $.when(self.rendering.execute(\r\n                $.extend(params, {\r\n                    canvas: renderContainer,\r\n                    navigation: self.navigation\r\n                })\r\n            )).then(function () {\r\n                //this returns a form, Once the form is rendered you can bind events to the form\r\n            }).fail(function (error) {\r\n                //self.publish(\"error\", error);\r\n            }).always(function () {\r\n                bizagi.loading.stop(); //Whatever happens remove loading\r\n            });\r\n        }\r\n        else {\r\n            var infoTemplate = self.getTemplate(\"mashup-info-message\");\r\n            var message = params.messageForm || self.resources.getResource(\"render-without-globalform\");\r\n            var isOfflineForm = false;\r\n\r\n            if (typeof (self.params) !== \"undefined\") {\r\n                isOfflineForm = typeof (self.params.isOfflineForm) !== \"undefined\"\r\n                    && bizagi.util.parseBoolean(self.params.isOfflineForm);\r\n            }\r\n\r\n            if (isOfflineForm) {\r\n                message = bizagi.util.getMessageFromNetworkState(self.dataService.online);\r\n            }\r\n\r\n            var infoHtml = $.kendoTmpls(infoTemplate, {\r\n                message: message\r\n            });\r\n            // Remove loading icon from summary container\r\n            infoHtml.appendTo(renderContainer);\r\n\r\n            $(\".ui-bizagi-info-message-button\", renderContainer).click(function () {\r\n                self.view.contentElement().empty();\r\n                self.mashupFacade.close();\r\n            });\r\n        }\r\n\r\n        var navbar = $(\".km-navbar\", self.view.header).data(\"kendoMobileNavBar\");\r\n        if (typeof navbar !== \"undefined\") {\r\n            var title = typeof params.displayName !== \"undefined\" ? params.displayName : (params.radNumber || params.idCase);\r\n            navbar.title(title);\r\n        }\r\n\r\n        //Call the evento to paint summaryCase\r\n        self.publish('renderSummaryCase', params);\r\n        // Keep reference to rendering facade\r\n        //self.renderingFacade = rendering;\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi CaseSummary\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.caseSummary\", {}, {\r\n    init: function (mashupFacade, dataService, params) {\r\n        this._super(mashupFacade, dataService, params);\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n\r\n        this.initialized = false;\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mashup-summary-view\");\r\n        // Render content\r\n        var content = $.kendoTmpls(template);\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.drawer = new kendo.mobile.ui.Drawer(self.content,\r\n            {\r\n                \"swipeToOpen\": false,\r\n                \"position\": \"rigth\"\r\n            }\r\n        );\r\n    },\r\n\r\n    /**\r\n     * Base event handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        self.subscribe(\"showSummary\", function () {\r\n            if (typeof self.drawer !== \"undefined\" && self.initialized) {\r\n                self.drawer.show();\r\n            } else {\r\n                bizagi.log(\"The summary case controller has not been initialized\");\r\n            }\r\n        });\r\n\r\n        self.drawer.bind(\"show\", function () {\r\n            $(\".bz-header_select\", self.canvas).trigger(\"resizeHeader\");\r\n        });\r\n\r\n        /* istanbul ignore next */\r\n        $(\"#case-summary\", self.canvas).delegate(\".summaryLink\", \"click\", function (e) {\r\n\r\n            e.preventDefault();\r\n\r\n            self.routingExecute($(this));\r\n\r\n            $($(this), self.canvas).remove();\r\n            self.cache = {};\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the tabs component of the webpart\r\n     * @param args\r\n     * @returns {*}\r\n     */\r\n    renderCurrentTab: function (args) {\r\n        var self = this;\r\n        var htmlContent = \"\";\r\n        var defer = new $.Deferred();\r\n        var params = args.params || self.params || {};\r\n\r\n        self.cache = self.cache || {};\r\n        self.data = self.data || {};\r\n\r\n        switch (args.currentTab) {\r\n            case \"#ui-bizagi-tab-assignees\":\r\n                if (typeof (self.cache[\"assignees\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.summaryAssigness({\r\n                            idCase: params.idCase\r\n                        })).done(function (assignees) {\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-assigness\")), assignees);\r\n                            self.cache[\"assignees\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n                break;\r\n            case \"#ui-bizagi-tab-comments\":\r\n                if (typeof (self.cache[\"comments\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.getComments({\r\n                            idCase: params.radNumber || params.idCase,\r\n                            idLastComment: self.Class.COMMENT_SIZE\r\n                        })).done(function (comments) {\r\n                            comments[\"showComments\"] = comments.totalRecords > 0 ? true : false;\r\n                            comments[\"timeAgo\"] = bizagi.getTimeAgo;\r\n                            comments[\"getUserName\"] = function (idUser) {\r\n                                var users = comments.users || [];\r\n                                var name = \"\";\r\n                                $.each(users, function (key, value) {\r\n                                    if (users[key][\"Id\"] == idUser) {\r\n                                        name = value.DisplayName;\r\n                                    }\r\n                                });\r\n\r\n                                return name;\r\n                            };\r\n\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-comments\")), comments);\r\n                            self.cache[\"comments\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n\r\n                break;\r\n            case \"#ui-bizagi-tab-subprocess\":\r\n                if (typeof (self.cache[\"subprocess\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.summarySubProcess({\r\n                            idCase: params.idCase\r\n                        })).done(function (subprocess) {\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-subprocess\")), subprocess);\r\n                            self.cache[\"subprocess\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n                break;\r\n            case \"#ui-bizagi-tab-events\":\r\n                if (typeof (self.cache[\"events\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.summaryCaseEvents({\r\n                            idCase: params.idCase\r\n                        })).done(function (events) {\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-events\")), events);\r\n                            self.cache[\"events\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n                break;\r\n            case \"#ui-bizagi-tab-activities\":\r\n                if (typeof (self.cache[\"activities\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.summaryActivities({\r\n                            data: self.data,\r\n                            idWorkitem: params.idWorkitem\r\n                        })).done(function (activities) {\r\n                            activities[\"idCase\"] = params.idCase;\r\n\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-activities\")), activities);\r\n                            self.cache[\"activities\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            htmlContent.delegate(\".summaryLink\", \"click\", function (e) {\r\n                                e.preventDefault();\r\n                                self.routingExecute($(this));\r\n                            });\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n                break;\r\n            default:\r\n                bizagi.loading.stop();\r\n                defer.resolve();\r\n                break;\r\n        }\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Executes routing action\r\n     */\r\n    routingExecute: function (element) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (element) {\r\n            var idCase = element.data(\"case\") || self.params.idCase;\r\n            var idWorkItem = element.data(\"workitem\");\r\n            var idTask = element.data(\"task\");\r\n            var displayName = element.data(\"displayname\") || self.params.displayName;\r\n\r\n            $(\".km-content:visible\").data(\"kendoMobileScroller\").reset();\r\n            $(\"#case-summary\").data(\"kendoMobileDrawer\").hide();\r\n\r\n\r\n            self.publish(\"renderCase\", {\r\n                idCase: idCase,\r\n                idWorkitem: idWorkItem,\r\n                idTask: idTask,\r\n                displayName: displayName\r\n            });\r\n            defer.resolve(true);\r\n\r\n        } else {\r\n            defer.resolve(false);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     * Action release\r\n     */\r\n    release: function (params) {\r\n        var self = this;\r\n        var defered = new $.Deferred();\r\n        var buttons = [\r\n            { \"label\": self.getResource(\"workportal-widget-dialog-box-release-ok\"), \"action\": \"resolve\" },\r\n            { \"label\": self.getResource(\"workportal-widget-dialog-box-release-cancel\") }\r\n        ];\r\n\r\n        $.when(bizagi.showConfirmationBox(self.getResource(\"workportal-widget-dialog-box-release\"), self\r\n                .getResource(\"render-actions-release\"), \"\", buttons))\r\n            .done(function () {\r\n\r\n                bizagi.loading.start();\r\n\r\n                $.when(self.dataService.releaseActivity({\r\n                    idCase: params.idCase,\r\n                    idWorkItem: params.idWorkitem\r\n                })).done(function (data) {\r\n\r\n                    var status = (data && data.status) ? data.status : \"Error\";\r\n\r\n                    switch (status) {\r\n                        case \"Success\":\r\n                            //bizagi.kendoMobileApplication.navigate(\"homePortal\"); //TODO:Review taskFeed\r\n                            self.publish(\"renderActionButton\", { actions: [\"release\", \"routing\"] });\r\n                            self.publish(\"renderCase\", {\r\n                                action: \"routing\",\r\n                                idCase: params.idCase,\r\n                                idWorkitem: params.idWorkitem\r\n                            });\r\n                            //Show message on rubik\r\n                            break;\r\n                        case \"ConfigurationError\":\r\n                            bizagi.showMessageBox(self\r\n                                .getResource(\"workportal-widget-dialog-box-release-configuration-error-message\")\r\n                                .replace(\"{0}\", params.idWorkitem), self\r\n                                .getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n                            break;\r\n                        case \"Error\":\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-dialog-box-release-error-message\")\r\n                                .replace(\"{0}\", params.idWorkitem), self\r\n                                .getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n\r\n                    bizagi.loading.stop();\r\n\r\n                    defered.resolve();\r\n                }).fail(function () {\r\n                    var message = self.getResource(\"workportal-widget-dialog-box-release-error-message\").replace(\"{0}\",\r\n                        params.idWorkitem);\r\n                    bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"),\r\n                        \"error\", false);\r\n                    bizagi.loading.stop();\r\n                    defered.reject();\r\n                });\r\n            });\r\n        return defered.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal new Case Controller\r\n *   Author: RicardoPD on 2/16/2017.\r\n *   Comments:\r\n *      - this script will allow the bizagi case creation\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.newCase\", {}, {\r\n\r\n\r\n    /**\r\n     * Constructor\r\n     * @param mashupFacade\r\n     * @param dataService\r\n     * @param params\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n\r\n        self.loadTemplates({\r\n            \"mashup-newcase-modal-multiorganization\": bizagi.getTemplate(\"bizagi.mashup.common.newCase\").concat(\"#mashup-newcase-multiorganization\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    /**\r\n     * This controller haven''t a visual interface\r\n     */\r\n    renderContent: function () {\r\n    },\r\n\r\n    postRender: function () {\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Configures all the events implementation\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.subscribe(\"createNewCase\", function (e, params) {\r\n            if (bizagi.util.parseBoolean(bizagi.currentUser.isMultiOrganization)) {\r\n                return self.createOrganizationList(params);\r\n            }\r\n            else if (params.notification) {\r\n                if (params.isBatch) {\r\n                    return self.createNewCaseNotification(params);\r\n                } else {\r\n                    return self.hasStartForm(params);\r\n                }\r\n            }\r\n            return self.createNewCase(params);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates a simple new case\r\n     * @param newCaseParams\r\n     * @returns {jQuery.Deferred}\r\n     */\r\n    createNewCase: function (newCaseParams) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        bizagi.loading.start();\r\n\r\n        if (newCaseParams.isOfflineForm) {\r\n            var dataCase = {\r\n                idWfClass: newCaseParams.idProcess || newCaseParams.idWFClass,\r\n                displayName: newCaseParams.displayName,\r\n                isOfflineForm: newCaseParams.isOfflineForm,\r\n                categoryName: newCaseParams.categoryName\r\n            };\r\n\r\n            return self.createCase(dataCase);\r\n        } else {\r\n            $.when(self.dataService.startProcess(newCaseParams)).then(function (resultData) {\r\n                var response = self.buildCaseParameters(newCaseParams, resultData);\r\n\r\n                if (response.hasStartForm) {\r\n                    response.displayName = newCaseParams.displayName;\r\n                    self.publish(\"renderStartForm\", {params: response});\r\n                    self.mashupFacade.navigate(\"#startForm\");\r\n                } else {\r\n                    self.publish(\"renderCase\", response);\r\n                    self.mashupFacade.navigate(\"#render\");\r\n                }\r\n\r\n                deferred.resolve();\r\n            }).fail(function (msg) { /* istanbul ignore next: untestable fail */\r\n                var response = $.parseJSON(msg.responseText);\r\n                bizagi.showMessageBox(response.message, \"Error\");\r\n                deferred.fail();\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n\r\n            return deferred;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Create new case for organizations\r\n     * @param newCaseParams\r\n     * @returns\r\n     */\r\n    createCase: function (newCaseParams) {\r\n        var self = this;\r\n        bizagi.loading.start();\r\n\r\n        return self.dataService.createNewCase(newCaseParams).then(function (response) {\r\n            self.publish(\"renderCase\", response);\r\n            self.mashupFacade.navigate(\"#render\");\r\n\r\n        }).fail(function (msg) {\r\n            var response = $.parseJSON(msg.responseText);\r\n            bizagi.showMessageBox(response.message, \"Error\");\r\n\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param newCaseParams\r\n     * @returns {*}\r\n     */\r\n    hasStartForm: function (newCaseParams) {\r\n        var self = this;\r\n        newCaseParams = newCaseParams || {};\r\n\r\n        if (!newCaseParams.hasStartForm && newCaseParams.isShortcut) {\r\n            return self.startShortcutProcess(newCaseParams);\r\n        } else {\r\n            return self.createNewCaseNotification(newCaseParams);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param newCaseParams\r\n     */\r\n    startShortcutProcess: function (newCaseParams) {\r\n        var self = this;\r\n        self.dataService.actionCreateCase(newCaseParams).done(function (caseResponse) {\r\n            var idCase = caseResponse.caseId;\r\n\r\n            self.dataService.getCaseAssignees({ idCase: idCase }).done(function (assignessResponse) {\r\n                var assignees = assignessResponse.assignees;\r\n                var navigateProcess = false;\r\n\r\n                if (typeof assignees !== \"undefined\" && assignees.length > 0) {\r\n                    var currentUser = bizagi.currentUser.idUser;\r\n                    var assigned = assignees.find(function (el) {\r\n                        return el.idUser == currentUser;\r\n                    });\r\n\r\n                    if (typeof assigned !== \"undefined\") {\r\n                        navigateProcess = true;\r\n                    }\r\n                }\r\n\r\n                if (navigateProcess) {\r\n                    self.publish(\"renderCase\", { action: \"routing\", idCase: idCase });\r\n                } else {\r\n                    var message = bizagi.localization\r\n                        .getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                    message = message.replace(\"{0}\", idCase);\r\n\r\n                    $.notifier.add({ text: message });\r\n                }\r\n            });\r\n        }).fail(function (msg) {\r\n            var response = $.parseJSON(msg.responseText);\r\n            bizagi.showMessageBox(response.message, \"Error\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Create list of organizations\r\n     * @param newCaseParams\r\n     * @returns\r\n     */\r\n    createOrganizationList: function (newCaseParams) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        // Initialize adjusted modalview\r\n        self.isAdjusted = false;\r\n\r\n        self.dataService.getOrganizationsList()\r\n            .done(function (data) {\r\n\r\n                var template = self.getTemplate(\"mashup-newcase-modal-multiorganization\");\r\n                var multiorganizationTemplate = kendo.template(template, { useWithBlock: false });\r\n\r\n                var multiorganizationModal = multiorganizationTemplate({\r\n                    list: data.response,\r\n                    idWfClass: newCaseParams.idProcess,\r\n                    isAdhocProcess: newCaseParams.isAdhocProcess || false\r\n                });\r\n\r\n                var modalView = $(multiorganizationModal.trim()).kendoMobileModalView({\r\n                    close: function () {\r\n                        this.destroy();\r\n                        this.element.remove();\r\n                    },\r\n                    useNativeScrolling: true,\r\n                    modal: false\r\n                }).getKendoMobileModalView();\r\n\r\n                // Configure Handler modal new Case\r\n                self.configureModalHandlers();\r\n\r\n                $(\".bz-wp-modal-organization-footer div.km-rightitem\").addClass(\"inactive\");\r\n\r\n                modalView.open();\r\n\r\n                /* istanbul ignore next: untestable */\r\n                modalView.adjustSize = function () {\r\n                    // Adjust summary popup to window size\r\n                    var maxHeight;\r\n                    var listHeight = $(\".bz-wp-modal-organization-list\", this.element).height();\r\n\r\n                    // Do nothing\r\n                    if (listHeight === 0) return;\r\n\r\n                    var maxWidth = $(\".bz-wp-modal-organization-content\", this.element).width();\r\n                    var popupHeight = $(\".bz-wp-modal-organization-header\", this.wrapper).height() +\r\n                        $(\".bz-wp-modal-organization-footer\", this.wrapper).height();\r\n                    var windowHeightSize = window.innerHeight;\r\n                    var windowWidthSize = window.innerWidth;\r\n\r\n                    if (listHeight + popupHeight >= windowHeightSize) {\r\n                        maxHeight = windowHeightSize - 20;\r\n                    } else {\r\n                        maxHeight = listHeight + popupHeight;\r\n\r\n                        if (bizagi.util.detectDevice() !== \"tablet_ios\") {\r\n                            maxHeight += !self.isAdjusted ? 20 : (Math.abs(window.orientation) === 90) ? 8 : 35;\r\n                        } else {\r\n                            maxHeight += (Math.abs(window.orientation) === 90) ? 20 : 22;\r\n                        }\r\n                    }\r\n\r\n                    var top = (windowHeightSize - maxHeight) / 2;\r\n                    var left = (windowWidthSize - maxWidth) / 2;\r\n\r\n                    this.wrapper.parent().css(\"top\", top);\r\n                    this.wrapper.parent().css(\"left\", left);\r\n                    this.wrapper.parent().css(\"height\", maxHeight);\r\n\r\n                    self.isAdjusted = true;\r\n                };\r\n\r\n                modalView.adjustSize();\r\n\r\n                /* istanbul ignore next: untestable */\r\n                window.addEventListener(\"orientationchange\", function () {\r\n                    if (bizagi.util.isAndroidDevice()) {\r\n                        setTimeout(function () {\r\n                            modalView.adjustSize();\r\n                        }, 500);\r\n                    } else {\r\n                        modalView.adjustSize();\r\n                    }\r\n                }, false);\r\n\r\n                deferred.resolve();\r\n            }).fail(function (msg) {\r\n            var message;\r\n            var responseText = msg.responseText;\r\n\r\n            try {\r\n                message = JSON.parse(responseText);\r\n                message = message.message || responseText;\r\n            } catch (e) {\r\n                message = responseText;\r\n            }\r\n\r\n            bizagi.showMessageBox(message, \"Error\");\r\n            deferred.fail();\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n\r\n        return deferred;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param newCaseParams\r\n     * @returns {jQuery.Deferred}\r\n     */\r\n    createNewCaseNotification: function(newCaseParams) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        if (newCaseParams.hasStartForm) {\r\n            self.publish(\"renderStartForm\", {params: newCaseParams });\r\n            self.mashupFacade.navigate(\"#startForm\");\r\n\r\n            bizagi.loading.stop();\r\n\r\n            deferred.resolve();\r\n        } else {\r\n            self.dataService.actionCreateCase(newCaseParams)\r\n                .done(function(resp) {\r\n                    var mapping = newCaseParams.mapping || {};\r\n                    var type = newCaseParams.type || \"Process\";\r\n\r\n                    var response = {\r\n                        showProcess: false,\r\n                        isMultiInstance: newCaseParams.isMultiInstance,\r\n                        notification: true,\r\n                        hasStartForm: resp.hasStartForm,\r\n                        idProcess: resp.idProcess,\r\n                        displayName: newCaseParams.displayName,\r\n                        mapping: mapping,\r\n                        type: type,\r\n                        idParentCase: newCaseParams.idParentCase\r\n                    };\r\n\r\n                    $.extend(response, resp.caseInfo);\r\n\r\n                    if (newCaseParams.isBatch) {\r\n                        var message = bizagi.localization\r\n                            .getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                        message = message.replace(\"{0}\", resp.caseNumber);\r\n\r\n                        var title = printf(bizagi.localization\r\n                            .getResource(\"workportal-widget-templateengine-message-summary-create-cases-singular\"), 1);\r\n                        $.notifier.add({ title: title, text: message, sticky: true });\r\n\r\n\r\n                        bizagi.loading.stop();\r\n                    } else { /* istanbul ignore next: untestable fail */\r\n                        self.dataService.getCaseAssignees({ idCase: resp.caseId })\r\n                            .done(function(response) {\r\n                                var assignees = response.assignees;\r\n                                var navigateProcess = false;\r\n\r\n                                if (typeof assignees !== \"undefined\" && assignees.length > 0) {\r\n                                    var currentUser = bizagi.currentUser.idUser;\r\n                                    var assigned = assignees.find(function(el) {\r\n                                        return el.idUser == currentUser;\r\n                                    });\r\n\r\n                                    if (typeof assigned !== \"undefined\") {\r\n                                        navigateProcess = true;\r\n                                    }\r\n                                }\r\n\r\n                                bizagi.loading.stop();\r\n\r\n                                if (navigateProcess) {\r\n                                    self.publish(\"render-case\", { action: \"routing\", idCase: resp.caseId });\r\n                                } else {\r\n                                    var message = bizagi.localization\r\n                                        .getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                                    message = message.replace(\"{0}\", resp.caseNumber);\r\n                                    var title = printf(bizagi.localization\r\n                                        .getResource(\"workportal-widget-templateengine-message-summary-create-cases-singular\"), 1);\r\n                                    $.notifier.add({ title: title, text: message, sticky: true });\r\n                                }\r\n                            });\r\n                    }\r\n\r\n                    deferred.resolve();\r\n                }).fail(function(msg) { /* istanbul ignore next: untestable fail */\r\n                var response = $.parseJSON(msg.responseText);\r\n                bizagi.loading.stop();\r\n\r\n                $.notifier.add({\r\n                    title: \"Error\",\r\n                    class_name: \"error\",\r\n                    text: response.message,\r\n                    sticky: true\r\n                });\r\n\r\n                deferred.fail();\r\n            });\r\n        }\r\n        return deferred;\r\n    },\r\n\r\n    /**\r\n     * Configure events handler\r\n     * @returns {}\r\n     */\r\n    configureModalHandlers: function() {\r\n        var self = this;\r\n\r\n        /* Modal Summary*/\r\n        // .bz-wp-modal-organization-close\r\n        $(\".bz-wp-modal-organization\").delegate(\".bz-wp-modal-organization-footer .km-leftitem\", \"click\",\r\n            function() {\r\n                $(\".bz-wp-modal-organization\").data(\"kendoMobileModalView\").close();\r\n            });\r\n\r\n        $(\".bz-wp-modal-organization\").delegate(\".bz-wp-modal-organization-list > li\", \"click\", function(event) {\r\n            var item = $(event.target);\r\n\r\n            // Remove others selected\r\n            $(\".bz-wp-modal-organization-list > li\").removeClass(\"bz-wp-modal-organization-list-item-selected\");\r\n\r\n            // Enable Create new case\r\n            if ($(\".bz-wp-modal-organization-footer div.km-rightitem\").hasClass(\"inactive\")) {\r\n                $(\".bz-wp-modal-organization-footer div.km-rightitem\").removeClass(\"inactive\");\r\n                $(\".bz-wp-modal-organization-footer div.km-rightitem\").addClass(\"active\");\r\n            }\r\n\r\n            // Selected item\r\n            item.addClass(\"bz-wp-modal-organization-list-item-selected\");\r\n        });\r\n\r\n        // .bz-wp-modal-organization-newcase\r\n        $(\".bz-wp-modal-organization\").delegate(\".bz-wp-modal-organization-footer .km-rightitem\", \"click\",\r\n            function(event) {\r\n                event.stopPropagation();\r\n\r\n                // If not selected item not action\r\n                if ($(\".bz-wp-modal-organization-footer div.km-rightitem\").hasClass(\"inactive\")) return;\r\n\r\n                bizagi.loading.start();\r\n\r\n                var modalContext = $(this).closest(\".bz-wp-modal-organization\");\r\n                var isAdhocProcess = modalContext.data(\"adhoc\");\r\n                var caseNumber = modalContext.data(\"workflow\");\r\n                var idOrganization = $(\".bz-wp-modal-organization-list-item-selected\").data(\"id\") || null;\r\n\r\n                var newCaseParams = {};\r\n                if (isAdhocProcess) {\r\n                    newCaseParams.idProcess = caseNumber;\r\n                    return self.createNewCase(newCaseParams);\r\n                } else {\r\n                    newCaseParams.idWfClass = caseNumber;\r\n                    newCaseParams.idOrganization = idOrganization;\r\n                    return self.createCase(newCaseParams);\r\n                }\r\n            });\r\n    },\r\n\r\n    buildCaseParameters: function (newCaseParams, data) {\r\n        var response;\r\n\r\n        if (data.oldVersion) {\r\n            response = data;\r\n            response[\"hasStartForm\"] = (newCaseParams.isOfflineForm ? false : data.hasStartForm) || false;\r\n            response[\"displayName\"] = newCaseParams.displayName;\r\n        } else {\r\n            var mapping = newCaseParams.mapping || {};\r\n            var type = newCaseParams.type || \"Process\";\r\n\r\n            response = {\r\n                showProcess: true,\r\n                isMultiInstance: newCaseParams.isMultiInstance,\r\n                hasStartForm: newCaseParams.isOfflineForm ? false : data.hasStartForm,\r\n                idProcess: data.idProcess,\r\n                displayName: newCaseParams.displayName,\r\n                mapping: mapping,\r\n                type: type,\r\n                idParentCase: newCaseParams.idParentCase\r\n            };\r\n\r\n            $.extend(response, data.caseInfo);\r\n        }\r\n\r\n        return response;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Main Controller\r\n *   Author: RicardoPD on 2/16/2017.\r\n *   Comments:\r\n *      - this script will allow the bizagi case creation with start form\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.startForm\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param mashupFacade\r\n     * @param dataService\r\n     * @param params\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(mashupFacade, dataService, params);\r\n    },\r\n    /**\r\n     * This controller haven''t a visual interface\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mashup-start-form\");\r\n        // Render content\r\n        return $.kendoTmpls(template, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.view = new kendo.mobile.ui.View(self.content, { \"useNativeScrolling\": true });//self.initNavigation();\r\n\r\n        this.configureHandlers();\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self.subscribe(\"renderStartForm\", function (e, params) {\r\n            return self.renderForm(params.params);\r\n        });\r\n\r\n        $(\".bz-render-back\", self.view.header).bind(\"click\", function () {\r\n            self.view.contentElement().empty();\r\n            self.mashupFacade.close();\r\n        });\r\n        \r\n        // Attach handler to render container to subscribe for routing events\r\n        self.view.content.bind(\"routing\", function (context, triggerparams) {\r\n            if (triggerparams.notification) {\r\n                var message = bizagi.localization.getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                message = message.replace(\"{0}\", triggerparams.idCase);\r\n                $.notifier.add({text: message});\r\n                self._back();\r\n            } else if (typeof triggerparams.idCase !== \"undefined\") {\r\n                // Executes routing action\r\n                var params = {\r\n                    action: \"routing\",//bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING\r\n                    idCase: triggerparams.idCase\r\n                };\r\n\r\n                self.dataService.getCaseAssignees(triggerparams).done( function (response) {\r\n                    var assignees = response.assignees;\r\n                    self._navigateProcess = false;\r\n\r\n                    if (typeof assignees !== \"undefined\" && assignees.length > 0) {\r\n                        var currentUser = bizagi.currentUser.idUser;\r\n                        var assigned = assignees.find( function (el) {\r\n                            return el.idUser == currentUser;\r\n                        });\r\n\r\n                        if (typeof assigned !== \"undefined\") {\r\n                            self._navigateProcess = true;\r\n                        }\r\n                    }\r\n\r\n                    if (self._navigateProcess) {\r\n                        bizagi.loading.start();\r\n                        $.when(self.publish(\"renderCase\", params)).done( function () {\r\n                            bizagi.loading.stop();\r\n                            self.mashupFacade.navigate(\"#render\");\r\n                        });\r\n\r\n                    } else {\r\n                        var message = bizagi.localization.getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                        message = message.replace(\"{0}\", params.idCase);\r\n\r\n                        self._refreshTemplate();\r\n\r\n                        //if(self.original_params.showConfirmation) {\r\n                        $.notifier.add({text: message, sticky: true});\r\n                        //}\r\n                        bizagi.loading.stop();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the form component of the widget\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    renderForm: function (params) {\r\n        var self = this;\r\n        self.view.content.empty();\r\n\r\n        var navbar = $(\".km-navbar\", self.view.header).data(\"kendoMobileNavBar\");\r\n        navbar.title(params.displayName);\r\n\r\n        self.original_params = params;\r\n\r\n        self._type = params.type;\r\n        self._navigateProcess = typeof(params.showProcess) !== \"undefined\" ?  params.showProcess : false;\r\n        self._origin = params.origin;\r\n\r\n        if(params.type === \"Process\"){\r\n            self._renderParams = {\r\n                h_action: params.hasStartForm ? \"LOADSTARTFORM\" : \"LOADFORM\"\r\n            };\r\n            if(typeof params.idParentCase !== \"undefined\"){\r\n                self._renderParams.h_idParentCase = params.idParentCase;\r\n            }\r\n            if(typeof params.guidProcess !== \"undefined\"){\r\n                self._renderParams.h_guidprocess = params.guidProcess;\r\n                if (typeof params.mapping === \"undefined\" && params.isShortcut) {\r\n                    self._renderParams.h_mappingstakeholders = true;\r\n                }\r\n            } else {\r\n                self._renderParams.h_idProcess = params.idProcess;\r\n            }\r\n            if(params.mapping){\r\n                for(var i = 0; i < params.mapping.length; i++){\r\n                    var map = params.mapping[i];\r\n                    if (map.surrogateKey) {\r\n                        self._renderParams[map.xpath] = JSON.stringify(map.surrogateKey);\r\n                    }\r\n                }\r\n            }\r\n        } else if (params.type === \"Form\") {\r\n            self._renderParams = {\r\n                h_action: \"LOADENTITYFORM\",\r\n                h_contexttype: \"entity\",\r\n                h_guidEntity: params.entityGuid,\r\n                h_guidForm: params.formGuid,\r\n                h_showDisabled: false,\r\n                h_readonlyform: params.readonlyform\r\n            };\r\n            if (params.entitySurrogateKey !== null) {\r\n                self._renderParams.h_surrogateKey = params.entitySurrogateKey;\r\n            }\r\n            if (typeof(params.mapping) !== \"undefined\" && params.mapping !== null) {\r\n                self._renderParams.h_mapping = JSON.stringify(params.mapping);\r\n            }\r\n        }\r\n\r\n        // Load render page\r\n        /* istanbul ignore if: rendering is declared on unit test */\r\n        if (typeof self.rendering === \"undefined\") {\r\n            var proxyPrefix = params.proxyPrefix || self.dataService.serviceLocator.proxyPrefix;\r\n            bizagi.rendering.facade.extend(\"bizagi.rendering.startFormFacade\", {}, {\r\n                process: function (params) {\r\n                    return this._super(params).then(function (form) {\r\n                        self._form = form;\r\n                        self.changeButtons(params.origin);\r\n                        return form;\r\n                    });\r\n                }\r\n            });\r\n            self.navigation = new bizagi.mashup.controller.navigation(self);\r\n            self.rendering = new bizagi.rendering.startFormFacade({ \"proxyPrefix\": proxyPrefix });\r\n        }\r\n\r\n        bizagi.util.setContext({\r\n            idCase: params.idCase || null,\r\n            displayName: params.displayName || params.taskName,\r\n            caseNumber: params.caseNumber || null\r\n        });\r\n\r\n\r\n        return $.when(self.dataService.getForm(self._renderParams)).then(function(data){\r\n            return self.rendering.execute({\r\n                data: data,\r\n                navigation: self.navigation,\r\n                originalParams: params,\r\n                postRenderEdit: self.postRenderEdit.bind(self),\r\n                getTemplate: self.getTemplate,\r\n                canvas: self.view.content,\r\n                type: \"\"\r\n            });\r\n        }).done(function(){\r\n            self.view.scroller.reset();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * edit Items on render\r\n     */\r\n    postRenderEdit: function () {\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @private\r\n     */\r\n    changeButtons: function() {\r\n        var self = this;\r\n        var form = self._form;\r\n        var originalProcessButton = form.processButton;\r\n\r\n        if (form) {\r\n            form.processButton = function(buttonProperties) {\r\n                if (buttonProperties.action === \"cancel\") {\r\n                    form.endLoading();\r\n                    self._back();\r\n                } else {\r\n                    bizagi.loading.start();\r\n\r\n                    if (typeof self._renderParams.h_surrogateKey !== \"undefined\") {\r\n                        form.properties.surrogateKey = self._renderParams.h_surrogateKey;\r\n                    }\r\n                    form.properties.contextType = self._renderParams.h_contexttype;\r\n\r\n                    if (form.validateForm()) {\r\n                        $.forceCollectData = true;\r\n                        $.when(originalProcessButton.apply(form, arguments)).then(function () {\r\n\r\n                            if (typeof (self._renderParams.h_surrogateKey) !== \"undefined\" || typeof (self._renderParams.h_mapping) !== \"undefined\") {\r\n                                self.refreshTemplate();\r\n                            }\r\n\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                            $.forceCollectData = false;\r\n                        });\r\n                    }\r\n                    else{\r\n                        bizagi.loading.stop();\r\n                    }\r\n                }\r\n            };\r\n            if (self._type === \"Form\") {\r\n                form.bind(\"refresh\", function(){\r\n                    bizagi.loading.stop();\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @private\r\n     */\r\n    refreshTemplate: function () {\r\n        var self = this;\r\n\r\n        if (typeof self._origin !== \"undefined\") {\r\n            var accumulatedContext = self.homePortalFramework.accumulatedContext;\r\n            var args = {\r\n                data: accumulatedContext[accumulatedContext.length-1],\r\n                filters: [],\r\n                eventType: \"DATA-NAVIGATION\",\r\n                calculateFilters: true\r\n            };\r\n\r\n            self._back();\r\n\r\n            self.publish(\"homeportalShow\", {\"what\": self._origin, \"title\": (typeof args.data !== \"undefined\" ? args.data.displayName: \"\"), \"params\" : args, \"preventNavigate\": true});\r\n            //TODO dejar unicamente el homeportalShow con el refresh cuando se soporte la actualización de un solo resgitro\r\n            //self.publish(\"homeportalShow\", {\"what\": origin, params : {refresh:true, surrogateKey: self._renderParams.h_surrogateKey, idCase: bizagi.context.idCase}});\r\n        } else {\r\n            self._back();\r\n        }\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Workportal entity Templates Controller\r\n *   Author: RicardoPD on 2/16/2017.\r\n *   Comments:\r\n *      - this script will paint the list of elments in an entity list - with the render - Template component.\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.entityTemplates\", {}, {\r\n    /**\r\n     * Constructor\r\n     * @param mashupFacade\r\n     * @param dataService\r\n     * @param params\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(mashupFacade, dataService, params);\r\n        self.acumContext = [];\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n    },\r\n    /**\r\n     * This controller haven''t a visual interface\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mashup-entity-templates\");\r\n        return $.kendoTmpls(template, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.view = new kendo.mobile.ui.View(self.content, {});\r\n        self.navbar = $(\".km-navbar\", self.view.header).data(\"kendoMobileNavBar\");\r\n\r\n        self.entityDataSource = new kendo.data.DataSource({\r\n            transport: {\r\n                read: function (options) {\r\n                    bizagi.loading.start();\r\n                    // make JSONP request to http://demos.telerik.com/kendo-ui/service/products\r\n                    var listParams = $.extend({\r\n                        page: options.data.page || 1,\r\n                        pageSize: options.data.pageSize || 40\r\n                    }, options.data.filter.filters[0].value);\r\n\r\n                    $.when(self.getEntities(listParams)).then(function (result) {\r\n                        self.dataCalled(result);\r\n                        options.success(result);\r\n                    }).fail(function (error) {\r\n                        options.error(error);\r\n                    }).always(function(){\r\n                        bizagi.loading.stop();\r\n                    });\r\n                }\r\n            },\r\n            schema: {\r\n                 data: \"entities\",\r\n                 total: \"totalRecords\"\r\n            },\r\n            serverFiltering: true,\r\n            serverPaging: true,\r\n            page: 1,\r\n            pageSize: self.Class.pageSize\r\n        });\r\n        \r\n        var templateLoaderPush = self.getTemplate(\"mashup-entity-templates-pull-loader\");\r\n        var templateLoaderRefresh = self.getTemplate(\"mashup-entity-templates-refresh-loader\");\r\n\r\n        self.entityList = self.content.find(\".entity-list\").kendoMobileCustomListView({\r\n            autoBind: false,\r\n            loadMore: true,\r\n            messages: {\r\n                pullTemplate: templateLoaderPush,\r\n                refreshTemplate: templateLoaderRefresh,\r\n                releaseTemplate: templateLoaderRefresh,\r\n                loadMoreText: self.getResource(\"workportal-widget-inbox-load-more\")\r\n            },\r\n            dataSource: self.entityDataSource,\r\n            template: self.getTemplate(\"mashup-entity-templates-item\"),\r\n            pullToRefresh: true,\r\n            itemBind: function (item) {\r\n                $(\".wp-tender-template-item\", item.element).append(item.data.tmpl);\r\n            }\r\n        }).getKendoMobileCustomListView();\r\n\r\n        self.configureHandlers();\r\n\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        $.when(self.engineReady).then(function () {\r\n            self.subscribe(\"dataNavigation\", function (e, params) {\r\n                self.entityDataSource.filter({field: \"data\", value: params.data});\r\n                self.entityList.scroller().reset();\r\n\r\n                //Empty the array\r\n                self.acumContext.splice(0,self.acumContext.length);\r\n\r\n                self.acumContext.push(params.data);\r\n                self.navbar.title(params.data.displayName);\r\n                self.mashupFacade.navigate(\"#entityTemplates\", \"slide\");\r\n            });\r\n\r\n            self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\r\n                self.entityDataSource.filter({field: \"data\", value: params.data});\r\n                self.entityList.scroller().reset();\r\n\r\n                self.acumContext.push(params.data);\r\n                self.navbar.title(params.data.displayName);\r\n            });\r\n        });\r\n\r\n        $(\".bz-render-back\", self.view.header).bind(\"click\", function () {\r\n            self.acumContext.splice((self.acumContext.length -1), 1);\r\n            if (self.acumContext.length > 0){\r\n                var data = self.acumContext.slice((self.acumContext.length -1), 1)[0];\r\n                self.entityDataSource.filter({field: \"data\", value: data});\r\n                self.entityList.scroller().reset();\r\n\r\n                self.navbar.title(data.displayName);\r\n            }\r\n            else{\r\n                self.mashupFacade.navigate(\"#render\", \"slide:right\");\r\n            }\r\n        });\r\n    },\r\n\r\n    getEntities: function (params) {\r\n        var self = this;\r\n        return self.getData(params).then(function (entityData) {\r\n            return self.getEntityTemplates(entityData);\r\n        });\r\n    },\r\n\r\n    getData: function (params) {\r\n        var self = this;\r\n        return self.dataService.getCollectionEntityData(params).then(function (data) {\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Invokes the template engine, to gets the custom columns\r\n     * @param entityData\r\n     * @return {Deferred}\r\n     */\r\n    getEntityTemplates: function (entityData) {\r\n        var self = this;\r\n        var templateType = (self._referenceType === \"ENTITY\") ? \"Content\" : \"List\";\r\n        var processEntities = [];\r\n\r\n        //Se crea una promesa por cada template\r\n        var promises = $.map(entityData.entities, function (entity) {\r\n            processEntities.push({ surrogateKey: entity.surrogateKey, entityId: entity.guid });\r\n            return self.engine.render($.extend(entity, { isDefaultTemplate: entity.guidTemplate === null, templateType: templateType })).then(function (renderedTemplate) {\r\n                entity.tmpl = renderedTemplate;\r\n            });\r\n        });\r\n\r\n        return $.when.apply($, promises).then(function () {\r\n            return entityData;\r\n        });\r\n    },\r\n\r\n    dataCalled: function (data) {\r\n        var self = this;\r\n        if (data.entities.length > 0) {\r\n            self.view.content.find(\".activity-empty-list\").hide();\r\n        } else {\r\n            self.view.content.find(\".activity-empty-list\").show();\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Mashup Main Controller\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.render.extend(\"bizagi.mashup.controllers.render\", {}, {\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        self.loadTemplates({\r\n            \"mashup-render-view\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-render-view\"),\r\n            \"mashup-render-layout\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-render-layout\"),\r\n            \"mashup-render-edition-view\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-render-edition-view\"),\r\n            \"mashup-info-message\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-info-message\"),\r\n            \"mashup-routing\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-routing\"),\r\n            \"mashup-async\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-async\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi mashup Main Controller\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define a base class to handle mashup layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.caseSummary.extend(\"bizagi.mashup.controllers.caseSummary\", {}, {\r\n\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        self.loadTemplates({\r\n            \"mashup-summary-view\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-view\"),\r\n            \"mashup-summary-main\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-main\"),\r\n            \"mashup-summary-subprocess\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-subprocess\"),\r\n            \"mashup-summary-comments\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-comments\"),\r\n            \"mashup-summary-assigness\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-assigness\"),\r\n            \"mashup-summary-activities\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-activities\"),\r\n            \"mashup-summary-events\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-events\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function(){\r\n        var self = this;\r\n        self._super();\r\n        self.configureHandlers();\r\n    },\r\n\r\n    /*\r\n     * Event Handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        self.subscribe(\"renderSummaryCase\", function (e, params) {\r\n            return self.renderSummary(params);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the summary component of the controller\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    renderSummary: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        self.params = params || {};\r\n        self.cache = {};\r\n\r\n        self.dataService.summaryCaseDetails({\r\n            idCase: params.idCase,\r\n            eventAsTasks: params.eventAsTasks || false,\r\n            onlyUserWorkItems: params.onlyUserWorkItems || false,\r\n            idWorkitem: params.idWorkitem,\r\n            isOfflineForm: params.isOfflineForm || false\r\n        }).done(function (data) {\r\n            var date = typeof (data.estimatedSolutionDate) !== \"undefined\" ? data.estimatedSolutionDate : data.solutionDate;\r\n            data.params = self.params;\r\n\r\n            data.group = bizagi.util.cases.getStatusTimeLabel(date);\r\n            self.data = data;\r\n\r\n            self.data.estimatedSolutionDate = bizagi.util.dateFormatter.formatDate(new Date(self.data.estimatedSolutionDate), self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n            self.data.solutionDate = bizagi.util.dateFormatter.formatDate(new Date(self.data.solutionDate), self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n            self.data.creationDate = bizagi.util.dateFormatter.formatDate(new Date(self.data.creationDate), self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n            var mainTemplate =  $.kendoTmpls(self.getTemplate(\"mashup-summary-main\"), self.data);\r\n\r\n            $(\".km-scroll-container\", self.content).empty().html(mainTemplate);\r\n            if ($(\".km-content\", self.content).data(\"kendoMobileScroller\")) {\r\n                $(\".km-content\", self.content).data(\"kendoMobileScroller\").reset();\r\n            }\r\n\r\n            /* istanbul ignore next */\r\n            $(\".ui-bizagi-container-tab\", self.content).bztabs({\r\n                activate: function (e) {\r\n                    bizagi.loading.start();\r\n\r\n                    data.currentTab = $(e.currentTarget).data(\"reference-tab\");\r\n\r\n                    self.renderCurrentTab(data);\r\n                },\r\n                tabNumber: 2\r\n            });\r\n\r\n            if ((data.currentState && data.currentState.length > 0) && (typeof (data.currentState[0].allowReleaseActivity) !== \"undefined\" && data.currentState[0].allowReleaseActivity)) {\r\n                /* istanbul ignore next */\r\n                $(\".bz-wp-summary-release\", self.content).bind(\"click\", function () {\r\n                    self.release(params);\r\n                });\r\n            }\r\n\r\n            self.initialized = true;\r\n            defer.resolve();\r\n        });\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Mashup Main Controller\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.startForm.extend(\"bizagi.mashup.controllers.startForm\", {}, {\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n\r\n        self.loadTemplates({\r\n            \"mashup-start-form\": bizagi.getTemplate(\"bizagi.mashup.common.startForm\").concat(\"#mashup-start-form\"),\r\n            \"mashup-render-edition-view\": bizagi.getTemplate(\"bizagi.mashup.common.startForm\").concat(\"#mashup-render-edition-view\"),\r\n            useNewEngine: false\r\n        });\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi mashup entityTemplates Controller\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define a base class to handle mashup layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\nbizagi.mashup.controllers.entityTemplates.extend(\"bizagi.mashup.controllers.entityTemplates\", {\r\n    pageSize: 30\r\n}, {\r\n\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        self.loadTemplates({\r\n            \"mashup-entity-templates\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates\"),\r\n            \"mashup-entity-templates-item\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates-item\"),\r\n            \"mashup-entity-templates-item-actions\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates-item-actions\"),\r\n            \"mashup-entity-templates-pull-loader\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates-pull-loader\"),\r\n            \"mashup-entity-templates-refresh-loader\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates-refresh-loader\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        var proxyPrefix = params.proxyPrefix || dataService.serviceLocator.proxyPrefix;\r\n        var templateDataService = new bizagi.render.services.service({ proxyPrefix: proxyPrefix });\r\n        var renderFactory = new bizagi.rendering.tablet.factory(templateDataService);\r\n\r\n        //Sets a promise in order to know when the template engine is loaded\r\n        self.engineReady = $.when(renderFactory.initAsyncStuff()).then(function () {\r\n            self.engine = new bizagi.templateEngine({ renderFactory: renderFactory, cache: true, forcePersonalizedColumns: false });\r\n        });\r\n    }\r\n});\r\n"]}