{"version":3,"sources":["jquery/workportal/desktop/widget/project.dashboard.menu.activity/bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.js","jquery/workportal/desktop/widget/project.content.dashboard/bizagi.workportal.desktop.widgets.project.content.dashboard.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.activity.log.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.authentication.log.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.activity.log.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.authentication.log.js","jquery/workportal/desktop/widget/project.overview/bizagi.workportal.desktop.widgets.project.overview.js","jquery/workportal/desktop/widget/project.caseState/bizagi.workportal.desktop.widgets.project.caseState.js","jquery/workportal/desktop/widget/project.activityState/bizagi.workportal.desktop.widgets.project.activityState.js","jquery/workportal/desktop/widget/project.processState/bizagi.workportal.desktop.widgets.project.processState.js","jquery/workportal/desktop/widget/project.users/bizagi.workportal.desktop.widgets.project.users.js","jquery/workportal/desktop/widget/project.subprocesses.data/bizagi.workportal.desktop.widgets.project.subprocesses.data.js","jquery/workportal/desktop/widget/project.events/bizagi.workportal.desktop.widgets.project.events.js","jquery/workportal/desktop/widget/project.subprocesses/bizagi.workportal.desktop.widgets.project.subprocesses.js","jquery/workportal/desktop/widget/project.activity.description/bizagi.workportal.project.activity.description.js"],"names":["bizagi","workportal","widgets","widget","extend","init","workportalFacade","dataService","params","self","this","_super","loadTemplates","project-dashboard-menu","getTemplate","concat","renderContent","content","$","postRender","contextsLeftSidebarCaseDashboard","forEach","context","sub","proxy","updateView","event","args","plan","idActivitySelected","undefined","clean","$content","getContent","empty","type","showContextByMenuDashboard","argsTemplate","showFormOverview","menuDashboard","showFormActivity","showCommentsOptionMenu","showFilesOptionMenu","showTimeLineOptionMenu","isAdhocProcess","util","isEnableFeature","showPlanOptionMenu","contextPlanOptionMenu","contextFormActivityOptionMenu","render","appendTo","toUpperCase","addClass","siblings","removeClass","handlerEvents","loadContentById","preventDefault","$item","target","closest","hasClass","data","when","autoSave","done","document","getLevelNavigator","pub","currentLevelNavigator","parseInt","nameItemNavigator","newLevelNavigator","localization","getResource","refreshLastItemBreadcrumb","histName","level","subMenuHandler","$comments","$files","$timeline","on","toggle","options","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","idCase","idTask","idWorkflow","idWorkItem","idWorkitem","referrer","publish","unsub","off","injector","register","project","dashboard","menu","activity","project-content-dashboard","template","setTimeout","window","trigger","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG","tmpl","BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG","log","totalPages","maxRows","maxPages","currentPage","activity.log","activity.log.general.content","activity.log.header","activity.log.detail.header","activity.log.detail.content","useNewEngine","generalContentTmpl","generalHeaderContentTmpl","detailHeaderTmpl","detailContentTmpl","logCategories","ACTIVITIES","id","serviceMethod","detailServiceMethod","selectedDetailId","ENTITIES","USERS","ADMINISTRATION","containtersID","GENERAL","DETAIL","proxyPrefix","serviceLocator","services","service","getCaseNumber","response","caseNumber","initWidget","displayNoResults","setupHeader","headerWrapper","supportedLogTypes","supportedLogTypesData","Supported","available","getFirstAvailableLogTypes","getActivityLogByCategory","bindHeaderElementInteraction","fail","error","att","x","element","categoryObj","click","selectedCategoryObj","isEmptyObject","idActualPage","pageSize","result","total","generalActivityDataValidator","showErrorAlertDialog","showMessageBox","JSON","parse","responseText","message","rows","i","length","indexOf","split","currentLogData","renderContentByCategory","generalWrapper","switchContent","pagData","getPaginationData","logCategory","logItems","setUpPagination","show","hide","e","selectedLogItemIndex","currentTarget","index","preprocessDetailRender","pagination","page","pagesArray","pagesToShow","a","push","$pager","method","bizagiPagination","maxElemShow","actualPage","listElement","clickCallBack","selectedElement","getDetailRenderParams","currentDetailLogData","renderLogDetail","attr","idWorkItemFrom","idEntity","idUser","selectedElementData","detailWrapper","renderDetailContent","logFilterWrapper","showDetailResultMessage","applyDetailFilter","val","$detailWrapper","getFilterParams","renderedTmpl","title","detailItems","remove","insertAfter","userFullName","attribDisplayName","entDisplayName","$logFilterWrapper","toLowerCase","def","Deferred","detailHeaderResult","detailContentResult","append","resolve","promise","contentToDisplay","value","authentication","authentication.log","authentication.log.fields","authentication.log.button","authentication.log.result","authentication.log.pagination","maxPageToShow","fieldsContentTmpl","buttonContentTmpl","resultContentTmpl","paginationTmpl","setupInitialData","dataType","getAuthenticationLogData","domainList","eventTypeList","subEvenTypesList","subEventTypeList","fields","subEvenTypes","setupDatePicker","setupFooterButtons","formatDate","getDateFormat","timeFormat","datetimepicker","controlType","dateFormat","currentText","closeText","timeText","hourText","capitalize","minuteText","datePickerFormat","replaceAll","search","button","widgetButtonSet","validateData","dtFrom","dtTo","dateFormatter","formatInvariant","getDateFromFormat","fieldsAreEmpty","errorMessage","domain","userName","eventSubType","displayName","eventType","pagSize","findResults","validateResponse","errorFieldName","replace","pageToShow","pag","getAuthenticationLogResult","resultList","totalRecords","records","resultTemplate","paginationHtml","pageToshow","summaryWrapper","pagerData","pages","pageNumber","html","project-overview","project-overview-no-summary-form-found","contentWidget","canvas","bind","isPropagationStopped","stopPropagation","oldrenderevent","eventMethod","addEventListener","eventer","getWorkitems","onlyUserWorkItems","workItems","url","getUrl","iframeOldRender","getCaseFormsRenderVersion","formsVersion","formsRenderVersion","renderSummaryForm","container","rendering","facade","execute","summaryForm","subscribe","renderingFacade","resizeLayout","iframe","queryString","readQueryString","each","is","load","contents","cssLocation","browser","mozilla","webkit","overview","contextsSidebarActivity","datePickerRegional","project-caseState","project-caseState-popup-release","project-caseState-remaining","releaseDialogBox","formContent","plugins","popupRelease","form","buttonAccept","buttonCancel","onClickAcceptRelease","onClickCancelRelease","isFavoriteCase","isFavorite","showCaseNumber","creationDate","INVARIANT_FORMAT","creationDateObject","creationDateFormat","getFormattedDate","solutionDateObject","solutionDate","solutionDateFormat","currentDate","Date","calculateDataForTemplate","showGraphicQuery","idCaseForGraphicQuery","idWorkFlow","isAdhoc","idProcess","idAdhocProcess","showHelpUrl","helpUrl","paramsEffectiveDuration","currentUser","parseBoolean","isOpen","fromDate","getTime","toDate","differenceCreationToCurrent","relativeTime","getRelativeTime","now","relativeTimeState","colorStateCase","percentCompleteBar","contentTemplate","validateUrlWellFormed","security","menuSecurity","urlHelp","isEmpty","onClickFavorite","goToCase","showBackNextNavigation","dateObj","monthsNames","monthNames","shortMonth","getMonth","bizagiLanguage","BIZAGI_LANGUAGE","substring","datepicker","favoriteOptions","idObject","favoriteType","addFavorite","favoritesData","guidFavorite","idFavorites","delFavorite","open","onSelectMenu","ui","find","item","onClickMenuReasign","onClickMenuRelease","loader","startAndThen","then","widgetName","BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE","closeVisible","maximize","modalParameters","width","dialog","resizable","draggable","height","modal","close","detach","releaseActivity","status","currentInboxView","callGetEffectiveDuration","d","getEffectiveDuration","cntxtSidebarActivity","getBackCase","getNextCase","getListKey","lstIdCases","key","nextCase","backCase","caseState","project-activityState-wrapper","currentState","currentWorkitem","filter","objectWorkItem","activityName","state","activityIsEvent","isEvent","initDateObject","entryDateWorkItem","initDateFormat","estimatedSolutionDateObject","estimatedSolutionDate","estimatedSolutionDateFormat","updateTemplateWidget","initilizeActionMenu","allowsReassign","j","btReassing","btShareActivity","onClickShareActivity","getShareActivity","notifier","parent","get","unbind","showSucessMessage","showErrorMessage","always","diffMillisecondsCurrentToEstimated","diffMillisecondsCreationToSolution","paramsEffectiveDurationOpened","currentDateExceededEstimatedDate","paramsEffectiveDurationInitialToEstimated","differenceCreatedToCurrent","differenceCurrentToEstimated","differenceInitialToEstimated","colorState","showEstimatedSolutionDate","percentBar","getPercentBar","percent","canShareActivity","isShared","totalMinutes","sectionMinutes","Math","round","override","enableShareActivity","shareActivityTooltip","activityButton","texto","tooltip","tooltipClass","position","my","at","of","collision","activityState","project-process-state","onClickGoToParentCase","routingExecute","processState","relatedusers","users","loadedUsers","project-users","onRenderFinish","showCreatorInformation","typesAssignUser","createdBy","userId","typeName","userIds","getUsersData","user","userInfo","usersAdapter","createJsonUserInfo","name","username","picture","email","getInitials","userinformation","responseSubprocessState","responseSubprocess","newValue","auxArrayListSubprocessesState","auxArrayListSubprocesses","newItem","jQuery","isArray","Class","project-subprocesses-tootip-custom-properties","initializeTooltip","selectorTooltip","indexSubprocess","idCustData","text","itemsFinded","getContentTooltip","$id","not","hover","stop","fadeTo","fadeOut","textLI","templateTooltip","rowCustomProperty","nameProperty","valueProperty","arrayCustomsProperties","auxValueProperty","subprocessData","getSubprocessData","custData","custDataTypes","custFields","formatMonetaryCell","formatBoolean","formatDecimalCell","objectTemplate","nameSubprocess","contentTableCustomProperties","subProcessData","subProcess","subProcesses","subProcPersonalized","customFields","CustFields","Object","keys","subprocesses","project-events","getArgsTemplate","responseArgsTemplate","onClickGoEvent","callSummaryCaseEvents","responseEvents","elementEvent","summaryCaseEvents","events","project-subprocesses","summarySubProcess","organizeDataForSubprocesses","showSubProcess","tempSubprocesses","radNumber","renderWidget","onClickGoSubprocess","pluginTooltip","project-activity-description","description","getWorkitemDescription","tskDescription"],"mappings":"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","sourcesContent":["/*\r\n *   Name: Bizagi Workportal project Dashboard Menu Activity\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.dashboard.menu.activity\", {}, {\r\n\r\n   /**\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n      self.params = params || {};\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-dashboard-menu\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.dashboard.menu.activity\").concat(\"#project-dashboard-menu1\")\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   /**\r\n    * links events with handlers\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      //Handlers\r\n      self.params.contextsLeftSidebarCaseDashboard.forEach(function(context){\r\n         self.sub(context, $.proxy(self.updateView, self));\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Update view\r\n    * @param event\r\n    * @param params\r\n    */\r\n   updateView: function (event, params) {\r\n      var self = this;\r\n      self.params = $.extend(self.params, params.args);\r\n      self.params.plan.idActivitySelected = undefined;\r\n      self.clean();\r\n      var $content = self.getContent().empty();\r\n\r\n      if(typeof event.type !== \"undefined\"){\r\n         self.params.showContextByMenuDashboard = event.type;\r\n      }\r\n\r\n      var argsTemplate = {\r\n         showFormOverview: self.params.menuDashboard.showFormOverview,\r\n         showFormActivity: self.params.menuDashboard.showFormActivity,\r\n         showCommentsOptionMenu: self.params.menuDashboard.showCommentsOptionMenu,\r\n         showFilesOptionMenu: self.params.menuDashboard.showFilesOptionMenu,\r\n         showTimeLineOptionMenu: self.params.menuDashboard.showTimeLineOptionMenu &&\r\n            (!self.params.isAdhocProcess ||\r\n            (self.params.isAdhocProcess && bizagi.util.isEnableFeature(\"enableTimelineOnLiveProcesses\"))),\r\n         showPlanOptionMenu: self.params.menuDashboard.showPlanOptionMenu,\r\n         contextPlanOptionMenu: self.params.menuDashboard.contextPlanOptionMenu,\r\n         contextFormActivityOptionMenu: self.params.menuDashboard.contextFormActivityOptionMenu\r\n      };\r\n\r\n      //Update widget\r\n      var template = self.getTemplate(\"project-dashboard-menu\");\r\n      template.render(argsTemplate).appendTo($content);\r\n\r\n      if(self.params.showContextByMenuDashboard){\r\n         $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\r\n      }\r\n\r\n      self.handlerEvents();\r\n   },\r\n\r\n   /**\r\n    *   Load Content By Id\r\n    */\r\n   loadContentById: function (event) {\r\n      var self = this;\r\n      event.preventDefault();\r\n      var $item = $(event.target).closest(\"li\");\r\n\r\n      if (!$item.hasClass(\"active\")) {\r\n\r\n         var showContextByMenuDashboard = $item.data(\"context\");\r\n\r\n         if (showContextByMenuDashboard) {\r\n            $.when(bizagi.util.autoSave()).done(function () {\r\n               $(document).data('auto-save', '');\r\n\r\n               var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\" });\r\n               var currentLevelNavigator = parseInt(getLevelNavigator[0], 10);\r\n               var nameItemNavigator = \"\";\r\n               var newLevelNavigator = currentLevelNavigator;\r\n\r\n               if(showContextByMenuDashboard == \"PLANACTIVITIES\"){\r\n                  newLevelNavigator = currentLevelNavigator + 1;\r\n                  nameItemNavigator = bizagi.localization.getResource(\"workportal-project-casedashboard-plan\");\r\n               }\r\n\r\n               self.params.refreshLastItemBreadcrumb = false;\r\n               self.pub(\"notify\", {\r\n                  type: showContextByMenuDashboard.toUpperCase(),\r\n                  args: $.extend(self.params, { showContextByMenuDashboard: showContextByMenuDashboard,\r\n                     histName: nameItemNavigator,\r\n                     level: newLevelNavigator })\r\n               });\r\n               $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\r\n            });\r\n         }\r\n      }\r\n   },\r\n\r\n   subMenuHandler: function () {\r\n       var self = this;\r\n       var content = self.getContent();\r\n       var $comments = $(\"[data-context='COMMENTS']\", content);\r\n       var $files = $(\"[data-context='FILES']\", content);\r\n       var $timeline = $(\"[data-context='TIMELINE']\", content);\r\n\r\n       $(\".ui-bizagi-wp-project-tab-submenu a\", content).on(\"click\", function () {\r\n           $comments.toggle();\r\n           $files.toggle();\r\n           $timeline.toggle();\r\n       });\r\n   },\r\n\r\n   /**\r\n    * Handler events\r\n    */\r\n   handlerEvents: function(){\r\n      var self = this;\r\n      var content = self.getContent();\r\n\r\n      self.subMenuHandler();\r\n\r\n      $(\".ui-bizagi-wp-project-tab-links a\", content).on(\"click\", $.proxy(self.loadContentById, self));\r\n\r\n       // Bind for click event on refresh botton\r\n       $(\".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form\", content).on(\"click\", function () {\r\n           var options = {\r\n               action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n               idCase: self.params.idCase,\r\n               idTask: self.params.idTask,\r\n               idWorkflow: self.params.idWorkflow,\r\n               idWorkItem: self.params.idWorkitem,\r\n               referrer: self.params.referrer || \"inboxGrid\"\r\n           };\r\n           self.publish(\"executeAction\", options);\r\n       });\r\n   },\r\n\r\n   /**\r\n    * Clean widgets and events\r\n    */\r\n   clean: function(){\r\n      var self = this;\r\n      var content = self.getContent();\r\n\r\n      if(self.params && self.params.contextsLeftSidebarCaseDashboard){\r\n         self.params.contextsLeftSidebarCaseDashboard.forEach(function(context){\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n         });\r\n      }\r\n\r\n      $(\".ui-bizagi-wp-project-tab-links a\", content).off();\r\n      $(\".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form\", content).off();\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu.activity\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu.activity], true);","/*\r\n *   Name: Bizagi Workportal Project Content Dashboard\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.content.dashboard\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-content-dashboard\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.content.dashboard\").concat(\"#project-plan-content-dashboard\")\r\n      });\r\n\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n\r\n      var template = self.getTemplate(\"project-content-dashboard\");\r\n      self.content = template.render({});\r\n\r\n      return self.content;\r\n   },\r\n   postRender: function(){\r\n      var self = this;\r\n\r\n      setTimeout(function(){\r\n         $(window).trigger(\"resize\"); //Simulate resize for fix when load first time.\r\n      }, 1000);\r\n\r\n   }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.content.dashboard\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.content.dashboard], true);","/**\r\n * Activiy log for  activities, entities, and users\r\n * \r\n * @author David Andrés Niño\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"activity.log\");\r\n\r\n        self.idCase = self.params.idCase;\r\n        self.idWorkflow = self.params.idWorkflow;\r\n\r\n        var content = self.content = $.tmpl(template, { idCase: self.idCase });\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Authentication log for users\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.authentication.log\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"authentication.log\");\r\n        var content;\r\n        \r\n        content = self.content = $.tmpl(template, { });\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Admin module to case massively reassign\r\n * \r\n * @author David Nino, David Romero, Edward J Morales\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.activity.log.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        self.totalPages = 0;\r\n        self.maxRows = 10;\r\n        self.maxPages = 10;\r\n        self.currentPage = 1;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"activity.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log\"),\r\n            \"activity.log.general.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-general-content\"),\r\n            \"activity.log.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-header\"),\r\n            \"activity.log.detail.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-header\"),\r\n            \"activity.log.detail.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"activity.log.general.content\");\r\n        self.generalHeaderContentTmpl = self.getTemplate(\"activity.log.header\");\r\n\r\n        self.detailHeaderTmpl = self.getTemplate(\"activity.log.detail.header\");\r\n        self.detailContentTmpl = self.getTemplate(\"activity.log.detail.content\");\r\n\r\n        //Set the keys for each type of log, the service for the general table, and detail table\r\n        self.logCategories = {\r\n            ACTIVITIES: { id: \"ActivityLog\", serviceMethod: \"getActivityLog\", detailServiceMethod: \"getActivityDetailLog\", selectedDetailId: 0 },\r\n            ENTITIES: { id: \"EntityLog\", serviceMethod: \"getEntityLog\", detailServiceMethod: \"getEntityDetailLog\", selectedDetailId: 0 },\r\n            USERS: { id: \"UserLog\", serviceMethod: \"getUserLog\", detailServiceMethod: \"getUserDetailLog\", selectedDetailId: 0 },\r\n            ADMINISTRATION: { id: \"AdminLog\", serviceMethod: \"getAdminLog\" }\r\n        };\r\n\r\n        //Sets the containers id\r\n        self.containtersID = {\r\n            GENERAL: \"general\",\r\n            DETAIL: \"detail\"\r\n        };\r\n\r\n        //Creates an instance of render Services\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n        var renderServices = new bizagi.render.services.service({ \"proxyPrefix\": proxyPrefix });\r\n\r\n        //Gets the case number using the caseId\r\n        renderServices.getCaseNumber({\r\n            idCase: self.idCase\r\n        }).done(function (response) {\r\n            var caseNumber = response.caseNumber;\r\n            self.caseNumber = caseNumber ? caseNumber : self.idCase;\r\n\r\n            self.initWidget();\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Init the widgets building each separated element\r\n    */\r\n    initWidget: function () {\r\n\r\n        var self = this;\r\n\r\n        //Hides the \"no results\" message container\r\n        self.displayNoResults(false);\r\n\r\n        //set up the header\r\n        self.setupHeader();\r\n    },\r\n\r\n    /*\r\n    *   Setup the header using the results from the service supported log types\r\n    */\r\n    setupHeader: function () {\r\n        var self = this;\r\n        content = self.getContent();\r\n\r\n        var headerWrapper = $(\"#activity-log-data-header-wrapper\", content);\r\n\r\n        $.when(self.dataService.supportedLogTypes()).done(function (supportedLogTypesData) {\r\n\r\n            //update the log types with the supported ones\r\n            $.tmpl(self.generalHeaderContentTmpl, { supportedLogTypes: supportedLogTypesData.Supported }).appendTo(headerWrapper);\r\n\r\n            //Find the first supported log type\r\n            var available = self.getFirstAvailableLogTypes(supportedLogTypesData.Supported);\r\n\r\n            //Reset  current page\r\n            self.currentPage = 1;\r\n\r\n            //Sends the object with the available log type\r\n            self.getActivityLogByCategory(self.logCategories[available]);\r\n\r\n            //Add the click events from the elements in the header\r\n            self.bindHeaderElementInteraction($(\"#LnkActivities\", self.content), self.logCategories.ACTIVITIES);\r\n            self.bindHeaderElementInteraction($(\"#LnkEntities\", self.content), self.logCategories.ENTITIES);\r\n            self.bindHeaderElementInteraction($(\"#LnkUsers\", self.content), self.logCategories.USERS);\r\n            self.bindHeaderElementInteraction($(\"#LnkAdmin\", self.content), self.logCategories.ADMINISTRATION);\r\n        }).fail(function (error) { });\r\n    },\r\n\r\n    /*\r\n    * Uses the supported log types data, finds the first element wich is available\r\n    */\r\n    getFirstAvailableLogTypes: function (supportedLogTypesData) {\r\n        var self = this;\r\n        for (var att in self.logCategories) {\r\n            for (var x in supportedLogTypesData) {\r\n                if (self.logCategories[att].id == x && (supportedLogTypesData[x] == \"true\" || supportedLogTypesData[x] == true)) {\r\n                    return att;\r\n                }\r\n            }\r\n        }\r\n\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Bind the element interaction with the category which it belongs\r\n    *   @param element (Object) DOM element which is going to be added the click event\r\n    *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n    */\r\n    bindHeaderElementInteraction: function (element, categoryObj) {\r\n        var self = this;\r\n\r\n        element.click(function () {\r\n            if (!$(this).hasClass('active')) {\r\n\r\n                $(\".active\", self.content).removeClass('active');\r\n\r\n                $(this).addClass('active');\r\n\r\n                self.currentPage = 1;\r\n                self.getActivityLogByCategory(categoryObj);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Using the categoryOjb, get the service method and call the service to retrieve the log\r\n    *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n    */\r\n    getActivityLogByCategory: function (categoryObj) {\r\n        var self = this;\r\n\r\n        var params = {};\r\n\r\n        self.selectedCategoryObj = ($.isEmptyObject(categoryObj)) ? self.selectedCategoryObj : $.extend({}, categoryObj);\r\n\r\n        params = { idCase: self.idCase, idActualPage: self.currentPage, pageSize: self.maxRows };\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n        generalWrapper.addClass(\"ui-bizagi-component-loading\");\r\n\r\n        $.when(self.dataService[self.selectedCategoryObj.serviceMethod](params)).done(function (result) {\r\n            self.totalPages = result.total;\r\n            self.generalActivityDataValidator(result);\r\n        }).fail(function (error) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            bizagi.showMessageBox(JSON.parse(error.responseText).message, \"Bizagi\", \"Error\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Validate the info gathered from the log service, and pre-render to show it in the required way\r\n    *   @param data (Object) Result from the log service\r\n    */\r\n    generalActivityDataValidator: function (data) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n\r\n        if (data.rows) {\r\n\r\n            if (self.selectedCategoryObj.id == self.logCategories.ADMINISTRATION.id) {\r\n\r\n                var i = data.rows.length, result;\r\n\r\n                while (i-- > 0) {\r\n                    if (data.rows[i][3].indexOf(\"-->\") !== -1) {\r\n                        result = [].concat(data.rows[i][3].split(\"-->\")[0].split(\":\").concat(data.rows[i][3].split(\"-->\")[1].split(\": :\")));\r\n                    } else {\r\n                        result = [].concat(data.rows[i][3].split(\"-->\")[0].split(\":\"));\r\n                    }\r\n\r\n                    data.rows[i][3] = [].concat(result);\r\n                }\r\n            }\r\n\r\n            //Stores the current data\r\n            self.currentLogData = [].concat(data.rows);\r\n        } else {\r\n            self.currentLogData = [];\r\n        }\r\n\r\n        self.renderContentByCategory();\r\n    },\r\n\r\n    /*\r\n    *   Render the content from the selected log category\r\n    */\r\n    renderContentByCategory: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n\r\n        //Removes the loading class\r\n        generalWrapper.removeClass(\"ui-bizagi-component-loading\");\r\n\r\n        //Clean the content\r\n        generalWrapper.empty();\r\n\r\n        self.switchContent(self.containtersID.GENERAL);\r\n\r\n        //Get data for pagination\r\n        var pagData = self.getPaginationData();\r\n\r\n        // Render Form\r\n        $.tmpl(self.generalContentTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, logItems: self.currentLogData, pagData: pagData }).appendTo(generalWrapper);\r\n\r\n        self.setUpPagination($(\"#biz-wp-activitylog-category-pager ul\", self.content), \"getActivityLogByCategory\");\r\n\r\n        //Show/hide the no-result message\r\n        if (self.currentLogData.length > 0) {\r\n            self.displayNoResults(false);\r\n            $(\".activity-log-table\", generalWrapper).show();\r\n        }\r\n        else {\r\n            self.displayNoResults(true);\r\n            $(\".activity-log-table\", generalWrapper).hide();\r\n        }\r\n\r\n        //Add Interactions\r\n        $(\".detail-item\", generalWrapper).click(function (e) {\r\n            e.preventDefault();\r\n\r\n            //Stores the Log  Item Index\r\n            self.selectedLogItemIndex = $($(e.currentTarget).closest(\"tr\")[0]).index() - 1;\r\n\r\n            //reset current page\r\n            self.currentPage = 1;\r\n\r\n            self.preprocessDetailRender($(this));\r\n        });\r\n\r\n        $(\".listHeaderLinks\", generalWrapper).click(function (e) {\r\n            e.preventDefault();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Get Pagination Data\r\n    */\r\n    getPaginationData: function () {\r\n\r\n        var self = this;\r\n        var pagination = (self.totalPages > 1) ? true : false;\r\n\r\n        var pagData = {\r\n            page: self.currentPage,\r\n            pagesArray: [],\r\n            pagination: pagination\r\n        };\r\n\r\n        var pagesToShow = (self.maxPages > self.totalPages) ? self.totalPages : self.maxPages;\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            pagData.pagesArray.push(a + 1);\r\n        }\r\n\r\n        return pagData;\r\n    },\r\n\r\n    /*\r\n    * SetUp Pagination\r\n    */\r\n    setUpPagination: function ($pager, method) {\r\n\r\n        var self = this;\r\n\r\n        $pager.bizagiPagination({\r\n            maxElemShow: self.maxRows,\r\n            totalPages: self.totalPages,\r\n            actualPage: self.currentPage,\r\n            listElement: $pager,\r\n            clickCallBack: function (options) {\r\n                self.currentPage = parseInt(options.page);\r\n                self[method]({}, $pager);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Render the content from the selected log item\r\n    */\r\n    preprocessDetailRender: function (selectedElement) {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var params = self.getDetailRenderParams(selectedElement);\r\n\r\n        //Checks if the selected category have the detail service, and invokes it\r\n        if (self.selectedCategoryObj.detailServiceMethod) {\r\n            $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\r\n\r\n                self.totalPages = result.total;\r\n\r\n                self.switchContent(self.containtersID.DETAIL);\r\n\r\n                //Current Log Data\r\n                if (result.rows) {\r\n                    self.currentDetailLogData = [].concat(result.rows);\r\n                }\r\n                else {\r\n                    self.currentDetailLogData = [];\r\n                }\r\n\r\n                self.renderLogDetail(result);\r\n\r\n            }).fail(function (error) { });\r\n        }\r\n    },\r\n    \r\n    /*\r\n    * Get Detail Render Params\r\n    */\r\n    getDetailRenderParams: function (selectedElement) {\r\n\r\n        var self = this;\r\n        var params, selectedDetailId;\r\n\r\n        switch (self.selectedCategoryObj.id) {\r\n            case self.logCategories.ACTIVITIES.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.ACTIVITIES.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.ACTIVITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idWorkItemFrom: selectedDetailId };\r\n\r\n                break;\r\n\r\n            case self.logCategories.ENTITIES.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.ENTITIES.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.ENTITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idEntity: selectedDetailId };\r\n\r\n                break;\r\n\r\n            case self.logCategories.USERS.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.USERS.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.USERS.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idUser: selectedDetailId };\r\n\r\n                break;\r\n        }\r\n\r\n        $.extend(params, { idActualPage: self.currentPage, pageSize: self.maxRows });\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n    *   Render the detail from the selected log item\r\n    */\r\n    renderLogDetail: function (selectedElementData) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        //Template Vars\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n        //empty previous content\r\n        detailWrapper.empty();\r\n\r\n        //removes the loading class\r\n        detailWrapper.removeClass(\"ui-bizagi-component-loading\");\r\n\r\n        //render the detail content, including headers and table\r\n        $.when(self.renderDetailContent()).done(function () {\r\n            var logFilterWrapper = $(\"#log-filter-wrapper\", content);\r\n\r\n            //Show/hide the no-result message\r\n            self.showDetailResultMessage();\r\n\r\n            //Add the interaction handlers\r\n            $(\"#back-general-content\", detailWrapper).click(function (e) {\r\n                e.preventDefault();\r\n                self.displayNoResults(false);\r\n                self.switchContent(self.containtersID.GENERAL);\r\n            });\r\n\r\n            $(\"#apply-filter\", logFilterWrapper).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                self.currentPage = 1;\r\n                self.applyDetailFilter();\r\n            });\r\n\r\n            $(\"#remove-filter\", logFilterWrapper).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                //Clean the filter inputs\r\n                $(\"input\", logFilterWrapper).val(\"\");\r\n\r\n                self.currentPage = 1;\r\n                self.applyDetailFilter();\r\n            });\r\n\r\n            $(\".listHeaderLinks\", detailWrapper).click(function (e) {\r\n                e.preventDefault();\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Show detail result message \r\n    */\r\n    showDetailResultMessage: function () {\r\n\r\n        var self = this;\r\n        var $detailWrapper = $(\"#activity-log-data-detail-wrapper\", self.getContent());\r\n\r\n        if (self.currentDetailLogData.length > 0) {\r\n            self.displayNoResults(false);\r\n            $(\".activity-log-table\", $detailWrapper).show();\r\n        }\r\n        else {\r\n            self.displayNoResults(true);\r\n            $(\".activity-log-table\", $detailWrapper).hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Apply detail filter\r\n    */\r\n    applyDetailFilter: function () {\r\n\r\n        var self = this;\r\n        var params = self.getFilterParams(), content = self.getContent();\r\n\r\n        //Checks if the selected category have the detail service, and invokes it\r\n        if (self.selectedCategoryObj.detailServiceMethod) {\r\n            $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\r\n\r\n                self.totalPages = result.total;\r\n\r\n                //Current Log Data\r\n                if (result.rows) {\r\n                    self.currentDetailLogData = [].concat(result.rows);\r\n                } else {\r\n                    self.currentDetailLogData = [];\r\n                }\r\n\r\n                //Get data for pagination\r\n                var pagData = self.getPaginationData();\r\n                var renderedTmpl = $.tmpl(self.detailContentTmpl, { logCategory: self.selectedCategoryObj.id, title: self.selectedCategoryObj.title, detailItems: self.currentDetailLogData, pagData: pagData });\r\n\r\n                //Remove table\r\n                $(\"#bz-workportal-activitylog-detailcontent-wrapper\", content).remove();\r\n                $(renderedTmpl).insertAfter(\"#activity-log-data-detail-header-wrapper\", content);\r\n\r\n                //Show/hide the no-result message\r\n                self.showDetailResultMessage();\r\n\r\n                //Set up pagination\r\n                self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", content), \"applyDetailFilter\");\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Get params for the filter\r\n    */\r\n    getFilterParams: function () {\r\n\r\n        var self = this,\r\n            content = self.getContent(),\r\n            $logFilterWrapper = $(\"#log-filter-wrapper\", content),\r\n            params = self.getDetailRenderParams(),\r\n            userFullName, attribDisplayName, entDisplayName;\r\n\r\n        if (self.selectedCategoryObj.id == self.logCategories.ENTITIES.id) {\r\n            userFullName = $(\"#filterUser\", $logFilterWrapper).val().toLowerCase();\r\n        } else if (self.selectedCategoryObj.id == self.logCategories.USERS.id) {\r\n            entDisplayName = $(\"#filterEntity\", $logFilterWrapper).val().toLowerCase();\r\n        }\r\n\r\n        attribDisplayName = $(\"#filterAttribute\", $logFilterWrapper).val().toLowerCase();\r\n\r\n        $.extend(params, { userFullName: userFullName, attribDisplayName: attribDisplayName, entDisplayName: entDisplayName });\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n    *   Renders the detail info from the selected log item\r\n    *   return (Object) returns the promise after processing and attaching to the DOM the detail from the selected log item\r\n    */\r\n    renderDetailContent: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            def = $.Deferred();\r\n\r\n        //DOM Vars\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n        //Get data for pagination\r\n        var pagData = self.getPaginationData();\r\n\r\n        //append tree to wrapper\r\n        $.when($.tmpl(self.detailHeaderTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, data: self.currentLogData[self.selectedLogItemIndex] }),\r\n                $.tmpl(self.detailContentTmpl, { logCategory: self.selectedCategoryObj.id, title: self.selectedCategoryObj.title, detailItems: self.currentDetailLogData, pagData: pagData })\r\n                 ).done(function (detailHeaderResult, detailContentResult) {\r\n\r\n                     detailWrapper.append(detailHeaderResult);\r\n                     (detailContentResult).insertAfter(\"#activity-log-data-detail-header-wrapper\", detailWrapper);\r\n\r\n                     //set up pagination\r\n                     self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", self.content), \"preprocessDetailRender\");\r\n\r\n                     def.resolve();\r\n                 });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n    *   Switch the view from general view, and detail\r\n    *   @param (string) contentToDisplay : Specifies wich element want to display, the DETAIL view or GENERAL\r\n    */\r\n    switchContent: function (contentToDisplay) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content),\r\n            detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n\r\n        if (self.containtersID.DETAIL == contentToDisplay) {\r\n            generalWrapper.hide();\r\n\r\n            detailWrapper.show();\r\n        } else {\r\n            generalWrapper.show();\r\n\r\n            detailWrapper.hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Display the \"no result\" message\r\n    */\r\n    displayNoResults: function (value) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if (value)\r\n            $(\"#activity-log-no-results\", content).show();\r\n        else\r\n            $(\"#activity-log-no-results\", content).hide();\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.activity.log', ['workportalFacade', 'dataService', bizagi.workportal.widgets.activity.log], true);","/**\r\n * Name: BizAgi Desktop Widget Authentication Log Implementation\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.authentication.log.extend(\"bizagi.workportal.widgets.authentication.log\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"authentication.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log\"),\r\n            \"authentication.log.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-fields\"),\r\n            \"authentication.log.button\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-button\"),\r\n            \"authentication.log.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-result\"),\r\n            \"authentication.log.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-pagination\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"authentication.log\");\r\n        self.fieldsContentTmpl = self.getTemplate(\"authentication.log.fields\");\r\n        self.buttonContentTmpl = self.getTemplate(\"authentication.log.button\");\r\n        self.resultContentTmpl = self.getTemplate(\"authentication.log.result\");\r\n        self.paginationTmpl = self.getTemplate(\"authentication.log.pagination\");\r\n\r\n        //load form data\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n    * Load form fields and combo's data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n        var params = [{ dataType: \"domains\" }, { dataType: \"events\" }, { dataType: \"subEvents\"}];\r\n\r\n        $.when(self.dataService.getAuthenticationLogData(params[0]),\r\n            self.dataService.getAuthenticationLogData(params[1]),\r\n            self.dataService.getAuthenticationLogData(params[2])\r\n        ).done(function (domainList, eventTypeList, subEvenTypesList) {\r\n\r\n            self.eventTypeList = eventTypeList[0].response;\r\n            self.subEventTypeList = subEvenTypesList[0].response;\r\n\r\n            var fields = $.tmpl(self.fieldsContentTmpl, { domainList: domainList[0],\r\n                eventTypeList: eventTypeList[0].response,\r\n                subEvenTypes: subEvenTypesList[0].response\r\n            });\r\n\r\n            //append fields to wrapper\r\n            content.append(fields);\r\n\r\n            self.setupDatePicker();\r\n            self.setupFooterButtons();\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Load dateTime plugin and apply to respective fields\r\n    */\r\n    setupDatePicker: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var formatDate = self.getDateFormat();\r\n        var timeFormat = bizagi.localization.getResource('timeFormat');\r\n        $(\".biz-wp-form-datepicker\", content).datetimepicker({\r\n            controlType: 'select',\r\n            dateFormat: formatDate,\r\n            timeFormat: timeFormat,\r\n            currentText: bizagi.localization.getResource(\"render-timeentry-now\"),\r\n            closeText: bizagi.localization.getResource(\"workportal-general-button-label-done\"),\r\n            timeText: bizagi.localization.getResource(\"workportal-project-plan-time-title\"),\r\n            hourText: bizagi.localization.getResource(\"reports-general-hour\").capitalize(),\r\n            minuteText: bizagi.localization.getResource(\"reports-general-minute\").capitalize()\r\n        });\r\n    },\r\n    /**\r\n     * Translate standard date format to jquery date picker\r\n     */\r\n    getDateFormat: function() {\r\n        var format = bizagi.localization.getResource('dateFormat');\r\n        var datePickerFormat = format;\r\n\r\n        // Fix month\r\n        if (datePickerFormat.indexOf(\"MMMM\") >= 0) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMMM\", \"MM\");\r\n        } else if (datePickerFormat.indexOf(\"MMM\") >= 0) {\r\n            // Month name short\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMM\", \"M\");\r\n        } else if (datePickerFormat.indexOf(\"MM\") >= 0) {\r\n            // Month two digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MM\", \"mm\");\r\n        } else if (datePickerFormat.indexOf(\"M\") >= 0) {\r\n            // Month one digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"M\", \"m\");\r\n        }\r\n        // Fix years\r\n        if (datePickerFormat.search(\"yyyy\") != -1) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"yyyy\", \"yy\");\r\n        } else {\r\n            if (datePickerFormat.search(\"yy\") != -1) {\r\n                datePickerFormat = datePickerFormat.replaceAll(\"yy\", \"y\");\r\n            }\r\n        }\r\n\r\n        datePickerFormat = datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n\r\n        return datePickerFormat;\r\n    },\r\n\r\n    /*\r\n    * Implement button behaviour\r\n    */\r\n    setupFooterButtons: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            button = $.tmpl(self.buttonContentTmpl, {});\r\n\r\n        content.append(button);\r\n\r\n        var widgetButtonSet = $(\"#authentication-log-data-buttonset\", content);\r\n\r\n        $(\"#btn-authentication-search\", widgetButtonSet).click(function (e) {\r\n            //clean old results\r\n            $(\".biz-wp-table\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n            var validateData = self.validateData();\r\n            // Next added lines intend to send the value in invariant format + H:mm to the server\r\n            var dtFrom = $(\"#sinceDate\", content).val();\r\n            var dtTo = $(\"#toDate\", content).val();\r\n            if (dtFrom != \"\") dtFrom = bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtFrom, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\");\r\n            if (dtTo != \"\") dtTo = bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtTo, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\");\r\n            if (!validateData.fieldsAreEmpty && validateData.errorMessage==\"\") {\r\n                var params = {\r\n                    action: \"AuthLog\",\r\n                    domain: $(\"#domainList\", content).val() != \"none\" ? $(\"#domainList\", content).val() : \"\",\r\n                    userName: $(\"#auth-log-user\", content).val(),\r\n                    dtFrom: dtFrom,\r\n                    dtTo: dtTo,\r\n                    eventSubType: $(\"#subEventType\", content).val() != self.subEventTypeList[0].displayName ? $(\"#subEventType\", content).val() : \"\",\r\n                    eventType: $(\"#eventType\", content).val() != self.eventTypeList[0].displayName ? $(\"#eventType\", content).val() : \"\",\r\n                    pagSize: self.maxElemShow\r\n                };\r\n\r\n                self.findResults(content, params);\r\n            } else {\r\n                bizagi.showMessageBox(validateData.errorMessage, \"Bizagi\", \"warning\");\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Validate required fields\r\n    */\r\n    validateData: function () {\r\n        var self = this,\r\n        content = self.getContent(),\r\n        validateResponse = { fieldsAreEmpty: false, errorMessage: \"\" },\r\n        errorMessage = \"\",\r\n        errorFieldName = \"\";\r\n        var dtFrom = $(\"#sinceDate\", content).val();\r\n        var dtTo = $(\"#toDate\", content).val();\r\n\r\n        if ($(\"#domainList\", content).val() == \"none\" &&\r\n            $(\"#user\", content).val() == \"\" &&\r\n            $(\"#eventType\", content).val() == self.eventTypeList[0].id &&\r\n            $(\"#subEventType\", content).val() == self.subEventTypeList[0].id &&\r\n            $(\"#sinceDate\", content).val() == \"\" &&\r\n            $(\"#toDate\", content).val() == \"\") {\r\n\r\n            validateResponse.fieldsAreEmpty = true;\r\n            validateResponse.errorMessage = bizagi.localization.getResource(\"workportal-widget-authentication-log-emptyfields-message\");\r\n        }\r\n        else if (dtFrom != \"\" && bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtFrom, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\") == \"\") {\r\n            errorFieldName = bizagi.localization.getResource(\"workportal-widget-authentication-log-datesince\");\r\n            errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n            errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n            validateResponse.errorMessage = errorMessage;\r\n        }\r\n        else if (dtTo != \"\" && bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtTo, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\") == \"\") {\r\n            errorFieldName = bizagi.localization.getResource(\"workportal-widget-authentication-log-dateto\");\r\n            errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n            errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n            validateResponse.errorMessage = errorMessage;\r\n        }\r\n        return validateResponse;\r\n    },\r\n\r\n    /*\r\n    * Find log results using the input data\r\n    */\r\n    findResults: function (content, params, pageToShow) {\r\n        var self = this;\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.pag = pageToShow : params.pag = 1;\r\n\r\n        $.when(\r\n             self.dataService.getAuthenticationLogResult(params)\r\n        ).done(function (resultList) {\r\n\r\n            //clean old results\r\n            $(\".biz-wp-table\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n\r\n            if (resultList.rows.length > 0) {\r\n                var resultTemplate = $.tmpl(self.resultContentTmpl, { resultList: resultList.rows });\r\n                content.append(resultTemplate);\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n                var summaryWrapper = $(\"#biz-wp-table-pager-wrapper\");\r\n                var pagerData = {};\r\n                var paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginationTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\"#biz-wp-table-pager-wrapper\"),\r\n                    clickCallBack: function (options) {\r\n                        self.findResults(content, params, options.page);\r\n                    }\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-authentication-log-none\"), \"Bizagi\", \"warning\");\r\n            }\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    }\r\n\r\n\r\n});","/*\r\n*   Name: Bizagi Workportal Desktop Project Overview Controller\r\n*   Author: David Romero Estrada\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.overview\", {}, {\r\n    \r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-overview\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.overview\").concat(\"#project-overview\"),\r\n            \"project-overview-no-summary-form-found\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.overview\").concat(\"#project-overview-no-summary-form-found\")\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Renders the template defined in the widget\r\n    */\r\n    renderContent: function () {\r\n\r\n        var self = this;\r\n        var template = self.getTemplate(\"project-overview\");\r\n\r\n        self.content = template.render({});\r\n        return self.content;\r\n    },\r\n\r\n    /*\r\n    * Links events with handlers\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var contentWidget = self.getContent();\r\n\r\n        var canvas = $(\"#ui-bizagi-wp-project-overview-wrapper\", contentWidget);\r\n\r\n        // Define action when render form has not been migrated\r\n        canvas.bind(\"oldrenderintegration\", function (e) {\r\n            if (e.isPropagationStopped()) {\r\n                return;\r\n            }\r\n            e.stopPropagation();\r\n\r\n            var template = self.workportalFacade.getTemplate(\"inbox-common-case-summary-oldrender\");\r\n            var data = {};\r\n\r\n            bizagi.oldrenderevent = true; // has been loaded\r\n            var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n            var eventer = window[eventMethod];\r\n            var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n\r\n            // Listen to message from child window\r\n            eventer(messageEvent, function (e) {\r\n                e.stopPropagation();\r\n                self.publish(\"executeAction\", {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: e.data\r\n                });\r\n            }, false);\r\n\r\n            // Define wirkitem and idtask\r\n            $.when(self.dataService.getWorkitems({\r\n                idCase: self.params.idCase,\r\n                onlyUserWorkItems: true\r\n            })).done(function (getWorkitems) {\r\n                // verify workitem, in some cases these variables are not available\r\n                if (typeof getWorkitems.workItems == \"object\" && getWorkitems.workItems.length >= 1) {\r\n                    // Case Open\r\n                    var idWorkitem = getWorkitems.workItems[0]['idWorkItem'];\r\n                    var idTask = getWorkitems.workItems[0]['idTask'];\r\n                    data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&idWorkitem=\" + idWorkitem + \"&idTask=\" + idTask + \"&isSummary=1\";\r\n                } else {\r\n                    // Case closed\r\n                    data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&isSummary=1\";\r\n                }\r\n\r\n                // Render content\r\n                canvas.empty();\r\n                $.tmpl(template, data).appendTo(canvas);\r\n                //Set styles\r\n                self.iframeOldRender($(\"iframe\", canvas));\r\n            });\r\n        });\r\n\r\n        var params = {\r\n            idCase: self.params.idCase\r\n        };\r\n        $.when(self.dataService.getCaseFormsRenderVersion(params))\r\n           .done(function (formsVersion) {\r\n               if (formsVersion.formsRenderVersion == 1) {\r\n                   canvas.trigger(\"oldrenderintegration\");\r\n               } else {\r\n                   self.renderSummaryForm(self.params.idCase, $(\"#ui-bizagi-wp-project-overview-wrapper\", contentWidget));\r\n               }\r\n           });\r\n    },\r\n\r\n    renderSummaryForm: function(idCase, container){\r\n        var self = this;\r\n\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n\r\n        // Load render page\r\n        var rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n\r\n        // Executes rendering into render container\r\n        rendering.execute({\r\n            canvas: container,\r\n            summaryForm: true,\r\n            idCase: idCase\r\n        });\r\n        rendering.subscribe(\"no-data-found\", function() {\r\n            var template = self.getTemplate(\"project-overview-no-summary-form-found\");\r\n            container.append(template.render());\r\n        });\r\n\r\n        // Keep reference to rendering facade\r\n        self.renderingFacade = rendering;\r\n\r\n        // Resize layout\r\n        setTimeout(function() {\r\n            self.resizeLayout();\r\n        }, 1000);\r\n    },\r\n\r\n    /**\r\n     * Inject styles and js into the iframe\r\n     */\r\n    iframeOldRender: function (canvas) {\r\n        var self = this;\r\n        var iframe;\r\n        var content = self.getContent();\r\n        var theme = \"bizagiDefault\";\r\n        var queryString = bizagi.readQueryString();\r\n\r\n        $.each(canvas, function () {\r\n            if ($(this).is(\"iframe\")) {\r\n                iframe = $(this);\r\n            }\r\n        });\r\n\r\n        iframe.load(function () {\r\n            // inject css\r\n            var content = $(this).contents();\r\n\r\n            // Fixed problem with relative path across the different browsers\r\n            var cssLocation = ($.browser.mozilla || $.browser.webkit) ? \"../../css/render_%theme%.css\" : \"css/render_%theme%.css\";\r\n\r\n            // Define theme\r\n            cssLocation = cssLocation.replace(\"%theme%\", (queryString[\"theme\"] || theme));\r\n\r\n            // Append css\r\n            $('body', content).append(\"<link type='text/css' rel='stylesheet' href='\" + cssLocation + \"'>\");\r\n\r\n            // Append javascript\r\n            //  $('head',content).append(\"<script type='text/javascript' src='../../js/renderintegration.js'></script>\");\r\n        });\r\n    }\r\n\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.overview', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.overview], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Case State Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.caseState\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n        //Regional\r\n        self.datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-caseState\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.caseState\").concat(\"#project-caseState-wrapper\"),\r\n            \"project-caseState-popup-release\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.caseState\").concat(\"#project-caseState-popup-release\"),\r\n            \"project-caseState-remaining\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.caseState\").concat(\"#project-caseState-remaining\")\r\n        });\r\n\r\n        self.releaseDialogBox = {};\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        self.content = $(\"<div></div>\");\r\n\r\n        self.releaseDialogBox.formContent = self.getTemplate(\"project-caseState-popup-release\").render({});\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /*\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var cntxtSidebarActivity = self.contextsSidebarActivity || [];\r\n        //Handlers\r\n        cntxtSidebarActivity.forEach(function (context) {\r\n            self.sub(context, $.proxy(self.updateView, self));\r\n        });\r\n\r\n        self.plugins = {};\r\n        self.plugins.popupRelease = {\r\n            form: {\r\n                buttonAccept: $(\"#button-accept-release\", self.releaseDialogBox.formContent),\r\n                buttonCancel: $(\"#button-cancel-release\", self.releaseDialogBox.formContent)\r\n            }\r\n        };\r\n\r\n        self.plugins.popupRelease.form.buttonAccept.on(\"click\", $.proxy(self.onClickAcceptRelease, self));\r\n        self.plugins.popupRelease.form.buttonCancel.on(\"click\", $.proxy(self.onClickCancelRelease, self));\r\n\r\n    },\r\n\r\n    /**\r\n     * Update view when load case\r\n     * @param event\r\n     * @param params\r\n     */\r\n    updateView: function (event, params) {\r\n        var self = this;\r\n        $.extend(self.params, params.args);\r\n        var args = params.args;\r\n        self.getContent().empty();\r\n\r\n        var argsTemplate = {};\r\n\r\n        //is Favorite Case\r\n        argsTemplate.isFavoriteCase = \"off\";\r\n        if (args.isFavorite && JSON.parse(args.isFavorite)) {\r\n            argsTemplate.isFavoriteCase = \"bz-icon-star\";\r\n        }\r\n        else {\r\n            argsTemplate.isFavoriteCase = \"bz-icon-star-outline\";\r\n        }\r\n\r\n        self.showCaseNumber(args, argsTemplate);\r\n\r\n        //Begin Calculated Remaining Date\r\n        if (args.creationDate) {\r\n            var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm\";\r\n            var creationDate = args.creationDate;\r\n            var creationDateObject = bizagi.util.dateFormatter.getDateFromFormat(creationDate, INVARIANT_FORMAT);\r\n            argsTemplate.creationDateFormat = self.getFormattedDate(creationDateObject);\r\n\r\n            var solutionDateObject = bizagi.util.dateFormatter.getDateFromFormat(args.solutionDate, INVARIANT_FORMAT);\r\n            argsTemplate.solutionDateFormat = self.getFormattedDate(solutionDateObject);\r\n\r\n            var currentDate = new Date();\r\n            self.calculateDataForTemplate(argsTemplate, creationDateObject, currentDate, solutionDateObject, args);\r\n        }\r\n        $(self.getContent()).on(\"click\", \".show-diagram-case\", function () {\r\n            var isAdhoc = false;\r\n            if (!self.params.isAdhocProcess || typeof self.params.isAdhocProcess === 'undefined') {\r\n                isAdhoc = false;\r\n            } else {\r\n                isAdhoc = true;\r\n            }\r\n            if (isAdhoc) {\r\n                self.showGraphicQuery({ idCase: self.params.idCaseForGraphicQuery || self.params.idCase, idWorkflow: self.params.idWorkFlow, isAdhoc: true, idProcess: self.params.idAdhocProcess });\r\n            } else {\r\n                self.showGraphicQuery({ idCase: self.params.idCaseForGraphicQuery || self.params.idCase, idWorkflow: self.params.idWorkFlow });\r\n            }\r\n\r\n        });\r\n\r\n        $(self.getContent()).on(\"click\", \".show-process-help\", function () {\r\n            self.showHelpUrl(self.params.helpUrl);\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Calculate percent bar\r\n     * @param argsTemplate\r\n     * @param creationDateObject\r\n     * @param currentDate\r\n     * @param solutionDateObject\r\n     * @param args\r\n     */\r\n    calculateDataForTemplate: function (argsTemplate, creationDateObject, currentDate, solutionDateObject, args) {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n\r\n        var paramsEffectiveDuration = {};\r\n        paramsEffectiveDuration.idUser = bizagi.currentUser.idUser;\r\n        if (bizagi.util.parseBoolean(args.isOpen)) {\r\n            paramsEffectiveDuration.fromDate = creationDateObject.getTime();\r\n            paramsEffectiveDuration.toDate = currentDate.getTime();\r\n        }\r\n        else {\r\n            paramsEffectiveDuration.fromDate = solutionDateObject.getTime();\r\n            paramsEffectiveDuration.toDate = currentDate.getTime();\r\n        }\r\n\r\n        var differenceCreationToCurrent = paramsEffectiveDuration.toDate - paramsEffectiveDuration.fromDate;\r\n        var relativeTime = bizagi.util.dateFormatter.getRelativeTime(new Date(Date.now() - differenceCreationToCurrent), null, false);\r\n        if (bizagi.util.parseBoolean(args.isOpen)) {\r\n            argsTemplate.relativeTimeState = bizagi.localization.getResource(\"workportal-project-case-state-opened\").replace(\"%s\", relativeTime);\r\n            argsTemplate.colorStateCase = \"Opened\";\r\n        }\r\n        else {\r\n            argsTemplate.relativeTimeState = bizagi.localization.getResource(\"workportal-project-case-state-closed\").replace(\"%s\", relativeTime);\r\n            argsTemplate.colorStateCase = \"Closed\";\r\n        }\r\n\r\n        argsTemplate.percentCompleteBar = 100;\r\n        argsTemplate.isOpen = bizagi.util.parseBoolean(args.isOpen);\r\n        //Update widget\r\n        var contentTemplate = self.getTemplate(\"project-caseState-remaining\");\r\n        contentTemplate\r\n            .render($.extend(args, argsTemplate))\r\n            .appendTo($(\"#ui-bizagi-remaining\", $content));\r\n    },\r\n\r\n    /**\r\n     * Show case number\r\n     * @param args\r\n     * @param argsTemplate\r\n     */\r\n    showCaseNumber: function (args, argsTemplate) {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n        var contentTemplate = self.getTemplate(\"project-caseState\");\r\n        var isAdhoc = false;\r\n        if (!this.params.isAdhocProcess || typeof this.params.isAdhocProcess === 'undefined') {\r\n            isAdhoc = false;\r\n        }\r\n        else {\r\n            isAdhoc = this.params.isAdhocProcess;\r\n        }\r\n\r\n        self.params.helpUrl = bizagi.util.validateUrlWellFormed(self.params.helpUrl);\r\n\r\n        contentTemplate\r\n            .render(\r\n                $.extend(\r\n                    args,\r\n                    argsTemplate,\r\n                    {\r\n                        security: bizagi.menuSecurity,\r\n                        isAdhocProcess: isAdhoc,\r\n                        urlHelp: !bizagi.util.isEmpty(self.params.helpUrl)\r\n                    }\r\n                )\r\n            )\r\n            .appendTo($content);\r\n        //Handle events\r\n        $(\".case-summary-favorite\", $content).on(\"click\", $.proxy(self.onClickFavorite, self));\r\n        // Set back and next case navigation\r\n        $(\".case-summary-back\", self.content).on(\"click\", $.proxy(self.goToCase, self, 'back'));\r\n        $(\".case-summary-next\", self.content).on(\"click\", $.proxy(self.goToCase, self, 'next'));\r\n\r\n        self.showBackNextNavigation();\r\n    },\r\n\r\n    /**\r\n     * Get Format date\r\n     * @param dateObj\r\n     * @returns {string}\r\n     */\r\n    getFormattedDate: function (dateObj) {\r\n        var self = this;\r\n        var monthsNames = self.datePickerRegional.monthNames;\r\n        var shortMonth = dateObj.getMonth();\r\n        var bizagiLanguage = BIZAGI_LANGUAGE;\r\n        if (bizagiLanguage != null && bizagiLanguage != undefined && bizagiLanguage.length > 0 && bizagiLanguage.substring(0, 2) == \"fr\")\r\n            return $.datepicker.formatDate(\"dd\", dateObj) + \" \" + monthsNames[shortMonth];\r\n        else\r\n            return monthsNames[shortMonth] + \" \" + $.datepicker.formatDate(\"dd\", dateObj);\r\n    },\r\n\r\n    /***\r\n     * Events\r\n     */\r\n    onClickFavorite: function (event) {\r\n        event.preventDefault();\r\n        var self = this;\r\n        var favoriteOptions = {};\r\n        if ($(event.target).hasClass(\"bz-icon-star-outline\")) {\r\n            favoriteOptions = {\r\n                idObject: self.params.idCase,\r\n                favoriteType: \"CASES\"\r\n            };\r\n            $.when(self.dataService.addFavorite(favoriteOptions)).done(function (favoritesData) {\r\n                self.params.guidFavorite = favoritesData.idFavorites;\r\n                $(event.target).removeClass(\"bz-icon-star-outline\");\r\n                $(event.target).addClass(\"bz-icon-star\");\r\n            });\r\n        }\r\n        else {\r\n            favoriteOptions = {\r\n                idObject: self.params.guidFavorite,\r\n                favoriteType: \"CASES\"\r\n            };\r\n            $.when(self.dataService.delFavorite(favoriteOptions)).done(function () {\r\n                $(event.target).addClass(\"bz-icon-star-outline\");\r\n                $(event.target).removeClass(\"bz-icon-star\");\r\n            });\r\n        }\r\n    },\r\n\r\n    showHelpUrl: function (urlHelp) {\r\n        window.open(urlHelp);\r\n    },\r\n\r\n    /**\r\n     Events\r\n     */\r\n    onSelectMenu: function (event, ui) {\r\n        var self = this;\r\n        if ($(event.currentTarget).find(\"i\").length === 0) {\r\n            var item = $(ui.item).data(\"item\");\r\n            switch (item) {\r\n                case \"reassing\":\r\n                    self.onClickMenuReasign();\r\n                    break;\r\n                case \"release\":\r\n                    self.onClickMenuRelease();\r\n                    break;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Executed when user reasign case\r\n     */\r\n    onClickMenuReasign: function () {\r\n        var self = this;\r\n        var idCase = self.params.idCase;\r\n        var idWorkItem = self.params.idWorkitem;\r\n        bizagi.loader.startAndThen(\"admin\").then(function () {\r\n            $.when(self.publish(\"showDialogWidget\", {\r\n                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE,\r\n                data: {\r\n                    \"idCase\": idCase,\r\n                    \"idWorkItem\": idWorkItem\r\n                },\r\n                closeVisible: false,\r\n                maximize: true,\r\n                modalParameters: {\r\n                    title: bizagi.localization.getResource(\"render-actions-reassign\"),\r\n                    width: \"910px\",\r\n                    id: \"CaseAdmin\"\r\n                }\r\n            }));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Triggered when select option from contextual menu\r\n     */\r\n    onClickMenuRelease: function () {\r\n        var self = this;\r\n        self.releaseDialogBox.formContent.dialog({\r\n            resizable: false,\r\n            draggable: false,\r\n            height: \"auto\",\r\n            width: \"660px\",\r\n            modal: true,\r\n            title: bizagi.localization.getResource(\"workportal-widget-dialog-box-release-ok\"),\r\n            maximize: true,\r\n            close: function () {\r\n                self.releaseDialogBox.formContent.dialog(\"destroy\");\r\n                self.releaseDialogBox.formContent.detach();\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n     * Triggered when user click over accept button\r\n     */\r\n    onClickAcceptRelease: function () {\r\n        var self = this;\r\n        var params = {\r\n            idCase: self.params.idCase,\r\n            idWorkItem: self.params.idWorkitem\r\n        };\r\n        $.when(self.dataService.releaseActivity(params)).done(function (data) {\r\n            var status = data.status ? data.status : \"\";\r\n            var message;\r\n            switch (status) {\r\n                case \"Success\":\r\n                    //go to inbox\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: bizagi.workportal.currentInboxView\r\n                    });\r\n                    break;\r\n\r\n                case \"ConfigurationError\":\r\n                    message = self.getResource(\"workportal-widget-dialog-box-release-configuration-error-message\").replace(\"{0}\", params.idWorkItem);\r\n                    bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n                    break;\r\n\r\n                default:\r\n                    message = self.getResource(\"workportal-widget-dialog-box-release-error-message\").replace(\"{0}\", params.idWorkItem);\r\n                    bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n                    break;\r\n            }\r\n        }).fail(function () {\r\n            var message = self.getResource(\"workportal-widget-dialog-box-release-error-message\").replace(\"{0}\", params.idWorkItem);\r\n            bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n        });\r\n        self.releaseDialogBox.formContent.dialog(\"destroy\");\r\n        self.releaseDialogBox.formContent.detach();\r\n    },\r\n\r\n    /**\r\n     * Close dialog release case\r\n     */\r\n    onClickCancelRelease: function () {\r\n        var self = this;\r\n        self.releaseDialogBox.formContent.dialog(\"destroy\");\r\n        self.releaseDialogBox.formContent.detach();\r\n    },\r\n\r\n    /**\r\n     * Call service effective duration by schedule work\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    callGetEffectiveDuration: function (params) {\r\n        var self = this;\r\n        var d = $.Deferred();\r\n\r\n        if (params.fromDate) {\r\n            $.when(\r\n                self.dataService.getEffectiveDuration(params)\r\n            ).done(function (data) {\r\n                d.resolve(data);\r\n            });\r\n        }\r\n        else {\r\n            d.resolve(null);\r\n        }\r\n\r\n        return d.promise();\r\n    },\r\n\r\n    /**\r\n     * Clean plugins and events\r\n     */\r\n    clean: function () {\r\n        var self = this;\r\n        $(\".show-diagram-case\", self.getContent()).off();\r\n        var cntxtSidebarActivity = self.contextsSidebarActivity || [];\r\n        this.params = {};\r\n        cntxtSidebarActivity.forEach(function (context) {\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n        });\r\n    },\r\n\r\n    goToCase: function (action) {\r\n        var self = this;\r\n        var idCase = (action == 'back' ? self.getBackCase() : self.getNextCase());\r\n        if (idCase > 0) {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: idCase\r\n            });\r\n        }\r\n    },\r\n\r\n    getListKey: function () {\r\n        var self = this;\r\n        bizagi.lstIdCases = bizagi.lstIdCases || {};\r\n        if (bizagi.lstIdCases.length > 1) {\r\n            for (var i = 0; i < bizagi.lstIdCases.length; i++) {\r\n                if (self.params.idCase == bizagi.lstIdCases[i]) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return -1;\r\n    },\r\n\r\n    getNextCase: function () {\r\n        var self = this;\r\n        var nextIdCase = 0;\r\n        var key = self.getListKey();\r\n\r\n        // Check if last element\r\n        if (bizagi.lstIdCases.length == (key + 1) || bizagi.lstIdCases.length == 1) {\r\n            nextIdCase = -1;\r\n        } else {\r\n            nextIdCase = bizagi.lstIdCases[key + 1];\r\n        }\r\n\r\n        return nextIdCase;\r\n    },\r\n\r\n    getBackCase: function () {\r\n        var self = this;\r\n        var prevIdCase = 0;\r\n        var key = self.getListKey();\r\n\r\n        // Check if first element\r\n        if (key == 0) {\r\n            prevIdCase = -1;\r\n        } else {\r\n            prevIdCase = bizagi.lstIdCases[key - 1] || -1;\r\n        }\r\n\r\n        return prevIdCase;\r\n    },\r\n\r\n    showBackNextNavigation: function () {\r\n        var self = this;\r\n        var nextCase = self.getNextCase();\r\n        var backCase = self.getBackCase();\r\n        nextCase <= 0 ? $(\".case-summary-next\", self.content).hide() : $(\".case-summary-next\", self.content).show();\r\n        backCase <= 0 ? $(\".case-summary-back\", self.content).hide() : $(\".case-summary-back\", self.content).show();\r\n\r\n        if (nextCase <= 0 && backCase <= 0) {\r\n            $(\".content-right-sidebar\").removeClass(\"bz-state-number--active-case\");\r\n            $(\".bz-case-navigation\").hide();\r\n        }\r\n        else {\r\n            $(\".content-right-sidebar\").addClass(\"bz-state-number--active-case\");\r\n            $(\".bz-case-navigation\").show();\r\n        }\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.caseState\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.caseState]);\r\n","/*\r\n *   Name: Bizagi Workportal Desktop Project Activity State Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activityState\", {}, {\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n      //Regional\r\n      self.datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-activityState-wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.activityState\").concat(\"#project-activityState-wrapper\")\r\n      });\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   /*\r\n    * links events with handlers\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      //Handlers\r\n      self.contextsSidebarActivity.forEach(function (context) {\r\n         self.sub(context, $.proxy(self.updateView, self));\r\n      });\r\n\r\n   },\r\n\r\n   updateView: function (event, params) {\r\n      var self = this,\r\n         args = params.args;\r\n      self.params = args;\r\n      self.getContent();\r\n\r\n      var argsTemplate = {};\r\n      var currentState = args.currentState || [];\r\n\r\n      var currentWorkitem = currentState.filter(function (objectWorkItem) { return objectWorkItem.idWorkItem == args.idWorkitem; })[0];\r\n      \r\n\r\n      if (currentWorkitem) {\r\n         argsTemplate.activityName = currentWorkitem.state;\r\n         argsTemplate.activityIsEvent = bizagi.util.parseBoolean(currentWorkitem.isEvent);\r\n\r\n\r\n         var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm\";\r\n         var initDateObject = bizagi.util.dateFormatter.getDateFromFormat(currentWorkitem.entryDateWorkItem, INVARIANT_FORMAT);\r\n         if (initDateObject.getTime) {\r\n            argsTemplate.initDateFormat = self.getFormattedDate(initDateObject);\r\n         }\r\n\r\n         var currentDate = new Date();\r\n         var estimatedSolutionDateObject = bizagi.util.dateFormatter.getDateFromFormat(currentWorkitem.estimatedSolutionDate, INVARIANT_FORMAT);\r\n         argsTemplate.estimatedSolutionDateFormat = \"\";\r\n\r\n         if (initDateObject.getTime && estimatedSolutionDateObject.getTime && currentWorkitem) {\r\n            self.calculateDataForTemplate(currentWorkitem, argsTemplate, initDateObject, currentDate, estimatedSolutionDateObject,currentState);\r\n         }\r\n         else {\r\n            //Update widget\r\n            self.updateTemplateWidget(argsTemplate,currentState);\r\n         }\r\n      }\r\n   },\r\n\r\n   initilizeActionMenu: function (currentState) {\r\n      var self = this;\r\n      var allowsReassign = false;\r\n\r\n      if (currentState && currentState.length > 0) {\r\n         for (j = 0; j < currentState.length; ++j) {\r\n            if (currentState[j] && self.params && currentState[j].idWorkItem == self.params.idWorkitem) {\r\n               allowsReassign = bizagi.util.parseBoolean(currentState[j].allowsReassign) || false;\r\n            }\r\n         }\r\n      }\r\n      var btReassing = $(\"#bt-case-action-reassing\", self.content);\r\n      var btShareActivity= $(\"#ui-bizagi-wp-project-activity-button:not(.ui-bizagi-wp-project-activity-shared)\", self.content);\r\n\r\n      if (allowsReassign) {\r\n         btReassing.show();\r\n      }\r\n      btReassing.on(\"click\", function(){\r\n         self.onClickMenuReasign();\r\n      });\r\n      btShareActivity.on(\"click\", function(){\r\n         self.onClickShareActivity();\r\n      });\r\n   },\r\n   /**\r\n     * Executed when user reasign case\r\n     */\r\n    onClickMenuReasign: function () {\r\n      var self = this;\r\n      var idCase = self.params.idCase;\r\n      var idWorkItem = self.params.idWorkitem;\r\n      bizagi.loader.startAndThen(\"admin\").then(function () {\r\n         $.when(self.publish(\"showDialogWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE,\r\n            data: {\r\n               \"idCase\": idCase,\r\n               \"idWorkItem\": idWorkItem\r\n            },\r\n            closeVisible: false,\r\n            maximize: true,\r\n            modalParameters: {\r\n               title: bizagi.localization.getResource(\"render-actions-reassign\"),\r\n               width: \"910px\",\r\n               id: \"CaseAdmin\"\r\n            }\r\n         }));\r\n      });\r\n  },\r\n\r\n   /**\r\n    * let share the activity\r\n    */\r\n   onClickShareActivity: function () {\r\n         var self = this;\r\n         var params= {\r\n            \"idWorkItem\": self.params.idWorkitem\r\n         };\r\n         var button=$(\"#ui-bizagi-wp-project-activity-button\", self.content);\r\n         button.attr(\"disabled\", true);\r\n         $.when(self.dataService.getShareActivity(params)).done(function (data) {\r\n            var notifier = window.parent.bizagi.injector.get('notifier');\r\n            if (data.value===true) {\r\n               button.addClass(\"ui-bizagi-wp-project-activity-shared\")\r\n                  .unbind(\"click\");\r\n               notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-project-activity-success-message\"), '');\r\n            } else {\r\n               notifier.showErrorMessage(bizagi.localization.getResource(\"workportal-project-activity-error-message\"), '');\r\n            }\r\n         }).always(function () {\r\n            button.attr(\"disabled\", false);\r\n         });\r\n   },\r\n\r\n   calculateDataForTemplate: function (currentWorkitem, argsTemplate, creationDateObject, currentDate, estimatedSolutionDateObject, currentState) {\r\n      var self = this;\r\n\r\n      var diffMillisecondsOpened = new Date(Date.now() - creationDateObject.getTime());\r\n      var diffMillisecondsCurrentToEstimated = (currentDate.getTime() - estimatedSolutionDateObject.getTime());\r\n      var diffMillisecondsCreationToSolution = (creationDateObject.getTime() - estimatedSolutionDateObject.getTime());\r\n\r\n      var paramsEffectiveDurationOpened = {\r\n         idUser: bizagi.currentUser.idUser,\r\n         fromDate: creationDateObject.getTime(),\r\n         toDate: Date.now()\r\n      };\r\n\r\n      var currentDateExceededEstimatedDate = false;\r\n      var paramsEffectiveDuration = {\r\n         idUser: bizagi.currentUser.idUser,\r\n         fromDate: currentDate.getTime(),\r\n         toDate: estimatedSolutionDateObject.getTime()\r\n      };\r\n      var paramsEffectiveDurationInitialToEstimated = {};\r\n      if (diffMillisecondsCurrentToEstimated > 0) {//Exceeded limit estimatedSolution\r\n         paramsEffectiveDuration.fromDate = estimatedSolutionDateObject.getTime();\r\n         paramsEffectiveDuration.toDate = currentDate.getTime();\r\n         currentDateExceededEstimatedDate = true;\r\n      }\r\n      else {\r\n         paramsEffectiveDurationInitialToEstimated.idUser = bizagi.currentUser.idUser;\r\n         paramsEffectiveDurationInitialToEstimated.fromDate = creationDateObject.getTime();\r\n         paramsEffectiveDurationInitialToEstimated.toDate = estimatedSolutionDateObject.getTime();\r\n      }\r\n\r\n      var differenceCreatedToCurrent = paramsEffectiveDurationOpened.toDate - paramsEffectiveDurationOpened.fromDate;\r\n      var differenceCurrentToEstimated = paramsEffectiveDuration.toDate - paramsEffectiveDuration.fromDate;\r\n      var differenceInitialToEstimated = diffMillisecondsCurrentToEstimated > 0 ? 0 : paramsEffectiveDurationInitialToEstimated.toDate - paramsEffectiveDurationInitialToEstimated.fromDate;\r\n\r\n      var relativeTime = bizagi.util.dateFormatter.getRelativeTime(new Date(Date.now() - differenceCreatedToCurrent), null, false);\r\n      argsTemplate.colorState = currentWorkitem.colorState;\r\n      argsTemplate.relativeTimeState = bizagi.localization.getResource(\"workportal-project-activity-state-opened\").replace(\"%s\", relativeTime);\r\n      argsTemplate.percentCompleteBar = 100;\r\n\r\n      if (diffMillisecondsCreationToSolution === 0) {\r\n         argsTemplate.showEstimatedSolutionDate = false;\r\n      }\r\n      else {\r\n         argsTemplate.showEstimatedSolutionDate = true;\r\n         if (currentDateExceededEstimatedDate === false) {\r\n            var percentBar = self.getPercentBar((differenceInitialToEstimated / 1000 / 60), (differenceCurrentToEstimated / 1000 / 60));\r\n            argsTemplate.percentCompleteBar = percentBar.percent;\r\n         }\r\n      }\r\n\r\n      if (currentWorkitem) {\r\n         argsTemplate.isEvent = bizagi.util.parseBoolean(currentWorkitem.isEvent);\r\n         argsTemplate.canShareActivity = currentWorkitem.canShareActivity;\r\n         argsTemplate.isShared = currentWorkitem.isShared;\r\n      }\r\n\r\n      argsTemplate.estimatedSolutionDateFormat = self.getFormattedDate(estimatedSolutionDateObject);\r\n\r\n      //Update widget\r\n      self.updateTemplateWidget(argsTemplate, currentState);\r\n   },\r\n\r\n   getPercentBar: function (totalMinutes, sectionMinutes) {\r\n      var response = {};\r\n      response.percent = Math.round((1 - (sectionMinutes / totalMinutes)) * 100);\r\n      return response;\r\n   },\r\n\r\n\r\n   updateTemplateWidget: function (argsTemplate, currentState) {\r\n      var self = this,\r\n         $content = self.getContent().empty();\r\n      if (bizagi.override.enableShareActivity===false) {\r\n         argsTemplate.canShareActivity=false;\r\n         argsTemplate.isShared=false;\r\n      }\r\n      //Update widget\r\n      var contentTemplate = self.getTemplate(\"project-activityState-wrapper\");\r\n      contentTemplate\r\n         .render(argsTemplate).appendTo($content);\r\n\r\n      if (currentState.length > 0) {\r\n         self.initilizeActionMenu(currentState);\r\n      }\r\n      self.shareActivityTooltip();\r\n   },\r\n\r\n   /**\r\n    * show tooltip when the activity is shared or can be\r\n    */\r\n   shareActivityTooltip: function(){\r\n      var self = this;\r\n      var activityButton=$(\"#ui-bizagi-wp-project-activity-button\", self.content);\r\n      activityButton.on('mouseenter', function () {\r\n         var texto=activityButton.hasClass(\"ui-bizagi-wp-project-activity-shared\")?\"workportal-project-activity-shared\":\"workportal-project-activity-share\";\r\n         activityButton.attr(\"title\", bizagi.localization.getResource(texto));\r\n      });\r\n      activityButton.tooltip({\r\n         tooltipClass: \"custom-tooltip-styling-bottom-bar\", \r\n         position: {\r\n            my: 'right top',\r\n            at: 'left top',\r\n            of: activityButton,\r\n            collision: 'flip'\r\n         }\r\n      });\r\n   },\r\n\r\n   getFormattedDate: function (dateObj) {\r\n      var self = this;\r\n      var monthsNames = self.datePickerRegional.monthNames;\r\n      var shortMonth = dateObj.getMonth();\r\n      var bizagiLanguage = BIZAGI_LANGUAGE;\r\n      if (bizagiLanguage != null && bizagiLanguage != undefined && bizagiLanguage.length > 0 && bizagiLanguage.substring(0, 2) == \"fr\")\r\n         return $.datepicker.formatDate(\"dd\", dateObj) + \" \" + monthsNames[shortMonth];\r\n      else\r\n         return monthsNames[shortMonth] + \" \" + $.datepicker.formatDate(\"dd\", dateObj);\r\n   },\r\n\r\n   clean: function () {\r\n      var self = this;\r\n      var cntxtSidebarActivity = self.contextsSidebarActivity || [];\r\n      this.params = {};\r\n      cntxtSidebarActivity.forEach(function (context) {\r\n         self.unsub(context, $.proxy(self.updateView, self));\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Call services\r\n    */\r\n   callGetEffectiveDuration: function (params) {\r\n      var self = this;\r\n      var d = $.Deferred();\r\n\r\n      //Fix .NET, multiple call service with same data in a few milliseconds\r\n      setTimeout(function () {\r\n         if (params.fromDate) {\r\n            $.when(\r\n               self.dataService.getEffectiveDuration(params)\r\n            ).done(function (data) {\r\n               d.resolve(data);\r\n            });\r\n         }\r\n         else {\r\n            d.resolve(null);\r\n         }\r\n      }, 200);\r\n\r\n\r\n      return d.promise();\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.activityState\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.activityState]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Process State Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.processState\", {}, {\r\n      /*\r\n       *   Constructor\r\n       */\r\n      init: function (workportalFacade, dataService, params) {\r\n         var self = this;\r\n\r\n         // Call base\r\n         self._super(workportalFacade, dataService, params);\r\n\r\n         self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n         //Load templates\r\n         self.loadTemplates({\r\n            \"project-process-state\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processState\").concat(\"#project-process-state\")\r\n         });\r\n      },\r\n\r\n      /*\r\n       * Renders the template defined in the widget\r\n       */\r\n      renderContent: function () {\r\n         var self = this;\r\n         var template = self.getTemplate(\"project-process-state\");\r\n         self.content = template.render({});\r\n         return self.content;\r\n      },\r\n\r\n      /*\r\n       * links events with handlers\r\n       */\r\n      postRender: function () {\r\n         var self = this;\r\n\r\n         //Handlers\r\n         self.contextsSidebarActivity.forEach(function(context){\r\n            self.sub(context, $.proxy(self.updateView, self));\r\n         });\r\n      },\r\n\r\n      updateView: function (event, params) {\r\n         var self = this,\r\n            args = params.args,\r\n            $content = self.getContent().empty();\r\n         self.params = args;\r\n\r\n         var argsTemplate = {};\r\n         argsTemplate[\"showParentProcess\"] = (args[\"idParentCase\"] >= 1) ? true : false;\r\n         argsTemplate[\"parentProcess\"] = {\r\n            \"displayName\": args[\"parentDisplayName\"],\r\n            \"idCase\": args[\"idParentCase\"],\r\n            \"idWorkItem\": args[\"idWorkItem\"],\r\n            \"idTask\": args[\"idTask\"] == \"0\" ? \"\" : args[\"idTask\"],\r\n            \"idWorkflow\": args[\"idWorkflowParentCase\"]\r\n         };\r\n\r\n         //Update widget\r\n         var contentTemplate = self.getTemplate(\"project-process-state\");\r\n         contentTemplate\r\n            .render($.extend(args, argsTemplate))\r\n            .appendTo($content);\r\n\r\n         //handle click\r\n\r\n         $(\"#go-to-parent-case\", $content).on(\"click\", $.proxy(self.onClickGoToParentCase, self));\r\n\r\n      },\r\n\r\n      onClickGoToParentCase: function (event) {\r\n         event.preventDefault();\r\n         var self = this;\r\n\r\n         self.routingExecute($(event.target).closest(\"#go-to-parent-case\"));\r\n      },\r\n\r\n      clean: function () {\r\n         var self = this;\r\n         self.params = {};\r\n         self.contextsSidebarActivity.forEach(function(context){\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n         });\r\n      }\r\n   }\r\n);\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.processState', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.processState]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Users Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.users\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, relatedusers, params) {\r\n        var self = this;\r\n        self.relatedusers = relatedusers;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n        self.plugins = {};\r\n        self.users = [];\r\n        self.loadedUsers = false;\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-users\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.users\").concat(\"#project-users-main\")\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        self.content = $(\"<div></div>\");\r\n        return self.content;\r\n    },\r\n\r\n    /*\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Handlers\r\n        self.contextsSidebarActivity.forEach(function(context){\r\n            self.sub(context, $.proxy(self.updateView, self));\r\n        });\r\n        self.sub('ON_RENDER_FINISH', $.proxy(self.onRenderFinish, self));\r\n    },\r\n\r\n    updateView: function (event, params) {\r\n        var self = this;\r\n        self.params = params;\r\n        setTimeout(function(){\r\n            if(self.loadedUsers === false){\r\n                self.onRenderFinish();\r\n            }\r\n        }, 500);\r\n    },\r\n\r\n    onRenderFinish: function(){\r\n        var self = this;\r\n        var args = self.params.args;\r\n        var $content = self.getContent().empty();\r\n        self.loadedUsers = true;\r\n\r\n        var contentTemplate = self.getTemplate(\"project-users\");\r\n        contentTemplate.render().appendTo($content);\r\n        self.showCreatorInformation($content);\r\n\r\n        var typesAssignUser = [{\r\n            id: args.createdBy.userId,\r\n            typeName: \"owner\"\r\n        }];\r\n\r\n        if (args.idCase > 0) {\r\n            self.relatedusers.render(self.content, \".relatedusers-wrapper\", args.idCase, typesAssignUser);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * show the information of the creator case\r\n     * @param {string} $content html conteiner\r\n     */\r\n    showCreatorInformation: function ($content) {\r\n        var self = this;\r\n        var params = {\r\n           userIds: self.params.args.createdBy.userId,\r\n           width: 50,\r\n           height: 50\r\n        };\r\n  \r\n        self.dataService.getUsersData(params).done(function (user) {\r\n            var userInfo = usersAdapter.createJsonUserInfo(\r\n                user[0].id,\r\n                user[0].name,\r\n                user[0].username,\r\n                user[0].picture?\"data:image/png;base64,\"+user[0].picture:undefined,\r\n                user[0].email,\r\n                user[0].name.getInitials(),\r\n                false,\r\n                true,\r\n                [],\r\n                []\r\n                );\r\n            $content.find(\"#ui-bizagi-wp-project-users-wrapper .ui-bizagi-wp-project-users-creator-info\").userinformation(self, { user: userInfo });\r\n        });\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n        self.loadedUsers = false;\r\n        self.contextsSidebarActivity.forEach(function(context){\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n        });\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.users\", [\"workportalFacade\", \"dataService\", \"relatedusers\", bizagi.workportal.widgets.project.users]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Subprocesses Data Tooltip\r\n *   Author: Bizagi Latam\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.subprocesses.data\", {\r\n    \r\n    responseSubprocessState: {},\r\n    responseSubprocess: function(newValue){\r\n        if(newValue){\r\n            responseSubprocessState = newValue;\r\n        }\r\n        return responseSubprocessState;\r\n    },\r\n\r\n    auxArrayListSubprocessesState: [],\r\n    auxArrayListSubprocesses: function(newItem){\r\n        if(newItem){\r\n            if(jQuery.isArray(newItem) && newItem.length === 0){\r\n                this.auxArrayListSubprocessesState.length = 0; //clean array if change reference\r\n            }\r\n            else{\r\n                return this.auxArrayListSubprocessesState.push(newItem);\r\n            }\r\n        }\r\n        else{\r\n            return this.auxArrayListSubprocessesState;\r\n        }\r\n    }\r\n}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Init static properties\r\n        self.Class.auxArrayListSubprocesses([]);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-subprocesses-tootip-custom-properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.subprocesses.data\").concat(\"#project-subprocesses-tooltip-custom-properties-wrapper\")\r\n        });\r\n    },\r\n\r\n\r\n    initializeTooltip: function (selectorTooltip) {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n\r\n        $(selectorTooltip, $content).tooltip({\r\n            position: {\r\n                collision: \"flipfit\",\r\n                my: \"right center\", at: \"left-10 center\"\r\n            },\r\n            show: null, // show immediately\r\n            content: function () {\r\n\r\n                var idCase = $(this).closest(\"li\").find(\"#idCase\").val();\r\n                var itemsFinded = self.Class.auxArrayListSubprocesses().filter(function(item){\r\n                    return item.idCase == idCase;\r\n                });\r\n\r\n                var indexSubprocess, idCustData, text;\r\n                if(itemsFinded.length > 0){\r\n                    indexSubprocess = itemsFinded[0].indexSubprocess;\r\n                    idCustData = itemsFinded[0].idCustData;\r\n                    text = $(this).text();\r\n\r\n                    return self.getContentTooltip(indexSubprocess, idCustData, text,\r\n                        self.getTemplate(\"project-subprocesses-tootip-custom-properties\"));\r\n                }\r\n\r\n                \r\n            },\r\n            open: function (event, ui) {\r\n                if (typeof (event.originalEvent) === 'undefined') {\r\n                    return false;\r\n                }\r\n                var $id = $(ui.tooltip).attr('id');\r\n                // close any lingering tooltips\r\n                $('div.ui-tooltip').not('#' + $id).remove();\r\n            },\r\n            close: function (event, ui) {\r\n                ui.tooltip.hover(function () {\r\n                    $(this).stop(true).fadeTo(400, 1);\r\n                },\r\n                    function () {\r\n                        $(this).fadeOut('400', function () {\r\n                            $(this).remove();\r\n                        });\r\n                    });\r\n            }\r\n        });\r\n    },\r\n\r\n    getContentTooltip: function (indexSubprocess, idCustData, textLI, templateTooltip) {\r\n        var self = this;\r\n\r\n        //when not show custom columns\r\n        if (idCustData == \"-1\") {\r\n            idCustData = \"0\";//So show only basic data subprocess\r\n        }\r\n\r\n        var rowCustomProperty = function (nameProperty, valueProperty) {\r\n            return {\r\n                nameProperty: nameProperty,\r\n                valueProperty: valueProperty\r\n            };\r\n        };\r\n\r\n        var arrayCustomsProperties = [];\r\n        var auxValueProperty = \"\";\r\n        var subprocessData = self.getSubprocessData(indexSubprocess, idCustData);\r\n        var custData = subprocessData.custData;\r\n        var custDataTypes = subprocessData.custDataTypes;\r\n        var custFields = subprocessData.custFields;\r\n        var displayName = subprocessData.displayName;\r\n\r\n        //subproceso\r\n        arrayCustomsProperties.push(new rowCustomProperty(bizagi.localization.getResource(\"workportal-widget-inboxcommon-subprocess\"), displayName));\r\n\r\n        //Others custom properties\r\n        if (custData.length) {\r\n            for (var i = 0; i < custData.length; i += 1) {\r\n                auxValueProperty = custData[i];\r\n                if (custDataTypes) {\r\n                    if (custDataTypes[i] == \"Money\") {\r\n                        auxValueProperty = bizagi.util.formatMonetaryCell(auxValueProperty);\r\n                    } else {\r\n                        if (custDataTypes[i] == \"Boolean\") {\r\n                            auxValueProperty = bizagi.util.formatBoolean(auxValueProperty);\r\n                        } else {\r\n                            if (custDataTypes[i] == \"Float\" || custDataTypes[i] == \"Real\") {\r\n                                auxValueProperty = bizagi.util.formatDecimalCell(auxValueProperty);\r\n                            }\r\n                            else {\r\n                                if (typeof auxValueProperty === \"function\") {\r\n                                    auxValueProperty = \"\";\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                arrayCustomsProperties.push(new rowCustomProperty(custFields[i], auxValueProperty));\r\n            }\r\n        }\r\n\r\n        //Render properties\r\n        var objectTemplate = {};\r\n        objectTemplate.arrayCustomsProperties = arrayCustomsProperties;\r\n        objectTemplate.nameSubprocess = textLI;\r\n        var contentTemplate = templateTooltip;\r\n        var contentTableCustomProperties = $('<div class=\"bizagi-custom-tooltip-subprocesses\"></div>');\r\n        contentTemplate.render(objectTemplate).appendTo(contentTableCustomProperties);\r\n\r\n        return contentTableCustomProperties.html();\r\n    },\r\n\r\n    getSubprocessData: function (indexSubprocess, idCustData) {\r\n        var self = this;\r\n        var subProcessData = {};\r\n        var subProcess = self.Class.responseSubprocess().subProcesses;\r\n        var subProcPersonalized = self.Class.responseSubprocess().subProcPersonalized;\r\n\r\n        if (subProcess && subProcess.length > 0) {\r\n            subProcessData.custData = subProcess[indexSubprocess].custData;\r\n            subProcessData.custDataTypes = subProcess[indexSubprocess].custDataTypes;\r\n            var customFields = self.Class.responseSubprocess().CustFields[idCustData];\r\n            subProcessData.custFields = customFields[Object.keys(customFields)[0]];\r\n            subProcessData.displayName = subProcess[indexSubprocess].displayName;\r\n        } else if (subProcPersonalized && Object.keys(subProcPersonalized).length > 0) {\r\n            subProcessData.custData = subProcPersonalized[0].subProcesses[indexSubprocess].custData;\r\n            subProcessData.custDataTypes = subProcPersonalized[0].subProcesses[indexSubprocess].custDataTypes;\r\n            subProcessData.custFields = subProcPersonalized[0].CustFields[0];\r\n            subProcessData.displayName = subProcPersonalized[0].subProcesses[indexSubprocess].displayName;\r\n        }\r\n        return subProcessData;\r\n    },\r\n\r\n\r\n    clean: function () {\r\n\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.subprocesses.data\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.subprocesses.data]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Events Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.project.subprocesses.data.extend(\"bizagi.workportal.widgets.project.events\", { }, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n        \"project-events\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.events\").concat(\"#project-events-wrapper\")\r\n      });\r\n    },\r\n\r\n    /*\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n      var self = this;\r\n      var template = self.getTemplate(\"project-events\");\r\n      self.content = template.render({});\r\n      return self.content;\r\n    },\r\n\r\n    /*\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n      var self = this;\r\n\r\n      //Handlers\r\n      self.contextsSidebarActivity.forEach(function (context) {\r\n        self.sub(context, $.proxy(self.updateView, self));\r\n      });\r\n    },\r\n\r\n    updateView: function (event, params) {\r\n      var self = this,\r\n        args = params.args,\r\n        $content = self.getContent().empty();\r\n      self.params = args;\r\n\r\n      $.when(self.getArgsTemplate(args)).done(function (responseArgsTemplate) {\r\n        //Update widget\r\n        var contentTemplate = self.getTemplate(\"project-events\");\r\n        contentTemplate\r\n          .render($.extend(args, responseArgsTemplate))\r\n          .appendTo($content);\r\n\r\n        $(\".list-events li.event a\", $content).on(\"click\", $.proxy(self.onClickGoEvent, self));\r\n\r\n        self.initializeTooltip(\".list-events li\");\r\n      });\r\n    },\r\n\r\n    getArgsTemplate: function (args) {\r\n      var def = $.Deferred(),\r\n        argsTemplate = {},\r\n        self = this;\r\n\r\n      //check if show event tab or not\r\n      if (args[\"countEvents\"] >= 1) {\r\n        for (var i = 0; i < args[\"currentState\"].length; i++) {\r\n          if (args[\"currentState\"][i][\"isEvent\"] == \"true\" && args[\"currentState\"][i][\"idWorkItem\"] == args.idWorkitem) {\r\n            args[\"countEvents\"] = args[\"countEvents\"] - 1;\r\n          }\r\n        }\r\n      }\r\n      argsTemplate[\"showEvents\"] = (args[\"countEvents\"] >= 1) ? true : false;\r\n\r\n      if (argsTemplate[\"showEvents\"]) {\r\n        $.when(self.callSummaryCaseEvents(args.idCase)).done(function (responseEvents) {\r\n          args[\"showEvents\"] = (responseEvents[\"events\"].length >= 1) ? true : false;\r\n\r\n          if (args[\"showEvents\"]) {\r\n            argsTemplate[\"events\"] = [];\r\n            responseEvents[\"events\"].forEach(function (elementEvent) {\r\n              argsTemplate[\"events\"].push($.extend(elementEvent[Object.keys(elementEvent)[0]],\r\n                { idWorkFlow: responseEvents[\"idWorkFlow\"] }));\r\n            });\r\n          }\r\n          def.resolve(argsTemplate);\r\n        });\r\n      }\r\n      else {\r\n        def.resolve(argsTemplate);\r\n      }\r\n      return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Events UI\r\n     */\r\n\r\n    onClickGoEvent: function (event) {\r\n      event.preventDefault();\r\n      var self = this;\r\n      $.when(bizagi.util.autoSave()).done(function () {\r\n        self.routingExecute($(event.target).closest(\"li\"));\r\n      });\r\n    },\r\n\r\n    /**\r\n     * Call services\r\n     */\r\n\r\n    /*\r\n     *  Get data for users\r\n     */\r\n    callSummaryCaseEvents: function (idCase) {\r\n      var self = this,\r\n        def = $.Deferred();\r\n\r\n      $.when(\r\n        self.dataService.summaryCaseEvents({\r\n          idCase: idCase\r\n        })\r\n      ).done(function (events) {\r\n        def.resolve(events);\r\n      });\r\n\r\n      return def.promise();\r\n    },\r\n\r\n    clean: function () {\r\n      var self = this;\r\n      this.params = {};\r\n      self.contextsSidebarActivity.forEach(function (context) {\r\n        self.unsub(context, $.proxy(self.updateView, self));\r\n      });\r\n    }\r\n  }\r\n);\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.events', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.events], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Subprocesses Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.project.subprocesses.data.extend(\"bizagi.workportal.widgets.project.subprocesses\", {\r\n\r\n    responseSubprocess: function (newValue) {\r\n        return this._super(newValue);\r\n    },\r\n\r\n    auxArrayListSubprocesses: function (newValue) {\r\n        return this._super(newValue);\r\n    }\r\n\r\n}, {\r\n        /*\r\n         *   Constructor\r\n         */\r\n        init: function (workportalFacade, dataService, params) {\r\n            var self = this;\r\n\r\n            // Call base\r\n            self._super(workportalFacade, dataService, params);\r\n\r\n            self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n            //Load templates\r\n            self.loadTemplates({\r\n                \"project-subprocesses\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.subprocesses\").concat(\"#project-subprocesses-wrapper\")\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Renders the template defined in the widget\r\n         */\r\n        renderContent: function () {\r\n            var self = this;\r\n            self.content = $(\"<div></div>\");\r\n            return self.content;\r\n        },\r\n\r\n        /*\r\n         * links events with handlers\r\n         */\r\n        postRender: function () {\r\n            var self = this;\r\n\r\n            //Handlers\r\n            self.contextsSidebarActivity.forEach(function (context) {\r\n                self.sub(context, $.proxy(self.updateView, self));\r\n            });\r\n        },\r\n\r\n        updateView: function (event, params) {\r\n            var self = this,\r\n                args = params.args,\r\n                $content = self.getContent().empty();\r\n            self.params = args;\r\n\r\n            if (self.params.idCase > 0) {\r\n                $.when(\r\n                    self.dataService.summarySubProcess({\r\n                        idCase: self.params.idCase\r\n                    })\r\n                ).done(function (responseSubprocess) {\r\n                    self.Class.responseSubprocess(responseSubprocess);\r\n\r\n                    self.organizeDataForSubprocesses(self.params);\r\n                });\r\n            }\r\n        },\r\n\r\n        organizeDataForSubprocesses: function (args) {\r\n            var self = this;\r\n            if (self.Class.responseSubprocess().showSubProcess) {\r\n                $.each(self.Class.responseSubprocess().subProcesses, function (key) {\r\n                    var custData = self.Class.responseSubprocess().subProcesses[key].custData;\r\n                    if (custData && custData.length) {\r\n                        for (var i = 0; i < custData.length; i += 1) {\r\n                            if (custData[i] === null) {\r\n                                custData[i] = \"\";\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                });\r\n\r\n                var subProcess = self.Class.responseSubprocess().subProcesses || self.Class.responseSubprocess().subProcPersonalized;\r\n\r\n                //prepare array with subprocess\r\n                self.Class.auxArrayListSubprocesses([]);\r\n                for (var i = 0; i < Object.keys(subProcess).length; i += 1) {\r\n                    var tempSubprocesses = subProcess[i];\r\n\r\n                    self.Class.auxArrayListSubprocesses({\r\n                        isOpen: tempSubprocesses.isOpen,\r\n                        radNumber: tempSubprocesses.radNumber,\r\n                        displayName: tempSubprocesses.displayName,\r\n                        idCase: tempSubprocesses.idCase,\r\n                        indexSubprocess: i,\r\n                        idCustData: tempSubprocesses.idCustData\r\n                    });\r\n                    if (tempSubprocesses.subProcesses) {\r\n                        Object.keys(tempSubprocesses).forEach(function (key) {//only one iteration\r\n                            self.Class.auxArrayListSubprocesses({\r\n                                isOpen: tempSubprocesses[key].isOpen,\r\n                                radNumber: tempSubprocesses[key].radNumber,\r\n                                displayName: tempSubprocesses[key].displayName,\r\n                                idCase: tempSubprocesses[key].idCase,\r\n                                indexSubprocess: i,\r\n                                idCustData: tempSubprocesses[key].idCustData\r\n                            });\r\n                        });\r\n                    }\r\n                }\r\n\r\n                self.renderWidget();\r\n            }\r\n        },\r\n\r\n        renderWidget: function () {\r\n            var self = this;\r\n            var $content = self.getContent();\r\n\r\n            //Update widget\r\n            var contentTemplate = self.getTemplate(\"project-subprocesses\");\r\n            contentTemplate\r\n                .render({ auxArrayListSubprocesses: self.Class.auxArrayListSubprocesses() })\r\n                .appendTo($content);\r\n\r\n            $(\".list-subprocesses a\", $content).on(\"click\", $.proxy(self.onClickGoSubprocess, self));\r\n\r\n            self.initializeTooltip(\".list-subprocesses li\");\r\n        },\r\n\r\n\r\n        /**\r\n         * Events UI\r\n         */\r\n\r\n        onClickGoSubprocess: function (event) {\r\n            event.preventDefault();\r\n            var self = this;\r\n\r\n            self.routingExecute($(event.target).closest(\"li\"));\r\n        },\r\n\r\n        clean: function () {\r\n            var self = this;\r\n\r\n            self.params = {};\r\n            self.pluginTooltip = null;\r\n\r\n            self.contextsSidebarActivity.forEach(function (context) {\r\n                self.unsub(context, $.proxy(self.updateView, self));\r\n            });\r\n        }\r\n    }\r\n);\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.subprocesses\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.subprocesses]);","/*\r\n    Name   : Bizagi Workportal Project Activity Description\r\n    Created on : Jun 27, 2017\r\n    Author     : Diana Mogollon\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activity.description\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        params = params || {};\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-activity-description\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.activity.description\").concat(\"#project-activity-description\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"project-activity-description\");\r\n        var description = self.getWorkitemDescription();\r\n\r\n        if (description) {\r\n            self.content = template.render({ description: description });\r\n        } else {\r\n            self.content = $('<div />');\r\n        }\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        \r\n    },\r\n\r\n    getWorkitemDescription: function () {\r\n        var self = this;\r\n        var params = self.params || {};\r\n        var idWorkitem = params.idWorkitem || 0;\r\n        var currentState = params.currentState || [];\r\n        var description = \"\";\r\n\r\n        for (var i = 0; i < currentState.length; i++) {\r\n            if (idWorkitem == currentState[i].idWorkItem) {\r\n                description = currentState[i].tskDescription;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return description;\r\n    },\r\n    \r\n    /**\r\n     * Clean widget\r\n     */\r\n    clean: function () {\r\n        \r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.activity.description', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.activity.description], true);\r\n"]}