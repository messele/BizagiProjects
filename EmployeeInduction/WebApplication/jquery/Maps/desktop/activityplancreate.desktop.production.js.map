{"version":3,"sources":["jquery/workportal/desktop/widget/project.dashboard.menu.activity.plan/bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.plan.js","jquery/workportal/desktop/widget/project.content.dashboard/bizagi.workportal.desktop.widgets.project.content.dashboard.js","jquery/workportal/desktop/widget/project.plan/bizagi.workportal.desktop.widgets.project.plan.js","jquery/workportal/desktop/widget/project.plan.activity.sidebar/bizagi.workportal.desktop.widgets.project.plan.activity.sidebar.js","jquery/workportal/desktop/widget/project.plan.activity.action/bizagi.workportal.desktop.widgets.project.plan.activity.action.js","jquery/workportal/desktop/widget/project.plan.activity.time/bizagi.workportal.desktop.widgets.project.plan.activity.time.js","jquery/workportal/desktop/widget/project.plan.activity.progress/bizagi.workportal.desktop.widgets.project.plan.activity.progress.js","jquery/workportal/desktop/widget/project.plan.activity.subprocesses/bizagi.workportal.desktop.widgets.project.plan.activity.subprocesses.js","jquery/workportal/desktop/widget/project.plan.activity.parent/bizagi.workportal.desktop.widgets.project.plan.activity.parent.js","jquery/workportal/desktop/widget/project.plan.activity.users/bizagi.workportal.desktop.widgets.project.plan.activity.users.js"],"names":["bizagi","workportal","widgets","widget","extend","init","workportalFacade","dataService","params","self","this","_super","loadTemplates","project-dashboard-menu","getTemplate","concat","renderContent","content","$","postRender","contextsLeftSidebarCaseDashboard","forEach","context","sub","proxy","updateView","event","args","clean","$content","getContent","empty","argsTemplate","showFormOverview","menuDashboard","showFormActivity","showCommentsOptionMenu","showFilesOptionMenu","showTimeLineOptionMenu","showPlanOptionMenu","contextPlanOptionMenu","contextFormActivityOptionMenu","contextualized","plan","render","appendTo","showContextByMenuDashboard","type","toUpperCase","addClass","siblings","removeClass","handlerEvents","paramsGetPlan","idPlan","id","when","callGetPlan","then","responsePlan","pub","loadContentById","preventDefault","$item","target","closest","hasClass","util","autoSave","done","document","data","getLevelNavigator","newLevelNavigator","parseInt","refreshLastItemBreadcrumb","histName","level","defer","Deferred","getPlan","always","response","status","undefined","resolve","reject","promise","subMenuHandler","$comments","$files","$timeline","on","toggle","unsub","off","injector","register","project","dashboard","menu","activity","project-content-dashboard","template","setTimeout","window","trigger","base","planCreate","project-plan","project-plan-popup","templateHomePlan","$contentWidget","form","buttonShowPopupPlanToAdd","onShowPopupPlan","showPopupAddPlan","ev","paramsNewPlan","planChild","indexOf","servicesPlan","services","behaviors","planParent","getPlanAsParent","clone","nameItemNavigator","localization","getResource","serviceloadDataPlan","project-plan-activity-sidebar","onNotifyLoadInfoPlan","parans","idActivitySelected","loadData","getDateServer","subscribe","loadedWithDataActivities","loadedWithDataFirstParent","unsubscribe","sidebar","notifier","dateFormat","timeFormat","estimatedFinishDateTime","beforeUserAssignedActivity","activity-action-main","activity-action-editionpopup","dialogBox","onNotifyLoadInfoActivityExecution","onNotifyExpandedRightSidebar","currentActivity","activities","filter","idUserCreator","currentUser","idUser","userAssigned","currentActivityName","name","showEditAction","tmpl","append","initilizeActionMenu","initializeTempleteAndEvents","plugins","activityEdition","initPluginPopupEdition","formEditActivity","assignee","date","duration","buttonCancel","buttonUpdate","onClickPopupButtonCancel","onClickPopupButtonUpdate","onDeleteDate","onTypeDuration","select","onSelectMenu","popupEditActivity","formContent","initializeAutoComplete","element","url","serviceLocator","getUrl","autocomplete","minLength","source","request","ajax","domain","userName","fullName","term","organization","pag","pagSize","orderField","success","map","users","item","label","user","value","ui","val","IdAssignee","focus","change","initializeDatePicker","datepicker","onSelect","getTime","dateFormatter","getDateFormatByDatePickerJqueryUI","initializeSpiner","desactivateDateByDuration","newValue","isNumeric","spinner","min","max","placeHolder","spin","keyCode","fieldDurationActive","activateElement","currentTarget","find","length","onClickOpenPopupEdition","dialog","resizable","draggable","height","width","modal","title","maximize","open","onOpenPopupEdition","close","onClosePopupEdition","activityDate","isEmpty","estimatedFinishDate","isNaN","formatInvariant","Date","getDateFromInvariant","isMinimumDate","setUserAssignedById","removePopupWidgets","callGetDataUsers","responseUsers","next","html","remove","validateParamsOfFormEditActivity","idUserAssigned","updateActivity","progress","startDate","allowEdition","description","finishDate","items","editActivityPlan","refreshAllWidgets","showSucessMessage","onClickFavorite","favoriteOptions","idObject","idCase","favoriteType","addFavorite","favoritesData","guidFavorite","idFavorites","delFavorite","messageValidationField","replace","toLowerCase","csvIdUsers","userIds","getUsersData","action","EXECUTING_ACTIVITY","FINISHED_ACTIVITY","datePickerRegional","plan-time-main","onNotifyLoadInfoActivitySummary","getStateActivity","time","fromDate","getFormattedDate","getFirstDate","dataProgressWidget","getDataByScenarios","unitTime","auxUnitTime","updateWidget","contentTemplate","relativeTime","getRelativeTime","now","minutes","messageDescripionDifference","keywordResource","messageTime","$barRemainingDate","widthNumberDays","css","toString","percentBar","currentState","colorBar","getColorByCreatedAndEstimatedDate","toDate","callGetEffectiveDuration","getColorBar","getPercentBar","getKeywordResourceDescriptionBar","getUnitTime","getUTCDate","dateObj","monthNames","getMonth","formatDate","d","getEffectiveDuration","plan-progress-main","plan-progress-popup-edit","onNotifyUpdateItemFromRender","activityToShow","valuePercentBarComplete","canEdit","popupEditProgress","initPluginPopupEditProgress","formEditProgress","sliderProgress","slider","orientation","range","from","to","step","slide","onChangesliderProgress","each","vals","i","el","numericTextBoxPlugin","format","onChangeNumericTextBoxProgress","decimals","buttonChangeProgress","onShowPopupEditProgress","onClickCancel","onSubmitFormChangeProgress","updateProgressUI","listItems","activityWork","hide","show","text","newPercentProgress","templatePopupEditProgress","onOpenPopupPlan","detach","previusValueProgress","prop","project-subprocesses","project-subprocesses-tootip-custom-properties","subprocesses","plan-parent-main","getPlanParent","parent","idParent","radNumber","nameParent","displayName","idWorkflow","idWorkItem","idTask","onClickGoToParentCase","routingExecute","usersMap","usersInformation","globalHandlersService","get","usersAssignees","plan-users-main","activityRuning","cvsGuidUsers","activitiesUsers","ownerUserId","ownerUserGuid","push","guidUser","userType","picture","guid","index","userId","userGuid","userAssignedGuid","inArray","justAssignees","addEventHandlersModal","showCreatorInformation","renderUserProfilesAndImages","allUsers","usersAssignee","isOwner","isAssignee","usersAdapter","createJsonUserInfo","userCreator","userInfo","username","email","getInitials","userinformation","obj","$li","console","log","not","userSelected","$target","usersActivities","userParam","getIsAssignee","getIsOwner","usertooltip","usersGuids","join","getUsersAssignees","getUserAssignee","tasks","types","actUser","click","stopPropagation","publish","widgetName","BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL","closeVisible","modalParameters","refreshInbox"],"mappings":"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","sourcesContent":["/*\r\n *   Name: Bizagi Workportal project Dashboard Menu Activity Plan\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\", {}, {\r\n\r\n   /**\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n      self.params = params || {};\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-dashboard-menu\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.plan\").concat(\"#project-dashboard-menu2\")\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   /**\r\n    * links events with handlers\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      //Handlers\r\n      self.params.contextsLeftSidebarCaseDashboard.forEach(function(context){\r\n         self.sub(context, $.proxy(self.updateView, self));\r\n      });\r\n\r\n   },\r\n\r\n   /**\r\n    * Update view\r\n    * @param event\r\n    * @param params\r\n    */\r\n   updateView: function (event, params) {\r\n      var self = this;\r\n      self.params = $.extend(self.params, params.args);\r\n      self.clean();\r\n      var $content = self.getContent().empty();\r\n\r\n      var argsTemplate = {\r\n         showFormOverview: self.params.menuDashboard.showFormOverview,\r\n         showFormActivity: self.params.menuDashboard.showFormActivity,\r\n         showCommentsOptionMenu: self.params.menuDashboard.showCommentsOptionMenu,\r\n         showFilesOptionMenu: self.params.menuDashboard.showFilesOptionMenu,\r\n         showTimeLineOptionMenu: self.params.menuDashboard.showTimeLineOptionMenu,\r\n         showPlanOptionMenu: self.params.menuDashboard.showPlanOptionMenu,\r\n         contextPlanOptionMenu: self.params.menuDashboard.contextPlanOptionMenu,\r\n         contextFormActivityOptionMenu: self.params.menuDashboard.contextFormActivityOptionMenu,\r\n         contextualized: self.params.plan.contextualized\r\n      };\r\n\r\n      //Update widget\r\n      var template = self.getTemplate(\"project-dashboard-menu\");\r\n      template.render(argsTemplate).appendTo($content);\r\n\r\n      if(self.params.showContextByMenuDashboard){\r\n         $(\"li[data-context='\" + event.type.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\r\n      }\r\n\r\n      self.handlerEvents();\r\n\r\n      var paramsGetPlan = {idPlan: self.params.plan.id};\r\n      $.when(self.callGetPlan(paramsGetPlan)).then(function(responsePlan){\r\n         $.extend(self.params.plan, responsePlan);\r\n         self.pub(\"notify\", {\r\n            type: \"LOAD_INFO_PLAN\",\r\n            args: self.params\r\n         });\r\n      });\r\n   },   \r\n\r\n   /**\r\n    *   Load Content By Id\r\n    */\r\n   loadContentById: function (event) {\r\n      var self = this;\r\n      event.preventDefault();\r\n      var $item = $(event.target).closest(\"li\");\r\n\r\n      if (!$item.hasClass(\"active\")) {\r\n         $.when(bizagi.util.autoSave()).done(function () {\r\n            $(document).data('auto-save', '');\r\n\r\n            var showContextByMenuDashboard = $item.data(\"context\");\r\n            if (showContextByMenuDashboard) {\r\n               var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\"});\r\n               var currentLevelNavigator = parseInt(getLevelNavigator[0]);\r\n               var nameItemNavigator = \"\";\r\n               var newLevelNavigator = currentLevelNavigator;\r\n\r\n               self.params.refreshLastItemBreadcrumb = false;\r\n               self.pub(\"notify\", {\r\n                  type: showContextByMenuDashboard.toUpperCase(),\r\n                  args: $.extend(self.params,{showContextByMenuDashboard: showContextByMenuDashboard,\r\n                     histName: nameItemNavigator,\r\n                     level: newLevelNavigator})\r\n               });\r\n               $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\r\n            }\r\n         });\r\n      }\r\n   },\r\n\r\n   /**\r\n    * Call services\r\n    */\r\n\r\n   callGetPlan: function(params){\r\n      var self = this;\r\n      var defer = $.Deferred();\r\n      self.dataService.getPlan(params).always(function (response) {\r\n         if (response.status === 200 || response.status === 201 || response.status === undefined) {\r\n            defer.resolve(response);\r\n         }\r\n         else {\r\n            defer.reject();\r\n         }\r\n      });\r\n\r\n      return defer.promise();\r\n   },\r\n\r\n   subMenuHandler: function () {\r\n       var self = this;\r\n       var content = self.getContent();\r\n       var $comments = $(\"[data-context='ACTIVITYPLANCOMMENTS']\", content);\r\n       var $files = $(\"[data-context='ACTIVITYPLANFILES']\", content);\r\n       var $timeline = $(\"[data-context='ACTIVITYPLANTIMELINE']\", content);\r\n\r\n       $(\".ui-bizagi-wp-project-tab-submenu a\", content).on(\"click\", function () {\r\n           $comments.toggle();\r\n           $files.toggle();\r\n           $timeline.toggle();\r\n       });\r\n   },\r\n\r\n   /**\r\n    * Handler events\r\n    */\r\n   handlerEvents: function(){\r\n      var self = this;\r\n      var content = self.getContent();\r\n      self.subMenuHandler();\r\n      $(\".ui-bizagi-wp-project-tab-links a\", content).on(\"click\",  $.proxy(self.loadContentById, self));\r\n   },\r\n\r\n   /**\r\n    * Clean widgets and events\r\n    */\r\n   clean: function(){\r\n      var self = this;\r\n      var content = self.getContent();\r\n\r\n      if(self.params && self.params.contextsLeftSidebarCaseDashboard){\r\n         self.params.contextsLeftSidebarCaseDashboard.forEach(function(context){\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n         });\r\n      }\r\n\r\n      $(\".ui-bizagi-wp-project-tab-links a\", content).off();\r\n   }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu.activity.plan], true);","/*\r\n *   Name: Bizagi Workportal Project Content Dashboard\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.content.dashboard\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-content-dashboard\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.content.dashboard\").concat(\"#project-plan-content-dashboard\")\r\n      });\r\n\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n\r\n      var template = self.getTemplate(\"project-content-dashboard\");\r\n      self.content = template.render({});\r\n\r\n      return self.content;\r\n   },\r\n   postRender: function(){\r\n      var self = this;\r\n\r\n      setTimeout(function(){\r\n         $(window).trigger(\"resize\"); //Simulate resize for fix when load first time.\r\n      }, 1000);\r\n\r\n   }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.content.dashboard\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.content.dashboard], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.plan\", {}, {\r\n   /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, planCreate, params) {\r\n\r\n      var self = this;\r\n\r\n      //Call base\r\n      self._super(workportalFacade, dataService, params);\r\n      self.params = $.extend(self.params, params);\r\n      self.planCreate = planCreate;\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-plan\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.plan\").concat(\"#project-plan-wrapper\"),\r\n         \"project-plan-popup\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.plan\").concat(\"#project-plan-popup-template\")\r\n      });\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      var templateHomePlan = self.getTemplate(\"project-plan\");\r\n      self.content = templateHomePlan.render({});\r\n      return self.content;\r\n   },\r\n\r\n   /*\r\n    * Post render and links events with handlers\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      var $contentWidget = self.getContent();\r\n      //reference for html elements\r\n      self.form = {\r\n         buttonShowPopupPlanToAdd: $(\"#buttonShowPopupCreatePlan\", $contentWidget)\r\n      };\r\n      self.form.buttonShowPopupPlanToAdd.on(\"click\", $.proxy(self.onShowPopupPlan, self));\r\n   },\r\n\r\n   onShowPopupPlan: function(){\r\n      var self = this;\r\n      var contextualized = typeof self.params.plan.contextualized === \"undefined\" ? true : self.params.plan.contextualized;\r\n      self.planCreate.showPopupAddPlan(self.params, self.dataService, contextualized);\r\n      self.planCreate.unsub('planCreated');\r\n      self.planCreate.sub('planCreated', function (ev, params) {\r\n         var paramsNewPlan = params.paramsNewPlan;\r\n         self.params.planChild = {};\r\n\r\n         //Set planparent if we are on activity plan\r\n         if(self.params.showContextByMenuDashboard.indexOf(\"ACTIVITYPLAN\") != -1){\r\n            var servicesPlan = new bizagi.workportal.services.behaviors.plan(self.dataService);\r\n            self.params.planParent=servicesPlan.getPlanAsParent(self.params.plan);\r\n         }\r\n         self.params.planChild = bizagi.clone(paramsNewPlan);\r\n\r\n         self.pub(\"notify\", {\r\n              type: \"UPDATE_LASTCRUMBPARAMS_INFO\",\r\n              args: {\r\n                  planChild: self.params.planChild\r\n              }\r\n         });\r\n\r\n         self.params.menuDashboard.contextPlanOptionMenu = \"PLANACTIVITIES\";\r\n\r\n         var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\"});\r\n         var currentLevelNavigator = parseInt(getLevelNavigator[0], 10);\r\n         var newLevelNavigator = currentLevelNavigator + 1;\r\n         var nameItemNavigator = bizagi.localization.getResource(\"workportal-project-casedashboard-plan\");\r\n\r\n         self.pub(\"notify\", {\r\n            type: \"PLANACTIVITIES\",\r\n            args: $.extend(self.params, {showContextByMenuDashboard: \"PLANACTIVITIES\",\r\n               histName: nameItemNavigator,\r\n               level: newLevelNavigator})\r\n         });\r\n      });\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan\", [\"workportalFacade\", \"dataService\", \"bizagi.workportal.widgets.project.plan.create\", bizagi.workportal.widgets.project.plan], true);","/*\r\n *   Name: Bizagi Workportal Project Activity Sidebar\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.plan.activity.sidebar\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, serviceloadDataPlan, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      self.serviceloadDataPlan = serviceloadDataPlan;\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-plan-activity-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.sidebar\").concat(\"#project-plan-activity-sidebar\")\r\n      });\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n\r\n      var template = self.getTemplate(\"project-plan-activity-sidebar\");\r\n      self.content = template.render({});\r\n\r\n      return self.content;\r\n   },\r\n   postRender: function(){\r\n      var self = this;\r\n      self.sub(\"LOAD_INFO_PLAN\", $.proxy(self.onNotifyLoadInfoPlan, self));\r\n   },\r\n\r\n    onNotifyLoadInfoPlan: function (event, parans) {\r\n        var self = this;\r\n        if (self.params.plan.idActivitySelected) {\r\n\r\n            var params = {idPlan: self.params.plan.id};\r\n            self.serviceloadDataPlan.loadData(params, self.getDateServer, self.params);\r\n            self.serviceloadDataPlan.subscribe(\"loadedWithDataActivities\", $.proxy(self.loadedWithDataActivities, self));\r\n            self.serviceloadDataPlan.subscribe(\"loadedWithDataFirstParent\", $.proxy(self.loadedWithDataFirstParent, self));\r\n        }\r\n        else {\r\n            if (self.params.showContextByMenuDashboard === \"ACTIVITYPLANPROCESSMAP\" ||\r\n                    self.params.showContextByMenuDashboard === \"ACTIVITYPLANLOG\") {\r\n                self.pub(\"notify\", {\r\n                    type: \"DISABLED_RIGHT_SIDEBAR\"\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    loadedWithDataActivities: function(){\r\n        var self = this;\r\n        self.pub(\"notify\", {\r\n            type: \"LOADED_ACTIVITIES_PLAN\",\r\n            args: self.params\r\n        });\r\n        self.pub(\"notify\", {\r\n            type: \"LOAD_INFO_SUMMARY_PROGRESS_PLAN\",\r\n            args: self.params\r\n        });\r\n        self.pub(\"notify\", {\r\n            type: \"LOAD_INFO_ACTIVITY_SUMMARY\",\r\n            args: self.params\r\n        });\r\n        self.pub(\"notify\", {\r\n            type: \"LOAD_INFO_ACTIVITIES_PLAN\",\r\n            args: self.params\r\n        });\r\n    },\r\n\r\n    loadedWithDataFirstParent: function(){\r\n        var self = this;\r\n        self.pub(\"notify\", {\r\n            type: \"LOAD_INFO_SUMMARY_PLAN\",\r\n            args: self.params\r\n        });\r\n    },\r\n\r\n    clean: function(){\r\n        var self = this;\r\n        if(self.serviceloadDataPlan){\r\n            self.serviceloadDataPlan.unsubscribe(\"loadedWithDataActivities\", $.proxy(self.loadedWithDataActivities, self));\r\n            self.serviceloadDataPlan.unsubscribe(\"loadedWithDataFirstParent\", $.proxy(self.loadedWithDataFirstParent, self));\r\n        }\r\n    }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.sidebar\", [\"workportalFacade\", \"dataService\", \"bizagi.workportal.services.behaviors.loadDataPlan\", bizagi.workportal.widgets.project.plan.activity.sidebar], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Action\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.plan.activity.action\", {}, {\r\n\r\n   /**\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, notifier, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      self.dateFormat = bizagi.localization.getResource(\"dateFormat\");\r\n      self.timeFormat = bizagi.localization.getResource(\"timeFormat\");\r\n      self.estimatedFinishDateTime; //Save complete date and time, because datepicker dont save time\r\n\r\n      self.beforeUserAssignedActivity = \"\";\r\n       self.notifier = notifier;\r\n\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"activity-action-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.action\").concat(\"#project-plan-activity-action\"),\r\n         \"activity-action-editionpopup\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.action\").concat(\"#project-plan-activity-action-editionpopup\")\r\n      });\r\n\r\n      self.dialogBox = {};\r\n   },\r\n\r\n   /**\r\n    *\r\n    * @returns {*|jQuery|HTMLElement}\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   /**\r\n    *\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\r\n      self.sub(\"EXPANDED_RIGHT_SIDEBAR\", $.proxy(self.onNotifyExpandedRightSidebar, self));\r\n   },\r\n\r\n   /**\r\n    * Notifies when an event is raised\r\n    */\r\n   onNotifyLoadInfoActivityExecution: function (event, params) {\r\n      var self = this;\r\n      self.params = $.extend(self.params, params.args);\r\n\r\n      var $content = self.getContent().empty();\r\n\r\n      var currentActivity = {};\r\n      if(self.params.plan.idActivitySelected){\r\n         currentActivity = self.params.plan.activities.filter(function(activity){\r\n            return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\r\n         })[0];\r\n      }\r\n\r\n      if(self.params.plan.idUserCreator === bizagi.currentUser.idUser || currentActivity.userAssigned == bizagi.currentUser.idUser){\r\n\r\n         var argsTemplate = {};\r\n         argsTemplate.currentActivityName = currentActivity.name;\r\n         argsTemplate.showEditAction = true;\r\n         if(self.params.plan.idUserCreator !== bizagi.currentUser.idUser){\r\n             argsTemplate.showEditAction = false;\r\n         }\r\n\r\n         var tmpl = self.getTemplate(\"activity-action-main\");\r\n         $content.append(tmpl.render(argsTemplate));\r\n\r\n         if(argsTemplate.showEditAction){\r\n             self.initilizeActionMenu();\r\n             self.beforeUserAssignedActivity = currentActivity.userAssigned;\r\n             self.content.append($content);\r\n            self.initializeTempleteAndEvents();\r\n         }\r\n      }\r\n   },\r\n\r\n   initializeTempleteAndEvents: function (){\r\n        var self = this;\r\n        self.plugins = {}; \r\n        self.plugins.activityEdition = self.initPluginPopupEdition();\r\n\r\n        self.formEditActivity = {\r\n            assignee: $(\"#activity-form-assignee\", self.plugins.activityEdition),\r\n            date: $(\"#activity-form-date\", self.plugins.activityEdition),\r\n            duration:  $(\"#activity-form-duration\",self.plugins.activityEdition),\r\n            buttonCancel: $(\"#ui-bizagi-wp-project-popupform-action-cancel\", self.plugins.activityEdition),\r\n            buttonUpdate: $(\"#ui-bizagi-wp-project-popupform-action-update\", self.plugins.activityEdition)\r\n        };\r\n\r\n        self.formEditActivity.buttonCancel.on(\"click\", $.proxy(self.onClickPopupButtonCancel, self));\r\n        self.formEditActivity.buttonUpdate.on(\"click\", $.proxy(self.onClickPopupButtonUpdate, self));\r\n\r\n        self.formEditActivity.date.on(\"keydown\", $.proxy(self.onDeleteDate, self));\r\n        self.formEditActivity.duration.on(\"keyup\", $.proxy(self.onTypeDuration, self));\r\n   },\r\n\r\n   /**\r\n    *\r\n    */\r\n   onNotifyExpandedRightSidebar: function(){\r\n      var self = this;\r\n      self.initilizeActionMenu();\r\n   },\r\n\r\n   /**\r\n    *\r\n    */\r\n   initilizeActionMenu: function () {\r\n      var self = this;\r\n      $(\"#ui-bizagi-wp-project-plan-activity-action .menu\", self.content).menu({\r\n         select: $.proxy(self.onSelectMenu, self)\r\n      }).removeClass(\"ui-widget-content\");\r\n   },\r\n\r\n   /**\r\n    *\r\n    * @returns dialogBox.formContent\r\n    */\r\n   initPluginPopupEdition: function () {\r\n      var self = this;\r\n      var popupEditActivity = self.getTemplate(\"activity-action-editionpopup\");\r\n      self.dialogBox.formContent = popupEditActivity.render({});\r\n      return self.dialogBox.formContent;\r\n\r\n   },\r\n\r\n   /**\r\n    *\r\n    * @param element\r\n    */\r\n    initializeAutoComplete: function (element) {\r\n        var self = this;\r\n        var url = self.dataService.serviceLocator.getUrl(\"admin-getUsersList\");\r\n\r\n        element.autocomplete({\r\n            minLength: 2,\r\n            source: function (request, response) {\r\n                $.ajax({\r\n                    url: url,\r\n                    data: {\r\n                        domain: \"\",\r\n                        userName: \"\",\r\n                        fullName: request.term,\r\n                        organization: \"\",\r\n                        pag: 1,\r\n                        pagSize: 100,\r\n                        orderField: \"fullName\"\r\n                    },\r\n                    success: function (data) {\r\n                        response($.map(data.users, function (item) {\r\n                            return {\r\n                                label: item.user,\r\n                                value: item.idUser\r\n                            };\r\n                        }));\r\n                    }\r\n                });\r\n            },\r\n            select: function (event, ui) {\r\n                var name = ui.item.label;\r\n                element.val(name);\r\n                self.formEditActivity.IdAssignee = ui.item.value;\r\n                return false;\r\n            },\r\n            focus: function () {\r\n                return false;\r\n            },\r\n            change: function (event, ui){\r\n                if(ui.item === null){\r\n                    self.formEditActivity.IdAssignee = null;\r\n                    self.formEditActivity.assignee.val(\"\");\r\n                }\r\n                return false;\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n   /**\r\n    *\r\n    * @param element\r\n    */\r\n    initializeDatePicker: function (element) {\r\n        var self = this;\r\n        element.datepicker({\r\n            onSelect: function () {\r\n                self.formEditActivity.duration.val(\"\");\r\n                self.estimatedFinishDateTime = self.formEditActivity.date.datepicker(\"getDate\") ? self.formEditActivity.date.datepicker(\"getDate\").getTime() : undefined;\r\n            }\r\n        });\r\n        element.datepicker(\"option\", \"dateFormat\", bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI());\r\n    },\r\n\r\n   /**\r\n    *\r\n    * @param element\r\n    */\r\n    initializeSpiner: function (element) {\r\n        var self = this;\r\n        function desactivateDateByDuration(event, newValue){\r\n            var value = newValue || $(event.target).val();\r\n            if (bizagi.util.isNumeric(value) && parseInt(value, 10) > 0) {\r\n               self.formEditActivity.date.val(\"\");\r\n               self.estimatedFinishDateTime = undefined;\r\n            } else {\r\n               $(event.target).val(\"\");\r\n            }\r\n        }\r\n\r\n        element.spinner({\r\n            min: 1,\r\n            max: 1000,\r\n            placeHolder: bizagi.localization.getResource(\"workportal-hours\"),\r\n            change: function (event) {\r\n                desactivateDateByDuration(event);\r\n            },\r\n            spin: function( event, ui ) {\r\n                desactivateDateByDuration(event, ui.value);\r\n            }\r\n        });\r\n    },\r\n\r\n   /***\r\n    * Events\r\n    * @param event\r\n    */\r\n\r\n   onDeleteDate: function (event) {\r\n      var self = this;\r\n      if (event.keyCode === 8) {\r\n          $(event.target).val(\"\");\r\n          self.fieldDurationActive(true);\r\n      }\r\n   },\r\n\r\n   /**\r\n    *\r\n    * @param event\r\n    */\r\n   onTypeDuration: function (event) {\r\n      var self = this;\r\n      var $target = $(event.target);\r\n      if ($target.val() !== \"\") {\r\n          self.estimatedFinishDateTime = undefined;\r\n      } else {\r\n          self.activateElement(self.form.date);\r\n      }\r\n   },\r\n\r\n    /**\r\n     * When select menu\r\n     * @param event\r\n     * @param ui\r\n     */\r\n   onSelectMenu: function (event, ui) {\r\n      var self = this;\r\n      if($(event.currentTarget).find(\"i\").length === 0){\r\n         var item = $(ui.item).data(\"item\");\r\n         switch (item) {\r\n            case \"edit\":\r\n               self.onClickOpenPopupEdition();\r\n               break;\r\n         }\r\n      }\r\n   },\r\n\r\n   /**\r\n    *\r\n    */\r\n   onClickOpenPopupEdition: function () {\r\n        var self = this;\r\n        self.initializeTempleteAndEvents();\r\n        self.dialogBox.formContent.dialog({\r\n            resizable: false,\r\n            draggable: false,\r\n            height: \"auto\",\r\n            width: \"600px\",\r\n            modal: true,\r\n            title: bizagi.localization.getResource(\"workportal-project-plan-title-activity-properties\"),\r\n            maximize: true,\r\n            open: $.proxy(self.onOpenPopupEdition, self),\r\n            close: $.proxy(self.onClosePopupEdition, self)\r\n        });\r\n   },\r\n\r\n    /**\r\n    *\r\n    */\r\n    onOpenPopupEdition: function () {\r\n        var self = this;\r\n        var currentActivity = self.params.plan.activities.filter(function(activity){\r\n            return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\r\n        })[0];\r\n\r\n        var activityDate =  (currentActivity && !bizagi.util.isEmpty(currentActivity.estimatedFinishDate)) ? currentActivity.estimatedFinishDate: \"\";\r\n        if(!isNaN(activityDate)){\r\n            activityDate=bizagi.util.dateFormatter.formatInvariant(new Date(activityDate));\r\n        }\r\n        var estimatedFinishDate = activityDate ? bizagi.util.dateFormatter.getDateFromInvariant(activityDate): \"\";\r\n        var isMinimumDate = estimatedFinishDate instanceof Date ? estimatedFinishDate.getTime() < self.getDateServer() : false;\r\n\r\n        self.initializeAutoComplete(self.formEditActivity.assignee);\r\n        self.initializeDatePicker(self.formEditActivity.date);\r\n        self.initializeSpiner(self.formEditActivity.duration);\r\n\r\n        if (currentActivity.userAssigned) {\r\n            self.setUserAssignedById(currentActivity.userAssigned);\r\n        }\r\n\r\n        self.formEditActivity.date.datepicker(\"option\", \"minDate\", new Date(self.getDateServer()));\r\n\r\n        if (currentActivity.estimatedFinishDate && isMinimumDate) {\r\n            self.formEditActivity.date.datepicker(\"option\", \"minDate\", estimatedFinishDate);//set minimum because, if date is past\r\n        }\r\n\r\n        if (currentActivity.estimatedFinishDate) {\r\n            if (estimatedFinishDate){\r\n                self.formEditActivity.date.datepicker(\"setDate\", estimatedFinishDate);\r\n            }\r\n            self.estimatedFinishDateTime = currentActivity.estimatedFinishDate;\r\n        }\r\n\r\n        if (currentActivity.duration) {\r\n            self.formEditActivity.duration.val(parseInt(currentActivity.duration, 10));\r\n        }\r\n   },\r\n\r\n   /**\r\n    * When close popup edition\r\n    */\r\n   onClosePopupEdition: function(){\r\n      var self = this;\r\n      self.removePopupWidgets();\r\n   },\r\n\r\n   /**\r\n    *\r\n    * @param idUser\r\n    */\r\n    setUserAssignedById: function (idUser) {\r\n        var self = this;\r\n        //Show images users\r\n        self.callGetDataUsers(idUser).then(function (responseUsers) {\r\n            self.formEditActivity.assignee.val(responseUsers[0].name);\r\n        });\r\n        self.formEditActivity.IdAssignee = idUser;\r\n    },\r\n\r\n   /**\r\n    *\r\n    * @param event\r\n    */\r\n    onClickPopupButtonCancel: function(event){\r\n        var self = this;\r\n        event.preventDefault();\r\n        self.removePopupWidgets();\r\n    },\r\n\r\n    /**\r\n    * Remove popup widgets\r\n    */\r\n    removePopupWidgets: function(){\r\n        var self = this;\r\n        self.formEditActivity.assignee.next().find(\"span\").html(\"\");\r\n        self.dialogBox.formContent.remove();\r\n        $(\"#ui-datepicker-div\").remove();\r\n    },\r\n\r\n   /**\r\n    *  Triggered when click update plan activity\r\n    */\r\n    onClickPopupButtonUpdate: function () {\r\n        var self = this;\r\n        if(self.validateParamsOfFormEditActivity()){\r\n            var currentActivity = self.params.plan.activities.filter(function (activity) {\r\n                return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\r\n            })[0];\r\n            var idUserAssigned =  self.formEditActivity.IdAssignee || bizagi.currentUser.idUser;\r\n            if(self.formEditActivity.duration.val()!=\"\"){\r\n                self.params.plan.activities.filter(function (activity) {\r\n                    return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\r\n                })[0].estimatedFinishDate=\"\";\r\n            }\r\n            var updateActivity = {\r\n                progress: currentActivity.progress,\r\n                id: currentActivity.id,\r\n                startDate: currentActivity.startDate,\r\n                duration: self.formEditActivity.duration.val(),\r\n                userAssigned: idUserAssigned,\r\n                allowEdition: currentActivity.allowEdition,\r\n                description: currentActivity.description,\r\n                name: currentActivity.name,\r\n                idPlan: currentActivity.idPlan,\r\n                estimatedFinishDate: self.estimatedFinishDateTime,\r\n                finishDate: currentActivity.finishDate,\r\n                items: currentActivity.items\r\n            };\r\n            $.when(self.dataService.editActivityPlan(updateActivity)).done(function () {\r\n                currentActivity = $.extend(currentActivity, updateActivity);\r\n                self.removePopupWidgets();\r\n\r\n                if (self.beforeUserAssignedActivity !== self.formEditActivity.IdAssignee) {\r\n                    self.pub(\"notify\", {\r\n                        type: \"ACTIVITYPLANCOMMENTS\",\r\n                        args: $.extend(self.params, {refreshAllWidgets: true})\r\n                    });\r\n                }\r\n                else {\r\n                    self.pub(\"notify\", {\r\n                        type: self.params.showContextByMenuDashboard,\r\n                        args: self.params\r\n                    });\r\n                }\r\n\r\n                self.removePopupWidgets();\r\n                self.notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-project-plan-activity-update-message\"));\r\n            });\r\n        }\r\n    },\r\n\r\n   /***\r\n    * Events\r\n    */\r\n   onClickFavorite: function (event) {\r\n      event.preventDefault();\r\n      var self = this;\r\n      var favoriteOptions = {};\r\n      if ($(event.target).hasClass(\"bz-icon-star-outline\")) {\r\n         favoriteOptions = {\r\n            idObject: self.params.idCase,\r\n            favoriteType: \"CASES\"\r\n         };\r\n         $.when(self.dataService.addFavorite(favoriteOptions)).done(function (favoritesData) {\r\n            self.params.guidFavorite = favoritesData.idFavorites;\r\n            $(event.target).removeClass(\"bz-icon-star-outline\");\r\n            $(event.target).addClass(\"bz-icon-star\");\r\n         });\r\n      }\r\n      else {\r\n         favoriteOptions = {\r\n            idObject: self.params.guidFavorite,\r\n            favoriteType: \"CASES\"\r\n         };\r\n         $.when(self.dataService.delFavorite(favoriteOptions)).done(function () {\r\n            $(event.target).addClass(\"bz-icon-star-outline\");\r\n            $(event.target).removeClass(\"bz-icon-star\");\r\n         });\r\n      }\r\n   },\r\n\r\n   /**\r\n    * Clean events and plugins\r\n    */\r\n   clean: function(){\r\n      var self = this;\r\n      self.unsub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\r\n      self.unsub(\"EXPANDED_RIGHT_SIDEBAR\", $.proxy(self.onNotifyExpandedRightSidebar, self));\r\n   },\r\n\r\n   /**\r\n    * Validate form edit plan activity\r\n    * @returns {boolean}\r\n    */\r\n    validateParamsOfFormEditActivity: function(){\r\n        var self = this;\r\n        var userAssigned = self.formEditActivity.assignee;\r\n        if (userAssigned.val() && userAssigned.val() !== \"\" && self.formEditActivity.IdAssignee) {\r\n            return true;\r\n        } else {\r\n            var messageValidationField = bizagi.localization.getResource(\"workportal-general-error-field-required\");\r\n            messageValidationField = messageValidationField.replace(\"{0}\", bizagi.localization.getResource(\"workportal-project-plan-assignee\").toLowerCase());\r\n            userAssigned.next().find(\"span\").html(messageValidationField);\r\n            return false;\r\n        }\r\n    },\r\n\r\n   /**\r\n    * Call services\r\n    */\r\n   callGetDataUsers: function (csvIdUsers) {\r\n      var self = this,\r\n         defer = $.Deferred();\r\n      var params = {\r\n         userIds: csvIdUsers,\r\n         width: 50,\r\n         height: 50\r\n      };\r\n\r\n      self.dataService.getUsersData(params).always(function (response) {\r\n         defer.resolve(response);\r\n      });\r\n      return defer.promise();\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.action\", [\"workportalFacade\", \"dataService\", \"notifier\", bizagi.workportal.widgets.project.plan.activity.action]);\r\n","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Time\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n/***\r\n * TODO IMPORTANT: This widget is development with TDD, test this file when changes\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.time\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    *\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Constants\r\n      self.EXECUTING_ACTIVITY = \"EXECUTING\";\r\n      self.FINISHED_ACTIVITY = \"FINISHED\";\r\n\r\n      //Regional\r\n      self.datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"plan-time-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.time\").concat(\"#project-plan-activity-time\")\r\n      });\r\n   },\r\n\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   postRender: function () {\r\n      var self = this;\r\n      self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivitySummary, self));\r\n   },\r\n\r\n   /**\r\n    * Notifies when an event is raised\r\n    */\r\n   onNotifyLoadInfoActivitySummary: function(event, params){\r\n      var self = this;\r\n      self.params = $.extend(self.params, params.args);\r\n      self.getContent().empty();\r\n\r\n      var currentActivity = self.params.plan.activities.filter(function (activity) {\r\n         return activity.id === self.params.plan.idActivitySelected;\r\n      })[0];\r\n\r\n      if(currentActivity.startDate){\r\n         self.getStateActivity(currentActivity);\r\n\r\n         var argsTemplate = {\r\n            time: {\r\n               fromDate: self.getFormattedDate(new Date(self.getFirstDate(currentActivity)))\r\n            }\r\n         };\r\n         var dataProgressWidget = self.getDataByScenarios(currentActivity, true);\r\n\r\n         $.when(dataProgressWidget.unitTime).done(function(auxUnitTime){\r\n            dataProgressWidget = $.extend(dataProgressWidget, {\r\n               unitTime: auxUnitTime\r\n            });\r\n            self.updateWidget($.extend(argsTemplate.time, dataProgressWidget));\r\n         });\r\n\r\n      }\r\n   },\r\n   updateWidget: function(argsTemplate){\r\n      var self = this;\r\n      var $content = self.getContent().empty();\r\n      var contentTemplate = self.getTemplate(\"plan-time-main\");\r\n\r\n      var relativeTime = bizagi.util.dateFormatter.getRelativeTime(new Date(Date.now() - (argsTemplate.unitTime.minutes * 60 * 1000)), null, false);\r\n\r\n      var messageDescripionDifference = bizagi.localization.getResource(\"workportal-project-activity-state-\" + argsTemplate.keywordResource);\r\n      argsTemplate.messageTime = messageDescripionDifference.replace(\"%s\", relativeTime);\r\n\r\n      contentTemplate\r\n         .render(argsTemplate)\r\n         .appendTo($content);\r\n\r\n      //Begin Adjust status bar next to the number days\r\n      var $barRemainingDate = $(\".remaining-days .time-remaining\", $content);\r\n      var widthNumberDays = $(\".remaining-days .days\", $content).width();\r\n      $barRemainingDate.css(\"padding-left\", (widthNumberDays + 7).toString() + \"px\");\r\n\r\n      var $barCompletedDate = $(\".remaining-days .bar-completed\", $content);\r\n\r\n      $barCompletedDate.css(\"width\", argsTemplate.percentBar + \"%\");\r\n      //End Adjust status bar next to the number days\r\n\r\n   },\r\n   getStateActivity: function(activity){\r\n      var self = this;\r\n      if(activity.finishDate){\r\n         activity.currentState = self.FINISHED_ACTIVITY;\r\n         return self.FINISHED_ACTIVITY;\r\n      }\r\n      else{\r\n         activity.currentState = self.EXECUTING_ACTIVITY;\r\n         return self.EXECUTING_ACTIVITY;\r\n      }\r\n   },\r\n   getFirstDate: function(activity){\r\n      var self = this;\r\n      if(activity.currentState === self.EXECUTING_ACTIVITY){\r\n         return activity.startDate;\r\n      } else{\r\n         return activity.finishDate;\r\n      }\r\n   },\r\n   getDataByScenarios: function(activity){\r\n      var self = this;\r\n      var response = {\r\n         colorBar: null,\r\n         percentBar: 100,\r\n         keywordResource: null,\r\n         unitTime: null\r\n      };\r\n      var params = {};\r\n      switch(activity.currentState){\r\n         case self.EXECUTING_ACTIVITY:\r\n            response.keywordResource = \"opened\";\r\n            response.colorBar = self.getColorByCreatedAndEstimatedDate(activity);\r\n\r\n            params = {\r\n               idUser: bizagi.currentUser.idUser,\r\n               fromDate: activity.startDate,\r\n               toDate: Date.now()\r\n            };\r\n            response.unitTime = self.callGetEffectiveDuration(params);\r\n\r\n            break;\r\n         case self.FINISHED_ACTIVITY:\r\n            response.colorBar = \"Gray\";\r\n            response.keywordResource = \"closed\";\r\n            params = {\r\n               idUser: bizagi.currentUser.idUser,\r\n               fromDate: activity.finishDate,\r\n               toDate: Date.now()\r\n            };\r\n            response.unitTime = self.callGetEffectiveDuration(params);\r\n            break;\r\n      }\r\n      return response;\r\n   },\r\n\r\n   getColorBar: function(activity){\r\n      var self = this;\r\n      return self.getDataByScenarios(activity).colorBar;\r\n   },\r\n   getPercentBar: function(activity){\r\n      var self = this;\r\n      return self.getDataByScenarios(activity).percentBar;\r\n   },\r\n   getKeywordResourceDescriptionBar: function(activity){\r\n      var self = this;\r\n      return self.getDataByScenarios(activity).keywordResource;\r\n   },\r\n   getUnitTime: function(activity){\r\n      var self = this;\r\n      return self.getDataByScenarios(activity).unitTime;\r\n   },\r\n\r\n   getColorByCreatedAndEstimatedDate: function(activity){\r\n      var self = this;\r\n      var response = \"Red\";\r\n      if(activity.estimatedFinishDate) {\r\n         if (Date.now() < activity.estimatedFinishDate) {\r\n            var theSameDay = (new Date()).getUTCDate() === (new Date(activity.estimatedFinishDate)).getUTCDate();\r\n            if(theSameDay){\r\n               response = \"Yellow\";\r\n            }\r\n            else{\r\n               response = \"Green\";\r\n            }\r\n         }\r\n      }\r\n      return response;\r\n   },\r\n\r\n   getFormattedDate: function (dateObj) {\r\n      var self = this;\r\n      var monthsNames = self.datePickerRegional.monthNames;\r\n      var shortMonth = dateObj.getMonth();\r\n\r\n      return monthsNames[shortMonth] + \" \" + bizagi.util.dateFormatter.formatDate(dateObj, \"dd hh:mm tt\", bizagi.localization.getResource(\"datePickerRegional\"));\r\n   },\r\n\r\n   /**\r\n    * Call services\r\n    */\r\n   callGetEffectiveDuration: function(params){\r\n      var self = this;\r\n      var d = $.Deferred();\r\n      $.when(\r\n         self.dataService.getEffectiveDuration(params)\r\n      ).done(function (data) {\r\n            d.resolve(data);\r\n         });\r\n      return d.promise();\r\n   }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.time\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.time], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Progress\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.progress\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      self.plugins = {};\r\n      self.dialogBox = {};\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"plan-progress-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.progress\").concat(\"#project-plan-activity-progress\"),\r\n         \"plan-progress-popup-edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.progress\").concat(\"#project-plan-activity-edit-progress\")\r\n      });\r\n   },\r\n\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   postRender: function () {\r\n      var self = this;\r\n      self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\r\n      self.sub(\"UPDATE_ITEMS_FROM_FORMRENDER\", $.proxy(self.onNotifyUpdateItemFromRender, self));\r\n   },\r\n\r\n   /**\r\n    * Notifies when an event is raised\r\n    */\r\n   onNotifyLoadInfoActivityExecution: function (event, params) {\r\n      var self = this;\r\n      self.params = $.extend(self.params, params.args);\r\n      var $content = self.getContent().empty();\r\n\r\n      var activityToShow = self.params.plan.activities.filter(function(activity){\r\n         return activity.id.toUpperCase() == self.params.plan.idActivitySelected.toUpperCase();\r\n      })[0];\r\n\r\n      var argsTemplate = {};\r\n      argsTemplate.valuePercentBarComplete = 0;\r\n      argsTemplate.progress = {\r\n         progress: activityToShow.progress,\r\n         canEdit: (activityToShow.items.length === 0)\r\n      };\r\n\r\n      if(argsTemplate.progress.progress){\r\n         argsTemplate.valuePercentBarComplete = argsTemplate.progress.progress;\r\n      }\r\n\r\n      //Update widget\r\n      var templateMain = self.getTemplate(\"plan-progress-main\");\r\n      templateMain.render(argsTemplate).appendTo($content);\r\n\r\n      self.plugins.popupEditProgress = self.initPluginPopupEditProgress();\r\n\r\n      var popupEditProgress = self.plugins.popupEditProgress;\r\n\r\n      self.formEditProgress = {\r\n         sliderProgress: $(\"#sliderProgress\", popupEditProgress).slider({\r\n            orientation: \"horizontal\",\r\n            range: \"min\",\r\n            max: 100,\r\n            width: 100,\r\n            from: 5,\r\n            to: 50,\r\n            step: 1,\r\n            value: argsTemplate.valuePercentBarComplete,\r\n            slide: $.proxy(self.onChangesliderProgress, self),\r\n            change: $.proxy(self.onChangesliderProgress, self)\r\n         }).each(function () {\r\n            var vals = $(this).slider(\"option\", \"max\") - $(this).slider(\"option\", \"min\");\r\n            for (var i = 0; i <= vals; i += 10) {\r\n               var el = $(\"<label class='step'>\" + (i) + \"</label>\").css(\"left\", (i / vals * 100) + \"%\");\r\n               $(this).append(el);\r\n            }\r\n         }),\r\n         numericTextBoxPlugin: $(\"#inputProgressNumericTextBox\", popupEditProgress).spinner({\r\n            format: \"n0\",\r\n            min: 0,\r\n            max: 100,\r\n            spin: $.proxy(self.onChangeNumericTextBoxProgress, self),\r\n            change: $.proxy(self.onChangeNumericTextBoxProgress, self),\r\n            value: argsTemplate.valuePercentBarComplete,\r\n            decimals: 0\r\n         }),\r\n         buttonChangeProgress: $(\"#button-accept-change-progress\", popupEditProgress),\r\n         buttonCancel: $(\"#button-cancel-change-progress\", popupEditProgress)\r\n      };\r\n\r\n      //Handlers\r\n      $(\".action-open-popup-edit-progress\", $content).on(\"click\", $.proxy(self.onShowPopupEditProgress, self));\r\n\r\n      self.formEditProgress.buttonCancel.on(\"click\", $.proxy(self.onClickCancel, self));\r\n      self.formEditProgress.buttonChangeProgress.on(\"click\", $.proxy(self.onSubmitFormChangeProgress, self));\r\n\r\n      self.updateProgressUI(argsTemplate.valuePercentBarComplete);\r\n      self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", argsTemplate.valuePercentBarComplete);\r\n\r\n   },\r\n\r\n   onNotifyUpdateItemFromRender: function(event, params){\r\n      var self = this;\r\n      var listItems = params.args.items;\r\n      var activityWork = params.args.activityWork;\r\n\r\n      var progress;      \r\n      if(listItems.length > 0){\r\n         //Hide edit progress\r\n         $(\".action-open-popup-edit-progress\", self.content).hide();\r\n      }else{\r\n         $(\".action-open-popup-edit-progress\", self.content).show();\r\n      }\r\n      //set new progress\r\n      $(\".bz-wp-timestamp span\", self.content).text(activityWork);\r\n      $(\".bz-wp-progress-bar\", self.content).css(\"width\", activityWork + \"%\");\r\n\r\n   },\r\n\r\n   updateProgressUI: function(newPercentProgress){\r\n      var self = this,\r\n         $content = self.getContent();\r\n\r\n      $(\".bz-wp-timestamp span\", $content).text(newPercentProgress);\r\n\r\n      //Begin Adjust status bar next to the number days\r\n      var $barRemainingDate = $(\".remaining-days .time-remaining\", $content);\r\n      var widthNumberDays = $(\".remaining-days .days\", $content).width();\r\n      $barRemainingDate.css(\"padding-left\", (widthNumberDays + 7).toString() + \"px\");\r\n\r\n      var $barCompletedDate = $(\".remaining-days .bar-completed\", $content);\r\n\r\n      $barCompletedDate.css(\"width\", newPercentProgress.toString() + \"%\");\r\n      //End Adjust status bar next to the number days\r\n   },\r\n\r\n   initPluginPopupEditProgress: function () {\r\n      var self = this;\r\n      var templatePopupEditProgress = self.getTemplate(\"plan-progress-popup-edit\");\r\n      self.dialogBox.formContent = templatePopupEditProgress.render();\r\n      return self.dialogBox.formContent;\r\n\r\n   },\r\n   /*\r\n    * UI\r\n    */\r\n\r\n   onShowPopupEditProgress: function(){\r\n      var self = this;\r\n\r\n      self.dialogBox.formContent.dialog({\r\n         resizable: false,\r\n         draggable: false,\r\n         height: \"auto\",\r\n         width: \"600px\",\r\n         modal: true,\r\n         title: bizagi.localization.getResource(\"workportal-project-plan-progress-title\"),\r\n         maximize: true,\r\n         open:  $.proxy(self.onOpenPopupPlan, self),\r\n         close: function () {\r\n            self.dialogBox.formContent.dialog(\"destroy\");\r\n            self.dialogBox.formContent.detach();\r\n         }\r\n      });\r\n\r\n      self.previusValueProgress = self.formEditProgress.sliderProgress.slider(\"value\");\r\n\r\n   },\r\n\r\n   onChangeNumericTextBoxProgress: function (event) {\r\n      var self = this;\r\n      var newValue = self.formEditProgress.numericTextBoxPlugin.spinner(\"value\");\r\n      self.formEditProgress.sliderProgress.slider(\"value\", newValue);\r\n   },\r\n\r\n   onChangesliderProgress: function (event) {\r\n      var self = this;\r\n      var newValue = self.formEditProgress.sliderProgress.slider(\"value\");\r\n      self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", newValue);\r\n   },\r\n\r\n   onClickCancel: function (event) {\r\n      event.preventDefault();\r\n      var self = this;\r\n\r\n      self.dialogBox.formContent.dialog(\"destroy\");\r\n      self.dialogBox.formContent.detach();\r\n      //return before value progress\r\n      self.formEditProgress.sliderProgress.slider(\"value\", self.previusValueProgress);\r\n      self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", self.previusValueProgress);\r\n   },\r\n\r\n   onSubmitFormChangeProgress: function (event) {\r\n      event.preventDefault();\r\n      var self = this;\r\n\r\n      self.formEditProgress.buttonChangeProgress.prop(\"disabled\", true);\r\n\r\n      var activityToShow = self.params.plan.activities.filter(function(activity){\r\n         return activity.id == self.params.plan.idActivitySelected;\r\n      })[0];\r\n       var params = $.extend(activityToShow, {\r\n           progress:  self.formEditProgress.numericTextBoxPlugin.spinner(\"value\"),\r\n           idPlan: self.params.plan.id\r\n       });\r\n      $.when(self.dataService.editActivityPlan(params)).done(function () {\r\n         self.formEditProgress.buttonChangeProgress.prop(\"disabled\", false);\r\n         activityToShow.progress = self.formEditProgress.numericTextBoxPlugin.spinner(\"value\");\r\n         self.updateProgressUI(activityToShow.progress);\r\n          self.dialogBox.formContent.dialog(\"destroy\");\r\n          self.dialogBox.formContent.detach();\r\n      });\r\n   }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.progress\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.progress], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Subprocesses Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.subprocesses\", {}, {\r\n      /*\r\n       *   Constructor\r\n       */\r\n      init: function (workportalFacade, dataService, params) {\r\n         var self = this;\r\n\r\n         // Call base\r\n         self._super(workportalFacade, dataService, params);\r\n\r\n         //Load templates\r\n         self.loadTemplates({\r\n            \"project-subprocesses\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.subprocesses\").concat(\"#project-plan-activity-plan-subprocesses-wrapper\"),\r\n            \"project-subprocesses-tootip-custom-properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.subprocesses\").concat(\"#project-activity-plan-subprocesses-tooltip-custom-properties-wrapper\")\r\n         });\r\n      },\r\n\r\n      /*\r\n       * Renders the template defined in the widget\r\n       */\r\n      renderContent: function () {\r\n         var self = this;\r\n         self.content = $(\"<div></div>\");\r\n         return self.content;\r\n      },\r\n\r\n      /*\r\n       * links events with handlers\r\n       */\r\n      postRender: function () {\r\n         var self = this;\r\n      }\r\n   }\r\n);\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.subprocesses\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.subprocesses]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Parent\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.parent\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"plan-parent-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.parent\").concat(\"#project-plan-activity-parent\")\r\n      });\r\n   },\r\n\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   postRender: function () {\r\n      var self = this;\r\n      self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\r\n   },\r\n\r\n   /**\r\n    * Notifies when an event is raised\r\n    */\r\n\r\n   onNotifyLoadInfoActivityExecution: function (event, params) {\r\n      var self = this;\r\n      self.params = $.extend(self.params, params.args);\r\n      var $content = self.getContent().empty();\r\n\r\n         $.when(self.dataService.getPlanParent({idPlan: self.params.plan.id})).done(function (planParent) {\r\n            self.params.plan.parent = planParent;\r\n            if(self.params.plan.parent){\r\n               var argsTemplate = {};\r\n               argsTemplate.parent = {\r\n                  idParent: self.params.plan.parent.radNumber,\r\n                  nameParent: self.params.plan.parent.displayName,\r\n                  idCase: self.params.plan.parent.idCase,\r\n                  idWorkflow: self.params.plan.parent.idWorkflow,\r\n                  idWorkItem: self.params.plan.parent.idWorkItem,\r\n                  idTask: self.params.plan.parent.idTask\r\n               };\r\n\r\n               //Update widget\r\n               var contentTemplate = self.getTemplate(\"plan-parent-main\");\r\n               contentTemplate\r\n                  .render(argsTemplate)\r\n                  .appendTo($content);\r\n\r\n               $(\"#go-to-parent-case\", $content).on(\"click\", $.proxy(self.onClickGoToParentCase, self));\r\n            }\r\n         });\r\n\r\n\r\n   },\r\n\r\n   onClickGoToParentCase: function (event) {\r\n      event.preventDefault();\r\n      var self = this;\r\n      self.routingExecute($(event.target).closest(\"#go-to-parent-case\"));\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.parent\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.parent], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Users Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.users\", {}, {\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      self.usersMap = {};\r\n      self.plugins = {};\r\n      self.usersInformation=[];\r\n      self.globalHandlersService = bizagi.injector.get('globalHandlersService');\r\n      self.usersAssignees = [];\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      //The load template the users plan because they are the same\r\n      self.loadTemplates({\r\n         \"plan-users-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.users\").concat(\"#project-plan-users\")\r\n      });\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   /*\r\n    * links events with handlers\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\r\n   },\r\n\r\n   /*\r\n    * validate if the activity is running\r\n    */\r\n   activityRuning: function (activity) {\r\n      return activity.startDate !== null && activity.finishDate === null;\r\n   },\r\n\r\n   onNotifyLoadInfoActivityExecution: function (event, params) {\r\n      var self = this,\r\n      cvsGuidUsers = [],\r\n         activitiesUsers = [],\r\n         $content = self.getContent().empty();\r\n      self.params = $.extend(self.params, params.args);\r\n\r\n      var ownerUserId = self.params.plan.idUserCreator;\r\n      var ownerUserGuid = self.params.plan.idUserCreator;\r\n\r\n      activitiesUsers.push({ \"idUser\": ownerUserId, \"guidUser\": ownerUserGuid, \"userType\": [\"owner\"] });\r\n      self.usersMap[\"-\" + ownerUserId + \"-\"] = {\r\n         picture: \"\",\r\n         id: ownerUserId,\r\n         guid: ownerUserGuid,\r\n         name: \"\",\r\n         userType: [\"owner\"]\r\n      };\r\n      cvsGuidUsers.push(ownerUserGuid);\r\n      $.each(self.params.plan.activities, function (index, activity) {\r\n         if (self.activityRuning(activity)) {\r\n            var userId = activity.userAssigned;\r\n            var userGuid = activity.userAssignedGuid;\r\n            if (userId === ownerUserId) {\r\n               if($.inArray(\"Assigned\", activitiesUsers[0].userType) === -1){\r\n                  activitiesUsers[0].userType.push(\"Assigned\");\r\n                  self.usersMap[\"-\" + ownerUserId + \"-\"].userType.push(\"Assigned\");\r\n               }\r\n            }\r\n            else {\r\n               self.usersMap[\"-\" + userId + \"-\"] = {\r\n                  picture: \"\",\r\n                  id: userId,\r\n                  name: \"\",\r\n                  userType: [\"Assigned\"]\r\n               };\r\n               if (activitiesUsers.filter(function(user) { return user.idUser == userId; }).length === 0) {\r\n                  var id=userGuid?userGuid:userId;\r\n                  activitiesUsers.push({\"idUser\": id, \"userGuid\": id, \"userType\": [\"Assigned\"]});\r\n                  cvsGuidUsers.push(id);\r\n               }\r\n            }  \r\n         }\r\n      });\r\n      self.activitiesUsers = activitiesUsers;\r\n\r\n      //Update widget\r\n      var contentTemplate = self.getTemplate(\"plan-users-main\");\r\n      contentTemplate\r\n         .render({\r\n            assignee: self.justAssignees(activitiesUsers),\r\n            label: bizagi.localization.getResource(\"workportal-project-plan-assignee\")\r\n         })\r\n         .appendTo($content);\r\n        self.addEventHandlersModal();\r\n      $.when(self.callGetDataUsers(cvsGuidUsers)).then(function () {\r\n         self.showCreatorInformation(ownerUserId);\r\n         self.renderUserProfilesAndImages();\r\n      });\r\n   },\r\n\r\n   /**\r\n    * return standar userAdapter information with only assigned users\r\n    * @param {Array} allUsers \r\n    */\r\n   justAssignees: function (allUsers) {\r\n       var usersAssignee=[];\r\n       allUsers.map(function(user) {\r\n           var isOwner=user.userType.indexOf(\"owner\")!==-1;\r\n           var isAssignee=user.userType.indexOf(\"Assigned\")!==-1;\r\n           usersAssignee.push(usersAdapter.createJsonUserInfo(user.idUser, \"\", \"\", \"\", \"\", \"\", isAssignee, isOwner, [], []));\r\n       });\r\n       return usersAdapter.justAssignees(usersAssignee);\r\n   },\r\n   \r\n   /**\r\n    * show the information of the creator case\r\n    * @param {string} ownerUserId guid user creator\r\n    */\r\n   showCreatorInformation: function (ownerUserId) {\r\n       var self = this;\r\n       var userCreator=self.usersMap[\"-\"+ownerUserId+\"-\"];\r\n       var userInfo = usersAdapter.createJsonUserInfo(\r\n           userCreator.id,\r\n           userCreator.name,\r\n           userCreator.username,\r\n           userCreator.picture?userCreator.picture:undefined,\r\n           userCreator.email,\r\n           userCreator.name.getInitials(),\r\n           false,\r\n           true,\r\n           [],\r\n           []\r\n       );\r\n       self.content.find(\".ui-bizagi-wp-project-plan-users .ui-bizagi-wp-project-users-creator-info\").userinformation(self, { user: userInfo });\r\n   },\r\n\r\n   /**\r\n    * UI\r\n    */\r\n\r\n   renderUserProfilesAndImages: function () {\r\n       var self = this;\r\n       $.each(self.usersMap, function (i, obj) {\r\n           var $li = $(\".ui-bizagi-wp-userlist li[data-iduser=\" + obj.id + \"]\", self.content);\r\n           if (obj.picture !== \"\") {\r\n               $li.find(\"img\").prop(\"src\", obj.picture);\r\n           }\r\n           else {\r\n               $li.find(\"img\").hide();\r\n               if(obj.name!==undefined){\r\n                  $li.find(\"span\").html(obj.name.getInitials());\r\n               }\r\n               else{\r\n                  console.log(\"obj.name is undefined\");\r\n               }\r\n\r\n           }\r\n       });\r\n       $(\".ui-bizagi-wp-userlist li\", self.content).not(\".moreUsers\").on('mouseenter', function (ev) {\r\n         var $target = $(ev.target);  \r\n         var userId = $(this).data(\"iduser\");\r\n         var userSelected;\r\n         $.each(self.usersMap, function (i, obj) {\r\n            if(obj.id === userId)\r\n               userSelected=obj;\r\n        });\r\n         var usersActivities=self.usersAssignees.find(function(assignee) {\r\n            return assignee.userAssigned === userSelected.id;\r\n         });\r\n         var activities=[];\r\n         if(usersActivities)\r\n            usersActivities.activities.map(function(activity) {\r\n               activities.push(activity.name);\r\n            });\r\n         var userParam = usersAdapter.createJsonUserInfo(userSelected.id, userSelected.name, userSelected.username, userSelected.picture, userSelected.email, userSelected.name.getInitials(), self.getIsAssignee(userSelected), self.getIsOwner(userSelected), activities, undefined);\r\n                     \r\n         $target.parent().usertooltip(self,{target:$target,user:userParam});\r\n      });\r\n   },\r\n\r\n   getIsAssignee: function(userSelected){\r\n      if(userSelected.userType.indexOf(\"Assigned\") > -1){\r\n          return true;\r\n      }\r\n      return false;\r\n     },\r\n  \r\n     getIsOwner : function(userSelected){\r\n      if(userSelected.userType.indexOf(\"owner\") > -1){\r\n          return true;\r\n      }\r\n      return false;\r\n     },\r\n   /*\r\n    *  Get data for users\r\n    */\r\n   callGetDataUsers: function (cvsGuidUsers) {\r\n      var self = this,\r\n         params = {},\r\n         defer = $.Deferred();\r\n      params = {\r\n         usersGuids: cvsGuidUsers.join(),\r\n         width: 50,\r\n         height: 50\r\n      };\r\n      $.when(self.dataService.getUsersData(params)).always(function (response) {\r\n        self.usersInformation= response;\r\n         for (var i = 0, length = response.length; i < length; i += 1) {\r\n            if (typeof (response[i].name) === \"undefined\") {\r\n               bizagi.log(response[i] + \" Id Not Found\", response, \"error\");\r\n            } else {\r\n               if(self.usersMap[\"-\" + response[i].id + \"-\"]){\r\n                  self.usersMap[\"-\" + response[i].id + \"-\"].picture += (response[i].picture) ? \"data:image/png;base64,\" + response[i].picture : \"\";\r\n                  self.usersMap[\"-\" + response[i].id + \"-\"].name = response[i].name || \"\";\r\n                  self.usersMap[\"-\" + response[i].id + \"-\"].username = response[i].username || \"\";\r\n                  self.usersMap[\"-\" + response[i].id + \"-\"].email = response[i].email || \"\";\r\n               }\r\n               else{\r\n                  console.log(\"The object is undefined\");\r\n               }\r\n            }\r\n         }\r\n         self.getUsersAssignees();\r\n         defer.resolve();\r\n      });\r\n      return defer.promise();\r\n   },\r\n\r\ngetUsersAssignees: function(){\r\n    var self = this;\r\n    for(var i=0; i<self.usersInformation.length; i++){\r\n        self.usersAssignees.push(self.getUserAssignee(self.usersInformation[i]));\r\n    }\r\n\r\n},\r\n\r\ngetUserAssignee: function(user){\r\n    var self =  this;\r\n    var tasks = [];\r\n    $.each(self.params.plan.activities, function (index, activity) {\r\n        var userId = activity.userAssigned;\r\n        if (userId === user.id && self.activityRuning(activity)) {\r\n            tasks.push({ \"name\": activity.name });\r\n        }\r\n    });\r\n    user.tasks = tasks;\r\n    var types = self.activitiesUsers.find(function(actUser) {\r\n        return actUser.idUser == user.id;\r\n    });\r\n    user.userType = types.userType;\r\n\r\n    var userAssignees = usersAdapter.createJsonUserInfo(\r\n        user.id, \r\n        user.name, \r\n        user.username, \r\n        user.picture ? \"data:image/png;base64,\" + user.picture : undefined, \r\n        user.email, \r\n        user.name.getInitials(),\r\n        self.getIsAssignee(user), \r\n        self.getIsOwner(user), \r\n        user.tasks, \r\n        []);\r\n\r\n        return userAssignees;\r\n   },\r\n\r\n   addEventHandlersModal: function () {\r\n    var self =  this;\r\n    $(\".moreUsers\").click(function(event) {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        var usersAssignees = self.usersAssignees || [];\r\n        self.globalHandlersService.publish(\"showDialogWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL,\r\n            closeVisible: true,\r\n            data: usersAssignees,\r\n            maximize: true,\r\n            modalParameters: {\r\n                title: bizagi.localization.getResource(\"workportal-project-users-title\")+ \" (\"+usersAssignees.length+\")\",\r\n                width: 790,\r\n                height: 526,\r\n                refreshInbox: false\r\n            }\r\n        });\r\n     });\r\n   }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.users\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.users], true);"]}