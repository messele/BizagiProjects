{"version":3,"sources":["jquery/common/bizagi.pagination/js/jquery.bizagi.pagination.js","jquery/workportal/js/plugins/jquery.bizagi.pagination.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.inbox.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.listCases.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.inboxGrid.js","jquery/workportal/js/desktop/inbox/bizagi.workportal.inbox.rowsPerPage.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.integration.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.inbox.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.inboxGrid.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.folders.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.smartfolders.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.folders.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.smartfolders.js"],"names":["$","fn","bizagiPagination","options","opt","limInf","totalPages","actualPage","listElement","first","firstClass","prev","prevClass","next","nextClass","last","lastClass","liClass","arrowClass","selectedFocus","clickCallBack","pagination","previousPage","nextPage","pageScroll","increment","displace","firstPageValue","data","lastPageValue","displaceElements","firstElementValue","pageData","each","key","value","this","find","html","attr","hasClass","removeClass","addClass","length","parent","css","extend","totalElements","prepend","append","click","page","trim","self","hover","setInterval","clearInterval","back","halfDisplace","Math","round","init","jQuery","max","parseInt","disableFirst","disableLast","bizagi","workportal","widgets","widget","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_INBOX","renderContent","template","getTemplate","enableFolders","undefined","override","enableFolder","enableSmartFolders","content","tmpl","currentInboxView","renderSummaryForm","container","def","Deferred","proxyPrefix","dataService","serviceLocator","loader","start","then","rendering","facade","execute","canvas","summaryForm","idCase","renderingFacade","setTimeout","resizeLayout","when","ready","done","resolve","promise","routingExecute","element","val","idWorkflow","idWorkItem","idTask","eventAsTasks","publish","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","BIZAGI_WORKPORTAL_WIDGET_LISTCASES","setTableHeadFixed","params","TableElement","floatThead","floatOptions","groupByCaseNumber","util","isIE","hide","listCases","BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID","security","menuSecurity","obj","Class","initCombo","comboDataSource","combo","id","values","Array","bizagiConfig","inboxRowsPerPage","indexOf","push","sort","a","b","map","v","name","_findValue","finding","c","initialValueCombo","initValueCombo","rowCookie","getRowValueCookie","numberRows","defaultValue","renderNumberRowsCombo","deferred","comboWrapper","empty","setRowValueCookie","lastValue","uicombo","isEditable","itemValue","itemText","onComplete","onChange","ui","initValue","workportalFacade","module","selector","BIZAGI_WORKPORTAL_WIDGET_INTEGRATION","document","createElement","postRender","clean","_super","inbox","taskState","icoTaskState","adhocCases","loadTemplates","concat","inbox-cases","inbox-cases-list","inbox-cases-personalized-list","inbox-common-processes","inbox-common-noresults","inbox-common-header-view","inbox-common-case-summary","inbox-common-case-summary-form","inbox-common-case-summary-subprocess","inbox-common-case-summary-assignees","inbox-common-case-summary-events","inbox-common-case-summary-oldrender","useNewEngine","referrerParams","processesTemplate","casesTemplate","casesTemplateList","caseSummaryTemplate","caseSummaryTemplateForm","caseSummaryTemplateSubprocess","caseSummaryTemplateAssigness","caseSummaryTemplateEvents","noResults","paginationTemplate","getInboxSummary","summary","updateSummary","changeTaskState","configureViewControl","configureSmartFolders","comboRowsPerPage","rowsPerPage","getContent","changeProcess","services","preferences","getPreferences","modifiedJSONCookie","strValues","JSON","stringify","overridePreferences","currentPopup","popupOpened","widgetName","BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS","sourceElement","modalClass","max-height","height","width","offset","activeScroll","foldersView","closed","desktop","popup","closePopupInstance","eyeIcon","eyeIconParent","at","arrowPosition","left","render","popupContent","close","k","e","All","Red","Green","Yellow","processesContainer","smartfoldersParameters","urlParameters","previewTaskState","onlyFavorites","getAllProcesses","categories","appendTo","getStoredQueryFormList","storedQueryForm","storedQueryForms","getWidget","pipe","result","event","process","currentTarget","tagName","workflowName","text","stopPropagation","elmnt","idObject","favoriteType","addFavorite","favoritesData","updateCountProcess","delFavorite","trigger","arrow","is","show","lastProcess","restoreStatus","key2","value2","bizagiScrollbar","isAvailableTimelineByProcessType","isAdhocProcess","isEnableFeature","casesContainer","pageSelector","descContainer","nElemToShow","showErrorAlertDialog","getCasesByWorkflow","eval","pageSize","lstIdCases","rows","index","elem","enableTimelineByProcessType","processName","pages","totPages","pageToshow","i","pageNumber","command","graphicQuery","checkSecurityPerm","paginationHtml","enableFeatureShowTimelineButton","replaceLineBreak","string","search","replaceAll","formatMonetaryCell","formatMoney","BIZAGI_DEFAULT_CURRENCY_INFO","formatDecimalCell","decimalFormat","externalDecimalFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","roundToDecimalPlace","decimalDigits","colorize","groupDigits","negativeFormat","positiveFormat","symbol","formatDecimal","formatBoolean","parseBoolean","getResource","formatInvariantDate","cAse","children","changeCase","BIZAGI_WORKPORTAL_WIDGET_FOLDERS","onlyFolderMode","favoriteOptions","fail","error","parse","responseText","caseSummaryContainer","errorTemplate","message","errorHtml","cache","htmlContent","isAdhoc","idProcess","idAdhocProcess","summaryCaseDetails","hasComments","contextualized","currentState","forEach","state","displayName","processPath","delegate","tabs","active","create","activate","newPanel","comments","readOnly","renderComments","setContext","commentsFocus","bind","isPropagationStopped","oldrenderevent","eventMethod","window","addEventListener","eventer","getWorkitems","onlyUserWorkItems","workItems","idWorkitem","url","getUrl","iframeOldRender","performResizeLayout","getCaseFormsRenderVersion","formsVersion","formsRenderVersion","summarySubProcess","subprocess","summaryAssigness","preview","assignees","eventsUniqueList","events","split","el","inArray","join","activitiesUniqueList","activities","summaryCaseEvents","caseNumber","closest","showTimeLine","radNumber","showGraphicQuery","button","referrer","autohide","casesPagination","listContainer","resize","forceResize","assigned","workflows","idworkflow","count","localization","iframe","queryString","readQueryString","load","contents","cssLocation","browser","mozilla","webkit","replace","inboxGrid","adhocIds","inbox-grid","inbox-grid-rubik","inbox-grid-cases","remove","prototype","apply","arguments","procContainer","setFiltersOnChangeProcess","res","orderFieldName","orderType","order","getCustomizedColumnsData","group","cases","caseId","processId","columnTitle","isArray","workitems","TaskName","State","pdata","formatDecimalAndMoneyCell","timeLine","renderedTemplate","showMagicButton","enableAdhocProcess","setFormat","formatValue","formatCategories","isDate","getRadNumberColumnIndex","l","fieldName","showColumn","columnIndex","createGroupedHeader","rowIndex","getRadNumber","row","fields","isIEAndFirstRowAndGroupCases","isIE9","expr","RegExp","tbhtml","ShowTimeInInboxDates","maxElemShow","tooltip","parents","showCase","preventDefault","queryTableElement","position","zIndex","scrollContainer","adhocProcessId","caseSummaryDialog","dialog","buttons","modal","title","draggable","resizable","formatRequest","dispose","getEventListener","on","folders","folders-elements","folders-empty-elements","folders-query-tree","folders-query-confirm","folders-default","folders-input-new","folders-add-case","folders-elements-node","folders-query-edit","smartfolders","smartfolders-elements","smartfolders-empty-elements","smartfolders-query-confirm","smartfolders-default","smartfolders-add-case","smartfolders-elements-node","smartfolders-query-tree","smartfolders-query-edit","smartfolders-input-new","configureTreeNavigation","configureBackButton","renderFolders","scrollVertical","renderDefaultFolders","appendElement","queryContent","mergeData","emptyTemplate","mergeNewFolder","getFolders","idParent","childs","categoryWithLink","countChilds","configureNavTree","queriesContainer","confirm","headerTemplate","categoryTree","queriesListDisplay","idParentQuery","queryDisplayName","makeFolder","listElements","getCasesByFolder","customized","casesGroupedByFolder","idFolder","BIZAGI_WORKPORTAL_WIDGET_SEARCH","beforeElement","style","idParentDone","editFolder","idCustomFolder","deleteFolder","ico","associateCaseToFolder","btnBack","nodeTemplate","newElement","insertAfter","focus","folderName","checkRepeatFolderName","idParentFolder","keyCode","args","folderNameAvailable","not","replaceWith","updateFolder","nextAll","showQueryFormPopup","arg","idQuery","idStoredQuery","queryFormAction","BIZAGI_WORKPORTAL_WIDGET_QUERYFORM","idQueryForm","modalParameters","getSmartFolders","widgetRedirect","viewSmartFoldersAsSearch","idSmartFolder","deleteSmartFolder","idUser","currentUser","endPoint","BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME","widgetURL"],"mappings":"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","sourcesContent":["/* \r\n * Simple Pagination Control for Bizagi Workportal\r\n * @author: Edward J Morales\r\n */\r\n\r\n(function ($) {\r\n    $.fn.bizagiPagination = function (options){\r\n        // define options\r\n        options = options || {};\r\n        \r\n        var opt = {\r\n            limInf : 0,\r\n            totalPages: 1,\r\n            actualPage: 1,            \r\n            \r\n            // Controllers elements\r\n            listElement: $(\"ul\"),\r\n            first: '&lt;&lt;',\r\n            firstClass: \"first\",\r\n            prev: '&lt;',\r\n            prevClass: 'prev',\r\n            next: \"&gt;\",\r\n            nextClass: \"next\",\r\n            last: \"&gt;&gt;\",\r\n            lastClass: \"last\",\r\n            \r\n            // Default class of pagination template, ui-bizagi-workportal-widget-inbox-common-pagination\r\n            // <li {{if page==pageNumber}} class=\"page active\" {{else}} class=\"page\" {{/if}} data-page=\"${pageNumber}\">\r\n            // <span class=\"number\">${pageNumber}</span>\r\n            // </li>\r\n            liClass: \"bz-page\",\r\n            arrowClass: \"bz-pageArrow\",\r\n            \r\n            // Auto focus on selected element\r\n            selectedFocus: true,\r\n            \r\n            // Call back methods\r\n            clickCallBack: function(){}\r\n            \r\n        };\r\n\t\t\r\n\t\t\r\n\t\tif(options.actualPage > options.totalPages){\r\n\t\t\toptions.actualPage = options.totalPages;\r\n\t\t}\r\n        \r\n        var pagination = {\r\n            previousPage: (opt.actualPage > 1)? opt.actualPage - 1 : 1,\r\n            nextPage: (opt.actualPage < opt.totalPages )? opt.actualPage + 1 : opt.totalPages\r\n        }\r\n        \r\n        // Extend options\r\n        $.extend(opt,opt,options);\r\n        \r\n        \r\n        function init(){\r\n            // Count total elements\r\n            opt.totalElements = $(\"li.\" + opt.liClass, opt.listElement).length;\r\n            \r\n            \r\n            // Add control elements\r\n            if(opt.totalPages > opt.totalElements && opt.totalElements > 1){\r\n                appendControlsArrows();\r\n            }\r\n            \r\n            // Add events\r\n            bindElements();\r\n                        \r\n            // Set focus\r\n            if(opt.selectedFocus && opt.actualPage >= opt.totalElements && opt.totalPages > opt.totalElements){\r\n                var firstElementValue;\r\n                var halfDisplace = (opt.actualPage - Math.round(opt.totalElements / 2));\r\n\t\t\t\t\r\n                if(halfDisplace < 1 ){\r\n                    firstElementValue = 1;\r\n                }else if((halfDisplace + opt.totalElements) > opt.totalPages){\r\n                    firstElementValue = (opt.totalPages - opt.totalElements);\r\n                    firstElementValue = (firstElementValue < 1)?1:firstElementValue;\r\n                }else{\r\n                    firstElementValue = halfDisplace;\r\n                }\r\n\t\t\t\t\r\n                if(opt.listElement.find(\"li.active\").length==0){\r\n\t\t\t\t\tdisplaceElements(firstElementValue,1);\r\n\t\t\t\t}\r\n            }\r\n        }\r\n        \r\n        // Append control arrow to list\r\n        function appendControlsArrows(){\r\n            // add prev arrow\r\n                opt.listElement.prepend(\"<li/>\").find(\"li:first\").addClass(opt.prevClass).data(\"page\",pagination.previousPage).html(opt.prev);\r\n             \r\n                // add first arrow\r\n                opt.listElement.prepend(\"<li/>\").find(\"li:first\").addClass(opt.arrowClass +\" \"+opt.firstClass).data(\"page\",\"1\").html(opt.first);\r\n             \r\n                // add next arrow\r\n                opt.listElement.append(\"<li/>\").find(\"li:last\").addClass(opt.nextClass).data(\"page\",pagination.nextPage).html(opt.next);\r\n             \r\n                // add last arrow\r\n                opt.listElement.append(\"<li/>\").find(\"li:last\").addClass(opt.arrowClass +\" \"+opt.lastClass).data(\"page\",opt.totalPages).html(opt.last);                         \r\n            }\r\n            \r\n        \r\n        // Add events\r\n        function bindElements(){\r\n            // Click event for list element\r\n            var options = {};\r\n            $(\"li.\"+opt.liClass+\", li.\"+opt.arrowClass ,opt.listElement).click(function(){\r\n                // Next line now includes a ternary operator in order to confirm last arrow (>>) if going indeed to the last page\r\n                options.page = ($(this).hasClass(opt.lastClass)) ?  opt.totalPages : $.trim($(this).data(\"page\") + \" \");\r\n                options.parent = $(this).parent();\r\n                options.self = $(this);\r\n                opt.clickCallBack( options );\r\n            });\r\n            \r\n            bindNextArrow();\r\n            bindPrevArrow();            \r\n        }\r\n        \r\n        \r\n        // Bind for back scroll\r\n        function bindPrevArrow(){\r\n            $(\"li.\"+opt.prevClass,opt.listElement).hover(function(){\r\n                back = setInterval(function(){\r\n                        pageScroll(-1);\r\n                },300);\r\n            },function() {\r\n                clearInterval(back);\r\n            });\r\n        }\r\n            \r\n        // Bind for next scroll\r\n        function bindNextArrow(){\r\n            $(\"li.\"+opt.nextClass,opt.listElement).hover(function(){\r\n                next = setInterval(function(){\r\n                        pageScroll(1);\r\n                },300);\r\n            },function() {\r\n                clearInterval(next);\r\n            });                       \r\n        }\r\n        \r\n        // Change values of elements\r\n        function pageScroll(increment){\r\n            // if increment its positive, execute rigth scroll\r\n            // if invrement its negative, execute left scroll\r\n            increment = increment || 1;\r\n            var displace = false;\r\n            \r\n            // Define first element value\r\n            var firstPageValue = $(\"li.\"+opt.liClass+\":first\",opt.listElement).data(\"page\");\r\n            var lastPageValue = $(\"li.\" + opt.liClass + \":last\", opt.listElement).data(\"page\");\r\n            \r\n            \r\n            // Check left scroll - decrement\r\n            if(increment < 0 && firstPageValue > 1){\r\n                displace = true;                \r\n            }else if(increment > 0 && lastPageValue < opt.totalPages){\r\n                displace = true;    \r\n            }\r\n                \r\n            if(displace){\r\n                displaceElements(firstPageValue,increment);\r\n            }    \r\n        }\r\n        \r\n        // Displace elements\r\n        function displaceElements(firstElementValue,increment){\r\n            firstElementValue = firstElementValue || 1;\r\n            increment = increment || 0;\r\n            var pageData;\r\n            \r\n            if(increment > 0){\r\n                // Increment                \r\n                pageData = firstElementValue;\r\n            }else if(increment < 0){\r\n                // Decrement  \r\n                pageData = firstElementValue - 2;\r\n            }else{\r\n                return;\r\n            }\r\n\r\n            $.each($(\"li.\" + opt.liClass, opt.listElement), function (key, value) {                \r\n                pageData++;\r\n                $(this).data(\"page\",pageData);\r\n                $(this).find(\"span\").html(pageData);\r\n                // Changes the attribute content of data-page with the current number pageData\r\n                $(this).attr(\"data-page\",pageData);\r\n                // Check if selected style\r\n                if(opt.actualPage == pageData && !$(this).hasClass(\"active\")){\r\n                    $(this).addClass(\"active\");  \r\n                }else{\r\n                    $(this).removeClass(\"active\");\r\n                }\r\n            });\r\n            \r\n            // Show or hide tooltip pagination\r\n            if( $(opt.listElement).find(\".active\").length == 1){\r\n                $(opt.listElement).parent().find(\"#tooltipPagination\").css(\"visibility\",\"hidden\");\r\n            }else{\r\n                $(opt.listElement).parent().find(\"#tooltipPagination\").css(\"visibility\",\"visible\"); \r\n            }\r\n                  \r\n          /* WTF??\r\n\t    // Next lines for pagination with a lot of cases\r\n             if ( ($(opt.listElement).find(\".active\")).attr(\"data-page\") > 14 && $(\"ul\").eq(-2).find(\"li\").eq(5).attr(\"data-page\")) {  \r\n                $(\"ul\").eq(-1).css(\"top\",\"-28px\"); $(\"ul\").eq(-2).css(\"visibility\",\"hidden\"); \r\n             } else if ($(\"ul\").eq(-2).find(\"li\").eq(5).attr(\"data-page\")) { \r\n                $(\"ul\").eq(-1).css(\"top\",\"auto\");   $(\"ul\").eq(-2).css(\"visibility\",\"visible\"); \r\n             }\r\n\t     */\r\n        }               \r\n\r\n        // Init plugin\r\n        init();\r\n    };    \r\n})(jQuery);\r\n\r\n\r\n\r\n","/* \r\n* Simple Pagination Control for Bizagi Workportal\r\n* @author: Edward J Morales\r\n*/\r\n\r\n(function ($) {\r\n    $.fn.bizagiPagination = function (options) {\r\n        // define options\r\n        options = options || {};\r\n\r\n        var opt = {\r\n            limInf: 0,\r\n            totalPages: 1,\r\n            actualPage: 1,\r\n\r\n            // Controllers elements\r\n            listElement: $(\"ul\"),\r\n            first: '&lt;&lt;',\r\n            firstClass: \"first\",\r\n            prev: '&lt;',\r\n            prevClass: 'prev',\r\n            next: \"&gt;\",\r\n            nextClass: \"next\",\r\n            last: \"&gt;&gt;\",\r\n            lastClass: \"last\",\r\n\r\n            // Default class of pagination template, ui-bizagi-workportal-widget-inbox-common-pagination\r\n            // <li {{if page==pageNumber}} class=\"page active\" {{else}} class=\"page\" {{/if}} data-page=\"${pageNumber}\">\r\n            // <span class=\"number\">${pageNumber}</span>\r\n            // </li>\r\n            liClass: \"bz-page\",\r\n            arrowClass: \"bz-pageArrow\",\r\n\r\n            // Auto focus on selected element\r\n            selectedFocus: true,\r\n\r\n            // Call back methods\r\n            clickCallBack: function () { }\r\n\r\n        };\r\n\r\n\r\n        if (options.actualPage > options.totalPages) {\r\n            options.actualPage = options.totalPages;\r\n        }\r\n\r\n        \r\n        // Extend options\r\n        $.extend(opt, opt, options);\r\n        \r\n        var pagination = {\r\n            previousPage: Math.max(1,parseInt(opt.actualPage) - 1),\r\n            nextPage: parseInt(opt.actualPage) + 1\r\n        }\r\n\r\n        function init() {\r\n            // Count total elements\r\n            opt.totalElements = $(\"li.\" + opt.liClass, opt.listElement[0]).length;\r\n\r\n\r\n            // Add control elements\r\n            if (opt.totalPages > opt.totalElements && opt.totalElements > 1) {\r\n                appendControlsArrows();\r\n            }\r\n\r\n            // Add events\r\n            bindElements();\r\n\r\n            // Set focus\r\n            if (opt.selectedFocus && opt.actualPage >= opt.totalElements && opt.totalPages > opt.totalElements) {\r\n                var firstElementValue;\r\n                var halfDisplace = (opt.actualPage - Math.round(opt.totalElements / 2));\r\n\r\n                if (halfDisplace < 1) {\r\n                    firstElementValue = 1;\r\n                } else if ((halfDisplace + opt.totalElements) > opt.totalPages) {\r\n                    firstElementValue = (opt.totalPages - opt.totalElements);\r\n                    firstElementValue = (firstElementValue < 1) ? 1 : firstElementValue;\r\n                } else {\r\n                    firstElementValue = halfDisplace;\r\n                }\r\n\r\n                if (opt.listElement.find(\"li.active\").length == 0) {\r\n                    displaceElements(firstElementValue, 1);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Append control arrow to list\r\n        function appendControlsArrows() {\r\n\r\n            var disableFirst=pagination.previousPage==opt.actualPage;\r\n            var disableLast=opt.actualPage==opt.totalPages;\r\n\r\n            // add prev arrow\r\n            opt.listElement.prepend(\"<li/>\").find(\"li:first\").addClass(opt.prevClass).addClass(disableFirst?\"pagination-disabled\":\"\").data(\"page\", pagination.previousPage).html(opt.prev);\r\n\r\n            // add first arrow\r\n            opt.listElement.prepend(\"<li/>\").find(\"li:first\").addClass(opt.arrowClass + \" \" + opt.firstClass).addClass(disableFirst?\"pagination-disabled\":\"\").data(\"page\", \"1\").html(opt.first);\r\n\r\n            // add next arrow\r\n            opt.listElement.append(\"<li/>\").find(\"li:last\").addClass(opt.nextClass).addClass(disableLast?\"pagination-disabled\":\"\").data(\"page\", pagination.nextPage).html(opt.next);\r\n\r\n            // add last arrow\r\n            opt.listElement.append(\"<li/>\").find(\"li:last\").addClass(opt.arrowClass + \" \" + opt.lastClass).addClass(disableLast?\"pagination-disabled\":\"\").data(\"page\", opt.totalPages).html(opt.last);\r\n        }\r\n\r\n\r\n        // Add events\r\n        function bindElements() {\r\n            // Click event for list element\r\n            var options = {};\r\n            $(\"li:not(.pagination-disabled)\", opt.listElement).click(function () {\r\n                // Next line now includes a ternary operator in order to confirm last arrow (>>) if going indeed to the last page\r\n                options.page = ($(this).hasClass(opt.lastClass)) ? opt.totalPages : $.trim($(this).data(\"page\") + \" \");\r\n                options.parent = $(this).parent();\r\n                options.self = $(this);\r\n                opt.clickCallBack(options);\r\n            });\r\n        }\r\n\r\n        // Change values of elements\r\n        function pageScroll(increment) {\r\n            // if increment its positive, execute right scroll\r\n            // if increment its negative, execute left scroll\r\n            increment = increment || 1;\r\n            var displace = false;\r\n\r\n            // Define first element value\r\n            var firstPageValue = $(\"li.\" + opt.liClass + \":first\", opt.listElement).data(\"page\");\r\n            var lastPageValue = $(\"li.\" + opt.liClass + \":last\", opt.listElement).data(\"page\");\r\n\r\n\r\n            // Check left scroll - decrement\r\n            if (increment < 0 && firstPageValue > 1) {\r\n                displace = true;\r\n            } else if (increment > 0 && lastPageValue < opt.totalPages) {\r\n                displace = true;\r\n            }\r\n\r\n            if (displace) {\r\n                displaceElements(firstPageValue, increment);\r\n            }\r\n        }\r\n\r\n        // Displace elements\r\n        function displaceElements(firstElementValue, increment) {\r\n            firstElementValue = firstElementValue || 1;\r\n            increment = increment || 0;\r\n            var pageData;\r\n\r\n            if (increment > 0) {\r\n                // Increment                \r\n                pageData = firstElementValue;\r\n            } else if (increment < 0) {\r\n                // Decrement  \r\n                pageData = firstElementValue - 2;\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            $.each($(\"li.\" + opt.liClass, opt.listElement), function (key, value) {\r\n                pageData++;\r\n                $(this).data(\"page\", pageData);\r\n                $(this).find(\"span\").html(pageData);\r\n                // Changes the attribute content of data-page with the current number pageData\r\n                $(this).attr(\"data-page\", pageData);\r\n                // Check if selected style\r\n                if (opt.actualPage == pageData && !$(this).hasClass(\"active\")) {\r\n                    $(this).addClass(\"active\");\r\n                } else {\r\n                    $(this).removeClass(\"active\");\r\n                }\r\n            });\r\n\r\n            // Show or hide tooltip pagination\r\n            if ($(opt.listElement).find(\".active\").length == 1) {\r\n                $(opt.listElement).parent().find(\"#tooltipPagination\").css(\"visibility\", \"hidden\");\r\n            } else {\r\n                $(opt.listElement).parent().find(\"#tooltipPagination\").css(\"visibility\", \"visible\");\r\n            }\r\n        }\r\n\r\n        // Init plugin\r\n        init();\r\n    };\r\n})(jQuery);\r\n\r\n\r\n\r\n","/*\r\n*   Name: BizAgi Workportal Inbox Widget Controller\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class to to define the inbox widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.inbox\", {}, {\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"inbox\");\r\n        var data = {};\r\n\r\n        // Enable or disable functionality\r\n        data.enableFolders = (bizagi.override != undefined && bizagi.override.enableFolder) ? true : false;\r\n        data.enableSmartFolders = (bizagi.override != undefined && bizagi.override.enableSmartFolders) ? true : false;\r\n\r\n        // Render content\r\n        var content = self.content = $.tmpl(template, data);\r\n\r\n        // Set inbox view variable\r\n        bizagi.workportal.currentInboxView = self.getWidgetName();\r\n\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    *   Renders the summary form inside a given container\r\n    */\r\n    renderSummaryForm: function (container) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) !== \"undefined\")\r\n            ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            // Load render page\r\n            var rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n\r\n            // Executes rendering into render container\r\n            rendering.execute({\r\n                canvas: container,\r\n                summaryForm: true,\r\n                idCase: self.idCase\r\n            });\r\n\r\n            // Keep reference to rendering facade\r\n            self.renderingFacade = rendering;\r\n\r\n            // Resize layout\r\n            setTimeout(function () {\r\n                self.resizeLayout();\r\n            }, 1000);\r\n\r\n            // Resolve main deferred\r\n            $.when(rendering.ready())\r\n            .done(function () {\r\n                def.resolve();\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    routingExecute: function (element) {\r\n        // Executes routing action\r\n        if (element == undefined) {\r\n            return false;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        var idCase = element.find(\"#idCase\").val();\r\n        var idWorkflow = element.find(\"#idWorkflow\").val();\r\n        var idWorkItem = element.find(\"#idWorkItem\").val();\r\n        var idTask = element.find(\"#idTask\").val();\r\n        var eventAsTasks = element.find(\"#eventAsTasks\").val() || false;\r\n\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            idWorkflow: idWorkflow,\r\n            idWorkItem: idWorkItem,\r\n            idTask: idTask,\r\n            eventAsTasks: eventAsTasks\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop List Cases implementation\r\n*   Author: Kevin Alvarado\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.listCases\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_LISTCASES;\r\n    },\r\n    \r\n    /**\r\n    * Set the table with the fixed thead\r\n    * @param {Json} params TableElement,groupByCaseNumber,floatOptions\r\n    */\r\n    setTableHeadFixed:function(params) {\r\n        params.TableElement.floatThead(params.floatOptions);\r\n        \r\n        if(params.groupByCaseNumber && bizagi.util.isIE()){\r\n            params.TableElement.find(\"tbody > tr.ui-bizagi-wp-app-inbox-grouped-trtag-hide\").hide();\r\n        }\r\n    }\r\n});\r\n","\r\n/*\r\n*   Name: BizAgi Workportal Inbox Grid Widget Controller\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class to to define the inbox grid widget\r\n*/\r\n\r\nbizagi.workportal.widgets.listCases.extend(\"bizagi.workportal.widgets.inboxGrid\", {}, {\r\n   \r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function(){  \r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"inbox-grid\");\r\n        \r\n        var data={};\r\n        \r\n        // Enable or disable functionality\r\n        data.enableFolders = (bizagi.override != undefined && bizagi.override.enableFolder) ? true : false;\r\n        data.enableSmartFolders = (bizagi.override != undefined && bizagi.override.enableSmartFolders) ? true : false;\r\n        \r\n        // Render content\r\n        var content = self.content = $.tmpl(template,$.extend(data, {security: bizagi.menuSecurity}));\r\n        \r\n        // Set inbox view variable\r\n        bizagi.workportal.currentInboxView = self.getWidgetName();\r\n        \r\n        return content;\r\n    },\r\n    \r\n    \r\n    /*\r\n    *   Renders the summary form inside a given container\r\n    */\r\n    renderSummaryForm: function (container) {\r\n        var self = this;\r\n\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) !== \"undefined\")\r\n            ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            // Load render page\r\n            var rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n\r\n            // Executes rendering into render container\r\n            rendering.execute({\r\n                canvas: container,\r\n                summaryForm: true,\r\n                idCase: self.idCase\r\n            });\r\n\r\n            // Keep reference to rendering facade\r\n            self.renderingFacade = rendering;\r\n\r\n            // Resize layout\r\n            setTimeout(function () {\r\n                self.resizeLayout();\r\n            }, 1000);\r\n        });\r\n    },\r\n    \r\n    routingExecute : function(obj){        \r\n        // Executes routing action\r\n        var self = this;\r\n        if(obj == undefined){\r\n            return false;\r\n        }\r\n        \r\n        var idCase = obj.find(\"#idCase\").val();\r\n        var idWorkItem = obj.find(\"#idWorkItem\").val();\r\n        var idTask = obj.find(\"#idTask\").val();\r\n        var eventAsTasks = obj.find(\"#eventAsTasks\").val() || false;\r\n        \r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            idWorkItem: idWorkItem,\r\n            idTask: idTask,\r\n            eventAsTasks: eventAsTasks\r\n        });\r\n    }     \r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Inbox Rows Per Page\r\n*   Author: Kevin Alvarado\r\n*   Comments:\r\n*   -   \r\n*/\r\n\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.workportal.inbox.rowsPerPage\", {\r\n\r\n}, {\r\n\r\n    \r\n    /**\r\n     * return the combo DataSource with the default values and bizagiConfig.inboxRowsPerPage\r\n     */\r\n    initCombo: function(){\r\n        var comboDataSource = {\r\n            combo: [],\r\n            id: \"numberRows\"\r\n        };\r\n        var values=Array(10,20,30,40,50,100);\r\n        if(bizagiConfig.inboxRowsPerPage && values.indexOf(bizagiConfig.inboxRowsPerPage)==-1){\r\n            values.push(bizagiConfig.inboxRowsPerPage);\r\n            values.sort( function(a, b) {return a-b} );\r\n        }\r\n        values.map(function(v) {\r\n            comboDataSource.combo.push({\r\n                id: v,\r\n                name: v\r\n            });\r\n        });\r\n        return comboDataSource;\r\n    },\r\n    /**\r\n     * Busca el valor finding en el combo[i].id si no lo encuentra retorna false, de lo contrario retorna el elemento combo[i]\r\n     * @param {Array} combo array de valores del combo\r\n     * @param {Number} finding valor que se busca\r\n     */\r\n    _findValue: function (combo,finding) {\r\n        var value=false;\r\n        combo.map(function (c) {\r\n            if(c.id==finding){\r\n                value=c;\r\n            }\r\n        });\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Revisa el valor inicial que debe tener el combo, revisando cookie, web.config y casos null, retorna un elemento del combo\r\n     * @param {JSON} params contenido del comboDataSource, setRowValueCookie y getRowValueCookie\r\n     */\r\n    initialValueCombo: function (params) {\r\n        var self = this;\r\n        var initValueCombo = params.comboDataSource.combo[0];\r\n        var rowCookie=params.getRowValueCookie();\r\n        rowCookie=(rowCookie && rowCookie.numberRows)?rowCookie.numberRows:null;\r\n        if(rowCookie || bizagiConfig.inboxRowsPerPage){\r\n            var defaultValue=(rowCookie && self._findValue(params.comboDataSource.combo, rowCookie)!==false)?rowCookie:bizagiConfig.inboxRowsPerPage;\r\n            if(defaultValue){\r\n                initValueCombo=self._findValue(params.comboDataSource.combo, defaultValue);\r\n            }\r\n        }\r\n        return initValueCombo;\r\n    },\r\n\r\n    /**\r\n     * Agrega la interaccin al comboBox y define los listeners, retorna el deferred\r\n     * @param {*} params combo, content, comboWrapper, onChange, setRowValueCookie y getRowValueCookie\r\n     */\r\n    renderNumberRowsCombo: function (params) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n        params.comboWrapper.empty();\r\n        var initValueCombo=self.initialValueCombo({\r\n            comboDataSource: params.combo,\r\n            setRowValueCookie: params.setRowValueCookie,\r\n            getRowValueCookie: params.getRowValueCookie\r\n        });\r\n        var lastValue=initValueCombo.id;\r\n        params.comboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: params.combo,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.name;\r\n            },\r\n            onComplete: function () {\r\n                deferred.resolve();\r\n            },\r\n            onChange: function (obj) {\r\n                var value = obj.ui.data('value');\r\n                if(value!=lastValue){\r\n                    lastValue=value;\r\n                    $(\"#userPositionInput\", params.content).val(value);\r\n                    params.setRowValueCookie(value); //Store the value of rows\r\n                    params.onChange();\r\n                }\r\n            },\r\n            initValue: initValueCombo\r\n        });\r\n        return deferred;\r\n    },\r\n});\r\n","\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.integration\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.module = params.module || null;\r\n        self.selector = params.selector || \"\";   \r\n    },\r\n\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INTEGRATION;\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var selector = document.createElement(self.selector);\r\n        var content = self.content = $(selector);\r\n\r\n        return content\r\n    },\r\n    postRender: function () {\r\n        var self = this;\r\n        //Load module\r\n        if (self.module) {\r\n            bizagi.loader.start(self.module).then(function () {\r\n           });\r\n        }\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n        $(self.selector).empty()\r\n\r\n        self._super();\r\n    }\r\n});","/*\r\n*   Name: BizAgi Workportal Desktop Inbox Widget Controller\r\n*   Author: Diego Parra (based on  Edward Morales version)\r\n*   Comments:\r\n*   -   This script will provide desktop overrides to implement the inbox widget\r\n*/\r\n\r\n// Extends itself\r\nbizagi.workportal.widgets.inbox.extend(\"bizagi.workportal.widgets.inbox\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Declare widget variables\r\n        self.taskState = \"all\"; // general taskState from tabs\r\n        self.icoTaskState = \"\"; // real staskState from list cases\r\n        self.idWorkflow = 0;\r\n        self.idCase = 0;\r\n        self.adhocCases = [];\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"inbox\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox\").concat(\"#ui-bizagi-workportal-widget-inbox\"),\r\n            \"inbox-cases\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox\").concat(\"#ui-bizagi-workportal-widget-inbox-cases\"),\r\n            \"inbox-cases-list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox\").concat(\"#ui-bizagi-workportal-widget-inbox-cases-list\"),\r\n            \"inbox-cases-personalized-list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox\").concat(\"#ui-bizagi-workportal-widget-inbox-cases-personalized-list\"),\r\n            \"inbox-common-processes\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-processes\"),\r\n            \"inbox-common-noresults\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-noresults\"),\r\n            \"inbox-common-header-view\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-header-view\"),\r\n            \"inbox-common-case-summary\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description\"),\r\n            \"inbox-common-case-summary-form\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-form\"),\r\n            \"inbox-common-case-summary-subprocess\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-subprocess\"),\r\n            \"inbox-common-case-summary-assignees\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-assignees\"),\r\n            \"inbox-common-case-summary-events\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-events\"),\r\n            \"inbox-common-case-summary-oldrender\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-oldrender\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    /*\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        bizagi.referrerParams = (self.params.restoreStatus) ? bizagi.referrerParams || {} : {};\r\n        self.params.taskState = self.params.taskState || bizagi.referrerParams.taskState || \"all\";\r\n\r\n\r\n        // Set templates\r\n        self.processesTemplate = self.getTemplate(\"inbox-common-processes\");\r\n        self.casesTemplate = self.getTemplate(\"inbox-cases\");\r\n        //self.casesTemplateList = self.getTemplate(\"inbox-cases-list\");   // original template\r\n        self.casesTemplateList = self.getTemplate(\"inbox-cases-personalized-list\");    // personalized columns\r\n        self.caseSummaryTemplate = self.getTemplate(\"inbox-common-case-summary\");\r\n        self.caseSummaryTemplateForm = self.getTemplate(\"inbox-common-case-summary-form\");\r\n        self.caseSummaryTemplateSubprocess = self.getTemplate(\"inbox-common-case-summary-subprocess\");\r\n        self.caseSummaryTemplateAssigness = self.getTemplate(\"inbox-common-case-summary-assignees\");\r\n        self.caseSummaryTemplateEvents = self.getTemplate(\"inbox-common-case-summary-events\");\r\n\r\n        self.noResults = self.getTemplate(\"inbox-common-noresults\");\r\n        self.paginationTemplate = self.workportalFacade.getTemplate(\"inbox-common-pagination-inbox\");\r\n\r\n\r\n        // Loads inbox summary\r\n        $.when(self.dataService.getInboxSummary())\r\n                .done(function (summary) {\r\n                    self.updateSummary(summary);\r\n\r\n                    // Init with default task state\r\n                    self.changeTaskState(self.params.taskState);\r\n                });\r\n\r\n        // Configure view control\r\n        self.configureViewControl();\r\n\r\n        // Configure folders\r\n        // Check if its avalible\r\n        if (bizagi.override.enableSmartFolders) {\r\n            self.configureSmartFolders();\r\n        }\r\n        self.comboRowsPerPage=new bizagi.workportal.inbox.rowsPerPage();\r\n        self.renderNumberRowsCombo(self.comboRowsPerPage.initCombo());\r\n    },\r\n    renderNumberRowsCombo: function (comboDataSource) {\r\n        var self = this;\r\n        var content=self.getContent();\r\n        return self.comboRowsPerPage.renderNumberRowsCombo({\r\n            combo:comboDataSource,\r\n            content:content,\r\n            comboWrapper:$(\"#select-pagination\", content),\r\n            onChange:function () {\r\n                self.changeProcess();\r\n            },\r\n            setRowValueCookie:self.setRowValueCookie,\r\n            getRowValueCookie:self.getRowValueCookie\r\n        });\r\n    },\r\n    getRowValueCookie: function() {\r\n        // Get Cookie Value\r\n        var storedValue = bizagi.services.preferences().getPreferences();\r\n        return storedValue;    \r\n    },\r\n    setRowValueCookie: function(value) {\r\n        var self = this;\r\n        var modifiedJSONCookie = self.getRowValueCookie();\r\n        modifiedJSONCookie.numberRows = value;\r\n        // Set Cookie\r\n        var strValues = JSON.stringify(modifiedJSONCookie);\r\n        bizagi.services.preferences().overridePreferences(strValues);   \r\n    },\r\n    /**\r\n    * Modal menu with folder actions\r\n    */\r\n    configureSmartFolders: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var inboxArrow = $(\"#innerContentInbox>h2, #innerContentInbox .smartfolders\", content);\r\n\r\n        inboxArrow.click(function () {\r\n            // If the same popup is opened close it\r\n            if (self.currentPopup == \"folders\") {\r\n                bizagi.workportal.desktop.popup.closePopupInstance();\r\n                return;\r\n            }\r\n\r\n            // Creates popup\r\n            self.popupOpened = true;\r\n            self.currentPopup = \"folders\";\r\n            self.publish(\"popupWidget\", {\r\n                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS,\r\n                options: {\r\n                    sourceElement: \"#innerContentInbox>h2\",\r\n                    modalClass: \"folders\",\r\n                    'max-height': '346',\r\n                    height: 'auto',\r\n                    width: '110',\r\n                    offset: \"88 0\",\r\n                    activeScroll: true,\r\n                    foldersView: 'inboxdetails',\r\n                    closed: function () {\r\n                        self.currentPopup = null;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Configures the view control for the widget\r\n    */\r\n    configureViewControl: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var eyeIcon = $(\"#ui-bizagi-wp-app-inbox-bt-eye\", content);\r\n        var eyeIconParent = $(\"#ui-bizagi-wp-app-inbox-bt-eye\", content).parent();\r\n\r\n        // Bind view handler\r\n        eyeIcon.click(function () {\r\n            // If the popup is opened close it\r\n            /* if (self.popupOpened){\r\n            bizagi.workportal.desktop.popup.closePopupInstance();\r\n            return;\r\n            }*/\r\n\r\n            bizagi.workportal.desktop.popup.closePopupInstance();\r\n            // Creates popup\r\n            self.popupOpened = false;\r\n            eyeIconParent.addClass(\"active\");\r\n            self.currentPopup = \"eyeDetails\";\r\n            var offset = \"0 0\";\r\n            var at = \"left bottom\";\r\n            var height = 60;\r\n            var width = 129;\r\n            var arrowPosition = {\r\n                left: \"64%\"\r\n            };\r\n\r\n            var popup = new bizagi.workportal.desktop.popup(self.dataService, self.workportalFacade, {\r\n                sourceElement: \"#ui-bizagi-wp-app-inbox-bt-eye\",\r\n                offset: offset,\r\n                at: at,\r\n                height: height,\r\n                width: width,\r\n                arrowPosition: arrowPosition\r\n            });\r\n\r\n            // Render popup\r\n            var template = self.getTemplate(\"inbox-common-header-view\");\r\n            popup.render($.tmpl(template));\r\n\r\n            // Checks for close signal to change the class again\r\n            $.when(popup.closed())\r\n                    .done(function () {\r\n                        self.popupOpened = false;\r\n                        eyeIconParent.removeClass(\"active\");\r\n                    });\r\n\r\n            // Details view\r\n            var popupContent = popup.getContent();\r\n            $(\"#viewDetailsEvent\", popupContent).click(function () {\r\n                self.publish(\"changeWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX\r\n                });\r\n                popup.close();\r\n            });\r\n\r\n            // Grid view\r\n            $(\"#viewGridEvent\", popupContent).click(function () {\r\n                self.publish(\"changeWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n                });\r\n                popup.close();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Updates inbox summary\r\n    */\r\n    updateSummary: function (summary) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        // Update values\r\n        $(\".ui-bizagi-wp-app-inbox-tab#red\", content).data(\"taskState\", \"Red\");\r\n        $(\".ui-bizagi-wp-app-inbox-tab#green\", content).data(\"taskState\", \"Green\");\r\n        $(\".ui-bizagi-wp-app-inbox-tab#yellow\", content).data(\"taskState\", \"Yellow\");\r\n        $(\".ui-bizagi-wp-app-inbox-tab#favourites\", content).data(\"taskState\", \"Favorites\");\r\n\r\n        // set number of cases for each category\r\n        //{\"inboxSummary\":{\"All\":1151,\"Green\":85,\"Red\":1055,\"Black\":0,\"Yellow\":11}}\r\n        if (self.params.taskState != \"all\") {\r\n            $(\".ui-bizagi-wp-app-inbox-tab\", content).each(function (k, e) {\r\n                if ($(e).data(\"taskState\") == self.params.taskState) {\r\n                    $(e).addClass(\"active\");\r\n                } else {\r\n                    $(e).removeClass(\"active\");\r\n                }\r\n            });\r\n        }\r\n\r\n        $(\".ui-bizagi-wp-app-inbox-tab#all\", content).find(\".toolTip\").html(summary.All);\r\n        $(\".ui-bizagi-wp-app-inbox-tab#red\", content).find(\".toolTip\").html(summary.Red);\r\n        $(\".ui-bizagi-wp-app-inbox-tab#green\", content).find(\".toolTip\").html(summary.Green);\r\n        $(\".ui-bizagi-wp-app-inbox-tab#yellow\", content).find(\".toolTip\").html(summary.Yellow);\r\n\r\n        $(\".ui-bizagi-wp-app-inbox-tab\", content).click(function () {\r\n            //remove selected style\r\n            $(\".ui-bizagi-wp-app-inbox-tab\", content).removeClass(\"active\");\r\n            //set selected style\r\n            $(this).addClass(\"active\");\r\n\r\n            // get content\r\n            /* self.publish(\"changeWidget\", {\r\n            widgetName : self.params.widgetName,\r\n            taskState : $(this).data(\"taskState\")\r\n            });*/\r\n            self.changeTaskState($(this).data(\"taskState\"));\r\n        });\r\n    },\r\n    /*\r\n    *   Changes the task state and updates the content\r\n    */\r\n    changeTaskState: function (taskState) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processesContainer = $(\"#contentProc\", content);\r\n        var smartfoldersParameters = \"\";\r\n\r\n        if (self.params.smartfoldersParameters && self.params.smartfoldersParameters.urlParameters) {\r\n            smartfoldersParameters = self.params.smartfoldersParameters.urlParameters;\r\n        }\r\n\r\n        var previewTaskState = self.params.taskState;\r\n        self.params.taskState = taskState;\r\n\r\n        // Update internal variable\r\n        if (taskState == \"Favorites\") {\r\n            self.taskState = \"all\";\r\n            self.onlyFavorites = \"true\";\r\n            if(previewTaskState !== taskState){\r\n                bizagi.referrerParams.page = \"1\";\r\n            }\r\n        } else {\r\n            self.taskState = taskState;\r\n            self.onlyFavorites = \"\";\r\n        }\r\n\r\n        $(\"#ui-bizagi-wp-app-inbox-tap-selector\", content).removeClass().addClass(taskState);\r\n\r\n        // Clear content\r\n        processesContainer.empty();\r\n\r\n        // Loads processes by task state\r\n        $.when(self.dataService.getAllProcesses({\r\n            taskState: self.taskState || \"all\",\r\n            onlyFavorites: self.onlyFavorites,\r\n            smartfoldersParameters: smartfoldersParameters\r\n        }))\r\n                .done(function (data) {\r\n                    //Remove title All processes on inbox\r\n                    if(data.categories.length > 0){\r\n                        data.categories[0].name = \"\";\r\n                    }\r\n                    // Get template\r\n                    $.tmpl(self.processesTemplate, data).appendTo(processesContainer);\r\n\r\n                    //update 11/11/2014\r\n                    //if (bizagi.util.parseBoolean(bizagi.override.disableFrankensteinQueryForms) == true) {\r\n\r\n                        $.when(self.dataService.getStoredQueryFormList()).done(function (storedQueryForm) {\r\n                            if (storedQueryForm.storedQueryForms.length > 0) {\r\n                                $.when(\r\n                                    self.workportalFacade.getWidget(\"queriesShortcut\", {})\r\n                                ).pipe(function (result) {\r\n                                    widget = result;\r\n                                    return widget.render();\r\n                                }).done(function () {\r\n                                    var content = widget.getContent();\r\n                                    $(\"#queryFormShortcut\").html(content);\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                    //}\r\n\r\n                    // Binds click handler for processes\r\n                    $(\"li\", processesContainer).click(function (event) {\r\n                        var process = $(this);\r\n\r\n                        // Remove all selected elements\r\n                        $(\".selected\", processesContainer).removeClass(\"selected\");\r\n\r\n                        // Add selected class\r\n                        process.addClass(\"selected\");\r\n\r\n                        //if click for human, restore page to 1\r\n                        if(event.currentTarget && event.currentTarget.tagName){\r\n                            bizagi.referrerParams.page = \"1\";\r\n                        }\r\n\r\n                        // Change the current process\r\n                        var idWorkflow = $(\"#idWorkflow\", process).val();\r\n                        var workflowName = $(\".ui-bizagi-wp-app-inbox-processes-name\", process).text();\r\n                        self.changeProcess({\r\n                            idWorkflow: idWorkflow,\r\n                            workflowName: workflowName,\r\n                            smartfoldersParameters: smartfoldersParameters,\r\n                            page: bizagi.referrerParams ? bizagi.referrerParams.page : undefined\r\n                        });\r\n                    });\r\n\r\n                    // Bind favorites start\r\n                    $(\".ui-bizagi-wp-app-inbox-processes-start\", processesContainer).click(function (e) {\r\n                        e.stopPropagation();\r\n                        var options;\r\n                        var elmnt = this;\r\n                        var idWorkflow = $(\"#idWorkflow\", $(elmnt).parent()).val();\r\n\r\n                        $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-processes-start\").addClass(\"ui-bizagi-wp-app-inbox-processes-start-wait\");\r\n\r\n                        // check if its favorite\r\n                        if ($(elmnt).parent().find(\"#isFavorite\").val() == \"false\") {\r\n                            options = {\r\n                                idObject: $(elmnt).parent().find(\"#guidWFClass\").val(),\r\n                                favoriteType: \"WFCLASS\"\r\n                            };\r\n                            $.when(\r\n                            self.dataService.addFavorite(options)\r\n                            ).done(function (favoritesData) {\r\n                                $(elmnt).parent().find(\"#guidFavorite\").val(favoritesData[\"idFavorites\"]);\r\n                                $(elmnt).removeClass(\"bz-icon-star-outline\").addClass(\"bz-icon-star\");\r\n                                $(elmnt).parent().find(\"#isFavorite\").val(\"true\");\r\n                                $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-processes-start-wait\").addClass(\"ui-bizagi-wp-app-inbox-processes-start\");\r\n                                self.updateCountProcess(idWorkflow, true);\r\n                            });\r\n                        } else {\r\n                            options = {\r\n                                idObject: $(elmnt).parent().find(\"#guidFavorite\").val(),\r\n                                favoriteType: \"WFCLASS\"\r\n                            };\r\n                            $.when(\r\n                            self.dataService.delFavorite(options)\r\n                            ).done(function (favoritesData) {\r\n                                if (favoritesData[\"deleted\"] == \"true\" || favoritesData[\"deleted\"] == true) {\r\n                                    $(elmnt).parent().find(\"#guidFavorite\").val(\"\");\r\n                                    $(elmnt).removeClass(\"bz-icon-star\").addClass(\"bz-icon-star-outline\");\r\n                                    $(elmnt).parent().find(\"#isFavorite\").val(\"false\");\r\n                                    $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-processes-start-wait\").addClass(\"ui-bizagi-wp-app-inbox-processes-start\");\r\n                                    self.updateCountProcess(idWorkflow, false);\r\n                                }\r\n                            });\r\n                        }\r\n\r\n                        // Update case list\r\n                        if (self.params.taskState == \"Favorites\" && $(elmnt).parent().hasClass(\"selected\")) {\r\n                            $(elmnt).parent().trigger(\"click\");\r\n                        }\r\n                    });\r\n\r\n\r\n\r\n                    $(\".ui-bizagi-wp-app-inbox-processes-title\", processesContainer).click(function () {\r\n                        var process = $(this).next(\"ul\");\r\n                        var arrow = $(this).find(\"span\");\r\n                        var isHidden = (process.is(\":hidden\")) ? true : false;\r\n                        // Check if element has been hidden\r\n                        if (isHidden) {\r\n                            process.show();\r\n                            arrow.removeClass(\"Right\");\r\n                            arrow.addClass(\"Down\");\r\n                        } else {\r\n                            process.hide();\r\n                            arrow.removeClass(\"Down\");\r\n                            arrow.addClass(\"Right\");\r\n                        }\r\n                    });\r\n\r\n                    var lastProcess = true;\r\n\r\n                    // Open first category\r\n                    if (self.params.restoreStatus) {\r\n                        $.each($(\".ui-bizagi-wp-app-inbox-processes-title\", processesContainer), function (key, value) {\r\n                            $.each($(\"li\", $(value, processesContainer).next()), function (key2, value2) {\r\n                                if ($(value2).find(\"#idWorkflow\").val() == bizagi.referrerParams.idWorkflow) {\r\n                                    $.when($(value, processesContainer).trigger(\"click\")).done(function () {\r\n                                        $(value2, processesContainer).addClass(\"selected\");\r\n                                        self.changeProcess({\r\n                                            page: bizagi.referrerParams.page,\r\n                                            idWorkflow: bizagi.referrerParams.idWorkflow,\r\n                                            workflowName: $(\".ui-bizagi-wp-app-inbox-processes-name\", $(value2, processesContainer)).text()\r\n                                        });\r\n                                        lastProcess = false;\r\n                                    })\r\n                                }\r\n                            });\r\n                        });\r\n                        self.params.restoreStatus = false;\r\n                    } else {\r\n                        $(\".ui-bizagi-wp-app-inbox-processes-title:first\", processesContainer).trigger(\"click\");\r\n                        $(\"li:first\", processesContainer).addClass(\"selected\").trigger(\"click\");\r\n                        lastProcess = false;\r\n                    }\r\n\r\n\r\n                    // Next lines applied to last submitted process in a group of processes, It must go to Inbox instead of a non-existing group of processes\r\n                    if (lastProcess) {\r\n                        $(\".ui-bizagi-wp-app-inbox-processes-title:first\", processesContainer).trigger(\"click\");\r\n                        $(\"li:first\", processesContainer).addClass(\"selected\").trigger(\"click\");\r\n                    }\r\n\r\n                    $(processesContainer).bizagiScrollbar();\r\n\r\n                    if (data.categories.length == 0) {\r\n                        self.changeProcess();\r\n                    }\r\n                });\r\n    },\r\n\r\n    /**\r\n     * Validate if the timeline icon should be shown or not, depending on features endpoint\r\n     */\r\n    isAvailableTimelineByProcessType: function (isAdhocProcess) {\r\n        return (!isAdhocProcess ||\r\n            (isAdhocProcess && bizagi.util.isEnableFeature(\"enableTimelineOnLiveProcesses\")));\r\n    },\r\n\r\n\r\n    /*\r\n    *   Changes selected process and updates the content\r\n    */\r\n    changeProcess: function (options) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var casesContainer = $(\"#contentCases\", content);\r\n        var pageSelector = $(\"#footer #casesPagination\");\r\n        var descContainer = $(\"#contentDesc\", content);\r\n        var nElemToShow = 14;\r\n        var smartfoldersParameters = \"\";\r\n\r\n        if (self.params.smartfoldersParameters && self.params.smartfoldersParameters.urlParameters) {\r\n            smartfoldersParameters = self.params.smartfoldersParameters.urlParameters;\r\n        }\r\n\r\n        options = options || {};\r\n        var page = options[\"page\"] || 1;\r\n        bizagi.referrerParams.page = page;\r\n\r\n        var idWorkflow = options.idWorkflow!=undefined?options.idWorkflow:self.idWorkflow;\r\n        options.workflowName=options.workflowName || self.workflowName;\r\n        // Update internal variable\r\n        self.idWorkflow = idWorkflow;\r\n        self.workflowName = options.workflowName;\r\n\r\n        // Clear content\r\n        casesContainer.empty();\r\n        //casesContainer.empty();\r\n        descContainer.empty();\r\n        pageSelector.empty();\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n        // Load cases by process and task state\r\n        $.when(\r\n                self.dataService.getCasesByWorkflow({\r\n                    idWorkflow: self.idWorkflow,\r\n                    taskState: self.taskState,\r\n                    // Filter by favorites  only when we are searching all processes and favorites\r\n                    onlyFavorites: eval(self.onlyFavorites),\r\n                    page: page,\r\n                    pageSize: self.getRowValueCookie().numberRows,\r\n                    smartfoldersParameters: smartfoldersParameters\r\n\r\n                }))\r\n                .done(function (data) {\r\n                    bizagi.showErrorAlertDialog = true;\r\n                    // Set list of cases for global purpose\r\n                    bizagi.lstIdCases = data.lstIdCases;\r\n                    $(data.rows).each(function(index, elem){\r\n                        if( !elem.isAdhocProcess || typeof elem.isAdhocProcess === 'undefined'){\r\n                            elem.isAdhocProcess = false;\r\n                        }else{\r\n                            elem.isAdhocProcess = true;\r\n                            self.adhocCases.push(elem);\r\n                        }\r\n                        elem.enableTimelineByProcessType = self.isAvailableTimelineByProcessType(elem.isAdhocProcess);\r\n                    });\r\n                    // add idWorkFlow\r\n                    data.idWorkflow = idWorkflow;\r\n                    // If cases container has no elements append something to hide spinner\r\n                    if (!data.rows.length) {\r\n                        casesContainer.append(\"&nbsp;\");\r\n                        descContainer.append(\"&nbsp;\");\r\n                        return;\r\n                    }\r\n\r\n                    // Extend data\r\n                    data.processName = options.workflowName || \"\";\r\n\r\n                    // show or hide \"load more\" button\r\n                    data.pagination = (data[\"totalPages\"] > 1) ? true : false;\r\n\r\n                    // set total pages\r\n                    data.pages = {};\r\n                    var totPages = data[\"totalPages\"];\r\n                    var pageToshow = (nElemToShow > data[\"totalPages\"]) ? data[\"totalPages\"] : nElemToShow;\r\n                    // Next couple Lines to ensure enough space in the pager area\r\n                    if (totPages > 9) pageToshow--;\r\n                    if (totPages > 99) pageToshow--;\r\n                    for (var i = 1; i <= pageToshow; i++) {\r\n                        data[\"pages\"][i] = {\r\n                            \"pageNumber\": i\r\n                        };\r\n                    }\r\n\r\n                    // Get security\r\n                    var security = new bizagi.workportal.command.security(self.dataService);\r\n                    data.graphicQuery = security.checkSecurityPerm(\"GraphicQuery\");\r\n\r\n                    data.enableFolders = bizagi.override.enableFolder || false;\r\n                    var paginationHtml = $.tmpl(self.paginationTemplate, data).html();\r\n\r\n                    // when show summary form from inbox grid\r\n                    data.enableFeatureShowTimelineButton = bizagi.override.enableFeatureShowTimelineButton;\r\n\r\n                    // Get template\r\n                    $(pageSelector).append(paginationHtml);\r\n\r\n                    // Render template\r\n                    $.tmpl(self.casesTemplate, data, {\r\n                        replaceLineBreak: function (string) {\r\n                            return typeof string === \"string\" ? (string.search(/\\n/) !== -1 ? string.replaceAll(\"\\n\", \"<br/>\") : string) : string;\r\n                        },\r\n                        formatMonetaryCell: function (value) {\r\n                            return bizagi.util.formatMoney(value, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n                        },\r\n                        formatDecimalCell: function (value) {\r\n                            var decimalFormat;\r\n                            var externalDecimalFormat = {\r\n                                decimalSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,\r\n                                digitGroupSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,\r\n                                roundToDecimalPlace: BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits\r\n                            };\r\n                            var defaultDecimalFormat = {\r\n                                colorize: false,\r\n                                decimalSymbol: \".\",\r\n                                digitGroupSymbol: \",\",\r\n                                groupDigits: true,\r\n                                negativeFormat: \"(%s%n)\",\r\n                                positiveFormat: \"%s%n\",\r\n                                roundToDecimalPlace: \"2\",\r\n                                symbol: \"\"\r\n                            };\r\n                            decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n                            return bizagi.util.formatDecimal(value, decimalFormat);\r\n                        },\r\n                        formatBoolean: function (value) {\r\n                            if (bizagi.util.parseBoolean(value) == true) {\r\n                                return self.getResource(\"render-boolean-yes\");\r\n                            } else if (bizagi.util.parseBoolean(value) == false) {\r\n                                return self.getResource(\"render-boolean-no\");\r\n                            } else {\r\n                                return \"\";\r\n                            }\r\n                        }\r\n                    }).appendTo(casesContainer);\r\n\r\n                    // Format invariant dates\r\n                    bizagi.util.formatInvariantDate(content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n                    // set total number pages\r\n                    $(\".scrollCases\").data(\"totalPage\", data[\"totalPages\"]);\r\n                    $(\".scrollCases\").data(\"page\", 1);\r\n\r\n                    // Crate pagination control\r\n                    $(\"ul\").bizagiPagination({\r\n                        totalPages: data.totalPages,\r\n                        actualPage: data.page,\r\n                        listElement: $(\"ul\", pageSelector),\r\n                        clickCallBack: function (options) {\r\n                            self.changeProcess({\r\n                                idWorkflow: idWorkflow,\r\n                                page: options.page\r\n                            });\r\n                        }\r\n                    });\r\n\r\n\r\n                    // Binds click handler for cases\r\n                    $(\"li\", casesContainer).click(function () {\r\n                        var cAse = $(this);\r\n                        // set real taskState\r\n                        self.icoTaskState = $(this).children(\"#caseName\").children(\"#taskState\").val();\r\n\r\n                        // Remove all selected elements\r\n                        $(\".selected\", casesContainer).removeClass(\"selected\");\r\n\r\n                        // Add selected class\r\n                        cAse.addClass(\"selected\");\r\n\r\n                        // Change the current process\r\n                        var idCase = $(\"#idCase\", cAse).val();\r\n                        var idWorkflow = $(\"#idWorkflowGQ\", cAse).val();\r\n                        self.changeCase(idCase, idWorkflow);\r\n                    });\r\n\r\n                    // Bind Folders\r\n                    $(\".ui-bizagi-inbox-folder\", casesContainer).click(function (e) {\r\n                        e.stopPropagation();\r\n                        var idCase = $(this).data(\"idcase\");\r\n\r\n                        // If the same popup is opened close it\r\n                        if (self.currentPopup == \"folders\") {\r\n                            bizagi.workportal.desktop.popup.closePopupInstance();\r\n                            return;\r\n                        }\r\n\r\n                        bizagi.workportal.desktop.popup.closePopupInstance();\r\n                        // Creates popup\r\n                        self.popupOpened = false;\r\n                        self.currentPopup = \"folders\";\r\n                        self.publish(\"popupWidget\", {\r\n                            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FOLDERS,\r\n                            options: {\r\n                                sourceElement: $(this),\r\n                                modalClass: \"folders\",\r\n                                'max-height': '146',\r\n                                height: 'auto',\r\n                                width: '110',\r\n                                offset: \"88 0\",\r\n                                activeScroll: true,\r\n                                onlyFolderMode: true,\r\n                                idCase: idCase,\r\n                                closed: function () {\r\n                                    self.currentPopup = null;\r\n                                }\r\n                            }\r\n                        });\r\n                    });\r\n\r\n                    // Bind favorites start\r\n                    $(\".ui-bizagi-wp-app-inbox-cases-start\", casesContainer).click(function (e) {\r\n                        e.stopPropagation();\r\n                        var favoriteOptions;\r\n                        var elmnt = this;\r\n\r\n                        $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start\").addClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\");\r\n\r\n                        // check if its favorite\r\n                        if ($(elmnt).parent().find(\"#isFavorite\").val() == \"false\") {\r\n                            favoriteOptions = {\r\n                                idObject: $(elmnt).parent().parent().find(\"#idCase\").val(),\r\n                                favoriteType: \"CASES\"\r\n                            };\r\n                            $.when(\r\n                            self.dataService.addFavorite(favoriteOptions)\r\n                            ).done(function (favoritesData) {\r\n                                $(elmnt).parent().find(\"#guidFavorite\").val(favoritesData[\"idFavorites\"]);\r\n                                $(elmnt).removeClass(\"bz-icon-star-outline\").addClass(\"bz-icon-star\");\r\n                                $(elmnt).parent().find(\"#isFavorite\").val(\"true\");\r\n                                $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\").addClass(\"ui-bizagi-wp-app-inbox-cases-start\");\r\n\r\n                                self.updateCountProcess(idWorkflow, true);\r\n                            });\r\n                        } else {\r\n                            favoriteOptions = {\r\n                                idObject: $(elmnt).parent().find(\"#guidFavorite\").val(),\r\n                                favoriteType: \"CASES\"\r\n                            };\r\n                            $.when(\r\n                            self.dataService.delFavorite(favoriteOptions)\r\n                            ).done(function (favoritesData) {\r\n                                if (favoritesData[\"deleted\"] == \"true\" || favoritesData[\"deleted\"] == true) {\r\n                                    $(elmnt).parent().find(\"#guidFavorite\").val(\"\");\r\n                                    $(elmnt).removeClass(\"bz-icon-star\").addClass(\"bz-icon-star-outline\");\r\n                                    $(elmnt).parent().find(\"#isFavorite\").val(\"false\");\r\n                                    $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\").addClass(\"ui-bizagi-wp-app-inbox-cases-start\");\r\n                                    self.updateCountProcess(idWorkflow, false);\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n\r\n                    if (data.rows.length > 0) {\r\n                        // Make first item selected\r\n                        self.icoTaskState = $(\"li:first\", casesContainer).children(\"#taskState\").val();\r\n                        $(\"li:first\", casesContainer).addClass(\"selected\").trigger(\"click\");\r\n\r\n                    } else {\r\n                        self.changeCase(0);\r\n                    }\r\n\r\n                    $(casesContainer).bizagiScrollbar();\r\n                }).fail(function (error) {\r\n                    error = JSON.parse(error.responseText) || {};\r\n                    var caseSummaryContainer = $(\"#contentDesc\", content);\r\n                    var errorTemplate = self.workportalFacade.getTemplate(\"info-message\");\r\n                    var message = error.message || error;\r\n                    var errorHtml = $.tmpl(errorTemplate, {\r\n                        message: message,\r\n                        css: 'ui-bizagi-info-inbox-detail'\r\n                    });\r\n                    // Remove loading icon from summary container\r\n                    caseSummaryContainer.append('&nbsp;');\r\n\r\n                    errorHtml.appendTo(casesContainer);\r\n                });\r\n    },\r\n    /*\r\n    *   Changes the selected case and updates the content\r\n    */\r\n    changeCase: function (idCase, idWorkflow) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var caseSummaryContainer = $(\"#contentDesc\", content);\r\n        var cache = {};\r\n        var htmlContent = \"\";\r\n        var isAdhoc = false;\r\n        var idProcess = null;\r\n        // Clear content\r\n        caseSummaryContainer.empty();\r\n        for(var i = 0; i < this.adhocCases.length; i++){\r\n            if( idCase == this.adhocCases[i].id ){\r\n                isAdhoc = true;\r\n                idProcess = this.adhocCases[i].idAdhocProcess;\r\n            }\r\n        }\r\n        // Update internal variable\r\n        self.idCase = idCase;\r\n\r\n        // Don't search data when there is no case\r\n        if (self.idCase == 0) {\r\n            return;\r\n        }\r\n\r\n        // Render Form Tab\r\n        $.when(\r\n                self.dataService.summaryCaseDetails({\r\n                    idCase: self.idCase\r\n                })\r\n                ).done(function (data) {\r\n                    data.hasComments = (data.hasComments == 'true') ? true : false;\r\n\r\n                    // Get security\r\n                    var security = new bizagi.workportal.command.security(self.dataService);\r\n                    data.graphicQuery = security.checkSecurityPerm(\"GraphicQuery\");\r\n\r\n                    // when inbox is showed in details mode.\r\n                    data.enableFeatureShowTimelineButton = bizagi.override.enableFeatureShowTimelineButton;\r\n                    data.enableTimelineByProcessType = self.isAvailableTimelineByProcessType(data.isAdhocProcess);\r\n\r\n                    if(typeof data.contextualized === \"undefined\"){\r\n                        data.contextualized = true;\r\n                    }\r\n\r\n                    if(data.currentState && data.currentState.length > 0){\r\n                        data.currentState.forEach(function(currentState){\r\n                            if(!currentState.idTask){\r\n                                currentState.idTask = 0;\r\n                            }\r\n                            if(!currentState.state){\r\n                                currentState.state = currentState.displayName || \" \";\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    if(data.process === \"undefined\" || data.process === \"\" || typeof data.process === \"undefined\"){\r\n                        data.process = false;\r\n                    }\r\n\r\n                    if(data.processPath === \"undefined\" || data.processPath === \"\" || typeof data.processPath === \"undefined\"){\r\n                        data.processPath = false;\r\n                    }\r\n\r\n                    var summary = $.tmpl(self.caseSummaryTemplate, $.extend(data, {security: bizagi.menuSecurity})).appendTo(caseSummaryContainer);\r\n\r\n                    // Format invariant dates\r\n                    bizagi.util.formatInvariantDate(content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n                    // Delegate events for parent process\r\n                    $(\"#details\", summary).delegate(\".summaryLink\", \"click\", function () {\r\n                        self.routingExecute($(this));\r\n                    });\r\n\r\n                    // jQuery-ui\r\n                    $(\"#ui-bizagi-details-tabs\", content).tabs({\r\n                        active: -1,\r\n                        create: function (event, ui) {\r\n                            $(this).tabs(\"option\", \"active\", 0);\r\n                        },\r\n                        activate: function (event, ui) {\r\n                            var panel = (ui == undefined) ? \"formSummary\" : ui.newPanel.attr('id');\r\n                            switch (panel) {\r\n\r\n                                case \"comments\":\r\n                                    if (cache[\"comments\"] == undefined) {\r\n                                        // Extend render with comments\r\n                                        $.extend(self, {}, bizagi.workportal.comments);\r\n\r\n                                        // Define canvas\r\n                                        data.canvas = $(\"#comments\", caseSummaryContainer);\r\n                                        data.readOnly = true;\r\n\r\n                                        $.when(self.renderComments(data))\r\n                                    .done(function (htmlContent) {\r\n                                        cache[\"comments\"] = htmlContent;\r\n                                    });\r\n                                    }\r\n                                    bizagi.util.setContext({\r\n                                        commentsFocus: true\r\n                                    });\r\n                                    break;\r\n                                case \"formSummary\":\r\n                                    if (cache[\"formSummary\"] == undefined) {\r\n                                        var canvas = $(\"#formSummary\", caseSummaryContainer);\r\n\r\n                                        // Define action when render form has not been migrated\r\n                                        canvas.bind(\"oldrenderintegration\", function (e) {\r\n                                            if (e.isPropagationStopped()) {\r\n                                                return;\r\n                                            }\r\n                                            e.stopPropagation();\r\n\r\n                                            var template = self.getTemplate(\"inbox-common-case-summary-oldrender\");\r\n                                            var data = {};\r\n\r\n                                            bizagi.oldrenderevent = true; // has been loaded\r\n                                            var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n                                            var eventer = window[eventMethod];\r\n                                            var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n\r\n                                            // Listen to message from child window\r\n                                            eventer(messageEvent, function (e) {\r\n                                                e.stopPropagation();\r\n                                                self.publish(\"executeAction\", {\r\n                                                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                                                    idCase: e.data\r\n                                                });\r\n                                            }, false);\r\n\r\n                                            // Define wirkitem and idtask\r\n                                            $.when(self.dataService.getWorkitems({\r\n                                                idCase: self.idCase,\r\n                                                onlyUserWorkItems: true\r\n                                            })).done(function (getWorkitems) {\r\n                                                // verify workitem, in some cases these variables are not available\r\n                                                if (typeof getWorkitems.workItems == \"object\" && getWorkitems.workItems.length >= 1) {\r\n                                                    // Case Open\r\n                                                    var idWorkitem = getWorkitems.workItems[0]['idWorkItem'];\r\n                                                    var idTask = getWorkitems.workItems[0]['idTask'];\r\n                                                    data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&idWorkitem=\" + idWorkitem + \"&idTask=\" + idTask + \"&isSummary=1\";\r\n                                                } else {\r\n                                                    // Case closed\r\n                                                    data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&isSummary=1\";\r\n                                                }\r\n\r\n                                                // Render content\r\n                                                canvas.empty();\r\n                                                $.tmpl(template, data).appendTo(canvas);\r\n                                                //Set styles\r\n                                                self.iframeOldRender($(\"iframe\", canvas));\r\n                                                // Recalculate size panel\r\n                                                self.performResizeLayout();\r\n                                            });\r\n                                        });\r\n\r\n                                        var params = {\r\n                                            idCase: self.idCase\r\n                                        };\r\n\r\n                                        $.when(self.dataService.getCaseFormsRenderVersion(params))\r\n                                    .done(function (formsVersion) {\r\n                                        if (formsVersion.formsRenderVersion == 1) {\r\n                                            canvas.trigger(\"oldrenderintegration\");\r\n                                        } else {\r\n                                            $.when(self.renderSummaryForm(canvas))\r\n                                            .done(function () {\r\n                                                htmlContent = $(\"#formSummary\", caseSummaryContainer).html();\r\n                                                cache[\"formSummary\"] = htmlContent;\r\n                                            });\r\n                                        }\r\n                                    });\r\n                                    }\r\n                                    break;\r\n                                case \"subprocess\":\r\n                                    if (cache[\"subprocess\"] == undefined) {\r\n                                        $.when(\r\n                                    self.dataService.summarySubProcess({\r\n                                        idCase: self.idCase\r\n                                    }))\r\n                                    .done(function (subprocess) {\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateSubprocess, subprocess);\r\n                                        htmlContent.appendTo($(\"#subprocess\", caseSummaryContainer));\r\n                                        cache[\"subprocess\"] = htmlContent;\r\n\r\n                                        // Define Events for subprocess tab\r\n                                        htmlContent.delegate(\".summaryLink\", \"click\", function () {\r\n                                            self.routingExecute($(this));\r\n                                        });\r\n                                    });\r\n                                    }\r\n                                    break;\r\n                                case \"assignees\":\r\n                                    if (cache[\"assignees\"] == undefined) {\r\n                                        $.when(\r\n                                    self.dataService.summaryAssigness({\r\n                                        idCase: self.idCase,\r\n                                        preview:true\r\n                                    }))\r\n                                    .done(function (assignees) {\r\n                                        // Generates  lists of unique assignees for Events\r\n                                        var eventsUniqueList = [];\r\n                                        $.each(assignees.events.split(\", \"), function (i, el) {\r\n                                            if ($.inArray(el, eventsUniqueList) === -1) eventsUniqueList.push(el);\r\n                                        });\r\n                                        assignees.events = eventsUniqueList.join(\", \");\r\n\r\n                                        // Generates  lists of unique assignees for activities\r\n                                        var activitiesUniqueList = [];\r\n                                        $.each(assignees.activities.split(\", \"), function (i, el) {\r\n                                            if ($.inArray(el, activitiesUniqueList) === -1) activitiesUniqueList.push(el);\r\n                                        });\r\n                                        assignees.activities = activitiesUniqueList.join(\", \");\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateAssigness, assignees);\r\n                                        htmlContent.appendTo($(\"#assignees\", caseSummaryContainer));\r\n                                        cache[\"assignees\"] = htmlContent;\r\n                                    });\r\n                                    }\r\n                                    break;\r\n                                case \"events\":\r\n                                    if (cache[\"events\"] == undefined) {\r\n                                        $.when(\r\n                                    self.dataService.summaryCaseEvents({\r\n                                        idCase: self.idCase\r\n                                    }))\r\n                                    .done(function (events) {\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateEvents, events);\r\n                                        htmlContent.appendTo($(\"#events\", caseSummaryContainer));\r\n                                        cache[\"events\"] = htmlContent;\r\n\r\n                                        htmlContent.delegate(\".summaryLink\", \"click\", function () {\r\n                                            self.routingExecute($(this));\r\n                                        });\r\n                                    });\r\n                                    }\r\n                                    break;\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    // set even style for process and cases\r\n                    $.each($(\"#ui-bizagi-wp-app-inbox-processes-container li:even, #ui-bizagi-wp-app-inbox-cases-container li:even\"), function () {\r\n                        $(this).addClass(\"ui-bizagi-wp-app-inbox-evenColor\");\r\n                    });\r\n\r\n                    // Add click to timeline icon\r\n                    $(\".js-show-timeline\", content).click(function (event){\r\n                        var caseNumber = $.trim($(this).closest(\"div.ui-bizagi-wp-app-inbox-processes-title\").find(\"span.js-case-number\").text());\r\n                        self.showTimeLine({ radNumber: caseNumber, idCase: idCase });\r\n                    });\r\n\r\n                    // Add click to view workflow\r\n                    $(\".ui-bizagi-wp-app-inbox-cases-ico-view\", content).click(function () {\r\n                        if( isAdhoc ){\r\n                            self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow, isAdhoc: true, idProcess: idProcess });\r\n                        }else {\r\n                            self.showGraphicQuery({idCase: idCase, idWorkflow: idWorkflow});\r\n                        }\r\n                    });\r\n\r\n\r\n                    //Work on it button\r\n                    $(\".workonitRow\", content).button();\r\n\r\n                    // Bind work on it button\r\n                    $(\".workonitRow\", content).click(function () {\r\n                        // Executes routing action\r\n                        var idWorkItem = $(this).parent().find(\"#idWorkItem\").val();\r\n                        var referrerParams = {\r\n                            taskState: self.params.taskState,\r\n                            idWorkItem: idWorkItem,\r\n                            idCase: self.idCase,\r\n                            idTask: $(this).parent().find(\"#idTask\").val(),\r\n                            onlyFavorites: self.onlyFavorites,\r\n                            idWorkflow: self.idWorkflow,\r\n                            referrer: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX\r\n                        }\r\n\r\n                        $.extend(bizagi.referrerParams, bizagi.referrerParams, referrerParams);\r\n                        self.publish(\"executeAction\", {\r\n                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                            idCase: self.idCase,\r\n                            idTask: $(this).parent().find(\"#idTask\").val(),\r\n                            idWorkItem: idWorkItem,\r\n                            idWorkflow: idWorkflow //idWorkflow for graphic query bucause self.idworkflow is a wfClass\r\n                        });\r\n                    });\r\n\r\n                    self.resizeLayout();\r\n                    $(\".scrollProcess\").bizagiScrollbar();\r\n                    $(\".scrollSummary\").bizagiScrollbar({\r\n                        autohide: false\r\n                    });\r\n                });\r\n    },\r\n    /**\r\n    * Load more cases when scroll controler reach button position\r\n    */\r\n    casesPagination: function (options) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var casesContainer = $(\"#contentCases\", content);\r\n        var listContainer = $(\"#contentCases .scrollCases ul\", content);\r\n        var def = new $.Deferred();\r\n\r\n        // Update internal variable\r\n        self.idWorkflow = options['idWorkflow'];\r\n        self.page = options['page'] || 2;\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n        // Load cases by process and task state\r\n        $.when(self.dataService.getCasesByWorkflow({\r\n            idWorkflow: self.idWorkflow,\r\n            taskState: self.taskState,\r\n            page: self.page\r\n        }))\r\n                .done(function (data) {\r\n                bizagi.showErrorAlertDialog = true;\r\n                    data.processName = \"\";\r\n                    // Get template\r\n                    $.tmpl(self.casesTemplateList, data).appendTo(listContainer);\r\n\r\n                    // Binds click handler for cases\r\n                    $(\"li\", casesContainer).click(function () {\r\n                        var cAse = $(this);\r\n\r\n                        // Remove all selected elements\r\n                        $(\".selected\", casesContainer).removeClass(\"selected\");\r\n\r\n                        // Add selected class\r\n                        cAse.addClass(\"selected\");\r\n\r\n                        // Change the current process\r\n                        var idCase = $(\"#idCase\", cAse).val();\r\n                        var idWorkflow = $(\"#idWorkflowGQ\", cAse).val();\r\n\r\n                        self.changeCase(idCase, idWorkflow);\r\n                    });\r\n\r\n                    // Resolve deferred\r\n                    def.resolve();\r\n                }).fail(function (error) {\r\n                    error = JSON.parse(error.responseText) || {};\r\n                    var errorTemplate = self.workportalFacade.getTemplate(\"info-message\");\r\n                    var message = error.message || error;\r\n                    var errorHtml = $.tmpl(errorTemplate, {\r\n                        message: message\r\n                    });\r\n\r\n                    $('.ui-bizagi-error', errorHtml).width(\"50%\");\r\n\r\n                    errorHtml.appendTo(casesContainer);\r\n                    def.resolve();\r\n                });\r\n\r\n        return def.promise();\r\n\r\n    },\r\n    /*\r\n    *   When the window resizes, runs this method to adjust stuff in each controller or widget\r\n    *   Override when needed\r\n    */\r\n    performResizeLayout: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Trigger render resize\r\n        if (self.renderingFacade) {\r\n            self.renderingFacade.resize({\r\n                forceResize: true\r\n            });\r\n        }\r\n    },\r\n    /**\r\n    *  Change total processes indicator, when start favorites view and user select or deselect\r\n    *  favorite cases.\r\n    *\r\n    *  @param increment  {true || false }, true= increment +1 , false = decrement -1, default true.\r\n    */\r\n    updateCountProcess: function (idWorkflow, increment) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processesContainer = $(\"#contentProc\", content);\r\n        var assigned = false;\r\n\r\n        increment = (increment) ? true : false;\r\n\r\n        // Check if task state is diferent to Favorites\r\n        if (self.params.taskState != \"Favorites\" || idWorkflow == \"\") {\r\n            return true;\r\n        }\r\n\r\n\r\n        // Get all process and verify new favorites count\r\n        // Loads processes by task state\r\n        $.when(self.dataService.getAllProcesses({\r\n            taskState: self.taskState,\r\n            onlyFavorites: self.onlyFavorites\r\n        }))\r\n                .done(function (data) {\r\n                    data.categories = data.categories || {};\r\n                    $.each(data.categories, function (key, value) {\r\n                        $.each(value.workflows, function (key2, value2) {\r\n                            if (value2.idworkflow == idWorkflow) {\r\n                                // update value\r\n                                // Find list elements\r\n                                $('li > input[value=\"' + idWorkflow + '\"][id=\"idWorkflow\"]', processesContainer).parent().find(\".ui-bizagi-wp-app-inbox-processes-ncase\").html(value2.count);\r\n                                assigned = true;\r\n                            }\r\n                        })\r\n                    });\r\n\r\n                    //Remove title All processes on inbox\r\n                    data.categories[bizagi.localization.getResource('workportal-widget-inbox-all-processes')].key = \"\";\r\n\r\n                    // If element reach 0 cases, set 0\r\n                    if (!assigned) {\r\n                        if (increment) {\r\n                            $('li > input[value=\"' + idWorkflow + '\"][id=\"idWorkflow\"]', processesContainer).parent().find(\".ui-bizagi-wp-app-inbox-processes-ncase\").html(1);\r\n                        } else {\r\n                            $('li > input[value=\"' + idWorkflow + '\"][id=\"idWorkflow\"]', processesContainer).parent().find(\".ui-bizagi-wp-app-inbox-processes-ncase\").html(0);\r\n                        }\r\n                    }\r\n                });\r\n    },\r\n    /**\r\n    * Inject styles and js into the iframe\r\n    */\r\n    iframeOldRender: function (canvas) {\r\n        var self = this;\r\n        var iframe;\r\n        var content = self.getContent();\r\n        var theme = \"bizagiDefault\";\r\n        var queryString = bizagi.readQueryString();\r\n\r\n        $.each(canvas, function () {\r\n            if ($(this).is(\"iframe\")) {\r\n                iframe = $(this);\r\n            }\r\n        });\r\n\r\n        iframe.load(function () {\r\n            // inject css\r\n            var content = $(this).contents();\r\n\r\n            // Fixed problem with relative path across the different browsers\r\n            var cssLocation = ($.browser.mozilla || $.browser.webkit) ? \"../../css/render_%theme%.css\" : \"css/render_%theme%.css\";\r\n\r\n            // Append javascript\r\n            $('head', content).append(\"<script type='text/javascript' src='../../js/renderintegration.js'></script>\");\r\n\r\n            // Define theme\r\n            cssLocation = cssLocation.replace(\"%theme%\", (queryString[\"theme\"] || theme));\r\n\r\n            // Append css\r\n            $('body', content).append(\"<link type='text/css' rel='stylesheet' href='\" + cssLocation + \"'>\");\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Desktop Inbox grid Widget Controller\r\n*   Author: Diego Parra (based on  Edward Morales version)\r\n*   Comments:\r\n*   -   This script will provide desktop overrides to implement the inbox grid widget\r\n*/\r\n\r\n// Extends itself\r\nbizagi.workportal.widgets.inboxGrid.extend(\"bizagi.workportal.widgets.inboxGrid\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Declare widget variables\r\n        self.taskState = \"all\"; // general taskState from tabs\r\n        self.icoTaskState = \"\"; // real staskState from list cases\r\n        self.idWorkflow = 0;\r\n        self.isAdhocProcess = true;\r\n        self.idCase = 0;\r\n        self.page = 0;\r\n        self.adhocIds = [];\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"inbox-grid\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.grid\").concat(\"#ui-bizagi-workportal-widget-inbox-grid\"),\r\n            \"inbox-grid-rubik\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.grid\").concat(\"#ui-bizagi-workportal-widget-inbox-grid-rubik\"),\r\n            \"inbox-grid-cases\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.grid\").concat(\"#ui-bizagi-workportal-widget-inbox-grid-cases\"),\r\n            \"inbox-common-processes\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-processes\"),\r\n            \"inbox-common-header-view\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-header-view\"),\r\n            \"inbox-common-case-summary\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description\"),\r\n            \"inbox-common-case-summary-subprocess\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-subprocess\"),\r\n            \"inbox-common-case-summary-assignees\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-assignees\"),\r\n            \"inbox-common-case-summary-events\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-events\"),\r\n            \"inbox-common-case-summary-oldrender\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-oldrender\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        \r\n    },\r\n    /*\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        bizagi.referrerParams = (self.params.restoreStatus) ? bizagi.referrerParams || {} : {};\r\n        self.params.taskState = self.params.taskState || bizagi.referrerParams.taskState || \"all\";\r\n\r\n\t        // Set templates\r\n\t        self.processesTemplate = self.getTemplate(\"inbox-common-processes\");\r\n\t        self.casesTemplate = self.getTemplate(\"inbox-grid-cases\");\r\n\t        self.caseSummaryTemplate = self.getTemplate(\"inbox-common-case-summary\");\r\n\t        self.caseSummaryTemplateSubprocess = self.getTemplate(\"inbox-common-case-summary-subprocess\");\r\n\t        self.caseSummaryTemplateAssigness = self.getTemplate(\"inbox-common-case-summary-assignees\");\r\n\t        self.caseSummaryTemplateEvents = self.getTemplate(\"inbox-common-case-summary-events\");\r\n\t        self.paginationTemplate = self.workportalFacade.getTemplate(\"inbox-common-pagination-grid\");\r\n\r\n\tvar security = new bizagi.workportal.command.security(self.dataService);\r\n        security.checkSecurityPerm(\"Inbox\").done(function (inbox) {\r\n            \r\n\t    if (inbox) {\r\n\t\t        // Loads inbox summary\r\n\t\t            $.when(self.dataService.getInboxSummary())\r\n\t\t                    .done(function (summary) {\r\n\t\t                        self.updateSummary(summary);\r\n\t\t                        self.resizeLayout();\r\n\t\t                        // Init with default task state\r\n\t\t                        self.changeTaskState(self.params.taskState);\r\n\t\t                    });\r\n\r\n\t\t            // Configure view control\r\n\t\t            self.configureViewControl();\r\n\r\n\t\t            // Configure folders\r\n\t\t            // Check if its avalible\r\n\t\t            if (bizagi.override.enableSmartFolders) {\r\n\t\t                self.configureSmartFolders();\r\n\t\t            }\r\n\t    \t    } \r\n    \t     else {\r\n                $(\"#contentInbox\").remove();\r\n                $(\"#contentFramework\").remove();\r\n                $(\"#footer\").remove();\r\n                self.content = $(\"<div class=\\\"wp-empty\\\"></div>\");\r\n            }\r\n            self.comboRowsPerPage=new bizagi.workportal.inbox.rowsPerPage();\r\n            self.renderNumberRowsCombo(self.comboRowsPerPage.initCombo());\r\n        });\r\n        \r\n    },\r\n\r\n    renderNumberRowsCombo: function (comboDataSource) {\r\n        var self = this;\r\n        var content=self.getContent();\r\n        return self.comboRowsPerPage.renderNumberRowsCombo({\r\n            combo:comboDataSource,\r\n            content:content,\r\n            comboWrapper:$(\"#select-pagination\", content),\r\n            onChange:function () {\r\n                self.changeProcess();\r\n            },\r\n            setRowValueCookie: self.setRowValueCookie,\r\n            getRowValueCookie: self.getRowValueCookie\r\n        });\r\n    },\r\n    getRowValueCookie: function() {\r\n        // Get Cookie Value\r\n        var storedValue = bizagi.services.preferences().getPreferences();\r\n        return storedValue;   \r\n    },\r\n    setRowValueCookie: function(value) {\r\n        var self = this;\r\n        var modifiedJSONCookie = self.getRowValueCookie();\r\n        modifiedJSONCookie.numberRows = value;\r\n        // Set Cookie\r\n        var strValues = JSON.stringify(modifiedJSONCookie);\r\n        bizagi.services.preferences().overridePreferences(strValues); \r\n    },\r\n    /**\r\n    * Modal menu with folder actions\r\n    */\r\n    configureSmartFolders: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var inboxArrow = $(\"#innerContentInbox>h2, #innerContentInbox .smartfolders\", content);\r\n\r\n        inboxArrow.click(function () {\r\n            // If the same popup is opened close it\r\n            if (self.currentPopup == \"folders\") {\r\n                bizagi.workportal.desktop.popup.closePopupInstance();\r\n                return;\r\n            }\r\n\r\n            // Creates popup\r\n            self.popupOpened = true;\r\n            self.currentPopup = \"folders\";\r\n            self.publish(\"popupWidget\", {\r\n                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS,\r\n                options: {\r\n                    sourceElement: \"#innerContentInbox>h2\",\r\n                    modalClass: \"folders\",\r\n                    'max-height': '346',\r\n                    height: 'auto',\r\n                    width: '110',\r\n                    offset: \"88 0\",\r\n                    activeScroll: true,\r\n                    foldersView: 'inboxgrid',\r\n                    closed: function () {\r\n                        self.currentPopup = null;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Configures the view control for the widget\r\n    */\r\n    configureViewControl: function () {\r\n        // We can use the same code than the normal version\r\n        // in case we use a different template or something we need to reimplement this\r\n        bizagi.workportal.widgets.inbox.prototype.configureViewControl.apply(this, arguments);\r\n    },\r\n    /*\r\n    *   Updates inbox summary\r\n    */\r\n    updateSummary: function (summary) {\r\n        // We can use the same code than the normal version\r\n        // in case we use a different template or something we need to reimplement this\r\n        bizagi.workportal.widgets.inbox.prototype.updateSummary.apply(this, arguments);\r\n    },\r\n    /*\r\n    *   Changes the task state and updates the content\r\n    */\r\n    changeTaskState: function (taskState) {\r\n        // We can use the same code than the normal version\r\n        // in case we use a different template or something we need to reimplement this\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var procContainer = $(\"#contentProc\", content);\r\n        bizagi.workportal.widgets.inbox.prototype.changeTaskState.apply(this, arguments);\r\n        // Add scroll bars\r\n        $(procContainer).bizagiScrollbar();\r\n\r\n    },\r\n\r\n    /**\r\n     * validate needed params for the self.changeProcess request, return json with the params\r\n     * @param {ClassReference} self this class reference\r\n     * @param {JSON} options taskState,idWorkflow,orderType,order,orderFieldName,page,\r\n     */\r\n    setFiltersOnChangeProcess:function (self,options) {\r\n        var res={};\r\n        res.page = (options[\"page\"] && options[\"page\"]>0)?options[\"page\"]:1;\r\n        res.taskState = options.taskState || self.taskState;\r\n        res.idWorkflow = options.idWorkflow!=undefined?options.idWorkflow:(self.idWorkflow || \"\");\r\n        // Set order vars\r\n        res.orderFieldName = options[\"orderFieldName\"] || (options.idWorkflow==self.idWorkflow || options.idWorkflow==undefined?self.orderFieldName : \"\");\r\n        res.orderType = options[\"orderType\"]!=undefined?options[\"orderType\"] : (options.idWorkflow==self.idWorkflow || options.idWorkflow==undefined?self.orderType : \"0\");\r\n        res.order = options[\"order\"] || (options.idWorkflow==self.idWorkflow || options.idWorkflow==undefined?self.order : \"\");\r\n\r\n        // Update internal variable\r\n        self.idWorkflow = res.idWorkflow;\r\n        self.orderFieldName = res.orderFieldName;\r\n        self.orderType = res.orderType;\r\n        self.order = res.order;\r\n        return res;\r\n    },\r\n\r\n     /**\r\n       * Validate if the timeline icon should be shown or not, depending on features endpoint\r\n       */\r\n    isAvailableTimelineByProcessType: function (isAdhocProcess) {\r\n        return (!isAdhocProcess ||\r\n            (isAdhocProcess && bizagi.util.isEnableFeature(\"enableTimelineOnLiveProcesses\")));\r\n    },\r\n\r\n    /*\r\n    *   Changes selected process and updates the content\r\n    */\r\n    changeProcess: function (options) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var casesContainer = $(\"#contentCases\", content);\r\n        var procContainer = $(\"#contentProc\", content);\r\n        var pageSelector = $(\"#footer #casesPagination\");\r\n        var nElemToShow = 14;\r\n        options = options || {};\r\n\r\n        var res=self.setFiltersOnChangeProcess(self,options);\r\n        var page = res.page;\r\n        var taskState = res.taskState;\r\n        var idWorkflow = res.idWorkflow;\r\n        var orderFieldName = res.orderFieldName;\r\n        var orderType = res.orderType;\r\n        var order = res.order;\r\n\r\n        bizagi.referrerParams.page = page;\r\n        \r\n        var smartfoldersParameters = \"\";\r\n        \r\n        if (self.params.smartfoldersParameters && self.params.smartfoldersParameters.urlParameters) {\r\n            smartfoldersParameters = self.params.smartfoldersParameters.urlParameters;\r\n        }\r\n        // Clear content\r\n        casesContainer.empty();\r\n        pageSelector.hide().empty();\r\n\r\n        // Load cases by process and task state\r\n        bizagi.showErrorAlertDialog = false;\r\n        $.when(self.dataService.getCustomizedColumnsData({\r\n            idWorkflow: idWorkflow,\r\n            taskState: taskState,\r\n            // Filter by favorites  only when we are searching all processes and favorites\r\n            onlyFavorites: eval(self.onlyFavorites),\r\n            // Sort and order parameters\r\n            order: order,\r\n            orderFieldName: orderFieldName,\r\n            orderType: orderType,\r\n            page: page,\r\n            pageSize: self.getRowValueCookie().numberRows,\r\n            smartfoldersParameters: smartfoldersParameters,\r\n            group: (bizagiConfig.groupByCaseNumber)?\"T_RADNUMBER\":null\r\n        })).done(function (data) {\r\n            bizagi.showErrorAlertDialog = true;\r\n            $(data.cases.rows).each(function(key, value){\r\n                if(!value.isAdhocProcess || typeof value.isAdhocProcess ==='undefined' ) value.isAdhocProcess = false;\r\n                if( value.isAdhocProcess ){\r\n                    self.adhocIds.push({\r\n                        'caseId': value.id,\r\n                        'processId': value.idAdhocProcess\r\n                    });\r\n                }\r\n                value.enableTimelineByProcessType = self.isAvailableTimelineByProcessType(value.isAdhocProcess);\r\n            });\r\n            // Define list of cases\r\n            bizagi.lstIdCases = data.cases.lstIdCases;\r\n\r\n            //  Hack json data :(\r\n            var i = 0;\r\n            $(data.cases.columnTitle).each(function (key, value) {\r\n                if (value.order == \"T_idTask\") {\r\n                    $(data.cases.rows).each(function (key2, value2) {\r\n                        if (!self.isArray(value2[\"fields\"][i])) {\r\n                            data[\"cases\"][\"rows\"][key2][\"fields\"][i] = {\r\n                                \"workitems\": [{\r\n                                    \"TaskName\": value2[\"fields\"][i],\r\n                                    \"State\": data[\"cases\"][\"rows\"][key2][\"taskState\"]\r\n                                }]\r\n                            };\r\n                        }\r\n                    });\r\n                }\r\n                i++;\r\n            });\r\n\r\n            // Show or hide \"load more\" button\r\n            var pdata = {};\r\n            pdata.pagination = (data[\"cases\"][\"totalPages\"] > 1) ? true : false;\r\n            pdata.page = bizagi.referrerParams.page || data[\"cases\"][\"page\"];\r\n\r\n            // set total pages\r\n            pdata.pages = {};\r\n            var pageToshow = (nElemToShow > data[\"cases\"][\"totalPages\"]) ? data[\"cases\"][\"totalPages\"] : nElemToShow;\r\n            for (i = 1; i <= pageToshow; i++) {\r\n                pdata.pages[i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n\r\n            // Set style pagination\r\n            pdata[\"gridPagination\"] = \"gridCasePagination\";\r\n            pdata.previousPage = (data.cases.page > 1) ? data.cases.page - 1 : 1;\r\n            pdata.nextPage = (data.cases.page < data.cases.totalPages) ? data.cases.page + 1 : data.cases.totalPages;\r\n            pdata.totalPages = data.cases.totalPages;\r\n            if(pdata.totalPages>1){\r\n                var paginationHtml = $.tmpl(self.paginationTemplate, pdata).html();\r\n\r\n                // Get template\r\n                $(pageSelector).show().append(paginationHtml);\r\n            }\r\n            data.cases.enableFolders = bizagi.override.enableFolder || false;\r\n            data.cases = bizagi.util.formatDecimalAndMoneyCell(data.cases, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n\r\n            // Get security\r\n            var security = new bizagi.workportal.command.security(self.dataService);\r\n            $.when(security.checkSecurityPerm(\"GraphicQuery\"),\r\n                security.checkSecurityPerm(\"TimeLine\")).done(function (graphicQuery, timeLine) {\r\n                data.cases.graphicQuery = graphicQuery;\r\n                data.cases.timeLine = timeLine && bizagi.override.enableFeatureShowTimelineButton;\r\n                data.cases.groupByCaseNumber = bizagiConfig.groupByCaseNumber;\r\n                // Get template\r\n                var renderedTemplate = $.tmpl(self.casesTemplate, data.cases, {\r\n                    showMagicButton: function () { return bizagi.override.enableAdhocProcess; },\r\n                    setFormat: self.formatValue,\r\n                    isArray: self.isArray,\r\n                    formatCategories: self.formatCategories,\r\n                    isDate: bizagi.util.isDate,\r\n                    replaceLineBreak: function (string) {\r\n                        return typeof string === \"string\" ? (string.search(/\\n/) !== -1 ? string.replaceAll(\"\\n\", \"<br/>\") : string) : string;\r\n                    },\r\n                    getRadNumberColumnIndex: function(){\r\n                        var data = this.data;\r\n                        var index = -1;\r\n                        for(var i=0,l=data.columnTitle.length; i<l;i++){\r\n                            if(data.columnTitle[i].fieldName ==\"I_RadNumber\"){\r\n                                index = i;\r\n                            }\r\n                        }\r\n                        return index;\r\n                    },\r\n                    showColumn:function(columnIndex) {\r\n                        var index = this.getRadNumberColumnIndex();\r\n                        return (this.data.groupByCaseNumber && index == columnIndex)? \" style=display:none; \": \"\";\r\n                    },\r\n                    createGroupedHeader:function(rowIndex){\r\n                        var data = this.data;\r\n                        var result = false;\r\n                        var radNumber = this.getRadNumber(data.rows[rowIndex]);\r\n                        if(data.groupByCaseNumber){\r\n                            if(rowIndex == 0){\r\n                                result = true;\r\n                            }else{\r\n                                var previousRadNumber = this.getRadNumber(data.rows[rowIndex-1]);\r\n                                if(radNumber != previousRadNumber){\r\n                                    result = true;\r\n                                }\r\n                            }\r\n                        }\r\n                        return result;\r\n                    },\r\n                    getRadNumber:function(row){\r\n                        var index = this.getRadNumberColumnIndex();\r\n                        return (index >= 0)? row.fields[index] : \"\";\r\n                    },\r\n                    /**\r\n                     * validate if in the first row and group by cases and if is IE necesary for bug QAF-1883 fixed head table\r\n                     * @param {Int} rowIndex row index item of case\r\n                     */\r\n                    isIEAndFirstRowAndGroupCases:function (rowIndex) {\r\n                        return rowIndex==0 && this.data.groupByCaseNumber && bizagi.util.isIE();\r\n                    }\r\n                }).appendTo(casesContainer);\r\n\r\n                //There is an issue with ie9 and long tables, its removes the space between closed td and next opened td\r\n                if (bizagi.util.isIE9()) {\r\n                    var expr = new RegExp('>[ \\t\\r\\n\\v\\f]*<', 'g');\r\n                    var tbhtml = $(\"#ui-bizagi-wp-app-inbox-grid-cases\", casesContainer).html();\r\n\r\n                    $(\"#ui-bizagi-wp-app-inbox-grid-cases\", casesContainer).html(tbhtml.replace(expr, \"><\"));\r\n                }\r\n\r\n                // Format invariant dates\r\n                if (bizagi.override.ShowTimeInInboxDates == 1 || bizagi.override.ShowTimeInInboxDates == undefined)\r\n                    bizagi.util.formatInvariantDate(content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n                else\r\n                    bizagi.util.formatInvariantDate(content, self.getResource(\"dateFormat\"));\r\n\r\n                // Set data for pagination\r\n                $(\"li\", pageSelector).parent().data(\"order\", order);\r\n                $(\"li\", pageSelector).parent().data(\"orderFieldName\", orderFieldName);\r\n                $(\"li\", pageSelector).parent().data(\"orderType\", orderType);\r\n                // Crate pagination control\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: 50,\r\n                    totalPages: pdata.totalPages,\r\n                    actualPage: pdata.page,\r\n                    listElement: $(\"ul\", pageSelector),\r\n                    clickCallBack: function (options) {\r\n                        self.changeProcess({\r\n                            idWorkflow: idWorkflow,\r\n                            page: options.page,\r\n                            order: options.parent.data(\"order\"),\r\n                            orderFieldName: options.parent.data(\"orderFieldName\"),\r\n                            orderType: options.parent.data(\"orderType\")\r\n                        });\r\n                    }\r\n                });\r\n\r\n\r\n                //Work on it button\r\n                //$(\".workonitRow\", content).button();\r\n                $(\".inbox-grid-tooltip-button\", content).tooltip();\r\n\r\n                // Set even style\r\n                $(\"#ui-bizagi-wp-app-inbox-grid-cases tr:nth-child(even)\", renderedTemplate).addClass(\"event\");\r\n\r\n                // Add click event for activities\r\n                $(\".ui-bizagi-wp-app-inbox-activity-name\", renderedTemplate).click(function () {\r\n                    var referrerParams = {\r\n                        taskState: self.params.taskState,\r\n                        idWorkItem: $(this).find(\"#idWorkItem\").val(),\r\n                        idCase: $(this).find(\"#idCase\").val(),\r\n                        idTask: $(this).find(\"#idTask\").val(),\r\n                        onlyFavorites: self.onlyFavorites,\r\n                        idWorkflow: self.idWorkflow,\r\n                        referrer: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n                    };\r\n\r\n                    $.extend(bizagi.referrerParams, bizagi.referrerParams, referrerParams);\r\n\r\n                    // Call routing action\r\n                    var idCase = $(this).find(\"#idCase\").val();\r\n                    var idTask = $(this).find(\"#idTask\").val();\r\n                    var idWorkItem = $(this).find(\"#idWorkItem\").val();\r\n                    var idWorkflow = $(this).closest('tr').data(\"idworkflow\");\r\n\r\n                    self.publish(\"executeAction\", {\r\n                        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                        idCase: idCase,\r\n                        idWorkItem: idWorkItem,\r\n                        idTask: idTask,\r\n                        idWorkflow: idWorkflow\r\n                    });\r\n                });\r\n\r\n                $(\".ui-bizagi-wp-app-inbox-grouped\",renderedTemplate).bind(\"click\", function(){\r\n                    var radNumber = $(this).data(\"radnumber\");\r\n                    var referrerParams = {\r\n                        taskState: self.params.taskState,\r\n                        idWorkItem: $(this).find(\"#idWorkItem\").val(),\r\n                        idCase: $(this).find(\"#idCase\").val(),\r\n                        idTask: $(this).find(\"#idTask\").val(),\r\n                        onlyFavorites: self.onlyFavorites,\r\n                        idWorkflow: self.idWorkflow,\r\n                        referrer: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n                    };\r\n                    $.extend(bizagi.referrerParams, bizagi.referrerParams, referrerParams);\r\n\r\n                    var idCase = $(this).find(\"#idCase\").val();\r\n\r\n                    self.publish(\"executeAction\", {\r\n                        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                        idCase: idCase\r\n                    });\r\n                });\r\n\r\n                // Bind favorites start\r\n                $(renderedTemplate).delegate(\".ui-bizagi-wp-app-inbox-cases-start\", \"click\", function (e) {\r\n                    e.stopPropagation();\r\n                    var favoriteOptions;\r\n                    var elmnt = this;\r\n                    $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start\").addClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\");\r\n\r\n                    // check if its favorite\r\n                    if ($(elmnt).parent().find(\"#isFavorite\").val() == \"false\") {\r\n                        favoriteOptions = {\r\n                            idObject: $(elmnt).parent().find(\"#idCase\").val(),\r\n                            favoriteType: \"CASES\"\r\n                        };\r\n                        $.when(\r\n                                self.dataService.addFavorite(favoriteOptions)\r\n                                ).done(function (favoritesData) {\r\n                                    $(elmnt).parent().find(\"#guidFavorite\").val(favoritesData[\"idFavorites\"]);\r\n                                    $(elmnt).removeClass(\"bz-icon-star-outline\").addClass(\"bz-icon-star\");\r\n                                    $(elmnt).parent().find(\"#isFavorite\").val(\"true\");\r\n                                    $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\").addClass(\"ui-bizagi-wp-app-inbox-cases-start\");\r\n                                    self.updateCountProcess(idWorkflow, true);\r\n                                });\r\n                    } else {\r\n                        favoriteOptions = {\r\n                            idObject: $(elmnt).parent().find(\"#guidFavorite\").val(),\r\n                            favoriteType: \"CASES\"\r\n                        };\r\n                        $.when(\r\n                                self.dataService.delFavorite(favoriteOptions)\r\n                                ).done(function (favoritesData) {\r\n                                    if (favoritesData[\"deleted\"] == \"true\" || favoritesData[\"deleted\"] == true) {\r\n                                        $(elmnt).parent().find(\"#guidFavorite\").val(\"\");\r\n                                        $(elmnt).removeClass(\"bz-icon-star\").addClass(\"bz-icon-star-outline\");\r\n                                        $(elmnt).parent().find(\"#isFavorite\").val(\"false\");\r\n                                        $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\").addClass(\"ui-bizagi-wp-app-inbox-cases-start\");\r\n                                        self.updateCountProcess(idWorkflow, false);\r\n                                    }\r\n                                });\r\n                    }\r\n                });\r\n\r\n                // show case summary\r\n                $(\"i.bz-icon-search-outline\", renderedTemplate).click(function () {\r\n                    // Call routing action\r\n                    var idCase = $(this).parents(\"td\").first().find(\"#idCase\").val();\r\n                    var idWorkflow = $(this).closest(\"tr\").data(\"idworkflow\");\r\n                    self.showCase(idCase, idWorkflow);\r\n                });\r\n\r\n\r\n\r\n                // Add click to view workflow\r\n                $(\".ui-bizagi-wp-app-inbox-cases-ico-view\", renderedTemplate).click(function (event) {\r\n                    var idCase = $(this).parent().children(\"#idCase\").val();\r\n                    var idWorkflow = $(this).closest(\"tr\").data(\"idworkflow\");\r\n                    var isAdhoc = $(this).closest(\"tr\").data(\"isadhoc\");\r\n                    var processId = null;\r\n                    if( isAdhoc ){\r\n                        for( var i = 0; i < self.adhocIds.length; i++){\r\n                            if( parseInt(idCase) ==  self.adhocIds[ i ].caseId){\r\n                                processId = self.adhocIds[ i ].processId;\r\n                                self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow, isAdhoc: true, idProcess: processId });\r\n                                break;\r\n                            }\r\n                        }\r\n                    }else{\r\n                        self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow });\r\n                    }\r\n\r\n                    event.preventDefault();\r\n                });\r\n\r\n                // Add click to timeline icon\r\n                $(\".js-show-timeline\", renderedTemplate).click(function (event){\r\n                    var idCase = $(this).parent().children(\"#idCase\").val();\r\n                    var caseNumber = $.trim($(this).closest(\"tr\").find(\".I_RadNumber\").text());\r\n                    self.showTimeLine({ radNumber: caseNumber, idCase: idCase });\r\n                });\r\n                // bind for sort columns\r\n                $(\".sortColumnsData\", casesContainer).click(function () {\r\n                    self.changeProcess({\r\n                        idWorkflow: idWorkflow,\r\n                        orderFieldName: $(this).find(\"#orderFieldName\").val(),\r\n                        orderType: (($(this).find(\"#orderType\").val() == 0) ? 1 : 0),\r\n                        order: $(this).find(\"#order\").val()\r\n                    });\r\n\r\n                });\r\n\r\n                // Add scroll bars\r\n                $(casesContainer).bizagiScrollbar({\r\n                    \"autohide\": false\r\n                });\r\n\r\n                // Bind Folders\r\n                $(\".ui-bizagi-inbox-folder\", renderedTemplate).click(function (e) {\r\n                    e.stopPropagation();\r\n                    var idCase = $(this).data(\"idcase\");\r\n\r\n                    // If the same popup is opened close it\r\n                    if (self.currentPopup == \"folders\") {\r\n                        bizagi.workportal.desktop.popup.closePopupInstance();\r\n                        return;\r\n                    }\r\n\r\n                    // Creates popup\r\n                    self.popupOpened = true;\r\n                    self.currentPopup = \"folders\";\r\n                    self.publish(\"popupWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FOLDERS,\r\n                        options: {\r\n                            sourceElement: $(this),\r\n                            modalClass: \"folders\",\r\n                            'max-height': '146',\r\n                            height: 'auto',\r\n                            width: '110',\r\n                            offset: \"88 0\",\r\n                            activeScroll: true,\r\n                            onlyFolderMode: true,\r\n                            idCase: idCase,\r\n                            closed: function () {\r\n                                self.currentPopup = null;\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n\r\n\r\n                $(\".ui-bizagi-wp-app-magic-button\", casesContainer).bind(\"click\", function () {\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INTEGRATION,\r\n                        module: \"adhocProcess\",\r\n                        selector: \"app-root\"\r\n                    });\r\n                    \r\n                });\r\n\r\n                $(procContainer).bizagiScrollbar();\r\n            });\r\n            \r\n            var queryTableElement=$(\"li#contentCases > .ui-bizagi-wp-app-inbox-grid-cases-container-parent-tableHeadFixed > .ui-bizagi-wp-app-inbox-grid-cases-container-tableHeadFixed > table\");\r\n            self.setTableHeadFixed({\r\n                TableElement:queryTableElement,\r\n                groupByCaseNumber:data.cases.groupByCaseNumber,\r\n                floatOptions:{\r\n                    position: 'fixed',\r\n                    zIndex:1,\r\n                    scrollContainer: function() {\r\n                        return $(\"li#contentCases > .ui-bizagi-wp-app-inbox-grid-cases-container-parent-tableHeadFixed > .ui-bizagi-wp-app-inbox-grid-cases-container-tableHeadFixed\");\r\n                    }\r\n                }\r\n            });\r\n            queryTableElement.find(\"thead > tr\").height(queryTableElement.prev().height());\r\n        }).fail(function (error) {\r\n            error = JSON.parse(error.responseText) || {};\r\n            var errorTemplate = self.workportalFacade.getTemplate(\"info-message\");\r\n            var message = error.message || error;\r\n            var errorHtml = $.tmpl(errorTemplate, {\r\n                message: message\r\n            });\r\n\r\n            errorHtml.appendTo(casesContainer);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Shows a popup with the case information\r\n    */\r\n    showCase: function (idCase, idWorkflow) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var caseSummaryContainer = $(\"#contentDesc\", content);\r\n        var cache = {};\r\n        var htmlContent = \"\";\r\n\r\n        // Update internal variable\r\n        self.idCase = idCase;\r\n\r\n        caseSummaryContainer.empty();\r\n\r\n        // Don't search data when there is no case\r\n        if (self.idCase == 0) {\r\n            return;\r\n        }\r\n\r\n        // Render Form Tab\r\n        $.when(\r\n                self.dataService.summaryCaseDetails({\r\n                    idCase: self.idCase\r\n                })\r\n                ).done(function (data) {\r\n                    var adhocProcessId = null;\r\n                    var isAdhoc = false;\r\n                    if(!data.isAdhocProcess || typeof data.isAdhocProcess ==='undefined' ) data.isAdhocProcess = false;\r\n                    if( data.isAdhocProcess ){\r\n                        adhocProcessId = data.idAdhocProcess;\r\n                        isAdhoc = true;\r\n                    }\r\n                    data.hasComments = (data.hasComments == 'true') ? true : false;\r\n\r\n                    // Get security\r\n                    var security = new bizagi.workportal.command.security(self.dataService);\r\n                    data.graphicQuery = security.checkSecurityPerm(\"GraphicQuery\");\r\n\r\n                    data.enableFeatureShowTimelineButton = bizagi.override.enableFeatureShowTimelineButton;\r\n                    data.enableTimelineByProcessType = self.isAvailableTimelineByProcessType(data.isAdhocProcess);\r\n\r\n                    if(data.currentState && data.currentState.length > 0){\r\n                        data.currentState.forEach(function(currentState){\r\n                            if(!currentState.idTask){\r\n                                currentState.idTask = 0;\r\n                            }\r\n                            if(!currentState.state){\r\n                                currentState.state = currentState.displayName || \" \";\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    if(data.process === \"undefined\" || data.process === \"\" || typeof data.process === \"undefined\"){\r\n                        data.process = false;\r\n                    }\r\n\r\n                    if(data.processPath === \"undefined\" || data.processPath === \"\" || typeof data.processPath === \"undefined\"){\r\n                        data.processPath = false;\r\n                    }\r\n\r\n\r\n                    var renderedTemplate = $.tmpl(self.caseSummaryTemplate, $.extend(data, {security: bizagi.menuSecurity})).appendTo(caseSummaryContainer);\r\n\r\n                    // Format invariant dates\r\n                    bizagi.util.formatInvariantDate(content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n\r\n                    // Delegate events for parent process\r\n                    $(\"#details\", renderedTemplate).delegate(\".summaryLink\", \"click\", function () {\r\n                        self.routingExecute($(this));\r\n                        caseSummaryDialog.dialog('close');\r\n                    });\r\n\r\n                    var caseSummaryDialog = renderedTemplate;\r\n\r\n                    // jQuery-ui tabs\r\n                    $(\"#ui-bizagi-details-tabs\", content).tabs({\r\n                        active: -1,\r\n                        create: function (event, ui) {\r\n                            $(this).tabs(\"option\", \"active\", 0);\r\n                        },\r\n                        \"activate\": function (event, ui) {\r\n                            var panel = (ui == undefined) ? \"formSummary\" : ui.newPanel.attr('id');\r\n                            switch (panel) {\r\n                                case \"comments\":\r\n                                    if (cache[\"comments\"] == undefined) {\r\n                                        // Extend render with comments\r\n                                        $.extend(self, {}, bizagi.workportal.comments);\r\n\r\n                                        // Define canvas\r\n                                        data.canvas = $(\"#comments\");\r\n                                        data.readOnly = true;\r\n\r\n                                        $.when(self.renderComments(data))\r\n                                    .done(function (htmlContent) {\r\n                                        cache[\"comments\"] = htmlContent;\r\n                                    });\r\n                                    }\r\n                                    bizagi.util.setContext({\r\n                                        commentsFocus: true\r\n                                    });\r\n                                    break;\r\n                                case \"formSummary\":\r\n                                    if (cache[\"formSummary\"] == undefined) {\r\n                                        var canvas = $(\"#formSummary\", caseSummaryContainer);\r\n\r\n                                        // Define action when render form has not been migrated\r\n                                        canvas.bind(\"oldrenderintegration\", function (e) {\r\n                                            if (e.isPropagationStopped()) {\r\n                                                return;\r\n                                            }\r\n                                            e.stopPropagation();\r\n\r\n                                            var template = self.getTemplate(\"inbox-common-case-summary-oldrender\");\r\n                                            var data = {};\r\n\r\n                                            bizagi.oldrenderevent = true; // has been loaded\r\n                                            var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n                                            var eventer = window[eventMethod];\r\n                                            var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n\r\n                                            // Listen to message from child window\r\n                                            eventer(messageEvent, function (e) {\r\n                                                e.stopPropagation();\r\n                                                self.publish(\"executeAction\", {\r\n                                                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                                                    idCase: e.data\r\n                                                });\r\n                                            }, false);\r\n\r\n                                            // Define wirkitem and idtask\r\n                                            $.when(self.dataService.getWorkitems({\r\n                                                idCase: self.idCase,\r\n                                                onlyUserWorkItems: true,\r\n                                                eventAsTasks: true\r\n                                            })).done(function (getWorkitems) {\r\n                                                // verify workitem, in some cases these variables are not available\r\n                                                if (typeof getWorkitems.workItems == \"object\" && getWorkitems.workItems.length >= 1) {\r\n                                                    // Case Open\r\n                                                    var idWorkitem = getWorkitems.workItems[0]['idWorkItem'];\r\n                                                    var idTask = getWorkitems.workItems[0]['idTask'];\r\n\r\n                                                    for (i = 0; i < getWorkitems.workItems.length; i++) {\r\n                                                        if (getWorkitems.workItems[i]['idCase'] == self.idCase) {\r\n                                                            idWorkitem = getWorkitems.workItems[i]['idWorkItem'];\r\n                                                            idTask = getWorkitems.workItems[i]['idTask'];\r\n                                                            break;\r\n                                                        }\r\n                                                    }\r\n\r\n                                                    data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&idWorkitem=\" + idWorkitem + \"&idTask=\" + idTask + \"&isSummary=1\";\r\n                                                } else {\r\n                                                    // Case closed\r\n                                                    data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&isSummary=1\";\r\n                                                }\r\n\r\n                                                // Render content\r\n                                                canvas.empty();\r\n                                                $.tmpl(template, data).appendTo(canvas);\r\n                                                //Set styles\r\n                                                self.iframeOldRender($(\"iframe\", canvas));\r\n                                            });\r\n                                        });\r\n\r\n                                        var params = {\r\n                                            idCase: self.idCase\r\n                                        };\r\n\r\n                                        $.when(self.dataService.getCaseFormsRenderVersion(params))\r\n                                    .done(function (formsVersion) {\r\n                                        if (formsVersion.formsRenderVersion == 1) {\r\n                                            canvas.trigger(\"oldrenderintegration\");\r\n                                        } else {\r\n                                            $.when(\r\n                                            self.renderSummaryForm($(\"#formSummary\", renderedTemplate))\r\n                                            ).done(function () {\r\n                                                htmlContent = $(\"#formSummary\", renderedTemplate).html();\r\n                                                cache[\"formSummary\"] = htmlContent;\r\n                                            });\r\n                                        }\r\n                                    });\r\n                                    }\r\n                                    break;\r\n                                case \"subprocess\":\r\n                                    if (cache[\"subprocess\"] == undefined) {\r\n                                        $.when(\r\n                                    self.dataService.summarySubProcess({\r\n                                        idCase: self.idCase\r\n                                    })\r\n                                    ).done(function (subprocess) {\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateSubprocess, subprocess);\r\n                                        htmlContent.appendTo($(\"#subprocess\", renderedTemplate));\r\n                                        cache[\"subprocess\"] = htmlContent;\r\n\r\n                                        // Define Events for subprocess tab\r\n                                        htmlContent.delegate(\".summaryLink\", \"click\", function () {\r\n                                            self.routingExecute($(this));\r\n                                            caseSummaryDialog.dialog('close');\r\n                                        });\r\n                                    });\r\n                                    }\r\n                                    break;\r\n                                case \"assignees\":\r\n                                    if (cache[\"assignees\"] == undefined) {\r\n                                        $.when(\r\n                                    self.dataService.summaryAssigness({\r\n                                        idCase: self.idCase,\r\n                                        preview:true\r\n                                    })\r\n                                    ).done(function (assignees) {\r\n                                        // Generates  lists of unique assignees for Events\r\n                                        var eventsUniqueList = [];\r\n                                        $.each(assignees.events.split(\", \"), function (i, el) {\r\n                                            if ($.inArray(el, eventsUniqueList) === -1) eventsUniqueList.push(el);\r\n                                        });\r\n                                        assignees.events = eventsUniqueList.join(\", \");\r\n\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateAssigness, assignees);\r\n                                        htmlContent.appendTo($(\"#assignees\", renderedTemplate));\r\n                                        cache[\"assignees\"] = htmlContent;\r\n                                    });\r\n                                    }\r\n                                    break;\r\n                                case \"events\":\r\n                                    if (cache[\"events\"] == undefined) {\r\n                                        $.when(\r\n                                    self.dataService.summaryCaseEvents({\r\n                                        idCase: self.idCase\r\n                                    })\r\n                                    ).done(function (events) {\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateEvents, events);\r\n                                        htmlContent.appendTo($(\"#events\", renderedTemplate));\r\n                                        cache[\"events\"] = htmlContent;\r\n\r\n                                        htmlContent.delegate(\".summaryLink\", \"click\", function () {\r\n                                            self.routingExecute($(this));\r\n                                            caseSummaryDialog.dialog('close');\r\n                                        });\r\n                                    });\r\n                                    }\r\n                                    break;\r\n                            }\r\n                        }\r\n                    });\r\n\r\n\r\n                    // jquery UI Button work on it button\r\n                    $(\".workonitRow\", renderedTemplate).button();\r\n\r\n                    // Add click to timeline icon\r\n                    $(\".js-show-timeline\", renderedTemplate).click(function (event){\r\n                        var caseNumber = $.trim($(this).closest(\"div.ui-bizagi-wp-app-inbox-processes-title\").find(\"span.js-case-number\").text());\r\n                        self.showTimeLine({ radNumber: caseNumber, idCase: idCase });\r\n                    });\r\n\r\n                    // Add click to view workflow\r\n                    $(\"#ui-bizagi-wp-app-inbox-description-container .ui-bizagi-wp-app-inbox-cases-ico-view\", content).click(function () {\r\n                        if( isAdhoc ){\r\n                            self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow, isAdhoc: true, idProcess: adhocProcessId });\r\n                        }else {\r\n                            self.showGraphicQuery({idCase: idCase, idWorkflow: idWorkflow});\r\n                        }\r\n                    });\r\n\r\n\r\n\r\n                    // Bind events for events and process on summary case\r\n                    $(\".workonitRow\", renderedTemplate).click(function () {\r\n                        var referrerParams = {\r\n                            taskState: self.params.taskState,\r\n                            idWorkItem: $(this).parent().find(\"#idWorkItem\").val(),\r\n                            idCase: data.idCase,\r\n                            idTask: $(this).parent().find(\"#idTask\").val(),\r\n                            onlyFavorites: self.onlyFavorites,\r\n                            idWorkflow: self.idWorkflow,\r\n                            referrer: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n                        }\r\n\r\n                        $.extend(bizagi.referrerParams, bizagi.referrerParams, referrerParams);\r\n                        // Executes routing action\r\n                        caseSummaryDialog.dialog('close');\r\n                        self.publish(\"executeAction\", {\r\n                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                            idCase: data.idCase,\r\n                            idWorkflow: idWorkflow,\r\n                            idTask: $(this).parent().find(\"#idTask\").val(),\r\n                            idWorkItem: $(this).parent().find(\"#idWorkItem\").val()\r\n                        });\r\n                    });\r\n\r\n                    // Set buttons\r\n                    var buttons = {};\r\n                    buttons[bizagi.localization.getResource(\"workportal-case-dialog-box-close\")] = function () {\r\n                        caseSummaryContainer.empty();\r\n                        renderedTemplate.remove();\r\n                        $(\"#ui-bizagi-wp-app-inbox-description-container\").remove();\r\n                    };\r\n\r\n                    caseSummaryDialog.dialog({\r\n                        modal: true,\r\n                        title: data.process,\r\n                        width: 1000,\r\n                        height: 600,\r\n                        draggable: true,\r\n                        resizable: true,\r\n                        buttons: buttons,\r\n                        close: function () {\r\n                            caseSummaryContainer.empty();\r\n                            renderedTemplate.remove();\r\n                            $(\"#ui-bizagi-wp-app-inbox-description-container\").remove();\r\n                        }\r\n                    });\r\n\r\n                    //$(\"\").add(\"workonitRow\")\r\n\r\n                });\r\n    },\r\n    /*\r\n    *   Misc method to format cell values\r\n    */\r\n    formatRequest: function (value) {\r\n        return value;\r\n    },\r\n    /**\r\n    * Misc method to render categories\r\n    */\r\n    formatCategories: function (value) {\r\n        return value;\r\n\r\n    },\r\n    isArray: function (value) {\r\n        if (typeof (value) == 'object') {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n    /**\r\n    *  Change total processes indicator, when start favorites view and user select or deselect\r\n    *  favorite cases.\r\n    *\r\n    *  @augments increment  {true || false }, true= increment +1 , false = decrement -1, default true.\r\n    */\r\n    updateCountProcess: function (idWorkflow, increment) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processesContainer = $(\"#contentProc\", content);\r\n        var assigned = false;\r\n\r\n        increment = (increment) ? true : false;\r\n\r\n        // Check if task state is diferent to Favorites\r\n        if (self.params.taskState != \"Favorites\" || idWorkflow == \"\") {\r\n            return true;\r\n        }\r\n\r\n\r\n        // Get all process and verify new favorites count\r\n        // Loads processes by task state\r\n        $.when(self.dataService.getAllProcesses({\r\n            taskState: self.taskState,\r\n            onlyFavorites: self.onlyFavorites\r\n        }))\r\n                .done(function (data) {\r\n                    data.categories = data.categories || {};\r\n                    $.each(data.categories, function (key, value) {\r\n                        $.each(value.workflows, function (key2, value2) {\r\n                            if (value2.idworkflow == idWorkflow) {\r\n                                // update value\r\n                                // Find list elements\r\n                                $('li > input[value=\"' + idWorkflow + '\"][id=\"idWorkflow\"]', processesContainer).parent().find(\".ui-bizagi-wp-app-inbox-processes-ncase\").html(value2.count);\r\n                                assigned = true;\r\n                            }\r\n                        })\r\n                    });\r\n\r\n                    // If element reach 0 cases, set 0\r\n                    if (!assigned) {\r\n                        if (increment) {\r\n                            $('li > input[value=\"' + idWorkflow + '\"][id=\"idWorkflow\"]', processesContainer).parent().find(\".ui-bizagi-wp-app-inbox-processes-ncase\").html(1);\r\n                        } else {\r\n                            $('li > input[value=\"' + idWorkflow + '\"][id=\"idWorkflow\"]', processesContainer).parent().find(\".ui-bizagi-wp-app-inbox-processes-ncase\").html(0);\r\n                        }\r\n                    }\r\n                });\r\n    },\r\n    /**\r\n    * Inject styles and js into the iframe\r\n    */\r\n    iframeOldRender: function (canvas) {\r\n        var self = this;\r\n        var iframe;\r\n        var content = self.getContent();\r\n        var theme = \"bizagiDefault\";\r\n        var queryString = bizagi.readQueryString();\r\n\r\n        $.each(canvas, function () {\r\n            if ($(this).is(\"iframe\")) {\r\n                iframe = $(this);\r\n            }\r\n        });\r\n\r\n        iframe.load(function () {\r\n            // inject css\r\n            var content = $(this).contents();\r\n\r\n            // Fixed problem with relative path across the different browsers\r\n            var cssLocation = ($.browser.mozilla || $.browser.webkit) ? \"../../css/render_%theme%.css\" : \"css/render_%theme%.css\";\r\n\r\n            // Define theme\r\n            cssLocation = cssLocation.replace(\"%theme%\", (queryString[\"theme\"] || theme));\r\n\r\n            // Append css\r\n            $('body', content).append(\"<link type='text/css' rel='stylesheet' href='\" + cssLocation + \"'>\");\r\n\r\n            // Append javascript\r\n            //  $('head',content).append(\"<script type='text/javascript' src='../../js/renderintegration.js'></script>\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Disposes the widget\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n\r\n});\r\n\r\nbizagi.workportal.widgets.inboxGrid.extend(\"bizagi.workportal.widgets.inboxGridRubik\", {}, {\r\n\t/**\r\n\t * Overrite of renderContent\r\n\t *\r\n\t * @return {*}\r\n\t */\r\n\trenderContent: function () {\r\n\t\tvar self = this;\r\n\t\tvar template = self.getTemplate(\"inbox-grid-rubik\");\r\n\r\n\t\t// Render content\r\n\t\tvar content = self.content = $.tmpl(template,{});\r\n\r\n\t\t// Set inbox view variable\r\n\t\tbizagi.workportal.currentInboxView = self.getWidgetName();\r\n\r\n\t\treturn content;\r\n\t},\r\n\r\n\t/**\r\n\t * Override of postRender\r\n\t */\r\n\tpostRender: function(){\r\n\t\tvar self = this;\r\n\r\n\t\tbizagi.referrerParams = (self.params.restoreStatus) ? bizagi.referrerParams || {} : {};\r\n\r\n\t\tself.changeProcess({idWorkflow: \"\", workflowName: \"All Cases \", smartfoldersParameters: \"\"});\r\n\r\n\t\t/**\r\n\t\t * Publish event to list cases\r\n\t\t *\r\n\t\t * @param {idWorkflow, page, orderFieldName, orderType, order, taskState}\r\n\t\t */\r\n\t\tself.getEventListener().on(\"PROCESS-VIEW-UPDATE\",function(e,params){\r\n\t\t\tself.changeProcess(params);\r\n\t\t});\r\n\t}\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Folder Widget Controller\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define a base class to to define the folders widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.folders\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function(){  \r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FOLDERS;\r\n    },\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"folders\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders\"),\r\n            \"folders-elements\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-elements\"),\r\n            \"folders-empty-elements\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-empty-elements\"),\r\n            \"folders-query-tree\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-query-tree\"),\r\n            \"folders-query-confirm\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-confirm\"),\r\n            \"folders-default\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-default\"),\r\n            \"folders-input-new\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-input-new\"),\r\n            \"folders-add-case\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-add-case\"),\r\n            \"folders-elements-node\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-element-node\"),\r\n            \"folders-query-edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.folders\").concat(\"#ui-bizagi-workportal-widget-folders-edit\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"folders\");\r\n        var content = self.content = $.tmpl(template);\r\n        \r\n        return content;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Smart Folder Widget Controller\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define a base class to to define the smart folders widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.smartfolders\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FOLDERS;\r\n    },\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"smartfolders\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders\"),\r\n            \"smartfolders-elements\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-elements\"),\r\n            \"smartfolders-empty-elements\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-empty-elements\"),\r\n            \"smartfolders-query-confirm\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-confirm\"),\r\n            \"smartfolders-default\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-default\"),\r\n            \"smartfolders-add-case\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-add-case\"),\r\n            \"smartfolders-elements-node\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-element-node\"),\r\n            \"smartfolders-query-tree\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-query-tree\"),\r\n            \"smartfolders-query-edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-edit\"),\r\n            \"smartfolders-input-new\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.smartfolders\").concat(\"#ui-bizagi-workportal-widget-smartfolders-input-new\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"smartfolders\");\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Desktop Folders Widget Controller\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script will provide desktop overrides to implement the folder widget\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.folders.extend(\"bizagi.workportal.widgets.folders\", {}, {\r\n\r\n    /**\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function(){\r\n        var self = this;\r\n\r\n        self.params.options.onlyFolderMode = self.params.options.onlyFolderMode || false;\r\n\r\n        // Set bind event for last element\r\n        self.configureTreeNavigation();\r\n\r\n        // Bind back button\r\n        self.configureBackButton();\r\n\r\n        // Render default folders\r\n        // self.renderDefaultFolders();\r\n\r\n        // Render base categories\r\n        self.renderFolders((self.params.options.onlyFolderMode)?\"-1\":\"\");\r\n\r\n        // set vertical scroll\r\n        self.scrollVertical({\r\n            \"autohide\":false\r\n        });\r\n    },\r\n\r\n    renderDefaultFolders: function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var template = self.getTemplate(\"folders-default\");\r\n        var container = $(\"#queries\", content);\r\n\r\n        container.empty();\r\n        $.tmpl(template).appendTo(container);\r\n\r\n    },\r\n\r\n    /**\r\n     * Render List categories for each idCategory\r\n     */\r\n    renderFolders: function(id,appendElement){\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var template = (self.params.options.onlyFolderMode != undefined && self.params.options.onlyFolderMode)?self.getTemplate(\"folders-add-case\"):self.getTemplate(\"folders-elements\");\r\n        var emptyTemplate = self.getTemplate(\"folders-empty-elements\");\r\n        var container = $(\"#queries\", content);\r\n        var queryContent;\r\n        var mergeData;\r\n        var mergeNewFolder ={};\r\n\r\n        id = id || \"\";\r\n\r\n        $.when(self.dataService.getFolders(id))\r\n        .done(function(data) {\r\n\r\n            container.empty();\r\n\r\n            // check if service have nodes\r\n            data = data || undefined;\r\n            var idParent = \"\";\r\n            try{\r\n                if(data.folders != undefined && data.folders.length > 0){\r\n                    idParent = data.folders[0][\"idParent\"];\r\n                }\r\n            }catch(e){}\r\n\r\n\r\n            if(data.folders != undefined && data.folders != \"\"){\r\n                // Check if have appendElement\r\n                if(appendElement != undefined){\r\n                    mergeData = {\r\n                        folders:\r\n                        (data != undefined)?appendElement.concat(data.folders):appendElement\r\n                    };\r\n                //$.merge({folders:appendElement},data)\r\n                //$.merge(appendElement, data); //appendElement.concat(data.folders)\r\n                }else{\r\n                    mergeData = data;\r\n                }\r\n                // Count number of childs\r\n                $.each(mergeData.folders,function(key,value){\r\n                    if(value != undefined && value.childs.folders != undefined){\r\n                        mergeData.folders[key][\"countChilds\"] = mergeData.folders[key][\"childs\"][\"folders\"].length;\r\n                    }else{\r\n                        mergeData.folders[key][\"countChilds\"]=0;\r\n                    }\r\n                });\r\n\r\n                // Append \"new folder\"element\r\n                if(id != \"\" && !self.params.options.onlyFolderMode){\r\n                    mergeNewFolder.folders = mergeData.folders.concat({\r\n                        \"name\": self.getResource(\"workportal-widget-folders-new\"),\r\n                        \"id\": 'newFolder',\r\n                        \"idParent\": idParent,\r\n                        \"childs\": [],\r\n                        \"categoryWithLink\": \"true\",\r\n                        \"countChilds\":0\r\n                    });\r\n                }else{\r\n                    mergeNewFolder = mergeData;\r\n                }\r\n\r\n                queryContent = $.tmpl(template, mergeNewFolder);\r\n            }else if(!self.params.options.onlyFolderMode){\r\n                //Don't have results\r\n                mergeNewFolder.folders = [{\r\n                    \"name\": self.getResource(\"workportal-widget-folders-new\"),\r\n                    \"id\": 'newFolder',\r\n                    \"idParent\": idParent,\r\n                    \"childs\": [],\r\n                    \"categoryWithLink\": \"true\",\r\n                    \"countChilds\":0\r\n                }];\r\n                queryContent = $.tmpl(template,mergeNewFolder);\r\n            }else{\r\n                queryContent = $.tmpl(emptyTemplate);\r\n            }\r\n            queryContent.appendTo(container);\r\n\r\n            // set actions to rendered html\r\n            self.configureNavTree(container);\r\n        });\r\n    },\r\n\r\n\r\n    configureNavTree: function(queriesContainer) {\r\n        var self = this;\r\n        var confirm = self.getTemplate(\"folders-query-confirm\");\r\n\r\n        // Bind for list elements\r\n        $(\"li\", \"#queries\").click(function(e) {\r\n            e.stopPropagation();\r\n            var id =$(this).data(\"id\");\r\n            var countChilds =$(this).data(\"childslength\");\r\n            var name =$(this).data(\"name\");\r\n            var urlParameters =$(this).data(\"urlparameters\");\r\n            var idParent = $(this).data(\"idparent\");\r\n\r\n            var headerTemplate = self.getTemplate(\"folders-query-tree\");\r\n            var categoryTree = $(\"#categoryTree\");\r\n            var queriesListDisplay = $(\".queriesListDisplay li\");\r\n\r\n            // Config inbox view\r\n            if(countChilds == 0 && self.params.options.onlyFolderMode){\r\n                return;\r\n            }\r\n\r\n            // If the node is base folder\r\n            if (id == \"-1\"){\r\n                // Is category\r\n                // Append query header\r\n                $.tmpl(headerTemplate, {\r\n                    idParentQuery: -1,\r\n                    queryDisplayName: name\r\n                }).appendTo(categoryTree);\r\n\r\n                // Set bind event for last element\r\n                self.configureTreeNavigation(idParent);\r\n\r\n                // Render sub-categories\r\n                self.renderFolders(id);\r\n            }else if(id==\"newFolder\"){\r\n                // Create new folder\r\n                self.makeFolder({\r\n                    listElements:queriesListDisplay,\r\n                    idParent:idParent\r\n                });\r\n\r\n            }else if( countChilds > 0 ){\r\n                // Is category with link\r\n\r\n                // Add element for tree navigation\r\n                $.tmpl(headerTemplate, {\r\n                    idParentQuery: id,\r\n                    queryDisplayName: name\r\n                }).appendTo(categoryTree);\r\n\r\n                // Set bind event for last element\r\n                self.configureTreeNavigation(idParent);\r\n\r\n                // Apend this object to children\r\n                self.renderFolders(id,\r\n                    (self.params.options.onlyFolderMode)?[]:\r\n                    [{\r\n                        \"name\": name,\r\n                        \"id\": id,\r\n                        \"idParent\": '',\r\n                        \"childs\": [],\r\n                        \"categoryWithLink\": true,\r\n                        \"urlParameters\":urlParameters\r\n                    }]\r\n                    );\r\n            }else {\r\n                // Is Process\r\n                bizagi.workportal.desktop.popup.closePopupInstance();\r\n                if(countChilds == 0 && urlParameters){\r\n                    $.when(self.dataService.getCasesByFolder(urlParameters))\r\n                    .done(function(data){\r\n                        bizagi.lstIdCases = data.lstIdCases;\r\n                        // Define radnumber for render actions bottons\r\n                        bizagi.referrerParams = bizagi.referrerParams || {};\r\n                        bizagi.referrerParams.radNumber = \"\";//params.radNumber;\r\n                        bizagi.referrerParams.page = \"\";//params.page;\r\n                        bizagi.referrerParams.referrer = \"folders\";\r\n                        bizagi.referrerParams.urlParameters = urlParameters;\r\n                        bizagi.referrerParams.name = name;\r\n                        bizagi.referrerParams.id = id;\r\n\r\n                        // Define widget customized for pagination purposes\r\n                        data.customized = true; \r\n                        data.urlParameters = urlParameters;\r\n                        \r\n                        // Define title of widget\r\n                        data.title = name;\r\n\r\n                        // Set a flag here to tell the search widget that must show the ungroup case from folder (icon).\r\n                        data.casesGroupedByFolder = true;\r\n                        data.idFolder = id;\r\n\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n                            data: data,\r\n                            referrerParams: {}\r\n                        });\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        // Bind for action elements (Edit and delete buttons)\r\n        $(\".addButton\", \"#queries\").click(function(e){\r\n            e.stopPropagation();\r\n            var queriesListDisplay = $(\".queriesListDisplay li\");\r\n            var id = $(this).data(\"id\");\r\n            var idParent = $(this).data(\"idparent\");\r\n            self.makeFolder({\r\n                listElements:queriesListDisplay,\r\n                idParent:id,\r\n                beforeElement:$(this).parent(),\r\n                style:\"newSubFolder\",\r\n                idParentDone:idParent\r\n            });\r\n        });\r\n\r\n        $(\".editButton\", \"#queries\").click(function(e) {\r\n            e.stopPropagation();\r\n            self.editFolder($(this).parent());\r\n        });\r\n\r\n\r\n        $(\".deleteButton\", \"#queries\").click(function(e){\r\n            e.stopPropagation();\r\n\r\n            var content = $.tmpl(confirm);\r\n            var idCustomFolder = $(this).data(\"id\");\r\n            var idParent = $(this).data(\"idparent\");\r\n\r\n            // Open dialog with confirm message\r\n            $(content).dialog({\r\n                resizable: true,\r\n                modal: true,\r\n                title: self.getResource(\"workportal-widget-queries-confirm-title\"),\r\n                buttons: [\r\n                {\r\n                    text: self.getResource(\"workportal-widget-queries-confirm-delete\"),\r\n                    click: function(){\r\n                        self.dataService.deleteFolder({\r\n                            idCustomFolder: idCustomFolder\r\n                        });\r\n\r\n                        $(this).dialog(\"close\");\r\n                        self.renderFolders(idParent);\r\n                    //bizagi.workportal.desktop.popup.closePopupInstance();\r\n                    }\r\n                },\r\n                {\r\n                    text: self.getResource(\"workportal-widget-queries-confirm-cancel\"),\r\n                    click: function(){\r\n                        $(this).dialog(\"close\");\r\n                    }\r\n                }\r\n                ]\r\n            });\r\n        });\r\n\r\n        $(\".addIco\",\"#queries\").click(function(e){\r\n            e.stopPropagation();\r\n            var ico = $(this);\r\n            var parent = ico.parent();\r\n            var idFolder = ico.data(\"id\");\r\n\r\n            ico.addClass(\"wait\");\r\n            // Associate case to folder\r\n            $.when(self.dataService.associateCaseToFolder({\r\n                idCustomFolder: idFolder,\r\n                idCase: self.params.options.idCase\r\n            })).done(function(data){\r\n                if(data.message == \"\"){\r\n                    bizagi.workportal.desktop.popup.closePopupInstance();                    \r\n                }else{\r\n                    // Show error message \r\n                    ico.removeClass(\"wait\");\r\n                    if($(\".errorMessage\",parent).text()== \"\"){\r\n                        parent.append($(\"<div class='errorMessage'></div>\").html(data.message));\r\n                        setTimeout(function(){\r\n                            $(\".errorMessage\",parent).hide('blind','slow',function(){\r\n                                $(this).remove();    \r\n                            });                        \r\n                        }, 5000);\r\n                    }\r\n                }\r\n            })\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Binds the back buttons so we can navigate back\r\n     */\r\n    configureBackButton: function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var btnBack = $(\"#bt-back\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n\r\n        // Bind click\r\n        btnBack.click(function(){\r\n            if($(\"li\", categoryTree).length > 1){\r\n                // Removes last child\r\n                $(\"li:last-child\", categoryTree).remove();\r\n                var idParentQuery = $(\"li:last-child\").children(\"#idParent\").val();\r\n\r\n                // Render Querie again\r\n                self.renderFolders(idParentQuery);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure Edit input field\r\n     * @param options{listElements,idParent,beforeElement,style,idParentDone}\r\n     */\r\n    makeFolder:function(options){\r\n        var self = this;\r\n        var nodeTemplate = options.template || self.getTemplate(\"folders-input-new\");\r\n        options.beforeElement = (options.beforeElement != undefined && options.beforeElement.length >=1)?options.beforeElement:options.listElements;\r\n        var newElement = $.tmpl(nodeTemplate,{\r\n            name: \"\",\r\n            idParent: options.idParent,\r\n            style: options.style\r\n        }).insertAfter((options.beforeElement.length ==1)?options.beforeElement:options.beforeElement.last().prev());\r\n\r\n        // Set focus on input element\r\n        $(\".newInput\",newElement).focus();\r\n        \r\n        // Bind event to checkin botton\r\n        $(\".checkico\",newElement).click(function(){\r\n            var folderName = $(\".newInput\",newElement).val();            \r\n            var parent = $(this).parent();\r\n            \r\n            // Check if folderName already exists   \r\n            $.when(self.checkRepeatFolderName({\r\n                parent:parent,\r\n                options:options,\r\n                folderName: folderName\r\n            })\r\n            ).done(function(result){\r\n                if(result){\r\n                    // Create folder\r\n                    $.when(self.dataService.makeFolder({\r\n                        idParentFolder:options.idParent,\r\n                        folderName: folderName\r\n                    }))\r\n                    .done(function(result){\r\n                        // Update View\r\n                        self.renderFolders(options.idParentDone || options.idParent);\r\n                    });\r\n                }else{\r\n                    // Display notification - folder name already in use\r\n                    parent.append($(\"<div class='errorMessage'></div>\").html(self.getResource(\"workportal-widget-folders-name-repeated\")));\r\n                    setTimeout(function(){\r\n                        $(\".errorMessage\",parent).hide('blind','slow',function(){\r\n                            $(\".errorMessage\",parent).remove();\r\n                        });                \r\n                    },5000);\r\n                }   \r\n            });\r\n        });\r\n        \r\n        $(\".newInput\",newElement).bind(\"keypress\",function(e){\r\n            if(e.keyCode==13){\r\n                $(\".checkico\", newElement).click();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Check if folder name already exist\r\n     */\r\n    checkRepeatFolderName: function(args){\r\n        var def = new $.Deferred();\r\n        var self = this;\r\n        args = args || {};\r\n        var folderNameAvailable = true;\r\n        if(args.parent.hasClass(\"newSubFolder\")){ // Check if new folder in subcategory\r\n            $.when(self.dataService.getFolders(\r\n                args.options.idParent\r\n                )).done(function(data){\r\n                if(data.folders != undefined){\r\n                    $.each(data.folders, function(key,value){                    \r\n                        if(value.name != undefined && args.folderName == value.name){\r\n                            folderNameAvailable = false;    \r\n                            def.resolve(folderNameAvailable);\r\n                        }                    \r\n                    });\r\n                }\r\n                def.resolve(folderNameAvailable);\r\n            });            \r\n        }else{\r\n            // it is principal tree\r\n            $('.queriesListDisplay li')\r\n            .not(':last-child') // Do not include the last item\r\n            .each(function(){\r\n                // Compare each value\r\n                if(args.folderName == $(this).data('name')){\r\n                    // Sorry the name of the folder is already taken\r\n                    folderNameAvailable = false;\r\n                }\r\n            });\r\n            def.resolve(folderNameAvailable);\r\n        }\r\n        //def.resolve(folderNameAvailable);\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Edit folder\r\n     */\r\n    editFolder: function(element){\r\n        var self = this;\r\n        var idParent = $(element).data(\"idparent\");\r\n        var value = $(element).find(\"h3\").html();\r\n        var id = $(element).data(\"id\");\r\n        var nodeTemplate = self.getTemplate(\"folders-input-new\");\r\n\r\n        var newElement = $.tmpl(nodeTemplate,{\r\n            name: value,\r\n            idParent: idParent\r\n        });\r\n\r\n        element.replaceWith(newElement);\r\n\r\n        // Set focus on input element\r\n        $(\".newInput\",newElement).focus();\r\n\r\n        // Bind event to checkin botton\r\n\r\n\r\n        $(\".checkico\",newElement).click(function(){\r\n            var folderName =$(\".newInput\",newElement).val();\r\n\r\n            $.when(self.dataService.updateFolder({\r\n                idFolder:id,\r\n                folderName: folderName\r\n            }))\r\n            .done(function(result){\r\n                // Update View\r\n                self.renderFolders(idParent);\r\n            });\r\n        });\r\n\r\n        $(\".newInput\",newElement).bind(\"keypress\",function(e){\r\n            if(e.keyCode==13){\r\n                $(\".checkico\",newElement).click();\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n     * Bind tree navigation\r\n     */\r\n    configureTreeNavigation:function(idParent){\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n\r\n        // Bind header events\r\n        $(\"li:last-child\", categoryTree).click(function(){\r\n            idParent = idParent || $(this).children(\"#idParent\").val();\r\n\r\n            if(self.params.options.onlyFolderMode && idParent==\"\"){\r\n                self.renderFolders(-1);\r\n            }\r\n            // Remove all elements\r\n            $(this).nextAll().remove();\r\n            // Render query tree again\r\n            self.renderFolders(idParent);\r\n        });\r\n    },\r\n\r\n    scrollVertical:function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        $(\"#queries\",content).bizagiScrollbar({\r\n            \"autohide\":false\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Show new case popup to create a case\r\n     */\r\n    showQueryFormPopup: function(arg){\r\n        var self = this;\r\n\r\n        var idQuery = arg.idQuery || \"\";\r\n        var idStoredQuery = arg.idStoredQuery || \"\";\r\n        var queryFormAction = arg.queryFormAction || \"\";\r\n        var title = arg.title || \"\";\r\n\r\n        // If the same popup is opened close it\r\n        if (self.currentPopup == \"queryform\"){\r\n            bizagi.workportal.desktop.popup.closePopupInstance();\r\n            return;\r\n        }\r\n\r\n        // Shows a popup widget\r\n        self.currentPopup = \"queryform\";\r\n        self.publish(\"showDialogWidget\", {\r\n            widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,\r\n            idQueryForm: idQuery,\r\n            idStoredQuery: idStoredQuery,\r\n            queryFormAction: queryFormAction,\r\n            modalParameters: {\r\n                title: title\r\n            }\r\n        });\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Desktop Smart Folders Widget Controller\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script will provide desktop overrides to implement the smart folder widget\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.smartfolders.extend(\"bizagi.workportal.widgets.smartfolders\", {}, {\r\n\r\n\t/**\r\n\t *   To be overriden in each device to apply layouts\r\n\t */\r\n\tpostRender: function () {\r\n\t\tvar self = this;\r\n\r\n\t\tself.params.options.onlyFolderMode = self.params.options.onlyFolderMode || false;\r\n\r\n\t\t// Set bind event for last element\r\n\t\tself.configureTreeNavigation();\r\n\r\n\t\t// Bind back button\r\n\t\tself.configureBackButton();\r\n\r\n\t\t// Render default folders\r\n\t\t// self.renderDefaultFolders();\r\n\r\n\t\t// Render base categories\r\n\t\tself.renderFolders((self.params.options.onlyFolderMode) ? \"-1\" : \"\");\r\n\r\n\t\t// set vertical scroll\r\n\t\tself.scrollVertical({\r\n\t\t\t\"autohide\": false\r\n\t\t});\r\n\t},\r\n\r\n\trenderDefaultFolders: function () {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar template = self.getTemplate(\"smartfolders-default\");\r\n\t\tvar container = $(\"#queries\", content);\r\n\r\n\t\tcontainer.empty();\r\n\t\t$.tmpl(template).appendTo(container);\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Render List categories for each idCategory\r\n\t */\r\n\trenderFolders: function (id, appendElement) {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar template = (self.params.options.onlyFolderMode != undefined && self.params.options.onlyFolderMode) ? self.getTemplate(\"smartfolders-add-case\") : self.getTemplate(\"smartfolders-elements\");\r\n\t\tvar emptyTemplate = self.getTemplate(\"smartfolders-empty-elements\");\r\n\t\tvar container = $(\"#queries\", content);\r\n\t\tvar queryContent;\r\n\t\tvar mergeData;\r\n\t\tvar mergeNewFolder = {};\r\n\r\n\t\tid = id || \"\";\r\n\r\n\t\t$.when(self.dataService.getSmartFolders(id))\r\n\t\t.done(function (data) {\r\n\r\n\t\t\tcontainer.empty();\r\n\r\n\t\t\t// check if service it has nodes\r\n\t\t\tdata = data || undefined;\r\n\t\t\tvar idParent = \"\";\r\n\t\t\ttry {\r\n\t\t\t\tif (data.folders != undefined && data.folders.length > 0) {\r\n\t\t\t\t\tidParent = data.folders[0][\"idParent\"];\r\n\t\t\t\t}\r\n\t\t\t} catch (e) { }\r\n\r\n\r\n\t\t\tif (data.folders != undefined && data.folders != \"\") {\r\n\t\t\t\t// Check if it has appendElement\r\n\t\t\t\tif (appendElement != undefined) {\r\n\t\t\t\t\tmergeData = {\r\n\t\t\t\t\t\tfolders:\r\n\t\t\t\t\t\t(data != undefined) ? appendElement.concat(data.folders) : appendElement\r\n\t\t\t\t\t};\r\n\t\t\t\t//$.merge({folders:appendElement},data)\r\n\t\t\t\t//$.merge(appendElement, data); //appendElement.concat(data.folders)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmergeData = data;\r\n\t\t\t\t}\r\n\t\t\t\t// Count number of childs\r\n\t\t\t\t$.each(mergeData.folders, function (key, value) {\r\n\t\t\t\t\tif (value != undefined && value.childs.folders != undefined) {\r\n\t\t\t\t\t\tmergeData.folders[key][\"countChilds\"] = mergeData.folders[key][\"childs\"][\"folders\"].length;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmergeData.folders[key][\"countChilds\"] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Append \"new folder\"element\r\n\t\t\t\tif (!self.params.options.onlyFolderMode) {\r\n\t\t\t\t\tmergeNewFolder.folders = mergeData.folders.concat({\r\n\t\t\t\t\t\t\"name\": self.getResource(\"workportal-widget-folders-new\"),\r\n\t\t\t\t\t\t\"id\": 'newFolder',\r\n\t\t\t\t\t\t\"idParent\": idParent,\r\n\t\t\t\t\t\t\"childs\": [],\r\n\t\t\t\t\t\t\"categoryWithLink\": \"true\",\r\n\t\t\t\t\t\t\"countChilds\": 0\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmergeNewFolder = mergeData;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tqueryContent = $.tmpl(template, mergeNewFolder);\r\n\t\t\t} else if (!self.params.options.onlyFolderMode) {\r\n\t\t\t\t//Don't have results\r\n\t\t\t\tmergeNewFolder.folders = [{\r\n\t\t\t\t\t\"name\": self.getResource(\"workportal-widget-folders-new\"),\r\n\t\t\t\t\t\"id\": 'newFolder',\r\n\t\t\t\t\t\"idParent\": idParent,\r\n\t\t\t\t\t\"childs\": [],\r\n\t\t\t\t\t\"categoryWithLink\": \"true\",\r\n\t\t\t\t\t\"countChilds\": 0\r\n\t\t\t\t}];\r\n\t\t\t\tqueryContent = $.tmpl(template, mergeNewFolder);\r\n\t\t\t} else {\r\n\t\t\t\tqueryContent = $.tmpl(emptyTemplate);\r\n\t\t\t}\r\n\t\t\tqueryContent.appendTo(container);\r\n\r\n\t\t\t// set actions to rendered html\r\n\t\t\tself.configureNavTree();\r\n\t\t});\r\n\t},\r\n\r\n\r\n\tconfigureNavTree: function () {\r\n\t\tvar self = this;\r\n\t\tvar confirm = self.getTemplate(\"smartfolders-query-confirm\");\r\n\r\n\t\t// Bind for list elements\r\n\t\t$(\"li\", \"#queries\").click(function (e) {\r\n\t\t\te.stopPropagation();\r\n\t\t\tvar id = $(this).data(\"id\");\r\n\t\t\tvar countChilds = $(this).data(\"childslength\");\r\n\t\t\tvar name = $(this).data(\"name\");\r\n\t\t\tvar urlParameters = $(this).data(\"urlparameters\");\r\n\t\t\tvar idParent = $(this).data(\"idparent\");\r\n\r\n\t\t\t//            var categoryTree = $(\"#categoryTree\");\r\n\t\t\tvar queriesListDisplay = $(\".queriesListDisplay li\");\r\n\r\n\t\t\t// Config inbox view\r\n\t\t\tif (countChilds == 0 && self.params.options.onlyFolderMode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// If the node is base folder\r\n\t\t\tif (id == \"-1\") {\r\n\t\t\t\t// Is category\t\t\r\n\r\n\t\t\t\t// Set bind event for last element\r\n\t\t\t\tself.configureTreeNavigation(idParent);\r\n\r\n\t\t\t\t// Render sub-categories\r\n\t\t\t\tself.renderFolders(id);\r\n\t\t\t} else if (id == \"newFolder\") {\r\n\t\t\t\t// Create new folder\r\n\t\t\t\tself.makeFolder({\r\n\t\t\t\t\tlistElements: queriesListDisplay,\r\n\t\t\t\t\tidParent: idParent\r\n\t\t\t\t});\r\n\r\n\t\t\t} else if (countChilds > 0) {\r\n\t\t\t\t// Is category with link\r\n\r\n\r\n\t\t\t\t// Set bind event for last element\r\n\t\t\t\tself.configureTreeNavigation(idParent);\r\n\r\n\t\t\t\t// Apend this object to children\r\n\t\t\t\tself.renderFolders(id,\r\n\t\t\t\t\t(self.params.options.onlyFolderMode) ? [] :\r\n\t\t\t\t\t[{\r\n\t\t\t\t\t\t\"name\": name,\r\n\t\t\t\t\t\t\"id\": id,\r\n\t\t\t\t\t\t\"idParent\": '',\r\n\t\t\t\t\t\t\"childs\": [],\r\n\t\t\t\t\t\t\"categoryWithLink\": true,\r\n\t\t\t\t\t\t\"urlParameters\": urlParameters\r\n\t\t\t\t\t}]\r\n\t\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\t// Is Process\r\n\t\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\t\tif (countChilds == 0 && urlParameters) {\r\n\t\t\t\t\tif(bizagi.override.viewSmartFoldersAsSearch){\r\n\t\t\t\t\t\t$.when(\r\n\t\t\t\t\t\t\tself.dataService.getCustomizedColumnsData({\r\n\t\t\t\t\t\t\t\tsmartfoldersParameters: urlParameters\r\n\t\t\t\t\t\t\t}))\t\t\t\t\t\r\n\t\t\t\t\t\t.done(function (data) {\r\n\t\t\t\t\t\t\tbizagi.lstIdCases = data.lstIdCases;\r\n\t\t\t\t\t\t\t// Define radnumber for render actions bottons\r\n\t\t\t\t\t\t\tbizagi.referrerParams = bizagi.referrerParams || {};\r\n\t\t\t\t\t\t\tbizagi.referrerParams.radNumber = \"\"; //params.radNumber;\r\n\t\t\t\t\t\t\tbizagi.referrerParams.page = \"\"; //params.page;\r\n\t\t\t\t\t\t\tbizagi.referrerParams.referrer = \"folders\";\r\n\t\t\t\t\t\t\tbizagi.referrerParams.urlParameters = urlParameters;\r\n\t\t\t\t\t\t\tbizagi.referrerParams.name = name;\r\n\t\t\t\t\t\t\tbizagi.referrerParams.id = id;\r\n\r\n\t\t\t\t\t\t\t// Define widget customized for pagination purposes\r\n\t\t\t\t\t\t\tdata.customized = true;\r\n\t\t\t\t\t\t\tdata.urlParameters = urlParameters;\r\n\r\n\t\t\t\t\t\t\t// Define title of widget\r\n\t\t\t\t\t\t\tdata.title = name;\r\n\r\n\t\t\t\t\t\t\t// Set a flag here to tell the search widget that must show the ungroup case from folder (icon).\r\n\t\t\t\t\t\t\tdata.casesGroupedByFolder = true;\r\n\t\t\t\t\t\t\tdata.idFolder = id;\r\n\r\n\t\t\t\t\t\t\tself.publish(\"changeWidget\", {\r\n\t\t\t\t\t\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n\t\t\t\t\t\t\t\tdata: data,\r\n\t\t\t\t\t\t\t\treferrerParams: {}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tbizagi.referrerParams = bizagi.referrerParams || {};\r\n\t\t\t\t\t\tvar widgetRedirect;\r\n\t\t\t\t\t\tif(self.params.options.foldersView == 'inboxgrid'){\r\n\t\t\t\t\t\t\twidgetRedirect = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID;\r\n\t\t\t\t\t\t\tbizagi.referrerParams = {\r\n\t\t\t\t\t\t\t\turlParameters : urlParameters,\r\n\t\t\t\t\t\t\t\treferrer: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\twidgetRedirect = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX;\r\n\t\t\t\t\t\t\tbizagi.referrerParams = {\r\n\t\t\t\t\t\t\t\turlParameters : urlParameters,\r\n\t\t\t\t\t\t\t\treferrer: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tself.publish(\"changeWidget\", {\r\n\t\t\t\t\t\t\twidgetName: widgetRedirect,\r\n\t\t\t\t\t\t\tsmartfoldersParameters: {\r\n\t\t\t\t\t\t\t\turlParameters : urlParameters\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\treferrerParams: {}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\r\n\t\t// Bind for action elements (Edit and delete buttons)\r\n        \r\n\t\t$(\".editButton\", \"#queries\").click(function (e) {\r\n\t\t\te.stopPropagation();\r\n\t\t\tself.editFolder($(this).parent());\r\n\t\t});\r\n\r\n\r\n\t\t$(\".deleteButton\", \"#queries\").click(function (e) {\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tvar content = $.tmpl(confirm);\r\n\t\t\tvar idSmartFolder = $(this).data(\"id\");\r\n\t\t\tvar idParent = $(this).data(\"idparent\");\r\n\r\n\t\t\t// Open dialog with confirm message\r\n\t\t\t$(content).dialog({\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tmodal: true,\r\n\t\t\t\ttitle: self.getResource(\"workportal-widget-queries-confirm-title\"),\r\n\t\t\t\tbuttons: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: self.getResource(\"workportal-widget-queries-confirm-delete\"),\r\n\t\t\t\t\tclick: function () {\t\t\t\t\t\t\r\n\t\t\t\t\t\tself.dataService.deleteSmartFolder({\r\n\t\t\t\t\t\t\tidSmartFolder: idSmartFolder,\r\n\t\t\t\t\t\t\tidUser: bizagi.currentUser.idUser || 0\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\tself.renderFolders(idParent);\r\n\t\t\t\t\t//bizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: self.getResource(\"workportal-widget-queries-confirm-cancel\"),\r\n\t\t\t\t\tclick: function () {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t},\r\n\r\n\t/**\r\n *   Binds the back buttons so we can navigate back\r\n */\r\n\tconfigureBackButton: function () {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar btnBack = $(\"#bt-back\", content);\r\n\t\tvar categoryTree = $(\"#categoryTree\", content);\r\n\r\n\t\t// Bind click\r\n\t\tbtnBack.click(function () {\r\n\t\t\tif ($(\"li\", categoryTree).length > 1) {\r\n\t\t\t\t// Removes last child\r\n\t\t\t\t$(\"li:last-child\", categoryTree).remove();\r\n\t\t\t\tvar idParentQuery = $(\"li:last-child\").children(\"#idParent\").val();\r\n\r\n\t\t\t\t// Render Querie again\r\n\t\t\t\tself.renderFolders(idParentQuery);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n * Configure Edit input field\r\n */\r\n\tmakeFolder: function () {\r\n\t\tvar self = this;\r\n\t\tvar url =self.dataService.getUrl({\r\n\t\t\tendPoint:\"smartfolders-integration\"\r\n\t\t})+\"?ParentQueryId=-1\";\r\n\t\t\t\t\t\r\n\t\tself.publish(\"showDialogWidget\", {\r\n\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n\t\t\twidgetURL: url,\r\n\t\t\tmodalParameters: {\r\n\t\t\t\ttitle: self.getResource(\"workportal-widget-folders-new\"),\r\n\t\t\t\twidth:\"1020px\"\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t},\r\n\r\n\t\r\n\t/**\r\n * Edit folder\r\n */\r\n\teditFolder: function (element) {\r\n\t\tvar self = this;\r\n\t\tvar value = $(element).find(\"h3\").html();\r\n\t\tvar id = $(element).data(\"id\");\r\n\t\tvar url =self.dataService.getUrl({\r\n\t\t\tendPoint:\"smartfolders-integration\"\r\n\t\t})+\"?iQueryFormId=\"+id;\r\n\r\n\t\tself.publish(\"showDialogWidget\", {\r\n\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n\t\t\twidgetURL: url,\r\n\t\t\tmodalParameters: {\r\n\t\t\t\ttitle: value,\r\n\t\t\t\twidth:\"1020px\"\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\r\n\t/**\r\n * Bind tree navigation\r\n */\r\n\tconfigureTreeNavigation: function (idParent) {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar categoryTree = $(\"#categoryTree\", content);\r\n\r\n\t\t// Bind header events\r\n\t\t$(\"li:last-child\", categoryTree).click(function () {\r\n\t\t\tidParent = idParent || $(this).children(\"#idParent\").val();\r\n\r\n\t\t\tif (self.params.options.onlyFolderMode && idParent == \"\") {\r\n\t\t\t\tself.renderFolders(-1);\r\n\t\t\t}\r\n\t\t\t// Remove all elements\r\n\t\t\t$(this).nextAll().remove();\r\n\t\t\t// Render query tree again\r\n\t\t\tself.renderFolders(idParent);\r\n\t\t});\r\n\t},\r\n\r\n\tscrollVertical: function () {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\r\n\t\t$(\"#queries\", content).bizagiScrollbar({\r\n\t\t\t\"autohide\": false\r\n\t\t});\r\n\t}\r\n    \r\n});\r\n"]}