{"version":3,"sources":["jquery/rendering/js/services/bizagi.render.services.endPoints.js","jquery/rendering/js/services/bizagi.render.services.context.js","jquery/rendering/js/services/bizagi.render.services.service.js","jquery/rendering/js/services/bizagi.render.services.multiactionservice.js","jquery/rendering/js/services/bizagi.render.services.metadataMultiactionservice.js","jquery/rendering/js/base/command/bizagi.command.controllers.controller.js","jquery/rendering/js/base/command/bizagi.command.controllers.validation.js","jquery/rendering/js/base/command/bizagi.command.controllers.action.js","jquery/rendering/js/base/bizagi.rendering.element.js","jquery/rendering/js/base/container/bizagi.rendering.container.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.container.js","jquery/rendering/js/base/container/bizagi.rendering.form.js","jquery/rendering/js/base/container/bizagi.rendering.formTemplate.js","jquery/rendering/js/base/container/bizagi.rendering.layout.js","jquery/rendering/js/base/container/bizagi.rendering.accordion.js","jquery/rendering/js/base/container/bizagi.rendering.accordionItem.js","jquery/rendering/js/base/container/bizagi.rendering.group.js","jquery/rendering/js/base/container/bizagi.rendering.horizontal.js","jquery/rendering/js/base/container/bizagi.rendering.panel.js","jquery/rendering/js/base/container/bizagi.rendering.contentPanel.js","jquery/rendering/js/base/container/bizagi.rendering.searchForm.js","jquery/rendering/js/base/container/bizagi.rendering.tab.js","jquery/rendering/js/base/container/bizagi.rendering.tabItem.js","jquery/rendering/js/base/render/bizagi.rendering.render.js","jquery/rendering/js/base/render/bizagi.rendering.render.base.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.render.js","jquery/rendering/js/base/render/bizagi.rendering.combo.js","jquery/rendering/js/base/render/bizagi.rendering.collectionnavigator.js","jquery/rendering/js/base/render/bizagi.rendering.check.js","jquery/rendering/js/base/render/bizagi.rendering.number.js","jquery/rendering/js/base/render/bizagi.rendering.numberScientificNotation.js","jquery/rendering/js/base/render/bizagi.rendering.date.js","jquery/rendering/js/base/render/bizagi.rendering.extendedText.js","jquery/rendering/js/base/render/bizagi.rendering.grid.js","jquery/rendering/js/base/render/bizagi.rendering.hidden.js","jquery/rendering/js/base/render/bizagi.rendering.label.js","jquery/rendering/js/base/render/bizagi.rendering.search.js","jquery/rendering/js/base/render/bizagi.rendering.text.js","jquery/rendering/js/base/render/bizagi.rendering.button.js","jquery/rendering/js/base/render/bizagi.rendering.fileprint.js","jquery/rendering/js/base/render/bizagi.rendering.link.js","jquery/rendering/js/base/render/bizagi.rendering.checkList.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.render.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.image.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.link.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.label.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.text.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.upload.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.boolean.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.dateTime.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.number.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.money.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.placeholder.js","jquery/rendering/js/base/render/bizagi.rendering.geolocation.js","jquery/rendering/js/base/render/bizagi.rendering.upload.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.upload.js","jquery/rendering/js/base/render/bizagi.rendering.ecm.js","jquery/rendering/js/base/render/bizagi.rendering.yesno.js","jquery/rendering/js/base/render/bizagi.rendering.letter.js","jquery/rendering/js/base/render/bizagi.rendering.formLink.js","jquery/rendering/js/base/render/bizagi.rendering.document.js","jquery/rendering/js/base/render/bizagi.rendering.cascadingCombo.js","jquery/rendering/js/base/render/bizagi.rendering.list.js","jquery/rendering/js/base/render/bizagi.rendering.multiSelect.js","jquery/rendering/js/base/render/bizagi.rendering.money.js","jquery/rendering/js/base/render/bizagi.rendering.radio.js","jquery/rendering/js/base/render/bizagi.rendering.searchList.js","jquery/rendering/js/base/render/bizagi.rendering.userfield.js","jquery/rendering/js/base/render/bizagi.rendering.image.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.column.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.readonly.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.document.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.letter.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.column.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.combo.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.search.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.date.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.form.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.startForm.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.search.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.searchUser.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.letter.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.form.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.panel.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.contentPanel.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.nestedForm.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.tab.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.tabItem.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.horizontal.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.layout.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.accordion.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.accordionItem.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.group.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.searchForm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.text.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.extendedText.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.label.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryLabel.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.number.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryNumber.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.date.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryDate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.yesno.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.check.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.combo.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.cascadingCombo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCombo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCascadingCombo.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.collectionnavigator.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.ecm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.grid.bizagi.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.grid.grouped.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.search.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.letter.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.button.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.fileprint.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.link.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.render.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.placeholder.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.boolean.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.image.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.link.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.label.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.text.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.dateTime.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.number.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.money.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.upload.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.formLink.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.geolocation.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.hidden.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.money.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryMoney.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.radio.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryRadio.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryState.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCaseState.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryGrid.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.list.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.multiSelect.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryList.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryMultiSelect.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.userfield.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.document.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.image.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.combo.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.document.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.letter.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.search.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.date.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.text.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.searchList.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.number.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.numberScientificNotation.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.upload.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.radio.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.list.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.image.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.uploadecm.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.link.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.button.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.actions.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.exclusiveCheck.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.readonly.js","jquery/rendering/js/base/bizagi.rendering.base.factory.js","jquery/rendering/js/desktop/bizagi.rendering.desktop.factory.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.searchList.js","jquery/rendering/js/base/render/bizagi.rendering.association.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.association.js","jquery/rendering/js/base/render/bizagi.rendering.getUser.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.getUser.js","jquery/rendering/js/base/render/bizagi.rendering.queryProcess.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryProcess.js","jquery/rendering/js/base/render/bizagi.rendering.querySearchUser.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySearchUser.js","jquery/rendering/js/bizagi.rendering.device.factory.js","jquery/rendering/js/bizagi.rendering.facade.js","jquery/workportal/js/base/command/bizagi.workportal.command.printform.js","jquery/common/bizagi.internals/bizagi.rendering.desktop.overrides.js","jquery/common/bizagi/js/services/bizagi.dom.mildware.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySuggest.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryExtendedText.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryText.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCheck.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryYesNo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySearch.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.queryForm.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.formTemplate.js","jquery/rendering/js/base/render/bizagi.rendering.comboSelected.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.comboSelected.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.usersForm.js","jquery/rendering/js/base/render/bizagi.rendering.userPassword.js","jquery/rendering/js/base/render/bizagi.rendering.stakeholder.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.stakeholder.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.userPassword.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.gridActions.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.numberScientificNotation.js","jquery/rendering/js/base/render/bizagi.rendering.actionLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.range.js","jquery/rendering/js/base/render/bizagi.rendering.rangeDate.js","jquery/rendering/js/base/render/bizagi.rendering.rangeMoney.js","jquery/rendering/js/base/render/bizagi.rendering.rangeNumber.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.actionLauncher.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.range.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeDate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeMoney.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeNumber.js","jquery/rendering/js/base/render/bizagi.rendering.entityTemplate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.entityTemplate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.checkList.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.activityCheckList.js","jquery/rendering/js/base/render/bizagi.rendering.polymorphicLauncher.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.polymorphicLauncher.js"],"names":["bizagi","render","services","endPoints","getEndPoints","params","renderHandlerPathRest","renderUploadHandlerPathRest","renderFileHandlerPathRest","letterHandlerPathRest","multiActionHandlerPathRest","metadataHandlerPathRest","context","form-get-data","proxyPrefix","form-submit-data","form-submit-data-upload","render-property-refresh","render-multiaction","render-upload-cancel-image","render-upload-data-url","render-upload-add-url","render-upload-delete-url","render-ecm-upload-url","render-multiaction-metadata","render-grid-edit-url","render-grid-save-url","render-grid-add-url","render-grid-rollback-url","render-grid-commit-url","render-grid-checkpoint-url","render-save-entity","render-stakeholder-associated","render-search-default-image","render-search-form-get-data","render-search-advanced-url","render-letter-notEditable-url","render-letter-content-url","render-letter-save-url","render-letter-content-icons","render-userfield-definition","render-document-generate","render-document-generateAllDocuments","render-processes-startform","render-processes-getstartform","render-entity-layout-image64","render-entity-layout-imageByteArray","getXSRFToken","render-entity-layout-upload-files","case-handler-getCaseSummary","case-handler-getCaseSummaryByGuid","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getWorkItemsByGuid","admin-getUsersList","admin-getUsersList-FromPreferences","admin-getUsersList-ForStakeholders","admin-getUsersForAssignation","admin-users-config","admin-usersform","admin-GenerateDataToSendByEmail","admin-sendUserEmail","alert","sharepointProxyPrefix","$","Class","extend","init","this","util","isEmpty","getUrl","service","setProxyPrefix","BA_ACTION_PARAMETER_PREFIX","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","serviceLocator","multiactionService","multiactionservice","guid","Math","override","enableECMMetadataMultiaction","multiactionMetadataService","metadatamultiactionservice","userfieldRequests","deviceType","isSmartphoneDevice","deviceEnum","smartphone","isTabletDevice","tablet","desktop","deviceCode","getDeviceCode","multiaction","metadataECMMultiaction","getFormData","self","data","action","idProcess","idForm","idEntity","surrogateKey","idRender","xpathContext","requestedForm","recordXPath","summaryForm","idCase","idWorkitem","idTask","idPageCache","contextType","guidEntity","isRefresh","isActionStartForm","additionalXpaths","idStartScope","readOnlyForm","printversion","recordXpath","downloadOfflineForm","editable","BA_ALL_PARAMETER_PREFIX","prepare","chrono","initAndStart","ajax","url","type","dataType","serviceType","pipe","response","stopAndLog","form","properties","transformGridDataToReadOnly","_data","hasOwnProperty","id","allowAdd","allowDelete","allowEdit","allowGrouping","allowMore","allowSearch","each","key","value","e","getSearchFormData","xpath","idSearchForm","processDataValues","o","submitData","resolveData","contexttype","transitions","surrogatekey","forcePlanCompletion","actionType","toString","toUpperCase","debug","name","newName","isEmptyObject","search","substr","getPropertyData","extra","property","sessionId","guidentity","pxpath","prows","ppage","undefined","pfilter","psort","porder","pcaseId","pguidEntity","psurrogatedKey","pactionXpath","ptemplateGuid","pparameters","beforeSend","xhr","status","multiactionConnection","push","getData","getSearchData","term","getCollapseData","collapseState","getGridData","sort","order","page","rows","searchFilter","getGridDataExclusivesSelected","xpathfilter","getUploadCancelImage","pathToBase","getUploadFileUrl","fileId","verifyPathToBase","jQuery","param","getUploadFileEntityUrl","isContextContainerWidgetRender","xpathActions","getUploadAddUrl","getUploadAddFileUrl","isUserPreferences","deleteImage","deleteUploadFile","getECMMetadata","idFileUpload","xPath","idAttrib","interceptor","intercept","source","checkOutFile","cancelCheckOut","deleteECMFile","updateECMFileContent","metaValues","updateECMMetadata","getFileProperties","uploadECMFile","fileUpload","fileName","getECMFileUrl","p_sessionId","isFileOnECM","idUpload","read","editGridRecord","addGridRecord","addGridRecordData","saveGridRecord","disableServerGridValidations","deleteGridRecord","getFlipAssociation","flipstate","parseJSON","rollbackGridAction","getSearchDefaultImage","processDataCriteria","criteria","submitSearch","JSON","encode","allowFullSearch","maxRecords","associateStakeholder","associatedUser","refreshAssociateStakeholder","getLetterNotEditableUrl","getLetterContent","getCanGenerateLetter","saveLetterContent","content","fullUrl","getLetterEditorIconsPath","executeButton","getFilePrintUrl","disposition","editLinkForm","saveLinkForm","rollbackLinkForm","commitLinkForm","commitGridAction","sendCheckpoint","sendCheckpointAction","getUserfieldDefinition","userfield","guidUserfield","device","refreshControl","refreshGridCell","column","typeRender","executeRule","rule","create","executeInterface","interface","executeSAPConnector","guidsap","executeConnector","guidConnector","generateDocumentTemplate","append","h_pageCacheId","contextXpath","xpathcontext","groupMappingId","groupMapping","xpathAttribute","controlId","getAllDocumentsDownloadUrl","idWorkItem","getCaseNumber","replace","isMobile","getCaseAssignees","getWorkitems","onlyUserWorkItems","getGridExportUrl","exportType","sendEmail","to","subject","message","selected","invalidatePageCache","getUsersList","getUsersListFromPreferences","getUsersListForStakeholders","getUsersForAssignation","getUsersForm","generateDataToSendByEmail","idUser","password","sendUserEmail","eMailTo","body","getConfiguration","indexOf","getTemplate","forcePersonalizedColumns","templateType","templateGuid","isDefaultTemplate","detectDevice","hasStartForm","guidWFClass","getStartForm","guidprocess","surrogatedKey","mappingstakeholders","cache","editActionForm","getActions","extendParams","ptags","pmaxitems","executeActions","pguidConstructor","pguidAction","getPolymorphicActions","serializePolymorphicActions","values","actions","getParents","node","parents","fillTree","list","children","child","displayName","hasConstructor","guidObject","guidConstructor","length","getEntityImage64","width","height","entity","getFilesDataForLayoutUploadControl","processUploadFile","verifyMobilePathToBase","formData","contentType","processData","isSharepointContext","replaceAll","batch","batchTimer","circularDependencies","replicateServiceMethods","getService","prototype","eval","proxyMethod","method","arguments","apply","add","makeCircularDependenciesError","error","messageTmpl","localization","getResource","printf","dependencyFrom","dependencyTo","deferred","Deferred","h_action","detectCircularDependencies","addNode","clearTimeout","batchTimeout","tag","singleAction","setTimeout","resolveDependencies","resolve","i","multiactionError","reject","fire","promise","item","when","execute","rejectDeferreds","done","responses","result","fail","errorMessage","finalResponse","responseText","parse","THROW_ERROR","dateFormat","buildConditions","conditions","bGridDetected","bCheckEditability","operator","expressions","buildConditionOperator","sJsCondition","expression","simple","bGDetected","searchGridReferenceInCondition","buildSimpleCondition","complex","conditionsOperator","condition","sXpath","sArgument","ensureValueJs","ensureEditable","control","renderId","detectedArgumentType","detectConditionArgumentType","argumentType","buildXpath","boolean","argument","buildArgument","getRender","getRenderById","Error","gridXpath","processGridXpath","remainingXpath","getColumn","renderType","normalizeType","isRelatedEntityRender","showTime","includes","test","number","toLowerCase","Number","NaN","date","dateFormatter","getDateFromInvariant","Date","setHours","formatInvariant","setSeconds","setMilliseconds","stringify","isEditable","showRenderNotFoundError","isVisible","visible","isParentVisible","parent","evalGridXpath","evalXpath","grid","gridColumn","cellValue","getCellCurrentValue","index","display","renderToEval","renders","getRenders","rendersToEval","bIsGrid","getValue","isFileUploaded","isValidEmail","match","RegExp","isButtonPressed","pressed","isGridButtonPressed","arrGridXpath","columns","isChanged","grep","onDeletedGridRow","rowDeleted","idMatches","exec","showContainerNotFoundError","containerId","getCurrentDate","currentDate","matches","searchForGridReference","commands","command","searchForGridReferenceInCommand","substring","bGridReferenceFound","searchGridReferenceInXpath","getGridControl","getControlCell","controllers","controller","validations","mainForm","enableDebug","_super","container","validationBox","appendTo","widget","ui","bizagi_notifications","expand","triggerGlobalHandler","collapse","hide","itemIcon","minimized","clearEnabled","title","orientation","bind","onNotificationClick","buildValidations","fnValidations","buildAllValidations","showErrorMessage","showErrorAlertDialog","showValidationMessage","showAlertMessage","showInfoMessage","focus","icon","itemAdditionalClass","performValidationFn","clearValidationMessages","validating","performValidations","countValidationMessages","hideValidationMessages","setValidationMessage","isIE8","one","not","showValidationMessages","expandNotificationBox","autofocus","isExpandedNotificationBox","invalidElements","bRendersValid","validateRenders","bFormValid","triggerHandler","sJSCode","enabled","buildValidation","validationCommand","logError","sStatement","evalValidation","sJsValidation","gridReference","tokens","sGridStatement","bValid","isValid","forEach","element","showValidationMessageById","console","log","globalDependencies","initialCallFunctions","initialCallFunctionsDeferred","buildActions","internalSubmitActions","initialCallTimeout","initialCallIncrements","actionsHistory","period","processInternalSubmitAction","buildAction","isSummaryOrGlobalForm","typeForm","evalClientAction","serverCommand","concat","elseCommands","isClientAction","dontExecute","len","hashes","executeOnlyClientActions","hash","md5","hashC","unbindActions","unbind","handle","refreshActions","newActions","_","dependencies","dependenciesId","j","dependencyAlreadyAdded","renderById","inArray","fn","buildFunction","ev","args","changed","gridColumns","searchGridColumns","sJsAction","sJsElseAction","bAutomaticRestore","bCondition","queueAction","isServerCommand","buildCommand","buildRestoreCommand","elseCommand","commandType","isRecentAction","prefix","runAction","detectCommandArgumentType","controlType","parseBoolean","ruleObj","guidRule","xpathContextRow","interfaceObj","guidInterface","connectorObj","restoreRender","originalProperties","textFormat","changeRenderBackground","background","changeRenderForeground","color","changeRenderVisibility","changeRenderEditability","changeRenderRequired","required","restoreContainer","getContainer","changeContainerBackground","backgroundColor","changeContainerVisibility","toogleContainer","changeContainerEditability","isGridComponent","ready","lenIndex","indexes","getIndexes","changeCellBackgroundColor","changeBackgroundColor","changeButtonBackground","getButton","css","addClass","style","setProperty","changeCellColor","changeColor","changeButtonForeground","changeCellVisibility","renderingDeferred","changeVisibility","changeButtonVisibility","show","isValidRender","changeCellEditability","changeEditability","changeButtonEditability","removeAttr","attr","triggerClick","trigger","changeCellRequired","changeRequired","changeRenderValue","fromAction","changeCellValue","asyncRenderDeferred","setDisplayValue","changeRenderMinValue","changeCellMinValue","changeMinValue","changeRenderMaxValue","changeCellMaxValue","changeMaxValue","executeCalculatedField","runFormula","queue","bizagiQueue","refreshContainer","def","map","internalQueue","addParallel","refreshCell","submitFormData","submitRender","submitOnChange","cleanRenderData","cleanCellData","cleanData","changeActiveItem","loadingDeferred","setAsActiveContainer","changeFormButtonVisibility","buttons","findIndex","navigation","getNavigation","setNavigationButtons","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","ELEMENT_TYPE_COLUMN","renderFactory","dataService","resources","observableElement","disposed","initializeData","subscribers","getXpathContext","getPageCache","getFormContainer","getElementType","resize","size","layout","isScrolledIntoView","effect","eventType","event","getRenderedElement","getMode","getParams","getFormType","isReadyToSave","getCustomHandlers","dispose","off","disposeTime","isDisposed","processFailMessage","isOfflineForm","errorType","validationController","code","startLoading","endLoading","beforeToRefresh","afterToRefresh","rendering","TYPE_QUERY_FORM","uniqueId","ceil","random","childrenHash","elements","createRenderElement","createContainerElement","createFormElement","originalElement","inlineEdit","retype","clone","mode","processDuplicateRender","registerRender","isDesign","getElement","getElementsByType","clonedElement","isClone","cloneRender","internalRender","applyContainerDefaults","html","renderContainerHtml","postRenderContainer","renderContainer","isRendered","replaceTag","replaceSelector","replaceChildrenTag","replaceChildrenHtml","executeChildrenPostRender","configureHandlers","applyPlaceHolderPolyfill","configureDesignView","configureLayoutView","config","window","placeHolderConfig","forceApply","Placeholders","enable","childrenElements","childElement","postRenderElement","renderChildrenHtml","temp","renderElement","collectRenderValues","renderValues","canBeSent","collectData","hasChanged","collectRenderValuesQueryForm","canBeSentQueryForm","collectDataQueryForm","firstChild","getRendersByXpath","hasValidGrids","childrenPromises","getFocus","getCustomHandler","customHandlers","unregisterChildren","removeActions","currentContainer","replaceWith","triggerChildrenActions","always","refreshDesignContainer","messageValidation","l","triggerRenderChange","registerActions","actionController","unregisterRender","replaceChild","splice","getChildById","containsGrid","countByRenderType","delay","overlay","counter","countByRenderTypeWithParams","getChildrenSumHeight","excludeElement","containerHeight","renderHeight","getChildreCount","rendersById","rendersByXpath","rendersByType","pageCacheId","displayAsReadOnly","userConfirmationMessage","hasRule","paramsRender","processPath","breadCrumb","split","allowValidateAndSaveAction","enableActionValidateAndSave","initializeButtons","originalProcessButton","processButton","isRoutingDisabled","applicationParent","isOfflineFormsV2Supported","isMobileDevice","button","caption","ordinal","next","nextWithoutValidations","cancel","back","createnewcase","validate","save","routing","refresh","buildButtonStyle","useCustomButtons","unshift","setParam","isArray","listRendesByType","getRenderByType","listRendesByTypeLength","renderKey","listRender","getGridByColumn","grids","columnsIds","template","fasttmpl","helptext","helpText","queryForm","globalForm","complexGatewayContainer","hasClass","activeTransitions","processButtons","validation","readyDeferred","find","checkboxLabel","transitionId","removeClass","format","newFontSize","bold","isIE","italic","underline","strikethru","strStyle","getContextType","getEndPointAction","formtype","getButtons","on","preventDefault","stopImmediatePropagation","buttonProperties","lastActionButton","routingDisabled","prop","propagateExternalEvents","processDefer","contains","document","documentElement","get","preProcessButton","postProcessButton","setLoaderDeferred","loaderDeferred","deleteLoaderDeferred","isLoaderDeferredSet","useOrSetLoaderDeferred","getLoaderPromise","appendWaitForLoader","then","defer","getAllTabs","getAllTabsLength","innerTabsLoading","needsUserConfirmation","showConfirmationBox","submitForm","customHandler","validateForm","saveForm","collectRenderValuesForSubmit","deferredsToWait","deferreds","internalSubmitFormOffline","internalSubmitForm","checkWidgetsData","isComplexGatewayPainted","getLastActionButton","countProps","showMessageBox","offlineType","waitForOnlineResponse","online","tryPushResponsePromise","responsePromise","IdCase","caseNumber","CaseNumber","failHandler","offlineAction","isValidResource","showNotification","text","animate","scrollTop","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","waitingDeferreds","prepareCheckpointAction","prepareCommitAction","getButtonAction","flowControlDeferred","bHasValidations","stop","alertMessage","propertiesToDisplayMessages","validationToDisplayMessages","messages","modalError","sendRollbackAction","refreshForm","jqxhrList","abortAll","messageType","addValidationMessage","validationMessage","addErrorMessage","options","selectedTabs","getSelectedTabs","tabContainers","tabs","tabContainer","tab","activeTab","addSubmitAction","waitingTemplate","waitingOverlay","waitingMessage","tmpl","isSharePoint","canvas","getSize","position","getOffset","top","min-height","min-width","outerHeight","left","outerWidth","remove","getFocusedElement","setFocusedElement","errorJson","setSize","offset","updateOriginalValue","clearOnlyServer","join","internalSubmitOnChange","bRefreshForm","notCollect","cancelPreviousRequest","focusIdentifier","idCaseObject","IdScope","objMessage","strMessage","connection","pop","abort","buttonId","checkpointUrl","commitUrl","rollbackUrl","getFloatingButton","evt","click","contextEvent","processTemplate","controls","processedTemplate","g1","g2","string","parameters","layoutCollection","getCss","layoutGuid","layoutguid","loadStyle","getContextEvent","stripslashes","activate","active","cssclass","expandedIcon","getExpandedIcon","collapsedIcon","getCollapsedIcon","expandedClassIcon","bImmediate","loading","cssClass","panel","renderResult","performSearch","searchParams","refreshResults","getRemoteData","collectSearchValues","isMapEmpty","maxRows","dataUrl","records","totalPages","deviceMaxRecordsExceeded","onSearchFinished","errorObject","submitArray","operation","getCriteriaOperation","criteriaData","typeSearch","parseAdditionalProperties","tabItems","tooltip","tabOrientation","getActiveTab","loadOnDemand","formParams","containsFocusedElement","setActiveTab","selectedTab","renderTabContent","postRenderTimeout","maxRendersPerScreen","rendersExecuted","renderOptimization","startOptimization","stopOptimization","included","includedInResult","maxLength","trim","valueFormat","isHidden","labelAlign","valueAlign","originalValue","previousValue","calculateInitialLayoutProperties","displayType","getDefaultLabelAlign","getDefaultValueAlign","getRTLAlign","renderWidth","calculateRenderWidth","labelWidth","valueWidth","label","layoutType","renderTemplateName","renderTemplate","isFullRender","parseFloat","isExtendedText","isExtended","displayOptionClass","getDisplayOptionClass","labelAlignClass","getAlignClass","valueAlignClass","stringLabelWidth","stringValueWidth","printVersion","showFullRender","internalRenderControl","state","replaceControlHtml","resolveResult","renderControl","renderReadOnly","configureSubmitOnChange","isLabelFormat","executePostRender","_element","internalPostRender","getControl","emptyControlByAsyncRenderDeferred","processLayout","postRenderPrintVersion","postRender","postRenderReadOnly","performExecutionModeMethods","performDesignModeMethods","configureHandlersQueryForm","configureHandlersReadOnly","internalSetInitialValue","internalSetInitialValueFlag","inlineAdd","hasValue","isQueryForm","filter","messageData","isQuery","val","columnEditable","isNumeric","controlValueIsChanged","changeFontBold","changeFontItalic","changeFontUnderline","changeFontStrikethru","changeFontSize","setValue","triggerEvents","identicalObjects","checkRequired","changeRequiredLabel","triggerRenderValidate","validateInputRetype","enableCheck","displayValue","getDisplayValue","sanitizeHTML","getLabel","mustImplement","getControlFiller","readOnlyValue","isObject","isString","decodedDisplayValue","changeDisplayOption","changeLabelAlign","alignType","changeValueAlign","customizeRenderWidth","getElementsToStylize","originalColor","currentStyle","getFormattingLabel","compareValue","baseValue","defaultValue","forceCollectData","compareValueObj","_findAction","targetObj","guidAction","objectValue","valuestrikethru","valueunderline","empty","emptyControlByChangeEditability","changeEditabilityCellControl","renderColumn","decorated","getDecorated","onCellChange","labelElement","controlElement","prepend","controlFiller","currentElement","refreshDesignControl","clearDisplayValue","input","change","is","queryValue","searchType","rangeQuery","newParameter","orderType","displayXpath","force","displayOnly","time","defaultControl","first","innerControl","autoScrollBottom","align","submitOnChangexpathContext","getCacheIdCase","percent2Number","getIdCase","getIdWorkitem","getidTask","getSessionId","backgroundImage","needBGPaint","background-color","background-image","closest","startActionExecution","actionExecutionDeferred","endActionExecution","readyActionExecution","isFromCreatedRow","isNewRow","submitInvalidatePageCacheRequest","pageCacheToInvalidate","isDesignMode","isExecutionMode","preventDefaultForAnchorTag","processLabelLayout","processControlLayout","warm","$label","changeFontColor","changeTextDecoration","$control","$elements","$element","textDecoration","processClassicRetype","hint","processRenderHint","showIcon","processLabelLineBreak","reg","lastIndex","iconError","iconHelp","isIE9","isNewRenderForm","hideIcon","span","keypress","blur","el","getContainerIcons","visibleIcon","$containerIcons","$errorIcon","$helpIcon","mouseover","stopPropagation","tooltipClass","items","attributes","_title","dialog","_getMaxZindex","containerIcons","errorIcon","iconContainer","hasLocalData","enableTyping","complementData","isDependant","getParentCombo","valueControl","renderCombo","renderComboTemplate","dataPromise","getTemplateName","emptyValue","emptyLabelForCombo","getTemplateParams","unique","randomNumber","formatItem","showEmpty","showCurrentData","getDummyData","remoteDataLoaded","recalculate","msgObj","auxMsg","resetData","combo","getSelectedValue","currentValue","parseAdditionalValues","newItem","hidden","bCurrentDataFound","emptyFound","dataValue","Object","comboData","isExtraItem","escapeValue","mapValue","validateValue","translated","findDataValueById","withAddForm","withEditForm","allowDetail","keys","getKeys","pointer","totalRows","inlineAddRecords","row","showPreview","drawControls","drawActions","drawControl","drawForms","drawPreview","templateItem","hasData","getTotalRows","getRow","getNextRow","getPreviousRow","getFirstRow","getLastRow","setPointer","isTherePendingInlineRow","addKey","newId","removeKey","navigationform","getParameters","submitAddRequest","addUrl","submitEditRequest","editUrl","submitDeleteRequest","deleteUrl","submitSaveRequest","saveUrl","dataFail","submitRollbackRequest","validateControls","showLetters","randomId","allowDecimals","getDefaultAllowDecimals","numDecimals","BIZAGI_DEFAULT_CURRENCY_INFO","decimalDigits","symbol","positiveFormat","negativeFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","groupDigits","setGroupDigits","colorize","colorizeOnNegative","dataTypeMinValue","calculateMinValue","dataTypeMaxValue","calculateMaxValue","isAndroidDevice","numericInput","numeric","attachRetypeDouble","attachFormatCurrency","removeValidations","formatCurrency","regions","language","digitGroupSeparator","minValue","getMinValue","maxValue","getMaxValue","percentage","inputValue","inputLength","oldVal","isInvalidFormat","tempValue","isNaN","asNumber","messageToShow","isValidRenderMessage","parseInt","executeFormatCurrencyPlugin","tmpData","isIE11","clipboardData","originalEvent","totalVal","keydown","keyUnicode","charCode","keyCode","formatTimeout","floatPart","selectionStart","selectionEnd","currentPosition","keyup","character","String","fromCharCode","roundToDecimalPlace","removeTrailingZeros","positive","regExp","re","validMessage","getDefaultGroupDigits","thousands","newValue","createTooltip","currentTitle","toolTipZindex","getMaxZindex","zIndex","numericSN","timeFormat","fullFormat","datePickerRegional","formatDate","indexDateTimeSeparation","lastIndexOf","uppercaseDatePlaceholder","rtl","intHandler","isNow","dateControl","getDateControl","timeControl","getTimeControl","mask","onChangeHandler","updatingTime","hasMaxLines","maxLines","regularExpressionExpression","regularExpressionMessage","regularExpression","isEmptyField","textarea","validationMessages","regEx","decodedValue","decodeURI","valueToDisplay","originalData","areThereEditableColumns","areThereTotalizedColumns","initProperties","enabledChecks","exclusiveChanges","originalEnabledChecks","columnProperties","groupBy","spliceRowData","isExclusive","columnRender","singleInstance","totalize","reverse","showSummary","rowsPerPage","keyColumn","skipInitialLoad","allowFilter","groupSummary","groupText","groupCollapsed","groupOrder","formShowMode","floatingHeader","sortBy","sortOrder","addLabel","editLabel","deleteLabel","exportOptionsLabel","detailLabel","tableCssClass","alreadySaved","overrideGetRemoteData","changes","cellOverrides","isRTL","changeOrderData","rowKey","reverseDataRows","shift","removeRemainingColumns","numColumns","remainingColumns","getColumnType","columnIndex","getGridTemplate","applyTemplate","columnInitializers","initialize","encodeXpath","sortType","spliceIndex","spliceRowDataVisible","spliceRowDataEditable","rowTemplate","total","buildCellXpathFilter","dataResp","collectGridChange","isPressed","configureColumnSubmitOnChange","keysToDelete","columnXpath","canColumnBeSent","columnExclusiveChanges","columnEnabledChecks","lengthEnabledChecks","v","cellOverride","getCellOverride","getCellValue","setError","changeCellProperties","saveGrid","changeColumnsEditability","saveInlineAddedRows","cell","getDepthData","target","isBoolean","updateAffectedCellManually","canBeExported","hasErrors","newRows","getDataNewRows","merge","uniqueMessages","isValueValid","k","messagesLength","gridValidationMessage","setCellOverrides","len_v","newRecords","submitForGridChange","getEnabledChecks","cleanNewRecords","hasColorHeader","headerFormat","allowDinamiclabel","bindingValue","configureHelpText","searchForms","advancedSearch","allowSuggest","allowTyping","allowClear","searchLength","enableLocalStorage","expireCache","submitVersion","h_contexttype","enableQuerySuggestBehavior","regexC","hideStatus","selectedValue","regex","showDesignValidations","isNull","submitOnChangexpathContextRow","runButtonAction","a","b","$context","filesCount","horizontal","checkListGroup","vertical","templateUri","useDefaultImage","getImage64","getImageUri","replaceMultiple","allowSendInMail","getValueFilesByData","dataFiles","valueAuxFiles","getDataFilesWithoutScope","valueResult","err","warn","formContainer","files","getUploadXpath","indexHour","dateObj","INVARIANT_FORMAT","i18n","formattedDateTime","showsymbol","currencySymbol","geolocation","navigator","allowUpdate","getCurrentPosition","succes_callback","fail_callback","getErrorMessage","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","performPrecision","latitude","longitude","toPrecision","maxFileSizeOfProperty","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","maxfiles","validExtensions","singleExtensions","defExtensions","haveFiles","noFiles","file","renderUploadItem","replaceFilesHtml","itemTemplate","getTemplateItemName","buildItemUrl","filename","deleteUploadItem","fileItem","newRow","buildAddParams","BIZAGI_SESSION_NAME","setRenderRequired","base","upload","isClicked","bindEmailDialog","checkMaxFiles","bizagiSendEmail","bindExternalPopup","isInGrid","field","currentPopup","widgetName","workportal","widgets","BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME","widgetURL","injectCss","modalParameters","afterLoad","getElementById","labels","getElementsByTagName","innerText","checked","parentElement","previousSibling","textContent","afterLoadParams","pluginUpload","bizagiUpload","renderReference","dialogTemplate","idSession","networkSpeed","onUploadFileCompletedCallback","onUploadFileCompleted","onChangeFile","onCheckMaxSize","checkMaxSize","onValidate","maxAllowedFiles","uploadedFiles","dialogTitle","delegate","openUploadDialog","doc","dialogBox","checkFileTypes","maxFilesLimit","closeUploadDialog","modal","close","resizeStop","uploadForm","uploadIFrame","timeoutFn","contentWindow","submit","uploadField","cssExtended","previousCheck","uploadWrapper","errorList","toFind","insertBefore","slice","fileControl","showError","documentMode","stringEndsWithValidExtension","stringToCheck","acceptableExtensionsArray","endsWith","errorContainer","arrayItems","maxFiles","q_xpath","showMetadata","listControl","fileProperties","getFileExtension","isImage","lengthValues","renderFileLayout","loader","productBuildToAbout","replaceItemHtml","metadataTemplate","metaData","ecm_ecmStatus","ecmStatus","ecm_isVisible","ecm_allowUpdateMetadata","allowUpdateMetadata","ecm_allowDelete","ecm_allowUpdateContent","allowUpdateContent","ecm_allowView","allowView","ecm_allowCheckOut","allowCheckOut","ecm_allowCancelCheckOut","allowCancelCheckOut","ecm_allowEdit","idFileUploads","extension","cookie","lockUploadItem","unlockUploadItem","isEmptyValue","letterOpened","getXpath","getContextXpath","maximized","likeButton","getFormLinkXpath","executeSubmitOnChange","submitCommitRequest","submitCheckpointRequest","submitDataRequest","downloadalldocuments","allowGenerate","preRenderControl","downloadAllDocuments","documents","getControlHtml","renderDocumentsHtml","renderActionsHtml","noActivateButton","allowgenerate","activateButton","getDocumentXpath","renderDocumentItem","getTemplateItem","joined","buildAllDocumentsUrl","caseId","workitemId","htmlControl","updateControlForPrintMode","validateContainer","replaceActionsHtml","buttonExecuted","generateLink","isPropagationStopped","documentTemplateGenerate","showDocumentPreview","deleteDocumentTemplate","resolveDeleteDocumentTemplate","resolveDocumentTemplateGenerate","messageText","autoOpenDocuments","returnCssTypeFile","lenght","redrawDocuments","documentContainer","renderAllDocumentDownload","removeDeleteButton","startIndex","restOfWord","finishIndex","downloadAllDocumentsLink","getErrorTemplate","getTemplateDownload","getTemplateReadonly","dependants","parentCombo","initializingCascadingCombo","bindDependantCombo","configureReadOnlyHandlers","isInitialValue","deferredVisible","dependantCombo","onChangeFunction","refreshDependantCombo","focusDependant","cleanInput","isEventBinded","unbindDependantCombo","dependant","parentValue","inputCombo","parentLength","parentArray","configured","itemSelected","listSize","getDataValue","addElement","removeElement","idToRemove","markAsChecked","some","found","isChecked","canAddMoreItems","$tagsContainer","toArray","reduce","acc","getElementWidth","MORE_OPTION_WIDTH","styles","getComputedStyle","filterList","query","$container","stringContainer","stringToSearch","addSelectedElements","findItemById","hasSearchForm","removeLastElement","getListItems","getFileDependencies","fileDependencies","loadFile","renderUserfieldControl","extendedData","userEditableControl","getEditableControl","renderComplex","loadUserfieldReadOnly","userReadOnlyControl","getReadonlyControl","getReadonlyValue","setEditableValue","getEditableValue","getPropertyValue","propertyName","jqXHR","textStatus","errorThrown","getRenderElements","getServerResourceURL","resource","userfieldGuid","getRenderValue","showDialog","showPopup","initialParams","userfieldName","getUserfieldControl","isColumn","getControlXpathContext","getUserFieldInstance","replicateUserfieldMethods","userfieldInstance","isUserPreference","isAutoWidth","isAutoHeight","currentUser","charAt","buildItemUrlOffline","getFormParams","getOfflineImage","imageValue","getDataUrl","saveImageOffline","path","blobPromise","isNative","media","getImagePath","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","reader","FileReader","onloadend","blob","Blob","readAsArrayBuffer","blobImage","operationType","saveOfflineImage","buildFullItemUrl","decoratedClass","decorateRenders","columnVisible","showColumn","readonly","isReadonly","instanceDecoratedClass","applyOverrides","propertyOverrides","invalidElement","overrideDecoratedRenderProperties","renderSummary","postRenderSummary","getCell","setSurrogateKey","defaultvalue","setDefaultValue","getCompositeValue","overrideProperties","getSortName","getAnyDecoratedInstance","getSortColumn","arrayEach","originalGetControl","cellIcon","applyColumnStyles","originalGetData","getDataForAllCells","findDataById","fetchingData","valueForGrid","tableCell","formattedDate","POPUP_WIDTH","POPUP_HEIGHT","dialogParams","extraButtons","dialogDeferred","showDialogBox","renderDialogBox","reverseButtons","showSaveButton","showCancelButton","saveButtonLabel","cancelButtonLabel","performActions","allowGetOriginalFormValues","formValues","onSave","currentTarget","closeDialogBox","asyncTabsDef","onCancel","objButtons","nameButon","resizable","open","isWebpart","maximize","unmaximize","adjustOverlay","_appresize","screen","focusFirstControl","controlHtml","isValidControlForFocus","isOnGrid","rewriteContextType","removeTransitions","errorTemplate","getCommonTemplate","customizeDialogBox","adjustButtonPositionDialogForm","adjustButtonPosition","refreshParams","childrenContainer","availableHeight","ResizeSensor","fitSizes","clientHeight","overlayHeight","overlayBody","overlayCanvas","instance","otherOptions","unbindAutoSaveForm","renderSearchDialog","getSearchContainerData","_form","searchForm","loadSearchTab","currentSearchForm","dialogBoxDeferred","searchFormContainer","defaultButtons","searchTriggeredBy","popupWidth","popupHeight","detach","addButtons","searchFormToLoad","otherElements","isDefault","searchFormData","divMessage","nicEditor","iconsPath","fullPanel","panelInstance","templateParts","nicEditors","findEditor","setContent","newContent","getContent","isEntityForm","configureBindAutoSave","deferredSave","autoSaveEvents","beforeUnloadFunction","newData","buildProcessPath","scroll","callback","autoSaveFunction","haveAutosaveAssociated","saveFormDelegate","proxy","idAutoSave","getIdentifierFormForAutosave","functionSaveFormDelegate","autoSaveIdentifier","autoSaveHandlers","saveBox","showSaveBox","getChanges","pathProcess","contentPanel","formDisplayName","visibleTab","resizeInPopUpHTML","beforeActivate","newTab","tabItem","tabHeader$","at","heightActivitiFormContainer","renderForm","buttonContainer","heightButtonContainer","tabReadyDeferred","tabActiveDeferred","resizeTimeout","setInterval","clearInterval","header","iCount","innerChild","jCount","renderedElement","accordion","autoHeight","accordionItem","group","styleSufix","expanded","toggleClass","toggle","isOpen","hideActionsColumn","jqgrid","resultsGrid","searchCriteria","results","criteriaContainer","resultsContainer","dataReady","resizeResults","retypeDouble","disabled","extendedText","actualMaxLength","autoExtend","minHeight","overflow","changeHeightAutoExtended","resolvedValue","br2nl","removeProperty","scrollHeight","getDateFormat","datePickerFormat","timePickerFormat","getTimePickerFormat","c","token","returnObj","show24Hours","showSeconds","showZeroInHour","separator","lastToken","ampmPrefix","timeFormatProperties","maxUndefinedYear","getFullYear","minUndefinedYear","analyzeTimeFormat","timeEntry","spinnerTexts","useMouseWheel","dateIcon","getDateIcon","initYear","endYear","datepicker","parseDate","setDefaults","firstDay","yearRange","changeYear","changeMonth","shortYearCutoff","BIZAGI_DEFAULT_DATETIME_INFO","twoDigitYearMaxDelta","beforeShow","onClose","onSelect","getDateFromFormat","assert","inputTimeValue","checkIcon","currPadding","currentDateString","currentTime","getHours","setMinutes","getMinutes","getSeconds","objDate","oldValTime","yesno","removeData","optiongroup","parsedValue","check","performStyles","select","resizeCombo","idDropdown","comboDropDown","dropDownDestroy","addEventListener","keyUpFunction","keyDownFunction","showLoadingData","hideLoadingData","internalComboDropDown","padding","margin","my","of","collision","selectTmp","objSelected","containerDropdown","containerControl","last","containerRender","findDataByValue","scrollPosition","userAgent","appVersion","contFormScroll","repositionInterval","datasource","dropDwn","objParent","widthChild","widthControl","recalculateComboOffset","onComboItemSelected","makeArray","tg","dropDownValidClose","dropDown","dropDownReposition","containerForm","validateValueInDatasource","isKeyByKey","selectedKey","altKey","ctrlKey","metaKey","shiftKey","selectPreviousElement","selectNextElement","selectFirstElement","selectLastElement","typingForCombos","isSelectingItem","selectItemByKeyUp","actual","previous","prev","selectedId","selectedLabel","comboValue","emptySelection","keyByKey","equalsToValue","tvalue","nValue","compareValIn","compareVal","dataLength","getValueFromData","getInternetExplorerVersion","selectMenu","originalRefreshPositionMethod","selectmenu","_refreshPosition","newelement","cascadingCombo","changeRequiredControl","collectionnavigator","navigationControls","getCanvas","showRow","refreshControls","isValidRow","saveChanges","checkSave","removeRow","addInlineRow","updateRow","addRow","editRow","showDetailForm","cancelChanges","configureButtonsForm","refreshForwardButtons","refreshBackButtons","refreshPagination","refreshTotal","refreshRemoveAction","nextControl","getInnerControl","lastControl","previousControl","firstControl","removeButton","eSave","eCancel","section","setFocus","navigationPage","loadForm","editPage","showInlineRow","isValidKey","bindRenderChangeEvent","isSaveEnabled","checkSaveEnabled","arrayCollectionNavigator","getChildCollectionNavigator","saveChangesChildren","removeInlineAddRecord","fetchData","removeNavigationForm","newid","addPage","addNavigationForm","valid","collectionControls","outerHTML","forms","getActionsTemplate","saveDeferred","actionClass","buttonClass","ecm","showRenderOptions","isECM","configureUploadHandlers","reference","extraData","buildUpgradeParams","isUpdatingECM","onUpdateUploadFileCompleted","waiting","controlContent","insertAfter","uploadId","imageConfig","metadataParams","Array","image","src","imageZoom","dataItem","hover","setControlEvents","multiClickControl","modalEcm","displayOptionsContent","configureToggleHandlers","isAsync","asynCheckEnabled","asyncCheckTimeout","IsFileOnECM","toggleOptions","globalControl","makeStringMetaDataControler","valueMatch","makeDatetimeMetaDataControler","numericFormat","lastChar","makeBooleanMetaDataControler","ecmMetaDataFieldEdit","metadatavalue","metadatapostvalue","spanMetaDataValue","validateData","checkData","isValidFields","metadata","editButtons","actualValue","idMetadata","metadataValues","inputMetaDataValue","validationFunction","dateText","inst","makeDecimalMetaDataControler","rnd","folder","BIZAGI_PATH_TO_BASE","scriptData","controlList","isValidBase","$arrayEcmControls","ctrl","metadataContext","currentField","showActionColumn","cellMetadata","pendingActions","editableGrid","columnActions","columnActionParams","xpath-column","hasTotalizer","columnwidth","headerStyles","hasActions","buildColumnModel","applyGridPlugin","updateData","initialLoadDone","buttonsComponent","applyColumnsWidth","pager","scrollableArea","scrollParent","bizagi_grid_desktop","buttonsPst","smartPagination","gridDefaultSortBy","getHeaderStyles","gridRtl","table","emptyTable","specialColumn","rowButtons","rowButtonsRtl","specialCell","buttonsRtl","dynamicPager","summary","summaryCell","exportOptions","edit","details","enableXlsExport","enablePdfExport","tooltips","errorsMessage","pageRequested","sortRequestedPage","sortRequested","sortName","drawCell","cellReady","onCellReady","rowSelected","deleteRow","moreRows","saveAddedRows","saveRows","beforeInlineAdd","inlineAddDeferred","afterInlineAdd","showFormDetails","cancelEdition","removeNewRecords","showGridExportOptions","performExportGrid","printParams","performCollapseGrid","rowdblclick","canEditRow","businessKey","triggerGridPluginHandler","call","columnModel","columnLabel","summarizeBy","bizAgiProperties","dataReadyDeferred","loadChanges","idRow","assignValue","columnData","columnNumber","applyColumnsWidthUpdate","newKeys","errDef","drawEditableCell","drawReadonlyCell","originalEditable","originalFormat","_value","compositeValue","isNewRecord","isSubmitOnChange","isExclusiveControl","max-width","applySummaryColumnStyles","addFormDialog","maximizeGridPopup","executeSubmitEditRequest","editInlineRow","changeRowEditable","rowLength","calculateFetchData","originalrowsPerPage","dataToSend","moreRowsCommon","workportal-widget-dialog-box-print","printFormCommand","printform","print","hasRefresh","prepareAddAction","exportPst","expMenuDirection","$gridWrapper","$collapseIcon","updateCollapseState","$header","filePrintUrl","isAcrobatInstalled","checkAdobePlugin","browser","msie","downloadExportedGrid","rowIndex","getRowIndexByKey","installed","ActiveXObject","formatGrid","tableControl","closeButton","parentPromise","inlineAddPromise","columnWidth","widthToApply","resizableColumns","elementChild","textDecorator","$tableContext","enableColorHeaderGrid","convertProperties","bizagi_grid_grouped_desktop","groupByColumns","headerRow","emptyCell","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","CLEAR_SEARCH_ID","NO_RESULTS_SEARCH_ID","SEARCH_DELAY","SEARCH_MAX_RECORDS","searchImage","searchInput","applyAutocompletePlugin","selection","oSel","createRange","moveStart","moveEnd","hideAutocompleteLoading","autocomplete","showSearchDialog","alignForSuggest","rtlClassForSuggest","autoFocus","noResults","req","activeRequestTerm","now","getTime","parseRequest","encodeURIComponent","expireKey","requestKey","expire","getItemLocalStorage","processRequest","suggestMenu","menu","suggestContainer","controlContainer","itemWidth","calculateSuggestionWidth","_renderItem","ul","renderClearItem","renderAdvancedItem","renderAddItem","renderSearchItem","searchItem","suggestions","addToSuggestions","allSuggestions","request","expireTime","setItemLocalStorage","showAutocompleteLoading","deferredReference","parseValue","highlightMatches","getValueId","getValueLabel","additionallabel","showAddRecordDialog","mapping","searchDialog","obj","setDisplayValueToControl","renderControlSearchForm","addForm","allowNew","currentId","letter","showLetterDialog","wasGenerated","canGenerate","buttonInput","validateGridsOnButtonClick","htmlMessage","draggable","fileprint","getAbsoluteFilePrintUrl","fileType","bizagiConfig","fileObject","isIE10","mozilla","idFrame","iframe","frm","mycounter","all","readyState","wnd","onload","link","attachEvents","linkSolver","linkPrefix","linkType","windowParams","windowObjReference","linktarget","layoutRender","layoutPlaceholder","layoutBoolean","layoutImage","success","getResponseHeader","byteArrayToBlob","stringToByteArray","imageUrl","URL","webkitURL","createObjectURL","renderParams","idcase","idworkitem","contextxpath","layoutLink","onClickElement","referenceType","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getHTMLFiles","formLink","openLinkRule","elLink","dataRuleResp","openLink","defClose","getDisplayAsReadOnlyValue","closeExitRule","hasexitrule","canBeSaved","hasentryrule","renderFormLinkDialog","getFormLinkXpathContext","parentXpathContext","cordinate","msg","coordinate","coords","money","showSymbol","radio","radiogroup","onOptionGroupChange","selectable2","multiple","focusSelectedItem","elList","multiSelect","onToggleDataView","onUnselectElement","onShowSelectedElements","totalValues","$ChildToAdd","$viewMore","renderFloatView","updateArrow","$floatList","showFloatListView","floatListHandlers","$containerControl","$containerRender","destroyFloatView","$list","closeFloatView","$listView","floatViewIsCollapsed","valuesToShow","$tagElements","$floatListContext","$listContainer","checkbox","userfieldWrapper","sControl","exists","createUserfieldInstance","loadUserfield","dynamicFunction","isUserField","styleGuid","str","ex","defaultUserField","designUserField","userfieldDefinition","basicUserField","formDialog","load","callInside","BACloseWindow","controlName","applyDocumentTemplatesFormat","documentList","previewTooltip","returnType","tem","N","ua","M","sayswho","appName","count","printFn","pdf","autoOpen","joinedDocument","imgWidth","imgHeight","flashVersion","containerChildsSize","containerChildsHeightSum","baseImageURL","resizableImgNode","border-top-width","border-left-width","border-right-width","border-down-width","isImageGreaterThanContainer","controlWidth","isAuto","wSize","isPostRendered","deleteHandler","border","line-height","imageWrapper","isImageLoaded","widthBase","htmlImage","columnAlign","isInlineRow","xpathPath","calculateValue","resolveValue","readOnly","originalMethod","applyUploadPlugin","undelegate","originalApplyUploadPlugin","originalRenderControl","originalInternalPostRender","nameFile","caller","configureHandlersActions","renderDraftControl","viewMore","events","overflowMenu","clearOtherRows","simpleXpathArray","simpleXpath","templates","loadOverrides","initAsyncStuff","loadTemplates","loadTemplate","templateDestination","templateService","resolvedTemplate","containerParams","mobileform","formTemplate","usersForm","nestedForm","mobilegroup","mobiletext","association","searchList","actionLauncher","entityTemplate","polymorphicLauncher","getSearchRender","getQueryRender","getUser","rangeDate","rangeMoney","rangeNumber","activityCheckList","columnParams","exclusiveCheck","uploadecm","numberScientificNotation","queryExtendedText","queryText","queryCheck","queryYesNo","queryNumber","queryMoney","queryDate","queryCombo","queryCascadingCombo","querySuggest","queryLabel","queryList","queryMultiSelect","querySearch","queryRadio","queryState","queryCaseState","queryProcess","querySearchUser","factory","tmplIcons","enableCustomizations","getJavaScript","grouped","getLayoutRender","getRangeRender","userPassword","comboSelected","stakeholder","gridActions","SEARCH_MIN_LENGTH","padding-right","attachKeyEvents","selectedValues","isNewItem","appendFoundItem","minLength","deleteItem","newElement","before","li","stringValue","templateWithValues","allowFlip","flipped","leftData","rightData","processPropertyValue","flip","makeJsonBase","getColumnData","getRightAssociation","formatJson","associationData","leftId","idRight","rightId","removeValue","leftXpath","rightXpath","leftFactName","rightFactName","closeElement","togglepanels","animated","idLeft","setBindToClose","ol","classCss","getLeftName","allowDelegatedUser","bindSearchUserPlugin","clearValue","filters","displayNames","searchButtonName","clearButtonName","valuesToSelect","selectItem","onItemSelectedSuccess","searchUsers","filterData","getTableTemplate","usersResults","currentPage","pagination","pagesArray","users","links","editingUser","opt","allowAddUser","menuSecurity","UserAdmin","bizagiSearchUser","getOptions","iduser","user","loadtemplates","wrapper","getWrapper","loadData","renderData","wrapperElement","linkApplication","process","itemElement","idParent","idContCategory","setupLinks","idCategory","elementRender","processSelect","parentType","routeProcess","getAttribute","iconProcess","getUserData","username","execution_device","cachedFactory","getRenderFactory","getDataService","executionDeferred","deviceFactory","getFactory","subscribe","unsubscribe","publish","update","ownerDocument","location","queryString","getQueryString","refreshing","lastWidth","lastHeight","configureRefresh","configureRouting","configureRenderError","configureResize","configureGlobalHandlers","enableE2EInterface","transformGridControl","processForm","getFailDeferred","jsonErrorMessage","BIZAGI_ORIENTATION","buttonsForm","fastEmpty","canvasParent","forceResize","triggerParams","renderBehavior","heightCanvas","innerHeight","BIZAGI_WORKPORTAL_WIDGET_PRINT","refreshInbox","referrer","referrerParams","selfButton","frameTemplate","headerTemplate","executePrintWidgetAction","objFrame","strFrameName","jFrame","printID","jFrameHeader","environment","productBuild","build","frames","objDoc","objDocStr","innerHTML","write","win","styleLoading","enableDeprecatedProperties","renderInterface","controlInterface","isRequired","getDisplayNameObj","getDisplayNameText","getDisplayValueText","elm","getType","setControlValue","setControlDisplayValue","gridControlInterface","getColumnByXpath","getColumnByName","resultColumn","getRecord","getNewRows","extendControlInterface","getGridButtonsPanel","getGridPaginationPanel","getGridHeaderPanel","uploadInterface","getFiles","listOfFiles","hasFile","booleanInterface","checkByName","comboInterface","getComboArrow","getComboOptions","_getInterface","interfaz","_getExtendedInterfaceByControl","extendedInterface","extendObject","objToExtend","keyToExtend","valueToExtend","_extendControlInterface","getInterface","e2e","dialogIsOpen","setScopeDefinition","facade","formReady","deferredForm","m","_getAllrenders","_findRenderByProperty","propertyvalue","controlClass","getRenderByXpath","getRenderByDisplayName","getRenderByValue","getNotificationPanel","getMessages","messagesHtml","hasMessage","getFormButtonByCaption","getFormButtons","checkIncludedAll","getSearchParams","checkedChildren","leftValues","rightValues","dataList","orderArraySelected","nA","nB","dataListArray","renderControlReadOnly","showInitialData","selectedItemsToUpdate","orderArrayList","orderList","addItem","filterFunction","removeItem","selectInput","binaryInsert","binarySearch","array","middle","current","right","dataSelected","dataResults","dataSelectedToRemove","dataOptions","showListBoxComboData","collectedValues","$canvas","formAction","sendMail","sendMailControl","passwordControl","redirectErrorPage","href","passwordMinLength","passwordMaxLength","generateRandomPassword","processSave","userFormData","createUser","updateUser","maxLenth","getLengthPassword","chars","randomPassword","randomPosition","floor","saveValue","collectedData","expiredAccountControl","lockedAccountControl","domain","expiredAccount","lockedAccount","fullName","userName","userId","valuePassword","userNames","entities","valueXpath","refreshStakeholderList","bizagiControl","maxElemShow","maxPageToShow","selectedItems","addInstance","addGrid","goToBack","removeAssociated","onKeyUpFilter","paramField","gridDataService","onGetData","onGetDataFail","tempGrid","dataColumns","tempColumns","iColumn","objectColumn","idData","idInstance","nameInstance","newDataRows","iRow","stateInstance","tooltipLink","gridTmp","tooltipUnassociated","tempPagination","totalRecords","pageToshow","pagerData","pages","pageNumber","paginationHtml","$pager","bizagiPagination","actualPage","listElement","clickCallBack","setRowsEvents","onLinkClick","executeLinkClickIfProceed","refreshStakeholderValue","onStakeAssociatedFail","confirmationMsg","C","CryptoJS","userFormsSpanner","enc","Utf8","userFormsCode","Latin1","resultMain","algo","AES","createEncryptor","CBC","pad","Pkcs7","iv","finalize","resultMainFinal","Base64","spanTmp","attachFormatScientificNotation","scientificNotationFormat","scientificNotationNumber","deferredActions","engine","templateEngine","autoGenerateData","selecttemplate","processPropertyValueArgs","tagslist","maxItems","processPropertyValueDataTmplArgs","defaultAllowActions","allowactions","isHorizontal","templatetype","executeActionImmediately","processPropertyValueExecuteAction","notifyExecution","actionName","templateDefined","actionManager","guidProcess","processStartForm","processActionFormCollection","processActionForm","addActionToQueue","actionsList","additionalXpath","idParentWorkitem","entityXpath","newValueActionsList","removeActionToQueue","controlValue","countSameActions","getPropertiesActionLaucher","actionsLaucher","setRanageControls","minControl","maxControl","$maxCanvas","$minCanvas","renderRangeControl","min","max","defineRangeControl","dateMin","suscribe","observer","notify","dateMax","getRenderProperties","typeRangeControl","renderProperties","moneyMin","moneyMax","numberMin","numberMax","appendContent","templateArguments","actionsContainer","configureQueueVisibility","templateData","totalActions","moreActionsManager","isMoreActions","lessActions","moreActions","actionsVertical","isExpanded","moreButtonTitle","start","BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV","maximizeOnly","moreActionsTemp","actionLauncherControls","moreVerticalButton","configureMoreActionsHandler","isReadOnlyForm","onActionClicked","expr","FilterAction","resultReadOnly","moreButton","startAndThen","kendoTooltip","autoHide","multipleSelection","act","executeAction","showConfirmationDialog","notifications","INotifications","showSucessMessage","savedData","editMode","xpathContextWithKey","xpathContextWithoutKey","IdEntity","startForm","confirmTemplate","confirmContent","confirmationMessage","confirmContentParams","actionsToExecuteContainer","listOfActions","removeActionSelector","openActionSelector","extraParameters","dataAction","actionsToExecuteTitle","range","guidTemplate","htmlTemplate","entityTemplateControls","checkList","itemId","updateDisplay","onCheckListGroupChange","addButton","newItemName","goalActivity","additionalElements","notifyLoadItems","activityWork","$divContainer","activityDescription","prepareNewItem","repaintControl","itemSelectedName","itemContent","setSelectionRange","addSelectedHandlers","refreshValue","resolved","which","checkListHtml","completed","allCheckedItems","every","idActivity","validationResolvedItems","getTagList","processPropertyValueExecuteConstructor","displayNamee","taglist","treeActionsList","getTreeItems","level","templateTreeItem","$targetData","$node","cachedValue","pageCache","$target"],"mappings":"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","sourcesContent":["/*\r\n*   Name: BizAgi Services Rendering End Points\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\r\n\r\n// Create or define namespace\r\nbizagi.render = (typeof (bizagi.render) !== \"undefined\") ? bizagi.render : {};\r\nbizagi.render.services = (typeof (bizagi.render.services) !== \"undefined\") ? bizagi.render.services : {};\r\nbizagi.render.services.endPoints = [];\r\n\r\n// Creates a endpoint hash factory to resolve custom requirements\r\nbizagi.render.services.getEndPoints = function (params) {\r\n\r\n    var renderHandlerPathRest = \"Rest/Handlers/Render\";\r\n    var renderUploadHandlerPathRest = \"Rest/Handlers/Render/Upload\";\r\n    var renderFileHandlerPathRest = \"Rest/Handlers/RenderFile\";\r\n    var letterHandlerPathRest = \"Rest/Handlers/Letter\";\r\n    var multiActionHandlerPathRest = \"Rest/Handlers/MultiAction\";\r\n    var metadataHandlerPathRest = \"Rest/Handlers/Metadata\";\r\n    var metadataMultiactionHandlerPathRest = \"Rest/Handlers/MetadataMultiAction\";\r\n    // Default workportal end-points\r\n    if (params.context == \"workflow\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.proxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.proxyPrefix + metadataHandlerPathRest,\r\n            \"render-multiaction-metadata\": params.proxyPrefix + metadataMultiactionHandlerPathRest,\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.proxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.proxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.proxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"render-entity-layout-upload-files\": params.proxyPrefix + \"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}\",\r\n            \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\",\r\n            \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\",\r\n            \"admin-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsers\",\r\n            \"admin-getUsersList-FromPreferences\": params.proxyPrefix + \"Rest/Users/SearchUsersFromPreferences\",\r\n            \"admin-getUsersList-ForStakeholders\": params.proxyPrefix + \"Rest/Users/SearchUsersForStakeholders\",\r\n            \"admin-getUsersForAssignation\": params.proxyPrefix + \"Rest/Users/UsersForAssignation\",\r\n            \"admin-users-config\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\r\n            //users administration\r\n            \"admin-usersform\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\r\n            \"admin-sendUserEmail\": params.proxyPrefix + \"Rest/Users/SendUserEmail\"\r\n        };\r\n    }\r\n    // Sharepoint end-points (must be customized for each project)\r\n    if (params.context == \"sharepoint\" || params.context == \"portal\") {\r\n        if (typeof (params.sharepointProxyPrefix) === \"undefined\") alert(\"sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'\");\r\n        return {\r\n            \"form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.sharepointProxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.sharepointProxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.sharepointProxyPrefix + metadataHandlerPathRest,\r\n            \"render-grid-edit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": \"jquery/css/bizagi/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.sharepointProxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": \"jquery/css/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.sharepointProxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"case-handler-getCaseSummary\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/Summary\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.sharepointProxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getWorkItems\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"entitymanagement\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=entity\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"search\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=metadata\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    return {};\r\n};\r\n","/*\r\n*   Name: BizAgi Rendering Service Context Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\r\n\r\n$.Class.extend(\"bizagi.render.services.context\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        this.context = params.context;\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the given url for a specified service\r\n    */\r\n    getUrl: function (service) {\r\n        if (this.endPoints[service] == null) {\r\n            alert(\"No endpoint defined for: \" + service);\r\n        }\r\n        return this.endPoints[service];\r\n    },\r\n\r\n    setProxyPrefix: function(params){\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to rendering REST services\r\n */\r\n\r\n$.Class.extend(\"bizagi.render.services.service\",\r\n    {\r\n        // Statics\r\n        BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n        BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n        BA_PAGE_CACHE: \"pageCacheId\"\r\n    },\r\n    {\r\n        /*\r\n         *   Constructor\r\n         */\r\n        init: function(params) {\r\n            params = params || {};\r\n            params.context = params.context || \"workflow\";\r\n            params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n            this.serviceLocator = new bizagi.render.services.context(params);\r\n            this.multiactionService = new bizagi.render.services.multiactionservice(this);\r\n            this.guid = Math.guid();\r\n\r\n            if (bizagi.override.enableECMMetadataMultiaction) {\r\n                this.multiactionMetadataService = new bizagi.render.services.metadatamultiactionservice(this);\r\n            }\r\n\r\n            // Userfield definitions mini-cache\r\n            this.userfieldRequests = {};\r\n\r\n            this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone: (bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet: bizagi.deviceEnum.desktop));\r\n            this.deviceCode = bizagi.util.getDeviceCode();\r\n        },\r\n        /*\r\n         *   Return the multiaction-service\r\n         */\r\n        multiaction: function() {\r\n            return this.multiactionService;\r\n        },\r\n\r\n        metadataECMMultiaction: function () {\r\n            return bizagi.override.enableECMMetadataMultiaction ? this.multiactionMetadataService: this;\r\n        },\r\n        /*\r\n         *   SINGLE SERVICES METHODS\r\n         */\r\n\r\n        /*\r\n         *   Gets form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Check if the params contains mocked data\r\n            if (params && params.data) {\r\n                return params.data;\r\n            }\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action || \"LOADFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idProcess)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idProcess\"] = params.idProcess;\r\n            if (params.idForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            if (params.idEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idEntity\"] = params.idEntity;\r\n            if (params.surrogateKey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.requestedForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"requestedForm\"] = params.requestedForm;\r\n            if (params.recordXPath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordXPath\"] = params.recordXPath;\r\n            if (params.summaryForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"summaryForm\"] = params.summaryForm;\r\n            if (params.idCase)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            if (params.idWorkitem)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            if (params.idTask)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idTask\"] = params.idTask;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contextType)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contextType;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (!bizagi.util.isEmpty(params.isRefresh))\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isRefresh\"] = params.isRefresh;\r\n            if (params.isActionStartForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n            if (params.additionalXpaths)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            if (params.idStartScope)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            if (typeof params.readOnlyForm !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"readonlyform\"] = params.readOnlyForm;\r\n            if (typeof params.printversion !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"printForm\"] = params.printversion;\r\n            if (typeof params.recordXpath !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            if (params.guid)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guid\"] = params.guid;\r\n            if (params.downloadOfflineForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"downloadofflineform\"] = 1;\r\n\r\n            if (params.editable === false) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"DisplayFormAsReadOnly\"] = true;\r\n            }\r\n\r\n            // Support parameter from ui\r\n            // Parameters that affects all the same attributes of render\r\n            if (params.printversion) {\r\n                //Print limit grid rows\r\n                var BA_ALL_PARAMETER_PREFIX = \"all_\";\r\n\r\n                if (params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"]) {\r\n                    data[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"] = params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"];\r\n                }\r\n            }\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n\r\n            // Call ajax and returns promise\r\n            bizagi.chrono.initAndStart(\"data\");\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: params.action || \"LOAD\"\r\n            })\r\n                .pipe(function(response) {\r\n                    bizagi.chrono.stopAndLog(\"data\");\r\n\r\n                    // Transform data for read only version\r\n                    if (params.printversion) {\r\n                        try {\r\n                            response.form.properties.editable = \"False\";\r\n\r\n                            var transformGridDataToReadOnly = function(_data) {\r\n                                if (_data == null) {\r\n                                    return _data;\r\n                                }\r\n                                if (_data.hasOwnProperty('type') && _data.type == 'grid') {\r\n                                    _data.id = data.id + \"-print\";\r\n                                    _data.allowAdd = \"False\";\r\n                                    _data.allowDelete = \"False\";\r\n                                    _data.allowEdit = \"False\";\r\n                                    _data.allowGrouping = \"False\";\r\n                                    _data.allowMore = \"False\";\r\n                                    _data.allowSearch = \"False\";\r\n                                } else {\r\n                                    $.each(data, function(key, value) {\r\n                                        if (typeof (value) == 'object') {\r\n                                            _data[key] = transformGridDataToReadOnly(_data[key]);\r\n                                        }\r\n                                    });\r\n                                }\r\n                                return _data;\r\n                            };\r\n                            response = transformGridDataToReadOnly(response);\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n\r\n                    return response;\r\n                });\r\n        },\r\n        /*\r\n         *   Gets a search form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getSearchFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHFORM\";\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idSearchForm)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHFORM\"\r\n            });\r\n        },\r\n\r\n        processDataValues: function(data) {\r\n            var o;\r\n            data = $.extend(true, {}, data);\r\n            for (o in data) {\r\n                if (data.hasOwnProperty(o) && $.type(data[o]) == \"object\") {\r\n                    // for search\r\n                    if (data[o].hasOwnProperty(\"id\")) {\r\n                        data[o] = data[o].id;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Sends a form action to the server\r\n         */\r\n        submitData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            data = self.resolveData(params.data || {}, params.xpathContext);\r\n            data = self.processDataValues(data);\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action;\r\n\r\n            // Fill optional parameters\r\n            params = params || {};\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.transitions)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"transitions\"] = params.transitions;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.forcePlanCompletion)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"forcePlanCompletion\"] = params.forcePlanCompletion;\r\n\r\n            /* if (params.isActionStartForm)\r\n             data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n             */\r\n            var actionType = params.action.toString().toUpperCase();\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Data sent\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: actionType\r\n            });\r\n        },\r\n        /*\r\n         * Get data processing xpathcontext\r\n         */\r\n        resolveData: function(data, xpathContext) {\r\n            var name, newName, value;\r\n            if (!$.isEmptyObject(data) && xpathContext) {\r\n                if (xpathContext.search(/\\[id=\\d+\\]/) !== -1) {\r\n                    for (name in data) {\r\n                        if (name.search(/\\[id=\\d+\\]/) !== -1 && xpathContext == name.substr(0, name.search(/\\]/) + 1)) {\r\n                            newName = name.substr(name.search(/\\]/) + 2);\r\n                            value = data[name];\r\n                            data[newName] = value;\r\n                            delete data[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Fetch a property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   property\r\n         */\r\n        getPropertyData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n\r\n            if (params.sessionId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.guidentity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.pxpath)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpath\"] = params.pxpath;\r\n            if (params.prows)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.prows;\r\n            if (params.ppage)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.ppage;\r\n            if (params.pfilter != undefined && params.pfilter != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = params.pfilter;\r\n            /*else\r\n             data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = \"\";*/\r\n            if (params.psort != undefined && params.psort != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.psort;\r\n            if (params.porder)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.porder;\r\n            if (params.pcaseId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"caseId\"] = params.pcaseId;\r\n            if (params.pguidEntity)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidEntity\"] = params.pguidEntity;\r\n            if (params.psurrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.psurrogatedKey;\r\n            }\r\n            if (params.pactionXpath) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"actionXpath\"] = params.pactionXpath;\r\n            }\r\n            if (params.ptemplateGuid) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"templateGuid\"] = params.ptemplateGuid;\r\n            }\r\n            if (params.pparameters) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parameters\"] = params.pparameters;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         */\r\n        getData: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch search data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   term\r\n         */\r\n        getSearchData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"term\"] = params.term;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         * Refresh tha data property from the server\r\n         * Params:\r\n         *   -   collapsestate\r\n         */\r\n        getCollapseData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"collapseState\"] = params.collapseState;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"collapseState\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch grid data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   sort\r\n         *   -   page\r\n         *   -   rows\r\n         */\r\n        getGridData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.order;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        getGridDataExclusivesSelected: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathfilter\"] = params.xpathfilter;\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"exclusivesSelected\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload plugin cancel image\r\n         */\r\n        getUploadCancelImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-upload-cancel-image\");\r\n        },\r\n        /*\r\n         *   Returns the upload file url for each file\r\n         */\r\n        getUploadFileUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        getUploadFileEntityUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUETEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            if (params.isContextContainerWidgetRender) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathactions\"] = params.xpathActions;\r\n            } else {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            }\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddUrl: function() {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-add-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDFILE\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddFileUrl: function(isUserPreferences) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"form-submit-data-upload\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = (isUserPreferences === true) ? \"SAVEUSERIMAGE\" : \"savefile\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n\r\n        deleteImage: function(params) {\r\n            var self = this;\r\n\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"DELETEUSERIMAGE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing image '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        deleteUploadFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing file in upload '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n\r\n            });\r\n        },\r\n        /*\r\n         * Return file meta data\r\n         */\r\n        getECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            // Log submit data\r\n            bizagi.debug(\"Get file metadata '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        checkOutFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"checkOutFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * cancelCheckOut\r\n         **/\r\n        cancelCheckOut: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"cancelCheckOut\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        deleteECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"delete\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"delete file'\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update ECM file content\r\n         **/\r\n        updateECMFileContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMFileContent\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file content '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update file content\r\n         **/\r\n        updateECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file meta data '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getFileProperties: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getFileProperties\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Get file properties '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n        },\r\n        uploadECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"uploadECMFile\";\r\n            data.fileUpload = params.fileUpload; // Content of file\r\n            data.xPath = params.xPath;\r\n\r\n            data.idAttrib = params.idAttrib;\r\n            data.fileName = params.fileName;\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Upload ECM file '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getECMFileUrl: function(params) {\r\n            var self = this;\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"File\";\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data.action = \"viewECMFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.fileName = params.fileName;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            if (params.p_sessionId) {\r\n                data.p_sessionId = params.p_sessionId;\r\n            }\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"View uploaded file '\" + params.xPath + \"'\", data);\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n        /*\r\n         *\r\n         */\r\n        isFileOnECM: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = {};\r\n            data[\"action\"] = \"isFileOnECM\";\r\n            data[\"idUpload\"] = params.idUpload;\r\n\r\n            // Call ajax and returns promise\r\n            return $.read(self.serviceLocator.getUrl(\"render-ecm-upload-url\"), data);\r\n        },\r\n        /*\r\n         *   Start a grid record edition\r\n         */\r\n        editGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EDITRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending edit request for relation '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-edit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"EDITRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row, and sending the data at the same time\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecordData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATIONWITHDATA\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Build data to submit\r\n            var submitData = params.submitData || {};\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATIONWITHDATA\"\r\n            });\r\n        },\r\n        /*\r\n         *   Submits the grid record data to the server\r\n         */\r\n        saveGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disableServerGridValidations\"] = params.disableServerGridValidations || false;\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVERELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Deletes a grid record in the server\r\n         */\r\n        deleteGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending delete request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"REMOVERELATION\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Get association flipped status\r\n         */\r\n        getFlipAssociation: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.id;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"flipped\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"flipstate\"] = params.flipstate;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log request data\r\n            bizagi.debug(\"Sending request for flip association control '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"text\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    // Try to attempt to parse JSON\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    // If JSON is not valid we need to return the original text response\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Cancels an add or edit request for a grid\r\n         */\r\n        rollbackGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ROLLBACK\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-rollback-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ROLLBACK\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the search render default image\r\n         */\r\n        getSearchDefaultImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-search-default-image\");\r\n        },\r\n\r\n        processDataCriteria: function(criteria) {\r\n            var o;\r\n            criteria = $.extend(true, [], criteria);\r\n            for (o in criteria) {\r\n                if (criteria.hasOwnProperty(o) && criteria[o].hasOwnProperty(\"value\") && $.type(criteria[o].value) == \"object\") {\r\n                    // for search\r\n                    if (criteria[o].value.hasOwnProperty(\"id\") && criteria[o].value.hasOwnProperty(\"label\")) {\r\n                        criteria[o].value = criteria[o].value.id;\r\n                    }\r\n                }\r\n            }\r\n            return criteria;\r\n        },\r\n\r\n        /*\r\n         *   Perform entity search in the server\r\n         */\r\n        submitSearch: function(params) {\r\n            var self = this, criteria;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            var sort = params.sort && params.sort !== \"\" ? params.sort : \"\";\r\n\r\n            if (params.order && params.order !== \"\" && sort !== \"\")\r\n                sort += \" \" + params.order;\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHENTITYFORRENDER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"pageSize\"] = params.rows;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n\r\n            criteria = self.processDataCriteria(params.criteria);\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchCriteria\"] = JSON.encode(criteria);\r\n\r\n            // Optional search params\r\n            if (params.allowFullSearch)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"allowFullSearch\"] = params.allowFullSearch;\r\n            if (params.maxRecords)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxRowsAllowed\"] = params.maxRecords;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Performing advanced search\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-advanced-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHENTITYFORRENDER\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Submits the stakeholder associated\r\n         */\r\n        associateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            data[\"associatedUser\"] = params.associatedUser;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Refresh the stakeholder associated list\r\n         */\r\n        refreshAssociateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Gets the link to the letter\r\n         */\r\n        getLetterNotEditableUrl: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Call ajax and returns promise\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-letter-notEditable-url\");\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Gets the content for editable letters\r\n         */\r\n        getLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Get the can generate letter flag\r\n         */\r\n        getCanGenerateLetter: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CANGENERATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *   Saves the content for editable letters\r\n         */\r\n        saveLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"UPDATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Define content\r\n            var content = params.content || \"\";\r\n\r\n            // Define url\r\n            var url = params.url || (self.serviceLocator.getUrl(\"render-letter-save-url\"));\r\n            var fullUrl = url + \"?\" + jQuery.param(data);\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Save request for letter sent to: \" + fullUrl, content);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: fullUrl,\r\n                data: content,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the icons path for the letter plugin\r\n         */\r\n        getLetterEditorIconsPath: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-letter-content-icons\");\r\n        },\r\n        /*\r\n         *   Executes a button action in the server\r\n         */\r\n        executeButton: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"buttonRule\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Executes a fileprint action in the server\r\n         */\r\n        getFilePrintUrl: function(params) {\r\n\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n        /*\r\n         *   Saves the content of the link form\r\n         */\r\n        saveLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            //return this.saveGridRecord(params);\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVEFORMLINKRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVEFORMLINKRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Rollbacks the link form edition\r\n         */\r\n        rollbackLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.rollbackGridAction(params);\r\n        },\r\n        /*   Commit the link form edition\r\n         */\r\n        commitLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.commitGridAction(params);\r\n        },\r\n        /*   Sends schekpoint action\r\n         */\r\n        sendCheckpoint: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.sendCheckpointAction(params);\r\n        },\r\n        /*\r\n         *   Loads the userfield definition\r\n         */\r\n        getUserfieldDefinition: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Check in deferreds cache\r\n            if (self.userfieldRequests[params.userfield])\r\n                return self.userfieldRequests[params.userfield];\r\n\r\n            // Required params: idCase\r\n            self.userfieldRequests[params.userfield] = $.read(self.serviceLocator.getUrl(\"render-userfield-definition\"),\r\n                {\r\n                    guidUserfield: params.userfield,\r\n                    device: (params.device || \"desktop\")\r\n                }\r\n            );\r\n\r\n            // Return deferred\r\n            return self.userfieldRequests[params.userfield];\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshControl: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESH\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"PARTIALREFRESH\"\r\n            });\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshGridCell: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESHGRIDCELL\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidcolumn\"] = params.column;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n            (params.typeRender) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"typeRender\"] = params.typeRender : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Request to execute rule on server\r\n         * @param {object} params h_pageCacheId, guidrule\r\n         */\r\n        executeRule: function(params) {\r\n            var self = this;\r\n\r\n\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTERULE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidrule\"] = params.rule || \"\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute interface on server\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeInterface: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEINTERFACE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidinterface\"] = params.interface || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute SAP Connecor\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeSAPConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTESAP\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidsap\"] = params.guidsap || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute a Bizagi connector\r\n         * @param params\r\n         * @return {{}}\r\n         */\r\n        executeConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTECONNECTOR\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidConnector\"] = params.guidConnector || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        generateDocumentTemplate: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            params.append = params.append ? params.append : false;\r\n\r\n            return $.create(\r\n                self.serviceLocator.getUrl(\"render-document-generate\"),\r\n                {\r\n                    h_pageCacheId: params.idPageCache,\r\n                    contextXpath: params.xpathcontext,\r\n                    groupMappingId: params.groupMapping,\r\n                    xpathAttribute: params.xpath,\r\n                    append: params.append,\r\n                    controlId: params.id\r\n                }\r\n            );\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        getAllDocumentsDownloadUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-document-generateAllDocuments\");\r\n            var data = {};\r\n            data[\"h_pageCacheId\"] = params.idPageCache;\r\n            data[\"contextXpath\"] = params.xpathContext;\r\n            data[\"xpathAttribute\"] = params.xpath;\r\n            data[\"idCase\"] = params.idCase;\r\n            data[\"idWorkItem\"] = params.idWorkItem;\r\n            data[\"p_sessionId\"] = params.sessionId;\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        },\r\n\r\n\r\n        getCaseNumber: function(params) {\r\n            var self = this;\r\n            //this function use sendEMail\r\n            //and not possible use dat ain ajax\r\n            //this is workaround (rhonyp)\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getCaseSummary\").replace(\"{idCase}\", params.idCase) + \"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice=\" + bizagi.isMobile(),\r\n                type: \"GET\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        getCaseAssignees: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Required params: idCase\r\n            return $.read(\r\n                self.serviceLocator.getUrl(\"case-handler-getCaseAssignees\"), {\r\n                    idCase: params.idCase\r\n                }\r\n            ).pipe(function(response) {\r\n                    return response;\r\n                });\r\n        },\r\n\r\n        getWorkitems: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"case-handler-getWorkItems\"), {\r\n                idCase: params.idCase,\r\n                onlyUserWorkItems: params.onlyUserWorkItems || \"\"\r\n            });\r\n        },\r\n        /*\r\n         *   Executes a grid export action in the server\r\n         */\r\n        getGridExportUrl: function(params) {\r\n\r\n            var self = this,\r\n                url = this.serviceLocator.getUrl(\"render-upload-data-url\"),\r\n                data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.exportType; //\"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         * Executes a send email action in the server\r\n         */\r\n        sendEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"sendEmail\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n\r\n            // Email parameters\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"to\"] = params.to;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"subject\"] = params.subject;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"message\"] = params.message;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"selected\"] = JSON.encode(params.selected);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            var url = params.url || self.serviceLocator.getUrl(\"form-get-data\");\r\n\r\n            return $.create(url, data);\r\n        },\r\n\r\n        /*\r\n         * Request to invalidates page cache in server, since it is no needed anymore\r\n         */\r\n        invalidatePageCache: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"INVALIDATEPAGECACHE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"INVALIDATEPAGECACHE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersList: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersList\"), params);\r\n        },\r\n        /*\r\n         * Search users for preferences usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListFromPreferences: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-FromPreferences\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users for Stakeholders\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListForStakeholders: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForStakeholders\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersForAssignation: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersForAssignation\"), params);\r\n        },\r\n\r\n        /**\r\n         * Get Users Creation/Edition Form\r\n         */\r\n        getUsersForm: function(params) {\r\n            var self = this;\r\n            return $.create(self.serviceLocator.getUrl(\"admin-usersform\"), params);\r\n        },\r\n        /**\r\n         *   Return generate Data To Send By Email\r\n         */\r\n        generateDataToSendByEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"GenerateDataToSendByEmail\",\r\n                idUser: params.idUser,\r\n                password: params.password\r\n            };\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-GenerateDataToSendByEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Return generate Send user password Mail\r\n         */\r\n        sendUserEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"SendUserEmail\",\r\n                emailTo: params.eMailTo,\r\n                subject: params.subject,\r\n                body: params.body\r\n            };\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-sendUserEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get bizagi configuration\r\n         * @param {Function}   type callback function when the file load is succed\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getConfiguration: function() {\r\n            var self = this;\r\n            var url = self.serviceLocator.getUrl(\"admin-users-config\");\r\n\r\n            return $.read(url);\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyPathToBase: function(pathToBase, url) {\r\n\r\n            if (url.indexOf(\"http\") != -1 && pathToBase != \"\") {\r\n                return url;\r\n            } else {\r\n                return pathToBase + url;\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * Get template of entity\r\n         * @param params { guid, prepare}\r\n         */\r\n        getTemplate: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADTEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = \"entity\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guid;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isProcessData\"] = params.forcePersonalizedColumns;\r\n\r\n            if (params.templateType) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templatetype\"] = params.templateType;\r\n            }\r\n\r\n            if (params.templateGuid) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templateguid\"] = params.templateGuid;\r\n            }\r\n\r\n            if (params.isDefaultTemplate != undefined) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isDefaultTemplate\"] = params.isDefaultTemplate;\r\n            }\r\n\r\n            // Fix device type since on mobility there are tablet_ios, tablet_android, smartphone_ios, smartphone_ios\r\n            // and the service recives either tablet or smartphone\r\n            var deviceType = bizagi.util.detectDevice();\r\n            if (bizagi.util.isTabletDevice()) {\r\n                deviceType = \"tablet\";\r\n            } else if (bizagi.util.isSmartphoneDevice()) {\r\n                deviceType = \"mobile\";\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = deviceType;\r\n\r\n            // When prepare is true just return data, this feature is used by multiaction service\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-get-data\"), data);\r\n        },\r\n\r\n        /**\r\n         * Chek if an entity has startform\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        hasStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            if (params.guidWFClass) {\r\n                data.guidWFClass = params.guidWFClass;\r\n            }\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"render-processes-startform\"), data);\r\n        },\r\n\r\n        /**\r\n         * Get the start form of the case\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADSTARTFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidprocess\"] = params.guidprocess;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = true;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idCase) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            }\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idWorkitem) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            }\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n            if (params.surrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.surrogatedKey;\r\n            }\r\n            if (params.recordXpath) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            }\r\n            if (params.mappingstakeholders) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"mappingstakeholders\"] = params.mappingstakeholders;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                cache: true\r\n            });\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editActionForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.pmaxitems) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxitems\"] = params.pmaxitems;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Execute actions or constructors\r\n         * @param params\r\n         */\r\n        executeActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend({}, params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.pguidConstructor) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidConstructor\"] = params.pguidConstructor;\r\n            }\r\n\r\n            if (params.pguidAction) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidAction\"] = params.pguidAction;\r\n            }\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getPolymorphicActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Make a JSON tree of polymorphic constructors categories\r\n         * @param values\r\n         * @return {Array}\r\n         */\r\n        serializePolymorphicActions: function(values) {\r\n            // json serializer\r\n            var actions = [];\r\n            var GUID_ENTITY = 0, DISPLAY_NAME = 1, XPATHCONTEXT = 2, TYPE = 3, GUID_OBJECT = 4, GUID_CONSTRUCTOR = 5, GUID_PARENT_ENTITY = 6;\r\n\r\n            /**\r\n             * Get children by guid of entity\r\n             * @param guid\r\n             * @return {Array}\r\n             */\r\n            var getChildren = function(guid) {\r\n                var children = [];\r\n                guid = guid || \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_PARENT_ENTITY] == guid) {\r\n                        children.push(value);\r\n                    }\r\n                });\r\n                return children;\r\n            };\r\n\r\n            /**\r\n             * Get parents by action object\r\n             * @param node\r\n             * @return {string}\r\n             */\r\n            var getParents = function(node) {\r\n                node = node || {};\r\n                var parents = \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_ENTITY] == node[GUID_PARENT_ENTITY]) {\r\n                        parents += getParents(value) + value[DISPLAY_NAME] + \" > \";\r\n                    }\r\n                });\r\n                return parents;\r\n            };\r\n\r\n\r\n            /**\r\n             * Make a tree of actions\r\n             * @param list\r\n             * @param guid\r\n             * @return {*}\r\n             */\r\n            var fillTree = function(list, guid) {\r\n                var node;\r\n                var children = getChildren(guid);\r\n                $.each(children, function(key, value) {\r\n                    var child = fillTree([], value[GUID_ENTITY]);\r\n                    node = {\r\n                        \"guidEntity\": value[GUID_ENTITY],\r\n                        \"displayName\": value[DISPLAY_NAME],\r\n                        \"hasConstructor\": (value[GUID_CONSTRUCTOR]) ? true : false,\r\n                        \"type\": value[TYPE],\r\n                        \"guidObject\": value[GUID_OBJECT],\r\n                        \"guidConstructor\": value[GUID_CONSTRUCTOR],\r\n                        \"xpathContext\": value[XPATHCONTEXT],\r\n                        \"children\": child,\r\n                        \"parents\": getParents(value)\r\n                    };\r\n                    if (node.guidConstructor !== \"\" || node.children.length > 0) {\r\n                        list.push(node);\r\n                    }\r\n                });\r\n\r\n                return list;\r\n            };\r\n            fillTree(actions, \"\");\r\n            return actions;\r\n        },\r\n\r\n        /**\r\n         * Gets the image for an entity xpath\r\n         * @param params\r\n         */\r\n        getEntityImage64: function(params) {\r\n            var self = this,\r\n                data = {\r\n                    width: params.data,\r\n                    height: params.height,\r\n                    xpath: params.xpath\r\n                },\r\n                url = self.serviceLocator.getUrl(\"render-entity-layout-image64\").replace(\"{entity}\", params.entity).replace(\"{surrogateKey}\", params.surrogateKey);\r\n\r\n            return $.ajax({\r\n                url: url,\r\n                data: data\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get data files when user access from my stuff, because there is no scope\r\n         */\r\n        getFilesDataForLayoutUploadControl: function(params) {\r\n            var self = this;\r\n            return $.read(self.serviceLocator.getUrl(\"render-entity-layout-upload-files\"), params);\r\n        },\r\n\r\n        /**\r\n         * Process an upload file into the server\r\n         * @param {} params\r\n         * @returns {}\r\n         */\r\n        processUploadFile: function(params) {                \r\n            return $.ajax({\r\n                url: this.verifyMobilePathToBase(bizagi.services.ajax.pathToBase || \"\", params.url),\r\n                data: params.formData,\r\n                type: \"POST\",\r\n                contentType: false,\r\n                processData: false\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Commit an add or edit request for a grid\r\n         * @param params\r\n         * @returns {*}\r\n         */\r\n        commitGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"COMMIT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-commit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"COMMIT\"\r\n            });\r\n        },\r\n        /*\r\n         *   Commit an add or edit request for a grid\r\n         */\r\n        sendCheckpointAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CHECKPOINT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending checkpoint request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-checkpoint-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"CHECKPOINT\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyMobilePathToBase: function(pathToBase, url) {\r\n            return bizagi.util.isSharepointContext() ? (url || \"\").replaceAll(pathToBase, \"\"): url;                \r\n        }\r\n\r\n    });\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\n$.Class.extend(\"bizagi.render.services.multiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (service) {\r\n        this.service = service;\r\n        this.serviceLocator = service.serviceLocator;\r\n\r\n        // Multiaction - batch stuff\r\n        this.batch = {};\r\n        this.batchTimer = 50;\r\n        this.circularDependencies = new bizagi.circularDependencies();\r\n\r\n        // Create proxyed version of methods\r\n        this.replicateServiceMethods();\r\n    },\r\n\r\n    /*\r\n    *   Returns the internal service\r\n    */\r\n    getService: function () {\r\n        return this.service;\r\n    },\r\n\r\n    /*\r\n    *   Create a proxied multiaction version for service calls\r\n    */\r\n    replicateServiceMethods: function () {\r\n        var self = this;\r\n        for (var key in this.service.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"multiaction\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ return this.proxyMethod(this.getService().' + key + ', arguments);};tmp');\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Perform the proxy call for each service method\r\n    */\r\n    proxyMethod: function (method, arguments) {\r\n        var service = this.service;\r\n\r\n        // Check if has only one argument, else execute directly\r\n        if (!arguments || arguments.length != 1) {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        // Check if the argument is object, else execute directly\r\n        if (typeof (arguments[0]) != \"object\") {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        var params = arguments[0];\r\n\r\n        // If the caller is requesting a prepare call, just execute the method with the current arguments\r\n        if (params.prepare == true) return method.apply(service, arguments);\r\n\r\n        // Prepare the ajax instead of sending it\r\n        params.prepare = true;\r\n        var action = method.apply(service, arguments);\r\n\r\n        return this.add(action);\r\n    },\r\n\r\n    /**\r\n    * This method make a standard error message\r\n    */\r\n    makeCircularDependenciesError: function (error) {\r\n        var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n        return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Add an action to be performed in a multiaction, and be resolved later\r\n    *   returns a deferred\r\n    */\r\n    add: function (action) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        var name = action.h_action || \"unnamed\";\r\n\r\n        // Put here all actions to ignore in circular dependencies\r\n        var exceptionActions = [\"PROCESSPROPERTYVALUE\", \"LOADTEMPLATE\", \"ADDRELATIONWITHDATA\"];\r\n\r\n        if (exceptionActions.indexOf(name) < 0 && bizagi.override.detectCircularDependencies) {\r\n            self.circularDependencies.addNode(name, action);\r\n        }\r\n\r\n        // First clear previous timeout\r\n        clearTimeout(self.batchTimeout);\r\n        var tag = action.tag = Math.guid();\r\n        var singleAction = { action: action, deferred: deferred };\r\n        self.batch[tag] = singleAction;\r\n\r\n        // Start a new timeout\r\n        self.batchTimeout = setTimeout(function () {\r\n            var resolveDependencies = self.circularDependencies.resolve();\r\n\r\n            if (resolveDependencies.error) {\r\n                // Reset Queue\r\n                for (var i in self.batch) {\r\n                    var message = resolveDependencies.error.multiactionError;\r\n                    self.batch[i].deferred.reject(message);\r\n                }\r\n                self.batch = {};\r\n            } else {\r\n                self.fire();\r\n            }\r\n        }, self.batchTimer);\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Fires up the multiaction\r\n    */\r\n    fire: function () {\r\n        var self = this;\r\n        var batch = {};\r\n\r\n        // Prepare actions and clone batch manually\r\n        var actions = [];\r\n        $.each(self.batch, function (tag, item) {\r\n            actions.push(item.action);\r\n            batch[tag] = item;\r\n        });\r\n\r\n        // Reset batch\r\n        self.batch = {};\r\n\r\n        // Fire ajax \r\n        $.when(self.execute({ actions: actions, rejectDeferreds: false }))\r\n                .done(function (responses) {\r\n\r\n                    // Process each response\r\n                    $.each(responses, function (i, response) {\r\n                        var tag = response.tag;\r\n                        if (!response.error) {\r\n                            batch[tag].deferred.resolve(response.result);\r\n                        } else {\r\n                            batch[tag].deferred.reject(response.error, response, response.error.message);\r\n                        }\r\n\r\n                        // Remove paired tag from collection\r\n                        delete batch[tag];\r\n                    });\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: \"Operation didn't executed\" }, '', \"Operation didn't executed\");\r\n                    });\r\n                }).fail(function (xhr, type, error) {\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    var errorMessage = typeof (error) !== \"undefined\" ? error.message : (error || \"Operation didn't executed\");\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: errorMessage }, '', \"Operation didn't executed\");\r\n                    });\r\n                });\r\n    },\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Einer Perez\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\nbizagi.render.services.multiactionservice.extend(\"bizagi.render.services.metadatamultiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"h_pageCacheId\"\r\n}, {\r\n\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            if (action[self.Class.BA_PAGE_CACHE]) {\r\n                data[self.Class.BA_PAGE_CACHE] = action[self.Class.BA_PAGE_CACHE];\r\n            }\r\n            delete action[self.Class.BA_PAGE_CACHE];\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action metadata\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction-metadata\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Command controller \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for action and validation controllers\r\n */\r\n\r\n$.Class.extend(\"bizagi.command.controllers.controller\", {\r\n    /* \r\n    *   Set to true in order to debug\r\n    */\r\n    THROW_ERROR: true\r\n\r\n}, {\r\n    /*  \r\n    *   Constructor\r\n    */ \r\n    init: function (form) {\r\n        this.form = form;\r\n        this.dateFormat = form.getResource(\"dateFormat\");\r\n    },\r\n    /*\r\n    *   Returns the condition in JS\r\n    */\r\n    buildConditions: function (conditions, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var operator = conditions.expressions && conditions.expressions.length > 1 ? self.buildConditionOperator(conditions.operator) : conditions.operator;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        //  Validate trtue and false conditions\r\n        if (operator == \"true\")\r\n            return \"true\";\r\n        if (operator == \"false\")\r\n            return \"false\";\r\n\r\n        var sJsCondition = \"\";\r\n\r\n        for (var i = 0; i < conditions.expressions.length; i++) {\r\n            var expression = conditions.expressions[i];\r\n\r\n            if (expression.simple) {\r\n                var bGDetected = self.searchGridReferenceInCondition(expression.simple);\r\n                sJsCondition += self.buildSimpleCondition(expression.simple, bGDetected, bCheckEditability);\r\n\r\n            } else if (expression.complex) {\r\n                sJsCondition += \"(\" + self.buildConditions(expression.complex, bGridDetected, bCheckEditability) + \") \";\r\n            }\r\n\r\n            // Adds operator\r\n            sJsCondition += (i < conditions.expressions.length - 1 ? operator : \"\");\r\n        }\r\n\r\n        return sJsCondition;\r\n    },\r\n    /*\r\n    *   Builds the condition operator\r\n    */\r\n    buildConditionOperator: function (conditionsOperator) {\r\n        if (conditionsOperator == \"and\")\r\n            return \" && \";\r\n        if (conditionsOperator == \"or\")\r\n            return \" || \";\r\n        return conditionsOperator;\r\n    },\r\n    /*\r\n    *   Builds a simple condition\r\n    */\r\n    buildSimpleCondition: function (condition, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var sXpath;\r\n        var xpath;\r\n        var sArgument = \"\";\r\n        var operator = condition.operator;\r\n        var ensureValueJs = \"\";\r\n        var ensureEditable = \"\";\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        // List of controls excluded to editability validation\r\n        // Just keep empty the value of element\r\n        var excludeEditabilityRule = { \"boolean\": \"\" };\r\n        var control = condition.xpath || condition.renderId;\r\n\r\n        var detectedArgumentType = self.detectConditionArgumentType(control, condition.argumentType);\r\n\r\n        // Build xpath\r\n        sXpath = self.buildXpath(control, detectedArgumentType, bGridDetected);\r\n        if (detectedArgumentType != \"boolean\") {\r\n            ensureValueJs += \"!bizagi.util.isEmpty(\" + sXpath + \") && \";\r\n        }\r\n\r\n        // Check if the render is editable, only when the parameter is provided\r\n        if (bCheckEditability && control && control.length > 0 && !excludeEditabilityRule.hasOwnProperty(detectedArgumentType)) {\r\n            ensureEditable = \"self.isVisible('\" + control + \"') && self.isEditable('\" + control + \"') && \";\r\n        }\r\n\r\n        // Build argument\r\n        if (!bizagi.util.isEmpty(condition.argument)) {\r\n            sArgument = self.buildArgument(condition.argument, detectedArgumentType, bGridDetected);\r\n\r\n            // If the argument is xpath it must be filled to for some operators\r\n            if (detectedArgumentType == \"xpath\") {\r\n                ensureValueJs += \"!bizagi.util.isEmpty(\" + sArgument + \") && \";\r\n            }\r\n\r\n        } else if (condition.argument === \"\") {\r\n            // Also check the case when the argument is empty\r\n            sArgument = \"\\\"\\\"\";\r\n        }\r\n\r\n        // Build condition\r\n\r\n        if (operator == \"includes\") {\r\n            return ensureEditable + ensureValueJs + \"self.includes(\" + sXpath + \",\" + sArgument + \") \";\r\n        }\r\n        //if (operator == \"changes\") return \"true\";\r\n        if (operator == \"changes\") {\r\n            return \"self.isChanged(\" + sXpath + \", params.changed)\";\r\n        }\r\n        if (operator == \"equals\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" == \" + sArgument;\r\n        if (operator == \"not-equals\")\r\n            return ensureEditable + sXpath + \" != \" + sArgument;\r\n        if (operator == \"less-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" < \" + sArgument;\r\n        if (operator == \"less-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" <= \" + sArgument;\r\n        if (operator == \"greater-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" > \" + sArgument;\r\n        if (operator == \"greater-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" >= \" + sArgument;\r\n        if (operator == \"like\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"is-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" == 0 || bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-not-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"!bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" != 0 && !bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-true\")\r\n            return ensureEditable + \"( \" + sXpath + \" == true || \" + sXpath + \" == 'true' )\";\r\n        if (operator == \"is-false\")\r\n            return ensureEditable + \"( \" + sXpath + \" == false || \" + sXpath + \" == 'false' || \" + sXpath + \" == 'False' )\";\r\n        if (operator == \"does-not-contain\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") < 0 \";\r\n        if (operator == \"contains\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == true \";\r\n        if (operator == \"does-not-begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == false \";\r\n        if (operator == \"file-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"file-not-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"!self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"is-invalid-email\")\r\n            return ensureEditable + \"!self.isValidEmail(\" + sXpath + \") \";\r\n        if (operator == \"letter-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"letter-not-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"cell-change\")\r\n            return \"column == \" + sArgument;\r\n\r\n        if (operator == \"on-press\") {\r\n            if (bGridDetected) {\r\n                var id = self.buildXpath(control, \"id\", bGridDetected);\r\n                return \"self.isGridButtonPressed(\" + id + \", params.pressed)\";\r\n            } else {\r\n                return \"self.isButtonPressed('\" + control + \"', params.pressed)\";\r\n            }\r\n        }\r\n\r\n        // ondelete behavior on grid control  \r\n        if (operator == 'on-deleted-row') {\r\n            xpath = control || \"\";\r\n            return \"self.onDeletedGridRow('\" + xpath + \"', params.rowDeleted)\";\r\n        }\r\n\r\n        // If there is another operator code throw exception\r\n        throw new \"There is no implementation for operator code \" + operator;\r\n    },\r\n    /*\r\n    *   Detects the argument type based on the render\r\n    */\r\n    detectConditionArgumentType: function (control, argumentType) {\r\n        var self = this;\r\n\r\n        if (argumentType === undefined || argumentType == \"const\") {\r\n\r\n            // Search render\r\n            var form = self.form;\r\n            var render = form.getRender(control) || form.getRenderById(control);\r\n\r\n            // Check if exists the render\r\n            if (render == null) {\r\n                throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n            }\r\n\r\n            // Check if the render is a grid\r\n            if (render.properties.type == \"grid\") {\r\n                var gridXpath = self.processGridXpath(control);\r\n\r\n                if (gridXpath.remainingXpath === \"\") {\r\n                    // The target is the grid\r\n                    return \"xpath\";\r\n                } else {\r\n                    render = render.getColumn(gridXpath.remainingXpath);\r\n                    if (render == null) {\r\n                        throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n                    }\r\n                }\r\n            }\r\n\r\n            var dataType = render.properties.dataType;\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n\r\n            if (self.isRelatedEntityRender(renderType)) {\r\n                return 'entity';\r\n            }\r\n\r\n            // Number\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 6 || dataType == 7 || dataType == 10 || dataType == 11) {\r\n                return 'number';\r\n            }\r\n\r\n            // Money\r\n            if (dataType == 8) {\r\n                return 'money';\r\n            }\r\n\r\n            // Date\r\n            if (dataType == 12 || dataType == 13) {\r\n                if (render.properties.showTime == true) {\r\n                    return 'datetime';\r\n                } else {\r\n                    return 'date';\r\n                }\r\n            }\r\n\r\n            // Boolean\r\n            if (dataType == 5) {\r\n                return 'boolean';\r\n            }\r\n\r\n            // Button\r\n            if (renderType == \"button\") {\r\n                return \"button\";\r\n            }\r\n\r\n            // Default\r\n            return 'text';\r\n\r\n        } else if (argumentType == \"xpath\" || argumentType == \"function\" || argumentType == \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        // Default return text\r\n        return 'text';\r\n    },\r\n    /*\r\n    *   Detects if a render type must be binded to a xpath with related entity\r\n    */\r\n    isRelatedEntityRender: function (renderType) {\r\n        return [\"combo\", \"list\", \"radio\", \"search\", \"searchCombo\", \"columnCombo\"].includes(renderType) || /^cascadingcombo$/i.test(renderType);\r\n    },\r\n\r\n    buildXpath: function (xpath, argumentType, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if (argumentType == 'xpath' && !bGridDetected) {\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + self.detectConditionArgumentType(xpath, \"const\") + \"')\";\r\n        } else if (argumentType == 'id') {\r\n            return \"'\" + xpath + \"'\";\r\n        } else if (argumentType == 'function') {\r\n            var xpathArgumentType = self.detectConditionArgumentType(xpath, \"const\");\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + xpathArgumentType + \"')\";\r\n        } else if (bGridDetected){\r\n            return \"self.evalGridXpath(params, '\" + xpath + \"', '\" + argumentType + \"')\";      \r\n        }\r\n\r\n        return \"self.evalXpath('\" + xpath + \"', '\" + argumentType + \"')\";\r\n    },\r\n    buildArgument: function (argument, argumentType, bGridDetected, xpathContext) {\r\n        var self = this;\r\n        var number;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        if (argumentType == 'text') {\r\n            // Text\r\n            argument = (argument == null) ? \"\" : argument;\r\n            argument = (typeof argument != 'string') ? argument.toString() : argument;\r\n            if (argument.indexOf(\"'\") != -1)\r\n                argument = argument.replaceAll(\"'\", \"\\\\'\");\r\n\r\n            // Remove line breaks because they will fail with the eval command\r\n            if (argument.indexOf(\"\\n\") != -1)\r\n                argument = argument.replaceAll(\"\\n\", \"\");\r\n\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'boolean') {\r\n            // Boolean\r\n            if (typeof (argument) == \"string\") {\r\n                return (eval(argument.toLowerCase()) == true ? \"true\" : \"false\");\r\n            } else {\r\n                return (eval(argument) == true ? \"true\" : \"false\");\r\n            }\r\n        }\r\n        if (argumentType == 'number') {\r\n            // Number\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'money') {\r\n            // MONEY\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'date') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument);\r\n            if (!date || date == 0)\r\n                date = new Date(0);\r\n\r\n            // Remove time\r\n            date.setHours(0, 0, 0, 0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date) + \"').getTime()\";\r\n        }\r\n        if (argumentType == 'datetime') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument, true);\r\n            if (!date || date == 0) {\r\n                date = new Date(0);\r\n            }\r\n            \r\n            date.setSeconds(0);\r\n            date.setMilliseconds(0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date, true) + \"', true).getTime()\";\r\n        }\r\n        if (argumentType == 'color') {\r\n            // Color\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'entity') {\r\n\r\n            if (bizagi.util.isEmpty(argument)) {\r\n                return null;\r\n            }\r\n            try {\r\n                argument = typeof (argument) != \"object\" ? JSON.parse(argument) : argument;\r\n            } catch (e) {\r\n                argument = argument || {};\r\n            }\r\n\r\n\r\n            // Entity value\r\n            var result = argument.id || argument;\r\n            return JSON.stringify(result);\r\n        }\r\n        if (argumentType == 'xpath') {\r\n            // Xpath value\r\n            var xpath = argument.toString();\r\n\r\n            // Process grid xpaths\r\n            if (bGridDetected) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n\r\n            if (xpathContext) {\r\n                xpath = xpathContext + \".\" + xpath;\r\n            }\r\n\r\n            return self.buildXpath(xpath, argumentType, bGridDetected);\r\n        }\r\n        if (argumentType == 'json') {\r\n            // Xpath value\r\n            return JSON.encode(argument);\r\n        }\r\n        if (argumentType == 'function') {\r\n            if (argument == \"BANow\") {\r\n                return \"self.getCurrentDate()\";\r\n            }\r\n            // If there is another function type code throw exception\r\n            throw \"There is no implementation for function \" + argument;\r\n        }\r\n\r\n        if (argumentType == undefined) {\r\n            return null;\r\n        }\r\n\r\n        // If there is another argument type code throw exception\r\n        throw \"There is no implementation for argument type \" + argumentType;\r\n    },\r\n    /*\r\n    *   Evals if an xpath is editable\r\n    */\r\n    isEditable: function (xpath) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return render.properties.editable;\r\n    },\r\n\r\n    isVisible: function (xpath) {\r\n        var self = this;\r\n\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (render.properties.visible) {\r\n            return self.isParentVisible(render.parent);\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n            if (/^hidden$/i.test(renderType)) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    isParentVisible: function (render) {\r\n        var self = this;\r\n        if (render.parent) {\r\n            if (render.properties.visible) {\r\n                return self.isParentVisible(render.parent);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else {\r\n            return render.properties.visible;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalGridXpath: function(params, xpath, argumentType) {\r\n        var self = this;\r\n        \r\n        if (params === undefined){\r\n            return this.evalXpath(xpath, argumentType);\r\n        }\r\n\r\n        var grid = params.grid;\r\n\r\n        if (grid === undefined || grid === null){\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;    \r\n        }\r\n\r\n        // Grid renders\r\n        var gridXpath = self.processGridXpath(xpath);\r\n\r\n        // Return the value\r\n        var gridColumn = grid.getColumn(gridXpath.remainingXpath);\r\n\r\n        if (!gridColumn) {\r\n            return false;\r\n            //throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n        var cellValue = grid.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n        if (gridColumn.properties.type == \"columnRadio\") {\r\n            if (cellValue) {\r\n                if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                    cellValue = cellValue[0][0];\r\n                else\r\n                    cellValue = cellValue.id;\r\n            }\r\n            else\r\n                cellValue = 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnCombo\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnSearch\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        // Parse empty values\r\n        if (bizagi.util.isEmpty(cellValue)) {\r\n            // If the render is a boolean return false for actions\r\n            if (argumentType == \"boolean\") {\r\n                if (gridColumn.properties.display == \"check\") {\r\n                    return false;\r\n                } else {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Parse boolean and non-empty date types\r\n        if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n            return eval(self.buildArgument(cellValue, argumentType));\r\n        }\r\n\r\n        if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n            cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n        return cellValue;\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalXpath: function (xpath, argumentType) {\r\n        var self = this, i, renderToEval;\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length === 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        i = 0;\r\n        while (i < rendersToEval.length) {\r\n            renderToEval = rendersToEval[i++];\r\n            var bIsGrid = (renderToEval.properties.type == 'grid');\r\n            if (!bIsGrid) {\r\n                // Normal renders\r\n                var value = renderToEval.getValue();\r\n                var renderType = bizagi.util.normalizeType(renderToEval.properties.type || \"\");\r\n\r\n                if (argumentType === undefined || argumentType === \"undefined\") {\r\n                    return value;\r\n                }\r\n\r\n                // If the render is a combo and the value is null return 0 for validations and actions\r\n                if ([\"combo\", \"list\", \"search\", \"radio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n                    if (bizagi.util.isEmpty(value) || value.id == \"\") {\r\n                        value = 0;\r\n                    }\r\n                }\r\n\r\n                if (renderType === \"comboSelected\") {\r\n                    return (typeof value === \"string\") ? JSON.parse(value).value : value;\r\n                }\r\n\r\n                if (bizagi.util.isEmpty(value)) {\r\n                    // If the render is a check and the value is null return false for validations and actions\r\n                    if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                        return false;\r\n                    }\r\n\r\n                    if (bizagi.util.isEmpty(value)) {\r\n                        // If the render is a check and the value is null return false for validations and actions\r\n                        if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                            return false;\r\n                        }\r\n                    }\r\n\r\n                    return value;\r\n                }\r\n\r\n                if (argumentType === \"xpath\") {\r\n                    return eval(self.buildArgument(xpath, argumentType));\r\n                } else {\r\n                    return eval(self.buildArgument(value, argumentType));\r\n                }                \r\n            } else {\r\n\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n\r\n                // Return the value\r\n                var gridColumn = renderToEval.getColumn(gridXpath.remainingXpath);\r\n\r\n                if (!gridColumn) {\r\n                    continue;\r\n                }\r\n\r\n                var cellValue = renderToEval.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n                if (gridColumn.properties.type == \"columnRadio\") {\r\n                    if (cellValue) {\r\n                        if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                            cellValue = cellValue[0][0];\r\n                        else\r\n                            cellValue = cellValue.id;\r\n                    }\r\n                    else\r\n                        cellValue = 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnCombo\") {\r\n                    cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnSearch\") {\r\n                    cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n                }\r\n\r\n                // Parse empty values\r\n                if (bizagi.util.isEmpty(cellValue)) {\r\n                    // If the render is a boolean return false for actions\r\n                    if (argumentType == \"boolean\") {\r\n                        if (gridColumn.properties.display == \"check\") {\r\n                            return false;\r\n                        } else {\r\n                            return null;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Parse boolean and non-empty date types\r\n                if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n                    return eval(self.buildArgument(cellValue, argumentType));\r\n                }\r\n\r\n                if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n                    cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n                return cellValue;\r\n            }\r\n\r\n            throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Check if the upload render has any files uploaded\r\n    */\r\n    isFileUploaded: function (xpath) {\r\n        var self = this;\r\n\r\n        var value = self.evalXpath(xpath);\r\n\r\n        if (value && value.length) {\r\n            if (value.length > 0)\r\n                return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *   Check if a render has a valid email value\r\n    */\r\n    isValidEmail: function (value) {\r\n        var regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/gi;\r\n        if (value && value.match(new RegExp(regex))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var render = this.getRenderById(control);\r\n        var renderType = bizagi.util.normalizeType(render.properties.type);\r\n        if (render === null || !/^button$/i.test(renderType)) return false;\r\n\r\n        return pressed;\r\n    },\r\n    /*\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isGridButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var arrGridXpath = this.processGridXpath(control);\r\n        var gridXpath = arrGridXpath.gridXpath;\r\n        var render = this.getRender(gridXpath);\r\n        var column = arrGridXpath.remainingXpath || \"\";\r\n\r\n\r\n        if (pressed && render && render.columns) {\r\n            $.each(render.columns, function (key, value) {\r\n                if ((value.properties.xpath === column || value.properties.id === column) && value.properties.type === \"columnButton\") {\r\n                    pressed = true;\r\n                }\r\n            });\r\n        }\r\n        return pressed;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has been changed\r\n    */\r\n    isChanged: function (value, isChanged) {\r\n        if (value === undefined || value === null) {\r\n            return false;\r\n        }\r\n        return isChanged;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has the item\r\n    */\r\n    includes: function (value, argument) {\r\n        if (typeof value == \"undefined\" || value === null) {\r\n            return false;\r\n        }\r\n        if (typeof argument == \"undefined\" || argument === null) {\r\n            return false;\r\n        }\r\n        var inArray = $.grep(value, function (e) {\r\n            return e.id == argument;\r\n        });\r\n        if (inArray.length > 0) {\r\n            return true;\r\n        }\r\n        return false\r\n    },\r\n\r\n    /**\r\n    *  Check if the grid has been deleted a row\r\n    */\r\n    onDeletedGridRow: function (xpath, rowDeleted) {\r\n        var self = this;\r\n        var grid = self.getRender(xpath) || {};\r\n\r\n        if (grid && rowDeleted) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Wrapper for get renders, return null if no renders have been found\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this,\r\n            form = self.form,\r\n            regex = /id=([\\w-]+)/gi;\r\n        var renders = null;\r\n\r\n        // Check if the xpath is an id\r\n        var idMatches = regex.exec(xpath);\r\n        if (idMatches && idMatches.length > 1) {\r\n            var render = self.getRenderById(idMatches[1]);\r\n            if (render) {\r\n                if (render.length == 0)\r\n                    return null;\r\n                else {\r\n                    renders = [];\r\n                    renders.push(render);\r\n                    return renders;\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n\r\n        }\r\n\r\n        renders = form.getRenders(xpath);\r\n        if (renders.length == 0)\r\n            return null;\r\n        return renders;\r\n    },\r\n    /*\r\n    *   Wrapper for get only one editable render\r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRender(xpath);\r\n    },\r\n    /*\r\n    *   Wrapper to get a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRenderById(id);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showRenderNotFoundError: function (xpath) {\r\n        bizagi.debug(\"Cannot find render in DOM: \" + xpath);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showContainerNotFoundError: function (containerId) {\r\n        bizagi.debug(\"Cannot find container in DOM: \" + containerId);\r\n    },\r\n    /*\r\n    *   Returns the current date\r\n    */\r\n    getCurrentDate: function () {\r\n        var currentDate = new Date();\r\n\r\n        // Remove time\r\n        currentDate.setHours(0, 0, 0, 0);\r\n        return currentDate;\r\n    },\r\n    /*\r\n    *   Return the grid xpath parts\r\n    */\r\n    processGridXpath: function (xpath) {\r\n\r\n        // Eval using regular expressions\r\n        var regex = new RegExp(/([\\w\\.]*)\\[(\\d*)\\]\\.([\\w\\.|\\w-\\.]*)/g);\r\n        var matches = regex.exec(xpath);\r\n        var index, remainingXpath, gridXpath;\r\n        if (matches) {\r\n            gridXpath = matches[1];\r\n            index = matches[2];\r\n            remainingXpath = matches[3];\r\n        } else {\r\n            index = \"\";\r\n            remainingXpath = \"\";\r\n        }\r\n\r\n        return { xpath: xpath, index: index, remainingXpath: remainingXpath, gridXpath: gridXpath };\r\n    },\r\n    /*\r\n    *   Check if an action/validation contains reference to a grid\r\n    */\r\n    searchForGridReference: function (conditions, commands) {\r\n        var self = this;\r\n        var i;\r\n        // Check in conditions\r\n        if (conditions) {\r\n            return self.searchGridReferenceInCondition(conditions);\r\n        }\r\n\r\n        // Check in commands\r\n        if (commands) {\r\n            for (i in commands) {\r\n                var command = commands[i];\r\n                return self.searchForGridReferenceInCommand(command);\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n     *   Check if an action/validation contains reference to a grid\r\n     */\r\n    searchForGridReferenceInCommand: function(command){\r\n        if (command.xpath && command.xpath.indexOf(\"[]\") > 0) {\r\n            return command.xpath.substring(0, command.xpath.indexOf(\"[]\"));\r\n        }\r\n\r\n        // Check in argument if argumentType is xpath\r\n        if (command.argumentType == 'xpath') {\r\n            if (command.argument.indexOf(\"[]\") > 0) {\r\n                return command.argument.substring(0, command.argument.indexOf(\"[]\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Check if a condition contains reference to a grid\r\n    */\r\n    searchGridReferenceInCondition: function (condition) {\r\n        var self = this;\r\n        var bGridReferenceFound;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            for (i in condition.expressions) {\r\n                if(condition.expressions.hasOwnProperty(i)) {\r\n                    bGridReferenceFound = self.searchGridReferenceInCondition(condition.expressions[i]);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n                }\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridReferenceInCondition(condition.simple);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridReferenceInCondition(condition.complex);\r\n        } else {\r\n            // Looking for grid reference within xpath\r\n            if (condition.xpath || condition.renderId) {\r\n                // Check in condition.xpath\r\n                bGridReferenceFound = self.searchGridReferenceInXpath(condition.xpath) || self.searchGridReferenceInXpath(condition.renderId);\r\n                if (bGridReferenceFound)\r\n                    return bGridReferenceFound;\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType == 'xpath') {\r\n                    bGridReferenceFound = self.searchGridReferenceInXpath(condition.argument);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n    *   Check if a xpath contains a grid reference\r\n    */\r\n    searchGridReferenceInXpath: function (xpath) {\r\n        // Check in condition.xpath\r\n        if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n            return xpath.substring(0, xpath.indexOf(\"[]\"));\r\n        }\r\n        return null;\r\n    },\r\n    getGridControl: function (xpath, surrogateKey) {\r\n        var self = this;\r\n        var remainingXpath = self.processGridXpath(xpath).remainingXpath;\r\n        var grid = self.getRender(xpath);\r\n        var column = grid.getControlCell(surrogateKey, remainingXpath);\r\n\r\n        return column;\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.validation\", {}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, validations, mainForm) {\r\n        var self = this;\r\n\r\n        // Enable evalValidation function with console log trace\r\n        self.enableDebug = false;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        var container = mainForm != undefined ? mainForm.container : form.container;\r\n\r\n        var validationBox = $('<div />').appendTo(container);\r\n\r\n        //Notifies that a modal view appear/disappear\r\n        $.widget( \"ui.bizagi_notifications\", $.ui.bizagi_notifications, {\r\n            expand: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            collapse: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            },\r\n            hide: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n\r\n        // Apply plugin\r\n        validationBox.bizagi_notifications({\r\n            itemIcon: \"ui-icon-circle-close\",\r\n            minimized: false,\r\n            clearEnabled: false,\r\n            title: form.getResource(\"render-form-validations-header-text\"),\r\n            device: bizagi.util.detectDevice(),\r\n            orientation: form.properties.orientation\r\n\r\n        });\r\n\r\n        // Bind click\r\n        validationBox.bind(\"itemClick\", function (e, ui) {\r\n            self.onNotificationClick(ui.data);\r\n        });\r\n\r\n        // Build validations\r\n        if (validations)\r\n            self.buildValidations(validations);\r\n\r\n        // Keep references\r\n        self.validationBox = validationBox;\r\n        self.validations = validations || [];\r\n    },\r\n\r\n\r\n    /* \r\n    *   Method to incorporate automatic validation rules \r\n    */\r\n    buildValidations: function (validations) {\r\n        var self = this;\r\n        var fnValidations = self.buildAllValidations(validations);\r\n\t\r\n        self.form.bind(\"rendervalidate\", function () {\r\n            return fnValidations(self);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple error message in the validation box\r\n    */\r\n    showErrorMessage: function (message) {\r\n        bizagi.showErrorAlertDialog = false;\r\n        this.showValidationMessage(message, null, \"ui-icon-circle-close\", \"ui-state-error\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple alert message in the validation box\r\n    */\r\n    showAlertMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-alert\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple info message in the validation box\r\n    */\r\n    showInfoMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-info\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple validation message in the validation box\r\n    */\r\n    showValidationMessage: function (message, focus, icon, itemAdditionalClass, type, renderId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var render = null;\r\n\r\n        if (renderId) {\r\n            render = form.getRenderById(renderId) || null;\r\n        } else {\r\n            render = focus ? form.getRender(focus) : null;\r\n        }\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n\r\n        // Method to perform validations after the render has been changed, or the notifications has been clicked\r\n        var performValidationFn = function () {\r\n            // First hide and clear validation box\r\n            self.clearValidationMessages();\r\n\r\n            // Run validations\r\n            self.validating = true;\r\n            self.performValidations();\r\n            self.validating = false;\r\n\r\n            // Attempt to hide if there are no validations\r\n            if (self.countValidationMessages() == 0) {\r\n                self.hideValidationMessages();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            } else {\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            }\r\n\r\n            form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n        };\r\n\r\n        // Add message\r\n        self.validationBox.bizagi_notifications(\"addNotification\", message, focus, icon, itemAdditionalClass, performValidationFn, type, renderId);\r\n\r\n        if (render) {\r\n            // Add error message to render\r\n            render.setValidationMessage(message);\r\n\r\n            if (!bizagi.util.isIE8()) {\r\n\r\n                // Bind event when render change\r\n                if (!self.validating) render.one(\"rendervalidate\", performValidationFn);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Count the number of validation messages\r\n    */\r\n    countValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"count\");\r\n    },\r\n\r\n    /*\r\n    *   Remove all the validations\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var validationsBoxes = $(\".ui-bizagi-notifications-container\", \"body\").not(\".ui-bizagi-log-container\");\r\n\r\n        return validationsBoxes.bizagi_notifications(\"clearAll\", undefined, params);\r\n    },\r\n\r\n    /*\r\n    *   Hide the validation notifications box\r\n    */\r\n    hideValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"hide\");\r\n    },\r\n\r\n    /*\r\n    *   Show the validation notifications box\r\n    */\r\n    showValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"show\");\r\n    },\r\n\r\n    /*\r\n    *   Expand the notification box\r\n    */\r\n    expandNotificationBox: function (autofocus) {\r\n        // Select first error and expand notifications\r\n        if (autofocus !== false) this.validationBox.bizagi_notifications(\"autoFocusFirstError\");\r\n        return this.validationBox.bizagi_notifications(\"expand\");\r\n    },\r\n\r\n    isExpandedNotificationBox: function(){        \r\n        return this.validationBox.bizagi_notifications(\"isExpanded\") && this.validationBox.bizagi_notifications(\"isContentVisible\");\r\n    },\r\n\r\n    /*\r\n    *   Run all validation rules in the form container\r\n    */\r\n    performValidations: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.clearValidationMessages();\r\n        self.validationBox.bizagi_notifications(\"initBatch\");\r\n\r\n        // Run render validations\r\n        var bRendersValid = self.validateRenders(invalidElements);\r\n\r\n        // Run form validations\r\n        var bFormValid = self.validations.length > 0 ? self.form.triggerHandler(\"rendervalidate\") : true;\r\n        self.validationBox.bizagi_notifications(\"endBatch\");\r\n\r\n        // Show validations if invalid\r\n        if (!bFormValid || !bRendersValid) {\r\n            self.validationBox.bizagi_notifications(\"show\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /* PRIVATE METHODS */\r\n\r\n    /*  \r\n    *   Construct validations javascript rules\r\n    */\r\n    buildAllValidations: function (validations) {\r\n        var self = this;\r\n        var sJSCode = \"\";\r\n\r\n        for (var i = 0; i < validations.length; i++) {\r\n\r\n            var isEnabled = (validations[i].enabled != undefined ) ? validations[i].enabled : true;\r\n            if (isEnabled)\r\n            {\r\n                // If validation is not \"valid\" we can omit that instruction\r\n                try { sJSCode += self.buildValidation(validations[i].conditions, validations[i].validationCommand); } catch (e) {\r\n                    if (e.message != \"RenderNotFoundException\") {\r\n                        bizagi.logError(\"Validation cannot be parsed: \" + e.message, validations[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build final function\r\n        var sStatement = \"var baTmpFn = function(self, params){\\r\\n var bValid = true;\\r\\n \" + sJSCode + \"\\r\\n return bValid;}; baTmpFn\";\r\n\r\n        // Return interpreted function\r\n        return self.evalValidation(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   Build a single javascript validation rule\r\n    */\r\n    buildValidation: function (conditions, validationCommand) {\r\n        var self = this;\r\n        var sJsCondition = \"\";\r\n        var sJsValidation = \"\";\r\n\r\n        // Detect grid references\r\n        var gridReference = self.searchForGridReference(conditions);\r\n        var bGridDetected = (gridReference != null);\r\n\r\n        // Build Conditions\r\n        sJsCondition += \"( \" + self.buildConditions(conditions, bGridDetected, true) + \" )\";\r\n\r\n        // Fix message for quotes and break lines\r\n        validationCommand.message = validationCommand.message.replace(/'/g, \"\\\\'\");\r\n        validationCommand.message = validationCommand.message.replace(/\\n/g, \" \");\r\n        \r\n        // Build Message\r\n        var focus = validationCommand.focus || \"\";\r\n        if (bGridDetected) focus = gridReference;\r\n        if (validationCommand.tokens)\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"', JSON.parse('\" + JSON.encode(validationCommand.tokens) + \"')); bValid = false;\\r\\n\";\r\n        else\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"'); bValid = false;\\r\\n\";\r\n\r\n        // Build final statement\r\n        if (!bGridDetected) {\r\n\r\n\r\n            return \"if (\" + sJsCondition + \"){\\r\\n \" + sJsValidation + \" \\r\\n}\";\r\n        } else {\r\n            var sGridStatement = \"var grid = self.form.getRender('\" + gridReference + \"');\\r\\n\";\r\n            sGridStatement += \"if(grid === null) return true;\\r\\n\";\r\n            sGridStatement += \"var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"var bGridValid = true;\\r\\n\";\r\n            sGridStatement += \"$.each(data, function(_, i) {\\r\\n\";\r\n            sGridStatement += \"if (\" + sJsCondition + \"){\\r\\n bGridValid = false; \\r\\n}\";\r\n            sGridStatement += \"});\\r\\n\";\r\n            sGridStatement += \"if (bGridValid == false){\\r\\n \" + sJsValidation + \"\\r\\n}\";\r\n            return sGridStatement;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method triggered when the validation item has been clicked\r\n    */\r\n    onNotificationClick: function (data) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var xpath = data.focus;\r\n        var renderId = data.id;\r\n\r\n        if (xpath) {\r\n            var render = renderId ? form.getRenderById(renderId) : form.getRender(xpath);\r\n\r\n            if (render) {\r\n                render.focus();\r\n            }\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method to loop\r\n    */\r\n    validateRenders: function (invalidElements) {\r\n        var self = this;\r\n        invalidElements = invalidElements || [];\r\n\r\n        // Do a check\r\n        var bValid = self.form.isValid(invalidElements);\r\n        if (!bValid) {\r\n            invalidElements.forEach(function(element){\r\n                if( element.id ) {\r\n                    // Parameters: message, xpath, icon, itemAdditionalClass, type, renderId\r\n                    self.showValidationMessageById(element.message, element.xpath, element.id);\r\n                } else if (element.message || element.xpath) {\r\n                    self.showValidationMessage(element.message, element.xpath);\r\n                }\r\n            });            \r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n    *\tEval validation string, for debug purposes\r\n    */\r\n    evalValidation: function (command) {\r\n        var self = this;\r\n\r\n        if (self.enableDebug && console != undefined) {\r\n            console.log(command);\r\n        }\r\n\r\n        return eval(command);\r\n    },\r\n\r\n    /**\r\n     * Method to add a simple validation message in the validation box\r\n     * @param message\r\n     * @param xpath\r\n     * @param renderId\r\n     */\r\n    showValidationMessageById: function (message, xpath, renderId) {\r\n        this.showValidationMessage(message, xpath, undefined, false, undefined, renderId);\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.action\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, actions) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        // Set a new hash containing all the dependencies subscribing the events\r\n        self.globalDependencies = {};\r\n        self.initialCallFunctions = {};\r\n        self.initialCallFunctionsDeferred = new $.Deferred();\r\n\r\n        // Build actions\r\n        if (actions)\r\n            self.buildActions(actions);\r\n\r\n        // Keep references\r\n        self.actions = actions;\r\n        self.internalSubmitActions = {};\r\n\r\n        // Set initial timer to trigger initial functions using a setTimeout, and distributing them in differente timespans\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallIncrements = 25;\r\n        self.actionsHistory = {};\r\n        self.period = 50;\r\n    },\r\n    /*\r\n    *   Adds an internal submit action to be executed with all the given rules\r\n    */\r\n    processInternalSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n\r\n        // if the action is registered, don't add it again\r\n        // only one internal submit action is allowed per control\r\n        if (self.internalSubmitActions[xpath])\r\n            return;\r\n\r\n        // Add to hash and build it\r\n        self.internalSubmitActions[xpath] = action;\r\n        self.buildAction(action, true);\r\n    },\r\n\r\n    isSummaryOrGlobalForm: function () {\r\n        var self = this;\r\n        var result = false;\r\n\r\n        if (self.form.properties.typeForm === \"SummaryForm\" || self.form.properties.typeForm === \"GlobalForm\") result = true;\r\n        return result;\r\n    },\r\n\r\n    evalClientAction: function (action) {\r\n        var self = this, i = 0, serverCommand = false, command;\r\n        var commands = [].concat(action.commands, action.elseCommands);\r\n        var length = commands.length;\r\n\r\n        for (; i < length; i++) {\r\n            command = commands[i];\r\n            if (!self.isClientAction(command)) {\r\n                serverCommand = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (serverCommand) {\r\n            action.enabled = false;\r\n        }\r\n    },\r\n\r\n    /* Process all given  actions*/\r\n    buildActions: function (actions, dontExecute) {\r\n        var self = this, i, len;\r\n        var hashes = {};\r\n\r\n        var executeOnlyClientActions = self.isSummaryOrGlobalForm();\r\n\r\n        for (i = 0, len = actions.length; i < len; i++) {\r\n            // If action is not \"valid\" we can omit that instruction\r\n            try {\r\n                var action = actions[i];\r\n                var hash = bizagi.util.md5(JSON.stringify(action.conditions));\r\n                var hashC = bizagi.util.md5(JSON.stringify(action.commands));\r\n                if (hashes[hash]) {\r\n                    if (hashes[hash].indexOf(hashC) === -1) {\r\n                        // si la condicion es igual y los comandos diferentes\r\n                        executeOnlyClientActions && self.evalClientAction(action);\r\n                        self.buildAction(action, dontExecute);\r\n                        hashes[hash].push(hashC);\r\n                    }\r\n                } else {\r\n                    executeOnlyClientActions && self.evalClientAction(action);\r\n                    self.buildAction(action, dontExecute);\r\n                    hashes[hash] = [hashC];\r\n                }\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, actions[i]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Remove all current handlers\r\n    */\r\n    unbindActions: function () {\r\n        var self = this;\r\n\r\n        // Remove all previous handlers\r\n        $.each(self.globalDependencies, function (i, render) {\r\n            render.unbind(\"renderchange.action\");\r\n        });\r\n\r\n        self.globalDependencies = {};\r\n\r\n        // Reset timers and collections\r\n        $.each(self.initialCallFunctions, function (i, handle) {\r\n            clearTimeout(handle);\r\n        });\r\n        self.initialCallFunctions = {};\r\n    },\r\n    /* \r\n    *   Re-execute actions, cleaning the handlers first\r\n    */\r\n    refreshActions: function (newActions) {\r\n        var self = this;\r\n\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallFunctions = {};\r\n\r\n        newActions = newActions || [];\r\n\r\n        // Build the actions again\r\n        self.actions = self.actions.concat(newActions);\r\n        self.buildActions(self.actions, true);\r\n\r\n        // Build internal actions again\r\n        $.each(self.internalSubmitActions, function (_, action) {\r\n            try {\r\n                self.buildAction(action, false);\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, action);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* Process a single action*/\r\n    buildAction: function (action, dontExecute) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var dependencies = [];\r\n        var dependenciesId = [];\r\n\r\n        var isEnabled = (action.enabled != undefined) ? action.enabled : true;\r\n\r\n        if (!isEnabled) return;\r\n\r\n        // If the condition operator is true, we gotta dig in the actions to check if it modifies a grid\r\n        // To include an auto-dependency, so each time the grid is changed that condition will be executed\r\n        if (action.conditions && action.conditions.operator == \"true\") {\r\n            if (!action.dependencies)\r\n                action.dependencies = [];\r\n            $.each(action.commands, function (_, command) {\r\n                var gridReference = self.searchGridReferenceInXpath(command.xpath);\r\n                if (gridReference) {\r\n                    var dependencyAlreadyAdded = false, j, len;\r\n                    for (j = 0, len = action.dependencies; j < len; j++) {\r\n                        if (action.dependencies[j] == gridReference)\r\n                            dependencyAlreadyAdded = true;\r\n                    }\r\n                    if (!dependencyAlreadyAdded)\r\n                        action.dependencies.push(gridReference);\r\n                }\r\n            });\r\n        }\r\n\r\n        function isValidDependency(type) {\r\n            var notValid = [\"groupedgrid\", \"collectionnavigator\"];\r\n            if (notValid.indexOf(type) === -1) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n\r\n        // Find dependencies to attach triggers\r\n        if (action.dependencies) {\r\n            for (var i = 0; i < action.dependencies.length; i++) {\r\n                if (typeof action.dependencies[i] != \"undefined\") {\r\n                    var renders = form.getRenders(action.dependencies[i]);\r\n                    if (renders.length === 0) {\r\n                        var renderById = form.getRenderById(action.dependencies[i]);\r\n                        renders = (renderById) ? [renderById] : null;\r\n                    }\r\n\r\n                    if (renders) {\r\n                        $.each(renders, function (_, render) {\r\n                            if ($.inArray(render.properties.id, dependenciesId) < 0) {\r\n                                if (isValidDependency(render.properties.type)) {\r\n                                    dependenciesId.push(render.properties.id);\r\n                                    dependencies.push(render);\r\n                                }\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build anonymous function\r\n        var fn = self.buildFunction(action.conditions, action.commands, action.elseCommands);\r\n\r\n        // Attach handlers\r\n        $.each(dependencies, function (_, render) {\r\n            render.bind(\"renderchange.action\", function (ev, args) {\r\n                args = args || {};\r\n\r\n                // Default changed argument to true\r\n                args.changed = args.changed !== undefined ? args.changed : true;\r\n\r\n                // If a grid action has been performed, try to filter it by column, to avoid execute all grid actions each time                \r\n                if (args.column) {\r\n                    for (var j = 0; j < action.gridColumns.length; j++) {\r\n                        if (args.column == action.gridColumns[j]) {\r\n                            // Call function\r\n                            fn(self, args);\r\n                            return;\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Call function\r\n                    fn(self, args);\r\n                }\r\n            });\r\n\r\n            // Add to global dependencies hash\r\n            self.globalDependencies[render.properties.id] = render;\r\n\r\n            // If render is a grid ... trigger function at this point\r\n            if (render.properties.type === 'grid') {\r\n                dontExecute = true;\r\n\r\n                // Search column dependencies\r\n                action.gridColumns = [];\r\n                self.searchGridColumns(action.conditions, action.gridColumns);\r\n            }\r\n        });\r\n\r\n        // Check if it has to execute\r\n        if (dontExecute)\r\n            return;\r\n\r\n        // Execute the action because it must execute when the page loads with pre-defined value\r\n        // Create an async function to trigger it later\r\n        var asyncFn = function (self) {\r\n\r\n            var guid = Math.guid();\r\n            // Create the timeout\r\n            var handle = setTimeout(function () {\r\n                try {\r\n                    // TODO: Define render to set parameter to \"fn\" function\r\n                    fn(self);\r\n                    delete self.initialCallFunctions[guid];\r\n                } catch (e) {\r\n                }\r\n            }, self.initialCallTimeout);\r\n\r\n            // Save a reference\r\n            self.initialCallFunctions[guid] = handle;\r\n            self.initialCallTimeout += self.initialCallIncrements;\r\n        };\r\n\r\n        // Run it\r\n        asyncFn(self);\r\n    },\r\n    /*\r\n    * Creates the function to execute based on the action metadata\r\n    */\r\n    buildFunction: function (conditions, commands, elseCommands) {\r\n        var self = this;\r\n\r\n        var gridReference = self.searchForGridReference(conditions, commands);\r\n        var bGridDetected = (gridReference != null) ? gridReference : false;\r\n        var sJsCondition = \"\";\r\n        var sJsAction = \"\";\r\n        var sStatement;\r\n        var sJsElseAction = \"\";\r\n        var bAutomaticRestore = elseCommands ? false : true;\r\n        var bCondition = conditions ? true : false;\r\n        var i;\r\n\r\n        // Build Condition\r\n        if (bCondition) {\r\n            sJsCondition += self.buildConditions(conditions, bGridDetected);\r\n        }\r\n\r\n        // Build and execute actions\r\n        for (i = 0; i < commands.length; i++) {\r\n            // Parse command\r\n            var queueAction = self.isServerCommand(commands[i]) ? \"addParallel\" : \"add\";\r\n            var command = self.buildCommand(commands[i], bGridDetected);\r\n\r\n            // Check if command ending with semicolon and remove it\r\n            command = (command.indexOf(\";\") >= 1) ? command.replace(\";\", \"\") : command;\r\n            sJsAction += \"actionQueue.\" + queueAction + \"(function(){return \" + command + \" ;}); \\r\\n\";\r\n\r\n            if (bAutomaticRestore) {\r\n                sJsElseAction += self.buildRestoreCommand(commands[i], bGridDetected);\r\n            }\r\n        }\r\n\r\n        // Build non-automatic else commands\r\n        if (!bAutomaticRestore) {\r\n            sJsElseAction += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n            sJsElseAction += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n            for (i = 0; i < elseCommands.length; i++) {\r\n                var queueAction = self.isServerCommand(elseCommands[i]) ? \"addParallel\" : \"add\";\r\n                var elseCommand = self.buildCommand(elseCommands[i], bGridDetected);\r\n                // Check if command ending with semicolon and remove it\r\n                elseCommand = (elseCommand.indexOf(\";\") >= 1) ? elseCommand.replace(\";\", \"\") : elseCommand;\r\n                sJsElseAction += \"actionQueue.\" + queueAction + \"(function(){return \" + elseCommand + \" ;}); \\r\\n\";\r\n            }\r\n            sJsElseAction += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n            sJsElseAction += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n            sJsElseAction += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n        }\r\n\r\n        // Build final function\r\n        //sStatement = \"var baTmpFn = function(self, i, column){ \\r\\n\";\r\n        sStatement = \"var baTmpFn = function(self, params){ \\r\\n\";\r\n        sStatement += \"params = params || {};\\r\\n\";\r\n        if (bGridDetected) {\r\n            sStatement += \"var i = params.key;\\r\\n\";\r\n            sStatement += \"var column = params.column;\\r\\n\";\r\n        }\r\n        if (bCondition) {\r\n            sStatement += \"if (\" + sJsCondition + \"){ \\r\\n\";\r\n        }\r\n\r\n        // Creates defferreds\r\n        sStatement += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n        sStatement += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n        sStatement += sJsAction;\r\n        sStatement += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n        sStatement += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n        sStatement += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n\r\n        if (bCondition) {\r\n            sStatement += \"\\r\\n } \";\r\n            if (sJsElseAction.length > 0) {\r\n                sStatement += \"else { \\r\\n\" + sJsElseAction + \" }\\r\\n\";\r\n            }\r\n        }\r\n\r\n        sStatement += \"};\\r\\n\";\r\n\r\n\r\n        if (!bGridDetected) {\r\n            sStatement += \"baTmpFn\";\r\n        } else {\r\n            var sGridStatement = \"var baGridTmpFn = function(self, args){ \\r\\n\";\r\n            sGridStatement += \"args = args || {};\\r\\n\";\r\n            sGridStatement += \"\\t var grid = args.render || self.form.getRender('\" + gridReference + \"') || []; \\r\\n\";\r\n            sGridStatement += \"\\t grid = grid.grid ? grid : (self.form.getRender('\" + gridReference + \"') || []); \\r\\n\";\r\n            sGridStatement += \"\\t args.grid = grid; \\r\\n\";\r\n            sGridStatement += \"if(args.surrogateKey === undefined){\\r\\n\";\r\n            sGridStatement += \"\\t var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"\\t $.each(data, function(i, index) {\\r\\n\";\r\n            sGridStatement += \"\\t\\t args.key = index; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args);\\r\\n\";\r\n            sGridStatement += \"\\t });\\r\\n\";\r\n            sGridStatement += \"} else {\\r\\n\";\r\n            sGridStatement += \"\\t args.key = args.surrogateKey; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args ); \\r\\n\";\r\n            sGridStatement += \"}\\r\\n\";\r\n            sGridStatement += \"};\\r\\n\";\r\n            sStatement += sGridStatement;\r\n            sStatement += \"baGridTmpFn\";\r\n        }\r\n\r\n        // Return interpreted function\r\n        return eval(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   This method checks if a command must be performed by the client, or by the server\r\n    */\r\n    isServerCommand: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"refresh\", \"submit-data\", \"execute-rule\", \"execute-interface\", \"execute-sap\", \"execute-connector\", \"execute-excel-bot\"].includes(commandType);\r\n    },\r\n\r\n    isClientAction: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"background-color\", \"forecolor\", \"visible\", \"required\", \"collapse\", \"set-active\"].includes(commandType);\r\n    },\r\n\r\n    isRecentAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        if (self.actionsHistory[tag] != null) {\r\n            return true;\r\n        }\r\n        $.when(self.runAction(prefix, command)).done(function () {\r\n            delete self.actionsHistory[tag];\r\n            bizagi.log(\"resolve \" + tag);\r\n        });\r\n        return false;\r\n    },\r\n\r\n    runAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        self.actionsHistory[tag] = new $.Deferred();\r\n        setTimeout(self.actionsHistory[tag].resolve, self.period);\r\n        return self.actionsHistory[tag].promise();\r\n    },\r\n    /*\r\n    *   Builds the action JS\r\n    */\r\n    buildCommand: function (command, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        var gridReference = bGridDetected;\r\n\r\n        // Parse argument\r\n        var commandType = command.command;\r\n        var detectedArgumentType = self.detectCommandArgumentType(command.argumentType, commandType);\r\n        var argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected, command.xpathContext);\r\n        var xpath = command.xpath;\r\n\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected && xpath) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if ((command.xpath && command.xpath.length > 0) || (command.renderId && command.renderId.length > 0)) {\r\n            // Build render command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'forecolor':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'visible':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'readonly':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'required':\r\n                    return \"self.changeRenderRequired('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-value':\r\n                    // Check specific argument type\r\n                    if (bGridDetected && command.argumentType === \"xpath\" && !!command.xpathContext) {\r\n                        // When we are going to evaluate a xpath is necessary add a xpathcontext if it exist\r\n                        command.argument = command.xpathContext + \".\" + command.argument;\r\n                        argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected);\r\n                    }\r\n\r\n                    return \"self.changeRenderValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-min':\r\n                    return \"self.changeRenderMinValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-max':\r\n                    return \"self.changeRenderMaxValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'calculate':\r\n                    return \"self.executeCalculatedField('\" + xpath + \"');\";\r\n                    break;\r\n                case 'submit-value':\r\n                    return \"self.submitRender('\" + xpath + \"', '\" + argument + \"');\";\r\n                    break;\r\n                case 'clean-data':\r\n                    return \"self.cleanRenderData('\" + xpath + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    var commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n\r\n                    if (commandGridDetected) {\r\n                        return \"self.refreshGridCell('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    } else {\r\n                        return \"self.refreshControl('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"','\" + commandType + \"');\";\r\n                    }\r\n                    break;\r\n                case 'trigger-click':\r\n                    return \"self.triggerClick('\" + xpath + \"');\";\r\n                    break;\r\n\r\n            }\r\n        } else {\r\n            // Build container command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    return \"self.changeContainerBackground('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'visible':\r\n                    return \"self.changeContainerVisibility('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'collapse':\r\n                    return \"self.toogleContainer('\" + command.container + \"', \" + !bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n                case 'set-active':\r\n                    return \"self.changeActiveItem('\" + command.container + \"');\";\r\n                    break;\r\n                case 'readonly':\r\n                    return \"self.changeContainerEditability('\" + command.container + \"', \" + bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    // Set prepare parameter to multiaction purposes \r\n                    return \"self.refreshContainer('\" + command.container + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    break;\r\n            }\r\n        }\r\n\r\n        // Global  actions without specific target\r\n        if (commandType === 'submit-data') {\r\n            return \"self.submitFormData();\";\r\n        }\r\n\r\n        if (commandType === 'execute-rule') {\r\n            var ruleObj = command.argument || {};\r\n            var guidRule = \"\";\r\n            try {\r\n                guidRule = JSON.parse(ruleObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            var xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                var xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeRule('\" + guidRule + \"', printf('\" + xpathContextRow + \"',i) ,'\" + commandType + \"');\";\r\n            } else {\r\n                return \"self.executeRule('\" + guidRule + \"','\" + xpathContext + \"','\" + commandType + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-interface') {\r\n            var interfaceObj = command.argument || {};\r\n            var guidInterface = \"\";\r\n\r\n            try {\r\n                guidInterface = JSON.parse(interfaceObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeInterface('\" + guidInterface + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeInterface('\" + guidInterface + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-sap') {\r\n            var connectorObj = command.argument || {};\r\n            var guidsap = \"\";\r\n\r\n            try {\r\n                guidsap = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeSAPConnector('\" + guidsap + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeSAPConnector('\" + guidsap + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-connector' || commandType === 'execute-excel-bot') {\r\n            var connectorObj = command.argument || {};\r\n            var guidConnector = \"\";\r\n\r\n            try {\r\n                guidConnector = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeConnector('\" + guidConnector + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeConnector('\" + guidConnector + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return \"\";\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore automatically a command when condition is not met\r\n    */\r\n    buildRestoreCommand: function (command, bGridDetected) {\r\n        var xpath = command.xpath;\r\n        var commandType = command.command;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        // Build restore action\r\n        if (xpath && xpath.length > 0) {\r\n            return \"self.restoreRender('\" + xpath + \"', '\" + commandType + \"');\";\r\n        } else {\r\n            return \"self.restoreContainer('\" + command.container + \"', '\" + commandType + \"');\";\r\n        }\r\n    },\r\n    /* \r\n    *   Detect the command argument type based on the command type\r\n    */\r\n    detectCommandArgumentType: function (argumentType, commandType) {\r\n        if (argumentType === undefined) {\r\n            return argumentType;\r\n\r\n        } else if (argumentType == \"const\") {\r\n\r\n            if (commandType == 'background-color')\r\n                return 'color';\r\n            if (commandType == 'forecolor')\r\n                return 'color';\r\n            if (commandType == 'visible')\r\n                return 'boolean';\r\n            if (commandType == 'readonly')\r\n                return 'boolean';\r\n            if (commandType == 'required')\r\n                return 'boolean';\r\n            if (commandType == 'set-value')\r\n                return 'text';\r\n            if (commandType == 'collapse')\r\n                return 'boolean';\r\n            if (commandType == 'set-active')\r\n                return 'number';\r\n            if (commandType == 'set-min')\r\n                return 'text';\r\n            if (commandType == 'set-max')\r\n                return 'text';\r\n            if (commandType == 'calculate')\r\n                return undefined;\r\n            if (commandType == 'refresh')\r\n                return undefined;\r\n            if (commandType == 'submit-value')\r\n                return 'json';\r\n\r\n        } else if (argumentType === \"xpath\" || argumentType === \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return null;\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a render when condition is not met\r\n    */\r\n    restoreRender: function (xpath, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            var properties = render.originalProperties;\r\n            var textFormat = properties.textFormat || {};\r\n            if (commandType == 'background-color')\r\n                self.changeRenderBackground(xpath, textFormat.background || '');\r\n            if (commandType == 'forecolor')\r\n                self.changeRenderForeground(xpath, textFormat.color || 'none');\r\n            if (commandType == 'visible')\r\n                self.changeRenderVisibility(xpath, properties.visible != undefined ? properties.visible : true);\r\n            if (commandType == 'readonly')\r\n                self.changeRenderEditability(xpath, properties.editable != undefined ? properties.editable : true);\r\n            if (commandType == 'required')\r\n                self.changeRenderRequired(xpath, properties.required != undefined ? properties.required : false);\r\n            // NOte: Command 6 does not have restoration\r\n        });\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a container when condition is not met\r\n    */\r\n    restoreContainer: function (containerId, commandType) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        var properties = container.originalProperties;\r\n        if (commandType == 'background-color')\r\n            self.changeContainerBackground(containerId, properties.backgroundColor || 'none');\r\n        if (commandType == 'visible')\r\n            self.changeContainerVisibility(containerId, properties.visible != undefined ? properties.visible : true);\r\n        if (commandType == 'collapse')\r\n            self.toogleContainer(containerId, true);\r\n        // NOte: Command 8 does not have restoration\r\n        if (commandType == 'readonly')\r\n            self.changeContainerEditability(containerId, properties.editable != undefined ? properties.editable : true);\r\n    },\r\n    /* \r\n    *   Sets a new color for the background of the render\r\n    *   Applies also to grid cells!\r\n    */\r\n    changeRenderBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeBackgroundColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellBackgroundColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellBackgroundColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the background of the button\r\n     *   Applies also to grid cells!\r\n     */\r\n    changeButtonBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n\r\n        element.css(\"background-image\", \"none\");\r\n        element.addClass(\"ui-fast-transition\");\r\n\r\n        if (typeof (element[0]) !== \"undefined\") {\r\n            element[0].style.setProperty(\"background-color\", argument, \"important\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Sets a new color for the foreground of the render\r\n    */\r\n    changeRenderForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the foreground of the render\r\n     */\r\n    changeButtonForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.css(\"color\", argument, \"!important\");\r\n    },\r\n    /* \r\n    *   Changes the visibility of the render\r\n    */\r\n    changeRenderVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.changeVisibility(argument);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellVisibility(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellVisibility(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Changes the visibility of the button\r\n     */\r\n    changeButtonVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.show();\r\n            element.css(\"display\", \"\");\r\n        } else {\r\n            element.hide();\r\n        }\r\n    },\r\n    /* \r\n    *   Changes the editability of the render\r\n    */\r\n    changeRenderEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeEditability(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellEditability(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellEditability(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the editability of the button\r\n     */\r\n    changeButtonEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.removeAttr(\"disabled\");\r\n        } else {\r\n            element.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n    /*\r\n     *  trigger Click button\r\n     */\r\n    triggerClick: function (xpath) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.trigger(\"click\");\r\n    },\r\n\r\n    /* \r\n    *   Changes the required value of the render\r\n    */\r\n    changeRenderRequired: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var rendersToEval = [];\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            if (bizagi.util.parseBoolean(render.properties.editable)) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        if (rendersToEval.length === 0) {\r\n            rendersToEval = renders;\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeRequired(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellRequired(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellRequired(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render internal value\r\n    */\r\n    changeRenderValue: function (xpath, argument) {\r\n        var self = this;\r\n\r\n        if (argument != null && typeof argument === \"object\" ){\r\n            argument = $.extend(argument, {fromAction: true});\r\n        }\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    if (render.asyncRenderDeferred) {\r\n                        $.when(render.asyncRenderDeferred).done(function () {\r\n                            render.setDisplayValue(argument);\r\n                        });\r\n                    } else {\r\n                        render.setDisplayValue(argument);\r\n                    }\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render minimum value\r\n    */\r\n    changeRenderMinValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    var renderType = render.properties.type;\r\n                    if (renderType === \"number\" || renderType === \"date\" || renderType === \"money\") {\r\n                        render.changeMinValue(argument);\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMinValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMinValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    changeRenderMaxValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeMaxValue(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMaxValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMaxValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    executeCalculatedField: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            $.when(render.ready()).done(function () {\r\n                render.runFormula();\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshControl: function (xpath, xpathContext, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n        var queue = new bizagiQueue();\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process matching renders\r\n        $.each(renders, function (i, render) {\r\n            queue.add(render.ready().pipe(function () {\r\n                return render.refreshControl({xpath: xpath, xpathContext: xpathContext});\r\n            }));\r\n        });\r\n\r\n        // Return queue deferred\r\n        return queue.execute();\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshContainer: function (containerId, xpathContext) {\r\n        var self = this;\r\n        var container = self.form.getContainer(containerId);\r\n\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return $.when(container.ready())\r\n            .pipe(function () {\r\n                return container.refreshContainer({xpathContext: xpathContext});\r\n            });\r\n    },\r\n    /**\r\n     * Refresh a cell of grid\r\n     */\r\n    refreshGridCell: function (xpath, xpathContext) {\r\n        var self = this;\r\n        var queue = new bizagiQueue();\r\n        var def = new $.Deferred();\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            });\r\n        }\r\n\r\n        if (rendersToEval.length === 0) {\r\n            return;\r\n        }\r\n\r\n        // Check xpathContext of the form (addForm or editForm)\r\n        if (self.form && self.form.properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? self.form.properties.xpathContext + \".\" + xpathContext : self.form.properties.xpathContext;\r\n        }\r\n\r\n        queue.add(def.promise());\r\n\r\n        $.when.apply($, $.map(rendersToEval, function (grid) {\r\n            grid.ready();\r\n        }))\r\n            .done(function () {\r\n                var len = rendersToEval.length;\r\n                var internalQueue = new bizagiQueue();\r\n                for (var i = 0; i < len; i++) {\r\n                    var grid = rendersToEval[i];\r\n\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        // Process a specific row\r\n                        internalQueue.add(grid.refreshCell({\r\n                            key: gridXpath.index,\r\n                            column: gridXpath.remainingXpath,\r\n                            xpathContext: xpathContext\r\n                        }));\r\n                    } else {\r\n                        // Process all rows\r\n                        var indexes = grid.getIndexes();\r\n                        var lenIndex = indexes.length;\r\n                        for (var j = 0; j < lenIndex; j++) {\r\n                            internalQueue.addParallel(grid.refreshCell({\r\n                                key: indexes[j],\r\n                                column: gridXpath.remainingXpath,\r\n                                xpathContext: xpathContext\r\n                            }));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $.when(internalQueue.execute())\r\n                    .done(function () {\r\n                        def.resolve();\r\n                    });\r\n            });\r\n\r\n\r\n        return queue.execute();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitFormData: function (params) {\r\n        var self = this;\r\n\r\n        // For the submit action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.submitData(params);\r\n            });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (rule, xpathContext, commandType) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n        var prefix = rule + \".\" + xpathContext;\r\n        if (self.isRecentAction(prefix, commandType)) {\r\n            return;\r\n        } else {\r\n            // Process the action\r\n            return $.when(form.ready())\r\n                .pipe(function () {\r\n                    return form.executeRule({rule: rule, xpathContext: xpathContext});\r\n                });\r\n        }\r\n    },\r\n    executeInterface: function (interface, xpathContext) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.executeInterface({interface: interface, xpathContext: xpathContext});\r\n            });\r\n    },\r\n\r\n\r\n    executeSAPConnector: function (guidsap, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeSAPConnector({guidsap: guidsap, xpathContext: xpathContext});\r\n        });\r\n    },\r\n\r\n    executeConnector: function (guidConnector, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeConnector({guidConnector: guidConnector, xpathContext: xpathContext});\r\n        });\r\n    },\r\n    /*\r\n    *   Submit the given render and refresh dependencies after that\r\n    */\r\n    submitRender: function (xpath, argument) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process the action in the render\r\n        return $.when(render.ready()).pipe(function () {\r\n            return render.submitOnChange();\r\n        });\r\n    },\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanRenderData: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.cleanData();\r\n                        self.changeRenderRequired(xpath, render.properties.required != undefined ? render.properties.required : false);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.cleanCellData(gridXpath.index, gridXpath.remainingXpath);\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.cleanCellData(indexes[j], gridXpath.remainingXpath);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container background color\r\n    */\r\n    changeContainerBackground: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeBackgroundColor(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Shows or hides a container\r\n    */\r\n    changeContainerVisibility: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready(true)).done(function () {\r\n            $.when(container.renderingDeferred).done(function () {\r\n                container.changeVisibility(argument);\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Expand or collapse a group container\r\n    */\r\n    toogleContainer: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type !== \"group\")\r\n            return;\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.toogleContainer(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Select a determinate sub-container in a tab or an accordion\r\n    */\r\n    changeActiveItem: function (containerId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type === \"tabItem\" && container.loadingDeferred) {\r\n            container.loadingDeferred.resolve();\r\n        }\r\n        $.when(container.ready()).done(function () {\r\n            container.setAsActiveContainer();\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container editability\r\n    */\r\n    changeContainerEditability: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeEditability(argument);\r\n        });\r\n    },\r\n    /*\r\n    *   Search for grid columns\r\n    */\r\n    searchGridColumns: function (condition, gridColumns) {\r\n        var self = this;\r\n        var column;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            var j, lenIndex;\r\n            for (j = 0, lenIndex = condition.expressions.length; j < lenIndex; j++) {\r\n                self.searchGridColumns(condition.expressions[j], gridColumns);\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridColumns(condition.simple, gridColumns);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridColumns(condition.complex, gridColumns);\r\n        } else {\r\n            var xpath = condition.xpath || condition.renderId;\r\n            if (xpath) {\r\n                // Check in condition.xpath\r\n                if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n                    column = xpath.substring(xpath.indexOf(\"[]\") + 3);\r\n                    gridColumns.push(column);\r\n                }\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType === 'xpath') {\r\n                    if (condition.argument.indexOf(\"[]\") > 0) {\r\n                        column = condition.argument.substring(condition.argument.indexOf(\"[]\") + 3);\r\n                        gridColumns.push(column);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /**/\r\n\r\n    isGridComponent: function (render, xpath) {\r\n        var renderType = bizagi.util.normalizeType(render.properties.type);\r\n        return (/^grid$/i.test(renderType) && xpath.indexOf('[') >= 0);\r\n    },\r\n    /**/\r\n\r\n    isValidRender: function (render) {\r\n        var notValid = [\"collectionnavigator\"];\r\n\r\n        return notValid.indexOf(render.properties.type) === -1;\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability. TODO: Apply to mobile with formButtons\r\n     * @param {} xpath\r\n     * @param {} status\r\n     * @returns {}\r\n     */\r\n    changeFormButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n        var navigation = form.getNavigation();\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n});","/*\r\n*   Name: BizAgi Element Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class with common stuff related to all renders and containers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.element\", {\r\n    ELEMENT_TYPE_CONTAINER: 1,\r\n    ELEMENT_TYPE_RENDER: 2,\r\n    ELEMENT_TYPE_COLUMN: 3\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Set render factory\r\n        this.renderFactory = params.renderFactory;\r\n\r\n        // Set data service\r\n        this.dataService = params.dataService;\r\n\r\n        // Set reference to parent\r\n        this.parent = params.parent;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set the observable element\r\n        this.observableElement = $(\"<div />\");\r\n\r\n        // Set the dispose flag\r\n        this.disposed = false;\r\n\r\n        // Update data\r\n        this.initializeData(params.data);\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Set the internal data\r\n        this.properties = {};\r\n        if (data && data.properties) this.properties = data.properties;\r\n\r\n        // Set xpath context\r\n        this.properties.xpathContext = this.getXpathContext();\r\n\r\n        // Set page cache\r\n        this.properties.idPageCache = this.getPageCache();\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        // By default return parent's xpath context\r\n        // This method is overriden in form container which contains the real xpath context\r\n\r\n        return (this.parent != undefined && typeof this.parent.getXpathContext == \"function\") ? this.parent.getXpathContext() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache for the current element\r\n    */\r\n    getPageCache: function () {\r\n        // By default return parent's page cache\r\n        // This method is overriden in form container which contains the real page cache\r\n\r\n        return (this.parent != undefined && typeof this.parent.getPageCache == \"function\") ? this.parent.getPageCache() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        // By default return parent's form container\r\n        // This method is overriden in form container which returns itself\r\n        if (typeof (this.parent) != \"undefined\")\r\n        return this.parent.getFormContainer();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the mapped resource\r\n    */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () { },\r\n\r\n    /* \r\n    *   Resizes the element \r\n    */\r\n    resize: function (size) {\r\n\r\n    },\r\n\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function () {\r\n\r\n        if (this.properties.required) {\r\n            var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n            // Check if element is visible into scroll\r\n            if (!bizagi.util.isScrolledIntoView(this.element, layout)) {\r\n                $(this.element).attr('tabindex', -1).focus();\r\n            }\r\n            if (this.element) {\r\n                this.element.effect('highlight', 2000);\r\n            }\r\n        }\r\n\r\n        //Check if the element has parent\r\n        if (this.parent && typeof this.parent.focus == 'function') {\r\n            this.parent.focus();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.parent) return this.parent.triggerGlobalHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.trigger(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.triggerHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.bind(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Un-binds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.unbind(eventType, fn);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds a one time event\r\n    */\r\n    one: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.one(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () { },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        if (this.parent) return this.parent.getMode();\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering params\r\n    */\r\n    getParams: function () {\r\n        if (this.parent) return this.parent.getParams();\r\n    },\r\n\r\n    /*\r\n    * Get current form type (ex. queryform, form)\r\n    */\r\n    getFormType: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        return form.properties.type || \"form\";\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () { },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () { },\r\n\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n        self.disposed = true;\r\n\r\n        setTimeout(function () {\r\n            if (self.subscribers != null) {\r\n                // Remove all subcriptions\r\n                $.each(self.subscribers, function (i, item) {\r\n                    self.unbind(item.event);\r\n                });\r\n            }\r\n            delete self.subscribers;\r\n\r\n            if (self.observableElement) self.observableElement.off();\r\n            bizagi.util.dispose(self);\r\n        }, bizagi.override.disposeTime || 50);\r\n    },\r\n\r\n    /*\r\n    *   Check if the current object is disposed\r\n    */\r\n    isDisposed: function () {\r\n        return this.disposed;\r\n    },\r\n\r\n    /*\r\n    *   This method process the error or alert messages coming from the server, and adds them to the validation controller\r\n    */\r\n    processFailMessage: function(message) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (message.errorType === \"CustomMessageException\") {\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            var error = bizagi.localization.getResource(message.message);\r\n            form.validationController.showErrorMessage(error);\r\n        } else if (message.errorType === \"InvalidCaseStateException\") {\r\n            var params = form.getParams()\r\n\r\n            form.validationController.clearValidationMessages();\r\n           \r\n            // Redirection Here\r\n            form.container.trigger(\"routing\", { idCase: params.idCase || bizagi.context.idCase });\r\n        } else {\r\n            var message = message || {};\r\n            message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n            var type = message.type || \"error\";\r\n            var code = message.code || \"code\";\r\n            message = message.responseText || (message.message || message);\r\n\r\n            // Omit processing when the ajax didn't process\r\n            if (type === \"not-processed\") return;\r\n            if (type === \"not-shown\") return;\r\n            if (isOfflineForm && code === \"AUTH_ERROR\") return;\r\n\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            if (type == \"alert\") {\r\n                form.validationController.showAlertMessage(message);\r\n            } else {\r\n                form.validationController.showErrorMessage(message);\r\n            }\r\n        }\r\n\r\n        return message;\r\n    },\r\n\r\n    /*\r\n    *   Sets a waiting overlay above the current element\r\n    */\r\n    startLoading: function () {  /* Override in implementations */ },\r\n\r\n    /*\r\n    *   Removes the waiting overlay\r\n    */\r\n    endLoading: function () { /* Override in implementations */ },\r\n\r\n    /**\r\n    *   Prepare control to remove it from the render, that allows to\r\n    *   clean all elements of the control or to do any stuff before to remove\r\n    */\r\n    beforeToRefresh: function () { /* Implement in each render and container if you need */ },\r\n\r\n    /**\r\n    *   Run before that the control has been refreshed\r\n    */\r\n    afterToRefresh: function () { /* Implement in each render and container if you need */ }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base container class with common stuff related to all containers\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.container\", {\r\n    TYPE_QUERY_FORM: \"queryForm\"\r\n}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n\r\n        if (data.elements) {\r\n            $.each(data.elements, function(i, element) {\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                } else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                } else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates a render element\r\n    */\r\n    createRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalElement;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.render.properties.editable = properties.editable;\r\n            if (element.render.properties.type == \"grid\")\r\n                element.render.properties.inlineEdit = false;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.render.properties.required = properties.required;\r\n        }\r\n\r\n        //clone originalElement to apply duplicate render properties correctly\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            originalElement = bizagi.clone(element);\r\n        }\r\n\r\n        var render = self.renderFactory.getRender({\r\n            type: element.render.properties.type,\r\n            data: element.render,\r\n            dataService: self.dataService,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Add to children\r\n        self.children.push(render);\r\n\r\n        // Check for duplicate\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            self.processDuplicateRender(render, originalElement);\r\n        }\r\n\r\n        //TODO: at this point not posible add the retype double at this point not exist input\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(render);\r\n    },\r\n    /*\r\n    *   Creates a container element\r\n    */\r\n    createContainerElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.container.properties.required = properties.required;\r\n        }\r\n\r\n        var container = self.renderFactory.getContainer({\r\n            type: element.container.properties.type,\r\n            data: element.container,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode(),\r\n            isDesign: self.getMode() === \"design\"\r\n        });\r\n\r\n        self.children.push(container);\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(container);\r\n    },\r\n    /*\r\n    *   Creates a form element\r\n    */\r\n    createFormElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        var form = self.renderFactory.getContainer({\r\n            type: (element.form.properties.type || \"form\"),\r\n            data: element.form,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode()\r\n        });\r\n        self.children.push(form);\r\n    },\r\n    /* \r\n    *   Gets the current container \r\n    */\r\n    getElement: function () {\r\n        var self = this;\r\n        return self.container;\r\n    },\r\n    /* \r\n    *   Gets a collection for all elements matching a type \r\n    */\r\n    getElementsByType: function (type, elements) {\r\n        elements = elements || [];\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.type == type) {\r\n                elements.push(child);\r\n            }\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.getElementsByType(type, elements);\r\n            }\r\n        });\r\n\r\n        return elements;\r\n    },\r\n    /*\r\n    *   Process renders with duplicate property\r\n    */\r\n    processDuplicateRender: function (render, element) {\r\n        var self = this;\r\n        var clonedElement = JSON.parse(JSON.encode(element.render));\r\n\r\n        // Changes properties\r\n        clonedElement.properties.displayName = clonedElement.properties.displayName + \" \" + self.getResource(\"render-text-duplicate-label-sufix\");\r\n        clonedElement.properties.xpath = clonedElement.properties.xpath + \".clone\";\r\n        clonedElement.properties.isClone = true;\r\n\r\n        // Creates clone\r\n        var clone = self.renderFactory.getRender({\r\n            type: clonedElement.properties.type,\r\n            data: clonedElement,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Associates with main render\r\n        render.cloneRender = clone;\r\n\r\n        // Add to collection\r\n        self.children.push(clone);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_CONTAINER;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    render: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            result;\r\n\r\n        // Render container\r\n        result = self.internalRender();\r\n\r\n        // Apply container defaults\r\n        self.applyContainerDefaults();\r\n\r\n        // Add container id\r\n        result.attr(\"data-container-id\", self.properties.id);\r\n\r\n        //Add container tag property\r\n        if (self.properties.tag) {\r\n            result.attr(\"data-tag\", self.properties.tag);\r\n        }\r\n\r\n        //Add class to the requested form, to specify if is add form, edit form, or detail form\r\n        if (self.params)\r\n            if (self.params.requestedForm)\r\n                result.addClass(self.params.requestedForm);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Internal  rendering\r\n    */\r\n    internalRender: function () {\r\n        var self = this;\r\n\r\n        // Render the container\r\n        var html = self.renderContainerHtml();\r\n\r\n        // Convert html string to jquery object\r\n        var container = self.container = $(html);\r\n\r\n        // Post-render\r\n        self.postRenderContainer(container);\r\n\r\n        return self.container;\r\n    },\r\n    /*\r\n    *   Renders container html\r\n    */\r\n    renderContainerHtml: function () {\r\n        var self = this;\r\n        // Start rendering deferred\r\n        self.renderingDeferred = self.renderingDeferred || new $.Deferred();\r\n\r\n        return this.renderContainer();\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred)\r\n            return false;\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.container))\r\n            alert(\"container hasn't been rendered!\");\r\n\r\n        return this.container;\r\n    },\r\n    /* \r\n    *   Set container defaults\r\n    */\r\n    applyContainerDefaults: function () {\r\n        var self = this,\r\n                properties = self.properties;\r\n\r\n        // Set customizations\r\n        if (properties.backgroundColor)\r\n            self.changeBackgroundColor(properties.backgroundColor);\r\n\r\n        // Set editability and visiblity\r\n        if (!properties.visible)\r\n            self.changeVisibility(properties.visible);\r\n    },\r\n    /* \r\n    *  Changes background color \r\n    */\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.backgroundColor = color;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeBackgroundColor(color);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeBackgroundColor(color);\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        // Hide - show the render\r\n        if (properties.visible) {\r\n            self.container.show();\r\n\r\n        } else {\r\n            self.container.hide();\r\n        }\r\n    },\r\n    /* Changes editability */\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeEditability(argument);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeEditability(argument);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Replaces a <x/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceTag: function (container, tag, replace) {\r\n        bizagi.util.replaceSelector(container, tag, replace);\r\n    },\r\n    /*\r\n    *   Replaces a <children/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceChildrenTag: function (container, replace) {\r\n        this.replaceTag(container, \".children\", replace);\r\n    },\r\n    /*\r\n    *   Replaces a {{children}} string in the specified element\r\n    */\r\n    replaceChildrenHtml: function (html, replace) {\r\n        return html.replace(\"{{children}}\", replace);\r\n    },\r\n    /*\r\n    *   Template method to render the container layout, returns a string with all the builded html,\r\n    *   must be overriden in all children\r\n    */\r\n    renderContainer: function () {\r\n    },\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred)\r\n            self.renderingDeferred.resolve();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        self.executeChildrenPostRender(container);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n            self.applyPlaceHolderPolyfill();\r\n\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    applyPlaceHolderPolyfill: function () {\r\n        var self = this;\r\n        var config = window.placeHolderConfig || {};\r\n        if (('placeholder' in $('<input>')[0] || 'placeHolder' in $('<input>')[0]) && !config.forceApply) {\r\n            // don't run the polyfill when the browser has native support\r\n            return;\r\n        }\r\n        Placeholders.enable();\r\n    },\r\n    /*\r\n    *   Process container children\r\n    */\r\n    executeChildrenPostRender: function (container) {\r\n        var self = this;\r\n        var childrenElements = container.children();\r\n\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                        child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                        child.postRenderContainer(childElement);\r\n                }\r\n            } else {\r\n                self.executeChildrenPostRender(childElement);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n\r\n    },\r\n    /**\r\n    *   Renders all children html\r\n    */\r\n    renderChildrenHtml: function () {\r\n        var self = this;\r\n        var temp = \"\";\r\n\r\n        $.each(self.children, function (i, child) {\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                temp += child.renderElement();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                temp += child.renderContainerHtml();\r\n            self.childrenHash[child.properties.uniqueId] = child;\r\n        });\r\n\r\n        return temp;\r\n    },\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    */\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.collectRenderValues(renderValues);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Check if the render can be sent to the server\r\n                    if (child.canBeSent()) {\r\n                        child.collectData(renderValues);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders and check if has changed\r\n    */\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        result = result || [];\r\n\r\n        if (!result.length) {\r\n            if(self.children){\r\n                $.each(self.children, function (i, child) {\r\n                    if (result.length || child.hasChanged(result)) {\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            return result;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *    Creates a json array parameters to search result\r\n    */\r\n    collectRenderValuesQueryForm: function (renderValues) {\r\n        var self = this;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValuesQueryForm(renderValues);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSentQueryForm()) {\r\n                    child.collectDataQueryForm(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Gets the first child\r\n    */\r\n    firstChild: function () {\r\n        return this.children[0];\r\n    },\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath, renders) {\r\n        var self = this;\r\n\r\n        renders = renders || [];\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath.indexOf(\"[\") > 0) {\r\n            xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n        }\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.getRenders(xpath, renders);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (xpath == child.properties.xpath) {\r\n                    renders.push(child);\r\n                }\r\n            }\r\n        });\r\n\r\n        return renders;\r\n    },\r\n    /* \r\n    *   Gets the first editable render \r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var result = null;\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                if (result == null)\r\n                    result = render;\r\n            }\r\n        });\r\n\r\n        // if no render has been found, skip editable condition\r\n        if (result == null) {\r\n            $.each(renders, function (i, render) {\r\n                result = render;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Gets all renders by xpath\r\n     */\r\n    getRendersByXpath: function (xpath) {\r\n        var self = this;\r\n        return self.getRenders(xpath);\r\n    },\r\n\r\n    /* \r\n    *   Gets a container by the id\r\n    */\r\n    getContainer: function (id) {\r\n        var self = this;\r\n\r\n        if (self.properties.id == id)\r\n            return this;\r\n\r\n        var result;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                var o = child.getContainer(id);\r\n                if (o != null) {\r\n                    result = o;\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n    /* \r\n    *   Validate all renders in the container \r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.isValid(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n\r\n        /*\r\n       *   Validate all grids in the container\r\n       */\r\n    hasValidGrids: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.hasValidGrids(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER && typeof (child.grid) != \"undefined\") {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n        var childrenPromises = $.map(self.children, function (child) {\r\n            return child.isReadyToSave();\r\n        });\r\n        return $.when.apply($, childrenPromises);\r\n    },\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                var result = child.getFocus();\r\n                if (!bizagi.util.isEmpty(result)) {\r\n                    focus = result;\r\n                }\r\n            }\r\n        });\r\n\r\n        return focus;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n    },\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        setTimeout(function () {\r\n            if (self.children) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current container\r\n    */\r\n    refreshContainer: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (data) {\r\n\r\n            if (!self.isDisposed()) {\r\n\r\n                // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n                self.unregisterChildren();\r\n                delete self.children;\r\n                delete self.childrenHash;\r\n\r\n                self.getFormContainer().removeActions();\r\n\r\n                // update editable\r\n                if (self.properties.editable === false) {\r\n                    data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n                }\r\n\r\n                // Update the data\r\n                self.initializeData(data.container);\r\n\r\n                // Render the container again\r\n                var currentContainer = self.container;\r\n                var result = self.render();\r\n\r\n                if (self.properties.type == \"tabItem\") {\r\n                    $(result).addClass(\"childrenActive\");\r\n                }\r\n\r\n                currentContainer.replaceWith(result);\r\n\r\n                // Rebind the actions\r\n                var actions = data.container && data.container.actions ? data.container.actions : [];\r\n                self.getFormContainer().refreshActions(actions);\r\n\r\n                self.triggerChildrenActions();\r\n\r\n                // Execute personalized stuff after to refresh it\r\n                self.afterToRefresh();\r\n\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the current container\r\n     */\r\n    refreshDesignContainer: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh(data);\r\n        //self.setActiveTab(data.elements);\r\n\r\n        $.extend(data.properties, {\r\n            editable: properties.editable,\r\n            contexttype: (properties.contexttype || \"\"),\r\n            idPageCache: properties.idPageCache,\r\n            idRender: properties.id,\r\n            messageValidation: properties.messageValidation,\r\n            uniqueId: properties.uniqueId,\r\n            visible:properties.visible,\r\n            xpath: properties.xpath,\r\n            mode: \"design\",\r\n            xpathContext: properties.xpathContext || \"\"\r\n        });\r\n\r\n\r\n        if (!self.isDisposed()) {\r\n            // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n            self.unregisterChildren();\r\n            delete self.children;\r\n            delete self.childrenHash;\r\n\r\n            // update editable\r\n            if (self.properties.editable === false) {\r\n                data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n            }\r\n\r\n            // Update the data\r\n            self.initializeData(data.container);\r\n\r\n            // Render the container again\r\n            var currentContainer = self.container;\r\n            var result = self.render();\r\n\r\n            if (self.properties.type == \"tabItem\") {\r\n                $(result).addClass(\"childrenActive\");\r\n            }\r\n\r\n            currentContainer && currentContainer.replaceWith(result);\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh();\r\n        }\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].beforeToRefresh();\r\n        }\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].afterToRefresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-execute children actions\r\n    */\r\n    triggerChildrenActions: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.triggerChildrenActions();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.triggerRenderChange({ changed: false });\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * register actions container\r\n    */\r\n    registerActions: function (actions) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (actions) {\r\n            form.actionController.buildActions(actions);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * unregister children container\r\n    */\r\n    unregisterChildren: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.unregisterChildren();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                form.unregisterRender(child);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Replace child\r\n    */\r\n    replaceChild: function (element) {\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.uniqueId == element.properties.uniqueId) {\r\n                children.splice(i, 1);\r\n                children.splice(i, 0, element);\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Gets child\r\n    */\r\n    getChildById: function (id) {\r\n\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.id == id) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.desktop.container\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Checks if the container contains grids\r\n        this.containsGrid = this.countByRenderType(\"grid\") != 0;\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function (size) {\r\n        var self = this;\r\n        var container = self.container;\r\n        var width = container.width();\r\n\r\n        // Don't resize thin or invisible containers\r\n        if (width < 300) return;\r\n\r\n        // Don't resize if there are no grid renders\r\n        if (this.containsGrid == false) return;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            $.when(child.isRendered())\r\n            .done(function () {\r\n                child.resize({ width: width });\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.container;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.container;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Counts how many renders belong to the container with some render type\r\n    */\r\n    countByRenderType: function (type) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                counter += child.countByRenderType(type);\r\n            }\r\n\r\n            if (child.properties.type == type) counter++;\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    *   Counts how many renders belong to the container with some render type excluding by param\r\n    */\r\n    countByRenderTypeWithParams: function (type, param) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                counter += child.countByRenderType(type);\r\n            }\r\n\r\n            if (child.properties.type == type && param == child.properties.height) counter++;\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n    },\r\n\r\n    /*\r\n    * Return the sumatory of the height of all children\r\n    */\r\n    getChildrenSumHeight: function (excludeElement) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (excludeElement && excludeElement == child.properties.type && child.properties.height == -1) {\r\n                // do nothing (exclude the element)\r\n            } else {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    var containerHeight = $(child.container).height();\r\n                    counter += containerHeight != null ? containerHeight : 0;\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    var renderHeight = $(child.element).height();\r\n                    counter += renderHeight != null ? renderHeight : 0;\r\n                }\r\n            }\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    * Return the count of children\r\n    */\r\n    getChildreCount: function () {\r\n        var self = this;\r\n\r\n        return self.children.length;\r\n    }\r\n  \r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Form Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a form container class that defines basic stuff regarding the device\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.form\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n        var device = bizagi.util.detectDevice();\r\n\r\n        // Creates a hashtable to maintain references by id\r\n        self.rendersById = {};\r\n        self.rendersByXpath = {};\r\n        self.rendersByType = {};\r\n\r\n        // Set page cache id\r\n        self.idPageCache = data.pageCacheId;\r\n\r\n        // Set default mode\r\n        self.mode = params.mode || \"execution\";\r\n        self.focus = params.focus;\r\n\r\n        // Set rendering params\r\n        self.params = params;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Define confirmation message \r\n        var message = \"\";\r\n\r\n        if (device !== \"desktop\") {\r\n            message = this.getResource(\"render-form-user-confirmation-message\").replace(/<br(\\/| \\/)>/g, \"\\n\");\r\n        } else {\r\n            message = this.getResource(\"render-form-user-confirmation-message\");\r\n        }\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.sessionId = data.sessionId;\r\n        properties.displayAsReadOnly = bizagi.util.parseBoolean(data.displayAsReadOnly) || false;\r\n        properties.userConfirmationMessage = properties.userConfirmationMessage || message;\r\n        properties.orientation = properties.orientation || \"ltr\";\r\n        properties.hasRule = bizagi.util.parseBoolean(properties.hasRule) || false;\r\n        properties.contexttype = params.contexttype || \"\";\r\n        properties.paramsRender = params.paramsRender || {};\r\n        properties.processPath = params.data.processPath ? params.data.processPath.replaceAll(\"|/|\", \"  &rsaquo;  \") : \"\";\r\n        properties.breadCrumb = params.data.processPath ? params.data.processPath.split(\"|/|\") : [];\r\n\r\n        // Set validations & actions\r\n        this.validations = data.validations;\r\n        this.actions = data.actions;\r\n\r\n        // Enable the \"Validate and Save\" action for Form Buttons\r\n        self.allowValidateAndSaveAction = bizagi.override && bizagi.override.enableActionValidateAndSave === true;\r\n\r\n        // Initialize buttons\r\n        self.initializeButtons(data);\r\n\r\n        // Define transitions to Complex Gateway\r\n        if (data.transitions) {\r\n            self.transitions = data.transitions;\r\n        }\r\n\r\n        this.originalProcessButton = this.processButton;\r\n\r\n        //Custom behaviour for application parent activated.\r\n        self.isRoutingDisabled = false;\r\n        if (params.applicationParent) {\r\n            switch (params.applicationParent) {\r\n                case 'NEWWORKPORTAL':\r\n                    self.isRoutingDisabled = true;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        self.isOfflineFormsV2Supported =  bizagi.util.isMobileDevice() && bizagi.util.isOfflineFormsV2Supported();\r\n\r\n    },\r\n    /*\r\n    *   Initializes button metadata\r\n    */\r\n    initializeButtons: function (data) {\r\n        var self = this;\r\n\r\n        self.buttons = [];\r\n\r\n        // Process buttons\r\n        if (data.buttons) {\r\n            $.each(data.buttons, function (i, item) {\r\n                var button = item.button.properties;\r\n\r\n                // Process caption\r\n                button.caption = !bizagi.util.isEmpty(button.caption) && self.getResource(button.caption) != button.caption ? self.getResource(button.caption) : button.caption;\r\n\r\n                // Process actions\r\n                if (button.actions) {\r\n                    $.each(button.actions, function (i, action) {\r\n                        button[action] = true;\r\n                    });\r\n                }\r\n\r\n                // Add other properties\r\n                button.ordinal = i;\r\n                button.action = button.next ? \"next\" :\r\n                    button.nextWithoutValidations ? \"nextWithoutValidations\" :\r\n                        button.submitData ? \"save\" :\r\n                            button.cancel ? \"cancel\" :\r\n                                button.back ? \"back\" :\r\n                                    button.createnewcase ? \"createnewcase\" :\r\n                                        button.validate ? \"validate\" : \"\";\r\n\r\n                // Explicit add save operation\r\n                button.save = (button.action === \"save\");\r\n\r\n                // Add inherent behaviours\r\n                if (button.next || button.back || button.nextWithoutValidations) {\r\n                    button.routing = true;\r\n                }\r\n\r\n                if (button.hasRule) {\r\n                    button.executeRule = true;\r\n                }\r\n\r\n                if (self.allowValidateAndSaveAction && button.validate) {\r\n                    button.submitData = true;\r\n                    button.refresh = true;\r\n                    button.save = true;\r\n                    if (button.action === \"next\" || button.action === \"createnewcase\") {\r\n                        button.refresh = false;\r\n                    }\r\n                }\r\n\r\n                // Prepare button style\r\n                button.style = self.buildButtonStyle(button);\r\n\r\n                // Add to button array\r\n                if (self.properties.orientation === \"rtl\" && !self.properties.useCustomButtons) {\r\n                    self.buttons.unshift(button);\r\n                } else {\r\n                    self.buttons.push(button);\r\n                }\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get the original params used to fetch the form\r\n    */\r\n    getParams: function () {\r\n        return this.params;\r\n    },\r\n\r\n    setParam: function (property, value) {\r\n        if (this.params) {\r\n            this.params[property] = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        return this.mode;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        if (self.params) {\r\n            return self.params.customHandlers;\r\n        }\r\n    },\r\n    /*\r\n    * Method to index renders\r\n    */\r\n    registerRender: function (render) {\r\n        var self = this;\r\n\r\n        self.rendersById[render.properties.id] = render;\r\n        if (render.properties.xpath) {\r\n            if (!self.rendersByXpath[render.properties.xpath]) {\r\n                self.rendersByXpath[render.properties.xpath] = [];\r\n            }\r\n            self.rendersByXpath[render.properties.xpath].push(render);\r\n        }\r\n\r\n        if (!self.rendersByType[render.properties.type]) {\r\n            self.rendersByType[render.properties.type] = [];\r\n        }\r\n        self.rendersByType[render.properties.type].push(render);\r\n    },\r\n    /*\r\n    * Method to unregister render\r\n    */\r\n    unregisterRender: function (render) {\r\n        var self = this;\r\n\r\n        if (self.rendersById[render.properties.id]) {\r\n            delete self.rendersById[render.properties.id];\r\n        }\r\n\r\n        if (render.properties.xpath) {\r\n            if ($.isArray(self.rendersByXpath[render.properties.xpath])\r\n                && self.rendersByXpath[render.properties.xpath].length > 1) {\r\n                for (var i = 0, l = self.rendersByXpath[render.properties.xpath].length; i < l; i++) {\r\n                    var element = self.rendersByXpath[render.properties.xpath][i];\r\n                    if (element.properties.id === render.properties.id) {\r\n                        self.rendersByXpath[render.properties.xpath].splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                delete self.rendersByXpath[render.properties.xpath];\r\n            }\r\n        }\r\n\r\n        // Unregister from renders by type\r\n        if (render.properties.type) {\r\n            var listRendesByType = self.getRenderByType(render.properties.type);\r\n            var listRendesByTypeLength = listRendesByType.length;\r\n            var renderKey = render.properties.id || render.properties.xpath;\r\n\r\n            for (var i = 0; i < listRendesByTypeLength; i++) {\r\n                var listRender = listRendesByType[i];\r\n                if ((typeof listRender.properties.id != \"undefined\" && listRender.properties.id == renderKey) ||\r\n                    (typeof listRender.properties.xpath != \"undefined\" && listRender.properties.xpath == renderKey)) {\r\n                    // Unregister element\r\n                    self.rendersByType[render.properties.type].splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Method to access a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this;\r\n\r\n        return self.rendersById[id];\r\n    },\r\n\r\n    getGridByColumn: function (id) {\r\n        var self = this;\r\n        var grids = self.getRenderByType('grid');\r\n        var i = 0, columnIndex;\r\n\r\n        for (; i < grids.length; i++) {\r\n            columnIndex = grids[i].columnsIds.indexOf(id);\r\n            if (columnIndex != -1) {\r\n                return grids[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this;\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath && xpath.indexOf)\r\n            if (xpath.indexOf(\"[\") > 0) {\r\n                xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n            }\r\n\r\n        return self.rendersByXpath[xpath] ? self.rendersByXpath[xpath] : [];\r\n    },\r\n    /**\r\n     * Get all render with the same type\r\n     */\r\n    getRenderByType: function (type) {\r\n        var self = this;\r\n\r\n        // Check that type is defined\r\n        if (typeof type == \"string\" && type.length > 0) {\r\n            // Search controls by type\r\n            return (self.rendersByType[type]) ? self.rendersByType[type] : [];\r\n        }\r\n        return [];\r\n    },\r\n\r\n    /*\r\n    *   Build the container html\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.fasttmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (form) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Add a mode class\r\n        form.addClass(\"ui-bizagi-rendering-mode-\" + mode);\r\n\r\n        // Call base\r\n        this._super(form);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form).each(function () {\r\n                if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                    complexGatewayContainer = this;\r\n                }\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".ui-bizagi-container-complexgateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function (e, mainForm) {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations, mainForm);\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Set events for complex gateway interface\r\n        $(complexGatewayContainer).find(\".ui-checkbox\").bind(\"click\", function () {\r\n            var checkboxLabel = $(\"label\", this);\r\n\r\n            var transitionId = checkboxLabel.data(\"value\") || \"\";\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(checkboxLabel.data(\"checked\"))) {\r\n                // Uncheck element\r\n                checkboxLabel.removeClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                checkboxLabel.addClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n    },\r\n    /*\r\n    *   Format form buttons to allow further customization\r\n    */\r\n    buildButtonStyle: function (button) {\r\n\r\n        var style = {};\r\n        if (button.format) {\r\n            if (button.format.size) {\r\n                if (button.format.size != \"0\") {\r\n                    var newFontSize = (100 + Number(button.format.size) * 10) + \"%\";\r\n                    style[\"font-size\"] = newFontSize + \" !important\";\r\n                }\r\n            }\r\n            if (button.format.bold) {\r\n                style[\"font-weight\"] = \"bold !important\";\r\n                if (bizagi.util.isIE()) {\r\n                    style[\"font-family\"] = \"'Open Sans', 'Helvetica Neue', Arial, Helvetica, sans-serif !important\";\r\n                }\r\n            }\r\n            if (button.format.italic) {\r\n                style[\"font-style\"] = \"italic !important\";\r\n            }\r\n            if (button.format.underline || button.format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(button.format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(button.format.underline) ? \"underline \" : \"\";\r\n                style[\"text-decoration\"] = strikethru + underline + \" !important\";\r\n            }\r\n            if (button.format.background) {\r\n                style[\"background-color\"] = button.format.background + \" !important\";\r\n                style[\"background-image\"] = \"none !important\";\r\n            }\r\n            if (button.format.color) {\r\n                style[\"color\"] = button.format.color + \" !important\";\r\n            }\r\n        }\r\n\r\n        var strStyle = \"\";\r\n        for (key in style) {\r\n            strStyle += key + \":\" + style[key] + \";\";\r\n        }\r\n        return strStyle;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   Returns a promise\r\n    */\r\n    render: function () {\r\n        var self = this;\r\n\r\n        // Creates a deferred, so we can check when form has been included in dom\r\n        if (!self.readyDeferred)\r\n            self.readyDeferred = new $.Deferred();\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Sets a promise that the form will be included in the DOM\r\n    *   so we can apply some tedious plugins that require that\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n\r\n        return self.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n    /*\r\n    *  Return context type, when the parent form is entity\r\n    */\r\n    getContextType: function () {\r\n        return this.properties.contexttype || \"\";\r\n    },\r\n\r\n    /*\r\n    * Return the endpoint action, when the form will be refresh\r\n    */\r\n    getEndPointAction: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        if (properties.formtype == \"startform\")\r\n            return \"LOADSTARTFORM\";\r\n\r\n        return undefined;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache id for the element\r\n    */\r\n    getPageCache: function () {\r\n        return this.idPageCache;\r\n    },\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        return this;\r\n    },\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.on(\"click\", function (e) {\r\n            e.preventDefault();\r\n            e.stopImmediatePropagation();\r\n\r\n            self.startLoading();\r\n\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            self.lastActionButton = buttonProperties;\r\n            if (buttonProperties.action === \"next\") {\r\n                buttonProperties.routingDisabled = self.isRoutingDisabled;\r\n            }\r\n\r\n            button.prop(\"disabled\", true); //disable button to prevent multiple click actions\r\n\r\n            if(button.hasOwnProperty('disabled')) {\r\n                button.button(\"disable\"); //Setting styles\r\n            }\r\n\r\n            // External Events\r\n            self.propagateExternalEvents(e);\r\n\r\n            // Execute button\r\n            //QAF-1418 - add setTimeout\r\n            setTimeout(function () {\r\n                $.when(self.processButton(buttonProperties)).always(function () {\r\n                    self.processDefer = undefined;\r\n                    self.endLoading();\r\n                    if ($.contains(document.documentElement, button.get(0))) { //check if button is still in DOM\r\n                        button.prop(\"disabled\", false);  //enable button\r\n\r\n                        if(button.hasOwnProperty('enable')) {\r\n                            button.button(\"enable\"); //Setting styles\r\n                        }\r\n                    }\r\n                });\r\n            }, 100);\r\n        });\r\n    },\r\n    /*\r\n    * Execute codes just before sending information to server\r\n    */\r\n    preProcessButton: function (buttonProperties) {\r\n        return true;\r\n    },\r\n    /*\r\n    * Execute codes just after sending information to server\r\n    */\r\n    postProcessButton: function (responses, buttonProperties) {\r\n        return true; // true means continue\r\n    },\r\n\r\n    setLoaderDeferred: function() {\r\n        var self = this;\r\n\r\n        self.loaderDeferred = $.Deferred().resolve();\r\n    },\r\n\r\n    deleteLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function() {\r\n                delete self.loaderDeferred;\r\n            });\r\n        }\r\n    },\r\n\r\n    useOrSetLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            self.setLoaderDeferred();\r\n        }\r\n    },\r\n\r\n    getLoaderPromise: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            return self.loaderDeferred.promise();\r\n        } else {\r\n            return;\r\n        }\r\n    },\r\n\r\n    isLoaderDeferredSet: function () {\r\n        var self = this;\r\n\r\n        if (self.loaderDeferred) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    appendWaitForLoader: function (params) {\r\n        var self = this;\r\n        var promise = params.promise;\r\n        var create = params.create || false;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            if (create) {\r\n                self.setLoaderDeferred();\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n\r\n        self.loaderDeferred = self.loaderDeferred.then(function () {\r\n            return (function () {\r\n                return promise;\r\n            })();\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Executes a single button action\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var properties = self.properties;\r\n        if (!buttonProperties.routing) {\r\n            bizagi.chrono.initAndStart(\"submitForm\");\r\n        }\r\n        bizagi.chrono.init(\"waiting\");\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Resolve asynchronous tabItems\r\n        var form = self.getFormContainer();\r\n        var getAllTabs = form.getRenderByType(\"tabItem\");\r\n        var getAllTabsLength = getAllTabs.length;\r\n\r\n        form.innerTabsLoading = true;\r\n\r\n\r\n        self.useOrSetLoaderDeferred();\r\n\r\n        // Check\r\n        for (var i = 0; i < getAllTabsLength; i++) {\r\n            var render = getAllTabs[i];\r\n            // Resolve internal deferred\r\n            if (render.loadingDeferred && render.parent.container) {\r\n                render.loadingDeferred.resolve();\r\n            }\r\n        }\r\n\r\n        delete form.innerTabsLoading;\r\n\r\n        $.when(self.ready(), self.getLoaderPromise()).done(function () {\r\n            self.deleteLoaderDeferred();\r\n            // Validate the form\r\n            var valid = bizagi.util.parseBoolean(buttonProperties.validate) ? self.validationController.performValidations() : true;\r\n            if (valid) {\r\n\r\n                if ([\"save\", \"next\", \"back\", \"createnewcase\", \"nextWithoutValidations\"].includes(buttonProperties.action)) {\r\n                    $(document).data('auto-save', '');\r\n                }\r\n\r\n                // Check for user confirmation if configured and the button is configured to enroute\r\n                if (bizagi.util.parseBoolean(self.properties.needsUserConfirmation) && bizagi.util.parseBoolean(buttonProperties.routing)) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, null, false)).done(function () {\r\n                        // Submits the form\r\n                        if (self.preProcessButton(buttonProperties)) {\r\n                            //Trigger the event after ProcessButton\r\n                            self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                            $.when(self.submitForm(buttonProperties)).done(function () {\r\n                                defer.resolve();\r\n                            }).fail(function() {\r\n                                defer.reject(arguments);\r\n                            });\r\n                        }\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n\r\n                } else {\r\n                    if (self.preProcessButton(buttonProperties)) {\r\n                        //Trigger the event after ProcessButton\r\n                        self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                        $.when(self.submitForm(buttonProperties)).done(function () {\r\n                            $(document).trigger(\"FORMACTION\", buttonProperties);\r\n                            defer.resolve();\r\n                        }).fail(function () {\r\n                            defer.reject(arguments);\r\n                        });\r\n                    }\r\n                }\r\n\r\n            } else {\r\n\r\n                self.endLoading();\r\n                if (buttonProperties.submitData) {\r\n                    $.when(self.submitData()).done(function () {\r\n                        defer.reject();\r\n                    });\r\n                }\r\n                else {\r\n                    defer.reject();\r\n                }\r\n\r\n                self.validationController.expandNotificationBox();\r\n            }\r\n\r\n            var customHandler = self.getCustomHandler(\"afterFormButtonClick\");\r\n            if (customHandler) {\r\n                customHandler(buttonProperties);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    validateForm: function () {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Validate the form\r\n        return self.validationController.performValidations();\r\n    },\r\n    /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n\r\n            // Submit the form\r\n            return $.when(self.dataService.submitData({\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            })).always(function () {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Creates a json array with key values to send to the server\r\n    */\r\n    submitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        $.when(self.isReadyToSave())\r\n            .done(function () {\r\n                if (isOfflineForm) {\r\n                    self.internalSubmitFormOffline(buttonProperties);\r\n                    return;\r\n                }\r\n                $.when(self.internalSubmitForm(buttonProperties)).done(function () {\r\n                    defer.resolve();\r\n                }).fail(function () {\r\n                    defer.reject(arguments);\r\n                });\r\n\r\n            }).fail(function () {\r\n            self.endLoading();\r\n            bizagi.log(\"The form is not saved, no changes were found\");\r\n            defer.reject();\r\n        });\r\n        return defer.promise();\r\n    },\r\n    checkWidgetsData: function () {\r\n        //\r\n    },\r\n    isComplexGatewayPainted: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Get last action button\r\n     * @returns {*}\r\n     */\r\n    getLastActionButton: function () {\r\n        var self = this;\r\n        return self.lastActionButton;\r\n    },\r\n\r\n    /**\r\n     * Internal - Creates a json array with key values to send to the database\r\n     * @param {} buttonProperties\r\n     * @returns {}\r\n     */\r\n    internalSubmitFormOffline: function (buttonProperties) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var data;\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        if (self.transitions) {\r\n            var transitions = [];\r\n            $.each(this.activeTransitions, function (key, value) {\r\n                (value) ? transitions.push(key) : \"\";\r\n            });\r\n\r\n            if (bizagi.util.countProps(transitions) == 0) {\r\n                bizagi.showMessageBox(\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-path\"),\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false\r\n                );\r\n                self.endLoading();\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        $.when(self.dataService.submitData({\r\n            action: buttonProperties.action,\r\n            data: data,\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            idForm: self.properties.id,\r\n            prepare: true,\r\n            transitions: transitions || \"\",\r\n            idCase: self.params.idCase,\r\n            idWorkitem: self.params.idWorkitem,\r\n            isOfflineForm: isOfflineForm || false,\r\n            offlineType: self.params.offlineType || \"\"\r\n        })).done(function (responses) {\r\n\r\n            if (!self.postProcessButton(responses, buttonProperties)) {\r\n                return;\r\n            }\r\n\r\n            if (buttonProperties.routing) {\r\n                var waitForOnlineResponse = false;\r\n                if(isOfflineForm && self.isOfflineFormsV2Supported && self.params.online) {\r\n                    waitForOnlineResponse = true;\r\n                    var tryPushResponsePromise = new $.Deferred();\r\n                    self.params.responsePromise = tryPushResponsePromise;\r\n                    $(document).trigger(\"tryPushCase.offline\", self.params);\r\n                }\r\n                else if( isOfflineForm && !self.isOfflineFormsV2Supported){\r\n                    $(document).trigger(\"tryPushData.offline\");\r\n                }\r\n\r\n                if(!waitForOnlineResponse){\r\n                    self.triggerHandler(\"routing\", {\r\n                        offlineAction: buttonProperties.action,\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem\r\n                    });\r\n                }\r\n                else {\r\n                    $.when(tryPushResponsePromise)\r\n                    .then( function(result){\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: result.IdCase,\r\n                            caseNumber: result.CaseNumber\r\n                        });\r\n                    })\r\n                    .fail( function(error){\r\n                        self.failHandler(error);\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                message = bizagi.util.isValidResource(\"workportal-mobile-offline-form-successful\")\r\n                    ? bizagi.localization.getResource(\"workportal-mobile-offline-form-successful\")\r\n                    : \"Saved\";\r\n\r\n                bizagi.util.showNotification({ text: message, type: \"success\" });\r\n            }\r\n\r\n        }).fail(function (error) {\r\n            message = bizagi.util.isValidResource(\"workportal-mobile-offline-successful-fail\")\r\n                ? bizagi.localization.getResource(\"workportal-mobile-offline-successful-fail\")\r\n                : \"Not saved\";\r\n\r\n            bizagi.util.showNotification({ text: message, type: \"error\" });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Internal - Creates a json array with key values to send to the server\r\n    */\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var data;\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\r\n        });\r\n\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var waitingDeferreds = [];\r\n        var deferredsToWait = null;\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {  // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase || buttonProperties.nextWithoutValidations) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-widget-complexgateway-path\"), bizagi\r\n                        .localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: self.getButtonAction(buttonProperties.action),\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        // Assemble the actions\r\n        var actions = [];\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n            actions.push(checkpointAction);\r\n            actions.push(executeButtonAction);\r\n            actions.push(commitAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        // Execute the batch\r\n        bizagi.chrono.initAndStart(\"submitForm-ajax\");\r\n\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                })\r\n                .fail(function () {\r\n                    flowControlDeferred.reject();\r\n                    console.log(\"Error: It was not possible resolve async actions on form \")\r\n                })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        waitingDeferreds.push(flowControlDeferred);\r\n\r\n        $.when.apply($, waitingDeferreds).done(function() {\r\n            $.when(self.dataService.multiaction().execute({ actions: actions })).done(function (responses) {\r\n                bizagi.chrono.stop(\"submitForm-ajax\");\r\n                // End asynchronous operation\r\n                self.endLoading();\r\n                // Find validations\r\n                var bHasValidations;\r\n                var alertMessage = \"\";\r\n                $.each(responses, function (i, response) {\r\n\r\n                    var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                    bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                    alertMessage = propertiesToDisplayMessages.alertMessage;\r\n\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties)) {\r\n                        return;\r\n                    }\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh) {\r\n                        self.refreshForm();\r\n                    }\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: self.params.idCase,\r\n                            routingDisabled: buttonProperties.routingDisabled\r\n                        });\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    if(alertMessage !== \"\"){ /*If there is an alertMessage show in a modal error*/\r\n                        bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                    }\r\n                    if (buttonProperties.executeRule) {\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                    }\r\n                }\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                if (buttonProperties.executeRule) {\r\n                    self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                if (response && response.error && (response.error.errorType === \"WaitForCompletionPlanException\" ||\r\n                    response.error.errorType === \"InvalidPlanStateException\" || response.error.errorType === \"CustomMessageException\")) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(response.error.message), null, false)).then(function () {\r\n                        return $.when(self.internalSubmitForm($.extend({}, buttonProperties, { forcePlanCompletion: true })));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    self.failHandler(response);\r\n                    defer.reject(response);\r\n                }\r\n            });\r\n        });\r\n        return defer.promise();\r\n    },\r\n    validationToDisplayMessages: function(bHasValidations, messageType, message, alertMessage){\r\n        var self = this;\r\n\r\n        if (messageType == \"validationMessages\") {\r\n            // Something went wrong, we gotta display messages in notifications grid\r\n            self.addValidationMessage(message);\r\n            bHasValidations = true;\r\n        }\r\n        if(bizagi.detectDevice() == \"desktop\" && messageType == \"alertMessages\"){\r\n            // Something went wrong, we gotta display alert message\r\n            if(alertMessage === \"\"){\r\n                alertMessage = message;\r\n            }else{\r\n                alertMessage = alertMessage + \"\\n\\n\" + message;\r\n            }\r\n\r\n            bHasValidations = true;\r\n        }\r\n\r\n        return {\"bHasValidations\": bHasValidations, \"alertMessage\": alertMessage};\r\n    },\r\n\r\n    /*\r\n    *   Add a validation message to the form\r\n    */\r\n    addValidationMessage: function (validationMessage, focus, icon, itemAdditionalClass, autofocus, type) {\r\n        var self = this;\r\n\r\n        if (!self.validationController) {\r\n            self.validationController = new bizagi.command.controllers.validation(self);\r\n        }\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage, focus, icon, itemAdditionalClass, type);\r\n        } else {\r\n            $.each(validationMessage, function (i, message) {\r\n                self.validationController.showValidationMessage(message, focus, icon, itemAdditionalClass, type);\r\n            });\r\n        }\r\n        self.validationController.expandNotificationBox(autofocus);\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        if (self.validationController) {\r\n            self.validationController.clearValidationMessages(params);\r\n        }\r\n\r\n    },\r\n    /*\r\n    *   Add an error message to the form\r\n    */\r\n    addErrorMessage: function (errorMessage) {\r\n        var self = this;\r\n\r\n        self.validationController.showErrorMessage(errorMessage);\r\n        self.validationController.expandNotificationBox();\r\n    },\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var deferred = $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        // Normalize new focus structure if not present\r\n        if (focus && !focus.id) {\r\n            focus = {\r\n                id: focus\r\n            };\r\n        }\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            isRefresh: true,\r\n            contextType: self.getContextType() || \"\",\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\"\r\n        };\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            self.endLoading();\r\n            deferred.resolve();\r\n        }).fail(function () {\r\n            self.endLoading();\r\n            deferred.reject();\r\n        });\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Get opened tabs configuration\r\n    */\r\n    getSelectedTabs: function () {\r\n        var self = this;\r\n        var tabContainers = self.getElementsByType(\"tab\");\r\n        var tabs = $.map(tabContainers, function (tabContainer) {\r\n            return { tab: tabContainer.properties.id, selected: tabContainer.activeTab };\r\n        });\r\n        var selectedTabs = {};\r\n        for (var i = 0, length = tabs.length; i < length; i++) {\r\n            selectedTabs[tabs[i].tab] = tabs[i].selected;\r\n        }\r\n        return selectedTabs;\r\n    },\r\n    /*\r\n    *   Template method to get the buttons objects\r\n    */\r\n    getButtons: function () {\r\n    },\r\n    /*\r\n    *   Adds an action on the fly to process the submit on change\r\n    */\r\n    addSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n        self.actionController.processInternalSubmitAction(xpath, action);\r\n    },\r\n    /**\r\n     *   Adds an overlay to the form, and sets a waiting message\r\n     *\r\n     *   @argument {bool} delay Apply delay\r\n     */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        // This hack is only for desktop\r\n        if (!bizagi.util.isTabletDevice()) {\r\n            // Detect canvas parent with scroll\r\n            var isSharePoint = self.params.context === \"sharepoint\";\r\n            var canvas = self.params.canvas;\r\n            if (isSharePoint) {\r\n                canvas = bizagi.util.scrollTop(canvas);\r\n\r\n                if (!!!canvas.context) {\r\n                    canvas = $(\"body\", $(document));\r\n                }\r\n            } else {\r\n                canvas = $(\"body\", $(document));\r\n            }\r\n\r\n            // Configures overlay\r\n            var size = this.getSize();\r\n            var position = this.getOffset();\r\n            if (size.height == $(window).height()) {\r\n                position.top = 0;\r\n            }\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(canvas);\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(canvas);\r\n            self.waitingOverlay.css({\r\n                \"height\": \"100%\",\r\n                \"width\": \"100%\",\r\n                \"min-height\": size.height,\r\n                \"min-width\": size.width\r\n            });\r\n            self.waitingMessage.css({\r\n                \"top\": (position.top + Math.ceil((size.height - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n                \"left\": (Math.ceil((size.width - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n            });\r\n            canvas.css(\"position\", \"relative\");\r\n\r\n        } else {\r\n            // Configures overlay\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(\"body\", $(document));\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(\"body\", $(document));\r\n        }\r\n    },\r\n    /*\r\n    *   Removes the overlay and restores the form edition\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n        if (self.waitingOverlay && self.waitingMessage) {\r\n            self.waitingOverlay.remove();\r\n            self.waitingMessage.remove();\r\n            self.waitingOverlay = null;\r\n            self.waitingMessage = null;\r\n\r\n            var canvas = self.params.canvas;\r\n\r\n            if (canvas != undefined)\r\n                canvas.css(\"position\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Get the focused render in the current request\r\n    */\r\n    getFocusedElement: function () {\r\n        var self = this;\r\n        return self.focus;\r\n    },\r\n    /*\r\n    *   Set the focused render in the current request\r\n    */\r\n    setFocusedElement: function (focus) {\r\n        var self = this;\r\n        self.focus = focus;\r\n    },\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        return this.triggerHandler(\"globalHandler\", { eventType: eventType, data: data });\r\n    },\r\n    /*\r\n    *   Generic handler to attach fail workflow for some operations\r\n    */\r\n    failHandler: function (error) {\r\n        var self = this;\r\n\r\n        // Check if the error is in multiaction format\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n        }\r\n\r\n        //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n        if (error & error.length && error.length > 1) error = error[0];\r\n        if (error.error) error = error.error;\r\n        if (error.error) error = error.error;\r\n\r\n        // Handle normal messages\r\n        if (typeof error == \"object\" && error.message) {\r\n            if (error.errorType === \"WaitForCompletionPlanException\" || error.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                error = bizagi.localization.getResource(error.message);\r\n            }\r\n            else {\r\n                error = error.message;\r\n            }\r\n\r\n        } else if (typeof error == \"string\") {\r\n            // Parse to json\r\n            try {\r\n                var errorJson = JSON.parse(error);\r\n                if (errorJson.errorType === \"WaitForCompletionPlanException\" || errorJson.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                    errorJson.message = bizagi.localization.getResource(errorJson.message);\r\n                }\r\n                error = errorJson.message;\r\n            } catch (e) {\r\n            }\r\n        }\r\n\r\n        // Workflow engine error, we gotta show it with error\r\n        self.addErrorMessage(error);\r\n        self.endLoading();\r\n    },\r\n    /* \r\n    *   Resizes the element\r\n    */\r\n    resize: function (size) {\r\n        // Just save the size, for reference\r\n        this.setSize(size);\r\n    },\r\n    /*\r\n    *   Sets the internal size for the form\r\n    */\r\n    setSize: function (size) {\r\n        this.size = size;\r\n    },\r\n    /*\r\n    *   Gets the internal size for the form\r\n    */\r\n    getSize: function () {\r\n        if (this.size) {\r\n            return this.size;\r\n        }\r\n        var canvas = (this.params.canvas) ? this.params.canvas : this.getFormContainer().container;\r\n\r\n        var canvasWidth = canvas.width();\r\n        var canvasHeight = canvas.height();\r\n\r\n        return {\r\n            width: canvasWidth,\r\n            height: canvasHeight\r\n        };\r\n    },\r\n    getOffset: function () {\r\n        var canvas = this.getFormContainer().container;\r\n\r\n        return canvas.offset();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitData: function (args) {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        // Don't do anything if there is no data\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        }\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().submitData({\r\n            action: \"SUBMITDATA\",\r\n            data: data,\r\n            idPageCache: self.properties.idPageCache,\r\n            xpathContext: self.properties.xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeRule({\r\n            idPageCache: properties.idPageCache,\r\n            rule: args.rule,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages({ clearOnlyServer: true });\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage.apply(self, [message.messages, undefined, undefined, undefined, false, \"serverMessage\"]);\r\n            }\r\n            if(bizagi.detectDevice() == \"desktop\" && message.type == \"alertMessages\"){\r\n                bizagi.modalError.show(message.messages.join(\"\\n\\n\"), 'workportal-general-word-information', false);\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute an interface\r\n     */\r\n    executeInterface: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeInterface({\r\n            idPageCache: properties.idPageCache,\r\n            interface: args.interface,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    executeSAPConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeSAPConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidsap: args.guidsap,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    executeConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties\r\n                .xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidConnector: args.guidConnector,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    refreshActions: function (actions) {\r\n        var self = this;\r\n        self.actionController.refreshActions(actions);\r\n    },\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    removeActions: function () {\r\n        var self = this;\r\n        self.actionController.unbindActions();\r\n    },\r\n    /*\r\n    *   Iterate through all renders and collect the data to send, then update original values for each render\r\n    */\r\n    collectRenderValuesForSubmit: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n\r\n        // Collect data\r\n        self.collectRenderValues(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params {data, bRefreshForm,properties}\r\n     * @returns {*}\r\n     */\r\n    internalSubmitOnChange: function (params) {\r\n        params = params || {};\r\n        var self = this, idCase;\r\n        var properties = params.properties;\r\n        // var form = self.getFormContainer();\r\n        var defer = new $.Deferred();\r\n        var data = params.data || {};\r\n        var bRefreshForm = typeof (params.bRefreshForm) != \"undefined\" ? params.bRefreshForm : true;\r\n        var notCollect = params.notCollect ? params.notCollect : undefined;\r\n\r\n        // Collect data\r\n        if (!(notCollect && !$.isEmptyObject(data))) {\r\n            self.collectRenderValuesForSubmit(data);\r\n        }\r\n        self.startLoading();\r\n\r\n        //idCase = self.getCacheIdCase();\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function () {\r\n            // Submit the form\r\n            self.dataService.submitData({\r\n                action: \"SUBMITONCHANGE\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }).done(function (response) {\r\n                // Cancel previous multiactions and process property value\r\n                self.cancelPreviousRequest();\r\n                // After successfully response refresh the form\r\n                self.endLoading();\r\n                // If response message has error in validation, do not refresh the form\r\n                // and show validation message\r\n                if (response && response.type == \"validationMessages\") {\r\n                    if (typeof self.clearValidationMessages == \"function\") {\r\n                        self.clearValidationMessages();\r\n                    }\r\n\r\n                    self.addValidationMessage(response.messages);\r\n                    defer.resolve();\r\n                } else if (bRefreshForm) {\r\n                    var focusIdentifier = {\r\n                        id: properties.id,\r\n                        xpath: properties.xpath\r\n                    };\r\n                    if (properties.idCase !== undefined) {\r\n                        $.extend(focusIdentifier, {\r\n                            idCaseObject: bizagi.cache.idCaseObject\r\n                        });\r\n                    }\r\n                    if (response.IdScope) {\r\n                        self.properties.idStartScope = response.IdScope;\r\n                    }\r\n                    $.when(self.refreshForm(focusIdentifier)).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.resolve();\r\n                    });\r\n                } else {\r\n                    defer.resolve();\r\n                }\r\n            }).fail(function (message) {\r\n                self.endLoading();\r\n                var objMessage = JSON.parse((typeof message == 'object' && message.responseText) ? message.responseText : {}) || {};\r\n                var strMessage = objMessage.message || message;\r\n                // Clear previous validations\r\n                self.validationController.clearValidationMessages();\r\n                if (objMessage.type == \"alert\") {\r\n                    self.validationController.showAlertMessage(strMessage);\r\n                } else {\r\n                    self.validationController.showErrorMessage(strMessage);\r\n                }\r\n                defer.resolve();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    cancelPreviousRequest: function () {\r\n        if (bizagi.multiactionConnection && bizagi.multiactionConnection.length) {\r\n            var length = bizagi.multiactionConnection.length;\r\n            var i = 0, connection;\r\n            for (; i < length; i++) {\r\n                connection = bizagi.multiactionConnection.pop();\r\n                if (connection && connection.abort) {\r\n                    bizagi.showErrorAlertDialog = false;\r\n                    connection.abort();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    prepareCheckpointAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var checkpointAction = self.dataService.sendCheckpoint({\r\n            url: self.properties.checkpointUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        checkpointAction.tag = \"checkpoint\";\r\n\r\n        return checkpointAction;\r\n    },\r\n\r\n    prepareCommitAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var commitAction = self.dataService.commitLinkForm({\r\n            url: self.properties.commitUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        commitAction.tag = \"commit\";\r\n\r\n        return commitAction;\r\n    },\r\n\r\n    sendRollbackAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        self.dataService.rollbackLinkForm({\r\n            url: self.properties.rollbackUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n\r\n        setTimeout(function () {\r\n            if (self.params) {\r\n                delete self.params.canvas;\r\n            }\r\n            delete self.params;\r\n            delete self.control;\r\n            if (self.validationController) {\r\n                self.unbind(\"rendervalidate\");\r\n                delete self.validationController;\r\n            }\r\n\r\n            if (self.actionController) {\r\n                self.actionController.unbindActions();\r\n                delete self.actionController;\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    getButton: function (guid) {\r\n        return $(\".ui-bizagi-button[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    getFloatingButton: function (guid) {\r\n        return $(\"li[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    propagateExternalEvents: function (evt) {\r\n        // Menu-Overflow\r\n        var $menuOverflow = $(\".bz-overflow-menu\");\r\n        if ($menuOverflow)\r\n            $(document).trigger('click.overflow');\r\n\r\n        // ECM with preview image\r\n        var zoomIsOpen = $(\".jquery-image-zoom\") && $(\".jquery-image-zoom\").css(\"display\") == \"block\";\r\n\r\n        if (zoomIsOpen)\r\n            $(\"div.jquery-image-zoom a\").click();\r\n    },\r\n\r\n    getButtonAction: function (action) {\r\n        return this.allowValidateAndSaveAction && action === \"validate\" ? \"save\" : action;\r\n    }\r\n\r\n});\r\n","/**\r\n * Render a new type of form called template\r\n *\r\n * @author Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.formTemplate\", {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        this._super(params);\r\n        if(params.paramsRender && params.paramsRender.contextEvent){\r\n            self.contextEvent = params.paramsRender.contextEvent;\r\n        }\r\n    },\r\n\r\n\t/**\r\n\t * Process controls on template\r\n\t * @param template\r\n\t * @param controls\r\n\t * @return {*}\r\n\t */\r\n\tprocessTemplate: function(template, controls) {\r\n\t    var regexControl = /\\{\\{([\\w:]*)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\})\\}\\}/g;\r\n\t\tvar regexRepeater = /\\{\\{(((repeater)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\}))|([\\/repeater]+:item)|(\\/repeater)|(repeater)|(separator))\\}\\}/g;\r\n\r\n\t\t// Remove all repeaters key words\r\n\t\tvar processedTemplate = template.replace(regexRepeater, \"\");\r\n\r\n\t\t// replace controls\r\n\t\tprocessedTemplate = processedTemplate.replace(regexControl, function(match, g1, g2, offset, string) {\r\n\t\t    var parameters = JSON.parse(g2);\r\n            \r\n\t\t\treturn controls[parameters.id] || '';\r\n\t\t});\r\n\r\n\t    processedTemplate = processedTemplate.replace(/{{([\\w:]*)\\s*}}/g, function() {\r\n\t        return '';\r\n\t    });\r\n\r\n\r\n\t\treturn processedTemplate;\r\n\t},\r\n\r\n\t/**\r\n\t * Render layout container\r\n\t * @return {*}\r\n\t */\r\n\trenderContainer: function() {\r\n\t\tvar self = this;\r\n\t\tvar layoutCollection = self.getRenderByType(\"layout\");\r\n\t\tvar layout = (layoutCollection.length > 0) ? layoutCollection[0] : {};\r\n\t\tvar template = (typeof layout.getTemplate == \"function\") ? layout.getTemplate() : \"\";\r\n\t\tvar css = (typeof layout.getCss == \"function\") ? layout.getCss() : \"\";\r\n\t\tvar mode = self.getMode();\r\n\t\tvar layoutGuid = self.properties.layoutguid || Math.guid();\r\n\r\n\t\tvar controls = {};\r\n\r\n\t\t/**\r\n\t\t * Render all elements within first layout container\r\n\t\t */\r\n\t\tif(layout.children) {\r\n\t\t\t$.each(layout.children, function(i, child) {\r\n\t\t\t    // ignore layoutPlaceholder control in execution\r\n\t\t\t    if (!(mode == 'execution' && child.properties.type == 'layoutPlaceholder')) {\r\n\r\n\t\t\t        var type = child.getElementType();\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n\t\t\t            controls[child.properties.id] = child.renderElement();\r\n\t\t\t        }\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n\t\t\t            controls[child.properties.id] = child.renderContainerHtml();\r\n\t\t\t        }\r\n\t\t\t        self.childrenHash[child.properties.uniqueId] = child;\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Load css\r\n\t\tbizagi.util.loadStyle(css, layoutGuid);\r\n\r\n\t\treturn self.processTemplate(template, controls);\r\n\t},\r\n\r\n    /**\r\n     * Get the context in which loads the formTemplate\r\n     *\r\n     */\r\n    getContextEvent: function(){\r\n        return self.contextEvent;\r\n    }\r\n});\r\n","$.Class.extend(\"bizagi.rendering.layout\", {}, {\r\n\r\n\t/**\r\n\t * Get html template\r\n\t * @return {*}\r\n\t */\r\n\tgetTemplate: function() {\r\n\t    var self = this;\r\n\t    var mode = self.getMode();\r\n\t    var html = self.properties.html || \"\";\r\n\r\n        // Add a container, this is important in design to calculate the scroll \r\n\t    if (mode == 'design' && html) {\r\n            html = \"<div class='bz-design-template'>\" + html + \"</div>\"\r\n\t    }\r\n\t\t\r\n\t\treturn bizagi.util.stripslashes(html);\r\n\t},\r\n\r\n\t/**\r\n\t * Get string css of layout container\r\n\t * @return {*}\r\n\t */\r\n\tgetCss: function() {\r\n\t    var self = this;\r\n\t\tvar css = self.properties.css || \"\";\r\n\r\n\t\tvar mode = self.getMode();\r\n\t\tif (mode == \"design\") {\r\n\t\t    css = css && css.desktop;\r\n\t\t}\r\n\r\n\t\treturn bizagi.util.stripslashes(css);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t *   Template method to process each jquery object\r\n\t *   must be overriden in each container\r\n\t */\r\n\tpostRenderContainer: function(container) {\r\n\t\tvar self = this;\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\t// Resolve rendering deferred\r\n\t\tif(self.renderingDeferred)\r\n\t\t\tself.renderingDeferred.resolve();\r\n\r\n\t\t// Process children elements\r\n\t\tself.container = container;\r\n\t\tself.executeChildrenPostRender(container);\r\n\r\n\t\tif(mode == \"execution\") {\r\n\t\t\t// Apply handlers\r\n\t\t\tself.configureHandlers();\r\n\t\t}\r\n\t\tif(mode == \"design\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t}\r\n\t\tif(mode == \"layout\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t\tself.configureLayoutView();\r\n\t\t}\r\n\t}\r\n});","/*\r\n*   Name: BizAgi Accordion Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordion\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Enumerate the children appending a property\r\n        $.each(self.children, function (i, child) {\r\n            child.properties.ordinal = i;\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordion\");\r\n\r\n        // Render the accordion\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Accordion Item Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion item class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordionItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordionItem\");\r\n\r\n        // Render the accordionItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            ordinal: properties.ordinal,\r\n            displayName: properties.displayName,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Fires when the accordionItem is selected \r\n    */\r\n    activate: function () {\r\n        var self = this;\r\n        self.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Group Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a group container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.group\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property \r\n        properties.cssclass = properties.cssclass || \"cssClassContainer\";\r\n\r\n        properties.collapse = (typeof properties.collapse != \"undefined\" && bizagi.util.parseBoolean(properties.collapse)) ? true : false;\r\n    },\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"group\");\r\n\r\n        // Define icons\r\n        self.expandedIcon = self.getExpandedIcon();\r\n        self.collapsedIcon = self.getCollapsedIcon();\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            expandedClassIcon: self.expandedIcon,\r\n            displayName: properties.displayName,\r\n            editable: properties.editable,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            collapse: properties.collapse,\r\n            isDesign: (self.getMode() !== \"execution\"),            \r\n            messageValidation: properties.messageValidation,\r\n            cssclass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Returns the expanded icon\r\n    */\r\n    getExpandedIcon: function () { },\r\n\r\n    /*\r\n    *   Returns the collapsed icon\r\n    */\r\n    getCollapsedIcon: function () { },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument, bImmediate) { }\r\n\r\n});","/*\r\n*   Name: BizAgi Horizontal Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a tab item class for all devices\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.horizontal\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"horizontal\");\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.panel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"panel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            loading: properties.loading,\r\n            message: properties.message,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssClass: properties.cssclass\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function(panel) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set height\r\n        if (properties.height) {\r\n            panel.height(properties.height);\r\n        }\r\n\r\n        // Call base\r\n        self._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.contentPanel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"contentPanel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            mode: self.getMode(),\r\n            uniqueId: properties.uniqueId,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            cssClass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (panel) {\r\n        // Call base\r\n        this._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchForm\");\r\n\r\n\r\n        if (properties.contexttype != \"entity\" && self.parent) {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        } \r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n\r\n        // Render result\r\n        html = html.replace(\"{{result}}\", self.renderResult());\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Perform a search and render the results\r\n    */\r\n    performSearch: function (searchParams) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set parameter to search\r\n        properties.searchParams = searchParams;\r\n\r\n        // Submit the search to the server\r\n        self.submitSearch();\r\n    },\r\n\r\n    /*\r\n    *   Submits the query to the server\r\n    */\r\n    submitSearch: function () {\r\n        var self = this;\r\n\r\n        // Makes the results to update its contents\r\n        self.refreshResults();\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return self.parent.ready();\r\n    },\r\n\r\n    /*\r\n    *   Method to fill the result data\r\n    *   (THIS IS CALLED WITHIN GRID RENDER SCOPE)\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Collect data\r\n        var data = self.collectSearchValues();\r\n\r\n        if (bizagi.util.isMapEmpty(data)) {\r\n            bizagi.showMessageBox(this.getResource(\"render-search-advanced-no-filters\"), this.getResource(\"render-form-dialog-box-search\"), \"error\");\r\n            return null;\r\n        }\r\n\r\n        params.rows = (properties.searchParams && properties.searchParams.maxRecords && properties.searchParams.maxRecords > 0) ? properties.searchParams.maxRecords : params.rows;\r\n\r\n        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)         \r\n        if (properties.searchParams && typeof(properties.searchParams.maxRows) !== \"undefined\") {\r\n            params.rows = properties.searchParams.maxRows || params.rows;\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.submitSearch($.extend(params, {\r\n            url: properties.dataUrl,\r\n            idRender: properties.idRender,\r\n            idPageCache: properties.idPageCache,\r\n            idSearchForm: properties.id,\r\n            allowFullSearch: (properties.searchParams.allowFullSearch ? properties.searchParams.allowFullSearch : null),\r\n            maxRecords: (properties.searchParams.maxRecords > 0 ? properties.searchParams.maxRecords : null),\r\n            criteria: data\r\n\r\n        })).done(function (response) {\r\n\r\n            // Resolve with fetched data    \r\n            properties.page = response.page;\r\n            properties.records = response.records;\r\n            properties.totalPages = response.totalPages || 0;\r\n\r\n            //In tablets are allowed about 10000 records as maximum\r\n            if (response.records > 10000) {\r\n                properties.deviceMaxRecordsExceeded = true;\r\n                response.deviceMaxRecordsExceeded = true;\r\n            } else {\r\n                delete properties.deviceMaxRecordsExceeded;\r\n            }\r\n            \r\n            defer.resolve(response);\r\n\r\n            // Call virtual method\r\n            self.onSearchFinished();\r\n        }).fail(function (errorObject) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            if (errorObject.responseText) {\r\n                try {\r\n                    var message = JSON.parse(errorObject.responseText).message;\r\n                    bizagi.showMessageBox(message, \"\", \"error\");\r\n                } catch (e) { }\r\n            }\r\n            defer.reject();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    *   - Overriden because server needs this in array\r\n    */\r\n    collectSearchValues: function () {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = {};\r\n        this.collectRenderValues(data);\r\n\r\n        // Changes to array\r\n        var submitArray = [];\r\n        for (key in data) {\r\n            var xpath = key;\r\n            var value = data[key];\r\n            var operation = self.getCriteriaOperation(self.getRender(xpath));\r\n            var criteriaData = {};\r\n            if (!bizagi.util.isEmpty(value)) {\r\n                criteriaData[\"xpath\"] = xpath;\r\n                criteriaData[\"value\"] = value;\r\n                criteriaData[\"operation\"] = operation;\r\n                submitArray.push(criteriaData);\r\n            }\r\n        }\r\n\r\n        return submitArray;\r\n    },\r\n\r\n    /*\r\n    *   This method find out the criterial operation to be executed according to\r\n    *   data type. Text renders use LIKE operation, but other data types such like\r\n    *   numerics use exact match operatiors\r\n    */\r\n    getCriteriaOperation: function (render) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var operation = \"EQUALS\";\r\n        if (render.properties.dataType == \"15\") {\r\n            if (typeof render.properties.typeSearch === \"undefined\" || render.properties.typeSearch === \"approx\"){\r\n                if (properties.allowFullSearch) {\r\n                    operation = \"FULLLIKE\";\r\n                }\r\n                else {\r\n                    operation = \"LIKE\";\r\n                }\r\n            }\r\n        }\r\n        return operation;\r\n    },\r\n\r\n    /*\r\n    *   Render the result controls for the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () { },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () { },\r\n\r\n    /*\r\n    *   Function to parse the dataType\r\n    */\r\n    parseAdditionalProperties: function (dataType) {\r\n\r\n        // Number\r\n        if (dataType == 1 || dataType == 2 || dataType == 3 ||\r\n            dataType == 4 || dataType == 6 || dataType == 7 ||\r\n            dataType == 10 || dataType == 11 ) {\r\n\r\n            return { type: \"columnNumber\" };\r\n        }\r\n\r\n\r\n        // Oracle Number\r\n        if (dataType == 29) {\r\n\r\n            return { type: \"columnNumberScientificNotation\" };\r\n        }\r\n\r\n        // Money\r\n        if (dataType == 8) {\r\n\r\n            return { type: \"columnMoney\" };\r\n        }\r\n\r\n        // Date\r\n        if (dataType == 12 || dataType == 13) {\r\n\r\n            return { type: \"columnDate\" };\r\n        }\r\n\r\n        // Boolean\r\n        if (dataType == 5) {\r\n\r\n            return { type: \"columnBoolean\" };\r\n        }\r\n\r\n        // Text\r\n        return { type: \"columnText\" };\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    onSearchFinished: function () {\r\n        // Empty function, overrided for Tablet version for now\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Tab Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a tab container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tab\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property\r\n        properties.cssclass = properties.cssclass || \"\";\r\n    },\r\n\r\n    /*\r\n     *   Render the container layout\r\n     */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var tabItems = $.map(self.children, function(child, key) {\r\n            child.properties.counter = key;\r\n            child.properties.tooltip =  child.properties.tooltip || child.properties.displayName || \"\";\r\n            return child.properties;\r\n        });\r\n        var template = self.renderFactory.getTemplate(\"tab\");\r\n        var mode = self.getMode();\r\n\r\n        // Render the tab\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            tabs: tabItems,\r\n            mode: mode,\r\n            isDesign: (self.getMode() !== \"execution\"),\r\n            editable: properties.editable,\r\n            tabOrientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssclass: properties.cssclass\r\n        });\r\n\r\n        // Get active container based on focus\r\n        var activeTab = self.activeTab = self.getActiveTab();\r\n\r\n        // Render children\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            self.children[i].properties.loadOnDemand = (i != activeTab);\r\n        }\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Return the active tab containing the focus, or the first tab\r\n     */\r\n    getActiveTab: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = this.getFormContainer().getParams();\r\n        var mode = self.getMode();\r\n\r\n        if (mode === \"execution\") {\r\n            if (!formParams.isRefresh && properties.activeTab) {\r\n                self.getFormContainer().setFocusedElement(properties.activeTab);\r\n            }\r\n        }\r\n\r\n        var selectedTabs = formParams && formParams.selectedTabs ? formParams.selectedTabs : {};\r\n\r\n        // Fetch from selected tabs collection\r\n        if (selectedTabs[self.properties.id] >= 0) {\r\n            return selectedTabs[self.properties.id];\r\n        }\r\n\r\n        // Check for focused elements\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            if (self.children[i].containsFocusedElement()) return i;\r\n        }\r\n        return 0;\r\n    },\r\n\r\n    /**\r\n     * Update position of tab\r\n     * @param index\r\n     */\r\n    setActiveTab: function (index) {\r\n        var self = this;\r\n\r\n        self.triggerHandler(\"selected\", { index: index, tab: self.children[index] });\r\n\r\n        if (self.children[index]) {\r\n            var form = self.getFormContainer();\r\n\r\n            self.children[index].activate();\r\n            self.activeTab = index;\r\n\r\n            var selectedTab = {};\r\n            selectedTab[self.children[index].parent.properties.id] = index;\r\n            form.setParam(\"selectedTabs\", selectedTab);\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Tab Item Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a tab item class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"tabItem\");\r\n\r\n        // Render the tabItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            uniqueId: properties.uniqueId,\r\n            counter: properties.counter,\r\n            isDesign: (self.getMode() !== \"execution\")\r\n        });\r\n\r\n        // Render content\r\n        html = self.renderTabContent(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        // Render children\r\n        return this.replaceChildrenHtml(html, this.renderChildrenHtml());\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected \r\n    */\r\n    activate: function () {\r\n        this.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    },\r\n\r\n    /*\r\n    *   Return true if this tab contains the active focused element\r\n    */\r\n    containsFocusedElement: function () {\r\n        var self = this;\r\n        var focus = self.getFormContainer().getFocusedElement();\r\n\r\n        if (focus) {\r\n\r\n            // Locate element\r\n            if (focus.xpath) {\r\n                // Search by xpath and id\r\n                var elements = self.getFormContainer().getRenders(focus.xpath);\r\n                var element;\r\n\r\n                $.each(elements, function (i, item) {\r\n                    // Just select editable control\r\n                    if (item.properties.id == focus.id && item.properties.editable) {\r\n                        element = item;\r\n                    }\r\n                });\r\n            } else {\r\n                // Search just using id\r\n                var element = self.getFormContainer().getContainer(focus) || self.getFormContainer().getRenderById(focus);\r\n            }\r\n\r\n            // Search element parent\r\n            if (element) {\r\n                while (element.parent) {\r\n                    if (element.properties.id == self.properties.id || element.parent.properties.id == self.properties.id) return true;\r\n                    element = element.parent;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Render Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.render\", {\r\n    postRenderTimeout: 0,\r\n    maxRendersPerScreen: 50,\r\n    rendersExecuted: 0,\r\n    renderOptimization: false,\r\n    TYPE_QUERY_FORM: \"queryForm\",\r\n    startOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 500;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        // Cancelled optimization temporally, because its on experimental stage\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    },\r\n    stopOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 0;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    }\r\n}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.included = (typeof properties.included != \"undefined\") ? bizagi.util.parseBoolean(properties.included) : false;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.displayName = properties.displayName || \"\";\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.includedInResult = (typeof properties.includedInResult != \"undefined\") ? bizagi.util.parseBoolean(properties.includedInResult) : false;\r\n\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n        if (/^hidden$/i.test(renderType)) {\r\n            properties.visible = false;\r\n        }\r\n\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.maxLength = properties.maxLength || 0;\r\n        properties.helpText = bizagi.util.trim(properties.helpText) || \"\";\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.valueFormat = properties.valueFormat || {};\r\n        properties.isHidden = (typeof properties.isHidden != \"undefined\") ? bizagi.util.parseBoolean(properties.isHidden) : false;\r\n        properties.visible = (properties.isHidden) ? false : properties.visible;\r\n\r\n        // Old color and background color\r\n        if (properties.color) {\r\n            properties.textFormat.color = properties.color;\r\n        }\r\n\r\n        if (properties.backgroundColor) {\r\n            properties.textFormat.backgroundColor = properties.backgroundColor;\r\n        }\r\n\r\n        // Non-editable fields cannot be required\r\n        properties.required = properties.editable ? properties.required : false;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Check contexttype\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n\r\n        // Save original properties\r\n        self.originalProperties = {\r\n            textFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            valueFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            visible: properties.visible,\r\n            editable: properties.editable,\r\n            required: properties.required,\r\n            labelAlign: properties.labelAlign,\r\n            valueAlign: properties.valueAlign\r\n        };\r\n\r\n        // Create value property\r\n        self.value = typeof (properties.value) !== \"undefined\" ? properties.value : null;\r\n\r\n        // Register original value property\r\n        self.properties.originalValue = self.value;\r\n        self.properties.previousValue = self.value;\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n    /*\r\n    *   Calculate aligns, display types, rtl and widths\r\n    */\r\n    calculateInitialLayoutProperties: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set visual defaults\r\n        properties.displayType = properties.displayType || \"normal\";\r\n        properties.labelAlign = properties.labelAlign || self.getDefaultLabelAlign(properties.displayType);\r\n        properties.valueAlign = properties.valueAlign || self.getDefaultValueAlign(properties.displayType);\r\n\r\n        // Check rtl orientation\r\n        if (properties.orientation === \"rtl\") {\r\n            properties.labelAlign = self.getRTLAlign(properties.labelAlign);\r\n            properties.valueAlign = self.getRTLAlign(properties.valueAlign);\r\n        }\r\n\r\n        // Calculate render with\r\n        var renderWidth = self.calculateRenderWidth(properties.labelWidth, properties.valueWidth, properties.displayType);\r\n        properties.labelWidth = renderWidth.label;\r\n        properties.valueWidth = renderWidth.control;\r\n\r\n        if (properties.layoutType === \"percentage\") {\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.labelWidth == 0) {\r\n            properties.displayType = \"value\";\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.valueWidth == 0) {\r\n            properties.displayType = \"label\";\r\n        }\r\n\r\n        if (properties.type === \"userfield\") {\r\n            if (properties.displayType === \"both\") {\r\n                properties.valueWidth = properties.valueWidth || 50;\r\n                properties.labelWidth = properties.labelWidth || 50;\r\n            } else if (properties.displayType === \"vertical\") {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 100;\r\n            } else {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 0;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_RENDER;\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    render: function (renderTemplateName) {\r\n        return this.renderElement(renderTemplateName);\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    renderElement: function (renderTemplateName) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        // Start rendering deferred\r\n        self.renderingDeferred = new $.Deferred();\r\n\r\n        // Set render template\r\n        renderTemplateName = renderTemplateName || \"render\";\r\n        var renderTemplate = self.renderFactory.getTemplate(renderTemplateName);\r\n\r\n        // Resolve render label\r\n        var label = properties.displayName;\r\n        if (typeof label == \"string\") {\r\n            label = label.replaceAll(\"&\", \"&amp;\");\r\n            label = label.replaceAll(\"$\", \"&#36;\");\r\n            label = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            label = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n            label = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n            label = label.replaceAll(\"\\n\", \"<br/>\");\r\n        }\r\n\r\n        var isFullRender = bizagi.util.detectDevice() !== \"desktop\" && (properties.type === \"association\" || properties.type === \"uploadecm\" || ((properties.type === \"actionLauncher\" || properties.type === \"polymorphicLauncher\") && bizagi.util.isTabletDevice()) || (properties.type === \"grid\" && !bizagi.util.isTabletDevice()));\r\n        var labelWidth = parseFloat(properties.labelWidth);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(renderTemplate, {\r\n            label: label, helpText: properties.helpText,\r\n            editable: properties.editable,\r\n            isExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            tag: properties.tag,\r\n            displayType: properties.displayType,\r\n            displayOptionClass: self.getDisplayOptionClass(properties.displayType),\r\n            labelAlignClass: self.getAlignClass(properties.labelAlign),\r\n            valueAlignClass: self.getAlignClass(properties.valueAlign),\r\n            labelWidth: labelWidth,\r\n            stringLabelWidth: labelWidth + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            valueWidth: parseFloat(properties.valueWidth),\r\n            stringValueWidth: parseFloat(properties.valueWidth) + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            layoutType: properties.layoutType,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            printVersion: form.params.printversion,\r\n            cssClass: properties.cssclass || \"\",\r\n            includedInResult: properties.includedInResult,\r\n            included: properties.included,\r\n            type: properties.type,\r\n            showFullRender: isFullRender,\r\n            required: properties.required,\r\n            helpText: properties.helpText\r\n        });\r\n\r\n        // Render internal control html\r\n        var result = self.internalRenderControl();\r\n        if (!result) {\r\n            result = \"\";\r\n        }\r\n\r\n        // Check if this is an async element or not\r\n        var async = typeof (result) === \"object\" && result.done;\r\n        if (!async) {\r\n            html = self.replaceControlHtml(html, result);\r\n\r\n        } else {\r\n            if (result.state() === \"resolved\") {\r\n                // Fetch resolved result\r\n                html = self.replaceControlHtml(html, self.resolveResult(result));\r\n                self.asyncRenderDeferred = null;\r\n            } else {\r\n                // Wait for result\r\n                self.asyncRenderDeferred = result;\r\n                html = self.replaceControlHtml(html, \"\");\r\n            }\r\n        }\r\n\r\n        return html;\r\n    },\r\n    /*\r\n    *   Returns the resolved result from a promise when the promise has been executed already\r\n    */\r\n    resolveResult: function (promise) {\r\n        return bizagi.resolveResult(promise);\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred) {\r\n            return false;\r\n        }\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Renders the control html\r\n    */\r\n    internalRenderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.control = null;\r\n\r\n        if (self.renderFactory.printVersion) {\r\n            properties.editable = false;\r\n            return self.renderControl();\r\n        } else if (properties.editable) {\r\n            return self.renderControl();\r\n        }\r\n\r\n        return self.renderReadOnly();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set element variable\r\n        self.element = element;\r\n\r\n        if (properties.submitOnChange)\r\n            self.configureSubmitOnChange();\r\n\r\n        // Process internal layout\r\n        isLabelFormat = true;\r\n\r\n        var executePostRender = function (_element) {\r\n            if (bizagi.rendering.render.renderOptimization &&\r\n                bizagi.rendering.render.rendersExecuted > bizagi.rendering.render.maxRendersPerScreen) {\r\n\r\n                // Execute post-render control\r\n                setTimeout(function () {\r\n                    self.internalPostRender(_element);\r\n                    bizagi.rendering.render.postRenderTimeout += 50;\r\n                }, bizagi.rendering.render.postRenderTimeout);\r\n\r\n            } else {\r\n                self.internalPostRender(_element);\r\n            }\r\n            bizagi.rendering.render.rendersExecuted++;\r\n        };\r\n\r\n        if (self.asyncRenderDeferred) {\r\n            // Wait for async result\r\n            $.when(self.asyncRenderDeferred)\r\n                .done(function (html) {\r\n                    var control = self.getControl();\r\n                    if (typeof self.emptyControlByAsyncRenderDeferred == \"function\") {\r\n                        self.emptyControlByAsyncRenderDeferred();\r\n                    }\r\n                    control.append(html);\r\n\r\n                    // Execute post-render control\r\n                    executePostRender(element);\r\n                    self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n                });\r\n        } else {\r\n            // Execute post-render control\r\n            executePostRender(element);\r\n        }\r\n    },\r\n    /*\r\n    *   Executes the post render handlers\r\n    */\r\n    internalPostRender: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        self.control = self.getControl();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred) {\r\n            self.renderingDeferred.resolve();\r\n        }\r\n\r\n        // Execute post-renders\r\n        if (properties.editable) {\r\n            // Post-render editable version\r\n            if (self.renderFactory.printVersion && self.postRenderPrintVersion) {\r\n                self.postRenderPrintVersion();\r\n            } else {\r\n                self.postRender();\r\n            }\r\n\r\n        } else {\r\n            // Post-render readonly version\r\n            self.postRenderReadOnly(element);\r\n        }\r\n\r\n        // Perform execution mode methods\r\n        if (mode == \"execution\") {\r\n            self.performExecutionModeMethods();\r\n        } else {\r\n            self.performDesignModeMethods();\r\n        }\r\n\r\n        self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n        self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n    },\r\n    /*\r\n    *   Execute runtime only methods\r\n    */\r\n    performExecutionModeMethods: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (self.getFormType() == self.Class.TYPE_QUERY_FORM) {\r\n            self.configureHandlersQueryForm();\r\n        }\r\n\r\n        // Apply handlers\r\n        if (properties.editable) {\r\n            self.configureHandlers();\r\n        } else {\r\n            self.configureHandlersReadOnly();\r\n        }\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        var self = this;\r\n\r\n        // Execute custom code for each render\r\n        self.configureDesignView();\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /*\r\n    *   Replaces a {{control}} string in the specified element\r\n    */\r\n    replaceControlHtml: function (html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n        return html.replace(\"{{control}}\", replace);\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.element)) {\r\n            bizagi.log(\" render hasn't been rendered!\", this, \"error\");\r\n        }\r\n\r\n        return this.element;\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.internalSetInitialValueFlag = true;\r\n\r\n        // Set the initial value\r\n        if (properties.editable) {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        } else {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        }\r\n        self.internalSetInitialValueFlag = false;\r\n    },\r\n    /*\r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var inlineAdd = self.grid && self.grid.properties && self.grid.properties.inlineAdd;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false && !inlineAdd) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            var form = self.getFormContainer();\r\n            var hasValue = false;\r\n            var renders = self.grid ? [self] : form.getRenders(properties.xpath);\r\n            var isQueryForm = /^query/i.test(properties.type);\r\n\t               \r\n            renders.filter(function (render) {\r\n                return render.properties.id == properties.id;\r\n            }).forEach(function (render) {\r\n                if (render.hasValue() && (render.properties.editable || inlineAdd)) {\r\n                    hasValue = true;\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            if (!hasValue && !self.properties.isClone) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                var messageData = {xpath: properties.xpath, message: message};\r\n\r\n                if (isQueryForm) {\r\n                    messageData = $.extend({}, messageData, {\r\n                        id: properties.id,\r\n                        isQuery: isQueryForm\r\n                    });\r\n                }\r\n\r\n                invalidElements.push(messageData);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Check retypes\r\n        if (properties.retype == \"duplicate\") {\r\n            // Don't process cloned renders, just originals\r\n            if (self.cloneRender) {\r\n                if (self.cloneRender.getValue() != self.getValue()) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        } else if (properties.retype == \"double\") {\r\n            var control = $(\"input\", self.element);\r\n\r\n            //Waits until the control has the second value written\r\n            if (control && control.data(\"oldValue\")) {\r\n                if (control.val() === \"\") {\r\n\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({\r\n                        xpath: properties.xpath,\r\n                        message: message\r\n                    });\r\n\r\n                    return false;\r\n                } else if (control.val() != control.data(\"oldValue\")) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check maxlength\r\n        var columnEditable = self.grid && self.grid.getColumn ? self.grid.getColumn(self.properties.xpath).properties.editable : true;\r\n        if (properties.type !== \"userPassword\" && properties.maxLength !== undefined && properties.maxLength > 0 && bizagi.util.isNumeric(properties.maxLength)) {\r\n            if (columnEditable || (!columnEditable && self.controlValueIsChanged())) {\r\n                var maxLength = new Number(properties.maxLength);\r\n                var value = self.getValue();\r\n\r\n                if (value && value.toString().length > maxLength) {\r\n                    message = self.getResource(\"render-text-maxLength-error\").replaceAll(\"#maxLength#\", maxLength);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        // Next line decides if only spaces are accepted as valid texts or not. Anyway the spaces are still saved as self.value has not changed\r\n        var value = self.getValue();\r\n        value = (value && self.properties.type === \"text\") ? value.trim() : value;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {       \r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n    */\r\n    configureHandlersReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.getControl() == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        if (format.color) {\r\n            self.changeColor(format.color, isLabelFormat);\r\n        }\r\n        if (format.background) {\r\n            self.changeBackgroundColor(format.background);\r\n        }\r\n        //if bold is true in modeler, we receive nothing in execution (!formal.bold)\r\n        if (format.bold || !format.bold || !isLabelFormat) {\r\n            self.changeFontBold(format.bold, isLabelFormat);\r\n        }\r\n        if (format.italic) {\r\n            self.changeFontItalic(format.italic, isLabelFormat);\r\n        }\r\n        if (format.underline) {\r\n            self.changeFontUnderline(format.underline, isLabelFormat);\r\n        }\r\n        if (format.strikethru) {\r\n            self.changeFontStrikethru(format.strikethru, isLabelFormat);\r\n        }\r\n        if (format.size) {\r\n            self.changeFontSize(format.size, isLabelFormat);\r\n        }\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n        if (!visible) {\r\n            self.changeVisibility(visible);\r\n        }\r\n    },\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (!(bizagi.util.identicalObjects(value, self.value))) {\r\n            // set previous value\r\n            self.properties.previousValue = self.properties.originalValue = self.value;\r\n\r\n            // Change internal value\r\n            self.value = self.properties.value = value;\r\n            if (self.properties.required && self.getMode() == \"execution\") {\r\n\r\n                if (self.checkRequired([])) {\r\n                    self.changeRequiredLabel(false);\r\n                } else {\r\n                    self.changeRequiredLabel(true);\r\n                }\r\n            }\r\n\r\n            // Trigger events\r\n            if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n                self.triggerRenderChange();\r\n                self.triggerRenderValidate();\r\n            }\r\n        }\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (!self.hasValue()) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    validateInputRetype: function () {\r\n        var self = this;\r\n        if (self.properties.retype && self.cloneRender) {\r\n            return self.getValue() == self.cloneRender.getValue();\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Triggers the render change event\r\n    */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.changed = params.changed !== undefined ? params.changed : true;\r\n        self.triggerHandler(\"renderchange\", {render: self, changed: params.changed});\r\n    },\r\n    /*\r\n    *   Triggers the render validate event\r\n    */\r\n    triggerRenderValidate: function () {\r\n        var self = this;\r\n        self.triggerHandler(\"rendervalidate\", {render: self});\r\n    },\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable && (self.properties.display !== \"check\" || (self.properties.display === \"check\" && bizagi.override.enableCheck === true))) {\r\n            // Render as simple value\r\n            var displayValue = self.getDisplayValue(value);\r\n            if (typeof (displayValue) == \"string\" || typeof (displayValue) == \"number\") {\r\n                displayValue = bizagi.util.sanitizeHTML(displayValue);\r\n                $(control).html(\"<label class='readonly-control'>\" + displayValue + \"</label>\");\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the internal value\r\n    */\r\n    getValue: function () {\r\n        return this.value;\r\n    },\r\n    /*\r\n    *   Returns the value to display, ex. non-editable renders\r\n    */\r\n    getDisplayValue: function () {\r\n        return this.getValue();\r\n    },\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        bizagi.util.mustImplement(\"getLabel\");\r\n    },\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        bizagi.util.mustImplement(\"getControl\");\r\n    },\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        bizagi.util.mustImplement(\"getControlFiller\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n    },\r\n    /*\r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        this.validationMessage = message;\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var result = this.getValue();\r\n        var readOnlyValue = \"\";\r\n\r\n        if (bizagi.util.isObject(result) && typeof (result.value) !== \"undefined\") {\r\n            readOnlyValue = bizagi.util.sanitizeHTML(result.value);\r\n        } else if (!bizagi.util.isEmpty(result)) {\r\n            if (bizagi.util.isString(result)) {\r\n                readOnlyValue = bizagi.util.decodedDisplayValue(result);\r\n            } else {\r\n                readOnlyValue = result;\r\n            }\r\n        }\r\n\r\n        return readOnlyValue;\r\n    },\r\n\r\n    /*\r\n    *  Method to render print version\r\n    */\r\n    postRenderPrintVersion: function () {\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        this.properties.displayType = displayType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        this.properties.labelAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        this.properties.valueAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label and value width\r\n    */\r\n    customizeRenderWidth: function () {\r\n    },\r\n\r\n    /* Customizes render color*/\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    if (self.properties.type == \"grid\") {\r\n                        self.getControl().find(\".bz-mobile-grid__header-title\").each(function () {\r\n                            this.style.setProperty('color', color, 'important');\r\n                        });\r\n                    }\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n                    if (self.properties.editable === false) {\r\n                        self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                        self.getElementsToStylize($(\"label\", self.getControl()).css(\"color\", color, \"!important\"));\r\n                    }\r\n                }\r\n            } else {\r\n                self.element.css(\"color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"color\", \"\");\r\n                self.getControl().css(\"color\", \"\");\r\n\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    self.getElementsToStylize(element).css(\"color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes render background color*/\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                self.element.each(function () {\r\n                    this.style.setProperty('background-color', color, 'important');\r\n                });\r\n\r\n                if (typeof (label.find('label').style) !== \"undefined\") {\r\n                    self.getLabel().find(\"label\").style(\"background-color\", color, \"important\");\r\n                } else {\r\n                    self.getLabel().find(\"label\").css(\"background-color\", color, \"!important\");\r\n                }\r\n\r\n                var currentStyle = self.getLabel().attr(\"style\");\r\n                currentStyle += \"; background-color:\" + color + \"!important\";\r\n                self.getLabel().attr(\"style\", currentStyle);\r\n            } else {\r\n                self.element.css(\"background-color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"background-color\", \"\");\r\n                self.getControl().css(\"background-color\", \"\");\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    $(element).css(\"background-color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Returns the formatting label to be used for bold, italic, underline, strikethrough and size*/\r\n    getFormattingLabel: function () {\r\n        var self = this;\r\n        return self.getLabel().find(\"label\");\r\n    },\r\n\r\n    /* Customizes the font weight */\r\n    changeFontBold: function (bold, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(bold) != false && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"font-weight\", \"bold\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n            });\r\n\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"font-weight\", \"normal\", \"!important\");\r\n        }\r\n        if (!isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(bold) == true) {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n                });\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"normal\", \"!important\");\r\n                });\r\n                self.getControl().css(\"font-weight\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n        var result = true;\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (renderType === \"grid\" && self.ready().state() === \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\",\"radio\", \"queryRadio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n            if (value && value.length !== undefined) {\r\n                value = value[0];\r\n            }\r\n            if (compareValue && compareValue.length !== undefined) {\r\n                compareValue = compareValue[0];\r\n            }\r\n            if (baseValue && baseValue.length !== undefined) {\r\n                baseValue = baseValue[0];\r\n            }\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            baseValue = baseValue && baseValue.id ? baseValue.id : baseValue;\r\n            if (typeof baseValue != \"undefined\" && baseValue != null) {\r\n                result = (compareValue == value) && (compareValue != baseValue) ? false : true;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"boolean\" || renderType === \"queryBoolean\" || renderType === \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (renderType === \"searchNumber\") {\r\n            result = !!(value);\r\n        } else if (renderType === \"number\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"text\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"date\") {\r\n            if (!compareValue && !value) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"actionLauncher\") {\r\n            //Object must be an array\r\n            result = false;\r\n            var compareValueObj = [];\r\n            try {\r\n                if (typeof compareValue === \"string\") {\r\n                    compareValueObj = JSON.parse(compareValue);\r\n                } else {\r\n                    compareValueObj = compareValue;\r\n                }\r\n            } catch (e) {\r\n            }\r\n\r\n            var _findAction = function (guid, targetObj) {\r\n                guid = guid || \"\";\r\n                targetObj = targetObj || [];\r\n                var result = false;\r\n                for (var i = 0, l = targetObj.length; i < l; i++) {\r\n                    if (targetObj[i].guidAction == guid) {\r\n                        result = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n\r\n            if (compareValueObj.length == value.length) {\r\n                for (var i = 0, l = compareValueObj.length; i < l; i++) {\r\n                    if (!_findAction(compareValueObj[i].guidAction, value)) {\r\n                        result = true;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"polymorphicLauncher\" || renderType === \"entityTemplate\") {\r\n            //Object must be an array\r\n            if (compareValue.length != value.length) {\r\n                result = true;\r\n            } else {\r\n                result = (JSON.encode(value) == JSON.encode(compareValue)) ? false : true;\r\n            }\r\n        } else if (renderType === \"image\") {\r\n            if (compareValue == null && value.indexOf(true) < 0) {\r\n                result = false;\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"searchList\") {\r\n            var objectValue = {};\r\n            try {\r\n                objectValue = JSON.parse(value);\r\n            } catch (e) {\r\n                console.log(\"Error when detect change value on searchList control\")\r\n            }\r\n            result = (JSON.encode(compareValue) == JSON.encode(objectValue.value)) ? false : true;\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /* Customizes the font italic style */\r\n    changeFontItalic: function (italic, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"italic\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"italic\", \"!important\");\r\n                }\r\n            } else {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"normal\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"normal\", \"!important\");\r\n                }\r\n            }\r\n        } else {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n            } else {\r\n                self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font underline */\r\n    changeFontUnderline: function (underline, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var strikethru = bizagi.util.parseBoolean(textFormat.strikethru) ? \"line-through \" : \"\";\r\n        var valuestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(underline) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", strikethru + \"underline\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                self.getElementsToStylize(element).css(\"text-decoration\", strikethru + \"underline\");\r\n            });\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", strikethru, \"!important\");\r\n        }\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(underline) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font Strikethrough property */\r\n    changeFontStrikethru: function (strikethru, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var underline = bizagi.util.parseBoolean(textFormat.underline) ? \"underline \" : \"\";\r\n        var valueunderline = bizagi.util.parseBoolean(valueFormat.underline) ? \"underline \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(strikethru) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", underline + \"line-through\", \"!important\");\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", underline, \"!important\");\r\n        }\r\n\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(strikethru) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                }\r\n            } else {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline, \"!important\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font size property */\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (size != \"0\") {\r\n            var label = self.getFormattingLabel();\r\n            var newFontSize = (100 + Number(size) * 10) + \"%\";\r\n            if (isLabelFormat) {\r\n                label.css(\"font-size\", newFontSize, \"!important\");\r\n            }\r\n            if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n                var control = self.getControl();\r\n                if (typeof control.children() == \"object\" && control.children().length > 0) {\r\n                    self.getElementsToStylize(control.children()).css(\"font-size\", newFontSize, \"!important\");\r\n                } else {\r\n                    self.getElementsToStylize(control).css(\"font-size\", newFontSize, \"!important\");\r\n                    // Next line applies to Cascading combo and combo in order to increase the control space with large value fonts\r\n                    if (self.properties.type.indexOf(\"ombo\") != -1 && size > 4) (\".ui-selectmenu\", control).children(0).height(2 * size + 20);\r\n                }\r\n\r\n                self.getElementsToStylize(control.find(\".ui-bizagi-render-date\")).css(\"line-height\", \"normal\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * in mobiles, don't apply styles to icon's elements\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(context);\r\n    },\r\n\r\n    /* Changes the render visibility*/\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            if (properties.type !== \"hidden\") {\r\n                self.element.show();\r\n                self.element.css(\"display\", \"\");\r\n\r\n                if (properties.required) {\r\n                    if (!self.hasValue()) {\r\n                        self.changeRequiredLabel(true);\r\n                    }\r\n                }\r\n            }\r\n        } else if (self.element) {\r\n            self.element.hide();\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n    /* Changes the render editability*/\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Renders again\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Clears control\r\n        control.empty();\r\n\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (typeof self.emptyControlByChangeEditability == \"function\")\r\n                    self.emptyControlByChangeEditability();\r\n                if (!self.asyncRenderDeferred)\r\n                    control.append(html);\r\n                self.postRenderElement(self.element);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * change cell editability and attach bindings\r\n    */\r\n    changeEditabilityCellControl: function (argument, key, xpath) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        var renderColumn = self.grid.getColumn(xpath);\r\n        var decorated = renderColumn.getDecorated(key);\r\n\r\n        // Renders again\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Clears control\r\n        control.empty();\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (!self.asyncRenderDeferred) {\r\n                    control.append(html);\r\n                }\r\n\r\n                self.postRenderElement(self.element);\r\n\r\n                if (properties.editable) {\r\n\r\n                    renderColumn.bind(\"rendered\", function () {\r\n                        renderColumn.readyDeferred.resolve();\r\n                    });\r\n\r\n                    decorated.unbind(\"renderchange\");\r\n\r\n                    // If the render changes set the flag on\r\n                    decorated.bind(\"renderchange\", function (render, args) {\r\n                        renderColumn.changed = true;\r\n                        self.grid.onCellChange(renderColumn, null, key, args);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (self.getMode() == \"execution\" && self.checkRequired([])) {\r\n            self.changeRequiredLabel(false);\r\n        } else if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * Does't change internal value of control, if you need it\r\n     * please use changeRequired method\r\n     *\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /*\r\n    *   Refresh the control with a new data\r\n    */\r\n    refreshControl: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalValue = self.value;\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id || \"\";\r\n\r\n        args = args || {};\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the ajax service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            idForm: idForm\r\n        })).pipe(function (data) {\r\n            // Clear variables\r\n            self.control = self.controlFiller = self.label = null;\r\n\r\n            // Update properties data\r\n            var currentElement = self.element;\r\n            self.initializeData(data.render);\r\n\r\n            // Render the control again\r\n            return $.when(self.render()).pipe(function (html) {\r\n                var result = $(html);\r\n                //Dont remove unused rendered var\r\n                var rendered = self.postRenderElement(result);\r\n                self.properties.originalValue = self.value;\r\n                return result;\r\n            }).pipe(function (result) {\r\n                // When the content has been post-renderized, replace it\r\n                currentElement.replaceWith(result);\r\n\r\n                // Prevent multiple refresh on grid\r\n                if (!self.grid) {\r\n                    self.triggerRenderChange({changed: false});\r\n                }\r\n\r\n                // Execute personalized stuff before to refresh it\r\n                self.afterToRefresh();\r\n            });\r\n\r\n        }).fail(function (message) {\r\n            var message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the control with a new data\r\n     */\r\n    refreshDesignControl: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Clear variables\r\n        self.control = self.controlFiller = self.label = null;\r\n\r\n        $.extend(data.render.properties, {\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: (properties.xpathContext || \"form\"),\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        // Update properties data\r\n        var currentElement = self.element;\r\n        self.initializeData(data.render);\r\n\r\n        // Render the control again\r\n        return $.when(self.render()).pipe(function (html) {\r\n            var result = $(html);\r\n            //Dont remove unused rendered var\r\n            var rendered = self.postRenderElement(result);\r\n            self.properties.originalValue = self.value;\r\n            return result;\r\n        }).pipe(function (result) {\r\n            // When the content has been post-renderized, replace it\r\n            currentElement.replaceWith(result);\r\n            self.triggerRenderChange();\r\n\r\n            // Execute personalized stuff before to refresh it\r\n            self.beforeToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(\"\");\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else if (self.properties.editable === false) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Updates original value for some comparisons\r\n    */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value;\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[properties.xpath] = value;\r\n                } else if (value === \"\" || value === null) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, otherwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Configure aditional Handlers for queryForm type\r\n    */\r\n    configureHandlersQueryForm: function () {\r\n        var self = this;\r\n        var checkIncluded = self.element.find(\".ui-bizagi-render-control-included\");\r\n        checkIncluded.change(function () {\r\n            self.properties.included = $(this).is(\":checked\");\r\n        });\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var queryValue = null;\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\") {\r\n                var isObject = typeof (value.id) !== \"undefined\";\r\n                if (isObject) {\r\n                    queryValue = (!bizagi.util.isEmpty(value.id)) ? [value] : null;\r\n                } else {\r\n                    queryValue = (value !== \"\") ? value : null;\r\n                }\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n\r\n                if (!(properties.display == \"check\" && properties.value == false)) {\r\n\r\n                    var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                    searchType = searchType.toUpperCase();\r\n                    var newParameter = {\r\n                        \"value\": queryValue,\r\n                        \"included\": self.properties.included,\r\n                        \"xpath\": properties.xpath,\r\n                        \"searchType\": searchType,\r\n                        \"orderType\": \"NONE\"\r\n                    };\r\n                    if (typeof properties.displayXpath !== \"undefined\" && properties.displayXpath !== \"\") {\r\n                        //newParameter.displayXpath= properties.xpath+\".\"+properties.displayXpath;\r\n                        newParameter.displayXpath = properties.displayXpath;\r\n                    }\r\n                    renderValues.push(newParameter);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n        var editable = properties.editable;\r\n\r\n        // The render can be sent if it is editable and is not \"display only\"\r\n        if (!displayOnly && editable) {\r\n            return true;\r\n        }\r\n\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n\r\n        if (properties.xpath) {\r\n            var form = self.getFormContainer();\r\n            if (form.getRenders(properties.xpath).length == 1) {\r\n                force = $.forceCollectData ? $.forceCollectData.toString() : false;\r\n                $.forceCollectData = force ? undefined : $.forceCollectData;\r\n                if (self.controlValueIsChanged()) {\r\n                    $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n                    return true;\r\n                }\r\n                $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *  Method to determine if the render value can be sent to search\r\n    */\r\n    canBeSentQueryForm: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function (time) {\r\n        var self = this;\r\n\r\n        // Focus is only allowed when the render is visible\r\n        if (!self.properties.visible) return;\r\n\r\n        // Call base\r\n        this._super();\r\n        var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n\r\n        // Configures effect\r\n        var effect = function () {\r\n            var control = self.getControl();\r\n            var defaultControl = (self.properties.type != \"grid\") ? $(\"input, select, option, textarea\", control) : $(\"input, select, option, textarea\", control).first();\r\n            if (defaultControl.length > 0) {\r\n\r\n                // Focus control\r\n                $.each(defaultControl, function (i) {\r\n                    var innerControl = defaultControl[i];\r\n                    if ($(innerControl).attr(\"type\") != \"hidden\" && $(innerControl).css(\"display\") != \"none\" && $(innerControl).css(\"visibility\") != \"hidden\") {\r\n\r\n                        try {\r\n                            if (!bizagi.util.isIE()) {\r\n                                bizagi.util.autoScrollBottom(layout);\r\n                            }\r\n                            innerControl.focus();\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // Wait until the render is ready to apply the focus effect\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Run effect\r\n                if (time > 0) {\r\n                    setTimeout(effect, time);\r\n                } else {\r\n                    effect();\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Resolves default align for each display type\r\n    */\r\n    getDefaultLabelAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n\r\n    /*\r\n    *   Resolves default value align for each display type\r\n    */\r\n    getDefaultValueAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n    /*\r\n    *   Transform the align type when using RTL orientation\r\n    */\r\n    getRTLAlign: function (align) {\r\n        /* if (align === \"default\"){ \r\n            return \"right\";\r\n        } */\r\n        return align;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = \"\";\r\n\r\n        if (!properties.editable) return;\r\n\r\n        // Build action\r\n        properties.dependencies = properties.dependencies || 'all';\r\n\r\n        if (properties.xpath) {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.xpath;\r\n            } else {\r\n                xpath = properties.xpath;\r\n            }\r\n        } else {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.id;\r\n            } else {\r\n                xpath = properties.id;\r\n            }\r\n        }\r\n\r\n        var action = {\r\n            \"conditions\": {\r\n                \"expressions\": [\r\n                    {\r\n                        \"simple\": {\r\n                            \"xpath\": xpath,\r\n                            \"operator\": \"changes\",\r\n                            \"argumentType\": \"const\"\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            \"commands\": [\r\n                {\r\n                    \"xpath\": xpath,\r\n                    \"command\": 'submit-value',\r\n                    \"argument\": properties.dependencies\r\n                }\r\n            ],\r\n            \"dependencies\": [xpath],\r\n            \"elseCommands\": []\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready()).done(function () {\r\n            var form = self.getFormContainer();\r\n            form.addSubmitAction(xpath, action);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    submitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Add context parameter\r\n        if (self.properties.contexttype != \"\" && data) {\r\n            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = self.properties.contexttype;\r\n        }\r\n\r\n        $.when(self.isReadyToSave()).done(function () {\r\n            self.internalSubmitOnChange(data, bRefreshForm, notCollect).done(function () {\r\n                defer.resolve();\r\n            }).fail(function () {\r\n                defer.reject();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getCacheIdCase: function () {\r\n        var self = this;\r\n        var idCase = self.getParams().idCase;\r\n\r\n        if (bizagi.cache === undefined) {\r\n            bizagi.cache = {};\r\n            bizagi.cache.idCaseObject = {\r\n                idCase: idCase !== undefined ? idCase : (bizagi.cache.idCase !== undefined ? bizagi.cache.idCase : undefined)\r\n            };\r\n        } else {\r\n            if (idCase !== undefined && bizagi.cache.idCaseObject !== undefined) {\r\n                bizagi.cache.idCaseObject.idCase = idCase;\r\n            } else {\r\n                if (idCase !== undefined && bizagi.cache.idCaseObject === undefined) {\r\n                    bizagi.cache.idCaseObject = {};\r\n                    bizagi.cache.idCaseObject.idCase = idCase;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (idCase === undefined) {\r\n            if (bizagi.cache.idCaseObject === undefined) {\r\n                idCase = undefined;\r\n            } else {\r\n                idCase = bizagi.cache.idCaseObject.idCase;\r\n            }\r\n        } else {\r\n            idCase = idCase;\r\n        }\r\n\r\n        return idCase;\r\n    },\r\n    /*\r\n    *   Internal method\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    internalSubmitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n        var parameters = {\r\n            data: data,\r\n            bRefreshForm: bRefreshForm,\r\n            notCollect: notCollect,\r\n            properties: {\r\n                idCase: self.getCacheIdCase(),\r\n                id: properties.id,\r\n                xpath: properties.xpath,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }\r\n        }\r\n\r\n        return form.internalSubmitOnChange(parameters);\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Calculates render label and value width\r\n    */\r\n    calculateRenderWidth: function (labelWidth, valueWidth, displayType) {\r\n        var self = this;\r\n        // Read values\r\n        // If the label width or the value width are 0, the BAS means that no value is used, so we need to adjust them to 50%\r\n        if (valueWidth == \"100\" && typeof labelWidth === \"undefined\") {\r\n            labelWidth = \"0\";\r\n        } else {\r\n            labelWidth = labelWidth ? (labelWidth != \"0\" ? labelWidth : \"50\") : \"50%\";\r\n        }\r\n        valueWidth = valueWidth ? (valueWidth != \"0\" ? valueWidth : \"50\") : \"50%\";\r\n\r\n        if (displayType == \"normal\" || displayType == \"both\" || displayType == \"reversed\") {\r\n\r\n            // Special case with lower values, so they want both fields in \"auto\" width\r\n            if (labelWidth && bizagi.util.percent2Number(labelWidth) < 5 &&\r\n                valueWidth && bizagi.util.percent2Number(valueWidth) < 5) {\r\n                return {label: 0, control: 100};\r\n            }\r\n            // Normalize percentages\r\n            if (labelWidth && !valueWidth) {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = 100 - labelWidth;\r\n\r\n            } else if (!labelWidth && valueWidth) {\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n                labelWidth = 100 - valueWidth;\r\n            } else {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n\r\n                // Check 100% percentage\r\n                if ((labelWidth + valueWidth) != 100 && typeof (self.properties) != \"undefined\" && self.properties.layoutType != \"pixels\") {\r\n                    valueWidth = 100 - labelWidth;\r\n                }\r\n            }\r\n        } else {\r\n            labelWidth = 100;\r\n            valueWidth = 100;\r\n        }\r\n\r\n        return {label: labelWidth, control: valueWidth};\r\n    },\r\n    /*\r\n    *   Get param value idCase\r\n    */\r\n    getIdCase: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idCase || bizagi.context.idCase;\r\n    },\r\n    /*\r\n    *   Get param value idWorkitem\r\n    */\r\n    getIdWorkitem: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idWorkitem || bizagi.context.idWorkitem;\r\n    },\r\n    /*\r\n    *   Get param value idTask\r\n    */\r\n    getidTask: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idTask || bizagi.context.idTask;\r\n    },\r\n    /*\r\n    *   Get param value sessionId\r\n    */\r\n    getSessionId: function () {\r\n        var self = this;\r\n        return self.getFormContainer().properties.sessionId;\r\n    },\r\n\r\n    /*\r\n    *   CELL STUFF\r\n    *   TODO: Move to other place\r\n    */\r\n\r\n    /* Customizes cell color*/\r\n    changeCellColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (control) {\r\n            if (color != 'none') {\r\n                control.css(\"color\", color);\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", color);\r\n                });\r\n            } else {\r\n                control.css(\"color\", \"\");\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", \"\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Customizes cell background color\r\n     * @param color\r\n     */\r\n    changeCellBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var backgroundColor = \"\";\r\n        var backgroundImage = \"\";\r\n\r\n        if (control) {\r\n            if (color != 'none') {\r\n                backgroundColor = color;\r\n                backgroundImage = \"none\";\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                var needBGPaint = false;\r\n\r\n                control.find(\"input, textarea, .ui-selectmenu\").each(function (i, element) {\r\n\r\n                    if (((element.type == \"text\") || (element.type == \"textarea\")) && !($(element).hasClass('ui-select-data')))\r\n                        needBGPaint = true;\r\n\r\n                    $(element).css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n\r\n                if (!needBGPaint) {\r\n                    control.closest(\"td\").each(function (i, element) {\r\n                        $(element).css({\r\n                            \"background-color\": backgroundColor,\r\n                            \"background-image\": backgroundImage\r\n                        });\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                control.each(function (i, element) {\r\n                    //TODO: Validar si se aplican los estilos en tablet aun sin esta linea, cuidado con desktop\r\n                    var item = ($(element).hasClass(\"ui-bizagi-cell-readonly\")) ? control.closest(\"td\") : $(element);\r\n                    item.css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * Changes the cell visibility\r\n     * @param argument\r\n     */\r\n    changeCellVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Hide - show the render\r\n            if (bizagi.util.parseBoolean(argument) == true) {\r\n                //control.show();\r\n                control.css(\"visibility\", \"visible\");\r\n                control.css(\"display\", \"\");\r\n\r\n                self.element && self.element.show();\r\n            } else {\r\n                //control.hide();\r\n                control.css(\"visibility\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n\r\n    /**\r\n     * Changes the cell required\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Check if argument is true and control donot have any value\r\n            if (bizagi.util.parseBoolean(argument) == true && bizagi.util.isEmpty(self.value)) {\r\n                control.addClass('control-required');\r\n                control.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            } else {\r\n                control.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", control).remove();\r\n            }\r\n            // Update properties\r\n            properties.required = argument;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to create deferred at the moment to start multiaction\r\n     */\r\n    startActionExecution: function () {\r\n        var self = this;\r\n        self.startLoading();\r\n        self.actionExecutionDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * method to resolve the deferred when multiaction finish\r\n     */\r\n    endActionExecution: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n        if (self.actionExecutionDeferred) self.actionExecutionDeferred.resolve();\r\n        delete self.actionExecutionDeferred;\r\n    },\r\n\r\n    /**\r\n     * Method to return the promise to anyone that needs to know if multiaction ended\r\n     * @returns {*}\r\n     */\r\n    readyActionExecution: function () {\r\n        var self = this;\r\n        if (!self.actionExecutionDeferred) return $.when(true);\r\n        return self.actionExecutionDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Verifies is the elements was inside a new row in a grid\r\n     * @returns {boolean}\r\n     */\r\n    isFromCreatedRow: function () {\r\n        var self = this;\r\n\r\n        if (self.grid) {\r\n            var i = self.grid.columns.length;\r\n\r\n            while (i-- > 0) {\r\n                if (self.grid.columns[i].properties.xpath == self.properties.xpath) {\r\n                    if (self.grid.columns[i].isNewRow == true) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Submits a invalidate page cache request\r\n     * @param params\r\n     */\r\n    submitInvalidatePageCacheRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var pageCacheToInvalidate = params ? params.idPageCache : properties.idPageCache;\r\n\r\n\r\n        self.dataService.invalidatePageCache({idPageCache: pageCacheToInvalidate});\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isDesignMode: function () {\r\n        return this.getMode() === \"design\";\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isExecutionMode: function () {\r\n        return this.getMode() === \"execution\";\r\n    },\r\n\r\n    /***/\r\n    preventDefaultForAnchorTag: function(){        \r\n        if (bizagi.util.isSharepointContext()){\r\n            $(\"a\", this.getControl()).click(function(ev){\r\n                ev.preventDefault();          \r\n            });\r\n        }    \r\n    }\r\n});","/*\r\n *   Name: Bizagi Render Base Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.render.base\", {}, {\r\n\r\n    /**\r\n     * Method to process the render the layout\r\n     * @param {boolean} isLabelFormat\r\n     * @param {string} format\r\n     */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var properties = this.properties;\r\n\r\n        if (typeof isLabelFormat !== \"boolean\") {\r\n            console.warm(\"error calling processLayout, 'isLabelFormat' is not boolean\");\r\n            return;\r\n        }\r\n\r\n        if (isLabelFormat) {\r\n            this.processLabelLayout(format);\r\n        } else {\r\n            this.processControlLayout(format);\r\n\r\n            // Set required and visiblity\r\n            properties.required = typeof (properties.required) !== \"undefined\" ? bizagi.util.parseBoolean(properties.required) : false;\r\n            var visible = typeof (properties.visible) !== \"undefined\" ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n            if (properties.required) {\r\n                this.changeRequired(properties.required);\r\n            }\r\n\r\n            if (!visible) {\r\n                this.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to process the label in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processLabelLayout: function (format) {\r\n        var $label = this.getLabel();\r\n        if ($label == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n        if (typeof format.bold === \"undefined\") {\r\n            format.bold = true; // Default value\r\n        }\r\n\r\n        this.changeBackgroundColor(format.background)\r\n            .changeFontColor($label, format.color)\r\n            .changeFontBold($label, format.bold)\r\n            .changeFontSize($label, format.size)\r\n            .changeFontItalic($label, format.italic)\r\n            .changeTextDecoration($label, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Method to process the control in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processControlLayout: function (format) {\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        this.changeFontColor($elements, format.color)\r\n            .changeFontBold($elements, format.bold)\r\n            .changeFontItalic($elements, format.italic)\r\n            .changeFontSize($elements, format.size)\r\n            .changeTextDecoration($elements, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeColor: function (color) {\r\n        var $label = this.getLabel();\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        return this\r\n            .changeFontColor($label, color)\r\n            .changeFontColor($elements, color);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} $element\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeFontColor: function ($element, color) {\r\n        if ($element === undefined) return this;\r\n        if (color === undefined) return this;\r\n\r\n        var style = color !== \"none\" ? color : \"\";\r\n        $element.css(\"color\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font size property\r\n     * @param {} $element\r\n     * @param {} size\r\n     * @returns {}\r\n     */\r\n    changeFontSize: function ($element, size) {\r\n        if (size === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        if (size !== \"0\") {\r\n            var newFontSize = 100 + Number(size) * 10 + \"%\";\r\n            $element.css(\"font-size\", newFontSize);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font Strikethrough or underline property\r\n     * @param {} $element\r\n     * @param {} textDecoration\r\n     * @returns {}\r\n     */\r\n    changeTextDecoration: function ($element, textDecoration) {\r\n        if (textDecoration === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        textDecoration && $element.css(\"text-decoration\", textDecoration);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font italic style\r\n     * @param {} $element\r\n     * @param {} italic\r\n     * @returns {}\r\n     */\r\n    changeFontItalic: function ($element, italic) {\r\n        var style = bizagi.util.parseBoolean(italic) ? \"italic\" : \"normal\";\r\n\r\n        $element.css(\"font-style\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font weight\r\n     * @param {} $label\r\n     * @param {} bold\r\n     * @returns {}\r\n     */\r\n    changeFontBold: function ($label, bold) {\r\n        var style = bizagi.util.parseBoolean(bold) ? \"bold\" : \"normal\";\r\n\r\n        $label.css(\"font-weight\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes render background color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.element.css(\"background-color\", color);\r\n        } else {\r\n            this.element.css(\"background-color\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function () {\r\n    },\r\n\r\n    /**\r\n     * Change cell required and attach bindings\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * \r\n     */\r\n    getRTLAlign: function (align) {\r\n        if (typeof align == \"undefined\" || align == \"\") {\r\n            return \"default\";\r\n        }\r\n        return align;\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultLabelAlign: function(){\r\n        return \"default\";\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultValueAlign: function(){\r\n        return \"default\";\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop Render Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render base\r\nbizagi.rendering.render.extend(\"bizagi.rendering.desktop.render\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Add classic retype validation\r\n        if (properties.retype == \"double\") {\r\n            self.processClassicRetype();\r\n        }\r\n\r\n        // Add hint feature\r\n        if (properties.hint) {\r\n            self.processRenderHint();\r\n        }\r\n\r\n        // Hide icons if no helptext is provided\r\n        if (properties.helpText && properties.helpText.length > 0) {\r\n            self.showIcon(\"help\");\r\n        }\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.helpText && properties.helpText.length > 0) {\r\n            self.showIcon(\"help\");\r\n        }\r\n    },\r\n\r\n    // #region Process Layout\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        this._super(isLabelFormat, format);\r\n    },\r\n\r\n    // #endregion\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.element;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        var self = this;\r\n        if (!self.label) {\r\n            self.label = $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n        }\r\n        self.processLabelLineBreak(self.label);\r\n        return self.label;\r\n    },\r\n\r\n    processLabelLineBreak: function ($label) {\r\n        var label = $label.find(\"label\");\r\n        var text = label.text();\r\n        var reg = /\\\\n/g;\r\n        var array, result = \"\", lastIndex = 0;\r\n        while ((array = reg.exec(text)) !== null) {\r\n            if (lastIndex === 0) {\r\n                label.text(\"\");\r\n            }\r\n            label.append(text.substring(lastIndex, reg.lastIndex - 2));\r\n            label.append($(\"<br/>\"));\r\n            lastIndex = reg.lastIndex;\r\n        }\r\n        if (lastIndex !== 0) {\r\n            label.append(text.substring(lastIndex));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        if (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n            self.control = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n        if (!self.control || self.control.length == 0) {\r\n            return null;\r\n        }\r\n        return self.control;\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        var self = this;\r\n        if (!self.controlFiller) self.controlFiller = $(\".ui-bizagi-control\", self.element || self.observableElement);\r\n        return self.controlFiller;\r\n    },\r\n\r\n    /* \r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(message);\r\n\r\n        // DiegoP: Please don't remove this line again, this is intended to avoid performance problems in IE8\r\n        if (!bizagi.util.isIE8()) {\r\n\r\n            // Wait until element is ready\r\n            $.when(self.ready())\r\n    \t\t.done(function () {\r\n    \t\t    var element = self.element;\r\n\r\n    \t\t    // Set tooltip\r\n    \t\t    var iconError = $(\".ui-bizagi-render-icon-error\", element);\r\n    \t\t    var iconHelp = $(\".ui-bizagi-render-icon-help\", element);\r\n\r\n    \t\t    if (message && message.length > 0) {\r\n    \t\t        self.showIcon(\"error\");\r\n    \t\t        if (bizagi.util.isIE9()) {\r\n    \t\t            iconError.attr(\"data-title\", message);\r\n    \t\t        } else {\r\n    \t\t            iconError.attr(\"title\", message);\r\n    \t\t        }\r\n\r\n    \t\t        iconError.tooltip();\r\n    \t\t        $(iconError).parent().removeClass('ui-hidden');\r\n\r\n    \t\t        if(self.isNewRenderForm)\r\n    \t\t            $(iconError).parent().removeClass('bz-forms-icons__hidden');\r\n\r\n    \t\t    } else {\r\n    \t\t        self.hideIcon(\"error\");\r\n    \t\t        if ($(iconHelp).text() == \"\") {\r\n    \t\t            $(iconError).parent().addClass('ui-hidden');\r\n\r\n                        if(self.isNewRenderForm)\r\n    \t\t                $(iconError).parent().addClass('bz-forms-icons__hidden');\r\n    \t\t        }\r\n    \t\t    }\r\n    \t\t});\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Attach handlers to implement the classic retype option\r\n    */\r\n    processClassicRetype: function () { },\r\n\r\n    /* \r\n    *   Attach effects to implement render hint\r\n    */\r\n    processRenderHint: function () {\r\n        var self = this,\r\n            element = self.element,\r\n            properties = self.properties;\r\n\r\n        var input = $(\"input[type!=hidden], select\", element);\r\n        if (!input) return;\r\n\r\n        var span = input.parent();\r\n        if (!span) return;\r\n\r\n        // Add hint label\r\n        span.prepend('<label class=\"ui-bizagi-render-hint\">' + properties.hint + '</label>');\r\n        var hint = $(\".ui-bizagi-render-hint\", element);\r\n\r\n        // Bind events\r\n        input.focus(function () {\r\n            hint.addClass(\"focus\");\r\n        });\r\n        input.keypress(function () {\r\n            hint.addClass(\"has-text\").removeClass(\"focus\");\r\n        });\r\n        input.blur(function () {\r\n            if ($(this).val() == \"\") {\r\n                hint.removeClass(\"has-text\").removeClass(\"focus\");\r\n            }\r\n        });\r\n        hint.click(function () {\r\n            input.focus();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        // Set display type\r\n        if (displayType == \"normal\" ||\r\n            displayType == \"both\") {\r\n            return \"ui-bizagi-render-display-normal\";\r\n\r\n        } else if (displayType == \"vertical\") {\r\n            return \"ui-bizagi-render-display-vertical\";\r\n\r\n        } else if (displayType == \"reversed\") {\r\n            return \"ui-bizagi-render-display-reversed\";\r\n\r\n        } else if (displayType == \"verticalReversed\") {\r\n            return \"ui-bizagi-render-display-vertical-reversed\";\r\n\r\n        } else if (displayType == \"label\") {\r\n            return \"ui-bizagi-render-display-label\";\r\n\r\n        } else if (displayType == \"value\") {\r\n            return \"ui-bizagi-render-display-value\";\r\n        }\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        var self = this,\r\n        el = self.element;\r\n\r\n        // Call base\r\n        self._super(displayType);\r\n\r\n        // Clean old display type\r\n        el.removeClass(\"ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed\")\r\n          .removeClass(\"ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value\");\r\n\r\n        // Set display type\r\n        el.addClass(self.getDisplayOptionClass(displayType));\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        // Set label align\r\n        if (alignType == \"left\") {\r\n            return \"ui-bizagi-render-align-left\";\r\n\r\n        } else if (alignType == \"center\") {\r\n            return \"ui-bizagi-render-align-center\";\r\n\r\n        } else if (alignType == \"right\") {\r\n            return \"ui-bizagi-render-align-right\";\r\n        } else if (alignType == \"justify\") {\r\n            return \"ui-bizagi-render-align-justify\";\r\n        }\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get label\r\n        var label = self.getLabel();\r\n\r\n        // Remove old label align\r\n        label.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set label align\r\n        label.addClass(self.getAlignClass(alignType));\r\n\r\n        // Call base\r\n        this._super(alignType);\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get control\r\n        var controlFiller = self.getControlFiller();\r\n\r\n        // Remove old value align\r\n        controlFiller.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set value align\r\n        controlFiller.addClass(self.getAlignClass(alignType));\r\n\r\n        // Call base\r\n        this._super(alignType);\r\n    },\r\n\r\n    /* Return the icons container*/\r\n    getContainerIcons: function(){\r\n        return $(\".ui-bizagi-render-icons\", this.element);\r\n    },\r\n        \r\n    /*\r\n    *   Show a notification icon\r\n    */\r\n    showIcon: function (icon) {\r\n        var self = this;\r\n        var $containerIcons = self.getContainerIcons();    \r\n        var $errorIcon = $(\".ui-bizagi-render-icon-error\",  $containerIcons);\r\n        var $helpIcon =  $(\".ui-bizagi-render-icon-help\", $containerIcons);\r\n        var visibleIcon;\r\n\r\n        $containerIcons.removeClass('ui-hidden');\r\n\r\n        if(self.isNewRenderForm)\r\n            $containerIcons.removeClass('bz-forms-icons__hidden');\r\n\r\n        if (icon == \"error\") {  \r\n            visibleIcon = $errorIcon.css(\"display\", \"inline-block\");\r\n        }\r\n        if (icon == \"help\") {\r\n            visibleIcon = $helpIcon.css(\"display\", \"inline-block\");\r\n        }\r\n\r\n        if ($helpIcon.is(':visible') && $errorIcon.is(':visible')) {\r\n            $containerIcons.css({'width':'48px', 'min-width': \"48px\"});\r\n        } else if ($helpIcon.is(':visible') || $errorIcon.is(':visible')) {\r\n            $containerIcons.css({'width':'24px', 'min-width': \"24px\"});\r\n        }\r\n\r\n        // Make sure that icon container is visible\r\n        self.getControlFiller().addClass(\"ui-bizagi-state-show-icons\");\r\n\r\n        // Add hover handler in order to lazy-add the tooltip plugin\r\n        visibleIcon.mouseover(function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (visibleIcon.data(\"tooltip\") === undefined) {\r\n                // Apply tooltip plugin\r\n                visibleIcon.tooltip({\r\n                    tooltipClass: 'ui-widget-content ui-help-tooltip',\r\n                    items: visibleIcon.attr(\"title\") ? \".ui-icon[title]\" : \".ui-icon[data-title]\",\r\n                    content: function () {\r\n                        var reg = /<\\s*script[^>]*>[\\s\\S]*?(<\\s*\\/script[^>]*>|$)/ig;\r\n                        var element = $(this);\r\n                        var replaceHTML = !element.hasClass(\"ui-bizagi-render-icon-error\");\r\n                        //set the title as 'content' to apply possible html tags or styles included in original title\r\n                        if (element[0] && element[0].attributes[\"data-title\"]) {\r\n                            var text = element[0].attributes[\"data-title\"].value;\r\n                            if(reg.test(text)) {\r\n                                return bizagi.util.sanitizeHTML(text);\r\n                            } else {\r\n                                return text;\r\n                            }\r\n                        } else if (element[0] && element[0].title) {\r\n                            var _title = element[0].title;\r\n                            element[0].title = \"\";\r\n                            if(reg.test(_title)) {\r\n                                return bizagi.util.sanitizeHTML(_title);\r\n                            } else {\r\n                                return _title;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                visibleIcon.tooltip(\"open\");\r\n                $(\".ui-help-tooltip\").css(\"z-index\", $.ui.dialog.prototype._getMaxZindex());\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Show a notification icon\r\n    */\r\n    hideIcon: function (icon) {\r\n        var self = this;       \r\n        var containerIcons = $(\".ui-bizagi-render-icons\", self.element);\r\n        var errorIcon = $(\".ui-bizagi-render-icon-error\", self.element);\r\n        var helpIcon = $(\".ui-bizagi-render-icon-help\", self.element);\r\n\r\n        if (helpIcon.is(':visible') && errorIcon.is(':visible')) {\r\n            containerIcons.css({'width':'24px', 'min-width': \"24px\"});\r\n        }\r\n\r\n        if (icon == \"error\") {\r\n            $(\".ui-bizagi-render-icon-error\", self.element).css(\"display\", \"none\");\r\n        }\r\n        if (icon == \"help\") {\r\n            $(\".ui-bizagi-render-icon-help\", self.element).css(\"display\", \"none\");\r\n        }\r\n\r\n        // Hide icon container if no icons are shown\r\n        var iconContainer = $(\".ui-bizagi-render-icons span\", self.element);\r\n        if (iconContainer.length > 0 && iconContainer[0].style.display != \"none\") {\r\n            self.getControlFiller().removeClass(\"ui-bizagi-state-show-icons\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        // Set all controls read-only\r\n        var control = this.getControl();\r\n\r\n        // Valid control\r\n        if (control !== null) {\r\n            $(\"input, select, button, textarea\", control).attr(\"readonly\", true);\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Combo Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for combo renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.hasLocalData = properties.data || false;\r\n        // TODO: Review additional value in radio control\r\n        properties.value = properties.value && properties.value.length > 0 ? properties.value[0] : (properties.defaultValue && properties.defaultValue.length > 0 ? properties.defaultValue[0] : null);\r\n\r\n        if (typeof (properties.enableTyping) === \"undefined\") properties.enableTyping = true;\r\n        if (properties.value && properties.value.id === undefined) properties.value = null;\r\n        this.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData) {\r\n            properties.data = this.complementData(properties.data);\r\n        }\r\n\r\n        // This line is to set a flag to fetch the data when rendering, or on demand, by default is false, overriding it on desktop implementation\r\n        properties.loadOnDemand = false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var params = {};\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n\r\n        if (self.isDependant && self.properties && /^cascadingcombo$/i.test(renderType) && self.getParentCombo) {\r\n            var valueControl = self.getParentCombo().getValue();\r\n            if (valueControl && valueControl.id) {\r\n                params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = valueControl.id;\r\n            }\r\n        }\r\n\r\n        return self.renderCombo(params);\r\n    },\r\n\r\n    /*\r\n    *   Renders the combo\r\n    */\r\n    renderCombo: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.loadOnDemand) {\r\n            // Render the combo without data\r\n            var html = self.renderComboTemplate();\r\n            return html;\r\n        } else {\r\n\r\n            // Set data promise \r\n            var defer = new $.Deferred();\r\n            var dataPromise = self.getData(params);\r\n\r\n            // Attach callback \r\n            $.when(dataPromise).done(function (data) {\r\n                // Render combo\r\n                var html = self.renderComboTemplate(data);\r\n                self.properties.data = data;\r\n                defer.resolve(html);\r\n\r\n            }).fail(function (data) {\r\n                var html = self.renderComboTemplate({});\r\n                defer.resolve(html);\r\n            });\r\n\r\n            // Returns a promise so we can hold post-render method until this is done\r\n            return defer.promise();\r\n        }\r\n    },\r\n\r\n    renderComboTemplate: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var emptyValue = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n        var value = properties.value ? \"\" : emptyValue;\r\n        data = data || self.properties.data || {};\r\n\r\n        if (self.properties.type === \"columnCombo\" && value === \"\" && typeof properties.value === \"object\" && properties.value.id === \"\" && (properties.value.value === \"\" || properties.value.value === self.getResource(\"render-combo-empty-value\"))) {\r\n            value = self.getResource(\"render-combo-empty-selection\");\r\n        }\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: data,\r\n            align: properties.valueAlign,\r\n            value: value,\r\n            editable: properties.editable\r\n        }));\r\n\r\n\r\n        return html;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n        var item = self.getValue();\r\n        var control = self.getControl();\r\n\r\n        if (self.control && self.control.parent()) {\r\n            self.control.parent().addClass(\"ui-bizagi-noneditable-\" + self.properties.displayType);\r\n        }\r\n        if (item) {\r\n\r\n            if (item.value != null && typeof (item.value) === \"boolean\") {\r\n                if (bizagi.util.parseBoolean(item.value) === true) {\r\n                    item.value = this.getResource(\"render-boolean-yes\");\r\n\r\n                } else if (bizagi.util.parseBoolean(item.value) == false) {\r\n                    item.value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n\r\n            // Returns the cached value from the properties to avoid server side fetching\r\n            if (self.getResource(\"render-combo-empty-value\") === item.value || self.getResource(\"render-combo-empty-selection\") === item.value) {\r\n                control.text(\"\");\r\n            } else {\r\n                control.html(\"<label class='readonly-control'>\" + self.formatItem(item.value) + \"</label>\");\r\n            }\r\n        } else {\r\n            // Render empty \r\n            control.text(\"\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the template used by the combo render\r\n    *   can be overriden in subclasses to reuse logic and just change the template\r\n    */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the empty node or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showEmpty: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode !== \"execution\") return self.getDummyData();\r\n\r\n        if (properties.hasLocalData) {\r\n\r\n            // Resolve with local data    \r\n            defer.resolve(properties.data);\r\n\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n            // Check if the data has been cached\r\n            if (properties.remoteDataLoaded && !(/^cascadingcombo$/i.test(renderType))) {\r\n                defer.resolve(properties.data);\r\n            } else {\r\n                // Go to server\r\n                self.dataService.multiaction().getData({\r\n                    url: properties.dataUrl,\r\n                    xpath: properties.xpath,\r\n                    idRender: properties.id,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    extra: params,\r\n                    contexttype: self.properties.contexttype || null\r\n                }).done(function (data) {\r\n\r\n                    // Resolve the data\r\n                    if (!properties.recalculate) {\r\n                        properties.remoteDataLoaded = true;\r\n                    }\r\n                    properties.data = self.complementData(data);\r\n                    defer.resolve(properties.data);\r\n\r\n                }).fail(function (data) {\r\n\r\n                    if (data.type === \"not-processed\")\r\n                        return;\r\n\r\n                    // Show error from server\r\n                    var form = self.getFormContainer();\r\n                    var msgObj = self.properties.displayName + \": \";\r\n\r\n                    if (typeof data === \"string\") {\r\n                        var auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n                    } else {\r\n                        var auxMsg = data;\r\n                    }\r\n\r\n                    msgObj += auxMsg.message;\r\n\r\n                    form.addValidationMessage(msgObj);\r\n\r\n                    defer.reject(data);\r\n                });\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n    */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            properties.data = [];\r\n            properties.data = self.complementData(properties.data);\r\n\r\n            // Add another data\r\n            properties.data.push({id: \"\", value: \"Item 1\"});\r\n            properties.data.push({id: \"\", value: \"Item 2\"});\r\n\r\n            return properties.data;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Resets the data in order to fetch it again when needed\r\n    */\r\n    resetData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = null;\r\n        properties.remoteDataLoaded = false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n\r\n        if (self.combo && self.combo.length > 0) {\r\n            // When there is a combo painted, we fetch the selected value from it\r\n            return self.getSelectedValue();\r\n        } else {\r\n            var displayValue = \"\";\r\n            var item = self.getValue();\r\n\r\n            if (item) {\r\n                // Check on cached propert from server first if the key exists\r\n                displayValue = self.formatItem(item.value);\r\n            }\r\n\r\n            return displayValue;\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n    },\r\n\r\n    /*\r\n    *   Adds custom parameters to process the template\r\n    */\r\n    getTemplateParams: function () {\r\n        return {};\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n\r\n        if (value !== undefined && value !== null) {\r\n            if ($.isArray(value)) {\r\n\r\n                for (var i = 0, length = value.length; i < length; i++) {\r\n                    if (value[i] != null && typeof (value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                            value[i] = this.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                            value[i] = this.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n                return value.join(\" - \");\r\n            } else {\r\n                return value;\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos        \r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) === \"object\" && (value.id === undefined || value.id === \"\")) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                } else {\r\n                    // Add the value to the server\r\n                    renderValues[properties.xpath] = typeof (value.id) !== \"undefined\" ? value.id : \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentValue = self.getValue();\r\n        var originalValue = properties.originalValue;\r\n        var defaultValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if ($.forceCollectData) {\r\n            return result;\r\n        }\r\n\r\n        currentValue = currentValue && currentValue.length !== undefined ? currentValue[0] : currentValue;\r\n        originalValue = originalValue && originalValue.length !== undefined ? originalValue[0] : originalValue;\r\n        defaultValue = defaultValue && defaultValue.length !== undefined ? defaultValue[0] : defaultValue;\r\n\r\n        currentValue = currentValue && currentValue.id !== undefined ? currentValue.id : currentValue;\r\n        originalValue = originalValue && originalValue.id !== undefined ? originalValue.id : originalValue;\r\n        defaultValue = defaultValue && defaultValue.id !== undefined ? defaultValue.id : defaultValue;\r\n\r\n        if (defaultValue !== undefined) {\r\n            if (defaultValue != originalValue || defaultValue != currentValue) {\r\n                result = true;\r\n            } else {\r\n                result = false;\r\n            }\r\n        } else {\r\n            result = currentValue != originalValue ? true : false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Parses additional values info in order to format them correctly\r\n    */\r\n    parseAdditionalValues: function (data) {\r\n        var self = this;\r\n\r\n        return $.map(data, function (item) {\r\n            var value = item.value ? self.formatItem(item.value) : item;\r\n            var newItem = {id: item.id, value: value};\r\n\r\n            if (item.hidden) newItem.hidden = true;\r\n            return item;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Complement data from server before control implementation\r\n    */\r\n    complementData: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var bCurrentDataFound = false;\r\n        $.each(data, function (i, item) {\r\n\r\n            if (item.value !== undefined && item.value !== null) {\r\n                item.value = self.formatItem(item.value);\r\n                if (properties.value) {\r\n                    if (item.id == properties.value.id) {\r\n                        bCurrentDataFound = true;\r\n                    }\r\n                }\r\n            } else {\r\n                item.value = \"\";\r\n            }\r\n        });\r\n\r\n        // Add empty node if configured\r\n        if (self.showEmpty()) {\r\n            var emptyFound = false;\r\n            for (var i = 0, length = data.length; i < length; i++) {\r\n                if (data[i].id === \"\") {\r\n                    emptyFound = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!emptyFound) {\r\n                var dataValue = bizagi.override.emptyLabelForCombo || bizagi.localization.getResource(\"render-combo-empty-value\")\r\n                data.unshift({id: \"\", value: dataValue});\r\n            }\r\n        }\r\n\r\n        if (properties.value) {\r\n            if (!bCurrentDataFound && self.showCurrentData()) {\r\n                data.unshift({id: properties.value.id, value: properties.value.value, hidden: true});\r\n            }\r\n        }\r\n\r\n        // Add additional value\r\n        return self.parseAdditionalValues(data);\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        var currentValue = self.getValue();\r\n\r\n        if (bizagi.util.isEmpty(currentValue)) return false;\r\n        if (Object.prototype.toString.apply(currentValue) === \"[object Object]\" && (bizagi.util.isEmpty(currentValue.id) || currentValue.id == 0)) return false;\r\n\r\n        // Else\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    * Cleans current data\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        this.column && !this.column.comboData && this.getData();\r\n    },\r\n\r\n    isExtraItem: function () {\r\n        var self = this;\r\n        var data = self.value || {};\r\n        var value = data.value || \"\";\r\n\r\n        return value === \"\" || value === self.getResource(\"render-combo-empty-selection\") || value === self.getResource(\"render-combo-empty-value\");\r\n    },\r\n\r\n    escapeValue: function (value) {\r\n        if (bizagi.util.isString(value)) {\r\n            var valueToReturn = value.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            return valueToReturn;\r\n        } else {\r\n            return value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Maps the value, when this one comes from actions\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    validateValue: function (value) {\r\n        if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id !== null) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id\r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function (e) {\r\n            return e.id == id;\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render CollectionNavigator\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for collection navigator renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.collectionnavigator\", {}, {\r\n\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        self._super(params);\r\n\r\n        var properties = self.properties;\r\n        properties.allowAdd = (typeof properties.allowAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.withAddForm = properties.withAddForm && properties.allowAdd;\r\n        properties.allowEdit = (typeof properties.allowEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.withEditForm = properties.withEditForm && properties.allowEdit;\r\n        properties.allowDetail = (typeof properties.allowDetail != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n        properties.inlineAdd = (typeof properties.inlineAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineAdd) : true;\r\n        properties.inlineAdd = properties.inlineAdd && properties.allowAdd;\r\n        properties.inlineEdit = (typeof properties.inlineEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.inlineEdit = properties.inlineEdit && properties.allowEdit;\r\n        properties.allowDelete = (typeof properties.allowDelete != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        self.orientation = self.properties.orientation || \"ltr\",\r\n        self.data = self.properties.data;\r\n        self.keys = self.data ? self.getKeys(self.data.rows) : [];\r\n        self.pointer = 0;\r\n        self.totalRows = 0;\r\n        self.inlineAddRecords = [];\r\n\r\n        if (self.data) {\r\n            self.totalRows = self.data.rows.length;\r\n        }\r\n    },\r\n    /*\r\n    * Normalize keys\r\n    */\r\n    getKeys: function (rows) {\r\n        rows = rows || [];\r\n        var keys = [];\r\n\r\n        for (var i = 0, l = rows.length; i < l; i++) {\r\n            var row = rows[i];\r\n            keys.push(row[0]);\r\n        }\r\n        return keys;\r\n    },\r\n\r\n    /*\r\n    *   Render the control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var templateItem = \"collectionnavigator\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var mode = self.getMode();\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId,\r\n            displayName: properties.displayName ? properties.displayName : \"\",\r\n            id: properties.id,\r\n            guid: properties.guid,\r\n            showPreview: self.showPreview(),\r\n            mode: mode,\r\n            orientation: self.getFormContainer().properties.orientation\r\n        });\r\n\r\n        html = self.drawControls(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Render version readonly of control\r\n    */\r\n    renderReadOnly: function () {        \r\n        return this.renderControl();\r\n    },\r\n\r\n    /*\r\n    * Draw navigation controls\r\n    */\r\n    drawControls: function (html) {\r\n\r\n    },\r\n\r\n    /*\r\n    *  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw a preview views, it will be show when the collection hasn't records\r\n    */\r\n    drawPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var templateItem = (mode === \"execution\") ? \"collectionnavigator-execution\" : \"collectionnavigator-preview\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var html = $.tmpl(template);\r\n\r\n        self.canvas.append(html);\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns true if the collection has data\r\n    */\r\n    hasData: function () {        \r\n        return this.getTotalRows() > 0;\r\n    },\r\n\r\n    /*\r\n    * Returns the key of current row\r\n    */\r\n    getRow: function () {        \r\n        return this.keys[this.pointer];\r\n    },\r\n\r\n    /*\r\n    * Returns the key of next row\r\n    */\r\n    getNextRow: function () {\r\n        var self = this;\r\n\r\n        if (self.getTotalRows() > (self.pointer + 1))\r\n            self.pointer += 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of previous row\r\n    */\r\n    getPreviousRow: function() {\r\n        var self = this;\r\n\r\n        if (self.pointer > 0)\r\n            self.pointer -= 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of first row\r\n    */\r\n    getFirstRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = 0;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of last row\r\n    */\r\n    getLastRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = self.keys.length - 1;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the total numbers of rows in collection\r\n    */\r\n    getTotalRows: function () {        \r\n        return this.keys.length;\r\n    },\r\n\r\n    getIndexes: function () {        \r\n        return this.properties.data.rows;\r\n    },\r\n\r\n    /*\r\n    * Sets the pointer to a specific position\r\n    */\r\n    setPointer: function (index) {        \r\n        this.pointer = index - 1;\r\n    },\r\n\r\n    /*\r\n    * Returns true is there is a inline row pending to save\r\n    */\r\n    isTherePendingInlineRow: function() {\r\n        return this.inlineAddRecords.length > 0;\r\n    },\r\n\r\n    /*\r\n    * Adds new row to collection\r\n    */\r\n    addKey: function (newId) {        \r\n        this.keys.push(newId);\r\n    },\r\n\r\n    /*\r\n    * Removes row in collection\r\n    */\r\n    removeKey: function () {\r\n        var self = this;\r\n        var index = self.pointer;\r\n\r\n        if (index >= 0) {\r\n            self.keys.splice(index, 1);\r\n\r\n            var totalRows = self.getTotalRows();\r\n            if (totalRows > 0 && index >= totalRows) {\r\n                self.setPointer(totalRows);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns true if the control should show the preview view\r\n    * ex. if the collection is empty \r\n    */\r\n    showPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode == \"execution\") {\r\n            return !self.hasData();\r\n        } else {\r\n            return !bizagi.util.parseBoolean(properties.navigationform);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the parameters needed for the request\r\n    */\r\n    getParameters: function (params) {\r\n        var self = this;\r\n\r\n        var parameters = {};\r\n        var properties = self.properties;\r\n        var recordXpath = properties.xpath + \"[id=\" + params.id + \"]\";\r\n\r\n        parameters.idRender = properties.id;\r\n        parameters.recordXPath = recordXpath;\r\n        parameters.xpathContext = properties.xpathContext;\r\n        parameters.idPageCache = properties.idPageCache;\r\n        parameters.requestedForm = params.requestedForm;\r\n        parameters.contextType = properties.contextType || properties.contexttype;\r\n        parameters.url = params.url;\r\n        parameters.editable = params.editable;\r\n        orientation: properties.orientation || \"ltr\";\r\n\r\n\r\n        return parameters;\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator add record request\r\n    *   Returns a deferred when done, the server returns an id for the new record\r\n    */\r\n    submitAddRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype || '',\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({ message: message });\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + \"[id=\" + id + \"]\" : properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function() {\r\n\r\n            self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                contexttype: properties.contextType || properties.contexttype || \"\",\r\n                submitData: data\r\n            }).done(function(response) {\r\n                defer.resolve(response);\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n    \r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator rollback request\r\n    *   Returns a deferred when done\r\n    */\r\n    submitRollbackRequest: function (error) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: error.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache\r\n\r\n        });\r\n\r\n        return self.dataService.getData(params);\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var form = this.form;\r\n\r\n        if (typeof (form) !== \"undefined\") {\r\n            (form.children || []).forEach(function (child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        if (!child.isValid(invalidElements)) {\r\n                            var content = invalidElements[invalidElements.length - 1];\r\n                            invalidElements[invalidElements.length - 1] = $.extend(content, {\r\n                                id: child.properties.id\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length === 0;\r\n    },\r\n\r\n    validateControls: function(invalidElements) {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations(invalidElements);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Check Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for check renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.check\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n\r\n        properties.showLetters = (bizagi.override && bizagi.override.enableCheck === true) && !properties.editable;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"check\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmpty(value)) return false;\r\n\r\n        var booleanValue = bizagi.util.parseBoolean(value);\r\n\r\n        return !(booleanValue === false && this.properties.required);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Number Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.number\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = (typeof (properties.allowDecimals) !== \"undefined\") ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.setGroupDigits();\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n        properties.dataTypeMinValue = this.calculateMinValue(properties.dataType);\r\n        properties.dataTypeMaxValue = this.calculateMaxValue(properties.dataType);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"number\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            editable: self.properties.editable,\r\n            value: bizagi.isMobile() ? self.getDisplayValue() : \"\", // Only apply to mobile because in the template value is required (Bug: 11624)\r\n            type: bizagi.util.isAndroidDevice() ? \"tel\" : \"text\", // Change type control for android device\r\n            isDesign: self.getMode() !== \"execution\"\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = control.find(\"input\");\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numeric(self.properties.decimalSymbol);\r\n\r\n        // Attach event for retype double\r\n        if (properties.retype === \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        // Attach Format Currency Plugin to format the input\r\n        this.attachFormatCurrency();\r\n    },\r\n\r\n    /**\r\n     * Removes Validation Messages\r\n     */\r\n    removeValidations: function () {\r\n        var form = this.getFormContainer().parent || this.getFormContainer();\r\n\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,smartphone...).\r\n     * @returns {}\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Adds the format currency plugin\r\n     * @returns {}\r\n     */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message = bizagi.localization.getResource(\"render-number-retype-fail\");\r\n        self.isValidRender = self.isValidRender || true;\r\n\r\n        // Extend formatCurrency language\r\n        if ($.formatCurrency.regions[bizagi.language] == null)\r\n            $.formatCurrency.regions[bizagi.language] = this.getResource(\"numericFormat\");\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n            var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n            var decimalSeparator = \".\";\r\n            var digitGroupSeparator = \",\";\r\n            if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) == \"undefined\") {\r\n                decimalSeparator = self.getResource(\"numericFormat\").decimalSymbol || \".\";\r\n                digitGroupSeparator = self.getResource(\"numericFormat\").digitGroupSymbol || \",\";\r\n            }\r\n            else {\r\n                decimalSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator;\r\n                digitGroupSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator;\r\n            }\r\n\r\n            var minValue = self.getMinValue();\r\n            var maxValue = self.getMaxValue();\r\n\r\n            if(properties.percentage)self.numericInput.val(self.numericInput.val().replace(\"%\", \"\"));\r\n            var inputValue = self.numericInput.val();\r\n            inputValue = (decimalSeparator == \",\") ? inputValue.replace(/\\,0+$/, '') : inputValue.replace(/\\.0+$/, '');\r\n            inputValue = inputValue.replace(properties.symbol, \"\");\r\n            //Replace all the ocurrences of the digitGroupSeparator\r\n            inputValue = bizagi.util.replaceAll(inputValue, digitGroupSeparator, \"\");\r\n            if (inputValue.toString().indexOf(decimalSeparator) != -1) {\r\n                if (decimalSeparator == \",\") inputValue = inputValue.replace(/([0-9]+(\\,[0-9]+[1-9])?)(\\,?0+$)/, '$1');\r\n                if (decimalSeparator == \".\") inputValue = inputValue.replace(/([0-9]+(\\.[0-9]+[1-9])?)(\\.?0+$)/, '$1');\r\n            }\r\n\r\n            if (inputValue != undefined && inputValue.length > 0) self.numericInput.val(inputValue);\r\n\r\n            if (/(.+)-$/.test(inputValue)) {\r\n                inputValue = inputValue.replace(/(.+)-$/, '-$1');\r\n                self.numericInput.val(inputValue);\r\n            }\r\n\r\n            var inputLength = inputValue.replace(/[^0-9]+/g, \"\").length;\r\n            var xPath = self.properties.xpath;\r\n            var oldVal = self.numericInput.val();\r\n\r\n\r\n            if ((self.isInvalidFormat != null && self.isInvalidFormat == true)\r\n                || (inputValue != \"\" && [\"$\", \"£\", \"€\", \"¥\", properties.symbol].indexOf(inputValue) != -1)) {\r\n                self.setValue(\"\");\r\n                self.getControl().find(\"input\").val(\"\");\r\n                self.numericInput.val(\"\");\r\n                return;\r\n            }\r\n\r\n            if (bizagi.util.trim(inputValue) == \"\") {\r\n                self.setValue(\"\");\r\n                return;\r\n            }\r\n\r\n            //The \",\" is changed to \".\" For the correct operation of \"parseFloat ()\"\r\n            var tempValue = parseFloat(inputValue.replace(\",\", \".\"));\r\n            if (isNaN(tempValue)) {\r\n                tempValue = self.numericInput.asNumber();\r\n            }\r\n\r\n            if (minValue !== undefined && minValue != null && tempValue < minValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-minimum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#minValue#\", minValue.toString());\r\n            }\r\n            else if (maxValue !== undefined && maxValue !== null && tempValue > maxValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-maximum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#maxValue#\", maxValue.toString());\r\n            } else\r\n                message = message + \" \" + oldVal + \"\";\r\n\r\n\r\n            // Do datatype validations\r\n            if (\r\n                (minValue !== undefined && minValue !== null && tempValue < minValue)\r\n                || (maxValue !== undefined && maxValue !== null && tempValue > maxValue)\r\n                || (self.properties.dataType == 10 && inputLength > 15)\r\n                || (self.properties.dataType == 1 && inputLength > 19)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (oldVal.match(/[^$£€¥,-.()\\d]/))\r\n            ) {\r\n                if (typeof validationController != \"undefined\" && validationController != null) {\r\n                    self.removeValidations();\r\n\r\n                    var messageToShow = message;\r\n                    if(messageToShow.indexOf(oldVal) === -1){\r\n                        messageToShow = message + \" \" + oldVal + \"\";\r\n                    }\r\n\r\n                    validationController.showValidationMessage(messageToShow, xPath);\r\n                    self.isValidRender = false;\r\n                    self.isValidRenderMessage = messageToShow;\r\n                }\r\n                message = message.replace(oldVal, \"\");\r\n                return;\r\n            }\r\n            else {\r\n                self.isValidRender = true;\r\n                self.isValidRenderMessage = \"\";\r\n            }\r\n\r\n            // Fix decimals specially when it starts with 0 (0000234 -> 234, 00000 -> 0)\r\n            if (this.value.toString().length > 0 && !properties.allowDecimals && !properties.groupDigits) {\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (properties.symbol.length > 0) this.value = this.value.toString().replace(properties.symbol + \"0\", properties.symbol);\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (this.value.replaceAll('0', '').length == 0)\r\n                    this.value = properties.symbol + \"0\";\r\n                else if (this.value.toString() == parseInt(this.value)) this.value = properties.symbol + this.value;\r\n            } else {\r\n                //Fix type money when number start with 0 (0000234 -> 234, 00000 -> 0)\r\n                if(self.properties.type === \"money\" || self.properties.type === \"number\" || self.properties.type === \"columnMoney\" || self.properties.type === \"columnNumber\"){\r\n                    this.value = this.value.toString().replace(/^0+/, '');\r\n                    if(this.value === \"\"){\r\n                        this.value = 0;\r\n                    }\r\n                }\r\n            }\r\n            self.executeFormatCurrencyPlugin();\r\n\r\n            // Updates internal value\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n\r\n            if (properties.percentage) {\r\n                if (self.numericInput && self.numericInput.val().indexOf(\"%\") == -1)\r\n                    self.numericInput.val(self.numericInput.val() + '%');\r\n            }\r\n            message = message.replace(oldVal, \"\");\r\n        })\r\n\r\n        // Avoiding pasting invalid characters\r\n            .bind('paste', function (e) {\r\n                try {\r\n                    var tmpData = (bizagi.util.isIE() || bizagi.util.isIE11()) ? window.clipboardData.getData(\"text\") : e.originalEvent.clipboardData.getData(\"Text\");\r\n\r\n\r\n\r\n                    // Next lines checks if there is something different to numbers symbol, decimalSymbol and digitGroupSybol\r\n                    var totalVal = \"/[^0-9\";\r\n                    if (properties.decimalSymbol.length > 0) {\r\n                        totalVal += properties.decimalSymbol;\r\n                    }\r\n                    // Next lines only for currency type\r\n                    if (properties.dataType == 8) {\r\n                        if (properties.symbol.length > 0) {\r\n                            totalVal += properties.symbol;\r\n                        }\r\n                        if (properties.digitGroupSymbol.length > 0) {\r\n                            totalVal += properties.digitGroupSymbol;\r\n                        }\r\n                    }\r\n                    totalVal += \"\\\\-\\\\s]/gi\";\r\n                    try {\r\n                        if (tmpData.replace(eval(totalVal), '').length != tmpData.length)\r\n                            e.preventDefault();\r\n                    }\r\n                    catch (e) {\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    bizagi.log(\"Error to pasting content\");\r\n                    self.isInvalidFormat = true;\r\n                }\r\n            })\r\n            // Now we implement keydown instead of keyup in order to include preventDefault\r\n            .keydown(function (e) {\r\n                self.previousValue = this.value;\r\n                e = (window.event && window.event.preventDefault) ? window.event : e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                // Validation for currency info\r\n                if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) != \"undefined\")\r\n                    if (BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits == 0) properties.allowDecimals = false;\r\n                if (properties.dataType < 5 || (properties.dataType == 8 && properties.allowDecimals == false))\r\n                    if (keyUnicode == 188 || keyUnicode == 190 || keyUnicode == 110)\r\n                        e.preventDefault();\r\n                if (this.value)\r\n                    if (e !== undefined && this.value.length > 0 && (properties.dataType == 8 || properties.dataType == 10)) {\r\n                        // Just numbers\r\n                        if (keyUnicode > 47 && keyUnicode < 58) {\r\n                            if (self.formatTimeout) {\r\n                                clearTimeout(self.formatTimeout);\r\n                            }\r\n\r\n                            var floatPart = this.value + \"\";\r\n                            //var  floatPart = stringPart.replaceAll(properties.digitGroupSymbol, \"\").replaceAll(properties.symbol,\"\").trim().replaceAll(properties.decimalSymbol,\".\");\r\n                            if (properties.digitGroupSymbol && properties.digitGroupSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.digitGroupSymbol, \"\");\r\n                            }\r\n                            if (properties.symbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.symbol, \"\");\r\n                            }\r\n\r\n                            floatPart = $.trim(floatPart);\r\n                            if (properties.decimalSymbol && properties.decimalSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.decimalSymbol, \".\");\r\n                            }\r\n                            // If increasing one digit (x10) will overtake the maxValue\r\n                            if (floatPart * 10 > properties.dataTypeMaxValue) {\r\n                                e.preventDefault();\r\n                            }\r\n                        }                  \r\n                        else if (keyUnicode == 109 || keyUnicode == 189) {\r\n                            if (this.selectionStart != 0 || this.selectionEnd != this.value.length) {\r\n                                var currentPosition = this.selectionEnd;\r\n                                this.value = properties.symbol + \"-\" + this.value.replace(properties.symbol, \"\");\r\n                                this.selectionStart = this.selectionEnd = currentPosition + 1;\r\n                            } else if (this.selectionStart == 0 && this.selectionEnd == this.value.length) {\r\n                                this.value = \"-\";\r\n                                this.selectionStart = this.selectionEnd = this.value.length;\r\n                            }\r\n                        }\r\n                    }                    \r\n            })\r\n\r\n            .keyup(function (e) {\r\n                e = window.event || e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                if (e !== undefined) {\r\n                    switch (keyUnicode) {\r\n                        case 16:\r\n                            break; // Shift\r\n                        case 17:\r\n                            break; // Ctrl\r\n                        case 13:\r\n                            break; // Intro\r\n                        case 18:\r\n                            break; // Alt\r\n                        case 27:\r\n                            this.value = '';\r\n                            break; // Esc: clear entry\r\n                        case 35:\r\n                            break; // End\r\n                        case 36:\r\n                            break; // Home\r\n                        case 37:\r\n                            break; // cursor left\r\n                        case 38:\r\n                            break; // cursor up\r\n                        case 39:\r\n                            break; // cursor right\r\n                        case 40:\r\n                            break; // cursor down\r\n                        case 78:\r\n                            break; // N (Opera 9.63+ maps the \".\" from the number key section to the \"N\" key too!) (See: http://unixpapa.com/js/key.html search for \". Del\")\r\n                        case 110:\r\n                            break; // . number block (Opera 9.63+ maps the \".\" from the number block to the \"N\" key (78) !!!)\r\n                        case 188:\r\n                            break; // , comma\r\n                        case 190:\r\n                            break; // .\r\n                        default:\r\n                        {\r\n\r\n                        }\r\n                    }\r\n                }                \r\n            }).keypress(function (e) {\r\n            e = (window.event && window.event.preventDefault) ? window.event : e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (typeof (e) !== \"undefined\") {\r\n                if (keyUnicode == 35 || keyUnicode == 37 || keyUnicode == 39) {\r\n                    e.preventDefault();\r\n                } else if (properties.dataType != 8 && keyUnicode == 36) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                // When no decimals are permited\r\n                var character = String.fromCharCode(keyUnicode);\r\n                if (properties.allowDecimals === false && properties.numDecimals === 0 && character === properties.decimalSymbol)\r\n                    e.preventDefault();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.numericInput) {\r\n            self.numericInput.formatCurrency({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits,\r\n                roundToDecimalPlace: properties.numDecimals,\r\n                colorize: properties.colorize\r\n            });\r\n        }\r\n\r\n        if (properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            var value = self.numericInput.val();\r\n            var positive = true;\r\n\r\n            if (value.indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\")\r\n            }\r\n\r\n            var regExp = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(regExp, \"$1\")\r\n\r\n            regExp = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(regExp, \"\");\r\n            self.numericInput.val(value);\r\n\r\n            if (!positive) self.numericInput.val(\"(\" + value + \")\");\r\n        }\r\n\r\n        if (properties.percentage)\r\n            self.numericInput.val(self.numericInput.val() + '%');\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     * @returns {*}\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var value = self.getValue() !== undefined ? self.getValue() : $(\"input\", control).val() || \"\";\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        if (properties.percentage)\r\n            label = $('<label/>').html(label.text() + '%');\r\n\r\n        // Removing unrequired zeros as requested by BA26331\r\n        if (!properties.editable && properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            value = label.text();\r\n            var positive = true;\r\n\r\n            if (value.toString().indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\");\r\n            }\r\n\r\n            var re = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(re, \"$1\");\r\n\r\n            re = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(re, \"\");\r\n\r\n            if (!positive) value = \"(\" + value + \")\";\r\n            return value;\r\n        }\r\n\r\n        return label.text();\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var message;\r\n        var minValue = self.getMinValue();\r\n        var maxValue = self.getMaxValue();\r\n\r\n        if (typeof (value) == \"string\" && value != \"\") {\r\n            value = Number(value);\r\n        }\r\n\r\n        // Check min value\r\n        if (self.hasValue()) {\r\n            if (!bizagi.util.isEmpty(minValue)) {\r\n                if (value < minValue) {\r\n                    message = this.getResource(\"render-numeric-minimum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#minValue#\", minValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n            // Check max value\r\n            if (!bizagi.util.isEmpty(maxValue)) {\r\n                if (value > maxValue) {\r\n                    message = this.getResource(\"render-numeric-maximum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#maxValue#\", maxValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (self.isValidRender === false && !(bValid && bizagi.util.isMobileDevice())) {\r\n            bValid = false;\r\n            var validMessage = self.isValidRenderMessage ? self.isValidRenderMessage : \"error\";\r\n            invalidElements.push({xpath: properties.xpath, message: validMessage});\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Get minimum value\r\n     * @returns {*}\r\n     */\r\n    getMinValue: function () {\r\n        var minValue = this.properties.minValue;\r\n\r\n        if (minValue !== undefined && minValue !== null)\r\n            return minValue;\r\n\r\n        return this.properties.dataTypeMinValue;\r\n    },\r\n\r\n    /**\r\n     * Get maximum value\r\n     * @returns {*}\r\n     */\r\n    getMaxValue: function () {\r\n        var maxValue = this.properties.maxValue;\r\n\r\n        if (maxValue !== undefined && maxValue !== null)\r\n            return maxValue;\r\n\r\n        return this.properties.dataTypeMaxValue;\r\n    },\r\n\r\n    /**\r\n     * Return the allow decimals default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n            // Decimal and money data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Return the group digits default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n\r\n            // Decimal data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Return the group digits default property based on digitGroupSymbol\r\n     * @returns {*}\r\n     */\r\n    setGroupDigits: function () {\r\n        var self = this;\r\n        if (typeof (self.properties.thousands) !== \"undefined\") {\r\n            if (self.properties.digitGroupSymbol) { //some cultures\r\n                return bizagi.util.parseBoolean(self.properties.thousands);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else if (self.properties.digitGroupSymbol) { //some cultures\r\n            return this.getDefaultGroupDigits(self.properties.dataType);\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Calculate Minimum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMinValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return -922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 0; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return -32768; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return -2147483648; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return -999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Calculate Maximum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMaxValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return 922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 255; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return 32767; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return 2147483647; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return 999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var newValue = Number(value);\r\n\r\n        self.properties.minValue = self.properties.dataTypeMinValue = Number.isNaN(newValue) ? self.calculateMinValue(self.properties.dataType) : newValue;\r\n    },\r\n\r\n    changeMaxValue: function (value) {\r\n        var newValue = Number(value);\r\n\r\n        this.properties.maxValue = this.properties.dataTypeMaxValue = Number.isNaN(newValue) ? this.calculateMaxValue(this.properties.dataType) : newValue;\r\n    },\r\n\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    }\r\n});\r\n\r\n","\r\n/*\r\n*   Name: Bizagi Render Number Scientific notation Class\r\n*   Author: Laura Ariza\r\n*   Comments:\r\n*   -   This script will define basic stuff for scientific notation numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.numberScientificNotation\", {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\"\r\n            ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n    },\r\n\r\n    renderControl: function() {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"numberScientificNotation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.numericInput = control.find(\"input\");\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n    },\r\n\r\n    getDisplayValue: function() {\r\n        var self = this;\r\n        return self.getValue().replace('.', self.properties.decimalSymbol);\r\n    },\r\n\r\n    setValue: function(value) {\r\n        var self = this;\r\n        value = (value || '').toString().replace(self.properties.decimalSymbol, '.');\r\n        self._super(value);\r\n    },\r\n    controlValueIsChanged: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue() || \"\";\r\n        var compareValue = properties.originalValue || \"\";\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n        result = (compareValue.toLowerCase() == value.toLowerCase()) ? false : true;\r\n        return result;\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Date Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for date renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.date\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                // Value must always hold the value with invariant format\r\n                self.value = properties.value;\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            } else {\r\n                self.value = null;\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"date\");\r\n        var indexDateTimeSeparation = properties.dateFormat.substring(0, properties.dateFormat.indexOf(\":\")).lastIndexOf(\" \");\r\n        var dateFormat = (indexDateTimeSeparation > 0) ? properties.dateFormat.substring(0, indexDateTimeSeparation) : properties.dateFormat;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            showTime: properties.showTime,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            dateFormat: bizagi.override && bizagi.override.uppercaseDatePlaceholder === true ? dateFormat.toUpperCase() : dateFormat,\r\n            timeFormat: (properties.showTime && indexDateTimeSeparation > 0) ? properties.dateFormat.substring(indexDateTimeSeparation) : \"\",\r\n            rtl: (properties.orientation == \"rtl\")\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function (intHandler, isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set control references\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        // Set mask\r\n        if (properties.mask) {\r\n            dateControl.mask({\r\n                mask: properties.mask\r\n            });\r\n        }\r\n\r\n        // Attach change event\r\n        dateControl.bind(\"change\", function () {\r\n            self.onChangeHandler();\r\n        });\r\n        if (properties.showTime) {\r\n            timeControl.bind(\"change\", function (e, isNow) {\r\n                if (self.updatingTime) {\r\n                    delete self.updatingTime;\r\n                    return;\r\n                }\r\n                self.onChangeHandler(isNow);\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function () {\r\n    },\r\n\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        if (!properties.displayValue && value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n        } else {\r\n            displayValue = \"\";\r\n        }\r\n\r\n        // We can return the display value isntance\r\n        return properties.displayValue || displayValue || \"\";\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    // Formats the value in full invariant (with time) in order to send to the server\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                    if (typeof (date) != \"undefined\")\r\n                        if (date !== 0) {\r\n                            if (!properties.showTime) {\r\n                                date.setHours(0, 0, 0, 0);\r\n                            }\r\n                            renderValues[properties.xpath] = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                        }\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n    getDateControl: function () { },\r\n\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n    getTimeControl: function () { },\r\n\r\n    /* \r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n        properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                var message;\r\n\r\n                // Check that we have a valid data\r\n                if (value != 0) {\r\n                    // Clear seconds and milliseconds for validations\r\n                    value.setSeconds(0);\r\n                    value.setMilliseconds(0);\r\n\r\n                    // Check min value\r\n                    if (properties.minValue && (typeof properties.minValue === 'string' || typeof properties.minValue == 'number')) {\r\n                        var minValue = typeof properties.minValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.minValue, properties.showTime) : new Date(properties.minValue);\r\n                        minValue.setSeconds(0);\r\n                        minValue.setMilliseconds(0);\r\n\r\n                        if (value < minValue) {\r\n                            message = this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", bizagi.util.dateFormatter.formatDate(minValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n\r\n                    // Check max value\r\n                    if (properties.maxValue && (typeof properties.maxValue == 'string' || typeof properties.maxValue == 'number')) {\r\n                        var maxValue = typeof properties.maxValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.maxValue, properties.showTime) : new Date(properties.maxValue);\r\n                        maxValue.setSeconds(0);\r\n                        maxValue.setMilliseconds(0);\r\n\r\n                        if (value > maxValue) {\r\n                            message = this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", bizagi.util.dateFormatter.formatDate(maxValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check that both controls (data and time) are filled out\r\n        if (properties.showTime) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                // Check required\r\n                if (properties.required && self.hasValue()) {\r\n\r\n                    // Check both controls\r\n                    var dateControl = self.getDateControl();\r\n                    var timeControl = self.getTimeControl();\r\n\r\n                    // If date is filled but time is not ... show validation\r\n                    if (dateControl.length > 0 && timeControl.length > 0) {\r\n                        if (dateControl.val().length > 0 && timeControl.val().length == 0) {\r\n                            message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.extendedText\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        this.hasMaxLines = this.properties.maxLines ? true : false;\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Fill default properties\r\n        properties.maxLines = this.properties.maxLines || 6;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || self.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"extendedText\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.textarea = control.find(\"textarea\");\r\n\r\n        // If is textarea, then enable resize element.\r\n        if (self.textarea) {\r\n            self.textarea.css({resize: \"both\"});\r\n        } else {\r\n            self.textarea.css({resize: \"none\"});\r\n        }\r\n\r\n        // Attach event for retype double\r\n        if (self.properties.retype === \"double\")\r\n            self.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set the default maxlength for the input if is 0 or undefined set to infinity\r\n        // this resolve issue with scope strings that don't have maxlength\r\n        if (properties.maxLength)\r\n            self.textarea.prop('maxlength', properties.maxLength);\r\n\r\n        if (properties.maxLines) {\r\n            self.textarea.prop('rows', properties.maxLines)\r\n        } else {\r\n            self.textarea.prop('rows', 6);\r\n        }\r\n\r\n        // Attach change event\r\n        self.textarea.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.textarea.val(), true);\r\n                } else {\r\n                    // Set error message\r\n                    var message = validationMessages[0].message;\r\n                    bizagi.showMessageBox(message, \"Bizagi\", \"error\");\r\n                }\r\n            }\r\n        });\r\n\r\n        // Attach blur event\r\n        self.textarea.bind(\"blur\", function () {\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var regEx = new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\");\r\n\r\n        // Offline capability\r\n        if (this.isOfflineForm && bizagi.util.isMobileDevice()) {\r\n            value = value && typeof (value) === \"object\" && value.value ? value.value : value;\r\n        }\r\n\r\n        // Check regular expression\r\n        if (properties.regularExpression) {\r\n\r\n            if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression)) && (self.properties && self.properties.xpath === \"userName\")))) {\r\n                message = properties.regularExpression.message;\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                bValid = false;\r\n            } else {\r\n                if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression))))) {\r\n                    message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        } else {\r\n            if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                if (properties.editable) {\r\n                    message = this.getResource(\"render-text-regular-expression-default-message\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (self.properties.editable == false) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(valueToDisplay);\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param {} renderValues\r\n     * @returns {}\r\n     */\r\n    collectData: function (renderValues) {\r\n        // Call base\r\n        this._super(renderValues);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setValue: function (value) {\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        this._super(decodedValue);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n});\r\n","/*\r\n *   Name: Bizagi Render Grid Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for grids\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.grid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self.originalData = bizagi.clone(data.properties);\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        self.initProperties();\r\n\r\n        // Set columns\r\n        var areThereEditableColumns;\r\n        var areThereTotalizedColumns;\r\n        self.columns = [];\r\n        self.columnsIds = [];\r\n        self.enabledChecks = {};\r\n        self.exclusiveChanges = {};\r\n        self.originalEnabledChecks = [];\r\n        $.each(data.elements, function (i, column) {\r\n            var columnProperties = column.render.properties;\r\n\r\n            // the groupby property is taken of column\r\n            if (columnProperties.groupBy) {\r\n                properties.groupBy = columnProperties.xpath || \"\";\r\n                properties.allowGrouping = !bizagi.util.isEmpty(properties.groupBy) ? true : false;\r\n            }\r\n            if (columnProperties.type === \"columnLabel\") {\r\n                self.spliceRowData(data.properties.data, i + 1);\r\n            }\r\n\r\n            if (columnProperties.type === \"columnBoolean\" && columnProperties.isExclusive) {\r\n                var params = {\r\n                    xpath: columnProperties.xpath\r\n                };\r\n                if (data.properties.data) {\r\n                    self.enabledChecks[columnProperties.xpath] = [];\r\n                    for (var j = 0; j < data.properties.data.rows.length; j++) {\r\n                        var row = data.properties.data.rows[j];\r\n                        var item = row[i + 1];\r\n                        if (item) {\r\n                            self.originalEnabledChecks.push(row[0]);\r\n                            self.enabledChecks[columnProperties.xpath].push([row[0], item]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // If inlineEdit is false then all columns must be read only\r\n            if (!self.properties.inlineEdit) {\r\n                column.render.properties.editable = false;\r\n            }\r\n\r\n            // Create renderColumns\r\n            var columnRender = self.renderFactory.getColumn({\r\n                type: columnProperties.type,\r\n                data: column.render,\r\n                parent: self,\r\n                singleInstance: properties.singleInstance\r\n            });\r\n\r\n            self.columns.push(columnRender);\r\n            self.columnsIds.push(column.render.properties.id);\r\n\r\n            if (columnProperties.editable) {\r\n                areThereEditableColumns = true;\r\n            }\r\n\r\n            if (columnProperties.totalize && columnProperties.totalize.operation) {\r\n                areThereTotalizedColumns = true;\r\n\r\n                // Default summary format\r\n                columnProperties.totalize.format = columnProperties.totalize.format || {};\r\n                columnProperties.totalize.format.bold = columnProperties.totalize.format.bold !== undefined ? columnProperties.totalize.format.bold : true;\r\n            }\r\n        });\r\n\r\n        // Reverse columns when using right to left orientation\r\n        if (properties.orientation === \"rtl\")\r\n            self.columns = self.columns.reverse();\r\n\r\n        // Turn off inline edit if there are any editable columns        \r\n        if (properties.inlineEdit && !areThereEditableColumns) {\r\n            properties.inlineEdit = false;\r\n            properties.allowEdit = false;\r\n        }\r\n\r\n        // Check if the grid has totalizers\r\n        if (areThereTotalizedColumns) {\r\n            properties.showSummary = true;\r\n            properties.rowsPerPage = 0;\r\n        }\r\n    },\r\n\r\n    initProperties: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        /** Edit properties\r\n         * @default editable true\r\n         */\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowEdit = bizagi.util.parseBoolean(properties.allowEdit) != null ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.inlineEdit = bizagi.util.parseBoolean(properties.inlineEdit) != null ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.withEditForm = bizagi.util.parseBoolean(properties.withEditForm) != null ? bizagi.util.parseBoolean(properties.withEditForm) : false;\r\n\r\n        /** Add properties\r\n         * @default  allowAdd true\r\n         */\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) != null ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.inlineAdd = (properties.allowAdd) ? (bizagi.util.parseBoolean(properties.inlineAdd) != null) ? bizagi.util.parseBoolean(properties.inlineAdd) : true : false;\r\n\r\n        /* Define Delete properties */\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) != null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        /* Define details properties*/\r\n        properties.allowDetail = bizagi.util.parseBoolean(properties.allowDetail) != null ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n\r\n        /* Define general properties */\r\n        properties.keyColumn = \"\";\r\n        properties.data = properties.data || null;\r\n        properties.displayType = \"value\";\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        properties.allowMore = bizagi.util.parseBoolean(properties.allowMore) || false;\r\n        properties.allowFilter = bizagi.util.parseBoolean(properties.allowFilter) || false;\r\n        properties.allowGrouping = false;\r\n        properties.groupBy = \"\";\r\n        properties.groupSummary = properties.groupSummary || null;\r\n        properties.groupText = this.getResource(\"render-grid-group-text\");\r\n        properties.groupCollapsed = bizagi.util.parseBoolean(properties.groupCollapsed) || false;\r\n        properties.groupOrder = properties.groupOrder || \"asc\";\r\n        properties.formShowMode = bizagi.util.parseBoolean(properties.formShowMode) || \"popup\";\r\n        properties.floatingHeader = bizagi.util.parseBoolean(properties.floatingHeader) || false;\r\n\r\n        properties.sortBy = properties.sortBy ? properties.sortBy : properties.data && properties.data.sort ? properties.data.sort : properties.keyColumn;\r\n        properties.sortOrder = properties.sortOrder !== undefined && properties.sortOrder !== null ? (properties.sortOrder === \"True\" ? \"asc\" : \"desc\") : properties.data && properties.data.order ? properties.data.order : \"asc\";\r\n        properties.sort = properties.sortBy + \" \" + properties.sortOrder;\r\n\r\n        properties.rowsPerPage = properties.allowGrouping ? 1000 : (properties.rowsPerPage || 20);\r\n        properties.page = 1;\r\n        properties.records = 0;\r\n        properties.totalPages = 0;\r\n\r\n        properties.addLabel = properties.addLabel || this.getResource(\"render-grid-add-label\") + properties.displayName;\r\n        properties.editLabel = properties.editLabel || $.trim(this.getResource(\"render-grid-edit-label\")) + \" \" + properties.displayName;\r\n        properties.deleteLabel = properties.deleteLabel || this.getResource(\"render-ecm-confirm-bt-delete\") + \" \" + properties.displayName;\r\n        properties.exportOptionsLabel = properties.exportOptionsLabel || this.getResource(\"render-grid-export-options-label\") + properties.displayName;\r\n        properties.detailLabel = properties.detailLabel || this.getResource(\"render-collection-navigator-details-form\");\r\n\r\n\r\n        // Apply style to entire table\r\n        properties.tableCssClass = properties.cssClass || \"\";\r\n\r\n        properties.alreadySaved = false;\r\n\r\n        // When grid open in modal window and the parent is entity\r\n        if (properties.contexttype != \"entity\") {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Define if it is editable or not        \r\n        /* This part change all cells in the table to no editable,\r\n         * you must use it when the parent container has noeditable property,\r\n         * so this table is noeditable too.\r\n         */\r\n        try {\r\n            if ((self.parent && typeof self.parent.properties.editable == \"boolean\" && !self.parent.properties.editable) || !properties.editable) {\r\n                properties.allowAdd = false;\r\n                properties.allowEdit = false;\r\n                properties.allowDelete = false;\r\n                properties.inlineEdit = false;\r\n                properties.inlineAdd = false;\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n\r\n        // If grid has not allowEdit property in true, all fields within the grid\r\n        // must be no editables, so these lines changes this behavior\r\n        if (!properties.allowEdit || (!properties.inlineEdit && !properties.withEditForm)) {\r\n            properties.editable = false;\r\n        }\r\n\r\n        // Calculate render width\r\n        properties.labelWidth = 0;\r\n        properties.valueWidth = \"100%\";\r\n\r\n        // This property will be used to make custom grids with another data source\r\n        properties.overrideGetRemoteData = properties.overrideGetRemoteData || undefined;\r\n        //this property use to create a single decorated or a array of decorated\r\n        properties.singleInstance = bizagi.util.isEmpty(properties.singleInstance) ? true : properties.singleInstance;\r\n\r\n        // Check if the grid its opened whitin dialog form and has contextType\r\n        properties.contextType = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : null;\r\n\r\n        // Create a collection to collect changes\r\n        self.changes = {};\r\n\r\n        // Create a collection to override properties per cell\r\n        self.cellOverrides = {};\r\n\r\n\r\n        // Check orientation and change order of data if its necesary (rtl)\r\n        if (self.isRTL() && properties.data != null) {\r\n            properties.data.rows = self.changeOrderData(properties.data.rows);\r\n        }\r\n    },\r\n\r\n    /*\r\n   *   Check if a render has no value for required validation\r\n   */\r\n    hasValue: function () {\r\n        return this.properties.data && this.properties.data.rows.length > 0;\r\n    },\r\n\r\n    isRTL: function () {\r\n        var properties = this.properties;\r\n        if (!properties) return true;\r\n        return (typeof properties.orientation == \"string\" && properties.orientation.toUpperCase() == \"RTL\") ? true : false;\r\n    },\r\n    changeOrderData: function (data) {\r\n        var reverseDataRows = [];\r\n        var rows = data || [];\r\n        var rowKey;\r\n\r\n        $.each(rows, function (key, value) {\r\n            // Extract row key\r\n            rowKey = value.shift();\r\n            reverseDataRows = value.reverse();\r\n            // add element in the start\r\n            reverseDataRows.unshift(rowKey);\r\n\r\n            rows[key] = reverseDataRows;\r\n        });\r\n\r\n        return rows;\r\n    },\r\n\r\n    /**\r\n     * Specific fix RTL with localizated\r\n     * @param data\r\n     * @returns {*|Array}\r\n     */\r\n    removeRemainingColumns: function (data, numColumns) {\r\n        var rows = data || [];\r\n        var remainingColumns = 0;\r\n        if (rows.length > 0) {\r\n            // \"- 1\" because the first column represent id row\r\n            remainingColumns = rows[0].length - numColumns - 1;\r\n        }\r\n        if (remainingColumns > 0) {\r\n            $.each(rows, function (key, value) {\r\n                // Remove remaining columns\r\n                for (var i = 0; i < remainingColumns; i++) {\r\n                    value.pop();\r\n                }\r\n            });\r\n        }\r\n        return rows;\r\n    },\r\n\r\n    /* \r\n     *   Gets a column definition by xpath\r\n     */\r\n    getColumn: function (xpath) {\r\n        var self = this;\r\n        var result = null;\r\n        $.each(self.columns, function (i, column) {\r\n            if (column.properties.xpath == xpath || column.properties.id == xpath) {\r\n                result = column;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getColumnType: function (id) {\r\n        var self = this;\r\n        var columnIndex = self.columnsIds.indexOf(id);\r\n\r\n        if (columnIndex != -1) {\r\n            return self.columns[columnIndex].properties.type;\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set dummy data when not in execution mode\r\n        var mode = self.getMode();\r\n        if (mode !== \"execution\") {\r\n            properties.data = self.getDummyData();\r\n        }\r\n\r\n        var template = self.getGridTemplate();\r\n\r\n        // Render template\r\n        var html = self.applyTemplate(template);\r\n\r\n        // Initialize columns\r\n        var columnInitializers = [];\r\n        $.each(self.columns, function (i, column) {\r\n\r\n            // Add to column initializer array so we can synch out the promises\r\n            var result = column.initialize();\r\n            if (result)\r\n                columnInitializers.push(result);\r\n        });\r\n\r\n        // Resolve when all columns has been loaded\r\n        $.when.apply($, columnInitializers).done(function () {\r\n            defer.resolve(html);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Make control to behave as a block container\r\n        // TODO: Move to instances. This does not apply to mobiles\r\n        control.addClass(\"ui-bizagi-render-grid-container\")\r\n            .addClass(\"ui-bizagi-render-display-block\");\r\n    },\r\n\r\n    /*\r\n     *   Returns the grid template to be used\r\n     */\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid\");\r\n    },\r\n\r\n    /*\r\n     *   Applies the template to the render and returns the resolved element\r\n     */\r\n    applyTemplate: function (template) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        orientation = self.properties.orientation;\r\n\r\n        return $.fasttmpl(template, {\r\n            id: bizagi.util.encodeXpath(properties.xpath),\r\n            displayName: bizagi.util.encodeXpath(properties.displayName),\r\n            allowAdd: properties.allowAdd,\r\n            addLabel: properties.addLabel\r\n        });\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Override read-only presets\r\n        //  properties.allowAdd = false;\r\n        // Render the same, just change some presets\r\n        return self.renderControl();\r\n    },\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sortBy,\r\n            order: properties.sortType,\r\n            page: properties.page,\r\n            rows: properties.rowsPerPage,\r\n            searchFilter: properties.searchFilter,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            return properties.overrideGetRemoteData(params);\r\n        } else {\r\n            // Resolve with remote data\r\n            return self.dataService.multiaction().getGridData(params).then(function (data) {\r\n                self.originalData = self.originalData || {};\r\n                self.originalData.data = bizagi.clone(data);\r\n\r\n                // Resolve with fetched data\r\n                properties.page = data.page;\r\n                properties.records = data.records;\r\n                properties.totalPages = data.totalPages;\r\n\r\n                return data;\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     insert a blank item in the selected column in the data matrix\r\n     */\r\n    spliceRowData: function (data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.rows)) {\r\n            $.each(data.rows, function (key, value) {\r\n                var spliceIndex = index || data.rows[key].length;\r\n                data.rows[key].splice(spliceIndex, 0, \"\");\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataVisible: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.visible)) {\r\n            $.each(data.visible, function (key, value) {\r\n                var spliceIndex = index || data.visible[key].length;\r\n                data.visible[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataEditable: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.editable)) {\r\n            $.each(data.editable, function (key, value) {\r\n                var spliceIndex = index || data.editable[key].length;\r\n                data.editable[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n     */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            var rowTemplate = [\"1\"];\r\n\r\n            // Add a value for each column\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                rowTemplate.push(\"\");\r\n            }\r\n\r\n            var data = {\r\n                \"page\": 1,\r\n                \"total\": 1,\r\n                \"records\": 1,\r\n                \"rows\": [rowTemplate]\r\n            };\r\n\r\n            return data;\r\n        }\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitEditRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + self.buildCellXpathFilter(id) : properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            return self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                submitData: data,\r\n                contexttype: properties.contextType,\r\n                disableServerGridValidations: data.disableServerGridValidations || false\r\n            }).pipe(function (dataResp) {\r\n                self.endLoading();\r\n                return dataResp;\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n\r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid delete record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({message: message});\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid add record request\r\n     *   Returns a deferred when done, the server returns an id for the new record\r\n     */\r\n    submitAddRequest: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n    /*\r\n     *   Submits a grid rollback request\r\n     *   Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: params ? params.idPageCache : properties.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n     *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n     */\r\n    collectGridChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n        var isPressed = params.pressed || false;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n\r\n        if (trigger)\r\n            self.triggerRenderChange({key: id, column: xpath, pressed: isPressed});\r\n    },\r\n    /*\r\n     *   Configures a column to perform a submit on change when the user changes a cell\r\n     */\r\n    configureColumnSubmitOnChange: function (xpath) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build action\r\n        var action = {\r\n            commands: [{\r\n                xpath: properties.xpath,\r\n                command: 'submit-value',\r\n                argument: 'all'\r\n            }],\r\n            conditions: {\r\n                operator: 'and',\r\n                expressions: [\r\n                    {\r\n                        simple: {\r\n                            operator: 'cell-change',\r\n                            xpath: properties.xpath + '[].' + xpath,\r\n                            argumentType: 'text',\r\n                            argument: xpath\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            dependencies: [properties.xpath]\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                var form = self.getFormContainer();\r\n                form.addSubmitAction(xpath, action);\r\n            });\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var keysToDelete = [];\r\n\r\n        for (var id in self.changes) {\r\n            // Dont collect data from totalizers \r\n            if (id != \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var columnSimpleXpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + (columnXpath.substr(columnXpath.lastIndexOf('.') + 1, columnXpath.length) || columnXpath);\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Clean changes \r\n            keysToDelete.push(id);\r\n\r\n        }\r\n\r\n        if (self.exclusiveChanges) {\r\n            for (var id in self.exclusiveChanges) {\r\n\r\n                var columnExclusiveChanges = self.exclusiveChanges[id];\r\n                var columnEnabledChecks = self.enabledChecks[id];\r\n                var lengthEnabledChecks = columnEnabledChecks.length;\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    for (var i = 0; i < lengthEnabledChecks; i++) {\r\n                        var columnSimpleXpathEnabled = properties.xpath + self.buildCellXpathFilter(self.enabledChecks[id].shift()[0]) + \".\" + id;\r\n                        renderValues[columnSimpleXpathEnabled] = false;\r\n                    }\r\n\r\n                    var columnSimpleXpath = properties.xpath + self.buildCellXpathFilter(columnExclusiveChanges.key) + \".\" + columnExclusiveChanges.xpath;\r\n                    renderValues[columnSimpleXpath] = columnExclusiveChanges.value;\r\n\r\n                }\r\n            }\r\n        }\r\n\r\n        // Clean changes array in order to prevent duplicate data\r\n        // when execute SUBMITDATA in multiaction, that make and error\r\n        // in circular dependencies, specially when we add inline record\r\n        $.each(keysToDelete, function (key, v) {\r\n            delete self.changes[v];\r\n        });\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (!$.isEmptyObject(self.changes)) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            if (!$.isEmptyObject(self.exclusiveChanges)) {\r\n                result.push(true);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Check if a column data can be sent to the server\r\n     */\r\n    canColumnBeSent: function (id, columnXpath) {\r\n        var self = this, i, j, xpath;\r\n        for (i in self.columns) {\r\n            if (self.columns.hasOwnProperty(i)) {\r\n                var column = self.columns[i];\r\n                if (column.properties.type !== \"columnUserfield\") {\r\n                    if (column.properties.xpath == columnXpath) {\r\n                        var cellOverride = self.getCellOverride(id, column.columnIndex - 1);\r\n                        return column.canBeSent(id, cellOverride);\r\n                    }\r\n                } else {\r\n                    for (j in column.properties) {\r\n                        if (column.properties.hasOwnProperty(j)) {\r\n                            if (Object.prototype.toString.apply(column.properties[j]) === \"[object String]\") {\r\n                                xpath = column.properties[j].substr(column.properties[j].lastIndexOf(\".\") + 1);\r\n                                if (xpath === columnXpath) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /* \r\n     *  Method to determine if the render value can be sent to the server or not\r\n     */\r\n    canBeSent: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n\r\n        // The render can be sent if it is \"display only\" and inline Edit is available\r\n        if (!displayOnly && (properties.inlineEdit || properties.inlineAdd || !$.isEmptyObject(self.changes))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the value for a requested cell\r\n     */\r\n    getCellValue: function (key, xpath) {\r\n        var self = this;\r\n        var data = self.properties.data.rows;\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i][0] == key) {\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        var result = data[i][j + 1];\r\n                        return result;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    getCellCurrentValue: function (key, xpath) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control && typeof control.getValue === \"function\") {\r\n            return control.getValue();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *   Gets control\r\n     */\r\n    getControlCell: function (key, xpath) {\r\n        var self = this;\r\n        var control = null;\r\n        if (typeof (self.columns) != \"undefined\")\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath || self.columns[j].properties.id == xpath) {\r\n                    control = self.columns[j].getDecorated(key);\r\n                    break;\r\n                }\r\n            }\r\n\r\n\r\n        return control;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n     *   Fetch the data again and updates the content\r\n     */\r\n    refresh: function () {\r\n    },\r\n    /*\r\n     *   Sets an error on the cell\r\n     */\r\n    setError: function (key, columnXpath) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the visibility for a cell\r\n     */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the editability for a cell\r\n     */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Changes the required for cell\r\n     */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Refresh behaviors of cell\r\n     */\r\n    changeCellProperties: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Clean data of cell\r\n     */\r\n    cleanCellData: function (key, xpath) {\r\n    },\r\n\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.saveGrid().done(function () {\r\n\r\n            // Renders again\r\n            var properties = {properties: $.extend({editable: bizagi.util.parseBoolean(argument)}, self.originalData)};\r\n\r\n            // Clears control\r\n            control.empty();\r\n\r\n            bizagi.rendering.render.prototype.initializeData.apply(self, [properties]);\r\n\r\n            self.initProperties();\r\n            self.changeColumnsEditability(argument);\r\n\r\n            if (typeof self.internalRenderControl == \"function\") {\r\n                $.when(self.internalRenderControl()).done(function (html) {\r\n                    control.append(html);\r\n                    self.postRenderElement(self.element);\r\n                });\r\n\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    saveGrid: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        var rows = $(\"[data-bizagi-component=rows]\", self.element).find(\"[data-new-row=true]\");\r\n        if (rows.length > 0) {\r\n            rows = $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n            self.saveInlineAddedRows(rows).done(function () {\r\n                defer.resolve();\r\n            });\r\n        } else {\r\n            defer.resolve();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    changeColumnsEditability: function (value) {\r\n        var self = this;\r\n        var columns = self.columns || [];\r\n\r\n        $.each(columns, function (i, column) {\r\n            column.properties.editable = value;\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Refresh behaviors of cell\r\n     */\r\n    refreshCell: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var key = params.key;\r\n        var column = params.column;\r\n        var xpathContext = (params.xpathContext !== \"\") ? params.xpathContext + \".\" + self.properties.xpath + self.buildCellXpathFilter(key) : self.properties.xpath + self.buildCellXpathFilter(key);\r\n        var cell = self.getControlCell(key, params.column);\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id;\r\n\r\n        if (!cell) {\r\n            return;\r\n        }\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        cell.beforeToRefresh();\r\n\r\n        // Call service\r\n        return $.when(self.dataService.multiaction().refreshGridCell({\r\n            idRender: properties.id,\r\n            column: cell.properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: xpathContext,\r\n            idForm: idForm,\r\n            typeRender: cell.properties.type\r\n        })).done(function (data) {\r\n            // Extract values\r\n            var getDepthData = function (target) {\r\n                if (target && typeof target == \"object\" && target.length >= 1) {\r\n                    return (target[0].length >= 1) ? target[0][0] : target[0];\r\n                }\r\n                return \"\";\r\n            };\r\n            var newValue = getDepthData(data.rows);\r\n            var editable = getDepthData(data.editable);\r\n            if (!bizagi.util.isBoolean(editable)) {\r\n                editable = editable || true;\r\n            }\r\n            var visible = getDepthData(data.visible);\r\n            if (!bizagi.util.isBoolean(visible)) {\r\n                visible = visible || true;\r\n            }\r\n            \r\n            // Change Visibility & Editability\r\n            self.changeCellVisibility(key, column, visible);\r\n            self.changeCellEditability(key, column, editable);\r\n\r\n            // Change control value\r\n            cell.setValue(newValue);\r\n            cell.setDisplayValue(newValue);\r\n\r\n            // Trigger grid change\r\n            self.triggerRenderChange({key: key, column: column, changed: false});\r\n\r\n            // Update the affected cell manually after a refresh\r\n            //TODO:temporary solution\r\n            //review the DRAGON-5982 \r\n            if (cell.column != undefined && bizagi.util.detectDevice() == \"desktop\") {\r\n                self.updateAffectedCellManually(key, newValue, cell.column.columnIndex);\r\n            }\r\n\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            cell.afterToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Triggers the render change event\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Property to verify exporting updated grids\r\n        if (!bizagi.util.isEmpty(params) && params.changed != false)\r\n            self.properties.canBeExported = false;\r\n        self.triggerHandler(\"renderchange\", {\r\n            render: self,\r\n            surrogateKey: params.key,\r\n            column: params.column,\r\n            changed: params.changed,\r\n            rowDeleted: params.rowDeleted,\r\n            pressed: params.pressed\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Validate the grid\r\n     */\r\n    validate: function () {\r\n        this.isValid([]);\r\n    },\r\n    /* \r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.hasErrors = false;\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check for required columns and null values\r\n        if (self.properties.data && self.properties.data.rows) {\r\n            var newRows = self.getDataNewRows();\r\n            // Preserve elements in data.rows\r\n            // Check required\r\n            if (newRows.length == 0 && bizagi.util.parseBoolean(self.properties.required)) {\r\n                if (!self.hasValue()) {\r\n                    message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({\r\n                        xpath: self.properties.xpath,\r\n                        message: message\r\n                    });\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n            var data = $.merge($.merge([], self.properties.data.rows), newRows);\r\n\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                var messages = [];\r\n                var uniqueMessages = {};\r\n\r\n                for (var j = 0; j < data.length; j++) {\r\n                    var value = data[j][i + 1];\r\n                    var key = data[j][0];\r\n                    var xpath = self.columns[i].properties.xpath;\r\n                    if (self.changes[key] !== undefined && self.changes[key][self.columns[i].properties.xpath] !== undefined) {\r\n                        value = self.changes[key][self.columns[i].properties.xpath];\r\n                    }\r\n\r\n                    // Check if the column is valid\r\n                    var valueValid = self.columns[i].isValueValid(key, value, messages, self.getCellOverride(key, i));\r\n                    if (!valueValid) {\r\n                        bValid = false;\r\n\r\n                        self.hasErrors = true;\r\n                        self.setError(key, self.columns[i].properties.xpath);\r\n                    }\r\n                }\r\n                for (var k = 0, messagesLength = messages.length; k < messagesLength; k++) {\r\n                    if (uniqueMessages[messages[k]] == null) {\r\n                        uniqueMessages[messages[k]] = messages[k];\r\n                    }\r\n                }\r\n\r\n                if (messages.length > 0) {\r\n                    var gridValidationMessage = self.getResource(\"render-grid-validation\").replaceAll(\"#grid#\", self.properties.displayName);\r\n                    for (key in uniqueMessages) {\r\n                        invalidElements.push({\r\n                            xpath: self.properties.xpath,\r\n                            message: gridValidationMessage + \" \" + key\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n    /*\r\n     *   Enables submit on change feature for the current render\r\n     */\r\n    configureSubmitOnChange: function () {\r\n        // Don't do anything we will trigger submit on change manually only when the grid add or edit form has been edited   \r\n    },\r\n    /*\r\n     *   Get cell override\r\n     */\r\n    getCellOverride: function (key, column) {\r\n        var self = this;\r\n\r\n        // Convert to numbers\r\n        key = Number(key);\r\n        column = Number(column);\r\n\r\n        // Find overrides\r\n        var columnProperties = self.columns[column].properties;\r\n        if (!self.cellOverrides[key])\r\n            self.cellOverrides[key] = {};\r\n        if (!self.cellOverrides[key][column]) {\r\n            self.cellOverrides[key][column] = {\r\n                visible: columnProperties.visible,\r\n                editable: columnProperties.editable,\r\n                required: columnProperties.required\r\n            };\r\n        }\r\n\r\n        return self.cellOverrides[key][column];\r\n    },\r\n\r\n    /*\r\n     * Set cell overrides based on the data\r\n     */\r\n    setCellOverrides: function (data, columns) {\r\n        var self = this;\r\n        var key;\r\n\r\n        // Init visibility overrides\r\n        if (data.visible) {\r\n            for (var i = 0, len = data.visible.length; i < len; i++) {\r\n                key = data.visible[i][0];\r\n                for (var j = 0, len_v = data.visible[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).visible = bizagi.util.parseBoolean(data.visible[i][j]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init editability overrides\r\n        if (data.editable) {\r\n            for (var i = 0, len = data.editable.length; i < len; i++) {\r\n                key = data.editable[i][0];\r\n                for (var j = 0, len_v = data.editable[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0) {\r\n                        var columnEditable = columns ? bizagi.util.parseBoolean(columns[j - 1].properties.editable) : true;\r\n                        self.getCellOverride(key, j - 1).editable = columnEditable ? bizagi.util.parseBoolean(data.editable[i][j]) : false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init required overrides\r\n        if (data.required) {\r\n            for (var i = 0, len = data.required.length; i < len; i++) {\r\n                key = data.required[i][0];\r\n                for (var j = 0, len_v = data.required[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).required = bizagi.util.parseBoolean(data.required[i][j]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the row indexes for the data\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.properties.data.rows, self.getDataNewRows());\r\n        return $.map(data, function (item, i) {\r\n            return item[0];\r\n        });\r\n    },\r\n    /**\r\n     *  Return object with value of all new records unsaved within the grid\r\n     *  @return {object} all new records\r\n     */\r\n    getDataNewRows: function () {\r\n        var self = this;\r\n        var newRows = [];\r\n\r\n        if (typeof self.newRecords == \"object\" && !$.isEmptyObject(self.newRecords)) {\r\n            $.each(self.newRecords, function (rowKey) {\r\n                var cellValue = [];\r\n                cellValue.push(Number(rowKey));\r\n                for (var i = 0, length = self.columns.length; i < length; i++) {\r\n                    cellValue.push(self.getCellCurrentValue(rowKey, self.columns[i].properties.xpath));\r\n                }\r\n                // Add cell value row to new rows\r\n                newRows.push(cellValue);\r\n            });\r\n        }\r\n        return newRows;\r\n    },\r\n\r\n    /*\r\n     * Return the object with the required url to access the exported grid to the desired format\r\n     *  @return {object} render attributes, including id, xpathContext, idPagecache, disposition (inline or attachment), and exportType (XLS or PDF)\r\n     */\r\n    getGridExportUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getGridExportUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: params.disposition,\r\n            exportType: params.exportType,\r\n            sort: properties.sort,\r\n            sessionId: self.getSessionId(),\r\n            idForm: self.getFormContainer().properties.id\r\n\r\n        });\r\n    },\r\n\r\n    submitForGridChange: function () {\r\n        var self = this;\r\n        return self.submitOnChange(null, false);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.columns) {\r\n                $.each(self.columns, function (i, column) {\r\n                    column.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    getEnabledChecks: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            rows: properties.rowsPerPage,\r\n            xpathfilter: params.xpath\r\n        });\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridDataExclusivesSelected(params).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.page = data.page;\r\n            properties.records = data.records;\r\n            properties.totalPages = data.totalPages;\r\n\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n            defer.resolve(data);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    buildCellXpathFilter: function (key) {\r\n        if (bizagi.util.isNumeric(key)) return \"[id=\" + key + \"]\";\r\n        return \"[id='\" + key + \"']\";\r\n    },\r\n\r\n    cleanNewRecords: function () {\r\n        // Mark it as saved\r\n        this.newRecords = {};\r\n    },\r\n\r\n    /**\r\n     *\r\n     * Customizes render background color\r\n     *\r\n     * This method is called when the backgroud color is setted by Form Designer\r\n     *\r\n     * @param color\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        this._super(color);\r\n\r\n        var control = this.getControl();\r\n        control.find(\".bz-rn-grid-header-title\").css(\"background-color\", color, \"!important\");\r\n        control.find(\".bz-rn-grid-container-foother\").css(\"background-color\", color, \"!important\");\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Check has header format\r\n     * @returns {boolean}\r\n     */\r\n    hasColorHeader: function () {\r\n        var headerFormat = this.properties.headerFormat || {};\r\n\r\n        return headerFormat ? !bizagi.util.isEmpty(headerFormat.color) : false;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Hidden Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for hiddens\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.hidden\", {}, {\r\n\r\n    /**\r\n     * Returns the in-memory processed element\r\n     */\r\n    renderControl: function () {\r\n        if (this.getMode() === \"design\") {\r\n            return \"<div>\" + bizagi.localization.getResource(\"render-hidden-displayName\") + \"</div>\";\r\n        } else {\r\n            return \"<div />\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var properties = this.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Set the initial value\r\n        if (properties.value !== undefined) {\r\n            this.setDisplayValue(properties.value);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Label Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels\r\n */\r\n$.Class.extend(\"bizagi.rendering.label\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // A label itself is never \"required\" as other controls\r\n        var properties = self.properties;\r\n        properties.required = false;\r\n\r\n        // Set properties\r\n        self.properties.displayType = \"label\";\r\n        //self.properties.labelAlign = self.originalProperties.labelAlign || \"left\";\r\n        self.properties.displayName = data.properties.displayName || \"\";\r\n\r\n        if (bizagi.util.parseBoolean(self.properties.allowDinamiclabel)) {\r\n            this.properties.displayName = data.properties.displayName || bizagi.localization.getResource(\"render-label-default-display-name\");\r\n        }\r\n\r\n        self.bindingValue();\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        //this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n\r\n        if (typeof this.configureHelpText == \"function\")\r\n            this.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required label\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    bindingValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.allowDinamiclabel && self.properties.value) {\r\n            if (typeof (self.properties.value) === \"object\" && self.properties.value[0]) {\r\n                self.properties.displayName = self.properties.value[0].value;\r\n            } else if (typeof (self.properties.value) === \"string\" && self.properties.value !== \"\") {\r\n                self.properties.displayName = self.properties.value;\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function(){\r\n        //Labels never change\r\n        return false;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Render Search Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for search renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.search\", {}, {\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.searchForms = properties.searchForms || [];\r\n\r\n        // Default maxRecords is 20\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.advancedSearch = (bizagi.util.parseBoolean(properties.advancedSearch) === null) ? false : bizagi.util.parseBoolean(properties.advancedSearch);\r\n        properties.allowSuggest = bizagi.util.parseBoolean(properties.allowSuggest) !== null ? bizagi.util.parseBoolean(properties.allowSuggest) : false;\r\n        properties.allowFullSearch = properties.allowFullSearch || false;\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) || false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowTyping) !== null ? bizagi.util.parseBoolean(properties.allowTyping) : false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowSuggest) ? true : properties.allowTyping;\r\n        properties.allowClear = bizagi.util.parseBoolean(properties.allowClear) !== null ? bizagi.util.parseBoolean(properties.allowClear) : false;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // This length defines the behavior of the suggest, 2 characters are used by default meaning after 2 characters are written the search will take place\r\n        properties.searchLength = properties.searchLength || 2;\r\n\r\n        // Expire local storage cache\r\n        properties.enableLocalStorage = false;\r\n        properties.expireCache = 1000 * 60 * 15; // 15 minutes\r\n\r\n        // QAF-3297 - Compatibility for old versions of advanced search where the \"submitOnChange\" property default is true\r\n        // New \"submitVersion\" property default is 2\r\n        if (properties.advancedSearch && self.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            allowTyping: properties.allowTyping,\r\n            advancedSearch: properties.advancedSearch,\r\n            allowSuggest: properties.allowSuggest,\r\n            editable: properties.editable,\r\n            allowClear: properties.allowClear,\r\n            hasValue: self.hasValue(),\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        params.h_contexttype = self.properties.enableQuerySuggestBehavior ? \"metadata\" : params.h_contexttype;\r\n\r\n        // QA-471 When the contexttype is metadata it does not send xpathcontext\r\n        if (params && params.h_contexttype && params.h_contexttype === 'metadata') {\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // BA35025 - JFA\r\n        if (properties.term.indexOf(\"\\'\") > -1) {\r\n            var regexC = new RegExp(\"\\'\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\\'\\\\'\");\r\n        }\r\n\r\n        // QAF-6448 - JFA\r\n        if (properties.term.indexOf(\"\\\"\") > -1) {\r\n            var regexC = new RegExp(\"\\\"\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\"\");\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype: params.h_contexttype,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value\r\n     * @param {} triggerEvents\r\n     * @returns {}\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        self._super(value, triggerEvents);\r\n\r\n        if (value != undefined) {\r\n            this.value = value;\r\n            this.selectedValue = value.label;\r\n        } else {\r\n            this.value = null;\r\n            this.selectedValue = null;\r\n        }\r\n    },\r\n\r\n    /* Maps the value, when this one comes from actions*/\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var xpath = self.properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos\r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) == \"object\" && value.id === undefined)\r\n                    return;\r\n                // Add the value to the server\r\n                renderValues[xpath] = value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {}\r\n     */\r\n    submitData: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        // Add current data\r\n        if (!self.grid) {\r\n            data[self.properties.xpath] = self.getValue();\r\n        }\r\n\r\n        // Executes submit on change\r\n        self.submitOnChange(data, undefined, false);\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (typeof (value) == \"undefined\" || value == null) return false;\r\n\r\n        if (typeof value === \"object\" && value.id !== \"\" && typeof (value.id) !== \"undefined\") return true;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.text\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\");\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"text\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            value: this.properties.value,\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            helpText: this.properties.helpText,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"text-read-only\");\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isString(value)) {\r\n            value = value.replaceAll(\"`\", \"&#96;\");\r\n        }\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value, editable: this.properties.editable});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = this.getControl().find(\"input\");\r\n\r\n        //Attach event for retype double\r\n        if (this.properties.retype === \"double\")\r\n            this.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check mask property\r\n        if (properties.mask)\r\n            self.input.mask({mask: properties.mask});\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.input.val(), false);\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.input.val(), true);\r\n                }\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        // When the form have big data, block browser executing RegExp. QAF-1418.\r\n        // Check regular expression\r\n        if (typeof value == \"string\") {\r\n            if (properties.regularExpression) {\r\n                var regex = new RegExp(\"\");\r\n                try {\r\n                    regex = new RegExp(properties.regularExpression.expression);\r\n                } catch (e) {\r\n                    if (bizagi.override.showDesignValidations) {\r\n                        bizagi.log(e);\r\n                        invalidElements.push({xpath: properties.xpath, message: e.message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n\r\n                if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex) && self.properties && self.properties.xpath === \"userName\"))) {\r\n                    var message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                } else {\r\n                    if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex)))) {\r\n                        var message = properties.regularExpression.message;\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            } else {\r\n                // Strange behavior on IE. When matchs are united on IE have is very slow\r\n                // solution, divide matchs\r\n                //.*? means for more information search: \"Lazy matching regexp\"\r\n                if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                    if (properties.editable) {\r\n                        var message = this.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (!bizagi.util.parseBoolean(self.properties.editable)) {\r\n            // Render as simple value\r\n            if (typeof (value) === \"string\") {\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(\"<label class='readonly-control'>\" + valueToDisplay + \"</label>\");\r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    control.html(\"\");\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * @param value\r\n     */\r\n    setValue: function (value) {\r\n        this._super(value);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n\r\n});","/**\r\n *   Name: Bizagi Render Button Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for button renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.button\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = properties.caption || \"\";\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n\r\n        // This flag enable/disable default behaviors of buttons\r\n        // auto save and execute rule\r\n        properties.preventDefault = properties.preventDefault || false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"button\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            caption: self.properties.caption,\r\n            cssClass: self.properties.cssclass || \"\",\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render behaviour after to be processed\r\n     */\r\n    postRender: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     * @returns {}\r\n     */\r\n    saveForm: function () {\r\n        var form = this.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Executes the button action\r\n     * @returns {}\r\n     */\r\n    executeButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = properties.xpathContext || \"\";\r\n\r\n        if (properties.submitOnChangexpathContextRow) {\r\n            xpathContext = xpathContext ? xpathContext + \".\" + properties.submitOnChangexpathContextRow : properties.submitOnChangexpathContextRow;\r\n        }\r\n\r\n        // Set the loading feedback\r\n        self.getFormContainer().startLoading();\r\n\r\n        return self.dataService.multiaction().executeButton({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath || \"\",\r\n            xpathContext: xpathContext || \"\",\r\n            idPageCache: properties.idPageCache\r\n        }).always(function () {\r\n            self.getFormContainer().endLoading();\r\n            return arguments ? arguments[0] : undefined;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh the current form\r\n     * @returns {}\r\n     */\r\n    refreshForm: function () {\r\n        var form = this.getFormContainer();\r\n        form.refreshForm(this.properties.id);\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            // Save the form prior opening the dialog\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the render change event\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        var pressed = params.pressed || false;\r\n\r\n        self.triggerHandler(\"renderchange\", {render: self, pressed: pressed});\r\n    },\r\n\r\n    /**\r\n     * Run button actions\r\n     * @returns {}\r\n     */\r\n    runButtonAction: function () {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function () {\r\n            return self.executeButton();\r\n        }).done(function (result) {\r\n\r\n            if (result == null || result == true || result.result === \"success\" || result.type === \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type === \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages\r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                    // bizagi.showMessageBox(result.messages, \"Error\"); // TODO\r\n                }\r\n            }\r\n        }).fail(function (a, b, message) {\r\n            // Add error messages\r\n            try {\r\n                self.getFormContainer().addErrorMessage(message);\r\n            } catch (e) {\r\n                // bizagi.showMessageBox(message, \"Error\"); // TODO\r\n            }\r\n        });\r\n    },\r\n\r\n    processLayout: function (isLabelFormat, format) {\r\n        if (isLabelFormat) {\r\n            this.changeBackgroundColor(format.background);\r\n            this._super(!isLabelFormat, format);\r\n        }\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.getElementsToStylize(this.getControl()).style(\"background\", color, \"important\");\r\n        } else {\r\n            this.getElementsToStylize(this.getControl()).css(\"background\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return $(\"input\", $context);\r\n    },\r\n\r\n    /**\r\n     *  Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Fileprint Class\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will define basic stuff for fileprint renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.fileprint\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = (properties.caption && properties.caption != \" \")? properties.caption : \"render-fileprint-property-caption\";\r\n        properties.filesCount = properties.filesCount ? properties.filesCount : 0;\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"fileprint\");\r\n\r\n        return $.fasttmpl(template, {\r\n            caption: properties.caption\r\n        });\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n    *   get the fileprint url\r\n    */\r\n    getFilePrintUrl: function (disposition) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getFilePrintUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: disposition,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n     /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Simple Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.link\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n        properties.required = false;\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"link\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            displayName: self.properties.displayName,\r\n            align: self.properties.valueAlign,\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Do nothing\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Radio Class\r\n *   Author: Ivan Ricardo Taimal Narvaez\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n        self.setValue(properties.items);\r\n        self.updateOriginalValue();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n        self.checkListGroup = $(\".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item\", control);\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var items = self.properties.items || [];\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: items\r\n        }));\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Gets the template used by the combo render\r\n     *   can be overriden in subclasses to reuse logic and just change the template\r\n     */\r\n    getTemplateName: function () {\r\n        return \"checkList\";\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the empty node or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the current data regardless if it belongs to data or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Adds custom parameters to process the template\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal\r\n        };\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n\r\n    },\r\n\r\n    setValue: function (value) {;\r\n        this.value = bizagi.clone(value);\r\n    },\r\n\r\n    getValue: function (data) {;\r\n        return this.value || [];\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Layout Render Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define a base layout render class with common stuff related to all renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutRender\", {}, {\r\n\t/*\r\n\t *   Returns the html templated element\r\n\t */\r\n\trenderElement: function (template) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\t// Start rendering deferred\r\n\t\tself.renderingDeferred = new $.Deferred();\r\n\r\n\t\t// Set render template\r\n\t\ttemplate = template || \"render-layout\";\r\n\t\tvar renderTemplate = self.renderFactory.getTemplate(template);\r\n\r\n\t\t// Resolve render label\r\n\t\tvar label = properties.displayName;\r\n\t\tif (typeof label == \"string\") {\r\n\t\t\tlabel = label.replaceAll(\"&\", \"&amp;\");\r\n\t\t\tlabel = label.replaceAll(\"$\", \"&#36;\");\r\n\t\t\tlabel = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n\t\t\tlabel = label.replaceAll(\"\\n\", \"<br/>\");\r\n\t\t}\r\n\r\n\t\t// Render template\r\n\t\tvar html = $.fasttmpl(renderTemplate, {\r\n\t\t\tlabel: label,\r\n\t\t\tisExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n\t\t\torientation: properties.orientation,\r\n\t\t\tuniqueId: properties.uniqueId,\r\n\t\t\tid: properties.id,\r\n\t\t\tisDesign: self.getMode() === \"design\",\r\n\t\t\tmessageValidation: properties.messageValidation,\r\n\t\t\tprintVersion: form.params.printversion,\r\n\t\t\tcssClass: properties.cssclass || \"\",\r\n\t\t\thide: properties.hide\r\n\t\t});\r\n\r\n\t\t// Render internal control html\r\n\t\tvar result = self.internalRenderControl();\r\n\t\tif (!result) {\r\n\t\t\tresult = \"\";\r\n\t\t}\r\n\r\n\t\t// Check if this is an async element or not\r\n\t\tvar async = typeof (result) === \"object\" && result.done;\r\n\t\tif (!async) {\r\n\t\t\thtml = self.replaceControlHtml(html, result);\r\n\r\n\t\t} else {\r\n\t\t\tif (result.state() === \"resolved\") {\r\n\t\t\t\t// Fetch resolved result\r\n\t\t\t\thtml = self.replaceControlHtml(html, self.resolveResult(result));\r\n\t\t\t\tself.asyncRenderDeferred = null;\r\n\t\t\t} else {\r\n\t\t\t\t// Wait for result\r\n\t\t\t\tself.asyncRenderDeferred = result;\r\n\t\t\t\thtml = self.replaceControlHtml(html, \"\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn html;\r\n\t},\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n\tgetControl: function () {\r\n\t\tvar self = this;\r\n\t\tif (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n\t\t\tself.control = self.element;\r\n\t\t}\r\n\t\tif (!self.control || self.control.length == 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn self.control;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font italic style *\r\n    */\r\n\tchangeFontItalic: function (italic) {\r\n\t\tif (bizagi.util.parseBoolean(italic)) {\r\n\t\t\tthis.getControl().css(\"font-style\", \"italic\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().css(\"font-style\", \"normal\", \"!important\");\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font underline\r\n    */\r\n\tchangeFontUnderline: function (underline) {\r\n\t\tvar valueFormat = this.properties.valueFormat || {},\r\n\t\t\tvaluestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n\r\n\t\tif (bizagi.util.parseBoolean(underline)) {\r\n\t\t\tthis.getControl().css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().find(\"*\").each(function (i, element) {\r\n\t\t\t\t$(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n});","/*\r\n*   Name: BizAgi render layout Image Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for non editable image control inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutImage\", { }, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            useDefaultImage = false,\r\n            valueObj = self.properties.value || {},\r\n            uri= \"\";\r\n\r\n        //\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n\r\n        //Solucion temporal mientras se ajusta la respuesta del servicio cambiar despues de demo de 21/07/2015\r\n        /*if (value.value && value.value !== \"\" && value.value.length > 100){\r\n            var template64 = self.renderFactory.getTemplate(\"layout-image64\");\r\n            return $.fasttmpl(template64, { url: value.value, useDefaultImage: useDefaultImage });\r\n        }*/\r\n\r\n        /* if (mode === 'execution' && valueObj.value && valueObj.value.length > 0) {\r\n            uri = self.getImageUri();\r\n        }\r\n        else{\r\n            useDefaultImage = true;\r\n        } */\r\n\r\n        return $.fasttmpl(templateUri, {useDefaultImage: true });\r\n    },\r\n\r\n    /**\r\n     * Gets the base 64 image, specify in each device in order to change the size\r\n     */\r\n    getImage64: function () {\r\n        var self = this;\r\n        //Gets the real value of the image\r\n        var params = {\r\n            xpath: self.properties.xpath,\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            width: 96,\r\n            height: 96\r\n        };\r\n\r\n        return self.dataService.getEntityImage64(params);\r\n    },\r\n\r\n    /**\r\n     * Gets the url to get the array image, specify in each device in order to change the size\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Andrés Fernando Muñoz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-link\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {displayName: self.properties.displayName});\r\n        return html;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.properties.required = false;\r\n\r\n        // Set properties\r\n        this.properties.displayType = \"label\";\r\n        this.properties.labelAlign = this.originalProperties.labelAlign || \"left\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-label\");\r\n        var value = self.properties.displayName || self.properties.value || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutText\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        //properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-text\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value,editable: self.properties.editable});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Upload Class\r\n *   Author: Elkin Fernando Siabato Cruz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable upload renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutUpload\", {\r\n   // Statics\r\n   BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n   BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n   BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n   /**\r\n    * Constructor\r\n    */\r\n   init: function (params) {\r\n      // Call base\r\n      this._super(params);\r\n   },\r\n\r\n   /**\r\n    *   Update or init the element data\r\n    */\r\n   initializeData: function (data) {\r\n      var self = this;\r\n      // Call base\r\n      this._super(data);\r\n\r\n      var form = self.getFormContainer();\r\n\r\n      // Fill default properties\r\n      var properties = this.properties;\r\n\r\n      properties.editable = true;\r\n      properties.allowDelete = true;\r\n\r\n      properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n      properties.allowSendInMail = properties.allowSendInMail || false;\r\n   },\r\n\r\n   /**\r\n    * Get value files by data\r\n    */\r\n   getValueFilesByData: function(properties){\r\n      var self = this;\r\n      var defer = $.Deferred();\r\n      var dataFiles;\r\n      if (properties.value.value) {//Normal entityTemplate in form QAF-2319\r\n          dataFiles = properties.value.value;\r\n      }\r\n      else {//QAF-2210\r\n          dataFiles = properties.value;\r\n      }\r\n      var valueAuxFiles;\r\n      try{\r\n         if(self.isContextContainerWidgetRender()){\r\n            valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + dataFiles  + \"}\");\r\n            defer.resolve(properties, valueAuxFiles);\r\n         }\r\n         else{//context: my stuff\r\n            $.when(self.getDataFilesWithoutScope()).done(function(valueResult){\r\n               valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + valueResult  + \"}\");\r\n               defer.resolve(properties, valueAuxFiles);\r\n            });\r\n         }\r\n      }\r\n      catch(err){\r\n         valueAuxFiles = JSON.parse(\"{ \\\"files\\\": []}\");\r\n         defer.resolve(properties, valueAuxFiles);\r\n         console.warn(\"Exception converting data files. Error: \", err);\r\n      }\r\n      return defer.promise();\r\n   },\r\n\r\n   isContextContainerWidgetRender: function(){\r\n      var self = this;\r\n\r\n      var formContainer = self.getFormContainer();\r\n      return formContainer.params.paramsRender && formContainer.params.paramsRender.idRender;\r\n   },\r\n\r\n\r\n   /**\r\n    * Get data files when access from My stuff\r\n    */\r\n   getDataFilesWithoutScope: function(){\r\n      var self = this;\r\n      //Gets the real value of the image\r\n      var params = {\r\n         xpath: self.properties.xpath,\r\n         entity: self.value.guid,\r\n         surrogateKey: self.value.surrogateKey\r\n      };\r\n\r\n      return self.dataService.getFilesDataForLayoutUploadControl(params);\r\n   },\r\n\r\n   /**\r\n    *   Returns the internal value\r\n    */\r\n   getValue: function () {\r\n      return this.files;\r\n   },\r\n\r\n   /**\r\n    *   Returns the xpath to be used\r\n    */\r\n   getUploadXpath: function () {\r\n      return this.properties.xpath;\r\n   }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutBoolean\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-boolean\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: this.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        if(value === null || value === \"\"){\r\n            this.properties.value = \"\";\r\n        }\r\n        else if (value.toString().toLowerCase() === \"true\" || value.toString().toLowerCase() === \"false\"){\r\n            this.properties.value = bizagi.util.parseBoolean(value) ? this.getResource(\"render-boolean-yes\") : this.getResource(\"render-boolean-no\");\r\n        }\r\n        this._super(this.properties.value, triggerEvents);\r\n    }\r\n});","/**\r\n * Name: BizAgi Render Layout DateTime Class\r\n * Author: Andres Fernando Muñoz\r\n * Comments:\r\n * - This script will define basic stuff for text renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var dateFormat = self.getResource(\"dateFormat\");\r\n        var timeFormat = self.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n        else{\r\n            var indexHour = properties.fullFormat.search(/[h|H]+/ig);\r\n            if (indexHour !== -1) {\r\n                properties.fullFormat = properties.fullFormat.substring(0, indexHour - 1);\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                self.value = properties.value; // Value must always hold the value with invariant format\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            }\r\n            else {\r\n                self.value = null;\r\n            }\r\n        }\r\n        else {\r\n            self.value = null;\r\n            properties.value = \"\";\r\n            properties.displayValue = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-date-time\");\r\n        var value = (self.properties.value === null || self.properties.value === \"\") ?  \"\" : self.properties.value;\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value});\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this, dateObj;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        if (value.length == INVARIANT_FORMAT.length || value.length == (INVARIANT_FORMAT.length + 1)) {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        }\r\n        else {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n            if (dateObj && !isNaN(Date.parse(dateObj)) && !$.isNumeric(dateObj)) {\r\n                dateObj.setHours(0, 0, 0, 0);\r\n            }\r\n\r\n        }\r\n        // Set value in input\r\n        if (value && !isNaN(Date.parse(value))) {\r\n            var formattedDateTime = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            dateControl.text(formattedDateTime);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Gets the date control\r\n     */\r\n    getDateControl: function () {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date-time\", self.getControl());\r\n        return self.dateControl;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout number Class\r\n*   Author: Andres Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = typeof (properties.allowDecimals) !== \"undefined\" ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.getDefaultGroupDigits(properties.dataType);\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-number\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n     *   Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n        var regExp2 = /[\\u20AC \\u0024\\u00A3]/;\r\n        if (!value.toString().match(regExp2)) {\r\n            label.formatCurrency(\r\n                {\r\n                    symbol: properties.symbol,\r\n                    positiveFormat: properties.positiveFormat,\r\n                    negativeFormat: properties.negativeFormat,\r\n                    decimalSymbol: properties.decimalSymbol,\r\n                    digitGroupSymbol: properties.digitGroupSymbol,\r\n                    groupDigits: properties.groupDigits,\r\n                    roundToDecimalPlace: properties.numDecimals,\r\n                    colorize: properties.colorize\r\n                });\r\n        }\r\n        return label.text();\r\n    },\r\n\r\n    /*\r\n     *   Return the allow decimals default property based on the datatype\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the group digits default property based on the datatype\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Money Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for money renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol :\r\n                (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol);\r\n        }\r\n        else {\r\n            properties.symbol = \"\";\r\n        }\r\n        properties.groupDigits = true;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutPlaceholder\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n                \r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n             \r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-placeholder\");\r\n        var value = self.properties.value || self.properties.displayName || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for geolocation renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {} data\r\n     */\r\n    init: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        this.geolocation = window.navigator.geolocation;\r\n\r\n        var properties = this.properties;\r\n        properties.allowUpdate = bizagi.util.parseBoolean(properties.allowUpdate) === true;\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"geolocation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, self.properties);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Call base\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} succes_callback\r\n     * @param {} fail_callback\r\n     */\r\n    getCurrentPosition: function (succes_callback, fail_callback) {\r\n        var self = this;\r\n\r\n        if (typeof (self.geolocation) === \"undefined\") {\r\n            if (fail_callback)\r\n                fail_callback(bizagi.localization.getResource(\"render-control-unsuported-by-browser\").replace(\"{0}\", self.properties.type));\r\n            return;\r\n        }\r\n\r\n        var onSuccess = function (position) {\r\n            if (succes_callback)\r\n                succes_callback(position);\r\n        };\r\n\r\n        var onError = function (error) {\r\n            var strMessage = self.getErrorMessage(error);\r\n\r\n            if (fail_callback)\r\n                fail_callback(strMessage);\r\n        };\r\n\r\n        return self.geolocation.getCurrentPosition(onSuccess, onError);\r\n    },\r\n\r\n    /**\r\n     * Get message of error\r\n     * @param error\r\n     * @returns {*|string}\r\n     */\r\n    getErrorMessage: function (error) {\r\n        var strMessage = \"\";\r\n\r\n        // Check for known errors\r\n        switch (error.code) {\r\n            case error.PERMISSION_DENIED:\r\n            case 1:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n            case error.POSITION_UNAVAILABLE:\r\n            case 2:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-position-unavailable\");\r\n                break;\r\n            case error.TIMEOUT:\r\n            case 3:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-timeout\");\r\n                break;\r\n            default:\r\n                strMessage = \"WD: \" + bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n        }\r\n\r\n        return strMessage;\r\n    },\r\n\r\n    /**\r\n     * Change precision number of coordinates\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    performPrecision: function (data) {\r\n        var geolocation = data.split(\" \") || \"\";\r\n\r\n        if (!geolocation) return data;\r\n\r\n        try {\r\n            var latitude = parseFloat(geolocation[0].trim());\r\n            var longitude = parseFloat(geolocation[1].trim());\r\n\r\n            return latitude.toPrecision(10) + \" \" + longitude.toPrecision(10);\r\n        } catch (e) {\r\n            return data;\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Upload Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for uploads\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.upload\", {}, {\r\n    /***\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        var maxFileSizeOfProperty = Number(properties.maxSize) || 0;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 4091904;\r\n\r\n        properties.maxSize = maxFileSizeOfProperty || maxFileSizeOfUser;\r\n        properties.maxfiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n            var defExtensions = [];\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length > 0) {\r\n                    defExtensions.push(\"*.\" + singleExtensions[i]);\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = defExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowDelete = (bizagi.util.parseBoolean(properties.allowDelete) !== null && properties.editable) ? bizagi.util.parseBoolean(properties.allowDelete) : false;\r\n\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n        properties.allowSendInMail = properties.allowSendInMail || false;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount !== 0,\r\n            noFiles: self.filesCount === 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var itemTemplate = self.getTemplateItemName();\r\n        var template = self.renderFactory.getTemplate(itemTemplate);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = !self.isExecutionMode() ? \"\" : self.buildItemUrl(file); // TODO: Review if need it: javascript:void(0);\r\n\r\n        var html = $.fasttmpl(template, {\r\n            id: file.id,\r\n            mode: mode,\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getUploadXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: form.properties.sessionId,\r\n            contexttype: properties.contexttype\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the upload control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = self.getUploadXpath() + (bizagi.util.isNumeric(fileId) ? \"[id=\" + fileId + \"]\" : \"[id='\" + fileId + \"']\");\r\n\r\n        return self.dataService.deleteUploadFile({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contexttype\r\n        }).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n\r\n        // Set files property\r\n        self.files = value || []; // Dont remove this line\r\n        self.filesCount = self.files.length;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*}\r\n     */\r\n    getValue: function () {\r\n        return this.files;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && properties.editable) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (self.filesCount <= 0 && !newRow) {\r\n                var inlineEdit = self.grid ? self.grid.properties.inlineEdit : true;\r\n\r\n                if (inlineEdit) {\r\n                    message = self.getResource(\"render-required-upload\").replaceAll(\"#label#\", properties.displayName);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        data[prefix + \"xpath\"] = self.getUploadXpath();\r\n        data[prefix + \"idRender\"] = properties.id;\r\n        data[prefix + \"xpathContext\"] = properties.xpathContext;\r\n        data[prefix + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[prefix + \"contexttype\"] = properties.contexttype;\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (self.grid && self.grid.properties.inlineAdd === true) {\r\n                if (!self.hasValue() && !(self.getControl().parents(\"tr\").data(\"new-row\"))) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (!self.hasValue()) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    setRenderRequired: function (invalidElements, properties) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n        invalidElements.push({xpath: properties.xpath, message: message});\r\n    },\r\n\r\n    /**\r\n     * Templates\r\n     */\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Upload Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class in order to provide a compatibility to browsers without flash installed\r\n */\r\n\r\n// Extends from render base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.upload\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.upload.extend(\"bizagi.rendering.desktop.upload\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.upload.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.upload.extend(\"bizagi.rendering.desktop.upload\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount != 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {*}\r\n     */\r\n    renderElement: function () {\r\n        return this._super(\"render-base\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.isClicked = false;\r\n        if (self.properties.allowSendInMail) self.bindEmailDialog();\r\n\r\n        self.checkMaxFiles();\r\n\r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        if (self.properties.allowSendInMail)\r\n            self.bindEmailDialog();\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Adds a validation message to the render TODO:Remover al genomizar\r\n     * @param message\r\n     */\r\n    setValidationMessage: function (message) {\r\n        this._super(message);\r\n        var iconError = $(\".ui-bizagi-render-icon-error\", this.element);\r\n        $(iconError).parent().removeClass(\"ui-hidden\");\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.getXpathContext() || \"\";\r\n        var xpath = self.properties.xpath;\r\n        var template = self.properties.orientation === \"rtl\" ? \"dialog-send-email-rtl\" : \"dialog-send-email\";\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(template),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n\r\n    },\r\n\r\n    bindExternalPopup: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var params = self.getParams();\r\n        var properties = self.properties;\r\n        var isInGrid = self.grid ? true : false;\r\n\r\n        var options = {\r\n            idCase: params.idCase || bizagi.context.idCase,\r\n            idWorkitem: params.idWorkitem || bizagi.context.idWorkitem,\r\n            field: properties.xpath.split(\".\")[properties.xpath.split(\".\").length - 1]\r\n        };\r\n\r\n        var xpathContext = self.getXpathContext();\r\n\r\n        if (isInGrid || xpathContext != \"\") {\r\n            if (typeof xpathContext == \"string\") {\r\n                $.extend(options, {xPath: xpathContext.split(\"[\")[0] + \".\" + properties.xpath});\r\n            } else {\r\n                $.extend(options, {xPath: self.grid.properties.xpath + \".\" + properties.xpath});\r\n            }\r\n        } else {\r\n            $.extend(options, {xPath: properties.xpath});\r\n        }\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).tooltip();\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).click(function () {\r\n            var url = \"App/Upload/SendAttachedDocs.aspx?\";\r\n            url += \"idCase=\" + options.idCase;\r\n            url += \"&idWorkitem=\" + options.idWorkitem;\r\n            url += \"&xPath=\" + options.xPath;\r\n            url += \"&field=\" + options.field;\r\n\r\n            self.dataService.getCaseNumber({\r\n                idCase: options.idCase\r\n            }).done(function (response) {\r\n                var caseNumber = response.caseNumber;\r\n                caseNumber = caseNumber ? caseNumber : options.idCase;\r\n                url += \"&radNumber=\" + caseNumber;\r\n\r\n                // fix for SUITE-8927\r\n                var values = [];\r\n                if (self.value) {\r\n                    for (var i = 0; i < self.value.length; i++) {\r\n                        values.push(self.value[i][1]);\r\n                    }\r\n                }\r\n\r\n                self.currentPopup = \"genericiframe\";\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                    widgetURL: url,\r\n                    injectCss: [\".ui-bizagi-old-render*\", \".ui-bizagi-old-render-upload\"],\r\n                    modalParameters: {\r\n                        title: \"Send attached documents\",\r\n                        id: \"sendEmail\"\r\n                    },\r\n                    afterLoad: function (params) {\r\n                        var input = document.getElementById(\"btnClose\");\r\n                        if (input) {\r\n                            input.style.display = \"none\";\r\n                        }\r\n                        input = document.getElementById(\"btnCloseConfirm\");\r\n                        if (input) {\r\n                            input.style.display = \"none\";\r\n                        }\r\n\r\n                        // fix for SUITE-8927\r\n                        if (params) {\r\n                            if (params.values) {\r\n                                var values = params.values;\r\n                                var labels = document.getElementsByTagName(\"label\");\r\n                                if (labels) {\r\n                                    for (var i = 0; i < labels.length; i++) {\r\n                                        var label = labels[i];\r\n                                        // fix for SUITE-8927\r\n                                        if (label.innerText !== undefined) {\r\n                                            if (values.indexOf(label.innerText) === -1) {\r\n                                                if (label.control) {\r\n                                                    label.control.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                } else {\r\n                                                    label.previousSibling.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                }\r\n\r\n                                            }\r\n                                        }\r\n                                        if (label.textContent !== undefined) {\r\n                                            if (values.indexOf(label.textContent) === -1) {\r\n                                                if (label.control) {\r\n                                                    label.control.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                } else {\r\n                                                    label.previousSibling.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    afterLoadParams: {\r\n                        values: values\r\n                    }\r\n                });\r\n            });\r\n\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.pluginUpload = $(\".ui-bizagi-render-upload-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.dialog\"),\r\n            properties: {\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: self.getXpathContext() || properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                idSession: properties.sessionId,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize,\r\n                contexttype: properties.contexttype,\r\n                networkSpeed: networkSpeed()\r\n            },\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            onChangeFile: self.onChangeFile,\r\n            onCheckMaxSize: self.checkMaxSize,\r\n            onValidate: self.validate,\r\n            maxAllowedFiles: properties.maxfiles,\r\n            uploadedFiles: self.filesCount,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n        control.delegate(\".bz-btn-icn--delete\", \"click\", function () {\r\n            var item = $(this).closest(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n            $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                // Remove item\r\n                item.hide();\r\n\r\n                // Detach item\r\n                item.remove();\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n                //Set Value\r\n                self.setValue(self.files, false);\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Opens a dialog in order to upload file per file\r\n     */\r\n    openUploadDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var doc = window.document;\r\n\r\n        // Reset Flag\r\n        self.isClicked = false;\r\n\r\n        var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n\r\n        // Select button\r\n        buttons[self.getResource(\"render-upload-dialog-select\")] = function (e) {\r\n            e.stopPropagation();\r\n            if (!self.isClicked) {\r\n                self.isClicked = true;\r\n                if (self.checkMaxSize() && self.checkFileTypes() && !self.maxFilesLimit()) {\r\n                    $.when(self.processUploadFile()).done(function (data) {\r\n                        self.onUploadFileCompleted(data);\r\n                        self.closeUploadDialog();\r\n                    });\r\n                } else {\r\n                    self.isClicked = false;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Cancel button\r\n        buttons[self.getResource(\"text-cancel\")] = function () {\r\n            self.closeUploadDialog();\r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: 500,\r\n            height: 350,\r\n            title: self.getResource(\"render-upload-link-label\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                self.closeUploadDialog();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Render template\r\n        var dialogTemplate = self.renderFactory.getTemplate(\"upload.dialog\");\r\n        $.tmpl(dialogTemplate, {\r\n            url: properties.addUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            idSession: properties.sessionId,\r\n            validExtensions: properties.validExtensions.replace(\";\", \",\"),\r\n            maxSize: properties.maxSize,\r\n            contexttype: properties.contexttype\r\n        }).appendTo(dialogBox);\r\n        $(\".ui-bizagi-loading-message\").remove();\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @returns {*}\r\n     */\r\n    processUploadFile: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var dialogBox = self.dialogBox;\r\n        var uploadForm = $(\"form\", dialogBox);\r\n        var uploadIFrame = $(\"iframe\", uploadForm);\r\n\r\n        // When the iframe loads the user we need to evaluate the response and close the dialog\r\n        var timeoutFn = function () {\r\n            try {\r\n                var response = \"\";\r\n                if (uploadIFrame[0].contentWindow) {\r\n                    var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                        : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                    response = iframeContent.text();\r\n                }\r\n                if (response.length > 0) {\r\n                    defer.resolve(response);\r\n                } else {\r\n                    setTimeout(timeoutFn, 50);\r\n                }\r\n            } catch (e) {\r\n                // Nothing todo, just close the window and show error message\r\n                self.closeUploadDialog();\r\n                window.alert(\"Error:\" + e.toString());\r\n            }\r\n        };\r\n\r\n        // Execute the timed function in order to check when the response has arrived\r\n        timeoutFn();\r\n\r\n        // Submit the form\r\n        uploadForm.submit();\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Close the upload dialog\r\n     */\r\n    closeUploadDialog: function () {\r\n        var self = this;\r\n        self.isClicked = false;\r\n        self.dialogBox.dialog(\"destroy\");\r\n        self.dialogBox.remove();\r\n    },\r\n\r\n    /**\r\n     * Verify if control reached maximum number of files\r\n     */\r\n    maxFilesLimit: function () {\r\n        return this.filesCount >= this.properties.maxfiles;\r\n    },\r\n\r\n    /**\r\n     * Check if the max files condition is true to hide the upload link\r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var uploadField = $(\".ui-bizagi-render-upload-wrapper\", control);\r\n\r\n        if (self.maxFilesLimit()) {\r\n            //Hide upload element             \r\n            bizagi.util.cssExtended(uploadField.find(\"a\"), \"display:none!important\");\r\n\r\n            //Disable the control, to prevent further click events\r\n            self.enabled = false;\r\n\r\n        } else {\r\n            // show upload element\r\n            bizagi.util.cssExtended(uploadField.find(\"a\"), \"display:block!important\");\r\n\r\n            //Enable the control, to prevent further click events\r\n            self.enabled = true;\r\n        }\r\n\r\n        //Checks if the files count is equals to 0, to show the no files dialog\r\n        if (self.filesCount == 0) {\r\n            $(\".no-files\", control).css(\"display\", \"block\");\r\n        } else {\r\n            $(\".no-files\", control).hide();\r\n        }\r\n    },\r\n\r\n    onChangeFile: function (files) {\r\n        var self = this;\r\n        var i = 0;\r\n        var length;\r\n        var file;\r\n        var maxSize = self.properties.maxSize;\r\n\r\n        if (files) {\r\n\r\n            length = files.length;\r\n\r\n            for (; i < length;) {\r\n\r\n                file = files[i++];\r\n\r\n                if (file.size > maxSize) {\r\n                    self.previousCheck = false;\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        self.previousCheck = true;\r\n    },\r\n\r\n    /**\r\n     * Resolves default value align for each display type\r\n     * @param displayType\r\n     * @returns {string}\r\n     */\r\n    getDefaultValueAlign: function () {//displayType is not more important for align values \r\n        return \"\";\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded\r\n     * @param renderReference\r\n     * @param response\r\n     */\r\n    onUploadFileCompleted: function (renderReference, response) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".ui-bizagi-render-upload-wrapper\", control);\r\n\r\n        // Pre-parse response because in IE sometimes the server returns the JSON enclosed with some weird <FONT> tags\r\n        response = response.replace(/<.+>({.*})\\r?\\n?.*<.+>/gm, \"$1\");\r\n\r\n        // Check if previous call return a valid json\r\n        try {\r\n            var result = JSON.parse(response);\r\n        } catch (e) {\r\n            // Invalid json, try to catch error response\r\n            var errorList = [\r\n                {\r\n                    toFind: \"Maximum request length\",\r\n                    message: self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", self.properties.maxSize)\r\n                }\r\n            ];\r\n\r\n            $.each(errorList, function (key, validation) {\r\n                if (response.indexOf(validation.toFind) >= 0 && !result) {\r\n                    result = {type: \"error\", message: validation.message};\r\n                }\r\n            });\r\n\r\n            if (!result) {\r\n                // Dont mapped \r\n                result = {type: \"error\", message: \"Error:\" + result};\r\n            }\r\n        }\r\n\r\n        if (result.type != \"error\") {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem({id: result.id, fileName: result.fileName});\r\n            $(newItem).insertBefore(uploadWrapper);\r\n\r\n            self.processControlLayout(self.properties.valueFormat);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            //Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n            //Set Value\r\n            self.setValue(files, false);\r\n\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n\r\n            if (typeof (self.grid) != \"undefined\" && typeof (self.grid.properties) != \"undefined\") {\r\n                self.grid.properties.canBeExported = true;\r\n            }\r\n        } else {\r\n\r\n            //HTTP Error 404.13 is launched when the max file size configurated for iis is reached. the Request to the server is blocked \r\n            if (result.message === \"Error:undefined\" && response.indexOf(\"HTTP Error 404.13\") > -1)\r\n                result.message = self.getResource(\"render-upload-iis-maxsize\");\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    //#region Render-Base    \r\n\r\n    changeFontItalic: function ($element, italic) {\r\n\r\n        this._super($element, italic);\r\n\r\n        if ($element.hasClass(\"ui-bizagi-render-control\") && bizagi.util.parseBoolean(italic)) {\r\n            this.getElementsToStylize(control).css(\"padding\", \"0 .1em\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".ui-bizagi-render-upload-item .bz-file-name, .no-files\", context);\r\n    },\r\n\r\n    //#endregion\r\n\r\n    /**\r\n     * checkMaxSize\r\n     * @param {object} renderReference\r\n     */\r\n    checkMaxSize: function (renderReference) {\r\n        var self = renderReference;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var fileControl = $(\"input[type=file]\", dialogBox).get(0);\r\n\r\n        // Dont exist any fucking way to know file size in IEx, just skip this validation\r\n        if (fileControl.files != undefined) {\r\n            if (fileControl.files.length > 0) {\r\n                if (fileControl.files[0].size === 0) {\r\n                    self.showError(self.getResource(\"render-upload-error-file-empty\")\r\n                        .replace(\"%s\", fileControl.files[0].name));\r\n                    return false;\r\n                }\r\n                if (fileControl.files[0].size > properties.maxSize) {\r\n                    self.showError(self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", properties.maxSize));\r\n                    return false;\r\n                }\r\n                return true;\r\n            } else {\r\n                self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                return false;\r\n            }\r\n        } else {\r\n            if (bizagi.util.isIE()) {\r\n                if (fileControl.value === \"\" || !fileControl.value) {\r\n                    self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                    return false;\r\n                } else {\r\n                    if (self.previousCheck) {\r\n                        return true;\r\n                    } else {\r\n                        if (document.documentMode > 9) {\r\n                            self.showError(self.getResource(\"render-upload-alert-maxsize\")\r\n                                .replace(\"{0}\", properties.maxSize));\r\n                            return false;\r\n                        } else {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n    checkFileTypes: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var file = $(\"input[type=file]\", dialogBox).val();\r\n\r\n        if (properties.validExtensions && properties.validExtensions.length > 0) {\r\n            var validExtensions = properties.validExtensions.replaceAll(\"*.\", \"\").split(\";\");\r\n            if (!self.stringEndsWithValidExtension(file, validExtensions, true)) {\r\n                self.showError(self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Additional validations\r\n     * @param renderReference\r\n     * @returns {boolean}\r\n     */\r\n    validate: function (renderReference) {\r\n        var self = renderReference;\r\n        var properties = self.properties;\r\n        var fileControl = $(\"input[type=file]\", self.dialogBox).get(0) || {};\r\n\r\n        //Verifies that the file name is not repeated\r\n        if (self.files) {\r\n            for (var i = 0; i < self.files.length; i++) {\r\n                var fileName = self.files[i][1];\r\n                if (fileName.toUpperCase() == fileControl.files[0].name.toUpperCase()) {\r\n                    self.showError(self.getResource(\"render-upload-error-file-exists\"));\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    stringEndsWithValidExtension: function (stringToCheck, acceptableExtensionsArray, required) {\r\n        if (required == false && stringToCheck.length == 0) return true;\r\n\r\n        for (var i = 0; i < acceptableExtensionsArray.length; i++) {\r\n            if (acceptableExtensionsArray[i].toLowerCase() == \"*\") return true\r\n            if (stringToCheck.toLowerCase().endsWith(acceptableExtensionsArray[i].toLowerCase())) return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    showError: function (message) {\r\n        var self = this;\r\n        var errorContainer = $(\"#alert-file-upload\", self.dialogBox);\r\n\r\n        // Empty container\r\n        errorContainer.empty();\r\n        errorContainer.show();\r\n\r\n        errorContainer.html(message);\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(null);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var arrayItems = control.find(\".ui-bizagi-render-upload-item\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Remove items\r\n        arrayItems.hide();\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n        self.checkMaxFiles();\r\n\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties, control, item;\r\n\r\n        if (properties.editable) {\r\n            if (value && value.length === 0) {\r\n                control = self.getControl();\r\n                item = control.find(\".ui-bizagi-render-upload-item\");\r\n                item.hide();\r\n                item.remove();\r\n                self.checkMaxFiles();\r\n            }\r\n        }\r\n\r\n        self._super(value);\r\n    },\r\n\r\n    getLabel: function(){\r\n        return $(\"label\", this._super());\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render ECM upload control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for ECM Control\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.ecm\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=uploadECMFile\";\r\n        properties.editUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=updateECMFileContent\";\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(properties.xpath);\r\n        properties.showMetadata = properties.showMetadata === undefined || properties.showMetadata === null ? true : bizagi.util.parseBoolean(properties.showMetadata);\r\n\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param listControl\r\n     * @param fileProperties\r\n     * @returns {*}\r\n     */\r\n    renderControl: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"ecm\");\r\n        var mode = self.getMode();\r\n        var defer = new $.Deferred();\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n        var html = $.fasttmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage\r\n        });\r\n\r\n        if (self.properties.value != undefined) {\r\n\r\n            var lengthValues = self.properties.value.length;\r\n\r\n            if (lengthValues === 0) {\r\n                defer.resolve(html);\r\n            }\r\n\r\n            $.each(self.properties.value, function (key, value) {\r\n                var data = {};\r\n\r\n                data.idFileUpload = value[0];\r\n                data.fileName = value[1];\r\n                data.idPageCache = self.properties.idPageCache;\r\n                data.xpathContext = self.getXpathContext();\r\n                data.xPath = self.properties.xpath;\r\n                data.editable = self.properties.editable;\r\n                data.idAttrib = self.properties.idAttrib;\r\n\r\n                var form = self.getFormContainer();\r\n                if (form && form.properties && form.properties.sessionId) {\r\n                    data.sessionId = form.properties.sessionId;\r\n                }\r\n\r\n                if (mode === \"execution\") {\r\n                    $.when(self.renderFileLayout(data, fileProperties)).done(function (item) {\r\n                        lengthValues--;\r\n\r\n                        if (bizagi.loader.productBuildToAbout && bizagi.loader.productBuildToAbout.indexOf(\"10.4\") === 0) {\r\n                            item = item.replaceAll(\"Handlers/MetadataFile\", \"Handlers/Metadata\");\r\n                        }\r\n\r\n                        html = self.replaceItemHtml(html, self.properties.id + \"-\" + data.idFileUpload, item);\r\n                        if (lengthValues === 0) {\r\n                            defer.resolve(html);\r\n                        }\r\n                    });\r\n\r\n                }\r\n            });\r\n        } else {\r\n            defer.resolve(html);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    replaceItemHtml: function (html, id, replace) {\r\n        return html.replace(\"{{\" + id + \"}}\", replace);\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            var html = $.fasttmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return (image.indexOf(extension.toUpperCase()) > -1) ? true : false;\r\n    },\r\n\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var p_sessionId = bizagi.cookie(\"JSESSIONID\");\r\n\r\n        if(!file.data) {\r\n            file.data = {fileName: file.fileName, idAttrib: file.idAttrib}\r\n        }\r\n\r\n        return self.dataService.getECMFileUrl({\r\n            idFileUpload: file.idFileUpload,\r\n            xPath: file.xpath || file.xPath,\r\n            xpathContext: file.xpathContext,\r\n            idAttrib: file.data.idAttrib,\r\n            idPageCache: self.properties.idPageCache,\r\n            fileName: file.data.fileName.replace(/ /g, \"_\"),\r\n            p_sessionId: p_sessionId,\r\n            sessionId: file.data.sessionId || \"\"\r\n        });\r\n    },\r\n\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        // data.fileExt = properties.validExtensions;\r\n        // data.fileDesc = properties.validExtensions ? self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions : \"\";\r\n        data.xPath = properties.xpath;\r\n        data.idAttrib = properties.idAttrib;\r\n        data.xpathContext = properties.xpathContext;\r\n        data.metaValues = [];\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Get name of file extension\r\n     * @param fileName\r\n     * @returns {*}\r\n     */\r\n    getFileExtension: function (fileName) {\r\n        fileName = fileName || \"\";\r\n        return fileName.split(\".\").pop();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = (self.files.length) ? self.files.length : properties.value;\r\n    },\r\n\r\n    /**\r\n     * Gets xpath context\r\n     * @returns {*|string}\r\n     */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.deleteECMFile(params).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Lock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    lockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.checkOutFile(params);\r\n    },\r\n\r\n    /**\r\n     * Unlock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    unlockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.cancelCheckOut(params);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Yes-no Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for yes-no renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.yesno\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"yesno\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmptyValue(value)) return false;\r\n        return bizagi.util.parseBoolean(value) !== null;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Letter Class\r\n*   Author: Diego Parra\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for letter renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.letter\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a variable to check if the letter has been opened when editable\r\n        this.letterOpened = false;\r\n    },\r\n\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter.readonly\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getLetterContent: function () {\r\n        // Set flag to true\r\n        this.letterOpened = true;\r\n\r\n        return this.dataService.getLetterContent({\r\n            url: this.properties.getUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sends the content to the server in order to save\r\n     * @param {} content\r\n     */\r\n    saveLetterContent: function (content) {\r\n        return this.dataService.saveLetterContent({\r\n            url: this.properties.saveUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache,\r\n            content: content\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getCanGenerateLetter: function () {\r\n        return this.dataService.getCanGenerateLetter({\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) return true;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) return true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.letterOpened == false) {\r\n                message = self.getResource(\"render-letter-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the current xpath\r\n     */\r\n    getXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the current context xpath\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Form Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.formLink\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n\r\n        properties.displayType = \"value\";\r\n        properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"formLink\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            align: properties.valueAlign,\r\n            displayName: properties.displayName,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            likeButton: bizagi.util.parseBoolean(properties.likeButton) || false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Submits a edit request for a link display form\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitEditRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        return self.dataService.editLinkForm({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: self.getFormLinkXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        }).done(function (response) {\r\n            var executeSubmitOnChange = true;\r\n\r\n            if (response && response.type === \"validationMessages\")\r\n                executeSubmitOnChange = false;\r\n\r\n            if (executeSubmitOnChange)\r\n                self.submitOnChange({});\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a rollback request\r\n     * @param params\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            }\r\n            else{\r\n                return self.dataService.rollbackLinkForm({\r\n                    url: properties.rollbackUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: params ? params.idPageCache : properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a commit request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCommitRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.commitLinkForm({\r\n                    url: properties.commitUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a checkpoint request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCheckpointRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.sendCheckpoint({\r\n                    url: properties.checkpointUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a submitData request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitDataRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function () {\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value) {\r\n                return null;\r\n            } else {\r\n\r\n\r\n                return self.dataService.submitData({\r\n                    url: properties.checkpointUrl,\r\n                    action: \"SUBMITDATA\",\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Get Form Link xpath to use\r\n     * @returns {*}\r\n     */\r\n    getFormLinkXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Don't do anything\r\n    }\r\n\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Render Document Generator\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for document generator render\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.document\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var properties = this.properties;\r\n\r\n        properties.validate = bizagi.util.parseBoolean(properties.validate) != null ? bizagi.util.parseBoolean(properties.validate) : false;\r\n        properties.downloadalldocuments = properties.downloadalldocuments ? properties.downloadalldocuments : false;\r\n        properties.allowGenerate = properties.allowGenerate !== undefined ? properties.allowGenerate : true;\r\n        properties.append = properties.append ? properties.append : false;\r\n\r\n        if (properties.caption) {\r\n            properties.caption = bizagi.util.trim(properties.caption);\r\n\r\n            if (properties.caption.length === 0) {\r\n                properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n            }\r\n        } else {\r\n            properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n\r\n        self.preRenderControl();\r\n\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var downloadAllDocuments = properties.downloadalldocuments;\r\n        var allowGenerate = properties.allowGenerate;\r\n        var template = self.renderFactory.getTemplate(self.getTemplate());\r\n        var documents = properties.value || [];\r\n        var noFiles = documents ? (documents.length === 0) : true;\r\n\r\n        // Render template\r\n        var html = self.getControlHtml(template, mode, downloadAllDocuments, allowGenerate, properties, noFiles);\r\n\r\n        // Render current children\r\n        var items = this.renderDocumentsHtml(documents);\r\n        items += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadAllDocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*|jQuery}\r\n     */\r\n    getControlHtml: function (template, mode, downloadAllDocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n\r\n        return $.fasttmpl(template, {\r\n            noActivateButton: false,\r\n            editable: mode !== \"execution\",\r\n            mode: mode,\r\n            downloadalldocuments: downloadAllDocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {boolean}\r\n     */\r\n    activateButton: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    },\r\n\r\n    /**\r\n     * Renders a single document item\r\n     * @param file\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderDocumentItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            editable: self.properties.editable,\r\n            joined: false\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: self.getSessionId()\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the download all items item url\r\n     * @returns {*}\r\n     */\r\n    buildAllDocumentsUrl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var returnLink = self.dataService.getAllDocumentsDownloadUrl({\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            idCase: properties.caseId,\r\n            idWorkItem: properties.workitemId,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n        return returnLink;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @returns {string}\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        return \"<div></div>\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode !== \"design\") {\r\n            var control = self.getControl();\r\n            var htmlControl = self.renderControl();\r\n\r\n            control.append(htmlControl);\r\n\r\n            self.updateControlForPrintMode(control);\r\n\r\n            // Execute the same as post-render\r\n            self.postRender();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    validateContainer: function () {\r\n        // Check if the form is valid, then generate\r\n        var form = this.getFormContainer();\r\n        return form.validateForm();\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    save: function () {\r\n        var form = this.getFormContainer();\r\n\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{actions}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceActionsHtml: function (html, replace) {\r\n        return html.replace(\"{{actions}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && !properties.buttonExecuted) {\r\n            if (self.value) {\r\n                if (self.value.length > 0) return true;\r\n                message = self.getResource(\"render-document-required-text\");\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Attach handler\r\n        var generateLink = $(\".ui-bizagi-button-documentgenerator\", control);\r\n        if (mode === \"execution\") {\r\n            generateLink.click(function (e) {\r\n                if (e.isPropagationStopped()) return;\r\n                e.stopPropagation();\r\n\r\n                self.properties.buttonExecuted = true;\r\n\r\n                if (self.properties.validate) {\r\n                    // Check if the form is valid, then generate\r\n                    var isValid = self.validateContainer();\r\n                    if (isValid) {\r\n                        self.documentTemplateGenerate();\r\n                    }\r\n                } else {\r\n                    // Just generate the form\r\n                    self.documentTemplateGenerate();\r\n                }\r\n\r\n                self.properties.buttonExecuted = false;\r\n            });\r\n        }\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-document-preview\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.showDocumentPreview($(this).data(\"url\"), $(this).data(\"filename\"));\r\n        });\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-container-documents-item-delete\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.deleteDocumentTemplate($(this).data(\"filename\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var params = {\r\n            xpath: self.properties.xpath + \"[fileName='\" + filename + \"']\",\r\n            idRender: self.properties.id,\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.dataService.deleteUploadFile(params))\r\n            .done(function () {\r\n                $.when(self.dataService.multiaction().getPropertyData({\r\n                    xpath: self.properties.xpath,\r\n                    idRender: self.properties.id,\r\n                    xpathContext: self.getContextXpath(),\r\n                    idPageCache: self.properties.idPageCache,\r\n                    property: \"value\"\r\n                })).done(function (documents) {\r\n                    self.resolveDeleteDocumentTemplate(documents, false, self.properties.downloadalldocuments);\r\n\r\n                    // Finish loading\r\n                    self.endLoading();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.startLoading();\r\n\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        self.save().done(function () {\r\n\r\n            bizagi.showErrorAlertDialog = false;\r\n\r\n            $.when(self.dataService.generateDocumentTemplate(properties))\r\n                .done(function () {\r\n\r\n                    // Fetch again the value property\r\n                    $.when(self.dataService.multiaction().getPropertyData({\r\n                        xpath: properties.xpath,\r\n                        idRender: properties.id,\r\n                        xpathContext: self.getContextXpath(),\r\n                        idPageCache: properties.idPageCache,\r\n                        property: \"value\"\r\n                    })).done(function (documents) {\r\n                        self.resolveDocumentTemplateGenerate(documents, false, properties.downloadalldocuments);\r\n\r\n                        // Finish loading\r\n                        self.endLoading();\r\n                    });\r\n\r\n                }).fail(function (error) {\r\n                self.endLoading();\r\n\r\n                // Add error messages\r\n                self.showErrorMessage(error);\r\n            });\r\n        }).fail(function (message) {\r\n            self.endLoading();\r\n\r\n            // Add error messages\r\n            self.showErrorMessage(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show the error message when something went wrong with the service.\r\n     * @param error\r\n     */\r\n    showErrorMessage: function (error) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var messageText = self.resources.getResource('render-upload-alert-maxsize').replace(\"{0}\", BIZAGI_SETTINGS.UploadMaxFileSize);\r\n\r\n        try {\r\n            messageText = error && typeof (error.responseText) !== \"undefined\" ? JSON.parse(error.responseText).message : error;\r\n        } catch (e) {\r\n        }\r\n\r\n        form.addErrorMessage(messageText);\r\n        form.endLoading();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set. (virtual Function)\r\n     */\r\n    autoOpenDocuments: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n    },\r\n\r\n    /**\r\n     * Identifies the extension of the file in a simpler way that ECM does\r\n     * @param file\r\n     * @returns {string}\r\n     */\r\n    returnCssTypeFile: function (file) {\r\n\r\n        if (file == undefined || file.lenght === 0) {\r\n            return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n\r\n        var extension = file.substr((file.lastIndexOf('.') + 1));\r\n\r\n        switch (extension) {\r\n            case 'docx':\r\n                return \"ui-bizagi-document-upload-item-doc\";\r\n            case 'pdf':\r\n                return \"ui-bizagi-document-upload-item-pdf\";\r\n            case 'xlsx':\r\n                return \"ui-bizagi-document-upload-item-xls\";\r\n            default:\r\n                return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadAllDocuments) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var html = \"\";\r\n        var documentContainer = $(\"[data-component='files']\", control);\r\n\r\n        // Clear current links\r\n        documentContainer.empty();\r\n\r\n        // Draw links again\r\n        html += this.renderDocumentsHtml(documents);\r\n\r\n        // Check if there are documents and the flag to download all are available to show the link.\r\n        html += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        documentContainer.append(html);\r\n\r\n        //Set value\r\n        self.setValue(documents);\r\n    },\r\n\r\n    /**\r\n     * This method must be implemented by the specific class of each device. (Virtual method)\r\n     * @param file\r\n     * @returns {*|*|*}\r\n     */\r\n    renderAllDocumentDownload: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildAllDocumentsUrl();\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            joined: true\r\n        });\r\n\r\n        return self.removeDeleteButton(html);\r\n    },\r\n\r\n    /**\r\n     * removeDeleteButton\r\n     * @param html\r\n     * @returns {*}\r\n     */\r\n    removeDeleteButton: function (html) {\r\n        var startIndex = html.indexOf(\"<span class=\\\"ui-bizagi-container-documents-item-delete\");\r\n\r\n        if (startIndex > 0) {\r\n            var restOfWord = html.substring(startIndex);\r\n            var finishIndex = restOfWord.indexOf(\"</span>\") + 7;\r\n\r\n            return html.substring(0, startIndex) + restOfWord.substring(finishIndex);\r\n        } else {\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process request of DeleteDocumentTemplate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDocumentTemplateGenerate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.autoOpenDocuments();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Process request of DocumentTemplateGenerate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDeleteDocumentTemplate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Method to renders the documents\r\n     * @param documents\r\n     * @returns {string}\r\n     */\r\n    renderDocumentsHtml: function (documents) {\r\n        var items = \"\";\r\n\r\n        for (var i = 0; i < documents.length; i++) {\r\n            var document = {id: documents[i][0], fileName: documents[i][1]};\r\n            var item = this.renderDocumentItem(document);\r\n\r\n            items += item;\r\n        }\r\n\r\n        return items;\r\n    },\r\n\r\n    /**\r\n     * Methos to renders action of document\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     * @returns {string}\r\n     */\r\n    renderActionsHtml: function (documents, noFiles, downloadAllDocuments) {\r\n        var actions = \"\";\r\n\r\n        if (downloadAllDocuments && (!noFiles && documents.length > 0)) {\r\n            var downloadAllDocumentsLink = {fileName: this.getResource(\"render-document-downloadalldocuments\")};\r\n            var action = this.renderAllDocumentDownload(downloadAllDocumentsLink);\r\n\r\n            actions += action;\r\n        }\r\n\r\n        return actions;\r\n    },\r\n\r\n    getTemplate: function () {\r\n        return \"document\";\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-item\";\r\n    },\r\n\r\n    getErrorTemplate: function () {\r\n        return \"form-error\";\r\n    },\r\n\r\n    getTemplateDownload: function () {\r\n        return \"document-download\";\r\n    },\r\n\r\n    getTemplateReadonly: function () {\r\n        return \"document-readonly\";\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Cascading Combo Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for cascading combo renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Create dependency collection\r\n        self.dependants = [];\r\n        self.isDependant = false;\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.hasLocalData = bizagi.util.isEmpty(properties.parentCombo) ? properties.hasLocalData : false;\r\n\r\n        if (properties.value && properties.value.id === undefined)\r\n            properties.value = null;\r\n\r\n        self.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData)\r\n            properties.data = self.complementData(properties.data);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo != null) {\r\n            var renderType = bizagi.util.normalizeType(parentCombo.properties.type);\r\n\r\n            if (/^cascadingcombo$/i.test(renderType)) {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n\r\n    configureReadOnlyHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n    /*\r\n    *   Refresh the combo, after it has been painted\r\n    */\r\n    refresh: function (params, isInitialValue) {\r\n        var self = this;\r\n\r\n        // Wait until current element is rendered\r\n        $.when(self.isRendered()).done(function () {\r\n\r\n            // Unbind previous handler\r\n            // self.parentCombo.unbindDependantCombo(self);\r\n\r\n            // Clear current control\r\n            var control = self.getControl();\r\n            var mode = self.getMode();\r\n            control.empty();\r\n\r\n            // Render combo again\r\n            $.when(self.renderCombo(params)).then(function (html) {\r\n                // Append new element\r\n                control.html(html);\r\n\r\n                // Post-render method\r\n                self.postRender();\r\n\r\n                if (mode == \"execution\") {\r\n                    self.configureHandlers();\r\n                }\r\n\r\n                // Set current value\r\n                if (self.getValue() !== undefined) {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n\r\n                if (self.deferredVisible) {\r\n                    self.deferredVisible.resolve();\r\n                }\r\n\r\n                self.trigger(\"select\", [self.value, isInitialValue]);\r\n\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode != \"execution\") return self.getDummyData();\r\n\r\n        // Do not load dependant combos when there are no parent id\r\n        if (self.isDependant) {\r\n            if (self.parentCombo && params) {\r\n                self.properties.remoteDataLoaded = false;\r\n            }\r\n\r\n            // Return an empty array when there are no parent defined when the combo is dependant\r\n\r\n            var parentValue = (self.parentCombo.selectedValue) ? self.parentCombo.selectedValue.id : '';\r\n\r\n            if (parentValue != '') {\r\n                return this._super(params);\r\n            } else {\r\n                return [];\r\n            }\r\n        }\r\n\r\n        return this._super(params);\r\n    },\r\n\r\n\r\n    /* \r\n    *   Bind the combos to create the cascading feature\r\n    */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var renderType = bizagi.util.normalizeType(dependantCombo.properties.type);\r\n\r\n        // Check it is a cascading combo\r\n        if (/^cascadingcombo$/i.test(renderType)) {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n                self.refreshDependantCombo(dependantCombo, item.id, self.focusDependant, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (self.properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    isEventBinded: function (event) {\r\n        if (typeof $._data(this.observableElement.get(0), \"events\") === \"undefined\") {\r\n            return false;\r\n        } else {\r\n            if (typeof $._data(this.observableElement.get(0), \"events\")[event] === \"undefined\") {\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /* \r\n    *   Unbind the combos that are being redrawn\r\n    */\r\n    unbindDependantCombo: function (dependantCombo) {\r\n        // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n        this.unbind(\"select\", dependantCombo.onChangeFunction);\r\n    },\r\n\r\n    /*\r\n    *   Fills the next dependant combo based on the given value\r\n    */\r\n    refreshDependantCombo: function (dependant, parentValue, focus, isInitialValue) {\r\n        var self = this;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue;\r\n\r\n        dependant.deferredVisible = $.Deferred();\r\n\r\n        if (!isInitialValue) {\r\n            // Clear dependant value\r\n            dependant.setValue(\"\", false);\r\n        }\r\n\r\n        dependant.refresh(params, isInitialValue);\r\n\r\n        if (focus) {\r\n            $.when(dependant.deferredVisible.promise()).done(function () {\r\n                dependant.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Empty html when render from action\r\n     */\r\n\r\n    emptyControlByChangeEditability: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    },\r\n\r\n    /* \r\n    *   Cleans the combo value\r\n    */\r\n    cleanInput: function () {\r\n        this.triggerHandler(\"select\", {id: 0});\r\n    },\r\n\r\n    /*\r\n    *   Search for the other cascading combo refering this one, by idRender\r\n    */\r\n    getParentCombo: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check if parentCombo is defined\r\n        if (properties.parentCombo === undefined)\r\n            return null;\r\n\r\n        // Get form reference\r\n        var form = self.getFormContainer();\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n        var controls = /^cascadingcombo$/i.test(renderType) ? form.getRenderByType(properties.type) : [];\r\n\r\n        var i = 0;\r\n        var j = 0;\r\n        var parents = [];\r\n\r\n        var control = null;\r\n\r\n        for (; i < controls.length; i++) {\r\n            if (properties.parentCombo === controls[i].properties.id) {\r\n                parents.push({control: controls[i], index: i});\r\n            }\r\n        }\r\n\r\n        if (parents.length > 1) {\r\n            var parentLength, parent, xpathParent, parentArray;\r\n\r\n            for (; j < parents.length; j++) {\r\n                parent = parents[j].control;\r\n                xpathParent = parent.properties.xpath;\r\n                parentArray = xpathParent.split(\".\");\r\n                parentLength = parentArray.length;\r\n                xpathParent = parentArray.slice(0, parentLength - 1).join(\".\");\r\n\r\n                if (xpathParent === properties.xpath) {\r\n                    control = controls[parents[j].index];\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            control = form.getRenderById(properties.parentCombo);\r\n        }\r\n\r\n        // Return parent combo\r\n        return control;\r\n    },\r\n\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this;\r\n\r\n        // If the render has dependants we can't send to the server\r\n        return self._super() && bizagi.util.isMapEmpty(self.dependants);\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        var mode = this.getMode();\r\n\r\n        if (mode != \"execution\") return true;\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n\r\n        if (!self.configured) {\r\n            // Call super\r\n            self._super();\r\n            self.configured = true;\r\n        }\r\n    },\r\n\r\n    internalSubmitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (self.isDependant && self.canBeSent() && self.itemSelected !== undefined)\r\n            return self._super(data, bRefreshForm);\r\n        return defer.resolve();\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        // Call original method\r\n        self._super();\r\n\r\n        if (self.value && self.isDependant == false) {\r\n            self.internalSetInitialValueFlag = true;\r\n            self.trigger(\"select\", [self.value, true]);\r\n        }\r\n\r\n        self.internalSetInitialValueFlag = false;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render List Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for list renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.list\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {      \r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.listSize = properties.listSize || 0;\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render can be overriden in subclasses\r\n     * to reuse logic and just change the template\r\n     * @returns {} \r\n     */\r\n    getTemplateName: function() {\r\n        return \"list\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs\r\n     * to data or not Can be overriden to change behaviour    \r\n     * @returns {} \r\n     */\r\n    showCurrentData: function() {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: Bizagi Render MultiSelect Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for multiselect renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.multiSelect\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var properties = this.properties;\r\n\r\n        // Go to server\r\n        self.dataService.multiaction().getData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype || null,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (data) {\r\n\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n\r\n        }).fail(function (data) {\r\n            if (data.type === \"not-processed\")\r\n                return;\r\n\r\n            // Show error from server\r\n            var auxMsg = \"\";\r\n            var form = self.getFormContainer();\r\n            var msgObj = self.properties.displayName + \": \";\r\n\r\n            if (typeof data == \"string\") {\r\n                auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n            } else {\r\n                auxMsg = data;\r\n            }\r\n\r\n            msgObj += auxMsg.message;\r\n\r\n            form.addValidationMessage(msgObj);\r\n\r\n            defer.reject(data);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        value = JSON.encode({\"value\": value});\r\n\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.value || [];\r\n    },\r\n\r\n    /**\r\n     * Get list of data\r\n     * @returns {*|Array}\r\n     */\r\n    getDataValue: function () {\r\n        var list;\r\n\r\n        try {\r\n            list = JSON.parse(this.value);\r\n\r\n            return list.value || [];\r\n        } catch (e) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {*|Array|boolean}\r\n     */\r\n    hasValue: function () {\r\n        var values = this.getDataValue();\r\n\r\n        return values && values.length > 0;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".bz-multiselect .bz-multiselect__tag:not(.bz-multiselect__plus)\", context);\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value\r\n     */\r\n    addElement: function (value) {\r\n        var newValue = this.getDataValue();\r\n\r\n        newValue.push(value);\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value\r\n     */\r\n    removeElement: function (value) {\r\n        var idToRemove = value.id;\r\n        var newValue = this.getDataValue()\r\n            .filter(function (item) {\r\n                return item.id !== idToRemove;\r\n            });\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Submit the selected data to the server in order to be saved\r\n     */\r\n    submitData: function () {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Mark a item how checked\r\n     * @param id\r\n     * @returns {*}\r\n     */\r\n    markAsChecked: function (id) {\r\n        var self = this;\r\n\r\n        return self.selected.some(function (item, index) {\r\n            var found = item.id === id;\r\n\r\n            if (found) self.selected.splice(index, 1);\r\n            return found;\r\n        });\r\n    },\r\n\r\n    isChecked: function (values, id) {\r\n        return values.some(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to verify if can add more items\r\n     * @param $tagsContainer\r\n     * @returns {boolean}\r\n     */\r\n    canAddMoreItems: function ($tagsContainer) {\r\n        var self = this;\r\n        var containerWidth = parseInt($tagsContainer.css(\"width\"));\r\n        var $children = $tagsContainer.children();\r\n\r\n        var childrenWidth = $children\r\n            .toArray()\r\n            .reduce(function (acc, child) {\r\n                acc += self.getElementWidth(child);\r\n                return acc;\r\n            }, 0);\r\n\r\n        return containerWidth > (childrenWidth + self.Class.MORE_OPTION_WIDTH)\r\n\r\n    },\r\n\r\n    /**\r\n     * getElementWidth\r\n     * @param element\r\n     * @returns {*}\r\n     */\r\n    getElementWidth: function (element) {\r\n        var styles = window.getComputedStyle(element);\r\n        var outerWidth = $(element).outerWidth();\r\n        return outerWidth + [\r\n            \"padding-left\",\r\n            \"padding-right\",\r\n            \"margin-left\",\r\n            \"margin-right\"\r\n        ].reduce(function (acc, property) {\r\n            acc += parseInt(styles[property]);\r\n            return acc;\r\n        }, 0);\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * @param query\r\n     * @param $container\r\n     */\r\n    filterList: function (query, $container) {\r\n\r\n        $container.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = query.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n    },\r\n\r\n    /**\r\n     * Find item by id\r\n     * @param id\r\n     * @returns {[]}\r\n     */\r\n    findItemById: function (id) {\r\n        return (this.properties.data || []).find(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Money Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for money numbers\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            var symbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol;\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol : symbol;\r\n        } else {\r\n            properties.symbol = \"\";\r\n        }\r\n\r\n        properties.groupDigits = true;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Radio Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.radio\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n\r\n        // Set a random identifier to fix a problem when using radio buttons inside grids and the plugin mismatch the elements because all of them have the same name\r\n        properties.unique = bizagi.util.randomNumber(1000, 1000000);\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render\r\n     * Can be overridden in subclasses to reuse logic and just change the template\r\n     * @returns {string}\r\n     */\r\n    getTemplateName: function () {\r\n        return \"radio\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the empty node or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs to data or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Adds custom parameters to process the template\r\n     * @returns {{vertical: boolean}}\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal,\r\n            horizontal: properties.horizontal\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n        var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Check value of control is changed\r\n     * @returns {boolean}\r\n     */\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if (value && value.length !== undefined) {\r\n            value = value[0];\r\n        }\r\n        if (compareValue && compareValue.length !== undefined) {\r\n            compareValue = compareValue[0];\r\n        }\r\n        if (baseValue && baseValue.length !== undefined) {\r\n            baseValue = baseValue[0];\r\n        }\r\n\r\n        value = value && value.id !== undefined ? value.id : value;\r\n        compareValue = compareValue && compareValue.id !== undefined ? compareValue.id : compareValue;\r\n        baseValue = baseValue && baseValue.id !== undefined ? baseValue.id : baseValue;\r\n\r\n        if (baseValue !== undefined) {\r\n            if ((baseValue == value) && (value == compareValue)) {\r\n                result = false;\r\n            } else {\r\n                if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                    result = false;\r\n                } else {\r\n                    result = (compareValue == value) ? false : true;\r\n                }\r\n            }\r\n        } else {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render Search List Control\r\n*   Author: UI Forms Team\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchList\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // Set value\r\n        self.setValue(properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {} \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            allowTyping: properties.allowTyping,\r\n            items: properties.value,\r\n            hasSearchForm: properties.searchForms ? true : false,\r\n            editable: properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function() {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setValue: function(value) {\r\n        this.value = JSON.encode({ \"value\": value });\r\n        this.triggerRenderChange();\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value = { id:integer,value:[string || array] }\r\n     * @returns {} \r\n     */\r\n    addElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n\r\n        list.value.push(value);\r\n\r\n        this.setValue(list.value);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value = { id:integer }\r\n     * @returns {} \r\n     */\r\n    removeElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n        var result = [];\r\n\r\n        $.each(list.value, function(key, val) {\r\n            if (val.id != value.id) {\r\n                result.push({ id: val.id, value: val.value });\r\n            }\r\n        });\r\n\r\n        this.setValue(result);\r\n    },\r\n\r\n    /**\r\n     * Remove last element to global value\r\n     * @returns {} \r\n     */\r\n    removeLastElement: function() {\r\n        var list = JSON.parse(this.value);\r\n\r\n        if (list.value.length > 0) {\r\n            list.value.pop();\r\n            this.setValue(list.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getData: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.getSearchData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: properties.term,\r\n            extra: params\r\n        }).done(function(data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function(data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {} \r\n     */\r\n    submitData: function() {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {} \r\n     */\r\n    canBeSent: function() {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Check if the control has value\r\n     * @returns {} \r\n     */\r\n    hasValue: function() {\r\n        var list = this.getListItems();\r\n\r\n        return list.length > 0;\r\n    },\r\n\r\n    getListItems: function(){\r\n        var value = this.getValue();\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        return finalValue || [];\r\n    },\r\n    \r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi User field render\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behavior for userfields\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldDefinition\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* Private section of the userfield                          */\r\n    /*************************************************************/\r\n\r\n    /*\r\n    *   Method to be overriden by userfields in order to ensure that custom files are loaded before the execution\r\n    */\r\n    getFileDependencies: function () {\r\n        return null;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var defer = $.Deferred();\r\n        var fileDependencies = self.getFileDependencies();\r\n        if (fileDependencies && fileDependencies.length > 0) {\r\n            bizagi.loader.loadFile(fileDependencies)\r\n\t\t\t.then(function () {\r\n\t\t\t    // After all dependencies has been resolved\r\n\t\t\t    self.internalRenderControl();\r\n\t\t\t    defer.resolve();\r\n\t\t\t});\r\n\r\n        } else {\r\n            $.when( self.renderUserfieldControl()).done(function () {\r\n                defer.resolve();\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    renderUserfieldControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n\r\n        var loadUserfield = function () {\r\n            var userEditableControl = self.getEditableControl();\r\n            if (userEditableControl) {\r\n                self.input = control.html(userEditableControl);\r\n            }\r\n            self.renderComplex();\r\n            def.resolve();\r\n        };\r\n\r\n        \r\n            loadUserfield();\r\n    \r\n        \r\n        return def.promise();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n        var loadUserfieldReadOnly = function () {\r\n            try {\r\n                var userReadOnlyControl = self.getReadonlyControl();\r\n                if (userReadOnlyControl) {\r\n                    self.input = control.html(userReadOnlyControl);\r\n                }                                                 \r\n                self.renderComplex();\r\n                \r\n            } catch (error) {\r\n                var displayName = self.properties.displayName || \"Widget\";\r\n                control.html(\"<h6>\" + displayName  + \"</h6>\")\r\n            }\r\n            \r\n        };\r\n\r\n        if (self.ready) {\r\n            self.ready().done(function () {\r\n                loadUserfieldReadOnly();\r\n            });\r\n        } else {\r\n            loadUserfieldReadOnly();\r\n        }\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return self.getReadonlyValue();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control \r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n\r\n        // Set editable value in control\r\n        self.setEditableValue(value);\r\n    },\r\n\r\n    getValue: function () {\r\n        var self = this;\r\n        return self.getEditableValue();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type == \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderElements: function (xpath) {\r\n        var self = this;\r\n        var result = $();\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        $.each(controls, function (i, item) {\r\n            result = result.add($(item.element));\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getServerResourceURL: function (resource) {\r\n        var self = this;\r\n        var url = \"Rest/Userfields/{0}/resource/{1}/{2}\";\r\n        url = url.replace(\"{0}\", self.properties.userfieldGuid);\r\n        resource = resource.replace(\"\\\\\", \"__\").replace(\"/\", \"__\");\r\n        var device = bizagi.util.detectDevice();\r\n        url = url.replace(\"{1}\", device);\r\n        url = url.replace(\"{2}\", resource);\r\n        //Rest/Userfields/{0}/resource/desktop/{1}\r\n        return url;\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderValue: function (xpath) {\r\n        var self = this;\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        var control;\r\n        $.each(controls, function (index, item) {\r\n            if (!control || item.properties.editable) {\r\n                control = item;\r\n            }\r\n        });\r\n        if (control) {\r\n            return control.getValue();\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n    /*\r\n    * Shows a jquery dialog\r\n    */\r\n    showDialog: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showDialog method\");\r\n    },\r\n\r\n    /*\r\n    *   Shows a browser popup\r\n    */\r\n    showPopup: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showPopup method\");\r\n    },\r\n\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value = self.properties.value;\r\n    }\r\n\r\n\r\n});\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* methods to be overriden by the implementations            */\r\n    /*************************************************************/\r\n    getEditableControl: function () {\r\n    },\r\n\r\n    renderComplex: function () {\r\n    },\r\n\r\n    // Returns the value of the control\r\n    getEditableValue: function () {\r\n        return bizagi.rendering.render.prototype.getValue.apply(this, arguments);\r\n    },\r\n\r\n    // \r\n    setEditableValue: function (value) {\r\n        return bizagi.rendering.render.prototype.setValue.apply(this, arguments);\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n    },\r\n\r\n    getReadonlyValue: function () {\r\n        // if the method is not overriden then call the parent method \r\n        return bizagi.rendering.render.prototype.getDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n\r\n});\r\n\r\n/*\r\n*   This control will wrap any userfield in order to load the code remotely, \r\n*   when executing renderControl, which is an async method\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldWrapper\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n        // Save userfield guid and name\r\n        self.initialParams = params;\r\n        self.userfieldGuid = this.properties.userfieldGuid;\r\n        self.userfieldName = this.properties.control;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    internalPostRender: function () {\r\n        var self = this;\r\n        $.when(self.getUserfieldControl())\r\n        .done(function (control) {\r\n            control.element = self.element;\r\n\r\n            // Add grid and surrogatekey properties if the userfield is a column userfield\r\n            if (self.column) {\r\n                control.isColumn = true;\r\n                control.grid = self.grid;\r\n                control.surrogateKey = self.surrogateKey;\r\n                control.properties.xpathContext = self.getControlXpathContext(control);\r\n                control.getControl = self.column.getControl;\r\n            }\r\n\r\n            return control.internalPostRender();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Helper for userfields to fetch the xpathContext\r\n    */\r\n    getControlXpathContext: function (control) {\r\n        var self = this;\r\n        var properties = control.properties;\r\n\r\n        if (control.isColumn) {\r\n            return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\" : control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\";\r\n        }\r\n\r\n        return properties.xpathContext;\r\n    },\r\n\r\n\r\n    getUserFieldInstance: function(params){\r\n        console.log(\"not implemented\");\r\n    },\r\n\r\n    /*\r\n    *   Replicate all userfield methods to this instance in order to create a proxy\r\n    */\r\n    replicateUserfieldMethods: function (control) {\r\n        var self = this;\r\n        for (var key in control.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"subscribe\" || key == \"unsubscribe\" ||\r\n                key == \"publish\" || key == \"render\" || key == \"triggerHandler\" || key == \"dispose\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ if (this.userfieldInstance) return this.userfieldInstance.' + key + '.apply(this.userfieldInstance, arguments); return null;};tmp');\r\n        }\r\n\r\n        // Replicate properties and value\r\n        control.properties = self.properties;\r\n        control.value = self.value;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.userfieldInstance) {\r\n                self.userfieldInstance.unbind(\"renderchange\");\r\n                self.userfieldInstance.dispose();\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Render Image Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for image control\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var maxSize = 4091904;\r\n\r\n        if(properties.maxSize) {\r\n            maxSize = Number(properties.maxSize);\r\n        } else if (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\") {\r\n            maxSize = Number(BIZAGI_SETTINGS.UploadMaxFileSize);\r\n        }\r\n\r\n        properties.maxSize = maxSize;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) === true;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length != 0) {\r\n                    singleExtensions[i] = \"*.\" + singleExtensions[i].replaceAll(\" \", \"\");\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddFileUrl(properties.isUserPreference);\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null\r\n\r\n        properties.isAutoWidth = false;\r\n        properties.isAutoHeight = false;\r\n\r\n        if (properties.width === -1) {\r\n            properties.width = \"100%\";\r\n            properties.isAutoWidth = true;\r\n        } else {\r\n            properties.width = properties.width + \"px\";\r\n        }\r\n\r\n        if (properties.height === -1) {\r\n            properties.height = \"auto\";\r\n            properties.isAutoHeight = true;\r\n        } else {\r\n            properties.height = properties.height + \"px\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var def = new $.Deferred(); //design\r\n        var template = self.renderFactory.getTemplate(\"image\");        \r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = dataUrl !== \"\" ? dataUrl : \"\";\r\n                self.properties.value = self.value = self.properties.url.length > 0 ? [self.properties.url] : null;\r\n                self.setValue(self.properties.value);                \r\n\r\n                var html = $.fasttmpl(template, { url: self.properties.url });\r\n                def.resolve(html);\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"image-readonly\");\r\n        var html = $.fasttmpl(template);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * This method return the name of template of items, please make a override in each device\r\n     * @returns {*}\r\n     */\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();        \r\n        var def = new $.Deferred();\r\n        var template = self.getTemplateItem();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            var url = dataUrl || \"\";\r\n\r\n            var html = $.fasttmpl(template, {\r\n                url: url,\r\n                allowDelete: self.properties.allowDelete,\r\n                editable: self.properties.editable,\r\n                mode: mode,                \r\n            });\r\n\r\n            self.properties.url = url;\r\n            self.properties.value = url.length > 0 ? [url] : null;\r\n\r\n            def.resolve(html);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n        var url = \"\";\r\n\r\n        if (!this.isExecutionMode()) {\r\n            url = \"\"; // TODO: Review the use of \"javascript:void(0);\";\r\n            def.resolve(url);\r\n        } else {\r\n            var parameters = {\r\n                url: properties.dataUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                property: params && params.property ? params.property : \"fileContent\",\r\n                dataType: \"text\"\r\n            };\r\n\r\n            if (properties.contexttype) {\r\n                parameters.contexttype = properties.contexttype;\r\n            }\r\n\r\n            if (properties.isUserPreference) {\r\n                self.currentUser = bizagi.currentUser.idUser;\r\n                parameters.xpathContext = \"@Context.Users[id == \" + self.currentUser + \"]\";\r\n                parameters.contexttype = \"entity\";\r\n                parameters.surrogatekey = self.currentUser;\r\n            }\r\n\r\n            self.dataService.multiaction().getPropertyData(parameters, \"text\")\r\n                .done(function (data) {\r\n                    if (data.charAt(0) === \"\\\"\") {\r\n                        data = data.slice(1, -1);\r\n                    }\r\n\r\n                    if (data !== \"\") {\r\n                        url = \"data:image/png;base64,\" + data;\r\n                    }\r\n\r\n                    def.resolve(url);\r\n                });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    buildItemUrlOffline: function(parameters){\r\n        var def = new $.Deferred();\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getFormParams();\r\n        var parameters = {\r\n            idCase: formParams.idCase,\r\n            idWorkitem: formParams.idWorkitem,\r\n            id: properties.xpath,\r\n            offlineType: formParams.offlineType\r\n        }\r\n        $.when(self.dataService.getOfflineImage(parameters, \"base64\"))\r\n        .done( function(imageValue){\r\n            properties.value = imageValue;\r\n            def.resolve(bizagi.util.getDataUrl(properties));\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param path File in Browser or Path in Mobile Devices\r\n     * @param promise Promise to be resolved when save is completed\r\n     */\r\n    saveImageOffline: function (path, promise) {\r\n        var self = this;        \r\n        var blobPromise = new $.Deferred();\r\n\r\n        if(self.isNative){\r\n            var fileName = self.fileProperties.name;            \r\n            if (!bizagi.util.isAndroidDevice()) {\r\n                path = bizagi.util.media.normalizeIOSFilePath(path);\r\n            }\r\n            else{\r\n                // Fix android 4.4 getting images from recent folder\r\n                path = bizagi.util.media.getImagePath(path);\r\n            }\r\n            \r\n            var errorHandler = function (error) {\r\n                bizagi.log('error converting path to blob', error);  \r\n                blobPromise.reject(error);\r\n            };\r\n    \r\n            window.resolveLocalFileSystemURL(path, function (fileEntry) {\r\n                fileEntry.file(function (file) {    \r\n                    var reader = new FileReader();\r\n                    reader.onloadend = function () {\r\n                        var blob = new Blob([this.result], {type: file.type});\r\n                        blob.name = fileName;\r\n                        blobPromise.resolve(blob);\r\n                    }    \r\n                    reader.readAsArrayBuffer(file);\r\n                }, errorHandler);\r\n            }, errorHandler);\r\n        }\r\n        else {\r\n            blobPromise.resolve(path);\r\n        }        \r\n\r\n        $.when(blobPromise)\r\n        .done( function(blobImage) {\r\n            // Save the image as attachment \r\n            var formParams = self.getFormParams();\r\n            var parameters = {\r\n                idCase: formParams.idCase,\r\n                idWorkitem: formParams.idWorkitem,\r\n                id: self.properties.xpath,\r\n                operationType: \"edition\",\r\n                offlineType: formParams.offlineType\r\n            }\r\n\r\n            $.when(self.dataService.saveOfflineImage(parameters, blobImage))\r\n            .done( function() {\r\n                promise.resolve();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url in real size\r\n     * @returns {*}\r\n     */\r\n    buildFullItemUrl: function () {\r\n        var def = new $.Deferred();\r\n\r\n        $.when(this.buildItemUrl({\"property\": \"fileFullContent\"}))\r\n            .done(function (dataUrl) {\r\n                def.resolve(dataUrl);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        // Call base\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.properties.value || [];\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.visible) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Don't check non- editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (self.properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (!newRow) {\r\n                var value = self.getValue();\r\n\r\n                if (value.length === 0) {\r\n                    var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({ xpath: self.properties.xpath, message: message });\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = self.getUploadXpath();\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = properties.id;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = properties.xpathContext;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = 'savefile';\r\n\r\n        if (properties.contexttype) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contexttype;\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId;\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var $control = this.getControl();\r\n        $control.empty();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Columns\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.columns.column\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.decoratedClass = params.decorated;\r\n        this.data = params.data;\r\n        if (params.singleInstance) {\r\n            this.decorated = new this.decoratedClass({\r\n                data: this.data,\r\n                parent: this.parent,\r\n                renderFactory: this.renderFactory,\r\n                dataService: this.dataService\r\n            });\r\n            this.decorated.getControl = this.getControl;\r\n            params.decorated = this.decorated;\r\n            this.decorated.properties.isColumn = true;\r\n        } else {\r\n            this.decorateRenders = [];\r\n        }\r\n        this.grid = params.parent;\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.columnVisible = bizagi.util.parseBoolean(properties.columnVisible) != null ? bizagi.util.parseBoolean(properties.columnVisible) : true;\r\n        properties.align = properties.align || 'center';\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.singleInstance = params.singleInstance;\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.showColumn = (typeof properties.showColumn != \"undefined\") ? bizagi.util.parseBoolean(properties.showColumn) : true;\r\n\r\n        // Define if it is editable or not        \r\n        try {\r\n            if (params.parent && typeof params.parent.properties.editable == \"boolean\" && !params.parent.properties.editable) {\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n        // Define if the column is readonly\r\n        this.readonly = properties.readonly !== undefined ? properties.readonly : false;\r\n        if (this.readonly) properties.editable = required = false;\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to retrieve the decorated control\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        return $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n    },\r\n    /*\r\n    *   Returns the decorated cell instance to use\r\n    */\r\n    getDecorated: function (surrogateKey) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.singleInstance) {\r\n            return self.decorated;\r\n        }\r\n        else {\r\n            var decorated = self.decorateRenders[surrogateKey];\r\n            if (decorated == undefined) {\r\n                if (typeof self.decorateRenders != \"object\") {\r\n                    self.decorateRenders = [];\r\n                }\r\n                var instanceDecoratedClass = new this.decoratedClass({\r\n                    data: bizagi.clone(this.data),\r\n                    parent: this.parent,\r\n                    renderFactory: this.renderFactory,\r\n                    dataService: this.dataService\r\n                });\r\n                decorated = instanceDecoratedClass;\r\n                self.decorateRenders[surrogateKey] = instanceDecoratedClass;\r\n\r\n                // Set surrogate key to all controls\r\n                decorated.surrogateKey = surrogateKey;\r\n\r\n                // Execute decorated overrides\r\n                self.applyOverrides(decorated);\r\n\r\n                // Also override setDisplayValue on summary row for non numeric columns\r\n                if (surrogateKey == \"summary\" && decorated.properties.type != \"columnMoney\" && decorated.properties.type != \"columnNumber\") {\r\n\r\n                    decorated.setDisplayValue = function (value) {\r\n                        var control = this.getControl();\r\n\r\n                        // Replace line breaks for html line breaks\r\n                        control.html(value);\r\n                    };\r\n                }\r\n            }\r\n            return decorated;\r\n        }\r\n    },\r\n    /*\r\n    *   Set a ready function to execute when the render has been inserted in the dom\r\n    */\r\n    ready: function () {\r\n        return this.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Load stuff needed for the column\r\n    *   It could return a promise if the column need to load async stuff\r\n    */\r\n    initialize: function () {\r\n        // Override to do any stuff needed here\r\n    },\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function (surrogateKey, cellOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (cellOverrides) {\r\n            decorated.properties.visible = cellOverrides.visible;\r\n            decorated.properties.editable = cellOverrides.editable;\r\n        }\r\n        return decorated.canBeSent() || (!self.properties.editable && self.hasChanged()) || (!decorated.properties.editable && self.hasChanged());\r\n    },\r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function (surrogateKey, value, messages, propertyOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var invalidElements = [];\r\n\r\n        if (propertyOverrides.visible) {\r\n            self.setValue(surrogateKey, value);\r\n\r\n            // Override properties\r\n            decorated.properties = $.extend(decorated.properties, propertyOverrides);\r\n\r\n            if (self.grid && typeof(decorated.grid) === \"undefined\") {\r\n                decorated.grid = self.grid;\r\n            }\r\n\r\n            // Validate field\r\n            decorated.isValid(invalidElements);\r\n        }\r\n\r\n        if (invalidElements.length > 0) {\r\n            $.each(invalidElements, function (i, invalidElement) {\r\n                messages.push(invalidElement.message);\r\n            });\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        //Fix: Uncaught RangeError: Maximum call stack size exceeded\r\n        if (!properties.editable && arguments[3] !== \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\")\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.postRenderElement(cell);\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Changes editable to false to render read-only\r\n        decorated.properties.editable = false;\r\n\r\n        // Perform the internal render\r\n        self.readyDeferred = new $.Deferred();\r\n        var result = decorated.render(\"cell.readonly\");\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *  Returns the html template to draw the summary cell\r\n    */\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        var result = self.renderFactory.getTemplate(\"cell.summary\")\r\n        return $.tmpl(result).html();\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var editable = self.properties.editable;\r\n        decorated.properties.editable = false;\r\n        if (self.properties.singleInstance) {\r\n            decorated.element = cell;\r\n        }\r\n        decorated.postRenderElement(cell);\r\n        decorated.properties.editable = editable;\r\n    },\r\n\r\n    /*\r\n    * Return false to all columns that doesn't need special treatment (like number or currency)\r\n    */\r\n    postRenderSummary: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    getCell: function () {\r\n        return this.decorated.getDisplayValue();\r\n    },\r\n    /*\r\n    *   Sets the surrogate key for this row\r\n    */\r\n    setSurrogateKey: function (key) {\r\n        this.surrogateKey = key;\r\n    },\r\n    /*\r\n    *   Sets the internal value, only must be called internally\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n            if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    },\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        return decorated.getValue();\r\n    },\r\n    /*\r\n    *   Gets the composite value (applies for non-standard render values)\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        return this.getValue(surrogateKey);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_COLUMN;\r\n    },\r\n    /*\r\n    *   Determines if a render has changed its value\r\n    */\r\n    hasChanged: function () {\r\n        return this.changed;\r\n    },\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.trigger(eventType, data);\r\n    },\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.triggerHandler(eventType, data);\r\n    },\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.bind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Unbinds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.unbind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Override decorated properties\r\n    */\r\n    overrideDecoratedRenderProperties: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Override decorated control properties\r\n        decorated.properties.editable = this.properties.editable;\r\n        decorated.properties.visible = this.properties.visible;\r\n        decorated.properties.required = this.properties.required;\r\n    },\r\n\r\n    overrideProperties: function (properties) {\r\n        var self = this;\r\n\r\n        self.properties.editable = properties.editable || self.properties.editable;\r\n        self.properties.visible = properties.visible || self.properties.visible;\r\n        self.properties.required = properties.required || self.properties.required;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath used to sort the grid\r\n    */\r\n    getSortName: function () {\r\n        var self = this;\r\n\r\n        // Check if there is an override for the default behaviour \r\n        var decorated = self.getAnyDecoratedInstance();\r\n        if (decorated && decorated.getSortColumn) {\r\n            return decorated.getSortColumn();\r\n        }\r\n\r\n        // Default behaviour\r\n        return self.properties.xpath;\r\n    },\r\n\r\n    /*\r\n    *   Returns any of the decorated instances, if there are none, return null\r\n    */\r\n    getAnyDecoratedInstance: function () {\r\n        var self = this;\r\n        var first;\r\n\r\n        // Get the first key for the hash\r\n        for (first in this.decorateRenders) break;\r\n\r\n        // Return the first decorated render\r\n        if (first) return this.decorateRenders[first];\r\n\r\n        return null;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.decorated) {\r\n                self.decorated.unbind(\"renderchange\");\r\n                self.decorated.dispose();\r\n            }\r\n        \r\n            if (self.decorateRenders) {\r\n                bizagi.util.arrayEach(self.decorateRenders, function (key, render) {\r\n                    if (render) {\r\n                        render.unbind(\"renderchange\");\r\n                        render.dispose();\r\n                    }\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n        \r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Render Column ReadOnlyDecorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for readonly-columns\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.columns.readonly\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        // Define the column as readonly\r\n        properties.editable = required = false;\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        if (typeof value === \"string\") {\r\n            var valueToDisplay = value.replaceAll(\"\\\\n\", \"<br/>\");\r\n            valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n            return valueToDisplay;\r\n        }\r\n        else if (value === null){\r\n            return \"\";\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        return this.render(surrogateKey, value);\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n    \r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function () {\r\n        // It is always valid because the column is readonly\r\n        return true;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Document Generator\r\n*   Author: Mauricio Gonzalez\r\n*   Comments:\r\n*   -   This script will define basic stuff for document generator render\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.document\", {}, { \r\n});","/*\r\n*   Name: BizAgi Render Letter\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for letter render\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.letter\", {}, {\r\n    \r\n});","/*\r\n*   Name: BizAgi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.desktop.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        if (!decorated) return;\r\n        \r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n        }\r\n\r\n        /* Customizes the font weight */\r\n        decorated.getFormattingLabel = function (bold) {\r\n            var self = this;\r\n            return self.getControl();\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = this._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Just draw render if the cell layout has been filled\r\n        if (cell && cell.length > 0) {\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            if (!properties.editable) cellIcon.remove();\r\n\r\n            // Apply styles to cell\r\n            self.applyColumnStyles(cell);\r\n\r\n            if (properties.align == \"left\") {\r\n                cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.recalculate = bizagi.util.parseBoolean(properties.recalculate) || false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var properties = this.properties;\r\n\r\n        this._super(decorated);\r\n\r\n        if (!properties.recalculate) {\r\n            decorated.originalGetData = decorated.getData;\r\n            decorated.getData = this.getDataForAllCells;\r\n            decorated.findDataById = this.findDataById;\r\n        }\r\n    },\r\n\r\n    findDataById: function (id) {\r\n        var self = this;\r\n        var result = {};\r\n        if (this.column && this.column.comboData) {\r\n            $.each(this.column.comboData, function (key, value) {\r\n                if (value.id == id) {\r\n                    result = value;\r\n                }\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Single data fetch for all the cells\r\n    */\r\n    getDataForAllCells: function (params) {\r\n        var column = this.column;\r\n        if (column.comboData) return column.comboData;\r\n        if (column.fetchingData) return column.dataPromise;\r\n\r\n        // Start fetching\r\n        column.fetchingData = true;\r\n        column.dataPromise = $.when(this.originalGetData(params))\r\n        .pipe(function (result) {\r\n            column.comboData = result;\r\n            column.fetchingData = false;\r\n            return result;\r\n        });\r\n\r\n        return column.dataPromise;\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function(surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && bizagi.util.isString(value)) {        \r\n            self._super(surrogateKey, value);\r\n        } else if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function(item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (self.properties.type == \"columnRadio\") {\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = value;\r\n        } else if (value && typeof (value) == \"number\") {\r\n            self._super(surrogateKey, value);\r\n        } else {\r\n            // Set null values when the entry array is null\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        var label = decorated.getSelectedValue();\r\n\r\n        // Build value for grid data\r\n        var valueForGrid = [];\r\n        if (value && (value.id > 0 || bizagi.util.isString(value.id))) {\r\n            valueForGrid.push([]);\r\n            valueForGrid[0].push(value.id);\r\n            valueForGrid[0].push(label);\r\n        } else {\r\n            valueForGrid.push([]);\r\n        }\r\n\r\n        return valueForGrid;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value) return value.id;\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    renderReadOnly: function (key, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(key);\r\n        var properties = self.properties;\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + key + \"]\" : self.grid.properties.xpath + \"[id=\" + key + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(key, value);\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.search\", {}, {\r\n\r\n\t/*\r\n\t*   Constructor\r\n\t*/\r\n\tinit: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        if (properties.advancedSearch && this.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n\t/*\r\n\t*   Returns the in-memory processed element \r\n\t*   so the caller could append it to any place\r\n\t*/\r\n\trender: function (surrogateKey, value, tableCell) {\r\n\t\tvar self = this;\r\n\t\tvar decorated = self.getDecorated(surrogateKey);\r\n\t\tvar properties = self.properties;\r\n\r\n\t\t// If the control needs to recalculate data, reset it on the decorated render\r\n\t\tif (properties.recalculate) {\r\n\t\t\tdecorated.resetData();\r\n\t\t}\r\n\r\n\t\t// Change the xpath context\r\n\t\tvar xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n\t\t// Render the control\r\n\t\tvar result = this._super(surrogateKey, value, tableCell);\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n    \tvar decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value && typeof(value) == \"object\" ) return value.id;\r\n        \t\r\n    \treturn value;\r\n    },\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) { return; }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function (item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if(value && value.id && value.label){\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.label;\r\n        }\r\n        else{\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Date Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Date Columns\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) return;\r\n\r\n        self._super(surrogateKey, value);\r\n        if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined) {\r\n            value = self.setDefaultValue(surrogateKey, decorated);\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey === \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value == null) {\r\n            decorated.setValue(value, false);\r\n            decorated.properties.displayValue = \"\";\r\n        }\r\n\r\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime);\r\n\r\n        if (date === 0) {\r\n            // force another attempt in order to check invariant format for the value with time or without time (reverse option)\r\n            date = bizagi.util.dateFormatter.getDateFromInvariant(value, !decorated.properties.showTime);\r\n        }\r\n        // Format date to current format\r\n        if (date !== 0) {\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            var formattedDate = bizagi.util.dateFormatter.formatDate(date, decorated.properties.fullFormat, datePickerRegional);\r\n\r\n            // Set formatted value in display value property\r\n            decorated.properties.displayValue = formattedDate;\r\n\r\n            // Send original value to decorated control, because it must be with invariant format\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n\r\n        value = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime || false);\r\n\r\n        value = bizagi.util.dateFormatter.formatInvariant(value, true);\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Form Dialog Implementation\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will shows a form inside a popup dialog in order to edit\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.form\", {\r\n    POPUP_WIDTH: 768,\r\n    POPUP_HEIGHT: 550\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, dialogParams) {\r\n        var self = this;\r\n        var doc = window.document;\r\n\r\n        //Attach the desired extra buttons, everyone need to have the localization id, so the label could match\r\n        self.buttons = {};\r\n\r\n        for (var item in dialogParams.extraButtons) {\r\n            self.buttons[bizagi.localization.getResource(item)] = dialogParams.extraButtons[item];\r\n        }\r\n\r\n        // Define instance variables\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.dialogDeferred = new $.Deferred();\r\n        dialogParams = self.dialogParams = dialogParams || {};\r\n\r\n        // Draw dialog box\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        self.dialogBox.empty();\r\n        self.dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Create dialog box\r\n        self.showDialogBox(self.dialogBox, dialogParams)\r\n            .done(function (data) {\r\n                self.dialogDeferred.resolve(data);\r\n            })\r\n            .fail(function () {\r\n                self.dialogDeferred.reject({idPageCache: self.form.getPageCache()});\r\n            });\r\n    },\r\n    /*\r\n    *   Render the form\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill dialog box\r\n        self.renderDialogBox(self.dialogBox, params);\r\n\r\n        // Return promise\r\n        return self.dialogDeferred.promise();\r\n    },\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox, dialogParams, reverseButtons) {\r\n        var self = this;\r\n        var reverseButtons = self.dialogParams.orientation == \"rtl\" ? true : false;\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n        var defer = new $.Deferred();\r\n\r\n        // Define options\r\n        var showSaveButton = bizagi.util.parseBoolean(dialogParams.showSaveButton) !== null ? bizagi.util.parseBoolean(dialogParams.showSaveButton) : true;\r\n        var showCancelButton = bizagi.util.parseBoolean(dialogParams.showCancelButton) !== null ? bizagi.util.parseBoolean(dialogParams.showCancelButton) : true;\r\n        var saveButtonLabel = dialogParams.saveButtonLabel ? dialogParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\r\n        var cancelButtonLabel = dialogParams.cancelButtonLabel ? dialogParams.cancelButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n        var maximized = bizagi.util.parseBoolean(dialogParams.maximized) !== null ? bizagi.util.parseBoolean(dialogParams.maximized) : false;\r\n\r\n        var performActions = function(event) {\r\n            // Perform validations\r\n            if (self.form.validateForm()) {\r\n\r\n                // Collect data\r\n                var data = {};\r\n\r\n                if (dialogParams.forceCollectData) {\r\n                    // Turn on flag to force to collect all data on the form\r\n                    $.forceCollectData = true;\r\n                    self.form.collectRenderValues(data);\r\n                    // Turn off flag\r\n                    $.forceCollectData = false;\r\n                } else {\r\n                    self.form.collectRenderValues(data);\r\n                }\r\n\r\n                if (dialogParams.allowGetOriginalFormValues) {\r\n                    data.formValues = self.form.children;\r\n                }\r\n\r\n                // Add page cache for this form\r\n                data.idPageCache = self.form.getPageCache();\r\n\r\n                // Call user callback\r\n                if (dialogParams.onSave && !$(event.currentTarget).prop(\"disabled\")) {\r\n                    $(event.currentTarget).prop(\"disabled\", true);\r\n                    $(event.currentTarget).button(\"disable\"); //Setting styles\r\n                    $.when(dialogParams.onSave(data))\r\n                        .done(function (result) {\r\n                            $(event.currentTarget).prop(\"disabled\", false);\r\n                            $(event.currentTarget).button(\"enable\"); //Setting styles\r\n                            if (result == null || result == true || result.type == \"success\") {\r\n                                defer.resolve();\r\n                                self.closeDialogBox();\r\n                            } else if ([\"validationMessages\", \"alertMessages\"].includes(result.type)) {\r\n                                // Add validation messages\r\n                                if (result.type === \"validationMessages\") {\r\n                                    self.form.addValidationMessage(result.messages);\r\n                                } else {\r\n                                    bizagi.modalError.show(result.messages, 'workportal-general-word-information', false);\r\n                                }\r\n\r\n                                // Update original value to use as reference to other futures changes in the dialogBox\r\n                                $.each(data, function (key, value) {\r\n                                    var renders = self.form.getRenders(key);\r\n                                    $.each(renders, function (i, render) {\r\n                                        render.updateOriginalValue();\r\n                                    });\r\n                                });\r\n                            } else if (result.type === \"error\") {\r\n                                // Add error messages \r\n                                self.form.addErrorMessage(result.message);\r\n                            }\r\n                        }).fail(function () {\r\n                            $(event.currentTarget).prop(\"disabled\", false);\r\n                            $(event.currentTarget).button(\"enable\"); //Setting styles\r\n                    });                                \r\n                } else {\r\n                    defer.resolve();\r\n                    self.closeDialogBox();\r\n                }\r\n            }\r\n        };\r\n\r\n        if (showSaveButton) {\r\n            buttons[saveButtonLabel] = function (event) {\r\n                if (self.form) {\r\n                    // load tabs\r\n                    var form = self.form,\r\n                        asyncTabsDef = $.Deferred(),\r\n                        getAllTabs = form.getRenderByType(\"tabItem\"),\r\n                        getAllTabsLength = getAllTabs.length;\r\n\r\n                    form.innerTabsLoading = true;\r\n\r\n                    $(event.currentTarget).prop(\"disabled\", true);\r\n                    form.useOrSetLoaderDeferred();\r\n\r\n                    // Check\r\n                    for (var i = 0; i < getAllTabsLength; i++) {\r\n                        var render = getAllTabs[i];\r\n                        // Resolve internal deferred\r\n                        if (render.loadingDeferred && render.parent.container) {\r\n                            render.loadingDeferred.resolve();\r\n                        }\r\n                    }\r\n\r\n                    delete form.innerTabsLoading;\r\n                    // Resolve task deferred\r\n                    asyncTabsDef.resolve({event: event});\r\n\r\n                    $.when(asyncTabsDef.promise(), form.getLoaderPromise()).done(function (response) {\r\n                        var event = response.event;\r\n\r\n                        $(event.currentTarget).prop(\"disabled\", false);\r\n                        form.deleteLoaderDeferred();\r\n\r\n                        performActions(event);\r\n                    }).fail(function() {\r\n                        $(event.currentTarget).prop(\"disabled\", false);\r\n                        form.deleteLoaderDeferred();\r\n\r\n                        performActions(event);\r\n                    });\r\n                }\r\n            };\r\n        }\r\n        if (showCancelButton) {\r\n            buttons[cancelButtonLabel] = function () {\r\n                dialogParams.onCancel && dialogParams.onCancel();\r\n                defer.reject();\r\n                self.closeDialogBox();\r\n            };\r\n        }\r\n\r\n        //Attach the desired extra buttons \r\n        self.buttons = $.extend(buttons, self.buttons);\r\n\r\n        //Orientation RTL - OrderBut\r\n        if (self.dialogParams.orientation == \"rtl\") {\r\n            var objButtons;\r\n            var nameButon;\r\n            for (var prop in buttons) {\r\n                objButtons = buttons[prop];\r\n                nameButon = prop;\r\n                break;\r\n            }\r\n\r\n            delete buttons[nameButon];\r\n            buttons[nameButon] = objButtons;\r\n\r\n        }\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: this.Class.POPUP_WIDTH,\r\n            height: this.Class.POPUP_HEIGHT,\r\n            title: dialogParams.title,\r\n            modal: true,\r\n            buttons: self.buttons,\r\n            resizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n            maximized: maximized,\r\n            open: function (event, ui) {\r\n                if (maximized && typeof isWebpart == \"undefined\") {\r\n                    // remove scroll bar\r\n                    $(\"body\", window.document).css(\"position\", \"fixed\");\r\n                }\r\n            },\r\n            close: function () {\r\n                // set scroll bar\r\n                $(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n                defer.reject();\r\n                self.closeDialogBox();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            },\r\n            maximize: function (e) {\r\n                if (self.form) {\r\n                    self.form.triggerHandler(\"maximazedForm\");\r\n                    self.dialogBox.trigger(\"resize\");\r\n                }\r\n            },\r\n            unmaximize: function (e) {\r\n                if (self.form) {\r\n                    self.form.triggerHandler(\"unmaximazedForm\");\r\n                    self.dialogBox.trigger(\"resize\");\r\n                }\r\n            }\r\n        });\r\n\r\n        self.adjustOverlay();\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n    _appresize: function (args) {\r\n        var self = this;\r\n        $(self.dialogBox).dialog('widget').css({\r\n            left: ((window.screen.width / 2) - (self.Class.POPUP_WIDTH / 2)) + \"px\",\r\n            top: ((window.screen.height / 2) - (self.Class.POPUP_HEIGHT / 2)) + \"px\",\r\n            width: self.Class.POPUP_WIDTH + \"px\",\r\n            height: self.Class.POPUP_HEIGHT + \"px\"\r\n        }).show();\r\n\r\n    },\r\n    /*\r\n    *   Closes the dialog box\r\n    */\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        var dialogBox = self.dialogBox;\r\n\r\n        // set scroll bar\r\n        $(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n        dialogBox.dialog('destroy');\r\n        dialogBox.remove();\r\n        // Send the form to the hell, please dont remove this line, make a several bugs!!\r\n        self.dispose();\r\n    },\r\n    /**\r\n     * Sets the focus to the first control\r\n     */\r\n    focusFirstControl: function (form, time) {\r\n        var self = this;\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container).not(\".ui-bizagi-render-date,.ui-bizagi-render-search\");\r\n            if (defaultControl.length > 0) {\r\n                // fix for retype double\r\n                var controlHtml = $(defaultControl[0]).closest(\".ui-bizagi-render\");\r\n                var xpath = controlHtml.length > 0 ? controlHtml.data(\"render-xpath\") : \"\";\r\n                var control = xpath ? form.getRender(xpath) : \"\";\r\n                if (control) {\r\n                    if (control.properties && control.properties.retype && control.properties.retype === \"double\") {\r\n                        return;\r\n                    }\r\n                }\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                if (self.isValidControlForFocus(innerControl, form)) {\r\n                    try {\r\n                        innerControl.focus();\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            } else {\r\n                var innerControl = $(\".ui-bizagi-render\", form.container)[0];\r\n                $(innerControl).attr(\"tabindex\", 0);\r\n\r\n                innerControl.focus();\r\n\r\n                $(innerControl).removeAttr(\"tabindex\");\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n\r\n    isValidControlForFocus: function (control, form) {\r\n        var result = true;\r\n        var container = $(control).closest('[data-render-id]');\r\n        var id = container.data('render-id');\r\n        var isOnGrid = id && container.length ? (container.data('bizagi-component') == 'cellContent') : false;\r\n\r\n        if (id && isOnGrid) {\r\n            var grid = form.getGridByColumn(id);\r\n            var type = grid ? grid.getColumnType(id) : null;\r\n            if (type && type == 'columnCombo') {\r\n                result = false;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Renders the dialog box content\r\n    */\r\n    renderDialogBox: function (dialogBox, params) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Clear dialog box\r\n        dialogBox.empty();\r\n\r\n        // Check context\r\n        try {\r\n            if (self.form && self.form.params.data.contextType) {\r\n                params.contextType = self.form.params.data.contextType;\r\n            }\r\n        } catch (e) { }\r\n        if (params.rewriteContextType === true) {\r\n            //self.properties.contextType\r\n        }\r\n\r\n        // Load template and data\r\n        return $.when(self.dataService.getFormData(params)).pipe(function (data) {\r\n            // Apply recordXpath\r\n            if (params.recordXPath) {\r\n                data.form.properties.recordXpath = params.recordXPath;\r\n            }\r\n\r\n            // Apply contextType\r\n            data.form.contextType = params.contextType;\r\n            if (params.rewriteContextType) {\r\n                data.form.contextType = undefined;\r\n            }\r\n\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n\r\n                // The actions don't apply in dialog form\r\n                self.removeActions(data.form);\r\n            }\r\n\r\n            // Apply required param\r\n            if (params.required === false) {\r\n                data.form.properties.required = false;\r\n            }\r\n\r\n            // The transitions don't apply in dialog form\r\n            self.removeTransitions(data.form);\r\n\r\n            // Render dialog template\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                canvas: self.dialogBox,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: params.isRefresh || false,\r\n                requestedForm: params.requestedForm\r\n            });\r\n\r\n            def.resolve(self.form);\r\n\r\n            // Return rendering promise\r\n            return self.form.render();\r\n        }, function (message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            if (typeof message == \"object\" && message.responseText) {\r\n                var objMessage = JSON.parse(message.responseText);\r\n                message = \"Error:\" + objMessage.errorType + \"<br>\" + objMessage.message || \" Error in form \";\r\n            }\r\n\r\n            // Clear dialog box\r\n            $(\"*\", dialogBox).remove();\r\n\r\n            $.tmpl(errorTemplate, {\r\n                message: message\r\n            }).appendTo(dialogBox);\r\n        }).done(function (element) {\r\n            // Remove button container\r\n            $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n            // Append form  in the dialog\r\n            $('.ui-bizagi-loading-message', dialogBox).remove();\r\n            dialogBox.data(\"loading\", false);\r\n            dialogBox.removeClass(\"ui-bizagi-component-loading\");\r\n            dialogBox.html(element);\r\n\r\n            // Customize dialog box\r\n            dialogBox = self.customizeDialogBox(dialogBox);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\", params.mainForm);\r\n\r\n            if (bizagi.override.adjustButtonPositionDialogForm)\r\n                self.adjustButtonPosition(dialogBox);\r\n\r\n            // Scroll to element if has scroll top set\r\n            if (params.scrollTop) {\r\n                // Restore scroll at same position\r\n                self.form.container.parent().scrollTop(params.scrollTop);\r\n            } else {\r\n                // Focus into first control\r\n                self.focusFirstControl(self.form, 150);\r\n            }\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                // Check current scroll in parent\r\n                refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                refreshParams = $.extend({\r\n                    focus: focus,\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true,\r\n                    mainForm: params.mainForm\r\n                }, refreshParams);\r\n\r\n                return self.renderDialogBox(dialogBox, refreshParams);\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    adjustButtonPosition: function (dialogBox) {\r\n        var childrenContainer = dialogBox.find(\".ui-bizagi-container:first\")[0];\r\n        var titleHeight = 29;\r\n        var buttonHeight = 58;\r\n        var availableHeight = dialogBox.parent().height() - titleHeight - buttonHeight;\r\n\r\n        new ResizeSensor(childrenContainer, function () {\r\n            availableHeight = dialogBox.parent().height() - titleHeight - buttonHeight;\r\n            fitSizes();\r\n        });\r\n\r\n        var fitSizes = function () {\r\n            if (childrenContainer.clientHeight > availableHeight) {\r\n                dialogBox.height(availableHeight - 20);\r\n                $(\".ui-dialog-buttonpane\", dialogBox.parent()).css(\"top\", titleHeight + availableHeight);\r\n            } else {\r\n                dialogBox.height(childrenContainer.clientHeight + 20);\r\n                $(\".ui-dialog-buttonpane\", dialogBox.parent()).css(\"top\", titleHeight + dialogBox.height());\r\n            }\r\n        }\r\n\r\n        fitSizes();\r\n    },\r\n\r\n    /*\r\n    *   This method can be overriden in order to customize the dialog form rendering\r\n    */\r\n    customizeDialogBox: function (dialogBox) {\r\n        return dialogBox;\r\n    },\r\n\r\n    /*\r\n    * This method removes the transitions\r\n    */\r\n    removeTransitions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.transitions) {\r\n            delete data.transitions;\r\n        }\r\n    },\r\n\r\n    /*\r\n    * This method removes the actions\r\n    */\r\n    removeActions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.actions) {\r\n            delete data.actions;\r\n        }\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) self.form.dispose();\r\n        bizagi.util.dispose(self.buttons);\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    adjustOverlay: function () {\r\n        var overlay = $(\".ui-widget-overlay.ui-front\");\r\n        var body = $(\"body\");\r\n        var canvas = $(\"#render-canvas\");\r\n        var overlayHeight = parseInt(overlay.height());\r\n        var overlayBody = parseInt(body.height());\r\n        var overlayCanvas = parseInt(canvas.height());\r\n\r\n        if (overlayHeight < overlayBody) {\r\n            overlay.height(overlayBody);\r\n            overlayHeight = overlayBody;\r\n        }\r\n        if (overlayHeight < overlayCanvas) {\r\n            overlay.height(overlayCanvas);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n * Show a startform within a dialog box\r\n * Based on dialog.form developed by Diego Parra\r\n *\r\n * @author Edward Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.dialog.startForm\", {\r\n\tPOPUP_WIDTH: 900,\r\n\tPOPUP_HEIGHT: 650\r\n}, {\r\n\r\n\t/**\r\n\t * Constructor\r\n\t * @param dataService\r\n\t * @param renderFactory\r\n\t * @param dialogParams\r\n\t */\r\n\tinit: function(dataService, renderFactory, dialogParams) {\r\n\t\tvar self = this;\r\n\t\tvar doc = window.document;\r\n\r\n\t\t// Object whit reference and actions of buttons\r\n\t\tself.buttons = {};\r\n\r\n\t\tfor(var item in dialogParams.extraButtons) {\r\n\t\t\tself.buttons[bizagi.localization.getResource(item)] = dialogParams.extraButtons[item];\r\n\t\t}\r\n\r\n\t\t// Define instance variables\r\n\t\tthis.dataService = dataService;\r\n\t\tthis.renderFactory = renderFactory;\r\n\t\tthis.dialogDeferred = new $.Deferred();\r\n\t\tdialogParams = self.dialogParams = dialogParams || {};\r\n\r\n\t\t// Draw dialog box\r\n\t\tself.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n\t\tself.dialogBox.empty();\r\n\t\tself.dialogBox.appendTo(\"body\", doc);\r\n\r\n\t\t// Create dialog box\r\n\t\tself.showDialogBox(self.dialogBox, dialogParams)\r\n\t\t\t.done(function(data) {\r\n\t\t\t\tself.dialogDeferred.resolve(data);\r\n\t\t\t})\r\n\t\t\t.fail(function() {\r\n\t\t\t\tself.dialogDeferred.reject();\r\n\t\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t *   Render the form\r\n\t *   The params are the same that will be send to the ajax service\r\n\t *   Returns a deferred\r\n\t */\r\n\trender: function(params) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Fill dialog box\r\n\t\tself.renderDialogBox(self.dialogBox, params);\r\n\r\n\t\t// Return promise\r\n\t\treturn self.dialogDeferred.promise();\r\n\t},\r\n\t/*\r\n\t *   Shows the dialog box in the browser\r\n\t *   Returns a promise that the dialog will be closed\r\n\t */\r\n\tshowDialogBox: function(dialogBox, dialogParams) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Define buttons\r\n\t\tvar buttons = {};\r\n\t\tvar defer = new $.Deferred();\r\n\r\n\t\t// Define options\r\n\t\tvar showSaveButton = bizagi.util.parseBoolean(dialogParams.showSaveButton) !== null ? bizagi.util.parseBoolean(dialogParams.showSaveButton) : true;\r\n\t\tvar showCancelButton = bizagi.util.parseBoolean(dialogParams.showCancelButton) !== null ? bizagi.util.parseBoolean(dialogParams.showCancelButton) : true;\r\n\t\tvar saveButtonLabel = dialogParams.saveButtonLabel ? dialogParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\r\n\t\tvar cancelButtonLabel = dialogParams.cancelButtonLabel ? dialogParams.cancelButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n\t\tvar maximized = bizagi.util.parseBoolean(dialogParams.maximized) !== null ? bizagi.util.parseBoolean(dialogParams.maximized) : false;\r\n\r\n\t\tif(showSaveButton) {\r\n\t\t\tbuttons[saveButtonLabel] = function() {\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\t// Perform validations\r\n\t\t\t\t\tif(self.form.validateForm()) {\r\n\r\n\t\t\t\t\t\t// Collect data\r\n\t\t\t\t\t\tvar data = {};\r\n\r\n\t\t\t\t\t\tif(dialogParams.forceCollectData) {\r\n\t\t\t\t\t\t\t// Turn on flag to force to collect all data on the form\r\n\t\t\t\t\t\t\t$.forceCollectData = true;\r\n\t\t\t\t\t\t\tself.form.collectRenderValues(data);\r\n\t\t\t\t\t\t\t// Turn off flag\r\n\t\t\t\t\t\t\t$.forceCollectData = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tself.form.collectRenderValues(data);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(dialogParams.allowGetOriginalFormValues) {\r\n\r\n\t\t\t\t\t\t\tdata.formValues = self.form.children;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Add page cache for this form\r\n\t\t\t\t\t\tdata.idPageCache = self.form.getPageCache();\r\n\r\n\t\t\t\t\t\t// Call user callback\r\n\t\t\t\t\t\tif(dialogParams.onSave) {\r\n\t\t\t\t\t\t\t$.when(dialogParams.onSave(data))\r\n\t\t\t\t\t\t\t\t.done(function(result) {\r\n\t\t\t\t\t\t\t\t\tif(result == null || result == true || result.type == \"success\") {\r\n\t\t\t\t\t\t\t\t\t\tdefer.resolve();\r\n\t\t\t\t\t\t\t\t\t\tself.closeDialogBox();\r\n\t\t\t\t\t\t\t\t\t} else if ([\"validationMessages\", \"alertMessages\"].includes(result.type)) {\r\n\t\t\t\t\t\t\t\t\t\t// Add validation messages\r\n\t\t\t\t\t\t\t\t\t\tif (result.type === \"validationMessages\") {\r\n\t\t\t\t\t\t\t\t\t\t\tself.form.addValidationMessage(result.messages);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tbizagi.modalError.show(result.messages, 'workportal-general-word-information', false);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Update original value to use as reference to other futures changes in the dialogBox\r\n\t\t\t\t\t\t\t\t\t\t$.each(data, function(key) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar renders = self.form.getRenders(key);\r\n\t\t\t\t\t\t\t\t\t\t\t$.each(renders, function(i, render) {\r\n\t\t\t\t\t\t\t\t\t\t\t\trender.updateOriginalValue();\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t} else if(result.type === \"error\") {\r\n\t\t\t\t\t\t\t\t\t\t// Add error messages\r\n\t\t\t\t\t\t\t\t\t\tself.form.addErrorMessage(result.message);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdefer.resolve();\r\n\t\t\t\t\t\t\tself.closeDialogBox();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tif(showCancelButton) {\r\n\t\t\tbuttons[cancelButtonLabel] = function() {\r\n\t\t\t\tdialogParams.onCancel && dialogParams.onCancel();\r\n\t\t\t\tself.closeDialogBox();\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t//Attach the desired extra buttons\r\n\t\tself.buttons = $.extend(buttons, self.buttons);\r\n\r\n\t\t// Creates a dialog\r\n\t\tdialogBox.dialog({\r\n\t\t\twidth: this.Class.POPUP_WIDTH,\r\n\t\t\theight: this.Class.POPUP_HEIGHT,\r\n\t\t\ttitle: dialogParams.title,\r\n\t\t\tmodal: true,\r\n\t\t\tbuttons: self.buttons,\r\n\t\t\tresizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n\t\t\tmaximized: maximized,\r\n\t\t\topen: function() {\r\n\t\t\t\tif(maximized) {\r\n\t\t\t\t\t// remove scroll bar\r\n\t\t\t\t\t$(\"body\", window.document).css(\"position\", \"fixed\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\t// set scroll bar\r\n\t\t\t\t$(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n\t\t\t\tdefer.reject();\r\n\t\t\t\tself.closeDialogBox();\r\n\t\t\t},\r\n\t\t\tresizeStop: function(event, ui) {\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.resize(ui.size);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmaximize: function(e){\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.triggerHandler(\"maximazedForm\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tunmaximize: function(e){\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.triggerHandler(\"unmaximazedForm\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tself.adjustOverlay();\r\n\r\n\t\t// Return promise\r\n\t\treturn defer.promise();\r\n\t},\r\n\t_appresize: function() {\r\n\t\tvar self = this;\r\n\t\t$(self.dialogBox).dialog('widget').css({\r\n\t\t\tleft: ((window.screen.width / 2) - (self.Class.POPUP_WIDTH / 2)) + \"px\",\r\n\t\t\ttop: ((window.screen.height / 2) - (self.Class.POPUP_HEIGHT / 2)) + \"px\",\r\n\t\t\twidth: self.Class.POPUP_WIDTH + \"px\",\r\n\t\t\theight: self.Class.POPUP_HEIGHT + \"px\"\r\n\t\t}).show();\r\n\r\n\t},\r\n\t/*\r\n\t *   Closes the dialog box\r\n\t */\r\n\tcloseDialogBox: function() {\r\n\t\tvar self = this;\r\n\t\tvar dialogBox = self.dialogBox;\r\n\t\t// set scroll bar\r\n\t\t$(\"body\", window.document).css(\"position\", \"static\");\r\n\t\tdialogBox.dialog('destroy');\r\n\t\tdialogBox.remove();\r\n\t\tself.dispose();\r\n\t},\r\n\r\n\t/*\r\n\t * Renders the dialog box content\r\n\t */\r\n\trenderDialogBox: function(dialogBox, params) {\r\n\t\tvar self = this;\r\n\t\tvar def = new $.Deferred();\r\n\r\n\t\t// Clear dialog box\r\n\t\tdialogBox.empty();\r\n\r\n\t\t// Check context\r\n\t\ttry {\r\n\t\t\tif(self.form && self.form.params.data.contextType) {\r\n\t\t\t\tparams.contextType = self.form.params.data.contextType;\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t}\r\n\r\n\t\t// Load template and data\r\n\t\treturn $.when(self.dataService.getStartForm(params)).pipe(function(data) {\r\n\r\n\t\t\t// Apply contextType\r\n\t\t\tdata.form.contextType = params.contextType;\r\n\r\n\t\t\t// Apply editable param\r\n\t\t\tif(params.editable == false) {\r\n\t\t\t\tdata.form.properties.editable = false;\r\n\r\n\t\t\t\t// The actions don't apply in dialog form\r\n\t\t\t\tself.removeActions(data.form);\r\n\t\t\t}\r\n\r\n\t\t\t// The transitions don't apply in dialog form\r\n\t\t\tself.removeTransitions(data.form);\r\n\r\n\t\t\t// Render dialog template\r\n\t\t\tself.form = self.renderFactory.getContainer({\r\n\t\t\t\ttype: \"form\",\r\n\t\t\t\tdata: data.form,\r\n\t\t\t\tfocus: params.focus || false,\r\n\t\t\t\tselectedTabs: params.selectedTabs,\r\n\t\t\t\tisRefresh: params.isRefresh || false\r\n\t\t\t});\r\n\r\n\t\t\tdef.resolve(self.form);\r\n\r\n\t\t\t// Return rendering promise\r\n\t\t\treturn self.form.render();\r\n\t\t}, function(message) {\r\n\t\t\t/*** FAIL FILTER **/\r\n\t\t\tvar errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n\t\t\tif(typeof message == \"object\" && message.responseText) {\r\n\t\t\t\tvar objMessage = JSON.parse(message.responseText);\r\n\t\t\t\tmessage = \"Error:\" + objMessage.errorType + \"<br>\" + objMessage.message || \" Error in form \";\r\n\t\t\t}\r\n\r\n\t\t\t// Clear dialog box\r\n\t\t\t$(\"*\", dialogBox).remove();\r\n\r\n\t\t\t$.tmpl(errorTemplate, {\r\n\t\t\t\tmessage: message\r\n\t\t\t}).appendTo(dialogBox);\r\n\t\t}).done(function(element) {\r\n\t\t\t// Remove button container\r\n\t\t\t$(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t// Append form  in the dialog\r\n\t\t\t$('.ui-bizagi-loading-message', dialogBox).remove();\r\n\t\t\tdialogBox.data(\"loading\", false);\r\n\t\t\tdialogBox.removeClass(\"ui-bizagi-component-loading\");\r\n\t\t\tdialogBox.html(element);\r\n\r\n\t\t\t// Customize dialog box\r\n\t\t\tdialogBox = self.customizeDialogBox(dialogBox);\r\n\r\n\t\t\t// Publish an event to check if the form has been set in the DOM\r\n\t\t\tself.form.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif(self.dialogParams.maximized) {\r\n\t\t\t\t\tvar instance = self.dialogBox.data(\"ui-dialog\");\r\n\t\t\t\t\tinstance.recalculate && instance.recalculate();\r\n\t\t\t\t}\r\n\t\t\t}, 650);\r\n\r\n\r\n\t\t\t// Attach a refresh handler to recreate all the form\r\n\t\t\tself.form.bind(\"refresh\", function(_, refreshParams) {\r\n\t\t\t\t// Check current scroll in parent\r\n\t\t\t\trefreshParams = $.extend({\r\n\t\t\t\t\tfocus: focus,\r\n\t\t\t\t\tselectedTabs: self.form.getSelectedTabs(),\r\n\t\t\t\t\tisRefresh: true\r\n\t\t\t\t}, params, refreshParams);\r\n\r\n\t\t\t\treturn self.renderDialogBox(dialogBox, refreshParams);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\t/*\r\n\t *   This method can be overriden in order to customize the dialog form rendering\r\n\t */\r\n\tcustomizeDialogBox: function(dialogBox) {\r\n\t\treturn dialogBox;\r\n\t},\r\n\r\n\t/*\r\n\t * This method removes the transitions\r\n\t */\r\n\tremoveTransitions: function(data) {\r\n\t\tdata = data || {};\r\n\r\n\t\tif(data.transitions) {\r\n\t\t\tdelete data.transitions;\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * This method removes the actions\r\n\t */\r\n\tremoveActions: function(data) {\r\n\t\tdata = data || {};\r\n\r\n\t\tif(data.actions) {\r\n\t\t\tdelete data.actions;\r\n\t\t}\r\n\t},\r\n\r\n\tdispose: function() {\r\n\t\tvar self = this;\r\n\t\tif(self.form) {\r\n\t\t\tself.form.dispose();\r\n\t\t}\r\n\t\tbizagi.util.dispose(self.buttons);\r\n\t\tbizagi.util.dispose(self);\r\n\t},\r\n\r\n\tadjustOverlay: function() {\r\n\t\tvar overlay = $(\".ui-widget-overlay\");\r\n\t\tvar body = $(\"body\");\r\n\t\tvar overlayHeight = parseInt(overlay.height()), overlayBody = parseInt(body.height());\r\n\r\n\t\tif(overlayHeight < overlayBody) {\r\n\t\t\toverlay.height(overlayBody);\r\n\t\t}\r\n\t}\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Search Dialog Implementation\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will shows a search form inside a popup dialog in order to edit\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.search\", {\r\n    POPUP_WIDTH: 800,\r\n    POPUP_HEIGHT: 600\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, otherOptions) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        otherOptions = otherOptions || {};\r\n\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.searchForms = searchForms;\r\n        this.searchParams = searchParams;\r\n        this.dialogDeferred = new $.Deferred();\r\n        this.extraButtons = (otherOptions.hasOwnProperty(\"buttons\")) ? otherOptions.buttons : false;\r\n\r\n        // Draw dialog box\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        self.dialogBox.empty();\r\n        self.dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Create dialog box\r\n        self.showDialogBox(self.dialogBox)\r\n\t\t\t\t.done(function (data) {\r\n\t\t\t\t    self.dialogDeferred.resolve(data);\r\n                    self.form.unbindAutoSaveForm();\r\n\t\t\t\t})\r\n\t\t\t\t.fail(function () {\r\n\t\t\t\t    self.dialogDeferred.reject();\r\n                    self.form.unbindAutoSaveForm();\r\n\t\t\t\t});\r\n    },\r\n    /*\r\n    *   Render the form\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Render search dialog\r\n        self.renderSearchDialog(params);\r\n\r\n        // Return promise\r\n        return self.dialogDeferred.promise();\r\n    },\r\n    renderSearchDialog: function (params) {\r\n        var self = this;\r\n        self.form = null;\r\n        // Creates a dialog\r\n        $.when(self.getSearchContainerData(params))\r\n\t\t\t\t.pipe(function (data) {\r\n\r\n\t\t\t\t    // Render dialog form\r\n\t\t\t\t    if (typeof (data.form.properties) != \"undefined\")\r\n\t\t\t\t        data.form.properties.orientation = params.orientation || \"ltr\";\r\n\r\n\t\t\t\t    var _form = self.renderFactory.getContainer({\r\n\t\t\t\t        type: \"form\",\r\n                        data: data.form,\r\n                        canvas: self.dialogBox\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    if (params.contexttype) {\r\n\t\t\t\t        _form.properties.contexttype = params.contexttype;\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t    // Save form reference\r\n\t\t\t\t    self.form = _form;\r\n\r\n\t\t\t\t    // Return rendering promise\r\n\t\t\t\t    return self.form.render();\r\n\t\t\t\t})\r\n\t\t\t\t.done(function (element) {\r\n\t\t\t\t    // Remove button container\r\n\t\t\t\t    $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t\t    // Append form  in the dialog\r\n\t\t\t\t    $('.ui-bizagi-loading-message', self.dialogBox).remove();\r\n\t\t\t\t    element.appendTo(self.dialogBox);\r\n\r\n\t\t\t\t    // Publish an event to check if the form has been set in the DOM\r\n\t\t\t\t    self.form.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\t\t    // Check if there is a tab container (when there are more than one search form)\r\n\t\t\t\t    var tabContainer = self.form.firstChild().properties.type == \"tab\" ? self.form.firstChild() : null;\r\n\t\t\t\t    if (tabContainer) {\r\n\r\n\t\t\t\t        // Bind select tab event\r\n\t\t\t\t        tabContainer.bind(\"selected\", function (e, ui) {\r\n\t\t\t\t            var searchForm = self.searchForms[ui.index];\r\n\r\n\t\t\t\t            $.when(self.loadSearchTab(params, ui.tab, searchForm))\r\n\t\t\t\t\t\t\t.done(function () {\r\n\t\t\t\t\t\t\t    // Set currents search form\r\n\t\t\t\t\t\t\t    self.currentSearchForm = ui.tab.firstChild();\r\n\t\t\t\t\t\t\t    self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t        });\r\n\r\n\t\t\t\t        // Select first tab\r\n\t\t\t\t        tabContainer.container.tabs(\"option\", \"active\", 0);\r\n\t\t\t\t        self.currentSearchForm = tabContainer.firstChild().firstChild();\r\n\t\t\t\t        self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\t\t    } else {\r\n\r\n\t\t\t\t        // Set currents search form\r\n\t\t\t\t        self.currentSearchForm = self.form.firstChild();\r\n\t\t\t\t        self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t    // Focus into first control\r\n\t\t\t\t    self.focusFirstControl(self.currentSearchForm, 100);\r\n\r\n\t\t\t\t    // Add row selected handlers to resolve the deferred\r\n\t\t\t\t    self.currentSearchForm.bind(\"instanceSelected\", function (ev, ui) {\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t        self.dialogBoxDeferred.resolve({\r\n\t\t\t\t            id: ui.id,\r\n\t\t\t\t            label: ''\r\n\t\t\t\t        });\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    // Event handler to searchList control\r\n\t\t\t\t    self.currentSearchForm.bind(\"multiSelect\", function (ev, ui) {\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t        self.dialogBoxDeferred.resolve({\r\n\t\t\t\t            id: ui.id,\r\n\t\t\t\t            label: ui.data\r\n\t\t\t\t        });\r\n\t\t\t\t    });\r\n\t\t\t\t});\r\n    },\r\n    /**\r\n    * Sets the focus to the first control\r\n    */\r\n    focusFirstControl: function (form, time) {\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container);\r\n            if (defaultControl.length > 0) {\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                try {\r\n                    innerControl.focus();\r\n                } catch (e) { };\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n    /*\r\n    *   Loads a search tab on demand inside an already rendered dialog\r\n    */\r\n    loadSearchTab: function (params, tab, searchForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If the tab has children it is loaded already\r\n        if (tab.children.length > 0)\r\n            return null;\r\n\r\n        // Load search form data\r\n        $.when(self.getSearchFormData(params, searchForm))\r\n\t\t\t\t.pipe(function (data) {\r\n\t\t\t\t    // Render data inside selected tab\r\n\t\t\t\t    var searchFormContainer = self.renderFactory.getContainer({\r\n\t\t\t\t        type: \"searchForm\",\r\n\t\t\t\t        data: data.form\r\n\t\t\t\t    });\r\n\t\t\t\t    tab.children.push(searchFormContainer);\r\n\r\n\t\t\t\t    return searchFormContainer.render();\r\n\t\t\t\t})\r\n\t\t\t\t.done(function (element) {\r\n\t\t\t\t    // Remove button container\r\n\t\t\t\t    $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t\t    tab.container.append(element);\r\n\t\t\t\t    defer.resolve();\r\n\t\t\t\t});\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox, reverseButtons) {\r\n        var self = this;\r\n        var reverseButtons = self.searchParams.orientation == \"rtl\" ? true : false;\r\n        // Define buttons\r\n        var buttons = [];\r\n        self.dialogBoxDeferred = new $.Deferred();\r\n\r\n        var defaultButtons = [\r\n            {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                click: function () {\r\n                    if (self.searchParams) {\r\n                        self.searchParams.searchTriggeredBy = \"button\";\r\n                    }\r\n                    // Perform search\r\n                    self.currentSearchForm.performSearch(self.searchParams);\r\n                }\r\n            },\r\n            {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n                click: function () {\r\n                    self.dialogBoxDeferred.reject();\r\n                    self.closeDialogBox();\r\n                }\r\n            }\r\n        ]\r\n        if (this.extraButtons) {\r\n            buttons.push(this.extraButtons);\r\n        }\r\n        buttons = buttons.concat(defaultButtons);\r\n\r\n        if (reverseButtons)\r\n            buttons.reverse();\r\n\r\n        var popupWidth = this.Class.POPUP_WIDTH;\r\n        var popupHeight = this.Class.POPUP_HEIGHT;\r\n\r\n        if (popupWidth > $(window).width())\r\n            popupWidth = $(window).width() * 0.9;\r\n\r\n        // Creates a dialog\r\n        dialogBox\r\n\t\t\t\t.addClass(\"ui-bizagi-dialog-search\")\r\n\t\t\t\t.dialog({\r\n\t\t\t\t    title: bizagi.localization.getResource(\"render-search-dialog-title\"),\r\n\t\t\t\t    width: popupWidth,\r\n\t\t\t\t    height: popupHeight,\r\n\t\t\t\t    resizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n\t\t\t\t    modal: true,\r\n\t\t\t\t    buttons: buttons,\r\n\t\t\t\t    close: function () {\r\n\t\t\t\t        self.dialogBoxDeferred.reject();\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t    },\r\n\t\t\t\t    resizeStop: function (event, ui) {\r\n                        self.form.resize(ui.size);\r\n                    },\r\n                    maximize: function(e){\r\n                        if (self.currentSearchForm){\r\n                            self.currentSearchForm.triggerHandler(\"maximazedForm\");\r\n                            self.dialogBox.trigger(\"resize\");\r\n                        }\r\n                    },\r\n                    unmaximize: function(e){\r\n                        if (self.currentSearchForm){\r\n                            self.currentSearchForm.triggerHandler(\"unmaximazedForm\");\r\n                            self.dialogBox.trigger(\"resize\");\r\n                        }\r\n                    }\r\n\t\t\t\t});\r\n\r\n        // Return promise\r\n        return self.dialogBoxDeferred.promise();\r\n    },\r\n\r\n    /*\r\n    *   Closes the dialog box\r\n    */\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        var dialogBox = self.dialogBox;\r\n        dialogBox.dialog('destroy');\r\n        dialogBox.detach();\r\n\t\t// Invalidate searchform page cache in the server\r\n        var pageCacheToInvalidate = self.currentSearchForm.getPageCache();\r\n        self.dataService.invalidatePageCache({ idPageCache: pageCacheToInvalidate });\r\n    },\r\n\r\n    /**\r\n    * Add buttons to dialog box\r\n    */\r\n\r\n    addButtons: function (params) {\r\n\r\n\r\n    },\r\n    /*     \r\n    *   Creates the search dialog sub-containers\r\n    */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: {\r\n                properties: {},\r\n                elements: []\r\n            }\r\n        };\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n\r\n            var tabContainer = {};\r\n            tabContainer.properties = {\r\n                type: \"tab\"\r\n            };\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: 'tabItem',\r\n                    displayName: searchForm.caption\r\n                };\r\n                tab.elements = [];\r\n\r\n                // Append children \r\n                if (isDefault) {\r\n\r\n                    tabContainer.elements.push({\r\n                        container: tab\r\n                    });\r\n\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n\r\n                } else {\r\n                    otherElements.push({\r\n                        container: tab\r\n                    });\r\n\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad)).done(function (searchFormData) {\r\n            if (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n\t\t\t\t// Add a reference to inner search form pagecache\r\n                container.pageCacheId = searchFormData.form.pageCacheId;\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            }\r\n        }).fail(function(){\r\n            console.log(\"Error\");\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Loads a search form\r\n    */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        //Check if exist form\r\n        if (searchForm == undefined || searchForm.id == undefined) {\r\n            var strMessage = bizagi.localization.getResource(\"render-search-without-form\");\r\n            var divMessage = $(\"<div>\").append(strMessage);\r\n            self.dialogBox.dialog(\"close\");\r\n\r\n            $(divMessage).dialog({\r\n                modal: true,\r\n                buttons: [{\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                    click: function () {\r\n                        $(this).dialog(\"close\");\r\n                    }\r\n                }],\r\n                maximize: function(e){\r\n                    console.log(\"please check if executed, which form trigger the event 'dialog.search'\");\r\n                },\r\n                unmaximize: function(e){\r\n                    console.log(\"please check if executed, which form trigger the event 'dialog.search'\");\r\n                }\r\n            });\r\n\r\n            return false;\r\n        }\r\n\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.form.dispose();\r\n        bizagi.util.dispose(self.buttons);\r\n        bizagi.util.dispose(self);\r\n    }\r\n});\r\n","/**\r\n * Description of file\r\n *\r\n * @author: Jeison Borja\r\n */\r\n\r\nbizagi.rendering.dialog.search.extend(\"bizagi.rendering.dialog.searchUser\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(dataService, renderFactory, searchForms, searchParams, otherOptions) {\r\n        // Call base\r\n        this._super(dataService, renderFactory, searchForms, searchParams, otherOptions);\r\n    },\r\n\r\n    getSearchFormData: function(params) {\r\n        return {\r\n            \"form\": {\r\n                \"properties\":\r\n                {\r\n                    \"id\": \"3ad923cf-f21e-439e-90b5-f2df8ffe4559\",\r\n                    \"type\": \"searchForm\",\r\n                    \"displayName\": \"SearchWFuser\",\r\n                    \"xpathContext\": \"\",\r\n                    \"columns\": [\r\n                        { \"caption\": \"idUser\", \"dataType\": 7, \"xpath\": \"idUser\" },\r\n                        { \"caption\": \"userName\", \"dataType\": 15, \"xpath\": \"userName\" },\r\n                        { \"caption\": \"domain\", \"dataType\": 15, \"xpath\": \"domain\" },\r\n                        { \"caption\": \"fullName\", \"dataType\": 15, \"xpath\": \"fullName\" },\r\n                        { \"caption\": \"enabledForAssignation\", \"dataType\": 5, \"xpath\": \"enabledForAssignation\" },\r\n                        { \"caption\": \"enabled\", \"dataType\": 5, \"xpath\": \"enabled\" }\r\n                    ]\r\n                },\r\n                \"elements\": [\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"e0babe1d-7924-4d2a-8fb3-b915b746dbe6\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"domain\",\r\n                                \"displayName\": \"domain\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"87b14b2e-992d-4e40-a17b-eecbcbc2466a\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"userName\",\r\n                                \"displayName\": \"userName\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"c5d137d9-a392-4d8e-9088-d5eba64b4c2a\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"fullName\",\r\n                                \"displayName\": \"fullName\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    }\r\n                ],\r\n                \"buttons\": [],\r\n                \"sessionId\": \"bcy5gtv11xxao4oy4xrlk3o3\",\r\n                \"pageCacheId\": 1876964702\r\n            },\r\n            \"type\": \"form\"\r\n        };\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Desktop Letter Dialog Implementation\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will shows a letter inside a popup dialog in order to edit\r\n*/\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.letter\", {\r\n    POPUP_WIDTH: 800,\r\n    POPUP_HEIGHT: 550    \r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory) {\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n    },\r\n\r\n    /*\r\n    *   Render the letter content\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (content) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        var template = self.renderFactory.getTemplate(\"letter.dialog\");\r\n        \r\n        // Render template\r\n        var dialog = $.tmpl(template);\r\n        \r\n        // Append form  in the dialog\r\n        dialog.appendTo(\"body\", doc);\r\n        \r\n        // Set height and width manually to adjust to the container\r\n        var textarea = $(\"#ui-bizagi-rtfeditor\", dialog);\r\n        textarea.width(this.Class.POPUP_WIDTH - 30);\r\n        textarea.height(this.Class.POPUP_HEIGHT - 150);\r\n        \r\n        // Apply plugin\r\n        new nicEditor({\r\n            iconsPath: self.dataService.getLetterEditorIconsPath(),\r\n            fullPanel: true\r\n        }).panelInstance('ui-bizagi-rtfeditor');\r\n        \r\n        // Create a templateParts array to hold the full html separated by body tags\r\n        self.templateParts = content.split(/(<body>|<\\/body>)/ig);\r\n        \r\n        // Set data\r\n        nicEditors.findEditor(\"ui-bizagi-rtfeditor\").setContent(content);\r\n        \r\n        // Create dialog box\r\n        return self.showDialogBox(dialog);\r\n    },\r\n\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox) {\r\n        var self = this;\r\n        \r\n        // Define buttons\r\n        var buttons = {};\r\n        var defer = new $.Deferred();\r\n                   \r\n        buttons[bizagi.localization.getResource(\"render-letter-dialog-box-save\")] = function () {\r\n            var newContent = nicEditors.findEditor(\"ui-bizagi-rtfeditor\").getContent();\r\n            \r\n            // Destroy dialog\r\n            dialogBox.dialog('destroy');\r\n            dialogBox.remove();\r\n            \r\n            // Append content to template, because the plugine removed html, head and body tags\r\n            //  - Actually there is an incosistent behaviour between IE8 and IE9\r\n            //  - In IE8, the templateParts doesn't include the <body> in the splitted array\r\n            //  - In IE9, the templateParts includes the <body> in the splitted array\r\n            if (self.templateParts[1] == \"<body>\") {\r\n            \t\r\n            \t// Remove empty headers, rare behaviour in IE9\r\n            \t self.templateParts[2] = newContent.replaceAll(\"<header></header>\", \"\");\r\n            \t\r\n            \t// Return new content\r\n                defer.resolve(self.templateParts.join(\"\"));\r\n            \r\n            } else {\r\n            \t// Return new content\r\n                defer.resolve(self.templateParts[0] + \"<body>\" + newContent + \"</body>\" + (self.templateParts.length > 2 ? self.templateParts[2] : \"\"));\r\n            }\r\n            \r\n            \r\n        };\r\n        buttons[bizagi.localization.getResource(\"render-letter-dialog-box-cancel\")] = function () {\r\n            dialogBox.dialog('close'); \r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: this.Class.POPUP_WIDTH,\r\n            height: this.Class.POPUP_HEIGHT,\r\n        \ttitle: bizagi.localization.getResource(\"render-letter-dialog-title\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function (ev, ui) {\r\n                dialogBox.dialog('destroy');\r\n                dialogBox.remove();\r\n                defer.reject();\r\n            }\r\n        });\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Desktop Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the form class to adjust to desktop devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.form\", bizagi.rendering.form.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.form\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        if (self.getMode() !== \"execution\") {\r\n            return;\r\n        }\r\n        \r\n        \r\n        // Style buttons\r\n        buttons.button();\r\n\r\n        //Set button length\r\n        var lengthButtons = (buttons) ? buttons.length : 0;\r\n\r\n        if (lengthButtons && self.params.type === \"form\" && self.params.isEntityForm !== true) {\r\n\r\n            if (self.properties.orientation == \"rtl\" && buttons.length > 0 && !self.properties.useCustomButtons) {\r\n                self.buttons.reverse();\r\n            }\r\n\r\n            $(document).data('auto-save', self.properties.id);\r\n            self.configureBindAutoSave(function(deferredSave){\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            self.beforeUnloadFunction = function (e) {\r\n\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data('auto-save')) {\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");\r\n                }\r\n                return;\r\n            };\r\n            $(window).unbind('beforeunload').bind('beforeunload', self.beforeUnloadFunction);\r\n        } else {\r\n            if ($._data(document)['events'] && !$._data(document)['events']['save-form']) {\r\n                self.configureBindAutoSave(function(deferredSave){\r\n                    deferredSave.resolve();\r\n                });\r\n            }\r\n        }\r\n\r\n        self.buildProcessPath();\r\n        var ecmContainer = (typeof (isWebpart) !== \"undefined\") ? $(document) : $(\"#ui-bizagi-wp-app-render-form-content\");\r\n        ecmContainer.scroll(function () {\r\n            $(\".modal-ecm\", this).hide();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure autoSave with callback\r\n     * @param callback\r\n     */\r\n    configureBindAutoSave: function(callback){\r\n        var self = this;\r\n\r\n        //bind event auto-save\r\n        self.autoSaveFunction = function (e, deferredSave) {\r\n            callback(deferredSave);\r\n        };\r\n\r\n        //Keeps the reference of the function required for handling autoSave\r\n        if (self.haveAutosaveAssociated()){\r\n            // Unbind previous events in order to prevent propagation //QAF-2521\r\n            $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n        }\r\n        else{\r\n            self.saveFormDelegate = $.proxy(self.autoSaveFunction, self);\r\n        }\r\n        // Bind event with actual reference of form\r\n        $(document).unbind(\"save-form\").bind(\"save-form\", {idAutoSave: self.getIdentifierFormForAutosave(), functionSaveFormDelegate: self.saveFormDelegate}, self.saveFormDelegate);\r\n    },\r\n\r\n    /**\r\n     * Call from child widgets\r\n     */\r\n    unbindAutoSaveForm: function(){\r\n        var self = this;\r\n        if(self.saveFormDelegate){\r\n            $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get a identifier for knows if form have autoSave associated\r\n     * @returns {*}\r\n     */\r\n    getIdentifierFormForAutosave: function(){\r\n        var self = this;\r\n        return self.properties.id || self.properties.uniqueId;\r\n    },\r\n\r\n    /**\r\n     * Determine if form have autosave associated, if yes, rewrite function saveFormDelegate\r\n     * @returns {boolean}\r\n     */\r\n    haveAutosaveAssociated: function(){\r\n        var result = false;\r\n        var self = this;\r\n        var autoSaveIdentifier = self.getIdentifierFormForAutosave();\r\n        var autoSaveHandlers = $._data($(document)[0], 'events')[\"save-form\"] || [];\r\n        for(var i = 0, length = autoSaveHandlers.length; i < length; i += 1){\r\n            if(autoSaveHandlers[i].data.idAutoSave === autoSaveIdentifier){\r\n                self.saveFormDelegate = autoSaveHandlers[i].data.functionSaveFormDelegate;\r\n                result = true;\r\n                break;\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Auto Save Events\r\n    */\r\n    autoSaveEvents: function (deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n        var changes = [];\r\n        var form = self.getFormContainer();\r\n        form.hasChanged(changes);\r\n\r\n        /* \r\n        *saving changes to validate or not the contents into a table\r\n        */\r\n        if (changes.length > 0) {\r\n\r\n            $.when(bizagi.showSaveBox(bizagi.localization.getResource(\"confirmation-savebox-message1\"), \"Bizagi\", \"warning\", self.properties.orientation)).done(function () {\r\n                self.collectRenderValues(data);\r\n                $.when(self.saveForm(data)).done(function () {\r\n                    //unbinding the save-form\r\n                    if (self.saveFormDelegate){\r\n                        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n                    }\r\n                    deferredSave.resolve();\r\n                });\r\n            }).fail(function (params) {\r\n                if (params == \"cancel\") {\r\n                    deferredSave.reject();\r\n                } else {\r\n                    deferredSave.resolve();\r\n\r\n                    //unbinding the save-form function in case if is still bound\r\n                    if (self.saveFormDelegate)\r\n                        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n                }\r\n            });\r\n        } else {\r\n            //unbinding the save-form function in case if is still bound\r\n            if (self.saveFormDelegate)\r\n                $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the buttons objects \r\n    */\r\n    getButtons: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n\r\n        return $(\".ui-bizagi-button-container .ui-bizagi-button\", container);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Remove  the document handlers for auto-save\r\n        $(window).unbind('beforeunload', self.beforeUnloadFunction);\r\n\r\n        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n      /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function(data) {\r\n        var self = this;\r\n\r\n        // Check is offline form\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Collect data\r\n        data = self.collectRenderValuesForSubmit(data);\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function() {\r\n            self.startLoading();\r\n\r\n            // Submit the form\r\n            return self.dataService.submitData({\r\n                action: \"SAVE\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            }).pipe(function() {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * Gets changes of current navigation form\r\n    */\r\n    getChanges: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (typeof (self.collectRenderValues) != \"undefined\") {\r\n            self.collectRenderValues(data);\r\n        }\r\n\r\n        return data;\r\n    },\r\n    /*\r\n     *build path process\r\n     */\r\n    buildProcessPath: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var queryForm = self.getFormType() == \"queryForm\";\r\n        var summaryForm = self.params.summaryForm || false;\r\n        var globalForm = self.properties.displayAsReadOnly || false;\r\n        if (mode == \"execution\" && !queryForm && !summaryForm && !globalForm && self.properties.processPath && self.properties.processPath.length > 0) {\r\n            var template = self.renderFactory.getTemplate(\"form-process-path\");\r\n            var html = $.fasttmpl(template, {processPath: properties.processPath});\r\n            self.pathProcess = html;\r\n        } else {\r\n            self.pathProcess = \"\";\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the panel class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.panel\", bizagi.rendering.panel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.panel\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop ContentPanel Extension\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will redefine the content panel class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.contentPanel\", bizagi.rendering.contentPanel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.contentPanel.extend(\"bizagi.rendering.desktop.contentPanel\", {}, {\r\n    \r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Nested Form Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a nested form container class for all devices\r\n */\r\n\r\n// Extends from container desktop panel base\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.nestedForm\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.container;\r\n\r\n        container.removeClass(\"ui-bizagi-container-panel\");\r\n        container.addClass(\"ui-bizagi-container-nestedform\");\r\n\r\n        var title = $(\"<span class= 'ui-bizagi-container-nestedform-title'/>\");\r\n        title.text(\"Nested Form: \" + properties.formDisplayName);\r\n        container.prepend(title);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop Tab Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the tab class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.tab\", bizagi.rendering.tab.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.tab.extend(\"bizagi.rendering.desktop.tab\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (tab) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(tab);\r\n\r\n        // Apply tabs widget\r\n        tab.tabs({\r\n            active: self.activeTab,\r\n            activate: function (event, ui) {\r\n                self.children[self.activeTab].visibleTab();\r\n                // BUGFIX for grids inside tabs\r\n                setTimeout(\r\n                    function () {\r\n                        self.resize({width: self.container.width(), height: self.container.height()});\r\n                        if (typeof (self.getParams()) != \"undefined\")\r\n                            if (self.getParams().context == \"sharepoint\" || window.self !== window.top)\r\n                                self.resizeInPopUpHTML();\r\n                    }, 50);\r\n            },\r\n            beforeActivate: function (event, ui) {\r\n                var index = ui.newTab.index();\r\n\r\n                self.setActiveTab(index);\r\n            }\r\n        });\r\n\r\n        setTimeout(function () {\r\n            self.children.forEach(function (tabItem) {\r\n                var properties = tabItem.properties;\r\n                if (properties.tooltip) {\r\n                    var tabHeader$ = $(\"a[href=#ui-bizagi-tab-\" + properties.id + \"]\", tab);\r\n                    tabHeader$.tooltip({\r\n                        content: tabHeader$.attr(\"title\"),\r\n                        position: {\r\n                            at: \"center top-55\"\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }, 10);\r\n\r\n    },\r\n    resizeInPopUpHTML: function () {\r\n        var self = this;\r\n        if ($(\".activitiFormContainer\").length > 0) {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var params = self.getParams();\r\n            if (params.idWorkitem || buttonContainer.length > 0) {\r\n                //display buttons\r\n                var heightButtonContainer = buttonContainer.height() || 0;\r\n                renderForm.height(heightActivitiFormContainer - 110 - heightButtonContainer);\r\n            } else {\r\n                //NOT display buttons\r\n                renderForm.height(heightActivitiFormContainer - 110);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop TabItem Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the tab item class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.tabItem\", bizagi.rendering.tabItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.tabItem.extend(\"bizagi.rendering.desktop.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set tab ready deferred\r\n        self.tabReadyDeferred = new $.Deferred();\r\n        self.loadingDeferred = new $.Deferred();\r\n        self.tabActiveDeferred = new $.Deferred();\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function (size) {\r\n        var self = this,\r\n            container = self.container;\r\n        var width = container.width();\r\n\r\n        // Set a timeout to resize the tab only when the tab is visible\r\n        // Will try only ten times to avoid infinite cycles\r\n        var counter = 0;\r\n        var resizeTimeout = function () {\r\n            if (counter > 10) return;\r\n            if (container.is(\":visible\")) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.resize({width: width});\r\n                });\r\n            } else {\r\n                counter++;\r\n                setTimeout(resizeTimeout, 200);\r\n            }\r\n        };\r\n        $.when(self.ready()).done(function () {\r\n            resizeTimeout();\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            // Changes item\r\n            var tabContainer = self.parent;\r\n            if (tabContainer.container.data(\"ui-tabs\")) {\r\n                tabContainer.container.tabs(\"option\", \"active\", self.container.data(\"tab-counter\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected manually\r\n    */\r\n    activate: function () {\r\n        this._super();\r\n        if (this.loadingDeferred) this.loadingDeferred.resolve();\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is visible\r\n    */\r\n    visibleTab: function () {\r\n        if (this.tabActiveDeferred) this.tabActiveDeferred.resolve();\r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        // Activate the tab if it hasn't been loaded\r\n        this.activate();\r\n\r\n        // Set this tab as an active container\r\n        this.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        var self = this;\r\n        var properties = this.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Render children\r\n        if (properties.loadOnDemand === undefined || properties.loadOnDemand == false || form.innerTabsLoading) {\r\n            html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n            self.tabReadyDeferred.resolve();\r\n            self.tabActiveDeferred.resolve();\r\n            return html;\r\n\r\n        } else {\r\n            // Defer execution for a while to improve first tab pkerformance\r\n            self.startLoading();\r\n\r\n            // Start a timeout, when the timeout finishes, it resolves the deferred therefore loading the tab\r\n            if (self.getMode() == \"execution\") {\r\n                setTimeout(function () {\r\n                    if (self.loadingDeferred) {\r\n                        self.loadingDeferred.resolve();\r\n                    }\r\n                }, 10500);\r\n            }\r\n\r\n            $.when(self.loadingDeferred.promise())\r\n                .done(function () {\r\n                    if (!self.isDisposed()) {\r\n                        $.when(self.parent.ready()).done(function () {\r\n                            self.replaceChildrenTag(self.container, self.renderChildrenHtml());\r\n                            self.postRenderContainer(self.container);\r\n                            self.endLoading();\r\n\r\n                            // Resolve tab deferred when tab is ready\r\n                            self.tabReadyDeferred.resolve();\r\n                            self.tabActiveDeferred.resolve();\r\n                        });\r\n                    } else {\r\n                        // Reject tab deferred when tab is not valid\r\n                        self.tabReadyDeferred.reject();\r\n                        self.tabActiveDeferred.reject();\r\n                    }\r\n                });\r\n\r\n            // Set a div in order to asynchonously resolve this\r\n            html = self.replaceChildrenHtml(html, '<div class=\"children\"/>');\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns promise to hold any execution until the content is ready\r\n    */\r\n    ready: function (argument) {\r\n        var self = this;\r\n\r\n        if (bizagi.util.parseBoolean(argument) && self.container && self.container.length) {\r\n            if (self.loadingDeferred) {\r\n                self.loadingDeferred.resolve();\r\n            }\r\n            $.when(self.tabReadyDeferred.promise()).done(function () {\r\n                self.activate();\r\n            });\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (!(self.container && self.container.length)) {\r\n                var id = setInterval(function () {\r\n                    if (self.container && self.container.length) {\r\n                        clearInterval(id);\r\n                        if (self.loadingDeferred) {\r\n                            self.loadingDeferred.resolve();\r\n                        }\r\n                    }\r\n                }, 50);\r\n            }\r\n        }\r\n\r\n        // Merge promises\r\n        return $.when(\r\n            self.tabReadyDeferred.promise(),\r\n            self.parent.ready(),\r\n            self.tabActiveDeferred.promise()\r\n        );\r\n    },\r\n\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._super(argument);\r\n\r\n        var tabContainer = self.parent.container;\r\n        var id = \"ui-bizagi-tab-\" + properties.id;\r\n        var header = $(\"ul li[aria-controls = '\" + id + \"']\", tabContainer);\r\n        var activeTab = self.parent.getActiveTab();\r\n\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Hide - show the render\r\n                if (properties.visible) {\r\n                    header && header.show();\r\n                    self.setAsActiveContainer();\r\n                } else {\r\n                    if (self.getMode() === \"execution\") {\r\n                        header && header.hide();\r\n                    }\r\n                }\r\n            })\r\n            .always(function () {\r\n                if (tabContainer.data(\"ui-tabs\")) {\r\n                    tabContainer.tabs(\"option\", \"active\", activeTab);\r\n                }\r\n            });\r\n\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        this._super();\r\n        $(this.parent.container).tabs(\"refresh\");\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Horizontal Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.horizontal\", bizagi.rendering.horizontal.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.horizontal.extend(\"bizagi.rendering.desktop.horizontal\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var children = self.children;\r\n        var iCount = children.length;\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        // Process each child\r\n        $.each(children, function (i, child) {\r\n            // Process width\r\n            var renderWidth = child.properties.width;\r\n            if (renderWidth == null || renderWidth.length == 0) {\r\n                // Set default size\r\n                renderWidth = 100 / iCount;\r\n            } else {\r\n                // Set custom size\r\n                renderWidth = bizagi.util.percent2Number(renderWidth);\r\n            }\r\n\r\n            (function (j, innerChild, jCount) {\r\n                $.when(innerChild.ready()).done(function () {\r\n                    var renderedElement = innerChild.getRenderedElement();\r\n                    // Set width\r\n                    if (j != (jCount - 1)) {\r\n                        renderedElement.css({ width: renderWidth + \"%\" });\r\n                    } else {\r\n                        renderedElement.css({ width: renderWidth + \"%\" });\r\n                    }\r\n\r\n                    renderedElement.addClass('ui-panel-area');\r\n\r\n                    // Set class for last render\r\n                    if (j == jCount - 1) {\r\n                        renderedElement.addClass(\"ui-bizagi-render-last\");\r\n                    }\r\n                });\r\n            })(i, child, iCount);\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Layout Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the layout class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.layout\", bizagi.rendering.layout.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layout.extend(\"bizagi.rendering.desktop.layout\", {}, {});\r\n","/*\r\n*   Name: Bizagi Desktop Accordion Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the accordion class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.accordion\", bizagi.rendering.accordion.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.accordion.extend(\"bizagi.rendering.desktop.accordion\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (accordion) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(accordion);\r\n\r\n        // Apply accordion widget\r\n        // Enable accordeon\r\n        accordion.accordion({\r\n            autoHeight: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop AccordionItem Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the accordion item class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.accordionItem\", bizagi.rendering.accordionItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.accordionItem.extend(\"bizagi.rendering.desktop.accordionItem\", {}, {\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n    \t\r\n    \t$.when(self.ready())\r\n    \t.done(function () {\r\n            var accordionContainer = self.parent;\r\n\r\n            // Changes item\r\n            accordionContainer.container.accordion(\"option\", \"active\", self.properties.ordinal);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n    \tself.activate();\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    }        \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Group Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the group class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.group\", bizagi.rendering.group.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.group.extend(\"bizagi.rendering.desktop.group\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed\r\n     * @param {} group \r\n     * @returns {} \r\n     */\r\n    postRenderContainer: function(group) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var styleSufix = properties.orientation == \"rtl\" ? \"-rtl\" : \"\";\r\n\r\n        // Call base\r\n        self._super(group);\r\n\r\n        var icon = $(\".ui-icon\", $(\".ui-bizagi-container-group-header:first\", self.container));\r\n        var header = $(\".ui-bizagi-container-group-header\", self.container);\r\n\r\n        // Define expanded property\r\n        if (bizagi.util.parseBoolean(properties.collapse)) {\r\n            properties.expanded = false;\r\n            icon.addClass(\"ui-state-collapse\" + styleSufix).removeClass(\"ui-state-expand\" + styleSufix);\r\n        } else {\r\n            properties.expanded = true;\r\n            icon.addClass(\"ui-state-expand\" + styleSufix).removeClass(\"ui-state-collapse\" + styleSufix);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the container's behaviour to add handlers\r\n     * @returns {} \r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var styleSufix = properties.orientation == \"rtl\" ? \"-rtl\" : \"\";\r\n        var group = self.container;\r\n        var icon;\r\n\r\n        // Delegate event click\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n        $(header).click(function(e) {\r\n            if (e.preventDefault)\r\n                e.preventDefault();\r\n\r\n            icon = $(\".ui-icon\", group);\r\n            icon.toggleClass(\"ui-icon-triangle-1-s ui-icon-triangle-1-n\");\r\n\r\n            $(\".ui-bizagi-container-group-wrapper:first\", group).toggle();\r\n\r\n            if (properties.expanded) {\r\n                properties.expanded = false;\r\n                icon.addClass(\"ui-state-collapse\" + styleSufix).removeClass(\"ui-state-expand\" + styleSufix);\r\n                $(this).addClass(\"group-collapse\").removeClass(\"group-expand\");\r\n            } else {\r\n                properties.expanded = true;\r\n                icon.addClass(\"ui-state-expand\" + styleSufix).removeClass(\"ui-state-collapse\" + styleSufix);\r\n                $(this).addClass(\"group-expand\").removeClass(\"group-collapse\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Check if group its open\r\n    * \r\n    * @return boolean\r\n    */\r\n    isOpen: function() {\r\n        if (this.properties.expanded) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Focus on container     \r\n     * @returns {} \r\n     */\r\n    focus: function() {\r\n        // Expand container\r\n        this.expand();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Expands group container \r\n     * @returns {} \r\n     */\r\n    expand: function() {\r\n        var self = this;\r\n        var group = self.container;\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n\r\n        if (!self.isOpen())\r\n            $(header).trigger(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Collapses group container \r\n     * @returns {} \r\n     */\r\n    collapse: function() {\r\n        var self = this;\r\n        var group = self.container;\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n\r\n        if (self.isOpen())\r\n            $(header).trigger(\"click\");\r\n    },\r\n\r\n    /**     \r\n     * Expands or collapse the container \r\n     * @param {} argument      \r\n     */\r\n    toogleContainer: function(argument) {\r\n        var self = this;\r\n\r\n        if (argument) {\r\n            self.expand();\r\n        } else {\r\n            self.collapse();\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop SearchForm Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the search form class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.searchForm\", bizagi.rendering.searchForm.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.searchForm.extend(\"bizagi.rendering.desktop.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: 'grid',\r\n            xpath: 'searchForm' + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            inlineAdd: false,\r\n            allowDelete: false,\r\n            allowAdd: false,\r\n            hideActionsColumn: true,\r\n            floatingHeader: true, \r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function (params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function (i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n            //TODO insert dataType and TextFormat properties\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0) {\r\n                column.render.properties.columnVisible = false;\r\n            }\r\n            //if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8) {\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n            }\r\n\r\n            //if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11) column.render.properties.allowDecimals = true;\r\n\r\n            //if column is date push showtime property\r\n            if (columns[i].dataType == 12) {\r\n                column.render.properties.showTime = columns[i].showTime;\r\n            }\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode(),\r\n            jqgrid: false\r\n        });\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var searchCriteria = container.find(\".ui-bizagi-container-search-criteria\");\r\n        var results = container.find(\".ui-bizagi-container-search-results\");\r\n        var childrenElements = searchCriteria.children();\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) child.postRenderContainer(childElement);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".ui-bizagi-container-search-criteria\", self.container);\r\n        self.resultsContainer = $(\".ui-bizagi-container-search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty('multiSelect')) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n\r\n        return self;\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n        var self = this;\r\n        var resultsGrid = self.resultsGrid;\r\n\r\n        // Makes the grid to refresh\r\n        resultsGrid.refresh();\r\n        $.when(resultsGrid.dataReady())\r\n            .done(function () {\r\n\r\n                // Shows result container\r\n                self.resultsContainer.show();\r\n\r\n                self.resizeResults();\r\n            });\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function () {\r\n        var self = this;\r\n        // Resize results\r\n        self.resizeResults();\r\n    },\r\n\r\n    /* \r\n    Resizes the container to split the view\r\n    */\r\n    resizeResults: function () {\r\n        var self = this;\r\n        var resultsGrid = self.resultsGrid;\r\n\r\n        if (self.resultsContainer.is(':visible')) {\r\n            self.criteriaContainer.height(\"auto\");\r\n\r\n        } else {\r\n            self.criteriaContainer.height(\"100%\");\r\n        }\r\n\r\n        // Resize grid results\r\n        resultsGrid.resize({\r\n            width: self.criteriaContainer.width(),\r\n            onSearchFinished: function () {\r\n                var self = this;\r\n                if (self.properties)\r\n                    if (self.properties.records == 0) {\r\n                        $(\".ui-bizagi-container-search-results\", self.container).show();\r\n                        $(\".ui-bizagi-container-search-results .ui-jqgrid-title\", self.container).hide();\r\n                    } else {\r\n                        $(\".ui-bizagi-container-search-results .ui-jqgrid-title\", self.container).show();\r\n                    }\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.text\", bizagi.rendering.text.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.text.extend(\"bizagi.rendering.desktop.text\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Define max length of element\r\n        if (this.properties.maxLength > 0)\r\n            this.input.attr(\"maxlength\", this.properties.maxLength);\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && this.properties.editable) {\r\n            this.input && this.input.val(value);\r\n        } else {\r\n            if (value === null && this.properties.editable) {\r\n                this.input && this.input.val(\"\");\r\n            }\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        control.tooltip({disabled: true});\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") == undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.data(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue != control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        // Add the render value\r\n        var xpath = self.properties.xpath;\r\n\r\n        // replace strange character\r\n        var value = self.getValue();\r\n\r\n        if (value != null && typeof (value) !== \"undefined\" && typeof (value) !== \"number\") {\r\n            value = value.replaceAll(String.fromCharCode(\"030\"), '');\r\n            value = value.replaceAll(String.fromCharCode(\"018\"), '');\r\n            value = value.replaceAll(String.fromCharCode(\"016\"), '');\r\n        }\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[xpath] = value;\r\n                } else if (value === \"\") {\r\n                    renderValues[xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, oterwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[self.properties.xpath] = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.extendedText\", bizagi.rendering.extendedText.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.extendedText.extend(\"bizagi.rendering.desktop.extendedText\", {\r\n\r\n    //#region Side effects functions\r\n\r\n    /**\r\n     * Is triggered after the control exists in the DOM\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n\r\n        if (bizagi.util.isIE8()) {\r\n            this.textarea.attr(\"cols\", \"5000\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Is triggered after the control exists in the DOM when it's readonly\r\n     */\r\n    postRenderReadOnly: function () {\r\n        $(this.getControl()).addClass(\"ui-bizagi-text-extended-readonly\");\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Define max length of element\r\n        if (properties.maxLength > 0) {\r\n\r\n            self.textarea.attr(\"maxlength\", properties.maxLength);\r\n            self.actualMaxLength = properties.maxLength;\r\n\r\n        }\r\n\r\n        self.ready().done(function () {\r\n            // auto extend\r\n            if (properties.autoExtend) {\r\n                var value = \"\";\r\n                var minHeight = self.textarea.css(\"height\");\r\n                var valMinHeight;\r\n\r\n\r\n                if (properties.maxLines === undefined) {\r\n                    if (typeof minHeight == \"string\" && minHeight.search(\"px\") !== -1) {\r\n                        valMinHeight = Number(minHeight.split(\"px\")[0]);\r\n\r\n                        if (valMinHeight <= 150)\r\n                            minHeight = \"150px\";\r\n                    } else {\r\n                        minHeight = \"150px\";\r\n                    }\r\n                }\r\n\r\n                // set textarea styles\r\n                self.textarea.css({overflow: \"hidden\", resize: \"none\", minHeight: minHeight});\r\n\r\n                setTimeout(function () {\r\n                    self.changeHeightAutoExtended(self.textarea[0]);\r\n                }, 100);\r\n\r\n                self.textarea.bind(\"keyup\", function () {\r\n                    self.changeHeightAutoExtended(this);\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = this.validateValue((typeof (decodedValue) == \"string\" ? decodedValue : \"\"), self.properties.maxLength);\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        var resolvedValue = $.br2nl(value);\r\n        if (self.textarea) self.textarea.val(resolvedValue);\r\n    },\r\n\r\n    /**\r\n     * Gets control's value\r\n     * @param {} renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n\r\n        // replace strange character\r\n        var value = self.getValue();\r\n\r\n        if (self.getValue() != null && typeof (self.getValue()) != \"undefined\") {\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"030\"), '');\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"018\"), '');\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"016\"), '');\r\n        }\r\n\r\n        if ($.controlValueIsChanged(self)) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[xpath] = value;\r\n                } else if (value === \"\") {\r\n                    renderValues[xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, oterwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setValue(\"\");\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"textarea\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        }\r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,smartphone...)\r\n     */\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input, textarea\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n\r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\"))\r\n                    $(this).data().newValue = undefined;\r\n            }\r\n\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Changes required status\r\n     * @param {} argument\r\n     */\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    /**\r\n     * Changes label's required status\r\n     * @param {} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * Changes cell's required status\r\n     * @param {} argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Validates the double value from retype\r\n     * @param {jQuery Object} control jQuery Object\r\n     */\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") != \"hidden\" && $(control).css(\"display\") != \"none\" && $(control).css(\"visibility\") != \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") == undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") == \"\") {\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue == \"\" || currentValue == control.data(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue == \"\") return;\r\n\r\n                if (currentValue != control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-fail\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Changes control's height when it's auto extended\r\n     * @param {Object} control HTML Object\r\n     */\r\n    changeHeightAutoExtended: function (control) {\r\n        control.style.removeProperty(\"height\");\r\n        control.style.height = control.scrollHeight < (this.properties.maxLines * 20) ? (this.properties.maxLines * 20) : control.scrollHeight + \"px\";\r\n    },\r\n\r\n    //#endregion Side effects functions\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Label Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.label\", bizagi.rendering.label.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.label.extend(\"bizagi.rendering.desktop.label\", {}, {\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        this.setValue(this.properties.displayName);\r\n        return this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed     \r\n     */\r\n    postRender: function() {\r\n        // Apply a css class\r\n        this.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values     \r\n     */\r\n    postRenderReadOnly: function() {\r\n        // Apply a css class\r\n        this.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Label Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.label.extend(\"bizagi.rendering.desktop.queryLabel\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Number Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.number\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.number.extend(\"bizagi.rendering.desktop.number\", {}, {\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(value);\r\n\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            self.value = self.properties.value = value;\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            var typeControl = self.parent.properties.type;\r\n\r\n            if (typeControl === \"grid\") {\r\n                if (previousValue != null && value !== previousValue) {\r\n                    if ($(this).data(\"newValue\") !== undefined && control.val() !== $(this).data(\"newValue\")) {\r\n                        $(this).data().newValue = undefined;\r\n                    }\r\n                }\r\n                self.retypeDouble(control);\r\n            } else {\r\n                self.retypeDouble(control);\r\n            }\r\n        });\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") === undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.data(\"newValue\"))\r\n                    return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", control.val());\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Desktop Render Query Number Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.number.extend(\"bizagi.rendering.desktop.queryNumber\", {}, {\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n        if (value !== null && properties.editable) {\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Render Date Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the Date render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.date\", bizagi.rendering.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.date.extend(\"bizagi.rendering.desktop.date\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n\t\tinitializeData: function(data) {\r\n        var self = this;\r\n\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        // Fix dateFormat for datepicker\r\n        var dateFormat = self.getDateFormat(properties.dateFormat);\r\n\r\n        properties.datePickerFormat = dateFormat.datePickerFormat;\r\n        properties.timePickerFormat = dateFormat.timePickerFormat;\r\n    },\r\n\r\n    /**\r\n     * Translate standar date format to jquery date picker\r\n     *\r\n     */\r\n\t\tgetDateFormat: function(format) {\r\n        var datePickerFormat = format;\r\n        var timePickerFormat = undefined;\r\n        var init;\r\n\r\n        var properties = this.properties;\r\n\r\n        if (format.search(\"h\") != -1 || format.search(\"H\") != -1) {\r\n            if (format.search(\"h\") != -1) {\r\n                init = format.search(\"h\");\r\n            } else {\r\n                init = format.search(\"H\");\r\n            }\r\n\r\n            datePickerFormat = format.substring(0, init - 1);\r\n            timePickerFormat = format.substr(init);\r\n        }\r\n\r\n        // Fix month\r\n        if (datePickerFormat.indexOf(\"MMMM\") >= 0) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMMM\", \"MM\");\r\n        } else if (datePickerFormat.indexOf(\"MMM\") >= 0) {\r\n            // Month name short\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMM\", \"M\");\r\n        } else if (datePickerFormat.indexOf(\"MM\") >= 0) {\r\n            // Month two digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MM\", \"mm\");\r\n        } else if (datePickerFormat.indexOf(\"M\") >= 0) {\r\n            // Month one digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"M\", \"m\");\r\n        }\r\n\r\n        // Fix years\r\n        if (datePickerFormat.search(\"yyyy\") != -1) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"yyyy\", \"yy\");\r\n        } else {\r\n            if (datePickerFormat.search(\"yy\") != -1) {\r\n                datePickerFormat = datePickerFormat.replaceAll(\"yy\", \"y\");\r\n            }\r\n        }\r\n\r\n        datePickerFormat = datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n\r\n        return { datePickerFormat: datePickerFormat, timePickerFormat: timePickerFormat };\r\n    },\r\n\r\n\t\tgetElementsToStylize: function(context) {\r\n        var children = $(context).children();\r\n        if (children.length) {\r\n            return children;\r\n        } else {\r\n            return $(context);\r\n        }\r\n    },\r\n\r\n\t\tgetTimePickerFormat: function(timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            showZeroInHour: true, // True to show 0 when hour < 10\r\n            separator: \":\"\r\n        };\r\n\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n                returnObj.showZeroInHour = token == \"h\" ? false : true;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n                returnObj.showZeroInHour = token == \"H\" ? false : true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                returnObj.separator = token;\r\n            } else if (lastToken.toUpperCase() == \"S\" || lastToken.toUpperCase() == \"SS\") {\r\n                lastToken = token;\r\n                returnObj.ampmPrefix = token;\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n\t\tpostRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var timeControl = self.getTimeControl();\r\n        var dateControl = self.getDateControl();\r\n        var dateContainer = dateControl.parent();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        var maxUndefinedYear = parseInt(new Date().getFullYear() + 200).toString();\r\n        var minUndefinedYear = parseInt(new Date().getFullYear() - 200).toString();\r\n\r\n        if (typeof properties.maxValue == \"undefined\") properties.maxValue = \"12/31/\" + maxUndefinedYear + \" 00:00:00\"; //Current year + 200 IE or 9999\r\n        if (typeof properties.minValue == \"undefined\") properties.minValue = \"01/01/\" + minUndefinedYear + \" 00:00:00\"; //Current year - 200 IE or 1753 for SQL Server compat\r\n\r\n        // Apply timeEntry plugin\r\n        if (properties.showTime) {\r\n            if (self.getMode() == \"execution\")\r\n\t\t\t\t\twindow.setTimeout(function() {\r\n                    if (dateControl.parent() && timeControl.parent()) {\r\n                        // RTL adjustments when timecontrol is present\r\n                        if (properties.orientation == \"rtl\") {\r\n                            self.getTimeControl().css(\"paddingLeft\", \"0px\");\r\n                            self.getTimeControl().css(\"paddingRight\", \"4px\");\r\n                        }\r\n                    }\r\n                }, 0);\r\n\r\n            var timeFormatProperties;\r\n\r\n            if (properties.timePickerFormat !== undefined) {\r\n                timeFormatProperties = self.getTimePickerFormat(properties.timePickerFormat);\r\n            } else {\r\n                timeFormatProperties = bizagi.util.dateFormatter.analyzeTimeFormat(properties.timeFormat);\r\n            }\r\n\r\n            timeControl.timeEntry({\r\n                spinnerTexts: [\r\n                    this.getResource(\"render-timeentry-now\"),\r\n                    this.getResource(\"render-timeentry-previous-field\"),\r\n                    this.getResource(\"render-timeentry-next-field\"),\r\n                    this.getResource(\"render-timeentry-increment\"),\r\n                    this.getResource(\"render-timeentry-decrement\")\r\n                ],\r\n                showSeconds: timeFormatProperties.showSeconds,\r\n                show24Hours: timeFormatProperties.show24Hours,\r\n                separator: timeFormatProperties.separator,\r\n                ampmPrefix: timeFormatProperties.ampmPrefix || \"\",\r\n                useMouseWheel: self.getMode() == \"execution\",\r\n                showZeroInHour: timeFormatProperties.showZeroInHour\r\n            });\r\n\r\n            // DEPL: Fix plugin without touching it\r\n            // The plugin is setting the image as an inline style,\r\n            // that means that we can't set it in the css files,\r\n            // so we remove the inline style, and the css will do the rest\r\n            $(\".timeEntry_control\", timeControl)\r\n                .css(\"height\", \"\")\r\n                .css(\"width\", \"\")\r\n                .css(\"display\", \"\")\r\n                .css(\"background-color\", \"\")\r\n                .css(\"background-image\", \"\")\r\n                .css(\"background-position\", \"\")\r\n                .css(\"background-repeat\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n\t\tconfigureHandlers: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var dateIcon = self.getDateIcon();\r\n        var initYear = 100;\r\n        var endYear = 30;\r\n\r\n        if (!isNaN(Date.parse(properties.minValue))) {\r\n            initYear = new Date().getFullYear() - $.datepicker.parseDate(\"mm/dd/yy\", properties.minValue).getFullYear() || 100;\r\n        }\r\n\r\n        if (!isNaN(Date.parse(properties.maxValue))) {\r\n            endYear = $.datepicker.parseDate(\"mm/dd/yy\", properties.maxValue).getFullYear() - new Date().getFullYear() || 100;\r\n        }\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set datepicker i18n\r\n        $.datepicker.setDefaults(self.i18n);\r\n\r\n        var options = {\r\n            firstDay: bizagi.override.firstDay || 0,\r\n            yearRange: \"c-\" + initYear + \":c+\" + endYear,\r\n            dateFormat: properties.datePickerFormat,\r\n            changeYear: true,\r\n            changeMonth: true,\r\n            shortYearCutoff: typeof BIZAGI_DEFAULT_DATETIME_INFO != \"undefined\" && typeof BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta != \"undefined\" ? \"+\" + BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta : \"+50\",\r\n\t\t\t\tbeforeShow: function() {\r\n                // Set min & max value\r\n                self.properties.editable = true;\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n                self.setDisplayValue(self.getValue());\r\n\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").on(\"scroll.datecontrol\", function(e) {\r\n                    $(\".ui-bizagi-render-date\").datepicker(\"hide\");\r\n                });\r\n            },\r\n\t\t\t\tonClose: function() {\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").off(\"scroll.datecontrol\");\r\n\r\n                if (bizagi.util.isIE()) {\r\n                    window.setTimeout(function (event) {\r\n\t\t\t\t\t\t\t\t$(event).datepicker(\"enable\");\r\n                    }.bind(undefined, this), 500);\r\n                }\r\n            }\r\n        };\r\n\r\n        if (bizagi.util.isIE()) {\r\n            options = $.extend(options, {\r\n\t\t\t\t\tonSelect: function() {\r\n                    $(this).datepicker(\"disable\");\r\n\r\n                    self.getLabel().focus();\r\n                    $(this).change();\r\n                }\r\n            });\r\n        }\r\n\r\n        // Apply datepicker & mask plugin\r\n        dateControl.datepicker(options);\r\n\r\n        // Bind to change event to detect if the user clears the text\r\n\t\t\tdateControl.bind(\"change\", function() {\r\n            var value = dateControl.val();\r\n\r\n            if (bizagi.util.isEmpty(value)) {\r\n                self.setValue(\"\");\r\n            } else if (value.match(/\\d{5,}/)) {\r\n                self.setDisplayValue(self.getDisplayValue());\r\n            } else {\r\n\r\n                var format = self.properties.dateFormat.substring(0, self.properties.dateFormat.search(\"h|H\") != -1 ? self.properties.dateFormat.search(\"h|H\") - 1 : self.properties.dateFormat.length);\r\n\r\n                if (bizagi.util.dateFormatter.getDateFromFormat(value, format.replace((/'\\D+\\.'$/i),\"\"), self.i18n) == 0) {\r\n                    self.setValue(\"\");\r\n                    dateControl.val(\"\");\r\n                }\r\n            }\r\n        });\r\n\r\n        //set the focus on the input when the icon is clicked\r\n\t\t\tdateIcon.bind(\"click\", function() {\r\n            dateControl.focus();\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n\t\tconfigureDesignView: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (properties.showTime) {\r\n            control.find(\".timeEntry_control\").unbind(\"mousedown\");\r\n            control.find(\".timeEntry_control\").unbind(\"mouseup\");\r\n            control.find(\".timeEntry_control\").unbind(\"mouseover\");\r\n            control.find(\".timeEntry_control\").unbind(\"mousemove\");\r\n        }\r\n    },\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n\t\tgetDateControl: function() {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date\", self.getControl());\r\n        return self.dateControl;\r\n    },\r\n    /*\r\n    *   Gets the date icon\r\n    */\r\n\t\tgetDateIcon: function() {\r\n        var self = this;\r\n        self.dateIcon = $(\".ui-bizagi-wp-app-icon-date\", self.getControl());\r\n        return self.dateIcon;\r\n    },\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n\t\tgetTimeControl: function() {\r\n        var self = this;\r\n        self.timeControl = $(\".ui-bizagi-render-time\", self.getControl());\r\n        return self.timeControl;\r\n    },\r\n\t\t/* \r\n    *   Changes the render min value\r\n    */\r\n\t\tchangeMinValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && properties.editable) {\r\n            if (typeof value === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.datepicker(\"option\", \"minDate\", value); // DateTime Normal\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(value)); // DateTime Normal\r\n            }\r\n\r\n            properties.minValue = value; // Invarian date\r\n        }\r\n    },\r\n\r\n\t\t/* \r\n    *   Changes the render max value\r\n    */\r\n\t\tchangeMaxValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && properties.editable) {\r\n            if (typeof value === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.datepicker(\"option\", \"maxDate\", value); // DateTime Normal\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(value)); // DateTime Normal\r\n            }\r\n\r\n            properties.maxValue = value; // Invarian date\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n\t\tsetDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        if (bizagi.util.isNumeric(value) && value !== 0) {\r\n            value = bizagi.util.dateFormatter.formatInvariant(new Date(value), properties.showTime);\r\n        }\r\n\r\n        // Call base\r\n        self._super(value);\r\n\r\n        // Set value in input\r\n        if (value && properties.editable) {\r\n            var dateObj;\r\n            if (properties.timePickerFormat !== undefined) {\r\n                if (self.getMode() != \"execution\") {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                } else {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                }\r\n            } else {\r\n                if (properties.showTime) {\r\n                    var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n                    if (typeof value == \"string\") {\r\n                        if (value.length == INVARIANT_FORMAT.length || value.length == INVARIANT_FORMAT.length + 1) {\r\n                            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                        } else {\r\n                            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                            dateObj.setHours(0, 0, 0, 0);\r\n                        }\r\n                    } else {\r\n                        dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                    }\r\n                } else {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                }\r\n            }\r\n\r\n            // Assert that the date could be parsed\r\n            bizagi.assert(dateObj != 0, \"The date could not be parsed\", value);\r\n\r\n            // Just set the value in the input for performance, when initializing the view\r\n            if (self.internalSetInitialValueFlag) {\r\n                if (self.getMode() === \"execution\") {\r\n                    dateControl.datepicker(\"setDate\", dateObj);\r\n                    timeControl.timeEntry(\"setTime\", dateObj);\r\n                    dateControl.attr(\"title\", $(dateControl).val());\r\n                    var inputTimeValue = $(timeControl).val();\r\n                    if (properties.showTime && !bizagi.util.isEmpty(inputTimeValue)) {\r\n                        timeControl.attr(\"title\", inputTimeValue);\r\n                    }\r\n                }\r\n                window.setTimeout(function () {\r\n                    self.checkIcon();\r\n                }, 0);\r\n                return;\r\n            }\r\n\r\n            // Set data in controls\r\n            dateControl.datepicker(\"setDate\", dateObj);\r\n\r\n            if (properties.showTime) {\r\n                timeControl.timeEntry(\"setTime\", dateObj);\r\n                var inputTimeValue = $(timeControl).val();\r\n                if (!bizagi.util.isEmpty(inputTimeValue)) {\r\n                    timeControl.attr(\"title\", inputTimeValue);\r\n                }\r\n            }\r\n            dateControl.attr(\"title\", $(dateControl).val());\r\n\r\n            // Set display value\r\n            properties.displayValue = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            self.checkIcon();\r\n        }\r\n    },\r\n\r\n    // Checks large texts in order to hide the calendar icon or not\r\n    checkIcon: function () {\r\n        var self = this;\r\n        var dateControl = self.getDateControl();\r\n        if (self.getFormContainer())\r\n            if (self.getFormContainer().mode == \"execution\") {\r\n                var displayValue = self.getDateControl().val();\r\n                if (dateControl.width() > 0 && dateControl.width() < 190)\r\n                    if (displayValue.length > 15) {\r\n                        self.dateIcon.hide();\r\n                        dateControl.css(\"padding\", \"1px 5px 1px 4px\");\r\n                    } else {\r\n                        self.dateIcon.show();\r\n                        var currPadding = $(\"input\", self.getControl()).css(\"paddingRight\").replace(\"px\", \"\");\r\n                        if (currPadding > 20 || currPadding == 5) dateControl.css(\"paddingRight\", \"22px\");\r\n                    }\r\n            }\r\n    },\r\n\r\n    removeValidations: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer().parent || self.getFormContainer();\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /*\r\n     *   Focus on the current element\r\n     */\r\n    focus: function (time) {\r\n        // Call base\r\n        this._super(time);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /*\r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function (isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n        var currentDate = dateControl.datepicker(\"getDate\");\r\n        var currentDateString = \"\";\r\n\r\n        if (properties.showTime && timeControl.length > 0) {\r\n            var currentTime = timeControl.timeEntry(\"getTime\");\r\n\r\n            // Merge\r\n            if (currentTime) {\r\n                // If no date has been selected then we need to create a new one to hold the time\r\n                if (currentDate == null)\r\n                    currentDate = new Date();\r\n            } else if (currentDate != null) {\r\n                currentTime = new Date(0, 0, 0, 0, 0, 0, 0);\r\n                self.updatingTime = true;\r\n                timeControl.timeEntry(\"setTime\", \"12:00:00 AM\");\r\n            }\r\n\r\n            currentDate.setHours(currentTime.getHours());\r\n            currentDate.setMinutes(currentTime.getMinutes());\r\n            currentDate.setSeconds(currentTime.getSeconds());\r\n        }\r\n\r\n        if (!currentDate || currentDate == 0) {\r\n            self.checkIcon();\r\n            return;\r\n        }\r\n        //Attemp set the value of the datepicker control. If not valid go back to the previous.\r\n        var previousValue = self.value;\r\n\r\n        //sets the value with the current format date, changed to use the same displayValue method\r\n        if (isNow == true) {\r\n            currentDate = new Date();\r\n            currentDateString = bizagi.util.dateFormatter.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\r\n            self.value = currentDateString;\r\n        } else {\r\n            self.value = bizagi.util.dateFormatter.formatInvariant(currentDate, properties.showTime);\r\n        }\r\n\r\n        var value = self.getValue();\r\n        var objDate = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        if (typeof timeControl.val() != \"undefined\")\r\n            if (timeControl.val().length == 0) {\r\n                timeControl.timeEntry(\"setTime\", objDate);\r\n            }\r\n\r\n        if (isNow || dateControl.val().length > 0) {\r\n            if (!properties.showTime || (properties.showTime && timeControl.val().length > 0)) {\r\n                if (!self.isValid([])) {\r\n                    var oldVal = self.dateControl.val();\r\n                    var oldValTime = null;\r\n                    if (properties.showTime) {\r\n                        oldValTime = self.getTimeControl().val();\r\n                    }\r\n\r\n                    var message = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n\r\n                    message = message.replace(\"{0}\", self.properties.displayName);\r\n\r\n                    if (typeof self.getFormContainer().validationController === \"undefined\")\r\n                        self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n\r\n                    var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n\r\n                    self.removeValidations();\r\n                    validationController.showValidationMessage(message + \" \" + oldVal + (oldValTime ? \" \" + oldValTime : \"\"));\r\n                }\r\n\r\n                self.value = previousValue;\r\n                currentDateString = bizagi.util.dateFormatter.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\r\n\r\n                self.setValue(currentDateString);\r\n                self.setDisplayValue(currentDateString);\r\n            } else {\r\n                self.setValue(previousValue);\r\n                self.setDisplayValue(previousValue);\r\n            }\r\n        }\r\n\r\n        // Set display value\r\n        properties.displayValue = bizagi.util.dateFormatter.formatDate(currentDate, properties.fullFormat, self.i18n);\r\n        self.checkIcon();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop queryDate\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.date.extend(\"bizagi.rendering.desktop.queryDate\", {}, {\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        var queryValue = null;\r\n        var changed = self.controlValueIsChanged();\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\" && value!==\"\") {\r\n                queryValue=value;\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n                var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                searchType = searchType.toUpperCase();\r\n                renderValues.push({ \"value\": queryValue, \"included\": self.properties.included, \"xpath\": properties.xpath, \"searchType\": searchType, \"orderType\": \"NONE\" });\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.yesno\", bizagi.rendering.yesno.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.yesno.extend(\"bizagi.rendering.desktop.yesno\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var control = this.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Remove data for cell refresh\r\n        if (control[0]) {\r\n            $.removeData(control[0]);\r\n        }\r\n\r\n        // Apply plugins\r\n        control.optiongroup({orientation: this.properties.orientation});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind change event\r\n        control.bind(\"optiongroupchange\", function (evt, ui) {\r\n            // Only change the internal value when it truly changes\r\n            if (bizagi.util.parseBoolean(self.value) !== bizagi.util.parseBoolean(ui.value)) {\r\n                self.setValue(ui.value);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var control = this.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var control = this.getControl();\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in control\r\n        if (value != null && this.properties.editable) {\r\n            var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n            if (parsedValue != null) {\r\n                control.optiongroup(\"setValue\", parsedValue.toString());\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        this.setDisplayValue(value);\r\n        this.setValue(value, false);\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var selectedItem = this.element.find(\".ui-radio-state-checked\");\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Desktop Render Check Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Check render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.check\", bizagi.rendering.check.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.check.extend(\"bizagi.rendering.desktop.check\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = $control.find(\"label\");\r\n        this.performStyles();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.input = $control.find(\"label\");\r\n\r\n        if (!this.properties.showLetters) {\r\n            this.performStyles();\r\n\r\n            // Set as disabled\r\n            var check = $(\"input\", $control);\r\n            check.attr(\"readonly\", \"readonly\");\r\n            check.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var html = \"\";\r\n\r\n        if (!this.properties.showLetters) {\r\n            html = this._super();\r\n        } else {\r\n            var template = this.renderFactory.getTemplate(\"readonly\");\r\n            var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n            // Render template\r\n            html = $.fasttmpl(template, {\r\n                id: randomId,\r\n                editable: this.properties.editable\r\n            });\r\n        }\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            self.input.bind(\"checkchange\", function (evt, ui) {\r\n                self.setValue(ui.value);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            self.input.bind(\"change\", function (evt, ui) {\r\n                var value = $(\"input\", self.input).is(\":checked\");\r\n\r\n                self.setValue(value);\r\n                self.setDisplayValue(value);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var $control = this.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        $control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n        // Call base\r\n        this._super(parsedValue);\r\n\r\n        if (!this.properties.showLetters) {\r\n\r\n            if (!bizagi.util.isIE()) {\r\n                // PLUGIN IMPLEMENTATION\r\n                if (parsedValue === true) {\r\n                    self.input.check(\"checkItem\");\r\n                } else {\r\n                    self.input.check(\"uncheckItem\");\r\n                }\r\n            } else {\r\n                // NON PLUGIN IMPLEMENTATION\r\n                if (parsedValue === true) {\r\n                    self.input.addClass(\"ui-checkbox-state-checked\");\r\n                    $(\"input\", self.input).attr(\"checked\", \"checked\");\r\n                } else {\r\n                    self.input.removeClass(\"ui-checkbox-state-checked\");\r\n                    $(\"input\", self.input).removeAttr(\"checked\");\r\n                }\r\n            }\r\n        } else {\r\n            self.input.val((this.getDisplayValue()));\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setDisplayValue(false);\r\n        this.setValue(false, false);\r\n    },\r\n\r\n    /**\r\n     * Modify styles\r\n     */\r\n    performStyles: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        $control.addClass(\"ui-bizagi-render-display-block\");\r\n        $control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        if (self.properties.required) {\r\n            $(\".ui-bizagi-render-control-required\", $control).css({height: \"22px\"});\r\n        }\r\n\r\n        // Apply plugins\r\n        if (!bizagi.util.isIE()) {\r\n            // JUST FOR NON IE-BROWSERS\r\n            self.input.check();\r\n        } else {\r\n            $control.removeClass();\r\n            $control.addClass(\"ui-bizagi-render-control ui-bizagi-render-boolean-yesno-ie\");\r\n            $control.find(\"label\").addClass(\"checkbox-ie\");\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        //this is required Just to avoid change the font size in this control\r\n        if (isLabelFormat) {\r\n            this._super(size, isLabelFormat);\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Combo Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the combo render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.combo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.combo.extend(\"bizagi.rendering.desktop.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // ON desktop implementation we will load the async combos on demand\r\n        properties.loadOnDemand = true;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        this.inputCombo = $(\".ui-selectmenu-value\", this.getControl());\r\n        this.selectedValue = this.properties.value;\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self.inputCombo.focus(function () {\r\n            $(this).select();\r\n        });\r\n\r\n        self.inputCombo.blur(function (e) {\r\n            if (!self.isExtraItem()) self.setDisplayValue(self.value);\r\n        });\r\n\r\n        //Triggered only when the form exists inside a dialog and is performed the maximize action\r\n        self.getFormContainer().bind(\"maximazedForm unmaximazedForm\", function () {\r\n            self.resizeCombo();\r\n        });\r\n\r\n        self.inputCombo.click(function () {\r\n            var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n\r\n            if ($(\"#\" + idDropdown, self.getControl().parent()).length === 0) {\r\n                self.comboDropDown();\r\n            } else {\r\n                // Close combo if clicked twice\r\n                self.dropDownDestroy($(\"#\" + idDropdown));\r\n            }\r\n            self.inputCombo.focus();\r\n        });\r\n\r\n        // Bind clicks to fake UI in order to simulate select clicks\r\n        if ($(\".ui-selectmenu-btn\", self.control).length > 1 && typeof window.addEventListener != \"undefined\") {\r\n            $(\".ui-selectmenu-btn\", self.control)[0].addEventListener(\"click\", function () {\r\n                self.inputCombo[0].click();\r\n            });\r\n        } else {\r\n            $(\".ui-selectmenu-btn\", self.control).bind(\"click.combo\", function () {\r\n                self.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n\r\n        self.inputCombo.keyup(function (e) {\r\n            self.keyUpFunction(e);\r\n        });\r\n\r\n        self.inputCombo.keydown(function (e) {\r\n            self.keyDownFunction(e);\r\n        });\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    /*\r\n    *   Makes the combo drops down, also fetch the data first if the combo is set to load on demand\r\n    */\r\n    comboDropDown: function () {\r\n        var self = this;\r\n\r\n        self.showLoadingData();\r\n\r\n        $.when(self.getData()).done(function (data) {\r\n            self.hideLoadingData();\r\n\r\n            try {\r\n                self.internalComboDropDown(data);\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Show loading message\r\n    */\r\n    showLoadingData: function () {\r\n        var self = this;\r\n        var body = $(\"body\", document);\r\n        var loading = (self.loading = $(\"<div class='ui-select-dropdown open loading'><ul><li class='ui-bizagi-render-loading ui-bizagi-loading'></li></ul></div>\"));\r\n\r\n        // Add width\r\n        loading.css(\"width\", self.inputCombo.outerWidth() + \"px\");\r\n        $(\"li\", loading).css({padding: 0, margin: 0});\r\n        loading.css(\"overflow\", \"hidden\");\r\n        loading.appendTo(body);\r\n        loading.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: self.inputCombo,\r\n            collision: \"none flip\"\r\n        });\r\n    },\r\n    /*\r\n    *   Remove loading message\r\n    */\r\n    hideLoadingData: function () {\r\n        this.loading.remove();\r\n    },\r\n    /*\r\n    *   Draws the mini-popup\r\n    */\r\n    internalComboDropDown: function (data) {\r\n        var self = this;\r\n        var selectTmp = {};\r\n        var objSelected = {};\r\n\r\n        // Remove the old list\r\n        $(\".ui-select-dropdown.open\").remove();\r\n\r\n        /** temp templates **/\r\n        var tempCombo = \"<ul>\" +\r\n            \"   {{each datasource}}{{if typeof hidden == 'undefined'}}\" +\r\n            \"       <li data-value='${id}'>${value}</li>{{/if}}\" +\r\n            \"   {{/each}}\" +\r\n            \"</ul>\";\r\n\r\n        var containerDropdown = $(\"<div class='ui-select-dropdown open bz-combo__list--comfortable'></div>\");\r\n\r\n        /* control reference */\r\n        var containerControl = self.inputCombo.parents(\".ui-bizagi-control\").last();\r\n        var containerRender = containerControl.closest(\".ui-bizagi-render\");\r\n\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var selectedValue = self.findDataByValue(self.inputCombo.val());\r\n        var scrollPosition = 0;\r\n        var orientation = self.properties.orientation === \"rtl\" ? \"ui-bizagi-rtl\" : \"\";\r\n\r\n        //fix for QA-507 only IE\r\n        if (navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.appVersion.indexOf(\"Trident/\") > 0) {\r\n            var contFormScroll = containerRender.closest(\".ui-dialog-content\");\r\n            if (contFormScroll.length > 0) {\r\n                contFormScroll.css(\"overflow-y\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        data = data || self.properties.data;\r\n\r\n        self.properties.data = data;\r\n\r\n        self.repositionInterval;\r\n        containerRender.addClass(\"ac-is-visible\");\r\n        containerControl.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n        containerDropdown.attr(\"id\", idDropdown);\r\n\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i].value !== null && typeof (data[i].value) == \"boolean\") {\r\n                if (bizagi.util.parseBoolean(data[i].value) === true) {\r\n                    data[i].value = this.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(data[i].value) === false) {\r\n                    data[i].value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n        }\r\n\r\n        if (data.length > 1000) {\r\n            selectTmp = self.getResource(\"render-combo-too-many-elements\");\r\n        } else {\r\n            selectTmp = $.tmpl(tempCombo, {datasource: data});\r\n        }\r\n\r\n        var dropDwn = containerDropdown.append(selectTmp);\r\n        containerControl.append(dropDwn);\r\n\r\n        var objParent = $(\".ui-selectmenu\", self.control);\r\n        $(dropDwn).find(\"li:last-child\").css(\"padding-bottom\", \"13px\");\r\n\r\n        var widthChild = dropDwn.width();\r\n        var widthControl = objParent.width();\r\n\r\n        dropDwn.width(widthControl < widthChild ? widthChild : widthControl);\r\n\r\n        dropDwn.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: $(\".ui-selectmenu\", self.control),\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        dropDwn.show();\r\n\r\n        // Fix for QA-507 only IE\r\n        if ((navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.appVersion.indexOf(\"Trident/\") > 0) && contFormScroll.length > 0) {\r\n            contFormScroll.css(\"overflow-y\", \"auto\");\r\n        }\r\n\r\n        //SUITE 9379 - ComboBox offset in resizing when the combobox is opened\r\n        self.recalculateComboOffset(dropDwn, objParent);\r\n\r\n        dropDwn.data(\"formWidth\", containerControl.width());\r\n        dropDwn.data(\"parentCombo\", self.control);\r\n\r\n        dropDwn.addClass(orientation);\r\n\r\n        if (selectedValue !== -1 && $(\"li\", dropDwn).length > 0) {\r\n            //Checks if the selected element is empty string, it's normal for cascading combos\r\n            if (selectedValue && selectedValue.id === \"\") {\r\n                objSelected = $(\"li[data-value='']\", dropDwn);\r\n            } else {\r\n                objSelected = $(\"li[data-value='\" + selectedValue.id + \"']\", dropDwn);\r\n            }\r\n\r\n            if (objSelected.length !== 0) {\r\n                objSelected.addClass(\"ui-selected\");\r\n                objSelected.addClass(\"active\");\r\n\r\n                scrollPosition = parseInt(objSelected.position().top);\r\n                dropDwn.scrollTop(scrollPosition);\r\n            }\r\n        }\r\n\r\n        dropDwn.delegate(\"li\", \"click\", function () {\r\n            var valId = $(this).data(\"value\") ? $(this).data(\"value\") : \"\";\r\n            var val = {id: valId, value: $(this).text()};\r\n\r\n            //Prevents stores the value twice when the element seached match with the clicked\r\n            //It helps to keep track the last selected\r\n            var id = self.getValue();\r\n            id = id && id.id ? id.id : 0;\r\n\r\n            if (val.id !== id) {\r\n                self.onComboItemSelected(val);\r\n            } else {\r\n                if (val.value !== self.inputCombo.val()) {\r\n                    self.setDisplayValue({value: val.value});\r\n                }\r\n            }\r\n\r\n            //'select' will stand at first character of the string, 'focus' will stand at the last character of the string\r\n            self.inputCombo.select();\r\n\r\n            // Animation effect\r\n            dropDwn.hide();\r\n            self.dropDownDestroy(dropDwn);\r\n\r\n            $(document).unbind(\"click.closecombo\");\r\n        });\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $.makeArray(dropDwn, self.getControl()).bind(\"click\", function (e) {\r\n            e.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        $(document).one(\"click.closecombo\", function (e) {\r\n            var tg = $(e.target);\r\n            self.dropDownValidClose(tg, dropDwn);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * validate when fire event form document and window\r\n     */\r\n    dropDownValidClose: function (target, dropDown) {\r\n        dropDown.hide();\r\n        this.dropDownDestroy(dropDown);\r\n        $(document).unbind(\"click.closecombo\");\r\n    },\r\n    /*\r\n     * set a new dropdown position\r\n     */\r\n    dropDownReposition: function (dropDown, containerForm) {\r\n        var self = this;\r\n        if (containerForm.width() != dropDown.data(\"formWidth\")) {\r\n            var objParent = $(\".ui-selectmenu\", self.control);\r\n            dropDown.width(self.control.width() < 100 ? 100 : objParent.width());\r\n\r\n            var control = dropDown.data(\"parentCombo\") || objParent;\r\n            dropDown.position({\r\n                my: \"left top\",\r\n                at: \"left bottom\",\r\n                of: $(\".ui-selectmenu-value\", control),\r\n                collision: \"none\"\r\n            });\r\n\r\n            dropDown.data(\"formWidth\", containerForm.width());\r\n        }\r\n    },\r\n    /*\r\n     * destroy dropdown\r\n     */\r\n    dropDownDestroy: function (dropDown) {\r\n        var self = this;\r\n        var control = self.inputCombo ? self.inputCombo : $(\".ui-selectmenu-value\", self.getControl());\r\n        var containerControl = control.closest(\".ui-bizagi-control\");\r\n        var containerRender = containerControl.closest(\".ui-bizagi-render\");\r\n\r\n        // fix for SUITE-9507\r\n        if (containerControl.hasClass(\"ac-is-visible\")) containerControl.removeClass(\"ac-is-visible\");\r\n        if (containerControl.hasClass(\"ac-clear-floats\")) containerControl.removeClass(\"ac-clear-floats\");\r\n        if (containerRender.hasClass(\"ac-is-visible\")) containerRender.removeClass(\"ac-is-visible\");\r\n\r\n        dropDown.remove();\r\n\r\n        $(document).unbind(\"mousedown.closecombo\");\r\n        $(document).unbind(\"mouseup.resizecombo\");\r\n        $(window).unbind(\"resize.resizecombo\");\r\n        $(window).unbind(\"mouseup.closecombo\");\r\n\r\n        if (self.repositionInterval) clearInterval(self.repositionInterval);\r\n    },\r\n\r\n    validateValueInDatasource: function (triggerEvents, isKeyByKey) {\r\n        var self = this;\r\n        var selected = self.inputCombo.val();\r\n        var selectedKey = self.findDataByValue(selected, isKeyByKey);\r\n\r\n        if (!self.value) {\r\n            self.value = {id: \"\"};\r\n        }\r\n\r\n        if (selectedKey.id > 0) {\r\n            if (!triggerEvents) {\r\n                self.setValue({id: selectedKey.id}, false);\r\n                self.setDisplayValue(selectedKey);\r\n            } else {\r\n                self.setValue({id: selectedKey.id});\r\n                self.setDisplayValue(selectedKey);\r\n            }\r\n        } else if (selectedKey.id === \"\") {\r\n            if (self.value.id != selectedKey.id) {\r\n                self.setValue(selectedKey, false);\r\n            }\r\n            self.setDisplayValue(selectedKey);\r\n        } else {\r\n            self.setDisplayValue(self.selectedValue);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Keydown listener\r\n     */\r\n    keyDownFunction: function (e) {\r\n        var self = this;\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n        var active = $(\"li.active\", dropDown);\r\n\r\n        e = e ? e : window.event;\r\n\r\n        // Need to implement hiding select on \"Escape\" and \"Enter\".\r\n        if (e.altKey || e.ctrlKey || e.metaKey) {\r\n            return 1;\r\n        }\r\n\r\n        if (dropDown.length === 0 && !self.properties.data) {\r\n            self.comboDropDown(self.combo);\r\n            dropDown = $(\"#\" + idDropdown);\r\n        }\r\n\r\n        //Tab or Shift + Tab\r\n        if ((e.shiftKey && e.keyCode == 9) || e.keyCode == 9) {\r\n            if (active.length > 0) {\r\n                self.inputCombo.val(active.text());\r\n            }\r\n            self.focusDependant = true;\r\n            self.validateValueInDatasource(true, true);\r\n            dropDown.remove();\r\n            return 1;\r\n            //return 0;\r\n        }\r\n\r\n        if (27 == e.keyCode) {\r\n            self.setDisplayValue(self.selectedValue);\r\n            dropDown.remove();\r\n        }\r\n\r\n        if (9 == e.keyCode || 13 == e.keyCode) {\r\n            if (active.length > 0) {\r\n                self.inputCombo.val(active.text());\r\n            }\r\n            self.validateValueInDatasource(true, true);\r\n            dropDown.remove();\r\n            return 1;\r\n        }\r\n\r\n        if (e.keyCode == \"38\" || e.keyCode == \"37\") {\r\n            // up arrow\r\n            self.selectPreviousElement(dropDown);\r\n            return 0;\r\n        } else if (e.keyCode == \"40\" || e.keyCode == \"39\") {\r\n            // down arrow\r\n            self.selectNextElement(dropDown);\r\n            return 0;\r\n        }\r\n\r\n        if (e.keyCode == 36) {\r\n            self.selectFirstElement(dropDown);\r\n            return 0;\r\n        } else if (e.keyCode == 35) {\r\n            self.selectLastElement(dropDown);\r\n            return 0;\r\n        }\r\n\r\n        self.properties.enableTyping = typeof bizagi.override.typingForCombos == \"boolean\" ? bizagi.override.typingForCombos : self.properties.enableTyping;\r\n\r\n        if (!self.properties.enableTyping) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            return false;\r\n        }\r\n        return 1;\r\n    },\r\n\r\n    /*\r\n     *   KeyUp listener\r\n     */\r\n    keyUpFunction: function (e) {\r\n        var self = this;\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n\r\n        e = e ? e : window.event;\r\n\r\n        if (\r\n            e.altKey ||\r\n            e.ctrlKey ||\r\n            e.metaKey ||\r\n            50 == e.keyCode ||\r\n            13 == e.keyCode ||\r\n            9 == e.keyCode ||\r\n            27 == e.keyCode ||\r\n            e.keyCode == 16 ||\r\n            e.keyCode == 36 ||\r\n            e.keyCode == 35 ||\r\n            e.keyCode == 33 ||\r\n            e.keyCode == 34\r\n        ) {\r\n            return 0;\r\n        }\r\n\r\n        if (dropDown.length === 0) {\r\n            self.comboDropDown(self.combo);\r\n            dropDown = $(\"#\" + idDropdown);\r\n        }\r\n\r\n        var isSelectingItem = false;\r\n        if (e.keyCode >= 37 && e.keyCode <= 40) {\r\n            // Keyboard Arrows\r\n            isSelectingItem = true;\r\n        }\r\n        self.selectItemByKeyUp(isSelectingItem);\r\n\r\n        return 1;\r\n    },\r\n    /*\r\n     * Select letter by letter\r\n     */\r\n    selectItemByKeyUp: function (isSelectingItem) {\r\n        var self = this,\r\n            objSelected;\r\n\r\n        if (bizagi.util.parseBoolean(isSelectingItem) == null) {\r\n            isSelectingItem = false;\r\n        }\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n\r\n        $(\".active\", dropDown).removeClass(\"active\");\r\n\r\n        var selectedKey = self.findDataByValue(self.inputCombo.val(), true, isSelectingItem);\r\n        if (selectedKey !== -1) {\r\n            objSelected = $(\"li[data-value='\" + selectedKey.id + \"']\", dropDown);\r\n            objSelected.addClass(\"active\");\r\n        } else {\r\n            objSelected = $(\"li.ui-selected\", dropDown);\r\n        }\r\n\r\n        if (dropDown.length > 0 && objSelected.length > 0) {\r\n            scrollPosition = parseInt(objSelected.position().top);\r\n            dropDown.scrollTop(scrollPosition);\r\n        }\r\n    },\r\n\r\n    selectFirstElement: function (dropDown) {\r\n        var self = this;\r\n        var actual = $(\"li:first\", dropDown);\r\n\r\n        $(\"li\", dropDown).removeClass(\"active\");\r\n        actual.addClass(\"active\");\r\n        scrollPosition = actual.position().top;\r\n        dropDown.scrollTop(scrollPosition);\r\n\r\n        self.inputCombo.val($(actual).text());\r\n    },\r\n\r\n    selectLastElement: function (dropDown) {\r\n        var self = this;\r\n        var actual = $(\"li:last\", dropDown);\r\n\r\n        $(\"li\", dropDown).removeClass(\"active\");\r\n        actual.addClass(\"active\");\r\n        scrollPosition = actual.position().top;\r\n        dropDown.scrollTop(scrollPosition);\r\n\r\n        self.inputCombo.val($(actual).text());\r\n    },\r\n\r\n    /*\r\n     * Handler key Up\r\n     */\r\n    selectPreviousElement: function (dropDown) {\r\n        var self = this;\r\n        var scrollPosition = 0;\r\n        var actual = $(\"li.active\", dropDown);\r\n\r\n        if (actual.length === 0) {\r\n            actual = $(\"li:first\", dropDown);\r\n        }\r\n\r\n        var previous = actual.prev();\r\n\r\n        if (previous.length !== 0) {\r\n            actual.removeClass(\"active\");\r\n            $(previous).addClass(\"active\");\r\n            scrollPosition = $(previous).position().top;\r\n\r\n            dropDown.scrollTop(scrollPosition);\r\n            self.inputCombo.val($(previous).text());\r\n        }\r\n    },\r\n\r\n    /*\r\n     *Handler key Down\r\n     */\r\n    selectNextElement: function (dropDown) {\r\n        var self = this;\r\n        var scrollPosition = 0;\r\n        var actual = $(\"li.active\", dropDown);\r\n\r\n        if (actual.length === 0) actual = $(\"li:first\", dropDown);\r\n\r\n        var next = actual.next();\r\n\r\n        if (next.length !== 0) {\r\n            actual.removeClass(\"active\");\r\n            $(next).addClass(\"active\");\r\n            scrollPosition = $(next).position().top;\r\n\r\n            dropDown.scrollTop(scrollPosition);\r\n            self.inputCombo.val($(next).text());\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Handler to react when a combo item is selected\r\n     */\r\n    onComboItemSelected: function (val) {\r\n        var self = this;\r\n        var selectedId = val.id || \"\";\r\n        var selectedLabel = val.value || \"\";\r\n\r\n        self.properties.originalValue = self.getValue();\r\n\r\n        if (selectedId === \"\") {\r\n            self.inputCombo.val(\"\");\r\n        } else {\r\n            self.inputCombo.val(selectedLabel);\r\n        }\r\n\r\n        self.setValue({id: selectedId});\r\n        self.setDisplayValue({id: selectedId, value: selectedLabel});\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var comboValue = \"\";\r\n        var comboValueValid = true;\r\n        var control;\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (properties.editable && value !== null) {\r\n            // If set display value were assigned from render action\r\n            if (typeof value === \"object\" && value.label !== undefined) {\r\n                var id = bizagi.util.isNumeric(value.id) ? value.id : value.value;\r\n                                \r\n                var displayValue = value.label;\r\n\r\n                if (!bizagi.util.isString(displayValue) && bizagi.util.isString(value.value)) {\r\n                    displayValue = value.value;\r\n                }\r\n\r\n                comboValue = self.findDataById(id).value || value.label;\r\n                self.setValue({id: id, value: displayValue });\r\n                \r\n            } else {\r\n                if (typeof value === \"number\" || typeof value === \"string\" || value.id) {\r\n                    if (value.id) {\r\n                        var translated = false; //When the parametric entity have a boolean attribute\r\n                        if (value.value != null && typeof value.value === \"boolean\") {\r\n                            translated = true;\r\n                            if (bizagi.util.parseBoolean(value.value) === true) {\r\n                                value.value = this.getResource(\"render-boolean-yes\");\r\n                            } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                                value.value = this.getResource(\"render-boolean-no\");\r\n                            }\r\n                        } else if (value.value != null && typeof value.value === \"object\") {\r\n                            for (var i = 0; i < value.value.length; i++) {\r\n                                if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                                    if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                                        value.value[i] = this.getResource(\"render-boolean-yes\");\r\n                                    } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                                        value.value[i] = this.getResource(\"render-boolean-no\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        if (translated) {\r\n                            comboValue = value.value;\r\n                        } else {\r\n                            comboValue = self.findDataById(value.id).value || value.value;\r\n                        }\r\n                    } else {\r\n                        comboValue = self.findDataById(Number(value)).value || value.label;\r\n                    }\r\n                } else {\r\n                    comboValue = typeof value.value == \"object\" ? value.value.join(\" - \") : value.value;\r\n                }\r\n\r\n                if (properties.hasLocalData || properties.remoteDataLoaded) {\r\n                    comboValueValid = self.findDataByValue(comboValue);\r\n                    if (comboValueValid === -1) {\r\n                        comboValue = \"\";\r\n                    }\r\n                }\r\n\r\n                if (value && value.id) {\r\n                    // Check if the value is a json object\r\n                    if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id > 0) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n                        if (self.value.id != value.id) {\r\n                            self.setValue({id: value.id});\r\n                        }\r\n                    } else {\r\n                        if (self.value.id != value) {\r\n                            self.setValue({id: value});\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if ($.isArray(comboValue)) {\r\n                comboValue = comboValue.join(\" - \");\r\n            }\r\n            if (self.inputCombo) {\r\n                self.inputCombo.val(comboValue);\r\n                $(self.inputCombo).attr(\"title\", comboValue);\r\n            } else {\r\n                control = $(\".ui-selectmenu-value\", self.getControl());\r\n                control && control.val(comboValue);\r\n            }\r\n        } else {\r\n            if (!properties.editable && value !== null) {\r\n                if (typeof value === \"number\" || typeof value === \"string\") {\r\n                    comboValue = self.findDataById(Number(value)).value;\r\n                    control = self.getControl();\r\n                    control.html(\r\n                        \"<label class='readonly-control'>\" +\r\n                        self.escapeValue(self.formatItem(comboValue)) +\r\n                        \"</label>\"\r\n                    );\r\n                } else {\r\n                    if (typeof value === \"object\") {\r\n\r\n                        if (value.label !== undefined) {\r\n                            id = bizagi.util.isNumeric(value.id) ? value.id : value.value;\r\n                            \r\n                            comboValue = self.findDataById(id).value || value.label;\r\n\r\n                            if ($.isArray(comboValue)) {\r\n                                comboValue = comboValue.join(\" - \");\r\n                            }\r\n\r\n                            self.setValue({id: id, value: comboValue});\r\n                        } else {\r\n                            self.setValue({id: value.id, value: value.value});\r\n                        }\r\n\r\n                        self.control.html(\r\n                            \"<label class='readonly-control'>\" +\r\n                            self.escapeValue(self.formatItem(value.label || value.value)) +\r\n                            \"</label>\"\r\n                        );\r\n                    }\r\n                }\r\n            } else {\r\n                if (value === null && properties.editable) {\r\n                    var emptySelection = self.getResource(\"render-combo-empty-selection\");\r\n                    self.inputCombo.val(emptySelection);\r\n                    $(self.inputCombo).attr(\"title\", \"\");\r\n                } else {\r\n                    if (value === null && !properties.editable) {\r\n                        self.getControl().text(\"\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.inputCombo) {\r\n            var emptySelection = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n            self.inputCombo.val(emptySelection);\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n\r\n        self.value = self.properties.value = self.selectedValue;\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        this.value = this.properties.value = this.selectedValue = {id: \"\", value: \"\"};\r\n        this.clearDisplayValue();\r\n    },\r\n    /*\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n    /*\r\n     *   Find elements within a data source\r\n     */\r\n    findDataById: function (id) {\r\n        var result = (this.properties.data || []).find(function (value) {\r\n            return value.id == id;\r\n        }) || {};\r\n\r\n        return result;\r\n    },\r\n\r\n    findDataByValue: function (val, keyByKey, equalsToValue) {\r\n        var self = this;\r\n        var result = -1;\r\n\r\n        if (val !== undefined && val !== null && self.properties.data != undefined) {\r\n            if (keyByKey) {\r\n                var value;\r\n                var tvalue;\r\n                var nValue;\r\n                var compareValIn;\r\n                var compareVal;\r\n                var i = -1;\r\n                var dataLength = self.properties.data.length - 1;\r\n\r\n                while (i++ < dataLength) {\r\n                    value = self.properties.data[i];\r\n\r\n                    compareValIn =\r\n                        typeof val == \"object\" ? val.join(\" - \") : typeof val === \"boolean\" ? val.toString() : val;\r\n                    compareVal = $.trim(compareValIn)\r\n                        .substring(0, compareValIn.length)\r\n                        .toLowerCase();\r\n\r\n                    if (typeof value === \"object\" && typeof value.value === \"object\") {\r\n                        tvalue = typeof value.value == \"object\" ? value.value.join(\" - \") : value.value;\r\n                    } else {\r\n                        tvalue = $.trim(value.value);\r\n                    }\r\n\r\n                    nValue = String(tvalue).toLowerCase();\r\n\r\n                    if (equalsToValue) {\r\n                        if (nValue == compareVal && nValue.length == compareVal.length) {\r\n                            result = {id: value.id, value: value.value};\r\n                            i = dataLength;\r\n                        }\r\n                    } else {\r\n                        // Search item by Begin\r\n                        if (nValue.indexOf(compareVal) == 0) {\r\n                            result = {id: value.id, value: value.value};\r\n                            i = dataLength;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                if (self.getValue()) {\r\n                    result = self.getValue();\r\n\r\n                    if (!result.value) {\r\n                        result.value = self.inputCombo.val();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n\r\n        if (val === null) val = {id: \"\"};\r\n\r\n        if (!!val) {\r\n            var id = typeof val === \"object\" ? self.getValueFromData(val.id) || \"\" : typeof val === \"number\" || typeof val === \"string\" ? self.getValueFromData(val) : \"\";\r\n            var label = (typeof val.value !== \"undefined\" && val.value !== null) ? val.value : (self.findDataById(id).value || \"\");\r\n            self.selectedValue = {id: id, value: label};\r\n            this._super(self.selectedValue, triggerEvents);\r\n        }\r\n    },\r\n\r\n    getValueFromData: function (dataValue) {\r\n        var value = Number(dataValue);\r\n        if (isNaN(value)) value = dataValue;\r\n        return value;\r\n    },\r\n\r\n    recalculateComboOffset: function (dropDwn, objParent) {\r\n        if (bizagi.util.isIE() && bizagi.util.getInternetExplorerVersion() == 9) {\r\n            if (dropDwn.width() !== objParent.width()) {\r\n                var offset = objParent.width() - dropDwn.width();\r\n                dropDwn.width(objParent.width() + offset);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Workaround: Action isn't a parameter is temporally\r\n     * TODO: Fix after Genome\r\n     * @param {} action\r\n     * @returns {}\r\n     */\r\n    resizeCombo: function () {\r\n        var selectMenu = $(\".ui-selectmenu\", this.control);\r\n        var dropDwn = $(\".ui-select-dropdown.open\", this.element);\r\n        var widthControl = selectMenu.width();\r\n\r\n        if (dropDwn && dropDwn.get(0) && dropDwn.width() !== widthControl) {\r\n            dropDwn.width(widthControl);\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    }\r\n});\r\n\r\n// We override original select menu refresh position method to adjust custom stuff\r\nvar originalRefreshPositionMethod = $.ui.selectmenu.prototype._refreshPosition;\r\n$.ui.selectmenu.prototype._refreshPosition = function () {\r\n\r\n    // Set initial heigth to zero\r\n    this.list.height(0);\r\n\r\n    // Call original method\r\n    var result = originalRefreshPositionMethod.apply(this, arguments);\r\n\r\n    // Return original response\r\n    this.list.css(\"width\", this.newelement.width() + \"px\");\r\n    return result;\r\n};\r\n","/**\r\n *   Name: Bizagi Desktop Render Cascading combo Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the cascading combo render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.cascadingCombo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.cascadingCombo\", bizagi.rendering.cascadingCombo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.postRender.apply(self, arguments);\r\n        self.processLayout(false, self.properties.valueFormat || {});\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.configureHandlers.apply(this, arguments);\r\n    },\r\n\r\n    comboDropDown: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.comboDropDown.apply(this, arguments);\r\n    },\r\n\r\n    showLoadingData: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.showLoadingData.apply(this, arguments);\r\n    },\r\n\r\n    hideLoadingData: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.hideLoadingData.apply(this, arguments);\r\n    },\r\n\r\n    internalComboDropDown: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.internalComboDropDown.apply(this, arguments);\r\n    },\r\n\r\n    resizeCombo: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.resizeCombo.apply(this, arguments);\r\n    },\r\n\r\n    validateValueInDatasource: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.validateValueInDatasource.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Keydown listener\r\n    */\r\n    keyDownFunction: function (e) {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.keyDownFunction.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   KeyUp listener\r\n    */\r\n    keyUpFunction: function (e) {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.keyUpFunction.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Select letter by letter\r\n    */\r\n    selectItemByKeyUp: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectItemByKeyUp.apply(this, arguments);\r\n    },\r\n\r\n    selectFirstElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectFirstElement.apply(this, arguments);\r\n    },\r\n\r\n    selectLastElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectLastElement.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Handler key Up\r\n    */\r\n    selectPreviousElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectPreviousElement.apply(this, arguments);\r\n    },\r\n    /*\r\n    *Handler key Down\r\n    */\r\n    selectNextElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectNextElement.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    clearDisplayValue: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.clearDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n        // Call desktop.combo method\r\n        return bizagi.rendering.desktop.combo.prototype.getSelectedValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Handler to react when a combo item is selected\r\n    */\r\n    onComboItemSelected: function () {\r\n        this.itemSelected = true;\r\n        // Call desktop.combo method\r\n        return bizagi.rendering.desktop.combo.prototype.onComboItemSelected.apply(this, arguments);\r\n    },\r\n\r\n    postRenderPrintVersion: function () {\r\n        var control = this.getControl();\r\n\r\n        control.empty();\r\n        control.append(this.value.value);\r\n    },\r\n\r\n    /*\r\n    * validate when fire event form document and window\r\n    */\r\n    dropDownValidClose: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownValidClose.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * set a new dropdown position\r\n    */\r\n    dropDownReposition: function (dropDown, containerForm) {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownReposition.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * destroy dropdown\r\n    */\r\n    dropDownDestroy: function (dropDown) {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownDestroy.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Find elements within a data source\r\n    */\r\n    findDataById: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.findDataById.apply(this, arguments);\r\n    },\r\n\r\n    findDataByValue: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.findDataByValue.apply(this, arguments);\r\n    },\r\n\r\n    recalculateComboOffset: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.recalculateComboOffset.apply(this, arguments);\r\n    },\r\n\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (val === '') {\r\n            val = {id: \"\", value: \"\"};\r\n        }\r\n\r\n        if (!!val) {\r\n            var id = val.id || \"\";\r\n            var label = val.value || self.findDataById(id).value;\r\n\r\n            self.selectedValue = {id: id, value: label};\r\n\r\n            if (!self.internalSetInitialValueFlag) {\r\n                if (self.value === null || self.value.id !== val.id) {\r\n                    self.triggerHandler(\"select\", [{id: id, value: label}, false]);\r\n                }\r\n            }\r\n\r\n            this._super(self.selectedValue, triggerEvents);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.value = self.properties.value = self.selectedValue = {id: \"\", value: \"\"};\r\n        self.setValue(self.value, false);\r\n        self.setDisplayValue(self.value);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequired.apply(this, arguments);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequiredLabel.apply(this, arguments);\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequiredControl.apply(this, arguments);\r\n    }\r\n});\r\n\r\n// We override original select menu refresh position method to adjust custom stuff\r\nvar originalRefreshPositionMethod = $.ui.selectmenu.prototype._refreshPosition;\r\n$.ui.selectmenu.prototype._refreshPosition = function () {\r\n    // Set initial height to zero\r\n    this.list.height(0);\r\n\r\n    // Call original method\r\n    var result = originalRefreshPositionMethod.apply(this, arguments);\r\n\r\n    // Return original response\r\n    this.list.css(\"width\", this.newelement.width() + \"px\");\r\n    return result;\r\n};\r\n","/*\r\n*   Name: BizAgi Desktop querycombo\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.combo.extend(\"bizagi.rendering.desktop.queryCombo\", {}, {\r\n    /*\r\n     *  configure Handlers for check, column included in the response\r\n     */\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Desktop queryCascadingCombo\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -\r\n */\r\n\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.queryCascadingCombo\", {}, {\r\n    /*\r\n     *  configure Handlers for check, column included in the response\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n        self.properties.contexttype = self.properties.contexttype || \"metadata\";\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        if (self.parentCombo !== null && self.isDependant) {\r\n            self.parentCombo.isRendered().done(function () {\r\n                $(\".ui-bizagi-render-control-included\", self.parentCombo.getRenderedElement()).hide();\r\n            });\r\n        }\r\n\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo !== null) {\r\n            if (parentCombo.properties.type === \"queryCascadingCombo\") {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Bind the combos to create the cascading feature\r\n     */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check it is a cascading combo\r\n        if (dependantCombo.properties.type === \"queryCascadingCombo\") {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n\r\n                self.refreshDependantCombo(dependantCombo, item.id, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *  Method to determine if the render value can be sent to search\r\n     */\r\n    canBeSentQueryForm: function () {\r\n        return true;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render CollectionNavigator\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for collection navigator renders\r\n*/\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.collectionnavigator\", bizagi.rendering.collectionnavigator.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.collectionnavigator.extend(\"bizagi.rendering.desktop.collectionnavigator\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        data.properties.displayType = \"value\";\r\n\r\n        // Call base\r\n        self._super(data);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.navigationControls = control.find(\".bz-collectionnavigator-controls\");\r\n        self.canvas = self.getCanvas();\r\n        $('[title]', control).tooltip();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        $.when(self.isRendered()).done(function() {\r\n            if (self.hasData())\r\n                self.showRow(self.getFirstRow());\r\n\r\n            self.refreshControls();\r\n        });\r\n\r\n        var controls = self.navigationControls.find(\".bz-navigation-controls\");\r\n        controls.on(\"click\", \"span\", function(ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if ($(target).hasClass(\"bz-navigation-next\") && self.isValidRow()) {\r\n                    $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                        self.showRow(self.getNextRow());\r\n                    });\r\n                } else if ($(target).hasClass(\"bz-navigation-previous\") && self.isValidRow()) {\r\n                    $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                        self.showRow(self.getPreviousRow());\r\n                    });\r\n                } else if ($(target).hasClass(\"bz-navigation-first\") && self.isValidRow()) {\r\n                    $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                        self.showRow(self.getFirstRow());\r\n                    });\r\n                } else if ($(target).hasClass(\"bz-navigation-last\") && self.isValidRow()) {\r\n                    $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                        self.showRow(self.getLastRow());\r\n                    });\r\n                } else if ($(target).hasClass(\"bz-navigation-remove\")) {\r\n                    if (self.hasData()) {\r\n                        self.removeRow();\r\n                    }\r\n                } else if ($(target).hasClass(\"bz-navigation-add\")) {\r\n                    if (self.hasData() && self.isValidRow()) {\r\n                        $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                            self.addInlineRow();\r\n                        });\r\n                    } else if (!self.hasData()) {\r\n                        self.addInlineRow();\r\n                    }\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n\r\n        var currentRow = self.navigationControls.find(\".bz-navigation-current-row\");\r\n        currentRow.on(\"change\", function() {\r\n            if (self.isValidRow()) {\r\n                var value = $(this).val();\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.updateRow(value);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Add Form\r\n        var add = self.navigationControls.find(\".bz-collectionnavigator-addform\");\r\n        add.on(\"click\", function() {\r\n\r\n            if (self.hasData() && self.isValidRow()) {\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.addRow();\r\n                });\r\n            } else if (!self.hasData()) {\r\n                self.addRow();\r\n            }\r\n        });\r\n\r\n        // Edit Form\r\n        var edit = self.navigationControls.find(\".bz-collectionnavigator-editform\");\r\n        edit.on(\"click\", function() {\r\n            if (self.isValidRow()) {\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.editRow();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Detail Form\r\n        var detail = self.navigationControls.find(\".bz-collectionnavigator-detailform\");\r\n        detail.on(\"click\", function() {\r\n            if (self.isValidRow()) {\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.showDetailForm();\r\n                });\r\n            }\r\n        });\r\n\r\n        //Save Form\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        save.on(\"click\", function() {\r\n            if (self.isValidRow()) {\r\n                var properties = self.properties;\r\n                var refreshForm = !properties.inlineEdit && self.isTherePendingInlineRow();\r\n\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.showRow(self.getRow());\r\n                });\r\n            }\r\n        });\r\n\r\n        //Cancel\r\n        var cancel = self.navigationControls.find(\".bz-collectionnavigator-cancel\");\r\n        cancel.on(\"click\", function () {\r\n            self.cancelChanges();\r\n        });\r\n\r\n        self.configureButtonsForm();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {        \r\n        this.postRender();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /*\r\n    * Each time an action is executed, is necessary to refresh \r\n    * the navigation controls\r\n    */\r\n    refreshControls: function () {\r\n        var self = this;\r\n\r\n        self.refreshForwardButtons();\r\n        self.refreshBackButtons();\r\n        self.refreshPagination();\r\n        self.refreshTotal();\r\n        self.refreshRemoveAction();\r\n    },\r\n    /*\r\n    * Enabled o disabled a control (next or last)\r\n    */\r\n    refreshForwardButtons: function () {\r\n        var self = this;\r\n        var nextControl = self.getInnerControl(\"navigation\", \"next\");\r\n        var lastControl = self.getInnerControl(\"navigation\", \"last\");\r\n        var keys = self.keys.length;\r\n\r\n        if (self.hasData() && (self.pointer < keys - 1)) {\r\n            nextControl.removeClass(\"ui-state-disabled\");\r\n            lastControl.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            nextControl.addClass(\"ui-state-disabled\");\r\n            lastControl.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n    /*\r\n    * Enabled o disabled a control (previous or first)\r\n    */\r\n    refreshBackButtons: function () {\r\n        var self = this;\r\n        var previousControl = self.getInnerControl(\"navigation\", \"previous\");\r\n        var firstControl = self.getInnerControl(\"navigation\", \"first\");\r\n\r\n        if (self.hasData() && (self.pointer > 0)) {\r\n            previousControl.removeClass(\"ui-state-disabled\");\r\n            firstControl.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            previousControl.addClass(\"ui-state-disabled\");\r\n            firstControl.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Enabled o disabled the remove button\r\n    */\r\n    refreshRemoveAction: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            var removeButton = self.getInnerControl(\"navigation\", \"remove\");\r\n\r\n            if (self.hasData() && !self.isTherePendingInlineRow()) {\r\n                removeButton.removeClass(\"ui-state-disabled\");\r\n            } else {\r\n                removeButton.addClass(\"ui-state-disabled\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Updates the current row\r\n    */\r\n    refreshPagination: function() {\r\n        var self = this;\r\n\r\n        var control = self.getInnerControl(\"navigation\", \"current\");\r\n        var keys = self.keys.length;\r\n\r\n        if (keys > 0) {\r\n            control.val(self.pointer + 1);\r\n            control.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            control.val(self.pointer);\r\n            control.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Updates the total of rows in collection\r\n    */\r\n    refreshTotal: function () {\r\n        var self = this;\r\n\r\n        var value = self.getTotalRows();\r\n        var total = self.getInnerControl(\"navigation\", \"total\");\r\n        total.text(value);\r\n    },\r\n\r\n    /*\r\n    * Enabled o disabled the save and cancel actions\r\n    */\r\n    refreshActions: function (eSave, eCancel) {\r\n        var self = this;\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        var cancel = self.navigationControls.find(\".bz-collectionnavigator-cancel\");\r\n\r\n        eSave ? save.removeClass(\"ui-state-disabled\") : save.addClass(\"ui-state-disabled\");\r\n        eCancel ? cancel.removeClass(\"ui-state-disabled\") : cancel.addClass(\"ui-state-disabled\");\r\n    },\r\n\r\n    /*\r\n    * Gets the especific control\r\n    */\r\n    getInnerControl: function (section, action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var group = null;\r\n\r\n        group = $(\"div[data-navigation-id='\" + properties.id + \"']\");\r\n\r\n        if (section) {\r\n            if (action == \"next\") {\r\n                return group.find(\".bz-navigation-next\");\r\n            }\r\n            if (action == \"last\") {\r\n                return group.find(\".bz-navigation-last\");\r\n            }\r\n            if (action == \"previous\") {\r\n                return group.find(\".bz-navigation-previous\");\r\n            }\r\n            if (action == \"first\") {\r\n                return group.find(\".bz-navigation-first\");\r\n            }\r\n            if (action == \"current\") {\r\n                return group.find(\".bz-navigation-current-row\");\r\n            }\r\n            if (action == \"total\") {\r\n                return group.find(\".bz-navigation-total-rows\");\r\n            }\r\n            if (action == \"add\") {\r\n                return group.find(\".bz-navigation-add\");\r\n            }\r\n            if (action == \"remove\") {\r\n                return group.find(\".bz-navigation-remove\");\r\n            }\r\n            if (action == \"save\") {\r\n                return group.find(\".bz-collectionnavigator-save\");\r\n            }\r\n            if (action == \"cancel\") {\r\n                return group.find(\".bz-collectionnavigator-cancel\");\r\n            }\r\n        }\r\n\r\n\r\n        return undefined;\r\n    },\r\n    /*\r\n    * Shows the navigation form, with the data specified in the row[id]\r\n    */\r\n    showRow: function(id, setFocus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (id) {\r\n            var data = {\r\n                id: id,\r\n                requestedForm: \"navigationForm\",\r\n                url: self.properties.navigationPage,\r\n                editable: properties.editable ? properties.inlineEdit : false\r\n            };\r\n\r\n            $.when(self.renderForm(self.getParameters(data))).done(function(form) {\r\n                self.loadForm(form, setFocus);\r\n                self.refreshControls();\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    * Shows the navigation form, with the data specified in the row[id]\r\n    */\r\n    showDetailForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Show dialog with new form after that\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: false,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\")\r\n        });\r\n\r\n        dialog.render(self.getParameters({ id: self.getRow(), requestedForm: \"detailForm\", url: properties.editPage, editable: false }));\r\n    },\r\n    /*\r\n    * Shows the navigation form inline, with the data specified in the row[id]\r\n    */\r\n    showInlineRow: function(id, setFocus) {\r\n        var self = this;\r\n        var data = {\r\n            id: id,\r\n            requestedForm: \"navigationForm\",\r\n            url: self.properties.navigationPage,\r\n            editable: true\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.renderForm(self.getParameters(data))).done(function(data) {\r\n            self.loadForm(data, setFocus);\r\n            self.refreshControls();\r\n        }).always(function() {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Updates the navigation form, with the data specified in the row[id]\r\n    */\r\n    updateRow: function (id) {\r\n        var self = this;\r\n\r\n        if ($.isNumeric(id) && self.isValidKey(id)) {\r\n            id = parseInt(id);\r\n            self.setPointer(id);\r\n            self.showRow(self.getRow());\r\n            self.refreshControls();\r\n        } else {\r\n            self.refreshPagination();\r\n        }\r\n    },\r\n    /*\r\n    * Returns true if the key is within the range. Otherwise it returns false\r\n    */\r\n    isValidKey: function(key) {\r\n        if (key <= 0) return false;\r\n        if (key > this.keys.length) return false;\r\n        return true;\r\n    },\r\n    /*\r\n    * Renders the navigation form\r\n    */\r\n    renderForm: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n\r\n        if (form.isLoaderDeferredSet()) {\r\n            form.appendWaitForLoader({ promise: defer.promise() });\r\n        }\r\n        \r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params)).pipe(function (data) {\r\n\r\n            // Apply contextType\r\n            data.form.contextType = params.contextType;\r\n\r\n            //delete buttons\r\n            delete data.form.buttons;\r\n\r\n            // Apply editable param\r\n            if (params.editable == false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // The transitions don't apply in collection navigator\r\n            self.removeTransitions(data.form);\r\n            var formContainer = self.getFormContainer();\r\n\r\n            // Render dialog template\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                canvas: formContainer.params.canvas || formContainer.container,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: params.isRefresh || false\r\n            });\r\n\r\n            self.form.render();\r\n\r\n            formContainer.rendersById = $.extend(formContainer.rendersById, self.form.rendersById);\r\n         \r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\", self.getFormContainer());\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                self.showRow(self.getRow());\r\n            });\r\n\r\n            self.bindRenderChangeEvent(self.form.children);\r\n\r\n            defer.resolve(self.form);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    * This method binds the render change event of each control \r\n    * at the current form\r\n    */\r\n    bindRenderChangeEvent: function (children) {\r\n        var self = this;\r\n        children = children || [];\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n            var changes;\r\n\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.bind(\"renderchange\", function (ev, params) {\r\n                    params = params || {}\r\n                    var render = params.render;\r\n                    var changed = params.changed;\r\n                    var isEmpty;\r\n\r\n                    if (render && (render.properties.type == \"collectionnavigator\" || render.properties.type == \"grid\")) {\r\n                        isEmpty = false;\r\n                        if (!changed && render.properties.type == \"grid\") {\r\n                            changes = [];\r\n                            var temp = $.forceCollectData;\r\n                            $.forceCollectData = false;\r\n                            self.form.hasChanged(changes);\r\n                            $.forceCollectData = temp;\r\n                            isEmpty = changes.length === 0 ? true : false;\r\n                        }\r\n                    } else {\r\n                        changes = [];\r\n                        self.form.hasChanged(changes);\r\n                        isEmpty = changes.length === 0 ? true : false;\r\n                    }\r\n\r\n                    self.refreshActions(!isEmpty, !isEmpty);\r\n                    self.triggerRenderChange();\r\n                });\r\n            } else if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                self.bindRenderChangeEvent(child.children);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the elements html (canvas), where will be located the navigation form \r\n    */\r\n    getCanvas: function () {       \r\n        var control = this.getControl();\r\n        return control.find(\".bz-collectionnavigator-navigationform\");\r\n    },\r\n    /*\r\n    * Return true if the data of navigation form is valid\r\n    */\r\n    isValidRow: function() {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations();\r\n    },\r\n\r\n    isSaveEnabled: function() {\r\n        var self = this;\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        var result = !save.hasClass(\"ui-state-disabled\");\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Saves changes in navigation form\r\n    */\r\n    saveChanges: function (params) {\r\n        var self = this;\r\n        var data = self.getChanges();\r\n        var arrayCollectionNavigator = [];\r\n        var hasChildren = false;\r\n        var checkSave = params ? (!!params.checkSave) : false;\r\n        var result, checkSaveEnabled;\r\n\r\n        if (self.form) {\r\n            var children = self.getChildCollectionNavigator(self.form.children, arrayCollectionNavigator);\r\n            hasChildren = (children.length > 0) ? true : false;\r\n        \r\n            if (hasChildren) {\r\n                self.saveChangesChildren(arrayCollectionNavigator);\r\n            }\r\n\r\n            checkSaveEnabled = self.isSaveEnabled();\r\n            if (checkSave && !checkSaveEnabled) {\r\n                result = $.Deferred().resolve({ type: \"success\" }).promise();\r\n            } else {\r\n                data.idPageCache = self.form.getPageCache();\r\n                result = self.submitSaveRequest(self.getRow(), data);\r\n            }\r\n            \r\n            return result.pipe(function (response) {\r\n                    response = response || {};\r\n                    if (response.type == \"success\") {\r\n                        // Mark data collected as original values\r\n                        self.form.collectRenderValuesForSubmit();\r\n                        self.removeInlineAddRecord();\r\n                        self.refreshControls();\r\n                        self.refreshActions(false, false);\r\n                        return self.fetchData();\r\n\r\n                    } else {\r\n                        if (response.type == \"validationMessages\") {\r\n                            var form = self.getFormContainer();\r\n                            var message = response.messages.join(\" \");\r\n                            form.failHandler({ message: message });\r\n                        }\r\n                        return false;\r\n                    }\r\n                });\r\n        } else {\r\n            self.removeInlineAddRecord();\r\n            self.refreshControls();\r\n            self.refreshActions(false, false);\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    * Cancel changes\r\n    */\r\n    cancelChanges: function () {\r\n        var self = this;\r\n        self.refreshActions(false, false);\r\n\r\n        if (self.inlineAddRecords.length > 0) {\r\n            self.removeKey();\r\n            self.inlineAddRecords.pop();\r\n            self.submitRollbackRequest({idPageCache:self.form.properties.idPageCache});\r\n            self.refreshTotal();\r\n            self.refreshControls();\r\n\r\n            if (self.getTotalRows() == 0) {\r\n                self.removeNavigationForm();\r\n                self.drawPreview();\r\n            } else {\r\n                self.showRow(self.getRow());\r\n            }\r\n        } else {\r\n            var data = self.getChanges();\r\n            if (!$.isEmptyObject(data)) {\r\n                self.showRow(self.getRow());\r\n            }\r\n        }\r\n\r\n    },\r\n    /*\r\n    * Gets changes of current navigation form\r\n    */\r\n    getChanges: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (self.form) {\r\n            self.form.collectRenderValues(data);\r\n        }\r\n\r\n        $.each(data, function (key, value) {\r\n            var renders = self.form.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n    /*\r\n    *  Adds a row inline to collection\r\n    */\r\n    addInlineRow: function () {\r\n        var self = this;\r\n        var setFocus = true;\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n                self.refreshActions(true, true);\r\n                self.inlineAddRecords.push(newid);\r\n                self.addKey(newid);\r\n                self.showInlineRow(self.getLastRow(), setFocus);\r\n                self.refreshTotal();\r\n                self.refreshControls();\r\n            });\r\n    },\r\n    /*\r\n    *  Adds a row to collection\r\n    */\r\n    addRow: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest()).done(function(newid) {\r\n\r\n            // Show dialog with new form after that\r\n            var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                title: properties.addLabel,\r\n                orientation: properties.orientation || \"ltr\",\r\n                onSave: function(data) {\r\n                    if (properties.contextType) {\r\n                        data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                    }\r\n                    return self.submitSaveRequest(newid, data);\r\n                }\r\n            });\r\n\r\n            dialog.render(self.getParameters({\r\n                id: newid,\r\n                requestedForm: \"addForm\",\r\n                url: properties.addPage,\r\n                editable: true\r\n            })).done(function() {\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                $.when(self.fetchData()).done(function() {\r\n                    self.showRow(self.getLastRow());\r\n                });\r\n\r\n                self.endLoading();\r\n            }).fail(function(error) {\r\n                $.when(self.submitRollbackRequest(error)).done(function() {\r\n                    self.submitInvalidatePageCacheRequest(error);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * Edits a row in the collection with Form\r\n    */\r\n    editRow: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var id = self.getRow();\r\n\r\n        // Send edit request\r\n        $.when(self.submitEditRequest(id)).done(function() {\r\n\r\n            // Show dialog with new form\r\n            var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                title: properties.editLabel,\r\n                orientation: properties.orientation || \"ltr\",\r\n                onSave: function(data) {\r\n                    return self.submitSaveRequest(id, data);\r\n                }\r\n            });\r\n\r\n            dialog.render(self.getParameters({\r\n                id: id,\r\n                requestedForm: \"editForm\",\r\n                url: self.properties.editPage,\r\n                editable: true\r\n            })).done(function() {\r\n                $.when(self.fetchData()).done(function() {\r\n                    self.showRow(self.getRow());\r\n                });\r\n            }).fail(function(error) {\r\n                $.when(self.submitRollbackRequest(error)).done(function() {\r\n                    self.submitInvalidatePageCacheRequest(error);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * removes current row\r\n    */\r\n    removeRow: function() {\r\n        var self = this;\r\n        var id = self.getRow();\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).done(function() {\r\n            // Do a collection record deletion\r\n            $.when(self.submitDeleteRequest(id)).done(function(data) {\r\n                data = data || {};\r\n                if (data.type == \"success\") {\r\n                    // Set loading status\r\n                    self.startLoading();\r\n\r\n                    self.removeKey();\r\n                    self.refreshTotal();\r\n                    self.refreshControls();\r\n\r\n                    if (self.getTotalRows() == 0) {\r\n                        self.removeNavigationForm();\r\n                        self.drawPreview();\r\n                    } else {\r\n                        self.showRow(self.getRow());\r\n                    }\r\n\r\n                    self.endLoading();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Removes of local list the rows added inline\r\n    */\r\n    removeInlineAddRecord: function () {\r\n        var self = this;\r\n\r\n        if (self.isTherePendingInlineRow()) {\r\n            self.inlineAddRecords.pop();\r\n        }\r\n    },\r\n    /*\r\n    * Loads form in canvas\r\n    */\r\n    loadForm: function (form, setFocus) {\r\n        var self = this;\r\n\r\n        self.removeNavigationForm();\r\n        var buttons = form.container.find(\".ui-bizagi-button-container\");\r\n        buttons.remove();\r\n        self.addNavigationForm(form.container);\r\n\r\n        if (setFocus) {\r\n            self.focusFirstControl(form);\r\n        }\r\n    },\r\n    /*\r\n    * Method to process button actions in the form\r\n    */\r\n    configureButtonsForm: function() {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var originalProcessButton = form.processButton;\r\n        \r\n\r\n        form.processButton = function(buttonProperties) {\r\n            \r\n            // Deferred is defined in order to avoid a permanent overlay after submitting with custom buttons\r\n            var deferred = $.Deferred();\r\n            var valid = true;\r\n            if (!self.form || buttonProperties.action == \"\") {\r\n                form.originalProcessButton.apply(form, [buttonProperties]).done(function() {\r\n                    deferred.resolve();\r\n                }).fail(function(){\r\n                    deferred.reject();\r\n                });\r\n            } else if (buttonProperties.action == \"save\") {\r\n                $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                    form.originalProcessButton.apply(form, [buttonProperties]);\r\n                    deferred.resolve();\r\n                }).fail(function(error) {\r\n                    self.processFailMessage(error);\r\n                    deferred.resolve();\r\n                });\r\n            } else if (buttonProperties.action == \"next\" || buttonProperties.action == \"createnewcase\") {\r\n                // Process to save form\r\n\r\n                valid = self.isValid([]);\r\n                if (buttonProperties.validate && valid) {\r\n                    $.when(self.saveChanges()).done(function() {\r\n                        form.originalProcessButton.apply(form, [buttonProperties]);\r\n                        deferred.resolve();\r\n                    }).fail(function(error) {\r\n                        self.processFailMessage(error);\r\n                        deferred.resolve();\r\n                    });\r\n                } else {\r\n                    if (valid) {\r\n                        $.when(self.saveChanges()).done(function() {\r\n                            form.originalProcessButton.apply(form, [buttonProperties]);\r\n                            deferred.resolve();\r\n                        }).fail(function(error) {\r\n                            self.processFailMessage(error);\r\n                            deferred.resolve();\r\n                        });\r\n                    } else {\r\n                        form.originalProcessButton.apply(form, [buttonProperties]);\r\n                        deferred.resolve();\r\n                    }\r\n                }\r\n            } else if (buttonProperties.action == \"nextWithoutValidations\") {                \r\n                $.when(self.saveChanges()).done(function() {\r\n                    form.originalProcessButton.apply(form, [buttonProperties]);\r\n                    deferred.resolve();\r\n                }).fail(function(error) {\r\n                    self.processFailMessage(error);\r\n                    deferred.resolve();\r\n                });\r\n            }\r\n            return deferred.promise();\r\n        };\r\n    },\r\n    /*\r\n    * Removes navigation form\r\n    */\r\n    removeNavigationForm: function () {        \r\n        this.canvas.children().remove();\r\n    },\r\n    /*\r\n    * Adds navigation form\r\n    */\r\n    addNavigationForm: function (content) {        \r\n        this.canvas.append(content);\r\n    },\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n        $.when(self.getRemoteData()).done(function (data) {\r\n                self.endLoading();\r\n                if (self.disposed) return;\r\n                if (data) {\r\n                    self.refresh(data);\r\n                    defer.resolve();\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n            });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    * Verify if data is different the filter\r\n    */\r\n    refresh: function (data) {\r\n        var self = this;\r\n        var keys = self.getKeys(data.rows);\r\n        self.keys = keys;\r\n\r\n        if (keys.indexOf(self.getRow()) == -1) {\r\n            self.totalRows = keys.length;\r\n            self.pointer = (self.pointer > 0) ? self.pointer - 1 : self.pointer;\r\n            if (self.totalRows == 0) {\r\n                self.removeNavigationForm();\r\n                self.drawPreview();\r\n                self.refreshControls();\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Sets the focus to the first control\r\n    */\r\n    focusFirstControl: function (form, time) {\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container).not(\".ui-bizagi-render-date,.ui-bizagi-render-search\");\r\n            if (defaultControl.length > 0) {\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                try {\r\n                    innerControl.focus();\r\n                } catch (e) {\r\n                }\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n    /*\r\n    * Return array with children of type collectionnavigator\r\n    */\r\n    getChildCollectionNavigator: function(children, arrayCollectionNavigator) {\r\n        var self = this;\r\n        children = children || [];\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (child.properties.type == \"collectionnavigator\" || child.properties.type == \"grid\") {\r\n                    arrayCollectionNavigator.push(child);\r\n                }\r\n            } else if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                self.getChildCollectionNavigator(child.children, arrayCollectionNavigator);\r\n            }\r\n        }\r\n        return arrayCollectionNavigator\r\n    },\r\n    /*\r\n    *save changes for children of type collectionnavigator\r\n    */\r\n    saveChangesChildren: function (arrayCollectionNavigator) {\r\n        for (var i = 0, l = arrayCollectionNavigator.length; i < l; i++) {\r\n            if (arrayCollectionNavigator[i].properties.type == \"collectionnavigator\") {\r\n                arrayCollectionNavigator[i].saveChanges();\r\n            }\r\n        }\r\n    },\r\n\r\n    drawControls: function (html) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        html = $(html);\r\n        var controls = self.collectionControls = $(\".bz-collectionnavigator-controls\", html);\r\n\r\n        self.drawForms(controls);\r\n        self.drawControl(controls);\r\n\r\n        if (properties.editable)\r\n            self.drawActions(controls);\r\n\r\n        return html[0].outerHTML;\r\n    },\r\n    /*  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n        var self = this;\r\n        var actions = $(\".actions-group\", controls);\r\n    \r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-actions\");\r\n        var html = $.tmpl(template);\r\n        html.appendTo(actions);\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var editable = properties.editable;\r\n        var control = $(\".control-group\", controls);\r\n\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-control\");\r\n        var html = $.tmpl(template, {\r\n            inlineAdd: editable && properties.inlineAdd,\r\n            allowDelete: editable && properties.allowDelete,\r\n            total: self.totalRows\r\n        });\r\n\r\n        html.appendTo(control);\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function(controls) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var withAddForm = properties.withAddForm;\r\n        var withEditForm = properties.withEditForm;\r\n        var allowDetail = properties.allowDetail;        \r\n        var html = null;\r\n        var forms = $(\".bz-navigation-group\", controls);\r\n\r\n        if (properties.editable && (withAddForm || withEditForm || allowDetail)) {\r\n            forms.addClass(\"group-visible\");\r\n\r\n            if (withAddForm) {\r\n                html = self.getActionsTemplate(\"add\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n            if (withEditForm) {\r\n                html = self.getActionsTemplate(\"edit\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n            if (allowDetail) {\r\n                html = self.getActionsTemplate(\"details\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n        } else {\r\n            forms.addClass(\"group-no-visible\");\r\n        }\r\n\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * This method removes the transitions\r\n    */\r\n    removeTransitions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.transitions) {\r\n            delete data.transitions;\r\n        }\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var saveDeferred;\r\n        if (this.isRendered()) {\r\n            saveDeferred = this.saveChanges({ checkSave: true });\r\n\r\n            renderValues.deferreds = renderValues.deferreds || [];\r\n            renderValues.deferreds.push(saveDeferred);\r\n        }\r\n    },\r\n\r\n    getActionsTemplate: function(type) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-form-button\");\r\n        var html = null;\r\n\r\n        switch (type) {\r\n            case \"add\":                \r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-addform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-addform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-add-form\")\r\n                });\r\n                break;\r\n            case \"edit\":                \r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-editform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-editform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-edit-form\")\r\n                });\r\n                break;\r\n            case \"details\":                \r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-detailform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-detailform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-details-form\")\r\n                });\r\n                break;\r\n            }\r\n\r\n        return html;\r\n    }\r\n\r\n});","/*\r\n *   Name: Bizagi Desktop Render ECM file upload control\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script extend some functionalities of file upload control\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.ecm\", {    \r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE    \r\n}, bizagi.rendering.ecm.prototype)\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.ecm.extend(\"bizagi.rendering.desktop.ecm\", {}, {\r\n    renderControl: function (listControl, fileProperties) {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n\r\n            for (var i = 0, length = singleExtensions.length; i < length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Fix dateFormat for datepicker\r\n        properties.datePickerFormat = properties.dateFormat.replaceAll(\"M\", \"m\"); // Fix months\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"yyyy\", \"yy\"); // Fix years\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"mmmm\", \"MM\"); // Fix days\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        // define xpath context if coming from grid column\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-upload\");\r\n        control.addClass(\"ui-bizagi-render-ecm\");\r\n        $(control).closest(\".ui-bizagi-control-wrapper\").addClass(\"ui-bizagi-control-wrapper-ecm\");\r\n\r\n        // First run show render options\r\n        self.properties.showRenderOptions = true;\r\n\r\n        // Call service and render control\r\n        if (mode == \"execution\") {\r\n            self.renderUploadItem();\r\n        } else {\r\n            control.append(\"<div class='ui-icon ecm-file'></div>\");\r\n        }\r\n\r\n        // Check number of files and hide or show button to upload\r\n        self.checkMaxFiles();\r\n\r\n        \r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        data = self.buildAddParams();\r\n        data.networkSpeed = networkSpeed();\r\n\r\n        $(\".biz-render-ecm-upload-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.ecm.dialog\"),\r\n\r\n            properties: data,\r\n            uploadedFiles: self.filesCount,\r\n            isECM: true,\r\n\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n    },\r\n\r\n    configureUploadHandlers: function (reference, extraData, control) {\r\n        var self = reference;\r\n        var properties = self.properties;\r\n        var data = self.buildUpgradeParams(control);\r\n\r\n        $(control).bizagiUpload({\r\n            renderReference: self,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.ecm.dialog\"),\r\n\r\n            properties: data,\r\n            uploadedFiles: self.filesCount,\r\n            isECM: true,\r\n            isUpdatingECM: true,\r\n\r\n            onUploadFileCompletedCallback: self.onUpdateUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n    },\r\n\r\n    onUpdateUploadFileCompleted: function (renderReference, data, control, response) {\r\n        var self = renderReference;\r\n\r\n        control.empty();\r\n        self.waiting(control, true);\r\n        self.filesCount++;\r\n\r\n        self.renderFileLayout(self, data, control, response);\r\n    },\r\n\r\n    renderUploadItem: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"upload-ecm-view-default\");\r\n        var properties = self.properties;\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n\r\n        // If there's an error it displays a dialog and stops this method\r\n        if (typeof (fileProperties) != \"undefined\" && typeof (fileProperties.status) != \"undefined\" && fileProperties.status == \"error\") {\r\n            bizagi.showMessageBox(fileProperties.message);\r\n            return;\r\n        }\r\n\r\n        $.when($.tmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage,\r\n            allowSendInMail: properties.allowSendInMail\r\n        })).done(function (controlContent) {\r\n            // Append content\r\n            if (listControl && listControl.length > 0) {\r\n                controlContent.insertAfter(listControl.last());\r\n            } else {\r\n                control.append(controlContent);\r\n            }\r\n\r\n            //Remove load information tab\r\n            control.find(\".uploadifyQueueItem\").remove();\r\n\r\n            // Load metadata for each file\r\n            if (self.properties.value != undefined) {\r\n                $.each(self.properties.value, function (key, value) {\r\n                    var data = {};\r\n\r\n                    data.idFileUpload = value[0] || value.uploadId;\r\n                    data.fileName = value[1] || value.fileName;\r\n                    data.idPageCache = self.properties.idPageCache;\r\n                    data.xpathContext = self.getXpathContext();\r\n\r\n                    data.xPath = self.properties.xpath;\r\n                    data.idAttrib = self.properties.idAttrib;\r\n\r\n                    if (mode == \"execution\") {\r\n                        self.renderFileLayout(self, data, $(\".\" + self.properties.id + \"-\" + data.idFileUpload, control), fileProperties);\r\n                    }\r\n                });\r\n            }\r\n\r\n            // set event sendmail\r\n            if (self.properties.allowSendInMail) {\r\n                self.bindEmailDialog();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.getXpathContext() || \"\";\r\n        var xpath = self.properties.xpath;\r\n\r\n        $(\".ui-bizagi-render-ecm-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(\"dialog-send-email\"),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render file layout     \r\n     */\r\n    renderFileLayout: function (self, data, fileControl, fileProperties) {\r\n        self = self || this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"upload-ecm-view-default-metadata\");\r\n\r\n        var imageConfig = { zIndex: $.getMaxZindex() + 1 };\r\n        var originalData = $.extend({}, data);\r\n        var metadataParams = fileProperties ? [fileProperties] : self.dataService.metadataECMMultiaction().getFileProperties(originalData);\r\n\r\n        $.when(self.dataService.metadataECMMultiaction().getECMMetadata(data), metadataParams)\r\n            .done(function (metaData, fileProperties) {\r\n\r\n                self.waiting(fileControl, true);\r\n\r\n                if (Array.isArray(fileProperties)) {\r\n                    fileProperties = fileProperties[0];\r\n                }\r\n\r\n                if (Array.isArray(metaData)) {\r\n                    metaData = metaData[0];\r\n                }\r\n\r\n                fileProperties.data = data;\r\n\r\n                // Make xpath context\r\n                fileProperties.xpathContext = fileProperties.xpathContext || form.properties.xpathContext || \"\";\r\n                fileProperties.xpath = self.properties.xpath;\r\n\r\n                metaData.filename = data.fileName;\r\n                metaData.url = self.buildItemUrl(fileProperties);\r\n\r\n                // Define File Properties\r\n                metaData.ecm_ecmStatus = fileProperties.ecmStatus;\r\n                metaData.ecm_isVisible = fileProperties.isVisible;\r\n                metaData.ecm_allowUpdateMetadata = fileProperties.allowUpdateMetadata;\r\n                metaData.ecm_allowDelete = fileProperties.allowDelete;\r\n                metaData.ecm_allowUpdateContent = fileProperties.allowUpdateContent;\r\n                metaData.ecm_allowView = fileProperties.allowView;\r\n                metaData.ecm_allowCheckOut = fileProperties.allowCheckOut;\r\n                metaData.ecm_allowCancelCheckOut = fileProperties.allowCancelCheckOut;\r\n                metaData.ecm_allowEdit = fileProperties.allowEdit;\r\n                metaData.idFileUploads = fileProperties.idFileUpload;\r\n                metaData.xpath = fileProperties.xpath;\r\n                metaData.value = bizagi.util.parseBoolean(fileProperties.value);\r\n\r\n                // Check if file its image\r\n                var container = fileControl.parent().find('.extension:last');\r\n                if (self.isImage(metaData.filename)) {\r\n                    // Append image\r\n                    container.empty();\r\n                    container.append('<img>');\r\n                    var image = container.find('img');\r\n\r\n                    // Add class thumbnail\r\n                    container.addClass('thumb-image');\r\n\r\n                    image.attr({ src: metaData.url, width: 32, height: 32 });\r\n\r\n                    image.imageZoom(imageConfig);\r\n\r\n                    $(\".checkuot , .readonly\", fileControl.parent()).off(\"click\").on('click', function () {\r\n                        image.click();\r\n                    });\r\n                } else {\r\n                    fileControl.parent().find('li:first').off(\"click\").on('click', function (e) {\r\n                        e.stopPropagation();\r\n                        window.open(metaData.url);\r\n                    });\r\n                }\r\n\r\n                // Check if file is visible\r\n                if (fileProperties.isVisible) {\r\n                    fileControl.empty();\r\n\r\n                    var dataItem = $.extend(metaData, {\r\n                        showMetadata: self.properties.showMetadata,\r\n                        orientation: form.properties.orientation || \"ltr\"\r\n                    });\r\n\r\n                    $.when($.tmpl(metadataTemplate, dataItem).appendTo(fileControl)).done(function () {\r\n                        // Bind options\r\n                        $(\".ecm-options-slide li\", fileControl).hover(function () {\r\n                            $(this).toggleClass(\"ecm-options-slide-hover\");\r\n                        });\r\n\r\n                        // Check if file its image\r\n                        if (self.isImage(metaData.filename)) {\r\n                            $(\".filename a\", fileControl).imageZoom(imageConfig);\r\n                        }\r\n\r\n                        // Set global events\r\n                        self.setControlEvents(fileControl, data);\r\n\r\n                        // Make Instance of file upload\r\n                        if (metaData.ecm_allowUpdateContent) {\r\n                            self.configureUploadHandlers(self, data, fileControl, fileProperties);\r\n                        }\r\n\r\n                        // Verify security of file\r\n                        switch (fileProperties.ecmStatus) {\r\n                            case 1: //LOCAL\r\n                                break;\r\n                            case 2: //PERSISTED\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"hidden\");\r\n                                fileControl.parent().find(\".checkuot\").hide();\r\n\r\n                                break;\r\n                            case 3: //DELETED\r\n                                break;\r\n                            case 4: //READONLY\r\n                                // Hide control options\r\n                                $(\".emc-options\", fileControl).hide();\r\n\r\n                                // Disable event to edit meta data                                \r\n                                fileControl.parent().find(\".readonly\").css(\"visibility\", \"visible\");\r\n                                fileControl.parent().find(\".readonly\").show();\r\n                                break;\r\n                            case 5: //CHECKEDOUT\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"visible\");\r\n                                fileControl.parent().find(\".checkuot\").show();\r\n                                break;\r\n                            case 6: //UNDEFINED\r\n                                bizagi.debug(\"ECM control return undefined status\", fileProperties);\r\n                                break;\r\n                            default:\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"hidden\").hide();\r\n                                fileControl.parent().find(\".readonly\").css(\"visibility\", \"hidden\").hide();\r\n                                break;\r\n                        }\r\n\r\n                        // Set Events\r\n                        // Check if the control its readonly\r\n                        if (bizagi.util.parseBoolean(self.properties.editable)) {\r\n                            var multiClickControl = true;\r\n                            fileControl.data(\"pluginAvailable\", false);\r\n\r\n                            $(\".emc-options\", fileControl).on('click', function (evt) {\r\n                                evt.stopPropagation();\r\n\r\n                                // Block multi click\r\n                                if (multiClickControl) {\r\n                                    multiClickControl = false;\r\n\r\n                                    var toggleOptions = function (fileControl) {\r\n                                        var def = new $.Deferred();\r\n                                        var modalEcm = $(\".modal-ecm\", fileControl);\r\n                                        var control = self.control;\r\n                                        // Show slide options\r\n                                        if (modalEcm.is(\":visible\")) {\r\n                                            $(\".modal-ecm\", control).hide();\r\n                                            $(\".ecm-options-slide\", modalEcm).hide();\r\n                                            modalEcm.hide();\r\n                                            def.resolve(true);\r\n                                        } else {\r\n\r\n                                            var displayOptionsContent = function () {\r\n                                                $(\".modal-ecm\", control).hide();\r\n                                                $(\".ecm-options-slide\", modalEcm).show();\r\n\r\n                                                modalEcm.show().position({\r\n                                                    my: \"center top\",\r\n                                                    at: \"center bottom\",\r\n                                                    of: $(\".emc-options\", fileControl),\r\n                                                    collision: \"none\"\r\n                                                });\r\n                                            }\r\n\r\n                                            //  Hides the control when click somewhere else\r\n                                            self.configureToggleHandlers();\r\n\r\n                                            def.resolve(true);\r\n\r\n                                            //Check if is the ECM is Async \r\n                                            if (self.properties.isAsync !== undefined) {\r\n\r\n                                                if (!metaData.ecm_allowUpdateContent)\r\n                                                    $(\".ecm-options-upgrade\", modalEcm).hide();\r\n\r\n                                                //it's a flag to prevent multiple sever queries\r\n                                                if (self.asynCheckEnabled === undefined) {\r\n\r\n                                                    self.asynCheckEnabled = true;\r\n\r\n                                                    self.asyncCheckTimeout = setTimeout(function () {\r\n                                                        //Clear the flag, to enable the interaction\r\n                                                        self.asynCheckEnabled = undefined;\r\n                                                        self.asyncCheckTimeout = undefined;\r\n                                                    }, 2000);\r\n\r\n                                                    //Checks if the control already have check if the file is on ECM\r\n                                                    if (!data.IsFileOnECM) {\r\n\r\n                                                        //Pre hide the elements, so when the services response, show or hide the elements we need\r\n                                                        $(\".ecm-options-checkout\", modalEcm).hide();\r\n                                                        $(\".ecm-options-cancelcheckout\", modalEcm).hide();\r\n                                                        $(\".ecm-options-upgrade\", modalEcm).hide();\r\n\r\n                                                        //invokes the server to retrieve the file status\r\n                                                        $.when(self.dataService.isFileOnECM({ \"idUpload\": data.idFileUpload }))\r\n                                                            .done(function (result) {\r\n\r\n                                                                //Checks the service response, and show/hide the desired controls\r\n                                                                if (result.IsFileOnECM) {\r\n\r\n                                                                    if (metaData.ecm_allowUpdateContent)\r\n                                                                        $(\".ecm-options-upgrade\", modalEcm).show();\r\n\r\n                                                                    if (metaData.ecm_allowCheckOut)\r\n                                                                        $(\".ecm-options-checkout\", modalEcm).show();\r\n\r\n                                                                    if (metaData.ecm_allowCancelCheckOut)\r\n                                                                        $(\".ecm-options-cancelcheckout\", modalEcm).show();\r\n                                                                }\r\n\r\n                                                                //Stores the server response, so if the response is true, prevents the service recall\r\n                                                                data.IsFileOnECM = result.IsFileOnECM;\r\n\r\n                                                                //Show the content\r\n                                                                displayOptionsContent();\r\n\r\n                                                            }).fail(function (error) {\r\n                                                                bizagi.log(\"isFileOnECM error\");\r\n                                                            });\r\n                                                    } else {\r\n                                                        displayOptionsContent();\r\n                                                    }\r\n                                                }\r\n                                            } else {\r\n                                                displayOptionsContent();\r\n                                            }\r\n                                        }\r\n\r\n                                        return def.promise();\r\n                                    };\r\n\r\n                                    $.when(toggleOptions(fileControl)).done(function () {\r\n                                        multiClickControl = true;\r\n                                    });\r\n                                }\r\n                            });\r\n                        } else {\r\n                            $(\".emc-options\", fileControl).hide();\r\n                            $(self.getControl()).trigger('ecmLoaded', { container: container });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    * Bind events for control\r\n    */\r\n    setControlEvents: function (control, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var globalControl = self.getControl();\r\n\r\n        // Bind for delete options\r\n        $(\".ecm-options-delete\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            $(\".emc-options\", control).click();\r\n            var message = $(\".biz-render-ecm-delete-confirmation\", globalControl).first().clone();\r\n            message.dialog({\r\n                resizable: false,\r\n                modal: true,\r\n                title: self.getResource(\"render-ecm-confirm-title\"),\r\n                buttons: [\r\n                    {\r\n                        text: self.getResource(\"render-ecm-confirm-bt-delete\"),\r\n                        click: function () {\r\n                            delete params.prepare; // Ensure run Ajax\r\n                            self.dataService.deleteECMFile(params);\r\n                            $(this).dialog(\"close\");\r\n                            control.parent(\"ul\").hide(\"highlight\", {}, 100);\r\n\r\n                            //Set files in a temporal array\r\n                            var files = [].concat(self.files);\r\n\r\n                            //Remove element form files array\r\n                            for (var i = 0; i < files.length; i++) {\r\n                                if (files[i][0] == params.idFileUpload) files.splice(i, 1);\r\n                            }\r\n\r\n                            //Set Value\r\n                            self.setValue(files);\r\n\r\n                            // Check maxFiles\r\n                            self.checkMaxFiles();\r\n                        }\r\n                    },\r\n                    {\r\n                        text: self.getResource(\"render-ecm-confirm-bt-cancel\"),\r\n                        click: function () {\r\n                            $(this).dialog(\"close\");\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n        });\r\n\r\n        // Bind for cancelcheckout options\r\n        $(\".ecm-options-cancelcheckout\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            //Close popup\r\n            $(\".emc-options\", control).click();\r\n\r\n            self.waiting(control, false);\r\n            control.find(\".filename\").empty();\r\n\r\n            delete params.prepare; // Ensure run Ajax\r\n            $.when(self.dataService.cancelCheckOut(params))\r\n                .done(function (fileProperties) {\r\n                    self.renderFileLayout(self, params, control, fileProperties);\r\n                });\r\n        });\r\n\r\n        // Bind for checkout options\r\n        $(\".ecm-options-checkout\", control).off('click').on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            //Close popup\r\n            $(\".meta-data-wrapper\", control).click();\r\n            self.waiting(control, false);\r\n            control.find(\".filename\").empty();\r\n            \r\n            delete params.prepare; // Ensure run Ajax\r\n            $.when(self.dataService.checkOutFile(params)).done(\r\n                function (fileProperties) {\r\n                    self.renderFileLayout(self, params, control, fileProperties);\r\n                });\r\n        });\r\n\r\n        // Bind for edit metadata\r\n        // Check if the ECM status is READONLY = 4\r\n        if ($(\".ecm-metadata-value\", control).data(\"ecmstatus\") != 4 && $(\".ecm-metadata-value\", control).data(\"allowupdatemetadata\")) {\r\n            $(\".ecm-metadata-value\", control).bind('activeeditmode', function (e) {\r\n                e.stopPropagation();\r\n\r\n                // Check read only\r\n                if (!$(this).data(\"readonly\")) {\r\n                    // Check propagation\r\n                    if ($(this).data(\"edit-mode\") == \"false\" || $(this).data(\"edit-mode\") == \"\") {\r\n                        $(this).data(\"edit-mode\", \"true\");\r\n\r\n                        switch ($(this).data(\"metadatatype\")) {\r\n                            case \"STRING\":\r\n                                self.makeStringMetaDataControler($(this), control);\r\n                                break;\r\n                            case \"INTEGER\":\r\n                                self.makeStringMetaDataControler($(this), control, function (value) {\r\n                                    // validation function\r\n                                    var valueMatch = value.match(/\\d+/);\r\n                                    return (valueMatch != null && valueMatch[0] == valueMatch['input']);\r\n                                });\r\n                                break;\r\n                            case \"DATETIME\":\r\n                                self.makeDatetimeMetaDataControler($(this), control);\r\n                                break;\r\n                            case \"DECIMAL\":\r\n                                self.makeStringMetaDataControler($(this), control, function (value, separator) {\r\n                                    // validation function\r\n                                    var numericFormat = self.getResource('numericFormat');\r\n\r\n                                    var reg = new RegExp(\"\\\\d+(\\\\\" + numericFormat.decimalSymbol + \"\\\\d)*\");\r\n                                    var valueMatch = value.match(reg);\r\n                                    try {\r\n                                        var lastChar = value.substr(value.length - 1, 1);\r\n                                    } catch (e) {\r\n                                        return false;\r\n                                    }\r\n                                    return (valueMatch != null && (valueMatch[0] == valueMatch['input'] || lastChar == numericFormat.decimalSymbol));\r\n                                });\r\n                                break;\r\n                            case \"BOOL\":\r\n                                self.makeBooleanMetaDataControler($(this), control);\r\n                                break;\r\n                            default:\r\n                                self.makeStringMetaDataControler($(this), control);\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // Set events for done and cancel button\r\n        $(\".ecm-metadata-done\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n            var control = $(this).parent('td');\r\n            var ecmMetaDataFieldEdit = $(\".ecm-metadata-field-edit\", control);\r\n            var metadatavalue = \"\";\r\n            var metadatapostvalue = \"\";\r\n\r\n            // Define metadataValue\r\n            switch (control.data('metadatatype')) {\r\n                case 'STRING':\r\n                case 'DECIMAL':\r\n                case 'INTEGER':\r\n                    metadatavalue = $(\".ecm-metadata-input\", control).val();\r\n                    metadatapostvalue = $(\".ecm-metadata-input\", control).val();\r\n                    break;\r\n                case 'BOOL':\r\n                    metadatavalue = $(\".biz-render-ecm-upload-boolean input:checked\", control).val();\r\n                    metadatapostvalue = bizagi.util.parseBoolean(metadatavalue) ? 'True' : 'False';\r\n                    metadatavalue = (metadatavalue == 'False') ? self.getResource('render-boolean-no') : self.getResource('render-boolean-yes');\r\n                    break;\r\n                case 'DATETIME':\r\n                    metadatavalue = $(\".ecm-metadata-input\", control).val();\r\n                    if (metadatavalue) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromFormat(metadatavalue, self.properties.datePickerFormat);\r\n                        metadatapostvalue = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    }\r\n                    break;\r\n            }\r\n            // Update metadata\r\n            control.data('value', metadatapostvalue);\r\n\r\n            var spanMetaDataValue = $(\"<span></span>\").addClass(\"ecm-metadata-text\").text(metadatavalue);\r\n            ecmMetaDataFieldEdit.replaceWith(spanMetaDataValue);\r\n\r\n            // Show and hide elements\r\n            $(\".ecm-metadata-edit\", control).css('display', 'block');\r\n            $(\".ecm-metadata-done\", control).hide();\r\n            $(\".ecm-metadata-cancel\", control).hide();\r\n            control.data(\"edit-mode\", \"false\");\r\n        });\r\n\r\n        $(\".ecm-options-edit\", control).on('click', function (evt, data) {\r\n            var modalEcm = control;\r\n            var validateData = data && data.checkData || false;\r\n\r\n            evt.stopPropagation();\r\n\r\n            // Close popup            \r\n            if ($(\".emc-options\", control).css(\"display\") === \"block\")\r\n                $(\".modal-ecm\", control).hide();\r\n\r\n            // If data is valid then return \t\r\n            if (validateData && self.isValidFields(modalEcm)) return;\r\n\r\n            if ($(\".ecm-options-edit\", modalEcm).data('editmode') == 'true') {\r\n                return;\r\n            } else {\r\n                $(\".ecm-options-edit\", modalEcm).data('editmode', 'true'); // Active edit mode\r\n            }\r\n\r\n            var template = self.renderFactory.getTemplate(\"upload-ecm-view-default-edit-buttons\");\r\n            var metadata = [];\r\n\r\n            // Render template\r\n            var editButtons = $.tmpl(template);\r\n\r\n            // Enable edit mode for all elements available in the control\r\n            $(\".ecm-metadata-value[data-allowUpdateMetadata=true]\", control).trigger('activeeditmode');\r\n\r\n            // Show save and cancel buttons\r\n            editButtons.insertAfter($('table', control));\r\n            $(\".biz-render-ecm-metadata-edit\", control).show(500);\r\n\r\n            // Set events to save and cancel buttons\r\n            // Save button\r\n            $(\".biz-render-ecm-metadata-edit button:first\", control).on('click', function (evt) {\r\n                var error = false;\r\n                var modalEcm = control;\r\n\r\n                evt.stopPropagation();\r\n\r\n                // verify all mandatory fields\r\n                $.each($(\".ecm-metadata-value[data-mandatory='true']\", control), function (key, field) {\r\n                    var type = $(field).data('metadatatype');\r\n                    var actualValue;\r\n\r\n                    if (type == \"BOOL\") {\r\n                        actualValue = $(\".biz-render-ecm-upload-boolean input:checked\", field).val();\r\n                    } else {\r\n                        actualValue = $(field).find('.ecm-metadata-field-edit').val();\r\n                    }\r\n\r\n                    if (actualValue === \"\" || actualValue === null) {\r\n                        $(field).find('input').attr('placeholder', self.getResource(\"render-ecm-tooltip-mandatory\"));\r\n                        $(field).parent().find('.ecm-metadata-key').addClass(\"mandatory-error\");\r\n                        $(field).parent().effect('highlight', 500);\r\n\r\n                        error = true;\r\n                    } else {\r\n                        $(field).parent().find('.ecm-metadata-key').removeClass(\"mandatory-error\");\r\n                    }\r\n                });\r\n\r\n                if (error) return;\r\n\r\n                $(\".ecm-metadata-done\", control).click();\r\n                $(\".biz-render-ecm-metadata-edit\", control).hide(300, function () {\r\n                    $(\".biz-render-ecm-metadata-edit\", control).remove();\r\n                });\r\n\r\n                $.each($(\".ecm-metadata-value\", control), function (key, value) {\r\n                    // uses the key as an index for the  ecm-metadata-key and ecm-metadata-value\r\n                    metadata.push({\r\n                        idMetadata: $($(\".ecm-metadata-key\", control)[key]).data(\"idmetadata\"),\r\n                        value: $(value).data(\"value\")\r\n                    });\r\n                });\r\n\r\n                params.metaValues = JSON.encode({ metadataValues: metadata });\r\n\r\n                delete params.prepare; // Ensure run Ajax\r\n                $.when(self.dataService.updateECMMetadata(params)).done(function(fileProperties) {\r\n                    $(\".ecm-options-edit\", modalEcm).data('editmode', 'false');\r\n                });\r\n            });\r\n\r\n            // Cancel button\r\n            $(\".biz-render-ecm-metadata-edit button:last\", control).on('click', function (evt) {\r\n                var modalEcm = control;\r\n\r\n                evt.stopPropagation();\r\n\r\n                $(\".ecm-metadata-cancel\", control).click();\r\n                $(\".biz-render-ecm-metadata-edit button:first\", control).unbind('click');\r\n                if ($('.ecm-options-slide', modalEcm).is(':visible')) {\r\n                    $(\".emc-options\", control).click();\r\n                }\r\n                $(\".biz-render-ecm-metadata-edit\", control).hide(500, function () {\r\n                    $(\".biz-render-ecm-metadata-edit\", control).remove();\r\n                });\r\n                $(\".ecm-options-edit\", modalEcm).data('editmode', 'false');\r\n            });\r\n\r\n        });\r\n\r\n        $(\".ecm-metadata-cancel\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n            var control = $(this).parent('td');\r\n            var inputMetaDataValue = $(\".ecm-metadata-field-edit\", control);\r\n            var spanMetaDataValue = $(\"<span></span>\").addClass(\"ecm-metadata-text\").text(inputMetaDataValue.data('original-value'));\r\n\r\n            inputMetaDataValue.replaceWith(spanMetaDataValue);\r\n\r\n            // Show and hide elements\r\n            $(\".ecm-metadata-edit\", control).css('display', 'block');\r\n            $(\".ecm-metadata-done\", control).hide();\r\n            $(\".ecm-metadata-cancel\", control).hide();\r\n\r\n            control.data(\"edit-mode\", \"false\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Make input field for edit string metadata\r\n    */\r\n    makeStringMetaDataControler: function (field, control, validationFunction) {\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var inputMetaDataValue = $(\"<input></input>\").addClass(\"ecm-metadata-field-edit ecm-metadata-input\").val(spanMetaDataValue.text());\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n\r\n        inputMetaDataValue.focus();\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n        // Set event for enter key press\r\n        $(\".ecm-metadata-input\", field).bind(\"keyup\", function (e) {\r\n            var inputValue = inputMetaDataValue.val();\r\n            if (validationFunction) {\r\n                if (validationFunction(inputValue) || inputValue == \"\") {\r\n                    inputMetaDataValue.data(\"latestdonevalue\", inputValue);\r\n                } else {\r\n                    inputMetaDataValue.val(inputMetaDataValue.data(\"latestdonevalue\") || \"\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    * Make input field for edit string metadata\r\n    */\r\n    makeDatetimeMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var inputMetaDataValue = $(\"<input></input>\").addClass(\"ecm-metadata-field-edit ecm-metadata-input\").val(spanMetaDataValue.text());\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n        inputMetaDataValue.datepicker({\r\n            dateFormat: self.properties.datePickerFormat,\r\n            changeYear: true,\r\n            onSelect: function (dateText, inst) {\r\n                inputMetaDataValue.val(dateText + \" 00:00 AM\");\r\n            }\r\n        });\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n        // Set event for enter key press\r\n        $(\".ecm-metadata-input\", field).bind(\"keypress\", function (e) {\r\n            if (e.keyCode == 13) {\r\n                $(\".ecm-metadata-done\", control).trigger('click');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Make input field for edit string metadata     \r\n     */\r\n    makeDecimalMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var separator = self.getResource('decimalSymbol');\r\n        self.makeStringMetaDataControler($(this), control, function (value, separator) {\r\n            // validation function\r\n            var reg = new RegExp(\"\\\\d+(\\\\\" + separator + \"\\\\d)*\");\r\n            var valueMatch = value.match(reg);\r\n            return (valueMatch != null && (valueMatch[0] == valueMatch['input'] || valueMatch[1] == undefined));\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Make input field for edit string metadata     \r\n     */\r\n    makeBooleanMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"upload-ecm-view-default-yesno\");\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var metadatavalue = $(field).data(\"value\") || false;\r\n        var checked = bizagi.util.parseBoolean(metadatavalue) ? true : false;\r\n        var randomNumber = Math.ceil(Math.random() * 100);\r\n\r\n        var inputMetaDataValue = $.tmpl(template, { id: self.properties.id, checked: checked, rnd: randomNumber });\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n    },\r\n\r\n    /**\r\n     * Check if file its image or not     \r\n     */\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return ($.inArray(extension.toUpperCase(), image) > -1) ? true : false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode     \r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        if (mode != \"execution\") {\r\n            control.append(\"<div class='ui-icon upload-file'></div>\");\r\n            return;\r\n        }\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-upload\");\r\n\r\n        // Remove upload wrapper\r\n        $(\".biz-render-ecm-upload-wrapper\", control).remove();\r\n\r\n        // First run show render options\r\n        self.properties.showRenderOptions = false;\r\n\r\n        // Call service and render control\r\n        self.renderUploadItem();\r\n\r\n        $(\".emc-options\", control).remove();\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var properties = this.properties;\r\n        var form = this.getFormContainer();\r\n\r\n        var data = {\r\n            url: properties.addUrl,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            xpathContext: properties.xpathContext,\r\n            metaValues: [],\r\n            idPageCache: properties.idPageCache,\r\n            idSession: form.properties.sessionId,\r\n            folder: BIZAGI_PATH_TO_BASE,\r\n            contexttype: properties.contexttype,\r\n            validExtensions: properties.validExtensions,\r\n            maxSize: properties.maxSize\r\n        };\r\n\r\n        var scriptData = {};\r\n        $.extend(scriptData, scriptData, data);\r\n        data.scriptData = scriptData;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server     \r\n     */\r\n    buildUpgradeParams: function (fileControl) {\r\n        var properties = this.properties;\r\n        var form = this.getFormContainer();\r\n\r\n        var data = {\r\n            url: properties.editUrl,\r\n            xPath: properties.xpath,\r\n            idFileUpload: $(\".ecm-options-upgrade > input\", fileControl).data(\"idfileupload\"),\r\n            idPageCache: properties.idPageCache,\r\n            idAttrib: properties.idAttrib,\r\n            xpathContext: this.getXpathContext(),\r\n            idSession: form.properties.sessionId,\r\n            folder: BIZAGI_PATH_TO_BASE,\r\n            validExtensions: properties.validExtensions,\r\n            maxSize: properties.maxSize\r\n        };\r\n\r\n        var scriptData = {};\r\n        $.extend(scriptData, scriptData, data);\r\n        data.scriptData = scriptData;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Check if the max files condition is true to hide the upload link    \r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".biz-render-ecm-upload-wrapper\", control);\r\n        var fileInput = $(\"a\", uploadWrapper);\r\n\r\n        if (properties.maxFiles > 0 && self.filesCount >= properties.maxFiles) {\r\n            uploadWrapper.hide();\r\n        } else if (self.filesCount < properties.maxFiles) {\r\n            // Show upload link\r\n            uploadWrapper.show();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded     \r\n     */\r\n    onUploadFileCompleted: function (renderReference, result) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n\r\n        if (result.type != \"error\") {\r\n\r\n            self.properties.showRenderOptions = false;\r\n            var controlList = $(\".biz-render-ecm-view-default\", control);\r\n            controlList = (controlList.length > 0) ? controlList : $(\".biz-render-ecm-delete-confirmation\", control);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            //Set files in temporal array\r\n            var files = [].concat(self.files);\r\n            files.push([result.idFileUpload, result.fileName]);\r\n\r\n            //Set Value\r\n            self.setValue(files, false);\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n\r\n            self.renderUploadItem(controlList, result);\r\n        } else {\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if all meta data fields that's right     \r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var message = [];\r\n        var error = false;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n\r\n        var isNewRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n        var isValidBase = (properties.required || properties.editable) && !isNewRow ? self._super(invalidElements) : true;\r\n\r\n        if (properties.required) {\r\n            bValid = isNewRow ? true : isValidBase;\r\n\r\n            if (self.filesCount == 0 && bValid) {\r\n\r\n                invalidElements.push({\r\n                    xPath: properties.xpath,\r\n                    message: self.getResource('render-required-text').replaceAll('#label#', properties.displayName)\r\n                });\r\n\r\n                bValid = false;\r\n            }\r\n        }\r\n\r\n        if (properties.editable) {\r\n            bValid = isNewRow ? true : isValidBase;\r\n\r\n            if (!isNewRow) {\r\n                var $arrayEcmControls = $(\"ul:visible\", control).find(\".ecm-metadata-value[data-mandatory='true']\");\r\n\r\n                $.each($arrayEcmControls, function (key, value) {\r\n                    if ($('.ecm-metadata-text', value).text() == \"\") {\r\n                        message.push($(value).data(\"mandatoryfield\"));\r\n                        error = true;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        if (error) {\r\n            var errorMessage = self.getResource('render-required-text').replaceAll('#label#', message.join(', '));\r\n            invalidElements.push({ xPath: properties.xpath, message: errorMessage });\r\n\r\n            // If it has error, enable editable view. Then, open popup\r\n            if ($(\".ecm-options-edit\", control).data('editmode') != \"true\") {\r\n                $(\".ecm-options-edit\", control).trigger('click', { checkData: true });\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setValue(null);\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control     \r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var arrayItems = control.find(\".biz-render-ecm-view-default\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Remove items\r\n        arrayItems.hide();\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n        self.checkMaxFiles();\r\n    },\r\n\r\n    /**\r\n     * Add waiting message     \r\n     */\r\n    waiting: function (ctrl, visible) {\r\n        ctrl.find(\".ecm-file-name\").css(\"visibility\", visible ? \"visible\" : \"hidden\");\r\n        ctrl.find(\"table\").css(\"visibility\", visible ? \"visible\" : \"hidden\");\r\n        ctrl.css(\"background\", visible ? \"\" : \"transparent\");\r\n\r\n        if (visible) {\r\n            ctrl.removeClass(\"waiting\")\r\n        } else {\r\n            ctrl.addClass(\"waiting\")\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Hides the control when click somewhere else          \r\n     */\r\n    configureToggleHandlers: function () {\r\n        $(document.body).off(\"click\").on(\"click\", function (e) {\r\n            if (!$(e.target).hasClass(\"emc-options\") && !$(e.target).hasClass(\"ui-icon-gear\")) {\r\n                $(\".modal-ecm\", this).hide();\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper\").unbind('scroll');\r\n                $(document.body).unbind('click');\r\n            }\r\n        });\r\n\r\n        $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").off(\"scroll\").on(\"scroll\", function (e) {\r\n            if (!$(e.target).hasClass(\"emc-options\") && !$(e.target).hasClass(\"ui-icon-gear\")) {\r\n                $(\".modal-ecm\", this).hide();\r\n                $(document.body).unbind('click');\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper\").unbind('scroll');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Validate required field     \r\n     */\r\n    isValidFields: function (metadataContext) {\r\n        var isValid = true;\r\n        var $arrayEcmControls = $(metadataContext).find(\".ecm-metadata-value[data-mandatory='true']\");\r\n\r\n        $.each($arrayEcmControls, function (key, value) {\r\n            var currentField = $('.ecm-metadata-text', value).text();\r\n            if (bizagi.util.isEmpty(currentField)) {\r\n                isValid = false;\r\n                return;\r\n            }\r\n        });\r\n\r\n        return isValid;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Grid Extension\r\n *   Author: oscaro\r\n *   Comments:\r\n *   -   This script will redefine the grid render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.grid.bizagi\", bizagi.rendering.grid.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.grid.bizagi.extend(\"bizagi.rendering.desktop.grid.bizagi\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self.showActionColumn(data);\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Create a collection to save grid cell changes to execute after it is loaded\r\n        this.pendingActions = [];\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // set collapse grid\r\n        this.collapseState = properties.collapseState;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n    },\r\n\r\n    /*\r\n      If grid has allow some action (Delete, Edit or Detail action), show the action column in grid render.\r\n     */\r\n    showActionColumn: function (data) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var form = self.getFormContainer();\r\n        var editableGrid = bizagi.util.parseBoolean(data.properties.editable) != null ? bizagi.util.parseBoolean(data.properties.editable) : true;\r\n        var columnActions = bizagi.util.parseBoolean(data.properties.columnActions) != null ? bizagi.util.parseBoolean(data.properties.columnActions) : false;\r\n\r\n        // If print version mode then columns actions are disabled\r\n        if (form.getParams() && form.getParams().printversion) {\r\n            columnActions = false;\r\n        }\r\n\r\n        self.columnActionParams = {\r\n            columnActions: columnActions,\r\n            allowDelete: (typeof data.properties.allowDelete == \"undefined\" && editableGrid) ? true : false,\r\n            allowEdit: (typeof data.properties.allowEdit == \"undefined\" && editableGrid) ? true : false,\r\n            allowDetail: (typeof data.properties.allowDetail == \"undefined\") ? false : true,\r\n            withEditForm: (typeof data.properties.withEditForm == \"undefined\") ? false : true\r\n        };\r\n\r\n        if (!data.properties.hideActionsColumn && mode === \"execution\") {\r\n            var actionsColumn = {\r\n                \"render\": {\r\n                    \"properties\": {\r\n                        \"id\": \"e51580f3-fd6c-49c0-8c69-73dff93723e5\",\r\n                        \"type\": \"columnActions\",\r\n                        \"xpath-column\": \"constant(\\\"\\\")\",\r\n                        \"displayName\": \"\",\r\n                        \"submitOnChange\": false,\r\n                        \"totalize\": {\r\n                            \"format\": {}\r\n                        },\r\n                        \"hasTotalizer\": false,\r\n                        \"preventDefault\": true,\r\n                        \"columnwidth\": \"24px\",\r\n                        \"headerStyles\": {\r\n                            \"header\": \"width: 24px\",\r\n                            \"label\": \"width: 24px\"\r\n                        },\r\n                        \"cssclass\": \"bz-grid-header-actions\"\r\n                    }\r\n                }\r\n            };\r\n\r\n            data.elements.splice(0, 0, actionsColumn);\r\n\r\n            self.spliceRowData(data.properties.data, 1);\r\n            self.spliceRowDataVisible(data.properties.data, 1);\r\n            self.spliceRowDataEditable(data.properties.data, 1);\r\n        }\r\n    },\r\n    /*\r\n     *   hasActions\r\n     */\r\n    hasActions: function (columnActionParams) {\r\n        var self = this;\r\n        if (typeof self.columnActionParams === \"undefined\") {\r\n            return false;\r\n        }\r\n        return self.columnActionParams.columnActions && (self.columnActionParams.allowDelete || (self.columnActionParams.allowEdit && self.columnActionParams.withEditForm) || self.columnActionParams.allowDetail);\r\n    },\r\n\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid.bizagi\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Find component holder\r\n        var grid = self.grid = $(\">div\", control);\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Reset new records\r\n        self.cleanNewRecords();\r\n\r\n        self.applyGridPlugin();\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n            if (properties.data === \"\" || (properties.data.rows).length === 0 && properties.data.page > 1) {\r\n                self.fetchData(undefined, self.sortBy, self.sortType);\r\n\r\n            } else {\r\n                self.updateData(properties.data);\r\n\r\n                // Trigger change in order to start up the actions when the controls is ready\r\n                $.when(self.ready())\r\n                    .done(function () {\r\n                        self.triggerRenderChange({changed: false});\r\n                    });\r\n            }\r\n        }\r\n\r\n        self.initialLoadDone = true;\r\n        for (var i in self.pendingActions) {\r\n            if (typeof self.pendingActions[i].method == \"function\") {\r\n                self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n            }\r\n        }\r\n\r\n        // Set tooltip\r\n        var buttonsComponent = $(\"[data-bizagi-component='buttons'] li[title!='']\", self.getControl());\r\n        buttonsComponent.tooltip();\r\n\r\n        buttonsComponent = $(\"[data-bizagi-component='cellContent'] button[title!='']\", self.getControl());\r\n        buttonsComponent.tooltip();\r\n\r\n        // Add tooltips to header\r\n        var columComponent = $(\"[data-bizagi-component='columns'] th > div[title!='']\", self.getControl());\r\n        columComponent.tooltip();\r\n\r\n        //apply columns width\r\n        self.applyColumnsWidth(grid, columns);\r\n    },\r\n\r\n    /**\r\n     * WARNING: This method here is required in order to avoid changes in the font weigth for the grid\r\n     */\r\n    changeFontBold: function () {\r\n        return this;\r\n    },\r\n\r\n    /*\r\n    * Apply grid plugin\r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var pager = self.renderFactory.getTemplate(\"bizagi.grid.pagination\");\r\n\r\n        var form = self.getFormContainer();\r\n        var canvas = form.container;\r\n        if (form.params && form.params.context == \"search\" && form.parent && form.parent.params && form.parent.params.canvas) {\r\n            canvas = form.parent.params.canvas\r\n        } else if (form.params && form.params.canvas) {\r\n            canvas = form.params.canvas;\r\n        }\r\n\r\n        var scrollableArea = canvas.css('overflow-y') == 'scroll' || canvas.css('overflow-y') == 'auto' ? canvas : canvas.scrollParent();\r\n\r\n        grid.bizagi_grid_desktop({\r\n            columns: self.buildColumnModel(),\r\n            showSummary: properties.showSummary,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            scrollableArea: scrollableArea,\r\n            floatingHeader: properties.floatingHeader || false,\r\n            tableCssClass: \"\",\r\n            sortBy: properties.sortBy || \"\",\r\n            collapse: (mode !== \"execution\") ? false : true, // por defecto las grillas seran colapsables en ejecucion\r\n            collapseState: (mode !== \"execution\") ? false : self.collapseState,\r\n            buttonsPst: (mode !== \"execution\") ? false : properties.buttonsPst,\r\n            sortOrder: properties.sortOrder || \"\",\r\n            smartPagination: true,\r\n            sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n            headerStyles: self.getHeaderStyles(),\r\n            orientation: properties.orientation || \"ltr\",\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                gridRtl: self.renderFactory.getTemplate(\"bizagi.grid.grid.rtl\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                rowButtonsRtl: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons.rtl\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: pager,\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                buttonsRtl: self.renderFactory.getTemplate(\"bizagi.grid.buttons.rtl\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                summary: self.renderFactory.getTemplate(\"bizagi.grid.summary\"),\r\n                summaryCell: self.renderFactory.getTemplate(\"bizagi.grid.summaryCell\"),\r\n                exportOptions: self.renderFactory.getTemplate(\"bizagi.grid.exportOptions\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: properties.enableXlsExport,\r\n                enablePdfExport: properties.enablePdfExport\r\n            },\r\n            tooltips: {\r\n                addLabel: properties.addLabel,\r\n                editLabel: properties.editLabel,\r\n                deleteLabel: properties.deleteLabel,\r\n                detailLabel: properties.detailLabel,\r\n                exportOptionsLabel: properties.exportOptionsLabel\r\n            },\r\n            isValid: function () {\r\n                // Validate records \r\n                var errorsMessage = [];\r\n                var form = self.getFormContainer();\r\n\r\n                // fix for SUITE-8696\r\n                if (form.validationController !== undefined) {\r\n                    form.validationController.clearValidationMessages();\r\n                }\r\n\r\n                self.isValid(errorsMessage);\r\n\r\n                if (errorsMessage.length > 0) {\r\n                    // Show validation message\r\n                    for (var i = 0; i < errorsMessage.length; i++) {\r\n                        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                    }\r\n\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                if (self.changes && Object.keys(self.changes).length >= 1) {\r\n                    $.when(self.getFormContainer().saveForm()).done(function () {\r\n                        self.sortRequestedPage(ui);\r\n                    });\r\n                } else {\r\n                    self.sortRequestedPage(ui);\r\n                }\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\" || typeof ui.sortBy === \"undefined\") return;\r\n\r\n                // Get column sort xpath\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                // Perform the sort\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.triggerHandler(\"rowSelected\", {id: ui.key});\r\n            },\r\n            addRow: function () {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.addRow.apply(self, arguments);\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                if (self.properties.withEditForm)\r\n                    self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.moreRows(ui);\r\n            },\r\n            saveAddedRows: function (ui) {\r\n                $.when(self.saveInlineAddedRows(ui.keys)).done(function () {\r\n                    //save edited inline rows\r\n                    if (self.properties.inlineEdit) {\r\n                        self.saveRows();\r\n                    }\r\n                });\r\n            },\r\n            beforeInlineAdd: function () {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function () {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                    self.properties.canBeExported = $(\"li[data-action='save']\", self.grid).is(\":visible\") ? false : true;\r\n                }\r\n            },\r\n            showFormDetails: function (id) {\r\n                self.showFormDetails(id.key);\r\n            },\r\n            cancelEdition: function (ui) {\r\n                ui.refresh = true;\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            showGridExportOptions: function () {\r\n                self.showGridExportOptions();\r\n            },\r\n            performExportGrid: function (printParams) {\r\n                self.performExportGrid(printParams);\r\n            },\r\n            performCollapseGrid: function () {\r\n                self.performCollapseGrid();\r\n            },\r\n            rowdblclick: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                \r\n                if (self.canEditRow())\r\n                    self.editRow(ui.businessKey);\r\n            }           \r\n            \r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Triggers the grid plugin event\r\n    */\r\n    triggerGridPluginHandler: function () {\r\n        try {\r\n            var args = Array.prototype.slice.call(arguments, 0);\r\n            return this.grid.bizagi_grid_desktop.apply(this.grid, args);\r\n        } catch (e) {\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        // Do the same as the post-render            \r\n        this.postRender();\r\n    },\r\n    /**\r\n     *   Creates the column model required to initialize the grid plugin\r\n     */\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            key: true,\r\n            tooltip: \"\"\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                tooltip: column.properties.tooltip || \"\",\r\n                hidden: (!column.properties.visible || column.properties.type == \"columnHidden\" || column.properties.columnVisible == false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n    /**\r\n     * Makes the grid to refresh\r\n     */\r\n    refresh: function () {\r\n        var self = this;\r\n        if (self.parent && self.parent.properties && self.parent.properties.searchParams && self.parent.properties.searchParams.searchTriggeredBy) {\r\n            self.fetchData(1);\r\n        } else {\r\n            self.fetchData();\r\n        }\r\n    },\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function () {\r\n        return this.dataReadyDeferred != null ? this.dataReadyDeferred.promise() : null;\r\n    },\r\n    /*\r\n    * Update data from local changes\r\n    */\r\n    loadChanges: function (rows) {\r\n        var self = this;\r\n        var idRow = [];\r\n        var i;\r\n\r\n        // get data from the rows\r\n        for (i = 0; i < rows.length; i++) {\r\n            idRow.push([rows[i][0], i]); // save id and index\r\n        }\r\n\r\n        for (i = 0; i < idRow.length; i++) {\r\n            var properties = self.changes[idRow[i][0]];\r\n            var index;\r\n\r\n            // search for changes\r\n            if (properties !== undefined) {\r\n                var xpath;\r\n\r\n                index = idRow[i][1];\r\n\r\n                // update all properties in data\r\n                for (xpath in properties) {\r\n                    if (properties.hasOwnProperty(xpath)) {\r\n                        self.assignValue(xpath, rows, index, properties);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    assignValue: function (xpath, rows, index, properties) {\r\n        var self = this;\r\n        var columnData = self.getColumn(xpath);\r\n        var type = columnData.properties.type;\r\n        var columnNumber = columnData.columnIndex;\r\n\r\n        switch (type) {\r\n            case \"columnCombo\":\r\n                var newValue = rows[index][columnNumber];\r\n                var isArray = bizagi.util.isArray(newValue);\r\n\r\n                if (!isArray || (isArray && !newValue.length)) {\r\n                    rows[index][columnNumber] = properties[xpath];\r\n                }\r\n                break;\r\n            default:\r\n                rows[index][columnNumber] = properties[xpath];\r\n                break;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n            self.triggerGridPluginHandler(\"setData\", data);\r\n\r\n            //apply columns width\r\n            self.applyColumnsWidthUpdate(grid, columns);\r\n\r\n            self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n            self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n        }\r\n    },\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n        self.sortBy = sortBy;\r\n        self.sortType = sortType;\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || properties.sortBy || \"\";\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n                self.endLoading();\r\n                if (self.disposed) return;\r\n                if (data) {\r\n\r\n                    if (!properties.hideActionsColumn) {\r\n                        self.spliceRowData(data, 1);\r\n                        self.spliceRowDataVisible(data, 1);\r\n                        self.spliceRowDataEditable(data, 1);\r\n                    }\r\n\r\n                    $.each(self.columns, function (i, column) {\r\n                        var columnProperties = column.properties;\r\n                        if (columnProperties.type === \"columnLabel\") {\r\n                            self.spliceRowData(data, i + 1);\r\n                        }\r\n                    });\r\n                    if (self.isRTL()) {\r\n                        //remove one extra column from backend. A unnecessary guid to Front-End.\r\n                        //In BPM Project a note says:\r\n                        ////NOTES: At this time there is no way to know whether an Entity has Localized attributes,\r\n                        ////so, the Query Engine will always get Guid values for every Parametric Entity\r\n                        data.rows = self.removeRemainingColumns(data.rows, self.columns.length);\r\n\r\n                        data.rows = self.changeOrderData(data.rows);\r\n                    }\r\n                    self.loadChanges(data.rows);\r\n                    self.updateData(data);\r\n\r\n                    if (self.properties.changed !== false || self.properties.method === \"delete\") {\r\n                        self.triggerRenderChange({changed: false});\r\n                        delete self.properties.changed;\r\n                        delete self.properties.method;\r\n                    }\r\n                    if (self.properties.textFormat && typeof (self.properties.textFormat.color) != \"undefined\") {\r\n                        $(\".bz-rn-grid-header-title\", self.grid).style(\"color\", self.properties.textFormat.color, \"important\");\r\n                    }\r\n                    if (self.properties.textFormat && typeof (self.properties.textFormat.background) != \"undefined\") {\r\n                        $(\".bz-rn-grid-cn-header\", self.grid).css(\"backgroundColor\", self.properties.textFormat.background);\r\n                        $(\".bz-rn-grid-container-foother\", self.grid).css(\"backgroundColor\", self.properties.textFormat.background);\r\n                    }\r\n                    $(\"th\", self.grid).css(\"fontWeight\", \"400\");\r\n                    self.dataReadyDeferred.resolve();\r\n                }\r\n            }).fail(function (data) {\r\n            self.endLoading();\r\n        });\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && self.properties.inlineAdd && self.properties.allowEdit) {\r\n            var newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n            var errorsMessage = [];\r\n            var form = self.getFormContainer();\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys && newKeys.length > 0 && self.isValid(errorsMessage)) {\r\n                self.properties.alreadySaved = true;\r\n                return self.saveInlineAddedRows(newKeys, true);\r\n            }\r\n\r\n            if (errorsMessage.length > 0) {\r\n                // Show validation message\r\n                var errDef = $.Deferred();\r\n                for (var i = 0; i < errorsMessage.length; i++) {\r\n                    form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                }\r\n                errDef.reject(\"error\");\r\n                return errDef.promise();\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var saveDeferred;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && (self.properties.inlineAdd || self.properties.inlineEdit)) {\r\n\r\n            try {\r\n                var newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n            } catch (e) {\r\n                newKeys = [];\r\n            }\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys && newKeys.length > 0 && !self.properties.alreadySaved && self.isValid(errorsMessage)) {\r\n                saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n\r\n                // Add to deferred collections in order to sync when saving\r\n                renderValues.deferreds = renderValues.deferreds || [];\r\n                renderValues.deferreds.push(saveDeferred);\r\n            }\r\n\r\n            if ((newKeys && newKeys.length > 0 && !self.isValid(errorsMessage) && saveDeferred)) {\r\n                self.cleanNewRecords();\r\n            }\r\n\r\n            // Remove adding keys from current changes\r\n            for (var i = 0; i < newKeys.length; i++) {\r\n                if (self.changes[newKeys[i]]) {\r\n                    delete self.changes[newKeys[i]];\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    sortRequestedPage: function (ui) {\r\n        var self = this;\r\n        var sortName;\r\n        var getColumn = self.getColumn(ui.sortBy);\r\n\r\n        if (getColumn) {\r\n            sortName = getColumn.getSortName();\r\n        } else {\r\n            getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n            if (getColumn) {\r\n                sortName = getColumn.getSortName();\r\n            }\r\n        }\r\n\r\n        if (ui.sortBy.split(\".\").length > 1) {\r\n            if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                sortName = ui.sortBy;\r\n            }\r\n        }\r\n\r\n        self.fetchData(ui.page, sortName, ui.sortType);\r\n    },\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Fix issue suite-8559, data with null records        \r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) {\r\n            self.cellMetadata[key] = {};\r\n        }\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow && column.bizAgiProperties.type !== \"columnFormLink\") { /*FIX: QAF-1883*/\r\n            editable = true;\r\n        }\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        if (column.bizAgiProperties.type === \"columnActions\") {\r\n            editable = true;\r\n        }\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable) {\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            } else {\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n            }\r\n        } else {\r\n            return \"<label></label>\";\r\n        }\r\n    },\r\n    /*\r\n    *   Draws the editable version for the cell\r\n    */\r\n    drawEditableCell: function (renderColumn, properties, key, value, isNewRow) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = true;\r\n\r\n        // Fix problem when required property lose\r\n        renderColumn.overrideProperties({required: properties.required});\r\n\r\n        // Render cell\r\n        $.when(renderColumn.render(key, value)).done(function (cell) {\r\n            // Register array with new records, just when this is a newrecord\r\n            if (isNewRow && !self.newRecords[key]) {\r\n                self.newRecords[key] = {};\r\n            }\r\n\r\n            // convert all row visible\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = (self.getCellOverride(key, j).visible != undefined) ? self.getCellOverride(key, j).visible : true;\r\n            }\r\n\r\n            // Add change handler\r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\r\n                self.onCellChange(renderColumn, cell, key, args);\r\n            });\r\n\r\n            // Resolve cell\r\n            defer.resolve(cell);\r\n        });\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (key == \"summary\") {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n    /*\r\n    *   Defines the handler when a cell changes its value\r\n    */\r\n    onCellChange: function (renderColumn, cell, key, args) {\r\n        var self = this;\r\n        var _value = renderColumn.getValue(key);\r\n        var compositeValue = renderColumn.getCompositeValue(key);\r\n\r\n        var isNewRecord = self.triggerGridPluginHandler(\"isNewRecord\", key);\r\n        var newKeys;\r\n        var errorsMessage = [];\r\n        var trigger = isNewRecord ? false : true;\r\n        var dataType = renderColumn.properties.type;\r\n\r\n        try {\r\n            if (dataType == \"columnDate\" && renderColumn.data.properties.showTime == true) {\r\n\r\n                if (!bizagi.util.isEmpty(_value)) {\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\r\n                    _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                } else if (_value === \"\") {\r\n                    _value = \"\";\r\n                }\r\n            } else {\r\n\r\n                if (dataType == \"columnDate\") {\r\n\r\n                    if (!bizagi.util.isEmpty(_value)) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\r\n                        date.setHours(0, 0, 0, 0);\r\n                        _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    } else if (_value === \"\") {\r\n                        _value = \"\";\r\n                    }\r\n\r\n                } else {\r\n                    if (dataType === \"columnSearch\") {\r\n\r\n                        var isSubmitOnChange = false;\r\n\r\n                        if (self.properties.submitOnChange)\r\n                            isSubmitOnChange = renderColumn.properties.advancedSearch || false;\r\n\r\n                        if (isNewRecord && self.properties.inlineAdd && isSubmitOnChange) {\r\n                            self.collectGridChange($.extend(args, {\r\n                                id: key,\r\n                                xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                                value: _value,\r\n                                compositeValue: compositeValue,\r\n                                columnIndex: renderColumn.columnIndex,\r\n                                trigger: trigger\r\n                            }));\r\n\r\n                            try {\r\n                                newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n                            } catch (e) {\r\n                                newKeys = [];\r\n                            }\r\n\r\n                            args.render.startActionExecution();\r\n\r\n                            var saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n                            // Remove adding keys from current changes\r\n                            for (var i = 0; i < newKeys.length; i++) {\r\n                                if (self.changes[newKeys[i]]) {\r\n                                    delete self.changes[newKeys[i]];\r\n                                }\r\n                            }\r\n\r\n                            $.when(saveDeferred).done(function () {\r\n                                //Save edited rows\r\n                                if (!bizagi.util.isEmpty(self.changes)) {\r\n                                    self.saveRows();\r\n                                }\r\n\r\n                                args.render.endActionExecution();\r\n                            });\r\n\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            var isExclusiveControl = dataType == \"columnBoolean\" && renderColumn.properties.isExclusive;\r\n\r\n            if (!isExclusiveControl && (self.properties.allowEdit || isNewRecord)) {\r\n                self.collectGridChange($.extend(args, {\r\n                    id: key,\r\n                    xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                    value: _value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: renderColumn.columnIndex,\r\n                    trigger: trigger\r\n                }));\r\n            }\r\n\r\n            if (isExclusiveControl && self.properties.allowEdit) {\r\n                self.triggerGridPluginHandler(\"deleteCellExclusiveValues\", renderColumn.columnIndex);\r\n            }\r\n\r\n            // Update change in grid's component data\r\n            self.triggerGridPluginHandler(\"changeCellValue\", key, renderColumn.columnIndex, _value);\r\n\r\n            // If the column has totalizers then we need to refresh the summary\r\n            if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n                self.triggerGridPluginHandler(\"refreshSummary\", renderColumn.columnIndex);\r\n            }\r\n        } catch (error) {\r\n            bizagi.log(error.message);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var cellOverride = self.getCellOverride(key, columnIndex);\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // apply overrides\r\n        visible = cellOverride.visible;\r\n\r\n        if (column.bizAgiProperties.columnwidth) {\r\n            $(cell).css({\r\n                \"min-width\": column.bizAgiProperties.columnwidth,\r\n                \"max-width\": column.bizAgiProperties.columnwidth\r\n            });\r\n        }\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\")\r\n            editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (column.bizAgiProperties.type === \"columnActions\") {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n\r\n            if (editable) {\r\n\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                        control.properties.submitOnChangexpathContextRow = self.properties.xpath + \"[id=\" + key + \"]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n\r\n            } else {\r\n\r\n                if (key == \"summary\") {\r\n                    //apply styles to summary cells\r\n                    if (!renderColumn.postRenderSummary(key, cell)) {\r\n                        self.applySummaryColumnStyles(cell, properties);\r\n                    }\r\n\r\n                } else {\r\n                    // Call post-render\r\n                    renderColumn.postRenderReadOnly(key, cell);\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get aligning class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        switch (alignType) {\r\n            case 'right':\r\n                return \"ui-bizagi-grid-align-right\";\r\n                break;\r\n            case 'left':\r\n                return \"ui-bizagi-grid-align-left\";\r\n                break;\r\n            case 'center':\r\n                return \"ui-bizagi-grid-align-center\";\r\n                break;\r\n            case 'justify':\r\n                return \"ui-bizagi-grid-align-justify\";\r\n                break;\r\n        }\r\n\r\n    },\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    addRow: function (addFormDialog) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var reverseButtons = properties.orientation == \"rtl\" ? true : false;\r\n        var buttons = [];\r\n\r\n        if (addFormDialog) {\r\n            // Send add request\r\n            if (addFormDialog.open) {\r\n                return;\r\n            } else {\r\n                addFormDialog.open = true;\r\n            }\r\n        }\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n\r\n                // Show dialog with new form after that\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    title: properties.addLabel,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    maximized: bizagi.override.maximizeGridPopup || false,\r\n                    onSave: function (data) {\r\n                        if (properties.contextType) {\r\n                            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                        }\r\n                        return self.submitSaveRequest(newid, data);\r\n                    },\r\n                    onCancel: function () {\r\n                    }\r\n                });\r\n\r\n                buttons[0] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                    click: function (data) {\r\n                        if (properties.contextType) {\r\n                            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                        }\r\n                        return self.submitSaveRequest(newid, data);\r\n                    }\r\n                }\r\n\r\n                buttons[1] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n                    click: function () {\r\n                        self.submitRollbackRequest();\r\n                    }\r\n                }\r\n\r\n                if (reverseButtons)\r\n                    buttons.reverse();\r\n\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    contextType: properties.contextType,\r\n                    url: properties.addPage,\r\n                    mainForm: self.getFormContainer ? self.getFormContainer() : null\r\n                })\r\n                    .done(function () {\r\n                        // Set loading status\r\n                        self.startLoading();\r\n\r\n                        if (!properties.submitOnChange) {\r\n                            // Reload grid\r\n                            self.fetchData();\r\n\r\n                        } else {\r\n                            // Submits the entire form\r\n                            self.submitOnChange().always(function () {\r\n                                self.endLoading();\r\n                            });\r\n                        }\r\n                    })\r\n                    .fail(function (data) {\r\n                        addFormDialog.open = false;\r\n                        $.when(self.submitRollbackRequest(data)).done(function () {\r\n                            self.submitInvalidatePageCacheRequest(data);\r\n                        });\r\n                    });\r\n            });\r\n    },\r\n\r\n    /* Return true of the grid is editable and has edit form*/\r\n    canEditRow: function(){\r\n        var self = this;\r\n        var properties = self.properties;\r\n        return properties.allowEdit && properties.withEditForm && properties.data != null;\r\n    },\r\n    /**\r\n     *  Edits a row in the grid with Form\r\n     *\r\n     */\r\n    editRow: function (id) {\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        //Checks if there is any pending changes in the selected row\r\n        if (self.changes[id] !== undefined) {\r\n\r\n            var data = $.extend(self.changes[id], {});\r\n            data.idPageCache = properties.idPageCache;\r\n            data.disableServerGridValidations = true;\r\n\r\n            $(\".ui-tooltip\").remove();\r\n\r\n            $.when(self.submitSaveRequest(id, data)).done(function () {\r\n\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                if (!properties.submitOnChange) {\r\n                    // Reload grid\r\n                    self.fetchData();\r\n\r\n                } else {\r\n                    // Submits the entire form\r\n                    self.submitForGridChange().always(function () {\r\n                        self.endLoading();\r\n\r\n                        // Send edit request\r\n                        self.executeSubmitEditRequest(id);\r\n                    });\r\n                }\r\n            });\r\n        } else {\r\n            self.executeSubmitEditRequest(id);\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * Gets the format header and builds a object with a css string for label and header\r\n    */\r\n    getHeaderStyles: function () {\r\n        var self = this;\r\n        var label = \"\";\r\n        var header = \"\";\r\n        var properties = self.properties;\r\n\r\n        if (properties.headerFormat) {\r\n            var format = properties.headerFormat;\r\n\r\n            if (format.color) {\r\n                label += \"color: \" + format.color + \" !important;\";\r\n            }\r\n\r\n            if (format.background) {\r\n                header += \"background-color: \" + format.background + \";\";\r\n            }\r\n\r\n            label += \"font-weight: \" + ((format.bold) ? \"bold; \" : \"normal; \");\r\n\r\n            if (format.italic) {\r\n                label += \"font-style: italic; \";\r\n            }\r\n\r\n            if (format.underline || format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\r\n\r\n                label += \"text-decoration: \" + strikethru + underline + \";\";\r\n            }\r\n\r\n            if (format.size && format.size != \"0\") {\r\n                var newFontSize = (100 + Number(format.size) * 10) + \"%\";\r\n                label += \"font-size: \" + newFontSize + \";\";\r\n            }\r\n\r\n        }\r\n\r\n        return {label: label, header: header};\r\n    },\r\n\r\n    /**\r\n     * Deprecated method\r\n     *\r\n     * Edit record without form\r\n     * @param int id\r\n     * @returns\r\n     */\r\n    editInlineRow: function (id) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        // Show save and cancel buttons\r\n        var buttons = $(\"[data-bizagi-component=buttons]\", control);\r\n        buttons.find(\"[data-action=save]\").css(\"display\", \"inline-block\");\r\n        buttons.find(\"[data-action=cancel]\").css(\"display\", \"inline-block\");\r\n\r\n        // Change row to editable\r\n        self.changeRowEditable(id, true);\r\n\r\n    },\r\n    /*\r\n    * Change all cells in the row\r\n    */\r\n    changeRowEditable: function (id, editable) {\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellBackgroundColor(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellBackgroundColor,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control)\r\n                control.changeCellColor(argument);\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellColor,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *   Changes the visibility for a cell\r\n    */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellVisibility(argument);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellVisibility,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Changes the editability for a cell\r\n    */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control && control.control) {\r\n                control.changeEditabilityCellControl(argument, key, xpath);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).editable = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeEditability,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *  Clean data of cell\r\n    */\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.cleanData();\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n                var rows = self.properties.data.rows, i = 0, rowLength = rows.length;\r\n                for (; i < rowLength; i++) {\r\n                    if (Number(key) === rows[i][0]) {\r\n                        rows[i][j + 1] = \"\";\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).value = null;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.cleanData,\r\n                arguments: \"\"\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellRequired(argument);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).required = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({method: self.changeCellRequired, arguments: arguments});\r\n        }\r\n    },\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.setDisplayValue(argument);\r\n                /*ISUPP 3866 */\r\n                var _value = control.column.getValue(key);\r\n                var compositeValue = control.column.getCompositeValue(key);\r\n                control.setDisplayValue(argument);\r\n                var trigger = false;\r\n                control.triggerHandler(\"renderchange\", {render: self, changed: true});\r\n                self.collectGridChange({\r\n                    id: key,\r\n                    xpath: xpath,\r\n                    value: _value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: control.column,\r\n                    trigger: trigger\r\n                });\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.setDisplayValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n    },\r\n    /*\r\n     *   Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeMaxValue(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeMaxValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeMinValue(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeMinValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *  Deletes  a row to the grid\r\n     */\r\n    deleteRow: function (id) {\r\n        var self = this;\r\n\r\n        if (!id || id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n\r\n                $.when(self.saveRows()).done(function () {\r\n                    // Do a grid record deletion\r\n                    $.when(self.submitDeleteRequest(id)).done(function (data) {\r\n                        // Remove temporal record\r\n                        self.removeNewRecords({keys: [id]});\r\n\r\n                        // Check if the answer of request was valid\r\n                        // if there an rule validation on delete action, the answer could be invalid\r\n                        // data.type == \"validationMessage\"\r\n                        if (data.type == \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({rowDeleted: true, changed: false, key: id});\r\n                        }\r\n\r\n                        // Reload grid\r\n                        self.properties.changed = false;\r\n                        self.properties.method = \"delete\";\r\n\r\n                        self.calculateFetchData(data, id);\r\n                    });\r\n                });\r\n\r\n            });\r\n    },\r\n\r\n    calculateFetchData: function (data, id) {\r\n        var self = this, rows;\r\n        var properties = self.properties;\r\n\r\n        if (data.type === \"success\") {\r\n            rows = properties.data && properties.data.rows;\r\n            if (rows.length === 1 && rows[0][0] === Number(id)) {\r\n                if (properties.page > 1) {\r\n                    return self.fetchData(properties.page - 1);\r\n                }\r\n            }\r\n        }\r\n\r\n        return self.fetchData();\r\n    },\r\n\r\n    saveRows: function () {\r\n        var self = this;\r\n        var data = {};\r\n        var form = self.getFormContainer();\r\n\r\n        self.collectData(data);\r\n\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        } else {\r\n            return self.dataService.submitData({\r\n                action: \"save\",\r\n                data: data,\r\n                xpathContext: form.properties.xpathContext,\r\n                idPageCache: form.properties.idPageCache\r\n            });\r\n        }\r\n    },\r\n\r\n    moreRows: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (typeof properties.originalrowsPerPage === \"undefined\") {\r\n            properties.originalrowsPerPage = properties.rowsPerPage;\r\n        }\r\n        properties.rowsPerPage += properties.originalrowsPerPage;\r\n\r\n        var dataToSend = {};\r\n        self.collectData(dataToSend);\r\n\r\n        if (jQuery.isEmptyObject(dataToSend)) {\r\n            self.moreRowsCommon(ui);\r\n            return;\r\n        }\r\n        // Send the data\r\n        self.dataService.submitData({\r\n            action: \"SUBMITDATA\",\r\n            data: dataToSend,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function () {\r\n            self.moreRowsCommon(ui);\r\n        });\r\n\r\n    },\r\n\r\n    moreRowsCommon: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n\r\n        $.when(self.dataReadyDeferred).done(function () {\r\n\r\n            if (properties.records != 0)\r\n                if (properties.records + 1 <= properties.rowsPerPage) {\r\n                    $(\".ui-bizagi-grid-dynamic-pager\", self.getControl()).hide();\r\n                }\r\n\r\n        });\r\n    },\r\n\r\n    executeSubmitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var reverseButtons = properties.orientation == \"rtl\" ? true : false;\r\n        var buttons = [];\r\n\r\n        var showSaveButton = self.getFormContainer().properties.displayAsReadOnly == true ? false : true;\r\n\r\n        $.when(self.submitEditRequest(id))\r\n            .done(function () {\r\n                // Show dialog with new form after that\r\n                var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    title: properties.editLabel,\r\n                    showSaveButton: showSaveButton,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    maximized: bizagi.override.maximizeGridPopup || false,\r\n                    onSave: function (data) {\r\n                        return self.submitSaveRequest(id, data);\r\n                    }, //Setup the print functionality\r\n                    extraButtons: (bizagi.override.enablePrintFromEditForm) ? {\r\n                        \"workportal-widget-dialog-box-print\": function () {\r\n                            self.printFormCommand = new bizagi.workportal.command.printform(self.renderFactory);\r\n\r\n                            var printParams = {\r\n                                idRender: properties.id,\r\n                                recordXPath: recordXpath,\r\n                                xpathContext: properties.xpathContext,\r\n                                idPageCache: properties.idPageCache,\r\n                                requestedForm: \"editForm\",\r\n                                contextType: properties.contextType\r\n                            };\r\n\r\n                            self.printFormCommand.print(printParams);\r\n                        }\r\n                    } : {}\r\n                });\r\n\r\n                buttons[0] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                    click: function (data) {\r\n                        return self.submitSaveRequest(id, data);\r\n                    }\r\n                };\r\n\r\n                if (reverseButtons)\r\n                    buttons.reverse();\r\n\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"editForm\",\r\n                    url: properties.editPage,\r\n                    contextType: properties.contextType\r\n                })\r\n                    .done(function () {\r\n                        // Set loading status\r\n                        self.startLoading();\r\n\r\n                        if (!properties.submitOnChange) {\r\n                            // Reload grid\r\n                            self.fetchData();\r\n\r\n                        } else {\r\n                            // Submits the entire form\r\n                            self.submitOnChange().always(function () {\r\n                                self.endLoading();\r\n                            });\r\n                        }\r\n\r\n                    })\r\n                    .fail(function (data) {\r\n                        $.when(self.submitRollbackRequest(data)).done(function () {\r\n                            self.submitInvalidatePageCacheRequest(data);\r\n                        });\r\n                    });\r\n            });\r\n    },\r\n    /**\r\n     *  Show details with record information\r\n     */\r\n    showFormDetails: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: false,\r\n            maximized: bizagi.override.maximizeGridPopup || false,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\")\r\n        });\r\n\r\n        // Show dialog with new form after that\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        dialog.render({\r\n            idRender: properties.id,\r\n            recordXPath: recordXpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            requestedForm: \"detailForm\",\r\n            url: properties.editPage,\r\n            editable: false\r\n        });\r\n    },\r\n    /*\r\n    *   Retrieve the data for the new rows and push them into the server\r\n    */\r\n    saveInlineAddedRows: function (keys, hasRefresh) {\r\n        var self = this;\r\n        var queue = [];\r\n        hasRefresh = hasRefresh !== undefined ? hasRefresh : true;\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        for (var i = 0; i < keys.length; i++) {\r\n            queue.push(self.prepareAddAction(keys[i]));\r\n        }\r\n\r\n        // Set Flag to prevent duplicate records (modal window)\r\n        self.properties.alreadySaved = true;\r\n\r\n        // Perform the batch\r\n        return $.when.apply($, queue).done(function (response) {\r\n            //Remove new records\r\n            self.cleanNewRecords();\r\n\r\n            // Refresh\r\n            if (hasRefresh) {\r\n                self.properties.changed = false;\r\n                self.refresh();\r\n            }\r\n            $.when(self.dataReady()).done(function () {\r\n                self.triggerRenderChange({changed: false});\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Prepares the add action\r\n    */\r\n    prepareAddAction: function (key) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build submit data\r\n        var submitData = self.changes[key];\r\n\r\n        return self.dataService.multiaction().addGridRecordData({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            submitData: submitData\r\n        });\r\n    },\r\n    /*\r\n    * Removes invalid records\r\n    */\r\n    removeNewRecords: function (ui) {\r\n        var self = this;\r\n        var hasRefresh = false;\r\n\r\n        if (ui && ui.refresh) {\r\n            hasRefresh = (self.changes && Object.keys(self.changes).length > 0) && !self.isValid([]);\r\n        }\r\n\r\n        if (ui && ui.keys) {\r\n            $.each(ui.keys, function (_, key) {\r\n                if (self.newRecords[key]) {\r\n                    delete self.newRecords[key];\r\n                }\r\n            });\r\n        }\r\n\r\n        // Refresh grid\r\n        if (hasRefresh) {\r\n            self.properties.changed = false;\r\n            self.refresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Show the print menu options\r\n    */\r\n    showGridExportOptions: function () {\r\n        var self = this, content, exportPst, changes, container;\r\n        var form = self.getFormContainer();\r\n        var expMenuDirection = (self.properties.buttonsPst === true) ? \"top\" : \"bottom\";\r\n        if (self.properties.orientation == \"rtl\") {\r\n\r\n            content = self.getControl();\r\n            exportPst = (self.properties.buttonsPst === true) ? $('.ui-bizagi-grid-export-options-wrapper-rtl', content).outerHeight() : -1 * $('.ui-bizagi-grid-export-options-content-rtl', content).outerHeight();\r\n            changes = [];\r\n\r\n            //Adjust the print options wrapper to the required position, upper the print options button        \r\n            $('.ui-bizagi-grid-export-options-content-rtl', content).css(\r\n                expMenuDirection, exportPst\r\n            );\r\n\r\n            if ($('.ui-bizagi-grid-export-options-content-rtl', content).hasClass('hidden')) {\r\n                $('.ui-bizagi-grid-export-options-content-rtl', content).removeClass('hidden');\r\n                $('.ui-bizagi-grid-export-options-content-rtl', content).show();\r\n            } else {\r\n                $('.ui-bizagi-grid-export-options-content-rtl', content).addClass('hidden');\r\n                self.grid.find(\".bz-rn-grid-data-wraper\").removeClass(\"bz-rn-grid-data-wraper-fix-w8-scroll\");\r\n            }\r\n            if (form) {\r\n                container = $(form.container);\r\n\r\n                if ((self.hasChanged(changes) && self.properties.alreadySaved === false && form.properties.editable) || (self.properties.canBeExported === false && form.properties.editable)) {\r\n                    if (self.properties.alreadySaved === false && !$(\"li[data-action='save']\", self.grid).is(\":visible\")) {\r\n                        self.properties.canBeExported = true;\r\n                    } else {\r\n                        //when the table has totalizer counts as change,  although that is not a change\r\n                        if (!(Object.keys(self.changes).length == 1 && self.changes.summary)) {\r\n                            $(\"#print-grid-save-first\", content).show();\r\n                            $(\"#print-grid-pdf\", content).hide();\r\n                            $(\"#print-grid-xls\", content).hide();\r\n                        }\r\n                    }\r\n                } else {\r\n                    self.properties.canBeExported = true;\r\n                }\r\n            }\r\n        } else {\r\n\r\n            content = self.getControl();\r\n            exportPst = (self.properties.buttonsPst === true) ? $('.ui-bizagi-grid-export-options-wrapper', content).outerHeight() : -1 * $('.ui-bizagi-grid-export-options-content', content).outerHeight();\r\n            changes = [];\r\n\r\n            //Adjust the print options wrapper to the required position, upper the print options button        \r\n            $('.ui-bizagi-grid-export-options-content', content).css(\r\n                expMenuDirection, exportPst\r\n            );\r\n\r\n            if ($('.ui-bizagi-grid-export-options-content', content).hasClass('hidden')) {\r\n                $('.ui-bizagi-grid-export-options-content', content).removeClass('hidden');\r\n                $('.ui-bizagi-grid-export-options-content', content).show();\r\n            } else {\r\n                $('.ui-bizagi-grid-export-options-content', content).addClass('hidden');\r\n                self.grid.find(\".bz-rn-grid-data-wraper\").removeClass(\"bz-rn-grid-data-wraper-fix-w8-scroll\");\r\n            }\r\n            if (form) {\r\n                container = $(form.container);\r\n\r\n                if ((self.hasChanged(changes) && self.properties.alreadySaved === false && form.properties.editable) || (self.properties.canBeExported === false && form.properties.editable)) {\r\n                    if (self.properties.alreadySaved === false && !$(\"li[data-action='save']\", self.grid).is(\":visible\")) {\r\n                        self.properties.canBeExported = true;\r\n                    } else {\r\n                        //when the table has totalizer counts as change,  although that is not a change\r\n                        if (!(Object.keys(self.changes).length == 1 && self.changes.summary)) {\r\n                            $(\"#print-grid-save-first\", content).show();\r\n                            $(\"#print-grid-pdf\", content).hide();\r\n                            $(\"#print-grid-xls\", content).hide();\r\n                        }\r\n                    }\r\n                } else {\r\n                    self.properties.canBeExported = true;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Executes collapse grid\r\n    */\r\n    performCollapseGrid: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.orientation == \"rtl\") {\r\n            content = self.getControl(),\r\n                $gridWrapper = $(\".bz-rn-grid-wrapper\", content),\r\n                $collapseIcon = $(\".bz-rn-grid-cn-header-rtl .ui-icon\", content);\r\n\r\n            $collapseIcon.toggleClass(\"ui-state-collapse\").toggleClass(\"ui-state-expand\");\r\n            $gridWrapper.toggleClass(\"bz-rn-grid-body-collapse\");\r\n\r\n            self.collapseState = $gridWrapper.hasClass(\"bz-rn-grid-body-collapse\");\r\n            self.triggerGridPluginHandler(\"updateCollapseState\", self.collapseState);\r\n            self.updateCollapseState();\r\n\r\n        } else {\r\n            content = self.getControl(),\r\n                $gridWrapper = $(\".bz-rn-grid-wrapper\", content),\r\n                $collapseIcon = $(\".bz-rn-grid-cn-header .ui-icon\", content);\r\n            $header = $(\".bz-rn-grid-cn-header\", content);\r\n            $header.toggleClass(\"bz-rn-grid-header-state-collapsed\").toggleClass(\"bz-rn-grid-header-state-active\");\r\n\r\n            $collapseIcon.toggleClass(\"ui-state-collapse\").toggleClass(\"ui-state-expand\");\r\n            $gridWrapper.toggleClass(\"bz-rn-grid-body-collapse\");\r\n\r\n            self.collapseState = $gridWrapper.hasClass(\"bz-rn-grid-body-collapse\");\r\n            self.triggerGridPluginHandler(\"updateCollapseState\", self.collapseState);\r\n            self.updateCollapseState();\r\n        }\r\n    },\r\n    /*\r\n     * Update collapse grid state\r\n     */\r\n    updateCollapseState: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        params = {};\r\n\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            collapseState: self.collapseState\r\n        });\r\n\r\n        // example of process property value\r\n        return self.dataService.multiaction().getCollapseData(params);\r\n    },\r\n    /*\r\n    *Executes the grid export\r\n    * @param params (Object) exportType: \"pdfExport\" Handles the print functionality showing a message warning the user\r\n    * to install Adobe Acrobat, if he haven't installed\r\n    */\r\n    performExportGrid: function (params) {\r\n        var self = this;\r\n        var result = true;\r\n        var filePrintUrl = self.getGridExportUrl(params);\r\n\r\n        if (params.exportType == \"pdfExport\") {\r\n            var isAcrobatInstalled = self.checkAdobePlugin();\r\n            if ($.browser.msie && !isAcrobatInstalled) {\r\n                result = false;\r\n\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-acrobat-message\")))\r\n                    .done(function () {\r\n                        self.downloadExportedGrid(filePrintUrl);\r\n                    });\r\n            }\r\n        }\r\n\r\n        if (result)\r\n            self.downloadExportedGrid(filePrintUrl);\r\n    },\r\n\r\n    /*\r\n    * Updates manually the affected cell \r\n    * @param key: the key of the affected cells's column\r\n    * @param newValue: the new value to store in the affected cell\r\n    * @param columnIndex: the column index of the cells's column\r\n    */\r\n    updateAffectedCellManually: function (key, newValue, columnIndex) {\r\n        var self = this;\r\n        var i = self.columns.length;\r\n        var rowIndex = self.getRowIndexByKey(key);\r\n\r\n        //updates the value manually if is different than the current\r\n        if (typeof (rowIndex) !== \"undefined\" && self.properties.data.rows[rowIndex][columnIndex] !== newValue) {\r\n            self.properties.data.rows[rowIndex][columnIndex] = newValue;\r\n\r\n            //Refresh the summary\r\n            var summary = $(\".ui-bizagi-grid-summary\", self.grid);\r\n            summary.empty();\r\n            summary.html(self.grid.bizagi_grid_desktop(\"drawSummary\"));\r\n            self.grid.bizagi_grid_desktop(\"postRenderSummary\", summary);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Get the row index using the key as a reference\r\n    */\r\n    getRowIndexByKey: function (key) {\r\n        var self = this;\r\n        var i = self.properties.data.rows.length;\r\n\r\n        while (i-- > 0) {\r\n            if (key == self.properties.data.rows[i][0]) {\r\n                return i;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Checks if the Adobe Acrobat is installed\r\n    */\r\n    checkAdobePlugin: function (filePrintUrl) {\r\n        var installed;\r\n        try {\r\n            installed = new ActiveXObject('AcroPDF.PDF');\r\n        } catch (e) {\r\n            bizagi.log(e);\r\n        }\r\n\r\n        if (!installed) {\r\n            try {\r\n                // Older Ie\r\n                installed = new ActiveXObject('PDF.PdfCtrl');\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n\r\n        return installed;\r\n    },\r\n    /*\r\n    *   open a new window whith the created file\r\n    */\r\n    downloadExportedGrid: function (filePrintUrl) {\r\n        window.open(filePrintUrl);\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    formatGrid: function (control) {\r\n        //var control = printContent,\r\n        var tableControl = $('.ui-bizagi-grid-table', control);\r\n        var pageContent = $('.ui-pg-table', control);\r\n        var closeButton = $('.ui-jqgrid-titlebar-close', control);\r\n\r\n        $(\"th.ui-bizagi-column-hidden, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother\", control).remove();\r\n\r\n        //Remove click event\r\n        $(\"[data-action], ul li, .ui-bizagi-grid-column, tr, th\", tableControl).unbind(\"click\");\r\n\r\n        // Remove close button\r\n        $(closeButton).remove();\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*\r\n    * Apply Columns Width in postrender\r\n    */\r\n    applyColumnsWidth: function (grid, columns) {\r\n\r\n        for (var i = 0; i < columns.length; i++) {\r\n            var column = grid.find(\".resizableColumn\")[i];\r\n\r\n            if (column) {\r\n                var columnIndex = $(column).find(\">.ui-bizagi-grid-column\");\r\n                var index = columnIndex.length == 1 ? Number($(column).find(\">.ui-bizagi-grid-column\").data(\"column-index\")) : i;\r\n                var columnWidth = columns[index].bizAgiProperties.columnwidth;\r\n                var widthToApply = \"auto\";\r\n\r\n                if (columns[index].bizAgiProperties && columnWidth && columnWidth != \"auto\") {\r\n                    widthToApply = columnWidth;\r\n                }\r\n                $(column).css(\"width\", widthToApply);\r\n                $(column).find(\".ui-bizagi-grid-column\").css(\"width\", \"auto\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Apply Columns Width in update (add or delete a row)\r\n    */\r\n    applyColumnsWidthUpdate: function (grid, columns) {\r\n\r\n        var self = this, index = null, column = null, columnIndex = null, columnWidth = null, widthToApply = null;\r\n        var resizableColumns = grid.find(\".resizableColumn\");\r\n        var length = resizableColumns.length;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            column = resizableColumns[i];\r\n            columnIndex = $(column).find(\">.ui-bizagi-grid-column\");\r\n            index = columnIndex.length == 1 ? (Number($(column).find(\">.ui-bizagi-grid-column\").data(\"column-index\")) - 1) : i;\r\n\r\n            columnWidth = columns[index].properties.columnwidth;\r\n            widthToApply = \"auto\";\r\n\r\n            if (columns[index].properties && columnWidth && columnWidth != \"auto\") {\r\n                widthToApply = columnWidth;\r\n            }\r\n\r\n            $(column).css(\"width\", widthToApply);\r\n            $(column).find(\".ui-bizagi-grid-column\").css(\"width\", \"auto\");\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    *   Apply summary column styles to a specified element\r\n    */\r\n    applySummaryColumnStyles: function (element, properties) {\r\n        var self = this;\r\n        var elementChild = element.find(\".ui-bizagi-grid-summary-readonly\");\r\n\r\n        if (properties.totalize != null && properties.totalize.format != null) {\r\n            var format = properties.totalize.format;\r\n            var textDecorator = \"\";\r\n\r\n            // Set cell back color\r\n            if (format.background) {\r\n                element.css(\"background-color\", format.background);\r\n                element.css(\"background-image\", \"none\");\r\n            }\r\n            if (format.size && format.size != \"0\") {\r\n                var size = format.size.toString();\r\n                var operator = size.substring(0, 1);\r\n                var value = size.substring(1, size.length);\r\n                value = operator == \"+\" ? 100 + (10 * Number(value)) : 100 - (10 * Number(value));\r\n                elementChild.css(\"font-size\", value + \"%\");\r\n            }\r\n            if (format.italic) {\r\n                elementChild.css(\"font-style\", \"italic\");\r\n            }\r\n            if (format.color) {\r\n                elementChild.css(\"color\", format.color);\r\n            }\r\n            if (format.underline) {\r\n                textDecorator += \"underline \";\r\n            }\r\n            if (format.strikethru) {\r\n                textDecorator += \"line-through\";\r\n            }\r\n            if (format.bold == true || format.bold == undefined) {\r\n                elementChild.css(\"font-weight\", \"bold\");\r\n            }\r\n            elementChild.css(\"text-decoration\", textDecorator);\r\n        }\r\n    },\r\n\r\n    /* Return the icons container*/\r\n    getContainerIcons: function () {\r\n        return $(\"> .ui-bizagi-control > .ui-bizagi-control-wrapper > .ui-bizagi-render-icons\", this.element);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param color\r\n     * @param isLabelFormat\r\n     */\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat !== \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != \"none\") {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\")\r\n                        .each(function (i, element) {\r\n                            self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                        });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    // Container of header\r\n                    self.getControl().find(\"[data-bizagi-component=header] span\").each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n\r\n                    if (!self.properties.editable) {\r\n                        var $tableContext = self.getControl();\r\n\r\n                        self.getElementsToStylize($tableContext).css(\"color\", color, \"!important\");\r\n\r\n                        // Container of content\r\n                        if ((bizagi.override && bizagi.override.enableColorHeaderGrid === true) && self.hasColorHeader()) {\r\n                            $tableContext = $tableContext.find(\"[data-bizagi-component=rows]\");\r\n                        }\r\n\r\n                        self.getElementsToStylize($(\"label\", $tableContext).css(\"color\", color, \"!important\"));\r\n                    }\r\n\r\n                }\r\n            } else {\r\n                this._super(color, isLabelFormat);\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Grouped Grid Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Grouped Grid render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from Grid desktop base\r\nbizagi.rendering.desktop.grid.bizagi.extend(\"bizagi.rendering.desktop.grid.grouped\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        data.properties.hideActionsColumn = true;\r\n        data.properties = self.convertProperties(data.properties);\r\n        // Parse data through group engine\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Create a collection to save grid cell changes to execute after it is loaded\r\n        this.pendingActions = [];\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.withEditForm = properties.allowEdit;\r\n\r\n\r\n        // set collapse grid\r\n        this.collapseState = properties.collapseState;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n\r\n    },\r\n\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Fix issue suite-8559, data with null records\r\n        /* console.log(self.newRecords);*/\r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) {\r\n            self.cellMetadata[key] = {};\r\n        }\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow)\r\n            editable = true;\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n            editable = false;\r\n        }\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable)\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            else\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n\r\n        } else {\r\n            return \"<label></label>\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0)\r\n            editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n\r\n            if (editable) {\r\n\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n\r\n            } else {\r\n\r\n                if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n                    //apply styles to summary cells\r\n                    if (!renderColumn.postRenderSummary(key, cell)) {\r\n                        self.applySummaryColumnStyles(cell, properties);\r\n                    }\r\n\r\n                } else {\r\n                    // Call post-render\r\n                    renderColumn.postRenderReadOnly(key, cell);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    // Reserverd to make convertions of control properties\r\n    convertProperties: function (properties) {\r\n\r\n        // Change inline add\r\n        properties.inlineAdd = false;\r\n\r\n        // Change inline edit\r\n        properties.inlineEdit = false;\r\n\r\n        return properties;\r\n    },\r\n\r\n    /**\r\n     * WARNING: This method here is required in order to avoid changes in the font weigth for the grid\r\n     */\r\n    changeFontBold: function () {\r\n        return this;\r\n    },\r\n\r\n    /*\r\n    * Applies grid plugin \r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this,\r\n            grid = self.grid,\r\n            properties = self.properties,\r\n            mode = self.getMode();\r\n\r\n        var pager = self.renderFactory.getTemplate(\"bizagi.grid.pagination\");\r\n\r\n        var scrollableArea = self.getFormContainer().params.canvas.scrollParent();\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_grouped_desktop({\r\n            columns: self.buildColumnModel(),\r\n            showSummary: properties.showSummary,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            scrollableArea: scrollableArea,\r\n            floatingHeader: properties.floatingHeader || false,\r\n            tableCssClass: \"\",\r\n            sortBy: properties.sortBy || \"\",\r\n            sortOrder: properties.sortOrder || \"\",\r\n            smartPagination: true,\r\n            collapse: (mode !== \"execution\") ? false : true, // por defecto las grillas seran colapsables en ejecucion\r\n            collapseState: (mode !== \"execution\") ? false : self.collapseState,\r\n            buttonsPst: (mode !== \"execution\") ? false : properties.buttonsPst,\r\n            sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n            headerStyles: self.getHeaderStyles(),\r\n            groupByColumns: self.groupByColumns() || [],\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.grouped.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.grouped.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.grouped.row\"),\r\n                headerRow: self.renderFactory.getTemplate(\"bizagi.grid.grouped.header.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                emptyCell: self.renderFactory.getTemplate(\"bizagi.grid.grouped.emptyCell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: pager,\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                summary: self.renderFactory.getTemplate(\"bizagi.grid.grouped.summary\"),\r\n                summaryCell: self.renderFactory.getTemplate(\"bizagi.grid.grouped.summaryCell\"),\r\n                exportOptions: self.renderFactory.getTemplate(\"bizagi.grid.exportOptions\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: properties.enableXlsExport,\r\n                enablePdfExport: properties.enablePdfExport\r\n            },\r\n            tooltips: {\r\n                addLabel: properties.addLabel,\r\n                editLabel: properties.editLabel,\r\n                deleteLabel: properties.deleteLabel,\r\n                detailLabel: properties.detailLabel,\r\n                exportOptionsLabel: properties.exportOptionsLabel\r\n            },\r\n            isValid: function () {\r\n                // Validate records\r\n                var errorsMessage = [];\r\n                var form = self.getFormContainer();\r\n\r\n                // fix for SUITE-8696\r\n                if (form.validationController !== undefined) {\r\n                    form.validationController.clearValidationMessages();\r\n                }\r\n\r\n                self.isValid(errorsMessage);\r\n\r\n                if (errorsMessage.length > 0) {\r\n                    // Show validation message\r\n                    for (var i = 0; i < errorsMessage.length; i++) {\r\n                        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                    }\r\n\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                // Get column sort xpath\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                // Perform the sort\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.triggerHandler(\"rowSelected\", {id: ui.key});\r\n            },\r\n            addRow: function () {\r\n                if (mode !== \"execution\") return;\r\n                self.addRow.apply(self, arguments);\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                if (self.properties.withEditForm) {\r\n                    self.editRow(ui.key);\r\n                }\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.moreRows(ui);\r\n            },\r\n            saveAddedRows: function (ui) {\r\n                self.saveInlineAddedRows(ui.keys);\r\n            },\r\n            beforeInlineAdd: function () {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function () {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                }\r\n            },\r\n            showFormDetails: function (id) {\r\n                self.showFormDetails(id.key);\r\n            },\r\n            cancelEdition: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            showGridExportOptions: function () {\r\n                self.showGridExportOptions();\r\n            },\r\n            performExportGrid: function (printParams) {\r\n                self.performExportGrid(printParams);\r\n            },\r\n            performCollapseGrid: function () {\r\n                self.performCollapseGrid();\r\n            },\r\n            rowdblclick: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                \r\n                if (self.canEditRow())\r\n                    self.editRow(ui.businessKey);\r\n            } \r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns an array with the position of columns set to group by property\r\n    */\r\n    groupByColumns: function () {\r\n        var self = this;\r\n        var groupByColumns = [];\r\n\r\n        for (var i = 0, l = self.columns.length; i < l; i++) {\r\n            var column = self.columns[i];\r\n            if (column.properties.groupBy) {\r\n                groupByColumns.push(i + 1);\r\n            }\r\n        }\r\n\r\n        return groupByColumns;\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    triggerGridPluginHandler: function () {\r\n        var self = this;\r\n        var args = Array.prototype.slice.call(arguments, 0);\r\n\r\n        return self.grid.bizagi_grid_grouped_desktop.apply(self.grid, args);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || (properties.sortBy || \"id\");\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData()).then(function (data) {\r\n            self.endLoading();\r\n            if (self.disposed) return;\r\n            if (data) {\r\n                self.loadChanges(data.rows);\r\n                self.updateData(data);\r\n                self.triggerRenderChange();\r\n                self.dataReadyDeferred.resolve();\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Search Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the search render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.search\", bizagi.rendering.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    CLEAR_SEARCH_ID: -3,\r\n    NO_RESULTS_SEARCH_ID: -4,\r\n    SEARCH_DELAY: 750,\r\n    SEARCH_MAX_RECORDS: 50\r\n}, {\r\n    /**\r\n     *   Update or init the element data\r\n     * @param {} data submitData\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.searchImage = properties.searchImage || this.dataService.getSearchDefaultImage();\r\n\r\n        // Store reference of all ajax request in order to run only one instance of them\r\n        var deferredReference = null;\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Apply plugin\r\n        self.searchInput = $(\"input\", control);\r\n        self.advancedSearch = $(\"button\", control);\r\n\r\n        if (self.properties.advancedSearch) {\r\n            control.addClass('ui-bizagi-advanced-search');\r\n        }\r\n\r\n        self.applyAutocompletePlugin();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.setDisplayValue(this.properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind select event\r\n        var searchInput = self.searchInput;\r\n        searchInput.bind(\"autocompleteselect\", function (e, ui) {\r\n            // ui.item.id == self.Class.CLEAR_SEARCH_ID || was taken off in order to allow rule execution when clicking on clear\r\n            if (ui.item.id == self.Class.ADVANCED_SEARCH_ID || ui.item.id == self.Class.ADVANCED_ADDITION_ID || ui.item.id == self.Class.CLEAR_SEARCH_ID || ui.item.id == self.Class.NO_RESULTS_SEARCH_ID)\r\n                return false;\r\n\r\n            self.setValue(ui.item);\r\n            self.selectedValue = ui.item.value;\r\n\r\n            // Format additional label\r\n            ui.item.value = self.formatItem(ui.item.value);\r\n\r\n            //IE 8 Focus fix - SUITE-9517\r\n            if (document.selection) {\r\n                // Set focus on the element\r\n                searchInput.focus();\r\n\r\n                // Create empty selection range\r\n                var oSel = document.selection.createRange();\r\n\r\n                // Move selection start and end to 0 position\r\n                oSel.moveStart(\"character\", -self.selectedValue.length);\r\n\r\n                // Move selection start and end to desired position\r\n                oSel.moveStart(\"character\", 0);\r\n                oSel.moveEnd(\"character\", self.selectedValue.length);\r\n                oSel.select();\r\n            }\r\n\r\n            return true;\r\n        });\r\n\r\n        self.bind(\"onSearchError\", function (e, data) {\r\n            var form = self.getFormContainer();\r\n            form.clearValidationMessages();\r\n\r\n            try {\r\n                //Add information of cotrol\r\n                var msgObj = self.properties.displayName + \": \";\r\n                msgObj += JSON.parse(data.responseText).message;\r\n                form.addValidationMessage(msgObj, \"\", \"ui-icon-alert\");\r\n            } catch (e) {\r\n                // If data does not json string, show data content\r\n                form.addValidationMessage(data);\r\n            }\r\n\r\n            self.hideAutocompleteLoading();\r\n        });\r\n\r\n        // Bind click event\r\n        searchInput.click(function () {\r\n            // close if already visible\r\n            if (searchInput.autocomplete(\"widget\").is(\":visible\")) {\r\n                searchInput.autocomplete(\"close\");\r\n                return;\r\n            }\r\n\r\n            searchInput.autocomplete(\"search\", $(searchInput).val());\r\n        });\r\n\r\n        // Bind click event\r\n        self.advancedSearch.click(function () {\r\n            self.showSearchDialog();\r\n        });\r\n\r\n        // Allow delete item If It's a suggest and \"allow clear\" property is enable\r\n        if (!self.properties.advancedSearch) {\r\n            var suggestFocus = function (event) {\r\n                var value = $.trim(this.value);\r\n\r\n                if (this.value === \"\" && self.properties.allowClear) {\r\n                    var value = {id: \"\"};\r\n\r\n                    self.setDisplayValue(value);\r\n                    self.setValue(value, false);\r\n                } else {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n            };\r\n\r\n            searchInput.on(\"blur\", suggestFocus);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply autocomplete capabilities to a single input\r\n     * @returns {}\r\n     */\r\n    applyAutocompletePlugin: function () {\r\n        var self = this;\r\n        var searchInput = self.searchInput;\r\n        var orientation = self.getFormContainer().properties.orientation;\r\n        var alignForSuggest = orientation == \"rtl\" ? \"right\" : \"left\";\r\n        var rtlClassForSuggest = orientation == \"rtl\" ? \" suggest-rtl\" : \"\";\r\n\r\n        // Apply autocomplete plugin\r\n        searchInput.autocomplete({\r\n            autoFocus: true,\r\n            messages: {\r\n                noResults: null, //\"No search results.\",\r\n                results: function () {\r\n                }\r\n            },\r\n            search: function (event, ui) {\r\n            },\r\n            source: function (req, add) {\r\n                // active search\r\n                self.activeRequestTerm = req.term;\r\n\r\n                // Check local storage\r\n                var now = new Date().getTime();\r\n                var parseRequest = encodeURIComponent(req.term);\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n                var expire = bizagi.util.getItemLocalStorage(expireKey);\r\n\r\n                if (expire && self.properties.enableLocalStorage && now < expire) {\r\n                    try {\r\n                        var data = JSON.parse(bizagi.util.getItemLocalStorage(requestKey));\r\n                        add(data);\r\n                        self.hideAutocompleteLoading();\r\n                    } catch (e) {\r\n                        self.processRequest(req, add);\r\n                    }\r\n                } else {\r\n                    self.processRequest(req, add);\r\n                }\r\n            },\r\n            open: function () {\r\n                var suggestMenu = searchInput.data(\"ui-autocomplete\").menu.element;\r\n                var suggestStyles = {top: 0, left: 0};\r\n                var suggestContainer = searchInput.closest(\".ui-bizagi-control\");\r\n                var controlContainer = suggestContainer.parent();\r\n                var itemWidth = self.calculateSuggestionWidth();\r\n                var menu = searchInput.data(\"ui-autocomplete\").menu;\r\n\r\n                $('li', suggestMenu).each(function () {\r\n                    $(this).addClass(rtlClassForSuggest);\r\n\r\n                    if ($(this).index() % 2 < 1) $(this).addClass(\"biz-ui-even\");\r\n                });\r\n\r\n                // Fix position to prevent the scroll of autocomplete\r\n                suggestMenu.css(suggestStyles);\r\n                suggestContainer.addClass(\"ac-is-visible\");\r\n                controlContainer.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n                suggestMenu.appendTo(suggestContainer).position({\r\n                    my: alignForSuggest + \" top\",\r\n                    at: alignForSuggest + \" bottom\",\r\n                    of: this,\r\n                    collision: \"flipfit\"\r\n                });\r\n\r\n                suggestMenu.css(\"z-index\", $.getMaxZindex() + 10);\r\n\r\n                // Add data to check if element is visible\r\n                suggestMenu.attr(\"visible\", true);\r\n\r\n                // Apply with to menu and items\r\n                $(\".ui-bizagi-render-search-item\", suggestMenu).width(itemWidth);\r\n                suggestMenu.width(itemWidth);\r\n                self.hideAutocompleteLoading();\r\n            },\r\n            close: function () {\r\n                searchInput.data(\"ui-autocomplete\").menu.element.attr(\"visible\", false);\r\n            },\r\n            delay: this.Class.SEARCH_DELAY\r\n        });\r\n\r\n        // Special rendering\r\n        searchInput.data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n            // Render for clear search\r\n            if (item.id == self.Class.CLEAR_SEARCH_ID) {\r\n                return self.renderClearItem(ul, item).appendTo(ul);\r\n            }\r\n            // Render for advanced search\r\n            if (item.id == self.Class.ADVANCED_SEARCH_ID) {\r\n                return self.renderAdvancedItem(ul, item).appendTo(ul);\r\n            }\r\n\r\n            // Render for allow addition\r\n            if (item.id == self.Class.ADVANCED_ADDITION_ID) {\r\n                return self.renderAddItem(ul, item).appendTo(ul);\r\n            }\r\n\r\n            // Normal rendering\r\n            return self.renderSearchItem(item).appendTo(ul);\r\n        };\r\n    },\r\n\r\n    /**\r\n     *   Renders a search item\r\n     * @param {} item\r\n     * @returns {}\r\n     */\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchItem\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            image: properties.searchImage,\r\n            label: item.label,\r\n            orientation: self.properties.orientation || \"lrt\"\r\n        });\r\n\r\n        searchItem.data(\"item.autocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the advanced item\r\n     * @returns {}\r\n     */\r\n    renderAdvancedItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.ADVANCED_SEARCH_ID,\r\n            label: this.getResource(\"render-search-advanced-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            self.showSearchDialog();\r\n        });\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the advanced item\r\n     * @returns {}\r\n     */\r\n    renderClearItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.CLEAR_SEARCH_ID,\r\n            label: this.getResource(\"render-search-clear-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            var value = {id: \"\"};\r\n\r\n            self.setDisplayValue(value);\r\n            self.setValue(value);\r\n\r\n            // Submit info to server\r\n            self.readyActionExecution().done(function () {\r\n                if (self.properties.submitOnChange) {\r\n                    self.submitData();\r\n                }\r\n            });\r\n        });\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the add item\r\n     * @returns {}\r\n     */\r\n    renderAddItem: function () {\r\n        var data = {id: this.Class.ADVANCED_ADDITION_ID, label: this.getResource(\"render-search-add-label\")};\r\n        var searchItem = this.renderSearchItem(data);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     *   Process the request data for the autocomplete control\r\n     * @param {} req\r\n     * @param {} add\r\n     * @returns {}\r\n     */\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if (self.properties.allowSuggest && (req.term.length >= self.properties.searchLength)) {\r\n            self.showAutocompleteLoading();\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n\r\n            /**\r\n             * Cancel previous request in order to improve the performance\r\n             */\r\n            if (this.deferredReference && typeof this.deferredReference.reject === \"function\" && this.deferredReference.state() !== \"resolved\") {\r\n                this.deferredReference.reject({hideStatus: true});\r\n            }\r\n\r\n            self.deferredReference = this.getData().done(function (data) {\r\n\r\n                if (data && data.length > 0) {\r\n                    data = data.slice(0, properties.maxRecords);\r\n\r\n                    if (data.length > self.Class.SEARCH_MAX_RECORDS) {\r\n                        data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\r\n\r\n                        suggestions.push({\r\n                            id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                            label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                            value: \"\"\r\n                        });\r\n                    } else {\r\n                        data = data.slice(0, properties.maxRecords);\r\n                    }\r\n\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords == 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n\r\n                            suggestions.push({id: val.id, label: parseValue, value: val.value});\r\n                        }\r\n                    });\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: \"\"\r\n                    });\r\n                }\r\n\r\n                addToSuggestions(suggestions, req.term);\r\n\r\n                self.hideAutocompleteLoading();\r\n            });\r\n        } else {\r\n            addToSuggestions(suggestions, req.term);\r\n        }\r\n\r\n        /*\r\n        *   Method to add the special items to the suggestions\r\n        */\r\n        function addToSuggestions(allSuggestions, request) {\r\n            // Add the clear option\r\n            if (properties.allowClear && self.value !== undefined) {\r\n                allSuggestions.push({id: self.Class.CLEAR_SEARCH_ID, label: \"\", value: \"\"});\r\n            }\r\n            // Add additional option if advanced search is on\r\n            if (properties.advancedSearch) {\r\n                allSuggestions.push({id: self.Class.ADVANCED_SEARCH_ID, label: \"\", value: \"\"});\r\n            }\r\n\r\n            // Add additional option if allow addition is on\r\n            if (properties.allowAdd) {\r\n                allSuggestions.push({id: self.Class.ADVANCED_ADDITION_ID, label: \"\", value: \"\"});\r\n            }\r\n\r\n            // Create local storage to improve the speed\r\n            var expireTime = new Date().getTime() + self.properties.expireCache;\r\n            var parseRequest = encodeURIComponent(request);\r\n\r\n            if (self.properties.enableLocalStorage) {\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n\r\n                bizagi.util.setItemLocalStorage(expireKey, expireTime);\r\n                bizagi.util.setItemLocalStorage(requestKey, JSON.encode(allSuggestions));\r\n            }\r\n\r\n            // Pass array to callback\r\n            add(allSuggestions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the desired width for the suggestion menu\r\n     * @returns {}\r\n     */\r\n    calculateSuggestionWidth: function () {\r\n        var suggestMenu = this.searchInput.data(\"ui-autocomplete\").menu.element;\r\n        return suggestMenu.width();\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var label = \"\";\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (value != undefined && value != null) {\r\n            if (properties.editable) {\r\n                if (typeof (value.value) !== \"undefined\" && value.value) {\r\n                    self.searchInput.val(self.formatItem(value.value));\r\n\r\n                    self.setValue({id: self.getValueId(value), label: self.getValueLabel(value)});\r\n                } else if (value.additionallabel && value.label) {\r\n                    label = value.label + \" - \" + value.additionallabel;\r\n                    self.searchInput.val(label);\r\n                } else if (value.label) {\r\n                    self.searchInput.val(value.label);\r\n                } else if (value && typeof value.id !== \"undefined\" && value.id === \"\") {\r\n                    self.searchInput.val(\"\");\r\n                } else if (typeof value != \"object\") {\r\n                    self.searchInput.val(value);\r\n                }\r\n            } else {\r\n                var control = self.getControl();\r\n\r\n                label = value.label || value.value;\r\n\r\n                if (typeof (label) !== \"undefined\") {\r\n                    if (typeof label == \"object\") {\r\n                        label = label.join(\" - \");\r\n                    }\r\n                } else {\r\n                    label = \"\";\r\n                }\r\n\r\n                if (typeof (label) === \"string\") {\r\n                    if (value.additionallabel) {\r\n                        label += \" - \" + value.additionallabel;\r\n                    }\r\n\r\n                    label = bizagi.util.sanitizeHTML(label);\r\n                }\r\n\r\n                control.html(label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the value to display, ex. non-editable renders\r\n     * @returns {}\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * Open Add new record dialog\r\n     * @returns {}\r\n     */\r\n    showAddRecordDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var buttons = {\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n            click: function () {\r\n                // Show dialog with add form\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    showSaveButton: properties.editable,\r\n                    title: bizagi.localization.getResource(\"render-dialog-entity\"),\r\n                    orientation: self.properties.orientation || \"ltr\",\r\n                    onSave: function (data) {\r\n                        // Remove pagecache from data\r\n                        var idPageCache = data.idPageCache;\r\n                        var defer = $.Deferred();\r\n\r\n                        var params = {\r\n                            action: \"SAVE\",\r\n                            data: data,\r\n                            idPageCache: idPageCache,\r\n                            guidEntity: properties.entity,\r\n                            contexttype: \"entity\"\r\n                        };\r\n\r\n                        // Check if the add form has data\r\n                        var formData = {};\r\n                        // Turn on flag to force to collect all data on the form\r\n                        $.forceCollectData = true;\r\n\r\n                        dialog.form.collectRenderValues(formData);\r\n\r\n                        // Turn off flag\r\n                        $.forceCollectData = false;\r\n\r\n                        if (!bizagi.util.isMapEmpty(formData)) {\r\n                            $.when(self.dataService.submitData(params)).done(function (response) {\r\n\r\n                                // Set the previous added record to search grid form\r\n                                function dataHasXpath(xpath) {\r\n                                    var render = self.searchDialog.currentSearchForm.getRender(xpath);\r\n\r\n                                    if (typeof render == \"object\" && render != null) {\r\n                                        return {\"found\": true, \"obj\": render};\r\n                                    }\r\n\r\n                                    return {\"found\": false, \"obj\": {}};\r\n                                }\r\n\r\n                                for (var i in formData) {\r\n                                    var mapping = dataHasXpath(i);\r\n                                    if (mapping.found) {\r\n                                        mapping.obj.setValue(formData[i]);\r\n                                        self.setDisplayValueToControl(mapping.obj, dialog.form, i, formData);\r\n                                    }\r\n                                }\r\n\r\n                                self.searchDialog.currentSearchForm.performSearch({\r\n                                    allowFullSearch: properties.allowFullSearch,\r\n                                    maxRecords: properties.maxRecords\r\n                                });\r\n\r\n                                defer.resolve(data);\r\n                                dialog.closeDialogBox();\r\n                            }).fail(function (jqXHR, type, message) {\r\n                                if (type == \"parsererror\") {\r\n                                    defer.resolve({\r\n                                        type: \"error\",\r\n                                        message: message.message\r\n                                    });\r\n                                } else {\r\n                                    defer.reject(arguments);\r\n                                }\r\n                            });\r\n                        } else {\r\n                            // Form has not data\r\n                            bizagi.showMessageBox(self.getResource(\"render-search-advanced-no-filters\"), \"\", \"error\");\r\n                            defer.resolve();\r\n                        }\r\n\r\n                        return defer.promise();\r\n                    },\r\n                    close: function () {\r\n                        dialog.dialog('destroy');\r\n                        dialog.remove();\r\n                    }\r\n                });\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    guidEntity: properties.entity,\r\n                    contextType: 'entity'\r\n                }).fail(function () {\r\n\r\n                });\r\n            }\r\n        };\r\n\r\n        return {buttons: buttons};\r\n    },\r\n\r\n    /**\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function (renderControlSearchForm, addForm, xpath, formData) {\r\n        if (renderControlSearchForm.properties.type === \"searchSuggest\") {\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        } else {\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Opens the search dialog\r\n     * @returns {}\r\n     */\r\n    showSearchDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var extraButtons;\r\n        var contextType = (properties.searchForms.length > 0 && properties.searchForms[0].type === \"searchForm\") ? \"metadata\" : \"entity\";\r\n\r\n        // Define add button\r\n        if (properties.allowNew) {\r\n            extraButtons = self.showAddRecordDialog();\r\n        }\r\n\r\n        // Show search dialog\r\n        self.searchDialog = new bizagi.rendering.dialog.search(self.dataService, self.renderFactory, properties.searchForms, {\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords,\r\n            orientation: properties.orientation || \"ltr\"\r\n        }, extraButtons);\r\n\r\n        self.searchDialog.render({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: contextType,\r\n            orientation: properties.orientation || \"ltr\"\r\n        }).done(function (item) {\r\n            // Set data\r\n            self.setValue(item);\r\n\r\n            self.readyActionExecution().done(function () {\r\n                var form = self.getFormContainer();\r\n\r\n                if (!self.properties.submitOnChange) {\r\n                    $.when(form.submitData()).done(function () {\r\n                        self.refreshControl();\r\n                    });\r\n                }\r\n            });\r\n\r\n        });\r\n    },\r\n\r\n    showAutocompleteLoading: function () {\r\n        $(\"i\", this.getControl()).addClass(\"ui-autocomplete-loading\");\r\n    },\r\n\r\n    hideAutocompleteLoading: function () {\r\n        $(\"i\", this.getControl()).removeClass(\"ui-autocomplete-loading\");\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     * @returns {}\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var value = {id: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n    \r\n    /**\r\n     * Get valid id of control\r\n     * @param value\r\n     * @returns {number}\r\n     */\r\n    getValueId: function (value) {\r\n        var currentId = value.id || \"\";\r\n\r\n        // Check if it's a virtual entity\r\n        if (bizagi.util.isString(currentId) && (/idEntity(.*)businessKey/ig.test(currentId))) return currentId;\r\n        return bizagi.util.isNumeric(currentId) ? currentId : value.value;\r\n    },\r\n\r\n    /**\r\n     * Check valid label of control\r\n     * @param value\r\n     */\r\n    getValueLabel: function(value) {\r\n        var displayValue = value.label;\r\n\r\n        if (!bizagi.util.isString(displayValue) && bizagi.util.isString(value.value)) {\r\n            displayValue = value.value;\r\n        }\r\n\r\n        return displayValue;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Letter Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the letter render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.letter\", bizagi.rendering.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.letter.extend(\"bizagi.rendering.desktop.letter\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render\r\n     * after processed\r\n     */\r\n    postRender: function () {\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        // Stylize button\r\n        button.button();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's\r\n     * behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind event\r\n        button.click(function () {\r\n            // Save the form prior opening the dialog\r\n            $.when(self.saveForm()).done(function () {\r\n                // Show letter dialog\r\n                self.showLetterDialog();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     *  Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var url = self.dataService.getLetterNotEditableUrl({\r\n            idRender: self.properties.id,\r\n            xpath: self.getXpath(),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n\r\n        // Bind click\r\n        $(\".ui-bizagi-render-letter-readonly\", control).click(function () {\r\n            // Save the form prior opening the link\r\n            $.when(self.saveForm()).done(function () {\r\n                $.when(self.getCanGenerateLetter())\r\n                    .done(function (wasGenerated) {\r\n                        // Save content in server\r\n                        if (wasGenerated && bizagi.util.parseBoolean(wasGenerated.canGenerate))\r\n                        // Open the url in a new window\r\n                            window.open(url);\r\n                        else {\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"render-letter-not-generated\"));\r\n                        }\r\n                    });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Shows letter dialog\r\n     */\r\n    showLetterDialog: function () {\r\n        var self = this;\r\n        var dialog = new bizagi.rendering.dialog.letter(self.dataService, self.renderFactory);\r\n\r\n        $.when(self.getCanGenerateLetter())\r\n            .done(function (wasGenerated) {\r\n                // Save content in server\r\n                if (wasGenerated && bizagi.util.parseBoolean(wasGenerated.canGenerate)) {\r\n                    $.when(self.getLetterContent())\r\n                        .pipe(function (content) {\r\n                            return dialog.render(content);\r\n                        }).done(function (newContent) {\r\n                        // Save content in server\r\n                        self.saveLetterContent(newContent);\r\n                    });\r\n                } else {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-letter-not-generated\"));\r\n                }\r\n            });\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Button Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the button render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base \r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.button\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.button.extend(\"bizagi.rendering.desktop.button\", bizagi.rendering.button.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.button.extend(\"bizagi.rendering.desktop.button\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var button = $(\":button\", control);\r\n        var buttonInput = $(control.find(\"input\"));\r\n\r\n        // Stylize button\r\n        button.button();\r\n\r\n        buttonInput.addClass(\"ui-button--ellipsis\");\r\n        buttonInput.attr(\"title\", $(control.find(\"input\")).val());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind event\r\n        button.on(\"click\", function () {\r\n            //disable button to avoid multiple clicks\r\n            $(\"input\", self.element).attr(\"disabled\", true);\r\n\r\n            // Process button actions\r\n            self.processButton();\r\n\r\n            setTimeout(function () {\r\n                //allow button to be clickeable again\r\n                $(\"input\", self.element).removeAttr(\"disabled\");\r\n            }, 1500);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", this.getControl());\r\n        button.button(\"option\", \"disabled\", \"true\");\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        if (properties.editable) {\r\n\r\n            if (typeof (self.getFormContainer) != \"undefined\")\r\n\r\n                var form = self.getFormContainer();\r\n\r\n            if (bizagi.override.validateGridsOnButtonClick != false && mode == \"execution\" && form &&\r\n                !form.hasValidGrids([])) {\r\n                form.validationController.performValidations();\r\n            } else {\r\n                // Check if action need conformation\r\n                if (properties.needsUserConfirmation) {\r\n                    var htmlMessage = $(\"<div>\").append(properties.userConfirmationMessage);\r\n                    var defer = $.Deferred();\r\n\r\n                    $(htmlMessage).dialog({\r\n                        modal: true,\r\n                        width: 500,\r\n                        height: 250,\r\n                        draggable: false,\r\n                        resizable: true,\r\n                        maximize: false,\r\n                        title: properties.caption || properties.displayName,\r\n                        buttons: [{\r\n                            text: bizagi.localization.getResource(\"confirmation-box-ok\"),\r\n                            click: function () {\r\n                                defer.resolve();\r\n                                self.triggerRenderChange({pressed: true});\r\n                                $(this).dialog(\"close\");\r\n                            }\r\n                        }, {\r\n                            text: bizagi.localization.getResource(\"confirmation-box-cancel\"),\r\n                            click: function () {\r\n                                defer.reject();\r\n                                $(this).dialog(\"close\");\r\n                            }\r\n                        }]\r\n                    });\r\n\r\n                    if (!properties.preventDefault) {\r\n                        $.when(defer.promise()).done(function () {\r\n                            self.runButtonAction();\r\n                        });\r\n                    }\r\n                } else {\r\n                    if (!properties.preventDefault)\r\n                        self.runButtonAction();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange({pressed: true});\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Render fileprint Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.fileprint\", bizagi.rendering.fileprint.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.fileprint.extend(\"bizagi.rendering.desktop.fileprint\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        // Stylize button\r\n        button.button();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        if(properties.filesCount > 0) {\r\n            // Bind event\r\n            button.click(function () {\r\n                // Process button actions\r\n                self.processButton();\r\n            });\r\n        } else {\r\n            button.button(\"option\", \"disabled\", \"true\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var typeForm = form.properties.typeForm;\r\n\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        if (typeForm == \"SummaryForm\" || typeForm == \"GlobalForm\") {\r\n            self.configureHandlers();\r\n        } else {\r\n            button.button(\"option\", \"disabled\", \"true\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var typeForm = form.properties.typeForm;\r\n        \r\n        if (properties.editable || typeForm == \"SummaryForm\" || typeForm == \"GlobalForm\") {\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * This url must be absolute, in portal and sharepoint not apply relative\r\n     * @param {} fileType\r\n     */\r\n    getAbsoluteFilePrintUrl: function (fileType) {\r\n        var time = (new Date()).getTime();\r\n        var filePrintUrl = this.getFilePrintUrl(fileType);\r\n\r\n        if (filePrintUrl.indexOf('http') != -1)\r\n            return filePrintUrl + \"&_=\" + time;\r\n\r\n        filePrintUrl = filePrintUrl.replace(bizagi.services.ajax.pathToBase, \"\");\r\n        filePrintUrl = bizagiConfig.proxyPrefix + filePrintUrl + \"&_=\" + time;\r\n\r\n        if (bizagi.getXSRFToken() != null)\r\n            filePrintUrl += \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        return filePrintUrl;\r\n    },\r\n\r\n    runButtonAction: function() {\r\n        var self = this;\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        var control = self.getControl();\r\n        var fileObject = $(\".fileobj\");\r\n\r\n        if (bizagi.util.isIE() && !bizagi.util.isIE10() && !bizagi.util.isIE11()) {\r\n\r\n            var isAcrobatInstalled = self.checkAdobePlugin();\r\n\r\n            if (!isAcrobatInstalled) {\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-acrobat-message\")))\r\n                    .done(function() {\r\n                        window.open(self.getAbsoluteFilePrintUrl(\"inline\"));\r\n                    });\r\n            } else {\r\n                var template = \"\";\r\n                var counter = 0;\r\n                var message = bizagi.localization.getResource(\"webpart-render-loading\");\r\n\r\n                fileObject.remove();\r\n                template = self.renderFactory.getTemplate(\"fileprint-object\");\r\n\r\n                control.append(\"<label id='loadingMsg'> \" + message + \"</label>\");\r\n                control.append($.tmpl(template, { url: self.getAbsoluteFilePrintUrl(\"inline\") }));\r\n\r\n                var mycounter = setInterval(function() {\r\n\r\n                    if (document.all[\"fileobj\"] && document.all[\"fileobj\"].readyState > 0) {\r\n\r\n                        $(\"#loadingMsg\").remove();\r\n                        $(\".fileobj:last\", control).focus();\r\n\r\n                        if (typeof ($(\".fileobj:last\", control)[0].print) != \"undefined\") {\r\n                            $(\".fileobj:last\", control)[0].print();\r\n                        } else {\r\n                            window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                        }\r\n\r\n                        window.clearInterval(mycounter);\r\n                    } else if (counter >= 10) {\r\n\r\n                        $(\"#loadingMsg\").remove();\r\n\r\n                        $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-print-too-slow\")))\r\n                            .done(function() {\r\n                                var wnd = window.open(self.getAbsoluteFilePrintUrl(\"inline\"));\r\n\r\n                                wnd.onload = function() {\r\n                                    if (typeof (wnd.print) != \"undefined\") {\r\n                                        wnd.print();\r\n                                        wnd.close();\r\n                                    } else {\r\n                                        window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                                    }\r\n                                };\r\n                            });\r\n\r\n                        self.saveForm();\r\n                        window.clearInterval(mycounter);\r\n                    }\r\n                    counter += 1;\r\n                }, 1000);\r\n            }\r\n        } else {\r\n\r\n            if ($.browser.mozilla) {\r\n                window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n            } else {\r\n                // Remove previous iframe\r\n                $(\"iframe\", control).remove();\r\n\r\n                // Render new iframe\r\n                var idFrame = \"bz-render-fileprint-iframe-\" + new Date().getTime();\r\n                var tmpl = self.renderFactory.getTemplate(\"fileprint-iframe\");\r\n                var iframe = $.tmpl(tmpl, { url: self.getAbsoluteFilePrintUrl(\"inline\"), id: idFrame });\r\n\r\n                control.append(iframe);\r\n\r\n                // Print iframe\r\n                var frm = document.getElementById(idFrame).contentWindow;\r\n                if (typeof (frm.print) != \"undefined\" && !bizagi.util.isIE()) {\r\n                    frm.print();\r\n                } else {\r\n                    window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    checkAdobePlugin: function () {\r\n        var installed;\r\n\r\n        try {\r\n            installed = new ActiveXObject('AcroPDF.PDF');\r\n        } catch (e) {\r\n            bizagi.log(e);\r\n        }\r\n\r\n        if (!installed) {\r\n            try {\r\n                // Older IE\r\n                installed = new ActiveXObject('PDF.PdfCtrl');\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n\r\n        return installed;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.link\", bizagi.rendering.render.base.prototype);\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.link.extend(\"bizagi.rendering.desktop.link\", bizagi.rendering.link.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.link.extend(\"bizagi.rendering.desktop.link\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents()\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Solve action to link\r\n     * @param args\r\n     */\r\n    linkSolver: function (args) {\r\n        args = args || {};\r\n        var self = this;\r\n        var url = args.url || \"\";\r\n        var target = args.target || \"_blank\";\r\n\r\n        if (bizagi.override.linkPrefix === true && url) {\r\n            if (url.indexOf(\"http\") === -1 && url.indexOf(\"\\\\\\\\\") === -1) {\r\n                url = \"//\" + bizagi.util.trim(url);\r\n            }\r\n        }\r\n\r\n        switch (args.linkType) {\r\n            case \"newwindow\":\r\n                var windowParamsPatter = \"width=%s,height=%s,resizable,scrollbars=yes,status=1,toolbar=yes\";\r\n                var windowParams = printf(windowParamsPatter, window.screen.width, window.screen.height);\r\n                self.windowObjReference = window.open(url, target, windowParams);\r\n                break;\r\n            case \"newtab\":\r\n                self.windowObjReference = window.open(url, target);\r\n                break;\r\n            default:\r\n                self.windowObjReference = window.open(url, target);\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function (){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        if (properties.value) {\r\n            // Modify href\r\n            link.attr(\"href\", properties.value);\r\n            link.attr(\"target\", \"_blank\");\r\n\r\n            link.click(function () {\r\n                //if the container form of this component is detail, executes the link\r\n                self.linkSolver({linkType: properties.linktarget, url: properties.value});\r\n                return false;\r\n            });\r\n        } else {\r\n            link.addClass(\"ui-state-disabled\");\r\n        }\r\n\r\n        \r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    processLayout: function (isLabelFormat) {\r\n        if(!isLabelFormat){\r\n             this._super(isLabelFormat, this.properties.textFormat);\r\n        } else {\r\n            if(typeof this.properties.textFormat.background !== \"undefined\"){\r\n                this._super(isLabelFormat, { background: this.properties.textFormat.background });\r\n            }\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\".ui-bizagi-render-link\", $context); \r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Template Text Extension\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the layout render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.layoutRender\", bizagi.rendering.layoutRender.prototype);","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutPlaceholder\", bizagi.rendering.layoutPlaceholder.prototype);\r\n","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutBoolean\", bizagi.rendering.layoutBoolean.prototype);","/*\r\n*   Name: Bizagi render layout image\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the non editable image render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutImage\", bizagi.rendering.layoutImage.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutImage.extend(\"bizagi.rendering.desktop.layoutImage\", {}, {\r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n\r\n    postRender: function(){\r\n        \r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.byteArrayToBlob(bizagi.util.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var templateControl = self.parent.parent;\r\n        var renderParams = templateControl.properties.paramsRender || {};\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value,\r\n            idcase: renderParams.idRender ? bizagi.context.idCase : \"_\",\r\n            idworkitem: renderParams.idRender ? bizagi.context.idWorkitem : \"_\",\r\n            contextxpath: renderParams.idRender ? renderParams.xpathActions : \"_\"\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n});","/**\r\n * Name: Bizagi Desktop Render Link Extension\r\n * Author: Andres Fernando Munoz\r\n * Comments:\r\n * -   This script will redefine the non editable link render class to adjust to desktop devices\r\n * -   This control is based on the link render control\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutLink\", bizagi.rendering.layoutLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutLink.extend(\"bizagi.rendering.desktop.layoutLink\", {}, { \r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        // Call base\r\n        self._super();\r\n        if (element) {\r\n            $(element).on('click', $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n    /**\r\n     * When click over link\r\n     */\r\n    onClickElement: function () {\r\n        var self = this;\r\n        var properties = self.properties || {};\r\n        var args = {\r\n            displayName: properties.displayName,\r\n            reference: properties.reference,\r\n            referenceType: properties.referenceType,\r\n            xpath: properties.xpath,\r\n            contextEvent: self.getFormContainer().getContextEvent ? self.getFormContainer().getContextEvent() : ''\r\n        };\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", args);\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Template Label Extension\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will redefine the label render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutLabel\", bizagi.rendering.layoutLabel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutLabel.extend(\"bizagi.rendering.desktop.layoutLabel\", {}, { \r\n\r\n\tsetValue: function(val,triggerEvents) {\r\n\t\tvar self = this;\r\n\t\tself.properties.displayName = val;\r\n\t\tthis._super(val, triggerEvents);\r\n\t\tvar control = self.getControl();\r\n\t\tif(control) {\r\n\t\t\t$(\".ui-bizagi-render-label\", control).text(val);\r\n\t\t}\r\n\t}\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Template Text Extension\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will redefine the text render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutText\", bizagi.rendering.layoutText.prototype);","/*\r\n*   Name: Bizagi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n // Extends from layoutRender desktop base\r\n bizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutDateTime\", bizagi.rendering.layoutDateTime.prototype);","/**\r\n * Name: Bizagi Desktop Render Template number Extension\r\n * Author: Mauricio Sanchez\r\n * Comments:\r\n * - This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutNumber\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutNumber.extend(\"bizagi.rendering.desktop.layoutNumber\", {}, {  \r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() === \"execution\") {\r\n            val = (val === null || val === \"\") ? \"\" : self.getDisplayValue(val);\r\n        }\r\n\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    }\r\n});","/**\r\n * Name: Bizagi Desktop Render Template Money Extension\r\n * Author: Andres Fernando Munoz\r\n * Comments:\r\n * - This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutMoney\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutMoney.extend(\"bizagi.rendering.desktop.layoutMoney\", bizagi.rendering.layoutMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutMoney.extend(\"bizagi.rendering.desktop.layoutMoney\", {}, {\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() === \"execution\") {\r\n            val = (val === null || val === \"\") ? \"\" : self.getDisplayValue(val);\r\n        }\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\n // Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutUpload\", bizagi.rendering.layoutUpload.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutUpload.extend(\"bizagi.rendering.desktop.layoutUpload\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            defer = $.Deferred();\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\")\r\n        {\r\n            $.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n                self.properties = properties;\r\n                self.files = valueResult.files;\r\n                defer.resolve(self.getHTMLFiles(properties));\r\n            });\r\n        }\r\n        else{\r\n            self.files = [];\r\n            defer.resolve(self.getHTMLFiles());\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getHTMLFiles: function(){\r\n        var self = this;\r\n        self.filesCount = self.files.length;\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            noFiles: (self.filesCount == 0)\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = { id: self.files[i][0], fileName: self.files[i][1] };\r\n            items += self.renderUploadItem(file);\r\n        }\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     *   Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     *   Renders a single upload item\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-uploadItem\");\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode != \"execution\")\r\n            url = \"javascript:void(0);\";\r\n\r\n        return $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            id: file.id,\r\n            mode: mode,\r\n            editable: properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Builds the upload item url\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileEntityUrl({\r\n            isContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n            xpath: self.getUploadXpath(),\r\n            fileId: file.id,\r\n            idRender: form.properties.paramsRender.idRender || \"undefined\",\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n            xpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n            sessionId: form.properties.sessionId,\r\n            surrogatekey: self.properties.value.surrogateKey,\r\n            guidentity: self.properties.value.guid\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Form Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.formLink\", {\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, bizagi.rendering.formLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.formLink.extend(\"bizagi.rendering.desktop.formLink\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    openLinkRule: function (property, elLink) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Save form data\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n                if (dataRuleResp.messages != null) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n\r\n                    form.validationController.showErrorMessage(message);\r\n                    def.reject();\r\n                } else {\r\n                    if (property === \"entryrule\")\r\n                        self.openLink(elLink);\r\n                }\r\n                def.resolve();\r\n            }).fail(function (error) {\r\n            def.reject();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type === \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            self.getFormContainer().addErrorMessage(jqXHR.message);\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @param defClose\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data, defClose) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    getDisplayAsReadOnlyValue: function () {\r\n        var self = this;\r\n        return self.getFormContainer() && self.getFormContainer().properties.displayAsReadOnly;\r\n    },\r\n\r\n    closeExitRule: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.hasexitrule && !self.getDisplayAsReadOnlyValue()) {\r\n            $.when(self.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function () {\r\n                def.reject();\r\n            });\r\n        } else {\r\n            def.resolve();\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Opens the link display form inside a dialog\r\n     * @param elLink\r\n     */\r\n    openLink: function (elLink) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof (properties.canBeSaved) == \"undefined\") {\r\n            properties.canBeSaved = true;\r\n        }\r\n\r\n        // When the link is not editable, then the form can't have save button\r\n        if (properties.editable === false) {\r\n            properties.canBeSaved = false;\r\n        }\r\n\r\n        if (form.properties.displayAsReadOnly) {\r\n            properties.canBeSaved = false;\r\n        }\r\n\r\n        $.when(self.getFormContainer().properties.editable ? form.submitData() : undefined).done(function () {\r\n            // Send edit request\r\n            $.when(self.submitEditRequest()).done(function () {\r\n                elLink.prop(\"disabled\", false);\r\n\r\n                // Show dialog with new form after that\r\n                self.dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    showSaveButton: properties.canBeSaved,\r\n                    maximized: properties.maximized,\r\n                    title: properties.displayName,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    onSave: function (data) {\r\n                        var def = new $.Deferred();\r\n\r\n                        var deferredsToWait = null;\r\n                        if (data && data.deferreds) {\r\n                            deferredsToWait = $.when.apply($, data.deferreds);\r\n                            delete data.deferreds;\r\n                        }\r\n\r\n                        $.when(deferredsToWait).then(function () {\r\n\r\n                            self.submitSaveRequest(data, def.promise()).done(function (result) {\r\n                                var executeSubmitOnChange = true;\r\n                                if (result && result.type === \"validationMessages\") {\r\n                                    executeSubmitOnChange = false;\r\n                                    def.resolve(result);\r\n                                }\r\n                                if (properties.hasexitrule) {\r\n                                    self.closeExitRule().done(function () {\r\n                                        if (executeSubmitOnChange) {\r\n                                            $.when(self.submitCommitRequest(), self.submitDataRequest()).done(function () {\r\n                                                var defer = null;\r\n                                                if (properties.hasentryrule) {\r\n                                                    defer = self.submitCommitRequest();\r\n                                                }\r\n                                                $.when(defer).done(function () {\r\n                                                    form.refreshForm();\r\n                                                });\r\n                                            });\r\n                                            def.resolve(result);\r\n                                        }\r\n                                    }).fail(function () {\r\n                                        def.reject();\r\n                                    });\r\n                                } else if (executeSubmitOnChange) {\r\n                                    if (executeSubmitOnChange) {\r\n                                        def.resolve(result);\r\n                                        self.submitCommitRequest().done(function(){\r\n                                            self.submitDataRequest().done(function () {\r\n                                                form.refreshForm();\r\n                                            });\r\n                                        });\r\n\r\n                                        if (properties.hasentryrule)\r\n                                            self.submitCommitRequest();\r\n                                    }\r\n                                }\r\n                            });\r\n\r\n                        });\r\n\r\n                        return def.promise();\r\n                    },\r\n                    close: function () {\r\n                    }\r\n                });\r\n\r\n                self.renderFormLinkDialog();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render Dialog\r\n     */\r\n    renderFormLinkDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // DiegoP: Commented the following lines because it was generating a side effect bug, and it was only intended for plans\r\n        // The idea is that when we use plans, it opens a form link (of the parent activity), and the whole page must be optional (without required fields)\r\n        // but now  when the there is a formlink inside the parent form; it's opening the target form  but the required fields are still required\r\n        // var required = bizagi.util.parseBoolean(properties.required) !== null ? bizagi.util.parseBoolean(properties.required) : true;\r\n\r\n        self.dialog.render({\r\n            idRender: properties.id,\r\n            xpathContext: self.getFormLinkXpathContext(),\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            //required: required,\r\n            url: properties.editPage,\r\n            mainForm: self.getFormContainer ? self.getFormContainer() : null\r\n        }).fail(function (data) {\r\n            // Sends a rollback request to delete checkpoints\r\n            $.when(self.submitRollbackRequest(data)).done(function () {\r\n                //Sends additional rollback request to delete checkpoint from entry rule\r\n                if (properties.hasentryrule){\r\n                    $.when(self.submitRollbackRequest(data)).done(function () {\r\n                        self.submitInvalidatePageCacheRequest(data);\r\n                    });\r\n                }\r\n                else{\r\n                    self.submitInvalidatePageCacheRequest(data);\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var self = this;\r\n        var xpathContext = self.properties.xpathContext;\r\n        var parentXpathContext = self.getXpathContext();\r\n\r\n        if (parentXpathContext && xpathContext) {\r\n            if (xpathContext.indexOf(parentXpathContext) === 0) {\r\n                return xpathContext;\r\n            } else {\r\n                return parentXpathContext + \".\" + xpathContext;\r\n            }\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n        var properties = self.properties;\r\n\r\n        // Define dialog\r\n        self.dialog = null;\r\n\r\n        // Bind click event\r\n        link.click(function () {\r\n            // Open the link inside a dialog\r\n            var elLink = $(this);\r\n            if (properties.hasentryrule && !self.getDisplayAsReadOnlyValue()) {\r\n                var form = self.getFormContainer();\r\n                elLink.prop(\"disabled\", true);\r\n\r\n                $.when(form.submitData()).done(function () {\r\n                    self.submitCheckpointRequest();\r\n                    self.openLinkRule(\"entryrule\", elLink);\r\n                });\r\n            } else {\r\n                elLink.prop(\"disabled\", true);\r\n                self.openLink(elLink);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param color\r\n     */\r\n    changeColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color !== \"none\") {\r\n                self.getControl().find(\"a\").css(\"color\", color, \"!important\");\r\n\r\n                if (typeof (self.getControl().find(\"a\").style) == \"function\") {\r\n                    self.getControl().find(\"a\").style(\"color\", color, \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"a\").css(\"color\", \"\");\r\n\r\n                if (typeof (self.getControl().find(\"a\").style) == \"function\") {\r\n                    self.getControl().find(\"a\").style(\"color\", \"\");\r\n                }\r\n            }\r\n        }\r\n        self._super(color);\r\n    },\r\n    \r\n    changeFontBold: function (){\r\n        var self = this;\r\n        var control = self.getControl().children();\r\n        var textFormat = self.properties.textFormat;\r\n        if(typeof textFormat.bold !== \"undefined\"){\r\n            if (typeof control == \"object\" && control.length > 0) {\r\n                self.getElementsToStylize(control).css(\"font-weight\", \"bold\", \"!important\");\r\n            }    \r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.geolocation\", bizagi.rendering.geolocation.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.geolocation.extend(\"bizagi.rendering.desktop.geolocation\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.postRender();\r\n    },\r\n\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.cordinate = $(\".ui-geolocation-cordinate\", this.getControl());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.isExecutionMode()) {\r\n            var control = self.getControl();\r\n\r\n            // If the control doesn't have a value set the position\r\n            if (self.value == null) {\r\n                self.setDisplayValue().then(function () {\r\n                }).fail(function (msg) {\r\n                    self.cordinate.html(\"<span style='color: red'>\" + msg + \"</span>\");\r\n                });\r\n            }\r\n\r\n            $(\".ui-bizagi-render-geolocation\", control).bind(\"click\", function () {\r\n                self.cordinate.empty();\r\n                // This retun a promise if is usefull\r\n                self.setDisplayValue().then(function () {\r\n                }).fail(function (msg) {\r\n                    self.cordinate.html(\"<span style='color: red'>\" + msg + \"</span>\");\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"span\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(\"\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            self.cordinate.html(self.performPrecision(value));\r\n\r\n            // Set internal value\r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n\r\n            var onSuccess = function (position) {\r\n                var coordinate = position.coords.latitude + \" \" + position.coords.longitude;\r\n\r\n                self.cordinate.html(self.performPrecision(coordinate));\r\n\r\n                // Set internal value\r\n                self.setValue(coordinate, false);\r\n                def.resolve();\r\n            };\r\n\r\n            // onError Callback receives a PositionError object\r\n            var onError = function (msg) {\r\n                self.cordinate.html(self.properties.value);\r\n                def.reject(msg);\r\n            };\r\n\r\n            self.getCurrentPosition(onSuccess, onError);\r\n        }\r\n\r\n        return def.promise();\r\n    }\r\n\r\n});","/**\r\n  *   Name: Bizagi Desktop Render HIdden Extension\r\n  *   Author: UI Forms Team\r\n  *   Comments:\r\n  *   -   This script will redefine the hidden render class to adjust to desktop devices\r\n  */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.hidden\", bizagi.rendering.hidden.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.hidden.extend(\"bizagi.rendering.desktop.hidden\", {}, {\r\n\r\n});","/*\r\n*   Name: Bizagi Desktop Render Money Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the money render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.money\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.money\", bizagi.rendering.money.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.money\", {}, {\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (value !== undefined && value !== null && properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Query Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the query money render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.queryMoney\", {}, {\r\n\r\n    /*\r\n   *   Adds the format currency plugin\r\n   */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.showSymbol) {\r\n            if (properties.symbol == '') {\r\n                if (typeof (bizagi) != \"undefined\")\r\n                    if (properties.dataType == 8 && typeof (bizagi.currentUser) != \"undefined\") {\r\n                        if (typeof (bizagi.currentUser.symbol) != \"undefined\") properties.symbol = bizagi.currentUser.symbol;\r\n                    }\r\n            }\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.radio\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.radio\", bizagi.rendering.radio.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.radio\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n\r\n\r\n        // Apply plugin\r\n        self.radiogroup = $(\".ui-bizagi-render-radio\", control);\r\n        self.radiogroup.optiongroup({orientation: self.properties.orientation});\r\n        if (self.selectedValue) {\r\n            self.radiogroup.optiongroup(\"setValue\", self.selectedValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind handler\r\n        self.radiogroup.bind(\"optiongroupchange\", function (event, ui) {\r\n            // Updates internal value\r\n            self.onOptionGroupChange(ui);\r\n        });\r\n    },\r\n\r\n    onOptionGroupChange: function (ui) {\r\n        var self = this;\r\n        var newValue = {id: ui.value, value: ui.text};\r\n        self.selectedValue = newValue.value;\r\n        self.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            if (value !== undefined && value.id != \"\") {\r\n                self.radiogroup.optiongroup(\"setValue\", value.id || value.value);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (self.radiogroup) {\r\n            if ($.data(self.radiogroup[0])['ui-optiongroup']) {\r\n                self.radiogroup.optiongroup(\"setValue\", 0);\r\n            } else {\r\n                $(control).html(\"<label class='readonly-control'></label>\");\r\n            }\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the selected value in the template\r\n     * @returns {*}\r\n     */\r\n    getSelectedValue: function () {\r\n        var self = this;\r\n        return self.selectedValue;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Radio Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the query list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryRadio\", {}, {\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Remove yesno class\r\n        control.removeClass(\"ui-bizagi-render-boolean-yesno\");\r\n    }\r\n});\r\n\r\n","/*\r\n* *   Name: BizAgi Desktop Render Query State Extension\r\n*   Author: Paola Herrera\r\n*   Comments:\r\n*   -   This script will redefine the query list render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryState\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        var horizontal =(typeof data.properties.horizontal !== \"undefined\") ? bizagi.util.parseBoolean(data.properties.horizontal) : true;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal =horizontal;\r\n        if(typeof properties.defaultValue == \"undefined\" && properties.value === null ){\r\n            self.setValue({ id: \"0\" }, false);\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        if(this.value && this.value.id && !isNaN(this.value.id)){\r\n            return {id: parseInt(this.value.id),value:this.value.value};\r\n        }else{\r\n            return this.value;\r\n        }\r\n    },\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        value.id= value.id+\"\";\r\n        this._super(value);\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n* *   Name: BizAgi Desktop Render Query Case State Extension\r\n*   Author: Iván Ricardo Taimal Narváez\r\n*   Comments:\r\n*   -   This script will redefine the query list render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryCaseState\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        var horizontal =(typeof data.properties.horizontal !== \"undefined\") ? bizagi.util.parseBoolean(data.properties.horizontal) : true;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal =horizontal;\r\n        if(typeof properties.defaultValue == \"undefined\" && properties.value === null ){\r\n            self.setValue({ id: \"0\" }, false);\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        if(this.value && this.value.id && !isNaN(this.value.id)){\r\n            return {id: parseInt(this.value.id),value:this.value.value};\r\n        }else{\r\n            return this.value;\r\n        }\r\n    },\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        value.id= value.id+\"\";\r\n        this._super(value);\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Desktop Render queryGrid Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the queryGrid render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.queryGrid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data,  concat children xpath\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        console.log('sucede initializeData queryGrid');\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || (self.parent ? self.parent.properties.orientation : \"ltr\");\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n        if (data.elements) {\r\n            $.each(data.elements, function (i, element) {\r\n                element.render.properties.xpath= self.properties.xpath+\".\"+element.render.properties.xpath;\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                }\r\n                else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                }\r\n                else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    }\r\n});\r\n","/*  \r\n*   Name: Bizagi Desktop Render list Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the list render class to adjust to desktop devices\r\n*/\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.render.base.prototype);\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.list.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Apply plugin\r\n        self.list = $(\".ui-bizagi-render-list\", control);\r\n\r\n        self.list.selectable2({\r\n            closest: false,\r\n            multiple: false,\r\n            select: function(e, ui) {\r\n\r\n                if (e.isPropagationStopped()) return;\r\n\r\n                var selected = $(\"li[tabindex='0']\", this);\r\n                var value = $(selected).data(\"value\");\r\n                var label = $(selected).text();\r\n\r\n                // Updates internal value\r\n                var newValue = { id: value, value: label };\r\n                self.setValue(newValue);\r\n                self.selectedValue = newValue.value;\r\n                self.focusSelectedItem(selected);\r\n\r\n                e.stopPropagation();\r\n            }\r\n        });\r\n\r\n        // Apply list size\r\n        if (properties.listSize > 0) {\r\n            var listSize = Number(properties.listSize) * 23;\r\n            self.list.height(listSize + \"px\");\r\n        }\r\n    },\r\n\r\n    focusSelectedItem: function(elList) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function() {\r\n            elList.focus(0);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers     \r\n     * @returns {} \r\n     */\r\n    configureHandlers: function() {        \r\n        // Call base\r\n        this._super();        \r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * when rendering in design mode\r\n     * @returns {} \r\n     */\r\n    configureDesignView: function() {\r\n        var self = this;        \r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Un-bind selection handlers\r\n        if (self.properties.editable) {\r\n            self.list.unbind(\"mousedown.selectable\");\r\n            self.list.unbind(\"focus.selectable\");\r\n            self.list.unbind(\"blur.selectable\");\r\n            self.list.unbind(\"keydown.selectable\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        value = this.mapValue(value);\r\n\r\n        if (self.properties.editable) {\r\n            if (value !== undefined && value.id !== \"\") {\r\n                self.list.selectable2(\"select\", \"[id='ui-bizagi-list-\" + value.id + \"']\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @returns {} \r\n     */\r\n    clearDisplayValue: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var selected = control.find(\".ui-state-active\");\r\n\r\n        if (selected.length > 0) {\r\n            // Updates internal value\r\n            var newValue = self.getValue();\r\n\r\n            self.selectedValue = newValue.value;\r\n            selected.removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the selected value in the template\r\n     * @returns {} \r\n     */\r\n    getSelectedValue: function() {        \r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     * @returns {} \r\n     */\r\n    cleanData: function() {\r\n        var self = this;\r\n        self.value = self.properties.value = self.selectedValue = { id: \"\", value: \"\" };\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    getLabel: function(){\r\n        return $(\"label\", this._super());\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\"ul li\", $context);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the multiSelect render class to adjust to desktop devices\r\n */\r\n\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.multiSelect\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.multiSelect\", bizagi.rendering.multiSelect.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        this.isNewRenderForm = true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {*}\r\n     */\r\n    renderElement: function () {\r\n        return this._super(\"render-base\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self._super(value);\r\n\r\n        setTimeout(function () {\r\n            self.addSelectedElements();\r\n        }, 100);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        $(\".bz-multiselect\", $control)\r\n            .on(\"click, mousedown.multiselect\", function(evt){\r\n                if($(evt.target).hasClass(\"bz-multiselect__tags\") || $(evt.target).hasClass(\"bz-multiselect__arrow\")){\r\n                    self.onToggleDataView(evt)\r\n                }\r\n            });\r\n        \r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li div.bz-btn-icn\", this.onUnselectElement.bind(this))\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n        var self = this;\r\n        var $control = this.getControl();\r\n        var values = this.getDataValue() || [];\r\n        var totalValues = values.length;\r\n        var $tagsContainer = $('ul.bz-multiselect__tags', $control);\r\n        var editable = this.properties.editable;\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tag\");\r\n\r\n        $tagsContainer.empty();\r\n\r\n        if (totalValues > 0) {\r\n\r\n            if (this.getFormContainer().params.printversion) {\r\n                $control.html(values.map(function (el) {\r\n                    return self.formatItem(el.value);\r\n                }).join(\", \"));\r\n            } else {\r\n\r\n                for (var i = 0; i < totalValues; i++) {\r\n                    var item = values[i];\r\n                    var data = {id: item.id, value: item.value, editable: editable};\r\n                    var $ChildToAdd = $.tmpl(template, data, {\r\n                        formatItem: self.formatItem\r\n                    });\r\n\r\n                    $tagsContainer.append($ChildToAdd);\r\n\r\n                    // Process the control in the layout\r\n                    this.processControlLayout(this.properties.valueFormat || {});\r\n\r\n                    if (!this.canAddMoreItems($tagsContainer)) {\r\n                        // Remove last item added\r\n                        $tagsContainer\r\n                            .children()\r\n                            .last()\r\n                            .remove();\r\n\r\n                        // Add the view mode item\r\n                        var $viewMore = $.tmpl(this.renderFactory.getTemplate(\"list-multiselect-view-more\"), {\r\n                            value: totalValues - i,\r\n                            index: i\r\n                        });\r\n\r\n                        $tagsContainer.append($viewMore);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Get data and render the float list view\r\n     */\r\n    renderFloatView: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect-item\");\r\n\r\n        self.updateArrow();\r\n\r\n        $.when(self.getData()).done(function (data) {\r\n            try {\r\n                var params = {datasource: data};\r\n                var options = {\r\n                    selected: self.getDataValue(),\r\n                    isChecked: function (id) {\r\n                        return self.markAsChecked.call(this, id);\r\n                    },\r\n                    formatItem: self.formatItem\r\n                };\r\n\r\n                var $floatList = self.showFloatListView(template, params, options);\r\n                self.floatListHandlers($floatList);\r\n\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show float list view\r\n     * @param template\r\n     * @param data\r\n     * @param options\r\n     */\r\n    showFloatListView: function (template, data, options) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        var $floatList = $.tmpl(template, data, options);\r\n        var widthControl = self.multiSelect.width();\r\n\r\n        $containerRender.addClass(\"bz-multiselect__visible\");\r\n        $containerControl.addClass(\"bz-multiselect__visible bz-multiselect__floats\");\r\n        $containerControl.append($floatList);\r\n\r\n        $floatList.width(widthControl);\r\n\r\n        $floatList.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: self.multiSelect,\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        // Display view\r\n        $floatList.show();\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $floatList.on(\"mousedown\", function (ev) {\r\n            ev.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        // Add global handler to close the float view\r\n        setTimeout(function(){\r\n            $(document).one(\"mousedown.multiselect\", function (evt) {\r\n                $floatList.trigger('closeView');\r\n            });\r\n        }, 0);\r\n\r\n        return $floatList;\r\n    },\r\n\r\n    /**\r\n     * Destroy the float list view\r\n     * @param $list\r\n     */\r\n    destroyFloatView: function ($list) {\r\n        var $control = this.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        if ($containerControl.hasClass(\"bz-multiselect__visible\"))\r\n            $containerControl.removeClass(\"bz-multiselect__visible\");\r\n\r\n        if ($containerControl.hasClass(\"bz-multiselect__floats\"))\r\n            $containerControl.removeClass(\"bz-multiselect__floats\");\r\n\r\n        if ($containerRender.hasClass(\"bz-multiselect__visible\"))\r\n            $containerRender.removeClass(\"bz-multiselect__visible\");\r\n\r\n        $list.remove();\r\n    },\r\n\r\n    /**\r\n     * Update the float list view\r\n     */\r\n    closeFloatView: function () {\r\n        var $control = this.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        var $listView = $($containerRender).find(\".bz-multiselect__content\");\r\n\r\n        $listView.hide();\r\n\r\n        this.updateArrow();\r\n        this.destroyFloatView($listView)\r\n    },\r\n\r\n    updateArrow: function () {\r\n        var $control = this.getControl();\r\n\r\n        $control.find(\".bz-multiselect__arrow\")\r\n            .toggleClass(\"bz-multiselect__arrow-collapse\");\r\n    },\r\n\r\n    floatViewIsCollapsed: function () {\r\n        var $listView = $(\".bz-multiselect__content\", this.element);\r\n\r\n        return $listView && $listView.length > 0;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    onUnselectElement: function (ev) {\r\n        var $element = $(ev.target);\r\n        var idToRemove = $element.data(\"id\");\r\n\r\n        // Remove element\r\n        this.removeElement({id: idToRemove});\r\n        this.addSelectedElements();\r\n    },\r\n\r\n    onShowSelectedElements: function (ev) {\r\n        var self = this;\r\n        var $element = $(ev.currentTarget);\r\n        var index = $element.data('index');\r\n\r\n        var valuesToShow = (this.getDataValue() || []).slice(index);\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tags\");\r\n        var $listView = this.showFloatListView(template, {\r\n            datasource: valuesToShow,\r\n            editable: self.properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n\r\n        var $tagElements = $('ul.bz-multiselect__tags', $listView);\r\n\r\n        $tagElements.on(\"click, mousedown\", \"li div.bz-btn-icn\", function (ev) {\r\n            self.onUnselectElement(ev);\r\n            $listView.remove();\r\n            ev.stopPropagation();\r\n        });\r\n\r\n        $listView.on(\"closeView\", function () {\r\n            $tagElements.off(\"click\", \"li div.bz-btn-icn\", self.onUnselectElement.bind(self))\r\n            $listView.remove();\r\n        });\r\n\r\n    },\r\n\r\n    onToggleDataView: function (evt) {\r\n        this.floatViewIsCollapsed() ? this.closeFloatView() : this.renderFloatView();\r\n    },\r\n\r\n    floatListHandlers: function ($floatListContext) {\r\n        var self = this;\r\n        var $listContainer = $floatListContext.find(\".bz-multiselect__list li\");\r\n        var checkbox = $listContainer.find(\"input[type=checkbox]\");\r\n\r\n        $floatListContext.find(\".bz-multiselect__search_input\").bind(\"change keypress keyup mousedown\", function (evt) {\r\n            evt.stopPropagation();\r\n\r\n            self.filterList(this.value, $listContainer);\r\n        });\r\n\r\n        checkbox.change(function () {\r\n            var $context = $(this);\r\n            var isChecked = $context.is(\":checked\");\r\n            var id = $context.data(\"id\");\r\n            var element = self.findItemById(id);\r\n            var value = element.value;\r\n\r\n            var newValue = {id: id, value: value};\r\n\r\n            if (isChecked) {\r\n                self.addElement(newValue);\r\n            } else {\r\n                self.removeElement(newValue);\r\n            }\r\n\r\n            self.addSelectedElements();\r\n        });\r\n\r\n        $floatListContext.on(\"closeView\", function () {\r\n            self.closeFloatView();\r\n\r\n            $(document).unbind(\"mousedown.multiselect\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to get the label element\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n    getLabel: function () {\r\n        return $(\"label\", this._super());\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Desktop Render Query List Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the query list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.queryList\", {}, {\r\n\r\n});\r\n\r\n","/**\r\n *   Name: BizAgi Desktop Render Query MultiSelect Extension\r\n *   Author: Alexander Mejia\r\n *   Comments:\r\n *   -   This script will redefine the query multi select render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.queryMultiSelect\", {}, {\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var properties = this.properties;\r\n\r\n        return properties.data || [];\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi User Field render Desktop Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behaviour for userfields\r\n*/\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.userfieldWrapper\", bizagi.rendering.userfieldWrapper.prototype);\r\n\r\nbizagi.rendering.desktop.userfieldWrapper.extend(\"bizagi.rendering.desktop.userfieldWrapper\", {}, {\r\n\r\n    /**\r\n     *  Load userfield\r\n     */\r\n    getUserfieldControl: function () {\r\n        var self = this;\r\n        var sControl = self.userfieldName;\r\n        var mode = self.getMode();       \r\n        var exists = (mode !== \"execution\") || eval(\"bizagi.rendering.desktop.\" + sControl + \" !== undefined\");\r\n        var def = new $.Deferred();\r\n        if (exists) {\r\n            // Creates the userfield instance\r\n            // Set true argument for tabItem\r\n            $.when(self.parent.ready()).done(function () {\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n\r\n        } else {\r\n            // Call ajax service in order to retrieve user field definitions\r\n            $.when(self.dataService.getUserfieldDefinition({ userfield: self.userfieldGuid, device: \"desktop\" })).pipe(function (data) {\r\n                // Load userfield in memory\r\n                self.loadUserfield(data);\r\n\r\n                // Creates the userfield instance\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n        }\r\n\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the userfield instance when the userfield prototype is loaded in memory \r\n     */\r\n    createUserfieldInstance: function (sControl) {\r\n        var self = this;\r\n        var control;\r\n        try {\r\n            // Create a dynamic function to avoid problem with eval calls when minifying the code\r\n            var dynamicFunction = \"var baDynamicFn = function(renderParams){ \\r\\n\";\r\n            dynamicFunction += \"return new bizagi.rendering.desktop.\" + sControl + \"(renderParams);\\r\\n\";\r\n            dynamicFunction += \"}\\r\\n\";\r\n            dynamicFunction += \"baDynamicFn\";\r\n            dynamicFunction = eval(dynamicFunction);\r\n\r\n            // Call the dynamic function\r\n            control = dynamicFunction(self.initialParams);\r\n        } catch (e) {\r\n            // If the call fails, return the default user field\r\n            control = self.getUserFieldInstance(self.initialParams);\r\n        }\r\n        control.properties.isUserField = true;\r\n\r\n        // Save userfield instance\r\n        self.userfieldInstance = control;\r\n\r\n        // Create proxy methods from the wrapper to the userfield instance\r\n        self.replicateUserfieldMethods(control);\r\n\r\n        // Replicate renderchange event from wrapped element to grid if applies\r\n        self.userfieldInstance.bind(\"renderchange\", function () {\r\n            self.triggerHandler(\"renderchange\", arguments);\r\n        });\r\n\r\n        return control;\r\n    },\r\n\r\n    /**\r\n     * Load userfield into memory\r\n     */\r\n    loadUserfield: function (data) {\r\n        var self = this;\r\n        self.properties.styleGuid = self.properties.styleGuid || Math.guid();\r\n\r\n        try {\r\n            // Parse data\r\n            try { data = eval(data); } catch (e) { bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message); }\r\n\r\n            // Iterate elements\r\n            $.each(data, function (index, val) {\r\n                if (val.type == \"js\") {\r\n                    try { \r\n                        function replaceWithDevice(str)\r\n                        {\r\n                            return str.replace(/bizagi.rendering/gi, \"bizagi.rendering.desktop\");\r\n                        }\r\n                        val.content = val.content.replace(/bizagi\\.rendering\\.[^\\s]+\\.extend(\\s|\\n|\\s)*\\((\\s|\\n|\\s)*\\\"bizagi\\.rendering\\.[^\\s]+\\\"/gmi, replaceWithDevice);\r\n                        window.eval(val.content);\r\n                    } catch (ex) { bizagi.log(\"Could not parse result userfield3 \" + self.userfieldName, ex.message); };\r\n                }\r\n                if (val.type == \"css\") {\r\n                    bizagi.util.loadStyle(val.content, self.properties.styleGuid);\r\n                }\r\n            });\r\n\r\n            // Replicate userfield methods to the wrapper\r\n            var control = eval(\"bizagi.rendering.\" + self.userfieldName);\r\n\r\n        } catch (e) { bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message); };\r\n    },\r\n\r\n    getUserFieldInstance: function (params) {\r\n        var mode = this.getMode();\r\n        // If the call fails, return the default user field\r\n        return  (mode === \"execution\") ?\r\n                new bizagi.rendering.desktop.defaultUserField(params) :\r\n                new bizagi.rendering.desktop.designUserField(params);\r\n    }\r\n});\r\n\r\n// Auto-extension\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.basicUserField\", bizagi.rendering.userfieldDefinition.prototype);\r\n\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.basicUserField\", bizagi.rendering.basicUserField.prototype);\r\n\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.basicUserField\", {}, {\r\n\t/*\r\n\t* Shows a jquery dialog\r\n\t*/\r\n    showDialog: function (url, params) {\r\n        var self = this;\r\n        var formDialog = $(\"<div class='iframeContent'><iframe scrolling='yes' id='innerFrameContent' src='\" + url + \"' style='width:100%;height:100%;border:0'  /></div>\");\r\n        var iframe = $(\"#innerFrameContent\", formDialog);\r\n\r\n        // The following procedure adds the \"closeWindow\" function, this will serve as callback from the\r\n        // window, also it's going to serve as brigde to update data back into bizagi fields.\r\n        iframe.load(function () {\r\n            iframe.callInside(function (params) {\r\n                // This script will execute inside the iframe context\r\n                this.BACloseWindow = function (controls, submitForm) {\r\n                    // close dialog\r\n                    params.formDialog.dialog(\"close\");\r\n\r\n                    // Executes the callback to assign values and submit form (if requested)\r\n                    params.formDialog.callback(controls, submitForm);\r\n                };\r\n\r\n            }, {\r\n                    formDialog: formDialog,\r\n                    container: self\r\n                });\r\n            // Callback function which will update the values in bizagi\r\n            formDialog.callback = function (controls, submitForm) {\r\n                $.each(controls, function (index, item) {\r\n                    if (!item.xpath) {\r\n                        bizagi.showMessageBox('Error calling closeWindow, the xpath was not defined.', 'Userfield error');\r\n                    }\r\n                    if (!item.value) {\r\n                        bizagi.showMessageBox('Error calling closeWindow, the value was not defined.', 'Userfield error');\r\n                    }\r\n\r\n                    self.getFormContainer().getRender(item.xpath).setDisplayValue(item.value);\r\n                });\r\n                // If the closeWindow was call with \"submitForm\" then execute the submit on change\r\n                if (submitForm) {\r\n                    self.submitOnChange();\r\n                }\r\n            };\r\n        });\r\n        formDialog.dialog({ height: params.height, width: params.width, title: params.title });\r\n    },\r\n\r\n\t/*\r\n\t*   Shows a browser popup\r\n\t*/\r\n    showPopup: function (url, params) {\r\n        var self = this;\r\n        // Callback function which will update the values in bizagi\r\n        var callbackFn = function (controls, submitForm) {\r\n            $.each(controls, function (index, item) {\r\n                if (!item.xpath) {\r\n                    bizagi.showMessageBox('Error calling closeWindow, the xpath was not defined.', 'Userfield error');\r\n                }\r\n                if (!item.value) {\r\n                    bizagi.showMessageBox('Error calling closeWindow, the value was not defined.', 'Userfield error');\r\n                }\r\n\r\n                self.getFormContainer().getRender(item.xpath).setDisplayValue(item.value);\r\n            });\r\n            // If the closeWindow was call with \"submitForm\" then execute the submit on change\r\n            if (submitForm) {\r\n                self.submitOnChange();\r\n            }\r\n        };\r\n\r\n        bizagi.showPopup(url, params, callbackFn);\r\n    }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n    },\r\n\r\n    /*\r\n\t*  Dont send the data to the server\r\n\t*/\r\n    collectData: function (renderValues) {\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        return \"Userfield: \" + controlName + \" not found\";\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n        return mycontrol;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.document\", bizagi.rendering.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.document.extend(\"bizagi.rendering.desktop.document\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.applyDocumentTemplatesFormat();\r\n\r\n        if (self.properties.allowSendInMail) {\r\n            self.bindEmailDialog();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {string}\r\n     */\r\n    renderReadOnly: function () {\r\n        return \"\";\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.properties.xpathContext || \"\";\r\n        var xpath = self.properties.xpath;\r\n\r\n        $(\".ui-bizagi-render-documentgenerator-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(\"dialog-send-email\"),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Put formating to the documents that are generated by the control\r\n     */\r\n    applyDocumentTemplatesFormat: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        // Resolve the type of the document based on the extension and put the icon to acconding to it\r\n        var documentList = $(\".ui-bizagi-document-upload-item\", control);\r\n\r\n        $.each(documentList, function (index, value) {\r\n            $(\".ui-bizagi-document-type\", value).addClass(\"ui-bizagi-document-extension\");\r\n            //add the tooltip to the document preview icon\r\n            var previewTooltip = $(\".ui-bizagi-document-preview\", value);\r\n            previewTooltip.attr(\"title\", self.resources.getResource('render-document-preview-tooltip'));\r\n            previewTooltip.tooltip();\r\n\r\n            // Disable preview\r\n            var returnType = self.returnCssTypeFile($(\"a > span\", value).html());\r\n            $(\".ui-bizagi-document-type\", value).addClass(returnType);\r\n            $(\".ui-bizagi-button\", value).remove();\r\n            $(\".ui-bizagi-document-preview\", value).attr(\"display\", \"none\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to correct the visualization of the link in the print mode.\r\n     * @param control\r\n     */\r\n    updateControlForPrintMode: function (control) {\r\n\r\n        //clear item that be don´t render\r\n        $('.ui-bizagi-render-button', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-div-error-container', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-document-preview', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-document-type', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('a', control).each(function () {\r\n            $(this).attr('target', '_blank').attr('title', $('span', this).html()).css('text-decoration', 'none');\r\n        });\r\n\r\n        $('ol', control).each(function () {\r\n            $(this).removeClass('ui-bizagi-container-documents');\r\n            $(this).addClass('ui-bizagi-container-documents-print');\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Previews the document inside a dialog\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n\r\n        url = url + \"&h_disposition=inline\";\r\n        var MSIEmatch = navigator.userAgent.match('MSIE (.)');\r\n        navigator.sayswho = (function () {\r\n            var N = navigator.appName, ua = navigator.userAgent, tem;\r\n            var M = ua.match(/(opera|chrome|safari|firefox|msie)\\/?\\s*(\\.?\\d+(\\.\\d+)*)/i);\r\n            if (M && (tem = ua.match(/version\\/([\\.\\d]+)/i)) != null) M[2] = tem[1];\r\n            M = M ? [M[1], M[2]] : [N, navigator.appVersion, '-?'];\r\n\r\n            return M;\r\n        })();\r\n\r\n        var self = this;\r\n        var dialogBox = $(\"<div style='overflow:hidden;'></div>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", window.document);\r\n\r\n        // Create embed object\r\n        if (!$.browser.mozilla && !$.browser.msie) {\r\n            var template = self.renderFactory.getTemplate(\"document-item-preview\");\r\n        } else {\r\n            var template = self.renderFactory.getTemplate(\"document-item-preview-object\");\r\n        }\r\n\r\n        dialogBox.append($.fasttmpl(template, {\r\n            url: url\r\n        }));\r\n\r\n        // Create dialog buttons\r\n        var buttons = {};\r\n        buttons[self.getResource(\"confirmation-box-ok\")] = function () {\r\n            dialogBox.dialog('destroy');\r\n            dialogBox.remove();\r\n        };\r\n\r\n        if (navigator.sayswho[0] != \"Firefox\") {\r\n            buttons[self.getResource(\"render-actions-print\")] = function () {\r\n                // Print the document\r\n                var count = 0;\r\n                var printFn = function (pdf) {\r\n                    //Wait until PDF is ready to print    \r\n                    if (!document.getElementById('ui-bizagi-document-pdf-preview') && count < 5) {\r\n                        count += 1;\r\n                        setTimeout(function () {\r\n                            printFn(pdf);\r\n                        }, 1000);\r\n                    } else {\r\n                        if (!$.browser.mozilla && !$.browser.msie) {\r\n                            document.getElementById('ui-bizagi-document-pdf-preview').focus();\r\n                            document.getElementById('ui-bizagi-document-pdf-preview').contentWindow.print();\r\n                        } else {\r\n                            $(\".ui-bizagi-document-pdf-preview\").focus();\r\n                            $(\".ui-bizagi-document-pdf-preview\")[0].print();\r\n                        }\r\n                    }\r\n                };\r\n                printFn($(\"#ui-bizagi-document-pdf-preview\", dialogBox)[0]);\r\n            };\r\n        }\r\n\r\n        // Create dialog\r\n        dialogBox.dialog({\r\n            width: 800,\r\n            height: 600,\r\n            title: filename,\r\n            maximized: false,\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                dialogBox.dialog('destroy');\r\n                dialogBox.remove();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadalldocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadalldocuments) {\r\n        var self = this;\r\n\r\n        self._super(documents, noFiles, downloadalldocuments);\r\n        // Add icons\r\n        self.applyDocumentTemplatesFormat();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set.\r\n     */\r\n    autoOpenDocuments: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        if (properties.autoOpen) {\r\n            if (properties.downloadalldocuments) {\r\n                //Show only the joined document\r\n                var joinedDocument = $(\".ui-bizagi-document-upload-item[data-joined=true]\", control);\r\n                if (joinedDocument && joinedDocument.length === 1) {\r\n                    self.showDocumentPreview($(\"> a\", joinedDocument).attr(\"href\"), joinedDocument.attr(\"data-filename\"));\r\n                }\r\n            } else {\r\n                // Auto-open documents if flag is set\r\n                $.each($(\".ui-bizagi-document-upload-item\", control), function () {\r\n                    // show only preview for files that are pdf\r\n                    var extension = $(this).attr(\"data-filename\").substr(($(this).attr(\"data-filename\").lastIndexOf('.') + 1));\r\n                    if (extension.toUpperCase() === \"PDF\" && !$(this).attr(\"data-joined\"))\r\n                        self.showDocumentPreview($(\"> a\", this).attr(\"href\"), $(this).attr(\"data-filename\"));\r\n                });\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Render Image\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.image.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.image.extend(\"bizagi.rendering.desktop.image\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(\"images\");\r\n        var containerHeight;\r\n        var imgWidth = self.properties.width;\r\n        var imgHeight = self.properties.height;\r\n\r\n        // Flash to define flash version\r\n        self.properties.flashVersion = false;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            url: self.properties.url,\r\n            allowDelete: properties.allowDelete,\r\n            mode: mode\r\n        });\r\n\r\n        $(\".image-wrapper\", control).empty().append(html);\r\n\r\n        //If is not any image include, load the default properies of the controls\r\n        if (mode === \"design\" || mode === \"layout\" || self.properties.url.length === 0) {\r\n\r\n            setTimeout(function () {\r\n                if (imgHeight === \"auto\") {\r\n\r\n                    // if null means that container is the form\r\n                    if (self.parent.properties.type === \"grid\") {\r\n                        containerHeight = $(control).height() + \"px\";\r\n                        bizagi.util.cssExtended($(\".image-wrapper\", control), 'width:100%!important');\r\n                    } else {\r\n                        var parent = (self.parent.properties.type === \"panel\") ? self.parent.parent : self.parent;\r\n                        var height = control.height();\r\n\r\n                        containerHeight = parent.container.height() - 17;\r\n\r\n                        var containerChildsSize = self.parent.getChildreCount();\r\n                        var containerChildsHeightSum = self.parent.getChildrenSumHeight(\"image\");\r\n\r\n                        if (typeof (self.getFormContainer().properties) !== \"undefined\" &&\r\n                            self.parent.properties.id == self.getFormContainer().properties.id) {\r\n                            containerHeight = 50;\r\n                        } else if (containerChildsSize > 1) {\r\n                            containerHeight = containerHeight - (containerChildsHeightSum - height);\r\n                        }\r\n\r\n                        $(\".image-wrapper\", control).height(containerHeight);\r\n                    }\r\n\r\n                    imgHeight = containerHeight;\r\n\r\n                }\r\n\r\n                $('a', control).css({width: imgWidth, height: imgHeight});\r\n\r\n                $(\".resizable_img\", control).css({width: imgWidth, height: imgHeight});\r\n            }, 150);\r\n\r\n            if ($(\".resizable_img\", control).hasClass('background-image')) {\r\n                //Creates an image node to store the sample image, and resize it to the control required dimensions\r\n\r\n                // Image url pattern\r\n                var pattern = /url\\(|\\)|\"|'/g;\r\n                var baseImageURL = $(\".resizable_img\", control).css('background-image').replace(pattern, \"\");\r\n\r\n                // Creates the image node with the base image URL\r\n                var resizableImgNode = $('<img src=' + baseImageURL + '>');\r\n\r\n                resizableImgNode.css({width: imgWidth, height: imgHeight});\r\n\r\n                // Append the created node\r\n                $(\".resizable_img\", control).append(resizableImgNode);\r\n\r\n                //Reset the styles, and make room to the created image node\r\n                $(\".resizable_img\", control).css({\r\n                    'background-image': 'none',\r\n                    'border-top-width': '0',\r\n                    'border-left-width': '0',\r\n                    'border-right-width': '0',\r\n                    'border-down-width': '0',\r\n                    'padding': '0',\r\n                    'display': 'inline-block'\r\n                });\r\n            }\r\n\r\n            // Otherwise, set the styles to adjust the image in the center, regardless his dimesions\r\n        } else {\r\n            var isImageGreaterThanContainer = false;\r\n            var controlWidth = control.width();\r\n\r\n            setTimeout(function () {\r\n                var isAuto = self.properties.isAutoWidth;\r\n\r\n                if (isAuto && self.parent.properties.type === \"grid\") {\r\n                    if ($(\".img\", control).width() < controlWidth) {\r\n                        imgWidth = $(\".img\", control).width();\r\n                    } else if ($(\".img\", control).width() >= controlWidth) {\r\n                        imgWidth = controlWidth - 20;\r\n                        isImageGreaterThanContainer = true;\r\n                    }\r\n\r\n                    $('a', control).css({height: \"auto\"});\r\n                } else {\r\n                    $('a', control).css({width: imgWidth, height: \"auto\"});\r\n                }\r\n\r\n                $(\".img, .ui-bizagi-render-image-wrapper .image-file\", control)\r\n                    .css({width: imgWidth, height: \"auto\"});\r\n                $(\".ui-bizagi-render-upload-wrapper\", control).addClass(\"uploaded\");\r\n\r\n                var wSize = 48;\r\n                if ((self.properties.width + \"\").indexOf(\"px\") !== -1) {\r\n                    wSize = (self.properties.width + \"\").replace(\"px\", \"\");\r\n                }\r\n\r\n                $(\".ui-bizagi-render-image-wrapper .image-file\", control).addClass('w-size-' + wSize);\r\n                $(\"img\", control).css(\"width\", imgWidth);\r\n                $(\"img\", control).css(\"height\", \"auto\");\r\n\r\n\r\n                if (isAuto && Number($('a', control).css(\"width\").slice(0, -2)) >\r\n                    Number($(\".img\", control).css(\"width\").slice(0, -2))) {\r\n                    $('a', control).css({width: $(\".img\", control).css(\"width\")});\r\n                }\r\n\r\n                if (isAuto && isImageGreaterThanContainer && self.parent.properties.type === \"grid\") {\r\n                    $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"left\");\r\n                }\r\n\r\n            }, 50);\r\n        }\r\n\r\n        self.preventDefaultForAnchorTag();\r\n\r\n        // Resolve a deferred after the postRender\r\n        if (self.isPostRendered) self.isPostRendered.resolve();\r\n\r\n    },\r\n\r\n    /**\r\n     * isReadyToSave\r\n     * @returns {*}\r\n     */\r\n    isReadyToSave: function () {\r\n        return this.ready();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.deleteHandler();\r\n       \r\n        $(\".ui-bizagi-render-image-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"image-dialog\"),\r\n            properties: {\r\n                scriptData: self.buildAddParams(),\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize\r\n            },\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n        // Bind handlers\r\n        //  * Item Mouse over\r\n        control.delegate(\".ui-bizagi-render-upload-item\", \"mouseover\", function () {\r\n            var item = $(this);\r\n            $(\".ui-bizagi-render-upload-icon\", item).css(\"display\", \"inline-block\");\r\n            item.removeClass(\"ui-state-default\").addClass(\"ui-state-hover\");\r\n        });\r\n\r\n        //  * Item Mouse out\r\n        control.delegate(\".ui-bizagi-render-upload-item\", \"mouseout\", function () {\r\n            var item = $(this);\r\n            $(\".ui-bizagi-render-upload-icon\", item).css(\"display\", \"none\");\r\n            item.addClass(\"ui-state-default\").removeClass(\"ui-state-hover\");\r\n        });\r\n\r\n    },\r\n\r\n    deleteHandler: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        $(\".delete-button\", control).bind(\"click\", function (e) {\r\n            e.stopPropagation();\r\n            $.when(self.dataService.deleteImage({\r\n                url: properties.deleteUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            })).done(function () {\r\n                self.refreshControl();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        $(\"*:not(.ui-bizagi-render-control-required)\", control).css({\r\n            padding: \"0px\",\r\n            margin: \"0px\",\r\n            border: \"0px\",\r\n            'line-height': '0px',\r\n            position: 'relative',\r\n            display: 'inline-block',\r\n            top: '0'\r\n        });\r\n\r\n        $(\".image-file\", control).css({width: self.properties.width, height: self.properties.height});\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"images\");\r\n        var mode = self.getMode();\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: false,\r\n            url: self.properties.url,\r\n            allowDelete: false,\r\n            mode: mode\r\n        });\r\n\r\n        $(\".ui-bizagi-render-upload-wrapper\", control).empty().append(html);\r\n\r\n        $(\"a,.img, .ui-bizagi-render-image-wrapper .image-file, .ui-bizagi-render-image-wrapper\", control).css({\r\n            width: self.properties.width,\r\n            height: self.properties.height\r\n        });\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Opens a dialog in order to upload file per file\r\n     */\r\n    openUploadDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var doc = window.document;\r\n\r\n        var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n\r\n        // Select button\r\n        buttons[self.getResource(\"render-upload-dialog-select\")] = function (e) {\r\n            //e.stopPropagation();\r\n            if (self.checkMaxSize() && self.checkFileTypes()) {\r\n                $.when(self.processUploadFile()).done(function (data) {\r\n                    self.onUploadFileCompleted(data);\r\n                    self.closeUploadDialog();\r\n                });\r\n            }\r\n        };\r\n\r\n        // Cancel button\r\n        buttons[self.getResource(\"text-cancel\")] = function () {\r\n            self.closeUploadDialog();\r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: 500,\r\n            height: 200,\r\n            title: self.getResource(\"render-upload-link-label\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                self.closeUploadDialog();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Render template\r\n        var dialogTemplate = self.renderFactory.getTemplate(\"image-dialog\");\r\n        $.tmpl(dialogTemplate, {\r\n            scriptData: self.buildAddParams(),\r\n            url: properties.addUrl,\r\n            xpath: properties.xpath,\r\n            validExtensions: properties.validExtensions.replace(\";\", \",\"),\r\n            maxSize: properties.maxSize\r\n        }).appendTo(dialogBox);\r\n        $('.ui-bizagi-loading-message').remove();\r\n\r\n    },\r\n\r\n    /**\r\n     * Close the upload dialog\r\n     */\r\n    closeUploadDialog: function () {\r\n        var self = this;\r\n        self.dialogBox.dialog('destroy');\r\n        self.dialogBox.remove();\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded\r\n     * @param renderReference\r\n     * @param response\r\n     */\r\n    onUploadFileCompleted: function (renderReference, response) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n        var imageWrapper = $(\".ui-bizagi-render-image-wrapper\", control);\r\n        var result = JSON.parse(response);\r\n        var imgWidth = 0;\r\n        var controlWidth = control.width();\r\n        var isImageLoaded = control.find(\".img\").size() > 0;\r\n        var widthBase = control.find(\".resizable_img\").width();\r\n\r\n        if (self.properties.isAutoWidth) {\r\n            imgWidth = self.properties.type != \"image\" ? control.width() : \"99%\";\r\n        } else {\r\n            imgWidth = self.properties.width;\r\n        }\r\n\r\n        // Set width\r\n        $(\".uploadifyQueueItem\", control).css({width: self.properties.width});\r\n\r\n        if (result.type !== \"error\") {\r\n            $.when(self.renderUploadItem()).done(function (htmlImage) {\r\n                // Empty container and add new image\r\n                $(imageWrapper).empty();\r\n                $(imageWrapper).append(htmlImage);\r\n                self.deleteHandler();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n\r\n                setTimeout(function () {\r\n                    var isImageGreaterThanContainer = false;\r\n                    var isAuto = self.properties.isAutoWidth;\r\n\r\n                    if (isAuto && self.parent.properties.type === \"grid\") {\r\n\r\n                        if ($(\".img\", control).width() < controlWidth) {\r\n                            imgWidth = $(\".img\", control).width();\r\n                        } else if ($(\".img\", control).width() >= controlWidth) {\r\n                            imgWidth = controlWidth - 20;\r\n                            isImageGreaterThanContainer = true;\r\n                        }\r\n\r\n                        if (!isImageLoaded) {\r\n                            $('a', control).closest(\"td\").css(\"width\", widthBase);\r\n                        }\r\n\r\n                        $('a', control).css({height: \"auto\"});\r\n\r\n                    } else {\r\n                        $('a', control).css({width: imgWidth, height: \"auto\"});\r\n                    }\r\n\r\n                    $(\".img, .ui-bizagi-render-image-wrapper .image-file\", control)\r\n                        .css({width: imgWidth, height: \"auto\"});\r\n\r\n                    $(\".ui-bizagi-render-upload-wrapper\", control).addClass(\"uploaded\");\r\n\r\n                    var wSize = 48;\r\n                    if ((self.properties.width + \"\").indexOf(\"px\") !== -1) {\r\n                        wSize = (self.properties.width + \"\").replace(\"px\", \"\");\r\n                    }\r\n\r\n                    $(\".ui-bizagi-render-image-wrapper .image-file\", control).addClass('w-size-' + wSize);\r\n\r\n                    $(\"img\", control).css(\"width\", imgWidth);\r\n                    $(\"img\", control).css(\"height\", \"auto\");\r\n                    $('.image-wrapper', control).css(\"height\", \"auto\");\r\n\r\n\r\n                    if (isAuto && Number($('a', control).css(\"width\").slice(0, -2)) >\r\n                        Number($(\".img\", control).css(\"width\").slice(0, -2))) {\r\n                        $('a', control).css({width: $(\".img\", control).css(\"width\")});\r\n                    }\r\n\r\n                    if (self.parent.properties.type === \"grid\" && isAuto) {\r\n                        if (isImageGreaterThanContainer) {\r\n                            $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"left\");\r\n                        } else {\r\n                            if (self.properties.columnAlign) {\r\n                                $('a', control).closest(\".ui-bizagi-render\")\r\n                                    .css(\"text-align\", self.properties.columnAlign);\r\n                                $('.image-wrapper', control).css(\"text-align\", self.properties.columnAlign);\r\n                            } else {\r\n                                $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"center\");\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }, 50);\r\n\r\n                //Set Value\r\n                self.setValue([true]);\r\n\r\n            });\r\n        } else {\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @returns {Array}\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        var data = [];\r\n        var action = \"savefile\";\r\n\r\n        if (properties.isUserPreference) {\r\n            action = \"SAVEUSERIMAGE\";\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: \"entity\"});\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\", value: self.currentUser});\r\n        }\r\n\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", value: self.getUploadXpath()});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", value: properties.id});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", value: properties.xpathContext});\r\n        data.push({\r\n            key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE,\r\n            value: properties.idPageCache\r\n        });\r\n        data.push({key: self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", value: form.properties.sessionId});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", value: action});\r\n\r\n        if (properties.contexttype) {\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: properties.contexttype});\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data.push({key: BIZAGI_SESSION_NAME, value: form.properties.sessionId});\r\n            } else {\r\n                data.push({key: \"JSESSIONID\", value: form.properties.sessionId});\r\n            }\r\n        } catch (e) {\r\n            data.push({key: \"JSESSIONID\", value: form.properties.sessionId});\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    checkMaxSize: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var fileControl = $(\"input[type=file]\", dialogBox).get(0) || {};\r\n\r\n        // Dont exist any fucking way to know file size in IEx, just skip this validation\r\n        if (fileControl.files != undefined) {\r\n            if (fileControl.files.length > 0) {\r\n                if (fileControl.files[0].size > properties.maxSize) {\r\n                    self.showError(self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", properties.maxSize));\r\n                    return false;\r\n                }\r\n                return true;\r\n            } else {\r\n                self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                return false;\r\n            }\r\n        } else {\r\n            if (bizagi.util.isIE()) {\r\n                if (fileControl.value === \"\" || !fileControl.value) {\r\n                    self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n    checkFileTypes: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var file = $(\"input[type=file]\", dialogBox).val();\r\n\r\n        if (properties.validExtensions && properties.validExtensions.length > 0) {\r\n            var validExtensions = properties.validExtensions.replaceAll(\"*.\", \"\").split(\";\");\r\n            if (!self.stringEndsWithValidExtension(file, validExtensions, true)) {\r\n                self.showError(self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    stringEndsWithValidExtension: function (stringToCheck, acceptableExtensionsArray, required) {\r\n        if (required == false && stringToCheck.length == 0) return true;\r\n\r\n        for (var i = 0; i < acceptableExtensionsArray.length; i++) {\r\n            if (acceptableExtensionsArray[i].toLowerCase() == \"*\") return true\r\n            if (stringToCheck.toLowerCase().endsWith(acceptableExtensionsArray[i].toLowerCase())) return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    showError: function (message) {\r\n        var self = this;\r\n        var errorContainer = $(\"#alert-file-upload\", self.dialogBox);\r\n\r\n        // Empty container\r\n        errorContainer.empty();\r\n        errorContainer.show();\r\n\r\n        errorContainer.html(message);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @returns {*}\r\n     */\r\n    processUploadFile: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var dialogBox = self.dialogBox;\r\n        var uploadForm = $(\"form\", dialogBox);\r\n        var uploadIFrame = $(\"iframe\", uploadForm);\r\n\r\n        // When the iframe loads the user we need to evaluate the response and close the dialog\r\n        var timeoutFn = function () {\r\n            try {\r\n                var response = \"\";\r\n                if (uploadIFrame[0].contentWindow) {\r\n                    var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                        : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                    response = iframeContent.text();\r\n                }\r\n                if (response.length > 0) {\r\n                    defer.resolve(response);\r\n                } else {\r\n                    setTimeout(timeoutFn, 50);\r\n                }\r\n            } catch (error) {\r\n                // Nothing to do, just close the window and show error message\r\n                self.closeUploadDialog();\r\n                bizagi.showMessageBox(error.toString());\r\n            }\r\n        };\r\n\r\n        // Execute the timed function in order to check when the response has arrived\r\n        timeoutFn();\r\n\r\n        // Submit the form\r\n        uploadForm.submit();\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.combo\", bizagi.rendering.columns.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n\r\n        var self = this,\r\n            mode = self.getMode();\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n\r\n        // Remove padding for td\r\n        if (this.properties.editable && tableCell) {\r\n            tableCell.addClass(\"ui-bizagi-cell-combo\");\r\n        }\r\n\r\n        if (mode === \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey),\r\n                control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n\r\n        // Add padding for td\r\n        if (tableCell)\r\n            tableCell.removeClass(\"ui-bizagi-cell-combo\");\r\n    },\r\n\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function() {\r\n            var self = this;\r\n\r\n            self.value = self.properties.value = self.selectedValue = { id: 0, value: self.getResource(\"render-combo-empty-value\") };\r\n            self.setValue(self.value);\r\n            var control = self.getControl();\r\n            var input = control.find(\"input\");\r\n            if (input) {\r\n                input.val(self.getValue().value);\r\n            }\r\n        };\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.document\", bizagi.rendering.columns.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.document.extend(\"bizagi.rendering.desktop.columns.document\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        decorated.getControlHtml = self.getControlHtml;\r\n\r\n        if (mode !== \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.preRenderControl = this.preRenderControl;\r\n            decorated.deleteDocumentTemplate = this.deleteDocumentTemplate;\r\n            decorated.getTemplateItem = this.getTemplateItem;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-column-item\";\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.startLoading();\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n        properties.buttonExecuted = true;\r\n\r\n        var grid = self.parent;\r\n        var form = self.getFormContainer();\r\n\r\n        $.when(form.submitData())\r\n            .done(function () {\r\n                $.when(self.dataService.generateDocumentTemplate(properties))\r\n                    .done(function (response) {\r\n                        $.when(grid.refresh())\r\n                            .done(function () {\r\n                                self.autoOpenDocuments();\r\n                            });\r\n\r\n                        self.endLoading();\r\n                    }).fail(function () {\r\n                    self.showErrorMessage();\r\n                    self.endLoading();\r\n                });\r\n            }).fail(function (message) {\r\n            // Add error messages\r\n            self.getFormContainer().addErrorMessage(message);\r\n            self.endLoading();\r\n        });\r\n\r\n        properties.buttonExecuted = false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadalldocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*}\r\n     */\r\n    getControlHtml: function (template, mode, downloadalldocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n        var isInlineRow = true;\r\n\r\n        for (var i = 0; i < self.parent.properties.data.rows.length; i++) {\r\n            if (self.parent.properties.data.rows[i][0] == self.surrogateKey) {\r\n                isInlineRow = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var html = $.fasttmpl(template, {\r\n            noActivateButton: isInlineRow,\r\n            editable: mode !== \"execution\",\r\n            downloadalldocuments: downloadalldocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append ? properties.append : false,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail,\r\n            mode: mode\r\n        });\r\n\r\n        return html.replace(\"ui-bizagi-document-upload-item-design\", \"ui-bizagi-document-upload-item-design-column\");\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param xpath\r\n     * @returns {string}\r\n     */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*|string}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param surrogateKey\r\n     * @param cell\r\n     * @param tableCell\r\n     */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {string}\r\n     */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var xpathContext = (form.properties.xpathContext) ? form.properties.xpathContext + \".\" : \"\";\r\n        return xpathContext + this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n        if (this.value != undefined && this.properties.value != undefined) {\r\n            this.properties.value = this.value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var grid = self.parent;\r\n        var params = {};\r\n\r\n        params.xpath = self.properties.xpath + \"[fileName='\" + filename + \"']\";\r\n        params.idRender = self.properties.id;\r\n        params.xpathContext = self.getContextXpath();\r\n        params.idPageCache = self.properties.idPageCache;\r\n\r\n        $.when(self.dataService.deleteUploadFile(params)).done(function () {\r\n            grid.refresh();\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Letter Column Decorator Extension\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will redefine the letter column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.letter\", bizagi.rendering.columns.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.letter.extend(\"bizagi.rendering.desktop.columns.letter\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        //Call base\r\n        self._super(decorated);\r\n\r\n        // Hacks some methods to add features\r\n        decorated.getContextXpath = self.getContextXpath;\r\n        decorated.getXpath = self.getXpath;\r\n        decorated.getControl = self.getControl;\r\n        decorated.setDisplayValue = self.setDisplayValue;\r\n\r\n        decorated.postRenderReadOnly = function (element) {\r\n            var html = decorated.renderReadOnly.apply(decorated);\r\n            var control = $(\".ui-bizagi-cell\", element);\r\n            control.append(html);\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Returns the current context xpath  \r\n    */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode === \"execution\") {\r\n\r\n            return (properties.xpathContext && properties.xpathContext.length > 0) ?\r\n                properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\" :\r\n                self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n        }\r\n\r\n        return \"\";\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the current xpath  \r\n    */\r\n    getXpath: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var xpathPath = properties.xpath;\r\n        var index = xpathPath.indexOf(self.grid.properties.xpath);\r\n        if (index != -1) { xpathPath = xpathPath.substr(index + self.grid.properties.xpath.length + 1); }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /* \r\n    * Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to generate a letter\r\n                control.html(bizagi.localization.getResource('render-grid-column-letter-mandatory-key'));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This will execute under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) { return $(\".ui-bizagi-render-control\", self.element); }\r\n\r\n        return $(\".ui-bizagi-cell\", self.element);\r\n    },\r\n\r\n    /*\r\n    * Override function\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n\r\n\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.search\", bizagi.rendering.columns.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.search.extend(\"bizagi.rendering.desktop.columns.search\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        decorated.refreshControl = this.refreshControl;\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", decorated.getControl());\r\n        this.applyColumnStyles(input);\r\n\r\n        // Remove padding for td\r\n        if (this.properties.editable) {\r\n            decorated.getControl().addClass(\"ui-bizagi-cell-search\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n    refreshControl: function () {\r\n        this.grid.refreshCell({key: this.surrogateKey, column: this.properties.xpath, xpathContext: this.getFormContainer().properties.xpathContext});\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Date Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.date\", bizagi.rendering.columns.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.date.extend(\"bizagi.rendering.desktop.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated) {\r\n            decorated.showTime = false;\r\n\r\n            if (mode === \"execution\") {\r\n                decorated.changeMinValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {                        \r\n\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.datepicker(\"option\", \"minDate\", calculateValue); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.minValue = value; // Invarian date   \r\n                        decorated.properties.minValue = calculateValue;\r\n                    }\r\n                };\r\n\r\n                decorated.changeMaxValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.datepicker(\"option\", \"maxDate\", calculateValue); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.maxValue = value; // Invarian date       \r\n                        decorated.properties.maxValue = calculateValue;\r\n                    }\r\n                };\r\n            }\r\n        }\r\n        if (mode != \"design\") {\r\n            decorated.getDateControl = function() {\r\n                var self = this;\r\n                return self.dateControl = $(\".ui-bizagi-render-date\", self.getControl());\r\n            };\r\n        }\r\n\r\n    },\r\n\r\n    resolveValue: function (context, value) {\r\n        var result = \"\";\r\n        if (bizagi.util.isString(value) || bizagi.util.isNumeric(value)) {\r\n            result = value;\r\n        }\r\n\r\n        if (bizagi.util.isArray(value)) {\r\n            var indexes = context.grid.getIndexes();\r\n            var surrogateKey = context.surrogateKey;\r\n            var index = indexes.indexOf(surrogateKey);\r\n            if (index !== -1) {\r\n                result = value[index];\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        // Call base\r\n        decorated.properties.showTime = false;\r\n        decorated.properties.showTime = properties.showTime;\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        // Call base, but resuming the original show time property when rendering not editable\r\n        decorated.properties.showTime = properties.showTime;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.text\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input, textarea\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.autoExtend) {\r\n            var readOnly = cell.find(\".ui-bizagi-cell-readonly\");\r\n            if (readOnly.length > 0) {\r\n                readOnly.css(\"max-height\", \"none\");\r\n            }\r\n        }\r\n\r\n        self._super(surrogateKey, cell);\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            \r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\")) {\r\n                    $(this).data().newValue = undefined;\r\n                }\r\n            }\r\n            self.retypeDouble(control);\r\n           \r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Seacrh List Column Decorator Extension\r\n*   Author: Paola Herrera\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.searchList\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n    },\r\n    /*\r\n     *   Returns the in-memory processed element\r\n     *   so the caller could append it to any place\r\n     */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Sets the internal value, only must be called internally\r\n     */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n            if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            if (value === null || value === undefined) value = [];\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Number Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.number\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop NumberScientificNotation Column Decorator Extension\r\n *   Author: Laura Ariza\r\n *   Comments:\r\n *   -   This script define a render control that support scientific notation format in a column\r\n */\r\n\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.numberScientificNotation\", {}, {\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Upload Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the upload column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.upload\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param {} decorated \r\n     * @returns {} \r\n     */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = self.getUploadXpath;\r\n\r\n        // Hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n\r\n            var originalMethod = decorated.applyUploadPlugin;\r\n\r\n            decorated.getXpathContext = function() {\r\n                var surrogateKey = this.surrogateKey || \"\";\r\n                var that = this;\r\n                var xpath = that.grid.properties.xpath + \"[id=\" + that.surrogateKey + \"]\";\r\n\r\n                return that.properties.xpathContext.length > 0 ? that.properties.xpathContext + \".\" + xpath : xpath;\r\n            };\r\n\r\n            decorated.applyUploadPlugin = function() {\r\n                var control = this.getControl();\r\n\r\n                originalMethod.apply(decorated, arguments);\r\n\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n\r\n                $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n                // fix to firefox and chrome\r\n                $(\".ui-bizagi-render-upload-wrapper object\", control).css({ position: 'relative' });\r\n\r\n                $(\".ui-bizagi-render-upload-queue\", control).css({ 'max-width': \"150px\" });\r\n\r\n            };\r\n\r\n            decorated.postRender = function() {\r\n                var self = this;\r\n                var control = self.getControl();\r\n\r\n                if (self.properties.allowSendInMail) {\r\n                    self.bindEmailDialog();\r\n                }\r\n\r\n                //Set control container to behave as a block \r\n                control.addClass(\"ui-bizagi-render-display-block\");\r\n                control.addClass(\"ui-bizagi-render-upload\");\r\n                self.checkMaxFiles();\r\n            };\r\n\r\n            decorated.buildItemUrl = function(file) {\r\n                var self = this;\r\n                var properties = self.properties;\r\n                var form = self.getFormContainer();\r\n\r\n                return self.dataService.getUploadFileUrl({\r\n                    idRender: properties.id,\r\n                    xpath: self.getUploadXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: properties.contexttype\r\n                });\r\n            };\r\n        }\r\n\r\n        decorated.buildItemUrl = function(file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var xpathContext = self.getXpathContext();\r\n            var contextXpath = \"\";\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.id,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.processUploadFile = function() {\r\n            var self = this;\r\n            var dialogBox = self.dialogBox;\r\n            var defer = new $.Deferred();\r\n            var uploadForm = $(\"form\", dialogBox);\r\n            var uploadIFrame = $(\"iframe\", uploadForm);\r\n            var xpathContext = self.getXpathContext();\r\n\r\n            // Change xpath context within form element\r\n            $(\"[name=h_xpathContext]\", uploadForm).val(xpathContext);\r\n\r\n\r\n            // When the iframe loads the user we need to evaluate the response and close the dialog\r\n            var timeoutFn = function() {\r\n                try {\r\n                    var response = \"\";\r\n                    if (uploadIFrame[0].contentWindow) {\r\n                        var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                            : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                        response = iframeContent.text();\r\n                    }\r\n                    if (response.length > 0) {\r\n                        defer.resolve(response);\r\n                    } else {\r\n                        setTimeout(timeoutFn, 50);\r\n                    }\r\n                } catch (e) {\r\n                    // Nothing todo, just close the window and show error message\r\n                    self.closeUploadDialog();\r\n                    window.alert(e.toString());\r\n                }\r\n            };\r\n\r\n            // Execute the timed function in order to check when the response has arrived\r\n            timeoutFn();\r\n\r\n            // Submit the form\r\n            uploadForm.submit();\r\n\r\n            return defer.promise();\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Returns the in-memory processed element when the element is read-only\r\n     * @param {} surrogateKey \r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function(surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n            decorated.properties.editable = editable;\r\n        }\r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function() {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey \r\n     * @param {} cell \r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function(surrogateKey, cell) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(surrogateKey, cell);\r\n\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (decorated.files.length == 0) {\r\n            var message = self.getResource(\"render-upload-no-files\");\r\n            $(\".ui-bizagi-cell-readonly\", cell).html(message);\r\n\r\n            // Set cell icon to the right\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n        } else {\r\n            // Just draw render if the cell layout has been filled\r\n            if (cell && cell.length > 0) {\r\n                // Apply styles to cell\r\n                self.applyColumnStyles(cell);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey \r\n     * @param {} cell \r\n     * @returns {} \r\n     */\r\n    postRender: function(surrogateKey, cell) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super(surrogateKey, cell);\r\n\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        if (mode != \"design\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used  \r\n     * @returns {} \r\n     */\r\n    getUploadXpath: function() {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Radio Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the Radio column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.radio\", {}, {\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function () {\r\n            var self = this;\r\n            var value = { id: \"\", label: \"\" };\r\n            var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n            selectedItem.removeClass(\"ui-radio-state-checked\");\r\n            self.setDisplayValue(value);\r\n            self.setValue(value);\r\n        };\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Radio Column Decorator Extension\r\n*   Author: Maria Camila Angel\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.list\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n            var selected = control.find(\".ui-state-active\");\r\n            var newValue = self.getValue();\r\n\r\n            self.value = self.properties.value = self.selectedValue = { id: \"\", value: \"\" };\r\n            self.selectedValue = newValue.value;\r\n            selected.removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        };\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Text Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the image column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.image\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        this._super(decorated);\r\n\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        var originalApplyUploadPlugin = decorated.applyUploadPlugin;\r\n        if (decorated.properties.flashVersion) {\r\n            decorated.applyUploadPlugin = function () {\r\n                var uploadRender = this,\r\n                        control = uploadRender.getControl();\r\n                originalApplyUploadPlugin.apply(decorated, arguments);\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n                $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n                // fix to firefox and chrome\r\n                $(\".ui-bizagi-render-upload-wrapper object\", control).css({\r\n                    position: 'relative'\r\n                });\r\n            };\r\n        }\r\n\r\n\r\n        // Hack renderControl and post render to avoid processing when using inline add\r\n        var originalRenderControl = decorated.renderControl;\r\n        var originalInternalPostRender = decorated.internalPostRender;\r\n        //var originalPostRender = decorated.postRender;\r\n        decorated.renderControl = function () {\r\n            return \"\";\r\n        };\r\n\r\n        decorated.internalPostRender = function () {\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n\r\n                self.isNewRow = false;\r\n\r\n                $.when(originalRenderControl.apply(decorated, arguments)).done(function (html) {\r\n                    if (control.hasClass(\"ui-bizagi-render-control\") ||\r\n                        control.hasClass(\"ui-bizagi-cell-readonly\")) {\r\n                        control.append(html);\r\n                        originalInternalPostRender.apply(decorated, arguments);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        \r\n        decorated.buildAddParams = function () {\r\n            var self = this,\r\n                properties = self.properties,\r\n                form = self.getFormContainer();\r\n\r\n            var data = [];\r\n\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", value: properties.xpath });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", value: properties.id });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", value: properties.xpathContext });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE, value: properties.idPageCache });\r\n            data.push({ key: self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", value: form.properties.sessionId });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", value: 'savefile' });\r\n            (properties.contexttype) ? data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: properties.contexttype }) : \"\";\r\n\r\n            try {\r\n                (BIZAGI_SESSION_NAME != undefined) ? data.push({ key: BIZAGI_SESSION_NAME, value: form.properties.sessionId }) : data.push({ key: \"JSESSIONID\", value: form.properties.sessionId });\r\n            } catch (e) {\r\n                data.push({ key: \"JSESSIONID\", value: form.properties.sessionId });\r\n            }\r\n\r\n            return data;\r\n        };\r\n\r\n        decorated.refreshControl = this.refreshControl;\r\n\r\n        // Change xpath context\r\n        if (mode === \"execution\") {\r\n            if (properties.xpathContext.length > 0) {\r\n                decorated.properties.xpathContext = properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n            } else {\r\n                decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }, \r\n\r\n    refreshControl: function(){\r\n        this.grid.refreshCell({key: this.surrogateKey, column: this.properties.xpath, xpathContext: this.getFormContainer().properties.xpathContext});\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Text Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.uploadecm\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        var originalMethod = decorated.applyUploadPlugin;\r\n        decorated.applyUploadPlugin = function () {\r\n            var uploadRender = this;\r\n            var control = uploadRender.getControl();\r\n\r\n            originalMethod.apply(decorated, arguments);\r\n            control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n            control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n            $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n            // fix to firefox and chrome\r\n            $(\".ui-bizagi-render-upload-wrapper object\", control).css({\r\n                position: 'relative'\r\n            });\r\n        };\r\n\r\n        decorated.buildItemUrl = function (file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n\r\n            columnXpath = columnXpath.split(\".\");\r\n\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.buildAddParams = function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var data = {};\r\n\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            data.url = properties.addUrl;\r\n            data.xpath = properties.xpath;\r\n            data.idAttrib = properties.idAttrib;\r\n            data.xpathContext = xpathContext;\r\n            data.metaValues = [];\r\n            data.idPageCache = properties.idPageCache;\r\n            data.idSession = form.properties.sessionId;\r\n            data.contexttype = \"entity\";\r\n            data.validExtensions = properties.validExtensions;\r\n            data.maxSize = properties.maxSize;\r\n\r\n            return data;\r\n        };\r\n\r\n\r\n        decorated.getXpathContext = function () {\r\n            var self = this;            \r\n            var xpath = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            return self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n        };\r\n\r\n\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        decorated.setValue(value);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n        }\r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        if (decorated.files.length == 0) {\r\n            var message = self.getResource(\"render-upload-no-files\");\r\n            $(\".ui-bizagi-cell-readonly\", cell).html(message);\r\n\r\n            // Set cell icon to the right\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n        } else {\r\n            // Just draw render if the cell layout has been filled\r\n            if (cell && cell.length > 0) {\r\n                // Apply styles to cell\r\n                self.applyColumnStyles(cell);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {                \r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                // Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                // also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function(surrogateKey) {\r\n        var self = this;        \r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        var xpath = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + self.properties.xpath;\r\n\r\n        return self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n    }\r\n\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Link Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the link column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.link\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n        decorated.getControl = this.getControl;\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated.properties.type == \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n        // Hack renderControl and post render to avoid processing when using inline add\r\n        var originalRenderControl = decorated.renderControl;\r\n        originalInternalPostRender = decorated.internalPostRender;\r\n        decorated.internalPostRender = function () {\r\n            var control = decorated.getControl();\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html('<label style=\"font-weight: normal;\">'+bizagi.localization.getResource('render-grid-column-button-mandatory-key')+'</label>');\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n                $.when(originalRenderControl.apply(decorated, arguments)).done(function (html) {\r\n                    if (control.hasClass(\"ui-bizagi-render-control\") ||\r\n                        control.hasClass(\"ui-bizagi-cell-readonly\")) {\r\n                        originalInternalPostRender.apply(decorated, arguments);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This will execute under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            return $(\".ui-bizagi-render-control\", self.element);\r\n        } else {\r\n            if($(\".ui-bizagi-cell-readonly\", self.element).length > 0){\r\n                return $(\".ui-bizagi-cell-readonly\", self.element);\r\n            }\r\n            else{\r\n                return $(\".ui-bizagi-render-control\", self.element);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell, caller) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Change the xpath context\r\n        decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n\r\n        if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) == -1)\r\n            decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell, caller);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    renderReadOnly: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n\r\n        // Render the control editable\r\n        if (typeof (self.properties.canBeSaved) == \"undefined\") self.properties.canBeSaved = (self.properties.editable == true);\r\n        var result = this.render(surrogateKey, value, tableCell, \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\");\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        var self = this;\r\n\r\n        // Render the control editable\r\n        this.postRender(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /*\r\n    *   Get Form Link xpath to use\r\n    */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath){\r\n            return;\r\n        }\r\n        return this.properties.xpath;\r\n    }\r\n\r\n\r\n});\r\n","/**\r\n * Grid control Column Button\r\n *\r\n * @author Edward Morales\r\n */\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.button\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        this._super(decorated);\r\n\r\n        decorated.configureHandlers = function () {\r\n            var self = this;\r\n            var control = decorated.getControl();\r\n            var button = $(\":button\", control);\r\n\r\n            button.bind(\"click\", function (e) {\r\n                decorated.processButton.apply(self);\r\n\r\n            });\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to click the button\r\n                control.html(bizagi.localization.getResource('render-grid-column-button-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n        \r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        \r\n        // Changes editable to false to render read-only\r\n        var editable = this.properties.editable;\r\n        decorated.properties.editable = false;\r\n        cell = decorated.render(\"cell.button\");\r\n        decorated.properties.editable = editable;\r\n        \r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Actions Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.actions\", {}, {\r\n\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this._super(surrogateKey, cell);\r\n\r\n        self.configureHandlersActions(surrogateKey);\r\n\r\n        $(\".ui-bizagi-render\", cell).css(\"overflow\", \"auto\");\r\n\r\n\r\n        if (mode == \"execution\") {\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                control.html(self.renderDraftControl());\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Configure additional Handlers\r\n     * @param surrogateKey\r\n     */\r\n    configureHandlersActions: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var viewMore = decorated.element.find(\".gn-bz-grid__more\");\r\n        var items = [];\r\n\r\n        // Add selection events for the draft rows\r\n        decorated.element.on(\"click\", \".gn-bz-grid__delete\", function (events) {\r\n            var $context = $(this).closest(\"tr[data-new-row='true']\");\r\n\r\n            $context.trigger(\"delete-row\");\r\n        });\r\n\r\n        if (self.grid.columnActionParams.allowDetail) {\r\n            items.push({\r\n                name: self.parent.properties.detailLabel,\r\n                icon: \"icon-detail\",\r\n                fn: function () {\r\n                    self.grid.showFormDetails(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (self.grid.columnActionParams.allowEdit && self.grid.columnActionParams.withEditForm) {\r\n            items.push({\r\n                name: self.parent.properties.editLabel,\r\n                icon: \"icon-edit\",\r\n                fn: function () {\r\n                    self.grid.editRow(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (self.grid.columnActionParams.allowDelete) {\r\n            items.push({\r\n                name: self.parent.properties.deleteLabel,\r\n                icon: \"icon-delete\",\r\n                fn: function () {\r\n                    self.grid.deleteRow(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        viewMore.overflowMenu({items: items});\r\n    },\r\n\r\n    renderDraftControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"gridActions-delete\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Actions Column Decorator Extension\r\n *   Author: Cristian Olaya\r\n *           Iván Ricardo Taimal\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.exclusiveCheck\", {}, {\r\n\r\n    /*\r\n     *   Returns the in-memory processed element\r\n     *   so the caller could append it to any place\r\n     */\r\n    render: function (surrogateKey, value) {\r\n\r\n        var self = this;\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n\r\n        var mode = self.getMode();\r\n\r\n        if (self.grid.exclusiveChanges[self.properties.xpath]) {\r\n            if (self.grid.exclusiveChanges[self.properties.xpath].key === surrogateKey) {\r\n                self.setValue(surrogateKey, self.grid.exclusiveChanges[self.properties.xpath].value);\r\n            }\r\n            else {\r\n                self.setValue(surrogateKey, false);\r\n            }\r\n        }\r\n        else {\r\n            if (self.grid.originalEnabledChecks && self.grid.originalEnabledChecks.length > 1) {\r\n                self.setValue(surrogateKey, false);\r\n            }\r\n            else {\r\n                self.setValue(surrogateKey, value);\r\n            }\r\n        }\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        if (!properties.editable)\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n            var lastKey = self.grid.exclusiveChanges[self.properties.xpath] ? self.grid.exclusiveChanges[self.properties.xpath].key : -1;\r\n            if (lastKey !== surrogateKey) {\r\n                self.clearOtherRows(surrogateKey, self.properties.xpath);\r\n            }\r\n            var simpleXpathArray = self.properties.xpath.split(\".\");\r\n            self.grid.exclusiveChanges[self.properties.xpath] = {\r\n                xpath: self.properties.xpath,\r\n                simpleXpath: simpleXpathArray[simpleXpathArray.length - 1],\r\n                value: self.getValue(surrogateKey),\r\n                key: surrogateKey\r\n            };\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show a disabled check box\r\n                control.html('<input type=\"checkbox\" name=\"exclusiveCheck\" title=\"' + bizagi.localization.getResource('render-grid-column-button-mandatory-key') + '\" disabled=\"disabled\" style=\"width:16.5px;height:16.5px;\">');\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    clearOtherRows: function (surrogateKey, xpath) {\r\n        var self = this;\r\n        var enabledChecks = self.grid.enabledChecks;\r\n\r\n        if (!enabledChecks) {\r\n            self.grid.enabledChecks = {};\r\n            self.grid.enabledChecks[xpath] = [];\r\n            enabledChecks = self.grid.enabledChecks;\r\n        }\r\n\r\n        for (var j = 0; j < self.grid.properties.data.rows.length; j++) {\r\n            var rowIndex = self.grid.properties.data.rows[j][0];\r\n            if (rowIndex !== surrogateKey) {\r\n                var decorated = self.getDecorated(rowIndex);\r\n                decorated.setDisplayValue(false);\r\n                self.setValue(rowIndex, false);\r\n                enabledChecks[xpath].push([rowIndex]);\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Column Decorator Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.readonly\", bizagi.rendering.columns.readonly.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.readonly.extend(\"bizagi.rendering.desktop.columns.readonly\", {}, {\r\n\r\n});","/*\r\n *   Name: Bizagi Base Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define an abstract render factory in order to do common stuff for all device factories\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.base.factory\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService) {\r\n        this.templates = {};\r\n        this.dataService = dataService;        \r\n    },\r\n\r\n    /**\r\n    * Load client resources in order to override a default behavior\r\n    */\r\n    loadOverrides: function () {\r\n    },\r\n    /*\r\n    *   This function will load asynchronous stuff needed in the module\r\n    */\r\n    initAsyncStuff: function() {\r\n        return $.when.apply($, [this.loadOverrides(), this.loadTemplates()]);\r\n    },\r\n    /*\r\n    *   Load all the templates used for rendering\r\n    */\r\n    loadTemplates: function () {\r\n    },\r\n    /*\r\n    *   Load one template and save it internally\r\n    */\r\n    loadTemplate: function(template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return bizagi.templateService.getTemplate(templateDestination, template)\r\n                .done(function (resolvedTemplate) {\r\n                self.templates[template] = resolvedTemplate;\r\n            });\r\n    },\r\n    /*\r\n    * Returns a common  used template for the framework\r\n    */\r\n    getCommonTemplate: function (template) {        \r\n        return this.templates[template];\r\n    },\r\n    /*\r\n    *   Returns the appropiate container based on the container type\r\n    */\r\n    getContainer: function (params) {\r\n        // TODO: REMOVE IMPLEMENTATION\r\n\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.form(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type.toLowerCase() == \"nestedform\") {\r\n            return new bizagi.rendering.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.group(containerParams);\r\n        }\r\n\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.searchForm(containerParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate render based on the render type\r\n    */\r\n    getRender: function (params) {\r\n\r\n        // TODO: REMOVE IMPLEMENTATION\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type == \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(renderParams);\r\n        }\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        if (type == \"association\") {\r\n            return new bizagi.rendering.association(renderParams);\r\n        }\r\n\r\n        if (type == \"label\") {\r\n            return new bizagi.rendering.label(renderParams);\r\n        }\r\n\r\n        if (type == \"hidden\") {\r\n            return new bizagi.rendering.hidden(renderParams);\r\n        }\r\n\r\n        if (type == \"number\") {\r\n            return new bizagi.rendering.number(renderParams);\r\n        }\r\n\r\n        if (type == \"money\") {\r\n            return new bizagi.rendering.money(renderParams);\r\n        }\r\n\r\n        if (type == \"date\") {\r\n            return new bizagi.rendering.date(renderParams);\r\n        }\r\n\r\n        if (type == \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(renderParams);\r\n        }\r\n\r\n        if (type == \"combo\") {\r\n            return new bizagi.rendering.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"list\") {\r\n            return new bizagi.rendering.list(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"radio\") {\r\n            return new bizagi.rendering.radio(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            // Override for test purposes\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.ecm(renderParams);\r\n        }\r\n\r\n        if (type == \"upload\") {\r\n            return new bizagi.rendering.upload(renderParams);\r\n        }\r\n        if (type == \"grid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"groupedgrid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"search\") {\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"searchList\") {\r\n            return new bizagi.rendering.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"letter\") {\r\n            return new bizagi.rendering.letter(renderParams);\r\n        }\r\n\r\n        if (type == \"button\") {\r\n            return new bizagi.rendering.button(renderParams);\r\n        }\r\n\r\n        if (type == \"formLink\") {\r\n            return new bizagi.rendering.formLink(renderParams);\r\n        }\r\n\r\n        if (type == \"link\") {\r\n            return new bizagi.rendering.link(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutImage\") {\r\n            return new bizagi.rendering.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLink\") {\r\n            return new bizagi.rendering.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLabel\") {\r\n            return new bizagi.rendering.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutText\") {\r\n            return new bizagi.rendering.layoutText(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutDateTime\") {\r\n            return new bizagi.rendering.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutNumber\") {\r\n            return new bizagi.rendering.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutMoney\") {\r\n            return new bizagi.rendering.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type == \"actionLauncher\") {\r\n            return new bizagi.rendering.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutBoolean\") {\r\n            return new bizagi.rendering.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutUpload\") {\r\n            return new bizagi.rendering.layoutUpload(renderParams);\r\n        }\r\n\r\n        if (type == \"entityTemplate\") {\r\n            return new bizagi.rendering.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type == \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"userfield\") {\r\n            return new bizagi.rendering.userfieldWrapper(renderParams);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") == 0) {\r\n            return this.getSearchRender(params);\r\n        }\r\n\r\n        if (type.indexOf(\"query\") == 0) {\r\n            return this.getQueryRender(params);\r\n        }\r\n\r\n        if (type == \"document\") {\r\n            return new bizagi.rendering.document(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"fileprint\") {\r\n            return new bizagi.rendering.fileprint(renderParams);\r\n        }\r\n        if (type == \"geolocation\") {\r\n            return new bizagi.rendering.geolocation(renderParams);\r\n        }\r\n\r\n        if (type == \"collectionnavigator\") {\r\n            return new bizagi.rendering.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type == \"getUser\") {\r\n            return new bizagi.rendering.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeDate\") {\r\n            return new bizagi.rendering.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeMoney\") {\r\n            return new bizagi.rendering.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeNumber\") {\r\n            return new bizagi.rendering.rangeNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"activityCheckList\") {\r\n            return new bizagi.rendering.activityCheckList(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate column based on the render type\r\n    */\r\n    getColumn: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type == \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.text;\r\n            }\r\n            return new bizagi.rendering.columns.text(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.searchList;\r\n            return new bizagi.rendering.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type == \"columnNumber\") {\r\n            columnParams.decorated = bizagi.rendering.number;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.money;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.date;\r\n            return new bizagi.rendering.columns.date(columnParams);\r\n        }\r\n\r\n        if (type == \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.yesno;\r\n            }\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.combo;\r\n            return new bizagi.rendering.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type == \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.radio;\r\n            return new bizagi.rendering.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type == \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.list;\r\n            return new bizagi.rendering.columns.list(columnParams);\r\n        }\r\n\r\n        if (type == \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.hidden;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.upload;\r\n            return new bizagi.rendering.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type == \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.image;\r\n            return new bizagi.rendering.columns.image(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.ecm;\r\n            return new bizagi.rendering.columns.uploadecm(columnParams);\r\n        }\r\n        if (type == \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.link;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.formLink;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.userfieldWrapper;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.search;\r\n            return new bizagi.rendering.columns.search(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.document;\r\n            return new bizagi.rendering.columns.document(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.letter;\r\n            return new bizagi.rendering.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type == \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.button;\r\n            return new bizagi.rendering.columns.button(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                //Creates a Scientific Notation render\r\n                return new bizagi.rendering.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.queryExtendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.queryText(searchParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.queryCheck(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.queryYesNo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.queryNumber(searchParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.queryMoney(searchParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.queryDate(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.queryCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.queryCascadingCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.querySuggest(searchParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.queryLabel(searchParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.queryList(searchParams);\r\n        }\r\n        \r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.queryMultiSelect(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.querySearch(searchParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.queryRadio(searchParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.queryState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.queryCaseState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.queryProcess(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.querySearchUser(searchParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.hidden(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Method to fetch templates from a private dictionary\r\n    */\r\n    getTemplate: function (template) {\r\n        var self = this;\r\n        return self.templates[template];\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a render factory to create desktop versions of each render type\r\n */\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.desktop.factory\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (dataService) {\r\n        // Call base\r\n        this._super(dataService);\r\n\r\n        // Desktop implementation\r\n        this.printVersion = false;\r\n    },\r\n\r\n    /**\r\n     * Load all the templates used for rendering\r\n     */\r\n    loadTemplates: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(\r\n            // Icons\r\n            self.loadTemplate(\"icons\", bizagi.getTemplate(\"common.bizagi.rendering.icons\")),\r\n\r\n            // Common\r\n            self.loadTemplate(\"form-error\", bizagi.getTemplate(\"bizagi.rendering.desktop.form-error\")),\r\n            self.loadTemplate(\"form-waiting\", bizagi.getTemplate(\"bizagi.rendering.desktop.form-waiting\")),\r\n            self.loadTemplate(\"info-message\", bizagi.getTemplate(\"common.bizagi.desktop.info-message\")),\r\n            // Containers\r\n            self.loadTemplate(\"form\", bizagi.getTemplate(\"bizagi.rendering.desktop.form\") + \"#ui-bizagi-render-form\"),\r\n            self.loadTemplate(\"form-process-path\", bizagi.getTemplate(\"bizagi.rendering.desktop.form\") + \"#ui-bizagi-render-form-process-path\"),\r\n            self.loadTemplate(\"panel\", bizagi.getTemplate(\"bizagi.rendering.desktop.panel\")),\r\n            self.loadTemplate(\"contentPanel\", bizagi.getTemplate(\"bizagi.rendering.desktop.contentPanel\")),\r\n            self.loadTemplate(\"tab\", bizagi.getTemplate(\"bizagi.rendering.desktop.tab\")),\r\n            self.loadTemplate(\"tabItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.tabItem\")),\r\n            self.loadTemplate(\"collectionnavigator\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator\"),\r\n            self.loadTemplate(\"collectionnavigator-form-button\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-form-button\"),\r\n            self.loadTemplate(\"collectionnavigator-control\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-control\"),\r\n            self.loadTemplate(\"collectionnavigator-actions\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-actions\"),\r\n            self.loadTemplate(\"collectionnavigator-preview\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-preview\"),\r\n            self.loadTemplate(\"collectionnavigator-execution\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-execution\"),\r\n            self.loadTemplate(\"horizontal\", bizagi.getTemplate(\"bizagi.rendering.desktop.horizontal\")),\r\n            self.loadTemplate(\"accordion\", bizagi.getTemplate(\"bizagi.rendering.desktop.accordion\")),\r\n            self.loadTemplate(\"accordionItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.accordionItem\")),\r\n            self.loadTemplate(\"group\", bizagi.getTemplate(\"bizagi.rendering.desktop.group\")),\r\n            self.loadTemplate(\"searchForm\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchForm\")),\r\n            // Renders\r\n            self.loadTemplate(\"render\", bizagi.getTemplate(\"bizagi.rendering.desktop.render\")),\r\n            self.loadTemplate(\"render-base\", bizagi.getTemplate(\"bizagi.rendering.desktop.render.base\")),\r\n\r\n            self.loadTemplate(\"render-layout\", bizagi.getTemplate(\"bizagi.rendering.desktop.render.layout\")),\r\n\r\n            self.loadTemplate(\"render-userPassword\", bizagi.getTemplate(\"bizagi.rendering.desktop.userPassword\") + \"#bz-rendering-userPassword\"),\r\n            self.loadTemplate(\"render-getUser\", bizagi.getTemplate(\"bizagi.rendering.desktop.getUser\") + \"#bz-rendering-getUser\"),\r\n            self.loadTemplate(\"render-user-email\", bizagi.getTemplate(\"bizagi.rendering.desktop.userEmail\") + \"#bz-rendering-user-email\"),\r\n            self.loadTemplate(\"render-comboSelected\", bizagi.getTemplate(\"bizagi.rendering.desktop.comboSelected\") + \"#bz-rendering-comboSelected\"),\r\n            self.loadTemplate(\"render-comboSelectedReadOnly\", bizagi.getTemplate(\"bizagi.rendering.desktop.comboSelected\") + \"#bz-rendering-comboSelected-ReadOnly\"),\r\n            self.loadTemplate(\"render-querySearchUser\", bizagi.getTemplate(\"bizagi.rendering.desktop.querySearchUser\") + \"#ui-bizagi-render-querySearchUser\"),\r\n            self.loadTemplate(\"text\", bizagi.getTemplate(\"bizagi.rendering.desktop.text\") + \"#ui-bizagi-render-text\"),\r\n            self.loadTemplate(\"text-read-only\", bizagi.getTemplate(\"bizagi.rendering.desktop.text\") + \"#ui-bizagi-render-text-read-only\"),\r\n            self.loadTemplate(\"extendedText\", bizagi.getTemplate(\"bizagi.rendering.desktop.extendedText\")),\r\n            self.loadTemplate(\"number\", bizagi.getTemplate(\"bizagi.rendering.desktop.number\")),\r\n            self.loadTemplate(\"numberScientificNotation\", bizagi.getTemplate(\"bizagi.rendering.desktop.numberScientificNotation\") + \"#bz-rendering-numberScientificNotation\"),\r\n            self.loadTemplate(\"date\", bizagi.getTemplate(\"bizagi.rendering.desktop.date\")),\r\n            self.loadTemplate(\"yesno\", bizagi.getTemplate(\"bizagi.rendering.desktop.yesno\")),\r\n            self.loadTemplate(\"check\", bizagi.getTemplate(\"bizagi.rendering.desktop.check\")),\r\n            self.loadTemplate(\"combo\", bizagi.getTemplate(\"bizagi.rendering.desktop.combo\")),\r\n            self.loadTemplate(\"list\", bizagi.getTemplate(\"bizagi.rendering.desktop.list\")),\r\n            self.loadTemplate(\"geolocation\", bizagi.getTemplate(\"bizagi.rendering.desktop.geolocation\")),\r\n            self.loadTemplate(\"radio\", bizagi.getTemplate(\"bizagi.rendering.desktop.radio\")),\r\n            self.loadTemplate(\"image\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image\"),\r\n            self.loadTemplate(\"images\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-images\"),\r\n            self.loadTemplate(\"image-dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image-dialog\"),\r\n            self.loadTemplate(\"image-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image-item\"),\r\n            self.loadTemplate(\"upload-ecm-view-default\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-metadata\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-metadata\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-yesno\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-yesno\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-edit-buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-edit-buttons\"),\r\n            self.loadTemplate(\"document\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator\"),\r\n            self.loadTemplate(\"document-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item\"),\r\n            self.loadTemplate(\"document-column-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-column-item\"),\r\n            self.loadTemplate(\"document-item-preview\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item-preview\"),\r\n            self.loadTemplate(\"document-item-preview-object\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item-preview-object\"),\r\n            self.loadTemplate(\"uploadItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.uploadItem\")),\r\n            self.loadTemplate(\"upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload\")),\r\n            self.loadTemplate(\"upload.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.dialog\")),\r\n            self.loadTemplate(\"upload.template.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.template.dialog\")),\r\n            self.loadTemplate(\"upload.ecm.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.ecm.dialog\")),\r\n            self.loadTemplate(\"dialog-send-email\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-sendEmail\") + \"#dialog-send-email\"),\r\n            self.loadTemplate(\"dialog-send-email-rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-sendEmail\") + \"#dialog-send-email-rtl\"),\r\n            self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid\")),\r\n            self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell\")),\r\n            self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.readonly\")),\r\n            self.loadTemplate(\"cell.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.summary\")),\r\n            self.loadTemplate(\"cell.upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.upload\")),\r\n            self.loadTemplate(\"cell.button\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.button\")),\r\n            self.loadTemplate(\"search\", bizagi.getTemplate(\"bizagi.rendering.desktop.search\")),\r\n            self.loadTemplate(\"searchItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchItem\")),\r\n            self.loadTemplate(\"searchList\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchList\") + \"#bz-searchList\"),\r\n            self.loadTemplate(\"searchListTag\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchList\") + \"#bz-searchList-tag\"),\r\n            self.loadTemplate(\"letter\", bizagi.getTemplate(\"bizagi.rendering.desktop.letter\")),\r\n            self.loadTemplate(\"letter.readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.letter.readonly\")),\r\n            self.loadTemplate(\"letter.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-letter\")),\r\n            self.loadTemplate(\"button\", bizagi.getTemplate(\"bizagi.rendering.desktop.button\")),\r\n            self.loadTemplate(\"fileprint\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint\"),\r\n            self.loadTemplate(\"fileprint-object\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint-object\"),\r\n            self.loadTemplate(\"fileprint-iframe\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint-iframe\"),\r\n            self.loadTemplate(\"link\", bizagi.getTemplate(\"bizagi.rendering.desktop.link\")),\r\n            self.loadTemplate(\"formLink\", bizagi.getTemplate(\"bizagi.rendering.desktop.formLink\")),\r\n            self.loadTemplate(\"association\", bizagi.getTemplate(\"bizagi.rendering.desktop.association\")),\r\n            self.loadTemplate(\"stakeholder\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder\"),\r\n            self.loadTemplate(\"stakeholder-grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder-grid\"),\r\n            self.loadTemplate(\"stakeholder-paginator\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder-paginator\"),\r\n            self.loadTemplate(\"queryProcess\", bizagi.getTemplate(\"bizagi.rendering.desktop.queryProcess\") + \"#ui-bizagi-render-query-process\"),\r\n            self.loadTemplate(\"checkList\", bizagi.getTemplate(\"bizagi.rendering.desktop.checkList\") + \"#bz-rendering-checkList\"),\r\n            self.loadTemplate(\"checkList-disabled\", bizagi.getTemplate(\"bizagi.rendering.desktop.checkList\") + \"#bz-rendering-checkList-disabled\"),\r\n            self.loadTemplate(\"readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.readonly\")),\r\n\r\n            //render layout controls\r\n            self.loadTemplate(\"layout-link\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.link\")),\r\n            self.loadTemplate(\"layout-image\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n            self.loadTemplate(\"layout-image64\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n            self.loadTemplate(\"layout-label\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.label\")),\r\n            self.loadTemplate(\"layout-text\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.text\")),\r\n            self.loadTemplate(\"layout-upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.upload\")),\r\n            self.loadTemplate(\"layout-uploadItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.uploadItem\")),\r\n            self.loadTemplate(\"layout-date-time\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.dateTime\")),\r\n            self.loadTemplate(\"layout-number\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.number\")),\r\n            self.loadTemplate(\"layout-money\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.money\")),\r\n            self.loadTemplate(\"layout-placeholder\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.placeholder\")),\r\n            self.loadTemplate(\"layout-boolean\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.yesno\")),\r\n\r\n            //action launcher\r\n            self.loadTemplate(\"render-actionLauncher\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal-more\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal-more\"),\r\n            self.loadTemplate(\"render-actionLauncher-vertical\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n            self.loadTemplate(\"render-actionLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-actionLauncher-design\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-design\"),\r\n            self.loadTemplate(\"render-actionLauncher-confirm\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-confirm\"),\r\n\r\n            self.loadTemplate(\"render-polymorphicLauncher\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-design\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-design\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-confirm\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n\r\n\r\n            (bizagi.override.enablePrintFromEditForm) ? self.loadTemplate(\"print-frame\", bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\") + \"#bz-wp-widget-print-frame\") : null, (bizagi.override.enablePrintFromEditForm) ? self.loadTemplate(\"print-frame-header\", bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\") + \"#bz-wp-widget-print-frame-header\") : null,\r\n\r\n            //Bizagi grid\r\n            self.loadTemplate(\"grid.bizagi\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.component\")),\r\n            self.loadTemplate(\"bizagi.grid.grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid\"),\r\n            self.loadTemplate(\"bizagi.grid.grid.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.waiting\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-waiting\"),\r\n            self.loadTemplate(\"bizagi.grid.table\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-table\"),\r\n            self.loadTemplate(\"bizagi.grid.table.empty\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-table-empty\"),\r\n            self.loadTemplate(\"bizagi.grid.column\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-column\"),\r\n            self.loadTemplate(\"bizagi.grid.column.special\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-column-special\"),\r\n            self.loadTemplate(\"bizagi.grid.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row-buttons-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.cell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.cell.special\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-cell-special\"),\r\n            //Grig Pager based on inboxgrid pager\r\n            self.loadTemplate(\"bizagi.grid.pagination\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-pagination\"),\r\n            self.loadTemplate(\"bizagi.grid.pager\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-buttons-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.dynamicpager\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-dynamic-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-summary\"),\r\n            self.loadTemplate(\"bizagi.grid.summaryCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-summary-cell\"),\r\n            // Grouped grid\r\n            self.loadTemplate(\"bizagi.grid.grouped.table\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-table\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.column\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-column\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-row\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.header.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-header-row\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-summary\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.summaryCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-summary-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.emptyCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-empty-cell\"),\r\n            //plugin search user\r\n            self.loadTemplate(\"bizagi.plugin.search.user\", bizagi.getTemplate(\"bizagi.plugin.searchuser\") + \"#ui-bizagi-plugin-search-user\"),\r\n            self.loadTemplate(\"gridActions\", bizagi.getTemplate(\"bizagi.rendering.desktop.gridActions\") + \"#ui-bizagi-grid-actions-more\"),\r\n            self.loadTemplate(\"gridActions-delete\", bizagi.getTemplate(\"bizagi.rendering.desktop.gridActions\") + \"#ui-bizagi-grid-actions-delete\"),\r\n\r\n            // List multi-select\r\n            self.loadTemplate(\"list-multiselect\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect\"),\r\n            self.loadTemplate(\"list-multiselect-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-item\"),\r\n            self.loadTemplate(\"list-multiselect-tag\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-tag\"),\r\n            self.loadTemplate(\"list-multiselect-tags\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-tags\"),\r\n            self.loadTemplate(\"list-multiselect-view-more\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-view-more\"),\r\n\r\n\r\n            //Range control\r\n            self.loadTemplate(\"render-range\", bizagi.getTemplate(\"bizagi.rendering.desktop.range\") + \"#bz-rendering-range\"),\r\n\r\n            self.loadTemplate(\"bizagi.grid.exportOptions\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-export-options\")).done(function () {\r\n            var tmplIcons = $.fasttmpl(self.getTemplate(\"icons\"));\r\n            var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n            if (svgStoreCounter === 0) {\r\n                $(\"head\").append(tmplIcons);\r\n            }\r\n\r\n            // Resolve when all templates are loaded\r\n            defer.resolve();\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Load javascripts after render has been rendered\r\n     */\r\n    loadOverrides: function () {\r\n        // Load custom javascript overrides\r\n        if (bizagi.enableCustomizations) {\r\n            return bizagi.util.loadFile({\r\n                src: bizagi.getJavaScript(\"bizagi.rendering.desktop.overrides\"),\r\n                type: \"js\"\r\n            });\r\n        }\r\n\r\n        return;\r\n    },\r\n\r\n    getContainer: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.desktop.form(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.desktop.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.desktop.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.desktop.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.desktop.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.desktop.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.desktop.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type == \"nestedForm\") {\r\n            return new bizagi.rendering.desktop.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.desktop.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.desktop.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.desktop.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.desktop.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.desktop.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.desktop.group(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.desktop.searchForm(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Returns the appropiate render based on the render type\r\n     */\r\n    getRender: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type === \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.desktop.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.text(renderParams);\r\n        }\r\n\r\n        if (type === \"association\") {\r\n            return new bizagi.rendering.desktop.association(renderParams);\r\n        }\r\n\r\n        if (type === \"label\") {\r\n            return new bizagi.rendering.desktop.label(renderParams);\r\n        }\r\n\r\n        if (type === \"hidden\") {\r\n            return new bizagi.rendering.desktop.hidden(renderParams);\r\n        }\r\n\r\n        if (type === \"number\") {\r\n            // Number Scientific Notation\r\n            if (properties && properties.dataType === 29) {\r\n                return new bizagi.rendering.desktop.numberScientificNotation(renderParams);\r\n            }\r\n\r\n            return new bizagi.rendering.desktop.number(renderParams);\r\n        }\r\n\r\n        if (type === \"money\") {\r\n            return new bizagi.rendering.desktop.money(renderParams);\r\n        }\r\n\r\n        if (type === \"date\") {\r\n            return new bizagi.rendering.desktop.date(renderParams);\r\n        }\r\n\r\n        if (type === \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display === \"check\") {\r\n                return new bizagi.rendering.desktop.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.yesno(renderParams);\r\n        }\r\n\r\n        if (type === \"combo\") {\r\n            return new bizagi.rendering.desktop.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.desktop.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type === \"list\") {\r\n            return new bizagi.rendering.desktop.list(renderParams);\r\n        }\r\n\r\n        if (type === \"radio\") {\r\n            return new bizagi.rendering.desktop.radio(renderParams);\r\n        }\r\n\r\n        if (type === \"image\") {\r\n            return new bizagi.rendering.desktop.image(renderParams);\r\n        }\r\n\r\n        if (type === \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.desktop.ecm(renderParams);\r\n        }\r\n\r\n        if (type === \"upload\") {\r\n            return new bizagi.rendering.desktop.upload(renderParams);\r\n        }\r\n\r\n        if (type === \"grid\") {\r\n            return new bizagi.rendering.desktop.grid.bizagi(renderParams);\r\n        }\r\n\r\n        if (type === \"groupedgrid\") {\r\n            return new bizagi.rendering.desktop.grid.grouped(renderParams);\r\n        }\r\n\r\n        if (type === \"search\") {\r\n            return new bizagi.rendering.desktop.search(renderParams);\r\n        }\r\n\r\n        if (type === \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.desktop.search(renderParams);\r\n        }\r\n\r\n        if (type === \"searchList\") {\r\n            return new bizagi.rendering.desktop.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.desktop.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type === \"letter\") {\r\n            return new bizagi.rendering.desktop.letter(renderParams);\r\n        }\r\n\r\n        if (type === \"button\") {\r\n            return new bizagi.rendering.desktop.button(renderParams);\r\n        }\r\n\r\n        if (type === \"formLink\") {\r\n            return new bizagi.rendering.desktop.formLink(renderParams);\r\n        }\r\n\r\n        if (type === \"link\") {\r\n            return new bizagi.rendering.desktop.link(renderParams);\r\n        }\r\n\r\n        if (type === \"actionLauncher\") {\r\n            return new bizagi.rendering.desktop.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type === \"entityTemplate\") {\r\n            return new bizagi.rendering.desktop.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type === \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.desktop.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type === \"userfield\") {\r\n            return new bizagi.rendering.desktop.userfieldWrapper(renderParams);\r\n        }\r\n        // Check layout renders (starts with \"layout\")\r\n        if (type.indexOf(\"layout\") === 0) {\r\n            return self.getLayoutRender(params);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") === 0) {\r\n            return self.getSearchRender(params);\r\n        }\r\n\r\n        // Check query renders (starts with \"query\")\r\n        if (type.indexOf(\"query\") === 0) {\r\n            return self.getQueryRender(params);\r\n        }\r\n\r\n        // Check range renders (starts with \"range\")\r\n        if (type.indexOf(\"range\") === 0) {\r\n            return self.getRangeRender(params);\r\n        }\r\n\r\n        if (type === \"document\") {\r\n            return new bizagi.rendering.desktop.document(renderParams);\r\n        }\r\n\r\n        if (type === \"image\") {\r\n            return new bizagi.rendering.desktop.image(renderParams);\r\n        }\r\n\r\n        if (type === \"fileprint\") {\r\n            return new bizagi.rendering.desktop.fileprint(renderParams);\r\n        }\r\n\r\n        if (type === \"geolocation\") {\r\n            return new bizagi.rendering.desktop.geolocation(renderParams);\r\n        }\r\n\r\n        if (type === \"collectionnavigator\") {\r\n            return new bizagi.rendering.desktop.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type === \"activityCheckList\") {\r\n            return new bizagi.rendering.desktop.activityCheckList(renderParams);\r\n        }\r\n\r\n        if (type === \"getUser\") {\r\n            return new bizagi.rendering.desktop.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"userPassword\") {\r\n            return new bizagi.rendering.desktop.userPassword(renderParams);\r\n        }\r\n\r\n        if (type == \"comboSelected\") {\r\n            return new bizagi.rendering.desktop.comboSelected(renderParams);\r\n        }\r\n\r\n        if (type == \"stakeholder\") {\r\n            return new bizagi.rendering.desktop.stakeholder(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiate column based on the render type\r\n     */\r\n    getColumn: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type === \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.desktop.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.desktop.text;\r\n            }\r\n            return new bizagi.rendering.desktop.columns.text(columnParams);\r\n        }\r\n\r\n        if (type === \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.searchList;\r\n            return new bizagi.rendering.desktop.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type === \"columnNumberScientificNotation\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.numberScientificNotation;\r\n            return new bizagi.rendering.desktop.columns.numberScientificNotation(columnParams);\r\n        }\r\n\r\n        if (type === \"columnNumber\") {\r\n            if (properties && properties.dataType === 29) {\r\n                columnParams.decorated = bizagi.rendering.desktop.numberScientificNotation;\r\n                return new bizagi.rendering.desktop.columns.numberScientificNotation(columnParams);\r\n            } else {\r\n                columnParams.decorated = bizagi.rendering.desktop.number;\r\n                return new bizagi.rendering.desktop.columns.number(columnParams);\r\n            }\r\n        }\r\n\r\n        if (type === \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.money;\r\n            return new bizagi.rendering.desktop.columns.number(columnParams);\r\n        }\r\n\r\n        if (type === \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.date;\r\n            return new bizagi.rendering.desktop.columns.date(columnParams);\r\n        }\r\n\r\n        if (type === \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display === \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.desktop.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.desktop.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.desktop.yesno;\r\n            }\r\n\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.combo;\r\n            return new bizagi.rendering.desktop.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type === \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.radio;\r\n            return new bizagi.rendering.desktop.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type === \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.list;\r\n            return new bizagi.rendering.desktop.columns.list(columnParams);\r\n        }\r\n\r\n        if (type === \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.hidden;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.upload;\r\n            return new bizagi.rendering.desktop.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type === \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.image;\r\n            return new bizagi.rendering.desktop.columns.image(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.ecm;\r\n            return new bizagi.rendering.desktop.columns.uploadecm(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.link;\r\n            return new bizagi.rendering.desktop.columns.link(columnParams);\r\n        }\r\n\r\n        if (type === \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.formLink;\r\n            return new bizagi.rendering.desktop.columns.link(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.userfieldWrapper;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.search;\r\n            return new bizagi.rendering.desktop.columns.search(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.label;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.label;\r\n            return new bizagi.rendering.desktop.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type === \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.document;\r\n            return new bizagi.rendering.desktop.columns.document(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.letter;\r\n            return new bizagi.rendering.desktop.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type === \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.button;\r\n            return new bizagi.rendering.desktop.columns.button(columnParams);\r\n        }\r\n\r\n        if (type === \"columnActions\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.gridActions;\r\n            return new bizagi.rendering.desktop.columns.actions(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiatelayout render based on the type\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getLayoutRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type === \"layoutImage\") {\r\n            return new bizagi.rendering.desktop.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutLink\") {\r\n            return new bizagi.rendering.desktop.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutLabel\") {\r\n            return new bizagi.rendering.desktop.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutText\") {\r\n            return new bizagi.rendering.desktop.layoutText(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutDateTime\") {\r\n            return new bizagi.rendering.desktop.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutNumber\") {\r\n            return new bizagi.rendering.desktop.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutMoney\") {\r\n            return new bizagi.rendering.desktop.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.desktop.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutBoolean\") {\r\n            return new bizagi.rendering.desktop.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutUpload\") {\r\n            return new bizagi.rendering.desktop.layoutUpload(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.desktop.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.desktop.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                // Creates a Scientific Notation render\r\n                return new bizagi.rendering.desktop.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.desktop.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.desktop.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.desktop.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.desktop.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.desktop.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.desktop.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate query render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.desktop.queryExtendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.queryText(renderParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display == \"check\") {\r\n                return new bizagi.rendering.desktop.queryCheck(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.queryYesNo(renderParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.desktop.queryNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.desktop.queryMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.desktop.queryDate(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.desktop.queryCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.desktop.queryCascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.desktop.querySuggest(renderParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.desktop.queryLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.desktop.queryList(renderParams);\r\n        }\r\n\r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.desktop.queryMultiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.desktop.querySearch(renderParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.desktop.queryRadio(renderParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.desktop.queryState(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.desktop.queryCaseState(renderParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.desktop.queryProcess(renderParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.desktop.querySearchUser(renderParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.desktop.hidden(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getRangeRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type === \"rangeDate\") {\r\n            return new bizagi.rendering.desktop.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type === \"rangeMoney\") {\r\n            return new bizagi.rendering.desktop.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type === \"rangeNumber\") {\r\n            return new bizagi.rendering.desktop.rangeNumber(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.searchList\", bizagi.rendering.searchList.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.searchList.extend(\"bizagi.rendering.desktop.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Apply plugin\r\n        self.searchInput = $(\"input\", control);\r\n        $(control).find(\"input\").css({\"width\": \"100%\", \"padding-right\": \"25px\"});\r\n\r\n        self.applyAutocompletePlugin();\r\n        self.attachKeyEvents();\r\n    },\r\n\r\n    /**\r\n     * Attaches key events to the control\r\n     * @returns {}\r\n     */\r\n    attachKeyEvents: function () {\r\n        var self = this;\r\n\r\n        self.element.keydown(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                switch (keyUnicode) {\r\n                    case 8: // Backspace\r\n                        var caretPos = $(\"input:first\", self.element)[0].selectionStart;\r\n\r\n                        if (caretPos === 0) {\r\n                            self.removeLastElement();\r\n                            $(\"li:nth-last-child(2)\", self.element).remove();\r\n                            $(\".biz-render-input-search\", self.getControl()).focus();\r\n                        }\r\n\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Apply autocomplete capabilities to a single input\r\n     * @returns {}\r\n     */\r\n    applyAutocompletePlugin: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var searchInput = self.searchInput;\r\n\r\n        searchInput.autocomplete({\r\n            autoFocus: true,\r\n            messages: {\r\n                noResults: null, //\"No search results.\",\r\n                results: function () {\r\n                }\r\n            },\r\n            source: function (req, add) {\r\n                // active search\r\n                self.activeRequestTerm = req.term;\r\n\r\n                // Check local storage\r\n                var now = new Date().getTime();\r\n                var parseRequest = encodeURIComponent(req.term);\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n                var expire = bizagi.util.getItemLocalStorage(expireKey);\r\n\r\n                if (expire && self.properties.enableLocalStorage && now < expire) {\r\n                    try {\r\n                        var data = JSON.parse(bizagi.util.getItemLocalStorage(requestKey));\r\n                        add(data);\r\n                        self.hideAutocompleteLoading();\r\n                    } catch (e) {\r\n                        self.processRequest(req, add);\r\n                    }\r\n                } else {\r\n                    self.processRequest(req, add);\r\n                }\r\n            },\r\n            select: function (event, ui) {\r\n                var selectedValues = JSON.parse(self.getValue()).value;\r\n                var isNewItem = true;\r\n                if (typeof ui.item.id == \"undefined\") {\r\n                    isNewItem = false;\r\n                } else {\r\n                    $.each(selectedValues, function (i, val) {\r\n                        if (ui.item.id == val.id) {\r\n                            isNewItem = false;\r\n                            return isNewItem;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (isNewItem) {\r\n                    self.appendFoundItem(event, ui);\r\n                    self.changeRequired(false);\r\n                }\r\n\r\n                searchInput.autocomplete('close');\r\n                ui.item.value = \"\";\r\n            },\r\n            open: function () {\r\n                var suggestMenu = searchInput.data(\"ui-autocomplete\").menu.element;\r\n                var suggestStyles = {top: 0, left: 0};\r\n                var suggestContainer = searchInput.closest(\".ui-bizagi-control\");\r\n                var controlContainer = suggestContainer.parent();\r\n                var itemWidth = self.calculateSuggestionWidth();\r\n\r\n                $('li', suggestMenu).each(function () {\r\n                    if ($(this).index() % 2 < 1)\r\n                        $(this).addClass('biz-ui-even');\r\n                });\r\n\r\n                // Fix position to prevent the scroll of autocomplete\r\n                suggestMenu.css(suggestStyles);\r\n                suggestContainer.addClass(\"ac-is-visible\");\r\n                controlContainer.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n                suggestMenu.appendTo(suggestContainer).position({\r\n                    my: \"left top\",\r\n                    at: \"left bottom\",\r\n                    of: this,\r\n                    collision: \"flipfit\"\r\n                });\r\n\r\n                suggestMenu.css(\"z-index\", $.getMaxZindex() + 10);\r\n\r\n                // Add data to check if element is visible\r\n                suggestMenu.attr(\"visible\", true);\r\n\r\n                // Apply width to menu and items\r\n                $(\".ui-bizagi-render-search-item\", suggestMenu).width(itemWidth);\r\n                suggestMenu.width(itemWidth);\r\n                self.hideAutocompleteLoading();\r\n\r\n            },\r\n            close: function () {\r\n                searchInput.data(\"ui-autocomplete\").menu.element.attr(\"visible\", false);\r\n            },\r\n            delay: this.Class.SEARCH_DELAY,\r\n            minLength: self.Class.SEARCH_MIN_LENGTH\r\n        });\r\n\r\n\r\n        // Special rendering\r\n        searchInput.data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n            // Normal rendering\r\n            return self.renderSearchItem(item).appendTo(ul);\r\n        };\r\n\r\n        // Set close event\r\n        $('[data-action=remove]', control).click(function () {\r\n            self.deleteItem($(this));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Append matched element\r\n     * @param {} event\r\n     * @param {} ui\r\n     * @returns {}\r\n     */\r\n    appendFoundItem: function (event, ui) {\r\n        var self = this;\r\n        var control = this.getControl();\r\n        var ul = $('.biz-render-input-search', control).closest('ul');\r\n        var last = $('li:last', ul);\r\n        var newElement;\r\n\r\n        // Format additional label\r\n        ui.item.value = self.formatItem(ui.item.value);\r\n\r\n        var element = self.renderFactory.getTemplate(\"searchListTag\");\r\n    \r\n        newElement = $.fasttmpl(element,\r\n            {\r\n                id: ui.item.id, \r\n                value: ui.item.value,\r\n                editable: true\r\n            },\r\n            {\r\n                formatItem: self.formatItem\r\n            });\r\n\r\n        // Append new li with match word\r\n        $(last).before(newElement);\r\n\r\n        // Set close event\r\n        $('[data-action=remove]', ul).click(function () {\r\n            self.deleteItem($(this));\r\n        });\r\n\r\n        // Set selected flag\r\n        $('.biz-render-input-search', control).data('selected', '1');\r\n\r\n        // Set focus on input field\r\n        $('.biz-render-input-search', control).focus();\r\n\r\n        // Remove selected css class from all elements\r\n        $('li', ul).removeClass('selected');\r\n\r\n        // Set value\r\n        this.addElement({id: ui.item.id, value: ui.item.value});\r\n\r\n    },\r\n\r\n    deleteItem: function (element) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var li = element.parent('.bz-pill');\r\n\r\n        // Remove from main memory and set the new value\r\n        this.removeElement({id: li.data('id')});\r\n\r\n        // Remove list element\r\n        li.remove();\r\n\r\n        //Changing required label\r\n        var list = JSON.parse(this.value);\r\n        if (list.value.length === 0)\r\n            self.changeRequired(self.properties.required);\r\n\r\n        // Set focus on input element\r\n        $('.biz-render-input-search', control).focus();\r\n    },\r\n\r\n    /* \r\n     *   Renders a search item\r\n     */\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchItem\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            image: properties.searchImage,\r\n            label: item.label,\r\n            orientation: self.properties.orientation || \"lrt\"\r\n        });\r\n\r\n        searchItem.data(\"item.autocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /* \r\n     *   Process the request data for the autocomplete control\r\n     */\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.showAutocompleteLoading();\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            $.when(this.getData()).done(function (data) {\r\n                data = data.slice(0, properties.maxRecords);\r\n\r\n                if (data.length > 50) {\r\n                    data = data.slice(0, 50);\r\n\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                        value: ''\r\n                    });\r\n                } else data = data.slice(0, properties.maxRecords);\r\n                if (data && data.length > 0) {\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords == 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n\r\n                            suggestions.push({id: val.id, label: parseValue, value: val.value});\r\n                        }\r\n                    });\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: ''\r\n                    });\r\n                }\r\n\r\n                addToSuggestions(suggestions, req.term);\r\n\r\n                self.hideAutocompleteLoading();\r\n\r\n                /*\r\n                 *   Method to add the special items to the suggestions\r\n                 */\r\n                function addToSuggestions(allSuggestions, request) {\r\n\r\n                    // Create local storage to improve the speed\r\n                    var expireTime = new Date().getTime() + self.properties.expireCache;\r\n                    var parseRequest = encodeURIComponent(request);\r\n\r\n                    if (self.properties.enableLocalStorage) {\r\n                        var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                        var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n\r\n                        bizagi.util.setItemLocalStorage(expireKey, expireTime);\r\n                        bizagi.util.setItemLocalStorage(requestKey, JSON.encode(allSuggestions));\r\n                    }\r\n                    // Pass array to callback\r\n                    add(allSuggestions);\r\n                }\r\n            });\r\n\r\n        }\r\n    },\r\n\r\n    showAutocompleteLoading: function () {\r\n        $('i', this.getControl()).addClass('ui-autocomplete-loading');\r\n    },\r\n\r\n    hideAutocompleteLoading: function () {\r\n        $('i', this.getControl()).removeClass('ui-autocomplete-loading');\r\n    },\r\n    /**\r\n     * Returns the desired width for the suggestion menu\r\n     * @returns {}\r\n     */\r\n    calculateSuggestionWidth: function () {\r\n        var self = this;\r\n        var suggestMenu = self.searchInput.data(\"ui-autocomplete\").menu.element;\r\n\r\n        return suggestMenu.width();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        if (value !== undefined) {\r\n            if (this.properties.editable) {\r\n                this.searchInput.val(value.label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Returns the value to display, ex. non-editable renders\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        var stringValue = properties.value.map(function (el) {\r\n            return self.formatItem(el.value);\r\n        }).join(\", \");\r\n\r\n        var tempHTML = \"<label class='readonly-control'>${value}</label>\";\r\n        var templateWithValues = $.tmpl(tempHTML, {value: stringValue});\r\n\r\n        control.empty();\r\n        control.append(templateWithValues);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Association Class\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define basic stuff for association renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.association\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var properties = self.properties;\r\n\r\n        // Fill default properties\r\n        properties.property = \"flipped\";\r\n        properties.idRender = self.properties.id;\r\n        properties.allowFlip = (typeof properties.allowFlip != \"undefined\") ? bizagi.util.parseBoolean(properties.allowFlip) : true;\r\n        properties.flipped = (typeof properties.flipped != \"undefined\") ? bizagi.util.parseBoolean(properties.flipped) : false;\r\n        properties.flipstate = properties.flipped;\r\n\r\n\r\n        // data of entities (left and right)\r\n        properties.leftData = properties.leftData || [];\r\n        properties.rightData = properties.rightData || [];\r\n\r\n        if (properties.value) {\r\n            self.processPropertyValue();\r\n        }\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation())\r\n            .done(function (flip) {\r\n\r\n                // Make json base, create self.properties.formatJson\r\n                self.makeJsonBase();\r\n\r\n                self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n                var html = $.fasttmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                });\r\n\r\n                /* by default need set self.properties.formatJson */\r\n                self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n                def.resolve(html);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    * Returns the flip state\r\n    */\r\n    getFlipAssociation: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode == \"execution\")\r\n            return self.dataService.getFlipAssociation(self.properties);\r\n\r\n        return false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var value = self.getValue();\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Get the template \r\n    */\r\n    getTemplateName: function () {\r\n        return \"association\";\r\n    },\r\n\r\n\r\n    /**\r\n    * Get Left Data, verify if flipper flags sets true\r\n    * \r\n    * @param column {'0'||'1'}\r\n    */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var data = [];\r\n        var associationData = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(associationData, function(key, item) {\r\n            data.push({ id: item.id, value: item.value });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n    * Association of right elements\r\n    */\r\n    getRightAssociation: function (leftId) {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var association = [];\r\n\r\n\r\n        var isChecked = function (leftId, idRight) {\r\n            var checked = false;\r\n            $.each(properties.formatJson.value, function (key, value) {\r\n                if (!checked && value.id == leftId && value.value.indexOf(idRight) >= 0) {\r\n                    checked = true;\r\n                }\r\n            });\r\n\r\n            return checked;\r\n        };\r\n\r\n        // create association and check element\r\n        if (properties.flipped) {\r\n            // left element\r\n            $.each(properties.leftData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(data.id, leftId)\r\n                });\r\n\r\n            });\r\n        } else {\r\n            $.each(properties.rightData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(leftId, data.id)\r\n                });\r\n            });\r\n        }\r\n\r\n        return association;\r\n    },\r\n\r\n\r\n    removeElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Remove right element from left panel\r\n                    $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                        if (leftId == removeValue) {\r\n                            // Splice from array\r\n                            self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                        }\r\n                    });\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Remove right element from left panel\r\n                $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                    if (rightId == removeValue) {\r\n                        // Splice from array\r\n                        self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n\r\n    addElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Add right element to left panel\r\n                    self.properties.formatJson.value[key][\"value\"].push(leftId);\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Add right element to left panel\r\n                self.properties.formatJson.value[key][\"value\"].push(rightId);\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n    makeJsonBase: function () {\r\n        var self = this;\r\n        self.properties.formatJson = self.properties.formatJson || {\r\n            leftXpath: self.properties.leftXpath,\r\n            rightXpath: self.properties.rightXpath,\r\n            leftFactName: self.properties.leftFactName,\r\n            rightFactName: self.properties.rightFactName,\r\n            value: self.properties.value\r\n        };\r\n    },\r\n\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.formatJson) {\r\n            var values = self.properties.formatJson.value;\r\n        } else {            \r\n            values = self.properties.value;\r\n        }\r\n       \r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var data = values[i];\r\n            if (data && data.value.length > 0) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    * This method process the value.\r\n    * changes the format to send request\r\n    */\r\n    processPropertyValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var values = properties.value;\r\n        var result = [];\r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var value = values[i];\r\n            result.push({ id: value[0], value: value[1] });\r\n        }\r\n\r\n        properties.value = result;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Association Extension\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script will redefine the Association control\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.association\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.association.extend(\"bizagi.rendering.desktop.association\", bizagi.rendering.association.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.association.extend(\"bizagi.rendering.desktop.association\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set close event to element into self.properties.value\r\n        $(\"ol .deleteBotton\", control).bind(\"click\", function () {\r\n            self.closeElement($(this).parent(\"li\"));\r\n        });\r\n\r\n        // Apply accordion control\r\n        $(\".bz-render-association-accordion\", control).togglepanels({\r\n            header: \"> div > h3\",\r\n            autoHeight: false,\r\n            animated: false\r\n        });\r\n\r\n        $.when(self.isRendered())\r\n            .done(function () {\r\n                var firstGroup = $(\".bz-render-association-accordion h3\", control).first();\r\n                firstGroup.click();\r\n            });\r\n\r\n\r\n        if (self.properties.allowFlip) {\r\n            // Bind event for flip botton\r\n            $(\".bz-render-association .flip-arrow\", control).bind(\"click\", function () {\r\n                $(control).empty();\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                // Send flip data to server\r\n                self.properties.flipstate = self.properties.flipped;\r\n\r\n                self.dataService.getFlipAssociation(self.properties);\r\n\r\n                // Render template  \r\n                $.tmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                }).appendTo(control);\r\n\r\n                self.internalPostRender();\r\n            });\r\n        }\r\n\r\n        $(\".bz-render-association bz-render-association-check-mask, .bz-render-association .bz-render-association-check\", control).bind(\"click\", function (e) {\r\n            e.stopPropagation();\r\n            var input = $(this);\r\n            var idLeft = $(this).parents(\"ol\").data(\"id\");\r\n            var idRight = $(this).data(\"id\");\r\n\r\n            if (input.prop(\"checked\")) {\r\n                // check element\r\n                input.prop(\"checked\", true);\r\n\r\n                // Add element to global value\r\n                self.addElement(idLeft, idRight);\r\n            } else {\r\n                // uncheck\r\n                input.prop(\"checked\", false);\r\n\r\n                // Remove from JSON\r\n                self.removeElement(idLeft, idRight);\r\n            }\r\n        });\r\n\r\n        $(\".bz-render-association .bz-render-association-left-container li\", control).bind(\"click\", function (e, ui) {\r\n            e.stopPropagation();\r\n\r\n            var input = ($(this).find(\"input\").length > 0) ? $(this).find(\"input\") : $(this);\r\n            var mask = $(\".bz-render-association-check-mask\", $(this));\r\n            var idLeft = $(this).parent(\"ol\").data(\"id\");\r\n            var idRight = $(this).data(\"id\") || $(this).parents(\"li\").data(\"id\");\r\n\r\n            if (input.prop(\"checked\")) {\r\n                // uncheck\r\n                input.removeAttr(\"checked\");\r\n                mask.removeClass(\"checked\");\r\n                mask.addClass(\"unchecked\");\r\n\r\n                // Remove from JSON\r\n                self.removeElement(idLeft, idRight);\r\n\r\n            } else {\r\n                // check element\r\n                input.prop(\"checked\", true);\r\n                mask.removeClass(\"unchecked\");\r\n                mask.addClass(\"checked\");\r\n\r\n                // Add element to global value\r\n                self.addElement(idLeft, idRight);\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Set Bind event to delete botton\r\n    */\r\n    setBindToClose: function (element) {\r\n        var self = this;\r\n        element.find(\".deleteBotton\").bind(\"click\", function () {\r\n            self.closeElement($(this).parent(\"li\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Execute close action\r\n    */\r\n    closeElement: function (element) {\r\n        var self = this;\r\n        var ol = element.parent(\"ol\");\r\n        // Remove from JSON\r\n        self.removeElement($(ol).data(\"id\"), element.data(\"id\"));\r\n\r\n        // Remove element\r\n        element.hide(\"highlight\", 1000, function () {\r\n            $(this).remove();\r\n        });\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n\r\n        self.properties.classCss = \"read-only\";\r\n\r\n        // Make json base, create self.properties.formatJson\r\n        self.makeJsonBase();\r\n        \r\n        // Render template  \r\n        $.tmpl(template, self.properties, {\r\n            getColumnData: self.getColumnData,\r\n            getRightAssociation: self.getRightAssociation,\r\n            getLeftName: self.getLeftName\r\n        }).appendTo(control);        \r\n        \r\n        // Apply accordion control\r\n        $(\".bz-render-association-accordion\", control).togglepanels({\r\n            header: \"> div > h3\",\r\n            autoHeight: false\r\n        });\r\n\r\n        $.when(self.isRendered())\r\n            .done(function () {\r\n                var firstGroup = $(\".bz-render-association-accordion h3\", control).first();\r\n                firstGroup.click();\r\n            });\r\n        \r\n        if (self.properties.allowFlip) {\r\n            // Bind event for flip botton\r\n            $(\".bz-render-association .flip-arrow\", control).bind(\"click\", function () {\r\n                $(control).empty();\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                self.postRenderReadOnly();\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    /*\r\n    * Method to render non editable values\r\n    */\r\n    renderReadOnly: function() {\r\n        var result = this.getValue();\r\n        return typeof (result) === \"object\" ? \"\" : result;\r\n    }\r\n});\r\n","/**\r\n * Description of control\r\n *\r\n * @author:\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.getUser\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        var properties = this.properties;\r\n        properties.allowDelegatedUser = this.properties.xpath && this.properties.xpath === \"idDelegate\";\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"render-getUser\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var result = this._super();\r\n        var html = result;\r\n        if(!bizagi.util.isString(html)){\r\n            html = result[0] && result[0].value ? result[0].value : \"\";\r\n        }\r\n        \r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        return bValid;\r\n    }\r\n\r\n});","/**\r\n * Description of file\r\n * @author: Jeison Borja\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.getUser\", bizagi.rendering.getUser.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.getUser.extend(\"bizagi.rendering.desktop.getUser\", {}, {\r\n    \r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var opt = {};\r\n        self.input = $(\".ui-bizagi-render-text\", self.getControl());\r\n\r\n        if (self.properties.value != null && self.properties.value.length > 0) {\r\n            self.setDisplayValue(self.properties.value[0]);\r\n        }\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.bindSearchUserPlugin(control);\r\n        $('#btn-clear-user', control).on('click', function () {\r\n            self.clearValue();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Set display value\r\n     */\r\n    setDisplayValue: function (data, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents == false ? triggerEvents : true;\r\n        var value = (typeof (data) !== \"undefined\") ? data.value : null;\r\n\r\n        if (self.properties.editable) {\r\n            self.input.val(value);\r\n        }\r\n\r\n        self.setValue(data, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Clear data control\r\n     */\r\n    clearValue: function () {\r\n        var self = this;\r\n\r\n        if (self.input) {\r\n            self.setDisplayValue(\"\",false);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Binds the search user plugin\r\n     */\r\n    bindSearchUserPlugin: function (control) {\r\n        var self = this;\r\n        var options = {\r\n            title: self.getResource(\"render-plugin-search-users-title\"),\r\n            maximize: false,\r\n            filters: [\"domain\", \"userName\", \"fullName\"],\r\n            displayNames: [\r\n                self.getResource(\"render-plugin-search-users-domain\"),\r\n                self.getResource(\"render-plugin-search-users-user-name\"),\r\n                self.getResource(\"render-plugin-search-users-full-name\")],\r\n            searchButtonName: self.getResource(\"render-plugin-search-users-search-button-name\"),\r\n            clearButtonName: self.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n            valuesToSelect: [\"iduser\", \"user\"], //\"iduser\",\"username\",\"user\",\"domain\",\"email\"\r\n            selectItem: function () {\r\n                var deferred = $.Deferred();\r\n                deferred.done(function (data) {\r\n                    self.onItemSelectedSuccess(data);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n                return deferred;\r\n            },\r\n            searchUsers: function (filterData) {\r\n                if (self.properties.allowDelegatedUser) {\r\n                    return self.dataService.getUsersListFromPreferences(filterData);\r\n                } else {\r\n                    return self.dataService.getUsersListForStakeholders(filterData);\r\n                }\r\n            },\r\n            getTableTemplate: function (usersResults, currentPage, pagination, pagesArray) {\r\n                var content = self.renderFactory.getTemplate(\"bizagi.plugin.search.user\");\r\n                var usersTableTmpl = $.tmpl(content, {\r\n                    users: usersResults,\r\n                    links: [self.getResource(\"render-plugin-search-users-select-link\")],\r\n                    page: currentPage,\r\n                    pagination: pagination,\r\n                    pagesArray: pagesArray\r\n                });\r\n                return usersTableTmpl;\r\n            },\r\n            showError: function (error) {\r\n                bizagi.log(error);\r\n            },\r\n            showMessageBox: function (message) {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(message), \"Bizagi\", \"warning\");\r\n            }\r\n        };\r\n\r\n        if (self.properties.allowDelegatedUser) {\r\n            options.editingUser = self.properties.idUser;\r\n        }\r\n\r\n        opt = options;\r\n\r\n        // Allows add new user when creating the pluggin\r\n        var params = self.getParams();\r\n        if (typeof params.isEntityForm !== \"undefined\" && params.isEntityForm) {\r\n            options.allowAddUser = bizagi.menuSecurity.UserAdmin || false;\r\n            options.dataService = self.dataService;\r\n            options.renderFactory = self.renderFactory;\r\n        }\r\n\r\n        $('#btn-get-user', control).bizagiSearchUser(options);\r\n    },\r\n\r\n    /**\r\n     * returns the opt var for unit testing\r\n     */\r\n    getOptions: function () {\r\n        return opt;\r\n    },\r\n    /**\r\n     *\r\n     * @param itemSelected\r\n     */\r\n    onItemSelectedSuccess: function (itemSelected) {\r\n        var self = this;\r\n        var data = {\r\n            id: itemSelected.iduser, \r\n            value: itemSelected.user \r\n        };\r\n\r\n        self.setDisplayValue(data);\r\n    },\r\n    \r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n            else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        this.changeRequiredLabel(argument);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Render Query Process\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will define basic stuff for query process renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.queryProcess\", {}, {\r\n    /*\r\n    * Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"queryProcess\");\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n    loadtemplates: function () { }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Query Process Extension\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will redefine the query process render class to adjust to desktop devices\r\n */\r\n// Extends itself\r\n\r\n // Extends from render Desktop base\r\n bizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.queryProcess\", bizagi.rendering.queryProcess.prototype);\r\n // Extends itself\r\n bizagi.rendering.desktop.queryProcess.extend(\"bizagi.rendering.desktop.queryProcess\", {}, {\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n    // Call base\r\n        this._super();\r\n        var template = self.renderFactory.getTemplate(\"queryProcessWrapper\");\r\n        var control = self.getControl();\r\n        self.getElement(\"row\").bind(\"click\", function(){\r\n            var wrapper = self.getWrapper();\r\n            if(wrapper.properties.visible){\r\n                wrapper.element.hide();\r\n                wrapper.element.css(\"visibility\",\"hidden\");\r\n                wrapper.element.empty();\r\n            }else{\r\n                wrapper.element.show();\r\n                wrapper.element.css(\"visibility\",\"visible\");\r\n                var data = self.loadData(\"aplications\");\r\n                self.renderData(data, wrapper.element);\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * get wrapper html and their properties\r\n     *\r\n     * @return {element: html, properties{visible:boolean}}\r\n     */\r\n    getWrapper: function(){\r\n        var self = this;\r\n        var wrapperElement = self.getElement(\"wrapper\");\r\n        var result = {\r\n            element: wrapperElement,\r\n            properties:{}\r\n        };\r\n        // Check visibility\r\n        result.properties.visible = (wrapperElement.css(\"visibility\") === \"visible\")?true: false;\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * @return {key(row|wrapper): html element}\r\n     */\r\n    getElement: function(key){\r\n        var control = this.getControl();\r\n        var objectMapper = {\r\n            row : $(\".ui-selectmenu-btn , .ui-bizagi-container-query-process :input[type=text]\", control),\r\n            wrapper: $(\".ui-selectmenu-wrapper\", control),\r\n            linkApplication: $(\".linkApplication\", control)\r\n        };\r\n\r\n        return objectMapper[key];\r\n    },\r\n\r\n    /**\r\n     * get data from server\r\n     * @return {applications:[{id:integer, appName: string},...] }\r\n     */\r\n    loadData: function(type){\r\n        if(type == \"aplications\"){\r\n            var result = {\r\n                items: [\r\n                    {\r\n                        id:1,\r\n                        displayName: \"My App 1\"\r\n                    },\r\n                    {\r\n                        id:2,\r\n                        displayName: \"My App 2\"\r\n                    },\r\n                    {\r\n                        id:3,\r\n                        displayName: \"My App 3\"\r\n                    }\r\n                ]\r\n            };\r\n        }\r\n\r\n        if(type == \"process\"){\r\n            var result = {\r\n                items: [\r\n                    {\r\n                        id:4,\r\n                        displayName: \"My Category 1\",\r\n                        process: false\r\n                    },\r\n                    {\r\n                        id:5,\r\n                        displayName: \"My Process 1\",\r\n                        process: true\r\n                    },\r\n                    {\r\n                        id:6,\r\n                        displayName: \"My Category 2\",\r\n                        process: false\r\n                    }\r\n                ]\r\n            };\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * Render data within canvas\r\n     * @param data\r\n     * @param canvas\r\n     */\r\n    renderData: function(data, canvas){\r\n        var self = this;\r\n        $(canvas).empty();\r\n        if(data.items[0].process===undefined){\r\n            canvas.append('<a class=\"linkApplication\" data-idcategory=\"0\" data-typeitem=\"process\"><i class=\"biz-ico biz-wp-tree-icon biz-wp-tree-image-process\"></i>All process </a>');\r\n        }\r\n        $.each(data.items, function(key,value){\r\n            canvas.append('<a class=\"linkApplication\" data-idCategory=\"'+value.id+'\"><i  name=\"app\" class=\"biz-wp-tree-icon biz-wp-tree-expand-icon\"></i><i class=\"biz-ico biz-wp-tree-icon\"></i>'+value.displayName+'</a>');\r\n            var itemElement =   $('[data-idCategory='+value.id+']',canvas);\r\n            if(value.process){\r\n                var iconProcess =   itemElement.find('i').last();\r\n                iconProcess.addClass('biz-wp-tree-image-process');\r\n                itemElement.find('i').first().remove();\r\n                itemElement.css('margin-left','25px');\r\n                itemElement.attr('data-typeItem','process');\r\n           }\r\n           else{\r\n               // item category\r\n               if(value.process==false){\r\n                   var iconCategory =   itemElement.find('i').last();\r\n                   iconCategory.addClass('biz-wp-tree-image-category');\r\n                   itemElement.attr('data-typeItem','category');\r\n               }\r\n               else{\r\n                   //item application\r\n                   var iconApp =   itemElement.find('i').last();\r\n                   iconApp.addClass('biz-wp-tree-image-application');\r\n                   itemElement.attr('data-typeItem','app');\r\n               }\r\n               var idParent   = ($(canvas).attr('class')!=\"ui-selectmenu-wrapper\") ? $(canvas).attr('id').replace('category_','') : \"\";\r\n               var idContCategory   = (idParent!=\"\") ? \"category_\"+idParent+\"-\"+value.id : \"category_\"+value.id;\r\n               canvas.append(\"<div class='ui-bizagi-contCategory' id='\"+idContCategory+\"'></div>\");\r\n           }\r\n        });\r\n        self.setupLinks(canvas);\r\n    },\r\n\r\n    setupLinks: function(canvas){\r\n        var self = this;\r\n        $(\".linkApplication\", canvas).on(\"click\", function(){\r\n            var idCategory      = $(this).attr(\"data-idCategory\");\r\n            var idParent   = ($(canvas).attr('class')!=\"ui-selectmenu-wrapper\") ? $(canvas).attr('id').replace('category_','') : \"\";\r\n            var elementRender   = (idParent!=\"\") ? $(\"#category_\"+idParent+\"-\"+idCategory) : $(\"#category_\"+idCategory);\r\n            if($(this).attr('data-typeItem')=='process'){\r\n                var processSelect   =   $(this).text();\r\n                var wrapper  =   self.getWrapper();\r\n                wrapper.element.hide();\r\n                wrapper.element.css(\"visibility\",\"hidden\");\r\n                var parentType  = '';\r\n                var item        = this;\r\n                var routeProcess= [];\r\n                if($(this).attr(\"data-idcategory\")>0){\r\n                    while (parentType != \"app\" ||parentType == null) {\r\n                        item = $(item).closest('div').prev();\r\n                        parentType = item[0].getAttribute(\"data-typeItem\");\r\n                        routeProcess.push(item.text());\r\n                    }\r\n                }\r\n                wrapper.element.empty();\r\n                routeProcess = routeProcess.reverse().join(\" > \");\r\n                routeProcess = (routeProcess==\"\")?processSelect: routeProcess+=  ' > '+processSelect;\r\n\r\n                $('.ui-bizagi-container-query-process :input[type=text]').val(routeProcess);\r\n            }\r\n            else{\r\n                var iconProcess =    $(this).find('i').first();\r\n                if(elementRender.css(\"visibility\") === \"visible\"){\r\n                    iconProcess.addClass('biz-wp-tree-expand-icon');\r\n                    iconProcess.removeClass('biz-wp-tree-collapse-icon');\r\n                    elementRender.hide();\r\n                    elementRender.css(\"visibility\",\"hidden\");\r\n                    elementRender.empty();\r\n                }\r\n                else{\r\n                    var data        = self.loadData(\"process\");\r\n                    iconProcess.removeClass('biz-wp-tree-expand-icon');\r\n                    iconProcess.addClass('biz-wp-tree-collapse-icon');\r\n                    elementRender.show();\r\n                    elementRender.css(\"visibility\",\"visible\");\r\n                    self.renderData(data, elementRender);\r\n                }\r\n            }\r\n        });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Query Search User\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will define basic stuff for query search user renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.querySearchUser\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"render-querySearchUser\");\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getUserData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || false;\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n        //GET DATA\r\n        var data = [{\"id\":1,\"value\":\"user1\"},{\"id\":2,\"value\":\"user2\"},{\"id\":3,\"value\":\"user3\"},{\"id\":4,\"value\":\"user4\"},{\"id\":5,\"value\":\"user5\"},{\"id\":6,\"value\":\"user6\"},{\"id\":7,\"value\":\"user7\"},{\"id\":8,\"value\":\"user8\"},{\"id\":9,\"value\":\"user9\"},{\"id\":10,\"value\":\"user10\"}];\r\n        properties.data = data;\r\n        defer.resolve(properties.data);\r\n        return defer.promise(defer);\r\n\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var displayValue = self.getDisplayValue();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        var decodedDisplayValue = bizagi.util.decodeURI(displayValue);\r\n        if (self.properties.editable == false) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n\r\n                control.html(valueToDisplay);\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     */\r\n    setValue: function (value) {\r\n        /*ISUPP-4116/*\r\n         /*var decodedValue = bizagi.util.decodeURI(value);*/\r\n        var self = this;\r\n        self._super(value);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Query Search User\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will define desktop stuff for query search user renders\r\n *   Modified by: Andrés F. Muñoz\r\n *   Comments:\r\n *   - This control Implemments the search users plugin\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.querySearchUser\", bizagi.rendering.querySearchUser.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.querySearchUser.extend(\"bizagi.rendering.desktop.querySearchUser\", {}, {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        // Call base\r\n        self.input = $(\".ui-bizagi-render-text\", self.getControl());\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        if (typeof value === \"object\"){\r\n            if(typeof value[0] === \"object\" && value[0].label !== undefined){\r\n                value = value[0].label;\r\n            }\r\n            else{\r\n                value = value.label;\r\n            }\r\n        }\r\n        else{\r\n            value = '';\r\n        }\r\n\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && properties.editable) {\r\n            self.input.val(value);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.bindSearchUserPlugin(control);\r\n    },\r\n\r\n    /*\r\n     * Binds the search user plugin\r\n     */\r\n    bindSearchUserPlugin: function (control) {\r\n        var self = this;\r\n        var options = {\r\n            title: self.getResource(\"render-plugin-search-users-title\"),\r\n            filters:[\"domain\", \"userName\",\"fullName\"],\r\n            displayNames:[\r\n                self.getResource(\"render-plugin-search-users-domain\"),\r\n                self.getResource(\"render-plugin-search-users-user-name\"),\r\n                self.getResource(\"render-plugin-search-users-full-name\")],\r\n            searchButtonName: self.getResource(\"render-plugin-search-users-search-button-name\"),\r\n            clearButtonName: self.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n            valuesToSelect: [\"iduser\",\"username\"],//\"iduser\",\"username\",\"user\",\"domain\",\"email\"\r\n            selectItem: function(){\r\n                var deferred = $.Deferred();\r\n                deferred.done(function (data) {\r\n                    self.onItemSelectedSuccess(data);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n                return deferred;\r\n            },\r\n            searchUsers: function(filterData){\r\n                return self.dataService.getUsersList(filterData);\r\n            },\r\n            getTableTemplate: function(usersResults,currentPage,pagination,pagesArray){\r\n                var content = self.renderFactory.getTemplate(\"bizagi.plugin.search.user\");\r\n                var usersTableTmpl = $.tmpl(content, { users: usersResults, links: [self.getResource(\"render-plugin-search-users-select-link\")], page: currentPage, pagination: pagination, pagesArray: pagesArray });\r\n                return usersTableTmpl;\r\n            },\r\n            showError: function(error){\r\n                bizagi.log(error);\r\n            },\r\n            showMessageBox: function(message){\r\n                bizagi.showMessageBox(bizagi.localization.getResource(message), \"Bizagi\", \"warning\");\r\n            }\r\n        };\r\n\r\n        opt = options;\r\n\r\n        $('#btn-get-user',control).bizagiSearchUser(options);\r\n    },\r\n    /*\r\n    * returns the opt var for unit testing\r\n    * */\r\n    getOptions: function(){\r\n        return opt;\r\n    },\r\n\r\n    onItemSelectedSuccess: function(itemSelected){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        $(\".ui-bizagi-render-text\",control).val(itemSelected.username);\r\n        var item = {};\r\n        item.id = itemSelected.iduser;\r\n        item.label = itemSelected.username;\r\n        item.value = itemSelected.username;\r\n        self.setValue(item);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Device Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropriate factory on demand\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.device.factory\", {}, {\r\n\r\n    /**\r\n     * Constructor, detects the device\r\n     * @param params\r\n     */\r\n    init: function (params) {\r\n        this.execution_device = bizagi.util.detectDevice();\r\n        this.cachedFactory = {};\r\n    },\r\n\r\n    /**\r\n     * Returns the appropriate render factory based on the device detection\r\n     * Because it loads the scripts on demand it must return a promise\r\n     * @param dataService\r\n     * @param device\r\n     * @returns {*}\r\n     */\r\n    getRenderFactory: function (dataService, device) {\r\n        var self = this;\r\n        device = device || \"desktop\";\r\n        var defer = new $.Deferred();\r\n\r\n        if (typeof self.cachedFactory[device] !== \"undefined\") {\r\n            // Reset print version value\r\n            self.cachedFactory[device].printVersion = false;\r\n            // Resolve with cached factory                \r\n            defer.resolve(self.cachedFactory[device]);\r\n        } else {\r\n            // If factory is not cached then build it\r\n            if (device === \"print\") {\r\n\r\n                // Load print version references\r\n                self.cachedFactory[device] = new bizagi.rendering.print.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (device === \"desktop\") {\r\n\r\n                // Load desktop references\r\n                self.cachedFactory[device] = new bizagi.rendering.desktop.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (bizagi.util.isTabletDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.tablet.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else if (bizagi.util.isSmartphoneDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.smartphone.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else {\r\n                // if no device suuported\r\n                bizagi.showMessageBox(\"Not supported device: \" + device);\r\n                defer.reject(\"Not supported device: \" + device);\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Returns the current data service being used\r\n     * @returns {*}\r\n     */\r\n    getDataService: function () {\r\n        return this.dataService;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will process a rendering page by calling an ajax service to retrieve the model,\r\n *       and then process it to create base layout, and then call the device render factory\r\n */\r\n\r\n// Define BizAgi Rendering namespace\r\nbizagi.rendering = bizagi.rendering || {};\r\n\r\n/*\r\n *   This class will define a method to process the page\r\n *   1. Fetch the data\r\n *   2. Call the device factory to appropriately render the content\r\n */\r\n$.Class.extend(\"bizagi.rendering.facade\", {\r\n    form: undefined,\r\n    executionDeferred: new $.Deferred()\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        params = params || {};\r\n\r\n        // Set observable element\r\n        this.observableElement = $({});\r\n\r\n        // Injection of Device, only for print version purpose\r\n        var device = params.device || \"\";\r\n\r\n        // Defines a device factory for all rendering\r\n        this.deviceFactory = new bizagi.rendering.device.factory();\r\n\r\n        // Creates a data service instance\r\n        this.dataService = new bizagi.render.services.service(params);\r\n\r\n        // Retrieves the render factory\r\n        this.renderFactory = this.deviceFactory.getRenderFactory(this.dataService, device);\r\n    },\r\n    getFactory: function () {\r\n        var self = this;\r\n        return {\r\n            deviceFactory: self.deviceFactory,\r\n            dataService: self.dataService,\r\n            renderFactory: self.renderFactory\r\n        };\r\n    },\r\n    /*\r\n    *   Subscribe method\r\n    */\r\n    subscribe: function () {\r\n        this.observableElement.bind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Unsubscribe method\r\n    */\r\n    unsubscribe: function () {\r\n        this.observableElement.unbind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Publish method\r\n    */\r\n    publish: function () {\r\n        return this.observableElement.triggerHandler.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   This method will re-execute the process\r\n    */\r\n    update: function (params) {\r\n        var self = this;\r\n\r\n        // Update rendering mode\r\n        if (params.mode)\r\n            self.mode = params.mode;\r\n\r\n        // Enable form buttons on desktop view\r\n        return self.execute($.extend({\r\n            canvas: self.canvas,\r\n            mode: self.mode\r\n        }, params));\r\n    },\r\n    /*\r\n    *   Start point method to use in the main javascript pages\r\n    *   This method will process everything and attach the html directly to the dom\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n        var doc = this.ownerDocument;\r\n        var body = $(\"body\", doc);\r\n        params = params || {};\r\n\r\n        // Creates ready deferred\r\n        if (self.executionDeferred && self.executionDeferred.state) {\r\n            if (self.executionDeferred.state() == \"resolved\") {\r\n                self.executionDeferred = $.Deferred();\r\n            }\r\n        } else {\r\n            self.executionDeferred = $.Deferred();\r\n        }\r\n\r\n        // Performance measurement stuff\r\n        bizagi.chrono.initAndStart(\"rendering+data\", true);\r\n        bizagi.rendering.render.startOptimization();\r\n\r\n        // Override mode\r\n        if (typeof (params.mode) === \"undefined\") {\r\n            if (!bizagi.util.isEmpty(window.location.search)) {\r\n                var queryString = bizagi.util.getQueryString();\r\n                params.mode = queryString[\"mode\"];\r\n            }\r\n        }\r\n\r\n        // If the canvas is not given, we need to create one\r\n        var canvas = self.canvas = params.canvas = params.canvas || $(\"<div />\").appendTo(body);\r\n        self.mode = params.mode;\r\n\r\n        self.process(params).done(function (form) {\r\n\r\n            // Clear canvas    \r\n            if (!params.refreshing) {\r\n                canvas.empty();\r\n            }\r\n\r\n            // Append content\r\n            canvas.append(form.container);\r\n\r\n            // Include process path\r\n            $(form.pathProcess).insertBefore(form.container);\r\n\r\n            // Keep reference in class\r\n            self.form = form;\r\n            self.form.setSize({width: self.lastWidth, height: self.lastHeight});\r\n\r\n            // Save window size variables\r\n            setTimeout(function () {\r\n                self.lastWidth = $(window).width();\r\n                self.lastHeight = $(window).height();\r\n                if (window.self !== window.top)\r\n                    self.resizeInPopUpHTML();\r\n            }, 2000);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Notify to module users that the form has been rendered\r\n            self.publish(\"rendering-formRendered\", {});\r\n\r\n            // Configure handlers\r\n            self.configureRefresh(form, canvas);\r\n            self.configureRouting(form, canvas);\r\n            self.configureRenderError(form, canvas);\r\n            self.configureResize(form);\r\n            self.configureGlobalHandlers(form);\r\n\r\n            // Check if it is a summary form\r\n            if (params.summaryForm) {\r\n                form.container.addClass(\"ui-bizagi-summary-form\");\r\n            }\r\n\r\n            // Ends main timer and log everything\r\n            bizagi.chrono.stopAndLog(\"rendering\");\r\n            bizagi.chrono.stopAndLog(\"rendering+data\");\r\n            bizagi.chrono.stopAndLog(\"submitForm\");\r\n            bizagi.chrono.stopAndLog(\"submitForm-ajax\");\r\n            bizagi.chrono.stopAndLog(\"waiting\");\r\n\r\n            // Resolves deferred\r\n            bizagi.rendering.render.stopOptimization();\r\n\r\n            // Expose public reference of form\r\n            if (bizagi.override.enableE2EInterface) {\r\n                self.Class.form = self.form;\r\n                self.Class.executionDeferred.resolve(self.form);\r\n            }\r\n\r\n            self.executionDeferred.resolve(self.form);\r\n\r\n        }).fail(function (message, errorType) {\r\n\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n\r\n                    if (typeof message === \"undefined\" || message === \"\") {\r\n                        message = bizagi.localization.getResource(\"render-error-unknown\");\r\n                    }\r\n\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    self.publish(\"rendering-formRenderedError\", message);\r\n                    self.canvas.triggerHandler(\"errorform\", message);\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n\r\n                    self.executionDeferred.reject();\r\n                });\r\n        });\r\n\r\n        return self.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the execution deferred to determine if the component is ready or not\r\n    */\r\n    ready: function () {\r\n        return this.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Loads data and render factory in order to process the form\r\n    *   Returns a deferred to set callbacks when the process is done\r\n    */\r\n    process: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Call get form data service\r\n        var dataPromise = self.dataService.getFormData(params);\r\n\r\n        var canvas = self.canvas || params.canvas;\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n        // Set callback when requests have been done\r\n        $.when(dataPromise, self.renderFactory)\r\n            .done(function (data, renderFactory) {\r\n                bizagi.showErrorAlertDialog = true;\r\n\r\n                // When there is no data trigger an event\r\n                if (bizagi.util.isEmpty(data)) {\r\n                    self.publish(\"no-data-found\");\r\n                    defer.fail();\r\n                    return;\r\n                }\r\n\r\n                if (data && data.type == \"reload\") {\r\n                    var form = self.form;\r\n                    if (form) {\r\n                        form.endLoading();\r\n                        form.dispose();\r\n                    }\r\n                    // Trigger handler on canvas\r\n                    canvas.triggerHandler(\"routing\");\r\n\r\n                } else if (data && data.type == \"suspended\") {\r\n                    var errorTemplate = renderFactory.getTemplate(\"info-message\");\r\n                    var message = bizagi.localization.getResource(\"render-case-suspended\");\r\n                    var errorHtml = $.tmpl(errorTemplate, {\r\n                        message: message\r\n                    });\r\n                    // Remove loading icon from summary container\r\n                    errorHtml.appendTo(canvas);\r\n\r\n                    defer.fail();\r\n\r\n                } else if (data && data.type != \"error\") {\r\n                    if (params.hasOwnProperty('printversion')) {\r\n                        data = self.transformGridControl(data);\r\n                        data.form.properties.editable = \"False\";\r\n                    }\r\n\r\n                    bizagi.chrono.initAndStart(\"rendering\");\r\n                    params.type = (data.form && data.form.properties.type) || params.type;\r\n                    var form = self.processForm(data.form, renderFactory, params);\r\n\r\n                    // Resolve deferred\r\n                    defer.resolve(form);\r\n\r\n                } else {\r\n                    self.getFailDeferred(data, defer);\r\n                }\r\n            }).fail(function (errorMessage) {\r\n            self.getFailDeferred(errorMessage, defer);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /**\r\n     * In the print version widget when grid control was rendered, the main render has broken\r\n     * Is necesary change id of grid control to fixed these  problems\r\n     */\r\n    transformGridControl: function (data) {\r\n        var self = this;\r\n        if (data == null) {\r\n            return data;\r\n        }\r\n\r\n        if (data.hasOwnProperty('type') && data.type == 'grid') {\r\n            data.id = data.id + \"-print\";\r\n            data.allowAdd = \"False\";\r\n            data.allowDelete = \"False\";\r\n            data.allowEdit = \"False\";\r\n            data.allowGrouping = \"False\";\r\n            data.allowMore = \"False\";\r\n            data.allowSearch = \"False\";\r\n        } else {\r\n            $.each(data, function (key, value) {\r\n                if (typeof (value) == 'object') {\r\n                    data[key] = self.transformGridControl(data[key]);\r\n                }\r\n            });\r\n        }\r\n        return data;\r\n    },\r\n    /**\r\n     * Resolve deferred\r\n     */\r\n    getFailDeferred: function (errorMessage, defer) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var jsonErrorMessage = {};\r\n        try {\r\n            jsonErrorMessage = JSON.parse(errorMessage.responseText);\r\n        } catch (e) {\r\n            jsonErrorMessage = {message: errorMessage.responseText, errorType: \"ERRORUNKNOWN\"};\r\n        }\r\n\r\n\r\n        if (jsonErrorMessage.message) {\r\n            message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n            message += \"<br>Error Message: \" + jsonErrorMessage.message;\r\n        } else {\r\n            if (jsonErrorMessage.errorType == \"JSharpNotSupportedException\") {\r\n                message += \"<br>Error Message: \" + bizagi.localization.getResource(\"jsharp-required\");\r\n            }\r\n        }\r\n\r\n        // Error in metadata InvalidFormMetadata\r\n        if (jsonErrorMessage.errorType == 'ERRORUNKNOWN') {\r\n            defer.reject(message, jsonErrorMessage.errorType);\r\n        } else {\r\n\r\n            defer.reject(message);\r\n        }\r\n    },\r\n    /*\r\n    *   Process the form\r\n    */\r\n    processForm: function (data, renderFactory, params) {\r\n        var form = renderFactory.getContainer($.extend(params, {\r\n            type: params.type || \"form\",\r\n            data: data\r\n        }));\r\n\r\n        //Orientation RTL - OrderButtons\r\n        if (typeof BIZAGI_ORIENTATION != \"undefined\") {\r\n            if ((form.properties.orientation == \"rtl\" || BIZAGI_ORIENTATION == 'rtl') && form.buttons.length > 0) {\r\n                var buttonsForm = form.buttons[0];\r\n\r\n                form.buttons.splice(0, 1);\r\n                form.buttons.push(buttonsForm);\r\n            }\r\n        }\r\n\r\n        // Render the full form\r\n        form.render();\r\n\r\n        return form;\r\n    },\r\n    /*\r\n    *   Performs a resize\r\n    */\r\n    resize: function (args) {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.trigger(\"renderresize\", args);\r\n        }\r\n    },\r\n    /*\r\n    *   Binds a refresh handler to detect when the whole form needs to fetch all data from server\r\n    */\r\n    configureRefresh: function (form, canvas) {\r\n        var self = this;\r\n\r\n        // Attach a refresh handler to recreate all the form\r\n        form.bind(\"refresh\", function (_, refreshParams) {\r\n\r\n            // Find the scroll top\r\n            var parent = form.container.parent();\r\n            parent = bizagi.util.scrollTop(parent);\r\n            var scrollTop = parent.scrollTop();\r\n\r\n            $(self.form).trigger(\"onRefreshStarted\");\r\n\r\n            //Dispose current form\r\n            form.dispose(refreshParams);\r\n            canvas.fastEmpty();\r\n            var canvasParent = canvas.parent();\r\n            if (canvasParent.find(\".ui-bizagi-button-container\").length > 0) {\r\n                canvasParent.find(\".ui-bizagi-button-container\").remove();\r\n            }\r\n\r\n            if (self.executionDeferred && self.executionDeferred.state) {\r\n                if (self.executionDeferred.state() == \"resolved\") {\r\n                    self.executionDeferred = $.Deferred();\r\n                }\r\n            }\r\n\r\n            var formParams = self.form.getParams();\r\n            // Re-execute process\r\n            $.when(self.execute($.extend(refreshParams, {\r\n                canvas: canvas,\r\n                refreshing: true,\r\n                idCase: formParams.idCase,\r\n                displayName: formParams.displayName\r\n            }))).done(function () {\r\n\r\n                // Restore scroll at same position\r\n                setTimeout(function () {\r\n                    parent.scrollTop(scrollTop);\r\n                    $(self.form).trigger(\"onRefreshFinished\");\r\n                }, 100);\r\n            });\r\n\r\n            return self.executionDeferred.promise();\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a resize hanlder to configure the resize behaviour\r\n    */\r\n    configureResize: function (form) {\r\n        var self = this;\r\n\r\n        // Attach resize handler\r\n        form.bind(\"renderresize\", function (_, args) {\r\n            args = args || {};\r\n            // Just allow one resize at a time\r\n            if (self.resizeTimeout)\r\n                return;\r\n            var resizeFn = function () {\r\n                // Call resize event in form\r\n                var width = $(window).width();\r\n                var height = $(window).height();\r\n                if (args.forceResize || width != self.lastWidth) {\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.initAndStart(\"resize\");\r\n\r\n                    // Perform resize\r\n                    form.resize({\r\n                        width: width,\r\n                        height: height\r\n                    });\r\n                    self.lastWidth = width;\r\n                    self.lastHeight = height;\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.stopAndLog(\"resize\");\r\n                    bizagi.chrono.log(\"resize\");\r\n                }\r\n\r\n                self.resizeTimeout = null;\r\n            };\r\n            self.resizeTimeout = setTimeout(resizeFn, 0);\r\n\r\n        });\r\n        self.resize();\r\n    },\r\n    /*\r\n    *   Binds a routing handler to detect when the workportal need to enroute the case\r\n    */\r\n    configureRouting: function (form, canvas) {\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"routing\", function (context, triggerParams) {\r\n            //Dispose current form\r\n            form.dispose();\r\n\r\n            // Trigger handler on canvas\r\n            canvas.triggerHandler(\"routing\", triggerParams);\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a generic handler that will be replicated to facade instantiators\r\n    */\r\n    configureGlobalHandlers: function (form) {\r\n        var self = this;\r\n\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"globalHandler\", function (_, args) {\r\n            // Trigger handler on canvas\r\n            return self.publish(args.eventType, args.data);\r\n        });\r\n    },\r\n    /*\r\n    * Binds error form handler to detect when the render element nop posible get information or error in server\r\n    */\r\n    configureRenderError: function (form, canvas) {\r\n        var self = this;\r\n\r\n        form.bind(\"formRenderingError\", function (event, errorMessage) {\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n                    var message = \"<br>Error: \";\r\n\r\n                    errorMessage = errorMessage.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n\r\n                    var jsonErrorMessage = JSON.parse(errorMessage);\r\n                    if (jsonErrorMessage.message) {\r\n                        message += jsonErrorMessage.message;\r\n                        message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n                    }\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    //send the type error to differentiate between a form and an item for render\r\n                    self.canvas.triggerHandler(\"errorform\", \"renderItemError\");\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                });\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.dispose();\r\n        }\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    resizeInPopUpHTML: function () {\r\n        if ($(\".activitiFormContainer\").length > 0 && bizagi.util.getQueryString().type != \"cases\") {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var heightButtonContainer = buttonContainer.outerHeight() || 0;\r\n            var renderBehavior = bizagi.util.getQueryString().renderBehavior || \"\";\r\n            renderBehavior = renderBehavior.replace(\"#\", \"\");\r\n\r\n            if (renderBehavior == \"PopUp\") {\r\n                if (typeof (self.postMessageSocket) == \"undefined\") {\r\n                    var heightCanvas = $(\".activitiFormContainer\").height() - 50 || 396;\r\n                    $(\"#render-canvas\").height(heightCanvas);\r\n                    $(\"#render-canvas\").css(\"overflowY\", \"scroll\");\r\n                } else $(\".activitiFormContainer\").height($(\".activitiFormContainer\").height() + $(\".ui-bizagi-button-container\").height() + 30);\r\n                $(\".ui-bizagi-button-container\").css(\"position\", \"absolute\");\r\n                $(\".ui-bizagi-button-container\").appendTo(\".activitiFormContainer\");\r\n                if ($(\".ui-bizagi-button-container\").length > 1) {\r\n                    $(\".ui-bizagi-button-container:first\").hide();\r\n                    renderForm.css(\"marginTop\", \"-17px\");\r\n                }\r\n            }\r\n            if (buttonContainer.length > 0) {\r\n                //display buttons\r\n                renderForm.height(heightActivitiFormContainer - 97 - heightButtonContainer);\r\n            }\r\n            if ($(\".ui-bizagi-button-container\").children().length == 0)\r\n                $(\"#render-canvas\").height($(\"#render-canvas\").height() + heightButtonContainer);\r\n            else {\r\n                buttonContainer.width(\"100%\");\r\n                buttonContainer.css(\"marginLeft\", 0);\r\n                buttonContainer.css(\"bottom\", 0);\r\n            }\r\n        } else if (bizagi.util.getQueryString().type == \"render\") {\r\n            $(\"html\").css(\"overflowX\", \"hidden\");\r\n            ($(\"#render\").height() <= window.innerHeight + 5) ? $(\"html\").css(\"overflowY\", \"hidden\")\r\n                : $(\"html\").css(\"overflowY\", \"scroll\");\r\n            $(\".ui-widget-overlay\").height(650);\r\n        }\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Workportal Security Command\r\n*   Author: David Andres Niño\r\n*   Comments:\r\n*   -   This script will define a common class to print forms, and edit mode forms\r\n*/\r\n\r\n\r\n$.Class(\"bizagi.workportal.command.printform\", {}, {\r\n\r\n    init: function (renderFactory) {\r\n        var self = this;\r\n\r\n        self.renderFactory = renderFactory;\r\n    },\r\n\r\n    print: function (properties) {\r\n\r\n        var self = this;\r\n\r\n        var printParams = $.extend({}, properties);\r\n\r\n        $(document).triggerHandler(\"showDialogWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT,\r\n            modalParameters: {\r\n                title: bizagi.localization.getResource(\"render-actions-print\"),\r\n                refreshInbox: false\r\n            },\r\n            params: printParams,\r\n            referrer: (bizagi.hasOwnProperty('referrerParams') && bizagi.referrerParams.hasOwnProperty('referrer')) ? bizagi.referrerParams.referrer : \"inboxGrid\",\r\n            buttons: [\r\n                {\r\n                    text: bizagi.localization.getResource(\"workportal-widget-dialog-box-print\"),\r\n                    click: function () {\r\n                        var selfButton = $(this);\r\n\r\n                        var frameTemplate = self.renderFactory.getTemplate(\"print-frame\");\r\n                        var headerTemplate = self.renderFactory.getTemplate(\"print-frame-header\");\r\n\r\n                        var executePrintWidgetAction = function() {\r\n\r\n                            /**/\r\n                            // Create a random name for the print frame.\r\n                            var strFrameName = (\"printer-\" + (new Date()).getTime());\r\n\r\n                            var jFrame = $.tmpl(frameTemplate, { printID: strFrameName });\r\n                            var jFrameHeader = $.tmpl(headerTemplate, { environment: bizagi.loader.environment, productBuild: bizagi.loader.productBuildToAbout, build: bizagi.loader.build });\r\n\r\n\r\n                            jFrame.appendTo($(\"body:first\"));\r\n\r\n                            // Get a FRAMES reference to the new frame.\r\n                            var objFrame;\r\n\r\n                            if (bizagi.util.isIE()) {\r\n                                objFrame = window.frames[strFrameName];\r\n                                if(!objFrame) {\r\n                                    var i = 0;\r\n                                    var length = window.frames.length;\r\n                                    for(; i < length; i++) {\r\n                                        if(window.frames[i] && window.frames[i].name == strFrameName) {\r\n                                            objFrame = window.frames[i];\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                objFrame = window.frames[strFrameName];\r\n                            }\r\n\r\n                            // Get a reference to the DOM in the new frame.\r\n                            var objDoc = objFrame.document || objFrame.contentWindow.document;\r\n\r\n                            // Write the HTML for the document. In this, we will\r\n                            // write out the HTML of the current element.\r\n                            objDoc.open();\r\n                            var objDocStr = \"<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\">\";\r\n\r\n                            objDocStr += \"<html style='overflow: visible !important'> <head> <title> </title>\";\r\n\r\n                            objDocStr += jFrameHeader[0].innerHTML;\r\n\r\n                            objDocStr += \"</head> <body class='bz-wp-widget-print bz-wp-widget-print-load' style='overflow: visible !important'>\";\r\n\r\n                            objDocStr += $(\".bz-wp-widget-print\").html();\r\n\r\n                            objDocStr += \"</body></html>\";\r\n\r\n\r\n                            objDoc.write(objDocStr);\r\n\r\n                            objDoc.close();\r\n                            $(\".ui-bizagi-cell-readonly\", objDoc).css(\"maxHeight\", \"100%\");\r\n                            if (bizagi.util.isIE()) {\r\n                                var win = window.open(\"\", \"\", \"top=0,left=0,width=10,height=10\");\r\n\r\n                                var styleLoading = '';\r\n                                styleLoading += '<style>';\r\n                                styleLoading += 'html{background: #293f55; color: #fff; text-align: center;}';\r\n                                styleLoading += '</style>';\r\n\r\n                                var textStyle = 'padding:10px auto; width:100%; text-align:center; font-family:Arial; font-size:12px;';\r\n\r\n                                win.document.open();\r\n                                win.document.write(styleLoading + '<div id=\"loading-emp\" style=\"' + textStyle + '\">' + bizagi.localization.getResource(\"webpart-render-loading\") + '</div>');\r\n                                win.document.close();\r\n\r\n                                win.document.open();\r\n                                win.document.write(objDocStr);\r\n                                win.document.close();\r\n\r\n                                win.print();\r\n                                setTimeout(function() {\r\n                                    win.close();\r\n                                }, 10000);\r\n                            }\r\n                            else {\r\n                                objFrame.focus();\r\n                                setTimeout(function() {\r\n                                    objFrame.print();\r\n                                }, 500);\r\n                            }\r\n\r\n                            // Have the frame remove itself in about a minute so that\r\n                            // we don't build up too many of these frames.\r\n                            setTimeout(function() {\r\n                                jFrame.remove();\r\n                            }, 1000);\r\n\r\n                            selfButton.removeAttr('disabled');\r\n                        };\r\n\r\n                        selfButton.attr('disabled', 'disabled');\r\n\r\n\r\n                        if ($('#bz-wp-widget-print').length === 0) {\r\n                            setTimeout(function () {\r\n                                executePrintWidgetAction();\r\n                            }, 1000);\r\n                        } else {\r\n                            executePrintWidgetAction();\r\n                        }\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    }\r\n});","/**\r\n * This file contains all keys that can be change the default functionality\r\n * of Bizagi, please use it carefully.\r\n *\r\n * @author Edward J Morales\r\n */\r\n\r\n\r\n/**\r\n * Enable deprecated features from form editor\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableDeprecatedProperties = true;\r\n\r\n/**\r\n * Enable custom interceptor\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.jqxhrList.intercept = true;","/**\r\n * Expose interface to access to render controls and their properties\r\n *\r\n * @author: Edward Morales\r\n */\r\n\r\n\r\n/**\r\n * Locators\r\n *\r\n * bizagi.e2e.getRenderById(id)\r\n * bizagi.e2e.getRenderByType(type)\r\n * bizagi.e2e.getRenderByXpath(xpath)\r\n * bizagi.e2e.getRenderByDisplayName(displayName)\r\n * bizagi.e2e.getRenderByValue(value)\r\n * bizagi.e2e.getNotificationPanel()\r\n * bizagi.e2e.getFormButtonByCaption(caption)\r\n * bizagi.e2e.getFormButtons()\r\n */\r\n\r\n/**\r\n * Standar interface for each control\r\n * -----------------------------------\r\n * locator.isRequired()\r\n * locator.getControl()\r\n * locator.getDisplayNameObj()\r\n * locator.getDisplayNameText()\r\n * locator.getValue()\r\n * locator.getDisplayValueText()\r\n * locator.getFocus()\r\n * locator.find(element)\r\n * locator.getType()\r\n * locator.setControlValue(value)\r\n * locator.setControlDisplayValue(value)\r\n *\r\n *\r\n * Interface for Grid\r\n * -----------------------------------\r\n * locator.getColumnByXpath(xpath)\r\n * locator.getColumnByName(name)\r\n * locator.getRecord(id)\r\n * locator.getNewRows()\r\n * locator.getCell(id, xpath)\r\n * locator.getGridButtonsPanel()\r\n * locator.getGridPaginationPanel()\r\n * locator.getGridHeaderPanel()\r\n *\r\n *\r\n * Interface for Upload and ColumnUpload\r\n * -----------------------------------\r\n * locator.getFiles()\r\n * locator.hasFile()\r\n *\r\n *\r\n * Interface for Boolean and ColumnBoolean\r\n * -----------------------------------\r\n * locator.checkByName(name)\r\n * locator.isChecked(name)\r\n *\r\n *\r\n * Interface for Combo and ColumnCombo\r\n * -----------------------------------\r\n * locator.getComboArrow()\r\n * locator.getComboOptions()\r\n *\r\n */\r\n\r\n\r\n/**\r\n *  Class that allow extend default functionality by kind of control\r\n */\r\nvar renderInterface = (function () {\r\n    var self = this;\r\n\r\n    /**\r\n     * Public interface for each render control\r\n     * This method is merged with control and has\r\n     * access to all properties of them\r\n     */\r\n    var controlInterface = (function () {\r\n        return {\r\n            isRequired: function () {\r\n                var self = this;\r\n                return self.properties.required;\r\n            },\r\n            getControl: function () {\r\n                var self = this;\r\n                return self.control;\r\n            },\r\n            getDisplayNameObj: function () {\r\n                var self = this;\r\n                return self.getLabel();\r\n            },\r\n            getDisplayNameText: function () {\r\n                var self = this;\r\n                return self.properties.displayName;\r\n            },\r\n            getValue: function () {\r\n                var self = this;\r\n                return self.value;\r\n            },\r\n            getDisplayValueText: function () {\r\n                var self = this;\r\n                return self.getDisplayValue();\r\n            },\r\n            getFocus: function () {\r\n                var self = this;\r\n                return (self.focus()) ? true : false;\r\n            },\r\n            find: function (elm) {\r\n                var self = this;\r\n                var control = self.getControl();\r\n                return control.find(elm);\r\n            },\r\n            getType: function () {\r\n                var self = this;\r\n                return self.properties.type;\r\n            },\r\n            setControlValue: function (value) {\r\n                var self = this;\r\n                self.setValue(value);\r\n            },\r\n            setControlDisplayValue: function (value) {\r\n                var self = this;\r\n                self.setDisplayValue(value);\r\n            }\r\n        };\r\n    })();\r\n\r\n    /**\r\n     * Public interface for grid control\r\n     */\r\n    var gridControlInterface = (function () {\r\n        return {\r\n            getColumnByXpath: function (xpath) {\r\n                var self = this;\r\n                return (typeof xpath === \"undefined\") ? {} : this.getColumn(xpath);\r\n            },\r\n            getColumnByName: function (name) {\r\n                var self = this;\r\n                var resultColumn = {};\r\n                $.each(self.columns, function (key, column) {\r\n                    if (column.properties.displayName === name) {\r\n                        resultColumn = column;\r\n                    }\r\n                });\r\n\r\n                return resultColumn;\r\n            },\r\n            getRecord: function (id) {\r\n                var self = this;\r\n                return $('[data-business-key=\"' + id + '\"]', self.getControl());\r\n            },\r\n            getNewRows: function () {\r\n                var self = this;\r\n                return $('[data-new-row=\"' + true + '\"]', self.getControl());\r\n            },\r\n            getCell: function (id, xpath) {\r\n                var self = this;\r\n                var control = self.getControlCell(id, xpath);\r\n\r\n                // Extend control with public interfacecontrol\r\n                control = renderInterface.extendControlInterface(control);\r\n                return control;\r\n            },\r\n            getGridButtonsPanel: function () {\r\n                var self = this;\r\n                return $('[data-bizagi-component=\"buttons\"]', self.getControl());\r\n            },\r\n            getGridPaginationPanel: function () {\r\n                var self = this;\r\n                return $('[data-bizagi-component=\"pager\"]', self.getControl());\r\n            },\r\n            getGridHeaderPanel: function () {\r\n                var self = this;\r\n                return $('[data-bizagi-component=\"columns\"]', self.getControl());\r\n            }\r\n        };\r\n    })();\r\n\r\n    var uploadInterface = (function () {\r\n        return {\r\n            getFiles: function () {\r\n                var self = this;\r\n                var listOfFiles = [];\r\n                if (self.files) {\r\n                    $.each(self.files, function (key, value) {\r\n                        listOfFiles.push(value[1]);\r\n                    });\r\n                }\r\n                return listOfFiles;\r\n            },\r\n            hasFile: function (fileName) {\r\n                var self = this;\r\n                var files = self.getFiles();\r\n                var result = false;\r\n                if (files.length > 0) {\r\n                    $.each(files, function (key, value) {\r\n                        if (value.indexOf(fileName) >= 0) {\r\n                            result = true;\r\n                        }\r\n                    });\r\n                }\r\n                return result;\r\n            }\r\n        };\r\n    })();\r\n\r\n    var booleanInterface = (function () {\r\n        return {\r\n            checkByName: function (name) {\r\n                var self = this;\r\n                var control = self.getControl();\r\n                var label = $(\".ui-bizagi-render-boolean-yesno label\", control);\r\n                $.each(label, function (key, value) {\r\n                    if (value && $.trim($(value).text()) == name) {\r\n                        value.click();\r\n                    }\r\n                });\r\n            },\r\n            isChecked: function (name) {\r\n                var self = this;\r\n                var control = self.getControl();\r\n                var label = $(\"label.ui-radio-state-checked\", control);\r\n                var checked = false;\r\n\r\n                if (label.length > 0) {\r\n                    $.each(label, function (key, value) {\r\n                        if (value && $.trim($(value).text()) == name) {\r\n                            checked = true;\r\n                        }\r\n                    });\r\n                }\r\n                return checked;\r\n            }\r\n        };\r\n    })();\r\n\r\n\r\n    var comboInterface = (function () {\r\n        return {\r\n            getComboArrow: function () {\r\n                var self = this;\r\n                return $(\".ui-selectmenu-btn\", self.getControl());\r\n            },\r\n\r\n            getComboOptions: function () {\r\n                var self = this;\r\n                return $(\".ui-select-dropdown ul\", self.getControl().parent());\r\n            }\r\n        }\r\n    })();\r\n\r\n\r\n    self._getInterface = function (control) {\r\n        var interfaz;\r\n        switch (control) {\r\n            case \"generic\":\r\n                interfaz = controlInterface;\r\n                break;\r\n            case \"grid\":\r\n                interfaz = gridControlInterface;\r\n                break;\r\n            case \"upload\":\r\n                interfaz = uploadInterface;\r\n                break;\r\n            case \"boolean\":\r\n                interfaz = booleanInterface;\r\n                break;\r\n            case \"combo\":\r\n                interfaz = comboInterface;\r\n                break;\r\n\r\n        }\r\n        return interfaz;\r\n    };\r\n\r\n    self._getExtendedInterfaceByControl = function (control) {\r\n        var type = (typeof control !== \"undefined\" && control.properties && control.properties.type) ? control.properties.type : \"\";\r\n        var extendedInterface;\r\n        var objEspecificInterface = [];\r\n\r\n        var extendObject = function (control, objToExtend) {\r\n            if (objToExtend.length > 0) {\r\n                $.each(objToExtend, function (keyToExtend, valueToExtend) {\r\n                    if (typeof valueToExtend === \"object\") {\r\n                        $.each(valueToExtend, function (key, value) {\r\n                            control[key] = value;\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n            return control;\r\n        };\r\n\r\n        switch (type) {\r\n            case \"grid\":\r\n                objEspecificInterface = [self._getInterface(\"generic\"), self._getInterface(\"grid\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n            case \"upload\":\r\n            case \"columnUpload\":\r\n                objEspecificInterface = [self._getInterface(\"generic\"), self._getInterface(\"upload\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n            case \"boolean\":\r\n            case \"columnBoolean\":\r\n                objEspecificInterface = [self._getInterface(\"generic\"), self._getInterface(\"boolean\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n            case \"combo\":\r\n            case \"columnCombo\":\r\n                objEspecificInterface = [self._getInterface(\"generic\"), self._getInterface(\"combo\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n            default:\r\n                objEspecificInterface = [self._getInterface(\"generic\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n        }\r\n\r\n        return extendedInterface;\r\n    };\r\n\r\n    self._extendControlInterface = function (control) {\r\n        var result;\r\n        if (!control) {\r\n            return;\r\n        }\r\n\r\n        if (control.length && control.length > 1) {\r\n            result = [];\r\n            $.each(control, function (key, value) {\r\n                result.push(self._getExtendedInterfaceByControl(value));\r\n            });\r\n        } else if (control.length && control.length == 1) {\r\n            result = self._getExtendedInterfaceByControl(control[0]);\r\n        } else {\r\n            result = self._getExtendedInterfaceByControl(control);\r\n        }\r\n\r\n        // Set auto focus\r\n        (typeof result.focus === \"function\") ? result.focus() : \"\";\r\n\r\n        return result;\r\n    };\r\n\r\n    // Public methods\r\n    return {\r\n        getInterface: self._getInterface,\r\n        extendControlInterface: self._extendControlInterface\r\n    };\r\n})();\r\n\r\n\r\n/**\r\n * Public access interface that provide locators and new functionalities\r\n */\r\nbizagi.e2e = (function () {\r\n    var self = this;\r\n    var dialogIsOpen = false;\r\n\r\n    var setScopeDefinition = function () {\r\n        if (!dialogIsOpen) {\r\n            self.form = bizagi.rendering.facade.form;\r\n            self.formReady = bizagi.rendering.facade.executionDeferred.promise();\r\n\r\n            if (!self.form) {\r\n                $.when(self.formReady).done(function (deferredForm) {\r\n                    self.form = deferredForm;\r\n                }).fail(function (m) {\r\n                    console.log(\"Error: \" + m.toString());\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    bizagi.rendering.dialog.form.extend(\"bizagi.rendering.dialog.form\", {}, {\r\n        renderDialogBox: function (dialogBox, params) {\r\n            $.when(this._super(dialogBox, params)).done(function (form) {\r\n                dialogIsOpen = true;\r\n                self.form = form;\r\n            });\r\n        },\r\n        closeDialogBox: function () {\r\n            dialogIsOpen = false;\r\n            this._super();\r\n        }\r\n    });\r\n\r\n    bizagi.rendering.searchForm.extend(\"bizagi.rendering.searchForm\", {}, {\r\n        configureHandlers: function (container) {\r\n            $.when(this._super(container)).done(function (form) {\r\n                dialogIsOpen = true;\r\n                self.form = form.getFormContainer();\r\n            });\r\n        },\r\n        closeDialogBox: function () {\r\n            dialogIsOpen = false;\r\n            this._super();\r\n        }\r\n    });\r\n\r\n    bizagi.rendering.dialog.search.extend(\"bizagi.rendering.dialog.search\", {}, {\r\n        closeDialogBox: function () {\r\n            dialogIsOpen = false;\r\n            this._super();\r\n        }\r\n    });\r\n\r\n\r\n    /**\r\n     * Get all controls within form\r\n     * @returns {{rendersById: (*|bizagi.rendering.form.rendersById), rendersByXpath: (*|bizagi.rendering.form.rendersByXpath), rendersByType: (*|bizagi.rendering.form.rendersByType)}}\r\n     * @private\r\n     */\r\n    self._getAllrenders = function () {\r\n        var result = {\r\n            rendersById: self.form.rendersById,\r\n            rendersByXpath: self.form.rendersByXpath,\r\n            rendersByType: self.form.rendersByType\r\n        };\r\n\r\n        return result;\r\n    };\r\n\r\n    self._findRenderByProperty = function (property, propertyvalue) {\r\n        var result = [];\r\n        var renders = self._getAllrenders() || {};\r\n\r\n        if (property) {\r\n            $.each(renders.rendersById, function (controlId, controlClass) {\r\n                if (controlClass.properties.hasOwnProperty(property)) {\r\n                    if (controlClass.properties[property] == propertyvalue) {\r\n                        result.push(controlClass);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Find controls by id\r\n     * @param id\r\n     * @returns {*}\r\n     */\r\n    self.getRenderById = function (id) {\r\n        setScopeDefinition();\r\n        id = id || \"\";\r\n        return renderInterface.extendControlInterface(self.form.getRenderById(id));\r\n    };\r\n\r\n    /**\r\n     * Find controls by type\r\n     * @param type\r\n     * @returns {*}\r\n     */\r\n    self.getRenderByType = function (type) {\r\n        setScopeDefinition();\r\n        type = type || \"\";\r\n        return renderInterface.extendControlInterface(self.form.getRenderByType(type));\r\n    };\r\n\r\n    /**\r\n     * Find controls by Xpath\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    self.getRenderByXpath = function (xpath) {\r\n        setScopeDefinition();\r\n        xpath = xpath || \"\";\r\n        return renderInterface.extendControlInterface(self.form.getRender(xpath));\r\n    };\r\n\r\n\r\n    self.getRenderByDisplayName = function (displayName) {\r\n        setScopeDefinition();\r\n        return renderInterface.extendControlInterface(self._findRenderByProperty(\"displayName\", displayName));\r\n    };\r\n\r\n    self.getRenderByValue = function (value) {\r\n        setScopeDefinition();\r\n        return renderInterface.extendControlInterface(self._findRenderByProperty(\"value\", value));\r\n    };\r\n\r\n    self.getNotificationPanel = function () {\r\n        setScopeDefinition();\r\n        return (function () {\r\n            var getControl = function () {\r\n                return $(\".ui-bizagi-notifications-container-bottom .ui-bizagi-notifications-content\");\r\n            };\r\n\r\n            var getMessages = function () {\r\n                var response = [];\r\n                var messagesHtml = $(\".ui-bizagi-notification-item\", getControl());\r\n\r\n                if (messagesHtml.length > 0) {\r\n                    $.each(messagesHtml, function (key, value) {\r\n                        response.push($.trim($(value).find(\"label\").text()));\r\n                    });\r\n                }\r\n                return response;\r\n            };\r\n            var hasMessage = function (message) {\r\n                var messages = getMessages();\r\n                var result = false;\r\n                if (message !== \"\" && messages.length > 0) {\r\n                    $.each(messages, function (key, value) {\r\n                        if (value.indexOf(message) >= 0) {\r\n                            result = true;\r\n                        }\r\n                    });\r\n                }\r\n                return result;\r\n            };\r\n\r\n            return {\r\n                getMessages: getMessages,\r\n                hasMessage: hasMessage\r\n            };\r\n        })();\r\n    };\r\n\r\n    self.getFormButtonByCaption = function (caption) {\r\n        setScopeDefinition();\r\n        var buttons = self.form.getButtons();\r\n        var render = $(\"<button>\");\r\n\r\n        // Find button by display name\r\n        $.each(buttons, function (key, value) {\r\n            if (value.value === caption) {\r\n                render = value;\r\n            }\r\n        });\r\n\r\n        return render;\r\n    };\r\n\r\n    self.getFormButtons = function () {\r\n        setScopeDefinition();\r\n        return self.form.getButtons();\r\n    }\r\n\r\n    /**\r\n     * Check if render is on the DOM\r\n     * @returns {boolean}\r\n     */\r\n    self.ready = function () {\r\n        return (bizagi.rendering.facade.executionDeferred.state() === \"resolved\") ? true : false;\r\n    };\r\n\r\n    return {\r\n        getRenderById: self.getRenderById,\r\n        getRenderByType: self.getRenderByType,\r\n        getRenderByXpath: self.getRenderByXpath,\r\n        getRenderByDisplayName: self.getRenderByDisplayName,\r\n        getRenderByValue: self.getRenderByValue,\r\n        getNotificationPanel: self.getNotificationPanel(),\r\n        getFormButtonByCaption: self.getFormButtonByCaption,\r\n        getFormButtons: self.getFormButtons,\r\n        ready: self.ready\r\n    };\r\n})();","/*\r\n*   Name: BizAgi Desktop querySuggest\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:querySuggest\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.querySuggest\", {}, {\r\n//h_contexttype:metadata\r\n\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        // QA-471 When the contexttype is metadata it does not\r\n        // send xpathcontext\r\n        if(params && params.h_contexttype && params.h_contexttype === 'metadata'){\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype:'metadata',\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n            defer.resolve({});\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /* Renders the advanced item */\r\n    renderClearItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.CLEAR_SEARCH_ID,\r\n            label: this.getResource(\"render-search-clear-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            self.setValue({ id: \"\" });\r\n            self.setDisplayValue(\"\");\r\n        });\r\n\r\n        return searchItem;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryExtendedText\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryExtendedText\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.extendedText.extend(\"bizagi.rendering.desktop.queryExtendedText\", {}, {\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop querySuggest\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryText\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.text.extend(\"bizagi.rendering.desktop.queryText\", {}, {\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryCheck\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryCheck\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.check.extend(\"bizagi.rendering.desktop.queryCheck\", {}, {\r\n     /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        return  bizagi.util.parseBoolean(this.value);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryYesNo\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryYesNo\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.yesno.extend(\"bizagi.rendering.desktop.queryYesNo\", {}, {\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        return  bizagi.util.parseBoolean(this.value);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop querySearch\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:querySearch\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.querySearch\", {}, {\r\n     /*\r\n     *   Opens the search dialog\r\n     */\r\n    showSearchDialog: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            extraButtons,\r\n            contextType = (properties.searchForms.length > 0 && properties.searchForms[0].type == \"searchForm\") ? \"metadata\" : \"entity\";\r\n\r\n        // Define add button\r\n        if (properties.allowNew) {\r\n            extraButtons = self.showAddRecordDialog();\r\n        }\r\n\r\n        // Show search dialog\r\n        self.searchDialog = new bizagi.rendering.dialog.search(self.dataService, self.renderFactory, properties.searchForms, {\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords\r\n        }, extraButtons);\r\n\r\n        self.searchDialog.render({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: contextType\r\n        }).done(function (item) {\r\n            data={id:item.id,value:item.id};\r\n            // Set data\r\n            self.setDisplayValue(data);\r\n            self.setValue(data);\r\n        });\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Desktop queryForm Extension\r\n*   Author: UI Forms Team\r\n *   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Extends from form desktop base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.queryForm\", {}, {\r\n\r\n    /*\r\n     *    Create a function to hide check all element in view when no contains check elements\r\n     */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var checkIncluded = [];\r\n        var checkIncludedAll = self.container.find(\".ui-bizagi-render-control-included-all\");\r\n        // Call base\r\n        self._super(container);\r\n        checkIncluded = self.container.find(\".ui-bizagi-render-control-included\");\r\n        if(checkIncluded.length <= 0 ){\r\n            checkIncludedAll.parent().hide();\r\n        }\r\n    },\r\n    /*\r\n    *    Creates a json array with key values to send to the server\r\n    */\r\n    collectRenderValuesForSubmit: function (request) {\r\n        var self = this;\r\n        var data = [];\r\n        // Collect data in array\r\n        self.collectRenderValuesQueryForm(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (i, item) {\r\n            var renders = self.getRenders(item.xpath);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n        request.parameters = data;\r\n        return request;\r\n    },\r\n\r\n    getSearchParams: function (request) {\r\n        var self = this;\r\n        self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n        var valid = self.validationController.performValidations();\r\n        if (valid) {\r\n            return self.collectRenderValuesForSubmit(request);\r\n        } else {\r\n            self.validationController.expandNotificationBox();\r\n            return null;\r\n        }\r\n    },\r\n    /*\r\n    *  configure Handlers for check  all column included in the response\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self._super();\r\n        var checkIncludedAll = self.container.find(\".ui-bizagi-render-control-included-all\");\r\n        checkIncludedAll.tooltip({ position: { my: \"right-20 center\", at: \"right center\" }, tooltipClass: 'bz-wp-queryForm-check-all'});\r\n        checkIncludedAll.change(function () {\r\n            var newValue = checkIncludedAll.is(\":checked\");\r\n\r\n            var checkedChildren = function (target) {\r\n                $.each(target.children, function (i, item) {\r\n                    if (item.element) {\r\n                        if(item.properties.visible===true && item.properties.includedInResult===true){\r\n                            item.properties.included = newValue;\r\n                            var checkIncluded = item.element.find(\".ui-bizagi-render-control-included\");\r\n                            checkIncluded.prop(\"checked\", newValue);\r\n                        }\r\n                    }\r\n                    else if (item.children) {\r\n                        checkedChildren(item);\r\n                    }\r\n                });\r\n            };\r\n\r\n            checkedChildren(self);\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop FormTemplate Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the form template class to adjust to desktop devices\r\n */\r\n\r\n// Extends from desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.formTemplate\", bizagi.rendering.formTemplate.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.formTemplate.extend(\"bizagi.rendering.desktop.formTemplate\", {}, {});\r\n","/*\r\n *   Name: Bizagi Render ComboSelected class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for comboSelected renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.comboSelected\", {}, {\r\n    /* \r\n    * Constructor \r\n    */\r\n    init: function (params) {\r\n        // Call base \r\n        this._super(params);\r\n        this.leftValues = this.filterData();\r\n        this.rightValues = JSON.parse(JSON.stringify(this.properties.value));\r\n    },\r\n    /*\r\n    * Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"render-comboSelected\");\r\n        var html = $.fasttmpl(template, { dataList: this.leftValues });\r\n        return html;\r\n    },\r\n\r\n    orderArraySelected: function (dataList) {\r\n        var arrayOrder = dataList;\r\n\r\n        var order = arrayOrder.sort(function (a, b) {\r\n            var nA = a.value === undefined || a.value === null ? \"\" : a.value.toString().toLowerCase();\r\n            var nB = b.value === undefined || b.value === null ? \"\" : b.value.toString().toLowerCase();\r\n            if (nA < nB)\r\n                return -1;\r\n            else if (nA > nB)\r\n                return 1;\r\n            return 0;\r\n        });\r\n\r\n        return order;\r\n    },\r\n\r\n    /*\r\n    * Filter data before set\r\n    */\r\n    filterData: function () {\r\n        var self = this;\r\n        var dataListArray = [];\r\n\r\n        if(self.properties.data) {\r\n            $.each(self.properties.data, function (i, data) {\r\n                var el = $.grep(self.properties.value, function (value, e) {\r\n                    return (self.properties.xpath == \"Organizations\") ? value.id == data.id : value.id === data.id;\r\n                });\r\n    \r\n                if (!el.length) {\r\n                    dataListArray.push(data);\r\n                }\r\n            });\r\n        }\r\n\r\n        return dataListArray;\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each children to customize each control\r\n    */\r\n    renderControlReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"render-comboSelectedReadOnly\");\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    }\r\n});","/*\r\n *   Name: Bizagi Render ComboSelected class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for comboSelected renders\r\n */\r\n\r\n  // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.comboSelected\", bizagi.rendering.comboSelected.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.comboSelected.extend(\"bizagi.rendering.desktop.comboSelected\", {}, {\r\n\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n        var control = this.getControl();\r\n\r\n        // Value data into selectedItemsToUpdate\r\n        this.showInitialData(this.properties.value);\r\n\r\n        //Show initial value or nothing\r\n        if (this.selectedItemsToUpdate.length >= 0) {\r\n            $.each(this.selectedItemsToUpdate, function (index, value) {\r\n                $(\"#listBoxComboData\", control).append(\"<option value='\" + value.id + \"'>\" + value.value + \" </option>\");\r\n            });\r\n        }\r\n\r\n        $(control).closest(\".ui-bizagi-render-control\").addClass(\"ui-bizagi-render-comboselected\")\r\n    },\r\n\r\n    orderArrayList: function () {\r\n        var arrayOrderList = this.properties.value;\r\n        var orderList = arrayOrderList.sort(function (a, b) {\r\n\r\n            var nA = (a.value !== undefined && a.value !== null) ? a.value.toLowerCase() : \"\";\r\n            var nB = (b.value !== undefined && b.value !== null) ? b.value.toLowerCase() : \"\";\r\n\r\n            if (nA < nB)\r\n                return -1;\r\n            else if (nA > nB)\r\n                return 1;\r\n            return 0;\r\n        });\r\n        this.properties.value = orderList;\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Event to move right the elements\r\n        $(\"#move_right\", control).click(function (e) {\r\n        //if(self.selectedItemsToUpdate.length == 0) self.showListBoxComboData();\r\n            self.addItem();\r\n            var input = $(\"#bz-render-comboSelected-listBoxResults .ui-bizagi-render-text\", control);\r\n            self.filterFunction(input.val(), self.rightValues, $(\"#bz-render-comboSelected-listBoxResults select\", control));\r\n            input.focus();\r\n        });\r\n\r\n        //Event to move left the elements\r\n        $(\"#move_left\", control).click(function (e) {\r\n            self.removeItem();\r\n            var input = $(\"#bz-render-comboSelected-selectOptions .ui-bizagi-render-text\", control);\r\n            self.filterFunction(input.val(),  self.leftValues, $(\"#bz-render-comboSelected-selectOptions select\", control));\r\n            input.focus();\r\n        });\r\n\r\n        $(\"#bz-render-comboSelected-selectOptions .ui-bizagi-render-text\", control).bind(\"keyup input\", function (e) {\r\n            self.filterFunction(this.value, self.leftValues, $(\"#bz-render-comboSelected-selectOptions select\", control));\r\n        });\r\n\r\n        $(\"#bz-render-comboSelected-listBoxResults .ui-bizagi-render-text\", control).bind(\"keyup input\", function (e) {\r\n            self.filterFunction(this.value, self.rightValues, $(\"#bz-render-comboSelected-listBoxResults select\", control));\r\n        });\r\n    },\r\n\r\n    filterFunction: function(filter, list, selectInput) {\r\n        var self = this;\r\n        $(selectInput).empty();\r\n        //Add the values thath match\r\n        $.each(list, function(i, value){\r\n            var index = value.value.toUpperCase().indexOf(filter.toUpperCase());\r\n            if (index !== -1) {\r\n                self.binaryInsert(value, selectInput);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Return the index of the found item, if no item found it return the bitwise index.\r\n     * @param {Object} item - Item to search.\r\n     * @param {Number} item.id - ID item to search.\r\n     * @param {String} item.value - Value item to search.\r\n     * @param {Object} array - jQuery selection of <select>, with <option>'s array.\r\n     */\r\n    binarySearch: function(item, array) { \r\n        var left = 0, right = array.children().length - 1, middle, current;\r\n        while (left <= right) {\r\n            middle = (left + right) >>> 1;\r\n            current = array.children()[middle].text;\r\n            if (item.value > current) {\r\n                left = middle + 1;\r\n            } else if (item.value < current) {\r\n                right = middle - 1;\r\n            } else {\r\n                return middle;\r\n            }\r\n        }\r\n        return ~left;\r\n    },\r\n    /**\r\n     * Inserts an item into the array in alphabetical order\r\n     * @param {Object} item - Item to insert.\r\n     * @param {Number} item.id - ID item to insert.\r\n     * @param {String} item.value - Value item to insert.\r\n     * @param {Object} array - jQuery selection with the <select> to append the item.\r\n     */\r\n    binaryInsert: function(item, array) {\r\n        var element = $(\"<option value='\" + item.id + \"'>\" + item.value + \" </option>\");\r\n        var index = this.binarySearch(item, array);\r\n        if (index < 0) {\r\n            index = ~index;\r\n        }\r\n        if (array.children().length !== 0 && index < array.children().length) {\r\n            array.find(\"option:eq(\"+ index +\")\").before(element);\r\n        } else {\r\n            array.append(element);\r\n        }\r\n        return index;\r\n    },\r\n\r\n    changeRequired: function(argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function(argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n    * Override display value\r\n    */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /*\r\n    * Add item to listBoxComboData and selectedItemsToUpdate array\r\n    */\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var dataSelected = $(\"#selectionData option:selected\", control);\r\n        var dataResults = $(\"#listBoxComboData\", control);\r\n        $.each(dataSelected, function(i, item) {\r\n            var newItem = {\r\n                id: parseInt(item.value),\r\n                value: item.text\r\n            };\r\n            var inArray = $.grep(self.selectedItemsToUpdate, function(e) {\r\n                return e.id == newItem.id;\r\n            })\r\n            if (inArray.length <= 0) {\r\n                self.binaryInsert(newItem, dataResults);\r\n                self.selectedItemsToUpdate.push(newItem);\r\n\r\n                self.rightValues.push(newItem);\r\n                self.leftValues =  $.grep(self.leftValues, function(el){\r\n                    return el.id != newItem.id;\r\n                });\r\n            }\r\n        });\r\n        dataSelected.remove();\r\n        self.setValue(self.selectedItemsToUpdate);\r\n    },\r\n\r\n    /*\r\n    * Remove item from listBoxComboData and selectedItemsToUpdate array\r\n    */\r\n    removeItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var dataSelectedToRemove = $(\"#listBoxComboData option:selected\", control);\r\n        var dataOptions = $(\"#selectionData\", control);\r\n\r\n        $.each(dataSelectedToRemove, function (i, item) {\r\n            var removeItem = { \r\n                id: parseInt(item.value),\r\n                value: item.text\r\n            };\r\n            var inArray = $.grep(dataOptions, function (e) {\r\n                return e.id == removeItem.id;\r\n            });\r\n            if (inArray.length <= 0) {\r\n                self.binaryInsert(removeItem, dataOptions);\r\n                self.leftValues.push(removeItem);\r\n                self.rightValues = $.grep(self.rightValues, function (e) {\r\n                    return e.id != removeItem.id;\r\n                });\r\n\r\n                self.selectedItemsToUpdate = $.grep(self.selectedItemsToUpdate, function (e) {\r\n                    return e.id != removeItem.id;\r\n                });\r\n            }\r\n        });\r\n\r\n        dataSelectedToRemove.remove();\r\n        self.setValue(self.selectedItemsToUpdate);\r\n    },\r\n\r\n    /*\r\n    * Show listBoxComboData and move_left button from control view\r\n    */\r\n    showListBoxComboData: function () {\r\n        var control = this.getControl();\r\n        $(\"#move_left\", control).show();\r\n        $(\"#bz-render-comboSelected-listBoxResults\", control).show();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    showInitialData: function (val) {\r\n        var self = this;\r\n        self.orderArrayList();\r\n        self.selectedItemsToUpdate = [];\r\n\r\n        if (!!val) {\r\n            $.each(val, function (index, value) {\r\n                self.selectedItemsToUpdate.push({\r\n                    id: value.id,\r\n                    value: value.value\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    renderReadOnly: function(){\r\n        var htmlControl = this.renderFactory.getTemplate(\"render-comboSelectedReadOnly\");\r\n        this.showInitialData(this.properties.value);\r\n        return $.fasttmpl(htmlControl, { datasource: this.selectedItemsToUpdate });\r\n    },\r\n\r\n    /*\r\n    * Has Value\r\n    */\r\n    hasValue: function () {\r\n        var data =  (typeof this.value === \"string\")? JSON.parse(this.value).value: this.value;\r\n        return !bizagi.util.isEmpty(data);\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        // Set previous value\r\n        this.properties.previousValue = this.properties.originalValue = JSON.stringify({ \"value\": this.value });\r\n\r\n        // Change internal value\r\n        this.value = this.properties.value = JSON.stringify({ \"value\": value });\r\n\r\n        if (this.properties.required && this.getMode() == \"execution\") {\r\n\r\n            if (this.checkRequired([])) {\r\n                this.changeRequiredLabel(false);\r\n            } else {\r\n                this.changeRequiredLabel(true);\r\n            }\r\n        }\r\n\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n        // Trigger events\r\n        if (triggerEvents && !this.internalSetInitialValueFlag) {\r\n            this.triggerRenderChange();\r\n            this.triggerRenderValidate();\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Rendering Users Form\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script override rendering.form to create and update users\r\n */\r\n\r\n// Extends from container desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.usersForm\", {}, {\r\n\r\n    init: function (params) {\r\n\r\n        var self = this;\r\n\r\n        // Set observable element\r\n        this.form = this.getFormContainer();\r\n        this.observableElement = $({});\r\n        this.collectedValues = {};\r\n        self._super(params);\r\n    },\r\n\r\n    /*\r\n    * Reimplement loading for users form\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        var $canvas = $(self.params.canvas).closest(\".ui-dialog\");\r\n        var position = $canvas.offset();\r\n\r\n        self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo($canvas);\r\n        self.waitingMessage = $.tmpl(waitingTemplate).appendTo($('body', $(document)));\r\n\r\n        self.waitingMessage.css({\r\n            \"top\": position.top + (Math.ceil(($canvas.height() - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n            \"left\": position.left + (Math.ceil(($canvas.width() - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        if (self.properties.orientation == \"rtl\") {\r\n            self.buttons.reverse();\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.click(function () {\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            // Execute button\r\n            self.processButton(buttonProperties);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Reimplement process button actions in users forms\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        $.when(self.ready()).done(function () {\r\n\r\n            var params = {\r\n                formAction: \"cancel\",\r\n                sendMail: false\r\n            };\r\n            switch (buttonProperties.action) {\r\n                case \"save\":\r\n\r\n                    var sendMailControl = self.form.getRender('sendMail');\r\n                    var passwordControl = self.form.getRender('password');\r\n\r\n                    var params = {\r\n                        formAction: \"save\",\r\n                        sendMail: (sendMailControl && sendMailControl.getValue()) || false,\r\n                        password: passwordControl === null ? \"\" : passwordControl.getValue()\r\n                    };\r\n\r\n                    if (sendMailControl && passwordControl && params.sendMail && params.password === \"\") {\r\n                        $.when(self.dataService.getConfiguration()).done(function (response) {\r\n                            if (response.redirectErrorPage) {\r\n                                window.location.href = response.redirectErrorPage;\r\n                                return;\r\n                            }\r\n\r\n                            var minLength = response.passwordMinLength;\r\n                            var maxLength = response.passwordMaxLength;\r\n                            self.generateRandomPassword(passwordControl, minLength, maxLength);\r\n                            params.password = passwordControl.getValue();\r\n                            self.processSave(params);\r\n                        }).fail(function (response) {\r\n                            self.generateRandomPassword(passwordControl, 8, 12);\r\n                            params.password = passwordControl.getValue();\r\n                            self.processSave(params);\r\n\r\n                            var obj = JSON.parse(response.responseText)\r\n                            self.validationController.showValidationMessage(obj.message);\r\n                        });\r\n                    } else {\r\n                        self.processSave(params);\r\n                    }\r\n                    break;\r\n                case \"cancel\":\r\n                    self.triggerHandler(\"endUsersForm\", params);\r\n                    break;\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Process save actions\r\n    */\r\n    processSave: function (params) {\r\n\r\n        var self = this;\r\n\r\n        // validate the form\r\n        var valid = self.validationController.performValidations();\r\n\r\n        if (valid) {\r\n            self.startLoading();\r\n\r\n            var saveDeferred;\r\n            $.extend(self.collectedValues, self.collectRenderValuesForSubmit());\r\n\r\n            var userFormData = {\r\n                action: \"SAVEUSER\",\r\n                contexttype: \"entity\",\r\n                data: {},\r\n                idPageCache: self.idPageCache\r\n            };\r\n\r\n            delete self.collectedValues.sendMail;\r\n            delete self.collectedValues['@Metadata.Stakeholders'];\r\n\r\n            if (self.params.action === \"add\") {\r\n                saveDeferred = self.createUser(userFormData, params);\r\n            }\r\n            else if (self.params.action === \"edit\") {\r\n                saveDeferred = self.updateUser(userFormData);\r\n            }\r\n\r\n            $.extend(params, userFormData.data);\r\n            $.when(saveDeferred).done(function (response) {\r\n                self.triggerHandler(\"endUsersForm\", params);\r\n            }).fail(function (response) {\r\n                var obj = JSON.parse(response.responseText)\r\n\r\n                self.endLoading();\r\n                self.validationController.showValidationMessage(obj.message);\r\n                self.triggerHandler(\"endUsersForm\", $.extend(params, { error: obj }));\r\n            });\r\n        }\r\n        else {\r\n            self.validationController.expandNotificationBox();\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Generates a random password between 8 and 12 characters\r\n    * */\r\n    generateRandomPassword: function (passwordControl, minLength, maxLenth) {\r\n        var self = this;\r\n        var length = self.getLengthPassword(minLength, maxLenth);\r\n\r\n        var chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz\";\r\n        var randomPassword = '';\r\n        for (var i = 0; i < length; i++) {\r\n            var randomPosition = Math.floor(Math.random() * chars.length);\r\n            randomPassword += chars.substring(randomPosition, randomPosition + 1);\r\n        }\r\n        passwordControl.saveValue(randomPassword);\r\n    },\r\n\r\n    /**\r\n    * Generates a random length between minLength and maxLenth if both are defined, or between 8 and 12\r\n    * */\r\n    getLengthPassword: function (minLength, maxLenth) {\r\n        minLength = (minLength && maxLenth) ? minLength : 8;\r\n        maxLenth = (maxLenth && minLength) ? maxLenth : 12;\r\n        return Math.floor(Math.random() * (maxLenth - (minLength - 1))) + minLength;\r\n    },\r\n\r\n    /*\r\n    * Create User\r\n    */\r\n    createUser: function (userFormData, params) {\r\n\r\n        var self = this;\r\n        var collectedData = self.collectedValues;\r\n\r\n        var expiredAccountControl = self.form.getRender('expiredAccount');\r\n        var lockedAccountControl = self.form.getRender('lockedAccount');\r\n        var domain = self.form.getRender('domain');\r\n\r\n        //Add these parameters for the collected data\r\n        collectedData.expiredAccount = (expiredAccountControl) ? expiredAccountControl.getValue() : null;\r\n        collectedData.lockedAccount = (lockedAccountControl) ? lockedAccountControl.getValue() : null;\r\n        collectedData.domain = (domain) ? domain.getValue() : \"\";\r\n\r\n        // Data for first calling\r\n        $.extend(userFormData, {\r\n            data: {\r\n                domain: collectedData.domain,\r\n                fullName: collectedData.fullName,\r\n                userName: collectedData.userName\r\n            }\r\n        });\r\n\r\n        return $.when(self.dataService.submitData(userFormData)).pipe(function (response) {\r\n\r\n            // After save the action change to be edition\r\n            self.params.action = \"edit\";\r\n            self.params.userId = response.idEntity;\r\n\r\n            delete collectedData.userName;\r\n            delete collectedData.domain;\r\n\r\n            $.extend(userFormData, {\r\n                data: collectedData,\r\n                surrogatekey: response.idEntity\r\n            });\r\n\r\n            $.extend(params, {\r\n                userId: response.idEntity\r\n            });\r\n\r\n            return self.dataService.submitData(userFormData);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Update user \r\n    */\r\n    updateUser: function (userFormData) {\r\n        var self = this;\r\n        var collectedData = self.collectedValues;\r\n\r\n        $.extend(userFormData, {\r\n            surrogatekey: self.params.userId,\r\n            data: collectedData\r\n        });\r\n\r\n        return self.dataService.submitData(userFormData);\r\n\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Render userPassword class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for userPassword render\r\n */\r\n$.Class.extend(\"bizagi.rendering.userPassword\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n        this.properties.value = null;\r\n        self.properties = this.properties;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"render-userPassword\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {valuePassword: self.properties.value});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        return bValid;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Stateholder\r\n *   Author: Fabian Moreno\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.stakeholder\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        if (typeof this.properties.value === \"undefined\") {\r\n            this.properties.value = [];\r\n        }\r\n\r\n        if (typeof this.properties.data === \"undefined\") {\r\n            this.properties.data = [];\r\n        }\r\n        self.properties = this.properties;\r\n    },\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"stakeholder\");\r\n\r\n        var params =  {\r\n            currentUser: bizagi.currentUser.userName,\r\n            userNames: (typeof self.properties.value == \"string\") ? JSON.parse(self.properties.value).value: self.properties.value,\r\n            entities: self.properties.data\r\n        };\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, params);\r\n        return html;\r\n    },\r\n\r\n    getData: function (valueXpath, currentPage, filter, sort, order) {\r\n        var self = this;\r\n\r\n        if (typeof currentPage === \"undefined\" || currentPage == null)\r\n            currentPage = \"1\";\r\n\r\n        var params= {\r\n            pxpath:valueXpath,\r\n            prows: \"10\",\r\n            ppage: currentPage.toString(),\r\n            xpath:valueXpath,\r\n            idRender:self.properties.id,\r\n            xpathContext:self.properties.xpathContext,\r\n            idPageCache:self.properties.idPageCache,\r\n            property:\"dataxpath\",\r\n            contexttype:\"entity\",\r\n            pfilter: filter,\r\n            psort: sort\r\n        };\r\n\r\n        if(order) params.porder = order;\r\n\r\n        return self.dataService.multiaction().getPropertyData(params);\r\n    },\r\n\r\n    associatedUser: function (idEntity, guidEntity, idUser) {\r\n        var self = this;\r\n\r\n        return self.dataService.associateStakeholder({\r\n\r\n            idPageCache:self.properties.idPageCache,\r\n            contexttype:\"entity\",\r\n            surrogateKey: parseInt(idEntity),\r\n            associatedUser: JSON.encode({dataType:\"Int\", value:(idUser == \"null\")?idUser:parseInt(idUser)}),\r\n            guidentity: guidEntity\r\n        });\r\n    },\r\n\r\n    refreshStakeholderList: function () {\r\n        var self = this;\r\n\r\n        return self.dataService.refreshAssociateStakeholder({\r\n\r\n            idRender:self.properties.id,\r\n            contexttype:\"entity\",\r\n            property:\"value\",\r\n            idPageCache:self.properties.idPageCache\r\n        });\r\n    }\r\n});","/**\r\n *   Name: BizAgi Desktop Stakeholder\r\n *   Author: Fabian Moreno\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.stakeholder\", bizagi.rendering.stakeholder.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.stakeholder.extend(\"bizagi.rendering.desktop.stakeholder\", {}, {\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var bizagiControl = $('.ui-bizagi-render-stakeholder-container').closest('.ui-bizagi-control.ui-bizagi-render-align-left ');\r\n\r\n        // Hide initial control label\r\n        bizagiControl.css('width', '100%');\r\n        bizagiControl.prev().css('display', 'none');\r\n\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n        self.selectedItems = [];\r\n        self.valueXpath;\r\n        self.guidEntity;\r\n        self.currentPage;\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Event to associate stakeholder\r\n        $(\"#ui-bizagi-render-stakeholder-add\", control).click($.proxy(self.addInstance, self));\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\", control).click($.proxy(self.addGrid, self));\r\n        $(\".ui-bizagi-render-stakeholder-back\", control).click($.proxy(self.goToBack, self));\r\n        $(\".ui-bizagi-render-stakeholder-link\", control).click($.proxy(self.removeAssociated, self));\r\n        $(\".ui-bizagi-render-stakeholder-search\", control).keyup($.proxy(self.onKeyUpFilter, self));\r\n\r\n        control.on(\"click\", \"table .sortColumnsData-stakeholder\", function (e) {\r\n            var currentTarget = $(e.currentTarget);\r\n            var paramField = currentTarget.data(\"orderfield\");\r\n            var orderType = currentTarget.data(\"ordertype\");\r\n\r\n            self.gridDataService(self.currentPage, null, paramField, (orderType === \"DESC\") ? \"ASC\" : \"DESC\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    goToBack: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.status === \"step1\") {\r\n            $(\"#ui-bizagi-render-stakeholder-entity-list\", control).hide();\r\n            $(\"#ui-bizagi-render-stakeholder-add-instance\", control).hide();\r\n\r\n            $(\"#ui-bizagi-render-stakeholder-associated-list\", control).show();\r\n            $(\".ui-bizagi-render-stakeholder-associated\", control).show();\r\n            $(\"#ui-bizagi-render-stakeholder-add\", control).show();\r\n\r\n            $(\".ui-bizagi-render-stakeholder-back\", control).hide();\r\n\r\n            self.status = null;\r\n        }\r\n        else if (self.status === \"step2\") {\r\n            $(\"#ui-bizagi-render-stakeholder-grid\", control).hide();\r\n            $(\"#ui-bizagi-render-stakeholder-add-instance\", control).show();\r\n\r\n            self.status = \"step1\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    addInstance: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.status = \"step1\";\r\n        $(\"#ui-bizagi-render-stakeholder-associated-list\", control).hide();\r\n        $(\".ui-bizagi-render-stakeholder-associated\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-add\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-entity-list\", control).show();\r\n        $(\"#ui-bizagi-render-stakeholder-add-instance\", control).show();\r\n        $(\".ui-bizagi-render-stakeholder-back\", control).show();\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\").removeClass(\"ui-bizagi-render-stakeholder-selected\");\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    addGrid: function (e) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.valueXpath = $( e.currentTarget).attr( \"data-value\" );\r\n        self.guidEntity = $( e.currentTarget).attr( \"guid-entity\" );\r\n\r\n        self.status = \"step2\";\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\").removeClass(\"ui-bizagi-render-stakeholder-selected\");\r\n        $(e.currentTarget).addClass(\"ui-bizagi-render-stakeholder-selected\");\r\n\r\n        $(\"#ui-bizagi-render-stakeholder-add-instance\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-grid\", control).show();\r\n\r\n        $(\".ui-bizagi-render-stakeholder-search\", control).val(\"\");\r\n\r\n        self.gridDataService(null, \"\", \"\", \"DESC\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param currentPage\r\n     * @param filter\r\n     * @param sort\r\n     * @param orderType\r\n     */\r\n    gridDataService: function (currentPage, filter, sort, orderType) {\r\n        var self = this;\r\n\r\n        self.getData(self.valueXpath, currentPage, filter, sort, orderType).done(function (data) {\r\n            self.onGetData(data, orderType);\r\n        }).fail(function (e) {\r\n            self.onGetDataFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    onGetData : function(data, orderType){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var tempGrid = self.renderFactory.getTemplate(\"stakeholder-grid\");\r\n        self.currentPage  = data.page;\r\n\r\n        if(data.rows.length > 0){\r\n            var dataColumns = data.rows[0][1];\r\n\r\n            //preprocess columns because more template simple\r\n            var tempColumns = dataColumns.slice(1, dataColumns.length);\r\n            var columns = [];\r\n            for(iColumn = 0; iColumn < tempColumns.length; iColumn++){\r\n                var objectColumn = {\r\n                    name: tempColumns[iColumn][0],\r\n                    displayName: tempColumns[iColumn][1],\r\n                    orderType: orderType\r\n                };\r\n                columns.push(objectColumn);\r\n            }\r\n\r\n\r\n            var idData = self.selectedItems[self.valueXpath];\r\n\r\n            $.each( data.rows, function (key, value) {\r\n                var item = value[2][0][0];\r\n                if((!idData && (item != undefined)) || (idData && (item == idData.id)))\r\n                {\r\n                    self.selectedItems[self.valueXpath] = {\"id\" : value[0], \"idInstance\": item, \"nameInstance\" : value[2][0][1]};\r\n                    return;\r\n                }\r\n            });\r\n\r\n            if(self.selectedItems[self.valueXpath] && self.selectedItems[self.valueXpath].idUser == \"null\")\r\n            {\r\n                delete self.selectedItems[self.valueXpath];\r\n            }\r\n\r\n            //preprocess data.rows because more template simple\r\n            var newDataRows = [];\r\n            for(var iRow = 0; iRow < data.rows.length; iRow++){\r\n                var stateInstance = \"\";\r\n                var tooltipLink = \"\";\r\n\r\n                if(data.rows[iRow][2][0][0] && data.rows[iRow][2][0][0] != self.properties.idUser){\r\n                    stateInstance = \"associatedWithAnotherUser\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-associate-another-user\").replace(\"{0}\", data.rows[iRow][2][0][1]);\r\n                }\r\n                else if(data.rows[iRow][2][0][0] == self.properties.idUser){\r\n                    stateInstance = \"associateMe\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-associate\");\r\n                }\r\n                else{\r\n                    stateInstance = \"unassociated\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-unassociate\");\r\n                }\r\n\r\n                var rowTemplate = {};\r\n                rowTemplate.columns = [];\r\n                rowTemplate.columns.push({\r\n                    stateInstance: stateInstance,\r\n                    value: data.rows[iRow][0],\r\n                    tooltipLink: tooltipLink\r\n                });\r\n\r\n                for(var iColumn = 0; iColumn < data.rows[iRow][2].length; iColumn++){\r\n                    if(iColumn > 0){\r\n                        rowTemplate.columns.push({value: data.rows[iRow][2][iColumn]});\r\n                    }\r\n                }\r\n\r\n                newDataRows.push(rowTemplate);\r\n            }\r\n\r\n            var gridTmp = $.tmpl(tempGrid, {\r\n                datasource: newDataRows,\r\n                columns: columns,\r\n                tooltipUnassociated: bizagi.localization.getResource(\"render-stakeholder-link-tooltip-unassociate\")\r\n            });\r\n\r\n            $(\".ui-bizagi-render-stakeholder-items-grid-content\", control).empty().append(gridTmp);\r\n\r\n            var tempPagination = self.renderFactory.getTemplate(\"stakeholder-paginator\");\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = data.records;\r\n            //keep in track the total pages\r\n            self.totalPages = data.total;\r\n            var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n            var pagerData = {};\r\n\r\n            // show or hide \"load more\" button\r\n            pagerData.pagination = (self.totalPages > 1);\r\n            pagerData.page = data.page;\r\n            pagerData.pages = {};\r\n\r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pagerData[\"pages\"][i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n\r\n            //load and append the paginator to the result table\r\n            paginationHtml = $.tmpl(tempPagination, pagerData).html();\r\n            $(\".ui-bizagi-render-stakeholder-paginator\", control).empty().append(paginationHtml);\r\n\r\n            var $pager = $(\".ui-bizagi-render-stakeholder-paginator ul\", control);\r\n\r\n            $pager.bizagiPagination({\r\n                maxElemShow: self.maxPageToShow,\r\n                totalPages: self.totalPages,\r\n                actualPage: self.currentPage,\r\n                listElement: $pager,\r\n                clickCallBack: function (options) {\r\n                    self.gridDataService(options.page);\r\n                }\r\n            });\r\n\r\n            self.setRowsEvents();\r\n\r\n\r\n        }\r\n        else{//hay datos en data.rows//No\r\n            $(\".ui-bizagi-render-stakeholder-items-grid-content\", control).empty();\r\n            $(\".ui-bizagi-render-stakeholder-paginator\", control).empty();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onGetDataFail : function(e){\r\n        console.log(\"process property value error: \" + e);\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    setRowsEvents: function () {\r\n        var self = this;\r\n        $(\".ui-bizagi-render-stakeholder-table-link\").click($.proxy(self.onLinkClick, self));\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onLinkClick : function(e){\r\n        var self = this;\r\n        var idUser;\r\n        var idEntity = $( e.currentTarget).attr( \"data-value\" );\r\n\r\n\r\n        function executeLinkClickIfProceed(event){\r\n            if ($(event.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-link-close\")) {\r\n                $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                idUser = \"null\";\r\n            }\r\n            else {\r\n                $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                $(event.currentTarget).addClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                idUser = self.properties.idUser;\r\n            }\r\n\r\n            self.selectedItems[self.valueXpath] = {\"id\" : idEntity, \"idUser\" : idUser};\r\n\r\n            //if idUser is null, remove associated Stakeholder\r\n            self.associatedUser(idEntity, self.guidEntity, idUser).done(function () {\r\n                self.refreshStakeholderValue();\r\n\r\n                //if only target contents ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\r\n                //set association stakeholder to user\r\n                if ($(event.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\")) {\r\n                    $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\");\r\n                    $(event.currentTarget).addClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                    idUser = self.properties.idUser;\r\n                    self.associatedUser(idEntity, self.guidEntity, idUser).done(function () {\r\n                        self.refreshStakeholderValue();\r\n                    }).fail(function (e) {\r\n                        self.onStakeAssociatedFail(e);\r\n                    });\r\n                }\r\n\r\n            }).fail(function (e) {\r\n                self.onStakeAssociatedFail(e);\r\n            });\r\n        }\r\n\r\n        //Confirm to delete stakeholder association with another user.\r\n        if($(e.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-link-close\") && $(e.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\")){\r\n            var confirmationMsg = bizagi.localization.getResource(\"render-stakeholder-delete-associate-instance-other-user-confirm-msg\");\r\n            $.when(bizagi.showConfirmationBox(confirmationMsg, \"Bizagi\", \"warning\"))\r\n                .done(function () {\r\n                    executeLinkClickIfProceed(e);\r\n                });\r\n        }\r\n        else{\r\n            executeLinkClickIfProceed(e);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    removeAssociated: function (e) {\r\n        var self = this;\r\n\r\n        var idEntity = $( e.currentTarget).attr( \"data-value\" );\r\n        self.guidEntity = $( e.currentTarget).attr( \"guid-entity\" );\r\n        var state = \"null\";\r\n        self.selectedItems[self.valueXpath] = {\"id\" : idEntity, \"idUser\" : state};\r\n\r\n        self.associatedUser(idEntity, self.guidEntity, state).done(function () {\r\n            self.refreshStakeholderValue();\r\n        }).fail(function (e) {\r\n            self.onStakeAssociatedFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onKeyUpFilter : function (e) {\r\n        var self = this;\r\n        if(e.keyCode == 13)\r\n        {\r\n            var filter = $(e.target).val();\r\n            self.gridDataService(null,  filter);\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    refreshStakeholderValue : function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.refreshStakeholderList().done(function (data) {\r\n            //Update Stakeholder List\r\n            self.setValue(data);\r\n            control.empty().append(self.renderControl());\r\n            self.configureHandlers();\r\n        }).fail(function (e) {\r\n            self.onStakeAssociatedFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onStakeAssociatedFail : function(e){\r\n        console.log(\"stakeholder associated error: \" + e);\r\n    },\r\n\r\n    /**\r\n     * Override display value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value);\r\n    },\r\n\r\n    /**\r\n     *   Sets the internal value\r\n     */\r\n    setValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set previous value\r\n        self.properties.previousValue = self.properties.originalValue = JSON.stringify({ \"value\": self.value });\r\n\r\n        // Change internal value\r\n        self.value = self.properties.value = JSON.stringify({ \"value\": value });\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Render userPassword class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for userPassword renders\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.userPassword\", bizagi.rendering.userPassword.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.userPassword.extend(\"bizagi.rendering.desktop.userPassword\", {}, {\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n\r\n        self.input = control.find(\"input\");\r\n\r\n        // Define max length of element\r\n        if (self.properties.maxLength > 0) {\r\n            self.input.attr(\"maxlength\", self.properties.maxLength);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            var inputValue = self.input.val();\r\n\r\n            if (inputValue !== \"\") {\r\n                // Updates internal value\r\n                self.saveValue(inputValue);\r\n            } else { \r\n                self.setValue(inputValue)\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    saveValue: function (inputValue) {\r\n        var self = this;\r\n\r\n        var C = CryptoJS;\r\n        var userFormsSpanner = C.enc.Utf8.parse('pc30n84e15lvdD68');\r\n        var userFormsCode = CryptoJS.enc.Latin1.parse('1v00628X62bJE2mi');\r\n\r\n        var aes = C.algo.AES.createEncryptor(userFormsSpanner, {\r\n            mode: C.mode.CBC,\r\n            padding: C.pad.Pkcs7,\r\n            iv: userFormsCode\r\n        });\r\n\r\n        var resultMain = aes.finalize(inputValue);\r\n        var resultMainFinal = C.enc.Base64.stringify(resultMain);\r\n\r\n        self.setValue(resultMainFinal);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var tempHTML = \"<label class='readonly-control'></label>\";\r\n        var spanTmp = $.tmpl(tempHTML, {});\r\n\r\n        control.append(spanTmp);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop grid Actions Extension\r\n*    Author: Cristian Olaya\r\n*           Iván Ricardo Taimal\r\n*\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.render.extend(\"bizagi.rendering.desktop.gridActions\", {}, {\r\n\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"gridActions\");\r\n        var hasActions = self.grid && self.grid.hasActions() || false;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {hasActions: hasActions});\r\n        return html;\r\n    }\r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Desktop numberScientificNotation\r\n *   Author: Laura Ariza\r\n *   Comments:\r\n *   -   This script define a render control that support scientific notation format\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.numberScientificNotation\", bizagi.rendering.numberScientificNotation.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.numberScientificNotation.extend(\"bizagi.rendering.desktop.numberScientificNotation\", {}, {\r\n\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        // Attach Format Currency Plugin to format the input\r\n        self.attachFormatScientificNotation();\r\n    },\r\n\r\n\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n\r\n        value = bizagi.util.scientificNotationFormat(value.replace(self.properties.decimalSymbol, '.'));\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value.replace('.', self.properties.decimalSymbol));\r\n            self.setValue(value);\r\n\r\n        }\r\n        // Call base\r\n        this._super(value.replace('.', self.properties.decimalSymbol));\r\n    },\r\n\r\n    attachFormatScientificNotation: function() {\r\n        var self = this;\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function() {\r\n            var inputValue = self.numericInput.val();\r\n            var scientificNotationNumber =\r\n                bizagi.util.scientificNotationFormat(inputValue, self.properties.decimalSymbol);\r\n            // Updates internal value\r\n            self.setValue(scientificNotationNumber);\r\n            self.numericInput.val(scientificNotationNumber);\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Base definition of Action Launcher and Entity template controls\r\n *\r\n * @author: Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n        this.typeForm = form.properties.typeForm || \"\";\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        if (mode == \"execution\") {\r\n            self.engine = new bizagi.templateEngine({\r\n                renderFactory: self.renderFactory,\r\n                cache: true,\r\n                autoGenerateData: false,\r\n                templateGuid: properties.selecttemplate\r\n            });\r\n        }\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"ptags\": self.properties.tagslist || [],\r\n            \"pmaxitems\": self.properties.maxItems,\r\n            \"pactionXpath\": self.properties.xpathActions\r\n        };\r\n\r\n        self.processPropertyValueDataTmplArgs = {\r\n            \"pactionXpath\": self.properties.xpathActions,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"ptemplateGuid\": properties.selecttemplate,\r\n            \"property\": \"dataTemplate\",\r\n            \"xpathActions\": self.properties.xpathActions\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        var defaultAllowActions = data.properties.type === \"entityTemplate\" ? false : true;\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\")\r\n            ? defaultAllowActions : data.properties.allowactions;\r\n        self.properties.isHorizontal = (typeof data.properties.isHorizontal == \"undefined\")\r\n            ? true : data.properties.isHorizontal;\r\n        self.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\")\r\n            ? false : data.properties.allowSearch;\r\n        self.properties.selecttemplate = (typeof data.properties.selecttemplate == \"undefined\")\r\n            ? \"\" : data.properties.selecttemplate;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\")\r\n            ? properties.templatetype : 'none';\r\n\r\n        self.properties.sessionId = form.params.data.sessionId;\r\n\r\n        if (!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n            self.properties.originalValue = [];\r\n        } else if (typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Send processpropertyvalue in order to execute an Action\r\n     * This method is used when this control stay in Summary form or Global form\r\n     * @param action\r\n     */\r\n    executeActionImmediately: function (action) {\r\n        var self = this;\r\n        //Execute action immediately\r\n        var form = self.getFormContainer();\r\n\r\n        var processPropertyValueExecuteAction = {\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"executeAction\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"pguidAction\": action.guidAction,\r\n            \"pparameters\": JSON.encode({\r\n                \"idStartScope\": action.idStartScope,\r\n                \"pactionXpath\": self.properties.xpathActions,\r\n                \"idPageCache\": action.idPageCache\r\n            })\r\n        };\r\n\r\n        self.dataService.executeActions(processPropertyValueExecuteAction).done(function (data) {\r\n            self.notifyExecution(data, action);\r\n        }).fail(function (error) {\r\n            // TODO: Create generic mechanism to send notifications\r\n            self.notifyExecution(\"Error\", action);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * notify action execution status\r\n     * @param response\r\n     * @param actionName\r\n     */\r\n    notifyExecution: function (response, actionName) {\r\n        // To override in each device\r\n    },\r\n\r\n    /**\r\n     * Render control in read only mode: properties.editable = false\r\n     * @return {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Make a postrender of readonly control\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.properties.readOnly = true;\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @return {string}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher-design\");\r\n            var params = {\r\n                type: properties.type,\r\n                isHorizontal: properties.isHorizontal,\r\n                allowSearch: properties.allowSearch,\r\n                templateDefined: properties.templatetype != 'none',\r\n                allowactions: properties.allowactions\r\n            };\r\n            html = $.fasttmpl(template, params);\r\n        } else if (properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher\");\r\n            html = $.fasttmpl(template, { allowactions: self.properties.allowactions });\r\n        }\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @return {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var value = self.getValue();\r\n        var bValid = false;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) {\r\n            return true;\r\n        }\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.value) {\r\n                if (self.value.length > 0)\r\n                    return true;\r\n                message = self.getResource(\"render-required-register-action\");\r\n                invalidElements.push({ xpath: properties.xpath, message: message });\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Process an action\r\n     * @param action\r\n     */\r\n    actionManager: function (action) {\r\n        var self = this;\r\n        var guidProcess = action.guidProcess || \"\";\r\n        var def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n        /**\r\n         * Check if action is a process\r\n         */\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                // Verify if case has startform\r\n                var params = {\r\n                    guidWFClass: guidProcess\r\n                };\r\n\r\n                $.when(self.dataService.hasStartForm(params)).done(function (result) {\r\n                    if (result.hasStartForm) {\r\n                        // Open a dialog with startform and wait for Scope\r\n                        $.when(self.processStartForm({\r\n                            guidprocess: guidProcess,\r\n                            title: action.displayName,\r\n                            recordXpath: action.recordXpath\r\n                        })).done(function (idStartScope) {\r\n                            action.idStartScope = idStartScope;\r\n                            def.resolve(action);\r\n                        });\r\n                    } else {\r\n                        // Just add action to queue to be executed on nextEvent\r\n                        def.resolve(action);\r\n                    }\r\n                });\r\n\r\n                break;\r\n            case \"Rule\":\r\n                // Just add action to queue to be executed on nextEvent\r\n                def.resolve(action);\r\n                break;\r\n            case \"Form\":\r\n                // If it has additional xpath this action is a form of collection\r\n                if (action.xpathContext) {\r\n                    $.when(self.processActionFormCollection(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                } else {\r\n\r\n                    if (action.actionType === \"Form\") {\r\n                        action.xpathContext = undefined;\r\n                        action.contextType = \"entitytemplate\";\r\n                        action.guidEntity = action.guidEntity || self.properties.guidEntity;\r\n                    }\r\n\r\n                    $.when(self.processActionForm(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                }\r\n                break;\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add actions within value object\r\n     * @param action\r\n     */\r\n    addActionToQueue: function (action) {\r\n        var self = this;\r\n        var actionsList = self.getValue();\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        action.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n            case \"Form\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    entityXpath: self.properties.xpathActions,\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    idEntity: action.idEntity\r\n                };\r\n                break;\r\n            case \"Rule\":\r\n                action.params = {\r\n                    xpathActions: action.xpathActions || \"\",\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n        }\r\n\r\n        var newValueActionsList = bizagi.clone(actionsList);\r\n        newValueActionsList.push(action);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n\r\n    /**\r\n     * Remove action within value object\r\n     * @param index\r\n     */\r\n    removeActionToQueue: function (index) {\r\n        var self = this;\r\n        var newValueActionsList = bizagi.clone(self.getValue());\r\n        newValueActionsList.splice(index, 1);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            var properties = self.properties;\r\n            var xpath = properties.xpath;\r\n            var controlValue = self.getValue();\r\n            var actions = [];\r\n            $.each(controlValue, function (index, value) {\r\n                var action = {};\r\n                action.params = value.params || {};\r\n                action.guidAction = value.guidAction;\r\n\r\n                actions.push(action);\r\n            });\r\n            renderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Util to count how many actions are there\r\n     * @param action\r\n     * @return {number}\r\n     */\r\n    countSameActions: function (action) {\r\n        var self = this;\r\n        var value = self.getValue();\r\n        var count = 0;\r\n        $.each(value, function (key, value) {\r\n            if (value.guidAction == action.guidAction) {\r\n                count++;\r\n            }\r\n        });\r\n        return count;\r\n    },\r\n\r\n    /**\r\n    * Normalize action launcher control properties\r\n    * @param actionsLaucher\r\n    * @returns {*}\r\n    */\r\n    getPropertiesActionLaucher: function (actionsLaucher) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        /**\r\n         * The properties of actionLaucher have to 7 properties mandatory\r\n         * 0: guidProcess\r\n         * 1: displayName\r\n         * 2: title\r\n         * 3: actionType\r\n         * 4: guidaction\r\n         * 5: xpathContext\r\n         * 6: readOnlyForm: default: false\r\n         */\r\n        for (var i = 0, length = actionsLaucher.length, j = length; i < j; i += 1) {\r\n            //some ocassions server return 6 or 7 items\r\n            //return 6 properties when launch form action from action launcher control.\r\n            //in this case dont return xpathContext.\r\n            // So, add item position 5, simulate xpathContext empty.\r\n            if (actionsLaucher[i].length === 6) {\r\n                actionsLaucher[i].splice(5, 0, \"\");\r\n\r\n                if (actionsLaucher[i][3] == \"Process\" && form.properties.xpathContext) {\r\n                    actionsLaucher[i][5] = form.properties.xpathContext;\r\n                }\r\n            }\r\n        }\r\n\r\n        return actionsLaucher;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.range\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function() {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        template = self.renderFactory.getTemplate(\"render-range\");\r\n        html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n    /**\r\n     * Sets the range controls in DOM\r\n     * @param minControl: min range control\r\n     * @param maxControl: max range control\r\n     */\r\n    setRanageControls: function (minControl, maxControl){\r\n        var self = this;\r\n        self.minControl = minControl || null;\r\n        self.maxControl = maxControl || null;\r\n        var control = self.getControl();\r\n\r\n        var $maxCanvas = $(\".bz-range-maximum\", control);\r\n        var $minCanvas = $(\".bz-range-minimum\", control);\r\n\r\n        //var $maxCanvas = $('<div>hola</div>');\r\n        //var $minCanvas = $('<div>hola</div>');\r\n\r\n        self.renderRangeControl($minCanvas, minControl);\r\n        self.renderRangeControl($maxCanvas, maxControl);\r\n    },\r\n\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        var self = this;\r\n        var minValue = self.minControl.getValue();\r\n        var maxValue = self.maxControl.getValue();\r\n\r\n        var value = {\r\n            min: minValue,\r\n            max: maxValue\r\n        };\r\n        return value;\r\n    },\r\n\r\n    renderRangeControl: function ($canvas, control){\r\n        $.when(control.render(\"render\")).done(function (html) {\r\n            $canvas.empty().append(html);\r\n            control.postRenderElement($canvas);\r\n        });\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Defines de min date an de max date to the range control\r\n     */\r\n    defineRangeControl: function (params) {\r\n        var self = this;\r\n\r\n        var dateMin = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var dateMax = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n\r\n        var minControl = new dateMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new dateMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n    getRenderProperties: function (typeRangeControl) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        if (typeRangeControl === \"min\") {\r\n            renderProperties.data.properties.displayName = \"From\";\r\n        } else {\r\n            renderProperties.data.properties.displayName = \"To\";\r\n        }\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n    \r\n    /**\r\n     * Defines de min money an de max money to the range control\r\n     */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var moneyMin = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var moneyMax = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new moneyMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new moneyMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n $.Class.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n    /**\r\n    * Defines de min number an de max number to the range control\r\n    */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var numberMin = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var numberMax = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new numberMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new numberMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Desktop definition of Action Launcher\r\n *\r\n * @author: Edward Morales\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.actionLauncher\", bizagi.rendering.actionLauncher.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.actionLauncher.extend(\"bizagi.rendering.desktop.actionLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n        var data = {};\r\n        var def = new $.Deferred();\r\n\r\n        if(mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        function appendContent(template, templateArguments) {\r\n            var control = self.getControl();\r\n            var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n            html = $.fasttmpl(template, templateArguments);\r\n            actionsContainer.append(html);\r\n\r\n            if(templateArguments.template) {\r\n                actionsContainer\r\n                        .find('.actions-container.actions-container-template')\r\n                        .append(templateArguments.template)\r\n            }\r\n            self.configureHandlers();\r\n            def.resolve(actionsContainer);\r\n        }\r\n\r\n        /**\r\n         * Define params to get list of actions\r\n         */\r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n                .pipe(function(actions) {\r\n                    actions = self.getPropertiesActionLaucher(actions);\r\n                    data.actions = actions;\r\n\r\n                    return (properties.templatetype != 'none') ? self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs) : null;\r\n                })\r\n                .done(function(templateData) {\r\n                    var response = data.actions;\r\n                    self.deferredActions.resolve(response);\r\n                    self.totalActions = bizagi.clone(response);\r\n                    var actions = bizagi.clone(response);\r\n                    var templateArguments = {};\r\n\r\n                    var moreActionsManager = self.moreActionsManager(actions);\r\n                    var isMoreActions = moreActionsManager.isMoreActions;\r\n                    actions = moreActionsManager.actions;\r\n                    self.lessActions = bizagi.clone(actions);\r\n\r\n                    if(properties.isHorizontal) {\r\n                        if(properties.templatetype != 'none') {\r\n                            $.when(self.engine.render($.extend(templateData, { isDefaultTemplate: properties.templatetype == 'default' }), self.processPropertyValueDataTmplArgs))\r\n                                    .done(function (template) {\r\n                                        templateArguments = {\r\n                                            actions: self.getPropertiesActionLaucher(actions),\r\n                                            template: template,\r\n                                            isMoreActions: isMoreActions,\r\n                                            moreActions: self.moreActions,\r\n                                            allowactions: properties.allowactions\r\n                                        };\r\n                                        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                        appendContent(template, templateArguments);\r\n                                    });\r\n                        } else {\r\n                            templateArguments = {\r\n                                actions: self.getPropertiesActionLaucher(actions),\r\n                                isMoreActions: isMoreActions,\r\n                                template: false,\r\n                                moreActions: self.moreActions,\r\n                                allowactions: properties.allowactions\r\n                            };\r\n                            template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                            appendContent(template, templateArguments);\r\n                        }\r\n\r\n                    } else {\r\n                        var actionsVertical = isMoreActions ? self.lessActions : self.totalActions;\r\n                        templateArguments = {\r\n                            actions: self.getPropertiesActionLaucher(actionsVertical),\r\n                            allowSearch: properties.allowSearch,\r\n                            isMoreActions: isMoreActions,\r\n                            isExpanded: false,\r\n                            moreButtonTitle: self.getResource(\"render-action-launcher-more-actions\")\r\n                        };\r\n                        template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                        appendContent(template, templateArguments);\r\n                    }\r\n                })\r\n                .fail(function(error) {\r\n                    def.fail(error);\r\n                });\r\n\r\n        self.engine.subscribe('onLoadDataNavigation', function (ev, params) {\r\n            bizagi.loader.start(\"entity-engine-view\").then(function () {\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,\r\n                    data: params,\r\n                    modalParameters: {\r\n                        title: params.data.displayName,\r\n                        refreshInbox: false\r\n                    },\r\n                    maximizeOnly: false\r\n                });\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },   \r\n\r\n    /**\r\n     * Check maxitems action and create sub list of actions\r\n     * in order to create contextual menu with them\r\n     * @param actions\r\n     * @return {{isMoreActions: boolean, actions: *}}\r\n     */\r\n    moreActionsManager: function(actions) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var isMoreActions = (actions.length > properties.maxItems) || false;\r\n        if(isMoreActions) {\r\n            var moreActionsTemp = actions.splice(0, properties.maxItems);\r\n            self.moreActions = bizagi.clone(actions);\r\n            actions = moreActionsTemp;\r\n        }\r\n\r\n        return {isMoreActions: isMoreActions, actions: actions};\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var control = self.getControl();\r\n            var actionLauncherControls = $(\".action-launcher-control\", control);\r\n            var moreVerticalButton = $(\".action-launcher-more-vertical\", control);\r\n            var properties = self.properties;\r\n\r\n            self.configureMoreActionsHandler();\r\n            /**\r\n             * Binding for a tooltip when max items is exceeded horizontal\r\n             */\r\n            moreVerticalButton.on(\"click\", function(event) {\r\n                var $button = $(this);\r\n                var isExpanded = false;\r\n                var moreButtonTitle = \"\";\r\n                var actionsVertical = {};\r\n                if($button.hasClass(\"expanded\")) {\r\n                    isExpanded = false;\r\n                    actionsVertical = self.lessActions;\r\n                    moreButtonTitle = self.getResource(\"render-action-launcher-more-actions\");\r\n                } else {\r\n                    isExpanded = true;\r\n                    actionsVertical = self.totalActions;\r\n                    moreButtonTitle = self.getResource(\"render-action-launcher-less-actions\");\r\n                }\r\n\r\n                var templateArguments = {\r\n                    actions: self.getPropertiesActionLaucher(actionsVertical),\r\n                    allowSearch: properties.allowSearch,\r\n                    isMoreActions: true,\r\n                    isExpanded: isExpanded,\r\n                    moreButtonTitle: moreButtonTitle\r\n                };\r\n                var template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                appendContent(template, templateArguments);\r\n\r\n                function appendContent(template, templateArguments) {\r\n                    var control = self.getControl();\r\n                    var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n                    actionsContainer.empty();\r\n                    var html = $.fasttmpl(template, templateArguments);\r\n                    actionsContainer.append(html);\r\n                    self.configureHandlers();\r\n                }\r\n\r\n            });\r\n\r\n            /**\r\n             * Binding for click action on buttons\r\n             */\r\n            actionLauncherControls.on(\"click\", function() {\r\n                var action = {\r\n                    guidProcess: $(this).data(\"guidprocess\"),\r\n                    guidAction: $(this).data(\"guidaction\"),\r\n                    displayName: $(this).data(\"display-name\"),\r\n                    actionType: $(this).data(\"action-type\"),\r\n                    xpathContext: $(this).data(\"xpathcontext\"),\r\n                    readOnlyForm: $(this).data(\"readonlyform\") || self.isReadOnlyForm(),\r\n                    guidEntity: self.properties.guidEntity,\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                };\r\n                self.onActionClicked(action);\r\n            });\r\n\r\n            /**\r\n             * Catch the typed text in the search field and filter the action list\r\n             */\r\n            $.expr[\":\"].FilterAction = function(entity, i, array) {\r\n                var search = array[3];\r\n                if(!search) {\r\n                    return false;\r\n                }\r\n                return new RegExp(search, \"i\").test($(entity).text());\r\n            };\r\n            $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n                var search = $(this).val();\r\n                $(\".ui-bizagi-render-actionLauncher-vertical-item\", control).show(0);\r\n                if(!moreVerticalButton.hasClass(\"expanded\")) {\r\n                    moreVerticalButton.trigger(\"click\");\r\n                    $(\"input#ui-bizagi-render-action-launcher-filter-input\").val(search);\r\n                    $(\"input#ui-bizagi-render-action-launcher-filter-input\").focus();\r\n                }\r\n                if(search) {\r\n                    $(\".ui-bizagi-render-actionLauncher-vertical-item\", control).not(\":FilterAction(\" + search + \")\").hide(0);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    isReadOnlyForm: function () {\r\n        var self = this;\r\n        var resultReadOnly = false;\r\n\r\n        if(self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            resultReadOnly = true;\r\n        }\r\n\r\n        return resultReadOnly;\r\n    },\r\n\r\n    configureMoreActionsHandler: function() {\r\n        var self = this,\r\n                control = self.getControl();\r\n        var moreButton = $(\".action-launcher-more\", control);\r\n\r\n        bizagi.loader.startAndThen(\"kendo\").then(function () {\r\n            self.tooltip = moreButton.kendoTooltip({\r\n                autoHide: false,\r\n                content: function (event) {\r\n                    var tmpl = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal-more\");\r\n                    var html = $.fasttmpl(tmpl, { actions: self.getPropertiesActionLaucher(self.moreActions) });\r\n                    return html;\r\n                },\r\n                show: function () {\r\n                    //add custom styles tooltip\r\n                    $(\"div[role='tooltip']\").addClass(\"bizagi-custom-tooltip-more-actions\");\r\n                    $(\".action-launcher-control-more\").off(\"click\").on(\"click\", function (event) {\r\n                        var action = {\r\n                            guidProcess: $(this).data(\"guidprocess\"),\r\n                            guidAction: $(this).data(\"guidaction\"),\r\n                            displayName: $(this).data(\"display-name\"),\r\n                            actionType: $(this).data(\"action-type\"),\r\n                            xpathContext: $(this).data(\"xpathcontext\"),\r\n                            readOnlyForm: $(this).data(\"readonlyform\") || false,\r\n                            xpathActions: self.properties.xpathActions || \"\"\r\n                        };\r\n                        self.onActionClicked(action);\r\n                        self.tooltip.hide();\r\n                    });\r\n                },\r\n                width: 185\r\n            }).data(\"kendoTooltip\");\r\n        });\r\n    },\r\n\r\n    onActionClicked: function(action) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties.multipleSelection;\r\n\r\n        if(multipleSelection) {\r\n            // If this is a form and has been queued, so open it\r\n            if(action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                //Open action\r\n                $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function(act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        }\r\n        else if(self.getValue().length > 0) {\r\n            self.showConfirmationDialog(action);\r\n        }\r\n        else {\r\n            $.when(self.actionManager(action)).done(function(act) {\r\n                self.executeAction(act);\r\n            });\r\n        }\r\n    },\r\n\r\n    notifyExecution: function(data, action) {\r\n        var self = this;\r\n        var notifications = new bizagi.INotifications();\r\n        if(data.response == \"success\") {\r\n            notifications.showSucessMessage(printf(self.getResource(\"render-action-launcher-success-excecution\"), action.displayName), null, {});\r\n        } else {\r\n            notifications.showErrorMessage(printf(self.getResource(\"render-action-launcher-failed-excecution\"), action.displayName), null, {});\r\n        }\r\n    },\r\n\r\n    processActionForm: function(action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function(data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: dialog.form.properties.xpathContext, //self.properties.xpathContext,\r\n                    idPageCache: dialog.form.properties.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).pipe(function(savedData) {\r\n                    if(!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        //self.addActionToQueue(action);\r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function(data) {\r\n\r\n            }\r\n        });\r\n\r\n        var paramsRender = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        };\r\n        if (action.actionType === \"Form\") {\r\n            paramsRender.contextType = \"entitytemplate\";\r\n            paramsRender.xpathContext = undefined;\r\n            paramsRender.guidEntity = action.guidEntity;\r\n            paramsRender.rewriteContextType = true;\r\n        } \r\n\r\n        dialog.render(paramsRender);\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    processActionFormCollection: function(action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext != \"\") ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext != \"\") ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\r\n\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function(data) {\r\n                if(action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).pipe(function(savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).pipe(function(savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function(data) {\r\n\r\n            }\r\n        });\r\n\r\n        dialog.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": bizagi.context.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function(args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n\r\n\r\n        var dialog = new bizagi.rendering.dialog.startForm(self.dataService, self.renderFactory, {\r\n            //showSaveButton: properties.editable,\r\n            maximized: properties.maximized,\r\n            title: args.title || \"\",\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function(data) {\r\n                form.startLoading();\r\n\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).pipe(function(savedData) {\r\n                    form.endLoading();\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        dialog.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    executeAction: function(action) {\r\n        var self = this;\r\n\r\n        if(self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\"), null, false)).done(function(response) {\r\n                self.executeActionImmediately(action);\r\n            });\r\n        }\r\n        else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function(action) {\r\n        var self = this;\r\n        self.confirmTemplate = self.renderFactory.getTemplate(\"render-actionLauncher-confirm\");\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n        var confirmContent = $.tmpl(self.confirmTemplate, {confirmationMessage: message});\r\n        var confirmContentParams = {\r\n            resizable: false,\r\n            modal: true,\r\n            title: \"Bizagi\",\r\n            buttons: []\r\n        };\r\n        confirmContentParams.buttons = [\r\n            {\r\n                text: bizagi.localization.getResource(\"render-boolean-yes\"),\r\n                click: function() {\r\n                    self.setValue([]);\r\n                    $.when(self.actionManager(action)).done(function(act) {\r\n                        self.executeAction(act);\r\n                    });\r\n                    $(this).dialog(\"close\");\r\n                }\r\n            },\r\n            {\r\n                text: bizagi.localization.getResource(\"render-boolean-no\"),\r\n                click: function() {\r\n                    $(this).dialog(\"close\");\r\n                }\r\n            }\r\n        ];\r\n        $(confirmContent).dialog(confirmContentParams);\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n        $.when(self.deferredActions).done(function(listOfActions) {\r\n            var getMappingAction = function(guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function(key, value) {\r\n                    if(value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n                return mapping;\r\n\r\n            };\r\n            $.each(data, function(key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if(data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if(data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if(data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n            $.when($.fasttmpl(template, {actions: data})).done(function(html) {\r\n                actionsToExecuteContainer.empty();\r\n                actionsToExecuteContainer.append(html);\r\n                var removeActionSelector = $(\".action-to-execute-control i\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n                removeActionSelector.bind(\"click\", function() {\r\n                    var index = $(this).parent().data(\"index\");\r\n                    self.removeActionToQueue(index);\r\n                });\r\n                openActionSelector.bind(\"click\", function() {\r\n                    var target = $(this).parent();\r\n                    var type = target.data(\"actiontype\");\r\n                    var guidprocess = target.data(\"guidprocess\");\r\n                    var idStartScope = target.data(\"idstartscope\");\r\n                    var title = target.data(\"title\");\r\n                    var xpathContext = target.data(\"xpathcontext\");\r\n                    var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                    var idEntity = target.data(\"identity\") || \"\";\r\n                    var guidAction = target.data(\"guidaction\");\r\n                    var recordXpath = xpathContext || self.properties.xpathContext;\r\n                    switch(type) {\r\n                        case \"Process\":\r\n                            if(idStartScope) {\r\n                                self.processStartForm({\r\n                                    guidprocess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    title: title,\r\n                                    xpathContext: xpathContext,\r\n                                    recordXpath: recordXpath\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"Form\":\r\n\r\n                            var action = {\r\n                                guidProcess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                editMode: true,\r\n                                xpathContext: xpathContext,\r\n                                readOnlyForm: readOnlyForm,\r\n                                idEntity: idEntity,\r\n                                recordXpath: recordXpath\r\n                            };\r\n\r\n                            if(action.xpathContext) {\r\n                                self.processActionFormCollection(action);\r\n                            } else {\r\n                                //Add parameters if action form\r\n                                var extraParameters = {};\r\n                                var dataAction = self.value.filter(function (item) {\r\n                                    return item.guidAction == guidAction;\r\n                                });\r\n                                if (dataAction.length > 0) {\r\n                                    extraParameters = {\r\n                                        actionType: \"Form\",\r\n                                        contextType: \"entitytemplate\",\r\n                                        guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                    }\r\n                                }\r\n                                self.processActionForm($.extend(action, extraParameters));\r\n                            }\r\n                            break;\r\n                        case \"Rule\":\r\n                            // Rules dont have forms or something like that\r\n                            break;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n        if(self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/**\r\n * Desktop definition of range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.range\", bizagi.rendering.range.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.range\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n    },\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n    }\r\n\r\n});","/**\r\n * Desktop definition of range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeDate\", bizagi.rendering.rangeDate.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeDate.extend(\"bizagi.rendering.desktop.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.defineRangeControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeMoney\", bizagi.rendering.rangeMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeMoney.extend(\"bizagi.rendering.desktop.rangeMoney\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n        var self = this;\r\n        self.defineRangeControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t}\r\n});","/**\r\n * Desktop definition of range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n // Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeNumber\", bizagi.rendering.rangeNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeNumber.extend(\"bizagi.rendering.desktop.rangeNumber\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\t    \r\n\t    this.defineRangeControl();\r\n\t}\r\n});","/**\r\n * Base definition of entity template\r\n *\r\n * @author: Andres Fernando Muñoz\r\n * based on action launcher control\r\n */\r\n$.Class.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\") ? true : data.properties.allowactions;\r\n\r\n        if(!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n        } else if(typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate-design\");\r\n            html = $.fasttmpl(template, {});\r\n        }\r\n        else if(self.properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate\");\r\n            html = $.fasttmpl(template, {allowactions: self.properties.allowactions});\r\n        }\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        // TODO: write functionality\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n});","/**\r\n * Desktop definition of entity template\r\n *\r\n * @author: Andrés Fernando Muñoz\r\n * based on action launcher control\r\n */\r\n\r\nbizagi.rendering.desktop.actionLauncher.extend(\"bizagi.rendering.desktop.entityTemplate\", {}, {\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this,\r\n            data = data || {},\r\n            properties = data.properties || {};\r\n\r\n        self._super(data);\r\n        self.properties.allowactions = (typeof properties.allowactions != \"undefined\") ? bizagi.util.parseBoolean(properties.allowactions) : false;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\") ? properties.templatetype : 'default';\r\n    },\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n        var control = self.getControl();\r\n\r\n        if (mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        // Define params to get template\r\n        $.when(self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs))\r\n            .done(function (templateData) {\r\n\r\n                // Put the guidTemplate in the request for the multiaction loadtemplate.\r\n                if (typeof templateData.templateGuid !== \"undefined\" && templateData.templateGuid) {\r\n                    templateData.isDefaultTemplate = false;\r\n                    templateData.guidTemplate = templateData.templateGuid;\r\n                    delete templateData[\"templateGuid\"];\r\n                }\r\n\r\n                $.when(self.engine.render(templateData, self.processPropertyValueDataTmplArgs)).done(function (template) {\r\n                    var htmlTemplate = template;\r\n                    var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n\r\n                    if (properties.allowactions) {\r\n                        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs)).done(function(response) {\r\n                            self.deferredActions.resolve(response);\r\n                            var actions = bizagi.clone(response);\r\n                            var moreActionsManager = self.moreActionsManager(actions);\r\n                            var isMoreActions = moreActionsManager.isMoreActions;\r\n                            actions = moreActionsManager.actions;\r\n\r\n                            var html = $.fasttmpl(template, {actions: actions, template: true, isMoreActions: isMoreActions, allowactions: properties.allowactions});\r\n                            actionsContainer.append(html);\r\n                            actionsContainer.find('.actions-container.actions-container-template').append(htmlTemplate);\r\n\r\n                            self.configureHandlers();\r\n                        }).fail(function(error) {\r\n                            //TODO: do something\r\n                        });\r\n                    }\r\n                    else {\r\n                        var html = $.fasttmpl(template, {template: true, allowactions: properties.allowactions});\r\n\r\n                        actionsContainer.append(html);\r\n                        actionsContainer.find('.actions-container.actions-container-template').append(htmlTemplate);\r\n                    }\r\n                });\r\n            }).fail(function(error) {\r\n            //TODO: do something\r\n        });\r\n        self.engine.subscribe('onLoadDataNavigation', function (ev, params) {\r\n            bizagi.loader.start(\"entity-engine-view\").then(function () {\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,\r\n                    data: params,\r\n                    modalParameters: {\r\n                        refreshInbox: false,\r\n                        title: params.data.displayName\r\n                    },\r\n                    maximizeOnly: false\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var control = self.getControl();\r\n            var properties = self.properties;\r\n            var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n            // Binding for a tooltip when max items is excedded\r\n            self.configureMoreActionsHandler();\r\n\r\n            // Binding for click action on buttons\r\n            entityTemplateControls.on(\"click\", function() {\r\n                var action = {\r\n                    guidProcess: $(this).data(\"guidprocess\"),\r\n                    guidAction: $(this).data(\"guidaction\"),\r\n                    displayName: $(this).data(\"display-name\"),\r\n                    actionType: $(this).data(\"action-type\"),\r\n                    xpathContext: $(this).data(\"xpathcontext\"),\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                };\r\n\r\n                if (action.actionType === \"Form\") {\r\n                    action.xpathContext = undefined;\r\n                    action.contextType = \"entitytemplate\";\r\n                    action.guidEntity = self.properties.guidEntity;\r\n                }\r\n                self.onActionClicked(action);\r\n            });\r\n        }\r\n\r\n\r\n    }\r\n});","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.checkList\", bizagi.rendering.checkList.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.checkList.extend(\"bizagi.rendering.desktop.checkList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base \r\n        this._super();\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n        // Apply plugin\r\n        $(\".ui-bizagi-render-checkList-label\", self.checkListGroup).check();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            //todo: change bind type for IE\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = $(this).is(\":checked\");\r\n                self.updateDisplay($(this),checked);\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = $(this).is(\":checked\");\r\n                self.updateDisplay($(this),checked);\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        }\r\n    },\r\n\r\n    updateDisplay: function (element,checked) {\r\n        var self = this;\r\n        var item = element.closest(\".ui-bizagi-render-checkList-item\");\r\n        if (checked) {\r\n            item.addClass('checked');\r\n        } else {\r\n            item.removeClass('checked');\r\n        }\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).check(\"uncheckItem\");\r\n        }\r\n        else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).removeAttr(\"checked\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue : function (value){\r\n        var self = this;\r\n    }\r\n\r\n});\r\n","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.desktop.checkList.extend(\"bizagi.rendering.desktop.activityCheckList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n        self.addButton = $(\".ui-bizagi-render-checkList-add-item\", self.element);\r\n        self.newItemName = $(\".ui-bizagi-render-checkList-input-name\", self.control);\r\n        self.separator = $(\".ui-bizagi-render-checkList-separator\", self.element);\r\n        self.goalActivity = $(\".ui-bizagi-render-checkList-goal-activity\", self.element);\r\n        self.additionalElements(); \r\n        self.notifyLoadItems();\r\n\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"checkList-disabled\");\r\n        return $.fasttmpl(template, { items: this.value });\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var activityWorkTitle = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        var activityFormTitle = this.getResource(\"render-activity-check-list-form\");\r\n\r\n        if (!(self.addButton && self.addButton.length > 0)) {\r\n            var $divContainer = $(\"<div/>\").addClass(\"ui-bizagi-render-checkList-add-item\");\r\n            $divContainer.append($(\"<h4 />\").text(bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\")));\r\n            $divContainer.append($(\"<button class=''/>\").text(\"+ \" +  bizagi.localization.getResource(\"workportal-project-plan-activity-action-add\")));\r\n            self.element.prepend($divContainer);\r\n        }\r\n        if (!(self.separator && self.separator.length > 0)) {\r\n            self.element.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-separator\").append($(\"<span/>\")));\r\n        }\r\n        if (!(self.goalActivity && self.goalActivity.length > 0)) {\r\n            if(self.properties.activityDescription && self.properties.activityDescription !== \"\"){\r\n                self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-goal-activity\").append(\"<h3><span class='ui-bizagi-wp-bold'>\" +\r\n                bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") +\r\n                \": </span><span>\" + self.properties.activityDescription  + \"</span></h3>\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            self.triggerGlobalHandler(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n        $(\".ui-bizagi-render-checkList-add-item button\", self.element).unbind(\"click\").click(function () {\r\n            var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".ui-bizagi-render-checkList-input-name\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\".item-button.delete\", self.checkListGroup).bind(\"click\", function (evt, ui) {\r\n            var itemId = $(this).closest(\".ui-bizagi-render-checkList-item\").data(\"item-guid\");\r\n            self.deleteItem(itemId);\r\n        });\r\n\r\n        $(\"label.item-name\", self.checkListGroup).bind(\"click\", function (evt, ui) {\r\n            var itemSelected = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemId = itemSelected.data(\"item-guid\");\r\n            self.selectItem(itemId);\r\n        });\r\n    },\r\n\r\n    selectItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items[i].selected = true;\r\n            } else {\r\n                self.properties.items[i].selected = false;\r\n            }\r\n        }\r\n        self.repaintControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\");\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length ; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i,1);\r\n                break;\r\n            }\r\n        }\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        itemSelectedName.focus();\r\n        itemSelectedName.blur(function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n            else {\r\n                self.properties.items.splice(self.properties.items.length - 1, 1);\r\n                self.setValue(self.properties.items);\r\n                self.repaintControl();\r\n                self.configureHandlers();\r\n            }\r\n        });\r\n        itemSelectedName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                var newItemName = itemSelectedName.val();\r\n                if (newItemName && newItemName !== \"\") {\r\n                    self.addItem();\r\n                    self.prepareNewItem();\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n        self.addButton.show();\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var checkListHtml = self.renderControl();\r\n        $(\".ui-bizagi-render-checkList\", self.control).replaceWith(checkListHtml);\r\n        self.postRender();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            control = self.getControl(),\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) { \r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 0;\r\n        }\r\n\r\n        var html = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        $(\".ui-bizagi-render-checkList-activity-work span\", self.element).html(html);\r\n        self.triggerGlobalHandler(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n    },\r\n\r\n    getValue: function (data) {\r\n        var self = this;\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /**\r\n     * Validate if all checked items on activity\r\n     * @returns {boolean}\r\n     */\r\n    allCheckedItems: function (){\r\n        var self = this;\r\n        var response = false;\r\n        if(Array.isArray(self.value)){\r\n            response = self.value.every(function(item){\r\n                return item.resolved == true;\r\n            });\r\n        }\r\n        return response;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        var validationResolvedItems = true;\r\n        var lastActionButton = self.getFormContainer().getLastActionButton();\r\n        if(lastActionButton && lastActionButton.action == \"next\"){\r\n            validationResolvedItems = self.allCheckedItems();\r\n        }\r\n\r\n        if (self.controlValueIsChanged() && validationResolvedItems) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    var data = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                    renderValues[properties.xpath] = JSON.stringify(data);\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        var valid = true;\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                valid = false;\r\n                break;\r\n            }\r\n        }\r\n        return valid;\r\n    }\r\n\r\n});\r\n","/**\r\n * Base definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n\t/*\r\n\t * Constructor\r\n\t */\r\n\tinit: function(params) {\r\n\t\t// Call base\r\n\t\tthis._super(params);\r\n\t},\r\n\r\n\t/*\r\n\t * Initialize the control with data provided\r\n\t */\r\n\tinitializeData: function(data) {\r\n\t\tvar self = this;\r\n\t\t// Call base\r\n\t\tthis._super(data);\r\n\t\tvar form = self.getFormContainer();\r\n\t\tthis.typeForm = form.properties.typeForm || \"\";\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\tself.deferredActions = new $.Deferred();\r\n\t\tself.deferredActions.promise();\r\n\r\n\t\tself.properties.valueWidth = 100;\r\n\t\tself.properties.displayType = \"value\";\r\n\t\tself.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\") ? false : data.properties.allowSearch;\r\n\t\tself.properties.additionalXpath = self.properties.additionalXpath || [];\r\n\r\n\t\tif(!self.properties.value) {\r\n\t\t\tself.properties.value = self.value = [];\r\n\t\t\tself.properties.originalValue = [];\r\n\t\t} else if(typeof self.properties.value == \"string\") {\r\n\t\t\tself.properties.value = self.value = JSON.parse(self.properties.value);\r\n\t\t}\r\n\r\n\t\t// Data of get process property value\r\n\t\tself.processPropertyValueArgs = {\r\n\t\t\t\"pcaseId\": self.getIdCase(),\r\n\t\t\t\"pguidEntity\": self.properties.guidEntity,\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"data\",\r\n\t\t\t\"ptags\": self.getTagList(self.properties.tagslist),\r\n\t\t\t\"additionalXpaths\": self.properties.additionalXpath\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Send processpropertyvalue in order to execute an Action\r\n\t * This method is used when this control stay in Summary form or Global form\r\n\t * @param action\r\n\t */\r\n\texecuteActionImmediately: function(action) {\r\n\t\tvar self = this;\r\n\t\t//Execute action immediately\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\tvar processPropertyValueExecuteConstructor = {\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"executeConstructor\",\r\n\t\t\t\"psurrogatedKey\": self.properties.surrogatedKey,\r\n\t\t\t\"pguidConstructor\": action.guidConstructor,\r\n\t\t\t\"pparameters\": JSON.encode({\r\n\t\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\t\"pactionXpath\": self.properties.xpathActions,\r\n\t\t\t\t\"idPageCache\": action.idPageCache\r\n\t\t\t})\r\n\t\t};\r\n\r\n\t\tself.dataService.executeActions(processPropertyValueExecuteConstructor).done(function(data) {\r\n\t\t\tself.notifyExecution(data.response, action);\r\n\t\t}).fail(function(error) {\r\n\t\t\t// TODO: Create generic mechanism to send notifications\r\n\t\t\tself.notifyExecution(\"Error\", action);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * notify action execution status\r\n\t * @param response\r\n\t */\r\n\tnotifyExecution: function(response, actionName) {\r\n\t\t// To override in each device\r\n\t},\r\n\r\n\t/**\r\n\t * Render control in read only mode: properties.editable = false\r\n\t * @return {*}\r\n\t */\r\n\trenderReadOnly: function() {\r\n\t\treturn this.renderControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Make a postrender of readonly control\r\n\t */\r\n\tpostRenderReadOnly: function() {\r\n\t\tthis.properties.readOnly = true;\r\n\t\tthis.postRender();\r\n\t},\r\n\r\n\t/**\r\n\t * Template method to implement in each children to customize each control\r\n\t * @return {string}\r\n\t */\r\n\trenderControl: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar template;\r\n\t\tvar html = \"\";\r\n\r\n\t\t// Render template\r\n\t\tif(mode == \"design\") {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-design\");\r\n\t\t\tvar params = {\r\n\t\t\t\ttype: properties.type,\r\n\t\t\t\tallowSearch: properties.allowSearch\r\n\t\t\t};\r\n\t\t\thtml = $.fasttmpl(template, params);\r\n\t\t} else if(properties.surrogatedKey) {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher\");\r\n\t\t\thtml = $.fasttmpl(template);\r\n\t\t}\r\n\t\treturn html;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Public method to determine if a value is valid or not\r\n\t * @param invalidElements\r\n\t * @return {*}\r\n\t */\r\n\tisValid: function(invalidElements) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\t\t// Call base\r\n\t\tvar bValid = this._super(invalidElements);\r\n\t\tvar value = self.getValue();\r\n\t\t// TODO: write functionality\r\n\t\treturn bValid;\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the value in the rendered control\r\n\t * @param value\r\n\t */\r\n\tsetDisplayValue: function(value) {\r\n\t\tvar self = this;\r\n\t\t// Set internal value\r\n\t\tself.setValue(value, false);\r\n\t},\r\n\r\n\t/**\r\n\t * Process an action\r\n\t * @param action\r\n\t */\r\n\tactionManager: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar guidProcess = action.guidObject || \"\";\r\n\t\tvar def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n\t\t/**\r\n\t\t/**\r\n\t\t * Check if action is a process\r\n\t\t */\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\t// Verify if case has startform\r\n\t\t\t\tvar params = {\r\n\t\t\t\t\tguidWFClass: guidProcess\r\n\t\t\t\t};\r\n\r\n\t\t\t\t$.when(self.dataService.hasStartForm(params)).done(function(result) {\r\n\t\t\t\t\tif(result.hasStartForm) {\r\n\t\t\t\t\t\t// Open a dialog with startform and wait for Scope\r\n\t\t\t\t\t\t$.when(self.processStartForm({\r\n\t\t\t\t\t\t\tguidprocess: guidProcess,\r\n\t\t\t\t\t\t\ttitle: action.displayNamee,\r\n                            recordXpath: action.recordXpath\r\n\t\t\t\t\t\t})).done(function(idStartScope) {\r\n\t\t\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\tdef.resolve(action);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\t$.when(self.processActionForm(action)).done(function(idStartScope) {\r\n\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Add actions within value object\r\n\t * @param action\r\n\t */\r\n\taddActionToQueue: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar actionsList = self.getValue();\r\n\t\tvar formParams = self.getFormContainer().getParams();\r\n\t\t\r\n\t\taction.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n\t\t\t\t};\r\n                if (typeof action.idStartScope !== \"undefined\") {\r\n                    action.params.idStartScope = action.idStartScope;\r\n                }\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tidStartScope: action.idStartScope,\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tentityXpath: self.properties.xpathActions,\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n\t\t\t\t\tidEntity: action.idEntity,\r\n\t\t\t\t\tguidEntity: action.guidEntity\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t//TODO\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tactionsList.push(action);\r\n\t\tself.setValue(actionsList);\r\n\t\tself.setDisplayValue(actionsList);\r\n\t},\r\n\r\n\t/**\r\n\t * Remove action within value object\r\n\t * @param index\r\n\t */\r\n\tremoveActionToQueue: function(index) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvalue.splice(index, 1);\r\n\t\tself.setValue(value);\r\n\t\tself.setDisplayValue(value);\r\n\t},\r\n\t/**\r\n\t * Add the render data to the given collection in order to send data to the server\r\n\t * @param renderValues\r\n\t */\r\n\tcollectData: function(renderValues) {\r\n\t\tvar self = this;\r\n\t\tif(self.controlValueIsChanged()) {\r\n\t\t\tvar properties = self.properties;\r\n\t\t\tvar xpath = properties.xpath;\r\n\t\t\tvar controlValue = self.getValue();\r\n\t\t\tvar actions = [];\r\n\t\t\t$.each(controlValue, function(index, value) {\r\n\t\t\t\tvar action = {};\r\n\t\t\t\taction.params = value.params || {};\r\n\t\t\t\taction.guidAction = value.guidObject || value.guidAction;\r\n\t\t\t\taction.displayName = value.displayName;\r\n\t\t\t\taction.guidConstructor = value.guidConstructor;\r\n\t\t\t\taction.actionType = value.actionType;\r\n\t\t\t\taction.xpathContext = value.xpathContext;\r\n\t\t\t\taction.guidEntity = value.guidEntity;\r\n\t\t\t\tactions.push(action);\r\n\t\t\t});\r\n\t\t\trenderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Util to count how many actions are there\r\n\t * @param action\r\n\t * @return {number}\r\n\t */\r\n\tcountSameActions: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvar count = 0;\r\n\t\t$.each(value, function(key, value) {\r\n\t\t\tif(value.guidAction == action.guidAction) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn count;\r\n\t},\r\n\r\n\t/**\r\n\t * Get list of tags\r\n\t * @param taglist\r\n\t * @return {Array}\r\n\t */\r\n\tgetTagList: function(taglist) {\r\n\t\ttaglist = taglist || [];\r\n\t\tvar result = [];\r\n\r\n\t\tfor(var i = taglist.length; i > 0; i--) {\r\n\t\t\tresult.push(taglist[i - 1].value);\r\n\t\t}\r\n\t\treturn (result.length > 0) ? result : \"\";\r\n\t}\r\n});","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n // Extends from render desktop base\r\n bizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.polymorphicLauncher\", bizagi.rendering.polymorphicLauncher.prototype);\r\n // Extends itself\r\n bizagi.rendering.desktop.polymorphicLauncher.extend(\"bizagi.rendering.desktop.polymorphicLauncher\", {}, {\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar html, template;\r\n\t\tvar def = new $.Deferred();\r\n\r\n\t\tif(mode == \"design\" || !self.properties.surrogatedKey) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t/**\r\n\t\t * Render a template\r\n\t\t * @param template\r\n\t\t * @param templateArguments\r\n\t\t */\r\n\t\tfunction appendContent(template, templateArguments) {\r\n\t\t\tvar control = self.getControl();\r\n\t\t\tvar actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\t\t\thtml = $.fasttmpl(template, templateArguments);\r\n\t\t\tactionsContainer.append(html);\r\n\t\t\tif(self.properties.readOnly !== true) {\r\n\t\t\t\tself.configureHandlers();\r\n\t\t\t}\r\n\r\n\t\t\tdef.resolve(actionsContainer);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Define params to get list of actions\r\n\t\t */\r\n\t\t$.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function(response) {\r\n\t\t\t// Convert default response to tree data structure\r\n\t\t\tresponse = self.dataService.serializePolymorphicActions(response);\r\n\r\n\r\n\t\t\tself.totalActions = bizagi.clone(response);\r\n\t\t\tvar actions = bizagi.clone(response);\r\n\r\n\t\t\tself.lessActions = bizagi.clone(actions);\r\n\r\n\r\n\t\t\t// NOTE: Code extracted\r\n\t\t\tvar templateArguments = {\r\n\t\t\t\tactions: actions,\r\n\t\t\t\tallowSearch: properties.allowSearch,\r\n\t\t\t\ttreeActionsList: self.getTreeItems(actions)\r\n\t\t\t};\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n\t\t\tappendContent(template, templateArguments);\r\n\r\n\t\t}).fail(function(error) {\r\n\t\t\tdef.fail(error);\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Get rendered html of each node of constructors\r\n\t * @param actions\r\n\t * @param level\r\n\t * @return {string}\r\n\t */\r\n\tgetTreeItems: function(actions, level) {\r\n\t\tvar self = this;\r\n        var item = \"<ul>\";\r\n\t\tvar templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n\t\tactions = actions || {};\r\n\t\tlevel = level || 1;\r\n\r\n\t\t$.each(actions, function(key, value) {\r\n\t\t\titem += $.fasttmpl(templateTreeItem, value);\r\n\r\n\t\t\tif(value.children) {\r\n\t\t\t\titem += self.getTreeItems(value.children, level + 1);\r\n\t\t\t}\r\n\t\t});\r\n        item += \"</ul>\";\r\n\t\treturn item;\r\n\t},\r\n\r\n\t/**\r\n\t * Add binding to html elements\r\n\t */\r\n\tconfigureHandlers: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var actionLauncherControls = $(\".ui-bizagi-render-polymorphicLauncher-list li>span\", control);\r\n\r\n            //Binding for click action on buttons\r\n            actionLauncherControls.on(\"click\", function() {\r\n                var $targetData = $(this).parent();\r\n                var action = {\r\n                    guidEntity: $targetData.data(\"guidentity\"),\r\n                    guidObject: $targetData.data(\"guidobject\"),\r\n                    guidConstructor: $targetData.data(\"guidconstructor\"),\r\n                    displayName: $targetData.data(\"display-name\"),\r\n                    actionType: $targetData.data(\"action-type\"),\r\n                    xpathContext: $targetData.data(\"xpathcontext\")\r\n                };\r\n                self.onActionClicked(action);\r\n            });\r\n            //Catch the typed text in the search field and filter the action list\r\n            $.expr[\":\"].FilterAction = function(entity, i, array) {\r\n                var search = array[3];\r\n                if(!search) {\r\n                    return false;\r\n                }\r\n                return new RegExp(search, \"i\").test($(entity).text());\r\n            };\r\n            $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n                var search = $(this).val();\r\n\r\n                if(search) {\r\n                    // Hide all nodes\r\n                    $(\"li\", control).hide(0);\r\n                    // Show only the nodes that match with the respective search pattern\r\n                    $(\"li[data-hasconstructor='true']\", control).filter(\":FilterAction(\" + search + \")\").show(0, function() {\r\n                        var actualValue = $(\"label\", this).html();\r\n                        var $node = $(this);\r\n                        var path = $node.data(\"parents\") + $node.data(\"title\");\r\n                        // Set value to cache\r\n                        if(!$node.data(\"cachedvalue\")) {\r\n                            $node.data(\"cachedvalue\", actualValue);\r\n                        }\r\n                        $(\"label\", this).html(path);\r\n                    });\r\n                } else {\r\n                    $(\"li\", control).show(0, function() {\r\n                        var cachedValue = $(this).data(\"cachedvalue\");\r\n                        $(\"label\", this).html(cachedValue);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\t},\r\n\r\n\t/**\r\n\t * Execute an Action\r\n\t * @param action\r\n\t */\r\n\tonActionClicked: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\tself.executeAction(act);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show a message when action has been executed\r\n\t * @param status\r\n\t * @param action\r\n\t */\r\n\tnotifyExecution: function(status, action) {\r\n\t\tvar self = this;\r\n\t\tvar notifications = new bizagi.INotifications();\r\n\t\tif(status == \"success\") {\r\n\t\t\tnotifications.showSucessMessage(printf(self.getResource(\"render-action-launcher-success-excecution\"), action.displayName), null, {});\r\n\t\t} else {\r\n\t\t\tnotifications.showErrorMessage(printf(self.getResource(\"render-action-launcher-failed-excecution\"), action.displayName), null, {});\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show a dialog with a form\r\n\t * @param action\r\n\t * @return {*}\r\n\t */\r\n\tprocessActionForm: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar xpathContext = action.xpathContext || \"\";\r\n\t    var surrogatedKey;\r\n\t\tif (self.properties.type !== \"polymorphicLauncher\") {\r\n\t\t    surrogatedKey = (typeof self.properties.surrogatedKey == \"object\" && self.properties.surrogatedKey.length > 1) ? self.properties.surrogatedKey : self.properties.surrogatedKey[0];\r\n\t\t}\r\n\t\t\r\n\t\tvar recordXpath = self.properties.recordXpath;\r\n\t\t\r\n\t\t// Show dialog with new form after that\r\n\t\tvar dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n\t\t\ttitle: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n\t\t\tshowSaveButton: true,\r\n\t\t\tcancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tvar pageCache = data.idPageCache;\r\n\t\t\t\tdata.idPageCache = null;\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: dialog.form.properties.xpathContext, //self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: pageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).pipe(function(savedData) {\r\n\t\t\t\t\tif(!action.editMode && self.countSameActions(action) == 0) {\r\n\t\t\t\t\t\taction.idStartScope = savedData.IdScope;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonCancel: function(data) {\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.render({\r\n\t\t\t\"idForm\": action.guidObject,\r\n\t\t\t\"contextType\": \"entity\",\r\n\t\t\t\"guidEntity\": action.guidEntity,\r\n\t\t\t\"idCase\": self.properties.caseId,\r\n\t\t\t\"idWorkitem\": form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n\t\t\t\"additionalXpaths\": additionalXpaths,\r\n\t\t\t//\"xpathContext\": xpathContext,\r\n\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\"surrogateKey\": surrogatedKey,\r\n\t\t\t\"recordXpath\": recordXpath\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Process a start form\r\n\t * @param args\r\n\t * @return {*}\r\n\t */\r\n\tprocessStartForm: function(args) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar def = new $.Deferred();\r\n\t    var surrogatedKey;\r\n\t\tif (self.properties.type !== \"polymorphicLauncher\") {\r\n\t\t    surrogatedKey = (typeof self.properties.surrogatedKey == \"object\" && self.properties.surrogatedKey.length > 1) ? self.properties.surrogatedKey : self.properties.surrogatedKey[0];\r\n\t\t}\r\n\t\targs = args || {};\r\n\r\n\t\tvar dialog = new bizagi.rendering.dialog.startForm(self.dataService, self.renderFactory, {\r\n\t\t\t//showSaveButton: properties.editable,\r\n\t\t\tmaximized: properties.maximized,\r\n\t\t\ttitle: args.title || \"\",\r\n\t\t\tsaveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tform.startLoading();\r\n\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: data.idPageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).pipe(function(savedData) {\r\n\t\t\t\t\tform.endLoading();\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.render({\r\n\t\t\tguidprocess: args.guidprocess,\r\n\t\t\tidStartScope: args.idStartScope,\r\n\t\t\tidCase: self.properties.caseId,\r\n            idWorkitem: form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\tsurrogatedKey: surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Execute and action if a form is global form or summary, or send to queue\r\n\t * @param action\r\n\t */\r\n\texecuteAction: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\tif (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n\t\t\t$.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\"), null, false)).done(function(response) {\r\n\t\t\t\tself.executeActionImmediately(action);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tself.addActionToQueue(action);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show confirmation dialog\r\n\t * @param action\r\n\t */\r\n\tshowConfirmationDialog: function(action) {\r\n\t\tvar self = this;\r\n\t\tself.confirmTemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-confirm\");\r\n\t\tvar message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\t\tvar confirmContent = $.tmpl(self.confirmTemplate, {confirmationMessage: message});\r\n\t\tvar confirmContentParams = {\r\n\t\t\tresizable: false,\r\n\t\t\tmodal: true,\r\n\t\t\ttitle: \"Bizagi\",\r\n\t\t\tbuttons: []\r\n\t\t};\r\n\t\tconfirmContentParams.buttons = [\r\n\t\t\t{\r\n\t\t\t\ttext: bizagi.localization.getResource(\"render-boolean-yes\"),\r\n\t\t\t\tclick: function() {\r\n\t\t\t\t\tself.setValue([]);\r\n\t\t\t\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\t\t\t\tself.executeAction(act);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: bizagi.localization.getResource(\"render-boolean-no\"),\r\n\t\t\t\tclick: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\t\t$(confirmContent).dialog(confirmContentParams);\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t\tvar actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n\t\tvar template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t$.when($.fasttmpl(template, {actions: data})).done(function(html) {\r\n\t\t\tactionsToExecuteContainer.empty();\r\n\t\t\tactionsToExecuteContainer.append(html);\r\n\t\t\tvar removeActionSelector = $(\".action-to-execute-control i\", actionsToExecuteContainer);\r\n\t\t\tvar openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n\t\t\tremoveActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar index = $(this).parent().data(\"index\");\r\n\t\t\t\tself.removeActionToQueue(index);\r\n\t\t\t});\r\n\t\t\topenActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar $target = $(this).parent();\r\n\t\t\t\tvar type = $target.data(\"actiontype\");\r\n\t\t\t\tvar guidprocess = $target.data(\"guidprocess\");\r\n\t\t\t\tvar idStartScope = $target.data(\"idstartscope\");\r\n\t\t\t\tvar title = $target.data(\"title\");\r\n\t\t\t    var xpathContext = $target.data(\"xpathcontext\");\r\n\t\t\t\tvar idEntity = $target.data(\"identity\") || \"\";\r\n\t\t\t\tvar guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase \"Process\":\r\n\t\t\t\t\t\tif(idStartScope) {\r\n\t\t\t\t\t\t\tself.processStartForm({\r\n\t\t\t\t\t\t\t\tguidprocess: guidprocess,\r\n\t\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\t\txpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Form\":\r\n\t\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\tguidProcess: guidprocess,\r\n\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\teditMode: true,\r\n\t\t\t\t\t\t\txpathContext: xpathContext,\r\n\t\t\t\t\t\t\tidEntity: idEntity,\r\n\t\t\t\t\t\t\tguidEntity: guidEntity,\r\n\t\t\t\t\t\t\tguidObject: guidprocess\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tself.processActionForm(action);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rule\":\r\n\t\t\t\t\t\t// Rules dont have forms or something like that\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show container if it has actions\r\n\t */\r\n\tconfigureQueueVisibility: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t\tvar actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n\t\tvar actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n\t\tif(self.getValue().length > 0) {\r\n\t\t\tactionsToExecuteContainer.show();\r\n\t\t\tactionsToExecuteTitle.show();\r\n\t\t} else {\r\n\t\t\tactionsToExecuteContainer.hide();\r\n\t\t\tactionsToExecuteTitle.hide();\r\n\t\t}\r\n\t}\r\n});"]}