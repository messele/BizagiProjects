{"version":3,"sources":["jquery/workportal/js/base/widget/bizagi.workportal.widgets.activity.log.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.authentication.log.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.activity.log.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.authentication.log.js","jquery/workportal/js/base/widget/admin/admin.encrypt.passwords.js","jquery/workportal/js/base/widget/admin/admin.users.requests.js","jquery/workportal/js/base/widget/admin/admin.defaults.assignation.user.js","jquery/workportal/js/base/widget/admin/admin.user.profiles.js","jquery/workportal/js/base/widget/admin/admin.dimensions.js","jquery/workportal/js/base/widget/admin/admin.alarms.js","jquery/workportal/js/base/widget/admin/admin.user.licenses.js","jquery/workportal/js/base/widget/admin/admin.document.templates.js","jquery/workportal/js/base/widget/admin/admin.processes.js","jquery/workportal/js/base/widget/admin/admin.business.policies.js","jquery/workportal/js/base/widget/admin/admin.business.policies.decision.table.js","jquery/workportal/js/base/widget/admin/admin.business.policies.rules.js","jquery/workportal/js/base/widget/admin/admin.business.policies.tabs.js","jquery/workportal/js/base/widget/admin/admin.business.policies.politics.js","jquery/workportal/js/base/widget/admin/admin.business.policies.vocabularies.js","jquery/workportal/js/base/widget/admin/admin.language.js","jquery/workportal/js/base/widget/admin/admin.preferences.js","jquery/workportal/js/base/widget/admin/admin.entities.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.encrypt.passwords.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.users.requests.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.defaults.assignation.user.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.user.profiles.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.dimensions.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.alarms.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.user.licenses.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.document.templates.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.processes.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.decision.table.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.rules.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.tabs.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.politics.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.language.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.preferences.js","jquery/workportal/desktop/widget/admin/displayOptions/desktop.widgets.admin.displayOptions.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.entities.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.stakeholders.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.oauth2.applications.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.vocabularies.js","jquery/workportal/js/base/widget/admin/admin.async.activities.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.cases.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.caseSearch.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.async.activities.js","jquery/workportal/js/base/widget/admin/admin.usersAdministration.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.userPermissionReport.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.usersAdministration.js","jquery/workportal/js/base/widget/admin/admin.usersDelegation.js","jquery/workportal/js/base/widget/admin/admin.usersDelegation.searchUser.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.usersDelegation.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.usersDelegation.searchUser.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.holidays.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.projectname.js","jquery/common/bizagi.searchuser/js/bizagi.searchuser.js","jquery/common/bizagi.createUser/js/bizagi.createUser.js","jquery/workportal/desktop/widget/admin/business.polices/bizagi.workportal.desktop.widgets.admin.business.polices.js","jquery/common/bizagi.simpleGrid/js/bizagi.simpleGrid.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.transfer.case.security.permissions.js"],"names":["bizagi","workportal","widgets","widget","extend","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG","renderContent","self","this","template","getTemplate","idCase","params","idWorkflow","content","$","tmpl","BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG","activity","log","init","workportalFacade","dataService","totalPages","maxRows","maxPages","currentPage","_super","loadTemplates","activity.log","concat","activity.log.general.content","activity.log.header","activity.log.detail.header","activity.log.detail.content","useNewEngine","postRender","generalContentTmpl","generalHeaderContentTmpl","detailHeaderTmpl","detailContentTmpl","logCategories","ACTIVITIES","id","serviceMethod","detailServiceMethod","selectedDetailId","ENTITIES","USERS","ADMINISTRATION","containtersID","GENERAL","DETAIL","proxyPrefix","undefined","serviceLocator","render","services","service","getCaseNumber","done","response","caseNumber","initWidget","displayNoResults","setupHeader","getContent","headerWrapper","when","supportedLogTypes","supportedLogTypesData","Supported","appendTo","available","getFirstAvailableLogTypes","getActivityLogByCategory","bindHeaderElementInteraction","fail","error","att","x","element","categoryObj","click","hasClass","removeClass","addClass","selectedCategoryObj","isEmptyObject","idActualPage","pageSize","result","total","generalActivityDataValidator","showErrorAlertDialog","showMessageBox","JSON","parse","responseText","message","data","rows","i","length","indexOf","split","currentLogData","renderContentByCategory","generalWrapper","empty","switchContent","pagData","getPaginationData","logCategory","logItems","setUpPagination","show","hide","e","preventDefault","selectedLogItemIndex","currentTarget","closest","index","preprocessDetailRender","pagination","page","pagesArray","pagesToShow","a","push","$pager","method","bizagiPagination","maxElemShow","actualPage","listElement","clickCallBack","options","parseInt","selectedElement","getDetailRenderParams","currentDetailLogData","renderLogDetail","attr","idWorkItemFrom","idEntity","idUser","selectedElementData","detailWrapper","renderDetailContent","logFilterWrapper","showDetailResultMessage","applyDetailFilter","val","$detailWrapper","getFilterParams","renderedTmpl","title","detailItems","remove","insertAfter","userFullName","attribDisplayName","entDisplayName","$logFilterWrapper","toLowerCase","def","Deferred","detailHeaderResult","detailContentResult","append","resolve","promise","contentToDisplay","value","injector","register","authentication","authentication.log","authentication.log.fields","authentication.log.button","authentication.log.result","authentication.log.pagination","maxPageToShow","fieldsContentTmpl","buttonContentTmpl","resultContentTmpl","paginationTmpl","setupInitialData","dataType","getAuthenticationLogData","domainList","eventTypeList","subEvenTypesList","subEventTypeList","fields","subEvenTypes","setupDatePicker","setupFooterButtons","formatDate","getDateFormat","timeFormat","localization","getResource","datetimepicker","controlType","dateFormat","currentText","closeText","timeText","hourText","capitalize","minuteText","datePickerFormat","replaceAll","search","button","widgetButtonSet","validateData","dtFrom","dtTo","util","dateFormatter","formatInvariant","getDateFromFormat","fieldsAreEmpty","errorMessage","action","domain","userName","eventSubType","displayName","eventType","pagSize","findResults","validateResponse","errorFieldName","replace","pageToShow","pag","getAuthenticationLogResult","resultList","totalRecords","records","resultTemplate","paginationHtml","pageToshow","summaryWrapper","pagerData","pages","pageNumber","html","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER","loadtemplates","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_DIMENSIONS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES","comboProcess","processEditTmpl","taskEditTmpl","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE","panelWrapper","generalTemplateListTmpl","fileCultureName","bizagiObjectsList","entitiesListTmpl","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES","getFormEntity","currentGuidForm","guidForm","currentIdRow","idRow","resp","loader","start","then","facade","rendering","getAdminEntitiesForm","responseForm","form","contextType","execute","contexttype","canvas","isEntityForm","formRender","_referrer","_associatedUser","isEmpty","getRender","surrogatekey","internalSubmitOnChange","internalSubmitOnChangeEntity","responseSave","getSelectedItem","idPageCache","guid","guidEntity","isStakeholder","reject","processButton","buttonProperties","endLoading","validateForm","saveFormEntity","drawSimpleGrid","defSave","serviceRender","renderValues","collectRenderValues","multiactionService","submitData","type","formError","admin","encrypt","passwords","encrypt.passwords","on","handlePaste","noEmptyFields","equalFields","entry","comparePasswords","encryptString","encryptedPassword","stopPropagation","clipboardData","originalEvent","window","pastedData","getData","res","target","users","requests","users.requests","users.requests.list","users.requests.detail","users.requests.pagination","users.requests.email","userRequest","userRequestList","userRequestDetail","userRequestpaginationTmpl","userRequestemailTmpl","userRequestListWrapper","userRequestDetailWrapper","LIST","selectedPage","userPendingRequests","renderUserRequestList","authenticationInfo","userId","params_1","userAuthenticationInfo","resultAuthentication","renderUserRequestDetails","requestList","userData","formatInvariantDate","usersRequestsSummaryWrapper","css","noEmptyField","requestDetail","password","enabled","Enabled","isExpired","expired","isLocked","locked","generateRandomPassword","randomPassword","validateKey","generateDataToSendByEmail","showEmailtPopup","updateUser","is","updateUserAuthenticationInfo","messageResponse","doc","document","dialogBoxEmail","buttonsEmail","eMailTo","subject","body","userSecret","getUserSecret","sendUserEmail","closeUploadDialogEmail","dialog","width","modal","buttons","close","resizeStop","event","ui","resize","size","fieldAreEmpty","inputValue","C","CryptoJS","userFormsSpanner","enc","Utf8","userFormsCode","Latin1","resultMain","algo","AES","createEncryptor","mode","CBC","padding","pad","Pkcs7","iv","finalize","Base64","stringify","defaults","assignation","user","defaults.assignation.user","defaults.assignation.user.fields","defaults.assignation.user.search","generalContent","fieldsContent","searchContent","processNavigation","setupData","setupProcessTree","processTree","setupSearchusersButton","treeRoutSelected","bind","setupAssignationToProcess","processtree","authorizationContext","selectedProcessRoute","getTreeRouteSelected","idWfClass","getDefaultAssignationUserToProcess","setupUsersSearchForm","usersTable","userstable","userLinkLabel","parentDef","showBackButton","selectedUserId","saveAssignation","setDefaultAssignationUserToProcess","assigned","profiles","user.profiles","user.profiles.fields","user.profiles.table","user.profiles.table.administrator","userProfilesFields","userProfilesTable","userProfilesTableAdministrator","getProfilesTypes","getOrganizationsList","profileTypes","orgList","profileList","comboDefaultValue","setupMainButtons","setupProfileComboEvent","exportToExcel","filterType","profileTypeId","guidValueFilter","profileId","orgId","organizationId","exportToExcelProfiles","searchProfiles","profileName","profileTypeName","text","profileType","setupManageLink","getUserByProfileId","idProfile","getUsersByProfile","userList","list","slice","setupManageButtons","removeUserFromProfile","showConfirmationBox","removed","userGuid","addUserToProfile","getAttribute","optionSelected","find","change","dimensions","dimensions.administrable","dimensions.properties","dimensions.edit.properties","dimensions.process.tree","isInitialLoad","listContent","detailsContent","detailsEditContent","detailsProcessTreeContent","columnDimensionsAdminWrapper","columnDimensionsPropertiesWrapper","details","setupListProcessPanel1","setupListProcessPanel2","setupMainButtonsleft","setupMainButtonsRight","setupDimensionsPanel1","updatePanel2","defer","getDimensions","$ulListAdmin","$ulListFixed","each","ind2","valu2","$ulList","elementClass","parseBoolean","administrable","guidWfClass","setTimeout","setupDimensionsPanel2","getProcessEntityPath","path","getNameEntityPath","shift","join","nameEntityPath","resultfind","description","name","entityPath","fullPath","getActiveWFClasses","processList","WFClasses","ind","valu","ind1","valu1","displayDimensionsById","dimensionId","fillFieldsWithSelectedDimension","isAdmin","displayProcessById","focus","idProcess","Id","newDimensionAdmin","createTmpl","processComboOnChange","unbind","setupPathLink","emptyField","pattern","trim","test","applyDimensionsAdmin","createAdministrableDimension","jQuery","parseJSON","cancelDimensionsAdmin","deleteDimensionsAdmin","deleteDimension","showEditInfo","editTmpl","editDimensionsAdmin","attributeName","editDimension","displayPath","draggable","height","background-color","opacity","setupEntitiesTree","setupEntitiesTreeButtons","entitiesTree","entitiestree","removeAttr","treeRoute","alarms","alarms.task.list","alarms.task.list.item","alarms.task.detail","alarms.task.detail.alarm.editor","alarms.task.detail.list.table","alarms.task.detail.alarm.recipients","alarms.task.detail.alarm.recipients.table","listID","APPLICATION","update","WORKFLOW","VERSION","TASKS","widgetMode","VIEW_MODE","EDIT_MODE","alertData","taskListTmpl","taskListItemTmpl","taskDetailTmpl","taskDetailAlarmEditor","taskListTableTmpl","taskDetailAlarmRecipientsTmpl","taskDetailAlarmRecipientsTableTmpl","initRenderTaskList","getApplicationCategoriesList","renderTaskList","fillTaskListColumnByID","getTaskAlarms","idTask","getLapseMode","getRecurrMode","getScheduleType","getBossList","taskAlarms","lapseModeList","recurrModeList","scheduleTypeList","bossList","alarmRecipientsList","renderTaskDetail","renderTaskListTable","renderAlarmEditor","renderAlarmRecipients","switchWidgetMode","application","workflow","version","task","detailTmpl","detailcnt","callEnableDisableAlarmsService","validateResult","validateAlarmEditor","sendAlarmEditorData","clearSelectedAlarm","resetAlarmEditor","resetAlarmRecipientsTable","formEditorWrapper","alarmEditorData","localizateScheduleType","scheduleType","lapseMode","recurrMode","handleRadioButtonFields","validateInputFields","iType","isUpdate","serviceMethodName","alarmEditorFormWrapper","isCheckBoxOn","idRecurrMode","idLapseMode","alarmTime","alarmRecurrTime","sendToCurrentAssignee","idAlarm","selectedAlarm","refreshTaskListTable","refreshAlarmRecipientsTable","getAlarmRecipients","renderAlarmRecipientsTable","alarmTableListWrapper","alarmList","alarmsList","active","switchEnableAlarms","fillAlarmDetailForm","idalarm","deleteAlarm","checked","isAlarmSelected","alarmRecipientsListWrapper","bosses","currentWidgetMode","idRecipient","addRecipientToAlarm","alarmRecipientsTableWrapper","checkedElements","recipientsIDs","idRecipients","recipients","deleteRecipientsFromAlarm","deletedRecipients","recipientsList","idScheduleType","prop","sendToCurrAssignee","field","fieldValue","maxValueAllowedInt32","isNaN","listName","listObj","taskField","elementList","items","processes","versions","tasks","updateListsContent","listCategory","getListCategoryByID","captureSelectedData","elementToUpdate","getElementToUpdate","processLists","setupParametersbyListID","selectedIndex","resetParametersbyListID","taskListWrapper","currentListID","enableAlarm","licenses","user.licenses","setupButton","licenseType","expirationDate","substring","activeUsers","licensedUsersAccount","customerName","clustered","tabs","open","getAuditLicense","downloadBPUs","url","getUrl","queryParams","getXSRFToken","downloadFile","templates","admin.document.templates","admin.document.templates.upload.template","admin.document.templates.uploaded.templates.list","uploadTemplateTmpl","uploadedTemplatesTmpl","lockedInteractions","config","maxSize","validExtensions","xpath","uploadDialogTemplateName","renderUploadForm","initUploadedTemplates","storeDocumentTemplates","renderUploadedTemplates","templateUploadFormWrapper","dialogTemplate","deviceFactory","cachedFactory","addFormInteractions","getRenderFactory","uploadedTemplateListWrapper","documentTemplates","documentTemplate","Guid","restoreDocumentTemplates","DocumentTemplateRestored","displayMessage","properties","addUrl","idRender","xpathContext","sessionId","maxfiles","filesCount","bizagiUpload","renderReference","idSession","onUploadFileCompletedCallback","ref","maxAllowedFiles","uploadedFiles","dialogTitle","messageData","messageContainer","DocumentTemplateUploaded","admin.processes.wrapper","admin.processes.combo.process","admin.processes.proc.edit","admin.processes.task.edit","formType","TASK_FORM","PROCESS_FORM","containersMode","getWorkFlowClasses","processesData","renderSections","processHeaderWrapper","processesMapWrapper","processesComboWrapper","renderProcessesCombo","renderProcessesEditWrapper","loadProcessData","renderTaskEditWrapper","displayTaskEdit","renderProcessViewer","processID","currentSelectedProcessData","bindProcessDetail","getTaskByWorkFlow","processTaskData","filter","viewerPlugin","processviewer","processDefinition","graphicInfo","dfn","info","processTaskDefinition","flowElements","jsonBizagi","processGraphicsInfo","zoomRange","preprocessBindTaskDetail","deferred","comboDataSource","combo","uicombo","isEditable","itemValue","obj","itemText","onComplete","onChange","loadSelectedTask","initValue","processEditWrapper","switchFormState","saveProcess","correctIntegerInInput","taskEditWrapper","saveTask","parseObjectTime","durationText","durationDays","durationHours","durationMinutes","currentSelectedTaskData","taskId","taskData","getTaskByID","bindTaskDetail","param","shouldShowTaskProperties","taskID","Tasks","oTask","idTaskType","minValue","maxValue","defaultValue","iNewValue","tryParseInt","str","retValue","String","iNewDuration","getMinutesFromTimeUnits","NaN","modifyProcessDuration","duration","modifyTaskDuration","days","hours","minutes","hoursDay","objectReference","arrDuration","getTimeArrayFromMinutes","getDurationStringFromMinutes","sDuration","business","policies","admin.business.policies.wrapper","admin.business.policies.content","setupPoliciesTree","tree","decision","table","admin.business.policies.decision.table.wrapper","admin.business.policies.decision.table.content","decisionTableContent","rules","admin.business.policies.rules.wrapper","admin.business.policies.rules.content","admin.business.policies.tabs.wrapper","admin.business.policies.tabs.content","politics","admin.business.policies.politics.wrapper","admin.business.policies.politics.content","language","admin.language.wrapper","admin.language.panel.wrapper","admin.language.template.list","admin.language.upload.file.culturename","admin.language.bizagi.objects.list","admin.language.entities.list","uploadFormTemplateName","cultureName","generalUploadFile","formTemplate1","formTemplate2","formTemplate3","formTemplate4","startTab","initLanguageTemplatesList","initBizagiObjectsList","initEntities","session","isProduction","parent","create","tab","accordion","heightStyle","activeTab","handleTabEvents","keyEntityValidation","languageUploadFormWrapper","massiveResourcesUploadFormWrapper","source","languageListWrapper","getStoreLanguageTemplates","sort","b","templateList","languageTemplates","listTitle","downloadTemplateEvent","addUploadMassiveResources","initReset","bizagiObjectsListWrapper","getBizagiObjects","bizagiObjects","bizagiObjectsEvents","readyToDownload","entitiesListWrapper","getEntitiesList","entities","entitiesList","entitiesEvents","keyup","not","expr","FilterEntity","entity","array","RegExp","getEntitiesSelected","entitiesSelected","idEntitiesSelected","item","getObjectsSelected","objectsSelected","valueObjectsSelected","initAllLangs","allLangsEvents","FilterLanguage","modifiedLangs","elValue","saveLangsList","langsObj","languages","setLanguages","errMsgEl","resetEvents","loadingOption","resetPersonalization","notLoading","internalsContainer","extendedContainer","objectsContainer","entitiesContainer","entitiesUrl","defaultUrl","renderUploadPlugin","renderCultureCombo","tabContainer","formTemplate","uploadUrl","responseTarget","bizagiFileUpload","showLoading","alerFailtAfterUpload","validateEntitiesModified","messageKey","handleResponse","onUploadFileFailCallback","console","onUploadFileProcess","entitiesMessage","detail","key","comboWrapper","sendBtn","div","errorDetail","listTable","downloadBtn","activeBizagiObjects","activeEntities","extendedObj","elements","getLanguageTemplate","include","langSelected","context","menuSecurity","EntityAdmin","Multilanguage","actionRunning","mainWrapper","preferences","bizagiUserPreferences","isNewForm","notifier","get","admin.preferences.wrapper","admin.preferences.container","admin.preferences.buttons","admin.preferences.iframe","admin.preferences.error","admin.preferences.properties","container","iframe","propertiesTmpl","getPreferenceFormParams","renderErrorMessage","renderPreferences","renderPreferencesOldForm","resource","productBuildToAbout","errorContent","$content","endPoint","$iframeContent","$iframe","load","fadeIn","readyDeferred","currentUser","preferencesParams","h_action","h_contexttype","h_guidForm","renderContainer","getPreferencesForm","renderingParams","getFormatValues","formatTime","noPermission","OpenWindowsMaximized","AlwaysCollapseActivitySidebars","ReturnToInboxWhenTasksAreFinished","preferenceForm","handleEvents","updateData","updatePreferences","values","serializedForm","serialize","decodeURIComponent","map","numberRows","getPreference","maintenanceGuid","maintenanceModifiedDate","decimalSeparator","thousandSeparator","overridePreferences","showSucessMessage","collectRenderValuesForSubmit","startLoading","proxy","getCurrentUser","currentUserData","assignLanguage","changeData","executeRender","typeMessage","admin.displayOptions.container","containerTemplate","markup","mainTemplate","displayOptionsInstance","Vue","maximizeModals","label","hover","startPage","input","selected","defaultTitle","updatetTitle","showStartPageControl","computed","activeIndex","findIndex","methods","resourceKey","setHover","setFocus","chooseValue","debounce","func","arg","apply","keyCode","chooseEnter","changeOffset","delta","findMatches","v","defaultConfigurations","getRowValueCookie","storedValue","cookie","updateConfigurations","components","created","forEach","initElement","mounted","destroyed","renderingDeferred","mountView","security","command","getSecurity","override","enableMaximizeModalsOption","enableStartPageDisplayOption","$mount","dispose","$destroy","templateName","entitiesState","actualShowingList","admin.entity.wrapper","admin.entity.panel.wrapper","admin.entity.panel.wrapper-buttons","admin.entity.list","admin.entity.error","_state","setInitialState","panelWrapperButtons","entitiesError","getAdminEntitiesList","entityListWrapper","configureHandlers","notFoundMessage","matchString","el","unwrap","wrap","addButtons","reviewUploadFileState","trigger","openLanguageSettingsWidgetDialog","toggle","resizeAdminEntityWrapper","toggleClass","getEntityExcel","downloadLastReport","file","uploadFile","heightButtonWrapper","isEnableFeature","toggleButtonsWrapper","kendoUpload","async","saveUrl","saveField","validation","allowedExtensions","maxFileSize","uploadMaxFileSize","showFileList","multiple","select","upload","isValid","files","extension","sender","showMessage","success","defaultWidth","widgetParameters","widgetName","closeVisible","maximize","modalParameters","publish","isError","icon","fadeOut","selectedEntity","idDisplayForm","formParams","responseFormDisplay","performSimpleGrid","resolveEntityForm","responseEntity","entityObj","surrogatedKeys","dataRows","queueForms","newResponseEntity","getRenderElements","getFormHeaders","headers","header","attributeType","relatedEntity","headerProperties","guidAttribute","matchHeaderWithXpath","row","clone","multiaction","responses","Array","prototype","call","arguments","elmKey","elmValue","formDisplay","simpleGridPlugginOptions","allowAdd","allowEdit","orderField","orderType","filters","onDataBinding","args","getCurrentPageToSimpleGrid","setSelectedItem","getAdminEntitiesRowData","reshapeEntity","onLoadFilter","getAdminEntityData","onFilterChanged","onPageChanging","beforePage","newPage","setCurrentPageToSimpleGrid","onAdd","validateVersionForm","onEdit","simpleGrid","$selectedEntity","property","idAddForm","idEditForm","getAdminEntityMigrated","idForm","loadIframeForm","indexElementsAdd","kF","vF","mergeFormAndTable","desabledElement","pop","firstElement","unshift","indexAdd","k","newDataRow","renderTable","toUpperCase","currentPageGrid","newIndex","existsLastReport","$link","getAdminEntitiesExistsLastReport","exists","guidEntityLast","showStateUploadingFile","getAdminEntityState","state","reloadEntitiesListAfterUpload","initialViewUploadEntities","enableUploadButton","reCall","disableUploadButton","getAdminEntitiesDownloadLastReport","admin.stakeholder.panel.wrapper","admin.stakeholder.list","admin.stakeholder.error","stakeholdersList","stakeholdersError","getAdminStakeholdersList","stakeholders","stakeholderListWrapper","$selectedStakeholder","stakeholder","validateUser","selectedStakeholder","associatedUserHasChange","duplicatedUser","confirmationMsg","submitFormData","userChanged","associatedUser","loadedForm","selectedUser","getValue","getUserStakeholders","BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS","admin.oauth2applications","admin.edit.oauth2applications","admin.add.oauth2applications","CurrentClientData","contentOauth","allowDelete","allow","orderEnabled","getOAuth2Applications","hv","responseOauth","namesApplications","Name","Object","keys","addApplication","editApplication","onDelete","deleteApplication","setupAddApplicationEvents","setupCombos","save","cancel","setupUserSuggest","edit","stp","inputDomain","inputUserName","children","that","proximo","upOrDown","clearTimeout","searchUsers","isArray","createOptionsArray","searchNames","direction","focusout","validationAccessTokenInput","accessTokenSelector","isEdit","accessTokenInput","updateSuggest","targets","createOption","reduce","ev","dataGrandType","dataRedirectUri","$comboGrandType","$comboRedirectUri","setupCombo","initializeOauth2Template","$comboEditGrandType","$comboEditRedirectUri","grantType","scopeLogin","scopeUserSync","scopeODataQuery","elem","dataSelf","RedirectUri","pos","editGrantType","editRedirectUri","comboElements","bizOAuth2UserSyncInput","bizOAuth2ODataQueryInput","AllowedScope","editAllowedScope","showErrors","messageToken","dataValidating","prefix","errorsBoard","inputName","n","inputDefaultUserDomain","inputDefaultUserName","inputRedirectUri","inputMobileHostPort","Math","floor","parseFloat","inputAccessTokenLifetimeInMinutes","allowedScope","dataAddApplication","dataInputs","serializeArray","createOAuth2Application","getGrantType","authorization_code","client_credentials","any","getRedirectStrategy","WebApplication","MobileTitleBarBrowser","MobileLocalhostPort","getMobileLocalhostPort","uri","strategy","port","match","applicationId","getOAuth2Application","checkedScope","scope","grep","RedirectUriStrategy","AuthorizationGrantType","ActualNameForEdit","DataAllowedScope","IsNative","updateApplicationKeys","updateNaviteApplication","updateApplication","accessTokenLifetimeInMinutes","updateOAuth2Application","appId","client_id","ClientId","client_secret","ClientSecret","updateClientSecretKeysOAuth2Application","err","deleteOAuth2Application","cleanData","destroy","vocabularies","admin.business.policies.vocabularies.wrapper","admin.business.policies.vocabularies.content","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES","cases","admin.cases","userTableConf","getOrganizationInfo","skill","location","role","renderSearchCaseForm","searchCasesTemplate","skillInput","searchList","roleInput","locationInput","searchCasesForm","searchCaseFormEventHandler","renderSearchUserForm","totalCases","searchUserTemplate","printf","resources","eventHandlerSearchUserForm","showSearchCaseForm","showSearchUsersForm","searchForm","showConfirmAssignCasesForm","showLoaderAtContainer","closeLoader","updateTotalUsersForm","Number","getCasesSearchParams","skills","locations","roles","reassignCases","showConfirmAssignCasesMessage","span","skillList","roleList","getCasesByOrganization","updateTotalCasesFound","nextChild","dialogBox","after","setCasesSearchParams","caseSearchParams","casesFoundMessageWrapper","userFoundMessageWrapper","createPage","resultLength","tableContent","tableUserTemplate","pagesLength","ceil","splice","tableUsers","tableUsersHandlers","updateTableUsersPager","userListWrapper","anyElementSelected","pageIndex","userTable","caseSearch","adhocIds","selectedCaseAdmin","selectedWorkItemAdmin","columnsID","process","processCreationDate","taskDueDate","processDueDate","userfullName","userLocation","admin.case.search","admin.case.search.fields","admin.case.search.button","admin.case.search.result","admin.case.search.pagination","admin.case.search.invalidate","admin.case.search.reassign","admin.case.search.reassign.form","admin.case.search.action.result","admin.case.search.loader","invalidateContentTmpl","reassignContentTmpl","reassignFormTmpl","actionResultContentTmpl","loaderTmpl","defaultMaxRows","showNotifier","showConfirmationMessage","invalidateSelectedCase","paramsToInvalidateSelectedCases","initPositionsCombo","getUserPositions","positions","idPosition","renderPositionsCombo","setupCaseSecurity","buttonBackAction","selectedUserName","selectedTasks","selectedTasksToShow","searchParams","processTreeDelete","caseSecurity","activate","newTab","isOut","getProcessRunningInvalidateCases","timer","casesTabs","bizagiConfig","datepicker","processtreeParams","svgIconsMode","searchKeyResource","newDesign","caseSecurityParams","transfer","case","permissions","assignEventReassignLinks","Page","getAdminCasesList","isAdhocProcess","caseId","processId","idAdhocProcess","showCasesSearchResultFrame","setupActionsButton","disableInvalidate","disableAbortCases","processedItems","preprocessResultList","groupByCaseNumber","securityGraphicQuery","GraphicQuery","getRadNumberColumnIndex","l","fieldName","showColumn","columnIndex","createGroupedHeader","rowIndex","radNumber","getRadNumber","invalidateForm","reassignForm","setupActivitiesLink","setupGraphicQueryEvent","selectedItemsPersistence","processResultItem","rowItem","taskElements","taskElementsLength","currentTaskObj","taskColumnIndexLength","rowItemData","idWorkFlow","idParentCase","isSubProcess","isSubprocess","resultArray","firstRowItem","taskColumnIndex","j","resultTaskArray","processTaskObjectUser","processTaskObject","processTaskObjectDate","estimatedSolutionDate","resultValue","formatValueByDataType","idworkflow","totalTask","taskObject","taskName","colorState","taskType","idWorkItem","skip","assignee","invalidateCases","parentCases","messageConfirmation","selectedCases","dialogClass","minWidth","reason","abortReassignItems","abortResult","showActionResultFrame","showReassignTasksFrame","taskItem","showReassignForm","reassignTasks","idNewUser","reassignResult","itemsFailed","resultStatus","deleted","reassigned","exceptionMessage","innerHTML","idAppToSend","idCategorytoSend","idProcessToSend","numberResults","isNumeric","dateFrom","dateTo","I_ProcessState","h_idApp","I_Users","eventAsTask","order","group","I_radNumber","I_idWFClass","I_USERNAME","I_USERFULLNAME","I_USERPOSITION","I_From__CreationDate","I_To__CreationDate","h_idWFClassAuth","I_idCategory","I_idApplication","PageSize","isDate","backToMainForm","backToCases","unicode","charCode","getDateInvariantByControlIDSelector","controlIDSelector","paramDate","valueDatePicker","valueSelected","inArray","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","columnOrderId","columnOrderBy","columnOrderName","isAdhoc","showGraphicQuery","idApplication","selectedProcess","postAdminInvalidateCase","last_showSuccessToastInvalidate","getResponseProcessRunningInvalidateCases","status","activities","ASYNC_CHECK_TIMER","selectedTab","admin.async.activities","admin.async.activities.tabs","admin.async.activities.tab1","admin.async.activities.tab2","admin.async.activities.log","admin.async.activities.pagination","admin.async.activities.error.page","admin.async.activities.processing","tabsTmpl","tab1Tmpl","tab2Tmpl","logTmpl","paginatorTmpl","errorPage","processingPage","setupTabs","mainContent","loadTabsContent","paramsTab1","paramsTab2","renderTab1Table","renderTab2Table","tableWrapper","asyncActivitiesServices","asyncActRefresh","tab1Content","setupTab1ActivitiesLink","additionalparameters","resultArr","resultRows","idInsertedArr","arrPossition","count","wfClsDisplayName","childs","tskDisplayName","tab2Content","setupTab2ActivitiesLink","executeActivity","dinamicScreen","dinamiccontent","executed","checkAsycnExecutionState","idAsynchWorkitem","goToCase","setupErrorPageLink","getRetryStatus","counter","getAsynchExecutionState","mainScreen","top","left","margin-top","margin-left","padding-top","margin-right","max-height","setupBackToMainPage","Class","showLog","logPage","setupLogButtons","enableActivities","enableMultipleActivities","paramsLog","processName","idWorkitem","checkboxes","getElementsByName","vals","selector","actualWidget","inbox","BIZAGI_WORKPORTAL_WIDGET_INBOX","grid","BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID","isFunction","wrapper","allowCreation","userLinks","typeSVG","admin.users","admin.users.formbuttons","admin.users.log","admin.users.licenses","admin.users.email","admin.users.anonymize","admin.search.cases","admin.search.users","admin.table.users","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION","user-permission-report","getUserPermissionsExcel","desktop","userPermissionReport","usersAdministration","$userTable","$renderForm","$buttonsContainer","$usersLicenses","queryUserPermissions","renderUsersTable","addEventsHandler","queryLicenses","createUserAdministrationForm","isAllowByLicences","isAllowByReadOnly","createUser","authenticationType","isLdapSyncEnabled","queryUsersLicenses","showLicensesMessage","canAddNewUser","areLicensedUsersLimitNear","resetLogValues","getUsersLogData","renderForm","downloadReport","anonymize","renderFormButtons","returnToUserTable","anonymizeUser","showHideNewUser","getUsersTableData","xhr","object","responseError","showErrorMessage","processFailMessage","buyLicense","renderLicensesWidgets","createButton","showCloseButton","toggleForm","removeButtons","getUsersAdministrationLog","Pag","renderUserLogTable","getPagesArray","aux","$button","display","getPages","getLoadFormParams","getUsersForm","userForm","performActionsAfterSave","h_xpathContext","h_optionform","sendMail","formAction","afterSave","excecuteQuery","showEmailPopup","emailConfirmationMessage","logOff","resizable","triggerHandler","unmaximize","downloadReportUser","descriptionTranslated","fullName","admin.userdelegation","admin.userdelegationListTmpl","admin.userdelegationDeleteConfirmationTmpl","admin.userdelegationFormTmpl","admin.userdelegationEmptyMessageTmpl","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION_SEARCH_USER","usersDelegation","showTable","$delegationFormWrapper","$DelegationListWrapper","tableHeaders","renderDelegationForm","initDelegationTable","userdelegationFormTmpl","startDateWrapper","endDateWrapper","today","Date","minDate","configureProcessCombo","getProcessToDelegate","processComboWrapper","processComponent","setupMultiselector","component","isSearchable","msgPlaceholder","prepend","onComboDropDown","markChoicesMultiselector","inputText","filterOptionsMultiselector","addChoiceMultiselector","matches","editable","itemBody","box-shadow","itemToDelete","indexToRemove","filterData","userdelegationListTmpl","queryDelegations","delegations","delegationList","setUpSortColumnLinks","userdelegationEmptyListTmpl","msg","addTableEventsHandler","delegatedAssignment","selectedDelegation","delegatedName","idDelegate","clearMultiselector","startDate","endDate","openDeleteConfirmation","deleteConfirmationDialog","delegation","detach","deleteDelegation","updateDelegation","saveDelegation","clearForm","searchUser","idDelegation","idsProcess","enableSub","validateSaveUpdateParams","arrayResult","responseJSON","messages","msgs","arr","toString","$canvas","searchUser.form","searchUser.message","searchUser.table.wrapper.final","templateService","getTemplateWidget","usersTableFormTmpl","usersTableMessage","usersTableTmpl","usersTableTmplFinal","currentRoles","currentSkills","currentPositions","currentOrganizations","getPreferencesCurrentUser","sRoles","sSkills","sPositions","sOrganizations","deferreds","getValuesMultiple","allLocations","allRoles","allSkills","allPositions","allOrganizations","locationsComponent","rolesWrapper","rolesComponent","skillsWrapper","skillsComponent","positionsWrapper","positionsComponent","organizationsWrapper","organizationsComponent","setupEventsHandler","getValuesFromCQL","guidRef","displayAttribute","baref","idEntityValue","allKeysToUpperCase","output","current","selectedOption","color","$userForm","localizationArray","localizationSelecction","domainInput","userNameReassignInput","organization","which","submit","cleanForm","getUsersForDelegation","showUsersTable","$wrapperList","$wrapperForm","$breadCrumbResults","tableFinal","renderBooleanYes","renderBooleanNo","selectUser","dialogStack","currentInboxView","BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS","holidaysObj","calendarSelector","activeCalendar","schemas","schema","holidays","holidaysInServer","admin.holidays","admin.holidays.calendar.schema","getHolidaysSchemas","renderHolidaysSchema","_getSchemas","_getDaysBySchema","guidSchema","schemaObj","_calendarHasChanges","isModified","modified","_getChanges","added","actually","_searchDateInSchema","dateObj","date","getTime","datesObjA","datesObjB","matchAction","primaryAction","inverseAction","searchIndex","formatDateStringToISO8601","delete","add","dateString","isFormatISO8601","_formatDateFromInvariantToISO8601","saveSchema","saveFromModal","$messageContainer","_saveSchema","showSuccess","showError","changes","overlay","saveHolidaysBySchema","encode","_resetSchemaChanges","_changeSchema","$message","holidaysSchemaHandlers","renderHolidaysCalendar","toastr","showWarningMessage","getHolidaysBySchema","dates","always","showSaveBox","currentYear","getFullYear","datePickerOptions","_datePickerOptions","maxDate","stepMonths","numberOfMonths","defaultDate","onSelect","dateText","inst","_addOrRemoveDate","beforeShowDay","foundDate","_findDate","isEnabled","position","convertedDate","setHours","setMinutes","setSeconds","formatISO8601","_showNotification","notificationType","notification","NotificationMessage","iconType","_NOTIFICATION_ICON_TYPE","CSS","onClick","dateStringInvariant","objDate","getDateFromInvariant","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME","admin.projectname","getProjectName","projectName","setProjectName","errorObj","fn","bizagiSearchUser","usersResults","dBox","editingUser","bindElements","openUploadDialog","showFilters","showButtons","addHandlers","filtersContainer","displayNames","buttonsContainer","searchButtonName","clearButtonName","allowAddUser","newUserBtn","bizagiCreateUser","renderFactory","onCreate","selectItem","onCancel","clickClearPluginValues","updateFiltersInformation","getTableTemplate","addTableHandlers","buttonSelf","itemSelected","valuesToSelect","newUser","sendEmail","iduser","widgets-admin-business-polices","generalTmpl","build","clean","polices","bizagiWidget","settings","internalData","renderGrid","initialized","filterObject","numRequest","prev","additionallabel","$resultTableContent","panelContent","guidForms","filterApplied","attributeSupportFilter","attributeSupportOrder","bigIntHeaders","intHeaders","smallIntHeaders","tinyIntHeaders","booleanHeaders","decimalHeaders","numericHeaders","moneyHeaders","floatHeaders","realHeaders","dateTimeHeaders","scientificNotationHeaders","userLocalization","userLocalizationCloned","decimalDigits","$column","allowDecimals","setAttribute","formatNumber","getFormatNumber","showSymbol","symbol","BIZAGI_DEFAULT_CURRENCY_INFO","formatInvariantMoney","formatInvariantNumber","valuesBoolean","itemBoolean","contentBoolean","oracleNumberList","numberItem","number","scientificNotationFormat","elementSelected","removeData","formatTableEntity","$columnFilters","_","$element","$parent","bizagi_filters","filterWrapper","filterString","filterNumber","filterDate","filterBoolean","attribute","entityData","idSelected","selectedRow","showRowsEntity","panelPaginator","renderPagintation","datatype","masterEntity","$item","auxNumberFormat","allowdecimals","numDecimals","percentage","thousands","groupSeparator","bizagi.simpleGrid.wrapper","bizagi.simpleGrid.content","bizagi.simpleGrid.paginator","filter-wrapper","filter-string","filter-number","filter-date","filter-boolean","selectedUsers","allProcess","haveProcess","admin-case-security-improvement","admin-case-security-improvement-fields","security-improvement-loader","security-improvement-emptyTree","BIZAGI_WORKPORTAL_WIDGET_ADMIN_TRANSFER_CASE_SECURITY_PERMISSIONS","emptyTreeTmpl","emptyTreeText","setupProcessTreePermissions","byUser","showTitle","processTreePermissions","applicationList","typeOption","initializeTree","showHideClearIcon","transferCaseSecuritypermissions","idUserSource","idUserTarget","quantityModifiedCases","revokeCaseSecuritypermissions","clearInput"],"mappings":"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","sourcesContent":["/**\r\n * Activiy log for  activities, entities, and users\r\n * \r\n * @author David Andrés Niño\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"activity.log\");\r\n\r\n        self.idCase = self.params.idCase;\r\n        self.idWorkflow = self.params.idWorkflow;\r\n\r\n        var content = self.content = $.tmpl(template, { idCase: self.idCase });\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Authentication log for users\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.authentication.log\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"authentication.log\");\r\n        var content;\r\n        \r\n        content = self.content = $.tmpl(template, { });\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Admin module to case massively reassign\r\n * \r\n * @author David Nino, David Romero, Edward J Morales\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.activity.log.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        self.totalPages = 0;\r\n        self.maxRows = 10;\r\n        self.maxPages = 10;\r\n        self.currentPage = 1;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"activity.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log\"),\r\n            \"activity.log.general.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-general-content\"),\r\n            \"activity.log.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-header\"),\r\n            \"activity.log.detail.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-header\"),\r\n            \"activity.log.detail.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"activity.log.general.content\");\r\n        self.generalHeaderContentTmpl = self.getTemplate(\"activity.log.header\");\r\n\r\n        self.detailHeaderTmpl = self.getTemplate(\"activity.log.detail.header\");\r\n        self.detailContentTmpl = self.getTemplate(\"activity.log.detail.content\");\r\n\r\n        //Set the keys for each type of log, the service for the general table, and detail table\r\n        self.logCategories = {\r\n            ACTIVITIES: { id: \"ActivityLog\", serviceMethod: \"getActivityLog\", detailServiceMethod: \"getActivityDetailLog\", selectedDetailId: 0 },\r\n            ENTITIES: { id: \"EntityLog\", serviceMethod: \"getEntityLog\", detailServiceMethod: \"getEntityDetailLog\", selectedDetailId: 0 },\r\n            USERS: { id: \"UserLog\", serviceMethod: \"getUserLog\", detailServiceMethod: \"getUserDetailLog\", selectedDetailId: 0 },\r\n            ADMINISTRATION: { id: \"AdminLog\", serviceMethod: \"getAdminLog\" }\r\n        };\r\n\r\n        //Sets the containers id\r\n        self.containtersID = {\r\n            GENERAL: \"general\",\r\n            DETAIL: \"detail\"\r\n        };\r\n\r\n        //Creates an instance of render Services\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n        var renderServices = new bizagi.render.services.service({ \"proxyPrefix\": proxyPrefix });\r\n\r\n        //Gets the case number using the caseId\r\n        renderServices.getCaseNumber({\r\n            idCase: self.idCase\r\n        }).done(function (response) {\r\n            var caseNumber = response.caseNumber;\r\n            self.caseNumber = caseNumber ? caseNumber : self.idCase;\r\n\r\n            self.initWidget();\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Init the widgets building each separated element\r\n    */\r\n    initWidget: function () {\r\n\r\n        var self = this;\r\n\r\n        //Hides the \"no results\" message container\r\n        self.displayNoResults(false);\r\n\r\n        //set up the header\r\n        self.setupHeader();\r\n    },\r\n\r\n    /*\r\n    *   Setup the header using the results from the service supported log types\r\n    */\r\n    setupHeader: function () {\r\n        var self = this;\r\n        content = self.getContent();\r\n\r\n        var headerWrapper = $(\"#activity-log-data-header-wrapper\", content);\r\n\r\n        $.when(self.dataService.supportedLogTypes()).done(function (supportedLogTypesData) {\r\n\r\n            //update the log types with the supported ones\r\n            $.tmpl(self.generalHeaderContentTmpl, { supportedLogTypes: supportedLogTypesData.Supported }).appendTo(headerWrapper);\r\n\r\n            //Find the first supported log type\r\n            var available = self.getFirstAvailableLogTypes(supportedLogTypesData.Supported);\r\n\r\n            //Reset  current page\r\n            self.currentPage = 1;\r\n\r\n            //Sends the object with the available log type\r\n            self.getActivityLogByCategory(self.logCategories[available]);\r\n\r\n            //Add the click events from the elements in the header\r\n            self.bindHeaderElementInteraction($(\"#LnkActivities\", self.content), self.logCategories.ACTIVITIES);\r\n            self.bindHeaderElementInteraction($(\"#LnkEntities\", self.content), self.logCategories.ENTITIES);\r\n            self.bindHeaderElementInteraction($(\"#LnkUsers\", self.content), self.logCategories.USERS);\r\n            self.bindHeaderElementInteraction($(\"#LnkAdmin\", self.content), self.logCategories.ADMINISTRATION);\r\n        }).fail(function (error) { });\r\n    },\r\n\r\n    /*\r\n    * Uses the supported log types data, finds the first element wich is available\r\n    */\r\n    getFirstAvailableLogTypes: function (supportedLogTypesData) {\r\n        var self = this;\r\n        for (var att in self.logCategories) {\r\n            for (var x in supportedLogTypesData) {\r\n                if (self.logCategories[att].id == x && (supportedLogTypesData[x] == \"true\" || supportedLogTypesData[x] == true)) {\r\n                    return att;\r\n                }\r\n            }\r\n        }\r\n\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Bind the element interaction with the category which it belongs\r\n    *   @param element (Object) DOM element which is going to be added the click event\r\n    *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n    */\r\n    bindHeaderElementInteraction: function (element, categoryObj) {\r\n        var self = this;\r\n\r\n        element.click(function () {\r\n            if (!$(this).hasClass('active')) {\r\n\r\n                $(\".active\", self.content).removeClass('active');\r\n\r\n                $(this).addClass('active');\r\n\r\n                self.currentPage = 1;\r\n                self.getActivityLogByCategory(categoryObj);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Using the categoryOjb, get the service method and call the service to retrieve the log\r\n    *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n    */\r\n    getActivityLogByCategory: function (categoryObj) {\r\n        var self = this;\r\n\r\n        var params = {};\r\n\r\n        self.selectedCategoryObj = ($.isEmptyObject(categoryObj)) ? self.selectedCategoryObj : $.extend({}, categoryObj);\r\n\r\n        params = { idCase: self.idCase, idActualPage: self.currentPage, pageSize: self.maxRows };\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n        generalWrapper.addClass(\"ui-bizagi-component-loading\");\r\n\r\n        $.when(self.dataService[self.selectedCategoryObj.serviceMethod](params)).done(function (result) {\r\n            self.totalPages = result.total;\r\n            self.generalActivityDataValidator(result);\r\n        }).fail(function (error) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            bizagi.showMessageBox(JSON.parse(error.responseText).message, \"Bizagi\", \"Error\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Validate the info gathered from the log service, and pre-render to show it in the required way\r\n    *   @param data (Object) Result from the log service\r\n    */\r\n    generalActivityDataValidator: function (data) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n\r\n        if (data.rows) {\r\n\r\n            if (self.selectedCategoryObj.id == self.logCategories.ADMINISTRATION.id) {\r\n\r\n                var i = data.rows.length, result;\r\n\r\n                while (i-- > 0) {\r\n                    if (data.rows[i][3].indexOf(\"-->\") !== -1) {\r\n                        result = [].concat(data.rows[i][3].split(\"-->\")[0].split(\":\").concat(data.rows[i][3].split(\"-->\")[1].split(\": :\")));\r\n                    } else {\r\n                        result = [].concat(data.rows[i][3].split(\"-->\")[0].split(\":\"));\r\n                    }\r\n\r\n                    data.rows[i][3] = [].concat(result);\r\n                }\r\n            }\r\n\r\n            //Stores the current data\r\n            self.currentLogData = [].concat(data.rows);\r\n        } else {\r\n            self.currentLogData = [];\r\n        }\r\n\r\n        self.renderContentByCategory();\r\n    },\r\n\r\n    /*\r\n    *   Render the content from the selected log category\r\n    */\r\n    renderContentByCategory: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n\r\n        //Removes the loading class\r\n        generalWrapper.removeClass(\"ui-bizagi-component-loading\");\r\n\r\n        //Clean the content\r\n        generalWrapper.empty();\r\n\r\n        self.switchContent(self.containtersID.GENERAL);\r\n\r\n        //Get data for pagination\r\n        var pagData = self.getPaginationData();\r\n\r\n        // Render Form\r\n        $.tmpl(self.generalContentTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, logItems: self.currentLogData, pagData: pagData }).appendTo(generalWrapper);\r\n\r\n        self.setUpPagination($(\"#biz-wp-activitylog-category-pager ul\", self.content), \"getActivityLogByCategory\");\r\n\r\n        //Show/hide the no-result message\r\n        if (self.currentLogData.length > 0) {\r\n            self.displayNoResults(false);\r\n            $(\".activity-log-table\", generalWrapper).show();\r\n        }\r\n        else {\r\n            self.displayNoResults(true);\r\n            $(\".activity-log-table\", generalWrapper).hide();\r\n        }\r\n\r\n        //Add Interactions\r\n        $(\".detail-item\", generalWrapper).click(function (e) {\r\n            e.preventDefault();\r\n\r\n            //Stores the Log  Item Index\r\n            self.selectedLogItemIndex = $($(e.currentTarget).closest(\"tr\")[0]).index() - 1;\r\n\r\n            //reset current page\r\n            self.currentPage = 1;\r\n\r\n            self.preprocessDetailRender($(this));\r\n        });\r\n\r\n        $(\".listHeaderLinks\", generalWrapper).click(function (e) {\r\n            e.preventDefault();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Get Pagination Data\r\n    */\r\n    getPaginationData: function () {\r\n\r\n        var self = this;\r\n        var pagination = (self.totalPages > 1) ? true : false;\r\n\r\n        var pagData = {\r\n            page: self.currentPage,\r\n            pagesArray: [],\r\n            pagination: pagination\r\n        };\r\n\r\n        var pagesToShow = (self.maxPages > self.totalPages) ? self.totalPages : self.maxPages;\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            pagData.pagesArray.push(a + 1);\r\n        }\r\n\r\n        return pagData;\r\n    },\r\n\r\n    /*\r\n    * SetUp Pagination\r\n    */\r\n    setUpPagination: function ($pager, method) {\r\n\r\n        var self = this;\r\n\r\n        $pager.bizagiPagination({\r\n            maxElemShow: self.maxRows,\r\n            totalPages: self.totalPages,\r\n            actualPage: self.currentPage,\r\n            listElement: $pager,\r\n            clickCallBack: function (options) {\r\n                self.currentPage = parseInt(options.page);\r\n                self[method]({}, $pager);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Render the content from the selected log item\r\n    */\r\n    preprocessDetailRender: function (selectedElement) {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var params = self.getDetailRenderParams(selectedElement);\r\n\r\n        //Checks if the selected category have the detail service, and invokes it\r\n        if (self.selectedCategoryObj.detailServiceMethod) {\r\n            $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\r\n\r\n                self.totalPages = result.total;\r\n\r\n                self.switchContent(self.containtersID.DETAIL);\r\n\r\n                //Current Log Data\r\n                if (result.rows) {\r\n                    self.currentDetailLogData = [].concat(result.rows);\r\n                }\r\n                else {\r\n                    self.currentDetailLogData = [];\r\n                }\r\n\r\n                self.renderLogDetail(result);\r\n\r\n            }).fail(function (error) { });\r\n        }\r\n    },\r\n    \r\n    /*\r\n    * Get Detail Render Params\r\n    */\r\n    getDetailRenderParams: function (selectedElement) {\r\n\r\n        var self = this;\r\n        var params, selectedDetailId;\r\n\r\n        switch (self.selectedCategoryObj.id) {\r\n            case self.logCategories.ACTIVITIES.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.ACTIVITIES.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.ACTIVITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idWorkItemFrom: selectedDetailId };\r\n\r\n                break;\r\n\r\n            case self.logCategories.ENTITIES.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.ENTITIES.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.ENTITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idEntity: selectedDetailId };\r\n\r\n                break;\r\n\r\n            case self.logCategories.USERS.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.USERS.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.USERS.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idUser: selectedDetailId };\r\n\r\n                break;\r\n        }\r\n\r\n        $.extend(params, { idActualPage: self.currentPage, pageSize: self.maxRows });\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n    *   Render the detail from the selected log item\r\n    */\r\n    renderLogDetail: function (selectedElementData) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        //Template Vars\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n        //empty previous content\r\n        detailWrapper.empty();\r\n\r\n        //removes the loading class\r\n        detailWrapper.removeClass(\"ui-bizagi-component-loading\");\r\n\r\n        //render the detail content, including headers and table\r\n        $.when(self.renderDetailContent()).done(function () {\r\n            var logFilterWrapper = $(\"#log-filter-wrapper\", content);\r\n\r\n            //Show/hide the no-result message\r\n            self.showDetailResultMessage();\r\n\r\n            //Add the interaction handlers\r\n            $(\"#back-general-content\", detailWrapper).click(function (e) {\r\n                e.preventDefault();\r\n                self.displayNoResults(false);\r\n                self.switchContent(self.containtersID.GENERAL);\r\n            });\r\n\r\n            $(\"#apply-filter\", logFilterWrapper).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                self.currentPage = 1;\r\n                self.applyDetailFilter();\r\n            });\r\n\r\n            $(\"#remove-filter\", logFilterWrapper).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                //Clean the filter inputs\r\n                $(\"input\", logFilterWrapper).val(\"\");\r\n\r\n                self.currentPage = 1;\r\n                self.applyDetailFilter();\r\n            });\r\n\r\n            $(\".listHeaderLinks\", detailWrapper).click(function (e) {\r\n                e.preventDefault();\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Show detail result message \r\n    */\r\n    showDetailResultMessage: function () {\r\n\r\n        var self = this;\r\n        var $detailWrapper = $(\"#activity-log-data-detail-wrapper\", self.getContent());\r\n\r\n        if (self.currentDetailLogData.length > 0) {\r\n            self.displayNoResults(false);\r\n            $(\".activity-log-table\", $detailWrapper).show();\r\n        }\r\n        else {\r\n            self.displayNoResults(true);\r\n            $(\".activity-log-table\", $detailWrapper).hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Apply detail filter\r\n    */\r\n    applyDetailFilter: function () {\r\n\r\n        var self = this;\r\n        var params = self.getFilterParams(), content = self.getContent();\r\n\r\n        //Checks if the selected category have the detail service, and invokes it\r\n        if (self.selectedCategoryObj.detailServiceMethod) {\r\n            $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\r\n\r\n                self.totalPages = result.total;\r\n\r\n                //Current Log Data\r\n                if (result.rows) {\r\n                    self.currentDetailLogData = [].concat(result.rows);\r\n                } else {\r\n                    self.currentDetailLogData = [];\r\n                }\r\n\r\n                //Get data for pagination\r\n                var pagData = self.getPaginationData();\r\n                var renderedTmpl = $.tmpl(self.detailContentTmpl, { logCategory: self.selectedCategoryObj.id, title: self.selectedCategoryObj.title, detailItems: self.currentDetailLogData, pagData: pagData });\r\n\r\n                //Remove table\r\n                $(\"#bz-workportal-activitylog-detailcontent-wrapper\", content).remove();\r\n                $(renderedTmpl).insertAfter(\"#activity-log-data-detail-header-wrapper\", content);\r\n\r\n                //Show/hide the no-result message\r\n                self.showDetailResultMessage();\r\n\r\n                //Set up pagination\r\n                self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", content), \"applyDetailFilter\");\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Get params for the filter\r\n    */\r\n    getFilterParams: function () {\r\n\r\n        var self = this,\r\n            content = self.getContent(),\r\n            $logFilterWrapper = $(\"#log-filter-wrapper\", content),\r\n            params = self.getDetailRenderParams(),\r\n            userFullName, attribDisplayName, entDisplayName;\r\n\r\n        if (self.selectedCategoryObj.id == self.logCategories.ENTITIES.id) {\r\n            userFullName = $(\"#filterUser\", $logFilterWrapper).val().toLowerCase();\r\n        } else if (self.selectedCategoryObj.id == self.logCategories.USERS.id) {\r\n            entDisplayName = $(\"#filterEntity\", $logFilterWrapper).val().toLowerCase();\r\n        }\r\n\r\n        attribDisplayName = $(\"#filterAttribute\", $logFilterWrapper).val().toLowerCase();\r\n\r\n        $.extend(params, { userFullName: userFullName, attribDisplayName: attribDisplayName, entDisplayName: entDisplayName });\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n    *   Renders the detail info from the selected log item\r\n    *   return (Object) returns the promise after processing and attaching to the DOM the detail from the selected log item\r\n    */\r\n    renderDetailContent: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            def = $.Deferred();\r\n\r\n        //DOM Vars\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n        //Get data for pagination\r\n        var pagData = self.getPaginationData();\r\n\r\n        //append tree to wrapper\r\n        $.when($.tmpl(self.detailHeaderTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, data: self.currentLogData[self.selectedLogItemIndex] }),\r\n                $.tmpl(self.detailContentTmpl, { logCategory: self.selectedCategoryObj.id, title: self.selectedCategoryObj.title, detailItems: self.currentDetailLogData, pagData: pagData })\r\n                 ).done(function (detailHeaderResult, detailContentResult) {\r\n\r\n                     detailWrapper.append(detailHeaderResult);\r\n                     (detailContentResult).insertAfter(\"#activity-log-data-detail-header-wrapper\", detailWrapper);\r\n\r\n                     //set up pagination\r\n                     self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", self.content), \"preprocessDetailRender\");\r\n\r\n                     def.resolve();\r\n                 });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n    *   Switch the view from general view, and detail\r\n    *   @param (string) contentToDisplay : Specifies wich element want to display, the DETAIL view or GENERAL\r\n    */\r\n    switchContent: function (contentToDisplay) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content),\r\n            detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n\r\n        if (self.containtersID.DETAIL == contentToDisplay) {\r\n            generalWrapper.hide();\r\n\r\n            detailWrapper.show();\r\n        } else {\r\n            generalWrapper.show();\r\n\r\n            detailWrapper.hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Display the \"no result\" message\r\n    */\r\n    displayNoResults: function (value) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if (value)\r\n            $(\"#activity-log-no-results\", content).show();\r\n        else\r\n            $(\"#activity-log-no-results\", content).hide();\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.activity.log', ['workportalFacade', 'dataService', bizagi.workportal.widgets.activity.log], true);","/**\r\n * Name: BizAgi Desktop Widget Authentication Log Implementation\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.authentication.log.extend(\"bizagi.workportal.widgets.authentication.log\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"authentication.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log\"),\r\n            \"authentication.log.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-fields\"),\r\n            \"authentication.log.button\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-button\"),\r\n            \"authentication.log.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-result\"),\r\n            \"authentication.log.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-pagination\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"authentication.log\");\r\n        self.fieldsContentTmpl = self.getTemplate(\"authentication.log.fields\");\r\n        self.buttonContentTmpl = self.getTemplate(\"authentication.log.button\");\r\n        self.resultContentTmpl = self.getTemplate(\"authentication.log.result\");\r\n        self.paginationTmpl = self.getTemplate(\"authentication.log.pagination\");\r\n\r\n        //load form data\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n    * Load form fields and combo's data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n        var params = [{ dataType: \"domains\" }, { dataType: \"events\" }, { dataType: \"subEvents\"}];\r\n\r\n        $.when(self.dataService.getAuthenticationLogData(params[0]),\r\n            self.dataService.getAuthenticationLogData(params[1]),\r\n            self.dataService.getAuthenticationLogData(params[2])\r\n        ).done(function (domainList, eventTypeList, subEvenTypesList) {\r\n\r\n            self.eventTypeList = eventTypeList[0].response;\r\n            self.subEventTypeList = subEvenTypesList[0].response;\r\n\r\n            var fields = $.tmpl(self.fieldsContentTmpl, { domainList: domainList[0],\r\n                eventTypeList: eventTypeList[0].response,\r\n                subEvenTypes: subEvenTypesList[0].response\r\n            });\r\n\r\n            //append fields to wrapper\r\n            content.append(fields);\r\n\r\n            self.setupDatePicker();\r\n            self.setupFooterButtons();\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Load dateTime plugin and apply to respective fields\r\n    */\r\n    setupDatePicker: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var formatDate = self.getDateFormat();\r\n        var timeFormat = bizagi.localization.getResource('timeFormat');\r\n        $(\".biz-wp-form-datepicker\", content).datetimepicker({\r\n            controlType: 'select',\r\n            dateFormat: formatDate,\r\n            timeFormat: timeFormat,\r\n            currentText: bizagi.localization.getResource(\"render-timeentry-now\"),\r\n            closeText: bizagi.localization.getResource(\"workportal-general-button-label-done\"),\r\n            timeText: bizagi.localization.getResource(\"workportal-project-plan-time-title\"),\r\n            hourText: bizagi.localization.getResource(\"reports-general-hour\").capitalize(),\r\n            minuteText: bizagi.localization.getResource(\"reports-general-minute\").capitalize()\r\n        });\r\n    },\r\n    /**\r\n     * Translate standard date format to jquery date picker\r\n     */\r\n    getDateFormat: function() {\r\n        var format = bizagi.localization.getResource('dateFormat');\r\n        var datePickerFormat = format;\r\n\r\n        // Fix month\r\n        if (datePickerFormat.indexOf(\"MMMM\") >= 0) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMMM\", \"MM\");\r\n        } else if (datePickerFormat.indexOf(\"MMM\") >= 0) {\r\n            // Month name short\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMM\", \"M\");\r\n        } else if (datePickerFormat.indexOf(\"MM\") >= 0) {\r\n            // Month two digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MM\", \"mm\");\r\n        } else if (datePickerFormat.indexOf(\"M\") >= 0) {\r\n            // Month one digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"M\", \"m\");\r\n        }\r\n        // Fix years\r\n        if (datePickerFormat.search(\"yyyy\") != -1) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"yyyy\", \"yy\");\r\n        } else {\r\n            if (datePickerFormat.search(\"yy\") != -1) {\r\n                datePickerFormat = datePickerFormat.replaceAll(\"yy\", \"y\");\r\n            }\r\n        }\r\n\r\n        datePickerFormat = datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n\r\n        return datePickerFormat;\r\n    },\r\n\r\n    /*\r\n    * Implement button behaviour\r\n    */\r\n    setupFooterButtons: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            button = $.tmpl(self.buttonContentTmpl, {});\r\n\r\n        content.append(button);\r\n\r\n        var widgetButtonSet = $(\"#authentication-log-data-buttonset\", content);\r\n\r\n        $(\"#btn-authentication-search\", widgetButtonSet).click(function (e) {\r\n            //clean old results\r\n            $(\".biz-wp-table\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n            var validateData = self.validateData();\r\n            // Next added lines intend to send the value in invariant format + H:mm to the server\r\n            var dtFrom = $(\"#sinceDate\", content).val();\r\n            var dtTo = $(\"#toDate\", content).val();\r\n            if (dtFrom != \"\") dtFrom = bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtFrom, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\");\r\n            if (dtTo != \"\") dtTo = bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtTo, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\");\r\n            if (!validateData.fieldsAreEmpty && validateData.errorMessage==\"\") {\r\n                var params = {\r\n                    action: \"AuthLog\",\r\n                    domain: $(\"#domainList\", content).val() != \"none\" ? $(\"#domainList\", content).val() : \"\",\r\n                    userName: $(\"#auth-log-user\", content).val(),\r\n                    dtFrom: dtFrom,\r\n                    dtTo: dtTo,\r\n                    eventSubType: $(\"#subEventType\", content).val() != self.subEventTypeList[0].displayName ? $(\"#subEventType\", content).val() : \"\",\r\n                    eventType: $(\"#eventType\", content).val() != self.eventTypeList[0].displayName ? $(\"#eventType\", content).val() : \"\",\r\n                    pagSize: self.maxElemShow\r\n                };\r\n\r\n                self.findResults(content, params);\r\n            } else {\r\n                bizagi.showMessageBox(validateData.errorMessage, \"Bizagi\", \"warning\");\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Validate required fields\r\n    */\r\n    validateData: function () {\r\n        var self = this,\r\n        content = self.getContent(),\r\n        validateResponse = { fieldsAreEmpty: false, errorMessage: \"\" },\r\n        errorMessage = \"\",\r\n        errorFieldName = \"\";\r\n        var dtFrom = $(\"#sinceDate\", content).val();\r\n        var dtTo = $(\"#toDate\", content).val();\r\n\r\n        if ($(\"#domainList\", content).val() == \"none\" &&\r\n            $(\"#user\", content).val() == \"\" &&\r\n            $(\"#eventType\", content).val() == self.eventTypeList[0].id &&\r\n            $(\"#subEventType\", content).val() == self.subEventTypeList[0].id &&\r\n            $(\"#sinceDate\", content).val() == \"\" &&\r\n            $(\"#toDate\", content).val() == \"\") {\r\n\r\n            validateResponse.fieldsAreEmpty = true;\r\n            validateResponse.errorMessage = bizagi.localization.getResource(\"workportal-widget-authentication-log-emptyfields-message\");\r\n        }\r\n        else if (dtFrom != \"\" && bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtFrom, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\") == \"\") {\r\n            errorFieldName = bizagi.localization.getResource(\"workportal-widget-authentication-log-datesince\");\r\n            errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n            errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n            validateResponse.errorMessage = errorMessage;\r\n        }\r\n        else if (dtTo != \"\" && bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtTo, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\") == \"\") {\r\n            errorFieldName = bizagi.localization.getResource(\"workportal-widget-authentication-log-dateto\");\r\n            errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n            errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n            validateResponse.errorMessage = errorMessage;\r\n        }\r\n        return validateResponse;\r\n    },\r\n\r\n    /*\r\n    * Find log results using the input data\r\n    */\r\n    findResults: function (content, params, pageToShow) {\r\n        var self = this;\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.pag = pageToShow : params.pag = 1;\r\n\r\n        $.when(\r\n             self.dataService.getAuthenticationLogResult(params)\r\n        ).done(function (resultList) {\r\n\r\n            //clean old results\r\n            $(\".biz-wp-table\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n\r\n            if (resultList.rows.length > 0) {\r\n                var resultTemplate = $.tmpl(self.resultContentTmpl, { resultList: resultList.rows });\r\n                content.append(resultTemplate);\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n                var summaryWrapper = $(\"#biz-wp-table-pager-wrapper\");\r\n                var pagerData = {};\r\n                var paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginationTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\"#biz-wp-table-pager-wrapper\"),\r\n                    clickCallBack: function (options) {\r\n                        self.findResults(content, params, options.page);\r\n                    }\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-authentication-log-none\"), \"Bizagi\", \"warning\");\r\n            }\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    }\r\n\r\n\r\n});","/**\r\n* Activiy log for  activities, entities, and users\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.encrypt.passwords\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"encrypt.passwords\");\r\n\r\n        var content = self.content = $.tmpl(template, {});\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n* Users requests for users\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.users.requests\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"users.requests\");\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n* admin/ Defaults Assignation User\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.defaults.assignation.user\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"defaults.assignation.user\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n* Activiy User Profiles\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.user.profiles\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"user.profiles\");\r\n        var content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    *Instances will implement this method\r\n    */\r\n    loadtemplates: function () { }\r\n});","/**\r\n* admin/ Dimensions\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.dimensions\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_DIMENSIONS;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"dimensions\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n* Activiy log for  activities, entities, and users\r\n* \r\n* @author David Andrés Niño\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.alarms\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"alarms\");\r\n\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n* admin/ User Licenses\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.user.licenses\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"user.licenses\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Document templates widget, for uploading and updating created templates via Bizagi Studio\r\n * \r\n * @author David Andrés Niño\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.document.templates\", {}, {\r\n    /*\r\n     *   Returns the widget name\r\n     */\r\n    getWidgetName: function() {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES;\r\n    },\r\n    /*\r\n     *   Renders the content for the current controller\r\n     */\r\n    renderContent: function() {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.document.templates\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin / processes\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.processes\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES;\r\n    },\r\n    \r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template = self.getTemplate(\"admin.processes.wrapper\"),\r\n            content;\r\n\r\n        self.comboProcess = self.getTemplate(\"admin.processes.combo.process\");\r\n        self.processEditTmpl = self.getTemplate(\"admin.processes.proc.edit\");\r\n        self.taskEditTmpl = self.getTemplate(\"admin.processes.task.edit\");\r\n        \r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin / Business Policies\r\n * \r\n * @author David Andres Niño Villalobos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template = self.getTemplate(\"admin.business.policies.wrapper\"),\r\n            content;\r\n\r\n        self.generalContentTmpl = self.getTemplate(\"admin.business.policies.content\");\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Decision Table\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.decision.table\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n       \r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Rules\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.rules\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n  \r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Tabs (properties / vocabulary contexts / components)\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.tabs\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n \r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Politics\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.politics\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n  \r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Vocabularies\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.vocabularies\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Language\r\n * \r\n * @author Ivan Taimal Narvaez\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.language\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.language.wrapper\");\r\n        var content;\r\n\r\n        self.panelWrapper = $.tmpl(self.getTemplate(\"admin.language.panel.wrapper\"));\r\n        self.generalTemplateListTmpl = self.getTemplate(\"admin.language.template.list\");\r\n        self.fileCultureName = self.getTemplate(\"admin.language.upload.file.culturename\");\r\n        self.bizagiObjectsList = self.getTemplate(\"admin.language.bizagi.objects.list\");\r\n        self.entitiesListTmpl = self.getTemplate(\"admin.language.entities.list\");\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin / Preferences\r\n * \r\n * @author Andres\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.preferences\", {}, {\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.preferences.wrapper\");\r\n        var content;\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin module to manage entities {Parametrics, Stakeholders}\r\n * @author Andres Felipe Arenas Vargas, Ricardo Alirio Perez Diaz\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.entities\", {}, {\r\n    /**\r\n     * Renders the content for the current controller\r\n     * @return {tmpl} The main template\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.entity.wrapper\");\r\n        self.content = $.tmpl(template, {});\r\n\r\n        self.loadtemplates();\r\n        return self.content;\r\n    },\r\n    /**\r\n     * Returns the widget name\r\n     * @return {string} Widget name\r\n     */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES;\r\n    },\r\n    /**\r\n     * Load form  entity empty if params is just \"guid\" or with data if params is \"guid\" and \"idRow\"\r\n     * @param params\r\n     */\r\n    getFormEntity: function (params) {\r\n        var self = this;\r\n        self.currentGuidForm = params.guidForm;\r\n        self.currentIdRow = params.idRow;\r\n        self.resp = $.Deferred();\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var facade = new bizagi.rendering.facade();\r\n            $.when(self.dataService.getAdminEntitiesForm(params)).done(function (responseForm) {\r\n                //Modify JSON form with params necessary to widget\r\n                responseForm.form.contextType = \"entity\";\r\n                $.when(facade.execute({ \"data\": responseForm, \"contexttype\": \"entity\", \"canvas\": $(\"#detailEntity\", self.panelWrapper), \"isEntityForm\": true }))\r\n                    .done(function (formRender) {\r\n                        if(self._referrer===\"stakeholder\") {\r\n                            self._associatedUser = (!bizagi.util.isEmpty(formRender.getRender(\"associatedUser\")[\"value\"]))? formRender.getRender(\"associatedUser\")[\"value\"] : (!bizagi.util.isEmpty(self._associatedUser))? self._associatedUser : undefined;\r\n                            self.resp.resolve(formRender);\r\n                        }\r\n                        if (params.idRow) {\r\n                            formRender.surrogatekey = params.idRow\r\n                        }\r\n\r\n                        formRender.internalSubmitOnChange = function (params) {\r\n                            var def = $.Deferred();\r\n                            $.when(self.internalSubmitOnChangeEntity(formRender))\r\n                                .done(function (responseSave) {\r\n                                    if (responseSave) {\r\n                                        var params = self.getSelectedItem();\r\n                                        params.idPageCache = formRender.idPageCache;\r\n                                        params.guidForm = self.currentGuidForm;\r\n                                        params.guid = params.guidEntity;\r\n                                        params.idRow = self.currentIdRow;\r\n                                        params.isStakeholder = self._referrer === \"stakeholder\";\r\n                                        self.getFormEntity(params);\r\n                                        def.resolve();\r\n                                    }\r\n                                })\r\n                                .fail(function () {\r\n                                    def.reject();\r\n                                });\r\n                            return def.promise();\r\n                        }\r\n\r\n                        formRender.processButton = function (buttonProperties) {\r\n                            formRender.endLoading();\r\n                            if (buttonProperties.action == 'save') {\r\n                                if (formRender.validateForm()) {\r\n                                    return $.when(self.saveFormEntity(formRender))\r\n                                        .done(function (responseSave) {\r\n                                            if (responseSave) {\r\n                                                self.drawSimpleGrid(self.getSelectedItem());\r\n                                            }\r\n                                        });\r\n                                }\r\n                            }\r\n                            else if (buttonProperties.action === 'cancel') {\r\n                                self.drawSimpleGrid(self.getSelectedItem());\r\n                            }\r\n                        };\r\n                    });\r\n            });\r\n        });\r\n        return self.resp.promise();\r\n    },\r\n    /**\r\n     * InternalSubmitOnChangeEntity, used when searching a user in the form,\r\n     * Temporaly submits the search result\r\n     * @param formRender\r\n     * @returns {*}\r\n     */\r\n    internalSubmitOnChangeEntity: function (formRender) {\r\n        var self = this;\r\n        var defSave = $.Deferred();\r\n        var params = self.getSelectedItem();\r\n        var serviceRender = new bizagi.render.services.service();\r\n        var renderValues = {};\r\n\r\n        formRender.collectRenderValues(renderValues);\r\n        $.when(serviceRender.multiactionService.submitData({\r\n            action: \"SUBMITONCHANGE\",\r\n            contexttype: \"entity\",\r\n            data: renderValues,\r\n            surrogatekey: (typeof formRender.surrogatekey !== \"undefined\" ? formRender.surrogatekey : false),\r\n            idPageCache: formRender.idPageCache\r\n        })).done(function (formRender) {\r\n            if (formRender.type == \"success\") {\r\n                defSave.resolve(true);\r\n            }\r\n            else {\r\n                defSave.reject();\r\n            }\r\n        }).fail(function (formError) {\r\n            bizagi.showMessageBox(formError.message);\r\n            defSave.reject();\r\n        });\r\n        return defSave.promise();\r\n    }\r\n});","/**\r\n// * Admin module to case massively reassign\r\n * \r\n// * @author Lilian Fernandez, David Nino\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.encrypt.passwords.extend(\"bizagi.workportal.widgets.admin.encrypt.passwords\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"encrypt.passwords\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.encrypt.passwords\").concat(\"#ui-bizagi-workportal-widget-admin-encrypt-passwords\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"encrypt.passwords\");\r\n        self.setupFooterButtons();\r\n        $(\"#encryp-password-data-text\", self.getContent()).on('paste', self.handlePaste);\r\n        $(\"#encryp-password-data-text-confirm\", self.getContent()).on('paste', self.handlePaste);\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    setupFooterButtons: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n        var params = {};\r\n\r\n        var widgetButtonSet = $(\"#encryp-password-data-buttonset\", content);\r\n\r\n        var noEmptyFields;\r\n        var equalFields;\r\n\r\n        $(\"#btn-encrypt\", widgetButtonSet).click(function (e) {\r\n            params.entry = $(\"#txtTextToEncrypt\").val();\r\n\r\n            noEmptyFields = self.validateData();\r\n            equalFields = self.comparePasswords();\r\n\r\n            if (noEmptyFields && equalFields) {\r\n                $.when(self.dataService.encryptString(params)).done(function (result) {\r\n                    $(\"#txtEncryptedText\", content).val(result.encryptedPassword);\r\n                }).fail(function (error) { });\r\n            }\r\n            else {\r\n\r\n                if (!noEmptyFields)\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-encrypt-passwords-emptyfields-message\"), \"Bizagi\", \"warning\");\r\n                else\r\n                    if (!equalFields)\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-encrypt-passwords-emptyfields-message-equals\"), \"Bizagi\", \"warning\");\r\n            }\r\n        });\r\n\r\n    },\r\n    /*\r\n    *\r\n    */\r\n    comparePasswords: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var password = $(\"#txtTextToEncrypt\", content).val();\r\n        var confirmPassword = $(\"#txtConfirmTextToEncrypt\", content).val();\r\n\r\n        if (password != confirmPassword) {\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Validate required fields\r\n    */\r\n    validateData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            fieldsAreEmpty = false;\r\n\r\n\r\n        if ($(\"#txtTextToEncrypt\", content).val() != \"\") {\r\n            fieldsAreEmpty = true;\r\n        }\r\n        else if ($(\"#txtConfirmTextToEncrypt\", content).val() != \"\") {\r\n            fieldsAreEmpty = true;\r\n        }\r\n\r\n        return fieldsAreEmpty;\r\n    },\r\n\r\n    handlePaste: function (e) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        // Get pasted data via clipboard API\r\n        clipboardData = e.originalEvent.clipboardData || window.clipboardData;\r\n        pastedData = clipboardData.getData('Text');\r\n\r\n        // Remove new line characters\r\n        var res = pastedData.replace(/\\r?\\n|\\r/g, \"\");\r\n        e.target.value = res;\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget Pending User Request\r\n* \r\n* @author Liliana Fernandez, David Andrés Niño Villalobos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.users.requests.extend(\"bizagi.workportal.widgets.admin.users.requests\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"users.requests\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests\"),\r\n            \"users.requests.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests-list\"),\r\n            \"users.requests.detail\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests-detail\"),\r\n            \"users.requests.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests-pagination\"),\r\n            \"users.requests.email\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests-email\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n\r\n        self.maxElemShow = 10; \r\n        self.maxPageToShow = 5;\r\n        self.currentPage = 1;\r\n\r\n        //Template vars\r\n        self.userRequest = self.getTemplate(\"users.requests\");\r\n        self.userRequestList = self.getTemplate(\"users.requests.list\");\r\n        self.userRequestDetail = self.getTemplate(\"users.requests.detail\");\r\n        self.userRequestpaginationTmpl = self.getTemplate(\"users.requests.pagination\");\r\n        self.userRequestemailTmpl = self.getTemplate(\"users.requests.email\");\r\n\r\n\r\n        //DOM Variables\r\n        self.userRequestListWrapper = $(\"#users-request-list-wrapper\", content);\r\n        self.userRequestDetailWrapper = $(\"#users-request-detail-wrapper\", content);\r\n\r\n\r\n        self.containtersID = {\r\n            LIST: \"list\",\r\n            DETAIL: \"detail\"\r\n        };\r\n\r\n        //load form data\r\n        self.setupInitialData();\r\n\r\n    },\r\n\r\n    /**\r\n    * Load form fields and combo's data\r\n    */\r\n    setupInitialData: function (selectedPage) {\r\n        var self = this;\r\n\r\n        //Switch content to detail\r\n        self.switchContent(self.containtersID.LIST);\r\n\r\n        if (selectedPage) {\r\n            self.currentPage = selectedPage;\r\n        }\r\n\r\n        var params = { pag: self.currentPage, pagSize: self.maxElemShow };\r\n\r\n        $.when(self.dataService.userPendingRequests(params)).done(function (result) {\r\n            self.renderUserRequestList(result);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * call authentication Info\r\n    */\r\n    authenticationInfo: function (userId) {\r\n        var self = this;\r\n        var params_1 = {\r\n            idUser: userId\r\n        };\r\n\r\n        $.when(self.dataService.userAuthenticationInfo(params_1)).done(function (resultAuthentication) {\r\n            self.renderUserRequestDetails(resultAuthentication);\r\n        });\r\n    },\r\n\r\n    /**\r\n    * generate Render Users Request\r\n    */\r\n    renderUserRequestList: function (data) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.userRequestListWrapper.empty();\r\n\r\n        var requestList = $.tmpl(self.userRequestList, { userData: data.rows });\r\n\r\n        // Format invariant dates\r\n        bizagi.util.formatInvariantDate(requestList, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n        self.userRequestListWrapper.append(requestList);\r\n\r\n        var usersRequestsSummaryWrapper = $(\"#users-requests-pager-wrapper\", content);\r\n\r\n        //Keep in track the total Records\r\n        self.totalRecords = data.records;\r\n\r\n        //keep in track the total pages\r\n        self.totalPages = data.total;\r\n\r\n        if (data.rows.length > 0) {\r\n\r\n            var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n            //var summaryWrapper = $(\"#authentication-log-pager-wrapper\");\r\n            var paginationHtml;\r\n\r\n            var pagerData = {};\r\n            // show or hide \"load more\" button\r\n            pagerData.pagination = (self.totalPages > 1);\r\n            pagerData.page = data.page;\r\n            pagerData.pages = {};\r\n            $(\"#biz-wp-userrequest-norequest\").css(\"display\",\"none\");\r\n            $(\"#users-request-list-wrapper .biz-wp-window \").css(\"display\",\"block\");\r\n            $(\"#users-request-list-wrapper .biz-wp-table \").css(\"display\",\"table\");\r\n        \r\n           \r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pagerData[\"pages\"][i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n\r\n            //load and append the paginator to the result table\r\n            paginationHtml = $.tmpl(self.userRequestpaginationTmpl, pagerData).html();\r\n            usersRequestsSummaryWrapper.append(paginationHtml);\r\n\r\n            //add data and behaviour to pager\r\n            $(\"ul\").bizagiPagination({\r\n                maxElemShow: self.maxElemShow,\r\n                totalPages: self.totalPages,\r\n                actualPage: data.page,\r\n                listElement: $(\"#users-requests-pager-wrapper\"),\r\n                clickCallBack: function (options) {\r\n                    self.setupInitialData(options.page);\r\n                }\r\n            });\r\n\r\n        }\r\n        else {\r\n           $(\"#biz-wp-userrequest-norequest\").show(\"500\");\r\n           $(\"#users-request-list-wrapper .biz-wp-window \").css(\"display\",\"none\");\r\n           $(\"#users-request-list-wrapper .biz-wp-table \").css(\"display\",\"none\");\r\n        }\r\n\r\n        //Add ui events\r\n        $(\".selectLink\", content).click(function (e) {\r\n            self.authenticationInfo(e.currentTarget.id);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Load Info Users requests detail\r\n    */\r\n    renderUserRequestDetails: function (resultAuthentication) {\r\n        var self = this;\r\n        var noEmptyField;\r\n        var content = self.getContent();\r\n        var requestDetail = $.tmpl(self.userRequestDetail, {resultAuthentication: resultAuthentication});\r\n\r\n        //Switch content to detai\r\n        self.switchContent(self.containtersID.DETAIL);\r\n\r\n        self.userRequestDetailWrapper.empty();\r\n        self.userRequestDetailWrapper.append(requestDetail);\r\n\r\n        self.idUser = resultAuthentication.idUser;\r\n        self.password = resultAuthentication.password;\r\n        self.enabled = resultAuthentication.Enabled;\r\n        self.isExpired = resultAuthentication.expired;\r\n        self.isLocked = resultAuthentication.locked;\r\n\r\n        //\r\n        $(\"#btn-passwordRandom\", content).click(function () {\r\n            $.when(self.dataService.generateRandomPassword()).done(function (result) {\r\n                $(\"#txtPasswordRequest\", content).val(result.randomPassword);\r\n            });\r\n        });\r\n        //\r\n        $(\"#btn-updateRequest\", content).click(function () {\r\n            var password = $(\"#txtPasswordRequest\").val();\r\n            noEmptyField = self.validateKey();\r\n            self.password = password;\r\n            \r\n            if (noEmptyField) {\r\n                self.dataService.generateDataToSendByEmail({idUser: self.idUser}).done(function (response) {\r\n                    self.showEmailtPopup(response);\r\n                    self.updateUser();\r\n                });\r\n            }\r\n            else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-request-emptyfields-message\"), \"Bizagi\", \"warning\");\r\n            }\r\n        });\r\n        //\r\n        $(\"#btn-cancelRequest\", content).click(function () {\r\n            self.setupInitialData();\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Switch Templates\r\n    */\r\n    switchContent: function (contentToDisplay) {\r\n        var self = this;\r\n\r\n        if (self.containtersID.DETAIL == contentToDisplay) {\r\n            self.userRequestListWrapper.hide();\r\n            self.userRequestDetailWrapper.show();\r\n        }\r\n        else {\r\n            self.userRequestListWrapper.show();\r\n            self.userRequestDetailWrapper.hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Update User\r\n    */\r\n    updateUser: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var expired = ($(\"#chkExpired\", content).length == 1)? $(\"#chkExpired\", content).is(\":checked\") : $(\"label[data-expired]\",content).data(\"expired\");\r\n        var params = {\r\n            idUser: self.idUser,\r\n            password: self.password,\r\n            enabled:  $(\"#chkActive\").is(\":checked\"),\r\n            expired: expired,\r\n            locked:  $(\"#chkBlocked\").is(\":checked\") };\r\n\r\n        $.when(self.dataService.updateUserAuthenticationInfo(params)).done(function (result) {\r\n            //    console.log(result);\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n    * generate Random Password\r\n    */\r\n    setupFooterButtons: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var widgetButtonSet = $(\"#users-request-data-buttonset-Password\", content);\r\n\r\n        $(\"#btn-passwordRandom\", widgetButtonSet).click(function () {\r\n            $.when(self.dataService.generateRandomPassword()).done(function (result) {\r\n                $(\"#txtPasswordRequest\", content).val(result.randomPassword);\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n    * generate Windows PopupContent email\r\n    */\r\n    showEmailtPopup: function (messageResponse) {\r\n        var self = this;\r\n        var doc = window.document;\r\n\r\n        var template = self.getTemplate(\"users.requests.email\");\r\n\r\n        // Opens a dialog in order to upload Email\r\n        var dialogBoxEmail = self.dialogBoxEmail = $(\"<div class= users-requests-email/>\");\r\n        dialogBoxEmail.empty();\r\n        dialogBoxEmail.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttonsEmail = {};\r\n\r\n        buttonsEmail[self.getResource(\"workportal-widget-admin-users-requests-button-label-send\")] = function () {\r\n            // Select button Send\r\n            var params = {\r\n                eMailTo: $(\"#txtTextTo\", dialogBoxEmail).val(),\r\n                subject: $(\"#txtSubject\", dialogBoxEmail).val(),\r\n                body: $(\"#txtBody\", dialogBoxEmail).val(),\r\n                userSecret: self.getUserSecret(self.password)\r\n            };\r\n\r\n            $.when(self.dataService.sendUserEmail(params)).done(function () {\r\n                self.closeUploadDialogEmail();\r\n            });\r\n\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-request-Send-message\"), \"Bizagi\", \"warning\");\r\n        };\r\n\r\n        // Cancel button Send\r\n        buttonsEmail[self.getResource(\"workportal-widget-admin-users-requests-button-label-notSend\")] = function () {\r\n            self.closeUploadDialogEmail();\r\n        };\r\n\r\n        // Render template\r\n        messageResponse.body = messageResponse.body.replace(/\\\\n/g, \"\\n\").replace(/\\\\/g, \"\");\r\n        $.tmpl(template, { messageResponse: messageResponse }).appendTo(dialogBoxEmail);\r\n        $(\".ui-bizagi-loading-message\").remove();\r\n\r\n        //Creates a dialog\r\n        dialogBoxEmail.dialog({\r\n            width: 500,\r\n            title: self.getResource(\"workportal-widget-admin-users-request-subtitle-email\"),\r\n            modal: true,\r\n            buttons: buttonsEmail,\r\n            close: function () {\r\n                self.closeUploadDialogEmail();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    closeUploadDialogEmail: function () {\r\n        var self = this;\r\n        self.dialogBoxEmail.dialog(\"destroy\");\r\n        self.dialogBoxEmail.remove();\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /**\r\n    * Validate required fields\r\n    */\r\n    validateKey: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var fieldAreEmpty = false;\r\n\r\n        if ($(\"#txtPasswordRequest\", content).val() !== \"\") {\r\n            fieldAreEmpty = true;\r\n        }\r\n\r\n        return fieldAreEmpty;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param inputValue\r\n     * @returns {*}\r\n     */\r\n    getUserSecret: function (inputValue) {\r\n        var C = CryptoJS;\r\n        var userFormsSpanner = C.enc.Utf8.parse(\"pc30n84e15lvdD68\");\r\n        var userFormsCode = CryptoJS.enc.Latin1.parse(\"1v00628X62bJE2mi\");\r\n        var aes = C.algo.AES.createEncryptor(userFormsSpanner, {\r\n            mode: C.mode.CBC,\r\n            padding: C.pad.Pkcs7,\r\n            iv: userFormsCode\r\n        });\r\n        var resultMain = aes.finalize(inputValue);\r\n        return C.enc.Base64.stringify(resultMain);\r\n    }\r\n});","    /**\r\n*  Name: BizAgi Desktop Widget Defaults Assignation User\r\n* \r\n* @author Liliana Fernandez\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.defaults.assignation.user.extend(\"bizagi.workportal.widgets.admin.defaults.assignation.user\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"defaults.assignation.user\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.defaults.assignation.user\").concat(\"#ui-bizagi-workportal-widget-admin-defaults-assignation-user\"),\r\n            \"defaults.assignation.user.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.defaults.assignation.user\").concat(\"#ui-bizagi-workportal-widget-admin-defaults-assignation-user-fields\"),\r\n            \"defaults.assignation.user.search\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.defaults.assignation.user\").concat(\"#ui-bizagi-workportal-widget-admin-defaults-assignation-user-search\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.generalContent = self.getTemplate(\"defaults.assignation.user\");\r\n        self.fieldsContent = self.getTemplate(\"defaults.assignation.user.fields\");\r\n        self.searchContent = self.getTemplate(\"defaults.assignation.user.search\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.processNavigation = [];\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n        self.setupProcessTree();\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        self.processTree = \"\";\r\n\r\n        //append fields to wrapper\r\n        var fields = $.tmpl(self.fieldsContent, {});\r\n        $(\"#defaults-assignation-user-home\", content).append(fields);\r\n        self.setupSearchusersButton();\r\n    },\r\n\r\n    /*\r\n    * initialize the process tree widget\r\n    */\r\n    setupProcessTree: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        bizagi.treeRoutSelected = [];\r\n        $(\"#treeLinksId\").remove(); \r\n\r\n        $(\"#processTree\",content).bind(\"processSelected\", function () {\r\n            self.setupAssignationToProcess();\r\n        });\r\n\r\n        self.processTree = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#processTree\", content),\r\n            authorizationContext: \"DefaultUser\"\r\n        }));\r\n\r\n        self.processTree.render();\r\n    },\r\n\r\n    /*\r\n    * Call service \r\n    */\r\n    setupAssignationToProcess: function () {\r\n        var self = this;\r\n        content = self.getContent();\r\n        var params = {};\r\n\r\n        var selectedProcessRoute = self.processTree.getTreeRouteSelected();\r\n        if (selectedProcessRoute.length > 0) {\r\n            params.idWfClass = selectedProcessRoute[0];    \r\n        }\r\n           $.when(self.dataService.getDefaultAssignationUserToProcess(params))\r\n            .done(function (result) {\r\n            $(\"#txtTextUserAssignation\", content).val(result.user);\r\n            });\r\n    },\r\n\r\n    /*\r\n    * initialize the users search form widget\r\n    */\r\n    setupUsersSearchForm: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var def = $.Deferred();\r\n        $(\"#defaults-assignation-user-home\").hide();\r\n\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#dinamicContent\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-select-link\")],\r\n            parentDef: def,\r\n            showBackButton : true\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            $(\"#dinamicContent\", content).html(\"\");\r\n            $(\"#defaults-assignation-user-home\", content).show();\r\n            if(userName) {\r\n                $(\"#txtTextUserAssignation\", content).val(userName);\r\n            }\r\n            if(userId) {\r\n                self.selectedUserId = userId;\r\n            }\r\n        });\r\n    },\r\n\r\n    saveAssignation: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var selectedProcessRoute = self.processTree.getTreeRouteSelected();\r\n\r\n        var params = {\r\n            idWfClass: (selectedProcessRoute.length > 0) ? selectedProcessRoute[0] : -1,\r\n            idUser: ($(\"#txtTextUserAssignation\", content).val() != \"\") ? self.selectedUserId : -1\r\n        };\r\n\r\n        if (params.idWfClass == -1) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-fail-select-process\"), \"Bizagi\", \"warning\");\r\n        }\r\n        else if (params.idUser == -1){\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-fail-select-user\"), \"Bizagi\", \"warning\");\r\n        }\r\n        else {\r\n            $.when(self.dataService.setDefaultAssignationUserToProcess(params))\r\n                .done(function (response) {\r\n                    if (response.assigned === \"true\" || response.assigned === true) {\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-ok\"), \"Bizagi\", \"warning\");\r\n                        $(\"#txtTextUserAssignation\", content).val(\"\");\r\n                        self.setupProcessTree();\r\n                    }\r\n                    else{\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-fail\"), \"Bizagi\", \"warning\");\r\n                    }\r\n                })\r\n                .fail(function (error) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-fail\"), \"Bizagi\", \"warning\");\r\n                    $(\"#txtTextUserAssignation\", content).val(\"\");\r\n                    self.setupProcessTree();\r\n                    bizagi.log(error);\r\n                });\r\n        }\r\n    },\r\n\r\n    /****************** EVENTOS ***********************/\r\n\r\n\r\n    setupSearchusersButton: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-searchUser\", content).click(function () {\r\n            self.setupUsersSearchForm();\r\n        });\r\n\r\n        $(\"#btn-clearUser\", content).click(function () {\r\n            $(\"#txtTextUserAssignation\", content).val(\"\");\r\n        });\r\n\r\n        $(\"#btn-saveUser\", content).click(function () {\r\n            self.saveAssignation();\r\n        });\r\n    }\r\n});\r\n\r\n \r\n","﻿/**\r\n * Name: BizAgi Desktop Widget User Profiles\r\n * \r\n * @author Liliana Fernandez.\r\n */\r\n\r\nbizagi.workportal.widgets.admin.user.profiles.extend(\"bizagi.workportal.widgets.admin.user.profiles\", {}, {\r\n\r\n    init: function(workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"user.profiles\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.profiles\").concat(\"#ui-bizagi-workportal-widget-admin-user-profiles\"),\r\n            \"user.profiles.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.profiles\").concat(\"#ui-bizagi-workportal-widget-admin-user-profiles-fields\"),\r\n            \"user.profiles.table\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.profiles\").concat(\"#ui-bizagi-workportal-widget-admin-user-profiles-table\"),\r\n            \"user.profiles.table.administrator\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.profiles\").concat(\"#ui-bizagi-workportal-widget-admin-user-profiles-table-administrator\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function() {\r\n        var self = this;\r\n        //Template vars \r\n        self.userProfilesFields = self.getTemplate(\"user.profiles.fields\");\r\n        self.userProfilesTable = self.getTemplate(\"user.profiles.table\");\r\n        self.userProfilesTableAdministrator = self.getTemplate(\"user.profiles.table.administrator\");\r\n        //        self.userProfilesPagination = self.workportalFacade.getTemplate(\"user.profiles.pagination\");\r\n    },\r\n\r\n    postRender: function() {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n     * Setup form data\r\n     */\r\n    setupData: function() {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n     * Load form fields and combo's data\r\n     */\r\n    setupInitialData: function() {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            params = { dataType: \"profiles\" };\r\n\r\n        $.when(self.dataService.getProfilesTypes(params),\r\n            self.dataService.getOrganizationsList()\r\n        ).done(function(profileTypes, orgList) {\r\n\r\n            var fields = $.tmpl(self.userProfilesFields, { profileList: profileTypes[0].response, orgList: orgList[0].response });\r\n            self.comboDefaultValue = profileTypes[0].response[0].id;\r\n\r\n            //append fields to wrapper\r\n            $(\"#general-content\", content).html(\"\");\r\n            $(\"#general-content\", content).append(fields);\r\n\r\n            self.setupMainButtons();\r\n            self.setupProfileComboEvent();\r\n            $(\"#dinamicContent\", content).html(\"\");\r\n            $(\"#dinamicContent2\", content).html(\"\");\r\n            $(\"#general-content\", content).show();\r\n\r\n        }).fail(function(error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n    /**\r\n     * Export data to excel\r\n     */\r\n    exportToExcel: function() {\r\n        var self = this;\r\n        var params = {\r\n            filterType: self.profileTypeId,\r\n            guidValueFilter: self.profileId,\r\n            orgId: self.organizationId\r\n        };\r\n        self.dataService.exportToExcelProfiles(params);\r\n    },\r\n    /*\r\n     * initialize the users search form widget\r\n     */\r\n    searchProfiles: function() {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            profileName = $(\"#txtTextnameProfile\", content).val();\r\n        self.profileTypeId = $(\"#profileTypeList\").val();\r\n        self.profileTypeName = $(\"#profileTypeList option:selected\").text();\r\n\r\n        if (self.profileTypeId == \"8\") {\r\n            self.organizationId = $(\"#organizationList\", content).val();\r\n        } else {\r\n            self.organizationId = \"\";\r\n        }\r\n\r\n        var params = {\r\n            action: \"searchProfiles\",\r\n            profileName: profileName,\r\n            profileType: self.profileTypeId,\r\n            orgId: self.organizationId\r\n        };\r\n\r\n\r\n        $.when(self.dataService.searchProfiles(params)).done(function(profileList) {\r\n            var fields = $.tmpl(self.userProfilesTable, { profileList: profileList.response });\r\n            $(\"#profilesTableId\").remove();\r\n            $(\"#general-content\", content).append(fields);\r\n            self.setupManageLink();\r\n        }).fail(function(error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Load Table user Profile Administrator\r\n     */\r\n    getUserByProfileId: function(profileId) {\r\n        var self = this,\r\n            content = self.getContent();\r\n        params = { action: \"getUsersByProfile\", idProfile: profileId, profileType: self.profileTypeId };\r\n        self.profileId = profileId;\r\n        $(\"#general-content\").hide();\r\n\r\n\r\n        $.when(self.dataService.getUsersByProfile(params)).done(function(userList) {\r\n            var list = [];\r\n            var limit = 1000;\r\n            var message = '';\r\n            if (userList.users.length > limit) {\r\n                list = userList.users.slice(0, limit);\r\n                message = bizagi.localization.getResource(\"workportal-widget-admin-user-profiles-limit-exceeded\");\r\n                message = message.replace(\"{0}\", limit).replace(\"{1}\", userList.users.length)\r\n            } else {\r\n                list = userList.users;\r\n            }\r\n            var fields = $.tmpl(self.userProfilesTableAdministrator, { userList: list, message: message });\r\n            $(\"#dinamicContent\", content).hide();\r\n            $(\"#dinamicContent2\", content).html(\"\");\r\n            $(\"#dinamicContent2\", content).append(fields);\r\n            self.setupManageButtons();\r\n        }).fail(function(error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Delete User Profile\r\n     */\r\n    removeUserFromProfile: function(idUser) {\r\n        var self = this,\r\n            content = self.getContent();\r\n        params = { action: \"removeUserFromProfile\", idProfile: self.profileId, profileType: self.profileTypeId, idUser: idUser };\r\n\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-user-profiles-invalidate-confirm-msg\"), \"Bizagi\", \"warning\"))\r\n            .done(function() {\r\n                $.when(self.dataService.removeUserFromProfile(params)).done(function(result) {\r\n                    if (result.removed) {\r\n                        self.getUserByProfileId(self.profileId);\r\n                    } else {\r\n                        bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-user-profiles-message-cant-delete-user-from-organization\"), self.getResource(\"workportal-general-word-message\"), \"hidden\");\r\n                    }\r\n                }).fail(function(error) {\r\n                    bizagi.log(error);\r\n                });\r\n            });\r\n\r\n    },\r\n\r\n    /*\r\n     * initialize the users search form widget\r\n     */\r\n    setupUsersSearchForm: function() {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var def = $.Deferred();\r\n        $(\"#dinamicContent2\").html(\"\");\r\n\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#dinamicContent2\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-general-select\")],\r\n            parentDef: def\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function(userId, userName, userGuid) {\r\n            self.addUserToProfile(userGuid);\r\n        });\r\n    },\r\n\r\n    addUserToProfile: function(userId) {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            params = { idProfile: self.profileId, profileType: self.profileTypeId, idUser: userId };\r\n\r\n        $.when(self.dataService.addUserToProfile(params)).done(function(result) {\r\n            self.getUserByProfileId(self.profileId);\r\n        }).fail(function(error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /***********EVENTS ***********************************/\r\n\r\n    setupMainButtons: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-searchUserProfiles\", content).click(function() {\r\n            self.searchProfiles();\r\n        });\r\n\r\n        $(\"#btn-clearUserProfiles\", content).click(function() {\r\n            $(\"#txtTextnameProfile\", content).val(\"\");\r\n            $(\"#profileTypeList\").val(self.comboDefaultValue);\r\n            $(\"#profilesTableId\", content).remove();\r\n            self.setupProfileComboEvent();\r\n        });\r\n    },\r\n\r\n    setupManageLink: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\".manageLink\", content).click(function() {\r\n            var profileId = this.getAttribute(\"id\");\r\n            self.profileId = profileId;\r\n            self.getUserByProfileId(self.profileId);\r\n        });\r\n    },\r\n\r\n    setupManageButtons: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-returnUserProfiles\", content).click(function() {\r\n            self.setupData();\r\n        });\r\n\r\n        $(\"#btn-downloadUserProfiles\", content).click(function() {\r\n            self.exportToExcel();\r\n        });\r\n\r\n        $(\"#btn-newUserProfiles\", content).click(function() {\r\n            self.setupUsersSearchForm();\r\n        });\r\n\r\n        $(\".deleteLink\", content).click(function() {\r\n            self.removeUserFromProfile($(this)[0].getAttribute(\"id\"));\r\n        });\r\n    },\r\n\r\n    setupProfileComboEvent: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var optionSelected = $(\"#profileTypeList\", content).find('option:selected').val();\r\n        if (optionSelected == \"8\") {\r\n            $(\"#organizationListDiv\").show();\r\n        }\r\n\r\n        $(\"#profileTypeList\", content).change(function() {\r\n            optionSelected = $(this).find('option:selected').val();\r\n\r\n            if (optionSelected == \"8\") {\r\n                $(\"#organizationListDiv\").show();\r\n            } else {\r\n                $(\"#organizationListDiv\").hide();\r\n            }\r\n        });\r\n\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget Dimensions\r\n* \r\n* @author Liliana Fernandez\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.dimensions.extend(\"bizagi.workportal.widgets.admin.dimensions\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"dimensions\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions\"),\r\n            \"dimensions.administrable\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions-administrable\"),\r\n            \"dimensions.properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions-properties\"),\r\n            \"dimensions.edit.properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions-edit-properties\"),\r\n            \"dimensions.process.tree\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions-process-tree\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        self.isInitialLoad = true;\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.generalContent = self.getTemplate(\"dimensions\");\r\n        self.listContent = self.getTemplate(\"dimensions.administrable\");\r\n        self.detailsContent = self.getTemplate(\"dimensions.properties\");\r\n        self.detailsEditContent = self.getTemplate(\"dimensions.edit.properties\");\r\n        self.detailsProcessTreeContent = self.getTemplate(\"dimensions.process.tree\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //load form data\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var columnDimensionsAdminWrapper = $(\"#column-dimensions-admin-wrapper\", content);\r\n        var columnDimensionsPropertiesWrapper = $(\"#column-dimensions-properties-wrapper\", content);\r\n\r\n        //append fields to wrapper\r\n        var list = $.tmpl(self.listContent, {});\r\n        var details = $.tmpl(self.detailsContent, {});\r\n\r\n        columnDimensionsAdminWrapper.html(list);\r\n        columnDimensionsPropertiesWrapper.html(details);\r\n\r\n        self.setupListProcessPanel1();\r\n        self.setupListProcessPanel2();\r\n\r\n        self.setupMainButtonsleft();\r\n        self.setupMainButtonsRight();\r\n    },\r\n\r\n    /*\r\n    * Dimensions List Panel1\r\n    */\r\n    setupDimensionsPanel1: function (updatePanel2) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var defer = $.Deferred();\r\n\r\n        $.when(self.dataService.getDimensions()\r\n        ).done(function (result) {\r\n            self.dimensions = result;\r\n\r\n            var $ulListAdmin = $('#DimenListAdmin', content);\r\n            var $ulListFixed = $('#DimenListFixed', content);\r\n\r\n            $ulListAdmin.find('dt').hide();\r\n\r\n            $('dd', $ulListAdmin).remove();\r\n            $('dd', $ulListFixed).remove();\r\n\r\n            $.each(result.dimensions, function (ind2, valu2) {\r\n\r\n                // When initially loaded dd DimensionsSelect elements must be hidden to prevent scroll issue\r\n                var elementClass = self.isInitialLoad ? \"ddDimensionsSelect hiddenDimensionsSelect\" : \"ddDimensionsSelect\"\r\n            \r\n                if (bizagi.util.parseBoolean(valu2.administrable)) {\r\n                    var $ulList = $ulListAdmin.find('dt#admin_' + valu2.idWfClass);\r\n                    $ulList.append('<dd id=\"' + valu2.id + '\" class=\"' + elementClass + '\">' + \"<span>\" + valu2.displayName + \"</span>\" + \"</dd>\");\r\n                } else {\r\n                    //var $ulList = $ulListFixed.find('dt#fixed_' + valu2.guidWfClass);\r\n                    var $ulList = $ulListFixed.find(\"dt#fixed_\" + valu2.guidWfClass.toLowerCase());\r\n                    $ulList.append('<dd id=\"' + valu2.guid + '\" class=\"' + elementClass + '\">' + \"<span>\" + valu2.displayName + \"</span>\" + \"</dd>\");     \r\n                }\r\n\r\n                $ulList.show();\r\n            });\r\n\r\n            if(self.isInitialLoad) {\r\n                // Remove class added to prevent scroll issue\r\n                setTimeout(function() {\r\n                    $ulListAdmin.find('dd').removeClass('hiddenDimensionsSelect');\r\n                    $ulListFixed.find('dd').removeClass('hiddenDimensionsSelect');\r\n                }, 500)\r\n            }\r\n            \r\n            self.isInitialLoad = false;\r\n\r\n            self.setupManageLink();\r\n            if (updatePanel2) {\r\n                self.setupDimensionsPanel2();\r\n            }\r\n\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * return the process name of the path\r\n     * @param {string} path \r\n     */\r\n    getProcessEntityPath:function (path) {\r\n        return path.split(\".\")[0]\r\n    },\r\n\r\n    /**\r\n     * return the namepath of the entity\r\n     * @param {string} path \r\n     */\r\n    getNameEntityPath:function (path) {\r\n        path = path.split(\".\");\r\n        path.shift();\r\n        return path.join(\".\");\r\n    },\r\n\r\n    /*\r\n    * Dimensions List Panel2\r\n    */\r\n    setupDimensionsPanel2: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if (self.dimensions.dimensions.length > 0) {\r\n            var resultfind = self.dimensions.dimensions[0];;\r\n            var description = resultfind.description;\r\n            var displayName = resultfind.displayName;\r\n            var id = resultfind.id;\r\n            var guid = resultfind.guid || \"\";\r\n            var idWfClass = resultfind.idWfClass;\r\n            var guidWfClass = resultfind.guidWfClass || \"\";\r\n            var administrable = resultfind.administrable;\r\n            var name = resultfind.name;\r\n            var nameEntityPath = \"\";\r\n            var entityPath = resultfind.entityPath;\r\n            self.fullPath = entityPath;\r\n            nameEntityPath = self.getNameEntityPath(entityPath);\r\n            \r\n            $(\"#lblNameRead\").text(name);\r\n            $(\"#lblDisplayNameRead\").text(displayName);\r\n            $(\"#lblProcessRead\").text(self.getProcessEntityPath(entityPath));\r\n            $(\"#lblDescriptionRead\").text(description);\r\n            $(\"#lblPhatRead\").text(nameEntityPath);\r\n            if (administrable) {\r\n                $(\"#lblId\").val(id);\r\n                $(\"#lblidWfClass\").val(idWfClass);\r\n            } else {\r\n                $(\"#lblId\").val(guid);\r\n                $(\"#lblidWfClass\").val(guidWfClass);\r\n            }\r\n            $(\"#lblIsAdministrable\").val(administrable);\r\n\r\n            if (!bizagi.util.parseBoolean(administrable)) {\r\n                $(\"#btn-deleteDimensions\").hide();\r\n                $(\"#btn-editDimensions\").hide();\r\n            }\r\n\r\n        } else {\r\n            $(\"#content-table-dimensions-admin\").hide();\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Process List Panel1\r\n    */\r\n    setupListProcessPanel1: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.when(self.dataService.getActiveWFClasses()).done(function (result) {\r\n            self.processList = result;\r\n\r\n            var $ulListAdmin = $('#DimenListAdmin', content);\r\n            var $ulListFixed = $('#DimenListFixed', content);\r\n\r\n            $.each(result.WFClasses, function (ind, valu) {\r\n                //agregamos el elemento al final de la lista (con append)\r\n                $ulListAdmin.append('<dt id=admin_' + valu.id + ' class=\"titleDimensionProcess\">' + valu.displayName + '</dt>');\r\n                $ulListFixed.append('<dt id=fixed_' + valu.guid + ' class=\"titleDimensionProcess\">' + valu.displayName + '</dt>');\r\n            });\r\n\r\n            self.setupDimensionsPanel1(true);\r\n\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Process List Panel2\r\n    */\r\n    setupListProcessPanel2: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.when(self.dataService.getActiveWFClasses()\r\n        ).done(function (result) {\r\n\r\n            $.each(result, function (ind1, valu1) {\r\n                $.each(valu1, function (ind2, valu2) {\r\n\r\n                    var resultfind = valu2;\r\n                    var name = resultfind.displayName;\r\n\r\n                    $(\"#lblProcessRead\").text(name);\r\n\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Select Display Dimensions\r\n    */\r\n    displayDimensionsById: function (dimensionId) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.each(self.dimensions.dimensions, function (ind1, value) {\r\n            if (value.guid !== undefined && value.guid.toLowerCase() === dimensionId.toLowerCase()) {\r\n                self.fillFieldsWithSelectedDimension(value, dimensionId);\r\n                return false;\r\n            }\r\n            else if (value.guid === undefined && value.id == dimensionId) {\r\n                self.fillFieldsWithSelectedDimension(value, dimensionId);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        $(\"#content-table-dimensions-edit\").remove();\r\n        $(\"#content-table-dimensions-admin\").show();\r\n    },\r\n\r\n\r\n    /*fill fields with values */\r\n    fillFieldsWithSelectedDimension: function (value, dimensionId) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n       var description = value.description;\r\n       var displayName = value.displayName;\r\n       var name = value.name;\r\n       var entityPath = value.entityPath;\r\n       var idWfClass = value.idWfClass;\r\n       var isAdmin = value.administrable;\r\n       var nameEntityPath = \"\";\r\n       self.fullPath = entityPath;\r\n       nameEntityPath = self.getNameEntityPath(entityPath);\r\n\r\n       $(\"#lblNameRead\").text(name);\r\n       $(\"#lblDisplayNameRead\").text(displayName);\r\n       $(\"#lblDescriptionRead\").text(description);\r\n       $(\"#lblProcessRead\").text(self.getProcessEntityPath(entityPath));\r\n       $(\"#lblPhatRead\").text(nameEntityPath);\r\n       $(\"#lblId\").val(dimensionId);\r\n       $(\"#lblIsAdministrable\").val(isAdmin);\r\n       $(\"#lblidWfClass\").val(idWfClass);\r\n       self.displayProcessById(idWfClass);\r\n\r\n       if (!bizagi.util.parseBoolean(isAdmin)) {\r\n           $(\"#btn-deleteDimensions\").hide();\r\n           $(\"#btn-editDimensions\").hide();\r\n       } else {\r\n           $(\"#btn-deleteDimensions\").show();\r\n           $(\"#btn-editDimensions\").show();\r\n           $(\"#img_select_path\").focus();\r\n       }\r\n   },\r\n\r\n    /*\r\n    * Select Display Process\r\n    */\r\n    displayProcessById: function (idWfClass) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.when(self.dataService.getActiveWFClasses()\r\n        ).done(function (result) {\r\n\r\n            $.each(result, function (ind1, valu1) {\r\n                $.each(valu1, function (ind2, valu2) {\r\n                    var resultfind = valu2;\r\n                    var idProcess = resultfind.Id || resultfind.id;\r\n\r\n                    if (idWfClass == idProcess) {\r\n                        var name = resultfind.displayName;\r\n                        $(\"#lblProcessRead\").text(name);\r\n                        return false;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * New Dimensions\r\n    */\r\n    newDimensionAdmin: function () {\r\n        var self = this;\r\n        var createTmpl = $.tmpl(self.detailsEditContent, { processList: self.processList.WFClasses });\r\n        self.action = \"create\";\r\n\r\n        $(\"#content-table-dimensions-edit\").remove();\r\n        $(\"#content-table-dimensions-admin\").hide();\r\n        $(\"#column-dimensions-properties-wrapper\").append(createTmpl);\r\n        self.setupManageButtons();\r\n        self.processComboOnChange();\r\n        $(\"#btn-newDimensions\").unbind(\"click\");\r\n        self.setupPathLink();\r\n    },\r\n\r\n    /*\r\n    * Validate required fields New Dimensions\r\n    */\r\n    validateData: function () {\r\n        var pattern = /[`~!@#$%^&*()|+\\-=?;:..’“'\"<>,€£¥•،٫؟»«\\{\\}\\[\\]\\\\\\/]+/gi;\r\n        var emptyField;\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if ($.trim($(\"#txtNameEdit\", content).val()) == \"\") {\r\n            emptyField = bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-name\");\r\n        }\r\n        else if ($.trim($(\"#txtDisplayNameEdit\", content).val()) == \"\") {\r\n            emptyField = bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-displayName\");\r\n        }\r\n        else if ($(\"#txtPhatEdit\", content).val() == \"\") {\r\n            emptyField = bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-path\");\r\n        }\r\n\r\n        if (emptyField) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-dimensions-comfirm-message\") + \": \" + emptyField, \"Bizagi\", \"warning\");\r\n            return;\r\n        } else if (pattern.test($(\"#txtNameEdit\", content).val())) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"bz-rp-sensorsedt-formvalidation-invalidcharts\") + \": \" + bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-name\"));\r\n            return;\r\n        } else if (pattern.test($(\"#txtDisplayNameEdit\", content).val())) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"bz-rp-sensorsedt-formvalidation-invalidcharts\") + \": \" + bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-displayName\"));\r\n            return;\r\n        } \r\n\r\n        return \"true\";\r\n    },\r\n\r\n    /*\r\n    * Implement Changes in Dimensions\r\n    */\r\n    applyDimensionsAdmin: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var displayName = $(\"#txtDisplayNameEdit\").val();\r\n        var name = $(\"#txtNameEdit\").val();\r\n        var idWfClass = $(\"#processTypeList\").val();\r\n        var description = $(\"#txtDescriptionEdit\").val();\r\n        var params = { displayName: displayName, name: name, idWfClass: idWfClass, entityPath: self.fullPath, description: description };\r\n        var noEmptyFields = self.validateData();\r\n\r\n        if (noEmptyFields == \"true\") {\r\n            $.when(self.dataService.createAdministrableDimension(params)\r\n            ).done(function (result) {\r\n                if (result.id) {\r\n                    self.setupMainButtonsleft();\r\n                    $(\"#content-table-dimensions-edit\").hide();\r\n                    $(\"#content-table-dimensions-admin\").show();\r\n\r\n                    $.when(self.setupDimensionsPanel1(false))\r\n                        .done(function () {\r\n                            self.displayDimensionsById(result.id);\r\n                        });\r\n                } else {\r\n                    bizagi.showMessageBox(result.message, \"Bizagi\", \"warning\");\r\n                }\r\n\r\n            }).fail(function (error) {\r\n                var message = jQuery.parseJSON(error.responseText);\r\n\r\n                bizagi.showMessageBox(message.message, \"Bizagi\", \"warning\");\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Implement Changes in Dimensions\r\n    */\r\n    cancelDimensionsAdmin: function () {\r\n        var self = this,\r\n          content = self.getContent();\r\n        $(\"#content-table-dimensions-edit\").remove();\r\n        if (self.dimensions.dimensions.length > 0)\r\n            $(\"#content-table-dimensions-admin\").show();\r\n        self.setupMainButtonsleft();\r\n    },\r\n\r\n    /*\r\n    * Delete Dimensions\r\n    */\r\n    deleteDimensionsAdmin: function (dimensionId) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var id = $(\"#lblId\").val();\r\n        var administrable = $(\"#lblIsAdministrable\").val();\r\n        var params = { id: id, administrable: administrable };\r\n\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-dimensions-invalidate-confirm-msg\"), \"Bizagi\", \"warning\"))\r\n            .done(function () {\r\n                $.when(self.dataService.deleteDimension(params)\r\n                ).done(function (result) {\r\n\r\n                    self.setupData();\r\n\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n            });\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    showEditInfo: function () {\r\n        var self = this;\r\n        var editTmpl = $.tmpl(self.detailsEditContent, { processList: self.processList.WFClasses });\r\n        self.action = \"edit\";\r\n\r\n        $(\"#content-table-dimensions-admin\").hide();\r\n        $(\"#column-dimensions-properties-wrapper\").append(editTmpl);\r\n\r\n        $(\"#processTypeList\").val($(\"#lblidWfClass\").val());\r\n        $(\"#txtNameEdit\").val($(\"#lblNameRead\").text());\r\n        $(\"#txtDisplayNameEdit\").val($(\"#lblDisplayNameRead\").text());\r\n        $(\"#txtDescriptionEdit\").val($(\"#lblDescriptionRead\").text());\r\n        $(\"#txtPhatEdit\").val($(\"#lblPhatRead\").text());\r\n\r\n        self.setupManageButtons();\r\n        self.processComboOnChange();\r\n        self.setupMainButtonsleft();\r\n        self.setupPathLink();\r\n        $(\"#img_select_path.iconSelectPath\").focus();\r\n    },\r\n    /*\r\n    * Edit Dimensions\r\n    */\r\n    editDimensionsAdmin: function () {\r\n        var self = this,\r\n            content = self.getContent;\r\n\r\n        var id = $(\"#lblId\").val();\r\n        var displayName = $(\"#txtDisplayNameEdit\").val();\r\n        var name = $(\"#txtNameEdit\").val();\r\n        var idWfClass = $(\"#processTypeList\").val();\r\n        var description = $(\"#txtDescriptionEdit\").val();\r\n        var params = { id: id, displayName: displayName, name: name, idWfClass: idWfClass, entityPath: self.fullPath, description: description };\r\n        var noEmptyFields = self.validateData();\r\n        var attributeName = self.getNameEntityPath(self.fullPath);\r\n\r\n        if (noEmptyFields == \"true\") {\r\n\r\n            $.when(self.dataService.editDimension(params)\r\n            ).done(function (result) {\r\n                if (result.id) {\r\n                    $(\"#lblidWfClass\").val(idWfClass);\r\n                    $(\"#lblNameRead\").text(name);\r\n                    $(\"#lblDisplayNameRead\").text(displayName);\r\n                    $(\"#lblDescriptionRead\").text(description);\r\n                    $(\"#lblPhatRead\").text(attributeName);\r\n                    $(\"#lblProcessRead\").text($(\"#processTypeList option[value=\" + $(\"#processTypeList\").val() + \"]\").text());\r\n                    $(\"#lblId\").val(id);\r\n\r\n                    $(\"#content-table-dimensions-edit\").remove();\r\n                    $(\"#content-table-dimensions-admin\").show();\r\n\r\n                    self.setupDimensionsPanel1(false);\r\n                } else {\r\n                    bizagi.showMessageBox(result.message, \"Bizagi\", \"warning\");\r\n                }\r\n            }).fail(function (error) {\r\n                var message = jQuery.parseJSON(error.responseText);\r\n\r\n                bizagi.showMessageBox(message.message, \"Bizagi\", \"warning\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Display Panel Path\r\n    */\r\n    displayPath: function () {\r\n        var self = this,\r\n          content = self.getContent;\r\n\r\n        $(\"#entities-tree-wrapper\", content).show();\r\n        $(\"#entities-tree-wrapper\").draggable();\r\n        $(\"#shadow-panel\").css({\r\n            'width': $(\".ui-dialog\").width(),\r\n            'height': $(\".ui-dialog\").height(),\r\n            'background-color': 'grey',\r\n            'opacity': 0.1\r\n        });\r\n        self.setupEntitiesTree();\r\n        self.setupEntitiesTreeButtons();\r\n    },\r\n\r\n    /*\r\n    * initialize the entities tree widget\r\n    */\r\n    setupEntitiesTree: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.entitiesTree = new bizagi.workportal.widgets.entitiestree(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#tree-content\", content),\r\n            idWfClass: $(\"#lblidWfClass\").val()\r\n        }));\r\n\r\n        self.entitiesTree.render();\r\n    },\r\n\r\n    /************************EVENTS ***********************************/\r\n\r\n    setupMainButtonsleft: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-newDimensions\", content).click(function () {\r\n            self.newDimensionAdmin();\r\n        });\r\n    },\r\n\r\n    setupMainButtonsRight: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-editDimensions\", content).click(function () {\r\n            self.showEditInfo();\r\n        });\r\n\r\n        $(\"#btn-deleteDimensions\", content).click(function () {\r\n            self.deleteDimensionsAdmin();\r\n        });\r\n    },\r\n\r\n    setupManageButtons: function () {\r\n        var self = this,\r\n        content = self.getContent();\r\n\r\n        $(\"#btn-applyDimensions\", content).click(function () {\r\n            if (self.action == \"create\") {\r\n                self.applyDimensionsAdmin();\r\n            } else {\r\n                self.editDimensionsAdmin();\r\n            }\r\n        });\r\n\r\n        $(\"#btn-cancelDimensions\", content).click(function () {\r\n            self.cancelDimensionsAdmin();\r\n        });\r\n    },\r\n\r\n    setupManageLink: function () {\r\n        var self = this,\r\n        content = self.getContent();\r\n\r\n        $(\".ddDimensionsSelect\", content).click(function () {\r\n\r\n            var dimensionId = this.getAttribute(\"id\");\r\n            self.dimensionId = dimensionId;\r\n            self.displayDimensionsById(self.dimensionId);\r\n            self.setupMainButtonsleft();\r\n\r\n        });\r\n    },\r\n\r\n    setupPathLink: function () {\r\n        var self = this,\r\n        content = self.getContent();\r\n        $(\"#img_select_path\").focus();\r\n\r\n        $(\"#img_select_path\", content).click(function () {\r\n\r\n            self.displayPath();\r\n        });\r\n    },\r\n\r\n    processComboOnChange: function () {\r\n        var self = this,\r\n        content = self.getContent();\r\n\r\n        $(\"#processTypeList\").click(function () {\r\n            $(\"#txtPhatEdit\").val(\"\");\r\n        });\r\n    },\r\n\r\n    setupEntitiesTreeButtons: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-close-tree\", content).unbind(\"click\").bind(\"click\", function () {\r\n            $(\"#entities-tree-wrapper\", content).hide();\r\n            $(\"#tree-content\", content).html(\"\");\r\n            $(\"#shadow-panel\").removeAttr(\"style\");\r\n        });\r\n\r\n        $(\"#btn-cancel-tree\", content).unbind(\"click\").bind(\"click\", function () {\r\n            $(\"#entities-tree-wrapper\", content).hide();\r\n            $(\"#tree-content\", content).html(\"\");\r\n            $(\"#shadow-panel\").removeAttr(\"style\");\r\n        });\r\n\r\n        $(\"#btn-save-tree\", content).unbind(\"click\").bind(\"click\", function () {\r\n            var treeRoute = self.entitiesTree.getTreeRouteSelected();\r\n            self.fullPath = treeRoute.path;\r\n            $(\"#txtPhatEdit\", content).val(treeRoute.name);\r\n            $(\"#entities-tree-wrapper\", content).hide();\r\n            $(\"#tree-content\", content).html(\"\");\r\n            $(\"#shadow-panel\").removeAttr(\"style\");\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Alert module\r\n *\r\n * @author David Nino\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.alarms.extend(\"bizagi.workportal.widgets.admin.alarms\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"alarms\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms\"),\r\n            \"alarms.task.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-list\"),\r\n            \"alarms.task.list.item\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-list-item\"),\r\n            \"alarms.task.detail\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-detail\"),\r\n            \"alarms.task.detail.alarm.editor\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-alarm-editor\"),\r\n            \"alarms.task.detail.list.table\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-detail-list-table\"),\r\n            \"alarms.task.detail.alarm.recipients\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-detail-alarm-recipients\"),\r\n            \"alarms.task.detail.alarm.recipients.table\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-detail-alarm-recipients-table\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.containtersID = {\r\n            GENERAL: \"general\",\r\n            DETAIL: \"detail\"\r\n        };\r\n\r\n        self.listID = {\r\n            APPLICATION: {\r\n                name: \"ListBoxApplication\",\r\n                update: \"WORKFLOW\",\r\n                serviceMethod: \"getApplicationCategoriesList\"\r\n            },\r\n            WORKFLOW: {\r\n                name: \"ListBoxWFClass\",\r\n                update: \"VERSION\",\r\n                serviceMethod: \"getApplicationProcesses\"\r\n            },\r\n            VERSION: {\r\n                name: \"ListBoxWFVersion\",\r\n                update: \"TASKS\",\r\n                serviceMethod: \"getProcessVersion\"\r\n            },\r\n            TASKS: {\r\n                name: \"ListBoxWorkFlow\",\r\n                update: \"\",\r\n                serviceMethod: \"getProcessTasks\"\r\n            }\r\n        };\r\n\r\n        self.widgetMode = {\r\n            VIEW_MODE: \"viewMode\",\r\n            EDIT_MODE: \"editMode\"\r\n        };\r\n\r\n        self.alertData = {};\r\n\r\n        self.taskListTmpl = self.getTemplate(\"alarms.task.list\");\r\n        self.taskListItemTmpl = self.getTemplate(\"alarms.task.list.item\");\r\n        self.taskDetailTmpl = self.getTemplate(\"alarms.task.detail\");\r\n        self.taskDetailAlarmEditor = self.getTemplate(\"alarms.task.detail.alarm.editor\");\r\n\r\n        self.taskListTableTmpl = self.getTemplate(\"alarms.task.detail.list.table\");\r\n\r\n        self.taskDetailAlarmRecipientsTmpl = self.getTemplate(\"alarms.task.detail.alarm.recipients\");\r\n        self.taskDetailAlarmRecipientsTableTmpl = self.getTemplate(\"alarms.task.detail.alarm.recipients.table\");\r\n\r\n        self.initRenderTaskList();\r\n    },\r\n\r\n    initRenderTaskList: function () {\r\n        var self = this;\r\n\r\n        self.switchContent(self.containtersID.GENERAL);\r\n\r\n        var params = {\r\n            action: \"Applications\"\r\n        };\r\n\r\n        $.when(self.dataService.getApplicationCategoriesList(params)).done(function (data) {\r\n            self.renderTaskList(data);\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderTaskList: function (data) {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var generalWrapper = $(\"#form-alarm-task-list\", content);\r\n\r\n        generalWrapper.empty();\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskListTmpl).appendTo(generalWrapper);\r\n\r\n        //self.fillTaskListColumnByID( self.listID.APPLICATION, data);\r\n        self.fillTaskListColumnByID(\"APPLICATION\", data);\r\n\r\n        $(\"#btn-alarms\", generalWrapper).click(function (e) {\r\n\r\n            if (self.alertData) {\r\n                if (self.alertData[\"idTask\"] && self.alertData[\"idTask\"] != \"\") {\r\n\r\n                    $.when(self.dataService.getTaskAlarms({\r\n                            idTask: self.alertData[\"idTask\"]\r\n                        }),\r\n                        self.dataService.getLapseMode(),\r\n                        self.dataService.getRecurrMode(),\r\n                        self.dataService.getScheduleType(),\r\n                        self.dataService.getBossList()\r\n\r\n                    ).done(function (taskAlarms, lapseModeList, recurrModeList, scheduleTypeList, bossList, alarmRecipientsList) {\r\n\r\n                        self.renderTaskDetail();\r\n\r\n                        self.renderTaskListTable(taskAlarms[0]);\r\n\r\n                        self.renderAlarmEditor(lapseModeList[0], recurrModeList[0], scheduleTypeList[0]);\r\n\r\n                        self.renderAlarmRecipients(bossList[0], true);\r\n\r\n                        self.switchContent(self.containtersID.DETAIL);\r\n\r\n                        self.switchWidgetMode(self.widgetMode.VIEW_MODE);\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderTaskDetail: function () {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content);\r\n        detailWrapper.empty();\r\n\r\n        var application = self.alertData[\"idAppText\"],\r\n            workflow = self.alertData[\"idWFClassText\"],\r\n            version = self.alertData[\"versionText\"],\r\n            task = self.alertData[\"idTaskText\"],\r\n            // Render Form\r\n            detailTmpl = self.getTemplate(\"alarms.task.detail\");\r\n\r\n        var detailcnt = $.tmpl(detailTmpl, {\r\n            application: application,\r\n            workflow: workflow,\r\n            version: version,\r\n            task: task\r\n        });\r\n        detailWrapper.append(detailcnt).show();\r\n\r\n        //Add handlers\r\n        $(\"#btn-alarm-browser\", detailWrapper).click(function () {\r\n\r\n            //Clear data\r\n            self.alertData = {};\r\n\r\n            self.initRenderTaskList();\r\n        });\r\n\r\n        $(\"#btn-disable-alarms\", detailWrapper).click(function () {\r\n            self.callEnableDisableAlarmsService();\r\n        });\r\n\r\n        $(\"#btn-enable-alarms\", detailWrapper).click(function () {\r\n            self.callEnableDisableAlarmsService();\r\n        });\r\n\r\n\r\n        $(\"#btn-save-changes\", detailWrapper).click(function () {\r\n            //Validates if there is any error message from the Alarm Editor\r\n            var validateResult = self.validateAlarmEditor();\r\n\r\n            if (validateResult == \"\") {\r\n                self.sendAlarmEditorData(true);\r\n            } else {\r\n                bizagi.showMessageBox(validateResult, \"Bizagi\", \"warning\");\r\n            }\r\n        });\r\n\r\n        $(\"#btn-back\", detailWrapper).click(function () {\r\n            //switch to edit mode\r\n            self.switchWidgetMode(self.widgetMode.VIEW_MODE);\r\n\r\n            //Clear selected elements\r\n            self.clearSelectedAlarm();\r\n\r\n            self.resetAlarmEditor();\r\n\r\n            self.resetAlarmRecipientsTable();\r\n        });\r\n\r\n        $(\"#btn-add-alarm\", detailWrapper).click(function () {\r\n\r\n            //Validates if there is any error message from the Alarm Editor\r\n            var validateResult = self.validateAlarmEditor();\r\n\r\n            if (validateResult == \"\") {\r\n                self.sendAlarmEditorData();\r\n            } else {\r\n                bizagi.showMessageBox(validateResult, \"Bizagi\", \"warning\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderAlarmEditor: function (lapseModeList, recurrModeList, scheduleTypeList) {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            formEditorWrapper = $(\"#alarm-editor-form-wrapper\", detailWrapper);\r\n\r\n        formEditorWrapper.empty();\r\n\r\n        if (!self.alarmEditorData) {\r\n\r\n            self.localizateScheduleType(scheduleTypeList.scheduleType);\r\n\r\n            self.alarmEditorData = {\r\n                lapseModeList: lapseModeList.lapseMode,\r\n                recurrModeList: recurrModeList.recurrMode,\r\n                scheduleTypeList: scheduleTypeList.scheduleType\r\n            };\r\n        }\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskDetailAlarmEditor, {\r\n            lapseModeList: self.alarmEditorData.lapseModeList,\r\n            recurrModeList: self.alarmEditorData.recurrModeList,\r\n            scheduleTypeList: self.alarmEditorData.scheduleTypeList\r\n        }).appendTo(formEditorWrapper);\r\n\r\n        //Alarm Editor Handlers\r\n        $('input:radio[name=RadioButtonListLapseMode]', detailWrapper).on(\"change\", function (event) {\r\n            self.handleRadioButtonFields(event.currentTarget);\r\n        });\r\n\r\n        $('input:radio[name=RadioButtonListRecurMode]', detailWrapper).on(\"change\", function (event) {\r\n            self.handleRadioButtonFields(event.currentTarget);\r\n        });\r\n\r\n        $(\"#TextBoxAlarmTime\", detailWrapper).on(\"change\", function (event) {\r\n            self.validateInputFields(event.currentTarget);\r\n        });\r\n\r\n        $(\"#TextBoxRecurTime\", detailWrapper).on(\"change\", function (event) {\r\n            self.validateInputFields(event.currentTarget);\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n     * Localizate Schedule Type\r\n     */\r\n    localizateScheduleType: function (scheduleTypeList){\r\n        for(var iType = 0; iType < scheduleTypeList.length; iType += 1 ){\r\n            scheduleTypeList[iType].displayName = bizagi.localization.getResource(\"workportal-general-word-time-\" + scheduleTypeList[iType].displayName.toLowerCase());\r\n        }\r\n    },\r\n\r\n    sendAlarmEditorData: function (isUpdate) {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", detailWrapper),\r\n            isCheckBoxOn = $(\"#CheckBoxToCurrentAssignee\", alarmEditorFormWrapper).is(':checked'),\r\n            params = {},\r\n            serviceMethodName;\r\n\r\n        params.idTask = self.alertData.idTask;\r\n        params.idRecurrMode = $('input:radio[name=RadioButtonListRecurMode]:checked').val();\r\n        params.idLapseMode = $('input:radio[name=RadioButtonListLapseMode]:checked').val();\r\n        params.scheduleType = $(\"#DropDownListRecurTime\", alarmEditorFormWrapper).val();\r\n        params.alarmTime = $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val();\r\n        params.alarmRecurrTime = $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val();\r\n\r\n        if (params.alarmTime == \"\")\r\n            params.alarmTime = 0;\r\n\r\n        if (params.alarmRecurrTime == \"\")\r\n            params.alarmRecurrTime = 0;\r\n\r\n        if (isCheckBoxOn === true) {\r\n            params.sendToCurrentAssignee = 1;\r\n        } else if (isCheckBoxOn === false) {\r\n            params.sendToCurrentAssignee = 0;\r\n        }\r\n\r\n        if (isUpdate) {\r\n            params.idAlarm = self.selectedAlarm.idAlarm;\r\n            serviceMethodName = \"editAlarm\";\r\n        } else\r\n            serviceMethodName = \"addAlarm\";\r\n\r\n        $.when(self.dataService[serviceMethodName](params)).done(function (data) {\r\n            if (data.response)\r\n                self.refreshTaskListTable();\r\n        });\r\n    },\r\n\r\n    refreshTaskListTable: function () {\r\n        var self = this;\r\n\r\n        self.clearSelectedAlarm();\r\n        self.resetAlarmEditor();\r\n        self.switchWidgetMode(self.widgetMode.VIEW_MODE);\r\n\r\n        $.when(self.dataService.getTaskAlarms({\r\n            idTask: self.alertData[\"idTask\"]\r\n        })).done(function (data) {\r\n            self.renderTaskListTable(data);\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    refreshAlarmRecipientsTable: function () {\r\n\r\n        var self = this;\r\n\r\n        //self.clearSelectedAlarm();\r\n        //self.resetAlarmEditor();\r\n\r\n        //self.switchWidgetMode(self.widgetMode.VIEW_MODE);\r\n\r\n        var params = {\r\n            idAlarm: self.selectedAlarm.idAlarm\r\n        };\r\n        $.when(self.dataService.getAlarmRecipients(params)).done(function (data) {\r\n            self.renderAlarmRecipientsTable(data);\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderTaskListTable: function (data) {\r\n        var self = this;\r\n        var content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmTableListWrapper = $(\"#alarm-list-table-wrapper\", detailWrapper);\r\n\r\n        alarmTableListWrapper.empty();\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskListTableTmpl, {\r\n            alarmList: data.alarms\r\n        }).appendTo(alarmTableListWrapper);\r\n\r\n        //Stores the alarm list obj\r\n        self.alarmsList = [].concat(data.alarms);\r\n\r\n\r\n        //Detect manually the alarms State : Enable/Disable\r\n        if (self.alarmsList.length > 0) {\r\n            if (self.alarmsList[0].active == \"true\")\r\n                self.switchEnableAlarms(true);\r\n            else\r\n                self.switchEnableAlarms(false);\r\n        } else\r\n            self.switchEnableAlarms(false);\r\n\r\n\r\n        //Reset any selected alarm\r\n        self.selectedAlarm = undefined;\r\n\r\n        $(\".edit\", alarmTableListWrapper).click(function (e) {\r\n\r\n            //switch to edit mode\r\n            self.switchWidgetMode(self.widgetMode.EDIT_MODE);\r\n\r\n            //Clear selected elements\r\n            self.clearSelectedAlarm();\r\n\r\n            //Highlight the selected alarm row\r\n            $($(e.currentTarget).closest(\"tr\")[0]).addClass('selected');\r\n\r\n            //Fill the detail form using the idalarm as a referente\r\n            self.fillAlarmDetailForm($(e.currentTarget).data(\"idalarm\"));\r\n\r\n            // Retreives the Recipients form that Alarm\r\n            var params = {\r\n                idAlarm: $(e.currentTarget).data().idalarm\r\n            };\r\n            $.when(self.dataService.getAlarmRecipients(params)).done(function (data) {\r\n                self.renderAlarmRecipientsTable(data);\r\n            });\r\n        });\r\n\r\n        $(\".delete\", alarmTableListWrapper).click(function (e) {\r\n            //console.log('delete ',$(e.currentTarget).data().idalarm);\r\n\r\n            var idAlarm = $(e.currentTarget).data(\"idalarm\");\r\n\r\n            $.when(self.dataService.deleteAlarm({\r\n                idAlarm: idAlarm\r\n            })).done(function (data) {\r\n                if (data.response === true) {\r\n                    //switch to view mode\r\n                    self.switchWidgetMode(self.VIEW_MODE);\r\n\r\n                    self.refreshTaskListTable();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    clearSelectedAlarm: function () {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmTableListWrapper = $(\"#alarm-list-table-wrapper\", content);\r\n\r\n        $(\"tr\", alarmTableListWrapper).removeClass(\"selected\");\r\n\r\n        //Clears the selected element\r\n        self.selectedAlarm = undefined;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    resetAlarmEditor: function () {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", content),\r\n            fields = $('input[name = RadioButtonListLapseMode]', alarmEditorFormWrapper).length + 1;\r\n\r\n        while (fields-- > 1) {\r\n            $('input[name=RadioButtonListLapseMode][value=' + fields + ']', alarmEditorFormWrapper)[0].checked = false;\r\n            $('input[name=RadioButtonListRecurMode][value=' + fields + ']', alarmEditorFormWrapper)[0].checked = false;\r\n        }\r\n\r\n        //alarmTime\r\n        $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val(\"\");\r\n\r\n        //alarmTime\r\n        $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val(\"\");\r\n\r\n        //idScheduleType\r\n        $(\"#DropDownListRecurTime\", alarmEditorFormWrapper).val(\"1\");\r\n\r\n        $(\"#CheckBoxToCurrentAssignee\", alarmEditorFormWrapper).attr(\"checked\", false);\r\n\r\n        self.resetAlarmRecipientsTable();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    resetAlarmRecipientsTable: function () {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmRecipientsTableWrapper = $(\"#alarm-recipients-table-wrapper\", content);\r\n        alarmRecipientsTableWrapper.empty();\r\n\r\n        //Resets current selection\r\n        $(\"#DropDownListRecipients\", content).val(0);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderAlarmRecipients: function (data, isAlarmSelected) {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmRecipientsListWrapper = $(\"#alarm-recipients-form-wrapper\", detailWrapper);\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskDetailAlarmRecipientsTmpl, {\r\n            bossList: data.bosses\r\n        }).appendTo(alarmRecipientsListWrapper);\r\n\r\n\r\n        $(\"#btn-add-recipient\", alarmRecipientsListWrapper).click(function () {\r\n            if (self.currentWidgetMode == self.widgetMode.EDIT_MODE) {\r\n\r\n                //Gets the selected recipient\r\n                var params = {\r\n                    idRecipient: $(\"#DropDownListRecipients\", alarmRecipientsListWrapper).val(),\r\n                    idAlarm: self.selectedAlarm.idAlarm\r\n                };\r\n                \r\n                if(params.idRecipient){\r\n                    $.when(self.dataService.addRecipientToAlarm(params)).done(function (data) {\r\n                        if (data.response === true) {\r\n                            self.refreshAlarmRecipientsTable();\r\n                        } else {\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-error\"), \"Bizagi\", \"warning\");\r\n                        }\r\n                    });\r\n                }else{\r\n                    bizagi.showMessageBox(bizagi.localization.getResource('workportal-general-word-select-one-option'), \"Bizagi\", \"warning\");\r\n                }\r\n            }\r\n        });\r\n\r\n        $(\"#btn-delete-recipient\", alarmRecipientsListWrapper).click(function () {\r\n            if (self.currentWidgetMode == self.widgetMode.EDIT_MODE) {\r\n\r\n                var alarmRecipientsTableWrapper = $(\"#alarm-recipients-table-wrapper\", detailWrapper),\r\n                    checkedElements = $(\"input:checked\", alarmRecipientsTableWrapper);\r\n\r\n                if (checkedElements.length > 0) {\r\n\r\n                    var recipientsIDs = [],\r\n                        i = checkedElements.length;\r\n\r\n                    while (i-- > 0) {\r\n                        recipientsIDs.push(($(checkedElements[i]).data(\"idrecipient\")));\r\n                    }\r\n\r\n                    //Gets the selected recipient\r\n                    var recipientsString = JSON.stringify({\r\n                            \"recipients\": recipientsIDs\r\n                        }),\r\n                        params = {\r\n                            \"idRecipients\": recipientsString\r\n                        };\r\n\r\n                    $.when(self.dataService.deleteRecipientsFromAlarm(params)).done(function (data) {\r\n                        if (data.deletedRecipients.length > 0) {\r\n                            self.refreshAlarmRecipientsTable();\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderAlarmRecipientsTable: function (data) {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmRecipientsTableWrapper = $(\"#alarm-recipients-table-wrapper\", detailWrapper);\r\n\r\n        alarmRecipientsTableWrapper.empty();\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskDetailAlarmRecipientsTableTmpl, {\r\n            recipientsList: data.recipients\r\n        }).appendTo(alarmRecipientsTableWrapper);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    fillAlarmDetailForm: function (idAlarm) {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", detailWrapper),\r\n            i = self.alarmsList.length,\r\n            selectedAlarm;\r\n\r\n        //Gets the selected alarm data\r\n        while (i-- > 0) {\r\n            if (self.alarmsList[i].idAlarm == idAlarm) {\r\n                selectedAlarm = self.alarmsList[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        self.selectedAlarm = selectedAlarm;\r\n\r\n        //idLapseMode\r\n        $('input[name=RadioButtonListLapseMode][value=' + selectedAlarm.idLapseMode + ']', alarmEditorFormWrapper)[0].checked = true;\r\n\r\n        //idRecurrMode\r\n        $('input[name=RadioButtonListRecurMode][value=' + selectedAlarm.idRecurrMode + ']', alarmEditorFormWrapper)[0].checked = true;\r\n\r\n        //alarmTime\r\n        $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val(selectedAlarm.alarmTime);\r\n\r\n        //alarmTime\r\n        $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val(selectedAlarm.alarmRecurrTime);\r\n\r\n        //idScheduleType\r\n        $(\"#DropDownListRecurTime\", alarmEditorFormWrapper).val(selectedAlarm.idScheduleType);\r\n\r\n        // QA-873 the 'send to current assignee' element must be updated.\r\n        //Send to Current Assignee\r\n        $(\"#CheckBoxToCurrentAssignee\", alarmEditorFormWrapper).prop(\"checked\", selectedAlarm.sendToCurrAssignee);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    handleRadioButtonFields: function (field) {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", content),\r\n            fieldValue = field.value;\r\n\r\n        if (field.name == \"RadioButtonListLapseMode\") {\r\n            //Validates if the idLapseMode its diferent to 2(On Expiration), so then, the Alarm Time must be more than 0\r\n            if (fieldValue != 2) {\r\n                $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).attr('disabled', false);\r\n            } else {\r\n                //Empty the field\r\n                $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val(\"\");\r\n                $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).attr('disabled', true);\r\n            }\r\n        } else\r\n        if (field.name == \"RadioButtonListRecurMode\") {\r\n            //Validates if the idRecurrMode its equal to 1 (Each recurr time), so then, the Alarm Time must be more than 0\r\n            if (fieldValue != 1) {\r\n                $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).attr('disabled', true);\r\n\r\n                //Empty the field\r\n                $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val(\"\");\r\n            } else\r\n                $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).attr('disabled', false);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    validateInputFields: function (field) {\r\n\r\n        var maxValueAllowedInt32 = 2147483647;\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", content),\r\n            alertMessage = \"\",\r\n            fieldValue = parseInt(field.value);\r\n\r\n        if (isNaN(fieldValue))\r\n            field.value = '';\r\n        else\r\n        if (fieldValue < 0)\r\n            field.value = fieldValue * -1;\r\n        else if(fieldValue > maxValueAllowedInt32) {\r\n            field.value = maxValueAllowedInt32;\r\n        }\r\n        else {\r\n\r\n            if (field.id == \"TextBoxAlarmTime\") {\r\n                var idLapseMode = $($('input:radio[name=RadioButtonListLapseMode][checked=checked]')[0]).val(),\r\n                    alarmTime = fieldValue;\r\n\r\n                if (!(idLapseMode != 2 && alarmTime > 0)) {\r\n                    alertMessage = \"Unless the selected lapse mode is On Expiration the alarm time cannot be empty\";\r\n                }\r\n            } else\r\n            if (field.id == \"TextBoxRecurTime\") {\r\n\r\n                var idRecurrMode = $($('input:radio[name=RadioButtonListRecurMode][checked=checked]')[0]).val(),\r\n                    alarmRecurrTime = fieldValue;\r\n\r\n                if (!(idLapseMode == 1 && alarmTime > 0)) {\r\n                    alertMessage = \"Please review the Alarm Editor fields, the folowing are empty or unselected\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    validateAlarmEditor: function () {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var result = \"\",\r\n            isValid = false,\r\n            alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", content);\r\n\r\n        //1\r\n        var idLapseMode = $('input:radio[name=RadioButtonListLapseMode]:checked').val(),\r\n            alarmTime = $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val();\r\n\r\n        //2\r\n        var idRecurrMode = $('input:radio[name=RadioButtonListRecurMode]:checked').val(),\r\n            alarmRecurrTime = $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val();\r\n\r\n\r\n        if (idLapseMode) {\r\n            if (!((idLapseMode != 2 && alarmTime > 0) || (idLapseMode == 2 && (alarmTime == \"\" || alarmTime == 0)))) {\r\n\r\n                result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-error-message-on-expiration\") + '</li>';\r\n            }\r\n        } else {\r\n\r\n            result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-field-title-lapse\") + '</li>';\r\n\r\n            if (alarmTime == \"\")\r\n                result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-group-title-timing\") + \" - \" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-field-title-lapse\") + '</li>';\r\n        }\r\n\r\n        if (idRecurrMode) {\r\n            if (!((idRecurrMode != 1 && (alarmRecurrTime == \"\" || alarmRecurrTime == 0)) || (idRecurrMode == 1 && alarmRecurrTime > 0))) {\r\n\r\n                result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-error-message-each-recurr\") + '</li>';\r\n            }\r\n        } else {\r\n            result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-group-title-alarm-recur\") + '</li>';\r\n\r\n            if (alarmRecurrTime == \"\")\r\n                result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-group-title-timing\") + \" - \" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-field-title-alarm-recur-time\") + '</li>';\r\n        }\r\n\r\n        if (result != \"\")\r\n            result = bizagi.localization.getResource(\"workportal-widget-admin-alarms-error-message-review\") + '</br></br> <ul>' + result + \"</ul>\";\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    fillTaskListColumnByID: function (listName, data) {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var listObj = self.listID[listName],\r\n            generalWrapper = $(\"#form-alarm-task-list\", content),\r\n            listElement = $(\"#\" + listObj.name, generalWrapper);\r\n\r\n\r\n        //listElement.empty();\r\n\r\n        switch (listName) {\r\n        case \"APPLICATION\":\r\n            $.tmpl(self.taskListItemTmpl, {\r\n                taskField: listName,\r\n                elementList: data.items\r\n            }).appendTo(listElement);\r\n            break;\r\n\r\n        case \"WORKFLOW\":\r\n            $.tmpl(self.taskListItemTmpl, {\r\n                taskField: listName,\r\n                elementList: data.processes\r\n            }).appendTo(listElement);\r\n            break;\r\n\r\n        case \"VERSION\":\r\n            $.tmpl(self.taskListItemTmpl, {\r\n                taskField: listName,\r\n                elementList: data.versions\r\n            }).appendTo(listElement);\r\n            break;\r\n\r\n        case \"TASKS\":\r\n            $.tmpl(self.taskListItemTmpl, {\r\n                taskField: listName,\r\n                elementList: data.tasks\r\n            }).appendTo(listElement);\r\n            break;\r\n        }\r\n\r\n        listElement.unbind(\"change\");\r\n\r\n        //Add selects handlers\r\n        listElement.bind(\"change\", function (e) {\r\n            self.updateListsContent(e.currentTarget);\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    updateListsContent: function (currentTarget) {\r\n        var self = this;\r\n\r\n        //Captures the data\r\n        var listCategory = self.getListCategoryByID(currentTarget.id)\r\n        self.captureSelectedData(listCategory, currentTarget);\r\n\r\n        var elementToUpdate = self.getElementToUpdate(currentTarget.id);\r\n\r\n        //checks if there is any list element to update\r\n        if (elementToUpdate != \"\") {\r\n            var params = {};\r\n\r\n            //Clear lists\r\n            self.processLists(currentTarget.id);\r\n\r\n            params = self.setupParametersbyListID(elementToUpdate);\r\n\r\n\r\n            $.when(self.dataService[self.listID[elementToUpdate].serviceMethod](params)).done(function (data) {\r\n\r\n                self.fillTaskListColumnByID(elementToUpdate, data);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    captureSelectedData: function (listCategory, currentTarget) {\r\n\r\n        var self = this;\r\n\r\n        switch (listCategory) {\r\n        case \"APPLICATION\":\r\n            self.alertData[\"idApp\"] = $(currentTarget.options[currentTarget.selectedIndex]).val();\r\n            self.alertData[\"idAppText\"] = currentTarget.options[currentTarget.selectedIndex].text;\r\n            break;\r\n\r\n        case \"WORKFLOW\":\r\n            self.alertData[\"idWFClass\"] = $(currentTarget.options[currentTarget.selectedIndex]).val();\r\n            self.alertData[\"idWFClassText\"] = currentTarget.options[currentTarget.selectedIndex].text;\r\n            break;\r\n\r\n        case \"VERSION\":\r\n            self.alertData[\"version\"] = $(currentTarget.options[currentTarget.selectedIndex]).val();\r\n            self.alertData[\"versionText\"] = currentTarget.options[currentTarget.selectedIndex].text;\r\n            break;\r\n\r\n        case \"TASKS\":\r\n            self.alertData[\"idTask\"] = $(currentTarget.options[currentTarget.selectedIndex]).val();\r\n            self.alertData[\"idTaskText\"] = currentTarget.options[currentTarget.selectedIndex].text;\r\n            break;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    setupParametersbyListID: function (id) {\r\n\r\n        var self = this,\r\n            params = {};\r\n\r\n        switch (id) {\r\n        case \"APPLICATION\":\r\n            params = {\r\n                action: \"getApplications\"\r\n            };\r\n            break;\r\n\r\n        case \"WORKFLOW\":\r\n            params[\"idApp\"] = self.alertData[\"idApp\"];\r\n            break;\r\n        case \"VERSION\":\r\n            params[\"idWFClass\"] = self.alertData[\"idWFClass\"];\r\n            break;\r\n        case \"TASKS\":\r\n            params[\"idWFClass\"] = self.alertData[\"idWFClass\"];\r\n            params[\"version\"] = self.alertData[\"version\"];\r\n            break;\r\n        }\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    resetParametersbyListID: function (listCategory) {\r\n\r\n        var self = this;\r\n\r\n        switch (listCategory) {\r\n        case \"APPLICATION\":\r\n            self.alertData[\"idApp\"] = \"\";\r\n            break;\r\n\r\n        case \"WORKFLOW\":\r\n            self.alertData[\"idWFClass\"] = \"\";\r\n            break;\r\n\r\n        case \"VERSION\":\r\n            self.alertData[\"version\"] = \"\";\r\n            break;\r\n\r\n        case \"TASKS\":\r\n            self.alertData[\"idTask\"] = \"\";\r\n            break;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    processLists: function (id) {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var taskListWrapper = $(\"#form-alarm-task-list\", content),\r\n            currentListID = self.getElementToUpdate(id);\r\n\r\n        if (currentListID != \"\") {\r\n\r\n            //Empty list content\r\n            $(\"#\" + self.listID[currentListID].name, taskListWrapper).empty();\r\n\r\n            //Empty current data\r\n            self.resetParametersbyListID(currentListID);\r\n\r\n            while (currentListID != \"\") {\r\n                currentListID = self.getElementToUpdate(self.listID[currentListID].name);\r\n\r\n                if (currentListID != \"\") {\r\n                    //Clean list\r\n                    $(\"#\" + self.listID[currentListID].name, taskListWrapper).empty();\r\n\r\n                    $(\"#\" + self.listID[currentListID].name, taskListWrapper).empty();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    getElementToUpdate: function (val) {\r\n        var self = this,\r\n            result = self.getListCategoryByID(val);\r\n\r\n        return self.listID[result].update;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    getListCategoryByID: function (id) {\r\n        var self = this;\r\n\r\n        for (var x in self.listID) {\r\n            if (id == self.listID[x].name)\r\n                return x;\r\n        }\r\n\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    callEnableDisableAlarmsService: function () {\r\n        var self = this;\r\n\r\n        var params = {\r\n            idTask: self.alertData[\"idTask\"]\r\n        };\r\n\r\n        $.when(self.dataService.enableAlarm(params)).done(function (data) {\r\n\r\n            if (data.response === true) {\r\n                self.switchEnableAlarms();\r\n                self.refreshTaskListTable();\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    switchEnableAlarms: function (value) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content);\r\n        if (value) {\r\n            $(\"#btn-enable-alarms\", detailWrapper).hide();\r\n            $(\"#btn-disable-alarms\", detailWrapper).show();\r\n        } else {\r\n            $(\"#btn-enable-alarms\", detailWrapper).show();\r\n            $(\"#btn-disable-alarms\", detailWrapper).hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    switchContent: function (contentToDisplay) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#form-alarm-task-list\", content),\r\n            detailWrapper = $(\"#form-alarm-task-detail\", content);\r\n\r\n\r\n        if (self.containtersID.DETAIL == contentToDisplay) {\r\n            generalWrapper.hide();\r\n            detailWrapper.show();\r\n        } else {\r\n            generalWrapper.show();\r\n            detailWrapper.hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    switchWidgetMode: function (widgetMode) {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#form-alarm-task-list\", content),\r\n            detailWrapper = $(\"#form-alarm-task-detail\", content);\r\n\r\n        switch (widgetMode) {\r\n        case self.widgetMode.VIEW_MODE:\r\n            $(\"#btn-save-changes\", detailWrapper).hide();\r\n            $(\"#btn-back\", detailWrapper).hide();\r\n            $(\"#btn-delete-recipient\", detailWrapper).show();\r\n            $(\"#alarm-recipients-table-content\", detailWrapper).show();\r\n            $(\"#btn-add-recipient\", detailWrapper).show();\r\n\r\n            $(\"#btn-add-alarm\", detailWrapper).show();\r\n\r\n            break;\r\n\r\n        case self.widgetMode.EDIT_MODE:\r\n            $(\"#btn-save-changes\", detailWrapper).show();\r\n            $(\"#btn-back\", detailWrapper).show();\r\n            $(\"#btn-delete-recipient\", detailWrapper).show();\r\n            $(\"#alarm-recipients-table-content\", detailWrapper).show();\r\n            $(\"#btn-add-recipient\", detailWrapper).show();\r\n\r\n\r\n            $(\"#btn-add-alarm\", detailWrapper).hide();\r\n\r\n            break;\r\n        }\r\n\r\n        self.currentWidgetMode = widgetMode;\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget User Licenses\r\n* \r\n* @author Liliana Fernandez\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.user.licenses.extend(\"bizagi.workportal.widgets.admin.user.licenses\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"user.licenses\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.licenses\").concat(\"#ui-bizagi-workportal-widget-admin-user-licenses\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        this.serviceLocator = dataService.serviceLocator;\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.generalContent = self.getTemplate(\"user.licenses\");\r\n        //        self.fieldsContent = self.workportalFacade.getTemplate(\"defaults.assignation.user.fields\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //load form data\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n        self.setupButton();\r\n\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.when(self.dataService.licenses()\r\n        ).done(function (result) {\r\n            if (result.licenseType == \"none\") {\r\n                $(\"#licenseAlert\").show();\r\n                $(\"#licenseContent\").hide();\r\n            } else {\r\n                $(\"#licenseContent\").show();\r\n                $(\"#licenseAlert\").hide();\r\n                if (result.expirationDate == \"\") {\r\n                    var expirationDate = \"12/31/9999\";\r\n                } else {\r\n                    var expirationDate = result.expirationDate.substring(0, 11);\r\n                }\r\n\r\n                if (result.licenseType == \"Volume\") {\r\n                    $(\"#users\").text(result.activeUsers + \" \" + bizagi.localization.getResource(\"workportal-widget-admin-user-licenses-titles-usersLicenses-text\"));\r\n                } else {\r\n                    $(\"#users\").text(result.activeUsers + \"/\" + result.licensedUsersAccount + \"  \" + bizagi.localization.getResource(\"workportal-widget-admin-user-licenses-titles-usersLicenses-text\"));\r\n                }\r\n                $(\"#licenses\").text(result.customerName);\r\n                \r\n                $(\"#date\").text(expirationDate);\r\n                $(\"#licenseType\").text(result.licenseType);\r\n                $(\"#licenseCluster\").text(result.clustered);\r\n                //$(\"#activeProcess\").text(result.activeProcess);\r\n            }\r\n\r\n            $(\"#cases-tabs\").tabs();\r\n               \r\n        });\r\n    },\r\n\r\n    setupButton: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-buyNowLicenses\", content).click(function (e) {\r\n\r\n            window.open('http://www.bizagi.com/', 'name', 'height=600,width=1000,resizable=yes');\r\n        });\r\n        $(\"#btn-auditLicenses\", content).click(function (e) {\r\n\r\n\r\n            $.when(self.dataService.getAuditLicense()).done(function (result) {\r\n\r\n            }).fail(function (result) {\r\n\r\n            });\r\n\r\n        });\r\n\r\n       self.downloadBPUs();\r\n    },\r\n    downloadBPUs: function(){\r\n        var self = this,\r\n            content = self.getContent();\r\n        /* Download BPUs report*/\r\n        $(\"#btn-download-bpus\", content).click(function (e){\r\n            var url = self.serviceLocator.getUrl(\"downloadBPUsReport\")\r\n            var queryParams = 'xsrf=' + bizagi.getXSRFToken();\r\n            url = url.indexOf('?') !== -1 ? url.concat('&' + queryParams) : url.concat('?' + queryParams);\r\n            bizagi.util.downloadFile(url, true);\r\n        });\r\n    }\r\n});\r\n","/**\r\n * Document templates widget, for uploading and updating created templates via Bizagi Studio\r\n * \r\n * @author David Nino\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.document.templates.extend(\"bizagi.workportal.widgets.admin.document.templates\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.document.templates\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.document.templates\").concat(\"#ui-bizagi-workportal-widget-admin-document-templates\"),\r\n            \"admin.document.templates.upload.template\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.document.templates\").concat(\"#ui-bizagi-workportal-widget-admin-document-templates-upload-template\"),\r\n            \"admin.document.templates.uploaded.templates.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.document.templates\").concat(\"#ui-bizagi-workportal-widget-admin-document-templates-uploaded-template-list\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Template vars \r\n        self.uploadTemplateTmpl = self.getTemplate(\"admin.document.templates.upload.template\");\r\n        self.uploadedTemplatesTmpl = self.getTemplate(\"admin.document.templates.uploaded.templates.list\");\r\n        \r\n        self.lockedInteractions = false;\r\n\r\n        self.config =   { \r\n                            \"maxSize\": \"31457280\",\r\n                            \"validExtensions\": \".bdt\",\r\n                            \"xpath\": \"documentTemplates\",\r\n                            \"uploadDialogTemplateName\": \"upload.template.dialog\"\r\n                        };\r\n\r\n\r\n        self.renderUploadForm();\r\n\r\n        self.initUploadedTemplates();\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    initUploadedTemplates: function() {\r\n        \r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var uploadedTemplateListWrapper = $(\"#uploaded-template-list-wrapper\", content);\r\n        uploadedTemplateListWrapper.empty();\r\n\r\n        $.when(self.dataService.storeDocumentTemplates()).done(function (data) {\r\n            self.renderUploadedTemplates(data);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    renderUploadForm: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var templateUploadFormWrapper = $(\"#template-upload-form-wrapper\", content);\r\n\r\n         // Render Form\r\n        $.tmpl(self.uploadTemplateTmpl).appendTo(templateUploadFormWrapper);\r\n\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var facade = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n            self.dialogTemplate = facade.deviceFactory.cachedFactory.getTemplate(self.config[\"uploadDialogTemplateName\"]);\r\n\r\n            if(!self.dialogTemplate) {\r\n                $.when( facade.deviceFactory.getRenderFactory()).done(function() {\r\n\r\n                    self.dialogTemplate = facade.deviceFactory.cachedFactory.getTemplate(self.config[\"uploadDialogTemplateName\"]);\r\n\r\n                    self.addFormInteractions();\r\n                });\r\n            }\r\n            else\r\n                self.addFormInteractions();\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    renderUploadedTemplates:function(data) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var uploadedTemplateListWrapper = $(\"#uploaded-template-list-wrapper\", content);\r\n\r\n        uploadedTemplateListWrapper.empty();\r\n\r\n         // Render Form\r\n        $.tmpl(self.uploadedTemplatesTmpl, {documentTemplates : data.documentTemplate}).appendTo(uploadedTemplateListWrapper);\r\n\r\n        $(\".template-to-recover\",uploadedTemplateListWrapper).click(function(e){\r\n            e.preventDefault();\r\n\r\n            if(!self.lockedInteractions){\r\n\r\n                self.lockedInteractions = true;\r\n\r\n                var params = {\"Guid\": $(e.currentTarget).data(\"guid\")};\r\n\r\n                $.when(self.dataService.restoreDocumentTemplates( params )).done(function(result){\r\n\r\n                    self.lockedInteractions = false;\r\n\r\n                    if(result.DocumentTemplateRestored){\r\n                        self.initUploadedTemplates();\r\n\r\n                        self.displayMessage(result);\r\n                    }\r\n                        \r\n                })\r\n            }            \r\n        })\r\n    },\r\n\r\n    addFormInteractions: function() {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var properties = {};\r\n\r\n        properties.addUrl = self.dataService.serviceLocator.getUrl(\"admin-document-templates-uploadDocumentTemplate\");\r\n        properties.xpath = self.config[\"xpath\"];\r\n        properties.idRender = \"\";\r\n        properties.xpathContext = \"\";\r\n        properties.idPageCache = \"\";\r\n        properties.sessionId = \"\";\r\n        properties.validExtensions = self.config[\"validExtensions\"];\r\n        properties.maxSize = self.config[\"maxSize\"];\r\n        properties.contexttype = \"\";\r\n        properties.maxfiles = \"1\";\r\n        properties.filesCount = \"\";\r\n\r\n        var templateUploadFormWrapper = $(\"#template-upload-form-wrapper\", content);\r\n\r\n        $(\".ui-bizagi-render-upload-wrapper\", templateUploadFormWrapper).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.dialogTemplate,\r\n            properties: {\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.idRender,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                idSession: properties.sessionId,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize,\r\n                contexttype: properties.contexttype\r\n            },\r\n            onUploadFileCompletedCallback: function(ref,data){ \r\n                                                                self.displayMessage(JSON.parse(data)); \r\n                                                                self.initUploadedTemplates();\r\n                                                            },\r\n            maxAllowedFiles: properties.maxfiles,\r\n            uploadedFiles: properties.filesCount,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n    },\r\n\r\n    displayMessage:function(messageData) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var messageContainer = $(\"#message-container\", content);\r\n\r\n        messageContainer.show();\r\n\r\n        if(messageData.DocumentTemplateRestored == true){\r\n\r\n            $(\"#template-uploaded\", messageContainer).hide();\r\n            $(\"#template-recovered\", messageContainer).show();\r\n            $(\"#template-no-results\", messageContainer).hide();\r\n        }\r\n        else\r\n        {\r\n            if(messageData.DocumentTemplateUploaded == true){\r\n                $(\"#template-uploaded\", messageContainer).show();\r\n                $(\"#template-recovered\", messageContainer).hide();\r\n                $(\"#template-no-results\", messageContainer).hide();\r\n\r\n            }\r\n            else{\r\n                $(\"#template-uploaded\", messageContainer).hide();\r\n                $(\"#template-recovered\", messageContainer).hide();\r\n                $(\"#template-no-results\", messageContainer).show();\r\n            }\r\n        }\r\n    }\r\n});","/**\r\n * Name: BizAgi Desktop Widget Administration Processes\r\n * \r\n * @author Christian Collazos *\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.processes.extend(\"bizagi.workportal.widgets.admin.processes\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.processes.wrapper\": bizagi.getTemplate('bizagi.workportal.desktop.widgets.admin.processes').concat('#ui-bizagi-workportal-widget-admin-processes-wrapper'),\r\n            \"admin.processes.combo.process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.processes\").concat(\"#ui-bizagi-workportal-widget-admin-processes-combo-process\"),\r\n            \"admin.processes.proc.edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.processes\").concat( \"#ui-bizagi-workportal-widget-admin-processes-process-edit\"),\r\n            \"admin.processes.task.edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.processes\").concat( \"#ui-bizagi-workportal-widget-admin-processes-task-edit\"),\r\n            useNewEngine:false\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Post Render\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.formType = {\r\n            TASK_FORM: \"task\",\r\n            PROCESS_FORM: \"process\"\r\n        };\r\n        self.containersMode = {\r\n            VIEW_MODE: \"viewMode\",\r\n            EDIT_MODE: \"editMode\"\r\n        };\r\n        //Events handlers\r\n        $.when(self.dataService.getWorkFlowClasses()).done(function (result) {\r\n            self.processesData=result;\r\n            self.renderSections();\r\n        });\r\n\r\n    },\r\n\r\n    renderSections: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processHeaderWrapper = $(\"#processes-header-wrapper\", self.content);\r\n        $.tmpl(self.comboProcess).appendTo(processHeaderWrapper);\r\n        var processesMapWrapper = $(\"#admin-processes-map-wrapper\", self.content);\r\n        var processesComboWrapper = $(\"#ui-process-name\",self.content);\r\n        self.renderProcessesCombo(processesComboWrapper);\r\n        self.renderProcessesEditWrapper();\r\n        self.loadProcessData(\"1\");\r\n        self.renderTaskEditWrapper();\r\n        self.displayTaskEdit(false);\r\n        self.renderProcessViewer(processesMapWrapper);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    loadProcessData: function (processID) {\r\n        var self = this;\r\n        var length = self.processesData.processes.length;\r\n        self.currentSelectedProcessData = {};\r\n        //Gets the selected process data\r\n        while (length-- > 0) {\r\n            if (processID == self.processesData.processes[length].id) {\r\n                self.currentSelectedProcessData = self.processesData.processes[length];\r\n                break;\r\n            }\r\n        }\r\n       // self.bindProcessHeader();\r\n        self.bindProcessDetail();\r\n      var params = { \"idWorkflow\": processID };\r\n        $.when(self.dataService.getTaskByWorkFlow(params)).done(function (result) {\r\n            self.processTaskData = result;\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Render process viewer\r\n     */\r\n    renderProcessViewer: function (processesMapWrapper) {\r\n        var self = this;\r\n        var filter = \"processId=\" +  self.currentSelectedProcessData.id;\r\n        if (self.viewerPlugin) {\r\n            self.viewerPlugin.processviewer('destroy');\r\n        }\r\n        var a= self.dataService;\r\n        $.when(self.dataService.processDefinition(filter), self.dataService.graphicInfo(filter)).done(function (dfn, info) {\r\n            self.processTaskDefinition=dfn[0].flowElements;\r\n            //Initilize plugin process viewer\r\n            self.viewerPlugin = processesMapWrapper.processviewer({\r\n                height: 400,\r\n                width: '100%',\r\n                jsonBizagi: {\r\n                    processDefinition: dfn[0],\r\n                    processGraphicsInfo: info[0]\r\n                },\r\n                zoomRange: 5\r\n            });\r\n            setTimeout(function () {\r\n                $(\".processviewer-hotspot\").click(function (e) {\r\n                    e.preventDefault();\r\n                    self.preprocessBindTaskDetail(this.id);\r\n                });\r\n            }, 150);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Render combo\r\n     */\r\n    renderProcessesCombo: function (processesComboWrapper) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var deferred = $.Deferred();\r\n        var comboDataSource ={combo:[], id: \"processName\"};\r\n        $.each(self.processesData.processes, function( index, value ) {\r\n            comboDataSource.combo.push({ id: value.id, name: value.name});\r\n        });\r\n        processesComboWrapper.empty();\r\n        processesComboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.name;\r\n            },\r\n            onComplete: function () {\r\n                deferred.resolve();\r\n            },\r\n            onChange: function (obj) {\r\n                self.loadProcessData(obj.ui.data('value'));\r\n                self.loadSelectedTask(obj.ui.data('value'), -1);\r\n            },\r\n            initValue: comboDataSource.combo[0]\r\n        });\r\n        return deferred;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderProcessesEditWrapper: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processEditWrapper = $(\"#process-edit-wrapper\", content);\r\n        $.tmpl(self.processEditTmpl).appendTo(processEditWrapper);\r\n        self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n\r\n        //Events\r\n        $(\"#btn-process-edit\", processEditWrapper).click(function () {\r\n            self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.EDIT_MODE);\r\n        });\r\n        $(\"#btn-process-apply\", processEditWrapper).click(function () {\r\n            self.saveProcess();\r\n            self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n        });\r\n        $(\"#btn-process-cancel\", processEditWrapper).click(function () {\r\n            self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n        });\r\n        $(\"#txt-process-duration-edit-days\", processEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 1000, 0));\r\n        });\r\n        $(\"#txt-process-duration-edit-hours\", processEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 23, 0));\r\n        });\r\n        $(\"#txt-process-duration-edit-minutes\", processEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 59, 0));\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderTaskEditWrapper: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        $.tmpl(self.taskEditTmpl).appendTo(taskEditWrapper);\r\n        self.switchFormState(self.formType.TASK_FORM, self.containersMode.VIEW_MODE);\r\n        $(\"#btn-task-edit\", taskEditWrapper).click(function () {\r\n            self.switchFormState(self.formType.TASK_FORM, self.containersMode.EDIT_MODE);\r\n        });\r\n        $(\"#btn-task-apply\", taskEditWrapper).click(function () {\r\n            self.saveTask();\r\n            self.switchFormState(self.formType.TASK_FORM, self.containersMode.VIEW_MODE);\r\n        });\r\n        $(\"#btn-task-cancel\", taskEditWrapper).click(function () {\r\n            self.switchFormState(self.formType.TASK_FORM, self.containersMode.VIEW_MODE);\r\n        });\r\n        $(\"#txt-task-duration-edit-days\", taskEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 1000, 0));\r\n        });\r\n        $(\"#txt-task-duration-edit-hours\", taskEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 23, 0));\r\n        });\r\n        $(\"#txt-task-duration-edit-minutes\", taskEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 59, 0));\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    bindProcessDetail: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processEditWrapper = $(\"#process-edit-wrapper\", content);\r\n        self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n        //Parse the time\r\n        self.parseObjectTime(self.currentSelectedProcessData);\r\n        //Bind data\r\n        $(\"#process-name\", processEditWrapper).text(self.currentSelectedProcessData.name);\r\n        $(\"#process-description\", processEditWrapper).text(self.currentSelectedProcessData.description);\r\n        $(\"#process-duration\", processEditWrapper).text(self.currentSelectedProcessData.durationText);\r\n\r\n        $(\"#txt-process-duration-edit-days\", processEditWrapper).val(self.currentSelectedProcessData.durationDays);\r\n        $(\"#txt-process-duration-edit-hours\", processEditWrapper).val(self.currentSelectedProcessData.durationHours);\r\n        $(\"#txt-process-duration-edit-minutes\", processEditWrapper).val(self.currentSelectedProcessData.durationMinutes);\r\n\r\n        //Reset the selected task\r\n        self.currentSelectedTaskData = undefined;\r\n        self.displayTaskEdit(false);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    preprocessBindTaskDetail: function (taskId) {\r\n        var self = this;\r\n        var taskData = self.getTaskByID(taskId);\r\n        if (taskData) {\r\n            self.bindTaskDetail(taskData);\r\n        }\r\n        else\r\n            self.displayTaskEdit(false);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    bindTaskDetail: function (param) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        var taskData =param;\r\n        if (self.shouldShowTaskProperties(taskData)) {\r\n            self.displayTaskEdit(true);\r\n            self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n            self.switchFormState(self.formType.TASK_FORM, self.containersMode.VIEW_MODE);\r\n            self.parseObjectTime(taskData);\r\n            //Keeps the selected task\r\n            self.currentSelectedTaskData = taskData;\r\n            //Bind data\r\n            $(\"#task-name\", taskEditWrapper).text(self.currentSelectedTaskData.name);\r\n            $(\"#task-description\", taskEditWrapper).text(self.currentSelectedTaskData.description);\r\n            $(\"#task-duration\", taskEditWrapper).text(self.currentSelectedTaskData.durationText);\r\n\r\n            $(\"#txt-task-duration-edit-days\", taskEditWrapper).val(self.currentSelectedTaskData.durationDays);\r\n            $(\"#txt-task-duration-edit-hours\", taskEditWrapper).val(self.currentSelectedTaskData.durationHours);\r\n            $(\"#txt-task-duration-edit-minutes\", taskEditWrapper).val(self.currentSelectedTaskData.durationMinutes);\r\n        }\r\n        else {\r\n            self.currentSelectedTaskData = undefined;\r\n            self.displayTaskEdit(false);\r\n        }\r\n    },\r\n\r\n    getTaskByID: function (taskID) {\r\n        var self = this;\r\n        var i = self.processTaskData.Tasks.length;\r\n        while (i-- > 0) {\r\n            if (taskID == self.processTaskData.Tasks[i].guid) {\r\n                return self.processTaskData.Tasks[i];\r\n            }\r\n        }\r\n    },\r\n\r\n    shouldShowTaskProperties: function (oTask) {\r\n        return oTask.idTaskType && (\r\n            oTask.idTaskType == 2 //ManualState\r\n                || oTask.idTaskType == 7 //SubProcess\r\n                || oTask.idTaskType == 14 //SubProcessMultiInstance\r\n                || oTask.idTaskType == 21 //Singleton\r\n                || oTask.idTaskType == 38 //ReceiveTask\r\n                || oTask.idTaskType == 39 //ManualTask\r\n                || oTask.idTaskType == 41 //DataObject\r\n            );\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    displayTaskEdit: function (value) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        if (value)\r\n            taskEditWrapper.show();\r\n        else\r\n            taskEditWrapper.hide();\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    switchFormState: function (formType, widgetMode) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        switch (widgetMode) {\r\n            case self.containersMode.VIEW_MODE:\r\n                if (formType == self.formType.PROCESS_FORM) {\r\n                    $(\"#process-view-fields-wrapper\", content).show();\r\n                    $(\"#process-edit-fields-wrapper\", content).hide();\r\n                }\r\n                else\r\n                if (formType == self.formType.TASK_FORM) {\r\n                    $(\"#task-view-fields-wrapper\", content).show();\r\n                    $(\"#task-edit-fields-wrapper\", content).hide();\r\n                }\r\n                break;\r\n\r\n            case self.containersMode.EDIT_MODE:\r\n\r\n                if (formType == \"process\") {\r\n                    $(\"#process-view-fields-wrapper\", content).hide();\r\n                    $(\"#process-edit-fields-wrapper\", content).show();\r\n                }\r\n                else\r\n                if (formType == self.formType.TASK_FORM) {\r\n                    $(\"#task-view-fields-wrapper\", content).hide();\r\n                    $(\"#task-edit-fields-wrapper\", content).show();\r\n                }\r\n                break;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    loadSelectedTask: function (idWorkflow, idTask) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processesMapWrapper = $(\"#admin-processes-map-wrapper\", self.content);\r\n        self.renderProcessViewer(processesMapWrapper);\r\n    },\r\n\r\n    /*\r\n     * Fix input value if outside the specified range\r\n     */\r\n    correctIntegerInInput: function (value, minValue, maxValue, defaultValue) {\r\n        var self = this;\r\n        var iNewValue = self.tryParseInt(value, defaultValue);\r\n        if (iNewValue < minValue)\r\n            return (minValue);\r\n        else if (iNewValue > maxValue)\r\n            return (maxValue);\r\n        else\r\n            return (iNewValue);\r\n    },\r\n\r\n    /*\r\n     * TryParseInt javascript version\r\n     */\r\n    tryParseInt: function (str, defaultValue) {\r\n        var retValue = defaultValue;\r\n        if (str != null) {\r\n            if (jQuery.trim(new String(str)).length > 0) {\r\n                if (!isNaN(str)) {\r\n                    retValue = parseInt(str);\r\n                }\r\n            }\r\n        }\r\n        return retValue;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    saveProcess: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processEditWrapper = $(\"#process-edit-wrapper\", content);\r\n        var iNewDuration = self.getMinutesFromTimeUnits(\r\n            $(\"#txt-process-duration-edit-days\", processEditWrapper).val(),\r\n            $(\"#txt-process-duration-edit-hours\", processEditWrapper).val(),\r\n            $(\"#txt-process-duration-edit-minutes\", processEditWrapper).val()\r\n        );\r\n\r\n        var params = {};\r\n        params[\"idWorkflow\"] = self.currentSelectedProcessData.id;\r\n        params[\"duration\"] = iNewDuration;\r\n        if (iNewDuration != NaN) {\r\n            $.when(self.dataService.modifyProcessDuration(params)).done(function (result) {\r\n                if (result.workflow) {\r\n                    self.currentSelectedProcessData.duration = result.workflow.duration;\r\n                    self.bindProcessDetail();\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    saveTask: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        var iNewDuration = self.getMinutesFromTimeUnits(\r\n            $(\"#txt-task-duration-edit-days\", taskEditWrapper).val(),\r\n            $(\"#txt-task-duration-edit-hours\", taskEditWrapper).val(),\r\n            $(\"#txt-task-duration-edit-minutes\", taskEditWrapper).val()\r\n        );\r\n\r\n        var params = {};\r\n\r\n        params[\"idTask\"] = self.currentSelectedTaskData.id;\r\n        params[\"duration\"] = iNewDuration;\r\n        if (iNewDuration != NaN) {\r\n            $.when(self.dataService.modifyTaskDuration(params)).done(function (result) {\r\n                if (result.task) {\r\n                    self.currentSelectedTaskData.duration = result.task.duration;\r\n                    self.bindTaskDetail(self.currentSelectedTaskData);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     * Calculate number of minutes based on an array containing days, hous and minutes\r\n     */\r\n    getMinutesFromTimeUnits: function (days, hours, minutes) {\r\n        var hoursDay = 8;\r\n        var minutesDay = hoursDay * 60;\r\n        var rMinutes = parseInt(days) * minutesDay\r\n            + parseInt(hours) * 60\r\n            + parseInt(minutes);\r\n        return rMinutes;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    parseObjectTime: function (objectReference) {\r\n        var self = this;\r\n        var arrDuration = self.getTimeArrayFromMinutes(objectReference.duration);\r\n        objectReference.durationText = self.getDurationStringFromMinutes(objectReference.duration);\r\n        objectReference.durationDays = arrDuration[0];\r\n        objectReference.durationHours = arrDuration[1];\r\n        objectReference.durationMinutes = arrDuration[2];\r\n    },\r\n    /*\r\n     *   Divide a given number of minutes in three values: days, hours and minutes\r\n     */\r\n    getTimeArrayFromMinutes: function (minutes) {\r\n        var self = this;\r\n        minutes = self.tryParseInt(minutes, 0);\r\n        var hoursDay = 8;\r\n        var minutesDay = hoursDay * 60;\r\n        var rDays = (minutes / minutesDay) | 0;\r\n        var rHours = ((minutes % minutesDay) / 60) | 0;\r\n        var rMins = (minutes % 60);\r\n        var arr = [rDays, rHours, rMins];\r\n        return arr;\r\n    },\r\n    /*\r\n     * Gets a duration string (h/m/s) from a given number of minutes\r\n     */\r\n    getDurationStringFromMinutes: function (minutes) {\r\n        var self = this;\r\n        var arrDuration = self.getTimeArrayFromMinutes(minutes);\r\n        var sDuration = arrDuration[0] + bizagi.localization.getResource(\"workportal-widget-processes-field-abreviation-day\") + \" \";\r\n        sDuration += arrDuration[1] + bizagi.localization.getResource(\"workportal-widget-processes-field-abreviation-hour\") + \":\";\r\n        sDuration += arrDuration[2] + bizagi.localization.getResource(\"workportal-widget-processes-field-abreviation-minute\");\r\n        return sDuration;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    displayTaskEdit: function (value) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        if (value)\r\n            taskEditWrapper.show();\r\n        else\r\n            taskEditWrapper.hide();\r\n    }\r\n\r\n\r\n});","/**\r\n * Name: BizAgi Desktop Widget Administration Processes (orchestrator)\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.extend(\"bizagi.workportal.widgets.admin.business.policies\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat( \"#ui-bizagi-workportal-widget-admin-business-policies-wrapper\"),\r\n            \"admin.business.policies.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.setupData();\r\n    },\r\n\r\n    setupData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            generalContentTmpl = $.tmpl(self.generalContentTmpl, {});\r\n        \r\n        content.append(generalContentTmpl);\r\n    },\r\n\r\n    /*\r\n    * initialize the process tree widget\r\n    */\r\n    setupPoliciesTree: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        bizagi.treeRoutSelected = [];\r\n        $(\"#treeLinksId\").remove();\r\n\r\n        self.processTree = new bizagi.workportal.widgets.tree(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#processTree\", content)\r\n        }));\r\n\r\n        self.processTree.render();\r\n    }\r\n\r\n\r\n\r\n    /********************* EVENTS ******************/\r\n    \r\n    \r\n});","/**\r\n * Name: BizAgi Desktop Widget Administration Policies - Decision Table\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.decision.table.extend(\"bizagi.workportal.widgets.admin.business.policies.decision.table\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.decision.table.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-decision-table-wrapper\"),\r\n            \"admin.business.policies.decision.table.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-decision-table-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    \r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.decision.table.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.decision.table.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget Administration Policies - Rules\r\n* \r\n* @author Christian Collazos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.rules.extend(\"bizagi.workportal.widgets.admin.business.policies.rules\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.rules.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-rules-wrapper\"),\r\n            \"admin.business.policies.rules.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-rules-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.rules.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.rules.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget Administration Policies - Tabs \r\n* \r\n* @author Christian Collazos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.tabs.extend(\"bizagi.workportal.widgets.admin.business.policies.tabs\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.tabs.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-tabs-wrapper\"),\r\n            \"admin.business.policies.tabs.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-tabs-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.tabs.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.tabs.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","    /**\r\n* Name: BizAgi Desktop Widget Administration Policies - Politics\r\n* \r\n* @author Christian Collazos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.politics.extend(\"bizagi.workportal.widgets.admin.business.policies.politics\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.politics.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-politics-wrapper\"),\r\n            \"admin.business.policies.politics.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-politics-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.politics.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.politics.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/**\r\n * Name: BizAgi Desktop Widget Administration Language Implementation\r\n * \r\n * @authors Ivan Ricardo Taimal - Mauricio Sanchez S. - Andres Fernando Munoz\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.language.extend(\"bizagi.workportal.widgets.admin.language\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.language.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-wrapper\"),\r\n            \"admin.language.panel.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-panel-wrapper\"),\r\n            \"admin.language.template.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-template-list\"),\r\n            \"admin.language.upload.file.culturename\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-combo-culturename\"),\r\n            \"admin.language.bizagi.objects.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-bizagi-objects-list\"),\r\n            \"admin.language.entities.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-entities-list\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        //Template vars\r\n        self.config = {\r\n            \"maxSize\": \"10000000\",\r\n            \"validExtensions\": \".xlsx\",\r\n            \"uploadFormTemplateName\": \"bizagi.workportal.desktop.fileupload.form\",\r\n            \"cultureName\": \"en\"\r\n        };\r\n        self.generalUploadFile = self.workportalFacade.getTemplate(\"admin.language.upload.file\");\r\n        self.formTemplate1 = self.workportalFacade.getTemplate(self.config[\"uploadFormTemplateName\"]);\r\n        self.formTemplate2 = self.workportalFacade.getTemplate(self.config[\"uploadFormTemplateName\"]);\r\n        self.formTemplate3 = self.workportalFacade.getTemplate(self.config[\"uploadFormTemplateName\"]);\r\n        self.formTemplate4 = self.workportalFacade.getTemplate(self.config[\"uploadFormTemplateName\"]);\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        self.startTab = \"entities\";\r\n        self.loadtemplates();\r\n        self.setupData();\r\n        $.when(self.initLanguageTemplatesList(self.startTab)).done(function (data) {\r\n            self.renderUploadForm();\r\n            self.initBizagiObjectsList();\r\n            self.initEntities();\r\n            content.html(self.panelWrapper);\r\n            if (!session.isProduction) {\r\n                $('#tab_reset').parent().addClass('hidden');\r\n            }\r\n            $(\"#admin-language-wrapper\").tabs();\r\n            $(\"#entities_internal_tabs\").tabs({\r\n                create: function (event, ui) {\r\n                    ui.tab.parent().removeClass('hidden');\r\n                }\r\n            });\r\n            $(\"#entities-accordion\").accordion({ heightStyle: \"content\" });\r\n            self.activeTab = self.startTab;\r\n            self.handleTabEvents();\r\n            self.keyEntityValidation(self.panelWrapper);\r\n        });\r\n    },\r\n\r\n    setupData: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n    },\r\n\r\n    renderUploadForm: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var languageUploadFormWrapper = $(\"#languages-upload-form-wrapper\", self.panelWrapper);\r\n        var massiveResourcesUploadFormWrapper = $(\"#massive-resources-upload-form-wrapper\", self.panelWrapper);\r\n        languageUploadFormWrapper.empty();\r\n        massiveResourcesUploadFormWrapper.empty();\r\n        // Render Form\r\n\r\n        //self.addUploadMassiveResources();\r\n    },\r\n\r\n    initLanguageTemplatesList: function (source) {\r\n        var defer = $.Deferred();\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var listWrapperSelector = \"#\" + source + '-language-list-wrapper';\r\n        var languageListWrapper = $(listWrapperSelector, self.panelWrapper);\r\n        languageListWrapper.empty();\r\n        $.when(self.dataService.getStoreLanguageTemplates()).done(function (data) {\r\n            var title;\r\n            data.result.sort(function (a, b) {\r\n                if (a.value > b.value) {\r\n                    return 1;\r\n                }\r\n                if (a.value < b.value) {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            });\r\n            self.templateList = data;\r\n            title = (source === 'all') ? self.getResource(\"workportal-widget-admin-language-all-language-list\") : self.getResource(\"workportal-widget-admin-language-current-language-settings\");\r\n            $.tmpl(self.generalTemplateListTmpl, { languageTemplates: data.result, listTitle: title, source: source }).appendTo(languageListWrapper);\r\n            self.downloadTemplateEvent(source);\r\n            defer.resolve();\r\n            self.addUploadMassiveResources();\r\n            if (source === 'reset') {\r\n                self.initReset();\r\n            }\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    initBizagiObjectsList: function () {\r\n        var self = this,\r\n            bizagiObjectsListWrapper;\r\n        bizagiObjectsListWrapper = $(\"#bizagi-objects-list-wrapper\", self.panelWrapper);\r\n        $.when(this.dataService.getBizagiObjects()).done(function (data) {\r\n            data.result.sort(function (a, b) {\r\n                if (a.value > b.value) {\r\n                    return 1;\r\n                }\r\n                if (a.value < b.value) {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            });\r\n            self.bizagiObjects = data.result;\r\n            $.tmpl(self.bizagiObjectsList, { elementList: self.bizagiObjects }).appendTo(bizagiObjectsListWrapper);\r\n            self.bizagiObjectsEvents();\r\n        });\r\n    },\r\n\r\n    bizagiObjectsEvents: function () {\r\n        var self = this;\r\n\r\n        /**\r\n        * Disable text selection for objects list and objects selected\r\n        * */\r\n        $(\"table tr\", \".objects-container\").bind('selectstart', function (event) {\r\n            event.preventDefault();\r\n        });\r\n        /**\r\n        * Event click for each entity in table list and selected\r\n        * */\r\n        $(\".ui-bizagi-object\").click(function () {\r\n            var entity = this;\r\n            if ($(\"td\", entity).hasClass(\"bizagi-objects-object-selected\")) {\r\n                $(\"td\", entity).removeClass(\"bizagi-objects-object-selected\");\r\n            } else {\r\n                $(\"td\", entity).addClass(\"bizagi-objects-object-selected\");\r\n            }\r\n        });\r\n        /**\r\n        * Move all objects to right\r\n        * */\r\n\r\n        $('.objects-buttons').click(function (e) {\r\n            e.preventDefault();\r\n        });\r\n\r\n        $(\"#move-all-objects-right\").click(function () {\r\n            $(\"#table-objects-selected tbody\").append($(\"#table-bizagi-ojects-list td\").closest(\"tr\"));\r\n            $(\"#table-objects-selected tbody tr td\").removeClass(\"bizagi-objects-object-selected\");\r\n            $(\"#table-objects-selected tbody tr\").show();\r\n            self.readyToDownload('bizagi_objects');\r\n        });\r\n        /**\r\n        * Move selected objects to right\r\n        * */\r\n        $(\"#move-objects-right\").click(function () {\r\n            $(\"#table-objects-selected tbody\").append($(\"#table-bizagi-ojects-list .bizagi-objects-object-selected\").closest(\"tr\"));\r\n            $(\"#table-objects-selected tbody tr td\").removeClass(\"bizagi-objects-object-selected\");\r\n            self.readyToDownload('bizagi_objects');\r\n        });\r\n        /**\r\n        * Move selected object to left\r\n        * */\r\n        $(\"#move-objects-left\").click(function () {\r\n            $(\"#table-bizagi-ojects-list tbody\").append($(\"#table-objects-selected .bizagi-objects-object-selected\").closest(\"tr\"));\r\n            $(\"#table-bizagi-ojects-list tbody tr td\").removeClass(\"bizagi-objects-object-selected\");\r\n            self.readyToDownload('bizagi_objects');\r\n        });\r\n        /**\r\n        * Move all objects to left\r\n        * */\r\n        $(\"#move-all-objscts-left\").click(function () {\r\n            $(\"#table-bizagi-ojects-list tbody\").append($(\"#table-objects-selected td\").closest(\"tr\"));\r\n            $(\"#table-bizagi-ojects-list tbody tr td\").removeClass(\"bizagi-objects-object-selected\");\r\n            self.readyToDownload('bizagi_objects');\r\n        });\r\n    },\r\n\r\n    initEntities: function () {\r\n        var self = this,\r\n            entitiesListWrapper;\r\n        entitiesListWrapper = $(\"#entities-list-wrapper\", self.panelWrapper);\r\n        $.when(this.dataService.getEntitiesList()).done(function (data) {\r\n            data.entities.sort(function (a, b) {\r\n                if (a.name > b.name) {\r\n                    return 1;\r\n                }\r\n                if (a.name < b.name) {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            });\r\n            self.entitiesList = data.entities;\r\n            $.tmpl(self.entitiesListTmpl, { elementList: self.entitiesList }).appendTo(entitiesListWrapper);\r\n            self.entitiesEvents();\r\n        });\r\n    },\r\n\r\n    entitiesEvents: function () {\r\n        var self = this;\r\n        /**\r\n        * Disable text selection for entities list and entities selected\r\n        * */\r\n        $(\"table tr\", \".entities-container\").bind('selectstart', function (event) {\r\n            event.preventDefault();\r\n        });\r\n        /**\r\n        * Captures the input typing\r\n        * */\r\n        $(\"#ui-entities-filter\").keyup(function () {\r\n            var search = $(this).val();\r\n            $(\"#table-entities-list .ui-bizagi-entity\").show();\r\n            if (search)\r\n                $(\"#table-entities-list .ui-bizagi-entity\").not(\":FilterEntity(\" + search + \")\").hide();\r\n        });\r\n        /**\r\n        * Filters entities according to the typed text\r\n        * */\r\n        $.expr[\":\"].FilterEntity = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) return false;\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n        /**\r\n        * Event click for each entity in table list and selected\r\n        * */\r\n        $(\".ui-bizagi-entity\").click(function () {\r\n            var entity = this;\r\n            if ($(\"td\", entity).hasClass(\"bizagi-entities-entity-selected\")) {\r\n                $(\"td\", entity).removeClass(\"bizagi-entities-entity-selected\");\r\n            } else {\r\n                $(\"td\", entity).addClass(\"bizagi-entities-entity-selected\");\r\n            }\r\n        });\r\n        /**\r\n        * Move all entities to right\r\n        * */\r\n\r\n        $('.entities-buttons').click(function (e) {\r\n            e.preventDefault();\r\n        });\r\n\r\n        $(\"#move-all-right\").click(function () {\r\n            $(\"#table-entities-selected tbody\").append($(\"#table-entities-list td\").closest(\"tr\"));\r\n            $(\"#table-entities-selected tbody tr td\").removeClass(\"bizagi-entities-entity-selected\");\r\n            $(\"#table-entities-selected tbody tr\").show();\r\n            self.readyToDownload('entities');\r\n        });\r\n        /**\r\n        * Move selected entities to right\r\n        * */\r\n        $(\"#move-right\").click(function () {\r\n            $(\"#table-entities-selected tbody\").append($(\"#table-entities-list .bizagi-entities-entity-selected\").closest(\"tr\"));\r\n            $(\"#table-entities-selected tbody tr td\").removeClass(\"bizagi-entities-entity-selected\");\r\n            self.readyToDownload('entities');\r\n        });\r\n        /**\r\n        * Move selected entities to left\r\n        * */\r\n        $(\"#move-left\").click(function () {\r\n            $(\"#table-entities-list tbody\").append($(\"#table-entities-selected .bizagi-entities-entity-selected\").closest(\"tr\"));\r\n            $(\"#table-entities-list tbody tr td\").removeClass(\"bizagi-entities-entity-selected\");\r\n            self.readyToDownload('entities');\r\n        });\r\n        /**\r\n        * Move all entities to left\r\n        * */\r\n        $(\"#move-all-left\").click(function () {\r\n            $(\"#table-entities-list tbody\").append($(\"#table-entities-selected td\").closest(\"tr\"));\r\n            $(\"#table-entities-list tbody tr td\").removeClass(\"bizagi-entities-entity-selected\");\r\n            self.readyToDownload('entities');\r\n        });\r\n    },\r\n\r\n    getEntitiesSelected: function () {\r\n        var entitiesSelected = $(\"#table-entities-selected tbody tr\");\r\n        var idEntitiesSelected = [];\r\n        $.each(entitiesSelected, function (index, item) {\r\n            idEntitiesSelected.push($(item).data(\"id\"));\r\n        });\r\n        return idEntitiesSelected;\r\n    },\r\n\r\n    getObjectsSelected: function () {\r\n        var objectsSelected = $(\"#table-objects-selected tbody tr\");\r\n        var valueObjectsSelected = [];\r\n        $.each(objectsSelected, function (index, item) {\r\n            valueObjectsSelected.push($(item).data(\"value\"));\r\n        });\r\n        return valueObjectsSelected;\r\n    },\r\n\r\n    initAllLangs: function () {\r\n        var self = this;\r\n        self.allLangsEvents();\r\n    },\r\n\r\n    allLangsEvents: function () {\r\n        var self = this;\r\n\r\n        /**\r\n        * Captures the input typing\r\n        * */\r\n        $(\"input.ui-all-languages-filter\").keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".ui-bizagi-grid-table .ui-bizagi-language\").show();\r\n            if (search)\r\n                $(\".ui-bizagi-grid-table .ui-bizagi-language\").not(\":FilterLanguage(\" + search + \")\").hide();\r\n        });\r\n        /**\r\n        * Filters entities according to the typed text\r\n        * */\r\n        $.expr[\":\"].FilterLanguage = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) return false;\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n\r\n        self.modifiedLangs = {};\r\n        $('#all-language-list-wrapper .ui-bizagi-cell-readonly').find('input[type=checkbox]').on('change', function () {\r\n            var element = $(this),\r\n                elValue,\r\n                objIndex = -1;\r\n            elValue = element.attr('value');\r\n            $.each(self.modifiedLangs, function (index, item) {\r\n                var x;\r\n                for (x in item) {\r\n                    if (x === elValue) {\r\n                        delete self.modifiedLangs[elValue];\r\n                    }\r\n                }\r\n            });\r\n            self.modifiedLangs[elValue] = (element.is(':checked')) ? true : false;\r\n        });\r\n        $('#all-language-list-wrapper #save-lang-list-btn').on('click', function () {\r\n            self.saveLangsList();\r\n        });\r\n    },\r\n\r\n    saveLangsList: function () {\r\n        var self = this,\r\n            langsObj;\r\n        langsObj = {\r\n            'languages': this.modifiedLangs\r\n        };\r\n        $.when(this.dataService.setLanguages(JSON.stringify(langsObj))).done(function (data) {\r\n            var errMsgEl;\r\n            if (!data.result) {\r\n                errMsgEl = $('#all-language-list-wrapper .multilang-error-msg');\r\n                errMsgEl.removeClass('dp-hidden');\r\n                setTimeout(function () {\r\n                    errMsgEl.addClass('dp-hidden');\r\n                }, 5000);\r\n                $.each(self.modifiedLangs, function (name, value) {\r\n                    var element = $('#all-language-list-wrapper .ui-bizagi-cell-readonly').find('input[value=' + name + ']');\r\n                    if (value) {\r\n                        element.removeAttr('checked');\r\n                    } else {\r\n                        element.prop('checked', true);\r\n                    }\r\n                });\r\n            } else {\r\n                $('#tab_all_languages').click();\r\n            }\r\n            self.modifiedLangs = {};\r\n        });\r\n    },\r\n\r\n    initReset: function () {\r\n        var self = this;\r\n        self.resetEvents();\r\n        $(\"#message-container\").hide();\r\n        $(\"#template-reset\").hide();\r\n    },\r\n\r\n    resetEvents: function () {\r\n        var self = this;\r\n        $('button#lang-reset-btn').on('click', function () {\r\n\r\n            self.loadingOption();\r\n            $(\"#message-container\").hide();\r\n            $(\"#template-reset\").hide();\r\n            var message = bizagi.localization.getResource(\"workportal-widget-admin-language-reset-confirmation\");\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"warning\")).done(function () {\r\n                $.when(self.dataService.resetPersonalization()).done(function (data) {\r\n                    if (data.result) {\r\n                        $(\"#message-container\").show();\r\n                        $(\"#template-reset\").show();\r\n                    }\r\n                })\r\n            });\r\n            self.notLoading();\r\n        });\r\n    },\r\n\r\n    loadingOption: function () {\r\n        $(\"div.ui-dialog\").append(\"<div class='loading-language ui-bizagi-loading-icon'><div class='loading-language-icon'></div></div>\");\r\n    },\r\n\r\n    notLoading: function () {\r\n        $(\"div.loading-language\").remove();\r\n        $(\"body\").removeClass(\"cursor-loading\");\r\n    },\r\n\r\n\r\n\r\n    addUploadMassiveResources: function () {\r\n        var self = this;\r\n\r\n        var internalsContainer = $(\"#internals\", self.panelWrapper);\r\n        var extendedContainer = $(\"#extended\", self.panelWrapper);\r\n        var objectsContainer = $(\"#bizagi_objects\", self.panelWrapper);\r\n        var entitiesContainer = $(\"#entities_localization \", self.panelWrapper);\r\n\r\n        var entitiesUrl = self.dataService.serviceLocator.getUrl(\"admin-language-entities\");\r\n        var defaultUrl = self.dataService.serviceLocator.getUrl(\"admin-language-resource\");\r\n\r\n        self.renderUploadPlugin(internalsContainer, self.formTemplate1, defaultUrl, \"internals\");\r\n        self.renderCultureCombo(internalsContainer, self.panelWrapper);\r\n        self.renderUploadPlugin(extendedContainer, self.formTemplate2, defaultUrl, \"extended\");\r\n        self.renderCultureCombo(extendedContainer, self.panelWrapper);\r\n        self.renderUploadPlugin(objectsContainer, self.formTemplate3, defaultUrl, \"objects\");\r\n        self.renderCultureCombo(objectsContainer);\r\n        self.renderUploadPlugin(entitiesContainer, self.formTemplate4, entitiesUrl, \"entities\");\r\n        self.renderCultureCombo(entitiesContainer);\r\n    },\r\n\r\n    /**\r\n    Binds the bizagiFileUpload plugin to the tab container\r\n    */\r\n    renderUploadPlugin: function (tabContainer, formTemplate, uploadUrl, responseTarget) {\r\n        var self = this;\r\n        var properties = {};\r\n        properties.addUrl = uploadUrl;\r\n        properties.validExtensions = self.config[\"validExtensions\"];\r\n        properties.maxSize = self.config[\"maxSize\"];\r\n        properties.maxfiles = \"1\";\r\n        properties.filesCount = \"\";\r\n        $(\"#massive-resources-upload-form-wrapper\", tabContainer).bizagiFileUpload({\r\n            showLoading: true,\r\n            alerFailtAfterUpload: self.getResource(\"workportal-widget-admin-language-alert-fail-after-upload\"),\r\n            formTemplate: formTemplate,\r\n            properties: {\r\n                cultureName: self.config[\"cultureName\"],\r\n                url: properties.addUrl,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize,\r\n                xpath: responseTarget\r\n            },\r\n            onUploadFileCompletedCallback: function (ref, data) {\r\n                var res=self.validateEntitiesModified(data);\r\n                bizagi.showMessageBox(bizagi.localization.getResource(res.messageKey)+res.entities, \"Bizagi\", \"info\");\r\n                self.handleResponse(\"alert-upload-massive-resources-template\", data);\r\n                $(\"div.loading-language\").remove();\r\n                $(\"body\").removeClass(\"cursor-loading\");\r\n            },\r\n            onUploadFileFailCallback: function (data) {\r\n                console.log(data);\r\n                $(\"div.loading-language\").remove();\r\n                $(\"body\").removeClass(\"cursor-loading\");\r\n            },\r\n            onUploadFileProcess: function () {\r\n                $(\"div.ui-dialog\").append(\"<div class='loading-language ui-bizagi-loading-icon'><div class='loading-language-icon'></div></div>\");\r\n            },\r\n            maxAllowedFiles: properties.maxfiles,\r\n            uploadedFiles: properties.filesCount\r\n        });\r\n    },\r\n    /*\r\n    * validate entities and return the modified and key resource for modal message\r\n    */\r\n    validateEntitiesModified: function (data) {\r\n        var response = JSON.parse(data);\r\n        var entitiesMessage=\"\";\r\n        var messageKey=\"workportal-widget-admin-language-alert-after-upload\";//normal upload file message\r\n        switch (response.message) {\r\n            case \"success\":\r\n                if (response.detail!=\"\"){//for entities\r\n                    var entities=response.detail==\"\"?[]:JSON.parse(response.detail);\r\n                    messageKey=\"workportal-widget-admin-language-alert-no-access-rights-after-upload\";//doesn't have permission\r\n                    if (entities.length>0) {//has permission\r\n                        entitiesMessage=\": \"+entities.join(\", \");\r\n                        messageKey=\"workportal-widget-admin-language-alert-entities-authorized-after-upload\";\r\n                    }\r\n                }\r\n                break;\r\n            case \"unauthorized\"://doesn't have permission\r\n                messageKey=\"workportal-widget-admin-language-alert-no-access-rights-after-upload\";\r\n                break;\r\n        }\r\n        \r\n        return {\r\n            messageKey:messageKey,\r\n            entities:entitiesMessage\r\n        };\r\n    },\r\n    /*\r\n    * Render combo\r\n    */\r\n    renderCultureCombo: function (tabContainer) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var deferred = $.Deferred();\r\n        var comboDataSource = { combo: [], id: \"cultureName\" };\r\n        comboDataSource.combo.push({ id: 'default', name: '' });\r\n        $.each(self.templateList.result, function (index, value) {\r\n            if (value.enabled) {\r\n                comboDataSource.combo.push({ id: value.key, name: value.value });\r\n            }\r\n        });\r\n        var comboWrapper = $(\".ui-bizagi-culturecombo\", tabContainer);\r\n        comboWrapper.empty();\r\n        comboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.name;\r\n            },\r\n            onComplete: function () {\r\n                $(\"[name='cultureName']\", tabContainer).val(comboDataSource.combo[0].id);\r\n                deferred.resolve();\r\n            },\r\n            onChange: function (obj) {\r\n                var sendBtn = $('button#upload-file', '#' + self.activeTab + '_upload_file'),\r\n                    value = obj.ui.data('value');\r\n                if (value !== 'default') {\r\n                    sendBtn.prop('disabled', false);\r\n                } else {\r\n                    sendBtn.prop('disabled', true);\r\n                }\r\n                $(\"[name='cultureName']\", tabContainer).val(value);\r\n            },\r\n            initValue: comboDataSource.combo[0]\r\n        });\r\n        return deferred;\r\n    },\r\n\r\n    handleResponse: function (div, data) {\r\n        var self = this,\r\n            dataLength = data.length,\r\n            errorDetail = \"Error\",\r\n            message;\r\n        if (dataLength == 0) {\r\n            self.initLanguageTemplatesList(self.startTab);\r\n        } else {\r\n            response = JSON.parse(data);\r\n            if (typeof (response.detail) != \"undefined\") {\r\n                if (response.detail.length > 200) {\r\n                    errorDetail = response.detail.substring(0, 197) + \" ...\";\r\n                }\r\n                else {\r\n                    errorDetail = response.detail;\r\n                }\r\n            }\r\n            message = bizagi.localization.getResource(response.message);\r\n            $(\"#\" + div).html(message + \" : \" + errorDetail);\r\n            $(\"#\" + div).parent().removeClass(\"ui-hidden\");\r\n        }\r\n    },\r\n\r\n    downloadTemplateEvent: function (source) {\r\n        var self = this,\r\n            listTable = $('#' + source + '-language-list-wrapper .ui-bizagi-grid-table', self.panelWrapper),\r\n            downloadBtn = $(\".lang-list-button button#\" + source + \"-tmpl-download-btn\", self.panelWrapper);\r\n        listTable.find('input[type=\"radio\"]').click(function (e) {\r\n            self.readyToDownload(source, listTable, downloadBtn);\r\n        });\r\n        downloadBtn.click(function (e) {\r\n            var activeBizagiObjects,\r\n                activeEntities,\r\n                selectedLang,\r\n                extendedObj,\r\n                params;\r\n            e.preventDefault();\r\n            selectedLang = listTable.find('input[type=\"radio\"]:checked').data('guid');\r\n            params = { \"cultureName\": selectedLang };\r\n            if (source === 'bizagi_objects') {\r\n                activeBizagiObjects = {\r\n                    'elements': self.getObjectsSelected()\r\n                };\r\n                params.elements = JSON.stringify(activeBizagiObjects);\r\n            } else if (source === 'entities') {\r\n                activeEntities = {\r\n                    'entities': self.getEntitiesSelected()\r\n                };\r\n                params.entities = JSON.stringify(activeEntities);\r\n            } else if (source === 'extended') {\r\n                extendedObj = {\r\n                    'elements': [\"extended\"]\r\n                };\r\n                params.elements = JSON.stringify(extendedObj);\r\n            }\r\n            self.dataService.getLanguageTemplate(params);\r\n\r\n        })\r\n    },\r\n\r\n    readyToDownload: function (source, listTable, downloadBtn) {\r\n        var self = this,\r\n            include = false,\r\n            langSelected = false;\r\n        if (!listTable) {\r\n            listTable = $('#' + source + '-language-list-wrapper .ui-bizagi-grid-table', self.panelWrapper);\r\n        }\r\n        if (!downloadBtn) {\r\n            downloadBtn = $(\".lang-list-button button#\" + source + \"-tmpl-download-btn\", self.panelWrapper);\r\n        }\r\n        if (source === 'internals') {\r\n            include = true;\r\n        } else if (source === 'extended') {\r\n            include = true;\r\n        } else if (source === 'bizagi_objects') {\r\n            include = ((self.getObjectsSelected().length > 0) ? true : false);\r\n        } else if (source === 'entities') {\r\n            include = ((self.getEntitiesSelected().length > 0) ? true : false);\r\n        }\r\n        if (listTable.find('input[type=\"radio\"]:checked').length > 0) {\r\n            langSelected = true;\r\n        }\r\n        if (include && langSelected) {\r\n            downloadBtn.removeAttr('disabled');\r\n        } else {\r\n            downloadBtn.attr('disabled', true);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * hide all tabs except tab_entities_localization if the Multilanguage is false but EntityAdmin is true\r\n     */\r\n    keyEntityValidation: function (context) {\r\n       \r\n        if(bizagi.menuSecurity.EntityAdmin && !bizagi.menuSecurity.Multilanguage){\r\n            $(\"#admin-language-wrapper-tabs > li:not(:has(#tab_entities_localization))\",context).hide();\r\n        }\r\n    },\r\n\r\n    handleTabEvents: function () {\r\n        var self = this,\r\n            actionRunning = false,\r\n            mainWrapper = $(\"#admin-language-wrapper\"),\r\n            content;\r\n        content = self.getContent();\r\n        $('.ui-tabs-anchor', '#admin-language-wrapper').click(function () {\r\n            $(\"#message-container\").hide();\r\n            $(\"#template-reset\").hide();\r\n            $(\"input.ui-all-languages-filter\").val('');\r\n        });\r\n        $(\"#tab_internals\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('internals')).done(function (data) {\r\n                    $(\"#internals_internal_tabs\").tabs({\r\n                        create: function (event, ui) {\r\n                            ui.tab.parent().removeClass('hidden');\r\n                        }\r\n                    });\r\n                    self.activeTab = 'internals';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_extended\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('extended')).done(function (data) {\r\n                    $(\"#extended_internal_tabs\").tabs({\r\n                        create: function (event, ui) {\r\n                            ui.tab.parent().removeClass('hidden');\r\n                        }\r\n                    });\r\n                    self.activeTab = 'extended';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_bizagi_objects\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('bizagi_objects')).done(function (data) {\r\n                    $(\"#bizagi_objects_internal_tabs\").tabs({\r\n                        create: function (event, ui) {\r\n                            ui.tab.parent().removeClass('hidden');\r\n                        }\r\n                    });\r\n                    $(\"#bizagi-objects-accordion\").accordion({ heightStyle: \"content\" });\r\n                    self.activeTab = 'bizagi_objects';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_entities_localization\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('entities')).done(function (data) {\r\n                    $(\"#entities_internal_tabs\").tabs({\r\n                        create: function (event, ui) {\r\n                            ui.tab.parent().removeClass('hidden');\r\n                        }\r\n                    });\r\n                    $(\"#entities-accordion\").accordion({ heightStyle: \"content\" });\r\n                    self.activeTab = 'entities';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_all_languages\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('all')).done(function (data) {\r\n                    self.initAllLangs();\r\n                    self.activeTab = 'all';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_reset\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('reset')).done(function (data) {\r\n                    self.allLangsEvents();\r\n                    self.activeTab = 'reset';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n\r\n        $(\".tab_upload_file\").click(function (e) {\r\n            self.addUploadMassiveResources();\r\n        });\r\n\r\n        // Only show \"Entities\" tab\r\n        $('#tab_reset').parent().hide();\r\n        $('#tab_internals').parent().show();\r\n\r\n    }\r\n});\r\n","/**\r\n * Name: BizAgi Desktop Widget Administration preferences Implementation\r\n * \r\n * @author Andres Fernando Muñoz\r\n */\r\n\r\nbizagi.workportal.widgets.admin.preferences.extend(\"bizagi.workportal.widgets.admin.preferences\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.bizagiUserPreferences = new bizagi.services.preferences();\r\n\r\n        self.guidForm;\r\n        self.isNewForm;\r\n\r\n        self.notifier = bizagi.injector.get(\"notifier\");\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.preferences.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-admin-preferences-wrapper\"),\r\n            \"admin.preferences.container\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preferences-container\"),\r\n            \"admin.preferences.buttons\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preference-buttons\"),\r\n            \"admin.preferences.iframe\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preference-iframe\"),\r\n            \"admin.preferences.error\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preferences-errormessage\"),\r\n            \"admin.preferences.properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preferences-properties\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        self.container = self.getTemplate(\"admin.preferences.container\");\r\n        self.buttons = self.getTemplate(\"admin.preferences.buttons\");\r\n        self.iframe = self.getTemplate(\"admin.preferences.iframe\");\r\n        self.errorMessage = self.getTemplate(\"admin.preferences.error\");\r\n        self.propertiesTmpl = self.getTemplate(\"admin.preferences.properties\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        $.when(self.dataService.getPreferenceFormParams()).done(function (data) {\r\n\r\n            self.guidForm = (data.id !== \"-1\") ? data.id : \"\";\r\n\r\n            if (data.errorMessage === true) {\r\n                self.renderErrorMessage();\r\n            } else if (data.isNewForm === true) {\r\n                self.renderPreferences();\r\n            } else {\r\n                self.renderPreferencesOldForm();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    renderErrorMessage: function () {\r\n        var self = this;\r\n\r\n        var resource = self.getResource(\"workportal-widget-admin-entities-message-migrate\");\r\n        resource = resource.replace(\"{build}\", bizagi.loader.productBuildToAbout);\r\n\r\n        var errorContent = $.tmpl(self.errorMessage, { errorMessage: resource });\r\n\r\n        self.content.html(errorContent);\r\n\r\n    },\r\n\r\n    setupData: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n    },\r\n\r\n    renderPreferencesOldForm: function () {\r\n\r\n        var self = this;\r\n\r\n        var $content = self.getContent();\r\n        var url = self.dataService.getUrl({\r\n            \"endPoint\": \"PreferenceFormOld\"\r\n        }) + \"?idForm=\" + self.guidForm + \"&referer=userPreferences\";\r\n\r\n        var $iframeContent = $.tmpl(self.iframe, { \"url\": url });\r\n        var $iframe = $(\"iframe\", $iframeContent);\r\n\r\n        $iframeContent.addClass('loading-iframe');\r\n\r\n        $iframe.hide();\r\n\r\n        $iframe.load(function () {\r\n            $(this).fadeIn();\r\n        });\r\n\r\n        $content.html($iframeContent)\r\n\r\n    },\r\n\r\n    renderPreferences: function () {\r\n        var self = this;\r\n        var readyDeferred = new $.Deferred();\r\n        var content = self.getContent();\r\n        self.currentUser = bizagi.currentUser.idUser;\r\n\r\n        var preferencesParams = {\r\n            h_action: \"LOADUSERPREFERENCESFORM\",\r\n            h_contexttype: \"entity\",\r\n            h_guidForm: self.guidForm\r\n        };\r\n\r\n        var renderContainer = $.tmpl(self.container);\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var rendering = new bizagi.rendering.facade();\r\n            //request to preferences definition service\r\n            self.dataService.getPreferencesForm(preferencesParams).done(function (data) {\r\n                var renderingParams = {\r\n                    canvas: renderContainer,\r\n                    data: data,\r\n                    type: \"\"\r\n                };\r\n                rendering.execute(renderingParams).done(function (form) {\r\n                    $(\"#preferences-tabs\").tabs();\r\n                    $(\"#properties\", content).html($.tmpl(\r\n                        self.propertiesTmpl,\r\n                        self.bizagiUserPreferences.getFormatValues(),\r\n                        {\r\n                            formatTime: self.bizagiUserPreferences.formatTime\r\n                        }\r\n                    ));\r\n                    var noPermission = true;\r\n                    if (bizagi.menuSecurity.OpenWindowsMaximized == true) {\r\n                        $(\"#displayoptions_OpenWindowsMaximized\", content).show();\r\n                        noPermission = false;\r\n                    }\r\n                    if (bizagi.menuSecurity.AlwaysCollapseActivitySidebars == true) {\r\n                        $(\"#displayoptions_collapseSidebars\", content).show();\r\n                        noPermission = false;\r\n                    }\r\n                    if (bizagi.menuSecurity.ReturnToInboxWhenTasksAreFinished == true) {\r\n                        $(\"#displayoptions_goToInbox\", content).show();\r\n                        noPermission = false;\r\n                    }\r\n                    if (noPermission) {\r\n                        $(\"#noPermission\", content).show();\r\n                    }\r\n\r\n                    $(\"#preferences-tabs-ul\").show();\r\n                    self.preferenceForm = rendering.form;\r\n                    self.preferenceForm && self.preferenceForm.properties ? (self.preferenceForm.properties.contexttype ? \"\" : (self.preferenceForm.properties.contexttype = \"entity\")) : \"\";\r\n                    $(\"#preferences\", content).html(renderContainer);\r\n                    content.find(\"#preferences-buttons\").css(\"display\", \"block\");\r\n                    self.handleEvents();\r\n                    readyDeferred.resolve();\r\n                });\r\n            });\r\n        });\r\n\r\n        return readyDeferred;\r\n    },\r\n\r\n    /*\r\n    *  Buttons for preferences actions\r\n    */\r\n    handleEvents: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $(\"#preferences-buttons\", content).html($.tmpl(self.buttons));\r\n\r\n        $(\"#update-preferences\", content).click(function (e) {\r\n            self.updateData();\r\n        });\r\n\r\n    },\r\n\r\n    updatePreferences: function () {\r\n        var self = this;\r\n        var error = self.getResource(\"workportal-widget-admin-preferences-error-same-value\");\r\n        var content = self.getContent();\r\n        var values = {};\r\n        var serializedForm = $(\".preferences-properties\").serialize() || \"\";\r\n        serializedForm = decodeURIComponent(serializedForm.replace(/\\+/g, \"%20\"));\r\n\r\n        serializedForm.split(\"&\").map(function (value, index) {\r\n            var key = value.split(\"=\");\r\n            if (key[0] != \"\" && key[1] != \"\") {\r\n                values[key[0]] = key[1];\r\n            }\r\n        });\r\n        values.numberRows = self.bizagiUserPreferences.getPreference(\"numberRows\");\r\n        values.maintenanceGuid = self.bizagiUserPreferences.getPreference(\"maintenanceGuid\");\r\n        values.maintenanceModifiedDate = self.bizagiUserPreferences.getPreference(\"maintenanceModifiedDate\");\r\n        values.version = self.bizagiUserPreferences.getPreference(\"version\");\r\n        if (values.decimalSeparator === ',' && !values.thousandSeparator)\r\n            values.thousandSeparator = '.'\r\n        if (values.thousandSeparator === '.' && !values.decimalSeparator)\r\n            values.decimalSeparator = ','\r\n\r\n        if (values.decimalSeparator && values.decimalSeparator === values.thousandSeparator) {\r\n            bizagi.showMessageBox(error, \"Error\");\r\n        }\r\n        else {\r\n            self.bizagiUserPreferences.overridePreferences(values);\r\n            self.notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-widget-admin-displayoptions-success\"), bizagi.localization.getResource(\"workportal-menu-preferences\"), \"\");\r\n        }\r\n\r\n    },\r\n\r\n    updateData: function () {\r\n        var self = this;\r\n        if (self.preferenceForm.validateForm()) {\r\n            var serviceRender = new bizagi.render.services.service();\r\n            var data = self.preferenceForm.collectRenderValuesForSubmit();\r\n            var content = self.getContent();\r\n\r\n            self.startLoading(content);\r\n\r\n            $.when(serviceRender.multiactionService.submitData({\r\n                action: \"SAVEUSERPREFERENCES\",\r\n                contexttype: \"entity\",\r\n                data: data,\r\n                surrogatekey: self.currentUser,\r\n                idPageCache: self.preferenceForm.idPageCache\r\n            })).done($.proxy(function (message) {\r\n                //Change language on sessionStorage if change language on preferences\r\n                if (data.language) {\r\n                    $.when(self.dataService.getCurrentUser()).done(function (currentUserData) {\r\n                        // Changing languaje\r\n                        $.when(assignLanguage(currentUserData.language)).done(function () {\r\n                            bizagi.util.changeData({ language: currentUserData.language });\r\n                            // Rendering\r\n                            self.executeRender();\r\n                        }).fail(function () { });\r\n                    }).fail(function () { });\r\n                } else {\r\n                    // Rendering\r\n                    self.executeRender();\r\n                }\r\n                self.updatePreferences();\r\n\r\n            }, data)).fail(function (data) {\r\n                var typeMessage = bizagi.localization.getResource(\"workportal-general-word-message\");\r\n                bizagi.showMessageBox(data.message, typeMessage);\r\n                //content.removeClass(\"loading-iframe\");\r\n                self.executeRender();\r\n            });\r\n        } else {\r\n            $(\"#preferences-tabs\").tabs({ active: 0 });\r\n        }\r\n    },\r\n    executeRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $.when(self.renderPreferences()).done(function () {\r\n            content.removeClass(\"loading-iframe\");\r\n        }).fail(function () { });\r\n    },\r\n    startLoading: function (content) {\r\n        content.find(\"#preferences-main-container\").css(\"display\", \"none\");\r\n        content.find(\"#preferences-buttons\").css(\"display\", \"none\");\r\n        content.addClass(\"loading-iframe\");\r\n    }\r\n\r\n});\r\n","/**\r\n * Name: BizAgi Desktop Widget Administration Display Options\r\n * \r\n * @author Diego Armando Poveda\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.displayOptions\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.notifier = bizagi.injector.get(\"notifier\");self.notifier = bizagi.injector.get(\"notifier\");\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.displayOptions.container\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.displayOptions\").concat(\"#ui-bizagi-workportal-widget-admin-display-options-container\")\r\n        });\r\n    },\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES;\r\n    },\r\n    \r\n    renderContent: function () {\r\n        var self = this;\r\n        var content;\r\n        content = self.content = $('<div></div>');\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        self.containerTemplate = self.getTemplate(\"admin.displayOptions.container\").markup;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var mainTemplate = self.containerTemplate;\r\n        self.displayOptionsInstance = new Vue({\r\n            template: mainTemplate,\r\n            data: {\r\n                maximizeModals: {\r\n                    label: '',\r\n                    value: false,\r\n                    hover: false\r\n                },\r\n                startPage: {\r\n                    label: '',\r\n                    input: '-------------',\r\n                    selected: '',\r\n                    focus: false,\r\n                    values: [\r\n                        {value: '', displayName: 'render-combo-empty-value'},\r\n                        {value: '1', displayName: 'workportal-widget-admin-displayoptions-startpage-auto'},\r\n                        {value: '2', displayName: 'workportal-widget-admin-displayoptions-startpage-me'},\r\n                        {value: '3', displayName: 'workportal-widget-admin-displayoptions-startpage-inbox'}\r\n                    ]\r\n                },\r\n                defaultTitle: '',\r\n                updatetTitle: '',\r\n                OpenWindowsMaximized: false,\r\n                showStartPageControl: false\r\n            },\r\n            computed: {\r\n                activeIndex: function(){\r\n                    return this.findIndex(this.startPage.input, this.startPage);\r\n                }\r\n            },\r\n            methods: {\r\n                getResource: function(resourceKey){\r\n                    return window.bizagi.localization.getResource(resourceKey);\r\n                },\r\n                setHover: function (value) {\r\n                    this.maximizeModals.hover = value;\r\n                },\r\n                setFocus: function (value) {\r\n                    this.startPage.focus = value;\r\n                },\r\n                chooseValue: function (item) {\r\n                    this.startPage.input = item.displayName;\r\n                    this.startPage.selected = item.value;\r\n                    this.setFocus(false);\r\n                },\r\n                debounce: bizagi.util.debounce(function(func, arg){\r\n                    func.apply(this, [arg]);\r\n                },200),\r\n                keyup: function(e){\r\n                    switch (e.keyCode) {\r\n                        case 13: // enter\r\n                            this.chooseEnter();\r\n                            break;\r\n                        case 38: // up\r\n                        case 40: // down\r\n                            this.changeOffset(e.keyCode - 39);\r\n                        default:\r\n                            this.setFocus(true);\r\n                            break;\r\n                    }\r\n                },\r\n                chooseEnter: function () {\r\n                    var index = this.activeIndex;\r\n                    var result = this.startPage.values[index];\r\n                    this.startPage.input = result.displayName;\r\n                    this.startPage.selected = result.value;\r\n                    this.startPage.focus = false;\r\n                },\r\n                changeOffset: function (delta) {\r\n                    var index = this.activeIndex;\r\n                    var input = '';\r\n                    index = index + delta;\r\n                    if (index > -1 && index < this.startPage.values.length) {\r\n                        this.startPage.input = this.startPage.values[index].displayName;\r\n                    }\r\n                },\r\n                findIndex: function (input) {\r\n                    var result, index = -1;\r\n                    result = this.findMatches(input);\r\n                    if (result) {\r\n                        index = this.startPage.values.findIndex(function (v) {\r\n                            return v.value === result.value;\r\n                        });\r\n                    }\r\n                    return index;\r\n                },\r\n                findMatches: function (input) {\r\n                    var element = this.startPage.values.find(function (v) {\r\n                        return v.displayName.toLowerCase().indexOf(input.toLowerCase()) > -1;\r\n                    });\r\n                    return element;\r\n                },\r\n                defaultConfigurations: function () {\r\n                    this.startPage.selected = '';\r\n                    this.startPage.input = '-------------';\r\n                    this.maximizeModals.value = false;\r\n                },\r\n                getRowValueCookie: function() {\r\n                    // Get Cookie Value\r\n                    var storedValue = '';\r\n                    if(bizagi.cookie(\"bizagiUserDisplayOptions\")){\r\n                        storedValue = JSON.parse(bizagi.cookie(\"bizagiUserDisplayOptions\"));\r\n                    }\r\n                    return storedValue;   \r\n                },\r\n                updateConfigurations: function () {\r\n                    var rows = '10';\r\n                    if(this.getRowValueCookie()){\r\n                        if(this.getRowValueCookie().numberRows){\r\n                            rows = this.getRowValueCookie().numberRows; //if there is a number row stored, it has to be keep in the storage.\r\n                        }\r\n                    }\r\n                    var result = {startPage:'', maximizeModals: '', numberRows: rows};\r\n\r\n                    if(this.showStartPageControl){\r\n                        if (this.startPage.selected !== '') {\r\n                            result.startPage = this.startPage.selected;\r\n                        }\r\n                    }else{\r\n                        result.startPage = '';\r\n                    }\r\n                \r\n                    \r\n                    if(this.OpenWindowsMaximized){\r\n                        result.maximizeModals = this.maximizeModals.value ? 'yes' : 'no';\r\n                    }else{\r\n                        result.maximizeModals = 'no';\r\n                    }\r\n                    \r\n                    // Set Cookie\r\n                    bizagi.cookie(\"bizagiUserDisplayOptions\", JSON.stringify(result));\r\n                    self.notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-widget-admin-displayoptions-success\"), bizagi.localization.getResource(\"workportal-menu-display-options\"),\"\");\r\n                }\r\n            },\r\n            // Components\r\n            components: {\r\n            },\r\n            // Life Cycle Hooks\r\n            created: function (){\r\n                var that = this;\r\n                this.maximizeModals.label =  this.getResource('workportal-widget-admin-displayoptions-maxmodals');\r\n                this.startPage.label = this.getResource('workportal-widget-admin-displayoptions-startpage');\r\n                this.defaultTitle = this.getResource('workportal-widget-admin-displayoptions-default');\r\n                this.updatetTitle = this.getResource('workportal-widget-admin-displayoptions-update');\r\n                this.startPage.values.forEach($.proxy(function(e) {\r\n                    e.displayName = this.getResource(e.displayName);\r\n                }, that));\r\n                                \r\n                // Load Cookie values \r\n                var storedValue = '';\r\n                if(bizagi.cookie(\"bizagiUserDisplayOptions\")){\r\n                    storedValue = JSON.parse(bizagi.cookie(\"bizagiUserDisplayOptions\"));\r\n                    var initElement = this.startPage.values.find(function (v) {\r\n                        return v.value === storedValue.startPage;\r\n                    });\r\n                    this.startPage.selected = initElement.value;\r\n                    this.startPage.input = initElement.displayName;\r\n\r\n                    this.maximizeModals.value = (storedValue.maximizeModals === 'yes') ? true : false;\r\n                }\r\n            },\r\n            mounted: function (){\r\n            },\r\n            destroyed: function () {\r\n            }\r\n        });\r\n\r\n        self.renderingDeferred.then($.proxy(self.mountView, self));\r\n    },\r\n\r\n    // Component Mount\r\n    mountView: function() {\r\n    \tvar self = this;\r\n        var $content = self.getContent();\r\n\r\n        self.security = new bizagi.workportal.command.security(self.dataService);\r\n        $.when(self.security.getSecurity())\r\n            .done(function(security) {\r\n                // Checking for MaximizeModalsOption into security(response)\r\n                if(bizagi.override.enableMaximizeModalsOption === false){\r\n                    security.OpenWindowsMaximized = false;\r\n                }\r\n                \r\n                self.displayOptionsInstance.OpenWindowsMaximized =  security.OpenWindowsMaximized;\r\n                self.displayOptionsInstance.showStartPageControl =  bizagi.override.enableStartPageDisplayOption;\r\n\r\n                setTimeout(function () {\r\n                    self.displayOptionsInstance.$mount($content[0]);\r\n                }, 100);\r\n            });\r\n    },\r\n\r\n    // Component Destroy\r\n\tdispose: function () {\r\n        var self = this;\r\n        self._super();\r\n        self.displayOptionsInstance.$destroy();\r\n    }\r\n});\r\n","﻿/**\r\n * Admin module to manage entities\r\n * @author Andres Felipe Arenas Vargas, Ricardo Alirio Perez Diaz\r\n */\r\nbizagi.workportal.widgets.admin.entities.extend(\"bizagi.workportal.widgets.admin.entities\", {}, {\r\n    /**\r\n     * Init constructor\r\n     * @param workportalFacade The workportalFacade to access to all components\r\n     * @param dataService The dataService for making requests\r\n     * @param params Widget Description\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        var templateName = \"bizagi.workportal.desktop.widgets.admin.entities\";\r\n        self.entitiesState = [];\r\n        self.actualShowingList = false;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        self._referrer = \"entity\";\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.entity.wrapper\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-wrapper\"),\r\n            \"admin.entity.panel.wrapper\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-panel-wrapper\"),\r\n            \"admin.entity.panel.wrapper-buttons\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-panel-wrapper-buttons\"),\r\n            \"admin.entity.list\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-list\"),\r\n            \"admin.entity.error\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-error\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        // Store\r\n        self._state = {\r\n        };\r\n\r\n        self.setInitialState();\r\n    },\r\n    /**\r\n     * Load all the templates\r\n     */\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        self.panelWrapper = $.tmpl(self.getTemplate(\"admin.entity.panel.wrapper\"));\r\n        self.panelWrapperButtons = self.getTemplate(\"admin.entity.panel.wrapper-buttons\");\r\n        self.entitiesList = self.getTemplate(\"admin.entity.list\");\r\n        self.entitiesError = self.getTemplate(\"admin.entity.error\");\r\n    },\r\n    /**\r\n     * Renders the content for the current widget\r\n     * Get the list of all parametric entities and display them in the Template\r\n     * If there is an error, display a a message\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var defer = $.Deferred();\r\n        content.empty();\r\n        $.when(self.dataService.getAdminEntitiesList())\r\n            .done(function (data) {\r\n                if (data.length > 0) {\r\n                    self.entities = data;\r\n                    var entityListWrapper = $(\"#admin-entity-list-wrapper\", self.panelWrapper);\r\n\r\n                    content.html(self.panelWrapper);\r\n                    $.tmpl(self.entitiesList, { entitiesList: self.entities }).appendTo(entityListWrapper);\r\n                    $(\"#entitiesList option:first\", entityListWrapper).attr('selected', 'selected');\r\n\r\n                    self.configureHandlers();\r\n                }\r\n                else {\r\n                    var notFoundMessage = self.getResource(\"workportal-general-first-line-no-records-found\");\r\n                    content.html($.tmpl(self.entitiesError, { errorMessage: notFoundMessage }));\r\n                }\r\n                defer.resolve();\r\n            })\r\n            .fail(function (error) {\r\n                self.entities = undefined;\r\n                var errorMessage = self.getResource(\"workportal-widget-admin-entities-error\");\r\n                content.html($.tmpl(self.entitiesError, { errorMessage: errorMessage }));\r\n                defer.reject();\r\n            });\r\n        return defer.promise();\r\n    },\r\n    /**\r\n     * Configure handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var entityListWrapper = $(\"#admin-entity-list-wrapper\", self.panelWrapper);\r\n\r\n        //Catch the typed text in the search field and filter the entities list\r\n        $(\"#searchEntity\", entityListWrapper).keyup(function () {\r\n            var includeOpt = false;\r\n            var matchString = $(this).val().toLowerCase();\r\n\r\n            $.each(self.entities, function () {\r\n                var el = $('#entitiesList option[value=\"' + this.guid + '\"]', entityListWrapper)\r\n                if (matchString.length > 1) {\r\n                    if (this.displayName.toLowerCase().indexOf(matchString) != -1) {\r\n                        if ($(el).parent('span.toggleOption').length) {\r\n                            $(el).unwrap();\r\n                        }\r\n                    } else {\r\n                        if ($(el).parent('span.toggleOption').length == 0) {\r\n                            $(el).wrap('<span class=\"toggleOption\" style=\"display: none;\" />');\r\n                        }\r\n                    }\r\n                } else {\r\n                    if ($(el).parent('span.toggleOption').length) {\r\n                        $(el).unwrap();\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        // EntitiesList listener\r\n        $(\"#entitiesList\", entityListWrapper).change(function () {\r\n            $('#entitiesList>span>option:selected', self.panelWrapper).prop('selected', false);\r\n           self.addButtons();\r\n            self.setInitialState();\r\n            self.reviewUploadFileState();\r\n            self.drawSimpleGrid({ page: 1 });\r\n        }).trigger(\"change\");\r\n\r\n        $(\"#bz-btn-language-settings\", entityListWrapper).click(function () {\r\n            self.openLanguageSettingsWidgetDialog();\r\n        });\r\n        \r\n        $(\".button-toggle-manage-entities\", self.panelWrapper).click(function() {\r\n            $(\".buttons-wrapper\", self.panelWrapper).toggle();\r\n            self.resizeAdminEntityWrapper();\r\n            $(\".button-toggle-manage-entities\", self.panelWrapper).toggleClass(\"collapse-arrow\");\r\n        });\r\n    },\r\n\r\n     /**\r\n     * add buttons to upload excel files\r\n     */\r\n    addButtons: function () {\r\n        var self = this;\r\n        var wrapperButtons = $(\".buttons-wrapper\", self.panelWrapper);\r\n        wrapperButtons.html($.tmpl(self.panelWrapperButtons));\r\n\r\n        $(\"#downloadButton\", self.panelWrapper).click(function () {\r\n            self.dataService.getEntityExcel(self.getSelectedItem().guidEntity)\r\n         });\r\n        $(\"#admin-entity-main-wrapper .admin-entity-last-report-link\").click(function () {\r\n            self.downloadLastReport();\r\n        });\r\n\r\n        $(\"#file-upload\", self.panelWrapper).change(function (file) {\r\n            self.uploadFile(file);\r\n        });\r\n\r\n        $(\"#admin-entity-main-wrapper .admin-entity-last-report-link\").click(function () {\r\n            self.downloadLastReport();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Resize the height of the admin Entity warpper container according to the height to the butoon wrapper container\r\n     */\r\n    resizeAdminEntityWrapper: function(){\r\n        var heightButtonWrapper = $('.manage-entities-container').height() + 12.83;\r\n        if (!bizagi.util.isEnableFeature(\"enableUploadBatchEntities\")) {\r\n            heightButtonWrapper = 0;\r\n            $('.manage-entities-container').hide();\r\n        }\r\n        $('#admin-entity-main-wrapper .admin-dialog-rightframe').css('height', 'calc(100% - '+heightButtonWrapper+'px)');\r\n    },\r\n     /**\r\n     * toggle buttons wrapper\r\n     */\r\n    toggleButtonsWrapper: function () {\r\n        var self = this;\r\n        $(\".buttons-wrapper\", self.panelWrapper).toggle();\r\n    },\r\n     /**\r\n     * upload an excel file\r\n     */\r\n    uploadFile: function () {\r\n        var self = this;\r\n        var guidEntity = self.getSelectedItem().guidEntity;\r\n        var url = self.dataService.serviceLocator\r\n            .getUrl(\"admin-entities-upload-excel\")\r\n            .replace(\"{EntityGuid}\", guidEntity)\r\n            .concat(\"?xsrf=\" + bizagi.getXSRFToken());\r\n        $(\"#file-upload\").kendoUpload({\r\n            async: {\r\n                saveUrl: url,\r\n                saveField: guidEntity\r\n            },\r\n            validation: {\r\n                allowedExtensions: [\".xlsx\"],\r\n                maxFileSize: bizagi.currentUser ? bizagi.currentUser.uploadMaxFileSize : 25000\r\n            },\r\n            showFileList: true,\r\n            multiple: false,\r\n            select: function (e) {\r\n                self.panelWrapper.find(\".k-widget\").hide();\r\n            },\r\n            upload: function (e) {\r\n                var isValid = validateFile(e);\r\n                if (isValid === \"true\") {\r\n                    self.entitiesState[guidEntity] = \"UPLOADING\";\r\n                    self.reviewUploadFileState();\r\n                } else {\r\n                    self.showMessage(isValid, true);\r\n                    e.preventDefault();\r\n                }\r\n            },\r\n            error: function() {\r\n                self.entitiesState[guidEntity] = \"Error\";\r\n                self.reviewUploadFileState();\r\n            },\r\n            success: function (e) {\r\n                guidEntity = e.sender.options.async.saveField;\r\n                self.entitiesState[guidEntity] = \"InProgress\";\r\n                self.reviewUploadFileState();\r\n            }\r\n        });\r\n        function validateFile(e) {\r\n            return $.map(e.files, function (file) {\r\n                var errorMessage = \"\";\r\n                if (file.extension !== e.sender.options.validation.allowedExtensions[0]) {\r\n                    errorMessage = self.getResource(\"render-upload-error-extensions\")+\".\";\r\n                }\r\n                else\r\n                    if (file.size > e.sender.options.validation.maxFileSize) {\r\n                        errorMessage = self.getResource(\"render-upload-iis-maxsize\")+\".\";\r\n                    }\r\n                return errorMessage != \"\" ? errorMessage : true;\r\n            }).join(\", \");\r\n        }\r\n    },\r\n     /**\r\n\t * To open the Language Settings widget dialog\r\n\t */\r\n\topenLanguageSettingsWidgetDialog: function() {\r\n        var self = this;\r\n\t\tvar defaultWidth = ($(window).width() - (($(window).width() * 15)/100)) + \"px\";\r\n        var widgetParameters = {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE,\r\n            data: { \"idCase\": \"LanguageAdmin\" },\r\n            closeVisible: false,\r\n            maximize: true,\r\n            modalParameters: {\r\n                title: self.getResource(\"workportal-menu-submenu-LanguageAdmin\"),\r\n                width: defaultWidth,\r\n                id: \"LanguageAdmin\"\r\n            }\r\n        };\r\n        self.publish(\"showDialogWidget\", widgetParameters);\r\n\t},\r\n    /**\r\n     * show a message \r\n     */\r\n    showMessage: function (message, isError) {\r\n        var self = this;\r\n        var icon  = '';\r\n        if(isError){\r\n            icon = '<svg  class=\"bz-icon bz-icon-16 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#icon-clear-circle\"></use></svg>';\r\n            $(\"#upload-message\", self.content).removeClass(\"success\");\r\n            $(\"#upload-message\", self.content).addClass(\"error\");\r\n        }else{\r\n            icon = '<svg  class=\"bz-icon bz-icon-16 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#check-mark\"></use></svg>';\r\n            $(\"#upload-message\", self.content).removeClass(\"error\");\r\n            $(\"#upload-message\", self.content).addClass(\"success\");\r\n        }\r\n        $(\"#upload-message\", self.panelWrapper).html(icon + message).css(\"display\", \"block\").fadeIn(\"slow\", self.resizeAdminEntityWrapper);\r\n        setTimeout(function() {\r\n            $(\"#upload-message\", self.panelWrapper).fadeOut(\"slow\", self.resizeAdminEntityWrapper);\r\n        }, 10000);\r\n    },\r\n     \r\n    /**\r\n     * Init the simple grid pluggin to display all the instances of the selected entity\r\n     */\r\n    drawSimpleGrid: function (params) {\r\n        var self = this;\r\n        self.actualShowingList = true;\r\n        var selectedEntity = $.extend(self.getSelectedItem(), params);\r\n        if (selectedEntity.idDisplayForm && selectedEntity.idDisplayForm != \"00000000-0000-0000-0000-000000000000\") {\r\n            var formParams = {\r\n                guid: selectedEntity.guidEntity,\r\n                guidForm: selectedEntity.idDisplayForm,\r\n                isStakeholder: false\r\n            };\r\n            $.when(self.dataService.getAdminEntitiesForm(formParams))\r\n                .done(function (responseFormDisplay) {\r\n                    self.performSimpleGrid(selectedEntity, responseFormDisplay);\r\n                });\r\n        }\r\n        else {\r\n            self.performSimpleGrid(selectedEntity);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process entity form\r\n     * @param content\r\n     * @param responseEntity\r\n     * @param responseFormDisplay\r\n     */\r\n    resolveEntityForm: function (responseEntity) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        var newResponseEntity = {};\r\n        var responseFormDisplay;\r\n\r\n        /**\r\n         * Get render elements within a form\r\n         * @param elements\r\n         * @return {Array}\r\n         */\r\n        var getRenderElements = function (elements) {\r\n            var result = [];\r\n            elements = elements || {};\r\n\r\n            $.each(elements, function (key, value) {\r\n                if (value.container) {\r\n                    result.push.apply(result, getRenderElements(value.container.elements));\r\n                } else {\r\n                    result.push(value.render.properties);\r\n                }\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n        var headerIsAnEntity = function (header) {\r\n            var entity = \"\";\r\n            // Search xpath within responseEntity object and check if it is an entity\r\n            $.each(responseEntity.header, function (key, value) {\r\n                if (value.fieldValue == header.xpath && (value.entity || value.relatedEntity)) {\r\n                    entity = value.entity || value.relatedEntity;\r\n                }\r\n            });\r\n\r\n            return entity;\r\n        };\r\n        /**\r\n         * Create headers from a form\r\n         * @param elements\r\n         * @param headers\r\n         * @return {Array}\r\n         */\r\n        var getFormHeaders = function (elements, headers) {\r\n            var result = [];\r\n            elements = getRenderElements(elements || {});\r\n\r\n            $.each(elements, function (key, value) {\r\n                var attributeType = value.dataType;\r\n                var entity = headerIsAnEntity(value);\r\n                var headerProperties = {};\r\n                switch (value.type) {\r\n                    case \"upload\":\r\n                        attributeType = 1002;\r\n                        break;\r\n                    case \"image\":\r\n                        attributeType = 1003;\r\n                        break;\r\n                }\r\n\r\n                headerProperties = $.extend(value, {\r\n                    \"guidAttribute\": matchHeaderWithXpath(headers, value.xpath),\r\n                    \"fieldValue\": value.xpath,\r\n                    \"attributeType\": attributeType\r\n                });\r\n\r\n                if (entity) {\r\n                    headerProperties.relatedEntity = entity;\r\n                }\r\n\r\n                result.push(headerProperties);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n        /**\r\n         * find the header with the xpath for return the guidAttribute\r\n         * @param {*} headers \r\n         * @param {*} xpath \r\n         */\r\n        var matchHeaderWithXpath = function (headers, xpath) {\r\n            var header = headers.filter(function (header) {\r\n                return xpath == header.fieldValue;\r\n            });\r\n            return header.length > 0 ? header[0].guidAttribute : undefined;\r\n        };\r\n\r\n        /**\r\n         * Get all values of a render controls\r\n         * @param surrogatedKeys\r\n         * @return {*}\r\n         */\r\n        var getFormDataRows = function (surrogatedKeys) {\r\n            var def = new $.Deferred();\r\n            var dataRows = [];\r\n            var queueForms = [];\r\n            var selectedEntity = self.getSelectedItem();\r\n            var formParams = {\r\n                guid: selectedEntity.guidEntity,\r\n                guidForm: selectedEntity.idDisplayForm,\r\n                isStakeholder: false\r\n            };\r\n            surrogatedKeys = surrogatedKeys || [];\r\n\r\n            // If there are not surrogatedKeys, call  getAdminEntitiesForm service\r\n            // without idRow, just for get headers\r\n            if (surrogatedKeys.length == 0) {\r\n                $.when(self.dataService.getAdminEntitiesForm(formParams)).done(function (result) {\r\n                    if (!responseFormDisplay) {\r\n                        responseFormDisplay = result;\r\n                    }\r\n                    // Resolve empty array of rows\r\n                    def.resolve([]);\r\n                });\r\n            } else {\r\n                $.each(surrogatedKeys, function (key, value) {\r\n                    var params = bizagi.clone(formParams);\r\n                    params.idRow = value;\r\n                    queueForms.push(self.dataService.multiaction().getAdminEntitiesForm(params));\r\n                });\r\n                // Resolve Queue of deferreds\r\n                $.when.apply($, queueForms).done(function () {\r\n                    var responses = Array.prototype.slice.call(arguments);\r\n                    $.map(responses, function (response, key) {\r\n                        var responseForm = response;\r\n                        if (!responseFormDisplay) {\r\n                            responseFormDisplay = responseForm;\r\n                        }\r\n                        var elements = getRenderElements(responseForm.form.elements);\r\n                        //Add surrogated key as a first element\r\n                        var surrogatedKey = surrogatedKeys[key];\r\n                        var values = [surrogatedKey];\r\n\r\n                        $.each(elements, function (elmKey, elmValue) {\r\n                            var value = elmValue.value;\r\n                            switch (elmValue.type) {\r\n                                case \"image\":\r\n                                case \"upload\":\r\n                                    value = \"...\";\r\n                                    break;\r\n                                case \"boolean\":\r\n                                    value = (elmValue.value) ? \"X\" : \"\";\r\n                                    break;\r\n                                case \"combo\":\r\n                                    if (typeof elmValue.value == \"object\" && elmValue.value.length > 0) {\r\n                                        if (typeof elmValue.value[0].value == \"object\") {\r\n                                            value = elmValue.value[0].value.join(\",\");\r\n                                        } else {\r\n                                            value = elmValue.value[0].value;\r\n                                        }\r\n                                    } else {\r\n                                        value = \"\"\r\n                                    }\r\n                                    break;\r\n                            }\r\n                            values.push(value);\r\n                        });\r\n\r\n                        dataRows.push(values);\r\n\r\n                        if (dataRows.length == surrogatedKeys.length) {\r\n                            def.resolve(dataRows);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n            return def.promise();\r\n        };\r\n\r\n        /**\r\n         * Get all surrogated keys\r\n         * @param entityObj\r\n         * @return {Array}\r\n         */\r\n        var getSurrogatedKeys = function (entityObj) {\r\n            var surrogatedKeys = [];\r\n            entityObj = entityObj || {};\r\n            if (entityObj.row) {\r\n                $.each(entityObj.row, function (key, value) {\r\n                    // Always the first element is a surrogated key\r\n                    surrogatedKeys.push(value[0]);\r\n                });\r\n            }\r\n            return surrogatedKeys;\r\n        };\r\n\r\n        var surrogatedKeys = getSurrogatedKeys(responseEntity);\r\n\r\n        $.when(getFormDataRows(surrogatedKeys)).done(function (dataRows) {\r\n            // Add surrogatedkey header\r\n            var headers = [responseEntity.header[0]];\r\n            headers.push.apply(headers, getFormHeaders(responseFormDisplay.form.elements, responseEntity.header));\r\n            newResponseEntity = {\r\n                header: headers,\r\n                entity: responseEntity.entity,\r\n                row: dataRows,\r\n                total: responseEntity.total,\r\n                page: responseEntity.page,\r\n                records: responseEntity.records\r\n            };\r\n            // self.renderTableEntity(content, params, newResponseEntity);\r\n            def.resolve(newResponseEntity);\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n    performSimpleGrid: function (selectedEntity, formDisplay) {\r\n        var self = this;\r\n        var simpleGridPlugginOptions = {\r\n            allowAdd: selectedEntity.allowAdd,\r\n            allowEdit: selectedEntity.allowEdit,\r\n            displayName: selectedEntity.displayName,\r\n            pageSize: 10,\r\n            page: parseInt(selectedEntity.page) || 1,\r\n            orderField: selectedEntity.orderField || \"\",\r\n            orderType: selectedEntity.orderType || \"asc\",\r\n            filters: selectedEntity.filters,\r\n            onDataBinding: function (args) {\r\n                args.pag = args.pag || self.getCurrentPageToSimpleGrid();\r\n                var def = $.Deferred();\r\n                if (args.pag) {\r\n                    self.setSelectedItem('page', args.pag);\r\n                }\r\n                $.when(self.dataService.getAdminEntitiesRowData($.extend(args, { guidEntity: selectedEntity.guidEntity })))\r\n                    .done(function (responseEntity) {\r\n                        if (selectedEntity.guidEntity != self.getSelectedItem().guidEntity)\r\n                            return;\r\n                        if (formDisplay) {\r\n                            responseEntity.relatedEntity = selectedEntity.guidEntity;\r\n                            var oldResponse = self.reshapeEntity(responseEntity, formDisplay);\r\n                            $.when(self.resolveEntityForm(responseEntity)).done(function (newResponseEntity) {\r\n                                def.resolve(newResponseEntity);\r\n                            });\r\n                        } else {\r\n                            def.resolve(responseEntity);\r\n                        }\r\n                    })\r\n                    .fail(function (error) {\r\n                        var errorMessage = self.getResource(\"workportal-widget-admin-entities-instances-error\");\r\n                        $(\"#admin-entity-instances-wrapper\", self.getContent()).html($.tmpl(self.entitiesError, { errorMessage: errorMessage }));\r\n                    });\r\n                return def.promise();\r\n            },\r\n            onLoadFilter: function (args) {\r\n                if (args.type === \"Entity\") {\r\n                    return self.dataService.getAdminEntityData(args);\r\n                }\r\n            },\r\n            onFilterChanged: function () {\r\n                self.setInitialState();\r\n            },\r\n            onPageChanging: function (beforePage, newPage) {\r\n                self.setCurrentPageToSimpleGrid(newPage);\r\n            },\r\n            onAdd: function (e, args) {\r\n                self.validateVersionForm(this, 'New');\r\n            },\r\n            onEdit: function (e, args) {\r\n                self.validateVersionForm(args, 'Edit');\r\n            },\r\n            getResource: function (key) {\r\n                self.getResource(key);\r\n            }\r\n        };\r\n        $(\"#admin-entity-instances-wrapper\", self.panelWrapper).simpleGrid(self, simpleGridPlugginOptions).render();\r\n    },\r\n    /**\r\n     * Return all the data of the selected item\r\n     * @return {{guidEntity: *, displayName: *, allowAdd: boolean, allowEdit: boolean}}\r\n     */\r\n    getSelectedItem: function () {\r\n        var self = this;\r\n        var $selectedEntity = $('#entitiesList option:selected', self.panelWrapper);\r\n        var params = {\r\n            guidEntity: $selectedEntity.val(),\r\n            displayName: $selectedEntity.text(),\r\n            allowAdd: ($selectedEntity.attr(\"data-allowAdd\").toLowerCase() === \"true\") ? true : false,\r\n            allowEdit: ($selectedEntity.attr(\"data-allowEdit\").toLowerCase() === \"true\") ? true : false,\r\n            idDisplayForm: $selectedEntity.attr(\"data-idDisplayForm\"),\r\n            page: $selectedEntity.attr(\"data-page\"),\r\n            row: self.currentIdRow,\r\n            orderField: $selectedEntity.data(\"orderField\"),\r\n            orderType: $selectedEntity.data(\"orderType\"),\r\n            filters: $selectedEntity.data(\"filters\")\r\n        };\r\n        return params;\r\n    },\r\n\r\n    setSelectedItem: function (property, value) {\r\n        var self = this;\r\n        var $selectedEntity = $('#entitiesList option:selected', self.panelWrapper);\r\n        $selectedEntity.attr('data-' + property, value);\r\n    },\r\n\r\n    /**\r\n     * Build the correct data to get the form based on the action {Edit, New}\r\n     * If the action is:\r\n     * - New: {guidEntity, guidForm}\r\n     * - Edit: {surrogateKey, guidEntity, guidForm}\r\n     * @param element The selected element\r\n     * @param action The action to perform\r\n     */\r\n    validateVersionForm: function (element, action) {\r\n        var self = this;\r\n        self.actualShowingList = false;\r\n        var $selectedEntity = $('#entitiesList option:selected', self.panelWrapper);\r\n        var entity = self.entities.find(function (e) { return e.guid === $selectedEntity.val() });\r\n        var params = {\r\n            guid: $selectedEntity.val()\r\n        };\r\n        if (action === 'New') {\r\n            params.guidForm = (typeof entity.idAddForm !== \"undefined\") ? entity.idAddForm : \"00000000-0000-0000-0000-000000000000\";\r\n        }\r\n        else if (action == 'Edit') {\r\n            params.idRow = $(element).attr('data-idrowentity');\r\n            params.guidForm = (typeof entity.idEditForm !== \"undefined\") ? entity.idEditForm : \"00000000-0000-0000-0000-000000000000\";\r\n        }\r\n\r\n        //Empty the canvas to render the form\r\n        $('#detailEntity', self.panelWrapper).empty();\r\n        if (params.guidForm === \"00000000-0000-0000-0000-000000000000\") {\r\n            self.getFormEntity(params);\r\n        }\r\n        else {\r\n            $.when(self.dataService.getAdminEntityMigrated(params.guidForm)).done(function (data) {\r\n                if (data.result == 0 || data.result == 10) {\r\n                    self.getFormEntity(params);\r\n                }\r\n                else {\r\n                    if (data.result == -9) {\r\n                        var errorMessage = self.getResource(\"workportal-widget-admin-entities-instances-error\");\r\n                        $(\"#admin-entity-instances-wrapper\", self.getContent()).html($.tmpl(self.entitiesError, { errorMessage: errorMessage }));\r\n                    }\r\n                    else {\r\n                        if (action == 'New') {\r\n                            params.idRow = -1;\r\n                        }\r\n                        var url = 'App/Admin/Entity.aspx?giudEntity=' + params.guid + '&idSurrogateKey=' + params.idRow + '&referer=entityadmin&Action=' + action + '&idForm=' + params.idForm;\r\n                        self.loadIframeForm(url, 'otherForm');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Collect the data changed in the form and save the values\r\n     * @param formRender the Form Rendered\r\n     */\r\n    saveFormEntity: function (formRender) {\r\n        var defSave = $.Deferred();\r\n        var serviceRender = new bizagi.render.services.service();\r\n        var renderValues = {};\r\n\r\n        formRender.collectRenderValues(renderValues);\r\n        $.when(serviceRender.multiactionService.submitData({\r\n            action: \"SAVE\",\r\n            contexttype: \"entity\",\r\n            data: renderValues,\r\n            surrogatekey: (typeof formRender.surrogatekey !== \"undefined\") ? formRender.surrogatekey : false,\r\n            idPageCache: formRender.idPageCache\r\n        })).done(function (formRender) {\r\n            if (formRender.type == \"success\") {\r\n                defSave.resolve(true);\r\n            }\r\n            else {\r\n                defSave.reject();\r\n            }\r\n        }).fail(function (formError) {\r\n            bizagi.showMessageBox(formError.message);\r\n            defSave.reject();\r\n        });\r\n        return defSave.promise();\r\n    },\r\n\r\n    //remove elements of the table if exist a display form\r\n    reshapeEntity: function (responseEntity, formDisplay) {\r\n        var self = this;\r\n        var newResponseEntity = {};\r\n        newResponseEntity.entity = responseEntity.entity;\r\n        newResponseEntity.page = responseEntity.page;\r\n        newResponseEntity.records = responseEntity.records;\r\n        newResponseEntity.total = responseEntity.total;\r\n        newResponseEntity.header = [];\r\n        newResponseEntity.row = [];\r\n        var indexElementsAdd = [];\r\n        $.each(formDisplay.form.elements, function (kF, vF) {\r\n            self.mergeFormAndTable(vF, newResponseEntity, indexElementsAdd, responseEntity);\r\n        });\r\n        if(self._referrer == \"stakeholder\"){\r\n            indexElementsAdd.push(responseEntity.header.length - 2);\r\n            newResponseEntity.header.push(responseEntity.header[responseEntity.header.length - 2]);            \r\n        }\r\n        indexElementsAdd.push(responseEntity.header.length - 1);\r\n        var desabledElement = responseEntity.header.slice(-1).pop();\r\n        newResponseEntity.header.push(desabledElement);\r\n        //validate if first element responseEntity exist in newResponseEntity else add becouse is subrrogate key\r\n        if (indexElementsAdd.indexOf(0) == -1) {\r\n            responseEntity.header[0].dataType = -11;\r\n            var firstElement = responseEntity.header[0];\r\n            newResponseEntity.header.unshift(firstElement);\r\n            indexElementsAdd.unshift(0);\r\n        }\r\n\r\n        var indexAdd = 0;\r\n        $.each(responseEntity.row, function (k, v) {\r\n            var newDataRow = [];\r\n            for (var i = 0; i < indexElementsAdd.length; i++) {\r\n                indexAdd = indexElementsAdd[i];\r\n                newDataRow[i] = v[indexAdd];\r\n            }\r\n            newResponseEntity.row[k] = newDataRow;\r\n        });\r\n        return newResponseEntity;\r\n    },\r\n\r\n    renderTable: function (element, newResponseEntity, indexElementsAdd, responseEntity) {\r\n        var self = this;\r\n        if (element.container) {\r\n            for (var i = 0; i < element.container.elements.length; i++) {\r\n                self.renderTable(element.container.elements[i], newResponseEntity, indexElementsAdd, responseEntity);\r\n            }\r\n        }\r\n        else {\r\n            $.each(responseEntity.header, function (index, header) {\r\n                if (element.render.properties.xpath) {\r\n                    if (element.render.properties.xpath.toUpperCase() == header.fieldValue.toUpperCase()) {\r\n                        //newResponseEntity.header.push(vE);\r\n\r\n                        newResponseEntity.header.push($.extend(header, element.render.properties));\r\n                        indexElementsAdd.push(index);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    mergeFormAndTable: function (element, newResponseEntity, indexElementsAdd, responseEntity) {\r\n        var self = this;\r\n        if (element.container) {\r\n            for (var i = 0; i < element.container.elements.length; i++) {\r\n                self.renderTable(element.container.elements[i], newResponseEntity, indexElementsAdd, responseEntity);\r\n            }\r\n        }\r\n        else {\r\n            $.each(responseEntity.header, function (index, header) {\r\n                if (element.render.properties.xpath) {\r\n                    if (element.render.properties.xpath.toUpperCase() == header.fieldValue.toUpperCase()) {\r\n                        //newResponseEntity.header.push(header);\r\n                        newResponseEntity.header.push($.extend(header, element.render.properties));\r\n                        indexElementsAdd.push(index);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Return currentPageGrid\r\n     * @returns {*}\r\n     */\r\n    getCurrentPageToSimpleGrid: function () {\r\n        var self = this;\r\n        return self._state.currentPageGrid;\r\n    },\r\n\r\n    /**\r\n     * Set index page,\r\n     * Initial value = 1. See simpleGrid widget for more details.\r\n     * @param newIndex\r\n     */\r\n    setCurrentPageToSimpleGrid: function (newIndex) {\r\n        var self = this;\r\n        self._state.currentPageGrid = newIndex;\r\n    },\r\n\r\n    /**\r\n     * Set initial state of widget\r\n     */\r\n    setInitialState: function () {\r\n        var self = this;\r\n        self.setCurrentPageToSimpleGrid(\"1\");\r\n    },\r\n\r\n    /**\r\n     * validate if the entity has a last report for show download last report link\r\n     */\r\n    existsLastReport: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var guidEntity = self.getSelectedItem().guidEntity;\r\n        var $link = $(\".admin-entity-last-report-link\", self.content);\r\n        $link.hide();\r\n        $.when(self.dataService.getAdminEntitiesExistsLastReport(guidEntity))\r\n            .done(function (response) {\r\n                if (response.exists) $link.show();\r\n                defer.resolve();\r\n            });\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * check each x seconds for a specific entity for review the state and show a message\r\n     * @param {string} guidEntityLast if this entities is send is because the method has been recalled but if the user has change the guidEntity selected this method stops\r\n     */\r\n    reviewUploadFileState: function (guidEntityLast) {\r\n        var self = this;\r\n        var guidEntity = self.getSelectedItem().guidEntity;\r\n        if (guidEntityLast != undefined && guidEntityLast != guidEntity)\r\n            return false;\r\n        if (self.entitiesState[guidEntity] === undefined) {\r\n            self.entitiesState[guidEntity] = true;//default value\r\n        }\r\n        self.showStateUploadingFile(self.entitiesState[guidEntity]);\r\n        if (self.entitiesState[guidEntity] !== \"UPLOADING\") {\r\n            $.when(self.dataService.getAdminEntityState(guidEntity))\r\n                .done(function (data) {\r\n                    if(self.entitiesState[guidEntity] == \"InProgress\" && data.state == \"Finished\"){\r\n                        self.reloadEntitiesListAfterUpload(guidEntity);\r\n                        self.showMessage(self.getResource(\"workportal-widget-admin-entities-upload-successful\")+\".\", false);\r\n                    }\r\n                    self.entitiesState[guidEntity] = data.state;\r\n                    if (self.showStateUploadingFile(data.state)) {\r\n                        setTimeout(function () {\r\n                            self.reviewUploadFileState(guidEntity);\r\n                        }, 3000);\r\n                    }\r\n                    self.existsLastReport();\r\n                });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * reload the Entities list if has finish upload entities file\r\n     * @param {*} guidEntity \r\n     */\r\n    reloadEntitiesListAfterUpload: function(guidEntity) {\r\n        var self=this;\r\n        var guidEntityActual = self.getSelectedItem().guidEntity;\r\n        if(guidEntityActual==guidEntity && self.actualShowingList){\r\n            self.drawSimpleGrid({\r\n                page: 1\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * show the correct state message for entity and return true if is necessary to check the state again\r\n     * @param {string} state (Error|InProgress|UPLOADING|*)\r\n     */\r\n    showStateUploadingFile: function (state) {\r\n        var self = this;\r\n        self.initialViewUploadEntities();\r\n        self.enableUploadButton()\r\n        var reCall = true;\r\n        switch (state) {\r\n            case \"Error\":\r\n                var message = self.getResource(\"workportal-widget-admin-entities-upload-error\");\r\n                self.showMessage(message, true);\r\n                break;\r\n            case \"InProgress\":\r\n                $(\"#entities-message-inProgress\", self.content).css(\"display\", \"block\");\r\n                self.disableUploadButton();\r\n                self.resizeAdminEntityWrapper();\r\n                break;\r\n            case \"UPLOADING\":\r\n                $(\"#entities-message-uploading\", self.content).css(\"display\", \"block\");\r\n                self.disableUploadButton();\r\n                self.resizeAdminEntityWrapper();\r\n                break;\r\n            default:\r\n                reCall = false;\r\n                break;\r\n        }\r\n        return reCall;\r\n    },\r\n\r\n    /**\r\n     * set hide to messages and enable upload button\r\n     */\r\n    initialViewUploadEntities: function () {\r\n        var self=this;\r\n        $(\"#uploadButton\", self.content).attr(\"disabled\", false);\r\n        $(\"#entities-message-inProgress\", self.content).hide();\r\n        $(\"#entities-message-error\", self.content).hide();\r\n        $(\"#entities-message-uploading\", self.content).hide();\r\n        self.resizeAdminEntityWrapper();\r\n    },\r\n\r\n    /**\r\n     * set disable upload button\r\n     */\r\n    disableUploadButton: function () {\r\n        $(\"#uploadButton\", self.content).addClass(\"disabled\");\r\n        $(\"#uploadButton\", self.content).attr(\"for\", \"\");\r\n        $(\"#uploadButton\", self.content).css(\"cursor\", \"not-allowed\");\r\n    },\r\n    /**\r\n     * set enable upload button\r\n     */\r\n    enableUploadButton: function () {\r\n        $(\"#uploadButton\", self.content).removeClass(\"disabled\");\r\n        $(\"#uploadButton\", self.content).attr(\"for\", \"file-upload\");\r\n        $(\"#uploadButton\", self.content).css(\"cursor\", \"pointer\");\r\n    },\r\n\r\n    /**\r\n     * download last entity report link\r\n     */\r\n    downloadLastReport: function () {\r\n        var self = this;\r\n        var guidEntity = self.getSelectedItem().guidEntity;\r\n        self.dataService.getAdminEntitiesDownloadLastReport(guidEntity);\r\n    }\r\n\r\n});\r\n","/**\r\n * Admin module to manage Stakeholders\r\n * @author Andres Felipe Arenas Vargas, Ricardo Alirio Perez Diaz\r\n */\r\nbizagi.workportal.widgets.admin.entities.extend(\"bizagi.workportal.widgets.admin.stakeholders\", {}, {\r\n    /**\r\n     * Init constructor\r\n     * @param workportalFacade The workportalFacade to access to all components\r\n     * @param dataService The dataService for making requests\r\n     * @param params Widget Description\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        var templateName = \"bizagi.workportal.desktop.widgets.admin.stakeholders\";\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        self._referrer = \"stakeholder\";\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.entity.wrapper\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-stakeholder-wrapper\"),\r\n            \"admin.stakeholder.panel.wrapper\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-stakeholder-panel-wrapper\"),\r\n            \"admin.stakeholder.list\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-stakeholder-list\"),\r\n            \"admin.stakeholder.error\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-stakeholder-error\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    /**\r\n     * Load all the templates\r\n     */\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        self.panelWrapper = $.tmpl(self.getTemplate(\"admin.stakeholder.panel.wrapper\"));\r\n        self.stakeholdersList = self.getTemplate(\"admin.stakeholder.list\");\r\n        self.stakeholdersError = self.getTemplate(\"admin.stakeholder.error\");\r\n    },\r\n    /**\r\n     * Renders the content for the current widget\r\n     * Get the list of all parametric entities and display them in the Template\r\n     * If there is an error, display a a message\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        content.empty();\r\n        $.when(self.dataService.getAdminStakeholdersList())\r\n            .done( function (data) {\r\n                if (data.length > 0) {\r\n                    self.stakeholders = data;\r\n                    var stakeholderListWrapper = $(\"#admin-stakeholder-list-wrapper\", self.panelWrapper);\r\n\r\n                    content.html(self.panelWrapper);\r\n                    $.tmpl(self.stakeholdersList, {stakeholdersList: self.stakeholders}).appendTo(stakeholderListWrapper);\r\n                    $(\"#stakeholdersList option:first\", stakeholderListWrapper).attr('selected', 'selected');\r\n\r\n                    self.configureHandlers();\r\n                }\r\n                else {\r\n                    var notFoundMessage = self.getResource(\"workportal-general-first-line-no-records-found\");\r\n                    content.html($.tmpl(self.stakeholdersError, {errorMessage: notFoundMessage}));\r\n                }\r\n            })\r\n            .fail( function (error) {\r\n                self.stakeholders = undefined;\r\n                var errorMessage = self.getResource(\"workportal-widget-admin-stakeholders-error\");\r\n                content.html($.tmpl(self.stakeholdersError, {errorMessage: errorMessage}));\r\n            });\r\n    },\r\n    /**\r\n     * Configure handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var stakeholderListWrapper = $(\"#admin-stakeholder-list-wrapper\", self.panelWrapper);\r\n\r\n        //Catch the typed text in the search field and filter the stakeholder list\r\n        $(\"#searchStakeholder\", stakeholderListWrapper).keyup(function () {\r\n            var includeOpt = false;\r\n            var matchString = $(this).val().toLowerCase();\r\n\r\n            $.each(self.stakeholders, function () {\r\n                var el = $('#stakeholdersList option[value=\"' + this.guid + '\"]', stakeholderListWrapper);\r\n                if (matchString.length > 1) {\r\n                    if (this.displayName.toLowerCase().indexOf(matchString) != -1) {\r\n                        if($(el).parent('span.toggleOption').length){\r\n                            $(el).unwrap( );\r\n                        }\r\n                    }else{\r\n                        if($(el).parent('span.toggleOption').length == 0) {\r\n                            $(el).wrap('<span class=\"toggleOption\" style=\"display: none;\" />');\r\n                        }\r\n                    }\r\n                }else{\r\n                    if($(el).parent('span.toggleOption').length){\r\n                        $(el).unwrap( );\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n        // Stakeholderlist listener\r\n        $(\"#stakeholdersList\", stakeholderListWrapper).change(function () {\r\n            $('#stakeholdersList>span>option:selected', self.panelWrapper).prop('selected', false);\r\n            self.setInitialState();\r\n            self.drawSimpleGrid();\r\n        }).trigger(\"change\");\r\n    },\r\n    /**\r\n     * Init the simple grid pluggin to display all the instances of the selected entity\r\n     */\r\n    drawSimpleGrid : function(){\r\n        var self = this;\r\n        var selectedEntity = self.getSelectedItem();\r\n        if (selectedEntity.idDisplayForm && selectedEntity.idDisplayForm != \"00000000-0000-0000-0000-000000000000\") {\r\n            var formParams = {\r\n                guid: selectedEntity.guidEntity,\r\n                guidForm: selectedEntity.idDisplayForm,\r\n                isStakeholder: false\r\n            };\r\n            $.when(self.dataService.getAdminEntitiesForm(formParams))\r\n                .done(function (responseFormDisplay) {\r\n                    self.performSimpleGrid(responseFormDisplay);\r\n                });\r\n        }\r\n        else {\r\n            self.performSimpleGrid();\r\n        }\r\n    },\r\n\r\n    performSimpleGrid: function (formDisplay) {\r\n        var self = this;\r\n        var selectedEntity = self.getSelectedItem();\r\n        var simpleGridPlugginOptions = {\r\n            allowAdd: selectedEntity.allowAdd,\r\n            allowEdit: selectedEntity.allowEdit,\r\n            displayName: selectedEntity.displayName,\r\n            page: self.getCurrentPageToSimpleGrid(),\r\n            pageSize: 7,\r\n            orderField: selectedEntity.orderField || \"\",\r\n            orderType: selectedEntity.orderType || \"asc\",\r\n            filters: selectedEntity.filters,\r\n            onDataBinding: function(args) {\r\n                args.pag = self.getCurrentPageToSimpleGrid();\r\n                var def = $.Deferred();\r\n                $.when(self.dataService.getAdminEntitiesRowData($.extend(args, {guidEntity: selectedEntity.guidEntity})))\r\n                    .done(function (responseEntity) {\r\n                        if(formDisplay){\r\n                            var newResponseEntity = self.reshapeEntity(responseEntity, formDisplay);\r\n                            def.resolve(newResponseEntity);\r\n                        }else{\r\n                            def.resolve(responseEntity);\r\n                        }\r\n                    })\r\n                    .fail(function (error) {\r\n                    var errorMessage = self.getResource(\"workportal-widget-admin-stakeholders-instances-error\");\r\n                    $(\"#admin-stakeholder-instances-wrapper\", self.getContent()).html($.tmpl(self.stakeholdersError, { errorMessage: errorMessage }));\r\n                });\r\n                return def.promise();\r\n            },\r\n            onLoadFilter: function(args){\r\n                if (args.type === \"Entity\") {\r\n                    return self.dataService.getAdminEntityData(args);\r\n                }\r\n            },\r\n            onFilterChanged: function(){\r\n                self.setInitialState();\r\n            },\r\n            onPageChanging: function(beforePage, newPage){\r\n                self.setCurrentPageToSimpleGrid(newPage);\r\n            },\r\n            onAdd: function(e, args) {\r\n                self.validateVersionForm(this, 'New');\r\n            },\r\n            onEdit: function(e, args) {\r\n                self.validateVersionForm(args, 'Edit');\r\n            },\r\n            getResource: function(key) {\r\n                self.getResource(key);\r\n            }\r\n        };\r\n\r\n        $(\"#admin-stakeholder-instances-wrapper\", self.panelWrapper).simpleGrid(self, simpleGridPlugginOptions).render();\r\n    },\r\n    /**\r\n     * Return all the data of the selected item\r\n     * @return {{guidEntity: *, displayName: *, allowAdd: boolean, allowEdit: boolean}}\r\n     */\r\n    getSelectedItem: function () {\r\n        var self = this;\r\n        var $selectedStakeholder = $('#stakeholdersList option:selected', self.panelWrapper);\r\n        var params = {\r\n            guidEntity: $selectedStakeholder.val(),\r\n            displayName: $selectedStakeholder.text(),\r\n            allowAdd: ($selectedStakeholder.attr(\"data-allowAdd\").toLowerCase() === \"true\") ? true : false,\r\n            allowEdit: ($selectedStakeholder.attr(\"data-allowEdit\").toLowerCase() === \"true\") ? true : false,\r\n            idDisplayForm: $selectedStakeholder.attr(\"data-idDisplayForm\"),\r\n            row: self.currentIdRow,\r\n            orderField: $selectedStakeholder.data(\"orderField\"),\r\n            orderType: $selectedStakeholder.data(\"orderType\"),\r\n            filters: $selectedStakeholder.data(\"filters\")\r\n        };\r\n\r\n        return params;\r\n    },\r\n    /**\r\n     * Build the correct data to get the form based on the action {Edit, New}\r\n     * If the action is:\r\n     * - New: {guidEntity, guidForm}\r\n     * - Edit: {surrogateKey, guidEntity, guidForm}\r\n     * @param element The selected element\r\n     * @param action The action to perform\r\n     */\r\n    validateVersionForm: function (element, action) {\r\n        var self = this;\r\n        var $selectedStakeholder = $('#stakeholdersList option:selected', self.panelWrapper);\r\n        var stakeholder = self.stakeholders.find(function (e) {return e.guid === $selectedStakeholder.val()});\r\n        var params = {\r\n            guid: $selectedStakeholder.val(),\r\n            isStakeholder: true\r\n        };\r\n        if (action === 'New') {\r\n            params.guidForm = (typeof stakeholder.idAddForm !== \"undefined\") ? stakeholder.idAddForm : \"00000000-0000-0000-0000-000000000000\";\r\n        }\r\n        else if (action == 'Edit') {\r\n            params.idRow = $(element).attr('data-idrowentity');\r\n            params.guidForm = (typeof stakeholder.idEditForm !== \"undefined\") ? stakeholder.idEditForm : \"00000000-0000-0000-0000-000000000000\";\r\n        }\r\n\r\n        //Empty the canvas to render the form\r\n        $('#detailEntity', self.panelWrapper).empty();\r\n        if (params.guidForm === \"00000000-0000-0000-0000-000000000000\") {\r\n            self.validateUser(params, action);\r\n        }\r\n        else {\r\n            $.when(self.dataService.getAdminEntityMigrated(params.guidForm)).done(function (data) {\r\n                if (data.result == 0 || data.result == 10) {\r\n                    self.validateUser(params, action);\r\n                }\r\n                else {\r\n                    if (data.result == -9) {\r\n                        var errorMessage = self.getResource(\"workportal-widget-admin-stakeholders-instances-error\");\r\n                        $(\"#admin-stakeholder-instances-wrapper\",self.getContent()).html($.tmpl(self.stakeholdersError, { errorMessage: errorMessage }));\r\n                    }\r\n                    else {\r\n                        if (action == 'New') {\r\n                            params.idRow = -1;\r\n                        }\r\n                        var url = 'App/Admin/Entity.aspx?giudEntity=' + params.guid + '&idSurrogateKey=' + params.idRow + '&referer=entityadmin&Action=' + action + '&idForm=' + params.idForm;\r\n                        self.loadIframeForm(url, 'otherForm');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Collect the data changed in the form and save the values\r\n     * @param formRender the Form Rendered\r\n     */\r\n    saveFormEntity: function (formRender) {\r\n        var self = this;\r\n        var defSave = $.Deferred();\r\n        var renderValues = {};\r\n        var selectedStakeholder = self.getSelectedItem();\r\n\r\n        formRender.collectRenderValues(renderValues);\r\n\r\n        if (self.associatedUserHasChange(renderValues)) {\r\n            $.when(self.duplicatedUser(renderValues)).done(function (resp) {\r\n\r\n                if (resp.length > 0) {\r\n                    var alreadyAssociated = resp.find(function (e) {return e.idEntity === selectedStakeholder.guidEntity});\r\n        \r\n                    if (typeof alreadyAssociated !== \"undefined\"){\r\n                        var confirmationMsg = bizagi.localization.getResource(\"workportal-widget-admin-entities-user-asociated-error\");\r\n                        bizagi.showMessageBox(confirmationMsg, \"Bizagi\", \"warning\");\r\n                    }\r\n                    else {\r\n                        self.submitFormData(formRender, renderValues, defSave);\r\n                    }\r\n                }\r\n                else {\r\n                    self.submitFormData(formRender, renderValues, defSave);\r\n                }\r\n            \r\n            }).fail(function (error) {\r\n                bizagi.showMessageBox(error.message);\r\n            });\r\n        }else{\r\n            self.submitFormData(formRender, renderValues, defSave);\r\n        }\r\n     \r\n        return defSave.promise();\r\n    },\r\n    /**\r\n     * Submit the data of the form and resolve de deferred\r\n     * @param formRender the Form Rendered\r\n     * @param renderValues the values of the form\r\n     * @param defSave the deferred\r\n     */\r\n    submitFormData: function (formRender, renderValues, defSave) {\r\n        var self = this;\r\n        var serviceRender = new bizagi.render.services.service();\r\n\r\n        $.when(serviceRender.multiactionService.submitData({\r\n            action: \"SAVE\",\r\n            contexttype: \"entity\",\r\n            data: renderValues,\r\n            surrogatekey: (typeof formRender.surrogatekey !== \"undefined\" ? formRender.surrogatekey : false),\r\n            idPageCache: formRender.idPageCache\r\n        })).done(function (formRender) {\r\n            if (formRender.type == \"success\") {\r\n                defSave.resolve(true);\r\n            }\r\n            else {\r\n                defSave.reject();\r\n            }\r\n        }).fail(function (formError) {\r\n            bizagi.showMessageBox(formError.message);\r\n            defSave.reject();\r\n        });\r\n    },\r\n    /**\r\n     * Check if the associated user has changed. A user changes when:\r\n     * - There is no selected associated user and the user search and select one\r\n     * - There is an associated user and the user change it\r\n     * @returns {boolean}\r\n     */\r\n    associatedUserHasChange: function (renderValues) {\r\n        var self = this;\r\n        var userChanged = false;\r\n\r\n        if (typeof self._associatedUser !== \"undefined\" ) {\r\n            if (typeof renderValues.associatedUser !== \"undefined\") {\r\n                if (self._associatedUser.id !== renderValues.associatedUser.id) {\r\n                    userChanged = true;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (typeof renderValues.associatedUser !== \"undefined\") {\r\n                userChanged = true;\r\n            }\r\n        }\r\n        return userChanged;\r\n    },\r\n    validateUser: function(params, action) {\r\n        var self = this;\r\n        var selectedStakeholder = self.getSelectedItem();\r\n        $.when(self.getFormEntity(params)).done(function(loadedForm) {\r\n            var selectedUser = loadedForm.getRender(\"associatedUser\");\r\n             if(action == \"Edit\" && selectedUser){\r\n                $(\".bz-render-getUser-container\").html(selectedUser.value.value);\r\n             }\r\n            selectedUser.bind(\"renderchange\", function(e, element) {\r\n                element.render.getValue();\r\n                var renderValues = {};\r\n                loadedForm.collectRenderValues(renderValues);\r\n                $.when(self.duplicatedUser(renderValues)).done(function(resp){\r\n                    if (resp.length > 0) {\r\n                        var alreadyAssociated = resp.find(function (e) {return e.idEntity === selectedStakeholder.guidEntity});\r\n                        if (typeof alreadyAssociated !== \"undefined\"){\r\n                            var confirmationMsg = bizagi.localization.getResource(\"workportal-widget-admin-entities-user-asociated-error\");\r\n                            $.when(bizagi.showMessageBox(confirmationMsg, \"Bizagi\", \"warning\")).done(function () {\r\n                                element.render.input.val(\"\");\r\n                                element.render.value = null;\r\n                            }).fail(function () {\r\n                                element.render.input.val(\"\");\r\n                                element.render.value = null;\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n        });\r\n        \r\n    },\r\n    duplicatedUser: function(renderValues){\r\n        var self = this;\r\n        var defSave = $.Deferred();\r\n        $.when(self.dataService.getUserStakeholders({ idUser: renderValues.associatedUser.id })).done(function (resp) {\r\n            defSave.resolve(resp);\r\n        }).fail(function (formError) {\r\n            defSave.reject(formError);\r\n        });\r\n        return defSave.promise();\r\n    }\r\n});\r\n","/**\r\n * Admin module to manage applications OAuth 2\r\n * @author Alex Esteban Rojas Gutierrez\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.oauth2Applications\", {}, {\r\n\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS;\r\n    },\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        var templateName = \"bizagi.workportal.desktop.widgets.admin.oauth2.applications\";\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Load templates\r\n        self.loadTemplates({\r\n            \"admin.oauth2applications\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-oauth2applications\"),\r\n            \"admin.edit.oauth2applications\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-edit-oauth2applications\"),\r\n            \"admin.add.oauth2applications\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-add-oauth2applications\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        // Model's declaration\r\n        self.CurrentClientData = {};\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        self.content = $.tmpl(self.getTemplate(\"admin.oauth2applications\"));\r\n        return self.content;\r\n    },\r\n    /* Load all the templates */\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        self.contentOauth = $.tmpl(self.getTemplate(\"admin.oauth2applications\"));\r\n\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        content.html(self.contentOauth);\r\n        self.performSimpleGrid();\r\n    },\r\n\r\n    performSimpleGrid: function () {\r\n        var self = this;\r\n        var simpleGridPlugginOptions = {\r\n            allowAdd: true,\r\n            allowEdit: true,\r\n            allowDelete: true,\r\n            allow: true,\r\n            orderEnabled: false,\r\n            displayName: 'Oauth',\r\n            pageSize: 10,\r\n            onDataBinding: function (args) {\r\n                var def = $.Deferred();\r\n                $.when(self.dataService.getOAuth2Applications().done(function (data, args) {\r\n                    var headers = ['Id', 'Name', 'Description', 'ClientId', 'ClientSecret', 'AuthorizationGrantType', 'AccessTokenLifetimeInMinutes','AllowedScope','DefaultUserDomain', 'DefaultUserName', 'RedirectUri', 'RedirectUriStrategy', 'Website'];\r\n                    data.data.map(function (element) {\r\n                        headers.forEach(function (hv) {\r\n                            if (element[hv] === undefined) {\r\n                                element[hv] = '';\r\n                            }\r\n\r\n                            if(hv === 'AuthorizationGrantType' && element[hv] === 'any'){\r\n                                element[hv] = 'all';\r\n                            }\r\n                        });\r\n                        return element;\r\n                    });\r\n                    var responseOauth = {};\r\n\r\n                    if (data.data.length) {\r\n                        responseOauth.header = $.map($(headers), function (item) {\r\n                            return {\r\n                                attributeType: 1004,\r\n                                dataType: 2,\r\n                                displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-applications-' + item.toLowerCase()),\r\n                                fieldValue: 'idGuestSH',\r\n                                xpath: 'GuestSH'\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    self.namesApplications = [];\r\n\r\n                    responseOauth.row = $.map(data.data, function (item) {\r\n                        self.namesApplications.push(item.Name);\r\n                        return [$.map($(headers).filter(Object.keys(data.data[0])), function (key) {\r\n                            var value = item[key]\r\n                            if(key == \"AllowedScope\"){\r\n                                value = (item[key][0]+' '+item[key][1]).replace(\"openid\", \"\").trim();\r\n                            }\r\n                                \r\n                            return value;\r\n                        })];\r\n                    });\r\n\r\n                    /*responseOauth.total = data.data.length;\r\n                     responseOauth.page = args.pag || 1;\r\n                     responseOauth.records = data.data.length;*/\r\n\r\n                    def.resolve(responseOauth);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                }));\r\n\r\n                $.when(self.dataService.getCurrentUser()).done(function (currentUserData, args) {\r\n                    self.userFullName = currentUserData.user;\r\n                }).fail(function () { });\r\n\r\n                return def.promise();\r\n            },\r\n            onAdd: function (e, args) {\r\n                self.addApplication(this, 'New');\r\n            },\r\n            onEdit: function (e, args) {\r\n                self.editApplication($(args).attr(\"data-idrowentity\"));\r\n            },\r\n            onDelete: function (e, args) {\r\n                self.deleteApplication($(args).attr(\"data-idrowentity\"));\r\n            },\r\n            getResource: function (key) {\r\n                /*self.getResource(key);*/\r\n            }\r\n        };\r\n\r\n        $(\"#admin-oauth2-applications-table\", self.getContent()).simpleGrid(self, simpleGridPlugginOptions).render();\r\n    },\r\n\r\n    addApplication: function (element, action) {\r\n        var self = this;\r\n\r\n        var tmplGT = $.tmpl(self.getTemplate(\"admin.add.oauth2applications\"), {});\r\n        tmplGT.appendTo(\"#admin-oauth2-add-application\");\r\n\r\n        $('#admin-oauth2-applications-wrapper').hide();\r\n        $('#admin-oauth2-add-application').show();\r\n\r\n        self.setupAddApplicationEvents();\r\n\r\n        self.setupCombos(\"add\");\r\n\r\n    },\r\n\r\n    setupAddApplicationEvents: function () {\r\n        var self = this;\r\n        $('#btn-admin-oauth2-add').click(function () { self.save() });\r\n        $('#btn-admin-oauth2-cancel').click(function () { self.cancel(\"add\") });\r\n        self.setupUserSuggest();\r\n    },\r\n\r\n    setupUserSuggest: function (edit) {\r\n        var type = '';\r\n        if (edit) {\r\n            type = 'edit-';\r\n        }\r\n        var self = this;\r\n        var stp = null;\r\n        var inputDomain = $('#biz-wp-oauth2-' + type + 'user-domain-input');\r\n        var inputUserName = $('#biz-wp-oauth2-default-' + type + 'user-name-input');\r\n        var options = $('#biz-wp-oauth2-default-' + type + 'user-name-options');\r\n        $(inputUserName).focus(function (event) {\r\n            if($(this).length > 0 && options[0].children.length > 0){\r\n                $(options).css('display', 'block');\r\n            }\r\n            else{\r\n                $(options).css('display', 'none');\r\n            }\r\n        });\r\n        $(inputUserName).keyup(function (event) {\r\n            var that = this;\r\n            var up = 38;\r\n            var down = 40;\r\n            var select = 13;\r\n            var proximo = 0;\r\n\r\n            switch (event.keyCode) {\r\n                case select:\r\n                    selectData();\r\n                    break;\r\n                case up:\r\n                    upOrDown(\"up\");\r\n                    break;\r\n                case down:\r\n                    upOrDown(\"down\");\r\n                    break;\r\n                default:\r\n                    searchNames();\r\n                    break;\r\n            }\r\n            function selectData() {\r\n                var target = $('#biz-wp-oauth2-default-' + type + 'user-name-options .selected:first').attr(\"data-target0\");\r\n                var domain = $('#biz-wp-oauth2-default-' + type + 'user-name-options .selected:first').attr(\"data-target1\");\r\n                $(that).val(target);\r\n                $(inputDomain).val(domain)\r\n                $(options).html('');\r\n                $(options).css('display', 'none');\r\n            }\r\n\r\n            function upOrDown(direction) {\r\n                $.each($('.user-option'), function (index) {\r\n                    if ($(this).hasClass(\"selected\")) {\r\n                        switch (direction) {\r\n                            case \"down\":\r\n                                proximo += index + 1;\r\n                                break;\r\n                            case \"up\":\r\n                                proximo = index - 1;\r\n                                break;\r\n                        }\r\n                    }\r\n\r\n                });\r\n                if (proximo == $('.user-option').length) {\r\n                    return false;\r\n                } else if (proximo < 0) {\r\n                    return false;\r\n                }\r\n                $.each($('.user-option'), function (index) {\r\n                    $(this).removeClass('selected');\r\n                    if (index === proximo) {\r\n                        $(this).addClass('selected');\r\n                    }\r\n                })\r\n            }\r\n            function searchNames() {\r\n                $(inputDomain).val('');\r\n                $(options).fadeIn();\r\n                if (stp !== null) { clearTimeout(stp); }\r\n                stp = setTimeout(function (value) {\r\n                    if (value != '') {\r\n                        var params = { userName: value };\r\n                        self.dataService.searchUsers(params)\r\n                            .done(function (result) {\r\n                                if (result.users && Array.isArray(result.users) && result.users.length > 0) {\r\n                                    self.createOptionsArray(result.users.filter(function (x, i) { return (i < 5); }), options, [{ element: inputUserName, value: 'userName' }, { element: inputDomain, value: 'domain' }]);\r\n                                } else {\r\n                                    $(options).html('<div class=\"user-no-option\">' + bizagi.localization.getResource('workportal-widget-admin-oauth2-user-search-no-results') + ' </div>');\r\n                                }\r\n                            })\r\n                            .fail(function () { $(options).html(''); });\r\n                    } else {\r\n                        $(options).css('display', 'none');\r\n                    }\r\n                }, 400, event.currentTarget.value);\r\n            }\r\n        }).closest('.biz-wp-form-cell').focusout(function () {\r\n            $(options).fadeOut();\r\n        });\r\n\r\n        // Access token input\r\n        self.validationAccessTokenInput(edit ? \"#biz-wp-oauth2-edit-access-token-input\" : \"#biz-wp-oauth2-access-token-input\", edit)();\r\n    },\r\n\r\n    validationAccessTokenInput: function (accessTokenSelector, isEdit) {\r\n        var accessTokenInput = $(accessTokenSelector);\r\n\r\n        if(!isEdit) {\r\n            accessTokenInput.val(0);\r\n        }\r\n\r\n        function updateSuggest() {\r\n            var num = +$(accessTokenSelector).val();\r\n            if(num === 0) {\r\n                $(\"#suggest_lifetime\").text(bizagi.localization.getResource('workportal-widget-admin-oauth2-applications-access-token-lifetime-never-expires'));\r\n            } else {\r\n                $(\"#suggest_lifetime\").text(\"\");\r\n            }\r\n        }\r\n\r\n        accessTokenInput.change(updateSuggest);\r\n\r\n        return updateSuggest;\r\n    },\r\n\r\n    createOptionsArray: function (users, options, targets) {\r\n        var self = this;\r\n        $(options).html('');\r\n        users.forEach(function (user) {\r\n            $(options).append(self.createOption(user, targets, options));\r\n        });\r\n    },\r\n    createOption: function (value, targets, options) {\r\n        var data = targets.reduce(function (result, target, index) { return result + 'data-target' + index + '=\"' + value[target.value] + '\" ' }, '');\r\n        return $('<div class=\"user-option\" ' + data + \"></div>\")\r\n            .click({ targets: targets }, function (ev) {\r\n                var that = this;\r\n                ev.data.targets.forEach(function (target, index) {\r\n                    $(target.element).val($(that).data('target' + index));\r\n                });\r\n                $(options).html('');\r\n            })\r\n            .html(value.domain + ' \\\\ ' + value.userName);\r\n    },\r\n\r\n    setupCombos: function (type) {\r\n        var self = this;\r\n        var dataGrandType = [{\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-authorization-code'), //\"Authorization Code\",\r\n            id: \"authorization_code\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-client-credentials'), //\"Client credentials\",\r\n            id: \"client_credentials\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-all'), //All\r\n            id: \"any\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-bearer-token'), // Bearer token\r\n            id: \"bearer_token\"\r\n        }\r\n        ];\r\n\r\n        var dataRedirectUri = [{\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-web-application'), //\"Web Application\",\r\n            id: \"WebApplication\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-mobile-bar'), //\"Mobile Title Bar Browser\",\r\n            id: \"MobileTitleBarBrowser\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-mobile-port'), //\"Mobile Localhost Port\",\r\n            id: \"MobileLocalhostPort\"\r\n        }\r\n        ];\r\n\r\n        if (type === \"add\") {\r\n            var $comboGrandType = $(\"#biz-wp-oauth2-grant-type-input\");\r\n            var $comboAllowedScope = $(\"#biz-wp-oauth2-allowed-scope-input\");\r\n            var $comboRedirectUri = $(\"#biz-wp-oauth2-redirect-uri-strategy-input\");\r\n\r\n            self.setupCombo($comboGrandType, dataGrandType, \"grantType\");\r\n            self.setupCombo($comboRedirectUri, dataRedirectUri, \"RedirectUri\");\r\n\r\n            self.initializeOauth2Template(\"authorization_code\");\r\n        }\r\n\r\n        if (type === \"edit\") {\r\n            var $comboEditGrandType = $(\"#biz-wp-oauth2-edit-grant-type-input\");\r\n            var $comboEditAllowedScope = $(\"#biz-wp-oauth2-edit-allowed-scope-input\");\r\n            var $comboEditRedirectUri = $(\"#biz-wp-oauth2-edit-redirect-uri-strategy-input\");\r\n            self.setupCombo($comboEditGrandType, dataGrandType, \"editGrantType\");\r\n            self.setupCombo($comboEditRedirectUri, dataRedirectUri, \"editRedirectUri\");\r\n        }\r\n    },\r\n\r\n    initializeOauth2Template: function(grantType) {\r\n        var scopeLogin = $(\"#biz-wp-oauth2-edit-scope-login-input, #biz-wp-oauth2-scope-login-input\");\r\n        var scopeUserSync = $(\"#biz-wp-oauth2-scope-user-sync-input, #biz-wp-oauth2-edit-scope-user-sync-input\");\r\n        var scopeODataQuery = $(\"#biz-wp-oauth2-scope-odata-query-input, #biz-wp-oauth2-edit-scope-odata-query-input\");\r\n\r\n        if(grantType === \"bearer_token\") {\r\n            $(\".bz-oauth2-only-authorization-code, .bz-oauth2-only-edit-authorization-code, #bz-oauth2-only-WebApplication, #bz-oauth2-edit-only-WebApplication\").hide();\r\n            $(\".bz-oauth2-only-client-credentials, .bz-oauth2-only-edit-client-credentials\").show();\r\n            scopeUserSync.removeAttr(\"disabled\").prop(\"checked\", false);\r\n            scopeLogin.attr(\"disabled\", true).prop(\"checked\", false);\r\n        } else if (grantType === \"client_credentials\") {\r\n            scopeLogin.attr(\"disabled\", true).prop(\"checked\", false);            \r\n        } else if(grantType === \"authorization_code\") {\r\n            scopeUserSync.attr(\"disabled\", true).prop(\"checked\", false);\r\n            scopeODataQuery.attr(\"disabled\", true).prop(\"checked\", false);\r\n        }\r\n    },\r\n\r\n    setupCombo: function (elem, data, dataSelf) {\r\n        var self = this;\r\n\r\n        if (dataSelf === \"grantType\") { self.grantType = data[0].id }\r\n        if (dataSelf === \"RedirectUri\") { self.RedirectUri = data[0].id }\r\n\r\n        self.pos = 0;\r\n\r\n        if (dataSelf === \"editGrantType\") {\r\n            self.editGrantType = self.editGrantType || data[0].id;\r\n            $.each(data, function (i) {\r\n                if (data[i].id === self.editGrantType) { self.pos = i; }\r\n            })\r\n        }\r\n\r\n        if (dataSelf === \"editRedirectUri\") {\r\n            self.editRedirectUri = self.editRedirectUri || data[0].id;\r\n            $.each(data, function (i) {\r\n                if (data[i].id === self.editRedirectUri) { self.pos = i; }\r\n            })\r\n        }\r\n\r\n        if (self.comboElements) {\r\n            self.comboElements.push(elem);\r\n        } else {\r\n            self.comboElements = [];\r\n        }\r\n\r\n        elem.uicombo({\r\n            data: { combo: data },\r\n            initValue: data[self.pos],\r\n            itemValue: function (item) {\r\n                return item.id;\r\n            },\r\n            itemText: function (item) {\r\n                return item.displayName;\r\n            },\r\n            onChange: function (obj) {\r\n                var bizOAuth2UserSyncInput = $(\"#biz-wp-oauth2-scope-user-sync-input, #biz-wp-oauth2-edit-scope-user-sync-input\");\r\n                var bizOAuth2ODataQueryInput = $(\"#biz-wp-oauth2-scope-odata-query-input, #biz-wp-oauth2-edit-scope-odata-query-input\");\r\n                $(\".bz-oauth2-only-authorization-code, .bz-oauth2-only-edit-authorization-code, #bz-oauth2-only-WebApplication, #bz-oauth2-edit-only-WebApplication\").show();\r\n                $(\"#biz-wp-oauth2-edit-scope-login-input, #biz-wp-oauth2-scope-login-input\").removeAttr(\"disabled\").prop(\"checked\", false);\r\n\r\n                if (dataSelf === \"grantType\" || dataSelf === \"editGrantType\") {\r\n                    if (dataSelf === \"grantType\") { self.grantType = obj.ui.data(\"value\") }\r\n                    if (dataSelf === \"editGrantType\") { self.editGrantType = obj.ui.data(\"value\") }\r\n                    if (obj.ui.data(\"value\") === \"client_credentials\") {\r\n                        $(\".bz-oauth2-only-edit-authorization-code\").hide();\r\n                        $(\".bz-oauth2-only-authorization-code\").hide();\r\n                        $(\".bz-oauth2-only-edit-client-credentials\").show();\r\n                        $(\".bz-oauth2-only-client-credentials\").show();\r\n                        bizOAuth2UserSyncInput.removeAttr(\"disabled\").prop(\"checked\", false);\r\n                        bizOAuth2ODataQueryInput.removeAttr(\"disabled\").prop(\"checked\", false);\r\n                    } else if (obj.ui.data(\"value\") === \"authorization_code\") {\r\n                        $(\".bz-oauth2-only-client-credentials\").hide();\r\n                        $(\".bz-oauth2-only-authorization-code\").show();\r\n                        $(\".bz-oauth2-only-edit-client-credentials\").hide();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\").show();\r\n                        bizOAuth2UserSyncInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                        bizOAuth2ODataQueryInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                    } else if (obj.ui.data(\"value\") === \"bearer_token\") { /*  */ } else {\r\n                        $(\".bz-oauth2-only-client-credentials\").show();\r\n                        $(\".bz-oauth2-only-authorization-code\").show();\r\n                        $(\".bz-oauth2-only-edit-client-credentials\").show();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\").show();\r\n                        bizOAuth2UserSyncInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                        bizOAuth2ODataQueryInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                    }\r\n                    self.initializeOauth2Template(obj.ui.data(\"value\"));\r\n                }\r\n\r\n                if (dataSelf === \"RedirectUri\" || dataSelf === \"editRedirectUri\") {\r\n                    if (dataSelf === \"RedirectUri\") { self.RedirectUri = obj.ui.data(\"value\") }\r\n                    if (dataSelf === \"editRedirectUri\") { self.editRedirectUri = obj.ui.data(\"value\") }\r\n                    if (obj.ui.data(\"value\") === \"WebApplication\") {\r\n                        $(\"#bz-oauth2-only-MobileLocalhostPort\").hide();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\").hide();\r\n                        $(\"#bz-oauth2-only-WebApplication\").show();\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\").show();\r\n                    } else if (obj.ui.data(\"value\") === \"MobileTitleBarBrowser\") {\r\n                        $(\"#bz-oauth2-only-WebApplication\").hide();\r\n                        $(\"#bz-oauth2-only-MobileLocalhostPort\").hide();\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\").hide();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\").hide();\r\n                    } else {\r\n                        $(\"#bz-oauth2-only-WebApplication\").hide();\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\").hide();\r\n                        $(\"#bz-oauth2-only-MobileLocalhostPort\").show();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\").show();\r\n                    }\r\n                }\r\n\r\n                if (dataSelf === \"AllowedScope\") { self.AllowedScope = obj.ui.data(\"value\") }\r\n                if (dataSelf === \"editAllowedScope\") { self.editAllowedScope = obj.ui.data(\"value\") }\r\n            }\r\n        });\r\n    },\r\n\r\n    showErrors: function (target, messageToken) {\r\n        target.show();\r\n        target.html(bizagi.localization.getResource(messageToken));\r\n    },\r\n\r\n    dataValidating: function (form) {\r\n        var self = this;\r\n        var prefix = '';\r\n        if (form === 'edit') {\r\n            prefix = 'edit-';\r\n        }\r\n\r\n        var errorsBoard = $(\"#bz-oauth2-applications-errors-board\");\r\n        errorsBoard.hide();\r\n        $(\"#bz-oauth2-applications-\" + prefix + \"error-scope-required\").hide();\r\n\r\n        // Validating App Name\r\n        var inputName = $(\"#biz-wp-oauth2-\" + prefix + \"name-input\").val();\r\n        inputName = inputName.trim();\r\n\r\n        if (inputName.length < 1) {\r\n            self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-app-name-required');\r\n            return false;\r\n        } else if (self.namesApplications.findIndex(function (n) { return n === inputName; }) >= 0) {\r\n            if (form !== 'edit' || self.CurrentClientData.Name !== inputName) {\r\n                self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-name-duplicated');\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Validating Allowed scope\r\n        if (!($(\"#biz-wp-oauth2-\" + prefix + \"scope-api-input\").is(':checked')\r\n            || $(\"#biz-wp-oauth2-\" + prefix + \"scope-login-input\").is(':checked')\r\n            || $(\"#biz-wp-oauth2-\" + prefix + \"scope-user-sync-input\").is(':checked'))\r\n        ) {\r\n            self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-atleastone-allowed-scope');\r\n            $(\"#bz-oauth2-applications-\" + prefix + \"error-scope-required\").show();\r\n            return false;\r\n        }\r\n\r\n        // Validating Data depending of GrantType\r\n        //-- Client Credentials required\r\n        var grantType = (form === 'save') ? self.grantType : self.editGrantType;\r\n\r\n        var inputDefaultUserDomain = $(\"#biz-wp-oauth2-\" + prefix + \"user-domain-input\").val().trim();\r\n        var inputDefaultUserName = $(\"#biz-wp-oauth2-default-\" + prefix + \"user-name-input\").val().trim();\r\n\r\n        if (grantType === \"client_credentials\" || grantType === \"any\") {\r\n            if (inputDefaultUserDomain.length < 1 || inputDefaultUserName.length < 1) {\r\n                self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-user-domain-required');\r\n                return false;\r\n            }\r\n        }\r\n\r\n        //-- Auth Code required\r\n        var RedirectUri = (form === 'save') ? self.RedirectUri : self.editRedirectUri;\r\n        var inputRedirectUri = $(\"#biz-wp-oauth2-\" + prefix + \"redirect-uri-input\").val().trim();\r\n        var inputMobileHostPort = $(\"#biz-wp-oauth2-\" + prefix + \"mobile-host-port\").val().trim();\r\n        if (grantType === \"authorization_code\" || grantType === \"any\") {\r\n            if (RedirectUri === \"WebApplication\") {\r\n                if (inputRedirectUri.length < 1 || !(/^(ftp|http|https):\\/\\/[^ \"]+$/.test(inputRedirectUri))) {\r\n                    self.showErrors(errorsBoard, 'workportal-widget-admin-users-request-url-invalid');\r\n                    return false;\r\n                }\r\n            } else if (RedirectUri === \"MobileLocalhostPort\") {\r\n                if (inputMobileHostPort.length < 1 || isNaN(inputMobileHostPort) || (Math.floor(inputMobileHostPort) !== parseFloat(inputMobileHostPort))) {\r\n                    self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-port-invalid');\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Validating Token Life Time\r\n        var inputAccessTokenLifetimeInMinutes = $(\"#biz-wp-oauth2-\" + prefix + \"access-token-input\").val().trim();\r\n        if (inputAccessTokenLifetimeInMinutes.length < 1 || isNaN(inputAccessTokenLifetimeInMinutes) || (Math.floor(inputAccessTokenLifetimeInMinutes) !== parseFloat(inputAccessTokenLifetimeInMinutes))) {\r\n            self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-time-invalid');\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    save: function () {\r\n        var self = this;\r\n\r\n        if (self.dataValidating('save') === true) {\r\n            var allowedScope = \"\";\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-api-input\").is(':checked')) {\r\n                allowedScope += \"api\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-login-input\").is(':checked')) {\r\n                allowedScope += \" login\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-user-sync-input\").is(':checked')) {\r\n                allowedScope += \" usersync\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-odata-query-input\").is(':checked')) {\r\n                allowedScope += \" odataquery\";\r\n            }\r\n\r\n            var dataAddApplication = {};\r\n            dataAddApplication[\"authorization_grant_type\"] = self.grantType;\r\n            dataAddApplication[\"allowed_scope\"] = allowedScope;\r\n            dataAddApplication[\"username_creator\"] = self.userFullName;\r\n            dataAddApplication[\"redirect_uri_strategy\"] = self.RedirectUri;\r\n\r\n            /*This value is necesary because service returns error: url is malformed*/\r\n            if (self.grantType === \"client_credentials\" || self.grantType === \"bearer_token\") {\r\n                dataAddApplication[\"redirect_uri\"] = \"http://localhost--\";\r\n            }\r\n\r\n            var dataInputs = $(\"#formAddOAuthApp :input\").serializeArray();\r\n            for (var i = 0; i < dataInputs.length; i++) {\r\n                if (dataInputs[i].value) {\r\n                    if (dataInputs[i].name === \"redirect_uri_port\" && self.RedirectUri === \"MobileLocalhostPort\") {\r\n                        dataAddApplication[\"redirect_uri\"] = dataInputs[i].value;\r\n                    } else {\r\n                        dataAddApplication[dataInputs[i].name] = dataInputs[i].value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            self.dataService.createOAuth2Application(dataAddApplication).done(function () {\r\n                self.performSimpleGrid();\r\n                self.cancel(\"add\");\r\n            });\r\n        }\r\n    },\r\n\r\n    getGrantType: function (index) {\r\n        var dataGrandType = {\r\n            authorization_code: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-authorization-code'), //\"Authorization Code\",\r\n            client_credentials: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-client-credentials'), //\"Client credentials\",\r\n            any: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-all'), //\"All\",\r\n        };\r\n        return dataGrandType[index];\r\n    },\r\n\r\n    getRedirectStrategy: function (index) {\r\n        var dataRedirectStrategy = {\r\n            WebApplication: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-web-application'), //\"Web Application\",\r\n            MobileTitleBarBrowser: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-mobile-bar'), //\"Mobile Title Bar Browser\",\r\n            MobileLocalhostPort: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-mobile-port'), //\"Mobile Localhost Port\",\r\n        };\r\n        return dataRedirectStrategy[index];\r\n    },\r\n    getMobileLocalhostPort: function (uri, strategy) {\r\n        if (strategy === \"MobileLocalhostPort\") {\r\n            var port = uri.match(/:([0-9]+)/)[1];\r\n            return parseInt(port);\r\n        } else {\r\n            return '';\r\n        }\r\n    },\r\n\r\n    //LOAD FORM TO EDIT OAUTH CLIENT\r\n    editApplication: function (applicationId) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        content = (content[4]) ? content[4] : content[2];\r\n\r\n        $.when(self.dataService.getOAuth2Application(applicationId)).done(function (data) {\r\n            if (data.success) {\r\n                // data = data.data;\r\n                self.CurrentClientData = data.data;\r\n                if(self.CurrentClientData.RedirectUriStrategy != \"WebApplication\")\r\n                    self.CurrentClientData.uri = '';\r\n                else\r\n                    self.CurrentClientData.uri = self.CurrentClientData.RedirectUri;\r\n                var tmplGT = $.tmpl(\r\n                    self.getTemplate(\"admin.edit.oauth2applications\"), {\r\n                        editGrantType: self.CurrentClientData.AuthorizationGrantType,\r\n                        data: self.CurrentClientData\r\n                    }, {\r\n                        getGrantType: self.getGrantType,\r\n                        getRedirectStrategy: self.getRedirectStrategy,\r\n                        getMobileLocalhostPort: self.getMobileLocalhostPort\r\n                    }\r\n                );\r\n                tmplGT.appendTo(content);\r\n\r\n                self.ActualNameForEdit = self.CurrentClientData.Name;\r\n                self.DataAllowedScope = self.CurrentClientData.AllowedScope;\r\n\r\n                self.editGrantType = self.CurrentClientData.AuthorizationGrantType;\r\n                self.editRedirectUri = self.CurrentClientData.RedirectUriStrategy;\r\n\r\n                function checkedScope(scope) {\r\n                    return $.grep(self.CurrentClientData.AllowedScope, function (n) { return n === scope }).length;\r\n                }\r\n\r\n                if (checkedScope(\"api\") > 0) {\r\n                    $(\"#biz-wp-oauth2-edit-scope-api-input\", content).prop(\"checked\", true);\r\n                }\r\n\r\n                if (checkedScope(\"login\") > 0) {\r\n                    $(\"#biz-wp-oauth2-edit-scope-login-input\", content).prop(\"checked\", true);\r\n                }\r\n\r\n                if (checkedScope(\"usersync\") > 0) {\r\n                    setTimeout(function () { // Se debe esperar que el elemento se renderice completamente\r\n                        $(\"#biz-wp-oauth2-edit-scope-user-sync-input\", content).prop(\"checked\", true);\r\n                    });\r\n                }\r\n\r\n                if (checkedScope(\"odataquery\") > 0) {\r\n                    setTimeout(function () { // Se debe esperar que el elemento se renderice completamente\r\n                        $(\"#biz-wp-oauth2-edit-scope-odata-query-input\", content).prop(\"checked\", true);\r\n                    });\r\n                }\r\n\r\n                //Visual Setup for Grant Type, Allowed Scope and Redirect Strategy\r\n                if (!self.CurrentClientData.IsNative) {\r\n                    self.setupCombos(\"edit\");\r\n\r\n                    if (self.editGrantType === \"client_credentials\") {\r\n                        $(\".bz-oauth2-only-edit-client-credentials\", content).show();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\", content).hide();\r\n                    } else if (self.editGrantType === \"authorization_code\") {\r\n                        $(\".bz-oauth2-only-edit-client-credentials\", content).hide();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\", content).show();\r\n                    } else if (self.editGrantType === \"bearer_token\") {\r\n                        //\r\n                    } else {\r\n                        $(\".bz-oauth2-only-edit-client-credentials\", content).show();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\", content).show();\r\n                    }\r\n\r\n                    self.initializeOauth2Template(self.editGrantType);\r\n\r\n                    if (self.CurrentClientData.RedirectUriStrategy === \"WebApplication\") {\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\", content).show();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\", content).hide();\r\n                    } else if (self.CurrentClientData.RedirectUriStrategy === \"MobileTitleBarBrowser\") {\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\", content).hide();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\", content).hide();\r\n                    } else {\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\", content).hide();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\", content).show();\r\n                    }\r\n                } else {\r\n                    //Disable Allowed Scope Checkbox\r\n                    $(\"#biz-wp-oauth2-edit-scope-api-input\", content).attr(\"disabled\", true);\r\n                    $(\"#biz-wp-oauth2-edit-scope-login-input\", content).attr(\"disabled\", true);\r\n                }\r\n            }\r\n\r\n            $('#admin-oauth2-applications-wrapper').hide();\r\n            $(content).show();\r\n\r\n            //Buttons Setup\r\n            $('#btn-admin-oauth2-update-keys', content).click(function () { self.updateApplicationKeys() });\r\n            $('#btn-admin-edit-oauth2-cancel', content).click(function () { self.cancel(\"edit\") });\r\n            if (!self.CurrentClientData.IsNative) {\r\n                $('#btn-admin-edit-oauth2-add', content).click(function () { self.updateApplication() });\r\n            } else {\r\n                $('#btn-admin-edit-oauth2-add', content).click(function () { self.updateNaviteApplication() });\r\n            }\r\n            self.setupUserSuggest(true);\r\n\r\n        }).fail(function () { });\r\n    },\r\n\r\n    //UPDATE ACTION FOR NATIVE APPLICATIONS\r\n    updateNaviteApplication: function () {\r\n        var self = this;\r\n        var dataAddApplication = { accessTokenLifetimeInMinutes: \"\" };\r\n        dataAddApplication.accessTokenLifetimeInMinutes = parseInt($(\"#biz-wp-oauth2-edit-access-token-input\").val(), 10);\r\n        if (!isNaN(dataAddApplication.accessTokenLifetimeInMinutes) && dataAddApplication.accessTokenLifetimeInMinutes > 0) {\r\n            self.dataService.updateOAuth2Application(dataAddApplication, self.CurrentClientData.Id).done(function () {\r\n                self.performSimpleGrid();\r\n                self.cancel(\"edit\");\r\n            });\r\n        } else {\r\n            $(\"#bz-oauth2-applications-error-time-invalid\").show();\r\n        }\r\n    },\r\n\r\n    //UPDATE ACTION\r\n    updateApplication: function () {\r\n        var self = this;\r\n        if (self.dataValidating('edit') === true) {\r\n            var appId = $(\"#biz-wp-oauth2-edit-id-input\").val();\r\n            var AllowedScope = \"\";\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-api-input\").is(':checked')) {\r\n                AllowedScope += \"api\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-login-input\").is(':checked')) {\r\n                AllowedScope += \" login\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-user-sync-input\").is(':checked')) {\r\n                AllowedScope += \" usersync\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-odata-query-input\").is(':checked')) {\r\n                AllowedScope += \" odataquery\";\r\n            }\r\n\r\n            var dataAddApplication = {};\r\n            dataAddApplication[\"authorization_grant_type\"] = self.editGrantType;\r\n            dataAddApplication[\"allowed_scope\"] = AllowedScope;\r\n            dataAddApplication[\"username_creator\"] = self.userFullName;\r\n            dataAddApplication[\"redirect_uri_strategy\"] = self.editRedirectUri;\r\n\r\n            if (self.editGrantType === \"client_credentials\") {\r\n                dataAddApplication[\"redirect_uri\"] = \"http://localhost--\";\r\n            }\r\n\r\n            var dataInputs = $(\"#formEditOAuthApp :input\").serializeArray();\r\n            for (var i = 0; i < dataInputs.length; i++) {\r\n                if (dataInputs[i].value) {\r\n                    if (dataInputs[i].name === \"redirect_uri_port\" && self.editRedirectUri === \"MobileLocalhostPort\") {\r\n                        dataAddApplication[\"redirect_uri\"] = \"http://localhost:\" + dataInputs[i].value;\r\n                    } else {\r\n                        dataAddApplication[dataInputs[i].name] = dataInputs[i].value;\r\n                    }\r\n\r\n                }\r\n            }\r\n\r\n            self.dataService.updateOAuth2Application(dataAddApplication, appId).done(function () {\r\n                self.performSimpleGrid();\r\n                self.cancel(\"edit\");\r\n            });\r\n        }\r\n    },\r\n\r\n    //UPDATE OAUTH CLIENT KEYS ACTION\r\n    updateApplicationKeys: function () {\r\n        var self = this;\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-oauth2-applications-update-keys-confirmation\"), \"Bizagi\", \"warning\")).done(function () {\r\n            var appId = $(\"#biz-wp-oauth2-edit-id-input\").val();\r\n            var params = {\r\n                client_id: self.CurrentClientData.ClientId,\r\n                client_secret: self.CurrentClientData.ClientSecret\r\n            };\r\n            self.dataService.updateClientSecretKeysOAuth2Application(params, appId).done(function (data) {\r\n                if (data.success) {\r\n                    self.performSimpleGrid();\r\n                    self.cancel(\"edit\");\r\n                } else {\r\n                    $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-oauth2-error-update-keys\"), null, 'warning')).done(function () {\r\n                        self.performSimpleGrid();\r\n                        self.cancel(\"edit\");\r\n                    });\r\n                }\r\n            }).fail(function (err) {\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-oauth2-error-update-keys\"), null, 'warning')).done(function () {\r\n                    self.performSimpleGrid();\r\n                    self.cancel(\"edit\");\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    //DELETE ACTION\r\n    deleteApplication: function (applicationId) {\r\n        var self = this;\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-grid-delete-confirmation\"), \"Bizagi\", \"warning\")).done(function () {\r\n            self.dataService.deleteOAuth2Application(applicationId).done(function (data) {\r\n                self.performSimpleGrid();\r\n            })\r\n        });\r\n    },\r\n\r\n    //CANCEL ACTION\r\n    cancel: function (type) {\r\n        var self = this;\r\n        if (type === \"add\") { $('#admin-oauth2-add-application').children().remove() }\r\n        if (type === \"edit\") { $('#admin-oauth2-edit-application').children().remove() }\r\n        $('#admin-oauth2-applications-wrapper').show();\r\n        self.cleanData();\r\n    },\r\n\r\n    //CLEAN DATA\r\n    cleanData: function () {\r\n        self.AllowedScope = null;\r\n        self.editAllowedScope = null;\r\n        self.userFullName = null;\r\n        self.grantType = null;\r\n        self.editGrantType = null;\r\n        self.RedirectUri = null;\r\n        self.editRedirectUri = null;\r\n        $(\".biz-wp-input-text\").val(\"\");\r\n        $(\".biz-wp-oauth2-select-control\").children().remove();\r\n        self.CurrentClientData = {};\r\n    },\r\n    destroy: function () {\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n* Name: BizAgi Desktop Widget Administration Policies - Vocabularies \r\n* \r\n* @author Christian Collazos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.vocabularies.extend(\"bizagi.workportal.widgets.admin.business.policies.vocabularies\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.vocabularies.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-vocabularies-wrapper\"),\r\n            \"admin.business.policies.vocabularies.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-vocabularies-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.vocabularies.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.vocabularies.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/**\r\n * Admin / Asynchronous Activities Console\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.async.activities\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.async.activities\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin module to case massively reassign\r\n * \r\n * @author David Nino, David Romero, Edward J Morales\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.cases.extend(\"bizagi.workportal.widgets.admin.cases\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.cases\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.cases\").concat(\"#ui-bizagi-workportal-widget-admin-cases\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Sets the maximun users to show at the user list form\r\n        self.userTableConf = { pageSize: 10 };\r\n\r\n        $.when(self.dataService.getOrganizationInfo(\"Skill\"),\r\n                self.dataService.getOrganizationInfo(\"Location\"),\r\n                self.dataService.getOrganizationInfo(\"Role\")).done(function (skill, location, role) {\r\n\r\n                    self.renderSearchCaseForm(role[0], skill[0], location[0]);\r\n\r\n                });\r\n    },\r\n    /*\r\n    * Process and display the Search Case form\r\n    * @param user {string}        User field string in the application's current language\r\n    * @param roles {string}      Roles field string in the application's current language \r\n    * @param locations {string}   Locations field string in the application's current language\r\n    */\r\n    renderSearchCaseForm: function (role, skill, location) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //Template Vars\r\n        var searchCasesTemplate = self.getTemplate(\"admin.search.cases\");\r\n\r\n        // Render Form\r\n        $.tmpl(searchCasesTemplate, {\r\n            skill: skill.profiles.length,\r\n            role: role.profiles.length,\r\n            location: location.profiles.length\r\n       }).appendTo($(\"#form-search-cases\", content));\r\n \r\n        if (skill.profiles.length){\r\n            self.skillInput = $(\"#skill-wrapper\", content);\r\n            self.skillInput.searchList({ list: skill.profiles, cases:[]});\r\n        }\r\n\r\n        if (role.profiles.length){\r\n            self.roleInput = $(\"#role-wrapper\", content);\r\n            self.roleInput.searchList({ list: role.profiles, cases:[]});\r\n        }\r\n\r\n        if(location.profiles.length){\r\n            self.locationInput = $(\"#location-wrapper\", content);\r\n            self.locationInput.searchList({ list: location.profiles, cases:[]});\r\n        }        \r\n        \r\n        //Keeps the reference of the seach case form\r\n        self.searchCasesForm = $(\".admin-form-search-cases\", content);\r\n\r\n        self.searchCaseFormEventHandler();\r\n    },\r\n    /*\r\n    * Process and display the Search User form\r\n    * @param totalCases {Number}    Number of cases wich fits with the case seach parameters\r\n    */\r\n    renderSearchUserForm: function (totalCases) {\r\n\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //Template Vars\r\n        var searchUserTemplate = self.getTemplate(\"admin.search.users\");\r\n\r\n        // Render Form\r\n        $.tmpl(searchUserTemplate).appendTo($(\"#form-search-users\", content));\r\n\r\n        $(\"#cases-found-message-wrapper .message\", content).text(printf(self.resources.getResource(\"workportal-widget-admincase-casesfound\"), totalCases));\r\n\r\n        self.eventHandlerSearchUserForm();\r\n    },\r\n    /*\r\n    * Show/Hide the Seach Case Form\r\n    * @param value {Boolean}    If is true, show the seach case form, otherwise, hide it\r\n    */\r\n    showSearchCaseForm: function (value) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if (value) {\r\n            $(\"#form-search-cases\", content).show();\r\n            self.searchCasesForm.show();\r\n        }\r\n        else {\r\n            $(\"#form-search-cases\", content).hide();\r\n        }\r\n    },\r\n    /*\r\n    * Show/Hide the Seach User Form\r\n    * @param value {Boolean}    If is true, show the seach user form, otherwise, hide it\r\n    */\r\n    showSearchUsersForm: function (value) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        if (value)\r\n            self.renderSearchUserForm();\r\n        else\r\n            $(\"#form-search-users\", content).html(\"\");\r\n    },\r\n    /*\r\n    * Add the required listeners for the button elements inside the Seach user Form\r\n    */\r\n    eventHandlerSearchUserForm: function () {\r\n\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //Search user Form\r\n        $(\"#search-user\", content).bind('click', function (e) {\r\n            e.preventDefault();\r\n            var searchForm = $(\"#admin-form-search-users-wrapper\", content);\r\n\r\n            self.showConfirmAssignCasesForm(false);\r\n\r\n            var params = {};\r\n\r\n            params['userName'] = $(\"#txtSAMAccount\", searchForm).val();\r\n            params['fullname'] = $(\"#txtFullName\", searchForm).val();\r\n            params['domain'] = $(\"#txtDomain\", searchForm).val();\r\n\r\n            params['skills'] = $(\"#skill\", content).val();\r\n            params['locations'] = $(\"#location\", content).val();\r\n            params['roles'] = $(\"#role\", content).val();\r\n\r\n\r\n            self.showLoaderAtContainer($(\"#user-list-wrapper\"));\r\n\r\n            $.when(self.dataService.searchUsers(params)).done(function (result) {\r\n                self.closeLoader();\r\n\r\n                self.updateTotalUsersForm(result);\r\n            });\r\n        });\r\n\r\n        $(\"#back-search-case-form\", content).bind('click', function (e) {\r\n            e.preventDefault();\r\n\r\n            self.showSearchUsersForm(false);\r\n\r\n            self.showSearchCaseForm(true);\r\n        });\r\n\r\n\r\n        $(\"#confirm-assign-cases\", content).bind('click', function (e) {\r\n            e.preventDefault();\r\n\r\n            var searchForm = $(\"#admin-form-search-users-wrapper\", content);\r\n            var params = {};\r\n\r\n            //Gets the selected element\r\n            var selectedElement = $('#user-list-wrapper .user-list-item label', searchForm).filter('.ui-radio-state-checked').parent();\r\n            var userList = [];\r\n            var i = selectedElement.length;\r\n\r\n            while(i-- > 0)\r\n            {\r\n                userList.push(Number($('input', selectedElement[i]).val()));\r\n            }\r\n\r\n            \r\n            //params['user'] = $('input', selectedElement).val();\r\n\r\n            params['user'] = userList;\r\n\r\n            params['skills'] = self.getCasesSearchParams().skills;\r\n            params['locations'] = self.getCasesSearchParams().locations;\r\n            params['roles'] = self.getCasesSearchParams().roles;\r\n\r\n            $.when(self.dataService.reassignCases(params)).done(function (response) {\r\n                self.showConfirmAssignCasesMessage(true);\r\n            }).fail(function (error) {\r\n                //self.notificationController.showErrorMessage(error);\r\n            });\r\n        });\r\n\r\n        $(\"#cancel-assign-cases\", content).bind('click', function (e) {\r\n            e.preventDefault();\r\n\r\n            self.showConfirmAssignCasesForm(false);\r\n        });\r\n\r\n    },\r\n    /*\r\n    * Add the required listeners for the button elements inside the Seach Case Form\r\n    */\r\n    searchCaseFormEventHandler: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        $(\"li[name=role], li[name=skill], li[name=location]\", content).bind('click', function () {\r\n            var span = $(this).find('span.ui-icon');\r\n\r\n            (span.attr('data-state') == 'uncheck') ? span.attr('data-state', 'check') : span.attr('data-state', 'uncheck');\r\n        });\r\n\r\n        //Events for search case form\r\n        $(\"#search-case\", content).bind('click', function (e) {\r\n\r\n            e.preventDefault();\r\n            \r\n            var skillList = (self.skillInput)?  self.skillInput.searchList(\"option\", 'cases'): [];\r\n            var roleList = (self.roleInput)?  self.roleInput.searchList(\"option\", 'cases'): [];\r\n            var locationList = (self.locationInput)?  self.locationInput.searchList(\"option\", 'cases'): [];\r\n            \r\n            var params = { skills: skillList, locations: locationList, roles: roleList };\r\n\r\n            self.searchCasesForm.hide();\r\n\r\n            self.showLoaderAtContainer(self.searchCasesForm);\r\n\r\n            $.when(self.dataService.getCasesByOrganization(params)).done(function (result) {\r\n\r\n                //Removes the loader wherever it's located\r\n                self.closeLoader();\r\n\r\n                self.updateTotalCasesFound(params, result);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Add the loader in the desired container\r\n    */\r\n    //showLoaderAtContainer: function (container, nextChild) {\r\n    showLoaderAtContainer: function (nextChild) {\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n\r\n        nextChild.after(self.dialogBox);\r\n    },\r\n    /*\r\n    *   Removes the Loader wherever is located\r\n    */\r\n    closeLoader: function () {\r\n        self.dialogBox.remove();\r\n    },\r\n    /*\r\n    *   Stores the Case Search Parameters. It will used when the user confirms the massive case assign\r\n    */\r\n    setCasesSearchParams: function (params) {\r\n        this.caseSearchParams = params;\r\n    },\r\n    /*\r\n    *   Retrieve the Case Search Parameters. It will used when the user confirms the massive case assign\r\n    */\r\n    getCasesSearchParams: function (params) {\r\n        return this.caseSearchParams;\r\n    },\r\n    /*\r\n    * Validate the results of the case search parameters. If the total cases is more than 1, it will shows\r\n    * the Search User Form, otherwise, It will display a message  awaring the user that there is not cases wich\r\n    * fits with the cases seach parameters\r\n    * @param params {Object}    Case seach parameters\r\n    * @param result {Object}    Search case response, wich includes the total cases wich fits with the seach parameters\r\n    */\r\n    updateTotalCasesFound: function (params, result) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //DOM Variables\r\n        var casesFoundMessageWrapper = $(\"#no-cases-found-message-wrapper\", content);\r\n\r\n        //Bind the submited data\r\n        self.setCasesSearchParams(params);\r\n\r\n        if (result.totalCases > 0) {\r\n            casesFoundMessageWrapper.hide();\r\n\r\n            self.showSearchCaseForm(false);\r\n            self.renderSearchUserForm(result.totalCases);\r\n        }\r\n        else {\r\n            self.showSearchCaseForm(true);\r\n            casesFoundMessageWrapper.show();\r\n        }\r\n    },\r\n    /*\r\n    * Validate the results of the case search parameters. If the total cases is more than 1, it will shows\r\n    * the Search User Form, otherwise, It will display a message  awaring the user that there is not cases wich\r\n    * fits with the cases seach parameters\r\n    * @param result {Object}    Search case response, wich includes the total cases wich fits with the seach parameters\r\n    */\r\n    updateTotalUsersForm: function (result) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //DOM Variables\r\n        var userFoundMessageWrapper = $(\"#no-users-found-message-wrapper\", content);\r\n\r\n        if (result.users.length > 0) {\r\n            userFoundMessageWrapper.hide();\r\n\r\n            self.userList = { data: result.users };\r\n            self.createPage(1);\r\n        }\r\n        else {\r\n            userFoundMessageWrapper.show();\r\n        }\r\n\r\n    },\r\n    /*\r\n    * Create the page for the users searh result\r\n    * @param pageNumber {Number}    Desired page to display\r\n    */\r\n    createPage: function (pageNumber) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //DOM Variables\r\n        var tableContent = $(\"#user-list-wrapper\", content);\r\n\r\n        //Template vars\r\n        var tableUserTemplate = self.getTemplate(\"admin.table.users\"),\r\n                pagesLength = Math.ceil(self.userList.data.length / self.userTableConf.pageSize),\r\n                pages = new Array(pagesLength);\r\n\r\n\r\n        var users = [],\r\n                i = self.userTableConf.pageSize * (pageNumber - 1),\r\n                resultLength;\r\n\r\n        //Calculates the remaining elements to paint\r\n        if (self.userTableConf.pageSize + i <= self.userList.data.length) {\r\n            resultLength = self.userTableConf.pageSize;\r\n        }\r\n        else {\r\n            resultLength = self.userList.data.length - i;\r\n        }\r\n\r\n        $('.user-list-item', tableContent).remove();\r\n\r\n        resultLength += i;\r\n\r\n        //Hack for jquery tmpl\r\n        for (var x = 0; x < pagesLength; x++) {\r\n            pages[x] = x + 1;\r\n        }\r\n\r\n        //Creates an exact copy, and splice it to paint the desired elements\r\n        users = [].concat(self.userList.data)\r\n        users = users.splice(i, resultLength);\r\n\r\n        var tableUsers = $.tmpl(tableUserTemplate, {\r\n            users: users,\r\n            pages: pages\r\n        });\r\n\r\n        tableContent.html(tableUsers);\r\n\r\n        //Binds the elements event\r\n        self.tableUsersHandlers();\r\n\r\n        //Update the pager \r\n        self.updateTableUsersPager(pageNumber);\r\n\r\n        $(\"ul\").bizagiPagination({\r\n            maxElemShow: 10,\r\n            totalPages: pagesLength,\r\n            actualPage: pageNumber,\r\n            listElement: $(\"#user-list-footer-wrapper\", content),\r\n            clickCallBack: function (options) {\r\n                self.createPage(options.page);\r\n                self.showConfirmAssignCasesForm(false);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    * Add the required handlers for the elements inside the user list\r\n    *\r\n    */\r\n    tableUsersHandlers: function () {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //DOM Variables\r\n        var userListWrapper = $('#user-list-wrapper', content);\r\n\r\n        $('.user-list-item', userListWrapper).click(function (ev) {\r\n\r\n            //Toggle the select class\r\n            $('label', this).toggleClass('ui-radio-state-checked');\r\n\r\n            //Checks if there is any element selecteced, to show the confirmation message\r\n            var anyElementSelected =  $('.ui-radio label', userListWrapper).filter('.ui-radio-state-checked').length > 0;\r\n\r\n            self.showConfirmAssignCasesForm(anyElementSelected);\r\n\r\n            self.showConfirmAssignCasesMessage(!anyElementSelected);\r\n\r\n        });\r\n\r\n\r\n        $('.user-list-item', userListWrapper).hover(\r\n            function () {\r\n                if (!$(this).attr(\"data-value\"))\r\n                    $('label', this).addClass('ui-radio-state-hover');\r\n            },\r\n            function () {\r\n                //if is not the current selected, removes the selected state\r\n                if (!$(this).attr(\"data-value\"))\r\n                    $('label', this).removeClass('ui-radio-state-hover');\r\n            }\r\n        );\r\n\r\n\r\n        // Add class to each even row\r\n        $('tbody tr', userListWrapper).each(function () {\r\n            if ($(this).index() % 2 < 1)\r\n                $(this).addClass('biz-ui-even');\r\n        });\r\n\r\n        //Event for Pages\r\n        /* $('#user-list-footer-wrapper span', userListWrapper).click(function(e) {\r\n        if (!$(this).hasClass('current-page'))\r\n        {\r\n        self.createPage($(this).data('value'));\r\n\r\n        self.showConfirmAssignCasesForm(false);\r\n        }\r\n        });*/\r\n    },\r\n    /*\r\n    * Highlight the current page of the user list\r\n    * @param params {Number}    Desired page to display\r\n    */\r\n    updateTableUsersPager: function (pageIndex) {\r\n        var self = this,\r\n                content = self.getContent(),\r\n                userTable = $('#table', content);\r\n\r\n        $('#user-list span[data-value=' + pageIndex + ']', userTable).addClass('current-page');\r\n    },\r\n    /*\r\n    * Show/Hide the confirm assign cases form\r\n    * @param value {Boolean}    if is true, display the form, otherwise, hide it\r\n    */\r\n    showConfirmAssignCasesForm: function (value) {\r\n        var self = this, content = self.getContent();\r\n\r\n        if (value) {\r\n            $('#assing-cases-confirm-form-wrappper', content).show();\r\n        }\r\n        else {\r\n            $('#assing-cases-confirm-form-wrappper', content).hide();\r\n        }\r\n    },\r\n    /*\r\n    * Show/Hide the confirm assign message, and show/hide the assign cases confirm form\r\n    * @param value {Boolean}    if is true, display the form, otherwise, hide it\r\n    */\r\n    showConfirmAssignCasesMessage: function (value) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        if (value) {\r\n            $('#assing-cases-confirm-form', content).hide();\r\n            $('#assign-cases-message-wrapper', content).show();\r\n\r\n        }\r\n        else {\r\n            $('#assing-cases-confirm-form', content).show();\r\n            $('#assign-cases-message-wrapper', content).hide();\r\n        }\r\n\r\n        $(\"#users-found-message-wrapper\", content).hide();\r\n    }\r\n});\r\n","/**\r\n * Name: BizAgi Desktop Widget Administration Cases Implementation\r\n *\r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.caseSearch.extend(\"bizagi.workportal.widgets.admin.caseSearch\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.adhocIds = [];\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.selectedCaseAdmin = [];\r\n        self.selectedWorkItemAdmin = [];\r\n\r\n        self.columnsID = {\r\n            \"caseNumber\": \"I_radNumber\",\r\n            \"process\": \"I_wfClsDisplayName\",\r\n            \"task\": \"I_tskDisplayName\",\r\n            \"processCreationDate\": \"I_casCreationDate\",\r\n            \"taskDueDate\": \"I_wiEstimatedSolutionDate\",\r\n            \"processDueDate\": \"I_casSolutionDate\",\r\n            \"userName\": \"I_userName\",\r\n            \"userfullName\": \"I_fullName\",\r\n            \"userLocation\": \"I_locName\"\r\n        };\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.case.search\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search\"),\r\n            \"admin.case.search.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-fields\"),\r\n            \"admin.case.search.button\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-buttons\"),\r\n            \"admin.case.search.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-result\"),\r\n            \"admin.case.search.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-pagination\"),\r\n            \"admin.case.search.invalidate\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-invalidate\"),\r\n            \"admin.case.search.reassign\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-reassign\"),\r\n            \"admin.case.search.reassign.form\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-reassign-form\"),\r\n            \"admin.case.search.action.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-action-result\"),\r\n            \"admin.case.search.loader\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-loader\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        //Template vars \r\n        self.generalContentTmpl = self.getTemplate(\"admin.case.search\");\r\n        self.fieldsContentTmpl = self.getTemplate(\"admin.case.search.fields\");\r\n        self.buttonContentTmpl = self.getTemplate(\"admin.case.search.button\");\r\n        self.resultContentTmpl = self.getTemplate(\"admin.case.search.result\");\r\n        self.paginationTmpl = self.getTemplate(\"admin.case.search.pagination\");\r\n        self.invalidateContentTmpl = self.getTemplate(\"admin.case.search.invalidate\");\r\n        self.reassignContentTmpl = self.getTemplate(\"admin.case.search.reassign\");\r\n        self.reassignFormTmpl = self.getTemplate(\"admin.case.search.reassign.form\");\r\n        self.actionResultContentTmpl = self.getTemplate(\"admin.case.search.action.result\");\r\n        self.loaderTmpl = self.getTemplate(\"admin.case.search.loader\");\r\n        self.loader = $.tmpl(self.loaderTmpl, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.defaultMaxRows = 10;\r\n        self.maxElemShow = self.defaultMaxRows;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.processNavigation = [];\r\n        self.setupData();\r\n    },\r\n\r\n    /**\r\n     * show the Nofitication for succesful request\r\n     */\r\n    showNotifier: function () {\r\n        var notifier = window.parent.bizagi.injector.get('notifier');\r\n        notifier.showSucessMessage(bizagi.localization.getResource('workportal-widget-admincasesearch-invalidation-message'), '');\r\n    },\r\n\r\n    /**\r\n     * show the Nofitication for succesful request\r\n     */\r\n    showConfirmationMessage: function () {\r\n        var self = this;\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource('workportal-widget-admincasesearch-action-invalidation-confirmation'), bizagi.localization.getResource(\"workportal-general-word-information\"), 'info')).done(function () {\r\n            self.showLoading();\r\n            self.invalidateSelectedCase(self.paramsToInvalidateSelectedCases());\r\n        });\r\n    },\r\n    /*\r\n     * Init the Current User Position combo box\r\n     */\r\n    initPositionsCombo: function () {\r\n        var self = this;\r\n        $.when(self.dataService.getUserPositions()).done(function (resultList) {\r\n            var comboDataSource = {\r\n                combo: [],\r\n                id: \"positions\"\r\n            };\r\n            comboDataSource.combo.push({\r\n                id: '',\r\n                name: '.........'\r\n            });\r\n            $.each(resultList.positions, function (index, value) {\r\n                comboDataSource.combo.push({\r\n                    id: value.idPosition,\r\n                    name: value.displayName\r\n                });\r\n            });\r\n            self.renderPositionsCombo(comboDataSource);\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Render the Current User Position combo box\r\n     */\r\n    renderPositionsCombo: function (comboDataSource) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var deferred = $.Deferred();\r\n        var comboWrapper = $(\"#userPositionInput\", content);\r\n        comboWrapper.empty();\r\n        //$(\"#userPositionInput\", content).val(comboDataSource.combo[0].id);\r\n        comboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.name;\r\n            },\r\n            onComplete: function () {\r\n                deferred.resolve();\r\n            },\r\n            onChange: function (obj) {\r\n                var value = obj.ui.data('value');\r\n                $(\"#userPositionInput\", content).val(value);\r\n            },\r\n            initValue: comboDataSource.combo[0]\r\n        });\r\n        return deferred;\r\n    },\r\n\r\n\r\n    /*\r\n     * Setup form data\r\n     */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n        self.setupDatePicker();\r\n        self.setupProcessTree();\r\n        self.setupCaseSecurity();\r\n        self.setupMainButtons();\r\n        self.initPositionsCombo();\r\n\r\n    },\r\n\r\n    /*\r\n     * Load form data\r\n     */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            fields;\r\n\r\n        //set self variables to default\r\n        self.buttonBackAction = \"backToMainForm\";\r\n        self.selectedUserId = \"\";\r\n        self.selectedUserName = \"\";\r\n        self.selectedTasks = \"\";\r\n        self.selectedTasksToShow = \"\";\r\n        self.searchParams = \"\";\r\n        self.processTree = \"\";\r\n        self.processTreeDelete = \"\";\r\n        self.caseSecurity = \"\";\r\n\r\n        //set content form to default\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-subtitle\"));\r\n        $(\"#mainForm\", content).remove();\r\n        $(\"#dinamicContent\", content).remove();\r\n        $(\"#case-search-log-data-buttonset\", content).remove();\r\n\r\n        //append fields to wrapper\r\n        fields = $.tmpl(self.fieldsContentTmpl, {});\r\n\r\n        content.html(fields);\r\n        $(\"#cases-tabs\", content).tabs({\r\n            activate: function(event, ui){\r\n                if (ui.newTab[0].id === \"deleteCasesTab\") {\r\n                    self.isOut = false;\r\n                    self.showLoading();\r\n                    var isRunnig = self.getProcessRunningInvalidateCases();\r\n                    if (isRunnig) {\r\n                        $(\"#tree\", content).hide();\r\n                        $(\"#invalidateMessage\", content).show();\r\n                    }\r\n                }else {\r\n                    clearTimeout(self.timer);\r\n                    self.isOut = true;\r\n                }\r\n            }\r\n        });\r\n        var casesTabs = $(\"#cases-tabs-ul\", content);\r\n        $(\"#li-deleteCases\", casesTabs).click(function () {\r\n            $(\"#case-search-log-data-buttonset\", content).hide();\r\n        });\r\n        $(\"#li-case-search\", casesTabs).click(function () {\r\n            $(\"#case-search-log-data-buttonset\", content).show();\r\n        });\r\n\r\n        if (bizagiConfig.isProduction) {\r\n            $(\"#deleteCases\", content).remove();\r\n            $(\"#deleteCasesTab\", content).remove();\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Load dateTime plugin and apply to respective fields\r\n     */\r\n    setupDatePicker: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var formatDate = bizagi.localization.getResource('dateFormat').replaceAll(\"yyyy\", \"yy\").replaceAll(\"MM\", \"mm\");\r\n\r\n        $(\".biz-wp-form-datepicker\", content).datepicker({\r\n            controlType: 'select',\r\n            dateFormat: formatDate\r\n        });\r\n    },\r\n\r\n    /*\r\n     * initialize the process tree widget\r\n     */\r\n    setupProcessTree: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        bizagi.treeRoutSelected = [];\r\n        $(\"#treeLinksId\").remove();\r\n        var processtreeParams = $.extend({}, self.params);\r\n        processtreeParams.svgIconsMode = true;\r\n        processtreeParams.canvas = $(\"#processTree\", content);\r\n        self.processTree = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, processtreeParams);\r\n        self.processTree.render().done(function () {\r\n            var processtreeParams = $.extend({}, self.params);\r\n            processtreeParams.canvas = $(\"#processTreeDelete\", content);\r\n            processtreeParams.svgIconsMode = true;\r\n            processtreeParams.searchKeyResource = \"workportal-widget-admincasesearch-cancel-cases-for\";\r\n            processtreeParams.newDesign = true;\r\n            //tree for delete cases\r\n            self.processTreeDelete = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, processtreeParams);\r\n            self.processTreeDelete.render();\r\n        });\r\n    },\r\n\r\n     /*\r\n     * initialize the case Security\r\n     */\r\n    setupCaseSecurity: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#treeLinksId\").remove();\r\n        var caseSecurityParams = $.extend({}, self.params);\r\n        caseSecurityParams.content = $(\"#caseSecurity\", content);\r\n        self.caseSecurity = new bizagi.workportal.widgets.admin.transfer.case.security.permissions(self.workportalFacade, self.dataService, caseSecurityParams);\r\n         self.caseSecurity.render();\r\n    },\r\n\r\n    /*\r\n     * initialize the users search form widget\r\n     */\r\n    setupUsersSearchForm: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            def = $.Deferred();\r\n\r\n        $(\"#biz-wp-users-table-form\").html(\"\");\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#biz-wp-users-table-form\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign\")],\r\n            parentDef: def\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            self.assignEventReassignLinks(userId, userName);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Find cases results using the input data\r\n     */\r\n    findResults: function (content, params, pageToShow) {\r\n        var self = this;\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.Page = pageToShow : params.Page = 1;\r\n\r\n        $.when(self.dataService.getAdminCasesList(params)).done(function (resultList) {\r\n            $(resultList.rows).each(function (key, value) {\r\n                if (!value.isAdhocProcess) value.isAdhocProcess = false;\r\n                if (value.isAdhocProcess) {\r\n                    self.adhocIds.push({ \r\n                            'caseId': value.idCase, \r\n                            'processId': value.idAdhocProcess \r\n                        });\r\n                }\r\n            });\r\n            //clean old results\r\n            $(\"#generalTitle\").show();\r\n            $(\".biz-wp-table\").remove();\r\n            $(\".case-search-action-wrapper\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n\r\n            if (resultList.rows.length > 0) {\r\n\r\n                self.showCasesSearchResultFrame(content, resultList);\r\n                self.setupActionsButton(content);\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n                var summaryWrapper = $(\"#biz-wp-table-pager-wrapper\"),\r\n                    pagerData = {},\r\n                    paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginationTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\"#biz-wp-table-pager-wrapper\"),\r\n                    clickCallBack: function (options) {\r\n                        self.findResults(content, params, options.page);\r\n                    }\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-authentication-log-none\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            }\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Show cases search result frames\r\n     */\r\n    showCasesSearchResultFrame: function (content, resultList) {\r\n        var self = this;\r\n\r\n        var disableInvalidate = bizagi.override.disableAbortCases ? true : false;\r\n\r\n        var processedItems = self.preprocessResultList(resultList.headers, resultList);\r\n        var resultTemplate = $.tmpl(self.resultContentTmpl, {\r\n            headers: resultList.headers,\r\n            rows: processedItems,\r\n            groupByCaseNumber: bizagiConfig.groupByCaseNumber,\r\n            securityGraphicQuery: bizagi.menuSecurity.GraphicQuery,\r\n            resultList: resultList\r\n        }, {\r\n                getRadNumberColumnIndex: function () {\r\n                    var data = this.data;\r\n                    var index = -1;\r\n                    for (var i = 0, l = data.headers.length; i < l; i++) {\r\n                        if (data.headers[i].fieldName == \"I_radNumber\") {\r\n                            index = i;\r\n                        }\r\n                    }\r\n                    return index;\r\n                },\r\n                showColumn: function (columnIndex) {\r\n                    var index = this.getRadNumberColumnIndex();\r\n                    return (this.data.groupByCaseNumber && index == columnIndex) ? ' hidden ' : \"\";\r\n                },\r\n                createGroupedHeader: function (rowIndex) {\r\n                    var data = this.data.resultList;\r\n                    var result = false;\r\n                    var radNumber = this.getRadNumber(data.rows[rowIndex]);\r\n                    if (this.data.groupByCaseNumber) {\r\n                        if (rowIndex == 0) {\r\n                            result = true;\r\n                        } else {\r\n                            var previousRadNumber = this.getRadNumber(data.rows[rowIndex - 1]);\r\n                            if (radNumber != previousRadNumber) {\r\n                                result = true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return result;\r\n                },\r\n                getRadNumber: function (row) {\r\n                    var index = this.getRadNumberColumnIndex();\r\n                    return (index >= 0) ? row.data[index] : \"\";\r\n                }\r\n            }),\r\n            invalidateForm = $.tmpl(self.invalidateContentTmpl, {}),\r\n            reassignForm = $.tmpl(self.reassignContentTmpl, {});\r\n\r\n        $(\"#mainForm\", content).hide();\r\n        $(\"#dinamicContent\", content).html(resultTemplate);\r\n\r\n        if (!disableInvalidate) {\r\n            $(\".case-search-action-wrapper\", content).append(invalidateForm);\r\n        }\r\n        $(\".case-search-action-wrapper\", content).append(reassignForm);\r\n\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-table-title\"));\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"inline\");\r\n\r\n        self.setupActivitiesLink(content);\r\n        self.setupGraphicQueryEvent(content);\r\n        self.selectedItemsPersistence(content);\r\n    },\r\n\r\n    selectedItemsPersistence: function (content) {\r\n        var self = this;\r\n        var item = \"\";\r\n\r\n        $.each(self.selectedCaseAdmin, function (index, value) {\r\n            item = \"input:checkbox[name=CaseAdmin][value=\" + value + \"]\";\r\n            $(item, content).prop(\"checked\", true);\r\n        });\r\n\r\n        $.each(self.selectedWorkItemAdmin, function (index, value) {\r\n            item = \"input:checkbox[name=workItemAdmin][value='\" + value + \"']\";\r\n            $(item, content).prop(\"checked\", true);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    preprocessResultList: function (headers, resultList) {\r\n        var self = this;\r\n\r\n        var processedItems = [],\r\n            length = resultList.rows.length,\r\n            i = 0;\r\n\r\n        for (; i < length; i++) {\r\n            processedItems.push(self.processResultItem(headers, resultList.rows[i]));\r\n        }\r\n\r\n        return processedItems;\r\n    },\r\n\r\n    /*\r\n     * Process each result item\r\n     */\r\n    processResultItem: function (headers, rowItem) {\r\n        var self = this;\r\n\r\n        var rowItemData = rowItem.data,\r\n            idCase = rowItem.idCase,\r\n            idWorkflow = rowItem.idWorkFlow,\r\n            radNumber = rowItem.radNumber,\r\n            idParentCase = rowItem.idParentCase,\r\n            isSubProcess = rowItem.isSubprocess;\r\n\r\n        var resultArray = [],\r\n            firstRowItem = [];\r\n\r\n        //Handle the task elements\r\n        var taskElements,\r\n            taskElementsLength;\r\n\r\n        var currentTaskObj;\r\n\r\n        var taskColumnIndex = [],\r\n            taskColumnIndexLength;\r\n\r\n        var j = -1,\r\n            columnIndex = 0;\r\n\r\n        var resultTaskArray = false;\r\n\r\n        firstRowItem.push({\r\n            id: \"checkCaseAdmin\",\r\n            value: idCase,\r\n            radNumber: radNumber,\r\n            idParentCase: idParentCase,\r\n            isSubProcess: isSubProcess\r\n        });\r\n\r\n        while (j++ < headers.length - 1) {\r\n\r\n            switch (headers[j].fieldName) {\r\n                case self.columnsID.caseNumber:\r\n                    //Insert case number\r\n                    firstRowItem.push({\r\n                        id: \"caseNumber\",\r\n                        value: {\r\n                            'idCase': idCase,\r\n                            'caseNumber': rowItemData[columnIndex]\r\n                        }\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.process:\r\n                    //Insert process name\r\n                    firstRowItem.push({\r\n                        id: \"idWorkItem\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.userName:\r\n                case self.columnsID.userfullName:\r\n                case self.columnsID.task:\r\n                case self.columnsID.taskDueDate:\r\n\r\n                    //Gets the row elements if is not already assigned to taskElements array\r\n                    if (taskElements === undefined) {\r\n                        var k = rowItemData.length;\r\n                        while (k-- > 0) {\r\n                            if (Array.isArray(rowItemData[k])) {\r\n                                taskElements = rowItemData[k];\r\n\r\n                                //Notifies the existence of the array of task elements\r\n                                resultTaskArray = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                        columnIndex++;\r\n                    }\r\n\r\n                    //set the current task obj\r\n                    if (resultTaskArray) {\r\n\r\n                        currentTaskObj = taskElements[0];\r\n\r\n                        if (self.columnsID.userName == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObjectUser(currentTaskObj));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.userName) == -1) {\r\n                                taskColumnIndex.push(self.columnsID.userName);\r\n                                //columnIndex++;\r\n                            }\r\n                        } else if (self.columnsID.userfullName == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObjectUser(currentTaskObj));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.userfullName) == -1) {\r\n                                taskColumnIndex.push(self.columnsID.userfullName);\r\n                                //columnIndex++;\r\n                            }\r\n                        } else if (self.columnsID.task == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObject(currentTaskObj, idCase));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.task) == -1) {\r\n                                taskColumnIndex.push(self.columnsID.task);\r\n                                //columnIndex++;\r\n                            }\r\n                        } else if (self.columnsID.taskDueDate == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObjectDate(currentTaskObj));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.taskDueDate) == -1) {\r\n\r\n                                //Removes the unecessary due date\r\n                                /*if (headers[j].fieldName == self.columnsID.taskDueDate) {\r\n                                    rowItemData.splice(columnIndex, 1);\r\n                                }*/\r\n\r\n                                taskColumnIndex.push(self.columnsID.taskDueDate);\r\n                                //columnIndex++;\r\n                            }\r\n                        }\r\n                        //TODO : userLocation logic in case its come inside the task array\r\n                    } else {\r\n                        if (headers[j].fieldName == self.columnsID.taskDueDate) {\r\n                            //inserts the estimated Solution date in a object\r\n                            firstRowItem = firstRowItem.concat({\r\n                                'estimatedSolutionDate': rowItemData[j]\r\n                            });\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.taskDueDate) == -1)\r\n                                taskColumnIndex.push(self.columnsID.taskDueDate);\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n                //TODO : create case logic for single element, or create the required logic whe userLocation comes in the task list array            \r\n                /*\r\n                 case self.columnsID.userLocation:\r\n                 break;\r\n                 /**/\r\n\r\n\r\n                case self.columnsID.processCreationDate:\r\n                    //Creation Date\r\n                    firstRowItem.push({\r\n                        id: \"processCreationDate\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.processDueDate:\r\n                    //Task Due Date\r\n                    firstRowItem.push({\r\n                        id: \"processDueDate\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                default:\r\n\r\n                    var resultValue = bizagi.util.formatValueByDataType(rowItemData[columnIndex], headers[j].type);\r\n\r\n                    firstRowItem.push({\r\n                        id: \"customField\",\r\n                        value: resultValue\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n            }\r\n        }\r\n        \r\n\r\n        //Inserts view Process Column\r\n        firstRowItem.push({\r\n            id: \"viewProcess\",\r\n            value: {\r\n                'idCase': idCase,\r\n                'idworkflow': idWorkflow\r\n            }\r\n        });\r\n\r\n        //Insert the first row element\r\n        resultArray.push({\r\n            attr: \"first_row\",\r\n            data: firstRowItem\r\n        });\r\n\r\n        taskElementsLength = taskElements ? taskElements.length : 0;\r\n\r\n        //If there is more task, add the remaining rows\r\n        if (taskElementsLength > 1) {\r\n            taskColumnIndexLength = taskColumnIndex.length;\r\n            for (var i = 1; i < taskElementsLength; i++) {\r\n\r\n                var taskData = [],\r\n                    k = -1;\r\n                //Adds the elements in the right order as the columns are\r\n\r\n                while (k++ < taskColumnIndexLength - 1) {\r\n                    if (taskColumnIndex[k] == self.columnsID.task)\r\n                        taskData.push(self.processTaskObject(taskElements[i], idCase));\r\n                    else if (taskColumnIndex[k] == self.columnsID.taskDueDate)\r\n                        taskData.push(self.processTaskObjectDate(taskElements[i]));\r\n                    else if (taskColumnIndex[k] == self.columnsID.userName)\r\n                        taskData.push(self.processTaskObjectUser(taskElements[i]));\r\n                    else if (taskColumnIndex[k] == self.columnsID.userfullName)\r\n                        taskData.push(self.processTaskObjectUser(taskElements[i]));\r\n                }\r\n\r\n                resultArray.push({\r\n                    attr: \"next_row\",\r\n                    data: taskData\r\n                });\r\n            }\r\n        }\r\n\r\n        return {\r\n            data: resultArray,\r\n            totalTask: taskElementsLength\r\n        };\r\n    },\r\n\r\n    /*\r\n     *   Process each task object\r\n     */\r\n    processTaskObject: function (taskObject, idCase) {\r\n        var obj = {\r\n            'taskName': taskObject.taskName,\r\n            'colorState': taskObject.colorState,\r\n            'taskType': taskObject.taskType,\r\n            'idCase': idCase,\r\n            'idWorkItem': taskObject.idWorkItem,\r\n            'idTask': taskObject.idTask\r\n        };\r\n        taskObject.taskType === \"Wait\" ? obj.skip = true : \"\";\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n     * Process task object detecting if is has or not estimated solution date\r\n     */\r\n    processTaskObjectDate: function (taskObject) {\r\n        var obj = {};\r\n        (taskObject.estimatedSolutionDate) ? obj.estimatedSolutionDate = taskObject.estimatedSolutionDate : obj.estimatedSolutionDate = \"\";\r\n        taskObject.taskType === \"Wait\" ? obj.skip = true : \"\";\r\n\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n     * Process task object detecting if is has or not estimated solution date\r\n     */\r\n    processTaskObjectUser: function (taskObject) {\r\n        var obj = {};\r\n        (taskObject.assignee) ? obj.userName = taskObject.assignee : obj.userName = \"\";\r\n\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n     * Invalidate selected cases\r\n     */\r\n    invalidateCases: function (content) {\r\n        var self = this;\r\n        var parentCases = \"\";\r\n        var messageConfirmation = \"\";\r\n        var selectedCases = {\r\n            cases: []\r\n        };\r\n\r\n        $(\"input:checkbox[name=CaseAdmin]:checked\", content).each(function () {\r\n            var val = $(this).val();\r\n\r\n            if ($(this).data(\"subprocess\")) {\r\n                parentCases = parentCases + \" \" + $(this).data(\"parentcase\") + \",\";\r\n            }\r\n            selectedCases.cases.push({\r\n                idCase: val\r\n            });\r\n        });\r\n\r\n        if (selectedCases.cases.length == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-empty-msg\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        } else {\r\n\r\n            messageConfirmation = (bizagi.util.isEmpty(parentCases)) ? bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-confirm-msg\") : bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-subprocess-confirm-msg\") + parentCases.substring(0, (parentCases.length - 1));\r\n            var customOptions = {\r\n                dialogClass: \"widget-admincasesearch-invalidate-cases-confirm\",\r\n                width: 400,\r\n                minWidth: 400\r\n            };\r\n            $.when(bizagi.showConfirmationBox(messageConfirmation, bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\", null, customOptions))\r\n                .done(function () {\r\n                    var reason = $(\"#txtReason\", content).val();\r\n                    var params = {\r\n                        action: \"abort\",\r\n                        cases: JSON.stringify(selectedCases),\r\n                        reason: reason\r\n                    };\r\n\r\n                    $.when(self.dataService.abortReassignItems(params)).done(function (abortResult) {\r\n                        self.showActionResultFrame(content, abortResult.response, \"invalidate\");\r\n                    }).fail(function (error) {\r\n                        bizagi.log(error);\r\n                    });\r\n                });\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Reassign selected tasks\r\n     */\r\n    showReassignTasksFrame: function (content) {\r\n        var self = this;\r\n        var selectedTasks = {\r\n            cases: []\r\n        };\r\n        var selectedTasksToShow = [];\r\n\r\n        $.each(self.selectedWorkItemAdmin, function (index, item) {\r\n            item = item.split(\"|\");\r\n            selectedTasks.cases.push({\r\n                idCase: item[0],\r\n                idWorkItem: item[1]\r\n            });\r\n            selectedTasksToShow.push({\r\n                taskItem: item[0] + \": \" + item[2],\r\n                idWorkItem: item[1]\r\n            });\r\n        });\r\n\r\n        if (selectedTasksToShow.length == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign-empty-msg\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        } else {\r\n            self.selectedTasks = selectedTasks;\r\n            self.selectedTasksToShow = selectedTasksToShow;\r\n            self.showReassignForm(content, selectedTasksToShow);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Show Reassign frame\r\n     */\r\n    showReassignForm: function (content, selectedTasksToShow) {\r\n        var self = this;\r\n        self.buttonBackAction = \"backToCases\";\r\n        var resultTemplate = $.tmpl(self.reassignFormTmpl, {\r\n            tasks: selectedTasksToShow\r\n        });\r\n\r\n        $(\"#dinamicContent\", content).hide();\r\n        $(\"#dinamicContent2\", content).html(resultTemplate);\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign-title\"));\r\n        self.setupUsersSearchForm();\r\n\r\n    },\r\n\r\n    /*\r\n     * Reassign one or more taskt to other user\r\n     */\r\n    reassignTasks: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        var params = {\r\n            action: \"reassignItems\",\r\n            cases: JSON.stringify(self.selectedTasks),\r\n            idNewUser: self.selectedUserId\r\n        };\r\n\r\n        $.when(self.dataService.abortReassignItems(params)).done(function (reassignResult) {\r\n            self.showActionResultFrame(content, reassignResult.response, \"reassign\");\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Show Invalidate / Reassign Result frame\r\n     */\r\n    showActionResultFrame: function (content, result, type) {\r\n        var self = this;\r\n        var action = result.length > 1 ? \"-several\" : \"\";\r\n        var items = \"\";\r\n        var itemsFailed = \"\";\r\n        var resultStatus = [];\r\n        action = type + action;\r\n\r\n        if (action == \"invalidate\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].deleted == true) {\r\n                    items = result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed = result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"invalidate-several\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].deleted == true) {\r\n                    items += result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed += result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"reassign\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].reassigned == true) {\r\n                    items += result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed = result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"reassign-several\") {\r\n            items += \"<br/><br/>\";\r\n            itemsFailed += \"<br/><br/>\";\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].reassigned == true) {\r\n                    items += result[i].idCase + \"<br/>\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed += result[i].idCase + \"<br/>\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n            items += \"<br/>\";\r\n            itemsFailed += \"<br/>\";\r\n        }\r\n\r\n        //load result template\r\n        var resultTemplate = $.tmpl(self.actionResultContentTmpl, {\r\n            action: action,\r\n            resultStatus: resultStatus,\r\n            exceptionMessage: itemsFailed.substring(itemsFailed.indexOf('|') + 1)\r\n        });\r\n        resultTemplate = resultTemplate[0].innerHTML.replace(\"{0}\", \"<strong>\" + items + \"</strong>\");\r\n        var idCase = itemsFailed.substring(0, itemsFailed.indexOf('|') === -1 ? undefined : itemsFailed.indexOf('|'));\r\n        resultTemplate = resultTemplate.replace(\"{3}\", \"<strong>\" + idCase + \"</strong>\");\r\n        resultTemplate = resultTemplate.replace(\"{1}\", self.selectedUserName);\r\n        resultTemplate = resultTemplate.replace(\"{1}\", self.selectedUserName);\r\n\r\n        //reset and load respective result data and elements\r\n        if (type == \"invalidate\") $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-result-title\"));\r\n        $(\"#mainForm\", content).html(\"\");\r\n        $(\"#dinamicContent\", content).css(\"display\", \"inline\");\r\n        $(\"#dinamicContent\", content).html(resultTemplate);\r\n        $(\"#dinamicContent2\", content).remove();\r\n        $(\"#usersTable\", content).remove();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-search-clear\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-search\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-finish\", content).css(\"display\", \"inline\");\r\n    },\r\n\r\n\r\n    //******************************** EVENTS ********************************//\r\n\r\n    /*\r\n     * Implement main buttons behaviour\r\n     */\r\n    setupMainButtons: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            buttons = $.tmpl(self.buttonContentTmpl, {});\r\n\r\n        content.append(buttons);\r\n\r\n        var widgetButtonSet = $(\"#case-search-log-data-buttonset\", content);\r\n\r\n        $(\"#btn-admin-case-search-clear\", widgetButtonSet).click(function () {\r\n\r\n            //clear all fields\r\n            $(\".biz-wp-input-text\", content).val(\"\");\r\n            $(\".biz-wp-form-datepicker\", content).val(\"\");\r\n            $(\"#userPositionInput\", content).val(''); //Clean combo value\r\n            $(\"#userPositionInput\", content).find(\".biz-wp-combo-input\").val('.........'); //Clean combo display\r\n            self.setupProcessTree();\r\n\r\n        });\r\n\r\n        $(\"#btn-admin-case-search\", widgetButtonSet).click(function () {\r\n\r\n            var idAppToSend = \"\",\r\n                idCategorytoSend = \"\",\r\n                idProcessToSend = \"\",\r\n                errorMessage = \"\",\r\n                errorFieldName = \"\";\r\n\r\n            var selectedProcessRoute = self.processTree.getTreeRouteSelected();\r\n\r\n            if (selectedProcessRoute.length > 0) {\r\n                if (selectedProcessRoute.length == 2) {\r\n                    idAppToSend = selectedProcessRoute[1];\r\n                    idProcessToSend = selectedProcessRoute[0];\r\n                    idCategorytoSend = \"\";\r\n                }\r\n                else {\r\n                    idAppToSend = selectedProcessRoute[selectedProcessRoute.length - 1];\r\n                    //In admin search it isn't necesary add the categoryId param\r\n                    idCategorytoSend = \"\";\r\n                    idProcessToSend = selectedProcessRoute[0];\r\n                }\r\n            }\r\n\r\n            var numberResults = parseInt($(\"#resultsNumber\").val());\r\n            (bizagi.util.isNumeric(numberResults)) ? self.maxElemShow = numberResults : self.maxElemShow = self.defaultMaxRows;\r\n\r\n            var dateFrom = $(\"#sinceDate\");\r\n            dateFrom = dateFrom.datepicker(\"getDate\");\r\n            dateFrom = dateFrom ? bizagi.util.dateFormatter.formatInvariant(dateFrom, false) : \"\";\r\n\r\n            var dateTo = $(\"#toDate\");\r\n            dateTo = dateTo.datepicker(\"getDate\");\r\n            dateTo = dateTo ? bizagi.util.dateFormatter.formatInvariant(dateTo, false) : \"\";\r\n\r\n            var params = {\r\n                h_action: \"getCases\",\r\n                I_ProcessState: \"Running\",\r\n                h_idApp: \"\",\r\n                I_Users: \"ALL\",\r\n                eventAsTask: true,\r\n                orderType: 1,\r\n                order: \"\",\r\n                orderField: \"\",\r\n                group: (bizagiConfig.groupByCaseNumber) ? \"T_RADNUMBER\" : null,\r\n                I_radNumber: $.trim($(\"#caseInput\").val()),\r\n                I_idWFClass: idProcessToSend,\r\n                I_USERNAME: $(\"#userNameInput\").val(),\r\n                I_USERFULLNAME: $(\"#userFullNameInput\").val(),\r\n                I_USERPOSITION: $(\"#userPositionInput\").val(),\r\n                I_From__CreationDate: dateFrom ? dateFrom : $(\"#sinceDate\").val(),\r\n                I_To__CreationDate: dateTo ? dateTo : $(\"#toDate\").val(),\r\n                h_idWFClassAuth: \"\",\r\n                I_idCategory: idCategorytoSend,\r\n                I_idApplication: idAppToSend,\r\n                PageSize: self.maxElemShow\r\n            };\r\n\r\n            if (params[\"I_From__CreationDate\"] != \"\" && !bizagi.util.isDate(params[\"I_From__CreationDate\"])) {\r\n                errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n                errorFieldName = bizagi.localization.getResource(\"workportal-widget-admincasesearch-date-since\");\r\n                errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n                bizagi.showMessageBox(errorMessage, bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            } else if (params[\"I_To__CreationDate\"] != \"\" && !bizagi.util.isDate(params[\"I_To__CreationDate\"])) {\r\n                errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n                errorFieldName = bizagi.localization.getResource(\"workportal-widget-admincasesearch-to-date\");\r\n                errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n                bizagi.showMessageBox(errorMessage, bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            } else {\r\n                self.searchParams = params;\r\n                self.selectedCaseAdmin = [];\r\n                self.selectedWorkItemAdmin = [];\r\n                self.findResults(content, params);\r\n            }\r\n        });\r\n\r\n        $(\"#btn-admin-case-back\", widgetButtonSet).click(function () {\r\n            if (self.buttonBackAction == \"backToMainForm\") {\r\n                self.backToMainForm();\r\n            } else if (self.buttonBackAction == \"backToCases\") {\r\n                self.backToCases();\r\n            }\r\n        });\r\n\r\n        $(\"#btn-admin-case-finish\", widgetButtonSet).click(function () {\r\n            self.setupData();\r\n        });\r\n\r\n        //Result per page only number search\r\n        $(\"#resultsNumber\", content).bind(\"keypress\", function (e) {\r\n            var unicode = e.charCode ? e.charCode : e.keyCode\r\n            if (unicode != 8) {\r\n                if (unicode < 48 || unicode > 57)\r\n                    return false\r\n            }\r\n        });\r\n\r\n        $(\"#btn-admin-cases-invalidate\", content).click(function () {\r\n            if($(\"#allAppsLinkSelected\", content).data('allAppSelected') === false && self.processTreeDelete.getTreeRouteSelected().length === 0){ //If nothing has been selected\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-processTree-no-selected-process\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            }else{\r\n                self.showConfirmationMessage();\r\n            }\r\n            \r\n            $(self.loader).remove();\r\n        });\r\n    },\r\n    \r\n    /**\r\n     * Get date from DatePicker\r\n     * @param controlIDSelector\r\n     * @returns {string}\r\n     */\r\n    getDateInvariantByControlIDSelector: function (controlIDSelector) {\r\n        var paramDate = \"\";\r\n        var valueDatePicker = $(controlIDSelector).datepicker(\"getDate\");\r\n\r\n        if (valueDatePicker !== null) {\r\n            try {\r\n                paramDate = bizagi.util.dateFormatter.formatInvariant(valueDatePicker, false);\r\n            }\r\n            catch (err) {\r\n                paramDate = \"\";\r\n                $(controlIDSelector).val(\"\");\r\n            }\r\n        }\r\n        return paramDate;\r\n    },\r\n\r\n    /*\r\n     * Back to Cases\r\n     */\r\n    backToCases: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.buttonBackAction = \"backToMainForm\";\r\n        $(\"#dinamicContent\", content).show();\r\n        $(\"#dinamicContent2\", content).html(\"\");\r\n        $(\"#usersTable\").remove();\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-table-title\"));\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n    },\r\n\r\n    /*\r\n     * Back to Main Form\r\n     */\r\n    backToMainForm: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        $(\"#mainForm\", content).show();\r\n        $(\"#dinamicContent\", content).html(\"\");\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-subtitle\"));\r\n        $(\"#btn-admin-case-search-clear\", content).show();\r\n        $(\"#btn-admin-case-search\", content).show();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"none\");\r\n    },\r\n\r\n    /*\r\n     * Set event to reassign link in users table\r\n     */\r\n    assignEventReassignLinks: function (userId, userName) {\r\n        var self = this;\r\n        self.selectedUserId = userId;\r\n        self.selectedUserName = userName;\r\n        self.reassignTasks();\r\n    },\r\n\r\n    /*\r\n     * Implement actions buttons behaviour\r\n     */\r\n    setupActionsButton: function (content) {\r\n        var self = this;\r\n\r\n        $(\"input:checkbox[name=CaseAdmin]\", content).click(function () {\r\n            var valueSelected = $(this).val();\r\n            ($(this).is(\":checked\")) ? self.selectedCaseAdmin.push(valueSelected) : self.selectedCaseAdmin.splice($.inArray(valueSelected, self.selectedCaseAdmin), 1);\r\n        });\r\n\r\n        $(\"input:checkbox[name=workItemAdmin]\", content).click(function () {\r\n            var valueSelected = $(this).val();\r\n            ($(this).is(\":checked\")) ? self.selectedWorkItemAdmin.push(valueSelected) : self.selectedWorkItemAdmin.splice($.inArray(valueSelected, self.selectedWorkItemAdmin), 1);\r\n        });\r\n\r\n        //boton invalidar\r\n        $(\"#btn-admin-case-invalidate\", content).click(function () {\r\n            self.invalidateCases(content);\r\n        });\r\n\r\n        //boton reasignar\r\n        $(\"#btn-admin-case-reassign\", content).click(function () {\r\n            self.showReassignTasksFrame(content);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Manage cases table links events(cases, activities and view workflow)\r\n     */\r\n    setupActivitiesLink: function (content) {\r\n        var self = this;\r\n\r\n        // Add click event to task (Activity) link\r\n        $(\".activityClicked\", content).click(function () {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: $(this)[0].getAttribute(\"data-idCase\"),\r\n                idWorkItem: $(this)[0].getAttribute(\"data-idworkItem\"),\r\n                idTask: $(this)[0].getAttribute(\"data-idTask\")\r\n            });\r\n            self.publish(\"closeCurrentDialog\");\r\n\r\n        });\r\n\r\n        // Add click event to case link\r\n        $(\".caseClicked\", content).click(function () {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: $(this)[0].getAttribute(\"data-idCase\"),\r\n                idWorkItem: \"\",\r\n                idTask: \"\"\r\n            });\r\n            self.publish(\"closeCurrentDialog\");\r\n        });\r\n\r\n        // Add click event to column header\r\n        $(\".cases-column-header\", content).click(function () {\r\n            var columnOrderId = $(this)[0].getAttribute(\"data-columnorder\");\r\n            var columnOrderBy = $(this)[0].getAttribute(\"data-ordertype\");\r\n            var columnOrderName = $(this)[0].getAttribute(\"data-columnOrderName\");\r\n\r\n            if (columnOrderBy == \"1\") {\r\n                columnOrderBy = 0;\r\n            } else {\r\n                columnOrderBy = 1;\r\n            }\r\n\r\n            self.searchParams.order = columnOrderId;\r\n            self.searchParams.orderType = columnOrderBy;\r\n            self.searchParams.orderField = columnOrderName;\r\n            self.findResults(content, self.searchParams, self.searchParams.Page);\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Set up graphic query event\r\n     */\r\n    setupGraphicQueryEvent: function (content) {\r\n\r\n        var self = this;\r\n\r\n        // Add click event to view workflow\r\n        $(\".biz-wp-diagram-view-icon\", content).click(function () {\r\n            var idCase = $(this).data(\"idcase\");\r\n            var idWorkflow = $(this).data('idworkflow');\r\n            var isAdhoc = false;\r\n            var processId = null;\r\n\r\n            for (var i = 0; i < self.adhocIds.length; i++) {\r\n                if (parseInt(idCase) == self.adhocIds[i].caseId) {\r\n                    isAdhoc = true;\r\n                    processId = self.adhocIds[i].processId;\r\n                }\r\n            }\r\n            if (isAdhoc) {\r\n                self.showGraphicQuery({\r\n                    idCase: idCase,\r\n                    idWorkflow: idWorkflow,\r\n                    isAdhoc: isAdhoc,\r\n                    idProcess: processId\r\n                });\r\n            } else {\r\n                self.showGraphicQuery({\r\n                    idCase: idCase,\r\n                    idWorkflow: idWorkflow\r\n                });\r\n            }\r\n\r\n        });\r\n    },\r\n    paramsToInvalidateSelectedCases: function () {\r\n        var self = this;\r\n        var selectedProcessRoute = self.processTreeDelete.getTreeRouteSelected();\r\n        var idAppToSend = \"\",\r\n            idProcessToSend = \"\";\r\n\r\n        if (selectedProcessRoute.length > 0) {\r\n            if (selectedProcessRoute.length == 2) {\r\n                idAppToSend = selectedProcessRoute[1];\r\n                idProcessToSend = selectedProcessRoute[0];\r\n            }\r\n            else {\r\n                idAppToSend = selectedProcessRoute[selectedProcessRoute.length - 1];\r\n                idProcessToSend = selectedProcessRoute[0];\r\n            }\r\n        }\r\n\r\n        var params = {\r\n            idProcess: idProcessToSend,\r\n            idApplication: idAppToSend\r\n        };\r\n        return params;\r\n    },\r\n    // Invalidate Cases Module\r\n    invalidateSelectedCase: function (selectedProcess) {\r\n        var self = this;\r\n        $.when(self.dataService.postAdminInvalidateCase(selectedProcess)).done(function () {\r\n            self.last_showSuccessToastInvalidate = true;\r\n            self.getProcessRunningInvalidateCases();\r\n        }).fail(function (error) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n    getProcessRunningInvalidateCases: function () {\r\n        var self = this;\r\n        self.resp = false;\r\n        $.when(self.dataService.getResponseProcessRunningInvalidateCases()).done(function (response) {\r\n            var content = self.getContent();\r\n            if (response.status === \"InProgress\") { //If there is a process running\r\n                var that = self;\r\n                if (!that.isOut) { // If I don't out of deactivate tab\r\n                    $(\"#btn-admin-cases-invalidate\").fadeOut(10);\r\n                    $(\"#invalidateMessage\", content).fadeIn(10);\r\n                    $(\"#tree\", content).fadeOut(10);\r\n                    self.timer = setTimeout(function () {\r\n                        that.getProcessRunningInvalidateCases()\r\n                    }, 10000)\r\n                }\r\n                else {\r\n                    self.resp = false;\r\n                }\r\n\r\n            } else {\r\n                $(\"#btn-admin-cases-invalidate\").fadeIn(10);\r\n                $(\"#tree\", content).fadeIn(10);\r\n                $(\"#invalidateMessage\", content).fadeOut(10);\r\n                self.resp = false;\r\n                if (self.last_showSuccessToastInvalidate === true) {\r\n                    self.showNotifier();\r\n                }\r\n            }\r\n            if (!self.isOut) {\r\n                self.last_showSuccessToastInvalidate = false;\r\n                if(response.status === \"InProgress\"){\r\n                    self.last_showSuccessToastInvalidate =true;\r\n                }\r\n                \r\n                self.endLoading();\r\n            }else{\r\n                $(self.loader).remove();\r\n            }\r\n        }).fail(function (error) {\r\n            var content = self.getContent();\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            $(\"#btn-admin-cases-invalidate\").fadeIn(10);\r\n            $(\"#tree\", content).fadeIn(10);\r\n            $(\"#invalidateMessage\", content).fadeOut(10);\r\n            self.resp = false;\r\n            self.endLoading();\r\n            bizagi.log(error);\r\n            \r\n        });\r\n        return self.resp;\r\n    },\r\n    showLoading: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $(\"#deleteCasesWrapper\", content).fadeOut(10);\r\n        $(\"#case-search-log-data-buttonset\", content).fadeOut(10);\r\n        $(\"#deleteCases\", content).append(self.loader);\r\n    },\r\n    endLoading: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $(\"#deleteCasesWrapper\", content).fadeIn(10);\r\n        $(\"#case-search-log-data-buttonset\", content).fadeIn(10);\r\n        $(self.loader).remove();\r\n    },\r\n    dispose: function () { //When close the dialog\r\n        clearTimeout(this.timer);\r\n    }\r\n});","/**\r\n * Name: BizAgi Desktop Widget Asynchronous Activities Console Implementation\r\n *\r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.async.activities.extend(\"bizagi.workportal.widgets.admin.async.activities\", {\r\n    ASYNC_CHECK_TIMER: 3000\r\n}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.selectedTab = 0;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"async\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.async\"),\r\n            \"admin.async.activities\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities\"),\r\n            \"admin.async.activities.tabs\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-tabs\"),\r\n            \"admin.async.activities.tab1\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-tab1\"),\r\n            \"admin.async.activities.tab2\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-tab2\"),\r\n            \"admin.async.activities.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-log\"),\r\n            \"admin.async.activities.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-pagination\"),\r\n            \"admin.async.activities.error.page\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-error-page\"),\r\n            \"admin.async.activities.processing\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-processing\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.tabsTmpl = self.getTemplate(\"admin.async.activities.tabs\");\r\n        self.tab1Tmpl = self.getTemplate(\"admin.async.activities.tab1\");\r\n        self.tab2Tmpl = self.getTemplate(\"admin.async.activities.tab2\");\r\n        self.logTmpl = self.getTemplate(\"admin.async.activities.log\");\r\n        self.paginatorTmpl = self.getTemplate(\"admin.async.activities.pagination\");\r\n        self.errorPage = self.getTemplate(\"admin.async.activities.error.page\");\r\n        self.processingPage = self.getTemplate(\"admin.async.activities.processing\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n     * Setup form data\r\n     */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n        self.setupTabs();\r\n    },\r\n\r\n    /*\r\n     * Load initial data\r\n     */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            mainContent = $(\".async-act-main-content\", content);\r\n\r\n        //set content form to default\r\n        $(\"#generalTitle\", content).html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-subtitle\"));\r\n        mainContent.html(\"\");\r\n        $(\"#main-screen\", content).show();\r\n        $(\"#dinamic-screen\", content).html(\"\");\r\n\r\n        //append fields to wrapper\r\n        var fields = $.tmpl(self.tabsTmpl, {});\r\n        mainContent.append(fields);\r\n        self.loadTabsContent();\r\n\r\n    },\r\n\r\n    /*\r\n     * load tabs\r\n     */\r\n    loadTabsContent: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            paramsTab1 = \"\",\r\n            paramsTab2 = \"\";\r\n\r\n        paramsTab1 = {\r\n            action: \"getActivities\",\r\n            page: 1,\r\n            pageSize: self.maxElemShow\r\n        };\r\n        paramsTab2 = {\r\n            action: \"getActivitiesByTask\",\r\n            page: 1,\r\n            pageSize: self.maxElemShow\r\n        };\r\n\r\n        self.renderTab1Table(content, paramsTab1);\r\n        self.renderTab2Table(content, paramsTab2);\r\n\r\n    },\r\n\r\n    /*\r\n     * Apply tabs plugin\r\n     */\r\n    setupTabs: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#async-tabs\", content).tabs(\r\n            {\r\n                activate: function(event, ui){\r\n                  self.selectedTab = ui.newTab.index();\r\n                  self.loadTabsContent();\r\n                },\r\n                active : self.selectedTab || 0\r\n            }\r\n        );\r\n    },\r\n\r\n    /*\r\n     * Find async activities\r\n     */\r\n    renderTab1Table: function (content, params, pageToShow) {\r\n        var self = this;\r\n        var tableWrapper = $(\"#main-screen\", content);\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.page = pageToShow : params.page = 1;\r\n        $(\"#async-loading-activities\").show();\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n            $(\"#async-loading-activities\").hide();\r\n            //clean old results\r\n            $(\"#async-tabs-1\").remove();\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n            self.asyncActRefresh();\r\n\r\n            if (resultList.rows.length) {\r\n\r\n                var tab1Content = $.tmpl(self.tab1Tmpl, {\r\n                    rows: resultList.rows,\r\n                    selectedTab : self.selectedTab\r\n                });\r\n                // Format invariant dates\r\n                bizagi.util.formatInvariantDate(tab1Content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n                $(\"#async-tabs\", content).append(tab1Content);\r\n                self.setupTab1ActivitiesLink();\r\n                self.setupActionsButton();\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow,\r\n                    summaryWrapper = $(\"#async-table-pager-wrapper\"),\r\n                    pagerData = {},\r\n                    paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n                pagerData.additionalparameters = true;\r\n                pagerData.totalPages = self.totalPages;\r\n                pagerData.totalRecords = self.totalRecords;\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginatorTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\".pager-content\", tableWrapper),\r\n                    clickCallBack: function (options) {\r\n                        self.renderTab1Table(content, params, options.page);\r\n                    }\r\n                });\r\n\r\n\r\n            } else {\r\n                $(\"#async-tabs\", content).hide();\r\n                $(\"#tabs-wrapper\", content).append(bizagi.localization.getResource(\"workportal-general-no-records-found\"));\r\n            }\r\n\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Find async grouped activities\r\n     */\r\n    renderTab2Table: function (content, params) {\r\n        var self = this;\r\n        $(\"#async-loading-activities\").show();\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n            $(\"#async-loading-activities\").hide();\r\n            //clean old results\r\n            $(\"#async-tabs-2\").remove();\r\n\r\n            if (resultList.rows.length) {\r\n\r\n                var resultArr = [],\r\n                    resultRows = resultList.rows,\r\n                    idInsertedArr = [],\r\n                    arrPossition = 0;\r\n\r\n                //Organize data in group structure\r\n                for (var i = 0; i < resultRows.length; i++) {\r\n\r\n                    var idWfClass = resultRows[i].idWfClass,\r\n                        total = Number(resultRows[i].count);\r\n\r\n                    if (idInsertedArr.indexOf(idWfClass) < 0) {\r\n\r\n                        idInsertedArr.push(idWfClass);\r\n\r\n                        resultArr[arrPossition] = {\r\n                            wfClsDisplayName: resultRows[i].wfClsDisplayName,\r\n                            idWfClass: resultRows[i].idWfClass,\r\n                            childs: [\r\n                                {\r\n                                    idTask: resultRows[i].idTask,\r\n                                    tskDisplayName: resultRows[i].tskDisplayName,\r\n                                    count: resultRows[i].count\r\n                                    }\r\n                                ]\r\n                        };\r\n\r\n                        for (var j = i + 1; j < resultRows.length; j++) {\r\n                            if (idWfClass == resultRows[j].idWfClass) {\r\n                                total += Number(resultRows[j].count);\r\n                                resultArr[arrPossition].childs.push({\r\n                                    idTask: resultRows[j].idTask,\r\n                                    tskDisplayName: resultRows[j].tskDisplayName,\r\n                                    count: resultRows[j].count\r\n                                });\r\n                            }\r\n                        }\r\n\r\n                        resultArr[arrPossition].count = total;\r\n                        arrPossition += 1;\r\n                    }\r\n\r\n                }\r\n\r\n                //insert data into template and append it to the tab\r\n                var tab2Content = $.tmpl(self.tab2Tmpl, {\r\n                    rows: resultArr,\r\n                    selectedTab : self.selectedTab\r\n\r\n                });\r\n                $(\"#async-tabs\", content).append(tab2Content);\r\n                self.setupTab2ActivitiesLink();\r\n\r\n            }\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Execute retry\r\n     */\r\n    executeActivity: function (params) {\r\n\r\n        var self = this,\r\n            content = self.getContent(),\r\n            mainScreen = $(\"#main-screen\", content),\r\n            dinamicScreen = $(\"#dinamic-screen\", content),\r\n            errorMessage = \"\",\r\n            dinamiccontent = \"\";\r\n\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n\r\n\r\n            if (resultList.executed) {\r\n                var def = $.Deferred();\r\n\r\n                $.when(self.checkAsycnExecutionState(1, params.idCase, params.idAsynchWorkitem, def)).done(function () {\r\n                    self.goToCase(params.idCase);\r\n                }).fail(function () {\r\n                    errorMessage = bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-message\");\r\n                    dinamiccontent = $.tmpl(self.errorPage, {\r\n                        errorMessage: errorMessage\r\n                    });\r\n                    dinamicScreen.html(\"\");\r\n                    dinamicScreen.append(dinamiccontent);\r\n                    self.setupErrorPageLink(\"#go-to-pending\");\r\n\r\n                });\r\n\r\n            } else {\r\n                errorMessage = bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-retry\");\r\n                dinamiccontent = $.tmpl(self.errorPage, {\r\n                    errorMessage: errorMessage\r\n                });\r\n            }\r\n\r\n        }).fail(function (e) {\r\n            bizagi.log(e);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Call server to know status of the activity (3 retries of 1 second each)\r\n     */\r\n    getRetryStatus: function (counter, idCase, def) {\r\n        var self = this;\r\n        var params = {\r\n            action: \"getAsyncExecution\",\r\n            idCase: idCase\r\n        };\r\n\r\n        setTimeout(function () {\r\n\r\n            $.when(\r\n                self.dataService.getAsynchExecutionState({\r\n                    idCase: idCase,\r\n                    idAsynchWorkitem: idAsynchWorkitem\r\n                })\r\n            ).done(function (response) {\r\n\r\n                if (response.status != \"error\") {\r\n                    def.resolve();\r\n                }\r\n\r\n            }).fail(function (e) {\r\n                if (counter <= 3) {\r\n                    counter += 1;\r\n                    self.getRetryStatus(counter, idCase, idAsynchWorkitem, def);\r\n                } else {\r\n                    def.reject();\r\n                }\r\n            });\r\n\r\n        }, 1000);\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     *  Check execution state every time is called\r\n     */\r\n    checkAsycnExecutionState: function (counter, idCase, idAsynchWorkitem, def) {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            mainScreen = $(\"#main-screen\", content),\r\n            dinamicScreen = $(\"#dinamic-screen\", content),\r\n            dinamiccontent = \"\",\r\n            wrapper = $(\"#ui-bizagi-wp-async-box\", content);\r\n\r\n        $.when(self.dataService.getAsynchExecutionState({\r\n            idCase: idCase,\r\n            idAsynchWorkitem: idAsynchWorkitem\r\n        })).done(function (response) {\r\n            var template = self.getTemplate(\"async\");\r\n\r\n            // verify errors in response\r\n            if (response.state == \"Error\" && typeof (response.errorMessage) == \"undefined\") {\r\n                // Change default error\r\n                response.errorMessage = bizagi.localization.getResource(\"render-async-error\");\r\n            }\r\n\r\n            // Render base template\r\n            dinamiccontent = $.tmpl(template, response);\r\n            mainScreen.hide();\r\n            dinamicScreen.html(\"\");\r\n            dinamicScreen.append(dinamiccontent);\r\n            $(\"#ui-bizagi-wp-async-box\", content).css({\r\n                \"top\": 0,\r\n                \"left\": 0,\r\n                \"margin-top\": 0,\r\n                \"margin-left\": 0,\r\n                \"padding-top\": 0,\r\n                \"margin-right\": 0,\r\n                \"width\": \"96%\",\r\n                \"max-height\": \"80\",\r\n                \"height\": \"80\"\r\n            });\r\n\r\n            self.setupErrorPageLink($(\"#link-go-to-inbox\").find(\"a\"));\r\n            $(\"#link-back\").css(\"display\", \"inline\");\r\n            self.setupBackToMainPage();\r\n\r\n            // Check for finish signal\r\n            if (response.state == \"Processing\") {\r\n                // Check for non-error message\r\n                if (response.errorMessage.length == 0) {\r\n                    setTimeout(function () {\r\n                        // Refresh widget after a timer\r\n                        counter += 1;\r\n                        self.checkAsycnExecutionState(counter, idCase, idAsynchWorkitem, def);\r\n\r\n                    }, self.Class.ASYNC_CHECK_TIMER);\r\n                }\r\n\r\n            } else if (response.state == \"Finished\") {\r\n\r\n                // Resolve main deferred\r\n                def.resolve(self.content);\r\n            }\r\n\r\n\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n     * Show log page\r\n     */\r\n    showLog: function (params, data, pageToShow) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.page = pageToShow : params.page = 1;\r\n\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n\r\n\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n\r\n            if (resultList.response.length) {\r\n\r\n                var logPage = $.tmpl(self.logTmpl, {\r\n                    rows: resultList.response,\r\n                    data: data\r\n                });\r\n\r\n                // Format invariant dates\r\n                bizagi.util.formatInvariantDate(logPage, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n                $(\"#dinamic-screen\", content).html(\"\");\r\n                $(\"#dinamic-screen\", content).append(logPage);\r\n                self.setupLogButtons();\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow,\r\n                    summaryWrapper = $(\"#log-table-pager-wrapper\"),\r\n                    pagerData = {},\r\n                    paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n                pagerData.additionalparameters = true;\r\n                pagerData.totalPages = self.totalPages;\r\n                pagerData.totalRecords = self.totalRecords;\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginatorTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\", summaryWrapper).bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\".pager-content\", summaryWrapper),\r\n                    clickCallBack: function (options) {\r\n                        self.showLog(params, data, options.page);\r\n                    }\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(\r\n                    bizagi.localization.getResource(\"workportal-general-no-records-found\"),\r\n                    \"Bizagi\",\r\n                    \"warning\"\r\n                )\r\n                .then( function() {\r\n                    $(\"#generalTitle\", content).html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-subtitle\"));\r\n                    $('#main-screen', content).show();\r\n                });\r\n            }\r\n\r\n        }).fail(function (e) {\r\n            bizagi.log(e);\r\n            $(\"#generalTitle\", content).html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-subtitle\"));\r\n            $('#main-screen', content).show();\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Enable links on grouped tab\r\n     */\r\n    enableActivities: function (processId, taskId) {\r\n        var self = this;\r\n        var params = {\r\n            action: \"enableExecution\",\r\n            idTask: taskId,\r\n            idWfClass: processId\r\n        };\r\n\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n            self.setupData();\r\n        }).fail(function (e) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-enable\"), \"Bizagi\", \"warning\");\r\n        });\r\n    },\r\n\r\n    enableMultipleActivities: function (cases) {\r\n        var self = this;\r\n        var params = {\r\n            action: \"enableMultiple\",\r\n            cases: JSON.stringify(cases)\r\n        };\r\n\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n            if (resultList.executed) {\r\n                self.setupData();\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-enable\"), \"Bizagi\", \"warning\");\r\n            }\r\n        }).fail(function (e) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-enable\"), \"Bizagi\", \"warning\");\r\n        });\r\n    },\r\n\r\n    goToCase: function (idCase) {\r\n        var self = this;\r\n\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            idWorkItem: \"\",\r\n            idTask: \"\"\r\n        });\r\n        self.publish(\"closeCurrentDialog\");\r\n    },\r\n\r\n    /**\r\n     * Add click to tabs for loading\r\n     */\r\n    asyncActRefresh:function () {\r\n        var self = this,\r\n            content=self.getContent()\r\n        $(\"#async-act-refresh-link\", content).unbind();\r\n        $(\"#async-act-refresh-link\", content).click(function (e) {\r\n            self.setupData();\r\n            if(self.selectedTab) {\r\n                $('#async-tabs li:eq('+ self.selectedTab + ') a').click();                    \r\n            }\r\n        });\r\n    },\r\n\r\n    //******************************** EVENTS ********************************//\r\n\r\n    /*\r\n     * Implement main buttons behaviour\r\n     */\r\n    setupActionsButton: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            buttons = $.tmpl(self.buttonContentTmpl, {});\r\n\r\n        content.append(buttons);\r\n\r\n        self.asyncActRefresh(content);\r\n\r\n        $(\".async-act-log-link\", content).click(function (e) {\r\n\r\n            var paramsLog = {\r\n                action: \"asyncExecutionLog\",\r\n                idCase: this.getAttribute(\"data-idCase\"),\r\n                idWorkItem: this.getAttribute(\"data-idWorkItem\"),\r\n                pageSize: self.maxElemShow,\r\n                idAsynchWorkitem: this.getAttribute(\"data-idAsynchWorkitem\")\r\n            };\r\n            var data = {\r\n                idCase: this.getAttribute(\"data-idCase\"),\r\n                radNumber: this.getAttribute(\"data-radNumber\"),\r\n                taskName: this.getAttribute(\"data-taskName\"),\r\n                processName: this.getAttribute(\"data-processName\")\r\n            };\r\n\r\n            $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-activitieslog\"));\r\n            $(\"#main-screen\", content).hide();\r\n\r\n            self.showLog(paramsLog, data);\r\n\r\n        });\r\n\r\n        $(\".async-act-retry-link\", content).click(function (e) {\r\n\r\n            var params = {\r\n                action: \"retryNow\",\r\n                idCase: this.getAttribute(\"data-idCase\"),\r\n                idWorkitem: this.getAttribute(\"data-idWorkItem\"),\r\n                processName: this.getAttribute(\"data-processName\"),\r\n                idAsynchWorkitem: this.getAttribute(\"data-idAsynchWorkitem\"),\r\n                taskName: this.getAttribute(\"data-taskName\")\r\n            };\r\n\r\n            self.executeActivity(params);\r\n\r\n        });\r\n\r\n        $(\"#async-act-enable-checks\", content).click(function () {\r\n            var checkboxes = document.getElementsByName('enableChecks');\r\n            var vals = {\r\n                cases: []\r\n            };\r\n            for (var i = 0, n = checkboxes.length; i < n; i++) {\r\n                if (checkboxes[i].checked) {\r\n                    var idCase = checkboxes[i].value;\r\n                    var idWorkItem = checkboxes[i].getAttribute(\"data-idWorkItem\");\r\n                    var idAsynchWorkitem = checkboxes[i].getAttribute(\"data-idAsynchWorkitem\");\r\n                    var idAsynchWorkitem = checkboxes[i].getAttribute(\"data-idAsynchWorkitem\");\r\n                    vals.cases.push({\r\n                        idCase: idCase,\r\n                        idWorkItem: idWorkItem,\r\n                        idAsynchWorkitem: idAsynchWorkitem\r\n                    });\r\n                }\r\n            }\r\n            self.enableMultipleActivities(vals);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * back button\r\n     */\r\n    setupLogButtons: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#async-act-button-back\", content).click(function (e) {\r\n            $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-subtitle\"));\r\n            $(\"#main-screen\", content).show();\r\n            $(\"#dinamic-screen\", content).html(\"\");\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Manage cases table links events(cases and activities)\r\n     */\r\n    setupTab1ActivitiesLink: function (content) {\r\n        var self = this;\r\n\r\n        // Add click event to task (Activity) link\r\n        $(\".async-activity-click\", content).click(function () {\r\n            self.goToCase($(this)[0].getAttribute(\"data-idCase\"));\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Manage grouped tab events\r\n     */\r\n    setupTab2ActivitiesLink: function (content) {\r\n        var self = this;\r\n\r\n        $(\".async-act-process-tree-link\", content).click(function () {\r\n\r\n            if ($(\"div\", this).hasClass(\"biz-wp-tree-expand-icon\")) {\r\n                $(\"div\", this).removeClass(\"biz-wp-tree-expand-icon\");\r\n                $(\"div\", this).addClass(\"biz-wp-tree-collapse-icon\");\r\n                $(this).closest(\"tr\").find(\".async-act-childs\").css(\"display\", \"block\");\r\n                $(this).closest(\"tr\").find(\".async-act-childs\").addClass(\"clearfix\");\r\n            } else {\r\n                $(\"div\", this).removeClass(\"biz-wp-tree-collapse-icon\");\r\n                $(\"div\", this).addClass(\"biz-wp-tree-expand-icon\");\r\n                $(this).closest(\"tr\").find(\".async-act-childs\").css(\"display\", \"none\");\r\n                $(this).closest(\"tr\").find(\".async-act-childs\").removeClass(\"clearfix\");\r\n            }\r\n        });\r\n\r\n        $(\".async-act-enable-link\").click(function () {\r\n            var processId = this.getAttribute(\"data-idWfClass\");\r\n            var taskId = this.getAttribute(\"data-idTask\") ? this.getAttribute(\"data-idTask\") : 0;\r\n            self.enableActivities(processId, taskId);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * manage go to pending event\r\n     */\r\n    setupErrorPageLink: function (selector) {\r\n        var self = this;\r\n\r\n        $(selector).click(function () {\r\n\r\n            var inbox = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX;\r\n            var grid = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID;\r\n            var actualWidget;\r\n            var storeWidget = ($.isFunction(bizagi.cookie)) ? bizagi.cookie(\"bizagiDefaultWidget\") : grid;\r\n\r\n            switch (storeWidget) {\r\n            case inbox:\r\n                actualWidget = inbox;\r\n                break;\r\n\r\n            case grid:\r\n                actualWidget = grid;\r\n                break;\r\n            default:\r\n                actualWidget = grid;\r\n                break;\r\n            }\r\n\r\n\r\n            self.publish(\"changeWidget\", {\r\n                widgetName: actualWidget\r\n            });\r\n\r\n            self.publish(\"closeCurrentDialog\");\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     * manage back link\r\n     */\r\n    setupBackToMainPage: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            wrapper = $(\"#ui-bizagi-wp-async-box\", content);\r\n\r\n        $(\"#link-back\", wrapper).click(function () {\r\n            self.setupData();\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Workportal Graphic Query Widget\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script renders the user administration\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.usersAdministration\", {}, {\r\n\r\n\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n\r\n        var self = this;\r\n\r\n        //Pagination data\r\n        self.maxRows = 18;\r\n        self.maxPages = 10;\r\n        self.currentPage = 1;\r\n        self.orderType = \"ASC\";\r\n        self.orderField = \"\";\r\n        self.totalPages = 0;\r\n        self.userData = {};\r\n        self.allowCreation = true;\r\n\r\n        self.userLinks = [\r\n            {\r\n                name: \"downloadReport\",\r\n                label: bizagi.localization.getResource(\"workportal-gdpr-download-report\"),\r\n                icon: \"icon-download-report-user\",\r\n                typeSVG: true\r\n            },\r\n            {\r\n                name: \"anonymize\",\r\n                label: bizagi.localization.getResource(\"workportal-gdpr-anonymize\"),\r\n                icon: \"icon-anonymize\",\r\n                typeSVG: true\r\n            },\r\n            {\r\n                name: \"edition\",\r\n                label: bizagi.localization.getResource(\"bz-rp-components-dimension-edit\"),\r\n                icon: \"bz-icon-pencil-outline\",\r\n                typeSVG: false\r\n            },\r\n            {\r\n                name: \"log\",\r\n                label: bizagi.localization.getResource(\"render-actions-log\"),\r\n                icon: \"bz-icon-log-outline\",\r\n                typeSVG: false\r\n            }\r\n        ];\r\n\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.users\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users\"),\r\n            \"admin.users.formbuttons\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-formbuttons\"),\r\n            \"admin.users.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-log\"),\r\n            \"admin.users.licenses\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-licenses\"),\r\n            \"admin.users.email\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-email\"),\r\n            \"admin.users.anonymize\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-anonymize\"),\r\n            \"admin.search.cases\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.cases\").concat(\"#ui-bizagi-workportal-widget-admin-search-cases\"),\r\n            \"admin.search.users\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.cases\").concat(\"#ui-bizagi-workportal-widget-admin-search-users\"),\r\n            \"admin.table.users\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.cases\").concat(\"#ui-bizagi-workportal-widget-admin-table-users\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n\r\n        var self = this;\r\n        var tmpl = self.getTemplate(\"admin.users\");\r\n        var content = self.content = $.tmpl(tmpl);\r\n\r\n        return content;\r\n    }\r\n});\r\n","/**\r\n * Name: Bizagi Workportal Users Modal\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.desktop.widgets.admin.userPermissionReport\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n \r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        //Load template\r\n        self.loadTemplates({\r\n            \"user-permission-report\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.userPermissionReport\").concat(\"#user-permission-report\")\r\n        });\r\n    },\r\n \r\n    renderContent: function(){\r\n        var self = this;\r\n        var template = self.getTemplate('user-permission-report');\r\n        self.content = template.render({});\r\n        return self.content;\r\n    },\r\n \r\n    postRender: function () {\r\n        var self = this;\r\n        $(\"#downloadButton\", self.getContent()).click(function () {\r\n            self.dataService.getUserPermissionsExcel()\r\n         });\r\n    }\r\n\r\n });\r\n \r\n bizagi.injector.register('bizagi.workportal.desktop.widgets.admin.userPermissionReport', ['workportalFacade', 'dataService', bizagi.workportal.desktop.widgets.admin.userPermissionReport]);","/**\r\n *   Name: BizAgi Workportal Desktop Graphic Query\r\n *   Author: David Romero\r\n *   Comments:\r\n *   -   This script renders the cases workflow\r\n */\r\nbizagi.workportal.widgets.admin.usersAdministration.extend(\"bizagi.workportal.widgets.admin.usersAdministration\", {}, {\r\n\r\n    /**\r\n     * To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.dateFormat = self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\");\r\n        self.$userTable = $(\"#bz-wp-widget-adminuser-usertable\", self.content);\r\n        self.$renderForm = $(\"#bz-wp-widget-adminuser-renderform\", self.content);\r\n        self.$buttonsContainer = $(\"#bz-wp-widget-adminuser-buttonset\", self.content);\r\n        self.$usersLicenses = $(\"#bz-wp-widget-adminuser-licenses\", self.content);\r\n\r\n        //query licenses\r\n        $.when(self.queryUserPermissions()).done(function () {\r\n            //render users table widget\r\n            self.renderUsersTable();\r\n        });\r\n\r\n        //add event handlers\r\n        self.addEventsHandler();\r\n\r\n        //Notification service\r\n        self.notifier = bizagi.injector.get('notifier');\r\n    },\r\n\r\n    /**\r\n     * Render user table\r\n     */\r\n    renderUsersTable: function () {\r\n        var self = this;\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: self.$userTable,\r\n            userLinkLabel: self.userLinks\r\n        }));\r\n\r\n        self.usersTable.render();\r\n    },\r\n\r\n    /**\r\n     * Query users permissions\r\n     */\r\n    queryUserPermissions: function () {\r\n\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n       \r\n        $.when(self.queryLicenses(), self.dataService.createUserAdministrationForm()).done(function (isAllowByLicences, isAllowByReadOnly) {\r\n            self.allowCreation = (!isAllowByLicences || !isAllowByReadOnly[0].createUser || (bizagiConfig.authenticationType === \"Ldap\" && bizagiConfig.isLdapSyncEnabled)) ? false : true;\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Query Licenses\r\n     */\r\n    queryLicenses: function () {\r\n\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        $.when(self.dataService.queryUsersLicenses()).done(function (response) {\r\n            self.showLicensesMessage(response);\r\n            defer.resolve(response.canAddNewUser);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * show licences\r\n     */\r\n    showLicensesMessage: function (params) {\r\n\r\n        var self = this;\r\n\r\n        if (!params.canAddNewUser || params.areLicensedUsersLimitNear) {\r\n\r\n            var tmpl = self.getTemplate(\"admin.users.licenses\");\r\n\r\n            self.$usersLicenses.html($.tmpl(tmpl, { users: params.activeUsers, licenses: params.licensedUsersAccount }));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Events Handlers\r\n     */\r\n    addEventsHandler: function () {\r\n        var self = this;\r\n\r\n        self.$userTable.on(\"clickUserLink\", function (event, data) {\r\n\r\n            self.userData = data;\r\n\r\n            switch (data.type) {\r\n                case \"log\":\r\n                    self.resetLogValues();\r\n                    self.getUsersLogData();\r\n                    break;\r\n                case \"edition\": self.renderForm();\r\n                    break;\r\n                case \"downloadReport\": self.downloadReport();\r\n                    break;\r\n                case \"anonymize\": self.anonymize();\r\n                    break;\r\n            }\r\n        });\r\n\r\n        self.$userTable.on(\"completeUserForm\", function () {\r\n            self.renderFormButtons(\"query\");\r\n        });\r\n\r\n        self.$userTable.on(\"click\", \"#bz-wp-widget-adminuser-createbutton-wrapper\", function () {\r\n            self.userData = {};\r\n            self.renderForm();\r\n        });\r\n\r\n        $(\"#bz-wp-widget-adminuser-buttonset\", self.content).on(\"click\", \"button\", function () {\r\n            self.returnToUserTable();\r\n        });\r\n\r\n        self.$renderForm.on(\"click\", \"table .sortColumnsData\", function () {\r\n            var orderField = $(this).data(\"orderfield\");\r\n            var orderType = $(this).data(\"ordertype\");\r\n\r\n            self.getUsersLogData({ \"orderType\": orderType, \"orderField\": orderField });\r\n        });\r\n\r\n        \r\n        // Buttons of anonymize view\r\n        self.$renderForm.on(\"click\", \"#js-btn-anonymize\", function () {\r\n            bizagi.showErrorAlertDialog = false;\r\n            $.when(self.dataService.anonymizeUser(self.userData.id)).done(function (result) {\r\n                $.when(self.queryUserPermissions()).done(function () {\r\n                    self.showHideNewUser(self.allowCreation);\r\n                    self.notifier.showSucessMessage(\r\n                        printf(bizagi.localization.getResource(\"workportal-general-word-action-successfully\"), \"\"));\r\n                        self.returnToUserTable();\r\n                        self.usersTable.getUsersTableData();\r\n                });\r\n            }).fail(function(xhr, object, responseError) {\r\n                self.notifier.showErrorMessage(\r\n                    printf(bizagi.util.processFailMessage(xhr.responseText), \"\"));\r\n            });\r\n        });\r\n\r\n        self.$renderForm.on(\"click\", \"#js-btn-anonymize-cancel\", function () {\r\n            self.returnToUserTable();\r\n        });\r\n\r\n\r\n        // User Licenses\r\n\r\n        self.$usersLicenses.on(\"click\", \"button\", function (event) {\r\n            var buttonType = $(this).data(\"type\");\r\n\r\n            switch (buttonType) {\r\n                case \"buy\":\r\n                    self.buyLicense();\r\n                    break;\r\n                case \"licenses\":\r\n                    self.renderLicensesWidgets();\r\n                    break;\r\n            }\r\n\r\n            event.stopPropagation();\r\n        });\r\n    },\r\n\r\n   \r\n    showHideNewUser: function(allowCreation){\r\n        var createButton = $(\"#bz-wp-widget-adminuser-createbutton-wrapper\", self.content);\r\n        if (allowCreation) {\r\n            createButton.show();\r\n        }\r\n        else{\r\n            createButton.hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Reset Log Values\r\n     */\r\n    resetLogValues: function () {\r\n        var self = this;\r\n\r\n        self.currentPage = 1;\r\n        self.orderType = \"ASC\";\r\n        self.orderField = \"\";\r\n    },\r\n\r\n    /**\r\n     * Render licenses\r\n     */\r\n    renderLicensesWidgets: function () {\r\n        var self = this;\r\n\r\n        self.publish(\"showDialogWidget\", {\r\n            widgetName: \"userlicenses\",\r\n            data: { \"idCase\": \"Licenses\" },\r\n            modalParameters: {\r\n                title: self.getResource(\"workportal-menu-submenu-Licenses\"),\r\n                width: \"907px\",\r\n                showCloseButton: true,\r\n                id: \"Licenses\"\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Buy License\r\n     */\r\n    buyLicense: function () {\r\n        window.open(\"http://www.bizagi.com\", \"_black\");\r\n    },\r\n\r\n    /**\r\n     * Retorn to user table to query users\r\n     */\r\n    returnToUserTable: function () {\r\n        var self = this;\r\n\r\n        self.toggleForm(true);\r\n        self.removeButtons();\r\n        self.$renderForm.empty();\r\n    },\r\n\r\n    /**\r\n     * Render log\r\n     */\r\n    getUsersLogData: function (params) {\r\n        var self = this;\r\n        var params = params || {};\r\n        self.orderType = params.orderType || self.orderType;\r\n        self.orderField = params.orderField || self.orderField;\r\n\r\n        $.when(self.dataService.getUsersAdministrationLog({ \"idUser\": self.userData.id, \"Pag\": self.currentPage, \"pagSize\": self.maxRows, \"orderField\": self.orderField, \"orderType\": self.orderType })).done(function (response) {\r\n            self.totalPages = response.total;\r\n            self.renderUserLogTable(response);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Remove Buttons\r\n     */\r\n    removeButtons: function () {\r\n        var self = this;\r\n        self.$buttonsContainer.empty();\r\n    },\r\n\r\n    /**\r\n     * Render user log table\r\n     */\r\n    renderUserLogTable: function (response) {\r\n        var self = this;\r\n        var tmpl = self.getTemplate(\"admin.users.log\");\r\n        var renderContainer = self.$renderForm;\r\n        var pagination = (self.totalPages > 1);\r\n        var pagesArray = self.getPagesArray();\r\n\r\n        self.toggleForm(false);\r\n\r\n        //Render log and change date format\r\n        var content = $.tmpl(tmpl, response, { \"userName\": self.userData.name, \"page\": self.currentPage, \"pagination\": pagination, \"pagesArray\": pagesArray, \"orderType\": self.orderType, \"orderField\": self.orderField });\r\n        bizagi.util.formatInvariantDate(content, self.dateFormat);\r\n        self.$renderForm.html(content);\r\n\r\n        self.setUpPagination();\r\n        self.renderFormButtons(\"back\");\r\n    },\r\n\r\n    /**\r\n     * Set pagination\r\n     */\r\n    setUpPagination: function () {\r\n        var self = this;\r\n        var $pager = $(\"#biz-wp-usersadministration-pager ul\", self.content);\r\n\r\n        $pager.bizagiPagination({\r\n            maxElemShow: self.maxRows,\r\n            totalPages: self.totalPages,\r\n            actualPage: self.currentPage,\r\n            listElement: $pager,\r\n            clickCallBack: function (options) {\r\n                self.currentPage = parseInt(options.page);\r\n                self.getUsersLogData();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * get array for pages\r\n     */\r\n    getPagesArray: function () {\r\n        var self = this;\r\n        var pagesToShow = (self.maxPages > self.totalPages) ? self.totalPages : self.maxPages;\r\n        var aux = [];\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            aux.push(a + 1);\r\n        }\r\n\r\n        return aux;\r\n    },\r\n\r\n    /**\r\n     * Render form button\r\n     */\r\n    renderFormButtons: function (type) {\r\n        var self = this;\r\n        var tmpl = self.getTemplate(\"admin.users.formbuttons\");\r\n        var $button = $.tmpl(tmpl, { type: type, allowCreation: self.allowCreation });\r\n\r\n        if (type === \"query\") {\r\n            $(\"#bz-wp-widget-adminuser-usertable #users-table-buttonset\", self.content).append($button);\r\n        }\r\n        else {\r\n            self.$buttonsContainer.html($button);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Change form display\r\n     */\r\n    toggleForm: function (display) {\r\n        var self = this;\r\n\r\n        switch (display) {\r\n            case true:\r\n                self.$userTable.show();\r\n                self.$renderForm.hide();\r\n                break;\r\n            case false:\r\n                self.$userTable.hide();\r\n                self.$renderForm.show();\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Pages\r\n     */\r\n    getPages: function () {\r\n        var self = this;\r\n        var pagesToShow = (self.maxPages > self.totalPages) ? self.totalPages : self.maxPages;\r\n        var aux = [];\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            aux.push(a + 1);\r\n        }\r\n\r\n        return aux;\r\n    },\r\n\r\n    /**\r\n     * Render form\r\n     */\r\n    renderForm: function () {\r\n\r\n        var self = this;\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var renderContainer = self.$renderForm;\r\n            var rendering = new bizagi.rendering.facade();\r\n            var userId = self.userData.id || 0;\r\n            var action = (self.userData.id) ? \"edit\" : \"add\";\r\n            var params = self.getLoadFormParams(userId);\r\n\r\n            self.toggleForm(false);\r\n            self.removeButtons();\r\n\r\n            //request to queryForm definition service\r\n            self.dataService.getUsersForm(params).done(function (data) {\r\n                var renderingParams = { canvas: renderContainer, data: data, type: \"usersForm\", userId: userId, action: action };\r\n\r\n                rendering.execute(renderingParams).done(function () {\r\n                    self.userForm = rendering.form;\r\n\r\n                    self.userForm.bind(\"endUsersForm\", function (event, params) {\r\n                        self.performActionsAfterSave(params);\r\n                    });\r\n\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get load form params\r\n     */\r\n    getLoadFormParams: function (userId) {\r\n        var params = {\r\n            h_action: \"LOADUSERADMINFORM\",\r\n            h_contexttype: \"entity\"\r\n        };\r\n\r\n        if (userId) {\r\n            $.extend(params, {\r\n                h_xpathContext: \"@Context.Users[id == \" + userId + \"]\",\r\n                h_optionform: \"edit\"\r\n            });\r\n        }\r\n        else {\r\n            $.extend(params, { h_optionform: \"add\" });\r\n        }\r\n\r\n        return params;\r\n    },\r\n\r\n    /**\r\n     * Perform some actions after save\r\n     */\r\n    performActionsAfterSave: function (params) {\r\n\r\n        var self = this;\r\n        var userId = params.userId || self.userData.id;\r\n\r\n        if (params.sendMail) {\r\n            self.sendMail(userId, params.password);\r\n        }\r\n        \r\n        if (params.formAction === \"save\" || params.formAction === \"cancel\") {\r\n            if (typeof (self.usersTable) != \"undefined\") self.usersTable.afterSave = true;\r\n            $.when(self.queryUserPermissions()).done(function () {\r\n                self.usersTable.excecuteQuery();\r\n                self.showHideNewUser(self.allowCreation)\r\n                if (!params.error) {\r\n                    self.userForm.endLoading();\r\n                    self.returnToUserTable();\r\n                }\r\n\r\n            });\r\n        } else {\r\n            self.returnToUserTable();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sends the mail with password\r\n     */\r\n    sendMail: function (userId, password) {\r\n        var self = this;\r\n\r\n        self.dataService.generateDataToSendByEmail({idUser: userId}).done(function (response) {\r\n            self.showEmailPopup(response, password);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Generate Windows PopupContent email\r\n     */\r\n    showEmailPopup: function (messageResponse, password) {\r\n\r\n        var self = this;\r\n        var doc = window.document;\r\n\r\n        var template = self.getTemplate(\"admin.users.email\");\r\n\r\n        // Opens a dialog in order to upload Email\r\n        var dialogBoxEmail = self.dialogBoxEmail = $(\"<div class= admin-users-email/>\");\r\n        dialogBoxEmail.empty();\r\n        dialogBoxEmail.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttonsEmail = {};\r\n\r\n        buttonsEmail[self.getResource(\"workportal-widget-admin-users-button-label-send\")] = function () {\r\n\r\n            if ($(\"#txtTextTo\", dialogBoxEmail).val() !== \"\") {\r\n                // Select button Send\r\n                var params = {\r\n                    eMailTo: $(\"#txtTextTo\", dialogBoxEmail).val(),\r\n                    subject: $(\"#txtSubject\", dialogBoxEmail).val(),\r\n                    body: $(\"#txtBody\", dialogBoxEmail).val(),\r\n                    userSecret: password\r\n                };\r\n\r\n                $.when(self.dataService.sendUserEmail(params)).done(function (result) {\r\n                    self.closeUploadDialogEmail();\r\n                    var emailConfirmationMessage = bizagi.localization.getResource(\"workportal-widget-admin-users-Send-message\");\r\n\r\n                    if (result.logOff && result.logOff == \"false\")\r\n                        emailConfirmationMessage = bizagi.localization.getResource(\"workportal-widget-admin-users-Not-Send-message\");\r\n\r\n                    bizagi.showMessageBox(emailConfirmationMessage, \"Bizagi\", \"warning\");\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-empty-email-to\"), \"Bizagi\", \"warning\");\r\n            }\r\n\r\n\r\n        };\r\n\r\n        // Cancel button Send\r\n        buttonsEmail[self.getResource(\"workportal-widget-admin-users-button-label-notSend\")] = function () {\r\n            self.closeUploadDialogEmail();\r\n        };\r\n\r\n        // Render template\r\n        messageResponse.body = messageResponse.body.replace(/\\\\n/g, \"\\n\").replace(/\\\\/g, \"\");\r\n        $.tmpl(template, { messageResponse: messageResponse }).appendTo(dialogBoxEmail);\r\n        $(\".ui-bizagi-loading-message\").remove();\r\n\r\n        //Creates a dialog\r\n        dialogBoxEmail.dialog({\r\n            width: 500,\r\n            title: self.getResource(\"workportal-widget-admin-users-subtitle-email\"),\r\n            modal: true,\r\n            maximize: false,\r\n            resizable: false,\r\n            draggable: false,\r\n            buttons: buttonsEmail,\r\n            close: function () {\r\n                self.closeUploadDialogEmail();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            },\r\n            maximize: function(e){\r\n                if (self.userForm){\r\n                    self.userForm.triggerHandler(\"maximazedForm\");\r\n                }\r\n            },\r\n            unmaximize: function(e){\r\n                if (self.userForm){\r\n                    self.userForm.triggerHandler(\"unmaximazedForm\");\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    closeUploadDialogEmail: function () {\r\n        var self = this;\r\n        self.dialogBoxEmail.dialog(\"destroy\");\r\n        self.dialogBoxEmail.remove();\r\n    },\r\n\r\n    /**\r\n     * Download Report of User - GDPR\r\n     */\r\n    downloadReport: function () {\r\n        var self = this;\r\n        self.dataService.downloadReportUser(self.userData.id);\r\n    },\r\n\r\n    /**\r\n     * Anonymize User - GDPR\r\n     */\r\n    anonymize: function () {\r\n        var self = this;\r\n\r\n        var tmpl = self.getTemplate(\"admin.users.anonymize\");\r\n        var renderContainer = self.$renderForm;\r\n        self.toggleForm(false);\r\n\r\n        //Render anonymize\r\n        var descriptionTranslated = bizagi.localization.getResource(\"workportal-gdpr-anonymize-description-sure\").replaceAll('%s', self.userData.fullName);\r\n        var content = $.tmpl(tmpl, { \"descriptionTranslated\": descriptionTranslated });\r\n        self.$renderForm.html(content);\r\n\r\n        self.renderFormButtons(\"back\");\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Users Delegation\r\n*   Author: Ivan Ricardo Taimal\r\n*   Comments:\r\n*   -   This script renders the user delegation\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.usersDelegation\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n\r\n        var self = this;\r\n\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.userdelegation\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#ui-bizagi-workportal-widget-admin-userdelegation\"),\r\n            \"admin.userdelegationListTmpl\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#bz-wp-widget-userdelegation-configurations-tmpl\"),\r\n            \"admin.userdelegationDeleteConfirmationTmpl\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#bz-wp-widget-userdelegation-delete-confirmation-tmpl\"),\r\n            \"admin.userdelegationFormTmpl\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#bz-wp-widget-userdelegation-form-tmpl\"),\r\n            \"admin.userdelegationEmptyMessageTmpl\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#bz-wp-widget-userdelegation-configurations-message-tmpl\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var tmpl = self.getTemplate(\"admin.userdelegation\");\r\n        var content = self.content = $.tmpl(tmpl);\r\n        return content;\r\n    }\r\n});","/**\r\n* usersDelegation search users\r\n*\r\n* @author Ivan Ricardo Taimal\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.usersDelegation.searchUser\", {}, {\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION_SEARCH_USER;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () { },\r\n\r\n    /*\r\n    * childs will implement this method\r\n    */\r\n    loadtemplates: function () { }\r\n});","\r\n/**\r\n *   Name: BizAgi Workportal Users Delegation\r\n *   Author: Ivan Ricardo Taimal\r\n *   Comments:\r\n *   -   This script renders the users delegate per process\r\n */\r\nbizagi.workportal.widgets.admin.usersDelegation.extend(\"bizagi.workportal.widgets.admin.usersDelegation\", {}, {\r\n\r\n    /**\r\n     * To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxPages = 10;\r\n        self.maxRows = 10;\r\n        self.currentPage = 1;\r\n        self.showTable = true;\r\n        self.orderType = \"ASC\";\r\n        self.orderField = \"\";\r\n        self.dateFormat = self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\");\r\n        self.$delegationFormWrapper = $(\"#widget-userdelegation__form-wrapper\", self.content);\r\n        self.$DelegationListWrapper = $(\"#widget-userdelegation__configurations-wrapper\", self.content);\r\n\r\n        self.tableHeaders = [\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-process\"),\r\n                \"fieldValue\": \"processName\"\r\n            },\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-username\"),\r\n                \"fieldValue\": \"userName\"\r\n            },\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-delegatedname\"),\r\n                \"fieldValue\": \"delegatedName\"\r\n            },\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-init-date\"),\r\n                \"fieldValue\": \"startDate\"\r\n            },\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-end-date\"),\r\n                \"fieldValue\": \"endDate\"\r\n            }\r\n        ];\r\n        \r\n        self.renderDelegationForm(); // >> 1\r\n        self.initDelegationTable(); //  >> 3\r\n        self.addEventsHandler(); // >> 4\r\n        \r\n    },\r\n\r\n    /** >> 1\r\n     * renderDelegationForm\r\n     */\r\n    renderDelegationForm: function () {\r\n        var self = this;\r\n        var userdelegationFormTmpl = self.getTemplate(\"admin.userdelegationFormTmpl\");\r\n\r\n        $.tmpl(userdelegationFormTmpl, { currentUser: \"TestUser\" }).appendTo(self.$delegationFormWrapper);\r\n\r\n        var startDateWrapper = $(\"#widget-userdelegation__start-date\", self.content);\r\n        var endDateWrapper = $(\"#widget-userdelegation__end-date\", self.content);\r\n        var today = new Date();\r\n        startDateWrapper.datepicker({ minDate: today });\r\n        endDateWrapper.datepicker({ minDate: today });\r\n        self.configureProcessCombo();\r\n\r\n        $(\"#widget-userdelegation__start-date-btn\", self.content).click(function () {\r\n            startDateWrapper.datepicker(\"show\");\r\n        });\r\n        $(\"#widget-userdelegation__end-date-btn\", self.content).click(function () {\r\n            endDateWrapper.datepicker(\"show\");\r\n        });\r\n\r\n    },\r\n\r\n    // >> 1.1\r\n    configureProcessCombo: function () {\r\n        var self = this;\r\n        var params = {\r\n            idUser: bizagi.currentUser.idUser\r\n        };\r\n        $.when(self.dataService.getProcessToDelegate(params)).done(function (response) {\r\n            var processComboWrapper = $(\".widget-userdelegation__delegated-process-combo-wrapper\", self.content);\r\n            var comboDataSource = { combo: [], id: \"widget-userdelegation__process-to-delegate-combo\" };\r\n            comboDataSource.combo = comboDataSource.combo.concat(response.process);\r\n            processComboWrapper.empty();\r\n            self.processComponent = self.setupMultiselector(processComboWrapper, response.process);\r\n        });\r\n    },\r\n\r\n    /** >> 1.1.1\r\n     * Multiselector\r\n     */\r\n\r\n    setupMultiselector: function (element, options) {\r\n        var self = this;\r\n        var component = {\r\n            options: options,\r\n            element: element,\r\n            values: []\r\n        };\r\n\r\n        element.uicombo({\r\n            data: { combo: options },\r\n            isEditable: true,\r\n            isSearchable: true,\r\n            initValue: \"tetetet\",\r\n            itemValue: function (item) {\r\n                return item.id;\r\n            },\r\n            itemText: function (item) {\r\n                return item.displayName;\r\n            },\r\n            onComplete: function () {\r\n                var msgPlaceholder = bizagi.localization.getResource(\"workportal-widget-userdelegation-please-select-your-process\");\r\n                $(\".biz-wp-combo-input\", element).addClass(\"widget-user-delegation__multiselector-input\");\r\n                $(\".biz-wp-combo-input\").attr(\"placeholder\", msgPlaceholder);\r\n                element.prepend('<div class=\"widget-user-delegation__multiselector\"></div>');\r\n            },\r\n            onComboDropDown: function () {\r\n                self.markChoicesMultiselector(component);\r\n            },\r\n            onChange: function (obj) {\r\n                var inputText = obj.ui.val() || \"\";\r\n                var value = obj.ui.data(\"value\");\r\n                self.filterOptionsMultiselector(component, inputText);\r\n                self.addChoiceMultiselector(component, value, true);\r\n            }\r\n        });\r\n\r\n        return component;\r\n    },\r\n\r\n    // >> 1.1.1.1\r\n    markChoicesMultiselector: function (component) {\r\n        $(\"li\", component.element).removeClass(\"widget-user-delegation__multiselector__option--selected\");\r\n        $(\"li\", component.element).prepend('<i class=\"widget-user-delegation__multiselector__option__icon\"></i>');\r\n        $.each(component.values, function (index, value) {\r\n            $('li[data-value=\"' + value + '\"]', component.element).addClass(\"widget-user-delegation__multiselector__option--selected\");\r\n        });\r\n    },\r\n\r\n    // >> 1.1.1.2\r\n    filterOptionsMultiselector: function (component, inputText) {\r\n        var matches = component.options.filter(function (item) {\r\n            return item.displayName.toLowerCase().indexOf(inputText.toLowerCase()) == 0;\r\n        });\r\n        $(\"li\", component.element).hide();\r\n        $.each(matches, function (index, item) {\r\n            $('li[data-value=\"' + item.id + '\"]', component.element).show();\r\n        });\r\n    },\r\n\r\n    // >> 1.1.1.3\r\n    addChoiceMultiselector: function (component, value, editable) {\r\n        if (value) {\r\n            // var selectedOption = component.options.filter(function (item) {\r\n            var selectedOption = component.options.find(function (item) {\r\n                return item.id == value;\r\n            // })[0];\r\n            });\r\n            var displayName = selectedOption.displayName;\r\n            if (component.values.indexOf(value + \"\") === -1) {\r\n                var itemBody = '<div class=\"widget-user-delegation__multiselector__item\" data-value =' + value + \">\" + displayName + ' | <i class=\"widget-user-delegation__multiselector__item-clear-btn bz-icon bz-icon-close\"></i></div>';\r\n                $(\".widget-user-delegation__multiselector\", component.element).append(itemBody);\r\n                $(\".biz-wp-combo-input\", component.element).css({ \"box-shadow\": \"none\" });\r\n                $(\".widget-user-delegation__multiselector-input\", component.element).val(\"\");\r\n                component.values.push(value + \"\");\r\n\r\n                if (editable) {\r\n                    $(\".widget-user-delegation__multiselector__item-clear-btn\", component.element).click(function () {\r\n                        var itemToDelete = $(this).parent();\r\n                        var indexToRemove = component.values.indexOf((itemToDelete.data()).value + \"\");\r\n                        if (indexToRemove >= 0) {\r\n                            component.values.splice(indexToRemove, 1);\r\n                            itemToDelete.remove();\r\n                            if (component.values.length && component.values.length < 1) {\r\n                                $(\".biz-wp-combo\", component.element).show();\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /** >> 3\r\n     * Query Delegations\r\n     */\r\n    initDelegationTable: function (filterData) {\r\n        var self = this;\r\n        var params = filterData || {\r\n            pag: 1,\r\n            pagSize: self.maxRows\r\n        };\r\n        params.idUser = bizagi.currentUser.idUser;\r\n\r\n        var userdelegationListTmpl = self.getTemplate(\"admin.userdelegationListTmpl\");\r\n        \r\n        self.$DelegationListWrapper.html(\"\");\r\n        $.when(self.dataService.queryDelegations(params)).done(function (response) {\r\n            //render delegations table widget\r\n            if (response.delegations.length > 0) {\r\n\r\n                var pagination = (response.records > 1) ? true : false;\r\n                var totalPages = Math.ceil(response.records / self.maxRows);\r\n                var pagesArray = self.getPagesArray(totalPages);\r\n\r\n                $.tmpl(userdelegationListTmpl, {\r\n                    headers: self.tableHeaders,\r\n                    orderField: self.orderField,\r\n                    orderType: self.orderType,\r\n                    delegationList: response.delegations,\r\n                    page: response.page,\r\n                    pagination: pagination,\r\n                    pagesArray: pagesArray\r\n                }).appendTo(self.$DelegationListWrapper);\r\n                \r\n                self.setUpPagination(totalPages);\r\n                self.setUpSortColumnLinks();\r\n                $(\".widget-userdelegation__separator__btn-icon\", self.content).addClass(\"widget-userdelegation__separator__btn-icon--opened\");\r\n            }\r\n            else {\r\n                var userdelegationEmptyListTmpl = self.getTemplate(\"admin.userdelegationEmptyMessageTmpl\");\r\n                var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-empty-list-message\");\r\n                self.$DelegationListWrapper.html($.tmpl(userdelegationEmptyListTmpl, { message: msg }));\r\n            }\r\n\r\n            self.addTableEventsHandler();\r\n            self.delegatedAssignment = {\r\n                element: $(\"#widget-userdelegation__delegated-assignment-user\", self.content),\r\n                value: \"\"\r\n            };\r\n        });\r\n    },\r\n\r\n    /* >> 3.1\r\n     * Get Pages\r\n     */\r\n    getPagesArray: function (totalPages) {\r\n        var self = this;\r\n        var pagesToShow = (self.maxPages > totalPages) ? totalPages : self.maxPages;\r\n        var aux = [];\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            aux.push(a + 1);\r\n        }\r\n        return aux;\r\n    },\r\n\r\n    /* >> 3.2\r\n     * Set pagination\r\n     */\r\n    setUpPagination: function (totalPages) {\r\n        var self = this;\r\n        var $pager = $(\"#widget-userdelegation__delegation-list__table-pager ul\", self.content);\r\n\r\n        $pager.bizagiPagination({\r\n            maxElemShow: self.maxRows,\r\n            totalPages: totalPages,\r\n            actualPage: self.currentPage,\r\n            listElement: $pager,\r\n            clickCallBack: function (options) {\r\n                var filterData = {\r\n                    pag: self.currentPage = parseInt(options.page),\r\n                    pagSize: self.maxRows,\r\n                    orderField: self.orderField,\r\n                    orderType: self.orderType\r\n                };\r\n                self.initDelegationTable(filterData);\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /* >> 3.3\r\n     * assign click event to each column to order\r\n     */\r\n    setUpSortColumnLinks: function () {\r\n        var self = this;\r\n        $(\".biz-wp-table-head th\", self.content).click(function () {\r\n            self.orderField = $(this).data(\"orderfield\");\r\n            self.orderType = $(this).data(\"ordertype\") || self.orderType;\r\n            var filterData = {\r\n                orderType: self.orderType,\r\n                orderField: self.orderField,\r\n                pagSize: self.maxRows,\r\n                pag: self.currentPage\r\n            };\r\n            self.initDelegationTable(filterData);\r\n        });\r\n    },\r\n\r\n    // >> 3.4\r\n    addTableEventsHandler: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        //table edit-btn\r\n        $(\".widget-userdelegation__delegation-list__edit-btn\", self.content).click(function () {\r\n            self.selectedDelegation = $(this).parent().data();\r\n            self.delegatedAssignment.element.val(self.selectedDelegation.delegatedName);\r\n            self.delegatedAssignment.value = self.selectedDelegation.idDelegate;\r\n            $(\".biz-wp-combo\", self.processComponent.element).hide();\r\n            self.clearMultiselector(self.processComponent);\r\n\r\n            self.addChoiceMultiselector(self.processComponent, self.selectedDelegation.idProcess, false);\r\n            $(\".widget-userdelegation__delegated-assignment--edition\", self.content).show();\r\n            $(\".widget-userdelegation__delegated-assignment\", self.content).hide();\r\n            $(\".widget-userdelegation__delegated-assignment--edition__value\", self.content).text(self.selectedDelegation.delegatedName);\r\n            $(\"#widget-userdelegation__start-date\", self.content).datepicker(\"setDate\", new Date(Date.parse(self.selectedDelegation.startDate, \"MM/DD/YYYY\")));\r\n            $(\"#widget-userdelegation__end-date\", self.content).datepicker(\"setDate\", new Date(Date.parse(self.selectedDelegation.endDate, \"MM/DD/YYYY\")));\r\n            $(\".widget-user-delegation__multiselector__item-clear-btn\", self.content).hide();\r\n\r\n            $(\"#widget-userdelegation__delegated-startdate--edition\", self.content).show();\r\n            $(\".widget-userdelegation__delegated-startdate--edition__value\", self.content).text(self.selectedDelegation.startDate);\r\n            $(\"#widget-userdelegation__form-input_date_startdate\", self.content).hide();\r\n        });\r\n\r\n        $(\".widget-userdelegation__delegation-list__delete-btn\", self.content).click(function () {\r\n            var selectedDelegation = $(this).parent().data();\r\n            self.openDeleteConfirmation(selectedDelegation);\r\n        });\r\n\r\n        //separator button event\r\n        $(\".widget-userdelegation__separator__btn\", content).click(function () {\r\n            var delegationList = $(\".widget-userdelegation__delegation-list\", content);\r\n            self.showTable = !self.showTable;\r\n            if (self.showTable) {\r\n                $(\".widget-userdelegation__separator__btn-icon\", content).addClass(\"widget-userdelegation__separator__btn-icon--opened\");\r\n                delegationList.show();\r\n            } else {\r\n                $(\".widget-userdelegation__separator__btn-icon\", content).removeClass(\"widget-userdelegation__separator__btn-icon--opened\");\r\n                delegationList.hide();\r\n            }\r\n        });\r\n    },\r\n\r\n    // >> 3.4.1\r\n    openDeleteConfirmation: function (selectedDelegation) {\r\n        var self = this;\r\n        var deleteConfirmationDialog = $.tmpl(self.getTemplate(\"admin.userdelegationDeleteConfirmationTmpl\"), { delegation: selectedDelegation });\r\n        deleteConfirmationDialog.dialog({\r\n            resizable: false,\r\n            draggable: false,\r\n            height: \"auto\",\r\n            width: \"600px\",\r\n            modal: true,\r\n            title: selectedDelegation.processName,\r\n            maximize: false,\r\n            close: function () {\r\n                deleteConfirmationDialog.dialog(\"destroy\");\r\n                deleteConfirmationDialog.detach();\r\n            },\r\n            buttons: [\r\n                {\r\n                    text: self.getResource(\"workportal-general-button-label-ok\"),\r\n                    click: function () {\r\n                        $(this).dialog(\"destroy\");\r\n                        self.deleteDelegation(selectedDelegation);\r\n                    }\r\n                },\r\n                {\r\n                    text: self.getResource(\"workportal-widget-queries-confirm-cancel\"),\r\n                    click: function () {\r\n                        $(this).dialog(\"destroy\");\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    },\r\n\r\n    /** >> 3.4.1.1\r\n     * Delete configured delegation\r\n     */\r\n    deleteDelegation: function (params) {\r\n        var self = this;\r\n        $.when(self.dataService.deleteDelegation(params)).done(function (response) {\r\n            // console.log(response);//Todo: catch errors\r\n            self.initDelegationTable();\r\n        });\r\n    },\r\n\r\n    /** >> 4\r\n     * Events Handlers\r\n     */\r\n    addEventsHandler: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        //bread crumb 1\r\n        $(\".widget-userdelegation__bread-crumbs__link-1\", self.content).click(function () {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-1\");\r\n            $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n            $(\".widget-userdelegation__wrapper\", content).show();\r\n            $(\".widget-userdelegation__bread-crumbs\", content).hide();\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).html(\"\");\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).hide();\r\n        });\r\n\r\n        //bread crumb 2\r\n        $(\".widget-userdelegation__bread-crumbs__link-2\", self.content).click(function () {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-2\");\r\n            $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n            $(\".widget-userdelegation__wrapper\", content).hide();\r\n            $(\".widget-userdelegation__bread-crumbs\", content).show();\r\n            $(\".widget-userdelegation__bread-crumbs__link-3\", self.content).hide();\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).html(\"\");\r\n            self.setupUsersSearchForm(self.delegatedAssignment);\r\n        });\r\n\r\n        //Delegated assignment\r\n        $(\"#widget-userdelegation__delegated-assignment-user\", content).focus(function () {\r\n            self.setupUsersSearchForm(self.delegatedAssignment);\r\n        });\r\n        $(\"#widget-userdelegation__delegated-assignment-search-btn\", content).click(function () {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-2\");\r\n            $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n            self.setupUsersSearchForm(self.delegatedAssignment);\r\n        });\r\n        $(\"#widget-userdelegation__delegated-assignment-clear-btn\", content).click(function () {\r\n            $(\"#widget-userdelegation__delegated-assignment-user\", content).val(\"\");\r\n            self.delegatedAssignment.value = '';\r\n        });\r\n\r\n        $(\"#widget-userdelegation__new-assignment-save-btn\", content).click(function () {\r\n            if (self.selectedDelegation) {\r\n                self.updateDelegation();\r\n            } else {\r\n                self.saveDelegation();\r\n            }\r\n        });\r\n\r\n        $(\"#widget-userdelegation__new-assignment-clear-btn\", content).click(function () {\r\n            self.clearForm();\r\n        });\r\n    },\r\n\r\n    /** >> 4.1\r\n     * initialize the users search form widget\r\n     */\r\n    setupUsersSearchForm: function (params) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var def = $.Deferred();\r\n        $(\".widget-userdelegation__bread-crumbs\", content).show();\r\n        $(\".widget-userdelegation__wrapper\", content).hide();\r\n\r\n        $(\"#widget-userdelegation__getuser-wrapper\", content).show();\r\n        self.usersTable = new bizagi.workportal.widgets.admin.usersDelegation.searchUser(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#widget-userdelegation__getuser-wrapper\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-select-link\")],\r\n            parentDef: def\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).html(\"\");\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).hide();\r\n            params.element.val(userName);\r\n            params.value = userId;\r\n            $(\".widget-userdelegation__wrapper\", content).show();\r\n            $(\".widget-userdelegation__bread-crumbs\", content).hide();\r\n            $(\".widget-userdelegation__bread-crumbs li:last-child\", content).hide();\r\n\r\n        });\r\n    },\r\n\r\n    /** >> 4.2\r\n     * Update configured delegation\r\n     */\r\n    updateDelegation: function () {\r\n        var self = this;\r\n        var startDate = $(\"#widget-userdelegation__start-date\", self.content).datepicker(\"getDate\");\r\n        var endDate = $(\"#widget-userdelegation__end-date\", self.content).datepicker(\"getDate\");\r\n        var params = {\r\n            idDelegation: self.selectedDelegation.idDelegation,\r\n            idUser: bizagi.currentUser.idUser,\r\n            idDelegate: self.delegatedAssignment.value,\r\n            idsProcess: JSON.stringify(self.processComponent.values),\r\n            startDate: bizagi.util.dateFormatter.formatDate(startDate, \"yyyy-MM-dd\"),\r\n            endDate: bizagi.util.dateFormatter.formatDate(endDate, \"yyyy-MM-dd\"),\r\n            enableSub: 1\r\n        };\r\n        if (self.validateSaveUpdateParams(params)) {\r\n            $.when(self.dataService.updateDelegation(params)).done(function () {\r\n                self.clearForm();\r\n                self.initDelegationTable();\r\n                self.selectedDelegation = null;\r\n            }).fail(function (response) {\r\n                var arrayResult = response.responseJSON.messages;\r\n                var msgs = [];\r\n                for (var i = 0; i < arrayResult.length ; i++) {\r\n                    var arr = arrayResult[i][i].error;\r\n                    var messages = arrayResult[i][i].message;\r\n                    msgs.push(bizagi.localization.getResource(arr) + \" <br /> <b>\" + messages + \"</b> <br /> \");\r\n                }\r\n                $(\"#widget-userdelegation__assignation--error\", self.content).show();\r\n                $(\"#widget-userdelegation__assignation--error_value\", self.content).html(msgs.toString());\r\n            });\r\n        }\r\n    },\r\n\r\n    /** >> 4.3\r\n     * Save configured delegation\r\n     */\r\n    saveDelegation: function () {\r\n        var self = this;\r\n        var startDate = $(\"#widget-userdelegation__start-date\", self.content).datepicker(\"getDate\");\r\n        var endDate = $(\"#widget-userdelegation__end-date\", self.content).datepicker(\"getDate\");\r\n        var params = {\r\n            idUser: bizagi.currentUser.idUser,\r\n            idDelegate: self.delegatedAssignment.value,\r\n            idsProcess: JSON.stringify(self.processComponent.values),\r\n            startDate: bizagi.util.dateFormatter.formatDate(startDate, \"yyyy-MM-dd\"),\r\n            endDate: bizagi.util.dateFormatter.formatDate(endDate, \"yyyy-MM-dd\"),\r\n            enableSub: 1\r\n        };\r\n        if (self.validateSaveUpdateParams(params)) {\r\n            $.when(self.dataService.saveDelegation(params)).done(function () {\r\n                self.clearForm();\r\n                self.initDelegationTable();\r\n                self.selectedDelegation = null;\r\n            }).fail(function (response) {\r\n                var arrayResult = response.responseJSON.messages;\r\n                var msgs = [];\r\n                for (var i = 0; i < arrayResult.length ; i++) {\r\n                    var arr = arrayResult[i][i].error;\r\n                    var messages = arrayResult[i][i].message;\r\n                    msgs.push(bizagi.localization.getResource(arr) + \" <br /> <b>\" + messages + \"</b> <br /> \");\r\n                }\r\n                $(\"#widget-userdelegation__assignation--error\", self.content).show();\r\n                $(\"#widget-userdelegation__assignation--error_value\", self.content).html(msgs.toString());\r\n            });\r\n        }\r\n    },\r\n\r\n    // >> 4.3.1 - 4.2.1\r\n    validateSaveUpdateParams: function (params) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var startDate = new Date(Date.parse(params.startDate, \"MM/DD/YYYY HH:mm:ss\"));\r\n        var endDate = new Date(Date.parse(params.endDate, \"MM/DD/YYYY HH:mm:ss\"));\r\n        $(\"#widget-userdelegation__delegated-process-combo-alert\", content).hide();\r\n        $(\"#widget-userdelegation__delegated-assignment-user-alert\", content).hide();\r\n        $(\"#widget-userdelegation__start-date-alert\", content).hide();\r\n        $(\"#widget-userdelegation__end-date-alert\", content).hide();\r\n        $(\"#widget-userdelegation__delegation-period-alert\", content).hide();\r\n\r\n        if (params.idsProcess == \"[]\") {\r\n            $(\"#widget-userdelegation__delegated-process-combo-alert\", content).show();\r\n        }\r\n        ;\r\n        if (bizagi.util.isEmpty(params.idDelegate)) {\r\n            $(\"#widget-userdelegation__delegated-assignment-user-alert\", content).show();\r\n        }\r\n        if (!params.startDate) {\r\n            $(\"#widget-userdelegation__start-date-alert\", content).show();\r\n        }\r\n        if (!params.endDate) {\r\n            $(\"#widget-userdelegation__end-date-alert\", content).show();\r\n        }\r\n        if (endDate < startDate) {\r\n            $(\"#widget-userdelegation__delegation-period-alert\", content).show();\r\n        }\r\n\r\n        return params.idUser && params.idsProcess && !bizagi.util.isEmpty(params.idDelegate) && params.startDate && params.endDate && endDate >= startDate;\r\n    },\r\n\r\n    // >> 4.4\r\n    clearForm: function () {\r\n        var self = this;\r\n        self.clearMultiselector(self.processComponent);\r\n        self.delegatedAssignment.element.val(\"\");\r\n        $(\".biz-wp-combo\", self.processComponent.element).show();\r\n        $(\".workportal-widget-userdelegation__sub-delegation__checkbox\").prop(\"checked\", false);\r\n        $(\"#widget-userdelegation__process-to-delegate-combo\", self.content).val(\"\");\r\n        $(\"#widget-userdelegation__start-date\", self.content).val(\"\");\r\n        $(\"#widget-userdelegation__end-date\", self.content).val(\"\");\r\n        $(\"#widget-userdelegation__getuser-wrapper\", self.content).html(\"\");\r\n        $(\".widget-userdelegation__delegated-assignment--edition\", self.content).hide();\r\n        $(\".widget-userdelegation__delegated-assignment\", self.content).show();\r\n        $(\"#widget-userdelegation__delegated-startdate--edition\", self.content).hide();\r\n        $(\".widget-user-delegation__multiselector__item-clear-btn\", self.content).show();\r\n        $(\"#widget-userdelegation__form-input_date_startdate\", self.content).show();\r\n        $(\"#widget-userdelegation__assignation--error\", self.content).hide();\r\n    },\r\n\r\n    // >> 3.4.2 - 4.4.1\r\n    clearMultiselector: function (component) {\r\n        component.element.val(\"\");\r\n        $(\".widget-user-delegation__multiselector\", component.element).html(\"\");\r\n        component.values = [];\r\n    }\r\n\r\n});\r\n","/**\r\n * Name:\r\n *\r\n * @author Ivan Ricardo Taimal\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.usersDelegation.searchUser.extend(\"bizagi.workportal.widgets.admin.usersDelegation.searchUser\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.filterData = {};\r\n        self.maxRows = 8;\r\n        self.maxPages = 10;\r\n        self.$canvas = params.canvas;\r\n        self.users = [];\r\n        self.totalPages = 0;\r\n        self.currentPage = 1;\r\n        self.orderType = \"ASC\";\r\n        self.orderField = \"\";\r\n        self.tableHeaders = [\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-id\"), \"fieldValue\": \"idUser\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-user\"), \"fieldValue\": \"fullName\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-name\"), \"fieldValue\": \"userName\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-domain\"), \"fieldValue\": \"domain\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-email\"), \"fieldValue\": \"contactEmail\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-active-assign\"),\"fieldValue\": \"enabledForAssignation\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-active\"), \"fieldValue\": \"enabled\"}\r\n        ];\r\n\r\n        self.loadTemplates({\r\n            \"searchUser\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-tmpl\"),\r\n            \"searchUser.form\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-form-tmpl\"),\r\n            \"searchUser.message\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-message-tmpl\"),\r\n            \"searchUser.table.wrapper.final\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-table-wrapper-final-tmpl\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        bizagi.templateService.getTemplateWidget(\r\n            bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-table-final-tmpl\")\r\n        ).done(function (tmpl) {\r\n            self.tmpl[\"searchUser.table.final\"] = tmpl.markup;\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"searchUser\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //load templates\r\n        self.loadtemplates(); //  >> 1\r\n\r\n        //load form data\r\n        self.setupData(); // >> 2\r\n    },\r\n\r\n    /* >> 1\r\n     * Load template vars\r\n     */\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        self.usersTableFormTmpl = self.getTemplate(\"searchUser.form\");\r\n        self.usersTableMessage = self.getTemplate(\"searchUser.message\");\r\n        \r\n        self.usersTableTmpl = self.getTemplate(\"searchUser.table.wrapper.final\");\r\n        self.usersTableTmplFinal = self.getTemplate(\"searchUser.table.final\");\r\n    },\r\n\r\n    /* >> 2\r\n     * Setup form data\r\n     */\r\n    setupData: function () {\r\n        var self = this;\r\n        var resultTemplate = $.tmpl(self.usersTableFormTmpl, {});\r\n\r\n        var currentRoles = [];\r\n        var currentSkills = [];\r\n        var currentPositions = [];\r\n        var currentOrganizations = [];\r\n\r\n        $.when(self.dataService.getPreferencesCurrentUser()).done(function (data) {\r\n            currentRoles = data.sRoles || [];\r\n            currentSkills = data.sSkills || [];\r\n            currentPositions = data.sPositions || [];\r\n            currentOrganizations = data.sOrganizations || [];\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n        var locationDef = $.when(self.getValuesMultiple(\"LOCATION\"));\r\n\r\n        var roleDef = $.when(self.getValuesMultiple(\"ROLE\"));\r\n\r\n        var skillDef = $.when(self.getValuesMultiple(\"SKILL\"));\r\n\r\n        var organizationDef = $.when(self.getValuesMultiple(\"ORGPOSITION\"));\r\n\r\n        var positionDef = $.when(self.getValuesMultiple(\"ORG\"));\r\n\r\n\r\n\r\n        var deferreds = [locationDef, roleDef, skillDef, organizationDef, positionDef];\r\n\r\n        $.when.apply($, deferreds).then(function (allLocations, allRoles, allSkills, allPositions, allOrganizations) {\r\n            $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper\", self.content).html(\"\");\r\n            $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper\", self.content).html(resultTemplate);\r\n\r\n            self.locationsComponent = self.configureProcessCombo(allLocations);\r\n\r\n            var rolesWrapper = $(\"#widget-search-user__roles\");\r\n            self.rolesComponent = self.setupMultiselector(rolesWrapper, allRoles, currentRoles);\r\n\r\n            var skillsWrapper = $(\"#widget-search-user__skills\");\r\n            self.skillsComponent = self.setupMultiselector(skillsWrapper, allSkills, currentSkills);\r\n\r\n            var positionsWrapper = $(\"#widget-search-user__positions\");\r\n            self.positionsComponent = self.setupMultiselector(positionsWrapper, allPositions, currentPositions);\r\n\r\n            var organizationsWrapper = $(\"#widget-search-user__organizations\");\r\n            self.organizationsComponent = self.setupMultiselector(organizationsWrapper, allOrganizations, currentOrganizations);\r\n\r\n            self.setupEventsHandler();\r\n            self.$canvas.trigger(\"completeUserForm\");\r\n\r\n            $(\"#ui-bizagi-workportal-widget-search-user__backfilters-btn\", self.content).click(function () {\r\n                $(\".widget-userdelegation__bread-crumbs__link-1\").click();\r\n            });\r\n        });\r\n\r\n    },\r\n\r\n    // >> 2.1\r\n    getValuesMultiple: function (entity) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var params = '{\"select\":[{\"type\":\"Entity\",\"children\": [{\"type\":\"EntityValue\",\"data\":\"*\"}],\"data\":\"*\",\"where\":{\"name\":\"' + entity + '\"}}]}';\r\n        $.when(self.dataService.getValuesFromCQL(params)).done(function (data) {\r\n            var options = [];\r\n            if (data && data[0]) {\r\n                var guidRef = JSON.parse(data[0].content).displayAttribute.baref.ref;\r\n                $.each(data[0].children, function () {\r\n                    var idEntity = JSON.parse(this.content).idEntityValue;\r\n                    var fields = self.allKeysToUpperCase(JSON.parse(this.content).fields);\r\n                    var displayName = fields[guidRef.toUpperCase()];\r\n                    options.push({\"id\": idEntity, \"displayName\": displayName});\r\n                });\r\n                options.sort(function (a, b) { return (a.displayName > b.displayName) ? 1 : ((b.displayName > a.displayName) ? -1 : 0); });\r\n            }\r\n            defer.resolve(options);\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    // >> 2.1.1\r\n    allKeysToUpperCase: function (obj) {\r\n        var self = this;\r\n        var output = {};\r\n        for (var i in obj) {\r\n            if (Object.prototype.toString.apply(obj[i]) === \"[object Object]\") {\r\n                output[i.toUpperCase()] = self.allKeysToUpperCase(obj[i]);\r\n            } else {\r\n                output[i.toUpperCase()] = obj[i];\r\n            }\r\n        }\r\n        return output;\r\n    },\r\n\r\n    // >> 2.2\r\n    configureProcessCombo: function (options) {\r\n        var self = this;\r\n        var processComboWrapper = $(\"#widget-search-user__locations\", self.content);\r\n        var comboDataSource = { combo: [], id: \"widget-search-user__locations-to-delegate-combo\" };\r\n        comboDataSource.combo = comboDataSource.combo.concat(options);\r\n        processComboWrapper.empty();\r\n        processComboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.displayName;\r\n            },\r\n            onComplete: function () {\r\n            },\r\n            onChange: function (obj) {\r\n                var value = obj.ui.data(\"value\");\r\n                self.idProcess = value;\r\n                $(\".biz-wp-combo-input\", processComboWrapper).css({ \"box-shadow\": \"none\" });\r\n            }\r\n            //initValue: comboDataSource.combo[0]\r\n        });\r\n        return processComboWrapper;\r\n    },\r\n\r\n    /* >> 2.3\r\n     * Multiselector\r\n     */\r\n\r\n    setupMultiselector: function (element, options, current) {\r\n        var self = this;\r\n        var component = {\r\n            element: element,\r\n            options: options,\r\n            values: [],\r\n        };\r\n\r\n        //options.unshift({displayName: \" \", id: \"\"});\r\n        element.uicombo({\r\n            data: {combo: options},\r\n            // initValue: options[0],\r\n            itemValue: function (item) {\r\n                return item.id;\r\n            },\r\n            itemText: function (item) {\r\n                return item.displayName;\r\n            },\r\n            onComplete: function () {\r\n            },\r\n            onChange: function (obj) {\r\n                var value = obj.ui.data(\"value\");\r\n                component = self.addChoiceMultiselector(component, value);\r\n            },\r\n            onComboDropDown: function () {\r\n                self.markChoicesMultiselector(component);\r\n            }\r\n        });\r\n        $(\".biz-wp-combo-input\", element).addClass(\"widget-search-user__multiselector-input\");\r\n        $(element).prepend('<div class=\"widget-search-user__multiselector\"></div>');\r\n\r\n        $.each(current, function () {\r\n            component = self.addChoiceMultiselector(component, this.id);\r\n        });\r\n\r\n        return component;\r\n    },\r\n\r\n    // >> 2.3.1\r\n    addChoiceMultiselector: function (component, value) {\r\n        var selectedOption = component.options.filter(function (item) {\r\n            return item.id == value;\r\n        })[0];\r\n        if (component.values.indexOf(value + \"\") === -1 && selectedOption != null) {\r\n            var displayName = selectedOption.displayName;\r\n            $(\".widget-search-user__multiselector\", component.element).append('<div class=\"widget-search-user__multiselector__item\" data-value =' + value + \">\" + displayName + ' | <i class=\"widget-search-user__multiselector__item-clear-btn bz-icon bz-icon-close\"></i></div>');\r\n            $(\".biz-wp-combo-input\", component.element).css({ \"box-shadow\": \"none\", \"color\": \"white\" });\r\n            component.values.push(value + \"\");\r\n            $(\".widget-search-user__multiselector__item-clear-btn\", component.element).click(function () {\r\n                var itemToDelete = $(this).parent();\r\n                var indexToRemove = component.values.indexOf((itemToDelete.data()).value + \"\");\r\n                if (indexToRemove >= 0) {\r\n                    component.values.splice(indexToRemove, 1);\r\n                    itemToDelete.remove();\r\n                    if (component.values.length <= 0) {\r\n                        $(\".biz-wp-combo\", component.element).show();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return component;\r\n    },\r\n\r\n    // >> 2.3.2\r\n    markChoicesMultiselector: function (component) {\r\n        $(\"li\", component.element).removeClass(\"widget-search-user__multiselector__option--selected\");\r\n        $(\"li\", component.element).prepend('<i class=\"widget-search-user__multiselector__option__icon\"></i>');\r\n        $.each(component.values, function (index, value) {\r\n            $('li[data-value=\"' + value + '\"]', component.element).addClass(\"widget-search-user__multiselector__option--selected\");\r\n        });\r\n    },\r\n\r\n    /* >> 2.4\r\n     * Implement main buttons behaviour\r\n     */\r\n    setupEventsHandler: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var $userForm = $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper form\", content);\r\n\r\n        $userForm.on(\"submit\", function (e) {\r\n\r\n            e.preventDefault();\r\n\r\n            self.currentPage = 1;\r\n            self.orderType = \"ASC\";\r\n            self.orderField = \"\";\r\n            var localizationArray = [];\r\n            var localizationSelecction = $(this.elements[\"widget-search-user__locations-to-delegate-combo\"]).data(\"value\");\r\n            if (localizationSelecction != null && localizationSelecction != \"\") localizationArray.push(localizationSelecction);\r\n\r\n            self.filterData = {\r\n                domain: this.elements.domainInput.value,\r\n                userName: this.elements.userFullName.value,\r\n                fullName: this.elements.userNameReassignInput.value,\r\n                locations: JSON.stringify(localizationArray),\r\n                pag: self.currentPage,\r\n                pagSize: self.maxRows,\r\n                orderField: self.orderField,\r\n                orderType: self.orderType\r\n            };\r\n\r\n\r\n            self.getUsersTableData(\r\n                {\r\n                    idUser: bizagi.currentUser.idUser,\r\n                    organization: JSON.stringify(self.organizationsComponent.values),\r\n                    roles: JSON.stringify(self.rolesComponent.values),\r\n                    skills: JSON.stringify(self.skillsComponent.values),\r\n                    locations: JSON.stringify(localizationArray),\r\n                    positions: JSON.stringify(self.positionsComponent.values)\r\n                }\r\n            );\r\n\r\n        });\r\n        $userForm.on('keyup keypress', function(e) {\r\n            var keyCode = e.keyCode || e.which;\r\n            if (keyCode === 13) { \r\n              e.preventDefault();\r\n              $userForm.submit();\r\n              return false;\r\n            }\r\n          });\r\n\r\n        $userForm.on(\"reset\", function (event) {\r\n            event.preventDefault();\r\n            $(this.elements[\"widget-search-user__locations-to-delegate-combo\"]).data(\"value\", \"\").val(\"\");\r\n            this.elements.domainInput.value = \"\";\r\n            this.elements.userFullName.value = \"\";\r\n            this.elements.userNameReassignInput.value = \"\";\r\n\r\n            self.cleanForm();\r\n            $(\"#ui-bizagi-workportal-widget-search-user__list-wrapper\", content).empty();\r\n        });\r\n\r\n    },\r\n\r\n    /* >> 2.4.2\r\n     * Clean Form\r\n     */\r\n    cleanForm: function () {\r\n        var self = this;\r\n        $(\"#widget-search-user__locations\", self.content).val(\"\");\r\n        self.clearMultiselector(self.organizationsComponent);\r\n        self.clearMultiselector(self.rolesComponent);\r\n        self.clearMultiselector(self.skillsComponent);\r\n        self.clearMultiselector(self.positionsComponent);\r\n    },\r\n\r\n    // >> 2.4.2.1\r\n    clearMultiselector: function (component) {\r\n        component.element.val(\"\");\r\n        $(\".widget-search-user__multiselector\", component.element).html(\"\");\r\n        component.values = [];\r\n    },\r\n    \r\n\r\n    /* >> 2.4.1\r\n     * get users table data\r\n     */\r\n    getUsersTableData: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n        self.orderType = params.orderType || self.orderType;\r\n        self.orderField = params.orderField || self.orderField;\r\n\r\n        $.when(self.dataService.getUsersForDelegation($.extend(self.filterData, params))).done(function (data) {\r\n            self.showUsersTable(data);\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /* >> 2.4.1.1\r\n     * if users returned show the table\r\n     */\r\n    showUsersTable: function (data) {\r\n\r\n        var self = this;\r\n        self.users = data.users;\r\n\r\n        var $wrapperList = $(\"#ui-bizagi-workportal-widget-search-user__list-wrapper\", self.content);\r\n        var $wrapperForm = $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper\", self.content);\r\n        var $breadCrumbResults = $(\".widget-userdelegation__bread-crumbs li:last-child\");\r\n\r\n        if (self.users.length > 0) {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-3\");\r\n            $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n            \r\n            $wrapperList.empty();\r\n            $wrapperList.show();\r\n\r\n            var usersTableTmpl = $.tmpl(self.usersTableTmpl, {});\r\n            $wrapperList.html(usersTableTmpl);\r\n            self.tableFinal = new Vue({\r\n                el: $('#table',$wrapperList)[0],\r\n                template: self.usersTableTmplFinal,\r\n                data: {\r\n                    users: self.users,\r\n                    headers: self.tableHeaders,\r\n                    orderField: self.orderField,\r\n                    orderType: self.orderType,\r\n                    renderBooleanYes: self.getResource('render-boolean-yes'),\r\n                    renderBooleanNo: self.getResource('render-boolean-no'),\r\n                    selectedUser: ''\r\n                },\r\n                methods:{\r\n                    selectUser: function(userId){\r\n                        this.selectedUser = userId;\r\n                    }\r\n                }\r\n            });\r\n\r\n            $wrapperForm.hide();\r\n            $breadCrumbResults.show();\r\n            $(\"#ui-bizagi-workportal-widget-search-user__selected-btn\", self.content).click(function () {\r\n                if (self.tableFinal.selectedUser !== '') {\r\n                    var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-1\");\r\n                    $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n\r\n                    self.params.parentDef.resolve(self.tableFinal.selectedUser.idUser, self.tableFinal.selectedUser.userName);\r\n\r\n                    if (self.params.widgetName == \"usersDelegation\" && bizagi.workportal.desktop.dialogStack.length > 0){\r\n                        bizagi.workportal.desktop.dialogStack[bizagi.workportal.desktop.dialogStack.length - 1].dialogBox.on(\"dialogbeforeclose\", function () {\r\n                            // Next variable specifies if is redirecting to inbox when the result status does not have errors.\r\n                            if (self.resultStatus === true)\r\n                                self.publish(\"changeWidget\", {\r\n                                    widgetName: bizagi.workportal.currentInboxView\r\n                                });\r\n                        });\r\n                    }\r\n\r\n                    // Unbind an destroy\r\n                    self.tableFinal.$destroy();\r\n                    $(this).unbind(\"click\");\r\n                    $(\"#ui-bizagi-workportal-widget-search-user__back-btn\", self.content).unbind(\"click\");\r\n                } else {\r\n                    // THIS CODE DO NOTHING\r\n                    // publish excecutes twice when create a new instance of userstable\r\n                    self.$canvas.trigger(\"clickUserLink\", { id: this.id, name: this.name, type: $(this).data(\"linkname\") });\r\n                }\r\n            });\r\n            $(\"#ui-bizagi-workportal-widget-search-user__back-btn\", self.content).click(function () {\r\n                var $wrapperList = $(\"#ui-bizagi-workportal-widget-search-user__list-wrapper\", self.content);\r\n                var $wrapperForm = $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper\", self.content);\r\n                var $breadCrumbResults = $(\".widget-userdelegation__bread-crumbs li:last-child\");\r\n                var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-2\");\r\n                $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n                $wrapperList.empty();\r\n                $wrapperForm.show();\r\n                $wrapperList.hide();\r\n                $breadCrumbResults.hide();\r\n\r\n                // Unbind an destroy\r\n                self.tableFinal.$destroy();\r\n                $(this).unbind(\"click\");\r\n                $(\"#ui-bizagi-workportal-widget-search-user__selected-btn\", self.content).unbind(\"click\");\r\n            });\r\n        } else {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-usertable-empty\");\r\n            $(\".bz-wp-table-centermessage\", self.content).find('h3').text(msg);\r\n            setTimeout(function() {\r\n                $(\".bz-wp-table-centermessage\", self.content).find('h3').text('');\r\n            }, 3000);\r\n        }\r\n    },\r\n\r\n\r\n\r\n});","/**\r\n * Admin module to manage Holidays calendar\r\n *\r\n * @author Edward J Morales\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.holidays\", {}, {\r\n\t/*\r\n\t *   Returns the widget name\r\n\t */\r\n\tgetWidgetName: function() {\r\n\t\treturn bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS;\r\n\t},\r\n\r\n\r\n\tinit: function(workportalFacade, dataService, params) {\r\n\t\tvar self = this;\r\n\t\tself.holidaysObj = {\r\n\t\t\tcalendarSelector: null,\r\n\t\t\tactiveCalendar: \"\",\r\n\t\t\tschemas: [],\r\n\t\t\tschema: {},\r\n\t\t\tholidays: {},\r\n\t\t\tholidaysInServer: {}\r\n\t\t};\r\n\r\n\t\t// Call base\r\n\t\tself._super(workportalFacade, dataService, params);\r\n\r\n\t\t//Load templates\r\n\t\tself.loadTemplates({\r\n\t\t\t\"admin.holidays\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.holidays\").concat(\"#ui-bizagi-workportal-widget-admin-holidays\"),\r\n\t\t\t\"admin.holidays.calendar.schema\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.holidays\").concat(\"#ui-bizagi-workportal-widget-admin-holidays-calendar-schema\"),\r\n\t\t\tuseNewEngine: false\r\n\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t *   Renders the content for the current controller\r\n\t */\r\n\trenderContent: function() {\r\n\t\tvar self = this;\r\n\t\tvar template = self.getTemplate(\"admin.holidays\");\r\n\r\n\t\tvar content = self.content = $.tmpl(template);\r\n\r\n\t\treturn content;\r\n\t},\r\n\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\r\n\t\t$.when(self.dataService.getHolidaysSchemas()).done(function(holidays) {\r\n\t\t\tself.holidaysObj.schemas = holidays;\r\n\r\n\t\t\t$.each(holidays, function(key, value) {\r\n\t\t\t\tself.holidaysObj.schema[value.id] = {};\r\n\t\t\t});\r\n\t\t\tself.renderHolidaysSchema(holidays);\r\n\t\t}).fail(function(e) {\r\n\t\t\tconsole.log(\"ERROR\", e);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Get schemas Object\r\n\t * @param holidays\r\n\t * @return {[\"guid\": {} ]}\r\n\t * @private\r\n\t */\r\n\t_getSchemas: function(holidays) {\r\n\t\tholidays = holidays || [];\r\n\t\tvar result = {};\r\n\r\n\t\t$.each(holidays, function(key, value) {\r\n\t\t\tresult[value.id] = value;\r\n\t\t});\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/**\r\n\t * Get days by schema\r\n\t * @param guidSchema\r\n\t * @param schemaObj\r\n\t * @return [{guid:\"\", displayName:\"\", dates:[]}]\r\n\t * @private\r\n\t */\r\n\t_getDaysBySchema: function(guidSchema, schemaObj) {\r\n\t\tguidSchema = guidSchema || \"\";\r\n\t\tschemaObj = schemaObj || {};\r\n\t\t// Just if in the near future schemaObj change and its necessary apply a different algorithm\r\n\t\treturn schemaObj[guidSchema] || [];\r\n\t},\r\n\r\n\t_calendarHasChanges: function() {\r\n\t\tvar self = this;\r\n\t\tvar isModified = false;\r\n\t\tif(self.holidaysObj.activeCalendar != \"\" && self.holidaysObj.schema[self.holidaysObj.activeCalendar].modified) {\r\n\t\t\tisModified = true;\r\n\t\t}\r\n\t\treturn isModified;\r\n\t},\r\n\r\n\t_getChanges: function(schema) {\r\n\t\tvar self = this;\r\n\t\tvar deleted = [];\r\n\t\tvar added = [];\r\n\t\tvar actually = [];\r\n\r\n\t\tif(!schema) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar _searchDateInSchema = function(dateObj, schemaObj) {\r\n\t\t\tvar result = -1;\r\n\t\t\tdateObj = dateObj || new Date();\r\n\r\n\t\t\t$.each(schemaObj, function(key, value) {\r\n\t\t\t\tif(new Date(value.date).getTime() == dateObj.getTime()) {\r\n\t\t\t\t\tresult = key;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t};\r\n\r\n\t\tvar _getChanges = function(datesObjA, datesObjB, matchAction) {\r\n\t\t\tvar primaryAction = (matchAction == \"add\") ? added : deleted;\r\n\t\t\tvar inverseAction = (matchAction == \"add\") ? deleted : added;\r\n\t\t\t$.each(datesObjA, function(key, value) {\r\n\t\t\t\tvar searchIndex = _searchDateInSchema(new Date(value.date), datesObjB);\r\n\t\t\t\t// Check if its a new date\r\n\t\t\t\tif(searchIndex >= 0) {\r\n\t\t\t\t\tvar searchInActuallySchemaIndex = _searchDateInSchema(new Date(value.date), actually);\r\n\t\t\t\t\tif(searchInActuallySchemaIndex == -1) {\r\n\t\t\t\t\t\tactually.push(value);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Date does not change, check description\r\n\t\t\t\t\tif(datesObjB[searchIndex].description != value.description) {\r\n\t\t\t\t\t\tvar searchInSchemaToSaveIndex = _searchDateInSchema(new Date(datesObjB[searchIndex].date), inverseAction);\r\n                        if (searchInSchemaToSaveIndex == -1) {\r\n                            // secure format ISO8601\r\n                            datesObjB[searchIndex].date = self.formatDateStringToISO8601(datesObjB[searchIndex].date);\r\n                            value.date = self.formatDateStringToISO8601(value.date);\r\n\r\n                            inverseAction.push(datesObjB[searchIndex]);\r\n                            primaryAction.push(value);\r\n                        }\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n                    value.date = self.formatDateStringToISO8601(value.date);\r\n                    primaryAction.push(value);\r\n                    actually.push(value);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t\t_getChanges(self.holidaysObj.holidays[schema], self.holidaysObj.holidaysInServer[schema], \"add\");\r\n\t\t_getChanges(self.holidaysObj.holidaysInServer[schema], self.holidaysObj.holidays[schema], \"delete\");\r\n\r\n\t\treturn {delete: deleted, add: added, actually: actually};\r\n\t},\r\n\r\n    formatDateStringToISO8601: function(dateString){\r\n        var self = this;\r\n        if(!bizagi.util.dateFormatter.isFormatISO8601(dateString)){\r\n            dateString = self._formatDateFromInvariantToISO8601(dateString);\r\n        }\r\n        return dateString;\r\n    },\r\n\r\n\tsaveSchema: function(schema, saveFromModal) {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar $messageContainer = $(\".bz-ui-save-status\", content);\r\n\r\n\t\t$.when(self._saveSchema(schema, saveFromModal)).done(function() {\r\n\t\t\tself.showSuccess(bizagi.localization.getResource(\"workportal-general-success\"), $messageContainer);\r\n\t\t}).fail(function(error) {\r\n\t\t\tself.showError(bizagi.localization.getResource(\"workportal-general-error\")+ \" : \"+ error.toString(), $messageContainer);\r\n\t\t})\r\n\t},\r\n\r\n\t_saveSchema: function(schema, saveFromModal) {\r\n\t\tvar self = this;\r\n\t\tvar changes = self._getChanges(schema);\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar data = {\r\n\t\t\tadd: changes.add,\r\n\t\t\tdelete: changes.delete\r\n\t\t};\r\n\r\n\t\tself.holidaysObj.calendarSelector.startLoading({\r\n\t\t\toverlay: true\r\n\t\t});\r\n\t\t$.when(self.dataService.saveHolidaysBySchema({\r\n\t\t\tschema: schema,\r\n\t\t\tdata: JSON.encode(data)\r\n\t\t})).done(function(response) {\r\n\t\t\tself._resetSchemaChanges(schema);\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif(!saveFromModal){\r\n\t\t\t\tself._changeSchema(schema);\r\n\t\t\t\t}\r\n\t\t\t\tself.holidaysObj.calendarSelector.endLoading();\r\n\t\t\t\tdef.resolve();\r\n\t\t\t}, 1000);\r\n\t\t}).fail(function(e) {\r\n\t\t\tself.holidaysObj.calendarSelector.endLoading();\r\n\t\t\tdef.reject(e.toString());\r\n\t\t});\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\tshowError: function(error, $messageContainer) {\r\n\t\tvar $message = '<i class=\"bz-icon bz-icon-error\"></i>&nbsp; Error:' + error;\r\n\t\t$messageContainer.empty();\r\n\t\t$messageContainer.show();\r\n\t\t$messageContainer.removeClass(\"status-success\");\r\n\t\t$messageContainer.addClass(\"status-error\");\r\n\t\t$messageContainer.html($message);\r\n\t},\r\n\r\n\tshowSuccess: function(success, $messageContainer) {\r\n\t\tvar $message = '<i class=\"bz-icon bz-icon-test\"></i>&nbsp;' + success;\r\n\t\t$messageContainer.empty();\r\n\t\t$messageContainer.show();\r\n\t\t$messageContainer.removeClass(\"status-error\");\r\n\t\t$messageContainer.addClass(\"status-success\");\r\n\t\t$messageContainer.html($message);\r\n\t\twindow.setTimeout(function() {\r\n\t\t\t$messageContainer.fadeOut(600);\r\n\t\t}, 5000);\r\n\t},\r\n\r\n\t_resetSchemaChanges: function(schema) {\r\n\t\tif(schema) {\r\n\t\t\tvar self = this;\r\n\t\t\tself.holidaysObj.schema[schema].modified = false;\r\n\t\t\tself.holidaysObj.holidays[schema] = {};\r\n\t\t}\r\n\t},\r\n\r\n\r\n\trenderHolidaysSchema: function(holidaysObj) {\r\n\t\tholidaysObj = holidaysObj || [];\r\n\t\tvar self = this;\r\n\t\tvar template = self.getTemplate(\"admin.holidays.calendar.schema\");\r\n\t\tvar content = self.getContent();\r\n\t\tvar schemas = self._getSchemas(holidaysObj);\r\n\r\n\t\tvar result = $.tmpl(template, {\"schemas\": schemas});\r\n\t\tself.holidaysObj.calendarSelector = $(\"#biz-wp-admin-holidays-calendar\", result);\r\n\r\n\t\t$(\"#biz-wp-admin-holidays-schemas\").append(result);\r\n\r\n\t\tself.holidaysSchemaHandlers();\r\n\t\tself.renderHolidaysCalendar();\r\n\r\n\t\t// When the user clicks on save...\r\n\t\t$(\"[name='save']\", result).on(\"click\", function() {\r\n\t\t\t// If the calendar has changes save the changes...\r\n\t\t\tif(self._calendarHasChanges()) {\r\n\t\t\t\tself.saveSchema(self.holidaysObj.activeCalendar, false);\r\n\t\t\t} else { // If there is no changes show an alert\r\n\t\t\t\t// If the user has selected a calendar\r\n\t\t\t\tif (self.holidaysObj.activeCalendar) {\r\n\t\t\t\t\ttoastr.remove()\r\n\t\t\t\t\tbizagi.injector.get('notifier').showWarningMessage(\r\n\t\t\t\t\t\tbizagi.localization.getResource('workportal-admin-holidays-no-changes'));\r\n\t\t\t\t}\r\n\t\t\t\telse // the user doesn't selects a calendar\r\n\t\t\t\t\tconsole.log('There is no selected calendar');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(\"[name='cancel']\", result).on(\"click\", function() {\r\n\t\t\tself.params.dialogBox.dialog(\"close\");\r\n\t\t});\r\n\r\n\t\t$(\"button\", result).button();\r\n\t},\r\n\r\n\t_changeSchema: function(schema) {\r\n\t\tvar self = this;\r\n\t\tself.holidaysObj.activeCalendar = schema;\r\n\t\tif(schema == \"\") {\r\n\t\t\tself.renderHolidaysCalendar();\r\n\t\t} else {\r\n\t\t\tself.holidaysObj.calendarSelector.startLoading();\r\n\t\t\t$.when(self.dataService.getHolidaysBySchema({\"schema\": schema})).done(function(data) {\r\n\t\t\t\tself.holidaysObj.holidaysInServer[schema] = JSON.parse(JSON.encode(data));\r\n\t\t\t\tself.holidaysObj.holidays[schema] = data;\r\n\t\t\t\tself.renderHolidaysCalendar({\r\n\t\t\t\t\tdates: self.holidaysObj.holidays[schema] || []\r\n\t\t\t\t});\r\n\t\t\t}).always(function() {\r\n\t\t\t\tself.holidaysObj.calendarSelector.endLoading();\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\tholidaysSchemaHandlers: function() {\r\n\t\tvar self = this;\r\n\t\tvar $schemaSelector = $(\"#biz-wp-admin-holidays-schemas select\");\r\n\r\n\t\t$schemaSelector.change(function(e) {\r\n\t\t\tself.holidays = [];\r\n\t\t\tvar schema = e.currentTarget.value;\r\n\r\n\t\t\tif(self._calendarHasChanges()) {\r\n\t\t\t\t$.when(bizagi.showSaveBox(self.getResource(\"confirmation-savebox-message1\"), self.getResource(\"confirmation-box-title\"), \"warning\")).done(function() {\r\n\t\t\t\t\t$.when(self.saveSchema(self.holidaysObj.activeCalendar, true)).done(function(data) {\r\n\t\t\t\t\t\tself._changeSchema(schema);\r\n\t\t\t\t\t});\r\n\t\t\t\t}).fail(function(params) {\r\n\t\t\t\t\tself._resetSchemaChanges(self.holidaysObj.activeCalendar);\r\n\t\t\t\t\tself._changeSchema(schema);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself._changeSchema(schema);\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t},\r\n\r\n\trenderHolidaysCalendar: function(params) {\r\n\t\tparams = params || {};\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar dates = params.dates || [];\r\n\t\tvar calendar = $(\"#biz-wp-admin-holidays-calendar\", content);\r\n\t\tvar currentYear = new Date().getFullYear();\r\n\t\t//var selector = params.selector || $(\"#biz-wp-admin-holidays-calendar\");\r\n\t\tvar datePickerOptions = params.datePickerOptions || {};\r\n\t\tvar _datePickerOptions = $.extend({\r\n\t\t\tminDate: \"-5y\",\r\n\t\t\tmaxDate: \"+10y\",\r\n\t\t\tstepMonths: 12,\r\n\t\t\tnumberOfMonths: [3, 4],\r\n\t\t\tdefaultDate: \"1/1/\" + currentYear,\r\n            dateFormat: \"mm/dd/yy\",\r\n\t\t\tonSelect: function(dateText, inst) {\r\n\t\t\t\t_addOrRemoveDate(dateText);\r\n\t\t\t},\r\n\t\t\tbeforeShowDay: function(date) {\r\n\t\t\t\t// Calendar without schema\r\n\t\t\t\tif(self.holidaysObj && self.holidaysObj.activeCalendar == \"\") {\r\n\t\t\t\t\treturn [false, \"ui-datepicker-notselected\"];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar today = new Date();\r\n\t\t\t\tvar foundDate = _findDate(date);\r\n\t\t\t\tvar isEnabled = ( today.getTime() > new Date(date).getTime()) ? false : true;\r\n\t\t\t\tif(foundDate.position > -1) {\r\n\t\t\t\t\treturn [isEnabled, \"ui-datepicker-selected\", foundDate.description]\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn [isEnabled, \"ui-datepicker-notselected\",  bizagi.localization.getResource(\"workportal-general-no-selected\")];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, datePickerOptions);\r\n\r\n\t\tvar _findDate = function(date) {\r\n\t\t\tvar formatDate = \"yy/mm/dd\";\r\n\t\t\tfor(var i = 0, l = dates.length; i < l; i++) {\r\n\t\t\t\tvar dateArr = dates[i].date.split(\"T\");\r\n\t\t\t\tvar convertedDate = dateArr[0].replace(/-/g, \"/\");\r\n\t\t\t\tif($.datepicker.formatDate(formatDate, new Date(date)) == $.datepicker.formatDate(formatDate, new Date(convertedDate))) {\r\n\t\t\t\t    return {\r\n                        position: i,\r\n                        description: dates[i].description\r\n                    }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {position: -1, description: \"\"};\r\n\t\t};\r\n\r\n\t\tvar _addDate = function(dateObj) {\r\n\t\t\tdateObj.date = new Date(dateObj.date);\r\n\t\t\tdateObj.date.setHours(0);\r\n\t\t\tdateObj.date.setMinutes(0);\r\n\t\t\tdateObj.date.setSeconds(0);\r\n            dateObj.date = bizagi.util.dateFormatter.formatISO8601(dateObj.date, true);\r\n\r\n\t\t\tdates.push(dateObj);\r\n\t\t};\r\n\r\n\t\tvar _removeDate = function(index) {\r\n\t\t\tdates.splice(index, 1);\r\n\t\t};\r\n\r\n\t\t// Adds a date if we don't have it yet, else remove it\r\n\t\tvar _addOrRemoveDate = function(date) {\r\n\t\t\tvar foundDate = _findDate(date);\r\n\t\t\tif(foundDate.position > -1) {\r\n\t\t\t\t_removeDate(foundDate.position);\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_addDate({date: date, description: \"\"});\r\n\t\t\t}\r\n\t\t\tself.holidaysObj.schema[self.holidaysObj.activeCalendar].modified = true;\r\n\t\t};\r\n\r\n\t\t// Destroy previous calendar\r\n\t\tif(self.holidaysObj.calendarSelector.data(\"datepicker\")) {\r\n\t\t\tself.holidaysObj.calendarSelector.datepicker(\"destroy\");\r\n\t\t}\r\n\r\n\t\tself.holidaysObj.calendarSelector.datepicker(_datePickerOptions);\r\n\r\n\t},\r\n\r\n\t_showNotification: function(title, message, notificationType) {\r\n\t\tvar self = this;\r\n\t\tvar notification = new NotificationMessage(title, {\r\n\t\t\tbody: message,\r\n\t\t\ticonType: _NOTIFICATION_ICON_TYPE.CSS\r\n\t\t});\r\n\r\n\r\n\t\tnotification.onClick = function(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.close();\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\tself.publish(\"notification\", {notification: notification, type: notificationType});\r\n\r\n\t},\r\n\r\n    _formatDateFromInvariantToISO8601: function(dateStringInvariant){\r\n        var objDate = bizagi.util.dateFormatter.getDateFromInvariant(dateStringInvariant, false);\r\n        return bizagi.util.dateFormatter.formatISO8601(objDate, true);\r\n    }\r\n})\r\n;\r\n\r\n\r\n","/**\r\n * Admin module to manage Project Name\r\n *\r\n * @author Edward J Morales\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.projectName\", {}, {\r\n    /*\r\n\t *   Returns the widget name\r\n\t */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME;\r\n    },\r\n\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n       \r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.projectname\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.projectname\").concat(\"#ui-bizagi-workportal-widget-admin-projectname\"),\r\n         //   \"admin.holidays.calendar.schema\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.holidays\").concat(\"#ui-bizagi-workportal-widget-admin-holidays-calendar-schema\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n\t *   Renders the content for the current controller\r\n\t */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.projectname\");\r\n\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        $(\"button\",content).button();\r\n\r\n        return content;\r\n    },\r\n\r\n    showError: function(error,$messageContainer){\r\n            var $message = '<i class=\"bz-icon bz-icon-error\"></i>&nbsp; Error:'+error;\r\n        $messageContainer.empty();\r\n        $messageContainer.show();\r\n        $messageContainer.removeClass(\"status-success\");\r\n        $messageContainer.addClass(\"status-error\");\r\n        $messageContainer.html($message);\r\n    },\r\n\r\n    showSuccess: function(success,$messageContainer){\r\n        var $message = '<i class=\"bz-icon bz-icon-test\"></i>&nbsp;'+success;\r\n        $messageContainer.empty();\r\n        $messageContainer.show();\r\n        $messageContainer.removeClass(\"status-error\");\r\n        $messageContainer.addClass(\"status-success\");\r\n        $messageContainer.html($message);\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var $messageContainer = $(\".projectname-message-status\",content);\r\n\r\n        $(\"input\", content).on(\"keypress\", function(){\r\n           $messageContainer.hide();\r\n            if($(this).val().length >= 0){\r\n                $(\"input\", content).removeClass(\"status-error\");\r\n            }\r\n        });\r\n\r\n        $.when(self.dataService.getProjectName()).done(function (data) {\r\n            $(\"input\", content).val(data.projectName);\r\n        }).fail(function (e) {\r\n            console.log(\"ERROR\", e);\r\n        });\r\n\r\n        $(\"[name='cancel']\",content).on(\"click\", function(){\r\n            self.params.dialogBox.dialog(\"close\");\r\n        });\r\n\r\n        $(\"[name='save']\",content).on(\"click\", function(){\r\n           var projectName = $(\"input\", content).val();\r\n            $(content).startLoading({\r\n                overlay: true\r\n            });\r\n\r\n            if(projectName.length == 0){\r\n                $(\"input\", content).addClass(\"status-error\");\r\n                $(content).endLoading();\r\n                return\r\n            }\r\n\r\n            $.when(self.dataService.setProjectName(projectName)).done(function(response){\r\n                $(content).endLoading();\r\n                self.showSuccess(bizagi.localization.getResource(\"workportal-widget-admin-projectname-success\"), $messageContainer);\r\n            }).fail(function(error){\r\n                error.responseText = error.responseText || {\"message\":bizagi.localization.getResource(\"workportal-general-error\")};\r\n                var errorObj = JSON.parse(error.responseText);\r\n                console.log(\"Error:\",error);\r\n                $(content).endLoading();\r\n                self.showError(errorObj.message, $messageContainer);\r\n            })\r\n        });\r\n    }\r\n});","/*\r\n * Control to search users for Bizagi rendering\r\n * @author: Andrés fernando Muñoz\r\n */\r\n(function ($) {\r\n    $.fn.bizagiSearchUser = function (options) {\r\n        var self = this;\r\n        options = options || {};\r\n        var filterData = {};\r\n        var maxPages = 10;\r\n        var maxRows = 9;\r\n        var usersResults = [];\r\n        var currentPage = 1\r\n        var totalPages = 0;\r\n        var dBox = {};\r\n        var editingUser = options.editingUser;\r\n\r\n        var methods = {\r\n            \"init\":function(){\r\n                var filterData = {};\r\n                methods.bindElements();\r\n            },\r\n            \"bindElements\":function(){\r\n                self.click(function () {\r\n                    methods.openUploadDialog();\r\n                });\r\n            },\r\n            \"openUploadDialog\":function(){\r\n                var self = this;\r\n                var doc = window.document;\r\n                var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-search-user'/>\");\r\n                dBox = dialogBox.dialog({\r\n                    width: 950,\r\n                    maximize: false,\r\n                    resize: false,\r\n                    draggable: false,\r\n                    height: 650,\r\n                    title: options.title,\r\n                    modal: true\r\n                });\r\n                methods.showFilters();\r\n                methods.showButtons();\r\n                methods.addHandlers();\r\n            },\r\n            \"showFilters\":function(){\r\n                var filtersContainer = $(\"<div id='filtersContainer' class='filters-container clearfix'></div>\");\r\n                $.each(options.filters, function(index, value){\r\n                    $(filtersContainer, dBox).append(\"<div class='filters-row clearfix'><div class='filters-cell'><span>\" + options.displayNames[index] + \"</span></div><div class='filters-cell'><input id=\" + value + \" type='text'> </input></div></div>\");\r\n                });\r\n                filtersContainer.appendTo(dBox);\r\n            },\r\n            \"showButtons\":function(){\r\n                var buttonsContainer = $(\"<div id='buttonsContainer'class='biz-wp-buttonset'></div>\");\r\n                $(buttonsContainer,dBox).append(\"<button id='btnSearchUsers' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>\" + options.searchButtonName + \"</span></button>\");\r\n                $(buttonsContainer,dBox).append(\"<button id='btnClear' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>\" + options.clearButtonName + \"</span></button>\");\r\n\r\n                // Append new user Button\r\n                if (options.allowAddUser) {\r\n                    var newUserBtn =\r\n                        \"<button id='btnNew' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'>\" +\r\n                            \"<span class='ui-button-text'>\" +\r\n                                bizagi.localization.getResource(\"workportal-widget-admin-user-profiles-button-label-newUserProfiles\") +\r\n                            \"</span>\" +\r\n                        \"</button>\";\r\n\r\n                    $(buttonsContainer, dBox).append(newUserBtn);\r\n                    buttonsContainer.appendTo(dBox);\r\n\r\n                    $(\"#btnNew\", dBox).bizagiCreateUser(options.dataService, options.renderFactory, {\r\n                            canvas: $(dBox),\r\n                            onCreate: options.selectItem(),\r\n                            onCancel: function () {\r\n                                $(dBox).dialog('option', 'title', options.title);\r\n                                $(dBox).empty();\r\n\r\n                                methods.showFilters();\r\n                                methods.showButtons();\r\n                                methods.addHandlers();\r\n                            }\r\n                        }\r\n                    );\r\n                }\r\n                else {\r\n                    buttonsContainer.appendTo(dBox);\r\n                }\r\n            },\r\n            \"addHandlers\":function(){\r\n                $(\"#btnSearchUsers\", dBox).click(function() {\r\n                    methods.getUsersTableData();\r\n                 });\r\n\r\n                $(\"#btnClear\", dBox).click(function() {\r\n                    methods.clickClearPluginValues();\r\n                });\r\n                return this;\r\n            },\r\n            \"clickClearPluginValues\":function(){\r\n                $.each(options.filters, function(index, value){\r\n                    $('#'+value, dBox).val('');\r\n                });\r\n                $(\"#searchResults\", dBox).remove();\r\n            },\r\n            \"getUsersTableData\": function () {\r\n                var self = this;\r\n                methods.updateFiltersInformation();\r\n                var deferred = options.searchUsers(filterData);\r\n                $.when(deferred).done(function (data) {\r\n                    if (!Array.isArray(data.users)) {\r\n                        bizagi.showMessageBox(data.message, data.status, \"\", \"warning\");\r\n                        return;\r\n                    }\r\n                    usersResults = data.users;\r\n                    totalPages = data.total;\r\n                    methods.showUsersTable();\r\n                }).fail(function (error) {\r\n                    options.showError(error);\r\n                });\r\n            },\r\n            \"updateFiltersInformation\":function(){\r\n                $.each(options.filters, function(index, value){\r\n                    filterData[value] = $('#'+value,dBox).val();\r\n                });\r\n                filterData['pag'] = currentPage;\r\n                filterData['pagSize'] = maxRows;\r\n                if (typeof (editingUser) !== \"undefined\" && editingUser !== \"\") {\r\n                    filterData['editingUser'] = editingUser;\r\n                }\r\n            },\r\n            \"showUsersTable\": function () {\r\n                if (usersResults.length > 0) {\r\n                    var pagination = (totalPages > 1) ? true : false;\r\n                    var pagesArray = methods.getPagesArray();\r\n                    $(\"#searchResults\",dBox).remove();\r\n                    var usersTableTmpl = options.getTableTemplate(usersResults,currentPage,pagination,pagesArray);\r\n                    $(dBox).append(usersTableTmpl);\r\n                    methods.addTableHandlers();\r\n                    methods.setUpPagination();\r\n                } else {\r\n                    options.showMessageBox(\"workportal-widget-usertable-empty\");\r\n                    $(\"#searchResults\", dBox).remove();\r\n                }\r\n            },\r\n            \"addTableHandlers\":function(){\r\n                $('table :button', dBox).click(function () {\r\n                    var buttonSelf = $(this);\r\n                    var itemSelected = {};\r\n                    $.each(options.valuesToSelect, function(index, value){\r\n                        itemSelected[value] = buttonSelf.data(value);\r\n                    });\r\n                    var selItemDeferred = options.selectItem();\r\n                    selItemDeferred.resolve(itemSelected);\r\n                    dBox.remove();\r\n                })\r\n            },\r\n            \"getPagesArray\": function () {\r\n                var pagesToShow = (maxPages > totalPages) ? totalPages : maxPages;\r\n                var aux = [];\r\n                for (var a = 0; a < pagesToShow; a++) {\r\n                    aux.push(a + 1);\r\n                }\r\n                return aux;\r\n            },\r\n            \"setUpPagination\": function () {\r\n                var self = this;\r\n                var $pager = $(\"#biz-wp-userstable-pager ul\", dBox);\r\n                $pager.bizagiPagination({\r\n                    maxElemShow: maxRows,\r\n                    totalPages: totalPages,\r\n                    actualPage: currentPage,\r\n                    listElement: $pager,\r\n                    clickCallBack: function (options) {\r\n                        filterData.pag = currentPage = parseInt(options.page);\r\n                        self.getUsersTableData();\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        methods.init();\r\n        return methods;\r\n    }\r\n\r\n})(jQuery);\r\n","/**\r\n * Control to create users for Bizagi rendering\r\n * @author: Andr�s Felipe Arenas, Ricardo Alirio Perez\r\n */\r\n(function ($) {\r\n    $.fn.bizagiCreateUser = function (dataService, renderFactory, options) {\r\n        var self = this;\r\n        options = options || {};\r\n        var canvas = options.canvas;\r\n        onCreate = options.onCreate || function () {};\r\n        onCancel = options.onCancel || function () {};\r\n        displayName = bizagi.localization.getResource(\"workportal-widget-admin-user-profiles-button-label-newUserProfiles\");\r\n\r\n        var methods = {\r\n            \"init\": function() {\r\n                methods.addHandlers();\r\n            },\r\n            \"addHandlers\":function(){\r\n                self.on(\"click\", function () {\r\n                    methods.newUser();\r\n                });\r\n            },\r\n            \"newUser\":function(){\r\n                var self = this;\r\n                var params = {\"h_action\":\"LOADUSERADMINFORM\",\"h_contexttype\":\"entity\",\"h_optionform\":\"add\"};\r\n\r\n                canvas.empty();\r\n                $.tmpl(\"<div {{loading}}></div>\").appendTo(canvas);\r\n\r\n                dataService.getUsersForm(params).done(function (data) {\r\n                    var rendering = new bizagi.rendering.facade();\r\n                    var renderingParams = { canvas: canvas, data: data, type: \"usersForm\", userId: 0, action: \"add\" };\r\n\r\n                    canvas.dialog('option', 'title', displayName);\r\n                    rendering.execute(renderingParams).done(function (form) {\r\n                        rendering.form.bind(\"endUsersForm\", function (event, params) {\r\n                            if(typeof params.error === \"undefined\"){\r\n                                if (params.formAction === \"save\") {\r\n                                    if (params.sendMail) {\r\n                                        self.sendEmail(params.userId, params.password);\r\n                                    }\r\n                                    options.onCreate.resolve({iduser: params.userId, user: params.fullName});\r\n                                    canvas.remove();\r\n                                }\r\n                                else if (params.formAction === \"cancel\") {\r\n                                    options.onCancel();\r\n                                }\r\n                                form.endLoading();\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n            },\r\n            \"sendEmail\": function (userId, password) {\r\n                var self = this;\r\n                dataService.generateDataToSendByEmail({idUser: userId, password: password}).done(function (response) {\r\n                    self.showEmailPopup(response, password);\r\n                });\r\n            },\r\n            \"showEmailPopup\": function (messageResponse, password) {\r\n                var self = this;\r\n                var doc = window.document;\r\n                var template = renderFactory.getTemplate(\"render-user-email\");\r\n                var dialogBoxEmail = self.dialogBoxEmail = $(\"<div class= admin-users-email/>\");\r\n                var buttonsEmail = {};\r\n\r\n                dialogBoxEmail.empty();\r\n                dialogBoxEmail.appendTo(\"body\", doc);\r\n                // Define buttons\r\n                buttonsEmail[bizagi.localization.getResource(\"workportal-widget-admin-users-button-label-send\")] = function () {\r\n                    if ($(\"#txtTextTo\", dialogBoxEmail).val() != \"\") {\r\n                        // Select button Send\r\n                        var params = {\r\n                            eMailTo: $(\"#txtTextTo\", dialogBoxEmail).val(),\r\n                            subject: $(\"#txtSubject\", dialogBoxEmail).val(),\r\n                            body: $(\"#txtBody\", dialogBoxEmail).val(),\r\n                            userSecret: password\r\n                        };\r\n\r\n                        $.when(dataService.sendUserEmail(params)).done(function (result) {\r\n                            self.closeUploadDialogEmail();\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-Send-message\"), \"Bizagi\", \"warning\");\r\n                        });\r\n                    }\r\n                    else {\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-empty-email-to\"), \"Bizagi\", \"warning\");\r\n                    }\r\n                };\r\n                buttonsEmail[bizagi.localization.getResource(\"workportal-widget-admin-users-button-label-notSend\")] = function () {\r\n                    self.closeUploadDialogEmail();\r\n                };\r\n                //Creates a dialog\r\n                dialogBoxEmail.dialog({\r\n                    width: 500,\r\n                    height: 400,\r\n                    title: bizagi.localization.getResource(\"workportal-widget-admin-users-subtitle-email\"),\r\n                    modal: true,\r\n                    maximize: false,\r\n                    resizable: false,\r\n                    draggable: false,\r\n                    buttons: buttonsEmail,\r\n                    close: function () {\r\n                        self.closeUploadDialogEmail();\r\n                    },\r\n                    resizeStop: function (event, ui) {\r\n                        if (self.form) {\r\n                            self.form.resize(ui.size);\r\n                        }\r\n                    }\r\n                });\r\n                // Render template\r\n                messageResponse.body = messageResponse.body.replace(/\\\\n/g, \"\\n\").replace(/\\\\/g, \"\");\r\n                $.tmpl(template, { messageResponse: messageResponse }).appendTo(dialogBoxEmail);\r\n            },\r\n            \"closeUploadDialogEmail\": function () {\r\n                var self = this;\r\n                self.dialogBoxEmail.dialog('destroy');\r\n                self.dialogBoxEmail.remove();\r\n            }\r\n        };\r\n\r\n        methods.init();\r\n        return methods;\r\n    }\r\n\r\n})(jQuery);","/*\r\n *   Name: Bizagi Workportal Desktop Project Business Polices\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.polices\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"widgets-admin-business-polices\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.polices\").concat(\"#business-polices-wrapper\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var generalTmpl = self.getTemplate(\"widgets-admin-business-polices\");\r\n\r\n        self.content = generalTmpl.render({'build': bizagi.loader.build});\r\n        console.log('renderizar',self.content);\r\n        return self.content;\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.admin.business.polices\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.admin.business.polices]);","/**\r\n * Created by Ricardo Alirio Perez Diaz, Andres Felipe Arenas Vargas on 9/9/2015.\r\n */\r\n(function($) {\r\n    $.fn.simpleGrid = function (bizagiWidget, options) {\r\n\r\n        //---------------------------------------------------------\r\n        // Initial config\r\n        //---------------------------------------------------------\r\n\r\n        if (typeof bizagiWidget === 'undefined') {\r\n            throw \"Debe pasar como parametro el widget de bizagi, para la carga del template\";\r\n        }\r\n        var self = this;\r\n        var settings = $.extend({\r\n            allowAdd: false,\r\n            allowEdit: false,\r\n            allowDelete: false,\r\n            displayName: '',\r\n            dateFormat: bizagi.localization.getResource(\"dateFormat\"),\r\n            filters: [],\r\n            maxPageToShow: 5,\r\n            orderType: 'ASC',\r\n            orderField : '',\r\n            orderEnabled : true,\r\n            page : 1,\r\n            pageSize: 10,\r\n            onDataBinding: function () {},\r\n            onFilterChanged: function () {},\r\n            onPageChanging: function () {},\r\n            onLoadFilter: function () {},\r\n            onAdd: function () {},\r\n            onEdit: function () {},\r\n            getResource: function () {}\r\n        }, options);\r\n        self.grid = {\r\n            internalData: {}\r\n        };\r\n\r\n        var simpleGrid = {\r\n            render: renderGrid\r\n        };\r\n\r\n        //---------------------------------------------------------\r\n        // Constructor\r\n        //---------------------------------------------------------\r\n\r\n        (function (){\r\n            self.initialized = bizagiWidget.loadTemplates({\r\n                \"bizagi.simpleGrid.wrapper\": bizagi.getTemplate(\"bizagi.simpleGrid\").concat(\"#ui-bizagi-widget-simple-grid\"),\r\n                \"bizagi.simpleGrid.content\": bizagi.getTemplate(\"bizagi.simpleGrid\").concat(\"#ui-bizagi-widget-simple-grid-content\"),\r\n                \"bizagi.simpleGrid.paginator\": bizagi.getTemplate(\"bizagi.simpleGrid\").concat(\"#ui-bizagi-widget-simple-grid-paginator\"),\r\n                \"filter-wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-wrapper\"),\r\n                \"filter-string\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-control-string\"),\r\n                \"filter-number\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-control-number\"),\r\n                \"filter-date\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-control-date\"),\r\n                \"filter-boolean\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-control-boolean\"),\r\n                useNewEngine: false\r\n            }).then(function () {\r\n                self.panelWrapper = bizagiWidget.getTemplate(\"bizagi.simpleGrid.wrapper\");\r\n                self.panelContent = bizagiWidget.getTemplate(\"bizagi.simpleGrid.content\");\r\n                self.panelPaginator = bizagiWidget.getTemplate(\"bizagi.simpleGrid.paginator\");\r\n            });\r\n\r\n        })();\r\n\r\n        //---------------------------------------------------------\r\n        // Methods\r\n        //---------------------------------------------------------\r\n\r\n        /**\r\n         *\r\n         */\r\n        function renderGrid() {\r\n            self.empty();\r\n            $.when(self.initialized).done(function () {\r\n                var params = [{\r\n                    pag: settings.page,\r\n                    pagSize: settings.pageSize,\r\n                    orderType: settings.orderType,\r\n                    orderField: settings.orderField,\r\n                    filters: mapFilters(settings.filters)\r\n                }];\r\n                var numRequest = self.data(\"numRequest\");\r\n                self.data(\"numRequest\", numRequest ? numRequest += 1 : 1);\r\n                if (typeof (self.prev) != \"undefined\" && typeof (settings) != \"undefined\") {\r\n                    $('option:selected', self.prev()).data(\"orderField\", settings.orderField);\r\n                    $('option:selected', self.prev()).data(\"orderType\", settings.orderType);\r\n                    $('option:selected', self.prev()).data(\"filters\", settings.filters);\r\n                }\r\n                numRequest = self.data(\"numRequest\");\r\n\r\n                $.when(settings.onDataBinding.apply(self.get(0), params)).done($.proxy(function(data){\r\n                    if(numRequest === self.data(\"numRequest\")){\r\n                        //Add grid wrapper\r\n                        self.append($.tmpl(self.panelWrapper));\r\n                        //keep in track the total records and pages\r\n                        self.grid.totalRecords = data.records;\r\n                        self.grid.totalPages = data.total;\r\n                        showRowsEntity(data);\r\n                        if (data.records > settings.pageSize) {\r\n                            self.grid.page = data.page;\r\n                            renderPagintation();\r\n                        }\r\n                    }\r\n\r\n                }, numRequest));\r\n            });\r\n        }\r\n\r\n        function mapFilters(filters){\r\n            var auxFilters = Object.keys(filters).map(function (key) {\r\n                return filters[key];\r\n            });\r\n\r\n            return auxFilters.filter(function(filterObject){\r\n                if(filterObject.key === \"is-null\" || (filterObject.key !== \"is-null\" && typeof filterObject.value !== \"undefined\" && filterObject.value !== null ) ){\r\n                    return true;\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @param data\r\n         */\r\n        function showRowsEntity(data) {\r\n            var rows =  data.row || [];            \r\n            rows = rows.map(function(row){\r\n                row = row || [];\r\n                return row.map(function(value){\r\n                    if (typeof value === \"object\" && value !== null){\r\n                        var result = value.label;\r\n                        if (value.additionallabel){ result += ', ' + value.additionallabel; }   \r\n                        return result;      \r\n                    } else if (value === null){\r\n                        return \"\";\r\n                    }\r\n                    return value;\r\n                });\r\n            });\r\n\r\n            var $resultTableContent = $(\".ui-bizagi-simple-grid-wrapper\", self).html(\r\n                $.tmpl(self.panelContent, {\r\n                    displayName: settings.displayName,\r\n                    headers: data.header,\r\n                    rows: rows,\r\n                    orderType: settings.orderType,\r\n                    orderField: settings.orderField,\r\n                    orderEnabled: settings.orderEnabled,\r\n                    guidForms: data.entity,\r\n                    allowAdd: settings.allowAdd,\r\n                    allowEdit: settings.allowEdit,\r\n                    allowDelete: settings.allowDelete,\r\n                    filterApplied: settings.filters,\r\n                    attributeSupportFilter: attributeSupportFilter,\r\n                    attributeSupportOrder:attributeSupportOrder\r\n                }));\r\n\r\n            formatTableEntity($resultTableContent);\r\n            setFilters($resultTableContent, data.header);\r\n            var idSelected = $(\"option:selected\", self.prev()).data(\"idRowSelected\");\r\n            if (typeof (idSelected) != \"undefined\") {\r\n                var selectedRow = $(\"tr[data-idrowentity='\" + idSelected + \"']\", $resultTableContent);\r\n                selectedRow.addClass('ui-bizagi-state-selected');\r\n                self.elementSelected = selectedRow;\r\n            }\r\n        }\r\n        /**\r\n         *\r\n         */\r\n        function renderPagintation() {\r\n            var pageToshow = (settings.maxPageToShow > self.grid.totalPages) ?  self.grid.totalPages : settings.maxPageToShow;\r\n            var summaryWrapper = $(\".bz-rn-grid-footer-pagination\", self);\r\n            var pagerData = {\r\n                pagination: (self.grid.totalPages > 1),\r\n                page: self.grid.page,\r\n                pages: {}\r\n            };\r\n\r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pagerData[\"pages\"][i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n            //load and append the paginator to the result table\r\n            summaryWrapper.append($.tmpl(self.panelPaginator, pagerData));\r\n            //add data and behaviour to pager\r\n            $(\"ul#bz-widget-simple-grid-pager-wrapper\", self).bizagiPagination({\r\n                totalPages: self.grid.totalPages,\r\n                actualPage: self.grid.page,\r\n                listElement: $(\"#biz-wp-table-pager-wrapper\"),\r\n                clickCallBack: function (options) {\r\n                    settings.onPageChanging.apply(self, new Array(settings.page, options.page))\r\n                    settings.page = options.page;\r\n                    renderGrid();\r\n                }\r\n            });\r\n        }\r\n        /**\r\n         * format colums of the table\r\n         * @param $resultTableContent\r\n         */\r\n        function formatTableEntity($resultTableContent) {\r\n            var bigIntHeaders = $(\"a[data-type='1']\", $resultTableContent);\r\n            var intHeaders = $(\"a[data-type='2'][data-attributeType='2']\", $resultTableContent);\r\n            var smallIntHeaders = $(\"a[data-type='3']\", $resultTableContent);\r\n            //var fileHeaders = $(\"a[data-type='4']\", $resultTableContent);\r\n            var tinyIntHeaders = $(\"a[data-type='4']\", $resultTableContent);\r\n            var booleanHeaders = $(\"a[data-type='5']\", $resultTableContent);\r\n            var decimalHeaders = $(\"a[data-type='6']\", $resultTableContent);\r\n            var numericHeaders = $(\"a[data-type='7']\", $resultTableContent);\r\n            var moneyHeaders = $(\"a[data-type='8']\", $resultTableContent);\r\n            var floatHeaders = $(\"a[data-type='10']\", $resultTableContent);\r\n            var realHeaders = $(\"a[data-type='11']\", $resultTableContent);\r\n            var dateTimeHeaders = $(\"a[data-type='12']\", $resultTableContent);\r\n            var scientificNotationHeaders = $(\"a[data-type='29']\", $resultTableContent);\r\n            var userLocalization = (typeof (bizagi.currentUser.symbol) != \"undefined\") ? bizagi.currentUser : settings.getResource(\"numericFormat\");\r\n            var userLocalizationCloned = bizagi.clone(userLocalization);\r\n            userLocalizationCloned.decimalDigits = 0;\r\n\r\n            //\r\n            $.each(dateTimeHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\").find(\"span:contains(':')\").addClass(\"formatDate\");\r\n                }\r\n            });\r\n            bizagi.util.formatInvariantDate($resultTableContent, settings.dateFormat);\r\n            //\r\n            $.each(moneyHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    var allowDecimals = item.getAttribute(\"data-allowdecimals\") ? bizagi.util.parseBoolean(item.getAttribute(\"data-allowdecimals\")) : true;\r\n                    item.setAttribute(\"data-allowdecimals\", allowDecimals);\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    var formatNumber = getFormatNumber(item, userLocalizationCloned);\r\n                    var showSymbol = bizagi.util.parseBoolean(item.getAttribute('data-showsymbol'));\r\n\r\n                    //If showSymbol is undefined, show symbol by default\r\n                    if(showSymbol === null || showSymbol){\r\n                        formatNumber.symbol = (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : userLocalizationCloned.symbol);\r\n                    }\r\n                    else{\r\n                        formatNumber.symbol = \"\";\r\n                    }\r\n\r\n                    bizagi.util.formatInvariantMoney($column, formatNumber);\r\n                }\r\n            });\r\n            //\r\n            $.each(floatHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    var allowDecimals = item.getAttribute(\"data-allowdecimals\") ? bizagi.util.parseBoolean(item.getAttribute(\"data-allowdecimals\")) : true;\r\n                    item.setAttribute(\"data-allowdecimals\", allowDecimals);\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    var formatNumber = getFormatNumber(item, userLocalizationCloned);\r\n                    if(formatNumber.allowDecimals && formatNumber.decimalDigits === 0){\r\n                        //extract from render\\bizagi.rendering.number.js\r\n                        formatNumber.decimalDigits = (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2);\r\n                    }\r\n                    bizagi.util.formatInvariantNumber($column, formatNumber);\r\n                }\r\n            });\r\n            //\r\n            $.each(decimalHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(realHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    var formatNumber = getFormatNumber(item, userLocalizationCloned);\r\n                    if(formatNumber.allowDecimals && formatNumber.decimalDigits === 0){\r\n                        //extract from render\\bizagi.rendering.number.js\r\n                        formatNumber.decimalDigits = (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2);\r\n                    }\r\n                    bizagi.util.formatInvariantNumber($column, formatNumber);\r\n                }\r\n            });\r\n            $.each(bigIntHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(intHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(smallIntHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(tinyIntHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(numericHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(booleanHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var valuesBoolean = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\").find(\"span\");\r\n                    if (index > 0)\r\n                        $.each(valuesBoolean, function (j, itemBoolean) {\r\n                            var contentBoolean = $.trim($(itemBoolean).text()).toLowerCase();\r\n                            if (contentBoolean === 'true' || contentBoolean === '1') {\r\n                                $(itemBoolean).text('X');\r\n                            }\r\n\r\n                            if (contentBoolean === 'false' || contentBoolean === '0') {\r\n                                $(itemBoolean).text('');\r\n                            }\r\n                        });\r\n                }\r\n            });\r\n            //\r\n            $.each(scientificNotationHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var oracleNumberList = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\").find(\"span\");\r\n                    $.each(oracleNumberList, function (j, numberItem) {\r\n                        var number = $.trim($(numberItem).text());\r\n                        $(numberItem).text(bizagi.util.scientificNotationFormat(number));\r\n                    });\r\n                }\r\n            });\r\n\r\n            /*if (fileHeaders.length > 0) {\r\n                for (var i = 0; i < fileHeaders.length; i++) {\r\n                    var indexFile = Number($(fileHeaders[i]).attr('data-index'));\r\n                    var valuesFile = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + indexFile + \")\").find(\"span\");\r\n                    $.each(valuesFile, function (j, itemFile) {\r\n                        var val = $(itemFile).text();\r\n                        if (val === \"true\" || val === \"false\") {\r\n                            $(itemFile).text('...');\r\n                        }\r\n                    });\r\n                }\r\n            }*/\r\n            //hide de first column if the user created display form\r\n            if ($(\"a[data-type='-11']\").length > 0) {\r\n                $('.admin-entities-rightframe #detailEntity table.ui-bizagi-grid-table td:nth-child(1)').css('display', 'none');\r\n                $('.admin-entities-rightframe #detailEntity table.ui-bizagi-grid-table th:nth-child(1)').css('display', 'none');\r\n            }\r\n            configureHandlers($resultTableContent);\r\n        }\r\n        /**\r\n         * Apply filter's plugin to headers in the table\r\n         * @param $resultTableContent\r\n         * @param headers\r\n         */\r\n        function setFilters($resultTableContent, headers) {\r\n            var filters = settings.filters;\r\n            var $columnFilters = $resultTableContent.find('.ui-bizagi-grid-header .ui-bizagi-render-icon-filter');\r\n\r\n            $.each($columnFilters, function (_, element) {\r\n                var $element = $(element),\r\n                    $parent = $element.parent(),\r\n                    index = $element.data('index'),\r\n                    header = headers[index];\r\n\r\n                if (attributeSupportFilter(header)) {\r\n                    (function (header) {\r\n                        var fieldValue = header.fieldValue;\r\n\r\n                        //\r\n                        $element.bizagi_filters({\r\n                            guidAttribute: header.guidAttribute,\r\n                            type: header.dataType,\r\n                            attributeType: header.attributeType,\r\n                            parent: $parent,\r\n                            templates: {\r\n                                filterWrapper: bizagiWidget.getTemplate(\"filter-wrapper\"),\r\n                                filterString: bizagiWidget.getTemplate(\"filter-string\"),\r\n                                filterNumber: bizagiWidget.getTemplate(\"filter-number\"),\r\n                                filterDate: bizagiWidget.getTemplate(\"filter-date\"),\r\n                                filterBoolean: bizagiWidget.getTemplate(\"filter-boolean\")\r\n                            },\r\n                            data: filters[fieldValue],\r\n                            attribute: header.guidAttribute,\r\n                            entity: header.relatedEntity,\r\n                            dataService: {\r\n                                getAdminEntityData: function (params) {\r\n                                    return $.when(self.grid.internalData[fieldValue] || settings.onLoadFilter.apply(settings, new Array($.extend(params, {type: \"Entity\"}))))\r\n                                        .then(function (entityData) {\r\n                                            self.grid.internalData[fieldValue] = entityData;\r\n                                            return entityData;\r\n                                        });\r\n                                }\r\n                            }\r\n                        });\r\n                        //\r\n                        $element.on('bizagi_filterschange', function (ev, value) {\r\n                            if ($.isEmptyObject(value)) {\r\n                                delete filters[fieldValue];\r\n                            }\r\n                            else {\r\n                                value.dataType = header.dataType;\r\n                                value.field = fieldValue;\r\n                                if (typeof header.relatedEntity !== \"undefined\") {\r\n                                    value.entity = header.relatedEntity;\r\n                                }\r\n                                filters[fieldValue] = value;\r\n                            }\r\n                            settings.onFilterChanged.apply(self);\r\n                            renderGrid();\r\n                        });\r\n                        // Change the icon when there is a filter applied\r\n                        if (filters[fieldValue]) {\r\n                            $element.addClass('ui-bizagi-column-filter-applied');\r\n                        }\r\n                    })(header);\r\n                }\r\n            });\r\n        }\r\n        /**\r\n         * Manage button edit row entities or add row\r\n         * @param $resultTableContent\r\n         */\r\n        function configureHandlers($resultTableContent) {\r\n            // Sort entities listener\r\n            if(settings.orderEnabled){\r\n                $(\".link-order-entity\", $resultTableContent).click(function () {\r\n                    settings.orderField = $(this).attr('data-columnOrderField');\r\n                    settings.orderType = $(this).attr('data-orderType');\r\n                    if (settings.orderField !== \"dsbl\") {\r\n                        renderGrid();\r\n                    }\r\n                });\r\n            }\r\n            //Select entity listener\r\n            $(\".ui-bizagi-grid-body tr\", $resultTableContent).click(function () {\r\n                if ($(this).attr('class') === 'ui-bizagi-state-selected') {\r\n                    $(this).removeClass('ui-bizagi-state-selected');\r\n                    self.elementSelected = null;\r\n                    $('option:selected', self.prev()).removeData(\"idRowSelected\");\r\n                }\r\n                else {\r\n                    $('.ui-bizagi-grid-body tr', $resultTableContent).removeClass('ui-bizagi-state-selected');\r\n                    $(this).addClass('ui-bizagi-state-selected');\r\n                    $('option:selected', self.prev()).data(\"idRowSelected\", $(this).data(\"idrowentity\"));\r\n                    self.elementSelected = this;\r\n                }\r\n            });\r\n            //Add entity btn listener\r\n            $(\"#addRowEntity\", $resultTableContent).click(function (e) {\r\n                settings.onAdd.apply(this, new Array(e, {context: self.get(0)}));\r\n            });\r\n            //Edit entity btn listener\r\n            $(\"#editRowEntity\", $resultTableContent).click(function (e) {\r\n                if (self.elementSelected == null) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n                }\r\n                else {\r\n                    settings.onEdit.apply(this,  new Array(e, self.elementSelected));\r\n                    $('.ui-bizagi-grid-body tr', $resultTableContent).removeClass('ui-bizagi-state-selected');\r\n                    self.elementSelected = null;\r\n                }\r\n            });\r\n            //Delete entity btn listener\r\n            $(\"#deleteRowEntity\", $resultTableContent).click(function (e) {\r\n                if (self.elementSelected == null) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n                }\r\n                else {\r\n                    settings.onDelete.apply(this,  new Array(e, self.elementSelected));\r\n                    $('.ui-bizagi-grid-body tr', $resultTableContent).removeClass('ui-bizagi-state-selected');\r\n                    self.elementSelected = null;\r\n                }\r\n            });\r\n        }\r\n        /**\r\n         * Returns true if the attribute support filter\r\n         * images and files aren't supported\r\n         * @param header\r\n         * @return {boolean}\r\n         */\r\n        function attributeSupportFilter(header) {\r\n            var attributeType = header.attributeType;\r\n            var datatype = header.dataType;\r\n            var xpath = header.xpath || \"\";\r\n\r\n            if(header.masterEntity){\r\n                return false;\r\n            }\r\n            if (datatype < 0) {\r\n                return false;\r\n            }\r\n            // If xpath has multiples levels then ignore filters\r\n            if (xpath.indexOf(\".\") > -1) {\r\n                return false;\r\n            }\r\n            if (attributeType == 1003) {\r\n                return false;\r\n            }\r\n            if (attributeType == 1002) {\r\n                return false;\r\n            }\r\n            if (attributeType == 1004) {\r\n                return false;\r\n            }\r\n            // If its paramatric entity\r\n            if (attributeType == 1005) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n\r\n        /**\r\n        * Check if header support order\r\n        * In order to extend\r\n        * @param header\r\n        * @return {*}\r\n        */\r\n        function attributeSupportOrder(header) {\r\n            var attributeType = header.attributeType,\r\n                datatype = header.dataType,\r\n                xpath = header.xpath || \"\";\r\n\r\n            if (datatype < 0) {\r\n                return false;\r\n            }\r\n\r\n            // If xpath has multiples levels then ignore filters\r\n            if (xpath.indexOf(\".\") > -1) {\r\n                return false;\r\n            }\r\n\r\n            if (attributeType == 1003) {\r\n                return false;\r\n            }\r\n\r\n            if (attributeType == 1002) {\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        /**\r\n         * Format grid numbers\r\n         */\r\n        function getFormatNumber($item, userLocalizationCloned){\r\n            var auxNumberFormat = {\r\n                decimalDigits: 0,\r\n                decimalSeparator: userLocalizationCloned.decimalSeparator,\r\n            };\r\n\r\n            var allowdecimals = $item.getAttribute('data-allowdecimals') || false;\r\n            var numDecimals = $item.getAttribute('data-numdecimals') || 0;\r\n            var percentage = $item.getAttribute('data-percentage') || false;\r\n            var thousands = $item.getAttribute('data-thousands') || true;\r\n            allowdecimals = bizagi.util.parseBoolean(allowdecimals);\r\n            thousands = bizagi.util.parseBoolean(thousands);\r\n            auxNumberFormat.allowDecimals = allowdecimals;\r\n            auxNumberFormat.decimalDigits = numDecimals;\r\n            auxNumberFormat.thousands = thousands;\r\n            auxNumberFormat.groupSeparator = thousands ? userLocalizationCloned.groupSeparator : \"\";\r\n            auxNumberFormat.percentage = percentage;\r\n\r\n            return auxNumberFormat;\r\n        }\r\n\r\n        return simpleGrid;\r\n    }\r\n})(jQuery);\r\n","/**\r\n*  Name: BizAgi Case Security Improvement\r\n* \r\n* @author Nessler Camargo\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.selectedUsers = [\"\", \"\"];\r\n        self.allProcess = false;\r\n        self.haveProcess = false;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin-case-security-improvement\": bizagi.getTemplate(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\").concat(\"#ui-bizagi-workportal-widget-admin-case-security-improvement\"),\r\n            \"admin-case-security-improvement-fields\": bizagi.getTemplate(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\").concat(\"#ui-bizagi-workportal-widget-admin-case-security-improvement-fields\"),\r\n            \"security-improvement-loader\": bizagi.getTemplate(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\").concat(\"#ui-bizagi-workportal-widget-admin-case-security-improvement-loader\"),\r\n            \"security-improvement-emptyTree\": bizagi.getTemplate(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\").concat(\"#ui-bizagi-workportal-widget-admin-case-security-improvement-emptyTree\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_TRANSFER_CASE_SECURITY_PERMISSIONS;\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.fieldsContent = self.getTemplate(\"admin-case-security-improvement-fields\");\r\n        self.loaderTmpl = self.getTemplate(\"security-improvement-loader\");\r\n        self.emptyTreeTmpl = self.getTemplate(\"security-improvement-emptyTree\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this;\r\n        //append fields to wrapper\r\n        var fields = $.tmpl(self.fieldsContent, {});\r\n        $(\"#defaults-admin-case-security-home\", self.content).append(fields);\r\n        self.setupSearchusersButton();\r\n        $(\".security-message-danger\", self.content).hide();\r\n        $(\"#title-process-revoke\", self.content).hide();\r\n        var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-select-current-user\") });\r\n        $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").append(tree);\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        self.generalContent = self.getTemplate(\"admin-case-security-improvement\");\r\n        var content;\r\n        content = self.content = $.tmpl(self.generalContent, {});\r\n        if (self.params.content) {\r\n            content = self.params.content.html(content);\r\n        }\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n\r\n    setupProcessTreePermissions: function (id) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var processtreeParams = $.extend({}, self.params);\r\n        processtreeParams.canvas = $(\"#processTreePermissions\", content);\r\n        processtreeParams.svgIconsMode = true;\r\n        processtreeParams.searchKeyResource = \" \";\r\n        processtreeParams.byUser = true;\r\n        processtreeParams.userId = id;\r\n        processtreeParams.showTitle = false;\r\n        processtreeParams.newDesign = true;\r\n        $(\"#processTreePermissions\", content).removeClass(\"disableColor\");\r\n        //tree for delete cases\r\n        self.processTreePermissions = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, processtreeParams);\r\n        self.processTreePermissions.render();\r\n    },\r\n\r\n    /*\r\n    * Call service \r\n    */\r\n\r\n    /*\r\n    * initialize the users search form widget\r\n    */\r\n    setupUsersSearchForm: function (input, user) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var def = $.Deferred();\r\n        $(\"#defaults-admin-case-security-home\").hide();\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#dinamicContent\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-select-link\")],\r\n            parentDef: def,\r\n            showBackButton: true\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            var params = { \r\n                action: \"Applications\", \r\n                userId: userId \r\n            }\r\n            if (user == 0) {\r\n                $.when(self.dataService.getApplicationCategoriesList(params))\r\n                    .done(function (applicationList) {\r\n                        self.endLoading();\r\n                        if (applicationList.items.length > 0) {\r\n                            self.allProcess = true;\r\n                            self.haveProcess = true;\r\n                            var typeOption = $(\"div.big-input > input[type='radio']:checked\").val(),\r\n                                text = bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-transfer-permissions-of\");\r\n                            if (typeOption == \"revoke\") {\r\n                                text = bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-revoke-permissions-of\");\r\n                            }\r\n                            self.setupProcessTreePermissions(userId, text)\r\n                        } else {\r\n                            self.initializeTree(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-user-dont-have-permissions-over-processes\"));\r\n                            self.allProcess = false;\r\n                            self.haveProcess = false;\r\n                        }\r\n\r\n                    }).fail(function () {\r\n                        self.endLoading();\r\n                        self.initializeTree(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-user-dont-have-permissions-over-processes\"));\r\n                    });\r\n            }\r\n            $(\"#dinamicContent\", content).html(\"\");\r\n            $(\"#defaults-admin-case-security-home\", content).show();\r\n            if (userName) {\r\n                $(input, content).val(userName);\r\n                self.showHideClearIcon(input, 'block')\r\n            }\r\n            if (userId) {\r\n                self.selectedUsers[user] = userId;\r\n            }\r\n        });\r\n    },\r\n\r\n    initializeTree: function (text) {\r\n        var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: text });\r\n        $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").empty();\r\n        $(\"#processTreePermissions\", self.content).append(tree);\r\n    },\r\n\r\n    showHideClearIcon: function (id, display) {\r\n        self = this;\r\n        var content = self.getContent();\r\n        $(id + \" ~ span\", content).css(\"display\", display);\r\n    },\r\n\r\n    transferCaseSecuritypermissions: function () {\r\n        var self = this;\r\n        self.loader = $.tmpl(self.loaderTmpl, {});\r\n        var params = {};\r\n        if (self.haveProcess) {\r\n            params = self.paramsToInvalidateSelectedCases();\r\n        }\r\n\r\n        params.allProcess = self.allProcess;\r\n        params.idUserSource = (self.selectedUsers[0] != \"\") ? self.selectedUsers[0] : -1;\r\n        params.idUserTarget = (self.selectedUsers[1] != \"\") ? self.selectedUsers[1] : -1;\r\n\r\n        if (params.idUserSource == -1 || params.idUserTarget == -1) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-fail-you-must-select-both-users-to-continue\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else if (params.idUserSource == params.idUserTarget) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-fail-users-must-be-different\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else if (!self.haveProcess) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-user-dont-have-permissions-over-processes\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else {\r\n            var customOptions = {\r\n                dialogClass: \"widget-admincasesearch-invalidate-cases-confirm\",\r\n                width: 400,\r\n                minWidth: 400\r\n            };\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-confirmation-message\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\", [\r\n                { \r\n                    label: bizagi.localization.getResource(\"workportal-general-word-no\"), \r\n                    action: \"reject\" \r\n                }, \r\n                { \r\n                    label: bizagi.localization.getResource(\"workportal-general-word-yes\"), \r\n                    action: \"resolve\" \r\n                }\r\n                ], customOptions))\r\n                .done(function () {\r\n                    self.showLoading();\r\n                    $.when(self.dataService.transferCaseSecuritypermissions(params))\r\n                        .done(function (response) {\r\n                            self.endLoading();\r\n                            if (response.status === \"true\" || response.status === true) {\r\n                                self.showNotifier(printf(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-ok\"), response.quantityModifiedCases));\r\n                            }\r\n                            else {\r\n                                self.endLoading();\r\n                                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n                            }\r\n                        })\r\n                        .fail(function (error) {\r\n                            self.endLoading();\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n                            bizagi.log(error);\r\n                        });\r\n                });\r\n\r\n        }\r\n\r\n    },\r\n\r\n    revokeCaseSecuritypermissions: function () {\r\n        var self = this;\r\n        self.loader = $.tmpl(self.loaderTmpl, {});\r\n        var params = {};\r\n        if (self.haveProcess) {\r\n            params = self.paramsToInvalidateSelectedCases();\r\n        }\r\n        params.allProcess = self.allProcess;\r\n        params.idUserSource = (self.selectedUsers[0] != \"\") ? self.selectedUsers[0] : -1;\r\n\r\n        if (params.idUserSource == -1 || params.idUserTarget == -1) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-fail-you-must-select-the-current-user-to-continue\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else if (!self.haveProcess) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-user-dont-have-permissions-over-processes\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else {\r\n            var customOptions = {\r\n                dialogClass: \"widget-admincasesearch-invalidate-cases-confirm\",\r\n                width: 400,\r\n                minWidth: 400\r\n            };\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-confirmation-message\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\", [\r\n                { \r\n                    label: bizagi.localization.getResource(\"workportal-general-word-no\"), \r\n                    action: \"reject\" \r\n                }, \r\n                { \r\n                    label: bizagi.localization.getResource(\"workportal-general-word-yes\"), \r\n                    action: \"resolve\" \r\n                }\r\n            ], customOptions))\r\n                .done(function () {\r\n                    self.showLoading();\r\n                    $.when(self.dataService.revokeCaseSecuritypermissions(params))\r\n                        .done(function (response) {\r\n\r\n                            self.endLoading();\r\n                            if (response.status === \"true\" || response.status === true) {\r\n                                self.showNotifier(printf(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-revoke-ok\"), response.quantityModifiedCases));\r\n                            }\r\n                            else {\r\n                                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n                            }\r\n                        })\r\n                        .fail(function (error) {\r\n                            self.endLoading();\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n                            bizagi.log(error);\r\n                        });\r\n                })\r\n                .fail(function (error) {\r\n                    console.log(\"error\", error);\r\n                });\r\n        }\r\n\r\n    },\r\n\r\n    paramsToInvalidateSelectedCases: function () {\r\n        var self = this;\r\n        var selectedProcessRoute = self.processTreePermissions.getTreeRouteSelected();\r\n        var idAppToSend = \"\",\r\n            idProcessToSend = \"\";\r\n\r\n        if (selectedProcessRoute.length > 0) {\r\n            if (selectedProcessRoute.length == 2) {\r\n                idAppToSend = selectedProcessRoute[1];\r\n                idProcessToSend = selectedProcessRoute[0];\r\n            }\r\n            else {\r\n                idAppToSend = selectedProcessRoute[selectedProcessRoute.length - 1];\r\n                idProcessToSend = selectedProcessRoute[0];\r\n            }\r\n        }\r\n        if (idProcessToSend == \"\") {\r\n            self.allProcess = true;\r\n        }\r\n        else {\r\n            self.allProcess = false;\r\n        }\r\n\r\n        var params = {\r\n            idProcess: idProcessToSend,\r\n            idApplication: idAppToSend\r\n        };\r\n        return params;\r\n    },\r\n\r\n    showNotifier: function (message) {\r\n        var notifier = window.parent.bizagi.injector.get('notifier');\r\n        notifier.showSucessMessage(message, '');\r\n    },\r\n    showLoading: function () {\r\n        var self = this;\r\n        $(\"#defaults-admin-case-security-home\").append(self.loader);\r\n    },\r\n    endLoading: function () {\r\n        var self = this;\r\n        $(self.loader).remove();\r\n    },\r\n    clearInput: function (input, content) {\r\n        var self = this;\r\n        var position = (input == \"#txtTextUserSource\") ? 0 : 1;\r\n        self.showHideClearIcon(input, 'none');\r\n        $(input, content).val(\"\");\r\n        self.selectedUsers[position] = \"\";\r\n    },\r\n    /****************** EVENTOS ***********************/\r\n\r\n\r\n    setupSearchusersButton: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-searchUserSource\", content).click(function () {\r\n            self.showLoading();\r\n            self.setupUsersSearchForm(\"#txtTextUserSource\", 0);\r\n        });\r\n        $(\"#btn-searchUserTarget\", content).click(function () {\r\n            self.setupUsersSearchForm(\"#txtTextUserTarget\", 1);\r\n        });\r\n\r\n        $(\"#btn-clearUserSource\", content).click(function () {\r\n            self.clearInput(\"#txtTextUserSource\", content);\r\n            var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-select-current-user\") });\r\n            $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").empty();\r\n            $(\"#processTreePermissions\", self.content).append(tree);\r\n        });\r\n        $(\"#btn-clearUserTarget\", content).click(function () {\r\n            self.clearInput(\"#txtTextUserTarget\", content);\r\n        });\r\n\r\n        $(\"#btn-copyPermissions\", content).click(function () {\r\n            if($(\"#allAppsLinkSelected\", content).data('allAppSelected') === false && self.processTreePermissions.getTreeRouteSelected().length === 0){ //If nothing has been selected\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-processTree-no-selected-process\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            }else{\r\n                self.transferCaseSecuritypermissions();\r\n            }\r\n        });\r\n        $(\"#btn-revokePermissions\", content).click(function () {\r\n            if($(\"#allAppsLinkSelected\", content).data('allAppSelected') === false && self.processTreePermissions.getTreeRouteSelected().length === 0){ //If nothing has been selected\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-processTree-no-selected-process\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            }else{\r\n                self.revokeCaseSecuritypermissions();\r\n            }\r\n        });\r\n\r\n        $(\"#transferPermissions\", content).click(function () {\r\n            $(\"input[value='copy']\").attr('checked', true);\r\n            $(\".security-message-information\", content).show();\r\n            $(\".security-message-danger\", content).hide();\r\n            $(\"#btn-copyPermissions\", content).show();\r\n            $(\"#btn-revokePermissions\", content).hide();\r\n            $(\".user-label:has(#txtTextUserTarget)\").show();\r\n            $(\"#title-process-copy\", content).show();\r\n            $(\"#title-process-revoke\", content).hide();\r\n            $(\"#revokePermissions\", content).removeClass(\"ui-rubik-button-accept\").addClass(\"ui-rubik-button-cancel\");\r\n            $(\"#transferPermissions\", content).removeClass(\"ui-rubik-button-cancel\").addClass(\"ui-rubik-button-accept\");\r\n            self.clearInput(\"#txtTextUserSource\", content);\r\n            self.clearInput(\"#txtTextUserTarget\", content);\r\n            var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-select-current-user\") });\r\n            $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").empty();\r\n            $(\"#processTreePermissions\", self.content).append(tree);\r\n        })\r\n        $(\"#revokePermissions\", content).click(function () {\r\n            $(\"input[value='revoke']\").attr('checked', true);\r\n            $(\".security-message-information\", content).hide();\r\n            $(\".security-message-danger\", content).show();\r\n            $(\"#btn-copyPermissions\", content).hide();\r\n            $(\"#btn-revokePermissions\", content).show();\r\n            $(\".user-label:has(#txtTextUserTarget)\").hide();\r\n            $(\"#title-process-copy\", content).hide();\r\n            $(\"#title-process-revoke\", content).show();\r\n            $(\"#transferPermissions\", content).removeClass(\"ui-rubik-button-accept\").addClass(\"ui-rubik-button-cancel\");\r\n            $(\"#revokePermissions\", content).removeClass(\"ui-rubik-button-cancel\").addClass(\"ui-rubik-button-accept\");\r\n            self.clearInput(\"#txtTextUserSource\", content);\r\n            self.clearInput(\"#txtTextUserTarget\", content);\r\n            var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-select-current-user\") });\r\n            $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").empty();\r\n            $(\"#processTreePermissions\", self.content).append(tree);\r\n        })\r\n    }\r\n\r\n});\r\n\r\n\r\n"]}