{"version":3,"sources":["jquery/workportal/js/base/widget/bizagi.workportal.widgets.newCase.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.newCase.js"],"names":["bizagi","workportal","widgets","widget","extend","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_NEWCASE","renderContent","template","this","getTemplate","content","$","tmpl","createNewCase","idWfClass","isAdhocProcess","self","deferred","Deferred","loader","start","then","when","dataService","startProcess","idProcess","data","onStartProcessDone","resolve","promise","createNewCaseWithIdOrganization","idOrganization","publish","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","idCase","caseInfo","radNumber","formsRenderVersion","isOfflineForm","newCase","init","workportalFacade","params","referrerParams","referrer","_super","enumCurrentContext","RECENT","ALL","currentContext","loadTemplates","error-message","concat","newCase-categories","newCase-categories-tree","newCase-categories-recent-process","newCase-categories-organization-list","useNewEngine","postRender","getContent","configureBackButton","idCategory","undefined","scrollVertical","autohide","configureTreeNavigation","click","removeOrganizationList","hasClass","hide","html","getResource","renderRecentProcess","addClass","removeClass","tooltip","show","focus","val","renderCategories","idParentCategory","appId","categoryContent","categoryContainer","categoryTree","filtered","filterData","criticSection","getCategories","idApp","done","empty","totalApps","transformedData","category","each","key","value","push","categoryName","appName","isProcess","description","length","i","truncate","appendTo","loadAllElementEvent","filteredDataCases","obj","label","delegate","e","stopPropagation","assignEvent","autocomplete","messages","noResults","results","minLength","source","autoFocus","position","my","at","of","offset","collision","delay","open","select","trigger","_renderItem","ul","item","find","elem","children","idWFClass","util","parseBoolean","emptyNavigatorInfo","elemt","prevAll","fadeTo","slideUp","duration","easing","nextAll","currentUser","isMultiOrganization","getOrganizationsByUserList","createOrganizationList","response","parent","outerWidth","top","css","document","width","height","text","idWorkItem","workItems","desktop","popup","closePopupInstance","headerTemplate","btnBack","remove","getRecentProcesses","numberOfProcesses","onlyLastProcesses","processes","browser","msie","blur","unbind","autoSave","templateService","container","maxZIndex","getMaxZIndex","hasStartForm","setTimeout","bind","organizationList","modalMenuBtList","organizationListTemplate","organizationListContent","preventDefault","options","bizagiScrollbar"],"mappings":"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","sourcesContent":["/*\r\n*   Name: BizAgi Workportal New Case Widget Controller\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define a base class to to define the new case widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.newCase\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_NEWCASE;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"newCase\");\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    *   Creates a new case based on the selected process\r\n    */\r\n    createNewCase: function (idWfClass, isAdhocProcess) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            bizagi.loader.start(\"plans-view\").then(function () {\r\n                // Creates a new case\r\n                $.when(self.dataService.startProcess({\r\n                    idProcess: idWfClass,\r\n                    isAdhocProcess: isAdhocProcess\r\n                }))\r\n                .then(function (data) {\r\n                    self.onStartProcessDone(data);\r\n                    deferred.resolve(data);\r\n                })\r\n            });\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    createNewCaseWithIdOrganization: function (idWfClass, idOrganization) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            bizagi.loader.start(\"plans-view\").then(function () {\r\n                // Creates a new case\r\n                $.when(self.dataService.startProcess({\r\n                    idProcess: idWfClass,\r\n                    idOrganization: idOrganization\r\n                }))\r\n                .then(function (data) {\r\n                    self.onStartProcessDone(data);\r\n                    deferred.resolve(data);\r\n                })\r\n            });\r\n        });\r\n        return deferred.promise();\r\n    },\r\n\r\n    onStartProcessDone: function (data) {\r\n        var self = this;\r\n        // Then we call the routing action\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: data.caseInfo.idCase,\r\n            radNumber: data.radNumber,\r\n            formsRenderVersion: (typeof data.caseInfo.isOfflineForm != \"undefined\") ? data.caseInfo.formsRenderVersion : 0,\r\n            isOfflineForm: (typeof data.caseInfo.isOfflineForm != \"undefined\") ? data.caseInfo.isOfflineForm : false,\r\n            data: data\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi Workportal Desktop New Case Widget Controller\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will provide desktop overrides to implement the new case widget\r\n*/\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.newCase.extend(\"bizagi.workportal.widgets.newCase\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        bizagi.referrerParams = bizagi.referrerParams || {};\r\n        bizagi.referrerParams.referrer = \"inboxGrid\";\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.enumCurrentContext = {\r\n            \"RECENT\": 1,\r\n            \"ALL\": 2\r\n        };\r\n        self.currentContext = \"\"; // recent or all processes\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"error-message\": bizagi.getTemplate(\"common.bizagi.desktop.error-message\"),\r\n            \"newCase\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-newcase\"),\r\n            \"newCase-categories\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-newcase-categories\"),\r\n            \"newCase-categories-tree\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-newcase-categories-tree\"),\r\n            \"newCase-categories-recent-process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-recent-process\"),\r\n            \"newCase-categories-organization-list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-newcase-organization-list\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /**\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        // Render base categories\r\n        //self.renderCategories();\r\n\r\n        // Bind back button\r\n        self.configureBackButton();\r\n\r\n        // Reset state\r\n        bizagi.idCategory = undefined;\r\n\r\n        // Bind scroll buttons\r\n        self.scrollVertical({\r\n            \"autohide\": false\r\n        });\r\n\r\n        // Bind tree navigation\r\n        self.configureTreeNavigation();\r\n        // Bind recent process\r\n        $(\"#frecuentCases\", content).click(function () {\r\n            //Remove organizationList if exist\r\n            self.removeOrganizationList();\r\n\r\n            // Block multi click on this element\r\n            if ($(this).hasClass('frecuentCasesOn')) {\r\n                return;\r\n            }\r\n\r\n            // Hide search field\r\n            $(\".searchNewCase\", content).hide();\r\n\r\n            // Set title\r\n            $('#modalTitle', content).html(self.getResource('workportal-menu-recent-processes'));\r\n\r\n            // Change to recent process \r\n            self.renderRecentProcess();\r\n\r\n            // Change css selected\r\n            $(this).addClass(\"frecuentCasesOn\");\r\n            $(\"#casesList\", content).removeClass(\"casesListOn\");\r\n\r\n        }).tooltip();\r\n\r\n        // Bind recent process\r\n        $(\"#casesList\", content).click(function () {\r\n            //Remove organizationList if exist\r\n            self.removeOrganizationList();\r\n\r\n            // Block multi click on this element\r\n            if ($(this).hasClass('casesListOn')) {\r\n                return;\r\n            }\r\n\r\n            // Show search field and empty element\r\n            $(\".searchNewCase\", content).show();\r\n            $(\"#categories\", content).show();\r\n            $(\"#searchNewCase\", content).focus();\r\n            $(\"#searchNewCase\", content).val(\"\");\r\n\r\n            // Set title\r\n            $('#modalTitle', content).html(self.getResource('workportal-menu-all-processes'));\r\n\r\n            // Change to recent process \r\n            self.renderCategories();\r\n            \r\n            // Change css selected\r\n            $(this).addClass(\"casesListOn\");\r\n            $(\"#frecuentCases\", content).removeClass(\"frecuentCasesOn\");\r\n\r\n        }).tooltip();\r\n\r\n        \r\n\r\n        // Bind Search tab\r\n        $(\"#search\", content).click(function () {\r\n            if ($(this).hasClass(\"searchOn\")) {\r\n                $(this).removeClass(\"searchOn\");\r\n\r\n            } else {\r\n                $(this).addClass(\"searchOn\");\r\n\r\n            }\r\n        });\r\n\r\n\r\n        // Show recent proccess category\r\n        $(\"#frecuentCases\", content).click();\r\n    },\r\n\r\n    /**\r\n    * Render List categories for each idCategory\r\n    */\r\n    renderCategories: function (idParentCategory, appId) {\r\n        var self = this;\r\n        self.currentContext = self.enumCurrentContext.ALL;\r\n        var content = self.getContent();\r\n        var template = self.getTemplate(\"newCase-categories\");\r\n        var categoryContainer = $(\"#categories\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n        var filtered = false;\r\n        var categoryContent;\r\n        var filterData = {};\r\n        var elemToShow = 100;\r\n\r\n        // Create critic section to prevent double click event\r\n        bizagi.criticSection = (bizagi.criticSection == 1) ? 1 : 0;\r\n\r\n        // Load categories\r\n        $.when(self.dataService.getCategories({\r\n                idCategory: idParentCategory,\r\n                idApp: appId || \"\"\r\n            }))\r\n\t\t.done(function (data) {\r\n            if(self.currentContext === self.enumCurrentContext.ALL){\r\n                // Renders the categories\r\n                categoryContainer.empty();\r\n                categoryTree.show();\r\n\r\n                if (data.totalApps > 1) {\r\n                    var transformedData = {\r\n                        category: []\r\n                    };\r\n\r\n                    // Transform data and mark with appId flag\r\n                    $.each(data.category, function (key, value) {\r\n                        transformedData.category.push({\r\n                            \"appId\": value.appId,\r\n                            \"idCategory\": '',\r\n                            \"categoryName\": value.appName,\r\n                            \"isProcess\": \"false\",\r\n                            \"isAdhocProcess\": \"false\",\r\n                            \"description\": \" \"\r\n                        });\r\n                    });\r\n\r\n                    // Change data value with transformed data\r\n                    data = transformedData;\r\n                }\r\n\r\n                // Improve load time\r\n                if (data.category.length > elemToShow) {\r\n                    filterData.category = {};\r\n                    for (i = 0; i <= elemToShow; i++) {\r\n                        filterData.category[i] = data.category[i];\r\n                    }\r\n                    filterData.truncate = true;\r\n                    categoryContent = $.tmpl(template, filterData);\r\n                    categoryContent.appendTo(categoryContainer);\r\n\r\n                    self.loadAllElementEvent(data);\r\n\r\n                } else {\r\n                    filterData = data;\r\n                    categoryContent = $.tmpl(template, filterData);\r\n                    categoryContent.appendTo(categoryContainer);\r\n                }\r\n\r\n\r\n                // Bind scroll vertical\r\n                self.scrollVertical({\r\n                    \"autohide\": false\r\n                });\r\n\r\n\r\n                // Define autocomplete information for search cases\r\n                var filteredDataCases = {};\r\n                filteredDataCases.category = [];\r\n                var i = 0;\r\n                $.each(data.category, function (key, obj) {\r\n                    // Add label and value to item object\r\n                    data.category[key].label = obj.categoryName;\r\n                    data.category[key].value = obj.idCategory;\r\n                });\r\n\r\n                // Add auto focus \r\n                $(\"#searchNewCase\", content).focus();\r\n\r\n                $(content).delegate(\"#searchNewCase\", \"keyup\", function (e) {\r\n                    e.stopPropagation();\r\n                    if ($(\"#searchNewCase\", content).val().length === 0 && filtered) {\r\n                        categoryContent = $.tmpl(template, filterData);\r\n                        categoryContent.appendTo(categoryContainer);\r\n                        self.assignEvent();\r\n                        self.loadAllElementEvent(data);\r\n                        // reset flag\r\n                        filtered = false;\r\n                    }\r\n                });\r\n\r\n                // Define search results\r\n                $(\"#searchNewCase\", content).autocomplete({\r\n                    messages: {\r\n                        noResults: null, //\"No search results.\",\r\n                        results: function () { }\r\n                    },\r\n                    minLength: 3,\r\n                    source: data.category,\r\n                    autoFocus: true,\r\n                    position: {\r\n                        my: \"left top\",\r\n                        at: \"left top\",\r\n                        of: \"body\",\r\n                        offset: \"-10 -10\",\r\n                        collision: \"none\",\r\n                        delay: 800\r\n                    },\r\n\r\n                    /* OPEN METHOD */\r\n                    open: function () {\r\n                        // Reset values\r\n                        i = 0;\r\n                        filteredDataCases.category = [];\r\n                    },\r\n\r\n                    /* SELECT METHOD */\r\n                    select: function () {\r\n                        // If list only have one element, open them\r\n                        if ($(\"#categories ul\").length == 1) {\r\n                            $(\"#categories ul\").trigger(\"click\");\r\n                        }\r\n                        return false;\r\n                    }\r\n\r\n                    /* FILTER DATA FOR AUTOCOMPLE */\r\n                }).data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n\r\n                    if (i >= 15) {\r\n                        return {\r\n                            data: function() { }\r\n                        };\r\n                    }\r\n                    filteredDataCases.category[i++] = item;\r\n\r\n                    // Render template with new filtered data\r\n                    categoryContent = $.tmpl(template, filteredDataCases);\r\n                    categoryContent.appendTo(categoryContainer);\r\n\r\n                    // Set flag \r\n                    filtered = true;\r\n                    // Assign click event for new content\r\n                    self.assignEvent(categoryContent);\r\n                    self.loadAllElementEvent(data);\r\n                    return categoryContent;\r\n                };\r\n\r\n                // Assign click event for new content\r\n                self.assignEvent();\r\n            }\r\n\t\t});\r\n    },\r\n\r\n    /*\r\n    * Assign click event to load all elements\r\n    */\r\n    loadAllElementEvent: function (data) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var template = self.getTemplate(\"newCase-categories\");\r\n        var categoryContainer = $(\"#categories\", content);\r\n\r\n        $(\".loadMoreElements\", categoryContainer).click(function (e) {\r\n            e.stopPropagation();\r\n            $(this).find(\"#loadMoreElementsIcon\").removeClass(\"plus_load_icon\").addClass(\"loading_icon\");\r\n            categoryContainer.empty();\r\n            var categoryContent = $.tmpl(template, data);\r\n            categoryContent.appendTo(categoryContainer);\r\n            self.assignEvent();\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n    * Assign click event to list elements\r\n    */\r\n    assignEvent: function (elem) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var categoryContainer = $(\"#categories\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n        var ul = elem || $(\"ul\", categoryContainer);\r\n        $(ul).click(function (e) {\r\n            e.stopPropagation();\r\n\r\n            var idCategory = $(this).children(\"#idCategory\").val();\r\n            var idWFClass = idCategory;\r\n            var isProcess = $(this).children(\"#isProcess\").val();\r\n            var categoryName = $(this).children(\"#categoryName\").val();\r\n            var isAdhocProcess = $(this).children(\"#isAdhocProcess\").val();\r\n            var appId = $(this).data('appid');\r\n\r\n\r\n            // check critic section\r\n            if ((bizagi.criticSection == 1 || idCategory == bizagi.idCategory) && !bizagi.util.parseBoolean(isProcess)) {\r\n                return true;\r\n            }\r\n\r\n            // Define last idcategory\r\n            bizagi.idCategory = idCategory;\r\n\r\n            // Clear autocomplete field value\r\n            $(\"#searchNewCase\", content).val(\"\");\r\n\r\n            // up critic section\r\n            bizagi.criticSection = 1;\r\n\r\n            if (bizagi.util.parseBoolean(isProcess) === true) {\r\n\r\n                bizagi.util.emptyNavigatorInfo();\r\n\r\n                // Create a new case\r\n                var elemt = $(this).find(\".processIco\");\r\n                $(elemt).addClass(\"wait\");\r\n\r\n                // Delete others elements\r\n\r\n                $(this).prevAll(\"ul\").fadeTo(650, 0, \"easeInOutCirc\").slideUp({\r\n                    duration: 300,\r\n                    easing: \"easeInOutCirc\"\r\n                });\r\n\r\n                $(this).nextAll(\"ul\").fadeTo(650, 0, \"easeInOutCirc\").slideUp({\r\n                    duration: 300,\r\n                    easing: \"easeInOutCirc\"\r\n                });\r\n\r\n                if(bizagi.currentUser.isMultiOrganization && bizagi.currentUser.isMultiOrganization == \"true\"){\r\n                    $.when(self.dataService.getOrganizationsByUserList()).done(function (data){\r\n                       self.createOrganizationList( idWFClass, data.response, $(categoryContainer).parent().outerWidth(), $(\"#modalMenuBtList\", self.getContent()).position().top);\r\n                    });\r\n                }\r\n                else{\r\n\r\n                // Show waiting modal box\r\n                $(\"#modalNewCaseOverlay\", content).removeClass(\"modalNewCaseOverlay\").addClass(\"modalNewCaseOverlayShow\");\r\n                $(\"#modalNewCaseMessage\", content).addClass(\"show\");\r\n                // Center Element                \r\n                $(\"#modalNewCaseMessage\", content).css(\"left\", (($(document).width() / 2) - ($(\"#modalNewCaseMessage\", content).width() / 2)));\r\n                $(\"#modalNewCaseMessage\", content).css(\"top\", (($(document).height() / 2) - ($(\"#modalNewCaseMessage\", content).height() / 2)));\r\n                // Set Text \r\n                $(\"#case\", content).text(categoryName);\r\n\r\n                    $.when(self.createNewCase(idCategory, isAdhocProcess)).done(function (data) {\r\n                        // set global idworkitem\r\n                        if(bizagi.referrerParams){\r\n                            bizagi.referrerParams.idWorkItem = '';\r\n                        }\r\n\r\n\r\n                        if (data.caseInfo.workItems && data.caseInfo.workItems.length >= 1) {\r\n                            bizagi.referrerParams.idWorkItem = (data.caseInfo.workItems.length >= 1) ? data.caseInfo.workItems[0].idWorkItem : '';\r\n                        }\r\n\r\n                        // Also close the popup\r\n                        bizagi.workportal.desktop.popup.closePopupInstance();\r\n\r\n                        // Hide waiting modal box\r\n                        $(\"#modalNewCaseOverlay\", content).addClass(\"modalNewCaseOverlay\").removeClass(\"modalNewCaseOverlayShow\");\r\n                        $(\"#modalNewCaseMessage\", content).removeClass(\"show\");\r\n\r\n\t\t\t\t\t});\r\n                }\r\n\r\n            } else {\r\n                // Append category header\r\n                var headerTemplate = self.getTemplate(\"newCase-categories-tree\");\r\n                $.tmpl(headerTemplate, {\r\n                    idParentCategory: idCategory,\r\n                    categoryName: categoryName,\r\n                    appId: appId\r\n                }).appendTo(categoryTree);\r\n\r\n                // Set bind event for last element\r\n                self.configureTreeNavigation();\r\n\r\n                // Render sub-categories\r\n                self.renderCategories(idCategory, appId);\r\n            }\r\n\r\n            // Reset critical section\r\n            bizagi.criticSection = 0;\r\n            // Reset last idcategory\r\n            bizagi.idCategory = undefined;\r\n        });\r\n    },\r\n    /**\r\n    *  Render the recent process category\r\n    */\r\n    renderRecentProcess: function () {\r\n        var self = this;\r\n        self.currentContext = self.enumCurrentContext.RECENT;\r\n        var content = self.getContent();\r\n        var categoryContainer = $(\"#categories\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n        var btnBack = $(\"#bt-back\", content);\r\n        var template = self.getTemplate(\"newCase-categories-recent-process\");\r\n\r\n        categoryContainer.empty();\r\n\r\n        // reset content of category tree\r\n        $(\"li:first\", categoryTree).nextAll().remove();\r\n        categoryTree.hide();\r\n        btnBack.hide();\r\n\r\n        // Define New Content\r\n        $.when(self.dataService.getRecentProcesses({\r\n                numberOfProcesses: 7,\r\n                onlyLastProcesses: true\r\n            })).done(function (data) {\r\n                if(self.currentContext === self.enumCurrentContext.RECENT){\r\n                    $.tmpl(template, data).appendTo(categoryContainer);\r\n                    // this is for IE9. to prevent an undesirable visual effect.\r\n                    if (data.processes.length === 0 && $.browser.msie) {\r\n                        categoryContainer.blur();\r\n                        categoryContainer.hide();\r\n                    }\r\n                    // Bind recent process\r\n                    $(\"ul\", categoryContainer).click(function () {\r\n\r\n                        $(\"ul\", categoryContainer).unbind(\"click\");\r\n                        \r\n                        var idWFClass = $(this).children(\"#idWFClass\").val();\r\n                        \r\n                        bizagi.util.emptyNavigatorInfo();\r\n                        \r\n                        // Creates a new case\r\n                        var elemt = $(this).find(\".processIco\");\r\n                        $(elemt).addClass(\"wait\");\r\n\r\n                        // Delete others elements\r\n\r\n                        $(this).prevAll(\"ul\").fadeTo(650, 0, \"easeInOutCirc\").slideUp({\r\n                            duration: 300,\r\n                            easing: \"easeInOutCirc\"\r\n                        });\r\n\r\n                        $(this).nextAll(\"ul\").fadeTo(650, 0, \"easeInOutCirc\").slideUp({\r\n                            duration: 300,\r\n                            easing: \"easeInOutCirc\"\r\n                        });\r\n\r\n\r\n                        if (bizagi.currentUser.isMultiOrganization && bizagi.currentUser.isMultiOrganization == \"true\") {\r\n                            $.when(self.dataService.getOrganizationsByUserList()).done(function (data) {\r\n                                self.createOrganizationList(idWFClass, data.response, $(categoryContainer).parent().outerWidth(), $(\"#modalMenuBtList\", self.getContent()).position().top);\r\n                            });\r\n                        }\r\n                        else {\r\n                            $.when(bizagi.util.autoSave()).done(function () {\r\n                                $(document).data('auto-save', '');\r\n\r\n                                bizagi.templateService.getTemplate(bizagi.getTemplate(\"bizagi.workportal.desktop.loadModuleStatus\", undefined)).done(function(template) {\r\n                                    \r\n                                    var container = $(\"#loadModuleStatus\");\r\n                                    container.empty();\r\n                                    var content = $.tmpl(template, {});\r\n                                    content.appendTo(container);\r\n\r\n                                    var maxZIndex = bizagi.util.getMaxZIndex();\r\n                                    $(\".ui-widget-overlay\", container).css(\"z-index\", maxZIndex + 20);\r\n                                    $(\"#modalModuleStatus\", container).css(\"z-index\", maxZIndex + 30);\r\n                                    container.show();\r\n\r\n                                    $.when(self.createNewCase(idWFClass)).done(function (data) {\r\n                                        // set global idworkitem\r\n                                        if (data && !data.hasStartForm) {\r\n                                            if (bizagi.referrerParams) {\r\n                                                bizagi.referrerParams.idWorkItem = (data.caseInfo.workItems.length >= 1) ? data.caseInfo.workItems[0].idWorkItem : '';\r\n                                            }\r\n                                        }\r\n                                    });\r\n                                });\r\n                                \r\n                            });\r\n                                // Also close the popup\r\n                                bizagi.workportal.desktop.popup.closePopupInstance();\r\n                        }\r\n\r\n                        setTimeout(function () {\r\n                            $(\"ul\", categoryContainer).bind(\"click\");\r\n                        }, 1000);\r\n                        \r\n                    });\r\n                }\r\n\t\t\t});\r\n    },\r\n\r\n    createOrganizationList: function (idWFClass, organizationList) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var modalMenuBtList = $('#modalMenuBtList', content);\r\n        \r\n        var organizationListTemplate = self.getTemplate(\"newCase-categories-organization-list\");\r\n        \r\n        if($('#organization-list', modalMenuBtList).length === 0){\r\n            var organizationListContent = $.tmpl(organizationListTemplate, { \"organizationList\": organizationList }).appendTo(modalMenuBtList);\r\n\r\n        //Bind the click event create the case\r\n        $('#new-case', organizationListContent).click(function (e) {\r\n            e.preventDefault();\r\n\r\n            $.when(self.createNewCaseWithIdOrganization(idWFClass, $('#organization-list', organizationListContent).val())).done(function (data) {\r\n                // set global idworkitem\r\n                if (data)\r\n                if (bizagi.referrerParams)\r\n                bizagi.referrerParams.idWorkItem = (data.caseInfo.workItems.length >= 1) ? data.caseInfo.workItems[0].idWorkItem : '';\r\n\r\n                // Also close the popup\r\n                bizagi.workportal.desktop.popup.closePopupInstance();\r\n            });\r\n\r\n        });\r\n        }\r\n    },\r\n\r\n    removeOrganizationList: function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $(\".new-case-organization-list-content\", content).remove();\r\n    },\r\n\r\n    /**\r\n    *   Binds the back buttons so we can navigate back\r\n    */\r\n    configureBackButton: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var btnBack = $(\"#bt-back\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n\r\n        // Bind click\r\n        btnBack.click(function () {\r\n            bizagi.idCategory = undefined;\r\n            if ($(\"li\", categoryTree).length == 2) {\r\n                // hide back button\r\n                btnBack.hide();\r\n            }\r\n\r\n            if ($(\"li\", categoryTree).length > 1) {\r\n                // Removes last child                    \r\n                $(\"li:last-child\", categoryTree).remove();\r\n\r\n                // Render categories again\r\n                var idCategory = $(\"li:last-child\", categoryTree).children(\"#idParentCategory\").val();\r\n                var appId = $(\"li:last-child\", categoryTree).data('appid');\r\n                self.renderCategories(idCategory, appId);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Bind tree navigation\r\n    */\r\n    configureTreeNavigation: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var btnBack = $(\"#bt-back\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n\r\n        if ($(\"li\", categoryTree).length <= 1) {\r\n            btnBack.hide();\r\n        } else {\r\n            btnBack.show();\r\n        }\r\n\r\n        // Bind header events\r\n        $(\"li:last-child\", categoryTree).click(function () {\r\n            // Remove all elements\r\n            $(this).nextAll().remove();\r\n            var idCategory = $(this).children(\"#idParentCategory\").val();\r\n            var appId = $(this).data('appid');\r\n            if ($(\"li\", categoryTree).length == 1) {\r\n                bizagi.idCategory = undefined;\r\n                btnBack.hide();\r\n            }\r\n\r\n            // if it has appId, reset bizagi.idCategory in orden to unlock criticSection\r\n            if (appId) {\r\n                bizagi.idCategory = undefined;\r\n            }\r\n\r\n            // Render category again\r\n            self.renderCategories(idCategory, appId);\r\n        });\r\n    },\r\n\r\n    /**\r\n    *  Bind the vertical scroll buttons\r\n    */\r\n    scrollVertical: function (options) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        options = options || {};\r\n\r\n        $(\"#categories\", content).bizagiScrollbar(options);\r\n    }\r\n});\r\n"]}