{"version":3,"sources":["jquery/common/bizagi.ui.controls/jquery.ui.controls.definition.js","jquery/workportal/js/base/command/bizagi.workportal.command.security.js","jquery/workportal/js/base/command/bizagi.workportal.command.printform.js","jquery/workportal/js/base/bizagi.workportal.controllers.controller.js","jquery/workportal/js/base/bizagi.workportal.controllers.main.js","jquery/workportal/js/base/bizagi.workportal.controllers.menu.js","jquery/workportal/js/base/bizagi.workportal.controllers.workarea.js","jquery/workportal/js/bizagi.workportal.webpart.helper.js","jquery/workportal/js/base/webpart/bizagi.workportal.webparts.webpart.js","jquery/workportal/js/base/action/bizagi.workportal.actions.action.js","jquery/workportal/js/base/action/bizagi.workportal.actions.routing.js","jquery/workportal/js/base/action/bizagi.workportal.actions.search.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.widget.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.webpart.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.print.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.fontsize.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.routing.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.render.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.startForm.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.MySearchList.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.loadForm.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.subMenu.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.search.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.page.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.renderForm.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.genericiframe.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.oldrenderintegration.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.fontsize.js","jquery/workportal/js/desktop/bizagi.workportal.desktop.controllers.main.js","jquery/workportal/js/desktop/bizagi.workportal.desktop.controllers.menu.js","jquery/workportal/js/desktop/bizagi.workportal.desktop.controllers.workarea.js","jquery/workportal/js/desktop/bizagi.workportal.desktop.popup.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.print.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.popup.js","jquery/workportal/desktop/widget/homeportal/bizagi.workportal.desktop.widgets.homeportal.js","jquery/workportal/desktop/widget/dialognav/bizagi.workportal.desktop.widgets.dialognav.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.routing.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.render.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.startForm.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.renderForm.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.mySearchList.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.loadForm.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.subMenu.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.genericiframe.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.search.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.oldrenderintegration.js","jquery/workportal/desktop/widget/createcase/bizagi.workportal.desktop.widgets.createcase.js","jquery/workportal/desktop/widget/updateform/bizagi.workportal.desktop.widgets.updateform.js","jquery/workportal/desktop/widget/templateEngine/bizagi.workportal.desktop.widgets.templateEngine.js","jquery/workportal/js/bizagi.workportal.override.helper.js","jquery/common/bizagi.ui.controls/jquery.ui.controls.loadtmpls.js","jquery/common/bizagi.dragScroll/js/bizagi.dragScroll.js","jquery/common/bizagi.internals/bizagi.workportal.desktop.overrides.js","jquery/workportal/desktop/widget/dashboard/bizagi.workportal.desktop.widgets.dashboard.js","jquery/workportal/desktop/widget/stuff/bizagi.workportal.desktop.widgets.stuff.js","jquery/workportal/desktop/widget/project.base/bizagi.workportal.desktop.widgets.project.base.js","jquery/workportal/desktop/widget/decontextualized.plans/bizagi.workportal.desktop.widgets.decontextualized.plans.js","jquery/workportal/desktop/widget/navigator/bizagi.workportal.desktop.widgets.navigator.js","jquery/workportal/desktop/widget/sidebarhome/bizagi.workportal.desktop.widgets.sidebarhome.js","jquery/workportal/desktop/widget/usersummary/bizagi.workportal.desktop.widgets.usersummary.js","jquery/workportal/desktop/widget/shortcuts/bizagi.workportal.desktop.widgets.shortcuts.js","jquery/workportal/desktop/widget/rightsidebar/bizagi.workportal.desktop.widgets.rightsidebar.js","jquery/workportal/desktop/widget/leftsidebar/bizagi.workportal.desktop.widgets.leftsidebar.js","jquery/workportal/desktop/widget/dummy/bizagi.workportal.desktop.widgets.dummy.js","jquery/workportal/desktop/widget/sidebar/bizagi.workportal.desktop.widgets.sidebar.js","jquery/workportal/js/base/widget/admin/admin.cases.js","jquery/workportal/js/base/widget/admin/admin.caseSearch.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.adhoc.create.process.js","jquery/workportal/desktop/widget/profly/bizagi.workportal.desktop.widgets.profly.js","jquery/workportal/desktop/widget/sessionTimeout/bizagi.workportal.desktop.widgets.sessionTimeout.js","jquery/workportal/desktop/widget/sessionTimeout/expired/bizagi.workportal.desktop.widgets.sessionTimeoutExpired.js","jquery/workportal/desktop/widget/user.privacy/bizagi.workportal.desktop.widgets.user.privacy.js","jquery/workportal/desktop/widget/users.modal/bizagi.workportal.desktop.widgets.users.modal.js","jquery/workportal/desktop/widget/accessDenied/bizagi.workportal.desktop.widgets.accessDenied.js","jquery/plugins/jsgrid/js/jsgrid.js","jquery/common/bizagi/js/bizagi.users.adapter.js"],"names":["$","bizagi","ui","controls","uitable","namespace","availableComponents","css","tmpl","tmpl2","tmpl3","uicombo","uicheckbox","uiradio","uitreeview","uimultiselect","Class","init","dataService","this","rawData","getSecurity","self","def","Deferred","security","jsonSecurityList","menuSecurity","resolve","when","getMenuAuthorization","done","data","currentUser","associatedStakeholders","length","permissions","push","convertSecurityData","each","key","value","authMenu","document","trigger","promise","permsMenu","getRecursivePerms","perms","checkSecurityPerm","module","deferred","bind","getRawData","renderFactory","print","properties","printParams","extend","triggerHandler","widgetName","workportal","widgets","widget","BIZAGI_WORKPORTAL_WIDGET_PRINT","modalParameters","title","localization","getResource","refreshInbox","params","referrer","hasOwnProperty","referrerParams","buttons","text","click","selfButton","frameTemplate","getTemplate","headerTemplate","executePrintWidgetAction","objFrame","strFrameName","Date","getTime","jFrame","printID","jFrameHeader","environment","loader","productBuild","productBuildToAbout","build","appendTo","util","isIE","window","frames","i","name","objDoc","contentWindow","open","objDocStr","innerHTML","html","write","close","win","styleLoading","setTimeout","focus","remove","removeAttr","attr","workportalFacade","resources","componentContainers","subscribers","disposed","templatesDeferred","getWorkportal","publish","eventName","subscribe","callback","event","subscribeOneTime","one","unsubscribe","unbind","render","defer","renderingDeferred","areTemplatedLoaded","pipe","renderContent","postRender","getContent","content","getComponentSelector","component","getComponentContainer","resizeLayout","performResizeLayout","dispose","item","override","disposeTime","loadTemplates","templates","tmplPromises","useNewEngine","undefined","loadTemplate","path","apply","templateService","getTemplateWidget","isRendered","controllers","controller","componentRegex","_super","e","p","liveSave","autoSave","liveProcessesEvents","saveEvent","saveLivePromise","BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID","BIZAGI_WORKPORTAL_WIDGET_INBOX","cookie","expires","setContext","setWidget","addDialogToDialogStack","showDialogWidget","closeCurrentDialog","closeAllDialogs","popupWidget","popWidget","pushWidget","executeAction","disposeWidget","appendWidgetTo","NotificationDispatcher","dispatch","notification","type","refreshQueryFormShortCut","template","workarea","getWorkareaController","menu","getMenuController","resize","currentWidget","currentWidgetParams","getMenu","assert","isEmpty","renderWorkarea","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","start","then","getAction","execute","BIZAGI_WORKPORTAL_ACTION_SEARCH","workareaContainer","cleanWidgets","empty","loadWidgetFromFacade","getWidget","widgetController","renderedContent","dialog","resizeContainer","height","container","containerHeight","adjustableChildren","children","adjustableContainersHeight","fixedContentHeight","element","hasClass","overflowY","addClass","marginTop","Number","replace","finalHeight","overflow-y","find","closest","show","getCurrentUser","loadPreferences","preferencesWP","customPreferencesObj","services","preferences","customPreferencesValues","getPreferences","windowMaintenance","datepicker","setDefaults","currencyInfo","decimalSymbol","decimalSeparator","symbol","digitGroupSymbol","thousandSeparator","groupSeparator","setResource","BIZAGI_DEFAULT_CURRENCY_INFO","decimalDigits","uploadMaxFileSize","BIZAGI_SETTINGS","UploadMaxFileSize","changeData","overrideUserPreferences","command","enableFeatureDisplayOptions","DisplayOptions","base64image","themeLogo","photo","userPicture","hasPicture","initials","userFullName","getInitials","fail","logout","getPreferencesWorkportalCurrentUser","resp","overrideLocalization","changeWidget","jQuery","browser","msie","parseInt","version","idInterval","setInterval","labels","userprofile","menuUsername","labelsUser","about","width","line-height","display","hide","top","padding-left","clearInterval","adjustMenuWP","widthComponentsWithoutResponsive","outerWidth","limitWidth","selectorMenuButtons","indexButtonToHide","indexLastButton","thereIsAButtonOverlaped","position","eq","clean","webpart","hideCasesColumn","columnName","columns","visible","transformCasesInfo","old","imageColumn","newData","transformed","column","displayName","cases","columnTitle","oldColumn","fieldName","dataType","parseBoolean","isOrdered","orderBy","orderType","rows","oldRow","newRow","id","j","fields","totalPages","page","drawGridView","pages","number","active","filters","getCaseId","row","getEntityId","splitHeaderName","finalDispName","dispNameParts","split","getWorkItems","workitemsData","workitems","wi","wiInfo","idWorkItem","idTask","drawThumbnailsView","imageLabelColumn","getImage","files","getFileImage","getEmptyFile","getFile","removeWaitContainer","addWaitContainer","removeClass","templateDestination","resolvedRemplate","getFailServerErrorDeferred","errorTemplateName","errorMessage","message","remoteSeverURL","sharepointProxyPrefix","indexOf","substr","eTemplate","address","helpAddress","msg","getPaginationTemplate","publishShowRenderEvent","alert","deferRet","console","log","isWebpartInIFrame","displayWebPartPopUpExternalIframe","webpartName","postMessageSocket","canvas","whenInitialized","webPartToDraw","iframeidentifier","send","displayWebPartPopUpinIFrame","mask","createElement","className","style","popUpParams","preClosePopUp","ev","eventPhase","closePopUp","addEventListener","attachEvent","closeCanvas","appendChild","webpartCanvasDiv","pathiFrame","location","href","substring","queryStringParams","toString","idCase","idWorkitem","idWfClass","iframe","postmessageSocket","postmessage","remoteServer","destination","origin","receive","parentNode","src","removeChild","iframeclosemsg","resizeInPopUp","heightActivitiFormContainer","body","displayWebPartPopUp","webpartObject","canHide","showCasesMSG","readQueryString","parent","destroy","webpartParams","adjustButtonsToContent","startWaiting","executeWebpart","result","onclick","displayWebPartDialog","dialogParams","showCloseButton","a","webparts","addConfigurationMessage","messageResourceName","doc","ownerDocument","errorTemplate","whenCreated","fullname","whenExecuted","helper","project","isVisible","BIZAGI_IFRAME_IDENTIFIER","shortName","webPartDestine","startReceiving","sendDimensionsiFrame","mandatorysend","canvasobject","onresize","sendDimensionsiFramePostMessage","addResizeListener","iframeDimentions","iframeName","iframeHeight","iframeWidth","notFireToIframe","refresh","prepareForRefresh","newContent","contains","replaceSelector","creating","createWebpart","manageError","canvasError","errorMsg","responseText","endWaiting","append","onWaiting","getElementById","hideParent","routing","getRoute","route","deferredDialogOpened","isOfflineForm","moduleParams","formsRenderVersion","guid","BIZAGI_WORKPORTAL_WIDGET_RENDER","BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION","BIZAGI_WORKPORTAL_WIDGET_ASYNC","BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD","enableWorkPortalMenu","getPreference","hasWorkItems","goToInbox","BIZAGI_WORKPORTAL_WIDGET_START_FORM","parameters","onClose","dialogOpened","closeVisible","dialogClass","response","widgetReference","BIZAGI_WORKPORTAL_WIDGET_ROUTING","isThereAsync","asyncWidget","routeModuleParams","getWidgetByCookie","notifier","injector","get","messageWhenGoToInbox","messageForm","showSucessMessage","workItems","index","isAsynch","radNumber","trim","idWorkflow","taskState","onlyFavorites","order","orderFieldName","group","bizagiConfig","getCustomizedColumnsData","lstIdCases","key2","value2","isArray","TaskName","State","IsFavorite","IsOpen","BIZAGI_WORKPORTAL_WIDGET_SEARCH","showNoResults","showSearch","requestGlobalForm","referrerBackButton","context","isTabletDevice","originarlColor","detectDevice","noresults","redirectToProcess","onlyUserWorkItems","formatRequest","formatCategories","isDate","state","slash","getYear","BIZAGI_WORKPORTAL_WIDGET_INTEGRATION","BIZAGI_WORKPORTAL_WIDGET_WEBPART","BIZAGI_WORKPORTAL_WIDGET_ADVANCE_SEARCH","BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL","BIZAGI_WORKPORTAL_WIDGET_ACTIVITY","BIZAGI_WORKPORTAL_WIDGET_RENDERFORM","BIZAGI_WORKPORTAL_WIDGET_NEWCASE","BIZAGI_WORKPORTAL_WIDGET_QUERIES","BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION","BIZAGI_WORKPORTAL_WIDGET_QUERIES_SHORTCUT","BIZAGI_WORKPORTAL_WIDGET_QUERYFORM","BIZAGI_WORKPORTAL_WIDGET_LISTCASES","BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME","BIZAGI_WORKPORTAL_WIDGET_SUBMENU","BIZAGI_WORKPORTAL_WIDGET_FONTSIZE","BIZAGI_WORKPORTAL_WIDGET_PAGE","BIZAGI_WORKPORTAL_WIDGET_ENTITIES","BIZAGI_WORKPORTAL_WIDGET_REPORTS","BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU","BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART","BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASES","BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE","BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD","BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE","BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE","BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE","BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG","BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER","BIZAGI_WORKPORTAL_WIDGET_ADMIN_TRANSFER_CASE_SECURITY_PERMISSIONS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES","BIZAGI_WORKPORTAL_WIDGET_START_PROCESS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_DISPLAY_OPTIONS","BIZAGI_WORKPORTAL_WIDGET_TREE","BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY","BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION_SEARCH_USER","BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS","BIZAGI_WORKPORTAL_WIDGET_BIZAGI_EVENTS","BIZAGI_WORKPORTAL_WIDGET_BIZAGI_RELEASE","BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_DIAGRAM_HELPER","BIZAGI_WORKPORTAL_WIDGET_PROJECT_ACTIVITY_MAP_TOOLTIP","BIZAGI_WORKPORTAL_WIDGET_PROJECT_USERSUMMARY","BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST","BIZAGI_WORKPORTAL_WIDGET_LOADFORM","BIZAGI_WORKPORTAL_WIDGET_TEMPLATE_ENGINE","BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV","BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME","BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES","BIZAGI_WORKPORTAL_WIDGET_TIMELINE","BIZAGI_WORKPORTAL_WIDGET_ADHOC_PROCESS_MODELER","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_CREATE_PROCESS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_BOOLEAN_EXP","BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUP_REPORT","BIZAGI_WORKPORTAL_WIDGET_PROFLY","BIZAGI_WORKPORTAL_WIDGET_SESSION_TIMEOUT","BIZAGI_WORKPORTAL_WIDGET_SESSION_TIMEOUT_EXPIRED","BIZAGI_WORKPORTAL_WIDGET_USER_PRIVACY","BIZAGI_WORKPORTAL_WIDGET_ACCESS_DENIED","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICES","BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL","BIZAGI_WORKPORTAL_WIDGET_QUERIES_MANAGEMENT","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PERMISSION_REPORT","observableElement","widgetReadyDeferred","isBlocked","getWidgetName","widgetParams","actionName","actionParams","showGraphicQuery","isAdhoc","maximizeOnly","desktop","dialogStack","pop","isProcessOnTheFlyCase","showTimeLine","startAndThen","routingExecute","val","eventAsTasks","fullName","sub","off","arguments","on","unsub","pub","pubDeadLockDetection","reject","pubDef","queueDef","Array","events","_data","isReady","setWidgetReady","checkProcess","checkWorkItems","getCaseSubprocesses","process","subProcessPersonalized","forEach","workitem","formatDate","formatDateFromInvariantStringDate","estimatedSolutionDate","hash","search","queryString","getQueryString","isConfiguredFromHash","hashParams","getHashParams","details","summaryDeferred","currentInboxView","summaryCaseDetails","caseNumber","releaseCurrentActivity","grep","currentState","activity","allowReleaseActivity","renderSummary","parents","renderForm","withOutGlobalForm","cache","htmlContent","showComments","PrintableVersion","StateLog","GraphicQuery","printableVersion","stateLog","graphicQuery","summary","caseSummaryTemplate","formatInvariantDate","delegate","tabs","create","activate","commentsFocus","newPanel","prop","comments","readOnly","tab","renderComments","summarySubProcess","subprocess","subProcesses","custData","caseSummaryTemplateSubprocess","summaryAssigness","assignees","eventsUniqueList","el","inArray","join","activitiesUniqueList","activities","caseSummaryTemplateAssigness","summaryCaseEvents","caseSummaryTemplateEvents","summaryActivities","fullFormat","caseSummaryTemplateActivities","resultRender","renderContainer","getMessageFromNetworkState","online","proxyPrefix","serviceLocator","database","rendering","facade","triggerparams","fromTask","fromWorkItemId","oldrenderevent","eventMethod","eventer","stopPropagation","renderingFacade","idProcess","startForm","concat","form","IsDisposed","searchCriteriasApplied","preProcessValue","control","formClass","createRenderElement","rangeQuery","xpath","processForm","containerParams","getRenderById","setValue","queryFormParams","h_action","h_contexttype","h_idForm","guidForm","getQueryForm","processedForm","match","g1","offset","string","toLowerCase","JSON","parse","contextType","renderingParams","renderStaticForm","BIZAGI_WORKPORTAL_WIDGET_RENDER_FORM","idForm","idEntity","surrogateKey","genericiframe","widgetURL","url","fontsize","sizeSelected","fontsizeTemplate","fontButton","textSize","main","showOldWindow","session-timeout","session-timeout-expired","getIEVersion","renderIENotCompatibleTemplate","BIZAGI_PATH_TO_BASE","renderWidget","closeQuirksModePopup","iDialog","iTotalDialog","popup","options","closed","extendQueryString","showQuirksModePopup","windowParameters","instance","dontClose","innerDialog","queries","shortcut","renderStoredQueries","searchContent","iconsTemplate","menuContent","sec","reportsSecurity","getWidgetByDataUser","siblings","LogOut","preventDefault","Search","setActiveSection","Inbox","showWidgetsPopup","showNewCasePopup","enableMySearch","showMySearchPopup","home","actualWidget","storeWidget","inbox","grid","homeportal","isFunction","resetNavigatorInfo","showQueriesPopup","renderAdminMenu","renderQuickProcessMenu","renderReportsMenu","maximize","getUrl","endPoint","showUserProfileMenu","showQRCodePopup","inputSearchField","renderFontMenu","CURRENT_THEME_REMOVE_IT","showAboutPopup","keyCode","searchValue","emptyNavigatorInfo","$userProfile","target","is","ajax","success","popupContent","modal","allowmaximize","maximized","resizable","draggable","showMenuPopup","sourceElement","buttonSelector","my","at","currentPopup","closePopupInstance","showUserPopup","max-height","activeScroll","disableFrankensteinQueryForms","argsTemplate","currentYear","currentYearVersion","hostName","checkRootCategory","getsRootCategory","getSubMenuData","category","k","v","categoryKey","categoryName","categoryUrl","menuData","menuValidator","AdhocProcessAdmin","AdhocUserGroupAdmin","AdhocUserGroupReport","isIE8","renderSubMenu","menuButton","submenu","categoryClassName","customClickHandler","showEntitiesPopup","arrowPosition","insertAfter","scrollElement","closeDeferred","after","showPopup","popupWidth","popupHeight","float","left","z-index","of","collision","printversion","p_all_rows","formatTabs","formatGroups","appendCaseDetails","formatECM","formatButton","formatGrid","formatRenderContainer","formatContent","tabElement","ul","$caseDetails","setProcess","createdBy","Name","creationDate","idPlan","getPlan","responsePlan","processPath","prepend","containerText","cont","image","file","button","parentContainer","tableControl","pageContent","closeButton","register","registerCallback","contexts","HOME","dashboard","layout","stuff","plans","navigator","sidebar","usersummary","myshortcuts","rightSidebar","empty1","empty2","nav","level","belongs","toLeftSidebarCD","toRightSidebarCD","toTaskSidebarCD","TEMPLATEENGINE-VIEW","paginator","sortbar","mysearchfilter","ENTITY-ENGINE-VIEW","SEARCH-ENGINE-VIEW","mysearchcriteria","CASES-TEMPLATE-VIEW","proccesseslist","filtercases","PLANS-VIEW","topmenu","manager","ACTIVITY","leftSidebar","contentDashboard","caseState","activityDescription","activityState","processState","users","subprocesses","relatedPlan","OVERVIEW","overview","refreshLastItemBreadcrumb","COMMENTS","discussions","discussionSidebar","FILES","filesPreview","PROCESSMAP","processMap","LOG","TIMELINE","timeline","timelineSidebar","PLANCREATE","plan","PLANOVERVIEW","planActivities","planSidebar","planAction","planState","planProgress","planTime","planParent","planUsers","PLANACTIVITIES","PLANFILES","empty3","empty4","empty5","empty6","empty7","PLANCOMMENTS","PLANTIMELINE","PLANSIDEBAR","EDITACTIVITY","activitiesForm","ACTIVITYPLAN","activitySidebar","activityAction","activityTime","activityProgress","activityParent","activityUsers","ACTIVITYPLANCREATE","ACTIVITYPLANOVERVIEW","ACTIVITYPLANCOMMENTS","ACTIVITYPLANFILES","ACTIVITYPLANPROCESSMAP","ACTIVITYPLANLOG","ACTIVITYPLANTIMELINE","REFRESHALL","CONTEXT_HOME","supportNav","setContextsByNotifyEvents","proxy","onNotifyChange","registerInstance","contextsSidebarActivity","contextsWithoutLeftSidebarCaseDashboard","contextsLeftSidebarCaseDashboard","contextsWithoutRightSidebarCaseDashboard","contextsRightSidebarCaseDashboard","d","necesaryClean","setLayout","servicesPD","behaviors","projectDashboard","getContextToShow","dataPD","responseGetCaseSummaryDetails","hasAccessToCase","currentContext","contextToShow","themesEnabled","getCurrentTheme","theme","loadContext","setCurrentTheme","histName","hasGlobalForm","updateView","args","showContextByMenuDashboard","isValidContext","removeCurrentTheme","emit","newInstance","dialognavdata","BIZAGI_WORKPORTAL_DIALOGNAV","paramsData","eventType","fromActionLauncher","guidEntityCurrent","reference","referenceType","showDateNavigator","classContext","workOnITActivitySelector","workOnITProcessSelector","showWorkitem","showAsyncWidget","release","inbox-common-case-summary-subprocess","inbox-common-case-summary-assignees","inbox-common-case-summary-events","inbox-common-case-summary-activities","render-case-summary","paginationTemplate","summaryDisplayed","bizagiScrollbar","autohide","configureSlider","configureHeader","identicalObjects","scrollabletab","tooltipNext","tooltipPrevious","getBackCase","getNextCase","restoreStatus","queryFormAction","urlParameters","getCasesByFolder","customized","casesGroupedByFolder","idFolder","hover","lastQueryFullKey","idtask","releaseConfirmTemplate","confirmContent","releaseActivity","status","showMessageBox","printFormCommand","printform","summaryContainer","hideSummary","showSummary","animate","renderPanel","sliderPanel","panelArrow","forceResize","windowWidth","openOldWorkportalForm","getListKey","renderform","afterLoad","backURL","mySearchList","mySearchListWrapper","loadtemplates","renderSearchLists","mySearchListTmpl","getSearchLists","searchLists","$searchLists","configureHandlers","closeModal","onListItemClick","keypress","$target","currentTarget","guidform","displayname","guidEntity","publishParams","summaryDecorator","Object","keys","validateForm","renderValues","forceCollectData","collectRenderValuesQueryForm","filterObject","metadataFilters","getRenders","getFilterControl","defineFilterObject","filter","displayValue","getDisplayValue","editable","performQuery","guidSearch","pageSize","calculateFilters","onlyLocalResults","dataParams","homeportalInstance","_context","itemFilter","searchTypeFilter","searchType","toUpperCase","typeSearch","loadForm","subMenu","renderSubMenuContent","scrollVertical","listTemplate","isAdminMenu","listContainer","callBack","ThemeBuilder","windowOpenBlank","asyncECMUpload","showWidgetPopup","enableMultipleCasesReassigment","CaseAdmin","enableAsyncECMUploadJobs","authorized","getSubItemsAuthorized","deleteMenuOption","features","enableOldBusinessPoliciesAdministration","enableNewBusinessPoliciesAdministration","unshift","typeIcon","isEnableFeature","BIZAGI_WORKPORTAL_WIDGET_ADMIN_UNLOCK_FORMS","UserAdmin","StakeholderAdmin","AuthenticationLogQuery","EncryptionAdmin","UserPendingRequests","UnlockFormsAdmin","AsynchronousWorkitemRetries","UserDefaultAssignation","Profiles","AlarmAdmin","Licenses","GRDimensionAdmin","DocumentTemplates","ProcessAdmin","LanguageAdmin","EntityAdmin","AdhocEntityAdmin","AdhocCreateProcess","showCustomWidgetPopup","UserPermissionReport","Holidays","OAuthApplications","ProjectName","UsersDelegation","BusinessPolicies","showContentPopup","Vocabularies","loadBusinessPolicesWidget","getCathegoriesMenuList","showBreadCrumb","eventHandlerGoBackBreadCrumb","checkIsAlive","eventHandlerCategoryGroupsParent","eventHandlerCategoryGroupsChildrenWithoutCustomClick","Jparent","categoryDisplayName","menuList","categoriesGroupsChildrenList","getCategoriesGroupsChildren","getMenuList","isIE11","isEdge","localStorage","setItem","sessionStorage","bizagiAuthentication","loadDashboardQuickProcess","childrenList","groupCategoryChildren1","groupCategoryChildren2","groupCategoryChildren3","groupCategoryChildren4","sortChildList","list","sort","b","sortParentList","menulist","groupCategory1","getItemMenuList","groupCategory2","groupCategory3","groupCategory4","listmenu_children","groupCategory","routeEvents","dispatchEvent","newLiveProcess","widgetParameters","needsQuicksMode","getPageHacks","hackParams","openBACase","sHref","routingAction","changeToWidget","hack","getInternetExplorerVersion","injectCss","afterLoadParams","defaultWidth","splice","idUser","fromDate","now","toDate","getEffectiveDuration","load","fadeIn","callInside","cssList","getStyle","iframeContent","contents","$self","inputClasses","isAdhocProcess","adhocIds","inbox-grid-cases","inbox-common-case-summary","inbox-common-case-summary-oldrender","search-details","contentDetails","pdata","pageSelector","actualPage","caseId","processId","idAdhocProcess","enableTimelineByProcessType","isAvailableTimelineByProcessType","searchTemplate","searchDetailsTemplate","searchPagination","timeLine","TimeLine","enableFeatureShowTimelineButton","formatMonetaryCells","groupByCaseNumber","setFormat","formatValue","getRadNumberColumnIndex","l","showColumn","columnIndex","createGroupedHeader","rowIndex","getRadNumber","isComplex","tooltip","first","showCase","elmnt","idObject","favoriteType","addFavorite","delFavorite","itemSelector","confirmationMsg","showConfirmationBox","dissasociateCaseFromFolder","pagination","pageToshow","pageNumber","previousPage","nextPage","paginationHtml","bizagiPagination","maxElemShow","listElement","clickCallBack","smartfoldersParameters","caseSummaryContainer","hasComments","renderedTemplate","caseSummaryDialog","isPropagationStopped","getWorkitems","iframeOldRender","getCaseFormsRenderVersion","formsVersion","renderSummaryForm","preview","currentWorkitemId","workitemCaseId","summaryForm","cssLocation","mozilla","webkit","oldrenderintegration","icoTaskState","integration-old-render","insertIframeOldRender","getInjectJavaScript","getInjectJS","_processId","_mapping","mapping","_idParentCase","idParentCase","_mappingstakeholders","mappingstakeholders","_guidprocess","guidprocess","createcase","$content","getStartForm","_getServiceParams","_getRenderingFacade","_getCanvasForm","_rendering","RPproxyPrefix","getMapping","map","stringify","$canvas","onCaseCreated","_guidForm","_entityGuid","entityGuid","_surrogateKey","_readonlyform","readonlyform","updateform","getEntityForm","_overrideHandlers","idPageCache","originalProcessButton","processButton","buttonProperties","endLoading","actionService","casetoolbar","usersCasesService","actionsEventsService","accumulatedcontext","processActionService","templateEngine","templateEngineElement","templateEngineTooltip","templateEmptyData","selectorCheckboxItems","_currentPage","entitiesSelected","onEntityChecked","getCommonActions","updateData","setValues","onFormActionExecuted","onFormRuleExecuted","onFormExecuted","heightBreadCrumb","outerHeight","heightMenu","scroll","sticky","heightSticky","scrollTop","_referrer","_page","_totalRecords","totalRecords","_filters","_defaultFilterApplied","defaultFilterApplied","_guidSearch","_fromActionLauncher","_reference","_referenceType","_xpath","_guidEntityCurrent","_pageSize","_onlyLocalResults","entityDataParams","filtersAppliedCounter","getEntityData","deferProcessEntities","clone","processEntities","entitiesData","checkAll","renderEntities","commonActions","getTemplateEngine","renderDataService","service","factory","initAsyncStuff","router","addContext","getLevelNavigator","currentLevelNavigator","contextEvent","appliedFilters","getSearchData","setFiltersData","getCollectionEntityData","getFiltersEntityData","filtersData","processFiltersData","updateCounterFiltersApplied","hideSortBar","appliedFilter","count","defaultValues","applied","attribute","filtersApplied","templateType","engine","entities","entity","entityId","entityData","isDefaultTemplate","guidTemplate","paramsRender","makeArray","requestRepeat","idCasesOfProcessEntitiesPromise","lastParamsSendit","getIdCasesOfProcessEntities","generalDefer","collectionDeferreds","$dataViewList","entitiesLength","$elementsTmpl","$template","renderTemplate","getEmptyDataMessage","isRefresh","$templateData","isChecked","collectionGetActionsDeferred","idCases","$cardWrapper","$casetoolbar","getCaseToolbar","casetoolbarData","idcase","always","getEntityActionsAndEvents","$footer","actionData","loadEvents","startLoading","delay","overlay","getActionsView","responseActions","$actionsView","actionsView","actionsData","$item","getCheckBox","showCheckItem","removeCheckItem","model","surrogateKeys","itemsSelected","guidentity","$inputs","input","refreshRegister","idBox","$templateBox","operator","replaceWith","outerHTML","counterFilterParams","customWorkportalHandlers","customizeWorkportalHandler","handler","newUrl","original","prototype","customizeWorkportalWidget","extensionMethod","widgetImplementation","getWidgetImplementation","eval","customButtons","addCustomMenuButton","customButtonTemplate","menuButtonContainer","isAvailable","customButton","addDataService","functionName","fn","extensionObject","tmpls","templatesMap","arrPromises","_create","clicked","curYPos","curXPos","cursor","$scrollable","pageY","pageX","scrollLeft","_move","x","y","moveX","moveY","Widget","call","enableFolder","enableSmartFolders","enableListOfRecentProcesses","enableCustomizeReports","enablePrintFromEditForm","enableDebug","enableE2EInterface","disableOldInbox","enableBatchRequest","forceBatchRequest","showAssignees","enableSecurityCaseDashBoard","enableQueriesClassicMenu","disableAbortCases","enableAdhocProcess","enableCCBCCFeatureOnLiveProcesses","enableReviewModeFeatureOnLiveProcesses","enableFilterByProcessGroupOnLiveProcesses","enableLocalizationInModelerOnLiveProcesses","enablePredefinedPerformersOnLiveProcesses","enableMaximizeModalsOption","enableStartPageDisplayOption","enablePing","enableECMMetadataMultiaction","validateGridsOnButtonClick","enableCustomFormats","enableShareActivity","enableFormatMoneyColumnQueryResult","items","iconclass","icon","getData","slice","onShowCases","$route","$title","idworkflow","collections","onClickEntity","selectItem","getUserStuff","buildModel","lf","Math","differenceMillisecondsServer","uploadMaxFilesSize","supportFileExt","getDateServer","dateFormatter","getDifferenceBetweenDates","date","mergePropertiesActivitiesWithWorkitems","workItemFilter","workItem","guidActivity","startDate","wiEntryDate","finishDate","wiSolutionDate","workItemState","estimatedFinishDate","wiEstimatedSolutionDate","base","description","decontextualized.plans","Plans","getServerDateDifference","resolveGetDateServer","onClickCard","flowContext","isOpen","decontextualized","flagDisplayDate","fromClickBreadCrumb","caseLink","child","popup-release","releaseDialogBox","getDataObj","info","_level","printCase","goToBack","assignationEveryoneAction","formContent","$container","updateLastCrumbParamsInfo","getLevel","goToPreviousCrumb","crumbEvent","plugins","popupRelease","buttonAccept","buttonCancel","onClickAcceptRelease","onClickCancelRelease","getBreadCrumbInfo","setBreadCrumbInfo","drawBreadCrumb","breadCrumbInfo","showSteps","crumbItem","crumbContent","drawCrumb","itemCrumb","isPrincipalHome","goToCrumb","crumb","skipRefresh","contextActivity","getParentContext","cutContext","deleteRemainingCrumbs","pathSize","crumbBack","resetBreadCrumb","copyDataObjectWithoutReference","updateInfo","lastCrumb","secondLastCrumb","cleanBreadCumb","firstCrumb","factCrumbItem","hasGuidEntityInBreadCrumb","newFactCrumbItem","hasXpathInBreadCrumb","steps","drawDateNavigator","onDisplayDate","recalculateHomeNavbar","setWidthToNavigationPanel","navigationPanel","setEnabledLeftSidebar","setEnabledRightSidebar","setEnabledBreadCrumb","setEnabledBackButton","getActivityName","setStateBarNavigator","notMigratedUrl","queryForm","actionForm","queryParams","pageToShow","recalculateQueryForm","reports","fromBackButton","activityName","showButtonPrintForm","showUrlHelp","showButtonAssignationEveryone","regional","currentDate","dayNames","getDay","monthNames","getMonth","getDate","getFullYear","$wrapperButtonPrint","$wrapperUrlHelp","helpUrl","validateUrlWellFormed","initilizeActionMenu","valParams","assignationEveryone","showReleaseButton","enabledReadOnlyForAsigneeToEveryone","isAssignationMethodEveryone","getAssignationEveryoneParams","canWorkOnThisTask","totalAssigneesCount","currentUserIsCurrentAsignee","detach","actionTakeOwnership","localParams","refreshAllWidgets","waitForLoadCompletely","takeOwnershipActivity","ol","il","$date","sidebarhome","showStakeholders","$tooltip","getInfoToUser","stakeholders","totalStakeholders","stakeholdersToShow","stakeholdersHidden","showMore","user","userName","orgArray","requestsInProgressProcessGuid","shortcuts","onClickShortcut","getMyShortcutsByCategory","actionsHasStartForm","hasStartForm","showConfirmation","executeProcessAction","stopLoading","actionCreateCase","launchActionsAfterCreateCase","showErrorMessage","printf","behaviorCollapsiblePanels","right-sidebar","enableOrDisableRightSidebar","eventsHandler","addBottomPadding","onCollapsePanel","addClassesCollapseSideBar","disableSidebar","enableSidebar","openRightSidebar","closeRightSidebar","collapseSideBar","setDisabledSidebar","right","left-sidebar","showTooltip","classArrow","textTooltip","tooltipClass","classSuffix","dummy","adhoc.create.process","addEventHandlers","isValidForm","next","nameValidation","onClickCancel","onSubmitFormCreateProcess","paramsNewProcess","showErrorAlertDialog","createNewAdhocProcess","isIE10OrLower","error","project-filespreview-wrapper","argumentsTemplate","paramsURL","encodeURI","generalTmpl","isIE11OrLower","reloadToDashboardWhenLoadIFrame","isChrome","reload","waitForContentDocumentOnIframe","contentDocument","currentFile","filesNumber","profly","sessionTimeoutService","_onClickMinValue","keepSessionOpen","removeXClose","sessionTimeout","redirectToLogoutPage","sessionTimeoutExpired","user-privacy","onDownloadReport","downloadReportUser","privacy","usuarios","showActivityInfo","isActivity","users-modal","clickArrow","contentItemSelected","access-denied","accessDenied","JSGRID_DATA_KEY","JSGRID_ROW_DATA_KEY","JSGRID_EDIT_ROW_DATA_KEY","SORT_ORDER_ASC","getOrApply","defaultController","loadData","noop","insertItem","updateItem","deleteItem","Grid","config","$element","_container","_editingRow","_sortField","_sortOrder","_firstDisplayingPage","_init","updateOnResize","rowClass","rowRenderer","rowClick","editing","editItem","rowDoubleClick","noDataContent","noDataRowClass","heading","headerRowRenderer","headerRowClass","headerCellClass","filtering","filterRowRenderer","filterRowClass","inserting","insertRowRenderer","insertRowClass","editRowRenderer","editRowClass","confirmDeleting","deleteConfirm","selecting","selectedRowClass","oddRowClass","evenRowClass","cellClass","sorting","sortableClass","sortAscClass","sortDescClass","paging","pagerContainer","pageIndex","pageButtonCount","pagerFormat","pagePrevText","pageNextText","pageFirstText","pageLastText","pageNavigatorNextText","pageNavigatorPrevText","pagerContainerClass","pagerClass","pagerNavButtonClass","pagerNavButtonInactiveClass","pageClass","currentPageClass","customLoading","pageLoading","autoload","loadIndication","loadIndicationDelay","loadMessage","loadShading","invalidMessage","invalidNotify","messages","errors","onInit","onRefreshing","onRefreshed","onPageChanged","onItemDeleting","onItemDeleted","onItemInserting","onItemInserted","onItemEditing","onItemUpdating","onItemUpdated","onItemInvalid","onDataLoading","onDataLoaded","onOptionChanging","onOptionChanged","onError","invalidClass","containerClass","tableClass","gridHeaderClass","gridBodyClass","_initLoadStrategy","_initController","_initFields","_attachWindowLoadResize","_attachWindowResizeCallback","_callEventHandler","loadStrategy","jsGrid","loadStrategies","PageLoadingStrategy","DirectLoadingStrategy","_loadStrategy","_controller","source","loadIndicator","LoadIndicator","validation","Validation","field","isPlainObject","Field","_grid","_refreshSize","_detachWindowResizeCallback","option","optionChangingEventArgs","optionChangedEventArgs","oldValue","newValue","_handleOptionChange","fieldOption","_normalizeField","_renderGrid","_refreshContent","_refreshPager","openPage","cancelEdit","_clear","removeData","_createHeader","_createBody","_pagerContainer","_createPagerContainer","_loadIndicator","_createLoadIndicator","_validation","_createValidation","shading","clearTimeout","_loadingTimer","$headerRow","_headerRow","_createHeaderRow","$filterRow","_filterRow","_createFilterRow","$insertRow","_insertRow","_createInsertRow","$headerGrid","_headerGrid","_header","_scrollBarWidth","_content","$bodyGrid","_bodyGrid","_body","_eachField","$result","$th","_prepareCell","cell","cssprop","align","filterTemplate","insertTemplate","eventParams","reset","_resetSorting","_resetPager","_setPage","_clearSortingCss","_refreshHeading","_refreshFiltering","_refreshInserting","toggle","_createNoDataRow","indexFrom","firstDisplayIndex","indexTo","lastDisplayIndex","itemIndex","_createRow","amountOfFields","_renderCells","_getRowClasses","_attachRowHover","classes","$row","_createCell","fieldValue","_getItemFieldValue","cellRenderer","itemTemplate","props","shift","_setItemFieldValue","current","_setSortingParams","_setSortingCss","_reversedSortOrder","isNumeric","f","fieldIndex","_visibleFieldIndex","_sortData","sortFactor","_sortFactor","sortField","item1","item2","sortingFunc","_itemsCount","itemsCount","_pagesCount","floor","$pagerContainer","_createPager","showPager","pagerRenderer","pageCount","_createPagerByFormat","itemCount","pagerParts","pagerPart","_createPages","_createPagerNavButton","firstDisplayingPage","_createPagerPageNavButton","showPrevPages","_createPagerCurrentPage","_createPagerPage","showNextPages","isActive","_createPagerButton","$link","_refreshHeight","_refreshWidth","$ghostContainer","$ghostContent","innerWidth","widthExcludingScrollBar","nonBodyHeight","_controllerCall","method","param","isCanceled","doneCallback","_showLoading","Error","_errorHandler","_hideLoading","getFilter","loadParams","_sortingParams","cancel","loadedData","finishLoad","filterValue","sortOrder","getSorting","sortingParams","clearFilter","insertingItem","_getValidatedInsertItem","insertedItem","finishInsert","_getInsertItem","_validateItem","insertValue","validationErrors","_rowIndex","validate","rules","_setCellValidity","invalidArgs","$cell","toggleClass","clearInsert","insertRow","rowByItem","_editRow","jquery","nodeType","_itemIndex","$editRow","_createEditRow","insertBefore","editTemplate","editedItem","_getValidatedEditedItem","_updateRow","_getEditedItem","_getEditRow","$updatingRow","updatingItem","updatingItemIndex","previousItem","updatedItem","$updatedRow","_finishUpdate","updatedItemIndex","editValue","confirm","_deleteRow","deletingItem","deletingItemIndex","finishDelete","methodArgs","methodResult","locales","setLocale","obj","localeConfig","componentPrototype","locale","lang","zIndex","shaderClass","loadPanelClass","_initContainer","_initShader","_initLoadPanel","_shader","bottom","_loadPanel","$loadPanel","actualWidth","actualHeight","marginLeft","min","deletedItem","deletedItemIndex","isDefined","sortStrategies","str1","str2","localeCompare","n1","n2","dt1","dt2","numberAsString","parseFloat","_normalizeRules","_","rule","validator","_normalizeRule","_applyNamedValidator","validatorName","validators","required","rangeLength","minLength","maxLength","pattern","RegExp","test","range","max","_getSortingFunc","sorter","_value","TextField","autosearch","filterControl","_createTextBox","which","insertControl","editControl","NumberField","TextAreaField","_createTextArea","textarea","numberValueType","stringValueType","SelectField","selectedIndex","valueField","textField","firstItemValue","valueType","resultItem","_createSelect","select","CheckboxField","_createCheckbox","checked","disabled","indeterminate","$cb","checkbox","ControlField","_configInitialized","buttonClass","modeButtonClass","modeOnButtonClass","searchModeButtonClass","insertModeButtonClass","editButtonClass","deleteButtonClass","searchButtonClass","clearFilterButtonClass","insertButtonClass","updateButtonClass","cancelEditButtonClass","searchModeButtonTooltip","insertModeButtonTooltip","editButtonTooltip","deleteButtonTooltip","searchButtonTooltip","clearFilterButtonTooltip","insertButtonTooltip","updateButtonTooltip","cancelEditButtonTooltip","editButton","deleteButton","clearFilterButton","modeSwitchButton","_initConfig","_hasFiltering","_hasInserting","hasFiltering","hasInserting","_createFilterSwitchButton","_createInsertSwitchButton","_createModeSwitchButton","add","_createEditButton","_createDeleteButton","_createSearchButton","_createClearFilterButton","_createInsertButton","_createUpdateButton","_createCancelEditButton","_createOnOffSwitchButton","cssClass","isOnInitially","isOn","updateButtonState","$button","_createGridButton","isInserting","cls","clickHandler","usersAdapter","matchExtendedInfo","usersWithExtendedInfo","uuser","u","extendedInfo","createJsonUserInfo","userAssigned","username","picture","email","isAssignee","owner","participant","isParticipant","isAnonymized","anonymizedUserInformation","matchUsersForExtendedInfoCase","casee","justAssignees"],"mappings":"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","sourcesContent":["if(!$.bizagi){\r\n\t$.bizagi = {ui:{}};\r\n}\r\n\r\n$.bizagi.ui = {\r\n\tcontrols:{\r\n\t\t\tuitable:{\r\n\t\t\t\tnamespace : 'bizagi.ui.controls.uitable',\r\n\t\t\t\tavailableComponents:['uicombo','uiradio', 'uicheckbox'],\r\n\t\t\t\tcss:'biz-ui-controls-table',\r\n\t\t\t\ttmpl: 'bizagi.ui.controls.table.template',\r\n\t\t\t\ttmpl2: 'bizagi.ui.controls.table.tr.template',\r\n\t\t\t\ttmpl3: 'bizagi.ui.controls.table.list.template'\r\n\t\t\t},\r\n\t\t\tuicombo:{\r\n\t\t\t\tnamespace: 'bizagi.ui.controls.uicombo',\r\n\t\t\t\tcss: 'biz-ui-controls-combo',\r\n\t\t\t\ttmpl: 'bizagi.ui.controls.combo.template',\r\n\t\t\t\ttmpl2: 'bizagi.ui.controls.combo.list.template'\r\n\t\t\t},\r\n\t\t\tuicheckbox:{\r\n\t\t\t\tnamespace: 'bizagi.ui.controls.uicheckbox',\r\n\t\t\t\tcss: 'biz-ui-controls-checkbox',\r\n\t\t\t\ttmpl: 'bizagi.ui.controls.checkbox.template'\r\n\t\t\t},\r\n\t\t\tuiradio:{\r\n\t\t\t\tnamespace: 'bizagi.ui.controls.uiradio',\r\n\t\t\t\tcss: 'biz-ui-controls-radio',\r\n\t\t\t\ttmpl: 'bizagi.ui.controls.radio.template'\r\n\t\t\t},\r\n\t\t\tuitreeview: {\r\n\t\t\t\tnamespace: 'bizagi.ui.controls.uitreeview',\r\n\t\t\t\tcss: 'biz-ui-controls-treeview',\r\n\t\t\t\ttmpl: 'bizagi.ui.controls.treeview.template'\r\n\t\t\t},\r\n\t\t\tuimultiselect: {\r\n\t\t\t\tnamespace: 'bizagi.ui.controls.multiselect',\r\n\t\t\t\tcss: 'biz-ui-controls-multiselect',\r\n\t\t\t\ttmpl: 'bizagi.ui.controls.multiselect.template'\r\n\t\t\t}\r\n\t\t}\r\n};","/*\r\n*   Name: BizAgi Workportal Security Command\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define a common class to access the security data\r\n*/\r\n\r\n\r\n$.Class(\"bizagi.workportal.command.security\", {}, {\r\n\r\n\r\n    init: function (dataService) {\r\n        var self = this;\r\n        self.dataService = dataService;\r\n        self.rawData = {};\r\n    },\r\n\r\n    getSecurity: function () {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        self.security = {};\r\n        self.jsonSecurityList = {};\r\n\r\n        if (bizagi.menuSecurity) {\r\n            def.resolve(bizagi.menuSecurity);\r\n        } else {\r\n            \r\n            $.when(self.dataService.getMenuAuthorization()).done(function (data) {\r\n                if(bizagi.currentUser.associatedStakeholders && bizagi.currentUser.associatedStakeholders.length > 0){\r\n                    data.permissions.push({\"associatedStakeholders\": []});\r\n                }\r\n                self.rawData = data;\r\n                bizagi.menuSecurity = self.convertSecurityData(data);\r\n                self.jsonSecurityList = data;\r\n                $.each(self.security, function (key, value) {\r\n                    authMenu[key] = value;\r\n                });\r\n\r\n                $(document).trigger(\"securityLoaded\", {});\r\n\r\n                def.resolve(bizagi.menuSecurity);\r\n            });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    convertSecurityData: function (data) {\r\n        var permsMenu = {};\r\n        var getRecursivePerms = function (perms) {\r\n            $.each(perms, function (key, value) {\r\n                if (typeof value == 'object') {\r\n                    if (typeof key != \"number\") {\r\n                        permsMenu[key] = true;\r\n                    }\r\n                    getRecursivePerms(value);\r\n                } else {\r\n                    permsMenu[value] = true;\r\n                }\r\n            });\r\n        };\r\n        getRecursivePerms(data.permissions);\r\n        return permsMenu;\r\n    },\r\n\r\n    checkSecurityPerm: function (module) {\r\n        var self = this;\r\n        module = module || \"\";\r\n        var deferred = $.Deferred();\r\n\r\n        if (!bizagi.menuSecurity) {\r\n            $(document).bind(\"securityLoaded\", function () {\r\n                deferred.resolve(!!bizagi.menuSecurity[module]);\r\n            });\r\n        } else {\r\n            deferred.resolve(!!bizagi.menuSecurity[module]);\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    getRawData: function () {\r\n        return this.rawData;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Workportal Security Command\r\n*   Author: David Andres Nio\r\n*   Comments:\r\n*   -   This script will define a common class to print forms, and edit mode forms\r\n*/\r\n\r\n\r\n$.Class(\"bizagi.workportal.command.printform\", {}, {\r\n\r\n    init: function (renderFactory) {\r\n        var self = this;\r\n\r\n        self.renderFactory = renderFactory;\r\n    },\r\n\r\n    print: function (properties) {\r\n\r\n        var self = this;\r\n\r\n        var printParams = $.extend({}, properties);\r\n\r\n        $(document).triggerHandler(\"showDialogWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT,\r\n            modalParameters: {\r\n                title: bizagi.localization.getResource(\"render-actions-print\"),\r\n                refreshInbox: false\r\n            },\r\n            params: printParams,\r\n            referrer: (bizagi.hasOwnProperty('referrerParams') && bizagi.referrerParams.hasOwnProperty('referrer')) ? bizagi.referrerParams.referrer : \"inboxGrid\",\r\n            buttons: [\r\n                {\r\n                    text: bizagi.localization.getResource(\"workportal-widget-dialog-box-print\"),\r\n                    click: function () {\r\n                        var selfButton = $(this);\r\n\r\n                        var frameTemplate = self.renderFactory.getTemplate(\"print-frame\");\r\n                        var headerTemplate = self.renderFactory.getTemplate(\"print-frame-header\");\r\n\r\n                        var executePrintWidgetAction = function() {\r\n\r\n                            /**/\r\n                            // Create a random name for the print frame.\r\n                            var strFrameName = (\"printer-\" + (new Date()).getTime());\r\n\r\n                            var jFrame = $.tmpl(frameTemplate, { printID: strFrameName });\r\n                            var jFrameHeader = $.tmpl(headerTemplate, { environment: bizagi.loader.environment, productBuild: bizagi.loader.productBuildToAbout, build: bizagi.loader.build });\r\n\r\n\r\n                            jFrame.appendTo($(\"body:first\"));\r\n\r\n                            // Get a FRAMES reference to the new frame.\r\n                            var objFrame;\r\n\r\n                            if (bizagi.util.isIE()) {\r\n                                objFrame = window.frames[strFrameName];\r\n                                if(!objFrame) {\r\n                                    var i = 0;\r\n                                    var length = window.frames.length;\r\n                                    for(; i < length; i++) {\r\n                                        if(window.frames[i] && window.frames[i].name == strFrameName) {\r\n                                            objFrame = window.frames[i];\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                objFrame = window.frames[strFrameName];\r\n                            }\r\n\r\n                            // Get a reference to the DOM in the new frame.\r\n                            var objDoc = objFrame.document || objFrame.contentWindow.document;\r\n\r\n                            // Write the HTML for the document. In this, we will\r\n                            // write out the HTML of the current element.\r\n                            objDoc.open();\r\n                            var objDocStr = \"<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\">\";\r\n\r\n                            objDocStr += \"<html style='overflow: visible !important'> <head> <title> </title>\";\r\n\r\n                            objDocStr += jFrameHeader[0].innerHTML;\r\n\r\n                            objDocStr += \"</head> <body class='bz-wp-widget-print bz-wp-widget-print-load' style='overflow: visible !important'>\";\r\n\r\n                            objDocStr += $(\".bz-wp-widget-print\").html();\r\n\r\n                            objDocStr += \"</body></html>\";\r\n\r\n\r\n                            objDoc.write(objDocStr);\r\n\r\n                            objDoc.close();\r\n                            $(\".ui-bizagi-cell-readonly\", objDoc).css(\"maxHeight\", \"100%\");\r\n                            if (bizagi.util.isIE()) {\r\n                                var win = window.open(\"\", \"\", \"top=0,left=0,width=10,height=10\");\r\n\r\n                                var styleLoading = '';\r\n                                styleLoading += '<style>';\r\n                                styleLoading += 'html{background:#293f55; color:#fff; text-align:center;}';\r\n                                styleLoading += '</style>';\r\n\r\n                                var textStyle = 'padding:10px auto; width:100%; text-align:center; font-family:Arial; font-size:12px;';\r\n\r\n                                win.document.open();\r\n                                win.document.write(styleLoading + '<div id=\"loading-emp\" style=\"' + textStyle + '\">' + bizagi.localization.getResource(\"webpart-render-loading\") + '</div>');\r\n                                win.document.close();\r\n\r\n                                win.document.open();\r\n                                win.document.write(objDocStr);\r\n                                win.document.close();\r\n\r\n                                win.print();\r\n                                setTimeout(function() {\r\n                                    win.close();\r\n                                }, 10000);\r\n                            }\r\n                            else {\r\n                                objFrame.focus();\r\n                                setTimeout(function() {\r\n                                    objFrame.print();\r\n                                }, 500);\r\n                            }\r\n\r\n                            // Have the frame remove itself in about a minute so that\r\n                            // we don't build up too many of these frames.\r\n                            setTimeout(function() {\r\n                                jFrame.remove();\r\n                            }, 1000);\r\n\r\n                            selfButton.removeAttr('disabled');\r\n                        };\r\n\r\n                        selfButton.attr('disabled', 'disabled');\r\n\r\n\r\n                        if ($('#bz-wp-widget-print').length === 0) {\r\n                            setTimeout(function () {\r\n                                executePrintWidgetAction();\r\n                            }, 1000);\r\n                        } else {\r\n                            executePrintWidgetAction();\r\n                        }\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi Workportal Main Controller\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class to handle workportal layouts for any device\r\n*/\r\n\r\n$.Class.extend(\"bizagi.workportal.controllers.controller\", {}, {\r\n\r\n    /**\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService) {\r\n        // Set workportal facade\r\n        this.workportalFacade = workportalFacade;\r\n\r\n        // Set data service\r\n        this.dataService = dataService;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set a component container hash to use with templates\r\n        this.componentContainers = {};\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n\r\n        // Flag to check if the element is disposed\r\n        this.disposed = false;\r\n\r\n        // Define an object to hold the templates used in the widget\r\n        this.tmpl = {};\r\n\r\n        //Define deferred to know if the templates were loaded\r\n        this.templatesDeferred = null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the current workportal\r\n    */\r\n    getWorkportal: function () {\r\n        return this.workportalFacade.workportal;\r\n    },\r\n\r\n    /**\r\n    *   Publish an event so any controller can subscribe to it\r\n    */\r\n    publish: function (eventName, params) {\r\n        if (this.disposed) return null;\r\n        return $(document).triggerHandler(eventName, params);\r\n    },\r\n\r\n    /**\r\n    *   Subscribe to an event that any controller could trigger\r\n    */\r\n    subscribe: function (eventName, callback) {\r\n        if (this.disposed) return null;\r\n        $(document).bind(eventName, callback);\r\n        this.subscribers.push({ event: eventName });\r\n    },\r\n\r\n    /**\r\n    *   Subscribe to one time event that any controller could trigger\r\n    */\r\n    subscribeOneTime: function (eventName, callback) {\r\n        if (this.disposed) return null;\r\n        $(document).one(eventName, callback);\r\n        this.subscribers.push({ event: eventName });\r\n    },\r\n\r\n    /**\r\n    *   Un Subscribe to an event that any controller could trigger in this document\r\n    */\r\n    unsubscribe: function (eventName, callback) {\r\n        if (this.disposed) return null;\r\n        if (callback) {\r\n            $(document).unbind(eventName, callback);\r\n        }\r\n        else { $(document).unbind(eventName); }\r\n    },\r\n\r\n    /**\r\n    *   Makes the base processing of the layout (mix templates + data)\r\n    *   after all that processing will call a post-render method to\r\n    *   be implemented in each device to apply custom plugins\r\n    *   Returns a promise because the rendering could be asynchronous\r\n    */\r\n    render: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        self.renderingDeferred = new $.Deferred();\r\n\r\n        // Render content\r\n        $.when(self.areTemplatedLoaded())\r\n        .pipe(function () {\r\n            return self.renderContent();\r\n        })\r\n        .done(function () {\r\n\r\n            // Call post-render method\r\n            self.postRender();\r\n\r\n            // Resolve deferred\r\n            defer.resolve(self.getContent());\r\n            self.renderingDeferred.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Returs the rendered content\r\n    */\r\n    getContent: function () {\r\n        return this.content;\r\n    },\r\n\r\n    /*\r\n    *   Returns the mapped resource\r\n    */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *\r\n    */\r\n    renderContent: function () {\r\n        // Override on implementations\r\n        return \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () { },\r\n\r\n    /*\r\n    *   Returns the component replaced tag selector\r\n    */\r\n    getComponentSelector: function (component) {\r\n        return \"[data-bizagi-component=\" + component + \"]\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the component replaced tag selector\r\n    */\r\n    getComponentContainer: function (component) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content || content.length == 0) return null;\r\n\r\n        // Find component parent and cache it\r\n        //var componentElement = self.componentContainers[component];\r\n        //if (componentElement == null) {\r\n            // Find the component inside the main content\r\n            //componentElement = $(self.getComponentSelector(component), content);\r\n\r\n            // If still not found, try to check if content element is the component\r\n          //  if (componentElement.length == 0 && content.is(self.getComponentSelector(component))) {\r\n          //      componentElement = content;\r\n          //  }\r\n\r\n            // Cache the component\r\n           // self.componentContainers[component] = componentElement;\r\n        //}\r\n        //return self.componentContainers[component];\r\n        return $(self.getComponentSelector(component), content);\r\n    },\r\n\r\n    /*\r\n    *   Asks for a full resize\r\n    */\r\n    resizeLayout: function () {\r\n        this.publish(\"resizeLayout\");\r\n    },\r\n\r\n    /*\r\n    * Do stuff when a resize has been triggered\r\n    */\r\n    performResizeLayout: function () { },\r\n\r\n    /*\r\n    *   Disposes the widget\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n        \r\n        if (self.subscribers != null) {\r\n            // Remove all subcriptions\r\n            $.each(self.subscribers, function (i, item) {\r\n                self.unsubscribe(item.event);\r\n            });\r\n        }\r\n        \r\n        setTimeout(function () {\r\n            bizagi.util.dispose(self);\r\n            self.disposed = true;\r\n        }, bizagi.override.disposeTime || 50);\r\n    },\r\n\r\n\r\n    /*\r\n    * Loads dinamically a set of templates\r\n    */\r\n    loadTemplates: function (templates) {\r\n        var self = this,\r\n            def = self.templatesDeferred = new $.Deferred(),\r\n            tmplPromises = [];\r\n\r\n        var useNewEngine = (templates.useNewEngine != undefined) ?  templates.useNewEngine : true;\r\n\r\n        for (var name in templates) {\r\n            if (name != \"useNewEngine\") {\r\n                tmplPromises.push(\r\n                    self.loadTemplate({\r\n                        \"name\" : name,\r\n                        \"path\" : templates[name],\r\n                        \"useNewEngine\" :useNewEngine\r\n                   })\r\n                );\r\n            }\r\n        }\r\n\r\n        $.when.apply($, tmplPromises)\r\n            .done(function () {\r\n                def.resolve();\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    * Loads template \r\n    */\r\n    loadTemplate: function (data) {\r\n        var self = this;\r\n\r\n        if (self.tmpl[data.name]) {\r\n            return self.tmpl[data.name];\r\n        } else {\r\n            if (data.useNewEngine){\r\n                return bizagi.templateService.getTemplateWidget(data.path)\r\n                    .done(function (tmpl) {\r\n                        self.tmpl[data.name] = tmpl;\r\n                    });\r\n            }\r\n\r\n            return bizagi.templateService.getTemplate(data.path)\r\n                .done(function (tmpl) {\r\n                    self.tmpl[data.name] = tmpl;\r\n                });\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Gets template \r\n    */\r\n    getTemplate: function (name) {\r\n        if (this.tmpl.hasOwnProperty(name)) {\r\n            return this.tmpl[name];\r\n        }\r\n        return null;\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns a promise, it is resoved when the widget is rendered\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n\r\n        if (!self.renderingDeferred) {\r\n            return false;\r\n        }\r\n        return self.renderingDeferred.promise();\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    areTemplatedLoaded: function () {\r\n        return this.templatesDeferred;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Main Controller\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class to handle workportal layouts for any device\r\n*   -   This layout must contain a menu and widget container placeholders\r\n*/\r\n\r\n\r\n// Defines the main controller\r\nbizagi.workportal.controllers.controller.extend(\"bizagi.workportal.controllers.main\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService) {\r\n        var self = this;\r\n\r\n        // Define regex to apply to templates\r\n        self.componentRegex = /{{component (\\w+)}}/g;\r\n\r\n        // Call base\r\n        this._super(workportalFacade, dataService);\r\n\r\n        // Subscribe to change widget event\r\n        this.subscribe(\"changeWidget\", function (e, params) {\r\n            \r\n            bizagi[\"currentWidget\"] = params.widgetName;\r\n\r\n            var def = new $.Deferred();\r\n\r\n            self.subscribeOneTime(\"onWidgetIncludedInDOM\", function (e, p) {\r\n                def.resolve();\r\n            });\r\n\r\n            // $.when(bizagi.util.autoSave()).done(function () {\r\n            $.when(bizagi.util.liveSave(params.widgetName),bizagi.util.autoSave()).done(function () {\r\n\r\n                $(document).data('auto-save', '');\r\n                bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise = null;\r\n\r\n                if (params.widgetName == bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID ||\r\n                   params.widgetName == bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX) {\r\n                    bizagi.cookie(\"bizagiDefaultWidget\", params.widgetName, { expires: 30 });\r\n                }\r\n\r\n                bizagi.util.setContext({\r\n                    widget: params.widgetName\r\n                });\r\n\r\n                self.setWidget(params);\r\n\r\n            });\r\n\r\n            return def.promise();\r\n        });\r\n\r\n        // Subscribe to add dialog to stack dialogs\r\n        this.subscribe(\"addDialogToDialogStack\", function (e, params) {\r\n            // Add dialog to stack\r\n            self.addDialogToDialogStack(params);\r\n        });\r\n\r\n        // Subscribe to dialog widget event\r\n        this.subscribe(\"showDialogWidget\", function (e, params) {\r\n            // Shows a dialog a widget                \r\n            self.showDialogWidget(params);\r\n        });\r\n\r\n        // Subscribe to clsoe current dialog\r\n        this.subscribe(\"closeCurrentDialog\", function (e, params) {\r\n            // Close the current dialog widget\r\n            return self.closeCurrentDialog(params);\r\n        });\r\n\r\n        // Subscribe to close all dialogs\r\n        this.subscribe(\"closeAllDialogs\", function (e, params) {\r\n            // Close all dialogs\r\n            self.closeAllDialogs();\r\n        });\r\n\r\n        // Subscribe to popup widget event\r\n        this.subscribe(\"popupWidget\", function (e, params) {\r\n            // Shows a popup a widget\r\n            self.popupWidget(params);\r\n        });\r\n\r\n        // Subscribe to pop widget event\r\n        this.subscribe(\"popWidget\", function (e, params) {\r\n            // Shows a pop a widget\r\n            self.popWidget(params);\r\n        });\r\n\r\n        // Subscribe to push widget event\r\n        this.subscribe(\"pushWidget\", function (e, params) {\r\n            // Shows a push a widget\r\n            self.pushWidget(params);\r\n        });\r\n\r\n\r\n        // Subscribe to execute action event\r\n        this.subscribe(\"executeAction\", function (e, params) {\r\n            // Executes the action\r\n            self.executeAction(params);\r\n        });\r\n\r\n        // Subscribe to resize layout event\r\n        this.subscribe(\"resizeLayout\", function () {\r\n            // Resize all the layout\r\n            self.performResizeLayout();\r\n        });\r\n\r\n        // Subscribe to dispose Widget event\r\n        this.subscribe(\"disposeWidget\", function () {\r\n            // Resize all the layout\r\n            self.disposeWidget();\r\n        });\r\n\r\n        // Subscribe to 'append Widget to' event\r\n        this.subscribe(\"appendWidgetTo\", function (e, params) {\r\n            // attach the widget to a given element\r\n            return (self.appendWidgetTo(params));\r\n        });\r\n\r\n        // Subscribe to Notifications event\r\n\t\t/**\r\n         * @param params {notification, type}\r\n         */\r\n        this.subscribe(\"notification\", function (e, params) {\r\n            NotificationDispatcher.dispatch(params.notification, params.type);\r\n        });\r\n\r\n        // Subscribe to 'refreshQueryFormShortCut' event\r\n        this.subscribe(\"refreshQueryFormShortCut\", function (e, params) {\r\n            // attach the widget to a given element\r\n            return (self.refreshQueryFormShortCut(params));\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.workportalFacade.getTemplate(\"workportal\");\r\n\r\n        // Render content\r\n        var content = self.content = $.tmpl(template, {});\r\n\r\n        // Add workarea\r\n        self.workarea = self.workportalFacade.getWorkareaController();\r\n\r\n        // Add menu\r\n        var menu = self.menu = self.workportalFacade.getMenuController();\r\n        $.when(menu.render())\r\n        .done(function () {\r\n            // Build menu\r\n            menu.getContent().appendTo(self.getComponentContainer(\"menu\"));\r\n        });\r\n\r\n        // Set resize layout event\r\n        $(window).resize(function () {\r\n            self.resizeLayout();\r\n        });\r\n\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    *   Sets the current working widget\r\n    */\r\n    setWidget: function (params) {\r\n        var self = this;\r\n        self.currentWidget = params.widgetName;\r\n        self.currentWidgetParams = $.extend({}, params, { menu: self.getMenu() });\r\n\r\n        // Set assertion to avoid calls without widget name\r\n        bizagi.assert(!bizagi.util.isEmpty(params.widgetName), \"No widget name defined for changeWidget call\");\r\n\r\n        // Renders the workarea again\r\n        self.renderWorkarea();\r\n    },\r\n\r\n    /*\r\n    *   Executes the desired action\r\n    */\r\n    executeAction: function (params) {\r\n        var self = this;\r\n\r\n        if (params.action == bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING) {\r\n            bizagi.loader.start(\"activity\").then(function () {\r\n                var actionController = self.workportalFacade.getAction(params.action);\r\n\r\n                // Executes the action\r\n                actionController.execute(params);\r\n            });\r\n        }\r\n        else if (params.action == bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH) {\r\n            bizagi.loader.start(\"inbox\").then(function () {\r\n                var actionController = self.workportalFacade.getAction(params.action);\r\n\r\n                // Executes the action\r\n                actionController.execute(params);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Renders the workarea based on the current widget\r\n    */\r\n    renderWorkarea: function () {\r\n        var self = this;\r\n\r\n        var workarea = self.workarea;\r\n\r\n        if (workarea) {\r\n            var workareaContainer = self.getComponentContainer(\"workarea\");\r\n\r\n            // clean widgets\r\n            self.cleanWidgets();\r\n\r\n            // Clean workarea\r\n            workareaContainer.empty();\r\n\r\n            //Prepare first load. If inboxGrid, first: load module inbox\r\n            if (!bizagi.util.isEmpty(self.currentWidget) && self.currentWidget != \"none\") {\r\n                self.currentWidgetParams = $.extend({}, self.currentWidgetParams, { menu: self.getMenu() });\r\n                if(self.currentWidget === bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID ||\r\n                   self.currentWidget === bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX){\r\n                    bizagi.loader.start(\"inbox\").then(function () {\r\n                        self.loadWidgetFromFacade(workarea, workareaContainer);\r\n                    });\r\n                }\r\n                else{\r\n                    self.loadWidgetFromFacade(workarea, workareaContainer);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Load widget from facade\r\n     */\r\n    loadWidgetFromFacade: function (workarea, workareaContainer){\r\n        var self = this;\r\n        // Load widget from facade\r\n        $.when(\r\n           self.workportalFacade.getWidget(self.currentWidget, self.currentWidgetParams)\r\n        ).pipe(function (widgetController) {\r\n               // Set into workarea\r\n               workarea.setWidget(widgetController);\r\n               return workarea.render();\r\n\r\n           }).done(function () {\r\n\r\n               var renderedContent = workarea.getContent();\r\n               if (renderedContent) {\r\n                   // Replace workarea\r\n                   renderedContent.appendTo(workareaContainer);\r\n\r\n                   //Resize layout on workarea\r\n                   self.resizeLayout();\r\n\r\n                   // Trigger \"widget included in dom\" event\r\n                   self.publish(\"onWidgetIncludedInDOM\");\r\n               }\r\n           });\r\n    },\r\n\r\n    /*\r\n    *   Shows a widget inside a modal dialog\r\n    *   Implement on each device\r\n    */\r\n    showDialogWidget: function (params) { },\r\n\r\n    /*\r\n    *   Close the current modal dialog\r\n    *   Implement on each device\r\n    */\r\n    closeCurrentDialog: function (params) { },\r\n\r\n    /*\r\n    *   Popup a widget\r\n    *   Implement on each device\r\n    */\r\n    popupWidget: function (params) { },\r\n\r\n    /*\r\n     *   Add dialog to dialogStack\r\n     */\r\n    addDialogToDialogStack: function(dialog) {},\r\n\r\n    /**\r\n    *   Close all modal dialogs\r\n    *   Implement on each device\r\n    */\r\n    closeAllDialogs: function() {},\r\n\r\n    /*\r\n    *   push a widget\r\n    *   Implement on each device\r\n    */\r\n    pushWidget: function (params) {\r\n        var self = this;\r\n        self.currentWidget = params.widgetName;\r\n        self.currentWidgetParams = $.extend({}, params, { menu: self.getMenu() });\r\n        // Set assertion to avoid calls without widget name\r\n        bizagi.assert(!bizagi.util.isEmpty(params.widgetName), \"No widget name defined for pushWidget call\");\r\n    },\r\n\r\n    /*\r\n    *   pop a widget\r\n    *   Implement on each device\r\n    */\r\n    popWidget: function (params) {\r\n        var self = this;\r\n        self.currentWidget = params.widgetName;\r\n        self.currentWidgetParams = $.extend({}, params, { menu: self.getMenu() });\r\n        // Set assertion to avoid calls without widget name\r\n        bizagi.assert(!bizagi.util.isEmpty(params.widgetName), \"No widget name defined for popupWidget call\");\r\n\r\n\r\n    },\r\n\r\n    disposeWidget: function (params) {\r\n        var self = this;\r\n        self.currentWidget = params.widgetName;\r\n        self.currentWidgetParams = $.extend({}, params, { menu: self.getMenu() });\r\n        // Set assertion to avoid calls without widget name\r\n        bizagi.assert(!bizagi.util.isEmpty(params.widgetName), \"No widget name defined for disposeWidget call\");\r\n\r\n\r\n    },\r\n\r\n    /*\r\n    *   Shows a widget inside a given element\r\n    *   paramms: widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_***,\r\n    *            appendToElement: \"#elementid\" or \".elementClass\"\r\n    *   Implement on each device\r\n    */\r\n    appendWidgetTo: function (params) { },\r\n\r\n    /*\r\n    *   When the window resizes, runs this method to adjust stuff in each controller or widget\r\n    *   Override when needed  \r\n    */\r\n    performResizeLayout: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        // Resize content\r\n        self.resizeContainer(content, $(window).height());\r\n\r\n        // Call menu, and workarea resize layout\r\n        if (self.menu) self.menu.performResizeLayout();\r\n        if (self.workarea) self.workarea.performResizeLayout();\r\n    },\r\n\r\n    /*\r\n    *   Resizes a container according its rules\r\n    */\r\n    resizeContainer: function (container, containerHeight) {\r\n        var self = this;\r\n\r\n        // Only perform layout resize if the container has adjustable elements\r\n        var adjustableChildren = container.children(\".ui-bizagi-component-adjustable\");\r\n        var adjustableContainersHeight = containerHeight;\r\n        \r\n        if (adjustableChildren.length > 0) {\r\n            // Sum fixed content\r\n            var fixedContentHeight = 0;\r\n            $.each(container.children(), function (i, element) {\r\n                if (!$(element).hasClass(\"ui-bizagi-component-adjustable\") && $(element).css('display') !== 'none') fixedContentHeight += $(element).height();\r\n            });\r\n\r\n            // Resize adjustable elements\r\n            adjustableContainersHeight = (containerHeight - (fixedContentHeight));\r\n    \r\n            var overflowY = \"\";\r\n            $.each(adjustableChildren, function (i, element) {\r\n\r\n                overflowY = ($(element).css(\"overflow-y\") != \"\") ? $(element).css(\"overflow-y\") : \"hidden\";\r\n                if (overflowY == \"visible\") overflowY = \"hidden\";\r\n                $(element).addClass(\"ui-bizagi-adjustable\");\r\n                var marginTop = ($(element).css(\"margin-top\") === \"auto\") ? 0 : Number($(element).css(\"margin-top\").replace(\"px\", \"\"));\r\n                var finalHeight = adjustableContainersHeight - marginTop;\r\n             \r\n                $(element).css({\r\n                    \"height\": finalHeight,\r\n                    \"overflow-y\": overflowY\r\n                });\r\n\r\n            });\r\n        }\r\n\r\n        // Resize inner containers if it has any adjustable inner containers\r\n        $.each(container.children(), function (i, element) {\r\n            if ($(element).find(\".ui-bizagi-component-adjustable\").length > 0) {\r\n                $(element).addClass(\"ui-bizagi-component-adjustable\");\r\n                self.resizeContainer($(element), adjustableContainersHeight);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Return the menu component\r\n    */\r\n    getMenu: function () {\r\n        return this.menu;\r\n    },\r\n\r\n    refreshQueryFormShortCut: function (params) { },\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Menu Controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to handle manu layouts for any device\r\n */\r\n\r\nbizagi.workportal.controllers.controller.extend(\"bizagi.workportal.controllers.menu\", {}, {\r\n    init: function (workportalFacade, dataService) {\r\n        var self = this;\r\n        self._super(workportalFacade, dataService);\r\n\r\n        // Subscribe to change widget event\r\n        this.subscribe(\"showMainMenu\", function (e, params) {\r\n            var def = new $.Deferred();\r\n            $(self.getContent()).closest(\"#ui-bizagi-wp-menu\").show();\r\n            return def.promise();\r\n        });\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.workportalFacade.getTemplate(\"menu\");\r\n        var defer = new $.Deferred();\r\n        var defaultImg = \"iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF////////VXz1bAAAAAJ0Uk5T/wDltzBKAAAA+0lEQVR42uzaSxLCMAwE0c79L82SFMXHJpKHhJ59at4utmS2cBAgQMCBT3dZDuBJ1gF4mSUA3qYfALUCauvnCZT3Twqo758T0NA/JaCjf0ZwIgC0COjpHxecBgBNAgF09Y8KBAgQIECAAAFnAXgiEiDAq5mA8wEuOCERIMBBpYAfAMTH9QLygPjOSEB+b5gHxFe3I4Lt4oD0+v4HAPEXFAIECBDw70+58oDw7zh7JMteTrPTcr5MDYBDOQqgIAcAFOU7AKWZBlCeKQAtGQXQmAEAzfkAYEHeAWC5gOX1DwQS/XsBkf6dgEz/XSBAgAABAgQIECBAQBxwE2AAjnkjnL/SDJsAAAAASUVORK5CYII=\";\r\n\r\n        // Get Current User\r\n        $.when(self.dataService.getCurrentUser(), self.loadPreferences()).done(function (data, preferencesWP) {\r\n\r\n            // Define Global information to actual user\r\n            bizagi.currentUser = data = data[0];\r\n            self.customPreferencesObj = new bizagi.services.preferences(preferencesWP);\r\n            var customPreferencesValues = self.customPreferencesObj.getPreferences();\r\n            /** Manage windows maintenance **/ \r\n            var windowMaintenance = new bizagi.workportal.services.windowMaintenance(self.dataService);\r\n\r\n            $.datepicker.setDefaults(bizagi.localization.getResource(\"datePickerRegional\"));\r\n\r\n            //symbol from Rest/Users/CurrentUser, in server : data.symbol =  Business/Localization/Currency Symbol  || {language}.numericFormat.symbol\r\n            var currencyInfo = bizagi.localization.getResource('numericFormat');\r\n            if (currencyInfo) {\r\n                currencyInfo.decimalSymbol = customPreferencesValues.decimalSeparator || data.decimalSeparator || currencyInfo.decimalSymbol;\r\n                currencyInfo.symbol = customPreferencesValues.symbol || data.symbol || currencyInfo.symbol;\r\n                currencyInfo.digitGroupSymbol = customPreferencesValues.thousandSeparator || data.groupSeparator || currencyInfo.digitGroupSymbol;\r\n\r\n                bizagi.localization.setResource('numericFormat', currencyInfo);\r\n                if (BIZAGI_DEFAULT_CURRENCY_INFO) {\r\n                    BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits = data.decimalDigits;\r\n                    BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator = currencyInfo.decimalSymbol;\r\n                    BIZAGI_DEFAULT_CURRENCY_INFO.symbol = currencyInfo.symbol;\r\n                    BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator = currencyInfo.digitGroupSymbol;\r\n                }\r\n            }\r\n\r\n            if (data.uploadMaxFileSize) {\r\n                BIZAGI_SETTINGS.UploadMaxFileSize = data.uploadMaxFileSize;\r\n                bizagi.util.changeData({ uploadMaxFileSize: BIZAGI_SETTINGS.UploadMaxFileSize });\r\n            }\r\n\r\n            self.overrideUserPreferences();\r\n\r\n            self.security = new bizagi.workportal.command.security(self.dataService);\r\n            $.when(self.security.getSecurity())\r\n                .done(function (security) {\r\n                    // Checking for DisplayOptions into security(response)\r\n                    if (bizagi.override.enableFeatureDisplayOptions === false) {\r\n                        security.DisplayOptions = false;\r\n                    }\r\n                    // Render content\r\n                    var content = self.content = $.tmpl(template, $.extend(data, {\r\n                        environment: bizagi.loader.environment || \"\",\r\n                        build: bizagi.loader.build,\r\n                        base64image: bizagi.themeLogo || \"img/img/barra/logo-bizagi.svg\",\r\n                        photo: \"data:image/png;base64,\" + ((bizagi.currentUser.userPicture) ? bizagi.currentUser.userPicture : defaultImg),\r\n                        hasPicture: bizagi.currentUser.userPicture ? true : false,\r\n                        initials: bizagi.currentUser.userFullName ? bizagi.currentUser.userFullName.getInitials() : \"\",\r\n                        security: security\r\n                    }));\r\n                    defer.resolve(content);\r\n                });\r\n        }).fail(function () {\r\n            self.dataService.logout();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    loadPreferences: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        $.when(self.dataService.getPreferencesWorkportalCurrentUser())\r\n            .done(function (resp) {\r\n                defer.resolve(resp);\r\n            })\r\n            .fail(function () {\r\n                var resp = {\r\n                    workportal: {}\r\n                }\r\n                defer.resolve(resp);\r\n            })\r\n        return defer.promise();\r\n    },\r\n\r\n    overrideUserPreferences: function () {\r\n        var self = this;\r\n        self.customPreferencesObj.overrideLocalization();\r\n        //var customPreferencesValues = customPreferencesObj.getPreferences();\r\n\r\n        /*$.each(customPreferencesValues, function(key,value){\r\n            bizagi.localization.setResource(key,value);            \r\n        });*/\r\n    },\r\n\r\n    /**\r\n     *   Helper method to change the current widget in the workportal\r\n     * @param params\r\n     */\r\n    changeWidget: function (params) {\r\n        var self = this;\r\n        self.publish(\"changeWidget\", params);\r\n    },\r\n\r\n    /**\r\n     *   Helper method to show a widget inside a dialog in the wokportal\r\n     * @param params\r\n     */\r\n    showDialogWidget: function (params) {\r\n        var self = this;\r\n        self.publish(\"showDialogWidget\", params);\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    performResizeLayout: function () {\r\n        var self = this;\r\n        if (typeof jQuery.browser != \"undefined\" && $.browser.msie && parseInt($.browser.version, 10) <= 8) {\r\n            var idInterval = window.setInterval(function () {\r\n                if (self.content !== null) {\r\n                    var labels = $(\"#ui-bizagi-wp-app-menu-bt-container .text\", self.content);\r\n                    var userprofile = $(\"#userprofile\", self.content);\r\n\r\n                    var menuUsername = $(\"#ui-bizagi-wp-menu-username\", userprofile);\r\n                    var labelsUser = $(\".text\", menuUsername);\r\n\r\n                    var logout = $(\"#logout\", userprofile);\r\n                    var about = $(\"#about\", userprofile);\r\n\r\n                    if ($(window).width() < 1400) {\r\n\r\n                        labels.css({\r\n                            \"line-height\": 0,\r\n                            \"display\": \"block\"\r\n                        });\r\n\r\n                        if ($(window).width() < 1195) {\r\n\r\n                            //Adjust the size to make room for the about button\r\n                            logout.css({\r\n                                \"width\": \"20px\"\r\n                            });\r\n\r\n                            //Minimize the about button\r\n                            about.css({\r\n                                \"width\": \"24px\"\r\n                            });\r\n\r\n                            $(\".ui-button-text\", about).hide();\r\n\r\n                            //Readjust the logout icon\r\n                            $(\".ui-icon\", logout).css({\r\n                                \"top\": \"12px\"\r\n                            });\r\n\r\n                            //hide the label\r\n                            $(\".ui-button-text\", logout).hide();\r\n\r\n                            //Hide the label user\r\n                            labelsUser.css({\r\n                                \"display\": \"none\"\r\n                            });\r\n\r\n                            //Set an specific height to the user name menu\r\n                            menuUsername.css({\r\n                                \"height\": \"19px\"\r\n                            });\r\n\r\n                        }\r\n                        else {\r\n\r\n                            about.removeAttr(\"style\");\r\n                            $(\".ui-icon\", about).removeAttr(\"style\");\r\n                            $(\".ui-button-text\", about).show();\r\n\r\n                            logout.removeAttr(\"style\");\r\n                            $(\".ui-icon\", logout).removeAttr(\"style\");\r\n\r\n                            //show the label\r\n                            $(\".ui-button-text\", logout).show();\r\n                        }\r\n\r\n                    } else {\r\n                        labels.css({\r\n                            \"line-height\": \"59px\",\r\n                            \"display\": \"inline-block\"\r\n                        });\r\n\r\n                        //Reset the user name menu\r\n                        menuUsername.removeAttr(\"style\");\r\n\r\n                        //re-adjust the styles\r\n                        menuUsername.css({\r\n                            \"padding-left\": \"25px\",\r\n                            \"width\": \"auto\"\r\n                        });\r\n\r\n                        labelsUser.removeAttr(\"style\");\r\n\r\n                        //Reset the about styles\r\n                        about.removeAttr(\"style\");\r\n                        $(\".ui-icon\", about).removeAttr(\"style\");\r\n                        $(\".ui-button-text\", about).show();\r\n\r\n                        logout.removeAttr(\"style\");\r\n                        $(\".ui-icon\", logout).removeAttr(\"style\");\r\n\r\n                        //show the label\r\n                        $(\".ui-button-text\", logout).show();\r\n                    }\r\n\r\n                    window.clearInterval(idInterval);\r\n                }\r\n            }, 300);\r\n        }\r\n\r\n        self.adjustMenuWP();\r\n    },\r\n\r\n    adjustMenuWP: function () {\r\n        if ($(\"#ui-bizagi-wp-app-menu-bt-container\").length === 1) {\r\n\r\n            // Define width for elements with responsive\r\n            var elementsMargin = 70; //jquery does not get the margin width with outerWidth :(\r\n\r\n            var widthComponentsWithoutResponsive = $(\"#ui-bizagi-wp-widget-searchContainer\").outerWidth() +\r\n                $(\"#user\").outerWidth() +\r\n                $(\"#ui-bizagi-wp-app-menu-logo-container\").outerWidth() + elementsMargin;\r\n\r\n            // Define maximum width of menu\r\n            var limitWidth = $(\"#ui-bizagi-wp-app-menu-container\").width() - widthComponentsWithoutResponsive;\r\n            $(\"#ui-bizagi-wp-app-menu-bt-container\").width(limitWidth);\r\n\r\n            //restart visible buttons\r\n            $(\"span.text\", selectorMenuButtons).show();\r\n\r\n            // hide button text by button text until all buttons and text is ok.\r\n            var selectorMenuButtons = $(\"#ui-bizagi-wp-app-menu-bt-container li\");\r\n            var indexButtonToHide = indexLastButton = selectorMenuButtons.length - 1;\r\n            var thereIsAButtonOverlaped = true;\r\n\r\n            while (thereIsAButtonOverlaped) {\r\n                if (indexButtonToHide < 0) {\r\n                    break;\r\n                }\r\n                if ($(\"#ui-bizagi-wp-app-menu-bt-container\").position().top > 0 || selectorMenuButtons.eq(indexLastButton).position().top > 0) {\r\n                    $(\"span.text\", selectorMenuButtons).eq(indexButtonToHide).hide();\r\n                    indexButtonToHide -= 1;\r\n\r\n                }\r\n                else {\r\n                    thereIsAButtonOverlaped = false;\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Workarea Controller \r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class to handle all the workarea of the application\r\n*/\r\n\r\nbizagi.workportal.controllers.controller.extend(\"bizagi.workportal.controllers.workarea\", {}, {\r\n\r\n    /*\r\n    *   This method sets the internal widget to be rendered\r\n    */\r\n    setWidget: function (widget) {\r\n        var self = this;\r\n        self.widget = widget;\r\n    },\r\n\r\n    disposeWidget: function () {\r\n        var self = this;\r\n        if (self.widget) {\r\n            self.widget.dispose();\r\n            delete self.widget;\r\n        }\r\n    },\r\n\r\n    cleanWidgets: function () {\r\n        var self = this;\r\n\r\n        if (self.widget) {\r\n            self.widget.clean();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n\r\n        var defer = new $.Deferred();\r\n\r\n        if (self.widget) {\r\n            // Renders the widget\r\n            $.when(self.widget.render())\r\n            .done(function () {\r\n                self.content = self.widget.getContent();\r\n                defer.resolve(self.content);\r\n            });\r\n\r\n        } else {\r\n            self.content = $(\"<div/>\");\r\n            defer.resolve(self.content);\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Resizes layout for controller\r\n    */\r\n    performResizeLayout: function () {\r\n        var self = this;\r\n\r\n        // Call internal widget resize\r\n        if (self.widget) self.widget.performResizeLayout();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Webpart helper\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define helper functions that the webparts could use to reuse some logic\r\n */\r\n\r\n\r\n$.Class.extend(\"bizagi.workportal.webpart.helper\", {}, {\r\n    /* \r\n     *   Constructor\r\n     */\r\n    init: function (webpart) {\r\n        // Set data service\r\n        this.dataService = webpart.dataService;\r\n\r\n        // Set l10n service\r\n        this.resources = webpart.resources;\r\n\r\n        // Set workportal facade\r\n        this.workportalFacade = webpart.workportalFacade;\r\n\r\n        //Load Aditional templates\r\n        this.templates = {};\r\n    },\r\n\r\n    /*\r\n     *   Helper to set visible property to false to the given columns\r\n     */\r\n    hideCasesColumn: function (data, columnName) {\r\n        var self = this;\r\n        for (i = 0; i < data.columns.length; i++) {\r\n            if (data.columns[i].name == columnName) {\r\n                data.columns[i].visible = false;\r\n                break;\r\n            }\r\n        }\r\n        return data;\r\n    },\r\n    /*\r\n     *   Helper to set visible property to false to the given columns\r\n     */\r\n    hideCasesColumn: function (data, columnName) {\r\n        var self = this;\r\n        for (i = 0; i < data.columns.length; i++) {\r\n            if (data.columns[i].name == columnName) {\r\n                data.columns[i].visible = false;\r\n                break;\r\n            }\r\n        }\r\n        return data;\r\n    },\r\n\r\n    /*\r\n     *   Helper to transform cases data into normalized grid data\r\n     */\r\n    transformCasesInfo: function (params) {\r\n        var old = params.data,\r\n            imageColumn = params.imageColumn;\r\n        var newData = {\r\n            transformed: true\r\n        };\r\n\r\n        // If the data is already transformed, don't do anything\r\n        if (old.transformed) return old;\r\n\r\n        var getColumnType = function (column) {\r\n            if (column.fieldName == imageColumn) return \"upload\";\r\n            if (column.fieldName == \"I_idTask\") return \"workitems\";\r\n            return column.type;\r\n        };\r\n\r\n        // Parse columns, and add \"id\" column\r\n        newData.columns = [{\r\n            name: \"id\",\r\n            displayName: \"id\",\r\n            visible: false\r\n        }];\r\n\r\n        for (var i = 0; i < old.cases.columnTitle.length; i++) {\r\n            var oldColumn = old.cases.columnTitle[i];\r\n            newData.columns.push({\r\n                name: oldColumn.fieldName,\r\n                displayName: oldColumn.displayName,\r\n                dataType: getColumnType(oldColumn)\r\n            });\r\n\r\n            if (bizagi.util.parseBoolean(oldColumn.isOrdered) == true) {\r\n                newData.orderBy = oldColumn.fieldName;\r\n                newData.orderType = oldColumn.orderType == 0 ? \"asc\" : \"desc\";\r\n            }\r\n        }\r\n\r\n        // Add \"workitems\" column\r\n        newData.columns.push({\r\n            name: \"workitems\",\r\n            displayName: \"workitems\",\r\n            visible: false,\r\n            dataType: \"workitems\"\r\n        });\r\n\r\n        newData.columns.push({\r\n            name: \"permissions\",\r\n            displayName: \"permissions\",\r\n            visible: false,\r\n            dataType: \"permissions\"\r\n        });\r\n\r\n        // Parse rows\r\n        newData.rows = [];\r\n        for (i = 0; i < old.cases.rows.length; i++) {\r\n            var oldRow = old.cases.rows[i];\r\n            var newRow = [];\r\n            newRow.push(oldRow.id);\r\n\r\n            // Add other fields\r\n            for (var j = 0; j < oldRow.fields.length; j++) {\r\n                newRow.push(oldRow.fields[j]);\r\n            }\r\n            newData.rows.push(newRow);\r\n        }\r\n\r\n        // Add other stuff\r\n        newData.totalPages = old.cases.totalPages;\r\n        newData.page = old.cases.page;\r\n\r\n        return newData;\r\n    },\r\n\r\n    /*\r\n     *   Helper to draw a grid view\r\n     */\r\n    drawGridView: function (params) {\r\n        var templates = params.template;\r\n\r\n        // This is the data that will be used in order to render the template\r\n        var data = params.data;\r\n\r\n        // Complete column information with defaults\r\n        for (i = 0; i < data.columns.length; i++) {\r\n            data.columns[i].visible = typeof (data.columns[i].visible) !== \"undefined\" ? bizagi.util.parseBoolean(data.columns[i].visible) : true;\r\n\r\n            // Hide uploads & workitems\r\n            if (data.columns[i].dataType == \"upload\") data.columns[i].visible = false;\r\n            if (data.columns[i].dataType == \"workitems\") data.columns[i].visible = false;\r\n            if (data.columns[i].dataType == \"permissions\") data.columns[i].visible = false;\r\n        }\r\n\r\n        // Check that required params are defined\r\n        if (data.orderType == 0) data.orderType = \"asc\";\r\n        if (data.orderType == 1) data.orderType = \"desc\";\r\n        data.orderBy = !bizagi.util.isEmpty(data.orderBy) ? data.orderBy : \"\";\r\n        data.orderType = !bizagi.util.isEmpty(data.orderType) ? data.orderType : \"asc\";\r\n        data.totalPages = !bizagi.util.isEmpty(data.totalPages) ? data.totalPages : 0;\r\n\r\n        // Add paging stuff\r\n        var pages = [];\r\n        for (var i = 1; i <= data.totalPages; i++) {\r\n            pages.push({\r\n                number: i,\r\n                active: (i == data.page)\r\n            });\r\n        }\r\n\r\n        // Build the html\r\n        var result = $.tmpl(templates, $.extend(data, {\r\n            pages: pages,\r\n            actions: params.actions,\r\n            filters: params.filters,\r\n            title: params.title,\r\n            getCaseId: function (row) {\r\n                return row[0];\r\n            },\r\n            getEntityId: function (row) {\r\n                return row[0];\r\n            },\r\n            splitHeaderName: function (displayName) {\r\n                var finalDispName = displayName;\r\n                var dispNameParts = displayName.split('_');\r\n                if (dispNameParts.length > 1)\r\n                    finalDispName = dispNameParts[1];\r\n                return finalDispName;\r\n            },\r\n            getWorkItems: function (row) {\r\n                var workitemsData = \"[\";\r\n                var workitems = row[row.length - 2].workitems;\r\n                if (workitems && workitems.length > 0) {\r\n                    for (var wi in workitems) {\r\n                        if (wi > 0) {\r\n                            workitemsData += \",\";\r\n                        }\r\n                        var wiInfo = \"{\\\"idWorkItem\\\":\";\r\n                        wiInfo += workitems[wi].idWorkItem;\r\n                        wiInfo += \",\\\"idTask\\\":\";\r\n                        wiInfo += workitems[wi].idTask;\r\n                        wiInfo += \"}\";\r\n                        workitemsData += wiInfo;\r\n                    }\r\n\r\n                }\r\n                workitemsData += \"]\";\r\n                return workitemsData;\r\n            }\r\n        }));\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Helper to draw a thumbnails view\r\n     */\r\n    drawThumbnailsView: function (params) {\r\n        var self = this;\r\n        var templates = params.template;\r\n\r\n        // This is the data that will be used in order to render the template\r\n        var data = params.data;\r\n        var imageUrl, label;\r\n\r\n        // Normalize label item\r\n        for (i = 0; i < data.columns.length; i++) {\r\n            // Set default visibility to true\r\n            data.columns[i].visible = typeof (data.columns[i].visible) !== \"undefined\" ? bizagi.util.parseBoolean(data.columns[i].visible) : true;\r\n\r\n            // Check label item\r\n            if (data.columns[i].name == params.imageLabelColumn) {\r\n                data.columns[i].dataType = \"imageLabel\";\r\n            }\r\n\r\n            // Check workitem item\r\n            if (data.columns[i].dataType == \"workitems\") {\r\n                data.columns[i].visible = false;\r\n            }\r\n        }\r\n\r\n        // Check that required params are defined\r\n        data.orderBy = !bizagi.util.isEmpty(data.orderBy) ? data.orderBy : \"\";\r\n        data.orderType = !bizagi.util.isEmpty(data.orderType) ? data.orderType : \"asc\";\r\n        data.totalPages = !bizagi.util.isEmpty(data.totalPages) ? data.totalPages : 0;\r\n\r\n        // Add paging stuff\r\n        var pages = [];\r\n        for (var i = 1; i <= data.totalPages; i++) {\r\n            pages.push({\r\n                number: i,\r\n                active: (i == data.page)\r\n            });\r\n        }\r\n\r\n        // Build the html\r\n        return $.tmpl(templates,\r\n            $.extend(data, {\r\n                pages: pages,\r\n                getImage: function (files) {\r\n                    return self.getFileImage(files);\r\n                },\r\n                actions: params.actions,\r\n                getCaseId: function (row) {\r\n                    return row[0];\r\n                },\r\n                getEntityId: function (row) {\r\n                    return row[0];\r\n                },\r\n                getWorkItems: function (row) {\r\n                    var workitemsData = \"[\";\r\n                    var workitems = row[row.length - 1].workitems;\r\n                    if (workitems && workitems.length > 0) {\r\n                        for (var wi in workitems) {\r\n                            if (wi > 0) {\r\n                                workitemsData += \",\";\r\n                            }\r\n                            var wiInfo = \"{\\\"idWorkItem\\\":\";\r\n                            wiInfo += workitems[wi].idWorkItem;\r\n                            wiInfo += \",\\\"idTask\\\":\";\r\n                            wiInfo += workitems[wi].idTask;\r\n                            wiInfo += \"}\";\r\n                            workitemsData += wiInfo;\r\n                        }\r\n\r\n                    }\r\n                    workitemsData += \"]\";\r\n                    return workitemsData;\r\n                }\r\n            }));\r\n    },\r\n\r\n    getEmptyFile: function () {\r\n        return \"/_layouts/Proxy/jquery/overrides/css/desktop/images/EmptyAsset.png\";\r\n        //return \"\"; //No Picture\r\n    },\r\n    /*  \r\n     *   Returns the file url\r\n     */\r\n    getFileImage: function (files) {\r\n        var self = this;\r\n\r\n        if (!files || files.length == 0) return self.getEmptyFile();\r\n        return files;\r\n    },\r\n    getFile: function (files) {\r\n        var self = this;\r\n\r\n        if (!files || files.length == 0) return self.getEmptyFile();\r\n        return self.dataService.getFile(files[0]);\r\n    },\r\n    removeWaitContainer: function (container) {\r\n        if ($(container)) {\r\n            $(container).addClass(\"ui-bizagi-sharepoint-loading-container-hidden\");\r\n        }\r\n    },\r\n    addWaitContainer: function (container) {\r\n        if ($(container)) {\r\n            $(container).removeClass(\"ui-bizagi-sharepoint-loading-container-hidden\");\r\n        }\r\n    },\r\n\r\n    loadTemplate: function (template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return bizagi.templateService.getTemplate(templateDestination)\r\n            .done(function (resolvedRemplate) {\r\n                self.templates[template] = resolvedRemplate;\r\n            });\r\n    },\r\n\r\n    getFailServerErrorDeferred: function (params, defer) {\r\n        var self = this;\r\n        var errorMessage = params.message;\r\n        var remoteSeverURL = \"\"\r\n        var errorTemplateName;\r\n        if (params.sharepointProxyPrefix.indexOf(\"URL\") != -1) {\r\n            remoteSeverURL = params.sharepointProxyPrefix.substr(params.sharepointProxyPrefix.indexOf(\"URL\") + 4, params.sharepointProxyPrefix.length);\r\n            errorTemplateName = \"bizagi.workportal.desktop.error-message-sharepoint\";\r\n        } else {\r\n            errorTemplateName = \"bizagi.workportal.desktop.error-message-portal\";\r\n        }\r\n        errorMessage = remoteSeverURL + \": \" + errorMessage;\r\n        self.loadTemplate(\"error-message\", bizagi.getTemplate(errorTemplateName))\r\n            .done(function (eTemplate) {\r\n                var content = self.content = $.tmpl(eTemplate, {\r\n                    message: errorMessage,\r\n                    address: params.helpAddress\r\n                });\r\n\r\n                defer.resolve(content);\r\n\r\n            }).fail(function (msg) {\r\n                defer.resolve(\"<div>Unhandled error</div>\");\r\n            });\r\n\r\n    },\r\n    getPaginationTemplate: function () {\r\n        return self.loadTemplate(\"pagination-template\", bizagi.getTemplate(\"inbox-common-pagination-inbox\"))\r\n    },\r\n\r\n    publishShowRenderEvent: function (event, webpart, params) {\r\n        // Check if the current render form can be changed\r\n        if (!!!event) {\r\n            alert(\"Event param cannot be undefined\");\r\n        }\r\n        //The webparts that not visible no receive events  \r\n        var deferRet = webpart.publish(\"ui-bizagi-can-change-activityform\");\r\n        if (deferRet) {\r\n            deferRet.done(function () {\r\n                // When the \"ui-bizagi-can-change-activityform\" event deferred is resolved, it means that we can change the activityform instance\r\n                // otherwise the deferred fails and nothing happens because we don't have fail implementation\r\n\r\n                // Publish the event so any other webpart could react to that\r\n                webpart.publish(event, params);\r\n            });\r\n        } else {\r\n            //Error autosave verification send error\r\n            console.log(\"autosave verification send error\");\r\n            //webpart.publish(event, params);\r\n        }\r\n    },\r\n    isWebpartInIFrame: function () {\r\n        try {\r\n            return window.self !== window.top;\r\n        } catch (e) {\r\n            return true;\r\n        }\r\n    },\r\n    //This method send a message by postMessage to parent, and parent create a popUp,\r\n    displayWebPartPopUpExternalIframe: function (webpartName, params, callback, postMessageSocket) {\r\n        params.message = {};\r\n        var data = $.extend({}, params, {\r\n            workportal: null,\r\n            canvas: null,\r\n            whenInitialized: null,\r\n            event: \"postmessage-bizagi-openParentPopUp\",\r\n            message: {\r\n                webPartToDraw: webpartName,\r\n                iframeidentifier: postMessageSocket.iframeidentifier\r\n            }\r\n        });\r\n\r\n        postMessageSocket.send(data);\r\n    },\r\n    displayWebPartPopUpinIFrame: function (webpartName, params, callback) {\r\n\r\n        var webpartObject;\r\n        // Publish the event so any other webpart could react to that\r\n        var mask = document.createElement(\"div\");\r\n        mask.className = \"containerPopUp\";\r\n        mask.style.height = \"100%\";\r\n\r\n        var popUpParams = params;\r\n\r\n        if (!mask.addEventListener) {\r\n            mask.attachEvent(\"onclick\", preClosePopUp);\r\n        } else {\r\n            mask.addEventListener(\"click\", preClosePopUp, false);\r\n        }\r\n\r\n        function preClosePopUp(ev, params) {\r\n            if (ev.eventPhase === 2) {\r\n                closePopUp(ev, params);\r\n            }\r\n        }\r\n\r\n        var canvas = document.createElement(\"div\");\r\n        canvas.className = \"activitiFormContainer\";\r\n        var closeCanvas = document.createElement(\"div\");\r\n        closeCanvas.className = \"closeCanvas\";\r\n\r\n        if (!closeCanvas.addEventListener) {\r\n            closeCanvas.attachEvent(\"onclick\", function (e, params) {\r\n                closePopUp(e, params);\r\n            });\r\n        } else {\r\n            closeCanvas.addEventListener(\"click\", function (e, params) {\r\n                closePopUp(e, params);\r\n            }, false);\r\n        }\r\n\r\n        canvas.appendChild(closeCanvas);\r\n        mask.appendChild(canvas);\r\n\r\n        var webpartCanvasDiv = document.createElement(\"div\");\r\n        webpartCanvasDiv.className = \"webpartCanvasDiv\";\r\n        webpartCanvasDiv.id = \"webpartCanvasPopUp\";\r\n        canvas.appendChild(webpartCanvasDiv);\r\n\r\n        var pathiFrame = \"\";\r\n        if (params.pathiFrame) {\r\n            pathiFrame = params.pathiFrame;\r\n        } else {\r\n            pathiFrame = window.location.href.substring(0, window.location.href.indexOf(\"jquery\"));\r\n        }\r\n\r\n        var queryStringParams = window.location.toString().split('?')[1];\r\n\r\n\r\n        pathiFrame = pathiFrame + \"jquery/webparts/desktop/portal/pages/webpart.htm\"\r\n        pathiFrame = pathiFrame + \"?type=\" + webpartName;\r\n        if (params.idCase) {\r\n            pathiFrame = pathiFrame + \"&idCase=\" + params.idCase;\r\n        }\r\n        if (params.idWorkitem) {\r\n            pathiFrame = pathiFrame + \"&idWorkitem=\" + params.idWorkitem;\r\n        }\r\n        if (params.idWfClass) {\r\n            pathiFrame = pathiFrame + \"&idWfClass=\" + params.idWfClass;\r\n        }\r\n        if (queryStringParams) {\r\n            pathiFrame = pathiFrame + \"&\" + queryStringParams;\r\n        }\r\n\r\n        pathiFrame = pathiFrame + \"&remoteServer=\" + window.location.toString();\r\n\r\n\r\n        //Aqui se agrega el iframe\r\n        var iframe = document.createElement(\"iframe\");\r\n        iframe.className = \"csswebpartIframePopUp\";\r\n        iframe.id = \"iframePopUp\";\r\n        iframe.src = pathiFrame;\r\n        iframe.resizeInPopUp = function (params) {\r\n            var self = this;\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            $(iframe).height(heightActivitiFormContainer);\r\n        }\r\n\r\n        webpartCanvasDiv.appendChild(iframe);\r\n        document.body.appendChild(mask);\r\n\r\n        iframe.resizeInPopUp(params);\r\n        $(window).resize(function () {\r\n            iframe.resizeInPopUp(params);\r\n        });\r\n\r\n        function closePopUp(ev, params) {\r\n            //if webpart has canHide event, call event canHide before\r\n\r\n            var postmessageSocket = new bizagi.postmessage({\r\n                remoteServer: pathiFrame,\r\n                destination: iframe.contentWindow,\r\n                origin: window\r\n            });\r\n            postmessageSocket.receive = function (msg) {\r\n                //the canHide process is made in iframe\r\n                var params = msg.data;\r\n                if (params.event == \"postmessage-bizagi-closeIFramePopUp\") {\r\n                    if (mask.parentNode) {\r\n                        iframe.src = undefined;\r\n                        mask.parentNode.removeChild(mask);\r\n                        if (callback) {\r\n                            callback(this, popUpParams);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            var iframeclosemsg = {};\r\n            iframeclosemsg.event = \"postmessage-bizagi-canCloseIFramePopUp\";\r\n            postmessageSocket.send(iframeclosemsg);\r\n        }\r\n\r\n    },\r\n    displayWebPartPopUp: function (webpartName, params, callback) {\r\n        var webpartObject;\r\n        // Publish the event so any other webpart could react to that\r\n        var mask = document.createElement(\"div\");\r\n        mask.className = \"containerPopUp\";\r\n        mask.style.height = \"100%\";\r\n\r\n        var popUpParams = params;\r\n\r\n        if (!mask.addEventListener) {\r\n            mask.attachEvent(\"onclick\", preClosePopUp);\r\n        } else {\r\n            mask.addEventListener(\"click\", preClosePopUp, false);\r\n        }\r\n\r\n        function preClosePopUp(ev, params) {\r\n            if (ev.eventPhase === 2) {\r\n                closePopUp(ev, params);\r\n            }\r\n        }\r\n\r\n        function closePopUp(ev, params) {\r\n            //if webpart has canHide event, call event canHide before\r\n            if (webpartObject.canHide) {\r\n                $.when(webpartObject.canHide())\r\n                    .done(function () {\r\n                        var showCasesMSG = {\r\n                            message: {}\r\n                        };\r\n                        showCasesMSG.event = \"ui-bizagi-reload-cases\";\r\n\r\n                        if(webpartObject.postmessageSocket){\r\n                            webpartObject.postmessageSocket.send(showCasesMSG);\r\n                        } else {\r\n                            var postmessageSocket = new bizagi.postmessage({\r\n                                remoteServer: bizagi.readQueryString()[\"remoteServer\"],\r\n                                destination: window.parent,\r\n                                origin: window\r\n                            });\r\n                            postmessageSocket.send(showCasesMSG);\r\n                        }\r\n\r\n                        mask.parentNode.removeChild(mask);\r\n                        if (callback) {\r\n                            callback(this, popUpParams);\r\n                        }\r\n                        webpartObject.destroy();\r\n                    }).fail(function () {\r\n                        mask.parentNode.removeChild(mask);\r\n                        if (callback) {\r\n                            callback(this, popUpParams);\r\n                        }\r\n                        webpartObject.destroy();\r\n                    });\r\n            } else {\r\n                mask.parentNode.removeChild(mask);\r\n                if (callback) {\r\n                    callback(this, popUpParams);\r\n                }\r\n                webpartObject.destroy();\r\n            }\r\n        }\r\n\r\n        var canvas = document.createElement(\"div\");\r\n        canvas.className = \"activitiFormContainer\";\r\n        var closeCanvas = document.createElement(\"div\");\r\n        closeCanvas.className = \"closeCanvas\";\r\n\r\n        if (!closeCanvas.addEventListener) {\r\n            closeCanvas.attachEvent(\"onclick\", function (e, params) {\r\n                closePopUp(e, params);\r\n            });\r\n        } else {\r\n            closeCanvas.addEventListener(\"click\", function (e, params) {\r\n                closePopUp(e, params);\r\n            }, false);\r\n        }\r\n\r\n        canvas.appendChild(closeCanvas);\r\n        mask.appendChild(canvas);\r\n\r\n        var webpartCanvasDiv = document.createElement(\"div\");\r\n        webpartCanvasDiv.className = \"webpartCanvasDiv\";\r\n        webpartCanvasDiv.id = \"webpartCanvasPopUp\";\r\n        canvas.appendChild(webpartCanvasDiv);\r\n\r\n        var webpartParams = $.extend({}, params, {\r\n            webpart: webpartName,\r\n            canvas: $(webpartCanvasDiv),\r\n            namespace: \"PopUp\",\r\n            data: null,\r\n            adjustButtonsToContent: true\r\n        });\r\n\r\n        //add popUp in document\r\n        document.body.appendChild(mask);\r\n        //The element webpartCanvasDiv must be already added to document, for can call  bizagi.starWaiting\r\n        bizagi.startWaiting(webpartCanvasDiv);\r\n\r\n        params.workportal.executeWebpart(webpartParams).done(function (result) {\r\n            webpartObject = result.webpart;\r\n            closeCanvas.onclick = function (e, params) {\r\n                // callback(params);\r\n            }\r\n        });\r\n    },\r\n    displayWebPartDialog: function (webpartName, params, callback) {\r\n        var webpartObject;\r\n        var dialogParams = params.dialogParams;\r\n        var canvas = document.createElement(\"div\");\r\n        canvas.className = \"activitiFormContainer\";\r\n        var webpartCanvasDiv = document.createElement(\"div\");\r\n        webpartCanvasDiv.className = \"webpartCanvasDiv\";\r\n        webpartCanvasDiv.id = \"webpartCanvasPopUp\";\r\n        canvas.appendChild(webpartCanvasDiv);\r\n        var webpartParams = $.extend({}, params, {\r\n            webpart: webpartName,\r\n            canvas: $(webpartCanvasDiv),\r\n            namespace: \"PopUp\",\r\n            data: null,\r\n            adjustButtonsToContent: true\r\n        });\r\n        params.workportal.executeWebpart(webpartParams).done(function (result) {\r\n            webpartObject = result.webpart;\r\n            if (dialogParams.showCloseButton) {\r\n                dialogParams.buttons.push({\r\n                    text: bizagi.localization.getResource(\"workportal-widget-dialog-box-close\"),\r\n                    click: function (p, a) {\r\n                        webpartObject.content.dialog(\"close\");\r\n                    }\r\n                });\r\n            }\r\n            webpartObject.content.dialog(dialogParams);\r\n        });\r\n    }\r\n});\r\n\r\n/*\r\n *   Static Methods to configure webparts\r\n */\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.webparts = (typeof (bizagi.webparts) !== \"undefined\") ? bizagi.webparts : {};\r\n\r\nbizagi.webparts.addConfigurationMessage = function (webpartParams, messageResourceName) {\r\n    var doc = this.ownerDocument;\r\n    var body = $(\"body\", doc);\r\n    var canvas = webpartParams.canvas || $(\"<div/>\").appendTo(body);\r\n    var errorTemplate = bizagi.getTemplate(\"bizagi.sharepoint.configurationerror\");\r\n    // Load template\r\n    $.when(bizagi.templateService.getTemplate(errorTemplate))\r\n        .then(function (template) {\r\n            $.tmpl(template, {\r\n                message: bizagi.localization.getResource(messageResourceName)\r\n            }).appendTo(canvas);\r\n\r\n        });\r\n};\r\n","/*\r\n *   Name: BizAgi Workportal Webpart Controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to all widgets\r\n */\r\n\r\n/* Asegura que el namespace este creado*/\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.webpart = (typeof (bizagi.webpart) !== \"undefined\") ? bizagi.webpart : {};\r\nbizagi.webpart.subscribe = function (eventName, callback) {\r\n    $(document).bind(eventName, callback);\r\n};\r\nbizagi.webpart.publish = function (eventName, params) {\r\n    return $(document).triggerHandler(eventName, params);\r\n};\r\n\r\nbizagi.webpart.whenCreated = function (webpartName, callback) {\r\n    bizagi.webpart.subscribe(\"bizagi-webpart-created\", function (params) {\r\n        if (params.webpart.Class.fullname == \"bizagi.workportal.webparts.\" + webpartName) {\r\n            if (callback) callback(params);\r\n        }\r\n    })\r\n};\r\n\r\nbizagi.webpart.whenExecuted = function (webpartName, callback) {\r\n    bizagi.webpart.subscribe(\"bizagi-webpart-executed\", function (params) {\r\n        if (params.webpart.Class.fullname == \"bizagi.workportal.webparts.\" + webpartName) {\r\n            if (callback) callback(params);\r\n        }\r\n    })\r\n};\r\n\r\n\r\nbizagi.workportal.controllers.controller.extend(\"bizagi.workportal.webparts.webpart\", {\r\n\r\n}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(workportalFacade, dataService, params);\r\n\r\n        // Set helper\r\n        this.helper = new bizagi.workportal.webpart.helper(this);\r\n\r\n        this.canvas = params.canvas;\r\n\r\n        // Set project\r\n        this.project = params.project;\r\n        this.sharepointProxyPrefix = params.sharepointProxyPrefix;\r\n\r\n        // Set namespace\r\n        this.namespace = params.namespace;\r\n        // visible\r\n        this.isVisible = true;\r\n        this.isWebpartInIFrame = typeof (params.isWebpartInIFrame) != 'undefined' ? params.isWebpartInIFrame : self.helper.isWebpartInIFrame();\r\n        this.adjustButtonsToContent = params.adjustButtonsToContent;\r\n        this.remoteServer = params.remoteServer;\r\n\r\n        if (this.remoteServer) {\r\n\r\n            //postmessage object definition\r\n            self.postmessageSocket = new bizagi.postmessage({\r\n                remoteServer: this.remoteServer,\r\n                destination: window.parent,\r\n                origin: window\r\n            });\r\n            self.postmessageSocket.iframeidentifier = BIZAGI_IFRAME_IDENTIFIER;\r\n            self.postmessageSocket.receive = function (msg) {\r\n                var params = msg.data;\r\n\r\n                // Auto-discard self messages\r\n                if (params.message) {\r\n                    if (params.message.iframeidentifier == BIZAGI_IFRAME_IDENTIFIER) {\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                if (params.event) {\r\n                    switch (params.event) {\r\n                        case \"postmessage-bizagi-canCloseIFramePopUp\":\r\n\r\n                            if (self.canHide && self.Class.shortName == params.message.webPartDestine) {\r\n                                $.when(self.canHide())\r\n                                    .done(function () {\r\n                                        var iframeclosemsg = {};\r\n                                        iframeclosemsg.event = \"postmessage-bizagi-closeIFramePopUp\";\r\n                                        iframeclosemsg.message = {};\r\n                                        iframeclosemsg.message.iframeidentifier = BIZAGI_IFRAME_IDENTIFIER;\r\n                                        self.postmessageSocket.send(iframeclosemsg);\r\n                                        var showCasesMSG = {\r\n                                            message: {}\r\n                                        };\r\n                                        showCasesMSG.event = \"ui-bizagi-reload-cases\";\r\n                                        self.postmessageSocket.send(showCasesMSG);\r\n                                    });\r\n                            }\r\n                            break;\r\n                        case \"postmessage-bizagi-openParentPopUp\":\r\n                            //Do nothing this message is for parent\r\n                            break;\r\n                        default:\r\n                            //re send message to other webparts\r\n                            self.publish(params.event, params.message, true);\r\n                            break;\r\n                    }\r\n                } else {\r\n                    //set iframe height and width\r\n\r\n                }\r\n            };\r\n            self.postmessageSocket.startReceiving();\r\n            self.sendDimensionsiFrame();\r\n        }\r\n    },\r\n    sendDimensionsiFrame: function (mandatorysend) {\r\n        var self = this;\r\n        //If webpart is put in iFrame resize the iframe with content height\r\n        //else if iframe show in popUp FixButtons, is desirable\r\n        //If namespace is defined this is a chil webpart\r\n        //delay wait for finish render\r\n        if (self.remoteServer) {\r\n            if (!!!self.adjustButtonsToContent && (!!!self.namespace || mandatorysend)) {\r\n                if (self.isWebpartInIFrame) {\r\n                    if (self.canvas[0]) {\r\n                        //send dimensions in resize event \r\n                        var canvasobject = self.canvas[0];\r\n                        if (canvasobject.attachEvent) {\r\n                            canvasobject.onresize = function () {\r\n                                self.sendDimensionsiFramePostMessage();\r\n                            };\r\n                        } else {\r\n                            bizagi.addResizeListener(canvasobject, function (e) {\r\n                                self.sendDimensionsiFramePostMessage();\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    sendDimensionsiFramePostMessage: function () {\r\n        var self = this;\r\n        var iframeDimentions = {\r\n            message: {}\r\n        };\r\n        iframeDimentions.message.iframeName = BIZAGI_IFRAME_IDENTIFIER;\r\n        iframeDimentions.message.iframeHeight = $('body').height();\r\n        if (self.Class.shortName == \"newcaselist\") {\r\n        } else {\r\n            iframeDimentions.message.iframeWidth = undefined;\r\n        }\r\n        self.postmessageSocket.send(iframeDimentions);\r\n    },\r\n\r\n    /**\r\n     *   Publish an event so any controller can subscribe to it\r\n     */\r\n    publish: function (eventName, params, notFireToIframe) {\r\n        var self = this;\r\n        eventName = this.namespace ? this.namespace + \".\" + eventName : eventName;\r\n        //publish event to iframe\r\n        if (!!!notFireToIframe && eventName.indexOf(\"bizagi-webpart-created\") == -1 && eventName.indexOf(\"bizagi-webpart-executed\") == -1 && self.postmessageSocket) {\r\n            var msg = {};\r\n            msg.event = eventName;\r\n            //By iFrame messages it can not transmit the canvas object or object workportal\r\n            if (params) {\r\n                params.canvas = null;\r\n                params.workportal = null;\r\n            }\r\n\r\n            msg.message = {};\r\n            msg.message = $.extend(params, {\r\n                project: this.project,\r\n                iframeidentifier: BIZAGI_IFRAME_IDENTIFIER\r\n            });\r\n            msg.message.whenInitialized = null;\r\n            self.postmessageSocket.send(msg);\r\n        }\r\n        //publish event localy in webparts\r\n        return this._super(eventName, $.extend(params, {\r\n            project: this.project\r\n        }));\r\n    },\r\n\r\n    /**\r\n     *   Subscribe to an event that any controller could trigger\r\n     */\r\n    subscribe: function (eventName, callback) {\r\n        var self = this;\r\n        eventName = this.namespace ? this.namespace + \".\" + eventName : eventName;\r\n        this._super(eventName, function (e, params) {\r\n            if (self.project == params.project && self.isVisible)\r\n                return callback(e, params);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   UnSubscribe to an event that any controller could trigger\r\n     */\r\n    unsubscribe: function (eventName, callback) {\r\n        var self = this;\r\n        eventName = this.namespace ? this.namespace + \".\" + eventName : eventName;\r\n        this._super(eventName, callback);\r\n    },\r\n\r\n    /*\r\n     *   Re-draw the webpart\r\n     */\r\n    refresh: function (params) {\r\n        var self = this;\r\n        var content = this.getContent();\r\n\r\n        // Clear content\r\n        content.empty();\r\n\r\n        // Dispose stuff\r\n        self.prepareForRefresh();\r\n\r\n        // Re-draw content;\r\n        $.when(self.render(params))\r\n            .done(function (newContent) {\r\n                if ($.contains(window.document, content[0])) {\r\n                    bizagi.util.replaceSelector($(\"body\", window.document), content, newContent);\r\n                } else {\r\n                    $(\"#\" + content.attr(\"id\"), window.document).empty();\r\n                    bizagi.util.replaceSelector($(\"body\", window.document), \"#\" + content.attr(\"id\"), newContent);\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n     *   Renders the web part\r\n     *   Also ensures that templates are loaded\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Set params in webpart variable\r\n        self.params = params;\r\n\r\n        if (params.creating) {\r\n            self.content = self.empty();\r\n\r\n            // Trigger webpart created event\r\n            self.publish(\"bizagi-webpart-created\", {\r\n                webpart: self\r\n            });\r\n\r\n            return self.content;\r\n        }\r\n\r\n        // Load templates\r\n        return $.when(self.renderContent(params))\r\n            .pipe(function (content) {\r\n                // Then customize in current device\r\n                // if you use fastTmpl the object string is transformed to object html -jquery\r\n                if (typeof (content) == \"string\") content = $(content);\r\n\r\n                self.content = content;\r\n                self.postRender(params);\r\n\r\n                // Trigger webpart executed event\r\n                self.publish(\"bizagi-webpart-executed\", {\r\n                    webpart: self\r\n                });\r\n                self.sendDimensionsiFrame();\r\n                return self.getContent();\r\n            });\r\n    },\r\n\r\n    /*\r\n     *   Renders the web part, override this method in each webpart\r\n     */\r\n    renderContent: function (params) {},\r\n\r\n    /*\r\n     *   Customize the web part in each device\r\n     */\r\n    postRender: function (params) {},\r\n\r\n    /*\r\n     *   Return the rendered content\r\n     */\r\n    getContent: function () {\r\n        return this.content;\r\n    },\r\n\r\n    /*\r\n     *   Creates an empty content\r\n     */\r\n    empty: function () {\r\n        return $(\"<div/>\");\r\n    },\r\n\r\n    /*  \r\n     *   Return a specified template\r\n     */\r\n    getTemplate: function (template) {\r\n        return this.workportalFacade.getTemplate(template);\r\n    },\r\n\r\n    /*  \r\n     *   Create webpart\r\n     */\r\n    createWebpart: function (params) {\r\n        return this.workportalFacade.workportal.createWebpart(params);\r\n    },\r\n\r\n    /*  \r\n     *   Execute webpart\r\n     */\r\n    executeWebpart: function (params) {\r\n        return this.workportalFacade.workportal.executeWebpart(params);\r\n    },\r\n    /**\r\n     *   Manage the error in base class\r\n     */\r\n    manageError: function (msg, defer, canvasError) {\r\n        var self = this;\r\n        var errorMsg = '';\r\n        if (msg.responseText) {\r\n            errorMsg = msg.responseText;\r\n        } else {\r\n            errorMsg = msg;\r\n        }\r\n        if (errorMsg.indexOf(\"AUTHENTICATION_ERROR\") == -1) {\r\n            self.helper.getFailServerErrorDeferred({\r\n                message: errorMsg,\r\n                sharepointProxyPrefix: self.sharepointProxyPrefix\r\n            }, defer);\r\n            self.endWaiting();\r\n            //en caso de no tener un canvasError el error se despliega en todo el content\r\n            if (canvasError) {\r\n                defer.done(function (value) {\r\n                    canvasError.append(value);\r\n                    self.endWaiting();\r\n                });\r\n            }\r\n            //defer.resolve(msg);\r\n        } else {\r\n            //when it's generate autentication error, cannot load the template\r\n            var content = self.content = \"<div class='ui-bizagi-webpart-error-message'>The current user does not exist as a registered user in the bizagi project</div>\";\r\n            if (canvasError) {\r\n                canvasError.append(content);\r\n            }\r\n            self.endWaiting();\r\n            defer.resolve(content);\r\n        }\r\n    },\r\n    /**\r\n     *   On waiting. En el area del webpart agrega un div del mismo tamanio y de las mismas coordenadas que el content.\r\n     */\r\n    onWaiting: function () {\r\n        var self = this;\r\n        bizagi.startWaiting(document.getElementById(self.canvas[0].id));\r\n    },\r\n    /**\r\n     *   Off waiting. \r\n     */\r\n    endWaiting: function () {\r\n        var self = this;\r\n        self.canvas.children(\".ui-bizagi-sharepoint-loading-container\").remove();\r\n    },\r\n\r\n    /**\r\n     *   Hide WebPart\r\n     */\r\n    hide: function (hideParent) {\r\n        var self = this;\r\n        self.canvas.hide();\r\n        if (hideParent) {\r\n            self.canvas.parent().hide();\r\n        }\r\n        self.isVisible = false;\r\n    },\r\n    /**\r\n     *    Show WebPart\r\n     */\r\n    show: function () {\r\n        var self = this;\r\n        self.canvas.show();\r\n        self.canvas.parent().show();\r\n        self.isVisible = true;\r\n    },\r\n    /**\r\n     *    visible flat\r\n     */\r\n    isVisible: function () {\r\n        var self = this;\r\n        return self.isVisible;\r\n    },\r\n\r\n    destroy: function () {\r\n\r\n    },\r\n\r\n    prepareForRefresh: function () {\r\n\r\n    }\r\n\r\n});","\r\n/*\r\n *   Name: BizAgi Workportal Action\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to process workportal actions in order to take decisions\r\n */\r\n\r\nbizagi.workportal.controllers.controller.extend(\"bizagi.workportal.actions.action\", {\r\n\t    BIZAGI_WORKPORTAL_ACTION_ROUTING: \"routing\",\r\n        BIZAGI_WORKPORTAL_ACTION_SEARCH : \"search\"\r\n    }, {\r\n        \r\n        /*\r\n         *   Makes the base processing of the layout (mix templates + data)\r\n         *   after all that processing will call a post-render method to\r\n         *   be implemented in each device to apply custom plugins\r\n         *   Returns a promise because the rendering could be asynchronous\r\n         */\r\n        render: function () {\r\n            bizagi.assert(false, \"An action can't be rendered because it has no view\");\r\n        },\r\n                    \r\n            \r\n        /*\r\n         *   To be overriden in each device to apply layouts\r\n         */\r\n        postRender: function(){ \r\n            bizagi.assert(false, \"An action can't be rendered because it has no view\");\r\n        },\r\n            \r\n        /*\r\n         *   Executes the action\r\n         *   Could return a deferred\r\n         */\r\n        execute: function(){\r\n            // Override in implementations\r\n        }\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Routing Action\r\n *   Author: Diego Parra && Edward Morales\r\n *   Comments:\r\n *   - This script will execute the routing action to determine what to do in the workportal\r\n *   - This class has been refactored based on jira story DRAGON-4943\r\n */\r\n\r\nbizagi.workportal.actions.action.extend(\"bizagi.workportal.actions.routing\", {}, {\r\n\r\n    /*\r\n    *   Executes the action\r\n    *   Could return a deferred\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n        self.params = params || {};\r\n        /* New implementation of routing*/\r\n\r\n        $.when(self.dataService.routing.getRoute(params)).done(function (route) {\r\n            var deferredDialogOpened =  $.Deferred();\r\n            route = route || {};\r\n\r\n            if (self.params.isOfflineForm != \"undefined\" && self.params.isOfflineForm == true) {\r\n                route.moduleParams = $.extend(route.moduleParams, { formsRenderVersion: self.params.formsRenderVersion, isOfflineForm: self.params.isOfflineForm, idCase: self.params.idCase, idWorkitem: self.params.idWorkitem, guid: self.params.guid }) || {};\r\n            }\r\n            else {\r\n                route.moduleParams = route.moduleParams || {};\r\n            }\r\n\r\n            switch (route.module) {\r\n\r\n                case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER:\r\n                case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION:\r\n                case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC:\r\n                    self.publish(\"changeWidget\",route.moduleParams);\r\n                    self.publish(\"closeAllDialogs\");\r\n                    break;\r\n                case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD:\r\n\r\n                    /**\r\n                     * TODO: To improvevement when enable workportal menu from live processes\r\n                     */\r\n                    bizagi.util.enableWorkPortalMenu();\r\n                    \r\n                    //Validation to go to inbox when click next of an activity, and GoToInbox is yes and there are no more activities.\r\n                    if(bizagi.services.preferences().getPreference(\"goToInbox\") === \"yes\" && \r\n                    route.moduleParams.referrer === \"bizagi.workportal.widgets.project.activity\" && \r\n                    route.moduleParams.hasWorkItems === false){\r\n                        self.goToInbox(route.moduleParams);\r\n                    }else{\r\n                        var data = $.extend(params, route.moduleParams);\r\n                        bizagi.util.setContext(data);\r\n                        self.publish(\"changeWidget\", route.moduleParams);\r\n                    }\r\n\r\n                    self.publish(\"closeAllDialogs\");\r\n                    break;\r\n\r\n                case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM:\r\n                    var parameters = {\r\n                        title: self.getResource(\"workportal-widget-newcase-title\"),\r\n                        width: 850,\r\n                        height: 750,\r\n                        refreshInbox: false,\r\n                        onClose: route.moduleParams.onClose,\r\n                        dialogOpened : deferredDialogOpened\r\n\r\n                    };\r\n                    self.publish(\"showDialogWidget\", {\r\n                        widgetName: route.module,\r\n                        data: route.moduleParams.data,\r\n                        modalParameters: parameters,\r\n                        closeVisible: false,\r\n                        dialogClass : \"ui-bizagi-start-form-dialog\"\r\n                    });\r\n\r\n                    deferredDialogOpened.promise().done(function(response) {\r\n                        self.publish(\"onWidgetIncludedInDOM\");\r\n                        response.widgetReference.postRender();\r\n                    });\r\n                    \r\n                    break;\r\n                case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ROUTING:\r\n                    var parameters = {\r\n                        title: self.getResource(\"workportal-widget-routing-window-selector\"),\r\n                        width: 670,\r\n                        height: 450,\r\n                        refreshInbox: false,\r\n                        onClose: route.moduleParams.onClose\r\n                    };\r\n\r\n                    if (self.isThereAsync(route.moduleParams.data)) {\r\n                        self.asyncWidget(route.moduleParams);\r\n                    } else {\r\n                        self.publish(\"showDialogWidget\", {\r\n                            widgetName: route.module,\r\n                            data: route.moduleParams.data,\r\n                            modalParameters: parameters,\r\n                            onClose: parameters.onClose\r\n                        });\r\n                    }\r\n              \r\n                    break;\r\n            }\r\n\r\n        });\r\n    },\r\n    /*\r\n    * Go to inbox when an activity ends\r\n    */\r\n    goToInbox: function(routeModuleParams){\r\n        var self = this;\r\n        self.publish(\"changeWidget\", {\r\n            widgetName: self.workportalFacade.workportal.getWidgetByCookie(true)\r\n        });\r\n    \r\n        self.notifier = bizagi.injector.get(\"notifier\");\r\n\r\n        var messageWhenGoToInbox = routeModuleParams.messageForm ? routeModuleParams.messageForm : bizagi.localization.getResource(\"render-without-globalform\");\r\n        \r\n        self.notifier.showSucessMessage(messageWhenGoToInbox, \"\",\"\"); \r\n    },\r\n\r\n    /*\r\n    * Search for async workitems\r\n    */\r\n    isThereAsync: function (data) {\r\n        var workitems = data.workItems, wi, index = 0;\r\n        var length = workitems.length, result = false;\r\n        if (length > 0) {\r\n            for (; index < length;) {\r\n                wi = workitems[index++];\r\n                if (wi.isAsynch === \"true\") {\r\n                    result = result || [];\r\n                    result.push(wi);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    asyncWidget: function (params) {\r\n        var self = this;\r\n        params.widgetName = \"async\";\r\n        self.publish(\"changeWidget\", params);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Workportal Search Action\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will execute the search action\r\n*/\r\n\r\nbizagi.workportal.actions.action.extend(\"bizagi.workportal.actions.search\", {}, {\r\n\r\n    /*\r\n    *   Executes the action\r\n    *   Could return a deferred\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n        // Set params reference\r\n        self.params = params;\r\n\r\n        // Referer parameters for render actions\r\n        var referrerParams = {\r\n            radNumber: $.trim(params.radNumber),\r\n            idWorkflow: \"\",\r\n            taskState: \"all\",\r\n            // Filter by favorites  only when we are searching all processes and favorites\r\n            onlyFavorites: false,\r\n            // Sort and order parameters\r\n            order: params.order || \"\",\r\n            orderFieldName: params.orderFieldName || \"\",\r\n            orderType: params.orderType || \"0\",\r\n            page: params.page || 1,\r\n\t\t\tgroup: (bizagiConfig.groupByCaseNumber)?\"T_RADNUMBER\":null\r\n        };\r\n\r\n        // Loads case workitems\r\n        $.when(\r\n        //self.dataService.searchCases(referrerParams)\r\n\t\t\tself.dataService.getCustomizedColumnsData(referrerParams)\r\n\t\t\t)\r\n\t\t.done(function (data) {\r\n\t\t    bizagi.lstIdCases = data.cases.lstIdCases;\r\n\t\t    //  Hack json data :(\r\n\t\t    var i = 0;\r\n\t\t    $(data.cases.columnTitle).each(function (key, value) {\r\n\t\t        value[\"radNumber\"] = $.trim(params.radNumber);\r\n\t\t        if (value.order == \"T_idTask\") {\r\n\t\t            $(data.cases.rows).each(function (key2, value2) {\r\n\t\t                if (!self.isArray(value2[\"fields\"][i])) {\r\n\t\t                    data[\"cases\"][\"rows\"][key2][\"fields\"][i] = {\r\n\t\t                        \"workitems\": [{\r\n\t\t                            \"TaskName\": value2[\"fields\"][i],\r\n\t\t                            \"State\": data[\"cases\"][\"rows\"][key2][\"taskState\"]\r\n\t\t                        }]\r\n\t\t                    };\r\n\t\t                }\r\n\t\t            });\r\n\t\t        }\r\n\t\t        i++;\r\n\t\t    });\r\n\t\t    // Define radnumber for render actions bottons \r\n\t\t    bizagi.referrerParams = bizagi.referrerParams || {};\r\n\t\t    bizagi.referrerParams.radNumber = params.radNumber;\r\n\t\t    bizagi.referrerParams.page = params.page || 1;\r\n\t\t    data.IsFavorite = false;\r\n\t\t    data.IsOpen = false;\r\n\t\t    bizagi.referrerParams.referrer = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH;\r\n\t\t    //bizagi.referrerParams.referrer = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID;\r\n\t\t    // one result\r\n\t\t    if (data.cases.lstIdCases.length == 0) {\r\n\t\t        //show no results found\r\n\t\t        self.showNoResults(referrerParams);\r\n\t\t    } else if (data.cases.rows.length == 1) {\r\n\r\n\t\t        self.showSearch(data, params);\r\n\r\n\r\n\t\t    } else if (data.cases.rows.length >= 1) {\r\n\t\t        self.showSearch(data, referrerParams);\r\n\t\t    }\r\n\t\t});\r\n    },\r\n\r\n    /*\r\n    *   Shows search results\r\n    */\r\n    showSearch: function (data, parameters) {\r\n        var self = this;\r\n        // Shows a dialog widget\r\n        bizagi.referrerParams.requestGlobalForm = true;\r\n\r\n        // define params to back button\r\n        bizagi.referrerParams.referrerBackButton = bizagi.referrerParams.referrerBackButton || bizagi.context.widget || bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID;\r\n\r\n        self.publish(\"changeWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n            data: data,\r\n            referrerParams: parameters\r\n        }).done(function(){\r\n            // Hide the container pagination:\r\n            if(bizagi.util.isEmpty($(\"#footer #casesPagination\").html().trim())){\r\n                $(\"#footer #casesPagination\").hide();\r\n            }\r\n            \r\n        });\r\n\r\n        if (bizagi.util.isTabletDevice()) {\r\n            $(\"#menu-items #search\").trigger(\"closePopUp\");\r\n        }\r\n        \r\n        // Simulate a click on the button after a successful search\r\n        //  $('#menu-toggler').trigger('click');\r\n    },\r\n\r\n    showNoResults: function (referrerParams) {\r\n        var self = this;\r\n        var originarlColor = $(\"#menuQuery\").css(\"color\");\r\n\r\n        $(\"#menuQuery\").css(\"color\", \"#f88f88\");\r\n        setTimeout(function () {\r\n            $(\"#menuQuery\").css(\"color\", originarlColor);\r\n        }, 5000);\r\n\r\n        if (bizagi.detectDevice() == \"smartphone_ios\" || bizagi.detectDevice() == \"smartphone_android\") {\r\n            self.showSearch({ \"noresults\": referrerParams.radNumber }, referrerParams);\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    *   Show process\r\n    */\r\n    redirectToProcess: function (idCase) {\r\n        var self = this;\r\n        // Executes routing action\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            onlyUserWorkItems: \"false\"\r\n        });\r\n    },\r\n    /*\r\n    *   Misc method to format cell values\r\n    */\r\n    formatRequest: function (value) {\r\n        return value;\r\n    },\r\n    /**\r\n    * Misc method to render categories\r\n    */\r\n    formatCategories: function (value) {\r\n        return value;\r\n    },\r\n    isArray: function (value) {\r\n        if (typeof (value) == 'object') {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n    isDate: function (value) {\r\n        value = value || '';\r\n        var state = false;\r\n        var slash = (typeof value == 'string') ? value.split(\"/\") : '';\r\n        try {\r\n            // Check format int/int/int\r\n            if (slash.length == 3) {\r\n                var date = new Date(value);\r\n                if (date.getYear() > 0) {\r\n                    state = true;\r\n                }\r\n            }\r\n        } catch (e) {\r\n            state = false;\r\n        }\r\n\r\n        return state;\r\n    }\r\n});\r\n","\r\n/*\r\n*   Name: BizAgi Workportal Widget Controller\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class to all widgets\r\n*/\r\n\r\nbizagi.workportal.controllers.controller.extend(\"bizagi.workportal.widgets.widget\", {\r\n    BIZAGI_WORKPORTAL_WIDGET_INTEGRATION: \"widgetIntegration\",\r\n    BIZAGI_WORKPORTAL_WIDGET_WEBPART: \"webpart\",\r\n    BIZAGI_WORKPORTAL_WIDGET_INBOX: \"inbox\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADVANCE_SEARCH: \"advanceSearch\",\r\n    BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL: \"homeportal\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ACTIVITY: \"project.activity\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD: \"projectDashboard\",\r\n    BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID: \"inboxGrid\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ROUTING: \"routing\",\r\n    BIZAGI_WORKPORTAL_WIDGET_SEARCH: \"search\",\r\n    BIZAGI_WORKPORTAL_WIDGET_RENDER: \"activityform\",\r\n    BIZAGI_WORKPORTAL_WIDGET_START_FORM: \"startForm\",\r\n    BIZAGI_WORKPORTAL_WIDGET_RENDERFORM: \"renderform\",\r\n    BIZAGI_WORKPORTAL_WIDGET_NEWCASE: \"newCase\",\r\n    BIZAGI_WORKPORTAL_WIDGET_QUERIES: \"queries\",\r\n    BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION: \"queriesDefinition\",\r\n    BIZAGI_WORKPORTAL_WIDGET_QUERIES_SHORTCUT: \"queriesShortcut\",\r\n    BIZAGI_WORKPORTAL_WIDGET_QUERYFORM: \"queryform\",\r\n    BIZAGI_WORKPORTAL_WIDGET_LISTCASES: \"listCases\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ASYNC: \"async\",\r\n    BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME: \"genericiframe\",\r\n    BIZAGI_WORKPORTAL_WIDGET_SUBMENU: \"subMenu\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PRINT: \"print\",\r\n    BIZAGI_WORKPORTAL_WIDGET_FONTSIZE: \"fontsize\",\r\n    BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION: \"oldrenderintegration\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PAGE: \"page\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ENTITIES: \"entities\",\r\n    BIZAGI_WORKPORTAL_WIDGET_REPORTS: \"reports\",\r\n    BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU: \"reportsMenu\",\r\n    BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART: \"reportsChart\",\r\n    BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS: \"smartfolders\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASES: \"adminReassignCases\",\r\n    BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE: \"reassignCase\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD: \"asyncECMUpload\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE: \"processTree\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE: \"entitiesTree\",\r\n    BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE: \"usersTable\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG: \"activityLog\",\r\n    BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG: \"authenticationLog\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES: \"entityAdmin\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS: \"encryptPasswords\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS: \"userPendingRequests\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH: \"adminCaseSearch\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES: \"asyncActivities\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER: \"defaultsAssignUser\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_TRANSFER_CASE_SECURITY_PERMISSIONS: \"transferCaseSecurityPermissions\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES: \"userProfiles\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS: \"adminAlarms\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES: \"userlicenses\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS: \"dimensions\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES: \"documentTemplates\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES: \"processes\",\r\n    BIZAGI_WORKPORTAL_WIDGET_START_PROCESS: \"startProcess\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES: \"businessPolicies\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE: \"languageAdmin\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE: \"businessPoliciesDecisionTable\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS: \"businessPoliciesPolitics\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES: \"businessPoliciesRules\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS: \"businessPoliciesTabs\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES: \"businessPoliciesVocabularies\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES: \"adminPreferences\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_DISPLAY_OPTIONS: \"adminDisplayOptions\",\r\n    BIZAGI_WORKPORTAL_WIDGET_TREE: \"tree\",\r\n    BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY: \"graphicquery\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW: \"processModeler\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION: \"adminUsers\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION: \"usersDelegation\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION_SEARCH_USER: \"usersDelegationSearchUser\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS: \"adminStakeholders\",\r\n    BIZAGI_WORKPORTAL_WIDGET_BIZAGI_EVENTS: \"events\",\r\n    BIZAGI_WORKPORTAL_WIDGET_BIZAGI_RELEASE: \"release\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_DIAGRAM_HELPER: \"processDiagramHelper\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PROJECT_ACTIVITY_MAP_TOOLTIP: \"activityMapTooltip\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PROJECT_USERSUMMARY: \"usersummary\",\r\n    BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST: \"mySearchList\",\r\n    BIZAGI_WORKPORTAL_WIDGET_LOADFORM: \"loadForm\",\r\n    BIZAGI_WORKPORTAL_WIDGET_TEMPLATE_ENGINE: \"templates\",\r\n    BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV: \"dialognav\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS: \"holidays\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME: \"projectName\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS: \"oauth2Applications\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES: \"adhocProcesses\",\r\n    BIZAGI_WORKPORTAL_WIDGET_TIMELINE: \"timeline\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADHOC_PROCESS_MODELER: \"adhocProcessModeler\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES: \"adhocEntities\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS: \"adhocUserGroups\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_CREATE_PROCESS: \"adhocCreateProcess\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_BOOLEAN_EXP: \"adhocBooleanExp\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS: \"adhocCreateProcess\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUP_REPORT: \"adhocUserGroupReport\",\r\n    BIZAGI_WORKPORTAL_WIDGET_PROFLY: \"adhocprofly\",\r\n    BIZAGI_WORKPORTAL_WIDGET_SESSION_TIMEOUT: \"sessionTimeOut\",\r\n    BIZAGI_WORKPORTAL_WIDGET_SESSION_TIMEOUT_EXPIRED: \"sessionTimeOutExpired\",\r\n    BIZAGI_WORKPORTAL_WIDGET_USER_PRIVACY: \"userPrivacy\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ACCESS_DENIED: \"accessDenied\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICES: \"adminBusinessPolices\",\r\n    BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL: \"usersModal\",\r\n    BIZAGI_WORKPORTAL_WIDGET_QUERIES_MANAGEMENT: \"queriesManagement\",\r\n    BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PERMISSION_REPORT: \"userPermissionReport\"\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        // Call base\r\n        this._super(workportalFacade, dataService);\r\n\r\n        // Set params\r\n        this.params = params;\r\n        if (params && params.menu) {\r\n            this.menu = params.menu;\r\n        }\r\n\r\n        this.observableElement = $({});\r\n\r\n        this.widgetReadyDeferred = new $.Deferred();\r\n\r\n        this.isBlocked = false;\r\n    },\r\n\r\n    /*\r\n    *   Publish an event so any controller can subscribe to it\r\n    */\r\n    publish: function (eventName, params) {\r\n        if (this.disposed) return null;\r\n        // Overrides base method to add referrer\r\n        $(document).triggerHandler(eventName, $.extend(params, {\r\n            referrer: this.getWidgetName()\r\n        }));\r\n    },\r\n\r\n\r\n    /*\r\n    *   Change the current widget\r\n    */\r\n    changeWidget: function (widgetName, params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var widgetParams = $.extend(params, {\r\n            widgetName: widgetName\r\n        });\r\n        self.publish(\"changeWidget\", widgetParams);\r\n    },\r\n\r\n    /*\r\n    *   Executes a workportal action\r\n    */\r\n    executeAction: function (actionName, params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var actionParams = $.extend(params, {\r\n            action: actionName\r\n        });\r\n        self.publish(\"executeAction\", actionParams);\r\n    },\r\n\r\n    /*\r\n    * Show graphic query\r\n    */\r\n    showGraphicQuery: function (data) {\r\n        var self = this;\r\n        /*This method is used for validate if the request is referd to process on the fly */\r\n        var processOnTheFly = data.isAdhoc;\r\n        if(processOnTheFly === true){\r\n            bizagi.loader.start(\"processmodelerview\").then(function () {\r\n                self.publish(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW,\r\n                    data: data,\r\n                    modalParameters: {\r\n                        title: \"Process viewer\",\r\n                        refreshInbox: false\r\n                    },\r\n                    maximizeOnly: true,\r\n                    onClose: function () {\r\n                        bizagi.workportal.desktop.dialogStack.pop();\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        else{\r\n            bizagi.loader.start(\"processviewer\").then(function () {\r\n                self.publish(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY,\r\n                    data: data,\r\n                    modalParameters: {\r\n                        title: self.getResource(\"render-graphic-query\"),\r\n                        refreshInbox: false\r\n                    },\r\n                    maximizeOnly: true,\r\n                    onClose: function () {\r\n                        bizagi.workportal.desktop.dialogStack.pop();\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    isProcessOnTheFlyCase: function () {\r\n        return true;\r\n    },\r\n\r\n    showTimeLine: function (data) {\r\n        var self = this;\r\n        bizagi.loader.startAndThen(\"timeline\").then(function () {\r\n            self.publish(\"showDialogWidget\", {\r\n                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_TIMELINE,\r\n                data: data,\r\n                modalParameters: {\r\n                    title: self.getResource(\"workportal-project-casedashboard-timeline\"),\r\n                    refreshInbox: false\r\n                },\r\n                maximizeOnly: true,\r\n                onClose: function () {\r\n                    bizagi.workportal.desktop.dialogStack.pop();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    routingExecute: function (element) {\r\n        // Executes routing action\r\n        if (element == undefined) {\r\n            return false;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        var idCase = element.find(\"#idCase\").val() || self.params.idCase;\r\n        var idWorkflow = element.find(\"#idWorkflow\").val() || self.params.idWorkflow;\r\n        var idWorkItem = element.find(\"#idWorkItem\").val() || element.parent().find(\"#idWorkItem\").val();\r\n        var idTask = element.find(\"#idTask\").val();\r\n        var eventAsTasks = element.find(\"#eventAsTasks\").val() || false;\r\n\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            idWorkflow: idWorkflow,\r\n            idWorkItem: idWorkItem,\r\n            idTask: idTask,\r\n            eventAsTasks: eventAsTasks\r\n        });\r\n\r\n        return true;\r\n    },\r\n\r\n\r\n    /*\r\n    * Gets the name of widget, Override on implementations\r\n     */\r\n    getWidgetName: function(){\r\n        return this.Class.fullName;\r\n    },\r\n\r\n\r\n    /*\r\n    *\r\n    */\r\n    sub: function (event) {\r\n        // Gets events registered\r\n        //var events = $._data(this.observableElement[0], \"events\");\r\n        // If the events exist, ignore it\r\n        //if (!events || !events[event]) {\r\n        this.observableElement.off.apply(this.observableElement, arguments);\r\n        this.observableElement.on.apply(this.observableElement, arguments);\r\n        //}\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    unsub: function () {\r\n        this.observableElement.off.apply(this.observableElement, arguments);\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    pub: function () {\r\n        return this.observableElement.triggerHandler.apply(this.observableElement, arguments);\r\n    },\r\n\r\n    /**\r\n     * This method must be used when i need to wait to all observers has been resolved\r\n     */\r\n    pubDeadLockDetection: function () {\r\n        var def = new $.Deferred();\r\n        if (!self.isBlocked) {\r\n            self.isBlocked = true;\r\n            var pubDef = this.pub.apply(this, arguments);\r\n            var queueDef = Array.isArray(pubDef) ? pubDef : [pubDef];\r\n            $.when.apply($, queueDef).done(function (data) {\r\n                self.isBlocked = false;\r\n                def.resolve();\r\n            });\r\n        } else {\r\n            def.reject()\r\n        }\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n    * Clean the widget, removing events asociated with it.\r\n    */\r\n    clean: function(){\r\n        var self = this;\r\n\r\n        //remove events\r\n        if (this.observableElement) {\r\n            var events = $._data(this.observableElement[0], \"events\");\r\n\r\n            if (events) {\r\n                for (var event in events) {\r\n                    if (event != \"notify\" &&\r\n                         event != 'showDialogWidget' &&\r\n                         event != 'showNotification') {\r\n                        self.unsub(event);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    isReady: function(){\r\n        return this.widgetReadyDeferred.promise();\r\n    },\r\n\r\n    setWidgetReady: function(){\r\n        this.widgetReadyDeferred.resolve();\r\n    }\r\n\r\n});\r\n","\r\n/*\r\n*   Name: BizAgi Workportal Webpart Widget Controller\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a wrapper class to to load custom webparts\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.webpart\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_WEBPART;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        // Call base\r\n        this._super(workportalFacade, dataService, params);\r\n\r\n        // Set webpart \r\n        this.webpartName = params.webpart;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var content = self.content = $(\"<div />\");\r\n        var workportal = self.getWorkportal();\r\n\r\n        // Execute webpart\r\n        workportal.executeWebpart($.extend(self.params,{\r\n            canvas: content,\r\n            webpart: self.webpartName\r\n        }));\r\n\r\n        return content;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Workportal Print Version Widget Controller\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script will define a base class to to define the print version widget\r\n *       the rendering module is loaded here\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.print\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function(){  \r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"print\");\r\n\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    }   \r\n});\r\n","\r\n/*\n*   Name: BizAgi Workportal Search Controller\n*   Author: Jair Cardenas\n*   Comments:\n*   -   Base library for fontsize \n*/\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.fontsize\", {}, {\n    /*\n    *   Returns the widget name\n    */\n    getWidgetName: function(){  \n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FONTSIZE;\n    },\n\n    /*\n    *   Renders the content for the current controller\n    *   Returns a deferred because it has to load the current user\n    */\n    renderContent: function () {\n        var self = this;\n        var template = self.getTemplate(\"fontsize\");\n\n        var content = self.content = $.tmpl(template);\n\n        return content;\n    }\n});\n","/*\r\n*   Name: BizAgi Workportal Routing Widget Controller\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class to to define the routing widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.routing\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n    },\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function(){  \r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ROUTING;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"routing\");\r\n        var def = new $.Deferred();\r\n        //check subprocess\r\n        if(self.params.data.checkProcess || self.params.data.checkWorkItems){\r\n            $.when(\r\n                self.dataService.getCaseSubprocesses({\r\n                    idCase: self.params.data.idCase\r\n                })            \r\n            ).done(function(process){\r\n                self.params.data.subProcessPersonalized = process[\"subProcesses\"];                        \r\n\r\n                //Validate in workitems have property idtask. Scenario when workitem is activity from plan\r\n                self.params.data.workItems.forEach(function(workitem){\r\n                    if(!workitem.idTask){\r\n                        workitem.idTask = \"\";\r\n                    }\r\n                });\r\n\r\n                // Loads case workitems\r\n                // Solve QA-2197\r\n                var content = self.content = $.tmpl(\r\n                        template,\r\n                        self.params.data,\r\n                        {\r\n                            formatDate: self.formatDate\r\n                        }\r\n                );\r\n                def.resolve(content);\r\n                \r\n            });\r\n        }\r\n        return def.promise();\r\n    },\r\n\r\n    formatDate: function(item){\r\n        return bizagi.util.formatDateFromInvariantStringDate(item.estimatedSolutionDate);\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Render Widget Controller\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class to to define the render widget\r\n*       the rendering module is loaded here\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.render\", {}, {\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER;\r\n    },\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function(workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Check if the required params are filled\r\n        if (bizagi.util.isEmpty(params.idCase)) {\r\n\r\n            if (!bizagi.util.isEmpty(window.location.hash)) {\r\n                // Check in the hash\r\n                var hashParams = bizagi.util.getHashParams();\r\n\r\n                // Set the first hash param as the idCase\r\n                if (hashParams.length > 1) {\r\n                    params.idCase = hashParams[1];\r\n                    self.isConfiguredFromHash = true;\r\n                }\r\n\r\n                // Set the second hash param as the idWorkitem\r\n                if (hashParams.length > 2) {\r\n                    params.idWorkitem = hashParams[2];\r\n                }\r\n            } else if (!bizagi.util.isEmpty(window.location.search)) {\r\n                var queryString = bizagi.util.getQueryString();\r\n\r\n                // Set idCase param from query string\r\n                if (queryString[\"idCase\"]) {\r\n                    params.idCase = queryString[\"idCase\"];\r\n                    self.isConfiguredFromHash = true;\r\n                }\r\n                else\r\n                    // Set guid param from query string\r\n                    if (queryString[\"guid\"]) {\r\n                        params.guid = queryString[\"guid\"];\r\n                        self.isConfiguredFromHash = true;\r\n                    }\r\n                // Set idWorkitem param from query string\r\n                if (queryString[\"idWorkitem\"]) {\r\n                    params.idWorkitem = queryString[\"idWorkitem\"];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);                \r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"render\");\r\n        var summaryDeferred = new $.Deferred();\r\n        var details = {};\r\n        // Check if the required params are filled\r\n        if (bizagi.util.isEmpty(self.params.idCase) && bizagi.util.isEmpty(self.params.guid)) {\r\n            self.changeWidget(bizagi.workportal.currentInboxView);\r\n            return null;\r\n        }\r\n        details = (self.params.idCase) ?\r\n        {\r\n            idCase: self.params.idCase,\r\n            eventAsTasks: self.params.eventAsTasks,\r\n            onlyUserWorkItems: self.params.onlyUserWorkItems,\r\n            idWorkitem: self.params.idWorkitem,\r\n            isOfflineForm: self.params.isOfflineForm || false\r\n        } :\r\n        {\r\n            guid: self.params.guid,\r\n            eventAsTasks: self.params.eventAsTasks,\r\n            onlyUserWorkItems: self.params.onlyUserWorkItems,\r\n            idWorkitem: self.params.idWorkitem,\r\n            isOfflineForm: self.params.isOfflineForm || false\r\n        }\r\n        // Check if the required params are filled\r\n        if (bizagi.util.isEmpty(self.params.idWorkitem) && self.isConfiguredFromHash) {\r\n            if (!bizagi.util.isEmpty(self.params.idCase)) self.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING, { idCase: self.params.idCase });\r\n            else if (!bizagi.util.isEmpty(self.params.guid)) self.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING, { guid: self.params.guid });\r\n            return null;\r\n        }\r\n\r\n        // Render base template\r\n        self.content = $.tmpl(template);\r\n\r\n        // Render Form Tab\r\n        $.when(\r\n                self.dataService.summaryCaseDetails(details)).done(function (data) {\r\n\r\n                    // Define global context into the comments section\r\n                    // they need know global context to eval if stop interval\r\n                    // or keep running, bizagi.util.setInterval\r\n                    bizagi.util.setContext({\r\n                        idCase: data.idCase || null,\r\n                        caseNumber: data.caseNumber || null,\r\n                        widget: self.getWidgetName(),\r\n                        idWorkitem: self.params.idWorkitem || null,\r\n                        idTask: self.params.idTask || null,\r\n                        isOfflineForm: self.params.isOfflineForm || false\r\n                    });\r\n                    data[\"params\"] = self.params;\r\n                    //check if show event tab or not\r\n                    if (data[\"countEvents\"] >= 1) {\r\n                        for (var i = 0; i < data[\"currentState\"].length; i++) {\r\n                            if (data[\"currentState\"][i][\"isEvent\"] == \"true\" && data[\"currentState\"][i][\"idWorkItem\"] == data.params.idWorkitem) {\r\n                                data[\"countEvents\"] = data[\"countEvents\"] - 1;\r\n                            }\r\n                        }\r\n                    }\r\n                    data[\"showEvents\"] = (data[\"countEvents\"] >= 1) ? true : false;\r\n\r\n                    //check if the activity can be released\r\n                    var releaseCurrentActivity = $.grep(data.currentState, function (activity) {\r\n                        return (activity.idWorkItem === data.params.idWorkitem) && (activity.allowReleaseActivity);\r\n                    });\r\n                    data[\"allowReleaseActivity\"] = releaseCurrentActivity.length === 1 ? releaseCurrentActivity[0].allowReleaseActivity : false;\r\n\r\n                    summaryDeferred.resolve(self.renderSummary(data));\r\n                });\r\n\r\n\r\n        // Check if the content is already in dom\r\n        var includedInDom = self.content.parents(\"body\").length > 0;\r\n        if (includedInDom) {\r\n            self.renderForm();\r\n        } else {\r\n            // Wait until the dom is ready to execute the rendering, because some controls need references to full DOM\r\n            // (grids and uploads)\r\n            self.subscribeOneTime(\"onWidgetIncludedInDOM\", function () {\r\n\r\n                // Load render page\r\n                self.renderForm({\r\n                    idCase: self.params.idCase,\r\n                    idWorkitem: self.params.idWorkitem,\r\n                    idTask: self.params.idTask,\r\n                    radNumber: self.params.radNumber,\r\n                    withOutGlobalForm: self.params.withOutGlobalForm || false,\r\n                    isOfflineForm: self.params.isOfflineForm || false,\r\n                    messageForm: self.params.messageForm || \"\"\r\n                });\r\n            });\r\n        }\r\n\r\n        // Synchronize deferreds to resolve method\r\n        return summaryDeferred.promise();\r\n    },\r\n\r\n    /*\r\n    *   Renders the summary component of the widget\r\n    */\r\n    renderSummary: function (data) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var cache = {};\r\n        var htmlContent = \"\";\r\n        var security = new bizagi.workportal.command.security(self.dataService);\r\n\r\n        data.showComments = true;\r\n        \r\n        $.when(security.checkSecurityPerm(\"PrintableVersion\"), security.checkSecurityPerm(\"StateLog\"), security.checkSecurityPerm(\"GraphicQuery\")).done(function (PrintableVersion, StateLog, GraphicQuery) {\r\n            data.printableVersion = PrintableVersion;\r\n            data.stateLog = StateLog;\r\n            data.graphicQuery = GraphicQuery;\r\n\r\n            //Hide summary case tabs when idCase = 0\r\n            if (data.idCase == 0) {\r\n                setTimeout(function () {\r\n                    $(\"div.ui-bizagi-wp-app-inbox-description-container \\\r\n                    div.ui-bizagi-loading-message \\\r\n                    div.ui-bizagi-loading-message-center \\\r\n                    div.ui-bizagi-loading-icon\").hide();\r\n                }, 1000);\r\n\r\n                return;\r\n            }\r\n\r\n            var summary = $.tmpl(self.caseSummaryTemplate, $.extend(data, {security: bizagi.menuSecurity})).appendTo(self.getComponentContainer(\"summary\"));\r\n\r\n            // Format invariant dates\r\n            bizagi.util.formatInvariantDate(content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n\r\n            // Delegate events for parent process\r\n            $(\"#details\", summary).delegate(\".summaryLink\", \"click\", function () {\r\n                self.routingExecute($(this));\r\n            });\r\n\r\n            // jQuery-ui tabs\r\n            $(\"#ui-bizagi-details-tabs\", content).tabs({\r\n                active: -1,\r\n                create: function (event, ui) {\r\n                    $(this).tabs(\"option\", \"active\", 0);\r\n                },\r\n                activate: function (event, ui) {\r\n                    bizagi.util.setContext({\r\n                        commentsFocus: false\r\n                    });\r\n                    switch (ui.newPanel.prop('id')) {\r\n                        case \"comments\":\r\n                            if (cache[\"comments\"] == undefined) {\r\n                                // Extend render with comments\r\n                                $.extend(self, {}, bizagi.workportal.comments);\r\n\r\n                                // Define canvas\r\n                                data.canvas = $(\"#comments\", self.getComponentContainer(\"summary\"));\r\n                                data.readOnly = ($(ui.tab).data('isclosed')) ? true : false;\r\n\r\n                                $.when(self.renderComments(data))\r\n                                    .done(function (htmlContent) {\r\n                                        cache[\"comments\"] = htmlContent;\r\n                                    });\r\n                            }\r\n                            bizagi.util.setContext({\r\n                                commentsFocus: true\r\n                            });\r\n                            break;\r\n                        case \"subprocess\":\r\n                            if (cache[\"subprocess\"] == undefined) {\r\n                                $.when(\r\n                                        self.dataService.summarySubProcess({\r\n                                            idCase: self.params.idCase\r\n                                        })\r\n                                    ).done(function (subprocess) {\r\n\r\n                                        $.each(subprocess.subProcesses, function (key, value) {\r\n                                            var custData = subprocess.subProcesses[key].custData;\r\n                                            for (var i = 0; i < custData.length; i++) {\r\n                                                if (custData[i] == null) {\r\n                                                    custData[i] = \"\";\r\n                                                }\r\n                                            }\r\n                                        });\r\n\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateSubprocess, subprocess);\r\n                                        htmlContent.appendTo($(\"#subprocess\", self.getComponentContainer(\"summary\")));\r\n                                        cache[\"subprocess\"] = htmlContent;\r\n\r\n                                        // Define Events for subprocess tab\r\n                                        htmlContent.delegate(\".summaryLink\", \"click\", function () {\r\n                                            self.routingExecute($(this));\r\n                                        });\r\n                                    });\r\n                            }\r\n                            break;\r\n\r\n                        case \"assignees\":\r\n                            if (cache[\"assignees\"] == undefined) {\r\n                                $.when(\r\n                                        self.dataService.summaryAssigness({\r\n                                            idCase: self.params.idCase\r\n                                        })\r\n                                    ).done(function (assignees) {\r\n                                        // Generates  lists of unique assignees for Events\r\n                                        var eventsUniqueList = [];\r\n                                        $.each(assignees.events.split(\", \"), function (i, el) {\r\n                                            if ($.inArray(el, eventsUniqueList) === -1) eventsUniqueList.push(el);\r\n                                        });\r\n                                        assignees.events = eventsUniqueList.join(\", \");\r\n\r\n                                        // Generates  lists of unique assignees for activities\r\n                                        var activitiesUniqueList = [];\r\n                                        $.each(assignees.activities.split(\", \"), function (i, el) {\r\n                                            if ($.inArray(el, activitiesUniqueList) === -1) activitiesUniqueList.push(el);\r\n                                        });\r\n                                        assignees.activities = activitiesUniqueList.join(\", \");\r\n\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateAssigness, assignees);\r\n                                        htmlContent.appendTo($(\"#assignees\", self.getComponentContainer(\"summary\")));\r\n                                        cache[\"assignees\"] = htmlContent;\r\n                                    });\r\n                            }\r\n                            break;\r\n\r\n                        case \"events\":\r\n                            if (cache[\"events\"] == undefined) {\r\n                                $.when(\r\n                                        self.dataService.summaryCaseEvents({\r\n                                            idCase: self.params.idCase\r\n                                        })\r\n                                    ).done(function (events) {\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateEvents, events);\r\n                                        htmlContent.appendTo($(\"#events\", self.getComponentContainer(\"summary\")));\r\n                                        cache[\"events\"] = htmlContent;\r\n\r\n                                        htmlContent.delegate(\".summaryLink\", \"click\", function () {\r\n                                            self.routingExecute($(this));\r\n                                        });\r\n                                    });\r\n                            }\r\n                            break;\r\n\r\n                        case \"activities\":\r\n                            if (cache[\"activities\"] == undefined) {\r\n                                $.when(\r\n                                        self.dataService.summaryActivities({\r\n                                            data: data,\r\n                                            idWorkitem: self.params.idWorkitem\r\n                                        })\r\n                                    ).done(function (activities) {\r\n                                        activities[\"idCase\"] = self.params.idCase;\r\n                                        activities[\"idWorkflow\"] = self.params.idWorkflow;\r\n\r\n                                        //To solve QA-2124\r\n                                        var defaultDateFormat = bizagi.localization.getResource(\"dateFormat\");\r\n                                        var defaultTimeFormat = bizagi.localization.getResource(\"timeFormat\");\r\n                                        var fullFormat = defaultDateFormat + ' ' + defaultTimeFormat;\r\n\r\n                                        htmlContent = $.tmpl(self.caseSummaryTemplateActivities, activities);\r\n                                        bizagi.util.formatInvariantDate(htmlContent, fullFormat);\r\n                                        htmlContent.appendTo($(\"#activities\", self.getComponentContainer(\"summary\")));\r\n                                        cache[\"activities\"] = htmlContent;\r\n\r\n                                        htmlContent.delegate(\".summaryLink\", \"click\", function () {\r\n                                            self.routingExecute($(this));\r\n                                        });\r\n                                    });\r\n                            }\r\n                            break;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Renders the form component of the widget\r\n    */\r\n    renderForm: function (params) {\r\n        var self = this, resultRender;\r\n\r\n        var renderContainer = self.getComponentContainer(\"render\");\r\n        if (!params.withOutGlobalForm) {\r\n            // it has't activities and global form\r\n            var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n            var database = (typeof (self.dataService.database) != undefined) ? self.dataService.database : \"\";\r\n\r\n\r\n            // Load render page\r\n            var rendering = self.rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix, \"database\": database });\r\n            // Executes rendering into render container\r\n            resultRender = rendering.execute($.extend(params, {\r\n                canvas: renderContainer,\r\n                menu: self.menu\r\n            }));\r\n\r\n            // Attach handler to render container to subscribe for routing events\r\n            renderContainer.bind(\"routing\", function (context, triggerparams) {\r\n                // Executes routing action\r\n\r\n                var params = {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: self.params.idCase,\r\n                    fromTask: self.params.fromTask || self.params.idTask,\r\n                    fromWorkItemId: self.params.fromWorkItemId || self.params.idWorkitem,\r\n                    isOfflineForm: self.params.isOfflineForm,\r\n                    formsRenderVersion: self.params.formsRenderVersion,\r\n                    onClose: function () {\r\n                        // If the user closes the dialog we need to redirect to inbox widget\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: bizagi.workportal.currentInboxView\r\n                        });\r\n                    }\r\n                };\r\n                params = $.extend(params, triggerparams);\r\n                self.publish(\"executeAction\", params);\r\n            });\r\n\r\n            //\r\n            renderContainer.bind(\"oldrenderintegration\", function () {\r\n                if (bizagi.oldrenderevent == undefined) {\r\n                    bizagi.oldrenderevent = true; // has been loaded\r\n                    var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n                    var eventer = window[eventMethod];\r\n                    var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n\r\n                    // Listen to message from child window\r\n                    eventer(messageEvent, function (e) {\r\n                        e.stopPropagation();\r\n                        self.publish(\"executeAction\", {\r\n                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                            idCase: e.data\r\n                        });\r\n                    }, false);\r\n                }\r\n\r\n                self.publish(\"changeWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION,\r\n                    idCase: self.params.idCase,\r\n                    idWorkitem: self.params.idWorkitem,\r\n                    idTask: self.params.idTask,\r\n                    onlyUserWorkItems: self.params.onlyUserWorkItems,\r\n                    referrer: self.params.referrer,\r\n                    eventAsTasks: self.params.eventAsTasks\r\n                });\r\n\r\n            });\r\n        } else {\r\n            var errorTemplate = self.workportalFacade.getTemplate(\"info-message\");\r\n            var message = (params.messageForm !== \"\") ? params.messageForm : self.resources.getResource(\"render-without-globalform\");\r\n\r\n            if (typeof self.params != \"undefined\" && typeof self.params.isOfflineForm !== \"undefined\" && self.params.isOfflineForm == true) {\r\n                message = bizagi.util.getMessageFromNetworkState(self.dataService.online);\r\n            }\r\n\r\n            var errorHtml = $.tmpl(errorTemplate, {\r\n                message: message\r\n            });\r\n            // Remove loading icon from summary container\r\n            errorHtml.appendTo(renderContainer);\r\n\r\n            resultRender = $.Deferred();\r\n            resultRender.fail();\r\n        }\r\n\r\n        // Keep reference to rendering facade\r\n        self.renderingFacade = rendering;\r\n\r\n        // Resize layout\r\n        self.resizeLayout();\r\n\r\n        return resultRender;\r\n    },\r\n\r\n\r\n    routingExecute: function (element) {\r\n        // Executes routing action\r\n        if (element == undefined) {\r\n            return false;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        var idCase = element.find(\"#idCase\").val() || self.params.idCase;\r\n        var idWorkflow = element.find(\"#idWorkflow\").val() || self.params.idWorkflow;\r\n        var idWorkItem = element.find(\"#idWorkItem\").val() || element.parent().find(\"#idWorkItem\").val();\r\n        var idTask = element.find(\"#idTask\").val();\r\n        var eventAsTasks = element.find(\"#eventAsTasks\").val() || false;\r\n\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            idWorkflow: idWorkflow,\r\n            idWorkItem: idWorkItem,\r\n            idTask: idTask,\r\n            eventAsTasks: eventAsTasks\r\n        });\r\n\r\n        return true;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Dispose the rendering binds\r\n        setTimeout(function () {\r\n            if (self.rendering) {\r\n                var renderContainer = self.rendering.canvas;\r\n                renderContainer.off();\r\n                self.rendering.dispose();\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n","/*\r\n*   Name: Start Form Widget Controller\r\n*   Author: Fabian Moreno (based on Diego Parra version)\r\n*   Comments:\r\n*   -   This script will provide start form widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.startForm\", {}, {\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM;\r\n    },\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.idProcess = params.data.idProcess;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"startForm\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.startForm\").concat(\"#ui-bizagi-workportal-widget-start-form\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;    \r\n        var template = self.getTemplate(\"startForm\");\r\n\r\n        // Render base template\r\n        self.content = $.tmpl(template);\r\n\r\n        // Check if the content is already in dom\r\n        var includedInDom = self.content.parents(\"body\").length > 0;\r\n        if (includedInDom) {\r\n            self.renderForm();\r\n        } else {\r\n            // Wait until the dom is ready to execute the rendering, because some controls need references to full DOM\r\n            // (grids and uploads)\r\n            self.subscribeOneTime(\"onWidgetIncludedInDOM\", function () {\r\n\r\n                // Load render page\r\n                self.renderForm({\r\n                    idCase: self.params.idCase,\r\n                    idWorkitem: self.params.idWorkitem,\r\n                    idTask: self.params.idTask,\r\n                    withOutGlobalForm: self.params.withOutGlobalForm || false,\r\n                    isOfflineForm: self.params.isOfflineForm || false,\r\n                    messageForm: self.params.messageForm || \"\"\r\n                });\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /*\r\n    *   Renders the form component of the widget\r\n    */\r\n    renderForm: function (params) {\r\n        var self = this, resultRender;\r\n\r\n        var renderContainer = self.getComponentContainer(\"render\");\r\n        if (!params.withOutGlobalForm) {\r\n            // it has't activities and global form\r\n            var proxyPrefix = (typeof self.dataService.serviceLocator.proxyPrefix !== \"undefined\") ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n            var database = (typeof self.dataService.database !== \"undefined\") ? self.dataService.database : \"\";\r\n\r\n\r\n            // Load render page\r\n            var rendering = self.rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix, \"database\": database });\r\n            // Executes rendering into render container\r\n\r\n            params.action = \"LOADSTARTFORM\";\r\n            params.idProcess = self.idProcess;\r\n\r\n            resultRender = rendering.execute($.extend(params, {\r\n                canvas: renderContainer,\r\n                menu: self.menu\r\n            }));\r\n\r\n            // Attach handler to render container to subscribe for routing events\r\n            renderContainer.bind(\"routing\", function (context, triggerparams) {\r\n                //Close de startForm dialog and executes the routing action\r\n                self.publish(\"closeCurrentDialog\");\r\n\r\n                var params = {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: self.params.idCase || triggerparams.idCase,\r\n                    fromTask: self.params.fromTask || self.params.idTask,\r\n                    fromWorkItemId: self.params.fromWorkItemId || self.params.idWorkitem,\r\n                    isOfflineForm: self.params.isOfflineForm,\r\n                    formsRenderVersion: self.params.formsRenderVersion,\r\n                    onClose: function () {\r\n                        // If the user closes the dialog we need to redirect to inbox widget\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: bizagi.workportal.currentInboxView\r\n                        });\r\n                    }\r\n                };\r\n                params = $.extend(params, triggerparams);\r\n                self.publish(\"executeAction\", params);\r\n            });\r\n\r\n            //\r\n            renderContainer.bind(\"oldrenderintegration\", function () {\r\n                if (bizagi.oldrenderevent === undefined) {\r\n                    bizagi.oldrenderevent = true; // has been loaded\r\n                    var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n                    var eventer = window[eventMethod];\r\n                    var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n\r\n                    // Listen to message from child window\r\n                    eventer(messageEvent, function (e) {\r\n                        e.stopPropagation();\r\n                        self.publish(\"executeAction\", {\r\n                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                            idCase: e.data\r\n                        });\r\n                    }, false);\r\n                }\r\n\r\n                self.publish(\"changeWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION,\r\n                    idCase: self.params.idCase,\r\n                    idWorkitem: self.params.idWorkitem,\r\n                    idTask: self.params.idTask,\r\n                    onlyUserWorkItems: self.params.onlyUserWorkItems,\r\n                    referrer: self.params.referrer,\r\n                    eventAsTasks: self.params.eventAsTasks\r\n                });\r\n\r\n            });\r\n        } else {\r\n            var errorTemplate = self.workportalFacade.getTemplate(\"info-message\");\r\n            var message = (params.messageForm !== \"\") ? params.messageForm : self.resources.getResource(\"render-without-globalform\");\r\n\r\n            if (typeof self.params !== \"undefined\" && typeof self.params.isOfflineForm !== \"undefined\" && self.params.isOfflineForm === true) {\r\n                message = bizagi.util.getMessageFromNetworkState(self.dataService.online);\r\n            }\r\n\r\n            var errorHtml = $.tmpl(errorTemplate, {\r\n                message: message\r\n            });\r\n            // Remove loading icon from summary container\r\n            errorHtml.appendTo(renderContainer);\r\n\r\n            resultRender = $.Deferred();\r\n            resultRender.fail();\r\n        }\r\n\r\n        // Keep reference to rendering facade\r\n        self.renderingFacade = rendering;\r\n\r\n        // Resize layout\r\n        self.resizeLayout();\r\n\r\n        return resultRender;\r\n    },\r\n\r\n\r\n    routingExecute: function (element) {\r\n        // Executes routing action\r\n        if (element === undefined) {\r\n            return false;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        var idCase = element.find(\"#idCase\").val() || self.params.idCase;\r\n        var idWorkflow = element.find(\"#idWorkflow\").val() || self.params.idWorkflow;\r\n        var idWorkItem = element.find(\"#idWorkItem\").val() || element.parent().find(\"#idWorkItem\").val();\r\n        var idTask = element.find(\"#idTask\").val();\r\n        var eventAsTasks = element.find(\"#eventAsTasks\").val() || false;\r\n\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            idWorkflow: idWorkflow,\r\n            idWorkItem: idWorkItem,\r\n            idTask: idTask,\r\n            eventAsTasks: eventAsTasks\r\n        });\r\n\r\n        return true;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Dispose the rendering binds\r\n        if (self.rendering) {\r\n            var renderContainer = self.rendering.canvas;\r\n            renderContainer.off();\r\n\r\n            if(self.rendering.form){\r\n                self.rendering.form.dispose();\r\n            }\r\n\r\n            if (this.IsDisposed)\r\n                return;\r\n        }\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal my search search lists Widget Controller\r\n*   Author: Andrs Fernando Muoz\r\n*   Comments:\r\n*   -   This script will define a base class to to define the \"my search search lists\" widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.mySearchList\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mySearchListWrapper\");\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    }\r\n});","bizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.loadForm\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        this.workportalFacade = workportalFacade;\r\n        this.dataService = dataService;\r\n        this.params = params || {};\r\n        this.form;\r\n        this.searchCriteriasApplied = params.searchCriteriasApplied || [];\r\n    },\r\n\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_LOADFORM;\r\n    },\r\n\r\n    preProcessValue: function (value, control) {\r\n        if (control.properties.type == \"combo\" || control.properties.type == \"radio\"){\r\n            value = {\"id\": value[0]};       \r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.workportalFacade.getTemplate(\"loadForm\");\r\n\r\n        self.content = $.tmpl(template);\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var formClass = bizagi.rendering.desktop.form.extend({\r\n                createRenderElement: function (element) {\r\n                    var self = this;\r\n                    var properties = element.render.properties;\r\n\r\n                    if (properties.rangeQuery && properties.rangeQuery != \"none\") {\r\n                        properties.xpath = properties.xpath + \"@\" + properties.rangeQuery;\r\n                    }\r\n\r\n                    self._super(element);\r\n                }\r\n            });\r\n\r\n            var renderFacade = bizagi.rendering.facade.extend({\r\n                processForm: function (data, renderFactory, params) {\r\n                    var containerParams = $.extend(params, {\r\n                        renderFactory: renderFactory,\r\n                        dataService: params.dataService || this.dataService,\r\n                        data: data\r\n                    });\r\n                    var form =  new formClass(containerParams);\r\n\r\n                    //set default data\r\n                    if (self.searchCriteriasApplied.length > 0){\r\n                        $.each(self.searchCriteriasApplied, function (key, value) {\r\n                            var control = form.getRenderById(value.id);\r\n                            if (control) {\r\n                                control.setValue(self.preProcessValue(value.value, control));\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    // Render the full form\r\n                    form.render();\r\n\r\n                    return form;\r\n                }\r\n            });\r\n\r\n            var render = new renderFacade();\r\n\r\n            var queryFormParams = {\r\n                h_action: \"QUERYFORM\",\r\n                h_contexttype: \"entity\",\r\n                h_idForm: self.params.guidForm,\r\n                dataType: \"text\"\r\n            };\r\n\r\n\r\n            //request to queryForm definition service\r\n            self.dataService.getQueryForm(queryFormParams).done(function (data) {\r\n                //convert the form json\r\n                var regexTypeString = /\\\"type\\\"\\s*:\\s*\\\"([':.,-\\[\\]\\w\\s]*)\\\"/g;\r\n                var regexIncludedInResultString = /\\\"includedInResult\\\"\\s*:\\s*(true)/g;\r\n\r\n                var processedForm = data.replace(regexTypeString, function (match, g1, offset, string) {\r\n                    return match.replace(g1, g1.replace(/query/i, \"\").toLowerCase());\r\n                });\r\n                processedForm = processedForm.replace(regexIncludedInResultString, '\"includedInResult\":false');\r\n\r\n                var form = JSON.parse(processedForm);\r\n                form.form.buttons = [];\r\n\r\n                // For searches of Rubik the \"metadata\" field is required\r\n                form.form.contextType = form.form.contextType || \"metadata\";\r\n\r\n                var renderingParams = { canvas: $(self.content), data: form };\r\n\r\n                render.execute(renderingParams).done(function (form) {\r\n                    self.form = form;\r\n                });\r\n\r\n                return self.content;\r\n            });\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Workportal New Case Widget Controller\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define a base class to to define the sub menu widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.subMenu\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function(){  \r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.workportalFacade.getTemplate(\"menu.submenu\");\r\n        var content = self.content = $.tmpl(template);\r\n        \r\n        return content;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Search Controller\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   Base library for search cases\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.search\", {}, {\r\n    /*\r\n     *   Returns the widget name\r\n     */\r\n    getWidgetName: function() {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH;\r\n    },\r\n    /*\r\n     *   Renders the content for the current controller\r\n     *   Returns a deferred because it has to load the current user\r\n     */\r\n    renderContent: function() {\r\n        var self = this;\r\n        var template = self.workportalFacade.getTemplate(\"search\");\r\n\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    },\r\n    routingExecute: function(element) {\r\n        // Executes routing action\r\n        if (element == undefined) {\r\n            return false;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        var idCase = element.find(\"#idCase\").val();\r\n        var idWorkItem = element.find(\"#idWorkItem\").val();\r\n        var idTask = element.find(\"#idTask\").val();\r\n        var eventAsTasks = element.find(\"#eventAsTasks\").val() || false;\r\n\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            idWorkItem: idWorkItem,\r\n            idTask: idTask,\r\n            eventAsTasks: eventAsTasks\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Generic Page Widget Implementation\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*/\r\n\r\n\r\n// Extends itself\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.page\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE;\r\n    },\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"page\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.page\").concat(\"#ui-bizagi-workportal-widget-page\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n\r\n        var template = self.getTemplate(\"page\");\r\n        var content = self.content = $.tmpl(template, {});\r\n\r\n        self.renderStaticForm(self.params);\r\n\r\n        // Return content\r\n        return content;\r\n    },\r\n\r\n    renderStaticForm: function (params) {\r\n        var self = this;\r\n        var canvas = self.getComponentContainer(\"render\");\r\n        var rendering = new bizagi.rendering.facade(params.context);\r\n\r\n        // Executes rendering into render container\r\n        params = params || {};\r\n    \t$.extend(params, {\r\n    \t    canvas: canvas \r\n    \t    });\r\n        \r\n        rendering.execute(params);\r\n\r\n        canvas.bind(\"close\", function () {\r\n            self.publish(\"closeCurrentDialog\");            \r\n        });\r\n    }\r\n});\r\n","\r\n/*\r\n *   Name: BizAgi Workportal Render Widget Controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to to define the render widget\r\n *       the rendering module is loaded here\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.renderform\", {}, {\r\n\r\n    /*\r\n     *   Returns the widget name\r\n     */\r\n    getWidgetName: function(){  \r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER_FORM;\r\n    },\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n    \t\r\n        // Check if the required params are filled\r\n        if (bizagi.util.isEmpty(params.idForm)) {\r\n        \r\n            if(!bizagi.util.isEmpty(window.location.hash)){\r\n                // Check in the hash\r\n                var hashParams = bizagi.util.getHashParams();\r\n        \t\t\r\n                // Set the first hash param as the idCase\r\n                if (hashParams.length > 1) {\r\n                    params.idCase = hashParams[1];\r\n                    self.isConfiguredFromHash = true;\r\n                }\r\n        \t\t\r\n                // Set the second hash param as the idWorkitem\r\n                if (hashParams.length > 2) {\r\n                    params.idWorkitem = hashParams[2];\r\n                }\r\n            } else if(!bizagi.util.isEmpty(window.location.search)){\r\n                var queryString = bizagi.util.getQueryString();\r\n                \r\n                // Set idCase param from query string\r\n                if (queryString[\"idEntity\"]){\r\n                    params.idEntity = queryString[\"idEntity\"];\r\n                    self.isConfiguredFromHash = true;\r\n                }\r\n                \r\n                // Set idWorkitem param from query string\r\n                if (queryString[\"surrogateKey\"]){\r\n                    params.surrogateKey = queryString[\"surrogateKey\"];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n    },\r\n\r\n    /*\r\n     *   Renders the content for the current controller\r\n     *   Returns a deferred because it has to load the current user\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"renderform\");\r\n        var summaryDeferred = new $.Deferred(); \r\n    \t\r\n        // Check if the required params are filled\r\n        if (bizagi.util.isEmpty(self.params.idForm)) {\r\n            self.changeWidget(bizagi.workportal.currentInboxView);\r\n            return null;\r\n        }\r\n    \t\r\n        // Render base template\r\n        self.content = $.tmpl(template);\r\n    \r\n        // Check if the content is already in dom\r\n        var includedInDom = self.content.parents(\"body\").length > 0;\r\n        if (includedInDom) {\r\n            self.renderForm();\r\n        } else {\r\n            // Wait until the dom is ready to execute the rendering, because some controls need references to full DOM\r\n            // (grids and uploads)\r\n            self.subscribeOneTime(\"onWidgetIncludedInDOM\", function() {\r\n            \t\r\n                // Load render page\r\n                self.renderForm({\r\n                    idEntity: self.params.idEntity,\r\n                    surrogateKey: self.params.surrogateKey\r\n                });\r\n            });\r\n        }\r\n    },\r\n    \r\n    /*\r\n     *   Renders the form component of the widget\r\n     */\r\n    renderForm: function(params){\r\n        var self = this;\r\n        \r\n        \r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n        // Load render page\r\n        var rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n        var renderContainer = self.getComponentContainer(\"render\");\r\n    \r\n        // Executes rendering into render container\r\n        rendering.execute($.extend(params, {\r\n            canvas: renderContainer\t\r\n        }));\r\n    \r\n        // Attach handler to render container to subscribe for routing events\r\n        renderContainer.bind(\"routing\", function(){\r\n            // Executes routing action\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: self.params.idCase,\r\n                onClose: function () {\r\n                    // If the user closes the dialog we need to redirect to inbox widget\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName : bizagi.workportal.currentInboxView\r\n                    }); \r\n                }\r\n            });\r\n        });\r\n    \t\r\n        // Keep reference to rendering facade\r\n        self.renderingFacade = rendering;\r\n    \r\n        // Resize layout\r\n        self.resizeLayout();\r\n    }  \r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Queries Dialog implementation\r\n*   Author: Juan Pablo Crossley\r\n*   Comments:\r\n*   -   ???\r\n*/\r\n\r\n\r\n// Extends itself\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.genericiframe\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function(){  \r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME;\r\n    },\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"genericiframe\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.genericiframe\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        \r\n        var template = self.getTemplate(\"genericiframe\");\r\n        var data = {\r\n            widgetURL: self.params.widgetURL\r\n        };\r\n        var content = self.content = $.tmpl(template, data);\r\n        \r\n        // Return content\r\n        return content;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Integration old render within new look and feel\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script define base controller to integrate old render within new workportal\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.oldrenderintegration\", {}, {\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function(){\r\n\treturn bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n\tvar self = this;\r\n\tvar template = self.getTemplate(\"integration-old-render\");\r\n\r\n\tvar data = {};\r\n\tdata.url = self.params.url || \"App/ListaDetalle/Detalle.aspx?PostBack=1&idCase=\"+ self.params.idCase +\"&idWorkitem=\"+ self.params.idWorkitem +\"&idTask=\"+self.params.idTask;\r\n\r\n\t// Render content\r\n\tvar content = self.content = $.tmpl(template,data);\r\n\r\n\t// Set inbox view variable\r\n\tbizagi.workportal.currentInboxView = self.getWidgetName();\r\n\r\n\treturn content;\r\n    }\r\n});\r\n","\r\n/*\r\n *   Name: BizAgi Workportal Fontsize Controller\r\n *   Author: Jair Cardenas\r\n *   Comments:\r\n *   -\tThis script will provide base library for fontsize\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.fontsize.extend(\"bizagi.workportal.widgets.fontsize\", {}, {\r\n\r\n\t/*\r\n\t *\t Constructor\r\n\t */\r\n\tinit: function(workportalFacade, dataService, params) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Call base\r\n\t\tthis._super(workportalFacade, dataService, params);\r\n\r\n\t    //Load templates\r\n\t\tself.loadTemplates({\r\n\t\t    \"fontsize\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.fontsize\"),\r\n\t\t    useNewEngine: false\r\n\t\t});\r\n\t},\r\n\t/*\r\n\t *\t To be overriden in each device to apply layouts\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar sizeSelected = $('body').data('sizeselected') || 'font-large';\r\n\r\n\t    // Set templates\r\n\t\tself.fontsizeTemplate = self.getTemplate(\"fontsize\");\r\n\r\n\t\t// Set focus\r\n\t\t$('.ui-bizagi-wp-font-content a', content).removeClass('active');\r\n\t\t$('.ui-bizagi-wp-font-content .' + sizeSelected + ' a', content).addClass('active');\r\n\r\n\t\tvar fontButton = $('.font-switcher', content);\r\n\t\t$(fontButton).click(function() {\r\n\t\t\tvar textSize = $(this).parent().attr('class');\r\n\t\t\t$('body').data('sizeselected', textSize);\r\n\t\t\t$('.ui-bizagi-wp-font-content a', content).removeClass('active');\r\n\t\t\t$('.ui-bizagi-wp-font-content .' + textSize + ' a', content).addClass('active');\r\n\r\n\t\t\t$('html, body').removeClass('font-medium font-large font-x-large').addClass(textSize);\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t}\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Desktop Main Controller\r\n*   Author: Diego Parra (based on  Edward Morales version)\r\n*   Comments:\r\n*   -   This script will override main controller class to apply custom stuff just for desktop device\r\n*/\r\n\r\n// Auto extend\r\nbizagi.workportal.controllers.main.extend(\"bizagi.workportal.controllers.main\", {}, {\r\n\r\n\t/*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService) {\r\n    \tvar self = this;\r\n\r\n    \t// Call base\r\n    \tself._super(workportalFacade, dataService);\r\n\r\n    \t// Subscribe to show old window event\r\n        this.subscribe(\"showOldWindow\", function(e, params){\r\n            self.showOldWindow(params);\r\n        });\r\n\r\n        // Instantiate the sessionTimeOut Service\r\n        bizagi.injector.get('sessionTimeOutService');\r\n        self.loadTemplates({\r\n            \"session-timeout\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.sessionTimeout\").concat(\"#session-timeout\")\r\n        });\r\n        self.loadTemplates({\r\n            \"session-timeout-expired\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.sessionTimeoutExpired\").concat(\"#session-timeout-expired\")\r\n        });\r\n        $().dialog();\r\n    },\r\n\r\n\t /*\r\n    *   Renders the content for the current controller\r\n    *\r\n    */\r\n    renderContent: function () {\r\n    \tvar self = this;\r\n\r\n        // Check navigator compatibility\r\n    \tif (bizagi.util.isIE()) {\r\n    \t    var version = bizagi.util.getIEVersion();\r\n    \t\tif (version < 9) {\r\n    \t\t\treturn self.renderIENotCompatibleTemplate();\r\n    \t\t}\r\n    \t}\r\n\r\n        return self._super();\r\n    },\r\n\r\n\t/*\r\n\t*   Render not compatible template\r\n\t*/\r\n\trenderIENotCompatibleTemplate: function () {\r\n\t    var self = this;\r\n        var template = self.workportalFacade.getTemplate(\"workportal.notCompatibleIE\");\r\n\r\n        // Render content\r\n        var content = self.content = $.tmpl(template, { url : BIZAGI_PATH_TO_BASE + \"defaulthtml.aspx\"});\r\n\r\n\t\t// Set resize layout event\r\n        $(window).resize(function() {\r\n            self.resizeLayout();\r\n        });\r\n\r\n\t\treturn content;\r\n\t},\r\n\r\n    /*\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function(){\r\n        // TODO: Apply logic here\r\n    },\r\n\r\n    /*\r\n     *   Add dialog to dialogStack\r\n     */\r\n    addDialogToDialogStack: function(dialog){\r\n        var self = this;\r\n        // Add to stack\r\n        bizagi.workportal.desktop.dialogStack = bizagi.workportal.desktop.dialogStack || [];\r\n        bizagi.workportal.desktop.dialogStack.push(dialog);\r\n    },\r\n\r\n    /*\r\n    *   Shows a widget inside a modal dialog\r\n    *   Implement on each device\r\n    */\r\n    showDialogWidget: function(data){\r\n        var self = this;\r\n        var dialog = new bizagi.workportal.desktop.widgets.dialog(self.dataService, self.workportalFacade);\r\n        dialog.renderWidget(data);\r\n\r\n        self.addDialogToDialogStack(dialog);\r\n\r\n        return dialog;\r\n    },\r\n\r\n    /*\r\n    *   Close the current modal dialog\r\n    *   Implement on each device\r\n    */\r\n    closeCurrentDialog: function(params){\r\n        // Remove from\r\n        bizagi.workportal.desktop.dialogStack = bizagi.workportal.desktop.dialogStack || [];\r\n        if (bizagi.workportal.desktop.dialogStack.length > 0){\r\n            var dialog = bizagi.workportal.desktop.dialogStack.pop();\r\n            try {\r\n                dialog.close();\r\n            } catch(e) {\r\n                //\r\n            }\r\n        }\r\n\r\n    \t// Close a quirks mode popup if opened\r\n    \tbizagi.closeQuirksModePopup();\r\n    },\r\n\r\n    /**\r\n     *   Close all modal dialogs\r\n     *   Implement on each device\r\n     */\r\n    closeAllDialogs: function(){\r\n        bizagi.workportal.desktop.dialogStack = bizagi.workportal.desktop.dialogStack || [];\r\n        if (bizagi.workportal.desktop.dialogStack.length > 0){\r\n            for(iDialog = 0, iTotalDialog = bizagi.workportal.desktop.dialogStack.length; iDialog < iTotalDialog; iDialog++){\r\n                var dialog = bizagi.workportal.desktop.dialogStack.pop();\r\n                try {\r\n                    dialog.close();\r\n                } catch(e) {\r\n                    //\r\n                }\r\n            }\r\n        } \r\n        $(\".ui-dialog-content\").dialog(\"close\"); //Close the dialogs that were created with jquery UI and couldn't be closed with dialog.close()\r\n    },\r\n\r\n    /*\r\n    *   Popup a widget\r\n    *   Implement on each device\r\n    */\r\n    popupWidget: function(params){\r\n        var self = this;\r\n        var popup = new bizagi.workportal.desktop.widgets.popup(self.dataService, self.workportalFacade, params.options);\r\n        popup.renderWidget(params);\r\n\r\n        // Attach closed handler if present\r\n        if (params.options && params.options.closed){\r\n            $.when(popup.closed())\r\n            .done(function(){\r\n                // Executes callback\r\n                params.options.closed();\r\n            });\r\n        }\r\n    },\r\n\r\n\t/*\r\n\t*   Shows an url inside a window popup\r\n\t*/\r\n\tshowOldWindow: function (params) {\r\n\t\t// Call bizagi internal function\r\n\t\tvar url = bizagi.util.extendQueryString(params.url, {referrer : \"workportal\" });\r\n\t\tbizagi.showQuirksModePopup(url, params.windowParameters);\r\n    },\r\n\r\n\tcleanWidgets: function () {\r\n\r\n\t    this.workarea.cleanWidgets();\r\n\r\n\t    if (bizagi.workportal.desktop.popup) {\r\n            if(bizagi.workportal.desktop.popup.instance) {\r\n                if(bizagi.workportal.desktop.popup.instance.dontClose !== undefined) {\r\n                    bizagi.workportal.desktop.popup.instance.dontClose = false;\r\n                    bizagi.workportal.desktop.popup.instance.close();\r\n                }\r\n            } else {\r\n                var innerDialog = $(\".modal .complex-frame\");\r\n                if(innerDialog.length > 0) {\r\n                    innerDialog.closest(\".modal\").remove();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    refreshQueryFormShortCut : function(){\r\n        if(bizagi.workportal.widgets.queries.shortcut.instance)\r\n            bizagi.workportal.widgets.queries.shortcut.instance.renderStoredQueries();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Desktop Menu Controller\r\n *   Author: Diego Parra (based on  Edward Morales version)\r\n *   Comments:\r\n *   -   This script will override menu controller class to apply custom stuff just for desktop device\r\n */\r\n\r\n\r\nbizagi.workportal.controllers.menu.extend(\"bizagi.workportal.controllers.menu\", {}, {\r\n\r\n\t/**\r\n\t *\r\n\t * @return {*}\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar defer = new $.Deferred();\r\n\t\tvar content = self.getContent();\r\n\t\tvar searchContent = $(\"#ui-bizagi-wp-widget-searchContainer\", content);\r\n\t\tvar iconsTemplate = self.workportalFacade.getTemplate(\"menu.security\");\r\n\t\tvar menuContent = $(\"#main_menu\", content); \r\n\r\n\r\n\t\t/**\r\n\t\t * Define security fo actual stakeholder\r\n\t\t * @type {bizagi.workportal.controllers.menu.security}\r\n\t\t */\r\n\r\n\t\tvar sec = bizagi.menuSecurity;\r\n\r\n\t\t\t/**\r\n\t\t\t * Draw menu with allowed sections\r\n\t\t\t */\r\n\t\t\t$.tmpl(iconsTemplate, sec,{\r\n\t\t\t\t\treportsSecurity: function() {\r\n\t\t\t\t\t\treturn (sec.AnalysisReports);\r\n\t\t\t\t\t}\r\n\t\t\t\t}).appendTo(menuContent);\r\n\r\n\t\t\t/**\r\n\t\t\t * Set highlight item menu\r\n\t\t\t */\r\n\t\t\tswitch(self.workportalFacade.workportal.getWidgetByDataUser()){\r\n\t\t\t\tcase bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:\r\n\t\t\t\t\t$(\"#menuListHome\", menuContent).addClass(\"activeMenu\").siblings().removeClass(\"activeMenu\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:\r\n\t\t\t\tcase bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX:\r\n\t\t\t\t\t$('#menuListInbox', menuContent).addClass(\"activeMenu\").siblings().removeClass(\"activeMenu\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t// Fix logout button\r\n\t\t\tif(!sec.LogOut) {\r\n\t\t\t\t//Hide it\r\n\t\t\t\t$(\"#logout\", content).hide();\r\n\t\t\t}\r\n\t\t\t//Prevent event beforeunload to be trigger by clicking the menu\r\n\t\t\t$(\"#main_menu a\", content).click(function(event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t});\r\n\r\n\t\t\t// Fix search field\r\n\t\t\tif(!sec.Search) {\r\n\t\t\t\t$(\"#ui-bizagi-wp-widget-searchContainer\", content).remove();\r\n\t\t\t}\r\n\r\n\t\t\t$(\"#main_menu li\", content).on(\"click\", self.setActiveSection);\r\n\r\n\t\t\t//To add the style to know the item is selected after go to inbox from decontextualized plan\r\n\t\t\tself.subscribe(\"changeWidget\", function(){\r\n\t\t\t\tif(arguments[1].widgetName === self.workportalFacade.workportal.getWidgetByCookie(true)){\r\n\t\t\t\t\tself.setActiveSection.apply($(\"#main_menu li#menuListInbox\")[0]);\r\n\t\t\t\t}\t\r\n\t\t\t});\r\n\r\n\t\t\tif (!sec.Inbox) {\r\n\t\t\t    $(\"#menuListInbox\", content).hide();\r\n\t\t\t}\r\n\r\n\t\t\t// Bind Widgets button\r\n\t\t\t$(\"#main_menu li#menuListWidget\", content).click(function() {\r\n\t\t\t\tself.showWidgetsPopup();\r\n\t\t\t});\r\n\r\n\t\t\t// Bind New Case button\r\n\t\t\t$(\"#main_menu li#menuListNew\", content).click(function () {\r\n\t\t\t    bizagi.loader.start(\"newcase\").then(function () {\r\n\t\t\t        self.showNewCasePopup();\r\n\t\t\t    });\r\n\t\t\t});\r\n\r\n            // Bind my Search\r\n            if (bizagi.util.parseBoolean(bizagi.override.enableMySearch) &&\r\n\t\t\t\tbizagi.currentUser.associatedStakeholders && bizagi.currentUser.associatedStakeholders.length > 0){\r\n                $(\"#ui-bizagi-wp-widget-searchContainer\", content).click(function () {\r\n                    self.showMySearchPopup();\r\n                });\r\n            }\r\n\r\n\t\t\t$(\"#main_menu li#menuListHome\", content).click(function() {\r\n\t\t\t    var home = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;\r\n                \r\n\t\t\t\tself.publish(\"changeWidget\", {\r\n\t\t\t\t\twidgetName: home\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t//  Bind inbox button\r\n\t\t\t$(\"#main_menu li#menuListInbox\", content).click(function() {\r\n                var inbox = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX;\r\n                var grid = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID;\r\n                var homeportal = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;\r\n\t\t\t\tvar actualWidget;\r\n                var storeWidget;\r\n\t\t\t\tif($.isFunction(bizagi.cookie) && (bizagi.cookie(\"bizagiDefaultWidget\") !== homeportal)){\r\n\t\t\t\t\tstoreWidget = bizagi.cookie(\"bizagiDefaultWidget\");\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tstoreWidget = grid;\r\n\t\t\t\t}\r\n\r\n                bizagi.loader.start(\"inbox\").then(function () {\r\n                    switch (storeWidget) {\r\n                        case inbox:\r\n                            actualWidget = inbox;\r\n                            break;\r\n                        case grid:\r\n                            actualWidget = grid;\r\n\t\t\t\t\t\t    break;\r\n                        case homeportal:\r\n                            actualWidget = homeportal;\r\n                            break;\r\n\t\t\t\t\t    default:\r\n                            actualWidget = grid;\r\n\t\t\t\t\t\t    break;\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t\t/*Coment code by QAF-2108*/\r\n\t\t\t\t\t/* THEMES ANGULAR\r\n                    var templateService = new bizagi.workportal.services.loadtemplates();\r\n                    $.when(templateService.loadTemplates({\r\n                        \"homeportal\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.homeportal\").concat(\"#homeportal-frame\"),\r\n                        useNewEngine: true\r\n                    })).done(function () {\r\n                        var template = templateService.getTemplate(\"homeportal\");\r\n                        var content = template.render({});\r\n                        $(content).attr(\"data-bizagi-component\", \"workarea\")\r\n                        $workarea = $(\"#ui-bizagi-wp-workarea\");\r\n                        $workarea.remove(\"#ui-bizagi-wp-project-homeportal-main\");\r\n                        $workarea.append(content);\r\n                        $workarea.find(\"#ui-bizagi-wp-project-homeportal-main\").show();\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: actualWidget\r\n                        });\r\n                    });\r\n                    */\r\n\t\t\t\t\tself.publish(\"changeWidget\", {\r\n\t\t\t\t\t\twidgetName: actualWidget\r\n\t\t\t\t\t});\r\n\r\n                });\r\n\t\t\t\tself.resetNavigatorInfo();\r\n\t\t\t});\r\n\r\n\t\t\t// Bind New Case button\r\n\t\t\t$(\"#main_menu li#menuListQueries\", content).click(function() {\r\n\t\t\t\tself.showQueriesPopup();\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#tempEntities\", content).click(function() {\r\n\t\t\t\tself.publish(\"showDialogWidget\", {\r\n\t\t\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES,\r\n\t\t\t\t\tmodalParameters: {\r\n\t\t\t\t\t\ttitle: self.getResource(\"workportal-menu-preferences\"),\r\n\t\t\t\t\t\twidth: \"1020px\",\r\n\t\t\t\t\t\tshowCloseButton: false\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t// Bind admin menu\r\n\t\t\t$(\"#menuListAdmin\", content).click(function() {\r\n\t\t\t\tself.renderAdminMenu();\r\n\t\t\t});\r\n\r\n            $(\"#menuListQuickProcess\", content).click(function() {\r\n                self.renderQuickProcessMenu();\r\n            });\r\n\r\n\t\t\t$(\"#menuListReports\", content).click(function() {\r\n\r\n\t\t\t\tself.renderReportsMenu();\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#menuUserPrivacy\", content).click(function() {\r\n\t\t\t\tself.publish(\"showDialogWidget\", {\r\n\t\t\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USER_PRIVACY,\r\n\t\t\t\t\tcloseVisible: false,\r\n\t\t\t\t\tmaximize: false,\r\n\t\t\t\t\tmodalParameters: {\r\n\t\t\t\t\t\ttitle: self.getResource(\"workportal-project-discussion-privacy\"), \r\n\t\t\t\t\t\twidth: 600,\r\n\t\t\t\t\t\theight: \"auto\"\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#menuListPreferences\", content).click(function() {\r\n\t\t\t\tvar url = self.dataService.getUrl({\r\n\t\t\t\t\t\"endPoint\": \"ListPreferences\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar widgetName = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES;\r\n\t\t\t\tbizagi.loader.start(\"admin\").then(function () {\r\n\t\t\t\t    self.publish(\"showDialogWidget\", {\r\n\t\t\t\t\t    widgetName: widgetName,\r\n\t\t\t\t\t    widgetURL: url,\r\n\t\t\t\t\t    closeVisible: false,\r\n\t\t\t\t\t    maximize: true,\r\n\t\t\t\t\t    modalParameters: {\r\n\t\t\t\t\t\t    title: self.getResource(\"workportal-menu-preferences\"),\r\n                            width: 600,\r\n\t\t\t\t\t\t    height: 710\r\n\t\t\t\t\t    }\r\n\t\t\t\t    });\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t$(\"#displayOptions\",content).click(function(){\r\n\r\n\t\t\t\tvar widgetName = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DISPLAY_OPTIONS;\r\n\t\t\t\tbizagi.loader.start(\"admin\").then(function () {\r\n\t\t\t\t\tself.publish(\"showDialogWidget\", {\r\n\t\t\t\t\t\twidgetName: widgetName,\r\n\t\t\t\t\t\tcloseVisible: false,\r\n\t\t\t\t\t\tmaximize: false,\r\n\t\t\t\t\t\tmodalParameters: {\r\n\t\t\t\t\t\t\ttitle: self.getResource(\"workportal-menu-display-options\"),\r\n\t\t\t\t\t\t\twidth: 600,\r\n\t\t\t\t\t\t\theight: 280\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t$(\"#user\", content).click(function() {\r\n\t\t\t\tself.showUserProfileMenu();\r\n\t\t\t});\r\n\t\t\t$(\"#qr\", content).click(function () {\r\n\t\t\t    self.showQRCodePopup();\r\n\t\t\t});\r\n\t\t\tdefer.resolve(content);\r\n\r\n\r\n\t\t// Bind Search field\r\n\t\tvar inputSearchField = $(\"#menuQuery\", searchContent);\r\n\r\n\t\t// Bind Font Size\r\n\t\t$(\".ui-bizagi-wp-bt-font\", content).click(function() {\r\n\t\t\tself.renderFontMenu();\r\n\t\t});\r\n\r\n        //TODO: Remove this variable, It is used for mocking the service\r\n\t\twindow.CURRENT_THEME_REMOVE_IT = \"theme1\";\r\n\t\t$(\".ui-bizagi-wp-bt-classic-theme,.ui-bizagi-wp-bt-modern-theme,.ui-bizagi-wp-bt-booking-theme\", content).hide();\r\n\r\n\t\t$(\".ui-bizagi-wp-bt-classic-theme\", content).click(function () {\r\n\t\t    $(\"body\").append(\"<div id='workportal-theme-layer' ></div>\");\r\n\t\t    $(\"#workportal-theme-layer\").addClass(\"workportal-theme-layer-visible\");\r\n\r\n\t\t    //change to classic theme\r\n\t\t    window.CURRENT_THEME_REMOVE_IT = \"theme1\";\r\n\r\n\t\t    var home = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;\r\n\r\n\t\t    self.publish(\"changeWidget\", {\r\n\t\t        widgetName: home\r\n\t\t    });\r\n\r\n\t\t    $(\".ui-bizagi-wp-bt-modern-theme\").show();\r\n\t\t    $(\".ui-bizagi-wp-bt-booking-theme\").show();\r\n\t\t    $(\".ui-bizagi-wp-bt-classic-theme\").hide();\r\n\t\t    $(\"#user-profile\").hide(\"fast\");\r\n\t\t});\r\n\r\n\t\t$(\".ui-bizagi-wp-bt-modern-theme\", content).click(function () {\r\n\t\t    $(\"body\").append(\"<div id='workportal-theme-layer' ></div>\");\r\n\t\t    $(\"#workportal-theme-layer\").addClass(\"workportal-theme-layer-visible\");\r\n\r\n\t\t    //change to modern theme\r\n\t\t    window.CURRENT_THEME_REMOVE_IT = \"theme2\";\r\n\r\n\t\t    var home = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;\r\n\r\n\t\t    self.publish(\"changeWidget\", {\r\n\t\t        widgetName: home\r\n\t\t    });\r\n\r\n\t\t    $(\".ui-bizagi-wp-bt-modern-theme\").hide();\r\n\t\t    $(\".ui-bizagi-wp-bt-classic-theme\").show();\r\n\t\t    $(\".ui-bizagi-wp-bt-booking-theme\").show();\r\n\t\t    $(\"#user-profile\").hide(\"fast\");\r\n\t\t});\r\n\r\n\t\t$(\".ui-bizagi-wp-bt-booking-theme\", content).click(function () {\r\n\t\t    $(\"body\").append(\"<div id='workportal-theme-layer' ></div>\");\r\n\t\t    $(\"#workportal-theme-layer\").addClass(\"workportal-theme-layer-visible\");\r\n\r\n\t\t    //change to booking theme\r\n\t\t    window.CURRENT_THEME_REMOVE_IT = \"theme3\";\r\n\r\n\t\t    var home = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;\r\n\r\n\t\t    self.publish(\"changeWidget\", {\r\n\t\t        widgetName: home\r\n\t\t    });\r\n\r\n\t\t    $(\".ui-bizagi-wp-bt-booking-theme\").hide();\r\n\t\t    $(\".ui-bizagi-wp-bt-classic-theme\").show();\r\n\t\t    $(\".ui-bizagi-wp-bt-modern-theme\").show();\r\n\t\t    $(\"#user-profile\").hide(\"fast\");\r\n\t\t});\r\n\r\n\t\t$(\"#logout\", content).click(function() {\r\n\r\n\t\t\t$.when(bizagi.util.autoSave()).done(function() {\r\n\t\t\t\t$(document).data('auto-save', '');\r\n\t\t\t\tself.dataService.logout();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t$(\"#about\", content).click(function() {\r\n\t\t\tself.showAboutPopup();\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Binding for search field\r\n\t\t */\r\n\t\t$(inputSearchField).bind('keypress', function(e) {\r\n\t\t\tif(e.keyCode == 13) {\r\n\t\t\t\t$.when(bizagi.util.autoSave()).done(function () {\r\n\t\t\t\t\t$(document).data('auto-save', '');\r\n\t\t\t\t\tvar searchValue = inputSearchField.val();\r\n\t\t\t\t\tif( searchValue != \"\" && searchValue != self.getResource(\"workportal-menu-search\")) {\r\n\t\t\t\t\t\tself.publish(\"executeAction\", {\r\n\t\t\t\t\t\t\taction: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,\r\n\t\t\t\t\t\t\tradNumber: inputSearchField.val(),\r\n\t\t\t\t\t\t\tonlyUserWorkItems: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.resetNavigatorInfo();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(window).trigger(\"resize\");\r\n\r\n\t\treturn defer.promise();\r\n\t},\r\n\r\n\tresetNavigatorInfo: function () {\r\n\t\tbizagi.util.emptyNavigatorInfo();\r\n\t},\r\n\r\n\t/**\r\n\t *\tHighligth for active menu\r\n\t */\r\n\tsetActiveSection: function() {\r\n\t\tvar self = this;\r\n\r\n\t\t$(self).parent().find('li').removeClass('activeMenu');\r\n\t\t$(self).addClass('activeMenu');\r\n\t},\r\n\r\n\t/**\r\n\t * Show User profile menu\r\n\t */\r\n\tshowUserProfileMenu: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar $userProfile = $(\"div#user-profile\", content);\r\n\r\n\t\t$userProfile.show(\"fast\", function() {\r\n\t\t\t$userProfile.click(function(e) {\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(document).on(\"click\", function (e) {\r\n\r\n\t\t    if (!$(e.target).is(\"#user-profile\") && $(e.target).closest(\"#user\").length === 0) {\r\n\t\t        $userProfile.hide(\"fast\");\r\n\t\t    }\r\n\r\n\t\t    e.stopPropagation();\r\n\t\t});\r\n\t},\r\n    /*\r\n    * Show QR mobile authentication popup\r\n    */\r\n\tshowQRCodePopup: function () {\r\n\t    var self = this;\r\n\t    var url = this.dataService.serviceLocator.getUrl(\"login-qr-image64\");\r\n\r\n\t    $.ajax({\r\n\t        url: url,\r\n\t        success: function (data) {\r\n\t            var template = self.workportalFacade.getTemplate(\"menu.modal.qr\");\r\n\t            var popupContent = $.tmpl(template, {\r\n\t            });\r\n\t            $(popupContent).find(\"#QRCode\").attr(\"src\", \"data:image/png;base64,\" + data);\r\n\t            $(popupContent).dialog({\r\n\t                width: 590,\r\n\t                modal: true,\r\n\t                title: null,\r\n\t                dialogClass: \"qr-dialog\",\r\n\t                allowmaximize: false,\r\n\t                maximized: false,\r\n\t                resizable: false,\r\n\t                draggable: false\r\n\t            });\r\n\t        }\r\n\t    });\r\n\t},\r\n\t/**\r\n\t * Creates a generic menu popup\r\n\t * @param options\r\n\t */\r\n\tshowMenuPopup: function(options) {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar popup = new bizagi.workportal.desktop.popup(self.dataService, self.workportalFacade, {\r\n\t\t\tsourceElement: options.buttonSelector,\r\n\t\t\tmy: options.my || \"center top\",\r\n\t\t\tat: options.at || \"center bottom\",\r\n\t\t\toffset: options.offset,\r\n\t\t\theight: options.height,\r\n\t\t\twidth: options.width\r\n\t\t});\r\n\r\n\t\t// If the same popup is opened close it\r\n\t\tif(self.currentPopup == options.buttonSelector) {\r\n\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Shows the popup\r\n\t\tself.currentPopup = options.buttonSelector;\r\n\t\tvar popupContent = self.workportalFacade.getTemplate(options.template);\r\n\t\tpopup.render(popupContent);\r\n\r\n\t\t// Adds the active class for buttons\r\n\t\t$(options.buttonSelector, content).addClass(\"active\");\r\n\r\n\t\t// Checks for close signal to change the class again\r\n\t\t$.when(popup.closed())\r\n\t\t\t.done(function() {\r\n\t\t\t\tself.currentPopup = null;\r\n\t\t\t\t$(options.buttonSelector, content).removeClass(\"active\");\r\n\t\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Shows the user popup to access more options\r\n\t */\r\n\tshowUserPopup: function() {\r\n\t\tvar self = this;\r\n\t\tself.showMenuPopup({\r\n\t\t\tbuttonSelector: \"#ui-bizagi-wp-menu-username\",\r\n\t\t\ttemplate: \"menu.modal.user\",\r\n\t\t\toffset: \"0 0\",\r\n\t\t\theight: 80,\r\n\t\t\twidth: 90\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t *  Shows the widgets popup to access all dynamic content\r\n\t * @param options\r\n\t */\r\n\tshowWidgetsPopup: function(options) {\r\n\t\toptions = options || {};\r\n\t\tvar self = this;\r\n\t\tself.showMenuPopup({\r\n\t\t\tbuttonSelector: options[\"buttonSelector\"] || \"#main_menu li#menuListWidget\",\r\n\t\t\ttemplate: options[\"template\"] || \"menu.modal.widgets\",\r\n\t\t\toffset: options[\"offset\"] || \"18 -34\",\r\n\t\t\theight: options[\"height\"] || 160,\r\n\t\t\twidth: options[\"width\"] || 175\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show new case popup to create a case\r\n\t */\r\n\tshowNewCasePopup: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\r\n\t\t// Switch buttonstyle\r\n\t\t$(\"#main_menu li#menuListNew\", content).addClass(\"active\");\r\n\r\n\t\t// If the same popup is opened close it\r\n\t\tif(self.currentPopup == \"newCase\") {\r\n\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Shows a popup widget\r\n\t\tself.currentPopup = \"newCase\";\r\n\t\tself.publish(\"popupWidget\", {\r\n\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_NEWCASE,\r\n\t\t\toptions: {\r\n\t\t\t\tsourceElement: \"#main_menu li#menuListNew\",\r\n\t\t\t\t'max-height': '746',\r\n\t\t\t\theight: 'auto',\r\n\t\t\t\twidth: '339',\r\n\t\t\t\toffset: \"18 -4\", //x y\r\n\t\t\t\tactiveScroll: false,\r\n\t\t\t\tclosed: function() {\r\n\t\t\t\t\tself.currentPopup = null;\r\n\t\t\t\t\t$(\"#main_menu li#menuListNew\", content).removeClass(\"active\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n    *   Show new case popup to create a case\r\n    */\r\n    showMySearchPopup: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        // Switch buttonstyle\r\n        $(\"#ui-bizagi-wp-widget-searchContainer\", content).addClass(\"active\");\r\n\r\n        // If the same popup is opened close it\r\n        if (self.currentPopup == \"mySearch\") {\r\n            bizagi.workportal.desktop.popup.closePopupInstance();\r\n            return;\r\n        }\r\n\r\n        // Shows a popup widget\r\n        self.currentPopup = \"mySearch\";\r\n        self.publish(\"popupWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST,\r\n            options: {\r\n                sourceElement: \"#ui-bizagi-wp-widget-searchContainer\",\r\n                'max-height': '346',\r\n                height: 'auto',\r\n                width: '339',\r\n                top: '52',\r\n                offset: \"18 10\",\r\n                activeScroll: true,\r\n                closed: function () {\r\n                    self.currentPopup = null;\r\n                    $(\"#ui-bizagi-wp-widget-searchContainer\", content).removeClass(\"active\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n\t/**\r\n\t * Show new case popup to create a case\r\n\t */\r\n\tshowQueriesPopup: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\r\n\t\t// Switch buttonstyle\r\n\t\t$(\"#main_menu li#menuListQueries\", content).addClass(\"active\");\r\n\r\n\t\t// If the same popup is opened close it\r\n\t\tif(self.currentPopup == \"queries\") {\r\n\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar widgetName = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES;\r\n\t\tif(bizagi.util.parseBoolean(bizagi.override.disableFrankensteinQueryForms) == true) {\r\n\t\t\twidgetName = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION;\r\n\t\t}\r\n\r\n\t\tbizagi.loader.start(\"queries\").then(function () {\r\n\t\t    // Shows a popup widget\r\n\t\t    self.currentPopup = \"queries\";\r\n\t\t    self.publish(\"popupWidget\", {\r\n\t\t\t    widgetName: widgetName,\r\n\t\t\t    options: {\r\n\t\t\t\t    sourceElement: \"#main_menu li#menuListQueries\",\r\n\t\t\t\t    'max-height': '346',\r\n\t\t\t\t    height: 'auto',\r\n\t\t\t\t    width: '339',\r\n\t\t\t\t    offset: \"18 -4\",\r\n\t\t\t\t    activeScroll: true,\r\n\t\t\t\t    closed: function() {\r\n\t\t\t\t\t    self.currentPopup = null;\r\n\t\t\t\t\t    $(\"#main_menu li#menuListQueries\", content).removeClass(\"active\");\r\n\t\t\t\t    }\r\n\t\t\t    }\r\n\t\t    });\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show popup with information about the product\r\n\t */\r\n\tshowAboutPopup: function() {\r\n\t\tvar self = this;\r\n\t\tvar template = self.workportalFacade.getTemplate(\"menu.modal.about\");\r\n\r\n        var argsTemplate = {\r\n            build: bizagi.loader.productBuildToAbout,\r\n            currentYear: bizagi.loader.currentYearVersion,\r\n            hostName: bizagiConfig.hostName || \"\"\r\n        };\r\n\r\n\t\tvar popupContent = $.tmpl(template, argsTemplate);\r\n\t\t$(popupContent).dialog({\r\n\t\t\twidth: 430,\r\n\t\t\theight: 200,\r\n\t\t\tmodal: true,\r\n\t\t\ttitle: bizagi.localization.getResource('workportal-menu-about'),\r\n            allowmaximize: false,\r\n\t\t\tmaximized: false,\r\n\t\t\tresizable: false,\r\n            draggable: false\r\n        });\r\n        \r\n        if(argsTemplate.hostName){\r\n            $(\".content\", popupContent).css(\"margin-top\", \"-50px\");\r\n        }\r\n\t},\r\n\r\n\t/**\r\n\t * Check permisions for category\r\n\t * @param data\r\n\t * @param key\r\n\t * @return {boolean}\r\n\t */\r\n\tcheckRootCategory: function(data, key) {\r\n\t\tif(data[\"permissions\"] != undefined) {\r\n\t\t\tfor(var i = 0; i < data[\"permissions\"].length; i++) {\r\n\t\t\t\tif(data[\"permissions\"][i][key] != undefined) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t/**\r\n\t *\tGet root category\r\n\t * @param data\r\n\t * @param key\r\n\t * @return {*}\r\n\t */\r\n\tgetsRootCategory: function(data, key) {\r\n\t\tfor(var i = 0; i < data[\"permissions\"].length; i++) {\r\n\t\t\tif(data[\"permissions\"][i][key] != undefined) {\r\n\t\t\t\treturn data[\"permissions\"][i][key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {};\r\n\t},\r\n\r\n\t/**\r\n\t * Get data for a category menu\r\n\t * @param data\r\n\t * @param category\r\n\t * @return {Array}\r\n\t */\r\n\tgetSubMenuData: function(data, category) {\r\n\t\tvar self = this;\r\n\t\tvar result = [];\r\n\t\tvar prefix = \"workportal-menu-submenu-\";\r\n\t\tdata = data || self.security.getRawData() || {};\r\n\t\t\r\n\t\tif(self.checkRootCategory(data, category)) {\r\n\t\t\t$.each(self.getsRootCategory(data, category), function(k, v) {\r\n\t\t\t\tif(v !== \"MultilanguageEntities\"){ //To avoid add in the menu an option that not exists\r\n\t\t\t\t\tresult.push(\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"categoryKey\": v,\r\n\t\t\t\t\t\t\t\"categoryName\": self.getResource(prefix + v),\r\n\t\t\t\t\t\t\t\"categoryUrl\": self.dataService.getUrl({\r\n\t\t\t\t\t\t\t\t\"endPoint\": v\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn result;\r\n\t},\r\n\t/**\r\n\t * Render a submenu trough  BIZAGI_WORKPORTAL_WIDGET_SUBMENU\r\n\t */\r\n\trenderAdminMenu: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar menuData = self.getSubMenuData(self.jsonSecurityList, \"Admin\");\r\n\r\n\t\t// Switch buttonstyle\r\n\t\t$(\"#main_menu li#menuListAdmin\", content).addClass(\"active\");\r\n\t\t// If the same popup is opened close it\r\n\t\tif(self.currentPopup == \"subMenu\") {\r\n\t\t    bizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t    self.currentPopup = null;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// Shows a popup widget\r\n\t\tself.currentPopup = \"subMenu\";\r\n        self.publish(\"popupWidget\", {\r\n\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU,\r\n\t\t\toptions: {\r\n\t\t\t\tsourceElement: \"#main_menu li#menuListAdmin\",\r\n\t\t\t\t'max-height': '346',\r\n\t\t\t\theight: 'auto',\r\n\t\t\t\twidth: '339',\r\n\t\t\t\toffset: \"18 -4\",\r\n\t\t\t\tactiveScroll: true,\r\n\t\t\t\tclosed: function() {\r\n\t\t\t\t\tself.currentPopup = null;\r\n\t\t\t\t\t$(\"#main_menu li#menuListAdmin\", content).removeClass(\"active\");\r\n\t\t\t\t},\r\n\t\t\t\tmenuData: menuData\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n    /**\r\n     * Render Quick Process Menu\r\n     */\r\n\r\n    renderQuickProcessMenu: function(){\r\n        var self = this;\r\n\t\tvar content = self.getContent();\r\n\t\t\r\n\t\tvar menuData = self.getSubMenuData(self.jsonSecurityList, \"AdhocProcess\");\r\n\t\tvar menuValidator = {\r\n\t\t\tAdhocProcessAdmin: -1,\r\n\t\t\tAdhocUserGroupAdmin: -1,\r\n\t\t\tAdhocUserGroupReport: -1\r\n\t\t};\r\n        for(var i = 0; i < menuData.length; i+=1){\r\n\t\t\t// Verify which permissions exist\r\n\t\t\tmenuValidator[menuData[i].categoryKey] = i;\r\n\t\t}\r\n\t\tif(menuValidator.AdhocProcessAdmin > -1){\r\n\t\t\t// Add the Create Process control\r\n\t\t\tmenuData.push({\r\n\t\t\t\t\"categoryKey\": \"AdhocCreateProcess\",\r\n\t\t\t\t\"categoryName\": self.getResource(\"workportal-menu-submenu-AdhocCreateProcess\"),\r\n\t\t\t\t\"categoryUrl\": undefined\r\n\t\t\t});\r\n\t\t}\r\n\r\n        // Switch buttonstyle\r\n        $(\"#main_menu li#menuListQuickProcess\", content).addClass(\"active\");\r\n        // If the same popup is opened close it\r\n        if(self.currentPopup == \"subMenu\") {\r\n            bizagi.workportal.desktop.popup.closePopupInstance();\r\n            self.currentPopup = null;\r\n            return;\r\n        }\r\n        // Shows a popup widget\r\n\t\tself.currentPopup = \"subMenu\";\r\n\t\t\r\n        self.publish(\"popupWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU,\r\n            options: {\r\n                sourceElement: \"#main_menu li#menuListQuickProcess\",\r\n                'max-height': '346',\r\n                height: 'auto',\r\n                width: '339',\r\n                offset: \"18 -4\",\r\n                activeScroll: true,\r\n                closed: function() {\r\n                    self.currentPopup = null;\r\n                    $(\"#main_menu li#menuListQuickProcess\", content).removeClass(\"active\");\r\n                },\r\n                menuData: menuData\r\n            }\r\n        });\r\n    },\r\n\r\n\t/**\r\n\t * Render BAM Reports\r\n\t */\r\n\trenderReportsMenu: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\r\n\t\tbizagi.loader.start(\"reports\").then(function () {\r\n\t\t    var widget = (!bizagi.util.isIE8()) ? bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS;\r\n\t\t    // Switch buttonstyle\r\n\t\t    $(\"#main_menu li#menuListReports\", content).addClass(\"active\");\r\n\r\n\t\t    // If the same popup is opened close it\r\n\t\t    if(self.currentPopup == \"subMenu\") {\r\n\t\t\t    bizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\t    return;\r\n\t\t    }\r\n\r\n\t\t    // Shows a popup widget\r\n\t\t    self.currentPopup = \"subMenu\";\r\n\t\t    self.publish(\"popupWidget\", {\r\n\t\t\t    widgetName: widget,\r\n\t\t\t    options: {\r\n\t\t\t\t    sourceElement: \"#main_menu li#menuListReports\",\r\n\t\t\t\t    'max-height': '346',\r\n\t\t\t\t    height: 'auto',\r\n\t\t\t\t    width: '339',\r\n\t\t\t\t    offset: \"18 -4\",\r\n\t\t\t\t    activeScroll: true,\r\n\t\t\t\t    closed: function() {\r\n\t\t\t\t\t    self.currentPopup = null;\r\n\t\t\t\t\t    $(\"#main_menu li#menuListReports\", content).removeClass(\"active\");\r\n\t\t\t\t    }\r\n\t\t\t\t    ,\r\n\t\t\t\t    menuData: self.getSubMenuData(self.jsonSecurityList, \"AnalysisReports\")\r\n\t\t\t    }\r\n\t\t    });\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Shows the options for font size\r\n\t */\r\n\trenderFontMenu: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\r\n\t\t// Switch buttonstyle\r\n\t\t$(\".ui-bizagi-wp-bt-font\", content).addClass(\"active\");\r\n\r\n\t\t// If the same popup is opened close it\r\n\t\tif(self.currentPopup == \"fontsize\") {\r\n\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Shows a popup widget\r\n\t\tself.currentPopup = \"fontsize\";\r\n\t\tself.publish(\"popupWidget\", {\r\n\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FONTSIZE,\r\n\t\t\toptions: {\r\n\t\t\t\tsourceElement: \".ui-bizagi-wp-bt-font\",\r\n\t\t\t\toffset: \"0 16\",\r\n\t\t\t\tclosed: function() {\r\n\t\t\t\t\tself.currentPopup = null;\r\n\t\t\t\t\t$(\".ui-bizagi-wp-bt-font\", content).removeClass(\"active\");\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Renders a custom sub-menu\r\n\t * @param menuButton\r\n\t * @param submenu\r\n\t * @param callback\r\n\t */\r\n\trenderSubMenu: function(menuButton, submenu, callback) {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar menuData = [];\r\n\r\n\t\t// Transform menu data\r\n\t\tfor (i in submenu) {\r\n\t\t    if (submenu.hasOwnProperty(i)) {\r\n\t\t        menuData.push({\r\n\t\t            categoryKey: submenu[i].id,\r\n\t\t            categoryName: submenu[i].text,\r\n\t\t            categoryClassName: submenu[i].className\r\n\t\t        });\r\n\t\t    }\r\n\t\t}\r\n\r\n\t\t// Switch buttonstyle\r\n\t\tmenuButton.addClass(\"active\");\r\n\r\n\t\t// If the same popup is opened close it\r\n\t\tif(self.currentPopup == \"subMenu\") {\r\n\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Shows a popup widget\r\n\t\tself.currentPopup = \"subMenu\";\r\n\t\tself.publish(\"popupWidget\", {\r\n\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU,\r\n\t\t\toptions: {\r\n\t\t\t\tsourceElement: menuButton,\r\n\t\t\t\t'max-height': '346',\r\n\t\t\t\theight: 'auto',\r\n\t\t\t\twidth: '339',\r\n\t\t\t\toffset: \"18 -4\",\r\n\t\t\t\tactiveScroll: true,\r\n\t\t\t\tclosed: function() {\r\n\t\t\t\t\tself.currentPopup = null;\r\n\t\t\t\t\tmenuButton.removeClass(\"active\");\r\n\t\t\t\t},\r\n\t\t\t\tmenuData: menuData,\r\n\t\t\t\tcustomClickHandler: function(id) {\r\n\t\t\t\t\tif(callback)\r\n\t\t\t\t\t\tcallback(self, id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show popup for entities\r\n\t * @param url\r\n\t * @todo Check if this method has any active dependency\r\n\t */\r\n\tshowEntitiesPopup: function(url) {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\r\n\r\n\t\t// Switch buttonstyle\r\n\t\t$(\"#main_menu li#temp\", content).addClass(\"active\");\r\n\r\n\t\t// If the same popup is opened close it\r\n\t\tif(self.currentPopup == \"genericiframe\") {\r\n\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Shows a popup widget\r\n\t\tself.currentPopup = \"genericiframe\";\r\n\t\tself.publish(\"showDialogWidget\", {\r\n\t\t\twidgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n\t\t\twidgetURL: url\r\n\t\t});\r\n\t}\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Desktop Workarea Controller\r\n*   Author: Diego Parra \r\n*   Comments:\r\n*   -   This script will override workarea controller class to apply custom stuff just for desktop device\r\n*/\r\n\r\n// Auto extend\r\nbizagi.workportal.controllers.main.extend(\"bizagi.workportal.controllers.main\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Popup Implementation\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will shows a widget inside a popup box\r\n*/\r\n\r\n// Bind resize window\r\n$(window).bind(\"resize\",function(){                             \r\n        bizagi.workportal.desktop.popup.closePopupInstance();          \r\n});\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.workportal.desktop.popup\", {\r\n\r\n    /*\r\n    *   Static method that will return the current popup instance\r\n    */\r\n    closePopupInstance: function () {\r\n        if (bizagi.workportal.desktop.popup.instance) {\r\n            bizagi.workportal.desktop.popup.instance.close();\r\n        }\r\n    }\r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, workportalFacade, options) {\r\n        this.dataService = dataService;\r\n        this.workportalFacade = workportalFacade;\r\n\r\n        // Set display options\r\n        options = options || {};\r\n        this.sourceElement = options.sourceElement;\r\n        this.my = options.my || \"center top\";\r\n        this.at = options.at || \"center bottom\";\r\n        this.offset = options.offset || \"18 -20\";\r\n        this.activeScroll = options.activeScroll || false;\r\n        this.arrowPosition = options.arrowPosition || false;\r\n        if(options.position) {\r\n            this.position = options.position;\r\n        }\r\n        if(options.insertAfter) {\r\n            this.insertAfter = options.insertAfter;\r\n        }\r\n\r\n        // This option is only to help graphics designers on dummy pages\r\n        this.dontClose = options.dontClose || false;\r\n\r\n        // TODO: implement scroll for personalised container\r\n        this.scrollElement = options.scrollElement || \".content\";\r\n    },\r\n\r\n    /*\r\n    *   Renders some content inside a popup\r\n    *   Return a deferred to check when the popup closes\r\n    */\r\n    render: function (content, params) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        var template = self.workportalFacade.getTemplate(\"popup\");\r\n\r\n        params = params || {};\r\n\r\n        // Creates an instance deferred to be resolved when the popup closes\r\n        self.closeDeferred = new $.Deferred();\r\n\r\n        // Check if there are any popup open so we close first those instances\r\n        self.Class.closePopupInstance();\r\n\r\n        // Add to popup instances\r\n        bizagi.workportal.desktop.popup.instance = this;\r\n\r\n        // Extend Parameters\r\n        $.extend(params, params, { activeScroll: self.activeScroll });\r\n\r\n        // Append content into a div\r\n        self.popup = $.tmpl(template, params);\r\n        $(\".content\", self.popup).append(content);\r\n        \r\n        if(self.insertAfter) {\r\n            $(self.insertAfter).after(self.popup);\r\n        } else {\r\n            self.popup.appendTo(\"body\", doc);\r\n        }\r\n\r\n        // Create popup box\r\n        self.showPopup(self.popup);\r\n    },\r\n\r\n    /*\r\n    *   Shows the popup box in the browser\r\n    */\r\n    showPopup: function (popup) {\r\n        var doc = window.document;\r\n        var self = this;\r\n\r\n        // Set width and height\r\n        if (self.popupWidth) popup.width(self.popupWidth);\r\n        if (self.popupHeight) popup.height(self.popupHeight);\r\n\r\n        // Locate over element\r\n        if (self.sourceElement) {\r\n            if(self.insertAfter) {\r\n                popup.find(\".selectarrow\").hide();\r\n                popup.css({\r\n                    display: \"inline-block\",\r\n                    \"float\": \"left\",\r\n                    position: \"relative\",\r\n                    left: \"37%\",\r\n                    top: \"20px\",\r\n                    \"z-index\" : 1\r\n                });\r\n            } else {\r\n                popup.position({\r\n                    my: self.my,\r\n                    at: self.at,\r\n                    of: $(self.sourceElement),\r\n                    collision: \"none\",\r\n                    offset: self.offset\r\n                });\r\n                if(self.position) {\r\n                    popup.css(\"position\", self.position);\r\n                }\r\n            }\r\n        } else {\r\n            popup.css(\"left\", ($(window).width() - popup.width()) / 2);\r\n            popup.css(\"top\", ($(window).height() - popup.height()) / 2);\r\n        }\r\n\r\n\t\t// Move arrow\r\n\t\tif(self.arrowPosition){\r\n\t\t\tvar arrow = $(\".selectarrow\",popup);\r\n\t\t\tarrow.css(self.arrowPosition);\r\n\t\t}\r\n\r\n        // Define handler to close the item\r\n        setTimeout(function () {\r\n            // Capture all click elements inside the popup\r\n            popup.click(function (e) {\r\n                if(!bizagi.workportal.desktop.popup.instance){\r\n                    self.close();\r\n                }\r\n                e.stopPropagation();\r\n            });\r\n\r\n            // Make a document click, if the event bubbles up to here then the click was made outside popup boundaries\r\n            $(doc).one(\"click\", function() {\r\n                self.close();\r\n            });\r\n        }, 100);\r\n    },\r\n\r\n    /*\r\n    *   Returns the instance deferred to hold executions until \r\n    *   the popup is closed\r\n    */\r\n    closed: function () {\r\n        var self = this;\r\n        return self.closeDeferred;\r\n    },\r\n\r\n    /*\r\n    *   Forces to close the popup\r\n    */\r\n    close: function () {\r\n        var doc = window.document;\r\n        var self = this;\r\n\r\n        // Just for testing purposes - used in complexgateway\r\n        if (this.dontClose) return;\r\n        \r\n        //$(doc).unbind(\"click\"); Comment for prevent disable others click event\r\n\r\n        // Removes element\r\n        self.popup.remove();\r\n        bizagi.workportal.desktop.popup.instance = null;\r\n\r\n        // Resolve deferred\r\n        self.closeDeferred.resolve();\r\n    },\r\n\r\n    /*\r\n    *   Returns the popup content\r\n    */\r\n    getContent: function () {\r\n        var self = this;\r\n        return self.popup;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Desktop Print Version Widget Controller\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will provide desktop overrides to implement the print version\r\n*/\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.print.extend(\"bizagi.workportal.widgets.print\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"print\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\").concat(\"#bz-wp-widget-print\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /**\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n        // Load render page\r\n        var facade = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n\r\n        //Print all grid rows\r\n        var configParams = { p_all_rows: 1000000 };\r\n\r\n        $.when(facade.execute($.extend({\r\n                    canvas: content,\r\n                    printversion: true\r\n                }, $.extend(self.params.params, configParams)))).done(function () {\r\n\r\n                    // Remove Tabs elements\r\n                    self.formatTabs();\r\n\r\n                    // Remove Group elements\r\n                    self.formatGroups();\r\n\r\n                    self.appendCaseDetails();\r\n\r\n                    // Remove events to ECM control\r\n                    self.formatECM();\r\n\r\n                    // Remove events to button control\r\n                    self.formatButton();\r\n\r\n                    // format grid\r\n                    self.formatGrid();\r\n\r\n                    // format renders\r\n                    self.formatRenderContainer();\r\n\r\n                    // Remove bottons save and next\r\n                    $(\".ui-bizagi-button-container\", content).remove();\r\n\r\n                });\r\n    },\r\n\r\n    formatTabs: function () {\r\n        var self = this,\r\n\t    formatContent = $(\"<div>\"),\r\n\t    i = 0,\r\n\t    control = self.getContent(),\r\n\t    tabElement = $('.ui-tabs', control);\r\n\r\n        // Destroy tabs\r\n        $.each(tabElement, function () {\r\n\r\n            // Reorder tabs content\r\n            var ul = $('ul', $(this)); // header elements\r\n            var labels = $('>div', $(this)); // page elements\r\n\r\n            $.each($('li', ul), function () {\r\n                // Select all tabs element to force the content loading\r\n                tabElement.tabs(\"option\", \"active\", i);\r\n\r\n                // add header to final content\r\n                $(formatContent).append('<h3>' + $(this).text() + '</h3>');\r\n\r\n                // Add content to final content\r\n                $(formatContent).append(labels[i++]);\r\n            });\r\n\r\n            // Empty old content and append formated\r\n            $('.ui-tabs', control).empty();\r\n            $('.ui-tabs', control).append(formatContent);\r\n            tabElement.tabs(\"destroy\");\r\n        });\r\n    },\r\n\r\n    /* APPEND CASE DETAILS\r\n    =====================================================*/\r\n    appendCaseDetails: function () {\r\n        var self = this;\r\n        var control = self.getContent();\r\n\r\n        self.dataService.summaryCaseDetails({\r\n            idCase: self.params.params.idCase\r\n        }).done(function (data) {\r\n\r\n            var getState = function (idWorkItem, currentState) {\r\n                var state = \"\";\r\n                $.each(currentState, function (key, value) {\r\n                    if (value.idWorkItem == idWorkItem) {\r\n                        state = value.state || value.displayName;\r\n                    }\r\n                });\r\n                return state;\r\n            }\r\n            // Process Metadata\r\n            var $caseDetails = $('<ul></ul>').addClass('ui-bz-print-case-details');\r\n\r\n            // Case Number\r\n            $('<li></li>').text(self.resources.getResource('workportal-widget-inboxcommon-case-number') + ' ' + data.caseNumber).appendTo($caseDetails);\r\n\r\n            // task\r\n            if (self.params && self.params.params && self.params.params.idWorkitem != 0) {\r\n                $('<li></li>').text(self.resources.getResource('workportal-widget-inboxcommon-activities-name') + ' ' + getState(self.params.params.idWorkitem, data.currentState)).appendTo($caseDetails);\r\n            }\r\n            // Created by\r\n            $('<li></li>').text(self.resources.getResource('workportal-widget-inboxcommon-created-by') + ' ' + data.createdBy.Name).appendTo($caseDetails);\r\n\r\n            // Creation date\r\n            $('<li></li>').html(self.resources.getResource('workportal-widget-inboxcommon-creation-date') + '<span class=\\\"formatDate\\\">' + data.creationDate + \"</span>\").appendTo($caseDetails);\r\n\r\n            // State expires on\r\n            if (typeof data.estimatedSolutionDate != \"undefined\") {\r\n                $('<li></li>').html(self.resources.getResource('workportal-widget-inboxcommon-state-expires-on') + '<span class=\\\"formatDate\\\">' + data.estimatedSolutionDate + \"</span>\").appendTo($caseDetails);\r\n            }\r\n\r\n            function setProcess(process){\r\n                $('<li></li>').text(self.resources.getResource('workportal-widget-inboxcommon-process') + ' ' + process).appendTo($caseDetails);\r\n            }\r\n            // Process\r\n            if(data.idPlan){\r\n                $.when(self.dataService.getPlan({ idPlan: data.idPlan })).done(function (responsePlan) {\r\n                    setProcess(responsePlan.name);\r\n                });\r\n            }\r\n            else{\r\n                setProcess(data.process)\r\n            }\r\n\r\n            // Process path\r\n            if(data.processPath && data.processPath !== \"undefined\"){\r\n                $('<li></li>').text(self.resources.getResource('workportal-widget-inboxcommon-process-path') + ' ' + data.processPath).appendTo($caseDetails);\r\n            }\r\n\r\n            // Append data\r\n            $('.ui-bizagi-container:first', control).prepend($caseDetails);\r\n\r\n            //Format dates\r\n            bizagi.util.formatInvariantDate(control, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n        });\r\n    },\r\n\r\n    formatGroups: function () {\r\n        var self = this,\r\n\t       control = self.getContent(),\r\n\t       container = $('h3.ui-bizagi-container-group-header', control);\r\n\r\n        $.each(container, function () {\r\n            var containerText = $(this).text();\r\n\r\n            // Get html to container and convert to plain text\r\n            $(this).empty();\r\n            $(this).append(containerText)\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n    * Format ECM control\r\n    */\r\n    formatECM: function () {\r\n        var self = this,\r\n\t       control = self.getContent(),\r\n\t       container = $('.ui-bizagi-render-upload', control);\r\n\r\n        $(container).bind('ecmLoaded', function (cont) {\r\n            var image = $('img', cont.container);\r\n            var file = $(\".filename a:last\", cont.container);\r\n            var value = $(file).parent('li').text().replace(/^\\s+|\\s+$/g, \"\");\r\n\r\n            // Remove click event to image\r\n            image.unbind('click');\r\n\r\n            // Remove click event to link an parse value\r\n            file.unbind('click');\r\n            $(file).parent('li').text(value);\r\n\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Format Button Control\r\n    */\r\n    formatButton: function () {\r\n        var self = this,\r\n\t    control = self.getContent(),\r\n\t    buttons = $('.ui-bizagi-render-button', control);\r\n\r\n        $.each(buttons, function (k, button) {\r\n            var value = $(button).val();\r\n\t        var parentContainer = $(button).parent();\r\n            $(parentContainer).empty();\r\n            $(parentContainer).append(\"<div class='ui-bizagi-render-button'>\" + value + \"</div>\");\r\n        });\r\n    },\r\n\r\n    /**\r\n    *  Format Grid Control\r\n    */\r\n    formatGrid: function () {\r\n        var self = this,\r\n\t    control = self.getContent(),\r\n        tableControl = $('.ui-bizagi-grid-table', control);\r\n        pageContent = $('.ui-pg-table', control),\r\n\t    closeButton = $('.ui-jqgrid-titlebar-close', control);\r\n\r\n        // Clean paginator\r\n        /*$.each(pageContent, function () {\r\n        $(\"td:not[align='left'],td:not[align='center']\", $(this)).remove();\r\n        });*/\r\n\r\n        $(\"th.ui-bizagi-column-hidden, th.ui-bizagi-grid-key, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother\", control).remove();\r\n\r\n        //Remove click event\r\n        $(\"[data-action], ul li, .ui-bizagi-grid-column, tr, th\", tableControl).unbind(\"click\");\r\n        // Remove close button\r\n        $(closeButton).remove();\r\n    },\r\n\r\n    /**\r\n    *   Format Render Style\r\n    */\r\n\r\n    formatRenderContainer: function () {\r\n        var self = this,\r\n        control = self.getContent();\r\n        $('.ui-bizagi-notifications-container', control).remove();\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Popup Widget Implementation\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will shows a widget inside a popup box\r\n*/\r\n\r\n// Extends itself\r\nbizagi.workportal.desktop.popup.extend(\"bizagi.workportal.desktop.widgets.popup\", { }, {\r\n\r\n    /*\r\n    *   Render the Widget\r\n    *   Returns a deferred\r\n    */\r\n    renderWidget: function (params) {\r\n        var self = this;\r\n        var widget;\r\n        // Creates widget\r\n        $.when(\r\n            self.workportalFacade.getWidget(params.widgetName, params)\r\n\r\n        ).pipe(function (result) {\r\n            // Renders widget\r\n            widget = result;\r\n            // register\r\n            self.register(widget);\r\n            return widget.render();\r\n\r\n        }).done(function () {\r\n            var content = widget.getContent();\r\n\r\n            // Renders content\r\n            self.render(content, params.options);\r\n        });\r\n    },\r\n    \r\n    register : function(widget) {\r\n        var self = this;\r\n        if(widget.registerCallback) {\r\n            widget.registerCallback(self);\r\n        }\r\n    }\r\n\r\n});\r\n","    /**\r\n *   Name: Bizagi Workportal Desktop HomePortal Controller\r\n *   Author: Manuel Mejia\r\n */\r\n\r\n/**\r\n *  CD: Case Dashboard, example: toLeftSidebarCD: To left sidebar Case dashboard\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.homeportal\", {\r\n    contexts: {\r\n        \"HOME\": {\r\n            widgets: {\r\n                \"dashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.dashboard\"\r\n                },\r\n                \"stuff\": {\r\n                    \"layout\": \"dashboard\",\r\n                    \"name\": \"bizagi.workportal.widgets.stuff\",\r\n                    \"canvas\": \"stuff\"\r\n                },\r\n                \"plans\": {\r\n                    \"layout\": \"dashboard\",\r\n                    \"name\": \"bizagi.workportal.widgets.decontextualized.plans\",\r\n                    \"canvas\": \"plans\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"sidebar\": {\r\n                    \"layout\": \"leftsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.sidebarhome\"\r\n                },\r\n                \"usersummary\": {\r\n                    \"layout\": \"sidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.usersummary\",\r\n                    \"canvas\": \"content1\"\r\n                },\r\n                \"myshortcuts\": {\r\n                    \"layout\": \"sidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.shortcuts\",\r\n                    \"canvas\": \"content2\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent1\" },\r\n                \"empty2\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": false, \"toRightSidebarCD\": false, \"toTaskSidebarCD\": false }\r\n        },\r\n\r\n        \"TEMPLATEENGINE-VIEW\": {\r\n            widgets: {\r\n                \"templates\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.templates\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"paginator\": {\r\n                    \"layout\": \"templates\",\r\n                    \"name\": \"bizagi.workportal.widgets.paginator\",\r\n                    \"canvas\": \"paginator\"\r\n                },\r\n                \"sortbar\": {\r\n                    \"layout\": \"templates\",\r\n                    \"name\": \"bizagi.workportal.widgets.sortbar\",\r\n                    \"canvas\": \"sortbar\"\r\n                },\r\n                \"mysearchfilter\": {\r\n                    \"layout\": \"templates\",\r\n                    \"name\": \"bizagi.workportal.widgets.mysearchfilter\",\r\n                    \"canvas\": \"mysearchfilter\"\r\n                },\r\n                \"sidebar\": {\r\n                    \"layout\": \"leftsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.sidebar\"\r\n                },\r\n                \"stuff\": {\r\n                    \"layout\": \"sidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.stuff\",\r\n                    \"canvas\": \"content1\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent1\" },\r\n                \"empty2\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 1 },\r\n            belongs: { \"toLeftSidebarCD\": false, \"toRightSidebarCD\": false, \"toTaskSidebarCD\": false }\r\n        },\r\n\r\n        \"ENTITY-ENGINE-VIEW\": {\r\n            widgets: {\r\n                \"templates\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.templates\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"sidebar\": {\r\n                    \"layout\": \"leftsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.sidebar\"\r\n                },\r\n                \"stuff\": {\r\n                    \"layout\": \"sidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.stuff\",\r\n                    \"canvas\": \"content1\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent1\" },\r\n                \"empty2\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 1 },\r\n            belongs: { \"toLeftSidebarCD\": false, \"toRightSidebarCD\": false, \"toTaskSidebarCD\": false }\r\n        },\r\n\r\n        \"SEARCH-ENGINE-VIEW\": {\r\n            widgets: {\r\n                \"templates\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.templates\"\r\n                },\r\n                \"paginator\": {\r\n                    \"layout\": \"templates\",\r\n                    \"name\": \"bizagi.workportal.widgets.paginator\",\r\n                    \"canvas\": \"paginator\"\r\n                },\r\n                \"sortbar\": {\r\n                    \"layout\": \"templates\",\r\n                    \"name\": \"bizagi.workportal.widgets.sortbar\",\r\n                    \"canvas\": \"sortbar\"\r\n                },\r\n                \"mysearchfilter\": {\r\n                    \"layout\": \"templates\",\r\n                    \"name\": \"bizagi.workportal.widgets.mysearchfilter\",\r\n                    \"canvas\": \"mysearchfilter\"\r\n                },\r\n                \"sidebar\": {\r\n                    \"layout\": \"leftsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.sidebar\"\r\n                },\r\n                \"mysearchcriteria\": {\r\n                    \"layout\": \"sidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.mysearchcriteria\",\r\n                    \"canvas\": \"content1\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent1\" },\r\n                \"empty2\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 1 },\r\n            belongs: { \"toLeftSidebarCD\": false, \"toRightSidebarCD\": false, \"toTaskSidebarCD\": false }\r\n        },\r\n\r\n        \"CASES-TEMPLATE-VIEW\": {\r\n            widgets: {\r\n                \"templates\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.casestemplate\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"paginator\": {\r\n                    \"layout\": \"templates\",\r\n                    \"name\": \"bizagi.workportal.widgets.paginator\",\r\n                    \"canvas\": \"paginator\"\r\n                },\r\n                \"sortbar\": {\r\n                    \"layout\": \"templates\",\r\n                    \"name\": \"bizagi.workportal.widgets.sortbar\",\r\n                    \"canvas\": \"sortbar\"\r\n                },\r\n                \"sidebar\": {\r\n                    \"layout\": \"leftsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.sidebar\"\r\n                },\r\n                \"proccesseslist\": {\r\n                    \"layout\": \"sidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.processeslist\",\r\n                    \"canvas\": \"content1\"\r\n                },\r\n                \"filtercases\": {\r\n                    \"layout\": \"sidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.filtercases\",\r\n                    \"canvas\": \"sidebarfooter\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent1\" },\r\n                \"empty2\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 1 },\r\n            belongs: { \"toLeftSidebarCD\": false, \"toRightSidebarCD\": false, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"PLANS-VIEW\": {\r\n            widgets: {\r\n                \"topmenu\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.plans.topmenu\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"manager\": {\r\n                    \"layout\": \"topmenu\",\r\n                    \"name\": \"bizagi.workportal.widgets.plans.manager\",\r\n                    \"canvas\": \"plansList\"\r\n                },\r\n                \"sidebar\": {\r\n                    \"layout\": \"leftsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.sidebar\"\r\n                },\r\n                \"filters\": {\r\n                    \"layout\": \"sidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.plans.filters\",\r\n                    \"canvas\": \"content1\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent1\" },\r\n                \"empty2\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 1 },\r\n            belongs: { \"toLeftSidebarCD\": false, \"toRightSidebarCD\": false, \"toTaskSidebarCD\": false }\r\n        },\r\n        //CONTEXTS CASE DASHBOARD\r\n        \"ACTIVITY\": {\r\n            widgets: {\r\n                activity: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.activity\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                caseState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.caseState\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityDescription: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.description\",\r\n                    canvas: \"sidebarcontent2\"\r\n                },\r\n                activityState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activityState\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                processState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.processState\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                users: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.users\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                events: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.events\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                subprocesses: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.subprocesses\",\r\n                    canvas: \"sidebarcontent7\"\r\n                },\r\n                relatedPlan: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.plan.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": true }\r\n        },\r\n        \"OVERVIEW\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                overview: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.overview\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                caseState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.caseState\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityDescription: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.description\",\r\n                    canvas: \"sidebarcontent2\"\r\n                },\r\n                activityState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activityState\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                processState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.processState\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                users: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.users\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                events: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.events\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                subprocesses: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.subprocesses\",\r\n                    canvas: \"sidebarcontent7\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": true }\r\n        },\r\n        \"COMMENTS\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                discussions: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.discussions\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                discussionSidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.discussion.sidebar\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                caseState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.caseState\",\r\n                    canvas: \"sidebarcontent2\"\r\n                },\r\n                activityDescription: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.description\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activityState\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                processState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.processState\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                users: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.users\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                events: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.events\",\r\n                    canvas: \"sidebarcontent7\"\r\n                },\r\n                subprocesses: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.subprocesses\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": true }\r\n        },\r\n        \"FILES\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                files: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.files\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                filesPreview: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.filesPreview\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                caseState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.caseState\",\r\n                    canvas: \"sidebarcontent2\"\r\n                },\r\n                activityDescription: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.description\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activityState\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                processState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.processState\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                users: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.users\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                events: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.events\",\r\n                    canvas: \"sidebarcontent7\"\r\n                },\r\n                subprocesses: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.subprocesses\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": true }\r\n        },\r\n        \"PROCESSMAP\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                processMap: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.processMap\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                caseState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.caseState\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityDescription: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.description\",\r\n                    canvas: \"sidebarcontent2\"\r\n                },\r\n                activityState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activityState\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                processState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.processState\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                users: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.users\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                events: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.events\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                subprocesses: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.subprocesses\",\r\n                    canvas: \"sidebarcontent7\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": true }\r\n        },\r\n        \"LOG\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                log: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.activity.log\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": true }\r\n        },\r\n        \"TIMELINE\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                \"timeline\": {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.timeline\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                \"timelineSidebar\": {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.timeline.sidebar\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                caseState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.caseState\",\r\n                    canvas: \"sidebarcontent2\"\r\n                },\r\n                activityDescription: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.description\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activityState\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                processState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.processState\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                users: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.users\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                events: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.events\",\r\n                    canvas: \"sidebarcontent7\"\r\n                },\r\n                subprocesses: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.subprocesses\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": true }\r\n        },\r\n        //CONTEXTS FOR PLAN\r\n        \"PLANCREATE\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                plan: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.plan\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                caseState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.caseState\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityDescription: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.description\",\r\n                    canvas: \"sidebarcontent2\"\r\n                },\r\n                activityState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activityState\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                processState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.processState\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                users: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.users\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                events: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.events\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                subprocesses: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.subprocesses\",\r\n                    canvas: \"sidebarcontent7\"\r\n                },\r\n                \"empty1\": { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": true }\r\n        },\r\n        \"PLANOVERVIEW\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                planActivities: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activities\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                planSidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                planAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                planState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.state\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                planProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                planTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.time\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                planParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.parent\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                planUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.users\",\r\n                    canvas: \"sidebarcontent7\"\r\n                }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"PLANACTIVITIES\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                planActivities: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activities\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                planSidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                planAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                planState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.state\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                planProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                planTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.time\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                planParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.parent\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                planUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.users\",\r\n                    canvas: \"sidebarcontent7\"\r\n                }\r\n            },\r\n            nav: { level: 1 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"PLANFILES\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                files: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.files\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                filesPreview: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.filesPreview\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                empty2: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent3\" },\r\n                empty3: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent4\" },\r\n                empty4: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent5\" },\r\n                empty5: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent6\" },\r\n                empty6: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent7\" },\r\n                empty7: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"PLANCOMMENTS\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                discussions: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.discussions\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                planSidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                discussionSidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.discussion.sidebar\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                planAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.action\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                planState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.state\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                planProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.progress\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                planTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.time\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                planUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.users\",\r\n                    canvas: \"sidebarcontent7\"\r\n                }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"PLANTIMELINE\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                \"timeline\": {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.timeline\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                empty1: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent1\" },\r\n                empty2: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent3\" },\r\n                empty3: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent4\" },\r\n                empty4: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent5\" },\r\n                empty5: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent6\" },\r\n                empty6: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent7\" },\r\n                empty7: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" }\r\n            },\r\n            nav: { level: 1 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"PLANSIDEBAR\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                planSidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                planAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                planState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.state\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                planProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                planTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.time\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                planParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.parent\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                planUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.users\",\r\n                    canvas: \"sidebarcontent7\"\r\n                }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"EDITACTIVITY\": {\r\n            widgets: {\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                activitiesForm: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.desktop.widgets.project.plan.activities.form\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                empty1: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontentextra\" },\r\n                empty2: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent3\" },\r\n                empty3: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent4\" },\r\n                empty4: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent5\" },\r\n                empty5: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent6\" },\r\n                empty6: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent7\" }\r\n            },\r\n            nav: { level: 0, refreshLastItemBreadcrumb: false },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        //CONTEXTS FOR ACTIVITY PLAN\r\n        \"ACTIVITYPLAN\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                activity: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.activity\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                activitySidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                activityAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.time\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                activityParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.parent\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                activityUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.users\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                relatedPlan: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.activity.plan.sidebar\",\r\n                    canvas: \"sidebarcontent7\"\r\n                }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"ACTIVITYPLANCREATE\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                plan: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.plan\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                activitySidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                activityAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.time\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                activityParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.parent\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                activityUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.users\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                empty6: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent7\" }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"ACTIVITYPLANOVERVIEW\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                overview: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activities\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                planSidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                planAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                planState: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.state\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                planProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                planTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.time\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                planParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.parent\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                planUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.users\",\r\n                    canvas: \"sidebarcontent7\"\r\n                }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"ACTIVITYPLANCOMMENTS\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                discussions: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.discussions\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                discussionSidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.discussion.sidebar\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activitySidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                activityAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.action\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.time\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                activityProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.progress\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                activityParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.parent\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                activityUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.users\",\r\n                    canvas: \"sidebarcontent7\"\r\n                }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"ACTIVITYPLANFILES\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                files: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.files\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                filesPreview: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.filesPreview\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activitySidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                activityAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.action\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.time\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                activityProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.progress\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                activityParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.parent\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                activityUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.users\",\r\n                    canvas: \"sidebarcontent7\"\r\n                }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"ACTIVITYPLANPROCESSMAP\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                processMap: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.processMap\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                activitySidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                activityAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.time\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                activityParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.parent\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                activityUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.users\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                empty6: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent7\" }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"ACTIVITYPLANLOG\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                log: {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.activity.log\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                activitySidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                activityAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.time\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                activityParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.parent\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                activityUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.users\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                empty6: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent7\" }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"ACTIVITYPLANTIMELINE\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.left.sidebar\"\r\n                },\r\n                \"menu\": {\r\n                    layout: \"leftSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\",\r\n                    canvas: \"contentsidebar\"\r\n                },\r\n                \"contentDashboard\": {\r\n                    \"layout\": \"content\",\r\n                    \"name\": \"bizagi.workportal.widgets.project.content.dashboard\"\r\n                },\r\n                \"timeline\": {\r\n                    layout: \"contentDashboard\",\r\n                    name: \"bizagi.workportal.widgets.project.timeline\",\r\n                    canvas: \"contentprincipal\"\r\n                },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.right.sidebar\"\r\n                },\r\n                activitySidebar: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.sidebar\",\r\n                    canvas: \"sidebarcontentextra\"\r\n                },\r\n                activityAction: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.action\",\r\n                    canvas: \"sidebarcontent1\"\r\n                },\r\n                activityTime: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.time\",\r\n                    canvas: \"sidebarcontent3\"\r\n                },\r\n                activityProgress: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.progress\",\r\n                    canvas: \"sidebarcontent4\"\r\n                },\r\n                activityParent: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.parent\",\r\n                    canvas: \"sidebarcontent5\"\r\n                },\r\n                activityUsers: {\r\n                    layout: \"rightSidebar\",\r\n                    name: \"bizagi.workportal.widgets.project.plan.activity.users\",\r\n                    canvas: \"sidebarcontent6\"\r\n                },\r\n                empty6: { layout: \"rightSidebar\", name: \"bizagi.workportal.widgets.dummy\", canvas: \"sidebarcontent7\" }\r\n            },\r\n            nav: { level: 0 },\r\n            belongs: { \"toLeftSidebarCD\": true, \"toRightSidebarCD\": true, \"toTaskSidebarCD\": false }\r\n        },\r\n        \"REFRESHALL\": {\r\n            widgets: {\r\n                \"leftSidebar\": {\r\n                    layout: \"leftsidebar\",\r\n                    name: \"bizagi.workportal.widgets.dummy\"\r\n                },\r\n                \"contentDashboard\": { layout: \"content\", name: \"bizagi.workportal.widgets.dummy\" },\r\n                \"rightSidebar\": {\r\n                    \"layout\": \"contentrightsidebar\",\r\n                    \"name\": \"bizagi.workportal.widgets.dummy\"\r\n                }\r\n            },\r\n            nav: { level: 0 }\r\n        }\r\n    }\r\n}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.CONTEXT_HOME = \"HOME\";\r\n\r\n        params = params || {};\r\n        params.supportNav = true;\r\n\r\n        self.setContextsByNotifyEvents();\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"homeportal\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.homeportal\").concat(\"#homeportal-frame\")\r\n        });\r\n\r\n        if (params.widgetName == \"homeportal\") {\r\n            if (!bizagi.referrerParams)\r\n                bizagi.referrerParams = {};\r\n\r\n            bizagi.referrerParams.referrer = self.getWidgetName();\r\n        }\r\n\r\n        self.manager = bizagi.injector.get(\"widgetManager\", params);\r\n        self.manager.sub(\"notifyChange\", $.proxy(self.onNotifyChange, self));\r\n        self.sub(\"notify\", $.proxy(self.onNotifyChange, self));\r\n\r\n        bizagi.injector.registerInstance(\"homeportal\", self);\r\n    },\r\n    /**\r\n     * Set context by behaviors sidebars\r\n     */\r\n    setContextsByNotifyEvents: function () {\r\n        var self = this;\r\n        self.params = self.params || {};\r\n        self.params.contextsSidebarActivity = [];\r\n        self.params.contextsWithoutLeftSidebarCaseDashboard = [];\r\n        self.params.contextsLeftSidebarCaseDashboard = [];\r\n        self.params.contextsWithoutRightSidebarCaseDashboard = [];\r\n        self.params.contextsRightSidebarCaseDashboard = [];\r\n\r\n\r\n        for (var context in this.Class.contexts) {\r\n            if (this.Class.contexts.hasOwnProperty(context)) {\r\n                if (this.Class.contexts[context].belongs && this.Class.contexts[context].belongs.toTaskSidebarCD) {\r\n                    self.params.contextsSidebarActivity.push(context);\r\n                }\r\n\r\n                if (this.Class.contexts[context].belongs && this.Class.contexts[context].belongs.toLeftSidebarCD) {\r\n                    self.params.contextsLeftSidebarCaseDashboard.push(context);\r\n                }\r\n                else {\r\n                    self.params.contextsWithoutLeftSidebarCaseDashboard.push(context);\r\n                }\r\n\r\n                if (this.Class.contexts[context].belongs && this.Class.contexts[context].belongs.toRightSidebarCD) {\r\n                    self.params.contextsRightSidebarCaseDashboard.push(context);\r\n                }\r\n                else {\r\n                    self.params.contextsWithoutRightSidebarCaseDashboard.push(context);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Returns the widget name\r\n     */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;\r\n    },\r\n\r\n    /*\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var d = $.Deferred();\r\n\r\n        var template = self.getTemplate(\"homeportal\");\r\n        self.content = template.render({});\r\n\r\n        d.resolve(self.content);\r\n\r\n        return d.promise();\r\n    },\r\n\r\n    /*\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.manager.necesaryClean();\r\n        self.manager.setLayout(self.getContent());\r\n        var servicesPD = new bizagi.workportal.services.behaviors.projectDashboard(self.dataService);\r\n        $.when(servicesPD.getContextToShow(self.params)).done(function (dataPD) {\r\n\r\n            // User doesn't have permision to access this case\r\n            if (dataPD.responseGetCaseSummaryDetails && dataPD.responseGetCaseSummaryDetails.hasAccessToCase === false) {\r\n                self.publish(\"changeWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACCESS_DENIED\r\n                });\r\n                return;\r\n            }\r\n\r\n            var currentContext = dataPD.contextToShow.toLowerCase();\r\n\r\n            if (currentContext === \"home\") {\r\n                if (!bizagiConfig.themesEnabled) {\r\n                    self.loadContext(currentContext, self, dataPD);\r\n                }\r\n                else{\r\n                    servicesPD.getCurrentTheme().done(function (theme) {\r\n                        if (theme.name == \"classic\") {\r\n                            self.loadContext(currentContext, self, dataPD);\r\n                        }\r\n                        else {\r\n                            servicesPD.setCurrentTheme(theme);\r\n                            self.setWidgetReady();\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                self.loadContext(currentContext, self, dataPD);\r\n            }\r\n\r\n            \r\n        });\r\n\r\n        self.subscribe(\"openCloseSidebar\", function () {\r\n            $(\".content-scroll\", self.getContent()).trigger(\"resize\");\r\n        });\r\n    },\r\n\r\n    loadContext: function (currentContext, self, dataPD) {\r\n        var contexts = self.Class.contexts;\r\n        var histName;\r\n        var level;\r\n\r\n        bizagi.loader.startAndThen(currentContext).then( function () {\r\n            if (dataPD.contextToShow !== self.CONTEXT_HOME) {\r\n                //Summary case return differnet result to get workitems.\r\n                dataPD.responseGetCaseSummaryDetails.hasGlobalForm = undefined;\r\n                $.extend(self.params, dataPD.responseGetCaseSummaryDetails, dataPD.params);\r\n                //histName = dataPD.nameWorkItem;\r\n            }\r\n            else {\r\n                level=0;\r\n                histName = bizagi.localization.getResource(\"workportal-widget-home-title\");\r\n            }\r\n\r\n            $(\"#ui-bizagi-wp-project-homeportal-main\").show();\r\n\r\n            $.when(self.manager.updateView({\r\n                context: dataPD.contextToShow,\r\n                data: contexts[dataPD.contextToShow],\r\n                args: $.extend(self.params, {\r\n                    histName: histName,\r\n                    level: level,\r\n                    showContextByMenuDashboard: dataPD.contextToShow\r\n                })\r\n            })).done(function () {\r\n                self.publish(\"showMainMenu\");\r\n                self.setWidgetReady();\r\n                self.manager.pub(\"homeportalReady\");\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Notifies when an event is raised\r\n     */\r\n    onNotifyChange: function (ev, params) {\r\n        var self = this,\r\n           context = params.type;\r\n\r\n        if (self.isValidContext(context)) {\r\n            //load the module\r\n            return bizagi.loader.startAndThen(context.toLowerCase()).then(function () {\r\n                var servicesPD = new bizagi.workportal.services.behaviors.projectDashboard(self.dataService);\r\n                servicesPD.removeCurrentTheme();\r\n\r\n                $.when(self.manager.updateView($.extend({\r\n                        context: context,\r\n                        data: self.Class.contexts[context]\r\n                }, params))).done(function () {\r\n                    $(\"#ui-bizagi-wp-project-homeportal-main\").show();\r\n                    self.publish(\"showMainMenu\");\r\n                });\r\n            });\r\n        }\r\n\r\n        return self.manager.emit($.extend(params, { context: context }));\r\n    },\r\n\r\n    /**\r\n     * Returns true if the context is valid\r\n     */\r\n    isValidContext: function (context) {\r\n        return (this.Class.contexts[context] !== null &&\r\n        typeof this.Class.contexts[context] == \"object\");\r\n    },\r\n\r\n    /**\r\n     * Override base dispose method\r\n     */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        self.manager.dispose();\r\n        self._super();\r\n    }\r\n});","/**\r\n *   Name: Bizagi Workportal Desktop HomePortal Controller\r\n *   Author: Danny Gonzlez\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.dialognav\", {\r\n    contexts: {\r\n        \"TEMPLATEENGINE-VIEW\": {\r\n            widgets: {\r\n                \"navigator\": {\r\n                    \"layout\": \"navigator\",\r\n                    \"name\": \"bizagi.workportal.widgets.navigator\",\r\n                    \"refresh\": false,\r\n                    \"newInstance\": true\r\n                },\r\n                \"template\": {\r\n                    \"layout\": \"template\",\r\n                    \"name\": \"bizagi.workportal.widgets.templates\",\r\n                    \"newInstance\": true\r\n                },\r\n                \"paginator\": {\r\n                    \"layout\": \"paginator\",\r\n                    \"name\": \"bizagi.workportal.widgets.paginator\",\r\n                    \"newInstance\": true\r\n                }\r\n            },\r\n            nav: { level: 1 }\r\n        }\r\n    }\r\n}, {\r\n\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.supportNav = true;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"dialognavdata\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.dialognav\").concat(\"#dialognavdata-frame\")\r\n        });\r\n\r\n        self.manager = new bizagi.workportal.widgets.manager(self.workportalFacade, self.dataService, '', params);\r\n        self.manager.sub(\"notifyChange\", $.proxy(self.onNotifyChange, self));\r\n\r\n        self.sub(\"notify\", $.proxy(self.onNotifyChange, self));\r\n    },\r\n\r\n    /**\r\n     *   Returns the widget name\r\n     */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_DIALOGNAV;\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"dialognavdata\");\r\n        self.content = template.render({});\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var paramsData = self.params.data.data || {};\r\n        var eventType = self.params.data.eventType || \"\";\r\n        var args = {\r\n            fromActionLauncher: true,\r\n            guidEntityCurrent: paramsData.guidEntityCurrent,\r\n            histName: paramsData.displayName,\r\n            level: 1,\r\n            page: 1,\r\n            reference: paramsData.reference,\r\n            referenceType: paramsData.referenceType,\r\n            showDateNavigator: false,\r\n            surrogateKey: paramsData.surrogateKey,\r\n            xpath: paramsData.xpath,\r\n            eventType: eventType\r\n        };\r\n\r\n        self.manager.setLayout(self.getContent());\r\n        self.manager.updateView({\r\n            context: \"TEMPLATEENGINE-VIEW\",\r\n            data: self.Class.contexts[\"TEMPLATEENGINE-VIEW\"],\r\n            args: args\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Notifies when an event is raised\r\n     */\r\n    onNotifyChange: function (ev, params) {\r\n        var self = this;\r\n        var context = params.type;\r\n\r\n        if (self.isValidContext(context)) {\r\n            return self.manager.updateView($.extend({\r\n                context: context,\r\n                data: self.Class.contexts[context]\r\n            }, params));\r\n        }\r\n\r\n        return self.manager.emit($.extend(params, { context: context }));\r\n    },\r\n\r\n    /**\r\n     * Returns true if the context is valid\r\n     */\r\n    isValidContext: function (context) {\r\n        var self = this;\r\n        var classContext = self.Class.contexts;\r\n\r\n        return (classContext[context] !== null && typeof classContext[context] == \"object\");\r\n    },\r\n\r\n    /**\r\n     * Override base dispose method\r\n     */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        self.manager.dispose();\r\n        self._super();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Workportal Desktop Render Widget Controller\r\n *   Author: Diego Parra (based on Edward Morales version)\r\n *   Comments:\r\n *   -   This script will provide desktop overrides to implement the render widget\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.routing.extend(\"bizagi.workportal.widgets.routing\", {}, {\r\n    init: function(workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"routing\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.routing\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        var workOnITActivitySelector = $(\"#ui-bizagi-wp-app-routing-activity-wf tbody tr\", content);\r\n        var workOnITProcessSelector = $(\"#ui-bizagi-wp-app-routing-process-wf tbody tr\", content);\r\n\r\n        var onlyUserWorkItems = (self.params.data.fromSearchWidget) ? \"false\" : \"true\";\r\n        var eventAsTasks = (self.params.data.fromSearchWidget) ? \"true\" : \"false\";\r\n\r\n        // Assing even style\r\n        $(\"tr:nth-child(even)\", content).addClass(\"event\");\r\n\r\n        $(\".workonitRow\", content).button();\r\n\r\n        $(workOnITActivitySelector).click(function() {\r\n            self.showWorkitem({\r\n                idCase: $(this).children(\":first\").children(\"#idCase\").val(),\r\n                idWorkitem: $(this).children(\":first\").children(\"#idWorkItem\").val(),\r\n                idTask: $(this).children(\":first\").children(\"#idTask\").val(),\r\n                idWorkflow: $(this).children(\":first\").children(\"#idWorkflow\").val(),\r\n                onlyUserWorkItems: onlyUserWorkItems,\r\n                eventAsTasks: eventAsTasks\r\n            });\r\n        });\r\n\r\n\r\n        $(workOnITProcessSelector).click(function() {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: $(this).children(\":first\").children(\"#idCase\").val(),\r\n                onlyUserWorkItems: onlyUserWorkItems,\r\n                eventAsTasks: eventAsTasks\r\n            });\r\n\r\n            // close dialog\r\n            self.publish(\"closeCurrentDialog\");\r\n        });\r\n    },\r\n    /*\r\n     *   Shows the rendering widget\r\n     */\r\n    showWorkitem: function(params) {\r\n        var self = this;\r\n        var referrer = self.params.referrer;\r\n        // Shows render widget\r\n        $.when(bizagi.util.autoSave()).done(function () {\r\n            $(document).data('auto-save', '');\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: params.idCase,\r\n                idWorkItem: params.idWorkitem,\r\n                idWorkflow: params.idWorkflow,\r\n                idTask: params.idTask,\r\n                referrer: referrer\r\n            });\r\n            // close dialog\r\n            self.publish(\"closeCurrentDialog\");\r\n        })\r\n    },\r\n    /**\r\n     * Show Async widget\r\n     */\r\n    showAsyncWidget: function(params) {\r\n        var self = this;\r\n\r\n        // Shows dialog widget with async template           \r\n        self.publish(\"showDialogWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC,\r\n            data: data,\r\n            modalParameters: parameters\r\n        });\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Desktop Routing Widget Controller\r\n *   Author: Diego Parra (based on Edward Morales version)\r\n *   Comments:\r\n *   -   This script will provide desktop overrides to implement the routing widget\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.render.extend(\"bizagi.workportal.widgets.render\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"release\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.render\").concat(\"#bz-wp-widget-release\"),\r\n            \"inbox-common-case-summary-subprocess\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-subprocess\"),\r\n            \"inbox-common-case-summary-assignees\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-assignees\"),\r\n            \"inbox-common-case-summary-events\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-events\"),\r\n            \"inbox-common-case-summary-activities\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-activities\"),\r\n            \"render-case-summary\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.render\").concat(\"#ui-bizagi-workportal-widget-render-case-description\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function() {\r\n        var self = this;\r\n\r\n        // Set sub-templates\t\t\r\n        self.caseSummaryTemplate = self.getTemplate(\"render-case-summary\");\r\n        self.caseSummaryTemplateSubprocess = self.getTemplate(\"inbox-common-case-summary-subprocess\");\r\n        self.caseSummaryTemplateAssigness = self.getTemplate(\"inbox-common-case-summary-assignees\");\r\n        self.caseSummaryTemplateActivities = self.getTemplate(\"inbox-common-case-summary-activities\");\r\n        self.caseSummaryTemplateEvents = self.getTemplate(\"inbox-common-case-summary-events\");\r\n        self.paginationTemplate = self.workportalFacade.getTemplate(\"inbox-common-pagination-inbox\");\r\n\r\n        var result = self._super();\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.params.referrerParams = self.params.referrerParams || {};\r\n\r\n        // Set instance variables\r\n        self.summaryDisplayed = true;\r\n\r\n        // Set scrollbars\r\n        $(\"#ui-bizagi-wp-app-render-desc-panel\", content).bizagiScrollbar();\r\n        $(\".scrollRender\", content).bizagiScrollbar({\r\n            autohide: false\r\n        });\r\n\r\n        // Attach panel slide event\r\n        self.configureSlider();\r\n\r\n        // Configure header buttons\r\n        self.configureHeader();\r\n\r\n        // Resize layout\r\n        self.resizeLayout();\r\n\r\n\r\n        //self.renderSummaryTab.scrollabletab();\r\n        // jQuery-ui tabs\r\n        window.setTimeout(function() {\r\n            if (!bizagi.util.identicalObjects($(\"#ui-bizagi-details-tabs\", content).find('.ui-tabs-nav').offset(), { top: 0, left: 0 })) {\r\n                $(\"#ui-bizagi-details-tabs\", content).tabs().scrollabletab({\r\n                    tooltipNext: self.getResource(\"workportal-scrollabletab-nex\"),\r\n                    tooltipPrevious: self.getResource(\"workportal-scrollabletab-prev\")\r\n                });\r\n            }\r\n\r\n        }, 500);\r\n\r\n        // Add click to view workflow\r\n        $(\".ui-bizagi-wp-app-inbox-cases-ico-view\", content).click(function () {\r\n            self.showGraphicQuery({ idCase: self.params.idCase, idWorkflow: self.params.idWorkflow })\r\n        });\r\n\r\n        // Bind navigation bar\r\n        // Set idcase data\r\n        $(\".back\", content).data(\"idCase\", self.getBackCase());\r\n        $(\".next\", content).data(\"idCase\", self.getNextCase());\r\n\r\n        // Bind for click event on back and next botton\r\n        $(\".back, .next\", content).click(function () {\r\n            var idCase = $(this).data(\"idCase\");\r\n            if (idCase > 0) {\r\n                self.publish(\"executeAction\", {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: idCase\r\n                });\r\n            }\r\n        });\r\n\r\n        // Bind for click event on refresh botton\r\n        $(\".refresh\", content).click(function () {\r\n            var options = {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: self.params.idCase,\r\n                idTask: self.params.idTask,\r\n                idWorkflow: self.params.idWorkflow,\r\n                idWorkItem: self.params.idWorkitem,\r\n                referrer: self.params.referrer || \"inboxGrid\"\r\n            };\r\n\r\n            self.publish(\"executeAction\", options);\r\n        });\r\n\r\n        // Bind for click event on return botton\r\n        $(\".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox h2\", content).click(function () {\r\n            if (bizagi)\r\n                if (bizagi.referrerParams)\r\n                    var widget = bizagi.referrerParams.referrer || bizagi.cookie('bizagiDefaultWidget');\r\n            if (widget == \"queryform\") widget = bizagi.workportal.currentInboxView || \"inboxGrid\";\r\n            // switch referer widget \r\n            switch (widget) {\r\n                case \"inbox\":\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: widget,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n                case \"inboxGrid\":\r\n\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: widget,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n                case \"search\":\r\n                    self.publish(\"executeAction\", {\r\n                        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,\r\n                        radNumber: bizagi.referrerParams.radNumber || \"\",\r\n                        page: bizagi.referrerParams.page || 1,\r\n                        onlyUserWorkItems: false\r\n                    });\r\n                    break;\r\n                case \"queryform\":\r\n                    self.publish(\"showDialogWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,\r\n                        queryFormAction: \"loadPrevious\"\r\n                    });\r\n                    break;\r\n                case \"folders\":\r\n                    var url = bizagi.referrerParams.urlParameters + \"&page=\" + bizagi.referrerParams.page;\r\n                    $.when(self.dataService.getCasesByFolder(url))\r\n                        .done(function (data) {\r\n                            data.customized = true;\r\n                            data.urlParameters = bizagi.referrerParams.urlParameters;\r\n\r\n                            // Define title of widget\r\n                            data.title = bizagi.referrerParams.name;\r\n\r\n                            // Set a flag here to tell the search widget that must show the ungroup case from folder (icon).\r\n                            data.casesGroupedByFolder = true;\r\n                            data.idFolder = bizagi.referrerParams.id;\r\n\r\n                            self.publish(\"changeWidget\", {\r\n                                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n                                data: data,\r\n                                referrerParams: {}\r\n                            });\r\n                        });\r\n                    break;\r\n                default:\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // Bind for hover event on refresh and return botton\r\n        $(\".refresh,.return\", content).hover(function () {\r\n            $(this).addClass(\"active\");\r\n        }, function () {\r\n            $(this).removeClass(\"active\");\r\n        });\r\n\r\n        // Bind for hover event on next and back botton\r\n        $(\".next,.back\", content).hover(\r\n            function () {\r\n                if ($(this).data(\"idCase\") > 0) {\r\n                    $(this).addClass(\"active\");\r\n                }\r\n            },\r\n            function () {\r\n                $(this).removeClass(\"active\");\r\n            });\r\n\r\n        if (self.dataService.lastQueryFullKey != null) {\r\n            $(\"#bt-case-action-showquery\", content).click(function () {\r\n                self.publish(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,\r\n                    queryFormAction: \"loadPrevious\"\r\n                });\r\n\r\n            });\r\n        }\r\n\r\n        // Bind botton summary actions\r\n        $(\"#bt-case-action-log\", content).click(function () {\r\n\r\n            self.publish(\"showDialogWidget\", {\r\n                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG,\r\n                data: { \"idCase\": self.params.idCase, \"idWorkflow\": self.params.idWorkflow },\r\n                modalParameters: {\r\n                    title: bizagi.localization.getResource(\"render-actions-log\")\r\n                }\r\n            });\r\n\r\n        });\r\n\r\n        $(\"#bt-case-action-reassing\", content).click(function () {\r\n            var idCase = self.params.idCase;\r\n            var idWorkItem = self.params.idWorkitem;\r\n            var idtask = self.params.idtask;\r\n           $.when(self.publish(\"showDialogWidget\", {\r\n                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE,\r\n                data: { \"idCase\": idCase,\r\n                    \"idWorkItem\": idWorkItem\r\n                },\r\n                closeVisible: false,\r\n                maximize: true,\r\n                modalParameters: {\r\n                    title: bizagi.localization.getResource(\"render-actions-reassign\"),\r\n                    width: \"910px\",\r\n                    id: \"CaseAdmin\"\r\n                }\r\n            }));\r\n\r\n\r\n\r\n        });\r\n\r\n        $(\"#bt-case-action-release\", content).click(function (e) {\r\n            e.stopPropagation();\r\n            var releaseConfirmTemplate = self.getTemplate(\"release\");\r\n            var confirmContent = $.tmpl(releaseConfirmTemplate);\r\n\r\n            // Open dialog with confirm message\r\n            $(confirmContent).dialog({\r\n                resizable: false,\r\n                modal: true,\r\n                title: self.getResource(\"render-actions-release\"),\r\n                buttons: [\r\n                    {\r\n                        text: self.getResource(\"workportal-widget-dialog-box-release-ok\"),\r\n                        click: function () {\r\n                            var params = {\r\n                                idCase: self.params.idCase,\r\n                                idWorkItem: self.params.idWorkitem\r\n                            };\r\n                            $.when(self.dataService.releaseActivity(params)).done(function (data) {\r\n                                var status = data.status ? data.status : '';\r\n                                switch (status) {\r\n                                    case \"Success\":\r\n                                        //go to inbox\r\n                                        self.publish(\"changeWidget\", {\r\n                                            widgetName: bizagi.workportal.currentInboxView\r\n                                        });\r\n                                        break;\r\n\r\n                                    case \"ConfigurationError\":\r\n                                        var message = self.getResource(\"workportal-widget-dialog-box-release-configuration-error-message\").replace(\"{0}\", params.idWorkItem);\r\n                                        bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), 'error', false);\r\n                                        break;\r\n\r\n                                    default:\r\n                                        var message = self.getResource(\"workportal-widget-dialog-box-release-error-message\").replace(\"{0}\", params.idWorkItem);\r\n                                        bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), 'error', false);\r\n                                        break;\r\n                                }\r\n                            }).fail(function () {\r\n                                var message = self.getResource(\"workportal-widget-dialog-box-release-error-message\").replace(\"{0}\", params.idWorkItem);\r\n                                bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), 'error', false);\r\n                            }\r\n                            );\r\n                            $(this).dialog(\"close\");\r\n                        }\r\n                    },\r\n                    {\r\n                        text: self.getResource(\"workportal-widget-dialog-box-release-cancel\"),\r\n                        click: function () {\r\n                            $(this).dialog(\"close\");\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n        });\r\n\r\n\r\n\r\n        self.printFormCommand = new bizagi.workportal.command.printform(self.workportalFacade);\r\n\r\n        $(\"#bt-case-action-print\", content).click(function () {\r\n\r\n            var printParams = { idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem,\r\n                idTask: self.params.idTask\r\n            };\r\n\r\n            self.printFormCommand.print(printParams);\r\n\r\n        });\r\n\r\n        $(\"#bt-case-action-help\", content).click(function () {\r\n            var url = $(this).find(\"#helpUrl\").val();\r\n\r\n            self.publish(\"showDialogWidget\", {\r\n                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                widgetURL: url,\r\n                modalParameters: {\r\n                    title: bizagi.localization.getResource(\"render-actions-help\")\r\n                }\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   configures the slide event\r\n    */\r\n    configureSlider: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content) {\r\n            return;\r\n        }\r\n\r\n        var summaryContainer = self.getComponentContainer(\"summary\");\r\n        var sliderPanel = $(\"#panelArrowContainer\", content);\r\n\r\n        sliderPanel.click(function () {\r\n            if (summaryContainer.is(\":visible\")) {\r\n                // Hide left panel\r\n                self.hideSummary();\r\n\r\n            } else {\r\n                // Show left panel\r\n                self.showSummary();\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Hides the summary component\r\n    */\r\n    hideSummary: function (animate) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content) {\r\n            return;\r\n        }\r\n\r\n        var summaryContainer = self.getComponentContainer(\"summary\");\r\n        var renderPanel = $(\"#ui-bizagi-wp-app-render-form\", content);\r\n        var sliderPanel = $(\"#panelArrowContainer\", content);\r\n        var panelArrow = $(\"#panelArrow\", content);\r\n        animate = typeof (animate) !== \"undefined\" ? animate : false;\r\n\r\n        if (!self.summaryDisplayed) {\r\n            return;\r\n        }\r\n\r\n        if (animate) {\r\n            // Hide description panel\r\n            summaryContainer.parent().hide('drop', {}, 300);\r\n\r\n            // Run animation\r\n            $.when(sliderPanel.animate({\r\n                left: \"0px\"\r\n            }, 300))\r\n                .done(function () {\r\n                    renderPanel.addClass(\"ui-bizagi-state-extended\");\r\n                    $(\"#ui-bizagi-wp-app-render-form-content\", content).css(\"padding-left\", \"0px\");\r\n                });\r\n\r\n        } else {\r\n            // Hide description panel\r\n            summaryContainer.parent().hide();\r\n            sliderPanel.css(\"left\", \"0px\");\r\n            renderPanel.addClass(\"ui-bizagi-state-extended\");\r\n            $(\"#ui-bizagi-wp-app-render-form-content\", content).css(\"padding-left\", \"0px\");\r\n        }\r\n\r\n        // Change arrows\r\n        panelArrow.removeClass(\"panelArrowLeft\");\r\n        panelArrow.addClass(\"panelArrowRight\");\r\n\r\n        // Turn off flag\r\n        self.summaryDisplayed = false;\r\n\r\n        // Trigger render resize\r\n        if (self.renderingFacade) {\r\n            self.renderingFacade.resize({\r\n                forceResize: true\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *   Show the summary component\r\n    */\r\n    showSummary: function (animate) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content) {\r\n            return;\r\n        }\r\n\r\n        var summaryContainer = self.getComponentContainer(\"summary\");\r\n        var renderPanel = $(\"#ui-bizagi-wp-app-render-form\", content);\r\n        var sliderPanel = $(\"#panelArrowContainer\", content);\r\n        var panelArrow = $(\"#panelArrow\", content);\r\n        animate = typeof (animate) !== \"undefined\" ? animate : false;\r\n\r\n        if (self.summaryDisplayed) {\r\n            return;\r\n        }\r\n\r\n        // Show description panel\r\n        summaryContainer.parent().show();\r\n        $(\"#ui-bizagi-wp-app-render-form-content\", content).css(\"padding-left\", \"380px\");\r\n        sliderPanel.css(\"left\", \"380px\");\r\n        renderPanel.removeClass(\"ui-bizagi-state-extended\");\r\n\r\n        // Change arrows\r\n        panelArrow.removeClass(\"panelArrowRight\");\r\n        panelArrow.addClass(\"panelArrowLeft\");\r\n\r\n        // Turn on flag\r\n        self.summaryDisplayed = true;\r\n\r\n\r\n        // jQuery-ui tabs scrollable\r\n        if (!($(\"#ui-bizagi-details-tabs\", content).closest(\"#stTabswrapper\").length > 0)) {\r\n            $(\"#ui-bizagi-details-tabs\", content).tabs().scrollabletab({\r\n                tooltipNext: self.getResource(\"workportal-scrollabletab-nex\"),\r\n                tooltipPrevious: self.getResource(\"workportal-scrollabletab-prev\")\r\n            });\r\n        }\r\n\r\n        // Trigger render resize\r\n        if (self.renderingFacade) {\r\n            self.renderingFacade.resize({\r\n                forceResize: true\r\n            });\r\n        }\r\n\r\n    },\r\n    /*\r\n    *   Configure header for the widget\r\n    */\r\n    configureHeader: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        // Configure back button\r\n        //        $(\"#ui-bizagi-wp-app-inbox-bt-back\", content).click(function() {\r\n        //            self.publish(\"changeWidget\", {\r\n        //                widgetName: bizagi.workportal.currentInboxView\r\n        //            });\r\n        //        });\r\n    },\r\n    /*\r\n    *   When the window resizes, runs this method to adjust stuff in each controller or widget\r\n    *   Override when needed\r\n    */\r\n    performResizeLayout: function () {\r\n        var self = this;\r\n        var windowWidth = $(window).width();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // If window width is less or equals 1366 hide the summary\r\n        if (windowWidth <= 1366) {\r\n            if (self.summaryDisplayed) {\r\n                self.hideSummary(false);\r\n            } else {\r\n                // Trigger render resize\r\n                if (self.renderingFacade) {\r\n                    self.renderingFacade.resize({\r\n                        forceResize: true\r\n                    });\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (!self.summaryDisplayed) {\r\n                self.showSummary(false);\r\n            }\r\n            else {\r\n                // Trigger render resize\r\n                if (self.renderingFacade) {\r\n                    self.renderingFacade.resize({\r\n                        forceResize: true\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Opens the workportal old form in a window\r\n    */\r\n    openOldWorkportalForm: function () {\r\n        var self = this;\r\n        //var url = BIZAGI_PATH_TO_BASE + \"defaulthtml.aspx?FrameURL=App/ListaDetalle/Detalle.aspx?idCase=\" + self.params.idCase;\r\n        var url = BIZAGI_PATH_TO_BASE + \"App/ListaDetalle/Detalle.aspx?PostBack=1&idCase=\" + self.params.idCase;\r\n        if (typeof (self.params.idWorkitem) != 'undefined') {\r\n            url = url + \"&idWorkitem=\" + self.params.idWorkitem;\r\n        }\r\n        if (typeof (self.params.idTask) != 'undefined') {\r\n            url = url + \"&idTask=\" + self.params.idTask;\r\n        }\r\n        if (false) {\r\n            url = url + \"&isSummary=1\";\r\n\r\n        }\r\n\r\n        alert(url);\r\n        window.open(url, \"oldStyleBizAgi\", \"width=1024,height=768, Menubar=NO, Location=NO, Status=NO\");\r\n    },\r\n    /*\r\n    *  Navigation options\r\n    */\r\n    getListKey: function () {\r\n        var self = this;\r\n        bizagi.lstIdCases = bizagi.lstIdCases || {};\r\n        if (bizagi.lstIdCases.length > 1) {\r\n            for (var i = 0; i < bizagi.lstIdCases.length; i++) {\r\n                if (self.params.idCase == bizagi.lstIdCases[i]) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return -1;\r\n    },\r\n    getNextCase: function () {\r\n        var self = this;\r\n        var nextIdCase = 0;\r\n        var key = self.getListKey();\r\n\r\n        // Check if last element\r\n        if (bizagi.lstIdCases.length == (key + 1) || bizagi.lstIdCases.length == 1) {\r\n            nextIdCase = -1;\r\n        } else {\r\n            nextIdCase = bizagi.lstIdCases[key + 1];\r\n        }\r\n\r\n        return nextIdCase;\r\n    },\r\n    getBackCase: function () {\r\n        var self = this;\r\n        var prevIdCase = 0;\r\n        var key = self.getListKey();\r\n\r\n        // Check if first element\r\n        if (key == 0) {\r\n            prevIdCase = -1;\r\n        } else {\r\n            prevIdCase = bizagi.lstIdCases[key - 1] || -1;\r\n        }\r\n\r\n        return prevIdCase;\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Start Form Widget Controller\r\n *   Author: Fabian Moreno (based on Diego Parra version)\r\n *   Comments:\r\n *   -   This script will provide start form widget\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.startForm.extend(\"bizagi.workportal.widgets.startForm\", {}, {\r\n    /*\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.params.referrerParams = self.params.referrerParams || {};\r\n\r\n        $(\"#ui-bizagi-wp-app-render-form-content\", content).css(\"padding-left\", \"0px\");\r\n        $('.renderNavigation .back,.renderNavigation .next', content).hide();\r\n    },\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Workportal Desktop Routing Widget Controller\r\n *   Author: Diego Parra (based on Edward Morales version)\r\n *   Comments:\r\n *   -   This script will provide desktop overrides to implement the routing widget\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.renderform.extend(\"bizagi.workportal.widgets.renderform\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function(workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"renderform\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.renderform\").concat(\"#ui-bizagi-workportal-widget-renderform\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    /*\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function(){ \r\n        var self = this;\r\n        var content = self.getContent();\r\n        \r\n        self.params.referrerParams = self.params.referrerParams || {};\r\n    \t\r\n        // Set instance variables\r\n        self.summaryDisplayed = true;-\r\n    \t\r\n        // Set scrollbars\r\n        $(\"#ui-bizagi-wp-app-render-desc-panel\", content).bizagiScrollbar();\r\n        $(\".scrollRender\", content).bizagiScrollbar({\r\n            autohide:false\r\n        });\r\n    \r\n        // Attach panel slide event\r\n        self.configureSlider();\r\n    \r\n        // Configure header buttons\r\n        self.configureHeader();\r\n        \r\n        // Resize layout\r\n        self.resizeLayout();\r\n    \t\r\n            \r\n        //self.renderSummaryTab.scrollabletab();\r\n        // jQuery-ui tabs\r\n        $( \"#ui-bizagi-details-tabs\",content).tabs().scrollabletab({\r\n            tooltipNext: self.getResource(\"workportal-scrollabletab-nex\"),\r\n            tooltipPrevious:self.getResource(\"workportal-scrollabletab-prev\")\r\n        });\r\n                                \r\n            \r\n        // Add click to view workflow\r\n        $(\".ui-bizagi-wp-app-inbox-cases-ico-view\",content).click(function(){\r\n            var baseUrl = \"App/Cockpit/graphicquery.aspx?analysisType=2&CaseId=\";\r\n            window.open(baseUrl+self.params.idCase);\r\n        });\r\n        \r\n        // Bind navigation bar\r\n        // Set idcase data\r\n        $(\".back\",content).data(\"idCase\",self.getBackCase());\r\n        $(\".next\",content).data(\"idCase\",self.getNextCase());\r\n        \r\n        // Bind for click event on back and bext botton\r\n        $(\".back, .next\",content).click(function(){\r\n            var idCase = $(this).data(\"idCase\");\r\n            if( idCase > 0){\r\n                self.publish(\"executeAction\", {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: idCase\r\n                });\r\n            }\r\n        });          \r\n        \r\n        // Bind for click event on refresh botton\r\n        $(\".refresh\",content).click(function(){\r\n            self.publish(\"changeWidget\", {\r\n                widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem,\r\n                idTask: self.params.idTask,\r\n                referrer: bizagi.referrerParams.referrer\r\n            }); \r\n        });\r\n        \r\n        // Bind for click event on return botton\r\n        $(\".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox h2\",content).click(function(){\r\n\t\t\tvar widget = bizagi.referrerParams.referrer || bizagi.cookie('bizagiDefaultWidget');\r\n            // switch referer widget\r\n            switch(widget){\r\n                case \"inbox\":\r\n                    self.publish(\"changeWidget\", { \r\n                        widgetName : widget,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n                case \"inboxGrid\":\r\n                    self.publish(\"changeWidget\", { \r\n                        widgetName : widget,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n                case \"search\":\r\n                    self.publish(\"executeAction\", {\r\n                        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,\r\n                        radNumber:bizagi.referrerParams.radNumber || \"\" ,\r\n                        page:bizagi.referrerParams.page || 1 ,\r\n                        onlyUserWorkItems:false\r\n                    });\r\n                    break;\r\n                case \"queryform\":\r\n                    self.publish(\"showDialogWidget\", {\r\n                        widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,\r\n                        queryFormAction: \"loadPrevious\"\r\n                    });                    \r\n                    break;\r\n                case \"folders\":\r\n                    var url = bizagi.referrerParams.urlParameters+\"&page=\"+bizagi.referrerParams.page;\r\n                    $.when(self.dataService.getCasesByFolder(url))\r\n                    .done(function(data){\r\n                        data.customized = true; \r\n                        data.urlParameters = bizagi.referrerParams.urlParameters\r\n                        \r\n                        // Define title of widget\r\n                        data.title = bizagi.referrerParams.name;\r\n\r\n                        // Set a flag here to tell the search widget that must show the ungroup case from folder (icon).\r\n                        data.casesGroupedByFolder = true;\r\n                        data.idFolder = bizagi.referrerParams.id;\r\n\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n                            data: data,\r\n                            referrerParams: {}\r\n                        });    \r\n                    });\r\n                    break;\r\n                default:\r\n                    self.publish(\"changeWidget\", { \r\n                        widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n        \r\n        // Bind for hover event on refresh and return botton\r\n        $(\".refresh,.return\",content).hover(function(){\r\n            $(this).addClass(\"active\");                    \r\n        },function(){            \r\n            $(this).removeClass(\"active\");                    \r\n        });\r\n        \r\n        // Bind for hover event on next and back botton\r\n        $(\".next,.back\",content).hover(\r\n        function(){\r\n            if($(this).data(\"idCase\") > 0){\r\n                $(this).addClass(\"active\");                    \r\n            }\r\n        },\r\n        function(){\r\n            $(this).removeClass(\"active\");\r\n        });\r\n        \r\n        if (self.dataService.lastQueryFullKey != null) {\r\n            $(\"#bt-case-action-showquery\", content).click(function() {\r\n                self.publish(\"showDialogWidget\", {\r\n                    widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,\r\n                    queryFormAction: \"loadPrevious\"\r\n                });                    \r\n            \r\n            });\r\n        }\r\n        \r\n        // Bind botton summary actions\r\n        $(\"#bt-case-action-log\",content).click(function(){\r\n            var url =\"App/Log/log.aspx?idCase=\"+self.params.idCase+\"&logtype=s\";\r\n               \r\n            self.publish(\"showDialogWidget\", {\r\n                widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                widgetURL: url,\r\n                modalParameters: {\r\n                    title: bizagi.localization.getResource(\"render-actions-log\")\r\n                },\r\n                afterLoad: function (params) {\r\n                    // This script will execute inside the iframe context\r\n            \t\t\r\n                    // Hack this method because it will try to change iframe location\r\n                    // instead of this we will for to close the current dialog\r\n                    this.backURL = function() {\r\n                        // Close current dialog\r\n                        params.controller.publish(\"closeCurrentDialog\");\r\n                    };\r\n                }\r\n            });                    \r\n        });\r\n            \r\n        $(\"#bt-case-action-reassing\",content).click(function(){                    \r\n            var url =\"App/Admin/ListUsers.aspx?WorkItemAdmin=\"+self.params.idCase+\"|\"+self.params.idWorkitem+\"|&UserAdminAction=2\";\r\n               \r\n            self.publish(\"showDialogWidget\", {\r\n                widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                widgetURL: url,\r\n                modalParameters: {\r\n                    title: bizagi.localization.getResource(\"render-actions-reassign\")\r\n                },\r\n                onClose: function () {\r\n                    self.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING, {\r\n                        idCase: self.params.idCase,\t\r\n                        idWorkitem: self.params.idWorkitem,\t\r\n                        idTask: self.params.idTask\r\n                    });\r\n                }\r\n            });                    \r\n        });\r\n            \r\n//        $(\"#bt-case-action-print\",content).click(function(){\r\n//            var url =\"App/ListaDetalle/PrintVersion.aspx?PostBack=1&idCase=\"+self.params.idCase+\"&idWorkitem=\"+self.params.idWorkitem+\"&idTask=\"+self.params.idTask;\r\n//\r\n//\r\n//\r\n//            self.publish(\"showDialogWidget\", {\r\n//                widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n//                widgetURL: url,\r\n//                modalParameters: {\r\n//                    title: bizagi.localization.getResource(\"render-actions-print\")\r\n//                },\r\n//                buttons: [\r\n//                    {\r\n//                        text: bizagi.localization.getResource(\"workportal-widget-dialog-box-print\"),\r\n//                        click: function() {\r\n//                            $(window.frames[\"iframe\"]).focus();\r\n//                            window.frames[\"iframe\"].print();\r\n//                        }\r\n//                    }\r\n//                ]\r\n//            });\r\n//        });\r\n        $(\"#bt-case-action-print\",content).click(function(){\r\n            var url =\"App/Admin/ListUsers.aspx?WorkItemAdmin=\"+self.params.idCase+\"|\"+self.params.idWorkitem+\"|&UserAdminAction=2\";\r\n\r\n            self.publish(\"showDialogWidget\", {\r\n                widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                widgetURL: url,\r\n                modalParameters: {\r\n                    title: bizagi.localization.getResource(\"render-actions-reassign\")\r\n                },\r\n                onClose: function () {\r\n                    self.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING, {\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem,\r\n                        idTask: self.params.idTask\r\n                    });\r\n                }\r\n            });\r\n        });\r\n        \r\n        \r\n        \r\n        \r\n        \r\n        $(\"#bt-case-action-help\",content).click(function(){\r\n            var url =$(this).find(\"#helpUrl\").val();\r\n               \r\n            self.publish(\"showDialogWidget\", {\r\n                widgetName : bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                widgetURL: url,\r\n                modalParameters: {\r\n                    title: bizagi.localization.getResource(\"render-actions-help\")\r\n                }\r\n            });                    \r\n        });\r\n    },\r\n\r\n    /*\r\n     *   configures the slide event\r\n     */\r\n    configureSlider: function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content) return;\r\n        \r\n        var summaryContainer = self.getComponentContainer(\"summary\");\r\n        var sliderPanel = $(\"#panelArrowContainer\", content);\r\n    \t\r\n        sliderPanel.click(function(){\r\n            if(summaryContainer.is(\":visible\")){\r\n                // Hide left panel\r\n                self.hideSummary();\r\n            \r\n            } else {\r\n                // Show left panel\r\n                self.showSummary();\r\n            }\r\n        });\r\n    },\r\n\t\r\n    /*\r\n     *   Hides the summary component\r\n     */\r\n    hideSummary: function(animate) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content) return;\r\n    \t\r\n        var summaryContainer = self.getComponentContainer(\"summary\");\r\n        var renderPanel = $(\"#ui-bizagi-wp-app-render-form\", content);\r\n        var sliderPanel = $(\"#panelArrowContainer\", content);\r\n        var panelArrow = $(\"#panelArrow\", content);\r\n        \r\n        if (!self.summaryDisplayed) return;\r\n\t\t\r\n        // Hide description panel\r\n        summaryContainer.parent().hide();\r\n        sliderPanel.css(\"left\", \"0px\");\r\n        renderPanel.addClass(\"ui-bizagi-state-extended\");\r\n        $(\"#ui-bizagi-wp-app-render-form-content\", content).css(\"padding-left\", \"0px\");\r\n        \r\n        // Change arrows\r\n        panelArrow.removeClass(\"panelArrowLeft\");\r\n        panelArrow.addClass(\"panelArrowRight\");\r\n\t\t\r\n        // Turn off flag\r\n        self.summaryDisplayed = false;\r\n        \r\n        // Trigger render resize\r\n        if (self.renderingFacade) self.renderingFacade.resize({\r\n            forceResize:  true\r\n        });\r\n    },\r\n\t\r\n    /*\r\n     *   Show the summary component\r\n     */\r\n    showSummary: function(animate) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content) return;\r\n    \t\r\n        var summaryContainer = self.getComponentContainer(\"summary\");\r\n        var renderPanel = $(\"#ui-bizagi-wp-app-render-form\", content);\r\n        var sliderPanel = $(\"#panelArrowContainer\", content);\r\n        var panelArrow = $(\"#panelArrow\", content);\r\n        animate = typeof(animate) !== \"undefined\" ? animate: false;\r\n\t\t\r\n        if (self.summaryDisplayed) return;\r\n\t\t\r\n        if (animate) {\r\n            // Show description panel\r\n            summaryContainer.parent().show('drop', { }, 500);\r\n\r\n            // Resize render layout to set padding 400px\r\n            $(\"#ui-bizagi-wp-app-render-form-content\", content).css(\"padding-left\", \"380px\");\r\n\r\n            // Run animation\r\n            $.when(sliderPanel.animate({\r\n                left: \"380px\"\r\n            }, 300))\r\n            .done(function() {\r\n                renderPanel.removeClass(\"ui-bizagi-state-extended\");\r\n            });\r\n\t\t\r\n        } else {\r\n            // Show description panel\r\n            summaryContainer.parent().show();\r\n            $(\"#ui-bizagi-wp-app-render-form-content\", content).css(\"padding-left\", \"380px\");\r\n            sliderPanel.css(\"left\", \"380px\");\r\n            renderPanel.removeClass(\"ui-bizagi-state-extended\");\r\n        }\r\n\r\n        // Change arrows\r\n        panelArrow.removeClass(\"panelArrowRight\");\r\n        panelArrow.addClass(\"panelArrowLeft\");\r\n\t\t\r\n        // Turn on flag\r\n        self.summaryDisplayed = true;\r\n    \t\r\n        // Trigger render resize\r\n        if (self.renderingFacade) self.renderingFacade.resize({\r\n            forceResize:  true\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Configure header for the widget\r\n     */\r\n    configureHeader: function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n    \r\n        // Configure back button\r\n        //        $(\"#ui-bizagi-wp-app-inbox-bt-back\", content).click(function() {\r\n        //            self.publish(\"changeWidget\", {\r\n        //                widgetName: bizagi.workportal.currentInboxView\r\n        //            });\r\n        //        });\r\n    },\r\n    \t\r\n    \t  \r\n    /*\r\n     *   When the window resizes, runs this method to adjust stuff in each controller or widget\r\n     *   Override when needed  \r\n     */\r\n    performResizeLayout: function() {\r\n        var self = this;\r\n        var windowWidth = $(window).width();\r\n    \r\n        // Call base\r\n        this._super();\r\n    \t\r\n        // If window width is less or equals 1024 hide the summary\r\n        if (windowWidth <= 1024) {\r\n            if (self.summaryDisplayed) {\r\n                self.hideSummary(false);\r\n            } else {\r\n                // Trigger render resize\r\n                if (self.renderingFacade) self.renderingFacade.resize({\r\n                    forceResize:  true\r\n                });\r\n            }\r\n        \r\n        } else {\r\n            if (!self.summaryDisplayed) {\r\n                self.showSummary(false);\r\n            }\r\n            else {\r\n                // Trigger render resize\r\n                if (self.renderingFacade) self.renderingFacade.resize({\r\n                    forceResize:  true\r\n                });\r\n            }\r\n        }\r\n    },\r\n\t\r\n    /*\r\n     *   Opens the workportal old form in a window\r\n     */\r\n    openOldWorkportalForm: function () {\r\n        var self = this;\r\n        var url = BIZAGI_PATH_TO_BASE + \"defaulthtml.aspx?FrameURL=App/ListaDetalle/Detalle.aspx?idCase=\" + self.params.idCase;\r\n        window.open(url, \"oldStyleBizAgi\", \"width=1024,height=768, Menubar=NO, Location=NO, Status=NO\");\r\n    },\r\n    \r\n    /*\r\n     *  Navigation options\r\n     */\r\n    getListKey: function(){\r\n        var self =  this;\r\n        bizagi.lstIdCases = bizagi.lstIdCases || {};\r\n        if(bizagi.lstIdCases.length > 1){\r\n            for(var i=0; i < bizagi.lstIdCases.length; i++){\r\n                if( self.params.idCase == bizagi.lstIdCases[i] ){\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return -1;\r\n    },\r\n    \r\n    getNextCase: function(){\r\n        var self = this;\r\n        var nextIdCase = 0;\r\n        var key = self.getListKey();\r\n        \r\n        // Check if last element \r\n        if(bizagi.lstIdCases.length == (key+1) || bizagi.lstIdCases.length == 1){\r\n            nextIdCase = -1;\r\n        }else{\r\n            nextIdCase = bizagi.lstIdCases[key+1];            \r\n        }        \r\n        \r\n        return nextIdCase;\r\n    },\r\n    \r\n    getBackCase: function(){\r\n        var self = this;\r\n        var prevIdCase = 0;\r\n        var key = self.getListKey();\r\n        \r\n        // Check if first element \r\n        if(key == 0){\r\n            prevIdCase = -1;\r\n        }else{\r\n            prevIdCase = bizagi.lstIdCases[key-1];            \r\n        }        \r\n        \r\n        return prevIdCase;\r\n    }\r\n    \r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Workportal Desktop my search search lists Widget Controller\r\n *   Author: Andres Fernando Munoz\r\n *   Comments:\r\n *   -   This script will provide desktop overrides to implement the my search search lists widget\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.mySearchList.extend(\"bizagi.workportal.widgets.mySearchList\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"mySearchListWrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.mySearchList\").concat(\"#ui-bizagi-workportal-widget-mysearchlist-searchlists-wrapper\"),\r\n            \"mySearchList\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.mySearchList\").concat(\"#ui-bizagi-workportal-widget-mysearchlist-searchlists\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.loadtemplates();\r\n        self.renderSearchLists();\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        self.mySearchListTmpl = self.getTemplate(\"mySearchList\");\r\n    },\r\n\r\n    renderSearchLists: function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        $.when(self.dataService.getSearchLists()).done(function (data) {\r\n            var searchLists = data;\r\n            var $searchLists = $.tmpl(self.mySearchListTmpl, {searchLists: searchLists});\r\n\r\n            content.append($searchLists);\r\n            self.configureHandlers();\r\n        });\r\n    },\r\n\r\n    closeModal: function () {\r\n        var self = this;\r\n        var modal = $(self.content).closest('.modal');\r\n\r\n        modal.hide();\r\n    },\r\n\r\n    configureHandlers: function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        $(\".ui-bizagi-wp-widget-my-search-list-item\", content).on('click', $.proxy(self.onListItemClick, self));\r\n        $(\"#menuQuery\").keypress(function () { //Hides the widget when the user types something\r\n            self.closeModal();\r\n        });\r\n    },\r\n\r\n    onListItemClick: function (ev) {\r\n        var self = this;\r\n        self.closeModal();//Hides the widget when the user selects any item on the list\r\n\r\n        var $target = $(ev.currentTarget);\r\n        var guidform = $target.data(\"guidform\");\r\n        var id = $target.data(\"id\");\r\n        var displayname = $target.data(\"displayname\");\r\n        var guidEntity = $target.data(\"guidentity\");\r\n\r\n        var publishParams = {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_LOADFORM,\r\n            summaryDecorator:false,\r\n            guidForm: guidform,\r\n            displayname: displayname,\r\n            guidEntity: guidEntity,\r\n            closeVisible: false,\r\n            buttons: [\r\n                {\r\n                    text: bizagi.localization.getResource('workportal-menu-search'),\r\n                    click: function(e) {\r\n                        var that = this;\r\n                        var widget = $(this).dialog(\"option\",\"widget\");\r\n                        var form = widget.form || {};\r\n\r\n                        if (Object.keys(form).length !== 0) {\r\n\r\n                            if(form && form.validateForm()) {\r\n                                var renderValues = [];\r\n                                $.forceCollectData = true;\r\n                                form.collectRenderValuesQueryForm(renderValues);\r\n                                $.forceCollectData = false;\r\n\r\n                                var filterObject = [];\r\n                                var metadataFilters = [];\r\n\r\n                                $.each(renderValues, function (i, item) {\r\n                                    if (typeof item.value !== 'function') {\r\n                                        var controls = form.getRenders(item.xpath);\r\n                                        var control = self.getFilterControl(controls, item);\r\n\r\n                                        self.dataService.defineFilterObject({ properties: control.properties, value: control.value }, filterObject, function (filter) {\r\n                                            metadataFilters.push($.extend(filter, { id: control.properties.id, rangeQuery: control.properties.rangeQuery, displayValue: control.getDisplayValue(), displayName: control.properties.displayName, editable: !!control.properties.editable }));\r\n                                        });\r\n                                    }\r\n                                });\r\n\r\n                                self.performQuery({ guidSearch: id, guidForm: guidform, guidEntity: guidEntity, displayname: displayname, metadataFilters: metadataFilters, filters: filterObject, page: 1, pageSize: 10, calculateFilters: true, histName: displayname, onlyLocalResults: true });\r\n\r\n                                $(that).dialog('close');\r\n                            }\r\n                           \r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    text: bizagi.localization.getResource(\"workportal-widget-dialog-box-close\"),\r\n                    click: function () {\r\n                        $(this).dialog('close');\r\n                    }\r\n                }\r\n            ],\r\n            modalParameters: {\r\n                title: displayname\r\n            }\r\n        }\r\n\r\n        self.publish(\"showDialogWidget\", publishParams);\r\n        self.publish(\"onWidgetIncludedInDOM\");\r\n    },\r\n\r\n    performQuery: function (params) {\r\n        var self = this;\r\n        var dataParams = {\r\n            \"type\": \"SEARCH-ENGINE-VIEW\",\r\n            \"args\": params\r\n        };\r\n\r\n        $.when(self.publish(\"changeWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL\r\n        })).done(function () {\r\n            var homeportalInstance = bizagi.injector.get('homeportal');\r\n            var widgetManager = bizagi.injector.get('widgetManager');\r\n            widgetManager._context = \"home\";\r\n\r\n            $.when(homeportalInstance.isReady()).done(function(){\r\n                homeportalInstance.pub(\"notify\", dataParams);\r\n            })\r\n        });\r\n    },\r\n\r\n    getFilterControl: function(controls, itemFilter) {\r\n        if (controls.length === 1) {\r\n            return controls[0];\r\n        } else {\r\n            var searchTypeFilter = itemFilter.searchType.toUpperCase();\r\n\r\n            for (i = 0; i < controls.length; i++) {\r\n                var properties = controls[i].properties\r\n                var searchType = properties.typeSearch || properties.rangeQuery || \"NONE\";\r\n                searchType = searchType.toUpperCase();\r\n\r\n                if (searchType === searchTypeFilter && !bizagi.util.isEmpty(controls[i].value)) {\r\n                    return controls[i];\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *\r\n */\r\nbizagi.workportal.widgets.loadForm.extend(\"bizagi.workportal.widgets.loadForm\", {\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Workportal Desktop New Case Widget Controller\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script will provide sub menu widget\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.subMenu.extend(\"bizagi.workportal.widgets.subMenu\", {}, {\r\n    /**\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        self.notifier = bizagi.injector.get(\"notifier\");\r\n\r\n\t\t// render sub menu content\r\n\t\tself.renderSubMenuContent();\r\n\r\n\t\tself.scrollVertical({\r\n\t\t\t\"autohide\": false\r\n\t\t});\r\n\t},\r\n\tscrollVertical: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\r\n\t\t$(\"#categories\", content).bizagiScrollbar({\r\n\t\t\t\"autohide\": false\r\n\t\t});\r\n\t},\r\n\t/*\r\n\t *   Show content for sub menu item\r\n\t */\r\n\r\n\trenderSubMenuContent: function() {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar listTemplate = self.workportalFacade.getTemplate(self.isAdminMenu()?\"menu.submenu.cathegories.list\":\"menu.submenu.list\");\r\n\t\tvar listContainer = $(\"#categories\", content);\r\n\t\tvar data = {};\r\n\r\n\t\tvar callBack = {\r\n\t\t\t\"ThemeBuilder\": function(args) {\r\n\t\t\t\targs = args || {};\r\n\t\t\t\tif(args.url) {\r\n\t\t\t\t\targs.windowOpenBlank.location; //Prevent security message browsers open popups. Reason: window.open after callbacks.\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\"asyncECMUpload\": function(args) {\r\n\t\t\t\targs = args || {};\r\n\t\t\t\tself.showWidgetPopup(args.url, args.title, args.id);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// TODO: SNAKE-1296 remove these lines\r\n\t\ttry {\r\n\t\t\tif(bizagi.override.enableMultipleCasesReassigment) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"CaseAdmin\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-adminReassignCases\"),\r\n\t\t\t\t\tcategoryUrl: \"adminReassignCases\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcallBack.CaseAdmin = function(args) {\r\n\t\t\t\t\targs = args || {};\r\n\t\t\t\t\tself.showWidgetPopup(args.url, args.title, args.id);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\t// Nothing todo, just skip this option in menu\r\n\t\t}\r\n\r\n\t\t//DRAGON-152 Adidas - Async ECM\r\n\t\ttry {\r\n\t\t\tif(bizagi.override.enableAsyncECMUploadJobs) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"asyncECMUpload\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-asyncECMUpload\"),\r\n\t\t\t\t\tcategoryUrl: \"asyncECMUpload\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\t// Nothing todo, just skip this option in menu\r\n\t\t}\r\n\r\n\r\n\t\ttry {\r\n\r\n\t\t\t//delete frankenstein implementations\r\n\t\t\t// revisar el contenido de self.params.options.menuData para tener en cuenta los sub menus   autorizados\r\n\t\t\tvar authorized = self.getSubItemsAuthorized();\r\n\r\n\t\t\tself.deleteMenuOption(\"UserAdmin\");\r\n\t\t\tself.deleteMenuOption(\"Stakeholder\");\r\n\t\t\tself.deleteMenuOption(\"AuthenticationLogQuery\");\r\n\t\t\tself.deleteMenuOption(\"EncryptionAdmin\");\r\n\t\t\tself.deleteMenuOption(\"UserPendingRequests\");\r\n\t\t\tself.deleteMenuOption(\"CaseAdmin\");\r\n\t\t\tself.deleteMenuOption(\"AsynchronousWorkitemRetries\");\r\n\t\t\tself.deleteMenuOption(\"UserDefaultAssignation\");\r\n\t\t\tself.deleteMenuOption(\"Profiles\");\r\n\t\t\tself.deleteMenuOption(\"AlarmAdmin\");\r\n\t\t\tself.deleteMenuOption(\"Licenses\");\r\n\t\t\tself.deleteMenuOption(\"UnlockFormsAdmin\");\r\n\t\t\tself.deleteMenuOption(\"GRDimensionAdmin\");\r\n\t\t\tself.deleteMenuOption(\"DocumentTemplates\");\r\n\t\t\tself.deleteMenuOption(\"ProcessAdmin\");\r\n\t\t\tself.deleteMenuOption(\"Multilanguage\");\r\n\t\t\tself.deleteMenuOption(\"EntityAdmin\");\r\n\t\t\tself.deleteMenuOption(\"Holidays\");\r\n\t\t\tself.deleteMenuOption(\"ProjectName\");\r\n\t\t\tself.deleteMenuOption(\"OAuthApplications\");\r\n\t\t\tself.deleteMenuOption(\"AdhocProcessAdmin\");\r\n\t\t\tself.deleteMenuOption(\"AdhocEntityAdmin\");\r\n\t\t\tself.deleteMenuOption(\"AdhocUserGroupAdmin\");\r\n\t\t\tself.deleteMenuOption(\"AdhocCreateProcess\");\r\n\t\t\tself.deleteMenuOption(\"UserDelegates\");\r\n\t\t\tself.deleteMenuOption(\"AdhocUserGroupReport\");\r\n\t\t\tself.deleteMenuOption(\"UserPermissionReport\");\r\n\r\n\t\t\t$.each(self.params.options.menuData, function (key, value) {\r\n\r\n\t\t\t\tif(value.categoryKey == \"BusinessPolicies\") {\r\n\t\t\t\t\tself.params.options.menuData[key].categoryClassName = \"bz-icon-policy-outline\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (value.categoryKey == \"ThemeBuilder\") {\r\n\t\t\t\t\tself.params.options.menuData[key].categoryClassName = \"bz-icon-paint-outline\";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif ($.inArray(\"BusinessPolicies\", authorized) == -1 || !bizagi.features.enableOldBusinessPoliciesAdministration) {\r\n\t\t\t\tself.deleteMenuOption(\"BusinessPolicies\");\r\n\t\t\t}\r\n\r\n\t\t\tif ($.inArray(\"BusinessPolicies\", authorized) !== -1 && bizagi.features.enableNewBusinessPoliciesAdministration) {\r\n\t\t\t\tself.params.options.menuData.unshift({\r\n\t\t\t\t\tcategoryKey: \"Vocabularies\",\r\n\t\t\t\t\tcategoryClassName: \"icon-vocabulary\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-widget-admin-business-policies-vocabulary\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICES,\r\n\t\t\t\t\ttypeIcon: \"svg\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (bizagi.util.isEnableFeature(\"enableUserPermissionsReportDownload\") && $.inArray(\"UserAdmin\", authorized) !== -1) {\r\n\t\t\t\tself.params.options.menuData.unshift({\r\n\t\t\t\t\tcategoryKey: \"UserPermissionReport\",\r\n\t\t\t\t\tcategoryClassName: \"icon-user-report\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-UserPermissionReport\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PERMISSION_REPORT,\r\n\t\t\t\t\ttypeIcon: \"svg\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif ($.inArray(\"UserAdmin\", authorized) !== -1) {\r\n\t\t\t\tself.params.options.menuData.unshift({\r\n\t\t\t\t\tcategoryKey: \"UserAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-users-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-UserAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"Stakeholder\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"StakeholderAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-stakeholders-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-StakeholderAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"EntityAdmin\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.unshift({\r\n\t\t\t\t\tcategoryKey: \"EntityAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-database-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-EntityAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t//create the new menu option using the old categoryKey\r\n\t\t\tif($.inArray(\"AuthenticationLogQuery\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"AuthenticationLogQuery\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-authentication-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-AuthenticationLogQuery\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"EncryptionAdmin\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"EncryptionAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-lock-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-EncryptionAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"UserPendingRequests\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"UserPendingRequests\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-unlock-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-UserPendingRequests\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"CaseAdmin\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"CaseAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-case-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-CaseAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"UnlockFormsAdmin\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"UnlockFormsAdmin\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-UnlockFormsAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_UNLOCK_FORMS\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"AsynchronousWorkitemRetries\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"AsynchronousWorkitemRetries\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-asynchronous-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-AsynchronousWorkitemRetries\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"UserDefaultAssignation\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"UserDefaultAssignation\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-user-manage-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-UserDefaultAssignation\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"Profiles\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"Profiles\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-user-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-Profiles\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"AlarmAdmin\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"AlarmAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-alarm-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-AlarmAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"Licenses\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"Licenses\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-license-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-Licenses\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"GRDimensionAdmin\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"GRDimensionAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-dimension-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-GRDimensionAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"DocumentTemplates\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"DocumentTemplates\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-admin-template-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-DocumentTemplates\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"ProcessAdmin\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"ProcessAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-case-time-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-ProcessAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"Holidays\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"Holidays\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-holidays\"),//\"Holidays Calendar\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-holidays-outline\",\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"ProjectName\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"ProjectName\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-ProjectName\"),\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-project-name-outline\",\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"OAuthApplications\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"OAuthApplications\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-OAuth2Applications\"),\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-admin-template-outline\",\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif($.inArray(\"Multilanguage\", authorized) != -1) {\r\n\t\t\t\tself.params.options.menuData.push({\r\n\t\t\t\t\tcategoryKey: \"LanguageAdmin\",\r\n\t\t\t\t\tcategoryClassName: \"bz-icon-world-outline\",\r\n\t\t\t\t\tcategoryName: self.getResource(\"workportal-menu-submenu-LanguageAdmin\"),\r\n\t\t\t\t\tcategoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif ($.inArray(\"AdhocProcessAdmin\", authorized) != -1) {\r\n\t\t\t    self.params.options.menuData.push({\r\n\t\t\t        categoryKey: \"AdhocProcessAdmin\",\r\n\t\t\t        categoryClassName: \"bz-icon-bz-light-box\",\r\n\t\t\t        categoryName: self.getResource(\"workportal-menu-submenu-AdhocProcessAdmin\"),\r\n\t\t\t        categoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES\r\n\t\t\t    });\r\n\t\t\t}\r\n\r\n\t\t\tif ($.inArray(\"AdhocEntityAdmin\", authorized) != -1) {\r\n\t\t\t    self.params.options.menuData.push({\r\n\t\t\t        categoryKey: \"AdhocEntityAdmin\",\r\n\t\t\t        categoryClassName: \"bz-icon-bz-edit-entity\",\r\n\t\t\t        categoryName: self.getResource(\"workportal-menu-submenu-AdhocEntityAdmin\"),\t\t\t        \r\n\t\t\t        categoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES\r\n\t\t\t    });\r\n\t\t\t}\r\n            \r\n            if ($.inArray(\"AdhocCreateProcess\", authorized) != -1) {\r\n                self.params.options.menuData.push({\r\n                    categoryKey: \"AdhocCreateProcess\",\r\n                    categoryClassName: \"bz-icon bz-icon-reload\",\r\n                    categoryName: self.getResource(\"workportal-menu-submenu-AdhocCreateProcess\"),\r\n                    categoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_CREATE_PROCESS\r\n                });\r\n            }\r\n\r\n            if ($.inArray(\"AdhocUserGroupAdmin\", authorized) != -1) {\r\n                self.params.options.menuData.push({\r\n                    categoryKey: \"AdhocUserGroupAdmin\",\r\n                    categoryClassName: \"bz-icon-bz-user-jobs\",\r\n                    categoryName: self.getResource(\"workportal-menu-submenu-AdhocUserGroupAdmin\"),\r\n                    categoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS\r\n                });\r\n            }\r\n\r\n            if ($.inArray(\"AdhocUserGroupReport\", authorized) != -1) {\r\n                self.params.options.menuData.push({\r\n                    categoryKey: \"AdhocUserGroupReport\",\r\n                    categoryClassName: \"bz-icon-reports\",\r\n                    categoryName: self.getResource(\"workportal-menu-reports\"),\r\n                    categoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUP_REPORT\r\n                });\r\n            }\r\n\r\n            if ($.inArray(\"UserDelegates\", authorized) != -1) {\r\n                self.params.options.menuData.push({\r\n                    categoryKey: \"UsersDelegation\",\r\n                    categoryClassName: \"bz-icon bz-icon-group\",\r\n                    categoryName: self.getResource(\"workportal-menu-submenu-UserDelegation\"),\r\n                    categoryUrl: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION\r\n                });\r\n            }\r\n\r\n            //add the callback for each new widget\r\n            callBack.UserAdmin =\r\n            callBack.StakeholderAdmin =\r\n            callBack.AuthenticationLogQuery =\r\n            callBack.EncryptionAdmin =\r\n            callBack.UserPendingRequests =\r\n            callBack.UnlockFormsAdmin =\r\n            callBack.AsynchronousWorkitemRetries =\r\n            callBack.UserDefaultAssignation =\r\n            callBack.Profiles =\r\n            callBack.AlarmAdmin =\r\n            callBack.Licenses =\r\n            callBack.GRDimensionAdmin =\r\n            callBack.DocumentTemplates =\r\n            callBack.ProcessAdmin =\r\n            callBack.LanguageAdmin =\r\n            callBack.EntityAdmin =\r\n            callBack.AdhocProcessAdmin =\r\n            callBack.AdhocEntityAdmin =\r\n            callBack.AdhocUserGroupAdmin =\r\n            callBack.AdhocCreateProcess =\r\n            callBack.AdhocUserGroupReport =\r\n            function(args) {\r\n                args = args || {};\r\n\r\n                $.extend(args, {\r\n                    showCloseButton: false\r\n                });\r\n\r\n                if (args.id === \"Licenses\" || args.id === \"AlarmAdmin\" || args.id === \"AdhocProcessAdmin\") {\r\n                    $.extend(args, {\r\n                        maximize: false\r\n                    });\r\n                }\r\n\r\n                self.showCustomWidgetPopup(args);\r\n            };\r\n            callBack.CaseAdmin = function(args){\r\n                args = args || {};\r\n                args = $.extend(true,args, {\r\n                        showCloseButton: false,\r\n                        title: self.getResource(\"workportal-menu-submenu-CaseAdmin\"),\r\n                        height: 780,\r\n                        showCloseButton: false,\r\n                        id: \"CaseAdmin\"\r\n                });\r\n\r\n                self.showCustomWidgetPopup(args);\r\n            };\r\n            callBack.UserPermissionReport = function(args){\r\n                args = args || {};\r\n                args = $.extend(true, args, {\r\n                        showCloseButton: false,\r\n                        title: self.getResource(\"workportal-menu-submenu-UserPermissionReport\"),\r\n                        height: 400,\r\n                        width: \"650px\",\r\n                        maximize: false,\r\n                        id: \"UserPermissionReport\"\r\n                });\r\n\r\n                self.showCustomWidgetPopup(args);\r\n            };\r\n            callBack.Holidays = function(args){\r\n                args = args || {};\r\n                args = $.extend(true,args, {\r\n                        showCloseButton: false,\r\n                        title: self.getResource(\"workportal-menu-submenu-holidays\"),\r\n                        width: \"1080px\",\r\n                        height: 910,\r\n                        showCloseButton: false,\r\n                        id: \"Holidays\"\r\n                });\r\n\r\n                self.showCustomWidgetPopup(args);\r\n            };\r\n\r\n            callBack.OAuthApplications = function (args) {\r\n                args = args || {};\r\n                args = $.extend(true, args, {\r\n                    showCloseButton: false,\r\n                    title: self.getResource(\"workportal-menu-submenu-OAuth2Applications\"),\r\n                    width: \"980px\",\r\n                    height: 700,\r\n                    showCloseButton: false,\r\n                    id: \"OAuthApplications\"\r\n                });\r\n\r\n                self.showCustomWidgetPopup(args);\r\n            };\r\n\r\n            callBack.ProjectName = function(args){\r\n                args = args || {};\r\n                args = $.extend(true,args, {\r\n                        showCloseButton: false,\r\n                        title: self.getResource(\"workportal-menu-submenu-ProjectName\"),\r\n                        width: \"600px\",\r\n                        height: 400,\r\n                        showCloseButton: false,\r\n                        id: \"ProjectName\"\r\n                });\r\n\r\n                self.showCustomWidgetPopup(args);\r\n            };\r\n\r\n\r\n            callBack.UsersDelegation = function (args) {\r\n                args = args || {};\r\n                args = $.extend(true, args, {\r\n                    showCloseButton: false,\r\n                    title: self.getResource(\"workportal-menu-submenu-UserDelegation\"),\r\n                    width: \"740px\",\r\n                    height: 910,\r\n                    showCloseButton: false,\r\n                    id: \"UsersDelegation\"\r\n                });\r\n\r\n                self.showCustomWidgetPopup(args);\r\n            };\r\n            \r\n            callBack.BusinessPolicies = function(args){\r\n                self.showContentPopup(args.url, args.title, args.id, true);\r\n                \r\n            }\r\n            callBack.Vocabularies = function(args){\r\n                self.loadBusinessPolicesWidget();\r\n            }\r\n\r\n        } catch(e) {\r\n            // Nothing todo, just skip this option in menu\r\n        }\r\n\r\n\t\t//Get List with categories\r\n\t\tdata[\"listmenu\"] = self.getCathegoriesMenuList();\r\n\r\n\t\tvar render = $.tmpl(listTemplate, data);\r\n\r\n\t\tlistContainer.append(render);\r\n\t\tself.showBreadCrumb(listContainer);\r\n\t\tself.eventHandlerGoBackBreadCrumb(listContainer.parent().parent());\r\n\r\n\t\t// Bind sub menu\r\n\t\tif(!self.params.options.customClickHandler) {\r\n\t\t\t$(\"li\", listContainer).click(function(event) {\r\n\t\t\t\t//---- Click on the items of the list of parents of category groups\r\n\t\t\t\tif($(this).hasClass(\"ui-bizagi-workportal-widget-menu-parent-item-li\")){\r\n\t\t\t\t\tevent.preventDefault();\r\n            \t\tevent.stopPropagation();\r\n\t\t\t\t\tself.eventHandlerCategoryGroupsParent($(this));\r\n\r\n\t\t\t\t}else{ //---- Click on the items of the list of childs of category groups\r\n\r\n\t\t\t\tvar url = $(this).find(\"#categoryUrl\").val();\r\n\t\t\t\tvar title = $(this).find(\".title\").text();\r\n\t\t\t\tvar id = $(this).data('id') || '';\r\n\t\t\t\tself.eventHandlerCategoryGroupsChildrenWithoutCustomClick(url, title, id, callBack);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//-----\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\t\t\t\r\n\t\t\tself.checkIsAlive();\r\n\t\t\t$(\"li\", listContainer).click(function() {\r\n\t\t\t\t//---- Click on the items of the list of parents of category groups\r\n\t\t\t\tif($(this).hasClass(\"ui-bizagi-workportal-widget-menu-parent-item-li\")){\r\n\t\t\t\t\tself.eventHandlerCategoryGroupsParent($(this));\r\n\r\n\t\t\t\t}else{ //---- Click on the items of the list of childs of category groups\r\n\t\t\t\t\tvar id = $(this).data(\"id\");\r\n\t\t\t\t\tbizagi.loader.start(\"admin\").then(function() {\r\n\t\t\t\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t\t\t\t\tself.params.options.customClickHandler(id);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\r\n\t},\r\n\t/**\r\n\t * show the child breadCrumb and show the display name of the parent\r\n\t * @param {Jquery Element} Jparent \r\n\t */\r\n\teventHandlerCategoryGroupsParent: function(Jparent){\r\n\t\tvar categoryName = Jparent.data(\"id\");\r\n\t\tvar categoryDisplayName = Jparent.find(\".title\").text();\r\n\t\tvar container = Jparent.parent().parent();\r\n\t\t$(\".ui-bizagi-workportal-widget-menu-child-item.child_of_\"+categoryName, container).show();\r\n\t\t$(\".modalMenuBt .breadCrumb .breadCrumb_child\").css(\"display\", \"inline-block\").text(\"> \"+categoryDisplayName);\r\n\t\t$(\".ui-bizagi-workportal-widget-menu-parent-item\").hide();\r\n\t},\r\n\r\n\t/**\r\n\t * return the List with categories or not\r\n\t */\r\n\tgetCathegoriesMenuList: function(){\r\n\t\tvar self=this;\r\n\t\tvar menuList=self.params.options.menuData;\r\n\t\t//menuListAdmin has cathegories\r\n\t\tif ($(self.params.options.sourceElement).attr(\"id\")==\"menuListAdmin\") {\r\n\t\t\tvar categoriesGroupsChildrenList = self.getCategoriesGroupsChildren(self.params.options.menuData);\r\n\t\t\tmenuList=self.getMenuList(categoriesGroupsChildrenList);\r\n\t\t}\r\n\t\treturn menuList;\r\n\t},\r\n\r\n\t/**\r\n\t * if the menu has breadCrumb shows it\r\n\t */\r\n\tshowBreadCrumb: function(){\r\n\t\tvar self=this;\r\n\t\tif (self.isAdminMenu())\r\n\t\t\t$(\"#categoryTree.categoryTree.breadCrumb\", self.content).show();\r\n\t},\r\n\r\n\t/**\r\n\t * return true if the menu to show is admin\r\n\t */\r\n\tisAdminMenu: function(){\r\n\t\tvar self=this;\r\n\t\treturn $(self.params.options.sourceElement).attr(\"id\")==\"menuListAdmin\";\r\n\t},\r\n\r\n\teventHandlerGoBackBreadCrumb: function(container){\r\n\t\t$(\".breadCrumb .breadCrumb_admin_parent\", container).click(function(){\r\n\t\t\t$(\".ui-bizagi-workportal-widget-menu-child-item\", container).hide();\r\n\t\t\t$(\".breadCrumb .breadCrumb_child\", container).hide();\r\n\t\t\t$(\".ui-bizagi-workportal-widget-menu-parent-item\", container).show();\r\n\t\t});\r\n\t},\r\n\teventHandlerCategoryGroupsChildrenWithoutCustomClick: function(url, title, id, callBack){\r\n\t\tvar self = this;\r\n\r\n\t\tself.checkIsAlive();\r\n\r\n\t\tif(bizagi.util.isIE11() || bizagi.util.isEdge()){\r\n\t\t\tlocalStorage.setItem('auxBizagiAuthentication', window.sessionStorage.bizagiAuthentication);\r\n\t\t}\r\n\t\t//prevent message open popup on browser\r\n\t\tvar windowOpenBlank;\r\n\t\tif(url.indexOf('ThemeBuilder') !== -1){\r\n\t\t\twindowOpenBlank = window.open(url, '_blank');\r\n\t\t}\r\n\r\n\t\tif(url.toLowerCase().indexOf('adhoc') !== -1){\r\n\t\t\tself.loadDashboardQuickProcess(url);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tbizagi.loader.start(\"admin\").then(function() {\r\n\r\n\t\t\t// Find call back\r\n\t\t\tif(callBack[id]) {\r\n\t\t\t\tcallBack[id]({\r\n\t\t\t\t\twindowOpenBlank: windowOpenBlank,\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\ttitle: title,\r\n\t\t\t\t\tid: id\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.showContentPopup(url, title, id, true);\r\n\t\t\t}\r\n\t\t\tbizagi.workportal.desktop.popup.closePopupInstance();\r\n\t\t});\r\n\t},\r\n\t\r\n\tgetCategoriesGroupsChildren: function(menuList){\r\n\t\tvar self = this;\r\n\t\tvar childrenList = []\r\n\t\tvar groupCategoryChildren1 = [];\r\n\t\tvar groupCategoryChildren2 = [];\r\n\t\tvar groupCategoryChildren3 = [];\r\n\t\tvar groupCategoryChildren4 = [];\r\n\r\n\t\tfor(var i=0; i < menuList.length; i++){\r\n\t\t\tif(menuList[i].categoryKey === \"AlarmAdmin\" || \r\n\t\t\tmenuList[i].categoryKey === \"AsynchronousWorkitemRetries\" ||\r\n\t\t\tmenuList[i].categoryKey === \"CaseAdmin\" ||\r\n\t\t\tmenuList[i].categoryKey === \"GRDimensionAdmin\" ||\r\n\t\t\tmenuList[i].categoryKey === \"EntityAdmin\" ||\r\n\t\t\tmenuList[i].categoryKey === \"BusinessPolicies\" ||\r\n\t\t\tmenuList[i].categoryKey === \"Vocabularies\" ||\r\n\t\t\tmenuList[i].categoryKey === \"ProcessAdmin\" ){\r\n\t\t\t\tgroupCategoryChildren1.push(menuList[i]);\r\n\t\t\t}\r\n\r\n\t\t\tif(menuList[i].categoryKey === \"AuthenticationLogQuery\" ||\r\n\t\t\tmenuList[i].categoryKey === \"Holidays\" ||\r\n\t\t\tmenuList[i].categoryKey === \"UserPendingRequests\" ||  \r\n\t\t\tmenuList[i].categoryKey === \"Licenses\" ||\r\n\t\t\tmenuList[i].categoryKey === \"UserDefaultAssignation\" ||\r\n\t\t\tmenuList[i].categoryKey === \"Profiles\" || \r\n\t\t\tmenuList[i].categoryKey === \"StakeholderAdmin\" || \r\n\t\t\tmenuList[i].categoryKey === \"UserAdmin\"){\r\n\t\t\t\tgroupCategoryChildren2.push(menuList[i]);\r\n\t\t\t}\r\n\r\n\t\t\tif(menuList[i].categoryKey === \"LanguageAdmin\" ||\r\n\t\t\tmenuList[i].categoryKey === \"ProjectName\" ||\r\n\t\t\tmenuList[i].categoryKey === \"ThemeBuilder\"){\r\n\t\t\t\tgroupCategoryChildren3.push(menuList[i]);\r\n\t\t\t}\r\n\r\n\t\t\tif(menuList[i].categoryKey === \"OAuthApplications\" ||\r\n\t\t\tmenuList[i].categoryKey === \"EncryptionAdmin\" ||\r\n\t\t\tmenuList[i].categoryKey === \"UserPermissionReport\"){\r\n\t\t\t\tgroupCategoryChildren4.push(menuList[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tchildrenList.push(self.sortChildList(groupCategoryChildren1));\r\n\t\tchildrenList.push(self.sortChildList(groupCategoryChildren2));\r\n\t\tchildrenList.push(self.sortChildList(groupCategoryChildren3));\r\n\t\tchildrenList.push(self.sortChildList(groupCategoryChildren4));\r\n\r\n\t\treturn childrenList;\r\n\t},\r\n\tsortChildList: function(list){\r\n\t\tvar sortList = list.sort(function(a, b){ \r\n\t\t\treturn (a.categoryName > b.categoryName) ? 1 : -1\r\n\t\t});\r\n\r\n\t\treturn sortList;\r\n\t},\r\n\tsortParentList: function(list){\r\n\t\tvar sortList = list.sort(function(a, b){ \r\n\t\t\treturn (a.displayName > b.displayName) ? 1 : -1\r\n\t\t});\r\n\t\t\r\n\t\treturn sortList;\r\n\t},\r\n\tgetMenuList: function(childrenList){\r\n\t\tvar self = this;\r\n\t\tvar menulist = [];\r\n\t\t\r\n\t\tif(childrenList[0].length > 0){\r\n\t\t\tvar groupCategory1 = self.getItemMenuList(bizagi.localization.getResource(\"workportal-menu-submenu-ProcessManagement\"), \r\n\t\t\t\"groupCategory1\", false, \"icon-process-management\", true, childrenList[0]);\r\n\t\t\tmenulist.push(groupCategory1);\r\n\t\t}\r\n\r\n\t\tif(childrenList[1].length > 0){\r\n\t\t\tvar groupCategory2 = self.getItemMenuList(bizagi.localization.getResource(\"workportal-menu-submenu-UserManagement\"), \r\n\t\t\t\"groupCategory2\", false, \"icon-user-configuration\", true, childrenList[1]);\r\n\t\t\tmenulist.push(groupCategory2);\r\n\t\t}\r\n\r\n\t\tif(childrenList[2].length > 0){\r\n\t\t\tvar groupCategory3 = self.getItemMenuList(bizagi.localization.getResource(\"workportal-menu-submenu-Customization\"), \r\n\t\t\t\"groupCategory3\", false, \"icon-customization\", true, childrenList[2]);\r\n\t\t\tmenulist.push(groupCategory3);\r\n\t\t}\r\n\r\n\t\tif(childrenList[3].length > 0){\r\n\t\t\tvar groupCategory4 = self.getItemMenuList(bizagi.localization.getResource(\"workportal-menu-submenu-Security\"), \r\n\t\t\t\"groupCategory4\", false, \"icon-security\", true, childrenList[3]);\r\n\t\t\tmenulist.push(groupCategory4);\r\n\t\t}\r\n\t\t\r\n\t\treturn self.sortParentList(menulist);\r\n\t},\r\n\r\n\tgetItemMenuList: function(displayName, name, typeIcon, className, categoryClassName, listmenu_children){\r\n\t\tvar groupCategory = [];\r\n\t\tgroupCategory.displayName = displayName;\r\n\t\tgroupCategory.name = name;\r\n\t\tgroupCategory.typeIcon = typeIcon;\r\n\t\tgroupCategory.className = className;\r\n\t\tgroupCategory.categoryClassName = categoryClassName;\r\n\t\tgroupCategory.listmenu_children = listmenu_children;\r\n\t\treturn groupCategory;\r\n\t},\r\n\r\n    loadDashboardQuickProcess: function(url){\r\n        var self = this;\r\n        bizagi.workportal.desktop.popup.closePopupInstance();\r\n            if (url === \"adhocUserGroupReport\") {                \r\n                if ($(document).find('iframe').length > 0 && $(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess') !== -1) {\r\n                    bizagi.util.liveProcessesEvents.routeEvents.route = '/reports';\r\n                    document.dispatchEvent(bizagi.util.liveProcessesEvents.routeEvents);\r\n                }else{\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY,\r\n                        data: {\r\n                            route: \"reports\",\r\n                            params: { module: 'none' }\r\n                        }\r\n                    });\r\n                }\r\n            } else if (url === \"adhocUserGroups\") {            \r\n                if ($(document).find('iframe').length > 0 && $(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess') !== -1) {\r\n                    bizagi.util.liveProcessesEvents.routeEvents.route = '/manage-groups';\r\n                    document.dispatchEvent(bizagi.util.liveProcessesEvents.routeEvents);\r\n                }else{\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY,\r\n                        data: {\r\n                            route: \"manage-groups\",\r\n                            params: { module: \"none\" }\r\n                        }\r\n                    });\r\n                }\r\n            } else if (url === \"adhocProcesses\"){\r\n                self.publish(\"changeWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY\r\n                });\r\n            } else if (url === \"adhocCreateProcess\"){\r\n                if ($(document).find('iframe').length > 0 && ($(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess') !== -1 || $(document).find('iframe')[0].contentWindow.location.href.indexOf('quick-process') !== -1)) {\r\n                    document.dispatchEvent(bizagi.util.liveProcessesEvents.newLiveProcess);\r\n                    bizagi.workportal.desktop.popup.closePopupInstance();\r\n                }else{\r\n                    var widgetParameters = {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS,\r\n                        closeVisible: false,\r\n                        maximize: false,\r\n                        modalParameters: {\r\n                            height: 300,\r\n                            title: bizagi.localization.getResource(\"workportal-quickprocess-create-qp\"),\r\n                            width: 400\r\n                        }\r\n                    };\r\n                    self.publish(\"showDialogWidget\", widgetParameters);\r\n                }\r\n            }\r\n    },\r\n    \r\n    /**\r\n     * Load Business Polices Widget\r\n     */\r\n    loadBusinessPolicesWidget: function(){\r\n        var self = this;\r\n        self.publish(\"changeWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICES\r\n        });\r\n    },\r\n    /*\r\n     *   Determines if a window must be show always in quirks mode for IE\r\n     */\r\n    needsQuicksMode: function(url) {\r\n\r\n        // If an old url is not working ok, put the url in the following filters\r\n        if(url.toLowerCase().indexOf(\"businesspoliciesselector.aspx\") >= 0)\r\n            return true;\r\n        if(url.toLowerCase().indexOf(\"bamprocess.aspx\") >= 0)\r\n            return true;\r\n        if(url.toLowerCase().indexOf(\"bamtask.aspx\") >= 0)\r\n            return true;\r\n        if(url.toLowerCase().indexOf(\"analyticsprocess.aspx\") >= 0)\r\n            return true;\r\n        if(url.toLowerCase().indexOf(\"analyticssensor.aspx\") >= 0)\r\n            return true;\r\n\r\n        return false;\r\n    },\r\n    /*\r\n     *   Get the page hacks in order to work properly in each case\r\n     */\r\n    getPageHacks: function(url, title) {\r\n        var self = this;\r\n        var callback;\r\n        var hackParams = {\r\n            title: title\r\n        };\r\n\r\n        //if (url.toLowerCase().indexOf(\"casesearch.aspx\") > 0 || url.toLowerCase().indexOf(\"AsynchDisabledWorkitems.aspx\") > 0) {\r\n        // Hack for  Admin / Processes\r\n        callback = function(params) {\r\n            // This script will execute inside the iframe context\r\n            this.openBACase = function(idCase, sHref) {\r\n                var workitem = null;\r\n                if(sHref.indexOf(\"idWorkitem=\") > -1) {\r\n                    workitem = sHref.substring(sHref.indexOf(\"idWorkitem=\") + 11);\r\n                    workitem = workitem.substring(0, workitem.indexOf(\"&\"));\r\n                }\r\n                // Executes the act on\r\n                params.controller.publish(\"executeAction\", {\r\n                    action: params.routingAction,\r\n                    idCase: idCase,\r\n                    idWorkItem: workitem\r\n                });\r\n\r\n                // close dialog\r\n                params.controller.publish(\"closeCurrentDialog\");\r\n            };\r\n\r\n            this.changeToWidget = function(widget) {\r\n                params.controller.publish(\"changeWidget\", {\r\n                    widgetName: widget || params.bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n                });\r\n\r\n                // close dialog\r\n                params.controller.publish(\"closeCurrentDialog\");\r\n            };\r\n        };\r\n\r\n        // Set hack params\r\n        hackParams = $.extend(hackParams, {\r\n            routingAction: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            bizagi: bizagi\r\n        });\r\n        // }\r\n\r\n        return {\r\n            callback: callback,\r\n            params: hackParams\r\n        };\r\n    },\r\n    /*\r\n     *  Show modal window with static url\r\n     **/\r\n    showContentPopup: function(url, title, id, maximized) {\r\n        var self = this;\r\n        id = id || \"\";\r\n\r\n        // Define hacks for each page\r\n        var hack = self.getPageHacks(url, title);\r\n\r\n        if(bizagi.util.isIE() && bizagi.util.getInternetExplorerVersion() < 10 && self.needsQuicksMode(url)) {\r\n            // Shows a popup window\r\n            self.publish(\"showOldWindow\", {\r\n                url: url,\r\n                windowParameters: $.extend(hack.params, {\r\n                    controller: self,\r\n                    afterLoad: hack.callback\r\n                })\r\n            });\r\n\r\n        } else {\r\n            // Show a normal popup\r\n\r\n            // If the same popup is opened close it\r\n            if(self.currentPopup == \"genericiframe\") {\r\n                bizagi.workportal.desktop.popup.closePopupInstance();\r\n                return;\r\n            }\r\n\r\n            // Shows a popup widget\r\n            self.currentPopup = \"genericiframe\";\r\n            self.publish(\"showDialogWidget\", {\r\n                widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                widgetURL: url,\r\n                injectCss: [\".ui-bizagi-old-render*\", \".\" + title, \"@font-face\"],\r\n                modalParameters: {\r\n                    refreshInbox: false,\r\n                    id: id,\r\n                    title: title\r\n                },\r\n                maximized: maximized,\r\n                afterLoad: hack.callback,\r\n                afterLoadParams: hack.params\r\n            });\r\n        }\r\n    },\r\n    showWidgetPopup: function(widget, title, id) {\r\n        var self = this;\r\n\r\n        self.publish(\"showDialogWidget\", {\r\n            widgetName: widget,\r\n            modalParameters: {\r\n                title: title,\r\n                width: \"1080px\",\r\n                showCloseButton: false\r\n            }\r\n        });\r\n    },\r\n    showCustomWidgetPopup: function(params) {\r\n        var self = this;\r\n        var defaultWidth = ($(window).width() - (($(window).width() * 15)/100)) + \"px\";\r\n        var widgetParameters = {\r\n            widgetName: params.url,\r\n            data: {\"idCase\": params.id},\r\n            closeVisible: params.showCloseButton,\r\n            maximize: (typeof params.maximize !== \"undefined\") ? params.maximize : true,\r\n            modalParameters: {\r\n                title: params.title,\r\n                width: params.width || defaultWidth,\r\n                height: params.height,\r\n                id: params.id\r\n            }\r\n        };\r\n\r\n        if(params.buttons) {\r\n            widgetParameters.buttons = params.buttons;\r\n        }\r\n\r\n        self.publish(\"showDialogWidget\", widgetParameters);\r\n    },\r\n    deleteMenuOption: function(categoryKey) {\r\n        var self = this;\r\n        var menuData = self.params.options.menuData;\r\n\r\n        for(var i = 0; i < menuData.length; i++) {\r\n            if(menuData[i].categoryKey == categoryKey) {\r\n                self.params.options.menuData.splice(i, 1);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Regresa un arreglo con los submenu autorizados\r\n     */\r\n    getSubItemsAuthorized: function() {\r\n        var self = this;\r\n        var result = [];\r\n        $.each(self.params.options.menuData, function(k, v) {\r\n            result.push(v.categoryKey);\r\n        });\r\n        return result;\r\n    },\r\n\r\n    checkIsAlive: function () {\r\n        var self = this;\r\n        var params = {\r\n            idUser: bizagi.currentUser.idUser,\r\n            fromDate: Date.now(),\r\n            toDate: Date.now()\r\n        };\r\n        self.dataService.getEffectiveDuration(params);\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Queries Dialog implementation\r\n *   Author: Juan Pablo Crossley\r\n *   Comments:\r\n *   -   ???\r\n */\r\n\r\n// Extends itself\r\nbizagi.workportal.widgets.genericiframe.extend(\"bizagi.workportal.widgets.genericiframe\", {}, {\r\n\r\n    /*\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var iframe = $(\"iframe\", content);\r\n        var injectCss = (self.params.injectCss) ? self.params.injectCss : [\".ui-bizagi-old-render*\", \"@font-face\"];\r\n\r\n        iframe.parent().addClass('loading-iframe');\r\n        iframe.hide();\r\n\r\n\r\n        iframe.load(function () {\r\n            iframe.parent().removeClass('loading-iframe');\r\n            iframe.fadeIn();\r\n        });\r\n\r\n        if (self.params.afterLoad && self.params.afterLoad != null) {\r\n            iframe.load(function () {\r\n                iframe.callInside(\r\n                    self.params.afterLoad,\r\n                    $.extend(self.params.afterLoadParams, {\r\n                        controller: self\r\n                    })\r\n                    );\r\n            });\r\n        }\r\n\r\n        if (injectCss != undefined) {\r\n            var css = \"\";\r\n            var cssList = \"\";\r\n\r\n            if (typeof injectCss == \"object\") {\r\n                $.each(injectCss, function (key, value) {\r\n                    css += bizagi.getStyle(value);\r\n                    cssList += value.replace(\".\", \"\") + \" \";\r\n                });\r\n            } else {\r\n                css += bizagi.getStyle(injectCss);\r\n                cssList += injectCss.replace(\".\", \"\");\r\n            }\r\n\r\n            // Inject css within iframe\r\n            iframe.load(function () {\r\n                // inject css\r\n                var iframeContent = $(this).contents();\r\n                \r\n                // Append css\r\n                $('head', iframeContent).append(\"<style type='text/css'>\" + css + \"</style>\");\r\n                $('body', iframeContent).addClass(cssList.replace(\"*\", \"\"));\r\n                                \r\n                // Hack position fixed for IE8 in quirks mode\r\n                /*if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {\r\n                    var fixWizard = '<!--[if lte IE 8]> <style type=\"text/css\"> #floater1Div { position: absolute; bottom: auto; right: auto; top: expression( ( -10 - floater1Div.offsetHeight + ( document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight ) + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + \"px\" ); left: expression( ( -20 - floater1Div.offsetWidth + ( document.documentElement.clientWidth ? document.documentElement.clientWidth : document.body.clientWidth ) + ( ignoreMe2 = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft ) ) + \"px\" ); } #divClose { bottom: -3px; left: 0; } </style> <![endif]--><!--[if lte IE 7]> <link href=\"../../css/estilos.css\" type=\"text/css\" rel=\"stylesheet\" /> <![endif]-->';\r\n                    $('head', iframeContent).append(fixWizard);\r\n                }*/\r\n\r\n                // Add classes for IE8 in quirks mode\r\n                $('body input', iframeContent).each(function () {\r\n                    var $self = $(this),\r\n                        inputType = $self.attr('type') ? 'ui-' + $self.attr('type') : '',\r\n                        inputName = $self.attr('name') ? 'ui-' + $self.attr('name').replace(/_\\d+$/, '') : '',\r\n                        inputClasses = inputType + ' ' + inputName;\r\n\r\n                    $self.addClass(inputClasses);\r\n                })\r\n\r\n                // Remove borders for buttons\r\n                $('body img[src$=\"Button.gif\"]', iframeContent).parent().remove();\r\n            }).attr('frameborder', '0');\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Workportal Search Controller\r\n *   Author: Diego Parra (based on Edward Morales version)\r\n *   Comments:\r\n *   -\tThis script will provide base library for search cases\r\n */\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.search.extend(\"bizagi.workportal.widgets.search\", {}, {\r\n    /*\r\n     *\t Constructor\r\n     */\r\n    init: function(workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Define variables\r\n        self.radNumber = params.referrerParams.radNumber || params.radNumber || \"\";\r\n        self.isAdhocProcess = true;\r\n        self.adhocIds = [];\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"inbox-grid-cases\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.grid\").concat(\"#ui-bizagi-workportal-widget-inbox-grid-cases\"),\r\n            \"inbox-common-case-summary\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description\"),\r\n            \"inbox-common-case-summary-subprocess\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-subprocess\"),\r\n            \"inbox-common-case-summary-assignees\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-assignees\"),\r\n            \"inbox-common-case-summary-events\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-case-description-events\"),\r\n            \"inbox-common-case-summary-oldrender\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.inbox.common\").concat(\"#ui-bizagi-workportal-widget-inbox-common-oldrender\"),\r\n            \"search-details\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.search\").concat(\"#ui-bizagi-workportal-widget-search-details\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n    },\r\n    /*\r\n     *\t To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var contentDetails = $(\"#searchDetails\", content);\r\n        var pdata = {};\r\n        var pageSelector = $(\"#casesPagination\", content);\r\n        var nElemToShow = 14;\r\n        var totalPages = self.params.data.cases.totalPages;\r\n        var actualPage = self.params.data.cases.page;\r\n        var AdhocProcessId = null;\r\n\r\n\r\n        $(self.params.data.cases.rows).each(function(key, value) {\r\n            if (!value.isAdhocProcess) value.isAdhocProcess = false;\r\n            if (value.isAdhocProcess) {\r\n                self.adhocIds.push({ 'caseId': value.id, 'processId': value.idAdhocProcess });\r\n            }\r\n            value.enableTimelineByProcessType = self.isAvailableTimelineByProcessType(value.isAdhocProcess);\r\n        });\r\n        // Set templates\r\n        self.searchTemplate = self.workportalFacade.getTemplate(\"search\");\r\n        //self.searchTemplate = self.getTemplate(\"inbox-grid-cases\");\r\n        self.searchDetailsTemplate = self.getTemplate(\"search-details\");\r\n        self.searchPagination = self.workportalFacade.getTemplate(\"inbox-common-pagination-grid\");\r\n        self.caseSummaryTemplate = self.getTemplate(\"inbox-common-case-summary\");\r\n        self.caseSummaryTemplateSubprocess = self.getTemplate(\"inbox-common-case-summary-subprocess\");\r\n        self.caseSummaryTemplateAssigness = self.getTemplate(\"inbox-common-case-summary-assignees\");\r\n        self.caseSummaryTemplateEvents = self.getTemplate(\"inbox-common-case-summary-events\");\r\n        self.paginationTemplate = self.workportalFacade.getTemplate(\"inbox-common-pagination-inbox\");\r\n\r\n        contentDetails.empty();\r\n\r\n        // Define title of module\r\n        self.params.data.title = self.params.data.title || bizagi.localization.getResource(\"workportal-widget-search\");\r\n\r\n        // Set title\r\n        $(\".title\", content).html(self.params.data.title);\r\n\r\n        /* // Previous Version\r\n        $.when(\r\n        $.tmpl(self.searchDetailsTemplate,self.params.data).appendTo(contentDetails)\r\n        ).done(function(){\r\n        */\r\n\r\n        // Convert null to empty \"\" fields\r\n        for (i = 0; i < self.params.data.cases.rows.length; i++) {\r\n            for (j = 0; j < self.params.data.cases.rows[i].fields.length; j++) {\r\n                self.params.data.cases.rows[i].fields[j] = (self.params.data.cases.rows[i].fields[j] == null) ? \"\" : self.params.data.cases.rows[i].fields[j];\r\n            }\r\n            // when user search a case\r\n            self.params.data.cases.rows[i].graphicQuery = bizagi.menuSecurity.GraphicQuery;\r\n            self.params.data.cases.rows[i].timeLine = bizagi.menuSecurity.TimeLine && bizagi.override.enableFeatureShowTimelineButton;\r\n        }\r\n\r\n        // Format monetary cells, params (data,money format)\r\n        self.params.data.cases = bizagi.util.formatMonetaryCells(self.params.data.cases, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n        self.params.data.cases.groupByCaseNumber = bizagiConfig.groupByCaseNumber;\r\n\r\n        $.when(\r\n            $.tmpl(self.searchDetailsTemplate, self.params.data.cases, {\r\n                setFormat: self.formatValue,\r\n                isArray: self.isArray,\r\n                formatCategories: self.formatCategories,\r\n                isDate: bizagi.util.isDate,\r\n                getRadNumberColumnIndex: function() {\r\n                    var data = this.data;\r\n                    var index = -1;\r\n                    for (var i = 0, l = data.columnTitle.length; i < l; i++) {\r\n                        if (data.columnTitle[i].fieldName == \"I_RadNumber\") {\r\n                            index = i;\r\n                        }\r\n                    }\r\n                    return index;\r\n                },\r\n                showColumn: function(columnIndex) {\r\n                    var index = this.getRadNumberColumnIndex();\r\n                    return (this.data.groupByCaseNumber && index == columnIndex) ? \" style=display:none; \" : \"\";\r\n                },\r\n                createGroupedHeader: function(rowIndex) {\r\n                    var data = this.data;\r\n                    var result = false;\r\n                    var radNumber = this.getRadNumber(data.rows[rowIndex]);\r\n                    if (data.groupByCaseNumber) {\r\n                        if (rowIndex == 0) {\r\n                            result = true;\r\n                        } else {\r\n                            var previousRadNumber = this.getRadNumber(data.rows[rowIndex - 1]);\r\n                            if (radNumber != previousRadNumber) {\r\n                                result = true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return result;\r\n                },\r\n                getRadNumber: function(row) {\r\n                    var index = this.getRadNumberColumnIndex();\r\n                    return (index >= 0) ? row.fields[index] : \"\";\r\n                }\r\n            }).appendTo(contentDetails)).done(function() {\r\n\r\n            // Format invariant dates\r\n            bizagi.util.formatInvariantDate(content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n            // bind activities and process\r\n            $(\".ui-bizagi-wp-app-inbox-activity-name\", contentDetails).click(function() {\r\n                var idCase = $(this).find(\"#idCase\").val() || \"\";\r\n                var idWorkItem = $(this).find(\"#idWorkItem\").val() || \"\";\r\n                var idTask = $(this).find(\"#idTask\").val() || \"\";\r\n                var idWorkflow = $(this).closest('tr').data(\"idworkflow\");\r\n\r\n                if (idWorkItem === \"0\" || idTask === \"0\") {\r\n                    return;\r\n                }\r\n\r\n                // fix for SUITE-8792\r\n                if (idWorkItem != \"\" && idTask != \"\") {\r\n                    if (bizagi.cache === undefined) {\r\n                        bizagi.cache = {};\r\n                    } else {\r\n                        if (bizagi.cache[idCase] !== undefined) {\r\n                            if (bizagi.cache[idCase].idWorkitem == parseInt(idWorkItem) && bizagi.cache[idCase].idTask == parseInt(idTask) && bizagi.cache[idCase].isComplex !== undefined) {\r\n                                idWorkItem = \"\";\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Executes routing action\r\n                self.publish(\"executeAction\", {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: idCase,\r\n                    idWorkItem: idWorkItem,\r\n                    idTask: idTask,\r\n                    idWorkflow: idWorkflow,\r\n                    eventAsTasks: true,\r\n                    onlyUserWorkItems: \"true\"\r\n                });\r\n            });\r\n\r\n\r\n            $(\".ui-bizagi-wp-app-inbox-grouped\", contentDetails).bind(\"click\", function() {\r\n                var radNumber = $(this).data(\"radnumber\");\r\n                var referrerParams = {\r\n                    taskState: self.params.taskState,\r\n                    idWorkItem: $(this).find(\"#idWorkItem\").val(),\r\n                    idCase: $(this).find(\"#idCase\").val(),\r\n                    idTask: $(this).find(\"#idTask\").val(),\r\n                    onlyFavorites: self.onlyFavorites,\r\n                    idWorkflow: self.idWorkflow,\r\n                    referrer: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n                };\r\n\r\n                $.extend(bizagi.referrerParams, bizagi.referrerParams, referrerParams);\r\n\r\n                var idCase = $(this).find(\"#idCase\").val();\r\n\r\n                self.publish(\"executeAction\", {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: idCase\r\n                });\r\n            });\r\n\r\n\r\n            // Add click to timeline icon\r\n            $(\".js-show-timeline\", contentDetails).click(function (event){\r\n                var idCase = $(this).parent().find(\"#idCase\").val();\r\n                var caseNumber = $.trim($(this).closest(\"tr\").find(\".I_RadNumber\").text());\r\n                self.showTimeLine({ radNumber: caseNumber, idCase: idCase });\r\n            });\r\n\r\n            // Add click to view workflow\r\n            $(\".ui-bizagi-wp-app-inbox-cases-ico-view\", contentDetails).click(function() {\r\n                var idCase = $(this).parent().find(\"#idCase\").val();\r\n                var idWorkflow = $(this).closest(\"tr\").data(\"idworkflow\");\r\n                var isAdhoc = $(this).closest(\"tr\").data(\"isadhoc\");\r\n                if (isAdhoc) {\r\n                    for (var i = 0; i < self.adhocIds.length; i++) {\r\n                        if (parseInt(idCase) == self.adhocIds[i].caseId) {\r\n                            processId = self.adhocIds[i].processId;\r\n                            self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow, isAdhoc: true, idProcess: processId });\r\n                            break;\r\n                        }\r\n                    }\r\n                } else {\r\n                    self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow });\r\n                }\r\n                return false;\r\n            });\r\n            $(\".inbox-grid-tooltip-button\", content).tooltip();\r\n            // show case summary\r\n            $(\".workonitRow\", content).click(function() {\r\n                // Call routing action\r\n                var idCase = $(this).parents(\"td\").first().find(\"#idCase\").val();\r\n                var idWorkflow = $(this).closest(\"tr\").data(\"idworkflow\");\r\n                $(\".inbox-grid-tooltip-button\", content).tooltip(\"close\");\r\n                self.showCase(idCase, idWorkflow);\r\n            });\r\n            /* End lines by CAAA */\r\n\r\n            // Bind favorites start\r\n            $(contentDetails).delegate(\".ui-bizagi-wp-app-inbox-cases-start\", \"click\", function(e) {\r\n                e.stopPropagation();\r\n                var options = {};\r\n                var elmnt = this;\r\n                $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start\").addClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\");\r\n\r\n                // check if its favorite\r\n                if ($(elmnt).parent().find(\"#isFavorite\").val() == \"false\") {\r\n                    options = {\r\n                        idObject: $(elmnt).parent().find(\"#idCase\").val(),\r\n                        favoriteType: \"CASES\"\r\n                    };\r\n                    $.when(\r\n                        self.dataService.addFavorite(options)\r\n                    ).done(function(data) {\r\n                        $(elmnt).parent().find(\"#guidFavorite\").val(data[\"idFavorites\"]);\r\n                        $(elmnt).removeClass(\"bz-icon-star-outline\").addClass(\"bz-icon-star\");\r\n                        $(elmnt).parent().find(\"#isFavorite\").val(\"true\");\r\n                        $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\").addClass(\"ui-bizagi-wp-app-inbox-cases-start\");\r\n                    })\r\n                } else {\r\n                    options = {\r\n                        idObject: $(elmnt).parent().find(\"#guidFavorite\").val(),\r\n                        favoriteType: \"CASES\"\r\n                    };\r\n                    $.when(\r\n                        self.dataService.delFavorite(options)\r\n                    ).done(function(data) {\r\n                        if (data[\"deleted\"] == \"true\" || data[\"deleted\"] == true) {\r\n                            $(elmnt).parent().find(\"#guidFavorite\").val(\"\");\r\n                            $(elmnt).removeClass(\"bz-icon-star\").addClass(\"bz-icon-star-outline\");\r\n                            $(elmnt).parent().find(\"#isFavorite\").val(\"false\");\r\n                            $(elmnt).removeClass(\"ui-bizagi-wp-app-inbox-cases-start-wait\").addClass(\"ui-bizagi-wp-app-inbox-cases-start\");\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n\r\n            // Bind action to ungroup cases from folders\r\n            $('.folders-case-ungroup', contentDetails).click(function() {\r\n\r\n                // Used to remove the row later on\r\n                var itemSelector = this;\r\n\r\n                var options = {\r\n                    idFolder: $(this).data('folder-id'),\r\n                    idCase: $(this).data('case-id')\r\n                }\r\n\r\n                var confirmationMsg = bizagi.localization.getResource('workportal-search-desasociate-case');\r\n\r\n                $.when(bizagi.showConfirmationBox(confirmationMsg, null, false))\r\n                    .done(function() {\r\n                        // This is supposed to be the \"trutsy\" part of the confirmation however the concept is\r\n                        // not properly used, anyways is done like this because Diego likes deferreds\r\n                        // for a lot of things - Andres Valencia\r\n\r\n                        // Call service to ungroup case from folders\r\n                        $.when(\r\n                            self.dataService.dissasociateCaseFromFolder(options)\r\n                        ).done(function(data) {\r\n\r\n                            // Whilst this is not the most elegant solution to remove the desasociated case from the current folder\r\n                            // it can act as a temporary \"hack\" to avoid the search widget to refresh and lose context as it is happening so far\r\n\r\n                            $(itemSelector).closest('tr').remove();\r\n\r\n                            // Confirm that case has been removed from folder\r\n                        });\r\n                    })\r\n                    .fail(function() {\r\n                        // And this is supposed to be the \"falsy\" part of the confirmation dialog\r\n                        // also a misused true/false concept - Andres Valencia\r\n                    });\r\n            });\r\n\r\n            $(\".ui-bizagi-wp-app-inbox-bt-back\", content).click(function() {\r\n                var widget = bizagi.referrerParams.referrerBackButton || bizagi.cookie('bizagiDefaultWidget');\r\n                // switch referer widget \r\n                switch (widget) {\r\n                    case \"inbox\":\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: widget,\r\n                            restoreStatus: true\r\n                        });\r\n                        break;\r\n                    case \"inboxGrid\":\r\n\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: widget,\r\n                            restoreStatus: true\r\n                        });\r\n                        break;\r\n                    case \"search\":\r\n                        self.publish(\"executeAction\", {\r\n                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,\r\n                            radNumber: bizagi.referrerParams.radNumber || \"\",\r\n                            page: bizagi.referrerParams.page || 1,\r\n                            onlyUserWorkItems: false\r\n                        });\r\n                        break;\r\n                    case \"queryform\":\r\n                        self.publish(\"showDialogWidget\", {\r\n                            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,\r\n                            queryFormAction: \"loadPrevious\"\r\n                        });\r\n                        break;\r\n                    case \"folders\":\r\n                        var url = bizagi.referrerParams.urlParameters + \"&page=\" + bizagi.referrerParams.page;\r\n                        $.when(self.dataService.getCasesByFolder(url))\r\n                            .done(function(data) {\r\n                                data.customized = true;\r\n                                data.urlParameters = bizagi.referrerParams.urlParameters\r\n\r\n                                // Define title of widget\r\n                                data.title = bizagi.referrerParams.name;\r\n\r\n                                // Set a flag here to tell the search widget that must show the ungroup case from folder (icon).\r\n                                data.casesGroupedByFolder = true;\r\n                                data.idFolder = bizagi.referrerParams.id;\r\n\r\n                                self.publish(\"changeWidget\", {\r\n                                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n                                    data: data,\r\n                                    referrerParams: {}\r\n                                });\r\n                            });\r\n                        break;\r\n                    case \"activityform\":\r\n                        self.publish(\"executeAction\", {\r\n                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                            idCase: bizagi.referrerParams.idCase || undefined,\r\n                            idWorkItem: bizagi.referrerParams.idWorkItem || undefined,\r\n                            idTask: bizagi.referrerParams.idTask || undefined,\r\n                            eventAsTasks: true,\r\n                            onlyUserWorkItems: \"true\"\r\n                        });\r\n                        break;\r\n                    default:\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,\r\n                            restoreStatus: true\r\n                        });\r\n                        break;\r\n                }\r\n            });\r\n\r\n            // sort columns\r\n            $(\".sortColumnsData\", contentDetails).click(function() {\r\n                var params = {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,\r\n                    radNumber: $(this).find(\"#radNumber\").val(),\r\n                    orderFieldName: $(this).find(\"#orderFieldName\").val(),\r\n                    orderType: (($(this).find(\"#orderType\").val() == 0) ? 1 : 0),\r\n                    order: $(this).find(\"#order\").val(),\r\n                    onlyUserWorkItems: false\r\n                };\r\n                self.publish(\"executeAction\", params);\r\n            });\r\n\r\n            // Define Pagination\r\n\r\n\r\n            // Show/hide pagination\r\n            pdata.pagination = (totalPages > 1) ? true : false;\r\n            pdata.page = self.params.referrerParams.page || actualPage;\r\n\r\n            // set total pages\r\n            pdata.pages = {};\r\n            var pageToshow = (nElemToShow > totalPages) ? totalPages : nElemToShow;\r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pdata.pages[i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n\r\n            // Set style pagination\r\n            pdata[\"gridPagination\"] = \"gridCasePagination\";\r\n            pdata.previousPage = (actualPage > 1) ? actualPage - 1 : 1;\r\n            pdata.nextPage = (actualPage < totalPages) ? actualPage + 1 : totalPages;\r\n            pdata.totalPages = totalPages;\r\n\r\n            var paginationHtml = $.tmpl(self.searchPagination, pdata).html();\r\n\r\n            // Get template\r\n            $(pageSelector).append(paginationHtml);\r\n\r\n            // Crate pagination control\r\n            $(\"ul\").bizagiPagination({\r\n                maxElemShow: 50,\r\n                totalPages: pdata.totalPages,\r\n                actualPage: pdata.page,\r\n                listElement: $(\"ul\", pageSelector),\r\n                clickCallBack: function(options) {\r\n                    // Check if action from search or folders\r\n                    if (self.params.data.customized != undefined && self.params.data.customized) {\r\n                        var url = self.params.data.urlParameters + \"&page=\" + options.page;\r\n                        $.when(self.dataService.getCustomizedColumnsData({\r\n                                smartfoldersParameters: url\r\n                            }))\r\n                            .done(function(data) {\r\n                                // Define widget customized for pagination purposes\r\n                                data.customized = true;\r\n                                data.urlParameters = self.params.data.urlParameters;\r\n\r\n                                // Define title of widget\r\n                                data.title = self.params.data.title;\r\n\r\n                                bizagi.referrerParams.page = options.page;\r\n\r\n                                // Set a flag here to tell the search widget that must show the ungroup case from folder (icon).\r\n                                data.casesGroupedByFolder = true;\r\n                                data.idFolder = self.params.data.id;\r\n                                self.publish(\"changeWidget\", {\r\n                                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n                                    data: data,\r\n                                    referrerParams: {}\r\n                                });\r\n                            });\r\n                    } else {\r\n                        self.publish(\"executeAction\", {\r\n                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,\r\n                            radNumber: self.params.referrerParams.radNumber,\r\n                            page: options.page,\r\n                            onlyUserWorkItems: false\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n\r\n            contentDetails.bizagiScrollbar({\r\n                autohide: false\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n      * Validate if the timeline icon should be shown or not, depending on features endpoint\r\n      */\r\n    isAvailableTimelineByProcessType: function (isAdhocProcess) {\r\n        return (!isAdhocProcess ||\r\n            (isAdhocProcess && bizagi.util.isEnableFeature(\"enableTimelineOnLiveProcesses\")));\r\n    },\r\n\r\n    /*\r\n     *   Shows a popup with the case information\r\n     */\r\n    showCase: function(idCase, idWorkflow) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var caseSummaryContainer = $(\"#contentDesc\", content);\r\n        var cache = {};\r\n        var htmlContent = \"\";\r\n        // Update internal variable\r\n        self.idCase = idCase;\r\n        caseSummaryContainer.empty();\r\n        // Don't search data when there is no case\r\n        if (self.idCase == 0) {\r\n            return;\r\n        }\r\n        // Render Form Tab\r\n        $.when(\r\n            self.dataService.summaryCaseDetails({\r\n                idCase: self.idCase\r\n            })\r\n        ).done(function(data) {\r\n            data.hasComments = (data.hasComments == 'true') ? true : false;\r\n\r\n            // Get security\r\n            var security = new bizagi.workportal.command.security(self.dataService);\r\n            data.graphicQuery = security.checkSecurityPerm(\"GraphicQuery\");\r\n\r\n            data.enableFeatureShowTimelineButton = bizagi.override.enableFeatureShowTimelineButton;\r\n            data.enableTimelineByProcessType = self.isAvailableTimelineByProcessType(data.isAdhocProcess);\r\n\r\n            if (data.currentState && data.currentState.length > 0) {\r\n                data.currentState.forEach(function(currentState) {\r\n                    if (!currentState.idTask) {\r\n                        currentState.idTask = 0;\r\n                    }\r\n                    if (!currentState.state) {\r\n                        currentState.state = currentState.displayName || \" \";\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (data.process === \"undefined\" || data.process === \"\" || typeof data.process === \"undefined\") {\r\n                data.process = false;\r\n            }\r\n\r\n            if (data.processPath === \"undefined\" || data.processPath === \"\" || typeof data.processPath === \"undefined\") {\r\n                data.processPath = false;\r\n            }\r\n\r\n            var renderedTemplate = $.tmpl(self.caseSummaryTemplate, $.extend(data, { security: bizagi.menuSecurity })).appendTo(caseSummaryContainer);\r\n            // Format invariant dates\r\n            bizagi.util.formatInvariantDate(content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n            // Delegate events for parent process\r\n            $(\"#details\", renderedTemplate).delegate(\".summaryLink\", \"click\", function() {\r\n                self.routingExecute($(this));\r\n                caseSummaryDialog.dialog('close');\r\n            });\r\n            var caseSummaryDialog = renderedTemplate;\r\n            // Fix for tab height\r\n            $('.scrollSummary', caseSummaryDialog).css({ 'height': '', 'overflow-y': 'visible' });\r\n\r\n            // jQuery-ui tabs\r\n            $(\"#ui-bizagi-details-tabs\", content).tabs({\r\n                active: -1,\r\n                create: function(event, ui) {\r\n                    $(this).tabs(\"option\", \"active\", 0);\r\n                },\r\n                \"activate\": function(event, ui) {\r\n\r\n                    var panel = (ui == undefined) ? \"formSummary\" : ui.newPanel.attr('id');\r\n                    switch (panel) {\r\n                        /* 0 = details\r\n                         * 1 = formSummary\r\n                         * 2 = subprocess\r\n                         * 3 = assigness\r\n                         * 4 = events\r\n                         * 5 = activities\r\n                         **/\r\n                        case \"comments\":\r\n                            if (cache[\"comments\"] == undefined) {\r\n                                // Extend render with comments\r\n                                $.extend(self, {}, bizagi.workportal.comments);\r\n\r\n                                // Define canvas\r\n                                data.canvas = $(\"#comments\");\r\n                                data.readOnly = true;\r\n\r\n                                $.when(self.renderComments(data))\r\n                                    .done(function(htmlContent) {\r\n                                        cache[\"comments\"] = htmlContent;\r\n                                    });\r\n                            }\r\n                            bizagi.util.setContext({\r\n                                commentsFocus: true\r\n                            });\r\n                            break;\r\n                        case \"formSummary\":\r\n                            if (cache[\"formSummary\"] == undefined) {\r\n                                var canvas = $(\"#formSummary\", caseSummaryContainer);\r\n\r\n                                // Define action when render form has not been migrated\r\n                                canvas.bind(\"oldrenderintegration\", function(e) {\r\n                                    if (e.isPropagationStopped()) {\r\n                                        return;\r\n                                    }\r\n                                    e.stopPropagation();\r\n\r\n                                    var template = self.getTemplate(\"inbox-common-case-summary-oldrender\");\r\n                                    var data = {};\r\n\r\n                                    bizagi.oldrenderevent = true; // has been loaded\r\n                                    var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n                                    var eventer = window[eventMethod];\r\n                                    var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n\r\n                                    // Listen to message from child window\r\n                                    eventer(messageEvent, function(e) {\r\n                                        e.stopPropagation();\r\n                                        self.publish(\"executeAction\", {\r\n                                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                                            idCase: e.data\r\n                                        });\r\n                                    }, false);\r\n\r\n                                    // Define workitem and idtask\r\n                                    $.when(self.dataService.getWorkitems({\r\n                                        idCase: self.idCase,\r\n                                        onlyUserWorkItems: true,\r\n                                        eventAsTasks: true\r\n                                    })).done(function(getWorkitems) {\r\n                                        // verify workitem, in some cases these variables are not available\r\n                                        if (typeof getWorkitems.workItems == \"object\" && getWorkitems.workItems.length >= 1) {\r\n                                            // Case Open\r\n                                            var idWorkitem = getWorkitems.workItems[0]['idWorkItem'];\r\n                                            var idTask = getWorkitems.workItems[0]['idTask'];\r\n                                            var idCase = getWorkitems.workItems[0]['idCase'];\r\n                                            data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + idCase + \"&idWorkitem=\" + idWorkitem + \"&idTask=\" + idTask + \"&isSummary=1\";\r\n                                        } else {\r\n                                            // Case closed\r\n                                            data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&isSummary=1\";\r\n                                        }\r\n\r\n                                        // Render content\r\n                                        canvas.empty();\r\n                                        $.tmpl(template, data).appendTo(canvas);\r\n                                        //Set styles\r\n                                        self.iframeOldRender($(\"iframe\", canvas));\r\n                                    });\r\n                                });\r\n\r\n                                var params = {\r\n                                    idCase: self.idCase\r\n                                };\r\n\r\n                                $.when(self.dataService.getCaseFormsRenderVersion(params))\r\n                                    .done(function(formsVersion) {\r\n                                        if (formsVersion.formsRenderVersion == 1) {\r\n                                            canvas.trigger(\"oldrenderintegration\");\r\n                                        } else {\r\n                                            $.when(\r\n                                                self.renderSummaryForm($(\"#formSummary\", renderedTemplate))\r\n                                            ).done(function() {\r\n                                                htmlContent = $(\"#formSummary\", renderedTemplate).html();\r\n                                                cache[\"formSummary\"] = htmlContent;\r\n                                            });\r\n                                        }\r\n                                    });\r\n                            }\r\n                            break;\r\n                        case \"subprocess\":\r\n                            if (cache[\"subprocess\"] == undefined) {\r\n                                $.when(\r\n                                    self.dataService.summarySubProcess({\r\n                                        idCase: self.idCase\r\n                                    })\r\n                                ).done(function(subprocess) {\r\n                                    htmlContent = $.tmpl(self.caseSummaryTemplateSubprocess, subprocess);\r\n                                    htmlContent.appendTo($(\"#subprocess\", renderedTemplate));\r\n                                    cache[\"subprocess\"] = htmlContent;\r\n                                    // Define Events for subprocess tab\r\n                                    htmlContent.delegate(\".summaryLink\", \"click\", function() {\r\n                                        self.routingExecute($(this));\r\n                                        caseSummaryDialog.dialog('close');\r\n                                    });\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"assignees\":\r\n\r\n                            if (cache[\"assignees\"] == undefined) {\r\n                                $.when(\r\n                                    self.dataService.summaryAssigness({\r\n                                        idCase: self.idCase,\r\n                                        preview:true\r\n                                    })\r\n                                ).done(function(assignees) {\r\n                                    // Generates  lists of unique assignees for Events\r\n                                    var eventsUniqueList = [];\r\n                                    $.each(assignees.events.split(\", \"), function(i, el) {\r\n                                        if ($.inArray(el, eventsUniqueList) === -1) eventsUniqueList.push(el);\r\n                                    });\r\n                                    assignees.events = eventsUniqueList.join(\", \");\r\n\r\n                                    // Generates  lists of unique assignees for activities\r\n                                    var activitiesUniqueList = [];\r\n                                    $.each(assignees.activities.split(\", \"), function(i, el) {\r\n                                        if ($.inArray(el, activitiesUniqueList) === -1) activitiesUniqueList.push(el);\r\n                                    });\r\n                                    assignees.activities = activitiesUniqueList.join(\", \");\r\n                                    htmlContent = $.tmpl(self.caseSummaryTemplateAssigness, assignees);\r\n                                    htmlContent.appendTo($(\"#assignees\", renderedTemplate));\r\n                                    cache[\"assignees\"] = htmlContent;\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"events\":\r\n                            if (cache[\"events\"] == undefined) {\r\n                                $.when(\r\n                                    self.dataService.summaryCaseEvents({\r\n                                        idCase: self.idCase\r\n                                    })\r\n                                ).done(function(events) {\r\n                                    htmlContent = $.tmpl(self.caseSummaryTemplateEvents, events);\r\n                                    htmlContent.appendTo($(\"#events\", renderedTemplate));\r\n                                    cache[\"events\"] = htmlContent;\r\n                                    htmlContent.delegate(\".summaryLink\", \"click\", function() {\r\n                                        self.routingExecute($(this));\r\n                                        caseSummaryDialog.dialog('close');\r\n                                    });\r\n                                });\r\n                            }\r\n                            break;\r\n                    }\r\n                }\r\n            });\r\n\r\n            $(\".inbox-grid-tooltip-button\", content).tooltip();\r\n            // Add click to view workflow\r\n            $(\"#ui-bizagi-wp-app-inbox-description-container .ui-bizagi-wp-app-inbox-cases-ico-view\", content).click(function() {\r\n                if (self.adhocIds.length > 0) {\r\n                    for (var i = 0; i < self.adhocIds.length; i++) {\r\n                        if (idCase == self.adhocIds[i].caseId) {\r\n                            self.showGraphicQuery({\r\n                                idCase: idCase,\r\n                                idWorkflow: idWorkflow,\r\n                                isAdhoc: true,\r\n                                idProcess: self.adhocIds[i].processId\r\n                            });\r\n                        } else {\r\n                            self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow });\r\n                        }\r\n                    }\r\n                } else {\r\n                    self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow });\r\n                }\r\n\r\n            });\r\n            // Bind events for events and process on summary case\r\n            $(\".workonitRow\", renderedTemplate).click(function() {\r\n\t\t\t\tvar currentWorkitemId = $(this).parent().find(\"#idWorkItem\").val();\r\n\t\t\t\t\r\n                var referrerParams = {\r\n                    taskState: self.params.taskState,\r\n                    idWorkItem: currentWorkitemId,\r\n                    idCase: data.idCase,\r\n                    onlyFavorites: self.onlyFavorites,\r\n                    idWorkflow: self.idWorkflow,\r\n                    referrer: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n                }\r\n                $.extend(bizagi.referrerParams, bizagi.referrerParams, referrerParams);\r\n                // Executes routing action\r\n                caseSummaryDialog.dialog('close');\r\n\t\t\t\t\r\n\t\t\t\tvar workitem = $.grep(data.currentState, function (item, i) {\r\n\t\t\t\t\t\t\treturn item.idWorkItem == currentWorkitemId;\r\n\t\t\t\t\t\t})[0];\r\n\r\n\t\t\t\tvar workitemCaseId;\r\n\t\t\t\tif (workitem && workitem.idCase)\r\n\t\t\t\t\tworkitemCaseId = workitem.idCase;//Only to access a Subprocess from parent.\r\n\t\t\t\telse\r\n\t\t\t\t\tworkitemCaseId = data.idCase;\r\n\t\t\t\t\r\n                self.publish(\"executeAction\", {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: workitemCaseId,\r\n                    idWorkflow: idWorkflow,\r\n                    idWorkItem: currentWorkitemId\r\n                });\r\n            });\r\n\r\n            // Add click to timeline icon\r\n            $(\".js-show-timeline\", renderedTemplate).click(function (event){\r\n                var caseNumber = $.trim($(this).closest(\"div.ui-bizagi-wp-app-inbox-processes-title\").find(\"span.js-case-number\").text());\r\n                self.showTimeLine({ radNumber: caseNumber, idCase: idCase });\r\n            });\r\n\r\n            // Set buttons\r\n            var buttons = {};\r\n            buttons[bizagi.localization.getResource(\"workportal-case-dialog-box-close\")] = function() {\r\n                caseSummaryContainer.empty();\r\n                renderedTemplate.remove();\r\n                $(\"#ui-bizagi-wp-app-inbox-description-container\").remove();\r\n            };\r\n            // Show dialog\r\n            caseSummaryDialog.dialog({\r\n                modal: true,\r\n                title: data.process,\r\n                width: 1000,\r\n                height: 600,\r\n                draggable: true,\r\n                resizable: true,\r\n                buttons: buttons,\r\n                close: function() {\r\n                    caseSummaryContainer.empty();\r\n                    renderedTemplate.remove();\r\n                    $(\"#ui-bizagi-wp-app-inbox-description-container\").remove();\r\n                }\r\n            });\r\n            //$(\"\").add(\"workonitRow\")\r\n        });\r\n    },\r\n    /*\r\n     *   Misc method to format cell values\r\n     */\r\n    formatRequest: function(value) {\r\n        return value;\r\n    },\r\n    /**\r\n     * Misc method to render categories\r\n     */\r\n    formatCategories: function(value) {\r\n        return value;\r\n    },\r\n    isArray: function(value) {\r\n        if (typeof(value) == 'object') {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n    /*\r\n     *   Renders the summary form inside a given container\r\n     */\r\n    renderSummaryForm: function(container) {\r\n        var self = this;\r\n\r\n        var proxyPrefix = (typeof(self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            // Load render page\r\n            var rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n\r\n            // Executes rendering into render container\r\n            rendering.execute({\r\n                canvas: container,\r\n                summaryForm: true,\r\n                idCase: self.idCase\r\n            });\r\n\r\n            // Keep reference to rendering facade\r\n            self.renderingFacade = rendering;\r\n\r\n            // Resize layout\r\n            setTimeout(function() {\r\n                self.resizeLayout();\r\n            }, 1000);\r\n        });\r\n    },\r\n    /**\r\n     * Inject styles and js into the iframe\r\n     */\r\n    iframeOldRender: function(canvas) {\r\n        var self = this;\r\n        var iframe;\r\n        var content = self.getContent();\r\n        var theme = \"bizagiDefault\";\r\n        var queryString = bizagi.readQueryString();\r\n\r\n        $.each(canvas, function() {\r\n            if ($(this).is(\"iframe\")) {\r\n                iframe = $(this);\r\n            }\r\n        });\r\n\r\n        iframe.load(function() {\r\n            // inject css\r\n            var content = $(this).contents();\r\n\r\n            // Fixed problem with relative path across the different browsers\r\n            var cssLocation = ($.browser.mozilla || $.browser.webkit) ? \"../../css/render_%theme%.css\" : \"css/render_%theme%.css\";\r\n\r\n            // Define theme\r\n            cssLocation = cssLocation.replace(\"%theme%\", (queryString[\"theme\"] || theme));\r\n\r\n            // Append css\r\n            $('body', content).append(\"<link type='text/css' rel='stylesheet' href='\" + cssLocation + \"'>\");\r\n\r\n            // Append javascript\r\n            //\t$('head',content).append(\"<script type='text/javascript' src='../../js/renderintegration.js'></script>\");\t\r\n        });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Workportal Desktop Integration old render within new look and feel\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script define base controller to integrate old render within new workportal\r\n */\r\n\r\n// Extends itself\r\nbizagi.workportal.widgets.oldrenderintegration.extend(\"bizagi.workportal.widgets.oldrenderintegration\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(workportalFacade, dataService, params);\r\n\r\n        // Declare widget variables\r\n        self.taskState = \"all\"; // general taskState from tabs\r\n        self.icoTaskState = \"\"; // real staskState from list cases\r\n        self.idWorkflow = 0;\r\n        self.idCase = 0;\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"integration-old-render\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.oldrenderintegration\").concat(\"#ui-bizagi-workportal-widget-oldrender\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    /*\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        if (self.params.restoreStatus) {\r\n            bizagi.referrerParams = bizagi.referrerParams || {};\r\n        } else {\r\n            bizagi.referrerParams = bizagi.referrerParams ? { page: bizagi.referrerParams.page } : {};\r\n        }\r\n\r\n        self.params.taskState = self.params.taskState || bizagi.referrerParams.taskState || \"all\";\r\n\r\n\r\n        // Bind navigation bar\r\n        // Set idcase data\r\n        $(\".back\", content).data(\"idCase\", self.getBackCase());\r\n        $(\".next\", content).data(\"idCase\", self.getNextCase());\r\n\r\n        // Bind for click event on back and bext botton\r\n        $(\".back, .next\", content).click(function () {\r\n            var idCase = $(this).data(\"idCase\");\r\n            if (idCase > 0) {\r\n                self.publish(\"executeAction\", {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: idCase\r\n                });\r\n            }\r\n        });\r\n\r\n        // Bind for click event on refresh botton\r\n        $(\".refresh\", content).click(function () {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: self.params.idCase,\r\n                idTask: self.params.idTask,\r\n                idWorkItem: self.params.idWorkitem,\r\n                referrer: self.params.referrer || \"inboxGrid\"\r\n            });\r\n        });\r\n\r\n        // Bind for click event on return botton\r\n        $(\".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox > h2\", content).click(function () {\r\n            var widget = bizagi.referrerParams.referrer || bizagi.cookie('bizagiDefaultWidget');\r\n            // switch referer widget\r\n            switch (widget) {\r\n                case \"inbox\":\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: widget,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n                case \"inboxGrid\":\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: widget,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n                case \"search\":\r\n                    self.publish(\"executeAction\", {\r\n                        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,\r\n                        radNumber: bizagi.referrerParams.radNumber || \"\",\r\n                        page: bizagi.referrerParams.page || 1,\r\n                        onlyUserWorkItems: false\r\n                    });\r\n                    break;\r\n                case \"queryform\":\r\n                    self.publish(\"showDialogWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,\r\n                        queryFormAction: \"loadPrevious\"\r\n                    });\r\n                    break;\r\n                case \"folders\":\r\n                    var url = bizagi.referrerParams.urlParameters + \"&page=\" + bizagi.referrerParams.page;\r\n                    $.when(self.dataService.getCasesByFolder(url))\r\n                            .done(function (data) {\r\n                                data.customized = true;\r\n                                data.urlParameters = bizagi.referrerParams.urlParameters\r\n\r\n                                // Define title of widget\r\n                                data.title = bizagi.referrerParams.name;\r\n\r\n                                // Set a flag here to tell the search widget that must show the ungroup case from folder (icon).\r\n                                data.casesGroupedByFolder = true;\r\n                                data.idFolder = bizagi.referrerParams.id;\r\n\r\n                                self.publish(\"changeWidget\", {\r\n                                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n                                    data: data,\r\n                                    referrerParams: {}\r\n                                });\r\n                            });\r\n                    break;\r\n                default:\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,\r\n                        restoreStatus: true\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // Bind for hover event on refresh and return botton\r\n        $(\".refresh,.return\", content).hover(function () {\r\n            $(this).addClass(\"active\");\r\n        }, function () {\r\n            $(this).removeClass(\"active\");\r\n        });\r\n\r\n        // Bind for hover event on next and back botton\r\n        $(\".next,.back\", content).hover(\r\n                function () {\r\n                    if ($(this).data(\"idCase\") > 0) {\r\n                        $(this).addClass(\"active\");\r\n                    }\r\n                },\r\n                function () {\r\n                    $(this).removeClass(\"active\");\r\n                });\r\n\r\n\r\n        // Insert iframe with old render\r\n        self.insertIframeOldRender();\r\n    },\r\n    getInjectJavaScript: function (params) {\r\n\r\n        var args = {};\r\n        var callback = function (args) {\r\n            this.changeToWidget = function (widget) {\r\n                args.controller.publish(\"changeWidget\", {\r\n                    widgetName: args.bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID\r\n                });\r\n            };\r\n\r\n            this.openBACase = function (idCase, sHref) {\r\n                var workitem = null;\r\n                if (sHref.indexOf(\"idWorkitem=\") > -1) {\r\n                    workitem = sHref.substring(sHref.indexOf(\"idWorkitem=\") + 11);\r\n                    workitem = workitem.substring(0, workitem.indexOf(\"&\"));\r\n                }\r\n                // Executes the act on\r\n                args.controller.publish(\"executeAction\", {\r\n                    action: args.routingAction,\r\n                    idCase: idCase,\r\n                    idWorkItem: workitem\r\n                });\r\n\r\n                // close dialog\r\n                params.controller.publish(\"closeCurrentDialog\");\r\n            };\r\n        }\r\n\r\n\r\n        return {\r\n            callback: callback,\r\n            args: {\r\n                routingAction: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                bizagi: bizagi\r\n            }\r\n        }\r\n\r\n    },\r\n    insertIframeOldRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var iframe;\r\n        var theme = \"bizagiDefault\";\r\n        var queryString = bizagi.readQueryString();\r\n\r\n        $.each(content, function () {\r\n            if ($(this).is(\"iframe\")) {\r\n                iframe = $(this);\r\n            }\r\n        });\r\n\r\n        iframe.load(function () {\r\n            // inject css\r\n            var content = $(this).contents();\r\n            var getInjectJS = self.getInjectJavaScript();\r\n\r\n            // Fixed problem with relative path across the different browsers\r\n            var cssLocation = ($.browser.mozilla || $.browser.webkit) ? \"../../css/render_%theme%.css\" : \"css/render_%theme%.css\";\r\n\r\n            // Define theme\r\n            cssLocation = cssLocation.replace(\"%theme%\", (queryString[\"theme\"] || theme));\r\n\r\n            // Append css\r\n            $('head', content).append(\"<link type='text/css' rel='stylesheet' href='\" + cssLocation + \"'>\");\r\n\r\n            iframe.callInside(\r\n                    getInjectJS.callback,\r\n                    $.extend(getInjectJS.args, {\r\n                        controller: self\r\n                    })\r\n                    );\r\n\r\n            content.bind('click', function () {\r\n                bizagi.workportal.desktop.popup.closePopupInstance();\r\n            });\r\n\r\n            // Append javascript\r\n            $('head', content).append(\"<script type='text/javascript' src='../../js/renderintegration.js'></script>\");\r\n\r\n            // Hack position fixed for IE8 in quirks mode\r\n            /*if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {\r\n                var fixWizard = '<!--[if lte IE 8]> <style type=\"text/css\"> #floater1Div { position: absolute; bottom: auto; right: auto; top: expression( ( -10 - floater1Div.offsetHeight + ( document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight ) + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + \"px\" ); left: expression( ( -20 - floater1Div.offsetWidth + ( document.documentElement.clientWidth ? document.documentElement.clientWidth : document.body.clientWidth ) + ( ignoreMe2 = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft ) ) + \"px\" ); } #divClose { bottom: -3px; left: 0; } </style> <![endif]--><!--[if lte IE 7]> <link href=\"../../css/estilos.css\" type=\"text/css\" rel=\"stylesheet\" /> <![endif]-->';\r\n                $('head', content).append(fixWizard);\r\n            }*/\r\n\r\n            // Remove all the old elements than doesn't look well\r\n            var $oldElements = $('body img[src*=\"Button.gif\"], body td[style*=\"CellShadow.gif\"], body img[src*=\"tab_active\"], body img[src*=\"tab_inactive\"]', content);\r\n                \r\n            // Remove elements\r\n            $oldElements.parent().remove();\r\n\r\n            // Fix scroll bug in FF\r\n            iframe.css('overflow-y', 'auto');\r\n\r\n        });\r\n    },\r\n    /*\r\n    *  Navigation options\r\n    */\r\n    getListKey: function () {\r\n        var self = this;\r\n        bizagi.lstIdCases = bizagi.lstIdCases || {};\r\n        if (bizagi.lstIdCases.length > 1) {\r\n            for (var i = 0; i < bizagi.lstIdCases.length; i++) {\r\n                if (self.params.idCase == bizagi.lstIdCases[i]) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return -1;\r\n    },\r\n    getNextCase: function () {\r\n        var self = this;\r\n        var nextIdCase = 0;\r\n        var key = self.getListKey();\r\n\r\n        // Check if last element\r\n        if (bizagi.lstIdCases.length == (key + 1) || bizagi.lstIdCases.length == 1) {\r\n            nextIdCase = -1;\r\n        } else {\r\n            nextIdCase = bizagi.lstIdCases[key + 1];\r\n        }\r\n\r\n        return nextIdCase;\r\n    },\r\n    getBackCase: function () {\r\n        var self = this;\r\n        var prevIdCase = 0;\r\n        var key = self.getListKey();\r\n\r\n        // Check if first element\r\n        if (key == 0) {\r\n            prevIdCase = -1;\r\n        } else {\r\n            prevIdCase = bizagi.lstIdCases[key - 1];\r\n        }\r\n\r\n        return prevIdCase;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Workportal Desktop Create Case Controller\r\n *   Author: Alexander Mejia\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.createcase\", {}, {\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Private fields\r\n        self._processId = params.idObject;\r\n        self._mapping = params.mapping || [];\r\n        self._idParentCase = params.idParentCase;\r\n        self._mappingstakeholders = params.mappingstakeholders;\r\n        self._guidprocess = params.guidprocess;\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"createcase\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.createcase\").concat(\"#createcase-wrapper\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template = self.getTemplate(\"createcase\");\r\n        self.content = template.render();\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * Process widget\r\n     */\r\n    postRender: function () {\r\n        var self = this,\r\n            defer = new $.Deferred(),\r\n            $content = self.getContent();\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            $.when(self.dataService.getStartForm(self._getServiceParams())).then(function (data) {\r\n                return self._getRenderingFacade().execute({ canvas: self._getCanvasForm(), data: data, type: \"\" });\r\n            }).done(function (form) {\r\n                self.startForm = form;\r\n                $content.find('#createcase-content').append(form.container);\r\n                defer.resolve($content);\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Returns an instance of rendering facade\r\n     */\r\n    _getRenderingFacade: function () {\r\n        var self = this;\r\n\r\n        if (!self._rendering) {\r\n            self._rendering = new bizagi.rendering.facade({\"proxyPrefix\": bizagi.RPproxyPrefix, \"database\": \"\"});\r\n        }\r\n\r\n        return self._rendering;\r\n    },\r\n\r\n    /**\r\n     * Returns an object with the parameters available to gets the start form\r\n     */\r\n    _getServiceParams: function () {\r\n        var self = this,\r\n            params = self.getMapping();\r\n\r\n        params[\"h_action\"] = \"LOADSTARTFORM\";\r\n\r\n        if (self._idParentCase) {\r\n            params[\"h_idParentCase\"] = self._idParentCase\r\n        }\r\n        if (self._mappingstakeholders) {\r\n            params[\"h_mappingstakeholders\"] = self._mappingstakeholders;\r\n        }\r\n        if (self._guidprocess) {\r\n            params[\"h_guidprocess\"] = self._guidprocess;\r\n        }\r\n        else {\r\n            params[\"h_idProcess\"] = self._processId;\r\n        }\r\n        return params;\r\n    },\r\n\r\n    /**\r\n     * Builds the mapping to send at LOADSTARTFORM action\r\n     */\r\n    getMapping: function () {\r\n        var self = this,\r\n            params = {};\r\n\r\n        for (var i = 0, l = self._mapping.length; i < l; i++) {\r\n            var map = self._mapping[i];\r\n            if (map.surrogateKey) {\r\n                params[map.xpath] = JSON.stringify(map.surrogateKey);\r\n            }\r\n        }\r\n\r\n        return params;\r\n    },\r\n\r\n    /**\r\n     * returns the canvas used renderize the start form, also the\r\n     * routing event is attach al canvas.\r\n     * after the case is created succesfully, the form trigger the routing event\r\n     */\r\n    _getCanvasForm: function () {\r\n        var self = this,\r\n            $content = self.getContent();\r\n        var $canvas = $content.find('#createcase-content');\r\n\r\n        // When the case is created, rendering module trigger the routing event\r\n        $canvas.on('routing', $.proxy(self.onCaseCreated, self));\r\n        return $canvas;\r\n    },\r\n\r\n    /**\r\n     * This handler is called when the create button is clicked in\r\n     * the start form\r\n     */\r\n    onCaseCreated: function (ev, params) {\r\n        var self = this;\r\n        self.pub('closeDialog', params);\r\n    },\r\n\r\n    /**\r\n     * Dispose widget\r\n     */\r\n    dispose: function (){\r\n        var self = this;\r\n        if(self.startForm){\r\n            self.pub('createCaseDisposed');\r\n            self.startForm.dispose();\r\n        }\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.createcase', ['workportalFacade', 'dataService', bizagi.workportal.widgets.createcase], true);","/**\r\n * Name: Bizagi Workportal Desktop Update Form Controller\r\n * Author: Alexander Mejia\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.updateform\", {}, {\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        // Private fields\r\n        self._guidForm = params.guidForm;\r\n        self._entityGuid = params.entityGuid;\r\n        self._surrogateKey = params.surrogateKey;\r\n        self._mapping = params.mapping;\r\n        self._readonlyform = params.readonlyform;\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"updateform\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.updateform\").concat(\"#updateform-wrapper\"),\r\n            \"content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.updateform\").concat(\"#form-content\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template = self.getTemplate(\"updateform\");\r\n        self.content = template.render();\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * Process widget\r\n     */\r\n    postRender: function () {\r\n        var self = this,\r\n            defer = new $.Deferred(),\r\n            $content = self.getContent();\r\n\r\n        self.dataService.getEntityForm(self._getServiceParams()).then(function (data) {\r\n            return self._getRenderingFacade().execute({ canvas: $content.find('#updateform-content'), data: data, type: \"\" });\r\n        }).done(function (form) {\r\n            $content.find('#updateform-content').append(form.container);\r\n            defer.resolve($content);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Returns an instance of rendering facade\r\n     * */\r\n    _getRenderingFacade: function () {\r\n        var self = this;\r\n\r\n        if (!self._rendering) {\r\n            self._rendering = new bizagi.rendering.facade({ \"proxyPrefix\": bizagi.RPproxyPrefix, \"database\": \"\" });\r\n        }\r\n        self._rendering.subscribe('rendering-formRendered', $.proxy(self._overrideHandlers, self));\r\n\r\n        return self._rendering;\r\n    },\r\n\r\n    /**\r\n     * Returns an object with the parameters available to gets the start form\r\n     * */\r\n    _getServiceParams: function () {\r\n        var self = this,\r\n            params = {};\r\n\r\n        params[\"h_action\"] = \"LOADENTITYFORM\";\r\n        params[\"h_contexttype\"] = \"entity\";\r\n        params[\"h_guidForm\"] = self._guidForm;\r\n        params[\"h_showDisabled\"] = false;\r\n        params[\"h_guidEntity\"] = self._entityGuid;\r\n        params[\"h_readonlyform\"] = self._readonlyform;\r\n\r\n        if (self._mapping) {\r\n            params[\"h_mapping\"] = JSON.stringify(self._mapping);\r\n        }\r\n\r\n        if (self._surrogateKey) {\r\n            params[\"h_surrogateKey\"] = self._surrogateKey;\r\n        }\r\n\r\n        return params;\r\n    },\r\n\r\n    /**\r\n     * returns the canvas used renderize the start form, also the\r\n     * routing event is attach al canvas.\r\n     * after the case is created succesfully, the form trigger the routing event\r\n     */\r\n    _getCanvasForm: function () {\r\n        var self = this;\r\n        var formTemplate = self.getTemplate('content');\r\n\r\n        return formTemplate.render();\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @private\r\n     */\r\n    _overrideHandlers: function () {\r\n        var self = this,\r\n            form = typeof self._rendering === \"undefined\" ? null : self._rendering.form;\r\n\r\n        if (form) {\r\n            self.idPageCache = self.idPageCache || form.idPageCache;\r\n            var properties = form.properties;\r\n            var originalProcessButton = form.processButton;\r\n\r\n            form.processButton = function (buttonProperties) {\r\n                var action = buttonProperties.action;\r\n\r\n                if (action == \"cancel\") {\r\n                    form.endLoading();\r\n                    self.pub('closeDialog', { refresh : false });\r\n                    form.dispose();\r\n                }\r\n                else {\r\n                    properties.surrogateKey = self._surrogateKey;\r\n                    properties.contextType = \"entity\";\r\n\r\n                    form.bind('refresh', function () {\r\n                        form.endLoading();\r\n                        self.pub('closeDialog', { refresh: true });\r\n                        form.dispose();\r\n                    });\r\n\r\n                    return originalProcessButton.apply(form, arguments);\r\n                }\r\n            };\r\n\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Dispose\r\n     */\r\n    dispose: function() {\r\n        var self = this;\r\n        if(self._rendering && self._rendering.form) {\r\n            self._rendering.form.dispose();\r\n        }\r\n        bizagi.util.dispose(self);\r\n    },\r\n});\r\nbizagi.injector.register('bizagi.workportal.widgets.updateform', ['workportalFacade', 'dataService', bizagi.workportal.widgets.updateform], true);","/**\r\n * This widget show information of entities using Template engine\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.templates\", {}, {\r\n    /**\r\n     * Constructor\r\n     * @param workportalFacade\r\n     * @param dataService\r\n     * @param actionService\r\n     * @param accumulatedcontext\r\n     * @param processActionService\r\n     * @param params\r\n     * @param casetoolbar\r\n     * @param usersCasesService\r\n     * @param actionsEventsService\r\n     */\r\n\tinit: function(workportalFacade, dataService, actionService, casetoolbar, usersCasesService, actionsEventsService, accumulatedcontext, processActionService, params) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Call base\r\n\t\tself._super(workportalFacade, dataService, params);\r\n\r\n\t\t//Load templates\r\n\t\tself.loadTemplates({\r\n\t\t\t\"templateEngine\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.templateEngine\").concat(\"#templateengine-wrapper\"),\r\n\t\t\t\"templateEngineElement\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.templateEngine\").concat(\"#templateengine-wrapper-element\"),\r\n\t\t\t\"templateEngineTooltip\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.templateEngine\").concat(\"#templateengine-wrapper-tooltip\"),\r\n\t\t\t\"templateEmptyData\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.templateEngine\").concat(\"#templateengine-empty-message\")\r\n\t\t});\r\n\r\n\t\t//Private fields\r\n        self.selectorCheckboxItems = \".template-box-header input:checkbox\";\r\n\t\tself.actionService = actionService;\r\n\t\tself.casetoolbar = casetoolbar;\r\n\t\tself.usersCasesService = usersCasesService;\r\n\t\tself.actionsEventsService = actionsEventsService;\r\n\t\tself.processActionService = processActionService;\r\n\t\tself.accumulatedcontext = accumulatedcontext;\r\n\t\tself._currentPage = 1;\r\n\t\tself.entitiesSelected = {};\r\n\t},\r\n\r\n\t/**\r\n\t * Renders the template defined in the widget\r\n\t * @return {*}\r\n\t */\r\n\trenderContent: function() {\r\n\t\tvar self = this;\r\n\t\tvar template = self.getTemplate(\"templateEngine\");\r\n\t\tself.content = template.render({});\r\n\r\n\t\treturn self.content;\r\n\t},\r\n\r\n\t/**\r\n\t * links events with handlers\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n        self.configureHandlers();\r\n\t},\r\n\r\n    /**\r\n     * configure Handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n\r\n        $content.find(\"#template-dataviewer-list\").on(\"click\", self.selectorCheckboxItems, $.proxy(self.onEntityChecked, self));\r\n\r\n        self.sub(\"GET-COMMON-ACTIONS\", $.proxy(self.getCommonActions, self));\r\n\r\n        self.sub(\"TEMPLATEENGINE-VIEW\", function(ev, params) {\r\n            self.params.event = \"TEMPLATEENGINE-VIEW\";\r\n            return self.updateData(params);\r\n        });\r\n\r\n        self.sub(\"SEARCH-ENGINE-VIEW\", function(ev, params) {\r\n            self.params.event = \"SEARCH-ENGINE-VIEW\";\r\n            return self.updateData(params);\r\n        });\r\n\r\n        self.sub(\"UPDATE-DATATEMPLATE-VIEW\", function(ev, params) {\r\n            return self.updateData(params);\r\n        });\r\n\r\n        self.sub(\"SET-VALUES\", function(ev, params) {\r\n            return self.setValues(params);\r\n        });\r\n\r\n        self.actionService.subscribe(\"onFormActionExecuted\", $.proxy(self.onFormActionExecuted, self));\r\n        self.processActionService.subscribe(\"onFormRuleExecuted\", $.proxy(self.onFormRuleExecuted, self));\r\n        self.processActionService.subscribe(\"onFormExecuted\", $.proxy(self.onFormExecuted, self));\r\n\r\n        //keep bar actions\r\n        var heightBreadCrumb = $(\"#home-navbar\").outerHeight();\r\n        var heightMenu = $(\"#ui-bizagi-wp-menu\").height() - heightBreadCrumb;\r\n        $(\"#content-wrapper\").scroll(function(){\r\n            var sticky = $(\".template-sticky-header-tools\");\r\n            var heightSticky = sticky.height();\r\n            var scroll = $(\"#content-wrapper\").scrollTop();\r\n\r\n            if (scroll >= heightMenu) {\r\n                sticky.addClass(\"fixed-header-tools\");\r\n                $(this).css(\"padding-top\", (heightSticky) + \"px\");\r\n            }\r\n            else {\r\n                sticky.removeClass(\"fixed-header-tools\");\r\n                $(this).css(\"padding-top\", \"\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Gets entity data and inject it in the defined template\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    updateData: function(params) {\r\n        var self = this;\r\n        var args = params.args || {};\r\n        var defer = new $.Deferred();\r\n\r\n        // Clean the displayed data before getting the new one\r\n        var $dataViewList = $(\"#template-dataviewer-list\", self.getContent());\r\n        $dataViewList.empty();\r\n\r\n        self.actionService.init();\r\n        self.entitiesSelected = {};\r\n\r\n        self._referrer = args.guidSearch ? \"search\" : args.referenceType ? \"dataNavigation\" : self._referrer;\r\n        self._page = args.page || self._page;\r\n        self._totalRecords = args.totalRecords;\r\n        self._filters = args.filters || self._filters;\r\n        self._defaultFilterApplied = typeof args.defaultFilterApplied !== \"undefined\" ? args.defaultFilterApplied : (typeof self._defaultFilterApplied !== \"undefined\" ? self._defaultFilterApplied : true);\r\n        self._guidSearch = args.guidSearch || self._guidSearch;\r\n        self._fromActionLauncher = (typeof args.fromActionLauncher !== \"undefined\") ? args.fromActionLauncher : self._fromActionLauncher;\r\n        self._reference = args.reference || self._reference || \"\";\r\n        self._surrogateKey = args.surrogateKey || self._surrogateKey;\r\n        self._referenceType = args.referenceType || self._referenceType;\r\n        self._xpath = args.xpath || self._xpath;\r\n        self._guidEntityCurrent = args.guidEntityCurrent || self._guidEntityCurrent;\r\n        self._pageSize = args.pageSize || self._pageSize;\r\n        self._onlyLocalResults = args.onlyLocalResults || self._onlyLocalResults;\r\n\r\n        // Get entity data\r\n        var entityDataParams = {\r\n            guidSearch: self._guidSearch,\r\n            fromActionLauncher: self._fromActionLauncher,\r\n            reference: self._reference,\r\n            surrogateKey: self._surrogateKey,\r\n            referenceType: self._referenceType,\r\n            page: self._page,\r\n            filters: self._filters,\r\n            filtersAppliedCounter: args.filtersAppliedCounter,\r\n            totalRecords: self._totalRecords,\r\n            calculateFilters: typeof args.calculateFilters === \"undefined\" ?  true : args.calculateFilters,\r\n            defaultFilterApplied: self._defaultFilterApplied,\r\n            xpath: self._xpath,\r\n            guidEntityCurrent: self._guidEntityCurrent,\r\n            pageSize: self._pageSize,\r\n            onlyLocalResults: self._onlyLocalResults\r\n        };\r\n\r\n        $.when(self.getEntityData(entityDataParams)).then(function(data) {\r\n            var deferProcessEntities = $.Deferred();\r\n            if(data && data.reference === self._reference){\r\n                //clone args, because bizagi.navigator.info is referenced to args\r\n                self.pub(\"notify\", {type: \"PAGINATOR-UPDATE\", args: $.extend(bizagi.clone(args), data, {event: params.type})});\r\n                $.when(self.processEntities($.extend(data, { referenceType: self._referenceType }))).done(function(response){\r\n                    deferProcessEntities.resolve(response, data.reference);\r\n                });\r\n            }\r\n            else{\r\n                deferProcessEntities.reject();\r\n            }\r\n            return deferProcessEntities.promise();\r\n\r\n        }).done(function(entitiesData, reference) {\r\n            if(reference === self._reference) {\r\n                self.checkAll = false; //When updateData always uncheck all\r\n                $.when(self.renderEntities(entitiesData, args)).done(function () {\r\n                    self.pub(\"notify\", {\r\n                        type: \"ENABLE-BATCHS-ACTIONS\",\r\n                        args: {commonActions: self.setValues({args: {value: self.checkAll}})}\r\n                    });\r\n                    defer.resolve(entitiesData);\r\n                });\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * returns an instance of  the template engine\r\n     * @return {*}\r\n     */\r\n    getTemplateEngine: function() {\r\n        var self = this;\r\n\r\n        if (self.templateEngine) {\r\n            return self.templateEngine;\r\n        }\r\n\r\n        var renderDataService = new bizagi.render.services.service({proxyPrefix: bizagi.RPproxyPrefix});\r\n        var renderFactory = new bizagi.rendering.desktop.factory(renderDataService);\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(renderFactory.initAsyncStuff()).done( function() {\r\n            self.templateEngine = new bizagi.templateEngine({\r\n                renderFactory: renderFactory,\r\n                cache: true,\r\n                router: self.router\r\n            });\r\n\r\n            self.templateEngine.subscribe(\"onLoadDataNavigation\", function(ev, params) {\r\n                var data = params.data || {};\r\n                var args = {\r\n                    reference: data.reference,\r\n                    surrogateKey: data.surrogateKey,\r\n                    referenceType: data.referenceType,\r\n                    histName: data.displayName,\r\n                    guidEntityCurrent: data.guidEntityCurrent,\r\n                    filters: [],\r\n                    page: 1,\r\n                    calculateFilters: true\r\n                };\r\n\r\n                if (typeof data.xpath !== \"undefined\" && data.xpath) {\r\n                    args.xpath = data.xpath;\r\n                }\r\n\r\n                self.accumulatedcontext.addContext({ \"entityGuid\": params.data.guidEntityCurrent, \"surrogateKey\": [params.data.surrogateKey] });\r\n\r\n                var getLevelNavigator = self.pub(\"notify\", {type: \"NAVIGATOR_GETLEVEL\"});\r\n                var currentLevelNavigator = getLevelNavigator && getLevelNavigator.length > 0 ? parseInt(getLevelNavigator[0]) : 1;\r\n\r\n                self.pub(\"notify\", {\r\n                    type: data.contextEvent,\r\n                    args: $.extend(args, {level: currentLevelNavigator + 1})\r\n                });\r\n            });\r\n            defer.resolve(self.templateEngine);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Gets the data related to entity\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getEntityData: function (params) {\r\n        var self = this;\r\n        var appliedFilters =  params.filters;\r\n        var filtersAppliedCounter = params.filtersAppliedCounter;\r\n        var calculateFilters = params.calculateFilters;\r\n\r\n        if (self._referrer === \"search\") {\r\n            return self.dataService.getSearchData(params).then(function (data) {\r\n                self.setFiltersData(data.filters, appliedFilters, filtersAppliedCounter, data.totalRecords, calculateFilters, null);\r\n                return $.extend(data, {reference: params.reference});\r\n            });\r\n        }\r\n        else {\r\n            return self.dataService.getCollectionEntityData(params).then(function (data) {\r\n                if(self._reference === data.reference){\r\n                    var totalRecords = data.totalRecords;\r\n\r\n                    if (totalRecords > 0) {\r\n                        var referenceType = params.referenceType;\r\n                        if (referenceType === \"FACT\") {\r\n                            self.dataService.getFiltersEntityData(params).then(function (filtersData) {\r\n                                if(self._reference === filtersData.reference){\r\n                                    self.processFiltersData(filtersData, appliedFilters, filtersAppliedCounter, totalRecords, calculateFilters, params.defaultFilterApplied);\r\n                                    self.updateCounterFiltersApplied(appliedFilters);\r\n                                }\r\n                            }).fail( function () {\r\n                                self.hideSortBar();\r\n                            });\r\n                        }\r\n                        else {\r\n                            self.hideSortBar();\r\n                        }\r\n                    }\r\n                    // There is no data but there is an applied filter\r\n                    else if (filtersAppliedCounter > 0) {\r\n                        self.setFiltersData([], appliedFilters, filtersAppliedCounter, totalRecords, false, null);\r\n                        self.updateCounterFiltersApplied(appliedFilters);\r\n                    }\r\n                    else {\r\n                        self.hideSortBar();\r\n                    }\r\n                    return $.extend(data, {reference: params.reference});\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    hideSortBar: function () {\r\n        var self = this;\r\n\r\n        self.pub(\"notify\", { type: \"HIDE-SORT-BUTTONS\", args: {}});\r\n        self.pub(\"notify\", { type: \"HIDE-FILTER-BUTTONANDBAR\", args: {}});\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param filtersData\r\n     * @param appliedFilters\r\n     * @param filtersAppliedCounter\r\n     * @param totalRecords\r\n     * @param calculateFilters\r\n     * @param defaultFilterApplied\r\n     */\r\n    processFiltersData: function (filtersData, appliedFilters, filtersAppliedCounter, totalRecords, calculateFilters, defaultFilterApplied) {\r\n        var self = this;\r\n\r\n        if (defaultFilterApplied) {\r\n            var appliedFilter = {\r\n                properties: {xpath: \"\", type: \"entity\", typeSearch: \"exact\"},\r\n                value: []\r\n            };\r\n            var a, i = -1, count = 0;\r\n            while (a = filtersData[++i]) {\r\n                var data = a.data;\r\n                if (a.type === \"Entity\") {\r\n                    var b, j = -1;\r\n                    while (b = data.defaultValues[++j]) {\r\n                        if (b.applied) {\r\n                            appliedFilter.properties.xpath = a.attribute;\r\n                            appliedFilter.value.push({\"id\": b.id});\r\n                            count++;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (count > 0) {\r\n                appliedFilters.push(appliedFilter);\r\n            }\r\n            filtersAppliedCounter = (typeof filtersAppliedCounter !== \"undefined\") ? filtersAppliedCounter + count : count;\r\n            self.setFiltersData(filtersData, appliedFilters, filtersAppliedCounter, totalRecords, calculateFilters, defaultFilterApplied);\r\n        }\r\n        else {\r\n            self.setFiltersData(filtersData, [], filtersAppliedCounter, totalRecords, calculateFilters, null);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param filters\r\n     * @param filtersApplied\r\n     * @param filtersAppliedCounter\r\n     * @param totalRecords\r\n     * @param calculateFilters\r\n     * @param defaultFilterApplied\r\n     */\r\n    setFiltersData: function (filters, filtersApplied, filtersAppliedCounter, totalRecords, calculateFilters, defaultFilterApplied) {\r\n        var self = this;\r\n        var args = {\r\n            filters: filters || [],\r\n            filtersApplied: filtersApplied,\r\n            filtersAppliedCounter: filtersAppliedCounter || 0,\r\n            totalRecords: totalRecords || 0,\r\n            calculateFilters: calculateFilters || false\r\n        };\r\n\r\n        if (defaultFilterApplied) {\r\n            args.defaultFilterApplied = defaultFilterApplied;\r\n        }\r\n\r\n        self.pub(\"notify\", {\r\n            type: \"SET-FILTERS-DATA\",\r\n            args: args\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders each entity and return a promise, it will be resolved when all entities has been procesed\r\n     * @param data\r\n     * @return {*}\r\n     */\r\n    processEntities: function(data) {\r\n        var self = this;\r\n        var result = [];\r\n        var processEntities = [];\r\n        var defer = new $.Deferred();\r\n        var templateType = (data.referenceType === \"ENTITY\") ? \"Content\" : \"List\";\r\n\r\n        if(data.reference === self._reference){\r\n            bizagi.loader.start(\"rendering\").then( function () {\r\n                $.when(self.getTemplateEngine()).then(\r\n                    $.proxy(function(engine){\r\n                        return $.when.apply($, $.map(data.entities, $.proxy(function(entity) {\r\n                            processEntities.push({ surrogateKey: entity.surrogateKey, entityId: entity.guid });\r\n\r\n                            var entityData = $.extend(entity, { isDefaultTemplate: entity.guidTemplate === null, templateType: templateType });\r\n                            var paramsRender = {contextEvent: this.params.event};\r\n                            return engine.render(entityData, paramsRender);\r\n                        }, this)));\r\n                    }, self)\r\n                ).done( function() {\r\n                    var templates = $.makeArray(arguments);\r\n                    var tmpl;\r\n\r\n                    for (var i = 0, l = data.entities.length; i < l; i++) {\r\n                        tmpl = (l === 1) ? templates[i] : templates[i][0];\r\n                        result.push({tmpl: tmpl, data: data.entities[i]});\r\n                    }\r\n\r\n                    //dont repeat request with the same params\r\n                    var requestRepeat = false;\r\n                    if(typeof self.idCasesOfProcessEntitiesPromise !== \"undefined\" &&\r\n                        self.idCasesOfProcessEntitiesPromise.state() === \"pending\" &&\r\n                        self.lastParamsSendit &&\r\n                        JSON.stringify(processEntities) === self.lastParamsSendit\r\n                    ){\r\n                        defer.reject();\r\n                        requestRepeat = true;\r\n                    }\r\n\r\n                    if(!requestRepeat){\r\n                        // Promesa que retorna id de casos (cuando la entidad es una entidad de proceso) y sera utilizada despus\r\n                        // al renderizar el TMPL - ver renderEntities\r\n                        self.lastParamsSendit = JSON.stringify(processEntities);\r\n                        self.idCasesOfProcessEntitiesPromise = self.dataService.getIdCasesOfProcessEntities(processEntities);\r\n                        $.when(self.idCasesOfProcessEntitiesPromise).done(function(){\r\n                            defer.resolve(result);\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        else{\r\n            defer.reject();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Gets entity data and inject it in the defined template\r\n     * @param entitiesData\r\n     * @param args\r\n     */\r\n    renderEntities: function (entitiesData, args) {\r\n        var self = this;\r\n        var generalDefer = $.Deferred();\r\n        var collectionDeferreds = [];\r\n        var $dataViewList = $(\"#template-dataviewer-list\", self.getContent());\r\n        var entitiesLength = self.entitiesLength = entitiesData.length;\r\n        var $elementsTmpl = $();\r\n\r\n        for (var i = 0; i < entitiesLength; i++) {\r\n            var $template = self.renderTemplate(entitiesData[i], false, args);\r\n            $elementsTmpl.push.apply($elementsTmpl, $template);\r\n        }\r\n\r\n        if ($elementsTmpl.length > 0) {\r\n            $dataViewList.append($elementsTmpl);\r\n            // Dado que la respuesta de este servicio se puede demorar, primero se renderiza todas las entidades\r\n            // y despues se busca cuales de ellas son entidades de proceso\r\n            collectionDeferreds.push(self.getIdCasesOfProcessEntities(entitiesData, args.fromActionLauncher, $dataViewList));\r\n            $.when.apply($, collectionDeferreds).done(function(){\r\n                generalDefer.resolve();\r\n            });\r\n        }\r\n        else {\r\n            $dataViewList.append(self.getEmptyDataMessage());\r\n            generalDefer.resolve();\r\n        }\r\n\r\n        return generalDefer.promise();\r\n    },\r\n\r\n    /**\r\n     * returns the template for the current entity\r\n     * @param entity\r\n     * @param isRefresh\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    renderTemplate: function(entity, isRefresh, params) {\r\n        var self = this;\r\n        var entityData = entity.data || {};\r\n        var surrogateKey = entityData.surrogateKey;\r\n        var guidEntity = entityData.guid;\r\n        var fromActionLauncher = params.fromActionLauncher;\r\n\r\n        //Render card tmpl with data\r\n        var $templateData = self.getTemplate(\"templateEngineElement\").render({\r\n            fromActionLauncher: fromActionLauncher,\r\n            guidEntity: guidEntity,\r\n            isChecked: self.checkAll,\r\n            surrogateKey: surrogateKey\r\n        });\r\n        //Render entity tmpl in card tmpl\r\n        $templateData.find(\"#template\").append(entity.tmpl);\r\n\r\n        return $templateData;\r\n    },\r\n\r\n    /**\r\n     * Get IdCases Of Process Entities and get actions and events\r\n     */\r\n    getIdCasesOfProcessEntities: function (entitiesData, fromActionLauncher, content) {\r\n        var self = this;\r\n        var generalDefer = $.Deferred();\r\n\r\n        if(typeof self.collectionGetActionsDeferred === \"undefined\"){\r\n            self.collectionGetActionsDeferred = [];\r\n        }\r\n\r\n        self.idCasesOfProcessEntitiesPromise.then( function (response) {\r\n            var idCases = [];\r\n            var a, i = -1;\r\n            while (a = response[++i]) {\r\n                var idCase = a.caseId;\r\n                if (typeof idCase !== \"undefined\" && idCase > 0) {\r\n                    var entity = entitiesData.find( function (el) {\r\n                        return el.data.surrogateKey === a.surrogateKey;\r\n                    });\r\n\r\n                    if (typeof entity !== \"undefined\" && typeof idCase !== \"undefined\") {\r\n\r\n                        var data = entity.data || {};\r\n                        var $cardWrapper = $(\"#template-box-wrapper-\" + data.surrogateKey, content);\r\n                        var $casetoolbar = self.casetoolbar.getCaseToolbar({ casetoolbarData: { idcase: idCase, referrer: \"RenderTemplate\"}});\r\n\r\n                        $(\".template-box-header .casetoolbar\", $cardWrapper).append($casetoolbar);\r\n                        $(self.selectorCheckboxItems, $cardWrapper).data(\"caseid\", idCase);\r\n                        idCases.push(idCase);\r\n                        $.extend(data, {idCase: idCase});\r\n                        \r\n                    }\r\n                }\r\n            }\r\n            self.actionsEventsService.render(idCases);\r\n        }).always( function () {\r\n            var i = -1, e;\r\n            var countRequest = Object.keys(entitiesData).length;\r\n            if(self.collectionGetActionsDeferred.length > 0){\r\n                self.collectionGetActionsDeferred = [];\r\n            }\r\n            while (e = entitiesData[++i]) {\r\n                var data = e.data || {};\r\n                self.collectionGetActionsDeferred.push(self.getEntityActionsAndEvents(fromActionLauncher, false, data.guidEntity, data.surrogateKey, data.idCase));\r\n            }\r\n            $.when.apply($, self.collectionGetActionsDeferred).done(function () {\r\n                generalDefer.resolve();\r\n                self.collectionGetActionsDeferred = [];\r\n            });\r\n\r\n\r\n        });\r\n        return generalDefer.promise();\r\n    },\r\n\r\n    /**\r\n     * Get Entity Actions and Events\r\n     * @param fromActionLauncher\r\n     * @param guidEntity\r\n     * @param surrogateKey\r\n     * @param idCase\r\n     * @param isRefresh\r\n     */\r\n    getEntityActionsAndEvents: function (fromActionLauncher, isRefresh, guidEntity, surrogateKey, idCase) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var content = self.getContent();\r\n\r\n        // Get Actions and Events only if it does not come from actionlauncher\r\n        if(!fromActionLauncher) {\r\n            setTimeout( function() {\r\n                var $footer = content.find(\"#template-box-wrapper-\" + surrogateKey + \" .template-box-footer\");\r\n                var params = {\r\n                    actionData: {\r\n                        guidEntity: guidEntity,\r\n                        surrogateKey: surrogateKey\r\n                    },\r\n                    loadEvents: false,\r\n                    isRefresh: isRefresh\r\n                };\r\n\r\n                // If there is idCase then loadEvents\r\n                if (typeof idCase !== \"undefined\" && idCase > 0) {\r\n                    params.actionData.idCase = idCase;\r\n                    params.loadEvents = true;\r\n                }\r\n                // Render loading\r\n                $footer.startLoading({delay: 0, overlay: true});\r\n                // Get actions and events\r\n                $.when(self.actionService.getActionsView(params)).done($.proxy(function (reference, responseActions) {\r\n                    var $actionsView = responseActions.actionsView;\r\n                    var actionsData = responseActions.actionsData;\r\n\r\n                    if(reference === self._reference){\r\n                        var $item = content.find(\"#template-box-wrapper-\" + surrogateKey + \" .template-box-element .template-box-footer\");\r\n                        if ($actionsView) {\r\n                            $item.empty().append($actionsView);\r\n\r\n                            if(actionsData.length > 0 && self.getCheckBox($item).data(\"surrogatekey\") != -1){\r\n                                self.showCheckItem($item);\r\n                                self.pub(\"notify\", {\r\n                                    type: \"SOME-ITEM-ALLOW-SELECT\",\r\n                                    args: {}\r\n                                });\r\n                            }\r\n                            else{\r\n                                self.removeCheckItem($item);\r\n                            }\r\n                        }\r\n                        else{\r\n                            self.removeCheckItem($item);\r\n                        }\r\n                        $footer.endLoading();\r\n                        defer.resolve();\r\n                    }\r\n                }, self, bizagi.clone(self._reference)));\r\n            }, 0);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Get check item by case\r\n     * @param $item\r\n     */\r\n    getCheckBox: function($item){\r\n        var self = this;\r\n        return $item.closest(\".template-box-element\").find(self.selectorCheckboxItems);\r\n    },\r\n\r\n    /**\r\n     * Hide check item\r\n     * @param $item\r\n     */\r\n    removeCheckItem: function($item){\r\n        var self = this;\r\n        self.getCheckBox($item).after(\"<div></div>\").remove();//Add div because CSS with flex\r\n    },\r\n\r\n    /**\r\n     * Show checkbox\r\n     * @param $item\r\n     */\r\n    showCheckItem: function($item){\r\n        var self = this;\r\n        self.getCheckBox($item).show();\r\n    },\r\n\r\n\t/**\r\n\t * Returns the model\r\n\t * @return {{}}\r\n\t */\r\n\tgetCommonActions: function() {\r\n\t\tvar self = this;\r\n\t\tvar model = {};\r\n\r\n\t\tmodel.actions = self.actionService.getCommonActions(self.entitiesSelected);\r\n\t\tmodel.surrogateKeys = [];\r\n\t\tmodel.checkAll = undefined;\r\n\r\n\t\tfor (var surrogateKey in self.entitiesSelected) {\r\n\t\t\tmodel.surrogateKeys.push((typeof surrogateKey === \"string\") ? parseInt(surrogateKey) : surrogateKey);\r\n\t\t}\r\n\t\tmodel.guidEntity = (surrogateKey !== undefined) ? self.entitiesSelected[surrogateKey].guidEntity : \"\";\r\n\r\n\t\tif (model.surrogateKeys.length === 0) {\r\n\t\t\tself.checkAll = false;\r\n\t\t\tmodel.checkAll = false;\r\n\t\t}\r\n        else if (model.surrogateKeys.length == self.entitiesLength) {\r\n\t\t\tself.checkAll = true;\r\n\t\t\tmodel.checkAll = true;\r\n\t\t}\r\n        else if(model.surrogateKeys.length !== self.entitiesLength){\r\n            self.checkAll = false;\r\n            model.checkAll = false;\r\n        }\r\n\r\n        model.itemsSelected = self.entitiesSelected;\r\n\r\n\t\treturn model;\r\n\t},\r\n\r\n\t/**\r\n\t * Handler to hold the entities selected\r\n\t * @param ev\r\n\t */\r\n\tonEntityChecked: function(ev) {\r\n\t\tvar self = this;\r\n\t\tvar $target = $(ev.target);\r\n\t\tvar surrogateKey = $target.data(\"surrogatekey\");\r\n\t\tvar guidentity = $target.data(\"guidentity\");\r\n\t\tvar isChecked = $target.is(\":checked\");\r\n        var caseId = $target.data(\"caseid\");\r\n        var params = {\r\n            surrogateKey: surrogateKey,\r\n            guidEntity: guidentity\r\n        };\r\n\r\n        if (typeof caseId !== \"undefined\" && caseId > 0) {\r\n            params.idCase = caseId;\r\n        }\r\n\r\n\t\tself.entitiesSelected[surrogateKey] = params;\r\n\r\n\t\tif(!isChecked) {\r\n\t\t\tdelete self.entitiesSelected[surrogateKey];\r\n\t\t}\r\n\r\n\t\tself.pub(\"notify\", {type: \"ENABLE-BATCHS-ACTIONS\", args: {commonActions: self.getCommonActions()}});\r\n\t},\r\n\r\n\t/**\r\n\t * Set current value\r\n\t * @param params\r\n\t * @return {*}\r\n\t */\r\n\tsetValues: function(params) {\r\n\t\tvar self = this;\r\n\t\tvar $content = self.getContent();\r\n\t\tvar args = params.args || {};\r\n\t\tvar isChecked = args.value;\r\n\r\n\t\tif($content) {\r\n\t\t\tself.entitiesSelected = {};\r\n\t\t\tvar $inputs = $content.find(self.selectorCheckboxItems);\r\n\r\n\t\t\t$.map($inputs, function(input) {\r\n\t\t\t\t$(input).prop(\"checked\", isChecked);\r\n\r\n\t\t\t\tif(isChecked) {\r\n\t\t\t\t\tvar surrogateKey = $(input).data(\"surrogatekey\"),\r\n\t\t\t\t\t\tguidentity = $(input).data(\"guidentity\"),\r\n                        idCase = $(input).data(\"caseid\");\r\n\r\n\t\t\t\t\tself.entitiesSelected[surrogateKey] = {\r\n\t\t\t\t\t\tsurrogateKey: surrogateKey,\r\n\t\t\t\t\t\tguidEntity: guidentity,\r\n                        idCase: idCase\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tself.checkAll = isChecked;\r\n\r\n\t\t\treturn self.getCommonActions();\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t * @param ev\r\n\t * @param params\r\n\t */\r\n\tonFormActionExecuted: function(ev, params) {\r\n\t\tvar self = this;\r\n\r\n\t\tif(params.refresh) {\r\n\t\t\tself.refreshRegister(params);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t * @param ev\r\n\t * @param params\r\n\t */\r\n\tonFormRuleExecuted: function(ev, params) {\r\n\t\tvar self = this;\r\n\r\n\t\tif(params.refresh) {\r\n\t\t\tself.refreshRegister(params.action);\r\n\t\t}\r\n\t},\r\n\r\n\tonFormExecuted: function (ev, params) {\r\n\t    var self = this;\r\n\r\n\t    if (params.refresh) {\r\n\t        self.refreshRegister(params.action);\r\n\t    }\r\n\t},\r\n\r\n\t/**\r\n\t * Gets data of current register and update it\r\n\t * @param params\r\n\t */\r\n\trefreshRegister: function(params) {\r\n\t\tvar self = this;\r\n\t\tif (self._referrer == \"search\") {\r\n\t\t\tself.updateData({args: {calculateFilters: false}});\r\n\t\t}\r\n\t\telse if (self._referrer == \"dataNavigation\") {\r\n            // It is necessary to send calculateFilters = true so when the data is modified the min and max of\r\n            // each filter is recalculated\r\n            self.updateData({args: {\r\n                calculateFilters: true\r\n            }});\r\n\t\t}\r\n        else {\r\n\t\t\t// Get element to refresh\r\n\t\t\tvar idBox = \"#template-box-wrapper-\" + params.surrogateKey;\r\n\t\t\tvar $templateBox = $(idBox);\r\n\t\t\tvar isChecked = $templateBox.find(\".template-box-header > input:checkbox\").is(\":checked\");\r\n\r\n\t\t\tvar filters = {\r\n\t\t\t\toperator: \"\",\r\n\t\t\t\tfilters: [{\r\n\t\t\t\t\tkey: \"id\",\r\n\t\t\t\t\tvalue: params.surrogateKey\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\r\n\t\t\t$templateBox.startLoading({delay: 250, overlay: true});\r\n\r\n\t\t\t$.when(self.getEntityData({\r\n\t\t\t    reference: params.reference,\r\n\t\t\t    surrogateKey: params.surrogateKey,\r\n\t\t\t    referenceType: params.referenceType,\r\n\t\t\t    xpath: params.xpath,\r\n\t\t\t    guidEntityCurrent: params.guidEntityCurrent,\r\n\t\t\t\tpage: self._page,\r\n\t\t\t\tfilters: filters\r\n\t\t\t})).then( function (data) {\r\n                return self.processEntities(data);\r\n            }).done( function (result) {\r\n                var renderedTemplate = self.renderTemplate(result[0], true, params);\r\n                $templateBox.replaceWith(renderedTemplate);\r\n                $templateBox.endLoading();\r\n                // Restore checked value\r\n                if (isChecked) {\r\n                    $templateBox = $(idBox);\r\n                    $templateBox.find(\".template-box-header > input\").prop(\"checked\", true);\r\n                }\r\n            }).always( function() {\r\n                $templateBox.endLoading();\r\n            });\r\n\t\t}\r\n\t},\r\n\r\n    /**\r\n     *\r\n     */\r\n    router: function() {\r\n    },\r\n\r\n    /**\r\n     * Gets Message when there aren't data\r\n     * @return {*}\r\n     */\r\n    getEmptyDataMessage: function() {\r\n        var self = this;\r\n        var emptyTemplate = self.getTemplate(\"templateEmptyData\");\r\n\r\n        return emptyTemplate.render()[0].outerHTML;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param filtersApplied\r\n     */\r\n    updateCounterFiltersApplied: function(filtersApplied){\r\n        var self = this;\r\n        var counterFilterParams = {\r\n            type: \"UPDATE-COUNTER-FILTERS-APPLIED\",\r\n            args: {\r\n                filtersApplied: filtersApplied\r\n            }\r\n        };\r\n        self.pub(\"notify\", counterFilterParams);\r\n    },\r\n\r\n    /**\r\n     * Detach events\r\n     */\r\n    clean: function() {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n\r\n        self._currentPage = 1;\r\n        self.checkAll = false;\r\n\r\n        $(\"#content-wrapper\").unbind(\"scroll\");\r\n\r\n        if($content) {\r\n            $content.find(\"#template-dataviewer-list\").off(\"click\", self.selectorCheckboxItems);\r\n            self.unsub(\"TEMPLATEENGINE-VIEW\");\r\n            self.unsub(\"SEARCH-ENGINE-VIEW\");\r\n            self.unsub(\"UPDATE-DATATEMPLATE-VIEW\");\r\n            self.unsub(\"GET-COMMON-ACTIONS\");\r\n            self.unsub(\"SET-VALUES\");\r\n            self.actionService.unsubscribe(\"onFormActionExecuted\");\r\n            self.processActionService.unsubscribe(\"onFormRuleExecuted\");\r\n            self.processActionService.unsubscribe(\"onFormExecuted\");\r\n        }\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.templates\", [\"workportalFacade\", \"dataService\", \"actionService\", \"casetoolbar\", \"usersCasesService\", \"actionsEventsService\",\"accumulatedcontext\", \"processActionService\", bizagi.workportal.widgets.templates]);","/*\r\n*   Name: BizAgi Workportal\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define helper functions so the projects can customize via javascript some aspects for the UI appearance and some behaviours\r\n*/\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.override = (typeof (bizagi.override) !== \"undefined\") ? bizagi.override : {};\r\n\r\n/*\r\n*   Allow to customize an url in the workportal\r\n*/\r\nbizagi.override.customWorkportalHandlers = {};\r\nbizagi.override.customizeWorkportalHandler = function(handler, newUrl) {\r\n\r\n\t// Redefine a handler to allow customization\r\n\tbizagi.override.customWorkportalHandlers[handler] = newUrl;\r\n};\r\n\r\nif (bizagi.workportal.services.context) {\r\n    bizagi.workportal.services.context.original = $.extend(true, {}, bizagi.workportal.services.context.prototype);\r\n\t$.extend(bizagi.workportal.services.context.prototype, {\r\n        getUrl: function (service) {\r\n            if (this.context == \"workportal\" && bizagi.override.customWorkportalHandlers[service]) {\r\n            \treturn bizagi.override.customWorkportalHandlers[service];\r\n            }\r\n        \treturn bizagi.workportal.services.context.original.getUrl.apply(this, arguments);\r\n        }\r\n    });\r\n}\r\n\r\n/*\r\n*   Allows to extend widget features by extending the postRender method and calling a custom calllback\r\n*/\r\nbizagi.override.customizeWorkportalWidget = function(widget, extensionMethod) {\r\n\tvar widgetImplementation = bizagi.workportal.desktop.facade.getWidgetImplementation(widget);\r\n\t\r\n    if (widgetImplementation) {\r\n\r\n    \t// Prototype modification\r\n    \teval(widgetImplementation).extend(widgetImplementation, { }, {\r\n    \t\t/*\r\n            *   Override postRender\r\n            */\r\n    \t\tpostRender: function() {\r\n    \t\t\tvar self = this;\r\n\r\n    \t\t\t// Call bizagi implementation\r\n    \t\t\tself._super();\r\n\r\n    \t\t\t// Call custom implementation\r\n    \t\t\tvar content = self.getContent();\r\n    \t\t\tif (extensionMethod) extensionMethod(this, content);\r\n    \t\t}\r\n    \t});\r\n    }\r\n};\r\n\r\n/*\r\n*   Allows to add custom menus to the main menu bar\r\n*/\r\nbizagi.override.customButtons = [];\r\nbizagi.override.addCustomMenuButton = function (button) {\r\n    bizagi.override.customButtons.push(button);\r\n};\r\n// Set an override to menu\r\nif (bizagi.workportal.controllers.menu) {\r\n    bizagi.workportal.controllers.menu.original = $.extend(true, {}, bizagi.workportal.controllers.menu.prototype);\r\n    $.extend(bizagi.workportal.controllers.menu.prototype, {\r\n        postRender: function () {\r\n            var self = this;\r\n            var customButtonTemplate = self.workportalFacade.getTemplate(\"menu.custom-button\");\r\n\r\n            // Render the menu\r\n            return $.when(bizagi.workportal.controllers.menu.original.postRender.apply(this, arguments))\r\n                .pipe(function (result) {\r\n                    var menuButtonContainer = $(\"[data-bizagi-component=menuItems]\", result);\r\n\r\n                    $.each(bizagi.override.customButtons, function (i, button) {\r\n                        \r\n                        if (typeof button.isAvailable == \"function\") {\r\n                            if (!button.isAvailable()) return;\r\n                        }\r\n                        var customButton = $.tmpl(customButtonTemplate, button);\r\n\r\n                        // Bind click handler\r\n                        if (button.submenu == null) {\r\n                            customButton.click(function () {\r\n                                if (button.click) button.click(self);\r\n                            });\r\n                        } else {\r\n                            customButton.click(function () {\r\n                                // Pops up the submenu\r\n                                self.renderSubMenu(customButton, button.submenu, button.click);\r\n                            });\r\n                        }\r\n\r\n                        menuButtonContainer.append(customButton);\r\n                    });\r\n\r\n                    return result;\r\n                });\r\n        }\r\n    });\r\n}\r\n\r\n/*\r\n*   Allows to add custom services\r\n*/\r\nbizagi.override.addDataService = function (functionName, fn) {\r\n    if (bizagi.workportal.services.service) {\r\n        bizagi.workportal.services.service.original = $.extend(true, {}, bizagi.workportal.services.service.prototype);\r\n        \r\n        // Create an extension object\r\n        var extensionObject = { };\r\n        extensionObject[functionName] = fn;\r\n\r\n        // Extend data service\r\n        $.extend(bizagi.workportal.services.service.prototype, extensionObject);\r\n    }\r\n};\r\n\r\n//TODO: How to customize project aspx or ashx without compilation","$.Class.extend(\"bizagi.ui.controls.tmplloader\", {}, {\r\n\r\n    init: function () {\r\n        this.templates = [];\r\n    },\r\n\r\n    loadTemplates: function (tmpls) {\r\n\r\n        var self = this;\r\n        var templatesMap = tmpls || {};\r\n\r\n        var defer = new $.Deferred();\r\n        var arrPromises = [];\r\n\r\n        $.each(templatesMap, function (key, template) {\r\n            var promise = self.loadTemplate(key, template);\r\n            arrPromises.push(promise);\r\n        });\r\n\r\n        $.when.apply($, arrPromises)\r\n                .done(function () {\r\n                    defer.resolve();\r\n                });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    loadTemplate: function (name, path) {\r\n\r\n        var self = this;\r\n        var templates = self.templates;\r\n        var defer = new $.Deferred();\r\n\r\n        if (templates[name]) {\r\n            defer.resolve();\r\n        } else {\r\n            return bizagi.templateService.getTemplate(path)\r\n                    .done(function (tmpl) {\r\n                        templates[name] = tmpl;\r\n                    });\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    getTemplate: function (name) {\r\n\r\n        var self = this;\r\n        var templates = self.templates;\r\n\r\n        if (templates[name]) {\r\n            return templates[name];\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n});\r\n","/**\r\n * Zoom plugin creates a drag and scroll control\r\n *\r\n * @author Andrs Fernando Muoz\r\n */\r\n(function($) {\r\n\r\n\t$.widget(\"diagram.dragScroll\", {\r\n\t\toptions: {\r\n\t\t},\r\n\r\n\t\t_create: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tvar options = this.options;\r\n\t\t\tvar clicked = false;\r\n\t\t\tself.curYPos = 0;\r\n\t\t\tself.curXPos = 0;\r\n\r\n\t\t\t$(self.element).css({\r\n\t\t\t\t'cursor': 'move'\r\n\t\t\t});\r\n\r\n\t\t\t$(self.element).bind(\"mousedown\",function(e){\r\n\t\t\t\tclicked = true;\r\n\r\n\t\t\t\tself.options.$scrollable.data({\r\n\t\t\t\t\t\"clicked\": clicked\r\n\t\t\t\t});\r\n\r\n\t\t\t\tself.curYPos = e.pageY;\r\n\t\t\t\tself.curXPos = e.pageX;\r\n\t\t\t\tself.scrollLeft = self.options.$scrollable.scrollLeft();\r\n\t\t\t\tself.scrollTop = self.options.$scrollable.scrollTop();\r\n\t\t\t\toptions.$scrollable.bind(\"mousemove\",function(e){\r\n\t\t\t\t\tif(clicked){\r\n\t\t\t\t\t\tself._move(e.pageX,e.pageY);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$(self.element).bind(\"mouseup\",function(e){\r\n\t\t\t\tclicked = false;\r\n\t\t\t\tself.options.$scrollable.data({\r\n\t\t\t\t\t\"clicked\": clicked\r\n\t\t\t\t});\r\n\t\t\t\toptions.$scrollable.unbind(\"mousemove\");\r\n\t\t\t});\r\n\r\n\r\n\t\t},\r\n\t\t/**\r\n\t\t * Moves the element\r\n\t\t * @param x, x axis differential\r\n\t\t * @param y, y axis differential\r\n\t\t * @private\r\n\t\t */\r\n\t\t_move: function(x,y){\r\n\t\t\tvar self = this;\r\n\t\t\tvar moveX = self.scrollLeft + self.curXPos - x;\r\n\t\t\tvar moveY = self.scrollTop + self.curYPos - y;\r\n\t\t\tif (moveX != 0 && moveY != 0){\r\n\t\t\t\tself.options.$scrollable.scrollTop(moveY);\r\n\t\t\t\tself.options.$scrollable.scrollLeft(moveX);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\r\n\t\tdestroy: function() {\r\n\t\t\t// Call the base destroy function.\r\n\t\t\t$.Widget.prototype.destroy.call(this);\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n\r\n","/**\r\n * This file contains all keys that can be change the default functionality\r\n * of Bizagi, please use it carefully.\r\n *\r\n * @author Edward J Morales\r\n */\r\n\r\n\r\n// TODO: Please make a documentation for each override\r\n\r\n/**\r\n * Active folders functionality that is used in workportal inbox to create\r\n * categories of process\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableFolder = false;\r\n\r\n/**\r\n * Smart Folders are case repositories that meet certain filters.\r\n * Each smart folder can be associated with a filter, for example,\r\n * all files that have been registered as of a determined date.\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableSmartFolders = false;\r\n\r\n/**\r\n * This functionality allow a new tap within modal window of new case,\r\n * that create a shortcut to most used process\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableListOfRecentProcesses = false;\r\n\r\n\r\n/**\r\n * Unused key. The Author must be define what can do\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableCustomizeReports = false;\r\n\r\n/**\r\n * This key enable within admin menu a new item that will\r\n * open \"Multiple case reassigment\" module\r\n *\r\n * SNAKE-1296\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableMultipleCasesReassigment = false;\r\n\r\n/**\r\n * This key enable within admin menu a new item thah will\r\n * open \"Async ECM Upload\" module\r\n *\r\n * DRAGON-152 Adidas\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableAsyncECMUploadJobs = false;\r\n\r\n/**\r\n * This key enable the capability to print an edit form of a grid\r\n * @type {boolean}\r\n */\r\nbizagi.override.enablePrintFromEditForm = false;\r\n\r\n/**\r\n * This key can be allow debug window in release environments\r\n * @type {boolean}\r\n */\r\nbizagi.enableDebug = false;\r\n\r\n/**\r\n * This key disable old windows and enable new REST development\r\n * @type {boolean}\r\n */\r\n//bizagi.override.disableFrankenstein = (typeof BIZAGI_SERVICE_ACTIVATION !== \"undefined\" && BIZAGI_SERVICE_ACTIVATION) ? true : false;\r\n\r\n\r\n/**\r\n * Disable old query forms and enable new tier using REST services\r\n * @type {boolean}\r\n */\r\nbizagi.override.disableFrankensteinQueryForms = true;\r\n\r\n/**\r\n * Change default behavior of grid column sort\r\n * @type String\r\n * @example desc || asc\r\n */\r\n//bizagi.override.gridDefaultSortBy= \"desc\";\r\n\r\n/**\r\n * Expose interface to access to DOM elements\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableE2EInterface = true;\r\n\r\n/**\r\n * Disable old inbox\r\n * @type {boolean}\r\n */\r\nbizagi.override.disableOldInbox = true;\r\n\r\n/**\r\n * Time out to remove elements that not will be used anymore\r\n * @type {number} Milliseconds\r\n */\r\nbizagi.override.disposeTime = 50;\r\n\r\n/**\r\n * Enable REST batch request functionality\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableBatchRequest = true;\r\n\r\n/**\r\n * force all request that consume a REST through Web API will be sending in a batch request\r\n * @type {boolean}\r\n */\r\nbizagi.override.forceBatchRequest = false;\r\n\r\n/**\r\n * Security option to enable visualization of current assignee\r\n * @type {boolean}\r\n */\r\nbizagi.override.showAssignees = true;\r\n\r\n/**\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableMySearch = true;\r\n\r\n/**\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableSecurityCaseDashBoard = false;\r\n\r\n/**\r\n * Show classic view(Sub levels of application and entities)\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableQueriesClassicMenu = false;\r\n\r\n\r\nbizagi.override.disableAbortCases = false;\r\n\r\n\r\n\r\n/**\r\n * Enable \"plus icon\" on inbox, and load Adhoc Process module\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableAdhocProcess = false;\r\n\r\n/**\r\n * Enable \"BCC/CC\" feature for Notification Task on Live Processes\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableCCBCCFeatureOnLiveProcesses = true;\r\n\r\n/**\r\n * Enable \"Review Mode\" feature on Live Processes\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableReviewModeFeatureOnLiveProcesses = true;\r\n\r\n/**\r\n * Enable \"Filter by process grouo\" feature on Live Processes\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableFilterByProcessGroupOnLiveProcesses = false;\r\n\r\n/**\r\n * Enable \"Support localization in the process modeler\" feature on Live Processes\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableLocalizationInModelerOnLiveProcesses = true;\r\n\r\n/**\r\n * Enable \"Support predefined performers in the process modeler\" feature on Live Processes\r\n * @type {boolean}\r\n */\r\nbizagi.override.enablePredefinedPerformersOnLiveProcesses = true;\r\n\r\n\r\n/**\r\n * Enable \"Show timeline icon in inbox\" feature on Workportal\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableFeatureShowTimelineButton = true;\r\n\r\n/**\r\n * Enable \"Display Options\" feature on Workportal\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableFeatureDisplayOptions = false;\r\n\r\n/**\r\n * Enable \"Mazimize Modals\" option inside  \"Display Options\" feature on Workportal\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableMaximizeModalsOption = false;\r\n\r\n/**\r\n * Enable \"Start Page\" option inside  \"Display Options\" feature on Workportal\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableStartPageDisplayOption = false;\r\n\r\n/**\r\n * Enable \"Ping to Server\" feature on Workportal\r\n * @type {boolean}\r\n */\r\nbizagi.override.enablePing = false;\r\n\r\n/**\r\n* Use multiaction implementation for get ECM metadata\r\n* @type {boolean}\r\n*/\r\nbizagi.override.enableECMMetadataMultiaction = true;\r\n\r\n /* Validate the form before than buttons' actions\r\n */\r\nbizagi.override.validateGridsOnButtonClick = false;\r\n\r\n/* Enable custom formats form\r\n */\r\nbizagi.override.enableCustomFormats = false;\r\n\r\n/* Enable share activity\r\n */\r\nbizagi.override.enableShareActivity = true;\r\n\r\n/* \r\n * Enable format in Money type column in the queries results\r\n */\r\nbizagi.override.enableFormatMoneyColumnQueryResult = true;\r\n","\r\n/**\r\n *   Name: Bizagi Workportal Desktop Dashboard Controller\r\n *   Author: Mauricio Snchez - Alexander Mejia\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.dashboard\", {\r\n\r\n    data: {\r\n        \"home\": [{\r\n            type: \"cases\",\r\n            title: \"workportal-widget-dashboard-cases\",\r\n            items: [{\r\n                \"title\": \"workportal-widget-dashboard-pendings-title\",\r\n                \"iconclass\": \"pendings-ico\",\r\n                \"icon\": \"watch-pending-outline\",\r\n                \"data\": \"pendings\"\r\n            }, {\r\n                \"title\": \"workportal-widget-dashboard-favorites-title\",\r\n                \"iconclass\": \"star-ico\",\r\n                \"icon\": \"star\",\r\n                \"data\": \"following\"\r\n            }]\r\n        }]\r\n    }\r\n\r\n}, {\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function(workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"dashboard\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.dashboard\").concat(\"#dashboard-wrapper\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function() {\r\n        var self = this,\r\n            template;\r\n\r\n        template = self.getTemplate(\"dashboard\");\r\n        self.content = template.render(self.getData());\r\n\r\n        return self.content;\r\n\r\n    },\r\n\r\n    /**\r\n     * returns data\r\n     */\r\n    getData: function() {\r\n        var self = this,\r\n            result = {},\r\n            data = self.Class.data;\r\n\r\n\r\n        var content = data.home.slice(0);\r\n\r\n        result.home = $.map(content, function(item) {\r\n            item.title = bizagi.localization.getResource(item.title);\r\n            for (var i = 0, l = item.items.length; i < l; i++) {\r\n                item.items[i].title = bizagi.localization.getResource(item.items[i].title);\r\n            }\r\n            return item;\r\n        });\r\n\r\n        return result;\r\n\r\n    },\r\n\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function() {\r\n        var self = this,\r\n            $content = self.getContent();\r\n\r\n        $content.closest(\".wdg-dash-board\").on(\"click\", \".wdg-db-card\", $.proxy(self.onShowCases, self));\r\n        $(window).trigger(\"resize\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    clean: function() {\r\n        var self = this,\r\n            $content = self.getContent();\r\n\r\n        if ($content) {\r\n            $content.closest(\".wdg-dash-board\").off(\"click\", \".wdg-db-card\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Shows the cases related to action clicked\r\n     */\r\n    onShowCases: function(ev) {\r\n        var self = this,\r\n            $target = $(ev.target),\r\n            $route = $target.closest(\".wdg-db-card\").data(\"route\");\r\n\r\n        var $title = $target.closest(\".wdg-db-card\").find(\".wdg-db-title\");\r\n\r\n        self.pub(\"notify\", {\r\n            type: \"CASES-TEMPLATE-VIEW\",\r\n            args: {\r\n                histName: $.trim($title.text()),\r\n                page: 1,\r\n                level: 2,\r\n                route: $route,\r\n                idworkflow: \"\"\r\n            }\r\n        });\r\n    }\r\n});\r\nbizagi.injector.register(\"bizagi.workportal.widgets.dashboard\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.dashboard]);\r\n","/**\r\n * Bizagi Workportal Desktop Stuff Controller\r\n * @author Alexander Mejia\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.stuff\", {}, {\r\n\t/**\r\n\t * Constructor\r\n\t * @param workportalFacade\r\n\t * @param dataService\r\n\t * @param accumulatedcontext\r\n\t * @param params\r\n\t */\r\n\tinit: function(workportalFacade, dataService, accumulatedcontext, params) {\r\n\t\tvar self = this;\r\n        self.accumulatedcontext = accumulatedcontext;\r\n\r\n\t\t// Call base\r\n\t\tself._super(workportalFacade, dataService, params);\r\n\t\t//Load templates\r\n\t\tself.loadTemplates({\r\n\t\t\t\"stuff\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.stuff\").concat(\"#stuff-wrapper\")\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * Renders the template defined in the widget\r\n\t * @return {*}\r\n\t */\r\n\trenderContent: function() {\r\n\t\tvar self = this;\r\n\t\tvar template = self.getTemplate(\"stuff\");\r\n\r\n        return $.when(self.getData()).done(function(data) {\r\n            self.content = data.collections.length > 0 ? template.render(data) : \"\";\r\n            return self.content;\r\n        });\r\n\t},\r\n\t/**\r\n\t * links events with handlers\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar $content = self.getContent();\r\n\r\n\t\t$('.wdg-stf-card', $content).on(\"click\", $.proxy(self.onClickEntity, self));\r\n\t\tself.sub('TEMPLATEENGINE-VIEW', $.proxy(self.selectItem, self));\r\n\t},\r\n    /**\r\n     *\r\n     * @returns {*}\r\n     */\r\n    getData: function() {\r\n        var self = this;\r\n\r\n        return $.when(self.dataService.getUserStuff({icon:true})).then(function(data) {\r\n            data = self.buildModel(data) || {};\r\n            return {\r\n                title: bizagi.localization.getResource(\"workportal-widget-dashboard-stuff\"),\r\n                collections: data\r\n            };\r\n        });\r\n    },\r\n    /**\r\n     * Add style to the selected item\r\n     */\r\n\tselectItem: function () {\r\n\t    var self = this;\r\n\t\t$('.wdg-stf-card', self.content).removeClass('wdg-stf-selected');\r\n\t    $(\"#\" + arguments[1].args.reference, self.content).addClass('wdg-stf-selected');\r\n\t},\r\n\t/**\r\n\t * Holds a refence to each collection\r\n\t * @param data\r\n\t * @return {Array}\r\n\t */\r\n\tbuildModel: function(data) {\r\n        var self = this;\r\n\t\tvar collections = {};\r\n        var items = [];\r\n        data = data || {};\r\n\t\tself.model = {};\r\n\r\n\t\tfor (var i = 0, lf = data.length; i < lf; i++) {\r\n\t\t\tvar item = data[i];\r\n\t\t\titem.guid = Math.guid();\r\n\t\t\tcollections[item.guid] = item;\r\n\t\t\titems.push(item);\r\n\t\t}\r\n\r\n\t\tself.model.collections = collections;\r\n\r\n\t\treturn items;\r\n\t},\r\n\t/**\r\n\t * Raises the execution of templates for the entity selected\r\n\t * @param ev\r\n\t */\r\n\tonClickEntity: function(ev) {\r\n\t\tvar self = this;\r\n\t\tvar target = $(ev.target).closest('.wdg-stf-card');\r\n\t\tvar item = self.model.collections[target.data('guid')];\r\n\t\tvar args = {\r\n            calculateFilters: true,\r\n            filters: [],\r\n            fromActionLauncher: false,\r\n            histName: target.data('title') || item.displayName,\r\n            level: 1,\r\n            page: 1,\r\n            reference: item.reference,\r\n            referenceType: item.referenceType,\r\n            surrogateKey: item.surrogateKey\r\n\t\t};\r\n\r\n        if (typeof item.entityId !== \"undefined\" && item.entityId) {\r\n            args.guidEntityCurrent = item.entityId;\r\n        }\r\n        if (typeof item.xpath !== \"undefined\" && item.xpath) {\r\n            args.xpath = item.xpath;\r\n        }\r\n\r\n\t\tself.accumulatedcontext.clean();\r\n\r\n\t\tself.pubDeadLockDetection(\"notify\", {type: \"TEMPLATEENGINE-VIEW\", args: args});\r\n\t},\r\n\t/**\r\n\t *  Detach events linked\r\n\t */\r\n\tclean: function() {\r\n\t\tvar self = this;\r\n\t\tvar $content = self.getContent();\r\n\r\n\t\tif($content) {\r\n\t\t\t$('.wdg-stf-card', $content).off('click');\r\n\t\t\tself.unsub('TEMPLATEENGINE-VIEW');\r\n\t\t}\r\n\t}\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.stuff', ['workportalFacade', 'dataService', 'accumulatedcontext', bizagi.workportal.widgets.stuff]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Base\r\n *   Author: David Romero Estrada\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.base\", {}, {\r\n\r\n    /*\r\n    * Initilize\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n\r\n        var self = this;\r\n        params = params || {};\r\n        self.differenceMillisecondsServer = params.differenceMillisecondsServer;\r\n        self.uploadMaxFilesSize = bizagi.currentUser.uploadMaxFileSize;\r\n        self.supportFileExt = [\r\n            \".jpg\",\r\n            \".pdf\",\r\n            \".txt\",\r\n            \".png\",\r\n            \".pptx\",\r\n            \".docx\",\r\n            \".gif\",\r\n            \".rtfx\",\r\n            \".xlsx\",\r\n            \".zip\",\r\n            \".rar\"\r\n        ];\r\n\r\n        // Set radNumber\r\n        self.radNumber = params.radNumber;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        \r\n        if (!self.differenceMillisecondsServer) {\r\n            return $.when(self.dataService.getDateServer()).done(function (response) {\r\n                self.differenceMillisecondsServer = bizagi.util.dateFormatter.getDifferenceBetweenDates(new Date(), new Date(response.date), \"milliseconds\");\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    * Calculate Server Date\r\n    */\r\n    getDateServer: function () {\r\n\r\n        var dateLocal = new Date();\r\n        \r\n        return dateLocal.getTime() + this.differenceMillisecondsServer;\r\n    },\r\n\r\n    mergePropertiesActivitiesWithWorkitems: function(activities, workItems){\r\n        activities.forEach(function(activity){\r\n            var workItemFilter = workItems.filter(function(workItem){\r\n                return workItem.guidActivity === activity.id;\r\n            });\r\n            if(workItemFilter.length > 0){\r\n                $.extend(activity, {\r\n                    startDate: workItemFilter[0].wiEntryDate || null,\r\n                    finishDate: workItemFilter[0].wiSolutionDate || null,\r\n                    idWorkItem: workItemFilter[0].idWorkItem,\r\n                    workItemState: workItemFilter[0].workItemState,\r\n                    idCase: workItemFilter[0].idCase,\r\n                    estimatedFinishDate: workItemFilter[0].wiEstimatedSolutionDate || activity.estimatedFinishDate\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.base\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.base], true);","/*\r\n *   Name: Bizagi Workportal Desktop descontextualized plans Controller\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend('bizagi.workportal.widgets.decontextualized.plans', {\r\n    data: {\r\n        title: 'workportal-widget-dashboard-decontextualized-plans-title',\r\n        items: [\r\n            {\r\n                'title': 'workportal-widget-dashboard-decontextualized-plans-pendings-title',\r\n                'description': 'workportal-widget-dashboard-decontextualized-plans-pendings-description',\r\n                'iconclass': 'star-ico',\r\n                'icon': 'pending',\r\n                'data': 'PENDING'\r\n            },\r\n            {\r\n                'title': 'workportal-widget-dashboard-decontextualized-plans-running-title',\r\n                'description': 'workportal-widget-dashboard-decontextualized-plans-running-description',\r\n                'iconclass': 'star-ico',\r\n                'icon': 'executing',\r\n                'data': 'EXECUTING'\r\n            },\r\n            {\r\n                'title': 'workportal-widget-dashboard-decontextualized-plans-completed-title',\r\n                'description': 'workportal-widget-dashboard-decontextualized-plans-completed-description',\r\n                'iconclass': 'star-ico',\r\n                'icon': 'closed',\r\n                'data': 'CLOSED'\r\n            }\r\n        ]\r\n    }\r\n}, {\r\n    /**\r\n     *   Constructor\r\n     * @param workportalFacade\r\n     * @param dataService\r\n     * @param params\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            'decontextualized.plans': bizagi.getTemplate('bizagi.workportal.desktop.widget.decontextualized.plans').concat('#plans-wrapper')\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     * @return {*}\r\n     */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template,\r\n            data,\r\n            filteredData = {};\r\n        template = self.getTemplate(\"decontextualized.plans\");\r\n\r\n        if(bizagi.menuSecurity.Plans){\r\n            data = self.getData();\r\n            filteredData.title = data.title;\r\n            self.content = template.render(data);\r\n        }\r\n        else{\r\n            self.content = $(\"<div></div>\")\r\n        }\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this,\r\n            $content = self.getContent();\r\n        $.when(self.getServerDateDifference()).then(function (resolveGetDateServer) {});\r\n        $('.wdg-plans-card', $content).on('click', $.proxy(self.onClickCard, self));\r\n    },\r\n\r\n    /**\r\n     * Gets data, Fact entities related with stakeholders\r\n     * @return {{}}\r\n     */\r\n    getData: function () {\r\n        var self = this,\r\n            result = {},\r\n            data = self.Class.data;\r\n        result.items = $.map(data.items, function (item) {\r\n            item.title = bizagi.localization.getResource(item.title);\r\n            item.description = bizagi.localization.getResource(item.description);\r\n            return item;\r\n        });\r\n        result.title = bizagi.localization.getResource(data.title);\r\n        return result;\r\n    },\r\n\r\n\r\n    /**\r\n     * Raises the execution of templates for the entity selected\r\n     * @param ev\r\n     */\r\n    onClickCard: function (ev) {\r\n        var self = this,\r\n            target = $(ev.target).closest('.wdg-plans-card'),\r\n            title = target.data('title'),\r\n            data = target.data('data');\r\n        var args = {\r\n            histName: title,\r\n            planState: data,\r\n            flowContext: 'FLOW-DECONTEXTUALIZED-PLANS',\r\n            isOpen: true,//TODO  fix state for decontextualized plans,\r\n            level:1\r\n        };\r\n        self.pub('notify', {\r\n            type: 'PLANS-VIEW',\r\n            args: $.extend(self.params,args)\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @returns {*}\r\n     */\r\n    getServerDateDifference: function () {\r\n        var self = this;\r\n        return self.dataService.getDateServer().done(function (response) {\r\n            self.params.differenceMillisecondsServer = bizagi.util.dateFormatter.getDifferenceBetweenDates(new Date(), new Date(response.date), 'milliseconds');\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Detach events linked\r\n     */\r\n    clean: function () {\r\n        var self = this,\r\n           $content = self.getContent();\r\n\r\n        if ($content) {\r\n            $('.wdg-plans-card', $content).off('click');\r\n        }\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.decontextualized.plans', ['workportalFacade', 'dataService', bizagi.workportal.widgets.decontextualized.plans]);\r\n","/**\r\n *   Name: Bizagi Workportal Desktop Navigator Controller\r\n *   Author: Mauricio Snchez - Alexander Mejia\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.navigator\", {}, {\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, accumulatedcontext, params) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        self.flagDisplayDate = true;\r\n        self.printFormCommand = new bizagi.workportal.command.printform(self.workportalFacade);\r\n        self.fromClickBreadCrumb = false;\r\n        self.caseLink = params.caseLink;\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"navigator\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.navigator\").concat(\"#navigator-wrapper\"),\r\n            \"child\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.navigator\").concat(\"#navigator-child\"),\r\n            \"popup-release\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.navigator\").concat(\"#navigator-popup-release\")\r\n        });\r\n        self.accumulatedcontext = accumulatedcontext;\r\n\r\n        self.releaseDialogBox = {};\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {       \r\n        var self = this;\r\n        var template = self.getTemplate(\"navigator\");\r\n        self.content = template.render($.extend(self.getDataObj(), {security: bizagi.menuSecurity}));\r\n        bizagi.navigator = bizagi.navigator || { info: {} };\r\n        self.info = bizagi.navigator.info;\r\n        self._level = Object.keys(self.info).length - 1;\r\n        $(\".navbar-print\", self.content).on(\"click\", $.proxy(self.printCase, self));\r\n        $(\".navbar-back\", self.content).on(\"click\", $.proxy(self.goToBack, self));\r\n        $(\".navbar-assignation-everyone > .ae-action\", self.content).on(\"click\", $.proxy(self.assignationEveryoneAction, self));\r\n\r\n        self.releaseDialogBox.formContent = self.getTemplate(\"popup-release\").render({});\r\n\r\n        return self.content;\r\n    },\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var $container = content.find(\"ul\");\r\n        self.sub(\"NAVIGATE\", $.proxy(self.refresh, self));\r\n        self.sub(\"UPDATE_LASTCRUMBPARAMS_INFO\", $.proxy(self.updateLastCrumbParamsInfo, self));\r\n        self.sub(\"NAVIGATOR_GETLEVEL\", function(){\r\n            return self.getLevel();\r\n        });\r\n        self.sub(\"NAVIGATOR_BACK\", $.proxy(self.goToPreviousCrumb, self));\r\n        $container.on(\"click\", \"li\", $.proxy(self.crumbEvent, self));\r\n\r\n        self.plugins = {};\r\n        self.plugins.popupRelease = {\r\n            form: {\r\n                buttonAccept: $(\"#button-accept-release\", self.releaseDialogBox.formContent),\r\n                buttonCancel: $(\"#button-cancel-release\", self.releaseDialogBox.formContent)\r\n            }\r\n        };\r\n\r\n        self.plugins.popupRelease.form.buttonAccept.on(\"click\", $.proxy(self.onClickAcceptRelease, self));\r\n        self.plugins.popupRelease.form.buttonCancel.on(\"click\", $.proxy(self.onClickCancelRelease, self));\r\n    },\r\n\r\n    getBreadCrumbInfo: function () {\r\n        return bizagi.navigator.info;\r\n    },\r\n\r\n    setBreadCrumbInfo: function (info) {\r\n        bizagi.navigator.info = info\r\n    },\r\n\r\n    drawBreadCrumb: function (breadCrumbInfo, showSteps) {\r\n        var self = this;\r\n        var template = self.getTemplate(\"navigator\");\r\n        $(self.content).find(\"ul\").html('');\r\n        if (showSteps) {\r\n            for (var i = -1; i < Object.keys(breadCrumbInfo).length - 1; i += 1) {\r\n                var crumbItem = breadCrumbInfo[i];\r\n                crumbItem.surrogateKey = i;\r\n                var crumbContent = self.drawCrumb(crumbItem);\r\n                $(self.content).find(\"ul\").append(crumbContent);\r\n            }\r\n        }\r\n    },\r\n\r\n    drawCrumb: function (itemCrumb) {\r\n        var self = this;\r\n        var name = itemCrumb.args.histName;\r\n        var isPrincipalHome = false;\r\n        var template = self.getTemplate(\"child\");\r\n        var child = template.render({\r\n            surrogateKey: itemCrumb.surrogateKey,\r\n            name: name,\r\n            isPrincipalHome: isPrincipalHome\r\n        });\r\n        return child;\r\n    },\r\n    crumbEvent: function (event) {\r\n        var self = this;\r\n        var itemCrumb = self.info[$(event.target).data(\"surrogatekey\")];\r\n        self.goToCrumb(itemCrumb, event);\r\n    },\r\n\r\n    goToCrumb: function (crumb, event) {\r\n        var self = this;\r\n        if (crumb) {\r\n            var args = crumb.args;\r\n            var skipRefresh = false;\r\n            var contextActivity = this.getParentContext(crumb.context);\r\n            if (contextActivity == \"TEMPLATEENGINE-VIEW\" || contextActivity == \"SEARCH-ENGINE-VIEW\") {\r\n                skipRefresh = true;\r\n                if(event && event.target){\r\n                    var index = parseInt($(event.target).data(\"surrogatekey\"), 10) + 1;\r\n                    self.accumulatedcontext.cutContext(index);\r\n                }\r\n            }\r\n            this.deleteRemainingCrumbs(crumb);\r\n            self.pub(\"notify\", {\r\n                skipRefresh: skipRefresh,\r\n                type: contextActivity,\r\n                args: $.extend(args, { showContextByMenuDashboard: contextActivity })\r\n            });\r\n        }\r\n    },\r\n\r\n    goToPreviousCrumb: function () {\r\n        var self = this;\r\n        var pathSize = Object.keys(self.info).length;\r\n        var crumbBack = self.info[pathSize - 3];\r\n        if (!crumbBack) {\r\n            crumbBack = self.info[pathSize - 2];\r\n        }\r\n        self.goToCrumb(crumbBack);\r\n    },\r\n\r\n    deleteRemainingCrumbs: function (itemCrumb) {\r\n        var self = this;\r\n        $.each(self.info, function (key, crumbItem) {\r\n            if (itemCrumb.surrogateKey < parseInt(key, 10)) {\r\n                delete self.info[key];\r\n            }\r\n        });\r\n    },\r\n\r\n    getParentContext: function (context) {        \r\n        if (context === \"OVERVIEW\" || context === \"COMMENTS\" || context === \"FILES\" || context === \"TIMELINE\") {\r\n            return \"ACTIVITY\";\r\n        }\r\n        else if (context === \"ACTIVITYPLANOVERVIEW\" || context === \"ACTIVITYPLANCOMMENTS\" || context === \"ACTIVITYPLANFILES\" || context === \"ACTIVITYPLANTIMELINE\") {\r\n            return \"ACTIVITYPLAN\";\r\n        }\r\n        else if (context === \"PLANSIDEBAR\" || context === \"EDITACTIVITY\" || context === \"PLANACTIVITIES\" || context === \"PLANCOMMENTS\" || context === \"PLANFILES\" || context === \"PLANTIMELINE\") {\r\n            return \"PLANACTIVITIES\";\r\n        }\r\n        return context;\r\n    },\r\n\r\n    resetBreadCrumb: function (params) {\r\n        var self = this;\r\n        self.info = {};\r\n        self.info[-1] = self.copyDataObjectWithoutReference(params);\r\n    },\r\n\r\n    updateInfo: function (params) {\r\n        var self = this;\r\n        var pathSize = Object.keys(self.info).length;\r\n        if(params.args.level && params.args.level < pathSize && params.args.level > 0){\r\n            for(var j = params.args.level - 1; j < pathSize - 1; j += 1){\r\n                delete self.info[j];\r\n            }\r\n            pathSize = params.args.level;\r\n        }\r\n\r\n        var lastCrumb = self.info[pathSize - 2];\r\n        var secondLastCrumb = self.info[pathSize - 3];\r\n        if (params.context == \"HOME\" || (params.context === \"SEARCH-ENGINE-VIEW\" && typeof params.args.reference === \"undefined\")) {//reset breadCrumb\r\n            this.resetBreadCrumb(params);//clean breadcrumb and add new item with entity name\r\n        }\r\n        else if (params.context == \"ACTIVITY\" || params.context == \"ACTIVITYPLAN\") {\r\n            if (secondLastCrumb && self.getParentContext(params.context) == self.getParentContext(secondLastCrumb.context)) {\r\n                self.cleanBreadCumb(secondLastCrumb, params, 3);\r\n            } else if (lastCrumb && self.getParentContext(params.context) == self.getParentContext(lastCrumb.context)) {\r\n                self.cleanBreadCumb(lastCrumb, params, 2);\r\n            } else {\r\n                self.info[pathSize - 1] = self.copyDataObjectWithoutReference(params);\r\n            }\r\n        }\r\n        else if (params.context == \"TEMPLATEENGINE-VIEW\" || params.context === \"SEARCH-ENGINE-VIEW\") {\r\n            var firstCrumb = self.info[-1];\r\n            if (firstCrumb && firstCrumb.context != \"TEMPLATEENGINE-VIEW\" &&\r\n                firstCrumb.context != \"SEARCH-ENGINE-VIEW\" &&\r\n                firstCrumb.context != \"HOME\") {\r\n                self.info = {};\r\n                pathSize = Object.keys(self.info).length;\r\n                lastCrumb = null;\r\n            }\r\n            if (params.args.referenceType == \"FACT\" || params.args.referenceType == \"VIRTUAL\") {\r\n                var factCrumbItem = self.hasGuidEntityInBreadCrumb(params.args.guidEntityCurrent);\r\n                var newFactCrumbItem = self.copyDataObjectWithoutReference(params);\r\n                if (params.args.level == 1) {\r\n                    self.info = {};\r\n                    self.info[-1] = newFactCrumbItem;\r\n                }\r\n                else if (lastCrumb && lastCrumb.args && lastCrumb.args.level == params.args.level) {\r\n                    self.cleanBreadCumb(lastCrumb, params, 2);\r\n                }else if (!factCrumbItem){\r\n                    self.info[pathSize - 1] = newFactCrumbItem;\r\n                }else{\r\n                    newFactCrumbItem.surrogateKey = factCrumbItem.surrogateKey;\r\n                    self.info[newFactCrumbItem.surrogateKey] = newFactCrumbItem;\r\n                    self.deleteRemainingCrumbs(newFactCrumbItem);\r\n                }\r\n            } else  if(params.args.referenceType == \"ENTITY\"){\r\n                if(params.args.eventType != \"DATA-NAVIGATION\" && !self.hasXpathInBreadCrumb(params.args.xpath) ){\r\n                    self.info[pathSize - 1] = self.copyDataObjectWithoutReference(params);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (lastCrumb && self.getParentContext(params.context) == self.getParentContext(lastCrumb.context)) {\r\n                self.cleanBreadCumb(lastCrumb, params, 2);\r\n            } else {\r\n                self.info[pathSize - 1] = self.copyDataObjectWithoutReference(params);\r\n            }\r\n        }\r\n        self.setBreadCrumbInfo(self.info);\r\n    },\r\n\r\n    updateLastCrumbParamsInfo: function (event, params){\r\n        var self = this;\r\n        var pathSize = Object.keys(self.info).length;\r\n        if(pathSize > 0){\r\n            $.extend(self.info[pathSize - 2].args, self.copyDataObjectWithoutReference(params.args));\r\n        }\r\n    },\r\n\r\n    hasXpathInBreadCrumb: function (xpath) {\r\n        var self = this;\r\n        for (var i = -1; i < Object.keys(bizagi.navigator.info).length - 1; i += 1) {\r\n            var crumbItem = bizagi.navigator.info[i];\r\n            if (crumbItem.args.xpath == xpath) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n   hasGuidEntityInBreadCrumb: function (guidEntity){\r\n       var self = this;\r\n       for (var i = -1; i < Object.keys(bizagi.navigator.info).length - 1; i += 1) {\r\n           var crumbItem = bizagi.navigator.info[i];\r\n           if (crumbItem.args.guidEntityCurrent == guidEntity) {\r\n               return crumbItem;\r\n           }\r\n       }\r\n       return false;\r\n   },\r\n\r\n    cleanBreadCumb: function (crumb, params, steps) {\r\n        var self = this;\r\n        var pathSize = Object.keys(self.info).length;\r\n        crumb = self.copyDataObjectWithoutReference(params);\r\n        self.info[pathSize - steps] = crumb;\r\n        this.deleteRemainingCrumbs(crumb);\r\n    },\r\n\r\n    drawDateNavigator: function (params) {\r\n        var self = this;\r\n        var currentLevel = Object.keys(self.info).length;\r\n        var showDateNavigator = (currentLevel == 1);\r\n        if (params.args.showDateNavigator === false) {\r\n            showDateNavigator = false;\r\n        }\r\n        self.onDisplayDate(showDateNavigator);\r\n    },\r\n\r\n    //Events for recalculate width of home-navbar (back, print, etc.)\r\n    recalculateHomeNavbar: function (params) {\r\n        var self = this;\r\n        if (params.context != \"TEMPLATEENGINE-VIEW\" || params.context != \"SEARCH-ENGINE-VIEW\") {\r\n            self.setWidthToNavigationPanel();\r\n            $(window).resize(function () {\r\n                self.setWidthToNavigationPanel();\r\n            });\r\n            self.subscribe(\"openCloseSidebar\", function () {\r\n                self.setWidthToNavigationPanel();\r\n            });\r\n            if(params.context == \"HOME\"){\r\n                $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"disabled-right-sidebar\");\r\n                $(\"#ui-bizagi-wp-project-homeportal-main\").removeClass(\"enabled-right-sidebar\");\r\n            }\r\n        }\r\n    },\r\n\r\n    setWidthToNavigationPanel: function(){\r\n        var self = this;\r\n        var navigationPanel = self.content.parent();\r\n        $(self.content, navigationPanel).width($(navigationPanel).width() + 60);\r\n    },\r\n\r\n    setEnabledLeftSidebar: function (params) {\r\n        var self = this;\r\n        if (params.data && params.data.belongs) {\r\n            if (params.data.belongs.toLeftSidebarCD) {\r\n                $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"enabledLeftSidebar\");\r\n            }\r\n            else {\r\n                $(\"#ui-bizagi-wp-project-homeportal-main\").removeClass(\"enabledLeftSidebar\");\r\n            }\r\n        }\r\n    },\r\n\r\n    setEnabledRightSidebar: function (params) {\r\n        var self = this;\r\n        if (params.data && params.data.belongs) {\r\n            if (params.data.belongs.toRightSidebarCD) {\r\n                $(\"#ui-bizagi-wp-project-homeportal-main\").removeClass(\"disabled-right-sidebar\");\r\n                $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"enabled-right-sidebar\");\r\n            }\r\n            else {\r\n                $(\"#ui-bizagi-wp-project-homeportal-main\").removeClass(\"enabled-right-sidebar\");\r\n                $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"disabled-right-sidebar\");\r\n            }\r\n        }\r\n    },\r\n\r\n    //Show back button only in activity or plan context\r\n    setEnabledBreadCrumb: function (params) {\r\n        var self = this;\r\n        if (params.context == \"ACTIVITY\" || params.context == \"ACTIVITYPLAN\") {\r\n            self.setEnabledBackButton();\r\n            $(\".nav-items-ctn\", self.content).hide();\r\n            $(\".nav-items-ctn\", self.content).removeClass(\"toLeft\");\r\n            $(\".nav-items-ctn\", self.content).addClass(\"clearfix\");\r\n        }\r\n        else {\r\n            $(\".navbar-back\", self.content).hide();\r\n            $(\".nav-items-ctn\", self.content).show();\r\n            $(\".nav-items-ctn\", self.content).addClass(\"toLeft\");\r\n            $(\".nav-items-ctn\", self.content).removeClass(\"clearfix\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Hide back button if from caseLink, only one time.\r\n     */\r\n    setEnabledBackButton: function(){\r\n        var self = this;\r\n        if(self.caseLink === true){\r\n            self.caseLink = false;\r\n            $(\".navbar-back\", self.content).hide();\r\n        }\r\n        else{\r\n            $(\".navbar-back\", self.content).show();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Return actual level.\r\n     */\r\n    getLevel: function () {\r\n        var self = this;\r\n        return Object.keys(self.info).length;\r\n    },\r\n\r\n    refresh: function (ev, params) {\r\n        var self = this;\r\n        var args = params.args || {};\r\n        var data = params.data;\r\n        self.params = params.args;\r\n        this.recalculateHomeNavbar(params);\r\n        this.setEnabledLeftSidebar(params);\r\n        this.setEnabledRightSidebar(params);\r\n        this.setEnabledBreadCrumb(params);\r\n        if (params.context == \"ACTIVITY\" || params.context == \"ACTIVITYPLAN\") {\r\n            params.args.histName = self.getActivityName(params);\r\n        }\r\n\r\n        self.setStateBarNavigator(params.context);\r\n\r\n        if(!params.skipRefresh){\r\n            if (params.args.histName && params.args.histName != \"\") {\r\n                self.updateInfo(params);\r\n            }\r\n        }\r\n        var showSteps = params.args.eventType != \"DATA-NAVIGATION\";\r\n        self.drawBreadCrumb(self.info, showSteps);\r\n        self.drawDateNavigator(params);      \r\n    },\r\n\r\n    goToBack: function () {\r\n        var self = this;\r\n        $.when(bizagi.util.autoSave()).done(function () {\r\n            $(document).data('auto-save', '');\r\n            if (bizagi && bizagi.referrerParams) {\r\n                var widget = bizagi.referrerParams.referrer || bizagi.cookie('bizagiDefaultWidget');\r\n            \r\n                // switch referer widget\r\n                switch (widget) {\r\n                    case \"inbox\":\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: widget,\r\n                            restoreStatus: true\r\n                        });\r\n                        break;\r\n                    case \"inboxGrid\":\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: widget,\r\n                            restoreStatus: true\r\n                        });\r\n                        break;\r\n                    case \"homeportal\":\r\n                        self.goToPreviousCrumb();\r\n                        break;\r\n                    case \"search\":\r\n                        self.publish(\"executeAction\", {\r\n                            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,\r\n                            radNumber: bizagi.referrerParams.radNumber || \"\",\r\n                            page: bizagi.referrerParams.page || 1,\r\n                            onlyUserWorkItems: false\r\n                        });\r\n                        break;\r\n                    case \"queryform\":                \r\n                        var params = {\r\n                            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,\r\n                            notMigratedUrl: false,\r\n                            queryFormAction: bizagi.referrerParams.queryForm.actionForm,\r\n                            notMigratedUrl: \"\",\r\n                            queryParams: bizagi.referrerParams.queryForm.queryParams,\r\n                            pageToShow: bizagi.referrerParams.queryForm.pageToShow,\r\n                            queryForm: bizagi.referrerParams.queryForm.queryForm,\r\n                            recalculateQueryForm: true\r\n                        };\r\n\r\n                        $.extend(params, params, bizagi.referrerParams.queryForm.data),\r\n                        self.publish(\"showDialogWidget\", params);\r\n                        break;\r\n                    case \"reports\":                \r\n                        var params = {\r\n                            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART,\r\n                            endPoint: bizagi.referrerParams.reports.endPoint,\r\n                            filters: {},\r\n                            tab: bizagi.referrerParams.reports.tab\r\n                        };\r\n                        bizagi.referrerParams.reports.fromBackButton=true;\r\n                        self.publish(\"changeWidget\", params);\r\n                        break;\r\n                    case \"folders\":\r\n                        var url = bizagi.referrerParams.urlParameters + \"&page=\" + bizagi.referrerParams.page;\r\n                        $.when(self.dataService.getCasesByFolder(url))\r\n                            .done(function (data) {\r\n                                data.customized = true;\r\n                                data.urlParameters = bizagi.referrerParams.urlParameters;\r\n                                // Define title of widget\r\n                                data.title = bizagi.referrerParams.name;\r\n                                // Set a flag here to tell the search widget that must show the ungroup case from folder (icon).\r\n                                data.casesGroupedByFolder = true;\r\n                                data.idFolder = bizagi.referrerParams.id;\r\n                                self.publish(\"changeWidget\", {\r\n                                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,\r\n                                    data: data,\r\n                                    referrerParams: {}\r\n                                });\r\n                            });\r\n                        break;\r\n                    default:\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,\r\n                            restoreStatus: true\r\n                        });\r\n                        break;\r\n                }\r\n            }\r\n        })\r\n    },\r\n\r\n    getActivityName: function (params) {\r\n        var activityName;\r\n        var idWorkItem = params.args.idWorkitem;\r\n        for (var i = 0; i < params.args.currentState.length; i++) {\r\n            var state = params.args.currentState[i];\r\n            if (state && state.idWorkItem == idWorkItem) {\r\n                if (state.displayName) {\r\n                    activityName = state.displayName;\r\n                }\r\n                else if (state.state) {\r\n                    activityName = state.state;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        return activityName;//+ '-' + params.args.radNumber;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param event\r\n     * @param params\r\n     */\r\n    setStateBarNavigator: function(context){\r\n        var self = this;\r\n        if (context == \"ACTIVITY\" || context == \"ACTIVITYPLAN\") {\r\n            self.showButtonPrintForm(true);\r\n            self.showUrlHelp(true);\r\n            self.showButtonAssignationEveryone(true);\r\n            self.flagDisplayDate = false;\r\n            self.onDisplayDate(false);\r\n        }\r\n        else {\r\n            self.showButtonPrintForm(false);\r\n            self.showUrlHelp(false);\r\n            self.showButtonAssignationEveryone(false);\r\n            self.flagDisplayDate = true;\r\n            self.onDisplayDate(true);\r\n        }\r\n    },\r\n\r\n    getDataObj: function () {\r\n        var self = this,\r\n            regional = self.getResource(\"datePickerRegional\"),\r\n            currentDate = new Date(),\r\n            currentDay = regional.dayNames[currentDate.getDay()],\r\n            currentMonth = regional.monthNames[currentDate.getMonth()];\r\n\r\n        return {\r\n            \"date\": currentDay + \", \" + currentMonth + \" \" + currentDate.getDate() + \", \" + currentDate.getFullYear()\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Copy object by value, not reference\r\n     */\r\n    copyDataObjectWithoutReference: function(params){\r\n        return $.extend(true, {}, params);\r\n    },\r\n    /**\r\n     *\r\n     * @param show\r\n     */\r\n    showButtonPrintForm: function(show){\r\n        var self = this;\r\n        var $content = self.getContent();\r\n        var $wrapperButtonPrint = $content.find(\".navbar-print\");\r\n\r\n        if(show === true){\r\n            $wrapperButtonPrint.show();\r\n        }\r\n        else{\r\n            $wrapperButtonPrint.hide();\r\n        }\r\n    },\r\n    showUrlHelp: function(show){\r\n        var self = this;\r\n        var $content = self.getContent();\r\n        var $wrapperUrlHelp = $content.find(\".navbar-help\");\r\n        if(show === true){\r\n            var helpUrl = \"\";\r\n            for(var i=0; i< self.params.currentState.length; i++){\r\n                if(self.params.currentState[i].idTask === self.params.idTask){\r\n                    helpUrl = bizagi.util.validateUrlWellFormed(self.params.currentState[i].helpUrl);\r\n                }\r\n            }\r\n            if(!bizagi.util.isEmpty(helpUrl)){\r\n                $wrapperUrlHelp.show();\r\n        \r\n                $(\".navbar-help a\").attr(\"href\", helpUrl); \r\n            } \r\n        }\r\n        else{\r\n            $wrapperUrlHelp.hide();\r\n        }\r\n    },\r\n    /**\r\n     *\r\n     */\r\n    printCase: function(){\r\n        var self = this;\r\n        var printParams = { idCase: self.params.idCase,\r\n            idWorkitem: self.params.idWorkitem,\r\n            idTask: self.params.idTask\r\n        };\r\n\r\n        self.printFormCommand.print(printParams);\r\n    },\r\n\r\n\r\n    initilizeActionMenu: function (currentState) {\r\n        var self = this,\r\n            allowReleaseActivity = false;\r\n        var content = self.getContent();\r\n        if (currentState && currentState.length > 0) {\r\n          for (var j = 0; j < currentState.length; ++j) {\r\n            if (currentState[j] && self.params && currentState[j].idWorkItem == self.params.idWorkitem) {\r\n                allowReleaseActivity = bizagi.util.parseBoolean(currentState[j].allowReleaseActivity) || false;\r\n            }\r\n          }\r\n        }\r\n        var valParams = self.params.assignationEveryone || {};\r\n        self.showReleaseButton = allowReleaseActivity && !(valParams.enabledReadOnlyForAsigneeToEveryone && valParams.isAssignationMethodEveryone);\r\n        if (self.showReleaseButton) {\r\n            $(\".navbar-assignation-everyone > .ae-action\", content).text(self.getResource('render-actions-release'));\r\n            $(\".navbar-assignation-everyone\", content).show();\r\n        }\r\n      \r\n    },\r\n    /**\r\n     *\r\n     * @param show\r\n     */\r\n    showButtonAssignationEveryone: function(show){\r\n        var self = this;\r\n        $.when(self.getAssignationEveryoneParams()).done(function() {\r\n            var content = self.getContent();\r\n            var valParams = self.params.assignationEveryone || {};\r\n\r\n            if(show === true && valParams.enabledReadOnlyForAsigneeToEveryone && valParams.isAssignationMethodEveryone && valParams.canWorkOnThisTask && valParams.totalAssigneesCount > 1){\r\n                $(\".navbar-assignation-everyone\", content).removeClass('nae--loading');\r\n                if(valParams.currentUserIsCurrentAsignee){\r\n                    $(\".navbar-assignation-everyone > .ae-action\", content).text(self.getResource('render-actions-release'));\r\n                }else{\r\n                    $(\".navbar-assignation-everyone > .ae-action\", content).text(self.getResource('render-actions-take-ownership'));\r\n                }\r\n                $(\".navbar-assignation-everyone\", content).show();\r\n            }else{\r\n                $(\".navbar-assignation-everyone\", content).hide();\r\n            }\r\n\t    self.initilizeActionMenu(self.params.currentState);\r\n        });\r\n        \r\n    },\r\n    assignationEveryoneAction: function(){\r\n        var self = this;\r\n        var valParams = self.params.assignationEveryone || {};\r\n        \r\n        $(\".navbar-assignation-everyone\", self.getContent()).addClass('nae--loading');\r\n        if((valParams.enabledReadOnlyForAsigneeToEveryone && valParams.isAssignationMethodEveryone && valParams.canWorkOnThisTask) || self.showReleaseButton){\r\n            if(valParams.currentUserIsCurrentAsignee || self.showReleaseButton){\r\n                self.releaseDialogBox.formContent.dialog({\r\n                    resizable: false,\r\n                    draggable: false,\r\n                    height: \"auto\",\r\n                    width: \"660px\",\r\n                    modal: true,\r\n                    title: self.getResource(\"workportal-widget-dialog-box-release-ok\"),\r\n                    maximize: true,\r\n                    close: function () {\r\n                        $(\".navbar-assignation-everyone\", self.getContent()).removeClass('nae--loading');\r\n                        self.releaseDialogBox.formContent.dialog(\"destroy\");\r\n                        self.releaseDialogBox.formContent.detach();\r\n                    }\r\n                });\r\n            }else{\r\n                self.actionTakeOwnership();\r\n            }\r\n        }\r\n    },\r\n    getAssignationEveryoneParams: function (){\r\n        var self = this;\r\n        localParams = {\r\n            idCase: self.params.idCase,\r\n            fromTask: self.params.idTask,\r\n            fromWorkItemId: self.params.idWorkitem\r\n        };\r\n        var defer = $.Deferred();\r\n        $.when(self.dataService.getWorkitems(localParams)).done(function (getWorkItems) {\r\n            self.params.assignationEveryone = {\r\n                currentUserIsCurrentAsignee: getWorkItems.currentUserIsCurrentAsignee || false,\r\n                enabledReadOnlyForAsigneeToEveryone: getWorkItems.enabledReadOnlyForAsigneeToEveryone || false,\r\n                isAssignationMethodEveryone: getWorkItems.isAssignationMethodEveryone || false,\r\n                canWorkOnThisTask: getWorkItems.canWorkOnThisTask || false,\r\n                totalAssigneesCount: getWorkItems.totalAssigneesCount || 0\r\n            };\r\n            defer.resolve();\r\n        });\r\n        return defer.promise();\r\n    },\r\n    /**\r\n    * Triggered when user click over accept button\r\n    */\r\n    onClickAcceptRelease: function () {\r\n        var self = this;\r\n        var params = {\r\n            idCase: self.params.idCase,\r\n            idWorkItem: self.params.idWorkitem\r\n        };\r\n        $.when(self.dataService.releaseActivity(params)).done(function (data) {\r\n            var status = data.status ? data.status : \"\";\r\n            var message;\r\n            switch (status) {\r\n                case \"Success\":\r\n                    // Go to inbox\r\n                    if(self.showReleaseButton){\r\n                        self.publish(\"changeWidget\", {\r\n                            widgetName: bizagi.workportal.currentInboxView\r\n                        });\r\n                    }else{\r\n                        // Refresh case\r\n                        self.pub(\"notify\", {\r\n                            type: self.params.showContextByMenuDashboard,\r\n                            args: $.extend(self.params, { refreshAllWidgets: true })\r\n                        });\r\n                    }\r\n                    break;\r\n\r\n                case \"ConfigurationError\":\r\n                    message = self.getResource(\"workportal-widget-dialog-box-release-configuration-error-message\").replace(\"{0}\", params.idWorkItem);\r\n                    bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n                    break;\r\n\r\n                default:\r\n                    message = self.getResource(\"workportal-widget-dialog-box-release-error-message\").replace(\"{0}\", params.idWorkItem);\r\n                    bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n                    break;\r\n            }\r\n            self.waitForLoadCompletely();\r\n        }).fail(function () {\r\n            var message = self.getResource(\"workportal-widget-dialog-box-release-error-message\").replace(\"{0}\", params.idWorkItem);\r\n            bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n            self.waitForLoadCompletely();\r\n        });\r\n        self.releaseDialogBox.formContent.dialog(\"destroy\");\r\n        self.releaseDialogBox.formContent.detach();\r\n    },\r\n    /**\r\n     * Triggered when user click over accept button\r\n     */\r\n    actionTakeOwnership: function () {\r\n        var self = this;\r\n        var params = {\r\n            idCase: self.params.idCase,\r\n            idWorkItem: self.params.idWorkitem\r\n        };\r\n        $.when(self.dataService.takeOwnershipActivity(params)).done(function (data) {    \r\n        \r\n            var status = data.status ? data.status : \"\";\r\n            var message;\r\n            switch (status) {\r\n                case \"Success\":\r\n                    // Refresh case\r\n                    self.pub(\"notify\", {\r\n                        type: self.params.showContextByMenuDashboard,\r\n                        args: $.extend(self.params, { refreshAllWidgets: true })\r\n                    });\r\n\r\n                    break;\r\n \r\n                default:\r\n                    message = self.getResource(\"workportal-widget-dialog-box-takeownership-error-message\").replace(\"{0}\", params.idWorkItem);\r\n                    bizagi.showMessageBox(message, self.getResource(\"workportal-general-error-page-title\"), \"error\", false);\r\n                    break;\r\n            }\r\n            self.waitForLoadCompletely();\r\n            \r\n        }).fail(function () { self.waitForLoadCompletely(); });\r\n    },\r\n    waitForLoadCompletely: function(){\r\n        var self = this;\r\n        var content = self.content;\r\n        var fn = function () {\r\n            var ol = $('body #loadModuleStatus > *');\r\n            var il = $(content).closest('.content-portal').find('#home-content').find('.ui-bizagi-loading-message');\r\n            if (ol.length === 0 && il.length === 0){\r\n                $(\".navbar-assignation-everyone\", content).removeClass('nae--loading');\r\n            }else setTimeout(function () {\r\n                $(\".navbar-assignation-everyone\", content).addClass('nae--loading');\r\n                fn();\r\n            }, 100);\r\n        };\r\n        fn();\r\n    },\r\n\r\n    /**\r\n        * Close dialog release case\r\n        */\r\n    onClickCancelRelease: function () {\r\n        var self = this;\r\n        $(\".navbar-assignation-everyone\", self.getContent()).removeClass('nae--loading');\r\n        self.releaseDialogBox.formContent.dialog(\"destroy\");\r\n        self.releaseDialogBox.formContent.detach();\r\n    },\r\n    /**\r\n     * Hides the date displayed in the widget\r\n     */\r\n    onDisplayDate: function (show) {\r\n        var self = this,\r\n            $content = self.getContent(),\r\n            $date = $content.find(\".navbar-date\");\r\n\r\n        if (show && self.flagDisplayDate) {\r\n            $date.show();\r\n        }\r\n        else {\r\n            $date.hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Clean widget\r\n     */\r\n    clean : function() {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n        if ($content){\r\n            var $container = $content.find(\"ul\");\r\n\r\n            self.unsub(\"UPDATE_LASTCRUMBPARAMS_INFO\");\r\n            self.unsub(\"NAVIGATE\");\r\n            self.unsub(\"NAVIGATOR_GETLEVEL\");\r\n            self.unsub(\"NAVIGATOR_BACK\");\r\n            $container.off(\"click\", \"li\");\r\n\r\n            $(\".navbar-print\", self.content).off(\"click\", $.proxy(self.printCase, self));\r\n        }\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.navigator\", [\"workportalFacade\", \"dataService\", \"accumulatedcontext\", bizagi.workportal.widgets.navigator]);\r\n","/**\r\n * Name: Bizagi Workportal Desktop Sidebar Controller\r\n * Author: Mauricio Snchez  -  Danny Gonzalez\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.sidebarhome\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"sidebarhome\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.sidebarhome\").concat(\"#sidebarhome-wrapper\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"sidebarhome\");\r\n        self.content = $(template.render({}));\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.sidebarhome', ['workportalFacade', 'dataService', bizagi.workportal.widgets.sidebarhome], true);","/**\r\n * Name: Bizagi Workportal Desktop Dashboard Controller\r\n * Author: Mauricio Snchez\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.usersummary\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.workportalFacade = workportalFacade;\r\n        self.dataService = dataService;\r\n        self.params = params;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"usersummary\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.usersummary\").concat(\"#usersummary-wrapper\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template = self.getTemplate(\"usersummary\");\r\n\r\n        return $.when(self.getData()).done(function(data){\r\n            self.content = template.render(data);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this,\r\n            $container = $(\".wdg-usmry-stk-container\", self.getContent());\r\n\r\n        $container.on(\"click\", \"div.wdg-usmry-see-more\", $.proxy(self.showStakeholders, self));\r\n    },\r\n\r\n    /**\r\n     * Show the tooltip if the user have more of 3 stakeholder related\r\n     */\r\n    showStakeholders: function () {\r\n        var self = this,\r\n            $tooltip = $(\".wdg-usmry-stk-overlay\", self.getContent());\r\n\r\n        $tooltip.show( \"fast\", function(){\r\n            $tooltip.click(function (e) {\r\n                e.stopPropagation();\r\n            });\r\n            $(document).one(\"click\", function () {\r\n                $tooltip.hide( \"fast\" );\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * End point service to get User Info\r\n     */\r\n    getData: function () {\r\n        var self = this;\r\n\r\n        if(!bizagi.currentUser) {\r\n            return self.dataService.getCurrentUser().then(function (data) {\r\n                bizagi.currentUser = data;\r\n                return self.getInfoToUser(data);\r\n            });\r\n        }\r\n\r\n        return this.getInfoToUser(bizagi.currentUser);\r\n    },\r\n\r\n    /**\r\n     * Organize the user info to return the necessary format\r\n     */\r\n    getInfoToUser : function (currentUser) {\r\n        var stakeholders = [];\r\n        var totalStakeholders = currentUser.associatedStakeholders.length;\r\n        var stakeholdersToShow = currentUser.associatedStakeholders.slice(0, 2);\r\n        var stakeholdersHidden = currentUser.associatedStakeholders.slice(2, totalStakeholders);\r\n        var showMore = (totalStakeholders > 2);\r\n\r\n        $.each(stakeholdersToShow, function (index, item) {\r\n            stakeholders.push(item.displayName);\r\n        });\r\n\r\n        var data = {\r\n            user: currentUser.userName,\r\n            stakeholders: (stakeholders.length > 0) ? stakeholders.join(', ') : '--',\r\n            stakeholdersHidden: (stakeholdersHidden.length > 0) ? stakeholdersHidden : '',\r\n            showMore: showMore,\r\n            orgArray: stakeholders,\r\n            initials: currentUser.initials\r\n        };\r\n\r\n        if (currentUser.userPicture) {\r\n            data.photo = 'data:image/png;base64,' + currentUser.userPicture;\r\n        }\r\n\r\n        return data;\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.usersummary', ['workportalFacade', 'dataService', bizagi.workportal.widgets.usersummary]);","/**\r\n * Bizagi Workportal Desktop My Shortcuts list controller\r\n * @author Danny Gonzalez\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.shortcuts\", {}, {\r\n\t/**\r\n\t * Constructor\r\n\t * @param workportalFacade instance of facade, mandatory\r\n\t * @param dataService instance of service tier, mandatory\r\n\t * @param params extra params, its not mandatory\r\n\t * @param processActionService\r\n\t * @param accumulatedcontext\r\n\t * @param notifier\r\n\t */\r\n\tinit: function(workportalFacade, dataService, processActionService, accumulatedcontext, notifier, params) {\r\n\t\tvar self = this;\r\n        self.requestsInProgressProcessGuid = {};\r\n\t\tself.params = params;\r\n\t\tself.processActionService = processActionService;\r\n\t\tself.accumulatedcontext = accumulatedcontext;\r\n\t\tself.notifier = notifier;\r\n\r\n\t\t// Call base\r\n\t\tself._super(workportalFacade, dataService, params);\r\n\t\t//Load templates\r\n\t\tself.loadTemplates({\r\n\t\t\t\"myshortcuts\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.shortcuts\").concat(\"#shortcuts-wrapper\")\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * Renders the template defined in the widget\r\n\t * @return {string} html\r\n\t */\r\n\trenderContent: function() {\r\n\t\tvar self = this;\r\n\t\tvar template = self.getTemplate(\"myshortcuts\");\r\n\r\n        return $.when(self.getData()).done(function(data) {\r\n            self.content = data.length > 0 ? template.render({shortcuts: data}) : '';\r\n            return self.content;\r\n        });\r\n\t},\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n        $('.wdg-srcts-container', $content).on(\"click\", $.proxy(self.onClickShortcut, self));\r\n    },\r\n    /**\r\n     *\r\n     * @returns {*}\r\n     */\r\n    getData: function() {\r\n        var self = this;\r\n\r\n        return self.dataService.getMyShortcutsByCategory({icon:true}).then( function(data) {\r\n            self.model = {};\r\n            var category, i = -1;\r\n\r\n            while (category = data[++i]) {\r\n                var shortcut, j = -1;\r\n\r\n                while (shortcut = category.items[++j]) {\r\n                    var id = Math.guid();\r\n                    shortcut.id = id;\r\n                    self.model[id] = shortcut;\r\n                }\r\n            }\r\n            return data;\r\n        });\r\n    },\r\n\t/**\r\n\t * event listener for each action in the shrotcuts list\r\n\t * @param ev\r\n\t */\r\n\tonClickShortcut: function(ev) {\r\n\t\tvar self = this;\r\n\t\tvar $target = $(ev.target).closest('.wdg-srcts-container');\r\n\t\tvar shortcut = self.model[$target.data('id')];\r\n        self.target = $target;\r\n\r\n        if(self.requestsInProgressProcessGuid[shortcut.idProcess])\r\n            return;\r\n\r\n        self.startLoading(self.target,shortcut.idProcess);\r\n\r\n        if (shortcut) {\r\n\t\t    self.dataService.actionsHasStartForm({ processId: shortcut.idProcess }).done(function (data, $target) {\r\n\t\t        if (!data.startForm) {\r\n\t\t            self.dataService.actionCreateCase(shortcut).done(function (data) {\r\n                        $.when(self.processActionService.launchActionsAfterCreateCase({\r\n                            idCase: data.caseId,\r\n                            caseNumber: data.caseNumber,\r\n                            action: shortcut\r\n                        })).done(function(){\r\n                            self.stopLoading(self.target,shortcut.idProcess);\r\n                        }) ;\r\n\r\n                    });\r\n\t\t        }\r\n\t\t\t\telse {\r\n\t\t            var action = {\r\n\t\t                displayName: shortcut.displayName,\r\n\t\t                hasStartForm: data.startForm,\r\n                        showConfirmation: shortcut.showConfirmation\r\n\t\t            };\r\n\r\n                    $.when(self.processActionService.executeProcessAction({\r\n\t\t                action: action,\r\n\t\t                mappingstakeholders: true,\r\n\t\t                guidprocess: shortcut.idProcess\r\n\t\t            })).done(function(){\r\n                        self.stopLoading(self.target,shortcut.idProcess);\r\n                    });\r\n\t\t        }\r\n\t\t    }).fail(function () {\r\n                self.notifier.showErrorMessage(\r\n                    printf(\r\n                        bizagi.localization.getResource('workportal-widget-sortbar-execute-error-message'),\r\n                        shortcut.displayName\r\n                    )\r\n                );\r\n                self.stopLoading(self.target,shortcut.idProcess);\r\n            });\r\n\t\t}\r\n\t},\r\n    /**\r\n     * Detach handlers\r\n     */\r\n    clean: function() {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n\r\n        if($content) {\r\n            $('.wdg-srcts-container', $content).off('click');\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Start loading shortcut\r\n     * */\r\n    startLoading: function($target, idProcess){\r\n        var self = this;\r\n        $target.prepend(\"<div class=\\\"bz-wp-ls-list-item-loading\\\"><div class=\\\"ui-bizagi-loading-icon\\\"></div></div>\");\r\n        self.requestsInProgressProcessGuid[idProcess] = true;\r\n    },\r\n\r\n    /**\r\n     * Stop loading shortcut\r\n     * */\r\n    stopLoading: function($target, idProcess){\r\n        var self = this;\r\n        $target.find(\".bz-wp-ls-list-item-loading\").remove();\r\n        delete self.requestsInProgressProcessGuid[idProcess];\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.shortcuts', ['workportalFacade', 'dataService', 'processActionService', 'accumulatedcontext', 'notifier', bizagi.workportal.widgets.shortcuts]);","/**\r\n *   Name: Bizagi Workportal Right Sidebar\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.right.sidebar\", {}, {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, behaviorCollapsiblePanels, params) {\r\n        var self = this;\r\n        self.behaviorCollapsiblePanels = behaviorCollapsiblePanels;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"right-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.right.sidebar\").concat(\"#rightsidebar-wrapper\")\r\n        });\r\n\r\n        var alwaysCollapse = bizagi.services.preferences().getPreferences()?bizagi.services.preferences().getPreference(\"collapseSidebars\"):\"\";\r\n        if(alwaysCollapse === 'yes'){\r\n            $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"ui-bizagi-wp-project-collapse-rightpanel\");\r\n            $(\"#right-sidebar-wrapper\").addClass(\"always-collpase\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"right-sidebar\");\r\n        self.content = template.render({});\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        if (self.params && self.params.contextsRightSidebarCaseDashboard) {\r\n            self.params.contextsRightSidebarCaseDashboard.forEach(function (context) {\r\n                self.sub(context, $.proxy(self.updateView, self));\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param event\r\n     * @param params\r\n     */\r\n    updateView: function (event, params) {\r\n        var self = this;\r\n\r\n        self.enableOrDisableRightSidebar(params.context);\r\n        self.eventsHandler();\r\n\r\n        if(params.context === \"ACTIVITY\" || params.context === \"ACTIVITYPLAN\"){\r\n            self.addBottomPadding();\r\n        }\r\n       \r\n    },\r\n    addBottomPadding: function (){\r\n        $('.content-dashboard-right-sidebar .content-right-sidebar').css('padding-bottom', '30px')\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param event\r\n     */\r\n    onCollapsePanel: function(event) {\r\n\r\n        var self = this;\r\n        var $target = (event) ? $(event.currentTarget) : $(\"#project-collapse-rightpanel\");\r\n        var classSuffix = \"-rightpanel\";\r\n        \r\n        self.behaviorCollapsiblePanels.addClassesCollapseSideBar(self.content, classSuffix, false);\r\n        \r\n        if($target.closest(\".ui-bizagi-wp-project-open-rightpanel\").length > 0){\r\n            self.pub(\"notify\", {\r\n                type: \"EXPANDED_RIGHT_SIDEBAR\"\r\n            });\r\n        }\r\n        $(\"#right-sidebar-wrapper\").removeClass(\"always-collpase\");\r\n\r\n        self.publish(\"openCloseSidebar\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    disableSidebar: function(){\r\n        $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"disabled-right-sidebar\");\r\n        $(\"#ui-bizagi-wp-project-homeportal-main\").removeClass(\"enabled-right-sidebar\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    enableSidebar: function(){\r\n        $(\"#ui-bizagi-wp-project-homeportal-main\").removeClass(\"disabled-right-sidebar\");\r\n        $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"enabled-right-sidebar\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    openRightSidebar: function(){\r\n        var self = this;\r\n        $(\"#right-sidebar-wrapper\").removeClass(\"always-collpase\");\r\n        self.behaviorCollapsiblePanels.addClassesCollapseSideBar(self.content, \"-rightpanel\", true);\r\n    },\r\n\r\n    closeRightSidebar: function(){\r\n        var self = this;\r\n        self.behaviorCollapsiblePanels.collapseSideBar(\"-rightpanel\");\r\n    },\r\n\r\n    \r\n    /**\r\n     *\r\n     * @param currentContext\r\n     */\r\n    enableOrDisableRightSidebar: function(currentContext){\r\n        var self = this;\r\n\r\n        var setDisabledSidebar = false;\r\n        self.params.contextsWithoutRightSidebarCaseDashboard.forEach(function(context){\r\n            if(context === currentContext){\r\n                self.disableSidebar();\r\n                setDisabledSidebar = true;\r\n            }\r\n        });\r\n        if(setDisabledSidebar === false){\r\n            self.enableSidebar();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    eventsHandler: function(){\r\n        var self = this;\r\n        $(\".ui-bizagi-wp-project-panel-collapse\", self.content).off(\"click\", $.proxy(self.onCollapsePanel, self));\r\n        $(\".ui-bizagi-wp-project-panel-collapse\", self.content).on(\"click\", $.proxy(self.onCollapsePanel, self));\r\n\r\n        self.sub(\"OPEN_RIGHT_SIDEBAR\", $.proxy(self.openRightSidebar, self));\r\n        self.sub(\"CLOSE_RIGHT_SIDEBAR\", $.proxy(self.closeRightSidebar, self));\r\n        self.sub(\"DISABLED_RIGHT_SIDEBAR\", $.proxy(self.disableSidebar, self));\r\n        self.sub(\"ENABLED_RIGHT_SIDEBAR\", $.proxy(self.enableSidebar, self));\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    clean: function(){\r\n        var self = this;\r\n        if(self.params && self.params.contextsRightSidebarCaseDashboard){\r\n            self.params.contextsRightSidebarCaseDashboard.forEach(function(context){\r\n                self.unsub(context, $.proxy(self.updateView, self));\r\n            });\r\n        }\r\n        $(\".ui-bizagi-wp-project-panel-collapse\", self.content).off(\"click\", $.proxy(self.onCollapsePanel, self));\r\n\r\n        self.unsub(\"OPEN_RIGHT_SIDEBAR\", $.proxy(self.openRightSidebar, self));\r\n        self.unsub(\"CLOSE_RIGHT_SIDEBAR\", $.proxy(self.closeRightSidebar, self));\r\n        self.unsub(\"DISABLED_RIGHT_SIDEBAR\", $.proxy(self.disableSidebar, self));\r\n        self.unsub(\"ENABLED_RIGHT_SIDEBAR\", $.proxy(self.enableSidebar, self));\r\n    }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.right.sidebar\", [\"workportalFacade\", \"dataService\", \"behaviorCollapsiblePanels\", bizagi.workportal.widgets.right.sidebar], true);","/**\r\n *   Name: Bizagi Workportal Left Sidebar\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.left.sidebar\", {}, {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, behaviorCollapsiblePanels, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        self.behaviorCollapsiblePanels = behaviorCollapsiblePanels;\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"left-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.left.sidebar\").concat(\"#leftsidebar-wrapper\")\r\n        });\r\n\r\n        var alwaysCollapse = bizagi.services.preferences().getPreferences()?bizagi.services.preferences().getPreference(\"collapseSidebars\"):\"\";\r\n        if(alwaysCollapse === 'yes'){\r\n            $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"ui-bizagi-wp-project-collapse-leftpanel\");\r\n            $(\"#left-sidebar-wrapper\").addClass(\"always-collpase\");\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"left-sidebar\");\r\n        self.content = template.render({});\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.eventsHandler();\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    eventsHandler: function(){\r\n        var self = this;\r\n        $(\".ui-bizagi-wp-project-panel-collapse\", self.content).on(\"click\", $.proxy(self.onCollapsePanel, self));\r\n\r\n        self.showTooltip($( \".bz-icon-right-outline\", self.content), bizagi.localization.getResource(\"workportal-sidebar-show-more-tooltip\"));\r\n        self.showTooltip($( \".bz-icon-left-outline\", self.content), bizagi.localization.getResource(\"workportal-sidebar-show-less-tooltip\"));\r\n        \r\n    },\r\n    showTooltip: function(classArrow, textTooltip){\r\n        classArrow.tooltip({\r\n            content: textTooltip, \r\n            tooltipClass: \"custom-tooltip-styling-bottom-bar\", \r\n            position: { \r\n                my: \"left+15 center\", \r\n                at: \"right top+8\",\r\n                of: classArrow\r\n            }\r\n          });   \r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param event\r\n     */\r\n    onCollapsePanel: function(event) {\r\n        $('.ui-tooltip.custom-tooltip-styling-bottom-bar').hide();\r\n        var self = this;\r\n        var $target = (event) ? $(event.currentTarget) : $(\"#project-collapse-leftpanel\");\r\n        var classSuffix = ($target.prop(\"id\") === \"project-collapse-rightpanel\") ? \"-rightpanel\" : \"-leftpanel\";\r\n\r\n        self.behaviorCollapsiblePanels.addClassesCollapseSideBar(self.content, classSuffix, false);\r\n        $(\"#left-sidebar-wrapper\").removeClass(\"always-collpase\");\r\n        self.publish(\"openCloseSidebar\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    clean: function(){\r\n        var self = this;\r\n        $(\".ui-bizagi-wp-project-panel-collapse\", self.content).off(\"click\", $.proxy(self.onCollapsePanel, self));\r\n    }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.left.sidebar\", [\"workportalFacade\", \"dataService\", \"behaviorCollapsiblePanels\", bizagi.workportal.widgets.left.sidebar], true);","/**\r\n *   Name: Bizagi Workportal Desktop Widget Dummy\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.dummy\", {}, {\r\n   /**\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n   },\r\n\r\n   /**\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.dummy\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.dummy]);","/**\r\n *   Name: Bizagi Workportal Desktop Sidebar Controller\r\n *   Author: Mauricio Snchez  -  Danny Gonzalez\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.sidebar\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.sidebar\").concat(\"#sidebar-wrapper\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"sidebar\");\r\n        self.content = $(template.render({}));\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.sidebar', ['workportalFacade', 'dataService', bizagi.workportal.widgets.sidebar], true);","/**\r\n * Admin module to case massively reassign\r\n * \r\n * @author Edward J Morales\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.cases\", {}, {\r\n    /*\r\n     *   Returns the widget name\r\n     */\r\n    getWidgetName: function() {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC;\r\n    },\r\n    /*\r\n     *   Renders the content for the current controller\r\n     */\r\n    renderContent: function() {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.cases\");\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Admin / Cases Search\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.caseSearch\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.case.search\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","bizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.adhoc.create.process\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n\r\n        var self = this;\r\n\r\n        self.notifier = bizagi.injector.get(\"notifier\");\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Load Templates\r\n        self.loadTemplates({\r\n            \"adhoc.create.process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.adhoc.create.process\").concat(\"#adhoc-create-process\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     * @return {*}\r\n     */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template = self.getTemplate(\"adhoc.create.process\");\r\n        self.content = template.render();\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * Method called after render widget\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.addEventHandlers();\r\n    },\r\n\r\n    /**\r\n     * Called when change input and validate form\r\n     * @returns {boolean}\r\n     */\r\n    validateForm: function(){\r\n        var self = this;\r\n        var isValidForm = false;\r\n        var name = $(\".js-input-name\", self.content);\r\n        if (name.val() && name.val() !== \"\") {\r\n            name.next().find(\"span\").html(\"\");\r\n            isValidForm = true;\r\n        } else {\r\n            var nameValidation = bizagi.localization.getResource(\"workportal-general-error-field-required\");\r\n            nameValidation = nameValidation.replace(\"{0}\", bizagi.localization.getResource(\"workportal-widget-admin-adhoc-processes-name\"));\r\n            name.next().find(\"span\").html(nameValidation);\r\n            isValidForm = false;\r\n        }\r\n        return isValidForm;\r\n    },\r\n\r\n    /**\r\n     * Trigger when click cancel button\r\n     */\r\n    onClickCancel: function () {\r\n        var self = this;\r\n        self.publish(\"closeCurrentDialog\");\r\n    },\r\n\r\n    /**\r\n     * Trigger when submit form\r\n     * @param event\r\n     */\r\n    onSubmitFormCreateProcess: function(event){\r\n        event.preventDefault();\r\n        var self = this;\r\n        if (self.validateForm()) {\r\n            var paramsNewProcess = {\r\n                displayName: $(\"input\", self.content).val()\r\n            };\r\n            bizagi.showErrorAlertDialog = false;\r\n            $.when(self.dataService.createNewAdhocProcess(paramsNewProcess)).done(function (data) {\r\n                self.notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-adhoc-process-created\"),\r\n                    bizagi.localization.getResource(\"workportal-quickprocess-notification-process-title\"), \"\");\r\n                self.publish(\"closeCurrentDialog\");\r\n                if(bizagi.util.isIE10OrLower()){ // redirect to dashboard, IE10 doesn't support routing in angular app\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY\r\n                    });\r\n\r\n                } else {\r\n                    self.publish(\"changeWidget\", {\r\n                        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY,\r\n                        data: {\r\n                            route: 'process-modeler',\r\n                            params: data\r\n                        }\r\n                    });\r\n                }\r\n            }).fail(function (error) {\r\n                error = JSON.parse(error.responseText);\r\n                self.notifier.showErrorMessage(error.message, bizagi.localization.getResource(\"workportal-quickprocess-notification-generic-error-title\"), \"\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Add event handlers to elements\r\n     */\r\n    addEventHandlers: function () {\r\n        var self = this;\r\n        $(\".js-input-name\", self.content).on(\"input\", $.proxy(self.validateForm, self));\r\n        $(\"#button-cancel-create-adhoc-process\", self.content).on(\"click\", $.proxy(self.onClickCancel, self));\r\n        $(\"form\", self.content).on(\"submit\", $.proxy(self.onSubmitFormCreateProcess, self));\r\n    },\r\n\r\n    /**\r\n     * Remove event handlers to elements. Dispose widget\r\n     */\r\n    dispose: function () {\r\n        var self = this;\r\n        $(\".js-input-name\", self.content).off(\"input\", $.proxy(self.validateForm, self));\r\n        $(\"#button-cancel-create-adhoc-process\", self.content).off(\"click\", $.proxy(self.onClickCancel, self));\r\n        $(\"form\", self.content).off(\"submit\", $.proxy(self.onSubmitFormCreateProcess, self));\r\n    }\r\n});","/*\r\n *   Name: Bizagi Workportal Desktop Project File Preview\r\n *   Author: David Romero Estrada\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.profly\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-filespreview-wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.profly\").concat(\"#project-filespreview-wrapper\")\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Renders the template defined in the widget\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        // Define parameters to route angular app\r\n        var argumentsTemplate = {\r\n            paramsURL: ''\r\n        }\r\n        if(self.params.data && self.params.data.route && self.params.data.params.id){\r\n            argumentsTemplate.paramsURL =\r\n                encodeURI('?route=' + self.params.data.route + '&id=' + self.params.data.params.id + '&displayName=' + self.params.data.params.displayName);\r\n\r\n        }\r\n\r\n        if(self.params.data && self.params.data.route && self.params.data.params.module){\r\n            argumentsTemplate.paramsURL =\r\n                encodeURI('?route=' + self.params.data.route + '&module=' + self.params.data.params.module);\r\n        }\r\n\r\n        var generalTmpl = self.getTemplate(\"project-filespreview-wrapper\");\r\n        self.content = generalTmpl.render(argumentsTemplate);\r\n\r\n        if(bizagi.util.isIE11OrLower()){\r\n            localStorage.setItem(\"params_profly\", argumentsTemplate.paramsURL);\r\n            $(self.content).css({ width: '0px', height: '0px' });\r\n            $.when(self.reloadToDashboardWhenLoadIFrame()).done(function(){\r\n                $(self.content).css('width', '100%').css('height', '100%');\r\n            });\r\n        }\r\n\r\n        // this event is triggered when user lost session from form designer.\r\n        // by the moment, only Chrome Users can access to formDesigner.\r\n        if(bizagi.util.isChrome()){\r\n            $(self.content).on(\"load\", function (event) {\r\n                if(event.currentTarget.contentWindow.location.href.indexOf('quickprocess') === -1){\r\n                    location.reload(); // QAF-5934\r\n                }\r\n            });\r\n        }\r\n\r\n        return self.content;\r\n    },\r\n\r\n    reloadToDashboardWhenLoadIFrame: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        function waitForContentDocumentOnIframe(){\r\n            if(document.getElementById('iframe-liveprocesses') && typeof document.getElementById('iframe-liveprocesses').contentDocument !== \"undefined\"){\r\n                document.getElementById('iframe-liveprocesses').contentDocument.location = './jquery/quickprocess/dist/';\r\n                setTimeout(function(){defer.resolve();}, 1000);\r\n            }\r\n            else{\r\n                setTimeout(waitForContentDocumentOnIframe, 50);\r\n            }\r\n        }\r\n\r\n        waitForContentDocumentOnIframe();\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n    * links events with handlers\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n        $('#iframe-liveprocesses', self.content).off();\r\n        self.plugins = {};\r\n        self.form = {};\r\n        self.currentFile = {};\r\n        self.filesNumber = 0;\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.profly\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.profly]);","bizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.sessionTimeout\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, notifier, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load template\r\n        self.loadTemplates({\r\n            \"session-timeout\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.sessionTimeout\").concat(\"#session-timeout\")\r\n        });\r\n\r\n        // Have an instance of the session timeout\r\n        self.sessionTimeoutService = bizagi.injector.get('sessionTimeOutService');\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate('session-timeout');\r\n        self.content = template.render({});\r\n        return self.content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self._onClickMinValue\r\n\r\n        // When the user clicks on the modal button reset the countDown\r\n        $('button', self.content).click(\r\n            $.proxy(function () {\r\n                // Keep the session opened\r\n                self.sessionTimeoutService.keepSessionOpen();\r\n                $(this.content).closest('.ui-dialog').find('.ui-dialog-titlebar-close').trigger('click');\r\n            },\r\n            self\r\n        ));\r\n\r\n        // Remove the x of the modal\r\n        self.renderingDeferred.then($.proxy(self.removeXClose, self));\r\n    },\r\n\r\n    /**\r\n     * Remove the x of the modal, whe don't need it here\r\n     * We don't want the possibility to close the modal\r\n     */\r\n    removeXClose: function () {\r\n        var self = this;\r\n        setTimeout(function () {\r\n            $(self.content).closest('.ui-dialog').find('.ui-dialog-titlebar-close').hide();\r\n        }, 0);\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.sessionTimeout', ['workportalFacade', 'dataService', 'notifier', bizagi.workportal.widgets.sessionTimeout]);\r\n","bizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.sessionTimeoutExpired\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, notifier, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load template\r\n        self.loadTemplates({\r\n            \"session-timeout-expired\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.sessionTimeoutExpired\").concat(\"#session-timeout-expired\")\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate('session-timeout-expired');\r\n        self.content = template.render({});\r\n        return self.content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self._onClickMinValue\r\n\r\n        // When the user clicks on the modal button reset the countDown\r\n        $('button', self.content).click(\r\n            function () {\r\n                bizagi.services.redirectToLogoutPage();\r\n            }\r\n        );\r\n\r\n        // Remove the x of the modal\r\n        self.renderingDeferred.then($.proxy(self.removeXClose, self));\r\n    },\r\n\r\n    /**\r\n     * Remove the x of the modal, whe don't need it here\r\n     * We don't want the possibility to close the modal\r\n     */\r\n    removeXClose: function () {\r\n        var self = this;\r\n        setTimeout(function () {\r\n            $(self.content).closest('.ui-dialog').find('.ui-dialog-titlebar-close').hide();\r\n        }, 0);\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.sessionTimeoutExpired', ['workportalFacade', 'dataService', 'notifier', bizagi.workportal.widgets.sessionTimeoutExpired]);\r\n","/**\r\n * Name: Bizagi Workportal Desktop Create plan\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.user.privacy\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, notifier, params) {\r\n        var self = this;\r\n \r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        self.notifier = notifier;\r\n\r\n        //Load template\r\n        self.loadTemplates({\r\n            \"user-privacy\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.user.privacy\").concat(\"#user-privacy\")\r\n        });\r\n\r\n    },\r\n \r\n    renderContent: function(){\r\n        var self = this;\r\n        var template = self.getTemplate('user-privacy');\r\n        self.content = template.render({});\r\n        return self.content;\r\n    },\r\n \r\n    postRender: function () {\r\n        var self = this;\r\n        $('#js-btn-downloadReport', self.content).on('click', $.proxy(self.onDownloadReport, self));\r\n    },\r\n\r\n    onDownloadReport: function () {\r\n        var self = this;\r\n        self.dataService.downloadReportUser(bizagi.currentUser.idUser);\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n        $('#js-btn-downloadReport', self.content).off();\r\n    }\r\n  \r\n });\r\n \r\n bizagi.injector.register('bizagi.workportal.widgets.user.privacy', ['workportalFacade', 'dataService', 'notifier', bizagi.workportal.widgets.user.privacy]);\r\n ","/**\r\n * Name: Bizagi Workportal Users Modal\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.users.modal\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.usuarios = params.data;\r\n        self.showActivityInfo = params.data.users !== undefined;\r\n        if (self.showActivityInfo) {\r\n            self.usuarios = params.data.users;\r\n            self.isActivity = params.data.isActivity;\r\n            self.activityName = params.data.activityName;\r\n        }\r\n        \r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load template\r\n        self.loadTemplates({\r\n            \"users-modal\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.users.modal\").concat(\"#users-modal\")\r\n        });\r\n\r\n    },\r\n \r\n    renderContent: function(){\r\n        var self = this;\r\n        var template = self.getTemplate('users-modal');\r\n        self.content = template.render({\r\n            usuarios: self.usuarios,\r\n            isActivity: self.isActivity,\r\n            activityName: self.activityName,\r\n            showActivityInfo: self.showActivityInfo\r\n        });\r\n        self.clickArrow(self.content);\r\n        return self.content;\r\n    },\r\n \r\n    postRender: function () {\r\n        var self = this;\r\n       \r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n    },\r\n    clickArrow: function(context){\r\n        $(\".expand__arrow\", context).click(function(event){\r\n            var contentItemSelected = $(this).parent().parent();\r\n            if ($(\".users_collapse\", contentItemSelected).css('display') == 'none'){\r\n                $(this).addClass(\"expand__arrow--active\");\r\n                $(\".users_collapse\", contentItemSelected).show();\r\n            } else {\r\n                $(this).removeClass(\"expand__arrow--active\");\r\n                $(\".users_collapse\", contentItemSelected).hide();\r\n            }\r\n    \r\n        });\r\n    },\r\n  \r\n });\r\n \r\n bizagi.injector.register('bizagi.workportal.widgets.users.modal', ['workportalFacade', 'dataService', bizagi.workportal.widgets.users.modal]);\r\n ","bizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.accessDenied\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load template\r\n        self.loadTemplates({\r\n            \"access-denied\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.accessDenied\").concat(\"#access-denied\")\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate('access-denied');\r\n        self.content = template.render({});\r\n        return self.content;\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.accessDenied', ['workportalFacade', 'dataService', bizagi.workportal.widgets.accessDenied]);\r\n","/*\n * jsGrid v1.5.1 (http://js-grid.com)\n * (c) 2016 Artem Tabalin\n * Licensed under MIT (https://github.com/tabalinas/jsgrid/blob/master/LICENSE)\n */\n\n(function(window, $, undefined) {\n\n    var JSGRID = \"JSGrid\",\n        JSGRID_DATA_KEY = JSGRID,\n        JSGRID_ROW_DATA_KEY = \"JSGridItem\",\n        JSGRID_EDIT_ROW_DATA_KEY = \"JSGridEditRow\",\n\n        SORT_ORDER_ASC = \"asc\",\n        SORT_ORDER_DESC = \"desc\",\n\n        FIRST_PAGE_PLACEHOLDER = \"{first}\",\n        PAGES_PLACEHOLDER = \"{pages}\",\n        PREV_PAGE_PLACEHOLDER = \"{prev}\",\n        NEXT_PAGE_PLACEHOLDER = \"{next}\",\n        LAST_PAGE_PLACEHOLDER = \"{last}\",\n        PAGE_INDEX_PLACEHOLDER = \"{pageIndex}\",\n        PAGE_COUNT_PLACEHOLDER = \"{pageCount}\",\n        ITEM_COUNT_PLACEHOLDER = \"{itemCount}\",\n\n        EMPTY_HREF = \"javascript:void(0);\";\n\n    var getOrApply = function(value, context) {\n        if($.isFunction(value)) {\n            return value.apply(context, $.makeArray(arguments).slice(2));\n        }\n        return value;\n    };\n\n    var normalizePromise = function(promise) {\n        var d = $.Deferred();\n\n        if(promise && promise.then) {\n            promise.then(function() {\n                d.resolve.apply(d, arguments);\n            }, function() {\n                d.reject.apply(d, arguments);\n            });\n        } else {\n            d.resolve(promise);\n        }\n\n        return d.promise();\n    };\n\n    var defaultController = {\n        loadData: $.noop,\n        insertItem: $.noop,\n        updateItem: $.noop,\n        deleteItem: $.noop\n    };\n\n\n    function Grid(element, config) {\n        var $element = $(element);\n\n        $element.data(JSGRID_DATA_KEY, this);\n\n        this._container = $element;\n\n        this.data = [];\n        this.fields = [];\n\n        this._editingRow = null;\n        this._sortField = null;\n        this._sortOrder = SORT_ORDER_ASC;\n        this._firstDisplayingPage = 1;\n\n        this._init(config);\n        this.render();\n    }\n\n    Grid.prototype = {\n        width: \"auto\",\n        height: \"auto\",\n        updateOnResize: true,\n\n        rowClass: $.noop,\n        rowRenderer: null,\n\n        rowClick: function(args) {\n            if(this.editing) {\n                this.editItem($(args.event.target).closest(\"tr\"));\n            }\n        },\n        rowDoubleClick: $.noop,\n\n        noDataContent: \"Not found\",\n        noDataRowClass: \"jsgrid-nodata-row\",\n\n        heading: true,\n        headerRowRenderer: null,\n        headerRowClass: \"jsgrid-header-row\",\n        headerCellClass: \"jsgrid-header-cell\",\n\n        filtering: false,\n        filterRowRenderer: null,\n        filterRowClass: \"jsgrid-filter-row\",\n\n        inserting: false,\n        insertRowRenderer: null,\n        insertRowClass: \"jsgrid-insert-row\",\n\n        editing: false,\n        editRowRenderer: null,\n        editRowClass: \"jsgrid-edit-row\",\n\n        confirmDeleting: true,\n        deleteConfirm: \"Are you sure?\",\n\n        selecting: true,\n        selectedRowClass: \"jsgrid-selected-row\",\n        oddRowClass: \"jsgrid-row\",\n        evenRowClass: \"jsgrid-alt-row\",\n        cellClass: \"jsgrid-cell\",\n\n        sorting: false,\n        sortableClass: \"jsgrid-header-sortable\",\n        sortAscClass: \"jsgrid-header-sort jsgrid-header-sort-asc\",\n        sortDescClass: \"jsgrid-header-sort jsgrid-header-sort-desc\",\n\n        paging: false,\n        pagerContainer: null,\n        pageIndex: 1,\n        pageSize: 20,\n        pageButtonCount: 15,\n        pagerFormat: \"Pages: {first} {prev} {pages} {next} {last} &nbsp;&nbsp; {pageIndex} of {pageCount}\",\n        pagePrevText: \"Prev\",\n        pageNextText: \"Next\",\n        pageFirstText: \"First\",\n        pageLastText: \"Last\",\n        pageNavigatorNextText: \"...\",\n        pageNavigatorPrevText: \"...\",\n        pagerContainerClass: \"jsgrid-pager-container\",\n        pagerClass: \"jsgrid-pager\",\n        pagerNavButtonClass: \"jsgrid-pager-nav-button\",\n        pagerNavButtonInactiveClass: \"jsgrid-pager-nav-inactive-button\",\n        pageClass: \"jsgrid-pager-page\",\n        currentPageClass: \"jsgrid-pager-current-page\",\n\n        customLoading: false,\n        pageLoading: false,\n\n        autoload: false,\n        controller: defaultController,\n\n        loadIndication: true,\n        loadIndicationDelay: 500,\n        loadMessage: \"Please, wait...\",\n        loadShading: true,\n\n        invalidMessage: \"Invalid data entered!\",\n\n        invalidNotify: function(args) {\n            var messages = $.map(args.errors, function(error) {\n                return error.message || null;\n            });\n\n            window.alert([this.invalidMessage].concat(messages).join(\"\\n\"));\n        },\n\n        onInit: $.noop,\n        onRefreshing: $.noop,\n        onRefreshed: $.noop,\n        onPageChanged: $.noop,\n        onItemDeleting: $.noop,\n        onItemDeleted: $.noop,\n        onItemInserting: $.noop,\n        onItemInserted: $.noop,\n        onItemEditing: $.noop,\n        onItemUpdating: $.noop,\n        onItemUpdated: $.noop,\n        onItemInvalid: $.noop,\n        onDataLoading: $.noop,\n        onDataLoaded: $.noop,\n        onOptionChanging: $.noop,\n        onOptionChanged: $.noop,\n        onError: $.noop,\n\n        invalidClass: \"jsgrid-invalid\",\n\n        containerClass: \"jsgrid\",\n        tableClass: \"jsgrid-table\",\n        gridHeaderClass: \"jsgrid-grid-header\",\n        gridBodyClass: \"jsgrid-grid-body\",\n\n        _init: function(config) {\n            $.extend(this, config);\n            this._initLoadStrategy();\n            this._initController();\n            this._initFields();\n            this._attachWindowLoadResize();\n            this._attachWindowResizeCallback();\n            this._callEventHandler(this.onInit)\n        },\n\n        loadStrategy: function() {\n            return this.pageLoading\n                ? new jsGrid.loadStrategies.PageLoadingStrategy(this)\n                : new jsGrid.loadStrategies.DirectLoadingStrategy(this);\n        },\n\n        _initLoadStrategy: function() {\n            this._loadStrategy = getOrApply(this.loadStrategy, this);\n        },\n\n        _initController: function() {\n            this._controller = $.extend({}, defaultController, getOrApply(this.controller, this));\n        },\n\n        renderTemplate: function(source, context, config) {\n            args = [];\n            for(var key in config) {\n                args.push(config[key]);\n            }\n\n            args.unshift(source, context);\n\n            source = getOrApply.apply(null, args);\n            return (source === undefined || source === null) ? \"\" : source;\n        },\n\n        loadIndicator: function(config) {\n            return new jsGrid.LoadIndicator(config);\n        },\n\n        validation: function(config) {\n            return jsGrid.Validation && new jsGrid.Validation(config);\n        },\n\n        _initFields: function() {\n            var self = this;\n            self.fields = $.map(self.fields, function(field) {\n                if($.isPlainObject(field)) {\n                    var fieldConstructor = (field.type && jsGrid.fields[field.type]) || jsGrid.Field;\n                    field = new fieldConstructor(field);\n                }\n                field._grid = self;\n                return field;\n            });\n        },\n\n        _attachWindowLoadResize: function() {\n            $(window).on(\"load\", $.proxy(this._refreshSize, this));\n        },\n\n        _attachWindowResizeCallback: function() {\n            if(this.updateOnResize) {\n                $(window).on(\"resize\", $.proxy(this._refreshSize, this));\n            }\n        },\n\n        _detachWindowResizeCallback: function() {\n            $(window).off(\"resize\", this._refreshSize);\n        },\n\n        option: function(key, value) {\n            var optionChangingEventArgs,\n                optionChangedEventArgs;\n\n            if(arguments.length === 1)\n                return this[key];\n\n            optionChangingEventArgs = {\n                option: key,\n                oldValue: this[key],\n                newValue: value\n            };\n            this._callEventHandler(this.onOptionChanging, optionChangingEventArgs);\n\n            this._handleOptionChange(optionChangingEventArgs.option, optionChangingEventArgs.newValue);\n\n            optionChangedEventArgs = {\n                option: optionChangingEventArgs.option,\n                value: optionChangingEventArgs.newValue\n            };\n            this._callEventHandler(this.onOptionChanged, optionChangedEventArgs);\n        },\n\n        fieldOption: function(field, key, value) {\n            field = this._normalizeField(field);\n\n            if(arguments.length === 2)\n                return field[key];\n\n            field[key] = value;\n            this._renderGrid();\n        },\n\n        _handleOptionChange: function(name, value) {\n            this[name] = value;\n\n            switch(name) {\n                case \"width\":\n                case \"height\":\n                    this._refreshSize();\n                    break;\n                case \"rowClass\":\n                case \"rowRenderer\":\n                case \"rowClick\":\n                case \"rowDoubleClick\":\n                case \"noDataRowClass\":\n                case \"noDataContent\":\n                case \"selecting\":\n                case \"selectedRowClass\":\n                case \"oddRowClass\":\n                case \"evenRowClass\":\n                    this._refreshContent();\n                    break;\n                case \"pageButtonCount\":\n                case \"pagerFormat\":\n                case \"pagePrevText\":\n                case \"pageNextText\":\n                case \"pageFirstText\":\n                case \"pageLastText\":\n                case \"pageNavigatorNextText\":\n                case \"pageNavigatorPrevText\":\n                case \"pagerClass\":\n                case \"pagerNavButtonClass\":\n                case \"pageClass\":\n                case \"currentPageClass\":\n                case \"pagerRenderer\":\n                    this._refreshPager();\n                    break;\n                case \"fields\":\n                    this._initFields();\n                    this.render();\n                    break;\n                case \"data\":\n                case \"editing\":\n                case \"heading\":\n                case \"filtering\":\n                case \"inserting\":\n                case \"paging\":\n                    this.refresh();\n                    break;\n                case \"loadStrategy\":\n                case \"pageLoading\":\n                    this._initLoadStrategy();\n                    this.search();\n                    break;\n                case \"pageIndex\":\n                    this.openPage(value);\n                    break;\n                case \"pageSize\":\n                    this.refresh();\n                    this.search();\n                    break;\n                case \"editRowRenderer\":\n                case \"editRowClass\":\n                    this.cancelEdit();\n                    break;\n                case \"updateOnResize\":\n                    this._detachWindowResizeCallback();\n                    this._attachWindowResizeCallback();\n                    break;\n                case \"invalidNotify\":\n                case \"invalidMessage\":\n                    break;\n                default:\n                    this.render();\n                    break;\n            }\n        },\n\n        destroy: function() {\n            this._detachWindowResizeCallback();\n            this._clear();\n            this._container.removeData(JSGRID_DATA_KEY);\n        },\n\n        render: function() {\n            this._renderGrid();\n            return this.autoload ? this.loadData() : $.Deferred().resolve().promise();\n        },\n\n        _renderGrid: function() {\n            this._clear();\n\n            this._container.addClass(this.containerClass)\n                .css(\"position\", \"relative\")\n                .append(this._createHeader())\n                .append(this._createBody());\n\n            this._pagerContainer = this._createPagerContainer();\n            this._loadIndicator = this._createLoadIndicator();\n            this._validation = this._createValidation();\n\n            this.refresh();\n        },\n\n        _createLoadIndicator: function() {\n            return getOrApply(this.loadIndicator, this, {\n                message: this.loadMessage,\n                shading: this.loadShading,\n                container: this._container\n            });\n        },\n\n        _createValidation: function() {\n            return getOrApply(this.validation, this);\n        },\n\n        _clear: function() {\n            this.cancelEdit();\n\n            clearTimeout(this._loadingTimer);\n\n            this._pagerContainer && this._pagerContainer.empty();\n\n            this._container.empty()\n                .css({ position: \"\", width: \"\", height: \"\" });\n        },\n\n        _createHeader: function() {\n            var $headerRow = this._headerRow = this._createHeaderRow(),\n                $filterRow = this._filterRow = this._createFilterRow(),\n                $insertRow = this._insertRow = this._createInsertRow();\n\n            var $headerGrid = this._headerGrid = $(\"<table>\").addClass(this.tableClass)\n                .append($headerRow)\n                .append($filterRow)\n                .append($insertRow);\n\n            var $header = this._header = $(\"<div>\").addClass(this.gridHeaderClass)\n                .addClass(this._scrollBarWidth() ? \"jsgrid-header-scrollbar\" : \"\")\n                .append($headerGrid);\n\n            return $header;\n        },\n\n        _createBody: function() {\n            var $content = this._content = $(\"<tbody>\");\n\n            var $bodyGrid = this._bodyGrid = $(\"<table>\").addClass(this.tableClass)\n                .append($content);\n\n            var $body = this._body = $(\"<div>\").addClass(this.gridBodyClass)\n                .append($bodyGrid)\n                .on(\"scroll\", $.proxy(function(e) {\n                    this._header.scrollLeft(e.target.scrollLeft);\n                }, this));\n\n            return $body;\n        },\n\n        _createPagerContainer: function() {\n            var pagerContainer = this.pagerContainer || $(\"<div>\").appendTo(this._container);\n            return $(pagerContainer).addClass(this.pagerContainerClass);\n        },\n\n        _eachField: function(callBack) {\n            var self = this;\n            $.each(this.fields, function(index, field) {\n                if(field.visible) {\n                    callBack.call(self, field, index);\n                }\n            });\n        },\n\n        _createHeaderRow: function() {\n            if($.isFunction(this.headerRowRenderer))\n                return $(this.renderTemplate(this.headerRowRenderer, this));\n\n            var $result = $(\"<tr>\").addClass(this.headerRowClass);\n\n            this._eachField(function(field, index) {\n                var $th = this._prepareCell(\"<th>\", field, \"headercss\", this.headerCellClass)\n                    .append(this.renderTemplate(field.headerTemplate, field))\n                    .appendTo($result);\n\n                if(this.sorting && field.sorting) {\n                    $th.addClass(this.sortableClass)\n                        .on(\"click\", $.proxy(function() {\n                            this.sort(index);\n                        }, this));\n                }\n            });\n\n            return $result;\n        },\n\n        _prepareCell: function(cell, field, cssprop, cellClass) {\n            return $(cell).css(\"width\", field.width)\n                .addClass(cellClass || this.cellClass)\n                .addClass((cssprop && field[cssprop]) || field.css)\n                .addClass(field.align ? (\"jsgrid-align-\" + field.align) : \"\");\n        },\n\n        _createFilterRow: function() {\n            if($.isFunction(this.filterRowRenderer))\n                return $(this.renderTemplate(this.filterRowRenderer, this));\n\n            var $result = $(\"<tr>\").addClass(this.filterRowClass);\n\n            this._eachField(function(field) {\n                this._prepareCell(\"<td>\", field, \"filtercss\")\n                    .append(this.renderTemplate(field.filterTemplate, field))\n                    .appendTo($result);\n            });\n\n            return $result;\n        },\n\n        _createInsertRow: function() {\n            if($.isFunction(this.insertRowRenderer))\n                return $(this.renderTemplate(this.insertRowRenderer, this));\n\n            var $result = $(\"<tr>\").addClass(this.insertRowClass);\n\n            this._eachField(function(field) {\n                this._prepareCell(\"<td>\", field, \"insertcss\")\n                    .append(this.renderTemplate(field.insertTemplate, field))\n                    .appendTo($result);\n            });\n\n            return $result;\n        },\n\n        _callEventHandler: function(handler, eventParams) {\n            handler.call(this, $.extend(eventParams, {\n                grid: this\n            }));\n\n            return eventParams;\n        },\n\n        reset: function() {\n            this._resetSorting();\n            this._resetPager();\n            return this._loadStrategy.reset();\n        },\n\n        _resetPager: function() {\n            this._firstDisplayingPage = 1;\n            this._setPage(1);\n        },\n\n        _resetSorting: function() {\n            this._sortField = null;\n            this._sortOrder = SORT_ORDER_ASC;\n            this._clearSortingCss();\n        },\n\n        refresh: function() {\n            this._callEventHandler(this.onRefreshing);\n\n            this.cancelEdit();\n\n            this._refreshHeading();\n            this._refreshFiltering();\n            this._refreshInserting();\n            this._refreshContent();\n            this._refreshPager();\n            this._refreshSize();\n\n            this._callEventHandler(this.onRefreshed);\n        },\n\n        _refreshHeading: function() {\n            this._headerRow.toggle(this.heading);\n        },\n\n        _refreshFiltering: function() {\n            this._filterRow.toggle(this.filtering);\n        },\n\n        _refreshInserting: function() {\n            this._insertRow.toggle(this.inserting);\n        },\n\n        _refreshContent: function() {\n            var $content = this._content;\n            $content.empty();\n\n            if(!this.data.length) {\n                $content.append(this._createNoDataRow());\n                return this;\n            }\n\n            var indexFrom = this._loadStrategy.firstDisplayIndex();\n            var indexTo = this._loadStrategy.lastDisplayIndex();\n\n            for(var itemIndex = indexFrom; itemIndex < indexTo; itemIndex++) {\n                var item = this.data[itemIndex];\n                $content.append(this._createRow(item, itemIndex));\n            }\n        },\n\n        _createNoDataRow: function() {\n            var amountOfFields = 0;\n            this._eachField(function() {\n                amountOfFields++;\n            });\n\n            return $(\"<tr>\").addClass(this.noDataRowClass)\n                .append($(\"<td>\").attr(\"colspan\", amountOfFields)\n                    .append(this.renderTemplate(this.noDataContent, this)));\n        },\n\n        _createRow: function(item, itemIndex) {\n            var $result;\n\n            if($.isFunction(this.rowRenderer)) {\n                $result = this.renderTemplate(this.rowRenderer, this, { item: item, itemIndex: itemIndex });\n            } else {\n                $result = $(\"<tr>\");\n                this._renderCells($result, item);\n            }\n\n            $result.addClass(this._getRowClasses(item, itemIndex))\n                .data(JSGRID_ROW_DATA_KEY, item)\n                .on(\"click\", $.proxy(function(e) {\n                    this.rowClick({\n                        item: item,\n                        itemIndex: itemIndex,\n                        event: e\n                    });\n                }, this))\n                .on(\"dblclick\", $.proxy(function(e) {\n                    this.rowDoubleClick({\n                        item: item,\n                        itemIndex: itemIndex,\n                        event: e\n                    });\n                }, this));\n\n            if(this.selecting) {\n                this._attachRowHover($result);\n            }\n\n            return $result;\n        },\n\n        _getRowClasses: function(item, itemIndex) {\n            var classes = [];\n            classes.push(((itemIndex + 1) % 2) ? this.oddRowClass : this.evenRowClass);\n            classes.push(getOrApply(this.rowClass, this, item, itemIndex));\n            return classes.join(\" \");\n        },\n\n        _attachRowHover: function($row) {\n            var selectedRowClass = this.selectedRowClass;\n            $row.hover(function() {\n                    $(this).addClass(selectedRowClass);\n                },\n                function() {\n                    $(this).removeClass(selectedRowClass);\n                }\n            );\n        },\n\n        _renderCells: function($row, item) {\n            this._eachField(function(field) {\n                $row.append(this._createCell(item, field));\n            });\n            return this;\n        },\n\n        _createCell: function(item, field) {\n            var $result;\n            var fieldValue = this._getItemFieldValue(item, field);\n\n            var args = { value: fieldValue, item : item };\n            if($.isFunction(field.cellRenderer)) {\n                $result = this.renderTemplate(field.cellRenderer, field, args);\n            } else {\n                $result = $(\"<td>\").append(this.renderTemplate(field.itemTemplate || fieldValue, field, args));\n            }\n\n            return this._prepareCell($result, field);\n        },\n\n        _getItemFieldValue: function(item, field) {\n            var props = field.name.split('.');\n            var result = item[props.shift()];\n\n            while(result && props.length) {\n                result = result[props.shift()];\n            }\n\n            return result;\n        },\n\n        _setItemFieldValue: function(item, field, value) {\n            var props = field.name.split('.');\n            var current = item;\n            var prop = props[0];\n\n            while(current && props.length) {\n                item = current;\n                prop = props.shift();\n                current = item[prop];\n            }\n\n            if(!current) {\n                while(props.length) {\n                    item = item[prop] = {};\n                    prop = props.shift();\n                }\n            }\n\n            item[prop] = value;\n        },\n\n        sort: function(field, order) {\n            if($.isPlainObject(field)) {\n                order = field.order;\n                field = field.field;\n            }\n\n            this._clearSortingCss();\n            this._setSortingParams(field, order);\n            this._setSortingCss();\n            return this._loadStrategy.sort();\n        },\n\n        _clearSortingCss: function() {\n            this._headerRow.find(\"th\")\n                .removeClass(this.sortAscClass)\n                .removeClass(this.sortDescClass);\n        },\n\n        _setSortingParams: function(field, order) {\n            field = this._normalizeField(field);\n            order = order || ((this._sortField === field) ? this._reversedSortOrder(this._sortOrder) : SORT_ORDER_ASC);\n\n            this._sortField = field;\n            this._sortOrder = order;\n        },\n\n        _normalizeField: function(field) {\n            if($.isNumeric(field)) {\n                return this.fields[field];\n            }\n\n            if(typeof field === \"string\") {\n                return $.grep(this.fields, function(f) {\n                    return f.name === field;\n                })[0];\n            }\n\n            return field;\n        },\n\n        _reversedSortOrder: function(order) {\n            return (order === SORT_ORDER_ASC ? SORT_ORDER_DESC : SORT_ORDER_ASC);\n        },\n\n        _setSortingCss: function() {\n            var fieldIndex = this._visibleFieldIndex(this._sortField);\n\n            this._headerRow.find(\"th\").eq(fieldIndex)\n                .addClass(this._sortOrder === SORT_ORDER_ASC ? this.sortAscClass : this.sortDescClass);\n        },\n\n        _visibleFieldIndex: function(field) {\n            return $.inArray(field, $.grep(this.fields, function(f) { return f.visible; }));\n        },\n\n        _sortData: function() {\n            var sortFactor = this._sortFactor(),\n                sortField = this._sortField;\n\n            if(sortField) {\n                this.data.sort(function(item1, item2) {\n                    return sortFactor * sortField.sortingFunc(item1[sortField.name], item2[sortField.name]);\n                });\n            }\n        },\n\n        _sortFactor: function() {\n            return this._sortOrder === SORT_ORDER_ASC ? 1 : -1;\n        },\n\n        _itemsCount: function() {\n            return this._loadStrategy.itemsCount();\n        },\n\n        _pagesCount: function() {\n            var itemsCount = this._itemsCount(),\n                pageSize = this.pageSize;\n            return Math.floor(itemsCount / pageSize) + (itemsCount % pageSize ? 1 : 0);\n        },\n\n        _refreshPager: function() {\n            var $pagerContainer = this._pagerContainer;\n            $pagerContainer.empty();\n\n            if(this.paging) {\n                $pagerContainer.append(this._createPager());\n            }\n\n            var showPager = this.paging && this._pagesCount() > 1;\n            $pagerContainer.toggle(showPager);\n        },\n\n        _createPager: function() {\n            var $result;\n\n            if($.isFunction(this.pagerRenderer)) {\n                $result = $(this.pagerRenderer({\n                    pageIndex: this.pageIndex,\n                    pageCount: this._pagesCount()\n                }));\n            } else {\n                $result = $(\"<div>\").append(this._createPagerByFormat());\n            }\n\n            $result.addClass(this.pagerClass);\n\n            return $result;\n        },\n\n        _createPagerByFormat: function() {\n            var pageIndex = this.pageIndex,\n                pageCount = this._pagesCount(),\n                itemCount = this._itemsCount(),\n                pagerParts = this.pagerFormat.split(\" \");\n\n            return $.map(pagerParts, $.proxy(function(pagerPart) {\n                var result = pagerPart;\n\n                if(pagerPart === PAGES_PLACEHOLDER) {\n                    result = this._createPages();\n                } else if(pagerPart === FIRST_PAGE_PLACEHOLDER) {\n                    result = this._createPagerNavButton(this.pageFirstText, 1, pageIndex > 1);\n                } else if(pagerPart === PREV_PAGE_PLACEHOLDER) {\n                    result = this._createPagerNavButton(this.pagePrevText, pageIndex - 1, pageIndex > 1);\n                } else if(pagerPart === NEXT_PAGE_PLACEHOLDER) {\n                    result = this._createPagerNavButton(this.pageNextText, pageIndex + 1, pageIndex < pageCount);\n                } else if(pagerPart === LAST_PAGE_PLACEHOLDER) {\n                    result = this._createPagerNavButton(this.pageLastText, pageCount, pageIndex < pageCount);\n                } else if(pagerPart === PAGE_INDEX_PLACEHOLDER) {\n                    result = pageIndex;\n                } else if(pagerPart === PAGE_COUNT_PLACEHOLDER) {\n                    result = pageCount;\n                } else if(pagerPart === ITEM_COUNT_PLACEHOLDER) {\n                    result = itemCount;\n                }\n\n                return $.isArray(result) ? result.concat([\" \"]) : [result, \" \"];\n            }, this));\n        },\n\n        _createPages: function() {\n            var pageCount = this._pagesCount(),\n                pageButtonCount = this.pageButtonCount,\n                firstDisplayingPage = this._firstDisplayingPage,\n                pages = [];\n\n            if(firstDisplayingPage > 1) {\n                pages.push(this._createPagerPageNavButton(this.pageNavigatorPrevText, this.showPrevPages));\n            }\n\n            for(var i = 0, pageNumber = firstDisplayingPage; i < pageButtonCount && pageNumber <= pageCount; i++, pageNumber++) {\n                pages.push(pageNumber === this.pageIndex\n                    ? this._createPagerCurrentPage()\n                    : this._createPagerPage(pageNumber));\n            }\n\n            if((firstDisplayingPage + pageButtonCount - 1) < pageCount) {\n                pages.push(this._createPagerPageNavButton(this.pageNavigatorNextText, this.showNextPages));\n            }\n\n            return pages;\n        },\n\n        _createPagerNavButton: function(text, pageIndex, isActive) {\n            return this._createPagerButton(text, this.pagerNavButtonClass + (isActive ? \"\" : \" \" + this.pagerNavButtonInactiveClass),\n                isActive ? function() { this.openPage(pageIndex); } : $.noop);\n        },\n\n        _createPagerPageNavButton: function(text, handler) {\n            return this._createPagerButton(text, this.pagerNavButtonClass, handler);\n        },\n\n        _createPagerPage: function(pageIndex) {\n            return this._createPagerButton(pageIndex, this.pageClass, function() {\n                this.openPage(pageIndex);\n            });\n        },\n\n        _createPagerButton: function(text, css, handler) {\n            var $link = $(\"<a>\").attr(\"href\", EMPTY_HREF)\n                .html(text)\n                .on(\"click\", $.proxy(handler, this));\n\n            return $(\"<span>\").addClass(css).append($link);\n        },\n\n        _createPagerCurrentPage: function() {\n            return $(\"<span>\")\n                .addClass(this.pageClass)\n                .addClass(this.currentPageClass)\n                .text(this.pageIndex);\n        },\n\n        _refreshSize: function() {\n            this._refreshHeight();\n            this._refreshWidth();\n        },\n\n        _refreshWidth: function() {\n            var $headerGrid = this._headerGrid,\n                $bodyGrid = this._bodyGrid,\n                width = this.width;\n\n            if(width === \"auto\") {\n                $headerGrid.width(\"auto\");\n                width = $headerGrid.outerWidth();\n            }\n\n            $headerGrid.width(\"\");\n            $bodyGrid.width(\"\");\n            this._container.width(width);\n            width = $headerGrid.outerWidth();\n            $bodyGrid.width(width);\n        },\n\n        _scrollBarWidth: (function() {\n            var result;\n\n            return function() {\n                if(result === undefined) {\n                    var $ghostContainer = $(\"<div style='width:50px;height:50px;overflow:hidden;position:absolute;top:-10000px;left:-10000px;'></div>\");\n                    var $ghostContent = $(\"<div style='height:100px;'></div>\");\n                    $ghostContainer.append($ghostContent).appendTo(\"body\");\n                    var width = $ghostContent.innerWidth();\n                    $ghostContainer.css(\"overflow-y\", \"auto\");\n                    var widthExcludingScrollBar = $ghostContent.innerWidth();\n                    $ghostContainer.remove();\n                    result = width - widthExcludingScrollBar;\n                }\n                return result;\n            };\n        })(),\n\n        _refreshHeight: function() {\n            var container = this._container,\n                pagerContainer = this._pagerContainer,\n                height = this.height,\n                nonBodyHeight;\n\n            container.height(height);\n\n            if(height !== \"auto\") {\n                height = container.height();                \n\n                nonBodyHeight = this._header.outerHeight(true);                               \n                if(pagerContainer.parents(container).length) {\n                    nonBodyHeight += pagerContainer.outerHeight(true);\n                }\n                if (nonBodyHeight === 0) {\r\n                    nonBodyHeight = 41; //Bug: Subtract header height the first time.\r\n                    if (pagerContainer.style(\"display\") !== \"none\") {\r\n                        nonBodyHeight += 29; //Bug: Subtract pageContainer height the first time.\r\n                    }                      \r\n                }\n                \n                this._body.outerHeight(height - nonBodyHeight);\n            }\n        },\n\n        showPrevPages: function() {\n            var firstDisplayingPage = this._firstDisplayingPage,\n                pageButtonCount = this.pageButtonCount;\n\n            this._firstDisplayingPage = (firstDisplayingPage > pageButtonCount) ? firstDisplayingPage - pageButtonCount : 1;\n\n            this._refreshPager();\n        },\n\n        showNextPages: function() {\n            var firstDisplayingPage = this._firstDisplayingPage,\n                pageButtonCount = this.pageButtonCount,\n                pageCount = this._pagesCount();\n\n            this._firstDisplayingPage = (firstDisplayingPage + 2 * pageButtonCount > pageCount)\n                ? pageCount - pageButtonCount + 1\n                : firstDisplayingPage + pageButtonCount;\n\n            this._refreshPager();\n        },\n\n        openPage: function(pageIndex) {\n            if(pageIndex < 1 || pageIndex > this._pagesCount())\n                return;\n\n            this._setPage(pageIndex);\n            this._loadStrategy.openPage(pageIndex);\n        },\n\n        _setPage: function(pageIndex) {\n            var firstDisplayingPage = this._firstDisplayingPage,\n                pageButtonCount = this.pageButtonCount;\n\n            this.pageIndex = pageIndex;\n\n            if(pageIndex < firstDisplayingPage) {\n                this._firstDisplayingPage = pageIndex;\n            }\n\n            if(pageIndex > firstDisplayingPage + pageButtonCount - 1) {\n                this._firstDisplayingPage = pageIndex - pageButtonCount + 1;\n            }\n\n            this._callEventHandler(this.onPageChanged, {\n                pageIndex: pageIndex\n            });\n        },\n\n        _controllerCall: function(method, param, isCanceled, doneCallback) {\n            if(isCanceled)\n                return $.Deferred().reject().promise();\n\n            this._showLoading();\n\n            var controller = this._controller;\n            if(!controller || !controller[method]) {\n                throw Error(\"controller has no method '\" + method + \"'\");\n            }\n\n            return normalizePromise(controller[method](param))\n                .done($.proxy(doneCallback, this))\n                .fail($.proxy(this._errorHandler, this))\n                .always($.proxy(this._hideLoading, this));\n        },\n\n        _errorHandler: function() {\n            this._callEventHandler(this.onError, {\n                args: $.makeArray(arguments)\n            });\n        },\n\n        _showLoading: function() {\n            if(!this.loadIndication)\n                return;\n\n            clearTimeout(this._loadingTimer);\n\n            this._loadingTimer = setTimeout($.proxy(function() {\n                this._loadIndicator.show();\n            }, this), this.loadIndicationDelay);\n        },\n\n        _hideLoading: function() {\n            if(!this.loadIndication)\n                return;\n\n            clearTimeout(this._loadingTimer);\n            this._loadIndicator.hide();\n        },\n\n        search: function(filter) {\n            this._resetSorting();\n            this._resetPager();\n            return this.loadData(filter);\n        },\n\n        loadData: function(filter) {\n            filter = filter || (this.filtering ? this.getFilter() : {});\n\n            $.extend(filter, this._loadStrategy.loadParams(), this._sortingParams());\n\n            var args = this._callEventHandler(this.onDataLoading, {\n                filter: filter\n            });\n\n            return this._controllerCall(\"loadData\", filter, args.cancel, function(loadedData) {\n                if(!loadedData)\n                    return;\n\n                this._loadStrategy.finishLoad(loadedData);\n\n                this._callEventHandler(this.onDataLoaded, {\n                    data: loadedData\n                });\n            });\n        },\n\n        getFilter: function() {\n            var result = {};\n            this._eachField(function(field) {\n                if(field.filtering) {\n                    this._setItemFieldValue(result, field, field.filterValue());\n                }\n            });\n            return result;\n        },\n\n        _sortingParams: function() {\n            if(this.sorting && this._sortField) {\n                return {\n                    sortField: this._sortField.name,\n                    sortOrder: this._sortOrder\n                };\n            }\n            return {};\n        },\n\n        getSorting: function() {\n            var sortingParams = this._sortingParams();\n            return {\n                field: sortingParams.sortField,\n                order: sortingParams.sortOrder\n            };\n        },\n\n        clearFilter: function() {\n            var $filterRow = this._createFilterRow();\n            this._filterRow.replaceWith($filterRow);\n            this._filterRow = $filterRow;\n            return this.search();\n        },\n\n        insertItem: function(item) {\n            var insertingItem = item || this._getValidatedInsertItem();\n\n            if(!insertingItem)\n                return $.Deferred().reject().promise();\n\n            var args = this._callEventHandler(this.onItemInserting, {\n                item: insertingItem\n            });\n\n            return this._controllerCall(\"insertItem\", insertingItem, args.cancel, function(insertedItem) {\n                insertedItem = insertedItem || insertingItem;\n                this._loadStrategy.finishInsert(insertedItem);\n\n                this._callEventHandler(this.onItemInserted, {\n                    item: insertedItem\n                });\n            });\n        },\n\n        _getValidatedInsertItem: function() {\n            var item = this._getInsertItem();\n            return this._validateItem(item, this._insertRow) ? item : null;\n        },\n\n        _getInsertItem: function() {\n            var result = {};\n            this._eachField(function(field) {\n                if(field.inserting) {\n                    this._setItemFieldValue(result, field, field.insertValue());\n                }\n            });\n            return result;\n        },\n\n        _validateItem: function(item, $row) {\n            var validationErrors = [];\n\n            var args = {\n                item: item,\n                itemIndex: this._rowIndex($row),\n                row: $row\n            };\n\n            this._eachField(function(field) {\n                if(!field.validate)\n                    return;\n\n                var fieldValue = this._getItemFieldValue(item, field);\n\n                if(fieldValue === undefined)\n                    return;\n\n                var errors = this._validation.validate($.extend({\n                    value: fieldValue,\n                    rules: field.validate\n                }, args));\n\n                this._setCellValidity($row.children().eq(this._visibleFieldIndex(field)), errors);\n\n                if(!errors.length)\n                    return;\n\n                validationErrors.push.apply(validationErrors,\n                    $.map(errors, function(message) {\n                        return { field: field, message: message };\n                    }));\n            });\n\n            if(!validationErrors.length)\n                return true;\n\n            var invalidArgs = $.extend({\n                errors: validationErrors\n            }, args);\n            this._callEventHandler(this.onItemInvalid, invalidArgs);\n            this.invalidNotify(invalidArgs);\n\n            return false;\n        },\n\n        _setCellValidity: function($cell, errors) {\n            $cell\n                .toggleClass(this.invalidClass, !!errors.length)\n                .attr(\"title\", errors.join(\"\\n\"));\n        },\n\n        clearInsert: function() {\n            var insertRow = this._createInsertRow();\n            this._insertRow.replaceWith(insertRow);\n            this._insertRow = insertRow;\n            this.refresh();\n        },\n\n        editItem: function(item) {\n            var $row = this.rowByItem(item);\n            if($row.length) {\n                this._editRow($row);\n            }\n        },\n\n        rowByItem: function(item) {\n            if(item.jquery || item.nodeType)\n                return $(item);\n\n            return this._content.find(\"tr\").filter(function() {\n                return $.data(this, JSGRID_ROW_DATA_KEY) === item;\n            });\n        },\n\n        _editRow: function($row) {\n            if(!this.editing)\n                return;\n\n            var item = $row.data(JSGRID_ROW_DATA_KEY);\n\n            var args = this._callEventHandler(this.onItemEditing, {\n                row: $row,\n                item: item,\n                itemIndex: this._itemIndex(item)\n            });\n\n            if(args.cancel)\n                return;\n\n            if(this._editingRow) {\n                this.cancelEdit();\n            }\n\n            var $editRow = this._createEditRow(item);\n\n            this._editingRow = $row;\n            $row.hide();\n            $editRow.insertBefore($row);\n            $row.data(JSGRID_EDIT_ROW_DATA_KEY, $editRow);\n        },\n\n        _createEditRow: function(item) {\n            if($.isFunction(this.editRowRenderer)) {\n                return $(this.renderTemplate(field.editRowRenderer, field, { item: item, itemIndex: this._itemIndex(item) }));\n            }\n\n            var $result = $(\"<tr>\").addClass(this.editRowClass);\n\n            this._eachField(function(field) {\n                var fieldValue = this._getItemFieldValue(item, field);\n\n                this._prepareCell(\"<td>\", field, \"editcss\")\n                    .append(this.renderTemplate(field.editTemplate || \"\", field, { value: fieldValue, item: item }))\n                    .appendTo($result);\n            });\n\n            return $result;\n        },\n\n        updateItem: function(item, editedItem) {\n            if(arguments.length === 1) {\n                editedItem = item;\n            }\n\n            var $row = item ? this.rowByItem(item) : this._editingRow;\n            editedItem = editedItem || this._getValidatedEditedItem();\n\n            if(!editedItem)\n                return;\n\n            return this._updateRow($row, editedItem);\n        },\n\n        _getValidatedEditedItem: function() {\n            var item = this._getEditedItem();\n            return this._validateItem(item, this._getEditRow()) ? item : null;\n        },\n\n        _updateRow: function($updatingRow, editedItem) {\n            var updatingItem = $updatingRow.data(JSGRID_ROW_DATA_KEY),\n                updatingItemIndex = this._itemIndex(updatingItem),\n                previousItem = $.extend(true, {}, updatingItem);\n\n            $.extend(true, updatingItem, editedItem);\n\n            var args = this._callEventHandler(this.onItemUpdating, {\n                row: $updatingRow,\n                item: updatingItem,\n                itemIndex: updatingItemIndex,\n                previousItem: previousItem\n            });\n\n            return this._controllerCall(\"updateItem\", updatingItem, args.cancel, function(updatedItem) {\n                updatedItem = updatedItem || updatingItem;\n                var $updatedRow = this._finishUpdate($updatingRow, updatedItem, updatingItemIndex);\n\n                this._callEventHandler(this.onItemUpdated, {\n                    row: $updatedRow,\n                    item: updatedItem,\n                    itemIndex: updatingItemIndex,\n                    previousItem: previousItem\n                });\n            });\n        },\n\n        _rowIndex: function(row) {\n            return this._content.children().index($(row));\n        },\n\n        _itemIndex: function(item) {\n            return $.inArray(item, this.data);\n        },\n\n        _finishUpdate: function($updatingRow, updatedItem, updatedItemIndex) {\n            this.cancelEdit();\n            this.data[updatedItemIndex] = updatedItem;\n\n            var $updatedRow = this._createRow(updatedItem, updatedItemIndex);\n            $updatingRow.replaceWith($updatedRow);\n            return $updatedRow;\n        },\n\n        _getEditedItem: function() {\n            var result = {};\n            this._eachField(function(field) {\n                if(field.editing) {\n                    this._setItemFieldValue(result, field, field.editValue());\n                }\n            });\n            return result;\n        },\n\n        cancelEdit: function() {\n            if(!this._editingRow)\n                return;\n\n            this._getEditRow().remove();\n            this._editingRow.show();\n            this._editingRow = null;\n        },\n\n        _getEditRow: function() {\n            return this._editingRow.data(JSGRID_EDIT_ROW_DATA_KEY);\n        },\n\n        deleteItem: function(item) {\n            var $row = this.rowByItem(item);\n\n            if(!$row.length)\n                return;\n\n            if(this.confirmDeleting && !window.confirm(getOrApply(this.deleteConfirm, this, $row.data(JSGRID_ROW_DATA_KEY))))\n                return;\n\n            return this._deleteRow($row);\n        },\n\n        _deleteRow: function($row) {\n            var deletingItem = $row.data(JSGRID_ROW_DATA_KEY),\n                deletingItemIndex = this._itemIndex(deletingItem);\n\n            var args = this._callEventHandler(this.onItemDeleting, {\n                row: $row,\n                item: deletingItem,\n                itemIndex: deletingItemIndex\n            });\n\n            return this._controllerCall(\"deleteItem\", deletingItem, args.cancel, function() {\n                this._loadStrategy.finishDelete(deletingItem, deletingItemIndex);\n\n                this._callEventHandler(this.onItemDeleted, {\n                    row: $row,\n                    item: deletingItem,\n                    itemIndex: deletingItemIndex\n                });\n            });\n        }\n    };\n\n    $.fn.jsGrid = function(config) {\n        var args = $.makeArray(arguments),\n            methodArgs = args.slice(1),\n            result = this;\n\n        this.each(function() {\n            var $element = $(this),\n                instance = $element.data(JSGRID_DATA_KEY),\n                methodResult;\n\n            if(instance) {\n                if(typeof config === \"string\") {\n                    methodResult = instance[config].apply(instance, methodArgs);\n                    if(methodResult !== undefined && methodResult !== instance) {\n                        result = methodResult;\n                        return false;\n                    }\n                } else {\n                    instance._detachWindowResizeCallback();\n                    instance._init(config);\n                    instance.render();\n                }\n            } else {\n                new Grid($element, config);\n            }\n        });\n\n        return result;\n    };\n\n    var fields = {};\n\n    var setDefaults = function(config) {\n        var componentPrototype;\n\n        if($.isPlainObject(config)) {\n            componentPrototype = Grid.prototype;\n        } else {\n            componentPrototype = fields[config].prototype;\n            config = arguments[1] || {};\n        }\n\n        $.extend(componentPrototype, config);\n    };\n\n    var locales = {};\n\n    var locale = function(lang) {\n        var localeConfig = $.isPlainObject(lang) ? lang : locales[lang];\n\n        if(!localeConfig)\n            throw Error(\"unknown locale \" + lang);\n\n        setLocale(jsGrid, localeConfig);\n    };\n\n    var setLocale = function(obj, localeConfig) {\n        $.each(localeConfig, function(field, value) {\n            if($.isPlainObject(value)) {\n                setLocale(obj[field] || obj[field[0].toUpperCase() + field.slice(1)], value);\n                return;\n            }\n\n            if(obj.hasOwnProperty(field)) {\n                obj[field] = value;\n            } else {\n                obj.prototype[field] = value;\n            }\n        });\n    };\n\n    window.jsGrid = {\n        Grid: Grid,\n        fields: fields,\n        setDefaults: setDefaults,\n        locales: locales,\n        locale: locale,\n        version: '1.5.1'\n    };\n\n}(window, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    function LoadIndicator(config) {\n        this._init(config);\n    }\n\n    LoadIndicator.prototype = {\n\n        container: \"body\",\n        message: \"Loading...\",\n        shading: true,\n\n        zIndex: 1000,\n        shaderClass: \"jsgrid-load-shader\",\n        loadPanelClass: \"jsgrid-load-panel\",\n\n        _init: function(config) {\n            $.extend(true, this, config);\n\n            this._initContainer();\n            this._initShader();\n            this._initLoadPanel();\n        },\n\n        _initContainer: function() {\n            this._container = $(this.container);\n        },\n\n        _initShader: function() {\n            if(!this.shading)\n                return;\n\n            this._shader = $(\"<div>\").addClass(this.shaderClass)\n                .hide()\n                .css({\n                    position: \"absolute\",\n                    top: 0,\n                    right: 0,\n                    bottom: 0,\n                    left: 0,\n                    zIndex: this.zIndex\n                })\n                .appendTo(this._container);\n        },\n\n        _initLoadPanel: function() {\n            this._loadPanel = $(\"<div>\").addClass(this.loadPanelClass)\n                .text(this.message)\n                .hide()\n                .css({\n                    position: \"absolute\",\n                    top: \"50%\",\n                    left: \"50%\",\n                    zIndex: this.zIndex\n                })\n                .appendTo(this._container);\n        },\n\n        show: function() {\n            var $loadPanel = this._loadPanel.show();\n\n            var actualWidth = $loadPanel.outerWidth();\n            var actualHeight = $loadPanel.outerHeight();\n\n            $loadPanel.css({\n                marginTop: -actualHeight / 2,\n                marginLeft: -actualWidth / 2\n            });\n\n            this._shader.show();\n        },\n\n        hide: function() {\n            this._loadPanel.hide();\n            this._shader.hide();\n        }\n\n    };\n\n    jsGrid.LoadIndicator = LoadIndicator;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    function DirectLoadingStrategy(grid) {\n        this._grid = grid;\n    }\n\n    DirectLoadingStrategy.prototype = {\n\n        firstDisplayIndex: function() {\n            var grid = this._grid;\n            return grid.option(\"paging\") ? (grid.option(\"pageIndex\") - 1) * grid.option(\"pageSize\") : 0;\n        },\n\n        lastDisplayIndex: function() {\n            var grid = this._grid;\n            var itemsCount = grid.option(\"data\").length;\n\n            return grid.option(\"paging\")\n                ? Math.min(grid.option(\"pageIndex\") * grid.option(\"pageSize\"), itemsCount)\n                : itemsCount;\n        },\n\n        itemsCount: function() {\n            return this._grid.option(\"data\").length;\n        },\n\n        openPage: function(index) {\n            this._grid.refresh();\n        },\n\n        loadParams: function() {\n            return {};\n        },\n\n        sort: function() {\n            this._grid._sortData();\n            this._grid.refresh();\n            return $.Deferred().resolve().promise();\n        },\n\n        reset: function() {\n            this._grid.refresh();\n            return $.Deferred().resolve().promise();\n        },\n\n        finishLoad: function(loadedData) {\n            this._grid.option(\"data\", loadedData);\n        },\n\n        finishInsert: function(insertedItem) {\n            var grid = this._grid;\n            grid.option(\"data\").push(insertedItem);\n            grid.refresh();\n        },\n\n        finishDelete: function(deletedItem, deletedItemIndex) {\n            var grid = this._grid;\n            grid.option(\"data\").splice(deletedItemIndex, 1);\n            grid.reset();\n        }\n    };\n\n\n    function PageLoadingStrategy(grid) {\n        this._grid = grid;\n        this._itemsCount = 0;\n    }\n\n    PageLoadingStrategy.prototype = {\n\n        firstDisplayIndex: function() {\n            return 0;\n        },\n\n        lastDisplayIndex: function() {\n            return this._grid.option(\"data\").length;\n        },\n\n        itemsCount: function() {\n            return this._itemsCount;\n        },\n\n        openPage: function(index) {\n            this._grid.loadData();\n        },\n\n        loadParams: function() {\n            var grid = this._grid;\n            return {\n                pageIndex: grid.option(\"pageIndex\"),\n                pageSize: grid.option(\"pageSize\")\n            };\n        },\n\n        reset: function() {\n            return this._grid.loadData();\n        },\n\n        sort: function() {\n            return this._grid.loadData();\n        },\n\n        finishLoad: function(loadedData) {\n            this._itemsCount = loadedData.itemsCount;\n            this._grid.option(\"data\", loadedData.data);\n        },\n\n        finishInsert: function(insertedItem) {\n            this._grid.search();\n        },\n\n        finishDelete: function(deletedItem, deletedItemIndex) {\n            this._grid.search();\n        }\n    };\n\n    jsGrid.loadStrategies = {\n        DirectLoadingStrategy: DirectLoadingStrategy,\n        PageLoadingStrategy: PageLoadingStrategy\n    };\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    var isDefined = function(val) {\n        return typeof(val) !== \"undefined\" && val !== null;\n    };\n\n    var sortStrategies = {\n        string: function(str1, str2) {\n            if(!isDefined(str1) && !isDefined(str2))\n                return 0;\n\n            if(!isDefined(str1))\n                return -1;\n\n            if(!isDefined(str2))\n                return 1;\n\n            return (\"\" + str1).localeCompare(\"\" + str2);\n        },\n\n        number: function(n1, n2) {\n            return n1 - n2;\n        },\n\n        date: function(dt1, dt2) {\n            return dt1 - dt2;\n        },\n\n        numberAsString: function(n1, n2) {\n            return parseFloat(n1) - parseFloat(n2);\n        }\n    };\n\n    jsGrid.sortStrategies = sortStrategies;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    function Validation(config) {\n        this._init(config);\n    }\n\n    Validation.prototype = {\n\n        _init: function(config) {\n            $.extend(true, this, config);\n        },\n\n        validate: function(args) {\n            var errors = [];\n\n            $.each(this._normalizeRules(args.rules), function(_, rule) {\n                if(rule.validator(args.value, args.item, rule.param))\n                    return;\n\n                var errorMessage = $.isFunction(rule.message) ? rule.message(args.value, args.item) : rule.message;\n                errors.push(errorMessage);\n            });\n\n            return errors;\n        },\n\n        _normalizeRules: function(rules) {\n            if(!$.isArray(rules))\n                rules = [rules];\n\n            return $.map(rules, $.proxy(function(rule) {\n                return this._normalizeRule(rule);\n            }, this));\n        },\n\n        _normalizeRule: function(rule) {\n            if(typeof rule === \"string\")\n                rule = { validator: rule };\n\n            if($.isFunction(rule))\n                rule = { validator: rule };\n\n            if($.isPlainObject(rule))\n                rule = $.extend({}, rule);\n            else\n                throw Error(\"wrong validation config specified\");\n\n            if($.isFunction(rule.validator))\n                return rule;\n\n            return this._applyNamedValidator(rule, rule.validator);\n        },\n\n        _applyNamedValidator: function(rule, validatorName) {\n            delete rule.validator;\n\n            var validator = validators[validatorName];\n            if(!validator)\n                throw Error(\"unknown validator \\\"\" + validatorName + \"\\\"\");\n\n            if($.isFunction(validator)) {\n                validator = { validator: validator };\n            }\n\n            return $.extend({}, validator, rule);\n        }\n    };\n\n    jsGrid.Validation = Validation;\n\n\n    var validators = {\n        required: {\n            message: \"Field is required\",\n            validator: function(value) {\n                return value !== undefined && value !== null && value !== \"\";\n            }\n        },\n\n        rangeLength: {\n            message: \"Field value length is out of the defined range\",\n            validator: function(value, _, param) {\n                return value.length >= param[0] && value.length <= param[1];\n            }\n        },\n\n        minLength: {\n            message: \"Field value is too short\",\n            validator: function(value, _, param) {\n                return value.length >= param;\n            }\n        },\n\n        maxLength: {\n            message: \"Field value is too long\",\n            validator: function(value, _, param) {\n                return value.length <= param;\n            }\n        },\n\n        pattern: {\n            message: \"Field value is not matching the defined pattern\",\n            validator: function(value, _, param) {\n                if(typeof param === \"string\") {\n                    param = new RegExp(\"^(?:\" + param + \")$\");\n                }\n                return param.test(value);\n            }\n        },\n\n        range: {\n            message: \"Field value is out of the defined range\",\n            validator: function(value, _, param) {\n                return value >= param[0] && value <= param[1];\n            }\n        },\n\n        min: {\n            message: \"Field value is too small\",\n            validator: function(value, _, param) {\n                return value >= param;\n            }\n        },\n\n        max: {\n            message: \"Field value is too large\",\n            validator: function(value, _, param) {\n                return value <= param;\n            }\n        }\n    };\n\n    jsGrid.validators = validators;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    function Field(config) {\n        $.extend(true, this, config);\n        this.sortingFunc = this._getSortingFunc();\n    }\n\n    Field.prototype = {\n        name: \"\",\n        title: null,\n        css: \"\",\n        align: \"\",\n        width: 100,\n\n        visible: true,\n        filtering: true,\n        inserting: true,\n        editing: true,\n        sorting: true,\n        sorter: \"string\", // name of SortStrategy or function to compare elements\n\n        headerTemplate: function() {\n            return (this.title === undefined || this.title === null) ? this.name : this.title;\n        },\n\n        itemTemplate: function(value, item) {\n            return value;\n        },\n\n        filterTemplate: function() {\n            return \"\";\n        },\n\n        insertTemplate: function() {\n            return \"\";\n        },\n\n        editTemplate: function(value, item) {\n            this._value = value;\n            return this.itemTemplate(value, item);\n        },\n\n        filterValue: function() {\n            return \"\";\n        },\n\n        insertValue: function() {\n            return \"\";\n        },\n\n        editValue: function() {\n            return this._value;\n        },\n\n        _getSortingFunc: function() {\n            var sorter = this.sorter;\n\n            if($.isFunction(sorter)) {\n                return sorter;\n            }\n\n            if(typeof sorter === \"string\") {\n                return jsGrid.sortStrategies[sorter];\n            }\n\n            throw Error(\"wrong sorter for the field \\\"\" + this.name + \"\\\"!\");\n        }\n    };\n\n    jsGrid.Field = Field;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    var Field = jsGrid.Field;\n\n    function TextField(config) {\n        Field.call(this, config);\n    }\n\n    TextField.prototype = new Field({\n\n        autosearch: true,\n\t\treadOnly: false,\n\n        filterTemplate: function() {\n            if(!this.filtering)\n                return \"\";\n\n            var grid = this._grid,\n                $result = this.filterControl = this._createTextBox();\n\n            if(this.autosearch) {\n                $result.on(\"keypress\", function(e) {\n                    if(e.which === 13) {\n                        grid.search();\n                        e.preventDefault();\n                    }\n                });\n            }\n\n            return $result;\n        },\n\n        insertTemplate: function() {\n            if(!this.inserting)\n                return \"\";\n\n            return this.insertControl = this._createTextBox();\n        },\n\n        editTemplate: function(value) {\n            if(!this.editing)\n                return this.itemTemplate(value);\n\n            var $result = this.editControl = this._createTextBox();\n            $result.val(value);\n            return $result;\n        },\n\n        filterValue: function() {\n            return this.filterControl.val();\n        },\n\n        insertValue: function() {\n            return this.insertControl.val();\n        },\n\n        editValue: function() {\n            return this.editControl.val();\n        },\n\n        _createTextBox: function() {\n            return $(\"<input>\").attr(\"type\", \"text\")\n                .prop(\"readonly\", !!this.readOnly);\n        }\n    });\n\n    jsGrid.fields.text = jsGrid.TextField = TextField;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    var TextField = jsGrid.TextField;\n\n    function NumberField(config) {\n        TextField.call(this, config);\n    }\n\n    NumberField.prototype = new TextField({\n\n        sorter: \"number\",\n        align: \"right\",\n\t\treadOnly: false,\n\n        filterValue: function() {\n            return parseInt(this.filterControl.val() || 0, 10);\n        },\n\n        insertValue: function() {\n            return parseInt(this.insertControl.val() || 0, 10);\n        },\n\n        editValue: function() {\n            return parseInt(this.editControl.val() || 0, 10);\n        },\n\n        _createTextBox: function() {\n\t\t\treturn $(\"<input>\").attr(\"type\", \"number\")\n                .prop(\"readonly\", !!this.readOnly);\n        }\n    });\n\n    jsGrid.fields.number = jsGrid.NumberField = NumberField;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    var TextField = jsGrid.TextField;\n\n    function TextAreaField(config) {\n        TextField.call(this, config);\n    }\n\n    TextAreaField.prototype = new TextField({\n\n        insertTemplate: function() {\n            if(!this.inserting)\n                return \"\";\n\n            return this.insertControl = this._createTextArea();\n        },\n\n        editTemplate: function(value) {\n            if(!this.editing)\n                return this.itemTemplate(value);\n\n            var $result = this.editControl = this._createTextArea();\n            $result.val(value);\n            return $result;\n        },\n\n        _createTextArea: function() {\n            return $(\"<textarea>\").prop(\"readonly\", !!this.readOnly);\n        }\n    });\n\n    jsGrid.fields.textarea = jsGrid.TextAreaField = TextAreaField;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    var NumberField = jsGrid.NumberField;\n    var numberValueType = \"number\";\n    var stringValueType = \"string\";\n\n    function SelectField(config) {\n        this.items = [];\n        this.selectedIndex = -1;\n        this.valueField = \"\";\n        this.textField = \"\";\n\n        if(config.valueField && config.items.length) {\n            var firstItemValue = config.items[0][config.valueField];\n            this.valueType = (typeof firstItemValue) === numberValueType ? numberValueType : stringValueType;\n        }\n\n        this.sorter = this.valueType;\n\n        NumberField.call(this, config);\n    }\n\n    SelectField.prototype = new NumberField({\n\n        align: \"center\",\n        valueType: numberValueType,\n\n        itemTemplate: function(value) {\n            var items = this.items,\n                valueField = this.valueField,\n                textField = this.textField,\n                resultItem;\n\n            if(valueField) {\n                resultItem = $.grep(items, function(item, index) {\n                    return item[valueField] === value;\n                })[0] || {};\n            }\n            else {\n                resultItem = items[value];\n            }\n\n            var result = (textField ? resultItem[textField] : resultItem);\n\n            return (result === undefined || result === null) ? \"\" : result;\n        },\n\n        filterTemplate: function() {\n            if(!this.filtering)\n                return \"\";\n\n            var grid = this._grid,\n                $result = this.filterControl = this._createSelect();\n\n            if(this.autosearch) {\n                $result.on(\"change\", function(e) {\n                    grid.search();\n                });\n            }\n\n            return $result;\n        },\n\n        insertTemplate: function() {\n            if(!this.inserting)\n                return \"\";\n\n            return this.insertControl = this._createSelect();\n        },\n\n        editTemplate: function(value) {\n            if(!this.editing)\n                return this.itemTemplate(value);\n\n            var $result = this.editControl = this._createSelect();\n            (value !== undefined) && $result.val(value);\n            return $result;\n        },\n\n        filterValue: function() {\n            var val = this.filterControl.val();\n            return this.valueType === numberValueType ? parseInt(val || 0, 10) : val;\n        },\n\n        insertValue: function() {\n            var val = this.insertControl.val();\n            return this.valueType === numberValueType ? parseInt(val || 0, 10) : val;\n        },\n\n        editValue: function() {\n            var val = this.editControl.val();\n            return this.valueType === numberValueType ? parseInt(val || 0, 10) : val;\n        },\n\n        _createSelect: function() {\n            var $result = $(\"<select>\"),\n                valueField = this.valueField,\n                textField = this.textField,\n                selectedIndex = this.selectedIndex;\n\n            $.each(this.items, function(index, item) {\n                var value = valueField ? item[valueField] : index,\n                    text = textField ? item[textField] : item;\n\n                var $option = $(\"<option>\")\n                    .attr(\"value\", value)\n                    .text(text)\n                    .appendTo($result);\n\n                $option.prop(\"selected\", (selectedIndex === index));\n            });\n\n            $result.prop(\"disabled\", !!this.readOnly);\n\n            return $result;\n        }\n    });\n\n    jsGrid.fields.select = jsGrid.SelectField = SelectField;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    var Field = jsGrid.Field;\n\n    function CheckboxField(config) {\n        Field.call(this, config);\n    }\n\n    CheckboxField.prototype = new Field({\n\n        sorter: \"number\",\n        align: \"center\",\n        autosearch: true,\n\n        itemTemplate: function(value) {\n            return this._createCheckbox().prop({\n                checked: value,\n                disabled: true\n            });\n        },\n\n        filterTemplate: function() {\n            if(!this.filtering)\n                return \"\";\n\n            var grid = this._grid,\n                $result = this.filterControl = this._createCheckbox();\n\n            $result.prop({\n                readOnly: true,\n                indeterminate: true\n            });\n\n            $result.on(\"click\", function() {\n                var $cb = $(this);\n\n                if($cb.prop(\"readOnly\")) {\n                    $cb.prop({\n                        checked: false,\n                        readOnly: false\n                    });\n                }\n                else if(!$cb.prop(\"checked\")) {\n                    $cb.prop({\n                        readOnly: true,\n                        indeterminate: true\n                    });\n                }\n            });\n\n            if(this.autosearch) {\n                $result.on(\"click\", function() {\n                    grid.search();\n                });\n            }\n\n            return $result;\n        },\n\n        insertTemplate: function() {\n            if(!this.inserting)\n                return \"\";\n\n            return this.insertControl = this._createCheckbox();\n        },\n\n        editTemplate: function(value) {\n            if(!this.editing)\n                return this.itemTemplate(value);\n\n            var $result = this.editControl = this._createCheckbox();\n            $result.prop(\"checked\", value);\n            return $result;\n        },\n\n        filterValue: function() {\n            return this.filterControl.get(0).indeterminate\n                ? undefined\n                : this.filterControl.is(\":checked\");\n        },\n\n        insertValue: function() {\n            return this.insertControl.is(\":checked\");\n        },\n\n        editValue: function() {\n            return this.editControl.is(\":checked\");\n        },\n\n        _createCheckbox: function() {\n            return $(\"<input>\").attr(\"type\", \"checkbox\");\n        }\n    });\n\n    jsGrid.fields.checkbox = jsGrid.CheckboxField = CheckboxField;\n\n}(jsGrid, jQuery));\n\n(function(jsGrid, $, undefined) {\n\n    var Field = jsGrid.Field;\n\n    function ControlField(config) {\n        Field.call(this, config);\n        this._configInitialized = false;\n    }\n\n    ControlField.prototype = new Field({\n        css: \"jsgrid-control-field\",\n        align: \"center\",\n        width: 50,\n        filtering: false,\n        inserting: false,\n        editing: false,\n        sorting: false,\n\n        buttonClass: \"jsgrid-button\",\n        modeButtonClass: \"jsgrid-mode-button\",\n\n        modeOnButtonClass: \"jsgrid-mode-on-button\",\n        searchModeButtonClass: \"jsgrid-search-mode-button\",\n        insertModeButtonClass: \"jsgrid-insert-mode-button\",\n        editButtonClass: \"jsgrid-edit-button\",\n        deleteButtonClass: \"jsgrid-delete-button\",\n        searchButtonClass: \"jsgrid-search-button\",\n        clearFilterButtonClass: \"jsgrid-clear-filter-button\",\n        insertButtonClass: \"jsgrid-insert-button\",\n        updateButtonClass: \"jsgrid-update-button\",\n        cancelEditButtonClass: \"jsgrid-cancel-edit-button\",\n\n        searchModeButtonTooltip: \"Switch to searching\",\n        insertModeButtonTooltip: \"Switch to inserting\",\n        editButtonTooltip: \"Edit\",\n        deleteButtonTooltip: \"Delete\",\n        searchButtonTooltip: \"Search\",\n        clearFilterButtonTooltip: \"Clear filter\",\n        insertButtonTooltip: \"Insert\",\n        updateButtonTooltip: \"Update\",\n        cancelEditButtonTooltip: \"Cancel edit\",\n\n        editButton: true,\n        deleteButton: true,\n        clearFilterButton: true,\n        modeSwitchButton: true,\n\n        _initConfig: function() {\n            this._hasFiltering = this._grid.filtering;\n            this._hasInserting = this._grid.inserting;\n\n            if(this._hasInserting && this.modeSwitchButton) {\n                this._grid.inserting = false;\n            }\n\n            this._configInitialized = true;\n        },\n\n        headerTemplate: function() {\n            if(!this._configInitialized) {\n                this._initConfig();\n            }\n\n            var hasFiltering = this._hasFiltering;\n            var hasInserting = this._hasInserting;\n\n            if(!this.modeSwitchButton || (!hasFiltering && !hasInserting))\n                return \"\";\n\n            if(hasFiltering && !hasInserting)\n                return this._createFilterSwitchButton();\n\n            if(hasInserting && !hasFiltering)\n                return this._createInsertSwitchButton();\n\n            return this._createModeSwitchButton();\n        },\n\n        itemTemplate: function(value, item) {\n            var $result = $([]);\n\n            if(this.editButton) {\n                $result = $result.add(this._createEditButton(item));\n            }\n\n            if(this.deleteButton) {\n                $result = $result.add(this._createDeleteButton(item));\n            }\n\n            return $result;\n        },\n\n        filterTemplate: function() {\n            var $result = this._createSearchButton();\n            return this.clearFilterButton ? $result.add(this._createClearFilterButton()) : $result;\n        },\n\n        insertTemplate: function() {\n            return this._createInsertButton();\n        },\n\n        editTemplate: function() {\n            return this._createUpdateButton().add(this._createCancelEditButton());\n        },\n\n        _createFilterSwitchButton: function() {\n            return this._createOnOffSwitchButton(\"filtering\", this.searchModeButtonClass, true);\n        },\n\n        _createInsertSwitchButton: function() {\n            return this._createOnOffSwitchButton(\"inserting\", this.insertModeButtonClass, false);\n        },\n\n        _createOnOffSwitchButton: function(option, cssClass, isOnInitially) {\n            var isOn = isOnInitially;\n\n            var updateButtonState = $.proxy(function() {\n                $button.toggleClass(this.modeOnButtonClass, isOn);\n            }, this);\n\n            var $button = this._createGridButton(this.modeButtonClass + \" \" + cssClass, \"\", function(grid) {\n                isOn = !isOn;\n                grid.option(option, isOn);\n                updateButtonState();\n            });\n\n            updateButtonState();\n\n            return $button;\n        },\n\n        _createModeSwitchButton: function() {\n            var isInserting = false;\n\n            var updateButtonState = $.proxy(function() {\n                $button.attr(\"title\", isInserting ? this.searchModeButtonTooltip : this.insertModeButtonTooltip)\n                    .toggleClass(this.insertModeButtonClass, !isInserting)\n                    .toggleClass(this.searchModeButtonClass, isInserting);\n            }, this);\n\n            var $button = this._createGridButton(this.modeButtonClass, \"\", function(grid) {\n                isInserting = !isInserting;\n                grid.option(\"inserting\", isInserting);\n                grid.option(\"filtering\", !isInserting);\n                updateButtonState();\n            });\n\n            updateButtonState();\n\n            return $button;\n        },\n\n        _createEditButton: function(item) {\n            return this._createGridButton(this.editButtonClass, this.editButtonTooltip, function(grid, e) {\n                grid.editItem(item);\n                e.stopPropagation();\n            });\n        },\n\n        _createDeleteButton: function(item) {\n            return this._createGridButton(this.deleteButtonClass, this.deleteButtonTooltip, function(grid, e) {\n                grid.deleteItem(item);\n                e.stopPropagation();\n            });\n        },\n\n        _createSearchButton: function() {\n            return this._createGridButton(this.searchButtonClass, this.searchButtonTooltip, function(grid) {\n                grid.search();\n            });\n        },\n\n        _createClearFilterButton: function() {\n            return this._createGridButton(this.clearFilterButtonClass, this.clearFilterButtonTooltip, function(grid) {\n                grid.clearFilter();\n            });\n        },\n\n        _createInsertButton: function() {\n            return this._createGridButton(this.insertButtonClass, this.insertButtonTooltip, function(grid) {\n                grid.insertItem().done(function() {\n                    grid.clearInsert();\n                });\n            });\n        },\n\n        _createUpdateButton: function() {\n            return this._createGridButton(this.updateButtonClass, this.updateButtonTooltip, function(grid, e) {\n                grid.updateItem();\n                e.stopPropagation();\n            });\n        },\n\n        _createCancelEditButton: function() {\n            return this._createGridButton(this.cancelEditButtonClass, this.cancelEditButtonTooltip, function(grid, e) {\n                grid.cancelEdit();\n                e.stopPropagation();\n            });\n        },\n\n        _createGridButton: function(cls, tooltip, clickHandler) {\n            var grid = this._grid;\n\n            return $(\"<input>\").addClass(this.buttonClass)\n                .addClass(cls)\n                .attr({\n                    type: \"button\",\n                    title: tooltip\n                })\n                .on(\"click\", function(e) {\n                    clickHandler(grid, e);\n                });\n        },\n\n        editValue: function() {\n            return \"\";\n        }\n\n    });\n\n    jsGrid.fields.control = jsGrid.ControlField = ControlField;\n\n}(jsGrid, jQuery));\n","var usersAdapter=(function() {\r\n\r\n    /**\r\n     * Private methods\r\n     */\r\n\r\n    function matchExtendedInfo(list, usersWithExtendedInfo) {\r\n        list.map(function(uuser) {\r\n            var u = usersWithExtendedInfo.find(function (e) {\r\n                return uuser.idUser == e.idUser;\r\n            });\r\n            uuser.extendedInfo=u.extendedInfo;\r\n        });\r\n    }\r\n\r\n    \r\n    /**\r\n     * Public methods\r\n     */\r\n\r\n    /**\r\n     * create a json standard for user information\r\n     * (this is used in modals and usertooltip)\r\n     * if the isAssignee and owner are false the user is participant\r\n     * if the isAssignee and owner are null the user is not in (isAssignee, owner and participant)\r\n     * @param {string} userAssigned guid del usuario\r\n     * @param {string} name \r\n     * @param {string} username \r\n     * @param {string} picture \r\n     * @param {string} email \r\n     * @param {string} initials \r\n     * @param {boolean} isAssignee if is true the user shows like assignee\r\n     * @param {boolean} owner if is true the user shows like creator\r\n     * @param {Array} activities \r\n     * @param {Array} events \r\n     */\r\n    var createJsonUserInfo = function (userAssigned, name, username, picture, email, initials, isAssignee, owner, activities, events) {\r\n        var participant=owner===false && isAssignee===false;\r\n        if (owner===null && isAssignee===null)\r\n            owner=participant=false;\r\n        if(picture!==undefined)\r\n            picture=picture.replace(\"data:image/png;base64,data:image/png;base64,\", \"data:image/png;base64,\");\r\n        return {\r\n            userAssigned: userAssigned,\r\n            name: name,\r\n            username: username,\r\n            picture: picture,\r\n            email: email,\r\n            initials: initials,\r\n            isAssignee: isAssignee,\r\n            isParticipant: participant,\r\n            owner: owner,\r\n            activities: activities,\r\n            events: events,\r\n            isAnonymized: userAssigned === bizagi.util.anonymizedUserInformation.id\r\n        };\r\n    };\r\n\r\n    /**\r\n     * let to add extendedInfo to each users,assigned,createdBy\r\n     * @param {*} cases \r\n     * @param {*} usersWithExtendedInfo \r\n     */\r\n    var matchUsersForExtendedInfoCase=function(cases,usersWithExtendedInfo){\r\n        cases.map(function(casee) {\r\n            if(casee.assignees)\r\n                matchExtendedInfo(casee.assignees,usersWithExtendedInfo);\r\n            if(casee.users)\r\n                matchExtendedInfo(casee.users,usersWithExtendedInfo);\r\n            if(casee.createdBy){\r\n                var u = usersWithExtendedInfo.find(function (e) {\r\n                    return casee.createdBy.idUser == e.idUser;\r\n                });\r\n                casee.createdBy.extendedInfo=u.extendedInfo;\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * return just the assigned users if exists a only creator user this is ommited\r\n     * @param {Array} users \r\n     */\r\n    var justAssignees=function(users){\r\n        return users.filter(function(user) {\r\n            return user.isAssignee===true;\r\n        });\r\n    };\r\n    \r\n    return {\r\n        createJsonUserInfo: createJsonUserInfo,\r\n        matchUsersForExtendedInfoCase: matchUsersForExtendedInfoCase,\r\n        justAssignees: justAssignees\r\n    };\r\n}());"]}